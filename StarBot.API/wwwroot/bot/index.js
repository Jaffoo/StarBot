var mC=Object.defineProperty;var gC=(t,r,e)=>r in t?mC(t,r,{enumerable:!0,configurable:!0,writable:!0,value:e}):t[r]=e;var xu=(t,r,e)=>(gC(t,typeof r!="symbol"?r+"":r,e),e);(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const g of document.querySelectorAll('link[rel="modulepreload"]'))n(g);new MutationObserver(g=>{for(const y of g)if(y.type==="childList")for(const i of y.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function e(g){const y={};return g.integrity&&(y.integrity=g.integrity),g.referrerPolicy&&(y.referrerPolicy=g.referrerPolicy),g.crossOrigin==="use-credentials"?y.credentials="include":g.crossOrigin==="anonymous"?y.credentials="omit":y.credentials="same-origin",y}function n(g){if(g.ep)return;g.ep=!0;const y=e(g);fetch(g.href,y)}})();/**
* @vue/shared v3.4.20
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function makeMap(t,r){const e=new Set(t.split(","));return r?n=>e.has(n.toLowerCase()):n=>e.has(n)}const EMPTY_OBJ={},EMPTY_ARR=[],NOOP=()=>{},NO=()=>!1,isOn=t=>t.charCodeAt(0)===111&&t.charCodeAt(1)===110&&(t.charCodeAt(2)>122||t.charCodeAt(2)<97),isModelListener=t=>t.startsWith("onUpdate:"),extend$1=Object.assign,remove=(t,r)=>{const e=t.indexOf(r);e>-1&&t.splice(e,1)},hasOwnProperty$f=Object.prototype.hasOwnProperty,hasOwn=(t,r)=>hasOwnProperty$f.call(t,r),isArray$3=Array.isArray,isMap$2=t=>toTypeString(t)==="[object Map]",isSet$2=t=>toTypeString(t)==="[object Set]",isDate$1=t=>toTypeString(t)==="[object Date]",isFunction$3=t=>typeof t=="function",isString$2=t=>typeof t=="string",isSymbol$1=t=>typeof t=="symbol",isObject$2=t=>t!==null&&typeof t=="object",isPromise=t=>(isObject$2(t)||isFunction$3(t))&&isFunction$3(t.then)&&isFunction$3(t.catch),objectToString$1=Object.prototype.toString,toTypeString=t=>objectToString$1.call(t),toRawType=t=>toTypeString(t).slice(8,-1),isPlainObject$2=t=>toTypeString(t)==="[object Object]",isIntegerKey=t=>isString$2(t)&&t!=="NaN"&&t[0]!=="-"&&""+parseInt(t,10)===t,isReservedProp=makeMap(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),cacheStringFunction=t=>{const r=Object.create(null);return e=>r[e]||(r[e]=t(e))},camelizeRE=/-(\w)/g,camelize=cacheStringFunction(t=>t.replace(camelizeRE,(r,e)=>e?e.toUpperCase():"")),hyphenateRE=/\B([A-Z])/g,hyphenate=cacheStringFunction(t=>t.replace(hyphenateRE,"-$1").toLowerCase()),capitalize$1=cacheStringFunction(t=>t.charAt(0).toUpperCase()+t.slice(1)),toHandlerKey=cacheStringFunction(t=>t?`on${capitalize$1(t)}`:""),hasChanged=(t,r)=>!Object.is(t,r),invokeArrayFns=(t,r)=>{for(let e=0;e<t.length;e++)t[e](r)},def=(t,r,e)=>{Object.defineProperty(t,r,{configurable:!0,enumerable:!1,value:e})},looseToNumber=t=>{const r=parseFloat(t);return isNaN(r)?t:r},toNumber$1=t=>{const r=isString$2(t)?Number(t):NaN;return isNaN(r)?t:r};let _globalThis;const getGlobalThis=()=>_globalThis||(_globalThis=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function normalizeStyle(t){if(isArray$3(t)){const r={};for(let e=0;e<t.length;e++){const n=t[e],g=isString$2(n)?parseStringStyle(n):normalizeStyle(n);if(g)for(const y in g)r[y]=g[y]}return r}else if(isString$2(t)||isObject$2(t))return t}const listDelimiterRE=/;(?![^(]*\))/g,propertyDelimiterRE=/:([^]+)/,styleCommentRE=/\/\*[^]*?\*\//g;function parseStringStyle(t){const r={};return t.replace(styleCommentRE,"").split(listDelimiterRE).forEach(e=>{if(e){const n=e.split(propertyDelimiterRE);n.length>1&&(r[n[0].trim()]=n[1].trim())}}),r}function normalizeClass(t){let r="";if(isString$2(t))r=t;else if(isArray$3(t))for(let e=0;e<t.length;e++){const n=normalizeClass(t[e]);n&&(r+=n+" ")}else if(isObject$2(t))for(const e in t)t[e]&&(r+=e+" ");return r.trim()}const specialBooleanAttrs="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",isSpecialBooleanAttr=makeMap(specialBooleanAttrs);function includeBooleanAttr(t){return!!t||t===""}function looseCompareArrays(t,r){if(t.length!==r.length)return!1;let e=!0;for(let n=0;e&&n<t.length;n++)e=looseEqual(t[n],r[n]);return e}function looseEqual(t,r){if(t===r)return!0;let e=isDate$1(t),n=isDate$1(r);if(e||n)return e&&n?t.getTime()===r.getTime():!1;if(e=isSymbol$1(t),n=isSymbol$1(r),e||n)return t===r;if(e=isArray$3(t),n=isArray$3(r),e||n)return e&&n?looseCompareArrays(t,r):!1;if(e=isObject$2(t),n=isObject$2(r),e||n){if(!e||!n)return!1;const g=Object.keys(t).length,y=Object.keys(r).length;if(g!==y)return!1;for(const i in t){const k=t.hasOwnProperty(i),$=r.hasOwnProperty(i);if(k&&!$||!k&&$||!looseEqual(t[i],r[i]))return!1}}return String(t)===String(r)}function looseIndexOf(t,r){return t.findIndex(e=>looseEqual(e,r))}const toDisplayString=t=>isString$2(t)?t:t==null?"":isArray$3(t)||isObject$2(t)&&(t.toString===objectToString$1||!isFunction$3(t.toString))?JSON.stringify(t,replacer,2):String(t),replacer=(t,r)=>r&&r.__v_isRef?replacer(t,r.value):isMap$2(r)?{[`Map(${r.size})`]:[...r.entries()].reduce((e,[n,g],y)=>(e[stringifySymbol(n,y)+" =>"]=g,e),{})}:isSet$2(r)?{[`Set(${r.size})`]:[...r.values()].map(e=>stringifySymbol(e))}:isSymbol$1(r)?stringifySymbol(r):isObject$2(r)&&!isArray$3(r)&&!isPlainObject$2(r)?String(r):r,stringifySymbol=(t,r="")=>{var e;return isSymbol$1(t)?`Symbol(${(e=t.description)!=null?e:r})`:t};/**
* @vue/reactivity v3.4.20
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let activeEffectScope;class EffectScope{constructor(r=!1){this.detached=r,this._active=!0,this.effects=[],this.cleanups=[],this.parent=activeEffectScope,!r&&activeEffectScope&&(this.index=(activeEffectScope.scopes||(activeEffectScope.scopes=[])).push(this)-1)}get active(){return this._active}run(r){if(this._active){const e=activeEffectScope;try{return activeEffectScope=this,r()}finally{activeEffectScope=e}}}on(){activeEffectScope=this}off(){activeEffectScope=this.parent}stop(r){if(this._active){let e,n;for(e=0,n=this.effects.length;e<n;e++)this.effects[e].stop();for(e=0,n=this.cleanups.length;e<n;e++)this.cleanups[e]();if(this.scopes)for(e=0,n=this.scopes.length;e<n;e++)this.scopes[e].stop(!0);if(!this.detached&&this.parent&&!r){const g=this.parent.scopes.pop();g&&g!==this&&(this.parent.scopes[this.index]=g,g.index=this.index)}this.parent=void 0,this._active=!1}}}function effectScope(t){return new EffectScope(t)}function recordEffectScope(t,r=activeEffectScope){r&&r.active&&r.effects.push(t)}function getCurrentScope(){return activeEffectScope}function onScopeDispose(t){activeEffectScope&&activeEffectScope.cleanups.push(t)}let activeEffect;class ReactiveEffect{constructor(r,e,n,g){this.fn=r,this.trigger=e,this.scheduler=n,this.active=!0,this.deps=[],this._dirtyLevel=4,this._trackId=0,this._runnings=0,this._shouldSchedule=!1,this._depsLength=0,recordEffectScope(this,g)}get dirty(){if(this._dirtyLevel===2||this._dirtyLevel===3){this._dirtyLevel=1,pauseTracking();for(let r=0;r<this._depsLength;r++){const e=this.deps[r];if(e.computed&&(triggerComputed(e.computed),this._dirtyLevel>=4))break}this._dirtyLevel===1&&(this._dirtyLevel=0),resetTracking()}return this._dirtyLevel>=4}set dirty(r){this._dirtyLevel=r?4:0}run(){if(this._dirtyLevel=0,!this.active)return this.fn();let r=shouldTrack,e=activeEffect;try{return shouldTrack=!0,activeEffect=this,this._runnings++,preCleanupEffect(this),this.fn()}finally{postCleanupEffect(this),this._runnings--,activeEffect=e,shouldTrack=r}}stop(){var r;this.active&&(preCleanupEffect(this),postCleanupEffect(this),(r=this.onStop)==null||r.call(this),this.active=!1)}}function triggerComputed(t){return t.value}function preCleanupEffect(t){t._trackId++,t._depsLength=0}function postCleanupEffect(t){if(t.deps.length>t._depsLength){for(let r=t._depsLength;r<t.deps.length;r++)cleanupDepEffect(t.deps[r],t);t.deps.length=t._depsLength}}function cleanupDepEffect(t,r){const e=t.get(r);e!==void 0&&r._trackId!==e&&(t.delete(r),t.size===0&&t.cleanup())}let shouldTrack=!0,pauseScheduleStack=0;const trackStack=[];function pauseTracking(){trackStack.push(shouldTrack),shouldTrack=!1}function resetTracking(){const t=trackStack.pop();shouldTrack=t===void 0?!0:t}function pauseScheduling(){pauseScheduleStack++}function resetScheduling(){for(pauseScheduleStack--;!pauseScheduleStack&&queueEffectSchedulers.length;)queueEffectSchedulers.shift()()}function trackEffect(t,r,e){if(r.get(t)!==t._trackId){r.set(t,t._trackId);const n=t.deps[t._depsLength];n!==r?(n&&cleanupDepEffect(n,t),t.deps[t._depsLength++]=r):t._depsLength++}}const queueEffectSchedulers=[];function triggerEffects(t,r,e){pauseScheduling();for(const n of t.keys()){let g;n._dirtyLevel<r&&(g??(g=t.get(n)===n._trackId))&&(n._shouldSchedule||(n._shouldSchedule=n._dirtyLevel===0),n._dirtyLevel=r),n._shouldSchedule&&(g??(g=t.get(n)===n._trackId))&&(n.trigger(),(!n._runnings||n.allowRecurse)&&n._dirtyLevel!==2&&(n._shouldSchedule=!1,n.scheduler&&queueEffectSchedulers.push(n.scheduler)))}resetScheduling()}const createDep=(t,r)=>{const e=new Map;return e.cleanup=t,e.computed=r,e},targetMap=new WeakMap,ITERATE_KEY=Symbol(""),MAP_KEY_ITERATE_KEY=Symbol("");function track(t,r,e){if(shouldTrack&&activeEffect){let n=targetMap.get(t);n||targetMap.set(t,n=new Map);let g=n.get(e);g||n.set(e,g=createDep(()=>n.delete(e))),trackEffect(activeEffect,g)}}function trigger(t,r,e,n,g,y){const i=targetMap.get(t);if(!i)return;let k=[];if(r==="clear")k=[...i.values()];else if(e==="length"&&isArray$3(t)){const $=Number(n);i.forEach((L,V)=>{(V==="length"||!isSymbol$1(V)&&V>=$)&&k.push(L)})}else switch(e!==void 0&&k.push(i.get(e)),r){case"add":isArray$3(t)?isIntegerKey(e)&&k.push(i.get("length")):(k.push(i.get(ITERATE_KEY)),isMap$2(t)&&k.push(i.get(MAP_KEY_ITERATE_KEY)));break;case"delete":isArray$3(t)||(k.push(i.get(ITERATE_KEY)),isMap$2(t)&&k.push(i.get(MAP_KEY_ITERATE_KEY)));break;case"set":isMap$2(t)&&k.push(i.get(ITERATE_KEY));break}pauseScheduling();for(const $ of k)$&&triggerEffects($,4);resetScheduling()}function getDepFromReactive(t,r){var e;return(e=targetMap.get(t))==null?void 0:e.get(r)}const isNonTrackableKeys=makeMap("__proto__,__v_isRef,__isVue"),builtInSymbols=new Set(Object.getOwnPropertyNames(Symbol).filter(t=>t!=="arguments"&&t!=="caller").map(t=>Symbol[t]).filter(isSymbol$1)),arrayInstrumentations=createArrayInstrumentations();function createArrayInstrumentations(){const t={};return["includes","indexOf","lastIndexOf"].forEach(r=>{t[r]=function(...e){const n=toRaw(this);for(let y=0,i=this.length;y<i;y++)track(n,"get",y+"");const g=n[r](...e);return g===-1||g===!1?n[r](...e.map(toRaw)):g}}),["push","pop","shift","unshift","splice"].forEach(r=>{t[r]=function(...e){pauseTracking(),pauseScheduling();const n=toRaw(this)[r].apply(this,e);return resetScheduling(),resetTracking(),n}}),t}function hasOwnProperty$e(t){const r=toRaw(this);return track(r,"has",t),r.hasOwnProperty(t)}class BaseReactiveHandler{constructor(r=!1,e=!1){this._isReadonly=r,this._isShallow=e}get(r,e,n){const g=this._isReadonly,y=this._isShallow;if(e==="__v_isReactive")return!g;if(e==="__v_isReadonly")return g;if(e==="__v_isShallow")return y;if(e==="__v_raw")return n===(g?y?shallowReadonlyMap:readonlyMap:y?shallowReactiveMap:reactiveMap).get(r)||Object.getPrototypeOf(r)===Object.getPrototypeOf(n)?r:void 0;const i=isArray$3(r);if(!g){if(i&&hasOwn(arrayInstrumentations,e))return Reflect.get(arrayInstrumentations,e,n);if(e==="hasOwnProperty")return hasOwnProperty$e}const k=Reflect.get(r,e,n);return(isSymbol$1(e)?builtInSymbols.has(e):isNonTrackableKeys(e))||(g||track(r,"get",e),y)?k:isRef(k)?i&&isIntegerKey(e)?k:k.value:isObject$2(k)?g?readonly(k):reactive(k):k}}class MutableReactiveHandler extends BaseReactiveHandler{constructor(r=!1){super(!1,r)}set(r,e,n,g){let y=r[e];if(!this._isShallow){const $=isReadonly(y);if(!isShallow(n)&&!isReadonly(n)&&(y=toRaw(y),n=toRaw(n)),!isArray$3(r)&&isRef(y)&&!isRef(n))return $?!1:(y.value=n,!0)}const i=isArray$3(r)&&isIntegerKey(e)?Number(e)<r.length:hasOwn(r,e),k=Reflect.set(r,e,n,g);return r===toRaw(g)&&(i?hasChanged(n,y)&&trigger(r,"set",e,n):trigger(r,"add",e,n)),k}deleteProperty(r,e){const n=hasOwn(r,e);r[e];const g=Reflect.deleteProperty(r,e);return g&&n&&trigger(r,"delete",e,void 0),g}has(r,e){const n=Reflect.has(r,e);return(!isSymbol$1(e)||!builtInSymbols.has(e))&&track(r,"has",e),n}ownKeys(r){return track(r,"iterate",isArray$3(r)?"length":ITERATE_KEY),Reflect.ownKeys(r)}}class ReadonlyReactiveHandler extends BaseReactiveHandler{constructor(r=!1){super(!0,r)}set(r,e){return!0}deleteProperty(r,e){return!0}}const mutableHandlers=new MutableReactiveHandler,readonlyHandlers=new ReadonlyReactiveHandler,shallowReactiveHandlers=new MutableReactiveHandler(!0),toShallow=t=>t,getProto=t=>Reflect.getPrototypeOf(t);function get$1(t,r,e=!1,n=!1){t=t.__v_raw;const g=toRaw(t),y=toRaw(r);e||(hasChanged(r,y)&&track(g,"get",r),track(g,"get",y));const{has:i}=getProto(g),k=n?toShallow:e?toReadonly:toReactive;if(i.call(g,r))return k(t.get(r));if(i.call(g,y))return k(t.get(y));t!==g&&t.get(r)}function has(t,r=!1){const e=this.__v_raw,n=toRaw(e),g=toRaw(t);return r||(hasChanged(t,g)&&track(n,"has",t),track(n,"has",g)),t===g?e.has(t):e.has(t)||e.has(g)}function size(t,r=!1){return t=t.__v_raw,!r&&track(toRaw(t),"iterate",ITERATE_KEY),Reflect.get(t,"size",t)}function add(t){t=toRaw(t);const r=toRaw(this);return getProto(r).has.call(r,t)||(r.add(t),trigger(r,"add",t,t)),this}function set$1(t,r){r=toRaw(r);const e=toRaw(this),{has:n,get:g}=getProto(e);let y=n.call(e,t);y||(t=toRaw(t),y=n.call(e,t));const i=g.call(e,t);return e.set(t,r),y?hasChanged(r,i)&&trigger(e,"set",t,r):trigger(e,"add",t,r),this}function deleteEntry(t){const r=toRaw(this),{has:e,get:n}=getProto(r);let g=e.call(r,t);g||(t=toRaw(t),g=e.call(r,t)),n&&n.call(r,t);const y=r.delete(t);return g&&trigger(r,"delete",t,void 0),y}function clear(){const t=toRaw(this),r=t.size!==0,e=t.clear();return r&&trigger(t,"clear",void 0,void 0),e}function createForEach(t,r){return function(n,g){const y=this,i=y.__v_raw,k=toRaw(i),$=r?toShallow:t?toReadonly:toReactive;return!t&&track(k,"iterate",ITERATE_KEY),i.forEach((L,V)=>n.call(g,$(L),$(V),y))}}function createIterableMethod(t,r,e){return function(...n){const g=this.__v_raw,y=toRaw(g),i=isMap$2(y),k=t==="entries"||t===Symbol.iterator&&i,$=t==="keys"&&i,L=g[t](...n),V=e?toShallow:r?toReadonly:toReactive;return!r&&track(y,"iterate",$?MAP_KEY_ITERATE_KEY:ITERATE_KEY),{next(){const{value:z,done:re}=L.next();return re?{value:z,done:re}:{value:k?[V(z[0]),V(z[1])]:V(z),done:re}},[Symbol.iterator](){return this}}}}function createReadonlyMethod(t){return function(...r){return t==="delete"?!1:t==="clear"?void 0:this}}function createInstrumentations(){const t={get(y){return get$1(this,y)},get size(){return size(this)},has,add,set:set$1,delete:deleteEntry,clear,forEach:createForEach(!1,!1)},r={get(y){return get$1(this,y,!1,!0)},get size(){return size(this)},has,add,set:set$1,delete:deleteEntry,clear,forEach:createForEach(!1,!0)},e={get(y){return get$1(this,y,!0)},get size(){return size(this,!0)},has(y){return has.call(this,y,!0)},add:createReadonlyMethod("add"),set:createReadonlyMethod("set"),delete:createReadonlyMethod("delete"),clear:createReadonlyMethod("clear"),forEach:createForEach(!0,!1)},n={get(y){return get$1(this,y,!0,!0)},get size(){return size(this,!0)},has(y){return has.call(this,y,!0)},add:createReadonlyMethod("add"),set:createReadonlyMethod("set"),delete:createReadonlyMethod("delete"),clear:createReadonlyMethod("clear"),forEach:createForEach(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach(y=>{t[y]=createIterableMethod(y,!1,!1),e[y]=createIterableMethod(y,!0,!1),r[y]=createIterableMethod(y,!1,!0),n[y]=createIterableMethod(y,!0,!0)}),[t,e,r,n]}const[mutableInstrumentations,readonlyInstrumentations,shallowInstrumentations,shallowReadonlyInstrumentations]=createInstrumentations();function createInstrumentationGetter(t,r){const e=r?t?shallowReadonlyInstrumentations:shallowInstrumentations:t?readonlyInstrumentations:mutableInstrumentations;return(n,g,y)=>g==="__v_isReactive"?!t:g==="__v_isReadonly"?t:g==="__v_raw"?n:Reflect.get(hasOwn(e,g)&&g in n?e:n,g,y)}const mutableCollectionHandlers={get:createInstrumentationGetter(!1,!1)},shallowCollectionHandlers={get:createInstrumentationGetter(!1,!0)},readonlyCollectionHandlers={get:createInstrumentationGetter(!0,!1)},reactiveMap=new WeakMap,shallowReactiveMap=new WeakMap,readonlyMap=new WeakMap,shallowReadonlyMap=new WeakMap;function targetTypeMap(t){switch(t){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function getTargetType(t){return t.__v_skip||!Object.isExtensible(t)?0:targetTypeMap(toRawType(t))}function reactive(t){return isReadonly(t)?t:createReactiveObject(t,!1,mutableHandlers,mutableCollectionHandlers,reactiveMap)}function shallowReactive(t){return createReactiveObject(t,!1,shallowReactiveHandlers,shallowCollectionHandlers,shallowReactiveMap)}function readonly(t){return createReactiveObject(t,!0,readonlyHandlers,readonlyCollectionHandlers,readonlyMap)}function createReactiveObject(t,r,e,n,g){if(!isObject$2(t)||t.__v_raw&&!(r&&t.__v_isReactive))return t;const y=g.get(t);if(y)return y;const i=getTargetType(t);if(i===0)return t;const k=new Proxy(t,i===2?n:e);return g.set(t,k),k}function isReactive(t){return isReadonly(t)?isReactive(t.__v_raw):!!(t&&t.__v_isReactive)}function isReadonly(t){return!!(t&&t.__v_isReadonly)}function isShallow(t){return!!(t&&t.__v_isShallow)}function isProxy(t){return isReactive(t)||isReadonly(t)}function toRaw(t){const r=t&&t.__v_raw;return r?toRaw(r):t}function markRaw(t){return Object.isExtensible(t)&&def(t,"__v_skip",!0),t}const toReactive=t=>isObject$2(t)?reactive(t):t,toReadonly=t=>isObject$2(t)?readonly(t):t;class ComputedRefImpl{constructor(r,e,n,g){this.getter=r,this._setter=e,this.dep=void 0,this.__v_isRef=!0,this.__v_isReadonly=!1,this.effect=new ReactiveEffect(()=>r(this._value),()=>triggerRefValue(this,this.effect._dirtyLevel===2?2:3)),this.effect.computed=this,this.effect.active=this._cacheable=!g,this.__v_isReadonly=n}get value(){const r=toRaw(this);return(!r._cacheable||r.effect.dirty)&&hasChanged(r._value,r._value=r.effect.run())&&triggerRefValue(r,4),trackRefValue(r),r.effect._dirtyLevel>=2&&triggerRefValue(r,2),r._value}set value(r){this._setter(r)}get _dirty(){return this.effect.dirty}set _dirty(r){this.effect.dirty=r}}function computed$1(t,r,e=!1){let n,g;const y=isFunction$3(t);return y?(n=t,g=NOOP):(n=t.get,g=t.set),new ComputedRefImpl(n,g,y||!g,e)}function trackRefValue(t){var r;shouldTrack&&activeEffect&&(t=toRaw(t),trackEffect(activeEffect,(r=t.dep)!=null?r:t.dep=createDep(()=>t.dep=void 0,t instanceof ComputedRefImpl?t:void 0)))}function triggerRefValue(t,r=4,e){t=toRaw(t);const n=t.dep;n&&triggerEffects(n,r)}function isRef(t){return!!(t&&t.__v_isRef===!0)}function ref(t){return createRef(t,!1)}function shallowRef(t){return createRef(t,!0)}function createRef(t,r){return isRef(t)?t:new RefImpl(t,r)}class RefImpl{constructor(r,e){this.__v_isShallow=e,this.dep=void 0,this.__v_isRef=!0,this._rawValue=e?r:toRaw(r),this._value=e?r:toReactive(r)}get value(){return trackRefValue(this),this._value}set value(r){const e=this.__v_isShallow||isShallow(r)||isReadonly(r);r=e?r:toRaw(r),hasChanged(r,this._rawValue)&&(this._rawValue=r,this._value=e?r:toReactive(r),triggerRefValue(this,4))}}function unref(t){return isRef(t)?t.value:t}const shallowUnwrapHandlers={get:(t,r,e)=>unref(Reflect.get(t,r,e)),set:(t,r,e,n)=>{const g=t[r];return isRef(g)&&!isRef(e)?(g.value=e,!0):Reflect.set(t,r,e,n)}};function proxyRefs(t){return isReactive(t)?t:new Proxy(t,shallowUnwrapHandlers)}function toRefs(t){const r=isArray$3(t)?new Array(t.length):{};for(const e in t)r[e]=propertyToRef(t,e);return r}class ObjectRefImpl{constructor(r,e,n){this._object=r,this._key=e,this._defaultValue=n,this.__v_isRef=!0}get value(){const r=this._object[this._key];return r===void 0?this._defaultValue:r}set value(r){this._object[this._key]=r}get dep(){return getDepFromReactive(toRaw(this._object),this._key)}}class GetterRefImpl{constructor(r){this._getter=r,this.__v_isRef=!0,this.__v_isReadonly=!0}get value(){return this._getter()}}function toRef(t,r,e){return isRef(t)?t:isFunction$3(t)?new GetterRefImpl(t):isObject$2(t)&&arguments.length>1?propertyToRef(t,r,e):ref(t)}function propertyToRef(t,r,e){const n=t[r];return isRef(n)?n:new ObjectRefImpl(t,r,e)}/**
* @vue/runtime-core v3.4.20
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/const stack=[];function warn$1(t,...r){pauseTracking();const e=stack.length?stack[stack.length-1].component:null,n=e&&e.appContext.config.warnHandler,g=getComponentTrace();if(n)callWithErrorHandling(n,e,11,[t+r.join(""),e&&e.proxy,g.map(({vnode:y})=>`at <${formatComponentName(e,y.type)}>`).join(`
`),g]);else{const y=[`[Vue warn]: ${t}`,...r];g.length&&y.push(`
`,...formatTrace(g)),console.warn(...y)}resetTracking()}function getComponentTrace(){let t=stack[stack.length-1];if(!t)return[];const r=[];for(;t;){const e=r[0];e&&e.vnode===t?e.recurseCount++:r.push({vnode:t,recurseCount:0});const n=t.component&&t.component.parent;t=n&&n.vnode}return r}function formatTrace(t){const r=[];return t.forEach((e,n)=>{r.push(...n===0?[]:[`
`],...formatTraceEntry(e))}),r}function formatTraceEntry({vnode:t,recurseCount:r}){const e=r>0?`... (${r} recursive calls)`:"",n=t.component?t.component.parent==null:!1,g=` at <${formatComponentName(t.component,t.type,n)}`,y=">"+e;return t.props?[g,...formatProps(t.props),y]:[g+y]}function formatProps(t){const r=[],e=Object.keys(t);return e.slice(0,3).forEach(n=>{r.push(...formatProp(n,t[n]))}),e.length>3&&r.push(" ..."),r}function formatProp(t,r,e){return isString$2(r)?(r=JSON.stringify(r),e?r:[`${t}=${r}`]):typeof r=="number"||typeof r=="boolean"||r==null?e?r:[`${t}=${r}`]:isRef(r)?(r=formatProp(t,toRaw(r.value),!0),e?r:[`${t}=Ref<`,r,">"]):isFunction$3(r)?[`${t}=fn${r.name?`<${r.name}>`:""}`]:(r=toRaw(r),e?r:[`${t}=`,r])}function callWithErrorHandling(t,r,e,n){try{return n?t(...n):t()}catch(g){handleError(g,r,e)}}function callWithAsyncErrorHandling(t,r,e,n){if(isFunction$3(t)){const y=callWithErrorHandling(t,r,e,n);return y&&isPromise(y)&&y.catch(i=>{handleError(i,r,e)}),y}const g=[];for(let y=0;y<t.length;y++)g.push(callWithAsyncErrorHandling(t[y],r,e,n));return g}function handleError(t,r,e,n=!0){const g=r?r.vnode:null;if(r){let y=r.parent;const i=r.proxy,k=`https://vuejs.org/error-reference/#runtime-${e}`;for(;y;){const L=y.ec;if(L){for(let V=0;V<L.length;V++)if(L[V](t,i,k)===!1)return}y=y.parent}const $=r.appContext.config.errorHandler;if($){callWithErrorHandling($,null,10,[t,i,k]);return}}logError(t,e,g,n)}function logError(t,r,e,n=!0){console.error(t)}let isFlushing=!1,isFlushPending=!1;const queue=[];let flushIndex=0;const pendingPostFlushCbs=[];let activePostFlushCbs=null,postFlushIndex=0;const resolvedPromise=Promise.resolve();let currentFlushPromise=null;function nextTick(t){const r=currentFlushPromise||resolvedPromise;return t?r.then(this?t.bind(this):t):r}function findInsertionIndex(t){let r=flushIndex+1,e=queue.length;for(;r<e;){const n=r+e>>>1,g=queue[n],y=getId(g);y<t||y===t&&g.pre?r=n+1:e=n}return r}function queueJob(t){(!queue.length||!queue.includes(t,isFlushing&&t.allowRecurse?flushIndex+1:flushIndex))&&(t.id==null?queue.push(t):queue.splice(findInsertionIndex(t.id),0,t),queueFlush())}function queueFlush(){!isFlushing&&!isFlushPending&&(isFlushPending=!0,currentFlushPromise=resolvedPromise.then(flushJobs))}function invalidateJob(t){const r=queue.indexOf(t);r>flushIndex&&queue.splice(r,1)}function queuePostFlushCb(t){isArray$3(t)?pendingPostFlushCbs.push(...t):(!activePostFlushCbs||!activePostFlushCbs.includes(t,t.allowRecurse?postFlushIndex+1:postFlushIndex))&&pendingPostFlushCbs.push(t),queueFlush()}function flushPreFlushCbs(t,r,e=isFlushing?flushIndex+1:0){for(;e<queue.length;e++){const n=queue[e];if(n&&n.pre){if(t&&n.id!==t.uid)continue;queue.splice(e,1),e--,n()}}}function flushPostFlushCbs(t){if(pendingPostFlushCbs.length){const r=[...new Set(pendingPostFlushCbs)].sort((e,n)=>getId(e)-getId(n));if(pendingPostFlushCbs.length=0,activePostFlushCbs){activePostFlushCbs.push(...r);return}for(activePostFlushCbs=r,postFlushIndex=0;postFlushIndex<activePostFlushCbs.length;postFlushIndex++)activePostFlushCbs[postFlushIndex]();activePostFlushCbs=null,postFlushIndex=0}}const getId=t=>t.id==null?1/0:t.id,comparator=(t,r)=>{const e=getId(t)-getId(r);if(e===0){if(t.pre&&!r.pre)return-1;if(r.pre&&!t.pre)return 1}return e};function flushJobs(t){isFlushPending=!1,isFlushing=!0,queue.sort(comparator);const r=NOOP;try{for(flushIndex=0;flushIndex<queue.length;flushIndex++){const e=queue[flushIndex];e&&e.active!==!1&&callWithErrorHandling(e,null,14)}}finally{flushIndex=0,queue.length=0,flushPostFlushCbs(),isFlushing=!1,currentFlushPromise=null,(queue.length||pendingPostFlushCbs.length)&&flushJobs()}}function emit(t,r,...e){if(t.isUnmounted)return;const n=t.vnode.props||EMPTY_OBJ;let g=e;const y=r.startsWith("update:"),i=y&&r.slice(7);if(i&&i in n){const V=`${i==="modelValue"?"model":i}Modifiers`,{number:z,trim:re}=n[V]||EMPTY_OBJ;re&&(g=e.map(ie=>isString$2(ie)?ie.trim():ie)),z&&(g=e.map(looseToNumber))}let k,$=n[k=toHandlerKey(r)]||n[k=toHandlerKey(camelize(r))];!$&&y&&($=n[k=toHandlerKey(hyphenate(r))]),$&&callWithAsyncErrorHandling($,t,6,g);const L=n[k+"Once"];if(L){if(!t.emitted)t.emitted={};else if(t.emitted[k])return;t.emitted[k]=!0,callWithAsyncErrorHandling(L,t,6,g)}}function normalizeEmitsOptions(t,r,e=!1){const n=r.emitsCache,g=n.get(t);if(g!==void 0)return g;const y=t.emits;let i={},k=!1;if(!isFunction$3(t)){const $=L=>{const V=normalizeEmitsOptions(L,r,!0);V&&(k=!0,extend$1(i,V))};!e&&r.mixins.length&&r.mixins.forEach($),t.extends&&$(t.extends),t.mixins&&t.mixins.forEach($)}return!y&&!k?(isObject$2(t)&&n.set(t,null),null):(isArray$3(y)?y.forEach($=>i[$]=null):extend$1(i,y),isObject$2(t)&&n.set(t,i),i)}function isEmitListener(t,r){return!t||!isOn(r)?!1:(r=r.slice(2).replace(/Once$/,""),hasOwn(t,r[0].toLowerCase()+r.slice(1))||hasOwn(t,hyphenate(r))||hasOwn(t,r))}let currentRenderingInstance=null,currentScopeId=null;function setCurrentRenderingInstance(t){const r=currentRenderingInstance;return currentRenderingInstance=t,currentScopeId=t&&t.type.__scopeId||null,r}function withCtx(t,r=currentRenderingInstance,e){if(!r||t._n)return t;const n=(...g)=>{n._d&&setBlockTracking(-1);const y=setCurrentRenderingInstance(r);let i;try{i=t(...g)}finally{setCurrentRenderingInstance(y),n._d&&setBlockTracking(1)}return i};return n._n=!0,n._c=!0,n._d=!0,n}function markAttrsAccessed(){}function renderComponentRoot(t){const{type:r,vnode:e,proxy:n,withProxy:g,props:y,propsOptions:[i],slots:k,attrs:$,emit:L,render:V,renderCache:z,data:re,setupState:ie,ctx:ue,inheritAttrs:le}=t;let oe,ae;const qe=setCurrentRenderingInstance(t);try{if(e.shapeFlag&4){const Ne=g||n,ze=Ne;oe=normalizeVNode(V.call(ze,Ne,z,y,ie,re,ue)),ae=$}else{const Ne=r;oe=normalizeVNode(Ne.length>1?Ne(y,{attrs:$,slots:k,emit:L}):Ne(y,null)),ae=r.props?$:getFunctionalFallthrough($)}}catch(Ne){blockStack.length=0,handleError(Ne,t,1),oe=createVNode(Comment)}let de=oe;if(ae&&le!==!1){const Ne=Object.keys(ae),{shapeFlag:ze}=de;Ne.length&&ze&7&&(i&&Ne.some(isModelListener)&&(ae=filterModelListeners(ae,i)),de=cloneVNode(de,ae))}return e.dirs&&(de=cloneVNode(de),de.dirs=de.dirs?de.dirs.concat(e.dirs):e.dirs),e.transition&&(de.transition=e.transition),oe=de,setCurrentRenderingInstance(qe),oe}const getFunctionalFallthrough=t=>{let r;for(const e in t)(e==="class"||e==="style"||isOn(e))&&((r||(r={}))[e]=t[e]);return r},filterModelListeners=(t,r)=>{const e={};for(const n in t)(!isModelListener(n)||!(n.slice(9)in r))&&(e[n]=t[n]);return e};function shouldUpdateComponent(t,r,e){const{props:n,children:g,component:y}=t,{props:i,children:k,patchFlag:$}=r,L=y.emitsOptions;if(r.dirs||r.transition)return!0;if(e&&$>=0){if($&1024)return!0;if($&16)return n?hasPropsChanged(n,i,L):!!i;if($&8){const V=r.dynamicProps;for(let z=0;z<V.length;z++){const re=V[z];if(i[re]!==n[re]&&!isEmitListener(L,re))return!0}}}else return(g||k)&&(!k||!k.$stable)?!0:n===i?!1:n?i?hasPropsChanged(n,i,L):!0:!!i;return!1}function hasPropsChanged(t,r,e){const n=Object.keys(r);if(n.length!==Object.keys(t).length)return!0;for(let g=0;g<n.length;g++){const y=n[g];if(r[y]!==t[y]&&!isEmitListener(e,y))return!0}return!1}function updateHOCHostEl({vnode:t,parent:r},e){for(;r;){const n=r.subTree;if(n.suspense&&n.suspense.activeBranch===t&&(n.el=t.el),n===t)(t=r.vnode).el=e,r=r.parent;else break}}const COMPONENTS="components",DIRECTIVES="directives";function resolveComponent(t,r){return resolveAsset(COMPONENTS,t,!0,r)||t}const NULL_DYNAMIC_COMPONENT=Symbol.for("v-ndc");function resolveDynamicComponent(t){return isString$2(t)?resolveAsset(COMPONENTS,t,!1)||t:t||NULL_DYNAMIC_COMPONENT}function resolveDirective(t){return resolveAsset(DIRECTIVES,t)}function resolveAsset(t,r,e=!0,n=!1){const g=currentRenderingInstance||currentInstance;if(g){const y=g.type;if(t===COMPONENTS){const k=getComponentName(y,!1);if(k&&(k===r||k===camelize(r)||k===capitalize$1(camelize(r))))return y}const i=resolve(g[t]||y[t],r)||resolve(g.appContext[t],r);return!i&&n?y:i}}function resolve(t,r){return t&&(t[r]||t[camelize(r)]||t[capitalize$1(camelize(r))])}const isSuspense=t=>t.__isSuspense;function queueEffectWithSuspense(t,r){r&&r.pendingBranch?isArray$3(t)?r.effects.push(...t):r.effects.push(t):queuePostFlushCb(t)}const ssrContextKey=Symbol.for("v-scx"),useSSRContext=()=>inject(ssrContextKey);function watchEffect(t,r){return doWatch(t,null,r)}const INITIAL_WATCHER_VALUE={};function watch(t,r,e){return doWatch(t,r,e)}function doWatch(t,r,{immediate:e,deep:n,flush:g,once:y,onTrack:i,onTrigger:k}=EMPTY_OBJ){if(r&&y){const $e=r;r=(...Lt)=>{$e(...Lt),ze()}}const $=currentInstance,L=$e=>n===!0?$e:traverse($e,n===!1?1:void 0);let V,z=!1,re=!1;if(isRef(t)?(V=()=>t.value,z=isShallow(t)):isReactive(t)?(V=()=>L(t),z=!0):isArray$3(t)?(re=!0,z=t.some($e=>isReactive($e)||isShallow($e)),V=()=>t.map($e=>{if(isRef($e))return $e.value;if(isReactive($e))return L($e);if(isFunction$3($e))return callWithErrorHandling($e,$,2)})):isFunction$3(t)?r?V=()=>callWithErrorHandling(t,$,2):V=()=>(ie&&ie(),callWithAsyncErrorHandling(t,$,3,[ue])):V=NOOP,r&&n){const $e=V;V=()=>traverse($e())}let ie,ue=$e=>{ie=de.onStop=()=>{callWithErrorHandling($e,$,4),ie=de.onStop=void 0}},le;if(isInSSRComponentSetup)if(ue=NOOP,r?e&&callWithAsyncErrorHandling(r,$,3,[V(),re?[]:void 0,ue]):V(),g==="sync"){const $e=useSSRContext();le=$e.__watcherHandles||($e.__watcherHandles=[])}else return NOOP;let oe=re?new Array(t.length).fill(INITIAL_WATCHER_VALUE):INITIAL_WATCHER_VALUE;const ae=()=>{if(!(!de.active||!de.dirty))if(r){const $e=de.run();(n||z||(re?$e.some((Lt,jt)=>hasChanged(Lt,oe[jt])):hasChanged($e,oe)))&&(ie&&ie(),callWithAsyncErrorHandling(r,$,3,[$e,oe===INITIAL_WATCHER_VALUE?void 0:re&&oe[0]===INITIAL_WATCHER_VALUE?[]:oe,ue]),oe=$e)}else de.run()};ae.allowRecurse=!!r;let qe;g==="sync"?qe=ae:g==="post"?qe=()=>queuePostRenderEffect(ae,$&&$.suspense):(ae.pre=!0,$&&(ae.id=$.uid),qe=()=>queueJob(ae));const de=new ReactiveEffect(V,NOOP,qe),Ne=getCurrentScope(),ze=()=>{de.stop(),Ne&&remove(Ne.effects,de)};return r?e?ae():oe=de.run():g==="post"?queuePostRenderEffect(de.run.bind(de),$&&$.suspense):de.run(),le&&le.push(ze),ze}function instanceWatch(t,r,e){const n=this.proxy,g=isString$2(t)?t.includes(".")?createPathGetter(n,t):()=>n[t]:t.bind(n,n);let y;isFunction$3(r)?y=r:(y=r.handler,e=r);const i=setCurrentInstance(this),k=doWatch(g,y.bind(n),e);return i(),k}function createPathGetter(t,r){const e=r.split(".");return()=>{let n=t;for(let g=0;g<e.length&&n;g++)n=n[e[g]];return n}}function traverse(t,r,e=0,n){if(!isObject$2(t)||t.__v_skip)return t;if(r&&r>0){if(e>=r)return t;e++}if(n=n||new Set,n.has(t))return t;if(n.add(t),isRef(t))traverse(t.value,r,e,n);else if(isArray$3(t))for(let g=0;g<t.length;g++)traverse(t[g],r,e,n);else if(isSet$2(t)||isMap$2(t))t.forEach(g=>{traverse(g,r,e,n)});else if(isPlainObject$2(t))for(const g in t)traverse(t[g],r,e,n);return t}function withDirectives(t,r){if(currentRenderingInstance===null)return t;const e=getExposeProxy(currentRenderingInstance)||currentRenderingInstance.proxy,n=t.dirs||(t.dirs=[]);for(let g=0;g<r.length;g++){let[y,i,k,$=EMPTY_OBJ]=r[g];y&&(isFunction$3(y)&&(y={mounted:y,updated:y}),y.deep&&traverse(i),n.push({dir:y,instance:e,value:i,oldValue:void 0,arg:k,modifiers:$}))}return t}function invokeDirectiveHook(t,r,e,n){const g=t.dirs,y=r&&r.dirs;for(let i=0;i<g.length;i++){const k=g[i];y&&(k.oldValue=y[i].value);let $=k.dir[n];$&&(pauseTracking(),callWithAsyncErrorHandling($,e,8,[t.el,k,t,r]),resetTracking())}}const leaveCbKey=Symbol("_leaveCb"),enterCbKey$1=Symbol("_enterCb");function useTransitionState(){const t={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return onMounted(()=>{t.isMounted=!0}),onBeforeUnmount(()=>{t.isUnmounting=!0}),t}const TransitionHookValidator=[Function,Array],BaseTransitionPropsValidators={mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:TransitionHookValidator,onEnter:TransitionHookValidator,onAfterEnter:TransitionHookValidator,onEnterCancelled:TransitionHookValidator,onBeforeLeave:TransitionHookValidator,onLeave:TransitionHookValidator,onAfterLeave:TransitionHookValidator,onLeaveCancelled:TransitionHookValidator,onBeforeAppear:TransitionHookValidator,onAppear:TransitionHookValidator,onAfterAppear:TransitionHookValidator,onAppearCancelled:TransitionHookValidator},BaseTransitionImpl={name:"BaseTransition",props:BaseTransitionPropsValidators,setup(t,{slots:r}){const e=getCurrentInstance(),n=useTransitionState();return()=>{const g=r.default&&getTransitionRawChildren(r.default(),!0);if(!g||!g.length)return;let y=g[0];if(g.length>1){for(const re of g)if(re.type!==Comment){y=re;break}}const i=toRaw(t),{mode:k}=i;if(n.isLeaving)return emptyPlaceholder(y);const $=getKeepAliveChild(y);if(!$)return emptyPlaceholder(y);const L=resolveTransitionHooks($,i,n,e);setTransitionHooks($,L);const V=e.subTree,z=V&&getKeepAliveChild(V);if(z&&z.type!==Comment&&!isSameVNodeType($,z)){const re=resolveTransitionHooks(z,i,n,e);if(setTransitionHooks(z,re),k==="out-in")return n.isLeaving=!0,re.afterLeave=()=>{n.isLeaving=!1,e.update.active!==!1&&(e.effect.dirty=!0,e.update())},emptyPlaceholder(y);k==="in-out"&&$.type!==Comment&&(re.delayLeave=(ie,ue,le)=>{const oe=getLeavingNodesForType(n,z);oe[String(z.key)]=z,ie[leaveCbKey]=()=>{ue(),ie[leaveCbKey]=void 0,delete L.delayedLeave},L.delayedLeave=le})}return y}}},BaseTransition=BaseTransitionImpl;function getLeavingNodesForType(t,r){const{leavingVNodes:e}=t;let n=e.get(r.type);return n||(n=Object.create(null),e.set(r.type,n)),n}function resolveTransitionHooks(t,r,e,n){const{appear:g,mode:y,persisted:i=!1,onBeforeEnter:k,onEnter:$,onAfterEnter:L,onEnterCancelled:V,onBeforeLeave:z,onLeave:re,onAfterLeave:ie,onLeaveCancelled:ue,onBeforeAppear:le,onAppear:oe,onAfterAppear:ae,onAppearCancelled:qe}=r,de=String(t.key),Ne=getLeavingNodesForType(e,t),ze=(jt,Et)=>{jt&&callWithAsyncErrorHandling(jt,n,9,Et)},$e=(jt,Et)=>{const ir=Et[1];ze(jt,Et),isArray$3(jt)?jt.every(dr=>dr.length<=1)&&ir():jt.length<=1&&ir()},Lt={mode:y,persisted:i,beforeEnter(jt){let Et=k;if(!e.isMounted)if(g)Et=le||k;else return;jt[leaveCbKey]&&jt[leaveCbKey](!0);const ir=Ne[de];ir&&isSameVNodeType(t,ir)&&ir.el[leaveCbKey]&&ir.el[leaveCbKey](),ze(Et,[jt])},enter(jt){let Et=$,ir=L,dr=V;if(!e.isMounted)if(g)Et=oe||$,ir=ae||L,dr=qe||V;else return;let Dt=!1;const lr=jt[enterCbKey$1]=sr=>{Dt||(Dt=!0,sr?ze(dr,[jt]):ze(ir,[jt]),Lt.delayedLeave&&Lt.delayedLeave(),jt[enterCbKey$1]=void 0)};Et?$e(Et,[jt,lr]):lr()},leave(jt,Et){const ir=String(t.key);if(jt[enterCbKey$1]&&jt[enterCbKey$1](!0),e.isUnmounting)return Et();ze(z,[jt]);let dr=!1;const Dt=jt[leaveCbKey]=lr=>{dr||(dr=!0,Et(),lr?ze(ue,[jt]):ze(ie,[jt]),jt[leaveCbKey]=void 0,Ne[ir]===t&&delete Ne[ir])};Ne[ir]=t,re?$e(re,[jt,Dt]):Dt()},clone(jt){return resolveTransitionHooks(jt,r,e,n)}};return Lt}function emptyPlaceholder(t){if(isKeepAlive(t))return t=cloneVNode(t),t.children=null,t}function getKeepAliveChild(t){return isKeepAlive(t)?t.children?t.children[0]:void 0:t}function setTransitionHooks(t,r){t.shapeFlag&6&&t.component?setTransitionHooks(t.component.subTree,r):t.shapeFlag&128?(t.ssContent.transition=r.clone(t.ssContent),t.ssFallback.transition=r.clone(t.ssFallback)):t.transition=r}function getTransitionRawChildren(t,r=!1,e){let n=[],g=0;for(let y=0;y<t.length;y++){let i=t[y];const k=e==null?i.key:String(e)+String(i.key!=null?i.key:y);i.type===Fragment?(i.patchFlag&128&&g++,n=n.concat(getTransitionRawChildren(i.children,r,k))):(r||i.type!==Comment)&&n.push(k!=null?cloneVNode(i,{key:k}):i)}if(g>1)for(let y=0;y<n.length;y++)n[y].patchFlag=-2;return n}/*! #__NO_SIDE_EFFECTS__ */function defineComponent(t,r){return isFunction$3(t)?(()=>extend$1({name:t.name},r,{setup:t}))():t}const isAsyncWrapper=t=>!!t.type.__asyncLoader,isKeepAlive=t=>t.type.__isKeepAlive;function onActivated(t,r){registerKeepAliveHook(t,"a",r)}function onDeactivated(t,r){registerKeepAliveHook(t,"da",r)}function registerKeepAliveHook(t,r,e=currentInstance){const n=t.__wdc||(t.__wdc=()=>{let g=e;for(;g;){if(g.isDeactivated)return;g=g.parent}return t()});if(injectHook(r,n,e),e){let g=e.parent;for(;g&&g.parent;)isKeepAlive(g.parent.vnode)&&injectToKeepAliveRoot(n,r,e,g),g=g.parent}}function injectToKeepAliveRoot(t,r,e,n){const g=injectHook(r,t,n,!0);onUnmounted(()=>{remove(n[r],g)},e)}function injectHook(t,r,e=currentInstance,n=!1){if(e){const g=e[t]||(e[t]=[]),y=r.__weh||(r.__weh=(...i)=>{if(e.isUnmounted)return;pauseTracking();const k=setCurrentInstance(e),$=callWithAsyncErrorHandling(r,e,t,i);return k(),resetTracking(),$});return n?g.unshift(y):g.push(y),y}}const createHook=t=>(r,e=currentInstance)=>(!isInSSRComponentSetup||t==="sp")&&injectHook(t,(...n)=>r(...n),e),onBeforeMount=createHook("bm"),onMounted=createHook("m"),onBeforeUpdate=createHook("bu"),onUpdated=createHook("u"),onBeforeUnmount=createHook("bum"),onUnmounted=createHook("um"),onServerPrefetch=createHook("sp"),onRenderTriggered=createHook("rtg"),onRenderTracked=createHook("rtc");function onErrorCaptured(t,r=currentInstance){injectHook("ec",t,r)}function renderList(t,r,e,n){let g;const y=e&&e[n];if(isArray$3(t)||isString$2(t)){g=new Array(t.length);for(let i=0,k=t.length;i<k;i++)g[i]=r(t[i],i,void 0,y&&y[i])}else if(typeof t=="number"){g=new Array(t);for(let i=0;i<t;i++)g[i]=r(i+1,i,void 0,y&&y[i])}else if(isObject$2(t))if(t[Symbol.iterator])g=Array.from(t,(i,k)=>r(i,k,void 0,y&&y[k]));else{const i=Object.keys(t);g=new Array(i.length);for(let k=0,$=i.length;k<$;k++){const L=i[k];g[k]=r(t[L],L,k,y&&y[k])}}else g=[];return e&&(e[n]=g),g}function createSlots(t,r){for(let e=0;e<r.length;e++){const n=r[e];if(isArray$3(n))for(let g=0;g<n.length;g++)t[n[g].name]=n[g].fn;else n&&(t[n.name]=n.key?(...g)=>{const y=n.fn(...g);return y&&(y.key=n.key),y}:n.fn)}return t}function renderSlot(t,r,e={},n,g){if(currentRenderingInstance.isCE||currentRenderingInstance.parent&&isAsyncWrapper(currentRenderingInstance.parent)&&currentRenderingInstance.parent.isCE)return r!=="default"&&(e.name=r),createVNode("slot",e,n&&n());let y=t[r];y&&y._c&&(y._d=!1),openBlock();const i=y&&ensureValidVNode(y(e)),k=createBlock(Fragment,{key:e.key||i&&i.key||`_${r}`},i||(n?n():[]),i&&t._===1?64:-2);return!g&&k.scopeId&&(k.slotScopeIds=[k.scopeId+"-s"]),y&&y._c&&(y._d=!0),k}function ensureValidVNode(t){return t.some(r=>isVNode(r)?!(r.type===Comment||r.type===Fragment&&!ensureValidVNode(r.children)):!0)?t:null}function toHandlers(t,r){const e={};for(const n in t)e[r&&/[A-Z]/.test(n)?`on:${n}`:toHandlerKey(n)]=t[n];return e}const getPublicInstance=t=>t?isStatefulComponent(t)?getExposeProxy(t)||t.proxy:getPublicInstance(t.parent):null,publicPropertiesMap=extend$1(Object.create(null),{$:t=>t,$el:t=>t.vnode.el,$data:t=>t.data,$props:t=>t.props,$attrs:t=>t.attrs,$slots:t=>t.slots,$refs:t=>t.refs,$parent:t=>getPublicInstance(t.parent),$root:t=>getPublicInstance(t.root),$emit:t=>t.emit,$options:t=>resolveMergedOptions(t),$forceUpdate:t=>t.f||(t.f=()=>{t.effect.dirty=!0,queueJob(t.update)}),$nextTick:t=>t.n||(t.n=nextTick.bind(t.proxy)),$watch:t=>instanceWatch.bind(t)}),hasSetupBinding=(t,r)=>t!==EMPTY_OBJ&&!t.__isScriptSetup&&hasOwn(t,r),PublicInstanceProxyHandlers={get({_:t},r){const{ctx:e,setupState:n,data:g,props:y,accessCache:i,type:k,appContext:$}=t;let L;if(r[0]!=="$"){const ie=i[r];if(ie!==void 0)switch(ie){case 1:return n[r];case 2:return g[r];case 4:return e[r];case 3:return y[r]}else{if(hasSetupBinding(n,r))return i[r]=1,n[r];if(g!==EMPTY_OBJ&&hasOwn(g,r))return i[r]=2,g[r];if((L=t.propsOptions[0])&&hasOwn(L,r))return i[r]=3,y[r];if(e!==EMPTY_OBJ&&hasOwn(e,r))return i[r]=4,e[r];shouldCacheAccess&&(i[r]=0)}}const V=publicPropertiesMap[r];let z,re;if(V)return r==="$attrs"&&track(t,"get",r),V(t);if((z=k.__cssModules)&&(z=z[r]))return z;if(e!==EMPTY_OBJ&&hasOwn(e,r))return i[r]=4,e[r];if(re=$.config.globalProperties,hasOwn(re,r))return re[r]},set({_:t},r,e){const{data:n,setupState:g,ctx:y}=t;return hasSetupBinding(g,r)?(g[r]=e,!0):n!==EMPTY_OBJ&&hasOwn(n,r)?(n[r]=e,!0):hasOwn(t.props,r)||r[0]==="$"&&r.slice(1)in t?!1:(y[r]=e,!0)},has({_:{data:t,setupState:r,accessCache:e,ctx:n,appContext:g,propsOptions:y}},i){let k;return!!e[i]||t!==EMPTY_OBJ&&hasOwn(t,i)||hasSetupBinding(r,i)||(k=y[0])&&hasOwn(k,i)||hasOwn(n,i)||hasOwn(publicPropertiesMap,i)||hasOwn(g.config.globalProperties,i)},defineProperty(t,r,e){return e.get!=null?t._.accessCache[r]=0:hasOwn(e,"value")&&this.set(t,r,e.value,null),Reflect.defineProperty(t,r,e)}};function useSlots(){return getContext().slots}function useAttrs$1(){return getContext().attrs}function getContext(){const t=getCurrentInstance();return t.setupContext||(t.setupContext=createSetupContext(t))}function normalizePropsOrEmits(t){return isArray$3(t)?t.reduce((r,e)=>(r[e]=null,r),{}):t}let shouldCacheAccess=!0;function applyOptions(t){const r=resolveMergedOptions(t),e=t.proxy,n=t.ctx;shouldCacheAccess=!1,r.beforeCreate&&callHook$1(r.beforeCreate,t,"bc");const{data:g,computed:y,methods:i,watch:k,provide:$,inject:L,created:V,beforeMount:z,mounted:re,beforeUpdate:ie,updated:ue,activated:le,deactivated:oe,beforeDestroy:ae,beforeUnmount:qe,destroyed:de,unmounted:Ne,render:ze,renderTracked:$e,renderTriggered:Lt,errorCaptured:jt,serverPrefetch:Et,expose:ir,inheritAttrs:dr,components:Dt,directives:lr,filters:sr}=r;if(L&&resolveInjections(L,n,null),i)for(const or in i){const hr=i[or];isFunction$3(hr)&&(n[or]=hr.bind(e))}if(g){const or=g.call(e,e);isObject$2(or)&&(t.data=reactive(or))}if(shouldCacheAccess=!0,y)for(const or in y){const hr=y[or],pr=isFunction$3(hr)?hr.bind(e,e):isFunction$3(hr.get)?hr.get.bind(e,e):NOOP,Sr=!isFunction$3(hr)&&isFunction$3(hr.set)?hr.set.bind(e):NOOP,Er=computed({get:pr,set:Sr});Object.defineProperty(n,or,{enumerable:!0,configurable:!0,get:()=>Er.value,set:Pr=>Er.value=Pr})}if(k)for(const or in k)createWatcher(k[or],n,e,or);if($){const or=isFunction$3($)?$.call(e):$;Reflect.ownKeys(or).forEach(hr=>{provide(hr,or[hr])})}V&&callHook$1(V,t,"c");function cr(or,hr){isArray$3(hr)?hr.forEach(pr=>or(pr.bind(e))):hr&&or(hr.bind(e))}if(cr(onBeforeMount,z),cr(onMounted,re),cr(onBeforeUpdate,ie),cr(onUpdated,ue),cr(onActivated,le),cr(onDeactivated,oe),cr(onErrorCaptured,jt),cr(onRenderTracked,$e),cr(onRenderTriggered,Lt),cr(onBeforeUnmount,qe),cr(onUnmounted,Ne),cr(onServerPrefetch,Et),isArray$3(ir))if(ir.length){const or=t.exposed||(t.exposed={});ir.forEach(hr=>{Object.defineProperty(or,hr,{get:()=>e[hr],set:pr=>e[hr]=pr})})}else t.exposed||(t.exposed={});ze&&t.render===NOOP&&(t.render=ze),dr!=null&&(t.inheritAttrs=dr),Dt&&(t.components=Dt),lr&&(t.directives=lr)}function resolveInjections(t,r,e=NOOP){isArray$3(t)&&(t=normalizeInject(t));for(const n in t){const g=t[n];let y;isObject$2(g)?"default"in g?y=inject(g.from||n,g.default,!0):y=inject(g.from||n):y=inject(g),isRef(y)?Object.defineProperty(r,n,{enumerable:!0,configurable:!0,get:()=>y.value,set:i=>y.value=i}):r[n]=y}}function callHook$1(t,r,e){callWithAsyncErrorHandling(isArray$3(t)?t.map(n=>n.bind(r.proxy)):t.bind(r.proxy),r,e)}function createWatcher(t,r,e,n){const g=n.includes(".")?createPathGetter(e,n):()=>e[n];if(isString$2(t)){const y=r[t];isFunction$3(y)&&watch(g,y)}else if(isFunction$3(t))watch(g,t.bind(e));else if(isObject$2(t))if(isArray$3(t))t.forEach(y=>createWatcher(y,r,e,n));else{const y=isFunction$3(t.handler)?t.handler.bind(e):r[t.handler];isFunction$3(y)&&watch(g,y,t)}}function resolveMergedOptions(t){const r=t.type,{mixins:e,extends:n}=r,{mixins:g,optionsCache:y,config:{optionMergeStrategies:i}}=t.appContext,k=y.get(r);let $;return k?$=k:!g.length&&!e&&!n?$=r:($={},g.length&&g.forEach(L=>mergeOptions$1($,L,i,!0)),mergeOptions$1($,r,i)),isObject$2(r)&&y.set(r,$),$}function mergeOptions$1(t,r,e,n=!1){const{mixins:g,extends:y}=r;y&&mergeOptions$1(t,y,e,!0),g&&g.forEach(i=>mergeOptions$1(t,i,e,!0));for(const i in r)if(!(n&&i==="expose")){const k=internalOptionMergeStrats[i]||e&&e[i];t[i]=k?k(t[i],r[i]):r[i]}return t}const internalOptionMergeStrats={data:mergeDataFn,props:mergeEmitsOrPropsOptions,emits:mergeEmitsOrPropsOptions,methods:mergeObjectOptions,computed:mergeObjectOptions,beforeCreate:mergeAsArray,created:mergeAsArray,beforeMount:mergeAsArray,mounted:mergeAsArray,beforeUpdate:mergeAsArray,updated:mergeAsArray,beforeDestroy:mergeAsArray,beforeUnmount:mergeAsArray,destroyed:mergeAsArray,unmounted:mergeAsArray,activated:mergeAsArray,deactivated:mergeAsArray,errorCaptured:mergeAsArray,serverPrefetch:mergeAsArray,components:mergeObjectOptions,directives:mergeObjectOptions,watch:mergeWatchOptions,provide:mergeDataFn,inject:mergeInject};function mergeDataFn(t,r){return r?t?function(){return extend$1(isFunction$3(t)?t.call(this,this):t,isFunction$3(r)?r.call(this,this):r)}:r:t}function mergeInject(t,r){return mergeObjectOptions(normalizeInject(t),normalizeInject(r))}function normalizeInject(t){if(isArray$3(t)){const r={};for(let e=0;e<t.length;e++)r[t[e]]=t[e];return r}return t}function mergeAsArray(t,r){return t?[...new Set([].concat(t,r))]:r}function mergeObjectOptions(t,r){return t?extend$1(Object.create(null),t,r):r}function mergeEmitsOrPropsOptions(t,r){return t?isArray$3(t)&&isArray$3(r)?[...new Set([...t,...r])]:extend$1(Object.create(null),normalizePropsOrEmits(t),normalizePropsOrEmits(r??{})):r}function mergeWatchOptions(t,r){if(!t)return r;if(!r)return t;const e=extend$1(Object.create(null),t);for(const n in r)e[n]=mergeAsArray(t[n],r[n]);return e}function createAppContext(){return{app:null,config:{isNativeTag:NO,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let uid$1=0;function createAppAPI(t,r){return function(n,g=null){isFunction$3(n)||(n=extend$1({},n)),g!=null&&!isObject$2(g)&&(g=null);const y=createAppContext(),i=new WeakSet;let k=!1;const $=y.app={_uid:uid$1++,_component:n,_props:g,_container:null,_context:y,_instance:null,version,get config(){return y.config},set config(L){},use(L,...V){return i.has(L)||(L&&isFunction$3(L.install)?(i.add(L),L.install($,...V)):isFunction$3(L)&&(i.add(L),L($,...V))),$},mixin(L){return y.mixins.includes(L)||y.mixins.push(L),$},component(L,V){return V?(y.components[L]=V,$):y.components[L]},directive(L,V){return V?(y.directives[L]=V,$):y.directives[L]},mount(L,V,z){if(!k){const re=createVNode(n,g);return re.appContext=y,z===!0?z="svg":z===!1&&(z=void 0),V&&r?r(re,L):t(re,L,z),k=!0,$._container=L,L.__vue_app__=$,getExposeProxy(re.component)||re.component.proxy}},unmount(){k&&(t(null,$._container),delete $._container.__vue_app__)},provide(L,V){return y.provides[L]=V,$},runWithContext(L){const V=currentApp;currentApp=$;try{return L()}finally{currentApp=V}}};return $}}let currentApp=null;function provide(t,r){if(currentInstance){let e=currentInstance.provides;const n=currentInstance.parent&&currentInstance.parent.provides;n===e&&(e=currentInstance.provides=Object.create(n)),e[t]=r}}function inject(t,r,e=!1){const n=currentInstance||currentRenderingInstance;if(n||currentApp){const g=n?n.parent==null?n.vnode.appContext&&n.vnode.appContext.provides:n.parent.provides:currentApp._context.provides;if(g&&t in g)return g[t];if(arguments.length>1)return e&&isFunction$3(r)?r.call(n&&n.proxy):r}}function initProps(t,r,e,n=!1){const g={},y={};def(y,InternalObjectKey,1),t.propsDefaults=Object.create(null),setFullProps(t,r,g,y);for(const i in t.propsOptions[0])i in g||(g[i]=void 0);e?t.props=n?g:shallowReactive(g):t.type.props?t.props=g:t.props=y,t.attrs=y}function updateProps(t,r,e,n){const{props:g,attrs:y,vnode:{patchFlag:i}}=t,k=toRaw(g),[$]=t.propsOptions;let L=!1;if((n||i>0)&&!(i&16)){if(i&8){const V=t.vnode.dynamicProps;for(let z=0;z<V.length;z++){let re=V[z];if(isEmitListener(t.emitsOptions,re))continue;const ie=r[re];if($)if(hasOwn(y,re))ie!==y[re]&&(y[re]=ie,L=!0);else{const ue=camelize(re);g[ue]=resolvePropValue($,k,ue,ie,t,!1)}else ie!==y[re]&&(y[re]=ie,L=!0)}}}else{setFullProps(t,r,g,y)&&(L=!0);let V;for(const z in k)(!r||!hasOwn(r,z)&&((V=hyphenate(z))===z||!hasOwn(r,V)))&&($?e&&(e[z]!==void 0||e[V]!==void 0)&&(g[z]=resolvePropValue($,k,z,void 0,t,!0)):delete g[z]);if(y!==k)for(const z in y)(!r||!hasOwn(r,z))&&(delete y[z],L=!0)}L&&trigger(t,"set","$attrs")}function setFullProps(t,r,e,n){const[g,y]=t.propsOptions;let i=!1,k;if(r)for(let $ in r){if(isReservedProp($))continue;const L=r[$];let V;g&&hasOwn(g,V=camelize($))?!y||!y.includes(V)?e[V]=L:(k||(k={}))[V]=L:isEmitListener(t.emitsOptions,$)||(!($ in n)||L!==n[$])&&(n[$]=L,i=!0)}if(y){const $=toRaw(e),L=k||EMPTY_OBJ;for(let V=0;V<y.length;V++){const z=y[V];e[z]=resolvePropValue(g,$,z,L[z],t,!hasOwn(L,z))}}return i}function resolvePropValue(t,r,e,n,g,y){const i=t[e];if(i!=null){const k=hasOwn(i,"default");if(k&&n===void 0){const $=i.default;if(i.type!==Function&&!i.skipFactory&&isFunction$3($)){const{propsDefaults:L}=g;if(e in L)n=L[e];else{const V=setCurrentInstance(g);n=L[e]=$.call(null,r),V()}}else n=$}i[0]&&(y&&!k?n=!1:i[1]&&(n===""||n===hyphenate(e))&&(n=!0))}return n}function normalizePropsOptions(t,r,e=!1){const n=r.propsCache,g=n.get(t);if(g)return g;const y=t.props,i={},k=[];let $=!1;if(!isFunction$3(t)){const V=z=>{$=!0;const[re,ie]=normalizePropsOptions(z,r,!0);extend$1(i,re),ie&&k.push(...ie)};!e&&r.mixins.length&&r.mixins.forEach(V),t.extends&&V(t.extends),t.mixins&&t.mixins.forEach(V)}if(!y&&!$)return isObject$2(t)&&n.set(t,EMPTY_ARR),EMPTY_ARR;if(isArray$3(y))for(let V=0;V<y.length;V++){const z=camelize(y[V]);validatePropName(z)&&(i[z]=EMPTY_OBJ)}else if(y)for(const V in y){const z=camelize(V);if(validatePropName(z)){const re=y[V],ie=i[z]=isArray$3(re)||isFunction$3(re)?{type:re}:extend$1({},re);if(ie){const ue=getTypeIndex(Boolean,ie.type),le=getTypeIndex(String,ie.type);ie[0]=ue>-1,ie[1]=le<0||ue<le,(ue>-1||hasOwn(ie,"default"))&&k.push(z)}}}const L=[i,k];return isObject$2(t)&&n.set(t,L),L}function validatePropName(t){return t[0]!=="$"&&!isReservedProp(t)}function getType(t){return t===null?"null":typeof t=="function"?t.name||"":typeof t=="object"&&t.constructor&&t.constructor.name||""}function isSameType(t,r){return getType(t)===getType(r)}function getTypeIndex(t,r){return isArray$3(r)?r.findIndex(e=>isSameType(e,t)):isFunction$3(r)&&isSameType(r,t)?0:-1}const isInternalKey=t=>t[0]==="_"||t==="$stable",normalizeSlotValue=t=>isArray$3(t)?t.map(normalizeVNode):[normalizeVNode(t)],normalizeSlot=(t,r,e)=>{if(r._n)return r;const n=withCtx((...g)=>normalizeSlotValue(r(...g)),e);return n._c=!1,n},normalizeObjectSlots=(t,r,e)=>{const n=t._ctx;for(const g in t){if(isInternalKey(g))continue;const y=t[g];if(isFunction$3(y))r[g]=normalizeSlot(g,y,n);else if(y!=null){const i=normalizeSlotValue(y);r[g]=()=>i}}},normalizeVNodeSlots=(t,r)=>{const e=normalizeSlotValue(r);t.slots.default=()=>e},initSlots=(t,r)=>{if(t.vnode.shapeFlag&32){const e=r._;e?(t.slots=toRaw(r),def(r,"_",e)):normalizeObjectSlots(r,t.slots={})}else t.slots={},r&&normalizeVNodeSlots(t,r);def(t.slots,InternalObjectKey,1)},updateSlots=(t,r,e)=>{const{vnode:n,slots:g}=t;let y=!0,i=EMPTY_OBJ;if(n.shapeFlag&32){const k=r._;k?e&&k===1?y=!1:(extend$1(g,r),!e&&k===1&&delete g._):(y=!r.$stable,normalizeObjectSlots(r,g)),i=r}else r&&(normalizeVNodeSlots(t,r),i={default:1});if(y)for(const k in g)!isInternalKey(k)&&i[k]==null&&delete g[k]};function setRef(t,r,e,n,g=!1){if(isArray$3(t)){t.forEach((re,ie)=>setRef(re,r&&(isArray$3(r)?r[ie]:r),e,n,g));return}if(isAsyncWrapper(n)&&!g)return;const y=n.shapeFlag&4?getExposeProxy(n.component)||n.component.proxy:n.el,i=g?null:y,{i:k,r:$}=t,L=r&&r.r,V=k.refs===EMPTY_OBJ?k.refs={}:k.refs,z=k.setupState;if(L!=null&&L!==$&&(isString$2(L)?(V[L]=null,hasOwn(z,L)&&(z[L]=null)):isRef(L)&&(L.value=null)),isFunction$3($))callWithErrorHandling($,k,12,[i,V]);else{const re=isString$2($),ie=isRef($);if(re||ie){const ue=()=>{if(t.f){const le=re?hasOwn(z,$)?z[$]:V[$]:$.value;g?isArray$3(le)&&remove(le,y):isArray$3(le)?le.includes(y)||le.push(y):re?(V[$]=[y],hasOwn(z,$)&&(z[$]=V[$])):($.value=[y],t.k&&(V[t.k]=$.value))}else re?(V[$]=i,hasOwn(z,$)&&(z[$]=i)):ie&&($.value=i,t.k&&(V[t.k]=i))};i?(ue.id=-1,queuePostRenderEffect(ue,e)):ue()}}}const queuePostRenderEffect=queueEffectWithSuspense;function createRenderer(t){return baseCreateRenderer(t)}function baseCreateRenderer(t,r){const e=getGlobalThis();e.__VUE__=!0;const{insert:n,remove:g,patchProp:y,createElement:i,createText:k,createComment:$,setText:L,setElementText:V,parentNode:z,nextSibling:re,setScopeId:ie=NOOP,insertStaticContent:ue}=t,le=(mr,Tr,Br,$r=null,Lr=null,Gr=null,qr=void 0,Yr=null,bn=!!Tr.dynamicChildren)=>{if(mr===Tr)return;mr&&!isSameVNodeType(mr,Tr)&&($r=xr(mr),Pr(mr,Lr,Gr,!0),mr=null),Tr.patchFlag===-2&&(bn=!1,Tr.dynamicChildren=null);const{type:wn,ref:Xr,shapeFlag:Vn}=Tr;switch(wn){case Text:oe(mr,Tr,Br,$r);break;case Comment:ae(mr,Tr,Br,$r);break;case Static:mr==null&&qe(Tr,Br,$r,qr);break;case Fragment:Dt(mr,Tr,Br,$r,Lr,Gr,qr,Yr,bn);break;default:Vn&1?ze(mr,Tr,Br,$r,Lr,Gr,qr,Yr,bn):Vn&6?lr(mr,Tr,Br,$r,Lr,Gr,qr,Yr,bn):(Vn&64||Vn&128)&&wn.process(mr,Tr,Br,$r,Lr,Gr,qr,Yr,bn,Or)}Xr!=null&&Lr&&setRef(Xr,mr&&mr.ref,Gr,Tr||mr,!Tr)},oe=(mr,Tr,Br,$r)=>{if(mr==null)n(Tr.el=k(Tr.children),Br,$r);else{const Lr=Tr.el=mr.el;Tr.children!==mr.children&&L(Lr,Tr.children)}},ae=(mr,Tr,Br,$r)=>{mr==null?n(Tr.el=$(Tr.children||""),Br,$r):Tr.el=mr.el},qe=(mr,Tr,Br,$r)=>{[mr.el,mr.anchor]=ue(mr.children,Tr,Br,$r,mr.el,mr.anchor)},de=({el:mr,anchor:Tr},Br,$r)=>{let Lr;for(;mr&&mr!==Tr;)Lr=re(mr),n(mr,Br,$r),mr=Lr;n(Tr,Br,$r)},Ne=({el:mr,anchor:Tr})=>{let Br;for(;mr&&mr!==Tr;)Br=re(mr),g(mr),mr=Br;g(Tr)},ze=(mr,Tr,Br,$r,Lr,Gr,qr,Yr,bn)=>{Tr.type==="svg"?qr="svg":Tr.type==="math"&&(qr="mathml"),mr==null?$e(Tr,Br,$r,Lr,Gr,qr,Yr,bn):Et(mr,Tr,Lr,Gr,qr,Yr,bn)},$e=(mr,Tr,Br,$r,Lr,Gr,qr,Yr)=>{let bn,wn;const{props:Xr,shapeFlag:Vn,transition:Zr,dirs:Nn}=mr;if(bn=mr.el=i(mr.type,Gr,Xr&&Xr.is,Xr),Vn&8?V(bn,mr.children):Vn&16&&jt(mr.children,bn,null,$r,Lr,resolveChildrenNamespace(mr,Gr),qr,Yr),Nn&&invokeDirectiveHook(mr,null,$r,"created"),Lt(bn,mr,mr.scopeId,qr,$r),Xr){for(const kn in Xr)kn!=="value"&&!isReservedProp(kn)&&y(bn,kn,null,Xr[kn],Gr,mr.children,$r,Lr,Ir);"value"in Xr&&y(bn,"value",null,Xr.value,Gr),(wn=Xr.onVnodeBeforeMount)&&invokeVNodeHook(wn,$r,mr)}Nn&&invokeDirectiveHook(mr,null,$r,"beforeMount");const Qr=needTransition(Lr,Zr);Qr&&Zr.beforeEnter(bn),n(bn,Tr,Br),((wn=Xr&&Xr.onVnodeMounted)||Qr||Nn)&&queuePostRenderEffect(()=>{wn&&invokeVNodeHook(wn,$r,mr),Qr&&Zr.enter(bn),Nn&&invokeDirectiveHook(mr,null,$r,"mounted")},Lr)},Lt=(mr,Tr,Br,$r,Lr)=>{if(Br&&ie(mr,Br),$r)for(let Gr=0;Gr<$r.length;Gr++)ie(mr,$r[Gr]);if(Lr){let Gr=Lr.subTree;if(Tr===Gr){const qr=Lr.vnode;Lt(mr,qr,qr.scopeId,qr.slotScopeIds,Lr.parent)}}},jt=(mr,Tr,Br,$r,Lr,Gr,qr,Yr,bn=0)=>{for(let wn=bn;wn<mr.length;wn++){const Xr=mr[wn]=Yr?cloneIfMounted(mr[wn]):normalizeVNode(mr[wn]);le(null,Xr,Tr,Br,$r,Lr,Gr,qr,Yr)}},Et=(mr,Tr,Br,$r,Lr,Gr,qr)=>{const Yr=Tr.el=mr.el;let{patchFlag:bn,dynamicChildren:wn,dirs:Xr}=Tr;bn|=mr.patchFlag&16;const Vn=mr.props||EMPTY_OBJ,Zr=Tr.props||EMPTY_OBJ;let Nn;if(Br&&toggleRecurse(Br,!1),(Nn=Zr.onVnodeBeforeUpdate)&&invokeVNodeHook(Nn,Br,Tr,mr),Xr&&invokeDirectiveHook(Tr,mr,Br,"beforeUpdate"),Br&&toggleRecurse(Br,!0),wn?ir(mr.dynamicChildren,wn,Yr,Br,$r,resolveChildrenNamespace(Tr,Lr),Gr):qr||hr(mr,Tr,Yr,null,Br,$r,resolveChildrenNamespace(Tr,Lr),Gr,!1),bn>0){if(bn&16)dr(Yr,Tr,Vn,Zr,Br,$r,Lr);else if(bn&2&&Vn.class!==Zr.class&&y(Yr,"class",null,Zr.class,Lr),bn&4&&y(Yr,"style",Vn.style,Zr.style,Lr),bn&8){const Qr=Tr.dynamicProps;for(let kn=0;kn<Qr.length;kn++){const Dn=Qr[kn],xn=Vn[Dn],An=Zr[Dn];(An!==xn||Dn==="value")&&y(Yr,Dn,xn,An,Lr,mr.children,Br,$r,Ir)}}bn&1&&mr.children!==Tr.children&&V(Yr,Tr.children)}else!qr&&wn==null&&dr(Yr,Tr,Vn,Zr,Br,$r,Lr);((Nn=Zr.onVnodeUpdated)||Xr)&&queuePostRenderEffect(()=>{Nn&&invokeVNodeHook(Nn,Br,Tr,mr),Xr&&invokeDirectiveHook(Tr,mr,Br,"updated")},$r)},ir=(mr,Tr,Br,$r,Lr,Gr,qr)=>{for(let Yr=0;Yr<Tr.length;Yr++){const bn=mr[Yr],wn=Tr[Yr],Xr=bn.el&&(bn.type===Fragment||!isSameVNodeType(bn,wn)||bn.shapeFlag&70)?z(bn.el):Br;le(bn,wn,Xr,null,$r,Lr,Gr,qr,!0)}},dr=(mr,Tr,Br,$r,Lr,Gr,qr)=>{if(Br!==$r){if(Br!==EMPTY_OBJ)for(const Yr in Br)!isReservedProp(Yr)&&!(Yr in $r)&&y(mr,Yr,Br[Yr],null,qr,Tr.children,Lr,Gr,Ir);for(const Yr in $r){if(isReservedProp(Yr))continue;const bn=$r[Yr],wn=Br[Yr];bn!==wn&&Yr!=="value"&&y(mr,Yr,wn,bn,qr,Tr.children,Lr,Gr,Ir)}"value"in $r&&y(mr,"value",Br.value,$r.value,qr)}},Dt=(mr,Tr,Br,$r,Lr,Gr,qr,Yr,bn)=>{const wn=Tr.el=mr?mr.el:k(""),Xr=Tr.anchor=mr?mr.anchor:k("");let{patchFlag:Vn,dynamicChildren:Zr,slotScopeIds:Nn}=Tr;Nn&&(Yr=Yr?Yr.concat(Nn):Nn),mr==null?(n(wn,Br,$r),n(Xr,Br,$r),jt(Tr.children||[],Br,Xr,Lr,Gr,qr,Yr,bn)):Vn>0&&Vn&64&&Zr&&mr.dynamicChildren?(ir(mr.dynamicChildren,Zr,Br,Lr,Gr,qr,Yr),(Tr.key!=null||Lr&&Tr===Lr.subTree)&&traverseStaticChildren(mr,Tr,!0)):hr(mr,Tr,Br,Xr,Lr,Gr,qr,Yr,bn)},lr=(mr,Tr,Br,$r,Lr,Gr,qr,Yr,bn)=>{Tr.slotScopeIds=Yr,mr==null?Tr.shapeFlag&512?Lr.ctx.activate(Tr,Br,$r,qr,bn):sr(Tr,Br,$r,Lr,Gr,qr,bn):er(mr,Tr,bn)},sr=(mr,Tr,Br,$r,Lr,Gr,qr)=>{const Yr=mr.component=createComponentInstance(mr,$r,Lr);if(isKeepAlive(mr)&&(Yr.ctx.renderer=Or),setupComponent(Yr),Yr.asyncDep){if(Lr&&Lr.registerDep(Yr,cr),!mr.el){const bn=Yr.subTree=createVNode(Comment);ae(null,bn,Tr,Br)}}else cr(Yr,mr,Tr,Br,Lr,Gr,qr)},er=(mr,Tr,Br)=>{const $r=Tr.component=mr.component;if(shouldUpdateComponent(mr,Tr,Br))if($r.asyncDep&&!$r.asyncResolved){or($r,Tr,Br);return}else $r.next=Tr,invalidateJob($r.update),$r.effect.dirty=!0,$r.update();else Tr.el=mr.el,$r.vnode=Tr},cr=(mr,Tr,Br,$r,Lr,Gr,qr)=>{const Yr=()=>{if(mr.isMounted){let{next:Xr,bu:Vn,u:Zr,parent:Nn,vnode:Qr}=mr;{const vn=locateNonHydratedAsyncRoot(mr);if(vn){Xr&&(Xr.el=Qr.el,or(mr,Xr,qr)),vn.asyncDep.then(()=>{mr.isUnmounted||Yr()});return}}let kn=Xr,Dn;toggleRecurse(mr,!1),Xr?(Xr.el=Qr.el,or(mr,Xr,qr)):Xr=Qr,Vn&&invokeArrayFns(Vn),(Dn=Xr.props&&Xr.props.onVnodeBeforeUpdate)&&invokeVNodeHook(Dn,Nn,Xr,Qr),toggleRecurse(mr,!0);const xn=renderComponentRoot(mr),An=mr.subTree;mr.subTree=xn,le(An,xn,z(An.el),xr(An),mr,Lr,Gr),Xr.el=xn.el,kn===null&&updateHOCHostEl(mr,xn.el),Zr&&queuePostRenderEffect(Zr,Lr),(Dn=Xr.props&&Xr.props.onVnodeUpdated)&&queuePostRenderEffect(()=>invokeVNodeHook(Dn,Nn,Xr,Qr),Lr)}else{let Xr;const{el:Vn,props:Zr}=Tr,{bm:Nn,m:Qr,parent:kn}=mr,Dn=isAsyncWrapper(Tr);if(toggleRecurse(mr,!1),Nn&&invokeArrayFns(Nn),!Dn&&(Xr=Zr&&Zr.onVnodeBeforeMount)&&invokeVNodeHook(Xr,kn,Tr),toggleRecurse(mr,!0),Vn&&yr){const xn=()=>{mr.subTree=renderComponentRoot(mr),yr(Vn,mr.subTree,mr,Lr,null)};Dn?Tr.type.__asyncLoader().then(()=>!mr.isUnmounted&&xn()):xn()}else{const xn=mr.subTree=renderComponentRoot(mr);le(null,xn,Br,$r,mr,Lr,Gr),Tr.el=xn.el}if(Qr&&queuePostRenderEffect(Qr,Lr),!Dn&&(Xr=Zr&&Zr.onVnodeMounted)){const xn=Tr;queuePostRenderEffect(()=>invokeVNodeHook(Xr,kn,xn),Lr)}(Tr.shapeFlag&256||kn&&isAsyncWrapper(kn.vnode)&&kn.vnode.shapeFlag&256)&&mr.a&&queuePostRenderEffect(mr.a,Lr),mr.isMounted=!0,Tr=Br=$r=null}},bn=mr.effect=new ReactiveEffect(Yr,NOOP,()=>queueJob(wn),mr.scope),wn=mr.update=()=>{bn.dirty&&bn.run()};wn.id=mr.uid,toggleRecurse(mr,!0),wn()},or=(mr,Tr,Br)=>{Tr.component=mr;const $r=mr.vnode.props;mr.vnode=Tr,mr.next=null,updateProps(mr,Tr.props,$r,Br),updateSlots(mr,Tr.children,Br),pauseTracking(),flushPreFlushCbs(mr),resetTracking()},hr=(mr,Tr,Br,$r,Lr,Gr,qr,Yr,bn=!1)=>{const wn=mr&&mr.children,Xr=mr?mr.shapeFlag:0,Vn=Tr.children,{patchFlag:Zr,shapeFlag:Nn}=Tr;if(Zr>0){if(Zr&128){Sr(wn,Vn,Br,$r,Lr,Gr,qr,Yr,bn);return}else if(Zr&256){pr(wn,Vn,Br,$r,Lr,Gr,qr,Yr,bn);return}}Nn&8?(Xr&16&&Ir(wn,Lr,Gr),Vn!==wn&&V(Br,Vn)):Xr&16?Nn&16?Sr(wn,Vn,Br,$r,Lr,Gr,qr,Yr,bn):Ir(wn,Lr,Gr,!0):(Xr&8&&V(Br,""),Nn&16&&jt(Vn,Br,$r,Lr,Gr,qr,Yr,bn))},pr=(mr,Tr,Br,$r,Lr,Gr,qr,Yr,bn)=>{mr=mr||EMPTY_ARR,Tr=Tr||EMPTY_ARR;const wn=mr.length,Xr=Tr.length,Vn=Math.min(wn,Xr);let Zr;for(Zr=0;Zr<Vn;Zr++){const Nn=Tr[Zr]=bn?cloneIfMounted(Tr[Zr]):normalizeVNode(Tr[Zr]);le(mr[Zr],Nn,Br,null,Lr,Gr,qr,Yr,bn)}wn>Xr?Ir(mr,Lr,Gr,!0,!1,Vn):jt(Tr,Br,$r,Lr,Gr,qr,Yr,bn,Vn)},Sr=(mr,Tr,Br,$r,Lr,Gr,qr,Yr,bn)=>{let wn=0;const Xr=Tr.length;let Vn=mr.length-1,Zr=Xr-1;for(;wn<=Vn&&wn<=Zr;){const Nn=mr[wn],Qr=Tr[wn]=bn?cloneIfMounted(Tr[wn]):normalizeVNode(Tr[wn]);if(isSameVNodeType(Nn,Qr))le(Nn,Qr,Br,null,Lr,Gr,qr,Yr,bn);else break;wn++}for(;wn<=Vn&&wn<=Zr;){const Nn=mr[Vn],Qr=Tr[Zr]=bn?cloneIfMounted(Tr[Zr]):normalizeVNode(Tr[Zr]);if(isSameVNodeType(Nn,Qr))le(Nn,Qr,Br,null,Lr,Gr,qr,Yr,bn);else break;Vn--,Zr--}if(wn>Vn){if(wn<=Zr){const Nn=Zr+1,Qr=Nn<Xr?Tr[Nn].el:$r;for(;wn<=Zr;)le(null,Tr[wn]=bn?cloneIfMounted(Tr[wn]):normalizeVNode(Tr[wn]),Br,Qr,Lr,Gr,qr,Yr,bn),wn++}}else if(wn>Zr)for(;wn<=Vn;)Pr(mr[wn],Lr,Gr,!0),wn++;else{const Nn=wn,Qr=wn,kn=new Map;for(wn=Qr;wn<=Zr;wn++){const Vo=Tr[wn]=bn?cloneIfMounted(Tr[wn]):normalizeVNode(Tr[wn]);Vo.key!=null&&kn.set(Vo.key,wn)}let Dn,xn=0;const An=Zr-Qr+1;let vn=!1,hn=0;const Yn=new Array(An);for(wn=0;wn<An;wn++)Yn[wn]=0;for(wn=Nn;wn<=Vn;wn++){const Vo=mr[wn];if(xn>=An){Pr(Vo,Lr,Gr,!0);continue}let Uo;if(Vo.key!=null)Uo=kn.get(Vo.key);else for(Dn=Qr;Dn<=Zr;Dn++)if(Yn[Dn-Qr]===0&&isSameVNodeType(Vo,Tr[Dn])){Uo=Dn;break}Uo===void 0?Pr(Vo,Lr,Gr,!0):(Yn[Uo-Qr]=wn+1,Uo>=hn?hn=Uo:vn=!0,le(Vo,Tr[Uo],Br,null,Lr,Gr,qr,Yr,bn),xn++)}const Oo=vn?getSequence(Yn):EMPTY_ARR;for(Dn=Oo.length-1,wn=An-1;wn>=0;wn--){const Vo=Qr+wn,Uo=Tr[Vo],Io=Vo+1<Xr?Tr[Vo+1].el:$r;Yn[wn]===0?le(null,Uo,Br,Io,Lr,Gr,qr,Yr,bn):vn&&(Dn<0||wn!==Oo[Dn]?Er(Uo,Br,Io,2):Dn--)}}},Er=(mr,Tr,Br,$r,Lr=null)=>{const{el:Gr,type:qr,transition:Yr,children:bn,shapeFlag:wn}=mr;if(wn&6){Er(mr.component.subTree,Tr,Br,$r);return}if(wn&128){mr.suspense.move(Tr,Br,$r);return}if(wn&64){qr.move(mr,Tr,Br,Or);return}if(qr===Fragment){n(Gr,Tr,Br);for(let Vn=0;Vn<bn.length;Vn++)Er(bn[Vn],Tr,Br,$r);n(mr.anchor,Tr,Br);return}if(qr===Static){de(mr,Tr,Br);return}if($r!==2&&wn&1&&Yr)if($r===0)Yr.beforeEnter(Gr),n(Gr,Tr,Br),queuePostRenderEffect(()=>Yr.enter(Gr),Lr);else{const{leave:Vn,delayLeave:Zr,afterLeave:Nn}=Yr,Qr=()=>n(Gr,Tr,Br),kn=()=>{Vn(Gr,()=>{Qr(),Nn&&Nn()})};Zr?Zr(Gr,Qr,kn):kn()}else n(Gr,Tr,Br)},Pr=(mr,Tr,Br,$r=!1,Lr=!1)=>{const{type:Gr,props:qr,ref:Yr,children:bn,dynamicChildren:wn,shapeFlag:Xr,patchFlag:Vn,dirs:Zr}=mr;if(Yr!=null&&setRef(Yr,null,Br,mr,!0),Xr&256){Tr.ctx.deactivate(mr);return}const Nn=Xr&1&&Zr,Qr=!isAsyncWrapper(mr);let kn;if(Qr&&(kn=qr&&qr.onVnodeBeforeUnmount)&&invokeVNodeHook(kn,Tr,mr),Xr&6)kr(mr.component,Br,$r);else{if(Xr&128){mr.suspense.unmount(Br,$r);return}Nn&&invokeDirectiveHook(mr,null,Tr,"beforeUnmount"),Xr&64?mr.type.remove(mr,Tr,Br,Lr,Or,$r):wn&&(Gr!==Fragment||Vn>0&&Vn&64)?Ir(wn,Tr,Br,!1,!0):(Gr===Fragment&&Vn&384||!Lr&&Xr&16)&&Ir(bn,Tr,Br),$r&&Cr(mr)}(Qr&&(kn=qr&&qr.onVnodeUnmounted)||Nn)&&queuePostRenderEffect(()=>{kn&&invokeVNodeHook(kn,Tr,mr),Nn&&invokeDirectiveHook(mr,null,Tr,"unmounted")},Br)},Cr=mr=>{const{type:Tr,el:Br,anchor:$r,transition:Lr}=mr;if(Tr===Fragment){rr(Br,$r);return}if(Tr===Static){Ne(mr);return}const Gr=()=>{g(Br),Lr&&!Lr.persisted&&Lr.afterLeave&&Lr.afterLeave()};if(mr.shapeFlag&1&&Lr&&!Lr.persisted){const{leave:qr,delayLeave:Yr}=Lr,bn=()=>qr(Br,Gr);Yr?Yr(mr.el,Gr,bn):bn()}else Gr()},rr=(mr,Tr)=>{let Br;for(;mr!==Tr;)Br=re(mr),g(mr),mr=Br;g(Tr)},kr=(mr,Tr,Br)=>{const{bum:$r,scope:Lr,update:Gr,subTree:qr,um:Yr}=mr;$r&&invokeArrayFns($r),Lr.stop(),Gr&&(Gr.active=!1,Pr(qr,mr,Tr,Br)),Yr&&queuePostRenderEffect(Yr,Tr),queuePostRenderEffect(()=>{mr.isUnmounted=!0},Tr),Tr&&Tr.pendingBranch&&!Tr.isUnmounted&&mr.asyncDep&&!mr.asyncResolved&&mr.suspenseId===Tr.pendingId&&(Tr.deps--,Tr.deps===0&&Tr.resolve())},Ir=(mr,Tr,Br,$r=!1,Lr=!1,Gr=0)=>{for(let qr=Gr;qr<mr.length;qr++)Pr(mr[qr],Tr,Br,$r,Lr)},xr=mr=>mr.shapeFlag&6?xr(mr.component.subTree):mr.shapeFlag&128?mr.suspense.next():re(mr.anchor||mr.el);let vr=!1;const _r=(mr,Tr,Br)=>{mr==null?Tr._vnode&&Pr(Tr._vnode,null,null,!0):le(Tr._vnode||null,mr,Tr,null,null,null,Br),vr||(vr=!0,flushPreFlushCbs(),flushPostFlushCbs(),vr=!1),Tr._vnode=mr},Or={p:le,um:Pr,m:Er,r:Cr,mt:sr,mc:jt,pc:hr,pbc:ir,n:xr,o:t};let Mr,yr;return r&&([Mr,yr]=r(Or)),{render:_r,hydrate:Mr,createApp:createAppAPI(_r,Mr)}}function resolveChildrenNamespace({type:t,props:r},e){return e==="svg"&&t==="foreignObject"||e==="mathml"&&t==="annotation-xml"&&r&&r.encoding&&r.encoding.includes("html")?void 0:e}function toggleRecurse({effect:t,update:r},e){t.allowRecurse=r.allowRecurse=e}function needTransition(t,r){return(!t||t&&!t.pendingBranch)&&r&&!r.persisted}function traverseStaticChildren(t,r,e=!1){const n=t.children,g=r.children;if(isArray$3(n)&&isArray$3(g))for(let y=0;y<n.length;y++){const i=n[y];let k=g[y];k.shapeFlag&1&&!k.dynamicChildren&&((k.patchFlag<=0||k.patchFlag===32)&&(k=g[y]=cloneIfMounted(g[y]),k.el=i.el),e||traverseStaticChildren(i,k)),k.type===Text&&(k.el=i.el)}}function getSequence(t){const r=t.slice(),e=[0];let n,g,y,i,k;const $=t.length;for(n=0;n<$;n++){const L=t[n];if(L!==0){if(g=e[e.length-1],t[g]<L){r[n]=g,e.push(n);continue}for(y=0,i=e.length-1;y<i;)k=y+i>>1,t[e[k]]<L?y=k+1:i=k;L<t[e[y]]&&(y>0&&(r[n]=e[y-1]),e[y]=n)}}for(y=e.length,i=e[y-1];y-- >0;)e[y]=i,i=r[i];return e}function locateNonHydratedAsyncRoot(t){const r=t.subTree.component;if(r)return r.asyncDep&&!r.asyncResolved?r:locateNonHydratedAsyncRoot(r)}const isTeleport=t=>t.__isTeleport,isTeleportDisabled=t=>t&&(t.disabled||t.disabled===""),isTargetSVG=t=>typeof SVGElement<"u"&&t instanceof SVGElement,isTargetMathML=t=>typeof MathMLElement=="function"&&t instanceof MathMLElement,resolveTarget=(t,r)=>{const e=t&&t.to;return isString$2(e)?r?r(e):null:e},TeleportImpl={name:"Teleport",__isTeleport:!0,process(t,r,e,n,g,y,i,k,$,L){const{mc:V,pc:z,pbc:re,o:{insert:ie,querySelector:ue,createText:le,createComment:oe}}=L,ae=isTeleportDisabled(r.props);let{shapeFlag:qe,children:de,dynamicChildren:Ne}=r;if(t==null){const ze=r.el=le(""),$e=r.anchor=le("");ie(ze,e,n),ie($e,e,n);const Lt=r.target=resolveTarget(r.props,ue),jt=r.targetAnchor=le("");Lt&&(ie(jt,Lt),i==="svg"||isTargetSVG(Lt)?i="svg":(i==="mathml"||isTargetMathML(Lt))&&(i="mathml"));const Et=(ir,dr)=>{qe&16&&V(de,ir,dr,g,y,i,k,$)};ae?Et(e,$e):Lt&&Et(Lt,jt)}else{r.el=t.el;const ze=r.anchor=t.anchor,$e=r.target=t.target,Lt=r.targetAnchor=t.targetAnchor,jt=isTeleportDisabled(t.props),Et=jt?e:$e,ir=jt?ze:Lt;if(i==="svg"||isTargetSVG($e)?i="svg":(i==="mathml"||isTargetMathML($e))&&(i="mathml"),Ne?(re(t.dynamicChildren,Ne,Et,g,y,i,k),traverseStaticChildren(t,r,!0)):$||z(t,r,Et,ir,g,y,i,k,!1),ae)jt?r.props&&t.props&&r.props.to!==t.props.to&&(r.props.to=t.props.to):moveTeleport(r,e,ze,L,1);else if((r.props&&r.props.to)!==(t.props&&t.props.to)){const dr=r.target=resolveTarget(r.props,ue);dr&&moveTeleport(r,dr,null,L,0)}else jt&&moveTeleport(r,$e,Lt,L,1)}updateCssVars(r)},remove(t,r,e,n,{um:g,o:{remove:y}},i){const{shapeFlag:k,children:$,anchor:L,targetAnchor:V,target:z,props:re}=t;if(z&&y(V),i&&y(L),k&16){const ie=i||!isTeleportDisabled(re);for(let ue=0;ue<$.length;ue++){const le=$[ue];g(le,r,e,ie,!!le.dynamicChildren)}}},move:moveTeleport,hydrate:hydrateTeleport};function moveTeleport(t,r,e,{o:{insert:n},m:g},y=2){y===0&&n(t.targetAnchor,r,e);const{el:i,anchor:k,shapeFlag:$,children:L,props:V}=t,z=y===2;if(z&&n(i,r,e),(!z||isTeleportDisabled(V))&&$&16)for(let re=0;re<L.length;re++)g(L[re],r,e,2);z&&n(k,r,e)}function hydrateTeleport(t,r,e,n,g,y,{o:{nextSibling:i,parentNode:k,querySelector:$}},L){const V=r.target=resolveTarget(r.props,$);if(V){const z=V._lpa||V.firstChild;if(r.shapeFlag&16)if(isTeleportDisabled(r.props))r.anchor=L(i(t),r,k(t),e,n,g,y),r.targetAnchor=z;else{r.anchor=i(t);let re=z;for(;re;)if(re=i(re),re&&re.nodeType===8&&re.data==="teleport anchor"){r.targetAnchor=re,V._lpa=r.targetAnchor&&i(r.targetAnchor);break}L(z,r,V,e,n,g,y)}updateCssVars(r)}return r.anchor&&i(r.anchor)}const Teleport=TeleportImpl;function updateCssVars(t){const r=t.ctx;if(r&&r.ut){let e=t.children[0].el;for(;e&&e!==t.targetAnchor;)e.nodeType===1&&e.setAttribute("data-v-owner",r.uid),e=e.nextSibling;r.ut()}}const Fragment=Symbol.for("v-fgt"),Text=Symbol.for("v-txt"),Comment=Symbol.for("v-cmt"),Static=Symbol.for("v-stc"),blockStack=[];let currentBlock=null;function openBlock(t=!1){blockStack.push(currentBlock=t?null:[])}function closeBlock(){blockStack.pop(),currentBlock=blockStack[blockStack.length-1]||null}let isBlockTreeEnabled=1;function setBlockTracking(t){isBlockTreeEnabled+=t}function setupBlock(t){return t.dynamicChildren=isBlockTreeEnabled>0?currentBlock||EMPTY_ARR:null,closeBlock(),isBlockTreeEnabled>0&&currentBlock&&currentBlock.push(t),t}function createElementBlock(t,r,e,n,g,y){return setupBlock(createBaseVNode(t,r,e,n,g,y,!0))}function createBlock(t,r,e,n,g){return setupBlock(createVNode(t,r,e,n,g,!0))}function isVNode(t){return t?t.__v_isVNode===!0:!1}function isSameVNodeType(t,r){return t.type===r.type&&t.key===r.key}const InternalObjectKey="__vInternal",normalizeKey=({key:t})=>t??null,normalizeRef=({ref:t,ref_key:r,ref_for:e})=>(typeof t=="number"&&(t=""+t),t!=null?isString$2(t)||isRef(t)||isFunction$3(t)?{i:currentRenderingInstance,r:t,k:r,f:!!e}:t:null);function createBaseVNode(t,r=null,e=null,n=0,g=null,y=t===Fragment?0:1,i=!1,k=!1){const $={__v_isVNode:!0,__v_skip:!0,type:t,props:r,key:r&&normalizeKey(r),ref:r&&normalizeRef(r),scopeId:currentScopeId,slotScopeIds:null,children:e,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetAnchor:null,staticCount:0,shapeFlag:y,patchFlag:n,dynamicProps:g,dynamicChildren:null,appContext:null,ctx:currentRenderingInstance};return k?(normalizeChildren($,e),y&128&&t.normalize($)):e&&($.shapeFlag|=isString$2(e)?8:16),isBlockTreeEnabled>0&&!i&&currentBlock&&($.patchFlag>0||y&6)&&$.patchFlag!==32&&currentBlock.push($),$}const createVNode=_createVNode;function _createVNode(t,r=null,e=null,n=0,g=null,y=!1){if((!t||t===NULL_DYNAMIC_COMPONENT)&&(t=Comment),isVNode(t)){const k=cloneVNode(t,r,!0);return e&&normalizeChildren(k,e),isBlockTreeEnabled>0&&!y&&currentBlock&&(k.shapeFlag&6?currentBlock[currentBlock.indexOf(t)]=k:currentBlock.push(k)),k.patchFlag|=-2,k}if(isClassComponent(t)&&(t=t.__vccOpts),r){r=guardReactiveProps(r);let{class:k,style:$}=r;k&&!isString$2(k)&&(r.class=normalizeClass(k)),isObject$2($)&&(isProxy($)&&!isArray$3($)&&($=extend$1({},$)),r.style=normalizeStyle($))}const i=isString$2(t)?1:isSuspense(t)?128:isTeleport(t)?64:isObject$2(t)?4:isFunction$3(t)?2:0;return createBaseVNode(t,r,e,n,g,i,y,!0)}function guardReactiveProps(t){return t?isProxy(t)||InternalObjectKey in t?extend$1({},t):t:null}function cloneVNode(t,r,e=!1){const{props:n,ref:g,patchFlag:y,children:i}=t,k=r?mergeProps(n||{},r):n;return{__v_isVNode:!0,__v_skip:!0,type:t.type,props:k,key:k&&normalizeKey(k),ref:r&&r.ref?e&&g?isArray$3(g)?g.concat(normalizeRef(r)):[g,normalizeRef(r)]:normalizeRef(r):g,scopeId:t.scopeId,slotScopeIds:t.slotScopeIds,children:i,target:t.target,targetAnchor:t.targetAnchor,staticCount:t.staticCount,shapeFlag:t.shapeFlag,patchFlag:r&&t.type!==Fragment?y===-1?16:y|16:y,dynamicProps:t.dynamicProps,dynamicChildren:t.dynamicChildren,appContext:t.appContext,dirs:t.dirs,transition:t.transition,component:t.component,suspense:t.suspense,ssContent:t.ssContent&&cloneVNode(t.ssContent),ssFallback:t.ssFallback&&cloneVNode(t.ssFallback),el:t.el,anchor:t.anchor,ctx:t.ctx,ce:t.ce}}function createTextVNode(t=" ",r=0){return createVNode(Text,null,t,r)}function createCommentVNode(t="",r=!1){return r?(openBlock(),createBlock(Comment,null,t)):createVNode(Comment,null,t)}function normalizeVNode(t){return t==null||typeof t=="boolean"?createVNode(Comment):isArray$3(t)?createVNode(Fragment,null,t.slice()):typeof t=="object"?cloneIfMounted(t):createVNode(Text,null,String(t))}function cloneIfMounted(t){return t.el===null&&t.patchFlag!==-1||t.memo?t:cloneVNode(t)}function normalizeChildren(t,r){let e=0;const{shapeFlag:n}=t;if(r==null)r=null;else if(isArray$3(r))e=16;else if(typeof r=="object")if(n&65){const g=r.default;g&&(g._c&&(g._d=!1),normalizeChildren(t,g()),g._c&&(g._d=!0));return}else{e=32;const g=r._;!g&&!(InternalObjectKey in r)?r._ctx=currentRenderingInstance:g===3&&currentRenderingInstance&&(currentRenderingInstance.slots._===1?r._=1:(r._=2,t.patchFlag|=1024))}else isFunction$3(r)?(r={default:r,_ctx:currentRenderingInstance},e=32):(r=String(r),n&64?(e=16,r=[createTextVNode(r)]):e=8);t.children=r,t.shapeFlag|=e}function mergeProps(...t){const r={};for(let e=0;e<t.length;e++){const n=t[e];for(const g in n)if(g==="class")r.class!==n.class&&(r.class=normalizeClass([r.class,n.class]));else if(g==="style")r.style=normalizeStyle([r.style,n.style]);else if(isOn(g)){const y=r[g],i=n[g];i&&y!==i&&!(isArray$3(y)&&y.includes(i))&&(r[g]=y?[].concat(y,i):i)}else g!==""&&(r[g]=n[g])}return r}function invokeVNodeHook(t,r,e,n=null){callWithAsyncErrorHandling(t,r,7,[e,n])}const emptyAppContext=createAppContext();let uid$2=0;function createComponentInstance(t,r,e){const n=t.type,g=(r?r.appContext:t.appContext)||emptyAppContext,y={uid:uid$2++,vnode:t,type:n,parent:r,appContext:g,root:null,next:null,subTree:null,effect:null,update:null,scope:new EffectScope(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:r?r.provides:Object.create(g.provides),accessCache:null,renderCache:[],components:null,directives:null,propsOptions:normalizePropsOptions(n,g),emitsOptions:normalizeEmitsOptions(n,g),emit:null,emitted:null,propsDefaults:EMPTY_OBJ,inheritAttrs:n.inheritAttrs,ctx:EMPTY_OBJ,data:EMPTY_OBJ,props:EMPTY_OBJ,attrs:EMPTY_OBJ,slots:EMPTY_OBJ,refs:EMPTY_OBJ,setupState:EMPTY_OBJ,setupContext:null,attrsProxy:null,slotsProxy:null,suspense:e,suspenseId:e?e.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return y.ctx={_:y},y.root=r?r.root:y,y.emit=emit.bind(null,y),t.ce&&t.ce(y),y}let currentInstance=null;const getCurrentInstance=()=>currentInstance||currentRenderingInstance;let internalSetCurrentInstance,setInSSRSetupState;{const t=getGlobalThis(),r=(e,n)=>{let g;return(g=t[e])||(g=t[e]=[]),g.push(n),y=>{g.length>1?g.forEach(i=>i(y)):g[0](y)}};internalSetCurrentInstance=r("__VUE_INSTANCE_SETTERS__",e=>currentInstance=e),setInSSRSetupState=r("__VUE_SSR_SETTERS__",e=>isInSSRComponentSetup=e)}const setCurrentInstance=t=>{const r=currentInstance;return internalSetCurrentInstance(t),t.scope.on(),()=>{t.scope.off(),internalSetCurrentInstance(r)}},unsetCurrentInstance=()=>{currentInstance&&currentInstance.scope.off(),internalSetCurrentInstance(null)};function isStatefulComponent(t){return t.vnode.shapeFlag&4}let isInSSRComponentSetup=!1;function setupComponent(t,r=!1){r&&setInSSRSetupState(r);const{props:e,children:n}=t.vnode,g=isStatefulComponent(t);initProps(t,e,g,r),initSlots(t,n);const y=g?setupStatefulComponent(t,r):void 0;return r&&setInSSRSetupState(!1),y}function setupStatefulComponent(t,r){const e=t.type;t.accessCache=Object.create(null),t.proxy=markRaw(new Proxy(t.ctx,PublicInstanceProxyHandlers));const{setup:n}=e;if(n){const g=t.setupContext=n.length>1?createSetupContext(t):null,y=setCurrentInstance(t);pauseTracking();const i=callWithErrorHandling(n,t,0,[t.props,g]);if(resetTracking(),y(),isPromise(i)){if(i.then(unsetCurrentInstance,unsetCurrentInstance),r)return i.then(k=>{handleSetupResult(t,k,r)}).catch(k=>{handleError(k,t,0)});t.asyncDep=i}else handleSetupResult(t,i,r)}else finishComponentSetup(t,r)}function handleSetupResult(t,r,e){isFunction$3(r)?t.type.__ssrInlineRender?t.ssrRender=r:t.render=r:isObject$2(r)&&(t.setupState=proxyRefs(r)),finishComponentSetup(t,e)}let compile;function finishComponentSetup(t,r,e){const n=t.type;if(!t.render){if(!r&&compile&&!n.render){const g=n.template||resolveMergedOptions(t).template;if(g){const{isCustomElement:y,compilerOptions:i}=t.appContext.config,{delimiters:k,compilerOptions:$}=n,L=extend$1(extend$1({isCustomElement:y,delimiters:k},i),$);n.render=compile(g,L)}}t.render=n.render||NOOP}{const g=setCurrentInstance(t);pauseTracking();try{applyOptions(t)}finally{resetTracking(),g()}}}function getAttrsProxy(t){return t.attrsProxy||(t.attrsProxy=new Proxy(t.attrs,{get(r,e){return track(t,"get","$attrs"),r[e]}}))}function createSetupContext(t){const r=e=>{t.exposed=e||{}};return{get attrs(){return getAttrsProxy(t)},slots:t.slots,emit:t.emit,expose:r}}function getExposeProxy(t){if(t.exposed)return t.exposeProxy||(t.exposeProxy=new Proxy(proxyRefs(markRaw(t.exposed)),{get(r,e){if(e in r)return r[e];if(e in publicPropertiesMap)return publicPropertiesMap[e](t)},has(r,e){return e in r||e in publicPropertiesMap}}))}const classifyRE=/(?:^|[-_])(\w)/g,classify=t=>t.replace(classifyRE,r=>r.toUpperCase()).replace(/[-_]/g,"");function getComponentName(t,r=!0){return isFunction$3(t)?t.displayName||t.name:t.name||r&&t.__name}function formatComponentName(t,r,e=!1){let n=getComponentName(r);if(!n&&r.__file){const g=r.__file.match(/([^/\\]+)\.\w+$/);g&&(n=g[1])}if(!n&&t&&t.parent){const g=y=>{for(const i in y)if(y[i]===r)return i};n=g(t.components||t.parent.type.components)||g(t.appContext.components)}return n?classify(n):e?"App":"Anonymous"}function isClassComponent(t){return isFunction$3(t)&&"__vccOpts"in t}const computed=(t,r)=>computed$1(t,r,isInSSRComponentSetup);function h$1(t,r,e){const n=arguments.length;return n===2?isObject$2(r)&&!isArray$3(r)?isVNode(r)?createVNode(t,null,[r]):createVNode(t,r):createVNode(t,null,r):(n>3?e=Array.prototype.slice.call(arguments,2):n===3&&isVNode(e)&&(e=[e]),createVNode(t,r,e))}const version="3.4.20",warn=NOOP;/**
* @vue/runtime-dom v3.4.20
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/const svgNS="http://www.w3.org/2000/svg",mathmlNS="http://www.w3.org/1998/Math/MathML",doc=typeof document<"u"?document:null,templateContainer=doc&&doc.createElement("template"),nodeOps={insert:(t,r,e)=>{r.insertBefore(t,e||null)},remove:t=>{const r=t.parentNode;r&&r.removeChild(t)},createElement:(t,r,e,n)=>{const g=r==="svg"?doc.createElementNS(svgNS,t):r==="mathml"?doc.createElementNS(mathmlNS,t):doc.createElement(t,e?{is:e}:void 0);return t==="select"&&n&&n.multiple!=null&&g.setAttribute("multiple",n.multiple),g},createText:t=>doc.createTextNode(t),createComment:t=>doc.createComment(t),setText:(t,r)=>{t.nodeValue=r},setElementText:(t,r)=>{t.textContent=r},parentNode:t=>t.parentNode,nextSibling:t=>t.nextSibling,querySelector:t=>doc.querySelector(t),setScopeId(t,r){t.setAttribute(r,"")},insertStaticContent(t,r,e,n,g,y){const i=e?e.previousSibling:r.lastChild;if(g&&(g===y||g.nextSibling))for(;r.insertBefore(g.cloneNode(!0),e),!(g===y||!(g=g.nextSibling)););else{templateContainer.innerHTML=n==="svg"?`<svg>${t}</svg>`:n==="mathml"?`<math>${t}</math>`:t;const k=templateContainer.content;if(n==="svg"||n==="mathml"){const $=k.firstChild;for(;$.firstChild;)k.appendChild($.firstChild);k.removeChild($)}r.insertBefore(k,e)}return[i?i.nextSibling:r.firstChild,e?e.previousSibling:r.lastChild]}},TRANSITION="transition",ANIMATION="animation",vtcKey=Symbol("_vtc"),Transition=(t,{slots:r})=>h$1(BaseTransition,resolveTransitionProps(t),r);Transition.displayName="Transition";const DOMTransitionPropsValidators={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String},TransitionPropsValidators=Transition.props=extend$1({},BaseTransitionPropsValidators,DOMTransitionPropsValidators),callHook=(t,r=[])=>{isArray$3(t)?t.forEach(e=>e(...r)):t&&t(...r)},hasExplicitCallback=t=>t?isArray$3(t)?t.some(r=>r.length>1):t.length>1:!1;function resolveTransitionProps(t){const r={};for(const Dt in t)Dt in DOMTransitionPropsValidators||(r[Dt]=t[Dt]);if(t.css===!1)return r;const{name:e="v",type:n,duration:g,enterFromClass:y=`${e}-enter-from`,enterActiveClass:i=`${e}-enter-active`,enterToClass:k=`${e}-enter-to`,appearFromClass:$=y,appearActiveClass:L=i,appearToClass:V=k,leaveFromClass:z=`${e}-leave-from`,leaveActiveClass:re=`${e}-leave-active`,leaveToClass:ie=`${e}-leave-to`}=t,ue=normalizeDuration(g),le=ue&&ue[0],oe=ue&&ue[1],{onBeforeEnter:ae,onEnter:qe,onEnterCancelled:de,onLeave:Ne,onLeaveCancelled:ze,onBeforeAppear:$e=ae,onAppear:Lt=qe,onAppearCancelled:jt=de}=r,Et=(Dt,lr,sr)=>{removeTransitionClass(Dt,lr?V:k),removeTransitionClass(Dt,lr?L:i),sr&&sr()},ir=(Dt,lr)=>{Dt._isLeaving=!1,removeTransitionClass(Dt,z),removeTransitionClass(Dt,ie),removeTransitionClass(Dt,re),lr&&lr()},dr=Dt=>(lr,sr)=>{const er=Dt?Lt:qe,cr=()=>Et(lr,Dt,sr);callHook(er,[lr,cr]),nextFrame(()=>{removeTransitionClass(lr,Dt?$:y),addTransitionClass(lr,Dt?V:k),hasExplicitCallback(er)||whenTransitionEnds(lr,n,le,cr)})};return extend$1(r,{onBeforeEnter(Dt){callHook(ae,[Dt]),addTransitionClass(Dt,y),addTransitionClass(Dt,i)},onBeforeAppear(Dt){callHook($e,[Dt]),addTransitionClass(Dt,$),addTransitionClass(Dt,L)},onEnter:dr(!1),onAppear:dr(!0),onLeave(Dt,lr){Dt._isLeaving=!0;const sr=()=>ir(Dt,lr);addTransitionClass(Dt,z),forceReflow(),addTransitionClass(Dt,re),nextFrame(()=>{Dt._isLeaving&&(removeTransitionClass(Dt,z),addTransitionClass(Dt,ie),hasExplicitCallback(Ne)||whenTransitionEnds(Dt,n,oe,sr))}),callHook(Ne,[Dt,sr])},onEnterCancelled(Dt){Et(Dt,!1),callHook(de,[Dt])},onAppearCancelled(Dt){Et(Dt,!0),callHook(jt,[Dt])},onLeaveCancelled(Dt){ir(Dt),callHook(ze,[Dt])}})}function normalizeDuration(t){if(t==null)return null;if(isObject$2(t))return[NumberOf(t.enter),NumberOf(t.leave)];{const r=NumberOf(t);return[r,r]}}function NumberOf(t){return toNumber$1(t)}function addTransitionClass(t,r){r.split(/\s+/).forEach(e=>e&&t.classList.add(e)),(t[vtcKey]||(t[vtcKey]=new Set)).add(r)}function removeTransitionClass(t,r){r.split(/\s+/).forEach(n=>n&&t.classList.remove(n));const e=t[vtcKey];e&&(e.delete(r),e.size||(t[vtcKey]=void 0))}function nextFrame(t){requestAnimationFrame(()=>{requestAnimationFrame(t)})}let endId=0;function whenTransitionEnds(t,r,e,n){const g=t._endId=++endId,y=()=>{g===t._endId&&n()};if(e)return setTimeout(y,e);const{type:i,timeout:k,propCount:$}=getTransitionInfo(t,r);if(!i)return n();const L=i+"end";let V=0;const z=()=>{t.removeEventListener(L,re),y()},re=ie=>{ie.target===t&&++V>=$&&z()};setTimeout(()=>{V<$&&z()},k+1),t.addEventListener(L,re)}function getTransitionInfo(t,r){const e=window.getComputedStyle(t),n=ue=>(e[ue]||"").split(", "),g=n(`${TRANSITION}Delay`),y=n(`${TRANSITION}Duration`),i=getTimeout(g,y),k=n(`${ANIMATION}Delay`),$=n(`${ANIMATION}Duration`),L=getTimeout(k,$);let V=null,z=0,re=0;r===TRANSITION?i>0&&(V=TRANSITION,z=i,re=y.length):r===ANIMATION?L>0&&(V=ANIMATION,z=L,re=$.length):(z=Math.max(i,L),V=z>0?i>L?TRANSITION:ANIMATION:null,re=V?V===TRANSITION?y.length:$.length:0);const ie=V===TRANSITION&&/\b(transform|all)(,|$)/.test(n(`${TRANSITION}Property`).toString());return{type:V,timeout:z,propCount:re,hasTransform:ie}}function getTimeout(t,r){for(;t.length<r.length;)t=t.concat(t);return Math.max(...r.map((e,n)=>toMs(e)+toMs(t[n])))}function toMs(t){return t==="auto"?0:Number(t.slice(0,-1).replace(",","."))*1e3}function forceReflow(){return document.body.offsetHeight}function patchClass(t,r,e){const n=t[vtcKey];n&&(r=(r?[r,...n]:[...n]).join(" ")),r==null?t.removeAttribute("class"):e?t.setAttribute("class",r):t.className=r}const vShowOriginalDisplay=Symbol("_vod"),vShowHidden=Symbol("_vsh"),vShow={beforeMount(t,{value:r},{transition:e}){t[vShowOriginalDisplay]=t.style.display==="none"?"":t.style.display,e&&r?e.beforeEnter(t):setDisplay(t,r)},mounted(t,{value:r},{transition:e}){e&&r&&e.enter(t)},updated(t,{value:r,oldValue:e},{transition:n}){!r!=!e&&(n?r?(n.beforeEnter(t),setDisplay(t,!0),n.enter(t)):n.leave(t,()=>{setDisplay(t,!1)}):setDisplay(t,r))},beforeUnmount(t,{value:r}){setDisplay(t,r)}};function setDisplay(t,r){t.style.display=r?t[vShowOriginalDisplay]:"none",t[vShowHidden]=!r}const CSS_VAR_TEXT=Symbol(""),displayRE=/(^|;)\s*display\s*:/;function patchStyle(t,r,e){const n=t.style,g=isString$2(e);let y=!1;if(e&&!g){if(r)if(isString$2(r))for(const i of r.split(";")){const k=i.slice(0,i.indexOf(":")).trim();e[k]==null&&setStyle(n,k,"")}else for(const i in r)e[i]==null&&setStyle(n,i,"");for(const i in e)i==="display"&&(y=!0),setStyle(n,i,e[i])}else if(g){if(r!==e){const i=n[CSS_VAR_TEXT];i&&(e+=";"+i),n.cssText=e,y=displayRE.test(e)}}else r&&t.removeAttribute("style");vShowOriginalDisplay in t&&(t[vShowOriginalDisplay]=y?n.display:"",t[vShowHidden]&&(n.display="none"))}const importantRE=/\s*!important$/;function setStyle(t,r,e){if(isArray$3(e))e.forEach(n=>setStyle(t,r,n));else if(e==null&&(e=""),r.startsWith("--"))t.setProperty(r,e);else{const n=autoPrefix(t,r);importantRE.test(e)?t.setProperty(hyphenate(n),e.replace(importantRE,""),"important"):t[n]=e}}const prefixes=["Webkit","Moz","ms"],prefixCache={};function autoPrefix(t,r){const e=prefixCache[r];if(e)return e;let n=camelize(r);if(n!=="filter"&&n in t)return prefixCache[r]=n;n=capitalize$1(n);for(let g=0;g<prefixes.length;g++){const y=prefixes[g]+n;if(y in t)return prefixCache[r]=y}return r}const xlinkNS="http://www.w3.org/1999/xlink";function patchAttr(t,r,e,n,g){if(n&&r.startsWith("xlink:"))e==null?t.removeAttributeNS(xlinkNS,r.slice(6,r.length)):t.setAttributeNS(xlinkNS,r,e);else{const y=isSpecialBooleanAttr(r);e==null||y&&!includeBooleanAttr(e)?t.removeAttribute(r):t.setAttribute(r,y?"":e)}}function patchDOMProp(t,r,e,n,g,y,i){if(r==="innerHTML"||r==="textContent"){n&&i(n,g,y),t[r]=e??"";return}const k=t.tagName;if(r==="value"&&k!=="PROGRESS"&&!k.includes("-")){t._value=e;const L=k==="OPTION"?t.getAttribute("value")||"":t.value,V=e??"";L!==V&&(t.value=V),e==null&&t.removeAttribute(r);return}let $=!1;if(e===""||e==null){const L=typeof t[r];L==="boolean"?e=includeBooleanAttr(e):e==null&&L==="string"?(e="",$=!0):L==="number"&&(e=0,$=!0)}try{t[r]=e}catch{}$&&t.removeAttribute(r)}function addEventListener(t,r,e,n){t.addEventListener(r,e,n)}function removeEventListener(t,r,e,n){t.removeEventListener(r,e,n)}const veiKey=Symbol("_vei");function patchEvent(t,r,e,n,g=null){const y=t[veiKey]||(t[veiKey]={}),i=y[r];if(n&&i)i.value=n;else{const[k,$]=parseName(r);if(n){const L=y[r]=createInvoker(n,g);addEventListener(t,k,L,$)}else i&&(removeEventListener(t,k,i,$),y[r]=void 0)}}const optionsModifierRE=/(?:Once|Passive|Capture)$/;function parseName(t){let r;if(optionsModifierRE.test(t)){r={};let n;for(;n=t.match(optionsModifierRE);)t=t.slice(0,t.length-n[0].length),r[n[0].toLowerCase()]=!0}return[t[2]===":"?t.slice(3):hyphenate(t.slice(2)),r]}let cachedNow=0;const p$1=Promise.resolve(),getNow=()=>cachedNow||(p$1.then(()=>cachedNow=0),cachedNow=Date.now());function createInvoker(t,r){const e=n=>{if(!n._vts)n._vts=Date.now();else if(n._vts<=e.attached)return;callWithAsyncErrorHandling(patchStopImmediatePropagation(n,e.value),r,5,[n])};return e.value=t,e.attached=getNow(),e}function patchStopImmediatePropagation(t,r){if(isArray$3(r)){const e=t.stopImmediatePropagation;return t.stopImmediatePropagation=()=>{e.call(t),t._stopped=!0},r.map(n=>g=>!g._stopped&&n&&n(g))}else return r}const isNativeOn=t=>t.charCodeAt(0)===111&&t.charCodeAt(1)===110&&t.charCodeAt(2)>96&&t.charCodeAt(2)<123,patchProp=(t,r,e,n,g,y,i,k,$)=>{const L=g==="svg";r==="class"?patchClass(t,n,L):r==="style"?patchStyle(t,e,n):isOn(r)?isModelListener(r)||patchEvent(t,r,e,n,i):(r[0]==="."?(r=r.slice(1),!0):r[0]==="^"?(r=r.slice(1),!1):shouldSetAsProp(t,r,n,L))?patchDOMProp(t,r,n,y,i,k,$):(r==="true-value"?t._trueValue=n:r==="false-value"&&(t._falseValue=n),patchAttr(t,r,n,L))};function shouldSetAsProp(t,r,e,n){if(n)return!!(r==="innerHTML"||r==="textContent"||r in t&&isNativeOn(r)&&isFunction$3(e));if(r==="spellcheck"||r==="draggable"||r==="translate"||r==="form"||r==="list"&&t.tagName==="INPUT"||r==="type"&&t.tagName==="TEXTAREA")return!1;if(r==="width"||r==="height"){const g=t.tagName;if(g==="IMG"||g==="VIDEO"||g==="CANVAS"||g==="SOURCE")return!1}return isNativeOn(r)&&isString$2(e)?!1:r in t}const positionMap=new WeakMap,newPositionMap=new WeakMap,moveCbKey=Symbol("_moveCb"),enterCbKey=Symbol("_enterCb"),TransitionGroupImpl={name:"TransitionGroup",props:extend$1({},TransitionPropsValidators,{tag:String,moveClass:String}),setup(t,{slots:r}){const e=getCurrentInstance(),n=useTransitionState();let g,y;return onUpdated(()=>{if(!g.length)return;const i=t.moveClass||`${t.name||"v"}-move`;if(!hasCSSTransform(g[0].el,e.vnode.el,i))return;g.forEach(callPendingCbs),g.forEach(recordPosition);const k=g.filter(applyTranslation);forceReflow(),k.forEach($=>{const L=$.el,V=L.style;addTransitionClass(L,i),V.transform=V.webkitTransform=V.transitionDuration="";const z=L[moveCbKey]=re=>{re&&re.target!==L||(!re||/transform$/.test(re.propertyName))&&(L.removeEventListener("transitionend",z),L[moveCbKey]=null,removeTransitionClass(L,i))};L.addEventListener("transitionend",z)})}),()=>{const i=toRaw(t),k=resolveTransitionProps(i);let $=i.tag||Fragment;g=y,y=r.default?getTransitionRawChildren(r.default()):[];for(let L=0;L<y.length;L++){const V=y[L];V.key!=null&&setTransitionHooks(V,resolveTransitionHooks(V,k,n,e))}if(g)for(let L=0;L<g.length;L++){const V=g[L];setTransitionHooks(V,resolveTransitionHooks(V,k,n,e)),positionMap.set(V,V.el.getBoundingClientRect())}return createVNode($,null,y)}}},removeMode=t=>delete t.mode;TransitionGroupImpl.props;const TransitionGroup=TransitionGroupImpl;function callPendingCbs(t){const r=t.el;r[moveCbKey]&&r[moveCbKey](),r[enterCbKey]&&r[enterCbKey]()}function recordPosition(t){newPositionMap.set(t,t.el.getBoundingClientRect())}function applyTranslation(t){const r=positionMap.get(t),e=newPositionMap.get(t),n=r.left-e.left,g=r.top-e.top;if(n||g){const y=t.el.style;return y.transform=y.webkitTransform=`translate(${n}px,${g}px)`,y.transitionDuration="0s",t}}function hasCSSTransform(t,r,e){const n=t.cloneNode(),g=t[vtcKey];g&&g.forEach(k=>{k.split(/\s+/).forEach($=>$&&n.classList.remove($))}),e.split(/\s+/).forEach(k=>k&&n.classList.add(k)),n.style.display="none";const y=r.nodeType===1?r:r.parentNode;y.appendChild(n);const{hasTransform:i}=getTransitionInfo(n);return y.removeChild(n),i}const getModelAssigner=t=>{const r=t.props["onUpdate:modelValue"]||!1;return isArray$3(r)?e=>invokeArrayFns(r,e):r};function onCompositionStart(t){t.target.composing=!0}function onCompositionEnd(t){const r=t.target;r.composing&&(r.composing=!1,r.dispatchEvent(new Event("input")))}const assignKey=Symbol("_assign"),vModelText={created(t,{modifiers:{lazy:r,trim:e,number:n}},g){t[assignKey]=getModelAssigner(g);const y=n||g.props&&g.props.type==="number";addEventListener(t,r?"change":"input",i=>{if(i.target.composing)return;let k=t.value;e&&(k=k.trim()),y&&(k=looseToNumber(k)),t[assignKey](k)}),e&&addEventListener(t,"change",()=>{t.value=t.value.trim()}),r||(addEventListener(t,"compositionstart",onCompositionStart),addEventListener(t,"compositionend",onCompositionEnd),addEventListener(t,"change",onCompositionEnd))},mounted(t,{value:r}){t.value=r??""},beforeUpdate(t,{value:r,modifiers:{lazy:e,trim:n,number:g}},y){if(t[assignKey]=getModelAssigner(y),t.composing)return;const i=g||t.type==="number"?looseToNumber(t.value):t.value,k=r??"";i!==k&&(document.activeElement===t&&t.type!=="range"&&(e||n&&t.value.trim()===k)||(t.value=k))}},vModelCheckbox={deep:!0,created(t,r,e){t[assignKey]=getModelAssigner(e),addEventListener(t,"change",()=>{const n=t._modelValue,g=getValue$2(t),y=t.checked,i=t[assignKey];if(isArray$3(n)){const k=looseIndexOf(n,g),$=k!==-1;if(y&&!$)i(n.concat(g));else if(!y&&$){const L=[...n];L.splice(k,1),i(L)}}else if(isSet$2(n)){const k=new Set(n);y?k.add(g):k.delete(g),i(k)}else i(getCheckboxValue(t,y))})},mounted:setChecked,beforeUpdate(t,r,e){t[assignKey]=getModelAssigner(e),setChecked(t,r,e)}};function setChecked(t,{value:r,oldValue:e},n){t._modelValue=r,isArray$3(r)?t.checked=looseIndexOf(r,n.props.value)>-1:isSet$2(r)?t.checked=r.has(n.props.value):r!==e&&(t.checked=looseEqual(r,getCheckboxValue(t,!0)))}const vModelRadio={created(t,{value:r},e){t.checked=looseEqual(r,e.props.value),t[assignKey]=getModelAssigner(e),addEventListener(t,"change",()=>{t[assignKey](getValue$2(t))})},beforeUpdate(t,{value:r,oldValue:e},n){t[assignKey]=getModelAssigner(n),r!==e&&(t.checked=looseEqual(r,n.props.value))}};function getValue$2(t){return"_value"in t?t._value:t.value}function getCheckboxValue(t,r){const e=r?"_trueValue":"_falseValue";return e in t?t[e]:r}const systemModifiers=["ctrl","shift","alt","meta"],modifierGuards={stop:t=>t.stopPropagation(),prevent:t=>t.preventDefault(),self:t=>t.target!==t.currentTarget,ctrl:t=>!t.ctrlKey,shift:t=>!t.shiftKey,alt:t=>!t.altKey,meta:t=>!t.metaKey,left:t=>"button"in t&&t.button!==0,middle:t=>"button"in t&&t.button!==1,right:t=>"button"in t&&t.button!==2,exact:(t,r)=>systemModifiers.some(e=>t[`${e}Key`]&&!r.includes(e))},withModifiers=(t,r)=>{const e=t._withMods||(t._withMods={}),n=r.join(".");return e[n]||(e[n]=(g,...y)=>{for(let i=0;i<r.length;i++){const k=modifierGuards[r[i]];if(k&&k(g,r))return}return t(g,...y)})},keyNames={esc:"escape",space:" ",up:"arrow-up",left:"arrow-left",right:"arrow-right",down:"arrow-down",delete:"backspace"},withKeys=(t,r)=>{const e=t._withKeys||(t._withKeys={}),n=r.join(".");return e[n]||(e[n]=g=>{if(!("key"in g))return;const y=hyphenate(g.key);if(r.some(i=>i===y||keyNames[i]===y))return t(g)})},rendererOptions=extend$1({patchProp},nodeOps);let renderer;function ensureRenderer(){return renderer||(renderer=createRenderer(rendererOptions))}const render=(...t)=>{ensureRenderer().render(...t)},createApp=(...t)=>{const r=ensureRenderer().createApp(...t),{mount:e}=r;return r.mount=n=>{const g=normalizeContainer(n);if(!g)return;const y=r._component;!isFunction$3(y)&&!y.render&&!y.template&&(y.template=g.innerHTML),g.innerHTML="";const i=e(g,!1,resolveRootNamespace(g));return g instanceof Element&&(g.removeAttribute("v-cloak"),g.setAttribute("data-v-app","")),i},r};function resolveRootNamespace(t){if(t instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&t instanceof MathMLElement)return"mathml"}function normalizeContainer(t){return isString$2(t)?document.querySelector(t):t}const FOCUSABLE_ELEMENT_SELECTORS='a[href],button:not([disabled]),button:not([hidden]),:not([tabindex="-1"]),input:not([disabled]),input:not([type="hidden"]),select:not([disabled]),textarea:not([disabled])',isVisible=t=>getComputedStyle(t).position==="fixed"?!1:t.offsetParent!==null,obtainAllFocusableElements$1=t=>Array.from(t.querySelectorAll(FOCUSABLE_ELEMENT_SELECTORS)).filter(r=>isFocusable(r)&&isVisible(r)),isFocusable=t=>{if(t.tabIndex>0||t.tabIndex===0&&t.getAttribute("tabIndex")!==null)return!0;if(t.disabled)return!1;switch(t.nodeName){case"A":return!!t.href&&t.rel!=="ignore";case"INPUT":return!(t.type==="hidden"||t.type==="file");case"BUTTON":case"SELECT":case"TEXTAREA":return!0;default:return!1}},triggerEvent=function(t,r,...e){let n;r.includes("mouse")||r.includes("click")?n="MouseEvents":r.includes("key")?n="KeyboardEvent":n="HTMLEvents";const g=document.createEvent(n);return g.initEvent(r,...e),t.dispatchEvent(g),t},isLeaf=t=>!t.getAttribute("aria-owns"),getSibling=(t,r,e)=>{const{parentNode:n}=t;if(!n)return null;const g=n.querySelectorAll(e),y=Array.prototype.indexOf.call(g,t);return g[y+r]||null},focusNode=t=>{t&&(t.focus(),!isLeaf(t)&&t.click())},composeEventHandlers=(t,r,{checkForDefaultPrevented:e=!0}={})=>g=>{const y=t==null?void 0:t(g);if(e===!1||!y)return r==null?void 0:r(g)};var _a;const isClient=typeof window<"u",isDef=t=>typeof t<"u",isFunction$2=t=>typeof t=="function",isString$1=t=>typeof t=="string",noop$1=()=>{},isIOS=isClient&&((_a=window==null?void 0:window.navigator)==null?void 0:_a.userAgent)&&/iP(ad|hone|od)/.test(window.navigator.userAgent);function resolveUnref(t){return typeof t=="function"?t():unref(t)}function createFilterWrapper(t,r){function e(...n){return new Promise((g,y)=>{Promise.resolve(t(()=>r.apply(this,n),{fn:r,thisArg:this,args:n})).then(g).catch(y)})}return e}function debounceFilter(t,r={}){let e,n,g=noop$1;const y=k=>{clearTimeout(k),g(),g=noop$1};return k=>{const $=resolveUnref(t),L=resolveUnref(r.maxWait);return e&&y(e),$<=0||L!==void 0&&L<=0?(n&&(y(n),n=null),Promise.resolve(k())):new Promise((V,z)=>{g=r.rejectOnCancel?z:V,L&&!n&&(n=setTimeout(()=>{e&&y(e),n=null,V(k())},L)),e=setTimeout(()=>{n&&y(n),n=null,V(k())},$)})}}function throttleFilter(t,r=!0,e=!0,n=!1){let g=0,y,i=!0,k=noop$1,$;const L=()=>{y&&(clearTimeout(y),y=void 0,k(),k=noop$1)};return z=>{const re=resolveUnref(t),ie=Date.now()-g,ue=()=>$=z();return L(),re<=0?(g=Date.now(),ue()):(ie>re&&(e||!i)?(g=Date.now(),ue()):r&&($=new Promise((le,oe)=>{k=n?oe:le,y=setTimeout(()=>{g=Date.now(),i=!0,le(ue()),L()},Math.max(0,re-ie))})),!e&&!y&&(y=setTimeout(()=>i=!0,re)),i=!1,$)}}function identity$1(t){return t}function tryOnScopeDispose(t){return getCurrentScope()?(onScopeDispose(t),!0):!1}function useDebounceFn(t,r=200,e={}){return createFilterWrapper(debounceFilter(r,e),t)}function refDebounced(t,r=200,e={}){const n=ref(t.value),g=useDebounceFn(()=>{n.value=t.value},r,e);return watch(t,()=>g()),n}function useThrottleFn(t,r=200,e=!1,n=!0,g=!1){return createFilterWrapper(throttleFilter(r,e,n,g),t)}function tryOnMounted(t,r=!0){getCurrentInstance()?onMounted(t):r?t():nextTick(t)}function useTimeoutFn(t,r,e={}){const{immediate:n=!0}=e,g=ref(!1);let y=null;function i(){y&&(clearTimeout(y),y=null)}function k(){g.value=!1,i()}function $(...L){i(),g.value=!0,y=setTimeout(()=>{g.value=!1,y=null,t(...L)},resolveUnref(r))}return n&&(g.value=!0,isClient&&$()),tryOnScopeDispose(k),{isPending:readonly(g),start:$,stop:k}}function unrefElement(t){var r;const e=resolveUnref(t);return(r=e==null?void 0:e.$el)!=null?r:e}const defaultWindow=isClient?window:void 0;function useEventListener(...t){let r,e,n,g;if(isString$1(t[0])||Array.isArray(t[0])?([e,n,g]=t,r=defaultWindow):[r,e,n,g]=t,!r)return noop$1;Array.isArray(e)||(e=[e]),Array.isArray(n)||(n=[n]);const y=[],i=()=>{y.forEach(V=>V()),y.length=0},k=(V,z,re,ie)=>(V.addEventListener(z,re,ie),()=>V.removeEventListener(z,re,ie)),$=watch(()=>[unrefElement(r),resolveUnref(g)],([V,z])=>{i(),V&&y.push(...e.flatMap(re=>n.map(ie=>k(V,re,ie,z))))},{immediate:!0,flush:"post"}),L=()=>{$(),i()};return tryOnScopeDispose(L),L}let _iOSWorkaround=!1;function onClickOutside(t,r,e={}){const{window:n=defaultWindow,ignore:g=[],capture:y=!0,detectIframe:i=!1}=e;if(!n)return;isIOS&&!_iOSWorkaround&&(_iOSWorkaround=!0,Array.from(n.document.body.children).forEach(re=>re.addEventListener("click",noop$1)));let k=!0;const $=re=>g.some(ie=>{if(typeof ie=="string")return Array.from(n.document.querySelectorAll(ie)).some(ue=>ue===re.target||re.composedPath().includes(ue));{const ue=unrefElement(ie);return ue&&(re.target===ue||re.composedPath().includes(ue))}}),V=[useEventListener(n,"click",re=>{const ie=unrefElement(t);if(!(!ie||ie===re.target||re.composedPath().includes(ie))){if(re.detail===0&&(k=!$(re)),!k){k=!0;return}r(re)}},{passive:!0,capture:y}),useEventListener(n,"pointerdown",re=>{const ie=unrefElement(t);ie&&(k=!re.composedPath().includes(ie)&&!$(re))},{passive:!0}),i&&useEventListener(n,"blur",re=>{var ie;const ue=unrefElement(t);((ie=n.document.activeElement)==null?void 0:ie.tagName)==="IFRAME"&&!(ue!=null&&ue.contains(n.document.activeElement))&&r(re)})].filter(Boolean);return()=>V.forEach(re=>re())}function useSupported(t,r=!1){const e=ref(),n=()=>e.value=!!t();return n(),tryOnMounted(n,r),e}function cloneFnJSON(t){return JSON.parse(JSON.stringify(t))}const _global$1=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},globalKey="__vueuse_ssr_handlers__";_global$1[globalKey]=_global$1[globalKey]||{};function useCssVar(t,r,{window:e=defaultWindow,initialValue:n=""}={}){const g=ref(n),y=computed(()=>{var i;return unrefElement(r)||((i=e==null?void 0:e.document)==null?void 0:i.documentElement)});return watch([y,()=>resolveUnref(t)],([i,k])=>{var $;if(i&&e){const L=($=e.getComputedStyle(i).getPropertyValue(k))==null?void 0:$.trim();g.value=L||n}},{immediate:!0}),watch(g,i=>{var k;(k=y.value)!=null&&k.style&&y.value.style.setProperty(resolveUnref(t),i)}),g}var __getOwnPropSymbols$g=Object.getOwnPropertySymbols,__hasOwnProp$g=Object.prototype.hasOwnProperty,__propIsEnum$g=Object.prototype.propertyIsEnumerable,__objRest$2=(t,r)=>{var e={};for(var n in t)__hasOwnProp$g.call(t,n)&&r.indexOf(n)<0&&(e[n]=t[n]);if(t!=null&&__getOwnPropSymbols$g)for(var n of __getOwnPropSymbols$g(t))r.indexOf(n)<0&&__propIsEnum$g.call(t,n)&&(e[n]=t[n]);return e};function useResizeObserver(t,r,e={}){const n=e,{window:g=defaultWindow}=n,y=__objRest$2(n,["window"]);let i;const k=useSupported(()=>g&&"ResizeObserver"in g),$=()=>{i&&(i.disconnect(),i=void 0)},L=watch(()=>unrefElement(t),z=>{$(),k.value&&g&&z&&(i=new ResizeObserver(r),i.observe(z,y))},{immediate:!0,flush:"post"}),V=()=>{$(),L()};return tryOnScopeDispose(V),{isSupported:k,stop:V}}function useElementBounding(t,r={}){const{reset:e=!0,windowResize:n=!0,windowScroll:g=!0,immediate:y=!0}=r,i=ref(0),k=ref(0),$=ref(0),L=ref(0),V=ref(0),z=ref(0),re=ref(0),ie=ref(0);function ue(){const le=unrefElement(t);if(!le){e&&(i.value=0,k.value=0,$.value=0,L.value=0,V.value=0,z.value=0,re.value=0,ie.value=0);return}const oe=le.getBoundingClientRect();i.value=oe.height,k.value=oe.bottom,$.value=oe.left,L.value=oe.right,V.value=oe.top,z.value=oe.width,re.value=oe.x,ie.value=oe.y}return useResizeObserver(t,ue),watch(()=>unrefElement(t),le=>!le&&ue()),g&&useEventListener("scroll",ue,{capture:!0,passive:!0}),n&&useEventListener("resize",ue,{passive:!0}),tryOnMounted(()=>{y&&ue()}),{height:i,bottom:k,left:$,right:L,top:V,width:z,x:re,y:ie,update:ue}}var SwipeDirection;(function(t){t.UP="UP",t.RIGHT="RIGHT",t.DOWN="DOWN",t.LEFT="LEFT",t.NONE="NONE"})(SwipeDirection||(SwipeDirection={}));var __defProp=Object.defineProperty,__getOwnPropSymbols=Object.getOwnPropertySymbols,__hasOwnProp=Object.prototype.hasOwnProperty,__propIsEnum=Object.prototype.propertyIsEnumerable,__defNormalProp=(t,r,e)=>r in t?__defProp(t,r,{enumerable:!0,configurable:!0,writable:!0,value:e}):t[r]=e,__spreadValues=(t,r)=>{for(var e in r||(r={}))__hasOwnProp.call(r,e)&&__defNormalProp(t,e,r[e]);if(__getOwnPropSymbols)for(var e of __getOwnPropSymbols(r))__propIsEnum.call(r,e)&&__defNormalProp(t,e,r[e]);return t};const _TransitionPresets={easeInSine:[.12,0,.39,0],easeOutSine:[.61,1,.88,1],easeInOutSine:[.37,0,.63,1],easeInQuad:[.11,0,.5,0],easeOutQuad:[.5,1,.89,1],easeInOutQuad:[.45,0,.55,1],easeInCubic:[.32,0,.67,0],easeOutCubic:[.33,1,.68,1],easeInOutCubic:[.65,0,.35,1],easeInQuart:[.5,0,.75,0],easeOutQuart:[.25,1,.5,1],easeInOutQuart:[.76,0,.24,1],easeInQuint:[.64,0,.78,0],easeOutQuint:[.22,1,.36,1],easeInOutQuint:[.83,0,.17,1],easeInExpo:[.7,0,.84,0],easeOutExpo:[.16,1,.3,1],easeInOutExpo:[.87,0,.13,1],easeInCirc:[.55,0,1,.45],easeOutCirc:[0,.55,.45,1],easeInOutCirc:[.85,0,.15,1],easeInBack:[.36,0,.66,-.56],easeOutBack:[.34,1.56,.64,1],easeInOutBack:[.68,-.6,.32,1.6]};__spreadValues({linear:identity$1},_TransitionPresets);function useVModel(t,r,e,n={}){var g,y,i;const{clone:k=!1,passive:$=!1,eventName:L,deep:V=!1,defaultValue:z}=n,re=getCurrentInstance(),ie=e||(re==null?void 0:re.emit)||((g=re==null?void 0:re.$emit)==null?void 0:g.bind(re))||((i=(y=re==null?void 0:re.proxy)==null?void 0:y.$emit)==null?void 0:i.bind(re==null?void 0:re.proxy));let ue=L;r||(r="modelValue"),ue=L||ue||`update:${r.toString()}`;const le=ae=>k?isFunction$2(k)?k(ae):cloneFnJSON(ae):ae,oe=()=>isDef(t[r])?le(t[r]):z;if($){const ae=oe(),qe=ref(ae);return watch(()=>t[r],de=>qe.value=le(de)),watch(qe,de=>{(de!==t[r]||V)&&ie(ue,de)},{deep:V}),qe}else return computed({get(){return oe()},set(ae){ie(ue,ae)}})}function useWindowSize(t={}){const{window:r=defaultWindow,initialWidth:e=1/0,initialHeight:n=1/0,listenOrientation:g=!0,includeScrollbar:y=!0}=t,i=ref(e),k=ref(n),$=()=>{r&&(y?(i.value=r.innerWidth,k.value=r.innerHeight):(i.value=r.document.documentElement.clientWidth,k.value=r.document.documentElement.clientHeight))};return $(),tryOnMounted($),useEventListener("resize",$,{passive:!0}),g&&useEventListener("orientationchange",$,{passive:!0}),{width:i,height:k}}const isFirefox=()=>isClient&&/firefox/i.test(window.navigator.userAgent),isInContainer=(t,r)=>{if(!isClient||!t||!r)return!1;const e=t.getBoundingClientRect();let n;return r instanceof Element?n=r.getBoundingClientRect():n={top:0,right:window.innerWidth,bottom:window.innerHeight,left:0},e.top<n.bottom&&e.bottom>n.top&&e.right>n.left&&e.left<n.right};var freeGlobal=typeof global=="object"&&global&&global.Object===Object&&global;const freeGlobal$1=freeGlobal;var freeSelf=typeof self=="object"&&self&&self.Object===Object&&self,root=freeGlobal$1||freeSelf||Function("return this")();const root$1=root;var Symbol$1=root$1.Symbol;const Symbol$2=Symbol$1;var objectProto$f=Object.prototype,hasOwnProperty$d=objectProto$f.hasOwnProperty,nativeObjectToString$1=objectProto$f.toString,symToStringTag$1=Symbol$2?Symbol$2.toStringTag:void 0;function getRawTag(t){var r=hasOwnProperty$d.call(t,symToStringTag$1),e=t[symToStringTag$1];try{t[symToStringTag$1]=void 0;var n=!0}catch{}var g=nativeObjectToString$1.call(t);return n&&(r?t[symToStringTag$1]=e:delete t[symToStringTag$1]),g}var objectProto$e=Object.prototype,nativeObjectToString=objectProto$e.toString;function objectToString(t){return nativeObjectToString.call(t)}var nullTag="[object Null]",undefinedTag="[object Undefined]",symToStringTag=Symbol$2?Symbol$2.toStringTag:void 0;function baseGetTag(t){return t==null?t===void 0?undefinedTag:nullTag:symToStringTag&&symToStringTag in Object(t)?getRawTag(t):objectToString(t)}function isObjectLike(t){return t!=null&&typeof t=="object"}var symbolTag$3="[object Symbol]";function isSymbol(t){return typeof t=="symbol"||isObjectLike(t)&&baseGetTag(t)==symbolTag$3}function arrayMap(t,r){for(var e=-1,n=t==null?0:t.length,g=Array(n);++e<n;)g[e]=r(t[e],e,t);return g}var isArray$1=Array.isArray;const isArray$2=isArray$1;var INFINITY$2=1/0,symbolProto$2=Symbol$2?Symbol$2.prototype:void 0,symbolToString=symbolProto$2?symbolProto$2.toString:void 0;function baseToString(t){if(typeof t=="string")return t;if(isArray$2(t))return arrayMap(t,baseToString)+"";if(isSymbol(t))return symbolToString?symbolToString.call(t):"";var r=t+"";return r=="0"&&1/t==-INFINITY$2?"-0":r}var reWhitespace=/\s/;function trimmedEndIndex(t){for(var r=t.length;r--&&reWhitespace.test(t.charAt(r)););return r}var reTrimStart=/^\s+/;function baseTrim(t){return t&&t.slice(0,trimmedEndIndex(t)+1).replace(reTrimStart,"")}function isObject$1(t){var r=typeof t;return t!=null&&(r=="object"||r=="function")}var NAN=0/0,reIsBadHex=/^[-+]0x[0-9a-f]+$/i,reIsBinary=/^0b[01]+$/i,reIsOctal=/^0o[0-7]+$/i,freeParseInt=parseInt;function toNumber(t){if(typeof t=="number")return t;if(isSymbol(t))return NAN;if(isObject$1(t)){var r=typeof t.valueOf=="function"?t.valueOf():t;t=isObject$1(r)?r+"":r}if(typeof t!="string")return t===0?t:+t;t=baseTrim(t);var e=reIsBinary.test(t);return e||reIsOctal.test(t)?freeParseInt(t.slice(2),e?2:8):reIsBadHex.test(t)?NAN:+t}function identity(t){return t}var asyncTag="[object AsyncFunction]",funcTag$2="[object Function]",genTag$1="[object GeneratorFunction]",proxyTag="[object Proxy]";function isFunction$1(t){if(!isObject$1(t))return!1;var r=baseGetTag(t);return r==funcTag$2||r==genTag$1||r==asyncTag||r==proxyTag}var coreJsData=root$1["__core-js_shared__"];const coreJsData$1=coreJsData;var maskSrcKey=function(){var t=/[^.]+$/.exec(coreJsData$1&&coreJsData$1.keys&&coreJsData$1.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}();function isMasked(t){return!!maskSrcKey&&maskSrcKey in t}var funcProto$2=Function.prototype,funcToString$2=funcProto$2.toString;function toSource(t){if(t!=null){try{return funcToString$2.call(t)}catch{}try{return t+""}catch{}}return""}var reRegExpChar=/[\\^$.*+?()[\]{}|]/g,reIsHostCtor=/^\[object .+?Constructor\]$/,funcProto$1=Function.prototype,objectProto$d=Object.prototype,funcToString$1=funcProto$1.toString,hasOwnProperty$c=objectProto$d.hasOwnProperty,reIsNative=RegExp("^"+funcToString$1.call(hasOwnProperty$c).replace(reRegExpChar,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function baseIsNative(t){if(!isObject$1(t)||isMasked(t))return!1;var r=isFunction$1(t)?reIsNative:reIsHostCtor;return r.test(toSource(t))}function getValue$1(t,r){return t==null?void 0:t[r]}function getNative(t,r){var e=getValue$1(t,r);return baseIsNative(e)?e:void 0}var WeakMap$1=getNative(root$1,"WeakMap");const WeakMap$2=WeakMap$1;var objectCreate=Object.create,baseCreate=function(){function t(){}return function(r){if(!isObject$1(r))return{};if(objectCreate)return objectCreate(r);t.prototype=r;var e=new t;return t.prototype=void 0,e}}();const baseCreate$1=baseCreate;function apply(t,r,e){switch(e.length){case 0:return t.call(r);case 1:return t.call(r,e[0]);case 2:return t.call(r,e[0],e[1]);case 3:return t.call(r,e[0],e[1],e[2])}return t.apply(r,e)}function copyArray(t,r){var e=-1,n=t.length;for(r||(r=Array(n));++e<n;)r[e]=t[e];return r}var HOT_COUNT=800,HOT_SPAN=16,nativeNow=Date.now;function shortOut(t){var r=0,e=0;return function(){var n=nativeNow(),g=HOT_SPAN-(n-e);if(e=n,g>0){if(++r>=HOT_COUNT)return arguments[0]}else r=0;return t.apply(void 0,arguments)}}function constant(t){return function(){return t}}var defineProperty=function(){try{var t=getNative(Object,"defineProperty");return t({},"",{}),t}catch{}}();const defineProperty$1=defineProperty;var baseSetToString=defineProperty$1?function(t,r){return defineProperty$1(t,"toString",{configurable:!0,enumerable:!1,value:constant(r),writable:!0})}:identity;const baseSetToString$1=baseSetToString;var setToString=shortOut(baseSetToString$1);const setToString$1=setToString;function arrayEach(t,r){for(var e=-1,n=t==null?0:t.length;++e<n&&r(t[e],e,t)!==!1;);return t}var MAX_SAFE_INTEGER$1=9007199254740991,reIsUint=/^(?:0|[1-9]\d*)$/;function isIndex(t,r){var e=typeof t;return r=r??MAX_SAFE_INTEGER$1,!!r&&(e=="number"||e!="symbol"&&reIsUint.test(t))&&t>-1&&t%1==0&&t<r}function baseAssignValue(t,r,e){r=="__proto__"&&defineProperty$1?defineProperty$1(t,r,{configurable:!0,enumerable:!0,value:e,writable:!0}):t[r]=e}function eq(t,r){return t===r||t!==t&&r!==r}var objectProto$c=Object.prototype,hasOwnProperty$b=objectProto$c.hasOwnProperty;function assignValue(t,r,e){var n=t[r];(!(hasOwnProperty$b.call(t,r)&&eq(n,e))||e===void 0&&!(r in t))&&baseAssignValue(t,r,e)}function copyObject(t,r,e,n){var g=!e;e||(e={});for(var y=-1,i=r.length;++y<i;){var k=r[y],$=n?n(e[k],t[k],k,e,t):void 0;$===void 0&&($=t[k]),g?baseAssignValue(e,k,$):assignValue(e,k,$)}return e}var nativeMax$1=Math.max;function overRest(t,r,e){return r=nativeMax$1(r===void 0?t.length-1:r,0),function(){for(var n=arguments,g=-1,y=nativeMax$1(n.length-r,0),i=Array(y);++g<y;)i[g]=n[r+g];g=-1;for(var k=Array(r+1);++g<r;)k[g]=n[g];return k[r]=e(i),apply(t,this,k)}}function baseRest(t,r){return setToString$1(overRest(t,r,identity),t+"")}var MAX_SAFE_INTEGER=9007199254740991;function isLength(t){return typeof t=="number"&&t>-1&&t%1==0&&t<=MAX_SAFE_INTEGER}function isArrayLike(t){return t!=null&&isLength(t.length)&&!isFunction$1(t)}function isIterateeCall(t,r,e){if(!isObject$1(e))return!1;var n=typeof r;return(n=="number"?isArrayLike(e)&&isIndex(r,e.length):n=="string"&&r in e)?eq(e[r],t):!1}function createAssigner(t){return baseRest(function(r,e){var n=-1,g=e.length,y=g>1?e[g-1]:void 0,i=g>2?e[2]:void 0;for(y=t.length>3&&typeof y=="function"?(g--,y):void 0,i&&isIterateeCall(e[0],e[1],i)&&(y=g<3?void 0:y,g=1),r=Object(r);++n<g;){var k=e[n];k&&t(r,k,n,y)}return r})}var objectProto$b=Object.prototype;function isPrototype(t){var r=t&&t.constructor,e=typeof r=="function"&&r.prototype||objectProto$b;return t===e}function baseTimes(t,r){for(var e=-1,n=Array(t);++e<t;)n[e]=r(e);return n}var argsTag$3="[object Arguments]";function baseIsArguments(t){return isObjectLike(t)&&baseGetTag(t)==argsTag$3}var objectProto$a=Object.prototype,hasOwnProperty$a=objectProto$a.hasOwnProperty,propertyIsEnumerable$1=objectProto$a.propertyIsEnumerable,isArguments=baseIsArguments(function(){return arguments}())?baseIsArguments:function(t){return isObjectLike(t)&&hasOwnProperty$a.call(t,"callee")&&!propertyIsEnumerable$1.call(t,"callee")};const isArguments$1=isArguments;function stubFalse(){return!1}var freeExports$2=typeof exports=="object"&&exports&&!exports.nodeType&&exports,freeModule$2=freeExports$2&&typeof module=="object"&&module&&!module.nodeType&&module,moduleExports$2=freeModule$2&&freeModule$2.exports===freeExports$2,Buffer$2=moduleExports$2?root$1.Buffer:void 0,nativeIsBuffer=Buffer$2?Buffer$2.isBuffer:void 0,isBuffer$1=nativeIsBuffer||stubFalse;const isBuffer$2=isBuffer$1;var argsTag$2="[object Arguments]",arrayTag$2="[object Array]",boolTag$3="[object Boolean]",dateTag$3="[object Date]",errorTag$2="[object Error]",funcTag$1="[object Function]",mapTag$5="[object Map]",numberTag$3="[object Number]",objectTag$4="[object Object]",regexpTag$3="[object RegExp]",setTag$5="[object Set]",stringTag$3="[object String]",weakMapTag$2="[object WeakMap]",arrayBufferTag$3="[object ArrayBuffer]",dataViewTag$4="[object DataView]",float32Tag$2="[object Float32Array]",float64Tag$2="[object Float64Array]",int8Tag$2="[object Int8Array]",int16Tag$2="[object Int16Array]",int32Tag$2="[object Int32Array]",uint8Tag$2="[object Uint8Array]",uint8ClampedTag$2="[object Uint8ClampedArray]",uint16Tag$2="[object Uint16Array]",uint32Tag$2="[object Uint32Array]",typedArrayTags={};typedArrayTags[float32Tag$2]=typedArrayTags[float64Tag$2]=typedArrayTags[int8Tag$2]=typedArrayTags[int16Tag$2]=typedArrayTags[int32Tag$2]=typedArrayTags[uint8Tag$2]=typedArrayTags[uint8ClampedTag$2]=typedArrayTags[uint16Tag$2]=typedArrayTags[uint32Tag$2]=!0;typedArrayTags[argsTag$2]=typedArrayTags[arrayTag$2]=typedArrayTags[arrayBufferTag$3]=typedArrayTags[boolTag$3]=typedArrayTags[dataViewTag$4]=typedArrayTags[dateTag$3]=typedArrayTags[errorTag$2]=typedArrayTags[funcTag$1]=typedArrayTags[mapTag$5]=typedArrayTags[numberTag$3]=typedArrayTags[objectTag$4]=typedArrayTags[regexpTag$3]=typedArrayTags[setTag$5]=typedArrayTags[stringTag$3]=typedArrayTags[weakMapTag$2]=!1;function baseIsTypedArray(t){return isObjectLike(t)&&isLength(t.length)&&!!typedArrayTags[baseGetTag(t)]}function baseUnary(t){return function(r){return t(r)}}var freeExports$1=typeof exports=="object"&&exports&&!exports.nodeType&&exports,freeModule$1=freeExports$1&&typeof module=="object"&&module&&!module.nodeType&&module,moduleExports$1=freeModule$1&&freeModule$1.exports===freeExports$1,freeProcess=moduleExports$1&&freeGlobal$1.process,nodeUtil=function(){try{var t=freeModule$1&&freeModule$1.require&&freeModule$1.require("util").types;return t||freeProcess&&freeProcess.binding&&freeProcess.binding("util")}catch{}}();const nodeUtil$1=nodeUtil;var nodeIsTypedArray=nodeUtil$1&&nodeUtil$1.isTypedArray,isTypedArray$1=nodeIsTypedArray?baseUnary(nodeIsTypedArray):baseIsTypedArray;const isTypedArray$2=isTypedArray$1;var objectProto$9=Object.prototype,hasOwnProperty$9=objectProto$9.hasOwnProperty;function arrayLikeKeys(t,r){var e=isArray$2(t),n=!e&&isArguments$1(t),g=!e&&!n&&isBuffer$2(t),y=!e&&!n&&!g&&isTypedArray$2(t),i=e||n||g||y,k=i?baseTimes(t.length,String):[],$=k.length;for(var L in t)(r||hasOwnProperty$9.call(t,L))&&!(i&&(L=="length"||g&&(L=="offset"||L=="parent")||y&&(L=="buffer"||L=="byteLength"||L=="byteOffset")||isIndex(L,$)))&&k.push(L);return k}function overArg(t,r){return function(e){return t(r(e))}}var nativeKeys=overArg(Object.keys,Object);const nativeKeys$1=nativeKeys;var objectProto$8=Object.prototype,hasOwnProperty$8=objectProto$8.hasOwnProperty;function baseKeys(t){if(!isPrototype(t))return nativeKeys$1(t);var r=[];for(var e in Object(t))hasOwnProperty$8.call(t,e)&&e!="constructor"&&r.push(e);return r}function keys(t){return isArrayLike(t)?arrayLikeKeys(t):baseKeys(t)}function nativeKeysIn(t){var r=[];if(t!=null)for(var e in Object(t))r.push(e);return r}var objectProto$7=Object.prototype,hasOwnProperty$7=objectProto$7.hasOwnProperty;function baseKeysIn(t){if(!isObject$1(t))return nativeKeysIn(t);var r=isPrototype(t),e=[];for(var n in t)n=="constructor"&&(r||!hasOwnProperty$7.call(t,n))||e.push(n);return e}function keysIn(t){return isArrayLike(t)?arrayLikeKeys(t,!0):baseKeysIn(t)}var reIsDeepProp=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,reIsPlainProp=/^\w*$/;function isKey(t,r){if(isArray$2(t))return!1;var e=typeof t;return e=="number"||e=="symbol"||e=="boolean"||t==null||isSymbol(t)?!0:reIsPlainProp.test(t)||!reIsDeepProp.test(t)||r!=null&&t in Object(r)}var nativeCreate=getNative(Object,"create");const nativeCreate$1=nativeCreate;function hashClear(){this.__data__=nativeCreate$1?nativeCreate$1(null):{},this.size=0}function hashDelete(t){var r=this.has(t)&&delete this.__data__[t];return this.size-=r?1:0,r}var HASH_UNDEFINED$2="__lodash_hash_undefined__",objectProto$6=Object.prototype,hasOwnProperty$6=objectProto$6.hasOwnProperty;function hashGet(t){var r=this.__data__;if(nativeCreate$1){var e=r[t];return e===HASH_UNDEFINED$2?void 0:e}return hasOwnProperty$6.call(r,t)?r[t]:void 0}var objectProto$5=Object.prototype,hasOwnProperty$5=objectProto$5.hasOwnProperty;function hashHas(t){var r=this.__data__;return nativeCreate$1?r[t]!==void 0:hasOwnProperty$5.call(r,t)}var HASH_UNDEFINED$1="__lodash_hash_undefined__";function hashSet(t,r){var e=this.__data__;return this.size+=this.has(t)?0:1,e[t]=nativeCreate$1&&r===void 0?HASH_UNDEFINED$1:r,this}function Hash(t){var r=-1,e=t==null?0:t.length;for(this.clear();++r<e;){var n=t[r];this.set(n[0],n[1])}}Hash.prototype.clear=hashClear;Hash.prototype.delete=hashDelete;Hash.prototype.get=hashGet;Hash.prototype.has=hashHas;Hash.prototype.set=hashSet;function listCacheClear(){this.__data__=[],this.size=0}function assocIndexOf(t,r){for(var e=t.length;e--;)if(eq(t[e][0],r))return e;return-1}var arrayProto=Array.prototype,splice=arrayProto.splice;function listCacheDelete(t){var r=this.__data__,e=assocIndexOf(r,t);if(e<0)return!1;var n=r.length-1;return e==n?r.pop():splice.call(r,e,1),--this.size,!0}function listCacheGet(t){var r=this.__data__,e=assocIndexOf(r,t);return e<0?void 0:r[e][1]}function listCacheHas(t){return assocIndexOf(this.__data__,t)>-1}function listCacheSet(t,r){var e=this.__data__,n=assocIndexOf(e,t);return n<0?(++this.size,e.push([t,r])):e[n][1]=r,this}function ListCache(t){var r=-1,e=t==null?0:t.length;for(this.clear();++r<e;){var n=t[r];this.set(n[0],n[1])}}ListCache.prototype.clear=listCacheClear;ListCache.prototype.delete=listCacheDelete;ListCache.prototype.get=listCacheGet;ListCache.prototype.has=listCacheHas;ListCache.prototype.set=listCacheSet;var Map$1=getNative(root$1,"Map");const Map$2=Map$1;function mapCacheClear(){this.size=0,this.__data__={hash:new Hash,map:new(Map$2||ListCache),string:new Hash}}function isKeyable(t){var r=typeof t;return r=="string"||r=="number"||r=="symbol"||r=="boolean"?t!=="__proto__":t===null}function getMapData(t,r){var e=t.__data__;return isKeyable(r)?e[typeof r=="string"?"string":"hash"]:e.map}function mapCacheDelete(t){var r=getMapData(this,t).delete(t);return this.size-=r?1:0,r}function mapCacheGet(t){return getMapData(this,t).get(t)}function mapCacheHas(t){return getMapData(this,t).has(t)}function mapCacheSet(t,r){var e=getMapData(this,t),n=e.size;return e.set(t,r),this.size+=e.size==n?0:1,this}function MapCache(t){var r=-1,e=t==null?0:t.length;for(this.clear();++r<e;){var n=t[r];this.set(n[0],n[1])}}MapCache.prototype.clear=mapCacheClear;MapCache.prototype.delete=mapCacheDelete;MapCache.prototype.get=mapCacheGet;MapCache.prototype.has=mapCacheHas;MapCache.prototype.set=mapCacheSet;var FUNC_ERROR_TEXT$2="Expected a function";function memoize(t,r){if(typeof t!="function"||r!=null&&typeof r!="function")throw new TypeError(FUNC_ERROR_TEXT$2);var e=function(){var n=arguments,g=r?r.apply(this,n):n[0],y=e.cache;if(y.has(g))return y.get(g);var i=t.apply(this,n);return e.cache=y.set(g,i)||y,i};return e.cache=new(memoize.Cache||MapCache),e}memoize.Cache=MapCache;var MAX_MEMOIZE_SIZE=500;function memoizeCapped(t){var r=memoize(t,function(n){return e.size===MAX_MEMOIZE_SIZE&&e.clear(),n}),e=r.cache;return r}var rePropName=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,reEscapeChar=/\\(\\)?/g,stringToPath=memoizeCapped(function(t){var r=[];return t.charCodeAt(0)===46&&r.push(""),t.replace(rePropName,function(e,n,g,y){r.push(g?y.replace(reEscapeChar,"$1"):n||e)}),r});const stringToPath$1=stringToPath;function toString$1(t){return t==null?"":baseToString(t)}function castPath(t,r){return isArray$2(t)?t:isKey(t,r)?[t]:stringToPath$1(toString$1(t))}var INFINITY$1=1/0;function toKey(t){if(typeof t=="string"||isSymbol(t))return t;var r=t+"";return r=="0"&&1/t==-INFINITY$1?"-0":r}function baseGet(t,r){r=castPath(r,t);for(var e=0,n=r.length;t!=null&&e<n;)t=t[toKey(r[e++])];return e&&e==n?t:void 0}function get(t,r,e){var n=t==null?void 0:baseGet(t,r);return n===void 0?e:n}function arrayPush(t,r){for(var e=-1,n=r.length,g=t.length;++e<n;)t[g+e]=r[e];return t}var spreadableSymbol=Symbol$2?Symbol$2.isConcatSpreadable:void 0;function isFlattenable(t){return isArray$2(t)||isArguments$1(t)||!!(spreadableSymbol&&t&&t[spreadableSymbol])}function baseFlatten(t,r,e,n,g){var y=-1,i=t.length;for(e||(e=isFlattenable),g||(g=[]);++y<i;){var k=t[y];r>0&&e(k)?r>1?baseFlatten(k,r-1,e,n,g):arrayPush(g,k):n||(g[g.length]=k)}return g}function flatten(t){var r=t==null?0:t.length;return r?baseFlatten(t,1):[]}function flatRest(t){return setToString$1(overRest(t,void 0,flatten),t+"")}var getPrototype=overArg(Object.getPrototypeOf,Object);const getPrototype$1=getPrototype;var objectTag$3="[object Object]",funcProto=Function.prototype,objectProto$4=Object.prototype,funcToString=funcProto.toString,hasOwnProperty$4=objectProto$4.hasOwnProperty,objectCtorString=funcToString.call(Object);function isPlainObject$1(t){if(!isObjectLike(t)||baseGetTag(t)!=objectTag$3)return!1;var r=getPrototype$1(t);if(r===null)return!0;var e=hasOwnProperty$4.call(r,"constructor")&&r.constructor;return typeof e=="function"&&e instanceof e&&funcToString.call(e)==objectCtorString}function castArray$1(){if(!arguments.length)return[];var t=arguments[0];return isArray$2(t)?t:[t]}function stackClear(){this.__data__=new ListCache,this.size=0}function stackDelete(t){var r=this.__data__,e=r.delete(t);return this.size=r.size,e}function stackGet(t){return this.__data__.get(t)}function stackHas(t){return this.__data__.has(t)}var LARGE_ARRAY_SIZE=200;function stackSet(t,r){var e=this.__data__;if(e instanceof ListCache){var n=e.__data__;if(!Map$2||n.length<LARGE_ARRAY_SIZE-1)return n.push([t,r]),this.size=++e.size,this;e=this.__data__=new MapCache(n)}return e.set(t,r),this.size=e.size,this}function Stack(t){var r=this.__data__=new ListCache(t);this.size=r.size}Stack.prototype.clear=stackClear;Stack.prototype.delete=stackDelete;Stack.prototype.get=stackGet;Stack.prototype.has=stackHas;Stack.prototype.set=stackSet;function baseAssign(t,r){return t&&copyObject(r,keys(r),t)}function baseAssignIn(t,r){return t&&copyObject(r,keysIn(r),t)}var freeExports=typeof exports=="object"&&exports&&!exports.nodeType&&exports,freeModule=freeExports&&typeof module=="object"&&module&&!module.nodeType&&module,moduleExports=freeModule&&freeModule.exports===freeExports,Buffer$1=moduleExports?root$1.Buffer:void 0,allocUnsafe=Buffer$1?Buffer$1.allocUnsafe:void 0;function cloneBuffer(t,r){if(r)return t.slice();var e=t.length,n=allocUnsafe?allocUnsafe(e):new t.constructor(e);return t.copy(n),n}function arrayFilter(t,r){for(var e=-1,n=t==null?0:t.length,g=0,y=[];++e<n;){var i=t[e];r(i,e,t)&&(y[g++]=i)}return y}function stubArray(){return[]}var objectProto$3=Object.prototype,propertyIsEnumerable=objectProto$3.propertyIsEnumerable,nativeGetSymbols$1=Object.getOwnPropertySymbols,getSymbols=nativeGetSymbols$1?function(t){return t==null?[]:(t=Object(t),arrayFilter(nativeGetSymbols$1(t),function(r){return propertyIsEnumerable.call(t,r)}))}:stubArray;const getSymbols$1=getSymbols;function copySymbols(t,r){return copyObject(t,getSymbols$1(t),r)}var nativeGetSymbols=Object.getOwnPropertySymbols,getSymbolsIn=nativeGetSymbols?function(t){for(var r=[];t;)arrayPush(r,getSymbols$1(t)),t=getPrototype$1(t);return r}:stubArray;const getSymbolsIn$1=getSymbolsIn;function copySymbolsIn(t,r){return copyObject(t,getSymbolsIn$1(t),r)}function baseGetAllKeys(t,r,e){var n=r(t);return isArray$2(t)?n:arrayPush(n,e(t))}function getAllKeys(t){return baseGetAllKeys(t,keys,getSymbols$1)}function getAllKeysIn(t){return baseGetAllKeys(t,keysIn,getSymbolsIn$1)}var DataView=getNative(root$1,"DataView");const DataView$1=DataView;var Promise$1=getNative(root$1,"Promise");const Promise$2=Promise$1;var Set$1=getNative(root$1,"Set");const Set$2=Set$1;var mapTag$4="[object Map]",objectTag$2="[object Object]",promiseTag="[object Promise]",setTag$4="[object Set]",weakMapTag$1="[object WeakMap]",dataViewTag$3="[object DataView]",dataViewCtorString=toSource(DataView$1),mapCtorString=toSource(Map$2),promiseCtorString=toSource(Promise$2),setCtorString=toSource(Set$2),weakMapCtorString=toSource(WeakMap$2),getTag=baseGetTag;(DataView$1&&getTag(new DataView$1(new ArrayBuffer(1)))!=dataViewTag$3||Map$2&&getTag(new Map$2)!=mapTag$4||Promise$2&&getTag(Promise$2.resolve())!=promiseTag||Set$2&&getTag(new Set$2)!=setTag$4||WeakMap$2&&getTag(new WeakMap$2)!=weakMapTag$1)&&(getTag=function(t){var r=baseGetTag(t),e=r==objectTag$2?t.constructor:void 0,n=e?toSource(e):"";if(n)switch(n){case dataViewCtorString:return dataViewTag$3;case mapCtorString:return mapTag$4;case promiseCtorString:return promiseTag;case setCtorString:return setTag$4;case weakMapCtorString:return weakMapTag$1}return r});const getTag$1=getTag;var objectProto$2=Object.prototype,hasOwnProperty$3=objectProto$2.hasOwnProperty;function initCloneArray(t){var r=t.length,e=new t.constructor(r);return r&&typeof t[0]=="string"&&hasOwnProperty$3.call(t,"index")&&(e.index=t.index,e.input=t.input),e}var Uint8Array$1=root$1.Uint8Array;const Uint8Array$2=Uint8Array$1;function cloneArrayBuffer(t){var r=new t.constructor(t.byteLength);return new Uint8Array$2(r).set(new Uint8Array$2(t)),r}function cloneDataView(t,r){var e=r?cloneArrayBuffer(t.buffer):t.buffer;return new t.constructor(e,t.byteOffset,t.byteLength)}var reFlags=/\w*$/;function cloneRegExp(t){var r=new t.constructor(t.source,reFlags.exec(t));return r.lastIndex=t.lastIndex,r}var symbolProto$1=Symbol$2?Symbol$2.prototype:void 0,symbolValueOf$1=symbolProto$1?symbolProto$1.valueOf:void 0;function cloneSymbol(t){return symbolValueOf$1?Object(symbolValueOf$1.call(t)):{}}function cloneTypedArray(t,r){var e=r?cloneArrayBuffer(t.buffer):t.buffer;return new t.constructor(e,t.byteOffset,t.length)}var boolTag$2="[object Boolean]",dateTag$2="[object Date]",mapTag$3="[object Map]",numberTag$2="[object Number]",regexpTag$2="[object RegExp]",setTag$3="[object Set]",stringTag$2="[object String]",symbolTag$2="[object Symbol]",arrayBufferTag$2="[object ArrayBuffer]",dataViewTag$2="[object DataView]",float32Tag$1="[object Float32Array]",float64Tag$1="[object Float64Array]",int8Tag$1="[object Int8Array]",int16Tag$1="[object Int16Array]",int32Tag$1="[object Int32Array]",uint8Tag$1="[object Uint8Array]",uint8ClampedTag$1="[object Uint8ClampedArray]",uint16Tag$1="[object Uint16Array]",uint32Tag$1="[object Uint32Array]";function initCloneByTag(t,r,e){var n=t.constructor;switch(r){case arrayBufferTag$2:return cloneArrayBuffer(t);case boolTag$2:case dateTag$2:return new n(+t);case dataViewTag$2:return cloneDataView(t,e);case float32Tag$1:case float64Tag$1:case int8Tag$1:case int16Tag$1:case int32Tag$1:case uint8Tag$1:case uint8ClampedTag$1:case uint16Tag$1:case uint32Tag$1:return cloneTypedArray(t,e);case mapTag$3:return new n;case numberTag$2:case stringTag$2:return new n(t);case regexpTag$2:return cloneRegExp(t);case setTag$3:return new n;case symbolTag$2:return cloneSymbol(t)}}function initCloneObject(t){return typeof t.constructor=="function"&&!isPrototype(t)?baseCreate$1(getPrototype$1(t)):{}}var mapTag$2="[object Map]";function baseIsMap(t){return isObjectLike(t)&&getTag$1(t)==mapTag$2}var nodeIsMap=nodeUtil$1&&nodeUtil$1.isMap,isMap=nodeIsMap?baseUnary(nodeIsMap):baseIsMap;const isMap$1=isMap;var setTag$2="[object Set]";function baseIsSet(t){return isObjectLike(t)&&getTag$1(t)==setTag$2}var nodeIsSet=nodeUtil$1&&nodeUtil$1.isSet,isSet=nodeIsSet?baseUnary(nodeIsSet):baseIsSet;const isSet$1=isSet;var CLONE_DEEP_FLAG$1=1,CLONE_FLAT_FLAG=2,CLONE_SYMBOLS_FLAG$2=4,argsTag$1="[object Arguments]",arrayTag$1="[object Array]",boolTag$1="[object Boolean]",dateTag$1="[object Date]",errorTag$1="[object Error]",funcTag="[object Function]",genTag="[object GeneratorFunction]",mapTag$1="[object Map]",numberTag$1="[object Number]",objectTag$1="[object Object]",regexpTag$1="[object RegExp]",setTag$1="[object Set]",stringTag$1="[object String]",symbolTag$1="[object Symbol]",weakMapTag="[object WeakMap]",arrayBufferTag$1="[object ArrayBuffer]",dataViewTag$1="[object DataView]",float32Tag="[object Float32Array]",float64Tag="[object Float64Array]",int8Tag="[object Int8Array]",int16Tag="[object Int16Array]",int32Tag="[object Int32Array]",uint8Tag="[object Uint8Array]",uint8ClampedTag="[object Uint8ClampedArray]",uint16Tag="[object Uint16Array]",uint32Tag="[object Uint32Array]",cloneableTags={};cloneableTags[argsTag$1]=cloneableTags[arrayTag$1]=cloneableTags[arrayBufferTag$1]=cloneableTags[dataViewTag$1]=cloneableTags[boolTag$1]=cloneableTags[dateTag$1]=cloneableTags[float32Tag]=cloneableTags[float64Tag]=cloneableTags[int8Tag]=cloneableTags[int16Tag]=cloneableTags[int32Tag]=cloneableTags[mapTag$1]=cloneableTags[numberTag$1]=cloneableTags[objectTag$1]=cloneableTags[regexpTag$1]=cloneableTags[setTag$1]=cloneableTags[stringTag$1]=cloneableTags[symbolTag$1]=cloneableTags[uint8Tag]=cloneableTags[uint8ClampedTag]=cloneableTags[uint16Tag]=cloneableTags[uint32Tag]=!0;cloneableTags[errorTag$1]=cloneableTags[funcTag]=cloneableTags[weakMapTag]=!1;function baseClone(t,r,e,n,g,y){var i,k=r&CLONE_DEEP_FLAG$1,$=r&CLONE_FLAT_FLAG,L=r&CLONE_SYMBOLS_FLAG$2;if(e&&(i=g?e(t,n,g,y):e(t)),i!==void 0)return i;if(!isObject$1(t))return t;var V=isArray$2(t);if(V){if(i=initCloneArray(t),!k)return copyArray(t,i)}else{var z=getTag$1(t),re=z==funcTag||z==genTag;if(isBuffer$2(t))return cloneBuffer(t,k);if(z==objectTag$1||z==argsTag$1||re&&!g){if(i=$||re?{}:initCloneObject(t),!k)return $?copySymbolsIn(t,baseAssignIn(i,t)):copySymbols(t,baseAssign(i,t))}else{if(!cloneableTags[z])return g?t:{};i=initCloneByTag(t,z,k)}}y||(y=new Stack);var ie=y.get(t);if(ie)return ie;y.set(t,i),isSet$1(t)?t.forEach(function(oe){i.add(baseClone(oe,r,e,oe,t,y))}):isMap$1(t)&&t.forEach(function(oe,ae){i.set(ae,baseClone(oe,r,e,ae,t,y))});var ue=L?$?getAllKeysIn:getAllKeys:$?keysIn:keys,le=V?void 0:ue(t);return arrayEach(le||t,function(oe,ae){le&&(ae=oe,oe=t[ae]),assignValue(i,ae,baseClone(oe,r,e,ae,t,y))}),i}var CLONE_SYMBOLS_FLAG$1=4;function clone(t){return baseClone(t,CLONE_SYMBOLS_FLAG$1)}var CLONE_DEEP_FLAG=1,CLONE_SYMBOLS_FLAG=4;function cloneDeep(t){return baseClone(t,CLONE_DEEP_FLAG|CLONE_SYMBOLS_FLAG)}var HASH_UNDEFINED="__lodash_hash_undefined__";function setCacheAdd(t){return this.__data__.set(t,HASH_UNDEFINED),this}function setCacheHas(t){return this.__data__.has(t)}function SetCache(t){var r=-1,e=t==null?0:t.length;for(this.__data__=new MapCache;++r<e;)this.add(t[r])}SetCache.prototype.add=SetCache.prototype.push=setCacheAdd;SetCache.prototype.has=setCacheHas;function arraySome(t,r){for(var e=-1,n=t==null?0:t.length;++e<n;)if(r(t[e],e,t))return!0;return!1}function cacheHas(t,r){return t.has(r)}var COMPARE_PARTIAL_FLAG$5=1,COMPARE_UNORDERED_FLAG$3=2;function equalArrays(t,r,e,n,g,y){var i=e&COMPARE_PARTIAL_FLAG$5,k=t.length,$=r.length;if(k!=$&&!(i&&$>k))return!1;var L=y.get(t),V=y.get(r);if(L&&V)return L==r&&V==t;var z=-1,re=!0,ie=e&COMPARE_UNORDERED_FLAG$3?new SetCache:void 0;for(y.set(t,r),y.set(r,t);++z<k;){var ue=t[z],le=r[z];if(n)var oe=i?n(le,ue,z,r,t,y):n(ue,le,z,t,r,y);if(oe!==void 0){if(oe)continue;re=!1;break}if(ie){if(!arraySome(r,function(ae,qe){if(!cacheHas(ie,qe)&&(ue===ae||g(ue,ae,e,n,y)))return ie.push(qe)})){re=!1;break}}else if(!(ue===le||g(ue,le,e,n,y))){re=!1;break}}return y.delete(t),y.delete(r),re}function mapToArray(t){var r=-1,e=Array(t.size);return t.forEach(function(n,g){e[++r]=[g,n]}),e}function setToArray(t){var r=-1,e=Array(t.size);return t.forEach(function(n){e[++r]=n}),e}var COMPARE_PARTIAL_FLAG$4=1,COMPARE_UNORDERED_FLAG$2=2,boolTag="[object Boolean]",dateTag="[object Date]",errorTag="[object Error]",mapTag="[object Map]",numberTag="[object Number]",regexpTag="[object RegExp]",setTag="[object Set]",stringTag="[object String]",symbolTag="[object Symbol]",arrayBufferTag="[object ArrayBuffer]",dataViewTag="[object DataView]",symbolProto=Symbol$2?Symbol$2.prototype:void 0,symbolValueOf=symbolProto?symbolProto.valueOf:void 0;function equalByTag(t,r,e,n,g,y,i){switch(e){case dataViewTag:if(t.byteLength!=r.byteLength||t.byteOffset!=r.byteOffset)return!1;t=t.buffer,r=r.buffer;case arrayBufferTag:return!(t.byteLength!=r.byteLength||!y(new Uint8Array$2(t),new Uint8Array$2(r)));case boolTag:case dateTag:case numberTag:return eq(+t,+r);case errorTag:return t.name==r.name&&t.message==r.message;case regexpTag:case stringTag:return t==r+"";case mapTag:var k=mapToArray;case setTag:var $=n&COMPARE_PARTIAL_FLAG$4;if(k||(k=setToArray),t.size!=r.size&&!$)return!1;var L=i.get(t);if(L)return L==r;n|=COMPARE_UNORDERED_FLAG$2,i.set(t,r);var V=equalArrays(k(t),k(r),n,g,y,i);return i.delete(t),V;case symbolTag:if(symbolValueOf)return symbolValueOf.call(t)==symbolValueOf.call(r)}return!1}var COMPARE_PARTIAL_FLAG$3=1,objectProto$1=Object.prototype,hasOwnProperty$2=objectProto$1.hasOwnProperty;function equalObjects(t,r,e,n,g,y){var i=e&COMPARE_PARTIAL_FLAG$3,k=getAllKeys(t),$=k.length,L=getAllKeys(r),V=L.length;if($!=V&&!i)return!1;for(var z=$;z--;){var re=k[z];if(!(i?re in r:hasOwnProperty$2.call(r,re)))return!1}var ie=y.get(t),ue=y.get(r);if(ie&&ue)return ie==r&&ue==t;var le=!0;y.set(t,r),y.set(r,t);for(var oe=i;++z<$;){re=k[z];var ae=t[re],qe=r[re];if(n)var de=i?n(qe,ae,re,r,t,y):n(ae,qe,re,t,r,y);if(!(de===void 0?ae===qe||g(ae,qe,e,n,y):de)){le=!1;break}oe||(oe=re=="constructor")}if(le&&!oe){var Ne=t.constructor,ze=r.constructor;Ne!=ze&&"constructor"in t&&"constructor"in r&&!(typeof Ne=="function"&&Ne instanceof Ne&&typeof ze=="function"&&ze instanceof ze)&&(le=!1)}return y.delete(t),y.delete(r),le}var COMPARE_PARTIAL_FLAG$2=1,argsTag="[object Arguments]",arrayTag="[object Array]",objectTag="[object Object]",objectProto=Object.prototype,hasOwnProperty$1=objectProto.hasOwnProperty;function baseIsEqualDeep(t,r,e,n,g,y){var i=isArray$2(t),k=isArray$2(r),$=i?arrayTag:getTag$1(t),L=k?arrayTag:getTag$1(r);$=$==argsTag?objectTag:$,L=L==argsTag?objectTag:L;var V=$==objectTag,z=L==objectTag,re=$==L;if(re&&isBuffer$2(t)){if(!isBuffer$2(r))return!1;i=!0,V=!1}if(re&&!V)return y||(y=new Stack),i||isTypedArray$2(t)?equalArrays(t,r,e,n,g,y):equalByTag(t,r,$,e,n,g,y);if(!(e&COMPARE_PARTIAL_FLAG$2)){var ie=V&&hasOwnProperty$1.call(t,"__wrapped__"),ue=z&&hasOwnProperty$1.call(r,"__wrapped__");if(ie||ue){var le=ie?t.value():t,oe=ue?r.value():r;return y||(y=new Stack),g(le,oe,e,n,y)}}return re?(y||(y=new Stack),equalObjects(t,r,e,n,g,y)):!1}function baseIsEqual(t,r,e,n,g){return t===r?!0:t==null||r==null||!isObjectLike(t)&&!isObjectLike(r)?t!==t&&r!==r:baseIsEqualDeep(t,r,e,n,baseIsEqual,g)}var COMPARE_PARTIAL_FLAG$1=1,COMPARE_UNORDERED_FLAG$1=2;function baseIsMatch(t,r,e,n){var g=e.length,y=g,i=!n;if(t==null)return!y;for(t=Object(t);g--;){var k=e[g];if(i&&k[2]?k[1]!==t[k[0]]:!(k[0]in t))return!1}for(;++g<y;){k=e[g];var $=k[0],L=t[$],V=k[1];if(i&&k[2]){if(L===void 0&&!($ in t))return!1}else{var z=new Stack;if(n)var re=n(L,V,$,t,r,z);if(!(re===void 0?baseIsEqual(V,L,COMPARE_PARTIAL_FLAG$1|COMPARE_UNORDERED_FLAG$1,n,z):re))return!1}}return!0}function isStrictComparable(t){return t===t&&!isObject$1(t)}function getMatchData(t){for(var r=keys(t),e=r.length;e--;){var n=r[e],g=t[n];r[e]=[n,g,isStrictComparable(g)]}return r}function matchesStrictComparable(t,r){return function(e){return e==null?!1:e[t]===r&&(r!==void 0||t in Object(e))}}function baseMatches(t){var r=getMatchData(t);return r.length==1&&r[0][2]?matchesStrictComparable(r[0][0],r[0][1]):function(e){return e===t||baseIsMatch(e,t,r)}}function baseHasIn(t,r){return t!=null&&r in Object(t)}function hasPath(t,r,e){r=castPath(r,t);for(var n=-1,g=r.length,y=!1;++n<g;){var i=toKey(r[n]);if(!(y=t!=null&&e(t,i)))break;t=t[i]}return y||++n!=g?y:(g=t==null?0:t.length,!!g&&isLength(g)&&isIndex(i,g)&&(isArray$2(t)||isArguments$1(t)))}function hasIn(t,r){return t!=null&&hasPath(t,r,baseHasIn)}var COMPARE_PARTIAL_FLAG=1,COMPARE_UNORDERED_FLAG=2;function baseMatchesProperty(t,r){return isKey(t)&&isStrictComparable(r)?matchesStrictComparable(toKey(t),r):function(e){var n=get(e,t);return n===void 0&&n===r?hasIn(e,t):baseIsEqual(r,n,COMPARE_PARTIAL_FLAG|COMPARE_UNORDERED_FLAG)}}function baseProperty(t){return function(r){return r==null?void 0:r[t]}}function basePropertyDeep(t){return function(r){return baseGet(r,t)}}function property(t){return isKey(t)?baseProperty(toKey(t)):basePropertyDeep(t)}function baseIteratee(t){return typeof t=="function"?t:t==null?identity:typeof t=="object"?isArray$2(t)?baseMatchesProperty(t[0],t[1]):baseMatches(t):property(t)}function createBaseFor(t){return function(r,e,n){for(var g=-1,y=Object(r),i=n(r),k=i.length;k--;){var $=i[t?k:++g];if(e(y[$],$,y)===!1)break}return r}}var baseFor=createBaseFor();const baseFor$1=baseFor;function baseForOwn(t,r){return t&&baseFor$1(t,r,keys)}function createBaseEach(t,r){return function(e,n){if(e==null)return e;if(!isArrayLike(e))return t(e,n);for(var g=e.length,y=r?g:-1,i=Object(e);(r?y--:++y<g)&&n(i[y],y,i)!==!1;);return e}}var baseEach=createBaseEach(baseForOwn);const baseEach$1=baseEach;var now=function(){return root$1.Date.now()};const now$1=now;var FUNC_ERROR_TEXT$1="Expected a function",nativeMax=Math.max,nativeMin=Math.min;function debounce(t,r,e){var n,g,y,i,k,$,L=0,V=!1,z=!1,re=!0;if(typeof t!="function")throw new TypeError(FUNC_ERROR_TEXT$1);r=toNumber(r)||0,isObject$1(e)&&(V=!!e.leading,z="maxWait"in e,y=z?nativeMax(toNumber(e.maxWait)||0,r):y,re="trailing"in e?!!e.trailing:re);function ie($e){var Lt=n,jt=g;return n=g=void 0,L=$e,i=t.apply(jt,Lt),i}function ue($e){return L=$e,k=setTimeout(ae,r),V?ie($e):i}function le($e){var Lt=$e-$,jt=$e-L,Et=r-Lt;return z?nativeMin(Et,y-jt):Et}function oe($e){var Lt=$e-$,jt=$e-L;return $===void 0||Lt>=r||Lt<0||z&&jt>=y}function ae(){var $e=now$1();if(oe($e))return qe($e);k=setTimeout(ae,le($e))}function qe($e){return k=void 0,re&&n?ie($e):(n=g=void 0,i)}function de(){k!==void 0&&clearTimeout(k),L=0,n=$=g=k=void 0}function Ne(){return k===void 0?i:qe(now$1())}function ze(){var $e=now$1(),Lt=oe($e);if(n=arguments,g=this,$=$e,Lt){if(k===void 0)return ue($);if(z)return clearTimeout(k),k=setTimeout(ae,r),ie($)}return k===void 0&&(k=setTimeout(ae,r)),i}return ze.cancel=de,ze.flush=Ne,ze}function assignMergeValue(t,r,e){(e!==void 0&&!eq(t[r],e)||e===void 0&&!(r in t))&&baseAssignValue(t,r,e)}function isArrayLikeObject(t){return isObjectLike(t)&&isArrayLike(t)}function safeGet(t,r){if(!(r==="constructor"&&typeof t[r]=="function")&&r!="__proto__")return t[r]}function toPlainObject(t){return copyObject(t,keysIn(t))}function baseMergeDeep(t,r,e,n,g,y,i){var k=safeGet(t,e),$=safeGet(r,e),L=i.get($);if(L){assignMergeValue(t,e,L);return}var V=y?y(k,$,e+"",t,r,i):void 0,z=V===void 0;if(z){var re=isArray$2($),ie=!re&&isBuffer$2($),ue=!re&&!ie&&isTypedArray$2($);V=$,re||ie||ue?isArray$2(k)?V=k:isArrayLikeObject(k)?V=copyArray(k):ie?(z=!1,V=cloneBuffer($,!0)):ue?(z=!1,V=cloneTypedArray($,!0)):V=[]:isPlainObject$1($)||isArguments$1($)?(V=k,isArguments$1(k)?V=toPlainObject(k):(!isObject$1(k)||isFunction$1(k))&&(V=initCloneObject($))):z=!1}z&&(i.set($,V),g(V,$,n,y,i),i.delete($)),assignMergeValue(t,e,V)}function baseMerge(t,r,e,n,g){t!==r&&baseFor$1(r,function(y,i){if(g||(g=new Stack),isObject$1(y))baseMergeDeep(t,r,i,e,baseMerge,n,g);else{var k=n?n(safeGet(t,i),y,i+"",t,r,g):void 0;k===void 0&&(k=y),assignMergeValue(t,i,k)}},keysIn)}function baseMap(t,r){var e=-1,n=isArrayLike(t)?Array(t.length):[];return baseEach$1(t,function(g,y,i){n[++e]=r(g,y,i)}),n}function map(t,r){var e=isArray$2(t)?arrayMap:baseMap;return e(t,baseIteratee(r))}function flatMap(t,r){return baseFlatten(map(t,r),1)}var INFINITY=1/0;function flattenDeep(t){var r=t==null?0:t.length;return r?baseFlatten(t,INFINITY):[]}function fromPairs(t){for(var r=-1,e=t==null?0:t.length,n={};++r<e;){var g=t[r];n[g[0]]=g[1]}return n}function isEqual(t,r){return baseIsEqual(t,r)}function isNil(t){return t==null}function isUndefined$2(t){return t===void 0}var merge$1=createAssigner(function(t,r,e){baseMerge(t,r,e)});const merge$2=merge$1;function baseSet(t,r,e,n){if(!isObject$1(t))return t;r=castPath(r,t);for(var g=-1,y=r.length,i=y-1,k=t;k!=null&&++g<y;){var $=toKey(r[g]),L=e;if($==="__proto__"||$==="constructor"||$==="prototype")return t;if(g!=i){var V=k[$];L=n?n(V,$,k):void 0,L===void 0&&(L=isObject$1(V)?V:isIndex(r[g+1])?[]:{})}assignValue(k,$,L),k=k[$]}return t}function basePickBy(t,r,e){for(var n=-1,g=r.length,y={};++n<g;){var i=r[n],k=baseGet(t,i);e(k,i)&&baseSet(y,castPath(i,t),k)}return y}function basePick(t,r){return basePickBy(t,r,function(e,n){return hasIn(t,n)})}var pick=flatRest(function(t,r){return t==null?{}:basePick(t,r)});const pick$1=pick;function set(t,r,e){return t==null?t:baseSet(t,r,e)}var FUNC_ERROR_TEXT="Expected a function";function throttle(t,r,e){var n=!0,g=!0;if(typeof t!="function")throw new TypeError(FUNC_ERROR_TEXT);return isObject$1(e)&&(n="leading"in e?!!e.leading:n,g="trailing"in e?!!e.trailing:g),debounce(t,r,{leading:n,maxWait:r,trailing:g})}const isUndefined$1=t=>t===void 0,isBoolean$1=t=>typeof t=="boolean",isNumber$1=t=>typeof t=="number",isEmpty=t=>!t&&t!==0||isArray$3(t)&&t.length===0||isObject$2(t)&&!Object.keys(t).length,isElement=t=>typeof Element>"u"?!1:t instanceof Element,isStringNumber=t=>isString$2(t)?!Number.isNaN(Number(t)):!1,capitalize=t=>capitalize$1(t),keysOf=t=>Object.keys(t),entriesOf=t=>Object.entries(t),getProp=(t,r,e)=>({get value(){return get(t,r,e)},set value(n){set(t,r,n)}});class ElementPlusError extends Error{constructor(r){super(r),this.name="ElementPlusError"}}function throwError(t,r){throw new ElementPlusError(`[${t}] ${r}`)}function debugWarn(t,r){}const classNameToArray=(t="")=>t.split(" ").filter(r=>!!r.trim()),hasClass=(t,r)=>{if(!t||!r)return!1;if(r.includes(" "))throw new Error("className should not contain space.");return t.classList.contains(r)},addClass=(t,r)=>{!t||!r.trim()||t.classList.add(...classNameToArray(r))},removeClass=(t,r)=>{!t||!r.trim()||t.classList.remove(...classNameToArray(r))},getStyle=(t,r)=>{var e;if(!isClient||!t||!r)return"";let n=camelize(r);n==="float"&&(n="cssFloat");try{const g=t.style[n];if(g)return g;const y=(e=document.defaultView)==null?void 0:e.getComputedStyle(t,"");return y?y[n]:""}catch{return t.style[n]}};function addUnit(t,r="px"){if(!t)return"";if(isNumber$1(t)||isStringNumber(t))return`${t}${r}`;if(isString$2(t))return t}const isScroll=(t,r)=>{if(!isClient)return!1;const e={undefined:"overflow",true:"overflow-y",false:"overflow-x"}[String(r)],n=getStyle(t,e);return["scroll","auto","overlay"].some(g=>n.includes(g))},getScrollContainer=(t,r)=>{if(!isClient)return;let e=t;for(;e;){if([window,document,document.documentElement].includes(e))return window;if(isScroll(e,r))return e;e=e.parentNode}return e};let scrollBarWidth;const getScrollBarWidth=t=>{var r;if(!isClient)return 0;if(scrollBarWidth!==void 0)return scrollBarWidth;const e=document.createElement("div");e.className=`${t}-scrollbar__wrap`,e.style.visibility="hidden",e.style.width="100px",e.style.position="absolute",e.style.top="-9999px",document.body.appendChild(e);const n=e.offsetWidth;e.style.overflow="scroll";const g=document.createElement("div");g.style.width="100%",e.appendChild(g);const y=g.offsetWidth;return(r=e.parentNode)==null||r.removeChild(e),scrollBarWidth=n-y,scrollBarWidth};function scrollIntoView(t,r){if(!isClient)return;if(!r){t.scrollTop=0;return}const e=[];let n=r.offsetParent;for(;n!==null&&t!==n&&t.contains(n);)e.push(n),n=n.offsetParent;const g=r.offsetTop+e.reduce(($,L)=>$+L.offsetTop,0),y=g+r.offsetHeight,i=t.scrollTop,k=i+t.clientHeight;g<i?t.scrollTop=g:y>k&&(t.scrollTop=y-t.clientHeight)}/*! Element Plus Icons Vue v2.3.1 */var arrow_down_vue_vue_type_script_setup_true_lang_default=defineComponent({name:"ArrowDown",__name:"arrow-down",setup(t){return(r,e)=>(openBlock(),createElementBlock("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[createBaseVNode("path",{fill:"currentColor",d:"M831.872 340.864 512 652.672 192.128 340.864a30.592 30.592 0 0 0-42.752 0 29.12 29.12 0 0 0 0 41.6L489.664 714.24a32 32 0 0 0 44.672 0l340.288-331.712a29.12 29.12 0 0 0 0-41.728 30.592 30.592 0 0 0-42.752 0z"})]))}}),arrow_down_default=arrow_down_vue_vue_type_script_setup_true_lang_default,arrow_left_vue_vue_type_script_setup_true_lang_default=defineComponent({name:"ArrowLeft",__name:"arrow-left",setup(t){return(r,e)=>(openBlock(),createElementBlock("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[createBaseVNode("path",{fill:"currentColor",d:"M609.408 149.376 277.76 489.6a32 32 0 0 0 0 44.672l331.648 340.352a29.12 29.12 0 0 0 41.728 0 30.592 30.592 0 0 0 0-42.752L339.264 511.936l311.872-319.872a30.592 30.592 0 0 0 0-42.688 29.12 29.12 0 0 0-41.728 0z"})]))}}),arrow_left_default=arrow_left_vue_vue_type_script_setup_true_lang_default,arrow_right_vue_vue_type_script_setup_true_lang_default=defineComponent({name:"ArrowRight",__name:"arrow-right",setup(t){return(r,e)=>(openBlock(),createElementBlock("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[createBaseVNode("path",{fill:"currentColor",d:"M340.864 149.312a30.592 30.592 0 0 0 0 42.752L652.736 512 340.864 831.872a30.592 30.592 0 0 0 0 42.752 29.12 29.12 0 0 0 41.728 0L714.24 534.336a32 32 0 0 0 0-44.672L382.592 149.376a29.12 29.12 0 0 0-41.728 0z"})]))}}),arrow_right_default=arrow_right_vue_vue_type_script_setup_true_lang_default,arrow_up_vue_vue_type_script_setup_true_lang_default=defineComponent({name:"ArrowUp",__name:"arrow-up",setup(t){return(r,e)=>(openBlock(),createElementBlock("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[createBaseVNode("path",{fill:"currentColor",d:"m488.832 344.32-339.84 356.672a32 32 0 0 0 0 44.16l.384.384a29.44 29.44 0 0 0 42.688 0l320-335.872 319.872 335.872a29.44 29.44 0 0 0 42.688 0l.384-.384a32 32 0 0 0 0-44.16L535.168 344.32a32 32 0 0 0-46.336 0"})]))}}),arrow_up_default=arrow_up_vue_vue_type_script_setup_true_lang_default,check_vue_vue_type_script_setup_true_lang_default=defineComponent({name:"Check",__name:"check",setup(t){return(r,e)=>(openBlock(),createElementBlock("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[createBaseVNode("path",{fill:"currentColor",d:"M406.656 706.944 195.84 496.256a32 32 0 1 0-45.248 45.248l256 256 512-512a32 32 0 0 0-45.248-45.248L406.592 706.944z"})]))}}),check_default=check_vue_vue_type_script_setup_true_lang_default,circle_check_vue_vue_type_script_setup_true_lang_default=defineComponent({name:"CircleCheck",__name:"circle-check",setup(t){return(r,e)=>(openBlock(),createElementBlock("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[createBaseVNode("path",{fill:"currentColor",d:"M512 896a384 384 0 1 0 0-768 384 384 0 0 0 0 768m0 64a448 448 0 1 1 0-896 448 448 0 0 1 0 896"}),createBaseVNode("path",{fill:"currentColor",d:"M745.344 361.344a32 32 0 0 1 45.312 45.312l-288 288a32 32 0 0 1-45.312 0l-160-160a32 32 0 1 1 45.312-45.312L480 626.752l265.344-265.408z"})]))}}),circle_check_default=circle_check_vue_vue_type_script_setup_true_lang_default,circle_close_filled_vue_vue_type_script_setup_true_lang_default=defineComponent({name:"CircleCloseFilled",__name:"circle-close-filled",setup(t){return(r,e)=>(openBlock(),createElementBlock("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[createBaseVNode("path",{fill:"currentColor",d:"M512 64a448 448 0 1 1 0 896 448 448 0 0 1 0-896m0 393.664L407.936 353.6a38.4 38.4 0 1 0-54.336 54.336L457.664 512 353.6 616.064a38.4 38.4 0 1 0 54.336 54.336L512 566.336 616.064 670.4a38.4 38.4 0 1 0 54.336-54.336L566.336 512 670.4 407.936a38.4 38.4 0 1 0-54.336-54.336z"})]))}}),circle_close_filled_default=circle_close_filled_vue_vue_type_script_setup_true_lang_default,circle_close_vue_vue_type_script_setup_true_lang_default=defineComponent({name:"CircleClose",__name:"circle-close",setup(t){return(r,e)=>(openBlock(),createElementBlock("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[createBaseVNode("path",{fill:"currentColor",d:"m466.752 512-90.496-90.496a32 32 0 0 1 45.248-45.248L512 466.752l90.496-90.496a32 32 0 1 1 45.248 45.248L557.248 512l90.496 90.496a32 32 0 1 1-45.248 45.248L512 557.248l-90.496 90.496a32 32 0 0 1-45.248-45.248z"}),createBaseVNode("path",{fill:"currentColor",d:"M512 896a384 384 0 1 0 0-768 384 384 0 0 0 0 768m0 64a448 448 0 1 1 0-896 448 448 0 0 1 0 896"})]))}}),circle_close_default=circle_close_vue_vue_type_script_setup_true_lang_default,close_vue_vue_type_script_setup_true_lang_default=defineComponent({name:"Close",__name:"close",setup(t){return(r,e)=>(openBlock(),createElementBlock("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[createBaseVNode("path",{fill:"currentColor",d:"M764.288 214.592 512 466.88 259.712 214.592a31.936 31.936 0 0 0-45.12 45.12L466.752 512 214.528 764.224a31.936 31.936 0 1 0 45.12 45.184L512 557.184l252.288 252.288a31.936 31.936 0 0 0 45.12-45.12L557.12 512.064l252.288-252.352a31.936 31.936 0 1 0-45.12-45.184z"})]))}}),close_default=close_vue_vue_type_script_setup_true_lang_default,cpu_vue_vue_type_script_setup_true_lang_default=defineComponent({name:"Cpu",__name:"cpu",setup(t){return(r,e)=>(openBlock(),createElementBlock("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[createBaseVNode("path",{fill:"currentColor",d:"M320 256a64 64 0 0 0-64 64v384a64 64 0 0 0 64 64h384a64 64 0 0 0 64-64V320a64 64 0 0 0-64-64zm0-64h384a128 128 0 0 1 128 128v384a128 128 0 0 1-128 128H320a128 128 0 0 1-128-128V320a128 128 0 0 1 128-128"}),createBaseVNode("path",{fill:"currentColor",d:"M512 64a32 32 0 0 1 32 32v128h-64V96a32 32 0 0 1 32-32m160 0a32 32 0 0 1 32 32v128h-64V96a32 32 0 0 1 32-32m-320 0a32 32 0 0 1 32 32v128h-64V96a32 32 0 0 1 32-32m160 896a32 32 0 0 1-32-32V800h64v128a32 32 0 0 1-32 32m160 0a32 32 0 0 1-32-32V800h64v128a32 32 0 0 1-32 32m-320 0a32 32 0 0 1-32-32V800h64v128a32 32 0 0 1-32 32M64 512a32 32 0 0 1 32-32h128v64H96a32 32 0 0 1-32-32m0-160a32 32 0 0 1 32-32h128v64H96a32 32 0 0 1-32-32m0 320a32 32 0 0 1 32-32h128v64H96a32 32 0 0 1-32-32m896-160a32 32 0 0 1-32 32H800v-64h128a32 32 0 0 1 32 32m0-160a32 32 0 0 1-32 32H800v-64h128a32 32 0 0 1 32 32m0 320a32 32 0 0 1-32 32H800v-64h128a32 32 0 0 1 32 32"})]))}}),cpu_default=cpu_vue_vue_type_script_setup_true_lang_default,delete_vue_vue_type_script_setup_true_lang_default=defineComponent({name:"Delete",__name:"delete",setup(t){return(r,e)=>(openBlock(),createElementBlock("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[createBaseVNode("path",{fill:"currentColor",d:"M160 256H96a32 32 0 0 1 0-64h256V95.936a32 32 0 0 1 32-32h256a32 32 0 0 1 32 32V192h256a32 32 0 1 1 0 64h-64v672a32 32 0 0 1-32 32H192a32 32 0 0 1-32-32zm448-64v-64H416v64zM224 896h576V256H224zm192-128a32 32 0 0 1-32-32V416a32 32 0 0 1 64 0v320a32 32 0 0 1-32 32m192 0a32 32 0 0 1-32-32V416a32 32 0 0 1 64 0v320a32 32 0 0 1-32 32"})]))}}),delete_default=delete_vue_vue_type_script_setup_true_lang_default,document_vue_vue_type_script_setup_true_lang_default=defineComponent({name:"Document",__name:"document",setup(t){return(r,e)=>(openBlock(),createElementBlock("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[createBaseVNode("path",{fill:"currentColor",d:"M832 384H576V128H192v768h640zm-26.496-64L640 154.496V320zM160 64h480l256 256v608a32 32 0 0 1-32 32H160a32 32 0 0 1-32-32V96a32 32 0 0 1 32-32m160 448h384v64H320zm0-192h160v64H320zm0 384h384v64H320z"})]))}}),document_default=document_vue_vue_type_script_setup_true_lang_default,edit_vue_vue_type_script_setup_true_lang_default=defineComponent({name:"Edit",__name:"edit",setup(t){return(r,e)=>(openBlock(),createElementBlock("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[createBaseVNode("path",{fill:"currentColor",d:"M832 512a32 32 0 1 1 64 0v352a32 32 0 0 1-32 32H160a32 32 0 0 1-32-32V160a32 32 0 0 1 32-32h352a32 32 0 0 1 0 64H192v640h640z"}),createBaseVNode("path",{fill:"currentColor",d:"m469.952 554.24 52.8-7.552L847.104 222.4a32 32 0 1 0-45.248-45.248L477.44 501.44l-7.552 52.8zm422.4-422.4a96 96 0 0 1 0 135.808l-331.84 331.84a32 32 0 0 1-18.112 9.088L436.8 623.68a32 32 0 0 1-36.224-36.224l15.104-105.6a32 32 0 0 1 9.024-18.112l331.904-331.84a96 96 0 0 1 135.744 0z"})]))}}),edit_default=edit_vue_vue_type_script_setup_true_lang_default,full_screen_vue_vue_type_script_setup_true_lang_default=defineComponent({name:"FullScreen",__name:"full-screen",setup(t){return(r,e)=>(openBlock(),createElementBlock("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[createBaseVNode("path",{fill:"currentColor",d:"m160 96.064 192 .192a32 32 0 0 1 0 64l-192-.192V352a32 32 0 0 1-64 0V96h64zm0 831.872V928H96V672a32 32 0 1 1 64 0v191.936l192-.192a32 32 0 1 1 0 64zM864 96.064V96h64v256a32 32 0 1 1-64 0V160.064l-192 .192a32 32 0 1 1 0-64l192-.192zm0 831.872-192-.192a32 32 0 0 1 0-64l192 .192V672a32 32 0 1 1 64 0v256h-64z"})]))}}),full_screen_default=full_screen_vue_vue_type_script_setup_true_lang_default,hide_vue_vue_type_script_setup_true_lang_default=defineComponent({name:"Hide",__name:"hide",setup(t){return(r,e)=>(openBlock(),createElementBlock("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[createBaseVNode("path",{fill:"currentColor",d:"M876.8 156.8c0-9.6-3.2-16-9.6-22.4-6.4-6.4-12.8-9.6-22.4-9.6-9.6 0-16 3.2-22.4 9.6L736 220.8c-64-32-137.6-51.2-224-60.8-160 16-288 73.6-377.6 176C44.8 438.4 0 496 0 512s48 73.6 134.4 176c22.4 25.6 44.8 48 73.6 67.2l-86.4 89.6c-6.4 6.4-9.6 12.8-9.6 22.4 0 9.6 3.2 16 9.6 22.4 6.4 6.4 12.8 9.6 22.4 9.6 9.6 0 16-3.2 22.4-9.6l704-710.4c3.2-6.4 6.4-12.8 6.4-22.4Zm-646.4 528c-76.8-70.4-128-128-153.6-172.8 28.8-48 80-105.6 153.6-172.8C304 272 400 230.4 512 224c64 3.2 124.8 19.2 176 44.8l-54.4 54.4C598.4 300.8 560 288 512 288c-64 0-115.2 22.4-160 64s-64 96-64 160c0 48 12.8 89.6 35.2 124.8L256 707.2c-9.6-6.4-19.2-16-25.6-22.4Zm140.8-96c-12.8-22.4-19.2-48-19.2-76.8 0-44.8 16-83.2 48-112 32-28.8 67.2-48 112-48 28.8 0 54.4 6.4 73.6 19.2zM889.599 336c-12.8-16-28.8-28.8-41.6-41.6l-48 48c73.6 67.2 124.8 124.8 150.4 169.6-28.8 48-80 105.6-153.6 172.8-73.6 67.2-172.8 108.8-284.8 115.2-51.2-3.2-99.2-12.8-140.8-28.8l-48 48c57.6 22.4 118.4 38.4 188.8 44.8 160-16 288-73.6 377.6-176C979.199 585.6 1024 528 1024 512s-48.001-73.6-134.401-176Z"}),createBaseVNode("path",{fill:"currentColor",d:"M511.998 672c-12.8 0-25.6-3.2-38.4-6.4l-51.2 51.2c28.8 12.8 57.6 19.2 89.6 19.2 64 0 115.2-22.4 160-64 41.6-41.6 64-96 64-160 0-32-6.4-64-19.2-89.6l-51.2 51.2c3.2 12.8 6.4 25.6 6.4 38.4 0 44.8-16 83.2-48 112-32 28.8-67.2 48-112 48Z"})]))}}),hide_default=hide_vue_vue_type_script_setup_true_lang_default,house_vue_vue_type_script_setup_true_lang_default=defineComponent({name:"House",__name:"house",setup(t){return(r,e)=>(openBlock(),createElementBlock("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[createBaseVNode("path",{fill:"currentColor",d:"M192 413.952V896h640V413.952L512 147.328zM139.52 374.4l352-293.312a32 32 0 0 1 40.96 0l352 293.312A32 32 0 0 1 896 398.976V928a32 32 0 0 1-32 32H160a32 32 0 0 1-32-32V398.976a32 32 0 0 1 11.52-24.576"})]))}}),house_default=house_vue_vue_type_script_setup_true_lang_default,info_filled_vue_vue_type_script_setup_true_lang_default=defineComponent({name:"InfoFilled",__name:"info-filled",setup(t){return(r,e)=>(openBlock(),createElementBlock("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[createBaseVNode("path",{fill:"currentColor",d:"M512 64a448 448 0 1 1 0 896.064A448 448 0 0 1 512 64m67.2 275.072c33.28 0 60.288-23.104 60.288-57.344s-27.072-57.344-60.288-57.344c-33.28 0-60.16 23.104-60.16 57.344s26.88 57.344 60.16 57.344M590.912 699.2c0-6.848 2.368-24.64 1.024-34.752l-52.608 60.544c-10.88 11.456-24.512 19.392-30.912 17.28a12.992 12.992 0 0 1-8.256-14.72l87.68-276.992c7.168-35.136-12.544-67.2-54.336-71.296-44.096 0-108.992 44.736-148.48 101.504 0 6.784-1.28 23.68.064 33.792l52.544-60.608c10.88-11.328 23.552-19.328 29.952-17.152a12.8 12.8 0 0 1 7.808 16.128L388.48 728.576c-10.048 32.256 8.96 63.872 55.04 71.04 67.84 0 107.904-43.648 147.456-100.416z"})]))}}),info_filled_default=info_filled_vue_vue_type_script_setup_true_lang_default,loading_vue_vue_type_script_setup_true_lang_default=defineComponent({name:"Loading",__name:"loading",setup(t){return(r,e)=>(openBlock(),createElementBlock("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[createBaseVNode("path",{fill:"currentColor",d:"M512 64a32 32 0 0 1 32 32v192a32 32 0 0 1-64 0V96a32 32 0 0 1 32-32m0 640a32 32 0 0 1 32 32v192a32 32 0 1 1-64 0V736a32 32 0 0 1 32-32m448-192a32 32 0 0 1-32 32H736a32 32 0 1 1 0-64h192a32 32 0 0 1 32 32m-640 0a32 32 0 0 1-32 32H96a32 32 0 0 1 0-64h192a32 32 0 0 1 32 32M195.2 195.2a32 32 0 0 1 45.248 0L376.32 331.008a32 32 0 0 1-45.248 45.248L195.2 240.448a32 32 0 0 1 0-45.248zm452.544 452.544a32 32 0 0 1 45.248 0L828.8 783.552a32 32 0 0 1-45.248 45.248L647.744 692.992a32 32 0 0 1 0-45.248zM828.8 195.264a32 32 0 0 1 0 45.184L692.992 376.32a32 32 0 0 1-45.248-45.248l135.808-135.808a32 32 0 0 1 45.248 0m-452.544 452.48a32 32 0 0 1 0 45.248L240.448 828.8a32 32 0 0 1-45.248-45.248l135.808-135.808a32 32 0 0 1 45.248 0z"})]))}}),loading_default=loading_vue_vue_type_script_setup_true_lang_default,minus_vue_vue_type_script_setup_true_lang_default=defineComponent({name:"Minus",__name:"minus",setup(t){return(r,e)=>(openBlock(),createElementBlock("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[createBaseVNode("path",{fill:"currentColor",d:"M128 544h768a32 32 0 1 0 0-64H128a32 32 0 0 0 0 64"})]))}}),minus_default=minus_vue_vue_type_script_setup_true_lang_default,more_vue_vue_type_script_setup_true_lang_default=defineComponent({name:"More",__name:"more",setup(t){return(r,e)=>(openBlock(),createElementBlock("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[createBaseVNode("path",{fill:"currentColor",d:"M176 416a112 112 0 1 0 0 224 112 112 0 0 0 0-224m0 64a48 48 0 1 1 0 96 48 48 0 0 1 0-96m336-64a112 112 0 1 1 0 224 112 112 0 0 1 0-224m0 64a48 48 0 1 0 0 96 48 48 0 0 0 0-96m336-64a112 112 0 1 1 0 224 112 112 0 0 1 0-224m0 64a48 48 0 1 0 0 96 48 48 0 0 0 0-96"})]))}}),more_default=more_vue_vue_type_script_setup_true_lang_default,picture_vue_vue_type_script_setup_true_lang_default=defineComponent({name:"Picture",__name:"picture",setup(t){return(r,e)=>(openBlock(),createElementBlock("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[createBaseVNode("path",{fill:"currentColor",d:"M160 160v704h704V160zm-32-64h768a32 32 0 0 1 32 32v768a32 32 0 0 1-32 32H128a32 32 0 0 1-32-32V128a32 32 0 0 1 32-32"}),createBaseVNode("path",{fill:"currentColor",d:"M384 288q64 0 64 64t-64 64q-64 0-64-64t64-64M185.408 876.992l-50.816-38.912L350.72 556.032a96 96 0 0 1 134.592-17.856l1.856 1.472 122.88 99.136a32 32 0 0 0 44.992-4.864l216-269.888 49.92 39.936-215.808 269.824-.256.32a96 96 0 0 1-135.04 14.464l-122.88-99.072-.64-.512a32 32 0 0 0-44.8 5.952z"})]))}}),picture_default=picture_vue_vue_type_script_setup_true_lang_default,plus_vue_vue_type_script_setup_true_lang_default=defineComponent({name:"Plus",__name:"plus",setup(t){return(r,e)=>(openBlock(),createElementBlock("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[createBaseVNode("path",{fill:"currentColor",d:"M480 480V128a32 32 0 0 1 64 0v352h352a32 32 0 1 1 0 64H544v352a32 32 0 1 1-64 0V544H128a32 32 0 0 1 0-64z"})]))}}),plus_default=plus_vue_vue_type_script_setup_true_lang_default,refresh_left_vue_vue_type_script_setup_true_lang_default=defineComponent({name:"RefreshLeft",__name:"refresh-left",setup(t){return(r,e)=>(openBlock(),createElementBlock("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[createBaseVNode("path",{fill:"currentColor",d:"M289.088 296.704h92.992a32 32 0 0 1 0 64H232.96a32 32 0 0 1-32-32V179.712a32 32 0 0 1 64 0v50.56a384 384 0 0 1 643.84 282.88 384 384 0 0 1-383.936 384 384 384 0 0 1-384-384h64a320 320 0 1 0 640 0 320 320 0 0 0-555.712-216.448z"})]))}}),refresh_left_default=refresh_left_vue_vue_type_script_setup_true_lang_default,refresh_right_vue_vue_type_script_setup_true_lang_default=defineComponent({name:"RefreshRight",__name:"refresh-right",setup(t){return(r,e)=>(openBlock(),createElementBlock("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[createBaseVNode("path",{fill:"currentColor",d:"M784.512 230.272v-50.56a32 32 0 1 1 64 0v149.056a32 32 0 0 1-32 32H667.52a32 32 0 1 1 0-64h92.992A320 320 0 1 0 524.8 833.152a320 320 0 0 0 320-320h64a384 384 0 0 1-384 384 384 384 0 0 1-384-384 384 384 0 0 1 643.712-282.88z"})]))}}),refresh_right_default=refresh_right_vue_vue_type_script_setup_true_lang_default,refresh_vue_vue_type_script_setup_true_lang_default=defineComponent({name:"Refresh",__name:"refresh",setup(t){return(r,e)=>(openBlock(),createElementBlock("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[createBaseVNode("path",{fill:"currentColor",d:"M771.776 794.88A384 384 0 0 1 128 512h64a320 320 0 0 0 555.712 216.448H654.72a32 32 0 1 1 0-64h149.056a32 32 0 0 1 32 32v148.928a32 32 0 1 1-64 0v-50.56zM276.288 295.616h92.992a32 32 0 0 1 0 64H220.16a32 32 0 0 1-32-32V178.56a32 32 0 0 1 64 0v50.56A384 384 0 0 1 896.128 512h-64a320 320 0 0 0-555.776-216.384z"})]))}}),refresh_default=refresh_vue_vue_type_script_setup_true_lang_default,scale_to_original_vue_vue_type_script_setup_true_lang_default=defineComponent({name:"ScaleToOriginal",__name:"scale-to-original",setup(t){return(r,e)=>(openBlock(),createElementBlock("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[createBaseVNode("path",{fill:"currentColor",d:"M813.176 180.706a60.235 60.235 0 0 1 60.236 60.235v481.883a60.235 60.235 0 0 1-60.236 60.235H210.824a60.235 60.235 0 0 1-60.236-60.235V240.94a60.235 60.235 0 0 1 60.236-60.235h602.352zm0-60.235H210.824A120.47 120.47 0 0 0 90.353 240.94v481.883a120.47 120.47 0 0 0 120.47 120.47h602.353a120.47 120.47 0 0 0 120.471-120.47V240.94a120.47 120.47 0 0 0-120.47-120.47zm-120.47 180.705a30.118 30.118 0 0 0-30.118 30.118v301.177a30.118 30.118 0 0 0 60.236 0V331.294a30.118 30.118 0 0 0-30.118-30.118zm-361.412 0a30.118 30.118 0 0 0-30.118 30.118v301.177a30.118 30.118 0 1 0 60.236 0V331.294a30.118 30.118 0 0 0-30.118-30.118M512 361.412a30.118 30.118 0 0 0-30.118 30.117v30.118a30.118 30.118 0 0 0 60.236 0V391.53A30.118 30.118 0 0 0 512 361.412M512 512a30.118 30.118 0 0 0-30.118 30.118v30.117a30.118 30.118 0 0 0 60.236 0v-30.117A30.118 30.118 0 0 0 512 512"})]))}}),scale_to_original_default=scale_to_original_vue_vue_type_script_setup_true_lang_default,set_up_vue_vue_type_script_setup_true_lang_default=defineComponent({name:"SetUp",__name:"set-up",setup(t){return(r,e)=>(openBlock(),createElementBlock("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[createBaseVNode("path",{fill:"currentColor",d:"M224 160a64 64 0 0 0-64 64v576a64 64 0 0 0 64 64h576a64 64 0 0 0 64-64V224a64 64 0 0 0-64-64zm0-64h576a128 128 0 0 1 128 128v576a128 128 0 0 1-128 128H224A128 128 0 0 1 96 800V224A128 128 0 0 1 224 96"}),createBaseVNode("path",{fill:"currentColor",d:"M384 416a64 64 0 1 0 0-128 64 64 0 0 0 0 128m0 64a128 128 0 1 1 0-256 128 128 0 0 1 0 256"}),createBaseVNode("path",{fill:"currentColor",d:"M480 320h256q32 0 32 32t-32 32H480q-32 0-32-32t32-32m160 416a64 64 0 1 0 0-128 64 64 0 0 0 0 128m0 64a128 128 0 1 1 0-256 128 128 0 0 1 0 256"}),createBaseVNode("path",{fill:"currentColor",d:"M288 640h256q32 0 32 32t-32 32H288q-32 0-32-32t32-32"})]))}}),set_up_default=set_up_vue_vue_type_script_setup_true_lang_default,setting_vue_vue_type_script_setup_true_lang_default=defineComponent({name:"Setting",__name:"setting",setup(t){return(r,e)=>(openBlock(),createElementBlock("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[createBaseVNode("path",{fill:"currentColor",d:"M600.704 64a32 32 0 0 1 30.464 22.208l35.2 109.376c14.784 7.232 28.928 15.36 42.432 24.512l112.384-24.192a32 32 0 0 1 34.432 15.36L944.32 364.8a32 32 0 0 1-4.032 37.504l-77.12 85.12a357.12 357.12 0 0 1 0 49.024l77.12 85.248a32 32 0 0 1 4.032 37.504l-88.704 153.6a32 32 0 0 1-34.432 15.296L708.8 803.904c-13.44 9.088-27.648 17.28-42.368 24.512l-35.264 109.376A32 32 0 0 1 600.704 960H423.296a32 32 0 0 1-30.464-22.208L357.696 828.48a351.616 351.616 0 0 1-42.56-24.64l-112.32 24.256a32 32 0 0 1-34.432-15.36L79.68 659.2a32 32 0 0 1 4.032-37.504l77.12-85.248a357.12 357.12 0 0 1 0-48.896l-77.12-85.248A32 32 0 0 1 79.68 364.8l88.704-153.6a32 32 0 0 1 34.432-15.296l112.32 24.256c13.568-9.152 27.776-17.408 42.56-24.64l35.2-109.312A32 32 0 0 1 423.232 64H600.64zm-23.424 64H446.72l-36.352 113.088-24.512 11.968a294.113 294.113 0 0 0-34.816 20.096l-22.656 15.36-116.224-25.088-65.28 113.152 79.68 88.192-1.92 27.136a293.12 293.12 0 0 0 0 40.192l1.92 27.136-79.808 88.192 65.344 113.152 116.224-25.024 22.656 15.296a294.113 294.113 0 0 0 34.816 20.096l24.512 11.968L446.72 896h130.688l36.48-113.152 24.448-11.904a288.282 288.282 0 0 0 34.752-20.096l22.592-15.296 116.288 25.024 65.28-113.152-79.744-88.192 1.92-27.136a293.12 293.12 0 0 0 0-40.256l-1.92-27.136 79.808-88.128-65.344-113.152-116.288 24.96-22.592-15.232a287.616 287.616 0 0 0-34.752-20.096l-24.448-11.904L577.344 128zM512 320a192 192 0 1 1 0 384 192 192 0 0 1 0-384m0 64a128 128 0 1 0 0 256 128 128 0 0 0 0-256"})]))}}),setting_default=setting_vue_vue_type_script_setup_true_lang_default,success_filled_vue_vue_type_script_setup_true_lang_default=defineComponent({name:"SuccessFilled",__name:"success-filled",setup(t){return(r,e)=>(openBlock(),createElementBlock("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[createBaseVNode("path",{fill:"currentColor",d:"M512 64a448 448 0 1 1 0 896 448 448 0 0 1 0-896m-55.808 536.384-99.52-99.584a38.4 38.4 0 1 0-54.336 54.336l126.72 126.72a38.272 38.272 0 0 0 54.336 0l262.4-262.464a38.4 38.4 0 1 0-54.272-54.336z"})]))}}),success_filled_default=success_filled_vue_vue_type_script_setup_true_lang_default,switch_vue_vue_type_script_setup_true_lang_default=defineComponent({name:"Switch",__name:"switch",setup(t){return(r,e)=>(openBlock(),createElementBlock("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[createBaseVNode("path",{fill:"currentColor",d:"M118.656 438.656a32 32 0 0 1 0-45.248L416 96l4.48-3.776A32 32 0 0 1 461.248 96l3.712 4.48a32.064 32.064 0 0 1-3.712 40.832L218.56 384H928a32 32 0 1 1 0 64H141.248a32 32 0 0 1-22.592-9.344zM64 608a32 32 0 0 1 32-32h786.752a32 32 0 0 1 22.656 54.592L608 928l-4.48 3.776a32.064 32.064 0 0 1-40.832-49.024L805.632 640H96a32 32 0 0 1-32-32"})]))}}),switch_default=switch_vue_vue_type_script_setup_true_lang_default,tickets_vue_vue_type_script_setup_true_lang_default=defineComponent({name:"Tickets",__name:"tickets",setup(t){return(r,e)=>(openBlock(),createElementBlock("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[createBaseVNode("path",{fill:"currentColor",d:"M192 128v768h640V128zm-32-64h704a32 32 0 0 1 32 32v832a32 32 0 0 1-32 32H160a32 32 0 0 1-32-32V96a32 32 0 0 1 32-32m160 448h384v64H320zm0-192h192v64H320zm0 384h384v64H320z"})]))}}),tickets_default=tickets_vue_vue_type_script_setup_true_lang_default,upload_vue_vue_type_script_setup_true_lang_default=defineComponent({name:"Upload",__name:"upload",setup(t){return(r,e)=>(openBlock(),createElementBlock("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[createBaseVNode("path",{fill:"currentColor",d:"M160 832h704a32 32 0 1 1 0 64H160a32 32 0 1 1 0-64m384-578.304V704h-64V247.296L237.248 490.048 192 444.8 508.8 128l316.8 316.8-45.312 45.248z"})]))}}),upload_default=upload_vue_vue_type_script_setup_true_lang_default,view_vue_vue_type_script_setup_true_lang_default=defineComponent({name:"View",__name:"view",setup(t){return(r,e)=>(openBlock(),createElementBlock("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[createBaseVNode("path",{fill:"currentColor",d:"M512 160c320 0 512 352 512 352S832 864 512 864 0 512 0 512s192-352 512-352m0 64c-225.28 0-384.128 208.064-436.8 288 52.608 79.872 211.456 288 436.8 288 225.28 0 384.128-208.064 436.8-288-52.608-79.872-211.456-288-436.8-288zm0 64a224 224 0 1 1 0 448 224 224 0 0 1 0-448m0 64a160.192 160.192 0 0 0-160 160c0 88.192 71.744 160 160 160s160-71.808 160-160-71.744-160-160-160"})]))}}),view_default=view_vue_vue_type_script_setup_true_lang_default,warning_filled_vue_vue_type_script_setup_true_lang_default=defineComponent({name:"WarningFilled",__name:"warning-filled",setup(t){return(r,e)=>(openBlock(),createElementBlock("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[createBaseVNode("path",{fill:"currentColor",d:"M512 64a448 448 0 1 1 0 896 448 448 0 0 1 0-896m0 192a58.432 58.432 0 0 0-58.24 63.744l23.36 256.384a35.072 35.072 0 0 0 69.76 0l23.296-256.384A58.432 58.432 0 0 0 512 256m0 512a51.2 51.2 0 1 0 0-102.4 51.2 51.2 0 0 0 0 102.4"})]))}}),warning_filled_default=warning_filled_vue_vue_type_script_setup_true_lang_default,zoom_in_vue_vue_type_script_setup_true_lang_default=defineComponent({name:"ZoomIn",__name:"zoom-in",setup(t){return(r,e)=>(openBlock(),createElementBlock("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[createBaseVNode("path",{fill:"currentColor",d:"m795.904 750.72 124.992 124.928a32 32 0 0 1-45.248 45.248L750.656 795.904a416 416 0 1 1 45.248-45.248zM480 832a352 352 0 1 0 0-704 352 352 0 0 0 0 704m-32-384v-96a32 32 0 0 1 64 0v96h96a32 32 0 0 1 0 64h-96v96a32 32 0 0 1-64 0v-96h-96a32 32 0 0 1 0-64z"})]))}}),zoom_in_default=zoom_in_vue_vue_type_script_setup_true_lang_default,zoom_out_vue_vue_type_script_setup_true_lang_default=defineComponent({name:"ZoomOut",__name:"zoom-out",setup(t){return(r,e)=>(openBlock(),createElementBlock("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[createBaseVNode("path",{fill:"currentColor",d:"m795.904 750.72 124.992 124.928a32 32 0 0 1-45.248 45.248L750.656 795.904a416 416 0 1 1 45.248-45.248zM480 832a352 352 0 1 0 0-704 352 352 0 0 0 0 704M352 448h256a32 32 0 0 1 0 64H352a32 32 0 0 1 0-64"})]))}}),zoom_out_default=zoom_out_vue_vue_type_script_setup_true_lang_default;const epPropKey="__epPropKey",definePropType=t=>t,isEpProp=t=>isObject$2(t)&&!!t[epPropKey],buildProp=(t,r)=>{if(!isObject$2(t)||isEpProp(t))return t;const{values:e,required:n,default:g,type:y,validator:i}=t,$={type:y,required:!!n,validator:e||i?L=>{let V=!1,z=[];if(e&&(z=Array.from(e),hasOwn(t,"default")&&z.push(g),V||(V=z.includes(L))),i&&(V||(V=i(L))),!V&&z.length>0){const re=[...new Set(z)].map(ie=>JSON.stringify(ie)).join(", ");warn(`Invalid prop: validation failed${r?` for prop "${r}"`:""}. Expected one of [${re}], got value ${JSON.stringify(L)}.`)}return V}:void 0,[epPropKey]:!0};return hasOwn(t,"default")&&($.default=g),$},buildProps=t=>fromPairs(Object.entries(t).map(([r,e])=>[r,buildProp(e,r)])),iconPropType=definePropType([String,Object,Function]),CloseComponents={Close:close_default},TypeComponents={Close:close_default,SuccessFilled:success_filled_default,InfoFilled:info_filled_default,WarningFilled:warning_filled_default,CircleCloseFilled:circle_close_filled_default},TypeComponentsMap={success:success_filled_default,warning:warning_filled_default,error:circle_close_filled_default,info:info_filled_default},ValidateComponentsMap={validating:loading_default,success:circle_check_default,error:circle_close_default},withInstall=(t,r)=>{if(t.install=e=>{for(const n of[t,...Object.values(r??{})])e.component(n.name,n)},r)for(const[e,n]of Object.entries(r))t[e]=n;return t},withInstallFunction=(t,r)=>(t.install=e=>{t._context=e._context,e.config.globalProperties[r]=t},t),withNoopInstall=t=>(t.install=NOOP,t),composeRefs=(...t)=>r=>{t.forEach(e=>{isFunction$3(e)?e(r):e.value=r})},EVENT_CODE={tab:"Tab",enter:"Enter",space:"Space",left:"ArrowLeft",up:"ArrowUp",right:"ArrowRight",down:"ArrowDown",esc:"Escape",delete:"Delete",backspace:"Backspace",numpadEnter:"NumpadEnter",pageUp:"PageUp",pageDown:"PageDown",home:"Home",end:"End"},UPDATE_MODEL_EVENT="update:modelValue",CHANGE_EVENT="change",INPUT_EVENT="input",componentSizes=["","default","small","large"],isValidComponentSize=t=>["",...componentSizes].includes(t);var PatchFlags=(t=>(t[t.TEXT=1]="TEXT",t[t.CLASS=2]="CLASS",t[t.STYLE=4]="STYLE",t[t.PROPS=8]="PROPS",t[t.FULL_PROPS=16]="FULL_PROPS",t[t.HYDRATE_EVENTS=32]="HYDRATE_EVENTS",t[t.STABLE_FRAGMENT=64]="STABLE_FRAGMENT",t[t.KEYED_FRAGMENT=128]="KEYED_FRAGMENT",t[t.UNKEYED_FRAGMENT=256]="UNKEYED_FRAGMENT",t[t.NEED_PATCH=512]="NEED_PATCH",t[t.DYNAMIC_SLOTS=1024]="DYNAMIC_SLOTS",t[t.HOISTED=-1]="HOISTED",t[t.BAIL=-2]="BAIL",t))(PatchFlags||{});function isFragment(t){return isVNode(t)&&t.type===Fragment}function isComment(t){return isVNode(t)&&t.type===Comment}function isValidElementNode(t){return isVNode(t)&&!isFragment(t)&&!isComment(t)}const flattedChildren=t=>{const r=isArray$3(t)?t:[t],e=[];return r.forEach(n=>{var g;isArray$3(n)?e.push(...flattedChildren(n)):isVNode(n)&&isArray$3(n.children)?e.push(...flattedChildren(n.children)):(e.push(n),isVNode(n)&&((g=n.component)!=null&&g.subTree)&&e.push(...flattedChildren(n.component.subTree)))}),e},unique=t=>[...new Set(t)],castArray=t=>!t&&t!==0?[]:Array.isArray(t)?t:[t],isKorean=t=>/([\uAC00-\uD7AF\u3130-\u318F])+/gi.test(t),rAF=t=>isClient?window.requestAnimationFrame(t):setTimeout(t,16),mutable=t=>t,DEFAULT_EXCLUDE_KEYS=["class","style"],LISTENER_PREFIX=/^on[A-Z]/,useAttrs=(t={})=>{const{excludeListeners:r=!1,excludeKeys:e}=t,n=computed(()=>((e==null?void 0:e.value)||[]).concat(DEFAULT_EXCLUDE_KEYS)),g=getCurrentInstance();return computed(g?()=>{var y;return fromPairs(Object.entries((y=g.proxy)==null?void 0:y.$attrs).filter(([i])=>!n.value.includes(i)&&!(r&&LISTENER_PREFIX.test(i))))}:()=>({}))},useDeprecated=({from:t,replacement:r,scope:e,version:n,ref:g,type:y="API"},i)=>{watch(()=>unref(i),k=>{},{immediate:!0})},useDraggable=(t,r,e,n)=>{let g={offsetX:0,offsetY:0};const y=$=>{const L=$.clientX,V=$.clientY,{offsetX:z,offsetY:re}=g,ie=t.value.getBoundingClientRect(),ue=ie.left,le=ie.top,oe=ie.width,ae=ie.height,qe=document.documentElement.clientWidth,de=document.documentElement.clientHeight,Ne=-ue+z,ze=-le+re,$e=qe-ue-oe+z,Lt=de-le-ae+re,jt=ir=>{let dr=z+ir.clientX-L,Dt=re+ir.clientY-V;n!=null&&n.value||(dr=Math.min(Math.max(dr,Ne),$e),Dt=Math.min(Math.max(Dt,ze),Lt)),g={offsetX:dr,offsetY:Dt},t.value&&(t.value.style.transform=`translate(${addUnit(dr)}, ${addUnit(Dt)})`)},Et=()=>{document.removeEventListener("mousemove",jt),document.removeEventListener("mouseup",Et)};document.addEventListener("mousemove",jt),document.addEventListener("mouseup",Et)},i=()=>{r.value&&t.value&&r.value.addEventListener("mousedown",y)},k=()=>{r.value&&t.value&&r.value.removeEventListener("mousedown",y)};onMounted(()=>{watchEffect(()=>{e.value?i():k()})}),onBeforeUnmount(()=>{k()})};var English={name:"en",el:{colorpicker:{confirm:"OK",clear:"Clear",defaultLabel:"color picker",description:"current color is {color}. press enter to select a new color."},datepicker:{now:"Now",today:"Today",cancel:"Cancel",clear:"Clear",confirm:"OK",dateTablePrompt:"Use the arrow keys and enter to select the day of the month",monthTablePrompt:"Use the arrow keys and enter to select the month",yearTablePrompt:"Use the arrow keys and enter to select the year",selectedDate:"Selected date",selectDate:"Select date",selectTime:"Select time",startDate:"Start Date",startTime:"Start Time",endDate:"End Date",endTime:"End Time",prevYear:"Previous Year",nextYear:"Next Year",prevMonth:"Previous Month",nextMonth:"Next Month",year:"",month1:"January",month2:"February",month3:"March",month4:"April",month5:"May",month6:"June",month7:"July",month8:"August",month9:"September",month10:"October",month11:"November",month12:"December",week:"week",weeks:{sun:"Sun",mon:"Mon",tue:"Tue",wed:"Wed",thu:"Thu",fri:"Fri",sat:"Sat"},weeksFull:{sun:"Sunday",mon:"Monday",tue:"Tuesday",wed:"Wednesday",thu:"Thursday",fri:"Friday",sat:"Saturday"},months:{jan:"Jan",feb:"Feb",mar:"Mar",apr:"Apr",may:"May",jun:"Jun",jul:"Jul",aug:"Aug",sep:"Sep",oct:"Oct",nov:"Nov",dec:"Dec"}},inputNumber:{decrease:"decrease number",increase:"increase number"},select:{loading:"Loading",noMatch:"No matching data",noData:"No data",placeholder:"Select"},dropdown:{toggleDropdown:"Toggle Dropdown"},cascader:{noMatch:"No matching data",loading:"Loading",placeholder:"Select",noData:"No data"},pagination:{goto:"Go to",pagesize:"/page",total:"Total {total}",pageClassifier:"",page:"Page",prev:"Go to previous page",next:"Go to next page",currentPage:"page {pager}",prevPages:"Previous {pager} pages",nextPages:"Next {pager} pages",deprecationWarning:"Deprecated usages detected, please refer to the el-pagination documentation for more details"},dialog:{close:"Close this dialog"},drawer:{close:"Close this dialog"},messagebox:{title:"Message",confirm:"OK",cancel:"Cancel",error:"Illegal input",close:"Close this dialog"},upload:{deleteTip:"press delete to remove",delete:"Delete",preview:"Preview",continue:"Continue"},slider:{defaultLabel:"slider between {min} and {max}",defaultRangeStartLabel:"pick start value",defaultRangeEndLabel:"pick end value"},table:{emptyText:"No Data",confirmFilter:"Confirm",resetFilter:"Reset",clearFilter:"All",sumText:"Sum"},tour:{next:"Next",previous:"Previous",finish:"Finish"},tree:{emptyText:"No Data"},transfer:{noMatch:"No matching data",noData:"No data",titles:["List 1","List 2"],filterPlaceholder:"Enter keyword",noCheckedFormat:"{total} items",hasCheckedFormat:"{checked}/{total} checked"},image:{error:"FAILED"},pageHeader:{title:"Back"},popconfirm:{confirmButtonText:"Yes",cancelButtonText:"No"},carousel:{leftArrow:"Carousel arrow left",rightArrow:"Carousel arrow right",indicator:"Carousel switch to index {index}"}}};const buildTranslator=t=>(r,e)=>translate(r,e,unref(t)),translate=(t,r,e)=>get(e,t,t).replace(/\{(\w+)\}/g,(n,g)=>{var y;return`${(y=r==null?void 0:r[g])!=null?y:`{${g}}`}`}),buildLocaleContext=t=>{const r=computed(()=>unref(t).name),e=isRef(t)?t:ref(t);return{lang:r,locale:e,t:buildTranslator(t)}},localeContextKey=Symbol("localeContextKey"),useLocale=t=>{const r=t||inject(localeContextKey,ref());return buildLocaleContext(computed(()=>r.value||English))},defaultNamespace="el",statePrefix="is-",_bem=(t,r,e,n,g)=>{let y=`${t}-${r}`;return e&&(y+=`-${e}`),n&&(y+=`__${n}`),g&&(y+=`--${g}`),y},namespaceContextKey=Symbol("namespaceContextKey"),useGetDerivedNamespace=t=>{const r=t||(getCurrentInstance()?inject(namespaceContextKey,ref(defaultNamespace)):ref(defaultNamespace));return computed(()=>unref(r)||defaultNamespace)},useNamespace=(t,r)=>{const e=useGetDerivedNamespace(r);return{namespace:e,b:(le="")=>_bem(e.value,t,le,"",""),e:le=>le?_bem(e.value,t,"",le,""):"",m:le=>le?_bem(e.value,t,"","",le):"",be:(le,oe)=>le&&oe?_bem(e.value,t,le,oe,""):"",em:(le,oe)=>le&&oe?_bem(e.value,t,"",le,oe):"",bm:(le,oe)=>le&&oe?_bem(e.value,t,le,"",oe):"",bem:(le,oe,ae)=>le&&oe&&ae?_bem(e.value,t,le,oe,ae):"",is:(le,...oe)=>{const ae=oe.length>=1?oe[0]:!0;return le&&ae?`${statePrefix}${le}`:""},cssVar:le=>{const oe={};for(const ae in le)le[ae]&&(oe[`--${e.value}-${ae}`]=le[ae]);return oe},cssVarName:le=>`--${e.value}-${le}`,cssVarBlock:le=>{const oe={};for(const ae in le)le[ae]&&(oe[`--${e.value}-${t}-${ae}`]=le[ae]);return oe},cssVarBlockName:le=>`--${e.value}-${t}-${le}`}},useLockscreen=(t,r={})=>{isRef(t)||throwError("[useLockscreen]","You need to pass a ref param to this function");const e=r.ns||useNamespace("popup"),n=computed$1(()=>e.bm("parent","hidden"));if(!isClient||hasClass(document.body,n.value))return;let g=0,y=!1,i="0";const k=()=>{setTimeout(()=>{removeClass(document==null?void 0:document.body,n.value),y&&document&&(document.body.style.width=i)},200)};watch(t,$=>{if(!$){k();return}y=!hasClass(document.body,n.value),y&&(i=document.body.style.width),g=getScrollBarWidth(e.namespace.value);const L=document.documentElement.clientHeight<document.body.scrollHeight,V=getStyle(document.body,"overflowY");g>0&&(L||V==="scroll")&&y&&(document.body.style.width=`calc(100% - ${g}px)`),addClass(document.body,n.value)}),onScopeDispose(()=>k())},_prop=buildProp({type:definePropType(Boolean),default:null}),_event=buildProp({type:definePropType(Function)}),createModelToggleComposable=t=>{const r=`update:${t}`,e=`onUpdate:${t}`,n=[r],g={[t]:_prop,[e]:_event};return{useModelToggle:({indicator:i,toggleReason:k,shouldHideWhenRouteChanges:$,shouldProceed:L,onShow:V,onHide:z})=>{const re=getCurrentInstance(),{emit:ie}=re,ue=re.props,le=computed(()=>isFunction$3(ue[e])),oe=computed(()=>ue[t]===null),ae=Lt=>{i.value!==!0&&(i.value=!0,k&&(k.value=Lt),isFunction$3(V)&&V(Lt))},qe=Lt=>{i.value!==!1&&(i.value=!1,k&&(k.value=Lt),isFunction$3(z)&&z(Lt))},de=Lt=>{if(ue.disabled===!0||isFunction$3(L)&&!L())return;const jt=le.value&&isClient;jt&&ie(r,!0),(oe.value||!jt)&&ae(Lt)},Ne=Lt=>{if(ue.disabled===!0||!isClient)return;const jt=le.value&&isClient;jt&&ie(r,!1),(oe.value||!jt)&&qe(Lt)},ze=Lt=>{isBoolean$1(Lt)&&(ue.disabled&&Lt?le.value&&ie(r,!1):i.value!==Lt&&(Lt?ae():qe()))},$e=()=>{i.value?Ne():de()};return watch(()=>ue[t],ze),$&&re.appContext.config.globalProperties.$route!==void 0&&watch(()=>({...re.proxy.$route}),()=>{$.value&&i.value&&Ne()}),onMounted(()=>{ze(ue[t])}),{hide:Ne,show:de,toggle:$e,hasUpdateHandler:le}},useModelToggleProps:g,useModelToggleEmits:n}};createModelToggleComposable("modelValue");const useProp=t=>{const r=getCurrentInstance();return computed(()=>{var e,n;return(n=(e=r==null?void 0:r.proxy)==null?void 0:e.$props)==null?void 0:n[t]})};var E$1="top",R="bottom",W="right",P$1="left",me="auto",G=[E$1,R,W,P$1],U$1="start",J="end",Xe="clippingParents",je="viewport",K="popper",Ye="reference",De=G.reduce(function(t,r){return t.concat([r+"-"+U$1,r+"-"+J])},[]),Ee=[].concat(G,[me]).reduce(function(t,r){return t.concat([r,r+"-"+U$1,r+"-"+J])},[]),Ge="beforeRead",Je="read",Ke="afterRead",Qe="beforeMain",Ze="main",et="afterMain",tt$1="beforeWrite",nt="write",rt="afterWrite",ot=[Ge,Je,Ke,Qe,Ze,et,tt$1,nt,rt];function C(t){return t?(t.nodeName||"").toLowerCase():null}function H(t){if(t==null)return window;if(t.toString()!=="[object Window]"){var r=t.ownerDocument;return r&&r.defaultView||window}return t}function Q(t){var r=H(t).Element;return t instanceof r||t instanceof Element}function B(t){var r=H(t).HTMLElement;return t instanceof r||t instanceof HTMLElement}function Pe(t){if(typeof ShadowRoot>"u")return!1;var r=H(t).ShadowRoot;return t instanceof r||t instanceof ShadowRoot}function Mt(t){var r=t.state;Object.keys(r.elements).forEach(function(e){var n=r.styles[e]||{},g=r.attributes[e]||{},y=r.elements[e];!B(y)||!C(y)||(Object.assign(y.style,n),Object.keys(g).forEach(function(i){var k=g[i];k===!1?y.removeAttribute(i):y.setAttribute(i,k===!0?"":k)}))})}function Rt(t){var r=t.state,e={popper:{position:r.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(r.elements.popper.style,e.popper),r.styles=e,r.elements.arrow&&Object.assign(r.elements.arrow.style,e.arrow),function(){Object.keys(r.elements).forEach(function(n){var g=r.elements[n],y=r.attributes[n]||{},i=Object.keys(r.styles.hasOwnProperty(n)?r.styles[n]:e[n]),k=i.reduce(function($,L){return $[L]="",$},{});!B(g)||!C(g)||(Object.assign(g.style,k),Object.keys(y).forEach(function($){g.removeAttribute($)}))})}}var Ae={name:"applyStyles",enabled:!0,phase:"write",fn:Mt,effect:Rt,requires:["computeStyles"]};function q(t){return t.split("-")[0]}var X$1=Math.max,ve=Math.min,Z=Math.round;function ee(t,r){r===void 0&&(r=!1);var e=t.getBoundingClientRect(),n=1,g=1;if(B(t)&&r){var y=t.offsetHeight,i=t.offsetWidth;i>0&&(n=Z(e.width)/i||1),y>0&&(g=Z(e.height)/y||1)}return{width:e.width/n,height:e.height/g,top:e.top/g,right:e.right/n,bottom:e.bottom/g,left:e.left/n,x:e.left/n,y:e.top/g}}function ke(t){var r=ee(t),e=t.offsetWidth,n=t.offsetHeight;return Math.abs(r.width-e)<=1&&(e=r.width),Math.abs(r.height-n)<=1&&(n=r.height),{x:t.offsetLeft,y:t.offsetTop,width:e,height:n}}function it(t,r){var e=r.getRootNode&&r.getRootNode();if(t.contains(r))return!0;if(e&&Pe(e)){var n=r;do{if(n&&t.isSameNode(n))return!0;n=n.parentNode||n.host}while(n)}return!1}function N$1(t){return H(t).getComputedStyle(t)}function Wt(t){return["table","td","th"].indexOf(C(t))>=0}function I$1(t){return((Q(t)?t.ownerDocument:t.document)||window.document).documentElement}function ge(t){return C(t)==="html"?t:t.assignedSlot||t.parentNode||(Pe(t)?t.host:null)||I$1(t)}function at(t){return!B(t)||N$1(t).position==="fixed"?null:t.offsetParent}function Bt(t){var r=navigator.userAgent.toLowerCase().indexOf("firefox")!==-1,e=navigator.userAgent.indexOf("Trident")!==-1;if(e&&B(t)){var n=N$1(t);if(n.position==="fixed")return null}var g=ge(t);for(Pe(g)&&(g=g.host);B(g)&&["html","body"].indexOf(C(g))<0;){var y=N$1(g);if(y.transform!=="none"||y.perspective!=="none"||y.contain==="paint"||["transform","perspective"].indexOf(y.willChange)!==-1||r&&y.willChange==="filter"||r&&y.filter&&y.filter!=="none")return g;g=g.parentNode}return null}function se(t){for(var r=H(t),e=at(t);e&&Wt(e)&&N$1(e).position==="static";)e=at(e);return e&&(C(e)==="html"||C(e)==="body"&&N$1(e).position==="static")?r:e||Bt(t)||r}function Le(t){return["top","bottom"].indexOf(t)>=0?"x":"y"}function fe(t,r,e){return X$1(t,ve(r,e))}function St(t,r,e){var n=fe(t,r,e);return n>e?e:n}function st(){return{top:0,right:0,bottom:0,left:0}}function ft(t){return Object.assign({},st(),t)}function ct(t,r){return r.reduce(function(e,n){return e[n]=t,e},{})}var Tt=function(t,r){return t=typeof t=="function"?t(Object.assign({},r.rects,{placement:r.placement})):t,ft(typeof t!="number"?t:ct(t,G))};function Ht(t){var r,e=t.state,n=t.name,g=t.options,y=e.elements.arrow,i=e.modifiersData.popperOffsets,k=q(e.placement),$=Le(k),L=[P$1,W].indexOf(k)>=0,V=L?"height":"width";if(!(!y||!i)){var z=Tt(g.padding,e),re=ke(y),ie=$==="y"?E$1:P$1,ue=$==="y"?R:W,le=e.rects.reference[V]+e.rects.reference[$]-i[$]-e.rects.popper[V],oe=i[$]-e.rects.reference[$],ae=se(y),qe=ae?$==="y"?ae.clientHeight||0:ae.clientWidth||0:0,de=le/2-oe/2,Ne=z[ie],ze=qe-re[V]-z[ue],$e=qe/2-re[V]/2+de,Lt=fe(Ne,$e,ze),jt=$;e.modifiersData[n]=(r={},r[jt]=Lt,r.centerOffset=Lt-$e,r)}}function Ct(t){var r=t.state,e=t.options,n=e.element,g=n===void 0?"[data-popper-arrow]":n;g!=null&&(typeof g=="string"&&(g=r.elements.popper.querySelector(g),!g)||!it(r.elements.popper,g)||(r.elements.arrow=g))}var pt={name:"arrow",enabled:!0,phase:"main",fn:Ht,effect:Ct,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function te(t){return t.split("-")[1]}var qt={top:"auto",right:"auto",bottom:"auto",left:"auto"};function Vt(t){var r=t.x,e=t.y,n=window,g=n.devicePixelRatio||1;return{x:Z(r*g)/g||0,y:Z(e*g)/g||0}}function ut(t){var r,e=t.popper,n=t.popperRect,g=t.placement,y=t.variation,i=t.offsets,k=t.position,$=t.gpuAcceleration,L=t.adaptive,V=t.roundOffsets,z=t.isFixed,re=i.x,ie=re===void 0?0:re,ue=i.y,le=ue===void 0?0:ue,oe=typeof V=="function"?V({x:ie,y:le}):{x:ie,y:le};ie=oe.x,le=oe.y;var ae=i.hasOwnProperty("x"),qe=i.hasOwnProperty("y"),de=P$1,Ne=E$1,ze=window;if(L){var $e=se(e),Lt="clientHeight",jt="clientWidth";if($e===H(e)&&($e=I$1(e),N$1($e).position!=="static"&&k==="absolute"&&(Lt="scrollHeight",jt="scrollWidth")),$e=$e,g===E$1||(g===P$1||g===W)&&y===J){Ne=R;var Et=z&&$e===ze&&ze.visualViewport?ze.visualViewport.height:$e[Lt];le-=Et-n.height,le*=$?1:-1}if(g===P$1||(g===E$1||g===R)&&y===J){de=W;var ir=z&&$e===ze&&ze.visualViewport?ze.visualViewport.width:$e[jt];ie-=ir-n.width,ie*=$?1:-1}}var dr=Object.assign({position:k},L&&qt),Dt=V===!0?Vt({x:ie,y:le}):{x:ie,y:le};if(ie=Dt.x,le=Dt.y,$){var lr;return Object.assign({},dr,(lr={},lr[Ne]=qe?"0":"",lr[de]=ae?"0":"",lr.transform=(ze.devicePixelRatio||1)<=1?"translate("+ie+"px, "+le+"px)":"translate3d("+ie+"px, "+le+"px, 0)",lr))}return Object.assign({},dr,(r={},r[Ne]=qe?le+"px":"",r[de]=ae?ie+"px":"",r.transform="",r))}function Nt(t){var r=t.state,e=t.options,n=e.gpuAcceleration,g=n===void 0?!0:n,y=e.adaptive,i=y===void 0?!0:y,k=e.roundOffsets,$=k===void 0?!0:k,L={placement:q(r.placement),variation:te(r.placement),popper:r.elements.popper,popperRect:r.rects.popper,gpuAcceleration:g,isFixed:r.options.strategy==="fixed"};r.modifiersData.popperOffsets!=null&&(r.styles.popper=Object.assign({},r.styles.popper,ut(Object.assign({},L,{offsets:r.modifiersData.popperOffsets,position:r.options.strategy,adaptive:i,roundOffsets:$})))),r.modifiersData.arrow!=null&&(r.styles.arrow=Object.assign({},r.styles.arrow,ut(Object.assign({},L,{offsets:r.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:$})))),r.attributes.popper=Object.assign({},r.attributes.popper,{"data-popper-placement":r.placement})}var Me={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:Nt,data:{}},ye={passive:!0};function It(t){var r=t.state,e=t.instance,n=t.options,g=n.scroll,y=g===void 0?!0:g,i=n.resize,k=i===void 0?!0:i,$=H(r.elements.popper),L=[].concat(r.scrollParents.reference,r.scrollParents.popper);return y&&L.forEach(function(V){V.addEventListener("scroll",e.update,ye)}),k&&$.addEventListener("resize",e.update,ye),function(){y&&L.forEach(function(V){V.removeEventListener("scroll",e.update,ye)}),k&&$.removeEventListener("resize",e.update,ye)}}var Re={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:It,data:{}},_t={left:"right",right:"left",bottom:"top",top:"bottom"};function be(t){return t.replace(/left|right|bottom|top/g,function(r){return _t[r]})}var zt={start:"end",end:"start"};function lt(t){return t.replace(/start|end/g,function(r){return zt[r]})}function We(t){var r=H(t),e=r.pageXOffset,n=r.pageYOffset;return{scrollLeft:e,scrollTop:n}}function Be(t){return ee(I$1(t)).left+We(t).scrollLeft}function Ft(t){var r=H(t),e=I$1(t),n=r.visualViewport,g=e.clientWidth,y=e.clientHeight,i=0,k=0;return n&&(g=n.width,y=n.height,/^((?!chrome|android).)*safari/i.test(navigator.userAgent)||(i=n.offsetLeft,k=n.offsetTop)),{width:g,height:y,x:i+Be(t),y:k}}function Ut(t){var r,e=I$1(t),n=We(t),g=(r=t.ownerDocument)==null?void 0:r.body,y=X$1(e.scrollWidth,e.clientWidth,g?g.scrollWidth:0,g?g.clientWidth:0),i=X$1(e.scrollHeight,e.clientHeight,g?g.scrollHeight:0,g?g.clientHeight:0),k=-n.scrollLeft+Be(t),$=-n.scrollTop;return N$1(g||e).direction==="rtl"&&(k+=X$1(e.clientWidth,g?g.clientWidth:0)-y),{width:y,height:i,x:k,y:$}}function Se(t){var r=N$1(t),e=r.overflow,n=r.overflowX,g=r.overflowY;return/auto|scroll|overlay|hidden/.test(e+g+n)}function dt(t){return["html","body","#document"].indexOf(C(t))>=0?t.ownerDocument.body:B(t)&&Se(t)?t:dt(ge(t))}function ce(t,r){var e;r===void 0&&(r=[]);var n=dt(t),g=n===((e=t.ownerDocument)==null?void 0:e.body),y=H(n),i=g?[y].concat(y.visualViewport||[],Se(n)?n:[]):n,k=r.concat(i);return g?k:k.concat(ce(ge(i)))}function Te(t){return Object.assign({},t,{left:t.x,top:t.y,right:t.x+t.width,bottom:t.y+t.height})}function Xt(t){var r=ee(t);return r.top=r.top+t.clientTop,r.left=r.left+t.clientLeft,r.bottom=r.top+t.clientHeight,r.right=r.left+t.clientWidth,r.width=t.clientWidth,r.height=t.clientHeight,r.x=r.left,r.y=r.top,r}function ht(t,r){return r===je?Te(Ft(t)):Q(r)?Xt(r):Te(Ut(I$1(t)))}function Yt(t){var r=ce(ge(t)),e=["absolute","fixed"].indexOf(N$1(t).position)>=0,n=e&&B(t)?se(t):t;return Q(n)?r.filter(function(g){return Q(g)&&it(g,n)&&C(g)!=="body"}):[]}function Gt(t,r,e){var n=r==="clippingParents"?Yt(t):[].concat(r),g=[].concat(n,[e]),y=g[0],i=g.reduce(function(k,$){var L=ht(t,$);return k.top=X$1(L.top,k.top),k.right=ve(L.right,k.right),k.bottom=ve(L.bottom,k.bottom),k.left=X$1(L.left,k.left),k},ht(t,y));return i.width=i.right-i.left,i.height=i.bottom-i.top,i.x=i.left,i.y=i.top,i}function mt(t){var r=t.reference,e=t.element,n=t.placement,g=n?q(n):null,y=n?te(n):null,i=r.x+r.width/2-e.width/2,k=r.y+r.height/2-e.height/2,$;switch(g){case E$1:$={x:i,y:r.y-e.height};break;case R:$={x:i,y:r.y+r.height};break;case W:$={x:r.x+r.width,y:k};break;case P$1:$={x:r.x-e.width,y:k};break;default:$={x:r.x,y:r.y}}var L=g?Le(g):null;if(L!=null){var V=L==="y"?"height":"width";switch(y){case U$1:$[L]=$[L]-(r[V]/2-e[V]/2);break;case J:$[L]=$[L]+(r[V]/2-e[V]/2);break}}return $}function ne(t,r){r===void 0&&(r={});var e=r,n=e.placement,g=n===void 0?t.placement:n,y=e.boundary,i=y===void 0?Xe:y,k=e.rootBoundary,$=k===void 0?je:k,L=e.elementContext,V=L===void 0?K:L,z=e.altBoundary,re=z===void 0?!1:z,ie=e.padding,ue=ie===void 0?0:ie,le=ft(typeof ue!="number"?ue:ct(ue,G)),oe=V===K?Ye:K,ae=t.rects.popper,qe=t.elements[re?oe:V],de=Gt(Q(qe)?qe:qe.contextElement||I$1(t.elements.popper),i,$),Ne=ee(t.elements.reference),ze=mt({reference:Ne,element:ae,strategy:"absolute",placement:g}),$e=Te(Object.assign({},ae,ze)),Lt=V===K?$e:Ne,jt={top:de.top-Lt.top+le.top,bottom:Lt.bottom-de.bottom+le.bottom,left:de.left-Lt.left+le.left,right:Lt.right-de.right+le.right},Et=t.modifiersData.offset;if(V===K&&Et){var ir=Et[g];Object.keys(jt).forEach(function(dr){var Dt=[W,R].indexOf(dr)>=0?1:-1,lr=[E$1,R].indexOf(dr)>=0?"y":"x";jt[dr]+=ir[lr]*Dt})}return jt}function Jt(t,r){r===void 0&&(r={});var e=r,n=e.placement,g=e.boundary,y=e.rootBoundary,i=e.padding,k=e.flipVariations,$=e.allowedAutoPlacements,L=$===void 0?Ee:$,V=te(n),z=V?k?De:De.filter(function(ue){return te(ue)===V}):G,re=z.filter(function(ue){return L.indexOf(ue)>=0});re.length===0&&(re=z);var ie=re.reduce(function(ue,le){return ue[le]=ne(t,{placement:le,boundary:g,rootBoundary:y,padding:i})[q(le)],ue},{});return Object.keys(ie).sort(function(ue,le){return ie[ue]-ie[le]})}function Kt(t){if(q(t)===me)return[];var r=be(t);return[lt(t),r,lt(r)]}function Qt(t){var r=t.state,e=t.options,n=t.name;if(!r.modifiersData[n]._skip){for(var g=e.mainAxis,y=g===void 0?!0:g,i=e.altAxis,k=i===void 0?!0:i,$=e.fallbackPlacements,L=e.padding,V=e.boundary,z=e.rootBoundary,re=e.altBoundary,ie=e.flipVariations,ue=ie===void 0?!0:ie,le=e.allowedAutoPlacements,oe=r.options.placement,ae=q(oe),qe=ae===oe,de=$||(qe||!ue?[be(oe)]:Kt(oe)),Ne=[oe].concat(de).reduce(function(rr,kr){return rr.concat(q(kr)===me?Jt(r,{placement:kr,boundary:V,rootBoundary:z,padding:L,flipVariations:ue,allowedAutoPlacements:le}):kr)},[]),ze=r.rects.reference,$e=r.rects.popper,Lt=new Map,jt=!0,Et=Ne[0],ir=0;ir<Ne.length;ir++){var dr=Ne[ir],Dt=q(dr),lr=te(dr)===U$1,sr=[E$1,R].indexOf(Dt)>=0,er=sr?"width":"height",cr=ne(r,{placement:dr,boundary:V,rootBoundary:z,altBoundary:re,padding:L}),or=sr?lr?W:P$1:lr?R:E$1;ze[er]>$e[er]&&(or=be(or));var hr=be(or),pr=[];if(y&&pr.push(cr[Dt]<=0),k&&pr.push(cr[or]<=0,cr[hr]<=0),pr.every(function(rr){return rr})){Et=dr,jt=!1;break}Lt.set(dr,pr)}if(jt)for(var Sr=ue?3:1,Er=function(rr){var kr=Ne.find(function(Ir){var xr=Lt.get(Ir);if(xr)return xr.slice(0,rr).every(function(vr){return vr})});if(kr)return Et=kr,"break"},Pr=Sr;Pr>0;Pr--){var Cr=Er(Pr);if(Cr==="break")break}r.placement!==Et&&(r.modifiersData[n]._skip=!0,r.placement=Et,r.reset=!0)}}var vt={name:"flip",enabled:!0,phase:"main",fn:Qt,requiresIfExists:["offset"],data:{_skip:!1}};function gt(t,r,e){return e===void 0&&(e={x:0,y:0}),{top:t.top-r.height-e.y,right:t.right-r.width+e.x,bottom:t.bottom-r.height+e.y,left:t.left-r.width-e.x}}function yt(t){return[E$1,W,R,P$1].some(function(r){return t[r]>=0})}function Zt(t){var r=t.state,e=t.name,n=r.rects.reference,g=r.rects.popper,y=r.modifiersData.preventOverflow,i=ne(r,{elementContext:"reference"}),k=ne(r,{altBoundary:!0}),$=gt(i,n),L=gt(k,g,y),V=yt($),z=yt(L);r.modifiersData[e]={referenceClippingOffsets:$,popperEscapeOffsets:L,isReferenceHidden:V,hasPopperEscaped:z},r.attributes.popper=Object.assign({},r.attributes.popper,{"data-popper-reference-hidden":V,"data-popper-escaped":z})}var bt={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:Zt};function en(t,r,e){var n=q(t),g=[P$1,E$1].indexOf(n)>=0?-1:1,y=typeof e=="function"?e(Object.assign({},r,{placement:t})):e,i=y[0],k=y[1];return i=i||0,k=(k||0)*g,[P$1,W].indexOf(n)>=0?{x:k,y:i}:{x:i,y:k}}function tn(t){var r=t.state,e=t.options,n=t.name,g=e.offset,y=g===void 0?[0,0]:g,i=Ee.reduce(function(V,z){return V[z]=en(z,r.rects,y),V},{}),k=i[r.placement],$=k.x,L=k.y;r.modifiersData.popperOffsets!=null&&(r.modifiersData.popperOffsets.x+=$,r.modifiersData.popperOffsets.y+=L),r.modifiersData[n]=i}var wt={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:tn};function nn(t){var r=t.state,e=t.name;r.modifiersData[e]=mt({reference:r.rects.reference,element:r.rects.popper,strategy:"absolute",placement:r.placement})}var He={name:"popperOffsets",enabled:!0,phase:"read",fn:nn,data:{}};function rn(t){return t==="x"?"y":"x"}function on(t){var r=t.state,e=t.options,n=t.name,g=e.mainAxis,y=g===void 0?!0:g,i=e.altAxis,k=i===void 0?!1:i,$=e.boundary,L=e.rootBoundary,V=e.altBoundary,z=e.padding,re=e.tether,ie=re===void 0?!0:re,ue=e.tetherOffset,le=ue===void 0?0:ue,oe=ne(r,{boundary:$,rootBoundary:L,padding:z,altBoundary:V}),ae=q(r.placement),qe=te(r.placement),de=!qe,Ne=Le(ae),ze=rn(Ne),$e=r.modifiersData.popperOffsets,Lt=r.rects.reference,jt=r.rects.popper,Et=typeof le=="function"?le(Object.assign({},r.rects,{placement:r.placement})):le,ir=typeof Et=="number"?{mainAxis:Et,altAxis:Et}:Object.assign({mainAxis:0,altAxis:0},Et),dr=r.modifiersData.offset?r.modifiersData.offset[r.placement]:null,Dt={x:0,y:0};if($e){if(y){var lr,sr=Ne==="y"?E$1:P$1,er=Ne==="y"?R:W,cr=Ne==="y"?"height":"width",or=$e[Ne],hr=or+oe[sr],pr=or-oe[er],Sr=ie?-jt[cr]/2:0,Er=qe===U$1?Lt[cr]:jt[cr],Pr=qe===U$1?-jt[cr]:-Lt[cr],Cr=r.elements.arrow,rr=ie&&Cr?ke(Cr):{width:0,height:0},kr=r.modifiersData["arrow#persistent"]?r.modifiersData["arrow#persistent"].padding:st(),Ir=kr[sr],xr=kr[er],vr=fe(0,Lt[cr],rr[cr]),_r=de?Lt[cr]/2-Sr-vr-Ir-ir.mainAxis:Er-vr-Ir-ir.mainAxis,Or=de?-Lt[cr]/2+Sr+vr+xr+ir.mainAxis:Pr+vr+xr+ir.mainAxis,Mr=r.elements.arrow&&se(r.elements.arrow),yr=Mr?Ne==="y"?Mr.clientTop||0:Mr.clientLeft||0:0,mr=(lr=dr==null?void 0:dr[Ne])!=null?lr:0,Tr=or+_r-mr-yr,Br=or+Or-mr,$r=fe(ie?ve(hr,Tr):hr,or,ie?X$1(pr,Br):pr);$e[Ne]=$r,Dt[Ne]=$r-or}if(k){var Lr,Gr=Ne==="x"?E$1:P$1,qr=Ne==="x"?R:W,Yr=$e[ze],bn=ze==="y"?"height":"width",wn=Yr+oe[Gr],Xr=Yr-oe[qr],Vn=[E$1,P$1].indexOf(ae)!==-1,Zr=(Lr=dr==null?void 0:dr[ze])!=null?Lr:0,Nn=Vn?wn:Yr-Lt[bn]-jt[bn]-Zr+ir.altAxis,Qr=Vn?Yr+Lt[bn]+jt[bn]-Zr-ir.altAxis:Xr,kn=ie&&Vn?St(Nn,Yr,Qr):fe(ie?Nn:wn,Yr,ie?Qr:Xr);$e[ze]=kn,Dt[ze]=kn-Yr}r.modifiersData[n]=Dt}}var xt={name:"preventOverflow",enabled:!0,phase:"main",fn:on,requiresIfExists:["offset"]};function an(t){return{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}}function sn(t){return t===H(t)||!B(t)?We(t):an(t)}function fn(t){var r=t.getBoundingClientRect(),e=Z(r.width)/t.offsetWidth||1,n=Z(r.height)/t.offsetHeight||1;return e!==1||n!==1}function cn(t,r,e){e===void 0&&(e=!1);var n=B(r),g=B(r)&&fn(r),y=I$1(r),i=ee(t,g),k={scrollLeft:0,scrollTop:0},$={x:0,y:0};return(n||!n&&!e)&&((C(r)!=="body"||Se(y))&&(k=sn(r)),B(r)?($=ee(r,!0),$.x+=r.clientLeft,$.y+=r.clientTop):y&&($.x=Be(y))),{x:i.left+k.scrollLeft-$.x,y:i.top+k.scrollTop-$.y,width:i.width,height:i.height}}function pn(t){var r=new Map,e=new Set,n=[];t.forEach(function(y){r.set(y.name,y)});function g(y){e.add(y.name);var i=[].concat(y.requires||[],y.requiresIfExists||[]);i.forEach(function(k){if(!e.has(k)){var $=r.get(k);$&&g($)}}),n.push(y)}return t.forEach(function(y){e.has(y.name)||g(y)}),n}function un(t){var r=pn(t);return ot.reduce(function(e,n){return e.concat(r.filter(function(g){return g.phase===n}))},[])}function ln(t){var r;return function(){return r||(r=new Promise(function(e){Promise.resolve().then(function(){r=void 0,e(t())})})),r}}function dn(t){var r=t.reduce(function(e,n){var g=e[n.name];return e[n.name]=g?Object.assign({},g,n,{options:Object.assign({},g.options,n.options),data:Object.assign({},g.data,n.data)}):n,e},{});return Object.keys(r).map(function(e){return r[e]})}var Ot={placement:"bottom",modifiers:[],strategy:"absolute"};function $t(){for(var t=arguments.length,r=new Array(t),e=0;e<t;e++)r[e]=arguments[e];return!r.some(function(n){return!(n&&typeof n.getBoundingClientRect=="function")})}function we(t){t===void 0&&(t={});var r=t,e=r.defaultModifiers,n=e===void 0?[]:e,g=r.defaultOptions,y=g===void 0?Ot:g;return function(i,k,$){$===void 0&&($=y);var L={placement:"bottom",orderedModifiers:[],options:Object.assign({},Ot,y),modifiersData:{},elements:{reference:i,popper:k},attributes:{},styles:{}},V=[],z=!1,re={state:L,setOptions:function(le){var oe=typeof le=="function"?le(L.options):le;ue(),L.options=Object.assign({},y,L.options,oe),L.scrollParents={reference:Q(i)?ce(i):i.contextElement?ce(i.contextElement):[],popper:ce(k)};var ae=un(dn([].concat(n,L.options.modifiers)));return L.orderedModifiers=ae.filter(function(qe){return qe.enabled}),ie(),re.update()},forceUpdate:function(){if(!z){var le=L.elements,oe=le.reference,ae=le.popper;if($t(oe,ae)){L.rects={reference:cn(oe,se(ae),L.options.strategy==="fixed"),popper:ke(ae)},L.reset=!1,L.placement=L.options.placement,L.orderedModifiers.forEach(function(jt){return L.modifiersData[jt.name]=Object.assign({},jt.data)});for(var qe=0;qe<L.orderedModifiers.length;qe++){if(L.reset===!0){L.reset=!1,qe=-1;continue}var de=L.orderedModifiers[qe],Ne=de.fn,ze=de.options,$e=ze===void 0?{}:ze,Lt=de.name;typeof Ne=="function"&&(L=Ne({state:L,options:$e,name:Lt,instance:re})||L)}}}},update:ln(function(){return new Promise(function(le){re.forceUpdate(),le(L)})}),destroy:function(){ue(),z=!0}};if(!$t(i,k))return re;re.setOptions($).then(function(le){!z&&$.onFirstUpdate&&$.onFirstUpdate(le)});function ie(){L.orderedModifiers.forEach(function(le){var oe=le.name,ae=le.options,qe=ae===void 0?{}:ae,de=le.effect;if(typeof de=="function"){var Ne=de({state:L,name:oe,instance:re,options:qe}),ze=function(){};V.push(Ne||ze)}})}function ue(){V.forEach(function(le){return le()}),V=[]}return re}}we();var mn=[Re,He,Me,Ae];we({defaultModifiers:mn});var gn=[Re,He,Me,Ae,wt,vt,xt,pt,bt],yn=we({defaultModifiers:gn});const usePopper=(t,r,e={})=>{const n={name:"updateState",enabled:!0,phase:"write",fn:({state:$})=>{const L=deriveState($);Object.assign(i.value,L)},requires:["computeStyles"]},g=computed(()=>{const{onFirstUpdate:$,placement:L,strategy:V,modifiers:z}=unref(e);return{onFirstUpdate:$,placement:L||"bottom",strategy:V||"absolute",modifiers:[...z||[],n,{name:"applyStyles",enabled:!1}]}}),y=shallowRef(),i=ref({styles:{popper:{position:unref(g).strategy,left:"0",top:"0"},arrow:{position:"absolute"}},attributes:{}}),k=()=>{y.value&&(y.value.destroy(),y.value=void 0)};return watch(g,$=>{const L=unref(y);L&&L.setOptions($)},{deep:!0}),watch([t,r],([$,L])=>{k(),!(!$||!L)&&(y.value=yn($,L,unref(g)))}),onBeforeUnmount(()=>{k()}),{state:computed(()=>{var $;return{...(($=unref(y))==null?void 0:$.state)||{}}}),styles:computed(()=>unref(i).styles),attributes:computed(()=>unref(i).attributes),update:()=>{var $;return($=unref(y))==null?void 0:$.update()},forceUpdate:()=>{var $;return($=unref(y))==null?void 0:$.forceUpdate()},instanceRef:computed(()=>unref(y))}};function deriveState(t){const r=Object.keys(t.elements),e=fromPairs(r.map(g=>[g,t.styles[g]||{}])),n=fromPairs(r.map(g=>[g,t.attributes[g]]));return{styles:e,attributes:n}}const useSameTarget=t=>{if(!t)return{onClick:NOOP,onMousedown:NOOP,onMouseup:NOOP};let r=!1,e=!1;return{onClick:i=>{r&&e&&t(i),r=e=!1},onMousedown:i=>{r=i.target===i.currentTarget},onMouseup:i=>{e=i.target===i.currentTarget}}};function useTimeout(){let t;const r=(n,g)=>{e(),t=window.setTimeout(n,g)},e=()=>window.clearTimeout(t);return tryOnScopeDispose(()=>e()),{registerTimeout:r,cancelTimeout:e}}const defaultIdInjection={prefix:Math.floor(Math.random()*1e4),current:0},ID_INJECTION_KEY=Symbol("elIdInjection"),useIdInjection=()=>getCurrentInstance()?inject(ID_INJECTION_KEY,defaultIdInjection):defaultIdInjection,useId=t=>{const r=useIdInjection(),e=useGetDerivedNamespace();return computed(()=>unref(t)||`${e.value}-id-${r.prefix}-${r.current++}`)};let registeredEscapeHandlers=[];const cachedHandler=t=>{const r=t;r.key===EVENT_CODE.esc&&registeredEscapeHandlers.forEach(e=>e(r))},useEscapeKeydown=t=>{onMounted(()=>{registeredEscapeHandlers.length===0&&document.addEventListener("keydown",cachedHandler),isClient&&registeredEscapeHandlers.push(t)}),onBeforeUnmount(()=>{registeredEscapeHandlers=registeredEscapeHandlers.filter(r=>r!==t),registeredEscapeHandlers.length===0&&isClient&&document.removeEventListener("keydown",cachedHandler)})};let cachedContainer;const usePopperContainerId=()=>{const t=useGetDerivedNamespace(),r=useIdInjection(),e=computed(()=>`${t.value}-popper-container-${r.prefix}`),n=computed(()=>`#${e.value}`);return{id:e,selector:n}},createContainer=t=>{const r=document.createElement("div");return r.id=t,document.body.appendChild(r),r},usePopperContainer=()=>{const{id:t,selector:r}=usePopperContainerId();return onBeforeMount(()=>{isClient&&!cachedContainer&&!document.body.querySelector(r.value)&&(cachedContainer=createContainer(t.value))}),{id:t,selector:r}},useDelayedToggleProps=buildProps({showAfter:{type:Number,default:0},hideAfter:{type:Number,default:200},autoClose:{type:Number,default:0}}),useDelayedToggle=({showAfter:t,hideAfter:r,autoClose:e,open:n,close:g})=>{const{registerTimeout:y}=useTimeout(),{registerTimeout:i,cancelTimeout:k}=useTimeout();return{onOpen:V=>{y(()=>{n(V);const z=unref(e);isNumber$1(z)&&z>0&&i(()=>{g(V)},z)},unref(t))},onClose:V=>{k(),y(()=>{g(V)},unref(r))}}},FORWARD_REF_INJECTION_KEY=Symbol("elForwardRef"),useForwardRef=t=>{provide(FORWARD_REF_INJECTION_KEY,{setForwardRef:e=>{t.value=e}})},useForwardRefDirective=t=>({mounted(r){t(r)},updated(r){t(r)},unmounted(){t(null)}}),zIndex=ref(0),defaultInitialZIndex=2e3,zIndexContextKey=Symbol("zIndexContextKey"),useZIndex=t=>{const r=t||(getCurrentInstance()?inject(zIndexContextKey,void 0):void 0),e=computed(()=>{const y=unref(r);return isNumber$1(y)?y:defaultInitialZIndex}),n=computed(()=>e.value+zIndex.value);return{initialZIndex:e,currentZIndex:n,nextZIndex:()=>(zIndex.value++,n.value)}};function useCursor(t){const r=ref();function e(){if(t.value==null)return;const{selectionStart:g,selectionEnd:y,value:i}=t.value;if(g==null||y==null)return;const k=i.slice(0,Math.max(0,g)),$=i.slice(Math.max(0,y));r.value={selectionStart:g,selectionEnd:y,value:i,beforeTxt:k,afterTxt:$}}function n(){if(t.value==null||r.value==null)return;const{value:g}=t.value,{beforeTxt:y,afterTxt:i,selectionStart:k}=r.value;if(y==null||i==null||k==null)return;let $=g.length;if(g.endsWith(i))$=g.length-i.length;else if(g.startsWith(y))$=y.length;else{const L=y[k-1],V=g.indexOf(L,k-1);V!==-1&&($=V+1)}t.value.setSelectionRange($,$)}return[e,n]}const useSizeProp=buildProp({type:String,values:componentSizes,required:!1}),SIZE_INJECTION_KEY=Symbol("size"),useGlobalSize=()=>{const t=inject(SIZE_INJECTION_KEY,{});return computed(()=>unref(t.size)||"")};function useFocusController(t,{afterFocus:r,beforeBlur:e,afterBlur:n}={}){const g=getCurrentInstance(),{emit:y}=g,i=shallowRef(),k=ref(!1),$=z=>{k.value||(k.value=!0,y("focus",z),r==null||r())},L=z=>{var re;isFunction$3(e)&&e(z)||z.relatedTarget&&((re=i.value)!=null&&re.contains(z.relatedTarget))||(k.value=!1,y("blur",z),n==null||n())},V=()=>{var z;(z=t.value)==null||z.focus()};return watch(i,z=>{z&&z.setAttribute("tabindex","-1")}),useEventListener(i,"click",V),{wrapperRef:i,isFocused:k,handleFocus:$,handleBlur:L}}const configProviderContextKey=Symbol(),globalConfig=ref();function useGlobalConfig(t,r=void 0){const e=getCurrentInstance()?inject(configProviderContextKey,globalConfig):globalConfig;return t?computed(()=>{var n,g;return(g=(n=e.value)==null?void 0:n[t])!=null?g:r}):e}function useGlobalComponentSettings(t,r){const e=useGlobalConfig(),n=useNamespace(t,computed(()=>{var k;return((k=e.value)==null?void 0:k.namespace)||defaultNamespace})),g=useLocale(computed(()=>{var k;return(k=e.value)==null?void 0:k.locale})),y=useZIndex(computed(()=>{var k;return((k=e.value)==null?void 0:k.zIndex)||defaultInitialZIndex})),i=computed(()=>{var k;return unref(r)||((k=e.value)==null?void 0:k.size)||""});return provideGlobalConfig(computed(()=>unref(e)||{})),{ns:n,locale:g,zIndex:y,size:i}}const provideGlobalConfig=(t,r,e=!1)=>{var n;const g=!!getCurrentInstance(),y=g?useGlobalConfig():void 0,i=(n=r==null?void 0:r.provide)!=null?n:g?provide:void 0;if(!i)return;const k=computed(()=>{const $=unref(t);return y!=null&&y.value?mergeConfig$1(y.value,$):$});return i(configProviderContextKey,k),i(localeContextKey,computed(()=>k.value.locale)),i(namespaceContextKey,computed(()=>k.value.namespace)),i(zIndexContextKey,computed(()=>k.value.zIndex)),i(SIZE_INJECTION_KEY,{size:computed(()=>k.value.size||"")}),(e||!globalConfig.value)&&(globalConfig.value=k.value),k},mergeConfig$1=(t,r)=>{var e;const n=[...new Set([...keysOf(t),...keysOf(r)])],g={};for(const y of n)g[y]=(e=r[y])!=null?e:t[y];return g},messageConfig={},affixProps=buildProps({zIndex:{type:definePropType([Number,String]),default:100},target:{type:String,default:""},offset:{type:Number,default:0},position:{type:String,values:["top","bottom"],default:"top"}}),affixEmits={scroll:({scrollTop:t,fixed:r})=>isNumber$1(t)&&isBoolean$1(r),[CHANGE_EVENT]:t=>isBoolean$1(t)};var _export_sfc$1=(t,r)=>{const e=t.__vccOpts||t;for(const[n,g]of r)e[n]=g;return e};const COMPONENT_NAME$a="ElAffix",__default__$K=defineComponent({name:COMPONENT_NAME$a}),_sfc_main$19=defineComponent({...__default__$K,props:affixProps,emits:affixEmits,setup(t,{expose:r,emit:e}){const n=t,g=useNamespace("affix"),y=shallowRef(),i=shallowRef(),k=shallowRef(),{height:$}=useWindowSize(),{height:L,width:V,top:z,bottom:re,update:ie}=useElementBounding(i,{windowScroll:!1}),ue=useElementBounding(y),le=ref(!1),oe=ref(0),ae=ref(0),qe=computed(()=>({height:le.value?`${L.value}px`:"",width:le.value?`${V.value}px`:""})),de=computed(()=>{if(!le.value)return{};const $e=n.offset?addUnit(n.offset):0;return{height:`${L.value}px`,width:`${V.value}px`,top:n.position==="top"?$e:"",bottom:n.position==="bottom"?$e:"",transform:ae.value?`translateY(${ae.value}px)`:"",zIndex:n.zIndex}}),Ne=()=>{if(k.value)if(oe.value=k.value instanceof Window?document.documentElement.scrollTop:k.value.scrollTop||0,n.position==="top")if(n.target){const $e=ue.bottom.value-n.offset-L.value;le.value=n.offset>z.value&&ue.bottom.value>0,ae.value=$e<0?$e:0}else le.value=n.offset>z.value;else if(n.target){const $e=$.value-ue.top.value-n.offset-L.value;le.value=$.value-n.offset<re.value&&$.value>ue.top.value,ae.value=$e<0?-$e:0}else le.value=$.value-n.offset<re.value},ze=()=>{ie(),e("scroll",{scrollTop:oe.value,fixed:le.value})};return watch(le,$e=>e("change",$e)),onMounted(()=>{var $e;n.target?(y.value=($e=document.querySelector(n.target))!=null?$e:void 0,y.value||throwError(COMPONENT_NAME$a,`Target is not existed: ${n.target}`)):y.value=document.documentElement,k.value=getScrollContainer(i.value,!0),ie()}),useEventListener(k,"scroll",ze),watchEffect(Ne),r({update:Ne,updateRoot:ie}),($e,Lt)=>(openBlock(),createElementBlock("div",{ref_key:"root",ref:i,class:normalizeClass(unref(g).b()),style:normalizeStyle(unref(qe))},[createBaseVNode("div",{class:normalizeClass({[unref(g).m("fixed")]:le.value}),style:normalizeStyle(unref(de))},[renderSlot($e.$slots,"default")],6)],6))}});var Affix=_export_sfc$1(_sfc_main$19,[["__file","affix.vue"]]);const ElAffix=withInstall(Affix),iconProps=buildProps({size:{type:definePropType([Number,String])},color:{type:String}}),__default__$J=defineComponent({name:"ElIcon",inheritAttrs:!1}),_sfc_main$18=defineComponent({...__default__$J,props:iconProps,setup(t){const r=t,e=useNamespace("icon"),n=computed(()=>{const{size:g,color:y}=r;return!g&&!y?{}:{fontSize:isUndefined$1(g)?void 0:addUnit(g),"--color":y}});return(g,y)=>(openBlock(),createElementBlock("i",mergeProps({class:unref(e).b(),style:unref(n)},g.$attrs),[renderSlot(g.$slots,"default")],16))}});var Icon=_export_sfc$1(_sfc_main$18,[["__file","icon.vue"]]);const ElIcon=withInstall(Icon),formContextKey=Symbol("formContextKey"),formItemContextKey=Symbol("formItemContextKey"),useFormSize=(t,r={})=>{const e=ref(void 0),n=r.prop?e:useProp("size"),g=r.global?e:useGlobalSize(),y=r.form?{size:void 0}:inject(formContextKey,void 0),i=r.formItem?{size:void 0}:inject(formItemContextKey,void 0);return computed(()=>n.value||unref(t)||(i==null?void 0:i.size)||(y==null?void 0:y.size)||g.value||"")},useFormDisabled=t=>{const r=useProp("disabled"),e=inject(formContextKey,void 0);return computed(()=>r.value||unref(t)||(e==null?void 0:e.disabled)||!1)},useFormItem=()=>{const t=inject(formContextKey,void 0),r=inject(formItemContextKey,void 0);return{form:t,formItem:r}},useFormItemInputId=(t,{formItemContext:r,disableIdGeneration:e,disableIdManagement:n})=>{e||(e=ref(!1)),n||(n=ref(!1));const g=ref();let y;const i=computed(()=>{var k;return!!(!t.label&&r&&r.inputIds&&((k=r.inputIds)==null?void 0:k.length)<=1)});return onMounted(()=>{y=watch([toRef(t,"id"),e],([k,$])=>{const L=k??($?void 0:useId().value);L!==g.value&&(r!=null&&r.removeInputId&&(g.value&&r.removeInputId(g.value),!(n!=null&&n.value)&&!$&&L&&r.addInputId(L)),g.value=L)},{immediate:!0})}),onUnmounted(()=>{y&&y(),r!=null&&r.removeInputId&&g.value&&r.removeInputId(g.value)}),{isLabeledByFormItem:i,inputId:g}},formMetaProps=buildProps({size:{type:String,values:componentSizes},disabled:Boolean}),formProps=buildProps({...formMetaProps,model:Object,rules:{type:definePropType(Object)},labelPosition:{type:String,values:["left","right","top"],default:"right"},requireAsteriskPosition:{type:String,values:["left","right"],default:"left"},labelWidth:{type:[String,Number],default:""},labelSuffix:{type:String,default:""},inline:Boolean,inlineMessage:Boolean,statusIcon:Boolean,showMessage:{type:Boolean,default:!0},validateOnRuleChange:{type:Boolean,default:!0},hideRequiredAsterisk:Boolean,scrollToError:Boolean,scrollIntoViewOptions:{type:[Object,Boolean]}}),formEmits={validate:(t,r,e)=>(isArray$3(t)||isString$2(t))&&isBoolean$1(r)&&isString$2(e)};function useFormLabelWidth(){const t=ref([]),r=computed(()=>{if(!t.value.length)return"0";const y=Math.max(...t.value);return y?`${y}px`:""});function e(y){const i=t.value.indexOf(y);return i===-1&&r.value,i}function n(y,i){if(y&&i){const k=e(i);t.value.splice(k,1,y)}else y&&t.value.push(y)}function g(y){const i=e(y);i>-1&&t.value.splice(i,1)}return{autoLabelWidth:r,registerLabelWidth:n,deregisterLabelWidth:g}}const filterFields=(t,r)=>{const e=castArray$1(r);return e.length>0?t.filter(n=>n.prop&&e.includes(n.prop)):t},COMPONENT_NAME$9="ElForm",__default__$I=defineComponent({name:COMPONENT_NAME$9}),_sfc_main$17=defineComponent({...__default__$I,props:formProps,emits:formEmits,setup(t,{expose:r,emit:e}){const n=t,g=[],y=useFormSize(),i=useNamespace("form"),k=computed(()=>{const{labelPosition:de,inline:Ne}=n;return[i.b(),i.m(y.value||"default"),{[i.m(`label-${de}`)]:de,[i.m("inline")]:Ne}]}),$=de=>g.find(Ne=>Ne.prop===de),L=de=>{g.push(de)},V=de=>{de.prop&&g.splice(g.indexOf(de),1)},z=(de=[])=>{n.model&&filterFields(g,de).forEach(Ne=>Ne.resetField())},re=(de=[])=>{filterFields(g,de).forEach(Ne=>Ne.clearValidate())},ie=computed(()=>!!n.model),ue=de=>{if(g.length===0)return[];const Ne=filterFields(g,de);return Ne.length?Ne:[]},le=async de=>ae(void 0,de),oe=async(de=[])=>{if(!ie.value)return!1;const Ne=ue(de);if(Ne.length===0)return!0;let ze={};for(const $e of Ne)try{await $e.validate("")}catch(Lt){ze={...ze,...Lt}}return Object.keys(ze).length===0?!0:Promise.reject(ze)},ae=async(de=[],Ne)=>{const ze=!isFunction$3(Ne);try{const $e=await oe(de);return $e===!0&&(Ne==null||Ne($e)),$e}catch($e){if($e instanceof Error)throw $e;const Lt=$e;return n.scrollToError&&qe(Object.keys(Lt)[0]),Ne==null||Ne(!1,Lt),ze&&Promise.reject(Lt)}},qe=de=>{var Ne;const ze=filterFields(g,de)[0];ze&&((Ne=ze.$el)==null||Ne.scrollIntoView(n.scrollIntoViewOptions))};return watch(()=>n.rules,()=>{n.validateOnRuleChange&&le().catch(de=>void 0)},{deep:!0}),provide(formContextKey,reactive({...toRefs(n),emit:e,resetFields:z,clearValidate:re,validateField:ae,getField:$,addField:L,removeField:V,...useFormLabelWidth()})),r({validate:le,validateField:ae,resetFields:z,clearValidate:re,scrollToField:qe}),(de,Ne)=>(openBlock(),createElementBlock("form",{class:normalizeClass(unref(k))},[renderSlot(de.$slots,"default")],2))}});var Form=_export_sfc$1(_sfc_main$17,[["__file","form.vue"]]);function _extends(){return _extends=Object.assign?Object.assign.bind():function(t){for(var r=1;r<arguments.length;r++){var e=arguments[r];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])}return t},_extends.apply(this,arguments)}function _inheritsLoose(t,r){t.prototype=Object.create(r.prototype),t.prototype.constructor=t,_setPrototypeOf(t,r)}function _getPrototypeOf(t){return _getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},_getPrototypeOf(t)}function _setPrototypeOf(t,r){return _setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,g){return n.__proto__=g,n},_setPrototypeOf(t,r)}function _isNativeReflectConstruct(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function _construct(t,r,e){return _isNativeReflectConstruct()?_construct=Reflect.construct.bind():_construct=function(g,y,i){var k=[null];k.push.apply(k,y);var $=Function.bind.apply(g,k),L=new $;return i&&_setPrototypeOf(L,i.prototype),L},_construct.apply(null,arguments)}function _isNativeFunction(t){return Function.toString.call(t).indexOf("[native code]")!==-1}function _wrapNativeSuper(t){var r=typeof Map=="function"?new Map:void 0;return _wrapNativeSuper=function(n){if(n===null||!_isNativeFunction(n))return n;if(typeof n!="function")throw new TypeError("Super expression must either be null or a function");if(typeof r<"u"){if(r.has(n))return r.get(n);r.set(n,g)}function g(){return _construct(n,arguments,_getPrototypeOf(this).constructor)}return g.prototype=Object.create(n.prototype,{constructor:{value:g,enumerable:!1,writable:!0,configurable:!0}}),_setPrototypeOf(g,n)},_wrapNativeSuper(t)}var formatRegExp=/%[sdj%]/g,warning=function(){};typeof process<"u"&&process.env;function convertFieldsError(t){if(!t||!t.length)return null;var r={};return t.forEach(function(e){var n=e.field;r[n]=r[n]||[],r[n].push(e)}),r}function format(t){for(var r=arguments.length,e=new Array(r>1?r-1:0),n=1;n<r;n++)e[n-1]=arguments[n];var g=0,y=e.length;if(typeof t=="function")return t.apply(null,e);if(typeof t=="string"){var i=t.replace(formatRegExp,function(k){if(k==="%%")return"%";if(g>=y)return k;switch(k){case"%s":return String(e[g++]);case"%d":return Number(e[g++]);case"%j":try{return JSON.stringify(e[g++])}catch{return"[Circular]"}break;default:return k}});return i}return t}function isNativeStringType(t){return t==="string"||t==="url"||t==="hex"||t==="email"||t==="date"||t==="pattern"}function isEmptyValue(t,r){return!!(t==null||r==="array"&&Array.isArray(t)&&!t.length||isNativeStringType(r)&&typeof t=="string"&&!t)}function asyncParallelArray(t,r,e){var n=[],g=0,y=t.length;function i(k){n.push.apply(n,k||[]),g++,g===y&&e(n)}t.forEach(function(k){r(k,i)})}function asyncSerialArray(t,r,e){var n=0,g=t.length;function y(i){if(i&&i.length){e(i);return}var k=n;n=n+1,k<g?r(t[k],y):e([])}y([])}function flattenObjArr(t){var r=[];return Object.keys(t).forEach(function(e){r.push.apply(r,t[e]||[])}),r}var AsyncValidationError=function(t){_inheritsLoose(r,t);function r(e,n){var g;return g=t.call(this,"Async Validation Error")||this,g.errors=e,g.fields=n,g}return r}(_wrapNativeSuper(Error));function asyncMap(t,r,e,n,g){if(r.first){var y=new Promise(function(re,ie){var ue=function(ae){return n(ae),ae.length?ie(new AsyncValidationError(ae,convertFieldsError(ae))):re(g)},le=flattenObjArr(t);asyncSerialArray(le,e,ue)});return y.catch(function(re){return re}),y}var i=r.firstFields===!0?Object.keys(t):r.firstFields||[],k=Object.keys(t),$=k.length,L=0,V=[],z=new Promise(function(re,ie){var ue=function(oe){if(V.push.apply(V,oe),L++,L===$)return n(V),V.length?ie(new AsyncValidationError(V,convertFieldsError(V))):re(g)};k.length||(n(V),re(g)),k.forEach(function(le){var oe=t[le];i.indexOf(le)!==-1?asyncSerialArray(oe,e,ue):asyncParallelArray(oe,e,ue)})});return z.catch(function(re){return re}),z}function isErrorObj(t){return!!(t&&t.message!==void 0)}function getValue(t,r){for(var e=t,n=0;n<r.length;n++){if(e==null)return e;e=e[r[n]]}return e}function complementError(t,r){return function(e){var n;return t.fullFields?n=getValue(r,t.fullFields):n=r[e.field||t.fullField],isErrorObj(e)?(e.field=e.field||t.fullField,e.fieldValue=n,e):{message:typeof e=="function"?e():e,fieldValue:n,field:e.field||t.fullField}}}function deepMerge(t,r){if(r){for(var e in r)if(r.hasOwnProperty(e)){var n=r[e];typeof n=="object"&&typeof t[e]=="object"?t[e]=_extends({},t[e],n):t[e]=n}}return t}var required$1=function(r,e,n,g,y,i){r.required&&(!n.hasOwnProperty(r.field)||isEmptyValue(e,i||r.type))&&g.push(format(y.messages.required,r.fullField))},whitespace=function(r,e,n,g,y){(/^\s+$/.test(e)||e==="")&&g.push(format(y.messages.whitespace,r.fullField))},urlReg,getUrlRegex=function(){if(urlReg)return urlReg;var t="[a-fA-F\\d:]",r=function(Ne){return Ne&&Ne.includeBoundaries?"(?:(?<=\\s|^)(?="+t+")|(?<="+t+")(?=\\s|$))":""},e="(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)(?:\\.(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)){3}",n="[a-fA-F\\d]{1,4}",g=(`
(?:
(?:`+n+":){7}(?:"+n+`|:)|                                    // 1:2:3:4:5:6:7::  1:2:3:4:5:6:7:8
(?:`+n+":){6}(?:"+e+"|:"+n+`|:)|                             // 1:2:3:4:5:6::    1:2:3:4:5:6::8   1:2:3:4:5:6::8  1:2:3:4:5:6::1.2.3.4
(?:`+n+":){5}(?::"+e+"|(?::"+n+`){1,2}|:)|                   // 1:2:3:4:5::      1:2:3:4:5::7:8   1:2:3:4:5::8    1:2:3:4:5::7:1.2.3.4
(?:`+n+":){4}(?:(?::"+n+"){0,1}:"+e+"|(?::"+n+`){1,3}|:)| // 1:2:3:4::        1:2:3:4::6:7:8   1:2:3:4::8      1:2:3:4::6:7:1.2.3.4
(?:`+n+":){3}(?:(?::"+n+"){0,2}:"+e+"|(?::"+n+`){1,4}|:)| // 1:2:3::          1:2:3::5:6:7:8   1:2:3::8        1:2:3::5:6:7:1.2.3.4
(?:`+n+":){2}(?:(?::"+n+"){0,3}:"+e+"|(?::"+n+`){1,5}|:)| // 1:2::            1:2::4:5:6:7:8   1:2::8          1:2::4:5:6:7:1.2.3.4
(?:`+n+":){1}(?:(?::"+n+"){0,4}:"+e+"|(?::"+n+`){1,6}|:)| // 1::              1::3:4:5:6:7:8   1::8            1::3:4:5:6:7:1.2.3.4
(?::(?:(?::`+n+"){0,5}:"+e+"|(?::"+n+`){1,7}|:))             // ::2:3:4:5:6:7:8  ::2:3:4:5:6:7:8  ::8             ::1.2.3.4
)(?:%[0-9a-zA-Z]{1,})?                                             // %eth0            %1
`).replace(/\s*\/\/.*$/gm,"").replace(/\n/g,"").trim(),y=new RegExp("(?:^"+e+"$)|(?:^"+g+"$)"),i=new RegExp("^"+e+"$"),k=new RegExp("^"+g+"$"),$=function(Ne){return Ne&&Ne.exact?y:new RegExp("(?:"+r(Ne)+e+r(Ne)+")|(?:"+r(Ne)+g+r(Ne)+")","g")};$.v4=function(de){return de&&de.exact?i:new RegExp(""+r(de)+e+r(de),"g")},$.v6=function(de){return de&&de.exact?k:new RegExp(""+r(de)+g+r(de),"g")};var L="(?:(?:[a-z]+:)?//)",V="(?:\\S+(?::\\S*)?@)?",z=$.v4().source,re=$.v6().source,ie="(?:(?:[a-z\\u00a1-\\uffff0-9][-_]*)*[a-z\\u00a1-\\uffff0-9]+)",ue="(?:\\.(?:[a-z\\u00a1-\\uffff0-9]-*)*[a-z\\u00a1-\\uffff0-9]+)*",le="(?:\\.(?:[a-z\\u00a1-\\uffff]{2,}))",oe="(?::\\d{2,5})?",ae='(?:[/?#][^\\s"]*)?',qe="(?:"+L+"|www\\.)"+V+"(?:localhost|"+z+"|"+re+"|"+ie+ue+le+")"+oe+ae;return urlReg=new RegExp("(?:^"+qe+"$)","i"),urlReg},pattern$2={email:/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+\.)+[a-zA-Z\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]{2,}))$/,hex:/^#?([a-f0-9]{6}|[a-f0-9]{3})$/i},types={integer:function(r){return types.number(r)&&parseInt(r,10)===r},float:function(r){return types.number(r)&&!types.integer(r)},array:function(r){return Array.isArray(r)},regexp:function(r){if(r instanceof RegExp)return!0;try{return!!new RegExp(r)}catch{return!1}},date:function(r){return typeof r.getTime=="function"&&typeof r.getMonth=="function"&&typeof r.getYear=="function"&&!isNaN(r.getTime())},number:function(r){return isNaN(r)?!1:typeof r=="number"},object:function(r){return typeof r=="object"&&!types.array(r)},method:function(r){return typeof r=="function"},email:function(r){return typeof r=="string"&&r.length<=320&&!!r.match(pattern$2.email)},url:function(r){return typeof r=="string"&&r.length<=2048&&!!r.match(getUrlRegex())},hex:function(r){return typeof r=="string"&&!!r.match(pattern$2.hex)}},type$1=function(r,e,n,g,y){if(r.required&&e===void 0){required$1(r,e,n,g,y);return}var i=["integer","float","array","regexp","object","method","email","number","date","url","hex"],k=r.type;i.indexOf(k)>-1?types[k](e)||g.push(format(y.messages.types[k],r.fullField,r.type)):k&&typeof e!==r.type&&g.push(format(y.messages.types[k],r.fullField,r.type))},range$1=function(r,e,n,g,y){var i=typeof r.len=="number",k=typeof r.min=="number",$=typeof r.max=="number",L=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,V=e,z=null,re=typeof e=="number",ie=typeof e=="string",ue=Array.isArray(e);if(re?z="number":ie?z="string":ue&&(z="array"),!z)return!1;ue&&(V=e.length),ie&&(V=e.replace(L,"_").length),i?V!==r.len&&g.push(format(y.messages[z].len,r.fullField,r.len)):k&&!$&&V<r.min?g.push(format(y.messages[z].min,r.fullField,r.min)):$&&!k&&V>r.max?g.push(format(y.messages[z].max,r.fullField,r.max)):k&&$&&(V<r.min||V>r.max)&&g.push(format(y.messages[z].range,r.fullField,r.min,r.max))},ENUM$1="enum",enumerable$1=function(r,e,n,g,y){r[ENUM$1]=Array.isArray(r[ENUM$1])?r[ENUM$1]:[],r[ENUM$1].indexOf(e)===-1&&g.push(format(y.messages[ENUM$1],r.fullField,r[ENUM$1].join(", ")))},pattern$1=function(r,e,n,g,y){if(r.pattern){if(r.pattern instanceof RegExp)r.pattern.lastIndex=0,r.pattern.test(e)||g.push(format(y.messages.pattern.mismatch,r.fullField,e,r.pattern));else if(typeof r.pattern=="string"){var i=new RegExp(r.pattern);i.test(e)||g.push(format(y.messages.pattern.mismatch,r.fullField,e,r.pattern))}}},rules={required:required$1,whitespace,type:type$1,range:range$1,enum:enumerable$1,pattern:pattern$1},string=function(r,e,n,g,y){var i=[],k=r.required||!r.required&&g.hasOwnProperty(r.field);if(k){if(isEmptyValue(e,"string")&&!r.required)return n();rules.required(r,e,g,i,y,"string"),isEmptyValue(e,"string")||(rules.type(r,e,g,i,y),rules.range(r,e,g,i,y),rules.pattern(r,e,g,i,y),r.whitespace===!0&&rules.whitespace(r,e,g,i,y))}n(i)},method=function(r,e,n,g,y){var i=[],k=r.required||!r.required&&g.hasOwnProperty(r.field);if(k){if(isEmptyValue(e)&&!r.required)return n();rules.required(r,e,g,i,y),e!==void 0&&rules.type(r,e,g,i,y)}n(i)},number=function(r,e,n,g,y){var i=[],k=r.required||!r.required&&g.hasOwnProperty(r.field);if(k){if(e===""&&(e=void 0),isEmptyValue(e)&&!r.required)return n();rules.required(r,e,g,i,y),e!==void 0&&(rules.type(r,e,g,i,y),rules.range(r,e,g,i,y))}n(i)},_boolean=function(r,e,n,g,y){var i=[],k=r.required||!r.required&&g.hasOwnProperty(r.field);if(k){if(isEmptyValue(e)&&!r.required)return n();rules.required(r,e,g,i,y),e!==void 0&&rules.type(r,e,g,i,y)}n(i)},regexp=function(r,e,n,g,y){var i=[],k=r.required||!r.required&&g.hasOwnProperty(r.field);if(k){if(isEmptyValue(e)&&!r.required)return n();rules.required(r,e,g,i,y),isEmptyValue(e)||rules.type(r,e,g,i,y)}n(i)},integer=function(r,e,n,g,y){var i=[],k=r.required||!r.required&&g.hasOwnProperty(r.field);if(k){if(isEmptyValue(e)&&!r.required)return n();rules.required(r,e,g,i,y),e!==void 0&&(rules.type(r,e,g,i,y),rules.range(r,e,g,i,y))}n(i)},floatFn=function(r,e,n,g,y){var i=[],k=r.required||!r.required&&g.hasOwnProperty(r.field);if(k){if(isEmptyValue(e)&&!r.required)return n();rules.required(r,e,g,i,y),e!==void 0&&(rules.type(r,e,g,i,y),rules.range(r,e,g,i,y))}n(i)},array=function(r,e,n,g,y){var i=[],k=r.required||!r.required&&g.hasOwnProperty(r.field);if(k){if(e==null&&!r.required)return n();rules.required(r,e,g,i,y,"array"),e!=null&&(rules.type(r,e,g,i,y),rules.range(r,e,g,i,y))}n(i)},object=function(r,e,n,g,y){var i=[],k=r.required||!r.required&&g.hasOwnProperty(r.field);if(k){if(isEmptyValue(e)&&!r.required)return n();rules.required(r,e,g,i,y),e!==void 0&&rules.type(r,e,g,i,y)}n(i)},ENUM="enum",enumerable=function(r,e,n,g,y){var i=[],k=r.required||!r.required&&g.hasOwnProperty(r.field);if(k){if(isEmptyValue(e)&&!r.required)return n();rules.required(r,e,g,i,y),e!==void 0&&rules[ENUM](r,e,g,i,y)}n(i)},pattern=function(r,e,n,g,y){var i=[],k=r.required||!r.required&&g.hasOwnProperty(r.field);if(k){if(isEmptyValue(e,"string")&&!r.required)return n();rules.required(r,e,g,i,y),isEmptyValue(e,"string")||rules.pattern(r,e,g,i,y)}n(i)},date=function(r,e,n,g,y){var i=[],k=r.required||!r.required&&g.hasOwnProperty(r.field);if(k){if(isEmptyValue(e,"date")&&!r.required)return n();if(rules.required(r,e,g,i,y),!isEmptyValue(e,"date")){var $;e instanceof Date?$=e:$=new Date(e),rules.type(r,$,g,i,y),$&&rules.range(r,$.getTime(),g,i,y)}}n(i)},required=function(r,e,n,g,y){var i=[],k=Array.isArray(e)?"array":typeof e;rules.required(r,e,g,i,y,k),n(i)},type=function(r,e,n,g,y){var i=r.type,k=[],$=r.required||!r.required&&g.hasOwnProperty(r.field);if($){if(isEmptyValue(e,i)&&!r.required)return n();rules.required(r,e,g,k,y,i),isEmptyValue(e,i)||rules.type(r,e,g,k,y)}n(k)},any=function(r,e,n,g,y){var i=[],k=r.required||!r.required&&g.hasOwnProperty(r.field);if(k){if(isEmptyValue(e)&&!r.required)return n();rules.required(r,e,g,i,y)}n(i)},validators$2={string,method,number,boolean:_boolean,regexp,integer,float:floatFn,array,object,enum:enumerable,pattern,date,url:type,hex:type,email:type,required,any};function newMessages(){return{default:"Validation error on field %s",required:"%s is required",enum:"%s must be one of %s",whitespace:"%s cannot be empty",date:{format:"%s date %s is invalid for format %s",parse:"%s date could not be parsed, %s is invalid ",invalid:"%s date %s is invalid"},types:{string:"%s is not a %s",method:"%s is not a %s (function)",array:"%s is not an %s",object:"%s is not an %s",number:"%s is not a %s",date:"%s is not a %s",boolean:"%s is not a %s",integer:"%s is not an %s",float:"%s is not a %s",regexp:"%s is not a valid %s",email:"%s is not a valid %s",url:"%s is not a valid %s",hex:"%s is not a valid %s"},string:{len:"%s must be exactly %s characters",min:"%s must be at least %s characters",max:"%s cannot be longer than %s characters",range:"%s must be between %s and %s characters"},number:{len:"%s must equal %s",min:"%s cannot be less than %s",max:"%s cannot be greater than %s",range:"%s must be between %s and %s"},array:{len:"%s must be exactly %s in length",min:"%s cannot be less than %s in length",max:"%s cannot be greater than %s in length",range:"%s must be between %s and %s in length"},pattern:{mismatch:"%s value %s does not match pattern %s"},clone:function(){var r=JSON.parse(JSON.stringify(this));return r.clone=this.clone,r}}}var messages=newMessages(),Schema=function(){function t(e){this.rules=null,this._messages=messages,this.define(e)}var r=t.prototype;return r.define=function(n){var g=this;if(!n)throw new Error("Cannot configure a schema with no rules");if(typeof n!="object"||Array.isArray(n))throw new Error("Rules must be an object");this.rules={},Object.keys(n).forEach(function(y){var i=n[y];g.rules[y]=Array.isArray(i)?i:[i]})},r.messages=function(n){return n&&(this._messages=deepMerge(newMessages(),n)),this._messages},r.validate=function(n,g,y){var i=this;g===void 0&&(g={}),y===void 0&&(y=function(){});var k=n,$=g,L=y;if(typeof $=="function"&&(L=$,$={}),!this.rules||Object.keys(this.rules).length===0)return L&&L(null,k),Promise.resolve(k);function V(le){var oe=[],ae={};function qe(Ne){if(Array.isArray(Ne)){var ze;oe=(ze=oe).concat.apply(ze,Ne)}else oe.push(Ne)}for(var de=0;de<le.length;de++)qe(le[de]);oe.length?(ae=convertFieldsError(oe),L(oe,ae)):L(null,k)}if($.messages){var z=this.messages();z===messages&&(z=newMessages()),deepMerge(z,$.messages),$.messages=z}else $.messages=this.messages();var re={},ie=$.keys||Object.keys(this.rules);ie.forEach(function(le){var oe=i.rules[le],ae=k[le];oe.forEach(function(qe){var de=qe;typeof de.transform=="function"&&(k===n&&(k=_extends({},k)),ae=k[le]=de.transform(ae)),typeof de=="function"?de={validator:de}:de=_extends({},de),de.validator=i.getValidationMethod(de),de.validator&&(de.field=le,de.fullField=de.fullField||le,de.type=i.getType(de),re[le]=re[le]||[],re[le].push({rule:de,value:ae,source:k,field:le}))})});var ue={};return asyncMap(re,$,function(le,oe){var ae=le.rule,qe=(ae.type==="object"||ae.type==="array")&&(typeof ae.fields=="object"||typeof ae.defaultField=="object");qe=qe&&(ae.required||!ae.required&&le.value),ae.field=le.field;function de($e,Lt){return _extends({},Lt,{fullField:ae.fullField+"."+$e,fullFields:ae.fullFields?[].concat(ae.fullFields,[$e]):[$e]})}function Ne($e){$e===void 0&&($e=[]);var Lt=Array.isArray($e)?$e:[$e];!$.suppressWarning&&Lt.length&&t.warning("async-validator:",Lt),Lt.length&&ae.message!==void 0&&(Lt=[].concat(ae.message));var jt=Lt.map(complementError(ae,k));if($.first&&jt.length)return ue[ae.field]=1,oe(jt);if(!qe)oe(jt);else{if(ae.required&&!le.value)return ae.message!==void 0?jt=[].concat(ae.message).map(complementError(ae,k)):$.error&&(jt=[$.error(ae,format($.messages.required,ae.field))]),oe(jt);var Et={};ae.defaultField&&Object.keys(le.value).map(function(Dt){Et[Dt]=ae.defaultField}),Et=_extends({},Et,le.rule.fields);var ir={};Object.keys(Et).forEach(function(Dt){var lr=Et[Dt],sr=Array.isArray(lr)?lr:[lr];ir[Dt]=sr.map(de.bind(null,Dt))});var dr=new t(ir);dr.messages($.messages),le.rule.options&&(le.rule.options.messages=$.messages,le.rule.options.error=$.error),dr.validate(le.value,le.rule.options||$,function(Dt){var lr=[];jt&&jt.length&&lr.push.apply(lr,jt),Dt&&Dt.length&&lr.push.apply(lr,Dt),oe(lr.length?lr:null)})}}var ze;if(ae.asyncValidator)ze=ae.asyncValidator(ae,le.value,Ne,le.source,$);else if(ae.validator){try{ze=ae.validator(ae,le.value,Ne,le.source,$)}catch($e){console.error==null||console.error($e),$.suppressValidatorError||setTimeout(function(){throw $e},0),Ne($e.message)}ze===!0?Ne():ze===!1?Ne(typeof ae.message=="function"?ae.message(ae.fullField||ae.field):ae.message||(ae.fullField||ae.field)+" fails"):ze instanceof Array?Ne(ze):ze instanceof Error&&Ne(ze.message)}ze&&ze.then&&ze.then(function(){return Ne()},function($e){return Ne($e)})},function(le){V(le)},k)},r.getType=function(n){if(n.type===void 0&&n.pattern instanceof RegExp&&(n.type="pattern"),typeof n.validator!="function"&&n.type&&!validators$2.hasOwnProperty(n.type))throw new Error(format("Unknown rule type %s",n.type));return n.type||"string"},r.getValidationMethod=function(n){if(typeof n.validator=="function")return n.validator;var g=Object.keys(n),y=g.indexOf("message");return y!==-1&&g.splice(y,1),g.length===1&&g[0]==="required"?validators$2.required:validators$2[this.getType(n)]||void 0},t}();Schema.register=function(r,e){if(typeof e!="function")throw new Error("Cannot register a validator by type, validator is not a function");validators$2[r]=e};Schema.warning=warning;Schema.messages=messages;Schema.validators=validators$2;const formItemValidateStates=["","error","validating","success"],formItemProps=buildProps({label:String,labelWidth:{type:[String,Number],default:""},prop:{type:definePropType([String,Array])},required:{type:Boolean,default:void 0},rules:{type:definePropType([Object,Array])},error:String,validateStatus:{type:String,values:formItemValidateStates},for:String,inlineMessage:{type:[String,Boolean],default:""},showMessage:{type:Boolean,default:!0},size:{type:String,values:componentSizes}}),COMPONENT_NAME$8="ElLabelWrap";var FormLabelWrap=defineComponent({name:COMPONENT_NAME$8,props:{isAutoWidth:Boolean,updateAll:Boolean},setup(t,{slots:r}){const e=inject(formContextKey,void 0),n=inject(formItemContextKey);n||throwError(COMPONENT_NAME$8,"usage: <el-form-item><label-wrap /></el-form-item>");const g=useNamespace("form"),y=ref(),i=ref(0),k=()=>{var V;if((V=y.value)!=null&&V.firstElementChild){const z=window.getComputedStyle(y.value.firstElementChild).width;return Math.ceil(Number.parseFloat(z))}else return 0},$=(V="update")=>{nextTick(()=>{r.default&&t.isAutoWidth&&(V==="update"?i.value=k():V==="remove"&&(e==null||e.deregisterLabelWidth(i.value)))})},L=()=>$("update");return onMounted(()=>{L()}),onBeforeUnmount(()=>{$("remove")}),onUpdated(()=>L()),watch(i,(V,z)=>{t.updateAll&&(e==null||e.registerLabelWidth(V,z))}),useResizeObserver(computed(()=>{var V,z;return(z=(V=y.value)==null?void 0:V.firstElementChild)!=null?z:null}),L),()=>{var V,z;if(!r)return null;const{isAutoWidth:re}=t;if(re){const ie=e==null?void 0:e.autoLabelWidth,ue=n==null?void 0:n.hasLabel,le={};if(ue&&ie&&ie!=="auto"){const oe=Math.max(0,Number.parseInt(ie,10)-i.value),ae=e.labelPosition==="left"?"marginRight":"marginLeft";oe&&(le[ae]=`${oe}px`)}return createVNode("div",{ref:y,class:[g.be("item","label-wrap")],style:le},[(V=r.default)==null?void 0:V.call(r)])}else return createVNode(Fragment,{ref:y},[(z=r.default)==null?void 0:z.call(r)])}}});const _hoisted_1$z=["role","aria-labelledby"],__default__$H=defineComponent({name:"ElFormItem"}),_sfc_main$16=defineComponent({...__default__$H,props:formItemProps,setup(t,{expose:r}){const e=t,n=useSlots(),g=inject(formContextKey,void 0),y=inject(formItemContextKey,void 0),i=useFormSize(void 0,{formItem:!1}),k=useNamespace("form-item"),$=useId().value,L=ref([]),V=ref(""),z=refDebounced(V,100),re=ref(""),ie=ref();let ue,le=!1;const oe=computed(()=>{if((g==null?void 0:g.labelPosition)==="top")return{};const xr=addUnit(e.labelWidth||(g==null?void 0:g.labelWidth)||"");return xr?{width:xr}:{}}),ae=computed(()=>{if((g==null?void 0:g.labelPosition)==="top"||g!=null&&g.inline)return{};if(!e.label&&!e.labelWidth&&Et)return{};const xr=addUnit(e.labelWidth||(g==null?void 0:g.labelWidth)||"");return!e.label&&!n.label?{marginLeft:xr}:{}}),qe=computed(()=>[k.b(),k.m(i.value),k.is("error",V.value==="error"),k.is("validating",V.value==="validating"),k.is("success",V.value==="success"),k.is("required",sr.value||e.required),k.is("no-asterisk",g==null?void 0:g.hideRequiredAsterisk),(g==null?void 0:g.requireAsteriskPosition)==="right"?"asterisk-right":"asterisk-left",{[k.m("feedback")]:g==null?void 0:g.statusIcon}]),de=computed(()=>isBoolean$1(e.inlineMessage)?e.inlineMessage:(g==null?void 0:g.inlineMessage)||!1),Ne=computed(()=>[k.e("error"),{[k.em("error","inline")]:de.value}]),ze=computed(()=>e.prop?isString$2(e.prop)?e.prop:e.prop.join("."):""),$e=computed(()=>!!(e.label||n.label)),Lt=computed(()=>e.for||(L.value.length===1?L.value[0]:void 0)),jt=computed(()=>!Lt.value&&$e.value),Et=!!y,ir=computed(()=>{const xr=g==null?void 0:g.model;if(!(!xr||!e.prop))return getProp(xr,e.prop).value}),dr=computed(()=>{const{required:xr}=e,vr=[];e.rules&&vr.push(...castArray$1(e.rules));const _r=g==null?void 0:g.rules;if(_r&&e.prop){const Or=getProp(_r,e.prop).value;Or&&vr.push(...castArray$1(Or))}if(xr!==void 0){const Or=vr.map((Mr,yr)=>[Mr,yr]).filter(([Mr])=>Object.keys(Mr).includes("required"));if(Or.length>0)for(const[Mr,yr]of Or)Mr.required!==xr&&(vr[yr]={...Mr,required:xr});else vr.push({required:xr})}return vr}),Dt=computed(()=>dr.value.length>0),lr=xr=>dr.value.filter(_r=>!_r.trigger||!xr?!0:Array.isArray(_r.trigger)?_r.trigger.includes(xr):_r.trigger===xr).map(({trigger:_r,...Or})=>Or),sr=computed(()=>dr.value.some(xr=>xr.required)),er=computed(()=>{var xr;return z.value==="error"&&e.showMessage&&((xr=g==null?void 0:g.showMessage)!=null?xr:!0)}),cr=computed(()=>`${e.label||""}${(g==null?void 0:g.labelSuffix)||""}`),or=xr=>{V.value=xr},hr=xr=>{var vr,_r;const{errors:Or,fields:Mr}=xr;(!Or||!Mr)&&console.error(xr),or("error"),re.value=Or?(_r=(vr=Or==null?void 0:Or[0])==null?void 0:vr.message)!=null?_r:`${e.prop} is required`:"",g==null||g.emit("validate",e.prop,!1,re.value)},pr=()=>{or("success"),g==null||g.emit("validate",e.prop,!0,"")},Sr=async xr=>{const vr=ze.value;return new Schema({[vr]:xr}).validate({[vr]:ir.value},{firstFields:!0}).then(()=>(pr(),!0)).catch(Or=>(hr(Or),Promise.reject(Or)))},Er=async(xr,vr)=>{if(le||!e.prop)return!1;const _r=isFunction$3(vr);if(!Dt.value)return vr==null||vr(!1),!1;const Or=lr(xr);return Or.length===0?(vr==null||vr(!0),!0):(or("validating"),Sr(Or).then(()=>(vr==null||vr(!0),!0)).catch(Mr=>{const{fields:yr}=Mr;return vr==null||vr(!1,yr),_r?!1:Promise.reject(yr)}))},Pr=()=>{or(""),re.value="",le=!1},Cr=async()=>{const xr=g==null?void 0:g.model;if(!xr||!e.prop)return;const vr=getProp(xr,e.prop);le=!0,vr.value=clone(ue),await nextTick(),Pr(),le=!1},rr=xr=>{L.value.includes(xr)||L.value.push(xr)},kr=xr=>{L.value=L.value.filter(vr=>vr!==xr)};watch(()=>e.error,xr=>{re.value=xr||"",or(xr?"error":"")},{immediate:!0}),watch(()=>e.validateStatus,xr=>or(xr||""));const Ir=reactive({...toRefs(e),$el:ie,size:i,validateState:V,labelId:$,inputIds:L,isGroup:jt,hasLabel:$e,fieldValue:ir,addInputId:rr,removeInputId:kr,resetField:Cr,clearValidate:Pr,validate:Er});return provide(formItemContextKey,Ir),onMounted(()=>{e.prop&&(g==null||g.addField(Ir),ue=clone(ir.value))}),onBeforeUnmount(()=>{g==null||g.removeField(Ir)}),r({size:i,validateMessage:re,validateState:V,validate:Er,clearValidate:Pr,resetField:Cr}),(xr,vr)=>{var _r;return openBlock(),createElementBlock("div",{ref_key:"formItemRef",ref:ie,class:normalizeClass(unref(qe)),role:unref(jt)?"group":void 0,"aria-labelledby":unref(jt)?unref($):void 0},[createVNode(unref(FormLabelWrap),{"is-auto-width":unref(oe).width==="auto","update-all":((_r=unref(g))==null?void 0:_r.labelWidth)==="auto"},{default:withCtx(()=>[unref($e)?(openBlock(),createBlock(resolveDynamicComponent(unref(Lt)?"label":"div"),{key:0,id:unref($),for:unref(Lt),class:normalizeClass(unref(k).e("label")),style:normalizeStyle(unref(oe))},{default:withCtx(()=>[renderSlot(xr.$slots,"label",{label:unref(cr)},()=>[createTextVNode(toDisplayString(unref(cr)),1)])]),_:3},8,["id","for","class","style"])):createCommentVNode("v-if",!0)]),_:3},8,["is-auto-width","update-all"]),createBaseVNode("div",{class:normalizeClass(unref(k).e("content")),style:normalizeStyle(unref(ae))},[renderSlot(xr.$slots,"default"),createVNode(TransitionGroup,{name:`${unref(k).namespace.value}-zoom-in-top`},{default:withCtx(()=>[unref(er)?renderSlot(xr.$slots,"error",{key:0,error:re.value},()=>[createBaseVNode("div",{class:normalizeClass(unref(Ne))},toDisplayString(re.value),3)]):createCommentVNode("v-if",!0)]),_:3},8,["name"])],6)],10,_hoisted_1$z)}}});var FormItem=_export_sfc$1(_sfc_main$16,[["__file","form-item.vue"]]);const ElForm=withInstall(Form,{FormItem}),ElFormItem=withNoopInstall(FormItem);let hiddenTextarea;const HIDDEN_STYLE=`
  height:0 !important;
  visibility:hidden !important;
  ${isFirefox()?"":"overflow:hidden !important;"}
  position:absolute !important;
  z-index:-1000 !important;
  top:0 !important;
  right:0 !important;
`,CONTEXT_STYLE=["letter-spacing","line-height","padding-top","padding-bottom","font-family","font-weight","font-size","text-rendering","text-transform","width","text-indent","padding-left","padding-right","border-width","box-sizing"];function calculateNodeStyling(t){const r=window.getComputedStyle(t),e=r.getPropertyValue("box-sizing"),n=Number.parseFloat(r.getPropertyValue("padding-bottom"))+Number.parseFloat(r.getPropertyValue("padding-top")),g=Number.parseFloat(r.getPropertyValue("border-bottom-width"))+Number.parseFloat(r.getPropertyValue("border-top-width"));return{contextStyle:CONTEXT_STYLE.map(i=>`${i}:${r.getPropertyValue(i)}`).join(";"),paddingSize:n,borderSize:g,boxSizing:e}}function calcTextareaHeight(t,r=1,e){var n;hiddenTextarea||(hiddenTextarea=document.createElement("textarea"),document.body.appendChild(hiddenTextarea));const{paddingSize:g,borderSize:y,boxSizing:i,contextStyle:k}=calculateNodeStyling(t);hiddenTextarea.setAttribute("style",`${k};${HIDDEN_STYLE}`),hiddenTextarea.value=t.value||t.placeholder||"";let $=hiddenTextarea.scrollHeight;const L={};i==="border-box"?$=$+y:i==="content-box"&&($=$-g),hiddenTextarea.value="";const V=hiddenTextarea.scrollHeight-g;if(isNumber$1(r)){let z=V*r;i==="border-box"&&(z=z+g+y),$=Math.max(z,$),L.minHeight=`${z}px`}if(isNumber$1(e)){let z=V*e;i==="border-box"&&(z=z+g+y),$=Math.min(z,$)}return L.height=`${$}px`,(n=hiddenTextarea.parentNode)==null||n.removeChild(hiddenTextarea),hiddenTextarea=void 0,L}const inputProps=buildProps({id:{type:String,default:void 0},size:useSizeProp,disabled:Boolean,modelValue:{type:definePropType([String,Number,Object]),default:""},maxlength:{type:[String,Number]},minlength:{type:[String,Number]},type:{type:String,default:"text"},resize:{type:String,values:["none","both","horizontal","vertical"]},autosize:{type:definePropType([Boolean,Object]),default:!1},autocomplete:{type:String,default:"off"},formatter:{type:Function},parser:{type:Function},placeholder:{type:String},form:{type:String},readonly:{type:Boolean,default:!1},clearable:{type:Boolean,default:!1},showPassword:{type:Boolean,default:!1},showWordLimit:{type:Boolean,default:!1},suffixIcon:{type:iconPropType},prefixIcon:{type:iconPropType},containerRole:{type:String,default:void 0},label:{type:String,default:void 0},tabindex:{type:[String,Number],default:0},validateEvent:{type:Boolean,default:!0},inputStyle:{type:definePropType([Object,Array,String]),default:()=>mutable({})},autofocus:{type:Boolean,default:!1}}),inputEmits={[UPDATE_MODEL_EVENT]:t=>isString$2(t),input:t=>isString$2(t),change:t=>isString$2(t),focus:t=>t instanceof FocusEvent,blur:t=>t instanceof FocusEvent,clear:()=>!0,mouseleave:t=>t instanceof MouseEvent,mouseenter:t=>t instanceof MouseEvent,keydown:t=>t instanceof Event,compositionstart:t=>t instanceof CompositionEvent,compositionupdate:t=>t instanceof CompositionEvent,compositionend:t=>t instanceof CompositionEvent},_hoisted_1$y=["role"],_hoisted_2$l=["id","minlength","maxlength","type","disabled","readonly","autocomplete","tabindex","aria-label","placeholder","form","autofocus"],_hoisted_3$c=["id","minlength","maxlength","tabindex","disabled","readonly","autocomplete","aria-label","placeholder","form","autofocus"],__default__$G=defineComponent({name:"ElInput",inheritAttrs:!1}),_sfc_main$15=defineComponent({...__default__$G,props:inputProps,emits:inputEmits,setup(t,{expose:r,emit:e}){const n=t,g=useAttrs$1(),y=useSlots(),i=computed(()=>{const Zr={};return n.containerRole==="combobox"&&(Zr["aria-haspopup"]=g["aria-haspopup"],Zr["aria-owns"]=g["aria-owns"],Zr["aria-expanded"]=g["aria-expanded"]),Zr}),k=computed(()=>[n.type==="textarea"?oe.b():le.b(),le.m(ie.value),le.is("disabled",ue.value),le.is("exceed",rr.value),{[le.b("group")]:y.prepend||y.append,[le.bm("group","append")]:y.append,[le.bm("group","prepend")]:y.prepend,[le.m("prefix")]:y.prefix||n.prefixIcon,[le.m("suffix")]:y.suffix||n.suffixIcon||n.clearable||n.showPassword,[le.bm("suffix","password-clear")]:Sr.value&&Er.value},g.class]),$=computed(()=>[le.e("wrapper"),le.is("focus",ir.value)]),L=useAttrs({excludeKeys:computed(()=>Object.keys(i.value))}),{form:V,formItem:z}=useFormItem(),{inputId:re}=useFormItemInputId(n,{formItemContext:z}),ie=useFormSize(),ue=useFormDisabled(),le=useNamespace("input"),oe=useNamespace("textarea"),ae=shallowRef(),qe=shallowRef(),de=ref(!1),Ne=ref(!1),ze=ref(!1),$e=ref(),Lt=shallowRef(n.inputStyle),jt=computed(()=>ae.value||qe.value),{wrapperRef:Et,isFocused:ir,handleFocus:dr,handleBlur:Dt}=useFocusController(jt,{afterBlur(){var Zr;n.validateEvent&&((Zr=z==null?void 0:z.validate)==null||Zr.call(z,"blur").catch(Nn=>void 0))}}),lr=computed(()=>{var Zr;return(Zr=V==null?void 0:V.statusIcon)!=null?Zr:!1}),sr=computed(()=>(z==null?void 0:z.validateState)||""),er=computed(()=>sr.value&&ValidateComponentsMap[sr.value]),cr=computed(()=>ze.value?view_default:hide_default),or=computed(()=>[g.style]),hr=computed(()=>[n.inputStyle,Lt.value,{resize:n.resize}]),pr=computed(()=>isNil(n.modelValue)?"":String(n.modelValue)),Sr=computed(()=>n.clearable&&!ue.value&&!n.readonly&&!!pr.value&&(ir.value||de.value)),Er=computed(()=>n.showPassword&&!ue.value&&!n.readonly&&!!pr.value&&(!!pr.value||ir.value)),Pr=computed(()=>n.showWordLimit&&!!n.maxlength&&(n.type==="text"||n.type==="textarea")&&!ue.value&&!n.readonly&&!n.showPassword),Cr=computed(()=>pr.value.length),rr=computed(()=>!!Pr.value&&Cr.value>Number(n.maxlength)),kr=computed(()=>!!y.suffix||!!n.suffixIcon||Sr.value||n.showPassword||Pr.value||!!sr.value&&lr.value),[Ir,xr]=useCursor(ae);useResizeObserver(qe,Zr=>{if(Or(),!Pr.value||n.resize!=="both")return;const Nn=Zr[0],{width:Qr}=Nn.contentRect;$e.value={right:`calc(100% - ${Qr+15+6}px)`}});const vr=()=>{const{type:Zr,autosize:Nn}=n;if(!(!isClient||Zr!=="textarea"||!qe.value))if(Nn){const Qr=isObject$2(Nn)?Nn.minRows:void 0,kn=isObject$2(Nn)?Nn.maxRows:void 0,Dn=calcTextareaHeight(qe.value,Qr,kn);Lt.value={overflowY:"hidden",...Dn},nextTick(()=>{qe.value.offsetHeight,Lt.value=Dn})}else Lt.value={minHeight:calcTextareaHeight(qe.value).minHeight}},Or=(Zr=>{let Nn=!1;return()=>{var Qr;if(Nn||!n.autosize)return;((Qr=qe.value)==null?void 0:Qr.offsetParent)===null||(Zr(),Nn=!0)}})(vr),Mr=()=>{const Zr=jt.value,Nn=n.formatter?n.formatter(pr.value):pr.value;!Zr||Zr.value===Nn||(Zr.value=Nn)},yr=async Zr=>{Ir();let{value:Nn}=Zr.target;if(n.formatter&&(Nn=n.parser?n.parser(Nn):Nn),!Ne.value){if(Nn===pr.value){Mr();return}e(UPDATE_MODEL_EVENT,Nn),e("input",Nn),await nextTick(),Mr(),xr()}},mr=Zr=>{e("change",Zr.target.value)},Tr=Zr=>{e("compositionstart",Zr),Ne.value=!0},Br=Zr=>{var Nn;e("compositionupdate",Zr);const Qr=(Nn=Zr.target)==null?void 0:Nn.value,kn=Qr[Qr.length-1]||"";Ne.value=!isKorean(kn)},$r=Zr=>{e("compositionend",Zr),Ne.value&&(Ne.value=!1,yr(Zr))},Lr=()=>{ze.value=!ze.value,Gr()},Gr=async()=>{var Zr;await nextTick(),(Zr=jt.value)==null||Zr.focus()},qr=()=>{var Zr;return(Zr=jt.value)==null?void 0:Zr.blur()},Yr=Zr=>{de.value=!1,e("mouseleave",Zr)},bn=Zr=>{de.value=!0,e("mouseenter",Zr)},wn=Zr=>{e("keydown",Zr)},Xr=()=>{var Zr;(Zr=jt.value)==null||Zr.select()},Vn=()=>{e(UPDATE_MODEL_EVENT,""),e("change",""),e("clear"),e("input","")};return watch(()=>n.modelValue,()=>{var Zr;nextTick(()=>vr()),n.validateEvent&&((Zr=z==null?void 0:z.validate)==null||Zr.call(z,"change").catch(Nn=>void 0))}),watch(pr,()=>Mr()),watch(()=>n.type,async()=>{await nextTick(),Mr(),vr()}),onMounted(()=>{!n.formatter&&n.parser,Mr(),nextTick(vr)}),r({input:ae,textarea:qe,ref:jt,textareaStyle:hr,autosize:toRef(n,"autosize"),focus:Gr,blur:qr,select:Xr,clear:Vn,resizeTextarea:vr}),(Zr,Nn)=>withDirectives((openBlock(),createElementBlock("div",mergeProps(unref(i),{class:unref(k),style:unref(or),role:Zr.containerRole,onMouseenter:bn,onMouseleave:Yr}),[createCommentVNode(" input "),Zr.type!=="textarea"?(openBlock(),createElementBlock(Fragment,{key:0},[createCommentVNode(" prepend slot "),Zr.$slots.prepend?(openBlock(),createElementBlock("div",{key:0,class:normalizeClass(unref(le).be("group","prepend"))},[renderSlot(Zr.$slots,"prepend")],2)):createCommentVNode("v-if",!0),createBaseVNode("div",{ref_key:"wrapperRef",ref:Et,class:normalizeClass(unref($))},[createCommentVNode(" prefix slot "),Zr.$slots.prefix||Zr.prefixIcon?(openBlock(),createElementBlock("span",{key:0,class:normalizeClass(unref(le).e("prefix"))},[createBaseVNode("span",{class:normalizeClass(unref(le).e("prefix-inner"))},[renderSlot(Zr.$slots,"prefix"),Zr.prefixIcon?(openBlock(),createBlock(unref(ElIcon),{key:0,class:normalizeClass(unref(le).e("icon"))},{default:withCtx(()=>[(openBlock(),createBlock(resolveDynamicComponent(Zr.prefixIcon)))]),_:1},8,["class"])):createCommentVNode("v-if",!0)],2)],2)):createCommentVNode("v-if",!0),createBaseVNode("input",mergeProps({id:unref(re),ref_key:"input",ref:ae,class:unref(le).e("inner")},unref(L),{minlength:Zr.minlength,maxlength:Zr.maxlength,type:Zr.showPassword?ze.value?"text":"password":Zr.type,disabled:unref(ue),readonly:Zr.readonly,autocomplete:Zr.autocomplete,tabindex:Zr.tabindex,"aria-label":Zr.label,placeholder:Zr.placeholder,style:Zr.inputStyle,form:Zr.form,autofocus:Zr.autofocus,onCompositionstart:Tr,onCompositionupdate:Br,onCompositionend:$r,onInput:yr,onFocus:Nn[0]||(Nn[0]=(...Qr)=>unref(dr)&&unref(dr)(...Qr)),onBlur:Nn[1]||(Nn[1]=(...Qr)=>unref(Dt)&&unref(Dt)(...Qr)),onChange:mr,onKeydown:wn}),null,16,_hoisted_2$l),createCommentVNode(" suffix slot "),unref(kr)?(openBlock(),createElementBlock("span",{key:1,class:normalizeClass(unref(le).e("suffix"))},[createBaseVNode("span",{class:normalizeClass(unref(le).e("suffix-inner"))},[!unref(Sr)||!unref(Er)||!unref(Pr)?(openBlock(),createElementBlock(Fragment,{key:0},[renderSlot(Zr.$slots,"suffix"),Zr.suffixIcon?(openBlock(),createBlock(unref(ElIcon),{key:0,class:normalizeClass(unref(le).e("icon"))},{default:withCtx(()=>[(openBlock(),createBlock(resolveDynamicComponent(Zr.suffixIcon)))]),_:1},8,["class"])):createCommentVNode("v-if",!0)],64)):createCommentVNode("v-if",!0),unref(Sr)?(openBlock(),createBlock(unref(ElIcon),{key:1,class:normalizeClass([unref(le).e("icon"),unref(le).e("clear")]),onMousedown:withModifiers(unref(NOOP),["prevent"]),onClick:Vn},{default:withCtx(()=>[createVNode(unref(circle_close_default))]),_:1},8,["class","onMousedown"])):createCommentVNode("v-if",!0),unref(Er)?(openBlock(),createBlock(unref(ElIcon),{key:2,class:normalizeClass([unref(le).e("icon"),unref(le).e("password")]),onClick:Lr},{default:withCtx(()=>[(openBlock(),createBlock(resolveDynamicComponent(unref(cr))))]),_:1},8,["class"])):createCommentVNode("v-if",!0),unref(Pr)?(openBlock(),createElementBlock("span",{key:3,class:normalizeClass(unref(le).e("count"))},[createBaseVNode("span",{class:normalizeClass(unref(le).e("count-inner"))},toDisplayString(unref(Cr))+" / "+toDisplayString(Zr.maxlength),3)],2)):createCommentVNode("v-if",!0),unref(sr)&&unref(er)&&unref(lr)?(openBlock(),createBlock(unref(ElIcon),{key:4,class:normalizeClass([unref(le).e("icon"),unref(le).e("validateIcon"),unref(le).is("loading",unref(sr)==="validating")])},{default:withCtx(()=>[(openBlock(),createBlock(resolveDynamicComponent(unref(er))))]),_:1},8,["class"])):createCommentVNode("v-if",!0)],2)],2)):createCommentVNode("v-if",!0)],2),createCommentVNode(" append slot "),Zr.$slots.append?(openBlock(),createElementBlock("div",{key:1,class:normalizeClass(unref(le).be("group","append"))},[renderSlot(Zr.$slots,"append")],2)):createCommentVNode("v-if",!0)],64)):(openBlock(),createElementBlock(Fragment,{key:1},[createCommentVNode(" textarea "),createBaseVNode("textarea",mergeProps({id:unref(re),ref_key:"textarea",ref:qe,class:unref(oe).e("inner")},unref(L),{minlength:Zr.minlength,maxlength:Zr.maxlength,tabindex:Zr.tabindex,disabled:unref(ue),readonly:Zr.readonly,autocomplete:Zr.autocomplete,style:unref(hr),"aria-label":Zr.label,placeholder:Zr.placeholder,form:Zr.form,autofocus:Zr.autofocus,onCompositionstart:Tr,onCompositionupdate:Br,onCompositionend:$r,onInput:yr,onFocus:Nn[2]||(Nn[2]=(...Qr)=>unref(dr)&&unref(dr)(...Qr)),onBlur:Nn[3]||(Nn[3]=(...Qr)=>unref(Dt)&&unref(Dt)(...Qr)),onChange:mr,onKeydown:wn}),null,16,_hoisted_3$c),unref(Pr)?(openBlock(),createElementBlock("span",{key:0,style:normalizeStyle($e.value),class:normalizeClass(unref(le).e("count"))},toDisplayString(unref(Cr))+" / "+toDisplayString(Zr.maxlength),7)):createCommentVNode("v-if",!0)],64))],16,_hoisted_1$y)),[[vShow,Zr.type!=="hidden"]])}});var Input=_export_sfc$1(_sfc_main$15,[["__file","input.vue"]]);const ElInput=withInstall(Input),GAP=4,BAR_MAP={vertical:{offset:"offsetHeight",scroll:"scrollTop",scrollSize:"scrollHeight",size:"height",key:"vertical",axis:"Y",client:"clientY",direction:"top"},horizontal:{offset:"offsetWidth",scroll:"scrollLeft",scrollSize:"scrollWidth",size:"width",key:"horizontal",axis:"X",client:"clientX",direction:"left"}},renderThumbStyle=({move:t,size:r,bar:e})=>({[e.size]:r,transform:`translate${e.axis}(${t}%)`}),scrollbarContextKey=Symbol("scrollbarContextKey"),thumbProps=buildProps({vertical:Boolean,size:String,move:Number,ratio:{type:Number,required:!0},always:Boolean}),COMPONENT_NAME$7="Thumb",_sfc_main$14=defineComponent({__name:"thumb",props:thumbProps,setup(t){const r=t,e=inject(scrollbarContextKey),n=useNamespace("scrollbar");e||throwError(COMPONENT_NAME$7,"can not inject scrollbar context");const g=ref(),y=ref(),i=ref({}),k=ref(!1);let $=!1,L=!1,V=isClient?document.onselectstart:null;const z=computed(()=>BAR_MAP[r.vertical?"vertical":"horizontal"]),re=computed(()=>renderThumbStyle({size:r.size,move:r.move,bar:z.value})),ie=computed(()=>g.value[z.value.offset]**2/e.wrapElement[z.value.scrollSize]/r.ratio/y.value[z.value.offset]),ue=$e=>{var Lt;if($e.stopPropagation(),$e.ctrlKey||[1,2].includes($e.button))return;(Lt=window.getSelection())==null||Lt.removeAllRanges(),oe($e);const jt=$e.currentTarget;jt&&(i.value[z.value.axis]=jt[z.value.offset]-($e[z.value.client]-jt.getBoundingClientRect()[z.value.direction]))},le=$e=>{if(!y.value||!g.value||!e.wrapElement)return;const Lt=Math.abs($e.target.getBoundingClientRect()[z.value.direction]-$e[z.value.client]),jt=y.value[z.value.offset]/2,Et=(Lt-jt)*100*ie.value/g.value[z.value.offset];e.wrapElement[z.value.scroll]=Et*e.wrapElement[z.value.scrollSize]/100},oe=$e=>{$e.stopImmediatePropagation(),$=!0,document.addEventListener("mousemove",ae),document.addEventListener("mouseup",qe),V=document.onselectstart,document.onselectstart=()=>!1},ae=$e=>{if(!g.value||!y.value||$===!1)return;const Lt=i.value[z.value.axis];if(!Lt)return;const jt=(g.value.getBoundingClientRect()[z.value.direction]-$e[z.value.client])*-1,Et=y.value[z.value.offset]-Lt,ir=(jt-Et)*100*ie.value/g.value[z.value.offset];e.wrapElement[z.value.scroll]=ir*e.wrapElement[z.value.scrollSize]/100},qe=()=>{$=!1,i.value[z.value.axis]=0,document.removeEventListener("mousemove",ae),document.removeEventListener("mouseup",qe),ze(),L&&(k.value=!1)},de=()=>{L=!1,k.value=!!r.size},Ne=()=>{L=!0,k.value=$};onBeforeUnmount(()=>{ze(),document.removeEventListener("mouseup",qe)});const ze=()=>{document.onselectstart!==V&&(document.onselectstart=V)};return useEventListener(toRef(e,"scrollbarElement"),"mousemove",de),useEventListener(toRef(e,"scrollbarElement"),"mouseleave",Ne),($e,Lt)=>(openBlock(),createBlock(Transition,{name:unref(n).b("fade"),persisted:""},{default:withCtx(()=>[withDirectives(createBaseVNode("div",{ref_key:"instance",ref:g,class:normalizeClass([unref(n).e("bar"),unref(n).is(unref(z).key)]),onMousedown:le},[createBaseVNode("div",{ref_key:"thumb",ref:y,class:normalizeClass(unref(n).e("thumb")),style:normalizeStyle(unref(re)),onMousedown:ue},null,38)],34),[[vShow,$e.always||k.value]])]),_:1},8,["name"]))}});var Thumb=_export_sfc$1(_sfc_main$14,[["__file","thumb.vue"]]);const barProps=buildProps({always:{type:Boolean,default:!0},minSize:{type:Number,required:!0}}),_sfc_main$13=defineComponent({__name:"bar",props:barProps,setup(t,{expose:r}){const e=t,n=inject(scrollbarContextKey),g=ref(0),y=ref(0),i=ref(""),k=ref(""),$=ref(1),L=ref(1);return r({handleScroll:re=>{if(re){const ie=re.offsetHeight-GAP,ue=re.offsetWidth-GAP;y.value=re.scrollTop*100/ie*$.value,g.value=re.scrollLeft*100/ue*L.value}},update:()=>{const re=n==null?void 0:n.wrapElement;if(!re)return;const ie=re.offsetHeight-GAP,ue=re.offsetWidth-GAP,le=ie**2/re.scrollHeight,oe=ue**2/re.scrollWidth,ae=Math.max(le,e.minSize),qe=Math.max(oe,e.minSize);$.value=le/(ie-le)/(ae/(ie-ae)),L.value=oe/(ue-oe)/(qe/(ue-qe)),k.value=ae+GAP<ie?`${ae}px`:"",i.value=qe+GAP<ue?`${qe}px`:""}}),(re,ie)=>(openBlock(),createElementBlock(Fragment,null,[createVNode(Thumb,{move:g.value,ratio:L.value,size:i.value,always:re.always},null,8,["move","ratio","size","always"]),createVNode(Thumb,{move:y.value,ratio:$.value,size:k.value,vertical:"",always:re.always},null,8,["move","ratio","size","always"])],64))}});var Bar=_export_sfc$1(_sfc_main$13,[["__file","bar.vue"]]);const scrollbarProps=buildProps({height:{type:[String,Number],default:""},maxHeight:{type:[String,Number],default:""},native:{type:Boolean,default:!1},wrapStyle:{type:definePropType([String,Object,Array]),default:""},wrapClass:{type:[String,Array],default:""},viewClass:{type:[String,Array],default:""},viewStyle:{type:[String,Array,Object],default:""},noresize:Boolean,tag:{type:String,default:"div"},always:Boolean,minSize:{type:Number,default:20},id:String,role:String,ariaLabel:String,ariaOrientation:{type:String,values:["horizontal","vertical"]}}),scrollbarEmits={scroll:({scrollTop:t,scrollLeft:r})=>[t,r].every(isNumber$1)},COMPONENT_NAME$6="ElScrollbar",__default__$F=defineComponent({name:COMPONENT_NAME$6}),_sfc_main$12=defineComponent({...__default__$F,props:scrollbarProps,emits:scrollbarEmits,setup(t,{expose:r,emit:e}){const n=t,g=useNamespace("scrollbar");let y,i;const k=ref(),$=ref(),L=ref(),V=ref(),z=computed(()=>{const de={};return n.height&&(de.height=addUnit(n.height)),n.maxHeight&&(de.maxHeight=addUnit(n.maxHeight)),[n.wrapStyle,de]}),re=computed(()=>[n.wrapClass,g.e("wrap"),{[g.em("wrap","hidden-default")]:!n.native}]),ie=computed(()=>[g.e("view"),n.viewClass]),ue=()=>{var de;$.value&&((de=V.value)==null||de.handleScroll($.value),e("scroll",{scrollTop:$.value.scrollTop,scrollLeft:$.value.scrollLeft}))};function le(de,Ne){isObject$2(de)?$.value.scrollTo(de):isNumber$1(de)&&isNumber$1(Ne)&&$.value.scrollTo(de,Ne)}const oe=de=>{isNumber$1(de)&&($.value.scrollTop=de)},ae=de=>{isNumber$1(de)&&($.value.scrollLeft=de)},qe=()=>{var de;(de=V.value)==null||de.update()};return watch(()=>n.noresize,de=>{de?(y==null||y(),i==null||i()):({stop:y}=useResizeObserver(L,qe),i=useEventListener("resize",qe))},{immediate:!0}),watch(()=>[n.maxHeight,n.height],()=>{n.native||nextTick(()=>{var de;qe(),$.value&&((de=V.value)==null||de.handleScroll($.value))})}),provide(scrollbarContextKey,reactive({scrollbarElement:k,wrapElement:$})),onMounted(()=>{n.native||nextTick(()=>{qe()})}),onUpdated(()=>qe()),r({wrapRef:$,update:qe,scrollTo:le,setScrollTop:oe,setScrollLeft:ae,handleScroll:ue}),(de,Ne)=>(openBlock(),createElementBlock("div",{ref_key:"scrollbarRef",ref:k,class:normalizeClass(unref(g).b())},[createBaseVNode("div",{ref_key:"wrapRef",ref:$,class:normalizeClass(unref(re)),style:normalizeStyle(unref(z)),onScroll:ue},[(openBlock(),createBlock(resolveDynamicComponent(de.tag),{id:de.id,ref_key:"resizeRef",ref:L,class:normalizeClass(unref(ie)),style:normalizeStyle(de.viewStyle),role:de.role,"aria-label":de.ariaLabel,"aria-orientation":de.ariaOrientation},{default:withCtx(()=>[renderSlot(de.$slots,"default")]),_:3},8,["id","class","style","role","aria-label","aria-orientation"]))],38),de.native?createCommentVNode("v-if",!0):(openBlock(),createBlock(Bar,{key:0,ref_key:"barRef",ref:V,always:de.always,"min-size":de.minSize},null,8,["always","min-size"]))],2))}});var Scrollbar=_export_sfc$1(_sfc_main$12,[["__file","scrollbar.vue"]]);const ElScrollbar=withInstall(Scrollbar),POPPER_INJECTION_KEY=Symbol("popper"),POPPER_CONTENT_INJECTION_KEY=Symbol("popperContent"),roleTypes=["dialog","grid","group","listbox","menu","navigation","tooltip","tree"],popperProps=buildProps({role:{type:String,values:roleTypes,default:"tooltip"}}),__default__$E=defineComponent({name:"ElPopper",inheritAttrs:!1}),_sfc_main$11=defineComponent({...__default__$E,props:popperProps,setup(t,{expose:r}){const e=t,n=ref(),g=ref(),y=ref(),i=ref(),k=computed(()=>e.role),$={triggerRef:n,popperInstanceRef:g,contentRef:y,referenceRef:i,role:k};return r($),provide(POPPER_INJECTION_KEY,$),(L,V)=>renderSlot(L.$slots,"default")}});var Popper=_export_sfc$1(_sfc_main$11,[["__file","popper.vue"]]);const popperArrowProps=buildProps({arrowOffset:{type:Number,default:5}}),__default__$D=defineComponent({name:"ElPopperArrow",inheritAttrs:!1}),_sfc_main$10=defineComponent({...__default__$D,props:popperArrowProps,setup(t,{expose:r}){const e=t,n=useNamespace("popper"),{arrowOffset:g,arrowRef:y,arrowStyle:i}=inject(POPPER_CONTENT_INJECTION_KEY,void 0);return watch(()=>e.arrowOffset,k=>{g.value=k}),onBeforeUnmount(()=>{y.value=void 0}),r({arrowRef:y}),(k,$)=>(openBlock(),createElementBlock("span",{ref_key:"arrowRef",ref:y,class:normalizeClass(unref(n).e("arrow")),style:normalizeStyle(unref(i)),"data-popper-arrow":""},null,6))}});var ElPopperArrow=_export_sfc$1(_sfc_main$10,[["__file","arrow.vue"]]);const NAME="ElOnlyChild",OnlyChild=defineComponent({name:NAME,setup(t,{slots:r,attrs:e}){var n;const g=inject(FORWARD_REF_INJECTION_KEY),y=useForwardRefDirective((n=g==null?void 0:g.setForwardRef)!=null?n:NOOP);return()=>{var i;const k=(i=r.default)==null?void 0:i.call(r,e);if(!k||k.length>1)return null;const $=findFirstLegitChild(k);return $?withDirectives(cloneVNode($,e),[[y]]):null}}});function findFirstLegitChild(t){if(!t)return null;const r=t;for(const e of r){if(isObject$2(e))switch(e.type){case Comment:continue;case Text:case"svg":return wrapTextContent(e);case Fragment:return findFirstLegitChild(e.children);default:return e}return wrapTextContent(e)}return null}function wrapTextContent(t){const r=useNamespace("only-child");return createVNode("span",{class:r.e("content")},[t])}const popperTriggerProps=buildProps({virtualRef:{type:definePropType(Object)},virtualTriggering:Boolean,onMouseenter:{type:definePropType(Function)},onMouseleave:{type:definePropType(Function)},onClick:{type:definePropType(Function)},onKeydown:{type:definePropType(Function)},onFocus:{type:definePropType(Function)},onBlur:{type:definePropType(Function)},onContextmenu:{type:definePropType(Function)},id:String,open:Boolean}),__default__$C=defineComponent({name:"ElPopperTrigger",inheritAttrs:!1}),_sfc_main$$=defineComponent({...__default__$C,props:popperTriggerProps,setup(t,{expose:r}){const e=t,{role:n,triggerRef:g}=inject(POPPER_INJECTION_KEY,void 0);useForwardRef(g);const y=computed(()=>k.value?e.id:void 0),i=computed(()=>{if(n&&n.value==="tooltip")return e.open&&e.id?e.id:void 0}),k=computed(()=>{if(n&&n.value!=="tooltip")return n.value}),$=computed(()=>k.value?`${e.open}`:void 0);let L;return onMounted(()=>{watch(()=>e.virtualRef,V=>{V&&(g.value=unrefElement(V))},{immediate:!0}),watch(g,(V,z)=>{L==null||L(),L=void 0,isElement(V)&&(["onMouseenter","onMouseleave","onClick","onKeydown","onFocus","onBlur","onContextmenu"].forEach(re=>{var ie;const ue=e[re];ue&&(V.addEventListener(re.slice(2).toLowerCase(),ue),(ie=z==null?void 0:z.removeEventListener)==null||ie.call(z,re.slice(2).toLowerCase(),ue))}),L=watch([y,i,k,$],re=>{["aria-controls","aria-describedby","aria-haspopup","aria-expanded"].forEach((ie,ue)=>{isNil(re[ue])?V.removeAttribute(ie):V.setAttribute(ie,re[ue])})},{immediate:!0})),isElement(z)&&["aria-controls","aria-describedby","aria-haspopup","aria-expanded"].forEach(re=>z.removeAttribute(re))},{immediate:!0})}),onBeforeUnmount(()=>{L==null||L(),L=void 0}),r({triggerRef:g}),(V,z)=>V.virtualTriggering?createCommentVNode("v-if",!0):(openBlock(),createBlock(unref(OnlyChild),mergeProps({key:0},V.$attrs,{"aria-controls":unref(y),"aria-describedby":unref(i),"aria-expanded":unref($),"aria-haspopup":unref(k)}),{default:withCtx(()=>[renderSlot(V.$slots,"default")]),_:3},16,["aria-controls","aria-describedby","aria-expanded","aria-haspopup"]))}});var ElPopperTrigger=_export_sfc$1(_sfc_main$$,[["__file","trigger.vue"]]);const FOCUS_AFTER_TRAPPED="focus-trap.focus-after-trapped",FOCUS_AFTER_RELEASED="focus-trap.focus-after-released",FOCUSOUT_PREVENTED="focus-trap.focusout-prevented",FOCUS_AFTER_TRAPPED_OPTS={cancelable:!0,bubbles:!1},FOCUSOUT_PREVENTED_OPTS={cancelable:!0,bubbles:!1},ON_TRAP_FOCUS_EVT="focusAfterTrapped",ON_RELEASE_FOCUS_EVT="focusAfterReleased",FOCUS_TRAP_INJECTION_KEY=Symbol("elFocusTrap"),focusReason=ref(),lastUserFocusTimestamp=ref(0),lastAutomatedFocusTimestamp=ref(0);let focusReasonUserCount=0;const obtainAllFocusableElements=t=>{const r=[],e=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,{acceptNode:n=>{const g=n.tagName==="INPUT"&&n.type==="hidden";return n.disabled||n.hidden||g?NodeFilter.FILTER_SKIP:n.tabIndex>=0||n===document.activeElement?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;e.nextNode();)r.push(e.currentNode);return r},getVisibleElement=(t,r)=>{for(const e of t)if(!isHidden(e,r))return e},isHidden=(t,r)=>{if(getComputedStyle(t).visibility==="hidden")return!0;for(;t;){if(r&&t===r)return!1;if(getComputedStyle(t).display==="none")return!0;t=t.parentElement}return!1},getEdges=t=>{const r=obtainAllFocusableElements(t),e=getVisibleElement(r,t),n=getVisibleElement(r.reverse(),t);return[e,n]},isSelectable=t=>t instanceof HTMLInputElement&&"select"in t,tryFocus=(t,r)=>{if(t&&t.focus){const e=document.activeElement;t.focus({preventScroll:!0}),lastAutomatedFocusTimestamp.value=window.performance.now(),t!==e&&isSelectable(t)&&r&&t.select()}};function removeFromStack(t,r){const e=[...t],n=t.indexOf(r);return n!==-1&&e.splice(n,1),e}const createFocusableStack=()=>{let t=[];return{push:n=>{const g=t[0];g&&n!==g&&g.pause(),t=removeFromStack(t,n),t.unshift(n)},remove:n=>{var g,y;t=removeFromStack(t,n),(y=(g=t[0])==null?void 0:g.resume)==null||y.call(g)}}},focusFirstDescendant=(t,r=!1)=>{const e=document.activeElement;for(const n of t)if(tryFocus(n,r),document.activeElement!==e)return},focusableStack=createFocusableStack(),isFocusCausedByUserEvent=()=>lastUserFocusTimestamp.value>lastAutomatedFocusTimestamp.value,notifyFocusReasonPointer=()=>{focusReason.value="pointer",lastUserFocusTimestamp.value=window.performance.now()},notifyFocusReasonKeydown=()=>{focusReason.value="keyboard",lastUserFocusTimestamp.value=window.performance.now()},useFocusReason=()=>(onMounted(()=>{focusReasonUserCount===0&&(document.addEventListener("mousedown",notifyFocusReasonPointer),document.addEventListener("touchstart",notifyFocusReasonPointer),document.addEventListener("keydown",notifyFocusReasonKeydown)),focusReasonUserCount++}),onBeforeUnmount(()=>{focusReasonUserCount--,focusReasonUserCount<=0&&(document.removeEventListener("mousedown",notifyFocusReasonPointer),document.removeEventListener("touchstart",notifyFocusReasonPointer),document.removeEventListener("keydown",notifyFocusReasonKeydown))}),{focusReason,lastUserFocusTimestamp,lastAutomatedFocusTimestamp}),createFocusOutPreventedEvent=t=>new CustomEvent(FOCUSOUT_PREVENTED,{...FOCUSOUT_PREVENTED_OPTS,detail:t}),_sfc_main$_=defineComponent({name:"ElFocusTrap",inheritAttrs:!1,props:{loop:Boolean,trapped:Boolean,focusTrapEl:Object,focusStartEl:{type:[Object,String],default:"first"}},emits:[ON_TRAP_FOCUS_EVT,ON_RELEASE_FOCUS_EVT,"focusin","focusout","focusout-prevented","release-requested"],setup(t,{emit:r}){const e=ref();let n,g;const{focusReason:y}=useFocusReason();useEscapeKeydown(ue=>{t.trapped&&!i.paused&&r("release-requested",ue)});const i={paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}},k=ue=>{if(!t.loop&&!t.trapped||i.paused)return;const{key:le,altKey:oe,ctrlKey:ae,metaKey:qe,currentTarget:de,shiftKey:Ne}=ue,{loop:ze}=t,$e=le===EVENT_CODE.tab&&!oe&&!ae&&!qe,Lt=document.activeElement;if($e&&Lt){const jt=de,[Et,ir]=getEdges(jt);if(Et&&ir){if(!Ne&&Lt===ir){const Dt=createFocusOutPreventedEvent({focusReason:y.value});r("focusout-prevented",Dt),Dt.defaultPrevented||(ue.preventDefault(),ze&&tryFocus(Et,!0))}else if(Ne&&[Et,jt].includes(Lt)){const Dt=createFocusOutPreventedEvent({focusReason:y.value});r("focusout-prevented",Dt),Dt.defaultPrevented||(ue.preventDefault(),ze&&tryFocus(ir,!0))}}else if(Lt===jt){const Dt=createFocusOutPreventedEvent({focusReason:y.value});r("focusout-prevented",Dt),Dt.defaultPrevented||ue.preventDefault()}}};provide(FOCUS_TRAP_INJECTION_KEY,{focusTrapRef:e,onKeydown:k}),watch(()=>t.focusTrapEl,ue=>{ue&&(e.value=ue)},{immediate:!0}),watch([e],([ue],[le])=>{ue&&(ue.addEventListener("keydown",k),ue.addEventListener("focusin",V),ue.addEventListener("focusout",z)),le&&(le.removeEventListener("keydown",k),le.removeEventListener("focusin",V),le.removeEventListener("focusout",z))});const $=ue=>{r(ON_TRAP_FOCUS_EVT,ue)},L=ue=>r(ON_RELEASE_FOCUS_EVT,ue),V=ue=>{const le=unref(e);if(!le)return;const oe=ue.target,ae=ue.relatedTarget,qe=oe&&le.contains(oe);t.trapped||ae&&le.contains(ae)||(n=ae),qe&&r("focusin",ue),!i.paused&&t.trapped&&(qe?g=oe:tryFocus(g,!0))},z=ue=>{const le=unref(e);if(!(i.paused||!le))if(t.trapped){const oe=ue.relatedTarget;!isNil(oe)&&!le.contains(oe)&&setTimeout(()=>{if(!i.paused&&t.trapped){const ae=createFocusOutPreventedEvent({focusReason:y.value});r("focusout-prevented",ae),ae.defaultPrevented||tryFocus(g,!0)}},0)}else{const oe=ue.target;oe&&le.contains(oe)||r("focusout",ue)}};async function re(){await nextTick();const ue=unref(e);if(ue){focusableStack.push(i);const le=ue.contains(document.activeElement)?n:document.activeElement;if(n=le,!ue.contains(le)){const ae=new Event(FOCUS_AFTER_TRAPPED,FOCUS_AFTER_TRAPPED_OPTS);ue.addEventListener(FOCUS_AFTER_TRAPPED,$),ue.dispatchEvent(ae),ae.defaultPrevented||nextTick(()=>{let qe=t.focusStartEl;isString$2(qe)||(tryFocus(qe),document.activeElement!==qe&&(qe="first")),qe==="first"&&focusFirstDescendant(obtainAllFocusableElements(ue),!0),(document.activeElement===le||qe==="container")&&tryFocus(ue)})}}}function ie(){const ue=unref(e);if(ue){ue.removeEventListener(FOCUS_AFTER_TRAPPED,$);const le=new CustomEvent(FOCUS_AFTER_RELEASED,{...FOCUS_AFTER_TRAPPED_OPTS,detail:{focusReason:y.value}});ue.addEventListener(FOCUS_AFTER_RELEASED,L),ue.dispatchEvent(le),!le.defaultPrevented&&(y.value=="keyboard"||!isFocusCausedByUserEvent()||ue.contains(document.activeElement))&&tryFocus(n??document.body),ue.removeEventListener(FOCUS_AFTER_RELEASED,L),focusableStack.remove(i)}}return onMounted(()=>{t.trapped&&re(),watch(()=>t.trapped,ue=>{ue?re():ie()})}),onBeforeUnmount(()=>{t.trapped&&ie()}),{onKeydown:k}}});function _sfc_render$9(t,r,e,n,g,y){return renderSlot(t.$slots,"default",{handleKeydown:t.onKeydown})}var ElFocusTrap=_export_sfc$1(_sfc_main$_,[["render",_sfc_render$9],["__file","focus-trap.vue"]]);const POSITIONING_STRATEGIES=["fixed","absolute"],popperCoreConfigProps=buildProps({boundariesPadding:{type:Number,default:0},fallbackPlacements:{type:definePropType(Array),default:void 0},gpuAcceleration:{type:Boolean,default:!0},offset:{type:Number,default:12},placement:{type:String,values:Ee,default:"bottom"},popperOptions:{type:definePropType(Object),default:()=>({})},strategy:{type:String,values:POSITIONING_STRATEGIES,default:"absolute"}}),popperContentProps=buildProps({...popperCoreConfigProps,id:String,style:{type:definePropType([String,Array,Object])},className:{type:definePropType([String,Array,Object])},effect:{type:String,default:"dark"},visible:Boolean,enterable:{type:Boolean,default:!0},pure:Boolean,focusOnShow:{type:Boolean,default:!1},trapping:{type:Boolean,default:!1},popperClass:{type:definePropType([String,Array,Object])},popperStyle:{type:definePropType([String,Array,Object])},referenceEl:{type:definePropType(Object)},triggerTargetEl:{type:definePropType(Object)},stopPopperMouseEvent:{type:Boolean,default:!0},ariaLabel:{type:String,default:void 0},virtualTriggering:Boolean,zIndex:Number}),popperContentEmits={mouseenter:t=>t instanceof MouseEvent,mouseleave:t=>t instanceof MouseEvent,focus:()=>!0,blur:()=>!0,close:()=>!0},buildPopperOptions=(t,r=[])=>{const{placement:e,strategy:n,popperOptions:g}=t,y={placement:e,strategy:n,...g,modifiers:[...genModifiers(t),...r]};return deriveExtraModifiers(y,g==null?void 0:g.modifiers),y},unwrapMeasurableEl=t=>{if(isClient)return unrefElement(t)};function genModifiers(t){const{offset:r,gpuAcceleration:e,fallbackPlacements:n}=t;return[{name:"offset",options:{offset:[0,r??12]}},{name:"preventOverflow",options:{padding:{top:2,bottom:2,left:5,right:5}}},{name:"flip",options:{padding:5,fallbackPlacements:n}},{name:"computeStyles",options:{gpuAcceleration:e}}]}function deriveExtraModifiers(t,r){r&&(t.modifiers=[...t.modifiers,...r??[]])}const DEFAULT_ARROW_OFFSET=0,usePopperContent=t=>{const{popperInstanceRef:r,contentRef:e,triggerRef:n,role:g}=inject(POPPER_INJECTION_KEY,void 0),y=ref(),i=ref(),k=computed(()=>({name:"eventListeners",enabled:!!t.visible})),$=computed(()=>{var ae;const qe=unref(y),de=(ae=unref(i))!=null?ae:DEFAULT_ARROW_OFFSET;return{name:"arrow",enabled:!isUndefined$2(qe),options:{element:qe,padding:de}}}),L=computed(()=>({onFirstUpdate:()=>{ue()},...buildPopperOptions(t,[unref($),unref(k)])})),V=computed(()=>unwrapMeasurableEl(t.referenceEl)||unref(n)),{attributes:z,state:re,styles:ie,update:ue,forceUpdate:le,instanceRef:oe}=usePopper(V,e,L);return watch(oe,ae=>r.value=ae),onMounted(()=>{watch(()=>{var ae;return(ae=unref(V))==null?void 0:ae.getBoundingClientRect()},()=>{ue()})}),{attributes:z,arrowRef:y,contentRef:e,instanceRef:oe,state:re,styles:ie,role:g,forceUpdate:le,update:ue}},usePopperContentDOM=(t,{attributes:r,styles:e,role:n})=>{const{nextZIndex:g}=useZIndex(),y=useNamespace("popper"),i=computed(()=>unref(r).popper),k=ref(isNumber$1(t.zIndex)?t.zIndex:g()),$=computed(()=>[y.b(),y.is("pure",t.pure),y.is(t.effect),t.popperClass]),L=computed(()=>[{zIndex:unref(k)},unref(e).popper,t.popperStyle||{}]),V=computed(()=>n.value==="dialog"?"false":void 0),z=computed(()=>unref(e).arrow||{});return{ariaModal:V,arrowStyle:z,contentAttrs:i,contentClass:$,contentStyle:L,contentZIndex:k,updateZIndex:()=>{k.value=isNumber$1(t.zIndex)?t.zIndex:g()}}},usePopperContentFocusTrap=(t,r)=>{const e=ref(!1),n=ref();return{focusStartRef:n,trapped:e,onFocusAfterReleased:L=>{var V;((V=L.detail)==null?void 0:V.focusReason)!=="pointer"&&(n.value="first",r("blur"))},onFocusAfterTrapped:()=>{r("focus")},onFocusInTrap:L=>{t.visible&&!e.value&&(L.target&&(n.value=L.target),e.value=!0)},onFocusoutPrevented:L=>{t.trapping||(L.detail.focusReason==="pointer"&&L.preventDefault(),e.value=!1)},onReleaseRequested:()=>{e.value=!1,r("close")}}},__default__$B=defineComponent({name:"ElPopperContent"}),_sfc_main$Z=defineComponent({...__default__$B,props:popperContentProps,emits:popperContentEmits,setup(t,{expose:r,emit:e}){const n=t,{focusStartRef:g,trapped:y,onFocusAfterReleased:i,onFocusAfterTrapped:k,onFocusInTrap:$,onFocusoutPrevented:L,onReleaseRequested:V}=usePopperContentFocusTrap(n,e),{attributes:z,arrowRef:re,contentRef:ie,styles:ue,instanceRef:le,role:oe,update:ae}=usePopperContent(n),{ariaModal:qe,arrowStyle:de,contentAttrs:Ne,contentClass:ze,contentStyle:$e,updateZIndex:Lt}=usePopperContentDOM(n,{styles:ue,attributes:z,role:oe}),jt=inject(formItemContextKey,void 0),Et=ref();provide(POPPER_CONTENT_INJECTION_KEY,{arrowStyle:de,arrowRef:re,arrowOffset:Et}),jt&&(jt.addInputId||jt.removeInputId)&&provide(formItemContextKey,{...jt,addInputId:NOOP,removeInputId:NOOP});let ir;const dr=(lr=!0)=>{ae(),lr&&Lt()},Dt=()=>{dr(!1),n.visible&&n.focusOnShow?y.value=!0:n.visible===!1&&(y.value=!1)};return onMounted(()=>{watch(()=>n.triggerTargetEl,(lr,sr)=>{ir==null||ir(),ir=void 0;const er=unref(lr||ie.value),cr=unref(sr||ie.value);isElement(er)&&(ir=watch([oe,()=>n.ariaLabel,qe,()=>n.id],or=>{["role","aria-label","aria-modal","id"].forEach((hr,pr)=>{isNil(or[pr])?er.removeAttribute(hr):er.setAttribute(hr,or[pr])})},{immediate:!0})),cr!==er&&isElement(cr)&&["role","aria-label","aria-modal","id"].forEach(or=>{cr.removeAttribute(or)})},{immediate:!0}),watch(()=>n.visible,Dt,{immediate:!0})}),onBeforeUnmount(()=>{ir==null||ir(),ir=void 0}),r({popperContentRef:ie,popperInstanceRef:le,updatePopper:dr,contentStyle:$e}),(lr,sr)=>(openBlock(),createElementBlock("div",mergeProps({ref_key:"contentRef",ref:ie},unref(Ne),{style:unref($e),class:unref(ze),tabindex:"-1",onMouseenter:sr[0]||(sr[0]=er=>lr.$emit("mouseenter",er)),onMouseleave:sr[1]||(sr[1]=er=>lr.$emit("mouseleave",er))}),[createVNode(unref(ElFocusTrap),{trapped:unref(y),"trap-on-focus-in":!0,"focus-trap-el":unref(ie),"focus-start-el":unref(g),onFocusAfterTrapped:unref(k),onFocusAfterReleased:unref(i),onFocusin:unref($),onFocusoutPrevented:unref(L),onReleaseRequested:unref(V)},{default:withCtx(()=>[renderSlot(lr.$slots,"default")]),_:3},8,["trapped","focus-trap-el","focus-start-el","onFocusAfterTrapped","onFocusAfterReleased","onFocusin","onFocusoutPrevented","onReleaseRequested"])],16))}});var ElPopperContent=_export_sfc$1(_sfc_main$Z,[["__file","content.vue"]]);const ElPopper=withInstall(Popper),TOOLTIP_INJECTION_KEY=Symbol("elTooltip"),useTooltipContentProps=buildProps({...useDelayedToggleProps,...popperContentProps,appendTo:{type:definePropType([String,Object])},content:{type:String,default:""},rawContent:{type:Boolean,default:!1},persistent:Boolean,ariaLabel:String,visible:{type:definePropType(Boolean),default:null},transition:String,teleported:{type:Boolean,default:!0},disabled:Boolean}),useTooltipTriggerProps=buildProps({...popperTriggerProps,disabled:Boolean,trigger:{type:definePropType([String,Array]),default:"hover"},triggerKeys:{type:definePropType(Array),default:()=>[EVENT_CODE.enter,EVENT_CODE.space]}}),{useModelToggleProps:useTooltipModelToggleProps,useModelToggleEmits:useTooltipModelToggleEmits,useModelToggle:useTooltipModelToggle}=createModelToggleComposable("visible"),useTooltipProps=buildProps({...popperProps,...useTooltipModelToggleProps,...useTooltipContentProps,...useTooltipTriggerProps,...popperArrowProps,showArrow:{type:Boolean,default:!0}}),tooltipEmits=[...useTooltipModelToggleEmits,"before-show","before-hide","show","hide","open","close"],isTriggerType=(t,r)=>isArray$3(t)?t.includes(r):t===r,whenTrigger=(t,r,e)=>n=>{isTriggerType(unref(t),r)&&e(n)},__default__$A=defineComponent({name:"ElTooltipTrigger"}),_sfc_main$Y=defineComponent({...__default__$A,props:useTooltipTriggerProps,setup(t,{expose:r}){const e=t,n=useNamespace("tooltip"),{controlled:g,id:y,open:i,onOpen:k,onClose:$,onToggle:L}=inject(TOOLTIP_INJECTION_KEY,void 0),V=ref(null),z=()=>{if(unref(g)||e.disabled)return!0},re=toRef(e,"trigger"),ie=composeEventHandlers(z,whenTrigger(re,"hover",k)),ue=composeEventHandlers(z,whenTrigger(re,"hover",$)),le=composeEventHandlers(z,whenTrigger(re,"click",Ne=>{Ne.button===0&&L(Ne)})),oe=composeEventHandlers(z,whenTrigger(re,"focus",k)),ae=composeEventHandlers(z,whenTrigger(re,"focus",$)),qe=composeEventHandlers(z,whenTrigger(re,"contextmenu",Ne=>{Ne.preventDefault(),L(Ne)})),de=composeEventHandlers(z,Ne=>{const{code:ze}=Ne;e.triggerKeys.includes(ze)&&(Ne.preventDefault(),L(Ne))});return r({triggerRef:V}),(Ne,ze)=>(openBlock(),createBlock(unref(ElPopperTrigger),{id:unref(y),"virtual-ref":Ne.virtualRef,open:unref(i),"virtual-triggering":Ne.virtualTriggering,class:normalizeClass(unref(n).e("trigger")),onBlur:unref(ae),onClick:unref(le),onContextmenu:unref(qe),onFocus:unref(oe),onMouseenter:unref(ie),onMouseleave:unref(ue),onKeydown:unref(de)},{default:withCtx(()=>[renderSlot(Ne.$slots,"default")]),_:3},8,["id","virtual-ref","open","virtual-triggering","class","onBlur","onClick","onContextmenu","onFocus","onMouseenter","onMouseleave","onKeydown"]))}});var ElTooltipTrigger=_export_sfc$1(_sfc_main$Y,[["__file","trigger.vue"]]);const __default__$z=defineComponent({name:"ElTooltipContent",inheritAttrs:!1}),_sfc_main$X=defineComponent({...__default__$z,props:useTooltipContentProps,setup(t,{expose:r}){const e=t,{selector:n}=usePopperContainerId(),g=useNamespace("tooltip"),y=ref(null),i=ref(!1),{controlled:k,id:$,open:L,trigger:V,onClose:z,onOpen:re,onShow:ie,onHide:ue,onBeforeShow:le,onBeforeHide:oe}=inject(TOOLTIP_INJECTION_KEY,void 0),ae=computed(()=>e.transition||`${g.namespace.value}-fade-in-linear`),qe=computed(()=>e.persistent);onBeforeUnmount(()=>{i.value=!0});const de=computed(()=>unref(qe)?!0:unref(L)),Ne=computed(()=>e.disabled?!1:unref(L)),ze=computed(()=>e.appendTo||n.value),$e=computed(()=>{var or;return(or=e.style)!=null?or:{}}),Lt=computed(()=>!unref(L)),jt=()=>{ue()},Et=()=>{if(unref(k))return!0},ir=composeEventHandlers(Et,()=>{e.enterable&&unref(V)==="hover"&&re()}),dr=composeEventHandlers(Et,()=>{unref(V)==="hover"&&z()}),Dt=()=>{var or,hr;(hr=(or=y.value)==null?void 0:or.updatePopper)==null||hr.call(or),le==null||le()},lr=()=>{oe==null||oe()},sr=()=>{ie(),cr=onClickOutside(computed(()=>{var or;return(or=y.value)==null?void 0:or.popperContentRef}),()=>{if(unref(k))return;unref(V)!=="hover"&&z()})},er=()=>{e.virtualTriggering||z()};let cr;return watch(()=>unref(L),or=>{or||cr==null||cr()},{flush:"post"}),watch(()=>e.content,()=>{var or,hr;(hr=(or=y.value)==null?void 0:or.updatePopper)==null||hr.call(or)}),r({contentRef:y}),(or,hr)=>(openBlock(),createBlock(Teleport,{disabled:!or.teleported,to:unref(ze)},[createVNode(Transition,{name:unref(ae),onAfterLeave:jt,onBeforeEnter:Dt,onAfterEnter:sr,onBeforeLeave:lr},{default:withCtx(()=>[unref(de)?withDirectives((openBlock(),createBlock(unref(ElPopperContent),mergeProps({key:0,id:unref($),ref_key:"contentRef",ref:y},or.$attrs,{"aria-label":or.ariaLabel,"aria-hidden":unref(Lt),"boundaries-padding":or.boundariesPadding,"fallback-placements":or.fallbackPlacements,"gpu-acceleration":or.gpuAcceleration,offset:or.offset,placement:or.placement,"popper-options":or.popperOptions,strategy:or.strategy,effect:or.effect,enterable:or.enterable,pure:or.pure,"popper-class":or.popperClass,"popper-style":[or.popperStyle,unref($e)],"reference-el":or.referenceEl,"trigger-target-el":or.triggerTargetEl,visible:unref(Ne),"z-index":or.zIndex,onMouseenter:unref(ir),onMouseleave:unref(dr),onBlur:er,onClose:unref(z)}),{default:withCtx(()=>[i.value?createCommentVNode("v-if",!0):renderSlot(or.$slots,"default",{key:0})]),_:3},16,["id","aria-label","aria-hidden","boundaries-padding","fallback-placements","gpu-acceleration","offset","placement","popper-options","strategy","effect","enterable","pure","popper-class","popper-style","reference-el","trigger-target-el","visible","z-index","onMouseenter","onMouseleave","onClose"])),[[vShow,unref(Ne)]]):createCommentVNode("v-if",!0)]),_:3},8,["name"])],8,["disabled","to"]))}});var ElTooltipContent=_export_sfc$1(_sfc_main$X,[["__file","content.vue"]]);const _hoisted_1$x=["innerHTML"],_hoisted_2$k={key:1},__default__$y=defineComponent({name:"ElTooltip"}),_sfc_main$W=defineComponent({...__default__$y,props:useTooltipProps,emits:tooltipEmits,setup(t,{expose:r,emit:e}){const n=t;usePopperContainer();const g=useId(),y=ref(),i=ref(),k=()=>{var ae;const qe=unref(y);qe&&((ae=qe.popperInstanceRef)==null||ae.update())},$=ref(!1),L=ref(),{show:V,hide:z,hasUpdateHandler:re}=useTooltipModelToggle({indicator:$,toggleReason:L}),{onOpen:ie,onClose:ue}=useDelayedToggle({showAfter:toRef(n,"showAfter"),hideAfter:toRef(n,"hideAfter"),autoClose:toRef(n,"autoClose"),open:V,close:z}),le=computed(()=>isBoolean$1(n.visible)&&!re.value);provide(TOOLTIP_INJECTION_KEY,{controlled:le,id:g,open:readonly($),trigger:toRef(n,"trigger"),onOpen:ae=>{ie(ae)},onClose:ae=>{ue(ae)},onToggle:ae=>{unref($)?ue(ae):ie(ae)},onShow:()=>{e("show",L.value)},onHide:()=>{e("hide",L.value)},onBeforeShow:()=>{e("before-show",L.value)},onBeforeHide:()=>{e("before-hide",L.value)},updatePopper:k}),watch(()=>n.disabled,ae=>{ae&&$.value&&($.value=!1)});const oe=ae=>{var qe,de;const Ne=(de=(qe=i.value)==null?void 0:qe.contentRef)==null?void 0:de.popperContentRef,ze=(ae==null?void 0:ae.relatedTarget)||document.activeElement;return Ne&&Ne.contains(ze)};return onDeactivated(()=>$.value&&z()),r({popperRef:y,contentRef:i,isFocusInsideContent:oe,updatePopper:k,onOpen:ie,onClose:ue,hide:z}),(ae,qe)=>(openBlock(),createBlock(unref(ElPopper),{ref_key:"popperRef",ref:y,role:ae.role},{default:withCtx(()=>[createVNode(ElTooltipTrigger,{disabled:ae.disabled,trigger:ae.trigger,"trigger-keys":ae.triggerKeys,"virtual-ref":ae.virtualRef,"virtual-triggering":ae.virtualTriggering},{default:withCtx(()=>[ae.$slots.default?renderSlot(ae.$slots,"default",{key:0}):createCommentVNode("v-if",!0)]),_:3},8,["disabled","trigger","trigger-keys","virtual-ref","virtual-triggering"]),createVNode(ElTooltipContent,{ref_key:"contentRef",ref:i,"aria-label":ae.ariaLabel,"boundaries-padding":ae.boundariesPadding,content:ae.content,disabled:ae.disabled,effect:ae.effect,enterable:ae.enterable,"fallback-placements":ae.fallbackPlacements,"hide-after":ae.hideAfter,"gpu-acceleration":ae.gpuAcceleration,offset:ae.offset,persistent:ae.persistent,"popper-class":ae.popperClass,"popper-style":ae.popperStyle,placement:ae.placement,"popper-options":ae.popperOptions,pure:ae.pure,"raw-content":ae.rawContent,"reference-el":ae.referenceEl,"trigger-target-el":ae.triggerTargetEl,"show-after":ae.showAfter,strategy:ae.strategy,teleported:ae.teleported,transition:ae.transition,"virtual-triggering":ae.virtualTriggering,"z-index":ae.zIndex,"append-to":ae.appendTo},{default:withCtx(()=>[renderSlot(ae.$slots,"content",{},()=>[ae.rawContent?(openBlock(),createElementBlock("span",{key:0,innerHTML:ae.content},null,8,_hoisted_1$x)):(openBlock(),createElementBlock("span",_hoisted_2$k,toDisplayString(ae.content),1))]),ae.showArrow?(openBlock(),createBlock(unref(ElPopperArrow),{key:0,"arrow-offset":ae.arrowOffset},null,8,["arrow-offset"])):createCommentVNode("v-if",!0)]),_:3},8,["aria-label","boundaries-padding","content","disabled","effect","enterable","fallback-placements","hide-after","gpu-acceleration","offset","persistent","popper-class","popper-style","placement","popper-options","pure","raw-content","reference-el","trigger-target-el","show-after","strategy","teleported","transition","virtual-triggering","z-index","append-to"])]),_:3},8,["role"]))}});var Tooltip=_export_sfc$1(_sfc_main$W,[["__file","tooltip.vue"]]);const ElTooltip=withInstall(Tooltip),avatarProps=buildProps({size:{type:[Number,String],values:componentSizes,default:"",validator:t=>isNumber$1(t)},shape:{type:String,values:["circle","square"],default:"circle"},icon:{type:iconPropType},src:{type:String,default:""},alt:String,srcSet:String,fit:{type:definePropType(String),default:"cover"}}),avatarEmits={error:t=>t instanceof Event},_hoisted_1$w=["src","alt","srcset"],__default__$x=defineComponent({name:"ElAvatar"}),_sfc_main$V=defineComponent({...__default__$x,props:avatarProps,emits:avatarEmits,setup(t,{emit:r}){const e=t,n=useNamespace("avatar"),g=ref(!1),y=computed(()=>{const{size:L,icon:V,shape:z}=e,re=[n.b()];return isString$2(L)&&re.push(n.m(L)),V&&re.push(n.m("icon")),z&&re.push(n.m(z)),re}),i=computed(()=>{const{size:L}=e;return isNumber$1(L)?n.cssVarBlock({size:addUnit(L)||""}):void 0}),k=computed(()=>({objectFit:e.fit}));watch(()=>e.src,()=>g.value=!1);function $(L){g.value=!0,r("error",L)}return(L,V)=>(openBlock(),createElementBlock("span",{class:normalizeClass(unref(y)),style:normalizeStyle(unref(i))},[(L.src||L.srcSet)&&!g.value?(openBlock(),createElementBlock("img",{key:0,src:L.src,alt:L.alt,srcset:L.srcSet,style:normalizeStyle(unref(k)),onError:$},null,44,_hoisted_1$w)):L.icon?(openBlock(),createBlock(unref(ElIcon),{key:1},{default:withCtx(()=>[(openBlock(),createBlock(resolveDynamicComponent(L.icon)))]),_:1})):renderSlot(L.$slots,"default",{key:2})],6))}});var Avatar=_export_sfc$1(_sfc_main$V,[["__file","avatar.vue"]]);const ElAvatar=withInstall(Avatar),badgeProps=buildProps({value:{type:[String,Number],default:""},max:{type:Number,default:99},isDot:Boolean,hidden:Boolean,type:{type:String,values:["primary","success","warning","info","danger"],default:"danger"}}),_hoisted_1$v=["textContent"],__default__$w=defineComponent({name:"ElBadge"}),_sfc_main$U=defineComponent({...__default__$w,props:badgeProps,setup(t,{expose:r}){const e=t,n=useNamespace("badge"),g=computed(()=>e.isDot?"":isNumber$1(e.value)&&isNumber$1(e.max)?e.max<e.value?`${e.max}+`:`${e.value}`:`${e.value}`);return r({content:g}),(y,i)=>(openBlock(),createElementBlock("div",{class:normalizeClass(unref(n).b())},[renderSlot(y.$slots,"default"),createVNode(Transition,{name:`${unref(n).namespace.value}-zoom-in-center`,persisted:""},{default:withCtx(()=>[withDirectives(createBaseVNode("sup",{class:normalizeClass([unref(n).e("content"),unref(n).em("content",y.type),unref(n).is("fixed",!!y.$slots.default),unref(n).is("dot",y.isDot)]),textContent:toDisplayString(unref(g))},null,10,_hoisted_1$v),[[vShow,!y.hidden&&(unref(g)||y.isDot)]])]),_:1},8,["name"])],2))}});var Badge=_export_sfc$1(_sfc_main$U,[["__file","badge.vue"]]);const ElBadge=withInstall(Badge),buttonGroupContextKey=Symbol("buttonGroupContextKey"),useButton=(t,r)=>{useDeprecated({from:"type.text",replacement:"link",version:"3.0.0",scope:"props",ref:"https://element-plus.org/en-US/component/button.html#button-attributes"},computed(()=>t.type==="text"));const e=inject(buttonGroupContextKey,void 0),n=useGlobalConfig("button"),{form:g}=useFormItem(),y=useFormSize(computed(()=>e==null?void 0:e.size)),i=useFormDisabled(),k=ref(),$=useSlots(),L=computed(()=>t.type||(e==null?void 0:e.type)||""),V=computed(()=>{var ue,le,oe;return(oe=(le=t.autoInsertSpace)!=null?le:(ue=n.value)==null?void 0:ue.autoInsertSpace)!=null?oe:!1}),z=computed(()=>t.tag==="button"?{ariaDisabled:i.value||t.loading,disabled:i.value||t.loading,autofocus:t.autofocus,type:t.nativeType}:{}),re=computed(()=>{var ue;const le=(ue=$.default)==null?void 0:ue.call($);if(V.value&&(le==null?void 0:le.length)===1){const oe=le[0];if((oe==null?void 0:oe.type)===Text){const ae=oe.children;return/^\p{Unified_Ideograph}{2}$/u.test(ae.trim())}}return!1});return{_disabled:i,_size:y,_type:L,_ref:k,_props:z,shouldAddSpace:re,handleClick:ue=>{t.nativeType==="reset"&&(g==null||g.resetFields()),r("click",ue)}}},buttonTypes=["default","primary","success","warning","info","danger","text",""],buttonNativeTypes=["button","submit","reset"],buttonProps=buildProps({size:useSizeProp,disabled:Boolean,type:{type:String,values:buttonTypes,default:""},icon:{type:iconPropType},nativeType:{type:String,values:buttonNativeTypes,default:"button"},loading:Boolean,loadingIcon:{type:iconPropType,default:()=>loading_default},plain:Boolean,text:Boolean,link:Boolean,bg:Boolean,autofocus:Boolean,round:Boolean,circle:Boolean,color:String,dark:Boolean,autoInsertSpace:{type:Boolean,default:void 0},tag:{type:definePropType([String,Object]),default:"button"}}),buttonEmits={click:t=>t instanceof MouseEvent};function bound01(t,r){isOnePointZero(t)&&(t="100%");var e=isPercentage(t);return t=r===360?t:Math.min(r,Math.max(0,parseFloat(t))),e&&(t=parseInt(String(t*r),10)/100),Math.abs(t-r)<1e-6?1:(r===360?t=(t<0?t%r+r:t%r)/parseFloat(String(r)):t=t%r/parseFloat(String(r)),t)}function clamp01(t){return Math.min(1,Math.max(0,t))}function isOnePointZero(t){return typeof t=="string"&&t.indexOf(".")!==-1&&parseFloat(t)===1}function isPercentage(t){return typeof t=="string"&&t.indexOf("%")!==-1}function boundAlpha(t){return t=parseFloat(t),(isNaN(t)||t<0||t>1)&&(t=1),t}function convertToPercentage(t){return t<=1?"".concat(Number(t)*100,"%"):t}function pad2(t){return t.length===1?"0"+t:String(t)}function rgbToRgb(t,r,e){return{r:bound01(t,255)*255,g:bound01(r,255)*255,b:bound01(e,255)*255}}function rgbToHsl(t,r,e){t=bound01(t,255),r=bound01(r,255),e=bound01(e,255);var n=Math.max(t,r,e),g=Math.min(t,r,e),y=0,i=0,k=(n+g)/2;if(n===g)i=0,y=0;else{var $=n-g;switch(i=k>.5?$/(2-n-g):$/(n+g),n){case t:y=(r-e)/$+(r<e?6:0);break;case r:y=(e-t)/$+2;break;case e:y=(t-r)/$+4;break}y/=6}return{h:y,s:i,l:k}}function hue2rgb(t,r,e){return e<0&&(e+=1),e>1&&(e-=1),e<1/6?t+(r-t)*(6*e):e<1/2?r:e<2/3?t+(r-t)*(2/3-e)*6:t}function hslToRgb(t,r,e){var n,g,y;if(t=bound01(t,360),r=bound01(r,100),e=bound01(e,100),r===0)g=e,y=e,n=e;else{var i=e<.5?e*(1+r):e+r-e*r,k=2*e-i;n=hue2rgb(k,i,t+1/3),g=hue2rgb(k,i,t),y=hue2rgb(k,i,t-1/3)}return{r:n*255,g:g*255,b:y*255}}function rgbToHsv(t,r,e){t=bound01(t,255),r=bound01(r,255),e=bound01(e,255);var n=Math.max(t,r,e),g=Math.min(t,r,e),y=0,i=n,k=n-g,$=n===0?0:k/n;if(n===g)y=0;else{switch(n){case t:y=(r-e)/k+(r<e?6:0);break;case r:y=(e-t)/k+2;break;case e:y=(t-r)/k+4;break}y/=6}return{h:y,s:$,v:i}}function hsvToRgb(t,r,e){t=bound01(t,360)*6,r=bound01(r,100),e=bound01(e,100);var n=Math.floor(t),g=t-n,y=e*(1-r),i=e*(1-g*r),k=e*(1-(1-g)*r),$=n%6,L=[e,i,y,y,k,e][$],V=[k,e,e,i,y,y][$],z=[y,y,k,e,e,i][$];return{r:L*255,g:V*255,b:z*255}}function rgbToHex(t,r,e,n){var g=[pad2(Math.round(t).toString(16)),pad2(Math.round(r).toString(16)),pad2(Math.round(e).toString(16))];return n&&g[0].startsWith(g[0].charAt(1))&&g[1].startsWith(g[1].charAt(1))&&g[2].startsWith(g[2].charAt(1))?g[0].charAt(0)+g[1].charAt(0)+g[2].charAt(0):g.join("")}function rgbaToHex(t,r,e,n,g){var y=[pad2(Math.round(t).toString(16)),pad2(Math.round(r).toString(16)),pad2(Math.round(e).toString(16)),pad2(convertDecimalToHex(n))];return g&&y[0].startsWith(y[0].charAt(1))&&y[1].startsWith(y[1].charAt(1))&&y[2].startsWith(y[2].charAt(1))&&y[3].startsWith(y[3].charAt(1))?y[0].charAt(0)+y[1].charAt(0)+y[2].charAt(0)+y[3].charAt(0):y.join("")}function convertDecimalToHex(t){return Math.round(parseFloat(t)*255).toString(16)}function convertHexToDecimal(t){return parseIntFromHex(t)/255}function parseIntFromHex(t){return parseInt(t,16)}function numberInputToObject(t){return{r:t>>16,g:(t&65280)>>8,b:t&255}}var names={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",goldenrod:"#daa520",gold:"#ffd700",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavenderblush:"#fff0f5",lavender:"#e6e6fa",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};function inputToRGB(t){var r={r:0,g:0,b:0},e=1,n=null,g=null,y=null,i=!1,k=!1;return typeof t=="string"&&(t=stringInputToObject(t)),typeof t=="object"&&(isValidCSSUnit(t.r)&&isValidCSSUnit(t.g)&&isValidCSSUnit(t.b)?(r=rgbToRgb(t.r,t.g,t.b),i=!0,k=String(t.r).substr(-1)==="%"?"prgb":"rgb"):isValidCSSUnit(t.h)&&isValidCSSUnit(t.s)&&isValidCSSUnit(t.v)?(n=convertToPercentage(t.s),g=convertToPercentage(t.v),r=hsvToRgb(t.h,n,g),i=!0,k="hsv"):isValidCSSUnit(t.h)&&isValidCSSUnit(t.s)&&isValidCSSUnit(t.l)&&(n=convertToPercentage(t.s),y=convertToPercentage(t.l),r=hslToRgb(t.h,n,y),i=!0,k="hsl"),Object.prototype.hasOwnProperty.call(t,"a")&&(e=t.a)),e=boundAlpha(e),{ok:i,format:t.format||k,r:Math.min(255,Math.max(r.r,0)),g:Math.min(255,Math.max(r.g,0)),b:Math.min(255,Math.max(r.b,0)),a:e}}var CSS_INTEGER="[-\\+]?\\d+%?",CSS_NUMBER="[-\\+]?\\d*\\.\\d+%?",CSS_UNIT="(?:".concat(CSS_NUMBER,")|(?:").concat(CSS_INTEGER,")"),PERMISSIVE_MATCH3="[\\s|\\(]+(".concat(CSS_UNIT,")[,|\\s]+(").concat(CSS_UNIT,")[,|\\s]+(").concat(CSS_UNIT,")\\s*\\)?"),PERMISSIVE_MATCH4="[\\s|\\(]+(".concat(CSS_UNIT,")[,|\\s]+(").concat(CSS_UNIT,")[,|\\s]+(").concat(CSS_UNIT,")[,|\\s]+(").concat(CSS_UNIT,")\\s*\\)?"),matchers={CSS_UNIT:new RegExp(CSS_UNIT),rgb:new RegExp("rgb"+PERMISSIVE_MATCH3),rgba:new RegExp("rgba"+PERMISSIVE_MATCH4),hsl:new RegExp("hsl"+PERMISSIVE_MATCH3),hsla:new RegExp("hsla"+PERMISSIVE_MATCH4),hsv:new RegExp("hsv"+PERMISSIVE_MATCH3),hsva:new RegExp("hsva"+PERMISSIVE_MATCH4),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/};function stringInputToObject(t){if(t=t.trim().toLowerCase(),t.length===0)return!1;var r=!1;if(names[t])t=names[t],r=!0;else if(t==="transparent")return{r:0,g:0,b:0,a:0,format:"name"};var e=matchers.rgb.exec(t);return e?{r:e[1],g:e[2],b:e[3]}:(e=matchers.rgba.exec(t),e?{r:e[1],g:e[2],b:e[3],a:e[4]}:(e=matchers.hsl.exec(t),e?{h:e[1],s:e[2],l:e[3]}:(e=matchers.hsla.exec(t),e?{h:e[1],s:e[2],l:e[3],a:e[4]}:(e=matchers.hsv.exec(t),e?{h:e[1],s:e[2],v:e[3]}:(e=matchers.hsva.exec(t),e?{h:e[1],s:e[2],v:e[3],a:e[4]}:(e=matchers.hex8.exec(t),e?{r:parseIntFromHex(e[1]),g:parseIntFromHex(e[2]),b:parseIntFromHex(e[3]),a:convertHexToDecimal(e[4]),format:r?"name":"hex8"}:(e=matchers.hex6.exec(t),e?{r:parseIntFromHex(e[1]),g:parseIntFromHex(e[2]),b:parseIntFromHex(e[3]),format:r?"name":"hex"}:(e=matchers.hex4.exec(t),e?{r:parseIntFromHex(e[1]+e[1]),g:parseIntFromHex(e[2]+e[2]),b:parseIntFromHex(e[3]+e[3]),a:convertHexToDecimal(e[4]+e[4]),format:r?"name":"hex8"}:(e=matchers.hex3.exec(t),e?{r:parseIntFromHex(e[1]+e[1]),g:parseIntFromHex(e[2]+e[2]),b:parseIntFromHex(e[3]+e[3]),format:r?"name":"hex"}:!1)))))))))}function isValidCSSUnit(t){return!!matchers.CSS_UNIT.exec(String(t))}var TinyColor=function(){function t(r,e){r===void 0&&(r=""),e===void 0&&(e={});var n;if(r instanceof t)return r;typeof r=="number"&&(r=numberInputToObject(r)),this.originalInput=r;var g=inputToRGB(r);this.originalInput=r,this.r=g.r,this.g=g.g,this.b=g.b,this.a=g.a,this.roundA=Math.round(100*this.a)/100,this.format=(n=e.format)!==null&&n!==void 0?n:g.format,this.gradientType=e.gradientType,this.r<1&&(this.r=Math.round(this.r)),this.g<1&&(this.g=Math.round(this.g)),this.b<1&&(this.b=Math.round(this.b)),this.isValid=g.ok}return t.prototype.isDark=function(){return this.getBrightness()<128},t.prototype.isLight=function(){return!this.isDark()},t.prototype.getBrightness=function(){var r=this.toRgb();return(r.r*299+r.g*587+r.b*114)/1e3},t.prototype.getLuminance=function(){var r=this.toRgb(),e,n,g,y=r.r/255,i=r.g/255,k=r.b/255;return y<=.03928?e=y/12.92:e=Math.pow((y+.055)/1.055,2.4),i<=.03928?n=i/12.92:n=Math.pow((i+.055)/1.055,2.4),k<=.03928?g=k/12.92:g=Math.pow((k+.055)/1.055,2.4),.2126*e+.7152*n+.0722*g},t.prototype.getAlpha=function(){return this.a},t.prototype.setAlpha=function(r){return this.a=boundAlpha(r),this.roundA=Math.round(100*this.a)/100,this},t.prototype.isMonochrome=function(){var r=this.toHsl().s;return r===0},t.prototype.toHsv=function(){var r=rgbToHsv(this.r,this.g,this.b);return{h:r.h*360,s:r.s,v:r.v,a:this.a}},t.prototype.toHsvString=function(){var r=rgbToHsv(this.r,this.g,this.b),e=Math.round(r.h*360),n=Math.round(r.s*100),g=Math.round(r.v*100);return this.a===1?"hsv(".concat(e,", ").concat(n,"%, ").concat(g,"%)"):"hsva(".concat(e,", ").concat(n,"%, ").concat(g,"%, ").concat(this.roundA,")")},t.prototype.toHsl=function(){var r=rgbToHsl(this.r,this.g,this.b);return{h:r.h*360,s:r.s,l:r.l,a:this.a}},t.prototype.toHslString=function(){var r=rgbToHsl(this.r,this.g,this.b),e=Math.round(r.h*360),n=Math.round(r.s*100),g=Math.round(r.l*100);return this.a===1?"hsl(".concat(e,", ").concat(n,"%, ").concat(g,"%)"):"hsla(".concat(e,", ").concat(n,"%, ").concat(g,"%, ").concat(this.roundA,")")},t.prototype.toHex=function(r){return r===void 0&&(r=!1),rgbToHex(this.r,this.g,this.b,r)},t.prototype.toHexString=function(r){return r===void 0&&(r=!1),"#"+this.toHex(r)},t.prototype.toHex8=function(r){return r===void 0&&(r=!1),rgbaToHex(this.r,this.g,this.b,this.a,r)},t.prototype.toHex8String=function(r){return r===void 0&&(r=!1),"#"+this.toHex8(r)},t.prototype.toHexShortString=function(r){return r===void 0&&(r=!1),this.a===1?this.toHexString(r):this.toHex8String(r)},t.prototype.toRgb=function(){return{r:Math.round(this.r),g:Math.round(this.g),b:Math.round(this.b),a:this.a}},t.prototype.toRgbString=function(){var r=Math.round(this.r),e=Math.round(this.g),n=Math.round(this.b);return this.a===1?"rgb(".concat(r,", ").concat(e,", ").concat(n,")"):"rgba(".concat(r,", ").concat(e,", ").concat(n,", ").concat(this.roundA,")")},t.prototype.toPercentageRgb=function(){var r=function(e){return"".concat(Math.round(bound01(e,255)*100),"%")};return{r:r(this.r),g:r(this.g),b:r(this.b),a:this.a}},t.prototype.toPercentageRgbString=function(){var r=function(e){return Math.round(bound01(e,255)*100)};return this.a===1?"rgb(".concat(r(this.r),"%, ").concat(r(this.g),"%, ").concat(r(this.b),"%)"):"rgba(".concat(r(this.r),"%, ").concat(r(this.g),"%, ").concat(r(this.b),"%, ").concat(this.roundA,")")},t.prototype.toName=function(){if(this.a===0)return"transparent";if(this.a<1)return!1;for(var r="#"+rgbToHex(this.r,this.g,this.b,!1),e=0,n=Object.entries(names);e<n.length;e++){var g=n[e],y=g[0],i=g[1];if(r===i)return y}return!1},t.prototype.toString=function(r){var e=!!r;r=r??this.format;var n=!1,g=this.a<1&&this.a>=0,y=!e&&g&&(r.startsWith("hex")||r==="name");return y?r==="name"&&this.a===0?this.toName():this.toRgbString():(r==="rgb"&&(n=this.toRgbString()),r==="prgb"&&(n=this.toPercentageRgbString()),(r==="hex"||r==="hex6")&&(n=this.toHexString()),r==="hex3"&&(n=this.toHexString(!0)),r==="hex4"&&(n=this.toHex8String(!0)),r==="hex8"&&(n=this.toHex8String()),r==="name"&&(n=this.toName()),r==="hsl"&&(n=this.toHslString()),r==="hsv"&&(n=this.toHsvString()),n||this.toHexString())},t.prototype.toNumber=function(){return(Math.round(this.r)<<16)+(Math.round(this.g)<<8)+Math.round(this.b)},t.prototype.clone=function(){return new t(this.toString())},t.prototype.lighten=function(r){r===void 0&&(r=10);var e=this.toHsl();return e.l+=r/100,e.l=clamp01(e.l),new t(e)},t.prototype.brighten=function(r){r===void 0&&(r=10);var e=this.toRgb();return e.r=Math.max(0,Math.min(255,e.r-Math.round(255*-(r/100)))),e.g=Math.max(0,Math.min(255,e.g-Math.round(255*-(r/100)))),e.b=Math.max(0,Math.min(255,e.b-Math.round(255*-(r/100)))),new t(e)},t.prototype.darken=function(r){r===void 0&&(r=10);var e=this.toHsl();return e.l-=r/100,e.l=clamp01(e.l),new t(e)},t.prototype.tint=function(r){return r===void 0&&(r=10),this.mix("white",r)},t.prototype.shade=function(r){return r===void 0&&(r=10),this.mix("black",r)},t.prototype.desaturate=function(r){r===void 0&&(r=10);var e=this.toHsl();return e.s-=r/100,e.s=clamp01(e.s),new t(e)},t.prototype.saturate=function(r){r===void 0&&(r=10);var e=this.toHsl();return e.s+=r/100,e.s=clamp01(e.s),new t(e)},t.prototype.greyscale=function(){return this.desaturate(100)},t.prototype.spin=function(r){var e=this.toHsl(),n=(e.h+r)%360;return e.h=n<0?360+n:n,new t(e)},t.prototype.mix=function(r,e){e===void 0&&(e=50);var n=this.toRgb(),g=new t(r).toRgb(),y=e/100,i={r:(g.r-n.r)*y+n.r,g:(g.g-n.g)*y+n.g,b:(g.b-n.b)*y+n.b,a:(g.a-n.a)*y+n.a};return new t(i)},t.prototype.analogous=function(r,e){r===void 0&&(r=6),e===void 0&&(e=30);var n=this.toHsl(),g=360/e,y=[this];for(n.h=(n.h-(g*r>>1)+720)%360;--r;)n.h=(n.h+g)%360,y.push(new t(n));return y},t.prototype.complement=function(){var r=this.toHsl();return r.h=(r.h+180)%360,new t(r)},t.prototype.monochromatic=function(r){r===void 0&&(r=6);for(var e=this.toHsv(),n=e.h,g=e.s,y=e.v,i=[],k=1/r;r--;)i.push(new t({h:n,s:g,v:y})),y=(y+k)%1;return i},t.prototype.splitcomplement=function(){var r=this.toHsl(),e=r.h;return[this,new t({h:(e+72)%360,s:r.s,l:r.l}),new t({h:(e+216)%360,s:r.s,l:r.l})]},t.prototype.onBackground=function(r){var e=this.toRgb(),n=new t(r).toRgb(),g=e.a+n.a*(1-e.a);return new t({r:(e.r*e.a+n.r*n.a*(1-e.a))/g,g:(e.g*e.a+n.g*n.a*(1-e.a))/g,b:(e.b*e.a+n.b*n.a*(1-e.a))/g,a:g})},t.prototype.triad=function(){return this.polyad(3)},t.prototype.tetrad=function(){return this.polyad(4)},t.prototype.polyad=function(r){for(var e=this.toHsl(),n=e.h,g=[this],y=360/r,i=1;i<r;i++)g.push(new t({h:(n+i*y)%360,s:e.s,l:e.l}));return g},t.prototype.equals=function(r){return this.toRgbString()===new t(r).toRgbString()},t}();function darken(t,r=20){return t.mix("#141414",r).toString()}function useButtonCustomStyle(t){const r=useFormDisabled(),e=useNamespace("button");return computed(()=>{let n={};const g=t.color;if(g){const y=new TinyColor(g),i=t.dark?y.tint(20).toString():darken(y,20);if(t.plain)n=e.cssVarBlock({"bg-color":t.dark?darken(y,90):y.tint(90).toString(),"text-color":g,"border-color":t.dark?darken(y,50):y.tint(50).toString(),"hover-text-color":`var(${e.cssVarName("color-white")})`,"hover-bg-color":g,"hover-border-color":g,"active-bg-color":i,"active-text-color":`var(${e.cssVarName("color-white")})`,"active-border-color":i}),r.value&&(n[e.cssVarBlockName("disabled-bg-color")]=t.dark?darken(y,90):y.tint(90).toString(),n[e.cssVarBlockName("disabled-text-color")]=t.dark?darken(y,50):y.tint(50).toString(),n[e.cssVarBlockName("disabled-border-color")]=t.dark?darken(y,80):y.tint(80).toString());else{const k=t.dark?darken(y,30):y.tint(30).toString(),$=y.isDark()?`var(${e.cssVarName("color-white")})`:`var(${e.cssVarName("color-black")})`;if(n=e.cssVarBlock({"bg-color":g,"text-color":$,"border-color":g,"hover-bg-color":k,"hover-text-color":$,"hover-border-color":k,"active-bg-color":i,"active-border-color":i}),r.value){const L=t.dark?darken(y,50):y.tint(50).toString();n[e.cssVarBlockName("disabled-bg-color")]=L,n[e.cssVarBlockName("disabled-text-color")]=t.dark?"rgba(255, 255, 255, 0.5)":`var(${e.cssVarName("color-white")})`,n[e.cssVarBlockName("disabled-border-color")]=L}}}return n})}const __default__$v=defineComponent({name:"ElButton"}),_sfc_main$T=defineComponent({...__default__$v,props:buttonProps,emits:buttonEmits,setup(t,{expose:r,emit:e}){const n=t,g=useButtonCustomStyle(n),y=useNamespace("button"),{_ref:i,_size:k,_type:$,_disabled:L,_props:V,shouldAddSpace:z,handleClick:re}=useButton(n,e);return r({ref:i,size:k,type:$,disabled:L,shouldAddSpace:z}),(ie,ue)=>(openBlock(),createBlock(resolveDynamicComponent(ie.tag),mergeProps({ref_key:"_ref",ref:i},unref(V),{class:[unref(y).b(),unref(y).m(unref($)),unref(y).m(unref(k)),unref(y).is("disabled",unref(L)),unref(y).is("loading",ie.loading),unref(y).is("plain",ie.plain),unref(y).is("round",ie.round),unref(y).is("circle",ie.circle),unref(y).is("text",ie.text),unref(y).is("link",ie.link),unref(y).is("has-bg",ie.bg)],style:unref(g),onClick:unref(re)}),{default:withCtx(()=>[ie.loading?(openBlock(),createElementBlock(Fragment,{key:0},[ie.$slots.loading?renderSlot(ie.$slots,"loading",{key:0}):(openBlock(),createBlock(unref(ElIcon),{key:1,class:normalizeClass(unref(y).is("loading"))},{default:withCtx(()=>[(openBlock(),createBlock(resolveDynamicComponent(ie.loadingIcon)))]),_:1},8,["class"]))],64)):ie.icon||ie.$slots.icon?(openBlock(),createBlock(unref(ElIcon),{key:1},{default:withCtx(()=>[ie.icon?(openBlock(),createBlock(resolveDynamicComponent(ie.icon),{key:0})):renderSlot(ie.$slots,"icon",{key:1})]),_:3})):createCommentVNode("v-if",!0),ie.$slots.default?(openBlock(),createElementBlock("span",{key:2,class:normalizeClass({[unref(y).em("text","expand")]:unref(z)})},[renderSlot(ie.$slots,"default")],2)):createCommentVNode("v-if",!0)]),_:3},16,["class","style","onClick"]))}});var Button=_export_sfc$1(_sfc_main$T,[["__file","button.vue"]]);const buttonGroupProps={size:buttonProps.size,type:buttonProps.type},__default__$u=defineComponent({name:"ElButtonGroup"}),_sfc_main$S=defineComponent({...__default__$u,props:buttonGroupProps,setup(t){const r=t;provide(buttonGroupContextKey,reactive({size:toRef(r,"size"),type:toRef(r,"type")}));const e=useNamespace("button");return(n,g)=>(openBlock(),createElementBlock("div",{class:normalizeClass(`${unref(e).b("group")}`)},[renderSlot(n.$slots,"default")],2))}});var ButtonGroup=_export_sfc$1(_sfc_main$S,[["__file","button-group.vue"]]);const ElButton=withInstall(Button,{ButtonGroup});withNoopInstall(ButtonGroup);var commonjsGlobal=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function getDefaultExportFromCjs(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var dayjs_min={exports:{}};(function(t,r){(function(e,n){t.exports=n()})(commonjsGlobal,function(){var e=1e3,n=6e4,g=36e5,y="millisecond",i="second",k="minute",$="hour",L="day",V="week",z="month",re="quarter",ie="year",ue="date",le="Invalid Date",oe=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,ae=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,qe={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(sr){var er=["th","st","nd","rd"],cr=sr%100;return"["+sr+(er[(cr-20)%10]||er[cr]||er[0])+"]"}},de=function(sr,er,cr){var or=String(sr);return!or||or.length>=er?sr:""+Array(er+1-or.length).join(cr)+sr},Ne={s:de,z:function(sr){var er=-sr.utcOffset(),cr=Math.abs(er),or=Math.floor(cr/60),hr=cr%60;return(er<=0?"+":"-")+de(or,2,"0")+":"+de(hr,2,"0")},m:function sr(er,cr){if(er.date()<cr.date())return-sr(cr,er);var or=12*(cr.year()-er.year())+(cr.month()-er.month()),hr=er.clone().add(or,z),pr=cr-hr<0,Sr=er.clone().add(or+(pr?-1:1),z);return+(-(or+(cr-hr)/(pr?hr-Sr:Sr-hr))||0)},a:function(sr){return sr<0?Math.ceil(sr)||0:Math.floor(sr)},p:function(sr){return{M:z,y:ie,w:V,d:L,D:ue,h:$,m:k,s:i,ms:y,Q:re}[sr]||String(sr||"").toLowerCase().replace(/s$/,"")},u:function(sr){return sr===void 0}},ze="en",$e={};$e[ze]=qe;var Lt="$isDayjsObject",jt=function(sr){return sr instanceof Dt||!(!sr||!sr[Lt])},Et=function sr(er,cr,or){var hr;if(!er)return ze;if(typeof er=="string"){var pr=er.toLowerCase();$e[pr]&&(hr=pr),cr&&($e[pr]=cr,hr=pr);var Sr=er.split("-");if(!hr&&Sr.length>1)return sr(Sr[0])}else{var Er=er.name;$e[Er]=er,hr=Er}return!or&&hr&&(ze=hr),hr||!or&&ze},ir=function(sr,er){if(jt(sr))return sr.clone();var cr=typeof er=="object"?er:{};return cr.date=sr,cr.args=arguments,new Dt(cr)},dr=Ne;dr.l=Et,dr.i=jt,dr.w=function(sr,er){return ir(sr,{locale:er.$L,utc:er.$u,x:er.$x,$offset:er.$offset})};var Dt=function(){function sr(cr){this.$L=Et(cr.locale,null,!0),this.parse(cr),this.$x=this.$x||cr.x||{},this[Lt]=!0}var er=sr.prototype;return er.parse=function(cr){this.$d=function(or){var hr=or.date,pr=or.utc;if(hr===null)return new Date(NaN);if(dr.u(hr))return new Date;if(hr instanceof Date)return new Date(hr);if(typeof hr=="string"&&!/Z$/i.test(hr)){var Sr=hr.match(oe);if(Sr){var Er=Sr[2]-1||0,Pr=(Sr[7]||"0").substring(0,3);return pr?new Date(Date.UTC(Sr[1],Er,Sr[3]||1,Sr[4]||0,Sr[5]||0,Sr[6]||0,Pr)):new Date(Sr[1],Er,Sr[3]||1,Sr[4]||0,Sr[5]||0,Sr[6]||0,Pr)}}return new Date(hr)}(cr),this.init()},er.init=function(){var cr=this.$d;this.$y=cr.getFullYear(),this.$M=cr.getMonth(),this.$D=cr.getDate(),this.$W=cr.getDay(),this.$H=cr.getHours(),this.$m=cr.getMinutes(),this.$s=cr.getSeconds(),this.$ms=cr.getMilliseconds()},er.$utils=function(){return dr},er.isValid=function(){return this.$d.toString()!==le},er.isSame=function(cr,or){var hr=ir(cr);return this.startOf(or)<=hr&&hr<=this.endOf(or)},er.isAfter=function(cr,or){return ir(cr)<this.startOf(or)},er.isBefore=function(cr,or){return this.endOf(or)<ir(cr)},er.$g=function(cr,or,hr){return dr.u(cr)?this[or]:this.set(hr,cr)},er.unix=function(){return Math.floor(this.valueOf()/1e3)},er.valueOf=function(){return this.$d.getTime()},er.startOf=function(cr,or){var hr=this,pr=!!dr.u(or)||or,Sr=dr.p(cr),Er=function(_r,Or){var Mr=dr.w(hr.$u?Date.UTC(hr.$y,Or,_r):new Date(hr.$y,Or,_r),hr);return pr?Mr:Mr.endOf(L)},Pr=function(_r,Or){return dr.w(hr.toDate()[_r].apply(hr.toDate("s"),(pr?[0,0,0,0]:[23,59,59,999]).slice(Or)),hr)},Cr=this.$W,rr=this.$M,kr=this.$D,Ir="set"+(this.$u?"UTC":"");switch(Sr){case ie:return pr?Er(1,0):Er(31,11);case z:return pr?Er(1,rr):Er(0,rr+1);case V:var xr=this.$locale().weekStart||0,vr=(Cr<xr?Cr+7:Cr)-xr;return Er(pr?kr-vr:kr+(6-vr),rr);case L:case ue:return Pr(Ir+"Hours",0);case $:return Pr(Ir+"Minutes",1);case k:return Pr(Ir+"Seconds",2);case i:return Pr(Ir+"Milliseconds",3);default:return this.clone()}},er.endOf=function(cr){return this.startOf(cr,!1)},er.$set=function(cr,or){var hr,pr=dr.p(cr),Sr="set"+(this.$u?"UTC":""),Er=(hr={},hr[L]=Sr+"Date",hr[ue]=Sr+"Date",hr[z]=Sr+"Month",hr[ie]=Sr+"FullYear",hr[$]=Sr+"Hours",hr[k]=Sr+"Minutes",hr[i]=Sr+"Seconds",hr[y]=Sr+"Milliseconds",hr)[pr],Pr=pr===L?this.$D+(or-this.$W):or;if(pr===z||pr===ie){var Cr=this.clone().set(ue,1);Cr.$d[Er](Pr),Cr.init(),this.$d=Cr.set(ue,Math.min(this.$D,Cr.daysInMonth())).$d}else Er&&this.$d[Er](Pr);return this.init(),this},er.set=function(cr,or){return this.clone().$set(cr,or)},er.get=function(cr){return this[dr.p(cr)]()},er.add=function(cr,or){var hr,pr=this;cr=Number(cr);var Sr=dr.p(or),Er=function(rr){var kr=ir(pr);return dr.w(kr.date(kr.date()+Math.round(rr*cr)),pr)};if(Sr===z)return this.set(z,this.$M+cr);if(Sr===ie)return this.set(ie,this.$y+cr);if(Sr===L)return Er(1);if(Sr===V)return Er(7);var Pr=(hr={},hr[k]=n,hr[$]=g,hr[i]=e,hr)[Sr]||1,Cr=this.$d.getTime()+cr*Pr;return dr.w(Cr,this)},er.subtract=function(cr,or){return this.add(-1*cr,or)},er.format=function(cr){var or=this,hr=this.$locale();if(!this.isValid())return hr.invalidDate||le;var pr=cr||"YYYY-MM-DDTHH:mm:ssZ",Sr=dr.z(this),Er=this.$H,Pr=this.$m,Cr=this.$M,rr=hr.weekdays,kr=hr.months,Ir=hr.meridiem,xr=function(Or,Mr,yr,mr){return Or&&(Or[Mr]||Or(or,pr))||yr[Mr].slice(0,mr)},vr=function(Or){return dr.s(Er%12||12,Or,"0")},_r=Ir||function(Or,Mr,yr){var mr=Or<12?"AM":"PM";return yr?mr.toLowerCase():mr};return pr.replace(ae,function(Or,Mr){return Mr||function(yr){switch(yr){case"YY":return String(or.$y).slice(-2);case"YYYY":return dr.s(or.$y,4,"0");case"M":return Cr+1;case"MM":return dr.s(Cr+1,2,"0");case"MMM":return xr(hr.monthsShort,Cr,kr,3);case"MMMM":return xr(kr,Cr);case"D":return or.$D;case"DD":return dr.s(or.$D,2,"0");case"d":return String(or.$W);case"dd":return xr(hr.weekdaysMin,or.$W,rr,2);case"ddd":return xr(hr.weekdaysShort,or.$W,rr,3);case"dddd":return rr[or.$W];case"H":return String(Er);case"HH":return dr.s(Er,2,"0");case"h":return vr(1);case"hh":return vr(2);case"a":return _r(Er,Pr,!0);case"A":return _r(Er,Pr,!1);case"m":return String(Pr);case"mm":return dr.s(Pr,2,"0");case"s":return String(or.$s);case"ss":return dr.s(or.$s,2,"0");case"SSS":return dr.s(or.$ms,3,"0");case"Z":return Sr}return null}(Or)||Sr.replace(":","")})},er.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},er.diff=function(cr,or,hr){var pr,Sr=this,Er=dr.p(or),Pr=ir(cr),Cr=(Pr.utcOffset()-this.utcOffset())*n,rr=this-Pr,kr=function(){return dr.m(Sr,Pr)};switch(Er){case ie:pr=kr()/12;break;case z:pr=kr();break;case re:pr=kr()/3;break;case V:pr=(rr-Cr)/6048e5;break;case L:pr=(rr-Cr)/864e5;break;case $:pr=rr/g;break;case k:pr=rr/n;break;case i:pr=rr/e;break;default:pr=rr}return hr?pr:dr.a(pr)},er.daysInMonth=function(){return this.endOf(z).$D},er.$locale=function(){return $e[this.$L]},er.locale=function(cr,or){if(!cr)return this.$L;var hr=this.clone(),pr=Et(cr,or,!0);return pr&&(hr.$L=pr),hr},er.clone=function(){return dr.w(this.$d,this)},er.toDate=function(){return new Date(this.valueOf())},er.toJSON=function(){return this.isValid()?this.toISOString():null},er.toISOString=function(){return this.$d.toISOString()},er.toString=function(){return this.$d.toUTCString()},sr}(),lr=Dt.prototype;return ir.prototype=lr,[["$ms",y],["$s",i],["$m",k],["$H",$],["$W",L],["$M",z],["$y",ie],["$D",ue]].forEach(function(sr){lr[sr[1]]=function(er){return this.$g(er,sr[0],sr[1])}}),ir.extend=function(sr,er){return sr.$i||(sr(er,Dt,ir),sr.$i=!0),ir},ir.locale=Et,ir.isDayjs=jt,ir.unix=function(sr){return ir(1e3*sr)},ir.en=$e[ze],ir.Ls=$e,ir.p={},ir})})(dayjs_min);var dayjs_minExports=dayjs_min.exports;const dayjs=getDefaultExportFromCjs(dayjs_minExports),nodeList=new Map;let startClick;isClient&&(document.addEventListener("mousedown",t=>startClick=t),document.addEventListener("mouseup",t=>{for(const r of nodeList.values())for(const{documentHandler:e}of r)e(t,startClick)}));function createDocumentHandler(t,r){let e=[];return Array.isArray(r.arg)?e=r.arg:isElement(r.arg)&&e.push(r.arg),function(n,g){const y=r.instance.popperRef,i=n.target,k=g==null?void 0:g.target,$=!r||!r.instance,L=!i||!k,V=t.contains(i)||t.contains(k),z=t===i,re=e.length&&e.some(ue=>ue==null?void 0:ue.contains(i))||e.length&&e.includes(k),ie=y&&(y.contains(i)||y.contains(k));$||L||V||z||re||ie||r.value(n,g)}}const ClickOutside={beforeMount(t,r){nodeList.has(t)||nodeList.set(t,[]),nodeList.get(t).push({documentHandler:createDocumentHandler(t,r),bindingFn:r.value})},updated(t,r){nodeList.has(t)||nodeList.set(t,[]);const e=nodeList.get(t),n=e.findIndex(y=>y.bindingFn===r.oldValue),g={documentHandler:createDocumentHandler(t,r),bindingFn:r.value};n>=0?e.splice(n,1,g):e.push(g)},unmounted(t){nodeList.delete(t)}},REPEAT_INTERVAL=100,REPEAT_DELAY=600,vRepeatClick={beforeMount(t,r){const e=r.value,{interval:n=REPEAT_INTERVAL,delay:g=REPEAT_DELAY}=isFunction$3(e)?{}:e;let y,i;const k=()=>isFunction$3(e)?e():e.handler(),$=()=>{i&&(clearTimeout(i),i=void 0),y&&(clearInterval(y),y=void 0)};t.addEventListener("mousedown",L=>{L.button===0&&($(),k(),document.addEventListener("mouseup",()=>$(),{once:!0}),i=setTimeout(()=>{y=setInterval(()=>{k()},n)},g))})}},FOCUSABLE_CHILDREN="_trap-focus-children",FOCUS_STACK=[],FOCUS_HANDLER=t=>{if(FOCUS_STACK.length===0)return;const r=FOCUS_STACK[FOCUS_STACK.length-1][FOCUSABLE_CHILDREN];if(r.length>0&&t.code===EVENT_CODE.tab){if(r.length===1){t.preventDefault(),document.activeElement!==r[0]&&r[0].focus();return}const e=t.shiftKey,n=t.target===r[0],g=t.target===r[r.length-1];n&&e&&(t.preventDefault(),r[r.length-1].focus()),g&&!e&&(t.preventDefault(),r[0].focus())}},TrapFocus={beforeMount(t){t[FOCUSABLE_CHILDREN]=obtainAllFocusableElements$1(t),FOCUS_STACK.push(t),FOCUS_STACK.length<=1&&document.addEventListener("keydown",FOCUS_HANDLER)},updated(t){nextTick(()=>{t[FOCUSABLE_CHILDREN]=obtainAllFocusableElements$1(t)})},unmounted(){FOCUS_STACK.shift(),FOCUS_STACK.length===0&&document.removeEventListener("keydown",FOCUS_HANDLER)}};var v=!1,o,f,s,u,d,N,l$1,p,m,w,D,x,E,M,F;function a(){if(!v){v=!0;var t=navigator.userAgent,r=/(?:MSIE.(\d+\.\d+))|(?:(?:Firefox|GranParadiso|Iceweasel).(\d+\.\d+))|(?:Opera(?:.+Version.|.)(\d+\.\d+))|(?:AppleWebKit.(\d+(?:\.\d+)?))|(?:Trident\/\d+\.\d+.*rv:(\d+\.\d+))/.exec(t),e=/(Mac OS X)|(Windows)|(Linux)/.exec(t);if(x=/\b(iPhone|iP[ao]d)/.exec(t),E=/\b(iP[ao]d)/.exec(t),w=/Android/i.exec(t),M=/FBAN\/\w+;/i.exec(t),F=/Mobile/i.exec(t),D=!!/Win64/.exec(t),r){o=r[1]?parseFloat(r[1]):r[5]?parseFloat(r[5]):NaN,o&&document&&document.documentMode&&(o=document.documentMode);var n=/(?:Trident\/(\d+.\d+))/.exec(t);N=n?parseFloat(n[1])+4:o,f=r[2]?parseFloat(r[2]):NaN,s=r[3]?parseFloat(r[3]):NaN,u=r[4]?parseFloat(r[4]):NaN,u?(r=/(?:Chrome\/(\d+\.\d+))/.exec(t),d=r&&r[1]?parseFloat(r[1]):NaN):d=NaN}else o=f=s=d=u=NaN;if(e){if(e[1]){var g=/(?:Mac OS X (\d+(?:[._]\d+)?))/.exec(t);l$1=g?parseFloat(g[1].replace("_",".")):!0}else l$1=!1;p=!!e[2],m=!!e[3]}else l$1=p=m=!1}}var _={ie:function(){return a()||o},ieCompatibilityMode:function(){return a()||N>o},ie64:function(){return _.ie()&&D},firefox:function(){return a()||f},opera:function(){return a()||s},webkit:function(){return a()||u},safari:function(){return _.webkit()},chrome:function(){return a()||d},windows:function(){return a()||p},osx:function(){return a()||l$1},linux:function(){return a()||m},iphone:function(){return a()||x},mobile:function(){return a()||x||E||w||F},nativeApp:function(){return a()||M},android:function(){return a()||w},ipad:function(){return a()||E}},A=_,c=!!(typeof window<"u"&&window.document&&window.document.createElement),U={canUseDOM:c,canUseWorkers:typeof Worker<"u",canUseEventListeners:c&&!!(window.addEventListener||window.attachEvent),canUseViewport:c&&!!window.screen,isInWorker:!c},h=U,X;h.canUseDOM&&(X=document.implementation&&document.implementation.hasFeature&&document.implementation.hasFeature("","")!==!0);function S(t,r){if(!h.canUseDOM||r&&!("addEventListener"in document))return!1;var e="on"+t,n=e in document;if(!n){var g=document.createElement("div");g.setAttribute(e,"return;"),n=typeof g[e]=="function"}return!n&&X&&t==="wheel"&&(n=document.implementation.hasFeature("Events.wheel","3.0")),n}var b=S,O=10,I=40,P=800;function T(t){var r=0,e=0,n=0,g=0;return"detail"in t&&(e=t.detail),"wheelDelta"in t&&(e=-t.wheelDelta/120),"wheelDeltaY"in t&&(e=-t.wheelDeltaY/120),"wheelDeltaX"in t&&(r=-t.wheelDeltaX/120),"axis"in t&&t.axis===t.HORIZONTAL_AXIS&&(r=e,e=0),n=r*O,g=e*O,"deltaY"in t&&(g=t.deltaY),"deltaX"in t&&(n=t.deltaX),(n||g)&&t.deltaMode&&(t.deltaMode==1?(n*=I,g*=I):(n*=P,g*=P)),n&&!r&&(r=n<1?-1:1),g&&!e&&(e=g<1?-1:1),{spinX:r,spinY:e,pixelX:n,pixelY:g}}T.getEventType=function(){return A.firefox()?"DOMMouseScroll":b("wheel")?"wheel":"mousewheel"};var Y=T;/**
* Checks if an event is supported in the current execution environment.
*
* NOTE: This will not work correctly for non-generic events such as `change`,
* `reset`, `load`, `error`, and `select`.
*
* Borrows from Modernizr.
*
* @param {string} eventNameSuffix Event name, e.g. "click".
* @param {?boolean} capture Check if the capture phase is supported.
* @return {boolean} True if the event is supported.
* @internal
* @license Modernizr 3.0.0pre (Custom Build) | MIT
*/const mousewheel=function(t,r){if(t&&t.addEventListener){const e=function(n){const g=Y(n);r&&Reflect.apply(r,this,[n,g])};t.addEventListener("wheel",e,{passive:!0})}},Mousewheel={beforeMount(t,r){mousewheel(t,r.value)}},cardProps=buildProps({header:{type:String,default:""},footer:{type:String,default:""},bodyStyle:{type:definePropType([String,Object,Array]),default:""},bodyClass:String,shadow:{type:String,values:["always","hover","never"],default:"always"}}),__default__$t=defineComponent({name:"ElCard"}),_sfc_main$R=defineComponent({...__default__$t,props:cardProps,setup(t){const r=useNamespace("card");return(e,n)=>(openBlock(),createElementBlock("div",{class:normalizeClass([unref(r).b(),unref(r).is(`${e.shadow}-shadow`)])},[e.$slots.header||e.header?(openBlock(),createElementBlock("div",{key:0,class:normalizeClass(unref(r).e("header"))},[renderSlot(e.$slots,"header",{},()=>[createTextVNode(toDisplayString(e.header),1)])],2)):createCommentVNode("v-if",!0),createBaseVNode("div",{class:normalizeClass([unref(r).e("body"),e.bodyClass]),style:normalizeStyle(e.bodyStyle)},[renderSlot(e.$slots,"default")],6),e.$slots.footer||e.footer?(openBlock(),createElementBlock("div",{key:1,class:normalizeClass(unref(r).e("footer"))},[renderSlot(e.$slots,"footer",{},()=>[createTextVNode(toDisplayString(e.footer),1)])],2)):createCommentVNode("v-if",!0)],2))}});var Card=_export_sfc$1(_sfc_main$R,[["__file","card.vue"]]);const ElCard=withInstall(Card),checkboxProps={modelValue:{type:[Number,String,Boolean],default:void 0},label:{type:[String,Boolean,Number,Object],default:void 0},indeterminate:Boolean,disabled:Boolean,checked:Boolean,name:{type:String,default:void 0},trueLabel:{type:[String,Number],default:void 0},falseLabel:{type:[String,Number],default:void 0},id:{type:String,default:void 0},controls:{type:String,default:void 0},border:Boolean,size:useSizeProp,tabindex:[String,Number],validateEvent:{type:Boolean,default:!0}},checkboxEmits={[UPDATE_MODEL_EVENT]:t=>isString$2(t)||isNumber$1(t)||isBoolean$1(t),change:t=>isString$2(t)||isNumber$1(t)||isBoolean$1(t)},checkboxGroupContextKey=Symbol("checkboxGroupContextKey"),useCheckboxDisabled=({model:t,isChecked:r})=>{const e=inject(checkboxGroupContextKey,void 0),n=computed(()=>{var y,i;const k=(y=e==null?void 0:e.max)==null?void 0:y.value,$=(i=e==null?void 0:e.min)==null?void 0:i.value;return!isUndefined$1(k)&&t.value.length>=k&&!r.value||!isUndefined$1($)&&t.value.length<=$&&r.value});return{isDisabled:useFormDisabled(computed(()=>(e==null?void 0:e.disabled.value)||n.value)),isLimitDisabled:n}},useCheckboxEvent=(t,{model:r,isLimitExceeded:e,hasOwnLabel:n,isDisabled:g,isLabeledByFormItem:y})=>{const i=inject(checkboxGroupContextKey,void 0),{formItem:k}=useFormItem(),{emit:$}=getCurrentInstance();function L(ue){var le,oe;return ue===t.trueLabel||ue===!0?(le=t.trueLabel)!=null?le:!0:(oe=t.falseLabel)!=null?oe:!1}function V(ue,le){$("change",L(ue),le)}function z(ue){if(e.value)return;const le=ue.target;$("change",L(le.checked),ue)}async function re(ue){e.value||!n.value&&!g.value&&y.value&&(ue.composedPath().some(ae=>ae.tagName==="LABEL")||(r.value=L([!1,t.falseLabel].includes(r.value)),await nextTick(),V(r.value,ue)))}const ie=computed(()=>(i==null?void 0:i.validateEvent)||t.validateEvent);return watch(()=>t.modelValue,()=>{ie.value&&(k==null||k.validate("change").catch(ue=>void 0))}),{handleChange:z,onClickRoot:re}},useCheckboxModel=t=>{const r=ref(!1),{emit:e}=getCurrentInstance(),n=inject(checkboxGroupContextKey,void 0),g=computed(()=>isUndefined$1(n)===!1),y=ref(!1),i=computed({get(){var k,$;return g.value?(k=n==null?void 0:n.modelValue)==null?void 0:k.value:($=t.modelValue)!=null?$:r.value},set(k){var $,L;g.value&&isArray$3(k)?(y.value=(($=n==null?void 0:n.max)==null?void 0:$.value)!==void 0&&k.length>(n==null?void 0:n.max.value)&&k.length>i.value.length,y.value===!1&&((L=n==null?void 0:n.changeEvent)==null||L.call(n,k))):(e(UPDATE_MODEL_EVENT,k),r.value=k)}});return{model:i,isGroup:g,isLimitExceeded:y}},useCheckboxStatus=(t,r,{model:e})=>{const n=inject(checkboxGroupContextKey,void 0),g=ref(!1),y=computed(()=>{const L=e.value;return isBoolean$1(L)?L:isArray$3(L)?isObject$2(t.label)?L.map(toRaw).some(V=>isEqual(V,t.label)):L.map(toRaw).includes(t.label):L!=null?L===t.trueLabel:!!L}),i=useFormSize(computed(()=>{var L;return(L=n==null?void 0:n.size)==null?void 0:L.value}),{prop:!0}),k=useFormSize(computed(()=>{var L;return(L=n==null?void 0:n.size)==null?void 0:L.value})),$=computed(()=>!!r.default||!isNil(t.label));return{checkboxButtonSize:i,isChecked:y,isFocused:g,checkboxSize:k,hasOwnLabel:$}},setStoreValue=(t,{model:r})=>{function e(){isArray$3(r.value)&&!r.value.includes(t.label)?r.value.push(t.label):r.value=t.trueLabel||!0}t.checked&&e()},useCheckbox=(t,r)=>{const{formItem:e}=useFormItem(),{model:n,isGroup:g,isLimitExceeded:y}=useCheckboxModel(t),{isFocused:i,isChecked:k,checkboxButtonSize:$,checkboxSize:L,hasOwnLabel:V}=useCheckboxStatus(t,r,{model:n}),{isDisabled:z}=useCheckboxDisabled({model:n,isChecked:k}),{inputId:re,isLabeledByFormItem:ie}=useFormItemInputId(t,{formItemContext:e,disableIdGeneration:V,disableIdManagement:g}),{handleChange:ue,onClickRoot:le}=useCheckboxEvent(t,{model:n,isLimitExceeded:y,hasOwnLabel:V,isDisabled:z,isLabeledByFormItem:ie});return setStoreValue(t,{model:n}),{inputId:re,isLabeledByFormItem:ie,isChecked:k,isDisabled:z,isFocused:i,checkboxButtonSize:$,checkboxSize:L,hasOwnLabel:V,model:n,handleChange:ue,onClickRoot:le}},_hoisted_1$u=["id","indeterminate","name","tabindex","disabled","true-value","false-value"],_hoisted_2$j=["id","indeterminate","disabled","value","name","tabindex"],__default__$s=defineComponent({name:"ElCheckbox"}),_sfc_main$Q=defineComponent({...__default__$s,props:checkboxProps,emits:checkboxEmits,setup(t){const r=t,e=useSlots(),{inputId:n,isLabeledByFormItem:g,isChecked:y,isDisabled:i,isFocused:k,checkboxSize:$,hasOwnLabel:L,model:V,handleChange:z,onClickRoot:re}=useCheckbox(r,e),ie=useNamespace("checkbox"),ue=computed(()=>[ie.b(),ie.m($.value),ie.is("disabled",i.value),ie.is("bordered",r.border),ie.is("checked",y.value)]),le=computed(()=>[ie.e("input"),ie.is("disabled",i.value),ie.is("checked",y.value),ie.is("indeterminate",r.indeterminate),ie.is("focus",k.value)]);return(oe,ae)=>(openBlock(),createBlock(resolveDynamicComponent(!unref(L)&&unref(g)?"span":"label"),{class:normalizeClass(unref(ue)),"aria-controls":oe.indeterminate?oe.controls:null,onClick:unref(re)},{default:withCtx(()=>[createBaseVNode("span",{class:normalizeClass(unref(le))},[oe.trueLabel||oe.falseLabel?withDirectives((openBlock(),createElementBlock("input",{key:0,id:unref(n),"onUpdate:modelValue":ae[0]||(ae[0]=qe=>isRef(V)?V.value=qe:null),class:normalizeClass(unref(ie).e("original")),type:"checkbox",indeterminate:oe.indeterminate,name:oe.name,tabindex:oe.tabindex,disabled:unref(i),"true-value":oe.trueLabel,"false-value":oe.falseLabel,onChange:ae[1]||(ae[1]=(...qe)=>unref(z)&&unref(z)(...qe)),onFocus:ae[2]||(ae[2]=qe=>k.value=!0),onBlur:ae[3]||(ae[3]=qe=>k.value=!1),onClick:ae[4]||(ae[4]=withModifiers(()=>{},["stop"]))},null,42,_hoisted_1$u)),[[vModelCheckbox,unref(V)]]):withDirectives((openBlock(),createElementBlock("input",{key:1,id:unref(n),"onUpdate:modelValue":ae[5]||(ae[5]=qe=>isRef(V)?V.value=qe:null),class:normalizeClass(unref(ie).e("original")),type:"checkbox",indeterminate:oe.indeterminate,disabled:unref(i),value:oe.label,name:oe.name,tabindex:oe.tabindex,onChange:ae[6]||(ae[6]=(...qe)=>unref(z)&&unref(z)(...qe)),onFocus:ae[7]||(ae[7]=qe=>k.value=!0),onBlur:ae[8]||(ae[8]=qe=>k.value=!1),onClick:ae[9]||(ae[9]=withModifiers(()=>{},["stop"]))},null,42,_hoisted_2$j)),[[vModelCheckbox,unref(V)]]),createBaseVNode("span",{class:normalizeClass(unref(ie).e("inner"))},null,2)],2),unref(L)?(openBlock(),createElementBlock("span",{key:0,class:normalizeClass(unref(ie).e("label"))},[renderSlot(oe.$slots,"default"),oe.$slots.default?createCommentVNode("v-if",!0):(openBlock(),createElementBlock(Fragment,{key:0},[createTextVNode(toDisplayString(oe.label),1)],64))],2)):createCommentVNode("v-if",!0)]),_:3},8,["class","aria-controls","onClick"]))}});var Checkbox=_export_sfc$1(_sfc_main$Q,[["__file","checkbox.vue"]]);const _hoisted_1$t=["name","tabindex","disabled","true-value","false-value"],_hoisted_2$i=["name","tabindex","disabled","value"],__default__$r=defineComponent({name:"ElCheckboxButton"}),_sfc_main$P=defineComponent({...__default__$r,props:checkboxProps,emits:checkboxEmits,setup(t){const r=t,e=useSlots(),{isFocused:n,isChecked:g,isDisabled:y,checkboxButtonSize:i,model:k,handleChange:$}=useCheckbox(r,e),L=inject(checkboxGroupContextKey,void 0),V=useNamespace("checkbox"),z=computed(()=>{var ie,ue,le,oe;const ae=(ue=(ie=L==null?void 0:L.fill)==null?void 0:ie.value)!=null?ue:"";return{backgroundColor:ae,borderColor:ae,color:(oe=(le=L==null?void 0:L.textColor)==null?void 0:le.value)!=null?oe:"",boxShadow:ae?`-1px 0 0 0 ${ae}`:void 0}}),re=computed(()=>[V.b("button"),V.bm("button",i.value),V.is("disabled",y.value),V.is("checked",g.value),V.is("focus",n.value)]);return(ie,ue)=>(openBlock(),createElementBlock("label",{class:normalizeClass(unref(re))},[ie.trueLabel||ie.falseLabel?withDirectives((openBlock(),createElementBlock("input",{key:0,"onUpdate:modelValue":ue[0]||(ue[0]=le=>isRef(k)?k.value=le:null),class:normalizeClass(unref(V).be("button","original")),type:"checkbox",name:ie.name,tabindex:ie.tabindex,disabled:unref(y),"true-value":ie.trueLabel,"false-value":ie.falseLabel,onChange:ue[1]||(ue[1]=(...le)=>unref($)&&unref($)(...le)),onFocus:ue[2]||(ue[2]=le=>n.value=!0),onBlur:ue[3]||(ue[3]=le=>n.value=!1),onClick:ue[4]||(ue[4]=withModifiers(()=>{},["stop"]))},null,42,_hoisted_1$t)),[[vModelCheckbox,unref(k)]]):withDirectives((openBlock(),createElementBlock("input",{key:1,"onUpdate:modelValue":ue[5]||(ue[5]=le=>isRef(k)?k.value=le:null),class:normalizeClass(unref(V).be("button","original")),type:"checkbox",name:ie.name,tabindex:ie.tabindex,disabled:unref(y),value:ie.label,onChange:ue[6]||(ue[6]=(...le)=>unref($)&&unref($)(...le)),onFocus:ue[7]||(ue[7]=le=>n.value=!0),onBlur:ue[8]||(ue[8]=le=>n.value=!1),onClick:ue[9]||(ue[9]=withModifiers(()=>{},["stop"]))},null,42,_hoisted_2$i)),[[vModelCheckbox,unref(k)]]),ie.$slots.default||ie.label?(openBlock(),createElementBlock("span",{key:2,class:normalizeClass(unref(V).be("button","inner")),style:normalizeStyle(unref(g)?unref(z):void 0)},[renderSlot(ie.$slots,"default",{},()=>[createTextVNode(toDisplayString(ie.label),1)])],6)):createCommentVNode("v-if",!0)],2))}});var CheckboxButton=_export_sfc$1(_sfc_main$P,[["__file","checkbox-button.vue"]]);const checkboxGroupProps=buildProps({modelValue:{type:definePropType(Array),default:()=>[]},disabled:Boolean,min:Number,max:Number,size:useSizeProp,label:String,fill:String,textColor:String,tag:{type:String,default:"div"},validateEvent:{type:Boolean,default:!0}}),checkboxGroupEmits={[UPDATE_MODEL_EVENT]:t=>isArray$3(t),change:t=>isArray$3(t)},__default__$q=defineComponent({name:"ElCheckboxGroup"}),_sfc_main$O=defineComponent({...__default__$q,props:checkboxGroupProps,emits:checkboxGroupEmits,setup(t,{emit:r}){const e=t,n=useNamespace("checkbox"),{formItem:g}=useFormItem(),{inputId:y,isLabeledByFormItem:i}=useFormItemInputId(e,{formItemContext:g}),k=async L=>{r(UPDATE_MODEL_EVENT,L),await nextTick(),r("change",L)},$=computed({get(){return e.modelValue},set(L){k(L)}});return provide(checkboxGroupContextKey,{...pick$1(toRefs(e),["size","min","max","disabled","validateEvent","fill","textColor"]),modelValue:$,changeEvent:k}),watch(()=>e.modelValue,()=>{e.validateEvent&&(g==null||g.validate("change").catch(L=>void 0))}),(L,V)=>{var z;return openBlock(),createBlock(resolveDynamicComponent(L.tag),{id:unref(y),class:normalizeClass(unref(n).b("group")),role:"group","aria-label":unref(i)?void 0:L.label||"checkbox-group","aria-labelledby":unref(i)?(z=unref(g))==null?void 0:z.labelId:void 0},{default:withCtx(()=>[renderSlot(L.$slots,"default")]),_:3},8,["id","class","aria-label","aria-labelledby"])}}});var CheckboxGroup=_export_sfc$1(_sfc_main$O,[["__file","checkbox-group.vue"]]);const ElCheckbox=withInstall(Checkbox,{CheckboxButton,CheckboxGroup});withNoopInstall(CheckboxButton);const ElCheckboxGroup$1=withNoopInstall(CheckboxGroup),radioPropsBase=buildProps({size:useSizeProp,disabled:Boolean,label:{type:[String,Number,Boolean],default:""}}),radioProps=buildProps({...radioPropsBase,modelValue:{type:[String,Number,Boolean],default:""},name:{type:String,default:""},border:Boolean}),radioEmits={[UPDATE_MODEL_EVENT]:t=>isString$2(t)||isNumber$1(t)||isBoolean$1(t),[CHANGE_EVENT]:t=>isString$2(t)||isNumber$1(t)||isBoolean$1(t)},radioGroupKey=Symbol("radioGroupKey"),useRadio=(t,r)=>{const e=ref(),n=inject(radioGroupKey,void 0),g=computed(()=>!!n),y=computed({get(){return g.value?n.modelValue:t.modelValue},set(V){g.value?n.changeEvent(V):r&&r(UPDATE_MODEL_EVENT,V),e.value.checked=t.modelValue===t.label}}),i=useFormSize(computed(()=>n==null?void 0:n.size)),k=useFormDisabled(computed(()=>n==null?void 0:n.disabled)),$=ref(!1),L=computed(()=>k.value||g.value&&y.value!==t.label?-1:0);return{radioRef:e,isGroup:g,radioGroup:n,focus:$,size:i,disabled:k,tabIndex:L,modelValue:y}},_hoisted_1$s=["value","name","disabled"],__default__$p=defineComponent({name:"ElRadio"}),_sfc_main$N=defineComponent({...__default__$p,props:radioProps,emits:radioEmits,setup(t,{emit:r}){const e=t,n=useNamespace("radio"),{radioRef:g,radioGroup:y,focus:i,size:k,disabled:$,modelValue:L}=useRadio(e,r);function V(){nextTick(()=>r("change",L.value))}return(z,re)=>{var ie;return openBlock(),createElementBlock("label",{class:normalizeClass([unref(n).b(),unref(n).is("disabled",unref($)),unref(n).is("focus",unref(i)),unref(n).is("bordered",z.border),unref(n).is("checked",unref(L)===z.label),unref(n).m(unref(k))])},[createBaseVNode("span",{class:normalizeClass([unref(n).e("input"),unref(n).is("disabled",unref($)),unref(n).is("checked",unref(L)===z.label)])},[withDirectives(createBaseVNode("input",{ref_key:"radioRef",ref:g,"onUpdate:modelValue":re[0]||(re[0]=ue=>isRef(L)?L.value=ue:null),class:normalizeClass(unref(n).e("original")),value:z.label,name:z.name||((ie=unref(y))==null?void 0:ie.name),disabled:unref($),type:"radio",onFocus:re[1]||(re[1]=ue=>i.value=!0),onBlur:re[2]||(re[2]=ue=>i.value=!1),onChange:V,onClick:re[3]||(re[3]=withModifiers(()=>{},["stop"]))},null,42,_hoisted_1$s),[[vModelRadio,unref(L)]]),createBaseVNode("span",{class:normalizeClass(unref(n).e("inner"))},null,2)],2),createBaseVNode("span",{class:normalizeClass(unref(n).e("label")),onKeydown:re[4]||(re[4]=withModifiers(()=>{},["stop"]))},[renderSlot(z.$slots,"default",{},()=>[createTextVNode(toDisplayString(z.label),1)])],34)],2)}}});var Radio=_export_sfc$1(_sfc_main$N,[["__file","radio.vue"]]);const radioButtonProps=buildProps({...radioPropsBase,name:{type:String,default:""}}),_hoisted_1$r=["value","name","disabled"],__default__$o=defineComponent({name:"ElRadioButton"}),_sfc_main$M=defineComponent({...__default__$o,props:radioButtonProps,setup(t){const r=t,e=useNamespace("radio"),{radioRef:n,focus:g,size:y,disabled:i,modelValue:k,radioGroup:$}=useRadio(r),L=computed(()=>({backgroundColor:($==null?void 0:$.fill)||"",borderColor:($==null?void 0:$.fill)||"",boxShadow:$!=null&&$.fill?`-1px 0 0 0 ${$.fill}`:"",color:($==null?void 0:$.textColor)||""}));return(V,z)=>{var re;return openBlock(),createElementBlock("label",{class:normalizeClass([unref(e).b("button"),unref(e).is("active",unref(k)===V.label),unref(e).is("disabled",unref(i)),unref(e).is("focus",unref(g)),unref(e).bm("button",unref(y))])},[withDirectives(createBaseVNode("input",{ref_key:"radioRef",ref:n,"onUpdate:modelValue":z[0]||(z[0]=ie=>isRef(k)?k.value=ie:null),class:normalizeClass(unref(e).be("button","original-radio")),value:V.label,type:"radio",name:V.name||((re=unref($))==null?void 0:re.name),disabled:unref(i),onFocus:z[1]||(z[1]=ie=>g.value=!0),onBlur:z[2]||(z[2]=ie=>g.value=!1),onClick:z[3]||(z[3]=withModifiers(()=>{},["stop"]))},null,42,_hoisted_1$r),[[vModelRadio,unref(k)]]),createBaseVNode("span",{class:normalizeClass(unref(e).be("button","inner")),style:normalizeStyle(unref(k)===V.label?unref(L):{}),onKeydown:z[4]||(z[4]=withModifiers(()=>{},["stop"]))},[renderSlot(V.$slots,"default",{},()=>[createTextVNode(toDisplayString(V.label),1)])],38)],2)}}});var RadioButton=_export_sfc$1(_sfc_main$M,[["__file","radio-button.vue"]]);const radioGroupProps=buildProps({id:{type:String,default:void 0},size:useSizeProp,disabled:Boolean,modelValue:{type:[String,Number,Boolean],default:""},fill:{type:String,default:""},label:{type:String,default:void 0},textColor:{type:String,default:""},name:{type:String,default:void 0},validateEvent:{type:Boolean,default:!0}}),radioGroupEmits=radioEmits,_hoisted_1$q=["id","aria-label","aria-labelledby"],__default__$n=defineComponent({name:"ElRadioGroup"}),_sfc_main$L=defineComponent({...__default__$n,props:radioGroupProps,emits:radioGroupEmits,setup(t,{emit:r}){const e=t,n=useNamespace("radio"),g=useId(),y=ref(),{formItem:i}=useFormItem(),{inputId:k,isLabeledByFormItem:$}=useFormItemInputId(e,{formItemContext:i}),L=z=>{r(UPDATE_MODEL_EVENT,z),nextTick(()=>r("change",z))};onMounted(()=>{const z=y.value.querySelectorAll("[type=radio]"),re=z[0];!Array.from(z).some(ie=>ie.checked)&&re&&(re.tabIndex=0)});const V=computed(()=>e.name||g.value);return provide(radioGroupKey,reactive({...toRefs(e),changeEvent:L,name:V})),watch(()=>e.modelValue,()=>{e.validateEvent&&(i==null||i.validate("change").catch(z=>void 0))}),(z,re)=>(openBlock(),createElementBlock("div",{id:unref(k),ref_key:"radioGroupRef",ref:y,class:normalizeClass(unref(n).b("group")),role:"radiogroup","aria-label":unref($)?void 0:z.label||"radio-group","aria-labelledby":unref($)?unref(i).labelId:void 0},[renderSlot(z.$slots,"default")],10,_hoisted_1$q))}});var RadioGroup=_export_sfc$1(_sfc_main$L,[["__file","radio-group.vue"]]);const ElRadio=withInstall(Radio,{RadioButton,RadioGroup}),ElRadioGroup=withNoopInstall(RadioGroup);withNoopInstall(RadioButton);var NodeContent=defineComponent({name:"NodeContent",setup(){return{ns:useNamespace("cascader-node")}},render(){const{ns:t}=this,{node:r,panel:e}=this.$parent,{data:n,label:g}=r,{renderLabelFn:y}=e;return h$1("span",{class:t.e("label")},y?y({node:r,data:n}):g)}});const CASCADER_PANEL_INJECTION_KEY=Symbol(),_sfc_main$K=defineComponent({name:"ElCascaderNode",components:{ElCheckbox,ElRadio,NodeContent,ElIcon,Check:check_default,Loading:loading_default,ArrowRight:arrow_right_default},props:{node:{type:Object,required:!0},menuId:String},emits:["expand"],setup(t,{emit:r}){const e=inject(CASCADER_PANEL_INJECTION_KEY),n=useNamespace("cascader-node"),g=computed(()=>e.isHoverMenu),y=computed(()=>e.config.multiple),i=computed(()=>e.config.checkStrictly),k=computed(()=>{var $e;return($e=e.checkedNodes[0])==null?void 0:$e.uid}),$=computed(()=>t.node.isDisabled),L=computed(()=>t.node.isLeaf),V=computed(()=>i.value&&!L.value||!$.value),z=computed(()=>ie(e.expandingNode)),re=computed(()=>i.value&&e.checkedNodes.some(ie)),ie=$e=>{var Lt;const{level:jt,uid:Et}=t.node;return((Lt=$e==null?void 0:$e.pathNodes[jt-1])==null?void 0:Lt.uid)===Et},ue=()=>{z.value||e.expandNode(t.node)},le=$e=>{const{node:Lt}=t;$e!==Lt.checked&&e.handleCheckChange(Lt,$e)},oe=()=>{e.lazyLoad(t.node,()=>{L.value||ue()})},ae=$e=>{g.value&&(qe(),!L.value&&r("expand",$e))},qe=()=>{const{node:$e}=t;!V.value||$e.loading||($e.loaded?ue():oe())},de=()=>{g.value&&!L.value||(L.value&&!$.value&&!i.value&&!y.value?ze(!0):qe())},Ne=$e=>{i.value?(le($e),t.node.loaded&&ue()):ze($e)},ze=$e=>{t.node.loaded?(le($e),!i.value&&ue()):oe()};return{panel:e,isHoverMenu:g,multiple:y,checkStrictly:i,checkedNodeId:k,isDisabled:$,isLeaf:L,expandable:V,inExpandingPath:z,inCheckedPath:re,ns:n,handleHoverExpand:ae,handleExpand:qe,handleClick:de,handleCheck:ze,handleSelectCheck:Ne}}}),_hoisted_1$p=["id","aria-haspopup","aria-owns","aria-expanded","tabindex"],_hoisted_2$h=createBaseVNode("span",null,null,-1);function _sfc_render$8(t,r,e,n,g,y){const i=resolveComponent("el-checkbox"),k=resolveComponent("el-radio"),$=resolveComponent("check"),L=resolveComponent("el-icon"),V=resolveComponent("node-content"),z=resolveComponent("loading"),re=resolveComponent("arrow-right");return openBlock(),createElementBlock("li",{id:`${t.menuId}-${t.node.uid}`,role:"menuitem","aria-haspopup":!t.isLeaf,"aria-owns":t.isLeaf?null:t.menuId,"aria-expanded":t.inExpandingPath,tabindex:t.expandable?-1:void 0,class:normalizeClass([t.ns.b(),t.ns.is("selectable",t.checkStrictly),t.ns.is("active",t.node.checked),t.ns.is("disabled",!t.expandable),t.inExpandingPath&&"in-active-path",t.inCheckedPath&&"in-checked-path"]),onMouseenter:r[2]||(r[2]=(...ie)=>t.handleHoverExpand&&t.handleHoverExpand(...ie)),onFocus:r[3]||(r[3]=(...ie)=>t.handleHoverExpand&&t.handleHoverExpand(...ie)),onClick:r[4]||(r[4]=(...ie)=>t.handleClick&&t.handleClick(...ie))},[createCommentVNode(" prefix "),t.multiple?(openBlock(),createBlock(i,{key:0,"model-value":t.node.checked,indeterminate:t.node.indeterminate,disabled:t.isDisabled,onClick:r[0]||(r[0]=withModifiers(()=>{},["stop"])),"onUpdate:modelValue":t.handleSelectCheck},null,8,["model-value","indeterminate","disabled","onUpdate:modelValue"])):t.checkStrictly?(openBlock(),createBlock(k,{key:1,"model-value":t.checkedNodeId,label:t.node.uid,disabled:t.isDisabled,"onUpdate:modelValue":t.handleSelectCheck,onClick:r[1]||(r[1]=withModifiers(()=>{},["stop"]))},{default:withCtx(()=>[createCommentVNode(`
        Add an empty element to avoid render label,
        do not use empty fragment here for https://github.com/vuejs/vue-next/pull/2485
      `),_hoisted_2$h]),_:1},8,["model-value","label","disabled","onUpdate:modelValue"])):t.isLeaf&&t.node.checked?(openBlock(),createBlock(L,{key:2,class:normalizeClass(t.ns.e("prefix"))},{default:withCtx(()=>[createVNode($)]),_:1},8,["class"])):createCommentVNode("v-if",!0),createCommentVNode(" content "),createVNode(V),createCommentVNode(" postfix "),t.isLeaf?createCommentVNode("v-if",!0):(openBlock(),createElementBlock(Fragment,{key:3},[t.node.loading?(openBlock(),createBlock(L,{key:0,class:normalizeClass([t.ns.is("loading"),t.ns.e("postfix")])},{default:withCtx(()=>[createVNode(z)]),_:1},8,["class"])):(openBlock(),createBlock(L,{key:1,class:normalizeClass(["arrow-right",t.ns.e("postfix")])},{default:withCtx(()=>[createVNode(re)]),_:1},8,["class"]))],64))],42,_hoisted_1$p)}var ElCascaderNode=_export_sfc$1(_sfc_main$K,[["render",_sfc_render$8],["__file","node.vue"]]);const _sfc_main$J=defineComponent({name:"ElCascaderMenu",components:{Loading:loading_default,ElIcon,ElScrollbar,ElCascaderNode},props:{nodes:{type:Array,required:!0},index:{type:Number,required:!0}},setup(t){const r=getCurrentInstance(),e=useNamespace("cascader-menu"),{t:n}=useLocale(),g=useId();let y=null,i=null;const k=inject(CASCADER_PANEL_INJECTION_KEY),$=ref(null),L=computed(()=>!t.nodes.length),V=computed(()=>!k.initialLoaded),z=computed(()=>`${g.value}-${t.index}`),re=oe=>{y=oe.target},ie=oe=>{if(!(!k.isHoverMenu||!y||!$.value))if(y.contains(oe.target)){ue();const ae=r.vnode.el,{left:qe}=ae.getBoundingClientRect(),{offsetWidth:de,offsetHeight:Ne}=ae,ze=oe.clientX-qe,$e=y.offsetTop,Lt=$e+y.offsetHeight;$.value.innerHTML=`
          <path style="pointer-events: auto;" fill="transparent" d="M${ze} ${$e} L${de} 0 V${$e} Z" />
          <path style="pointer-events: auto;" fill="transparent" d="M${ze} ${Lt} L${de} ${Ne} V${Lt} Z" />
        `}else i||(i=window.setTimeout(le,k.config.hoverThreshold))},ue=()=>{i&&(clearTimeout(i),i=null)},le=()=>{$.value&&($.value.innerHTML="",ue())};return{ns:e,panel:k,hoverZone:$,isEmpty:L,isLoading:V,menuId:z,t:n,handleExpand:re,handleMouseMove:ie,clearHoverZone:le}}});function _sfc_render$7(t,r,e,n,g,y){const i=resolveComponent("el-cascader-node"),k=resolveComponent("loading"),$=resolveComponent("el-icon"),L=resolveComponent("el-scrollbar");return openBlock(),createBlock(L,{key:t.menuId,tag:"ul",role:"menu",class:normalizeClass(t.ns.b()),"wrap-class":t.ns.e("wrap"),"view-class":[t.ns.e("list"),t.ns.is("empty",t.isEmpty)],onMousemove:t.handleMouseMove,onMouseleave:t.clearHoverZone},{default:withCtx(()=>{var V;return[(openBlock(!0),createElementBlock(Fragment,null,renderList(t.nodes,z=>(openBlock(),createBlock(i,{key:z.uid,node:z,"menu-id":t.menuId,onExpand:t.handleExpand},null,8,["node","menu-id","onExpand"]))),128)),t.isLoading?(openBlock(),createElementBlock("div",{key:0,class:normalizeClass(t.ns.e("empty-text"))},[createVNode($,{size:"14",class:normalizeClass(t.ns.is("loading"))},{default:withCtx(()=>[createVNode(k)]),_:1},8,["class"]),createTextVNode(" "+toDisplayString(t.t("el.cascader.loading")),1)],2)):t.isEmpty?(openBlock(),createElementBlock("div",{key:1,class:normalizeClass(t.ns.e("empty-text"))},toDisplayString(t.t("el.cascader.noData")),3)):(V=t.panel)!=null&&V.isHoverMenu?(openBlock(),createElementBlock("svg",{key:2,ref:"hoverZone",class:normalizeClass(t.ns.e("hover-zone"))},null,2)):createCommentVNode("v-if",!0)]}),_:1},8,["class","wrap-class","view-class","onMousemove","onMouseleave"])}var ElCascaderMenu=_export_sfc$1(_sfc_main$J,[["render",_sfc_render$7],["__file","menu.vue"]]);let uid=0;const calculatePathNodes=t=>{const r=[t];let{parent:e}=t;for(;e;)r.unshift(e),e=e.parent;return r};class Node{constructor(r,e,n,g=!1){this.data=r,this.config=e,this.parent=n,this.root=g,this.uid=uid++,this.checked=!1,this.indeterminate=!1,this.loading=!1;const{value:y,label:i,children:k}=e,$=r[k],L=calculatePathNodes(this);this.level=g?0:n?n.level+1:1,this.value=r[y],this.label=r[i],this.pathNodes=L,this.pathValues=L.map(V=>V.value),this.pathLabels=L.map(V=>V.label),this.childrenData=$,this.children=($||[]).map(V=>new Node(V,e,this)),this.loaded=!e.lazy||this.isLeaf||!isEmpty($)}get isDisabled(){const{data:r,parent:e,config:n}=this,{disabled:g,checkStrictly:y}=n;return(isFunction$3(g)?g(r,this):!!r[g])||!y&&(e==null?void 0:e.isDisabled)}get isLeaf(){const{data:r,config:e,childrenData:n,loaded:g}=this,{lazy:y,leaf:i}=e,k=isFunction$3(i)?i(r,this):r[i];return isUndefined$1(k)?y&&!g?!1:!(Array.isArray(n)&&n.length):!!k}get valueByOption(){return this.config.emitPath?this.pathValues:this.value}appendChild(r){const{childrenData:e,children:n}=this,g=new Node(r,this.config,this);return Array.isArray(e)?e.push(r):this.childrenData=[r],n.push(g),g}calcText(r,e){const n=r?this.pathLabels.join(e):this.label;return this.text=n,n}broadcast(r,...e){const n=`onParent${capitalize(r)}`;this.children.forEach(g=>{g&&(g.broadcast(r,...e),g[n]&&g[n](...e))})}emit(r,...e){const{parent:n}=this,g=`onChild${capitalize(r)}`;n&&(n[g]&&n[g](...e),n.emit(r,...e))}onParentCheck(r){this.isDisabled||this.setCheckState(r)}onChildCheck(){const{children:r}=this,e=r.filter(g=>!g.isDisabled),n=e.length?e.every(g=>g.checked):!1;this.setCheckState(n)}setCheckState(r){const e=this.children.length,n=this.children.reduce((g,y)=>{const i=y.checked?1:y.indeterminate?.5:0;return g+i},0);this.checked=this.loaded&&this.children.filter(g=>!g.isDisabled).every(g=>g.loaded&&g.checked)&&r,this.indeterminate=this.loaded&&n!==e&&n>0}doCheck(r){if(this.checked===r)return;const{checkStrictly:e,multiple:n}=this.config;e||!n?this.checked=r:(this.broadcast("check",r),this.setCheckState(r),this.emit("check"))}}const flatNodes=(t,r)=>t.reduce((e,n)=>(n.isLeaf?e.push(n):(!r&&e.push(n),e=e.concat(flatNodes(n.children,r))),e),[]);class Store{constructor(r,e){this.config=e;const n=(r||[]).map(g=>new Node(g,this.config));this.nodes=n,this.allNodes=flatNodes(n,!1),this.leafNodes=flatNodes(n,!0)}getNodes(){return this.nodes}getFlattedNodes(r){return r?this.leafNodes:this.allNodes}appendNode(r,e){const n=e?e.appendChild(r):new Node(r,this.config);e||this.nodes.push(n),this.allNodes.push(n),n.isLeaf&&this.leafNodes.push(n)}appendNodes(r,e){r.forEach(n=>this.appendNode(n,e))}getNodeByValue(r,e=!1){return!r&&r!==0?null:this.getFlattedNodes(e).find(g=>isEqual(g.value,r)||isEqual(g.pathValues,r))||null}getSameNode(r){return r&&this.getFlattedNodes(!1).find(({value:n,level:g})=>isEqual(r.value,n)&&r.level===g)||null}}const CommonProps=buildProps({modelValue:{type:definePropType([Number,String,Array])},options:{type:definePropType(Array),default:()=>[]},props:{type:definePropType(Object),default:()=>({})}}),DefaultProps={expandTrigger:"click",multiple:!1,checkStrictly:!1,emitPath:!0,lazy:!1,lazyLoad:NOOP,value:"value",label:"label",children:"children",leaf:"leaf",disabled:"disabled",hoverThreshold:500},useCascaderConfig=t=>computed(()=>({...DefaultProps,...t.props})),getMenuIndex=t=>{if(!t)return 0;const r=t.id.split("-");return Number(r[r.length-2])},checkNode=t=>{if(!t)return;const r=t.querySelector("input");r?r.click():isLeaf(t)&&t.click()},sortByOriginalOrder=(t,r)=>{const e=r.slice(0),n=e.map(y=>y.uid),g=t.reduce((y,i)=>{const k=n.indexOf(i.uid);return k>-1&&(y.push(i),e.splice(k,1),n.splice(k,1)),y},[]);return g.push(...e),g},_sfc_main$I=defineComponent({name:"ElCascaderPanel",components:{ElCascaderMenu},props:{...CommonProps,border:{type:Boolean,default:!0},renderLabel:Function},emits:[UPDATE_MODEL_EVENT,CHANGE_EVENT,"close","expand-change"],setup(t,{emit:r,slots:e}){let n=!1;const g=useNamespace("cascader"),y=useCascaderConfig(t);let i=null;const k=ref(!0),$=ref([]),L=ref(null),V=ref([]),z=ref(null),re=ref([]),ie=computed(()=>y.value.expandTrigger==="hover"),ue=computed(()=>t.renderLabel||e.default),le=()=>{const{options:Dt}=t,lr=y.value;n=!1,i=new Store(Dt,lr),V.value=[i.getNodes()],lr.lazy&&isEmpty(t.options)?(k.value=!1,oe(void 0,sr=>{sr&&(i=new Store(sr,lr),V.value=[i.getNodes()]),k.value=!0,jt(!1,!0)})):jt(!1,!0)},oe=(Dt,lr)=>{const sr=y.value;Dt=Dt||new Node({},sr,void 0,!0),Dt.loading=!0;const er=cr=>{const or=Dt,hr=or.root?null:or;cr&&(i==null||i.appendNodes(cr,hr)),or.loading=!1,or.loaded=!0,or.childrenData=or.childrenData||[],lr&&lr(cr)};sr.lazyLoad(Dt,er)},ae=(Dt,lr)=>{var sr;const{level:er}=Dt,cr=V.value.slice(0,er);let or;Dt.isLeaf?or=Dt.pathNodes[er-2]:(or=Dt,cr.push(Dt.children)),((sr=z.value)==null?void 0:sr.uid)!==(or==null?void 0:or.uid)&&(z.value=Dt,V.value=cr,!lr&&r("expand-change",(Dt==null?void 0:Dt.pathValues)||[]))},qe=(Dt,lr,sr=!0)=>{const{checkStrictly:er,multiple:cr}=y.value,or=re.value[0];n=!0,!cr&&(or==null||or.doCheck(!1)),Dt.doCheck(lr),Lt(),sr&&!cr&&!er&&r("close"),!sr&&!cr&&!er&&de(Dt)},de=Dt=>{Dt&&(Dt=Dt.parent,de(Dt),Dt&&ae(Dt))},Ne=Dt=>i==null?void 0:i.getFlattedNodes(Dt),ze=Dt=>{var lr;return(lr=Ne(Dt))==null?void 0:lr.filter(sr=>sr.checked!==!1)},$e=()=>{re.value.forEach(Dt=>Dt.doCheck(!1)),Lt(),V.value=V.value.slice(0,1),z.value=null,r("expand-change",[])},Lt=()=>{var Dt;const{checkStrictly:lr,multiple:sr}=y.value,er=re.value,cr=ze(!lr),or=sortByOriginalOrder(er,cr),hr=or.map(pr=>pr.valueByOption);re.value=or,L.value=sr?hr:(Dt=hr[0])!=null?Dt:null},jt=(Dt=!1,lr=!1)=>{const{modelValue:sr}=t,{lazy:er,multiple:cr,checkStrictly:or}=y.value,hr=!or;if(!(!k.value||n||!lr&&isEqual(sr,L.value)))if(er&&!Dt){const Sr=unique(flattenDeep(castArray(sr))).map(Er=>i==null?void 0:i.getNodeByValue(Er)).filter(Er=>!!Er&&!Er.loaded&&!Er.loading);Sr.length?Sr.forEach(Er=>{oe(Er,()=>jt(!1,lr))}):jt(!0,lr)}else{const pr=cr?castArray(sr):[sr],Sr=unique(pr.map(Er=>i==null?void 0:i.getNodeByValue(Er,hr)));Et(Sr,lr),L.value=cloneDeep(sr)}},Et=(Dt,lr=!0)=>{const{checkStrictly:sr}=y.value,er=re.value,cr=Dt.filter(pr=>!!pr&&(sr||pr.isLeaf)),or=i==null?void 0:i.getSameNode(z.value),hr=lr&&or||cr[0];hr?hr.pathNodes.forEach(pr=>ae(pr,!0)):z.value=null,er.forEach(pr=>pr.doCheck(!1)),t.props.multiple?reactive(cr).forEach(pr=>pr.doCheck(!0)):cr.forEach(pr=>pr.doCheck(!0)),re.value=cr,nextTick(ir)},ir=()=>{isClient&&$.value.forEach(Dt=>{const lr=Dt==null?void 0:Dt.$el;if(lr){const sr=lr.querySelector(`.${g.namespace.value}-scrollbar__wrap`),er=lr.querySelector(`.${g.b("node")}.${g.is("active")}`)||lr.querySelector(`.${g.b("node")}.in-active-path`);scrollIntoView(sr,er)}})},dr=Dt=>{const lr=Dt.target,{code:sr}=Dt;switch(sr){case EVENT_CODE.up:case EVENT_CODE.down:{Dt.preventDefault();const er=sr===EVENT_CODE.up?-1:1;focusNode(getSibling(lr,er,`.${g.b("node")}[tabindex="-1"]`));break}case EVENT_CODE.left:{Dt.preventDefault();const er=$.value[getMenuIndex(lr)-1],cr=er==null?void 0:er.$el.querySelector(`.${g.b("node")}[aria-expanded="true"]`);focusNode(cr);break}case EVENT_CODE.right:{Dt.preventDefault();const er=$.value[getMenuIndex(lr)+1],cr=er==null?void 0:er.$el.querySelector(`.${g.b("node")}[tabindex="-1"]`);focusNode(cr);break}case EVENT_CODE.enter:checkNode(lr);break}};return provide(CASCADER_PANEL_INJECTION_KEY,reactive({config:y,expandingNode:z,checkedNodes:re,isHoverMenu:ie,initialLoaded:k,renderLabelFn:ue,lazyLoad:oe,expandNode:ae,handleCheckChange:qe})),watch([y,()=>t.options],le,{deep:!0,immediate:!0}),watch(()=>t.modelValue,()=>{n=!1,jt()},{deep:!0}),watch(()=>L.value,Dt=>{isEqual(Dt,t.modelValue)||(r(UPDATE_MODEL_EVENT,Dt),r(CHANGE_EVENT,Dt))}),onBeforeUpdate(()=>$.value=[]),onMounted(()=>!isEmpty(t.modelValue)&&jt()),{ns:g,menuList:$,menus:V,checkedNodes:re,handleKeyDown:dr,handleCheckChange:qe,getFlattedNodes:Ne,getCheckedNodes:ze,clearCheckedNodes:$e,calculateCheckedValue:Lt,scrollToExpandingNode:ir}}});function _sfc_render$6(t,r,e,n,g,y){const i=resolveComponent("el-cascader-menu");return openBlock(),createElementBlock("div",{class:normalizeClass([t.ns.b("panel"),t.ns.is("bordered",t.border)]),onKeydown:r[0]||(r[0]=(...k)=>t.handleKeyDown&&t.handleKeyDown(...k))},[(openBlock(!0),createElementBlock(Fragment,null,renderList(t.menus,(k,$)=>(openBlock(),createBlock(i,{key:$,ref_for:!0,ref:L=>t.menuList[$]=L,index:$,nodes:[...k]},null,8,["index","nodes"]))),128))],34)}var CascaderPanel=_export_sfc$1(_sfc_main$I,[["render",_sfc_render$6],["__file","index.vue"]]);CascaderPanel.install=t=>{t.component(CascaderPanel.name,CascaderPanel)};const _CascaderPanel=CascaderPanel,tagProps=buildProps({type:{type:String,values:["primary","success","info","warning","danger"],default:"primary"},closable:Boolean,disableTransitions:Boolean,hit:Boolean,color:String,size:{type:String,values:componentSizes},effect:{type:String,values:["dark","light","plain"],default:"light"},round:Boolean}),tagEmits={close:t=>t instanceof MouseEvent,click:t=>t instanceof MouseEvent},__default__$m=defineComponent({name:"ElTag"}),_sfc_main$H=defineComponent({...__default__$m,props:tagProps,emits:tagEmits,setup(t,{emit:r}){const e=t,n=useFormSize(),g=useNamespace("tag"),y=computed(()=>{const{type:$,hit:L,effect:V,closable:z,round:re}=e;return[g.b(),g.is("closable",z),g.m($||"primary"),g.m(n.value),g.m(V),g.is("hit",L),g.is("round",re)]}),i=$=>{r("close",$)},k=$=>{r("click",$)};return($,L)=>$.disableTransitions?(openBlock(),createElementBlock("span",{key:0,class:normalizeClass(unref(y)),style:normalizeStyle({backgroundColor:$.color}),onClick:k},[createBaseVNode("span",{class:normalizeClass(unref(g).e("content"))},[renderSlot($.$slots,"default")],2),$.closable?(openBlock(),createBlock(unref(ElIcon),{key:0,class:normalizeClass(unref(g).e("close")),onClick:withModifiers(i,["stop"])},{default:withCtx(()=>[createVNode(unref(close_default))]),_:1},8,["class","onClick"])):createCommentVNode("v-if",!0)],6)):(openBlock(),createBlock(Transition,{key:1,name:`${unref(g).namespace.value}-zoom-in-center`,appear:""},{default:withCtx(()=>[createBaseVNode("span",{class:normalizeClass(unref(y)),style:normalizeStyle({backgroundColor:$.color}),onClick:k},[createBaseVNode("span",{class:normalizeClass(unref(g).e("content"))},[renderSlot($.$slots,"default")],2),$.closable?(openBlock(),createBlock(unref(ElIcon),{key:0,class:normalizeClass(unref(g).e("close")),onClick:withModifiers(i,["stop"])},{default:withCtx(()=>[createVNode(unref(close_default))]),_:1},8,["class","onClick"])):createCommentVNode("v-if",!0)],6)]),_:3},8,["name"]))}});var Tag=_export_sfc$1(_sfc_main$H,[["__file","tag.vue"]]);const ElTag=withInstall(Tag),cascaderProps=buildProps({...CommonProps,size:useSizeProp,placeholder:String,disabled:Boolean,clearable:Boolean,filterable:Boolean,filterMethod:{type:definePropType(Function),default:(t,r)=>t.text.includes(r)},separator:{type:String,default:" / "},showAllLevels:{type:Boolean,default:!0},collapseTags:Boolean,maxCollapseTags:{type:Number,default:1},collapseTagsTooltip:{type:Boolean,default:!1},debounce:{type:Number,default:300},beforeFilter:{type:definePropType(Function),default:()=>!0},popperClass:{type:String,default:""},teleported:useTooltipContentProps.teleported,tagType:{...tagProps.type,default:"info"},validateEvent:{type:Boolean,default:!0}}),cascaderEmits={[UPDATE_MODEL_EVENT]:t=>!!t||t===null,[CHANGE_EVENT]:t=>!!t||t===null,focus:t=>t instanceof FocusEvent,blur:t=>t instanceof FocusEvent,visibleChange:t=>isBoolean$1(t),expandChange:t=>!!t,removeTag:t=>!!t},_hoisted_1$o={key:0},_hoisted_2$g=["placeholder","onKeydown"],_hoisted_3$b=["onClick"],COMPONENT_NAME$5="ElCascader",__default__$l=defineComponent({name:COMPONENT_NAME$5}),_sfc_main$G=defineComponent({...__default__$l,props:cascaderProps,emits:cascaderEmits,setup(t,{expose:r,emit:e}){const n=t,g={modifiers:[{name:"arrowPosition",enabled:!0,phase:"main",fn:({state:vn})=>{const{modifiersData:hn,placement:Yn}=vn;["right","left","bottom","top"].includes(Yn)||(hn.arrow.x=35)},requires:["arrow"]}]},y=useAttrs$1();let i=0,k=0;const $=useNamespace("cascader"),L=useNamespace("input"),{t:V}=useLocale(),{form:z,formItem:re}=useFormItem(),ie=ref(null),ue=ref(null),le=ref(null),oe=ref(null),ae=ref(null),qe=ref(!1),de=ref(!1),Ne=ref(!1),ze=ref(!1),$e=ref(""),Lt=ref(""),jt=ref([]),Et=ref([]),ir=ref([]),dr=ref(!1),Dt=computed(()=>y.style),lr=computed(()=>n.disabled||(z==null?void 0:z.disabled)),sr=computed(()=>n.placeholder||V("el.cascader.placeholder")),er=computed(()=>Lt.value||jt.value.length>0||dr.value?"":sr.value),cr=useFormSize(),or=computed(()=>["small"].includes(cr.value)?"small":"default"),hr=computed(()=>!!n.props.multiple),pr=computed(()=>!n.filterable||hr.value),Sr=computed(()=>hr.value?Lt.value:$e.value),Er=computed(()=>{var vn;return((vn=oe.value)==null?void 0:vn.checkedNodes)||[]}),Pr=computed(()=>!n.clearable||lr.value||Ne.value||!de.value?!1:!!Er.value.length),Cr=computed(()=>{const{showAllLevels:vn,separator:hn}=n,Yn=Er.value;return Yn.length?hr.value?"":Yn[0].calcText(vn,hn):""}),rr=computed({get(){return cloneDeep(n.modelValue)},set(vn){e(UPDATE_MODEL_EVENT,vn),e(CHANGE_EVENT,vn),n.validateEvent&&(re==null||re.validate("change").catch(hn=>void 0))}}),kr=computed(()=>[$.b(),$.m(cr.value),$.is("disabled",lr.value),y.class]),Ir=computed(()=>[L.e("icon"),"icon-arrow-down",$.is("reverse",qe.value)]),xr=computed(()=>$.is("focus",qe.value||ze.value)),vr=computed(()=>{var vn,hn;return(hn=(vn=ie.value)==null?void 0:vn.popperRef)==null?void 0:hn.contentRef}),_r=vn=>{var hn,Yn,Oo;lr.value||(vn=vn??!qe.value,vn!==qe.value&&(qe.value=vn,(Yn=(hn=ue.value)==null?void 0:hn.input)==null||Yn.setAttribute("aria-expanded",`${vn}`),vn?(Or(),nextTick((Oo=oe.value)==null?void 0:Oo.scrollToExpandingNode)):n.filterable&&Xr(),e("visibleChange",vn)))},Or=()=>{nextTick(()=>{var vn;(vn=ie.value)==null||vn.updatePopper()})},Mr=()=>{Ne.value=!1},yr=vn=>{const{showAllLevels:hn,separator:Yn}=n;return{node:vn,key:vn.uid,text:vn.calcText(hn,Yn),hitState:!1,closable:!lr.value&&!vn.isDisabled,isCollapseTag:!1}},mr=vn=>{var hn;const Yn=vn.node;Yn.doCheck(!1),(hn=oe.value)==null||hn.calculateCheckedValue(),e("removeTag",Yn.valueByOption)},Tr=()=>{if(!hr.value)return;const vn=Er.value,hn=[],Yn=[];if(vn.forEach(Oo=>Yn.push(yr(Oo))),Et.value=Yn,vn.length){vn.slice(0,n.maxCollapseTags).forEach(Uo=>hn.push(yr(Uo)));const Oo=vn.slice(n.maxCollapseTags),Vo=Oo.length;Vo&&(n.collapseTags?hn.push({key:-1,text:`+ ${Vo}`,closable:!1,isCollapseTag:!0}):Oo.forEach(Uo=>hn.push(yr(Uo))))}jt.value=hn},Br=()=>{var vn,hn;const{filterMethod:Yn,showAllLevels:Oo,separator:Vo}=n,Uo=(hn=(vn=oe.value)==null?void 0:vn.getFlattedNodes(!n.props.checkStrictly))==null?void 0:hn.filter(Io=>Io.isDisabled?!1:(Io.calcText(Oo,Vo),Yn(Io,Sr.value)));hr.value&&(jt.value.forEach(Io=>{Io.hitState=!1}),Et.value.forEach(Io=>{Io.hitState=!1})),Ne.value=!0,ir.value=Uo,Or()},$r=()=>{var vn;let hn;Ne.value&&ae.value?hn=ae.value.$el.querySelector(`.${$.e("suggestion-item")}`):hn=(vn=oe.value)==null?void 0:vn.$el.querySelector(`.${$.b("node")}[tabindex="-1"]`),hn&&(hn.focus(),!Ne.value&&hn.click())},Lr=()=>{var vn,hn;const Yn=(vn=ue.value)==null?void 0:vn.input,Oo=le.value,Vo=(hn=ae.value)==null?void 0:hn.$el;if(!(!isClient||!Yn)){if(Vo){const Uo=Vo.querySelector(`.${$.e("suggestion-list")}`);Uo.style.minWidth=`${Yn.offsetWidth}px`}if(Oo){const{offsetHeight:Uo}=Oo,Io=jt.value.length>0?`${Math.max(Uo+6,i)}px`:`${i}px`;Yn.style.height=Io,Or()}}},Gr=vn=>{var hn;return(hn=oe.value)==null?void 0:hn.getCheckedNodes(vn)},qr=vn=>{Or(),e("expandChange",vn)},Yr=vn=>{var hn;const Yn=(hn=vn.target)==null?void 0:hn.value;if(vn.type==="compositionend")dr.value=!1,nextTick(()=>xn(Yn));else{const Oo=Yn[Yn.length-1]||"";dr.value=!isKorean(Oo)}},bn=vn=>{if(!dr.value)switch(vn.code){case EVENT_CODE.enter:_r();break;case EVENT_CODE.down:_r(!0),nextTick($r),vn.preventDefault();break;case EVENT_CODE.esc:qe.value===!0&&(vn.preventDefault(),vn.stopPropagation(),_r(!1));break;case EVENT_CODE.tab:_r(!1);break}},wn=()=>{var vn;(vn=oe.value)==null||vn.clearCheckedNodes(),!qe.value&&n.filterable&&Xr(),_r(!1)},Xr=()=>{const{value:vn}=Cr;$e.value=vn,Lt.value=vn},Vn=vn=>{var hn,Yn;const{checked:Oo}=vn;hr.value?(hn=oe.value)==null||hn.handleCheckChange(vn,!Oo,!1):(!Oo&&((Yn=oe.value)==null||Yn.handleCheckChange(vn,!0,!1)),_r(!1))},Zr=vn=>{const hn=vn.target,{code:Yn}=vn;switch(Yn){case EVENT_CODE.up:case EVENT_CODE.down:{const Oo=Yn===EVENT_CODE.up?-1:1;focusNode(getSibling(hn,Oo,`.${$.e("suggestion-item")}[tabindex="-1"]`));break}case EVENT_CODE.enter:hn.click();break}},Nn=()=>{const vn=jt.value,hn=vn[vn.length-1];k=Lt.value?0:k+1,!(!hn||!k||n.collapseTags&&vn.length>1)&&(hn.hitState?mr(hn):hn.hitState=!0)},Qr=vn=>{const hn=vn.target,Yn=$.e("search-input");hn.className===Yn&&(ze.value=!0),e("focus",vn)},kn=vn=>{ze.value=!1,e("blur",vn)},Dn=debounce(()=>{const{value:vn}=Sr;if(!vn)return;const hn=n.beforeFilter(vn);isPromise(hn)?hn.then(Br).catch(()=>{}):hn!==!1?Br():Mr()},n.debounce),xn=(vn,hn)=>{!qe.value&&_r(!0),!(hn!=null&&hn.isComposing)&&(vn?Dn():Mr())},An=vn=>Number.parseFloat(useCssVar(L.cssVarName("input-height"),vn).value)-2;return watch(Ne,Or),watch([Er,lr],Tr),watch(jt,()=>{nextTick(()=>Lr())}),watch(cr,async()=>{await nextTick();const vn=ue.value.input;i=An(vn)||i,Lr()}),watch(Cr,Xr,{immediate:!0}),onMounted(()=>{const vn=ue.value.input,hn=An(vn);i=vn.offsetHeight||hn,useResizeObserver(vn,Lr)}),r({getCheckedNodes:Gr,cascaderPanelRef:oe,togglePopperVisible:_r,contentRef:vr}),(vn,hn)=>(openBlock(),createBlock(unref(ElTooltip),{ref_key:"tooltipRef",ref:ie,visible:qe.value,teleported:vn.teleported,"popper-class":[unref($).e("dropdown"),vn.popperClass],"popper-options":g,"fallback-placements":["bottom-start","bottom","top-start","top","right","left"],"stop-popper-mouse-event":!1,"gpu-acceleration":!1,placement:"bottom-start",transition:`${unref($).namespace.value}-zoom-in-top`,effect:"light",pure:"",persistent:"",onHide:Mr},{default:withCtx(()=>[withDirectives((openBlock(),createElementBlock("div",{class:normalizeClass(unref(kr)),style:normalizeStyle(unref(Dt)),onClick:hn[5]||(hn[5]=()=>_r(unref(pr)?void 0:!0)),onKeydown:bn,onMouseenter:hn[6]||(hn[6]=Yn=>de.value=!0),onMouseleave:hn[7]||(hn[7]=Yn=>de.value=!1)},[createVNode(unref(ElInput),{ref_key:"input",ref:ue,modelValue:$e.value,"onUpdate:modelValue":hn[1]||(hn[1]=Yn=>$e.value=Yn),placeholder:unref(er),readonly:unref(pr),disabled:unref(lr),"validate-event":!1,size:unref(cr),class:normalizeClass(unref(xr)),tabindex:unref(hr)&&vn.filterable&&!unref(lr)?-1:void 0,onCompositionstart:Yr,onCompositionupdate:Yr,onCompositionend:Yr,onFocus:Qr,onBlur:kn,onInput:xn},{suffix:withCtx(()=>[unref(Pr)?(openBlock(),createBlock(unref(ElIcon),{key:"clear",class:normalizeClass([unref(L).e("icon"),"icon-circle-close"]),onClick:withModifiers(wn,["stop"])},{default:withCtx(()=>[createVNode(unref(circle_close_default))]),_:1},8,["class","onClick"])):(openBlock(),createBlock(unref(ElIcon),{key:"arrow-down",class:normalizeClass(unref(Ir)),onClick:hn[0]||(hn[0]=withModifiers(Yn=>_r(),["stop"]))},{default:withCtx(()=>[createVNode(unref(arrow_down_default))]),_:1},8,["class"]))]),_:1},8,["modelValue","placeholder","readonly","disabled","size","class","tabindex"]),unref(hr)?(openBlock(),createElementBlock("div",{key:0,ref_key:"tagWrapper",ref:le,class:normalizeClass(unref($).e("tags"))},[(openBlock(!0),createElementBlock(Fragment,null,renderList(jt.value,Yn=>(openBlock(),createBlock(unref(ElTag),{key:Yn.key,type:vn.tagType,size:unref(or),hit:Yn.hitState,closable:Yn.closable,"disable-transitions":"",onClose:Oo=>mr(Yn)},{default:withCtx(()=>[Yn.isCollapseTag===!1?(openBlock(),createElementBlock("span",_hoisted_1$o,toDisplayString(Yn.text),1)):(openBlock(),createBlock(unref(ElTooltip),{key:1,disabled:qe.value||!vn.collapseTagsTooltip,"fallback-placements":["bottom","top","right","left"],placement:"bottom",effect:"light"},{default:withCtx(()=>[createBaseVNode("span",null,toDisplayString(Yn.text),1)]),content:withCtx(()=>[createBaseVNode("div",{class:normalizeClass(unref($).e("collapse-tags"))},[(openBlock(!0),createElementBlock(Fragment,null,renderList(Et.value.slice(vn.maxCollapseTags),(Oo,Vo)=>(openBlock(),createElementBlock("div",{key:Vo,class:normalizeClass(unref($).e("collapse-tag"))},[(openBlock(),createBlock(unref(ElTag),{key:Oo.key,class:"in-tooltip",type:vn.tagType,size:unref(or),hit:Oo.hitState,closable:Oo.closable,"disable-transitions":"",onClose:Uo=>mr(Oo)},{default:withCtx(()=>[createBaseVNode("span",null,toDisplayString(Oo.text),1)]),_:2},1032,["type","size","hit","closable","onClose"]))],2))),128))],2)]),_:2},1032,["disabled"]))]),_:2},1032,["type","size","hit","closable","onClose"]))),128)),vn.filterable&&!unref(lr)?withDirectives((openBlock(),createElementBlock("input",{key:0,"onUpdate:modelValue":hn[2]||(hn[2]=Yn=>Lt.value=Yn),type:"text",class:normalizeClass(unref($).e("search-input")),placeholder:unref(Cr)?"":unref(sr),onInput:hn[3]||(hn[3]=Yn=>xn(Lt.value,Yn)),onClick:hn[4]||(hn[4]=withModifiers(Yn=>_r(!0),["stop"])),onKeydown:withKeys(Nn,["delete"]),onCompositionstart:Yr,onCompositionupdate:Yr,onCompositionend:Yr,onFocus:Qr,onBlur:kn},null,42,_hoisted_2$g)),[[vModelText,Lt.value]]):createCommentVNode("v-if",!0)],2)):createCommentVNode("v-if",!0)],38)),[[unref(ClickOutside),()=>_r(!1),unref(vr)]])]),content:withCtx(()=>[withDirectives(createVNode(unref(_CascaderPanel),{ref_key:"cascaderPanelRef",ref:oe,modelValue:unref(rr),"onUpdate:modelValue":hn[8]||(hn[8]=Yn=>isRef(rr)?rr.value=Yn:null),options:vn.options,props:n.props,border:!1,"render-label":vn.$slots.default,onExpandChange:qr,onClose:hn[9]||(hn[9]=Yn=>vn.$nextTick(()=>_r(!1)))},null,8,["modelValue","options","props","render-label"]),[[vShow,!Ne.value]]),vn.filterable?withDirectives((openBlock(),createBlock(unref(ElScrollbar),{key:0,ref_key:"suggestionPanel",ref:ae,tag:"ul",class:normalizeClass(unref($).e("suggestion-panel")),"view-class":unref($).e("suggestion-list"),onKeydown:Zr},{default:withCtx(()=>[ir.value.length?(openBlock(!0),createElementBlock(Fragment,{key:0},renderList(ir.value,Yn=>(openBlock(),createElementBlock("li",{key:Yn.uid,class:normalizeClass([unref($).e("suggestion-item"),unref($).is("checked",Yn.checked)]),tabindex:-1,onClick:Oo=>Vn(Yn)},[createBaseVNode("span",null,toDisplayString(Yn.text),1),Yn.checked?(openBlock(),createBlock(unref(ElIcon),{key:0},{default:withCtx(()=>[createVNode(unref(check_default))]),_:1})):createCommentVNode("v-if",!0)],10,_hoisted_3$b))),128)):renderSlot(vn.$slots,"empty",{key:1},()=>[createBaseVNode("li",{class:normalizeClass(unref($).e("empty-text"))},toDisplayString(unref(V)("el.cascader.noMatch")),3)])]),_:3},8,["class","view-class"])),[[vShow,Ne.value]]):createCommentVNode("v-if",!0)]),_:3},8,["visible","teleported","popper-class","transition"]))}});var Cascader=_export_sfc$1(_sfc_main$G,[["__file","cascader.vue"]]);Cascader.install=t=>{t.component(Cascader.name,Cascader)};const _Cascader=Cascader,ElCascader=_Cascader,rowContextKey=Symbol("rowContextKey"),RowJustify=["start","center","end","space-around","space-between","space-evenly"],RowAlign=["top","middle","bottom"],rowProps=buildProps({tag:{type:String,default:"div"},gutter:{type:Number,default:0},justify:{type:String,values:RowJustify,default:"start"},align:{type:String,values:RowAlign}}),__default__$k=defineComponent({name:"ElRow"}),_sfc_main$F=defineComponent({...__default__$k,props:rowProps,setup(t){const r=t,e=useNamespace("row"),n=computed(()=>r.gutter);provide(rowContextKey,{gutter:n});const g=computed(()=>{const i={};return r.gutter&&(i.marginRight=i.marginLeft=`-${r.gutter/2}px`),i}),y=computed(()=>[e.b(),e.is(`justify-${r.justify}`,r.justify!=="start"),e.is(`align-${r.align}`,!!r.align)]);return(i,k)=>(openBlock(),createBlock(resolveDynamicComponent(i.tag),{class:normalizeClass(unref(y)),style:normalizeStyle(unref(g))},{default:withCtx(()=>[renderSlot(i.$slots,"default")]),_:3},8,["class","style"]))}});var Row=_export_sfc$1(_sfc_main$F,[["__file","row.vue"]]);const ElRow=withInstall(Row),colProps=buildProps({tag:{type:String,default:"div"},span:{type:Number,default:24},offset:{type:Number,default:0},pull:{type:Number,default:0},push:{type:Number,default:0},xs:{type:definePropType([Number,Object]),default:()=>mutable({})},sm:{type:definePropType([Number,Object]),default:()=>mutable({})},md:{type:definePropType([Number,Object]),default:()=>mutable({})},lg:{type:definePropType([Number,Object]),default:()=>mutable({})},xl:{type:definePropType([Number,Object]),default:()=>mutable({})}}),__default__$j=defineComponent({name:"ElCol"}),_sfc_main$E=defineComponent({...__default__$j,props:colProps,setup(t){const r=t,{gutter:e}=inject(rowContextKey,{gutter:computed(()=>0)}),n=useNamespace("col"),g=computed(()=>{const i={};return e.value&&(i.paddingLeft=i.paddingRight=`${e.value/2}px`),i}),y=computed(()=>{const i=[];return["span","offset","pull","push"].forEach(L=>{const V=r[L];isNumber$1(V)&&(L==="span"?i.push(n.b(`${r[L]}`)):V>0&&i.push(n.b(`${L}-${r[L]}`)))}),["xs","sm","md","lg","xl"].forEach(L=>{isNumber$1(r[L])?i.push(n.b(`${L}-${r[L]}`)):isObject$2(r[L])&&Object.entries(r[L]).forEach(([V,z])=>{i.push(V!=="span"?n.b(`${L}-${V}-${z}`):n.b(`${L}-${z}`))})}),e.value&&i.push(n.is("guttered")),[n.b(),i]});return(i,k)=>(openBlock(),createBlock(resolveDynamicComponent(i.tag),{class:normalizeClass(unref(y)),style:normalizeStyle(unref(g))},{default:withCtx(()=>[renderSlot(i.$slots,"default")]),_:3},8,["class","style"]))}});var Col=_export_sfc$1(_sfc_main$E,[["__file","col.vue"]]);const ElCol=withInstall(Col),__default__$i=defineComponent({name:"ElCollapseTransition"}),_sfc_main$D=defineComponent({...__default__$i,setup(t){const r=useNamespace("collapse-transition"),e=g=>{g.style.maxHeight="",g.style.overflow=g.dataset.oldOverflow,g.style.paddingTop=g.dataset.oldPaddingTop,g.style.paddingBottom=g.dataset.oldPaddingBottom},n={beforeEnter(g){g.dataset||(g.dataset={}),g.dataset.oldPaddingTop=g.style.paddingTop,g.dataset.oldPaddingBottom=g.style.paddingBottom,g.style.height&&(g.dataset.elExistsHeight=g.style.height),g.style.maxHeight=0,g.style.paddingTop=0,g.style.paddingBottom=0},enter(g){requestAnimationFrame(()=>{g.dataset.oldOverflow=g.style.overflow,g.dataset.elExistsHeight?g.style.maxHeight=g.dataset.elExistsHeight:g.scrollHeight!==0?g.style.maxHeight=`${g.scrollHeight}px`:g.style.maxHeight=0,g.style.paddingTop=g.dataset.oldPaddingTop,g.style.paddingBottom=g.dataset.oldPaddingBottom,g.style.overflow="hidden"})},afterEnter(g){g.style.maxHeight="",g.style.overflow=g.dataset.oldOverflow},enterCancelled(g){e(g)},beforeLeave(g){g.dataset||(g.dataset={}),g.dataset.oldPaddingTop=g.style.paddingTop,g.dataset.oldPaddingBottom=g.style.paddingBottom,g.dataset.oldOverflow=g.style.overflow,g.style.maxHeight=`${g.scrollHeight}px`,g.style.overflow="hidden"},leave(g){g.scrollHeight!==0&&(g.style.maxHeight=0,g.style.paddingTop=0,g.style.paddingBottom=0)},afterLeave(g){e(g)},leaveCancelled(g){e(g)}};return(g,y)=>(openBlock(),createBlock(Transition,mergeProps({name:unref(r).b()},toHandlers(n)),{default:withCtx(()=>[renderSlot(g.$slots,"default")]),_:3},16,["name"]))}});var CollapseTransition=_export_sfc$1(_sfc_main$D,[["__file","collapse-transition.vue"]]);CollapseTransition.install=t=>{t.component(CollapseTransition.name,CollapseTransition)};const _CollapseTransition=CollapseTransition,__default__$h=defineComponent({name:"ElContainer"}),_sfc_main$C=defineComponent({...__default__$h,props:{direction:{type:String}},setup(t){const r=t,e=useSlots(),n=useNamespace("container"),g=computed(()=>r.direction==="vertical"?!0:r.direction==="horizontal"?!1:e&&e.default?e.default().some(i=>{const k=i.type.name;return k==="ElHeader"||k==="ElFooter"}):!1);return(y,i)=>(openBlock(),createElementBlock("section",{class:normalizeClass([unref(n).b(),unref(n).is("vertical",unref(g))])},[renderSlot(y.$slots,"default")],2))}});var Container=_export_sfc$1(_sfc_main$C,[["__file","container.vue"]]);const __default__$g=defineComponent({name:"ElAside"}),_sfc_main$B=defineComponent({...__default__$g,props:{width:{type:String,default:null}},setup(t){const r=t,e=useNamespace("aside"),n=computed(()=>r.width?e.cssVarBlock({width:r.width}):{});return(g,y)=>(openBlock(),createElementBlock("aside",{class:normalizeClass(unref(e).b()),style:normalizeStyle(unref(n))},[renderSlot(g.$slots,"default")],6))}});var Aside=_export_sfc$1(_sfc_main$B,[["__file","aside.vue"]]);const __default__$f=defineComponent({name:"ElFooter"}),_sfc_main$A=defineComponent({...__default__$f,props:{height:{type:String,default:null}},setup(t){const r=t,e=useNamespace("footer"),n=computed(()=>r.height?e.cssVarBlock({height:r.height}):{});return(g,y)=>(openBlock(),createElementBlock("footer",{class:normalizeClass(unref(e).b()),style:normalizeStyle(unref(n))},[renderSlot(g.$slots,"default")],6))}});var Footer=_export_sfc$1(_sfc_main$A,[["__file","footer.vue"]]);const __default__$e=defineComponent({name:"ElHeader"}),_sfc_main$z=defineComponent({...__default__$e,props:{height:{type:String,default:null}},setup(t){const r=t,e=useNamespace("header"),n=computed(()=>r.height?e.cssVarBlock({height:r.height}):{});return(g,y)=>(openBlock(),createElementBlock("header",{class:normalizeClass(unref(e).b()),style:normalizeStyle(unref(n))},[renderSlot(g.$slots,"default")],6))}});var Header=_export_sfc$1(_sfc_main$z,[["__file","header.vue"]]);const __default__$d=defineComponent({name:"ElMain"}),_sfc_main$y=defineComponent({...__default__$d,setup(t){const r=useNamespace("main");return(e,n)=>(openBlock(),createElementBlock("main",{class:normalizeClass(unref(r).b())},[renderSlot(e.$slots,"default")],2))}});var Main=_export_sfc$1(_sfc_main$y,[["__file","main.vue"]]);const ElContainer=withInstall(Container,{Aside,Footer,Header,Main}),ElAside=withNoopInstall(Aside);withNoopInstall(Footer);withNoopInstall(Header);const ElMain=withNoopInstall(Main),overlayProps=buildProps({mask:{type:Boolean,default:!0},customMaskEvent:{type:Boolean,default:!1},overlayClass:{type:definePropType([String,Array,Object])},zIndex:{type:definePropType([String,Number])}}),overlayEmits={click:t=>t instanceof MouseEvent},BLOCK="overlay";var Overlay=defineComponent({name:"ElOverlay",props:overlayProps,emits:overlayEmits,setup(t,{slots:r,emit:e}){const n=useNamespace(BLOCK),g=$=>{e("click",$)},{onClick:y,onMousedown:i,onMouseup:k}=useSameTarget(t.customMaskEvent?void 0:g);return()=>t.mask?createVNode("div",{class:[n.b(),t.overlayClass],style:{zIndex:t.zIndex},onClick:y,onMousedown:i,onMouseup:k},[renderSlot(r,"default")],PatchFlags.STYLE|PatchFlags.CLASS|PatchFlags.PROPS,["onClick","onMouseup","onMousedown"]):h$1("div",{class:t.overlayClass,style:{zIndex:t.zIndex,position:"fixed",top:"0px",right:"0px",bottom:"0px",left:"0px"}},[renderSlot(r,"default")])}});const ElOverlay=Overlay,dialogInjectionKey=Symbol("dialogInjectionKey"),dialogContentProps=buildProps({center:Boolean,alignCenter:Boolean,closeIcon:{type:iconPropType},draggable:Boolean,overflow:Boolean,fullscreen:Boolean,showClose:{type:Boolean,default:!0},title:{type:String,default:""},ariaLevel:{type:String,default:"2"}}),dialogContentEmits={close:()=>!0},_hoisted_1$n=["aria-level"],_hoisted_2$f=["aria-label"],_hoisted_3$a=["id"],__default__$c=defineComponent({name:"ElDialogContent"}),_sfc_main$x=defineComponent({...__default__$c,props:dialogContentProps,emits:dialogContentEmits,setup(t){const r=t,{t:e}=useLocale(),{Close:n}=CloseComponents,{dialogRef:g,headerRef:y,bodyId:i,ns:k,style:$}=inject(dialogInjectionKey),{focusTrapRef:L}=inject(FOCUS_TRAP_INJECTION_KEY),V=computed(()=>[k.b(),k.is("fullscreen",r.fullscreen),k.is("draggable",r.draggable),k.is("align-center",r.alignCenter),{[k.m("center")]:r.center}]),z=composeRefs(L,g),re=computed(()=>r.draggable),ie=computed(()=>r.overflow);return useDraggable(g,y,re,ie),(ue,le)=>(openBlock(),createElementBlock("div",{ref:unref(z),class:normalizeClass(unref(V)),style:normalizeStyle(unref($)),tabindex:"-1"},[createBaseVNode("header",{ref_key:"headerRef",ref:y,class:normalizeClass([unref(k).e("header"),{"show-close":ue.showClose}])},[renderSlot(ue.$slots,"header",{},()=>[createBaseVNode("span",{role:"heading","aria-level":ue.ariaLevel,class:normalizeClass(unref(k).e("title"))},toDisplayString(ue.title),11,_hoisted_1$n)]),ue.showClose?(openBlock(),createElementBlock("button",{key:0,"aria-label":unref(e)("el.dialog.close"),class:normalizeClass(unref(k).e("headerbtn")),type:"button",onClick:le[0]||(le[0]=oe=>ue.$emit("close"))},[createVNode(unref(ElIcon),{class:normalizeClass(unref(k).e("close"))},{default:withCtx(()=>[(openBlock(),createBlock(resolveDynamicComponent(ue.closeIcon||unref(n))))]),_:1},8,["class"])],10,_hoisted_2$f)):createCommentVNode("v-if",!0)],2),createBaseVNode("div",{id:unref(i),class:normalizeClass(unref(k).e("body"))},[renderSlot(ue.$slots,"default")],10,_hoisted_3$a),ue.$slots.footer?(openBlock(),createElementBlock("footer",{key:0,class:normalizeClass(unref(k).e("footer"))},[renderSlot(ue.$slots,"footer")],2)):createCommentVNode("v-if",!0)],6))}});var ElDialogContent=_export_sfc$1(_sfc_main$x,[["__file","dialog-content.vue"]]);const dialogProps=buildProps({...dialogContentProps,appendToBody:Boolean,appendTo:{type:definePropType(String),default:"body"},beforeClose:{type:definePropType(Function)},destroyOnClose:Boolean,closeOnClickModal:{type:Boolean,default:!0},closeOnPressEscape:{type:Boolean,default:!0},lockScroll:{type:Boolean,default:!0},modal:{type:Boolean,default:!0},openDelay:{type:Number,default:0},closeDelay:{type:Number,default:0},top:{type:String},modelValue:Boolean,modalClass:String,width:{type:[String,Number]},zIndex:{type:Number},trapFocus:{type:Boolean,default:!1},headerAriaLevel:{type:String,default:"2"}}),dialogEmits={open:()=>!0,opened:()=>!0,close:()=>!0,closed:()=>!0,[UPDATE_MODEL_EVENT]:t=>isBoolean$1(t),openAutoFocus:()=>!0,closeAutoFocus:()=>!0},useDialog=(t,r)=>{var e;const g=getCurrentInstance().emit,{nextZIndex:y}=useZIndex();let i="";const k=useId(),$=useId(),L=ref(!1),V=ref(!1),z=ref(!1),re=ref((e=t.zIndex)!=null?e:y());let ie,ue;const le=useGlobalConfig("namespace",defaultNamespace),oe=computed(()=>{const er={},cr=`--${le.value}-dialog`;return t.fullscreen||(t.top&&(er[`${cr}-margin-top`]=t.top),t.width&&(er[`${cr}-width`]=addUnit(t.width))),er}),ae=computed(()=>t.alignCenter?{display:"flex"}:{});function qe(){g("opened")}function de(){g("closed"),g(UPDATE_MODEL_EVENT,!1),t.destroyOnClose&&(z.value=!1)}function Ne(){g("close")}function ze(){ue==null||ue(),ie==null||ie(),t.openDelay&&t.openDelay>0?{stop:ie}=useTimeoutFn(()=>Et(),t.openDelay):Et()}function $e(){ie==null||ie(),ue==null||ue(),t.closeDelay&&t.closeDelay>0?{stop:ue}=useTimeoutFn(()=>ir(),t.closeDelay):ir()}function Lt(){function er(cr){cr||(V.value=!0,L.value=!1)}t.beforeClose?t.beforeClose(er):$e()}function jt(){t.closeOnClickModal&&Lt()}function Et(){isClient&&(L.value=!0)}function ir(){L.value=!1}function dr(){g("openAutoFocus")}function Dt(){g("closeAutoFocus")}function lr(er){var cr;((cr=er.detail)==null?void 0:cr.focusReason)==="pointer"&&er.preventDefault()}t.lockScroll&&useLockscreen(L);function sr(){t.closeOnPressEscape&&Lt()}return watch(()=>t.modelValue,er=>{er?(V.value=!1,ze(),z.value=!0,re.value=isUndefined$2(t.zIndex)?y():re.value++,nextTick(()=>{g("open"),r.value&&(r.value.scrollTop=0)})):L.value&&$e()}),watch(()=>t.fullscreen,er=>{r.value&&(er?(i=r.value.style.transform,r.value.style.transform=""):r.value.style.transform=i)}),onMounted(()=>{t.modelValue&&(L.value=!0,z.value=!0,ze())}),{afterEnter:qe,afterLeave:de,beforeLeave:Ne,handleClose:Lt,onModalClick:jt,close:$e,doClose:ir,onOpenAutoFocus:dr,onCloseAutoFocus:Dt,onCloseRequested:sr,onFocusoutPrevented:lr,titleId:k,bodyId:$,closed:V,style:oe,overlayDialogStyle:ae,rendered:z,visible:L,zIndex:re}},_hoisted_1$m=["aria-label","aria-labelledby","aria-describedby"],__default__$b=defineComponent({name:"ElDialog",inheritAttrs:!1}),_sfc_main$w=defineComponent({...__default__$b,props:dialogProps,emits:dialogEmits,setup(t,{expose:r}){const e=t,n=useSlots();useDeprecated({scope:"el-dialog",from:"the title slot",replacement:"the header slot",version:"3.0.0",ref:"https://element-plus.org/en-US/component/dialog.html#slots"},computed(()=>!!n.title));const g=useNamespace("dialog"),y=ref(),i=ref(),k=ref(),{visible:$,titleId:L,bodyId:V,style:z,overlayDialogStyle:re,rendered:ie,zIndex:ue,afterEnter:le,afterLeave:oe,beforeLeave:ae,handleClose:qe,onModalClick:de,onOpenAutoFocus:Ne,onCloseAutoFocus:ze,onCloseRequested:$e,onFocusoutPrevented:Lt}=useDialog(e,y);provide(dialogInjectionKey,{dialogRef:y,headerRef:i,bodyId:V,ns:g,rendered:ie,style:z});const jt=useSameTarget(de),Et=computed(()=>e.draggable&&!e.fullscreen);return r({visible:$,dialogContentRef:k}),(ir,dr)=>(openBlock(),createBlock(Teleport,{to:ir.appendTo,disabled:ir.appendTo!=="body"?!1:!ir.appendToBody},[createVNode(Transition,{name:"dialog-fade",onAfterEnter:unref(le),onAfterLeave:unref(oe),onBeforeLeave:unref(ae),persisted:""},{default:withCtx(()=>[withDirectives(createVNode(unref(ElOverlay),{"custom-mask-event":"",mask:ir.modal,"overlay-class":ir.modalClass,"z-index":unref(ue)},{default:withCtx(()=>[createBaseVNode("div",{role:"dialog","aria-modal":"true","aria-label":ir.title||void 0,"aria-labelledby":ir.title?void 0:unref(L),"aria-describedby":unref(V),class:normalizeClass(`${unref(g).namespace.value}-overlay-dialog`),style:normalizeStyle(unref(re)),onClick:dr[0]||(dr[0]=(...Dt)=>unref(jt).onClick&&unref(jt).onClick(...Dt)),onMousedown:dr[1]||(dr[1]=(...Dt)=>unref(jt).onMousedown&&unref(jt).onMousedown(...Dt)),onMouseup:dr[2]||(dr[2]=(...Dt)=>unref(jt).onMouseup&&unref(jt).onMouseup(...Dt))},[createVNode(unref(ElFocusTrap),{loop:"",trapped:unref($),"focus-start-el":"container",onFocusAfterTrapped:unref(Ne),onFocusAfterReleased:unref(ze),onFocusoutPrevented:unref(Lt),onReleaseRequested:unref($e)},{default:withCtx(()=>[unref(ie)?(openBlock(),createBlock(ElDialogContent,mergeProps({key:0,ref_key:"dialogContentRef",ref:k},ir.$attrs,{center:ir.center,"align-center":ir.alignCenter,"close-icon":ir.closeIcon,draggable:unref(Et),overflow:ir.overflow,fullscreen:ir.fullscreen,"show-close":ir.showClose,title:ir.title,"aria-level":ir.headerAriaLevel,onClose:unref(qe)}),createSlots({header:withCtx(()=>[ir.$slots.title?renderSlot(ir.$slots,"title",{key:1}):renderSlot(ir.$slots,"header",{key:0,close:unref(qe),titleId:unref(L),titleClass:unref(g).e("title")})]),default:withCtx(()=>[renderSlot(ir.$slots,"default")]),_:2},[ir.$slots.footer?{name:"footer",fn:withCtx(()=>[renderSlot(ir.$slots,"footer")])}:void 0]),1040,["center","align-center","close-icon","draggable","overflow","fullscreen","show-close","title","aria-level","onClose"])):createCommentVNode("v-if",!0)]),_:3},8,["trapped","onFocusAfterTrapped","onFocusAfterReleased","onFocusoutPrevented","onReleaseRequested"])],46,_hoisted_1$m)]),_:3},8,["mask","overlay-class","z-index"]),[[vShow,unref($)]])]),_:3},8,["onAfterEnter","onAfterLeave","onBeforeLeave"])],8,["to","disabled"]))}});var Dialog=_export_sfc$1(_sfc_main$w,[["__file","dialog.vue"]]);const ElDialog=withInstall(Dialog),dividerProps=buildProps({direction:{type:String,values:["horizontal","vertical"],default:"horizontal"},contentPosition:{type:String,values:["left","center","right"],default:"center"},borderStyle:{type:definePropType(String),default:"solid"}}),__default__$a=defineComponent({name:"ElDivider"}),_sfc_main$v=defineComponent({...__default__$a,props:dividerProps,setup(t){const r=t,e=useNamespace("divider"),n=computed(()=>e.cssVar({"border-style":r.borderStyle}));return(g,y)=>(openBlock(),createElementBlock("div",{class:normalizeClass([unref(e).b(),unref(e).m(g.direction)]),style:normalizeStyle(unref(n)),role:"separator"},[g.$slots.default&&g.direction!=="vertical"?(openBlock(),createElementBlock("div",{key:0,class:normalizeClass([unref(e).e("text"),unref(e).is(g.contentPosition)])},[renderSlot(g.$slots,"default")],2)):createCommentVNode("v-if",!0)],6))}});var Divider=_export_sfc$1(_sfc_main$v,[["__file","divider.vue"]]);const ElDivider=withInstall(Divider),imageViewerProps=buildProps({urlList:{type:definePropType(Array),default:()=>mutable([])},zIndex:{type:Number},initialIndex:{type:Number,default:0},infinite:{type:Boolean,default:!0},hideOnClickModal:Boolean,teleported:Boolean,closeOnPressEscape:{type:Boolean,default:!0},zoomRate:{type:Number,default:1.2},minScale:{type:Number,default:.2},maxScale:{type:Number,default:7},crossorigin:{type:definePropType(String)}}),imageViewerEmits={close:()=>!0,switch:t=>isNumber$1(t),rotate:t=>isNumber$1(t)},_hoisted_1$l=["src","crossorigin"],__default__$9=defineComponent({name:"ElImageViewer"}),_sfc_main$u=defineComponent({...__default__$9,props:imageViewerProps,emits:imageViewerEmits,setup(t,{expose:r,emit:e}){var n;const g=t,y={CONTAIN:{name:"contain",icon:markRaw(full_screen_default)},ORIGINAL:{name:"original",icon:markRaw(scale_to_original_default)}},{t:i}=useLocale(),k=useNamespace("image-viewer"),{nextZIndex:$}=useZIndex(),L=ref(),V=ref([]),z=effectScope(),re=ref(!0),ie=ref(g.initialIndex),ue=shallowRef(y.CONTAIN),le=ref({scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}),oe=ref((n=g.zIndex)!=null?n:$()),ae=computed(()=>{const{urlList:Sr}=g;return Sr.length<=1}),qe=computed(()=>ie.value===0),de=computed(()=>ie.value===g.urlList.length-1),Ne=computed(()=>g.urlList[ie.value]),ze=computed(()=>[k.e("btn"),k.e("prev"),k.is("disabled",!g.infinite&&qe.value)]),$e=computed(()=>[k.e("btn"),k.e("next"),k.is("disabled",!g.infinite&&de.value)]),Lt=computed(()=>{const{scale:Sr,deg:Er,offsetX:Pr,offsetY:Cr,enableTransition:rr}=le.value;let kr=Pr/Sr,Ir=Cr/Sr;switch(Er%360){case 90:case-270:[kr,Ir]=[Ir,-kr];break;case 180:case-180:[kr,Ir]=[-kr,-Ir];break;case 270:case-90:[kr,Ir]=[-Ir,kr];break}const xr={transform:`scale(${Sr}) rotate(${Er}deg) translate(${kr}px, ${Ir}px)`,transition:rr?"transform .3s":""};return ue.value.name===y.CONTAIN.name&&(xr.maxWidth=xr.maxHeight="100%"),xr});function jt(){ir(),e("close")}function Et(){const Sr=throttle(Pr=>{switch(Pr.code){case EVENT_CODE.esc:g.closeOnPressEscape&&jt();break;case EVENT_CODE.space:er();break;case EVENT_CODE.left:or();break;case EVENT_CODE.up:pr("zoomIn");break;case EVENT_CODE.right:hr();break;case EVENT_CODE.down:pr("zoomOut");break}}),Er=throttle(Pr=>{const Cr=Pr.deltaY||Pr.deltaX;pr(Cr<0?"zoomIn":"zoomOut",{zoomRate:g.zoomRate,enableTransition:!1})});z.run(()=>{useEventListener(document,"keydown",Sr),useEventListener(document,"wheel",Er)})}function ir(){z.stop()}function dr(){re.value=!1}function Dt(Sr){re.value=!1,Sr.target.alt=i("el.image.error")}function lr(Sr){if(re.value||Sr.button!==0||!L.value)return;le.value.enableTransition=!1;const{offsetX:Er,offsetY:Pr}=le.value,Cr=Sr.pageX,rr=Sr.pageY,kr=throttle(xr=>{le.value={...le.value,offsetX:Er+xr.pageX-Cr,offsetY:Pr+xr.pageY-rr}}),Ir=useEventListener(document,"mousemove",kr);useEventListener(document,"mouseup",()=>{Ir()}),Sr.preventDefault()}function sr(){le.value={scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}}function er(){if(re.value)return;const Sr=keysOf(y),Er=Object.values(y),Pr=ue.value.name,rr=(Er.findIndex(kr=>kr.name===Pr)+1)%Sr.length;ue.value=y[Sr[rr]],sr()}function cr(Sr){const Er=g.urlList.length;ie.value=(Sr+Er)%Er}function or(){qe.value&&!g.infinite||cr(ie.value-1)}function hr(){de.value&&!g.infinite||cr(ie.value+1)}function pr(Sr,Er={}){if(re.value)return;const{minScale:Pr,maxScale:Cr}=g,{zoomRate:rr,rotateDeg:kr,enableTransition:Ir}={zoomRate:g.zoomRate,rotateDeg:90,enableTransition:!0,...Er};switch(Sr){case"zoomOut":le.value.scale>Pr&&(le.value.scale=Number.parseFloat((le.value.scale/rr).toFixed(3)));break;case"zoomIn":le.value.scale<Cr&&(le.value.scale=Number.parseFloat((le.value.scale*rr).toFixed(3)));break;case"clockwise":le.value.deg+=kr,e("rotate",le.value.deg);break;case"anticlockwise":le.value.deg-=kr,e("rotate",le.value.deg);break}le.value.enableTransition=Ir}return watch(Ne,()=>{nextTick(()=>{const Sr=V.value[0];Sr!=null&&Sr.complete||(re.value=!0)})}),watch(ie,Sr=>{sr(),e("switch",Sr)}),onMounted(()=>{var Sr,Er;Et(),(Er=(Sr=L.value)==null?void 0:Sr.focus)==null||Er.call(Sr)}),r({setActiveItem:cr}),(Sr,Er)=>(openBlock(),createBlock(Teleport,{to:"body",disabled:!Sr.teleported},[createVNode(Transition,{name:"viewer-fade",appear:""},{default:withCtx(()=>[createBaseVNode("div",{ref_key:"wrapper",ref:L,tabindex:-1,class:normalizeClass(unref(k).e("wrapper")),style:normalizeStyle({zIndex:oe.value})},[createBaseVNode("div",{class:normalizeClass(unref(k).e("mask")),onClick:Er[0]||(Er[0]=withModifiers(Pr=>Sr.hideOnClickModal&&jt(),["self"]))},null,2),createCommentVNode(" CLOSE "),createBaseVNode("span",{class:normalizeClass([unref(k).e("btn"),unref(k).e("close")]),onClick:jt},[createVNode(unref(ElIcon),null,{default:withCtx(()=>[createVNode(unref(close_default))]),_:1})],2),createCommentVNode(" ARROW "),unref(ae)?createCommentVNode("v-if",!0):(openBlock(),createElementBlock(Fragment,{key:0},[createBaseVNode("span",{class:normalizeClass(unref(ze)),onClick:or},[createVNode(unref(ElIcon),null,{default:withCtx(()=>[createVNode(unref(arrow_left_default))]),_:1})],2),createBaseVNode("span",{class:normalizeClass(unref($e)),onClick:hr},[createVNode(unref(ElIcon),null,{default:withCtx(()=>[createVNode(unref(arrow_right_default))]),_:1})],2)],64)),createCommentVNode(" ACTIONS "),createBaseVNode("div",{class:normalizeClass([unref(k).e("btn"),unref(k).e("actions")])},[createBaseVNode("div",{class:normalizeClass(unref(k).e("actions__inner"))},[createVNode(unref(ElIcon),{onClick:Er[1]||(Er[1]=Pr=>pr("zoomOut"))},{default:withCtx(()=>[createVNode(unref(zoom_out_default))]),_:1}),createVNode(unref(ElIcon),{onClick:Er[2]||(Er[2]=Pr=>pr("zoomIn"))},{default:withCtx(()=>[createVNode(unref(zoom_in_default))]),_:1}),createBaseVNode("i",{class:normalizeClass(unref(k).e("actions__divider"))},null,2),createVNode(unref(ElIcon),{onClick:er},{default:withCtx(()=>[(openBlock(),createBlock(resolveDynamicComponent(unref(ue).icon)))]),_:1}),createBaseVNode("i",{class:normalizeClass(unref(k).e("actions__divider"))},null,2),createVNode(unref(ElIcon),{onClick:Er[3]||(Er[3]=Pr=>pr("anticlockwise"))},{default:withCtx(()=>[createVNode(unref(refresh_left_default))]),_:1}),createVNode(unref(ElIcon),{onClick:Er[4]||(Er[4]=Pr=>pr("clockwise"))},{default:withCtx(()=>[createVNode(unref(refresh_right_default))]),_:1})],2)],2),createCommentVNode(" CANVAS "),createBaseVNode("div",{class:normalizeClass(unref(k).e("canvas"))},[(openBlock(!0),createElementBlock(Fragment,null,renderList(Sr.urlList,(Pr,Cr)=>withDirectives((openBlock(),createElementBlock("img",{ref_for:!0,ref:rr=>V.value[Cr]=rr,key:Pr,src:Pr,style:normalizeStyle(unref(Lt)),class:normalizeClass(unref(k).e("img")),crossorigin:Sr.crossorigin,onLoad:dr,onError:Dt,onMousedown:lr},null,46,_hoisted_1$l)),[[vShow,Cr===ie.value]])),128))],2),renderSlot(Sr.$slots,"default")],6)]),_:3})],8,["disabled"]))}});var ImageViewer=_export_sfc$1(_sfc_main$u,[["__file","image-viewer.vue"]]);const ElImageViewer=withInstall(ImageViewer),imageProps=buildProps({hideOnClickModal:Boolean,src:{type:String,default:""},fit:{type:String,values:["","contain","cover","fill","none","scale-down"],default:""},loading:{type:String,values:["eager","lazy"]},lazy:Boolean,scrollContainer:{type:definePropType([String,Object])},previewSrcList:{type:definePropType(Array),default:()=>mutable([])},previewTeleported:Boolean,zIndex:{type:Number},initialIndex:{type:Number,default:0},infinite:{type:Boolean,default:!0},closeOnPressEscape:{type:Boolean,default:!0},zoomRate:{type:Number,default:1.2},minScale:{type:Number,default:.2},maxScale:{type:Number,default:7},crossorigin:{type:definePropType(String)}}),imageEmits={load:t=>t instanceof Event,error:t=>t instanceof Event,switch:t=>isNumber$1(t),close:()=>!0,show:()=>!0},_hoisted_1$k=["src","loading","crossorigin"],_hoisted_2$e={key:0},__default__$8=defineComponent({name:"ElImage",inheritAttrs:!1}),_sfc_main$t=defineComponent({...__default__$8,props:imageProps,emits:imageEmits,setup(t,{emit:r}){const e=t;let n="";const{t:g}=useLocale(),y=useNamespace("image"),i=useAttrs$1(),k=useAttrs(),$=ref(),L=ref(!1),V=ref(!0),z=ref(!1),re=ref(),ie=ref(),ue=isClient&&"loading"in HTMLImageElement.prototype;let le,oe;const ae=computed(()=>[y.e("inner"),Ne.value&&y.e("preview"),V.value&&y.is("loading")]),qe=computed(()=>i.style),de=computed(()=>{const{fit:hr}=e;return isClient&&hr?{objectFit:hr}:{}}),Ne=computed(()=>{const{previewSrcList:hr}=e;return Array.isArray(hr)&&hr.length>0}),ze=computed(()=>{const{previewSrcList:hr,initialIndex:pr}=e;let Sr=pr;return pr>hr.length-1&&(Sr=0),Sr}),$e=computed(()=>e.loading==="eager"?!1:!ue&&e.loading==="lazy"||e.lazy),Lt=()=>{isClient&&(V.value=!0,L.value=!1,$.value=e.src)};function jt(hr){V.value=!1,L.value=!1,r("load",hr)}function Et(hr){V.value=!1,L.value=!0,r("error",hr)}function ir(){isInContainer(re.value,ie.value)&&(Lt(),lr())}const dr=useThrottleFn(ir,200,!0);async function Dt(){var hr;if(!isClient)return;await nextTick();const{scrollContainer:pr}=e;isElement(pr)?ie.value=pr:isString$2(pr)&&pr!==""?ie.value=(hr=document.querySelector(pr))!=null?hr:void 0:re.value&&(ie.value=getScrollContainer(re.value)),ie.value&&(le=useEventListener(ie,"scroll",dr),setTimeout(()=>ir(),100))}function lr(){!isClient||!ie.value||!dr||(le==null||le(),ie.value=void 0)}function sr(hr){if(hr.ctrlKey){if(hr.deltaY<0)return hr.preventDefault(),!1;if(hr.deltaY>0)return hr.preventDefault(),!1}}function er(){Ne.value&&(oe=useEventListener("wheel",sr,{passive:!1}),n=document.body.style.overflow,document.body.style.overflow="hidden",z.value=!0,r("show"))}function cr(){oe==null||oe(),document.body.style.overflow=n,z.value=!1,r("close")}function or(hr){r("switch",hr)}return watch(()=>e.src,()=>{$e.value?(V.value=!0,L.value=!1,lr(),Dt()):Lt()}),onMounted(()=>{$e.value?Dt():Lt()}),(hr,pr)=>(openBlock(),createElementBlock("div",{ref_key:"container",ref:re,class:normalizeClass([unref(y).b(),hr.$attrs.class]),style:normalizeStyle(unref(qe))},[L.value?renderSlot(hr.$slots,"error",{key:0},()=>[createBaseVNode("div",{class:normalizeClass(unref(y).e("error"))},toDisplayString(unref(g)("el.image.error")),3)]):(openBlock(),createElementBlock(Fragment,{key:1},[$.value!==void 0?(openBlock(),createElementBlock("img",mergeProps({key:0},unref(k),{src:$.value,loading:hr.loading,style:unref(de),class:unref(ae),crossorigin:hr.crossorigin,onClick:er,onLoad:jt,onError:Et}),null,16,_hoisted_1$k)):createCommentVNode("v-if",!0),V.value?(openBlock(),createElementBlock("div",{key:1,class:normalizeClass(unref(y).e("wrapper"))},[renderSlot(hr.$slots,"placeholder",{},()=>[createBaseVNode("div",{class:normalizeClass(unref(y).e("placeholder"))},null,2)])],2)):createCommentVNode("v-if",!0)],64)),unref(Ne)?(openBlock(),createElementBlock(Fragment,{key:2},[z.value?(openBlock(),createBlock(unref(ElImageViewer),{key:0,"z-index":hr.zIndex,"initial-index":unref(ze),infinite:hr.infinite,"zoom-rate":hr.zoomRate,"min-scale":hr.minScale,"max-scale":hr.maxScale,"url-list":hr.previewSrcList,"hide-on-click-modal":hr.hideOnClickModal,teleported:hr.previewTeleported,"close-on-press-escape":hr.closeOnPressEscape,onClose:cr,onSwitch:or},{default:withCtx(()=>[hr.$slots.viewer?(openBlock(),createElementBlock("div",_hoisted_2$e,[renderSlot(hr.$slots,"viewer")])):createCommentVNode("v-if",!0)]),_:3},8,["z-index","initial-index","infinite","zoom-rate","min-scale","max-scale","url-list","hide-on-click-modal","teleported","close-on-press-escape"])):createCommentVNode("v-if",!0)],64)):createCommentVNode("v-if",!0)],6))}});var Image$1=_export_sfc$1(_sfc_main$t,[["__file","image.vue"]]);const ElImage=withInstall(Image$1),inputNumberProps=buildProps({id:{type:String,default:void 0},step:{type:Number,default:1},stepStrictly:Boolean,max:{type:Number,default:Number.POSITIVE_INFINITY},min:{type:Number,default:Number.NEGATIVE_INFINITY},modelValue:Number,readonly:Boolean,disabled:Boolean,size:useSizeProp,controls:{type:Boolean,default:!0},controlsPosition:{type:String,default:"",values:["","right"]},valueOnClear:{type:[String,Number,null],validator:t=>t===null||isNumber$1(t)||["min","max"].includes(t),default:null},name:String,label:String,placeholder:String,precision:{type:Number,validator:t=>t>=0&&t===Number.parseInt(`${t}`,10)},validateEvent:{type:Boolean,default:!0}}),inputNumberEmits={[CHANGE_EVENT]:(t,r)=>r!==t,blur:t=>t instanceof FocusEvent,focus:t=>t instanceof FocusEvent,[INPUT_EVENT]:t=>isNumber$1(t)||isNil(t),[UPDATE_MODEL_EVENT]:t=>isNumber$1(t)||isNil(t)},_hoisted_1$j=["aria-label","onKeydown"],_hoisted_2$d=["aria-label","onKeydown"],__default__$7=defineComponent({name:"ElInputNumber"}),_sfc_main$s=defineComponent({...__default__$7,props:inputNumberProps,emits:inputNumberEmits,setup(t,{expose:r,emit:e}){const n=t,{t:g}=useLocale(),y=useNamespace("input-number"),i=ref(),k=reactive({currentValue:n.modelValue,userInput:null}),{formItem:$}=useFormItem(),L=computed(()=>isNumber$1(n.modelValue)&&n.modelValue<=n.min),V=computed(()=>isNumber$1(n.modelValue)&&n.modelValue>=n.max),z=computed(()=>{const er=ae(n.step);return isUndefined$1(n.precision)?Math.max(ae(n.modelValue),er):(er>n.precision,n.precision)}),re=computed(()=>n.controls&&n.controlsPosition==="right"),ie=useFormSize(),ue=useFormDisabled(),le=computed(()=>{if(k.userInput!==null)return k.userInput;let er=k.currentValue;if(isNil(er))return"";if(isNumber$1(er)){if(Number.isNaN(er))return"";isUndefined$1(n.precision)||(er=er.toFixed(n.precision))}return er}),oe=(er,cr)=>{if(isUndefined$1(cr)&&(cr=z.value),cr===0)return Math.round(er);let or=String(er);const hr=or.indexOf(".");if(hr===-1||!or.replace(".","").split("")[hr+cr])return er;const Er=or.length;return or.charAt(Er-1)==="5"&&(or=`${or.slice(0,Math.max(0,Er-1))}6`),Number.parseFloat(Number(or).toFixed(cr))},ae=er=>{if(isNil(er))return 0;const cr=er.toString(),or=cr.indexOf(".");let hr=0;return or!==-1&&(hr=cr.length-or-1),hr},qe=(er,cr=1)=>isNumber$1(er)?oe(er+n.step*cr):k.currentValue,de=()=>{if(n.readonly||ue.value||V.value)return;const er=Number(le.value)||0,cr=qe(er);$e(cr),e(INPUT_EVENT,k.currentValue),lr()},Ne=()=>{if(n.readonly||ue.value||L.value)return;const er=Number(le.value)||0,cr=qe(er,-1);$e(cr),e(INPUT_EVENT,k.currentValue),lr()},ze=(er,cr)=>{const{max:or,min:hr,step:pr,precision:Sr,stepStrictly:Er,valueOnClear:Pr}=n;or<hr&&throwError("InputNumber","min should not be greater than max.");let Cr=Number(er);if(isNil(er)||Number.isNaN(Cr))return null;if(er===""){if(Pr===null)return null;Cr=isString$2(Pr)?{min:hr,max:or}[Pr]:Pr}return Er&&(Cr=oe(Math.round(Cr/pr)*pr,Sr)),isUndefined$1(Sr)||(Cr=oe(Cr,Sr)),(Cr>or||Cr<hr)&&(Cr=Cr>or?or:hr,cr&&e(UPDATE_MODEL_EVENT,Cr)),Cr},$e=(er,cr=!0)=>{var or;const hr=k.currentValue,pr=ze(er);if(!cr){e(UPDATE_MODEL_EVENT,pr);return}hr!==pr&&(k.userInput=null,e(UPDATE_MODEL_EVENT,pr),e(CHANGE_EVENT,pr,hr),n.validateEvent&&((or=$==null?void 0:$.validate)==null||or.call($,"change").catch(Sr=>void 0)),k.currentValue=pr)},Lt=er=>{k.userInput=er;const cr=er===""?null:Number(er);e(INPUT_EVENT,cr),$e(cr,!1)},jt=er=>{const cr=er!==""?Number(er):"";(isNumber$1(cr)&&!Number.isNaN(cr)||er==="")&&$e(cr),lr(),k.userInput=null},Et=()=>{var er,cr;(cr=(er=i.value)==null?void 0:er.focus)==null||cr.call(er)},ir=()=>{var er,cr;(cr=(er=i.value)==null?void 0:er.blur)==null||cr.call(er)},dr=er=>{e("focus",er)},Dt=er=>{var cr;k.userInput=null,e("blur",er),n.validateEvent&&((cr=$==null?void 0:$.validate)==null||cr.call($,"blur").catch(or=>void 0))},lr=()=>{k.currentValue!==n.modelValue&&(k.currentValue=n.modelValue)},sr=er=>{document.activeElement===er.target&&er.preventDefault()};return watch(()=>n.modelValue,(er,cr)=>{const or=ze(er,!0);k.userInput===null&&or!==cr&&(k.currentValue=or)},{immediate:!0}),onMounted(()=>{var er;const{min:cr,max:or,modelValue:hr}=n,pr=(er=i.value)==null?void 0:er.input;if(pr.setAttribute("role","spinbutton"),Number.isFinite(or)?pr.setAttribute("aria-valuemax",String(or)):pr.removeAttribute("aria-valuemax"),Number.isFinite(cr)?pr.setAttribute("aria-valuemin",String(cr)):pr.removeAttribute("aria-valuemin"),pr.setAttribute("aria-valuenow",k.currentValue||k.currentValue===0?String(k.currentValue):""),pr.setAttribute("aria-disabled",String(ue.value)),!isNumber$1(hr)&&hr!=null){let Sr=Number(hr);Number.isNaN(Sr)&&(Sr=null),e(UPDATE_MODEL_EVENT,Sr)}}),onUpdated(()=>{var er,cr;const or=(er=i.value)==null?void 0:er.input;or==null||or.setAttribute("aria-valuenow",`${(cr=k.currentValue)!=null?cr:""}`)}),r({focus:Et,blur:ir}),(er,cr)=>(openBlock(),createElementBlock("div",{class:normalizeClass([unref(y).b(),unref(y).m(unref(ie)),unref(y).is("disabled",unref(ue)),unref(y).is("without-controls",!er.controls),unref(y).is("controls-right",unref(re))]),onDragstart:cr[0]||(cr[0]=withModifiers(()=>{},["prevent"]))},[er.controls?withDirectives((openBlock(),createElementBlock("span",{key:0,role:"button","aria-label":unref(g)("el.inputNumber.decrease"),class:normalizeClass([unref(y).e("decrease"),unref(y).is("disabled",unref(L))]),onKeydown:withKeys(Ne,["enter"])},[createVNode(unref(ElIcon),null,{default:withCtx(()=>[unref(re)?(openBlock(),createBlock(unref(arrow_down_default),{key:0})):(openBlock(),createBlock(unref(minus_default),{key:1}))]),_:1})],42,_hoisted_1$j)),[[unref(vRepeatClick),Ne]]):createCommentVNode("v-if",!0),er.controls?withDirectives((openBlock(),createElementBlock("span",{key:1,role:"button","aria-label":unref(g)("el.inputNumber.increase"),class:normalizeClass([unref(y).e("increase"),unref(y).is("disabled",unref(V))]),onKeydown:withKeys(de,["enter"])},[createVNode(unref(ElIcon),null,{default:withCtx(()=>[unref(re)?(openBlock(),createBlock(unref(arrow_up_default),{key:0})):(openBlock(),createBlock(unref(plus_default),{key:1}))]),_:1})],42,_hoisted_2$d)),[[unref(vRepeatClick),de]]):createCommentVNode("v-if",!0),createVNode(unref(ElInput),{id:er.id,ref_key:"input",ref:i,type:"number",step:er.step,"model-value":unref(le),placeholder:er.placeholder,readonly:er.readonly,disabled:unref(ue),size:unref(ie),max:er.max,min:er.min,name:er.name,label:er.label,"validate-event":!1,onWheel:sr,onKeydown:[withKeys(withModifiers(de,["prevent"]),["up"]),withKeys(withModifiers(Ne,["prevent"]),["down"])],onBlur:Dt,onFocus:dr,onInput:Lt,onChange:jt},null,8,["id","step","model-value","placeholder","readonly","disabled","size","max","min","name","label","onKeydown"])],34))}});var InputNumber=_export_sfc$1(_sfc_main$s,[["__file","input-number.vue"]]);const ElInputNumber=withInstall(InputNumber);let SubMenu$1=class{constructor(r,e){this.parent=r,this.domNode=e,this.subIndex=0,this.subIndex=0,this.init()}init(){this.subMenuItems=this.domNode.querySelectorAll("li"),this.addListeners()}gotoSubIndex(r){r===this.subMenuItems.length?r=0:r<0&&(r=this.subMenuItems.length-1),this.subMenuItems[r].focus(),this.subIndex=r}addListeners(){const r=this.parent.domNode;Array.prototype.forEach.call(this.subMenuItems,e=>{e.addEventListener("keydown",n=>{let g=!1;switch(n.code){case EVENT_CODE.down:{this.gotoSubIndex(this.subIndex+1),g=!0;break}case EVENT_CODE.up:{this.gotoSubIndex(this.subIndex-1),g=!0;break}case EVENT_CODE.tab:{triggerEvent(r,"mouseleave");break}case EVENT_CODE.enter:case EVENT_CODE.space:{g=!0,n.currentTarget.click();break}}return g&&(n.preventDefault(),n.stopPropagation()),!1})})}},MenuItem$1=class{constructor(r,e){this.domNode=r,this.submenu=null,this.submenu=null,this.init(e)}init(r){this.domNode.setAttribute("tabindex","0");const e=this.domNode.querySelector(`.${r}-menu`);e&&(this.submenu=new SubMenu$1(this,e)),this.addListeners()}addListeners(){this.domNode.addEventListener("keydown",r=>{let e=!1;switch(r.code){case EVENT_CODE.down:{triggerEvent(r.currentTarget,"mouseenter"),this.submenu&&this.submenu.gotoSubIndex(0),e=!0;break}case EVENT_CODE.up:{triggerEvent(r.currentTarget,"mouseenter"),this.submenu&&this.submenu.gotoSubIndex(this.submenu.subMenuItems.length-1),e=!0;break}case EVENT_CODE.tab:{triggerEvent(r.currentTarget,"mouseleave");break}case EVENT_CODE.enter:case EVENT_CODE.space:{e=!0,r.currentTarget.click();break}}e&&r.preventDefault()})}},Menu$1=class{constructor(r,e){this.domNode=r,this.init(e)}init(r){const e=this.domNode.childNodes;Array.from(e).forEach(n=>{n.nodeType===1&&new MenuItem$1(n,r)})}};const _sfc_main$r=defineComponent({name:"ElMenuCollapseTransition",setup(){const t=useNamespace("menu");return{listeners:{onBeforeEnter:e=>e.style.opacity="0.2",onEnter(e,n){addClass(e,`${t.namespace.value}-opacity-transition`),e.style.opacity="1",n()},onAfterEnter(e){removeClass(e,`${t.namespace.value}-opacity-transition`),e.style.opacity=""},onBeforeLeave(e){e.dataset||(e.dataset={}),hasClass(e,t.m("collapse"))?(removeClass(e,t.m("collapse")),e.dataset.oldOverflow=e.style.overflow,e.dataset.scrollWidth=e.clientWidth.toString(),addClass(e,t.m("collapse"))):(addClass(e,t.m("collapse")),e.dataset.oldOverflow=e.style.overflow,e.dataset.scrollWidth=e.clientWidth.toString(),removeClass(e,t.m("collapse"))),e.style.width=`${e.scrollWidth}px`,e.style.overflow="hidden"},onLeave(e){addClass(e,"horizontal-collapse-transition"),e.style.width=`${e.dataset.scrollWidth}px`}}}}});function _sfc_render$5(t,r,e,n,g,y){return openBlock(),createBlock(Transition,mergeProps({mode:"out-in"},t.listeners),{default:withCtx(()=>[renderSlot(t.$slots,"default")]),_:3},16)}var ElMenuCollapseTransition=_export_sfc$1(_sfc_main$r,[["render",_sfc_render$5],["__file","menu-collapse-transition.vue"]]);function useMenu(t,r){const e=computed(()=>{let g=t.parent;const y=[r.value];for(;g.type.name!=="ElMenu";)g.props.index&&y.unshift(g.props.index),g=g.parent;return y});return{parentMenu:computed(()=>{let g=t.parent;for(;g&&!["ElMenu","ElSubMenu"].includes(g.type.name);)g=g.parent;return g}),indexPath:e}}function useMenuColor(t){return computed(()=>{const e=t.backgroundColor;return e?new TinyColor(e).shade(20).toString():""})}const useMenuCssVar=(t,r)=>{const e=useNamespace("menu");return computed(()=>e.cssVarBlock({"text-color":t.textColor||"","hover-text-color":t.textColor||"","bg-color":t.backgroundColor||"","hover-bg-color":useMenuColor(t).value||"","active-color":t.activeTextColor||"",level:`${r}`}))},subMenuProps=buildProps({index:{type:String,required:!0},showTimeout:Number,hideTimeout:Number,popperClass:String,disabled:Boolean,popperAppendToBody:{type:Boolean,default:void 0},teleported:{type:Boolean,default:void 0},popperOffset:Number,expandCloseIcon:{type:iconPropType},expandOpenIcon:{type:iconPropType},collapseCloseIcon:{type:iconPropType},collapseOpenIcon:{type:iconPropType}}),COMPONENT_NAME$4="ElSubMenu";var SubMenu=defineComponent({name:COMPONENT_NAME$4,props:subMenuProps,setup(t,{slots:r,expose:e}){useDeprecated({from:"popper-append-to-body",replacement:"teleported",scope:COMPONENT_NAME$4,version:"2.3.0",ref:"https://element-plus.org/en-US/component/menu.html#submenu-attributes"},computed(()=>t.popperAppendToBody!==void 0));const n=getCurrentInstance(),{indexPath:g,parentMenu:y}=useMenu(n,computed(()=>t.index)),i=useNamespace("menu"),k=useNamespace("sub-menu"),$=inject("rootMenu");$||throwError(COMPONENT_NAME$4,"can not inject root menu");const L=inject(`subMenu:${y.value.uid}`);L||throwError(COMPONENT_NAME$4,"can not inject sub menu");const V=ref({}),z=ref({});let re;const ie=ref(!1),ue=ref(),le=ref(null),oe=computed(()=>jt.value==="horizontal"&&qe.value?"bottom-start":"right-start"),ae=computed(()=>jt.value==="horizontal"&&qe.value||jt.value==="vertical"&&!$.props.collapse?t.expandCloseIcon&&t.expandOpenIcon?$e.value?t.expandOpenIcon:t.expandCloseIcon:arrow_down_default:t.collapseCloseIcon&&t.collapseOpenIcon?$e.value?t.collapseOpenIcon:t.collapseCloseIcon:arrow_right_default),qe=computed(()=>L.level===0),de=computed(()=>{var Sr;const Er=(Sr=t.teleported)!=null?Sr:t.popperAppendToBody;return Er===void 0?qe.value:Er}),Ne=computed(()=>$.props.collapse?`${i.namespace.value}-zoom-in-left`:`${i.namespace.value}-zoom-in-top`),ze=computed(()=>jt.value==="horizontal"&&qe.value?["bottom-start","bottom-end","top-start","top-end","right-start","left-start"]:["right-start","right","right-end","left-start","bottom-start","bottom-end","top-start","top-end"]),$e=computed(()=>$.openedMenus.includes(t.index)),Lt=computed(()=>{let Sr=!1;return Object.values(V.value).forEach(Er=>{Er.active&&(Sr=!0)}),Object.values(z.value).forEach(Er=>{Er.active&&(Sr=!0)}),Sr}),jt=computed(()=>$.props.mode),Et=reactive({index:t.index,indexPath:g,active:Lt}),ir=useMenuCssVar($.props,L.level+1),dr=computed(()=>{var Sr;return(Sr=t.popperOffset)!=null?Sr:$.props.popperOffset}),Dt=computed(()=>{var Sr;return(Sr=t.popperClass)!=null?Sr:$.props.popperClass}),lr=computed(()=>{var Sr;return(Sr=t.showTimeout)!=null?Sr:$.props.showTimeout}),sr=computed(()=>{var Sr;return(Sr=t.hideTimeout)!=null?Sr:$.props.hideTimeout}),er=()=>{var Sr,Er,Pr;return(Pr=(Er=(Sr=le.value)==null?void 0:Sr.popperRef)==null?void 0:Er.popperInstanceRef)==null?void 0:Pr.destroy()},cr=Sr=>{Sr||er()},or=()=>{$.props.menuTrigger==="hover"&&$.props.mode==="horizontal"||$.props.collapse&&$.props.mode==="vertical"||t.disabled||$.handleSubMenuClick({index:t.index,indexPath:g.value,active:Lt.value})},hr=(Sr,Er=lr.value)=>{var Pr;if(Sr.type!=="focus"){if($.props.menuTrigger==="click"&&$.props.mode==="horizontal"||!$.props.collapse&&$.props.mode==="vertical"||t.disabled){L.mouseInChild.value=!0;return}L.mouseInChild.value=!0,re==null||re(),{stop:re}=useTimeoutFn(()=>{$.openMenu(t.index,g.value)},Er),de.value&&((Pr=y.value.vnode.el)==null||Pr.dispatchEvent(new MouseEvent("mouseenter")))}},pr=(Sr=!1)=>{var Er;if($.props.menuTrigger==="click"&&$.props.mode==="horizontal"||!$.props.collapse&&$.props.mode==="vertical"){L.mouseInChild.value=!1;return}re==null||re(),L.mouseInChild.value=!1,{stop:re}=useTimeoutFn(()=>!ie.value&&$.closeMenu(t.index,g.value),sr.value),de.value&&Sr&&((Er=L.handleMouseleave)==null||Er.call(L,!0))};watch(()=>$.props.collapse,Sr=>cr(!!Sr));{const Sr=Pr=>{z.value[Pr.index]=Pr},Er=Pr=>{delete z.value[Pr.index]};provide(`subMenu:${n.uid}`,{addSubMenu:Sr,removeSubMenu:Er,handleMouseleave:pr,mouseInChild:ie,level:L.level+1})}return e({opened:$e}),onMounted(()=>{$.addSubMenu(Et),L.addSubMenu(Et)}),onBeforeUnmount(()=>{L.removeSubMenu(Et),$.removeSubMenu(Et)}),()=>{var Sr;const Er=[(Sr=r.title)==null?void 0:Sr.call(r),h$1(ElIcon,{class:k.e("icon-arrow"),style:{transform:$e.value?t.expandCloseIcon&&t.expandOpenIcon||t.collapseCloseIcon&&t.collapseOpenIcon&&$.props.collapse?"none":"rotateZ(180deg)":"none"}},{default:()=>isString$2(ae.value)?h$1(n.appContext.components[ae.value]):h$1(ae.value)})],Pr=$.isMenuPopup?h$1(ElTooltip,{ref:le,visible:$e.value,effect:"light",pure:!0,offset:dr.value,showArrow:!1,persistent:!0,popperClass:Dt.value,placement:oe.value,teleported:de.value,fallbackPlacements:ze.value,transition:Ne.value,gpuAcceleration:!1},{content:()=>{var Cr;return h$1("div",{class:[i.m(jt.value),i.m("popup-container"),Dt.value],onMouseenter:rr=>hr(rr,100),onMouseleave:()=>pr(!0),onFocus:rr=>hr(rr,100)},[h$1("ul",{class:[i.b(),i.m("popup"),i.m(`popup-${oe.value}`)],style:ir.value},[(Cr=r.default)==null?void 0:Cr.call(r)])])},default:()=>h$1("div",{class:k.e("title"),onClick:or},Er)}):h$1(Fragment,{},[h$1("div",{class:k.e("title"),ref:ue,onClick:or},Er),h$1(_CollapseTransition,{},{default:()=>{var Cr;return withDirectives(h$1("ul",{role:"menu",class:[i.b(),i.m("inline")],style:ir.value},[(Cr=r.default)==null?void 0:Cr.call(r)]),[[vShow,$e.value]])}})]);return h$1("li",{class:[k.b(),k.is("active",Lt.value),k.is("opened",$e.value),k.is("disabled",t.disabled)],role:"menuitem",ariaHaspopup:!0,ariaExpanded:$e.value,onMouseenter:hr,onMouseleave:()=>pr(),onFocus:hr},[Pr])}}});const menuProps=buildProps({mode:{type:String,values:["horizontal","vertical"],default:"vertical"},defaultActive:{type:String,default:""},defaultOpeneds:{type:definePropType(Array),default:()=>mutable([])},uniqueOpened:Boolean,router:Boolean,menuTrigger:{type:String,values:["hover","click"],default:"hover"},collapse:Boolean,backgroundColor:String,textColor:String,activeTextColor:String,closeOnClickOutside:Boolean,collapseTransition:{type:Boolean,default:!0},ellipsis:{type:Boolean,default:!0},popperOffset:{type:Number,default:6},ellipsisIcon:{type:iconPropType,default:()=>more_default},popperEffect:{type:String,values:["dark","light"],default:"dark"},popperClass:String,showTimeout:{type:Number,default:300},hideTimeout:{type:Number,default:300}}),checkIndexPath=t=>Array.isArray(t)&&t.every(r=>isString$2(r)),menuEmits={close:(t,r)=>isString$2(t)&&checkIndexPath(r),open:(t,r)=>isString$2(t)&&checkIndexPath(r),select:(t,r,e,n)=>isString$2(t)&&checkIndexPath(r)&&isObject$2(e)&&(n===void 0||n instanceof Promise)};var Menu=defineComponent({name:"ElMenu",props:menuProps,emits:menuEmits,setup(t,{emit:r,slots:e,expose:n}){const g=getCurrentInstance(),y=g.appContext.config.globalProperties.$router,i=ref(),k=useNamespace("menu"),$=useNamespace("sub-menu"),L=ref(-1),V=ref(t.defaultOpeneds&&!t.collapse?t.defaultOpeneds.slice(0):[]),z=ref(t.defaultActive),re=ref({}),ie=ref({}),ue=computed(()=>t.mode==="horizontal"||t.mode==="vertical"&&t.collapse),le=()=>{const sr=z.value&&re.value[z.value];if(!sr||t.mode==="horizontal"||t.collapse)return;sr.indexPath.forEach(cr=>{const or=ie.value[cr];or&&oe(cr,or.indexPath)})},oe=(sr,er)=>{V.value.includes(sr)||(t.uniqueOpened&&(V.value=V.value.filter(cr=>er.includes(cr))),V.value.push(sr),r("open",sr,er))},ae=sr=>{const er=V.value.indexOf(sr);er!==-1&&V.value.splice(er,1)},qe=(sr,er)=>{ae(sr),r("close",sr,er)},de=({index:sr,indexPath:er})=>{V.value.includes(sr)?qe(sr,er):oe(sr,er)},Ne=sr=>{(t.mode==="horizontal"||t.collapse)&&(V.value=[]);const{index:er,indexPath:cr}=sr;if(!(isNil(er)||isNil(cr)))if(t.router&&y){const or=sr.route||er,hr=y.push(or).then(pr=>(pr||(z.value=er),pr));r("select",er,cr,{index:er,indexPath:cr,route:or},hr)}else z.value=er,r("select",er,cr,{index:er,indexPath:cr})},ze=sr=>{const er=re.value,cr=er[sr]||z.value&&er[z.value]||er[t.defaultActive];cr?z.value=cr.index:z.value=sr},$e=sr=>{const er=getComputedStyle(sr),cr=Number.parseInt(er.marginLeft,10),or=Number.parseInt(er.marginRight,10);return sr.offsetWidth+cr+or||0},Lt=()=>{var sr,er;if(!i.value)return-1;const cr=Array.from((er=(sr=i.value)==null?void 0:sr.childNodes)!=null?er:[]).filter(rr=>rr.nodeName!=="#comment"&&(rr.nodeName!=="#text"||rr.nodeValue)),or=64,hr=getComputedStyle(i.value),pr=Number.parseInt(hr.paddingLeft,10),Sr=Number.parseInt(hr.paddingRight,10),Er=i.value.clientWidth-pr-Sr;let Pr=0,Cr=0;return cr.forEach((rr,kr)=>{Pr+=$e(rr),Pr<=Er-or&&(Cr=kr+1)}),Cr===cr.length?-1:Cr},jt=sr=>ie.value[sr].indexPath,Et=(sr,er=33.34)=>{let cr;return()=>{cr&&clearTimeout(cr),cr=setTimeout(()=>{sr()},er)}};let ir=!0;const dr=()=>{const sr=()=>{L.value=-1,nextTick(()=>{L.value=Lt()})};ir?sr():Et(sr)(),ir=!1};watch(()=>t.defaultActive,sr=>{re.value[sr]||(z.value=""),ze(sr)}),watch(()=>t.collapse,sr=>{sr&&(V.value=[])}),watch(re.value,le);let Dt;watchEffect(()=>{t.mode==="horizontal"&&t.ellipsis?Dt=useResizeObserver(i,dr).stop:Dt==null||Dt()});const lr=ref(!1);{const sr=hr=>{ie.value[hr.index]=hr},er=hr=>{delete ie.value[hr.index]};provide("rootMenu",reactive({props:t,openedMenus:V,items:re,subMenus:ie,activeIndex:z,isMenuPopup:ue,addMenuItem:hr=>{re.value[hr.index]=hr},removeMenuItem:hr=>{delete re.value[hr.index]},addSubMenu:sr,removeSubMenu:er,openMenu:oe,closeMenu:qe,handleMenuItemClick:Ne,handleSubMenuClick:de})),provide(`subMenu:${g.uid}`,{addSubMenu:sr,removeSubMenu:er,mouseInChild:lr,level:0})}return onMounted(()=>{t.mode==="horizontal"&&new Menu$1(g.vnode.el,k.namespace.value)}),n({open:er=>{const{indexPath:cr}=ie.value[er];cr.forEach(or=>oe(or,cr))},close:ae,handleResize:dr}),()=>{var sr,er;let cr=(er=(sr=e.default)==null?void 0:sr.call(e))!=null?er:[];const or=[];if(t.mode==="horizontal"&&i.value){const Er=flattedChildren(cr),Pr=L.value===-1?Er:Er.slice(0,L.value),Cr=L.value===-1?[]:Er.slice(L.value);Cr!=null&&Cr.length&&t.ellipsis&&(cr=Pr,or.push(h$1(SubMenu,{index:"sub-menu-more",class:$.e("hide-arrow"),popperOffset:t.popperOffset},{title:()=>h$1(ElIcon,{class:$.e("icon-more")},{default:()=>h$1(t.ellipsisIcon)}),default:()=>Cr})))}const hr=useMenuCssVar(t,0),pr=t.closeOnClickOutside?[[ClickOutside,()=>{V.value.length&&(lr.value||(V.value.forEach(Er=>r("close",Er,jt(Er))),V.value=[]))}]]:[],Sr=withDirectives(h$1("ul",{key:String(t.collapse),role:"menubar",ref:i,style:hr.value,class:{[k.b()]:!0,[k.m(t.mode)]:!0,[k.m("collapse")]:t.collapse}},[...cr,...or]),pr);return t.collapseTransition&&t.mode==="vertical"?h$1(ElMenuCollapseTransition,()=>Sr):Sr}}});const menuItemProps=buildProps({index:{type:definePropType([String,null]),default:null},route:{type:definePropType([String,Object])},disabled:Boolean}),menuItemEmits={click:t=>isString$2(t.index)&&Array.isArray(t.indexPath)},COMPONENT_NAME$3="ElMenuItem",_sfc_main$q=defineComponent({name:COMPONENT_NAME$3,components:{ElTooltip},props:menuItemProps,emits:menuItemEmits,setup(t,{emit:r}){const e=getCurrentInstance(),n=inject("rootMenu"),g=useNamespace("menu"),y=useNamespace("menu-item");n||throwError(COMPONENT_NAME$3,"can not inject root menu");const{parentMenu:i,indexPath:k}=useMenu(e,toRef(t,"index")),$=inject(`subMenu:${i.value.uid}`);$||throwError(COMPONENT_NAME$3,"can not inject sub menu");const L=computed(()=>t.index===n.activeIndex),V=reactive({index:t.index,indexPath:k,active:L}),z=()=>{t.disabled||(n.handleMenuItemClick({index:t.index,indexPath:k.value,route:t.route}),r("click",V))};return onMounted(()=>{$.addSubMenu(V),n.addMenuItem(V)}),onBeforeUnmount(()=>{$.removeSubMenu(V),n.removeMenuItem(V)}),{parentMenu:i,rootMenu:n,active:L,nsMenu:g,nsMenuItem:y,handleClick:z}}});function _sfc_render$4(t,r,e,n,g,y){const i=resolveComponent("el-tooltip");return openBlock(),createElementBlock("li",{class:normalizeClass([t.nsMenuItem.b(),t.nsMenuItem.is("active",t.active),t.nsMenuItem.is("disabled",t.disabled)]),role:"menuitem",tabindex:"-1",onClick:r[0]||(r[0]=(...k)=>t.handleClick&&t.handleClick(...k))},[t.parentMenu.type.name==="ElMenu"&&t.rootMenu.props.collapse&&t.$slots.title?(openBlock(),createBlock(i,{key:0,effect:t.rootMenu.props.popperEffect,placement:"right","fallback-placements":["left"],persistent:""},{content:withCtx(()=>[renderSlot(t.$slots,"title")]),default:withCtx(()=>[createBaseVNode("div",{class:normalizeClass(t.nsMenu.be("tooltip","trigger"))},[renderSlot(t.$slots,"default")],2)]),_:3},8,["effect"])):(openBlock(),createElementBlock(Fragment,{key:1},[renderSlot(t.$slots,"default"),renderSlot(t.$slots,"title")],64))],2)}var MenuItem=_export_sfc$1(_sfc_main$q,[["render",_sfc_render$4],["__file","menu-item.vue"]]);const menuItemGroupProps={title:String},COMPONENT_NAME$2="ElMenuItemGroup",_sfc_main$p=defineComponent({name:COMPONENT_NAME$2,props:menuItemGroupProps,setup(){return{ns:useNamespace("menu-item-group")}}});function _sfc_render$3(t,r,e,n,g,y){return openBlock(),createElementBlock("li",{class:normalizeClass(t.ns.b())},[createBaseVNode("div",{class:normalizeClass(t.ns.e("title"))},[t.$slots.title?renderSlot(t.$slots,"title",{key:1}):(openBlock(),createElementBlock(Fragment,{key:0},[createTextVNode(toDisplayString(t.title),1)],64))],2),createBaseVNode("ul",null,[renderSlot(t.$slots,"default")])],2)}var MenuItemGroup=_export_sfc$1(_sfc_main$p,[["render",_sfc_render$3],["__file","menu-item-group.vue"]]);const ElMenu=withInstall(Menu,{MenuItem,MenuItemGroup,SubMenu}),ElMenuItem=withNoopInstall(MenuItem);withNoopInstall(MenuItemGroup);const ElSubMenu=withNoopInstall(SubMenu),progressProps=buildProps({type:{type:String,default:"line",values:["line","circle","dashboard"]},percentage:{type:Number,default:0,validator:t=>t>=0&&t<=100},status:{type:String,default:"",values:["","success","exception","warning"]},indeterminate:{type:Boolean,default:!1},duration:{type:Number,default:3},strokeWidth:{type:Number,default:6},strokeLinecap:{type:definePropType(String),default:"round"},textInside:{type:Boolean,default:!1},width:{type:Number,default:126},showText:{type:Boolean,default:!0},color:{type:definePropType([String,Array,Function]),default:""},striped:Boolean,stripedFlow:Boolean,format:{type:definePropType(Function),default:t=>`${t}%`}}),_hoisted_1$i=["aria-valuenow"],_hoisted_2$c={viewBox:"0 0 100 100"},_hoisted_3$9=["d","stroke","stroke-linecap","stroke-width"],_hoisted_4$6=["d","stroke","opacity","stroke-linecap","stroke-width"],_hoisted_5$5={key:0},__default__$6=defineComponent({name:"ElProgress"}),_sfc_main$o=defineComponent({...__default__$6,props:progressProps,setup(t){const r=t,e={success:"#13ce66",exception:"#ff4949",warning:"#e6a23c",default:"#20a0ff"},n=useNamespace("progress"),g=computed(()=>({width:`${r.percentage}%`,animationDuration:`${r.duration}s`,backgroundColor:qe(r.percentage)})),y=computed(()=>(r.strokeWidth/r.width*100).toFixed(1)),i=computed(()=>["circle","dashboard"].includes(r.type)?Number.parseInt(`${50-Number.parseFloat(y.value)/2}`,10):0),k=computed(()=>{const de=i.value,Ne=r.type==="dashboard";return`
          M 50 50
          m 0 ${Ne?"":"-"}${de}
          a ${de} ${de} 0 1 1 0 ${Ne?"-":""}${de*2}
          a ${de} ${de} 0 1 1 0 ${Ne?"":"-"}${de*2}
          `}),$=computed(()=>2*Math.PI*i.value),L=computed(()=>r.type==="dashboard"?.75:1),V=computed(()=>`${-1*$.value*(1-L.value)/2}px`),z=computed(()=>({strokeDasharray:`${$.value*L.value}px, ${$.value}px`,strokeDashoffset:V.value})),re=computed(()=>({strokeDasharray:`${$.value*L.value*(r.percentage/100)}px, ${$.value}px`,strokeDashoffset:V.value,transition:"stroke-dasharray 0.6s ease 0s, stroke 0.6s ease, opacity ease 0.6s"})),ie=computed(()=>{let de;return r.color?de=qe(r.percentage):de=e[r.status]||e.default,de}),ue=computed(()=>r.status==="warning"?warning_filled_default:r.type==="line"?r.status==="success"?circle_check_default:circle_close_default:r.status==="success"?check_default:close_default),le=computed(()=>r.type==="line"?12+r.strokeWidth*.4:r.width*.111111+2),oe=computed(()=>r.format(r.percentage));function ae(de){const Ne=100/de.length;return de.map(($e,Lt)=>isString$2($e)?{color:$e,percentage:(Lt+1)*Ne}:$e).sort(($e,Lt)=>$e.percentage-Lt.percentage)}const qe=de=>{var Ne;const{color:ze}=r;if(isFunction$3(ze))return ze(de);if(isString$2(ze))return ze;{const $e=ae(ze);for(const Lt of $e)if(Lt.percentage>de)return Lt.color;return(Ne=$e[$e.length-1])==null?void 0:Ne.color}};return(de,Ne)=>(openBlock(),createElementBlock("div",{class:normalizeClass([unref(n).b(),unref(n).m(de.type),unref(n).is(de.status),{[unref(n).m("without-text")]:!de.showText,[unref(n).m("text-inside")]:de.textInside}]),role:"progressbar","aria-valuenow":de.percentage,"aria-valuemin":"0","aria-valuemax":"100"},[de.type==="line"?(openBlock(),createElementBlock("div",{key:0,class:normalizeClass(unref(n).b("bar"))},[createBaseVNode("div",{class:normalizeClass(unref(n).be("bar","outer")),style:normalizeStyle({height:`${de.strokeWidth}px`})},[createBaseVNode("div",{class:normalizeClass([unref(n).be("bar","inner"),{[unref(n).bem("bar","inner","indeterminate")]:de.indeterminate},{[unref(n).bem("bar","inner","striped")]:de.striped},{[unref(n).bem("bar","inner","striped-flow")]:de.stripedFlow}]),style:normalizeStyle(unref(g))},[(de.showText||de.$slots.default)&&de.textInside?(openBlock(),createElementBlock("div",{key:0,class:normalizeClass(unref(n).be("bar","innerText"))},[renderSlot(de.$slots,"default",{percentage:de.percentage},()=>[createBaseVNode("span",null,toDisplayString(unref(oe)),1)])],2)):createCommentVNode("v-if",!0)],6)],6)],2)):(openBlock(),createElementBlock("div",{key:1,class:normalizeClass(unref(n).b("circle")),style:normalizeStyle({height:`${de.width}px`,width:`${de.width}px`})},[(openBlock(),createElementBlock("svg",_hoisted_2$c,[createBaseVNode("path",{class:normalizeClass(unref(n).be("circle","track")),d:unref(k),stroke:`var(${unref(n).cssVarName("fill-color-light")}, #e5e9f2)`,"stroke-linecap":de.strokeLinecap,"stroke-width":unref(y),fill:"none",style:normalizeStyle(unref(z))},null,14,_hoisted_3$9),createBaseVNode("path",{class:normalizeClass(unref(n).be("circle","path")),d:unref(k),stroke:unref(ie),fill:"none",opacity:de.percentage?1:0,"stroke-linecap":de.strokeLinecap,"stroke-width":unref(y),style:normalizeStyle(unref(re))},null,14,_hoisted_4$6)]))],6)),(de.showText||de.$slots.default)&&!de.textInside?(openBlock(),createElementBlock("div",{key:2,class:normalizeClass(unref(n).e("text")),style:normalizeStyle({fontSize:`${unref(le)}px`})},[renderSlot(de.$slots,"default",{percentage:de.percentage},()=>[de.status?(openBlock(),createBlock(unref(ElIcon),{key:1},{default:withCtx(()=>[(openBlock(),createBlock(resolveDynamicComponent(unref(ue))))]),_:1})):(openBlock(),createElementBlock("span",_hoisted_5$5,toDisplayString(unref(oe)),1))])],6)):createCommentVNode("v-if",!0)],10,_hoisted_1$i))}});var Progress=_export_sfc$1(_sfc_main$o,[["__file","progress.vue"]]);const ElProgress=withInstall(Progress),spaceItemProps=buildProps({prefixCls:{type:String}}),SpaceItem=defineComponent({name:"ElSpaceItem",props:spaceItemProps,setup(t,{slots:r}){const e=useNamespace("space"),n=computed(()=>`${t.prefixCls||e.b()}__item`);return()=>h$1("div",{class:n.value},renderSlot(r,"default"))}}),SIZE_MAP={small:8,default:12,large:16};function useSpace(t){const r=useNamespace("space"),e=computed(()=>[r.b(),r.m(t.direction),t.class]),n=ref(0),g=ref(0),y=computed(()=>{const k=t.wrap||t.fill?{flexWrap:"wrap"}:{},$={alignItems:t.alignment},L={rowGap:`${g.value}px`,columnGap:`${n.value}px`};return[k,$,L,t.style]}),i=computed(()=>t.fill?{flexGrow:1,minWidth:`${t.fillRatio}%`}:{});return watchEffect(()=>{const{size:k="small",wrap:$,direction:L,fill:V}=t;if(isArray$3(k)){const[z=0,re=0]=k;n.value=z,g.value=re}else{let z;isNumber$1(k)?z=k:z=SIZE_MAP[k||"small"]||SIZE_MAP.small,($||V)&&L==="horizontal"?n.value=g.value=z:L==="horizontal"?(n.value=z,g.value=0):(g.value=z,n.value=0)}}),{classes:e,containerStyle:y,itemStyle:i}}const spaceProps=buildProps({direction:{type:String,values:["horizontal","vertical"],default:"horizontal"},class:{type:definePropType([String,Object,Array]),default:""},style:{type:definePropType([String,Array,Object]),default:""},alignment:{type:definePropType(String),default:"center"},prefixCls:{type:String},spacer:{type:definePropType([Object,String,Number,Array]),default:null,validator:t=>isVNode(t)||isNumber$1(t)||isString$2(t)},wrap:Boolean,fill:Boolean,fillRatio:{type:Number,default:100},size:{type:[String,Array,Number],values:componentSizes,validator:t=>isNumber$1(t)||isArray$3(t)&&t.length===2&&t.every(isNumber$1)}}),Space=defineComponent({name:"ElSpace",props:spaceProps,setup(t,{slots:r}){const{classes:e,containerStyle:n,itemStyle:g}=useSpace(t);function y(i,k="",$=[]){const{prefixCls:L}=t;return i.forEach((V,z)=>{isFragment(V)?isArray$3(V.children)&&V.children.forEach((re,ie)=>{isFragment(re)&&isArray$3(re.children)?y(re.children,`${k+ie}-`,$):$.push(createVNode(SpaceItem,{style:g.value,prefixCls:L,key:`nested-${k+ie}`},{default:()=>[re]},PatchFlags.PROPS|PatchFlags.STYLE,["style","prefixCls"]))}):isValidElementNode(V)&&$.push(createVNode(SpaceItem,{style:g.value,prefixCls:L,key:`LoopKey${k+z}`},{default:()=>[V]},PatchFlags.PROPS|PatchFlags.STYLE,["style","prefixCls"]))}),$}return()=>{var i;const{spacer:k,direction:$}=t,L=renderSlot(r,"default",{key:0},()=>[]);if(((i=L.children)!=null?i:[]).length===0)return null;if(isArray$3(L.children)){let V=y(L.children);if(k){const z=V.length-1;V=V.reduce((re,ie,ue)=>{const le=[...re,ie];return ue!==z&&le.push(createVNode("span",{style:[g.value,$==="vertical"?"width: 100%":null],key:ue},[isVNode(k)?k:createTextVNode(k,PatchFlags.TEXT)],PatchFlags.STYLE)),le},[])}return createVNode("div",{class:e.value,style:n.value},V,PatchFlags.STYLE|PatchFlags.CLASS)}return L.children}}}),ElSpace=withInstall(Space),switchProps=buildProps({modelValue:{type:[Boolean,String,Number],default:!1},disabled:{type:Boolean,default:!1},loading:{type:Boolean,default:!1},size:{type:String,validator:isValidComponentSize},width:{type:[String,Number],default:""},inlinePrompt:{type:Boolean,default:!1},inactiveActionIcon:{type:iconPropType},activeActionIcon:{type:iconPropType},activeIcon:{type:iconPropType},inactiveIcon:{type:iconPropType},activeText:{type:String,default:""},inactiveText:{type:String,default:""},activeValue:{type:[Boolean,String,Number],default:!0},inactiveValue:{type:[Boolean,String,Number],default:!1},activeColor:{type:String,default:""},inactiveColor:{type:String,default:""},borderColor:{type:String,default:""},name:{type:String,default:""},validateEvent:{type:Boolean,default:!0},beforeChange:{type:definePropType(Function)},id:String,tabindex:{type:[String,Number]},value:{type:[Boolean,String,Number],default:!1},label:{type:String,default:void 0}}),switchEmits={[UPDATE_MODEL_EVENT]:t=>isBoolean$1(t)||isString$2(t)||isNumber$1(t),[CHANGE_EVENT]:t=>isBoolean$1(t)||isString$2(t)||isNumber$1(t),[INPUT_EVENT]:t=>isBoolean$1(t)||isString$2(t)||isNumber$1(t)},_hoisted_1$h=["onClick"],_hoisted_2$b=["id","aria-checked","aria-disabled","aria-label","name","true-value","false-value","disabled","tabindex","onKeydown"],_hoisted_3$8=["aria-hidden"],_hoisted_4$5=["aria-hidden"],_hoisted_5$4=["aria-hidden"],COMPONENT_NAME$1="ElSwitch",__default__$5=defineComponent({name:COMPONENT_NAME$1}),_sfc_main$n=defineComponent({...__default__$5,props:switchProps,emits:switchEmits,setup(t,{expose:r,emit:e}){const n=t,g=getCurrentInstance(),{formItem:y}=useFormItem(),i=useFormSize(),k=useNamespace("switch");(jt=>{jt.forEach(Et=>{useDeprecated({from:Et[0],replacement:Et[1],scope:COMPONENT_NAME$1,version:"2.3.0",ref:"https://element-plus.org/en-US/component/switch.html#attributes",type:"Attribute"},computed(()=>{var ir;return!!((ir=g.vnode.props)!=null&&ir[Et[2]])}))})})([['"value"','"model-value" or "v-model"',"value"],['"active-color"',"CSS var `--el-switch-on-color`","activeColor"],['"inactive-color"',"CSS var `--el-switch-off-color`","inactiveColor"],['"border-color"',"CSS var `--el-switch-border-color`","borderColor"]]);const{inputId:L}=useFormItemInputId(n,{formItemContext:y}),V=useFormDisabled(computed(()=>n.loading)),z=ref(n.modelValue!==!1),re=ref(),ie=ref(),ue=computed(()=>[k.b(),k.m(i.value),k.is("disabled",V.value),k.is("checked",de.value)]),le=computed(()=>[k.e("label"),k.em("label","left"),k.is("active",!de.value)]),oe=computed(()=>[k.e("label"),k.em("label","right"),k.is("active",de.value)]),ae=computed(()=>({width:addUnit(n.width)}));watch(()=>n.modelValue,()=>{z.value=!0}),watch(()=>n.value,()=>{z.value=!1});const qe=computed(()=>z.value?n.modelValue:n.value),de=computed(()=>qe.value===n.activeValue);[n.activeValue,n.inactiveValue].includes(qe.value)||(e(UPDATE_MODEL_EVENT,n.inactiveValue),e(CHANGE_EVENT,n.inactiveValue),e(INPUT_EVENT,n.inactiveValue)),watch(de,jt=>{var Et;re.value.checked=jt,n.validateEvent&&((Et=y==null?void 0:y.validate)==null||Et.call(y,"change").catch(ir=>void 0))});const Ne=()=>{const jt=de.value?n.inactiveValue:n.activeValue;e(UPDATE_MODEL_EVENT,jt),e(CHANGE_EVENT,jt),e(INPUT_EVENT,jt),nextTick(()=>{re.value.checked=de.value})},ze=()=>{if(V.value)return;const{beforeChange:jt}=n;if(!jt){Ne();return}const Et=jt();[isPromise(Et),isBoolean$1(Et)].includes(!0)||throwError(COMPONENT_NAME$1,"beforeChange must return type `Promise<boolean>` or `boolean`"),isPromise(Et)?Et.then(dr=>{dr&&Ne()}).catch(dr=>{}):Et&&Ne()},$e=computed(()=>k.cssVarBlock({...n.activeColor?{"on-color":n.activeColor}:null,...n.inactiveColor?{"off-color":n.inactiveColor}:null,...n.borderColor?{"border-color":n.borderColor}:null})),Lt=()=>{var jt,Et;(Et=(jt=re.value)==null?void 0:jt.focus)==null||Et.call(jt)};return onMounted(()=>{re.value.checked=de.value}),r({focus:Lt,checked:de}),(jt,Et)=>(openBlock(),createElementBlock("div",{class:normalizeClass(unref(ue)),style:normalizeStyle(unref($e)),onClick:withModifiers(ze,["prevent"])},[createBaseVNode("input",{id:unref(L),ref_key:"input",ref:re,class:normalizeClass(unref(k).e("input")),type:"checkbox",role:"switch","aria-checked":unref(de),"aria-disabled":unref(V),"aria-label":jt.label,name:jt.name,"true-value":jt.activeValue,"false-value":jt.inactiveValue,disabled:unref(V),tabindex:jt.tabindex,onChange:Ne,onKeydown:withKeys(ze,["enter"])},null,42,_hoisted_2$b),!jt.inlinePrompt&&(jt.inactiveIcon||jt.inactiveText)?(openBlock(),createElementBlock("span",{key:0,class:normalizeClass(unref(le))},[jt.inactiveIcon?(openBlock(),createBlock(unref(ElIcon),{key:0},{default:withCtx(()=>[(openBlock(),createBlock(resolveDynamicComponent(jt.inactiveIcon)))]),_:1})):createCommentVNode("v-if",!0),!jt.inactiveIcon&&jt.inactiveText?(openBlock(),createElementBlock("span",{key:1,"aria-hidden":unref(de)},toDisplayString(jt.inactiveText),9,_hoisted_3$8)):createCommentVNode("v-if",!0)],2)):createCommentVNode("v-if",!0),createBaseVNode("span",{ref_key:"core",ref:ie,class:normalizeClass(unref(k).e("core")),style:normalizeStyle(unref(ae))},[jt.inlinePrompt?(openBlock(),createElementBlock("div",{key:0,class:normalizeClass(unref(k).e("inner"))},[jt.activeIcon||jt.inactiveIcon?(openBlock(),createBlock(unref(ElIcon),{key:0,class:normalizeClass(unref(k).is("icon"))},{default:withCtx(()=>[(openBlock(),createBlock(resolveDynamicComponent(unref(de)?jt.activeIcon:jt.inactiveIcon)))]),_:1},8,["class"])):jt.activeText||jt.inactiveText?(openBlock(),createElementBlock("span",{key:1,class:normalizeClass(unref(k).is("text")),"aria-hidden":!unref(de)},toDisplayString(unref(de)?jt.activeText:jt.inactiveText),11,_hoisted_4$5)):createCommentVNode("v-if",!0)],2)):createCommentVNode("v-if",!0),createBaseVNode("div",{class:normalizeClass(unref(k).e("action"))},[jt.loading?(openBlock(),createBlock(unref(ElIcon),{key:0,class:normalizeClass(unref(k).is("loading"))},{default:withCtx(()=>[createVNode(unref(loading_default))]),_:1},8,["class"])):unref(de)?renderSlot(jt.$slots,"active-action",{key:1},()=>[jt.activeActionIcon?(openBlock(),createBlock(unref(ElIcon),{key:0},{default:withCtx(()=>[(openBlock(),createBlock(resolveDynamicComponent(jt.activeActionIcon)))]),_:1})):createCommentVNode("v-if",!0)]):unref(de)?createCommentVNode("v-if",!0):renderSlot(jt.$slots,"inactive-action",{key:2},()=>[jt.inactiveActionIcon?(openBlock(),createBlock(unref(ElIcon),{key:0},{default:withCtx(()=>[(openBlock(),createBlock(resolveDynamicComponent(jt.inactiveActionIcon)))]),_:1})):createCommentVNode("v-if",!0)])],2)],6),!jt.inlinePrompt&&(jt.activeIcon||jt.activeText)?(openBlock(),createElementBlock("span",{key:1,class:normalizeClass(unref(oe))},[jt.activeIcon?(openBlock(),createBlock(unref(ElIcon),{key:0},{default:withCtx(()=>[(openBlock(),createBlock(resolveDynamicComponent(jt.activeIcon)))]),_:1})):createCommentVNode("v-if",!0),!jt.activeIcon&&jt.activeText?(openBlock(),createElementBlock("span",{key:1,"aria-hidden":!unref(de)},toDisplayString(jt.activeText),9,_hoisted_5$4)):createCommentVNode("v-if",!0)],2)):createCommentVNode("v-if",!0)],14,_hoisted_1$h))}});var Switch=_export_sfc$1(_sfc_main$n,[["__file","switch.vue"]]);const ElSwitch=withInstall(Switch),getCell=function(t){var r;return(r=t.target)==null?void 0:r.closest("td")},orderBy=function(t,r,e,n,g){if(!r&&!n&&(!g||Array.isArray(g)&&!g.length))return t;typeof e=="string"?e=e==="descending"?-1:1:e=e&&e<0?-1:1;const y=n?null:function(k,$){return g?(Array.isArray(g)||(g=[g]),g.map(L=>typeof L=="string"?get(k,L):L(k,$,t))):(r!=="$key"&&isObject$2(k)&&"$value"in k&&(k=k.$value),[isObject$2(k)?get(k,r):k])},i=function(k,$){if(n)return n(k.value,$.value);for(let L=0,V=k.key.length;L<V;L++){if(k.key[L]<$.key[L])return-1;if(k.key[L]>$.key[L])return 1}return 0};return t.map((k,$)=>({value:k,index:$,key:y?y(k,$):null})).sort((k,$)=>{let L=i(k,$);return L||(L=k.index-$.index),L*+e}).map(k=>k.value)},getColumnById=function(t,r){let e=null;return t.columns.forEach(n=>{n.id===r&&(e=n)}),e},getColumnByKey=function(t,r){let e=null;for(let n=0;n<t.columns.length;n++){const g=t.columns[n];if(g.columnKey===r){e=g;break}}return e||throwError("ElTable",`No column matching with column-key: ${r}`),e},getColumnByCell=function(t,r,e){const n=(r.className||"").match(new RegExp(`${e}-table_[^\\s]+`,"gm"));return n?getColumnById(t,n[0]):null},getRowIdentity=(t,r)=>{if(!t)throw new Error("Row is required when get row identity");if(typeof r=="string"){if(!r.includes("."))return`${t[r]}`;const e=r.split(".");let n=t;for(const g of e)n=n[g];return`${n}`}else if(typeof r=="function")return r.call(null,t)},getKeysMap=function(t,r){const e={};return(t||[]).forEach((n,g)=>{e[getRowIdentity(n,r)]={row:n,index:g}}),e};function mergeOptions(t,r){const e={};let n;for(n in t)e[n]=t[n];for(n in r)if(hasOwn(r,n)){const g=r[n];typeof g<"u"&&(e[n]=g)}return e}function parseWidth(t){return t===""||t!==void 0&&(t=Number.parseInt(t,10),Number.isNaN(t)&&(t="")),t}function parseMinWidth(t){return t===""||t!==void 0&&(t=parseWidth(t),Number.isNaN(t)&&(t=80)),t}function parseHeight(t){return typeof t=="number"?t:typeof t=="string"?/^\d+(?:px)?$/.test(t)?Number.parseInt(t,10):t:null}function compose(...t){return t.length===0?r=>r:t.length===1?t[0]:t.reduce((r,e)=>(...n)=>r(e(...n)))}function toggleRowStatus(t,r,e){let n=!1;const g=t.indexOf(r),y=g!==-1,i=k=>{k==="add"?t.push(r):t.splice(g,1),n=!0,isArray$3(r.children)&&r.children.forEach($=>{toggleRowStatus(t,$,e??!y)})};return isBoolean$1(e)?e&&!y?i("add"):!e&&y&&i("remove"):i(y?"remove":"add"),n}function walkTreeNode(t,r,e="children",n="hasChildren"){const g=i=>!(Array.isArray(i)&&i.length);function y(i,k,$){r(i,k,$),k.forEach(L=>{if(L[n]){r(L,null,$+1);return}const V=L[e];g(V)||y(L,V,$+1)})}t.forEach(i=>{if(i[n]){r(i,null,0);return}const k=i[e];g(k)||y(i,k,0)})}let removePopper=null;function createTablePopper(t,r,e,n){if((removePopper==null?void 0:removePopper.trigger)===e)return;removePopper==null||removePopper();const g=n==null?void 0:n.refs.tableWrapper,y=g==null?void 0:g.dataset.prefix,i={strategy:"fixed",...t.popperOptions},k=createVNode(ElTooltip,{content:r,virtualTriggering:!0,virtualRef:e,appendTo:g,placement:"top",transition:"none",offset:0,hideAfter:0,...t,popperOptions:i,onHide:()=>{removePopper==null||removePopper()}});k.appContext={...n.appContext,...n};const $=document.createElement("div");render(k,$),k.component.exposed.onOpen();const L=g==null?void 0:g.querySelector(`.${y}-scrollbar__wrap`);removePopper=()=>{render(null,$),L==null||L.removeEventListener("scroll",removePopper),removePopper=null},removePopper.trigger=e,L==null||L.addEventListener("scroll",removePopper)}function getCurrentColumns(t){return t.children?flatMap(t.children,getCurrentColumns):[t]}function getColSpan(t,r){return t+r.colSpan}const isFixedColumn=(t,r,e,n)=>{let g=0,y=t;const i=e.states.columns.value;if(n){const $=getCurrentColumns(n[t]);g=i.slice(0,i.indexOf($[0])).reduce(getColSpan,0),y=g+$.reduce(getColSpan,0)-1}else g=t;let k;switch(r){case"left":y<e.states.fixedLeafColumnsLength.value&&(k="left");break;case"right":g>=i.length-e.states.rightFixedLeafColumnsLength.value&&(k="right");break;default:y<e.states.fixedLeafColumnsLength.value?k="left":g>=i.length-e.states.rightFixedLeafColumnsLength.value&&(k="right")}return k?{direction:k,start:g,after:y}:{}},getFixedColumnsClass=(t,r,e,n,g,y=0)=>{const i=[],{direction:k,start:$,after:L}=isFixedColumn(r,e,n,g);if(k){const V=k==="left";i.push(`${t}-fixed-column--${k}`),V&&L+y===n.states.fixedLeafColumnsLength.value-1?i.push("is-last-column"):!V&&$-y===n.states.columns.value.length-n.states.rightFixedLeafColumnsLength.value&&i.push("is-first-column")}return i};function getOffset(t,r){return t+(r.realWidth===null||Number.isNaN(r.realWidth)?Number(r.width):r.realWidth)}const getFixedColumnOffset=(t,r,e,n)=>{const{direction:g,start:y=0,after:i=0}=isFixedColumn(t,r,e,n);if(!g)return;const k={},$=g==="left",L=e.states.columns.value;return $?k.left=L.slice(0,y).reduce(getOffset,0):k.right=L.slice(i+1).reverse().reduce(getOffset,0),k},ensurePosition=(t,r)=>{t&&(Number.isNaN(t[r])||(t[r]=`${t[r]}px`))};function useExpand(t){const r=getCurrentInstance(),e=ref(!1),n=ref([]);return{updateExpandRows:()=>{const $=t.data.value||[],L=t.rowKey.value;if(e.value)n.value=$.slice();else if(L){const V=getKeysMap(n.value,L);n.value=$.reduce((z,re)=>{const ie=getRowIdentity(re,L);return V[ie]&&z.push(re),z},[])}else n.value=[]},toggleRowExpansion:($,L)=>{toggleRowStatus(n.value,$,L)&&r.emit("expand-change",$,n.value.slice())},setExpandRowKeys:$=>{r.store.assertRowKey();const L=t.data.value||[],V=t.rowKey.value,z=getKeysMap(L,V);n.value=$.reduce((re,ie)=>{const ue=z[ie];return ue&&re.push(ue.row),re},[])},isRowExpanded:$=>{const L=t.rowKey.value;return L?!!getKeysMap(n.value,L)[getRowIdentity($,L)]:n.value.includes($)},states:{expandRows:n,defaultExpandAll:e}}}function useCurrent(t){const r=getCurrentInstance(),e=ref(null),n=ref(null),g=L=>{r.store.assertRowKey(),e.value=L,i(L)},y=()=>{e.value=null},i=L=>{const{data:V,rowKey:z}=t;let re=null;z.value&&(re=(unref(V)||[]).find(ie=>getRowIdentity(ie,z.value)===L)),n.value=re,r.emit("current-change",n.value,null)};return{setCurrentRowKey:g,restoreCurrentRowKey:y,setCurrentRowByKey:i,updateCurrentRow:L=>{const V=n.value;if(L&&L!==V){n.value=L,r.emit("current-change",n.value,V);return}!L&&V&&(n.value=null,r.emit("current-change",null,V))},updateCurrentRowData:()=>{const L=t.rowKey.value,V=t.data.value||[],z=n.value;if(!V.includes(z)&&z){if(L){const re=getRowIdentity(z,L);i(re)}else n.value=null;n.value===null&&r.emit("current-change",null,z)}else e.value&&(i(e.value),y())},states:{_currentRowKey:e,currentRow:n}}}function useTree(t){const r=ref([]),e=ref({}),n=ref(16),g=ref(!1),y=ref({}),i=ref("hasChildren"),k=ref("children"),$=getCurrentInstance(),L=computed(()=>{if(!t.rowKey.value)return{};const ae=t.data.value||[];return z(ae)}),V=computed(()=>{const ae=t.rowKey.value,qe=Object.keys(y.value),de={};return qe.length&&qe.forEach(Ne=>{if(y.value[Ne].length){const ze={children:[]};y.value[Ne].forEach($e=>{const Lt=getRowIdentity($e,ae);ze.children.push(Lt),$e[i.value]&&!de[Lt]&&(de[Lt]={children:[]})}),de[Ne]=ze}}),de}),z=ae=>{const qe=t.rowKey.value,de={};return walkTreeNode(ae,(Ne,ze,$e)=>{const Lt=getRowIdentity(Ne,qe);Array.isArray(ze)?de[Lt]={children:ze.map(jt=>getRowIdentity(jt,qe)),level:$e}:g.value&&(de[Lt]={children:[],lazy:!0,level:$e})},k.value,i.value),de},re=(ae=!1,qe=(de=>(de=$.store)==null?void 0:de.states.defaultExpandAll.value)())=>{var de;const Ne=L.value,ze=V.value,$e=Object.keys(Ne),Lt={};if($e.length){const jt=unref(e),Et=[],ir=(Dt,lr)=>{if(ae)return r.value?qe||r.value.includes(lr):!!(qe||Dt!=null&&Dt.expanded);{const sr=qe||r.value&&r.value.includes(lr);return!!(Dt!=null&&Dt.expanded||sr)}};$e.forEach(Dt=>{const lr=jt[Dt],sr={...Ne[Dt]};if(sr.expanded=ir(lr,Dt),sr.lazy){const{loaded:er=!1,loading:cr=!1}=lr||{};sr.loaded=!!er,sr.loading=!!cr,Et.push(Dt)}Lt[Dt]=sr});const dr=Object.keys(ze);g.value&&dr.length&&Et.length&&dr.forEach(Dt=>{const lr=jt[Dt],sr=ze[Dt].children;if(Et.includes(Dt)){if(Lt[Dt].children.length!==0)throw new Error("[ElTable]children must be an empty array.");Lt[Dt].children=sr}else{const{loaded:er=!1,loading:cr=!1}=lr||{};Lt[Dt]={lazy:!0,loaded:!!er,loading:!!cr,expanded:ir(lr,Dt),children:sr,level:""}}})}e.value=Lt,(de=$.store)==null||de.updateTableScrollY()};watch(()=>r.value,()=>{re(!0)}),watch(()=>L.value,()=>{re()}),watch(()=>V.value,()=>{re()});const ie=ae=>{r.value=ae,re()},ue=(ae,qe)=>{$.store.assertRowKey();const de=t.rowKey.value,Ne=getRowIdentity(ae,de),ze=Ne&&e.value[Ne];if(Ne&&ze&&"expanded"in ze){const $e=ze.expanded;qe=typeof qe>"u"?!ze.expanded:qe,e.value[Ne].expanded=qe,$e!==qe&&$.emit("expand-change",ae,qe),$.store.updateTableScrollY()}},le=ae=>{$.store.assertRowKey();const qe=t.rowKey.value,de=getRowIdentity(ae,qe),Ne=e.value[de];g.value&&Ne&&"loaded"in Ne&&!Ne.loaded?oe(ae,de,Ne):ue(ae,void 0)},oe=(ae,qe,de)=>{const{load:Ne}=$.props;Ne&&!e.value[qe].loaded&&(e.value[qe].loading=!0,Ne(ae,de,ze=>{if(!Array.isArray(ze))throw new TypeError("[ElTable] data must be an array");e.value[qe].loading=!1,e.value[qe].loaded=!0,e.value[qe].expanded=!0,ze.length&&(y.value[qe]=ze),$.emit("expand-change",ae,!0)}))};return{loadData:oe,loadOrToggle:le,toggleTreeExpansion:ue,updateTreeExpandKeys:ie,updateTreeData:re,normalize:z,states:{expandRowKeys:r,treeData:e,indent:n,lazy:g,lazyTreeNodeMap:y,lazyColumnIdentifier:i,childrenColumnName:k}}}const sortData=(t,r)=>{const e=r.sortingColumn;return!e||typeof e.sortable=="string"?t:orderBy(t,r.sortProp,r.sortOrder,e.sortMethod,e.sortBy)},doFlattenColumns=t=>{const r=[];return t.forEach(e=>{e.children&&e.children.length>0?r.push.apply(r,doFlattenColumns(e.children)):r.push(e)}),r};function useWatcher$1(){var t;const r=getCurrentInstance(),{size:e}=toRefs((t=r.proxy)==null?void 0:t.$props),n=ref(null),g=ref([]),y=ref([]),i=ref(!1),k=ref([]),$=ref([]),L=ref([]),V=ref([]),z=ref([]),re=ref([]),ie=ref([]),ue=ref([]),le=[],oe=ref(0),ae=ref(0),qe=ref(0),de=ref(!1),Ne=ref([]),ze=ref(!1),$e=ref(!1),Lt=ref(null),jt=ref({}),Et=ref(null),ir=ref(null),dr=ref(null),Dt=ref(null),lr=ref(null);watch(g,()=>r.state&&or(!1),{deep:!0});const sr=()=>{if(!n.value)throw new Error("[ElTable] prop row-key is required")},er=xn=>{var An;(An=xn.children)==null||An.forEach(vn=>{vn.fixed=xn.fixed,er(vn)})},cr=()=>{k.value.forEach(Yn=>{er(Yn)}),V.value=k.value.filter(Yn=>Yn.fixed===!0||Yn.fixed==="left"),z.value=k.value.filter(Yn=>Yn.fixed==="right"),V.value.length>0&&k.value[0]&&k.value[0].type==="selection"&&!k.value[0].fixed&&(k.value[0].fixed=!0,V.value.unshift(k.value[0]));const xn=k.value.filter(Yn=>!Yn.fixed);$.value=[].concat(V.value).concat(xn).concat(z.value);const An=doFlattenColumns(xn),vn=doFlattenColumns(V.value),hn=doFlattenColumns(z.value);oe.value=An.length,ae.value=vn.length,qe.value=hn.length,L.value=[].concat(vn).concat(An).concat(hn),i.value=V.value.length>0||z.value.length>0},or=(xn,An=!1)=>{xn&&cr(),An?r.state.doLayout():r.state.debouncedUpdateLayout()},hr=xn=>Ne.value.includes(xn),pr=()=>{de.value=!1,Ne.value.length&&(Ne.value=[],r.emit("selection-change",[]))},Sr=()=>{let xn;if(n.value){xn=[];const An=getKeysMap(Ne.value,n.value),vn=getKeysMap(g.value,n.value);for(const hn in An)hasOwn(An,hn)&&!vn[hn]&&xn.push(An[hn].row)}else xn=Ne.value.filter(An=>!g.value.includes(An));if(xn.length){const An=Ne.value.filter(vn=>!xn.includes(vn));Ne.value=An,r.emit("selection-change",An.slice())}},Er=()=>(Ne.value||[]).slice(),Pr=(xn,An=void 0,vn=!0)=>{if(toggleRowStatus(Ne.value,xn,An)){const Yn=(Ne.value||[]).slice();vn&&r.emit("select",Yn,xn),r.emit("selection-change",Yn)}},Cr=()=>{var xn,An;const vn=$e.value?!de.value:!(de.value||Ne.value.length);de.value=vn;let hn=!1,Yn=0;const Oo=(An=(xn=r==null?void 0:r.store)==null?void 0:xn.states)==null?void 0:An.rowKey.value;g.value.forEach((Vo,Uo)=>{const Io=Uo+Yn;Lt.value?Lt.value.call(null,Vo,Io)&&toggleRowStatus(Ne.value,Vo,vn)&&(hn=!0):toggleRowStatus(Ne.value,Vo,vn)&&(hn=!0),Yn+=Ir(getRowIdentity(Vo,Oo))}),hn&&r.emit("selection-change",Ne.value?Ne.value.slice():[]),r.emit("select-all",Ne.value)},rr=()=>{const xn=getKeysMap(Ne.value,n.value);g.value.forEach(An=>{const vn=getRowIdentity(An,n.value),hn=xn[vn];hn&&(Ne.value[hn.index]=An)})},kr=()=>{var xn,An,vn;if(((xn=g.value)==null?void 0:xn.length)===0){de.value=!1;return}let hn;n.value&&(hn=getKeysMap(Ne.value,n.value));const Yn=function(Io){return hn?!!hn[getRowIdentity(Io,n.value)]:Ne.value.includes(Io)};let Oo=!0,Vo=0,Uo=0;for(let Io=0,ra=(g.value||[]).length;Io<ra;Io++){const Wa=(vn=(An=r==null?void 0:r.store)==null?void 0:An.states)==null?void 0:vn.rowKey.value,Rs=Io+Uo,To=g.value[Io],Qs=Lt.value&&Lt.value.call(null,To,Rs);if(Yn(To))Vo++;else if(!Lt.value||Qs){Oo=!1;break}Uo+=Ir(getRowIdentity(To,Wa))}Vo===0&&(Oo=!1),de.value=Oo},Ir=xn=>{var An;if(!r||!r.store)return 0;const{treeData:vn}=r.store.states;let hn=0;const Yn=(An=vn.value[xn])==null?void 0:An.children;return Yn&&(hn+=Yn.length,Yn.forEach(Oo=>{hn+=Ir(Oo)})),hn},xr=(xn,An)=>{Array.isArray(xn)||(xn=[xn]);const vn={};return xn.forEach(hn=>{jt.value[hn.id]=An,vn[hn.columnKey||hn.id]=An}),vn},vr=(xn,An,vn)=>{ir.value&&ir.value!==xn&&(ir.value.order=null),ir.value=xn,dr.value=An,Dt.value=vn},_r=()=>{let xn=unref(y);Object.keys(jt.value).forEach(An=>{const vn=jt.value[An];if(!vn||vn.length===0)return;const hn=getColumnById({columns:L.value},An);hn&&hn.filterMethod&&(xn=xn.filter(Yn=>vn.some(Oo=>hn.filterMethod.call(null,Oo,Yn,hn))))}),Et.value=xn},Or=()=>{g.value=sortData(Et.value,{sortingColumn:ir.value,sortProp:dr.value,sortOrder:Dt.value})},Mr=(xn=void 0)=>{xn&&xn.filter||_r(),Or()},yr=xn=>{const{tableHeaderRef:An}=r.refs;if(!An)return;const vn=Object.assign({},An.filterPanels),hn=Object.keys(vn);if(hn.length)if(typeof xn=="string"&&(xn=[xn]),Array.isArray(xn)){const Yn=xn.map(Oo=>getColumnByKey({columns:L.value},Oo));hn.forEach(Oo=>{const Vo=Yn.find(Uo=>Uo.id===Oo);Vo&&(Vo.filteredValue=[])}),r.store.commit("filterChange",{column:Yn,values:[],silent:!0,multi:!0})}else hn.forEach(Yn=>{const Oo=L.value.find(Vo=>Vo.id===Yn);Oo&&(Oo.filteredValue=[])}),jt.value={},r.store.commit("filterChange",{column:{},values:[],silent:!0})},mr=()=>{ir.value&&(vr(null,null,null),r.store.commit("changeSortCondition",{silent:!0}))},{setExpandRowKeys:Tr,toggleRowExpansion:Br,updateExpandRows:$r,states:Lr,isRowExpanded:Gr}=useExpand({data:g,rowKey:n}),{updateTreeExpandKeys:qr,toggleTreeExpansion:Yr,updateTreeData:bn,loadOrToggle:wn,states:Xr}=useTree({data:g,rowKey:n}),{updateCurrentRowData:Vn,updateCurrentRow:Zr,setCurrentRowKey:Nn,states:Qr}=useCurrent({data:g,rowKey:n});return{assertRowKey:sr,updateColumns:cr,scheduleLayout:or,isSelected:hr,clearSelection:pr,cleanSelection:Sr,getSelectionRows:Er,toggleRowSelection:Pr,_toggleAllSelection:Cr,toggleAllSelection:null,updateSelectionByRowKey:rr,updateAllSelected:kr,updateFilters:xr,updateCurrentRow:Zr,updateSort:vr,execFilter:_r,execSort:Or,execQuery:Mr,clearFilter:yr,clearSort:mr,toggleRowExpansion:Br,setExpandRowKeysAdapter:xn=>{Tr(xn),qr(xn)},setCurrentRowKey:Nn,toggleRowExpansionAdapter:(xn,An)=>{L.value.some(({type:hn})=>hn==="expand")?Br(xn,An):Yr(xn,An)},isRowExpanded:Gr,updateExpandRows:$r,updateCurrentRowData:Vn,loadOrToggle:wn,updateTreeData:bn,states:{tableSize:e,rowKey:n,data:g,_data:y,isComplex:i,_columns:k,originColumns:$,columns:L,fixedColumns:V,rightFixedColumns:z,leafColumns:re,fixedLeafColumns:ie,rightFixedLeafColumns:ue,updateOrderFns:le,leafColumnsLength:oe,fixedLeafColumnsLength:ae,rightFixedLeafColumnsLength:qe,isAllSelected:de,selection:Ne,reserveSelection:ze,selectOnIndeterminate:$e,selectable:Lt,filters:jt,filteredData:Et,sortingColumn:ir,sortProp:dr,sortOrder:Dt,hoverRow:lr,...Lr,...Xr,...Qr}}}function replaceColumn(t,r){return t.map(e=>{var n;return e.id===r.id?r:((n=e.children)!=null&&n.length&&(e.children=replaceColumn(e.children,r)),e)})}function sortColumn(t){t.forEach(r=>{var e,n;r.no=(e=r.getColumnIndex)==null?void 0:e.call(r),(n=r.children)!=null&&n.length&&sortColumn(r.children)}),t.sort((r,e)=>r.no-e.no)}function useStore(){const t=getCurrentInstance(),r=useWatcher$1();return{ns:useNamespace("table"),...r,mutations:{setData(i,k){const $=unref(i._data)!==k;i.data.value=k,i._data.value=k,t.store.execQuery(),t.store.updateCurrentRowData(),t.store.updateExpandRows(),t.store.updateTreeData(t.store.states.defaultExpandAll.value),unref(i.reserveSelection)?(t.store.assertRowKey(),t.store.updateSelectionByRowKey()):$?t.store.clearSelection():t.store.cleanSelection(),t.store.updateAllSelected(),t.$ready&&t.store.scheduleLayout()},insertColumn(i,k,$,L){const V=unref(i._columns);let z=[];$?($&&!$.children&&($.children=[]),$.children.push(k),z=replaceColumn(V,$)):(V.push(k),z=V),sortColumn(z),i._columns.value=z,i.updateOrderFns.push(L),k.type==="selection"&&(i.selectable.value=k.selectable,i.reserveSelection.value=k.reserveSelection),t.$ready&&(t.store.updateColumns(),t.store.scheduleLayout())},updateColumnOrder(i,k){var $;(($=k.getColumnIndex)==null?void 0:$.call(k))!==k.no&&(sortColumn(i._columns.value),t.$ready&&t.store.updateColumns())},removeColumn(i,k,$,L){const V=unref(i._columns)||[];if($)$.children.splice($.children.findIndex(re=>re.id===k.id),1),nextTick(()=>{var re;((re=$.children)==null?void 0:re.length)===0&&delete $.children}),i._columns.value=replaceColumn(V,$);else{const re=V.indexOf(k);re>-1&&(V.splice(re,1),i._columns.value=V)}const z=i.updateOrderFns.indexOf(L);z>-1&&i.updateOrderFns.splice(z,1),t.$ready&&(t.store.updateColumns(),t.store.scheduleLayout())},sort(i,k){const{prop:$,order:L,init:V}=k;if($){const z=unref(i.columns).find(re=>re.property===$);z&&(z.order=L,t.store.updateSort(z,$,L),t.store.commit("changeSortCondition",{init:V}))}},changeSortCondition(i,k){const{sortingColumn:$,sortProp:L,sortOrder:V}=i,z=unref($),re=unref(L),ie=unref(V);ie===null&&(i.sortingColumn.value=null,i.sortProp.value=null);const ue={filter:!0};t.store.execQuery(ue),(!k||!(k.silent||k.init))&&t.emit("sort-change",{column:z,prop:re,order:ie}),t.store.updateTableScrollY()},filterChange(i,k){const{column:$,values:L,silent:V}=k,z=t.store.updateFilters($,L);t.store.execQuery(),V||t.emit("filter-change",z),t.store.updateTableScrollY()},toggleAllSelection(){t.store.toggleAllSelection()},rowSelectedChanged(i,k){t.store.toggleRowSelection(k),t.store.updateAllSelected()},setHoverRow(i,k){i.hoverRow.value=k},setCurrentRow(i,k){t.store.updateCurrentRow(k)}},commit:function(i,...k){const $=t.store.mutations;if($[i])$[i].apply(t,[t.store.states].concat(k));else throw new Error(`Action not found: ${i}`)},updateTableScrollY:function(){nextTick(()=>t.layout.updateScrollY.apply(t.layout))}}}const InitialStateMap={rowKey:"rowKey",defaultExpandAll:"defaultExpandAll",selectOnIndeterminate:"selectOnIndeterminate",indent:"indent",lazy:"lazy",data:"data","treeProps.hasChildren":{key:"lazyColumnIdentifier",default:"hasChildren"},"treeProps.children":{key:"childrenColumnName",default:"children"}};function createStore(t,r){if(!t)throw new Error("Table is required.");const e=useStore();return e.toggleAllSelection=debounce(e._toggleAllSelection,10),Object.keys(InitialStateMap).forEach(n=>{handleValue(getArrKeysValue(r,n),n,e)}),proxyTableProps(e,r),e}function proxyTableProps(t,r){Object.keys(InitialStateMap).forEach(e=>{watch(()=>getArrKeysValue(r,e),n=>{handleValue(n,e,t)})})}function handleValue(t,r,e){let n=t,g=InitialStateMap[r];typeof InitialStateMap[r]=="object"&&(g=g.key,n=n||InitialStateMap[r].default),e.states[g].value=n}function getArrKeysValue(t,r){if(r.includes(".")){const e=r.split(".");let n=t;return e.forEach(g=>{n=n[g]}),n}else return t[r]}class TableLayout{constructor(r){this.observers=[],this.table=null,this.store=null,this.columns=[],this.fit=!0,this.showHeader=!0,this.height=ref(null),this.scrollX=ref(!1),this.scrollY=ref(!1),this.bodyWidth=ref(null),this.fixedWidth=ref(null),this.rightFixedWidth=ref(null),this.gutterWidth=0;for(const e in r)hasOwn(r,e)&&(isRef(this[e])?this[e].value=r[e]:this[e]=r[e]);if(!this.table)throw new Error("Table is required for Table Layout");if(!this.store)throw new Error("Store is required for Table Layout")}updateScrollY(){if(this.height.value===null)return!1;const e=this.table.refs.scrollBarRef;if(this.table.vnode.el&&(e!=null&&e.wrapRef)){let n=!0;const g=this.scrollY.value;return n=e.wrapRef.scrollHeight>e.wrapRef.clientHeight,this.scrollY.value=n,g!==n}return!1}setHeight(r,e="height"){if(!isClient)return;const n=this.table.vnode.el;if(r=parseHeight(r),this.height.value=Number(r),!n&&(r||r===0))return nextTick(()=>this.setHeight(r,e));typeof r=="number"?(n.style[e]=`${r}px`,this.updateElsHeight()):typeof r=="string"&&(n.style[e]=r,this.updateElsHeight())}setMaxHeight(r){this.setHeight(r,"max-height")}getFlattenColumns(){const r=[];return this.table.store.states.columns.value.forEach(n=>{n.isColumnGroup?r.push.apply(r,n.columns):r.push(n)}),r}updateElsHeight(){this.updateScrollY(),this.notifyObservers("scrollable")}headerDisplayNone(r){if(!r)return!0;let e=r;for(;e.tagName!=="DIV";){if(getComputedStyle(e).display==="none")return!0;e=e.parentElement}return!1}updateColumnsWidth(){if(!isClient)return;const r=this.fit,e=this.table.vnode.el.clientWidth;let n=0;const g=this.getFlattenColumns(),y=g.filter($=>typeof $.width!="number");if(g.forEach($=>{typeof $.width=="number"&&$.realWidth&&($.realWidth=null)}),y.length>0&&r){if(g.forEach($=>{n+=Number($.width||$.minWidth||80)}),n<=e){this.scrollX.value=!1;const $=e-n;if(y.length===1)y[0].realWidth=Number(y[0].minWidth||80)+$;else{const L=y.reduce((re,ie)=>re+Number(ie.minWidth||80),0),V=$/L;let z=0;y.forEach((re,ie)=>{if(ie===0)return;const ue=Math.floor(Number(re.minWidth||80)*V);z+=ue,re.realWidth=Number(re.minWidth||80)+ue}),y[0].realWidth=Number(y[0].minWidth||80)+$-z}}else this.scrollX.value=!0,y.forEach($=>{$.realWidth=Number($.minWidth)});this.bodyWidth.value=Math.max(n,e),this.table.state.resizeState.value.width=this.bodyWidth.value}else g.forEach($=>{!$.width&&!$.minWidth?$.realWidth=80:$.realWidth=Number($.width||$.minWidth),n+=$.realWidth}),this.scrollX.value=n>e,this.bodyWidth.value=n;const i=this.store.states.fixedColumns.value;if(i.length>0){let $=0;i.forEach(L=>{$+=Number(L.realWidth||L.width)}),this.fixedWidth.value=$}const k=this.store.states.rightFixedColumns.value;if(k.length>0){let $=0;k.forEach(L=>{$+=Number(L.realWidth||L.width)}),this.rightFixedWidth.value=$}this.notifyObservers("columns")}addObserver(r){this.observers.push(r)}removeObserver(r){const e=this.observers.indexOf(r);e!==-1&&this.observers.splice(e,1)}notifyObservers(r){this.observers.forEach(n=>{var g,y;switch(r){case"columns":(g=n.state)==null||g.onColumnsChange(this);break;case"scrollable":(y=n.state)==null||y.onScrollableChange(this);break;default:throw new Error(`Table Layout don't have event ${r}.`)}})}}const{CheckboxGroup:ElCheckboxGroup}=ElCheckbox,_sfc_main$m=defineComponent({name:"ElTableFilterPanel",components:{ElCheckbox,ElCheckboxGroup,ElScrollbar,ElTooltip,ElIcon,ArrowDown:arrow_down_default,ArrowUp:arrow_up_default},directives:{ClickOutside},props:{placement:{type:String,default:"bottom-start"},store:{type:Object},column:{type:Object},upDataColumn:{type:Function}},setup(t){const r=getCurrentInstance(),{t:e}=useLocale(),n=useNamespace("table-filter"),g=r==null?void 0:r.parent;g.filterPanels.value[t.column.id]||(g.filterPanels.value[t.column.id]=r);const y=ref(!1),i=ref(null),k=computed(()=>t.column&&t.column.filters),$=computed(()=>t.column.filterClassName?`${n.b()} ${t.column.filterClassName}`:n.b()),L=computed({get:()=>{var ze;return(((ze=t.column)==null?void 0:ze.filteredValue)||[])[0]},set:ze=>{V.value&&(typeof ze<"u"&&ze!==null?V.value.splice(0,1,ze):V.value.splice(0,1))}}),V=computed({get(){return t.column?t.column.filteredValue||[]:[]},set(ze){t.column&&t.upDataColumn("filteredValue",ze)}}),z=computed(()=>t.column?t.column.filterMultiple:!0),re=ze=>ze.value===L.value,ie=()=>{y.value=!1},ue=ze=>{ze.stopPropagation(),y.value=!y.value},le=()=>{y.value=!1},oe=()=>{de(V.value),ie()},ae=()=>{V.value=[],de(V.value),ie()},qe=ze=>{L.value=ze,de(typeof ze<"u"&&ze!==null?V.value:[]),ie()},de=ze=>{t.store.commit("filterChange",{column:t.column,values:ze}),t.store.updateAllSelected()};watch(y,ze=>{t.column&&t.upDataColumn("filterOpened",ze)},{immediate:!0});const Ne=computed(()=>{var ze,$e;return($e=(ze=i.value)==null?void 0:ze.popperRef)==null?void 0:$e.contentRef});return{tooltipVisible:y,multiple:z,filterClassName:$,filteredValue:V,filterValue:L,filters:k,handleConfirm:oe,handleReset:ae,handleSelect:qe,isActive:re,t:e,ns:n,showFilterPanel:ue,hideFilterPanel:le,popperPaneRef:Ne,tooltip:i}}}),_hoisted_1$g={key:0},_hoisted_2$a=["disabled"],_hoisted_3$7=["label","onClick"];function _sfc_render$2(t,r,e,n,g,y){const i=resolveComponent("el-checkbox"),k=resolveComponent("el-checkbox-group"),$=resolveComponent("el-scrollbar"),L=resolveComponent("arrow-up"),V=resolveComponent("arrow-down"),z=resolveComponent("el-icon"),re=resolveComponent("el-tooltip"),ie=resolveDirective("click-outside");return openBlock(),createBlock(re,{ref:"tooltip",visible:t.tooltipVisible,offset:0,placement:t.placement,"show-arrow":!1,"stop-popper-mouse-event":!1,teleported:"",effect:"light",pure:"","popper-class":t.filterClassName,persistent:""},{content:withCtx(()=>[t.multiple?(openBlock(),createElementBlock("div",_hoisted_1$g,[createBaseVNode("div",{class:normalizeClass(t.ns.e("content"))},[createVNode($,{"wrap-class":t.ns.e("wrap")},{default:withCtx(()=>[createVNode(k,{modelValue:t.filteredValue,"onUpdate:modelValue":r[0]||(r[0]=ue=>t.filteredValue=ue),class:normalizeClass(t.ns.e("checkbox-group"))},{default:withCtx(()=>[(openBlock(!0),createElementBlock(Fragment,null,renderList(t.filters,ue=>(openBlock(),createBlock(i,{key:ue.value,label:ue.value},{default:withCtx(()=>[createTextVNode(toDisplayString(ue.text),1)]),_:2},1032,["label"]))),128))]),_:1},8,["modelValue","class"])]),_:1},8,["wrap-class"])],2),createBaseVNode("div",{class:normalizeClass(t.ns.e("bottom"))},[createBaseVNode("button",{class:normalizeClass({[t.ns.is("disabled")]:t.filteredValue.length===0}),disabled:t.filteredValue.length===0,type:"button",onClick:r[1]||(r[1]=(...ue)=>t.handleConfirm&&t.handleConfirm(...ue))},toDisplayString(t.t("el.table.confirmFilter")),11,_hoisted_2$a),createBaseVNode("button",{type:"button",onClick:r[2]||(r[2]=(...ue)=>t.handleReset&&t.handleReset(...ue))},toDisplayString(t.t("el.table.resetFilter")),1)],2)])):(openBlock(),createElementBlock("ul",{key:1,class:normalizeClass(t.ns.e("list"))},[createBaseVNode("li",{class:normalizeClass([t.ns.e("list-item"),{[t.ns.is("active")]:t.filterValue===void 0||t.filterValue===null}]),onClick:r[3]||(r[3]=ue=>t.handleSelect(null))},toDisplayString(t.t("el.table.clearFilter")),3),(openBlock(!0),createElementBlock(Fragment,null,renderList(t.filters,ue=>(openBlock(),createElementBlock("li",{key:ue.value,class:normalizeClass([t.ns.e("list-item"),t.ns.is("active",t.isActive(ue))]),label:ue.value,onClick:le=>t.handleSelect(ue.value)},toDisplayString(ue.text),11,_hoisted_3$7))),128))],2))]),default:withCtx(()=>[withDirectives((openBlock(),createElementBlock("span",{class:normalizeClass([`${t.ns.namespace.value}-table__column-filter-trigger`,`${t.ns.namespace.value}-none-outline`]),onClick:r[4]||(r[4]=(...ue)=>t.showFilterPanel&&t.showFilterPanel(...ue))},[createVNode(z,null,{default:withCtx(()=>[t.column.filterOpened?(openBlock(),createBlock(L,{key:0})):(openBlock(),createBlock(V,{key:1}))]),_:1})],2)),[[ie,t.hideFilterPanel,t.popperPaneRef]])]),_:1},8,["visible","placement","popper-class"])}var FilterPanel=_export_sfc$1(_sfc_main$m,[["render",_sfc_render$2],["__file","filter-panel.vue"]]);function useLayoutObserver(t){const r=getCurrentInstance();onBeforeMount(()=>{e.value.addObserver(r)}),onMounted(()=>{n(e.value),g(e.value)}),onUpdated(()=>{n(e.value),g(e.value)}),onUnmounted(()=>{e.value.removeObserver(r)});const e=computed(()=>{const y=t.layout;if(!y)throw new Error("Can not find table layout.");return y}),n=y=>{var i;const k=((i=t.vnode.el)==null?void 0:i.querySelectorAll("colgroup > col"))||[];if(!k.length)return;const $=y.getFlattenColumns(),L={};$.forEach(V=>{L[V.id]=V});for(let V=0,z=k.length;V<z;V++){const re=k[V],ie=re.getAttribute("name"),ue=L[ie];ue&&re.setAttribute("width",ue.realWidth||ue.width)}},g=y=>{var i,k;const $=((i=t.vnode.el)==null?void 0:i.querySelectorAll("colgroup > col[name=gutter]"))||[];for(let V=0,z=$.length;V<z;V++)$[V].setAttribute("width",y.scrollY.value?y.gutterWidth:"0");const L=((k=t.vnode.el)==null?void 0:k.querySelectorAll("th.gutter"))||[];for(let V=0,z=L.length;V<z;V++){const re=L[V];re.style.width=y.scrollY.value?`${y.gutterWidth}px`:"0",re.style.display=y.scrollY.value?"":"none"}};return{tableLayout:e.value,onColumnsChange:n,onScrollableChange:g}}const TABLE_INJECTION_KEY=Symbol("ElTable");function useEvent(t,r){const e=getCurrentInstance(),n=inject(TABLE_INJECTION_KEY),g=le=>{le.stopPropagation()},y=(le,oe)=>{!oe.filters&&oe.sortable?ue(le,oe,!1):oe.filterable&&!oe.sortable&&g(le),n==null||n.emit("header-click",oe,le)},i=(le,oe)=>{n==null||n.emit("header-contextmenu",oe,le)},k=ref(null),$=ref(!1),L=ref({}),V=(le,oe)=>{if(isClient&&!(oe.children&&oe.children.length>0)&&k.value&&t.border){$.value=!0;const ae=n;r("set-drag-visible",!0);const de=(ae==null?void 0:ae.vnode.el).getBoundingClientRect().left,Ne=e.vnode.el.querySelector(`th.${oe.id}`),ze=Ne.getBoundingClientRect(),$e=ze.left-de+30;addClass(Ne,"noclick"),L.value={startMouseLeft:le.clientX,startLeft:ze.right-de,startColumnLeft:ze.left-de,tableLeft:de};const Lt=ae==null?void 0:ae.refs.resizeProxy;Lt.style.left=`${L.value.startLeft}px`,document.onselectstart=function(){return!1},document.ondragstart=function(){return!1};const jt=ir=>{const dr=ir.clientX-L.value.startMouseLeft,Dt=L.value.startLeft+dr;Lt.style.left=`${Math.max($e,Dt)}px`},Et=()=>{if($.value){const{startColumnLeft:ir,startLeft:dr}=L.value,lr=Number.parseInt(Lt.style.left,10)-ir;oe.width=oe.realWidth=lr,ae==null||ae.emit("header-dragend",oe.width,dr-ir,oe,le),requestAnimationFrame(()=>{t.store.scheduleLayout(!1,!0)}),document.body.style.cursor="",$.value=!1,k.value=null,L.value={},r("set-drag-visible",!1)}document.removeEventListener("mousemove",jt),document.removeEventListener("mouseup",Et),document.onselectstart=null,document.ondragstart=null,setTimeout(()=>{removeClass(Ne,"noclick")},0)};document.addEventListener("mousemove",jt),document.addEventListener("mouseup",Et)}},z=(le,oe)=>{if(oe.children&&oe.children.length>0)return;const ae=le.target;if(!isElement(ae))return;const qe=ae==null?void 0:ae.closest("th");if(!(!oe||!oe.resizable)&&!$.value&&t.border){const de=qe.getBoundingClientRect(),Ne=document.body.style;de.width>12&&de.right-le.pageX<8?(Ne.cursor="col-resize",hasClass(qe,"is-sortable")&&(qe.style.cursor="col-resize"),k.value=oe):$.value||(Ne.cursor="",hasClass(qe,"is-sortable")&&(qe.style.cursor="pointer"),k.value=null)}},re=()=>{isClient&&(document.body.style.cursor="")},ie=({order:le,sortOrders:oe})=>{if(le==="")return oe[0];const ae=oe.indexOf(le||null);return oe[ae>oe.length-2?0:ae+1]},ue=(le,oe,ae)=>{var qe;le.stopPropagation();const de=oe.order===ae?null:ae||ie(oe),Ne=(qe=le.target)==null?void 0:qe.closest("th");if(Ne&&hasClass(Ne,"noclick")){removeClass(Ne,"noclick");return}if(!oe.sortable)return;const ze=t.store.states;let $e=ze.sortProp.value,Lt;const jt=ze.sortingColumn.value;(jt!==oe||jt===oe&&jt.order===null)&&(jt&&(jt.order=null),ze.sortingColumn.value=oe,$e=oe.property),de?Lt=oe.order=de:Lt=oe.order=null,ze.sortProp.value=$e,ze.sortOrder.value=Lt,n==null||n.store.commit("changeSortCondition")};return{handleHeaderClick:y,handleHeaderContextMenu:i,handleMouseDown:V,handleMouseMove:z,handleMouseOut:re,handleSortClick:ue,handleFilterClick:g}}function useStyle$2(t){const r=inject(TABLE_INJECTION_KEY),e=useNamespace("table");return{getHeaderRowStyle:k=>{const $=r==null?void 0:r.props.headerRowStyle;return typeof $=="function"?$.call(null,{rowIndex:k}):$},getHeaderRowClass:k=>{const $=[],L=r==null?void 0:r.props.headerRowClassName;return typeof L=="string"?$.push(L):typeof L=="function"&&$.push(L.call(null,{rowIndex:k})),$.join(" ")},getHeaderCellStyle:(k,$,L,V)=>{var z;let re=(z=r==null?void 0:r.props.headerCellStyle)!=null?z:{};typeof re=="function"&&(re=re.call(null,{rowIndex:k,columnIndex:$,row:L,column:V}));const ie=getFixedColumnOffset($,V.fixed,t.store,L);return ensurePosition(ie,"left"),ensurePosition(ie,"right"),Object.assign({},re,ie)},getHeaderCellClass:(k,$,L,V)=>{const z=getFixedColumnsClass(e.b(),$,V.fixed,t.store,L),re=[V.id,V.order,V.headerAlign,V.className,V.labelClassName,...z];V.children||re.push("is-leaf"),V.sortable&&re.push("is-sortable");const ie=r==null?void 0:r.props.headerCellClassName;return typeof ie=="string"?re.push(ie):typeof ie=="function"&&re.push(ie.call(null,{rowIndex:k,columnIndex:$,row:L,column:V})),re.push(e.e("cell")),re.filter(ue=>!!ue).join(" ")}}}const getAllColumns=t=>{const r=[];return t.forEach(e=>{e.children?(r.push(e),r.push.apply(r,getAllColumns(e.children))):r.push(e)}),r},convertToRows=t=>{let r=1;const e=(y,i)=>{if(i&&(y.level=i.level+1,r<y.level&&(r=y.level)),y.children){let k=0;y.children.forEach($=>{e($,y),k+=$.colSpan}),y.colSpan=k}else y.colSpan=1};t.forEach(y=>{y.level=1,e(y,void 0)});const n=[];for(let y=0;y<r;y++)n.push([]);return getAllColumns(t).forEach(y=>{y.children?(y.rowSpan=1,y.children.forEach(i=>i.isSubColumn=!0)):y.rowSpan=r-y.level+1,n[y.level-1].push(y)}),n};function useUtils$1(t){const r=inject(TABLE_INJECTION_KEY),e=computed(()=>convertToRows(t.store.states.originColumns.value));return{isGroup:computed(()=>{const y=e.value.length>1;return y&&r&&(r.state.isGroup.value=!0),y}),toggleAllSelection:y=>{y.stopPropagation(),r==null||r.store.commit("toggleAllSelection")},columnRows:e}}var TableHeader=defineComponent({name:"ElTableHeader",components:{ElCheckbox},props:{fixed:{type:String,default:""},store:{required:!0,type:Object},border:Boolean,defaultSort:{type:Object,default:()=>({prop:"",order:""})}},setup(t,{emit:r}){const e=getCurrentInstance(),n=inject(TABLE_INJECTION_KEY),g=useNamespace("table"),y=ref({}),{onColumnsChange:i,onScrollableChange:k}=useLayoutObserver(n);onMounted(async()=>{await nextTick(),await nextTick();const{prop:$e,order:Lt}=t.defaultSort;n==null||n.store.commit("sort",{prop:$e,order:Lt,init:!0})});const{handleHeaderClick:$,handleHeaderContextMenu:L,handleMouseDown:V,handleMouseMove:z,handleMouseOut:re,handleSortClick:ie,handleFilterClick:ue}=useEvent(t,r),{getHeaderRowStyle:le,getHeaderRowClass:oe,getHeaderCellStyle:ae,getHeaderCellClass:qe}=useStyle$2(t),{isGroup:de,toggleAllSelection:Ne,columnRows:ze}=useUtils$1(t);return e.state={onColumnsChange:i,onScrollableChange:k},e.filterPanels=y,{ns:g,filterPanels:y,onColumnsChange:i,onScrollableChange:k,columnRows:ze,getHeaderRowClass:oe,getHeaderRowStyle:le,getHeaderCellClass:qe,getHeaderCellStyle:ae,handleHeaderClick:$,handleHeaderContextMenu:L,handleMouseDown:V,handleMouseMove:z,handleMouseOut:re,handleSortClick:ie,handleFilterClick:ue,isGroup:de,toggleAllSelection:Ne}},render(){const{ns:t,isGroup:r,columnRows:e,getHeaderCellStyle:n,getHeaderCellClass:g,getHeaderRowClass:y,getHeaderRowStyle:i,handleHeaderClick:k,handleHeaderContextMenu:$,handleMouseDown:L,handleMouseMove:V,handleSortClick:z,handleMouseOut:re,store:ie,$parent:ue}=this;let le=1;return h$1("thead",{class:{[t.is("group")]:r}},e.map((oe,ae)=>h$1("tr",{class:y(ae),key:ae,style:i(ae)},oe.map((qe,de)=>(qe.rowSpan>le&&(le=qe.rowSpan),h$1("th",{class:g(ae,de,oe,qe),colspan:qe.colSpan,key:`${qe.id}-thead`,rowspan:qe.rowSpan,style:n(ae,de,oe,qe),onClick:Ne=>k(Ne,qe),onContextmenu:Ne=>$(Ne,qe),onMousedown:Ne=>L(Ne,qe),onMousemove:Ne=>V(Ne,qe),onMouseout:re},[h$1("div",{class:["cell",qe.filteredValue&&qe.filteredValue.length>0?"highlight":""]},[qe.renderHeader?qe.renderHeader({column:qe,$index:de,store:ie,_self:ue}):qe.label,qe.sortable&&h$1("span",{onClick:Ne=>z(Ne,qe),class:"caret-wrapper"},[h$1("i",{onClick:Ne=>z(Ne,qe,"ascending"),class:"sort-caret ascending"}),h$1("i",{onClick:Ne=>z(Ne,qe,"descending"),class:"sort-caret descending"})]),qe.filterable&&h$1(FilterPanel,{store:ie,placement:qe.filterPlacement||"bottom-start",column:qe,upDataColumn:(Ne,ze)=>{qe[Ne]=ze}})])]))))))}});function useEvents(t){const r=inject(TABLE_INJECTION_KEY),e=ref(""),n=ref(h$1("div")),g=(ue,le,oe)=>{var ae;const qe=r,de=getCell(ue);let Ne;const ze=(ae=qe==null?void 0:qe.vnode.el)==null?void 0:ae.dataset.prefix;de&&(Ne=getColumnByCell({columns:t.store.states.columns.value},de,ze),Ne&&(qe==null||qe.emit(`cell-${oe}`,le,Ne,de,ue))),qe==null||qe.emit(`row-${oe}`,le,Ne,ue)},y=(ue,le)=>{g(ue,le,"dblclick")},i=(ue,le)=>{t.store.commit("setCurrentRow",le),g(ue,le,"click")},k=(ue,le)=>{g(ue,le,"contextmenu")},$=debounce(ue=>{t.store.commit("setHoverRow",ue)},30),L=debounce(()=>{t.store.commit("setHoverRow",null)},30),V=ue=>{const le=window.getComputedStyle(ue,null),oe=Number.parseInt(le.paddingLeft,10)||0,ae=Number.parseInt(le.paddingRight,10)||0,qe=Number.parseInt(le.paddingTop,10)||0,de=Number.parseInt(le.paddingBottom,10)||0;return{left:oe,right:ae,top:qe,bottom:de}},z=(ue,le,oe)=>{let ae=le.target.parentNode;for(;ue>1&&(ae=ae==null?void 0:ae.nextSibling,!(!ae||ae.nodeName!=="TR"));)oe(ae,"hover-row hover-fixed-row"),ue--};return{handleDoubleClick:y,handleClick:i,handleContextMenu:k,handleMouseEnter:$,handleMouseLeave:L,handleCellMouseEnter:(ue,le,oe)=>{var ae;const qe=r,de=getCell(ue),Ne=(ae=qe==null?void 0:qe.vnode.el)==null?void 0:ae.dataset.prefix;if(de){const or=getColumnByCell({columns:t.store.states.columns.value},de,Ne);de.rowSpan>1&&z(de.rowSpan,ue,addClass);const hr=qe.hoverState={cell:de,column:or,row:le};qe==null||qe.emit("cell-mouse-enter",hr.row,hr.column,hr.cell,ue)}if(!oe)return;const ze=ue.target.querySelector(".cell");if(!(hasClass(ze,`${Ne}-tooltip`)&&ze.childNodes.length))return;const $e=document.createRange();$e.setStart(ze,0),$e.setEnd(ze,ze.childNodes.length);let Lt=$e.getBoundingClientRect().width,jt=$e.getBoundingClientRect().height;Lt-Math.floor(Lt)<.001&&(Lt=Math.floor(Lt)),jt-Math.floor(jt)<.001&&(jt=Math.floor(jt));const{top:dr,left:Dt,right:lr,bottom:sr}=V(ze),er=Dt+lr,cr=dr+sr;(Lt+er>ze.offsetWidth||jt+cr>ze.offsetHeight||ze.scrollWidth>ze.offsetWidth)&&createTablePopper(oe,de.innerText||de.textContent,de,qe)},handleCellMouseLeave:ue=>{const le=getCell(ue);if(!le)return;le.rowSpan>1&&z(le.rowSpan,ue,removeClass);const oe=r==null?void 0:r.hoverState;r==null||r.emit("cell-mouse-leave",oe==null?void 0:oe.row,oe==null?void 0:oe.column,oe==null?void 0:oe.cell,ue)},tooltipContent:e,tooltipTrigger:n}}function useStyles(t){const r=inject(TABLE_INJECTION_KEY),e=useNamespace("table");return{getRowStyle:(L,V)=>{const z=r==null?void 0:r.props.rowStyle;return typeof z=="function"?z.call(null,{row:L,rowIndex:V}):z||null},getRowClass:(L,V)=>{const z=[e.e("row")];r!=null&&r.props.highlightCurrentRow&&L===t.store.states.currentRow.value&&z.push("current-row"),t.stripe&&V%2===1&&z.push(e.em("row","striped"));const re=r==null?void 0:r.props.rowClassName;return typeof re=="string"?z.push(re):typeof re=="function"&&z.push(re.call(null,{row:L,rowIndex:V})),z},getCellStyle:(L,V,z,re)=>{const ie=r==null?void 0:r.props.cellStyle;let ue=ie??{};typeof ie=="function"&&(ue=ie.call(null,{rowIndex:L,columnIndex:V,row:z,column:re}));const le=getFixedColumnOffset(V,t==null?void 0:t.fixed,t.store);return ensurePosition(le,"left"),ensurePosition(le,"right"),Object.assign({},ue,le)},getCellClass:(L,V,z,re,ie)=>{const ue=getFixedColumnsClass(e.b(),V,t==null?void 0:t.fixed,t.store,void 0,ie),le=[re.id,re.align,re.className,...ue],oe=r==null?void 0:r.props.cellClassName;return typeof oe=="string"?le.push(oe):typeof oe=="function"&&le.push(oe.call(null,{rowIndex:L,columnIndex:V,row:z,column:re})),le.push(e.e("cell")),le.filter(ae=>!!ae).join(" ")},getSpan:(L,V,z,re)=>{let ie=1,ue=1;const le=r==null?void 0:r.props.spanMethod;if(typeof le=="function"){const oe=le({row:L,column:V,rowIndex:z,columnIndex:re});Array.isArray(oe)?(ie=oe[0],ue=oe[1]):typeof oe=="object"&&(ie=oe.rowspan,ue=oe.colspan)}return{rowspan:ie,colspan:ue}},getColspanRealWidth:(L,V,z)=>{if(V<1)return L[z].realWidth;const re=L.map(({realWidth:ie,width:ue})=>ie||ue).slice(z,z+V);return Number(re.reduce((ie,ue)=>Number(ie)+Number(ue),-1))}}}function useRender$1(t){const r=inject(TABLE_INJECTION_KEY),e=useNamespace("table"),{handleDoubleClick:n,handleClick:g,handleContextMenu:y,handleMouseEnter:i,handleMouseLeave:k,handleCellMouseEnter:$,handleCellMouseLeave:L,tooltipContent:V,tooltipTrigger:z}=useEvents(t),{getRowStyle:re,getRowClass:ie,getCellStyle:ue,getCellClass:le,getSpan:oe,getColspanRealWidth:ae}=useStyles(t),qe=computed(()=>t.store.states.columns.value.findIndex(({type:Lt})=>Lt==="default")),de=(Lt,jt)=>{const Et=r.props.rowKey;return Et?getRowIdentity(Lt,Et):jt},Ne=(Lt,jt,Et,ir=!1)=>{const{tooltipEffect:dr,tooltipOptions:Dt,store:lr}=t,{indent:sr,columns:er}=lr.states,cr=ie(Lt,jt);let or=!0;return Et&&(cr.push(e.em("row",`level-${Et.level}`)),or=Et.display),h$1("tr",{style:[or?null:{display:"none"},re(Lt,jt)],class:cr,key:de(Lt,jt),onDblclick:pr=>n(pr,Lt),onClick:pr=>g(pr,Lt),onContextmenu:pr=>y(pr,Lt),onMouseenter:()=>i(jt),onMouseleave:k},er.value.map((pr,Sr)=>{const{rowspan:Er,colspan:Pr}=oe(Lt,pr,jt,Sr);if(!Er||!Pr)return null;const Cr=Object.assign({},pr);Cr.realWidth=ae(er.value,Pr,Sr);const rr={store:t.store,_self:t.context||r,column:Cr,row:Lt,$index:jt,cellIndex:Sr,expanded:ir};Sr===qe.value&&Et&&(rr.treeNode={indent:Et.level*sr.value,level:Et.level},typeof Et.expanded=="boolean"&&(rr.treeNode.expanded=Et.expanded,"loading"in Et&&(rr.treeNode.loading=Et.loading),"noLazyChildren"in Et&&(rr.treeNode.noLazyChildren=Et.noLazyChildren)));const kr=`${jt},${Sr}`,Ir=Cr.columnKey||Cr.rawColumnKey||"",xr=ze(Sr,pr,rr),vr=pr.showOverflowTooltip&&merge$2({effect:dr},Dt,pr.showOverflowTooltip);return h$1("td",{style:ue(jt,Sr,Lt,pr),class:le(jt,Sr,Lt,pr,Pr-1),key:`${Ir}${kr}`,rowspan:Er,colspan:Pr,onMouseenter:_r=>$(_r,Lt,vr),onMouseleave:L},[xr])}))},ze=(Lt,jt,Et)=>jt.renderCell(Et);return{wrappedRowRender:(Lt,jt)=>{const Et=t.store,{isRowExpanded:ir,assertRowKey:dr}=Et,{treeData:Dt,lazyTreeNodeMap:lr,childrenColumnName:sr,rowKey:er}=Et.states,cr=Et.states.columns.value;if(cr.some(({type:hr})=>hr==="expand")){const hr=ir(Lt),pr=Ne(Lt,jt,void 0,hr),Sr=r.renderExpanded;return hr?Sr?[[pr,h$1("tr",{key:`expanded-row__${pr.key}`},[h$1("td",{colspan:cr.length,class:`${e.e("cell")} ${e.e("expanded-cell")}`},[Sr({row:Lt,$index:jt,store:Et,expanded:hr})])])]]:(console.error("[Element Error]renderExpanded is required."),pr):[[pr]]}else if(Object.keys(Dt.value).length){dr();const hr=getRowIdentity(Lt,er.value);let pr=Dt.value[hr],Sr=null;pr&&(Sr={expanded:pr.expanded,level:pr.level,display:!0},typeof pr.lazy=="boolean"&&(typeof pr.loaded=="boolean"&&pr.loaded&&(Sr.noLazyChildren=!(pr.children&&pr.children.length)),Sr.loading=pr.loading));const Er=[Ne(Lt,jt,Sr)];if(pr){let Pr=0;const Cr=(kr,Ir)=>{kr&&kr.length&&Ir&&kr.forEach(xr=>{const vr={display:Ir.display&&Ir.expanded,level:Ir.level+1,expanded:!1,noLazyChildren:!1,loading:!1},_r=getRowIdentity(xr,er.value);if(_r==null)throw new Error("For nested data item, row-key is required.");if(pr={...Dt.value[_r]},pr&&(vr.expanded=pr.expanded,pr.level=pr.level||vr.level,pr.display=!!(pr.expanded&&vr.display),typeof pr.lazy=="boolean"&&(typeof pr.loaded=="boolean"&&pr.loaded&&(vr.noLazyChildren=!(pr.children&&pr.children.length)),vr.loading=pr.loading)),Pr++,Er.push(Ne(xr,jt+Pr,vr)),pr){const Or=lr.value[_r]||xr[sr.value];Cr(Or,pr)}})};pr.display=!0;const rr=lr.value[hr]||Lt[sr.value];Cr(rr,pr)}return Er}else return Ne(Lt,jt,void 0)},tooltipContent:V,tooltipTrigger:z}}const defaultProps$2={store:{required:!0,type:Object},stripe:Boolean,tooltipEffect:String,tooltipOptions:{type:Object},context:{default:()=>({}),type:Object},rowClassName:[String,Function],rowStyle:[Object,Function],fixed:{type:String,default:""},highlight:Boolean};var TableBody=defineComponent({name:"ElTableBody",props:defaultProps$2,setup(t){const r=getCurrentInstance(),e=inject(TABLE_INJECTION_KEY),n=useNamespace("table"),{wrappedRowRender:g,tooltipContent:y,tooltipTrigger:i}=useRender$1(t),{onColumnsChange:k,onScrollableChange:$}=useLayoutObserver(e),L=[];return watch(t.store.states.hoverRow,(V,z)=>{var re;const ie=r==null?void 0:r.vnode.el,ue=Array.from((ie==null?void 0:ie.children)||[]).filter(ae=>ae==null?void 0:ae.classList.contains(`${n.e("row")}`));let le=V;const oe=(re=ue[le])==null?void 0:re.childNodes;oe!=null&&oe.length?Array.from(oe).reduce((qe,de,Ne)=>{var ze,$e;const Lt=((ze=oe[Ne-1])==null?void 0:ze.colSpan)>1,jt=(($e=oe[Ne+1])==null?void 0:$e.colSpan)>1;return de.nodeName!=="TD"&&!Lt&&!jt&&qe.push(Ne),qe},[]).forEach(qe=>{for(var de;le>0;){const Ne=(de=ue[le-1])==null?void 0:de.childNodes;if(Ne[qe]&&Ne[qe].nodeName==="TD"){addClass(Ne[qe],"hover-cell"),L.push(Ne[qe]);break}le--}}):(L.forEach(ae=>removeClass(ae,"hover-cell")),L.length=0),!(!t.store.states.isComplex.value||!isClient)&&rAF(()=>{const ae=ue[z],qe=ue[V];ae&&!ae.classList.contains("hover-fixed-row")&&removeClass(ae,"hover-row"),qe&&addClass(qe,"hover-row")})}),onUnmounted(()=>{var V;(V=removePopper)==null||V()}),{ns:n,onColumnsChange:k,onScrollableChange:$,wrappedRowRender:g,tooltipContent:y,tooltipTrigger:i}},render(){const{wrappedRowRender:t,store:r}=this,e=r.states.data.value||[];return h$1("tbody",{tabIndex:-1},[e.reduce((n,g)=>n.concat(t(g,n.length)),[])])}});function useMapState(){const t=inject(TABLE_INJECTION_KEY),r=t==null?void 0:t.store,e=computed(()=>r.states.fixedLeafColumnsLength.value),n=computed(()=>r.states.rightFixedColumns.value.length),g=computed(()=>r.states.columns.value.length),y=computed(()=>r.states.fixedColumns.value.length),i=computed(()=>r.states.rightFixedColumns.value.length);return{leftFixedLeafCount:e,rightFixedLeafCount:n,columnsCount:g,leftFixedCount:y,rightFixedCount:i,columns:r.states.columns}}function useStyle$1(t){const{columns:r}=useMapState(),e=useNamespace("table");return{getCellClasses:(y,i)=>{const k=y[i],$=[e.e("cell"),k.id,k.align,k.labelClassName,...getFixedColumnsClass(e.b(),i,k.fixed,t.store)];return k.className&&$.push(k.className),k.children||$.push(e.is("leaf")),$},getCellStyles:(y,i)=>{const k=getFixedColumnOffset(i,y.fixed,t.store);return ensurePosition(k,"left"),ensurePosition(k,"right"),k},columns:r}}var TableFooter=defineComponent({name:"ElTableFooter",props:{fixed:{type:String,default:""},store:{required:!0,type:Object},summaryMethod:Function,sumText:String,border:Boolean,defaultSort:{type:Object,default:()=>({prop:"",order:""})}},setup(t){const{getCellClasses:r,getCellStyles:e,columns:n}=useStyle$1(t);return{ns:useNamespace("table"),getCellClasses:r,getCellStyles:e,columns:n}},render(){const{columns:t,getCellStyles:r,getCellClasses:e,summaryMethod:n,sumText:g}=this,y=this.store.states.data.value;let i=[];return n?i=n({columns:t,data:y}):t.forEach((k,$)=>{if($===0){i[$]=g;return}const L=y.map(ie=>Number(ie[k.property])),V=[];let z=!0;L.forEach(ie=>{if(!Number.isNaN(+ie)){z=!1;const ue=`${ie}`.split(".")[1];V.push(ue?ue.length:0)}});const re=Math.max.apply(null,V);z?i[$]="":i[$]=L.reduce((ie,ue)=>{const le=Number(ue);return Number.isNaN(+le)?ie:Number.parseFloat((ie+ue).toFixed(Math.min(re,20)))},0)}),h$1(h$1("tfoot",[h$1("tr",{},[...t.map((k,$)=>h$1("td",{key:$,colspan:k.colSpan,rowspan:k.rowSpan,class:e(t,$),style:r(k,$)},[h$1("div",{class:["cell",k.labelClassName]},[i[$]])]))])]))}});function useUtils(t){return{setCurrentRow:V=>{t.commit("setCurrentRow",V)},getSelectionRows:()=>t.getSelectionRows(),toggleRowSelection:(V,z)=>{t.toggleRowSelection(V,z,!1),t.updateAllSelected()},clearSelection:()=>{t.clearSelection()},clearFilter:V=>{t.clearFilter(V)},toggleAllSelection:()=>{t.commit("toggleAllSelection")},toggleRowExpansion:(V,z)=>{t.toggleRowExpansionAdapter(V,z)},clearSort:()=>{t.clearSort()},sort:(V,z)=>{t.commit("sort",{prop:V,order:z})}}}function useStyle(t,r,e,n){const g=ref(!1),y=ref(null),i=ref(!1),k=pr=>{i.value=pr},$=ref({width:null,height:null,headerHeight:null}),L=ref(!1),V={display:"inline-block",verticalAlign:"middle"},z=ref(),re=ref(0),ie=ref(0),ue=ref(0),le=ref(0),oe=ref(0);watchEffect(()=>{r.setHeight(t.height)}),watchEffect(()=>{r.setMaxHeight(t.maxHeight)}),watch(()=>[t.currentRowKey,e.states.rowKey],([pr,Sr])=>{!unref(Sr)||!unref(pr)||e.setCurrentRowKey(`${pr}`)},{immediate:!0}),watch(()=>t.data,pr=>{n.store.commit("setData",pr)},{immediate:!0,deep:!0}),watchEffect(()=>{t.expandRowKeys&&e.setExpandRowKeysAdapter(t.expandRowKeys)});const ae=()=>{n.store.commit("setHoverRow",null),n.hoverState&&(n.hoverState=null)},qe=(pr,Sr)=>{const{pixelX:Er,pixelY:Pr}=Sr;Math.abs(Er)>=Math.abs(Pr)&&(n.refs.bodyWrapper.scrollLeft+=Sr.pixelX/5)},de=computed(()=>t.height||t.maxHeight||e.states.fixedColumns.value.length>0||e.states.rightFixedColumns.value.length>0),Ne=computed(()=>({width:r.bodyWidth.value?`${r.bodyWidth.value}px`:""})),ze=()=>{de.value&&r.updateElsHeight(),r.updateColumnsWidth(),requestAnimationFrame(Et)};onMounted(async()=>{await nextTick(),e.updateColumns(),ir(),requestAnimationFrame(ze);const pr=n.vnode.el,Sr=n.refs.headerWrapper;t.flexible&&pr&&pr.parentElement&&(pr.parentElement.style.minWidth="0"),$.value={width:z.value=pr.offsetWidth,height:pr.offsetHeight,headerHeight:t.showHeader&&Sr?Sr.offsetHeight:null},e.states.columns.value.forEach(Er=>{Er.filteredValue&&Er.filteredValue.length&&n.store.commit("filterChange",{column:Er,values:Er.filteredValue,silent:!0})}),n.$ready=!0});const $e=(pr,Sr)=>{if(!pr)return;const Er=Array.from(pr.classList).filter(Pr=>!Pr.startsWith("is-scrolling-"));Er.push(r.scrollX.value?Sr:"is-scrolling-none"),pr.className=Er.join(" ")},Lt=pr=>{const{tableWrapper:Sr}=n.refs;$e(Sr,pr)},jt=pr=>{const{tableWrapper:Sr}=n.refs;return!!(Sr&&Sr.classList.contains(pr))},Et=function(){if(!n.refs.scrollBarRef)return;if(!r.scrollX.value){const Ir="is-scrolling-none";jt(Ir)||Lt(Ir);return}const pr=n.refs.scrollBarRef.wrapRef;if(!pr)return;const{scrollLeft:Sr,offsetWidth:Er,scrollWidth:Pr}=pr,{headerWrapper:Cr,footerWrapper:rr}=n.refs;Cr&&(Cr.scrollLeft=Sr),rr&&(rr.scrollLeft=Sr);const kr=Pr-Er-1;Sr>=kr?Lt("is-scrolling-right"):Lt(Sr===0?"is-scrolling-left":"is-scrolling-middle")},ir=()=>{n.refs.scrollBarRef&&(n.refs.scrollBarRef.wrapRef&&useEventListener(n.refs.scrollBarRef.wrapRef,"scroll",Et,{passive:!0}),t.fit?useResizeObserver(n.vnode.el,dr):useEventListener(window,"resize",dr),useResizeObserver(n.refs.bodyWrapper,()=>{var pr,Sr;dr(),(Sr=(pr=n.refs)==null?void 0:pr.scrollBarRef)==null||Sr.update()}))},dr=()=>{var pr,Sr,Er,Pr;const Cr=n.vnode.el;if(!n.$ready||!Cr)return;let rr=!1;const{width:kr,height:Ir,headerHeight:xr}=$.value,vr=z.value=Cr.offsetWidth;kr!==vr&&(rr=!0);const _r=Cr.offsetHeight;(t.height||de.value)&&Ir!==_r&&(rr=!0);const Or=t.tableLayout==="fixed"?n.refs.headerWrapper:(pr=n.refs.tableHeaderRef)==null?void 0:pr.$el;t.showHeader&&(Or==null?void 0:Or.offsetHeight)!==xr&&(rr=!0),re.value=((Sr=n.refs.tableWrapper)==null?void 0:Sr.scrollHeight)||0,ue.value=(Or==null?void 0:Or.scrollHeight)||0,le.value=((Er=n.refs.footerWrapper)==null?void 0:Er.offsetHeight)||0,oe.value=((Pr=n.refs.appendWrapper)==null?void 0:Pr.offsetHeight)||0,ie.value=re.value-ue.value-le.value-oe.value,rr&&($.value={width:vr,height:_r,headerHeight:t.showHeader&&(Or==null?void 0:Or.offsetHeight)||0},ze())},Dt=useFormSize(),lr=computed(()=>{const{bodyWidth:pr,scrollY:Sr,gutterWidth:Er}=r;return pr.value?`${pr.value-(Sr.value?Er:0)}px`:""}),sr=computed(()=>t.maxHeight?"fixed":t.tableLayout),er=computed(()=>{if(t.data&&t.data.length)return null;let pr="100%";t.height&&ie.value&&(pr=`${ie.value}px`);const Sr=z.value;return{width:Sr?`${Sr}px`:"",height:pr}}),cr=computed(()=>t.height?{height:Number.isNaN(Number(t.height))?t.height:`${t.height}px`}:t.maxHeight?{maxHeight:Number.isNaN(Number(t.maxHeight))?t.maxHeight:`${t.maxHeight}px`}:{}),or=computed(()=>t.height?{height:"100%"}:t.maxHeight?Number.isNaN(Number(t.maxHeight))?{maxHeight:`calc(${t.maxHeight} - ${ue.value+le.value}px)`}:{maxHeight:`${t.maxHeight-ue.value-le.value}px`}:{});return{isHidden:g,renderExpanded:y,setDragVisible:k,isGroup:L,handleMouseLeave:ae,handleHeaderFooterMousewheel:qe,tableSize:Dt,emptyBlockStyle:er,handleFixedMousewheel:(pr,Sr)=>{const Er=n.refs.bodyWrapper;if(Math.abs(Sr.spinY)>0){const Pr=Er.scrollTop;Sr.pixelY<0&&Pr!==0&&pr.preventDefault(),Sr.pixelY>0&&Er.scrollHeight-Er.clientHeight>Pr&&pr.preventDefault(),Er.scrollTop+=Math.ceil(Sr.pixelY/5)}else Er.scrollLeft+=Math.ceil(Sr.pixelX/5)},resizeProxyVisible:i,bodyWidth:lr,resizeState:$,doLayout:ze,tableBodyStyles:Ne,tableLayout:sr,scrollbarViewStyle:V,tableInnerStyle:cr,scrollbarStyle:or}}function useKeyRender(t){const r=ref(),e=()=>{const g=t.vnode.el.querySelector(".hidden-columns"),y={childList:!0,subtree:!0},i=t.store.states.updateOrderFns;r.value=new MutationObserver(()=>{i.forEach(k=>k())}),r.value.observe(g,y)};onMounted(()=>{e()}),onUnmounted(()=>{var n;(n=r.value)==null||n.disconnect()})}var defaultProps$1={data:{type:Array,default:()=>[]},size:useSizeProp,width:[String,Number],height:[String,Number],maxHeight:[String,Number],fit:{type:Boolean,default:!0},stripe:Boolean,border:Boolean,rowKey:[String,Function],showHeader:{type:Boolean,default:!0},showSummary:Boolean,sumText:String,summaryMethod:Function,rowClassName:[String,Function],rowStyle:[Object,Function],cellClassName:[String,Function],cellStyle:[Object,Function],headerRowClassName:[String,Function],headerRowStyle:[Object,Function],headerCellClassName:[String,Function],headerCellStyle:[Object,Function],highlightCurrentRow:Boolean,currentRowKey:[String,Number],emptyText:String,expandRowKeys:Array,defaultExpandAll:Boolean,defaultSort:Object,tooltipEffect:String,tooltipOptions:Object,spanMethod:Function,selectOnIndeterminate:{type:Boolean,default:!0},indent:{type:Number,default:16},treeProps:{type:Object,default:()=>({hasChildren:"hasChildren",children:"children"})},lazy:Boolean,load:Function,style:{type:Object,default:()=>({})},className:{type:String,default:""},tableLayout:{type:String,default:"fixed"},scrollbarAlwaysOn:{type:Boolean,default:!1},flexible:Boolean,showOverflowTooltip:[Boolean,Object]};function hColgroup(t){const r=t.tableLayout==="auto";let e=t.columns||[];r&&e.every(g=>g.width===void 0)&&(e=[]);const n=g=>{const y={key:`${t.tableLayout}_${g.id}`,style:{},name:void 0};return r?y.style={width:`${g.width}px`}:y.name=g.id,y};return h$1("colgroup",{},e.map(g=>h$1("col",n(g))))}hColgroup.props=["columns","tableLayout"];const useScrollbar=()=>{const t=ref(),r=(y,i)=>{const k=t.value;k&&k.scrollTo(y,i)},e=(y,i)=>{const k=t.value;k&&isNumber$1(i)&&["Top","Left"].includes(y)&&k[`setScroll${y}`](i)};return{scrollBarRef:t,scrollTo:r,setScrollTop:y=>e("Top",y),setScrollLeft:y=>e("Left",y)}};let tableIdSeed=1;const _sfc_main$l=defineComponent({name:"ElTable",directives:{Mousewheel},components:{TableHeader,TableBody,TableFooter,ElScrollbar,hColgroup},props:defaultProps$1,emits:["select","select-all","selection-change","cell-mouse-enter","cell-mouse-leave","cell-contextmenu","cell-click","cell-dblclick","row-click","row-contextmenu","row-dblclick","header-click","header-contextmenu","sort-change","filter-change","current-change","header-dragend","expand-change"],setup(t){const{t:r}=useLocale(),e=useNamespace("table"),n=getCurrentInstance();provide(TABLE_INJECTION_KEY,n);const g=createStore(n,t);n.store=g;const y=new TableLayout({store:n.store,table:n,fit:t.fit,showHeader:t.showHeader});n.layout=y;const i=computed(()=>(g.states.data.value||[]).length===0),{setCurrentRow:k,getSelectionRows:$,toggleRowSelection:L,clearSelection:V,clearFilter:z,toggleAllSelection:re,toggleRowExpansion:ie,clearSort:ue,sort:le}=useUtils(g),{isHidden:oe,renderExpanded:ae,setDragVisible:qe,isGroup:de,handleMouseLeave:Ne,handleHeaderFooterMousewheel:ze,tableSize:$e,emptyBlockStyle:Lt,handleFixedMousewheel:jt,resizeProxyVisible:Et,bodyWidth:ir,resizeState:dr,doLayout:Dt,tableBodyStyles:lr,tableLayout:sr,scrollbarViewStyle:er,tableInnerStyle:cr,scrollbarStyle:or}=useStyle(t,y,g,n),{scrollBarRef:hr,scrollTo:pr,setScrollLeft:Sr,setScrollTop:Er}=useScrollbar(),Pr=debounce(Dt,50),Cr=`${e.namespace.value}-table_${tableIdSeed++}`;n.tableId=Cr,n.state={isGroup:de,resizeState:dr,doLayout:Dt,debouncedUpdateLayout:Pr};const rr=computed(()=>t.sumText||r("el.table.sumText")),kr=computed(()=>t.emptyText||r("el.table.emptyText"));return useKeyRender(n),{ns:e,layout:y,store:g,handleHeaderFooterMousewheel:ze,handleMouseLeave:Ne,tableId:Cr,tableSize:$e,isHidden:oe,isEmpty:i,renderExpanded:ae,resizeProxyVisible:Et,resizeState:dr,isGroup:de,bodyWidth:ir,tableBodyStyles:lr,emptyBlockStyle:Lt,debouncedUpdateLayout:Pr,handleFixedMousewheel:jt,setCurrentRow:k,getSelectionRows:$,toggleRowSelection:L,clearSelection:V,clearFilter:z,toggleAllSelection:re,toggleRowExpansion:ie,clearSort:ue,doLayout:Dt,sort:le,t:r,setDragVisible:qe,context:n,computedSumText:rr,computedEmptyText:kr,tableLayout:sr,scrollbarViewStyle:er,tableInnerStyle:cr,scrollbarStyle:or,scrollBarRef:hr,scrollTo:pr,setScrollLeft:Sr,setScrollTop:Er}}}),_hoisted_1$f=["data-prefix"],_hoisted_2$9={ref:"hiddenColumns",class:"hidden-columns"};function _sfc_render$1(t,r,e,n,g,y){const i=resolveComponent("hColgroup"),k=resolveComponent("table-header"),$=resolveComponent("table-body"),L=resolveComponent("table-footer"),V=resolveComponent("el-scrollbar"),z=resolveDirective("mousewheel");return openBlock(),createElementBlock("div",{ref:"tableWrapper",class:normalizeClass([{[t.ns.m("fit")]:t.fit,[t.ns.m("striped")]:t.stripe,[t.ns.m("border")]:t.border||t.isGroup,[t.ns.m("hidden")]:t.isHidden,[t.ns.m("group")]:t.isGroup,[t.ns.m("fluid-height")]:t.maxHeight,[t.ns.m("scrollable-x")]:t.layout.scrollX.value,[t.ns.m("scrollable-y")]:t.layout.scrollY.value,[t.ns.m("enable-row-hover")]:!t.store.states.isComplex.value,[t.ns.m("enable-row-transition")]:(t.store.states.data.value||[]).length!==0&&(t.store.states.data.value||[]).length<100,"has-footer":t.showSummary},t.ns.m(t.tableSize),t.className,t.ns.b(),t.ns.m(`layout-${t.tableLayout}`)]),style:normalizeStyle(t.style),"data-prefix":t.ns.namespace.value,onMouseleave:r[0]||(r[0]=(...re)=>t.handleMouseLeave&&t.handleMouseLeave(...re))},[createBaseVNode("div",{class:normalizeClass(t.ns.e("inner-wrapper")),style:normalizeStyle(t.tableInnerStyle)},[createBaseVNode("div",_hoisted_2$9,[renderSlot(t.$slots,"default")],512),t.showHeader&&t.tableLayout==="fixed"?withDirectives((openBlock(),createElementBlock("div",{key:0,ref:"headerWrapper",class:normalizeClass(t.ns.e("header-wrapper"))},[createBaseVNode("table",{ref:"tableHeader",class:normalizeClass(t.ns.e("header")),style:normalizeStyle(t.tableBodyStyles),border:"0",cellpadding:"0",cellspacing:"0"},[createVNode(i,{columns:t.store.states.columns.value,"table-layout":t.tableLayout},null,8,["columns","table-layout"]),createVNode(k,{ref:"tableHeaderRef",border:t.border,"default-sort":t.defaultSort,store:t.store,onSetDragVisible:t.setDragVisible},null,8,["border","default-sort","store","onSetDragVisible"])],6)],2)),[[z,t.handleHeaderFooterMousewheel]]):createCommentVNode("v-if",!0),createBaseVNode("div",{ref:"bodyWrapper",class:normalizeClass(t.ns.e("body-wrapper"))},[createVNode(V,{ref:"scrollBarRef","view-style":t.scrollbarViewStyle,"wrap-style":t.scrollbarStyle,always:t.scrollbarAlwaysOn},{default:withCtx(()=>[createBaseVNode("table",{ref:"tableBody",class:normalizeClass(t.ns.e("body")),cellspacing:"0",cellpadding:"0",border:"0",style:normalizeStyle({width:t.bodyWidth,tableLayout:t.tableLayout})},[createVNode(i,{columns:t.store.states.columns.value,"table-layout":t.tableLayout},null,8,["columns","table-layout"]),t.showHeader&&t.tableLayout==="auto"?(openBlock(),createBlock(k,{key:0,ref:"tableHeaderRef",class:normalizeClass(t.ns.e("body-header")),border:t.border,"default-sort":t.defaultSort,store:t.store,onSetDragVisible:t.setDragVisible},null,8,["class","border","default-sort","store","onSetDragVisible"])):createCommentVNode("v-if",!0),createVNode($,{context:t.context,highlight:t.highlightCurrentRow,"row-class-name":t.rowClassName,"tooltip-effect":t.tooltipEffect,"tooltip-options":t.tooltipOptions,"row-style":t.rowStyle,store:t.store,stripe:t.stripe},null,8,["context","highlight","row-class-name","tooltip-effect","tooltip-options","row-style","store","stripe"]),t.showSummary&&t.tableLayout==="auto"?(openBlock(),createBlock(L,{key:1,class:normalizeClass(t.ns.e("body-footer")),border:t.border,"default-sort":t.defaultSort,store:t.store,"sum-text":t.computedSumText,"summary-method":t.summaryMethod},null,8,["class","border","default-sort","store","sum-text","summary-method"])):createCommentVNode("v-if",!0)],6),t.isEmpty?(openBlock(),createElementBlock("div",{key:0,ref:"emptyBlock",style:normalizeStyle(t.emptyBlockStyle),class:normalizeClass(t.ns.e("empty-block"))},[createBaseVNode("span",{class:normalizeClass(t.ns.e("empty-text"))},[renderSlot(t.$slots,"empty",{},()=>[createTextVNode(toDisplayString(t.computedEmptyText),1)])],2)],6)):createCommentVNode("v-if",!0),t.$slots.append?(openBlock(),createElementBlock("div",{key:1,ref:"appendWrapper",class:normalizeClass(t.ns.e("append-wrapper"))},[renderSlot(t.$slots,"append")],2)):createCommentVNode("v-if",!0)]),_:3},8,["view-style","wrap-style","always"])],2),t.showSummary&&t.tableLayout==="fixed"?withDirectives((openBlock(),createElementBlock("div",{key:1,ref:"footerWrapper",class:normalizeClass(t.ns.e("footer-wrapper"))},[createBaseVNode("table",{class:normalizeClass(t.ns.e("footer")),cellspacing:"0",cellpadding:"0",border:"0",style:normalizeStyle(t.tableBodyStyles)},[createVNode(i,{columns:t.store.states.columns.value,"table-layout":t.tableLayout},null,8,["columns","table-layout"]),createVNode(L,{border:t.border,"default-sort":t.defaultSort,store:t.store,"sum-text":t.computedSumText,"summary-method":t.summaryMethod},null,8,["border","default-sort","store","sum-text","summary-method"])],6)],2)),[[vShow,!t.isEmpty],[z,t.handleHeaderFooterMousewheel]]):createCommentVNode("v-if",!0),t.border||t.isGroup?(openBlock(),createElementBlock("div",{key:2,class:normalizeClass(t.ns.e("border-left-patch"))},null,2)):createCommentVNode("v-if",!0)],6),withDirectives(createBaseVNode("div",{ref:"resizeProxy",class:normalizeClass(t.ns.e("column-resize-proxy"))},null,2),[[vShow,t.resizeProxyVisible]])],46,_hoisted_1$f)}var Table=_export_sfc$1(_sfc_main$l,[["render",_sfc_render$1],["__file","table.vue"]]);const defaultClassNames={selection:"table-column--selection",expand:"table__expand-column"},cellStarts={default:{order:""},selection:{width:48,minWidth:48,realWidth:48,order:""},expand:{width:48,minWidth:48,realWidth:48,order:""},index:{width:48,minWidth:48,realWidth:48,order:""}},getDefaultClassName=t=>defaultClassNames[t]||"",cellForced={selection:{renderHeader({store:t,column:r}){function e(){return t.states.data.value&&t.states.data.value.length===0}return h$1(ElCheckbox,{disabled:e(),size:t.states.tableSize.value,indeterminate:t.states.selection.value.length>0&&!t.states.isAllSelected.value,"onUpdate:modelValue":t.toggleAllSelection,modelValue:t.states.isAllSelected.value,ariaLabel:r.label})},renderCell({row:t,column:r,store:e,$index:n}){return h$1(ElCheckbox,{disabled:r.selectable?!r.selectable.call(null,t,n):!1,size:e.states.tableSize.value,onChange:()=>{e.commit("rowSelectedChanged",t)},onClick:g=>g.stopPropagation(),modelValue:e.isSelected(t),ariaLabel:r.label})},sortable:!1,resizable:!1},index:{renderHeader({column:t}){return t.label||"#"},renderCell({column:t,$index:r}){let e=r+1;const n=t.index;return typeof n=="number"?e=r+n:typeof n=="function"&&(e=n(r)),h$1("div",{},[e])},sortable:!1},expand:{renderHeader({column:t}){return t.label||""},renderCell({row:t,store:r,expanded:e}){const{ns:n}=r,g=[n.e("expand-icon")];return e&&g.push(n.em("expand-icon","expanded")),h$1("div",{class:g,onClick:function(i){i.stopPropagation(),r.toggleRowExpansion(t)}},{default:()=>[h$1(ElIcon,null,{default:()=>[h$1(arrow_right_default)]})]})},sortable:!1,resizable:!1}};function defaultRenderCell({row:t,column:r,$index:e}){var n;const g=r.property,y=g&&getProp(t,g).value;return r&&r.formatter?r.formatter(t,r,y,e):((n=y==null?void 0:y.toString)==null?void 0:n.call(y))||""}function treeCellPrefix({row:t,treeNode:r,store:e},n=!1){const{ns:g}=e;if(!r)return n?[h$1("span",{class:g.e("placeholder")})]:null;const y=[],i=function(k){k.stopPropagation(),!r.loading&&e.loadOrToggle(t)};if(r.indent&&y.push(h$1("span",{class:g.e("indent"),style:{"padding-left":`${r.indent}px`}})),typeof r.expanded=="boolean"&&!r.noLazyChildren){const k=[g.e("expand-icon"),r.expanded?g.em("expand-icon","expanded"):""];let $=arrow_right_default;r.loading&&($=loading_default),y.push(h$1("div",{class:k,onClick:i},{default:()=>[h$1(ElIcon,{class:{[g.is("loading")]:r.loading}},{default:()=>[h$1($)]})]}))}else y.push(h$1("span",{class:g.e("placeholder")}));return y}function getAllAliases(t,r){return t.reduce((e,n)=>(e[n]=n,e),r)}function useWatcher(t,r){const e=getCurrentInstance();return{registerComplexWatchers:()=>{const y=["fixed"],i={realWidth:"width",realMinWidth:"minWidth"},k=getAllAliases(y,i);Object.keys(k).forEach($=>{const L=i[$];hasOwn(r,L)&&watch(()=>r[L],V=>{let z=V;L==="width"&&$==="realWidth"&&(z=parseWidth(V)),L==="minWidth"&&$==="realMinWidth"&&(z=parseMinWidth(V)),e.columnConfig.value[L]=z,e.columnConfig.value[$]=z;const re=L==="fixed";t.value.store.scheduleLayout(re)})})},registerNormalWatchers:()=>{const y=["label","filters","filterMultiple","filteredValue","sortable","index","formatter","className","labelClassName","filterClassName","showOverflowTooltip"],i={property:"prop",align:"realAlign",headerAlign:"realHeaderAlign"},k=getAllAliases(y,i);Object.keys(k).forEach($=>{const L=i[$];hasOwn(r,L)&&watch(()=>r[L],V=>{e.columnConfig.value[$]=V})})}}}function useRender(t,r,e){const n=getCurrentInstance(),g=ref(""),y=ref(!1),i=ref(),k=ref(),$=useNamespace("table");watchEffect(()=>{i.value=t.align?`is-${t.align}`:null,i.value}),watchEffect(()=>{k.value=t.headerAlign?`is-${t.headerAlign}`:i.value,k.value});const L=computed(()=>{let Ne=n.vnode.vParent||n.parent;for(;Ne&&!Ne.tableId&&!Ne.columnId;)Ne=Ne.vnode.vParent||Ne.parent;return Ne}),V=computed(()=>{const{store:Ne}=n.parent;if(!Ne)return!1;const{treeData:ze}=Ne.states,$e=ze.value;return $e&&Object.keys($e).length>0}),z=ref(parseWidth(t.width)),re=ref(parseMinWidth(t.minWidth)),ie=Ne=>(z.value&&(Ne.width=z.value),re.value&&(Ne.minWidth=re.value),!z.value&&re.value&&(Ne.width=void 0),Ne.minWidth||(Ne.minWidth=80),Ne.realWidth=Number(Ne.width===void 0?Ne.minWidth:Ne.width),Ne),ue=Ne=>{const ze=Ne.type,$e=cellForced[ze]||{};Object.keys($e).forEach(jt=>{const Et=$e[jt];jt!=="className"&&Et!==void 0&&(Ne[jt]=Et)});const Lt=getDefaultClassName(ze);if(Lt){const jt=`${unref($.namespace)}-${Lt}`;Ne.className=Ne.className?`${Ne.className} ${jt}`:jt}return Ne},le=Ne=>{Array.isArray(Ne)?Ne.forEach($e=>ze($e)):ze(Ne);function ze($e){var Lt;((Lt=$e==null?void 0:$e.type)==null?void 0:Lt.name)==="ElTableColumn"&&($e.vParent=n)}};return{columnId:g,realAlign:i,isSubColumn:y,realHeaderAlign:k,columnOrTableParent:L,setColumnWidth:ie,setColumnForcedProps:ue,setColumnRenders:Ne=>{t.renderHeader||Ne.type!=="selection"&&(Ne.renderHeader=$e=>(n.columnConfig.value.label,renderSlot(r,"header",$e,()=>[Ne.label])));let ze=Ne.renderCell;return Ne.type==="expand"?(Ne.renderCell=$e=>h$1("div",{class:"cell"},[ze($e)]),e.value.renderExpanded=$e=>r.default?r.default($e):r.default):(ze=ze||defaultRenderCell,Ne.renderCell=$e=>{let Lt=null;if(r.default){const lr=r.default($e);Lt=lr.some(sr=>sr.type!==Comment)?lr:ze($e)}else Lt=ze($e);const{columns:jt}=e.value.store.states,Et=jt.value.findIndex(lr=>lr.type==="default"),ir=V.value&&$e.cellIndex===Et,dr=treeCellPrefix($e,ir),Dt={class:"cell",style:{}};return Ne.showOverflowTooltip&&(Dt.class=`${Dt.class} ${unref($.namespace)}-tooltip`,Dt.style={width:`${($e.column.realWidth||Number($e.column.width))-1}px`}),le(Lt),h$1("div",Dt,[dr,Lt])}),Ne},getPropsData:(...Ne)=>Ne.reduce((ze,$e)=>(Array.isArray($e)&&$e.forEach(Lt=>{ze[Lt]=t[Lt]}),ze),{}),getColumnElIndex:(Ne,ze)=>Array.prototype.indexOf.call(Ne,ze),updateColumnOrder:()=>{e.value.store.commit("updateColumnOrder",n.columnConfig.value)}}}var defaultProps={type:{type:String,default:"default"},label:String,className:String,labelClassName:String,property:String,prop:String,width:{type:[String,Number],default:""},minWidth:{type:[String,Number],default:""},renderHeader:Function,sortable:{type:[Boolean,String],default:!1},sortMethod:Function,sortBy:[String,Function,Array],resizable:{type:Boolean,default:!0},columnKey:String,align:String,headerAlign:String,showOverflowTooltip:{type:[Boolean,Object],default:void 0},fixed:[Boolean,String],formatter:Function,selectable:Function,reserveSelection:Boolean,filterMethod:Function,filteredValue:Array,filters:Array,filterPlacement:String,filterMultiple:{type:Boolean,default:!0},filterClassName:String,index:[Number,Function],sortOrders:{type:Array,default:()=>["ascending","descending",null],validator:t=>t.every(r=>["ascending","descending",null].includes(r))}};let columnIdSeed=1;var ElTableColumn$1=defineComponent({name:"ElTableColumn",components:{ElCheckbox},props:defaultProps,setup(t,{slots:r}){const e=getCurrentInstance(),n=ref({}),g=computed(()=>{let de=e.parent;for(;de&&!de.tableId;)de=de.parent;return de}),{registerNormalWatchers:y,registerComplexWatchers:i}=useWatcher(g,t),{columnId:k,isSubColumn:$,realHeaderAlign:L,columnOrTableParent:V,setColumnWidth:z,setColumnForcedProps:re,setColumnRenders:ie,getPropsData:ue,getColumnElIndex:le,realAlign:oe,updateColumnOrder:ae}=useRender(t,r,g),qe=V.value;k.value=`${qe.tableId||qe.columnId}_column_${columnIdSeed++}`,onBeforeMount(()=>{$.value=g.value!==qe;const de=t.type||"default",Ne=t.sortable===""?!0:t.sortable,ze=isUndefined$1(t.showOverflowTooltip)?qe.props.showOverflowTooltip:t.showOverflowTooltip,$e={...cellStarts[de],id:k.value,type:de,property:t.prop||t.property,align:oe,headerAlign:L,showOverflowTooltip:ze,filterable:t.filters||t.filterMethod,filteredValue:[],filterPlacement:"",filterClassName:"",isColumnGroup:!1,isSubColumn:!1,filterOpened:!1,sortable:Ne,index:t.index,rawColumnKey:e.vnode.key};let dr=ue(["columnKey","label","className","labelClassName","type","renderHeader","formatter","fixed","resizable"],["sortMethod","sortBy","sortOrders"],["selectable","reserveSelection"],["filterMethod","filters","filterMultiple","filterOpened","filteredValue","filterPlacement","filterClassName"]);dr=mergeOptions($e,dr),dr=compose(ie,z,re)(dr),n.value=dr,y(),i()}),onMounted(()=>{var de;const Ne=V.value,ze=$.value?Ne.vnode.el.children:(de=Ne.refs.hiddenColumns)==null?void 0:de.children,$e=()=>le(ze||[],e.vnode.el);n.value.getColumnIndex=$e,$e()>-1&&g.value.store.commit("insertColumn",n.value,$.value?Ne.columnConfig.value:null,ae)}),onBeforeUnmount(()=>{g.value.store.commit("removeColumn",n.value,$.value?qe.columnConfig.value:null,ae)}),e.columnId=k.value,e.columnConfig=n},render(){var t,r,e;try{const n=(r=(t=this.$slots).default)==null?void 0:r.call(t,{row:{},column:{},$index:-1}),g=[];if(Array.isArray(n))for(const i of n)((e=i.type)==null?void 0:e.name)==="ElTableColumn"||i.shapeFlag&2?g.push(i):i.type===Fragment&&Array.isArray(i.children)&&i.children.forEach(k=>{(k==null?void 0:k.patchFlag)!==1024&&!isString$2(k==null?void 0:k.children)&&g.push(k)});return h$1("div",g)}catch{return h$1("div",[])}}});const ElTable=withInstall(Table,{TableColumn:ElTableColumn$1}),ElTableColumn=withNoopInstall(ElTableColumn$1),uploadContextKey=Symbol("uploadContextKey"),SCOPE$1="ElUpload";class UploadAjaxError extends Error{constructor(r,e,n,g){super(r),this.name="UploadAjaxError",this.status=e,this.method=n,this.url=g}}function getError(t,r,e){let n;return e.response?n=`${e.response.error||e.response}`:e.responseText?n=`${e.responseText}`:n=`fail to ${r.method} ${t} ${e.status}`,new UploadAjaxError(n,e.status,r.method,t)}function getBody(t){const r=t.responseText||t.response;if(!r)return r;try{return JSON.parse(r)}catch{return r}}const ajaxUpload=t=>{typeof XMLHttpRequest>"u"&&throwError(SCOPE$1,"XMLHttpRequest is undefined");const r=new XMLHttpRequest,e=t.action;r.upload&&r.upload.addEventListener("progress",y=>{const i=y;i.percent=y.total>0?y.loaded/y.total*100:0,t.onProgress(i)});const n=new FormData;if(t.data)for(const[y,i]of Object.entries(t.data))isArray$3(i)&&i.length?n.append(y,...i):n.append(y,i);n.append(t.filename,t.file,t.file.name),r.addEventListener("error",()=>{t.onError(getError(e,t,r))}),r.addEventListener("load",()=>{if(r.status<200||r.status>=300)return t.onError(getError(e,t,r));t.onSuccess(getBody(r))}),r.open(t.method,e,!0),t.withCredentials&&"withCredentials"in r&&(r.withCredentials=!0);const g=t.headers||{};if(g instanceof Headers)g.forEach((y,i)=>r.setRequestHeader(i,y));else for(const[y,i]of Object.entries(g))isNil(i)||r.setRequestHeader(y,String(i));return r.send(n),r},uploadListTypes=["text","picture","picture-card"];let fileId=1;const genFileId=()=>Date.now()+fileId++,uploadBaseProps=buildProps({action:{type:String,default:"#"},headers:{type:definePropType(Object)},method:{type:String,default:"post"},data:{type:definePropType([Object,Function,Promise]),default:()=>mutable({})},multiple:{type:Boolean,default:!1},name:{type:String,default:"file"},drag:{type:Boolean,default:!1},withCredentials:Boolean,showFileList:{type:Boolean,default:!0},accept:{type:String,default:""},fileList:{type:definePropType(Array),default:()=>mutable([])},autoUpload:{type:Boolean,default:!0},listType:{type:String,values:uploadListTypes,default:"text"},httpRequest:{type:definePropType(Function),default:ajaxUpload},disabled:Boolean,limit:Number}),uploadProps=buildProps({...uploadBaseProps,beforeUpload:{type:definePropType(Function),default:NOOP},beforeRemove:{type:definePropType(Function)},onRemove:{type:definePropType(Function),default:NOOP},onChange:{type:definePropType(Function),default:NOOP},onPreview:{type:definePropType(Function),default:NOOP},onSuccess:{type:definePropType(Function),default:NOOP},onProgress:{type:definePropType(Function),default:NOOP},onError:{type:definePropType(Function),default:NOOP},onExceed:{type:definePropType(Function),default:NOOP},crossorigin:{type:definePropType(String)}}),uploadListProps=buildProps({files:{type:definePropType(Array),default:()=>mutable([])},disabled:{type:Boolean,default:!1},handlePreview:{type:definePropType(Function),default:NOOP},listType:{type:String,values:uploadListTypes,default:"text"},crossorigin:{type:definePropType(String)}}),uploadListEmits={remove:t=>!!t},_hoisted_1$e=["onKeydown"],_hoisted_2$8=["src","crossorigin"],_hoisted_3$6=["onClick"],_hoisted_4$4=["title"],_hoisted_5$3=["onClick"],_hoisted_6$1=["onClick"],__default__$4=defineComponent({name:"ElUploadList"}),_sfc_main$k=defineComponent({...__default__$4,props:uploadListProps,emits:uploadListEmits,setup(t,{emit:r}){const e=t,{t:n}=useLocale(),g=useNamespace("upload"),y=useNamespace("icon"),i=useNamespace("list"),k=useFormDisabled(),$=ref(!1),L=computed(()=>[g.b("list"),g.bm("list",e.listType),g.is("disabled",e.disabled)]),V=z=>{r("remove",z)};return(z,re)=>(openBlock(),createBlock(TransitionGroup,{tag:"ul",class:normalizeClass(unref(L)),name:unref(i).b()},{default:withCtx(()=>[(openBlock(!0),createElementBlock(Fragment,null,renderList(z.files,ie=>(openBlock(),createElementBlock("li",{key:ie.uid||ie.name,class:normalizeClass([unref(g).be("list","item"),unref(g).is(ie.status),{focusing:$.value}]),tabindex:"0",onKeydown:withKeys(ue=>!unref(k)&&V(ie),["delete"]),onFocus:re[0]||(re[0]=ue=>$.value=!0),onBlur:re[1]||(re[1]=ue=>$.value=!1),onClick:re[2]||(re[2]=ue=>$.value=!1)},[renderSlot(z.$slots,"default",{file:ie},()=>[z.listType==="picture"||ie.status!=="uploading"&&z.listType==="picture-card"?(openBlock(),createElementBlock("img",{key:0,class:normalizeClass(unref(g).be("list","item-thumbnail")),src:ie.url,crossorigin:z.crossorigin,alt:""},null,10,_hoisted_2$8)):createCommentVNode("v-if",!0),ie.status==="uploading"||z.listType!=="picture-card"?(openBlock(),createElementBlock("div",{key:1,class:normalizeClass(unref(g).be("list","item-info"))},[createBaseVNode("a",{class:normalizeClass(unref(g).be("list","item-name")),onClick:withModifiers(ue=>z.handlePreview(ie),["prevent"])},[createVNode(unref(ElIcon),{class:normalizeClass(unref(y).m("document"))},{default:withCtx(()=>[createVNode(unref(document_default))]),_:1},8,["class"]),createBaseVNode("span",{class:normalizeClass(unref(g).be("list","item-file-name")),title:ie.name},toDisplayString(ie.name),11,_hoisted_4$4)],10,_hoisted_3$6),ie.status==="uploading"?(openBlock(),createBlock(unref(ElProgress),{key:0,type:z.listType==="picture-card"?"circle":"line","stroke-width":z.listType==="picture-card"?6:2,percentage:Number(ie.percentage),style:normalizeStyle(z.listType==="picture-card"?"":"margin-top: 0.5rem")},null,8,["type","stroke-width","percentage","style"])):createCommentVNode("v-if",!0)],2)):createCommentVNode("v-if",!0),createBaseVNode("label",{class:normalizeClass(unref(g).be("list","item-status-label"))},[z.listType==="text"?(openBlock(),createBlock(unref(ElIcon),{key:0,class:normalizeClass([unref(y).m("upload-success"),unref(y).m("circle-check")])},{default:withCtx(()=>[createVNode(unref(circle_check_default))]),_:1},8,["class"])):["picture-card","picture"].includes(z.listType)?(openBlock(),createBlock(unref(ElIcon),{key:1,class:normalizeClass([unref(y).m("upload-success"),unref(y).m("check")])},{default:withCtx(()=>[createVNode(unref(check_default))]),_:1},8,["class"])):createCommentVNode("v-if",!0)],2),unref(k)?createCommentVNode("v-if",!0):(openBlock(),createBlock(unref(ElIcon),{key:2,class:normalizeClass(unref(y).m("close")),onClick:ue=>V(ie)},{default:withCtx(()=>[createVNode(unref(close_default))]),_:2},1032,["class","onClick"])),createCommentVNode(" Due to close btn only appears when li gets focused disappears after li gets blurred, thus keyboard navigation can never reach close btn"),createCommentVNode(" This is a bug which needs to be fixed "),createCommentVNode(" TODO: Fix the incorrect navigation interaction "),unref(k)?createCommentVNode("v-if",!0):(openBlock(),createElementBlock("i",{key:3,class:normalizeClass(unref(y).m("close-tip"))},toDisplayString(unref(n)("el.upload.deleteTip")),3)),z.listType==="picture-card"?(openBlock(),createElementBlock("span",{key:4,class:normalizeClass(unref(g).be("list","item-actions"))},[createBaseVNode("span",{class:normalizeClass(unref(g).be("list","item-preview")),onClick:ue=>z.handlePreview(ie)},[createVNode(unref(ElIcon),{class:normalizeClass(unref(y).m("zoom-in"))},{default:withCtx(()=>[createVNode(unref(zoom_in_default))]),_:1},8,["class"])],10,_hoisted_5$3),unref(k)?createCommentVNode("v-if",!0):(openBlock(),createElementBlock("span",{key:0,class:normalizeClass(unref(g).be("list","item-delete")),onClick:ue=>V(ie)},[createVNode(unref(ElIcon),{class:normalizeClass(unref(y).m("delete"))},{default:withCtx(()=>[createVNode(unref(delete_default))]),_:1},8,["class"])],10,_hoisted_6$1))],2)):createCommentVNode("v-if",!0)])],42,_hoisted_1$e))),128)),renderSlot(z.$slots,"append")]),_:3},8,["class","name"]))}});var UploadList=_export_sfc$1(_sfc_main$k,[["__file","upload-list.vue"]]);const uploadDraggerProps=buildProps({disabled:{type:Boolean,default:!1}}),uploadDraggerEmits={file:t=>isArray$3(t)},_hoisted_1$d=["onDrop","onDragover"],COMPONENT_NAME="ElUploadDrag",__default__$3=defineComponent({name:COMPONENT_NAME}),_sfc_main$j=defineComponent({...__default__$3,props:uploadDraggerProps,emits:uploadDraggerEmits,setup(t,{emit:r}){const e=inject(uploadContextKey);e||throwError(COMPONENT_NAME,"usage: <el-upload><el-upload-dragger /></el-upload>");const n=useNamespace("upload"),g=ref(!1),y=useFormDisabled(),i=$=>{if(y.value)return;g.value=!1,$.stopPropagation();const L=Array.from($.dataTransfer.files),V=e.accept.value;if(!V){r("file",L);return}const z=L.filter(re=>{const{type:ie,name:ue}=re,le=ue.includes(".")?`.${ue.split(".").pop()}`:"",oe=ie.replace(/\/.*$/,"");return V.split(",").map(ae=>ae.trim()).filter(ae=>ae).some(ae=>ae.startsWith(".")?le===ae:/\/\*$/.test(ae)?oe===ae.replace(/\/\*$/,""):/^[^/]+\/[^/]+$/.test(ae)?ie===ae:!1)});r("file",z)},k=()=>{y.value||(g.value=!0)};return($,L)=>(openBlock(),createElementBlock("div",{class:normalizeClass([unref(n).b("dragger"),unref(n).is("dragover",g.value)]),onDrop:withModifiers(i,["prevent"]),onDragover:withModifiers(k,["prevent"]),onDragleave:L[0]||(L[0]=withModifiers(V=>g.value=!1,["prevent"]))},[renderSlot($.$slots,"default")],42,_hoisted_1$d))}});var UploadDragger=_export_sfc$1(_sfc_main$j,[["__file","upload-dragger.vue"]]);const uploadContentProps=buildProps({...uploadBaseProps,beforeUpload:{type:definePropType(Function),default:NOOP},onRemove:{type:definePropType(Function),default:NOOP},onStart:{type:definePropType(Function),default:NOOP},onSuccess:{type:definePropType(Function),default:NOOP},onProgress:{type:definePropType(Function),default:NOOP},onError:{type:definePropType(Function),default:NOOP},onExceed:{type:definePropType(Function),default:NOOP}}),_hoisted_1$c=["onKeydown"],_hoisted_2$7=["name","multiple","accept"],__default__$2=defineComponent({name:"ElUploadContent",inheritAttrs:!1}),_sfc_main$i=defineComponent({...__default__$2,props:uploadContentProps,setup(t,{expose:r}){const e=t,n=useNamespace("upload"),g=useFormDisabled(),y=shallowRef({}),i=shallowRef(),k=le=>{if(le.length===0)return;const{autoUpload:oe,limit:ae,fileList:qe,multiple:de,onStart:Ne,onExceed:ze}=e;if(ae&&qe.length+le.length>ae){ze(le,qe);return}de||(le=le.slice(0,1));for(const $e of le){const Lt=$e;Lt.uid=genFileId(),Ne(Lt),oe&&$(Lt)}},$=async le=>{if(i.value.value="",!e.beforeUpload)return V(le);let oe,ae={};try{const de=e.data,Ne=e.beforeUpload(le);ae=isPlainObject$2(e.data)?cloneDeep(e.data):e.data,oe=await Ne,isPlainObject$2(e.data)&&isEqual(de,ae)&&(ae=cloneDeep(e.data))}catch{oe=!1}if(oe===!1){e.onRemove(le);return}let qe=le;oe instanceof Blob&&(oe instanceof File?qe=oe:qe=new File([oe],le.name,{type:le.type})),V(Object.assign(qe,{uid:le.uid}),ae)},L=async(le,oe)=>isFunction$3(le)?le(oe):le,V=async(le,oe)=>{const{headers:ae,data:qe,method:de,withCredentials:Ne,name:ze,action:$e,onProgress:Lt,onSuccess:jt,onError:Et,httpRequest:ir}=e;try{oe=await L(oe??qe,le)}catch{e.onRemove(le);return}const{uid:dr}=le,Dt={headers:ae||{},withCredentials:Ne,file:le,data:oe,method:de,filename:ze,action:$e,onProgress:sr=>{Lt(sr,le)},onSuccess:sr=>{jt(sr,le),delete y.value[dr]},onError:sr=>{Et(sr,le),delete y.value[dr]}},lr=ir(Dt);y.value[dr]=lr,lr instanceof Promise&&lr.then(Dt.onSuccess,Dt.onError)},z=le=>{const oe=le.target.files;oe&&k(Array.from(oe))},re=()=>{g.value||(i.value.value="",i.value.click())},ie=()=>{re()};return r({abort:le=>{entriesOf(y.value).filter(le?([ae])=>String(le.uid)===ae:()=>!0).forEach(([ae,qe])=>{qe instanceof XMLHttpRequest&&qe.abort(),delete y.value[ae]})},upload:$}),(le,oe)=>(openBlock(),createElementBlock("div",{class:normalizeClass([unref(n).b(),unref(n).m(le.listType),unref(n).is("drag",le.drag)]),tabindex:"0",onClick:re,onKeydown:withKeys(withModifiers(ie,["self"]),["enter","space"])},[le.drag?(openBlock(),createBlock(UploadDragger,{key:0,disabled:unref(g),onFile:k},{default:withCtx(()=>[renderSlot(le.$slots,"default")]),_:3},8,["disabled"])):renderSlot(le.$slots,"default",{key:1}),createBaseVNode("input",{ref_key:"inputRef",ref:i,class:normalizeClass(unref(n).e("input")),name:le.name,multiple:le.multiple,accept:le.accept,type:"file",onChange:z,onClick:oe[0]||(oe[0]=withModifiers(()=>{},["stop"]))},null,42,_hoisted_2$7)],42,_hoisted_1$c))}});var UploadContent=_export_sfc$1(_sfc_main$i,[["__file","upload-content.vue"]]);const SCOPE="ElUpload",revokeFileObjectURL=t=>{var r;(r=t.url)!=null&&r.startsWith("blob:")&&URL.revokeObjectURL(t.url)},useHandlers=(t,r)=>{const e=useVModel(t,"fileList",void 0,{passive:!0}),n=re=>e.value.find(ie=>ie.uid===re.uid);function g(re){var ie;(ie=r.value)==null||ie.abort(re)}function y(re=["ready","uploading","success","fail"]){e.value=e.value.filter(ie=>!re.includes(ie.status))}const i=(re,ie)=>{const ue=n(ie);ue&&(console.error(re),ue.status="fail",e.value.splice(e.value.indexOf(ue),1),t.onError(re,ue,e.value),t.onChange(ue,e.value))},k=(re,ie)=>{const ue=n(ie);ue&&(t.onProgress(re,ue,e.value),ue.status="uploading",ue.percentage=Math.round(re.percent))},$=(re,ie)=>{const ue=n(ie);ue&&(ue.status="success",ue.response=re,t.onSuccess(re,ue,e.value),t.onChange(ue,e.value))},L=re=>{isNil(re.uid)&&(re.uid=genFileId());const ie={name:re.name,percentage:0,status:"ready",size:re.size,raw:re,uid:re.uid};if(t.listType==="picture-card"||t.listType==="picture")try{ie.url=URL.createObjectURL(re)}catch(ue){ue.message,t.onError(ue,ie,e.value)}e.value=[...e.value,ie],t.onChange(ie,e.value)},V=async re=>{const ie=re instanceof File?n(re):re;ie||throwError(SCOPE,"file to be removed not found");const ue=le=>{g(le);const oe=e.value;oe.splice(oe.indexOf(le),1),t.onRemove(le,oe),revokeFileObjectURL(le)};t.beforeRemove?await t.beforeRemove(ie,e.value)!==!1&&ue(ie):ue(ie)};function z(){e.value.filter(({status:re})=>re==="ready").forEach(({raw:re})=>{var ie;return re&&((ie=r.value)==null?void 0:ie.upload(re))})}return watch(()=>t.listType,re=>{re!=="picture-card"&&re!=="picture"||(e.value=e.value.map(ie=>{const{raw:ue,url:le}=ie;if(!le&&ue)try{ie.url=URL.createObjectURL(ue)}catch(oe){t.onError(oe,ie,e.value)}return ie}))}),watch(e,re=>{for(const ie of re)ie.uid||(ie.uid=genFileId()),ie.status||(ie.status="success")},{immediate:!0,deep:!0}),{uploadFiles:e,abort:g,clearFiles:y,handleError:i,handleProgress:k,handleStart:L,handleSuccess:$,handleRemove:V,submit:z,revokeFileObjectURL}},__default__$1=defineComponent({name:"ElUpload"}),_sfc_main$h=defineComponent({...__default__$1,props:uploadProps,setup(t,{expose:r}){const e=t,n=useFormDisabled(),g=shallowRef(),{abort:y,submit:i,clearFiles:k,uploadFiles:$,handleStart:L,handleError:V,handleRemove:z,handleSuccess:re,handleProgress:ie,revokeFileObjectURL:ue}=useHandlers(e,g),le=computed(()=>e.listType==="picture-card"),oe=computed(()=>({...e,fileList:$.value,onStart:L,onProgress:ie,onSuccess:re,onError:V,onRemove:z}));return onBeforeUnmount(()=>{$.value.forEach(ue)}),provide(uploadContextKey,{accept:toRef(e,"accept")}),r({abort:y,submit:i,clearFiles:k,handleStart:L,handleRemove:z}),(ae,qe)=>(openBlock(),createElementBlock("div",null,[unref(le)&&ae.showFileList?(openBlock(),createBlock(UploadList,{key:0,disabled:unref(n),"list-type":ae.listType,files:unref($),crossorigin:ae.crossorigin,"handle-preview":ae.onPreview,onRemove:unref(z)},createSlots({append:withCtx(()=>[createVNode(UploadContent,mergeProps({ref_key:"uploadRef",ref:g},unref(oe)),{default:withCtx(()=>[ae.$slots.trigger?renderSlot(ae.$slots,"trigger",{key:0}):createCommentVNode("v-if",!0),!ae.$slots.trigger&&ae.$slots.default?renderSlot(ae.$slots,"default",{key:1}):createCommentVNode("v-if",!0)]),_:3},16)]),_:2},[ae.$slots.file?{name:"default",fn:withCtx(({file:de})=>[renderSlot(ae.$slots,"file",{file:de})])}:void 0]),1032,["disabled","list-type","files","crossorigin","handle-preview","onRemove"])):createCommentVNode("v-if",!0),!unref(le)||unref(le)&&!ae.showFileList?(openBlock(),createBlock(UploadContent,mergeProps({key:1,ref_key:"uploadRef",ref:g},unref(oe)),{default:withCtx(()=>[ae.$slots.trigger?renderSlot(ae.$slots,"trigger",{key:0}):createCommentVNode("v-if",!0),!ae.$slots.trigger&&ae.$slots.default?renderSlot(ae.$slots,"default",{key:1}):createCommentVNode("v-if",!0)]),_:3},16)):createCommentVNode("v-if",!0),ae.$slots.trigger?renderSlot(ae.$slots,"default",{key:2}):createCommentVNode("v-if",!0),renderSlot(ae.$slots,"tip"),!unref(le)&&ae.showFileList?(openBlock(),createBlock(UploadList,{key:3,disabled:unref(n),"list-type":ae.listType,files:unref($),crossorigin:ae.crossorigin,"handle-preview":ae.onPreview,onRemove:unref(z)},createSlots({_:2},[ae.$slots.file?{name:"default",fn:withCtx(({file:de})=>[renderSlot(ae.$slots,"file",{file:de})])}:void 0]),1032,["disabled","list-type","files","crossorigin","handle-preview","onRemove"])):createCommentVNode("v-if",!0)]))}});var Upload=_export_sfc$1(_sfc_main$h,[["__file","upload.vue"]]);const ElUpload=withInstall(Upload),messageTypes=["success","info","warning","error"],messageDefaults=mutable({customClass:"",center:!1,dangerouslyUseHTMLString:!1,duration:3e3,icon:void 0,id:"",message:"",onClose:void 0,showClose:!1,type:"info",offset:16,zIndex:0,grouping:!1,repeatNum:1,appendTo:isClient?document.body:void 0}),messageProps=buildProps({customClass:{type:String,default:messageDefaults.customClass},center:{type:Boolean,default:messageDefaults.center},dangerouslyUseHTMLString:{type:Boolean,default:messageDefaults.dangerouslyUseHTMLString},duration:{type:Number,default:messageDefaults.duration},icon:{type:iconPropType,default:messageDefaults.icon},id:{type:String,default:messageDefaults.id},message:{type:definePropType([String,Object,Function]),default:messageDefaults.message},onClose:{type:definePropType(Function),required:!1},showClose:{type:Boolean,default:messageDefaults.showClose},type:{type:String,values:messageTypes,default:messageDefaults.type},offset:{type:Number,default:messageDefaults.offset},zIndex:{type:Number,default:messageDefaults.zIndex},grouping:{type:Boolean,default:messageDefaults.grouping},repeatNum:{type:Number,default:messageDefaults.repeatNum}}),messageEmits={destroy:()=>!0},instances=shallowReactive([]),getInstance=t=>{const r=instances.findIndex(g=>g.id===t),e=instances[r];let n;return r>0&&(n=instances[r-1]),{current:e,prev:n}},getLastOffset=t=>{const{prev:r}=getInstance(t);return r?r.vm.exposed.bottom.value:0},getOffsetOrSpace=(t,r)=>instances.findIndex(n=>n.id===t)>0?20:r,_hoisted_1$b=["id"],_hoisted_2$6=["innerHTML"],__default__=defineComponent({name:"ElMessage"}),_sfc_main$g=defineComponent({...__default__,props:messageProps,emits:messageEmits,setup(t,{expose:r}){const e=t,{Close:n}=TypeComponents,{ns:g,zIndex:y}=useGlobalComponentSettings("message"),{currentZIndex:i,nextZIndex:k}=y,$=ref(),L=ref(!1),V=ref(0);let z;const re=computed(()=>e.type?e.type==="error"?"danger":e.type:"info"),ie=computed(()=>{const Lt=e.type;return{[g.bm("icon",Lt)]:Lt&&TypeComponentsMap[Lt]}}),ue=computed(()=>e.icon||TypeComponentsMap[e.type]||""),le=computed(()=>getLastOffset(e.id)),oe=computed(()=>getOffsetOrSpace(e.id,e.offset)+le.value),ae=computed(()=>V.value+oe.value),qe=computed(()=>({top:`${oe.value}px`,zIndex:i.value}));function de(){e.duration!==0&&({stop:z}=useTimeoutFn(()=>{ze()},e.duration))}function Ne(){z==null||z()}function ze(){L.value=!1}function $e({code:Lt}){Lt===EVENT_CODE.esc&&ze()}return onMounted(()=>{de(),k(),L.value=!0}),watch(()=>e.repeatNum,()=>{Ne(),de()}),useEventListener(document,"keydown",$e),useResizeObserver($,()=>{V.value=$.value.getBoundingClientRect().height}),r({visible:L,bottom:ae,close:ze}),(Lt,jt)=>(openBlock(),createBlock(Transition,{name:unref(g).b("fade"),onBeforeLeave:Lt.onClose,onAfterLeave:jt[0]||(jt[0]=Et=>Lt.$emit("destroy")),persisted:""},{default:withCtx(()=>[withDirectives(createBaseVNode("div",{id:Lt.id,ref_key:"messageRef",ref:$,class:normalizeClass([unref(g).b(),{[unref(g).m(Lt.type)]:Lt.type},unref(g).is("center",Lt.center),unref(g).is("closable",Lt.showClose),Lt.customClass]),style:normalizeStyle(unref(qe)),role:"alert",onMouseenter:Ne,onMouseleave:de},[Lt.repeatNum>1?(openBlock(),createBlock(unref(ElBadge),{key:0,value:Lt.repeatNum,type:unref(re),class:normalizeClass(unref(g).e("badge"))},null,8,["value","type","class"])):createCommentVNode("v-if",!0),unref(ue)?(openBlock(),createBlock(unref(ElIcon),{key:1,class:normalizeClass([unref(g).e("icon"),unref(ie)])},{default:withCtx(()=>[(openBlock(),createBlock(resolveDynamicComponent(unref(ue))))]),_:1},8,["class"])):createCommentVNode("v-if",!0),renderSlot(Lt.$slots,"default",{},()=>[Lt.dangerouslyUseHTMLString?(openBlock(),createElementBlock(Fragment,{key:1},[createCommentVNode(" Caution here, message could've been compromised, never use user's input as message "),createBaseVNode("p",{class:normalizeClass(unref(g).e("content")),innerHTML:Lt.message},null,10,_hoisted_2$6)],2112)):(openBlock(),createElementBlock("p",{key:0,class:normalizeClass(unref(g).e("content"))},toDisplayString(Lt.message),3))]),Lt.showClose?(openBlock(),createBlock(unref(ElIcon),{key:2,class:normalizeClass(unref(g).e("closeBtn")),onClick:withModifiers(ze,["stop"])},{default:withCtx(()=>[createVNode(unref(n))]),_:1},8,["class","onClick"])):createCommentVNode("v-if",!0)],46,_hoisted_1$b),[[vShow,L.value]])]),_:3},8,["name","onBeforeLeave"]))}});var MessageConstructor=_export_sfc$1(_sfc_main$g,[["__file","message.vue"]]);let seed=1;const normalizeOptions=t=>{const r=!t||isString$2(t)||isVNode(t)||isFunction$3(t)?{message:t}:t,e={...messageDefaults,...r};if(!e.appendTo)e.appendTo=document.body;else if(isString$2(e.appendTo)){let n=document.querySelector(e.appendTo);isElement(n)||(n=document.body),e.appendTo=n}return e},closeMessage=t=>{const r=instances.indexOf(t);if(r===-1)return;instances.splice(r,1);const{handler:e}=t;e.close()},createMessage=({appendTo:t,...r},e)=>{const n=`message_${seed++}`,g=r.onClose,y=document.createElement("div"),i={...r,id:n,onClose:()=>{g==null||g(),closeMessage(V)},onDestroy:()=>{render(null,y)}},k=createVNode(MessageConstructor,i,isFunction$3(i.message)||isVNode(i.message)?{default:isFunction$3(i.message)?i.message:()=>i.message}:null);k.appContext=e||message._context,render(k,y),t.appendChild(y.firstElementChild);const $=k.component,V={id:n,vnode:k,vm:$,handler:{close:()=>{$.exposed.visible.value=!1}},props:k.component.props};return V},message=(t={},r)=>{if(!isClient)return{close:()=>{}};if(isNumber$1(messageConfig.max)&&instances.length>=messageConfig.max)return{close:()=>{}};const e=normalizeOptions(t);if(e.grouping&&instances.length){const g=instances.find(({vnode:y})=>{var i;return((i=y.props)==null?void 0:i.message)===e.message});if(g)return g.props.repeatNum+=1,g.props.type=e.type,g.handler}const n=createMessage(e,r);return instances.push(n),n.handler};messageTypes.forEach(t=>{message[t]=(r={},e)=>{const n=normalizeOptions(r);return message({...n,type:t},e)}});function closeAll(t){for(const r of instances)(!t||t===r.props.type)&&r.handler.close()}message.closeAll=closeAll;message._context=null;const ElMessage=withInstallFunction(message,"$message"),_sfc_main$f=defineComponent({name:"ElMessageBox",directives:{TrapFocus},components:{ElButton,ElFocusTrap,ElInput,ElOverlay,ElIcon,...TypeComponents},inheritAttrs:!1,props:{buttonSize:{type:String,validator:isValidComponentSize},modal:{type:Boolean,default:!0},lockScroll:{type:Boolean,default:!0},showClose:{type:Boolean,default:!0},closeOnClickModal:{type:Boolean,default:!0},closeOnPressEscape:{type:Boolean,default:!0},closeOnHashChange:{type:Boolean,default:!0},center:Boolean,draggable:Boolean,overflow:Boolean,roundButton:{default:!1,type:Boolean},container:{type:String,default:"body"},boxType:{type:String,default:""}},emits:["vanish","action"],setup(t,{emit:r}){const{locale:e,zIndex:n,ns:g,size:y}=useGlobalComponentSettings("message-box",computed(()=>t.buttonSize)),{t:i}=e,{nextZIndex:k}=n,$=ref(!1),L=reactive({autofocus:!0,beforeClose:null,callback:null,cancelButtonText:"",cancelButtonClass:"",confirmButtonText:"",confirmButtonClass:"",customClass:"",customStyle:{},dangerouslyUseHTMLString:!1,distinguishCancelAndClose:!1,icon:"",inputPattern:null,inputPlaceholder:"",inputType:"text",inputValue:null,inputValidator:null,inputErrorMessage:"",message:null,modalFade:!0,modalClass:"",showCancelButton:!1,showConfirmButton:!0,type:"",title:void 0,showInput:!1,action:"",confirmButtonLoading:!1,cancelButtonLoading:!1,confirmButtonDisabled:!1,editorErrorMessage:"",validateError:!1,zIndex:k()}),V=computed(()=>{const cr=L.type;return{[g.bm("icon",cr)]:cr&&TypeComponentsMap[cr]}}),z=useId(),re=useId(),ie=computed(()=>L.icon||TypeComponentsMap[L.type]||""),ue=computed(()=>!!L.message),le=ref(),oe=ref(),ae=ref(),qe=ref(),de=ref(),Ne=computed(()=>L.confirmButtonClass);watch(()=>L.inputValue,async cr=>{await nextTick(),t.boxType==="prompt"&&cr!==null&&Dt()},{immediate:!0}),watch(()=>$.value,cr=>{var or,hr;cr&&(t.boxType!=="prompt"&&(L.autofocus?ae.value=(hr=(or=de.value)==null?void 0:or.$el)!=null?hr:le.value:ae.value=le.value),L.zIndex=k()),t.boxType==="prompt"&&(cr?nextTick().then(()=>{var pr;qe.value&&qe.value.$el&&(L.autofocus?ae.value=(pr=lr())!=null?pr:le.value:ae.value=le.value)}):(L.editorErrorMessage="",L.validateError=!1))});const ze=computed(()=>t.draggable),$e=computed(()=>t.overflow);useDraggable(le,oe,ze,$e),onMounted(async()=>{await nextTick(),t.closeOnHashChange&&window.addEventListener("hashchange",Lt)}),onBeforeUnmount(()=>{t.closeOnHashChange&&window.removeEventListener("hashchange",Lt)});function Lt(){$.value&&($.value=!1,nextTick(()=>{L.action&&r("action",L.action)}))}const jt=()=>{t.closeOnClickModal&&dr(L.distinguishCancelAndClose?"close":"cancel")},Et=useSameTarget(jt),ir=cr=>{if(L.inputType!=="textarea")return cr.preventDefault(),dr("confirm")},dr=cr=>{var or;t.boxType==="prompt"&&cr==="confirm"&&!Dt()||(L.action=cr,L.beforeClose?(or=L.beforeClose)==null||or.call(L,cr,L,Lt):Lt())},Dt=()=>{if(t.boxType==="prompt"){const cr=L.inputPattern;if(cr&&!cr.test(L.inputValue||""))return L.editorErrorMessage=L.inputErrorMessage||i("el.messagebox.error"),L.validateError=!0,!1;const or=L.inputValidator;if(typeof or=="function"){const hr=or(L.inputValue);if(hr===!1)return L.editorErrorMessage=L.inputErrorMessage||i("el.messagebox.error"),L.validateError=!0,!1;if(typeof hr=="string")return L.editorErrorMessage=hr,L.validateError=!0,!1}}return L.editorErrorMessage="",L.validateError=!1,!0},lr=()=>{const cr=qe.value.$refs;return cr.input||cr.textarea},sr=()=>{dr("close")},er=()=>{t.closeOnPressEscape&&sr()};return t.lockScroll&&useLockscreen($),{...toRefs(L),ns:g,overlayEvent:Et,visible:$,hasMessage:ue,typeClass:V,contentId:z,inputId:re,btnSize:y,iconComponent:ie,confirmButtonClasses:Ne,rootRef:le,focusStartRef:ae,headerRef:oe,inputRef:qe,confirmRef:de,doClose:Lt,handleClose:sr,onCloseRequested:er,handleWrapperClick:jt,handleInputEnter:ir,handleAction:dr,t:i}}}),_hoisted_1$a=["aria-label","aria-describedby"],_hoisted_2$5=["aria-label"],_hoisted_3$5=["id"];function _sfc_render(t,r,e,n,g,y){const i=resolveComponent("el-icon"),k=resolveComponent("close"),$=resolveComponent("el-input"),L=resolveComponent("el-button"),V=resolveComponent("el-focus-trap"),z=resolveComponent("el-overlay");return openBlock(),createBlock(Transition,{name:"fade-in-linear",onAfterLeave:r[11]||(r[11]=re=>t.$emit("vanish")),persisted:""},{default:withCtx(()=>[withDirectives(createVNode(z,{"z-index":t.zIndex,"overlay-class":[t.ns.is("message-box"),t.modalClass],mask:t.modal},{default:withCtx(()=>[createBaseVNode("div",{role:"dialog","aria-label":t.title,"aria-modal":"true","aria-describedby":t.showInput?void 0:t.contentId,class:normalizeClass(`${t.ns.namespace.value}-overlay-message-box`),onClick:r[8]||(r[8]=(...re)=>t.overlayEvent.onClick&&t.overlayEvent.onClick(...re)),onMousedown:r[9]||(r[9]=(...re)=>t.overlayEvent.onMousedown&&t.overlayEvent.onMousedown(...re)),onMouseup:r[10]||(r[10]=(...re)=>t.overlayEvent.onMouseup&&t.overlayEvent.onMouseup(...re))},[createVNode(V,{loop:"",trapped:t.visible,"focus-trap-el":t.rootRef,"focus-start-el":t.focusStartRef,onReleaseRequested:t.onCloseRequested},{default:withCtx(()=>[createBaseVNode("div",{ref:"rootRef",class:normalizeClass([t.ns.b(),t.customClass,t.ns.is("draggable",t.draggable),{[t.ns.m("center")]:t.center}]),style:normalizeStyle(t.customStyle),tabindex:"-1",onClick:r[7]||(r[7]=withModifiers(()=>{},["stop"]))},[t.title!==null&&t.title!==void 0?(openBlock(),createElementBlock("div",{key:0,ref:"headerRef",class:normalizeClass([t.ns.e("header"),{"show-close":t.showClose}])},[createBaseVNode("div",{class:normalizeClass(t.ns.e("title"))},[t.iconComponent&&t.center?(openBlock(),createBlock(i,{key:0,class:normalizeClass([t.ns.e("status"),t.typeClass])},{default:withCtx(()=>[(openBlock(),createBlock(resolveDynamicComponent(t.iconComponent)))]),_:1},8,["class"])):createCommentVNode("v-if",!0),createBaseVNode("span",null,toDisplayString(t.title),1)],2),t.showClose?(openBlock(),createElementBlock("button",{key:0,type:"button",class:normalizeClass(t.ns.e("headerbtn")),"aria-label":t.t("el.messagebox.close"),onClick:r[0]||(r[0]=re=>t.handleAction(t.distinguishCancelAndClose?"close":"cancel")),onKeydown:r[1]||(r[1]=withKeys(withModifiers(re=>t.handleAction(t.distinguishCancelAndClose?"close":"cancel"),["prevent"]),["enter"]))},[createVNode(i,{class:normalizeClass(t.ns.e("close"))},{default:withCtx(()=>[createVNode(k)]),_:1},8,["class"])],42,_hoisted_2$5)):createCommentVNode("v-if",!0)],2)):createCommentVNode("v-if",!0),createBaseVNode("div",{id:t.contentId,class:normalizeClass(t.ns.e("content"))},[createBaseVNode("div",{class:normalizeClass(t.ns.e("container"))},[t.iconComponent&&!t.center&&t.hasMessage?(openBlock(),createBlock(i,{key:0,class:normalizeClass([t.ns.e("status"),t.typeClass])},{default:withCtx(()=>[(openBlock(),createBlock(resolveDynamicComponent(t.iconComponent)))]),_:1},8,["class"])):createCommentVNode("v-if",!0),t.hasMessage?(openBlock(),createElementBlock("div",{key:1,class:normalizeClass(t.ns.e("message"))},[renderSlot(t.$slots,"default",{},()=>[t.dangerouslyUseHTMLString?(openBlock(),createBlock(resolveDynamicComponent(t.showInput?"label":"p"),{key:1,for:t.showInput?t.inputId:void 0,innerHTML:t.message},null,8,["for","innerHTML"])):(openBlock(),createBlock(resolveDynamicComponent(t.showInput?"label":"p"),{key:0,for:t.showInput?t.inputId:void 0},{default:withCtx(()=>[createTextVNode(toDisplayString(t.dangerouslyUseHTMLString?"":t.message),1)]),_:1},8,["for"]))])],2)):createCommentVNode("v-if",!0)],2),withDirectives(createBaseVNode("div",{class:normalizeClass(t.ns.e("input"))},[createVNode($,{id:t.inputId,ref:"inputRef",modelValue:t.inputValue,"onUpdate:modelValue":r[2]||(r[2]=re=>t.inputValue=re),type:t.inputType,placeholder:t.inputPlaceholder,"aria-invalid":t.validateError,class:normalizeClass({invalid:t.validateError}),onKeydown:withKeys(t.handleInputEnter,["enter"])},null,8,["id","modelValue","type","placeholder","aria-invalid","class","onKeydown"]),createBaseVNode("div",{class:normalizeClass(t.ns.e("errormsg")),style:normalizeStyle({visibility:t.editorErrorMessage?"visible":"hidden"})},toDisplayString(t.editorErrorMessage),7)],2),[[vShow,t.showInput]])],10,_hoisted_3$5),createBaseVNode("div",{class:normalizeClass(t.ns.e("btns"))},[t.showCancelButton?(openBlock(),createBlock(L,{key:0,loading:t.cancelButtonLoading,class:normalizeClass([t.cancelButtonClass]),round:t.roundButton,size:t.btnSize,onClick:r[3]||(r[3]=re=>t.handleAction("cancel")),onKeydown:r[4]||(r[4]=withKeys(withModifiers(re=>t.handleAction("cancel"),["prevent"]),["enter"]))},{default:withCtx(()=>[createTextVNode(toDisplayString(t.cancelButtonText||t.t("el.messagebox.cancel")),1)]),_:1},8,["loading","class","round","size"])):createCommentVNode("v-if",!0),withDirectives(createVNode(L,{ref:"confirmRef",type:"primary",loading:t.confirmButtonLoading,class:normalizeClass([t.confirmButtonClasses]),round:t.roundButton,disabled:t.confirmButtonDisabled,size:t.btnSize,onClick:r[5]||(r[5]=re=>t.handleAction("confirm")),onKeydown:r[6]||(r[6]=withKeys(withModifiers(re=>t.handleAction("confirm"),["prevent"]),["enter"]))},{default:withCtx(()=>[createTextVNode(toDisplayString(t.confirmButtonText||t.t("el.messagebox.confirm")),1)]),_:1},8,["loading","class","round","disabled","size"]),[[vShow,t.showConfirmButton]])],2)],6)]),_:3},8,["trapped","focus-trap-el","focus-start-el","onReleaseRequested"])],42,_hoisted_1$a)]),_:3},8,["z-index","overlay-class","mask"]),[[vShow,t.visible]])]),_:3})}var MessageBoxConstructor=_export_sfc$1(_sfc_main$f,[["render",_sfc_render],["__file","index.vue"]]);const messageInstance=new Map,getAppendToElement=t=>{let r=document.body;return t.appendTo&&(isString$2(t.appendTo)&&(r=document.querySelector(t.appendTo)),isElement(t.appendTo)&&(r=t.appendTo),isElement(r)||(r=document.body)),r},initInstance=(t,r,e=null)=>{const n=createVNode(MessageBoxConstructor,t,isFunction$3(t.message)||isVNode(t.message)?{default:isFunction$3(t.message)?t.message:()=>t.message}:null);return n.appContext=e,render(n,r),getAppendToElement(t).appendChild(r.firstElementChild),n.component},genContainer=()=>document.createElement("div"),showMessage=(t,r)=>{const e=genContainer();t.onVanish=()=>{render(null,e),messageInstance.delete(g)},t.onAction=y=>{const i=messageInstance.get(g);let k;t.showInput?k={value:g.inputValue,action:y}:k=y,t.callback?t.callback(k,n.proxy):y==="cancel"||y==="close"?t.distinguishCancelAndClose&&y!=="cancel"?i.reject("close"):i.reject("cancel"):i.resolve(k)};const n=initInstance(t,e,r),g=n.proxy;for(const y in t)hasOwn(t,y)&&!hasOwn(g.$props,y)&&(g[y]=t[y]);return g.visible=!0,g};function MessageBox(t,r=null){if(!isClient)return Promise.reject();let e;return isString$2(t)||isVNode(t)?t={message:t}:e=t.callback,new Promise((n,g)=>{const y=showMessage(t,r??MessageBox._context);messageInstance.set(y,{options:t,callback:e,resolve:n,reject:g})})}const MESSAGE_BOX_VARIANTS=["alert","confirm","prompt"],MESSAGE_BOX_DEFAULT_OPTS={alert:{closeOnPressEscape:!1,closeOnClickModal:!1},confirm:{showCancelButton:!0},prompt:{showCancelButton:!0,showInput:!0}};MESSAGE_BOX_VARIANTS.forEach(t=>{MessageBox[t]=messageBoxFactory(t)});function messageBoxFactory(t){return(r,e,n,g)=>{let y="";return isObject$2(e)?(n=e,y=""):isUndefined$1(e)?y="":y=e,MessageBox(Object.assign({title:y,message:r,type:"",...MESSAGE_BOX_DEFAULT_OPTS[t]},n,{boxType:t}),g)}}MessageBox.close=()=>{messageInstance.forEach((t,r)=>{r.doClose()}),messageInstance.clear()};MessageBox._context=null;const _MessageBox=MessageBox;_MessageBox.install=t=>{_MessageBox._context=t._context,t.config.globalProperties.$msgbox=_MessageBox,t.config.globalProperties.$messageBox=_MessageBox,t.config.globalProperties.$alert=_MessageBox.alert,t.config.globalProperties.$confirm=_MessageBox.confirm,t.config.globalProperties.$prompt=_MessageBox.prompt};const ElMessageBox=_MessageBox,base="",elContainer="",elAside="",elFooter="",elHeader="",elMain="",elCard="",elScrollbar="",elMenu="",elTooltip="",elPopper="",elSubMenu="",elMenuItem="",elIcon="",elDivider="",elRow="",elCol="",_imports_0=""+new URL("rocket.gif",import.meta.url).href,_imports_1=""+new URL("rocket.png",import.meta.url).href,logApi=()=>({add:y=>{try{var i=localStorage.getItem("localLog"),k;return i?k=JSON.parse(i):k=new Array,y.type=="link"&&(y.color="#409eff"),k.push(y),localStorage.setItem("localLog",JSON.stringify(k)),!0}catch{return!1}},addRange:y=>{try{var i=localStorage.getItem("localLog"),k;return i?k=JSON.parse(i):k=new Array,y.forEach($=>k.push($)),localStorage.setItem("localLog",JSON.stringify(k)),!0}catch{return!1}},getLogs:()=>{try{var y=localStorage.getItem("localLog"),i;if(y)i=JSON.parse(y);else return;return i}catch{return}},addSystem:y=>{try{var i=localStorage.getItem("localLog"),k;return i?k=JSON.parse(i):k=new Array,k.push({type:"system",time:new Date().toLocaleString(),content:y}),localStorage.setItem("localLog",JSON.stringify(k)),!0}catch{return!1}},clearLog:()=>{localStorage.removeItem("localLog")}});function bind(t,r){return function(){return t.apply(r,arguments)}}const{toString}=Object.prototype,{getPrototypeOf}=Object,kindOf=(t=>r=>{const e=toString.call(r);return t[e]||(t[e]=e.slice(8,-1).toLowerCase())})(Object.create(null)),kindOfTest=t=>(t=t.toLowerCase(),r=>kindOf(r)===t),typeOfTest=t=>r=>typeof r===t,{isArray}=Array,isUndefined=typeOfTest("undefined");function isBuffer(t){return t!==null&&!isUndefined(t)&&t.constructor!==null&&!isUndefined(t.constructor)&&isFunction(t.constructor.isBuffer)&&t.constructor.isBuffer(t)}const isArrayBuffer=kindOfTest("ArrayBuffer");function isArrayBufferView(t){let r;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?r=ArrayBuffer.isView(t):r=t&&t.buffer&&isArrayBuffer(t.buffer),r}const isString=typeOfTest("string"),isFunction=typeOfTest("function"),isNumber=typeOfTest("number"),isObject=t=>t!==null&&typeof t=="object",isBoolean=t=>t===!0||t===!1,isPlainObject=t=>{if(kindOf(t)!=="object")return!1;const r=getPrototypeOf(t);return(r===null||r===Object.prototype||Object.getPrototypeOf(r)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)},isDate=kindOfTest("Date"),isFile=kindOfTest("File"),isBlob=kindOfTest("Blob"),isFileList=kindOfTest("FileList"),isStream=t=>isObject(t)&&isFunction(t.pipe),isFormData=t=>{let r;return t&&(typeof FormData=="function"&&t instanceof FormData||isFunction(t.append)&&((r=kindOf(t))==="formdata"||r==="object"&&isFunction(t.toString)&&t.toString()==="[object FormData]"))},isURLSearchParams=kindOfTest("URLSearchParams"),trim=t=>t.trim?t.trim():t.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function forEach(t,r,{allOwnKeys:e=!1}={}){if(t===null||typeof t>"u")return;let n,g;if(typeof t!="object"&&(t=[t]),isArray(t))for(n=0,g=t.length;n<g;n++)r.call(null,t[n],n,t);else{const y=e?Object.getOwnPropertyNames(t):Object.keys(t),i=y.length;let k;for(n=0;n<i;n++)k=y[n],r.call(null,t[k],k,t)}}function findKey(t,r){r=r.toLowerCase();const e=Object.keys(t);let n=e.length,g;for(;n-- >0;)if(g=e[n],r===g.toLowerCase())return g;return null}const _global=(()=>typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global)(),isContextDefined=t=>!isUndefined(t)&&t!==_global;function merge(){const{caseless:t}=isContextDefined(this)&&this||{},r={},e=(n,g)=>{const y=t&&findKey(r,g)||g;isPlainObject(r[y])&&isPlainObject(n)?r[y]=merge(r[y],n):isPlainObject(n)?r[y]=merge({},n):isArray(n)?r[y]=n.slice():r[y]=n};for(let n=0,g=arguments.length;n<g;n++)arguments[n]&&forEach(arguments[n],e);return r}const extend=(t,r,e,{allOwnKeys:n}={})=>(forEach(r,(g,y)=>{e&&isFunction(g)?t[y]=bind(g,e):t[y]=g},{allOwnKeys:n}),t),stripBOM=t=>(t.charCodeAt(0)===65279&&(t=t.slice(1)),t),inherits=(t,r,e,n)=>{t.prototype=Object.create(r.prototype,n),t.prototype.constructor=t,Object.defineProperty(t,"super",{value:r.prototype}),e&&Object.assign(t.prototype,e)},toFlatObject=(t,r,e,n)=>{let g,y,i;const k={};if(r=r||{},t==null)return r;do{for(g=Object.getOwnPropertyNames(t),y=g.length;y-- >0;)i=g[y],(!n||n(i,t,r))&&!k[i]&&(r[i]=t[i],k[i]=!0);t=e!==!1&&getPrototypeOf(t)}while(t&&(!e||e(t,r))&&t!==Object.prototype);return r},endsWith=(t,r,e)=>{t=String(t),(e===void 0||e>t.length)&&(e=t.length),e-=r.length;const n=t.indexOf(r,e);return n!==-1&&n===e},toArray=t=>{if(!t)return null;if(isArray(t))return t;let r=t.length;if(!isNumber(r))return null;const e=new Array(r);for(;r-- >0;)e[r]=t[r];return e},isTypedArray=(t=>r=>t&&r instanceof t)(typeof Uint8Array<"u"&&getPrototypeOf(Uint8Array)),forEachEntry=(t,r)=>{const n=(t&&t[Symbol.iterator]).call(t);let g;for(;(g=n.next())&&!g.done;){const y=g.value;r.call(t,y[0],y[1])}},matchAll=(t,r)=>{let e;const n=[];for(;(e=t.exec(r))!==null;)n.push(e);return n},isHTMLForm=kindOfTest("HTMLFormElement"),toCamelCase=t=>t.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(e,n,g){return n.toUpperCase()+g}),hasOwnProperty=(({hasOwnProperty:t})=>(r,e)=>t.call(r,e))(Object.prototype),isRegExp=kindOfTest("RegExp"),reduceDescriptors=(t,r)=>{const e=Object.getOwnPropertyDescriptors(t),n={};forEach(e,(g,y)=>{let i;(i=r(g,y,t))!==!1&&(n[y]=i||g)}),Object.defineProperties(t,n)},freezeMethods=t=>{reduceDescriptors(t,(r,e)=>{if(isFunction(t)&&["arguments","caller","callee"].indexOf(e)!==-1)return!1;const n=t[e];if(isFunction(n)){if(r.enumerable=!1,"writable"in r){r.writable=!1;return}r.set||(r.set=()=>{throw Error("Can not rewrite read-only method '"+e+"'")})}})},toObjectSet=(t,r)=>{const e={},n=g=>{g.forEach(y=>{e[y]=!0})};return isArray(t)?n(t):n(String(t).split(r)),e},noop=()=>{},toFiniteNumber=(t,r)=>(t=+t,Number.isFinite(t)?t:r),ALPHA="abcdefghijklmnopqrstuvwxyz",DIGIT="0123456789",ALPHABET={DIGIT,ALPHA,ALPHA_DIGIT:ALPHA+ALPHA.toUpperCase()+DIGIT},generateString=(t=16,r=ALPHABET.ALPHA_DIGIT)=>{let e="";const{length:n}=r;for(;t--;)e+=r[Math.random()*n|0];return e};function isSpecCompliantForm(t){return!!(t&&isFunction(t.append)&&t[Symbol.toStringTag]==="FormData"&&t[Symbol.iterator])}const toJSONObject=t=>{const r=new Array(10),e=(n,g)=>{if(isObject(n)){if(r.indexOf(n)>=0)return;if(!("toJSON"in n)){r[g]=n;const y=isArray(n)?[]:{};return forEach(n,(i,k)=>{const $=e(i,g+1);!isUndefined($)&&(y[k]=$)}),r[g]=void 0,y}}return n};return e(t,0)},isAsyncFn=kindOfTest("AsyncFunction"),isThenable=t=>t&&(isObject(t)||isFunction(t))&&isFunction(t.then)&&isFunction(t.catch),utils$1={isArray,isArrayBuffer,isBuffer,isFormData,isArrayBufferView,isString,isNumber,isBoolean,isObject,isPlainObject,isUndefined,isDate,isFile,isBlob,isRegExp,isFunction,isStream,isURLSearchParams,isTypedArray,isFileList,forEach,merge,extend,trim,stripBOM,inherits,toFlatObject,kindOf,kindOfTest,endsWith,toArray,forEachEntry,matchAll,isHTMLForm,hasOwnProperty,hasOwnProp:hasOwnProperty,reduceDescriptors,freezeMethods,toObjectSet,toCamelCase,noop,toFiniteNumber,findKey,global:_global,isContextDefined,ALPHABET,generateString,isSpecCompliantForm,toJSONObject,isAsyncFn,isThenable};function AxiosError(t,r,e,n,g){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=t,this.name="AxiosError",r&&(this.code=r),e&&(this.config=e),n&&(this.request=n),g&&(this.response=g)}utils$1.inherits(AxiosError,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:utils$1.toJSONObject(this.config),code:this.code,status:this.response&&this.response.status?this.response.status:null}}});const prototype$1=AxiosError.prototype,descriptors={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(t=>{descriptors[t]={value:t}});Object.defineProperties(AxiosError,descriptors);Object.defineProperty(prototype$1,"isAxiosError",{value:!0});AxiosError.from=(t,r,e,n,g,y)=>{const i=Object.create(prototype$1);return utils$1.toFlatObject(t,i,function($){return $!==Error.prototype},k=>k!=="isAxiosError"),AxiosError.call(i,t.message,r,e,n,g),i.cause=t,i.name=t.name,y&&Object.assign(i,y),i};const httpAdapter=null;function isVisitable(t){return utils$1.isPlainObject(t)||utils$1.isArray(t)}function removeBrackets(t){return utils$1.endsWith(t,"[]")?t.slice(0,-2):t}function renderKey(t,r,e){return t?t.concat(r).map(function(g,y){return g=removeBrackets(g),!e&&y?"["+g+"]":g}).join(e?".":""):r}function isFlatArray(t){return utils$1.isArray(t)&&!t.some(isVisitable)}const predicates=utils$1.toFlatObject(utils$1,{},null,function(r){return/^is[A-Z]/.test(r)});function toFormData(t,r,e){if(!utils$1.isObject(t))throw new TypeError("target must be an object");r=r||new FormData,e=utils$1.toFlatObject(e,{metaTokens:!0,dots:!1,indexes:!1},!1,function(le,oe){return!utils$1.isUndefined(oe[le])});const n=e.metaTokens,g=e.visitor||V,y=e.dots,i=e.indexes,$=(e.Blob||typeof Blob<"u"&&Blob)&&utils$1.isSpecCompliantForm(r);if(!utils$1.isFunction(g))throw new TypeError("visitor must be a function");function L(ue){if(ue===null)return"";if(utils$1.isDate(ue))return ue.toISOString();if(!$&&utils$1.isBlob(ue))throw new AxiosError("Blob is not supported. Use a Buffer instead.");return utils$1.isArrayBuffer(ue)||utils$1.isTypedArray(ue)?$&&typeof Blob=="function"?new Blob([ue]):Buffer.from(ue):ue}function V(ue,le,oe){let ae=ue;if(ue&&!oe&&typeof ue=="object"){if(utils$1.endsWith(le,"{}"))le=n?le:le.slice(0,-2),ue=JSON.stringify(ue);else if(utils$1.isArray(ue)&&isFlatArray(ue)||(utils$1.isFileList(ue)||utils$1.endsWith(le,"[]"))&&(ae=utils$1.toArray(ue)))return le=removeBrackets(le),ae.forEach(function(de,Ne){!(utils$1.isUndefined(de)||de===null)&&r.append(i===!0?renderKey([le],Ne,y):i===null?le:le+"[]",L(de))}),!1}return isVisitable(ue)?!0:(r.append(renderKey(oe,le,y),L(ue)),!1)}const z=[],re=Object.assign(predicates,{defaultVisitor:V,convertValue:L,isVisitable});function ie(ue,le){if(!utils$1.isUndefined(ue)){if(z.indexOf(ue)!==-1)throw Error("Circular reference detected in "+le.join("."));z.push(ue),utils$1.forEach(ue,function(ae,qe){(!(utils$1.isUndefined(ae)||ae===null)&&g.call(r,ae,utils$1.isString(qe)?qe.trim():qe,le,re))===!0&&ie(ae,le?le.concat(qe):[qe])}),z.pop()}}if(!utils$1.isObject(t))throw new TypeError("data must be an object");return ie(t),r}function encode$1(t){const r={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(t).replace(/[!'()~]|%20|%00/g,function(n){return r[n]})}function AxiosURLSearchParams(t,r){this._pairs=[],t&&toFormData(t,this,r)}const prototype=AxiosURLSearchParams.prototype;prototype.append=function(r,e){this._pairs.push([r,e])};prototype.toString=function(r){const e=r?function(n){return r.call(this,n,encode$1)}:encode$1;return this._pairs.map(function(g){return e(g[0])+"="+e(g[1])},"").join("&")};function encode(t){return encodeURIComponent(t).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function buildURL(t,r,e){if(!r)return t;const n=e&&e.encode||encode,g=e&&e.serialize;let y;if(g?y=g(r,e):y=utils$1.isURLSearchParams(r)?r.toString():new AxiosURLSearchParams(r,e).toString(n),y){const i=t.indexOf("#");i!==-1&&(t=t.slice(0,i)),t+=(t.indexOf("?")===-1?"?":"&")+y}return t}class InterceptorManager{constructor(){this.handlers=[]}use(r,e,n){return this.handlers.push({fulfilled:r,rejected:e,synchronous:n?n.synchronous:!1,runWhen:n?n.runWhen:null}),this.handlers.length-1}eject(r){this.handlers[r]&&(this.handlers[r]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(r){utils$1.forEach(this.handlers,function(n){n!==null&&r(n)})}}const InterceptorManager$1=InterceptorManager,transitionalDefaults={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},URLSearchParams$1=typeof URLSearchParams<"u"?URLSearchParams:AxiosURLSearchParams,FormData$1=typeof FormData<"u"?FormData:null,Blob$1=typeof Blob<"u"?Blob:null,platform$1={isBrowser:!0,classes:{URLSearchParams:URLSearchParams$1,FormData:FormData$1,Blob:Blob$1},protocols:["http","https","file","blob","url","data"]},hasBrowserEnv=typeof window<"u"&&typeof document<"u",hasStandardBrowserEnv=(t=>hasBrowserEnv&&["ReactNative","NativeScript","NS"].indexOf(t)<0)(typeof navigator<"u"&&navigator.product),hasStandardBrowserWebWorkerEnv=(()=>typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function")(),utils=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv,hasStandardBrowserEnv,hasStandardBrowserWebWorkerEnv},Symbol.toStringTag,{value:"Module"})),platform={...utils,...platform$1};function toURLEncodedForm(t,r){return toFormData(t,new platform.classes.URLSearchParams,Object.assign({visitor:function(e,n,g,y){return platform.isNode&&utils$1.isBuffer(e)?(this.append(n,e.toString("base64")),!1):y.defaultVisitor.apply(this,arguments)}},r))}function parsePropPath(t){return utils$1.matchAll(/\w+|\[(\w*)]/g,t).map(r=>r[0]==="[]"?"":r[1]||r[0])}function arrayToObject(t){const r={},e=Object.keys(t);let n;const g=e.length;let y;for(n=0;n<g;n++)y=e[n],r[y]=t[y];return r}function formDataToJSON(t){function r(e,n,g,y){let i=e[y++];if(i==="__proto__")return!0;const k=Number.isFinite(+i),$=y>=e.length;return i=!i&&utils$1.isArray(g)?g.length:i,$?(utils$1.hasOwnProp(g,i)?g[i]=[g[i],n]:g[i]=n,!k):((!g[i]||!utils$1.isObject(g[i]))&&(g[i]=[]),r(e,n,g[i],y)&&utils$1.isArray(g[i])&&(g[i]=arrayToObject(g[i])),!k)}if(utils$1.isFormData(t)&&utils$1.isFunction(t.entries)){const e={};return utils$1.forEachEntry(t,(n,g)=>{r(parsePropPath(n),g,e,0)}),e}return null}function stringifySafely(t,r,e){if(utils$1.isString(t))try{return(r||JSON.parse)(t),utils$1.trim(t)}catch(n){if(n.name!=="SyntaxError")throw n}return(e||JSON.stringify)(t)}const defaults={transitional:transitionalDefaults,adapter:["xhr","http"],transformRequest:[function(r,e){const n=e.getContentType()||"",g=n.indexOf("application/json")>-1,y=utils$1.isObject(r);if(y&&utils$1.isHTMLForm(r)&&(r=new FormData(r)),utils$1.isFormData(r))return g?JSON.stringify(formDataToJSON(r)):r;if(utils$1.isArrayBuffer(r)||utils$1.isBuffer(r)||utils$1.isStream(r)||utils$1.isFile(r)||utils$1.isBlob(r))return r;if(utils$1.isArrayBufferView(r))return r.buffer;if(utils$1.isURLSearchParams(r))return e.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),r.toString();let k;if(y){if(n.indexOf("application/x-www-form-urlencoded")>-1)return toURLEncodedForm(r,this.formSerializer).toString();if((k=utils$1.isFileList(r))||n.indexOf("multipart/form-data")>-1){const $=this.env&&this.env.FormData;return toFormData(k?{"files[]":r}:r,$&&new $,this.formSerializer)}}return y||g?(e.setContentType("application/json",!1),stringifySafely(r)):r}],transformResponse:[function(r){const e=this.transitional||defaults.transitional,n=e&&e.forcedJSONParsing,g=this.responseType==="json";if(r&&utils$1.isString(r)&&(n&&!this.responseType||g)){const i=!(e&&e.silentJSONParsing)&&g;try{return JSON.parse(r)}catch(k){if(i)throw k.name==="SyntaxError"?AxiosError.from(k,AxiosError.ERR_BAD_RESPONSE,this,null,this.response):k}}return r}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:platform.classes.FormData,Blob:platform.classes.Blob},validateStatus:function(r){return r>=200&&r<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};utils$1.forEach(["delete","get","head","post","put","patch"],t=>{defaults.headers[t]={}});const defaults$1=defaults,ignoreDuplicateOf=utils$1.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),parseHeaders=t=>{const r={};let e,n,g;return t&&t.split(`
`).forEach(function(i){g=i.indexOf(":"),e=i.substring(0,g).trim().toLowerCase(),n=i.substring(g+1).trim(),!(!e||r[e]&&ignoreDuplicateOf[e])&&(e==="set-cookie"?r[e]?r[e].push(n):r[e]=[n]:r[e]=r[e]?r[e]+", "+n:n)}),r},$internals=Symbol("internals");function normalizeHeader(t){return t&&String(t).trim().toLowerCase()}function normalizeValue(t){return t===!1||t==null?t:utils$1.isArray(t)?t.map(normalizeValue):String(t)}function parseTokens(t){const r=Object.create(null),e=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let n;for(;n=e.exec(t);)r[n[1]]=n[2];return r}const isValidHeaderName=t=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(t.trim());function matchHeaderValue(t,r,e,n,g){if(utils$1.isFunction(n))return n.call(this,r,e);if(g&&(r=e),!!utils$1.isString(r)){if(utils$1.isString(n))return r.indexOf(n)!==-1;if(utils$1.isRegExp(n))return n.test(r)}}function formatHeader(t){return t.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(r,e,n)=>e.toUpperCase()+n)}function buildAccessors(t,r){const e=utils$1.toCamelCase(" "+r);["get","set","has"].forEach(n=>{Object.defineProperty(t,n+e,{value:function(g,y,i){return this[n].call(this,r,g,y,i)},configurable:!0})})}class AxiosHeaders{constructor(r){r&&this.set(r)}set(r,e,n){const g=this;function y(k,$,L){const V=normalizeHeader($);if(!V)throw new Error("header name must be a non-empty string");const z=utils$1.findKey(g,V);(!z||g[z]===void 0||L===!0||L===void 0&&g[z]!==!1)&&(g[z||$]=normalizeValue(k))}const i=(k,$)=>utils$1.forEach(k,(L,V)=>y(L,V,$));return utils$1.isPlainObject(r)||r instanceof this.constructor?i(r,e):utils$1.isString(r)&&(r=r.trim())&&!isValidHeaderName(r)?i(parseHeaders(r),e):r!=null&&y(e,r,n),this}get(r,e){if(r=normalizeHeader(r),r){const n=utils$1.findKey(this,r);if(n){const g=this[n];if(!e)return g;if(e===!0)return parseTokens(g);if(utils$1.isFunction(e))return e.call(this,g,n);if(utils$1.isRegExp(e))return e.exec(g);throw new TypeError("parser must be boolean|regexp|function")}}}has(r,e){if(r=normalizeHeader(r),r){const n=utils$1.findKey(this,r);return!!(n&&this[n]!==void 0&&(!e||matchHeaderValue(this,this[n],n,e)))}return!1}delete(r,e){const n=this;let g=!1;function y(i){if(i=normalizeHeader(i),i){const k=utils$1.findKey(n,i);k&&(!e||matchHeaderValue(n,n[k],k,e))&&(delete n[k],g=!0)}}return utils$1.isArray(r)?r.forEach(y):y(r),g}clear(r){const e=Object.keys(this);let n=e.length,g=!1;for(;n--;){const y=e[n];(!r||matchHeaderValue(this,this[y],y,r,!0))&&(delete this[y],g=!0)}return g}normalize(r){const e=this,n={};return utils$1.forEach(this,(g,y)=>{const i=utils$1.findKey(n,y);if(i){e[i]=normalizeValue(g),delete e[y];return}const k=r?formatHeader(y):String(y).trim();k!==y&&delete e[y],e[k]=normalizeValue(g),n[k]=!0}),this}concat(...r){return this.constructor.concat(this,...r)}toJSON(r){const e=Object.create(null);return utils$1.forEach(this,(n,g)=>{n!=null&&n!==!1&&(e[g]=r&&utils$1.isArray(n)?n.join(", "):n)}),e}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([r,e])=>r+": "+e).join(`
`)}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(r){return r instanceof this?r:new this(r)}static concat(r,...e){const n=new this(r);return e.forEach(g=>n.set(g)),n}static accessor(r){const n=(this[$internals]=this[$internals]={accessors:{}}).accessors,g=this.prototype;function y(i){const k=normalizeHeader(i);n[k]||(buildAccessors(g,i),n[k]=!0)}return utils$1.isArray(r)?r.forEach(y):y(r),this}}AxiosHeaders.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);utils$1.reduceDescriptors(AxiosHeaders.prototype,({value:t},r)=>{let e=r[0].toUpperCase()+r.slice(1);return{get:()=>t,set(n){this[e]=n}}});utils$1.freezeMethods(AxiosHeaders);const AxiosHeaders$1=AxiosHeaders;function transformData(t,r){const e=this||defaults$1,n=r||e,g=AxiosHeaders$1.from(n.headers);let y=n.data;return utils$1.forEach(t,function(k){y=k.call(e,y,g.normalize(),r?r.status:void 0)}),g.normalize(),y}function isCancel(t){return!!(t&&t.__CANCEL__)}function CanceledError(t,r,e){AxiosError.call(this,t??"canceled",AxiosError.ERR_CANCELED,r,e),this.name="CanceledError"}utils$1.inherits(CanceledError,AxiosError,{__CANCEL__:!0});function settle(t,r,e){const n=e.config.validateStatus;!e.status||!n||n(e.status)?t(e):r(new AxiosError("Request failed with status code "+e.status,[AxiosError.ERR_BAD_REQUEST,AxiosError.ERR_BAD_RESPONSE][Math.floor(e.status/100)-4],e.config,e.request,e))}const cookies=platform.hasStandardBrowserEnv?{write(t,r,e,n,g,y){const i=[t+"="+encodeURIComponent(r)];utils$1.isNumber(e)&&i.push("expires="+new Date(e).toGMTString()),utils$1.isString(n)&&i.push("path="+n),utils$1.isString(g)&&i.push("domain="+g),y===!0&&i.push("secure"),document.cookie=i.join("; ")},read(t){const r=document.cookie.match(new RegExp("(^|;\\s*)("+t+")=([^;]*)"));return r?decodeURIComponent(r[3]):null},remove(t){this.write(t,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function isAbsoluteURL(t){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(t)}function combineURLs(t,r){return r?t.replace(/\/?\/$/,"")+"/"+r.replace(/^\/+/,""):t}function buildFullPath(t,r){return t&&!isAbsoluteURL(r)?combineURLs(t,r):r}const isURLSameOrigin=platform.hasStandardBrowserEnv?function(){const r=/(msie|trident)/i.test(navigator.userAgent),e=document.createElement("a");let n;function g(y){let i=y;return r&&(e.setAttribute("href",i),i=e.href),e.setAttribute("href",i),{href:e.href,protocol:e.protocol?e.protocol.replace(/:$/,""):"",host:e.host,search:e.search?e.search.replace(/^\?/,""):"",hash:e.hash?e.hash.replace(/^#/,""):"",hostname:e.hostname,port:e.port,pathname:e.pathname.charAt(0)==="/"?e.pathname:"/"+e.pathname}}return n=g(window.location.href),function(i){const k=utils$1.isString(i)?g(i):i;return k.protocol===n.protocol&&k.host===n.host}}():function(){return function(){return!0}}();function parseProtocol(t){const r=/^([-+\w]{1,25})(:?\/\/|:)/.exec(t);return r&&r[1]||""}function speedometer(t,r){t=t||10;const e=new Array(t),n=new Array(t);let g=0,y=0,i;return r=r!==void 0?r:1e3,function($){const L=Date.now(),V=n[y];i||(i=L),e[g]=$,n[g]=L;let z=y,re=0;for(;z!==g;)re+=e[z++],z=z%t;if(g=(g+1)%t,g===y&&(y=(y+1)%t),L-i<r)return;const ie=V&&L-V;return ie?Math.round(re*1e3/ie):void 0}}function progressEventReducer(t,r){let e=0;const n=speedometer(50,250);return g=>{const y=g.loaded,i=g.lengthComputable?g.total:void 0,k=y-e,$=n(k),L=y<=i;e=y;const V={loaded:y,total:i,progress:i?y/i:void 0,bytes:k,rate:$||void 0,estimated:$&&i&&L?(i-y)/$:void 0,event:g};V[r?"download":"upload"]=!0,t(V)}}const isXHRAdapterSupported=typeof XMLHttpRequest<"u",xhrAdapter=isXHRAdapterSupported&&function(t){return new Promise(function(e,n){let g=t.data;const y=AxiosHeaders$1.from(t.headers).normalize();let{responseType:i,withXSRFToken:k}=t,$;function L(){t.cancelToken&&t.cancelToken.unsubscribe($),t.signal&&t.signal.removeEventListener("abort",$)}let V;if(utils$1.isFormData(g)){if(platform.hasStandardBrowserEnv||platform.hasStandardBrowserWebWorkerEnv)y.setContentType(!1);else if((V=y.getContentType())!==!1){const[le,...oe]=V?V.split(";").map(ae=>ae.trim()).filter(Boolean):[];y.setContentType([le||"multipart/form-data",...oe].join("; "))}}let z=new XMLHttpRequest;if(t.auth){const le=t.auth.username||"",oe=t.auth.password?unescape(encodeURIComponent(t.auth.password)):"";y.set("Authorization","Basic "+btoa(le+":"+oe))}const re=buildFullPath(t.baseURL,t.url);z.open(t.method.toUpperCase(),buildURL(re,t.params,t.paramsSerializer),!0),z.timeout=t.timeout;function ie(){if(!z)return;const le=AxiosHeaders$1.from("getAllResponseHeaders"in z&&z.getAllResponseHeaders()),ae={data:!i||i==="text"||i==="json"?z.responseText:z.response,status:z.status,statusText:z.statusText,headers:le,config:t,request:z};settle(function(de){e(de),L()},function(de){n(de),L()},ae),z=null}if("onloadend"in z?z.onloadend=ie:z.onreadystatechange=function(){!z||z.readyState!==4||z.status===0&&!(z.responseURL&&z.responseURL.indexOf("file:")===0)||setTimeout(ie)},z.onabort=function(){z&&(n(new AxiosError("Request aborted",AxiosError.ECONNABORTED,t,z)),z=null)},z.onerror=function(){n(new AxiosError("Network Error",AxiosError.ERR_NETWORK,t,z)),z=null},z.ontimeout=function(){let oe=t.timeout?"timeout of "+t.timeout+"ms exceeded":"timeout exceeded";const ae=t.transitional||transitionalDefaults;t.timeoutErrorMessage&&(oe=t.timeoutErrorMessage),n(new AxiosError(oe,ae.clarifyTimeoutError?AxiosError.ETIMEDOUT:AxiosError.ECONNABORTED,t,z)),z=null},platform.hasStandardBrowserEnv&&(k&&utils$1.isFunction(k)&&(k=k(t)),k||k!==!1&&isURLSameOrigin(re))){const le=t.xsrfHeaderName&&t.xsrfCookieName&&cookies.read(t.xsrfCookieName);le&&y.set(t.xsrfHeaderName,le)}g===void 0&&y.setContentType(null),"setRequestHeader"in z&&utils$1.forEach(y.toJSON(),function(oe,ae){z.setRequestHeader(ae,oe)}),utils$1.isUndefined(t.withCredentials)||(z.withCredentials=!!t.withCredentials),i&&i!=="json"&&(z.responseType=t.responseType),typeof t.onDownloadProgress=="function"&&z.addEventListener("progress",progressEventReducer(t.onDownloadProgress,!0)),typeof t.onUploadProgress=="function"&&z.upload&&z.upload.addEventListener("progress",progressEventReducer(t.onUploadProgress)),(t.cancelToken||t.signal)&&($=le=>{z&&(n(!le||le.type?new CanceledError(null,t,z):le),z.abort(),z=null)},t.cancelToken&&t.cancelToken.subscribe($),t.signal&&(t.signal.aborted?$():t.signal.addEventListener("abort",$)));const ue=parseProtocol(re);if(ue&&platform.protocols.indexOf(ue)===-1){n(new AxiosError("Unsupported protocol "+ue+":",AxiosError.ERR_BAD_REQUEST,t));return}z.send(g||null)})},knownAdapters={http:httpAdapter,xhr:xhrAdapter};utils$1.forEach(knownAdapters,(t,r)=>{if(t){try{Object.defineProperty(t,"name",{value:r})}catch{}Object.defineProperty(t,"adapterName",{value:r})}});const renderReason=t=>`- ${t}`,isResolvedHandle=t=>utils$1.isFunction(t)||t===null||t===!1,adapters={getAdapter:t=>{t=utils$1.isArray(t)?t:[t];const{length:r}=t;let e,n;const g={};for(let y=0;y<r;y++){e=t[y];let i;if(n=e,!isResolvedHandle(e)&&(n=knownAdapters[(i=String(e)).toLowerCase()],n===void 0))throw new AxiosError(`Unknown adapter '${i}'`);if(n)break;g[i||"#"+y]=n}if(!n){const y=Object.entries(g).map(([k,$])=>`adapter ${k} `+($===!1?"is not supported by the environment":"is not available in the build"));let i=r?y.length>1?`since :
`+y.map(renderReason).join(`
`):" "+renderReason(y[0]):"as no adapter specified";throw new AxiosError("There is no suitable adapter to dispatch the request "+i,"ERR_NOT_SUPPORT")}return n},adapters:knownAdapters};function throwIfCancellationRequested(t){if(t.cancelToken&&t.cancelToken.throwIfRequested(),t.signal&&t.signal.aborted)throw new CanceledError(null,t)}function dispatchRequest(t){return throwIfCancellationRequested(t),t.headers=AxiosHeaders$1.from(t.headers),t.data=transformData.call(t,t.transformRequest),["post","put","patch"].indexOf(t.method)!==-1&&t.headers.setContentType("application/x-www-form-urlencoded",!1),adapters.getAdapter(t.adapter||defaults$1.adapter)(t).then(function(n){return throwIfCancellationRequested(t),n.data=transformData.call(t,t.transformResponse,n),n.headers=AxiosHeaders$1.from(n.headers),n},function(n){return isCancel(n)||(throwIfCancellationRequested(t),n&&n.response&&(n.response.data=transformData.call(t,t.transformResponse,n.response),n.response.headers=AxiosHeaders$1.from(n.response.headers))),Promise.reject(n)})}const headersToObject=t=>t instanceof AxiosHeaders$1?t.toJSON():t;function mergeConfig(t,r){r=r||{};const e={};function n(L,V,z){return utils$1.isPlainObject(L)&&utils$1.isPlainObject(V)?utils$1.merge.call({caseless:z},L,V):utils$1.isPlainObject(V)?utils$1.merge({},V):utils$1.isArray(V)?V.slice():V}function g(L,V,z){if(utils$1.isUndefined(V)){if(!utils$1.isUndefined(L))return n(void 0,L,z)}else return n(L,V,z)}function y(L,V){if(!utils$1.isUndefined(V))return n(void 0,V)}function i(L,V){if(utils$1.isUndefined(V)){if(!utils$1.isUndefined(L))return n(void 0,L)}else return n(void 0,V)}function k(L,V,z){if(z in r)return n(L,V);if(z in t)return n(void 0,L)}const $={url:y,method:y,data:y,baseURL:i,transformRequest:i,transformResponse:i,paramsSerializer:i,timeout:i,timeoutMessage:i,withCredentials:i,withXSRFToken:i,adapter:i,responseType:i,xsrfCookieName:i,xsrfHeaderName:i,onUploadProgress:i,onDownloadProgress:i,decompress:i,maxContentLength:i,maxBodyLength:i,beforeRedirect:i,transport:i,httpAgent:i,httpsAgent:i,cancelToken:i,socketPath:i,responseEncoding:i,validateStatus:k,headers:(L,V)=>g(headersToObject(L),headersToObject(V),!0)};return utils$1.forEach(Object.keys(Object.assign({},t,r)),function(V){const z=$[V]||g,re=z(t[V],r[V],V);utils$1.isUndefined(re)&&z!==k||(e[V]=re)}),e}const VERSION="1.6.7",validators$1={};["object","boolean","number","function","string","symbol"].forEach((t,r)=>{validators$1[t]=function(n){return typeof n===t||"a"+(r<1?"n ":" ")+t}});const deprecatedWarnings={};validators$1.transitional=function(r,e,n){function g(y,i){return"[Axios v"+VERSION+"] Transitional option '"+y+"'"+i+(n?". "+n:"")}return(y,i,k)=>{if(r===!1)throw new AxiosError(g(i," has been removed"+(e?" in "+e:"")),AxiosError.ERR_DEPRECATED);return e&&!deprecatedWarnings[i]&&(deprecatedWarnings[i]=!0,console.warn(g(i," has been deprecated since v"+e+" and will be removed in the near future"))),r?r(y,i,k):!0}};function assertOptions(t,r,e){if(typeof t!="object")throw new AxiosError("options must be an object",AxiosError.ERR_BAD_OPTION_VALUE);const n=Object.keys(t);let g=n.length;for(;g-- >0;){const y=n[g],i=r[y];if(i){const k=t[y],$=k===void 0||i(k,y,t);if($!==!0)throw new AxiosError("option "+y+" must be "+$,AxiosError.ERR_BAD_OPTION_VALUE);continue}if(e!==!0)throw new AxiosError("Unknown option "+y,AxiosError.ERR_BAD_OPTION)}}const validator={assertOptions,validators:validators$1},validators=validator.validators;class Axios{constructor(r){this.defaults=r,this.interceptors={request:new InterceptorManager$1,response:new InterceptorManager$1}}async request(r,e){try{return await this._request(r,e)}catch(n){if(n instanceof Error){let g;Error.captureStackTrace?Error.captureStackTrace(g={}):g=new Error;const y=g.stack?g.stack.replace(/^.+\n/,""):"";n.stack?y&&!String(n.stack).endsWith(y.replace(/^.+\n.+\n/,""))&&(n.stack+=`
`+y):n.stack=y}throw n}}_request(r,e){typeof r=="string"?(e=e||{},e.url=r):e=r||{},e=mergeConfig(this.defaults,e);const{transitional:n,paramsSerializer:g,headers:y}=e;n!==void 0&&validator.assertOptions(n,{silentJSONParsing:validators.transitional(validators.boolean),forcedJSONParsing:validators.transitional(validators.boolean),clarifyTimeoutError:validators.transitional(validators.boolean)},!1),g!=null&&(utils$1.isFunction(g)?e.paramsSerializer={serialize:g}:validator.assertOptions(g,{encode:validators.function,serialize:validators.function},!0)),e.method=(e.method||this.defaults.method||"get").toLowerCase();let i=y&&utils$1.merge(y.common,y[e.method]);y&&utils$1.forEach(["delete","get","head","post","put","patch","common"],ue=>{delete y[ue]}),e.headers=AxiosHeaders$1.concat(i,y);const k=[];let $=!0;this.interceptors.request.forEach(function(le){typeof le.runWhen=="function"&&le.runWhen(e)===!1||($=$&&le.synchronous,k.unshift(le.fulfilled,le.rejected))});const L=[];this.interceptors.response.forEach(function(le){L.push(le.fulfilled,le.rejected)});let V,z=0,re;if(!$){const ue=[dispatchRequest.bind(this),void 0];for(ue.unshift.apply(ue,k),ue.push.apply(ue,L),re=ue.length,V=Promise.resolve(e);z<re;)V=V.then(ue[z++],ue[z++]);return V}re=k.length;let ie=e;for(z=0;z<re;){const ue=k[z++],le=k[z++];try{ie=ue(ie)}catch(oe){le.call(this,oe);break}}try{V=dispatchRequest.call(this,ie)}catch(ue){return Promise.reject(ue)}for(z=0,re=L.length;z<re;)V=V.then(L[z++],L[z++]);return V}getUri(r){r=mergeConfig(this.defaults,r);const e=buildFullPath(r.baseURL,r.url);return buildURL(e,r.params,r.paramsSerializer)}}utils$1.forEach(["delete","get","head","options"],function(r){Axios.prototype[r]=function(e,n){return this.request(mergeConfig(n||{},{method:r,url:e,data:(n||{}).data}))}});utils$1.forEach(["post","put","patch"],function(r){function e(n){return function(y,i,k){return this.request(mergeConfig(k||{},{method:r,headers:n?{"Content-Type":"multipart/form-data"}:{},url:y,data:i}))}}Axios.prototype[r]=e(),Axios.prototype[r+"Form"]=e(!0)});const Axios$1=Axios;class CancelToken{constructor(r){if(typeof r!="function")throw new TypeError("executor must be a function.");let e;this.promise=new Promise(function(y){e=y});const n=this;this.promise.then(g=>{if(!n._listeners)return;let y=n._listeners.length;for(;y-- >0;)n._listeners[y](g);n._listeners=null}),this.promise.then=g=>{let y;const i=new Promise(k=>{n.subscribe(k),y=k}).then(g);return i.cancel=function(){n.unsubscribe(y)},i},r(function(y,i,k){n.reason||(n.reason=new CanceledError(y,i,k),e(n.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(r){if(this.reason){r(this.reason);return}this._listeners?this._listeners.push(r):this._listeners=[r]}unsubscribe(r){if(!this._listeners)return;const e=this._listeners.indexOf(r);e!==-1&&this._listeners.splice(e,1)}static source(){let r;return{token:new CancelToken(function(g){r=g}),cancel:r}}}const CancelToken$1=CancelToken;function spread(t){return function(e){return t.apply(null,e)}}function isAxiosError(t){return utils$1.isObject(t)&&t.isAxiosError===!0}const HttpStatusCode={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(HttpStatusCode).forEach(([t,r])=>{HttpStatusCode[r]=t});const HttpStatusCode$1=HttpStatusCode;function createInstance(t){const r=new Axios$1(t),e=bind(Axios$1.prototype.request,r);return utils$1.extend(e,Axios$1.prototype,r,{allOwnKeys:!0}),utils$1.extend(e,r,null,{allOwnKeys:!0}),e.create=function(g){return createInstance(mergeConfig(t,g))},e}const axios=createInstance(defaults$1);axios.Axios=Axios$1;axios.CanceledError=CanceledError;axios.CancelToken=CancelToken$1;axios.isCancel=isCancel;axios.VERSION=VERSION;axios.toFormData=toFormData;axios.AxiosError=AxiosError;axios.Cancel=axios.CanceledError;axios.all=function(r){return Promise.all(r)};axios.spread=spread;axios.isAxiosError=isAxiosError;axios.mergeConfig=mergeConfig;axios.AxiosHeaders=AxiosHeaders$1;axios.formToJSON=t=>formDataToJSON(utils$1.isHTMLForm(t)?new FormData(t):t);axios.getAdapter=adapters.getAdapter;axios.HttpStatusCode=HttpStatusCode$1;axios.default=axios;const axios$1=axios,_port=sessionStorage.getItem("HttpPort")||52066,_baseUrl=`http://127.0.0.1:${_port}/api/v1`,ApiPrefix=_baseUrl,startBot=async(t=!0)=>(await axios$1.get(`${_baseUrl}/startbot?botReady=${t}`)).data,getConfig=async()=>(await axios$1.get(`${_baseUrl}/getconfig`)).data,saveConfig=async t=>(await axios$1.post(`${_baseUrl}/saveconfig`,t)).data,postMsg=async(t,r=0)=>(await axios$1.post(`${_baseUrl}/postmsg?type=`+r,t)).data,getCache=async()=>(await axios$1.get(`${_baseUrl}/getCache`)).data,saveImg=async t=>(await axios$1.get(`${_baseUrl}/saveimg/${t}`)).data,delImg=async t=>(await axios$1.get(`${_baseUrl}/delimg/${t}`)).data,getFun=async()=>(await axios$1.get(`${_baseUrl}/getfun`)).data,startPlugin=async t=>(await axios$1.get(`${_baseUrl}/startplugin?name=${t}`)).data,stopPlugin=async t=>(await axios$1.get(`${_baseUrl}/stopplugin?name=${t}`)).data,delPlugin=async t=>(await axios$1.get(`${_baseUrl}/delplugin?name=${t}`)).data,searchIdol=async(t,r)=>(await axios$1.get(`${_baseUrl}/searchidol?group=${t}&name=${r}`)).data,sendSmsCode=async(t,r="86")=>(await axios$1.get(`${_baseUrl}/sendsmscode?mobile=${t}&area=${r}`)).data,pocketLogin=async(t,r)=>(await axios$1.get(`${_baseUrl}/pocketlogin?mobile=${t}&code=${r}`)).data,kdUserInfo=async t=>(await axios$1.post(`${_baseUrl}/kduserinfo`,t)).data,openWindow=async t=>(await axios$1.get(`${_baseUrl}/openwindow?url=${t}`)).data,getLogs=async()=>(await axios$1.get(`${_baseUrl}/getlogs`)).data;var NIM_Web_SDK={exports:{}};/*!
 * 
 * VERSION: 9.14.4
 * Git Hash: 98d1c9786af772ff439f12534089825e2c3c6776
 * 
 * Create At: 2024/2/23 下午3:43:35
 * 
 * Target: NIM_Web_SDK
 */(function(module,exports){(function(t,r){module.exports=r()})(window,function(){return function(t){var r={};function e(n){if(r[n])return r[n].exports;var g=r[n]={i:n,l:!1,exports:{}};return t[n].call(g.exports,g,g.exports,e),g.l=!0,g.exports}return e.m=t,e.c=r,e.d=function(n,g,y){e.o(n,g)||Object.defineProperty(n,g,{enumerable:!0,get:y})},e.r=function(n){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(n,"__esModule",{value:!0})},e.t=function(n,g){if(1&g&&(n=e(n)),8&g||4&g&&typeof n=="object"&&n&&n.__esModule)return n;var y=Object.create(null);if(e.r(y),Object.defineProperty(y,"default",{enumerable:!0,value:n}),2&g&&typeof n!="string")for(var i in n)e.d(y,i,(function(k){return n[k]}).bind(null,i));return y},e.n=function(n){var g=n&&n.__esModule?function(){return n.default}:function(){return n};return e.d(g,"a",g),g},e.o=function(n,g){return Object.prototype.hasOwnProperty.call(n,g)},e.p="",e(e.s=916)}([function(t,r,e){var n=e(51),g=e(2),y=e(7),i=e(15),k=e(4),$=e(121),L=e(71),V=e(122),z=e(32),re=e(6),ie=e(9),ue=e(8),le=e(123),oe=e(141),ae=e(24),qe=e(16),de=e(462),Ne=e(466),ze=e(3),$e=e(88),Lt=e(89),jt=e(72),Et=e(52),ir=e(53),dr=e(54),Dt=e(55),lr=e(43),sr=e(22);function er(Mr,yr){var mr=k(Mr);if(Et){var Tr=Et(Mr);yr&&(Tr=qe(Tr).call(Tr,function(Br){return ir(Mr,Br).enumerable})),mr.push.apply(mr,Tr)}return mr}function cr(Mr,yr){var mr=Lt!==void 0&&jt(Mr)||Mr["@@iterator"];if(!mr){if(z(Mr)||(mr=function(qr,Yr){var bn;if(qr){if(typeof qr=="string")return or(qr,Yr);var wn=i(bn=Object.prototype.toString.call(qr)).call(bn,8,-1);if(wn==="Object"&&qr.constructor&&(wn=qr.constructor.name),wn==="Map"||wn==="Set")return $e(qr);if(wn==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(wn))return or(qr,Yr)}}(Mr))||yr&&Mr&&typeof Mr.length=="number"){mr&&(Mr=mr);var Tr=0,Br=function(){};return{s:Br,n:function(){return Tr>=Mr.length?{done:!0}:{done:!1,value:Mr[Tr++]}},e:function(qr){throw qr},f:Br}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var $r,Lr=!0,Gr=!1;return{s:function(){mr=mr.call(Mr)},n:function(){var qr=mr.next();return Lr=qr.done,qr},e:function(qr){Gr=!0,$r=qr},f:function(){try{Lr||mr.return==null||mr.return()}finally{if(Gr)throw $r}}}}function or(Mr,yr){(yr==null||yr>Mr.length)&&(yr=Mr.length);for(var mr=0,Tr=new Array(yr);mr<yr;mr++)Tr[mr]=Mr[mr];return Tr}var hr=e(256),pr=e(200);function Sr(Mr){sr(Mr)==="object"?(this.callFunc=Mr.callFunc||null,this.message=Mr.message||"UNKNOW ERROR"):this.message=Mr,this.time=new Date,this.timetag=+this.time}e(490);var Er,Pr,Cr=e(62),rr=Cr.getGlobal(),kr=/\s+/;Cr.deduplicate=function(Mr){var yr=[];return g(Mr).call(Mr,function(mr){y(yr).call(yr,mr)===-1&&yr.push(mr)}),yr},Cr.capFirstLetter=function(Mr){return Mr?i(Mr=""+Mr).call(Mr,0,1).toUpperCase()+i(Mr).call(Mr,1):""},Cr.guid=(Er=function(){return(65536*(1+Math.random())|0).toString(16).substring(1)},function(){return Er()+Er()+Er()+Er()+Er()+Er()+Er()+Er()}),Cr.extend=function(Mr,yr,mr){for(var Tr in yr)Mr[Tr]!==void 0&&mr!==!0||(Mr[Tr]=yr[Tr])},Cr.filterObj=function(Mr,yr){var mr={};return Cr.isString(yr)&&(yr=yr.split(kr)),g(yr).call(yr,function(Tr){Mr.hasOwnProperty(Tr)&&(mr[Tr]=Mr[Tr])}),mr},Cr.copy=function(Mr,yr){var mr;return yr=yr||{},Mr&&g(mr=k(Mr)).call(mr,function(Tr){Cr.exist(Mr[Tr])&&(yr[Tr]=Mr[Tr])}),yr},Cr.copyWithNull=function(Mr,yr){var mr;return yr=yr||{},Mr&&g(mr=k(Mr)).call(mr,function(Tr){(Cr.exist(Mr[Tr])||Cr.isnull(Mr[Tr]))&&(yr[Tr]=Mr[Tr])}),yr},Cr.findObjIndexInArray=function(Mr,yr){Mr=Mr||[];var mr=yr.keyPath||"id",Tr=-1;return $(Mr).call(Mr,function(Br,$r){if(pr(Br,mr)===yr.value)return Tr=$r,!0}),Tr},Cr.findObjInArray=function(Mr,yr){var mr=Cr.findObjIndexInArray(Mr,yr);return mr===-1?null:Mr[mr]},Cr.mergeObjArray=function(){var Mr=[],yr=i([]).call(arguments,0,-1),mr=arguments[arguments.length-1];Cr.isArray(mr)&&(yr.push(mr),mr={});var Tr,Br=mr.keyPath=mr.keyPath||"id";for(mr.sortPath=mr.sortPath||Br;!Mr.length&&yr.length;)Mr=yr.shift()||[],Mr=i(Mr).call(Mr,0);return g(yr).call(yr,function($r){$r&&g($r).call($r,function(Lr){(Tr=Cr.findObjIndexInArray(Mr,{keyPath:Br,value:pr(Lr,Br)}))!==-1?Mr[Tr]=Cr.merge({},Mr[Tr],Lr):Mr.push(Lr)})}),mr.notSort||(Mr=Cr.sortObjArray(Mr,mr)),Mr},Cr.cutObjArray=function(Mr){var yr=i(Mr).call(Mr,0),mr=arguments.length,Tr=i([]).call(arguments,1,mr-1),Br=arguments[mr-1];Cr.isObject(Br)||(Tr.push(Br),Br={});var $r,Lr=Br.keyPath=Br.keyPath||"id";return g(Tr).call(Tr,function(Gr){Cr.isArray(Gr)||(Gr=[Gr]),g(Gr).call(Gr,function(qr){qr&&(Br.value=pr(qr,Lr),($r=Cr.findObjIndexInArray(yr,Br))!==-1&&L(yr).call(yr,$r,1))})}),yr},Cr.sortObjArray=function(Mr,yr){var mr=(yr=yr||{}).sortPath||"id";hr.insensitive=!!yr.insensitive;var Tr,Br,$r,Lr=!!yr.desc;return $r=Cr.isFunction(yr.compare)?yr.compare:function(Gr,qr){return Tr=pr(Gr,mr),Br=pr(qr,mr),Lr?hr(Br,Tr):hr(Tr,Br)},V(Mr).call(Mr,$r)},Cr.emptyFunc=function(){},Cr.isEmptyFunc=function(Mr){return Mr===Cr.emptyFunc},Cr.notEmptyFunc=function(Mr){return Mr!==Cr.emptyFunc},Cr.splice=function(Mr,yr,mr){return L([]).call(Mr,yr,mr)},Cr.reshape2d=function(Mr,yr){if(z(Mr)){Cr.verifyParamType("type",yr,"number","util::reshape2d");var mr=Mr.length;if(mr<=yr)return[Mr];for(var Tr=Math.ceil(mr/yr),Br=[],$r=0;$r<Tr;$r++)Br.push(i(Mr).call(Mr,$r*yr,($r+1)*yr));return Br}return Mr},Cr.flatten2d=function(Mr){if(z(Mr)){var yr=[];return g(Mr).call(Mr,function(mr){yr=re(yr).call(yr,mr)}),yr}return Mr},Cr.dropArrayDuplicates=function(Mr){if(z(Mr)){for(var yr={},mr=[];Mr.length>0;)yr[Mr.shift()]=!0;for(var Tr in yr)yr[Tr]===!0&&mr.push(Tr);return mr}return Mr},Cr.onError=function(Mr){throw new Sr(Mr)},Cr.verifyParamPresent=function(Mr,yr,mr,Tr){mr=mr||"";var Br=!1;switch(Cr.typeOf(yr)){case"undefined":case"null":Br=!0;break;case"string":yr===""&&(Br=!0);break;case"StrStrMap":case"object":k(yr).length||(Br=!0);break;case"array":yr.length?$(yr).call(yr,function($r){if(Cr.notexist($r))return Br=!0,!0}):Br=!0}Br&&Cr.onParamAbsent(mr+Mr,Tr)},Cr.onParamAbsent=function(Mr,yr){Cr.onParamError("缺少参数 ".concat(Mr,", 请确保参数不是 空字符串、空对象、空数组、null或undefined, 或数组的内容不是 null/undefined"),yr)},Cr.verifyParamAbsent=function(Mr,yr,mr,Tr){mr=mr||"",yr!==void 0&&Cr.onParamPresent(mr+Mr,Tr)},Cr.onParamPresent=function(Mr,yr){Cr.onParamError("多余的参数 ".concat(Mr),yr)},Cr.verifyParamType=function(Mr,yr,mr,Tr){var Br=Cr.typeOf(yr).toLowerCase();Cr.isArray(mr)||(mr=[mr]),mr=ie(mr).call(mr,function(Lr){return Lr.toLowerCase()});var $r=!0;switch(y(mr).call(mr,Br)===-1&&($r=!1),Br){case"number":isNaN(yr)&&($r=!1);break;case"string":mr.join("")==="numeric or numeric string"&&($r=!!/^[0-9]+$/.test(yr))}$r||Cr.onParamInvalidType(Mr,mr,"",Tr)},Cr.onParamInvalidType=function(Mr,yr,mr,Tr){mr=mr||"",yr=Cr.isArray(yr)?(yr=ie(yr).call(yr,function(Br){return'"'+Br+'"'})).join(", "):'"'+yr+'"',Cr.onParamError('参数"'+mr+Mr+'"类型错误, 合法的类型包括: ['+yr+"]",Tr)},Cr.verifyParamValid=function(Mr,yr,mr,Tr){Cr.isArray(mr)||(mr=[mr]),y(mr).call(mr,yr)===-1&&Cr.onParamInvalidValue(Mr,mr,Tr)},Cr.onParamInvalidValue=function(Mr,yr,mr){var Tr;Cr.isArray(yr)||(yr=[yr]),yr=ie(yr).call(yr,function(Br){return'"'+Br+'"'}),Cr.isArray(yr)&&(yr=yr.join(", ")),Cr.onParamError(re(Tr="参数 ".concat(Mr,"值错误, 合法的值包括: [")).call(Tr,ue(yr),"]"),mr)},Cr.verifyParamMin=function(Mr,yr,mr,Tr){yr<mr&&Cr.onParamError("参数"+Mr+"的值不能小于"+mr,Tr)},Cr.verifyParamMax=function(Mr,yr,mr,Tr){yr>mr&&Cr.onParamError("参数"+Mr+"的值不能大于"+mr,Tr)},Cr.verifyArrayMax=function(Mr,yr,mr,Tr){yr.length>mr&&Cr.onParamError("参数"+Mr+"的长度不能大于"+mr,Tr)},Cr.verifyEmail=(Pr=/^\S+@\S+$/,function(Mr,yr,mr){Pr.test(yr)||Cr.onParamError("参数"+Mr+"邮箱格式错误, 合法格式必须包含@符号, @符号前后至少要各有一个字符",mr)}),Cr.verifyTel=function(){var Mr=/^[+\-()\d]+$/;return function(yr,mr,Tr){Mr.test(mr)||Cr.onParamError("参数"+yr+"电话号码格式错误, 合法字符包括+、-、英文括号和数字",Tr)}}(),Cr.verifyBirth=function(){var Mr=/^(\d{4})-(0[1-9]|1[012])-(0[1-9]|[12][0-9]|3[01])$/;return function(yr,mr,Tr){Mr.test(mr)||Cr.onParamError("参数"+yr+'生日格式错误, 合法为"yyyy-MM-dd"',Tr)}}(),Cr.onParamError=function(Mr,yr){Cr.onError({message:Mr,callFunc:yr})},Cr.verifyOptions=function(Mr,yr,mr,Tr,Br){if(Mr=Mr||{},yr&&(Cr.isString(yr)&&(yr=yr.split(kr)),Cr.isArray(yr))){typeof mr!="boolean"&&(Br=mr||null,mr=!0,Tr="");var $r=mr?Cr.verifyParamPresent:Cr.verifyParamAbsent;g(yr).call(yr,function(Lr){$r.call(Cr,Lr,Mr[Lr],Tr,Br)})}return Mr},Cr.verifyParamAtLeastPresentOne=function(Mr,yr,mr){yr&&(Cr.isString(yr)&&(yr=yr.split(kr)),Cr.isArray(yr)&&($(yr).call(yr,function(Tr){return Cr.exist(Mr[Tr])})||Cr.onParamError("以下参数["+yr.join(", ")+"]至少需要传入一个",mr)))},Cr.verifyParamPresentJustOne=function(Mr,yr,mr){yr&&(Cr.isString(yr)&&(yr=yr.split(kr)),Cr.isArray(yr)&&le(yr).call(yr,function(Tr,Br){return Cr.exist(Mr[Br])&&Tr++,Tr},0)!==1&&Cr.onParamError("以下参数["+yr.join(", ")+"]必须且只能传入一个",mr))},Cr.verifyBooleanWithDefault=function(Mr,yr,mr,Tr,Br){Cr.undef(mr)&&(mr=!0),kr.test(yr)&&(yr=yr.split(kr)),Cr.isArray(yr)?g(yr).call(yr,function($r){Cr.verifyBooleanWithDefault(Mr,$r,mr,Tr,Br)}):Mr[yr]===void 0?Mr[yr]=mr:Cr.isBoolean(Mr[yr])||Cr.onParamInvalidType(yr,"boolean",Tr,Br)},Cr.verifyFileInput=function(Mr,yr){var mr;return Cr.verifyParamPresent("fileInput",Mr,"",yr),Cr.isString(Mr)&&((Mr=typeof document>"u"?void 0:document.getElementById(Mr))||Cr.onParamError("找不到要上传的文件对应的input, 请检查fileInput id ".concat(Mr),yr)),Mr.tagName&&Mr.tagName.toLowerCase()==="input"&&Mr.type.toLowerCase()==="file"||Cr.onParamError(re(mr="请提供正确的 fileInput, 必须为 file 类型的 input 节点 tagname:".concat(Mr.tagName,", filetype:")).call(mr,Mr.type),yr),Mr},Cr.verifyFileType=function(Mr,yr){Cr.verifyParamValid("type",Mr,Cr.validFileTypes,yr)},Cr.verifyCallback=function(Mr,yr,mr){kr.test(yr)&&(yr=yr.split(kr)),Cr.isArray(yr)?g(yr).call(yr,function(Tr){Cr.verifyCallback(Mr,Tr,mr)}):Mr[yr]?Cr.isFunction(Mr[yr])||Cr.onParamInvalidType(yr,"function","",mr):Mr[yr]=Cr.emptyFunc},Cr.verifyFileUploadCallback=function(Mr,yr){Cr.verifyCallback(Mr,"uploadprogress uploaddone uploaderror uploadcancel",yr)},Cr.validFileTypes=["image","audio","video","file"],Cr.validFileExts={image:["bmp","gif","jpg","jpeg","jng","png","webp"],audio:["mp3","wav","aac","wma","wmv","amr","mp2","flac","vorbis","ac3"],video:["mp4","rm","rmvb","wmv","avi","mpg","mpeg","mov"]},Cr.filterFiles=function(Mr,yr){var mr,Tr,Br=(yr=yr.toLowerCase())==="file",$r=[];return g([]).call(Mr,function(Lr){var Gr,qr;if(Br)$r.push(Lr);else if(mr=i(Gr=Lr.name).call(Gr,oe(qr=Lr.name).call(qr,".")+1),(Tr=Lr.type.split("/"))[0]&&Tr[1]){var Yr,bn=!1;Tr[0].toLowerCase()===yr?bn=!0:bn=y(Yr=Cr.validFileExts[yr]).call(Yr,mr)!==-1,bn&&$r.push(Lr)}}),$r};var Ir,xr,vr=Cr.supportFormData=Cr.notundef(rr.FormData);Cr.getFileName=function(Mr){return Mr=Cr.verifyFileInput(Mr),vr?Mr.files[0].name:i(yr=Mr.value).call(yr,oe(mr=Mr.value).call(mr,"\\")+1);var yr,mr},Cr.getFileInfo=(Ir={ppt:1,pptx:2,pdf:3,doc:6,docx:7},function(Mr){var yr={};if(!(Mr=Cr.verifyFileInput(Mr)).files)return yr;var mr=Mr.files[0];return vr&&(yr.name=mr.name,yr.size=mr.size,yr.type=mr.name.match(/\.(\w+)$/),yr.type=yr.type&&yr.type[1].toLowerCase(),yr.transcodeType=Ir[yr.type]||0),yr}),Cr.sizeText=(xr=["B","KB","MB","GB","TB","PB","EB","ZB","BB"],function(Mr){var yr,mr=0;do yr=(Mr=Math.floor(100*Mr)/100)+xr[mr],Mr/=1024,mr++;while(Mr>1);return yr}),Cr.promises2cmds=function(Mr){return ie(Mr).call(Mr,function(yr){return yr.cmd})},Cr.objs2accounts=function(Mr){return ie(Mr).call(Mr,function(yr){return yr.account})},Cr.teams2ids=function(Mr){return ie(Mr).call(Mr,function(yr){return yr.teamId})},Cr.objs2ids=function(Mr){return ie(Mr).call(Mr,function(yr){return yr.id})},Cr.getMaxUpdateTime=function(Mr){var yr=ie(Mr).call(Mr,function(mr){return+mr.updateTime});return Math.max.apply(Math,yr)},Cr.genCheckUniqueFunc=function(Mr){return Mr=Mr||"id",function(yr){this.uniqueSet=this.uniqueSet||{},this.uniqueSet[Mr]=this.uniqueSet[Mr]||{};var mr=this.uniqueSet[Mr],Tr=yr[Mr];return!mr[Tr]&&(mr[Tr]=!0,!0)}},Cr.fillPropertyWithDefault=function(Mr,yr,mr){return!!Cr.undef(Mr[yr])&&(Mr[yr]=mr,!0)},Cr.throttle=function(Mr,yr,mr,Tr){var Br,$r,Lr=null,Gr=0;mr||(mr={});var qr=function(){Gr=mr.leading===!1?0:new Date().getTime(),Lr=null,Mr.apply(Br,$r),Lr||(Br=$r=null)};return function(){var Yr=new Date().getTime();Gr||mr.leading!==!1||(Gr=Yr);var bn=yr-(Yr-Gr);return Br=this,$r=arguments,bn<=0||bn>yr?(clearTimeout(Lr),Lr=null,Gr=Yr,Mr.apply(Br,$r),Lr||(Br=$r=null)):Lr||mr.trailing===!1?Lr&&Tr&&Tr.apply(Br,$r):(Lr=ae(qr,bn),Tr&&Tr.apply(Br,$r)),Lr}},Cr.get=function(Mr,yr){var mr=arguments.length>2&&arguments[2]!==void 0?arguments[2]:void 0;if(sr(Mr)!=="object")return mr;var Tr,Br=yr.replace(/\[(\d+)\]/g,".$1").split("."),$r=Mr,Lr=cr(Br);try{for(Lr.s();!(Tr=Lr.n()).done;){var Gr=Tr.value;if(($r=Object($r)[Gr])===void 0)return mr}}catch(qr){Lr.e(qr)}finally{Lr.f()}return $r},Cr.pickAsString=function(Mr,yr){var mr;return Mr?ie(mr=qe(yr).call(yr,function(Tr){return Mr[Tr]!==void 0})).call(mr,function(Tr){var Br;return re(Br="".concat(Tr,"=")).call(Br,Mr[Tr])}).join(","):""},Cr.omitAsString=function(Mr,yr){var mr,Tr;if(!Mr)return"";var Br={};return g(yr).call(yr,function($r){Br[$r]=!0}),ie(mr=qe(Tr=k(Mr)).call(Tr,function($r){return!Br[$r]})).call(mr,function($r){var Lr;return re(Lr="".concat($r,"=")).call(Lr,Mr[$r])}).join(",")};var _r={session:function(Mr){var yr=function(Tr){for(var Br=1;Br<arguments.length;Br++){var $r,Lr,Gr=arguments[Br]!=null?arguments[Br]:{};Br%2?g($r=er(Object(Gr),!0)).call($r,function(qr){n(Tr,qr,Gr[qr])}):dr?Dt(Tr,dr(Gr)):g(Lr=er(Object(Gr))).call(Lr,function(qr){lr(Tr,qr,ir(Gr,qr))})}return Tr}({},Mr),mr=["topCustom","localCustom","extra"];return g(mr).call(mr,function(Tr){yr[Tr]&&(yr[Tr]="***")}),yr.lastMsg&&(yr.lastMsg={idServer:yr.lastMsg.idServer,idClient:yr.lastMsg.idClient}),yr}};Cr.secureOutput=function(Mr,yr){z(yr)||(yr=[yr]);var mr=_r[Mr];return(yr=ie(yr).call(yr,function(Tr){return mr(Tr)})).length===1?yr[0]:yr};var Or={string:function(Mr,yr,mr){var Tr=mr.required,Br=mr.allowEmpty,$r=Mr[yr];return Tr===!1&&$r===void 0||typeof $r=="string"&&!(!Br&&$r==="")},number:function(Mr,yr,mr){var Tr=mr.required,Br=mr.min,$r=Mr[yr];return Tr===!1&&$r===void 0||typeof $r=="number"&&!($r<Br)},enum:function(Mr,yr,mr){var Tr=mr.required,Br=de(mr),$r=Mr[yr];return Tr===!1&&$r===void 0||y(Br).call(Br,$r)>-1},array:function(Mr,yr,mr){var Tr=mr.itemType,Br=mr.min,$r=mr.max,Lr=mr.required,Gr=Mr[yr];return Lr===!1&&Gr===void 0||!!z(Gr)&&!(typeof $r=="number"&&Gr.length>$r)&&!(typeof Br=="number"&&Gr.length<Br)&&!(Tr&&Tr!=="enum"&&!Ne(Gr).call(Gr,function(qr){return sr(qr)===Tr}))}};Cr.validate=function(Mr,yr,mr){var Tr,Br={};return g(Tr=k(Mr)).call(Tr,function($r){var Lr,Gr=Mr[$r].type,qr=Or[Gr];qr&&!qr(yr,$r,Mr[$r])?Cr.onError({message:re(Lr="Error in parameter verification, ".concat($r," expected value is ")).call(Lr,ue(Mr[$r])),callFunc:mr}):Br[$r]=yr[$r]}),Br},Cr.asyncPool=function(Mr,yr,mr){if(typeof Mr!="number"||typeof mr!="function"||!yr||!yr.length)return ze.resolve();var Tr=0,Br=[],$r=[];return function Lr(){if(Tr===yr.length)return ze.resolve();var Gr=yr[Tr++],qr=ze.resolve().then(function(){return mr(Gr,yr)});Br.push(qr);var Yr=ze.resolve();if(Mr<=yr.length){var bn=qr.then(function(){return L($r).call($r,y($r).call($r,bn),1)});$r.push(bn),$r.length>=Mr&&(Yr=ze.race($r))}return Yr.then(function(){return Lr()})}().then(function(){return ze.all(Br)})},Cr.getIdArray=function(Mr){if(!Mr||typeof Mr!="string")throw new Error("id type error");var yr=y(Mr).call(Mr,"-");if(yr<0||yr===Mr.length-1)throw new Error("id format error");return[i(Mr).call(Mr,0,yr),i(Mr).call(Mr,yr+1)]},t.exports=Cr},function(t,r,e){var n=e(14),g=e(79),y=e(159),i=e(17),k=e(95).f,$=e(211),L=e(13),V=e(34),z=e(61),re=e(30),ie=function(ue){var le=function(oe,ae,qe){if(this instanceof le){switch(arguments.length){case 0:return new ue;case 1:return new ue(oe);case 2:return new ue(oe,ae)}return new ue(oe,ae,qe)}return g(ue,this,arguments)};return le.prototype=ue.prototype,le};t.exports=function(ue,le){var oe,ae,qe,de,Ne,ze,$e,Lt,jt,Et=ue.target,ir=ue.global,dr=ue.stat,Dt=ue.proto,lr=ir?n:dr?n[Et]:(n[Et]||{}).prototype,sr=ir?L:L[Et]||z(L,Et,{})[Et],er=sr.prototype;for(de in le)ae=!(oe=$(ir?de:Et+(dr?".":"#")+de,ue.forced))&&lr&&re(lr,de),ze=sr[de],ae&&($e=ue.dontCallGetSet?(jt=k(lr,de))&&jt.value:lr[de]),Ne=ae&&$e?$e:le[de],ae&&typeof ze==typeof Ne||(Lt=ue.bind&&ae?V(Ne,n):ue.wrap&&ae?ie(Ne):Dt&&i(Ne)?y(Ne):Ne,(ue.sham||Ne&&Ne.sham||ze&&ze.sham)&&z(Lt,"sham",!0),z(sr,de,Lt),Dt&&(re(L,qe=Et+"Prototype")||z(L,qe,{}),z(L[qe],de,Ne),ue.real&&er&&(oe||!er[de])&&z(er,de,Ne)))}},function(t,r,e){t.exports=e(230)},function(t,r,e){t.exports=e(232)},function(t,r,e){t.exports=e(231)},function(t,r){t.exports=function(e){try{return!!e()}catch{return!0}}},function(t,r,e){t.exports=e(323)},function(t,r,e){t.exports=e(207)},function(t,r,e){t.exports=e(384)},function(t,r,e){t.exports=e(440)},function(t,r,e){t.exports=e(276)},function(t,r,e){var n=e(7),g=e(6),y=!1;try{typeof localStorage.setItem=="function"&&typeof localStorage.getItem=="function"&&(localStorage.setItem("nim_localstorage_exist_test","1"),y=localStorage.getItem("nim_localstorage_exist_test")==="1",localStorage.removeItem("nim_localstorage_exist_test"))}catch{y=!1}var i={nodeEnv:"production",info:{hash:"98d1c9786af772ff439f12534089825e2c3c6776",shortHash:"98d1c978",version:"9.14.4",sdkVersion:"91404",sdkHumanVersion:"9.14.4",protocolVersion:1},lbsUrl:"https://lbs.netease.im/lbs/webconf.jsp",needToXHR:!0,connectTimeout:1e4,xhrTimeout:8e3,reconnectionDelay:1600,reconnectionDelayMax:8e3,reconnectionJitter:.01,reconnectiontimer:null,heartbeatInterval:3e4,cmdTimeout:8e3,hbCmdTimeout:5e3,isWeixinApp:!1,isNodejs:!1,isRN:!1,ipVersion:0,PUSHTOKEN:"",PUSHCONFIG:{},CLIENTTYPE:16,PushPermissionAsked:!1,iosPushConfig:null,androidPushConfig:null,optionDefaultLinkUrl:"",defaultLinkUrl:"weblink.netease.im",ipv6DefaultLinkUrl:"weblink.netease.im",optionIpv6DefaultLinkUrl:"",wxDefaultLinkUrl:"wlnimsc0.netease.im",serverNosConfig:y?{cdnDomain:localStorage.getItem("nim_cdn_domain")||"",objectPrefix:localStorage.getItem("nim_object_prefix")||""}:{},hasLocalStorage:y,privateConf:{isABTestEnable:!0,isDataReportEnable:!0,isMixStoreEnable:!0,reportConfigUrl:"https://statistic.live.126.net/dispatcher/req",reportUrl:"https://statistic.live.126.net/statics/report/common/form"},getDefaultLinkUrl:function(k){var $,L;i.ipVersion===1?($=i.optionIpv6DefaultLinkUrl,L=i.ipv6DefaultLinkUrl):($=i.optionDefaultLinkUrl,L=i.defaultLinkUrl);var V=$||(i.isWeixinApp?i.wxDefaultLinkUrl:L);if(!V)return!1;var z=k?"https":"http",re=k?"443":"80",ie=V;return n(V).call(V,"http")===-1&&(ie=z+"://"+ie),n(V).call(V,":")===-1&&(ie=ie+":"+re),ie},ipProbeAddr:{ipv4:"https://check-ipv4.netease.im/test/",ipv6:"https://check-ipv6.netease.im/test/"},formatSocketUrl:function(k){var $=k.url,L=k.secure?"https":"http";return n($).call($,"http")===-1?L+"://"+$:$},uploadUrl:"https://nos.netease.com",chunkUploadUrl:"https://wanproxy-web.127.net",commonMaxSize:104857600,chunkSize:4194304,chunkMaxSize:4194304e4,replaceUrl:"https://{bucket}-nosdn.netease.im/{object}",downloadHost:"nos.netease.com",downloadHostList:["nos.netease.com"],downloadUrl:"https://{bucket}-nosdn.netease.im/{object}",nosCdnEnable:!0,httpsEnabled:!1,threshold:0,nosLbsUrls:[],edgeList:["https://wanproxy-web.127.net","https://nosup-hz1.127.net"],genUploadUrl:function(k){return i.uploadUrl+"/"+k},genChunkUploadUrl:function(k){return i.chunkUploadUrl?i.chunkUploadUrl+"/"+k.bucket+"/"+k.objectName:""},genDownloadUrl:function(k,$,L){var V,z,re,ie,ue,le=k.bucket,oe=k.expireSec,ae=+new Date,qe=oe?"&survivalTime=".concat(oe):"";if(L)return g(re=g(ie=g(ue="https://".concat(L,"/")).call(ue,$,"?createTime=")).call(ie,ae)).call(re,qe);var de=g(V=g(z="".concat(i.replaceUrl,"?createTime=")).call(z,ae)).call(V,qe);return(de=i.genNosProtocolUrl(de)).replace("{bucket}",le).replace("{object}",$)},genFileUrl:function(k){var $=k.bucket,L=k.objectName;return i.genNosProtocolUrl(i.replaceUrl).replace("{bucket}",$).replace("{object}",L)},genNosProtocolUrl:function(k){return/^http/.test(k)?i.httpsEnabled&&n(k).call(k,"https://")!==0&&(k=k.replace("http","https")):k=i.httpsEnabled?"https://".concat(k):"http://".concat(k),k}};i.hostEnv="BROWSER",t.exports=i},function(t,r,e){var n=e(109),g=Function.prototype,y=g.call,i=n&&g.bind.bind(y,y);t.exports=n?i:function(k){return function(){return y.apply(k,arguments)}}},function(t,r){t.exports={}},function(t,r,e){(function(n){var g=function(y){return y&&y.Math==Math&&y};t.exports=g(typeof globalThis=="object"&&globalThis)||g(typeof window=="object"&&window)||g(typeof self=="object"&&self)||g(typeof n=="object"&&n)||function(){return this}()||Function("return this")()}).call(this,e(73))},function(t,r,e){t.exports=e(251)},function(t,r,e){t.exports=e(458)},function(t,r,e){var n=e(208),g=n.all;t.exports=n.IS_HTMLDDA?function(y){return typeof y=="function"||y===g}:function(y){return typeof y=="function"}},function(t,r,e){t.exports=e(216)},function(t,r,e){var n=e(12);t.exports=n({}.isPrototypeOf)},function(t,r,e){var n=e(109),g=Function.prototype.call;t.exports=n?g.bind(g):function(){return g.apply(g,arguments)}},function(t,r,e){var n=e(14),g=e(111),y=e(30),i=e(130),k=e(97),$=e(209),L=g("wks"),V=n.Symbol,z=V&&V.for,re=$?V:V&&V.withoutSetter||i;t.exports=function(ie){if(!y(L,ie)||!k&&typeof L[ie]!="string"){var ue="Symbol."+ie;k&&y(V,ie)?L[ie]=V[ie]:L[ie]=$&&z?z(ue):re(ue)}return L[ie]}},function(t,r,e){var n=e(155),g=e(365);function y(i){return t.exports=y=typeof n=="function"&&typeof g=="symbol"?function(k){return typeof k}:function(k){return k&&typeof n=="function"&&k.constructor===n&&k!==n.prototype?"symbol":typeof k},t.exports.__esModule=!0,t.exports.default=t.exports,y(i)}t.exports=y,t.exports.__esModule=!0,t.exports.default=t.exports},function(t,r,e){var n=e(13),g=e(30),y=e(136),i=e(39).f;t.exports=function(k){var $=n.Symbol||(n.Symbol={});g($,k)||i($,k,{value:y.f(k)})}},function(t,r,e){t.exports=e(454)},function(t,r,e){var n=e(51),g=e(60),y=e(6),i=e(24),k=e(8),$=e(32),L=e(4),V=e(52),z=e(16),re=e(53),ie=e(2),ue=e(54),le=e(55),oe=e(43),ae=e(15),qe=e(88),de=e(89),Ne=e(72);function ze(lr,sr){var er=de!==void 0&&Ne(lr)||lr["@@iterator"];if(!er){if($(lr)||(er=function(Er,Pr){var Cr;if(Er){if(typeof Er=="string")return $e(Er,Pr);var rr=ae(Cr=Object.prototype.toString.call(Er)).call(Cr,8,-1);if(rr==="Object"&&Er.constructor&&(rr=Er.constructor.name),rr==="Map"||rr==="Set")return qe(Er);if(rr==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(rr))return $e(Er,Pr)}}(lr))||sr&&lr&&typeof lr.length=="number"){er&&(lr=er);var cr=0,or=function(){};return{s:or,n:function(){return cr>=lr.length?{done:!0}:{done:!1,value:lr[cr++]}},e:function(Er){throw Er},f:or}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var hr,pr=!0,Sr=!1;return{s:function(){er=er.call(lr)},n:function(){var Er=er.next();return pr=Er.done,Er},e:function(Er){Sr=!0,hr=Er},f:function(){try{pr||er.return==null||er.return()}finally{if(Sr)throw hr}}}}function $e(lr,sr){(sr==null||sr>lr.length)&&(sr=lr.length);for(var er=0,cr=new Array(sr);er<sr;er++)cr[er]=lr[er];return cr}function Lt(lr,sr){var er=L(lr);if(V){var cr=V(lr);sr&&(cr=z(cr).call(cr,function(or){return re(lr,or).enumerable})),er.push.apply(er,cr)}return er}function jt(lr){for(var sr=1;sr<arguments.length;sr++){var er,cr,or=arguments[sr]!=null?arguments[sr]:{};sr%2?ie(er=Lt(Object(or),!0)).call(er,function(hr){n(lr,hr,or[hr])}):ue?le(lr,ue(or)):ie(cr=Lt(Object(or))).call(cr,function(hr){oe(lr,hr,re(or,hr))})}return lr}var Et=e(45),ir=e(0);function dr(lr){return ir.get(lr,"code")||ir.get(lr,"msg.code")||ir.get(lr,"statusCode")||ir.get(lr,"event.code")||0}function Dt(lr){var sr,er,cr=typeof lr=="string"?lr:ir.get(lr,"msg")||ir.get(lr,"message")||ir.get(lr,"error")||ir.get(lr,"event.msg")||ir.get(lr,"event.message")||ir.get(lr,"event")||"unknown",or="",hr="";lr&&typeof lr.toString=="function"&&(or=lr.toString());try{hr=k(lr)}catch{}return y(sr=y(er=`
errMsg: `.concat(cr,`
errStr: `)).call(er,or,`
errJsonStr: `)).call(sr,hr,`
  `)}t.exports={reportAPI:function(lr){var sr=lr.instance,er=lr.className,cr=lr.funcName,or=lr.hasCallback,hr=or===void 0||or,pr=lr.done;if(!function(Pr){if(!Pr||!$(Pr.experiments))return!1;var Cr,rr=ze(Pr.experiments);try{for(rr.s();!(Cr=rr.n()).done;){var kr=Cr.value;if(kr.experimentKey==="api_trace_collection"&&kr.schemeKey==="open_flow"&&$(kr.variates)){var Ir,xr=ze(kr.variates);try{for(xr.s();!(Ir=xr.n()).done;){var vr=Ir.value;if(vr.key==="open"&&vr.value===!0)return!0}}catch(_r){xr.e(_r)}finally{xr.f()}}}}catch(_r){rr.e(_r)}finally{rr.f()}return!1}(sr.abtInfo)||!sr.reporter||!sr.reporter.isUploadEnable)return pr;var Sr,Er={user_id:ir.get(sr,"options.account")||"",trace_id:ir.get(sr,"socket.socket.sessionid"),class_name:er,api_name:cr,action:hr?1:0,active_id:Et.deviceId,start_time:g()};return hr?(Sr=i(function(){sr&&sr.logger&&sr.logger.warn("API 数据上报回调函数未调用",Er),sr&&sr.reporter&&sr.reporter.report("nim_api_trace",jt(jt({},Er),{},{state:1,error_code:408,error_msg:"API回调函数未被调用",duration:g()-Er.start_time}))},1e4),function(Pr){if(clearTimeout(Sr),typeof pr=="function"){for(var Cr,rr=arguments.length,kr=new Array(rr>1?rr-1:0),Ir=1;Ir<rr;Ir++)kr[Ir-1]=arguments[Ir];pr.apply(void 0,y(Cr=[Pr]).call(Cr,kr))}try{if(!sr||!sr.reporter)return;Pr?sr.reporter.report("nim_api_trace",jt(jt({},Er),{},{state:1,error_code:dr(Pr),error_msg:Dt(Pr),duration:g()-Er.start_time})):sr.reporter.report("nim_api_trace",jt(jt({},Er),{},{state:0,duration:g()-Er.start_time}))}catch(xr){sr&&sr.logger&&sr.logger.error("api report error",xr)}}):(sr.reporter.report("nim_api_trace",jt(jt({},Er),{},{state:0,duration:1})),pr)}}},function(t,r,e){t.exports=e(273)},function(t,r,e){var n=e(5);t.exports=!n(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!=7})},function(t,r,e){var n=e(17),g=e(208),y=g.all;t.exports=g.IS_HTMLDDA?function(i){return typeof i=="object"?i!==null:n(i)||i===y}:function(i){return typeof i=="object"?i!==null:n(i)}},function(t,r,e){var n=e(13);t.exports=function(g){return n[g+"Prototype"]}},function(t,r,e){var n=e(12),g=e(42),y=n({}.hasOwnProperty);t.exports=Object.hasOwn||function(i,k){return y(g(i),k)}},function(t,r,e){var n=e(17),g=e(81),y=TypeError;t.exports=function(i){if(n(i))return i;throw y(g(i)+" is not a function")}},function(t,r,e){t.exports=e(300)},function(t,r,e){var n=e(13),g=e(14),y=e(17),i=function(k){return y(k)?k:void 0};t.exports=function(k,$){return arguments.length<2?i(n[k])||i(g[k]):n[k]&&n[k][$]||g[k]&&g[k][$]}},function(t,r,e){var n=e(159),g=e(31),y=e(109),i=n(n.bind);t.exports=function(k,$){return g(k),$===void 0?k:y?i(k,$):function(){return k.apply($,arguments)}}},function(t,r,e){var n=e(18),g=e(26),y=e(3),i=e(75),k=e(78),$=e(11),L=e(0),V=e(291),z=L.undef,re=e(310),ie=e(149),ue=e(153),le=e(784),oe=e(785);function ae(Ne){var ze,$e,Lt,jt=this;L.verifyOptions(Ne,"appKey account token","protocol::IMProtocol"),L.verifyCallback(Ne,["onconnect","onerror","onwillreconnect","ondisconnect","onloginportschange","onmyinfo","onblacklist","onmutelist","onfriends","onusers","onrobots","onteams","onSuperTeams","onsessions","onSessionsWithMoreRoaming","onStickTopSessions","onroamingmsgs","onofflinemsgs","onofflinefiltermsgs","onroamingsysmsgs","onofflinesysmsgs","onofflinefiltersysmsgs","onofflinecustomsysmsgs","onofflinefiltercustomsysmsgs","onbroadcastmsg","onbroadcastmsgs","onsysmsgunread","onsyncdone","onteammembers","onsyncteammembersdone","onsyncsuperteammembersdone","onmsg","onsysmsg","oncustomsysmsg","onupdatemyinfo","onupdateuser","onSyncUpdateServerSession","onUpdateSuperTeamMember","onMySuperTeamMembers","onCreateSuperTeam","onUpdateSuperTeam","onAddSuperTeamMembers","onRemoveSuperTeamMembers","onUpdateSuperTeamManagers","onDismissSuperTeam","onTransferSuperTeam","onUpdateSuperTeamMembersMute","onupdateteammember","onMyTeamMembers","onMsgReceipts","onCreateTeam","onUpdateTeam","onAddTeamMembers","onRemoveTeamMembers","onUpdateTeamManagers","onDismissTeam","onTransferTeam","onUpdateTeamMembersMute","onTeamMsgReceipt","onupdatesession","onQuickComment","onDeleteQuickComment","onPinMsgChange","onupdatesysmsgunread","onupdatesysmsg","onsynccreateteam","onsyncsupercreateteam","onsyncmarkinblacklist","onsyncmarkinmutelist","onsyncfriendaction","shouldIgnoreNotification","shouldIgnoreMsg","onDeleteMsgSelf","shouldCountNotifyUnread","onPushNotificationMultiportConfig","onPushNotificationMultiportConfigUpdate","onpushevents"],"protocol::IMProtocol"),ze=typeof L.get(Ne,"privateConf.isDataReportEnable")=="boolean"?Ne.privateConf.isDataReportEnable:$.privateConf.isDataReportEnable,$e=typeof L.get(Ne,"privateConf.reportConfigUrl")=="string"?Ne.privateConf.reportConfigUrl:$.privateConf.reportConfigUrl,Lt=typeof L.get(Ne,"privateConf.reportUrl")=="string"?Ne.privateConf.reportUrl:$.privateConf.reportUrl,jt.reporter=V.initReporter({isDataReportEnable:ze,reportConfigUrl:$e,reportUrl:Lt,appKey:Ne.appKey,logger:jt.logger}),jt.db=Ne.api.db=new i({logger:Ne.logger,reporter:jt.reporter,account:Ne.account,core:jt,notifyError:function(Et){jt.notifyError&&jt.notifyError("DB error",Et)}}),this.processId=L.guid(),k.call(jt,Ne)}var qe=k.fn,de=ae.fn=ae.prototype=n(qe);de.init=function(){var Ne,ze,$e;qe.init.call(this),ie.IM.setProtocol(this),this.parser=ie.IM,g(Ne=this.sendCmd).call(Ne,this),this.socketUrls=[],this.syncing=!0,this.canHandleDeletedMsgInSyncing=!1,this.hasSynced=!1,this.hasSyncedTeamMembers=!1,this.syncPromiseArray=[],this.syncResult={},this.syncTeamMembersPromiseArray=[],this.syncSuperTeamMembersPromiseArray=[],this.syncTeamMembersResult={},this.syncSuperTeamMembersResult={},this.timetags={},this.superTeamMembersData={},this.saveAck={},this.sysMsgUnread=ue.completeUnread({}),this.resetUnsettledMsgs(),this.resetUnsettledSysMsgs(),this.msgPromise=y.resolve(),this.sysMsgPromise=y.resolve(),this.msgDelayArr=[],this.msgDelayTimer=null,this.msgStatEnable=!1,this.nosCdnHostTimer=null,this.relativeServerTime=0,this.sessionSet={},this.msgReceiptTasks={},this.userSet={},this.pushNotificationMultiportConfig=re.getDefaultConfig(),this.msgAckBufferManager=new le({processFn:g(ze=this.handleMsgsAck).call(ze,this),throttleTime:500}),this.roamingMsgSyncDoneBufferManager=new le({processFn:g($e=this.onSyncDone).call($e,this),throttleTime:1500}),this.reporterHookLBS=new oe(this)},de.reset=function(){qe.reset.call(this);var Ne=this.options;this.db.reset(Ne.db),z(Ne.lbsUrl)&&(Ne.lbsUrl=$.lbsUrl),this.autoconnect=!!Ne.autoconnect,this.resetAutoMarkRead()},de.resetAutoMarkRead=function(){var Ne=this.options;L.verifyBooleanWithDefault(Ne,"autoMarkRead",!0,"","protocol::resetAutoMarkRead")},de.resetUnsettledMsgs=function(){this.unhandledMsgs=[],this.unupdatedMsgs=[]},de.resetUnsettledSysMsgs=function(){this.unhandledSysMsgs=[],this.unhandledSysMsgsForDeletedMsgs=[],this.unupdatedSysMsgs=[]},de.packetFromSync=function(Ne){return!Ne.obj||!!Ne.obj.sync},t.exports=ae,e(786),e(787),e(788),e(808),e(810),e(811),e(812),e(813),e(814),e(815),e(816),e(821),e(822),e(823),e(824),e(828),e(829),e(830),e(831),e(832),e(833)},function(t,r,e){var n=e(28),g=String,y=TypeError;t.exports=function(i){if(n(i))return i;throw y(g(i)+" is not an object")}},function(t,r,e){t.exports=e(305)},function(t,r,e){var n=e(81);t.exports=function(g){if(typeof g=="object"&&"size"in g&&"has"in g&&"get"in g&&"set"in g&&"delete"in g&&"entries"in g)return g;throw TypeError(n(g)+" is not a map")}},function(t,r,e){var n=e(27),g=e(210),y=e(212),i=e(36),k=e(128),$=TypeError,L=Object.defineProperty,V=Object.getOwnPropertyDescriptor;r.f=n?y?function(z,re,ie){if(i(z),re=k(re),i(ie),typeof z=="function"&&re==="prototype"&&"value"in ie&&"writable"in ie&&!ie.writable){var ue=V(z,re);ue&&ue.writable&&(z[re]=ie.value,ie={configurable:"configurable"in ie?ie.configurable:ue.configurable,enumerable:"enumerable"in ie?ie.enumerable:ue.enumerable,writable:!1})}return L(z,re,ie)}:L:function(z,re,ie){if(i(z),re=k(re),i(ie),g)try{return L(z,re,ie)}catch{}if("get"in ie||"set"in ie)throw $("Accessors not supported");return"value"in ie&&(z[re]=ie.value),z}},function(t,r,e){var n=e(18),g=e(77),y=e(35),i=e(11),k=e(834),$=e(149).IM,L=e(156);function V(re){var ie=L(re);return this.subType="im",this.nosScene=ie.nosScene||"im",this.nosSurvivalTime=ie.nosSurvivalTime,ie.Protocol=y,ie.Message=k,ie.constructor=V,this.init(ie)}V.Protocol=y,V.parser=$,V.use=g.use,V.getInstance=g.getInstance,V.rmAllInstances=g.rmAllInstances,V.genInstanceName=function(re){return"NIM-account-"+re.account};var z=V.fn=V.prototype=n(g.prototype);V.info=z.info=i.info,t.exports=V,e(845),e(846),e(847),e(848),e(849),e(850),e(851),e(852),e(853),e(863),e(874),e(875),e(876),e(877),e(878),e(879),e(880),e(881),e(882),e(885),e(886)},function(t,r,e){var n=e(18),g=e(2),y=e(22);function i(L,V){var z=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},re=this;re.message=L||z.message||"",y(V)==="object"?(re.event=V,re.code="Other_Error"):V!==void 0&&(re.code=V),re.timetag=+new Date,z!==void 0&&(re.event=z),re.event&&(re.callFunc=re.event.callFunc||null,delete re.event.callFunc)}i.prototype=n(Error.prototype),i.prototype.name="NIMError";var k={201:"客户端版本不对, 需升级sdk",302:"用户名或密码错误, 请检查appKey和token是否有效, account和token是否匹配",403:"非法操作或没有权限",404:"对象(用户/群/聊天室)不存在",405:"参数长度过长",408:"客户端请求超时",414:"参数错误",415:"服务不可用/没有聊天室服务器可分配",416:"频率控制",417:"重复操作",422:"帐号被禁用",500:"服务器内部错误",501:"数据库操作失败",503:"服务器繁忙",508:"删除有效期过了",509:"已失效",7101:"被拉黑",700:"批量操作部分失败",801:"群人数达到上限",802:"没有权限",803:"群不存在或未发生变化",804:"用户不在群里面",805:"群类型不匹配",806:"创建群数量达到限制",807:"群成员状态不对",809:"已经在群里",811:"强推列表中帐号数量超限",812:"群被禁言",813:"因群数量限制，部分拉人成功",814:"禁止使用群组消息已读服务",815:"群管理员人数上限",816:"批量操作部分失败",997:"协议已失效",998:"解包错误",999:"打包错误",9102:"通道失效",9103:"已经在其他端接听/拒绝过这通电话",11001:"对方离线, 通话不可送达",13002:"聊天室状态异常",13003:"在黑名单中",13004:"在禁言名单中",13006:"聊天室处于整体禁言状态,只有管理员能发言",Connect_Failed:"无法建立连接, 请确保能 ping/telnet 到云信服务器; 如果是IE8/9, 请确保项目部署在 HTTPS 环境下",Error_Internet_Disconnected:"网断了",Error_Connection_is_not_Established:"连接未建立",Error_Connection_Socket_State_not_Match:"socket状态不对",Error_Timeout:"超时",Param_Error:"参数错误",No_File_Selected:"请选择文件",Wrong_File_Type:"文件类型错误",File_Too_Large:"文件过大",Cross_Origin_Iframe:"不能获取跨域Iframe的内容",Not_Support:"不支持",NO_DB:"无数据库",DB:"数据库错误",Still_In_Team:"还在群里",Session_Exist:"会话已存在",Session_Not_Exist:"会话不存在",Error_Unknown:"未知错误",Operation_Canceled:"操作取消",Sync_Error:"同步数据失败"},$=[200,406,808,810];g($).call($,function(L){k[L]=null}),i.genError=function(L){var V=k[L];return V===void 0&&(V="操作失败"),V===null?null:new i(V,L)},i.multiInstance=function(L){return new i("不允许初始化多个实例","Not_Allow_Multi_Instance",L)},i.newNetworkError=function(L){var V="Error_Internet_Disconnected";return new i(k[V],V,L)},i.newConnectError=function(L){var V="Connect_Failed";return new i(k[V]||null,V,L)},i.newConnectionError=function(L){var V="Error_Connection_is_not_Established";return new i(k[V],V,L)},i.newSocketStateError=function(L){var V="Error_Connection_Socket_State_not_Match";return new i(k[V],V,L)},i.newTimeoutError=function(L){var V="Error_Timeout";return new i(k[V],V,L)},i.newFrequencyControlError=function(L){var V=new i(k[416],416,L);return V.from="local",V},i.newParamError=function(L,V){return new i(L||k.Param_Error,"Param_Error",V)},i.newNoFileError=function(L,V){var z="No_File_Selected";return new i(L||k[z],z,V)},i.newWrongFileTypeError=function(L,V){var z="Wrong_File_Type";return new i(L||k[z],z,V)},i.newFileTooLargeError=function(L,V){var z="File_Too_Large";return new i(L||k[z],z,V)},i.newCORSIframeError=function(L){var V="Cross_Origin_Iframe";return new i(k[V],V,L)},i.newSupportError=function(L,V,z){return new i("不支持"+L,"Not_Support_"+V,z)},i.newSupportDBError=function(L){return i.newSupportError("数据库","DB",L)},i.noDBError=function(L){return new i(k.NO_DB,"NO_DB",L)},i.newDBError=function(L){return new i(k.DB,"DB",L)},i.newUnknownError=function(L){var V="Error_Unknown";return new i(k[V],V,L)},i.stillInTeamError=function(L){var V="Still_In_Team";return new i(k[V],V,L)},i.sessionExist=function(L){var V="Session_Exist";return new i(k[V],V,L)},i.sessionNotExist=function(L){var V="Session_Not_Exist";return new i(k[V],V,L)},i.cancel=function(L){var V="Operation_Canceled";return new i(k[V],V,L)},i.syncError=function(L){return new i(k.Sync_Error,"Sync_Error",L)},i.customError=function(L,V){L=L||"Other_Error";var z="";return(V=V||{}).message||(z=k[L]||L),y(L)!=="object"?new i(z,L,V):new i(z,"Other_Error",V===void 0?L:V)},t.exports=i},function(t,r,e){var n=e(110),g=Object;t.exports=function(y){return g(n(y))}},function(t,r,e){t.exports=e(249)},function(t,r,e){var n=e(127),g=e(110);t.exports=function(y){return n(g(y))}},function(t,r,e){var n=e(0),g={init:function(){g.deviceId=n.guid()}};g.init(),g.clientTypeMap={1:"Android",2:"iOS",4:"PC",8:"WindowsPhone",16:"Web",32:"Server",64:"Mac"},g.db={open:function(){}},g.rnfs=null,t.exports=g},function(t,r,e){var n=e(322);t.exports=function(g){return n(g.length)}},function(t,r,e){var n=e(34),g=e(20),y=e(36),i=e(81),k=e(235),$=e(46),L=e(19),V=e(236),z=e(139),re=e(237),ie=TypeError,ue=function(oe,ae){this.stopped=oe,this.result=ae},le=ue.prototype;t.exports=function(oe,ae,qe){var de,Ne,ze,$e,Lt,jt,Et,ir=qe&&qe.that,dr=!(!qe||!qe.AS_ENTRIES),Dt=!(!qe||!qe.IS_RECORD),lr=!(!qe||!qe.IS_ITERATOR),sr=!(!qe||!qe.INTERRUPTED),er=n(ae,ir),cr=function(hr){return de&&re(de,"normal",hr),new ue(!0,hr)},or=function(hr){return dr?(y(hr),sr?er(hr[0],hr[1],cr):er(hr[0],hr[1])):sr?er(hr,cr):er(hr)};if(Dt)de=oe.iterator;else if(lr)de=oe;else{if(!(Ne=z(oe)))throw ie(i(oe)+" is not iterable");if(k(Ne)){for(ze=0,$e=$(oe);$e>ze;ze++)if((Lt=or(oe[ze]))&&L(le,Lt))return Lt;return new ue(!1)}de=V(oe,Ne)}for(jt=Dt?oe.next:de.next;!(Et=g(jt,de)).done;){try{Lt=or(Et.value)}catch(hr){re(de,"throw",hr)}if(typeof Lt=="object"&&Lt&&L(le,Lt))return Lt}return new ue(!1)}},function(t,r,e){t.exports=e(563)},function(t,r){t.exports=!0},function(t,r,e){var n=e(67),g=String;t.exports=function(y){if(n(y)==="Symbol")throw TypeError("Cannot convert a Symbol value to a string");return g(y)}},function(t,r,e){var n=e(140),g=e(250);t.exports=function(y,i,k){return(i=g(i))in y?n(y,i,{value:k,enumerable:!0,configurable:!0,writable:!0}):y[i]=k,y},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,r,e){t.exports=e(255)},function(t,r,e){t.exports=e(481)},function(t,r,e){t.exports=e(484)},function(t,r,e){t.exports=e(487)},function(t,r,e){var n=e(258),g=typeof self=="object"&&self&&self.Object===Object&&self,y=n||g||Function("return this")();t.exports=y},function(t,r,e){var n=e(650)();t.exports=n;try{regeneratorRuntime=n}catch{typeof globalThis=="object"?globalThis.regeneratorRuntime=n:Function("r","regeneratorRuntime = r")(n)}},function(t,r,e){var n=e(288);function g(y,i,k,$,L,V,z){try{var re=y[V](z),ie=re.value}catch(ue){return void k(ue)}re.done?i(ie):n.resolve(ie).then($,L)}t.exports=function(y){return function(){var i=this,k=arguments;return new n(function($,L){var V=y.apply(i,k);function z(ie){g(V,$,L,z,re,"next",ie)}function re(ie){g(V,$,L,z,re,"throw",ie)}z(void 0)})}},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,r,e){var n=e(721);t.exports=function(g,y,i){return i?n(g.entries(),function(k){return y(k[1],k[0])}):g.forEach(y)}},function(t,r,e){t.exports=e(585)},function(t,r,e){var n=e(27),g=e(39),y=e(80);t.exports=n?function(i,k,$){return g.f(i,k,y(1,$))}:function(i,k,$){return i[k]=$,i}},function(t,r,e){(function(n){var g=e(15),y=e(24),i=e(7),k=e(141),$=e(2),L=e(8),V=e(4),z=e(122),re=e(3),ie=e(88),ue=e(89),le=e(72),oe=e(32);function ae(yr,mr){var Tr=ue!==void 0&&le(yr)||yr["@@iterator"];if(!Tr){if(oe(yr)||(Tr=function(Yr,bn){var wn;if(Yr){if(typeof Yr=="string")return qe(Yr,bn);var Xr=g(wn=Object.prototype.toString.call(Yr)).call(wn,8,-1);if(Xr==="Object"&&Yr.constructor&&(Xr=Yr.constructor.name),Xr==="Map"||Xr==="Set")return ie(Yr);if(Xr==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(Xr))return qe(Yr,bn)}}(yr))||mr&&yr&&typeof yr.length=="number"){Tr&&(yr=Tr);var Br=0,$r=function(){};return{s:$r,n:function(){return Br>=yr.length?{done:!0}:{done:!1,value:yr[Br++]}},e:function(Yr){throw Yr},f:$r}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var Lr,Gr=!0,qr=!1;return{s:function(){Tr=Tr.call(yr)},n:function(){var Yr=Tr.next();return Gr=Yr.done,Yr},e:function(Yr){qr=!0,Lr=Yr},f:function(){try{Gr||Tr.return==null||Tr.return()}finally{if(qr)throw Lr}}}}function qe(yr,mr){(mr==null||mr>yr.length)&&(mr=yr.length);for(var Tr=0,Br=new Array(mr);Tr<mr;Tr++)Br[Tr]=yr[Tr];return Br}var de=e(156);function Ne(){return typeof window<"u"?window:n!==void 0?n:typeof self<"u"?self:{}}function ze(yr){var mr;return g(mr=Object.prototype.toString.call(yr)).call(mr,8,-1)}function $e(yr){return ze(yr).toLowerCase()}function Lt(yr){return $e(yr)==="string"}function jt(yr){return $e(yr)==="number"}function Et(yr){return $e(yr)==="array"}function ir(yr){return typeof yr=="function"}function dr(yr){return $e(yr)==="date"}function Dt(yr){return yr===null}function lr(yr){return yr!==null}function sr(yr){return yr===void 0}function er(yr){return yr!==void 0}function cr(yr){return er(yr)&&lr(yr)}function or(yr){return sr(yr)||Dt(yr)}function hr(yr){return cr(yr)&&$e(yr)==="object"}var pr=function(yr,mr,Tr){yr.addEventListener?yr.addEventListener(mr,Tr,!1):yr.attachEvent&&yr.attachEvent("on"+mr,Tr)},Sr=pr,Er=function(yr,mr,Tr){yr.removeEventListener?yr.removeEventListener(mr,Tr,!1):yr.detachEvent&&yr.detachEvent("on"+mr,Tr)},Pr=Er;function Cr(){var yr=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},mr=arguments.length>1&&arguments[1]!==void 0?arguments[1]:function(){},Tr=arguments.length>2?arguments[2]:void 0;for(var Br in yr)yr.hasOwnProperty(Br)&&mr.call(Tr,Br,yr[Br])}function rr(yr,mr){Cr(mr,function(Tr,Br){yr[Tr]=Br})}var kr,Ir=(kr=0,function(){return""+kr++});function xr(yr){return Lt(yr)&&i(yr).call(yr,"{")===0&&k(yr).call(yr,"}")===yr.length-1}function vr(yr,mr,Tr){if(!yr)return"";var Br=[];return Cr(yr,function($r,Lr){ir(Lr)||(dr(Lr)?Lr=Lr.getTime():Et(Lr)?Lr=Lr.join(","):hr(Lr)&&(Lr=L(Lr)),Tr&&(Lr=encodeURIComponent(Lr)),Br.push(encodeURIComponent($r)+"="+Lr))}),Br.join(mr||",")}var _r,Or=(_r=/^([\w]+?:\/\/.*?(?=\/|$))/i,function(yr){return _r.test(yr||"")?RegExp.$1.toLowerCase():""});function Mr(yr){var mr=Ne();return yr.tagName&&yr.tagName.toUpperCase()==="INPUT"||mr.Blob&&yr instanceof mr.Blob}t.exports={o:{},emptyObj:{},f:function(){},emptyFunc:function(){},regBlank:/\s+/gi,regWhiteSpace:/\s+/gi,getGlobal:Ne,getClass:ze,typeOf:$e,isString:Lt,isNumber:jt,isInt:function(yr){return jt(yr)&&yr%1==0},isBoolean:function(yr){return $e(yr)==="boolean"},isArray:Et,isFunction:ir,isDate:dr,isRegExp:function(yr){return $e(yr)==="regexp"},isError:function(yr){return $e(yr)==="error"},isnull:Dt,notnull:lr,undef:sr,notundef:er,exist:cr,notexist:or,isObject:hr,isEmpty:function(yr){return or(yr)||(Lt(yr)||Et(yr))&&yr.length===0},remove:function(yr){yr.parentNode&&yr.parentNode.removeChild(yr)},dataset:function(yr,mr,Tr){if(!cr(Tr))return yr.getAttribute("data-"+mr);yr.setAttribute("data-"+mr,Tr)},addEventListener:pr,on:Sr,removeEventListener:Er,off:Pr,target:function(yr){return yr.target||yr.srcElement},createIframe:function(yr){if(typeof document<"u"){var mr;if((yr=yr||{}).name)try{(mr=document.createElement('<iframe name="'+yr.name+'"></iframe>')).frameBorder=0}catch{(mr=document.createElement("iframe")).name=yr.name}else mr=document.createElement("iframe");yr.visible||(mr.style.display="none"),ir(yr.onload)&&Sr(mr,"load",function Br($r){mr.src&&(yr.multi||Pr(mr,"load",Br),yr.onload($r))}),(yr.parent||document.body).appendChild(mr);var Tr=yr.src||"about:blank";return y(function(){mr.src=Tr},0),mr}},html2node:function(yr){if(typeof document<"u"){var mr=document.createElement("div");mr.innerHTML=yr;var Tr,Br,$r=[];if(mr.children)for(Tr=0,Br=mr.children.length;Tr<Br;Tr++)$r.push(mr.children[Tr]);else for(Tr=0,Br=mr.childNodes.length;Tr<Br;Tr++){var Lr=mr.childNodes[Tr];Lr.nodeType===1&&$r.push(Lr)}return $r.length>1?mr:$r[0]}},forOwn:Cr,mixin:rr,uniqueID:Ir,isJSON:xr,parseJSON:function yr(mr){try{xr(mr)&&(mr=JSON.parse(mr)),hr(mr)&&Cr(mr,function(Tr,Br){switch($e(Br)){case"string":case"object":mr[Tr]=yr(Br)}})}catch{}return mr},simpleClone:function(yr){return de(yr)},merge:function(){for(var yr=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},mr=arguments.length,Tr=new Array(mr>1?mr-1:0),Br=1;Br<mr;Br++)Tr[Br-1]=arguments[Br];return $(Tr).call(Tr,function($r){rr(yr,$r)}),yr},fillUndef:function(yr,mr){return Cr(mr,function(Tr,Br){sr(yr[Tr])&&(yr[Tr]=Br)}),yr},checkWithDefault:function(yr,mr,Tr){var Br=yr[mr]||yr[mr.toLowerCase()];return or(Br)&&(Br=Tr,yr[mr]=Br),Br},fetch:function(yr,mr){return Cr(yr,function(Tr){cr(mr[Tr])&&(yr[Tr]=mr[Tr])}),yr},string2object:function(){var yr,mr=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",Tr=arguments.length>1&&arguments[1]!==void 0?arguments[1]:",",Br={};return $(yr=mr.split(Tr)).call(yr,function($r){var Lr=$r.split("="),Gr=Lr.shift();Gr&&(Br[decodeURIComponent(Gr)]=decodeURIComponent(Lr.join("=")))}),Br},object2string:vr,genUrlSep:function(yr){return i(yr).call(yr,"?")<0?"?":"&"},object2query:function(yr){return vr(yr,"&",!0)},url2origin:Or,isFileInput:Mr,getKeys:function(yr,mr){var Tr=V(yr);return mr&&z(Tr).call(Tr,function(Br,$r){var Lr=Mr(yr[Br]);return Lr===Mr(yr[$r])?0:Lr?1:-1}),Tr},_get:function(yr,mr){var Tr,Br=arguments.length>2&&arguments[2]!==void 0?arguments[2]:void 0,$r=mr.replace(/\[(\d+)\]/g,".$1").split("."),Lr=yr,Gr=ae($r);try{for(Gr.s();!(Tr=Gr.n()).done;){var qr=Tr.value;if((Lr=Object(Lr)[qr])===void 0)return Br}}catch(Yr){Gr.e(Yr)}finally{Gr.f()}return Lr},getPromiseWithAbort:function(yr){var mr={},Tr=new re(function(Br,$r){mr.abort=$r});return mr.promise=re.race([yr,Tr]),mr}}}).call(this,e(73))},function(t,r,e){var n=e(33),g=e(718),y=n("Map");t.exports={Map:y,set:g("set",2),get:g("get",1),has:g("has",1),remove:g("delete",1),proto:y.prototype}},function(t,r,e){(function(n){var g=e(15),y=e(7),i=e(303),k=e(48),$=e(22),L=function(){var V=(n===void 0?"undefined":$(n))==="object"?n:window,z=Math.pow(2,53)-1,re=/\bOpera/,ie=Object.prototype,ue=ie.hasOwnProperty,le=ie.toString;function oe(Lt){return(Lt=String(Lt)).charAt(0).toUpperCase()+g(Lt).call(Lt,1)}function ae(Lt){return Lt=$e(Lt),/^(?:webOS|i(?:OS|P))/.test(Lt)?Lt:oe(Lt)}function qe(Lt,jt){for(var Et in Lt)ue.call(Lt,Et)&&jt(Lt[Et],Et,Lt)}function de(Lt){var jt;return Lt==null?oe(Lt):g(jt=le.call(Lt)).call(jt,8,-1)}function Ne(Lt){return String(Lt).replace(/([ -])(?!$)/g,"$1?")}function ze(Lt,jt){var Et=null;return function(ir,dr){var Dt=-1,lr=ir?ir.length:0;if(typeof lr=="number"&&lr>-1&&lr<=z)for(;++Dt<lr;)dr(ir[Dt],Dt,ir);else qe(ir,dr)}(Lt,function(ir,dr){Et=jt(Et,ir,dr,Lt)}),Et}function $e(Lt){return String(Lt).replace(/^ +| +$/g,"")}return function Lt(jt){var Et=V,ir=jt&&$(jt)==="object"&&de(jt)!="String";ir&&(Et=jt,jt=null);var dr=Et.navigator||{},Dt=dr.userAgent||"";jt||(jt=Dt);var lr,sr,er,cr,or,hr=ir?!!dr.likeChrome:/\bChrome\b/.test(jt)&&!/internal|\n/i.test(le.toString()),pr=ir?"Object":"ScriptBridgingProxyObject",Sr=ir?"Object":"Environment",Er=ir&&Et.java?"JavaPackage":de(Et.java),Pr=ir?"Object":"RuntimeObject",Cr=/\bJava/.test(Er)&&Et.java,rr=Cr&&de(Et.environment)==Sr,kr=Cr?"a":"α",Ir=Cr?"b":"β",xr=Et.document||{},vr=Et.operamini||Et.opera,_r=re.test(_r=ir&&vr?vr["[[Class]]"]:de(vr))?_r:vr=null,Or=jt,Mr=[],yr=null,mr=jt==Dt,Tr=mr&&vr&&typeof vr.version=="function"&&vr.version(),Br=ze([{label:"EdgeHTML",pattern:"Edge"},"Trident",{label:"WebKit",pattern:"AppleWebKit"},"iCab","Presto","NetFront","Tasman","KHTML","Gecko"],function(Vn,Zr){return Vn||RegExp("\\b"+(Zr.pattern||Ne(Zr))+"\\b","i").exec(jt)&&(Zr.label||Zr)}),$r=function(Vn){return ze(Vn,function(Zr,Nn){return Zr||RegExp("\\b"+(Nn.pattern||Ne(Nn))+"\\b","i").exec(jt)&&(Nn.label||Nn)})}(["Adobe AIR","Arora","Avant Browser","Breach","Camino","Electron","Epiphany","Fennec","Flock","Galeon","GreenBrowser","iCab","Iceweasel","K-Meleon","Konqueror","Lunascape","Maxthon",{label:"Microsoft Edge",pattern:"Edge"},"Midori","Nook Browser","PaleMoon","PhantomJS","Raven","Rekonq","RockMelt",{label:"Samsung Internet",pattern:"SamsungBrowser"},"SeaMonkey",{label:"Silk",pattern:"(?:Cloud9|Silk-Accelerated)"},"Sleipnir","SlimBrowser",{label:"SRWare Iron",pattern:"Iron"},"Sunrise","Swiftfox","Waterfox","WebPositive","Opera Mini",{label:"Opera Mini",pattern:"OPiOS"},"Opera",{label:"Opera",pattern:"OPR"},"Chrome",{label:"Chrome",pattern:"(?:HeadlessChrome)"},{label:"Chrome Mobile",pattern:"(?:CriOS|CrMo)"},{label:"Firefox",pattern:"(?:Firefox|Minefield)"},{label:"Firefox for iOS",pattern:"FxiOS"},{label:"IE",pattern:"IEMobile"},{label:"IE",pattern:"MSIE"},"Safari"]),Lr=Yr([{label:"BlackBerry",pattern:"BB10"},"BlackBerry",{label:"Galaxy S",pattern:"GT-I9000"},{label:"Galaxy S2",pattern:"GT-I9100"},{label:"Galaxy S3",pattern:"GT-I9300"},{label:"Galaxy S4",pattern:"GT-I9500"},{label:"Galaxy S5",pattern:"SM-G900"},{label:"Galaxy S6",pattern:"SM-G920"},{label:"Galaxy S6 Edge",pattern:"SM-G925"},{label:"Galaxy S7",pattern:"SM-G930"},{label:"Galaxy S7 Edge",pattern:"SM-G935"},"Google TV","Lumia","iPad","iPod","iPhone","Kindle",{label:"Kindle Fire",pattern:"(?:Cloud9|Silk-Accelerated)"},"Nexus","Nook","PlayBook","PlayStation Vita","PlayStation","TouchPad","Transformer",{label:"Wii U",pattern:"WiiU"},"Wii","Xbox One",{label:"Xbox 360",pattern:"Xbox"},"Xoom"]),Gr=function(Vn){return ze(Vn,function(Zr,Nn,Qr){return Zr||(Nn[Lr]||Nn[/^[a-z]+(?: +[a-z]+\b)*/i.exec(Lr)]||RegExp("\\b"+Ne(Qr)+"(?:\\b|\\w*\\d)","i").exec(jt))&&Qr})}({Apple:{iPad:1,iPhone:1,iPod:1},Archos:{},Amazon:{Kindle:1,"Kindle Fire":1},Asus:{Transformer:1},"Barnes & Noble":{Nook:1},BlackBerry:{PlayBook:1},Google:{"Google TV":1,Nexus:1},HP:{TouchPad:1},HTC:{},LG:{},Microsoft:{Xbox:1,"Xbox One":1},Motorola:{Xoom:1},Nintendo:{"Wii U":1,Wii:1},Nokia:{Lumia:1},Samsung:{"Galaxy S":1,"Galaxy S2":1,"Galaxy S3":1,"Galaxy S4":1},Sony:{PlayStation:1,"PlayStation Vita":1}}),qr=function(Vn){return ze(Vn,function(Zr,Nn){var Qr=Nn.pattern||Ne(Nn);return!Zr&&(Zr=RegExp("\\b"+Qr+"(?:/[\\d.]+|[ \\w.]*)","i").exec(jt))&&(Zr=function(kn,Dn,xn){var An={"10.0":"10",6.4:"10 Technical Preview",6.3:"8.1",6.2:"8",6.1:"Server 2008 R2 / 7","6.0":"Server 2008 / Vista",5.2:"Server 2003 / XP 64-bit",5.1:"XP",5.01:"2000 SP1","5.0":"2000","4.0":"NT","4.90":"ME"};return Dn&&xn&&/^Win/i.test(kn)&&!/^Windows Phone /i.test(kn)&&(An=An[/[\d.]+$/.exec(kn)])&&(kn="Windows "+An),kn=String(kn),Dn&&xn&&(kn=kn.replace(RegExp(Dn,"i"),xn)),kn=ae(kn.replace(/ ce$/i," CE").replace(/\bhpw/i,"web").replace(/\bMacintosh\b/,"Mac OS").replace(/_PowerPC\b/i," OS").replace(/\b(OS X) [^ \d]+/i,"$1").replace(/\bMac (OS X)\b/,"$1").replace(/\/(\d)/," $1").replace(/_/g,".").replace(/(?: BePC|[ .]*fc[ \d.]+)$/i,"").replace(/\bx86\.64\b/gi,"x86_64").replace(/\b(Windows Phone) OS\b/,"$1").replace(/\b(Chrome OS \w+) [\d.]+\b/,"$1").split(" on ")[0])}(Zr,Qr,Nn.label||Nn)),Zr})}(["Windows Phone","Android","CentOS",{label:"Chrome OS",pattern:"CrOS"},"Debian","Fedora","FreeBSD","Gentoo","Haiku","Kubuntu","Linux Mint","OpenBSD","Red Hat","SuSE","Ubuntu","Xubuntu","Cygwin","Symbian OS","hpwOS","webOS ","webOS","Tablet OS","Tizen","Linux","Mac OS X","Macintosh","Mac","Windows 98;","Windows "]);function Yr(Vn){return ze(Vn,function(Zr,Nn){var Qr=Nn.pattern||Ne(Nn);return!Zr&&(Zr=RegExp("\\b"+Qr+" *\\d+[.\\w_]*","i").exec(jt)||RegExp("\\b"+Qr+" *\\w+-[\\w]*","i").exec(jt)||RegExp("\\b"+Qr+"(?:; *(?:[a-z]+[_-])?[a-z]+\\d+|[^ ();-]*)","i").exec(jt))&&((Zr=String(Nn.label&&!RegExp(Qr,"i").test(Nn.label)?Nn.label:Zr).split("/"))[1]&&!/[\d.]+/.test(Zr[0])&&(Zr[0]+=" "+Zr[1]),Nn=Nn.label||Nn,Zr=ae(Zr[0].replace(RegExp(Qr,"i"),Nn).replace(RegExp("; *(?:"+Nn+"[_-])?","i")," ").replace(RegExp("("+Nn+")[-_.]?(\\w)","i"),"$1 $2"))),Zr})}if(Br&&(Br=[Br]),Gr&&!Lr&&(Lr=Yr([Gr])),(lr=/\bGoogle TV\b/.exec(Lr))&&(Lr=lr[0]),/\bSimulator\b/i.test(jt)&&(Lr=(Lr?Lr+" ":"")+"Simulator"),$r=="Opera Mini"&&/\bOPiOS\b/.test(jt)&&Mr.push("running in Turbo/Uncompressed mode"),$r=="IE"&&/\blike iPhone OS\b/.test(jt)?(Gr=(lr=Lt(jt.replace(/like iPhone OS/,""))).manufacturer,Lr=lr.product):/^iP/.test(Lr)?($r||($r="Safari"),qr="iOS"+((lr=/ OS ([\d_]+)/i.exec(jt))?" "+lr[1].replace(/_/g,"."):"")):$r!="Konqueror"||/buntu/i.test(qr)?Gr&&Gr!="Google"&&(/Chrome/.test($r)&&!/\bMobile Safari\b/i.test(jt)||/\bVita\b/.test(Lr))||/\bAndroid\b/.test(qr)&&/^Chrome/.test($r)&&/\bVersion\//i.test(jt)?($r="Android Browser",qr=/\bAndroid\b/.test(qr)?qr:"Android"):$r=="Silk"?(/\bMobi/i.test(jt)||(qr="Android",Mr.unshift("desktop mode")),/Accelerated *= *true/i.test(jt)&&Mr.unshift("accelerated")):$r=="PaleMoon"&&(lr=/\bFirefox\/([\d.]+)\b/.exec(jt))?Mr.push("identifying as Firefox "+lr[1]):$r=="Firefox"&&(lr=/\b(Mobile|Tablet|TV)\b/i.exec(jt))?(qr||(qr="Firefox OS"),Lr||(Lr=lr[1])):!$r||(lr=!/\bMinefield\b/i.test(jt)&&/\b(?:Firefox|Safari)\b/.exec($r))?($r&&!Lr&&/[\/,]|^[^(]+?\)/.test(g(jt).call(jt,y(jt).call(jt,lr+"/")+8))&&($r=null),(lr=Lr||Gr||qr)&&(Lr||Gr||/\b(?:Android|Symbian OS|Tablet OS|webOS)\b/.test(qr))&&($r=/[a-z]+(?: Hat)?/i.exec(/\bAndroid\b/.test(qr)?qr:lr)+" Browser")):$r=="Electron"&&(lr=(/\bChrome\/([\d.]+)\b/.exec(jt)||0)[1])&&Mr.push("Chromium "+lr):qr="Kubuntu",Tr||(Tr=ze(["(?:Cloud9|CriOS|CrMo|Edge|FxiOS|IEMobile|Iron|Opera ?Mini|OPiOS|OPR|Raven|SamsungBrowser|Silk(?!/[\\d.]+$))","Version","HeadlessChrome",Ne($r),"(?:Firefox|Minefield|NetFront)"],function(Vn,Zr){return Vn||(RegExp(Zr+"(?:-[\\d.]+/|(?: for [\\w-]+)?[ /-])([\\d.]+[^ ();/_-]*)","i").exec(jt)||0)[1]||null})),(lr=(Br=="iCab"&&i(Tr)>3?"WebKit":/\bOpera\b/.test($r)&&(/\bOPR\b/.test(jt)?"Blink":"Presto"))||/\b(?:Midori|Nook|Safari)\b/i.test(jt)&&!/^(?:Trident|EdgeHTML)$/.test(Br)&&"WebKit"||!Br&&/\bMSIE\b/i.test(jt)&&(qr=="Mac OS"?"Tasman":"Trident")||Br=="WebKit"&&/\bPlayStation\b(?! Vita\b)/i.test($r)&&"NetFront")&&(Br=[lr]),$r=="IE"&&(lr=(/; *(?:XBLWP|ZuneWP)(\d+)/i.exec(jt)||0)[1])?($r+=" Mobile",qr="Windows Phone "+(/\+$/.test(lr)?lr:lr+".x"),Mr.unshift("desktop mode")):/\bWPDesktop\b/i.test(jt)?($r="IE Mobile",qr="Windows Phone 8.x",Mr.unshift("desktop mode"),Tr||(Tr=(/\brv:([\d.]+)/.exec(jt)||0)[1])):$r!="IE"&&Br=="Trident"&&(lr=/\brv:([\d.]+)/.exec(jt))&&($r&&Mr.push("identifying as "+$r+(Tr?" "+Tr:"")),$r="IE",Tr=lr[1]),mr){if(cr="global",or=(er=Et)!=null?$(er[cr]):"number",/^(?:boolean|number|string|undefined)$/.test(or)||or=="object"&&!er[cr])de(lr=Et.runtime)==pr?($r="Adobe AIR",qr=lr.flash.system.Capabilities.os):de(lr=Et.phantom)==Pr?($r="PhantomJS",Tr=(lr=lr.version||null)&&lr.major+"."+lr.minor+"."+lr.patch):typeof xr.documentMode=="number"&&(lr=/\bTrident\/(\d+)/i.exec(jt))?(Tr=[Tr,xr.documentMode],(lr=+lr[1]+4)!=Tr[1]&&(Mr.push("IE "+Tr[1]+" mode"),Br&&(Br[1]=""),Tr[1]=lr),Tr=$r=="IE"?String(Tr[1].toFixed(1)):Tr[0]):typeof xr.documentMode=="number"&&/^(?:Chrome|Firefox)\b/.test($r)&&(Mr.push("masking as "+$r+" "+Tr),$r="IE",Tr="11.0",Br=["Trident"],qr="Windows");else if(Cr&&(Or=(lr=Cr.lang.System).getProperty("os.arch"),qr=qr||lr.getProperty("os.name")+" "+lr.getProperty("os.version")),rr){try{Tr=Et.require("ringo/engine").version.join("."),$r="RingoJS"}catch{(lr=Et.system)&&lr.global.system==Et.system&&($r="Narwhal",qr||(qr=lr[0].os||null))}$r||($r="Rhino")}else $(Et.process)==="object"&&!Et.process.browser&&(lr=Et.process)&&($(lr.versions)==="object"&&(typeof lr.versions.electron=="string"?(Mr.push("Node "+lr.versions.node),$r="Electron",Tr=lr.versions.electron):typeof lr.versions.nw=="string"&&(Mr.push("Chromium "+Tr,"Node "+lr.versions.node),$r="NW.js",Tr=lr.versions.nw)),$r||($r="Node.js",Or=lr.arch,qr=lr.platform,Tr=(Tr=/[\d.]+/.exec(lr.version))?Tr[0]:null));qr=qr&&ae(qr)}if(Tr&&(lr=/(?:[ab]|dp|pre|[ab]\d+pre)(?:\d+\+?)?$/i.exec(Tr)||/(?:alpha|beta)(?: ?\d)?/i.exec(jt+";"+(mr&&dr.appMinorVersion))||/\bMinefield\b/i.test(jt)&&"a")&&(yr=/b/i.test(lr)?"beta":"alpha",Tr=Tr.replace(RegExp(lr+"\\+?$"),"")+(yr=="beta"?Ir:kr)+(/\d+\+?/.exec(lr)||"")),$r=="Fennec"||$r=="Firefox"&&/\b(?:Android|Firefox OS)\b/.test(qr))$r="Firefox Mobile";else if($r=="Maxthon"&&Tr)Tr=Tr.replace(/\.[\d.]+/,".x");else if(/\bXbox\b/i.test(Lr))Lr=="Xbox 360"&&(qr=null),Lr=="Xbox 360"&&/\bIEMobile\b/.test(jt)&&Mr.unshift("mobile mode");else if(!/^(?:Chrome|IE|Opera)$/.test($r)&&(!$r||Lr||/Browser|Mobi/.test($r))||qr!="Windows CE"&&!/Mobi/i.test(jt))if($r=="IE"&&mr)try{Et.external===null&&Mr.unshift("platform preview")}catch{Mr.unshift("embedded")}else(/\bBlackBerry\b/.test(Lr)||/\bBB10\b/.test(jt))&&(lr=(RegExp(Lr.replace(/ +/g," *")+"/([.\\d]+)","i").exec(jt)||0)[1]||Tr)?(qr=((lr=[lr,/BB10/.test(jt)])[1]?(Lr=null,Gr="BlackBerry"):"Device Software")+" "+lr[0],Tr=null):this!=qe&&Lr!="Wii"&&(mr&&vr||/Opera/.test($r)&&/\b(?:MSIE|Firefox)\b/i.test(jt)||$r=="Firefox"&&/\bOS X (?:\d+\.){2,}/.test(qr)||$r=="IE"&&(qr&&!/^Win/.test(qr)&&Tr>5.5||/\bWindows XP\b/.test(qr)&&Tr>8||Tr==8&&!/\bTrident\b/.test(jt)))&&!re.test(lr=Lt.call(qe,jt.replace(re,"")+";"))&&lr.name&&(lr="ing as "+lr.name+((lr=lr.version)?" "+lr:""),re.test($r)?(/\bIE\b/.test(lr)&&qr=="Mac OS"&&(qr=null),lr="identify"+lr):(lr="mask"+lr,$r=_r?ae(_r.replace(/([a-z])([A-Z])/g,"$1 $2")):"Opera",/\bIE\b/.test(lr)&&(qr=null),mr||(Tr=null)),Br=["Presto"],Mr.push(lr));else $r+=" Mobile";if(lr=(/\bAppleWebKit\/([\d.]+\+?)/i.exec(jt)||0)[1]){var bn,wn;lr=[i(lr.replace(/\.(\d)$/,".0$1")),lr],$r=="Safari"&&g(bn=lr[1]).call(bn,-1)=="+"?($r="WebKit Nightly",yr="alpha",Tr=g(wn=lr[1]).call(wn,0,-1)):Tr!=lr[1]&&Tr!=(lr[2]=(/\bSafari\/([\d.]+\+?)/i.exec(jt)||0)[1])||(Tr=null),lr[1]=(/\b(?:Headless)?Chrome\/([\d.]+)/i.exec(jt)||0)[1],lr[0]==537.36&&lr[2]==537.36&&i(lr[1])>=28&&Br=="WebKit"&&(Br=["Blink"]),mr&&(hr||lr[1])?(Br&&(Br[1]="like Chrome"),lr=lr[1]||((lr=lr[0])<530?1:lr<532?2:lr<532.05?3:lr<533?4:lr<534.03?5:lr<534.07?6:lr<534.1?7:lr<534.13?8:lr<534.16?9:lr<534.24?10:lr<534.3?11:lr<535.01?12:lr<535.02?"13+":lr<535.07?15:lr<535.11?16:lr<535.19?17:lr<536.05?18:lr<536.1?19:lr<537.01?20:lr<537.11?"21+":lr<537.13?23:lr<537.18?24:lr<537.24?25:lr<537.36?26:Br!="Blink"?"27":"28")):(Br&&(Br[1]="like Safari"),lr=(lr=lr[0])<400?1:lr<500?2:lr<526?3:lr<533?4:lr<534?"4+":lr<535?5:lr<537?6:lr<538?7:lr<601?8:"8"),Br&&(Br[1]+=" "+(lr+=typeof lr=="number"?".x":/[.+]/.test(lr)?"":"+")),$r=="Safari"&&(!Tr||k(Tr)>45)&&(Tr=lr)}$r=="Opera"&&(lr=/\bzbov|zvav$/.exec(qr))?($r+=" ",Mr.unshift("desktop mode"),lr=="zvav"?($r+="Mini",Tr=null):$r+="Mobile",qr=qr.replace(RegExp(" *"+lr+"$"),"")):$r=="Safari"&&/\bChrome\b/.exec(Br&&Br[1])&&(Mr.unshift("desktop mode"),$r="Chrome Mobile",Tr=null,/\bOS X\b/.test(qr)?(Gr="Apple",qr="iOS 4.3+"):qr=null),Tr&&y(Tr).call(Tr,lr=/[\d.]+$/.exec(qr))==0&&y(jt).call(jt,"/"+lr+"-")>-1&&(qr=$e(qr.replace(lr,""))),Br&&!/\b(?:Avant|Nook)\b/.test($r)&&(/Browser|Lunascape|Maxthon/.test($r)||$r!="Safari"&&/^iOS/.test(qr)&&/\bSafari\b/.test(Br[1])||/^(?:Adobe|Arora|Breach|Midori|Opera|Phantom|Rekonq|Rock|Samsung Internet|Sleipnir|Web)/.test($r)&&Br[1])&&(lr=Br[Br.length-1])&&Mr.push(lr),Mr.length&&(Mr=["("+Mr.join("; ")+")"]),Gr&&Lr&&y(Lr).call(Lr,Gr)<0&&Mr.push("on "+Gr),Lr&&Mr.push((/^on /.test(Mr[Mr.length-1])?"":"on ")+Lr),qr&&(lr=/ ([\d.+]+)$/.exec(qr),sr=lr&&qr.charAt(qr.length-lr[0].length-1)=="/",qr={architecture:32,family:lr&&!sr?qr.replace(lr[0],""):qr,version:lr?lr[1]:null,toString:function(){var Vn=this.version;return this.family+(Vn&&!sr?" "+Vn:"")+(this.architecture==64?" 64-bit":"")}}),(lr=/\b(?:AMD|IA|Win|WOW|x86_|x)64\b/i.exec(Or))&&!/\bi686\b/i.test(Or)?(qr&&(qr.architecture=64,qr.family=qr.family.replace(RegExp(" *"+lr),"")),$r&&(/\bWOW64\b/i.test(jt)||mr&&/\w(?:86|32)$/.test(dr.cpuClass||dr.platform)&&!/\bWin64; x64\b/i.test(jt))&&Mr.unshift("32-bit")):qr&&/^OS X/.test(qr.family)&&$r=="Chrome"&&i(Tr)>=39&&(qr.architecture=64),jt||(jt=null);var Xr={};return Xr.description=jt,Xr.layout=Br&&Br[0],Xr.manufacturer=Gr,Xr.name=$r,Xr.prerelease=yr,Xr.product=Lr,Xr.ua=jt,Xr.version=$r&&Tr,Xr.os=qr||{architecture:null,family:null,version:null,toString:function(){return"null"}},Xr.parse=Lt,Xr.toString=function(){return this.description||""},Xr.version&&Mr.unshift(Tr),Xr.name&&Mr.unshift($r),qr&&$r&&(qr!=String(qr).split(" ")[0]||qr!=$r.split(" ")[0]&&!Lr)&&Mr.push(Lr?"("+qr+")":"on "+qr),Mr.length&&(Xr.description=Mr.join(" ")),Xr}()}();t.exports=L}).call(this,e(73))},function(t,r,e){var n=e(12),g=n({}.toString),y=n("".slice);t.exports=function(i){return y(g(i),8,-1)}},function(t,r,e){var n=e(33);t.exports=n("navigator","userAgent")||""},function(t,r,e){var n=e(165),g=e(17),y=e(65),i=e(21)("toStringTag"),k=Object,$=y(function(){return arguments}())=="Arguments";t.exports=n?y:function(L){var V,z,re;return L===void 0?"Undefined":L===null?"Null":typeof(z=function(ie,ue){try{return ie[ue]}catch{}}(V=k(L),i))=="string"?z:$?y(V):(re=y(V))=="Object"&&g(V.callee)?"Arguments":re}},function(t,r,e){var n=e(61);t.exports=function(g,y,i,k){return k&&k.enumerable?g[y]=i:n(g,y,i),g}},function(t,r,e){e(86);var n=e(356),g=e(14),y=e(67),i=e(61),k=e(103),$=e(21)("toStringTag");for(var L in n){var V=g[L],z=V&&V.prototype;z&&y(z)!==$&&i(z,$,L),k[L]=k.Array}},function(t,r,e){var n=e(31),g=TypeError,y=function(i){var k,$;this.promise=new i(function(L,V){if(k!==void 0||$!==void 0)throw g("Bad Promise constructor");k=L,$=V}),this.resolve=n(k),this.reject=n($)};t.exports.f=function(i){return new y(i)}},function(t,r,e){t.exports=e(427)},function(t,r,e){t.exports=e(475)},function(t,r){var e;e=function(){return this}();try{e=e||new Function("return this")()}catch{typeof window=="object"&&(e=window)}t.exports=e},function(t,r,e){var n=e(34),g=e(12),y=e(127),i=e(42),k=e(46),$=e(164),L=g([].push),V=function(z){var re=z==1,ie=z==2,ue=z==3,le=z==4,oe=z==6,ae=z==7,qe=z==5||oe;return function(de,Ne,ze,$e){for(var Lt,jt,Et=i(de),ir=y(Et),dr=n(Ne,ze),Dt=k(ir),lr=0,sr=$e||$,er=re?sr(de,Dt):ie||ae?sr(de,0):void 0;Dt>lr;lr++)if((qe||lr in ir)&&(jt=dr(Lt=ir[lr],lr,Et),z))if(re)er[lr]=jt;else if(jt)switch(z){case 3:return!0;case 5:return Lt;case 6:return lr;case 2:L(er,Lt)}else switch(z){case 4:return!1;case 7:L(er,Lt)}return oe?-1:ue||le?le:er}};t.exports={forEach:V(0),map:V(1),filter:V(2),some:V(3),every:V(4),find:V(5),findIndex:V(6),filterReject:V(7)}},function(t,r,e){var n=e(771);n.fn=n.prototype,t.exports=n,e(773),e(774),e(775),e(776),e(777),e(778),e(779),e(780),e(781),e(782),e(783)},function(t,r,e){var n=e(22),g=e(4),y=e(8),i=e(16),k=e(2),$=e(9),L=e(15),V=e(88),z=e(89),re=e(72),ie=e(32);function ue(Dt,lr){var sr=z!==void 0&&re(Dt)||Dt["@@iterator"];if(!sr){if(ie(Dt)||(sr=function(Sr,Er){var Pr;if(Sr){if(typeof Sr=="string")return le(Sr,Er);var Cr=L(Pr=Object.prototype.toString.call(Sr)).call(Pr,8,-1);if(Cr==="Object"&&Sr.constructor&&(Cr=Sr.constructor.name),Cr==="Map"||Cr==="Set")return V(Sr);if(Cr==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(Cr))return le(Sr,Er)}}(Dt))||lr&&Dt&&typeof Dt.length=="number"){sr&&(Dt=sr);var er=0,cr=function(){};return{s:cr,n:function(){return er>=Dt.length?{done:!0}:{done:!1,value:Dt[er++]}},e:function(Sr){throw Sr},f:cr}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var or,hr=!0,pr=!1;return{s:function(){sr=sr.call(Dt)},n:function(){var Sr=sr.next();return hr=Sr.done,Sr},e:function(Sr){pr=!0,or=Sr},f:function(){try{hr||sr.return==null||sr.return()}finally{if(pr)throw or}}}}function le(Dt,lr){(lr==null||lr>Dt.length)&&(lr=Dt.length);for(var sr=0,er=new Array(lr);sr<lr;sr++)er[sr]=Dt[sr];return er}var oe=e(0),ae=oe.undef,qe=oe.notundef,de=oe.exist,Ne=e(195),ze=e(297),$e={p2p:0,team:1,superTeam:5},Lt={0:"p2p",1:"team",5:"superTeam"},jt=g($e),Et=ze.typeMap,ir=ze.validTypes;function dr(Dt){oe.verifyOptions(Dt,"scene to type","msg::Message"),oe.verifyParamValid("scene",Dt.scene,jt,"msg::Message"),this.scene=$e[Dt.scene],this.to=""+Dt.to,this.type=Et[Dt.type],this.resend=Dt.resend?1:0,Dt.resend?(oe.verifyOptions(Dt,"idClient","msg::Message"),this.idClient=Dt.idClient):this.idClient=oe.guid(),qe(Dt.subType)&&(oe.isInt(+Dt.subType)&&+Dt.subType>0?this.subType=+Dt.subType:oe.onParamError("subType只能是大于0的整数","msg::Message"));var lr=Dt.replyMsg;lr&&lr.idServer&&lr.from&&lr.to&&lr.time&&(this.replyMsgFromAccount=lr.from,this.replyMsgToAccount=lr.to,this.replyMsgTime=lr.time,this.replyMsgIdServer=lr.idServer,this.replyMsgIdClient=lr.idClient,lr.threadMsgFromAccount&&lr.threadMsgIdServer&&lr.threadMsgTime&&lr.threadMsgToAccount?(this.threadMsgFromAccount=lr.threadMsgFromAccount,this.threadMsgToAccount=lr.threadMsgToAccount,this.threadMsgTime=lr.threadMsgTime,this.threadMsgIdServer=lr.threadMsgIdServer,this.threadMsgIdClient=lr.threadMsgIdClient):(this.threadMsgFromAccount=lr.from,this.threadMsgToAccount=lr.to,this.threadMsgTime=lr.time,this.threadMsgIdServer=lr.idServer,this.threadMsgIdClient=lr.idClient)),qe(Dt.text)&&(this.body=""+Dt.text),qe(Dt.custom)&&(n(Dt.custom)==="object"?this.custom=y(Dt.custom):this.custom=""+Dt.custom),qe(Dt.body)&&(this.body=""+Dt.body),qe(Dt.pushContent)&&(this.pushContent=""+Dt.pushContent),qe(Dt.pushPayload)&&(this.pushPayload=""+Dt.pushPayload);var sr=Dt.apns;if(qe(sr)&&Dt.scene==="team"){var er=sr.accounts;qe(er)&&oe.verifyParamType("apns.accounts",er,"array","msg::Message"),this.apnsAccounts=er?y(er):"#%@all@%#",this.apnsContent=sr.content||Dt.pushContent||"",oe.verifyBooleanWithDefault(sr,"forcePush",!0,"options.apns","msg::Message"),this.apnsForcePush=sr.forcePush?1:0}var cr=Dt.robotInfo;qe(cr)&&(Dt.scene==="team"&&oe.verifyOptions(Dt.robotInfo,"account","msg::Message::robotInfo scene === team"),cr.function&&(this.robotInfoFunction=cr.function),cr.topic&&(this.robotInfoTopic=cr.topic),cr.customContent&&(this.robotInfoCustomContent=cr.customContent),cr.account&&(this.robotInfoAccount=cr.account)),qe(Dt.isHistoryable)&&(this.isHistoryable=Dt.isHistoryable?1:0),qe(Dt.isRoamingable)&&(this.isRoamingable=Dt.isRoamingable?1:0),qe(Dt.isSyncable)&&(this.isSyncable=Dt.isSyncable?1:0),qe(Dt.cc)&&(this.cc=Dt.cc?1:0),qe(Dt.env)&&(this.env=Dt.env),qe(Dt.isPushable)&&(this.isPushable=Dt.isPushable?1:0),qe(Dt.isOfflinable)&&(this.isOfflinable=Dt.isOfflinable?1:0),qe(Dt.isUnreadable)&&(this.isUnreadable=Dt.isUnreadable?1:0),qe(Dt.needPushNick)&&(this.needPushNick=Dt.needPushNick?1:0),qe(Dt.needMsgReceipt)&&(this.needMsgReceipt=Dt.needMsgReceipt?1:0),qe(Dt.yidunEnable)&&(this.yidunEnable=Dt.yidunEnable?1:0),this.needUpdateSession=Dt.needUpdateSession===!1?0:1,qe(Dt.antiSpamUsingYidun)&&(this.antiSpamUsingYidun=Dt.antiSpamUsingYidun?1:0),qe(Dt.clientAntiSpam)&&(this.clientAntiSpam=Dt.clientAntiSpam?1:0),qe(Dt.antiSpamContent)&&(n(Dt.antiSpamContent)==="object"?this.antiSpamContent=y(Dt.antiSpamContent):this.antiSpamContent=""+Dt.antiSpamContent),qe(Dt.antiSpamBusinessId)&&(n(Dt.antiSpamBusinessId)==="object"?this.antiSpamBusinessId=y(Dt.antiSpamBusinessId):this.antiSpamBusinessId=""+Dt.antiSpamBusinessId),qe(Dt.yidunAntiCheating)&&(this.yidunAntiCheating=Dt.yidunAntiCheating),qe(Dt.yidunAntiSpamExt)&&(this.yidunAntiSpamExt=Dt.yidunAntiSpamExt)}oe.merge(dr.prototype,ze.prototype),dr.prototype.getScene=function(){return Lt[this.scene]},dr.getType=ze.getType,dr.setFlow=ze.setFlow,dr.reverse=function(Dt){var lr,sr=Lt[Dt.scene];if(lr=Dt.delete==="1"?{delete:!0,scene:sr||Dt.scene,from:Dt.from,time:+Dt.time,to:""+Dt.to}:{scene:sr||Dt.scene,from:Dt.from,fromNick:Dt.fromNick,fromClientType:Ne.reverseType(Dt.fromClientType),fromDeviceId:Dt.fromDeviceId,to:""+Dt.to,time:+Dt.time,type:dr.getType(Dt),text:de(Dt.body)?Dt.body:Dt.text||"",isHistoryable:ae(Dt.isHistoryable)||+Dt.isHistoryable==1,isRoamingable:ae(Dt.isRoamingable)||+Dt.isRoamingable==1,isSyncable:ae(Dt.isSyncable)||+Dt.isSyncable==1,cc:ae(Dt.cc)||+Dt.cc==1,isPushable:ae(Dt.isPushable)||+Dt.isPushable==1,isOfflinable:ae(Dt.isOfflinable)||+Dt.isOfflinable==1,isUnreadable:ae(Dt.isUnreadable)||+Dt.isUnreadable==1,isReplyMsg:ae(Dt.isReplyMsg)||+Dt.isReplyMsg==1,needPushNick:ae(Dt.needPushNick)||+Dt.needPushNick==1,needMsgReceipt:+Dt.needMsgReceipt==1,isLocal:!1},Dt.isInBlackList&&(lr.isInBlackList=+Dt.isInBlackList==1,lr.isInBlackList&&(Dt.status="fail")),qe(Dt.isMuted)&&(lr.isMuted=+Dt.isMuted==1),qe(Dt.resend)&&(lr.resend=+Dt.resend==1),qe(Dt.idClient)&&(lr.idClient=Dt.idClient),qe(Dt.idServer)&&(lr.idServer=""+Dt.idServer),qe(Dt.userUpdateTime)&&(lr.userUpdateTime=+Dt.userUpdateTime),qe(Dt.custom)&&(lr.custom=Dt.custom),qe(Dt.callbackExt)&&(lr.callbackExt=Dt.callbackExt),qe(Dt.subType)&&(lr.subType=+Dt.subType),qe(Dt.pushContent)&&(lr.pushContent=Dt.pushContent),qe(Dt.pushPayload)&&(lr.pushPayload=Dt.pushPayload),qe(Dt.tempTeamMemberCount)&&(lr.tempTeamMemberCount=+Dt.tempTeamMemberCount),qe(Dt.yidunAntiSpamRes)&&(lr.yidunAntiSpamRes=Dt.yidunAntiSpamRes),qe(Dt.apnsAccounts)){if(lr.apns={},Dt.apnsAccounts!=="#%@all@%#"){var er=Dt.apnsAccounts;try{lr.apns.accounts=JSON.parse(er)}catch{lr.apns.accounts=[]}}lr.apns.content=Dt.apnsContent||"",lr.apns.forcePush=+Dt.apnsForcePush==1}if(qe(Dt.robotInfoFunction)&&(lr.robotInfo=lr.robotInfo||{},Dt.robotInfoFunction&&(lr.robotInfo.function=Dt.robotInfoFunction)),qe(Dt.robotInfoCustomContent)&&(lr.robotInfo=lr.robotInfo||{},Dt.robotInfoCustomContent&&(lr.robotInfo.customContent=Dt.robotInfoCustomContent)),qe(Dt.robotInfoTopic)&&(lr.robotInfo=lr.robotInfo||{},Dt.robotInfoTopic&&(lr.robotInfo.topic=Dt.robotInfoTopic)),qe(Dt.robotInfoAccount)&&(lr.robotInfo=lr.robotInfo||{},Dt.robotInfoAccount&&(lr.robotInfo.account=Dt.robotInfoAccount)),qe(Dt.needUpdateSession)&&(lr.needUpdateSession=+Dt.needUpdateSession==1),lr.status=Dt.status||"success",qe(i(Dt))&&(lr.filter=i(Dt)),Dt.replyMsgIdServer&&Dt.threadMsgIdServer){var cr=["replyMsgFromAccount","replyMsgToAccount","replyMsgTime","replyMsgIdServer","replyMsgIdClient","threadMsgFromAccount","threadMsgToAccount","threadMsgTime","threadMsgIdServer","threadMsgIdClient"];k(cr).call(cr,function(or){lr[or]=Dt[or]}),lr.replyMsgTime=+lr.replyMsgTime,lr.threadMsgTime=+lr.threadMsgTime}return lr},dr.setExtra=function(Dt,lr){Dt.target=dr.getMsgTarget(Dt,lr),Dt.sessionId=Dt.scene+"-"+Dt.target,ze.setFlow(Dt,lr)},dr.getMsgTarget=function(Dt,lr){return Dt.scene==="p2p"?Dt.to===lr?Dt.from:Dt.to:Dt.scene==="team"||Dt.scene==="superTeam"?Dt.to:void 0},dr.deduplication=function(Dt){var lr,sr,er={},cr=ue(Dt);try{for(cr.s();!(sr=cr.n()).done;){var or=sr.value,hr=er[or.idClient];hr&&hr.time>or.time||(er[or.idClient]=or)}}catch(pr){cr.e(pr)}finally{cr.f()}return $(lr=g(er)).call(lr,function(pr){return er[pr]})},dr.sortMsgs=function(Dt){return Dt=L(Dt).call(Dt,0),oe.sortObjArray(Dt,{sortPath:"time"}),Dt},dr.getLastMsg=function(Dt){return(Dt=dr.sortMsgs(Dt))[Dt.length-1]},dr.getLastNotIgnoredMsg=function(Dt){for(var lr=null,sr=(Dt=dr.sortMsgs(Dt)).length-1;sr>=0;sr--)if(!(lr=Dt[sr]).ignore)return lr;return null},dr.getMaxTimetag=function(Dt){return dr.getLastMsg(Dt).time},dr.validScenes=jt,dr.validTypes=ir,dr.sceneMap=$e,dr.sceneReverseMap=Lt,t.exports=dr},function(t,r,e){var n=e(22),g=e(18),y=e(32),i=e(2),k=e(378),$=e(7),L=e(4),V=e(8),z=e(3),re=e(173),ie=e(0),ue=ie.notundef,le=e(558),oe=e(11),ae=(e(186),e(45)),qe=e(584).wrapSafeCallback,de=e(25).reportAPI,Ne=e(156);function ze(){}var $e={};ze.getInstance=function(ir){ir=jt(ir),ie.verifyOptions(ir,"account","api::Base.getInstance");var dr=this.genInstanceName(ir),Dt=$e[dr];return Dt?ze.updateInstance(Dt,ir):Dt=$e[dr]=new this(ir),Dt},ze.updateInstance=function(ir,dr){ir.setOptions(dr),ir.connect()};var Lt=ze.fn=ze.prototype=g(new re),jt=function(ir){return ir.nosSurvivalTime?(ie.verifyParamType("nosSurvivalTime",ir.nosSurvivalTime,"number","api::Base.getInstance"),ie.verifyParamMin("nosSurvivalTime",ir.nosSurvivalTime,86400,"api::Base.getInstance")):ir.nosSurvivalTime=1/0,ir};Lt.updatePrivateConf=function(ir){if(de({instance:this,className:"ApiBaseFn",funcName:"updatePrivateConf",hasCallback:!1}),ir&&n(ir.privateConf)==="object"){var dr=ir.privateConf;typeof dr.lbs_web=="string"&&(ir.lbsUrl=dr.lbs_web),typeof dr.link_ssl_web=="boolean"&&(ir.secure=dr.link_ssl_web),typeof dr.https_enabled=="boolean"&&(ir.httpsEnabled=dr.https_enabled),ir.uploadUrl=dr.nos_uploader_web?dr.nos_uploader_web:null,ir.chunkUploadUrl=dr.nos_uploader_web?dr.nos_uploader_web:null,ir.replaceUrl=dr.nos_downloader?dr.nos_downloader:null,ir.downloadUrl=dr.nos_accelerate?dr.nos_accelerate:null,ir.downloadHost=dr.nos_accelerate_host?dr.nos_accelerate_host:null,ir.downloadHostList=dr.nos_accelerate_host_list||[],ir.downloadHost&&ir.downloadHostList.push(ir.downloadHost),ir.nosCdnEnable=dr.nos_cdn_enable!==!1,ir.ntServerAddress=dr.nt_server||null,ir.kibanaServer=dr.kibana_server,ir.statisticServer=dr.statistic_server,ir.reportGlobalServer=dr.report_global_server,ir.ipVersion=dr.ip_protocol_version||ir.ipVersion,ir.defaultLink=dr.link_web||ir.defaultLink,ir.ipv6DefaultLink=dr.link_ipv6_web||ir.ipv6DefaultLink,typeof dr.nos_lbs=="string"?ir.nosLbsUrls=[dr.nos_lbs]:ir.nosLbsUrls=[],y(dr.nos_edge_list)&&(ir.edgeList=dr.nos_edge_list)}return ir.ntServerAddress===null||ir.ntServerAddress===""?oe.ntServerAddress=null:oe.ntServerAddress=ir.ntServerAddress,oe.uploadUrl=ir.uploadUrl||oe.uploadUrl,oe.chunkUploadUrl=ir.chunkUploadUrl||oe.chunkUploadUrl,oe.downloadUrl=ir.downloadUrl||oe.downloadUrl,oe.downloadHost=ir.downloadHost||oe.downloadHost,oe.downloadHostList=ir.downloadHostList&&ir.downloadHostList.length>0?ir.downloadHostList:oe.downloadHostList,oe.nosCdnEnable=ir.nosCdnEnable!==!1,oe.replaceUrl=ir.replaceUrl||oe.replaceUrl,oe.httpsEnabled=ir.httpsEnabled||oe.httpsEnabled,ir.probe_ipv4_url&&(oe.ipProbeAddr.ipv4=ir.probe_ipv4_url),ir.probe_ipv6_url&&(oe.ipProbeAddr.ipv6=ir.probe_ipv6_url),ir},Lt.init=function(ir){ie.verifyOptions(ir,"account","api::Base.init"),ir=this.updatePrivateConf(ir),ie.verifyBooleanWithDefault(ir,"exifOrientation",!0,"","api::Base.init"),ir.lbsBackup=ir.lbsBackup===void 0||ir.lbsBackup;var dr=this.account=ir.account=ir.account+"",Dt=ir.constructor.genInstanceName(ir),lr=$e[Dt];if(ir._disableSingleton&&(lr=null),lr)return ze.updateInstance(lr,ir),lr;this.logger=ir.logger=new le({debug:ir.debug,logFunc:ir.logFunc,prefix:this.subType,dbLog:ir.dbLog!==!1,account:ir.account,expire:ir.expire,logLevel:ir.logLevel}),this.options=qe(ir,this),ir.api=this;var sr=this.protocol=new ir.Protocol(ir);return sr.name="Protocol-"+Dt,sr.account=dr,sr.api=this,sr.message=this.message=new ir.Message({account:dr}),this.reporter=sr.reporter,this.statusProtector=sr.statusProtector,this.reporterHook=sr.reporterHook,this.abtInfo={},(typeof ie.get(ir,"privateConf.isABTestEnable")=="boolean"?ir.privateConf.isABTestEnable:oe.privateConf.isABTestEnable)&&this.abTestConfigRequset(),this.name=Dt,$e[Dt]=this,this},Lt.destroy=function(ir){var dr=this;(ir=ir||{}).done=de({instance:this,className:"ApiBaseFn",funcName:"destroy",done:ir.done});var Dt=this;if(!Dt.__beginDestroy){var lr;Dt.__beginDestroy=!0,ir=ir||{};var sr,er=this.name;if(this.logger.warn("destroy::start"),!er)return this.logger&&this.logger.warn&&this.logger.warn("destroy::no instanceName"),void(Dt.__beginDestroy=void 0);this.protocol&&(lr=this.protocol.connectTimer),this.protocol&&this.protocol.resetPush&&this.protocol.resetPush(),this.eventNames&&typeof this.eventNames=="function"&&i(sr=this.eventNames()).call(sr,function(cr){delete dr._events[cr]}),this.disconnect({done:function(cr){var or,hr,pr;Dt.logger.warn(`ApiBase::destroy: instance destroyed ...

`),Dt.__beginDestroy=void 0,Dt.reporter.destroy(),Dt.statusProtector.destroy(),Dt.reporterHook.destroy(),i(or=k(Dt.options)).call(or,function(Er){$(Er).call(Er,"on")===0&&(Dt.options[Er]=function(){},Dt.protocol.options[Er]=function(){},Dt.protocol.api.options[Er]=function(){})}),Dt.logger.destroy(),n(Dt.protocol.sessionSet)==="object"&&i(hr=L(Dt.protocol.sessionSet)).call(hr,function(Er){Dt.protocol.sessionSet[Er].unreadMsgs=[],Dt.protocol.sessionSet[Er]=void 0}),Dt.protocol.syncResult={},Dt.db&&Dt.db.close();var Sr=Dt.protocol;i(pr=k(Dt)).call(pr,function(Er){Dt[Er]=void 0}),$e&&($e[er]=null,clearTimeout(lr)),Sr&&(Sr.__destroyed=!0),ir.done instanceof Function&&ir.done(cr)}})}},Lt.setOptions=function(ir){var dr=Ne(ir);dr=qe(dr,this),this.protocol.setOptions(dr)},Lt.abTestConfigRequset=function(){var ir=this,dr=ir.options.abTestUrl||"https://abt-online.netease.im/v1/api/abt/client/getExperimentInfo",Dt={projectKey:"im1_sdk_abtest_web",appKey:ir.options.appKey,osType:"Web",sdkVersion:ir.info.version,deviceId:ae.deviceId},lr=V({clientInfo:Dt});this.protocol.adaptersRequest(dr,{method:"POST",timeout:5e3,headers:{"Content-Type":"application/json"},data:lr,onload:function(sr){var er=JSON.parse(sr);ir.abtInfo=er.data.abtInfo||{},ir.logger&&ir.logger.info("abTestConfigRequset::success",ir.abtInfo)},onerror:function(){ir.logger&&ir.logger.info("abTestConfigRequset::fail")}},{exception_service:7})},Lt.processCallback=function(ir,dr){Et(ir,dr)},Lt.processCallbackPromise=function(ir,dr){return new z(function(Dt,lr){Et(ir,dr,!0,Dt,lr)})};var Et=function(ir,dr,Dt,lr,sr){var er="api::processCallback";Dt&&(er="api::processCallbackPromise"),ie.verifyCallback(ir,"done",er),ir.callback=function(cr,or,hr){var pr=ir.callback.options;if(or=or||pr,dr&&(or=pr),ie.isFunction(ir.cbaop)){var Sr=ir.cbaop(cr,or);ue(Sr)&&(or=Sr)}var Er=ir.done;ie.isObject(or)&&(delete or.done,delete or.cb,delete or.callback),Dt?cr?sr({message:"生成接口回调错误",callFunc:er,event:cr}):lr(or):Er(cr,or,hr)},ir.callback.options=ie.copy(ir)};Lt.processPs=function(ir){ie.notexist(ir.ps)&&(ir.ps=""),ie.verifyArrayMax("ps",ir.ps,5e3)},Lt.processCustom=function(ir){ie.notexist(ir.custom)&&(ir.custom="")},Lt.sendCmd=function(){this.protocol.sendCmd.apply(this.protocol,arguments)},Lt.sendCmdWithResp=function(ir,dr,Dt){this.sendCmd(ir,dr,function(lr,sr,er){ie.isFunction(Dt)&&(lr?Dt(lr,sr):Dt(null,er))})},Lt.cbAndSendCmd=function(ir,dr){var Dt=this.processCallbackPromise(dr);return this.sendCmd(ir,dr),Dt},Lt.sendCmdUsePromise=function(ir,dr){var Dt=this,lr=de({instance:this,className:"ApiBaseFn",funcName:ir,hasCallback:!0});return new z(function(sr,er){Dt.sendCmd(ir,dr,function(cr,or,hr){if(cr)typeof lr=="function"&&lr(cr),er(cr);else{var pr=ie.merge({},or,hr);typeof lr=="function"&&lr(void 0),sr(pr)}})})},ze.use=function(ir,dr){ir&&ir.install&&ie.isFunction(ir.install)&&ir.install(this,dr)},ze.rmAllInstances=function(){for(var ir in $e)$e[ir].destroy();$e={}},Lt.logout=function(){var ir=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};ir.callback=de({instance:this,className:"ApiBaseFn",funcName:"logout",done:ir.callback}),ir=ir||{},this.protocol.shouldReconnect=!1,this.protocol.doLogout=!0,this.processCallback(ir),this.sendCmd("logout",ir,ir.callback),this.protocol.statusProtector.emit("auth/loginLifeCycleLogout")},t.exports=ze,e(588),e(589),e(631),e(632),e(642),e(646)},function(t,r,e){var n=e(90),g=e(32),y=e(4),i=e(16),k=e(158),$=e(7),L=e(71),V=e(6),z=e(2),re=e(8),ie=e(60),ue=e(24),le=e(26),oe=e(0),ae=oe.undef,qe=e(11),de=e(41),Ne=e(157),ze=Ne.StatusProtector,$e=(Ne.V2NIMLoginStatus,e(107)),Lt=$e.ReporterHook,jt=$e.EMSyncType,Et=e(647),ir=e(648),dr=e(649);function Dt(sr){oe.undef(sr.secure)&&(sr.secure=!0),this.options=sr,this.keepNosSafeUrl=this.options.keepNosSafeUrl||!1;var er=sr.defaultLink||sr.defaultLinkUrl;oe.notundef(er)&&oe.isString(er)&&(qe.optionDefaultLinkUrl=n(er).call(er)),oe.notundef(sr.ipv6DefaultLink)&&oe.isString(sr.ipv6DefaultLink)&&(qe.optionIpv6DefaultLinkUrl=sr.ipv6DefaultLink),typeof sr.heartbeatInterval=="number"&&(qe.heartbeatInterval=sr.heartbeatInterval),g(sr.nosLbsUrls)&&(qe.nosLbsUrls=sr.nosLbsUrls);var cr=this.options.socketConcurrent;cr=typeof cr=="number"&&cr>=1&&cr<=3?cr:1,this.options.socketConcurrent=cr,this.options.rollbackDelMsgUnread!==void 0&&typeof this.options.rollbackDelMsgUnread=="boolean"||(this.options.rollbackDelMsgUnread=!0),this.init(),this.connect()}var lr=Dt.fn=Dt.prototype;lr.init=function(){var sr=this;this.logger=this.options.logger,this.getNosOriginUrlReqNum=0,this.checkNosReqNum=0,this.timerMap={},this.cmdCallbackMap={},this.cmdContentMap={},this.initConnect(),this.reset(),this.statusProtector=new ze(this),this.reporterHook=new Lt(this,this.options.reporterHookConfig),this.reporterHookLinkKeep=new Et(this),this.promiseAbortManager=new ir,this.imsocket=new dr(this,{socketConcurrent:this.options.socketConcurrent}),this.statusProtector.on("auth/loginLifeCycleLogout",function(){sr.promiseAbortManager.clear()}),this.statusProtector.on("auth/loginLifeCycleLoginSucc",function(){sr.reporterHook.reset(),sr.reporterHook.setOriginTimetick()})},lr.reset=function(){ae(this.options.thumbnailToStatic)&&(this.options.thumbnailToStatic=!0),this.resetConnect()},lr.setOptions=function(sr){var er=this.options,cr=y(er),or=y(sr),hr=["onconnect","onerror","onwillreconnect","ondisconnect","onloginportschange","onmyinfo","onblacklist","onmutelist","onfriends","onusers","onrobots","onteams","onSuperTeams","onsessions","onSessionsWithMoreRoaming","onStickTopSessions","onroamingmsgs","onofflinemsgs","onofflinefiltermsgs","onroamingsysmsgs","onofflinesysmsgs","onofflinefiltersysmsgs","onofflinecustomsysmsgs","onofflinefiltercustomsysmsgs","onbroadcastmsg","onbroadcastmsgs","onsysmsgunread","onsyncdone","onteammembers","onsyncteammembersdone","onsyncsuperteammembersdone","onmsg","onsysmsg","oncustomsysmsg","onupdatemyinfo","onupdateuser","onSyncUpdateServerSession","onUpdateSuperTeamMember","onMySuperTeamMembers","onCreateSuperTeam","onUpdateSuperTeam","onAddSuperTeamMembers","onRemoveSuperTeamMembers","onUpdateSuperTeamManagers","onDismissSuperTeam","onTransferSuperTeam","onUpdateSuperTeamMembersMute","onupdateteammember","onMyTeamMembers","onMsgReceipts","onCreateTeam","onUpdateTeam","onAddTeamMembers","onRemoveTeamMembers","onUpdateTeamManagers","onDismissTeam","onTransferTeam","onUpdateTeamMembersMute","onTeamMsgReceipt","onupdatesession","onQuickComment","onDeleteQuickComment","onPinMsgChange","onupdatesysmsgunread","onupdatesysmsg","onsynccreateteam","onsyncsupercreateteam","onsyncmarkinblacklist","onsyncmarkinmutelist","onsyncfriendaction","shouldIgnoreNotification","shouldIgnoreMsg","onDeleteMsgSelf","shouldCountNotifyUnread","onPushNotificationMultiportConfig","onPushNotificationMultiportConfigUpdate","onpushevents"],pr=i(or).call(or,function(Er){return k(hr).call(hr,Er)}),Sr=$(cr).call(cr,"account");oe.verifyCallback(sr,pr,"protocol::IMProtocol"),this.logger.info("setOptions::",oe.omitAsString(sr,["appKey","token","loginExt","customTag"])),Sr!==-1&&L(cr).call(cr,Sr,1),sr=oe.filterObj(sr,cr),this.options=oe.merge(er,sr),this.reset()},lr.sendCmd=function(sr){var er,cr=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",or=arguments.length>2?arguments[2]:void 0,hr=this;hr.heartbeat();var pr,Sr=sr,Er=(sr=hr.parser.createCmd(sr,cr)).SER;cr=cr||{},hr.cmdContentMap[Er]=cr,cr.single&&(delete cr.single,(pr=y(cr)).length===1&&(hr.cmdContentMap[Er]=cr[pr[0]])),cr.__exceptionInfo={target:V(er="".concat(sr.SID,"-")).call(er,sr.CID),context:Er,startTime:hr.reporterHook.getSafeClock()},cr.NOTSTORE&&(pr=cr.NOTSTORE.split(" "),z(pr).call(pr,function(Pr){delete cr[Pr]}),delete cr.NOTSTORE),(or=or||cr.callback)&&(hr.cmdCallbackMap[Er]=or),hr.executeCmdTask({cmdName:Sr,cmd:re(sr)})},lr.executeCmdTask=function(sr){var er=sr.cmdName,cr=sr.cmd,or=(cr=JSON.parse(cr)).SER;this.isFrequencyControlled(er)?(this.logger.warn("protocol::executeCmdTask: ".concat(er," hit freq control")),this.markCallbackInvalid(or,de.newFrequencyControlError({callFunc:"protocol::executeCmdTask",message:"".concat(er," hit freq control")}))):this.hasLogin?(er!=="heartbeat"&&(this.logger.debugEnable?this.logger.debug("protocol::sendCmd: ".concat(sr.cmd)):this.logger.info("protocol::sendCmd: ".concat(er))),this.doSendCmd(cr)):er==="login"&&this.isConnected()?(this.logger.debugEnable?this.logger.debug("protocol::sendCmd: ".concat(sr.cmd)):this.logger.info("protocol::sendCmd: ".concat(er)),this.doSendCmd(cr)):(this.logger.warn("protocol::executeCmdTask: ".concat(er," not connected or login")),this.markCallbackInvalid(or,de.newSocketStateError({callFunc:"protocol::executeCmdTask",message:"".concat(er," not connected or not login")})))},lr.isFrequencyControlled=function(sr){var er=this.frequencyControlMap&&this.frequencyControlMap[sr];if(er){if(ie()<er.from+er.duration)return!0;delete this.frequencyControlMap[sr]}},lr.doSendCmd=function(sr){var er=this,cr=sr.SER,or=cr===0?qe.hbCmdTimeout:qe.cmdTimeout,hr=new Date().getTime(),pr=er.cmdContentMap[cr];function Sr(){er.markCallbackInvalid(cr,de.newSocketStateError({callFunc:"protocol::doSendCmd",message:"ser ".concat(cr," socketSendJson Error")})),er.onDisconnect("protocol::doSendCmd:socketSendJson","broken")}pr&&pr.__exceptionInfo&&(pr.__exceptionInfo.startTime=er.reporterHook.getSafeClock()),sr.isAwaitable&&(er.timerMap[cr]=ue(function(){var Er;sr.SID!==1&&sr.CID!==2&&er.detectHeartbeat(),er.markCallbackInvalid(cr,de.newTimeoutError({callFunc:"protocol::doSendCmd",message:"ser ".concat(cr," Timeout Error")})),er.reporter.reportTraceStart("exceptions",{user_id:oe.get(er,"options.account")||"",trace_id:oe.get(er,"socket.socket.sessionid"),start_time:hr,action:2,exception_service:6}),er.reporter.reportTraceUpdateV2("exceptions",{code:408,description:"Packet timeout",operation_type:1,target:V(Er="".concat(sr.SID,"-")).call(Er,sr.CID),context:"".concat(sr.SER),net_connect:er.checkNetworkAvailable()}),er.reporter.reportTraceEnd("exceptions",1)},or));try{er.socket&&er.socket.send?er.socket.send(re(sr)):Sr()}catch{Sr()}},lr.getObjWithSer=function(sr){var er=this.cmdContentMap[sr];return er&&!er.isImSyncDataObj&&delete this.cmdContentMap[sr],er&&oe.copy(er)},lr.getCallbackWithSer=function(sr){var er=this.cmdCallbackMap[sr];return er&&!er.isImSyncDataCb&&delete this.cmdCallbackMap[sr],er},lr.getTimerWithSer=function(sr){var er=this.timerMap[sr];return delete this.timerMap[sr],er},lr.clearTimerWithSer=function(sr){var er=this.getTimerWithSer(sr);er&&clearTimeout(er)},lr.markCallbackInvalid=function(sr,er){this.getObjWithSer(sr),this.clearTimerWithSer(sr);var cr=this.getCallbackWithSer(sr);if(cr){var or=cr.options;ue(function(){cr(er||de.newUnknownError({ser:sr}),or)},0)}},lr.markAllCallbackInvalid=function(sr){var er=this;try{var cr,or;z(cr=y(this.cmdContentMap)).call(cr,function(hr){var pr=er.getObjWithSer(hr);if(pr&&pr.__exceptionInfo){var Sr=pr.__exceptionInfo.target,Er=pr.__exceptionInfo.context,Pr=oe.get(sr,"event.uploadCode")||sr&&sr.code;Pr=typeof Pr!="number"?415:Pr;var Cr=oe.get(sr,"event.disconnectReason"),rr=Cr?re({disconnect_reason:Cr}):sr&&sr.message||"send cmd failed";er.reporter.reportTraceStart("exceptions",{user_id:oe.get(er,"options.account")||"",trace_id:oe.get(er,"socket.socket.sessionid"),start_time:er.reporterHook.getNTPTime(pr.__exceptionInfo.startTime),action:2,exception_service:6}),er.reporter.reportTraceUpdateV2("exceptions",{code:Pr,description:rr,operation_type:1,target:Sr,context:Er,net_connect:er.checkNetworkAvailable()}),er.reporter.reportTraceEnd("exceptions",1),delete pr.__exceptionInfo}}),z(or=y(this.cmdCallbackMap)).call(or,function(hr){er.markCallbackInvalid(hr,sr)})}catch(hr){er.logger&&er.logger.error("protocol::markAllCallbackInvalid error: ",hr)}},lr.getPacketObj=function(sr){var er=null;if(sr&&sr.raw){var cr=sr.raw.ser;oe.notundef(cr)&&(er=this.getObjWithSer(cr))}return er},lr.callPacketAckCallback=function(sr){var er=this;if(sr&&sr.raw){var cr=sr.raw.ser;if(oe.notundef(cr)){er.clearTimerWithSer(cr);var or=er.getCallbackWithSer(cr);if(or){var hr;or.originUrl&&sr.obj&&sr.obj.file&&(sr.obj.file._url_safe=sr.obj.file.url,sr.obj.file.url=or.originUrl,sr.obj.type==="audio"&&(sr.obj.file.mp3Url=or.originUrl+(~$(hr=or.originUrl).call(hr,"?")?"&":"?")+"audioTrans&type=mp3")),sr.promise?sr.promise.then(function(){or(sr.error,sr.obj)},function(pr){var Sr,Er;pr.callFunc="protocol::callPacketAckCallback",pr.message=V(Sr=V(Er="Resp Promoise Error: cmd: ".concat(sr.cmd,", ser: ")).call(Er,cr,", reason: ")).call(Sr,pr.message);var Pr=de.customError("CALLBACK_ACK_ERR",pr);er.logger.error(`protocol::callPacketAckCallback error stack: 
`.concat(pr.stack||pr.event&&pr.event.stack)),or(Pr,sr.obj,sr.content)}):or(sr.error,sr.obj,sr.content)}}}},lr.onMessage=function(sr){var er=this;er.heartbeat(),er.parser.parseResponse(sr).then(function(cr){var or;if(cr.notFound&&er.logger.warn("protocol::onMessage: packet not found ".concat(re(cr))),cr.error){var hr,pr;cr.error.message=V(hr="".concat(cr.cmd," error: ")).call(hr,cr.error.message),er.logger.error(V(pr="protocol::onMessage: packet error ".concat(re(cr.error),"，raw cmd ")).call(pr,cr.rawStr));var Sr=cr.raw||{};Sr.code!==408&&Sr.code!==415&&Sr.code!==500||er.reporter.report("nimErrEvent",{code:Sr.code,module:cr.cmd,accid:er.account})}cr.__receiveTime=er.reporterHook.getSafeClock();var Er=jt[V(or="kSyncType".concat(cr.raw.sid,"_")).call(or,cr.raw.cid)];if(Er){var Pr=oe.get(cr,"raw.r"),Cr=1;if(Pr&&Pr.length>0){var rr=i(Pr).call(Pr,function(Mr){return g(Mr)}),kr=oe.get(rr,"0.length");Cr=typeof kr=="number"?kr:1}er.reporterHook.emit("reporter/syncItem",Er,Cr)}cr.frequencyControlDuration&&(er.logger.error("protocol::onMessage: server freq control ".concat(re(cr.cmd))),er.frequencyControlMap=er.frequencyControlMap||{},er.frequencyControlMap[cr.cmd]={from:+new Date,duration:cr.frequencyControlDuration}),cr.obj=er.getPacketObj(cr),cr.obj&&cr.obj.__exceptionInfo&&delete cr.obj.__exceptionInfo,cr.cmd!=="heartbeat"&&(er.logger.debugEnable?er.logger.debug("protocol::recvCmd: ".concat(cr.rawStr)):er.logger.log("protocol::recvCmd: ".concat(cr.cmd)));var Ir="process"+oe.capFirstLetter(cr.service);if(er[Ir])if(cr.cmd==="syncDone"){if(er.cmdCallbackMap[cr.raw.ser]&&er.cmdCallbackMap[cr.raw.ser].isImSyncDataCb){var xr;er.cmdCallbackMap[cr.raw.ser].isImSyncDataCb=!1;var vr=le(xr=function(Mr,yr){this.checkNosReqNum++,this.getNosOriginUrlReqNum<=0||this.checkNosReqNum>=20?this[Mr](yr):ue(vr,300)}).call(xr,er,Ir,cr);ue(function(){vr.call(er,Ir,cr)},10)}}else{cr.cmd!=="syncTeamMembersDone"&&cr.cmd!=="syncSuperTeamMembersDone"||er.cmdCallbackMap[cr.raw.ser]&&er.cmdCallbackMap[cr.raw.ser].isImSyncDataCb&&(er.cmdCallbackMap[cr.raw.ser].isImSyncDataCb=!1);try{er[Ir](cr)}catch(Mr){var _r,Or;er.logger.warn(V(_r=V(Or="protocol::onMessage: ".concat(Ir,".")).call(Or,cr.cmd," excute failed ")).call(_r,cr.obj?"":", maybe the packet timed out",": "),Mr.message)}}else er.logger.warn("protocol::onMessage: ".concat(Ir," not found"));er.callPacketAckCallback(cr)})},lr.onMiscError=function(sr,er,cr){er&&this.notifyError(sr,er,cr)},lr.onCustomError=function(sr,er){var cr=de.customError(sr,er),or=er.message||"未知错误";this.onMiscError(or,cr)},lr.notifyError=function(sr,er,cr){var or;this.isConnected()&&(this.logger.error(V(or="".concat(sr||""," ")).call(or,this.name),er,cr),this.options.onerror(er,cr))},lr.emitAPI=function(sr){var er=sr.type,cr=sr.obj;this.api.emit(er,cr)},t.exports=Dt,e(669),e(685),e(686),e(687),e(688),e(689)},function(t,r,e){var n=e(109),g=Function.prototype,y=g.apply,i=g.call;t.exports=typeof Reflect=="object"&&Reflect.apply||(n?i.bind(y):function(){return i.apply(y,arguments)})},function(t,r){t.exports=function(e,n){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:n}}},function(t,r){var e=String;t.exports=function(n){try{return e(n)}catch{return"Object"}}},function(t,r,e){var n=e(5);t.exports=function(g,y){var i=[][g];return!!i&&n(function(){i.call(null,y||function(){return 1},1)})}},function(t,r,e){var n=e(65);t.exports=Array.isArray||function(g){return n(g)=="Array"}},function(t,r,e){var n,g=e(36),y=e(166),i=e(167),k=e(114),$=e(218),L=e(162),V=e(133),z=V("IE_PROTO"),re=function(){},ie=function(oe){return"<script>"+oe+"<\/script>"},ue=function(oe){oe.write(ie("")),oe.close();var ae=oe.parentWindow.Object;return oe=null,ae},le=function(){try{n=new ActiveXObject("htmlfile")}catch{}var oe,ae;le=typeof document<"u"?document.domain&&n?ue(n):((ae=L("iframe")).style.display="none",$.appendChild(ae),ae.src="javascript:",(oe=ae.contentWindow.document).open(),oe.write(ie("document.F=Object")),oe.close(),oe.F):ue(n);for(var qe=i.length;qe--;)delete le.prototype[i[qe]];return le()};k[z]=!0,t.exports=Object.create||function(oe,ae){var qe;return oe!==null?(re.prototype=g(oe),qe=new re,re.prototype=null,qe[z]=oe):qe=le(),ae===void 0?qe:y.f(qe,ae)}},function(t,r,e){var n=e(165),g=e(39).f,y=e(61),i=e(30),k=e(334),$=e(21)("toStringTag");t.exports=function(L,V,z,re){if(L){var ie=z?L:L.prototype;i(ie,$)||g(ie,$,{configurable:!0,value:V}),re&&!n&&y(ie,"toString",k)}}},function(t,r,e){var n=e(44),g=e(199),y=e(103),i=e(101),k=e(39).f,$=e(169),L=e(170),V=e(49),z=e(27),re=i.set,ie=i.getterFor("Array Iterator");t.exports=$(Array,"Array",function(le,oe){re(this,{type:"Array Iterator",target:n(le),index:0,kind:oe})},function(){var le=ie(this),oe=le.target,ae=le.kind,qe=le.index++;return!oe||qe>=oe.length?(le.target=void 0,L(void 0,!0)):L(ae=="keys"?qe:ae=="values"?oe[qe]:[qe,oe[qe]],!1)},"values");var ue=y.Arguments=y.Array;if(g("keys"),g("values"),g("entries"),!V&&z&&ue.name!=="values")try{k(ue,"name",{value:"values"})}catch{}},function(t,r,e){var n=e(503),g=e(508);t.exports=function(y,i){var k=g(y,i);return n(k)?k:void 0}},function(t,r,e){t.exports=e(301)},function(t,r,e){t.exports=e(219)},function(t,r,e){t.exports=e(577)},function(t,r){t.exports=function(e){var n=typeof e;return e!=null&&(n=="object"||n=="function")}},function(t,r){t.exports=function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,r,e){var n=e(140),g=e(250);function y(i,k){for(var $=0;$<k.length;$++){var L=k[$];L.enumerable=L.enumerable||!1,L.configurable=!0,"value"in L&&(L.writable=!0),n(i,g(L.key),L)}}t.exports=function(i,k,$){return k&&y(i.prototype,k),$&&y(i,$),n(i,"prototype",{writable:!1}),i},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,r,e){(function(n){var g;t.exports=(g=g||function(y,i){var k;if(typeof window<"u"&&window.crypto&&(k=window.crypto),typeof self<"u"&&self.crypto&&(k=self.crypto),typeof globalThis<"u"&&globalThis.crypto&&(k=globalThis.crypto),!k&&typeof window<"u"&&window.msCrypto&&(k=window.msCrypto),!k&&n!==void 0&&n.crypto&&(k=n.crypto),!k)try{k=e(892)}catch{}var $=function(){if(k){if(typeof k.getRandomValues=="function")try{return k.getRandomValues(new Uint32Array(1))[0]}catch{}if(typeof k.randomBytes=="function")try{return k.randomBytes(4).readInt32LE()}catch{}}throw new Error("Native crypto module could not be used to get secure random number.")},L=Object.create||function(){function Ne(){}return function(ze){var $e;return Ne.prototype=ze,$e=new Ne,Ne.prototype=null,$e}}(),V={},z=V.lib={},re=z.Base={extend:function(Ne){var ze=L(this);return Ne&&ze.mixIn(Ne),ze.hasOwnProperty("init")&&this.init!==ze.init||(ze.init=function(){ze.$super.init.apply(this,arguments)}),ze.init.prototype=ze,ze.$super=this,ze},create:function(){var Ne=this.extend();return Ne.init.apply(Ne,arguments),Ne},init:function(){},mixIn:function(Ne){for(var ze in Ne)Ne.hasOwnProperty(ze)&&(this[ze]=Ne[ze]);Ne.hasOwnProperty("toString")&&(this.toString=Ne.toString)},clone:function(){return this.init.prototype.extend(this)}},ie=z.WordArray=re.extend({init:function(Ne,ze){Ne=this.words=Ne||[],this.sigBytes=ze??4*Ne.length},toString:function(Ne){return(Ne||le).stringify(this)},concat:function(Ne){var ze=this.words,$e=Ne.words,Lt=this.sigBytes,jt=Ne.sigBytes;if(this.clamp(),Lt%4)for(var Et=0;Et<jt;Et++){var ir=$e[Et>>>2]>>>24-Et%4*8&255;ze[Lt+Et>>>2]|=ir<<24-(Lt+Et)%4*8}else for(var dr=0;dr<jt;dr+=4)ze[Lt+dr>>>2]=$e[dr>>>2];return this.sigBytes+=jt,this},clamp:function(){var Ne=this.words,ze=this.sigBytes;Ne[ze>>>2]&=4294967295<<32-ze%4*8,Ne.length=y.ceil(ze/4)},clone:function(){var Ne=re.clone.call(this);return Ne.words=this.words.slice(0),Ne},random:function(Ne){for(var ze=[],$e=0;$e<Ne;$e+=4)ze.push($());return new ie.init(ze,Ne)}}),ue=V.enc={},le=ue.Hex={stringify:function(Ne){for(var ze=Ne.words,$e=Ne.sigBytes,Lt=[],jt=0;jt<$e;jt++){var Et=ze[jt>>>2]>>>24-jt%4*8&255;Lt.push((Et>>>4).toString(16)),Lt.push((15&Et).toString(16))}return Lt.join("")},parse:function(Ne){for(var ze=Ne.length,$e=[],Lt=0;Lt<ze;Lt+=2)$e[Lt>>>3]|=parseInt(Ne.substr(Lt,2),16)<<24-Lt%8*4;return new ie.init($e,ze/2)}},oe=ue.Latin1={stringify:function(Ne){for(var ze=Ne.words,$e=Ne.sigBytes,Lt=[],jt=0;jt<$e;jt++){var Et=ze[jt>>>2]>>>24-jt%4*8&255;Lt.push(String.fromCharCode(Et))}return Lt.join("")},parse:function(Ne){for(var ze=Ne.length,$e=[],Lt=0;Lt<ze;Lt++)$e[Lt>>>2]|=(255&Ne.charCodeAt(Lt))<<24-Lt%4*8;return new ie.init($e,ze)}},ae=ue.Utf8={stringify:function(Ne){try{return decodeURIComponent(escape(oe.stringify(Ne)))}catch{throw new Error("Malformed UTF-8 data")}},parse:function(Ne){return oe.parse(unescape(encodeURIComponent(Ne)))}},qe=z.BufferedBlockAlgorithm=re.extend({reset:function(){this._data=new ie.init,this._nDataBytes=0},_append:function(Ne){typeof Ne=="string"&&(Ne=ae.parse(Ne)),this._data.concat(Ne),this._nDataBytes+=Ne.sigBytes},_process:function(Ne){var ze,$e=this._data,Lt=$e.words,jt=$e.sigBytes,Et=this.blockSize,ir=jt/(4*Et),dr=(ir=Ne?y.ceil(ir):y.max((0|ir)-this._minBufferSize,0))*Et,Dt=y.min(4*dr,jt);if(dr){for(var lr=0;lr<dr;lr+=Et)this._doProcessBlock(Lt,lr);ze=Lt.splice(0,dr),$e.sigBytes-=Dt}return new ie.init(ze,Dt)},clone:function(){var Ne=re.clone.call(this);return Ne._data=this._data.clone(),Ne},_minBufferSize:0}),de=(z.Hasher=qe.extend({cfg:re.extend(),init:function(Ne){this.cfg=this.cfg.extend(Ne),this.reset()},reset:function(){qe.reset.call(this),this._doReset()},update:function(Ne){return this._append(Ne),this._process(),this},finalize:function(Ne){return Ne&&this._append(Ne),this._doFinalize()},blockSize:16,_createHelper:function(Ne){return function(ze,$e){return new Ne.init($e).finalize(ze)}},_createHmacHelper:function(Ne){return function(ze,$e){return new de.HMAC.init(Ne,$e).finalize(ze)}}}),V.algo={});return V}(Math),g)}).call(this,e(73))},function(t,r,e){var n=e(27),g=e(20),y=e(150),i=e(80),k=e(44),$=e(128),L=e(30),V=e(210),z=Object.getOwnPropertyDescriptor;r.f=n?z:function(re,ie){if(re=k(re),ie=$(ie),V)try{return z(re,ie)}catch{}if(L(re,ie))return i(!g(y.f,re,ie),re[ie])}},function(t,r){t.exports=function(e){return e==null}},function(t,r,e){var n=e(98),g=e(5);t.exports=!!Object.getOwnPropertySymbols&&!g(function(){var y=Symbol();return!String(y)||!(Object(y)instanceof Symbol)||!Symbol.sham&&n&&n<41})},function(t,r,e){var n,g,y=e(14),i=e(66),k=y.process,$=y.Deno,L=k&&k.versions||$&&$.version,V=L&&L.v8;V&&(g=(n=V.split("."))[0]>0&&n[0]<4?1:+(n[0]+n[1])),!g&&i&&(!(n=i.match(/Edge\/(\d+)/))||n[1]>=74)&&(n=i.match(/Chrome\/(\d+)/))&&(g=+n[1]),t.exports=g},function(t,r,e){var n=e(128),g=e(39),y=e(80);t.exports=function(i,k,$){var L=n(k);L in i?g.f(i,L,y(0,$)):i[L]=$}},function(t,r){},function(t,r,e){var n,g,y,i=e(335),k=e(14),$=e(28),L=e(61),V=e(30),z=e(161),re=e(133),ie=e(114),ue=k.TypeError,le=k.WeakMap;if(i||z.state){var oe=z.state||(z.state=new le);oe.get=oe.get,oe.has=oe.has,oe.set=oe.set,n=function(qe,de){if(oe.has(qe))throw ue("Object already initialized");return de.facade=qe,oe.set(qe,de),de},g=function(qe){return oe.get(qe)||{}},y=function(qe){return oe.has(qe)}}else{var ae=re("state");ie[ae]=!0,n=function(qe,de){if(V(qe,ae))throw ue("Object already initialized");return de.facade=qe,L(qe,ae,de),de},g=function(qe){return V(qe,ae)?qe[ae]:{}},y=function(qe){return V(qe,ae)}}t.exports={set:n,get:g,has:y,enforce:function(qe){return y(qe)?g(qe):n(qe,{})},getterFor:function(qe){return function(de){var Ne;if(!$(de)||(Ne=g(de)).type!==qe)throw ue("Incompatible receiver, "+qe+" required");return Ne}}}},function(t,r,e){var n=e(12);t.exports=n([].slice)},function(t,r){t.exports={}},function(t,r){t.exports=function(e){try{return{error:!1,value:e()}}catch(n){return{error:!0,value:n}}}},function(t,r,e){var n=e(14);t.exports=n.Promise},function(t,r){t.exports=function(e){return e!=null&&typeof e=="object"}},function(t,r,e){var n=e(279),g=e(60),y=e(3),i=e(24),k=e(26),$=e(6),L=e(48),V=e(16),z=e(2),re=e(4),ie=e(9),ue=e(123),le=e(37),oe=e(92),ae=e(93),qe=e(281),de=e(282),Ne=e(192);function ze(sr){var er=function(){if(typeof Reflect>"u"||!n||n.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(n(Boolean,[],function(){})),!0}catch{return!1}}();return function(){var cr,or=Ne(sr);if(er){var hr=Ne(this).constructor;cr=n(or,arguments,hr)}else cr=or.apply(this,arguments);return de(this,cr)}}var $e=e(173),Lt=e(0),jt=e(11).heartbeatInterval,Et=e(157).V2NIMLoginStatus,ir=e(11),dr={kSyncAction5_1:0,kSyncAction5_2:1,kSyncAction5_3:2},Dt={kKnown:-1,kSucceed:0,kFailed:1,kAborted:2,kCanceled:3},lr=function(sr){qe(cr,sr);var er=ze(cr);function cr(or){var hr,pr=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return oe(this,cr),(hr=er.call(this)).clientProto=or,hr.logger=or.logger,hr.reporter=or.reporter,hr.timer=null,hr.setClientOrigin(),hr.serverOrigin={timeStamp:null,rtt:null,baseTimeStamp:null},hr.tolerantRTT=pr.tolerantRTT||3e3,hr.bestRTT=pr.bestRTT||100,hr.maxChances=pr.maxChances||10,hr.isSettingNTP=!1,hr.currentChance=0,hr.syncTraceData={},hr.syncTraceMap={},hr.syncTraceLastItem={},hr.uploadTraceData={},hr.setMonitorForSync(),hr.setMonitorForResources(),hr}return ae(cr,[{key:"hasOriginTimetick",value:function(){return!!this.serverOrigin.timeStamp}},{key:"setOriginTimetick",value:function(){var or=this,hr=this.clientProto.options;if((typeof Lt.get(hr,"privateConf.isDataReportEnable")=="boolean"?hr.privateConf.isDataReportEnable:ir.privateConf.isDataReportEnable)&&ir.isBrowser&&performance&&performance.now&&!(this.isSettingNTP||this.currentChance>=this.maxChances)){this.isSettingNTP=!0,this.currentChance++,clearTimeout(this.timer),this.timer=null;var pr="ReporterHook::setOriginTimetick:",Sr=g();return this.logger.info("".concat(pr," getServerTime start, times ").concat(this.currentChance)),new y(function(Er){or.clientProto.sendCmd("getServerTime",{},function(Pr,Cr){if(or.isSettingNTP=!1,Pr){var rr;or.logger.warn("".concat(pr," Calculate Delay time, getServerTime error"),Pr),or.clientProto.statusProtector.getLoginStatus()===Et.V2NIM_LOGIN_STATUS_LOGINED&&(or.timer=i(k(rr=or.setOriginTimetick).call(rr,or),jt)),Er()}else{if(!Cr)return or.logger.warn("".concat(pr," Calculate Delay time, getServerTime not correct")),void Er();var kr,Ir=g()-Sr;if(Ir>or.tolerantRTT)or.logger.warn("".concat(pr," Denied, cause of exceeding the maximum tolerance range of RTT: ").concat(Ir)),or.timer=i(k(kr=or.setOriginTimetick).call(kr,or),jt);else if(Ir>or.bestRTT){var xr,vr,_r;or.serverOrigin.rtt&&Ir>=or.serverOrigin.rtt?or.logger.info("".concat(pr," Denied, cause of current.RTT >= serverOrigin.RTT: ").concat(Ir)):(or.setServerOrigin(Ir,Cr),or.logger.info($(vr=$(_r="".concat(pr," Accept within maximum tolerance range of RTT: ").concat(Ir,", ntpTimestamp: ")).call(_r,or.serverOrigin.timeStamp,", localClock: ")).call(vr,or.serverOrigin.baseTimeStamp))),or.timer=i(k(xr=or.setOriginTimetick).call(xr,or),jt)}else{var Or,Mr;or.setServerOrigin(Ir,Cr),or.logger.info($(Or=$(Mr="".concat(pr," Accept within best RTT: ").concat(Ir,", ntpTimestamp: ")).call(Mr,or.serverOrigin.timeStamp,", localClock: ")).call(Or,or.serverOrigin.baseTimeStamp))}Er()}})})}}},{key:"getNTPTime",value:function(or){if(typeof or!="number"&&(or=this.getSafeClock()),this.serverOrigin.timeStamp){var hr=L(or-this.serverOrigin.baseTimeStamp);return this.serverOrigin.timeStamp+hr}var pr=L(or-this.clientOrigin.baseTimeStamp);return this.clientOrigin.timeStamp+pr}},{key:"getSafeClock",value:function(){return ir.isBrowser&&performance&&performance.now?performance.now():g()}},{key:"setMonitorForSync",value:function(){var or=this,hr="ReporterHook::setMonitorForSync:";this.on("reporter/syncStart",function(){or.logger.info("".concat(hr," sync start")),or.syncTraceData={user_id:or.clientProto.account,trace_id:Lt.get(or.clientProto,"socket.socket.sessionid"),action:dr.kSyncAction5_1,sync_begin_time:or.getSafeClock(),sync_end_time:0,sync_duration:0,overall_duration:0,extension:[]}}),this.on("reporter/syncRecv",function(){or.syncTraceData.user_id&&(or.logger.info("".concat(hr," sync receive packet")),or.syncTraceData.sync_end_time=or.getSafeClock(),or.syncTraceData.sync_duration=L(or.syncTraceData.sync_end_time-or.syncTraceData.sync_begin_time))}),this.on("reporter/syncItem",function(pr,Sr){var Er;if(typeof pr=="number"&&or.syncTraceData.user_id){or.logger.info($(Er="".concat(hr," receive sync item: ").concat(pr,", total: ")).call(Er,Sr));var Pr=or.getSafeClock();or.syncTraceMap[pr]=or.syncTraceMap[pr]?or.syncTraceMap[pr]:{sync_type:pr,times:0,total:0,sync_duration:0,proc_duration:0,description:"",items:[]};var Cr={total:Sr,pre_item_recv_time:or.syncTraceLastItem.cur_item_recv_time?or.syncTraceLastItem.cur_item_recv_time:or.syncTraceData.sync_begin_time,cur_item_recv_time:Pr};or.syncTraceMap[pr].items.push(Cr),or.syncTraceLastItem=Cr}}),this.on("reporter/syncItemComplete",function(pr){var Sr;if(typeof pr=="number"&&or.syncTraceData.user_id){var Er=or.syncTraceMap[pr];if(Er){or.logger.info("".concat(hr," sync item ").concat(pr," callback done"));var Pr=V(Sr=Er.items).call(Sr,function(Cr){return!Cr.callback_time});Pr.length!==0&&(Pr[0].callback_time=or.getSafeClock())}}}),this.on("reporter/syncComplete",function(){var pr;or.syncTraceData.user_id&&(or.logger.info("".concat(hr," sync complete")),z(pr=re(or.syncTraceMap)).call(pr,function(Sr){var Er,Pr=ie(Er=or.syncTraceMap[Sr].items).call(Er,function(rr){return{total:rr.total,pre_item_recv_time:or.getNTPTime(rr.pre_item_recv_time),cur_item_recv_time:or.getNTPTime(rr.cur_item_recv_time),callback_time:or.getNTPTime(rr.callback_time)}}),Cr=ue(Pr).call(Pr,function(rr,kr){return rr.times+=1,rr.total+=kr.total,rr.sync_duration+=kr.cur_item_recv_time-kr.pre_item_recv_time,rr.proc_duration+=kr.callback_time-kr.cur_item_recv_time,rr},{times:0,total:0,sync_duration:0,proc_duration:0});or.syncTraceMap[Sr].items=Pr,le(or.syncTraceMap[Sr],Cr),or.syncTraceData.extension.push(or.syncTraceMap[Sr])}),or.syncTraceData.sync_begin_time=or.getNTPTime(or.syncTraceData.sync_begin_time),or.syncTraceData.sync_end_time=or.getNTPTime(or.syncTraceData.sync_end_time),or.syncTraceData.overall_duration=or.getNTPTime()-or.syncTraceData.sync_begin_time,or.reporter.report("nim_sdk_sync",or.syncTraceData),or.syncTraceData={},or.syncTraceMap={})})}},{key:"setMonitorForResources",value:function(){var or=this,hr="ReporterHook::setMonitorForResources:";this.on("reporter/uploadStart",function(){or.logger.info("".concat(hr," upload start")),or.uploadTraceData={user_id:or.clientProto.account,trace_id:Lt.get(or.clientProto,"socket.socket.sessionid"),action:0,duration:0,start_time:or.getSafeClock(),offset:0,full_size:0,transferred_size:0}}),this.on("reporter/uploadUpdate",function(){var pr,Sr=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};or.uploadTraceData.user_id&&(or.logger.info("".concat(hr," upload update"),Sr),z(pr=re(Sr)).call(pr,function(Er){or.uploadTraceData[Er]=Sr[Er]}))}),this.on("reporter/uploadEnd",function(){var pr=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Dt.kKnown;or.uploadTraceData.user_id&&(or.logger.info("".concat(hr," upload end cause of ").concat(pr)),or.uploadTraceData.state=pr,or.uploadTraceData.start_time=or.getNTPTime(or.uploadTraceData.start_time),or.uploadTraceData.duration=or.getNTPTime(or.getSafeClock())-or.uploadTraceData.start_time,or.reporter.report("nim_sdk_resources",or.uploadTraceData),or.uploadTraceData={})})}},{key:"destroy",value:function(){this.reset(),this.removeAllListeners(),this.logger.info("ReporterHook::destroy: complete")}},{key:"reset",value:function(){this.logger.info("ReporterHook::reset"),this.serverOrigin={},this.setClientOrigin(),this.currentChance=0,this.timer&&clearTimeout(this.timer),this.syncTraceData={},this.syncTraceMap={},this.syncTraceLastItem={},this.uploadTraceData={}}},{key:"setClientOrigin",value:function(){this.clientOrigin={timeStamp:g(),baseTimeStamp:this.getSafeClock()}}},{key:"setServerOrigin",value:function(or,hr){this.serverOrigin={timeStamp:hr+L(or/2),rtt:or,baseTimeStamp:this.getSafeClock()}}}]),cr}($e);t.exports={EMSyncAction:dr,EMSyncType:{kSyncType3_8:30008,kSyncType3_109:30109,kSyncType4_4:40004,kSyncType4_6:40006,kSyncType4_9:40009,kSyncType4_12:40012,kSyncType4_13:40013,kSyncType4_14:40014,kSyncType4_16:40016,kSyncType4_17:40017,kSyncType4_18:40018,kSyncType4_19:40019,kSyncType4_20:40020,kSyncType4_21:40021,kSyncType4_23:40023,kSyncType4_24:40024,kSyncType4_100:40100,kSyncType4_101:40101,kSyncType7_15:70015,kSyncType8_109:80109,kSyncType8_126:80126,kSyncType12_5:12005,kSyncType12_6:12006,kSyncType15_13:15013,kSyncType21_109:21109,kSyncType21_111:21111},ReporterHook:lr,EMExceptionState:Dt,EMResourceUploadWay:{kResourceUploadWayNOS:0,kResourceUploadWayAWSPlugin:1,kResourceUploadWayNOSPlugin:2}}},function(t,r,e){var n=e(7),g=e(15),y=e(2),i=e(6),k=e(158),$=e(16),L=e(88),V=e(89),z=e(72),re=e(32);function ie(ae,qe){var de=V!==void 0&&z(ae)||ae["@@iterator"];if(!de){if(re(ae)||(de=function(Et,ir){var dr;if(Et){if(typeof Et=="string")return ue(Et,ir);var Dt=g(dr=Object.prototype.toString.call(Et)).call(dr,8,-1);if(Dt==="Object"&&Et.constructor&&(Dt=Et.constructor.name),Dt==="Map"||Dt==="Set")return L(Et);if(Dt==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(Dt))return ue(Et,ir)}}(ae))||qe&&ae&&typeof ae.length=="number"){de&&(ae=de);var Ne=0,ze=function(){};return{s:ze,n:function(){return Ne>=ae.length?{done:!0}:{done:!1,value:ae[Ne++]}},e:function(Et){throw Et},f:ze}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var $e,Lt=!0,jt=!1;return{s:function(){de=de.call(ae)},n:function(){var Et=de.next();return Lt=Et.done,Et},e:function(Et){jt=!0,$e=Et},f:function(){try{Lt||de.return==null||de.return()}finally{if(jt)throw $e}}}}function ue(ae,qe){(qe==null||qe>ae.length)&&(qe=ae.length);for(var de=0,Ne=new Array(qe);de<qe;de++)Ne[de]=ae[de];return Ne}var le=e(11),oe={genUrlSep:function(ae){return n(ae=""+ae).call(ae,"?")===-1?"?imageView&":"&"},urlQuery2Object:function(ae){if(Object.prototype.toString.call(ae)!=="[object String]"||ae==="")return{};var qe=n(ae).call(ae,"?");if(qe!==-1){var de=g(ae).call(ae,qe+1).split("&"),Ne={};return y(de).call(de,function(ze){if(~n(ze).call(ze,"=")){var $e=ze.split("=");Ne[$e[0]]=decodeURIComponent($e[1])}else Ne[ze]=""}),Ne}},url2object:function(ae){Object.prototype.toString.call(ae)!=="[object String]"&&(ae="");var qe=n(ae=ae||"").call(ae,"https")>=0?"https://":"http://",de=ae.replace(qe,"");n(de).call(de,"?")>=0&&(de=de.substring(0,n(de).call(de,"?")));var Ne=de.split("/");de=Ne[0];var ze="";if(Ne.length>0&&(ze=g(Ne).call(Ne,1).join("/")),n(ae).call(ae,"?")===-1)return{protocol:qe,hostname:de,path:ze,query:{}};var $e=ae.substr(n(ae).call(ae,"?")+1).split("&"),Lt={};return y($e).call($e,function(jt){if(n(jt).call(jt,"=")>0){var Et=jt.split("=");Lt[Et[0]]=decodeURIComponent(Et[1])}else Lt[jt]=""}),{protocol:qe,hostname:de,path:ze,query:Lt}},object2url:function(ae){var qe,de=ae.protocol,Ne=ae.hostname,ze=ae.path,$e=ae.query;de=de||"http://",Ne=Ne||"",ze&&(Ne=i(qe="".concat(Ne,"/")).call(qe,ze)),$e=$e||{};var Lt,jt,Et,ir=[];for(var dr in $e){var Dt;dr!=="imageView"&&ir.push(i(Dt="".concat(dr,"=")).call(Dt,encodeURIComponent($e[dr])))}return ir.length>0?i(Lt=i(jt="".concat(de)).call(jt,Ne,"?imageView&")).call(Lt,ir.join("&")):i(Et="".concat(de)).call(Et,Ne)},genPrivateUrl:function(ae,qe,de){if(qe&&qe.length){var Ne,ze=ie(qe);try{for(ze.s();!(Ne=ze.n()).done;){var $e=Ne.value;if(n(ae).call(ae,$e)>=0)return $e!==de&&(ae=ae.replace($e,de)),ae;if(n(ae).call(ae,$e)>=0&&$e===de)return ae}}catch(rr){ze.e(rr)}finally{ze.f()}}var Lt,jt,Et=oe.url2object(ae),ir=Et.hostname,dr=Et.path,Dt=le.downloadUrl,lr=le.downloadHostList,sr=le.nosCdnEnable,er=le.serverNosConfig.cdnDomain,cr=decodeURIComponent(le.serverNosConfig.objectPrefix),or=decodeURIComponent(dr),hr=n(or).call(or,cr);if(er&&hr>-1&&sr)return i(Lt=i(jt="".concat(Et.protocol)).call(jt,er,"/")).call(Lt,g(or).call(or,hr));if(k(lr).call(lr,ir)&&k(dr).call(dr,"/")){var pr=n(dr).call(dr,"/"),Sr=dr.substring(0,pr),Er=dr.substring(pr+1);return Dt.replace("{bucket}",Sr).replace("{object}",Er)}var Pr=$(lr).call(lr,function(rr){return typeof ir=="string"&&k(ir).call(ir,rr)})[0],Cr=Pr?ir.replace(Pr,"").replace(/\W/g,""):null;return Cr?Dt.replace("{bucket}",Cr).replace("{object}",dr):ae}};t.exports=oe},function(t,r,e){var n=e(5);t.exports=!n(function(){var g=(function(){}).bind();return typeof g!="function"||g.hasOwnProperty("prototype")})},function(t,r,e){var n=e(96),g=TypeError;t.exports=function(y){if(n(y))throw g("Can't call method on "+y);return y}},function(t,r,e){var n=e(49),g=e(161);(t.exports=function(y,i){return g[y]||(g[y]=i!==void 0?i:{})})("versions",[]).push({version:"3.27.1",mode:n?"pure":"global",copyright:"© 2014-2022 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.27.1/LICENSE",source:"https://github.com/zloirock/core-js"})},function(t,r,e){var n=e(321);t.exports=function(g){var y=+g;return y!=y||y===0?0:n(y)}},function(t,r,e){var n=e(5),g=e(21),y=e(98),i=g("species");t.exports=function(k){return y>=51||!n(function(){var $=[];return($.constructor={})[i]=function(){return{foo:1}},$[k](Boolean).foo!==1})}},function(t,r){t.exports={}},function(t,r,e){var n=e(371).charAt,g=e(50),y=e(101),i=e(169),k=e(170),$=y.set,L=y.getterFor("String Iterator");i(String,"String",function(V){$(this,{type:"String Iterator",string:g(V),index:0})},function(){var V,z=L(this),re=z.string,ie=z.index;return ie>=re.length?k(void 0,!0):(V=n(re,ie),z.index+=V.length,k(V,!1))})},function(t,r,e){var n=e(65),g=e(14);t.exports=n(g.process)=="process"},function(t,r,e){var n=e(14),g=e(105),y=e(17),i=e(211),k=e(215),$=e(21),L=e(400),V=e(243),z=e(49),re=e(98),ie=g&&g.prototype,ue=$("species"),le=!1,oe=y(n.PromiseRejectionEvent),ae=i("Promise",function(){var qe=k(g),de=qe!==String(g);if(!de&&re===66||z&&(!ie.catch||!ie.finally))return!0;if(!re||re<51||!/native code/.test(qe)){var Ne=new g(function($e){$e(1)}),ze=function($e){$e(function(){},function(){})};if((Ne.constructor={})[ue]=ze,!(le=Ne.then(function(){})instanceof ze))return!0}return!de&&(L||V)&&!oe});t.exports={CONSTRUCTOR:ae,REJECTION_EVENT:oe,SUBCLASSING:le}},function(t,r,e){var n=e(26),g=e(62),y=e(574),i=e(576),k=e(582),$={},L=g.f;function V(oe){var ae=oe.upload=(oe.headers||g.o)["Content-Type"]==="multipart/form-data",qe=!1;try{qe=(location.protocol+"//"+location.host).toLowerCase()!==g.url2origin(oe.url)}catch{}return oe.cors=qe,ae||qe||oe.mode?function(de){var Ne=de.mode,ze=y,$e=g.getGlobal();return!$e.FormData&&$e.document&&(Ne="iframe"),Ne==="iframe"&&(ze=de.upload?i:k),new ze(de)}(oe):new y(oe)}function z(oe,ae,qe){var de=$[oe];if(de){ae==="onload"&&de.result&&(qe=function(ze,$e){$e={data:$e};var Lt=ze.result.headers;return Lt&&($e.headers=ze.req.header(Lt)),$e}(de,qe)),function(ze){var $e=$[ze];$e&&($e.req.destroy(),delete $[ze])}(oe);var Ne={type:ae,result:qe};L(Ne),Ne.stopped||de[ae](Ne.result)}}function re(oe,ae){z(oe,"onload",ae)}function ie(oe,ae){z(oe,"onerror",ae)}function ue(oe,ae){var qe=g.genUrlSep(oe);return ae=ae||"",g.isObject(ae)&&(ae=g.object2query(ae)),ae&&(oe+=qe+ae),oe}function le(oe,ae){ae=ae||{};var qe=g.uniqueID(),de={result:ae.result,onload:ae.onload||g.f,onerror:ae.onerror||g.f};$[qe]=de,ae.onload=n(re).call(re,null,qe),ae.onerror=n(ie).call(ie,null,qe),ae.query&&(oe=ue(oe,ae.query));var Ne=ae.method||"";return Ne&&!/get/i.test(Ne)||!ae.data||(oe=ue(oe,ae.data),ae.data=null),ae.url=oe,de.req=V(ae),qe}le.filter=function(oe){g.isFunction(oe)&&(L=oe)},le.abort=function(oe){var ae=$[oe];ae&&ae.req&&ae.req.abort()},t.exports=le},function(t,r,e){var n=e(8),g=e(303),y=e(22),i=e(108).genPrivateUrl,k=e(0),$=k.notundef,L=k.exist,V=e(195),z=e(297),re=z.typeMap;function ie(ue){ue.resend?(k.verifyOptions(ue,"idClient","msg::Message"),this.idClient=ue.idClient):this.idClient=k.guid(),this.type=re[ue.type],this.resend=ue.resend?1:0,$(ue.subType)&&(k.isInt(+ue.subType)&&+ue.subType>0?this.subType=+ue.subType:k.onParamError("subType只能是大于0的整数","msg::Message")),$(ue.custom)&&(y(ue.custom)==="object"?this.custom=n(ue.custom):this.custom=""+ue.custom),$(ue.text)&&(this.body=""+ue.text),$(ue.body)&&(this.body=""+ue.body),$(ue.yidunEnable)&&(this.yidunEnable=ue.yidunEnable?1:0),$(ue.antiSpamUsingYidun)&&(this.antiSpamUsingYidun=ue.antiSpamUsingYidun?1:0),$(ue.antiSpamContent)&&(y(ue.antiSpamContent)==="object"?this.antiSpamContent=n(ue.antiSpamContent):this.antiSpamContent=""+ue.antiSpamContent),$(ue.antiSpamBusinessId)&&(y(ue.antiSpamBusinessId)==="object"?this.antiSpamBusinessId=n(ue.antiSpamBusinessId):this.antiSpamBusinessId=""+ue.antiSpamBusinessId),$(ue.yidunAntiCheating)&&(this.yidunAntiCheating=ue.yidunAntiCheating+""),$(ue.skipHistory)&&(this.skipHistory=ue.skipHistory?1:0),$(ue.highPriority)&&(this.highPriority=ue.highPriority?1:0),$(ue.clientAntiSpam)&&(this.clientAntiSpam=ue.clientAntiSpam?1:0),$(ue.env)&&(this.env=ue.env),$(ue.notifyTargetTags)&&(this.notifyTargetTags=ue.notifyTargetTags),$(ue.yidunAntiSpamExt)&&(this.yidunAntiSpamExt=ue.yidunAntiSpamExt),($(ue.loc_x)||$(ue.loc_y)||$(ue.loc_z))&&(this.loc_x=ue.loc_x,this.loc_y=ue.loc_y,this.loc_z=ue.loc_z)}ie.validTypes=z.validTypes,k.merge(ie.prototype,z.prototype),ie.getType=z.getType,ie.setFlow=z.setFlow,ie.reverse=function(ue){var le=k.filterObj(ue,"chatroomId idClient from fromNick fromAvatar _fromAvatar_safe fromCustom userUpdateTime custom status notifyTargetTags");return $(le.fromAvatar)&&(le.fromAvatar=i(le.fromAvatar)),le=k.merge(le,{fromClientType:V.reverseType(ue.fromClientType),time:+ue.time,type:ie.getType(ue),text:L(ue.body)?ue.body:ue.text||"",resend:+ue.resend==1}),$(le.userUpdateTime)&&(le.userUpdateTime=+le.userUpdateTime),$(ue.callbackExt)&&(le.callbackExt=ue.callbackExt),$(ue.subType)&&(le.subType=+ue.subType),$(ue.yidunAntiSpamRes)&&(le.yidunAntiSpamRes=ue.yidunAntiSpamRes),$(ue.loc_x)&&(le.x=g(ue.loc_x),le.y=g(ue.loc_y),le.z=g(ue.loc_z)),$(ue.toAccids)&&(le.toAccids=ue.toAccids),le.status=le.status||"success",le},ie.setExtra=function(ue,le){z.setFlow(ue,le)},t.exports=ie},function(t,r,e){var n=e(217),g=e(167);t.exports=Object.keys||function(y){return n(y,g)}},function(t,r,e){t.exports=e(423)},function(t,r,e){t.exports=e(432)},function(t,r,e){t.exports=e(444)},function(t,r,e){var n=e(175),g=e(504),y=e(505),i=n?n.toStringTag:void 0;t.exports=function(k){return k==null?k===void 0?"[object Undefined]":"[object Null]":i&&i in Object(k)?g(k):y(k)}},function(t,r,e){var n=e(596),g=e(188),y=e(603);t.exports=function(i,k){if(i==null)return{};var $,L,V=y(i,k);if(n){var z=n(i);for(L=0;L<z.length;L++)$=z[L],g(k).call(k,$)>=0||Object.prototype.propertyIsEnumerable.call(i,$)&&(V[$]=i[$])}return V},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,r,e){t.exports=e(570)},function(t,r,e){var n=e(12),g=e(5),y=e(65),i=Object,k=n("".split);t.exports=g(function(){return!i("z").propertyIsEnumerable(0)})?function($){return y($)=="String"?k($,""):i($)}:i},function(t,r,e){var n=e(318),g=e(129);t.exports=function(y){var i=n(y,"string");return g(i)?i:i+""}},function(t,r,e){var n=e(33),g=e(17),y=e(19),i=e(209),k=Object;t.exports=i?function($){return typeof $=="symbol"}:function($){var L=n("Symbol");return g(L)&&y(L.prototype,k($))}},function(t,r,e){var n=e(12),g=0,y=Math.random(),i=n(1 .toString);t.exports=function(k){return"Symbol("+(k===void 0?"":k)+")_"+i(++g+y,36)}},function(t,r,e){var n=e(112),g=Math.max,y=Math.min;t.exports=function(i,k){var $=n(i);return $<0?g($+k,0):y($,k)}},function(t,r,e){var n=e(12),g=e(5),y=e(17),i=e(67),k=e(33),$=e(215),L=function(){},V=[],z=k("Reflect","construct"),re=/^\s*(?:class|function)\b/,ie=n(re.exec),ue=!re.exec(L),le=function(ae){if(!y(ae))return!1;try{return z(L,V,ae),!0}catch{return!1}},oe=function(ae){if(!y(ae))return!1;switch(i(ae)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return ue||!!ie(re,$(ae))}catch{return!0}};oe.sham=!0,t.exports=!z||g(function(){var ae;return le(le.call)||!le(Object)||!le(function(){ae=!0})||ae})?oe:le},function(t,r,e){var n=e(111),g=e(130),y=n("keys");t.exports=function(i){return y[i]||(y[i]=g(i))}},function(t,r,e){var n=e(217),g=e(167).concat("length","prototype");r.f=Object.getOwnPropertyNames||function(y){return n(y,g)}},function(t,r){r.f=Object.getOwnPropertySymbols},function(t,r,e){var n=e(21);r.f=n},function(t,r,e){var n=e(30),g=e(17),y=e(42),i=e(133),k=e(229),$=i("IE_PROTO"),L=Object,V=L.prototype;t.exports=k?L.getPrototypeOf:function(z){var re=y(z);if(n(re,$))return re[$];var ie=re.constructor;return g(ie)&&re instanceof ie?ie.prototype:re instanceof L?V:null}},function(t,r,e){var n=e(12),g=e(36),y=e(355);t.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var i,k=!1,$={};try{(i=n(Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set))($,[]),k=$ instanceof Array}catch{}return function(L,V){return g(L),y(V),k?i(L,V):L.__proto__=V,L}}():void 0)},function(t,r,e){var n=e(67),g=e(160),y=e(96),i=e(103),k=e(21)("iterator");t.exports=function($){if(!y($))return g($,k)||g($,"@@iterator")||i[n($)]}},function(t,r,e){t.exports=e(407)},function(t,r,e){t.exports=e(449)},function(t,r,e){var n=e(493),g=e(494),y=e(495),i=e(496),k=e(497);function $(L){var V=-1,z=L==null?0:L.length;for(this.clear();++V<z;){var re=L[V];this.set(re[0],re[1])}}$.prototype.clear=n,$.prototype.delete=g,$.prototype.get=y,$.prototype.has=i,$.prototype.set=k,t.exports=$},function(t,r,e){var n=e(201);t.exports=function(g,y){for(var i=g.length;i--;)if(n(g[i][0],y))return i;return-1}},function(t,r,e){var n=e(87)(Object,"create");t.exports=n},function(t,r,e){var n=e(517);t.exports=function(g,y){var i=g.__data__;return n(y)?i[typeof y=="string"?"string":"hash"]:i.map}},function(t,r,e){var n=e(261),g=e(262);t.exports=function(y,i,k,$){var L=!k;k||(k={});for(var V=-1,z=i.length;++V<z;){var re=i[V],ie=$?$(k[re],y[re],re,k,y):void 0;ie===void 0&&(ie=y[re]),L?g(k,re,ie):n(k,re,ie)}return k}},function(t,r){t.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},function(t,r){t.exports=`	
\v\f\r                　\u2028\u2029\uFEFF`},function(t,r,e){var n,g=e(18),y=e(2),i=e(9),k=e(3),$=e(6),L=e(7),V=e(26),z=e(8),re=e(108).urlQuery2Object,ie=e(0),ue=e(41),le=e(744),oe=e(745),ae=e(746),qe=e(747),de=e(748),Ne=e(749);function ze(Et){this.mixin(Et)}ze.prototype=g((function(){}).prototype,{protocol:{value:null,writable:!0,enumerable:!0,configurable:!0}}),ze.prototype.setProtocol=function(Et){this.protocol=Et},ze.prototype.mixin=function(Et){var ir,dr,Dt=this;this.configMap=this.configMap||{},y(ir=["idMap","cmdConfig","packetConfig"]).call(ir,function(lr){Dt.configMap[lr]=ie.merge({},Dt.configMap[lr],Et.configMap&&Et.configMap[lr])}),y(dr=["serializeMap","unserializeMap"]).call(dr,function(lr){Dt[lr]=ie.merge({},Dt[lr],Et[lr])})},ze.prototype.createCmd=(n=1,function(Et,ir){var dr,Dt=this,lr=this.configMap.cmdConfig[Et],sr=this.configMap.packetConfig[lr.sid+"_"+lr.cid],er=Et==="heartbeat"?0:n++;return er>32767&&(er=1,n=2),Et={SID:lr.sid,CID:lr.cid,SER:er,isAwaitable:typeof lr.isAwaitable=="boolean"?lr.isAwaitable:!(!sr||!sr.response)},lr.params&&(Et.Q=[],y(dr=lr.params).call(dr,function(cr){var or=cr.type,hr=cr.name,pr=cr.entity,Sr=ir[hr];if(!ie.undef(Sr)){switch(or){case"PropertyArray":or="ArrayMable",Sr=i(Sr).call(Sr,function(Er){return{t:"Property",v:Dt.serialize(Er,pr)}});break;case"Property":Sr=Dt.serialize(Sr,hr);break;case"bool":Sr=Sr?"true":"false"}Et.Q.push({t:or,v:Sr})}})),Et}),ze.prototype.parseResponse=function(Et){var ir=this;return new k(function(dr){var Dt=JSON.parse(Et),lr={raw:Dt,rawStr:Et,error:ue.genError(Dt.code)},sr=ir.configMap.packetConfig[Dt.sid+"_"+Dt.cid];if(!sr)return lr.notFound={sid:Dt.sid,cid:Dt.cid},void dr(lr);var er=Dt.r,cr=sr.service==="notify"&&!sr.cmd;if(lr.isNotify=cr,cr){var or=Dt.r[1].headerPacket;if(sr=ir.configMap.packetConfig[or.sid+"_"+or.cid],er=Dt.r[1].body,!sr)return lr.notFound={sid:or.sid,cid:or.cid},void dr(lr)}if(lr.service=sr.service,lr.cmd=sr.cmd,lr.error){var hr,pr,Sr=$(hr="".concat(Dt.sid,"_")).call(hr,Dt.cid);if(cr&&(Sr=$(pr="".concat(or.sid,"_")).call(pr,or.cid)),lr.error.cmd=lr.cmd,lr.error.callFunc="protocol::parseResponse: ".concat(Sr),lr.error.code===416){var Er=er[0];Er&&(lr.frequencyControlDuration=1e3*Er)}}var Pr,Cr=!1;lr.error&&sr.trivialErrorCodes&&(Cr=L(Pr=sr.trivialErrorCodes).call(Pr,lr.error.code)!==-1);var rr=[];if((!lr.error||Cr)&&sr.response){var kr;lr.content={};var Ir=function(xr,vr,_r,Or){if(xr&&Or==="msg"||Or==="sysMsg"){var Mr=_r.content[Or];ie.isObject(Mr)&&!Mr.idServer&&(Mr.idServer=""+vr.r[0])}};y(kr=sr.response).call(kr,function(xr,vr){var _r,Or=er[vr];if(!ie.undef(Or)){var Mr=xr.type,yr=xr.name,mr=xr.entity||yr;switch(Mr){case"Property":rr.push(ir.unserialize(Or,mr).then(V(_r=function(Tr,Br,$r,Lr,Gr){$r.content[Lr]=Gr,Ir(Tr,Br,$r,Lr)}).call(_r,this,cr,Dt,lr,yr)));break;case"PropertyArray":lr.content[yr]=[],y(Or).call(Or,function(Tr,Br){var $r;rr.push(ir.unserialize(Tr,mr).then(V($r=function(Lr,Gr,qr){Lr.content[Gr][Br]=qr}).call($r,this,lr,yr)))});break;case"KVArray":lr.content[yr]=Or,Ir(cr,Dt,lr,yr);break;case"long":case"Long":case"byte":case"Byte":case"Number":lr.content[yr]=+Or;break;default:lr.content[yr]=Or,Ir(cr,Dt,lr,yr)}}})}k.all(rr).then(function(){dr(lr)})})},ze.prototype.serialize=function(Et,ir){var dr=this.serializeMap[ir],Dt={};for(var lr in dr)Et.hasOwnProperty(lr)&&(Dt[dr[lr]]=Et[lr]);return Dt},ze.prototype.matchNosSafeUrl=function(Et){if(!ie.isString(Et)||!~L(Et).call(Et,"_im_url=1"))return!1;var ir=re(Et);return!(!ir||!ir._im_url||ir._im_url!=1)},ze.prototype.getOneNosOriginUrl=function(Et,ir,dr){var Dt=this;return new k(function(lr){Dt.protocol.getNosOriginUrlReqNum++,Dt.protocol.sendCmd("getNosOriginUrl",{nosFileUrlTag:{safeUrl:Et}},function(sr,er,cr){Dt.protocol.getNosOriginUrlReqNum--,sr?Dt.protocol.logger.warn("error: get nos originUrl failed",sr):(ir["_"+dr+"_safe"]=ir[dr],ir[dr]=cr.nosFileUrlTag&&cr.nosFileUrlTag.originUrl),lr()})})},ze.prototype.checkObjSafeUrl=function(Et,ir,dr){var Dt=this;for(var lr in Et)if(Et.hasOwnProperty(lr)){var sr=Et[lr];if(ie.isString(sr)){if(this.matchNosSafeUrl(sr)){var er=this.getOneNosOriginUrl(sr,Et,lr);ir.push(er),dr.push(er)}}else ie.isObject(sr)?this.checkObjSafeUrl(sr,ir,dr):ie.isArray(sr)&&y(sr).call(sr,function(cr){ie.isObject(cr)&&Dt.checkObjSafeUrl(cr,ir,dr)})}};var $e=["url","avatar","fromAvatar","chatroomAvatar"];ze.prototype.unserialize=function(Et,ir){var dr=this;return new k(function(Dt){var lr=dr.unserializeMap[ir],sr={},er=[];if(Et)for(var cr in lr){var or,hr=[];if(Et.hasOwnProperty(cr)&&(sr[lr[cr]]=Et[cr],dr.protocol.hasLogin&&!dr.protocol.keepNosSafeUrl))if(lr[cr]==="attach"&&Et[cr]&&L(Et[cr])&&~L(or=Et[cr]).call(or,"_im_url=1"))try{var pr,Sr=JSON.parse(Et[cr]);Sr.isS3||dr.checkObjSafeUrl(Sr,hr,er),k.all(hr).then(V(pr=function(Er,Pr){Er.attach=z(Pr)}).call(pr,dr,sr,Sr))}catch(Er){dr.logger.warn("unserialize",Er&&Er.message)}else~L($e).call($e,lr[cr])&&Et[cr]&&dr.matchNosSafeUrl(Et[cr])&&er.push(dr.getOneNosOriginUrl(Et[cr],sr,lr[cr]))}k.all(er).then(function(){Dt(sr)})})},ze.prototype.syncUnserialize=function(Et,ir){var dr=this.unserializeMap[ir],Dt={};if(Et)for(var lr in dr)Et.hasOwnProperty(lr)&&(Dt[dr[lr]]=Et[lr]);return Dt};var Lt=new ze({configMap:le,serializeMap:oe,unserializeMap:ae}),jt=new ze({configMap:qe,serializeMap:de,unserializeMap:Ne});t.exports={IM:Lt,Chatroom:jt}},function(t,r,e){var n={}.propertyIsEnumerable,g=Object.getOwnPropertyDescriptor,y=g&&!n.call({1:2},1);r.f=y?function(i){var k=g(this,i);return!!k&&k.enumerable}:n},function(t,r,e){t.exports=e(622)},function(t,r,e){var n=e(9),g=e(10),y=e(0),i=y.notundef,k=y.fillPropertyWithDefault,$={0:"normal",1:"owner",2:"manager"};function L(V){y.verifyOptions(V,"teamId","team::TeamMember"),y.verifyParamAtLeastPresentOne(V,"nickInTeam muteTeam muteNotiType custom","team::TeamMember"),this.teamId=V.teamId,i(V.account)&&(this.account=V.account),i(V.nickInTeam)&&(this.nickInTeam=V.nickInTeam),i(V.muteNotiType)?this.bits=V.muteNotiType:i(V.muteTeam)&&(this.bits=0,V.muteTeam&&(this.bits+=1)),i(V.mute)&&(this.mute=V.mute?1:0),i(V.custom)&&(this.custom=""+V.custom)}L.reverse=function(V){var z=y.copy(V);if(i(z.teamId)&&(z.teamId=""+z.teamId),i(z.type)&&(z.type=$[z.type]),i(z.active)&&(z.active=+z.active==1),i(z.valid)&&(z.valid=+z.valid==1),i(z.mute)&&(z.mute=+z.mute==1),i(z.joinTime)&&(z.joinTime=+z.joinTime),i(z.updateTime)&&(z.updateTime=+z.updateTime),i(z.bits)){var re=z.bits;delete z.bits,z.muteTeam=!!(1&re),z.muteNotiType=re}return i(z.teamId)&&i(z.account)&&(z.id=L.genId(z.teamId,z.account)),i(z.followAccountIds)&&(z.followAccountIds=JSON.parse(z.followAccountIds)),z},L.reverseMembers=function(V){return n(V).call(V,function(z){return g(L).call(L,z)})},L.fillProperties=function(V){var z=k(V,"mute",!1),re=k(V,"custom","");return z||re},L.genId=function(V,z){return V+"-"+z},L.accounts2ids=function(V,z){return n(z).call(z,function(re){return L.genId(V,re)})},L.assembleMembers=function(V,z){return y.isArray(z)||(z=[z]),n(z).call(z,function(re){return L.assembleMember(V,re)})},L.assembleMember=function(V,z){return{id:L.genId(V.teamId,z),account:z,teamId:V.teamId,type:"normal",nickInTeam:"",muteTeam:!1,mute:!1,joinTime:V.memberUpdateTime,updateTime:V.memberUpdateTime,active:!0,valid:!0,invitorAccid:"",followAccountIds:[]}},L.assembleOwner=function(V){var z=L.assembleMember(V,V.owner);return z.type="owner",z},t.exports=L},function(t,r,e){var n,g=e(22),y=e(7),i=e(8),k=e(6),$=e(4),L=e(10),V=e(16),z=e(9),re=e(2),ie=e(0),ue=ie.undef,le=ie.notundef,oe=e(149).IM,ae=e(194),qe=e(152),de={customP2p:100,customTeam:101,customSuperTeam:103,deleteMsgP2p:7,deleteMsgTeam:8,deleteMsgSuperTeam:12,deleteOnewayMsgP2p:13,deleteOnewayMsgTeam:14},Ne={0:"applyTeam",1:"rejectTeamApply",2:"teamInvite",3:"rejectTeamInvite",5:"friendRequest",6:"deleteFriend",7:"deleteMsgP2p",8:"deleteMsgTeam",12:"deleteMsgSuperTeam",13:"deleteMsgP2pOneWay",14:"deleteMsgTeamOneWay",15:"applySuperTeam",16:"rejectSuperTeamApply",17:"superTeamInvite",18:"rejectSuperTeamInvite",100:"customP2p",101:"customTeam",103:"customSuperTeam",102:"customP2p"},ze={1:"addFriend",2:"applyFriend",3:"passFriendApply",4:"rejectFriendApply"},$e=["team","superTeam","friend","msg"],Lt={applyTeam:"team",rejectTeamApply:"team",teamInvite:"team",rejectTeamInvite:"team",applySuperTeam:"superTeam",rejectSuperTeamApply:"superTeam",superTeamInvite:"superTeam",rejectSuperTeamInvite:"superTeam",addFriend:"friend",applyFriend:"friend",passFriendApply:"friend",rejectFriendApply:"friend",deleteFriend:"friend",deleteMsg:"msg"};function jt(Et){var ir,dr;ie.verifyOptions(Et,"type to","sysmsg::SystemMessage"),ie.verifyParamValid("type",Et.type,jt.validTypes,"sysmsg::SystemMessage"),y(ir=Et.type).call(ir,"custom")!==-1&&(ie.verifyOptions(Et,"content","sysmsg::SystemMessage"),this.attach=Et.content,le(Et.apnsText)&&(this.apnsText=""+Et.apnsText),le(Et.pushPayload)&&(g(Et.pushPayload)==="object"?this.pushPayload=i(Et.pushPayload):this.pushPayload=""+Et.pushPayload),le(Et.sendToOnlineUsersOnly)&&(this.sendToOnlineUsersOnly=Et.sendToOnlineUsersOnly?0:1),le(Et.cc)&&(this.cc=Et.cc?1:0),le(Et.isPushable)&&(this.isPushable=Et.isPushable?1:0),le(Et.isUnreadable)&&(this.isUnreadable=Et.isUnreadable?1:0),le(Et.needPushNick)&&(this.needPushNick=Et.needPushNick?1:0)),y(dr=Et.type).call(dr,"deleteMsg")===0&&(Et.apnsText&&(this.apnsText=Et.apnsText),Et.pushPayload&&(this.pushPayload=Et.pushPayload),Et.attach&&(this.attach=Et.attach)),this.time=Et.time||+new Date,this.type=de[Et.type],this.to=Et.to,le(Et.from)&&(this.from=Et.from),le(Et.ps)&&(this.ps=Et.ps),le(Et.deletedIdClient)&&(this.deletedIdClient=Et.deletedIdClient),le(Et.deletedIdServer)&&(this.deletedIdServer=Et.deletedIdServer),le(Et.opeAccount)&&(this.opeAccount=Et.opeAccount),le(Et.yidunEnable)&&(this.yidunEnable=Et.yidunEnable?1:0),le(Et.antiSpamContent)&&(g(Et.antiSpamContent)==="object"?this.antiSpamContent=i(Et.antiSpamContent):this.antiSpamContent=""+Et.antiSpamContent),le(Et.antiSpamBusinessId)&&(g(Et.antiSpamBusinessId)==="object"?this.antiSpamBusinessId=i(Et.antiSpamBusinessId):this.antiSpamBusinessId=""+Et.antiSpamBusinessId),le(Et.env)&&(this.env=Et.env),this.idClient=Et.idClient||ie.guid()}jt.validTypes=k(n=$(de)).call(n,$(Lt)),jt.validCategories=["team","friend"],jt.isCustom=function(Et){return Et.type==="custom"},jt.reverse=function(Et){var ir,dr={time:+Et.time,to:Et.to,type:Ne[Et.type]};if(le(Et.from)&&(dr.from=Et.from),le(Et.idClient)&&(dr.idClient=Et.idClient),le(Et.idServer)&&(dr.idServer=""+Et.idServer),le(Et.deletedIdClient)&&(dr.deletedIdClient=Et.deletedIdClient),le(Et.deletedIdServer)&&(dr.deletedIdServer=""+Et.deletedIdServer),le(Et.deletedMsgTime)&&(dr.deletedMsgTime=+Et.deletedMsgTime),le(Et.deletedMsgFromNick)&&(dr.deletedMsgFromNick=""+Et.deletedMsgFromNick),le(Et.opeAccount)&&(dr.opeAccount=Et.opeAccount),le(Et.ps)&&(dr.ps=Et.ps),le(Et.callbackExt)&&(dr.callbackExt=Et.callbackExt),Et.attach=Et.attach?""+Et.attach:"",dr.type==="customP2p"||dr.type==="customTeam"||dr.type==="customSuperTeam")dr.content=Et.attach,le(Et.apnsText)&&(dr.apnsText=Et.apnsText),le(Et.pushPayload)&&(dr.pushPayload=Et.pushPayload),ie.merge(dr,{sendToOnlineUsersOnly:ue(Et.sendToOnlineUsersOnly)||+Et.sendToOnlineUsersOnly==0,cc:ue(Et.cc)||+Et.cc==1,isPushable:ue(Et.isPushable)||+Et.isPushable==1,isUnreadable:ue(Et.isUnreadable)||+Et.isUnreadable==1,needPushNick:le(Et.needPushNick)&&+Et.needPushNick==1}),dr.type==="customP2p"?dr.scene="p2p":dr.type==="customSuperTeam"?dr.scene="superTeam":dr.type==="customTeam"&&(dr.scene="team"),dr.type="custom";else if(y(ir=dr.type).call(ir,"deleteMsg")===0){Et.apnsText&&(dr.apnsText=Et.apnsText),Et.pushPayload&&(dr.pushPayload=Et.pushPayload),Et.attach&&(dr.attach=Et.attach);var Dt=dr.type.toLowerCase();y(Dt).call(Dt,"p2p")>-1?dr.scene="p2p":y(Dt).call(Dt,"superteam")>-1?dr.scene="superTeam":y(Dt).call(Dt,"team")>-1&&(dr.scene="team"),dr.type="deleteMsg"}else{if(Et.attach){dr.attach={};var lr=JSON.parse(Et.attach);le(lr.vt)?(dr.type=ze[lr.vt],lr.serverex&&lr.serverex[0]===1&&(dr.serverex=lr.serverex[1]),delete dr.attach):(le(lr.tinfo)&&(dr.attach.team=L(ae).call(ae,oe.syncUnserialize(lr.tinfo,"team"))),le(lr.tlist)&&(dr.attach.member=L(qe).call(qe,oe.syncUnserialize(lr.tlist,"teamMember"))),le(lr.attach)&&(dr.attach.custom=lr.attach))}dr.category=Lt[dr.type],dr.read=!1,dr.state="init"}return le(Et.cc)&&(dr.cc=+Et.cc==1),dr.status=Et.status||"success",le(V(Et))&&(dr.filter=V(Et)),dr},jt.reverseSysMsgs=function(Et,ir){var dr=(ir=ir||{}).mapper,Dt=ie.isFunction(dr);return z(Et).call(Et,function(lr){return lr=L(jt).call(jt,lr),Dt&&(lr=dr(lr)),lr})},jt.completeUnread=function(Et){var ir,dr;return Et=Et||{},re($e).call($e,function(Dt){delete Et[Dt]}),re(ir=$(Lt)).call(ir,function(Dt){Et[Dt]=Et[Dt]||0,Et[Dt]<0&&(Et[Dt]=0),Et[dr=Lt[Dt]]=Et[dr]||0,Et[dr]=Et[dr]+Et[Dt]}),Et.total=0,re($e).call($e,function(Dt){Et.total+=Et[Dt]}),Et},t.exports=jt},function(t,r,e){var n=e(125),g=["unreadMsgs"],y=e(0);function i(){}i.parse=function(k){var $=k.split("|");return{scene:$[0],to:$[1]}},i.genSessionByMsg=function(k){return{id:k.sessionId,scene:k.scene,to:k.target,updateTime:k.time,lastMsg:k}},i.appendLastMsg=function(k){var $=k.lastMsg;k["last"+y.capFirstLetter($.type)+"Msg"]=$,k["last"+y.capFirstLetter($.flow)+"Msg"]=$},i.genSessionByMsgs=function(k,$){var L=k.getLastNotIgnoredMsg($);return L?i.genSessionByMsg(L):null},i.trim=function(k){var $=k=y.simpleClone(k);return $.unreadMsgs,n($,g)},i.isComplete=function(k){return k.id&&k.scene&&k.to},t.exports=i},function(t,r,e){t.exports=e(329)},function(t,r,e){var n=e(491);t.exports=function(g){return n(g,5)}},function(t,r,e){var n=e(18),g=e(173),y={V2NIM_LOGIN_STATUS_LOGOUT:0,V2NIM_LOGIN_STATUS_LOGINED:1,V2NIM_LOGIN_STATUS_LOGINING:2},i={V2NIM_CONNECT_STATUS_DISCONNECTED:0,V2NIM_CONNECT_STATUS_CONNECTED:1,V2NIM_CONNECT_STATUS_CONNECTING:2,V2NIM_CONNECT_STATUS_WAITING:3};function k($){this.loginStatus=y.V2NIM_LOGIN_STATUS_LOGOUT,this.connectStatus=i.V2NIM_CONNECT_STATUS_DISCONNECTED,this.logger=$.logger,this.setMonitor()}k.prototype=n(new g),k.prototype.setMonitor=function(){var $=this;this.on("auth/loginLifeCycleAddressing",function(){$.logger.log("auth::life cycle addressing"),$.setLoginStatus(y.V2NIM_LOGIN_STATUS_LOGINING),$.setConnectStatus(i.V2NIM_CONNECT_STATUS_CONNECTING)}),this.on("auth/loginLifeCycleConnect",function(){$.logger.log("auth::life cycle connecting"),$.setLoginStatus(y.V2NIM_LOGIN_STATUS_LOGINING),$.setConnectStatus(i.V2NIM_CONNECT_STATUS_CONNECTING)}),this.on("auth/loginLifeCycleConnectSucc",function(){$.logger.log("auth::life cycle connect success"),$.setLoginStatus(y.V2NIM_LOGIN_STATUS_LOGINING),$.setConnectStatus(i.V2NIM_CONNECT_STATUS_CONNECTED)}),this.on("auth/loginLifeCycleConnectFail",function(L){$.logger.log("auth::life cycle connect fail"),$.setLoginStatus(y.V2NIM_LOGIN_STATUS_LOGOUT),$.setConnectStatus(i.V2NIM_CONNECT_STATUS_DISCONNECTED,L)}),this.on("auth/loginLifeCycleDisconnected",function(L){$.logger.log("auth::life cycle disconnected:",L&&L.message),$.setLoginStatus(y.V2NIM_LOGIN_STATUS_LOGOUT),$.setConnectStatus(i.V2NIM_CONNECT_STATUS_DISCONNECTED,L)}),this.on("auth/loginLifeCycleLoginSucc",function(){$.logger.log("auth::life cycle login success, verify authentication success"),$.setLoginStatus(y.V2NIM_LOGIN_STATUS_LOGINED)}),this.on("auth/loginLifeCycleLoginFail",function(L){$.logger.log("auth::life cycle login fail due to verify authentication failed:",L),$.setLoginStatus(y.V2NIM_LOGIN_STATUS_LOGOUT,L)}),this.on("auth/loginLifeCycleLogout",function(){$.logger.log("auth::life cycle logout"),$.setLoginStatus(y.V2NIM_LOGIN_STATUS_LOGOUT)}),this.on("auth/loginLifeCycleKicked",function(L){$.logger.log("auth::life cycle kicked",L),$.setLoginStatus(y.V2NIM_LOGIN_STATUS_LOGOUT)}),this.on("auth/loginLifeCycleWaiting",function(){$.logger.log("auth::life cycle waiting to reconnect"),$.getConnectStatus(),$.setLoginStatus(y.V2NIM_LOGIN_STATUS_LOGOUT),$.setConnectStatus(i.V2NIM_CONNECT_STATUS_WAITING)})},k.prototype.getConnectStatus=function(){return this.connectStatus},k.prototype.getLoginStatus=function(){return this.loginStatus},k.prototype.setLoginStatus=function($,L){if($!==this.loginStatus){var V=this.loginStatus;this.loginStatus=$,this.emit("loginStatus",$),this.delegateLoginEvent(V,$,L)}},k.prototype.delegateLoginEvent=function($,L,V){$===y.V2NIM_LOGIN_STATUS_LOGINING&&L===y.V2NIM_LOGIN_STATUS_LOGOUT&&this.emit("loginFailed",V)},k.prototype.setConnectStatus=function($,L){if($!==this.connectStatus){var V=this.connectStatus;this.connectStatus=$,this.emit("connectStatus",$),this.delegateConnectEvent(V,$,L)}},k.prototype.delegateConnectEvent=function($,L,V){$===i.V2NIM_CONNECT_STATUS_CONNECTED&&L===i.V2NIM_CONNECT_STATUS_DISCONNECTED&&this.emit("disconnected",V),$===i.V2NIM_CONNECT_STATUS_CONNECTING&&L===i.V2NIM_CONNECT_STATUS_CONNECTED&&this.emit("connectSuccess"),$===i.V2NIM_CONNECT_STATUS_CONNECTING&&L===i.V2NIM_CONNECT_STATUS_DISCONNECTED&&this.emit("connectFailed",V),$!==i.V2NIM_CONNECT_STATUS_DISCONNECTED&&this.connectStatus!==i.V2NIM_CONNECT_STATUS_WAITING||L!==i.V2NIM_CONNECT_STATUS_CONNECTING||this.emit("connecting")},k.prototype.destroy=function(){this.removeAllListeners()},t.exports={V2NIMLoginStatus:y,V2NIMConnectStatus:i,StatusProtector:k}},function(t,r,e){t.exports=e(633)},function(t,r,e){var n=e(65),g=e(12);t.exports=function(y){if(n(y)==="Function")return g(y)}},function(t,r,e){var n=e(31),g=e(96);t.exports=function(y,i){var k=y[i];return g(k)?void 0:n(k)}},function(t,r,e){var n=e(14),g=e(320),y=n["__core-js_shared__"]||g("__core-js_shared__",{});t.exports=y},function(t,r,e){var n=e(14),g=e(28),y=n.document,i=g(y)&&g(y.createElement);t.exports=function(k){return i?y.createElement(k):{}}},function(t,r,e){var n=e(44),g=e(131),y=e(46),i=function(k){return function($,L,V){var z,re=n($),ie=y(re),ue=g(V,ie);if(k&&L!=L){for(;ie>ue;)if((z=re[ue++])!=z)return!0}else for(;ie>ue;ue++)if((k||ue in re)&&re[ue]===L)return k||ue||0;return!k&&-1}};t.exports={includes:i(!0),indexOf:i(!1)}},function(t,r,e){var n=e(326);t.exports=function(g,y){return new(n(g))(y===0?0:y)}},function(t,r,e){var n={};n[e(21)("toStringTag")]="z",t.exports=String(n)==="[object z]"},function(t,r,e){var n=e(27),g=e(212),y=e(39),i=e(36),k=e(44),$=e(120);r.f=n&&!g?Object.defineProperties:function(L,V){i(L);for(var z,re=k(V),ie=$(V),ue=ie.length,le=0;ue>le;)y.f(L,z=ie[le++],re[z]);return L}},function(t,r){t.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},function(t,r,e){var n=e(65),g=e(44),y=e(134).f,i=e(221),k=typeof window=="object"&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];t.exports.f=function($){return k&&n($)=="Window"?function(L){try{return y(L)}catch{return i(k)}}($):y(g($))}},function(t,r,e){var n=e(1),g=e(20),y=e(49),i=e(227),k=e(17),$=e(354),L=e(137),V=e(138),z=e(85),re=e(61),ie=e(68),ue=e(21),le=e(103),oe=e(228),ae=i.PROPER,qe=i.CONFIGURABLE,de=oe.IteratorPrototype,Ne=oe.BUGGY_SAFARI_ITERATORS,ze=ue("iterator"),$e=function(){return this};t.exports=function(Lt,jt,Et,ir,dr,Dt,lr){$(Et,jt,ir);var sr,er,cr,or=function(rr){if(rr===dr&&Pr)return Pr;if(!Ne&&rr in Sr)return Sr[rr];switch(rr){case"keys":case"values":case"entries":return function(){return new Et(this,rr)}}return function(){return new Et(this)}},hr=jt+" Iterator",pr=!1,Sr=Lt.prototype,Er=Sr[ze]||Sr["@@iterator"]||dr&&Sr[dr],Pr=!Ne&&Er||or(dr),Cr=jt=="Array"&&Sr.entries||Er;if(Cr&&(sr=L(Cr.call(new Lt)))!==Object.prototype&&sr.next&&(y||L(sr)===de||(V?V(sr,de):k(sr[ze])||ie(sr,ze,$e)),z(sr,hr,!0,!0),y&&(le[hr]=$e)),ae&&dr=="values"&&Er&&Er.name!=="values"&&(!y&&qe?re(Sr,"name","values"):(pr=!0,Pr=function(){return g(Er,this)})),dr)if(er={values:or("values"),keys:Dt?Pr:or("keys"),entries:or("entries")},lr)for(cr in er)(Ne||pr||!(cr in Sr))&&ie(Sr,cr,er[cr]);else n({target:jt,proto:!0,forced:Ne||pr},er);return y&&!lr||Sr[ze]===Pr||ie(Sr,ze,Pr,{name:dr}),le[jt]=Pr,er}},function(t,r){t.exports=function(e,n){return{value:e,done:n}}},function(t,r,e){var n=e(19),g=TypeError;t.exports=function(y,i){if(n(i,y))return y;throw g("Incorrect invocation")}},function(t,r,e){var n=e(132),g=e(81),y=TypeError;t.exports=function(i){if(n(i))return i;throw y(g(i)+" is not a constructor")}},function(t,r,e){var n=Object.prototype.hasOwnProperty,g="~";function y(){}function i(V,z,re){this.fn=V,this.context=z,this.once=re||!1}function k(V,z,re,ie,ue){if(typeof re!="function")throw new TypeError("The listener must be a function");var le=new i(re,ie||V,ue),oe=g?g+z:z;return V._events[oe]?V._events[oe].fn?V._events[oe]=[V._events[oe],le]:V._events[oe].push(le):(V._events[oe]=le,V._eventsCount++),V}function $(V,z){--V._eventsCount==0?V._events=new y:delete V._events[z]}function L(){this._events=new y,this._eventsCount=0}Object.create&&(y.prototype=Object.create(null),new y().__proto__||(g=!1)),L.prototype.eventNames=function(){var V,z,re=[];if(this._eventsCount===0)return re;for(z in V=this._events)n.call(V,z)&&re.push(g?z.slice(1):z);return Object.getOwnPropertySymbols?re.concat(Object.getOwnPropertySymbols(V)):re},L.prototype.listeners=function(V){var z=g?g+V:V,re=this._events[z];if(!re)return[];if(re.fn)return[re.fn];for(var ie=0,ue=re.length,le=new Array(ue);ie<ue;ie++)le[ie]=re[ie].fn;return le},L.prototype.listenerCount=function(V){var z=g?g+V:V,re=this._events[z];return re?re.fn?1:re.length:0},L.prototype.emit=function(V,z,re,ie,ue,le){var oe=g?g+V:V;if(!this._events[oe])return!1;var ae,qe,de=this._events[oe],Ne=arguments.length;if(de.fn){switch(de.once&&this.removeListener(V,de.fn,void 0,!0),Ne){case 1:return de.fn.call(de.context),!0;case 2:return de.fn.call(de.context,z),!0;case 3:return de.fn.call(de.context,z,re),!0;case 4:return de.fn.call(de.context,z,re,ie),!0;case 5:return de.fn.call(de.context,z,re,ie,ue),!0;case 6:return de.fn.call(de.context,z,re,ie,ue,le),!0}for(qe=1,ae=new Array(Ne-1);qe<Ne;qe++)ae[qe-1]=arguments[qe];de.fn.apply(de.context,ae)}else{var ze,$e=de.length;for(qe=0;qe<$e;qe++)switch(de[qe].once&&this.removeListener(V,de[qe].fn,void 0,!0),Ne){case 1:de[qe].fn.call(de[qe].context);break;case 2:de[qe].fn.call(de[qe].context,z);break;case 3:de[qe].fn.call(de[qe].context,z,re);break;case 4:de[qe].fn.call(de[qe].context,z,re,ie);break;default:if(!ae)for(ze=1,ae=new Array(Ne-1);ze<Ne;ze++)ae[ze-1]=arguments[ze];de[qe].fn.apply(de[qe].context,ae)}}return!0},L.prototype.on=function(V,z,re){return k(this,V,z,re,!1)},L.prototype.once=function(V,z,re){return k(this,V,z,re,!0)},L.prototype.removeListener=function(V,z,re,ie){var ue=g?g+V:V;if(!this._events[ue])return this;if(!z)return $(this,ue),this;var le=this._events[ue];if(le.fn)le.fn!==z||ie&&!le.once||re&&le.context!==re||$(this,ue);else{for(var oe=0,ae=[],qe=le.length;oe<qe;oe++)(le[oe].fn!==z||ie&&!le[oe].once||re&&le[oe].context!==re)&&ae.push(le[oe]);ae.length?this._events[ue]=ae.length===1?ae[0]:ae:$(this,ue)}return this},L.prototype.removeAllListeners=function(V){var z;return V?(z=g?g+V:V,this._events[z]&&$(this,z)):(this._events=new y,this._eventsCount=0),this},L.prototype.off=L.prototype.removeListener,L.prototype.addListener=L.prototype.on,L.prefixed=g,L.EventEmitter=L,t.exports=L},function(t,r,e){var n=e(87)(e(56),"Map");t.exports=n},function(t,r,e){var n=e(56).Symbol;t.exports=n},function(t,r,e){var n=e(263),g=e(530),y=e(202);t.exports=function(i){return y(i)?n(i):g(i)}},function(t,r){var e=Array.isArray;t.exports=e},function(t,r){t.exports=function(e){return function(n){return e(n)}}},function(t,r,e){(function(n){var g=e(258),y=r&&!r.nodeType&&r,i=y&&typeof n=="object"&&n&&!n.nodeType&&n,k=i&&i.exports===y&&g.process,$=function(){try{var L=i&&i.require&&i.require("util").types;return L||k&&k.binding&&k.binding("util")}catch{}}();n.exports=$}).call(this,e(147)(t))},function(t,r){var e=Object.prototype;t.exports=function(n){var g=n&&n.constructor;return n===(typeof g=="function"&&g.prototype||e)}},function(t,r,e){var n=e(263),g=e(533),y=e(202);t.exports=function(i){return y(i)?n(i,!0):g(i)}},function(t,r,e){var n=e(538),g=e(267),y=Object.prototype.propertyIsEnumerable,i=Object.getOwnPropertySymbols,k=i?function($){return $==null?[]:($=Object($),n(i($),function(L){return y.call($,L)}))}:g;t.exports=k},function(t,r,e){var n=e(542),g=e(174),y=e(543),i=e(272),k=e(544),$=e(124),L=e(259),V=L(n),z=L(g),re=L(y),ie=L(i),ue=L(k),le=$;(n&&le(new n(new ArrayBuffer(1)))!="[object DataView]"||g&&le(new g)!="[object Map]"||y&&le(y.resolve())!="[object Promise]"||i&&le(new i)!="[object Set]"||k&&le(new k)!="[object WeakMap]")&&(le=function(oe){var ae=$(oe),qe=ae=="[object Object]"?oe.constructor:void 0,de=qe?L(qe):"";if(de)switch(de){case V:return"[object DataView]";case z:return"[object Map]";case re:return"[object Promise]";case ie:return"[object Set]";case ue:return"[object WeakMap]"}return ae}),t.exports=le},function(t,r,e){var n=e(547);t.exports=function(g){var y=new g.constructor(g.byteLength);return new n(y).set(new n(g)),y}},function(t,r,e){var n=e(12),g=e(110),y=e(50),i=e(148),k=n("".replace),$="["+i+"]",L=RegExp("^"+$+$+"*"),V=RegExp($+$+"*$"),z=function(re){return function(ie){var ue=y(g(ie));return 1&re&&(ue=k(ue,L,"")),2&re&&(ue=k(ue,V,"")),ue}};t.exports={start:z(1),end:z(2),trim:z(3)}},function(t,r,e){var n=e(118),g=e(583);n.json=g,t.exports=n},function(t,r,e){var n=e(18),g=e(24),y=e(7),i=e(2),k=e(62),$=k.f,L=e(575);function V(re){re.onload&&this.once("load",re.onload),re.onerror&&this.once("error",re.onerror),re.onbeforesend&&this.once("beforesend",re.onbeforesend),re.onaftersend&&this.once("aftersend",re.onaftersend);var ie=(re=this.options=k.fetch({method:"GET",url:"",sync:!1,data:null,headers:{},cookie:!1,timeout:6e4,type:"text",form:null,input:null,putFileAtEnd:!1,proxyUrl:""},re)).headers;k.notexist(ie["Content-Type"])&&(ie["Content-Type"]="application/x-www-form-urlencoded"),this.send()}var z=V.prototype=n(L.prototype);z.send=function(){var re=this,ie=re.options;g(function(){try{try{re.emit("beforesend",ie)}catch{}re.doSend()}catch(ue){re.onError("serverError","请求失败:"+ue.message)}},0)},z.doSend=$,z.afterSend=function(){var re=this;g(function(){re.emit("aftersend",re.options)},0)},z.onLoad=function(re){var ie,ue=this.options,le=re.status,oe=re.result;if(typeof le!="number"||le!==0)if(y(ie=""+le).call(ie,"2")===0){if(ue.type==="json")try{oe=JSON.parse(oe)}catch{return void this.onError("parseError",oe)}this.emit("load",oe)}else this.onError("serverError","服务器返回异常状态",{status:le,result:oe,date:re.date});else this.onError("netError","网络错误",{status:408})},z.onError=function(re,ie,ue){var le=k.isObject(ue)?ue:{};le.code=re||"error",le.message=ie||"发生错误",this.emit("error",le)},z.onTimeout=function(){this.onError("timeout","请求超时",{status:408})},z.abort=function(){this.onError("abort","客户端中止",{status:415})},z.header=function(re){var ie=this;if(!k.isArray(re))return ie.getResponseHeader(re||"");var ue={};return i(re).call(re,function(le){ue[le]=ie.header(le)}),ue},z.getResponseHeader=$,z.destroy=$,t.exports=V},function(t,r,e){t.exports=e(600)},function(t,r,e){t.exports=e(613)},function(t,r,e){var n=e(191),g=e(151);function y(i,k){var $;return t.exports=y=n?g($=n).call($):function(L,V){return L.__proto__=V,L},t.exports.__esModule=!0,t.exports.default=t.exports,y(i,k)}t.exports=y,t.exports.__esModule=!0,t.exports.default=t.exports},function(t,r,e){t.exports=e(616)},function(t,r,e){var n=e(191),g=e(151),y=e(283);function i(k){var $;return t.exports=i=n?g($=y).call($):function(L){return L.__proto__||y(L)},t.exports.__esModule=!0,t.exports.default=t.exports,i(k)}t.exports=i,t.exports.__esModule=!0,t.exports.default=t.exports},function(t,r){var e={link:{id:1,heartbeat:2,negotiateTransport:5,initTransport:6},sync:{id:5,sync:1,syncTeamMembers:2},misc:{id:6,getSimpleNosToken:1,getNosToken:2,notifyUploadLog:3,uploadSdkLogUrl:4,audioToText:5,processImage:6,getNosTokenTrans:7,notifyTransLog:8,fetchFile:9,fetchFileList:10,removeFile:11,getClientAntispam:17,fileQuickTransfer:18,getNosOriginUrl:22,getServerTime:23,getNosAccessToken:24,deleteNosAccessToken:25,getNosCdnHost:26,getGrayscaleConfig:27,getMixStorePolicy:28,getMixStoreToken:29,getBackSourceToken:30,uploadDetect:32},avSignal:{id:15,signalingCreate:1,signalingDelay:2,signalingClose:3,signalingJoin:4,signalingLeave:5,signalingInvite:6,signalingCancel:7,signalingReject:8,signalingAccept:9,signalingControl:10,signalingNotify:11,signalingMutilClientSyncNotify:12,signalingUnreadMessageSyncNotify:13,signalingChannelsSyncNotify:14,signalingGetChannelInfo:15,signalingCallEx:16,signalingJoinAndAccept:17}},n={heartbeat:{sid:e.link.id,cid:e.link.heartbeat},negotiateTransport:{sid:e.link.id,cid:e.link.negotiateTransport,params:[{type:"int",name:"sdkVersion"},{type:"Property",name:"negotiateTransportTag"}]},initTransport:{sid:e.link.id,cid:e.link.initTransport,params:[{type:"Property",name:"initTransportTag"}]},getGrayscaleConfig:{sid:e.misc.id,cid:e.misc.getGrayscaleConfig,params:[{type:"Property",name:"providers"}]},getMixStorePolicy:{sid:e.misc.id,cid:e.misc.getMixStorePolicy,params:[{type:"LongArray",name:"providers"}]},getMixStoreToken:{sid:e.misc.id,cid:e.misc.getMixStoreToken,params:[{type:"Property",name:"mixTokenReq"}]},getBackSourceToken:{sid:e.misc.id,cid:e.misc.getBackSourceToken,params:[{type:"Property",name:"mixAuthTokenReq"}]},uploadDetect:{sid:e.misc.id,cid:e.misc.uploadDetect,isAwaitable:!1,params:[{type:"Property",name:"notifyDetectTag"}]},getSimpleNosToken:{sid:e.misc.id,cid:e.misc.getSimpleNosToken,params:[{type:"int",name:"num"}]},getNosToken:{sid:e.misc.id,cid:e.misc.getNosToken,params:[{type:"String",name:"responseBody"},{type:"Property",name:"nosToken",entity:"nosToken"}]},uploadSdkLogUrl:{sid:e.misc.id,cid:e.misc.uploadSdkLogUrl,params:[{type:"string",name:"url"}]},audioToText:{sid:e.misc.id,cid:e.misc.audioToText,params:[{type:"Property",name:"audioToText"}]},processImage:{sid:e.misc.id,cid:e.misc.processImage,params:[{type:"String",name:"url"},{type:"PropertyArray",name:"imageOps",entity:"imageOp"}]},getClientAntispam:{sid:e.misc.id,cid:e.misc.getClientAntispam,params:[{type:"Property",name:"clientAntispam"}]},fileQuickTransfer:{sid:e.misc.id,cid:e.misc.fileQuickTransfer,params:[{type:"Property",name:"fileQuickTransfer"}]},getNosOriginUrl:{sid:e.misc.id,cid:e.misc.getNosOriginUrl,params:[{type:"Property",name:"nosFileUrlTag"}]},getServerTime:{sid:e.misc.id,cid:e.misc.getServerTime,params:[]},getNosAccessToken:{sid:e.misc.id,cid:e.misc.getNosAccessToken,params:[{type:"Property",name:"nosAccessTokenTag"}]},deleteNosAccessToken:{sid:e.misc.id,cid:e.misc.deleteNosAccessToken,params:[{type:"Property",name:"nosAccessTokenTag"}]},getNosTokenTrans:{sid:e.misc.id,cid:e.misc.getNosTokenTrans,params:[{type:"Property",name:"transToken"}]},fetchFile:{sid:e.misc.id,cid:e.misc.fetchFile,params:[{type:"String",name:"docId"}]},fetchFileList:{sid:e.misc.id,cid:e.misc.fetchFileList,params:[{type:"Property",name:"fileListParam"}]},removeFile:{sid:e.misc.id,cid:e.misc.removeFile,params:[{type:"String",name:"docId"}]},getNosCdnHost:{sid:e.misc.id,cid:e.misc.getNosCdnHost,params:[]},signalingCreate:{sid:e.avSignal.id,cid:e.avSignal.signalingCreate,params:[{type:"Property",name:"avSignalTag"}]},signalingDelay:{sid:e.avSignal.id,cid:e.avSignal.signalingDelay,params:[{type:"Property",name:"avSignalTag"}]},signalingClose:{sid:e.avSignal.id,cid:e.avSignal.signalingClose,params:[{type:"Property",name:"avSignalTag"}]},signalingJoin:{sid:e.avSignal.id,cid:e.avSignal.signalingJoin,params:[{type:"Property",name:"avSignalTag"}]},signalingLeave:{sid:e.avSignal.id,cid:e.avSignal.signalingLeave,params:[{type:"Property",name:"avSignalTag"}]},signalingInvite:{sid:e.avSignal.id,cid:e.avSignal.signalingInvite,params:[{type:"Property",name:"avSignalTag"}]},signalingCancel:{sid:e.avSignal.id,cid:e.avSignal.signalingCancel,params:[{type:"Property",name:"avSignalTag"}]},signalingReject:{sid:e.avSignal.id,cid:e.avSignal.signalingReject,params:[{type:"Property",name:"avSignalTag"}]},signalingAccept:{sid:e.avSignal.id,cid:e.avSignal.signalingAccept,params:[{type:"Property",name:"avSignalTag"}]},signalingControl:{sid:e.avSignal.id,cid:e.avSignal.signalingControl,params:[{type:"Property",name:"avSignalTag"}]},signalingGetChannelInfo:{sid:e.avSignal.id,cid:e.avSignal.signalingGetChannelInfo,params:[{type:"Property",name:"avSignalTag"}]},signalingCallEx:{sid:e.avSignal.id,cid:e.avSignal.signalingCallEx,params:[{type:"Property",name:"avSignalTag"}]},signalingJoinAndAccept:{sid:e.avSignal.id,cid:e.avSignal.signalingJoinAndAccept,params:[{type:"Property",name:"avSignalTag"}]}};t.exports={idMap:e,cmdConfig:n,packetConfig:{"1_2":{service:"link",cmd:"heartbeat",response:[]},"1_5":{service:"link",cmd:"negotiateTransport",response:[{type:"Property",name:"negotiateTransportTag"}]},"1_6":{service:"link",cmd:"initTransport",response:[{type:"Property",name:"initTransportTag"}]},"6_1":{service:"misc",cmd:"getSimpleNosToken",response:[{type:"PropertyArray",name:"nosTokens",entity:"nosToken"}]},"6_2":{service:"misc",cmd:"getNosToken",response:[{type:"Property",name:"nosToken"}]},"6_3":{service:"misc",cmd:"notifyUploadLog"},"6_4":{service:"misc",cmd:"uploadSdkLogUrl"},"6_5":{service:"misc",cmd:"audioToText",response:[{type:"String",name:"text"}]},"6_6":{service:"misc",cmd:"processImage",response:[{type:"String",name:"url"}]},"6_7":{service:"misc",cmd:"getNosTokenTrans",response:[{type:"Property",name:"nosToken"},{type:"String",name:"docId"}]},"6_8":{service:"misc",cmd:"notifyTransLog",response:[{type:"Property",name:"transInfo"}]},"6_9":{service:"misc",cmd:"fetchFile",response:[{type:"Property",name:"info",entity:"transInfo"}]},"6_10":{service:"misc",cmd:"fetchFileList",response:[{type:"PropertyArray",name:"list",entity:"transInfo"},{type:"Number",name:"totalCount"}]},"6_11":{service:"misc",cmd:"removeFile",response:[{type:"String",name:"res"}]},"6_17":{service:"misc",cmd:"getClientAntispam",response:[{type:"Property",name:"clientAntispam"}]},"6_18":{service:"misc",cmd:"fileQuickTransfer",response:[{type:"Property",name:"fileQuickTransfer"}]},"6_22":{service:"misc",cmd:"getNosOriginUrl",response:[{type:"Property",name:"nosFileUrlTag"}]},"6_23":{service:"misc",cmd:"getServerTime",response:[{type:"Number",name:"time"}]},"6_24":{service:"misc",cmd:"getNosAccessToken",response:[{type:"Property",name:"nosAccessTokenTag"}]},"6_25":{service:"misc",cmd:"deleteNosAccessToken"},"6_26":{service:"misc",cmd:"getNosCdnHost",response:[{type:"Property",name:"nosConfigTag"}]},"6_27":{service:"misc",cmd:"getGrayscaleConfig",response:[{type:"Property",name:"appGrayConfigTag"}]},"6_28":{service:"misc",cmd:"getMixStorePolicy",response:[{type:"Property",name:"mixStorePolicyTag"}]},"6_29":{service:"misc",cmd:"getMixStoreToken",response:[{type:"Property",name:"mixStoreTokenTag"}]},"6_30":{service:"misc",cmd:"getBackSourceToken",response:[{type:"Property",name:"backSourceTokenTag"}]},"6_31":{service:"link",cmd:"notifyDetect",response:[{type:"Property",name:"notifyDetectTag"}]},"6_32":{service:"link",cmd:"uploadDetect",response:[]},"15_1":{service:"avSignal",cmd:"signalingCreate",response:[{type:"Property",name:"avSignalTag"}]},"15_2":{service:"avSignal",cmd:"signalingDelay",response:[{type:"Property",name:"avSignalTag"}]},"15_3":{service:"avSignal",cmd:"signalingClose",response:[{type:"Property",name:"avSignalTag"}]},"15_4":{service:"avSignal",cmd:"signalingJoin",response:[{type:"Property",name:"avSignalTag"}]},"15_5":{service:"avSignal",cmd:"signalingLeave",response:[]},"15_6":{service:"avSignal",cmd:"signalingInvite",response:[]},"15_7":{service:"avSignal",cmd:"signalingCancel",response:[]},"15_8":{service:"avSignal",cmd:"signalingReject",response:[]},"15_9":{service:"avSignal",cmd:"signalingAccept",response:[]},"15_10":{service:"avSignal",cmd:"signalingControl",response:[]},"15_11":{service:"avSignal",cmd:"signalingNotify",response:[{type:"Property",name:"avSignalTag"}]},"15_12":{service:"avSignal",cmd:"signalingMutilClientSyncNotify",response:[{type:"Property",name:"avSignalTag"}]},"15_13":{service:"avSignal",cmd:"signalingUnreadMessageSyncNotify",response:[{type:"PropertyArray",name:"avSignalTag"}]},"15_14":{service:"avSignal",cmd:"signalingChannelsSyncNotify",response:[{type:"PropertyArray",name:"avSignalTag"}]},"15_15":{service:"avSignal",cmd:"signalingGetChannelInfo",response:[{type:"Property",name:"avSignalTag"}]},"15_16":{service:"avSignal",cmd:"signalingCallEx",response:[{type:"Property",name:"avSignalTag"}]},"15_17":{service:"avSignal",cmd:"signalingJoinAndAccept",response:[{type:"Property",name:"avSignalTag"}]}}}},function(t,r,e){var n=e(4),g=e(2),y=e(26),i=e(0),k=i.notundef,$=i.fillPropertyWithDefault,L=n,V={},z={},re=[],ie={},ue={normal:0,advanced:1},le={0:"normal",1:"advanced"},oe=L(ue),ae=V.joinMode={noVerify:0,needVerify:1,rejectAll:2};z.joinMode={0:"noVerify",1:"needVerify",2:"rejectAll"},re.push("join"),ie.joinMode=L(ae);var qe=V.beInviteMode={needVerify:0,noVerify:1};z.beInviteMode={0:"needVerify",1:"noVerify"},re.push("beInvite"),ie.beInviteMode=L(qe);var de=V.inviteMode={manager:0,all:1};z.inviteMode={0:"manager",1:"all"},re.push("invite"),ie.inviteMode=L(de);var Ne=V.updateTeamMode={manager:0,all:1};z.updateTeamMode={0:"manager",1:"all"},re.push("updateTeam"),ie.updateTeamMode=L(Ne);var ze=V.updateCustomMode={manager:0,all:1};function $e(jt){var Et;switch(i.verifyOptions(jt,"action","team::Team"),jt.action){case"create":i.verifyOptions(jt,"teamId",!1,"team::Team"),i.verifyOptions(jt,"type name","team::Team"),i.verifyParamValid("type",jt.type,oe,"team::Team"),k(jt.level)&&(i.verifyParamType("level",jt.level,"number","team::Team"),this.level=jt.level);break;case"update":i.verifyOptions(jt,"teamId","team::Team"),i.verifyOptions(jt,"type",!1,"team::Team")}k(jt.teamId)&&(this.teamId=jt.teamId),k(jt.type)&&(this.type=ue[jt.type]),k(jt.avatar)&&(this.avatar=""+jt.avatar),k(jt.name)&&(this.name=""+jt.name),k(jt.intro)&&(this.intro=""+jt.intro),k(jt.announcement)&&(this.announcement=""+jt.announcement),g(re).call(re,y(Et=this.setMode).call(Et,this,jt)),k(jt.custom)&&(this.custom=""+jt.custom)}function Lt(jt,Et){k(jt[Et+="Mode"])&&(jt[Et]=z[Et][jt[Et]])}z.updateCustomMode={0:"manager",1:"all"},re.push("updateCustom"),ie.updateCustomMode=L(ze),$e.prototype.setMode=function(jt,Et){k(jt[Et+="Mode"])&&(i.verifyParamValid(Et,jt[Et],ie[Et],"team::Team"),this[Et]=V[Et][jt[Et]])},$e.reverse=function(jt,Et){var ir=i.copy(jt);if(k(ir.teamId)&&(ir.teamId=""+ir.teamId),k(ir.type)&&(ir.type=le[ir.type]),k(ir.level)&&(ir.level=+ir.level),k(ir.valid)&&(ir.valid=+ir.valid==1),k(ir.memberNum)&&(ir.memberNum=+ir.memberNum),k(ir.memberUpdateTime)&&(ir.memberUpdateTime=+ir.memberUpdateTime),k(ir.createTime)&&(ir.createTime=+ir.createTime),k(ir.updateTime)&&(ir.updateTime=+ir.updateTime),k(ir.validToCurrentUser)&&(ir.validToCurrentUser=ir.validToCurrentUser==="1"),k(ir.mute)&&(ir.mute=ir.mute==="1"),k(ir.muteType))switch(ir.muteType){case"0":ir.mute=!1,ir.muteType="none";break;case"1":ir.mute=!0,ir.muteType="normal";break;case"3":ir.mute=!0,ir.muteType="all"}else k(ir.mute)&&(ir.mute===1?(ir.mute=!0,ir.muteType="normal"):(ir.mute=!1,ir.muteType="none"));return g(re).call(re,y(Lt).call(Lt,null,ir)),delete ir.bits,Et||$e.fillProperties(ir),ir},$e.fillProperties=function(jt){var Et=$(jt,"beInviteMode","needVerify"),ir=$(jt,"inviteMode","manager"),dr=$(jt,"updateTeamMode","manager"),Dt=$(jt,"updateCustomMode","manager"),lr=$(jt,"avatar","");return Et||ir||dr||Dt||lr},t.exports=$e},function(t,r,e){var n=e(45).clientTypeMap;function g(){}g.reverse=function(y){var i=y;return i.type=n[i.type],i},g.reverseType=function(y){return n[y]||y},t.exports=g},function(t,r,e){var n=e(22),g=e(121),y=e(7),i=e(11),k=e(64);function $(){if(!navigator||!navigator.userAgent)return!1;var z=[/Android/i,/webOS/i,/iPhone/i,/iPad/i,/iPod/i,/BlackBerry/i,/Windows Phone/i];return g(z).call(z,function(re){return navigator.userAgent.match(re)})}function L(){var z;return!(!navigator||!navigator.userAgent)&&(typeof navigator>"u"?"undefined":n(navigator))==="object"&&typeof navigator.userAgent=="string"&&y(z=navigator.userAgent).call(z,"Electron")>=0}function V(){return navigator&&navigator.userAgent}t.exports={getHostEnv:function(){return i.isBrowser?L()?"Electron":$()?"H5":V()?"BROWSER":"Unset":i.isRN?"RN":i.isWeixinApp?"Weixin":"Unset"},getHostEnvEnum:function(){return i.isBrowser?L()?5:$()?101:V()?100:0:i.isRN?2:i.isWeixinApp?6:0},getHostEnvVer:function(){if(!i.isBrowser)return"";if(!L())return k.version;try{return navigator.userAgent.match(/Electron\/([\d.]+\d+)/)[1]||k.version}catch{return k.version}},getLibEnv:function(){return"BROWSER"}}},function(t,r,e){var n=e(18),g=e(37),y=e(8),i=e(77),k=e(198),$=e(11),L=e(767),V=e(900),z=e(0),re=z.verifyOptions,ie=z.verifyParamType,ue=e(25).reportAPI,le=e(149).Chatroom,oe=e(156);function ae(de){var Ne=oe(de);return this.subType="chatroom",this.nosScene=Ne.nosScene||"chatroom",this.nosSurvivalTime=Ne.nosSurvivalTime,Ne.Protocol=k,Ne.Message=V,Ne.constructor=ae,Ne.isAnonymous&&(Ne.account=Ne.account||"nimanon_".concat(z.guid()),Ne.isAnonymous=1,z.verifyOptions(Ne,"chatroomNick","api::Chatroom"),Ne.chatroomAvatar=Ne.chatroomAvatar||" "),this.init(Ne)}ae.Protocol=k,ae.parser=le,ae.use=i.use,ae.getInstance=function(de){return de.isAnonymous&&(de.account=de.account||"nimanon_".concat(z.guid()),de.isAnonymous=1,z.verifyOptions(de,"chatroomNick","api::Chatroom.getInstance"),de.chatroomAvatar=de.chatroomAvatar||" "),i.getInstance.call(this,de)},ae.genInstanceName=function(de){return z.verifyOptions(de,"chatroomId","api::Chatroom.genInstanceName"),"Chatroom-account-"+de.account+"-chatroomId-"+de.chatroomId};var qe=ae.fn=ae.prototype=n(i.prototype);ae.info=qe.info=$.info,qe.getChatroom=function(de){(de=de||{}).done=ue({instance:this,className:"ChatroomFn",funcName:"getChatroom",done:de.done}),this.processCallback(de),this.sendCmd("getChatroom",de)},qe.updateChatroom=function(de){(de=de||{}).done=ue({instance:this,className:"ChatroomFn",funcName:"updateChatroom",done:de.done}),re(de,"chatroom needNotify","api::updateChatroom"),ie("needNotify",de.needNotify,"boolean"),this.processCustom(de),this.processCallback(de),de.chatroom=new L(de.chatroom),de.antispamTag={antiSpamBusinessId:de.antiSpamBusinessId},this.sendCmd("updateChatroom",de)},qe.closeChatroom=function(de){(de=de||{}).done=ue({instance:this,className:"ChatroomFn",funcName:"closeChatroom",done:de.done}),this.processCustom(de),this.processCallback(de),this.sendCmd("closeChatroom",de)},qe.updateTags=function(de){(de=de||{}).done=ue({instance:this,className:"ChatroomFn",funcName:"updateTags",done:de.done}),z.validate({tags:{type:"array",required:!1},notifyTargetTags:{type:"string",allowEmpty:!0,required:!1},needNotify:{type:"boolean",required:!1}},de,"chatroom::updateTags");var Ne=g({},de);this.processCallback(Ne),Ne.tags&&(Ne.tags=y(Ne.tags)),Ne.needNotify&&(Ne.needNotify=Ne.needNotify?1:0),this.sendCmd("updateChatroomTags",{chatRoomTagsUpdateTag:Ne},Ne.done)},t.exports=ae,e(910),e(911),e(912),e(913)},function(t,r,e){var n=e(18),g=e(26),y=e(9),i=e(10),k=e(78),$=e(0),L=$.undef,V=$.notundef,z=e(291),re=e(11),ie=e(149),ue=e(767),le=e(312);function oe(de){var Ne,ze,$e;$.verifyOptions(de,"appKey account chatroomId chatroomAddresses","protocol::ChatroomProtocol"),de.isAnonymous||$.verifyOptions(de,"token","protocol::ChatroomProtocol"),$.verifyParamType("chatroomAddresses",de.chatroomAddresses,"array","protocol::ChatroomProtocol"),$.verifyCallback(de,"onconnect onerror onwillreconnect ondisconnect onmsg onmsgs onrobots","protocol::ChatroomProtocol"),Ne=typeof $.get(de,"privateConf.isDataReportEnable")=="boolean"?de.privateConf.isDataReportEnable:re.privateConf.isDataReportEnable,ze=typeof $.get(de,"privateConf.reportConfigUrl")=="string"?de.privateConf.reportConfigUrl:re.privateConf.reportConfigUrl,$e=typeof $.get(de,"privateConf.reportUrl")=="string"?de.privateConf.reportUrl:re.privateConf.reportUrl,this.reporter=z.initReporter({isDataReportEnable:Ne,reportConfigUrl:ze,reportUrl:$e,appKey:de.appKey,logger:this.logger}),k.call(this,de)}var ae=k.fn,qe=oe.fn=oe.prototype=n(ae);qe.init=function(){var de;ae.init.call(this),ie.Chatroom.setProtocol(this),this.parser=ie.Chatroom,g(de=this.sendCmd).call(de,this),this.syncResult={},this.timetags={},this.msgBuffer=[]},qe.reset=function(){var de=this;ae.reset.call(de);var Ne,ze=de.options;de.autoconnect=!!ze.autoconnect,L(ze.msgBufferInterval)&&(ze.msgBufferInterval=300),$.verifyParamType("msgBufferInterval",ze.msgBufferInterval,"number","protocol::ChatroomProtocol.reset"),L(ze.msgBufferSize)&&(ze.msgBufferSize=500),$.verifyParamType("msgBufferSize",ze.msgBufferSize,"number","protocol::ChatroomProtocol.reset"),V(ze.chatroomAddresses)&&(de.socketUrlsBackup=y(Ne=ze.chatroomAddresses).call(Ne,function($e){return re.formatSocketUrl({url:$e,secure:de.options.secure})}))},qe.processChatroom=function(de){switch(de.cmd){case"login":de.error||(de.obj={chatroom:i(ue).call(ue,de.content.chatroom),member:i(le).call(le,de.content.chatroomMember)},this.cdnInfo={},this.initCdnData(),clearTimeout(this.queryCdnTimer),this.onCdnMsgInfo(de.content.chatroomCdnInfo));break;case"kicked":this.onKicked(de);break;case"logout":break;case"sendMsg":this.onSendMsg(de);break;case"msg":this.onMsg(de),this.cdnInfo&&this.cdnInfo.enable&&this.correctCdnTime(+de.content.msg.time);break;case"getChatroomMembers":case"getChatroomMembersByTag":this.onChatroomMembers(de);break;case"getChatroomMemberCountByTag":this.onGetChatroomMemberCountByTag(de);break;case"getHistoryMsgs":case"getHistoryMsgsByTags":this.onHistoryMsgs(de);break;case"markChatroomMember":this.onMarkChatroomMember(de);break;case"closeChatroom":break;case"getChatroom":this.onChatroom(de);break;case"updateChatroom":break;case"updateMyChatroomMemberInfo":delete de.obj.chatroomMember;break;case"getChatroomMembersInfo":this.onChatroomMembersInfo(de);break;case"kickChatroomMember":case"updateChatroomMemberTempMute":break;case"queueList":de.error||(de.obj=de.content);break;case"syncRobot":this.onSyncRobot(de);break;case"notifyCdnInfo":this.onCdnMsgInfo(de.content&&de.content.chatroomCdnInfo);break;case"updateChatroomTag":this.onTagsUpdate(de.content)}},qe.onChatroom=function(de){de.error||(de.obj.chatroom=i(ue).call(ue,de.content.chatroom))},qe.onTagsUpdate=function(de){if(this.logger.info("onTagsUpdate:: ",de),this.options.onTagsUpdate&&typeof this.options.onTagsUpdate=="function"){var Ne=de.updateTags&&de.updateTags.currentTags;try{Ne=JSON.parse(Ne)}catch(ze){this.logger.error("onTagsUpdate:: parse tags failed",ze)}this.options.onTagsUpdate(Ne)}},t.exports=oe,e(888),e(889),e(890),e(899)},function(t,r){t.exports=function(){}},function(t,r){t.exports=function(e,n){for(var g=n.split(".");g.length;){var y=g.shift(),i=!1;if(y[y.length-1]=="?"&&(y=y.slice(0,-1),i=!0),!(e=e[y])&&i)return e}return e}},function(t,r){t.exports=function(e,n){return e===n||e!=e&&n!=n}},function(t,r,e){var n=e(257),g=e(265);t.exports=function(y){return y!=null&&g(y.length)&&!n(y)}},function(t,r,e){var n=e(9),g=e(10),y=e(0),i=y.notundef,k=y.fillPropertyWithDefault,$={0:"normal",1:"owner",2:"manager"};function L(V){y.verifyOptions(V,"teamId","superTeam::TeamMember"),y.verifyParamAtLeastPresentOne(V,"nickInTeam muteTeam custom muteNotiType","superTeam::SuperTeamMember"),this.teamId=V.teamId,i(V.account)&&(this.account=V.account),i(V.nickInTeam)&&(this.nickInTeam=V.nickInTeam),i(V.muteNotiType)?this.bits=V.muteNotiType:i(V.muteTeam)&&(this.bits=0,V.muteTeam&&(this.bits+=1)),i(V.mute)&&(this.mute=V.mute?1:0),i(V.custom)&&(this.custom=""+V.custom)}L.reverse=function(V){var z=y.copy(V);if(i(z.teamId)&&(z.teamId=""+z.teamId),i(z.type)&&(z.type=$[z.type]),i(z.active)&&(z.active=+z.active==1),i(z.valid)&&(z.valid=+z.valid==1),i(z.mute)&&(z.mute=+z.mute==1),i(z.joinTime)&&(z.joinTime=+z.joinTime),i(z.updateTime)&&(z.updateTime=+z.updateTime),i(z.bits)){var re=z.bits;delete z.bits,z.muteTeam=!!(1&re),z.muteNotiType=re}return i(z.teamId)&&i(z.account)&&(z.id=L.genId(z.teamId,z.account)),i(z.followAccountIds)&&(z.followAccountIds=JSON.parse(z.followAccountIds)),z},L.reverseMembers=function(V){return n(V).call(V,function(z){return g(L).call(L,z)})},L.fillProperties=function(V){var z=k(V,"mute",!1),re=k(V,"custom","");return z||re},L.genId=function(V,z){return V+"-"+z},L.accounts2ids=function(V,z){return n(z).call(z,function(re){return L.genId(V,re)})},L.assembleMembers=function(V,z){return y.isArray(z)||(z=[z]),n(z).call(z,function(re){return L.assembleMember(V,re)})},L.assembleMember=function(V,z){return{id:L.genId(V.teamId,z),account:z,teamId:V.teamId,type:"normal",nickInTeam:"",muteTeam:!1,mute:!1,joinTime:V.memberUpdateTime,updateTime:V.memberUpdateTime,active:!0,valid:!0,followAccountIds:[]}},L.assembleOwner=function(V){var z=L.assembleMember(V,V.owner);return z.type="owner",z},t.exports=L},function(t,r,e){var n=e(9),g=e(10),y=e(4),i=e(108).genPrivateUrl,k=e(0),$={unknown:0,male:1,female:2},L={0:"unknown",1:"male",2:"female"};function V(z){k.merge(this,z),k.notundef(this.gender)&&(k.verifyParamValid("gender",this.gender,V.validGenders,"user::User"),this.gender=$[this.gender]),k.notundef(this.email)&&this.email!==""&&k.verifyEmail("email",this.email,"user::User"),k.notundef(this.birth)&&this.birth!==""&&k.verifyBirth("birth",this.birth,"user::User"),k.notundef(this.tel)&&this.tel!==""&&k.verifyTel("tel",this.tel,"user::User")}V.reverse=function(z,re,ie){var ue=k.filterObj(z,"account nick avatar _avatar_safe sign gender email birth tel custom createTime updateTime");return k.notundef(ue.avatar)&&(ue.avatar=i(ue.avatar,re,ie)),k.notundef(ue.gender)&&(ue.gender=L[ue.gender]),k.notundef(ue.createTime)&&(ue.createTime=+ue.createTime),k.notundef(ue.updateTime)&&(ue.updateTime=+ue.updateTime),ue},V.reverseUsers=function(z){return n(z).call(z,function(re){return g(V).call(V,re)})},V.validGenders=y($),t.exports=V},function(t,r,e){var n=e(8),g=e(18),y=e(10),i=e(7),k=e(108).genPrivateUrl,$=e(76),L=e(0),V=e(11);function z(le,oe){switch(L.notundef(le.type)?L.verifyFileType(le.type,"msg::FileMessage"):le.type="file",L.verifyOptions(le,"file","msg::FileMessage"),L.verifyOptions(le.file,"url ext size",!0,"file.","msg::FileMessage"),le.type){case"image":re.verifyFile(le.file,"msg::FileMessage");break;case"audio":ie.verifyFile(le.file,"msg::FileMessage");break;case"video":ue.verifyFile(le.file,"msg::FileMessage")}$.call(this,le),oe&&(this.idClient=oe),this.attach=n(le.file)}z.prototype=g($.prototype),z.reverse=function(le){var oe=y($).call($,le);if(le.attach=le.attach?""+le.attach:"",le.attach&&(oe.file=JSON.parse(le.attach),!oe.file.isS3)){var ae,qe;oe.file.url=k(oe.file.url)||"",oe.type==="audio"&&oe.file.url&&!oe.file.mp3Url&&(oe.file.mp3Url=oe.file.url+(~i(qe=oe.file.url).call(qe,"?")?"&":"?")+"audioTrans&type=mp3"),V.httpsEnabled&&i(ae=oe.file.url).call(ae,"https://")!==0&&(oe.file.url=oe.file.url.replace("http","https"))}return oe},t.exports=z;var re=e(836),ie=e(837),ue=e(838)},function(t,r,e){var n=e(8),g=e(18),y=e(10),i=e(7),k=e(108).genPrivateUrl,$=e(119),L=e(0),V=e(11);function z(le,oe){switch(L.notundef(le.type)?L.verifyFileType(le.type,"msg::FileMessage"):le.type="file",L.verifyOptions(le,"file","msg::FileMessage"),L.verifyOptions(le.file,"url ext size",!0,"file.","msg::FileMessage"),le.type){case"image":re.verifyFile(le.file,"msg::FileMessage");break;case"audio":ie.verifyFile(le.file,"msg::FileMessage");break;case"video":ue.verifyFile(le.file,"msg::FileMessage")}$.call(this,le),oe&&(this.idClient=oe),this.attach=n(le.file)}z.prototype=g($.prototype),z.reverse=function(le){var oe=y($).call($,le);if(le.attach=le.attach?""+le.attach:"",le.attach&&(oe.file=JSON.parse(le.attach),!oe.file.isS3)){var ae,qe;oe.file.url=k(oe.file.url)||"",oe.type==="audio"&&oe.file.url&&!oe.file.mp3Url&&(oe.file.mp3Url=oe.file.url+(~i(qe=oe.file.url).call(qe,"?")?"&":"?")+"audioTrans&type=mp3"),V.httpsEnabled&&i(ae=oe.file.url).call(ae,"https://")!==0&&(oe.file.url=oe.file.url.replace("http","https"))}return oe},t.exports=z;var re=e(902),ie=e(903),ue=e(904)},function(t,r,e){var n=e(315);t.exports=n},function(t,r){var e=typeof document=="object"&&document.all,n=e===void 0&&e!==void 0;t.exports={all:e,IS_HTMLDDA:n}},function(t,r,e){var n=e(97);t.exports=n&&!Symbol.sham&&typeof Symbol.iterator=="symbol"},function(t,r,e){var n=e(27),g=e(5),y=e(162);t.exports=!n&&!g(function(){return Object.defineProperty(y("div"),"a",{get:function(){return 7}}).a!=7})},function(t,r,e){var n=e(5),g=e(17),y=/#|\.prototype\./,i=function(z,re){var ie=$[k(z)];return ie==V||ie!=L&&(g(re)?n(re):!!re)},k=i.normalize=function(z){return String(z).replace(y,".").toLowerCase()},$=i.data={},L=i.NATIVE="N",V=i.POLYFILL="P";t.exports=i},function(t,r,e){var n=e(27),g=e(5);t.exports=n&&g(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!=42})},function(t,r,e){var n=e(1),g=e(5),y=e(83),i=e(28),k=e(42),$=e(46),L=e(214),V=e(99),z=e(164),re=e(113),ie=e(21),ue=e(98),le=ie("isConcatSpreadable"),oe=ue>=51||!g(function(){var de=[];return de[le]=!1,de.concat()[0]!==de}),ae=re("concat"),qe=function(de){if(!i(de))return!1;var Ne=de[le];return Ne!==void 0?!!Ne:y(de)};n({target:"Array",proto:!0,arity:1,forced:!oe||!ae},{concat:function(de){var Ne,ze,$e,Lt,jt,Et=k(this),ir=z(Et,0),dr=0;for(Ne=-1,$e=arguments.length;Ne<$e;Ne++)if(qe(jt=Ne===-1?Et:arguments[Ne]))for(Lt=$(jt),L(dr+Lt),ze=0;ze<Lt;ze++,dr++)ze in jt&&V(ir,dr,jt[ze]);else L(dr+1),V(ir,dr++,jt);return ir.length=dr,ir}})},function(t,r){var e=TypeError;t.exports=function(n){if(n>9007199254740991)throw e("Maximum allowed index exceeded");return n}},function(t,r,e){var n=e(12),g=e(17),y=e(161),i=n(Function.toString);g(y.inspectSource)||(y.inspectSource=function(k){return i(k)}),t.exports=y.inspectSource},function(t,r,e){var n=e(327);t.exports=n},function(t,r,e){var n=e(12),g=e(30),y=e(44),i=e(163).indexOf,k=e(114),$=n([].push);t.exports=function(L,V){var z,re=y(L),ie=0,ue=[];for(z in re)!g(k,z)&&g(re,z)&&$(ue,z);for(;V.length>ie;)g(re,z=V[ie++])&&(~i(ue,z)||$(ue,z));return ue}},function(t,r,e){var n=e(33);t.exports=n("document","documentElement")},function(t,r,e){var n=e(332);e(69),t.exports=n},function(t,r,e){e(333),e(336),e(337),e(224),e(338)},function(t,r,e){var n=e(131),g=e(46),y=e(99),i=Array,k=Math.max;t.exports=function($,L,V){for(var z=g($),re=n(L,z),ie=n(V===void 0?z:V,z),ue=i(k(ie-re,0)),le=0;re<ie;re++,le++)y(ue,le,$[re]);return ue.length=le,ue}},function(t,r,e){var n=e(20),g=e(33),y=e(21),i=e(68);t.exports=function(){var k=g("Symbol"),$=k&&k.prototype,L=$&&$.valueOf,V=y("toPrimitive");$&&!$[V]&&i($,V,function(z){return n(L,this)},{arity:1})}},function(t,r,e){var n=e(97);t.exports=n&&!!Symbol.for&&!!Symbol.keyFor},function(t,r,e){var n=e(1),g=e(33),y=e(79),i=e(20),k=e(12),$=e(5),L=e(83),V=e(17),z=e(28),re=e(129),ie=e(102),ue=e(97),le=g("JSON","stringify"),oe=k(/./.exec),ae=k("".charAt),qe=k("".charCodeAt),de=k("".replace),Ne=k(1 .toString),ze=/[\uD800-\uDFFF]/g,$e=/^[\uD800-\uDBFF]$/,Lt=/^[\uDC00-\uDFFF]$/,jt=!ue||$(function(){var Dt=g("Symbol")();return le([Dt])!="[null]"||le({a:Dt})!="{}"||le(Object(Dt))!="{}"}),Et=$(function(){return le("\uDF06\uD834")!=='"\\udf06\\ud834"'||le("\uDEAD")!=='"\\udead"'}),ir=function(Dt,lr){var sr=ie(arguments),er=lr;if((z(lr)||Dt!==void 0)&&!re(Dt))return L(lr)||(lr=function(cr,or){if(V(er)&&(or=i(er,this,cr,or)),!re(or))return or}),sr[1]=lr,y(le,null,sr)},dr=function(Dt,lr,sr){var er=ae(sr,lr-1),cr=ae(sr,lr+1);return oe($e,Dt)&&!oe(Lt,cr)||oe(Lt,Dt)&&!oe($e,er)?"\\u"+Ne(qe(Dt,0),16):Dt};le&&n({target:"JSON",stat:!0,arity:3,forced:jt||Et},{stringify:function(Dt,lr,sr){var er=ie(arguments),cr=y(jt?ir:le,null,er);return Et&&typeof cr=="string"?de(cr,ze,dr):cr}})},function(t,r,e){e(23)("iterator")},function(t,r,e){var n=e(23),g=e(222);n("toPrimitive"),g()},function(t,r,e){var n=e(27),g=e(30),y=Function.prototype,i=n&&Object.getOwnPropertyDescriptor,k=g(y,"name"),$=k&&(function(){}).name==="something",L=k&&(!n||n&&i(y,"name").configurable);t.exports={EXISTS:k,PROPER:$,CONFIGURABLE:L}},function(t,r,e){var n,g,y,i=e(5),k=e(17),$=e(28),L=e(84),V=e(137),z=e(68),re=e(21),ie=e(49),ue=re("iterator"),le=!1;[].keys&&("next"in(y=[].keys())?(g=V(V(y)))!==Object.prototype&&(n=g):le=!0),!$(n)||i(function(){var oe={};return n[ue].call(oe)!==oe})?n={}:ie&&(n=L(n)),k(n[ue])||z(n,ue,function(){return this}),t.exports={IteratorPrototype:n,BUGGY_SAFARI_ITERATORS:le}},function(t,r,e){var n=e(5);t.exports=!n(function(){function g(){}return g.prototype.constructor=null,Object.getPrototypeOf(new g)!==g.prototype})},function(t,r,e){e(69);var n=e(67),g=e(30),y=e(19),i=e(374),k=Array.prototype,$={DOMTokenList:!0,NodeList:!0};t.exports=function(L){var V=L.forEach;return L===k||y(k,L)&&V===k.forEach||g($,n(L))?i:V}},function(t,r,e){var n=e(382);t.exports=n},function(t,r,e){var n=e(386);e(69),t.exports=n},function(t,r,e){e(387)},function(t,r,e){var n=e(33),g=e(12),y=e(134),i=e(135),k=e(36),$=g([].concat);t.exports=n("Reflect","ownKeys")||function(L){var V=y.f(k(L)),z=i.f;return z?$(V,z(L)):V}},function(t,r,e){var n=e(21),g=e(103),y=n("iterator"),i=Array.prototype;t.exports=function(k){return k!==void 0&&(g.Array===k||i[y]===k)}},function(t,r,e){var n=e(20),g=e(31),y=e(36),i=e(81),k=e(139),$=TypeError;t.exports=function(L,V){var z=arguments.length<2?k(L):V;if(g(z))return y(n(z,L));throw $(i(L)+" is not iterable")}},function(t,r,e){var n=e(20),g=e(36),y=e(160);t.exports=function(i,k,$){var L,V;g(i);try{if(!(L=y(i,"return"))){if(k==="throw")throw $;return $}L=n(L,i)}catch(z){V=!0,L=z}if(k==="throw")throw $;if(V)throw L;return g(L),$}},function(t,r,e){var n=e(33),g=e(39),y=e(21),i=e(27),k=y("species");t.exports=function($){var L=n($),V=g.f;i&&L&&!L[k]&&V(L,k,{configurable:!0,get:function(){return this}})}},function(t,r,e){var n=e(36),g=e(172),y=e(96),i=e(21)("species");t.exports=function(k,$){var L,V=n(k).constructor;return V===void 0||y(L=n(V)[i])?$:g(L)}},function(t,r,e){var n,g,y,i,k=e(14),$=e(79),L=e(34),V=e(17),z=e(30),re=e(5),ie=e(218),ue=e(102),le=e(162),oe=e(241),ae=e(242),qe=e(116),de=k.setImmediate,Ne=k.clearImmediate,ze=k.process,$e=k.Dispatch,Lt=k.Function,jt=k.MessageChannel,Et=k.String,ir=0,dr={};try{n=k.location}catch{}var Dt=function(cr){if(z(dr,cr)){var or=dr[cr];delete dr[cr],or()}},lr=function(cr){return function(){Dt(cr)}},sr=function(cr){Dt(cr.data)},er=function(cr){k.postMessage(Et(cr),n.protocol+"//"+n.host)};de&&Ne||(de=function(cr){oe(arguments.length,1);var or=V(cr)?cr:Lt(cr),hr=ue(arguments,1);return dr[++ir]=function(){$(or,void 0,hr)},g(ir),ir},Ne=function(cr){delete dr[cr]},qe?g=function(cr){ze.nextTick(lr(cr))}:$e&&$e.now?g=function(cr){$e.now(lr(cr))}:jt&&!ae?(i=(y=new jt).port2,y.port1.onmessage=sr,g=L(i.postMessage,i)):k.addEventListener&&V(k.postMessage)&&!k.importScripts&&n&&n.protocol!=="file:"&&!re(er)?(g=er,k.addEventListener("message",sr,!1)):g="onreadystatechange"in le("script")?function(cr){ie.appendChild(le("script")).onreadystatechange=function(){ie.removeChild(this),Dt(cr)}}:function(cr){setTimeout(lr(cr),0)}),t.exports={set:de,clear:Ne}},function(t,r){var e=TypeError;t.exports=function(n,g){if(n<g)throw e("Not enough arguments");return n}},function(t,r,e){var n=e(66);t.exports=/(?:ipad|iphone|ipod).*applewebkit/i.test(n)},function(t,r){t.exports=typeof Deno=="object"&&Deno&&typeof Deno.version=="object"},function(t,r,e){var n=e(105),g=e(245),y=e(117).CONSTRUCTOR;t.exports=y||!g(function(i){n.all(i).then(void 0,function(){})})},function(t,r,e){var n=e(21)("iterator"),g=!1;try{var y=0,i={next:function(){return{done:!!y++}},return:function(){g=!0}};i[n]=function(){return this},Array.from(i,function(){throw 2})}catch{}t.exports=function(k,$){if(!$&&!g)return!1;var L=!1;try{var V={};V[n]=function(){return{next:function(){return{done:L=!0}}}},k(V)}catch{}return L}},function(t,r,e){var n=e(36),g=e(28),y=e(70);t.exports=function(i,k){if(n(i),g(k)&&k.constructor===i)return k;var $=y.f(i);return(0,$.resolve)(k),$.promise}},function(t,r,e){var n=e(1),g=e(20),y=e(31),i=e(70),k=e(104),$=e(47);n({target:"Promise",stat:!0},{allSettled:function(L){var V=this,z=i.f(V),re=z.resolve,ie=z.reject,ue=k(function(){var le=y(V.resolve),oe=[],ae=0,qe=1;$(L,function(de){var Ne=ae++,ze=!1;qe++,g(le,V,de).then(function($e){ze||(ze=!0,oe[Ne]={status:"fulfilled",value:$e},--qe||re(oe))},function($e){ze||(ze=!0,oe[Ne]={status:"rejected",reason:$e},--qe||re(oe))})}),--qe||re(oe)});return ue.error&&ie(ue.value),z.promise}})},function(t,r,e){var n=e(1),g=e(20),y=e(31),i=e(33),k=e(70),$=e(104),L=e(47);n({target:"Promise",stat:!0},{any:function(V){var z=this,re=i("AggregateError"),ie=k.f(z),ue=ie.resolve,le=ie.reject,oe=$(function(){var ae=y(z.resolve),qe=[],de=0,Ne=1,ze=!1;L(V,function($e){var Lt=de++,jt=!1;Ne++,g(ae,z,$e).then(function(Et){jt||ze||(ze=!0,ue(Et))},function(Et){jt||ze||(jt=!0,qe[Lt]=Et,--Ne||le(new re(qe,"No one promise resolved")))})}),--Ne||le(new re(qe,"No one promise resolved"))});return oe.error&&le(oe.value),ie.promise}})},function(t,r,e){var n=e(410);t.exports=n},function(t,r,e){var n=e(22).default,g=e(412);t.exports=function(y){var i=g(y,"string");return n(i)==="symbol"?i:String(i)},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,r,e){var n=e(420);t.exports=n},function(t,r,e){var n=e(81),g=TypeError;t.exports=function(y,i){if(!delete y[i])throw g("Cannot delete property "+n(i)+" of "+n(y))}},function(t,r,e){e(455),e(457)},function(t,r,e){var n,g=e(14),y=e(79),i=e(17),k=e(456),$=e(66),L=e(102),V=e(241),z=g.Function,re=/MSIE .\./.test($)||k&&((n=g.Bun.version.split(".")).length<3||n[0]==0&&(n[1]<3||n[1]==3&&n[2]==0));t.exports=function(ie,ue){var le=ue?2:1;return re?function(oe,ae){var qe=V(arguments.length,1)>le,de=i(oe)?oe:z(oe),Ne=qe?L(arguments,le):[],ze=qe?function(){y(de,this,Ne)}:de;return ue?ie(ze,ae):ie(ze)}:ie}},function(t,r,e){var n=e(480);t.exports=n},function(t,r){t.exports=function e(n,g){var y,i,k=/(^([+\-]?(?:0|[1-9]\d*)(?:\.\d*)?(?:[eE][+\-]?\d+)?)?$|^0x[0-9a-f]+$|\d+)/gi,$=/(^[ ]*|[ ]*$)/g,L=/(^([\w ]+,?[\w ]+)?[\w ]+,?[\w ]+\d+:\d+(:\d+)?[\w ]?|^\d{1,4}[\/\-]\d{1,4}[\/\-]\d{1,4}|^\w+, \w+ \d+, \d{4})/,V=/^0x[0-9a-f]+$/i,z=/^0/,re=function(ze){return e.insensitive&&(""+ze).toLowerCase()||""+ze},ie=re(n).replace($,"")||"",ue=re(g).replace($,"")||"",le=ie.replace(k,"\0$1\0").replace(/\0$/,"").replace(/^\0/,"").split("\0"),oe=ue.replace(k,"\0$1\0").replace(/\0$/,"").replace(/^\0/,"").split("\0"),ae=parseInt(ie.match(V),16)||le.length!==1&&ie.match(L)&&Date.parse(ie),qe=parseInt(ue.match(V),16)||ae&&ue.match(L)&&Date.parse(ue)||null;if(qe){if(ae<qe)return-1;if(ae>qe)return 1}for(var de=0,Ne=Math.max(le.length,oe.length);de<Ne;de++){if(y=!(le[de]||"").match(z)&&parseFloat(le[de])||le[de]||0,i=!(oe[de]||"").match(z)&&parseFloat(oe[de])||oe[de]||0,isNaN(y)!==isNaN(i))return isNaN(y)?1:-1;if(typeof y!=typeof i&&(y+="",i+=""),y<i)return-1;if(y>i)return 1}return 0}},function(t,r,e){var n=e(124),g=e(91);t.exports=function(y){if(!g(y))return!1;var i=n(y);return i=="[object Function]"||i=="[object GeneratorFunction]"||i=="[object AsyncFunction]"||i=="[object Proxy]"}},function(t,r,e){(function(n){var g=typeof n=="object"&&n&&n.Object===Object&&n;t.exports=g}).call(this,e(73))},function(t,r){var e=Function.prototype.toString;t.exports=function(n){if(n!=null){try{return e.call(n)}catch{}try{return n+""}catch{}}return""}},function(t,r,e){var n=e(509),g=e(516),y=e(518),i=e(519),k=e(520);function $(L){var V=-1,z=L==null?0:L.length;for(this.clear();++V<z;){var re=L[V];this.set(re[0],re[1])}}$.prototype.clear=n,$.prototype.delete=g,$.prototype.get=y,$.prototype.has=i,$.prototype.set=k,t.exports=$},function(t,r,e){var n=e(262),g=e(201),y=Object.prototype.hasOwnProperty;t.exports=function(i,k,$){var L=i[k];y.call(i,k)&&g(L,$)&&($!==void 0||k in i)||n(i,k,$)}},function(t,r,e){var n=e(522);t.exports=function(g,y,i){y=="__proto__"&&n?n(g,y,{configurable:!0,enumerable:!0,value:i,writable:!0}):g[y]=i}},function(t,r,e){var n=e(524),g=e(525),y=e(177),i=e(264),k=e(302),$=e(528),L=Object.prototype.hasOwnProperty;t.exports=function(V,z){var re=y(V),ie=!re&&g(V),ue=!re&&!ie&&i(V),le=!re&&!ie&&!ue&&$(V),oe=re||ie||ue||le,ae=oe?n(V.length,String):[],qe=ae.length;for(var de in V)!z&&!L.call(V,de)||oe&&(de=="length"||ue&&(de=="offset"||de=="parent")||le&&(de=="buffer"||de=="byteLength"||de=="byteOffset")||k(de,qe))||ae.push(de);return ae}},function(t,r,e){(function(n){var g=e(56),y=e(527),i=r&&!r.nodeType&&r,k=i&&typeof n=="object"&&n&&!n.nodeType&&n,$=k&&k.exports===i?g.Buffer:void 0,L=($?$.isBuffer:void 0)||y;n.exports=L}).call(this,e(147)(t))},function(t,r){t.exports=function(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=9007199254740991}},function(t,r){t.exports=function(e,n){return function(g){return e(n(g))}}},function(t,r){t.exports=function(){return[]}},function(t,r,e){var n=e(269),g=e(270),y=e(182),i=e(267),k=Object.getOwnPropertySymbols?function($){for(var L=[];$;)n(L,y($)),$=g($);return L}:i;t.exports=k},function(t,r){t.exports=function(e,n){for(var g=-1,y=n.length,i=e.length;++g<y;)e[i+g]=n[g];return e}},function(t,r,e){var n=e(266)(Object.getPrototypeOf,Object);t.exports=n},function(t,r,e){var n=e(269),g=e(177);t.exports=function(y,i,k){var $=i(y);return g(y)?$:n($,k(y))}},function(t,r,e){var n=e(87)(e(56),"Set");t.exports=n},function(t,r,e){var n=e(571);t.exports=n},function(t,r,e){var n=e(12),g=e(31),y=e(28),i=e(30),k=e(102),$=e(109),L=Function,V=n([].concat),z=n([].join),re={},ie=function(ue,le,oe){if(!i(re,le)){for(var ae=[],qe=0;qe<le;qe++)ae[qe]="a["+qe+"]";re[le]=L("C,a","return new C("+z(ae,",")+")")}return re[le](ue,oe)};t.exports=$?L.bind:function(ue){var le=g(this),oe=le.prototype,ae=k(arguments,1),qe=function(){var de=V(ae,k(arguments));return this instanceof qe?ie(le,de.length,de):le.apply(ue,de)};return y(oe)&&(qe.prototype=oe),qe}},function(t,r,e){var n=e(90),g=e(7),y=e(71),i=e(126),k=e(8),$=e(62),L=$.getGlobal(),V={},z=L.name||"_parent",re=[],ie=[];V.addMsgListener=function($e){re.push($e)};var ue,le,oe,ae,qe=(ue=/^([\w]+?:\/\/.*?(?=\/|$))/i,function($e){return $e=$e||"",ue.test($e)?RegExp.$1:"*"}),de=function(){var $e,Lt,jt=n($e=unescape(L.name||"")).call($e);if(jt&&g(jt).call(jt,"MSG|")===0){L.name="";var Et=$.string2object(jt.replace("MSG|",""),"|"),ir=(Et.origin||"").toLowerCase();ir&&ir!=="*"&&g(Lt=location.href.toLowerCase()).call(Lt,ir)!==0||function(dr){for(var Dt=0,lr=re.length;Dt<lr;Dt++)try{re[Dt].call(null,dr)}catch{}}({data:JSON.parse(Et.data||"null"),source:L.frames[Et.self]||Et.self,origin:qe(Et.ref||(typeof document>"u"?"":document.referrer))})}},Ne=(oe=function($e,Lt){for(var jt=0,Et=$e.length;jt<Et;jt++)if($e[jt]===Lt)return!0;return!1},function(){if(ie.length){le=[];for(var $e,Lt=ie.length-1;Lt>=0;Lt--)$e=ie[Lt],oe(le,$e.w)||(le.push($e.w),y(ie).call(ie,Lt,1),$e.w.name=$e.d);le=null}}),ze=V.startTimer=(ae=!1,function(){ae||(ae=!0,L.postMessage||(i(Ne,100),i(de,20)))});V.postMessage=function($e){var Lt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if($.fillUndef(Lt,{origin:"*",source:z}),L.postMessage){var jt=Lt.data;L.FormData||(jt=k(jt)),$e.postMessage(jt,Lt.origin)}else{if(ze(),$.isObject(Lt)){var Et={};Et.origin=Lt.origin||"",Et.ref=location.href,Et.self=Lt.source,Et.data=k(Lt.data),Lt="MSG|"+$.object2string(Et,"|",!0)}ie.unshift({w:$e,d:escape(Lt)})}},t.exports=V},function(t,r,e){var n=e(593);t.exports=n},function(t,r,e){var n=e(0),g={file:{md5:"$(Etag)",size:"$(ObjectSize)"},image:{md5:"$(Etag)",size:"$(ObjectSize)",w:"$(ImageInfo.Width)",h:"$(ImageInfo.Height)",orientation:"$(ImageInfo.Orientation)"},audio:{md5:"$(Etag)",size:"$(ObjectSize)",dur:"$(AVinfo.Audio.Duration)"},video:{md5:"$(Etag)",size:"$(ObjectSize)",dur:"$(AVinfo.Video.Duration)",w:"$(AVinfo.Video.Width)",h:"$(AVinfo.Video.Height)"}},y={genResponseBody:function(i){return g[i=i||"file"]},parseResponse:function(i,k){n.notundef(i.size)&&(i.size=+i.size),n.notundef(i.w)&&(i.w=+i.w),n.notundef(i.h)&&(i.h=+i.h),n.notundef(i.dur)&&(i.dur=+i.dur);var $=i.orientation;if(n.notundef($)&&(delete i.orientation,k&&($==="right, top"||$==="left, bottom"))){var L=i.w;i.w=i.h,i.h=L}return i}};t.exports=y},function(t,r,e){var n=e(125),g=e(15),y=e(7),i=e(60),k=e(48),$=e(24),L=["Code","code","Message","message"],V=e(11),z=e(0),re=e(41),ie=e(609),ue=e(610),le=e(107),oe=le.EMResourceUploadWay,ae=le.EMExceptionState,qe=e(186).abort,de=z.supportFormData;function Ne($e,Lt){var jt=this,Et=$e.uploadprogress,ir=$e.uploaddone,dr=$e.beginupload;return{beginupload:typeof dr=="function"?function(Dt){try{dr(Dt,Lt)}catch(lr){jt.logger.error("Upload::options.beginupload execute error",lr)}}:function(){},uploadprogress:typeof Et=="function"?function(Dt){jt.reporterHook.emit("reporter/uploadUpdate",{transferred_size:Dt.loaded});try{Et(Dt,Lt)}catch(lr){jt.logger.error("Upload::options.uploadprogress execute error",lr)}}:function(Dt){jt.reporterHook.emit("reporter/uploadUpdate",{transferred_size:Dt.loaded})},uploaddone:function(Dt,lr){Dt?jt.reporterHook.emit("reporter/uploadEnd",Dt.code==="RequestAbortedError"||Dt.code==="abort"?ae.kCanceled:ae.kFailed):jt.reporterHook.emit("reporter/uploadEnd",ae.kSucceed);try{ir(Dt,lr,null,Lt)}catch(sr){jt.logger.error("Upload::options.uploaddone execute error",sr)}}}}function ze($e,Lt,jt){var Et=this;Et.options=z.copy($e),$e=Et.options,z.verifyOptions($e,"url fileName"),z.verifyParamPresentJustOne($e,"blob fileInput"),z.verifyCallback($e,"beginupload uploadprogress uploaddone"),Et.reporterHook=Lt.reporterHook,Et.logger=Lt.logger,Et.message=jt;var ir=Ne.call(this,$e,jt),dr=ir.beginupload,Dt=ir.uploadprogress,lr=ir.uploaddone;Et.options.beginupload=dr,Et.options.uploadprogress=Dt,Et.options.uploaddone=lr,$e.fileInput&&($e.fileInput=z.verifyFileInput($e.fileInput)),$e.type&&z.verifyFileType($e.type),$e.timeout?z.verifyParamType("timeout",$e.timeout,"number"):$e.timeout=6e5,z.verifyFileUploadCallback($e),$e.data={},$e.params&&z.merge($e.data,$e.params);var sr,er,cr=$e.fileName,or=$e.fileInput;if(de){if(or){if(!(er=$e.type?z.filterFiles(or.files,$e.type):g([]).call(or.files,0))||!er.length)return void $e.uploaddone(re.newWrongFileTypeError("未读取到"+$e.type+"类型的文件, 请确保文件选择节点的文件不为空, 并且请确保选择了"+$e.type+"类型的文件"));$e.data[cr]=er[0],sr=or.files[0].size}else if($e.blob){var hr;if($e.data[cr]=$e.blob,$e.type!=="file"&&$e.blob.type&&y(hr=$e.blob.type).call(hr,$e.type)===-1)return void $e.uploaddone(re.newWrongFileTypeError("未读取到"+$e.type+"类型的文件, 请确保选择了"+$e.type+"类型的文件"));sr=$e.blob.size}if(Et.reporterHook.emit("reporter/uploadUpdate",{full_size:sr}),$e.maxSize&&sr>$e.maxSize)return void $e.uploaddone(re.newFileTooLargeError("上传文件大小超过".concat($e.maxSize,"限制")))}function pr(){if(Et.logger.info("Upload:enter aws upload"),sr){if(sr>V.chunkMaxSize)$e.uploaddone(re.newFileTooLargeError("直传文件大小超过".concat(V.commonMaxSize,"限制")));else if($e.s3Policy&&$e.s3Policy.uploadConfig&&$e.s3Policy.uploadConfig.retryPolicy){var Pr=$e.s3Policy.uploadConfig.retryPolicy,Cr={accessKeyId:$e.mixStoreToken.accessKeyId,secretAccessKey:$e.mixStoreToken.secretAccessKey,sessionToken:$e.mixStoreToken.sessionToken,region:$e.mixStoreToken.region,maxRetries:Pr.retry},rr=new $e.s3;rr.config.update(Cr);var kr=Et.reporterHook.getNTPTime();rr.config.systemClockOffset=kr-i();var Ir=decodeURIComponent($e.mixStoreToken.bucket),xr=decodeURIComponent($e.mixStoreToken.objectName),vr=$e.data[cr],_r=rr.upload({Bucket:Ir,Key:xr,Body:vr,Metadata:{token:$e.mixStoreToken.token},ContentType:vr.type||"application/octet-stream"});_r.on("httpUploadProgress",function(Or){var Mr=Math.floor(1e4*Or.loaded/Or.total)/100,yr={docId:$e.docId,total:Or.total,loaded:Or.loaded,percentage:Mr,percentageText:Mr+"%"};$e.fileInput&&(yr.fileInput=$e.fileInput),$e.blob&&(yr.blob=$e.blob),$e.uploadprogress(yr)}),_r.send(function(Or,Mr){if($e.errorHook({bucket:Ir,object:xr},{provider:"s3"}),$e.docId&&(Mr.docId=$e.docId),Or&&Or.code==="RequestAbortedError")Et.logger.error("uploadFile:","api::s3:upload file abort",Or),Et.onError(Or);else if(Or){var yr;$e.logger.error("error:","api::s3:upload file failed",Or);var mr=$e.providers[(y(yr=$e.providers).call(yr,$e.curProvider)+1)%$e.providers.length];Pr.retryNext&&mr?(Et.addCircuitTimer($e,mr),mr===1&&$e.getMixStoreToken(1,function(Br){$e.mixStoreToken=Br,Sr()})):Et.onError(Mr),$e.errorHook(Or,{provider:"s3"})}else{var Tr=Et.options.s3Policy.cdnSchema;Tr=(Tr=Tr.replace("{cdnDomain}",Et.options.s3Policy.dlcdn)).replace("{objectName}",Mr.Key),$e.uploaddone(null,{size:vr.size,name:vr.name,url:Tr,ext:vr.name&&vr.name.split(".")[1]||"unknown",_url_safe:$e.mixStoreToken.shortUrl,isS3:!0}),$e.logger.info("s3 Upload done: fileObj is",{size:vr.size,name:vr.name,url:Tr,ext:vr.name&&vr.name.split(".")[1]||"unknown",_url_safe:$e.mixStoreToken.shortUrl,isS3:!0})}}),typeof $e.beginupload=="function"&&$e.beginupload(_r)}}else $e.uploaddone(re.newFileTooLargeError("Browser version is too low"))}function Sr(){if(Et.logger.info("Upload:enter nos upload"),sr&&!$e.commonUpload)return Et.logger.info("Upload:use chunk upload, url ".concat($e.url)),sr>V.chunkMaxSize?void $e.uploaddone(re.newFileTooLargeError("直传文件大小超过".concat(V.chunkMaxSize,"限制"))):void(Et.sn=ue($e,cr,Et,-1));if(Et.logger.info("Upload:use common upload, url ".concat($e.url)),sr&&sr>V.commonMaxSize)$e.uploaddone(re.newFileTooLargeError("普通上传文件大小超过".concat(V.commonMaxSize,"限制")));else{sr||(z.dataset(or,"name",cr),$e.data.input=or);var Pr=0,Cr={data:$e.data,onaftersend:function(){$e.beginupload(Et,Et.message)},onuploading:function(rr){if(Pr!==100){var kr=Math.floor(1e4*rr.loaded/rr.total)/100;k(kr)>=100&&(Pr=kr=100);var Ir={docId:$e.docId,total:rr.total,loaded:rr.loaded,percentage:kr,percentageText:kr+"%"};$e.fileInput&&(Ir.fileInput=$e.fileInput),$e.blob&&(Ir.blob=$e.blob),$e.uploadprogress(Ir)}},onload:function(rr){var kr;if($e.docId&&(rr.docId=$e.docId),!rr.Error)return $e.uploaddone(null,rr),void $e.logger.info("nos Upload done: fileObj is",rr);if($e.mixEnable&&$e.curProvider===1){var Ir=$e.nosPolicy.uploadConfig.retryPolicy,xr=$e.providers[(y(kr=$e.providers).call(kr,$e.curProvider)+1)%$e.providers.length];Ir.retryNext&&xr?(Et.addCircuitTimer($e,xr),xr===2&&$e.getMixStoreToken(2,function(vr){$e.mixStoreToken=vr,pr()})):Et.onError(rr)}else Et.onError(rr)},onerror:function(rr){var kr;if($e.mixEnable&&$e.curProvider===1){var Ir,xr=$e.nosPolicy.uploadConfig.retryPolicy,vr=$e.providers[(y(Ir=$e.providers).call(Ir,$e.curProvider)+1)%$e.providers.length];if(xr.retryNext&&vr)Et.addCircuitTimer($e,vr),vr===2&&$e.getMixStoreToken(2,function(_r){$e.mixStoreToken=_r,pr()});else try{kr=rr.result?JSON.parse(rr.result):rr,Et.onError(kr)}catch{$e.uploaddone(new re(rr.message,rr.code),Et.options)}}else try{kr=rr.result?JSON.parse(rr.result):rr,Et.onError(kr)}catch{$e.uploaddone(new re(rr.message,rr.code),Et.options)}$e.errorHook(rr,{provider:"nos"})}};de||(Cr.mode="iframe"),Cr.putFileAtEnd=!0,Et.sn=ie($e.url,Cr)}}if($e.mixEnable&&$e.curProvider===2){var Er=Et.options.s3Policy.cdnSchema;Er=Er.replace("{cdnDomain}",Et.options.s3Policy.dlcdn),Et.reporterHook.emit("reporter/uploadUpdate",{remote_addr:Er,operation_type:oe.kResourceUploadWayAWSPlugin}),pr()}else $e.mixEnable&&$e.curProvider===1?(Et.reporterHook.emit("reporter/uploadUpdate",{remote_addr:$e.url,operation_type:oe.kResourceUploadWayNOSPlugin}),Sr()):(Et.reporterHook.emit("reporter/uploadUpdate",{remote_addr:$e.url,operation_type:oe.kResourceUploadWayNOS}),Sr())}ze.prototype.addCircuitTimer=function($e,Lt){var jt=this;if($e.curProvider=Lt,$e.s3Policy&&$e.nosPolicy){var Et=$e[$e.curProvider===1?"nosPolicy":"s3Policy"].uploadConfig.retryPolicy.circuit;if(!Et||Et===0)return;jt.circuitTimer&&clearTimeout(jt.circuitTimer),jt.circuitTimer=$(function(){$e.curProvider=$e.providers[0],jt.circuitTimer=void 0},1e3*Et)}},ze.prototype.onError=function(){var $e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},Lt=this,jt=Lt.options,Et=$e.Error||$e||{},ir=Et.Code,dr=Et.code,Dt=Et.Message,lr=Et.message,sr=n(Et,L),er=ir||dr||"unknown",cr=Dt||lr||"未知错误";jt.uploaddone(new re(er+"("+cr+")",er,sr))},ze.prototype.abort=function(){qe(this.sn)},t.exports=ze},function(t,r,e){t.exports=e(280)},function(t,r,e){var n=e(611);t.exports=n},function(t,r,e){var n=e(189),g=e(140),y=e(190);t.exports=function(i,k){if(typeof k!="function"&&k!==null)throw new TypeError("Super expression must either be null or a function");i.prototype=n(k&&k.prototype,{constructor:{value:i,writable:!0,configurable:!0}}),g(i,"prototype",{writable:!1}),k&&y(i,k)},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,r,e){var n=e(22).default,g=e(625);t.exports=function(y,i){if(i&&(n(i)==="object"||typeof i=="function"))return i;if(i!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return g(y)},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,r,e){t.exports=e(626)},function(t,r,e){var n=e(629);t.exports=n},function(t,r,e){var n=e(7),g=e(0),y={fromDataURL:function(i){var k,$,L=g.getGlobal();$=n(k=i.split(",")[0]).call(k,"base64")>=0?L.atob(i.split(",")[1]):L.decodeURIComponent(i.split(",")[1]);for(var V=i.split(",")[0].split(":")[1].split(";")[0],z=new Uint8Array($.length),re=0;re<$.length;re++)z[re]=$.charCodeAt(re);return new L.Blob([z],{type:V})}};t.exports=y},function(t,r,e){var n=e(4),g=e(9),y=e(10),i=e(0),k={stripmeta:0,blur:2,quality:3,crop:4,rotate:5,thumbnail:7,interlace:9},$={0:"stripmeta",1:"type",2:"blur",3:"quality",4:"crop",5:"rotate",6:"pixel",7:"thumbnail",8:"watermark",9:"interlace",10:"tmp"};function L(V){i.verifyOptions(V,"type","image::ImageOp"),i.verifyParamValid("type",V.type,L.validTypes,"image::ImageOp"),i.merge(this,V),this.type=k[V.type]}L.validTypes=n(k),L.reverse=function(V){var z=i.copy(V);return z.type=$[z.type],z},L.reverseImageOps=function(V){return g(V).call(V,function(z){return y(L).call(L,z)})},t.exports=L},function(t,r,e){var n=e(2),g=e(4),y={1:"ROOM_CLOSE",2:"ROOM_JOIN",3:"INVITE",4:"CANCEL_INVITE",5:"REJECT",6:"ACCEPT",7:"LEAVE",8:"CONTROL"},i={1:"accid",2:"uid",3:"createTime",4:"expireTime",5:"web_uid"},k={10404:"ROOM_NOT_EXISTS",10405:"ROOM_HAS_EXISTS",10406:"ROOM_MEMBER_NOT_EXISTS",10407:"ROOM_MEMBER_HAS_EXISTS",10408:"INVITE_NOT_EXISTS",10409:"INVITE_HAS_REJECT",10410:"INVITE_HAS_ACCEPT",10201:"PEER_NIM_OFFLINE",10202:"PEER_PUSH_OFFLINE",10419:"ROOM_MEMBER_EXCEED",10420:"ROOM_MEMBER_HAS_EXISTS_OTHER_CLIENT",10417:"UID_CONFLICT"};t.exports={parseAvSignalType:function($){return y[$]||$},parseAvSignalMember:function($){var L,V={};return n(L=g($)).call(L,function(z){V[i[z]]=$[z]}),V},parseAvSignalError:function($){return $.message=k[$.code]||$.message||$,$}}},function(t,r,e){t.exports=e(655)},function(module,exports,__webpack_require__){(function(global,module){var __WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;/*! Socket.IO.js build:0.9.11, development. Copyright(c) 2011 LearnBoost <dev@learnboost.com> MIT Licensed */function getGlobal(){return typeof window<"u"?window:typeof self<"u"?self:global!==void 0?global:{}}var root=getGlobal(),io=module.exports;root.location===void 0&&(root.location=null),root.io?module&&(module.exports=io=root.io):root.io=io,function(){(function(t,r){var e=t;e.version="0.9.11",e.protocol=1,e.transports=[],e.j=[],e.sockets={},e.connect=function(n,g){var y,i,k=e.util.parseUri(n);r&&r.location&&(k.protocol=k.protocol||r.location.protocol.slice(0,-1),k.host=k.host||(r.document?r.document.domain:r.location.hostname),k.port=k.port||r.location.port),y=e.util.uniqueUri(k);var $={host:k.ipv6uri?"["+k.host+"]":k.host,secure:k.protocol==="https",port:k.port||(k.protocol==="https"?443:80),query:k.query||""};return e.util.merge($,g),!$["force new connection"]&&e.sockets[y]||(i=new e.Socket($)),!$["force new connection"]&&i&&(e.sockets[y]=i),(i=i||e.sockets[y]).of(k.path.length>1?k.path:"")}})(module.exports,root),function(t,r){var e=t.util={},n=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,g=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];e.parseUri=function(i){var k=i,$=i.indexOf("["),L=i.indexOf("]");$!=-1&&L!=-1&&(i=i.substring(0,$)+i.substring($,L).replace(/:/g,";")+i.substring(L,i.length));for(var V=n.exec(i||""),z={},re=14;re--;)z[g[re]]=V[re]||"";return $!=-1&&L!=-1&&(z.source=k,z.host=z.host.substring(1,z.host.length-1).replace(/;/g,":"),z.authority=z.authority.replace("[","").replace("]","").replace(/;/g,":"),z.ipv6uri=!0),z},e.uniqueUri=function(i){var k=i.protocol,$=i.host,L=i.port;return"document"in r&&r.document?($=$||document.domain,L=L||(k=="https"&&document.location.protocol!=="https:"?443:document.location.port)):($=$||"localhost",L||k!="https"||(L=443)),(k||"http")+"://"+$+":"+(L||80)},e.query=function(i,k){var $=e.chunkQuery(i||""),L=[];for(var V in e.merge($,e.chunkQuery(k||"")),$)$.hasOwnProperty(V)&&L.push(V+"="+$[V]);return L.length?"?"+L.join("&"):""},e.chunkQuery=function(i){for(var k,$={},L=i.split("&"),V=0,z=L.length;V<z;++V)(k=L[V].split("="))[0]&&($[k[0]]=k[1]);return $};var y=!1;e.load=function(i){if(typeof document<"u"&&document&&document.readyState==="complete"||y)return i();e.on(r,"load",i,!1)},e.on=function(i,k,$,L){i.attachEvent?i.attachEvent("on"+k,$):i.addEventListener&&i.addEventListener(k,$,L)},e.request=function(i){if(i&&typeof XDomainRequest<"u"&&!e.ua.hasCORS)return new XDomainRequest;if(typeof XMLHttpRequest<"u"&&(!i||e.ua.hasCORS))return new XMLHttpRequest;if(!i)try{return new root[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch{}return null},root!==void 0&&e.load(function(){y=!0}),e.defer=function(i){if(!e.ua.webkit||typeof importScripts<"u")return i();e.load(function(){setTimeout(i,100)})},e.merge=function(i,k,$,L){var V,z=L||[],re=$===void 0?2:$;for(V in k)k.hasOwnProperty(V)&&e.indexOf(z,V)<0&&(typeof i[V]=="object"&&re?e.merge(i[V],k[V],re-1,z):(i[V]=k[V],z.push(k[V])));return i},e.mixin=function(i,k){e.merge(i.prototype,k.prototype)},e.inherit=function(i,k){function $(){}$.prototype=k.prototype,i.prototype=new $},e.isArray=Array.isArray||function(i){return Object.prototype.toString.call(i)==="[object Array]"},e.intersect=function(i,k){for(var $=[],L=i.length>k.length?i:k,V=i.length>k.length?k:i,z=0,re=V.length;z<re;z++)~e.indexOf(L,V[z])&&$.push(V[z]);return $},e.indexOf=function(i,k,$){var L=i.length;for($=$<0?$+L<0?0:$+L:$||0;$<L&&i[$]!==k;$++);return L<=$?-1:$},e.toArray=function(i){for(var k=[],$=0,L=i.length;$<L;$++)k.push(i[$]);return k},e.ua={},e.ua.hasCORS=typeof XMLHttpRequest<"u"&&function(){try{var i=new XMLHttpRequest}catch{return!1}return i.withCredentials!=null}(),e.ua.webkit=typeof navigator<"u"&&/webkit/i.test(navigator.userAgent),e.ua.iDevice=typeof navigator<"u"&&/iPad|iPhone|iPod/i.test(navigator.userAgent)}(io!==void 0?io:module.exports,root),function(t,r){function e(){}t.EventEmitter=e,e.prototype.on=function(n,g){return this.$events||(this.$events={}),this.$events[n]?r.util.isArray(this.$events[n])?this.$events[n].push(g):this.$events[n]=[this.$events[n],g]:this.$events[n]=g,this},e.prototype.addListener=e.prototype.on,e.prototype.once=function(n,g){var y=this;function i(){y.removeListener(n,i),g.apply(this,arguments)}return i.listener=g,this.on(n,i),this},e.prototype.removeListener=function(n,g){if(this.$events&&this.$events[n]){var y=this.$events[n];if(r.util.isArray(y)){for(var i=-1,k=0,$=y.length;k<$;k++)if(y[k]===g||y[k].listener&&y[k].listener===g){i=k;break}if(i<0)return this;y.splice(i,1),y.length||delete this.$events[n]}else(y===g||y.listener&&y.listener===g)&&delete this.$events[n]}return this},e.prototype.removeAllListeners=function(n){return n===void 0?(this.$events={},this):(this.$events&&this.$events[n]&&(this.$events[n]=null),this)},e.prototype.removeAllListenersX=function(n){if(n===void 0)return this.$events={},this;for(let g in this.$events)g!==n&&(this.$events[g]=null);return this},e.prototype.listeners=function(n){return this.$events||(this.$events={}),this.$events[n]||(this.$events[n]=[]),r.util.isArray(this.$events[n])||(this.$events[n]=[this.$events[n]]),this.$events[n]},e.prototype.emit=function(n){if(!this.$events)return!1;var g=this.$events[n];if(!g)return!1;var y=Array.prototype.slice.call(arguments,1);if(typeof g=="function")g.apply(this,y);else{if(!r.util.isArray(g))return!1;for(var i=g.slice(),k=0,$=i.length;k<$;k++)i[k].apply(this,y)}return!0}}(io!==void 0?io:module.exports,io!==void 0?io:module.parent.exports),function(exports,nativeJSON){if(nativeJSON&&nativeJSON.parse)return exports.JSON={parse:nativeJSON.parse,stringify:nativeJSON.stringify};var JSON=exports.JSON={};function f(t){return t<10?"0"+t:t}function date(t,r){return isFinite(t.valueOf())?t.getUTCFullYear()+"-"+f(t.getUTCMonth()+1)+"-"+f(t.getUTCDate())+"T"+f(t.getUTCHours())+":"+f(t.getUTCMinutes())+":"+f(t.getUTCSeconds())+"Z":null}var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;function quote(t){return escapable.lastIndex=0,escapable.test(t)?'"'+t.replace(escapable,function(r){var e=meta[r];return typeof e=="string"?e:"\\u"+("0000"+r.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+t+'"'}function str(t,r){var e,n,g,y,i,k=gap,$=r[t];switch($ instanceof Date&&($=date(t)),typeof rep=="function"&&($=rep.call(r,t,$)),typeof $){case"string":return quote($);case"number":return isFinite($)?String($):"null";case"boolean":case"null":return String($);case"object":if(!$)return"null";if(gap+=indent,i=[],Object.prototype.toString.apply($)==="[object Array]"){for(y=$.length,e=0;e<y;e+=1)i[e]=str(e,$)||"null";return g=i.length===0?"[]":gap?`[
`+gap+i.join(`,
`+gap)+`
`+k+"]":"["+i.join(",")+"]",gap=k,g}if(rep&&typeof rep=="object")for(y=rep.length,e=0;e<y;e+=1)typeof rep[e]=="string"&&(g=str(n=rep[e],$))&&i.push(quote(n)+(gap?": ":":")+g);else for(n in $)Object.prototype.hasOwnProperty.call($,n)&&(g=str(n,$))&&i.push(quote(n)+(gap?": ":":")+g);return g=i.length===0?"{}":gap?`{
`+gap+i.join(`,
`+gap)+`
`+k+"}":"{"+i.join(",")+"}",gap=k,g}}JSON.stringify=function(t,r,e){var n;if(gap="",indent="",typeof e=="number")for(n=0;n<e;n+=1)indent+=" ";else typeof e=="string"&&(indent=e);if(rep=r,r&&typeof r!="function"&&(typeof r!="object"||typeof r.length!="number"))throw new Error("socket.io:: replacer cannot JSON.stringify");return str("",{"":t})},JSON.parse=function(text,reviver){var j;function walk(t,r){var e,n,g=t[r];if(g&&typeof g=="object")for(e in g)Object.prototype.hasOwnProperty.call(g,e)&&((n=walk(g,e))!==void 0?g[e]=n:delete g[e]);return reviver.call(t,r,g)}if(text=String(text),cx.lastIndex=0,cx.test(text)&&(text=text.replace(cx,function(t){return"\\u"+("0000"+t.charCodeAt(0).toString(16)).slice(-4)})),/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return j=eval("("+text+")"),typeof reviver=="function"?walk({"":j},""):j;throw new SyntaxError("socket.io:: reviver cannot JSON.parse")}}(io!==void 0?io:module.exports,typeof JSON<"u"?JSON:void 0),function(t,r){var e=t.parser={},n=e.packets=["disconnect","connect","heartbeat","message","json","event","ack","error","noop"],g=e.reasons=["transport not supported","client not handshaken","unauthorized"],y=e.advice=["reconnect"],i=r.JSON,k=r.util.indexOf;e.encodePacket=function(L){var V=k(n,L.type),z=L.id||"",re=L.endpoint||"",ie=L.ack,ue=null;switch(L.type){case"error":var le=L.reason?k(g,L.reason):"",oe=L.advice?k(y,L.advice):"";le===""&&oe===""||(ue=le+(oe!==""?"+"+oe:""));break;case"message":L.data!==""&&(ue=L.data);break;case"event":var ae={name:L.name};L.args&&L.args.length&&(ae.args=L.args),ue=i.stringify(ae);break;case"json":ue=i.stringify(L.data);break;case"connect":L.qs&&(ue=L.qs);break;case"ack":ue=L.ackId+(L.args&&L.args.length?"+"+i.stringify(L.args):"")}var qe=[V,z+(ie=="data"?"+":""),re];return ue!=null&&qe.push(ue),qe.join(":")},e.encodePayload=function(L){var V="";if(L.length==1)return L[0];for(var z=0,re=L.length;z<re;z++)V+="�"+L[z].length+"�"+L[z];return V};var $=/([^:]+):([0-9]+)?(\+)?:([^:]+)?:?([\s\S]*)?/;e.decodePacket=function(L){if(!(re=L.match($)))return{};var V=re[2]||"",z=(L=re[5]||"",{type:n[re[1]],endpoint:re[4]||""});switch(V&&(z.id=V,re[3]?z.ack="data":z.ack=!0),z.type){case"error":var re=L.split("+");z.reason=g[re[0]]||"",z.advice=y[re[1]]||"";break;case"message":z.data=L||"";break;case"event":try{var ie=i.parse(L);z.name=ie.name,z.args=ie.args}catch{}z.args=z.args||[];break;case"json":try{z.data=i.parse(L)}catch{}break;case"connect":z.qs=L||"";break;case"ack":if((re=L.match(/^([0-9]+)(\+)?(.*)/))&&(z.ackId=re[1],z.args=[],re[3]))try{z.args=re[3]?i.parse(re[3]):[]}catch{}}return z},e.decodePayload=function(L){var V=function(oe,ae){for(var qe=0,de=oe;de<ae.length;de++){if(ae.charAt(de)=="�")return qe;qe++}return qe};if(L.charAt(0)=="�"){for(var z=[],re=1,ie="";re<L.length;re++)if(L.charAt(re)=="�"){var ue=L.substr(re+1).substr(0,ie);if(L.charAt(re+1+Number(ie))!="�"&&re+1+Number(ie)!=L.length){var le=Number(ie);l=V(re+le+1,L),ue=L.substr(re+1).substr(0,le+l),re+=l}z.push(e.decodePacket(ue)),re+=Number(ie)+1,ie=""}else ie+=L.charAt(re);return z}return[e.decodePacket(L)]}}(io!==void 0?io:module.exports,io!==void 0?io:module.parent.exports),function(t,r){function e(n,g){this.socket=n,this.sessid=g}t.Transport=e,r.util.mixin(e,r.EventEmitter),e.prototype.heartbeats=function(){return!0},e.prototype.onData=function(n){if(this!==this.socket.transport)return this;if(this.clearCloseTimeout(),(this.socket.connected||this.socket.connecting||this.socket.reconnecting)&&this.setCloseTimeout(),n!==""){var g=r.parser.decodePayload(n);if(g&&g.length)for(var y=0,i=g.length;y<i;y++)this.onPacket(g[y])}return this},e.prototype.onPacket=function(n){return this.socket.setHeartbeatTimeout(),n.type=="heartbeat"?this.onHeartbeat():(n.type=="connect"&&n.endpoint==""&&this.onConnect(),n.type=="error"&&n.advice=="reconnect"&&(this.isOpen=!1),this.socket.onPacket(n),this)},e.prototype.setCloseTimeout=function(){if(!this.closeTimeout){var n=this;this.closeTimeout=setTimeout(function(){n.socket&&n.socket.publish("info","socket disconnected by setCloseTimeout"),n.onDisconnect()},this.socket.closeTimeout)}},e.prototype.onDisconnect=function(){return this.isOpen&&this.close(),this.clearTimeouts(),this.socket?(this.socket.transport===this?this.socket.onDisconnect():this.socket.setBuffer(!1),this):this},e.prototype.onConnect=function(){return this.socket.onConnect(),this},e.prototype.clearCloseTimeout=function(){this.closeTimeout&&(clearTimeout(this.closeTimeout),this.closeTimeout=null)},e.prototype.clearTimeouts=function(){this.clearCloseTimeout(),this.reopenTimeout&&clearTimeout(this.reopenTimeout)},e.prototype.packet=function(n){this.send(r.parser.encodePacket(n))},e.prototype.onHeartbeat=function(n){this.packet({type:"heartbeat"})},e.prototype.onOpen=function(){this.isOpen=!0,this.clearCloseTimeout(),this.socket.onOpen()},e.prototype.onClose=function(){this.socket.publish("info","transport onClose"),this.isOpen=!1,this.socket.transport===this?this.socket.onClose():this.socket.setBuffer(!1),this.onDisconnect(),this.onDisconnectDone instanceof Function&&this.onDisconnectDone(null),this.onConnectionOver instanceof Function&&this.onConnectionOver(null)},e.prototype.onDisconnectDone=function(){},e.prototype.onConnectionOver=function(){},e.prototype.prepareUrl=function(){var n=this.socket.options;return this.scheme()+"://"+n.host+":"+n.port+"/"+n.resource+"/"+r.protocol+"/"+this.name+"/"+this.sessid},e.prototype.ready=function(n,g){g.call(this)}}(io!==void 0?io:module.exports,io!==void 0?io:module.parent.exports),function(t,r,e){function n(y){if(this.options={port:80,secure:!1,document:"document"in e&&document,resource:"socket.io",transports:y.transports||r.transports,"connect timeout":1e4,"try multiple transports":!0,reconnect:!0,"reconnection delay":500,"reconnection limit":1/0,"reopen delay":3e3,"max reconnection attempts":10,"sync disconnect on unload":!1,"auto connect":!0,"flash policy port":10843,needToXHR:!0,manualFlush:!1},r.util.merge(this.options,y),this.connected=!1,this.open=!1,this.connecting=!1,this.reconnecting=!1,this.namespaces={},this.buffer=[],this.doBuffer=!1,this.options["sync disconnect on unload"]&&(!this.isXDomain()||r.util.ua.hasCORS)){var i=this;r.util.on(e,"beforeunload",function(){i.disconnectSync()},!1)}this.options["auto connect"]&&this.connect()}function g(){}t.Socket=n,r.util.mixin(n,r.EventEmitter),n.prototype.of=function(y){return this.namespaces[y]||(this.namespaces[y]=new r.SocketNamespace(this,y),y!==""&&this.namespaces[y].packet({type:"connect"})),this.namespaces[y]},n.prototype.publish=function(){var y;for(var i in this.emit.apply(this,arguments),this.namespaces)this.namespaces.hasOwnProperty(i)&&(y=this.of(i)).$emit.apply(y,arguments)},n.prototype.guid=function(){var y=root.crypto||root.msCrypto;if(y){var i=new Uint8Array(16);y.getRandomValues(i),i[6]&=15,i[6]|=64,i[8]&=63,i[8]|=128;for(var k="",$=0;$<i.length;$++){var L=i[$].toString(16);L.length===1&&(L="0"+L),k+=L}return k.substring(0,8)+"-"+k.substring(8,12)+"-"+k.substring(12,16)+"-"+k.substring(16,20)+"-"+k.substring(20)}},n.prototype.handshake=function(y){var i=this,k=this.options;if(!this.options.needToXHR&&this.options.transports.length===1&&this.options.transports[0]==="websocket"){var $=this.guid();if($)return void setTimeout(function(){i.publish("info","xhr, skip and get:"+$),y.apply(null,[$,"90","60","websocket"])},0)}function L(ue){ue instanceof Error?(i.connecting=!1,i.publish("info","xhr, status:200, but got error:",ue),i.onError("xhr, status:200, but got error:"+ue.message,ue)):y.apply(null,ue.split(":"))}var V=["http"+(k.secure?"s":"")+":/",k.host+":"+k.port,k.resource,r.protocol,r.util.query(this.options.query,"t="+ +new Date)].join("/");if(this.isXDomain()&&!r.util.ua.hasCORS&&typeof document<"u"&&document){var z=document.getElementsByTagName("script")[0],re=document.createElement("script");re.src=V+"&jsonp="+r.j.length,re.onreadystatechange=function(){this.readyState=="loaded"&&re.parentNode&&(re.parentNode.removeChild(re),i.connecting=!1,i.publish("info","xhr, jsonp:Server down or port not open"),!i.reconnecting&&i.onError("Server down or port not open",new Error("xhr, jsonp:server down or port not open")),i.publish("handshake_failed"))},z.parentNode.insertBefore(re,z),r.j.push(function(ue){L(ue),re.parentNode.removeChild(re)})}else{var ie=r.util.request();ie.open("GET",V,!0),ie.timeout=8e3,this.isXDomain()&&(ie.withCredentials=!0),ie.onreadystatechange=function(){i.publish("info","xhr, readyState:"+ie.readyState+" status:"+ie.status),ie.readyState==4&&(i.publish("info","xhr, responseText:"+ie.responseText),ie.onreadystatechange=g,ie.status==200?L(ie.responseText):ie.status==403?(i.connecting=!1,i.onError(ie.responseText,new Error("xhr, status:403"+ie.responseText)),i.publish("handshake_failed")):(i.connecting=!1,!i.reconnecting&&i.onError(ie.responseText,new Error("xhr, status:"+ie.status+" "+ie.responseText)),i.publish("handshake_failed")))},ie.ontimeout=function(ue){i.publish("info","xhr, timeout"),i.connecting=!1,!i.reconnecting&&i.onError(ie.responseText,new Error("xhr, timeout")),i.publish("handshake_failed")},ie.send(null)}},n.prototype.connect=function(y){if(this.connecting)return this;var i=this;return i.connecting=!0,this.handshake(function(k,$,L,V){i.publish("info","SocketIO handshake parameter: sid: "+k+", transports: "+V+", close: "+L+", heartbeat: "+$),i.sessionid=k,i.closeTimeout=1e3*L,i.heartbeatTimeout=1e3*$,i.transports||(i.transports=i.origTransports=V?r.util.intersect(V.split(","),i.options.transports):i.options.transports),i.setHeartbeatTimeout(),i.once("connect",function(){i.publish("info","tcp, clear connect timeout due to recv connect event"),clearTimeout(i.connectTimeoutTimer),i.connectTimeoutTimer=null,y&&typeof y=="function"&&y()}),i.doConnect()}),this},n.prototype.doConnect=function(){var y=this;if(y.transport&&y.transport.clearTimeouts(),y.transport=y.getTransport(y.transports),!y.transport)return y.publish("connect_failed");y.transport.ready(y,function(){y.connecting=!0,y.publish("info","tcp, connecting, transport ready in "+y.transport.name),y.publish("connecting",y.transport.name),y.transport.open(),y.options["connect timeout"]&&(y.connectTimeoutTimer&&clearTimeout(y.connectTimeoutTimer),y.publish("info","set new connect timeout"),y.connectTimeoutTimer=setTimeout(function(){y.publish("info","trigger connect timeout due to setTimeout"),y.transport.close(),y.tryNextTransport()},y.options["connect timeout"]))})},n.prototype.getTransport=function(y){const i=this;for(var k,$=y||this.transports,L=0;k=$[L];L++)if(i.publish("info","check transport: "+k),r.Transport[k]&&r.Transport[k].check(this)&&(!this.isXDomain()||r.Transport[k].xdomainCheck(this)))return i.publish("info","use transport: "+k),new r.Transport[k](this,this.sessionid);return null},n.prototype.tryNextTransport=function(){if(!this.connected&&(this.connecting=!1,this.options["try multiple transports"])){for(var y=this.transports;y.length>0&&y.splice(0,1)[0]!=this.transport.name;);y.length?this.doConnect():this.publish("connect_failed")}},n.prototype.setHeartbeatTimeout=function(){if(clearTimeout(this.heartbeatTimeoutTimer),!this.transport||this.transport.heartbeats()){var y=this;this.heartbeatTimeoutTimer=setTimeout(function(){y.transport&&(y.publish("info","transport closed by setHeartbeatTimeout"),y.transport.onClose())},this.heartbeatTimeout)}},n.prototype.packet=function(y){return this.connected&&!this.doBuffer?this.transport.packet(y):this.buffer.push(y),this},n.prototype.setBuffer=function(y){this.doBuffer=y,!y&&this.connected&&this.buffer.length&&(this.options.manualFlush||this.flushBuffer())},n.prototype.flushBuffer=function(){this.transport.payload(this.buffer),this.buffer=[]},n.prototype.disconnect=function(){return(this.connected||this.connecting)&&(this.open&&this.of("").packet({type:"disconnect"}),this.publish("info","socket disconnected by IM SDK"),this.onDisconnect("booted")),this},n.prototype.disconnectSync=function(){var y=r.util.request(),i=["http"+(this.options.secure?"s":"")+":/",this.options.host+":"+this.options.port,this.options.resource,r.protocol,"",this.sessionid].join("/")+"/?disconnect=1";y.open("GET",i,!1),y.send(null),this.publish("info","socket disconnected by disconnectSync before page unload"),this.onDisconnect("booted")},n.prototype.isXDomain=function(){var y=e&&e.location||{},i=y.port||(y.protocol=="https:"?443:80);return this.options.host!==y.hostname||this.options.port!=i},n.prototype.onConnect=function(){this.connected||(this.connected=!0,this.connecting=!1,this.doBuffer||this.setBuffer(!1),this.emit("connect"))},n.prototype.onOpen=function(){this.publish("info","tcp, websocket onOpen"),this.open=!0},n.prototype.onClose=function(){this.publish("info","tcp, websocket onClose"),this.open=!1,clearTimeout(this.heartbeatTimeoutTimer)},n.prototype.onPacket=function(y){this.of(y.endpoint).onPacket(y)},n.prototype.onError=function(y,i){y&&y.advice&&y.advice==="reconnect"&&(this.connected||this.connecting)&&(this.disconnect(),this.options.reconnect&&this.reconnect()),this.publish("error",y&&y.reason?y.reason:y,i)},n.prototype.onDisconnect=function(y){var i=this.connected,k=this.connecting;this.publish("info",y?"tcp, onDisconnect reason:"+y:"tcp, onDisconnect"),this.connected=!1,this.connecting=!1,this.open=!1,(i||k)&&this.transport&&(this.transport.close(),this.transport.clearTimeouts(),i&&(this.publish("disconnect",y),y!="booted"&&this.options.reconnect&&!this.reconnecting&&this.reconnect()),k&&(this.connectTimeoutTimer&&(this.publish("info","clear connect timeout due to onDisconnect"),clearTimeout(this.connectTimeoutTimer)),this.tryNextTransport()))},n.prototype.reconnect=function(){this.reconnecting=!0,this.reconnectionAttempts=0,this.reconnectionDelay=this.options["reconnection delay"];var y=this,i=this.options["max reconnection attempts"],k=this.options["try multiple transports"],$=this.options["reconnection limit"];function L(){if(y.connected){for(var z in y.namespaces)y.namespaces.hasOwnProperty(z)&&z!==""&&y.namespaces[z].packet({type:"connect"});y.publish("reconnect",y.transport.name,y.reconnectionAttempts)}clearTimeout(y.reconnectionTimer),y.removeListener("connect_failed",V),y.removeListener("connect",V),y.reconnecting=!1,delete y.reconnectionAttempts,delete y.reconnectionDelay,delete y.reconnectionTimer,delete y.redoTransports,y.options["try multiple transports"]=k}function V(){if(y.reconnecting)return y.connected?L():y.connecting&&y.reconnecting?y.reconnectionTimer=setTimeout(V,1e3):void(y.reconnectionAttempts++>=i?y.redoTransports?(y.publish("reconnect_failed"),L()):(y.on("connect_failed",V),y.options["try multiple transports"]=!0,y.transports=y.origTransports,y.transport=y.getTransport(),y.redoTransports=!0,y.connect()):(y.reconnectionDelay<$&&(y.reconnectionDelay*=2),y.connect(),y.publish("reconnecting",y.reconnectionDelay,y.reconnectionAttempts),y.reconnectionTimer=setTimeout(V,y.reconnectionDelay)))}this.options["try multiple transports"]=!1,this.reconnectionTimer=setTimeout(V,this.reconnectionDelay),this.on("connect",V)}}(io!==void 0?io:module.exports,io!==void 0?io:module.parent.exports,root),function(t,r){function e(g,y){this.socket=g,this.name=y||"",this.flags={},this.json=new n(this,"json"),this.ackPackets=0,this.acks={}}function n(g,y){this.namespace=g,this.name=y}t.SocketNamespace=e,r.util.mixin(e,r.EventEmitter),e.prototype.$emit=r.EventEmitter.prototype.emit,e.prototype.of=function(){return this.socket.of.apply(this.socket,arguments)},e.prototype.packet=function(g){return g.endpoint=this.name,this.socket.packet(g),this.flags={},this},e.prototype.send=function(g,y){var i={type:this.flags.json?"json":"message",data:g};return typeof y=="function"&&(i.id=++this.ackPackets,i.ack=!0,this.acks[i.id]=y),this.packet(i)},e.prototype.emit=function(g){var y=Array.prototype.slice.call(arguments,1),i=y[y.length-1],k={type:"event",name:g};return typeof i=="function"&&(k.id=++this.ackPackets,k.ack="data",this.acks[k.id]=i,y=y.slice(0,y.length-1)),k.args=y,this.packet(k)},e.prototype.disconnect=function(){return this.name===""?this.socket.disconnect():(this.packet({type:"disconnect"}),this.$emit("disconnect")),this},e.prototype.onPacket=function(g){var y=this;function i(){y.packet({type:"ack",args:r.util.toArray(arguments),ackId:g.id})}switch(g.type){case"connect":this.$emit("connect");break;case"disconnect":this.name===""?(this.socket.publish("info","socket disconnected by SocketNameSpace.onPacket"),this.socket.onDisconnect(g.reason||"booted")):this.$emit("disconnect",g.reason);break;case"message":case"json":var k=["message",g.data];g.ack=="data"?k.push(i):g.ack&&this.packet({type:"ack",ackId:g.id}),this.$emit.apply(this,k);break;case"event":k=[g.name].concat(g.args),g.ack=="data"&&k.push(i),this.$emit.apply(this,k);break;case"ack":this.acks[g.ackId]&&(this.acks[g.ackId].apply(this,g.args),delete this.acks[g.ackId]);break;case"error":this.socket.publish("info","packet, type:error",g),g.advice?this.socket.onError(g,new Error("packet, type:error and advice is "+g.advice)):g.reason==="unauthorized"?this.$emit("connect_failed",g.reason):this.$emit("error",g.reason,new Error("packet, type:error and reason is "+g.reason))}},n.prototype.send=function(){this.namespace.flags[this.name]=!0,this.namespace.send.apply(this.namespace,arguments)},n.prototype.emit=function(){this.namespace.flags[this.name]=!0,this.namespace.emit.apply(this.namespace,arguments)}}(io!==void 0?io:module.exports,io!==void 0?io:module.parent.exports),function(t,r,e){function n(g){r.Transport.apply(this,arguments)}t.websocket=n,r.util.inherit(n,r.Transport),n.prototype.name="websocket",n.prototype.open=function(){var g,y=r.util.query(this.socket.options.query),i=this;return g||(g=e.MozWebSocket||e.WebSocket),this.websocket=new g(this.prepareUrl()+y),this.websocket.onopen=function(){i.onOpen(),i.socket.setBuffer(!1)},this.websocket.onmessage=function(k){i.onData(k.data)},this.websocket.onclose=function(k){i.socket.setBuffer(!0),i.socket.publish("websocketOnclose",k),i.onClose()},this.websocket.onerror=function(k){var $="";k&&k.message?$=k.message:k.target&&($=k.target.readyState?"websocket, readyState:"+k.target.readyState:"websocket event"),i.onError($,k)},this},r.util.ua.iDevice?n.prototype.send=function(g){var y=this;return setTimeout(function(){y.websocket.send(g)},0),this}:n.prototype.send=function(g){return this.websocket.send(g),this},n.prototype.payload=function(g){for(var y=0,i=g.length;y<i;y++)this.packet(g[y]);return this},n.prototype.close=function(){return this.websocket.close(),this},n.prototype.onError=function(g,y){this.socket.publish("info","tcp, onError",g,y),this.socket.onError(g,y)},n.prototype.scheme=function(){return this.socket.options.secure?"wss":"ws"},n.check=function(){return"WebSocket"in e&&!("__addTask"in WebSocket)||"MozWebSocket"in e},n.xdomainCheck=function(){return!0},r.transports.push("websocket")}(io!==void 0?io.Transport:module.exports,io!==void 0?io:module.parent.exports,root),function(t,r,e){function n(y){y&&(r.Transport.apply(this,arguments),this.sendBuffer=[])}function g(){}t.XHR=n,r.util.inherit(n,r.Transport),n.prototype.open=function(){return this.socket.setBuffer(!1),this.onOpen(),this.get(),this.setCloseTimeout(),this},n.prototype.payload=function(y){for(var i=[],k=0,$=y.length;k<$;k++)i.push(r.parser.encodePacket(y[k]));this.send(r.parser.encodePayload(i))},n.prototype.send=function(y){return this.post(y),this},n.prototype.post=function(y){var i=this;this.socket.setBuffer(!0),this.sendXHR=this.request("POST"),e.XDomainRequest&&this.sendXHR instanceof XDomainRequest?this.sendXHR.onload=this.sendXHR.onerror=function(){this.onload=g,i.socket.setBuffer(!1)}:this.sendXHR.onreadystatechange=function(){this.readyState==4&&(this.onreadystatechange=g,i.posting=!1,this.status==200?i.socket.setBuffer(!1):i.onClose())},this.sendXHR.send(y)},n.prototype.close=function(){return this.onClose(),this},n.prototype.request=function(y){var i=r.util.request(this.socket.isXDomain()),k=r.util.query(this.socket.options.query,"t="+ +new Date);if(i.open(y||"GET",this.prepareUrl()+k,!0),y=="POST")try{i.setRequestHeader?i.setRequestHeader("Content-type","text/plain;charset=UTF-8"):i.contentType="text/plain"}catch{}return i},n.prototype.scheme=function(){return this.socket.options.secure?"https":"http"},n.check=function(y,i){try{var k=r.util.request(i),$=e.XDomainRequest&&k instanceof XDomainRequest,L=y&&y.options&&y.options.secure?"https:":"http:",V=e.location&&L!=e.location.protocol;if(k&&(!$||!V))return!0}catch{}return!1},n.xdomainCheck=function(y){return n.check(y,!0)}}(io!==void 0?io.Transport:module.exports,io!==void 0?io:module.parent.exports,root),function(t,r,e){function n(){r.Transport.XHR.apply(this,arguments)}function g(){}t["xhr-polling"]=n,r.util.inherit(n,r.Transport.XHR),r.util.merge(n,r.Transport.XHR),n.prototype.name="xhr-polling",n.prototype.heartbeats=function(){return!1},n.prototype.open=function(){return r.Transport.XHR.prototype.open.call(this),!1},n.prototype.get=function(){if(this.isOpen){var y=this;this.xhr=this.request(),e.XDomainRequest&&this.xhr instanceof XDomainRequest?(this.xhr.onload=function(){this.onload=g,this.onerror=g,y.retryCounter=1,y.onData(this.responseText),y.get()},this.xhr.onerror=function(){y.retryCounter++,!y.retryCounter||y.retryCounter>3?y.onClose():y.get()}):this.xhr.onreadystatechange=function(){this.readyState==4&&(this.onreadystatechange=g,this.status==200?(y.onData(this.responseText),y.get()):y.onClose())},this.xhr.send(null)}},n.prototype.onClose=function(){if(r.Transport.XHR.prototype.onClose.call(this),this.xhr){this.xhr.onreadystatechange=this.xhr.onload=this.xhr.onerror=g;try{this.xhr.abort()}catch{}this.xhr=null}},n.prototype.ready=function(y,i){var k=this;r.util.defer(function(){i.call(k)})},r.transports.push("xhr-polling")}(io!==void 0?io.Transport:module.exports,io!==void 0?io:module.parent.exports,root),__WEBPACK_AMD_DEFINE_ARRAY__=[],__WEBPACK_AMD_DEFINE_RESULT__=(function(){return io}).apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__),__WEBPACK_AMD_DEFINE_RESULT__===void 0||(module.exports=__WEBPACK_AMD_DEFINE_RESULT__)}()}).call(this,__webpack_require__(73),__webpack_require__(147)(module))},function(t,r){t.exports=function(e){var n=-1,g=Array(e.size);return e.forEach(function(y){g[++n]=y}),g}},function(t,r,e){var n,g=e(26),y=e(45),i=e(11),k=e(64),$=e(690),L=e(697),V=e(196),z=V.getLibEnv,re=V.getHostEnv,ie=V.getHostEnvVer,ue={initReporter:function(){var le=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},oe={app_key:le.appKey,platform:"Web",dev_id:y.deviceId,sdk_ver:i.info.version,env:"online",os_name:k.os?k.os.family:"",os_ver:k.os?k.os.version:"",lib_env:z(),host_env:re(),host_env_ver:ie(),manufactor:k.name,model:ie()};i.isBrowser||(le.isDataReportEnable=!1);var ae=new $({isDataReportEnable:le.isDataReportEnable,reportConfigUrl:le.reportConfigUrl,reportUrl:le.reportUrl,common:oe,request:L,logger:le.logger,autoStart:i.isBrowser});return ae}};ue.sendBeacon=navigator&&navigator.sendBeacon&&g(n=navigator.sendBeacon).call(n,navigator)||function(le,oe){var ae=new XMLHttpRequest;ae.open("POST",le,!0),ae.send(oe)},t.exports=ue},function(t,r,e){t.exports=e(691)},function(t,r,e){var n=e(1),g=e(14);n({global:!0,forced:g.globalThis!==g},{globalThis:g})},function(t,r,e){var n=e(1),g=e(12),y=e(114),i=e(28),k=e(30),$=e(39).f,L=e(134),V=e(168),z=e(708),re=e(130),ie=e(710),ue=!1,le=re("meta"),oe=0,ae=function(de){$(de,le,{value:{objectID:"O"+oe++,weakData:{}}})},qe=t.exports={enable:function(){qe.enable=function(){},ue=!0;var de=L.f,Ne=g([].splice),ze={};ze[le]=1,de(ze).length&&(L.f=function($e){for(var Lt=de($e),jt=0,Et=Lt.length;jt<Et;jt++)if(Lt[jt]===le){Ne(Lt,jt,1);break}return Lt},n({target:"Object",stat:!0,forced:!0},{getOwnPropertyNames:V.f}))},fastKey:function(de,Ne){if(!i(de))return typeof de=="symbol"?de:(typeof de=="string"?"S":"P")+de;if(!k(de,le)){if(!z(de))return"F";if(!Ne)return"E";ae(de)}return de[le].objectID},getWeakData:function(de,Ne){if(!k(de,le)){if(!z(de))return!0;if(!Ne)return!1;ae(de)}return de[le].weakData},onFreeze:function(de){return ie&&ue&&z(de)&&!k(de,le)&&ae(de),de}};y[le]=!0},function(t,r,e){var n=e(20),g=e(31),y=e(17),i=e(36),k=TypeError;t.exports=function($,L){var V,z=i(this),re=g(z.get),ie=g(z.has),ue=g(z.set),le=arguments.length>2?arguments[2]:void 0;if(!y(L)&&!y(le))throw k("At least one callback required");return n(ie,z,$)?(V=n(re,z,$),y(L)&&(V=L(V),n(ue,z,$,V))):y(le)&&(V=le(),n(ue,z,$,V)),V}},function(t,r,e){t.exports=e(740)},function(t,r,e){var n=e(4);e(45);function g(){}g.typeMap={text:0,image:1,audio:2,video:3,geo:4,notification:5,file:6,tip:10,robot:11,g2:12,custom:100};var y=g.typeReverseMap={0:"text",1:"image",2:"audio",3:"video",4:"geo",5:"notification",6:"file",10:"tip",11:"robot",12:"g2",100:"custom"};g.validTypes=n(g.typeMap),g.setFlow=function(i,k){i.flow=i.from===k?i.to===k?"in":"out":"in",i.type==="robot"&&i.content&&i.content.msgOut&&(i.flow="in")},g.getType=function(i){var k=i.type;return y[k]||k},t.exports=g},function(t,r,e){t.exports=function(n,g,y,i){var k=self||window;try{try{var $;try{$=new k.Blob([n])}catch{($=new(k.BlobBuilder||k.WebKitBlobBuilder||k.MozBlobBuilder||k.MSBlobBuilder)).append(n),$=$.getBlob()}var L=k.URL||k.webkitURL,V=L.createObjectURL($),z=new k[g](V,y);return L.revokeObjectURL(V),z}catch{return new k[g]("data:application/javascript,".concat(encodeURIComponent(n)),y)}}catch{if(!i)throw Error("Inline worker is not supported");return new k[g](i,y)}}},function(t,r,e){e(11).isBrowser=!0},function(t,r,e){var n=e(372);t.exports=n},function(t,r,e){var n=e(471);t.exports=n},function(t,r){var e=/^(?:0|[1-9]\d*)$/;t.exports=function(n,g){var y=typeof n;return!!(g=g??9007199254740991)&&(y=="number"||y!="symbol"&&e.test(n))&&n>-1&&n%1==0&&n<g}},function(t,r,e){t.exports=e(559)},function(t,r,e){(function(n){var g,y=e(22),i=e(3),k=e(126),$=e(15),L=e(32),V=e(2),z=e(43),re=e(6),ie=e(4),ue=e(16);(function(le,oe){var ae,qe=(le=le!==void 0?le:typeof self<"u"?self:n!==void 0?n:{}).IDBKeyRange||le.webkitIDBKeyRange,de="readonly",Ne="readwrite",ze=Object.prototype.hasOwnProperty,$e=function(){if(!ae&&!(ae=le.indexedDB||le.webkitIndexedDB||le.mozIndexedDB||le.oIndexedDB||le.msIndexedDB||(le.indexedDB===null&&le.shimIndexedDB?le.shimIndexedDB:void 0)))throw"IndexedDB required";return ae},Lt=!1,jt=navigator&&!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent),Et=function(Sr){return Sr},ir=function(Sr){var Er;return $(Er=Object.prototype.toString.call(Sr)).call(Er,8,-1).toLowerCase()},dr=function(Sr){return typeof Sr=="function"},Dt=function(Sr){return ir(Sr)==="number"},lr=function(Sr){return ir(Sr)==="array"},sr=function(Sr){return Sr===void 0},er=function(Sr,Er){var Pr=this,Cr=!1;this.name=Er,this.getIndexedDB=function(){return Sr},this.add=function(Ir){if(Cr)throw"Database has been closed";for(var xr=[],vr=0,_r=0;_r<arguments.length-1;_r++)if(L(arguments[_r+1]))for(var Or=0;Or<arguments[_r+1].length;Or++)xr[vr]=arguments[_r+1][Or],vr++;else xr[vr]=arguments[_r+1],vr++;var Mr=Sr.transaction(Ir,Ne),yr=Mr.objectStore(Ir);return new i(function(mr,Tr){V(xr).call(xr,function(Br){var $r;if(Br.item&&Br.key){var Lr=Br.key;Br=Br.item,$r=yr.add(Br,Lr)}else $r=yr.add(Br);$r.onsuccess=function(Gr){var qr=Gr.target,Yr=qr.source.keyPath;Yr===null&&(Yr="__id__"),z(Br,Yr,{value:qr.result,enumerable:!0})}}),Mr.oncomplete=function(){mr(xr,Pr)},Mr.onerror=function(Br){Br.preventDefault(),Tr(Br)},Mr.onabort=function(Br){Tr(Br)}})},this.updateAndDelete=function(Ir,xr,vr){if(Cr)throw"Database has been closed";var _r=Sr.transaction(Ir,Ne),Or=_r.objectStore(Ir),Mr=Or.keyPath;return new i(function(yr,mr){V(xr).call(xr,function(Tr){if(Tr.item&&Tr.key){var Br=Tr.key;Tr=Tr.item,Or.put(Tr,Br)}else Or.put(Tr)}),V(vr).call(vr,function(Tr){Or.delete(Tr[Mr])}),_r.oncomplete=function(){yr([xr,vr])},_r.onerror=function(Tr){mr(Tr)}})},this.update=function(Ir){if(Cr)throw"Database has been closed";for(var xr,vr=[],_r=1;_r<arguments.length;_r++)L(xr=arguments[_r])?vr=re(vr).call(vr,xr):vr.push(xr);var Or=Sr.transaction(Ir,Ne),Mr=Or.objectStore(Ir);return Mr.keyPath,new i(function(yr,mr){V(vr).call(vr,function(Tr){var Br;if(Tr.item&&Tr.key){var $r=Tr.key;Tr=Tr.item,Br=Mr.put(Tr,$r)}else Br=Mr.put(Tr);Br.onsuccess=function(Lr){},Br.onerror=function(Lr){}}),Or.oncomplete=function(){yr(vr,Pr)},Or.onerror=function(Tr){mr(Tr)},Or.onabort=function(Tr){mr(Tr)}})},this.remove=function(Ir,xr,vr,_r,Or,Mr,yr){if(Cr)throw"Database has been closed";var mr=Sr.transaction(Ir,Ne),Tr=mr.objectStore(Ir);return new i(function(Br,$r){function Lr(qr){return qr==null}var Gr;Lr(_r)&&(_r=-1/0),Lr(Or)&&(Or=1/0),xr===null||L(xr)||(xr=[xr]),Lr(vr)?xr!==null?V(xr).call(xr,function(qr){Tr.delete(qr)}):Tr.delete(range=qe.bound(_r,Or,Mr,yr)):(Gr=xr!==null?qe.only(xr[0]):qe.bound(_r,Or,Mr,yr),Tr.index(vr).openCursor(Gr).onsuccess=function(qr){var Yr=qr.target.result;Yr&&(Yr.delete(),Yr.continue())}),mr.oncomplete=function(){Br()},mr.onerror=function(qr){$r(qr)},mr.onabort=function(qr){$r(qr)}})},this.clear=function(Ir){if(Cr)throw"Database has been closed";var xr=Sr.transaction(Ir,Ne);return xr.objectStore(Ir).clear(),new i(function(vr,_r){xr.oncomplete=function(){vr()},xr.onerror=function(Or){_r(Or)}})},this.close=function(){Cr||(Sr.close(),Cr=!0,delete hr[Er])},this.get=function(Ir,xr){if(Cr)throw"Database has been closed";var vr=Sr.transaction(Ir),_r=vr.objectStore(Ir).get(xr);return new i(function(Or,Mr){_r.onsuccess=function(yr){Or(yr.target.result)},vr.onerror=function(yr){Mr(yr)}})},this.query=function(Ir,xr){if(Cr)throw"Database has been closed";return new cr(Ir,Sr,xr)},this.count=function(Ir,xr){if(Cr)throw"Database has been closed";Sr.transaction(Ir).objectStore(Ir)};for(var rr=0,kr=Sr.objectStoreNames.length;rr<kr;rr++)(function(Ir){for(var xr in Pr[Ir]={},Pr)ze.call(Pr,xr)&&xr!=="close"&&(Pr[Ir][xr]=function(vr){return function(){var _r,Or=re(_r=[Ir]).call(_r,$([]).call(arguments,0));return Pr[vr].apply(Pr,Or)}}(xr))})(Sr.objectStoreNames[rr])},cr=function(Sr,Er,Pr){var Cr,rr=this,kr=!1,Ir=!1,xr=function(_r,Or,Mr,yr,mr,Tr,Br){return new i(function($r,Lr){var Gr=kr||Ir?Ne:de,qr=Er.transaction(Sr,Gr),Yr=qr.objectStore(Sr),bn=Pr?Yr.index(Pr):Yr,wn=_r?qe[_r].apply(null,Or):null,Xr=[],Vn=[wn],Zr=0;mr=mr||null,Tr=Tr||[],Mr!=="count"&&Vn.push(yr||"next");var Nn=!!kr&&ie(kr);bn[Mr].apply(bn,Vn).onsuccess=function(Qr){var kn=Qr.target.result;if(y(kn)===y(0))Xr=kn;else if(kn){if(mr!==null&&mr[0]>Zr)Zr=mr[0],kn.advance(mr[0]);else if(!(mr!==null&&Zr>=mr[0]+mr[1])){var Dn=!0,xn="value"in kn?kn.value:kn.key;V(Tr).call(Tr,function(An){An&&An.length&&(An.length===2?Dn=Dn&&xn[An[0]]===An[1]:dr(An[0])&&(Dn=Dn&&An[0].apply(void 0,[xn])))}),Dn&&(Zr++,Xr.push(Br(xn)),Ir?kn.delete():kr&&(xn=function(An){for(var vn=0;vn<Nn.length;vn++){var hn=Nn[vn],Yn=kr[hn];Yn instanceof Function&&(Yn=Yn(An)),An[hn]=Yn}return An}(xn),kn.update(xn))),kn.continue()}}},qr.oncomplete=function(){$r(Xr)},qr.onerror=function(Qr){Lr(Qr)},qr.onabort=function(Qr){Lr(Qr)}})},vr=function(_r,Or){var Mr="next",yr="openCursor",mr=[],Tr=null,Br=Et,$r=!1,Lr=function(){return xr(_r,Or,yr,$r?Mr+"unique":Mr,Tr,mr,Br)},Gr=function(){return Mr=null,yr="count",{execute:Lr}},qr=function kn(){return(Tr=lr(arguments[0])?arguments[0]:$(Array.prototype).call(arguments,0,2)).length==1&&Tr.unshift(0),Dt(Tr[1])||(Tr=null),{execute:Lr,count:Gr,keys:Yr,filter:bn,asc:wn,desc:Xr,distinct:Vn,modify:Zr,limit:kn,map:Nn,remove:Qr}},Yr=function kn(Dn){return(Dn=!!sr(Dn)||!!Dn)&&(yr="openKeyCursor"),{execute:Lr,keys:kn,filter:bn,asc:wn,desc:Xr,distinct:Vn,modify:Zr,limit:qr,map:Nn,remove:Qr}},bn=function kn(){return mr.push($(Array.prototype).call(arguments,0,2)),{execute:Lr,count:Gr,keys:Yr,filter:kn,asc:wn,desc:Xr,distinct:Vn,modify:Zr,limit:qr,map:Nn,remove:Qr}},wn=function kn(Dn){return Dn=!!sr(Dn)||!!Dn,Mr=Dn?"next":"prev",{execute:Lr,count:Gr,keys:Yr,filter:bn,asc:kn,desc:Xr,distinct:Vn,modify:Zr,limit:qr,map:Nn,remove:Qr}},Xr=function kn(Dn){return Dn=!!sr(Dn)||!!Dn,Mr=Dn?"prev":"next",{execute:Lr,count:Gr,keys:Yr,filter:bn,asc:wn,desc:kn,distinct:Vn,modify:Zr,limit:qr,map:Nn,remove:Qr}},Vn=function kn(Dn){return Dn=!!sr(Dn)||!!Dn,$r=Dn,{execute:Lr,count:Gr,keys:Yr,filter:bn,asc:wn,desc:Xr,distinct:kn,modify:Zr,limit:qr,map:Nn,remove:Qr}},Zr=function kn(Dn){return kr=Dn,{execute:Lr,count:Gr,keys:Yr,filter:bn,asc:wn,desc:Xr,distinct:Vn,modify:kn,limit:qr,map:Nn,remove:Qr}},Nn=function kn(Dn){return dr(Dn)&&(Br=Dn),{execute:Lr,count:Gr,keys:Yr,filter:bn,asc:wn,desc:Xr,distinct:Vn,modify:Zr,limit:qr,map:kn,remove:Qr}},Qr=function kn(Dn){return Dn=!!sr(Dn)||!!Dn,Ir=Dn,{execute:Lr,count:Gr,keys:Yr,filter:bn,asc:wn,desc:Xr,distinct:Vn,modify:Zr,limit:qr,map:Nn,remove:kn}};return{execute:Lr,count:Gr,keys:Yr,filter:bn,asc:wn,desc:Xr,distinct:Vn,modify:Zr,limit:qr,map:Nn,remove:Qr}};V(Cr="only bound upperBound lowerBound".split(" ")).call(Cr,function(_r){rr[_r]=function(){return new vr(_r,arguments)}}),this.filter=function(){var _r=new vr(null,null);return ue(_r).apply(_r,arguments)},this.all=function(){var _r;return ue(_r=this).call(_r)}},or=function(Sr,Er,Pr,Cr){var rr=Sr.target.result,kr=new er(rr,Er);return hr[Er]=rr,i.resolve(kr)},hr={},pr={version:"0.10.2",open:function(Sr){var Er;return new i(function(Pr,Cr){var rr;hr[Sr.server]?or({target:{result:hr[Sr.server]}},Sr.server,Sr.version,Sr.schema).then(Pr,Cr):(Lt?i.resolve():jt&&$e().databases?new i(function(kr){var Ir=function(){return $e().databases().finally(kr)};rr=k(Ir,100),Ir()}).finally(function(){Lt=!0,clearInterval(rr)}):(Lt=!0,i.resolve())).then(function(){try{Er=$e().open(Sr.server,Sr.version)}catch(kr){Cr(kr)}Er.onsuccess=function(kr){or(kr,Sr.server,Sr.version,Sr.schema).then(Pr,Cr)},Er.onupgradeneeded=function(kr){(function(Ir,xr,vr){for(var _r in typeof xr=="function"&&(xr=xr()),xr){var Or,Mr=xr[_r];for(var yr in Or=!ze.call(xr,_r)||vr.objectStoreNames.contains(_r)?Ir.currentTarget.transaction.objectStore(_r):vr.createObjectStore(_r,Mr.key),Mr.indexes){var mr=Mr.indexes[yr];try{Or.index(yr)}catch{Or.createIndex(yr,mr.key||yr,ie(mr).length?mr:{unique:!1})}}}})(kr,Sr.schema,kr.target.result)},Er.onerror=function(kr){Cr(kr)}})})},remove:function(Sr){return new i(function(Er,Pr){if(!Sr)return Er();var Cr,rr;y(Sr)===er&&(Sr=Sr.name),typeof Sr=="string"&&(Cr=hr[Sr]),Cr&&typeof Cr.close=="function"&&Cr.close();try{rr=$e().deleteDatabase(Sr)}catch(kr){Pr(kr)}rr.onsuccess=function(kr){delete hr[Sr],Er(Sr)},rr.onerror=function(kr){Pr(kr)},rr.onblocked=function(kr){Pr(kr)}})}};t.exports!==void 0?t.exports=pr:(g=(function(){return pr}).call(r,e,r,t))===void 0||(t.exports=g)})(void 0)}).call(this,e(73))},function(t,r,e){var n=e(590);t.exports=n},function(t,r,e){t.exports=e(643)},function(t,r){var e={set:function(n,g,y){e[n]=g,y&&(y.support=g)}};t.exports=e},function(t,r,e){var n=e(4),g=e(2),y=e(26),i=e(0),k=i.notundef,$=i.fillPropertyWithDefault,L=n,V={},z={},re={},ie=[],ue={normal:0,advanced:1},le={manager:0,all:1};V.inviteMode=V.updateCustomMode=V.updateTeamMode=le;var oe={0:"normal",1:"advanced"},ae=V.joinMode={noVerify:0,needVerify:1,rejectAll:2};z.joinMode={0:"noVerify",1:"needVerify",2:"rejectAll"},re.joinMode=L(ae),ie.push("join");var qe=V.beInviteMode={needVerify:0,noVerify:1};function de(ze){var $e;i.verifyOptions(ze,"action","superTeam::SuperTeam"),i.verifyOptions(ze,"teamId","superTeam::SuperTeam"),k(ze.teamId)&&(this.teamId=ze.teamId),k(ze.type)&&(this.type=ue[ze.type]),k(ze.avatar)&&(this.avatar=""+ze.avatar),k(ze.name)&&(this.name=""+ze.name),k(ze.intro)&&(this.intro=""+ze.intro),k(ze.announcement)&&(this.announcement=""+ze.announcement),k(ze.custom)&&(this.custom=""+ze.custom),k(ze.inviteMode)&&(this.inviteMode=le[ze.inviteMode]),k(ze.updateCustomMode)&&(this.updateCustomMode=le[ze.updateCustomMode]),k(ze.updateTeamMode)&&(this.updateTeamMode=le[ze.updateTeamMode]),g(ie).call(ie,y($e=this.setMode).call($e,this,ze))}function Ne(ze,$e){k(ze[$e+="Mode"])&&(ze[$e]=z[$e][ze[$e]])}z.beInviteMode={0:"needVerify",1:"noVerify"},ie.push("beInvite"),z.inviteMode=z.updateCustomMode=z.updateTeamMode={0:"manager",1:"all"},ie.push("invite"),ie.push("updateCustom"),ie.push("updateTeam"),re.inviteMode=re.updateCustomMode=re.updateTeamMode=L(le),re.beInviteMode=L(qe),de.prototype.setMode=function(ze,$e){k(ze[$e+="Mode"])&&(i.verifyParamValid($e,ze[$e],re[$e],"Superteam::Team"),this[$e]=V[$e][ze[$e]])},de.reverse=function(ze,$e){var Lt=i.copy(ze);if(k(Lt.teamId)&&(Lt.teamId=""+Lt.teamId),k(Lt.type)&&(Lt.type=oe[Lt.type]),k(Lt.level)&&(Lt.level=+Lt.level),k(Lt.valid)&&(Lt.valid=+Lt.valid==1),k(Lt.memberNum)&&(Lt.memberNum=+Lt.memberNum),k(Lt.memberUpdateTime)&&(Lt.memberUpdateTime=+Lt.memberUpdateTime),k(Lt.createTime)&&(Lt.createTime=+Lt.createTime),k(Lt.updateTime)&&(Lt.updateTime=+Lt.updateTime),k(Lt.validToCurrentUser)&&(Lt.validToCurrentUser=Lt.validToCurrentUser==="1"),k(Lt.mute)&&(Lt.mute=Lt.mute==="1"),k(Lt.muteType))switch(Lt.muteType){case"0":Lt.mute=!1,Lt.muteType="none";break;case"1":Lt.mute=!0,Lt.muteType="normal";break;case"3":Lt.mute=!0,Lt.muteType="all"}else k(Lt.mute)&&(Lt.mute===1?(Lt.mute=!0,Lt.muteType="normal"):(Lt.mute=!1,Lt.muteType="none"));return g(ie).call(ie,y(Ne).call(Ne,null,Lt)),delete Lt.bits,$e||de.fillProperties(Lt),Lt},de.fillProperties=function(ze){return $(ze,"avatar","")},t.exports=de},function(t,r,e){t.exports=e(666)},function(t,r,e){var n=e(0).notundef;function g(y){n(y.shouldPushNotificationWhenPCOnline)&&(this.open=y.shouldPushNotificationWhenPCOnline?2:1)}g.getDefaultConfig=function(){return{shouldPushNotificationWhenPCOnline:!0}},g.reverse=function(y){return{shouldPushNotificationWhenPCOnline:+y.open!=1}},t.exports=g},function(t,r,e){var n=e(64),g=e(760),y=e(289),i=e(256),k=e(200),$=e(0),L=e(307),V=e(285),z=e(186),re=e(765),ie=e(766);t.exports=function(ue){$.merge(ue,{platform:n,xhr:g,io:y,naturalSort:i,deepAccess:k,util:$,support:L,blob:V,ajax:z,LoggerPlugin:re,usePlugin:ie})}},function(t,r,e){var n=e(9),g=e(10),y=e(4),i=e(108).genPrivateUrl,k=e(0),$=k.notundef,L={"-2":"unset","-1":"restricted",0:"common",1:"owner",2:"manager",3:"guest",4:"anonymous"};function V(z){$(z.nick)&&(this.nick=""+z.nick),$(z.avatar)&&(this.avatar=""+z.avatar),$(z.custom)&&(this.custom=""+z.custom)}V.reverse=function(z){var re=k.copy(z);return $(re.chatroomId)&&(re.chatroomId=""+re.chatroomId),$(re.avatar)&&(re.avatar=i(re.avatar)),$(re.type)&&(re.type=L[re.type]),$(re.level)&&(re.level=+re.level),$(re.online)&&(re.online=+re.online==1),$(re.enterTime)&&(re.enterTime=+re.enterTime),$(re.guest)&&(re.guest=+re.guest==1),$(re.blacked)&&(re.blacked=+re.blacked==1),$(re.gaged)&&(re.gaged=+re.gaged==1),$(re.valid)&&(re.valid=+re.valid==1),$(re.updateTime)&&(re.updateTime=+re.updateTime),$(re.tempMuted)?re.tempMuted=+re.tempMuted==1:re.tempMuted=!1,$(re.tempMuteDuration)?re.tempMuteDuration=+re.tempMuteDuration:re.tempMuteDuration=0,re.online||delete re.enterTime,re.guest&&(re.type="guest",delete re.valid),re.type!=="common"&&delete re.level,delete re.guest,re},V.reverseMembers=function(z){return n(z).call(z,function(re){return g(V).call(V,re)})},V.validTypes=y(L),V.typeReverseMap=L,t.exports=V},function(t,r,e){var n,g,y,i,k,$,L,V,z,re,ie,ue,le,oe,ae,qe,de,Ne,ze;t.exports=(n=e(94),e(769),void(n.lib.Cipher||(g=n,y=g.lib,i=y.Base,k=y.WordArray,$=y.BufferedBlockAlgorithm,L=g.enc,L.Utf8,V=L.Base64,z=g.algo.EvpKDF,re=y.Cipher=$.extend({cfg:i.extend(),createEncryptor:function($e,Lt){return this.create(this._ENC_XFORM_MODE,$e,Lt)},createDecryptor:function($e,Lt){return this.create(this._DEC_XFORM_MODE,$e,Lt)},init:function($e,Lt,jt){this.cfg=this.cfg.extend(jt),this._xformMode=$e,this._key=Lt,this.reset()},reset:function(){$.reset.call(this),this._doReset()},process:function($e){return this._append($e),this._process()},finalize:function($e){return $e&&this._append($e),this._doFinalize()},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(){function $e(Lt){return typeof Lt=="string"?ze:de}return function(Lt){return{encrypt:function(jt,Et,ir){return $e(Et).encrypt(Lt,jt,Et,ir)},decrypt:function(jt,Et,ir){return $e(Et).decrypt(Lt,jt,Et,ir)}}}}()}),y.StreamCipher=re.extend({_doFinalize:function(){return this._process(!0)},blockSize:1}),ie=g.mode={},ue=y.BlockCipherMode=i.extend({createEncryptor:function($e,Lt){return this.Encryptor.create($e,Lt)},createDecryptor:function($e,Lt){return this.Decryptor.create($e,Lt)},init:function($e,Lt){this._cipher=$e,this._iv=Lt}}),le=ie.CBC=function(){var $e=ue.extend();function Lt(jt,Et,ir){var dr,Dt=this._iv;Dt?(dr=Dt,this._iv=void 0):dr=this._prevBlock;for(var lr=0;lr<ir;lr++)jt[Et+lr]^=dr[lr]}return $e.Encryptor=$e.extend({processBlock:function(jt,Et){var ir=this._cipher,dr=ir.blockSize;Lt.call(this,jt,Et,dr),ir.encryptBlock(jt,Et),this._prevBlock=jt.slice(Et,Et+dr)}}),$e.Decryptor=$e.extend({processBlock:function(jt,Et){var ir=this._cipher,dr=ir.blockSize,Dt=jt.slice(Et,Et+dr);ir.decryptBlock(jt,Et),Lt.call(this,jt,Et,dr),this._prevBlock=Dt}}),$e}(),oe=(g.pad={}).Pkcs7={pad:function($e,Lt){for(var jt=4*Lt,Et=jt-$e.sigBytes%jt,ir=Et<<24|Et<<16|Et<<8|Et,dr=[],Dt=0;Dt<Et;Dt+=4)dr.push(ir);var lr=k.create(dr,Et);$e.concat(lr)},unpad:function($e){var Lt=255&$e.words[$e.sigBytes-1>>>2];$e.sigBytes-=Lt}},y.BlockCipher=re.extend({cfg:re.cfg.extend({mode:le,padding:oe}),reset:function(){var $e;re.reset.call(this);var Lt=this.cfg,jt=Lt.iv,Et=Lt.mode;this._xformMode==this._ENC_XFORM_MODE?$e=Et.createEncryptor:($e=Et.createDecryptor,this._minBufferSize=1),this._mode&&this._mode.__creator==$e?this._mode.init(this,jt&&jt.words):(this._mode=$e.call(Et,this,jt&&jt.words),this._mode.__creator=$e)},_doProcessBlock:function($e,Lt){this._mode.processBlock($e,Lt)},_doFinalize:function(){var $e,Lt=this.cfg.padding;return this._xformMode==this._ENC_XFORM_MODE?(Lt.pad(this._data,this.blockSize),$e=this._process(!0)):($e=this._process(!0),Lt.unpad($e)),$e},blockSize:4}),ae=y.CipherParams=i.extend({init:function($e){this.mixIn($e)},toString:function($e){return($e||this.formatter).stringify(this)}}),qe=(g.format={}).OpenSSL={stringify:function($e){var Lt=$e.ciphertext,jt=$e.salt;return(jt?k.create([1398893684,1701076831]).concat(jt).concat(Lt):Lt).toString(V)},parse:function($e){var Lt,jt=V.parse($e),Et=jt.words;return Et[0]==1398893684&&Et[1]==1701076831&&(Lt=k.create(Et.slice(2,4)),Et.splice(0,4),jt.sigBytes-=16),ae.create({ciphertext:jt,salt:Lt})}},de=y.SerializableCipher=i.extend({cfg:i.extend({format:qe}),encrypt:function($e,Lt,jt,Et){Et=this.cfg.extend(Et);var ir=$e.createEncryptor(jt,Et),dr=ir.finalize(Lt),Dt=ir.cfg;return ae.create({ciphertext:dr,key:jt,iv:Dt.iv,algorithm:$e,mode:Dt.mode,padding:Dt.padding,blockSize:$e.blockSize,formatter:Et.format})},decrypt:function($e,Lt,jt,Et){return Et=this.cfg.extend(Et),Lt=this._parse(Lt,Et.format),$e.createDecryptor(jt,Et).finalize(Lt.ciphertext)},_parse:function($e,Lt){return typeof $e=="string"?Lt.parse($e,this):$e}}),Ne=(g.kdf={}).OpenSSL={execute:function($e,Lt,jt,Et){Et||(Et=k.random(8));var ir=z.create({keySize:Lt+jt}).compute($e,Et),dr=k.create(ir.words.slice(Lt),4*jt);return ir.sigBytes=4*Lt,ae.create({key:ir,iv:dr,salt:Et})}},ze=y.PasswordBasedCipher=de.extend({cfg:de.cfg.extend({kdf:Ne}),encrypt:function($e,Lt,jt,Et){var ir=(Et=this.cfg.extend(Et)).kdf.execute(jt,$e.keySize,$e.ivSize);Et.iv=ir.iv;var dr=de.encrypt.call(this,$e,Lt,ir.key,Et);return dr.mixIn(ir),dr},decrypt:function($e,Lt,jt,Et){Et=this.cfg.extend(Et),Lt=this._parse(Lt,Et.format);var ir=Et.kdf.execute(jt,$e.keySize,$e.ivSize,Lt.salt);return Et.iv=ir.iv,de.decrypt.call(this,$e,Lt,ir.key,Et)}}))))},function(t,r,e){t.exports=e(284)},function(t,r,e){var n=e(19),g=e(316),y=Array.prototype;t.exports=function(i){var k=i.indexOf;return i===y||n(y,i)&&k===y.indexOf?g:k}},function(t,r,e){e(317);var n=e(29);t.exports=n("Array").indexOf},function(t,r,e){var n=e(1),g=e(159),y=e(163).indexOf,i=e(82),k=g([].indexOf),$=!!k&&1/k([1],1,-0)<0,L=i("indexOf");n({target:"Array",proto:!0,forced:$||!L},{indexOf:function(V){var z=arguments.length>1?arguments[1]:void 0;return $?k(this,V,z)||0:y(this,V,z)}})},function(t,r,e){var n=e(20),g=e(28),y=e(129),i=e(160),k=e(319),$=e(21),L=TypeError,V=$("toPrimitive");t.exports=function(z,re){if(!g(z)||y(z))return z;var ie,ue=i(z,V);if(ue){if(re===void 0&&(re="default"),ie=n(ue,z,re),!g(ie)||y(ie))return ie;throw L("Can't convert object to primitive value")}return re===void 0&&(re="number"),k(z,re)}},function(t,r,e){var n=e(20),g=e(17),y=e(28),i=TypeError;t.exports=function(k,$){var L,V;if($==="string"&&g(L=k.toString)&&!y(V=n(L,k))||g(L=k.valueOf)&&!y(V=n(L,k))||$!=="string"&&g(L=k.toString)&&!y(V=n(L,k)))return V;throw i("Can't convert object to primitive value")}},function(t,r,e){var n=e(14),g=Object.defineProperty;t.exports=function(y,i){try{g(n,y,{value:i,configurable:!0,writable:!0})}catch{n[y]=i}return i}},function(t,r){var e=Math.ceil,n=Math.floor;t.exports=Math.trunc||function(g){var y=+g;return(y>0?n:e)(y)}},function(t,r,e){var n=e(112),g=Math.min;t.exports=function(y){return y>0?g(n(y),9007199254740991):0}},function(t,r,e){var n=e(324);t.exports=n},function(t,r,e){var n=e(19),g=e(325),y=Array.prototype;t.exports=function(i){var k=i.concat;return i===y||n(y,i)&&k===y.concat?g:k}},function(t,r,e){e(213);var n=e(29);t.exports=n("Array").concat},function(t,r,e){var n=e(83),g=e(132),y=e(28),i=e(21)("species"),k=Array;t.exports=function($){var L;return n($)&&(L=$.constructor,(g(L)&&(L===k||n(L.prototype))||y(L)&&(L=L[i])===null)&&(L=void 0)),L===void 0?k:L}},function(t,r,e){e(328);var n=e(13).Object;t.exports=function(g,y){return n.create(g,y)}},function(t,r,e){e(1)({target:"Object",stat:!0,sham:!e(27)},{create:e(84)})},function(t,r,e){t.exports=e(330)},function(t,r,e){var n=e(331);e(358),e(359),e(360),e(361),e(362),e(363),e(364),t.exports=n},function(t,r,e){var n=e(219);e(357),t.exports=n},function(t,r,e){e(213),e(100),e(220),e(339),e(340),e(341),e(342),e(225),e(343),e(344),e(345),e(346),e(347),e(348),e(226),e(349),e(350),e(351),e(352),e(353);var n=e(13);t.exports=n.Symbol},function(t,r,e){var n=e(1),g=e(14),y=e(20),i=e(12),k=e(49),$=e(27),L=e(97),V=e(5),z=e(30),re=e(19),ie=e(36),ue=e(44),le=e(128),oe=e(50),ae=e(80),qe=e(84),de=e(120),Ne=e(134),ze=e(168),$e=e(135),Lt=e(95),jt=e(39),Et=e(166),ir=e(150),dr=e(68),Dt=e(111),lr=e(133),sr=e(114),er=e(130),cr=e(21),or=e(136),hr=e(23),pr=e(222),Sr=e(85),Er=e(101),Pr=e(74).forEach,Cr=lr("hidden"),rr=Er.set,kr=Er.getterFor("Symbol"),Ir=Object.prototype,xr=g.Symbol,vr=xr&&xr.prototype,_r=g.TypeError,Or=g.QObject,Mr=Lt.f,yr=jt.f,mr=ze.f,Tr=ir.f,Br=i([].push),$r=Dt("symbols"),Lr=Dt("op-symbols"),Gr=Dt("wks"),qr=!Or||!Or.prototype||!Or.prototype.findChild,Yr=$&&V(function(){return qe(yr({},"a",{get:function(){return yr(this,"a",{value:7}).a}})).a!=7})?function(kn,Dn,xn){var An=Mr(Ir,Dn);An&&delete Ir[Dn],yr(kn,Dn,xn),An&&kn!==Ir&&yr(Ir,Dn,An)}:yr,bn=function(kn,Dn){var xn=$r[kn]=qe(vr);return rr(xn,{type:"Symbol",tag:kn,description:Dn}),$||(xn.description=Dn),xn},wn=function(kn,Dn,xn){kn===Ir&&wn(Lr,Dn,xn),ie(kn);var An=le(Dn);return ie(xn),z($r,An)?(xn.enumerable?(z(kn,Cr)&&kn[Cr][An]&&(kn[Cr][An]=!1),xn=qe(xn,{enumerable:ae(0,!1)})):(z(kn,Cr)||yr(kn,Cr,ae(1,{})),kn[Cr][An]=!0),Yr(kn,An,xn)):yr(kn,An,xn)},Xr=function(kn,Dn){ie(kn);var xn=ue(Dn),An=de(xn).concat(Qr(xn));return Pr(An,function(vn){$&&!y(Vn,xn,vn)||wn(kn,vn,xn[vn])}),kn},Vn=function(kn){var Dn=le(kn),xn=y(Tr,this,Dn);return!(this===Ir&&z($r,Dn)&&!z(Lr,Dn))&&(!(xn||!z(this,Dn)||!z($r,Dn)||z(this,Cr)&&this[Cr][Dn])||xn)},Zr=function(kn,Dn){var xn=ue(kn),An=le(Dn);if(xn!==Ir||!z($r,An)||z(Lr,An)){var vn=Mr(xn,An);return!vn||!z($r,An)||z(xn,Cr)&&xn[Cr][An]||(vn.enumerable=!0),vn}},Nn=function(kn){var Dn=mr(ue(kn)),xn=[];return Pr(Dn,function(An){z($r,An)||z(sr,An)||Br(xn,An)}),xn},Qr=function(kn){var Dn=kn===Ir,xn=mr(Dn?Lr:ue(kn)),An=[];return Pr(xn,function(vn){!z($r,vn)||Dn&&!z(Ir,vn)||Br(An,$r[vn])}),An};L||(dr(vr=(xr=function(){if(re(vr,this))throw _r("Symbol is not a constructor");var kn=arguments.length&&arguments[0]!==void 0?oe(arguments[0]):void 0,Dn=er(kn),xn=function(An){this===Ir&&y(xn,Lr,An),z(this,Cr)&&z(this[Cr],Dn)&&(this[Cr][Dn]=!1),Yr(this,Dn,ae(1,An))};return $&&qr&&Yr(Ir,Dn,{configurable:!0,set:xn}),bn(Dn,kn)}).prototype,"toString",function(){return kr(this).tag}),dr(xr,"withoutSetter",function(kn){return bn(er(kn),kn)}),ir.f=Vn,jt.f=wn,Et.f=Xr,Lt.f=Zr,Ne.f=ze.f=Nn,$e.f=Qr,or.f=function(kn){return bn(cr(kn),kn)},$&&(yr(vr,"description",{configurable:!0,get:function(){return kr(this).description}}),k||dr(Ir,"propertyIsEnumerable",Vn,{unsafe:!0}))),n({global:!0,constructor:!0,wrap:!0,forced:!L,sham:!L},{Symbol:xr}),Pr(de(Gr),function(kn){hr(kn)}),n({target:"Symbol",stat:!0,forced:!L},{useSetter:function(){qr=!0},useSimple:function(){qr=!1}}),n({target:"Object",stat:!0,forced:!L,sham:!$},{create:function(kn,Dn){return Dn===void 0?qe(kn):Xr(qe(kn),Dn)},defineProperty:wn,defineProperties:Xr,getOwnPropertyDescriptor:Zr}),n({target:"Object",stat:!0,forced:!L},{getOwnPropertyNames:Nn}),pr(),Sr(xr,"Symbol"),sr[Cr]=!0},function(t,r,e){var n=e(165),g=e(67);t.exports=n?{}.toString:function(){return"[object "+g(this)+"]"}},function(t,r,e){var n=e(14),g=e(17),y=n.WeakMap;t.exports=g(y)&&/native code/.test(String(y))},function(t,r,e){var n=e(1),g=e(33),y=e(30),i=e(50),k=e(111),$=e(223),L=k("string-to-symbol-registry"),V=k("symbol-to-string-registry");n({target:"Symbol",stat:!0,forced:!$},{for:function(z){var re=i(z);if(y(L,re))return L[re];var ie=g("Symbol")(re);return L[re]=ie,V[ie]=re,ie}})},function(t,r,e){var n=e(1),g=e(30),y=e(129),i=e(81),k=e(111),$=e(223),L=k("symbol-to-string-registry");n({target:"Symbol",stat:!0,forced:!$},{keyFor:function(V){if(!y(V))throw TypeError(i(V)+" is not a symbol");if(g(L,V))return L[V]}})},function(t,r,e){var n=e(1),g=e(97),y=e(5),i=e(135),k=e(42);n({target:"Object",stat:!0,forced:!g||y(function(){i.f(1)})},{getOwnPropertySymbols:function($){var L=i.f;return L?L(k($)):[]}})},function(t,r,e){e(23)("asyncIterator")},function(t,r){},function(t,r,e){e(23)("hasInstance")},function(t,r,e){e(23)("isConcatSpreadable")},function(t,r,e){e(23)("match")},function(t,r,e){e(23)("matchAll")},function(t,r,e){e(23)("replace")},function(t,r,e){e(23)("search")},function(t,r,e){e(23)("species")},function(t,r,e){e(23)("split")},function(t,r,e){var n=e(33),g=e(23),y=e(85);g("toStringTag"),y(n("Symbol"),"Symbol")},function(t,r,e){e(23)("unscopables")},function(t,r,e){var n=e(14);e(85)(n.JSON,"JSON",!0)},function(t,r){},function(t,r){},function(t,r,e){var n=e(228).IteratorPrototype,g=e(84),y=e(80),i=e(85),k=e(103),$=function(){return this};t.exports=function(L,V,z,re){var ie=V+" Iterator";return L.prototype=g(n,{next:y(+!re,z)}),i(L,ie,!1,!0),k[ie]=$,L}},function(t,r,e){var n=e(17),g=String,y=TypeError;t.exports=function(i){if(typeof i=="object"||n(i))return i;throw y("Can't set "+g(i)+" as a prototype")}},function(t,r){t.exports={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}},function(t,r,e){e(23)("dispose")},function(t,r,e){e(23)("asyncDispose")},function(t,r,e){e(23)("matcher")},function(t,r,e){e(23)("metadataKey")},function(t,r,e){e(23)("observable")},function(t,r,e){e(23)("metadata")},function(t,r,e){e(23)("patternMatch")},function(t,r,e){e(23)("replaceAll")},function(t,r,e){t.exports=e(366)},function(t,r,e){t.exports=e(367)},function(t,r,e){var n=e(368);t.exports=n},function(t,r,e){var n=e(369);t.exports=n},function(t,r,e){var n=e(370);e(69),t.exports=n},function(t,r,e){e(86),e(100),e(115),e(225);var n=e(136);t.exports=n.f("iterator")},function(t,r,e){var n=e(12),g=e(112),y=e(50),i=e(110),k=n("".charAt),$=n("".charCodeAt),L=n("".slice),V=function(z){return function(re,ie){var ue,le,oe=y(i(re)),ae=g(ie),qe=oe.length;return ae<0||ae>=qe?z?"":void 0:(ue=$(oe,ae))<55296||ue>56319||ae+1===qe||(le=$(oe,ae+1))<56320||le>57343?z?k(oe,ae):ue:z?L(oe,ae,ae+2):le-56320+(ue-55296<<10)+65536}};t.exports={codeAt:V(!1),charAt:V(!0)}},function(t,r,e){e(373);var n=e(13);t.exports=n.Array.isArray},function(t,r,e){e(1)({target:"Array",stat:!0},{isArray:e(83)})},function(t,r,e){var n=e(375);t.exports=n},function(t,r,e){e(376);var n=e(29);t.exports=n("Array").forEach},function(t,r,e){var n=e(1),g=e(377);n({target:"Array",proto:!0,forced:[].forEach!=g},{forEach:g})},function(t,r,e){var n=e(74).forEach,g=e(82)("forEach");t.exports=g?[].forEach:function(y){return n(this,y,arguments.length>1?arguments[1]:void 0)}},function(t,r,e){t.exports=e(379)},function(t,r,e){var n=e(380);t.exports=n},function(t,r,e){e(381);var n=e(13).Object;t.exports=function(g){return n.getOwnPropertyNames(g)}},function(t,r,e){var n=e(1),g=e(5),y=e(168).f;n({target:"Object",stat:!0,forced:g(function(){return!Object.getOwnPropertyNames(1)})},{getOwnPropertyNames:y})},function(t,r,e){e(383);var n=e(13);t.exports=n.Object.keys},function(t,r,e){var n=e(1),g=e(42),y=e(120);n({target:"Object",stat:!0,forced:e(5)(function(){y(1)})},{keys:function(i){return y(g(i))}})},function(t,r,e){var n=e(385);t.exports=n},function(t,r,e){e(224);var n=e(13),g=e(79);n.JSON||(n.JSON={stringify:JSON.stringify}),t.exports=function(y,i,k){return g(n.JSON.stringify,null,arguments)}},function(t,r,e){e(233),e(86),e(100),e(393),e(247),e(248),e(406),e(115);var n=e(13);t.exports=n.Promise},function(t,r,e){var n=e(1),g=e(19),y=e(137),i=e(138),k=e(388),$=e(84),L=e(61),V=e(80),z=e(389),re=e(390),ie=e(47),ue=e(391),le=e(21),oe=e(392),ae=le("toStringTag"),qe=Error,de=[].push,Ne=function($e,Lt){var jt,Et=arguments.length>2?arguments[2]:void 0,ir=g(ze,this);i?jt=i(qe(),ir?y(this):ze):(jt=ir?this:$(ze),L(jt,ae,"Error")),Lt!==void 0&&L(jt,"message",ue(Lt)),oe&&L(jt,"stack",z(jt.stack,1)),re(jt,Et);var dr=[];return ie($e,de,{that:dr}),L(jt,"errors",dr),jt};i?i(Ne,qe):k(Ne,qe,{name:!0});var ze=Ne.prototype=$(qe.prototype,{constructor:V(1,Ne),message:V(1,""),name:V(1,"AggregateError")});n({global:!0,constructor:!0,arity:2},{AggregateError:Ne})},function(t,r,e){var n=e(30),g=e(234),y=e(95),i=e(39);t.exports=function(k,$,L){for(var V=g($),z=i.f,re=y.f,ie=0;ie<V.length;ie++){var ue=V[ie];n(k,ue)||L&&n(L,ue)||z(k,ue,re($,ue))}}},function(t,r,e){var n=e(12),g=Error,y=n("".replace),i=String(g("zxcasd").stack),k=/\n\s*at [^:]*:[^\n]*/,$=k.test(i);t.exports=function(L,V){if($&&typeof L=="string"&&!g.prepareStackTrace)for(;V--;)L=y(L,k,"");return L}},function(t,r,e){var n=e(28),g=e(61);t.exports=function(y,i){n(i)&&"cause"in i&&g(y,"cause",i.cause)}},function(t,r,e){var n=e(50);t.exports=function(g,y){return g===void 0?arguments.length<2?"":y:n(g)}},function(t,r,e){var n=e(5),g=e(80);t.exports=!n(function(){var y=Error("a");return!("stack"in y)||(Object.defineProperty(y,"stack",g(1,7)),y.stack!==7)})},function(t,r,e){e(394),e(401),e(402),e(403),e(404),e(405)},function(t,r,e){var n,g,y,i=e(1),k=e(49),$=e(116),L=e(14),V=e(20),z=e(68),re=e(138),ie=e(85),ue=e(238),le=e(31),oe=e(17),ae=e(28),qe=e(171),de=e(239),Ne=e(240).set,ze=e(395),$e=e(398),Lt=e(104),jt=e(399),Et=e(101),ir=e(105),dr=e(117),Dt=e(70),lr=dr.CONSTRUCTOR,sr=dr.REJECTION_EVENT,er=dr.SUBCLASSING,cr=Et.getterFor("Promise"),or=Et.set,hr=ir&&ir.prototype,pr=ir,Sr=hr,Er=L.TypeError,Pr=L.document,Cr=L.process,rr=Dt.f,kr=rr,Ir=!!(Pr&&Pr.createEvent&&L.dispatchEvent),xr=function(Lr){var Gr;return!(!ae(Lr)||!oe(Gr=Lr.then))&&Gr},vr=function(Lr,Gr){var qr,Yr,bn,wn=Gr.value,Xr=Gr.state==1,Vn=Xr?Lr.ok:Lr.fail,Zr=Lr.resolve,Nn=Lr.reject,Qr=Lr.domain;try{Vn?(Xr||(Gr.rejection===2&&mr(Gr),Gr.rejection=1),Vn===!0?qr=wn:(Qr&&Qr.enter(),qr=Vn(wn),Qr&&(Qr.exit(),bn=!0)),qr===Lr.promise?Nn(Er("Promise-chain cycle")):(Yr=xr(qr))?V(Yr,qr,Zr,Nn):Zr(qr)):Nn(wn)}catch(kn){Qr&&!bn&&Qr.exit(),Nn(kn)}},_r=function(Lr,Gr){Lr.notified||(Lr.notified=!0,ze(function(){for(var qr,Yr=Lr.reactions;qr=Yr.get();)vr(qr,Lr);Lr.notified=!1,Gr&&!Lr.rejection&&Mr(Lr)}))},Or=function(Lr,Gr,qr){var Yr,bn;Ir?((Yr=Pr.createEvent("Event")).promise=Gr,Yr.reason=qr,Yr.initEvent(Lr,!1,!0),L.dispatchEvent(Yr)):Yr={promise:Gr,reason:qr},!sr&&(bn=L["on"+Lr])?bn(Yr):Lr==="unhandledrejection"&&$e("Unhandled promise rejection",qr)},Mr=function(Lr){V(Ne,L,function(){var Gr,qr=Lr.facade,Yr=Lr.value;if(yr(Lr)&&(Gr=Lt(function(){$?Cr.emit("unhandledRejection",Yr,qr):Or("unhandledrejection",qr,Yr)}),Lr.rejection=$||yr(Lr)?2:1,Gr.error))throw Gr.value})},yr=function(Lr){return Lr.rejection!==1&&!Lr.parent},mr=function(Lr){V(Ne,L,function(){var Gr=Lr.facade;$?Cr.emit("rejectionHandled",Gr):Or("rejectionhandled",Gr,Lr.value)})},Tr=function(Lr,Gr,qr){return function(Yr){Lr(Gr,Yr,qr)}},Br=function(Lr,Gr,qr){Lr.done||(Lr.done=!0,qr&&(Lr=qr),Lr.value=Gr,Lr.state=2,_r(Lr,!0))},$r=function(Lr,Gr,qr){if(!Lr.done){Lr.done=!0,qr&&(Lr=qr);try{if(Lr.facade===Gr)throw Er("Promise can't be resolved itself");var Yr=xr(Gr);Yr?ze(function(){var bn={done:!1};try{V(Yr,Gr,Tr($r,bn,Lr),Tr(Br,bn,Lr))}catch(wn){Br(bn,wn,Lr)}}):(Lr.value=Gr,Lr.state=1,_r(Lr,!1))}catch(bn){Br({done:!1},bn,Lr)}}};if(lr&&(Sr=(pr=function(Lr){qe(this,Sr),le(Lr),V(n,this);var Gr=cr(this);try{Lr(Tr($r,Gr),Tr(Br,Gr))}catch(qr){Br(Gr,qr)}}).prototype,(n=function(Lr){or(this,{type:"Promise",done:!1,notified:!1,parent:!1,reactions:new jt,rejection:!1,state:0,value:void 0})}).prototype=z(Sr,"then",function(Lr,Gr){var qr=cr(this),Yr=rr(de(this,pr));return qr.parent=!0,Yr.ok=!oe(Lr)||Lr,Yr.fail=oe(Gr)&&Gr,Yr.domain=$?Cr.domain:void 0,qr.state==0?qr.reactions.add(Yr):ze(function(){vr(Yr,qr)}),Yr.promise}),g=function(){var Lr=new n,Gr=cr(Lr);this.promise=Lr,this.resolve=Tr($r,Gr),this.reject=Tr(Br,Gr)},Dt.f=rr=function(Lr){return Lr===pr||Lr===void 0?new g(Lr):kr(Lr)},!k&&oe(ir)&&hr!==Object.prototype)){y=hr.then,er||z(hr,"then",function(Lr,Gr){var qr=this;return new pr(function(Yr,bn){V(y,qr,Yr,bn)}).then(Lr,Gr)},{unsafe:!0});try{delete hr.constructor}catch{}re&&re(hr,Sr)}i({global:!0,constructor:!0,wrap:!0,forced:lr},{Promise:pr}),ie(pr,"Promise",!1,!0),ue("Promise")},function(t,r,e){var n,g,y,i,k,$,L,V,z=e(14),re=e(34),ie=e(95).f,ue=e(240).set,le=e(242),oe=e(396),ae=e(397),qe=e(116),de=z.MutationObserver||z.WebKitMutationObserver,Ne=z.document,ze=z.process,$e=z.Promise,Lt=ie(z,"queueMicrotask"),jt=Lt&&Lt.value;jt||(n=function(){var Et,ir;for(qe&&(Et=ze.domain)&&Et.exit();g;){ir=g.fn,g=g.next;try{ir()}catch(dr){throw g?i():y=void 0,dr}}y=void 0,Et&&Et.enter()},le||qe||ae||!de||!Ne?!oe&&$e&&$e.resolve?((L=$e.resolve(void 0)).constructor=$e,V=re(L.then,L),i=function(){V(n)}):qe?i=function(){ze.nextTick(n)}:(ue=re(ue,z),i=function(){ue(n)}):(k=!0,$=Ne.createTextNode(""),new de(n).observe($,{characterData:!0}),i=function(){$.data=k=!k})),t.exports=jt||function(Et){var ir={fn:Et,next:void 0};y&&(y.next=ir),g||(g=ir,i()),y=ir}},function(t,r,e){var n=e(66),g=e(14);t.exports=/ipad|iphone|ipod/i.test(n)&&g.Pebble!==void 0},function(t,r,e){var n=e(66);t.exports=/web0s(?!.*chrome)/i.test(n)},function(t,r,e){var n=e(14);t.exports=function(g,y){var i=n.console;i&&i.error&&(arguments.length==1?i.error(g):i.error(g,y))}},function(t,r){var e=function(){this.head=null,this.tail=null};e.prototype={add:function(n){var g={item:n,next:null};this.head?this.tail.next=g:this.head=g,this.tail=g},get:function(){var n=this.head;if(n)return this.head=n.next,this.tail===n&&(this.tail=null),n.item}},t.exports=e},function(t,r,e){var n=e(243),g=e(116);t.exports=!n&&!g&&typeof window=="object"&&typeof document=="object"},function(t,r,e){var n=e(1),g=e(20),y=e(31),i=e(70),k=e(104),$=e(47);n({target:"Promise",stat:!0,forced:e(244)},{all:function(L){var V=this,z=i.f(V),re=z.resolve,ie=z.reject,ue=k(function(){var le=y(V.resolve),oe=[],ae=0,qe=1;$(L,function(de){var Ne=ae++,ze=!1;qe++,g(le,V,de).then(function($e){ze||(ze=!0,oe[Ne]=$e,--qe||re(oe))},ie)}),--qe||re(oe)});return ue.error&&ie(ue.value),z.promise}})},function(t,r,e){var n=e(1),g=e(49),y=e(117).CONSTRUCTOR,i=e(105),k=e(33),$=e(17),L=e(68),V=i&&i.prototype;if(n({target:"Promise",proto:!0,forced:y,real:!0},{catch:function(re){return this.then(void 0,re)}}),!g&&$(i)){var z=k("Promise").prototype.catch;V.catch!==z&&L(V,"catch",z,{unsafe:!0})}},function(t,r,e){var n=e(1),g=e(20),y=e(31),i=e(70),k=e(104),$=e(47);n({target:"Promise",stat:!0,forced:e(244)},{race:function(L){var V=this,z=i.f(V),re=z.reject,ie=k(function(){var ue=y(V.resolve);$(L,function(le){g(ue,V,le).then(z.resolve,re)})});return ie.error&&re(ie.value),z.promise}})},function(t,r,e){var n=e(1),g=e(20),y=e(70);n({target:"Promise",stat:!0,forced:e(117).CONSTRUCTOR},{reject:function(i){var k=y.f(this);return g(k.reject,void 0,i),k.promise}})},function(t,r,e){var n=e(1),g=e(33),y=e(49),i=e(105),k=e(117).CONSTRUCTOR,$=e(246),L=g("Promise"),V=y&&!k;n({target:"Promise",stat:!0,forced:y||k},{resolve:function(z){return $(V&&this===L?i:this,z)}})},function(t,r,e){var n=e(1),g=e(49),y=e(105),i=e(5),k=e(33),$=e(17),L=e(239),V=e(246),z=e(68),re=y&&y.prototype;if(n({target:"Promise",proto:!0,real:!0,forced:!!y&&i(function(){re.finally.call({then:function(){}},function(){})})},{finally:function(ue){var le=L(this,k("Promise")),oe=$(ue);return this.then(oe?function(ae){return V(le,ue()).then(function(){return ae})}:ue,oe?function(ae){return V(le,ue()).then(function(){throw ae})}:ue)}}),!g&&$(y)){var ie=k("Promise").prototype.finally;re.finally!==ie&&z(re,"finally",ie,{unsafe:!0})}},function(t,r,e){t.exports=e(408)},function(t,r,e){var n=e(409);t.exports=n},function(t,r,e){var n=e(249);t.exports=n},function(t,r,e){e(411);var n=e(13).Object,g=t.exports=function(y,i,k){return n.defineProperty(y,i,k)};n.defineProperty.sham&&(g.sham=!0)},function(t,r,e){var n=e(1),g=e(27),y=e(39).f;n({target:"Object",stat:!0,forced:Object.defineProperty!==y,sham:!g},{defineProperty:y})},function(t,r,e){var n=e(413),g=e(22).default;t.exports=function(y,i){if(g(y)!=="object"||y===null)return y;var k=y[n];if(k!==void 0){var $=k.call(y,i||"default");if(g($)!=="object")return $;throw new TypeError("@@toPrimitive must return a primitive value.")}return(i==="string"?String:Number)(y)},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,r,e){t.exports=e(414)},function(t,r,e){t.exports=e(415)},function(t,r,e){var n=e(416);t.exports=n},function(t,r,e){var n=e(417);t.exports=n},function(t,r,e){var n=e(418);t.exports=n},function(t,r,e){e(419),e(226);var n=e(136);t.exports=n.f("toPrimitive")},function(t,r){},function(t,r,e){var n=e(19),g=e(421),y=Array.prototype;t.exports=function(i){var k=i.slice;return i===y||n(y,i)&&k===y.slice?g:k}},function(t,r,e){e(422);var n=e(29);t.exports=n("Array").slice},function(t,r,e){var n=e(1),g=e(83),y=e(132),i=e(28),k=e(131),$=e(46),L=e(44),V=e(99),z=e(21),re=e(113),ie=e(102),ue=re("slice"),le=z("species"),oe=Array,ae=Math.max;n({target:"Array",proto:!0,forced:!ue},{slice:function(qe,de){var Ne,ze,$e,Lt=L(this),jt=$(Lt),Et=k(qe,jt),ir=k(de===void 0?jt:de,jt);if(g(Lt)&&(Ne=Lt.constructor,(y(Ne)&&(Ne===oe||g(Ne.prototype))||i(Ne)&&(Ne=Ne[le])===null)&&(Ne=void 0),Ne===oe||Ne===void 0))return ie(Lt,Et,ir);for(ze=new(Ne===void 0?oe:Ne)(ae(ir-Et,0)),$e=0;Et<ir;Et++,$e++)Et in Lt&&V(ze,$e,Lt[Et]);return ze.length=$e,ze}})},function(t,r,e){var n=e(424);t.exports=n},function(t,r,e){var n=e(19),g=e(425),y=Array.prototype;t.exports=function(i){var k=i.some;return i===y||n(y,i)&&k===y.some?g:k}},function(t,r,e){e(426);var n=e(29);t.exports=n("Array").some},function(t,r,e){var n=e(1),g=e(74).some;n({target:"Array",proto:!0,forced:!e(82)("some")},{some:function(y){return g(this,y,arguments.length>1?arguments[1]:void 0)}})},function(t,r,e){var n=e(428);t.exports=n},function(t,r,e){var n=e(19),g=e(429),y=Array.prototype;t.exports=function(i){var k=i.splice;return i===y||n(y,i)&&k===y.splice?g:k}},function(t,r,e){e(430);var n=e(29);t.exports=n("Array").splice},function(t,r,e){var n=e(1),g=e(42),y=e(131),i=e(112),k=e(46),$=e(431),L=e(214),V=e(164),z=e(99),re=e(252),ie=e(113)("splice"),ue=Math.max,le=Math.min;n({target:"Array",proto:!0,forced:!ie},{splice:function(oe,ae){var qe,de,Ne,ze,$e,Lt,jt=g(this),Et=k(jt),ir=y(oe,Et),dr=arguments.length;for(dr===0?qe=de=0:dr===1?(qe=0,de=Et-ir):(qe=dr-2,de=le(ue(i(ae),0),Et-ir)),L(Et+qe-de),Ne=V(jt,de),ze=0;ze<de;ze++)($e=ir+ze)in jt&&z(Ne,ze,jt[$e]);if(Ne.length=de,qe<de){for(ze=ir;ze<Et-de;ze++)Lt=ze+qe,($e=ze+de)in jt?jt[Lt]=jt[$e]:re(jt,Lt);for(ze=Et;ze>Et-de+qe;ze--)re(jt,ze-1)}else if(qe>de)for(ze=Et-de;ze>ir;ze--)Lt=ze+qe-1,($e=ze+de-1)in jt?jt[Lt]=jt[$e]:re(jt,Lt);for(ze=0;ze<qe;ze++)jt[ze+ir]=arguments[ze+2];return $(jt,Et-de+qe),Ne}})},function(t,r,e){var n=e(27),g=e(83),y=TypeError,i=Object.getOwnPropertyDescriptor,k=n&&!function(){if(this!==void 0)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch($){return $ instanceof TypeError}}();t.exports=k?function($,L){if(g($)&&!i($,"length").writable)throw y("Cannot set read only .length");return $.length=L}:function($,L){return $.length=L}},function(t,r,e){var n=e(433);t.exports=n},function(t,r,e){var n=e(19),g=e(434),y=Array.prototype;t.exports=function(i){var k=i.sort;return i===y||n(y,i)&&k===y.sort?g:k}},function(t,r,e){e(435);var n=e(29);t.exports=n("Array").sort},function(t,r,e){var n=e(1),g=e(12),y=e(31),i=e(42),k=e(46),$=e(252),L=e(50),V=e(5),z=e(436),re=e(82),ie=e(437),ue=e(438),le=e(98),oe=e(439),ae=[],qe=g(ae.sort),de=g(ae.push),Ne=V(function(){ae.sort(void 0)}),ze=V(function(){ae.sort(null)}),$e=re("sort"),Lt=!V(function(){if(le)return le<70;if(!(ie&&ie>3)){if(ue)return!0;if(oe)return oe<603;var jt,Et,ir,dr,Dt="";for(jt=65;jt<76;jt++){switch(Et=String.fromCharCode(jt),jt){case 66:case 69:case 70:case 72:ir=3;break;case 68:case 71:ir=4;break;default:ir=2}for(dr=0;dr<47;dr++)ae.push({k:Et+dr,v:ir})}for(ae.sort(function(lr,sr){return sr.v-lr.v}),dr=0;dr<ae.length;dr++)Et=ae[dr].k.charAt(0),Dt.charAt(Dt.length-1)!==Et&&(Dt+=Et);return Dt!=="DGBEFHACIJK"}});n({target:"Array",proto:!0,forced:Ne||!ze||!$e||!Lt},{sort:function(jt){jt!==void 0&&y(jt);var Et=i(this);if(Lt)return jt===void 0?qe(Et):qe(Et,jt);var ir,dr,Dt=[],lr=k(Et);for(dr=0;dr<lr;dr++)dr in Et&&de(Dt,Et[dr]);for(z(Dt,function(sr){return function(er,cr){return cr===void 0?-1:er===void 0?1:sr!==void 0?+sr(er,cr)||0:L(er)>L(cr)?1:-1}}(jt)),ir=k(Dt),dr=0;dr<ir;)Et[dr]=Dt[dr++];for(;dr<lr;)$(Et,dr++);return Et}})},function(t,r,e){var n=e(221),g=Math.floor,y=function($,L){var V=$.length,z=g(V/2);return V<8?i($,L):k($,y(n($,0,z),L),y(n($,z),L),L)},i=function($,L){for(var V,z,re=$.length,ie=1;ie<re;){for(z=ie,V=$[ie];z&&L($[z-1],V)>0;)$[z]=$[--z];z!==ie++&&($[z]=V)}return $},k=function($,L,V,z){for(var re=L.length,ie=V.length,ue=0,le=0;ue<re||le<ie;)$[ue+le]=ue<re&&le<ie?z(L[ue],V[le])<=0?L[ue++]:V[le++]:ue<re?L[ue++]:V[le++];return $};t.exports=y},function(t,r,e){var n=e(66).match(/firefox\/(\d+)/i);t.exports=!!n&&+n[1]},function(t,r,e){var n=e(66);t.exports=/MSIE|Trident/.test(n)},function(t,r,e){var n=e(66).match(/AppleWebKit\/(\d+)\./);t.exports=!!n&&+n[1]},function(t,r,e){var n=e(441);t.exports=n},function(t,r,e){var n=e(19),g=e(442),y=Array.prototype;t.exports=function(i){var k=i.map;return i===y||n(y,i)&&k===y.map?g:k}},function(t,r,e){e(443);var n=e(29);t.exports=n("Array").map},function(t,r,e){var n=e(1),g=e(74).map;n({target:"Array",proto:!0,forced:!e(113)("map")},{map:function(y){return g(this,y,arguments.length>1?arguments[1]:void 0)}})},function(t,r,e){var n=e(445);t.exports=n},function(t,r,e){var n=e(19),g=e(446),y=Array.prototype;t.exports=function(i){var k=i.reduce;return i===y||n(y,i)&&k===y.reduce?g:k}},function(t,r,e){e(447);var n=e(29);t.exports=n("Array").reduce},function(t,r,e){var n=e(1),g=e(448).left,y=e(82),i=e(98),k=e(116);n({target:"Array",proto:!0,forced:!y("reduce")||!k&&i>79&&i<83},{reduce:function($){var L=arguments.length;return g(this,$,L,L>1?arguments[1]:void 0)}})},function(t,r,e){var n=e(31),g=e(42),y=e(127),i=e(46),k=TypeError,$=function(L){return function(V,z,re,ie){n(z);var ue=g(V),le=y(ue),oe=i(ue),ae=L?oe-1:0,qe=L?-1:1;if(re<2)for(;;){if(ae in le){ie=le[ae],ae+=qe;break}if(ae+=qe,L?ae<0:oe<=ae)throw k("Reduce of empty array with no initial value")}for(;L?ae>=0:oe>ae;ae+=qe)ae in le&&(ie=z(ie,le[ae],ae,ue));return ie}};t.exports={left:$(!1),right:$(!0)}},function(t,r,e){var n=e(450);t.exports=n},function(t,r,e){var n=e(19),g=e(451),y=Array.prototype;t.exports=function(i){var k=i.lastIndexOf;return i===y||n(y,i)&&k===y.lastIndexOf?g:k}},function(t,r,e){e(452);var n=e(29);t.exports=n("Array").lastIndexOf},function(t,r,e){var n=e(1),g=e(453);n({target:"Array",proto:!0,forced:g!==[].lastIndexOf},{lastIndexOf:g})},function(t,r,e){var n=e(79),g=e(44),y=e(112),i=e(46),k=e(82),$=Math.min,L=[].lastIndexOf,V=!!L&&1/[1].lastIndexOf(1,-0)<0,z=k("lastIndexOf"),re=V||!z;t.exports=re?function(ie){if(V)return n(L,this,arguments)||0;var ue=g(this),le=i(ue),oe=le-1;for(arguments.length>1&&(oe=$(oe,y(arguments[1]))),oe<0&&(oe=le+oe);oe>=0;oe--)if(oe in ue&&ue[oe]===ie)return oe||0;return-1}:L},function(t,r,e){e(253);var n=e(13);t.exports=n.setTimeout},function(t,r,e){var n=e(1),g=e(14),y=e(254)(g.setInterval,!0);n({global:!0,bind:!0,forced:g.setInterval!==y},{setInterval:y})},function(t,r){t.exports=typeof Bun=="function"&&Bun&&typeof Bun.version=="string"},function(t,r,e){var n=e(1),g=e(14),y=e(254)(g.setTimeout,!0);n({global:!0,bind:!0,forced:g.setTimeout!==y},{setTimeout:y})},function(t,r,e){var n=e(459);t.exports=n},function(t,r,e){var n=e(19),g=e(460),y=Array.prototype;t.exports=function(i){var k=i.filter;return i===y||n(y,i)&&k===y.filter?g:k}},function(t,r,e){e(461);var n=e(29);t.exports=n("Array").filter},function(t,r,e){var n=e(1),g=e(74).filter;n({target:"Array",proto:!0,forced:!e(113)("filter")},{filter:function(y){return g(this,y,arguments.length>1?arguments[1]:void 0)}})},function(t,r,e){t.exports=e(463)},function(t,r,e){e(69);var n=e(67),g=e(30),y=e(19),i=e(464),k=Array.prototype,$={DOMTokenList:!0,NodeList:!0};t.exports=function(L){var V=L.values;return L===k||y(k,L)&&V===k.values||g($,n(L))?i:V}},function(t,r,e){var n=e(465);t.exports=n},function(t,r,e){e(86),e(100);var n=e(29);t.exports=n("Array").values},function(t,r,e){t.exports=e(467)},function(t,r,e){var n=e(468);t.exports=n},function(t,r,e){var n=e(19),g=e(469),y=Array.prototype;t.exports=function(i){var k=i.every;return i===y||n(y,i)&&k===y.every?g:k}},function(t,r,e){e(470);var n=e(29);t.exports=n("Array").every},function(t,r,e){var n=e(1),g=e(74).every;n({target:"Array",proto:!0,forced:!e(82)("every")},{every:function(y){return g(this,y,arguments.length>1?arguments[1]:void 0)}})},function(t,r,e){e(115),e(472);var n=e(13);t.exports=n.Array.from},function(t,r,e){var n=e(1),g=e(473);n({target:"Array",stat:!0,forced:!e(245)(function(y){Array.from(y)})},{from:g})},function(t,r,e){var n=e(34),g=e(20),y=e(42),i=e(474),k=e(235),$=e(132),L=e(46),V=e(99),z=e(236),re=e(139),ie=Array;t.exports=function(ue){var le=y(ue),oe=$(this),ae=arguments.length,qe=ae>1?arguments[1]:void 0,de=qe!==void 0;de&&(qe=n(qe,ae>2?arguments[2]:void 0));var Ne,ze,$e,Lt,jt,Et,ir=re(le),dr=0;if(!ir||this===ie&&k(ir))for(Ne=L(le),ze=oe?new this(Ne):ie(Ne);Ne>dr;dr++)Et=de?qe(le[dr],dr):le[dr],V(ze,dr,Et);else for(jt=(Lt=z(le,ir)).next,ze=oe?new this:[];!($e=g(jt,Lt)).done;dr++)Et=de?i(Lt,qe,[$e.value,dr],!0):$e.value,V(ze,dr,Et);return ze.length=dr,ze}},function(t,r,e){var n=e(36),g=e(237);t.exports=function(y,i,k,$){try{return $?i(n(k)[0],k[1]):i(k)}catch(L){g(y,"throw",L)}}},function(t,r,e){t.exports=e(476)},function(t,r,e){var n=e(477);t.exports=n},function(t,r,e){var n=e(478);t.exports=n},function(t,r,e){var n=e(479);e(69),t.exports=n},function(t,r,e){e(86),e(115);var n=e(139);t.exports=n},function(t,r,e){e(220);var n=e(13);t.exports=n.Object.getOwnPropertySymbols},function(t,r,e){var n=e(482);t.exports=n},function(t,r,e){e(483);var n=e(13).Object,g=t.exports=function(y,i){return n.getOwnPropertyDescriptor(y,i)};n.getOwnPropertyDescriptor.sham&&(g.sham=!0)},function(t,r,e){var n=e(1),g=e(5),y=e(44),i=e(95).f,k=e(27),$=g(function(){i(1)});n({target:"Object",stat:!0,forced:!k||$,sham:!k},{getOwnPropertyDescriptor:function(L,V){return i(y(L),V)}})},function(t,r,e){var n=e(485);t.exports=n},function(t,r,e){e(486);var n=e(13);t.exports=n.Object.getOwnPropertyDescriptors},function(t,r,e){var n=e(1),g=e(27),y=e(234),i=e(44),k=e(95),$=e(99);n({target:"Object",stat:!0,sham:!g},{getOwnPropertyDescriptors:function(L){for(var V,z,re=i(L),ie=k.f,ue=y(re),le={},oe=0;ue.length>oe;)(z=ie(re,V=ue[oe++]))!==void 0&&$(le,V,z);return le}})},function(t,r,e){var n=e(488);t.exports=n},function(t,r,e){e(489);var n=e(13).Object,g=t.exports=function(y,i){return n.defineProperties(y,i)};n.defineProperties.sham&&(g.sham=!0)},function(t,r,e){var n=e(1),g=e(27),y=e(166).f;n({target:"Object",stat:!0,forced:Object.defineProperties!==y,sham:!g},{defineProperties:y})},function(t,r,e){var n=e(11);typeof window<"u"&&(window.console||n.isWeixinApp||(window.console={log:function(){},info:function(){},warn:function(){},error:function(){}}))},function(t,r,e){var n=e(492),g=e(521),y=e(261),i=e(523),k=e(532),$=e(535),L=e(536),V=e(537),z=e(539),re=e(540),ie=e(541),ue=e(183),le=e(545),oe=e(546),ae=e(552),qe=e(177),de=e(264),Ne=e(554),ze=e(91),$e=e(556),Lt=e(176),jt=e(181),Et={};Et["[object Arguments]"]=Et["[object Array]"]=Et["[object ArrayBuffer]"]=Et["[object DataView]"]=Et["[object Boolean]"]=Et["[object Date]"]=Et["[object Float32Array]"]=Et["[object Float64Array]"]=Et["[object Int8Array]"]=Et["[object Int16Array]"]=Et["[object Int32Array]"]=Et["[object Map]"]=Et["[object Number]"]=Et["[object Object]"]=Et["[object RegExp]"]=Et["[object Set]"]=Et["[object String]"]=Et["[object Symbol]"]=Et["[object Uint8Array]"]=Et["[object Uint8ClampedArray]"]=Et["[object Uint16Array]"]=Et["[object Uint32Array]"]=!0,Et["[object Error]"]=Et["[object Function]"]=Et["[object WeakMap]"]=!1,t.exports=function ir(dr,Dt,lr,sr,er,cr){var or,hr=1&Dt,pr=2&Dt,Sr=4&Dt;if(lr&&(or=er?lr(dr,sr,er,cr):lr(dr)),or!==void 0)return or;if(!ze(dr))return dr;var Er=qe(dr);if(Er){if(or=le(dr),!hr)return L(dr,or)}else{var Pr=ue(dr),Cr=Pr=="[object Function]"||Pr=="[object GeneratorFunction]";if(de(dr))return $(dr,hr);if(Pr=="[object Object]"||Pr=="[object Arguments]"||Cr&&!er){if(or=pr||Cr?{}:ae(dr),!hr)return pr?z(dr,k(or,dr)):V(dr,i(or,dr))}else{if(!Et[Pr])return er?dr:{};or=oe(dr,Pr,hr)}}cr||(cr=new n);var rr=cr.get(dr);if(rr)return rr;cr.set(dr,or),$e(dr)?dr.forEach(function(Ir){or.add(ir(Ir,Dt,lr,Ir,dr,cr))}):Ne(dr)&&dr.forEach(function(Ir,xr){or.set(xr,ir(Ir,Dt,lr,xr,dr,cr))});var kr=Er?void 0:(Sr?pr?ie:re:pr?jt:Lt)(dr);return g(kr||dr,function(Ir,xr){kr&&(Ir=dr[xr=Ir]),y(or,xr,ir(Ir,Dt,lr,xr,dr,cr))}),or}},function(t,r,e){var n=e(142),g=e(498),y=e(499),i=e(500),k=e(501),$=e(502);function L(V){var z=this.__data__=new n(V);this.size=z.size}L.prototype.clear=g,L.prototype.delete=y,L.prototype.get=i,L.prototype.has=k,L.prototype.set=$,t.exports=L},function(t,r){t.exports=function(){this.__data__=[],this.size=0}},function(t,r,e){var n=e(143),g=Array.prototype.splice;t.exports=function(y){var i=this.__data__,k=n(i,y);return!(k<0)&&(k==i.length-1?i.pop():g.call(i,k,1),--this.size,!0)}},function(t,r,e){var n=e(143);t.exports=function(g){var y=this.__data__,i=n(y,g);return i<0?void 0:y[i][1]}},function(t,r,e){var n=e(143);t.exports=function(g){return n(this.__data__,g)>-1}},function(t,r,e){var n=e(143);t.exports=function(g,y){var i=this.__data__,k=n(i,g);return k<0?(++this.size,i.push([g,y])):i[k][1]=y,this}},function(t,r,e){var n=e(142);t.exports=function(){this.__data__=new n,this.size=0}},function(t,r){t.exports=function(e){var n=this.__data__,g=n.delete(e);return this.size=n.size,g}},function(t,r){t.exports=function(e){return this.__data__.get(e)}},function(t,r){t.exports=function(e){return this.__data__.has(e)}},function(t,r,e){var n=e(142),g=e(174),y=e(260);t.exports=function(i,k){var $=this.__data__;if($ instanceof n){var L=$.__data__;if(!g||L.length<199)return L.push([i,k]),this.size=++$.size,this;$=this.__data__=new y(L)}return $.set(i,k),this.size=$.size,this}},function(t,r,e){var n=e(257),g=e(506),y=e(91),i=e(259),k=/^\[object .+?Constructor\]$/,$=Function.prototype,L=Object.prototype,V=$.toString,z=L.hasOwnProperty,re=RegExp("^"+V.call(z).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");t.exports=function(ie){return!(!y(ie)||g(ie))&&(n(ie)?re:k).test(i(ie))}},function(t,r,e){var n=e(175),g=Object.prototype,y=g.hasOwnProperty,i=g.toString,k=n?n.toStringTag:void 0;t.exports=function($){var L=y.call($,k),V=$[k];try{$[k]=void 0;var z=!0}catch{}var re=i.call($);return z&&(L?$[k]=V:delete $[k]),re}},function(t,r){var e=Object.prototype.toString;t.exports=function(n){return e.call(n)}},function(t,r,e){var n,g=e(507),y=(n=/[^.]+$/.exec(g&&g.keys&&g.keys.IE_PROTO||""))?"Symbol(src)_1."+n:"";t.exports=function(i){return!!y&&y in i}},function(t,r,e){var n=e(56)["__core-js_shared__"];t.exports=n},function(t,r){t.exports=function(e,n){return e==null?void 0:e[n]}},function(t,r,e){var n=e(510),g=e(142),y=e(174);t.exports=function(){this.size=0,this.__data__={hash:new n,map:new(y||g),string:new n}}},function(t,r,e){var n=e(511),g=e(512),y=e(513),i=e(514),k=e(515);function $(L){var V=-1,z=L==null?0:L.length;for(this.clear();++V<z;){var re=L[V];this.set(re[0],re[1])}}$.prototype.clear=n,$.prototype.delete=g,$.prototype.get=y,$.prototype.has=i,$.prototype.set=k,t.exports=$},function(t,r,e){var n=e(144);t.exports=function(){this.__data__=n?n(null):{},this.size=0}},function(t,r){t.exports=function(e){var n=this.has(e)&&delete this.__data__[e];return this.size-=n?1:0,n}},function(t,r,e){var n=e(144),g=Object.prototype.hasOwnProperty;t.exports=function(y){var i=this.__data__;if(n){var k=i[y];return k==="__lodash_hash_undefined__"?void 0:k}return g.call(i,y)?i[y]:void 0}},function(t,r,e){var n=e(144),g=Object.prototype.hasOwnProperty;t.exports=function(y){var i=this.__data__;return n?i[y]!==void 0:g.call(i,y)}},function(t,r,e){var n=e(144);t.exports=function(g,y){var i=this.__data__;return this.size+=this.has(g)?0:1,i[g]=n&&y===void 0?"__lodash_hash_undefined__":y,this}},function(t,r,e){var n=e(145);t.exports=function(g){var y=n(this,g).delete(g);return this.size-=y?1:0,y}},function(t,r){t.exports=function(e){var n=typeof e;return n=="string"||n=="number"||n=="symbol"||n=="boolean"?e!=="__proto__":e===null}},function(t,r,e){var n=e(145);t.exports=function(g){return n(this,g).get(g)}},function(t,r,e){var n=e(145);t.exports=function(g){return n(this,g).has(g)}},function(t,r,e){var n=e(145);t.exports=function(g,y){var i=n(this,g),k=i.size;return i.set(g,y),this.size+=i.size==k?0:1,this}},function(t,r){t.exports=function(e,n){for(var g=-1,y=e==null?0:e.length;++g<y&&n(e[g],g,e)!==!1;);return e}},function(t,r,e){var n=e(87),g=function(){try{var y=n(Object,"defineProperty");return y({},"",{}),y}catch{}}();t.exports=g},function(t,r,e){var n=e(146),g=e(176);t.exports=function(y,i){return y&&n(i,g(i),y)}},function(t,r){t.exports=function(e,n){for(var g=-1,y=Array(e);++g<e;)y[g]=n(g);return y}},function(t,r,e){var n=e(526),g=e(106),y=Object.prototype,i=y.hasOwnProperty,k=y.propertyIsEnumerable,$=n(function(){return arguments}())?n:function(L){return g(L)&&i.call(L,"callee")&&!k.call(L,"callee")};t.exports=$},function(t,r,e){var n=e(124),g=e(106);t.exports=function(y){return g(y)&&n(y)=="[object Arguments]"}},function(t,r){t.exports=function(){return!1}},function(t,r,e){var n=e(529),g=e(178),y=e(179),i=y&&y.isTypedArray,k=i?g(i):n;t.exports=k},function(t,r,e){var n=e(124),g=e(265),y=e(106),i={};i["[object Float32Array]"]=i["[object Float64Array]"]=i["[object Int8Array]"]=i["[object Int16Array]"]=i["[object Int32Array]"]=i["[object Uint8Array]"]=i["[object Uint8ClampedArray]"]=i["[object Uint16Array]"]=i["[object Uint32Array]"]=!0,i["[object Arguments]"]=i["[object Array]"]=i["[object ArrayBuffer]"]=i["[object Boolean]"]=i["[object DataView]"]=i["[object Date]"]=i["[object Error]"]=i["[object Function]"]=i["[object Map]"]=i["[object Number]"]=i["[object Object]"]=i["[object RegExp]"]=i["[object Set]"]=i["[object String]"]=i["[object WeakMap]"]=!1,t.exports=function(k){return y(k)&&g(k.length)&&!!i[n(k)]}},function(t,r,e){var n=e(180),g=e(531),y=Object.prototype.hasOwnProperty;t.exports=function(i){if(!n(i))return g(i);var k=[];for(var $ in Object(i))y.call(i,$)&&$!="constructor"&&k.push($);return k}},function(t,r,e){var n=e(266)(Object.keys,Object);t.exports=n},function(t,r,e){var n=e(146),g=e(181);t.exports=function(y,i){return y&&n(i,g(i),y)}},function(t,r,e){var n=e(91),g=e(180),y=e(534),i=Object.prototype.hasOwnProperty;t.exports=function(k){if(!n(k))return y(k);var $=g(k),L=[];for(var V in k)(V!="constructor"||!$&&i.call(k,V))&&L.push(V);return L}},function(t,r){t.exports=function(e){var n=[];if(e!=null)for(var g in Object(e))n.push(g);return n}},function(t,r,e){(function(n){var g=e(56),y=r&&!r.nodeType&&r,i=y&&typeof n=="object"&&n&&!n.nodeType&&n,k=i&&i.exports===y?g.Buffer:void 0,$=k?k.allocUnsafe:void 0;n.exports=function(L,V){if(V)return L.slice();var z=L.length,re=$?$(z):new L.constructor(z);return L.copy(re),re}}).call(this,e(147)(t))},function(t,r){t.exports=function(e,n){var g=-1,y=e.length;for(n||(n=Array(y));++g<y;)n[g]=e[g];return n}},function(t,r,e){var n=e(146),g=e(182);t.exports=function(y,i){return n(y,g(y),i)}},function(t,r){t.exports=function(e,n){for(var g=-1,y=e==null?0:e.length,i=0,k=[];++g<y;){var $=e[g];n($,g,e)&&(k[i++]=$)}return k}},function(t,r,e){var n=e(146),g=e(268);t.exports=function(y,i){return n(y,g(y),i)}},function(t,r,e){var n=e(271),g=e(182),y=e(176);t.exports=function(i){return n(i,y,g)}},function(t,r,e){var n=e(271),g=e(268),y=e(181);t.exports=function(i){return n(i,y,g)}},function(t,r,e){var n=e(87)(e(56),"DataView");t.exports=n},function(t,r,e){var n=e(87)(e(56),"Promise");t.exports=n},function(t,r,e){var n=e(87)(e(56),"WeakMap");t.exports=n},function(t,r){var e=Object.prototype.hasOwnProperty;t.exports=function(n){var g=n.length,y=new n.constructor(g);return g&&typeof n[0]=="string"&&e.call(n,"index")&&(y.index=n.index,y.input=n.input),y}},function(t,r,e){var n=e(184),g=e(548),y=e(549),i=e(550),k=e(551);t.exports=function($,L,V){var z=$.constructor;switch(L){case"[object ArrayBuffer]":return n($);case"[object Boolean]":case"[object Date]":return new z(+$);case"[object DataView]":return g($,V);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return k($,V);case"[object Map]":return new z;case"[object Number]":case"[object String]":return new z($);case"[object RegExp]":return y($);case"[object Set]":return new z;case"[object Symbol]":return i($)}}},function(t,r,e){var n=e(56).Uint8Array;t.exports=n},function(t,r,e){var n=e(184);t.exports=function(g,y){var i=y?n(g.buffer):g.buffer;return new g.constructor(i,g.byteOffset,g.byteLength)}},function(t,r){var e=/\w*$/;t.exports=function(n){var g=new n.constructor(n.source,e.exec(n));return g.lastIndex=n.lastIndex,g}},function(t,r,e){var n=e(175),g=n?n.prototype:void 0,y=g?g.valueOf:void 0;t.exports=function(i){return y?Object(y.call(i)):{}}},function(t,r,e){var n=e(184);t.exports=function(g,y){var i=y?n(g.buffer):g.buffer;return new g.constructor(i,g.byteOffset,g.length)}},function(t,r,e){var n=e(553),g=e(270),y=e(180);t.exports=function(i){return typeof i.constructor!="function"||y(i)?{}:n(g(i))}},function(t,r,e){var n=e(91),g=Object.create,y=function(){function i(){}return function(k){if(!n(k))return{};if(g)return g(k);i.prototype=k;var $=new i;return i.prototype=void 0,$}}();t.exports=y},function(t,r,e){var n=e(555),g=e(178),y=e(179),i=y&&y.isMap,k=i?g(i):n;t.exports=k},function(t,r,e){var n=e(183),g=e(106);t.exports=function(y){return g(y)&&n(y)=="[object Map]"}},function(t,r,e){var n=e(557),g=e(178),y=e(179),i=y&&y.isSet,k=i?g(i):n;t.exports=k},function(t,r,e){var n=e(183),g=e(106);t.exports=function(y){return g(y)&&n(y)=="[object Set]"}},function(t,r,e){var n=e(2),g=e(4),y=e(7),i=e(71),k=e(8),$=e(15),L=e(6),V=e(3),z=e(64),re=e(0),ie=e(11),ue=e(45),le={};function oe(){var $e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};!$e.logLevel&&$e.debug&&($e.logLevel="debug"),re.merge(this,{options:$e,debugEnable:!1,api:"log",style:"color:blue;",logLevel:$e.logLevel&&$e.logLevel.toLowerCase()||"off",debug:re.emptyFunc,log:re.emptyFunc,info:re.emptyFunc,warn:re.emptyFunc,error:re.emptyFunc}),this.prefix=$e.prefix||"",this.localEnable=le.enable&&$e.dbLog&&$e.account,this.setDebug($e.debug),this.localEnable&&(this._local=new le($e.account,$e.expire),this._local.logError=this.error)}le=e(567);var ae=oe.prototype,qe=["Chrome","Safari","Firefox"],de={debug:1e3,log:2e3,info:3e3,warn:4e3,error:5e3,off:6e3};function Ne($e){var Lt,jt=[];return n(Lt=g(de)).call(Lt,function(Et){de[Et]>=de[$e]&&jt.push(Et)}),jt}ae.setDebug=function(){var $e=arguments.length>0&&arguments[0]!==void 0&&arguments[0],Lt=this;if(Lt.debugEnable=$e||Lt.logLevel==="debug",$e.style&&(Lt.style=$e.style),re.exist(console)){if(Lt.logLevel!=="off"){var jt=console,Et=Ne(Lt.logLevel);n(Et).call(Et,function(dr){Lt[dr]=function(){var Dt=Lt.formatArgsAndSave(arguments,dr);y(qe).call(qe,z.name)!==-1&&re.isString(Dt[0])&&(Dt[0]="%c"+Dt[0],i(Dt).call(Dt,1,0,Lt.style)),Lt._log(dr,Dt)}}),Lt.options.logFunc?Lt._log=function(){}:Lt._log=function(dr,Dt){if(dr==="debug"&&(dr="log"),jt[dr])try{jt[dr].apply?Lt.chrome(dr,Dt):Lt.ie(dr,Dt)}catch{}},Lt.chrome=function(dr,Dt){y(qe).call(qe,z.name)!==-1?jt[dr].apply(jt,Dt):Lt.ie(dr,Dt)},Lt.ie=function(dr,Dt){n(Dt).call(Dt,function(lr){jt[dr](k(lr,null,4))})}}else if(ie.isRN||this.localEnable||this.options.logFunc){var ir=!ie.isRN&&!this.localEnable;Lt.log=function(){Lt.formatArgsAndSave(arguments,"log",ir)},Lt.info=function(){Lt.formatArgsAndSave(arguments,"info",ir)},Lt.warn=function(){Lt.formatArgsAndSave(arguments,"warn",ir)},Lt.error=function(){Lt.formatArgsAndSave(arguments,"error",ir)},Lt.debug=function(){Lt.formatArgsAndSave(arguments,"log",ir)}}}},ae.destroy=function(){this.localEnable=!1,this.log=function(){},this.info=function(){},this.warn=function(){},this.error=function(){},this.debug=function(){},this._local&&this._local.destroy()},ae.formatArgsAndSave=function($e,Lt,jt){var Et,ir;$e=$([]).call($e,0);var dr=new Date,Dt=ze(dr.getMonth()+1)+"-"+ze(dr.getDate())+" "+ze(dr.getHours())+":"+ze(dr.getMinutes())+":"+ze(dr.getSeconds())+":"+ze(dr.getMilliseconds(),3),lr=L(Et=L(ir="[NIM ".concat(Lt.toUpperCase()," ")).call(ir,Dt," ")).call(Et,this.prefix.toUpperCase(),"]  "),sr="";re.isString($e[0])?$e[0]=lr+$e[0]:i($e).call($e,0,0,lr),n($e).call($e,function(cr,or){re.isArray(cr)||re.isObject(cr)?($e[or]=re.simpleClone(cr),sr+=k($e[or])+" "):sr+=cr+" "});var er=this.options.logFunc;return er&&re.isFunction(er[Lt])&&er[Lt].apply(er,$e),!jt&&this.writeLocalLog(sr,Lt,+dr),$e},ae.writeLocalLog=function($e,Lt,jt){return ie.isRN?this.writeLocalLogRN($e,Lt,jt):ie.isBrowser?this.writeLocalLogBrowser($e,Lt,jt):void 0};var ze=function($e,Lt){Lt=Lt||2;for(var jt=""+$e;jt.length<Lt;)jt="0"+jt;return jt};ae.writeLocalLogBrowser=function($e,Lt,jt){this._local&&this._local.saveLog({log:$e,level:Lt,time:jt})},ae.writeLocalLogRN=function($e,Lt){if(ue.rnfs&&ue.rnfs.writeFile&&ue.rnfs.appendFile&&ue.rnfs.DocumentDirectoryPath&&/error|warn|info/.test(Lt)){var jt,Et=ue.rnfs,ir=Et.size/2-256;$e+=`\r
`,Et.nimPromise=Et.nimPromise.then(function(){return jt=dr(Et.nimIndex),Et.exists(jt)}).then(function(Dt){return Dt?Et.appendFile(jt,$e):Et.writeFile(jt,$e)}).then(function(){return Et.stat(jt)}).then(function(Dt){if(Dt.size>ir)return Et.nimIndex++,Et.nimIndex>1&&(Et.nimIndex=Et.nimIndex%2),Et.unlink(dr(Et.nimIndex)).catch(function(){return V.resolve()})}).catch(function(){})}function dr(Dt){return ue.rnfs.DocumentDirectoryPath+"/nimlog_"+Dt+".log"}},t.exports=oe},function(t,r,e){var n=e(560);t.exports=n},function(t,r,e){e(561);var n=e(13);t.exports=n.parseFloat},function(t,r,e){var n=e(1),g=e(562);n({global:!0,forced:parseFloat!=g},{parseFloat:g})},function(t,r,e){var n=e(14),g=e(5),y=e(12),i=e(50),k=e(185).trim,$=e(148),L=y("".charAt),V=n.parseFloat,z=n.Symbol,re=z&&z.iterator,ie=1/V($+"-0")!=-1/0||re&&!g(function(){V(Object(re))});t.exports=ie?function(ue){var le=k(i(ue)),oe=V(le);return oe===0&&L(le,0)=="-"?-0:oe}:V},function(t,r,e){var n=e(564);t.exports=n},function(t,r,e){e(565);var n=e(13);t.exports=n.parseInt},function(t,r,e){var n=e(1),g=e(566);n({global:!0,forced:parseInt!=g},{parseInt:g})},function(t,r,e){var n=e(14),g=e(5),y=e(12),i=e(50),k=e(185).trim,$=e(148),L=n.parseInt,V=n.Symbol,z=V&&V.iterator,re=/^[+-]?0x/i,ie=y(re.exec),ue=L($+"08")!==8||L($+"0x16")!==22||z&&!g(function(){L(Object(z))});t.exports=ue?function(le,oe){var ae=k(i(le));return L(ae,oe>>>0||(ie(re,ae)?16:10))}:L},function(t,r,e){var n=e(15),g=e(24),y=e(3),i=e(568),k=e(569),$=e(0).getGlobal(),L=e(64).name,V=typeof i=="function",z=$.indexedDB&&!/^(IE)$/.test(L);function re(ue,le){this.logWorker=null,this.db=null,this.logQueue=[],this.callbackList=[],this.preTime=null,this.lastTime=+new Date,this.saveLogTimer=void 0,this.initLogLocal({name:ue,expire:le})}var ie=re.prototype;re.enable=!0,ie.saveLog=function(ue){var le=this;try{if(!re.enable)return;var oe,ae=this.logQueue.length,qe=this.logQueue[ae-1];if(ue.time===this.preTime&&qe)return void(qe.log+=`\r
`+ue.log);this.logQueue.length>50||ue.time-this.lastTime>3e3&&this.logQueue.length>0?(this.doSaveLog(n(oe=this.logQueue).call(oe,0)),this.lastTime=qe.time,this.logQueue=[],clearTimeout(this.saveLogTimer)):(clearTimeout(this.saveLogTimer),this.saveLogTimer=g(function(){var de;le.logQueue.length>0&&(qe=le.logQueue[le.logQueue.length-1],le.doSaveLog(n(de=le.logQueue).call(de,0)),le.lastTime=qe.time,le.logQueue=[])},3e3-(ue.time-this.lastTime))),this.logQueue.push(ue),this.preTime=ue.time}catch(de){console.error("saveLog Error",de)}},ie.destroy=function(){if(this.logQueue.length>0){var ue,le=this.logQueue[this.logQueue.length-1];this.doSaveLog(n(ue=this.logQueue).call(ue,0)),this.lastTime=le.time,this.logQueue=[]}clearTimeout(this.saveLogTimer)},ie.doSaveLog=function(){},ie.initLogLocal=function(){},ie.fetchLog=function(){},ie.deleteLogs=function(){},ie.logError=function(){},z?V?(ie.doSaveLog=function(ue){this.logWorker.postMessage(ue)},ie.initLogLocal=function(ue){var le=this;this.logWorker=new i({}),this.logWorker.onmessage=function(oe){var ae=oe.data||{};switch(ae.type){case"fetchDone":le.fetchLogDone(ae.code,ae.msg);break;case"error":le.logError(ae.msg)}},this.logWorker.postMessage({type:"init",msg:ue})},ie.fetchLog=function(){var ue=this;return new y(function(le,oe){ue.callbackList.length===0&&ue.logWorker.postMessage({type:"fetch"}),ue.callbackList.push(le),ue.callbackList.push(oe)})},ie.fetchLogDone=function(ue,le){for(var oe=ue===200?0:1,ae=0;ae<this.callbackList.length/2;ae++)this.callbackList[2*ae+oe](le);this.callbackList=[]},ie.deleteLogs=function(ue){return this.logWorker.postMessage({type:"delete",msg:ue}),y.resolve()}):(ie.doSaveLog=function(ue){var le=this;this.db.putLog(ue).catch(function(oe){le.logError({msg:"putLog error",error:oe})})},ie.initLogLocal=function(ue){var le=this;this.db=new k(ue),this.db.init().catch(function(oe){le.logError({msg:"dbLog init error",error:oe})})},ie.fetchLog=function(){return this.db.getAllLogs()},ie.deleteLogs=function(ue){return this.db.deleteLogs(ue)}):re.enable=!1,t.exports=re},function(t,r,e){e.r(r),e.d(r,"default",function(){return y});var n=e(298),g=e.n(n);function y(){return g()(`/*!
 * 
 * VERSION: 9.14.4
 * Git Hash: 98d1c9786af772ff439f12534089825e2c3c6776
 * 
 * Create At: 2024/2/23 下午3:43:35
 * 
 * Target: NIM_Web_log.worker
 */!function(t){var n={};function r(e){if(n[e])return n[e].exports;var o=n[e]={i:e,l:!1,exports:{}};return t[e].call(o.exports,o,o.exports,r),o.l=!0,o.exports}r.m=t,r.c=n,r.d=function(t,n,e){r.o(t,n)||Object.defineProperty(t,n,{enumerable:!0,get:e})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,n){if(1&n&&(t=r(t)),8&n)return t;if(4&n&&"object"==typeof t&&t&&t.__esModule)return t;var e=Object.create(null);if(r.r(e),Object.defineProperty(e,"default",{enumerable:!0,value:t}),2&n&&"string"!=typeof t)for(var o in t)r.d(e,o,function(n){return t[n]}.bind(null,o));return e},r.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(n,"a",n),n},r.o=function(t,n){return Object.prototype.hasOwnProperty.call(t,n)},r.p="",r(r.s=109)}([function(t,n,r){"use strict";var e=r(1),o=r(41),i=r(78),c=r(2),u=r(43).f,a=r(84),f=r(13),s=r(34),p=r(19),l=r(8),v=function(t){var n=function(r,e,i){if(this instanceof n){switch(arguments.length){case 0:return new t;case 1:return new t(r);case 2:return new t(r,e)}return new t(r,e,i)}return o(t,this,arguments)};return n.prototype=t.prototype,n};t.exports=function(t,n){var r,o,d,y,h,m,g,x,b,w=t.target,S=t.global,j=t.stat,O=t.proto,P=S?e:j?e[w]:(e[w]||{}).prototype,T=S?f:f[w]||p(f,w,{})[w],A=T.prototype;for(y in n)o=!(r=a(S?y:w+(j?".":"#")+y,t.forced))&&P&&l(P,y),m=T[y],o&&(g=t.dontCallGetSet?(b=u(P,y))&&b.value:P[y]),h=o&&g?g:n[y],o&&typeof m==typeof h||(x=t.bind&&o?s(h,e):t.wrap&&o?v(h):O&&c(h)?i(h):h,(t.sham||h&&h.sham||m&&m.sham)&&p(x,"sham",!0),p(T,y,x),O&&(l(f,d=w+"Prototype")||p(f,d,{}),p(f[d],y,h),t.real&&A&&(r||!A[y])&&p(A,y,h)))}},function(t,n,r){(function(n){var r=function(t){return t&&t.Math==Math&&t};t.exports=r("object"==typeof globalThis&&globalThis)||r("object"==typeof window&&window)||r("object"==typeof self&&self)||r("object"==typeof n&&n)||function(){return this}()||Function("return this")()}).call(this,r(77))},function(t,n,r){var e=r(79),o=e.all;t.exports=e.IS_HTMLDDA?function(t){return"function"==typeof t||t===o}:function(t){return"function"==typeof t}},function(t,n,r){var e=r(13),o=r(8),i=r(75),c=r(16).f;t.exports=function(t){var n=e.Symbol||(e.Symbol={});o(n,t)||c(n,t,{value:i.f(t)})}},function(t,n,r){var e=r(1),o=r(33),i=r(8),c=r(60),u=r(24),a=r(82),f=o("wks"),s=e.Symbol,p=s&&s.for,l=a?s:s&&s.withoutSetter||c;t.exports=function(t){if(!i(f,t)||!u&&"string"!=typeof f[t]){var n="Symbol."+t;u&&i(s,t)?f[t]=s[t]:f[t]=a&&p?p(n):l(n)}return f[t]}},function(t,n){t.exports=function(t){try{return!!t()}catch(t){return!0}}},function(t,n,r){var e=r(42),o=Function.prototype,i=o.call,c=e&&o.bind.bind(i,i);t.exports=e?c:function(t){return function(){return i.apply(t,arguments)}}},function(t,n,r){var e=r(42),o=Function.prototype.call;t.exports=e?o.bind(o):function(){return o.apply(o,arguments)}},function(t,n,r){var e=r(6),o=r(25),i=e({}.hasOwnProperty);t.exports=Object.hasOwn||function(t,n){return i(o(t),n)}},function(t,n,r){var e=r(13),o=r(1),i=r(2),c=function(t){return i(t)?t:void 0};t.exports=function(t,n){return arguments.length<2?c(e[t])||c(o[t]):e[t]&&e[t][n]||o[t]&&o[t][n]}},function(t,n,r){var e=r(2),o=r(79),i=o.all;t.exports=o.IS_HTMLDDA?function(t){return"object"==typeof t?null!==t:e(t)||t===i}:function(t){return"object"==typeof t?null!==t:e(t)}},function(t,n,r){var e=r(5);t.exports=!e((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]}))},function(t,n,r){var e=r(10),o=String,i=TypeError;t.exports=function(t){if(e(t))return t;throw i(o(t)+" is not an object")}},function(t,n){t.exports={}},function(t,n,r){var e=r(6);t.exports=e({}.isPrototypeOf)},function(t,n){t.exports=!0},function(t,n,r){var e=r(11),o=r(83),i=r(85),c=r(12),u=r(45),a=TypeError,f=Object.defineProperty,s=Object.getOwnPropertyDescriptor;n.f=e?i?function(t,n,r){if(c(t),n=u(n),c(r),"function"==typeof t&&"prototype"===n&&"value"in r&&"writable"in r&&!r.writable){var e=s(t,n);e&&e.writable&&(t[n]=r.value,r={configurable:"configurable"in r?r.configurable:e.configurable,enumerable:"enumerable"in r?r.enumerable:e.enumerable,writable:!1})}return f(t,n,r)}:f:function(t,n,r){if(c(t),n=u(n),c(r),o)try{return f(t,n,r)}catch(t){}if("get"in r||"set"in r)throw a("Accessors not supported");return"value"in r&&(t[n]=r.value),t}},function(t,n,r){var e=r(2),o=r(32),i=TypeError;t.exports=function(t){if(e(t))return t;throw i(o(t)+" is not a function")}},function(t,n,r){var e=r(81),o=r(57);t.exports=function(t){return e(o(t))}},function(t,n,r){var e=r(11),o=r(16),i=r(20);t.exports=e?function(t,n,r){return o.f(t,n,i(1,r))}:function(t,n,r){return t[n]=r,t}},function(t,n){t.exports=function(t,n){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:n}}},function(t,n,r){var e=r(19);t.exports=function(t,n,r,o){return o&&o.enumerable?t[n]=r:e(t,n,r),t}},function(t,n,r){"use strict";var e=r(17),o=TypeError,i=function(t){var n,r;this.promise=new t((function(t,e){if(void 0!==n||void 0!==r)throw o("Bad Promise constructor");n=t,r=e})),this.resolve=e(n),this.reject=e(r)};t.exports.f=function(t){return new i(t)}},function(t,n,r){var e=r(6),o=e({}.toString),i=e("".slice);t.exports=function(t){return i(o(t),8,-1)}},function(t,n,r){var e=r(47),o=r(5);t.exports=!!Object.getOwnPropertySymbols&&!o((function(){var t=Symbol();return!String(t)||!(Object(t)instanceof Symbol)||!Symbol.sham&&e&&e<41}))},function(t,n,r){var e=r(57),o=Object;t.exports=function(t){return o(e(t))}},function(t,n,r){var e=r(124);t.exports=function(t){return e(t.length)}},function(t,n){t.exports={}},function(t,n,r){var e=r(70),o=r(2),i=r(23),c=r(4)("toStringTag"),u=Object,a="Arguments"==i(function(){return arguments}());t.exports=e?i:function(t){var n,r,e;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(r=function(t,n){try{return t[n]}catch(t){}}(n=u(t),c))?r:a?i(n):"Object"==(e=i(n))&&o(n.callee)?"Arguments":e}},function(t,n,r){var e=r(70),o=r(16).f,i=r(19),c=r(8),u=r(136),a=r(4)("toStringTag");t.exports=function(t,n,r,f){if(t){var s=r?t:t.prototype;c(s,a)||o(s,a,{configurable:!0,value:n}),f&&!e&&i(s,"toString",u)}}},function(t,n,r){var e=r(1);t.exports=e.Promise},function(t,n,r){var e=r(9);t.exports=e("navigator","userAgent")||""},function(t,n){var r=String;t.exports=function(t){try{return r(t)}catch(t){return"Object"}}},function(t,n,r){var e=r(15),o=r(59);(t.exports=function(t,n){return o[t]||(o[t]=void 0!==n?n:{})})("versions",[]).push({version:"3.27.1",mode:e?"pure":"global",copyright:"© 2014-2022 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.27.1/LICENSE",source:"https://github.com/zloirock/core-js"})},function(t,n,r){var e=r(78),o=r(17),i=r(42),c=e(e.bind);t.exports=function(t,n){return o(t),void 0===n?t:i?c(t,n):function(){return t.apply(n,arguments)}}},function(t,n,r){var e=r(34),o=r(7),i=r(12),c=r(32),u=r(127),a=r(26),f=r(14),s=r(128),p=r(89),l=r(129),v=TypeError,d=function(t,n){this.stopped=t,this.result=n},y=d.prototype;t.exports=function(t,n,r){var h,m,g,x,b,w,S,j=r&&r.that,O=!(!r||!r.AS_ENTRIES),P=!(!r||!r.IS_RECORD),T=!(!r||!r.IS_ITERATOR),A=!(!r||!r.INTERRUPTED),E=e(n,j),k=function(t){return h&&l(h,"normal",t),new d(!0,t)},I=function(t){return O?(i(t),A?E(t[0],t[1],k):E(t[0],t[1])):A?E(t,k):E(t)};if(P)h=t.iterator;else if(T)h=t;else{if(!(m=p(t)))throw v(c(t)+" is not iterable");if(u(m)){for(g=0,x=a(t);x>g;g++)if((b=I(t[g]))&&f(y,b))return b;return new d(!1)}h=s(t,m)}for(w=P?t.next:h.next;!(S=o(w,h)).done;){try{b=I(S.value)}catch(t){l(h,"throw",t)}if("object"==typeof b&&b&&f(y,b))return b}return new d(!1)}},function(t,n,r){var e=r(28),o=String;t.exports=function(t){if("Symbol"===e(t))throw TypeError("Cannot convert a Symbol value to a string");return o(t)}},function(t,n){t.exports=function(t){try{return{error:!1,value:t()}}catch(t){return{error:!0,value:t}}}},function(t,n,r){var e=r(1),o=r(30),i=r(2),c=r(84),u=r(94),a=r(4),f=r(147),s=r(98),p=r(15),l=r(47),v=o&&o.prototype,d=a("species"),y=!1,h=i(e.PromiseRejectionEvent),m=c("Promise",(function(){var t=u(o),n=t!==String(o);if(!n&&66===l)return!0;if(p&&(!v.catch||!v.finally))return!0;if(!l||l<51||!/native code/.test(t)){var r=new o((function(t){t(1)})),e=function(t){t((function(){}),(function(){}))};if((r.constructor={})[d]=e,!(y=r.then((function(){}))instanceof e))return!0}return!n&&(f||s)&&!h}));t.exports={CONSTRUCTOR:m,REJECTION_EVENT:h,SUBCLASSING:y}},function(t,n,r){var e=r(23);t.exports=Array.isArray||function(t){return"Array"==e(t)}},function(t,n,r){var e=r(13);t.exports=function(t){return e[t+"Prototype"]}},function(t,n,r){var e=r(42),o=Function.prototype,i=o.apply,c=o.call;t.exports="object"==typeof Reflect&&Reflect.apply||(e?c.bind(i):function(){return c.apply(i,arguments)})},function(t,n,r){var e=r(5);t.exports=!e((function(){var t=function(){}.bind();return"function"!=typeof t||t.hasOwnProperty("prototype")}))},function(t,n,r){var e=r(11),o=r(7),i=r(80),c=r(20),u=r(18),a=r(45),f=r(8),s=r(83),p=Object.getOwnPropertyDescriptor;n.f=e?p:function(t,n){if(t=u(t),n=a(n),s)try{return p(t,n)}catch(t){}if(f(t,n))return c(!o(i.f,t,n),t[n])}},function(t,n){t.exports=function(t){return null==t}},function(t,n,r){var e=r(115),o=r(46);t.exports=function(t){var n=e(t,"string");return o(n)?n:n+""}},function(t,n,r){var e=r(9),o=r(2),i=r(14),c=r(82),u=Object;t.exports=c?function(t){return"symbol"==typeof t}:function(t){var n=e("Symbol");return o(n)&&i(n.prototype,u(t))}},function(t,n,r){var e,o,i=r(1),c=r(31),u=i.process,a=i.Deno,f=u&&u.versions||a&&a.version,s=f&&f.v8;s&&(o=(e=s.split("."))[0]>0&&e[0]<4?1:+(e[0]+e[1])),!o&&c&&(!(e=c.match(/Edge\\/(\\d+)/))||e[1]>=74)&&(e=c.match(/Chrome\\/(\\d+)/))&&(o=+e[1]),t.exports=o},function(t,n,r){var e=r(33),o=r(60),i=e("keys");t.exports=function(t){return i[t]||(i[t]=o(t))}},function(t,n){t.exports={}},function(t,n,r){var e,o=r(12),i=r(87),c=r(67),u=r(49),a=r(88),f=r(61),s=r(48),p=s("IE_PROTO"),l=function(){},v=function(t){return"<script>"+t+"<\\/script>"},d=function(t){t.write(v("")),t.close();var n=t.parentWindow.Object;return t=null,n},y=function(){try{e=new ActiveXObject("htmlfile")}catch(t){}var t,n;y="undefined"!=typeof document?document.domain&&e?d(e):((n=f("iframe")).style.display="none",a.appendChild(n),n.src=String("javascript:"),(t=n.contentWindow.document).open(),t.write(v("document.F=Object")),t.close(),t.F):d(e);for(var r=c.length;r--;)delete y.prototype[c[r]];return y()};u[p]=!0,t.exports=Object.create||function(t,n){var r;return null!==t?(l.prototype=o(t),r=new l,l.prototype=null,r[p]=t):r=y(),void 0===n?r:i.f(r,n)}},function(t,n,r){var e,o,i,c=r(133),u=r(1),a=r(10),f=r(19),s=r(8),p=r(59),l=r(48),v=r(49),d=u.TypeError,y=u.WeakMap;if(c||p.state){var h=p.state||(p.state=new y);h.get=h.get,h.has=h.has,h.set=h.set,e=function(t,n){if(h.has(t))throw d("Object already initialized");return n.facade=t,h.set(t,n),n},o=function(t){return h.get(t)||{}},i=function(t){return h.has(t)}}else{var m=l("state");v[m]=!0,e=function(t,n){if(s(t,m))throw d("Object already initialized");return n.facade=t,f(t,m,n),n},o=function(t){return s(t,m)?t[m]:{}},i=function(t){return s(t,m)}}t.exports={set:e,get:o,has:i,enforce:function(t){return i(t)?o(t):e(t,{})},getterFor:function(t){return function(n){var r;if(!a(n)||(r=o(n)).type!==t)throw d("Incompatible receiver, "+t+" required");return r}}}},function(t,n,r){var e=r(23),o=r(1);t.exports="process"==e(o.process)},function(t,n,r){var e=r(6);t.exports=e([].slice)},function(t,n,r){r(71);var e=r(158),o=r(1),i=r(28),c=r(19),u=r(27),a=r(4)("toStringTag");for(var f in e){var s=o[f],p=s&&s.prototype;p&&i(p)!==a&&c(p,a,f),u[f]=u.Array}},function(t,n,r){var e=r(5),o=r(4),i=r(47),c=o("species");t.exports=function(t){return i>=51||!e((function(){var n=[];return(n.constructor={})[c]=function(){return{foo:1}},1!==n[t](Boolean).foo}))}},function(t,n,r){var e=r(34),o=r(6),i=r(81),c=r(25),u=r(26),a=r(103),f=o([].push),s=function(t){var n=1==t,r=2==t,o=3==t,s=4==t,p=6==t,l=7==t,v=5==t||p;return function(d,y,h,m){for(var g,x,b=c(d),w=i(b),S=e(y,h),j=u(w),O=0,P=m||a,T=n?P(d,j):r||l?P(d,0):void 0;j>O;O++)if((v||O in w)&&(x=S(g=w[O],O,b),t))if(n)T[O]=x;else if(x)switch(t){case 3:return!0;case 5:return g;case 6:return O;case 2:f(T,g)}else switch(t){case 4:return!1;case 7:f(T,g)}return p?-1:o||s?s:T}};t.exports={forEach:s(0),map:s(1),filter:s(2),some:s(3),every:s(4),find:s(5),findIndex:s(6),filterReject:s(7)}},function(t,n,r){var e=r(44),o=TypeError;t.exports=function(t){if(e(t))throw o("Can't call method on "+t);return t}},function(t,n,r){var e=r(17),o=r(44);t.exports=function(t,n){var r=t[n];return o(r)?void 0:e(r)}},function(t,n,r){var e=r(1),o=r(117),i=e["__core-js_shared__"]||o("__core-js_shared__",{});t.exports=i},function(t,n,r){var e=r(6),o=0,i=Math.random(),c=e(1..toString);t.exports=function(t){return"Symbol("+(void 0===t?"":t)+")_"+c(++o+i,36)}},function(t,n,r){var e=r(1),o=r(10),i=e.document,c=o(i)&&o(i.createElement);t.exports=function(t){return c?i.createElement(t):{}}},function(t,n,r){var e=r(8),o=r(2),i=r(25),c=r(48),u=r(118),a=c("IE_PROTO"),f=Object,s=f.prototype;t.exports=u?f.getPrototypeOf:function(t){var n=i(t);if(e(n,a))return n[a];var r=n.constructor;return o(r)&&n instanceof r?r.prototype:n instanceof f?s:null}},function(t,n,r){var e=r(6),o=r(12),i=r(119);t.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var t,n=!1,r={};try{(t=e(Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set))(r,[]),n=r instanceof Array}catch(t){}return function(r,e){return o(r),i(e),n?t(r,e):r.__proto__=e,r}}():void 0)},function(t,n,r){var e=r(86),o=r(67).concat("length","prototype");n.f=Object.getOwnPropertyNames||function(t){return e(t,o)}},function(t,n,r){var e=r(66),o=Math.max,i=Math.min;t.exports=function(t,n){var r=e(t);return r<0?o(r+n,0):i(r,n)}},function(t,n,r){var e=r(123);t.exports=function(t){var n=+t;return n!=n||0===n?0:e(n)}},function(t,n){t.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},function(t,n){n.f=Object.getOwnPropertySymbols},function(t,n,r){var e=r(86),o=r(67);t.exports=Object.keys||function(t){return e(t,o)}},function(t,n,r){var e={};e[r(4)("toStringTag")]="z",t.exports="[object z]"===String(e)},function(t,n,r){"use strict";var e=r(18),o=r(132),i=r(27),c=r(51),u=r(16).f,a=r(90),f=r(92),s=r(15),p=r(11),l=c.set,v=c.getterFor("Array Iterator");t.exports=a(Array,"Array",(function(t,n){l(this,{type:"Array Iterator",target:e(t),index:0,kind:n})}),(function(){var t=v(this),n=t.target,r=t.kind,e=t.index++;return!n||e>=n.length?(t.target=void 0,f(void 0,!0)):f("keys"==r?e:"values"==r?n[e]:[e,n[e]],!1)}),"values");var d=i.Arguments=i.Array;if(o("keys"),o("values"),o("entries"),!s&&p&&"values"!==d.name)try{u(d,"name",{value:"values"})}catch(t){}},function(t,n){},function(t,n,r){var e=r(6),o=r(5),i=r(2),c=r(28),u=r(9),a=r(94),f=function(){},s=[],p=u("Reflect","construct"),l=/^\\s*(?:class|function)\\b/,v=e(l.exec),d=!l.exec(f),y=function(t){if(!i(t))return!1;try{return p(f,s,t),!0}catch(t){return!1}},h=function(t){if(!i(t))return!1;switch(c(t)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return d||!!v(l,a(t))}catch(t){return!0}};h.sham=!0,t.exports=!p||o((function(){var t;return y(y.call)||!y(Object)||!y((function(){t=!0}))||t}))?h:y},function(t,n,r){"use strict";var e=r(45),o=r(16),i=r(20);t.exports=function(t,n,r){var c=e(n);c in t?o.f(t,c,i(0,r)):t[c]=r}},function(t,n,r){var e=r(4);n.f=e},function(t,n,r){t.exports=r(111)},function(t,n){var r;r=function(){return this}();try{r=r||new Function("return this")()}catch(t){"object"==typeof window&&(r=window)}t.exports=r},function(t,n,r){var e=r(23),o=r(6);t.exports=function(t){if("Function"===e(t))return o(t)}},function(t,n){var r="object"==typeof document&&document.all,e=void 0===r&&void 0!==r;t.exports={all:r,IS_HTMLDDA:e}},function(t,n,r){"use strict";var e={}.propertyIsEnumerable,o=Object.getOwnPropertyDescriptor,i=o&&!e.call({1:2},1);n.f=i?function(t){var n=o(this,t);return!!n&&n.enumerable}:e},function(t,n,r){var e=r(6),o=r(5),i=r(23),c=Object,u=e("".split);t.exports=o((function(){return!c("z").propertyIsEnumerable(0)}))?function(t){return"String"==i(t)?u(t,""):c(t)}:c},function(t,n,r){var e=r(24);t.exports=e&&!Symbol.sham&&"symbol"==typeof Symbol.iterator},function(t,n,r){var e=r(11),o=r(5),i=r(61);t.exports=!e&&!o((function(){return 7!=Object.defineProperty(i("div"),"a",{get:function(){return 7}}).a}))},function(t,n,r){var e=r(5),o=r(2),i=/#|\\.prototype\\./,c=function(t,n){var r=a[u(t)];return r==s||r!=f&&(o(n)?e(n):!!n)},u=c.normalize=function(t){return String(t).replace(i,".").toLowerCase()},a=c.data={},f=c.NATIVE="N",s=c.POLYFILL="P";t.exports=c},function(t,n,r){var e=r(11),o=r(5);t.exports=e&&o((function(){return 42!=Object.defineProperty((function(){}),"prototype",{value:42,writable:!1}).prototype}))},function(t,n,r){var e=r(6),o=r(8),i=r(18),c=r(122).indexOf,u=r(49),a=e([].push);t.exports=function(t,n){var r,e=i(t),f=0,s=[];for(r in e)!o(u,r)&&o(e,r)&&a(s,r);for(;n.length>f;)o(e,r=n[f++])&&(~c(s,r)||a(s,r));return s}},function(t,n,r){var e=r(11),o=r(85),i=r(16),c=r(12),u=r(18),a=r(69);n.f=e&&!o?Object.defineProperties:function(t,n){c(t);for(var r,e=u(n),o=a(n),f=o.length,s=0;f>s;)i.f(t,r=o[s++],e[r]);return t}},function(t,n,r){var e=r(9);t.exports=e("document","documentElement")},function(t,n,r){var e=r(28),o=r(58),i=r(44),c=r(27),u=r(4)("iterator");t.exports=function(t){if(!i(t))return o(t,u)||o(t,"@@iterator")||c[e(t)]}},function(t,n,r){"use strict";var e=r(0),o=r(7),i=r(15),c=r(134),u=r(2),a=r(135),f=r(62),s=r(63),p=r(29),l=r(19),v=r(21),d=r(4),y=r(27),h=r(91),m=c.PROPER,g=c.CONFIGURABLE,x=h.IteratorPrototype,b=h.BUGGY_SAFARI_ITERATORS,w=d("iterator"),S=function(){return this};t.exports=function(t,n,r,c,d,h,j){a(r,n,c);var O,P,T,A=function(t){if(t===d&&L)return L;if(!b&&t in I)return I[t];switch(t){case"keys":case"values":case"entries":return function(){return new r(this,t)}}return function(){return new r(this)}},E=n+" Iterator",k=!1,I=t.prototype,D=I[w]||I["@@iterator"]||d&&I[d],L=!b&&D||A(d),_="Array"==n&&I.entries||D;if(_&&(O=f(_.call(new t)))!==Object.prototype&&O.next&&(i||f(O)===x||(s?s(O,x):u(O[w])||v(O,w,S)),p(O,E,!0,!0),i&&(y[E]=S)),m&&"values"==d&&D&&"values"!==D.name&&(!i&&g?l(I,"name","values"):(k=!0,L=function(){return o(D,this)})),d)if(P={values:A("values"),keys:h?L:A("keys"),entries:A("entries")},j)for(T in P)(b||k||!(T in I))&&v(I,T,P[T]);else e({target:n,proto:!0,forced:b||k},P);return i&&!j||I[w]===L||v(I,w,L,{name:d}),y[n]=L,P}},function(t,n,r){"use strict";var e,o,i,c=r(5),u=r(2),a=r(10),f=r(50),s=r(62),p=r(21),l=r(4),v=r(15),d=l("iterator"),y=!1;[].keys&&("next"in(i=[].keys())?(o=s(s(i)))!==Object.prototype&&(e=o):y=!0),!a(e)||c((function(){var t={};return e[d].call(t)!==t}))?e={}:v&&(e=f(e)),u(e[d])||p(e,d,(function(){return this})),t.exports={IteratorPrototype:e,BUGGY_SAFARI_ITERATORS:y}},function(t,n){t.exports=function(t,n){return{value:t,done:n}}},function(t,n,r){var e=r(12),o=r(141),i=r(44),c=r(4)("species");t.exports=function(t,n){var r,u=e(t).constructor;return void 0===u||i(r=e(u)[c])?n:o(r)}},function(t,n,r){var e=r(6),o=r(2),i=r(59),c=e(Function.toString);o(i.inspectSource)||(i.inspectSource=function(t){return c(t)}),t.exports=i.inspectSource},function(t,n,r){var e,o,i,c,u=r(1),a=r(41),f=r(34),s=r(2),p=r(8),l=r(5),v=r(88),d=r(53),y=r(61),h=r(96),m=r(97),g=r(52),x=u.setImmediate,b=u.clearImmediate,w=u.process,S=u.Dispatch,j=u.Function,O=u.MessageChannel,P=u.String,T=0,A={};try{e=u.location}catch(t){}var E=function(t){if(p(A,t)){var n=A[t];delete A[t],n()}},k=function(t){return function(){E(t)}},I=function(t){E(t.data)},D=function(t){u.postMessage(P(t),e.protocol+"//"+e.host)};x&&b||(x=function(t){h(arguments.length,1);var n=s(t)?t:j(t),r=d(arguments,1);return A[++T]=function(){a(n,void 0,r)},o(T),T},b=function(t){delete A[t]},g?o=function(t){w.nextTick(k(t))}:S&&S.now?o=function(t){S.now(k(t))}:O&&!m?(c=(i=new O).port2,i.port1.onmessage=I,o=f(c.postMessage,c)):u.addEventListener&&s(u.postMessage)&&!u.importScripts&&e&&"file:"!==e.protocol&&!l(D)?(o=D,u.addEventListener("message",I,!1)):o="onreadystatechange"in y("script")?function(t){v.appendChild(y("script")).onreadystatechange=function(){v.removeChild(this),E(t)}}:function(t){setTimeout(k(t),0)}),t.exports={set:x,clear:b}},function(t,n){var r=TypeError;t.exports=function(t,n){if(t<n)throw r("Not enough arguments");return t}},function(t,n,r){var e=r(31);t.exports=/(?:ipad|iphone|ipod).*applewebkit/i.test(e)},function(t,n){t.exports="object"==typeof Deno&&Deno&&"object"==typeof Deno.version},function(t,n,r){var e=r(30),o=r(149),i=r(38).CONSTRUCTOR;t.exports=i||!o((function(t){e.all(t).then(void 0,(function(){}))}))},function(t,n,r){var e=r(12),o=r(10),i=r(22);t.exports=function(t,n){if(e(t),o(n)&&n.constructor===t)return n;var r=i.f(t);return(0,r.resolve)(n),r.promise}},function(t,n,r){"use strict";var e=r(157).charAt,o=r(36),i=r(51),c=r(90),u=r(92),a=i.set,f=i.getterFor("String Iterator");c(String,"String",(function(t){a(this,{type:"String Iterator",string:o(t),index:0})}),(function(){var t,n=f(this),r=n.string,o=n.index;return o>=r.length?u(void 0,!0):(t=e(r,o),n.index+=t.length,u(t,!1))}))},function(t,n,r){t.exports=r(159)},function(t,n,r){var e=r(168);t.exports=function(t,n){return new(e(t))(0===n?0:n)}},function(t,n,r){"use strict";var e=r(0),o=r(5),i=r(39),c=r(10),u=r(25),a=r(26),f=r(177),s=r(74),p=r(103),l=r(55),v=r(4),d=r(47),y=v("isConcatSpreadable"),h=d>=51||!o((function(){var t=[];return t[y]=!1,t.concat()[0]!==t})),m=l("concat"),g=function(t){if(!c(t))return!1;var n=t[y];return void 0!==n?!!n:i(t)};e({target:"Array",proto:!0,arity:1,forced:!h||!m},{concat:function(t){var n,r,e,o,i,c=u(this),l=p(c,0),v=0;for(n=-1,e=arguments.length;n<e;n++)if(g(i=-1===n?c:arguments[n]))for(o=a(i),f(v+o),r=0;r<o;r++,v++)r in i&&s(l,v,i[r]);else f(v+1),s(l,v++,i);return l.length=v,l}})},function(t,n,r){var e=r(7),o=r(9),i=r(4),c=r(21);t.exports=function(){var t=o("Symbol"),n=t&&t.prototype,r=n&&n.valueOf,u=i("toPrimitive");n&&!n[u]&&c(n,u,(function(t){return e(r,this)}),{arity:1})}},function(t,n,r){var e=r(24);t.exports=e&&!!Symbol.for&&!!Symbol.keyFor},function(t,n,r){r(3)("iterator")},function(t,n,r){"use strict";var e,o=r(1),i=r(41),c=r(2),u=r(220),a=r(31),f=r(53),s=r(96),p=o.Function,l=/MSIE .\\./.test(a)||u&&((e=o.Bun.version.split(".")).length<3||0==e[0]&&(e[1]<3||3==e[1]&&0==e[2]));t.exports=function(t,n){var r=n?2:1;return l?function(e,o){var u=s(arguments.length,1)>r,a=c(e)?e:p(e),l=u?f(arguments,r):[],v=u?function(){i(a,this,l)}:a;return n?t(v,o):t(v)}:t}},function(t,n,r){var e=r(110),o=null;function i(t){return t&&"string"!=typeof t?t.message?t.message:t.target&&t.target.error?t.target.error.message:"unknown error":t}self.onmessage=function(t){switch(t.data.type){case"init":r=t.data.msg,(o=new e(r)).init().catch((function(t){postMessage({type:"error",msg:{msg:"dbLog init error",error:i(t)}})}));break;case"fetch":o.getAllLogs().then((function(t){postMessage({type:"fetchDone",code:200,msg:t})})).catch((function(t){postMessage({type:"fetchDone",code:500,msg:i(t)})}));break;case"delete":o.deleteLogs(n).catch((function(t){postMessage({type:"deleteLogs",code:500,msg:i(t)})}));break;default:!function(t){if(!o)return;o.putLog(t).then((function(){postMessage(200)})).catch((function(t){postMessage({type:"error",msg:{msg:"putLog error",error:i(t)}})}))}(t.data)}var n,r}},function(t,n,r){var e=r(76),o=r(102),i=r(163),c=r(169),u={log:{key:{keyPath:"time"},indexes:{level:{unique:!1},time:{unique:!0}}}};function a(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.server=null,this.expire=t.expire||72,this.name=t.name}var f=a.prototype;f.init=function(){var t=this;if(!this.server)return c.open({server:"nim-log-"+this.name,version:1,schema:u}).then((function(n){t.server=n}))},f.putLog=function(t){var n=this;if(!this.server)return e.reject("no db server");var r=o(t).call(t,-1)[0].time-36e5*this.expire;return this.deleteLogs(r).then((function(){return n.server.add("log",t)}))},f.getAllLogs=function(){return this.server?this.server.query("log","time").all().execute().then((function(t){var n={},r=o(t).call(t,-1)[0];return n.logs=i(t).call(t,(function(t){return t.log})).join("\\r\\n"),n.time=r&&r.time,n})):e.reject("no db server")},f.deleteLogs=function(t){return this.server?this.server.remove("log",null,"time",0,t):e.reject("no db server")},t.exports=a},function(t,n,r){var e=r(112);r(54),t.exports=e},function(t,n,r){r(113),r(71),r(72),r(137),r(154),r(155),r(156),r(101);var e=r(13);t.exports=e.Promise},function(t,n,r){r(114)},function(t,n,r){"use strict";var e=r(0),o=r(14),i=r(62),c=r(63),u=r(120),a=r(50),f=r(19),s=r(20),p=r(125),l=r(126),v=r(35),d=r(130),y=r(4),h=r(131),m=y("toStringTag"),g=Error,x=[].push,b=function(t,n){var r,e=arguments.length>2?arguments[2]:void 0,u=o(w,this);c?r=c(g(),u?i(this):w):(r=u?this:a(w),f(r,m,"Error")),void 0!==n&&f(r,"message",d(n)),h&&f(r,"stack",p(r.stack,1)),l(r,e);var s=[];return v(t,x,{that:s}),f(r,"errors",s),r};c?c(b,g):u(b,g,{name:!0});var w=b.prototype=a(g.prototype,{constructor:s(1,b),message:s(1,""),name:s(1,"AggregateError")});e({global:!0,constructor:!0,arity:2},{AggregateError:b})},function(t,n,r){var e=r(7),o=r(10),i=r(46),c=r(58),u=r(116),a=r(4),f=TypeError,s=a("toPrimitive");t.exports=function(t,n){if(!o(t)||i(t))return t;var r,a=c(t,s);if(a){if(void 0===n&&(n="default"),r=e(a,t,n),!o(r)||i(r))return r;throw f("Can't convert object to primitive value")}return void 0===n&&(n="number"),u(t,n)}},function(t,n,r){var e=r(7),o=r(2),i=r(10),c=TypeError;t.exports=function(t,n){var r,u;if("string"===n&&o(r=t.toString)&&!i(u=e(r,t)))return u;if(o(r=t.valueOf)&&!i(u=e(r,t)))return u;if("string"!==n&&o(r=t.toString)&&!i(u=e(r,t)))return u;throw c("Can't convert object to primitive value")}},function(t,n,r){var e=r(1),o=Object.defineProperty;t.exports=function(t,n){try{o(e,t,{value:n,configurable:!0,writable:!0})}catch(r){e[t]=n}return n}},function(t,n,r){var e=r(5);t.exports=!e((function(){function t(){}return t.prototype.constructor=null,Object.getPrototypeOf(new t)!==t.prototype}))},function(t,n,r){var e=r(2),o=String,i=TypeError;t.exports=function(t){if("object"==typeof t||e(t))return t;throw i("Can't set "+o(t)+" as a prototype")}},function(t,n,r){var e=r(8),o=r(121),i=r(43),c=r(16);t.exports=function(t,n,r){for(var u=o(n),a=c.f,f=i.f,s=0;s<u.length;s++){var p=u[s];e(t,p)||r&&e(r,p)||a(t,p,f(n,p))}}},function(t,n,r){var e=r(9),o=r(6),i=r(64),c=r(68),u=r(12),a=o([].concat);t.exports=e("Reflect","ownKeys")||function(t){var n=i.f(u(t)),r=c.f;return r?a(n,r(t)):n}},function(t,n,r){var e=r(18),o=r(65),i=r(26),c=function(t){return function(n,r,c){var u,a=e(n),f=i(a),s=o(c,f);if(t&&r!=r){for(;f>s;)if((u=a[s++])!=u)return!0}else for(;f>s;s++)if((t||s in a)&&a[s]===r)return t||s||0;return!t&&-1}};t.exports={includes:c(!0),indexOf:c(!1)}},function(t,n){var r=Math.ceil,e=Math.floor;t.exports=Math.trunc||function(t){var n=+t;return(n>0?e:r)(n)}},function(t,n,r){var e=r(66),o=Math.min;t.exports=function(t){return t>0?o(e(t),9007199254740991):0}},function(t,n,r){var e=r(6),o=Error,i=e("".replace),c=String(o("zxcasd").stack),u=/\\n\\s*at [^:]*:[^\\n]*/,a=u.test(c);t.exports=function(t,n){if(a&&"string"==typeof t&&!o.prepareStackTrace)for(;n--;)t=i(t,u,"");return t}},function(t,n,r){var e=r(10),o=r(19);t.exports=function(t,n){e(n)&&"cause"in n&&o(t,"cause",n.cause)}},function(t,n,r){var e=r(4),o=r(27),i=e("iterator"),c=Array.prototype;t.exports=function(t){return void 0!==t&&(o.Array===t||c[i]===t)}},function(t,n,r){var e=r(7),o=r(17),i=r(12),c=r(32),u=r(89),a=TypeError;t.exports=function(t,n){var r=arguments.length<2?u(t):n;if(o(r))return i(e(r,t));throw a(c(t)+" is not iterable")}},function(t,n,r){var e=r(7),o=r(12),i=r(58);t.exports=function(t,n,r){var c,u;o(t);try{if(!(c=i(t,"return"))){if("throw"===n)throw r;return r}c=e(c,t)}catch(t){u=!0,c=t}if("throw"===n)throw r;if(u)throw c;return o(c),r}},function(t,n,r){var e=r(36);t.exports=function(t,n){return void 0===t?arguments.length<2?"":n:e(t)}},function(t,n,r){var e=r(5),o=r(20);t.exports=!e((function(){var t=Error("a");return!("stack"in t)||(Object.defineProperty(t,"stack",o(1,7)),7!==t.stack)}))},function(t,n){t.exports=function(){}},function(t,n,r){var e=r(1),o=r(2),i=e.WeakMap;t.exports=o(i)&&/native code/.test(String(i))},function(t,n,r){var e=r(11),o=r(8),i=Function.prototype,c=e&&Object.getOwnPropertyDescriptor,u=o(i,"name"),a=u&&"something"===function(){}.name,f=u&&(!e||e&&c(i,"name").configurable);t.exports={EXISTS:u,PROPER:a,CONFIGURABLE:f}},function(t,n,r){"use strict";var e=r(91).IteratorPrototype,o=r(50),i=r(20),c=r(29),u=r(27),a=function(){return this};t.exports=function(t,n,r,f){var s=n+" Iterator";return t.prototype=o(e,{next:i(+!f,r)}),c(t,s,!1,!0),u[s]=a,t}},function(t,n,r){"use strict";var e=r(70),o=r(28);t.exports=e?{}.toString:function(){return"[object "+o(this)+"]"}},function(t,n,r){r(138),r(148),r(150),r(151),r(152),r(153)},function(t,n,r){"use strict";var e,o,i,c=r(0),u=r(15),a=r(52),f=r(1),s=r(7),p=r(21),l=r(63),v=r(29),d=r(139),y=r(17),h=r(2),m=r(10),g=r(140),x=r(93),b=r(95).set,w=r(142),S=r(145),j=r(37),O=r(146),P=r(51),T=r(30),A=r(38),E=r(22),k=A.CONSTRUCTOR,I=A.REJECTION_EVENT,D=A.SUBCLASSING,L=P.getterFor("Promise"),_=P.set,C=T&&T.prototype,M=T,R=C,N=f.TypeError,F=f.document,B=f.process,G=E.f,U=G,z=!!(F&&F.createEvent&&f.dispatchEvent),q=function(t){var n;return!(!m(t)||!h(n=t.then))&&n},V=function(t,n){var r,e,o,i=n.value,c=1==n.state,u=c?t.ok:t.fail,a=t.resolve,f=t.reject,p=t.domain;try{u?(c||(2===n.rejection&&Y(n),n.rejection=1),!0===u?r=i:(p&&p.enter(),r=u(i),p&&(p.exit(),o=!0)),r===t.promise?f(N("Promise-chain cycle")):(e=q(r))?s(e,r,a,f):a(r)):f(i)}catch(t){p&&!o&&p.exit(),f(t)}},H=function(t,n){t.notified||(t.notified=!0,w((function(){for(var r,e=t.reactions;r=e.get();)V(r,t);t.notified=!1,n&&!t.rejection&&K(t)})))},J=function(t,n,r){var e,o;z?((e=F.createEvent("Event")).promise=n,e.reason=r,e.initEvent(t,!1,!0),f.dispatchEvent(e)):e={promise:n,reason:r},!I&&(o=f["on"+t])?o(e):"unhandledrejection"===t&&S("Unhandled promise rejection",r)},K=function(t){s(b,f,(function(){var n,r=t.facade,e=t.value;if(W(t)&&(n=j((function(){a?B.emit("unhandledRejection",e,r):J("unhandledrejection",r,e)})),t.rejection=a||W(t)?2:1,n.error))throw n.value}))},W=function(t){return 1!==t.rejection&&!t.parent},Y=function(t){s(b,f,(function(){var n=t.facade;a?B.emit("rejectionHandled",n):J("rejectionhandled",n,t.value)}))},X=function(t,n,r){return function(e){t(n,e,r)}},$=function(t,n,r){t.done||(t.done=!0,r&&(t=r),t.value=n,t.state=2,H(t,!0))},Q=function(t,n,r){if(!t.done){t.done=!0,r&&(t=r);try{if(t.facade===n)throw N("Promise can't be resolved itself");var e=q(n);e?w((function(){var r={done:!1};try{s(e,n,X(Q,r,t),X($,r,t))}catch(n){$(r,n,t)}})):(t.value=n,t.state=1,H(t,!1))}catch(n){$({done:!1},n,t)}}};if(k&&(R=(M=function(t){g(this,R),y(t),s(e,this);var n=L(this);try{t(X(Q,n),X($,n))}catch(t){$(n,t)}}).prototype,(e=function(t){_(this,{type:"Promise",done:!1,notified:!1,parent:!1,reactions:new O,rejection:!1,state:0,value:void 0})}).prototype=p(R,"then",(function(t,n){var r=L(this),e=G(x(this,M));return r.parent=!0,e.ok=!h(t)||t,e.fail=h(n)&&n,e.domain=a?B.domain:void 0,0==r.state?r.reactions.add(e):w((function(){V(e,r)})),e.promise})),o=function(){var t=new e,n=L(t);this.promise=t,this.resolve=X(Q,n),this.reject=X($,n)},E.f=G=function(t){return t===M||void 0===t?new o(t):U(t)},!u&&h(T)&&C!==Object.prototype)){i=C.then,D||p(C,"then",(function(t,n){var r=this;return new M((function(t,n){s(i,r,t,n)})).then(t,n)}),{unsafe:!0});try{delete C.constructor}catch(t){}l&&l(C,R)}c({global:!0,constructor:!0,wrap:!0,forced:k},{Promise:M}),v(M,"Promise",!1,!0),d("Promise")},function(t,n,r){"use strict";var e=r(9),o=r(16),i=r(4),c=r(11),u=i("species");t.exports=function(t){var n=e(t),r=o.f;c&&n&&!n[u]&&r(n,u,{configurable:!0,get:function(){return this}})}},function(t,n,r){var e=r(14),o=TypeError;t.exports=function(t,n){if(e(n,t))return t;throw o("Incorrect invocation")}},function(t,n,r){var e=r(73),o=r(32),i=TypeError;t.exports=function(t){if(e(t))return t;throw i(o(t)+" is not a constructor")}},function(t,n,r){var e,o,i,c,u,a,f,s,p=r(1),l=r(34),v=r(43).f,d=r(95).set,y=r(97),h=r(143),m=r(144),g=r(52),x=p.MutationObserver||p.WebKitMutationObserver,b=p.document,w=p.process,S=p.Promise,j=v(p,"queueMicrotask"),O=j&&j.value;O||(e=function(){var t,n;for(g&&(t=w.domain)&&t.exit();o;){n=o.fn,o=o.next;try{n()}catch(t){throw o?c():i=void 0,t}}i=void 0,t&&t.enter()},y||g||m||!x||!b?!h&&S&&S.resolve?((f=S.resolve(void 0)).constructor=S,s=l(f.then,f),c=function(){s(e)}):g?c=function(){w.nextTick(e)}:(d=l(d,p),c=function(){d(e)}):(u=!0,a=b.createTextNode(""),new x(e).observe(a,{characterData:!0}),c=function(){a.data=u=!u})),t.exports=O||function(t){var n={fn:t,next:void 0};i&&(i.next=n),o||(o=n,c()),i=n}},function(t,n,r){var e=r(31),o=r(1);t.exports=/ipad|iphone|ipod/i.test(e)&&void 0!==o.Pebble},function(t,n,r){var e=r(31);t.exports=/web0s(?!.*chrome)/i.test(e)},function(t,n,r){var e=r(1);t.exports=function(t,n){var r=e.console;r&&r.error&&(1==arguments.length?r.error(t):r.error(t,n))}},function(t,n){var r=function(){this.head=null,this.tail=null};r.prototype={add:function(t){var n={item:t,next:null};this.head?this.tail.next=n:this.head=n,this.tail=n},get:function(){var t=this.head;if(t)return this.head=t.next,this.tail===t&&(this.tail=null),t.item}},t.exports=r},function(t,n,r){var e=r(98),o=r(52);t.exports=!e&&!o&&"object"==typeof window&&"object"==typeof document},function(t,n,r){"use strict";var e=r(0),o=r(7),i=r(17),c=r(22),u=r(37),a=r(35);e({target:"Promise",stat:!0,forced:r(99)},{all:function(t){var n=this,r=c.f(n),e=r.resolve,f=r.reject,s=u((function(){var r=i(n.resolve),c=[],u=0,s=1;a(t,(function(t){var i=u++,a=!1;s++,o(r,n,t).then((function(t){a||(a=!0,c[i]=t,--s||e(c))}),f)})),--s||e(c)}));return s.error&&f(s.value),r.promise}})},function(t,n,r){var e=r(4)("iterator"),o=!1;try{var i=0,c={next:function(){return{done:!!i++}},return:function(){o=!0}};c[e]=function(){return this},Array.from(c,(function(){throw 2}))}catch(t){}t.exports=function(t,n){if(!n&&!o)return!1;var r=!1;try{var i={};i[e]=function(){return{next:function(){return{done:r=!0}}}},t(i)}catch(t){}return r}},function(t,n,r){"use strict";var e=r(0),o=r(15),i=r(38).CONSTRUCTOR,c=r(30),u=r(9),a=r(2),f=r(21),s=c&&c.prototype;if(e({target:"Promise",proto:!0,forced:i,real:!0},{catch:function(t){return this.then(void 0,t)}}),!o&&a(c)){var p=u("Promise").prototype.catch;s.catch!==p&&f(s,"catch",p,{unsafe:!0})}},function(t,n,r){"use strict";var e=r(0),o=r(7),i=r(17),c=r(22),u=r(37),a=r(35);e({target:"Promise",stat:!0,forced:r(99)},{race:function(t){var n=this,r=c.f(n),e=r.reject,f=u((function(){var c=i(n.resolve);a(t,(function(t){o(c,n,t).then(r.resolve,e)}))}));return f.error&&e(f.value),r.promise}})},function(t,n,r){"use strict";var e=r(0),o=r(7),i=r(22);e({target:"Promise",stat:!0,forced:r(38).CONSTRUCTOR},{reject:function(t){var n=i.f(this);return o(n.reject,void 0,t),n.promise}})},function(t,n,r){"use strict";var e=r(0),o=r(9),i=r(15),c=r(30),u=r(38).CONSTRUCTOR,a=r(100),f=o("Promise"),s=i&&!u;e({target:"Promise",stat:!0,forced:i||u},{resolve:function(t){return a(s&&this===f?c:this,t)}})},function(t,n,r){"use strict";var e=r(0),o=r(7),i=r(17),c=r(22),u=r(37),a=r(35);e({target:"Promise",stat:!0},{allSettled:function(t){var n=this,r=c.f(n),e=r.resolve,f=r.reject,s=u((function(){var r=i(n.resolve),c=[],u=0,f=1;a(t,(function(t){var i=u++,a=!1;f++,o(r,n,t).then((function(t){a||(a=!0,c[i]={status:"fulfilled",value:t},--f||e(c))}),(function(t){a||(a=!0,c[i]={status:"rejected",reason:t},--f||e(c))}))})),--f||e(c)}));return s.error&&f(s.value),r.promise}})},function(t,n,r){"use strict";var e=r(0),o=r(7),i=r(17),c=r(9),u=r(22),a=r(37),f=r(35);e({target:"Promise",stat:!0},{any:function(t){var n=this,r=c("AggregateError"),e=u.f(n),s=e.resolve,p=e.reject,l=a((function(){var e=i(n.resolve),c=[],u=0,a=1,l=!1;f(t,(function(t){var i=u++,f=!1;a++,o(e,n,t).then((function(t){f||l||(l=!0,s(t))}),(function(t){f||l||(f=!0,c[i]=t,--a||p(new r(c,"No one promise resolved")))}))})),--a||p(new r(c,"No one promise resolved"))}));return l.error&&p(l.value),e.promise}})},function(t,n,r){"use strict";var e=r(0),o=r(15),i=r(30),c=r(5),u=r(9),a=r(2),f=r(93),s=r(100),p=r(21),l=i&&i.prototype;if(e({target:"Promise",proto:!0,real:!0,forced:!!i&&c((function(){l.finally.call({then:function(){}},(function(){}))}))},{finally:function(t){var n=f(this,u("Promise")),r=a(t);return this.then(r?function(r){return s(n,t()).then((function(){return r}))}:t,r?function(r){return s(n,t()).then((function(){throw r}))}:t)}}),!o&&a(i)){var v=u("Promise").prototype.finally;l.finally!==v&&p(l,"finally",v,{unsafe:!0})}},function(t,n,r){var e=r(6),o=r(66),i=r(36),c=r(57),u=e("".charAt),a=e("".charCodeAt),f=e("".slice),s=function(t){return function(n,r){var e,s,p=i(c(n)),l=o(r),v=p.length;return l<0||l>=v?t?"":void 0:(e=a(p,l))<55296||e>56319||l+1===v||(s=a(p,l+1))<56320||s>57343?t?u(p,l):e:t?f(p,l,l+2):s-56320+(e-55296<<10)+65536}};t.exports={codeAt:s(!1),charAt:s(!0)}},function(t,n){t.exports={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}},function(t,n,r){var e=r(160);t.exports=e},function(t,n,r){var e=r(14),o=r(161),i=Array.prototype;t.exports=function(t){var n=t.slice;return t===i||e(i,t)&&n===i.slice?o:n}},function(t,n,r){r(162);var e=r(40);t.exports=e("Array").slice},function(t,n,r){"use strict";var e=r(0),o=r(39),i=r(73),c=r(10),u=r(65),a=r(26),f=r(18),s=r(74),p=r(4),l=r(55),v=r(53),d=l("slice"),y=p("species"),h=Array,m=Math.max;e({target:"Array",proto:!0,forced:!d},{slice:function(t,n){var r,e,p,l=f(this),d=a(l),g=u(t,d),x=u(void 0===n?d:n,d);if(o(l)&&(r=l.constructor,(i(r)&&(r===h||o(r.prototype))||c(r)&&null===(r=r[y]))&&(r=void 0),r===h||void 0===r))return v(l,g,x);for(e=new(void 0===r?h:r)(m(x-g,0)),p=0;g<x;g++,p++)g in l&&s(e,p,l[g]);return e.length=p,e}})},function(t,n,r){t.exports=r(164)},function(t,n,r){var e=r(165);t.exports=e},function(t,n,r){var e=r(14),o=r(166),i=Array.prototype;t.exports=function(t){var n=t.map;return t===i||e(i,t)&&n===i.map?o:n}},function(t,n,r){r(167);var e=r(40);t.exports=e("Array").map},function(t,n,r){"use strict";var e=r(0),o=r(56).map;e({target:"Array",proto:!0,forced:!r(55)("map")},{map:function(t){return o(this,t,arguments.length>1?arguments[1]:void 0)}})},function(t,n,r){var e=r(39),o=r(73),i=r(10),c=r(4)("species"),u=Array;t.exports=function(t){var n;return e(t)&&(n=t.constructor,(o(n)&&(n===u||e(n.prototype))||i(n)&&null===(n=n[c]))&&(n=void 0)),void 0===n?u:n}},function(t,n,r){(function(e){var o,i=r(170),c=r(76),u=r(216),a=r(102),f=r(222),s=r(226),p=r(233),l=r(237),v=r(241),d=r(245);!function(y,h){"use strict";var m,g=(y=void 0!==y?y:"undefined"!=typeof self?self:void 0!==e?e:{}).IDBKeyRange||y.webkitIDBKeyRange,x="readonly",b="readwrite",w=Object.prototype.hasOwnProperty,S=function(){if(!m&&!(m=y.indexedDB||y.webkitIndexedDB||y.mozIndexedDB||y.oIndexedDB||y.msIndexedDB||(null===y.indexedDB&&y.shimIndexedDB?y.shimIndexedDB:void 0)))throw"IndexedDB required";return m},j=!1,O=navigator&&!navigator.userAgentData&&/Safari\\//.test(navigator.userAgent)&&!/Chrom(e|ium)\\//.test(navigator.userAgent),P=function(t){return t},T=function(t){var n;return a(n=Object.prototype.toString.call(t)).call(n,8,-1).toLowerCase()},A=function(t){return"function"==typeof t},E=function(t){return"number"===T(t)},k=function(t){return"array"===T(t)},I=function(t){return void 0===t},D=function(t,n){var r=this,e=!1;this.name=n,this.getIndexedDB=function(){return t},this.add=function(n){if(e)throw"Database has been closed";for(var o=[],i=0,u=0;u<arguments.length-1;u++)if(f(arguments[u+1]))for(var a=0;a<arguments[u+1].length;a++)o[i]=arguments[u+1][a],i++;else o[i]=arguments[u+1],i++;var l=t.transaction(n,b),v=l.objectStore(n);return new c((function(t,n){s(o).call(o,(function(t){var n;if(t.item&&t.key){var r=t.key;t=t.item,n=v.add(t,r)}else n=v.add(t);n.onsuccess=function(n){var r=n.target,e=r.source.keyPath;null===e&&(e="__id__"),p(t,e,{value:r.result,enumerable:!0})}})),l.oncomplete=function(){t(o,r)},l.onerror=function(t){t.preventDefault(),n(t)},l.onabort=function(t){n(t)}}))},this.updateAndDelete=function(n,r,o){if(e)throw"Database has been closed";var i=t.transaction(n,b),u=i.objectStore(n),a=u.keyPath;return new c((function(t,n){s(r).call(r,(function(t){if(t.item&&t.key){var n=t.key;t=t.item,u.put(t,n)}else u.put(t)})),s(o).call(o,(function(t){u.delete(t[a])})),i.oncomplete=function(){t([r,o])},i.onerror=function(t){n(t)}}))},this.update=function(n){if(e)throw"Database has been closed";for(var o,i=[],u=1;u<arguments.length;u++)f(o=arguments[u])?i=l(i).call(i,o):i.push(o);var a=t.transaction(n,b),p=a.objectStore(n);p.keyPath;return new c((function(t,n){s(i).call(i,(function(t){var n;if(t.item&&t.key){var r=t.key;t=t.item,n=p.put(t,r)}else n=p.put(t);n.onsuccess=function(t){},n.onerror=function(t){}})),a.oncomplete=function(){t(i,r)},a.onerror=function(t){n(t)},a.onabort=function(t){n(t)}}))},this.remove=function(n,r,o,i,u,a,p){if(e)throw"Database has been closed";var l=t.transaction(n,b),v=l.objectStore(n);return new c((function(t,n){function e(t){return null==t}var c;(e(i)&&(i=-1/0),e(u)&&(u=1/0),null===r||f(r)||(r=[r]),e(o))?null!==r?s(r).call(r,(function(t){v.delete(t)})):v.delete(range=g.bound(i,u,a,p)):(c=null!==r?g.only(r[0]):g.bound(i,u,a,p),v.index(o).openCursor(c).onsuccess=function(t){var n=t.target.result;n&&(n.delete(),n.continue())});l.oncomplete=function(){t()},l.onerror=function(t){n(t)},l.onabort=function(t){n(t)}}))},this.clear=function(n){if(e)throw"Database has been closed";var r=t.transaction(n,b);r.objectStore(n).clear();return new c((function(t,n){r.oncomplete=function(){t()},r.onerror=function(t){n(t)}}))},this.close=function(){e||(t.close(),e=!0,delete C[n])},this.get=function(n,r){if(e)throw"Database has been closed";var o=t.transaction(n),i=o.objectStore(n).get(r);return new c((function(t,n){i.onsuccess=function(n){t(n.target.result)},o.onerror=function(t){n(t)}}))},this.query=function(n,r){if(e)throw"Database has been closed";return new L(n,t,r)},this.count=function(n,r){if(e)throw"Database has been closed";t.transaction(n).objectStore(n)};for(var o=0,i=t.objectStoreNames.length;o<i;o++)!function(t){for(var n in r[t]={},r)w.call(r,n)&&"close"!==n&&(r[t][n]=function(n){return function(){var e,o=l(e=[t]).call(e,a([]).call(arguments,0));return r[n].apply(r,o)}}(n))}(t.objectStoreNames[o])},L=function(t,n,r){var e,o=this,u=!1,f=!1,p=function(e,o,a,p,l,d,y){return new c((function(c,h){var m=u||f?b:x,w=n.transaction(t,m),S=w.objectStore(t),j=r?S.index(r):S,O=e?g[e].apply(null,o):null,P=[],T=[O],E=0;l=l||null,d=d||[],"count"!==a&&T.push(p||"next");var k=!!u&&v(u);j[a].apply(j,T).onsuccess=function(t){var n=t.target.result;if(i(n)===i(0))P=n;else if(n)if(null!==l&&l[0]>E)E=l[0],n.advance(l[0]);else if(null!==l&&E>=l[0]+l[1]);else{var r=!0,e="value"in n?n.value:n.key;s(d).call(d,(function(t){t&&t.length&&(2===t.length?r=r&&e[t[0]]===t[1]:A(t[0])&&(r=r&&t[0].apply(void 0,[e])))})),r&&(E++,P.push(y(e)),f?n.delete():u&&(e=function(t){for(var n=0;n<k.length;n++){var r=k[n],e=u[r];e instanceof Function&&(e=e(t)),t[r]=e}return t}(e),n.update(e))),n.continue()}},w.oncomplete=function(){c(P)},w.onerror=function(t){h(t)},w.onabort=function(t){h(t)}}))},l=function(t,n){var r="next",e="openCursor",o=[],i=null,c=P,s=!1,l=function(){return p(t,n,e,s?r+"unique":r,i,o,c)},v=function(){return r=null,e="count",{execute:l}},d=function t(){return 1==(i=k(arguments[0])?arguments[0]:a(Array.prototype).call(arguments,0,2)).length&&i.unshift(0),E(i[1])||(i=null),{execute:l,count:v,keys:y,filter:h,asc:m,desc:g,distinct:x,modify:b,limit:t,map:w,remove:S}},y=function t(n){return(n=!!I(n)||!!n)&&(e="openKeyCursor"),{execute:l,keys:t,filter:h,asc:m,desc:g,distinct:x,modify:b,limit:d,map:w,remove:S}},h=function t(){return o.push(a(Array.prototype).call(arguments,0,2)),{execute:l,count:v,keys:y,filter:t,asc:m,desc:g,distinct:x,modify:b,limit:d,map:w,remove:S}},m=function t(n){return n=!!I(n)||!!n,r=n?"next":"prev",{execute:l,count:v,keys:y,filter:h,asc:t,desc:g,distinct:x,modify:b,limit:d,map:w,remove:S}},g=function t(n){return n=!!I(n)||!!n,r=n?"prev":"next",{execute:l,count:v,keys:y,filter:h,asc:m,desc:t,distinct:x,modify:b,limit:d,map:w,remove:S}},x=function t(n){return n=!!I(n)||!!n,s=n,{execute:l,count:v,keys:y,filter:h,asc:m,desc:g,distinct:t,modify:b,limit:d,map:w,remove:S}},b=function t(n){return u=n,{execute:l,count:v,keys:y,filter:h,asc:m,desc:g,distinct:x,modify:t,limit:d,map:w,remove:S}},w=function t(n){return A(n)&&(c=n),{execute:l,count:v,keys:y,filter:h,asc:m,desc:g,distinct:x,modify:b,limit:d,map:t,remove:S}},S=function t(n){return n=!!I(n)||!!n,f=n,{execute:l,count:v,keys:y,filter:h,asc:m,desc:g,distinct:x,modify:b,limit:d,map:w,remove:t}};return{execute:l,count:v,keys:y,filter:h,asc:m,desc:g,distinct:x,modify:b,limit:d,map:w,remove:S}};s(e="only bound upperBound lowerBound".split(" ")).call(e,(function(t){o[t]=function(){return new l(t,arguments)}})),this.filter=function(){var t=new l(null,null);return d(t).apply(t,arguments)},this.all=function(){var t;return d(t=this).call(t)}},_=function(t,n,r,e){var o=t.target.result,i=new D(o,n);return C[n]=o,c.resolve(i)},C={},M={version:"0.10.2",open:function(t){var n;return new c((function(r,e){var o;C[t.server]?_({target:{result:C[t.server]}},t.server,t.version,t.schema).then(r,e):(j?c.resolve():O&&S().databases?new c((function(t){var n=function(){return S().databases().finally(t)};o=u(n,100),n()})).finally((function(){j=!0,clearInterval(o)})):(j=!0,c.resolve())).then((function(){try{n=S().open(t.server,t.version)}catch(t){e(t)}n.onsuccess=function(n){_(n,t.server,t.version,t.schema).then(r,e)},n.onupgradeneeded=function(n){!function(t,n,r){for(var e in"function"==typeof n&&(n=n()),n){var o,i=n[e];for(var c in o=!w.call(n,e)||r.objectStoreNames.contains(e)?t.currentTarget.transaction.objectStore(e):r.createObjectStore(e,i.key),i.indexes){var u=i.indexes[c];try{o.index(c)}catch(t){o.createIndex(c,u.key||c,v(u).length?u:{unique:!1})}}}}(n,t.schema,n.target.result)},n.onerror=function(t){e(t)}}))}))},remove:function(t){return new c((function(n,r){if(!t)return n();var e,o;i(t)===D&&(t=t.name),"string"==typeof t&&(e=C[t]),e&&"function"==typeof e.close&&e.close();try{o=S().deleteDatabase(t)}catch(t){r(t)}o.onsuccess=function(r){delete C[t],n(t)},o.onerror=function(t){r(t)},o.onblocked=function(t){r(t)}}))}};void 0!==t.exports?t.exports=M:void 0===(o=function(){return M}.call(n,r,n,t))||(t.exports=o)}(void 0)}).call(this,r(77))},function(t,n,r){var e=r(171),o=r(210);function i(n){return t.exports=i="function"==typeof e&&"symbol"==typeof o?function(t){return typeof t}:function(t){return t&&"function"==typeof e&&t.constructor===e&&t!==e.prototype?"symbol":typeof t},t.exports.__esModule=!0,t.exports.default=t.exports,i(n)}t.exports=i,t.exports.__esModule=!0,t.exports.default=t.exports},function(t,n,r){t.exports=r(172)},function(t,n,r){t.exports=r(173)},function(t,n,r){var e=r(174);r(203),r(204),r(205),r(206),r(207),r(208),r(209),t.exports=e},function(t,n,r){var e=r(175);r(202),t.exports=e},function(t,n,r){var e=r(176);r(54),t.exports=e},function(t,n,r){r(104),r(72),r(178),r(186),r(187),r(188),r(189),r(107),r(190),r(191),r(192),r(193),r(194),r(195),r(196),r(197),r(198),r(199),r(200),r(201);var e=r(13);t.exports=e.Symbol},function(t,n){var r=TypeError;t.exports=function(t){if(t>9007199254740991)throw r("Maximum allowed index exceeded");return t}},function(t,n,r){r(179),r(182),r(183),r(184),r(185)},function(t,n,r){"use strict";var e=r(0),o=r(1),i=r(7),c=r(6),u=r(15),a=r(11),f=r(24),s=r(5),p=r(8),l=r(14),v=r(12),d=r(18),y=r(45),h=r(36),m=r(20),g=r(50),x=r(69),b=r(64),w=r(180),S=r(68),j=r(43),O=r(16),P=r(87),T=r(80),A=r(21),E=r(33),k=r(48),I=r(49),D=r(60),L=r(4),_=r(75),C=r(3),M=r(105),R=r(29),N=r(51),F=r(56).forEach,B=k("hidden"),G=N.set,U=N.getterFor("Symbol"),z=Object.prototype,q=o.Symbol,V=q&&q.prototype,H=o.TypeError,J=o.QObject,K=j.f,W=O.f,Y=w.f,X=T.f,$=c([].push),Q=E("symbols"),Z=E("op-symbols"),tt=E("wks"),nt=!J||!J.prototype||!J.prototype.findChild,rt=a&&s((function(){return 7!=g(W({},"a",{get:function(){return W(this,"a",{value:7}).a}})).a}))?function(t,n,r){var e=K(z,n);e&&delete z[n],W(t,n,r),e&&t!==z&&W(z,n,e)}:W,et=function(t,n){var r=Q[t]=g(V);return G(r,{type:"Symbol",tag:t,description:n}),a||(r.description=n),r},ot=function(t,n,r){t===z&&ot(Z,n,r),v(t);var e=y(n);return v(r),p(Q,e)?(r.enumerable?(p(t,B)&&t[B][e]&&(t[B][e]=!1),r=g(r,{enumerable:m(0,!1)})):(p(t,B)||W(t,B,m(1,{})),t[B][e]=!0),rt(t,e,r)):W(t,e,r)},it=function(t,n){v(t);var r=d(n),e=x(r).concat(ft(r));return F(e,(function(n){a&&!i(ct,r,n)||ot(t,n,r[n])})),t},ct=function(t){var n=y(t),r=i(X,this,n);return!(this===z&&p(Q,n)&&!p(Z,n))&&(!(r||!p(this,n)||!p(Q,n)||p(this,B)&&this[B][n])||r)},ut=function(t,n){var r=d(t),e=y(n);if(r!==z||!p(Q,e)||p(Z,e)){var o=K(r,e);return!o||!p(Q,e)||p(r,B)&&r[B][e]||(o.enumerable=!0),o}},at=function(t){var n=Y(d(t)),r=[];return F(n,(function(t){p(Q,t)||p(I,t)||$(r,t)})),r},ft=function(t){var n=t===z,r=Y(n?Z:d(t)),e=[];return F(r,(function(t){!p(Q,t)||n&&!p(z,t)||$(e,Q[t])})),e};f||(A(V=(q=function(){if(l(V,this))throw H("Symbol is not a constructor");var t=arguments.length&&void 0!==arguments[0]?h(arguments[0]):void 0,n=D(t),r=function(t){this===z&&i(r,Z,t),p(this,B)&&p(this[B],n)&&(this[B][n]=!1),rt(this,n,m(1,t))};return a&&nt&&rt(z,n,{configurable:!0,set:r}),et(n,t)}).prototype,"toString",(function(){return U(this).tag})),A(q,"withoutSetter",(function(t){return et(D(t),t)})),T.f=ct,O.f=ot,P.f=it,j.f=ut,b.f=w.f=at,S.f=ft,_.f=function(t){return et(L(t),t)},a&&(W(V,"description",{configurable:!0,get:function(){return U(this).description}}),u||A(z,"propertyIsEnumerable",ct,{unsafe:!0}))),e({global:!0,constructor:!0,wrap:!0,forced:!f,sham:!f},{Symbol:q}),F(x(tt),(function(t){C(t)})),e({target:"Symbol",stat:!0,forced:!f},{useSetter:function(){nt=!0},useSimple:function(){nt=!1}}),e({target:"Object",stat:!0,forced:!f,sham:!a},{create:function(t,n){return void 0===n?g(t):it(g(t),n)},defineProperty:ot,defineProperties:it,getOwnPropertyDescriptor:ut}),e({target:"Object",stat:!0,forced:!f},{getOwnPropertyNames:at}),M(),R(q,"Symbol"),I[B]=!0},function(t,n,r){var e=r(23),o=r(18),i=r(64).f,c=r(181),u="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];t.exports.f=function(t){return u&&"Window"==e(t)?function(t){try{return i(t)}catch(t){return c(u)}}(t):i(o(t))}},function(t,n,r){var e=r(65),o=r(26),i=r(74),c=Array,u=Math.max;t.exports=function(t,n,r){for(var a=o(t),f=e(n,a),s=e(void 0===r?a:r,a),p=c(u(s-f,0)),l=0;f<s;f++,l++)i(p,l,t[f]);return p.length=l,p}},function(t,n,r){var e=r(0),o=r(9),i=r(8),c=r(36),u=r(33),a=r(106),f=u("string-to-symbol-registry"),s=u("symbol-to-string-registry");e({target:"Symbol",stat:!0,forced:!a},{for:function(t){var n=c(t);if(i(f,n))return f[n];var r=o("Symbol")(n);return f[n]=r,s[r]=n,r}})},function(t,n,r){var e=r(0),o=r(8),i=r(46),c=r(32),u=r(33),a=r(106),f=u("symbol-to-string-registry");e({target:"Symbol",stat:!0,forced:!a},{keyFor:function(t){if(!i(t))throw TypeError(c(t)+" is not a symbol");if(o(f,t))return f[t]}})},function(t,n,r){var e=r(0),o=r(9),i=r(41),c=r(7),u=r(6),a=r(5),f=r(39),s=r(2),p=r(10),l=r(46),v=r(53),d=r(24),y=o("JSON","stringify"),h=u(/./.exec),m=u("".charAt),g=u("".charCodeAt),x=u("".replace),b=u(1..toString),w=/[\\uD800-\\uDFFF]/g,S=/^[\\uD800-\\uDBFF]$/,j=/^[\\uDC00-\\uDFFF]$/,O=!d||a((function(){var t=o("Symbol")();return"[null]"!=y([t])||"{}"!=y({a:t})||"{}"!=y(Object(t))})),P=a((function(){return'"\\\\udf06\\\\ud834"'!==y("\\udf06\\ud834")||'"\\\\udead"'!==y("\\udead")})),T=function(t,n){var r=v(arguments),e=n;if((p(n)||void 0!==t)&&!l(t))return f(n)||(n=function(t,n){if(s(e)&&(n=c(e,this,t,n)),!l(n))return n}),r[1]=n,i(y,null,r)},A=function(t,n,r){var e=m(r,n-1),o=m(r,n+1);return h(S,t)&&!h(j,o)||h(j,t)&&!h(S,e)?"\\\\u"+b(g(t,0),16):t};y&&e({target:"JSON",stat:!0,arity:3,forced:O||P},{stringify:function(t,n,r){var e=v(arguments),o=i(O?T:y,null,e);return P&&"string"==typeof o?x(o,w,A):o}})},function(t,n,r){var e=r(0),o=r(24),i=r(5),c=r(68),u=r(25);e({target:"Object",stat:!0,forced:!o||i((function(){c.f(1)}))},{getOwnPropertySymbols:function(t){var n=c.f;return n?n(u(t)):[]}})},function(t,n,r){r(3)("asyncIterator")},function(t,n){},function(t,n,r){r(3)("hasInstance")},function(t,n,r){r(3)("isConcatSpreadable")},function(t,n,r){r(3)("match")},function(t,n,r){r(3)("matchAll")},function(t,n,r){r(3)("replace")},function(t,n,r){r(3)("search")},function(t,n,r){r(3)("species")},function(t,n,r){r(3)("split")},function(t,n,r){var e=r(3),o=r(105);e("toPrimitive"),o()},function(t,n,r){var e=r(9),o=r(3),i=r(29);o("toStringTag"),i(e("Symbol"),"Symbol")},function(t,n,r){r(3)("unscopables")},function(t,n,r){var e=r(1);r(29)(e.JSON,"JSON",!0)},function(t,n){},function(t,n){},function(t,n,r){r(3)("dispose")},function(t,n,r){r(3)("asyncDispose")},function(t,n,r){r(3)("matcher")},function(t,n,r){r(3)("metadataKey")},function(t,n,r){r(3)("observable")},function(t,n,r){r(3)("metadata")},function(t,n,r){r(3)("patternMatch")},function(t,n,r){r(3)("replaceAll")},function(t,n,r){t.exports=r(211)},function(t,n,r){t.exports=r(212)},function(t,n,r){var e=r(213);t.exports=e},function(t,n,r){var e=r(214);t.exports=e},function(t,n,r){var e=r(215);r(54),t.exports=e},function(t,n,r){r(71),r(72),r(101),r(107);var e=r(75);t.exports=e.f("iterator")},function(t,n,r){t.exports=r(217)},function(t,n,r){r(218);var e=r(13);t.exports=e.setInterval},function(t,n,r){r(219),r(221)},function(t,n,r){var e=r(0),o=r(1),i=r(108)(o.setInterval,!0);e({global:!0,bind:!0,forced:o.setInterval!==i},{setInterval:i})},function(t,n){t.exports="function"==typeof Bun&&Bun&&"string"==typeof Bun.version},function(t,n,r){var e=r(0),o=r(1),i=r(108)(o.setTimeout,!0);e({global:!0,bind:!0,forced:o.setTimeout!==i},{setTimeout:i})},function(t,n,r){t.exports=r(223)},function(t,n,r){var e=r(224);t.exports=e},function(t,n,r){r(225);var e=r(13);t.exports=e.Array.isArray},function(t,n,r){r(0)({target:"Array",stat:!0},{isArray:r(39)})},function(t,n,r){t.exports=r(227)},function(t,n,r){r(54);var e=r(28),o=r(8),i=r(14),c=r(228),u=Array.prototype,a={DOMTokenList:!0,NodeList:!0};t.exports=function(t){var n=t.forEach;return t===u||i(u,t)&&n===u.forEach||o(a,e(t))?c:n}},function(t,n,r){var e=r(229);t.exports=e},function(t,n,r){r(230);var e=r(40);t.exports=e("Array").forEach},function(t,n,r){"use strict";var e=r(0),o=r(231);e({target:"Array",proto:!0,forced:[].forEach!=o},{forEach:o})},function(t,n,r){"use strict";var e=r(56).forEach,o=r(232)("forEach");t.exports=o?[].forEach:function(t){return e(this,t,arguments.length>1?arguments[1]:void 0)}},function(t,n,r){"use strict";var e=r(5);t.exports=function(t,n){var r=[][t];return!!r&&e((function(){r.call(null,n||function(){return 1},1)}))}},function(t,n,r){t.exports=r(234)},function(t,n,r){var e=r(235);t.exports=e},function(t,n,r){r(236);var e=r(13).Object,o=t.exports=function(t,n,r){return e.defineProperty(t,n,r)};e.defineProperty.sham&&(o.sham=!0)},function(t,n,r){var e=r(0),o=r(11),i=r(16).f;e({target:"Object",stat:!0,forced:Object.defineProperty!==i,sham:!o},{defineProperty:i})},function(t,n,r){t.exports=r(238)},function(t,n,r){var e=r(239);t.exports=e},function(t,n,r){var e=r(14),o=r(240),i=Array.prototype;t.exports=function(t){var n=t.concat;return t===i||e(i,t)&&n===i.concat?o:n}},function(t,n,r){r(104);var e=r(40);t.exports=e("Array").concat},function(t,n,r){t.exports=r(242)},function(t,n,r){var e=r(243);t.exports=e},function(t,n,r){r(244);var e=r(13);t.exports=e.Object.keys},function(t,n,r){var e=r(0),o=r(25),i=r(69);e({target:"Object",stat:!0,forced:r(5)((function(){i(1)}))},{keys:function(t){return i(o(t))}})},function(t,n,r){t.exports=r(246)},function(t,n,r){var e=r(247);t.exports=e},function(t,n,r){var e=r(14),o=r(248),i=Array.prototype;t.exports=function(t){var n=t.filter;return t===i||e(i,t)&&n===i.filter?o:n}},function(t,n,r){r(249);var e=r(40);t.exports=e("Array").filter},function(t,n,r){"use strict";var e=r(0),o=r(56).filter;e({target:"Array",proto:!0,forced:!r(55)("filter")},{filter:function(t){return o(this,t,arguments.length>1?arguments[1]:void 0)}})}]);`,"Worker",void 0,void 0)}},function(t,r,e){var n=e(3),g=e(15),y=e(9),i=e(304),k={log:{key:{keyPath:"time"},indexes:{level:{unique:!1},time:{unique:!0}}}};function $(){var V=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.server=null,this.expire=V.expire||72,this.name=V.name}var L=$.prototype;L.init=function(){var V=this;if(!this.server)return i.open({server:"nim-log-"+this.name,version:1,schema:k}).then(function(z){V.server=z})},L.putLog=function(V){var z=this;if(!this.server)return n.reject("no db server");var re=g(V).call(V,-1)[0].time-36e5*this.expire;return this.deleteLogs(re).then(function(){return z.server.add("log",V)})},L.getAllLogs=function(){return this.server?this.server.query("log","time").all().execute().then(function(V){var z={},re=g(V).call(V,-1)[0];return z.logs=y(V).call(V,function(ie){return ie.log}).join(`\r
`),z.time=re&&re.time,z}):n.reject("no db server")},L.deleteLogs=function(V){return this.server?this.server.remove("log",null,"time",0,V):n.reject("no db server")},t.exports=$},function(t,r,e){e(253);var n=e(13);t.exports=n.setInterval},function(t,r,e){var n=e(19),g=e(572),y=Function.prototype;t.exports=function(i){var k=i.bind;return i===y||n(y,i)&&k===y.bind?g:k}},function(t,r,e){e(573);var n=e(29);t.exports=n("Function").bind},function(t,r,e){var n=e(1),g=e(274);n({target:"Function",proto:!0,forced:Function.bind!==g},{bind:g})},function(t,r,e){var n=e(18),g=e(26),y=e(2),i=e(24),k=e(4),$=e(62),L=e(187);function V(ie){ie.onuploading&&this.on("uploading",ie.onuploading),L.call(this,ie)}var z=L.prototype,re=V.prototype=n(z);re.doSend=function(){var ie,ue,le,oe=this.options,ae=oe.headers,qe=this.xhr=new XMLHttpRequest;if(ae["Content-Type"]==="multipart/form-data"){var de,Ne;delete ae["Content-Type"],qe.upload.onprogress=g(de=this.onProgress).call(de,this),qe.upload.onload=g(Ne=this.onProgress).call(Ne,this);var ze,$e=oe.data;oe.data=new window.FormData,$e&&y(ze=$.getKeys($e,oe.putFileAtEnd)).call(ze,function(Et){var ir=$e[Et];ir.tagName&&ir.tagName.toUpperCase()==="INPUT"?ir.type==="file"&&y([]).call(ir.files,function(dr){oe.data.append($.dataset(ir,"name")||ir.name||dr.name||"file-"+$.uniqueID(),dr)}):oe.data.append(Et,ir)})}else if(ae["x-nos-token"]){var Lt,jt;qe.upload.onprogress=g(Lt=this.onProgress).call(Lt,this),qe.upload.onload=g(jt=this.onProgress).call(jt,this)}qe.onreadystatechange=g(ie=this.onStateChange).call(ie,this),oe.timeout!==0&&(this.timer=i(g(le=this.onTimeout).call(le,this),oe.timeout)),qe.open(oe.method,oe.url,!oe.sync),y(ue=k(ae)).call(ue,function(Et){qe.setRequestHeader(Et,ae[Et])}),oe.cookie&&"withCredentials"in qe&&(qe.withCredentials=!0),qe.send(oe.data),this.afterSend()},re.onProgress=function(ie){ie.lengthComputable&&ie.loaded<=ie.total&&this.emit("uploading",ie)},re.onStateChange=function(){var ie,ue=this.xhr;ue.readyState===4&&(ie={status:ue.status,result:ue.responseText||""},this.onLoad(ie))},re.getResponseHeader=function(ie){var ue=this.xhr;return ue?ue.getResponseHeader(ie):""},re.destroy=function(){clearTimeout(this.timer);try{this.xhr.onreadystatechange=$.f,this.xhr.abort()}catch{}z.destroy.call(this)},t.exports=V},function(t,r,e){var n;/*!
 * EventEmitter v5.2.9 - git.io/ee
 * Unlicense - http://unlicense.org/
 * Oliver Caldwell - https://oli.me.uk/
 * @preserve
 */(function(g){function y(){}var i=y.prototype,k=g.EventEmitter;function $(V,z){for(var re=V.length;re--;)if(V[re].listener===z)return re;return-1}function L(V){return function(){return this[V].apply(this,arguments)}}i.getListeners=function(V){var z,re,ie=this._getEvents();if(V instanceof RegExp)for(re in z={},ie)ie.hasOwnProperty(re)&&V.test(re)&&(z[re]=ie[re]);else z=ie[V]||(ie[V]=[]);return z},i.flattenListeners=function(V){var z,re=[];for(z=0;z<V.length;z+=1)re.push(V[z].listener);return re},i.getListenersAsObject=function(V){var z,re=this.getListeners(V);return re instanceof Array&&((z={})[V]=re),z||re},i.addListener=function(V,z){if(!function le(oe){return typeof oe=="function"||oe instanceof RegExp||!(!oe||typeof oe!="object")&&le(oe.listener)}(z))throw new TypeError("listener must be a function");var re,ie=this.getListenersAsObject(V),ue=typeof z=="object";for(re in ie)ie.hasOwnProperty(re)&&$(ie[re],z)===-1&&ie[re].push(ue?z:{listener:z,once:!1});return this},i.on=L("addListener"),i.addOnceListener=function(V,z){return this.addListener(V,{listener:z,once:!0})},i.once=L("addOnceListener"),i.defineEvent=function(V){return this.getListeners(V),this},i.defineEvents=function(V){for(var z=0;z<V.length;z+=1)this.defineEvent(V[z]);return this},i.removeListener=function(V,z){var re,ie,ue=this.getListenersAsObject(V);for(ie in ue)ue.hasOwnProperty(ie)&&(re=$(ue[ie],z))!==-1&&ue[ie].splice(re,1);return this},i.off=L("removeListener"),i.addListeners=function(V,z){return this.manipulateListeners(!1,V,z)},i.removeListeners=function(V,z){return this.manipulateListeners(!0,V,z)},i.manipulateListeners=function(V,z,re){var ie,ue,le=V?this.removeListener:this.addListener,oe=V?this.removeListeners:this.addListeners;if(typeof z!="object"||z instanceof RegExp)for(ie=re.length;ie--;)le.call(this,z,re[ie]);else for(ie in z)z.hasOwnProperty(ie)&&(ue=z[ie])&&(typeof ue=="function"?le.call(this,ie,ue):oe.call(this,ie,ue));return this},i.removeEvent=function(V){var z,re=typeof V,ie=this._getEvents();if(re==="string")delete ie[V];else if(V instanceof RegExp)for(z in ie)ie.hasOwnProperty(z)&&V.test(z)&&delete ie[z];else delete this._events;return this},i.removeAllListeners=L("removeEvent"),i.emitEvent=function(V,z){var re,ie,ue,le,oe=this.getListenersAsObject(V);for(le in oe)if(oe.hasOwnProperty(le))for(re=oe[le].slice(0),ue=0;ue<re.length;ue++)(ie=re[ue]).once===!0&&this.removeListener(V,ie.listener),ie.listener.apply(this,z||[])===this._getOnceReturnValue()&&this.removeListener(V,ie.listener);return this},i.trigger=L("emitEvent"),i.emit=function(V){var z=Array.prototype.slice.call(arguments,1);return this.emitEvent(V,z)},i.setOnceReturnValue=function(V){return this._onceReturnValue=V,this},i._getOnceReturnValue=function(){return!this.hasOwnProperty("_onceReturnValue")||this._onceReturnValue},i._getEvents=function(){return this._events||(this._events={})},y.noConflict=function(){return g.EventEmitter=k,y},(n=(function(){return y}).call(g,e,g,t))===void 0||(t.exports=n)})(typeof window<"u"?window:this||{})},function(t,r,e){var n=e(18),g=e(7),y=e(2),i=e(26),k=e(90),$=e(62),L=e(187),V=e(275),z="NEJ-UPLOAD-RESULT:",re={};function ie(oe){this.init(),L.call(this,oe)}var ue=L.prototype,le=ie.prototype=n(ue);le.init=function(){var oe=!1;function ae(qe){var de=qe.data;if(g(de).call(de,z)===0){var Ne=(de=JSON.parse(de.replace(z,""))).key,ze=re[Ne];ze&&(delete re[Ne],de.result=decodeURIComponent(de.result||""),ze.onLoad(de.result))}}return function(){(function(){if(!oe){oe=!0;var qe=$.getGlobal();qe.postMessage?$.on(qe,"message",ae):(V.addMsgListener(ae),V.startTimer())}})()}}(),le.doSend=function(){var oe=this,ae=oe.options,qe=oe.key="zoro-ajax-upload-iframe-"+$.uniqueID();re[qe]=oe;var de=oe.form=$.html2node('<form style="display:none;"></form>');typeof document>"u"||document.body.appendChild(de),de.target=qe,de.method="POST",de.enctype="multipart/form-data",de.encoding="multipart/form-data";var Ne=ae.url,ze=$.genUrlSep(Ne);de.action=Ne+ze+"_proxy_=form";var $e,Lt=ae.data,jt=[],Et=[];Lt&&y($e=$.getKeys(Lt,ae.putFileAtEnd)).call($e,function(Dt){var lr=Lt[Dt];if(lr.tagName&&lr.tagName.toUpperCase()==="INPUT"){if(lr.type==="file"){var sr=lr,er=sr.cloneNode(!0);sr.parentNode.insertBefore(er,sr);var cr=$.dataset(sr,"name");cr&&(sr.name=cr),de.appendChild(sr),$.isFunction(sr.setAttribute)&&(sr.setAttribute("form",""),sr.removeAttribute("form")),jt.push(lr),Et.push(er)}}else{var or=$.html2node('<input type="hidden"/>');or.name=Dt,or.value=lr,de.appendChild(or)}});function ir(){y(jt).call(jt,function(Dt,lr){var sr=Et[lr];sr.parentNode&&(Dt.name=sr.name,$.isFunction(Dt.setAttribute)&&Dt.setAttribute("form",sr.getAttribute("form")),sr.parentNode.replaceChild(Dt,sr))})}var dr=oe.iframe=$.createIframe({name:qe,onload:function(){var Dt;oe.aborted?ir():($.on(dr,"load",i(Dt=oe.checkResult).call(Dt,oe)),de.submit(),ir(),oe.afterSend())}})},le.checkResult=function(){var oe,ae;try{var qe,de;if(oe=this.iframe.contentWindow.document.body,ae=k(qe=oe.innerText||oe.textContent||"").call(qe),g(ae).call(ae,z)>=0||g(de=oe.innerHTML).call(de,z)>=0)return}catch{return}this.onLoad(ae)},le.onLoad=function(oe){ue.onLoad.call(this,{status:200,result:oe}),$.remove(this.form),$.remove(this.iframe),ue.destroy.call(this)},le.destroy=function(){$.remove(this.iframe),$.remove(this.form)},le.abort=function(){this.aborted=!0,delete re[this.key],ue.abort.call(this)},t.exports=ie},function(t,r,e){var n=e(578);t.exports=n},function(t,r,e){var n=e(19),g=e(579),y=String.prototype;t.exports=function(i){var k=i.trim;return typeof i=="string"||i===y||n(y,i)&&k===y.trim?g:k}},function(t,r,e){e(580);var n=e(29);t.exports=n("String").trim},function(t,r,e){var n=e(1),g=e(185).trim;n({target:"String",proto:!0,forced:e(581)("trim")},{trim:function(){return g(this)}})},function(t,r,e){var n=e(227).PROPER,g=e(5),y=e(148);t.exports=function(i){return g(function(){return!!y[i]()||"​᠎"[i]()!=="​᠎"||n&&y[i].name!==i})}},function(t,r,e){var n=e(18),g=e(7),y=e(26),i=e(2),k=e(62),$=e(275),L=e(187),V={};function z(ue){this.init(),L.call(this,ue)}var re=L.prototype,ie=z.prototype=n(re);ie.init=function(){var ue="NEJ-AJAX-DATA:",le=!1;function oe(ae){var qe=ae.data;if(g(qe).call(qe,ue)===0){var de=(qe=JSON.parse(qe.replace(ue,""))).key,Ne=V[de];Ne&&(delete V[de],qe.result=decodeURIComponent(qe.result||""),Ne.onLoad(qe))}}return function(){(function(){if(!le){le=!0;var ae=k.getGlobal();ae.postMessage?k.on(ae,"message",oe):$.addMsgListener(oe)}})()}}(),ie.doSend=function(){var ue=this.options,le=k.url2origin(ue.url),oe=ue.proxyUrl||le+"/res/nej_proxy_frame.html",ae=V[oe];if(k.isArray(ae)){var qe;ae.push(y(qe=this.doSend).call(qe,this,ue))}else{var de;if(!ae)return V[oe]=[y(de=this.doSend).call(de,this,ue)],void k.createIframe({src:oe,onload:function($e){var Lt=V[oe];V[oe]=k.target($e).contentWindow,i(Lt).call(Lt,function(jt){try{jt()}catch{}})}});if(!this.aborted){var Ne=this.key=k.uniqueID();V[Ne]=this;var ze=k.fetch({method:"GET",url:"",data:null,headers:{},timeout:0},ue);ze.key=Ne,$.postMessage(ae,{data:ze}),this.afterSend()}}},ie.abort=function(){this.aborted=!0,delete V[this.key],re.abort.call(this)},t.exports=z},function(t,r,e){var n,g,y=e(8),i=e(62),k=e(118),$=(n=/json/i,g=/post/i,function(L,V){var z=(V=V||{}).data=V.data||{},re=V.headers=V.headers||{},ie=i.checkWithDefault(re,"Accept","application/json"),ue=i.checkWithDefault(re,"Content-Type","application/json");return n.test(ie)&&(V.type="json"),g.test(V.method)&&n.test(ue)&&(V.data=y(z)),k(L,V)});t.exports=$},function(t,r,e){var n=e(4),g=e(16),y=e(7),i=e(2),k=e(6),$=e(15),L=e(24);t.exports={wrapSafeCallback:function(V,z){if(V.__wrapSafeCallback__)return V;V.__wrapSafeCallback__=!0;var re=n(V);return re=g(re).call(re,function(ie){return y(ie).call(ie,"on")===0&&Object.prototype.toString.call(V[ie])==="[object Function]"}),i(re).call(re,function(ie){var ue=V[ie];V[ie]=function(){var le=this;try{var oe;return ue.call.apply(ue,k(oe=[this]).call(oe,$(Array.prototype).call(arguments)))}catch(qe){var ae;this.logger.error(k(ae="wrapSafeCallback. CallbackName: ".concat(ie,". Error: ")).call(ae,qe)),L(function(){var de;throw le.logger.error(k(de="wrapSafeCallback. throw error in setTimeout. CallbackName: ".concat(ie,". Error: ")).call(de,qe)),qe},0),z.logger&&z.logger.error("userOption:".concat(ie," function error"),qe)}}}),V}}},function(t,r,e){var n=e(586);t.exports=n},function(t,r,e){e(587);var n=e(13);t.exports=n.Date.now},function(t,r,e){var n=e(1),g=e(12),y=Date,i=g(y.prototype.getTime);n({target:"Date",stat:!0},{now:function(){return i(new y)}})},function(t,r,e){var n=e(77).fn,g=e(0),y=e(25).reportAPI;n.isConnected=function(){return y({instance:this,className:"ApiBaseFn",funcName:"isConnected",hasCallback:!1}),!!this.protocol&&this.protocol.isConnected()},n.connect=function(){y({instance:this,className:"ApiBaseFn",funcName:"connect",hasCallback:!1}),this.protocol.processId=g.guid(),this.protocol.connect()},n.detectHeartbeat=function(){this.protocol.detectHeartbeat()},n.disconnect=function(){}},function(t,r,e){var n=e(22),g=e(8),y=e(26),i=e(9),k=e(37),$=e(15),L=e(141),V=e(90),z=e(7),re=e(48),ie=e(24),ue=e(10),le=e(32),oe=e(2),ae=e(6),qe=e(4),de=e(52),Ne=e(16),ze=e(53),$e=e(54),Lt=e(55),jt=e(43),Et=e(51),ir=e(125),dr=["loc_x","loc_y","loc_z"];function Dt(rr,kr){var Ir=qe(rr);if(de){var xr=de(rr);kr&&(xr=Ne(xr).call(xr,function(vr){return ze(rr,vr).enumerable})),Ir.push.apply(Ir,xr)}return Ir}function lr(rr){for(var kr=1;kr<arguments.length;kr++){var Ir,xr,vr=arguments[kr]!=null?arguments[kr]:{};kr%2?oe(Ir=Dt(Object(vr),!0)).call(Ir,function(_r){Et(rr,_r,vr[_r])}):$e?Lt(rr,$e(vr)):oe(xr=Dt(Object(vr))).call(xr,function(_r){jt(rr,_r,ze(vr,_r))})}return rr}var sr=e(77).fn,er=e(0),cr=e(608),or=e(41),hr=e(11),pr=e(277),Sr=e(278),Er=e(285),Pr=e(107).EMExceptionState,Cr=e(25).reportAPI;sr.sendText=function(rr){(rr=rr||{}).done=Cr({instance:this,className:"ApiBaseFn",funcName:"sendText",async:!0,done:rr.done});var kr=rr,Ir=kr.loc_x,xr=kr.loc_y,vr=kr.loc_z,_r=ir(kr,dr);return Ir===void 0||xr===void 0||vr===void 0?rr=lr({},_r):(typeof rr.loc_x!="number"&&(rr.loc_x=0),typeof rr.loc_y!="number"&&(rr.loc_y=0),typeof rr.loc_z!="number"&&(rr.loc_z=0)),this.processCallback(rr),rr.msg=new this.message.TextMessage(rr),this.sendMsg(rr)},sr.previewFile=function(rr,kr){var Ir;(rr=rr||{}).done=Cr({instance:this,className:"ApiBaseFn",funcName:"previewFile",done:rr.done});var xr=this,vr=xr.protocol.appGrayConfig;if(vr&&vr.grayConfig&&vr.grayConfig.mixStoreEnable&&(rr.mixEnable=!0),er.verifyOptions(rr,"done","msg::previewFile"),rr.type||(rr.type="file"),er.verifyParamPresentJustOne(rr,"dataURL blob fileInput filePath wxFilePath fileObject","msg::previewFile"),er.exist(rr.maxSize)&&er.verifyParamType("maxSize",rr.maxSize,"number","api::previewFile"),er.exist(rr.commonUpload)&&er.verifyParamType("commonUpload",rr.commonUpload,"boolean","api::previewFile"),rr.nosSurvivalTime?(er.verifyParamType("nosSurvivalTime",rr.nosSurvivalTime,"number","api::Base.getInstance"),er.verifyParamMin("nosSurvivalTime",rr.nosSurvivalTime,86400,"api::Base.getInstance")):rr.nosSurvivalTime=this.nosSurvivalTime,rr.filePath=rr.filePath||rr.wxFilePath,delete rr.wxFilePath,rr.dataURL)rr.blob=Er.fromDataURL(rr.dataURL);else if(!rr.blob){if(rr.fileInput){if(rr.fileInput=er.verifyFileInput(rr.fileInput,"msg::previewFile"),rr.fileInput.files){if(!rr.fileInput.files.length)return void rr.done(or.newNoFileError("请选择"+rr.type+"文件",{callFunc:"msg::previewFile",fileInput:rr.fileInput}),rr);rr.fileSize=rr.fileInput.files[0].size}rr.fileInputName=er.getFileName(rr.fileInput)}}this.processCallback(rr);var _r=g(pr.genResponseBody(rr.type)||{}).replace(/"/gi,'\\"'),Or=null,Mr=rr.transcode?"getNosTokenTrans":"getNosToken";if(rr.transcode){er.verifyOptions(rr,"fileInput","msg::previewFile");var yr=er.getFileInfo(rr.fileInput);Or={transToken:{name:yr.name,type:yr.transcodeType,transType:rr.transcode==="png"?11:10,size:yr.size,body:_r}}}else Or=_r;this[Mr]({responseBody:Or,nosToken:{nosScene:rr.nosScene||this.nosScene,nosSurvivalTime:rr.nosSurvivalTime},callback:y(Ir=function(mr,Tr){if(mr)rr.done(mr);else if(rr.transcode?(rr.nosToken=Tr.nosToken,rr.docId=Tr.docId):rr.nosToken=Tr,rr.logger=xr.logger,rr.mixEnable){var Br,$r;if(!this.protocol.mixStorePolicy)try{this.protocol.mixStorePolicy=JSON.parse(localStorage.getItem("NIM-AllMixStorePolicy"))[this.options.appKey]}catch(Lr){xr.logger.error("error:","get last mixStorePolicy failed",Lr)}if(!this.protocol.mixStorePolicy)return void xr.logger.error("error:","get mixStorePolicy failed");rr.providers=i(Br=this.protocol.mixStorePolicy.providers||[]).call(Br,function(Lr){return Number(Lr)}),rr.curProvider=rr.providers[0]?Number(rr.providers[0]):1,rr.nosPolicy=this.protocol.mixStorePolicy.nosPolicy,rr.s3Policy=this.protocol.mixStorePolicy.s3Policy,xr.getMixStoreToken({curProvider:rr.curProvider,responseBody:Or,callback:y($r=function(Lr,Gr){Lr?rr.done(Lr):(rr.mixStoreToken=Gr,rr.getMixStoreToken=function(qr,Yr){xr.getMixStoreToken({curProvider:qr,responseBody:Or,callback:function(bn,wn){bn?rr.done(bn):Yr(wn)}})},rr.curProvider===1&&(rr.nosToken=Gr),xr._doPreviewFile(rr,kr))}).call($r,xr)})}else this._doPreviewFile(rr,kr)}).call(Ir,this)})},sr._doPreviewFile=function(rr,kr){var Ir=this;rr=er.merge(rr,Ir.options.providers);var xr=hr.genUploadUrl(rr.nosToken.bucket);rr.mixEnable&&rr.curProvider===1&&(xr=hr.genUploadUrl(rr.mixStoreToken.bucket));var vr,_r=hr.chunkUploadUrl;Ir.logger.info("_doPreviewFile: start upload"),rr.commonUpload||!_r||hr.isWeixinApp||hr.isNodejs||hr.isRN?(rr.commonUpload=!0,vr=xr):(vr=_r,rr.nosLbsUrls=hr.nosLbsUrls,Ir.options.edgeList?rr.edgeList=Ir.options.edgeList:rr.updateNosEdgeList=function(Tr){Ir.options.edgeList=Tr}),Ir.protocol.reporterHook.emit("reporter/uploadStart");var Or=this.assembleUploadParams(rr.nosToken);rr.mixEnable&&rr.curProvider===1&&(Or=this.assembleUploadParams(rr.mixStoreToken));function Mr(Tr,Br,$r,Lr){if(Tr){var Gr=er.get(Tr,"msg.message")||er.get(Tr,"message")||"Unknown error message",qr=er.get(Tr,"msg.code")||er.get(Tr,"code")||"Unknown error code";Ir.logger.warn("_doPreviewFile: upload done, failed ",qr,Gr),Ir.protocol.reporterHook.emit("reporter/uploadEnd",Tr.code==="RequestAbortedError"||Tr.code==="abort"?Pr.kCanceled:Pr.kFailed);var Yr=k({},Lr||kr,{status:"fail"}),bn=lr(lr({},rr.callback.options),{},{msg:Yr});return rr.uploaddone&&rr.uploaddone(Tr,bn,Yr),void rr.done(Tr,rr.callback.options)}if(Ir.logger.info("_doPreviewFile: upload done, success"),Ir.protocol.reporterHook.emit("reporter/uploadEnd",Pr.kSucceed),rr.uploaddone&&rr.uploaddone(null,er.copy(Br),Lr||kr),Br=pr.parseResponse(Br,Ir.options.exifOrientation),$r||Br.isS3||(Br.url=hr.genDownloadUrl(rr.nosToken,Or.Object,hr.serverNosConfig.cdnDomain),rr.nosToken.shortUrl&&(Br._url_safe=rr.nosToken.shortUrl)),er.exist(rr.fileInputName))Br.name=rr.fileInputName;else if(rr.blob){var wn=rr.blob.name;if(Br.name=wn||"blob-"+Br.md5,!wn){var Xr=rr.blob.type;Br.ext=$(Xr).call(Xr,L(Xr).call(Xr,"/")+1)}}else rr.filePath?Br.name=rr.filePath:rr.fileObject&&(Br.name=rr.fileObject.fileName);if(!Br.ext){var Vn,Zr,Nn=L(Vn=Br.name).call(Vn,".");Nn===-1?Br.ext="unknown":Br.ext=$(Zr=Br.name).call(Zr,Nn+1)}Br.size=Br.size||0,Br.isS3&&Br._url_safe?Ir.getNosOriginUrl({safeShortUrl:Br._url_safe,done:function(Qr,kn){Qr?Ir.logger.error("error:","getNosOriginUrl failed",Qr):(Br.url=kn,rr.done(null,er.copy(Br)))}}):rr.done(null,er.copy(Br))}if(hr.isWeixinApp)er.verifyOptions(rr,"filePath","msg::_doPreviewFile"),Ir.fileQuickTransfer(rr,Mr,function(){var Tr=wx.uploadFile({url:vr,filePath:rr.filePath,name:"file",formData:Or,fail:function(Br){Mr({code:"FAILED",msg:Br}),Ir.logger.error("error:","api::msg:upload file failed",Br)},success:function(Br){if(Br.statusCode===200)try{Mr(null,JSON.parse(Br.data))}catch($r){Ir.logger.error("error:","parse wx upload file res error",$r),Mr({code:"PARSE_WX_UPLOAD_FILE_RES_ERROR",str:Br.data,msg:Br.errMsg})}else Mr({code:Br.statusCode,msg:Br.errMsg})}});typeof rr.uploadprogress=="function"&&Tr&&(rr.beginupload(Tr,kr),Ir.logger.info("_doPreviewFile::mini uploadprogress"),Tr.onProgressUpdate(function(Br){rr.uploadprogress({total:Br.totalBytesExpectedToSend,loaded:Br.totalBytesSent,percentage:Br.progress,percentageText:Br.progress+"%"},kr)}))});else if(hr.isNodejs){var yr={url:vr,name:"file",formData:Or,success:function(Tr){if(Tr.statusCode===200)try{Mr(null,JSON.parse(Tr.data))}catch(Br){Ir.protocol.logger.error("error:","parse nodejs upload file res error",Br),Mr({code:"PARSE_NODEJS_UPLOAD_FILE_RES_ERROR",str:Tr.data,msg:Tr.errMsg})}else Mr({code:Tr.statusCode,msg:Tr.errMsg})},fail:function(Tr){Mr({code:"FAILED",msg:Tr}),Ir.protocol.logger.error("error:","api::msg:upload file failed",Tr)}};if(rr.filePath)yr.filePath=rr.filePath;else{if(n(rr.fileObject)!=="object")throw new or("Nodejs上传fileObject参数类型应如 {fileName:..,fileData:..} ");yr.fileData=rr.fileObject.fileData}Ir.fileQuickTransfer(rr,Mr,function(){Sr.uploadFile(yr)})}else if(hr.isRN){var mr={url:vr,name:"file",formData:Or,filePath:rr.filePath,success:function(Tr){if(Tr.ok&&Tr.status===200)try{var Br=i(Tr.headers)&&i(Tr.headers).etag;Tr.md5=Br?typeof Br=="string"?Br:Br[0]:"UNKNOWN",Mr(null,Tr)}catch($r){Ir.protocol.logger.error("error:","parse React Native upload file res error",$r),Mr({code:"PARSE_React_Native_UPLOAD_FILE_RES_ERROR",res:Tr})}else Mr({code:Tr.status,msg:Tr.statusText})},fail:function(Tr){Mr({code:"FAILED",msg:Tr}),Ir.protocol.logger.error("error:","api::msg:upload file failed",Tr)}};Ir.fileQuickTransfer(rr,Mr,function(){Sr.uploadFile(mr)})}else rr.url=vr,rr.params=Or,rr.fileName="file",Ir.fileQuickTransfer(rr,Mr,function(){return Ir.protocol.adaptersUploadFile(k({},rr,{uploaddone:Mr}),kr)})},sr.fileQuickTransfer=function(rr,kr,Ir){var xr,vr=this;rr=rr||{},kr instanceof Function||(kr=function(){}),Ir instanceof Function||(Ir=function(){});var _r=rr.fastPass;if(_r)try{_r=JSON.parse(_r),rr.fastPass=_r}catch{vr.protocol.logger.error("快传参数解析失败")}var Or=rr.fileInputName||rr.name||rr.blob&&rr.blob.name||"",Mr=rr.fileSize||rr.size||rr.blob&&rr.blob.size||0,yr=_r?V(xr=(_r.md5||rr.digest||"")+"").call(xr):"",mr=rr.type||rr.blob&&rr.blob.type;if(yr&&Mr>=hr.threshold){var Tr=!0,Br={name:Or,md5:yr,ext:$(Or).call(Or,L(Or).call(Or,".")+1),type:mr};switch(mr){case"image":_r&&_r.w&&_r.h?(Br.w=_r.w,Br.h=_r.h):(Tr=!1,vr.protocol.logger.error("快传 image 文件缺少参数 w 或 h"));break;case"video":_r&&_r.w&&_r.h&&_r.dur?(Br.w=_r.w,Br.h=_r.h,Br.dur=_r.dur):(Tr=!1,vr.protocol.logger.error("快传 video 文件缺少参数 w 或 h 或 dur"));break;case"audio":_r&&_r.dur?Br.dur=_r.dur:(Tr=!1,vr.protocol.logger.error("快传 audio 文件缺少参数 dur"))}if(!Tr)return void Ir();var $r={fileQuickTransfer:{md5:yr}};return Mr&&($r.fileQuickTransfer.size=Mr),this.protocol.sendCmd("fileQuickTransfer",$r,function(Lr,Gr,qr){!Lr&&qr&&qr.fileQuickTransfer&&qr.fileQuickTransfer.url||(vr.protocol.logger.error("misc::fileQuickTransfer: not found",Lr,Gr),Ir()),qr&&qr.fileQuickTransfer&&qr.fileQuickTransfer.threshold&&(hr.threshold=qr.fileQuickTransfer.threshold||0),qr&&qr.fileQuickTransfer&&qr.fileQuickTransfer.url&&(Br.size=Mr||qr.fileQuickTransfer.size,Br.url=qr.fileQuickTransfer.url,qr.fileQuickTransfer._url_safe&&(Br._url_safe=qr.fileQuickTransfer._url_safe),kr(Lr,Br,!0))})}Ir()},sr.sendFile=function(rr){if((rr=rr||{}).done=Cr({instance:this,className:"ApiBaseFn",funcName:"sendFile",done:rr.done}),rr.type||(rr.type="file"),rr=er.merge(rr,this.options.providers),er.verifyParamPresentJustOne(rr,"dataURL blob fileInput file filePath wxFilePath fileObject","msg::sendFile"),er.exist(rr.maxSize)&&er.verifyParamType("maxSize",rr.maxSize,"number","api::previewFile"),er.exist(rr.commonUpload)&&er.verifyParamType("commonUpload",rr.commonUpload,"boolean","api::previewFile"),this.processCallback(rr),rr.filePath=rr.filePath||rr.wxFilePath,delete rr.wxFilePath,rr.dataURL)return this._previewAndSendFile(rr);if(rr.blob)return this._previewAndSendFile(rr);if(rr.fileInput)return rr.fileInput=er.verifyFileInput(rr.fileInput,"msg::sendFile"),rr.fileInput.files&&!rr.fileInput.files.length?void rr.done(or.newNoFileError("请选择"+rr.type+"文件",{callFunc:"msg::sendFile",fileInput:rr.fileInput}),rr.callback.options):this._previewAndSendFile(rr);if(rr.filePath||rr.fileObject)return this._previewAndSendFile(rr);if(rr.file){var kr,Ir=rr.file._url_safe;return Ir&&(kr=rr.file.url,rr.file.url=Ir,delete rr.file._url_safe),rr.msg=new this.message.FileMessage(rr),this.sendMsg(rr,kr)}},sr._previewAndSendFile=function(rr){var kr=this;er.verifyCallback(rr,"uploaddone beforesend","msg::_previewAndSendFile");var Ir=lr({},rr),xr=new kr.message.Message(Ir);xr.type=rr.type;var vr=kr.formatReturnMsg(xr),_r=kr.protocol.reporterHook.getSafeClock(),Or={apiCallingTime:kr.protocol.reporterHook.getNTPTime(_r),attachUploadDuration:0},Mr=rr.done;return rr.done=function(yr,mr){if(rr.done=Mr,yr){var Tr=k({},vr,{status:"fail"}),Br=lr(lr({},rr.callback.options),{},{msg:Tr});rr.done(yr,Br)}else{if(Or.attachUploadDuration=kr.protocol.reporterHook.getSafeClock()-_r,/chatroom/.test(rr.scene))return;var $r,Lr=mr._url_safe;Lr&&!mr.isS3&&($r=mr.url,mr.url=Lr,delete mr._url_safe),rr.file=mr,rr.msg=new kr.message.FileMessage(rr,xr.idClient),rr.beforesend(kr.sendMsg(rr,$r,Or))}},kr.previewFile(rr,vr),vr},sr.assembleUploadParams=function(rr){return rr?{Object:decodeURIComponent(rr.objectName),"x-nos-token":rr.token,"x-nos-entity-type":"json"}:null},sr.deleteFile=function(rr){Cr({instance:this,className:"ApiBaseFn",funcName:"deleteFile",hasCallback:!1}),er.verifyParamPresentJustOne(rr,"docId","msg::deleteFile"),this.removeFile({docId:rr.docId,callback:function(kr,Ir){kr?rr.error&&rr.error(kr,Ir):rr.success&&rr.success(Ir)}})},sr.getFile=function(rr){Cr({instance:this,className:"ApiBaseFn",funcName:"getFile",hasCallback:!1}),er.verifyParamPresentJustOne(rr,"docId","msg::getFile"),this.fetchFile({docId:rr.docId,callback:function(kr,Ir){kr?rr.error&&rr.error(kr,Ir):rr.success&&rr.success(Ir.info)}})},sr.getFileList=function(rr){Cr({instance:this,className:"ApiBaseFn",funcName:"getFileList",hasCallback:!1});var kr=rr.fromDocId,Ir=kr===void 0?"":kr,xr=rr.limit,vr=xr===void 0?10:xr,_r={limit:vr};Ir&&(_r.fromDocId=Ir),this.fetchFileList({fileListParam:_r,callback:function(Or,Mr){Or?(vr>30&&(Or.message=Or.message+"::文档条数超过限制:30"),rr.error&&rr.error(Or,Mr)):rr.success&&rr.success(Mr)}})},sr.sendGeo=function(rr){return(rr=rr||{}).done=Cr({instance:this,className:"ApiBaseFn",funcName:"sendGeo",done:rr.done}),this.processCallback(rr),rr.msg=new this.message.GeoMessage(rr),this.sendMsg(rr)},sr.sendTipMsg=function(rr){return(rr=rr||{}).done=Cr({instance:this,className:"ApiBaseFn",funcName:"sendTipMsg",done:rr.done}),this.processCallback(rr),rr.msg=new this.message.TipMessage(rr),this.sendMsg(rr)},sr.sendCustomMsg=function(rr){return(rr=rr||{}).done=Cr({instance:this,className:"ApiBaseFn",funcName:"sendCustomMsg",done:rr.done}),this.processCallback(rr),rr.msg=new this.message.CustomMessage(rr),this.sendMsg(rr)},sr.sendRobotMsg=function(rr){return(rr=rr||{}).done=Cr({instance:this,className:"ApiBaseFn",funcName:"sendRobotMsg",done:rr.done}),this.logger.warn("this api will be abandon"),this.processCallback(rr),rr.msg=new this.message.RobotMessage(rr),this.sendMsg(rr)},sr.sendMsg=function(rr,kr,Ir){var xr=this,vr=xr.protocol,_r=rr.msg,Or={};Ir=Ir||{apiCallingTime:vr.reporterHook.getNTPTime(),attachUploadDuration:0};var Mr,yr=!!rr.isLocal;if(this.logger.warn("sendMsg::start: "+_r.idClient),yr&&(rr.time&&(_r.time=rr.time),rr.idClient&&(_r.idClient=rr.idClient),rr.localFrom&&(Mr=rr.localFrom+"")),rr.resend&&(rr.flow!=="out"||rr.status!=="fail"))return er.onError("只能重发发送失败的消息");rr.callback.options.idClient=_r.idClient,xr.beforeSendMsg(rr,Or);var mr=rr.rtnMsg=xr.formatReturnMsg(_r,Mr);if(kr&&!xr.options.keepNosSafeUrl&&mr.file&&(mr.file._url_safe=mr.file.url,mr.file.url=kr,mr.type==="audio"&&(mr.file.mp3Url=kr+(~z(kr).call(kr,"?")?"&":"?")+"audioTrans&type=mp3")),mr.hasOwnProperty("chatroomId")&&!mr.chatroomId)return er.onError("聊天室未连接");if(yr&&(mr.status="success",mr.isLocal=!0),vr.storeSendMsg&&(Or.promise=vr.storeSendMsg(mr)),rr.cbaop=function(Br,$r){if(Br)return Br.code===7101&&(mr.isInBlackList=!0,mr.idServer=$r.idServer,mr.time=$r.time),Br.from!=="server"?(mr.status="fail",vr.updateSendMsgError&&vr.updateSendMsgError(mr),mr):void 0},!yr){kr&&!xr.options.keepNosSafeUrl&&rr.callback&&(rr.callback.originUrl=kr),rr.toAccids&&rr.toAccids.length&&(_r.toAccids=g(rr.toAccids)),Or.msg=_r,Ir.sendTime=vr.reporterHook.getNTPTime(),vr.reporterHook.hasOriginTimetick()&&(Or.msg.__clientExt=g({statistics:Ir}));var Tr=_r;xr.sendCmd(rr.cmd,Or,function(){if(hr.isBrowser){var Br=arguments[0],$r=arguments[1]||{},Lr=xr.subType==="chatroom",Gr=Tr.scene===0,qr=vr.reporterHook.getNTPTime(),Yr={msgId:$r.idServer,clientId:Tr.idClient,msgTime:$r.time||0,fromAccid:xr.account,toAccid:Gr?Tr.to:"",type:Lr?4:Tr.scene,roomId:Lr?xr.options.chatroomId:"",tid:Lr||Gr?"":Tr.to,result:Br?Br.code:200,failReason:Br?Br.message:"",rt:re(qr-Ir.apiCallingTime),apiCallingTime:Ir.apiCallingTime,sendTime:Ir.sendTime,attachUploadDuration:Ir.attachUploadDuration,apiCallbackTime:qr};xr.reporter&&xr.reporter.report("msgSend",Yr)}rr.callback&&rr.callback.apply(xr,arguments);var bn=arguments[0],wn=arguments[1];!bn&&wn&&wn.from===wn.to&&xr.protocol.markMsgRead(wn)})}return xr.afterSendMsg(rr),yr&&ie(function(){mr=er.simpleClone(mr),rr.done(null,mr)},0),er.copy(mr)},sr.beforeSendMsg=function(){},sr.afterSendMsg=function(){},sr.formatReturnMsg=function(rr,kr){var Ir;return rr=er.copy(rr),this.protocol.completeMsg(rr),rr.status="sending",kr&&(rr.from=kr),rr=ue(Ir=this.message).call(Ir,rr),rr=this.protocol.amendMsg(rr)},sr.resendMsg=function(rr){return(rr=rr||{}).done=Cr({instance:this,className:"ApiBaseFn",funcName:"resendMsg",done:rr.done}),er.verifyOptions(rr,"msg","msg::resendMsg"),this.trimMsgFlag(rr),rr.resend=!0,this._sendMsgByType(rr)},sr.forwardMsg=function(rr){return(rr=rr||{}).done=Cr({instance:this,className:"ApiBaseFn",funcName:"forwardMsg",done:rr.done}),er.verifyOptions(rr,"msg","msg::forwardMsg"),this.trimMsgFlag(rr),this.beforeForwardMsg(rr),rr.forward=!0,rr.msg.idClient=er.guid(),this._sendMsgByType(rr)},sr.trimMsgFlag=function(rr){rr&&rr.msg&&(rr.msg=er.copy(rr.msg),delete rr.msg.resend,delete rr.msg.forward)},sr.beforeForwardMsg=function(){},sr._sendMsgByType=function(rr){switch(er.verifyOptions(rr,"msg","msg::_sendMsgByType"),er.verifyParamValid("msg.type",rr.msg.type,this.message.validTypes,"msg::_sendMsgByType"),er.merge(rr,rr.msg),rr.type){case"text":return this.sendText(rr);case"image":case"audio":case"video":case"file":return this.sendFile(rr);case"geo":return this.sendGeo(rr);case"custom":return this.sendCustomMsg(rr);case"tip":return this.sendTipMsg(rr);default:throw new or("不能发送类型为 "+rr.type+" 的消息")}},sr.parseRobotTemplate=function(rr){if(this.logger.warn("this api will be abandon"),/<template[^>/]+\/>/.test(rr))return{raw:rr,json:[{type:"text",name:"",text:""}]};if(!/<template[^>/]+>/.test(rr))return{raw:rr,json:[{type:"text",name:"",text:rr}]};var kr=new cr({escapeMode:!1});rr=rr.replace(/<template [^>]+>/,"<template>");var Ir=kr.xml2js(rr);Ir=Ir.template.LinearLayout,le(Ir)||(Ir=[Ir]);var xr=[];return Ir=oe(Ir).call(Ir,function(Or){Or.image&&(xr=ae(xr).call(xr,_r(Or))),Or.text&&(xr=ae(xr).call(xr,vr(Or))),Or.link&&(xr=ae(xr).call(xr,function(Mr){if(Mr.link){var yr=Mr.link;le(yr)||(yr=[yr]),yr=i(yr).call(yr,function(mr){return mr.image&&(mr.image=_r(mr)),mr.text&&(mr.text=vr(mr)),mr._type==="url"?(mr.type="url",mr.style=mr._style||"",mr.target=mr._target,delete mr._target,delete mr._style):mr._type==="block"&&(mr.type="block",mr.style=mr._style||"",mr.params=mr._params||"",mr.target=mr._target,delete mr._params,delete mr._target,delete mr._style),delete mr._type,mr}),Mr.link=yr}return Mr.link}(Or)))}),{raw:rr,json:xr};function vr(Or){var Mr;return le(Or.text)||(Or.text=[Or.text]),Or.text=i(Mr=Or.text).call(Mr,function(yr){return{type:"text",name:yr._name,text:yr.__text}}),Or.text}function _r(Or){var Mr;return le(Or.image)||(Or.image=[Or.image]),Or.image=i(Mr=Or.image).call(Mr,function(yr){return{type:"image",name:yr._name,url:yr._url}}),Or.image}}},function(t,r,e){e(591);var n=e(13);t.exports=n.Object.assign},function(t,r,e){var n=e(1),g=e(592);n({target:"Object",stat:!0,arity:2,forced:Object.assign!==g},{assign:g})},function(t,r,e){var n=e(27),g=e(12),y=e(20),i=e(5),k=e(120),$=e(135),L=e(150),V=e(42),z=e(127),re=Object.assign,ie=Object.defineProperty,ue=g([].concat);t.exports=!re||i(function(){if(n&&re({b:1},re(ie({},"a",{enumerable:!0,get:function(){ie(this,"b",{value:3,enumerable:!1})}}),{b:2})).b!==1)return!0;var le={},oe={},ae=Symbol();return le[ae]=7,"abcdefghijklmnopqrst".split("").forEach(function(qe){oe[qe]=qe}),re({},le)[ae]!=7||k(re({},oe)).join("")!="abcdefghijklmnopqrst"})?function(le,oe){for(var ae=V(le),qe=arguments.length,de=1,Ne=$.f,ze=L.f;qe>de;)for(var $e,Lt=z(arguments[de++]),jt=Ne?ue(k(Lt),Ne(Lt)):k(Lt),Et=jt.length,ir=0;Et>ir;)$e=jt[ir++],n&&!y(ze,Lt,$e)||(ae[$e]=Lt[$e]);return ae}:re},function(t,r,e){var n=e(19),g=e(594),y=Array.prototype;t.exports=function(i){var k=i.reverse;return i===y||n(y,i)&&k===y.reverse?g:k}},function(t,r,e){e(595);var n=e(29);t.exports=n("Array").reverse},function(t,r,e){var n=e(1),g=e(12),y=e(83),i=g([].reverse),k=[1,2];n({target:"Array",proto:!0,forced:String(k)===String(k.reverse())},{reverse:function(){return y(this)&&(this.length=this.length),i(this)}})},function(t,r,e){t.exports=e(597)},function(t,r,e){t.exports=e(598)},function(t,r,e){var n=e(599);t.exports=n},function(t,r,e){var n=e(255);t.exports=n},function(t,r,e){t.exports=e(601)},function(t,r,e){var n=e(602);t.exports=n},function(t,r,e){var n=e(207);t.exports=n},function(t,r,e){var n=e(604),g=e(188);t.exports=function(y,i){if(y==null)return{};var k,$,L={},V=n(y);for($=0;$<V.length;$++)k=V[$],g(i).call(i,k)>=0||(L[k]=y[k]);return L},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,r,e){t.exports=e(605)},function(t,r,e){t.exports=e(606)},function(t,r,e){var n=e(607);t.exports=n},function(t,r,e){var n=e(231);t.exports=n},function(t,r,e){var n,g,y;(function(i,k){g=[],(y=typeof(n=function($){return function(L){(L=L||{}).arrayAccessForm=L.arrayAccessForm||"none",L.emptyNodeForm=L.emptyNodeForm||"text",L.jsAttributeFilter=L.jsAttributeFilter,L.jsAttributeConverter=L.jsAttributeConverter,L.attributeConverters=L.attributeConverters||[],L.datetimeAccessFormPaths=L.datetimeAccessFormPaths||[],L.arrayAccessFormPaths=L.arrayAccessFormPaths||[],L.xmldomOptions=L.xmldomOptions||{},L.enableToStringFunc===void 0&&(L.enableToStringFunc=!0),L.skipEmptyTextNodesForObj===void 0&&(L.skipEmptyTextNodesForObj=!0),L.stripWhitespaces===void 0&&(L.stripWhitespaces=!0),L.useDoubleQuotes===void 0&&(L.useDoubleQuotes=!0),L.ignoreRoot===void 0&&(L.ignoreRoot=!1),L.escapeMode===void 0&&(L.escapeMode=!0),L.attributePrefix===void 0&&(L.attributePrefix="_"),L.selfClosingElements===void 0&&(L.selfClosingElements=!0),L.keepCData===void 0&&(L.keepCData=!1),L.keepText===void 0&&(L.keepText=!1),L.jsDateUTC===void 0&&(L.jsDateUTC=!1),function(){function sr(er){var cr=String(er);return cr.length===1&&(cr="0"+cr),cr}typeof String.prototype.trim!="function"&&(String.prototype.trim=function(){return this.replace(/^\s+|^\n+|(\s|\n)+$/g,"")}),typeof Date.prototype.toISOString!="function"&&(Date.prototype.toISOString=function(){return this.getUTCFullYear()+"-"+sr(this.getUTCMonth()+1)+"-"+sr(this.getUTCDate())+"T"+sr(this.getUTCHours())+":"+sr(this.getUTCMinutes())+":"+sr(this.getUTCSeconds())+"."+String((this.getUTCMilliseconds()/1e3).toFixed(3)).slice(2,5)+"Z"})}();var V=1,z=3,re=4,ie=8,ue=9;function le(sr){var er=sr.localName;return er==null&&(er=sr.baseName),er!=null&&er!==""||(er=sr.nodeName),er}function oe(sr){return typeof sr=="string"?sr.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;"):sr}function ae(sr,er,cr){switch(L.arrayAccessForm){case"property":sr[er]instanceof Array?sr[er+"_asArray"]=sr[er]:sr[er+"_asArray"]=[sr[er]]}if(!(sr[er]instanceof Array)&&L.arrayAccessFormPaths.length>0){for(var or=!1,hr=0;hr<L.arrayAccessFormPaths.length;hr++){var pr=L.arrayAccessFormPaths[hr];if(typeof pr=="string"){if(pr===cr){or=!0;break}}else if(pr instanceof RegExp){if(pr.test(cr)){or=!0;break}}else if(typeof pr=="function"&&pr(er,cr)){or=!0;break}}or&&(sr[er]=[sr[er]])}}function qe(sr){var er=sr.split(/[-T:+Z]/g),cr=new Date(er[0],er[1]-1,er[2]),or=er[5].split(".");if(cr.setHours(er[3],er[4],or[0]),or.length>1&&cr.setMilliseconds(or[1]),er[6]&&er[7]){var hr=60*er[6]+Number(er[7]);hr=0+((/\d\d-\d\d:\d\d$/.test(sr)?"-":"+")=="-"?-1*hr:hr),cr.setMinutes(cr.getMinutes()-hr-cr.getTimezoneOffset())}else sr.indexOf("Z",sr.length-1)!==-1&&(cr=new Date(Date.UTC(cr.getFullYear(),cr.getMonth(),cr.getDate(),cr.getHours(),cr.getMinutes(),cr.getSeconds(),cr.getMilliseconds())));return cr}function de(sr,er){for(var cr={__cnt:0},or=sr.childNodes,hr=0;hr<or.length;hr++){var pr=or.item(hr),Sr=le(pr);pr.nodeType!==ie&&(cr.__cnt++,cr[Sr]==null?(cr[Sr]=Ne(pr,er+"."+Sr),ae(cr,Sr,er+"."+Sr)):(cr[Sr]instanceof Array||(cr[Sr]=[cr[Sr]],ae(cr,Sr,er+"."+Sr)),cr[Sr][cr[Sr].length]=Ne(pr,er+"."+Sr)))}for(var Er=0;Er<sr.attributes.length;Er++){var Pr=sr.attributes.item(Er);cr.__cnt++;for(var Cr=Pr.value,rr=0;rr<L.attributeConverters.length;rr++){var kr=L.attributeConverters[rr];kr.test.call(null,Pr.name,Pr.value)&&(Cr=kr.convert.call(null,Pr.name,Pr.value))}cr[L.attributePrefix+Pr.name]=Cr}var Ir=sr.prefix;return Ir&&(cr.__cnt++,cr.__prefix=Ir),cr["#text"]&&(cr.__text=cr["#text"],cr.__text instanceof Array&&(cr.__text=cr.__text.join(`
`)),L.escapeMode&&(cr.__text=cr.__text.replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&#x27;/g,"'").replace(/&amp;/g,"&")),L.stripWhitespaces&&(cr.__text=cr.__text.trim()),delete cr["#text"],L.arrayAccessForm==="property"&&delete cr["#text_asArray"],cr.__text=function(xr,vr,_r){if(L.datetimeAccessFormPaths.length>0)for(var Or=_r.split(".#")[0],Mr=0;Mr<L.datetimeAccessFormPaths.length;Mr++){var yr=L.datetimeAccessFormPaths[Mr];if(typeof yr=="string"){if(yr===Or)return qe(xr)}else if(yr instanceof RegExp){if(yr.test(Or))return qe(xr)}else if(typeof yr=="function"&&yr(Or))return qe(xr)}return xr}(cr.__text,0,er+".#text")),cr.hasOwnProperty("#cdata-section")&&(cr.__cdata=cr["#cdata-section"],delete cr["#cdata-section"],L.arrayAccessForm==="property"&&delete cr["#cdata-section_asArray"]),cr.__cnt===1&&cr.__text&&!L.keepText?cr=cr.__text:cr.__cnt===0&&L.emptyNodeForm==="text"?cr="":cr.__cnt>1&&cr.__text!==void 0&&L.skipEmptyTextNodesForObj&&(L.stripWhitespaces&&cr.__text===""||cr.__text.trim()==="")&&delete cr.__text,delete cr.__cnt,L.keepCData||cr.hasOwnProperty("__text")||!cr.hasOwnProperty("__cdata")||Object.keys(cr).length!==1?(L.enableToStringFunc&&(cr.__text||cr.__cdata)&&(cr.toString=function(){return(this.__text?this.__text:"")+(this.__cdata?this.__cdata:"")}),cr):cr.__cdata?cr.__cdata:""}function Ne(sr,er){return sr.nodeType===ue?function(cr){for(var or={},hr=cr.childNodes,pr=0;pr<hr.length;pr++){var Sr=hr.item(pr);if(Sr.nodeType===V){var Er=le(Sr);L.ignoreRoot?or=Ne(Sr,Er):or[Er]=Ne(Sr,Er)}}return or}(sr):sr.nodeType===V?de(sr,er):sr.nodeType===z||sr.nodeType===re?sr.nodeValue:null}function ze(sr,er,cr,or){var hr="<"+(sr&&sr.__prefix?sr.__prefix+":":"")+er;if(cr)for(var pr=0;pr<cr.length;pr++){var Sr=cr[pr],Er=sr[Sr];L.escapeMode&&(Er=oe(Er)),hr+=" "+Sr.substr(L.attributePrefix.length)+"=",L.useDoubleQuotes?hr+='"'+Er+'"':hr+="'"+Er+"'"}return hr+=or?" />":">"}function $e(sr,er){return"</"+(sr&&sr.__prefix?sr.__prefix+":":"")+er+">"}function Lt(sr,er){return L.arrayAccessForm==="property"&&(cr=er.toString(),or="_asArray",cr.indexOf(or,cr.length-or.length)!==-1)||er.toString().indexOf(L.attributePrefix)===0||er.toString().indexOf("__")===0||sr[er]instanceof Function;var cr,or}function jt(sr){var er=0;if(sr instanceof Object)for(var cr in sr)Lt(sr,cr)||er++;return er}function Et(sr){var er=[];if(sr instanceof Object)for(var cr in sr)cr.toString().indexOf("__")===-1&&cr.toString().indexOf(L.attributePrefix)===0&&er.push(cr);return er}function ir(sr){var er="";return sr instanceof Object?er+=function(cr){var or="";return cr.__cdata&&(or+="<![CDATA["+cr.__cdata+"]]>"),(cr.__text||typeof cr.__text=="number"||typeof cr.__text=="boolean")&&(L.escapeMode?or+=oe(cr.__text):or+=cr.__text),or}(sr):sr!==null&&(L.escapeMode?er+=oe(sr):er+=sr),er}function dr(sr,er,cr){var or="";return L.jsAttributeFilter&&L.jsAttributeFilter.call(null,er,sr)||(L.jsAttributeConverter&&(sr=L.jsAttributeConverter.call(null,er,sr)),sr!=null&&sr!==""||!L.selfClosingElements?typeof sr=="object"?Object.prototype.toString.call(sr)==="[object Array]"?or+=function(hr,pr,Sr){var Er="";if(hr.length===0)Er+=ze(hr,pr,Sr,!0);else for(var Pr=0;Pr<hr.length;Pr++)Er+=dr(hr[Pr],pr,Et(hr[Pr]));return Er}(sr,er,cr):sr instanceof Date?(or+=ze(sr,er,cr,!1),or+=L.jsDateUTC?sr.toUTCString():sr.toISOString(),or+=$e(sr,er)):jt(sr)>0||typeof sr.__text=="number"||typeof sr.__text=="boolean"||sr.__text||sr.__cdata?(or+=ze(sr,er,cr,!1),or+=Dt(sr),or+=$e(sr,er)):L.selfClosingElements?or+=ze(sr,er,cr,!0):(or+=ze(sr,er,cr,!1),or+=$e(sr,er)):(or+=ze(sr,er,cr,!1),or+=ir(sr),or+=$e(sr,er)):or+=ze(sr,er,cr,!0)),or}function Dt(sr){var er="";if(jt(sr)>0){for(var cr in sr)if(!Lt(sr,cr)){var or=sr[cr];er+=dr(or,cr,Et(or))}}return er+=ir(sr)}function lr(sr){if(sr===void 0||typeof sr!="string")return null;var er=null,cr=null;if($)cr=(er=new $(L.xmldomOptions)).parseFromString(sr,"text/xml");else if(window&&window.DOMParser){er=new window.DOMParser;var or=null;if(!(window.ActiveXObject||"ActiveXObject"in window)&&document.all&&!document.addEventListener)try{or=er.parseFromString("INVALID","text/xml").childNodes[0].namespaceURI}catch{or=null}try{cr=er.parseFromString(sr,"text/xml"),or!==null&&cr.getElementsByTagNameNS(or,"parsererror").length>0&&(cr=null)}catch{cr=null}}else sr.indexOf("<?")===0&&(sr=sr.substr(sr.indexOf("?>")+2)),(cr=new ActiveXObject("Microsoft.XMLDOM")).async="false",cr.loadXML(sr);return cr}this.asArray=function(sr){return sr==null?[]:sr instanceof Array?sr:[sr]},this.toXmlDateTime=function(sr){return sr instanceof Date?sr.toISOString():typeof sr=="number"?new Date(sr).toISOString():null},this.asDateTime=function(sr){return typeof sr=="string"?qe(sr):sr},this.xml2dom=function(sr){return lr(sr)},this.dom2js=function(sr){return Ne(sr,null)},this.js2dom=function(sr){return lr(this.js2xml(sr))},this.xml2js=function(sr){var er=lr(sr);return er!=null?this.dom2js(er):null},this.js2xml=function(sr){return Dt(sr)},this.getVersion=function(){return"3.4.4"}}})=="function"?n.apply(r,g):n)===void 0||(t.exports=y)})()},function(t,r,e){var n=e(118);t.exports=function(g,y){return y.method="POST",y.headers=y.headers||{},y.headers["Content-Type"]="multipart/form-data",y.timeout=0,y.type=y.type||"json",n(g,y)}},function(t,r,e){var n=e(15),g=e(48),y=e(7),i=e(3),k=e(11),$=k.chunkSize,L=e(118),V={mp4:"video/mp4",avi:"video/x-msvideo",wmv:"video/x-ms-wmv",mpeg:"video/mpeg",mov:"video/quicktime",aac:"audio/x-aac",wma:"audio/x-ms-wma",wav:"audio/x-wav",mp3:"audio/mp3"};t.exports=function z(re,ie,ue,le){var oe={file:re.data[ie],fileSize:re.data[ie].size,fileUploadedSize:0,percentage:0},ae=re.url;function qe(dr){var Dt=oe.fileUploadedSize+dr.loaded,lr=Math.floor(1e4*Dt/oe.fileSize)/100;if(g(lr)>=100&&(lr=100,qe=function(){}),oe.percentage!==lr){oe.percentage=lr;var sr={docId:re.docId,total:oe.fileSize,loaded:Dt,percentage:lr,percentageText:lr+"%"};re.fileInput&&(sr.fileInput=re.fileInput),re.blob&&(sr.blob=re.blob),re.uploadprogress(sr)}}function de(dr){try{dr=JSON.parse(dr)}catch(sr){return void ue.onError(sr)}if(dr.errMsg||dr.errCode)ue.onError(dr);else if(dr.offset<oe.fileSize)delete Lt.onaftersend,oe.fileUploadedSize=dr.offset,function(sr,er,cr,or){var hr=sr.offset,pr=sr.offset+$;if(typeof FileReader<"u"){var Sr,Er=new FileReader;Er.readAsArrayBuffer(n(Sr=or.file).call(Sr,hr,pr)),Er.addEventListener("load",function(Cr){er.data=Cr.target.result,er.query.offset=sr.offset,er.query.complete=pr>=or.fileSize,er.query.context=sr.context,er.onuploading=qe,er.onload=de,er.onerror=Ne,ue.sn=L(ae,er)}),Er.addEventListener("error",function(Cr){er.onerror(Cr.target.error)})}else{var Pr;er.data=n(Pr=or.file).call(Pr,hr,pr),er.query.offset=sr.offset,er.query.complete=pr>=or.fileSize,er.query.context=sr.context,er.onuploading=qe,er.onload=de,er.onerror=Ne,ue.sn=L(ae,er)}}(dr,Lt,0,oe);else{var Dt=k.genFileUrl(re.nosToken);re.type==="image"?L(Dt+"?imageInfo",{onload:function(sr){try{sr=JSON.parse(sr),re.uploaddone(null,{docId:dr.docId,w:sr.Width,h:sr.Height,orientation:sr.Orientation||"",type:sr.Type,size:sr.Size||oe.fileSize})}catch(er){lr(er)}},onerror:function(sr){if(typeof Image<"u"){var er=new Image;er.src=Dt,er.onload=function(){re.uploaddone(null,{docId:dr.docId,w:er.width,h:er.height,size:oe.fileSize})},er.onerror=function(cr){lr(cr)}}else lr(sr)}}):re.type==="video"||re.type==="audio"?L(Dt+"?vinfo",{onload:function(sr){try{(sr=JSON.parse(sr)).GetVideoInfo&&sr.GetVideoInfo.VideoInfo&&(sr=sr.GetVideoInfo.VideoInfo),re.uploaddone(null,{docId:dr.docId,w:sr.Width,h:sr.Height,dur:sr.Duration,orientation:sr.Rotate,audioCodec:sr.AudioCodec,videoCodec:sr.VideoCodec,container:sr.Container,size:sr.Size||oe.fileSize})}catch(er){lr(er)}},onerror:lr}):re.uploaddone(null,{docId:dr.docId,size:oe.fileSize})}function lr(sr){ue.onError(sr)}}function Ne(dr){re.errorHook(dr,{url:ae,provider:"nos"});var Dt=dr&&dr.code;function lr(){try{if(dr.result)var sr=JSON.parse(dr.result);else sr=dr;ue.onError(sr)}catch(er){ue.onError(er)}}oe.fileUploadedSize===0&&Dt!=="abort"?re.edgeList?le<re.edgeList.length-1?z(re,ie,ue,le+1):lr():re.nosLbsUrls&&re.nosLbsUrls.length>0?function(sr,er,cr,or,hr){return new i(function(pr){function Sr(){hr.adaptersRequest(cr[sr],{query:{version:"1.0",bucketname:er},method:"GET",onerror:Er,onload:function(Pr){try{(Pr=JSON.parse(Pr))&&Pr.upload&&Pr.upload.length?pr(Pr.upload):Er()}catch{Er()}}},{exception_service:3})}function Er(){or.onLbsUrlFail(cr[sr]),sr<cr.length-1?(sr++,Sr()):pr([])}Sr()})}(0,re.nosToken.bucket,re.nosLbsUrls,ue,re).then(function(sr){sr.length>0?(re.edgeList=sr,re.updateNosEdgeList&&re.updateNosEdgeList(sr),z(re,ie,ue,le+1)):lr()}):(re.edgeList=k.edgeList,z(re,ie,ue,le+1)):lr()}typeof le!="number"&&(le=-1),re.edgeList&&re.edgeList.length&&(le=le>0?le:0,ae=re.edgeList[le]),ae+="/"+re.nosToken.bucket+"/"+re.nosToken.objectName;var ze=re.data.file&&re.data.file.type;if(!ze||y(ze).call(ze,"/")<0){var $e=(re.fileInputName||"").split(".").pop();re.type==="image"?ze="image/"+($e==="jpg"?"jpeg":$e):re.type!=="audio"&&re.type!=="video"||(ze=V[$e])}var Lt={query:{offset:0,complete:$>=oe.fileSize,version:"1.0"},headers:{"Content-Type":ze||"application/octet-stream","x-nos-token":re.nosToken.token},method:"POST",timeout:0,onaftersend:function(){re.beginupload(ue)},onuploading:qe,onload:de,onerror:Ne};if(typeof FileReader<"u"){var jt,Et=new FileReader;Et.addEventListener("load",function(dr){Lt.data=dr.target.result,ue.sn=L(ae,Lt)}),Et.addEventListener("error",function(dr){Lt.onerror(dr.target.error)}),Et.readAsArrayBuffer(n(jt=oe.file).call(jt,0,$))}else{var ir;Lt.data=n(ir=oe.file).call(ir,0,$),ue.sn=L(ae,Lt)}}},function(t,r,e){e(612);var n=e(13);t.exports=n.Reflect.construct},function(t,r,e){var n=e(1),g=e(33),y=e(79),i=e(274),k=e(172),$=e(36),L=e(28),V=e(84),z=e(5),re=g("Reflect","construct"),ie=Object.prototype,ue=[].push,le=z(function(){function qe(){}return!(re(function(){},[],qe)instanceof qe)}),oe=!z(function(){re(function(){})}),ae=le||oe;n({target:"Reflect",stat:!0,forced:ae,sham:ae},{construct:function(qe,de){k(qe),$(de);var Ne=arguments.length<3?qe:k(arguments[2]);if(oe&&!le)return re(qe,de,Ne);if(qe==Ne){switch(de.length){case 0:return new qe;case 1:return new qe(de[0]);case 2:return new qe(de[0],de[1]);case 3:return new qe(de[0],de[1],de[2]);case 4:return new qe(de[0],de[1],de[2],de[3])}var ze=[null];return y(ue,ze,de),new(y(i,qe,ze))}var $e=Ne.prototype,Lt=V(L($e)?$e:ie),jt=y(qe,Lt,de);return L(jt)?jt:Lt}})},function(t,r,e){t.exports=e(614)},function(t,r,e){var n=e(615);t.exports=n},function(t,r,e){var n=e(216);t.exports=n},function(t,r,e){t.exports=e(617)},function(t,r,e){var n=e(618);t.exports=n},function(t,r,e){var n=e(619);t.exports=n},function(t,r,e){var n=e(620);t.exports=n},function(t,r,e){e(621);var n=e(13);t.exports=n.Object.setPrototypeOf},function(t,r,e){e(1)({target:"Object",stat:!0},{setPrototypeOf:e(138)})},function(t,r,e){t.exports=e(623)},function(t,r,e){var n=e(624);t.exports=n},function(t,r,e){var n=e(273);t.exports=n},function(t,r){t.exports=function(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,r,e){t.exports=e(627)},function(t,r,e){var n=e(628);t.exports=n},function(t,r,e){var n=e(284);t.exports=n},function(t,r,e){e(630);var n=e(13);t.exports=n.Object.getPrototypeOf},function(t,r,e){var n=e(1),g=e(5),y=e(42),i=e(137),k=e(229);n({target:"Object",stat:!0,forced:g(function(){i(1)}),sham:!k},{getPrototypeOf:function($){return i(y($))}})},function(t,r,e){var n,g=e(141),y=e(7),i=e(8),k=e(26),$=e(9),L=e(15),V=e(4),z=e(0),re=e(77).fn,ie=e(286),ue=e(277),le=e(41),oe=e(25).reportAPI;re.transDoc=function(ae){var qe;z.verifyOptions(ae,"fileInput done","nos::transDoc");try{var de=ae.fileInput.files[0],Ne=["ppt","pdf","pptx","doc","docx"],ze=ae.fileInputName=de.name,$e={ppt:1,pptx:2,pdf:3,doc:6,docx:7},Lt=ze.substring(g(ze).call(ze,".")+1);if(y(Ne).call(Ne,Lt)<0)return void ae.done(le.newNoFileError("请上传正确格式的文件【ppt, pptx, pdf, doc, docx】",{callFunc:"nos: transDoc",fileInput:ae.fileInput}),ae)}catch{return void ae.done(le.newNoFileError("请上传正确的文件节点",{callFunc:"msg::previewFile",fileInput:ae.fileInput}),ae)}var jt=i(ue.genResponseBody("file")||{}).replace(/"/gi,'\\"'),Et={transToken:{name:ze,type:$e[Lt],transType:ae.transcode==="png"?11:10,size:de.size,body:jt}};this.getNosTokenTrans({responseBody:Et,nosToken:{nosScene:ae.nosScene||this.nosScene,nosSurvivalTime:ae.nosSurvivalTime},callback:k(qe=function(ir,dr){ir?ae.done(ir):(ae.nosToken=dr.nosToken,ae.docId=dr.docId,this._doPreviewFile(ae))}).call(qe,this)})},re.getSimpleNosToken=function(){var ae=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return ae.num=1,z.verifyOptions(ae),this.cbAndSendCmd("getSimpleNosToken",ae)},re.getNosToken=function(ae){var qe=ae.callback,de=ae.nosToken,Ne=ae.responseBody,ze={tag:de.nosScene};de.nosSurvivalTime&&de.nosSurvivalTime!==1/0&&(ze.expireSec=de.nosSurvivalTime),this.sendCmd("getNosToken",{responseBody:Ne,nosToken:ze},qe)},re.getNosTokenTrans=function(ae){this.sendCmd("getNosTokenTrans",ae.responseBody,ae.callback)},re.getMixStoreToken=function(ae){this.sendCmd("getMixStoreToken",{mixTokenReq:{provider:ae.curProvider,tokenCount:ae.tokenCount||1,tag:"im",returnBody:ae.responseBody}},ae.callback)},re.packFileDownloadName=function(ae){oe({instance:this,className:"ApiBaseFn",funcName:"packFileDownloadName",hasCallback:!1}),z.verifyOptions(ae,"url name",!0,"","nos::packFileDownloadName");var qe=ae.url;return qe+z.genUrlSep(qe)+"download="+encodeURIComponent(ae.name)},re.audioToMp3=function(ae){oe({instance:this,className:"ApiBaseFn",funcName:"audioToMp3",hasCallback:!1}),z.verifyOptions(ae,"url","nos::audioToMp3");var qe=ae.url;return qe+z.genUrlSep(qe)+"audioTrans&type=mp3"},re.removeFile=function(ae){this.sendCmd("removeFile",ae,ae.callback)},re.fetchFile=function(ae){this.sendCmd("fetchFile",ae,ae.callback)},re.fetchFileList=function(ae){this.sendCmd("fetchFileList",ae,ae.callback)},re.stripImageMeta=function(ae){return oe({instance:this,className:"ApiBaseFn",funcName:"stripImageMeta",hasCallback:!1}),this.beforeProcessImage(ae,"stripmeta")},re.qualityImage=function(ae){return oe({instance:this,className:"ApiBaseFn",funcName:"qualityImage",hasCallback:!1}),this.beforeProcessImage(ae,"quality")},re.interlaceImage=function(ae){return oe({instance:this,className:"ApiBaseFn",funcName:"interlaceImage",hasCallback:!1}),this.beforeProcessImage(ae,"interlace")},re.rotateImage=function(ae){return oe({instance:this,className:"ApiBaseFn",funcName:"rotateImage",hasCallback:!1}),this.beforeProcessImage(ae,"rotate")},re.blurImage=function(ae){return oe({instance:this,className:"ApiBaseFn",funcName:"blurImage",hasCallback:!1}),this.beforeProcessImage(ae,"blur")},re.cropImage=function(ae){return oe({instance:this,className:"ApiBaseFn",funcName:"cropImage",hasCallback:!1}),this.beforeProcessImage(ae,"crop")},re.thumbnailImage=function(ae){return oe({instance:this,className:"ApiBaseFn",funcName:"thumbnailImage",hasCallback:!1}),this.beforeProcessImage(ae,"thumbnail")},re.beforeProcessImage=function(ae,qe){var de=z.copy(ae);return de.type=qe,ae.ops=[de],this.processImage(ae)},re.processImage=function(ae){var qe;ae.callback=oe({instance:this,className:"ApiBaseFn",funcName:"processImage",done:ae.callback});var de=this;z.verifyOptions(ae,"url ops",!0,"","nos::processImage"),z.verifyParamType("ops",ae.ops,"array","nos::processImage");var Ne=$(qe=ae.ops).call(qe,function(ze){var $e,Lt;return z.verifyOptions(ze,"type",!0,"","nos::processImage"),z.verifyParamValid("type",ze.type,ie.validTypes,"nos::processImage"),de["gen"+L($e=ze.type).call($e,0,1).toUpperCase()+L(Lt=ze.type).call(Lt,1)+"Op"](ze)});de.processCallback(ae),de.sendCmd("processImage",{url:ae.url,imageOps:Ne},ae.callback)},re.genStripmetaOp=function(ae){return new ie({type:ae.type,stripmeta:ae.strip?1:0})},re.genQualityOp=function(ae){z.verifyOptions(ae,"quality",!0,"","nos::genQualityOp"),z.verifyParamType("quality",ae.quality,"number","nos::genQualityOp"),z.verifyParamMin("quality",ae.quality,0,"nos::genQualityOp"),z.verifyParamMax("quality",ae.quality,100,"nos::genQualityOp");var qe=Math.round(ae.quality);return new ie({type:ae.type,qualityQuality:qe})},re.genInterlaceOp=function(ae){return new ie({type:ae.type})},re.genRotateOp=function(ae){for(z.verifyOptions(ae,"angle",!0,"","nos::genRotateOp"),z.verifyParamType("angle",ae.angle,"number","nos::genRotateOp");ae.angle<0;)ae.angle=ae.angle+360;ae.angle=ae.angle%360;var qe=Math.round(ae.angle);return new ie({type:ae.type,rotateAngle:qe})},re.genBlurOp=function(ae){z.verifyOptions(ae,"radius sigma","nos::genBlurOp"),z.verifyParamType("radius",ae.radius,"number","nos::genBlurOp"),z.verifyParamMin("radius",ae.radius,1,"nos::genBlurOp"),z.verifyParamMax("radius",ae.radius,50,"nos::genBlurOp"),z.verifyParamType("sigma",ae.sigma,"number","nos::genBlurOp"),z.verifyParamMin("sigma",ae.sigma,0,"nos::genBlurOp");var qe=Math.round(ae.radius),de=Math.round(ae.sigma);return new ie({type:ae.type,blurRadius:qe,blurSigma:de})},re.genCropOp=function(ae){z.verifyOptions(ae,"x y width height","nos::genCropOp"),z.verifyParamType("x",ae.x,"number","nos::genCropOp"),z.verifyParamMin("x",ae.x,0,"nos::genCropOp"),z.verifyParamType("y",ae.y,"number","nos::genCropOp"),z.verifyParamMin("y",ae.y,0,"nos::genCropOp"),z.verifyParamType("width",ae.width,"number","nos::genCropOp"),z.verifyParamMin("width",ae.width,0,"nos::genCropOp"),z.verifyParamType("height",ae.height,"number","nos::genCropOp"),z.verifyParamMin("height",ae.height,0,"nos::genCropOp");var qe=Math.round(ae.x),de=Math.round(ae.y),Ne=Math.round(ae.width),ze=Math.round(ae.height);return new ie({type:ae.type,cropX:qe,cropY:de,cropWidth:Ne,cropHeight:ze})},re.genThumbnailOp=(n={cover:"z",contain:"x",crop:"y"},function(ae){z.verifyOptions(ae,"mode","nos::genThumbnailOp"),z.verifyParamValid("mode",ae.mode,V(n),"nos::genThumbnailOp"),ae.mode==="contain"?z.verifyParamAtLeastPresentOne(ae,"width height","nos::genThumbnailOp"):z.verifyOptions(ae,"width height","nos::genThumbnailOp"),z.undef(ae.width)&&(ae.width=0),z.undef(ae.height)&&(ae.height=0),z.verifyParamType("width",ae.width,"number","nos::genThumbnailOp"),z.verifyParamMin("width",ae.width,0,"nos::genThumbnailOp"),z.verifyParamType("height",ae.height,"number","nos::genThumbnailOp"),z.verifyParamMin("height",ae.height,0,"nos::genThumbnailOp");var qe=Math.round(ae.width),de=Math.round(ae.height),Ne=new ie({type:ae.type,thumbnailMode:n[ae.mode],thumbnailWidth:qe,thumbnailHeight:de});if(ae.mode==="crop"&&z.notundef(ae.axis)){z.undef(ae.axis.x)&&(ae.axis.x=5),z.undef(ae.axis.y)&&(ae.axis.y=5),z.verifyParamMin("axis.x",ae.axis.x,0,"nos::genThumbnailOp"),z.verifyParamMax("axis.x",ae.axis.x,10,"nos::genThumbnailOp"),z.verifyParamMin("axis.y",ae.axis.y,0,"nos::genThumbnailOp"),z.verifyParamMax("axis.y",ae.axis.y,10,"nos::genThumbnailOp");var ze=Math.round(ae.axis.x),$e=Math.round(ae.axis.y);Ne.thumbnailAxisX=ze,Ne.thumbnailAxisY=$e}return z.notundef(ae.enlarge)&&(z.verifyParamType("enlarge",ae.enlarge,"boolean","nos::genThumbnailOp"),ae.enlarge&&(Ne.thumbnailEnlarge=1)),Ne.thumbnailToStatic=this.options.thumbnailToStatic?1:0,Ne}),re.getNosOriginUrl=function(ae){var qe;(ae=ae||{}).done=oe({instance:this,className:"ApiBaseFn",funcName:"getNosOriginUrl",done:ae.done}),z.verifyOptions(ae,"safeShortUrl",!0,"","nos::getNosOriginUrl"),z.verifyParamType("safeShortUrl",ae.safeShortUrl,"string","nos::getNosOriginUrl"),/^http(s)?:/.test(ae.safeShortUrl)&&~y(qe=ae.safeShortUrl).call(qe,"im_url=1")?(this.processCallback(ae),this.sendCmd("getNosOriginUrl",{nosFileUrlTag:{safeUrl:ae.safeShortUrl}},ae.callback)):ae.done(new le("参数 “safeShortUrl” 内容非文件安全短链",{callFunc:"nos: getNosOriginUrl"}),ae)}},function(t,r,e){var n,g=e(6),y=e(7),i=e(4),k=e(22),$=e(108),L=$.genUrlSep,V=$.url2object,z=$.object2url,re=e(0),ie=e(77).fn,ue=e(25).reportAPI;ie.viewImageSync=function(le){ue({instance:this,className:"ApiBaseFn",funcName:"viewImageSync",hasCallback:!1});var oe=this.options;re.verifyOptions(le,"url","nos::viewImageSync");var ae=le.url,qe=V(ae),de=qe.protocol,Ne=qe.hostname,ze=qe.path,$e=qe.query;if(typeof le.strip=="boolean"&&($e.stripmeta=le.strip?1:0),typeof le.quality=="number"&&(re.verifyParamMin("quality",le.quality,0,"nos::viewImageSync"),re.verifyParamMax("quality",le.quality,100,"nos::viewImageSync"),$e.quality=Math.round(le.quality)),typeof le.interlace=="boolean"&&($e.interlace=le.interlace?1:0),typeof le.rotate=="number"&&($e.rotate=Math.round(le.rotate)),k(le.thumbnail)==="object"){var Lt=le.thumbnail.mode||"crop",jt=le.thumbnail.width,Et=le.thumbnail.height;if(jt>=0&&Et>=0&&jt<4096&&Et<4096&&(jt>0||Et>0)){var ir,dr;switch(Lt){case"crop":Lt="y";break;case"contain":Lt="x";break;case"cover":Lt="z";break;default:Lt="x"}$e.thumbnail=g(ir=g(dr="".concat(jt)).call(dr,Lt)).call(ir,Et)}}if(oe.downloadUrl){var Dt=V(le.url),lr=oe.downloadUrl,sr=Dt.path,er=y(sr).call(sr,"/");if(er!==-1){var cr=sr.substring(0,er),or=sr.substring(er+1);lr=lr.replace("{bucket}",cr).replace("{object}",or)}var hr=V(lr);return z({protocol:hr.protocol,hostname:hr.hostname,path:hr.path,query:re.merge(hr.query,$e)})}return z({protocol:de,hostname:Ne,path:ze,query:$e})},ie.viewImageStripMeta=function(le){ue({instance:this,className:"ApiBaseFn",funcName:"viewImageStripMeta",hasCallback:!1}),re.verifyOptions(le,"url strip","nos::viewImageStripMeta"),re.verifyParamType("strip",le.strip,"boolean","nos::viewImageStripMeta");var oe="stripmeta="+(le.strip?1:0),ae=L(le.url);return le.url+ae+oe},ie.viewImageQuality=function(le){ue({instance:this,className:"ApiBaseFn",funcName:"viewImageQuality",hasCallback:!1}),re.verifyOptions(le,"url quality","nos::viewImageQuality"),re.verifyParamType("quality",le.quality,"number","nos::viewImageQuality"),re.verifyParamMin("quality",le.quality,0,"nos::viewImageQuality"),re.verifyParamMax("quality",le.quality,100,"nos::viewImageQuality");var oe="quality="+Math.round(le.quality),ae=L(le.url);return le.url+ae+oe},ie.viewImageInterlace=function(le){ue({instance:this,className:"ApiBaseFn",funcName:"viewImageInterlace",hasCallback:!1}),re.verifyOptions(le,"url","nos::viewImageInterlace");var oe=L(le.url);return le.url+oe+"interlace=1"},ie.viewImageRotate=function(le){for(ue({instance:this,className:"ApiBaseFn",funcName:"viewImageRotate",hasCallback:!1}),re.verifyOptions(le,"url angle","nos::viewImageRotate"),re.verifyParamType("angle",le.angle,"number","nos::viewImageRotate");le.angle<0;)le.angle=le.angle+360;le.angle=le.angle%360;var oe="rotate="+Math.round(le.angle),ae=L(le.url);return le.url+ae+oe},ie.viewImageBlur=function(le){ue({instance:this,className:"ApiBaseFn",funcName:"viewImageBlur",hasCallback:!1}),re.verifyOptions(le,"url radius sigma","nos::viewImageBlur"),re.verifyParamType("radius",le.radius,"number","nos::viewImageBlur"),re.verifyParamMin("radius",le.radius,1,"nos::viewImageBlur"),re.verifyParamMax("radius",le.radius,50,"nos::viewImageBlur"),re.verifyParamType("sigma",le.sigma,"number","nos::viewImageBlur"),re.verifyParamMin("sigma",le.sigma,0,"nos::viewImageBlur");var oe="blur="+Math.round(le.radius)+"x"+Math.round(le.sigma),ae=L(le.url);return le.url+ae+oe},ie.viewImageCrop=function(le){ue({instance:this,className:"ApiBaseFn",funcName:"viewImageCrop",hasCallback:!1}),re.verifyOptions(le,"url x y width height","nos::viewImageCrop"),re.verifyParamType("x",le.x,"number","nos::viewImageCrop"),re.verifyParamMin("x",le.x,0,"nos::viewImageCrop"),re.verifyParamType("y",le.y,"number","nos::viewImageCrop"),re.verifyParamMin("y",le.y,0,"nos::viewImageCrop"),re.verifyParamType("width",le.width,"number","nos::viewImageCrop"),re.verifyParamMin("width",le.width,0,"nos::viewImageCrop"),re.verifyParamType("height",le.height,"number","nos::viewImageCrop"),re.verifyParamMin("height",le.height,0,"nos::viewImageCrop");var oe="crop="+Math.round(le.x)+"_"+Math.round(le.y)+"_"+Math.round(le.width)+"_"+Math.round(le.height),ae=L(le.url);return le.url+ae+oe},ie.viewImageThumbnail=(n={cover:"z",contain:"x",crop:"y"},function(le){re.verifyOptions(le,"url mode","nos::viewImageThumbnail"),re.verifyParamValid("mode",le.mode,i(n),"nos::viewImageThumbnail"),le.mode==="contain"?re.verifyParamAtLeastPresentOne(le,"width height","nos::viewImageThumbnail"):re.verifyOptions(le,"width height","nos::viewImageThumbnail"),re.undef(le.width)&&(le.width=0),re.undef(le.height)&&(le.height=0),re.verifyParamType("width",le.width,"number","nos::viewImageThumbnail"),re.verifyParamMin("width",le.width,0,"nos::viewImageThumbnail"),re.verifyParamType("height",le.height,"number","nos::viewImageThumbnail"),re.verifyParamMin("height",le.height,0,"nos::viewImageThumbnail");var oe=Math.round(le.width),ae=Math.round(le.height),qe="thumbnail="+oe+n[le.mode]+ae;le.mode==="crop"&&re.notundef(le.axis)&&(re.undef(le.axis.x)&&(le.axis.x=5),re.undef(le.axis.y)&&(le.axis.y=5),re.verifyParamMin("axis.x",le.axis.x,0,"nos::viewImageThumbnail"),re.verifyParamMax("axis.x",le.axis.x,10,"nos::viewImageThumbnail"),re.verifyParamMin("axis.y",le.axis.y,0,"nos::viewImageThumbnail"),re.verifyParamMax("axis.y",le.axis.y,10,"nos::viewImageThumbnail"),qe=qe+"&axis="+Math.round(le.axis.x)+"_"+Math.round(le.axis.y)),re.notundef(le.enlarge)&&(re.verifyParamType("enlarge",le.enlarge,"boolean","nos::viewImageThumbnail"),le.enlarge&&(qe+="&enlarge=1"));var de=L(le.url);return le.url+de+qe})},function(t,r,e){var n=e(634);t.exports=n},function(t,r,e){var n=e(19),g=e(635),y=e(637),i=Array.prototype,k=String.prototype;t.exports=function($){var L=$.includes;return $===i||n(i,$)&&L===i.includes?g:typeof $=="string"||$===k||n(k,$)&&L===k.includes?y:L}},function(t,r,e){e(636);var n=e(29);t.exports=n("Array").includes},function(t,r,e){var n=e(1),g=e(163).includes,y=e(5),i=e(199);n({target:"Array",proto:!0,forced:y(function(){return!Array(1).includes()})},{includes:function(k){return g(this,k,arguments.length>1?arguments[1]:void 0)}}),i("includes")},function(t,r,e){e(638);var n=e(29);t.exports=n("String").includes},function(t,r,e){var n=e(1),g=e(12),y=e(639),i=e(110),k=e(50),$=e(641),L=g("".indexOf);n({target:"String",proto:!0,forced:!$("includes")},{includes:function(V){return!!~L(k(i(this)),k(y(V)),arguments.length>1?arguments[1]:void 0)}})},function(t,r,e){var n=e(640),g=TypeError;t.exports=function(y){if(n(y))throw g("The method doesn't accept regular expressions");return y}},function(t,r,e){var n=e(28),g=e(65),y=e(21)("match");t.exports=function(i){var k;return n(i)&&((k=i[y])!==void 0?!!k:g(i)=="RegExp")}},function(t,r,e){var n=e(21)("match");t.exports=function(g){var y=/./;try{"/./"[g](y)}catch{try{return y[n]=!1,"/./"[g](y)}catch{}}return!1}},function(t,r,e){var n=e(22),g=e(8),y=e(7),i=e(306),k=e(0),$=e(77).fn,L=e(11),V=e(25).reportAPI;function z(ie,ue,le,oe){var ae=!1,qe="";if(le===1?y(ie).call(ie,ue)>=0&&(ae=!0,qe=ue):le===2&&(qe=new RegExp(ue,"g")).test(ie)&&(ae=!0),ae&&qe!=="")switch(oe){case 1:return ie.replace(qe,"**");case 2:return{code:2};case 3:return{code:3}}return ie}function re(ie,ue){for(var le=ue.match,oe=ue.operate,ae=ie,qe=0;qe<i(ue).length;qe++){var de=i(ue)[qe],Ne=de.match||le,ze=de.operate||oe;try{if(ae=z(ae,de.key,Ne,ze),n(ae)==="object")return ae}catch($e){this.logger.warn("misc::filterContent: js cannot parse this regexp ",$e)}}return ae}$.uploadSdkLogUrl=function(ie){return k.verifyOptions(ie,"url","misc::uploadSdkLogUrl"),this.cbAndSendCmd("uploadSdkLogUrl",ie)},$.getClientAntispamLexicon=function(ie){var ue=this;(ie=ie||{}).done=V({instance:this,className:"ApiBaseFn",funcName:"getClientAntispamLexicon",done:ie.done});var le=(ie=ie||{}).done;le instanceof Function||(le=function(){}),ie={clientAntispam:{version:0}};var oe=this;if(L.hasLocalStorage&&localStorage.getItem("antispamLexicon")&&localStorage.getItem("antispamLexicon")!=="{}")try{oe.antispamLexicon=JSON.parse(localStorage.getItem("antispamLexicon"))}catch(ae){this.logger.error("JSON parse antispamLexicon error",ae)}oe.antispamLexicon&&le.call(this,null,{clientAntispam:oe.antispamLexicon}),this.protocol.sendCmd("getClientAntispam",ie,function(ae,qe,de){ae?(oe.protocol.logger.error("misc::getClientAntispamLexicon:",ae),le.call(ue,ae,{})):(L.hasLocalStorage&&localStorage.setItem("antispamLexicon",g(de.clientAntispam)),oe.antispamLexicon||le.call(ue,null,de),oe.antispamLexicon=de.clientAntispam||{})})},$.filterClientAntispam=function(ie){V({instance:this,className:"ApiBaseFn",funcName:"filterClientAntispam",hasCallback:!1});var ue=ie.content;if(!ue)return{code:404,errmsg:"待反垃圾文本content不存在"};var le=this.antispamLexicon&&this.antispamLexicon.thesaurus;if(!le)return{code:404,errmsg:"没有反垃圾词库或者词库格式不合法"};try{le=JSON.parse(le).thesaurus}catch{return this.protocol.logger.error("misc::filterClientAntispam: parse thesaurus error"),{code:500,errmsg:"反垃圾词库格式不合法"}}for(var oe=ue,ae=0;ae<le.length;ae++)if(oe=re.call(this,oe,le[ae]),n(oe)==="object"){if(oe.code===2)return{code:200,type:2,errmsg:"建议拒绝发送",content:ue,result:""};if(oe.code===3)return{code:200,type:3,errmsg:"建议服务器处理反垃圾，发消息带上字段clientAntiSpam",content:ue,result:ue}}return oe===ue?{code:200,type:0,errmsg:"",content:ue,result:oe}:{code:200,type:1,errmsg:"已对特殊字符做了过滤",content:ue,result:oe}},$.getServerTime=function(ie){(ie=ie||{}).done=V({instance:this,className:"ApiBaseFn",funcName:"getServerTime",done:ie.done}),this.processCallback(ie),this.sendCmd("getServerTime",{},ie.callback)},$.getNosAccessToken=function(ie){(ie=ie||{}).done=V({instance:this,className:"ApiBaseFn",funcName:"getNosAccessToken",done:ie.done}),k.verifyOptions(ie,"url","misc::getNosAccessToken"),this.processCallback(ie);var ue={url:ie.url};ie.userAgent&&(ue.userAgent=ie.userAgent),ie.ext&&(ue.ext=ie.ext),this.sendCmd("getNosAccessToken",{nosAccessTokenTag:ue},function(le,oe,ae){var qe=ae&&ae.nosAccessTokenTag&&ae.nosAccessTokenTag.token,de=ie.url,Ne=qe?{token:qe,resUrl:y(de).call(de,"?")!==-1?de+"&token="+qe:de+"?token="+qe}:{};ie.done(le,Ne)})},$.deleteNosAccessToken=function(ie){(ie=ie||{}).done=V({instance:this,className:"ApiBaseFn",funcName:"deleteNosAccessToken",done:ie.done}),k.verifyOptions(ie,"token","misc::deleteNosAccessToken"),this.processCallback(ie),this.sendCmd("deleteNosAccessToken",{nosAccessTokenTag:{token:ie.token}},ie.callback)}},function(t,r,e){e(69);var n=e(67),g=e(30),y=e(19),i=e(644),k=Array.prototype,$={DOMTokenList:!0,NodeList:!0};t.exports=function(L){var V=L.keys;return L===k||y(k,L)&&V===k.keys||g($,n(L))?i:V}},function(t,r,e){var n=e(645);t.exports=n},function(t,r,e){e(86),e(100);var n=e(29);t.exports=n("Array").keys},function(t,r,e){var n=e(22),g=e(3),y=e(9),i=e(8),k=e(77).fn,$=e(0),L=e(193),V=e(287),z=e(25).reportAPI;k.signalingCreate=function(){var re=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},ie=re.type,ue=re.channelName,le=re.ext;return $.verifyOptions(re,"type","api::signalling"),this.sendCmdUsePromise("signalingCreate",{avSignalTag:{type:ie,channelName:ue,ext:le}}).then(function(oe){var ae=oe.avSignalTag;return g.resolve(ae)}).catch(function(oe){return g.reject(V.parseAvSignalError(oe))})},k.signalingDelay=function(){var re=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return $.verifyOptions(re,"channelId","api::signalling"),this.sendCmdUsePromise("signalingDelay",{avSignalTag:re}).then(function(ie){var ue=ie.avSignalTag;return g.resolve(ue)}).catch(function(ie){return g.reject(V.parseAvSignalError(ie))})},k.signalingClose=function(){var re=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},ie=re.offlineEnabled;return $.verifyOptions(re,"channelId","api::signalling"),this.sendCmdUsePromise("signalingClose",{avSignalTag:$.merge(re,{isSave:ie===!0?1:0})}).then(function(ue){var le=ue.avSignalTag;return le.offlineEnabled=le.isSave===1,delete le.isSave,g.resolve(le)}).catch(function(ue){return g.reject(V.parseAvSignalError(ue))})},k.signalingJoin=function(){var re=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},ie=re.offlineEnabled;return $.verifyOptions(re,"channelId","api::signalling"),this.sendCmdUsePromise("signalingJoin",{avSignalTag:$.merge(re,{isSave:ie===!0?1:0})}).then(function(ue){var le,oe=ue.avSignalTag,ae=oe.members;return typeof oe.members=="string"&&(ae=y(le=JSON.parse(oe.members)).call(le,function(qe){return V.parseAvSignalMember(qe)})),oe.members=ae,g.resolve(oe)}).catch(function(ue){return g.reject(V.parseAvSignalError(ue))})},k.signalingLeave=function(){var re=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},ie=re.offlineEnabled;return $.verifyOptions(re,"channelId","api::signalling"),this.sendCmdUsePromise("signalingLeave",{avSignalTag:$.merge(re,{isSave:ie===!0?1:0})}).then(function(ue){var le=ue.avSignalTag;return le.offlineEnabled=le.isSave===1,delete le.isSave,g.resolve(le)}).catch(function(ue){return g.reject(V.parseAvSignalError(ue))})},k.signalingGetChannelInfo=function(){var re=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},ie=re.channelName;return $.verifyOptions(re,"channelName","api::signalling"),this.sendCmdUsePromise("signalingGetChannelInfo",{avSignalTag:{channelName:ie}}).then(function(ue){var le,oe=ue.avSignalTag,ae=oe.members;return typeof oe.members=="string"&&(ae=y(le=JSON.parse(oe.members)).call(le,function(qe){return V.parseAvSignalMember(qe)})),oe.members=ae,g.resolve(oe)}).catch(function(ue){return g.reject(V.parseAvSignalError(ue))})},k.signalingInvite=function(){var re=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},ie=re.account,ue=re.offlineEnabled,le=re.pushInfo,oe=le===void 0?{}:le;$.verifyOptions(re,"channelId requestId account","api::signalling"),n(oe.pushPayload)==="object"&&(oe.pushPayload=i(oe.pushPayload));var ae=$.merge(re,oe,{to:ie,isSave:ue===!0?1:0,needPush:oe.needPush===!0?1:0,needBadge:oe.needBadge===!1?0:1});return this.sendCmdUsePromise("signalingInvite",{avSignalTag:ae}).then(function(qe){var de=qe.avSignalTag;return de.offlineEnabled=de.isSave===1,de.needBadge=de.needBadge===1,de.needPush=de.needPush===1,delete de.isSave,g.resolve(de)}).catch(function(qe){return g.reject(V.parseAvSignalError(qe))})},k.signalingCancel=function(re){var ie=re.account,ue=re.offlineEnabled;return $.verifyOptions(re,"channelId requestId account","api::signalling"),this.sendCmdUsePromise("signalingCancel",{avSignalTag:$.merge(re,{to:ie,isSave:ue===!0?1:0})}).then(function(le){var oe=le.avSignalTag;return oe.offlineEnabled=oe.isSave===1,delete oe.isSave,g.resolve(oe)}).catch(function(le){return g.reject(V.parseAvSignalError(le))})},k.signalingCreateAndJoin=function(re){var ie=this,ue=z({instance:this,className:"ApiBaseFn",funcName:"signalingCreateAndJoin",hasCallback:!0}),le=re.channelName,oe=re.uid,ae=oe===void 0?0:oe,qe=re.offlineEnabled,de=qe===void 0||qe,Ne=re.attachExt,ze=Ne===void 0?"":Ne;return this.signalingCreate(re).catch(function($e){return $e.code===10405?(ie.logger.warn("api::avSignal:signalingCall room already exists:",$e),ie.signalingGetChannelInfo({channelName:le})):g.reject($e)}).then(function($e){var Lt={channelId:$e.channelId,offlineEnabled:de,attachExt:ze,nertcChannelName:re.nertcChannelName,nertcTokenTtl:re.nertcTokenTtl,nertcJoinRoomQueryParamMap:re.nertcJoinRoomQueryParamMap};return ae&&$.merge(Lt,{uid:ae}),ie.signalingJoin(Lt)}).then(function($e){return typeof ue=="function"&&ue(void 0),$e}).catch(function($e){throw typeof ue=="function"&&ue($e),$e})},k.signalingCall=function(re){var ie=this,ue=z({instance:this,className:"ApiBaseFn",funcName:"signalingCall",hasCallback:!0}),le=re.account,oe=re.offlineEnabled,ae=re.requestId;$.verifyOptions(re,"type requestId account","api::signalling");var qe="";return this.signalingCreateAndJoin(re).then(function(de){qe=de.channelId||qe,ie.logger.info("api::avSignal:signalingCall join:",qe);var Ne={channelId:qe,account:le,requestId:ae,offlineEnabled:oe,attachExt:re.attachExt||"",pushInfo:re.pushInfo||{},nertcTokenTtl:de.nertcTokenTtl,nertcToken:de.nertcToken};return ie.signalingInvite(Ne)}).then(function(de){return typeof ue=="function"&&ue(void 0),de}).catch(function(de){throw typeof ue=="function"&&ue(de),de})},k.signalingReject=function(re){var ie=re.account,ue=re.offlineEnabled;return $.verifyOptions(re,"channelId requestId account","api::signalling"),this.sendCmdUsePromise("signalingReject",{avSignalTag:$.merge(re,{to:ie,isSave:ue===!0?1:0})}).then(function(le){var oe=le.avSignalTag;return oe.offlineEnabled=oe.isSave===1,delete oe.isSave,g.resolve(oe)}).catch(function(le){return g.reject(V.parseAvSignalError(le))})},k.signalingAccept=function(re){var ie=this,ue=re.account,le=re.offlineEnabled;return $.verifyOptions(re,"channelId requestId account","api::signalling"),this.sendCmdUsePromise("signalingAccept",{avSignalTag:$.merge(re,{to:ue,isSave:le===!0?1:0})}).then(function(oe){var ae=oe.avSignalTag;return ae.offlineEnabled=ae.isSave===1,delete ae.isSave,g.resolve(ae)}).catch(function(oe){return g.reject(V.parseAvSignalError(oe))}).then(function(oe){if(re.autoJoin){var ae={channelId:re.channelId,offlineEnabled:re.offlineEnabled,attachExt:re.joinAttachExt,uid:re.uid,nertcChannelName:re.nertcChannelName,nertcTokenTtl:re.nertcTokenTtl,nertcJoinRoomQueryParamMap:re.nertcJoinRoomQueryParamMap};return ie.signalingJoin(ae)}return oe})},k.signalingControl=function(re){var ie=re.account;return $.verifyOptions(re,"channelId","api::signalling"),this.sendCmdUsePromise("signalingControl",{avSignalTag:$.merge(re,ie?{to:ie}:{})}).then(function(ue){var le=ue.avSignalTag;return g.resolve(le)}).catch(function(ue){return g.reject(V.parseAvSignalError(ue))})},k.signalingSync=function(){return this.sendCmdUsePromise("sync",{sync:{avSignal:0}}).then(function(re){var ie=re.avSignalTag;return g.resolve(ie)}).catch(function(re){return g.reject(V.parseAvSignalError(re))})},k.signalingMarkMsgRead=function(){var re=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};z({instance:this,className:"ApiBaseFn",funcName:"signalingMarkMsgRead",hasCallback:!1}),$.verifyOptions(re,"msgid","api::signalling");var ie,ue=L.idMap.avSignal;return ie=typeof re.msgid=="string"?[re.msgid]:re.msgid,this.sendCmd("batchMarkRead",{sid:ue.id,cid:ue.signalingNotify,ids:ie})},k.signalingCallEx=function(){var re=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},ie=re.account,ue=re.offlineEnabled,le=re.pushInfo,oe=le===void 0?{}:le;n(oe.pushPayload)==="object"&&(oe.pushPayload=i(oe.pushPayload)),$.verifyOptions(re,"type","api::signalling"),$.verifyOptions(re,"account","api::signalling");var ae=$.merge(re,oe,{to:ie,isSave:ue===!0?1:0,needPush:oe.needPush===!0?1:0,needBadge:oe.needBadge===!1?0:1});return this.sendCmdUsePromise("signalingCallEx",{avSignalTag:ae}).then(function(qe){var de,Ne=qe.avSignalTag,ze=Ne.members;return typeof Ne.members=="string"&&(ze=y(de=JSON.parse(Ne.members)).call(de,function($e){return V.parseAvSignalMember($e)})),Ne.members=ze,g.resolve(Ne)}).catch(function(qe){return g.reject(V.parseAvSignalError(qe))})},k.signalingJoinAndAccept=function(){var re=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},ie=re.channelId,ue=re.attachExt,le=re.offlineEnabled,oe=re.uid,ae=re.account,qe=re.requestId,de=re.nertcChannelName,Ne=re.nertcTokenTtl,ze=re.nertcJoinRoomQueryParamMap;return $.verifyOptions(re,"channelId","api::signalling"),$.verifyOptions(re,"account","api::signalling"),$.verifyOptions(re,"requestId","api::signalling"),this.sendCmdUsePromise("signalingJoinAndAccept",{avSignalTag:{channelId:ie,attachExt:ue,isSave:le===!0?1:0,uid:oe,to:ae,requestId:qe,nertcChannelName:de,nertcTokenTtl:Ne,nertcJoinRoomQueryParamMap:ze}}).then(function($e){var Lt,jt=$e.avSignalTag,Et=jt.members;return typeof jt.members=="string"&&(Et=y(Lt=JSON.parse(jt.members)).call(Lt,function(ir){return V.parseAvSignalMember(ir)})),jt.members=Et,g.resolve(jt)}).catch(function($e){return g.reject(V.parseAvSignalError($e))})}},function(t,r,e){var n=e(51),g=e(37),y=e(4),i=e(52),k=e(16),$=e(53),L=e(2),V=e(54),z=e(55),re=e(43),ie=e(92),ue=e(93);function le(ae,qe){var de=y(ae);if(i){var Ne=i(ae);qe&&(Ne=k(Ne).call(Ne,function(ze){return $(ae,ze).enumerable})),de.push.apply(de,Ne)}return de}e(0);var oe={user_id:"",trace_id:"",action:7,exception_service:6,duration:0,start_time:0,state:1,extension:[]};t.exports=function(){function ae(qe){ie(this,ae),this.clientProto=qe,this.reset()}return ue(ae,[{key:"reset",value:function(){this.traceData=g({},oe),this.traceData.extension=[]}},{key:"start",value:function(qe){this.reset(),g(this.traceData,qe),this.traceData.user_id=this.clientProto.account,this.traceData.start_time=new Date().getTime()}},{key:"update",value:function(qe){var de=this.clientProto.checkNetworkAvailable();this.traceData.extension.push(function(Ne){for(var ze=1;ze<arguments.length;ze++){var $e,Lt,jt=arguments[ze]!=null?arguments[ze]:{};ze%2?L($e=le(Object(jt),!0)).call($e,function(Et){n(Ne,Et,jt[Et])}):V?z(Ne,V(jt)):L(Lt=le(Object(jt))).call(Lt,function(Et){re(Ne,Et,$(jt,Et))})}return Ne}({code:0,description:"",foreground:!0,foreg_backg_switch:!1,net_type:0,net_connect:de},qe))}},{key:"end",value:function(qe){var de=this.traceData.extension[0],Ne=this.traceData.extension[1];if(de&&de.operation_type===0&&Ne&&Ne.operation_type===1){var ze=de.net_type!==Ne.net_type||de.net_connect!==Ne.net_connect;if(qe||!ze)return this.traceData.duration=new Date().getTime()-this.traceData.start_time,this.clientProto.reporter.report("exceptions",this.traceData),void this.reset();this.reset()}else this.reset()}}]),ae}()},function(t,r,e){var n=e(2),g=e(92),y=e(93),i=e(62).getPromiseWithAbort,k=function(){function $(){g(this,$),this.abortFns=[]}return y($,[{key:"add",value:function(L){var V=i(L);return this.abortFns.push(V.abort),V.promise}},{key:"clear",value:function(){var L;n(L=this.abortFns).call(L,function(V){return V("Request aborted")}),this.abortFns=[]}},{key:"destroy",value:function(){this.clear()}}]),$}();t.exports=k},function(t,r,e){var n=e(57),g=e(58),y=e(2),i=e(71),k=e(3),$=e(9),L=e(60),V=e(15),z=e(6),re=e(8),ie=e(26),ue=e(92),le=e(93),oe=e(0),ae=e(11),qe=e(64),de=e(289),Ne=e(41);t.exports=function(){function ze(Lt){var jt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{socketConcurrent:1};ue(this,ze),this.clientProto=Lt,this.logger=Lt.logger,this.urls=[],this.sockets=[],this.config=jt}var $e;return le(ze,[{key:"setConfig",value:function(){var Lt=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{socketConcurrent:1};this.config=Lt}},{key:"setUrls",value:function(Lt){this.urls=Lt}},{key:"resetSockets",value:function(){var Lt;y(Lt=this.sockets).call(Lt,function(jt){jt&&(jt.removeAllListenersX("info"),jt.disconnect())}),this.sockets=[]}},{key:"connect",value:($e=g(n.mark(function Lt(){var jt,Et,ir,dr=this;return n.wrap(function(Dt){for(;;)switch(Dt.prev=Dt.next){case 0:if(this.clientProto.statusProtector.emit("auth/loginLifeCycleConnect"),(Et=i(jt=this.urls).call(jt,0,this.config.socketConcurrent)).length!==0){Dt.next=4;break}throw new Ne("no_socket_url",408,{});case 4:return Dt.prev=4,Dt.next=7,k.any($(Et).call(Et,function(lr,sr){return dr.doConnect(lr,sr)}));case 7:return Dt.abrupt("return",Dt.sent);case 10:throw Dt.prev=10,Dt.t0=Dt.catch(4),y(ir=Dt.t0.errors).call(ir,function(lr,sr){dr.logger.warn("imsocket::connect failed ".concat(sr),lr)}),Dt.t0;case 14:case"end":return Dt.stop()}},Lt,this,[[4,10]])})),function(){return $e.apply(this,arguments)})},{key:"success",value:function(Lt){var jt;return y(jt=this.sockets).call(jt,function(Et,ir){Lt!==ir&&Et&&(Et.removeAllListenersX("info"),Et.disconnect())}),this.sockets[Lt]}},{key:"failed",value:function(Lt){var jt=this.sockets[Lt];jt&&(jt.removeAllListenersX("info"),jt.disconnect())}},{key:"getTransport",value:function(Lt){var jt=oe.getGlobal();if(typeof window>"u"){var Et=Lt.split(":");return jt&&!jt.location&&Et.length>1&&(jt.location={protocol:Et.shift(),port:Et.pop(),hostname:Et.join("")}),["websocket"]}return this.clientProto.options.transports?this.clientProto.options.transports:qe.name!=="IE"||jt.WebSocket?["websocket"]:["xhr-polling"]}},{key:"doConnect",value:function(Lt,jt){var Et=this;if(this.clientProto&&this.clientProto.__destroyed===!0)return k.reject("instance has been destroyed");var ir=this.getTransport(Lt),dr=L();return new k(function(Dt,lr){var sr,er,cr,or;try{or=de.connect(Lt,{transports:V(ir).call(ir),reconnect:!1,"force new connection":!0,"connect timeout":ae.connectTimeout,needToXHR:typeof Et.clientProto.options.needToXHR=="boolean"?Et.clientProto.options.needToXHR:ae.needToXHR}),Et.sockets[jt]=or}catch(pr){var hr;return Et.logger.warn(z(hr="link::connectToUrl ".concat(jt,":io.connect caught exception: ")).call(hr,pr&&pr.message),pr),void lr(new Ne("socket_error",408,{startTime:dr,url:Lt,reason:pr.message,rawError:pr}))}Et.logger.info(z(sr=z(er="link::connectToUrl ".concat(jt,": socket url: ")).call(er,Lt,", transports: ")).call(sr,re(ir))),or.on("connect",function(){Et.logger.info("link::connectToUrl ".concat(jt," success")),Et.success(jt),Et.clientProto.reporterHookLinkKeep.start({trace_id:or.socket.sessionid}),Et.clientProto.reporterHookLinkKeep.update({code:0,description:"",operation_type:0,target:Lt}),Et.clientProto.url=Lt,Dt(or)}),or.on("handshake_failed",function(){Et.failed(jt),lr(new Ne("handshake_failed",408,{startTime:dr,url:Lt}))}),or.on("connect_failed",function(pr){Et.failed(jt),lr(new Ne("connect_failed",408,{startTime:dr,url:Lt,reason:pr}))}),or.on("error",function(){var pr,Sr=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",Er=arguments.length>1?arguments[1]:void 0,Pr=Er&&Er.message||Sr;Et.logger.warn(z(pr="link::onSocketError ".concat(jt,": reason is ")).call(pr,Pr,", error is "),Er),lr(new Ne("socket_error",408,{startTime:dr,url:Lt,reason:Pr,rawError:Er}))}),or.on("info",function(pr,Sr){var Er,Pr;Sr?Et.logger.info(z(Er="link::onSocketInfo ".concat(jt,": ")).call(Er,pr,", extraInfo:"),Sr):Et.logger.info(z(Pr="link::onSocketInfo ".concat(jt,": ")).call(Pr,pr,"."))}),or.on("message",ie(cr=Et.clientProto.onMessage).call(cr,Et.clientProto)),or.on("disconnect",function(pr){Et.logger.warn("link::onSocketDisconnect: socket url: ".concat(Lt,", disconnected"),pr),Et.clientProto.hasLogin=!1,Et.clientProto.doLogout?Et.clientProto.logout():Et.clientProto.onDisconnect("link::socketDisconnect"),Et.clientProto.statusProtector.emit("auth/loginLifeCycleDisconnected",new Error("disconnect due to internal reasons"))}),or.on("websocketOnclose",function(pr){Et.clientProto.reporterHookLinkKeep.update({code:pr&&pr.code||0,description:pr&&pr.reason||"",operation_type:1,target:Lt}),Et.clientProto.reporterHookLinkKeep.end(!1)})})}},{key:"destroy",value:function(){this.urls=[],this.resetSockets()}}]),ze}()},function(t,r,e){var n=e(22).default,g=e(140),y=e(155),i=e(189),k=e(283),$=e(651),L=e(191),V=e(288),z=e(662),re=e(309);function ie(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */t.exports=ie=function(){return ue},t.exports.__esModule=!0,t.exports.default=t.exports;var ue={},le=Object.prototype,oe=le.hasOwnProperty,ae=g||function(kr,Ir,xr){kr[Ir]=xr.value},qe=typeof y=="function"?y:{},de=qe.iterator||"@@iterator",Ne=qe.asyncIterator||"@@asyncIterator",ze=qe.toStringTag||"@@toStringTag";function $e(kr,Ir,xr){return g(kr,Ir,{value:xr,enumerable:!0,configurable:!0,writable:!0}),kr[Ir]}try{$e({},"")}catch{$e=function(Ir,xr,vr){return Ir[xr]=vr}}function Lt(kr,Ir,xr,vr){var _r=Ir&&Ir.prototype instanceof ir?Ir:ir,Or=i(_r.prototype),Mr=new Pr(vr||[]);return ae(Or,"_invoke",{value:hr(kr,xr,Mr)}),Or}function jt(kr,Ir,xr){try{return{type:"normal",arg:kr.call(Ir,xr)}}catch(vr){return{type:"throw",arg:vr}}}ue.wrap=Lt;var Et={};function ir(){}function dr(){}function Dt(){}var lr={};$e(lr,de,function(){return this});var sr=k&&k(k(Cr([])));sr&&sr!==le&&oe.call(sr,de)&&(lr=sr);var er=Dt.prototype=ir.prototype=i(lr);function cr(kr){var Ir;$(Ir=["next","throw","return"]).call(Ir,function(xr){$e(kr,xr,function(vr){return this._invoke(xr,vr)})})}function or(kr,Ir){var xr;ae(this,"_invoke",{value:function(vr,_r){function Or(){return new Ir(function(Mr,yr){(function mr(Tr,Br,$r,Lr){var Gr=jt(kr[Tr],kr,Br);if(Gr.type!=="throw"){var qr=Gr.arg,Yr=qr.value;return Yr&&n(Yr)=="object"&&oe.call(Yr,"__await")?Ir.resolve(Yr.__await).then(function(bn){mr("next",bn,$r,Lr)},function(bn){mr("throw",bn,$r,Lr)}):Ir.resolve(Yr).then(function(bn){qr.value=bn,$r(qr)},function(bn){return mr("throw",bn,$r,Lr)})}Lr(Gr.arg)})(vr,_r,Mr,yr)})}return xr=xr?xr.then(Or,Or):Or()}})}function hr(kr,Ir,xr){var vr="suspendedStart";return function(_r,Or){if(vr==="executing")throw new Error("Generator is already running");if(vr==="completed"){if(_r==="throw")throw Or;return rr()}for(xr.method=_r,xr.arg=Or;;){var Mr=xr.delegate;if(Mr){var yr=pr(Mr,xr);if(yr){if(yr===Et)continue;return yr}}if(xr.method==="next")xr.sent=xr._sent=xr.arg;else if(xr.method==="throw"){if(vr==="suspendedStart")throw vr="completed",xr.arg;xr.dispatchException(xr.arg)}else xr.method==="return"&&xr.abrupt("return",xr.arg);vr="executing";var mr=jt(kr,Ir,xr);if(mr.type==="normal"){if(vr=xr.done?"completed":"suspendedYield",mr.arg===Et)continue;return{value:mr.arg,done:xr.done}}mr.type==="throw"&&(vr="completed",xr.method="throw",xr.arg=mr.arg)}}}function pr(kr,Ir){var xr=Ir.method,vr=kr.iterator[xr];if(vr===void 0)return Ir.delegate=null,xr==="throw"&&kr.iterator.return&&(Ir.method="return",Ir.arg=void 0,pr(kr,Ir),Ir.method==="throw")||xr!=="return"&&(Ir.method="throw",Ir.arg=new TypeError("The iterator does not provide a '"+xr+"' method")),Et;var _r=jt(vr,kr.iterator,Ir.arg);if(_r.type==="throw")return Ir.method="throw",Ir.arg=_r.arg,Ir.delegate=null,Et;var Or=_r.arg;return Or?Or.done?(Ir[kr.resultName]=Or.value,Ir.next=kr.nextLoc,Ir.method!=="return"&&(Ir.method="next",Ir.arg=void 0),Ir.delegate=null,Et):Or:(Ir.method="throw",Ir.arg=new TypeError("iterator result is not an object"),Ir.delegate=null,Et)}function Sr(kr){var Ir={tryLoc:kr[0]};1 in kr&&(Ir.catchLoc=kr[1]),2 in kr&&(Ir.finallyLoc=kr[2],Ir.afterLoc=kr[3]),this.tryEntries.push(Ir)}function Er(kr){var Ir=kr.completion||{};Ir.type="normal",delete Ir.arg,kr.completion=Ir}function Pr(kr){this.tryEntries=[{tryLoc:"root"}],$(kr).call(kr,Sr,this),this.reset(!0)}function Cr(kr){if(kr){var Ir=kr[de];if(Ir)return Ir.call(kr);if(typeof kr.next=="function")return kr;if(!isNaN(kr.length)){var xr=-1,vr=function _r(){for(;++xr<kr.length;)if(oe.call(kr,xr))return _r.value=kr[xr],_r.done=!1,_r;return _r.value=void 0,_r.done=!0,_r};return vr.next=vr}}return{next:rr}}function rr(){return{value:void 0,done:!0}}return dr.prototype=Dt,ae(er,"constructor",{value:Dt,configurable:!0}),ae(Dt,"constructor",{value:dr,configurable:!0}),dr.displayName=$e(Dt,ze,"GeneratorFunction"),ue.isGeneratorFunction=function(kr){var Ir=typeof kr=="function"&&kr.constructor;return!!Ir&&(Ir===dr||(Ir.displayName||Ir.name)==="GeneratorFunction")},ue.mark=function(kr){return L?L(kr,Dt):(kr.__proto__=Dt,$e(kr,ze,"GeneratorFunction")),kr.prototype=i(er),kr},ue.awrap=function(kr){return{__await:kr}},cr(or.prototype),$e(or.prototype,Ne,function(){return this}),ue.AsyncIterator=or,ue.async=function(kr,Ir,xr,vr,_r){_r===void 0&&(_r=V);var Or=new or(Lt(kr,Ir,xr,vr),_r);return ue.isGeneratorFunction(Ir)?Or:Or.next().then(function(Mr){return Mr.done?Mr.value:Or.next()})},cr(er),$e(er,ze,"Generator"),$e(er,de,function(){return this}),$e(er,"toString",function(){return"[object Generator]"}),ue.keys=function(kr){var Ir=Object(kr),xr=[];for(var vr in Ir)xr.push(vr);return z(xr).call(xr),function _r(){for(;xr.length;){var Or=xr.pop();if(Or in Ir)return _r.value=Or,_r.done=!1,_r}return _r.done=!0,_r}},ue.values=Cr,Pr.prototype={constructor:Pr,reset:function(kr){var Ir;if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,$(Ir=this.tryEntries).call(Ir,Er),!kr)for(var xr in this)xr.charAt(0)==="t"&&oe.call(this,xr)&&!isNaN(+re(xr).call(xr,1))&&(this[xr]=void 0)},stop:function(){this.done=!0;var kr=this.tryEntries[0].completion;if(kr.type==="throw")throw kr.arg;return this.rval},dispatchException:function(kr){if(this.done)throw kr;var Ir=this;function xr(mr,Tr){return Or.type="throw",Or.arg=kr,Ir.next=mr,Tr&&(Ir.method="next",Ir.arg=void 0),!!Tr}for(var vr=this.tryEntries.length-1;vr>=0;--vr){var _r=this.tryEntries[vr],Or=_r.completion;if(_r.tryLoc==="root")return xr("end");if(_r.tryLoc<=this.prev){var Mr=oe.call(_r,"catchLoc"),yr=oe.call(_r,"finallyLoc");if(Mr&&yr){if(this.prev<_r.catchLoc)return xr(_r.catchLoc,!0);if(this.prev<_r.finallyLoc)return xr(_r.finallyLoc)}else if(Mr){if(this.prev<_r.catchLoc)return xr(_r.catchLoc,!0)}else{if(!yr)throw new Error("try statement without catch or finally");if(this.prev<_r.finallyLoc)return xr(_r.finallyLoc)}}}},abrupt:function(kr,Ir){for(var xr=this.tryEntries.length-1;xr>=0;--xr){var vr=this.tryEntries[xr];if(vr.tryLoc<=this.prev&&oe.call(vr,"finallyLoc")&&this.prev<vr.finallyLoc){var _r=vr;break}}_r&&(kr==="break"||kr==="continue")&&_r.tryLoc<=Ir&&Ir<=_r.finallyLoc&&(_r=null);var Or=_r?_r.completion:{};return Or.type=kr,Or.arg=Ir,_r?(this.method="next",this.next=_r.finallyLoc,Et):this.complete(Or)},complete:function(kr,Ir){if(kr.type==="throw")throw kr.arg;return kr.type==="break"||kr.type==="continue"?this.next=kr.arg:kr.type==="return"?(this.rval=this.arg=kr.arg,this.method="return",this.next="end"):kr.type==="normal"&&Ir&&(this.next=Ir),Et},finish:function(kr){for(var Ir=this.tryEntries.length-1;Ir>=0;--Ir){var xr=this.tryEntries[Ir];if(xr.finallyLoc===kr)return this.complete(xr.completion,xr.afterLoc),Er(xr),Et}},catch:function(kr){for(var Ir=this.tryEntries.length-1;Ir>=0;--Ir){var xr=this.tryEntries[Ir];if(xr.tryLoc===kr){var vr=xr.completion;if(vr.type==="throw"){var _r=vr.arg;Er(xr)}return _r}}throw new Error("illegal catch attempt")},delegateYield:function(kr,Ir,xr){return this.delegate={iterator:Cr(kr),resultName:Ir,nextLoc:xr},this.method==="next"&&(this.arg=void 0),Et}},ue}t.exports=ie,t.exports.__esModule=!0,t.exports.default=t.exports},function(t,r,e){t.exports=e(652)},function(t,r,e){t.exports=e(653)},function(t,r,e){var n=e(654);t.exports=n},function(t,r,e){var n=e(230);t.exports=n},function(t,r,e){t.exports=e(656)},function(t,r,e){var n=e(657);e(658),e(659),e(660),e(661),t.exports=n},function(t,r,e){var n=e(232);t.exports=n},function(t,r,e){e(233)},function(t,r,e){e(247)},function(t,r,e){var n=e(1),g=e(70),y=e(104);n({target:"Promise",stat:!0,forced:!0},{try:function(i){var k=g.f(this),$=y(i);return($.error?k.reject:k.resolve)($.value),k.promise}})},function(t,r,e){e(248)},function(t,r,e){t.exports=e(663)},function(t,r,e){t.exports=e(664)},function(t,r,e){var n=e(665);t.exports=n},function(t,r,e){var n=e(276);t.exports=n},function(t,r,e){t.exports=e(667)},function(t,r,e){var n=e(668);t.exports=n},function(t,r,e){var n=e(251);t.exports=n},function(t,r,e){var n=e(57),g=e(58),y=e(2),i=e(6),k=e(15),$=e(71),L=e(24),V=e(3),z=e(26),re=e(78).fn,ie=e(41),ue=e(670),le=e(11),oe=e(0),ae=e(671);function qe(){this.logger.log("offlineListener enter"),this.forceDisconnect(),this.statusProtector.emit("auth/loginLifeCycleDisconnected",new Error("disconnect due to network offline")),this.options.ondisconnect&&this.options.ondisconnect({code:"offlineListener",callFunc:"link::offlineListener",message:"offlineListener disconnect"}),this.onDisconnect("link::offlineListener","broken")}function de(){var Ne=this;this.logger.log("onlineListener start"),this&&this.isConnected()&&!this.connecting?(this.stopHeartbeat(),this.sendCmd("heartbeat",null,function(ze){if(ze){Ne.logger.info("onlineListener heartbeat detect error",ze);try{Ne.forceDisconnect(),Ne.onDisconnect("link::onHeartbeat","broken")}catch($e){Ne.logger.info("onlineListener heartbeat websocket.onclose",$e)}}else Ne.logger.log("onlineListener heartbeat detect success")})):this.logger.log("onlineListener disconnected or connecting",this&&this.isConnected(),this.connecting)}re.initConnect=function(){this.socket=null,this.retryCount=0,this.connecting=!1,this.shouldReconnect=!0,this.hasNotifyDisconnected=!1,this.doLogout=!1},re.resetConnect=function(){var Ne=this.options;oe.notundef(Ne.needReconnect)?(oe.verifyParamType("needReconnect",Ne.needReconnect,"boolean","link::resetConnect"),this.needReconnect=Ne.needReconnect):this.needReconnect=!0,this.logger.info("link::resetConnect: needReconnect ".concat(this.needReconnect)),oe.notundef(Ne.reconnectionAttempts)&&oe.verifyParamType("reconnectionAttempts",Ne.reconnectionAttempts,"number","link::resetConnect"),oe.notundef(Ne.noCacheLinkUrl)&&oe.verifyParamType("noCacheLinkUrl",Ne.noCacheLinkUrl,"boolean","link::resetConnect"),this.reconnectionAttempts=typeof Ne.reconnectionAttempts=="number"?Ne.reconnectionAttempts:1/0,this.backoff=new ue({min:le.reconnectionDelay,max:le.reconnectionDelayMax,jitter:le.reconnectionJitter})},re.reportTCPException=function(Ne){var ze=this;y(Ne).call(Ne,function($e,Lt){var jt,Et=$e.event,ir=Et===void 0?{}:Et,dr=$e.message,Dt=ir.startTime,lr=ir.code,sr=ir.reason,er=ir.url,cr="";dr==="handshake_failed"?cr="handshake_failed":dr==="connect_failed"?cr=sr?"connect_failed:".concat(sr):"connect_failed":dr==="socket_error"&&(cr=sr?"socket.io error:".concat(sr):"socket.io error"),ze.logger.warn(i(jt="connect::failed ".concat(Lt,", ")).call(jt,cr),$e),ze.reporter.reportTraceStart("exceptions",{user_id:ze.options.account,trace_id:oe.get(self,"socket.socket.sessionid"),start_time:Dt,action:0,exception_service:6}),ze.reporter.reportTraceUpdateV2("exceptions",{code:lr,description:dr,operation_type:0,target:er,net_connect:ze.checkNetworkAvailable()}),ze.reporter.reportTraceEnd("exceptions",1)})},re.connect=g(n.mark(function Ne(){var ze,$e,Lt,jt,Et;return n.wrap(function(ir){for(;;)switch(ir.prev=ir.next){case 0:if(Lt=this,clearTimeout(Lt.connectTimer),!Lt.isConnected()){ir.next=5;break}return Lt.logger.warn("link::connect: already connected"),ir.abrupt("return");case 5:if(!Lt.connecting){ir.next=8;break}return Lt.logger.warn("link::connect: already connecting"),ir.abrupt("return");case 8:if(Lt.connecting=!0,Lt.hasNotifyDisconnected=!1,Lt.shouldReconnect=!0,Lt.socket&&Lt.forceDisconnect(),Lt.logger.info("link::connect: connect to new socket, autoconnect is "+Lt.autoconnect),typeof Lt.options.socketUrl=="string"&&(Lt.logger.info("link::connect: try to options.socketUrl ",Lt.options.socketUrl),Lt.socketUrls=[Lt.options.socketUrl]),ir.prev=14,Lt.socketUrls&&Lt.socketUrls.length>0){ir.next=20;break}return ir.next=18,Lt.refreshSocketUrl();case 18:Lt.socketUrls=ae(Lt.socketUrls),Lt.logger.info("link::connect: refreshSocketUrl success, socketConcurrent ".concat(Lt.imsocket.config.socketConcurrent),Lt.socketUrls);case 20:ir.next=28;break;case 22:return ir.prev=22,ir.t0=ir.catch(14),Lt.logger.warn("connect::refreshSocketUrl: catch exception,",ir.t0&&ir.t0.message),Lt.connecting=!1,this.options.ondisconnect({code:"initConnectFail",callFunc:"ProtocolFn.connect",message:"refresh socket url fail"}),ir.abrupt("return");case 28:return Lt.imsocket.resetSockets(),Lt.imsocket.setUrls(k(ze=Lt.socketUrls).call(ze,0)),$($e=Lt.socketUrls).call($e,0,Lt.imsocket.config.socketConcurrent),ir.prev=31,ir.next=34,Lt.imsocket.connect();case 34:Lt.socket=ir.sent,Lt.onConnect(),ir.next=46;break;case 38:ir.prev=38,ir.t1=ir.catch(31),Et="",ir.t1.errors&&(Lt.reportTCPException(ir.t1.errors),jt=ir.t1.errors[0]),jt.message==="handshake_failed"?(Lt.onHandshakeFailed(jt.event.startTime,jt.event.url),Et="link::onHandshakeFailed"):jt.message==="connect_failed"?(Lt.onConnectFailed(jt.event.reason,jt.event.startTime,jt.event.url),Et="link::onConnectFailed"):jt.message==="socket_error"?(Lt.onSocketError(jt.event.reason,jt.event.startTime,jt.event.url),Et="link::onSocketError"):(Et="link::otherFailed",Lt.logger.warn("link::otherFailed",jt)),this.statusProtector.emit("auth/loginLifeCycleConnectFail",new Error("".concat(Et," 408"))),Lt.connecting=!1,Lt.willReconnect()?Lt.onDisconnect(Et):this.options.ondisconnect({code:"initConnectFail",callFunc:"ProtocolFn.connect",message:"init connect fail"});case 46:case"end":return ir.stop()}},Ne,this,[[14,22],[31,38]])})),re.isConnected=function(){return!!this.socket&&!!this.socket.socket&&this.socket.socket.connected},re.disconnect=function(){var Ne=arguments.length>0&&arguments[0]!==void 0?arguments[0]:function(){},ze=this;function $e(Lt){clearTimeout(ze.disconnectCallbackTimer),ze.msgAckBufferManager&&ze.msgAckBufferManager.clear(),ze.roamingMsgSyncDoneBufferManager&&ze.roamingMsgSyncDoneBufferManager.clear(),ze.statusProtector.emit("auth/loginLifeCycleDisconnected",new Error("disconnect due to active action")),ze.statusProtector.emit("auth/loginLifeCycleLogout"),L(function(){Ne(Lt)},0)}clearTimeout(ze.connectTimer),ze.disconnectCallbackTimer=L(function(){Ne.call(ze,"mark disconnected due to timeout")},1e4),ze.mixStorePolicy=null,ze.appGrayConfig=null,ze.resetReconnectStatus(),clearTimeout(ze.mixStorePolicyClock),this.onlineListener&&typeof window<"u"&&oe.isFunction(window.removeEventListener)&&(window.removeEventListener("online",this.onlineListener),window.removeEventListener("offline",this.offlineListener),this.onlineListener=null,this.offlineListener=null),ze.isConnected()?(ze.logger.warn("link::disconnect: start disconnecting"),ze.logout()):ze.connecting?(ze.logger.warn("link::disconnect: abort connecting"),ze.disconnectSocket()):(ze.logger.warn("link::disconnect: already disconnected"),ze.connecting=!1,ze.shouldReconnect=!1,ze.socket=null,ze.autoconnect=!1,ze.options.ondisconnect({code:"alreadyDisconnected",callFunc:"link::disconnect",message:"manually disconnect status"})),ze.socket&&ze.socket.socket&&ze.socket.socket.transport?ze.socket.socket.transport.onDisconnectDone=function(Lt){ze.logger.warn("link::disconnect: invoke [done] when socket closed",Lt),$e(Lt)}:(ze.logger.warn("link::disconnect: invoke [done]"),$e(null))},re.resetReconnectStatus=function(){this.backoff&&(this.backoff.setMin(le.reconnectionDelay),this.backoff.setMax(le.reconnectionDelayMax),this.backoff.reset()),this.retryCount=0,this.logger.info("link::resetReconnectStatus: reset retryCount and backoff")},re.onConnect=function(){this.connecting=!1,this.shouldReconnect=!0,this.hasNotifyDisconnected=!1,this.logger.info("link::onConnect success"),this.statusProtector.emit("auth/loginLifeCycleConnectSucc"),this.login()},re.onDisconnect=function(){var Ne=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,ze=arguments.length>1?arguments[1]:void 0,$e=this;this.logger.warn("socket::onDisconnect: "+Ne),$e.connecting=!1,$e.markAllCallbackInvalid(ie.newNetworkError({callFunc:Ne,uploadCode:415,disconnectReason:ze})),$e.msgAckBufferManager&&$e.msgAckBufferManager.clear(),$e.roamingMsgSyncDoneBufferManager&&$e.roamingMsgSyncDoneBufferManager.clear(),$e.stopHeartbeat(),$e.reconnect()},re.willReconnect=function(){return this.shouldReconnect&&this.needReconnect&&this.retryCount<this.reconnectionAttempts},re.reconnect=function(){var Ne=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!this.__destroyed)if(this.willReconnect()){if(this.socket&&(this.logger.info("link::reconnect: try to force disconnect"),this.forceDisconnect()),this.socketUrls.length===0&&!this.options.socketUrl&&typeof Ne.allFailedCB=="function")return this.logger.log("reconnect: All socket links have been polled, trigger hooks"),void Ne.allFailedCB();this.doReconnect()}else this.notifyDisconnect({code:"allAttemptsFailed",message:"All attempts failed"})},re.doReconnect=function(){var Ne,ze=this;ze.socket=null,ze.retryCount++,ze.hasLogin=!1;var $e,Lt=ze.backoff.duration();ze.logger.info(i(Ne="link::reconnect: will retry after ".concat(Lt,"ms, retryCount ")).call(Ne,ze.retryCount)),$e=ze.options.onwillreconnect({retryCount:ze.retryCount,duration:Lt}),ze.statusProtector.emit("auth/loginLifeCycleWaiting"),clearTimeout(ze.connectTimer),ze.connectTimer=L(function(){+ze.options.authType==1&&$e instanceof V?(ze.logger.info("link::reconnect: wait onwillreconnect promise"),$e.finally(function(){return ze.connect()})):ze.connect()},Lt)},re.notifyConnectError=function(Ne){var ze=ie.newConnectError({message:Ne,callFunc:"link::notifyConnectError"});this.logger.error("link::notifyConnectError:",ze),this.options.onerror(ze)},re.notifyDisconnect=function(Ne){this.hasNotifyDisconnected?this.logger.warn("notifyDisconnect:: already notified"):(this.hasNotifyDisconnected=!0,this.disconnectSocket(),this.forceDisconnect(),(Ne=Ne||new ie).retryCount=this.retryCount,Ne.willReconnect=this.willReconnect(),this.backoff&&this.backoff.reset(),this.retryCount=0,this.autoconnect=!1,this.logger.info("link::notifyDisconnect: ondisconnected",Ne),this.options.ondisconnect(Ne),this.onWbNotifyHangup instanceof Function&&this.onWbNotifyHangup({content:{account:this.account,channelId:null,timetag:+Date()}}))},re.disconnectSocket=function(){if(this.isConnected()||this.connecting){this.connecting=!1,this.shouldReconnect=!1;try{this.socket&&this.socket.disconnect()}catch(Ne){this.socket&&typeof this.socket.removeAllListenersX=="function"&&this.socket.removeAllListenersX("info"),this.logger.info("link::disconnectSocket: disconnect failed, error ",Ne&&Ne.message)}}},re.initOnlineListener=function(){this.needReconnect&&this.options&&this.options.quickReconnect?typeof window<"u"&&oe.isFunction(window.addEventListener)?this.onlineListener||(this.onlineListener=z(de).call(de,this),this.offlineListener=z(qe).call(qe,this),this.logger.info("initOnlineListener success"),window.addEventListener("online",this.onlineListener),window.addEventListener("offline",this.offlineListener)):this.logger.warn("initOnlineListener no window.addEventListener"):this.logger.warn("initOnlineListener no quickReconnect")},re.forceDisconnect=function(){var Ne=this.socket||{};this.socket=null;try{typeof Ne.removeAllListenersX=="function"&&Ne.removeAllListenersX("info"),typeof Ne.disconnect=="function"&&Ne.disconnect()}catch(ze){this.logger.error("forceDisconnect:: oldSocket error",ze||ze.message)}this.hasLogin=!1}},function(t,r){function e(n){n=n||{},this.ms=n.min||100,this.max=n.max||1e4,this.factor=n.factor||2,this.jitter=n.jitter>0&&n.jitter<=1?n.jitter:0,this.attempts=0}t.exports=e,e.prototype.duration=function(){var n=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var g=Math.random(),y=Math.floor(g*this.jitter*n);n=1&Math.floor(10*g)?n+y:n-y}return 0|Math.min(n,this.max)},e.prototype.reset=function(){this.attempts=0},e.prototype.setMin=function(n){this.ms=n},e.prototype.setMax=function(n){this.max=n},e.prototype.setJitter=function(n){this.jitter=n}},function(t,r,e){var n=e(672);t.exports=function(g){return g&&g.length?n(g):[]}},function(t,r,e){var n=e(673),g=e(676),y=e(681),i=e(682),k=e(683),$=e(290);t.exports=function(L,V,z){var re=-1,ie=g,ue=L.length,le=!0,oe=[],ae=oe;if(z)le=!1,ie=y;else if(ue>=200){var qe=V?null:k(L);if(qe)return $(qe);le=!1,ie=i,ae=new n}else ae=V?[]:oe;e:for(;++re<ue;){var de=L[re],Ne=V?V(de):de;if(de=z||de!==0?de:0,le&&Ne==Ne){for(var ze=ae.length;ze--;)if(ae[ze]===Ne)continue e;V&&ae.push(Ne),oe.push(de)}else ie(ae,Ne,z)||(ae!==oe&&ae.push(Ne),oe.push(de))}return oe}},function(t,r,e){var n=e(260),g=e(674),y=e(675);function i(k){var $=-1,L=k==null?0:k.length;for(this.__data__=new n;++$<L;)this.add(k[$])}i.prototype.add=i.prototype.push=g,i.prototype.has=y,t.exports=i},function(t,r){t.exports=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this}},function(t,r){t.exports=function(e){return this.__data__.has(e)}},function(t,r,e){var n=e(677);t.exports=function(g,y){return!!(g!=null&&g.length)&&n(g,y,0)>-1}},function(t,r,e){var n=e(678),g=e(679),y=e(680);t.exports=function(i,k,$){return k==k?y(i,k,$):n(i,g,$)}},function(t,r){t.exports=function(e,n,g,y){for(var i=e.length,k=g+(y?1:-1);y?k--:++k<i;)if(n(e[k],k,e))return k;return-1}},function(t,r){t.exports=function(e){return e!=e}},function(t,r){t.exports=function(e,n,g){for(var y=g-1,i=e.length;++y<i;)if(e[y]===n)return y;return-1}},function(t,r){t.exports=function(e,n,g){for(var y=-1,i=e==null?0:e.length;++y<i;)if(g(n,e[y]))return!0;return!1}},function(t,r){t.exports=function(e,n){return e.has(n)}},function(t,r,e){var n=e(272),g=e(684),y=e(290),i=n&&1/y(new n([,-0]))[1]==1/0?function(k){return new n(k)}:g;t.exports=i},function(t,r){t.exports=function(){}},function(t,r,e){var n,g=e(15),y=e(78).fn,i=e(41),k=e(195),$=e(0),L=e(11),V=e(45),z=e(196).getLibEnv,re=e(64),ie=e(196).getHostEnvEnum,ue=$.notundef;y.genSessionKey=(n={},function(){var le=this.name;return n[le]=n[le]||$.guid()}),y.afterLogin=$.emptyFunc,y.assembleIMLogin=function(){var le,oe=this.options,ae=oe.account;this.sdkSession=this.genSessionKey();var qe={appLogin:this.autoconnect?0:1,appKey:oe.appKey,account:ae,token:oe.token,sdkVersion:L.info.sdkVersion,sdkHumanVersion:L.info.sdkHumanVersion,protocolVersion:L.info.protocolVersion,os:re.os.toString()==="[object Object]"?re.os.family:re.os.toString(),browser:re.name+" "+re.version,clientType:L.CLIENTTYPE||16,session:this.sdkSession,deviceId:V.deviceId,isReactNative:L.isRN?1:0,customTag:oe.customTag||""};return qe.userAgent=(L.isBrowser?navigator&&navigator.userAgent:"")||"",qe.userAgent=oe.loginSDKTypeParamCompat?"Native/"+L.info.sdkHumanVersion:g(le=qe.userAgent).call(le,0,299),qe.libEnv=oe.loginSDKTypeParamCompat?void 0:z(),qe.sdkType=oe.loginSDKTypeParamCompat?0:ie(),oe.customClientType&&(qe.customClientType=+oe.customClientType),oe.authType&&(qe.authType=+oe.authType),oe.loginExt&&(qe.loginExt=oe.loginExt),qe},y.notifyLogin=function(le){this.logger.info("link::notifyLogin: on connect",le),this.options.onconnect(le)},y.logout=function(){if(this.doLogout)return this.doLogout=!1,void this.onAuthError(new i("done logout","logout",{disconnectReason:"close",uploadCode:415}),"link::logout");this.isConnected()&&this.onAuthError(new i("done disconnect","logout",{disconnectReason:"close",uploadCode:415}),"link::logout")},y.onKicked=function(le){var oe=le.content,ae=oe.from,qe=oe.reason,de=oe.custom,Ne=oe.customClientType,ze={reason:this.kickedReasons[qe]||"unknown",message:this.kickedMessages[qe]||"未知原因"};ue(ae)&&(ze.from=k.reverseType(ae)),ue(de)&&(ze.custom=de),+Ne>0&&(ze.customClientType=Ne),this.logger.warn("link::onKicked:",ze);var $e=new i("被踢了","kicked",{disconnectReason:"kicked",uploadCode:415});$.merge($e,ze),this.onAuthError($e,"link::onKicked"),this.statusProtector.emit("auth/loginLifeCycleDisconnected",new Error("disconnect due to kicked")),this.statusProtector.emit("auth/loginLifeCycleKicked",ze)},y.onAuthError=function(le,oe){var ae=le&&le.code;if(this.logger.error("onAuthError ",oe,ae),/^(Error_Internet_Disconnected|Error_Timeout|Error_Connection_Socket_State_not_Match)$/.test(ae))return this.forceDisconnect(),void this.onDisconnect("link::onAuthError::"+ae,"broken");(le=le||i.newConnectionError({callFunc:oe,uploadCode:415,disconnectReason:"close"})).callFunc=le.callFunc||oe||null,this.shouldReconnect=!1,this.markAllCallbackInvalid(le),this.notifyDisconnect(le)}},function(t,r,e){var n=e(24),g=e(26),y=e(22),i=e(78).fn,k=e(11),$=e(0);i.processLink=function(L){switch(L.cmd){case"heartbeat":this.startHeartbeat();break;case"notifyDetect":y($._get(L,"content.notifyDetectTag"))==="object"&&(L.content.notifyDetectTag.t3=new Date().getTime(),this.startDetect(L))}},i.startHeartbeat=function(){var L=this;L.stopHeartbeat(),L.heartbeatTimer=n(function(){var V;L.sendCmd("heartbeat",null,g(V=L.onHeartbeat).call(V,L))},k.heartbeatInterval)},i.detectHeartbeat=function(){var L;this.stopHeartbeat(),this.sendCmd("heartbeat",null,g(L=this.onHeartbeat).call(L,this))},i.startDetect=function(L){var V=L.content.notifyDetectTag;V.t4=new Date().getTime(),this.sendCmd("uploadDetect",{notifyDetectTag:V})},i.stopHeartbeat=function(){this.heartbeatTimer&&(clearTimeout(this.heartbeatTimer),this.heartbeatTimer=null)},i.onHeartbeat=function(L){if(L){if(this.syncing)return this.logger.warn("onHeartbeat::ignore error in connecting"),void this.startHeartbeat();var V;L.callFunc="link::onHeartbeat",this.onCustomError("heartbeat error",L),this.heartbeatFail++,this.logger.warn("onHeartbeat::error ",L.code,L),L.code==="Error_Timeout"&&(this.heartbeatFail>1?(this.reporterHookLinkKeep.update({code:0,description:"Heartbeat-discovered link failure",operation_type:1,target:this.url}),this.reporterHookLinkKeep.end(!0),this.forceDisconnect(),this.onDisconnect("link::onHeartbeat","broken")):this.sendCmd("heartbeat",null,g(V=this.onHeartbeat).call(V,this)))}else this.heartbeatFail=0},i.checkNetworkAvailable=typeof navigator<"u"&&typeof navigator.onLine=="boolean"?function(){return navigator.onLine}:function(){},i.heartbeat=function(){}},function(t,r,e){var n=e(3),g=e(7),y=e(32),i=e(24),k=e(48),$=e(78).fn,L=e(286),V=e(11),z=e(45);$.processMisc=function(re){switch(re.cmd){case"getSimpleNosToken":re.error||(re.obj=re.content.nosTokens[0]);break;case"getNosToken":re.error||(re.obj=re.content.nosToken);break;case"getGrayscaleConfig":re.error||(re.obj=re.content.appGrayConfigTag);break;case"getMixStorePolicy":re.error||(re.obj=re.content.mixStorePolicyTag);break;case"getMixStoreToken":re.error||(re.obj=re.content.mixStoreTokenTag);break;case"getBackSourceToken":re.error||(re.obj=re.content.backSourceTokenTag);break;case"uploadSdkLogUrl":re.error?this.logger.error("uploadSdkLogUrl::error",re.error):this.logger.info("uploadSdkLogUrl::success",re.obj&&re.obj.url);break;case"notifyUploadLog":re.error||(V.isRN?this.uploadLocalLogRN():V.isBrowser&&this.uploadLocalLogWeb(),this.emitAPI({type:"notifyUploadLog"}));break;case"audioToText":re.error||(re.obj.text=re.content.text);break;case"processImage":re.obj.imageOps=L.reverseImageOps(re.obj.imageOps),re.error||(re.obj={url:re.content.url});break;case"getNosTokenTrans":re.error||(re.obj={nosToken:re.content.nosToken,docId:re.content.docId});break;case"getNosOriginUrl":re.error||(re.obj=re.content.nosFileUrlTag.originUrl);break;case"notifyTransLog":re.error||this.emitAPI({type:"notifyTransLog",obj:re.content.transInfo});break;case"fetchFile":case"fetchFileList":case"removeFile":re.error||(re.obj=re.content);break;case"getServerTime":re.obj=re.content&&re.content.time;break;case"getNosCdnHost":this.getNosCdnHost(re)}},$.uploadLocalLogRN=function(){if(V.isRN&&z.rnfs){var re=z.rnfs,ie=this,ue=re.nimIndex,le=(re.nimIndex+1)%2;re.nimPromise=re.nimPromise.then(function(){return n.all([re.exists(oe(ue)),re.exists(oe(le))])}).then(function(ae){return ae&&(ae[0]||ae[1])?ae[0]&&ae[1]?re.copyFile(oe(le),oe(2)).then(function(){return re.readFile(oe(ue))}).then(function(qe){return re.appendFile(oe(2),qe)}):ae[0]?re.copyFile(oe(ue),oe(2)):void(ae[1]&&re.copyFile(oe(le),oe(2))):n.reject()}).then(function(){return new n(function(ae){ie.api.previewFile({filePath:oe(2),done:function(qe,de){if(n.all([re.unlink(oe(2)),re.unlink(oe(1)),re.unlink(oe(0))]).finally(function(){ae()}),qe)ie.logger.error("nim::uploadLocalLogRN:previewFile:error",qe);else{var Ne=de.url;g(Ne).call(Ne,"?")>0?Ne+="&":Ne+="?",Ne+="download="+new Date().getTime()+"_rn.log",ie.api.uploadSdkLogUrl({url:Ne})}}})})}).catch(function(ae){re.unlink(oe(2)).catch(function(){}),ie.logger.error("nim::protocol::uploadLocalLogRN",ae)})}function oe(ae){return re.DocumentDirectoryPath+"/nimlog_"+ae+".log"}},$.uploadLocalLogWeb=function(){var re=this;this.options.dbLog!==!1&&this.logger._local?this.logger._local.fetchLog().then(function(ie){!ie||!ie.logs||y(ie.logs)&&ie.logs.length===0?re.logger.warn("uploadLocalLogWeb::no logs"):re.api.previewFile({blob:new Blob([ie.logs],{type:"text/plain"}),done:function(ue,le){if(ue)re.logger.error("uploadLocalLogWeb::previewFile:error",ue);else{re.logger.log("uploadLocalLogWeb::previewFile:success",le);var oe=le.url;oe+=(g(oe).call(oe,"?")>0?"&":"?")+"download="+new Date().getTime()+"_web.log",re.api.uploadSdkLogUrl({url:oe}),re.logger._local.deleteLogs(ie.time).then(function(){re.logger.log("uploadLocalLogWeb::deleteLogs success")}).catch(function(ae){return re.logger.error("uploadLocalLogWeb::deleteLogs:error ,",ae)})}}})}).catch(function(ie){re.logger.error("uploadLocalLogWeb::fetchLog:error",ie)}):this.logger.warn("uploadLocalLogWeb::no dbLog")},$.getNosCdnHost=function(re){var ie=this,ue=re.error;if(ue&&(ue.callFunc="events::getNosCdnHost",ie.onCustomError("getNosCdnHost","EVENT_GET_NOS_CDN_HOST_ERROR",ue)),re.content&&re.content.nosConfigTag){var le=re.content.nosConfigTag,oe="",ae="";le.expire!==0&&le.cdnDomain?le.expire===-1?(oe=le.cdnDomain,ae=le.objectNamePrefix):(oe=le.cdnDomain,ae=le.objectNamePrefix,ie.nosCdnHostTimer&&clearTimeout(ie.nosCdnHostTimer),ie.nosCdnHostTimer=i(function(){ie.sendCmd("getNosCdnHost",{})},800*k(le.expire))):(oe="",ae=""),V.serverNosConfig.cdnDomain=oe,V.serverNosConfig.objectPrefix=ae,V.hasLocalStorage&&(localStorage.setItem("nim_cdn_domain",oe),localStorage.setItem("nim_object_prefix",ae))}}},function(t,r,e){var n=e(9),g=e(32),y=e(78).fn,i=e(0),k=e(287),$=e(107).EMSyncType;y.processAvSignal=function(V){switch(V.cmd){case"signalingCreate":case"signalingDelay":case"signalingClose":case"signalingJoin":case"signalingLeave":case"signalingInvite":case"signalingCancel":case"signalingReject":case"signalingAccept":case"signalingControl":case"signalingSyncMsgRead":case"signalingGetChannelInfo":case"signalingCallEx":break;case"signalingNotify":this.onSignalingNotify(V);break;case"signalingMutilClientSyncNotify":this.onSignalingMutilClientSyncNotify(V);break;case"signalingUnreadMessageSyncNotify":this.onSignalingUnreadMessageSyncNotify(V);break;case"signalingChannelsSyncNotify":this.onSignalingMembersSyncNotify(V);break;default:this.logger.warn("avSignal::unhandled cmd:",V.cmd)}};var L=function(){var V=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(V.needPush&&(V.needPush=V.needPush==="1"),V.needBadge&&(V.needBadge=V.needBadge==="1"),V.channelInValid&&(V.channelInValid=V.channelInValid==="1"),V.attach){var z=JSON.parse(V.attach);V.eventType=k.parseAvSignalType(z.type)}if(V.members){var re=JSON.parse(V.members);V.members=n(re).call(re,function(ie){return k.parseAvSignalMember(ie)})}return V};y.onSignalingNotify=function(V){if(V.error){var z=V.error;this.logger.error("protocal::avSignal:onSignalingNotify error",z),this.emitAPI({type:"error",error:z}),this.options.onerror(z)}else{V.raw&&V.raw.r&&V.raw.r.length&&V.content&&V.content.avSignalTag&&(V.content.avSignalTag.msgid=V.raw.r[0]);var re=V.content.avSignalTag;re=g(re)?n(re).call(re,function(ie){return L(ie)}):L(re),this.emitAPI({type:"signalingNotify",obj:re}),i.isFunction(this.options.onSignalingNotify)&&this.options.onSignalingNotify(re)}},y.onSignalingMutilClientSyncNotify=function(V){if(V.error){var z=V.error;this.logger.error("protocal::avSignal:onSignalingMutilClientSyncNotify error",z),this.emitAPI({type:"error",error:z}),this.options.onerror(z)}else{var re=V.content.avSignalTag;re=g(re)?n(re).call(re,function(ie){return L(ie)}):L(re),this.emitAPI({type:"signalingMutilClientSyncNotify",obj:re}),i.isFunction(this.options.onSignalingMutilClientSyncNotify)&&this.options.onSignalingMutilClientSyncNotify(re)}},y.onSignalingUnreadMessageSyncNotify=function(V){if(V.error){var z=V.error;this.logger.error("protocal::avSignal:onSignalingUnreadMessageSyncNotify error",z),this.emitAPI({type:"error",error:z}),this.options.onerror(z)}else{var re=V.content.avSignalTag;g(re)&&(re=n(re).call(re,function(ie){return L(ie)})),this.emitAPI({type:"signalingUnreadMessageSyncNotify",obj:re}),this.reporterHook.emit("reporter/syncItemComplete",$.kSyncType15_13),i.isFunction(this.options.onSignalingUnreadMessageSyncNotify)&&this.options.onSignalingUnreadMessageSyncNotify(re)}},y.onSignalingMembersSyncNotify=function(V){if(V.error){var z=V.error;this.logger.error("protocal::avSignal:onSignalingMembersSyncNotify error",z),this.emitAPI({type:"error",error:z}),this.options.onerror(z)}else{var re=V.content.avSignalTag;g(re)||(re=[re]),re=n(re).call(re,function(ie){return L(ie)}),this.emitAPI({type:"signalingChannelsSyncNotify",obj:re}),i.isFunction(this.options.onSignalingMembersSyncNotify)&&this.options.onSignalingMembersSyncNotify(re)}}},function(t,r,e){var n=e(8),g=e(26),y=e(0),i=e(78).fn,k=e(118),$=e(278);i.adaptersRequest=function(L){var V=this,z=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},re=arguments.length>2?arguments[2]:void 0,ie=z.onerror||function(){},ue=new Date().getTime(),le=y.get(re,"exception_service")||0;return z.onerror=function(){ie.apply(void 0,arguments);var oe=arguments.length<=0?void 0:arguments[0];V.reporter.reportTraceStart("exceptions",{user_id:V.account,trace_id:y.get(self,"socket.socket.sessionid"),start_time:ue,action:1,exception_service:le}),V.reporter.reportTraceUpdateV2("exceptions",{code:typeof oe.status=="number"?oe.status:typeof oe.code=="number"?oe.code:0,description:oe.message||"".concat(oe.code),operation_type:0,target:L,context:z?n(z):"",net_connect:V.checkNetworkAvailable()}),V.reporter.reportTraceEnd("exceptions",1)},k(L,z)},i.adaptersUploadFile=function(L,V){var z,re=this;L.adaptersRequest=g(z=i.adaptersRequest).call(z,this);var ie=new Date().getTime();return L.errorHook=function(ue){var le=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(ue){re.reporter.reportTraceStart("exceptions",{user_id:re.account,trace_id:y.get(self,"socket.socket.sessionid"),start_time:ie,action:1,exception_service:le.provider==="s3"?4:3});var oe=le.url||L.url;ue.bucket&&(oe=n(ue)),re.reporter.reportTraceUpdateV2("exceptions",{code:typeof ue.status=="number"?ue.status:typeof ue.code=="number"?ue.code:0,description:ue.message||"".concat(ue.code),operation_type:1,target:oe,net_connect:re.checkNetworkAvailable()}),re.reporter.reportTraceEnd("exceptions",1)}},new $(L,this,V)}},function(t,r,e){e(292);var n,g,y,i=e(43),k=e(60),$=e(37),L=e(2),V=e(3),z=e(4),re=e(24),ie=e(16),ue=e(15),le=e(6),oe=e(22);y=function(){function ae(Ne,ze){for(var $e=0;$e<ze.length;$e++){var Lt=ze[$e];Lt.enumerable=Lt.enumerable||!1,Lt.configurable=!0,"value"in Lt&&(Lt.writable=!0),i(Ne,Lt.key,Lt)}}var qe={isDataReportEnable:!0,maxSize:100,msgListMaxSize:1e3,cacheMaxSize:1e3,maxDelay:3e5,maxInterval:3e4,minInterval:1e4,timeout:5e3,autoStart:!0},de=function(){};return function(){function Ne(Lt){(function(jt,Et){if(!(jt instanceof Et))throw new TypeError("Cannot call a class as a function")})(this,Ne),this.isUploadEnable=!1,this.initConfigLoaded=!1,this.loading=!1,this.isDestroyed=!1,this.reportConfig=qe,this.traceMsgCache={},this.highPriorityMsgList=[],this.msgList=[],this.lowPriorityMsgList=[],this.cacheMsgList=[],this.lastReportTime=k(),this.timer=null,this.setConfig(Lt),this.reportConfig.isDataReportEnable&&this.reportConfig.autoStart&&this.initUploadConfig()}var ze,$e;return ze=Ne,($e=[{key:"setConfig",value:function(Lt){var jt=$({},this.reportConfig.common,Lt.common);this.reportConfig=$({},this.reportConfig,Lt),this.reportConfig.common=jt,this.reportConfig.common.sdk_type||(this.reportConfig.common.sdk_type="im")}},{key:"reportImmediately",value:function(Lt,jt){var Et=this;this.reportConfig.isDataReportEnable&&this.reportConfig.request(Lt,$({dataType:"json",method:"POST",timeout:this.reportConfig.timeout},jt)).catch(function(ir){var dr,Dt;(Dt=(dr=Et.reportConfig)===null||dr===void 0?void 0:dr.logger)===null||Dt===void 0||Dt.warn("Reporter immediately upload failed",ir)})}},{key:"report",value:function(Lt,jt){var Et=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(Et.priority||(Et.priority=this.getEventPriority(Lt,jt)),this.reportConfig.isDataReportEnable&&Lt){var ir=k();Et.priority==="HIGH"?this.highPriorityMsgList.push({module:Lt,msg:jt,createTime:ir}):Et.priority==="NORMAL"?this.msgList.push({module:Lt,msg:jt,createTime:ir}):Et.priority==="LOW"&&this.lowPriorityMsgList.push({module:Lt,msg:jt,createTime:ir}),this.highPriorityMsgList.length>this.reportConfig.msgListMaxSize&&this.highPriorityMsgList.shift(),this.msgList.length>this.reportConfig.msgListMaxSize&&this.msgList.shift(),this.lowPriorityMsgList.length>this.reportConfig.msgListMaxSize&&this.lowPriorityMsgList.shift(),this.doReport()}}},{key:"reportTraceStart",value:function(Lt,jt){if(this.reportConfig.isDataReportEnable&&Lt&&!this.traceMsgCache[Lt]){var Et=$($({start_time:k()},jt),{extension:[]});this.traceMsgCache[Lt]=Et}}},{key:"reportTraceUpdate",value:function(Lt){}},{key:"reportTraceUpdateV2",value:function(Lt,jt,Et){var ir,dr=this;if(this.reportConfig.isDataReportEnable&&this.traceMsgCache[Lt]){var Dt=this.traceMsgCache[Lt].extension,lr=Dt.length,sr=new Date().getTime();lr===0?jt.duration=sr-this.traceMsgCache[Lt].start_time:Dt[lr-1].end_time?jt.duration=sr-Dt[lr-1].end_time:jt.duration=sr-this.traceMsgCache[Lt].start_time,Dt.push($({end_time:sr},jt));var er=Dt.length-1;Et!=null&&Et.asyncParams&&((ir=this.traceMsgCache[Lt]).asyncPromiseArray||(ir.asyncPromiseArray=[]),this.traceMsgCache[Lt].asyncPromiseArray.push(Et.asyncParams.then(function(cr){dr.traceMsgCache[Lt]&&dr.traceMsgCache[Lt].extension[er]&&$(dr.traceMsgCache[Lt].extension[er],cr)})))}}},{key:"reportTraceEnd",value:function(Lt){var jt,Et=this,ir=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];if(this.reportConfig.isDataReportEnable&&this.traceMsgCache[Lt])if(Lt!=="nos"||ir===!1)if(typeof ir=="boolean"?this.traceMsgCache[Lt].succeed=!!ir:this.traceMsgCache[Lt].state=ir,this.traceMsgCache[Lt].duration=k()-this.traceMsgCache[Lt].start_time,L(jt=this.traceMsgCache[Lt].extension).call(jt,function(lr){delete lr.end_time}),this.traceMsgCache[Lt].asyncPromiseArray){var dr=this.traceMsgCache[Lt],Dt=function(){dr===Et.traceMsgCache[Lt]&&(delete Et.traceMsgCache[Lt].asyncPromiseArray,Et.report(Lt,Et.traceMsgCache[Lt],{priority:Et.getEventPriority(Lt,Et.traceMsgCache[Lt])}),Et.traceMsgCache[Lt]=null)};V.all(this.traceMsgCache[Lt].asyncPromiseArray).then(Dt).catch(Dt)}else this.report(Lt,this.traceMsgCache[Lt],{priority:this.getEventPriority(Lt,this.traceMsgCache[Lt])}),this.traceMsgCache[Lt]=null;else this.traceMsgCache[Lt]=null}},{key:"getEventPriority",value:function(Lt,jt){if(Lt==="exceptions"){if(jt.action===0||jt.action===2||jt.action===1&&jt.exception_service!==0)return"HIGH"}else if(Lt==="msgReceive"||Lt==="nim_api_trace")return"LOW";return"NORMAL"}},{key:"reportTraceCancel",value:function(Lt){this.reportConfig.isDataReportEnable&&(this.traceMsgCache[Lt]=null)}},{key:"pause",value:function(){this.reportConfig.isDataReportEnable&&(this.isUploadEnable=!1)}},{key:"restore",value:function(){this.reportConfig.isDataReportEnable&&(this.isUploadEnable=!0,this.initConfigLoaded||this.initUploadConfig())}},{key:"destroy",value:function(){var Lt,jt=this;this.reportConfig.isDataReportEnable&&(L(Lt=z(this.traceMsgCache)).call(Lt,function(Et){jt.reportTraceEnd(Et,1)}),this.timer!==null&&clearTimeout(this.timer),this.setConfig=de,this.report=de,this.reportTraceStart=de,this.reportTraceUpdate=de,this.reportTraceEnd=de,this.pause=de,this.restore=de,this.destroy=de,this.cacheMsgList=[],this.traceMsgCache={},this.lowPriorityMsgList=[],this.msgList=[],this.highPriorityMsgList=[],this.reportConfig={},this.isDestroyed=!0)}},{key:"initUploadConfig",value:function(){var Lt,jt,Et=this;if(!this.loading){this.loading=!0;var ir=this.reportConfig.common||{};try{this.reportConfig.request(this.reportConfig.reportConfigUrl,{method:"GET",dataType:"json",params:{deviceId:ir.dev_id,sdkVer:ir.sdk_ver,platform:ir.platform,appkey:ir.app_key},timeout:this.reportConfig.timeout}).then(function(dr){var Dt,lr;if(!Et.isDestroyed){if(dr.status===200&&dr.data&&dr.data.code===200){var sr=dr.data.data||{};Et.reportConfig.maxSize=sr.maxSize>1e3?1e3:sr.maxSize,Et.reportConfig.maxInterval=sr.maxInterval>1e4?1e4:sr.maxInterval,Et.reportConfig.maxInterval=sr.maxInterval<10?10:sr.maxInterval,Et.reportConfig.minInterval=sr.minInterval<2?2:sr.minInterval,Et.reportConfig.maxDelay=sr.maxDelay||300,Et.reportConfig.maxInterval=1e3*Et.reportConfig.maxInterval,Et.reportConfig.minInterval=1e3*Et.reportConfig.minInterval,Et.reportConfig.maxDelay=1e3*Et.reportConfig.maxDelay,Et.isUploadEnable=!0,Et.initConfigLoaded=!0,Et.loading=!1,Et.reportHeartBeat()}(lr=(Dt=Et.reportConfig)===null||Dt===void 0?void 0:Dt.logger)===null||lr===void 0||lr.log("Get reporter upload config success")}}).catch(function(dr){var Dt,lr;Et.loading=!1,(lr=(Dt=Et.reportConfig)===null||Dt===void 0?void 0:Dt.logger)===null||lr===void 0||lr.error("Get reporter upload config failed",dr)})}catch(dr){this.loading=!1,(jt=(Lt=this.reportConfig)===null||Lt===void 0?void 0:Lt.logger)===null||jt===void 0||jt.error("Exec reporter request failed",dr)}}}},{key:"reportHeartBeat",value:function(){var Lt=this;this.isDestroyed||(this.timer=re(function(){Lt.reportHeartBeat()},this.reportConfig.minInterval),this.doReport())}},{key:"doReport",value:function(){if(!this.isDestroyed){var Lt=this.highPriorityMsgList.length+this.msgList.length+this.lowPriorityMsgList.length+this.cacheMsgList.length>2*this.reportConfig.maxSize?this.reportConfig.minInterval:this.reportConfig.maxInterval;k()-this.lastReportTime>=Lt&&this.upload()}}},{key:"getUploadMsg",value:function(){var Lt,jt,Et,ir,dr,Dt,lr=this,sr={},er=k();this.highPriorityMsgList=ie(Lt=this.highPriorityMsgList).call(Lt,function(Ir){return er-Ir.createTime<lr.reportConfig.maxDelay}),this.msgList=ie(jt=this.msgList).call(jt,function(Ir){return er-Ir.createTime<lr.reportConfig.maxDelay}),this.lowPriorityMsgList=ie(Et=this.lowPriorityMsgList).call(Et,function(Ir){return er-Ir.createTime<lr.reportConfig.maxDelay}),this.cacheMsgList=ie(ir=this.cacheMsgList).call(ir,function(Ir){return er-Ir.createTime<lr.reportConfig.maxDelay});var cr=ue(dr=this.highPriorityMsgList).call(dr,0,this.reportConfig.maxSize);if(this.highPriorityMsgList=ue(Dt=this.highPriorityMsgList).call(Dt,cr.length),cr.length<this.reportConfig.maxSize){var or,hr,pr=this.reportConfig.maxSize-cr.length;cr=le(cr).call(cr,ue(or=this.msgList).call(or,0,pr)),this.msgList=ue(hr=this.msgList).call(hr,pr)}if(cr.length<this.reportConfig.maxSize){var Sr,Er,Pr=this.reportConfig.maxSize-cr.length;cr=le(cr).call(cr,ue(Sr=this.lowPriorityMsgList).call(Sr,0,Pr)),this.lowPriorityMsgList=ue(Er=this.lowPriorityMsgList).call(Er,Pr)}if(cr.length<this.reportConfig.maxSize){var Cr,rr,kr=this.reportConfig.maxSize-cr.length;cr=le(cr).call(cr,ue(Cr=this.cacheMsgList).call(Cr,0,kr)),this.cacheMsgList=ue(rr=this.cacheMsgList).call(rr,kr)}return L(cr).call(cr,function(Ir){sr[Ir.module]?sr[Ir.module].push(Ir.msg):sr[Ir.module]=[Ir.msg]}),{uploadMsgArr:cr,uploadMsg:sr}}},{key:"upload",value:function(){var Lt,jt,Et=this;if(this.isUploadEnable&&!(this.lastReportTime&&k()-this.lastReportTime<this.reportConfig.minInterval)){var ir=this.getUploadMsg(),dr=ir.uploadMsgArr,Dt=ir.uploadMsg;if(dr.length){this.lastReportTime=k();try{this.reportConfig.request(this.reportConfig.reportUrl,{dataType:"json",method:"POST",data:{common:this.reportConfig.common,event:Dt},headers:{sdktype:"im"},timeout:this.reportConfig.timeout}).catch(function(lr){var sr,er,cr,or;Et.cacheMsgList=ue(sr=le(er=Et.cacheMsgList).call(er,dr)).call(sr,0,Et.reportConfig.cacheMaxSize),(or=(cr=Et.reportConfig)===null||cr===void 0?void 0:cr.logger)===null||or===void 0||or.warn("Reporter upload failed",lr)})}catch(lr){(jt=(Lt=this.reportConfig)===null||Lt===void 0?void 0:Lt.logger)===null||jt===void 0||jt.warn("Exec reporter request failed",lr)}clearTimeout(this.timer),this.reportHeartBeat()}}}}])&&ae(ze.prototype,$e),i(ze,"prototype",{writable:!1}),Ne}()},oe(r)==="object"&&t!==void 0?t.exports=y():(g=typeof(n=y)=="function"?n.call(r,e,r,t):n)===void 0||(t.exports=g)},function(t,r,e){t.exports=e(692)},function(t,r,e){e(693);var n=e(694);t.exports=n},function(t,r,e){e(293)},function(t,r,e){var n=e(695);t.exports=n},function(t,r,e){var n=e(696);t.exports=n},function(t,r,e){e(293),t.exports=e(14)},function(t,r,e){var n,g,y,i=e(93),k=e(92),$=e(281),L=e(282),V=e(192),z=e(698),re=(e(292),e(2)),ie=e(4),ue=e(6),le=e(3),oe=e(24),ae=e(8),qe=e(279),de=e(22);function Ne(ze){var $e=function(){if(typeof Reflect>"u"||!qe||qe.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(qe(Boolean,[],function(){})),!0}catch{return!1}}();return function(){var Lt,jt=V(ze);if($e){var Et=V(this).constructor;Lt=qe(jt,arguments,Et)}else Lt=jt.apply(this,arguments);return L(this,Lt)}}y=function(){function ze(Lt){if(Lt){var jt,Et="";return re(jt=ie(Lt)).call(jt,function(ir,dr){var Dt;Et+=dr===0?"?":"&",Et+=ue(Dt="".concat(ir,"=")).call(Dt,Lt[ir])}),Et}return""}var $e=function(Lt){$(Et,Lt);var jt=Ne(Et);function Et(ir,dr,Dt,lr){var sr;return k(this,Et),(sr=jt.call(this,Dt)).source=ir,sr.code=dr,sr.desc=Dt,sr.detail=lr||{},sr}return i(Et)}(z(Error));return function(Lt){var jt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{dataType:"json",method:"GET",timeout:5e3},Et=jt.dataType==="text"?"text/plain; charset=UTF-8":"application/json; charset=UTF-8",ir=jt.method==="GET"?ze(jt.params):"";return new le(function(dr,Dt){if(window.XMLHttpRequest){var lr,sr,er=new XMLHttpRequest;if(er.onreadystatechange=function(){if(er.readyState===4)if(er.status===200){try{sr=JSON.parse(er.response||"{}")}catch{sr=er.response}dr({status:er.status,data:sr})}else oe(function(){var or;Dt(new $e(1,er.status,ue(or="readyState: ".concat(er.readyState,"; statusText: ")).call(or,er.statusText)))},0)},er.open(jt.method,ue(lr="".concat(Lt)).call(lr,ir)),er.timeout=jt.timeout||5e3,er.setRequestHeader("Content-Type",Et),jt.headers)for(var cr in jt.headers)er.setRequestHeader(cr,jt.headers[cr]);er.ontimeout=function(or){Dt(new $e(1,408,or&&or.message?or.message:"request timeout"))},er.send(ae(jt.data))}else Dt(new $e(2,10400,"request no suppout"))})}},de(r)==="object"&&t!==void 0?t.exports=y():(g=typeof(n=y)=="function"?n.call(r,e,r,t):n)===void 0||(t.exports=g)},function(t,r,e){var n=e(699),g=e(189),y=e(192),i=e(190),k=e(738),$=e(739);function L(V){var z=typeof n=="function"?new n:void 0;return t.exports=L=function(re){if(re===null||!k(re))return re;if(typeof re!="function")throw new TypeError("Super expression must either be null or a function");if(z!==void 0){if(z.has(re))return z.get(re);z.set(re,ie)}function ie(){return $(re,arguments,y(this).constructor)}return ie.prototype=g(re.prototype,{constructor:{value:ie,enumerable:!1,writable:!0,configurable:!0}}),i(ie,re)},t.exports.__esModule=!0,t.exports.default=t.exports,L(V)}t.exports=L,t.exports.__esModule=!0,t.exports.default=t.exports},function(t,r,e){t.exports=e(700)},function(t,r,e){t.exports=e(701)},function(t,r,e){var n=e(702);e(713),e(715),e(717),e(719),e(720),e(722),e(723),e(724),e(725),e(726),e(728),e(729),e(730),e(731),e(732),e(733),e(734),e(735),e(736),e(737),t.exports=n},function(t,r,e){var n=e(703);t.exports=n},function(t,r,e){var n=e(704);e(69),t.exports=n},function(t,r,e){e(86),e(705),e(100),e(115);var n=e(13);t.exports=n.Map},function(t,r,e){e(706)},function(t,r,e){e(707)("Map",function(n){return function(){return n(this,arguments.length?arguments[0]:void 0)}},e(711))},function(t,r,e){var n=e(1),g=e(14),y=e(294),i=e(5),k=e(61),$=e(47),L=e(171),V=e(17),z=e(28),re=e(85),ie=e(39).f,ue=e(74).forEach,le=e(27),oe=e(101),ae=oe.set,qe=oe.getterFor;t.exports=function(de,Ne,ze){var $e,Lt=de.indexOf("Map")!==-1,jt=de.indexOf("Weak")!==-1,Et=Lt?"set":"add",ir=g[de],dr=ir&&ir.prototype,Dt={};if(le&&V(ir)&&(jt||dr.forEach&&!i(function(){new ir().entries().next()}))){var lr=($e=Ne(function(er,cr){ae(L(er,lr),{type:de,collection:new ir}),cr!=null&&$(cr,er[Et],{that:er,AS_ENTRIES:Lt})})).prototype,sr=qe(de);ue(["add","clear","delete","forEach","get","has","set","keys","values","entries"],function(er){var cr=er=="add"||er=="set";!(er in dr)||jt&&er=="clear"||k(lr,er,function(or,hr){var pr=sr(this).collection;if(!cr&&jt&&!z(or))return er=="get"&&void 0;var Sr=pr[er](or===0?0:or,hr);return cr?this:Sr})}),jt||ie(lr,"size",{configurable:!0,get:function(){return sr(this).collection.size}})}else $e=ze.getConstructor(Ne,de,Lt,Et),y.enable();return re($e,de,!1,!0),Dt[de]=$e,n({global:!0,forced:!0},Dt),jt||ze.setStrong($e,de,Lt),$e}},function(t,r,e){var n=e(5),g=e(28),y=e(65),i=e(709),k=Object.isExtensible,$=n(function(){});t.exports=$||i?function(L){return!!g(L)&&(!i||y(L)!="ArrayBuffer")&&(!k||k(L))}:k},function(t,r,e){var n=e(5);t.exports=n(function(){if(typeof ArrayBuffer=="function"){var g=new ArrayBuffer(8);Object.isExtensible(g)&&Object.defineProperty(g,"a",{value:8})}})},function(t,r,e){var n=e(5);t.exports=!n(function(){return Object.isExtensible(Object.preventExtensions({}))})},function(t,r,e){var n=e(39).f,g=e(84),y=e(712),i=e(34),k=e(171),$=e(96),L=e(47),V=e(169),z=e(170),re=e(238),ie=e(27),ue=e(294).fastKey,le=e(101),oe=le.set,ae=le.getterFor;t.exports={getConstructor:function(qe,de,Ne,ze){var $e=qe(function(dr,Dt){k(dr,Lt),oe(dr,{type:de,index:g(null),first:void 0,last:void 0,size:0}),ie||(dr.size=0),$(Dt)||L(Dt,dr[ze],{that:dr,AS_ENTRIES:Ne})}),Lt=$e.prototype,jt=ae(de),Et=function(dr,Dt,lr){var sr,er,cr=jt(dr),or=ir(dr,Dt);return or?or.value=lr:(cr.last=or={index:er=ue(Dt,!0),key:Dt,value:lr,previous:sr=cr.last,next:void 0,removed:!1},cr.first||(cr.first=or),sr&&(sr.next=or),ie?cr.size++:dr.size++,er!=="F"&&(cr.index[er]=or)),dr},ir=function(dr,Dt){var lr,sr=jt(dr),er=ue(Dt);if(er!=="F")return sr.index[er];for(lr=sr.first;lr;lr=lr.next)if(lr.key==Dt)return lr};return y(Lt,{clear:function(){for(var dr=jt(this),Dt=dr.index,lr=dr.first;lr;)lr.removed=!0,lr.previous&&(lr.previous=lr.previous.next=void 0),delete Dt[lr.index],lr=lr.next;dr.first=dr.last=void 0,ie?dr.size=0:this.size=0},delete:function(dr){var Dt=jt(this),lr=ir(this,dr);if(lr){var sr=lr.next,er=lr.previous;delete Dt.index[lr.index],lr.removed=!0,er&&(er.next=sr),sr&&(sr.previous=er),Dt.first==lr&&(Dt.first=sr),Dt.last==lr&&(Dt.last=er),ie?Dt.size--:this.size--}return!!lr},forEach:function(dr){for(var Dt,lr=jt(this),sr=i(dr,arguments.length>1?arguments[1]:void 0);Dt=Dt?Dt.next:lr.first;)for(sr(Dt.value,Dt.key,this);Dt&&Dt.removed;)Dt=Dt.previous},has:function(dr){return!!ir(this,dr)}}),y(Lt,Ne?{get:function(dr){var Dt=ir(this,dr);return Dt&&Dt.value},set:function(dr,Dt){return Et(this,dr===0?0:dr,Dt)}}:{add:function(dr){return Et(this,dr=dr===0?0:dr,dr)}}),ie&&n(Lt,"size",{get:function(){return jt(this).size}}),$e},setStrong:function(qe,de,Ne){var ze=de+" Iterator",$e=ae(de),Lt=ae(ze);V(qe,de,function(jt,Et){oe(this,{type:ze,target:jt,state:$e(jt),kind:Et,last:void 0})},function(){for(var jt=Lt(this),Et=jt.kind,ir=jt.last;ir&&ir.removed;)ir=ir.previous;return jt.target&&(jt.last=ir=ir?ir.next:jt.state.first)?z(Et=="keys"?ir.key:Et=="values"?ir.value:[ir.key,ir.value],!1):(jt.target=void 0,z(void 0,!0))},Ne?"entries":"values",!Ne,!0),re(de)}}},function(t,r,e){var n=e(68);t.exports=function(g,y,i){for(var k in y)i&&i.unsafe&&g[k]?g[k]=y[k]:n(g,k,y[k],i);return g}},function(t,r,e){e(1)({target:"Map",stat:!0,forced:!0},{from:e(714)})},function(t,r,e){var n=e(34),g=e(20),y=e(31),i=e(172),k=e(96),$=e(47),L=[].push;t.exports=function(V){var z,re,ie,ue,le=arguments.length,oe=le>1?arguments[1]:void 0;return i(this),(z=oe!==void 0)&&y(oe),k(V)?new this:(re=[],z?(ie=0,ue=n(oe,le>2?arguments[2]:void 0),$(V,function(ae){g(L,re,ue(ae,ie++))})):$(V,L,{that:re}),new this(re))}},function(t,r,e){e(1)({target:"Map",stat:!0,forced:!0},{of:e(716)})},function(t,r,e){var n=e(102);t.exports=function(){return new this(n(arguments))}},function(t,r,e){var n=e(1),g=e(38),y=e(63).remove;n({target:"Map",proto:!0,real:!0,forced:!0},{deleteAll:function(){for(var i,k=g(this),$=!0,L=0,V=arguments.length;L<V;L++)i=y(k,arguments[L]),$=$&&i;return!!$}})},function(t,r){t.exports=function(e,n){return n==1?function(g,y){return g[e](y)}:function(g,y,i){return g[e](y,i)}}},function(t,r,e){var n=e(1),g=e(38),y=e(63),i=y.get,k=y.has,$=y.set;n({target:"Map",proto:!0,real:!0,forced:!0},{emplace:function(L,V){var z,re,ie=g(this);return k(ie,L)?(z=i(ie,L),"update"in V&&(z=V.update(z,L,ie),$(ie,L,z)),z):(re=V.insert(L,ie),$(ie,L,re),re)}})},function(t,r,e){var n=e(1),g=e(34),y=e(38),i=e(59);n({target:"Map",proto:!0,real:!0,forced:!0},{every:function(k){var $=y(this),L=g(k,arguments.length>1?arguments[1]:void 0);return i($,function(V,z){if(!L(V,z,$))return!1},!0)!==!1}})},function(t,r,e){var n=e(20);t.exports=function(g,y,i){for(var k,$,L=i||g.next;!(k=n(L,g)).done;)if(($=y(k.value))!==void 0)return $}},function(t,r,e){var n=e(1),g=e(34),y=e(38),i=e(63),k=e(59),$=i.Map,L=i.set;n({target:"Map",proto:!0,real:!0,forced:!0},{filter:function(V){var z=y(this),re=g(V,arguments.length>1?arguments[1]:void 0),ie=new $;return k(z,function(ue,le){re(ue,le,z)&&L(ie,le,ue)}),ie}})},function(t,r,e){var n=e(1),g=e(34),y=e(38),i=e(59);n({target:"Map",proto:!0,real:!0,forced:!0},{find:function(k){var $=y(this),L=g(k,arguments.length>1?arguments[1]:void 0),V=i($,function(z,re){if(L(z,re,$))return{value:z}},!0);return V&&V.value}})},function(t,r,e){var n=e(1),g=e(34),y=e(38),i=e(59);n({target:"Map",proto:!0,real:!0,forced:!0},{findKey:function(k){var $=y(this),L=g(k,arguments.length>1?arguments[1]:void 0),V=i($,function(z,re){if(L(z,re,$))return{key:re}},!0);return V&&V.key}})},function(t,r,e){var n=e(1),g=e(20),y=e(12),i=e(17),k=e(31),$=e(47),L=e(63).Map,V=y([].push);n({target:"Map",stat:!0,forced:!0},{groupBy:function(z,re){var ie=new(i(this)?this:L);k(re);var ue=k(ie.has),le=k(ie.get),oe=k(ie.set);return $(z,function(ae){var qe=re(ae);g(ue,ie,qe)?V(g(le,ie,qe),ae):g(oe,ie,qe,[ae])}),ie}})},function(t,r,e){var n=e(1),g=e(727),y=e(38),i=e(59);n({target:"Map",proto:!0,real:!0,forced:!0},{includes:function(k){return i(y(this),function($){if(g($,k))return!0},!0)===!0}})},function(t,r){t.exports=function(e,n){return e===n||e!=e&&n!=n}},function(t,r,e){var n=e(1),g=e(20),y=e(47),i=e(17),k=e(31),$=e(63).Map;n({target:"Map",stat:!0,forced:!0},{keyBy:function(L,V){var z=new(i(this)?this:$);k(V);var re=k(z.set);return y(L,function(ie){g(re,z,V(ie),ie)}),z}})},function(t,r,e){var n=e(1),g=e(38),y=e(59);n({target:"Map",proto:!0,real:!0,forced:!0},{keyOf:function(i){var k=y(g(this),function($,L){if($===i)return{key:L}},!0);return k&&k.key}})},function(t,r,e){var n=e(1),g=e(34),y=e(38),i=e(63),k=e(59),$=i.Map,L=i.set;n({target:"Map",proto:!0,real:!0,forced:!0},{mapKeys:function(V){var z=y(this),re=g(V,arguments.length>1?arguments[1]:void 0),ie=new $;return k(z,function(ue,le){L(ie,re(ue,le,z),ue)}),ie}})},function(t,r,e){var n=e(1),g=e(34),y=e(38),i=e(63),k=e(59),$=i.Map,L=i.set;n({target:"Map",proto:!0,real:!0,forced:!0},{mapValues:function(V){var z=y(this),re=g(V,arguments.length>1?arguments[1]:void 0),ie=new $;return k(z,function(ue,le){L(ie,le,re(ue,le,z))}),ie}})},function(t,r,e){var n=e(1),g=e(38),y=e(47),i=e(63).set;n({target:"Map",proto:!0,real:!0,arity:1,forced:!0},{merge:function(k){for(var $=g(this),L=arguments.length,V=0;V<L;)y(arguments[V++],function(z,re){i($,z,re)},{AS_ENTRIES:!0});return $}})},function(t,r,e){var n=e(1),g=e(31),y=e(38),i=e(59),k=TypeError;n({target:"Map",proto:!0,real:!0,forced:!0},{reduce:function($){var L=y(this),V=arguments.length<2,z=V?void 0:arguments[1];if(g($),i(L,function(re,ie){V?(V=!1,z=re):z=$(z,re,ie,L)}),V)throw k("Reduce of empty map with no initial value");return z}})},function(t,r,e){var n=e(1),g=e(34),y=e(38),i=e(59);n({target:"Map",proto:!0,real:!0,forced:!0},{some:function(k){var $=y(this),L=g(k,arguments.length>1?arguments[1]:void 0);return i($,function(V,z){if(L(V,z,$))return!0},!0)===!0}})},function(t,r,e){var n=e(1),g=e(31),y=e(38),i=e(63),k=TypeError,$=i.get,L=i.has,V=i.set;n({target:"Map",proto:!0,real:!0,forced:!0},{update:function(z,re){var ie=y(this),ue=arguments.length;g(re);var le=L(ie,z);if(!le&&ue<3)throw k("Updating absent value");var oe=le?$(ie,z):g(ue>2?arguments[2]:void 0)(z,ie);return V(ie,z,re(oe,z,ie)),ie}})},function(t,r,e){e(1)({target:"Map",proto:!0,real:!0,forced:!0},{upsert:e(295)})},function(t,r,e){e(1)({target:"Map",proto:!0,real:!0,name:"upsert",forced:!0},{updateOrInsert:e(295)})},function(t,r,e){var n=e(188);t.exports=function(g){var y;return n(y=Function.toString.call(g)).call(y,"[native code]")!==-1},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,r,e){var n=e(151),g=e(296),y=e(190),i=e(743);function k($,L,V){var z;return i()?(t.exports=k=n(z=g).call(z),t.exports.__esModule=!0,t.exports.default=t.exports):(t.exports=k=function(re,ie,ue){var le=[null];le.push.apply(le,ie);var oe=new(n(Function).apply(re,le));return ue&&y(oe,ue.prototype),oe},t.exports.__esModule=!0,t.exports.default=t.exports),k.apply(null,arguments)}t.exports=k,t.exports.__esModule=!0,t.exports.default=t.exports},function(t,r,e){t.exports=e(741)},function(t,r,e){var n=e(742);t.exports=n},function(t,r,e){var n=e(280);t.exports=n},function(t,r,e){var n=e(296);t.exports=function(){if(typeof Reflect>"u"||!n||n.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(n(Boolean,[],function(){})),!0}catch{return!1}},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,r,e){var n=e(16),g=e(0),y=e(193),i=g.merge({},y.idMap,{auth:{id:2,login:3,kicked:5,logout:6,multiPortLogin:7,kick:8},user:{id:3,updatePushToken:1,appBackground:2,markInBlacklist:3,getBlacklist:4,markInMutelist:5,getMutelist:6,getRelations:8,getUsers:7,updateMyInfo:10,updateDonnop:15,syncMyInfo:109,syncUpdateMyInfo:110},notify:{id:4,markRead:3,syncOfflineMsgs:4,batchMarkRead:5,syncOfflineSysMsgs:6,syncOfflineNetcallMsgs:8,syncRoamingMsgs:9,syncMsgReceipts:12,syncRobots:15,syncBroadcastMsgs:16,syncSuperTeamRoamingMsgs:17,syncOfflineSuperTeamSysMsgs:18,syncDeleteSuperTeamMsgOfflineRoaming:19,syncDeleteMsgSelf:21,syncSessionsWithMoreRoaming:22,syncStickTopSessions:23,syncSessionHistoryMsgsDelete:24,syncSessionReliableInfo:25},sync:{id:5,sync:1,syncTeamMembers:2,syncSuperTeamMembers:3},msg:{id:7,sendMsg:1,msg:2,sysMsg:3,getHistoryMsgs:6,sendCustomSysMsg:7,searchHistoryMsgs:8,deleteSessions:9,getSessions:10,syncSendMsg:101,sendMsgReceipt:11,msgReceipt:12,deleteMsg:13,msgDeleted:14,markSessionAck:16,markSessionAckBatch:25,broadcastMsg:17,clearServerHistoryMsgs:18,getServerSessions:19,getServerSession:20,updateServerSession:21,deleteServerSessions:22,deleteMsgSelf:23,deleteMsgSelfBatch:24,msgFtsInServer:26,msgFtsInServerByTiming:27,onClearServerHistoryMsgs:118,syncUpdateServerSession:121,onDeleteMsgSelf:123,onDeleteMsgSelfBatch:124},msgExtend:{id:23,getThreadMsgs:1,getMsgsByIdServer:2,addQuickComment:3,deleteQuickComment:4,onQuickComment:5,onDeleteQuickComment:6,getQuickComments:7,addCollect:8,deleteCollects:9,updateCollect:10,getCollects:11,addStickTopSession:12,deleteStickTopSession:13,updateStickTopSession:14,addMsgPin:15,updateMsgPin:16,deleteMsgPin:17,onAddMsgPin:18,onUpdateMsgPin:19,onDeleteMsgPin:20,getMsgPins:21,syncAddQuickComment:103,syncDeleteQuickComment:104,syncAddStickTopSession:112,syncDeleteStickTopSession:113,syncUpdateStickTopSession:114,syncAddMsgPin:115,syncUpdateMsgPin:116,syncDeleteMsgPin:117},team:{id:8,createTeam:1,sendTeamMsg:2,teamMsg:3,teamMsgs:4,addTeamMembers:5,removeTeamMembers:6,updateTeam:7,leaveTeam:8,getTeam:9,getTeams:10,getTeamMembers:11,dismissTeam:12,applyTeam:13,passTeamApply:14,rejectTeamApply:15,addTeamManagers:16,removeTeamManagers:17,transferTeam:18,updateInfoInTeam:19,updateNickInTeam:20,acceptTeamInvite:21,rejectTeamInvite:22,getTeamHistoryMsgs:23,searchTeamHistoryMsgs:24,updateMuteStateInTeam:25,getMyTeamMembers:26,getMutedTeamMembers:27,sendTeamMsgReceipt:28,getTeamMsgReads:29,getTeamMsgReadAccounts:30,notifyTeamMsgReads:31,muteTeamAll:32,getTeamMemberInvitorAccid:33,getTeamsById:34,syncMyTeamMembers:126,syncTeams:109,syncTeamMembers:111,syncCreateTeam:101,syncSendTeamMsg:102,syncUpdateTeamMember:119},superTeam:{id:21,sendSuperTeamMsg:2,superTeamMsg:3,addSuperTeamMembers:5,removeSuperTeamMembers:6,leaveSuperTeam:7,updateSuperTeam:8,getSuperTeam:9,getSuperTeams:12,updateInfoInSuperTeam:10,getMySuperTeamMembers:11,getSuperTeamMembers:13,getSuperTeamHistoryMsgs:14,getSuperTeamMembersByJoinTime:15,sendSuperTeamCustomSysMsg:16,deleteSuperTeamMsg:17,superTeamMsgDelete:18,superTeamCustomSysMsg:19,applySuperTeam:20,passSuperTeamApply:21,rejectSuperTeamApply:22,acceptSuperTeamInvite:23,rejectSuperTeamInvite:24,markSuperTeamSessionAck:25,addSuperTeamManagers:26,removeSuperTeamManagers:27,updateSuperTeamMute:28,updateSuperTeamMembersMute:29,updateNickInSuperTeam:30,transferSuperTeam:31,markSuperTeamSessionsAck:32,getSuperTeamMembersByAccounts:33,getMutedSuperTeamMembers:34,syncMySuperTeamMembers:111,syncSuperTeams:109,syncSuperTeamMembers:113,syncCreateSuperTeam:101,syncSendSuperTeamMsg:102,syncUpdateSuperTeamMember:110,syncDeleteSuperTeamMsg:117},friend:{id:12,friendRequest:1,syncFriendRequest:101,deleteFriend:2,syncDeleteFriend:102,updateFriend:3,syncUpdateFriend:103,getFriends:4},chatroom:{id:13,getChatroomAddress:1},filter:{id:101,sendFilterMsg:1,filterMsg:2,filterSysMsg:3,sendFilterCustomSysMsg:7},eventService:{id:14,publishEvent:1,pushEvent:2,subscribeEvent:3,unSubscribeEventsByAccounts:4,unSubscribeEventsByType:5,querySubscribeEventsByAccounts:6,querySubscribeEventsByType:7,pushEvents:9},proxyService:{id:22,httpProxy:1,onProxyMsg:2},qchat:{id:24,getQChatAddress:1}}),k=g.merge({},y.cmdConfig,{login:{sid:i.auth.id,cid:i.auth.login,params:[{type:"Property",name:"login"}]},logout:{sid:i.auth.id,cid:i.auth.logout},kick:{sid:i.auth.id,cid:i.auth.kick,params:[{type:"StrArray",name:"deviceIds"}]},updatePushToken:{sid:i.user.id,cid:i.user.updatePushToken,params:[{type:"String",name:"tokenName"},{type:"String",name:"token"},{type:"int",name:"pushkit"}]},appBackground:{sid:i.user.id,cid:i.user.appBackground,params:[{type:"bool",name:"isBackground"},{type:"Int",name:"badge"}]},markInBlacklist:{sid:i.user.id,cid:i.user.markInBlacklist,params:[{type:"String",name:"account"},{type:"bool",name:"isAdd"}]},getBlacklist:{sid:i.user.id,cid:i.user.getBlacklist,params:[{type:"long",name:"time"}]},markInMutelist:{sid:i.user.id,cid:i.user.markInMutelist,params:[{type:"String",name:"account"},{type:"bool",name:"isAdd"}]},getMutelist:{sid:i.user.id,cid:i.user.getMutelist,params:[{type:"long",name:"time"}]},getRelations:{sid:i.user.id,cid:i.user.getRelations,params:[{type:"long",name:"timetag"}]},getUsers:{sid:i.user.id,cid:i.user.getUsers,params:[{type:"StrArray",name:"accounts"}]},updateMyInfo:{sid:i.user.id,cid:i.user.updateMyInfo,params:[{type:"Property",name:"user"},{type:"Property",name:"antispamTag"}]},updateDonnop:{sid:i.user.id,cid:i.user.updateDonnop,params:[{type:"Property",name:"donnop"}]},markRead:{sid:i.notify.id,cid:i.notify.markRead,params:[{type:"long",name:"id"},{type:"ph",name:"ph"}]},batchMarkRead:{sid:i.notify.id,cid:i.notify.batchMarkRead,params:[{type:"byte",name:"sid"},{type:"byte",name:"cid"},{type:"LongArray",name:"ids"}]},sync:{sid:i.sync.id,cid:i.sync.sync,isAwaitable:!1,params:[{type:"Property",name:"sync"}]},syncTeamMembers:{sid:i.sync.id,cid:i.sync.syncTeamMembers,params:[{type:"LongLongMap",name:"sync"}]},syncSuperTeamMembers:{sid:i.sync.id,cid:i.sync.syncSuperTeamMembers,params:[{type:"LongLongMap",name:"sync"}]},sendMsg:{sid:i.msg.id,cid:i.msg.sendMsg,params:[{type:"Property",name:"msg"}]},getHistoryMsgs:{sid:i.msg.id,cid:i.msg.getHistoryMsgs,params:[{type:"String",name:"to"},{type:"long",name:"beginTime"},{type:"long",name:"endTime"},{type:"long",name:"lastMsgId"},{type:"int",name:"limit"},{type:"bool",name:"reverse"},{type:"LongArray",name:"msgTypes"}]},sendCustomSysMsg:{sid:i.msg.id,cid:i.msg.sendCustomSysMsg,params:[{type:"Property",name:"sysMsg"}]},searchHistoryMsgs:{sid:i.msg.id,cid:i.msg.searchHistoryMsgs,params:[{type:"String",name:"to"},{type:"long",name:"beginTime"},{type:"long",name:"endTime"},{type:"String",name:"keyword"},{type:"int",name:"limit"},{type:"bool",name:"reverse"}]},getSessions:{sid:i.msg.id,cid:i.msg.getSessions,params:[{type:"long",name:"time"}]},deleteSessions:{sid:i.msg.id,cid:i.msg.deleteSessions,params:[{type:"StrArray",name:"sessions"}]},sendMsgReceipt:{sid:i.msg.id,cid:i.msg.sendMsgReceipt,params:[{type:"Property",name:"msgReceipt"}]},deleteMsg:{sid:i.msg.id,cid:i.msg.deleteMsg,params:[{type:"Property",name:"sysMsg"}]},markSessionAck:{sid:i.msg.id,cid:i.msg.markSessionAck,params:[{type:"byte",name:"scene"},{type:"String",name:"to"},{type:"long",name:"timetag"}]},markSessionAckBatch:{sid:i.msg.id,cid:i.msg.markSessionAckBatch,params:[{type:"PropertyArray",name:"sessionAckTags",entity:"sessionAckTag"}]},clearServerHistoryMsgs:{sid:i.msg.id,cid:i.msg.clearServerHistoryMsgs,params:[{type:"Property",name:"clearMsgsParams"}]},clearServerHistoryMsgsWithSync:{sid:i.msg.id,cid:i.msg.clearServerHistoryMsgs,params:[{type:"Property",name:"clearMsgsParamsWithSync"}]},msgFtsInServer:{sid:i.msg.id,cid:i.msg.msgFtsInServer,params:[{type:"Property",name:"msgFullSearchRequestTag"}]},msgFtsInServerByTiming:{sid:i.msg.id,cid:i.msg.msgFtsInServerByTiming,params:[{type:"Property",name:"msgTimingFullSearchRequestTag"}]},onClearServerHistoryMsgs:{sid:i.msg.id,cid:i.msg.clearServerHistoryMsgs},getServerSessions:{sid:i.msg.id,cid:i.msg.getServerSessions,params:[{type:"Property",name:"sessionReqTag"}]},getServerSession:{sid:i.msg.id,cid:i.msg.getServerSession,params:[{type:"Property",name:"session"}]},updateServerSession:{sid:i.msg.id,cid:i.msg.updateServerSession,params:[{type:"Property",name:"session"}]},deleteServerSessions:{sid:i.msg.id,cid:i.msg.deleteServerSessions,params:[{type:"PropertyArray",name:"sessions",entity:"session"}]},deleteMsgSelf:{sid:i.msg.id,cid:i.msg.deleteMsgSelf,params:[{type:"Property",name:"deleteMsgSelfTag"}]},deleteMsgSelfBatch:{sid:i.msg.id,cid:i.msg.deleteMsgSelfBatch,params:[{type:"PropertyArray",name:"deleteMsgSelfTags",entity:"deleteMsgSelfTag"}]},onDeleteMsgSelf:{sid:i.msg.id,cid:i.msg.onDeleteMsgSelf},onDeleteMsgSelfBatch:{sid:i.msg.id,cid:i.msg.onDeleteMsgSelfBatch},sendSuperTeamMsg:{sid:i.superTeam.id,cid:i.superTeam.sendSuperTeamMsg,params:[{type:"Property",name:"msg"}]},addSuperTeamMembers:{sid:i.superTeam.id,cid:i.superTeam.addSuperTeamMembers,params:[{type:"long",name:"teamId"},{type:"StrArray",name:"accounts"},{type:"String",name:"ps"}]},removeSuperTeamMembers:{sid:i.superTeam.id,cid:i.superTeam.removeSuperTeamMembers,params:[{type:"long",name:"teamId"},{type:"StrArray",name:"accounts"}]},leaveSuperTeam:{sid:i.superTeam.id,cid:i.superTeam.leaveSuperTeam,params:[{type:"long",name:"teamId"}]},updateSuperTeam:{sid:i.superTeam.id,cid:i.superTeam.updateSuperTeam,params:[{type:"Property",name:"team"},{type:"Property",name:"antispamTag"}]},getSuperTeam:{sid:i.superTeam.id,cid:i.superTeam.getSuperTeam,params:[{type:"long",name:"teamId"}]},getSuperTeams:{sid:i.superTeam.id,cid:i.superTeam.getSuperTeams,params:[{type:"long",name:"timetag"}]},getSuperTeamMembers:{sid:i.superTeam.id,cid:i.superTeam.getSuperTeamMembers,params:[{type:"long",name:"teamId"},{type:"long",name:"timetag"}]},updateInfoInSuperTeam:{sid:i.superTeam.id,cid:i.superTeam.updateInfoInSuperTeam,params:[{type:"Property",name:"superTeamMember"},{type:"Property",name:"teamSpecialFollowUpdateTag"}]},getSuperTeamHistoryMsgs:{sid:i.superTeam.id,cid:i.superTeam.getSuperTeamHistoryMsgs,params:[{type:"long",name:"to"},{type:"long",name:"beginTime"},{type:"long",name:"endTime"},{type:"long",name:"lastMsgId"},{type:"int",name:"limit"},{type:"bool",name:"reverse"},{type:"LongArray",name:"msgTypes"}]},applySuperTeam:{sid:i.superTeam.id,cid:i.superTeam.applySuperTeam,params:[{type:"long",name:"teamId"},{type:"String",name:"ps"}]},passSuperTeamApply:{sid:i.superTeam.id,cid:i.superTeam.passSuperTeamApply,params:[{type:"long",name:"teamId"},{type:"String",name:"from"}]},rejectSuperTeamApply:{sid:i.superTeam.id,cid:i.superTeam.rejectSuperTeamApply,params:[{type:"long",name:"teamId"},{type:"String",name:"from"},{type:"String",name:"ps"}]},acceptSuperTeamInvite:{sid:i.superTeam.id,cid:i.superTeam.acceptSuperTeamInvite,params:[{type:"long",name:"teamId"},{type:"String",name:"from"}]},rejectSuperTeamInvite:{sid:i.superTeam.id,cid:i.superTeam.rejectSuperTeamInvite,params:[{type:"long",name:"teamId"},{type:"String",name:"from"},{type:"String",name:"ps"}]},markSuperTeamSessionAck:{sid:i.superTeam.id,cid:i.superTeam.markSuperTeamSessionAck,params:[{type:"long",name:"to"},{type:"long",name:"timetag"}]},addSuperTeamManagers:{sid:i.superTeam.id,cid:i.superTeam.addSuperTeamManagers,params:[{type:"long",name:"teamId"},{type:"StrArray",name:"accounts"}]},removeSuperTeamManagers:{sid:i.superTeam.id,cid:i.superTeam.removeSuperTeamManagers,params:[{type:"long",name:"teamId"},{type:"StrArray",name:"accounts"}]},updateSuperTeamMute:{sid:i.superTeam.id,cid:i.superTeam.updateSuperTeamMute,params:[{type:"long",name:"teamId"},{type:"int",name:"mute"}]},updateSuperTeamMembersMute:{sid:i.superTeam.id,cid:i.superTeam.updateSuperTeamMembersMute,params:[{type:"long",name:"teamId"},{type:"StrArray",name:"accounts"},{type:"int",name:"mute"}]},updateNickInSuperTeam:{sid:i.superTeam.id,cid:i.superTeam.updateNickInSuperTeam,params:[{type:"Property",name:"superTeamMember"}]},transferSuperTeam:{sid:i.superTeam.id,cid:i.superTeam.transferSuperTeam,params:[{type:"long",name:"teamId"},{type:"String",name:"account"},{type:"bool",name:"leave"}]},markSuperTeamSessionsAck:{sid:i.superTeam.id,cid:i.superTeam.markSuperTeamSessionsAck,params:[{type:"PropertyArray",name:"sessionAckTags",entity:"sessionAckTag"}]},getSuperTeamMembersByJoinTime:{sid:i.superTeam.id,cid:i.superTeam.getSuperTeamMembersByJoinTime,params:[{type:"long",name:"teamId"},{type:"long",name:"joinTime"},{type:"int",name:"limit"},{type:"bool",name:"reverse"}]},getSuperTeamMembersByAccounts:{sid:i.superTeam.id,cid:i.superTeam.getSuperTeamMembersByAccounts,params:[{type:"StrArray",name:"memberIds"}]},getMutedSuperTeamMembers:{sid:i.superTeam.id,cid:i.superTeam.getMutedSuperTeamMembers,params:[{type:"long",name:"teamId"},{type:"long",name:"joinTime"},{type:"int",name:"limit"},{type:"bool",name:"reverse"}]},sendSuperTeamCustomSysMsg:{sid:i.superTeam.id,cid:i.superTeam.sendSuperTeamCustomSysMsg,params:[{type:"Property",name:"sysMsg"}]},deleteSuperTeamMsg:{sid:i.superTeam.id,cid:i.superTeam.deleteSuperTeamMsg,params:[{type:"Property",name:"sysMsg"}]},getMySuperTeamMembers:{sid:i.superTeam.id,cid:i.superTeam.getMySuperTeamMembers,params:[{type:"LongArray",name:"teamIds"}]},createTeam:{sid:i.team.id,cid:i.team.createTeam,params:[{type:"Property",name:"team"},{type:"StrArray",name:"accounts"},{type:"String",name:"ps"},{type:"Property",name:"antispamTag"}]},sendTeamMsg:{sid:i.team.id,cid:i.team.sendTeamMsg,params:[{type:"Property",name:"msg"}]},addTeamMembers:{sid:i.team.id,cid:i.team.addTeamMembers,params:[{type:"long",name:"teamId"},{type:"StrArray",name:"accounts"},{type:"String",name:"ps"},{type:"String",name:"attach"}]},removeTeamMembers:{sid:i.team.id,cid:i.team.removeTeamMembers,params:[{type:"long",name:"teamId"},{type:"StrArray",name:"accounts"}]},updateTeam:{sid:i.team.id,cid:i.team.updateTeam,params:[{type:"Property",name:"team"},{type:"Property",name:"antispamTag"}]},leaveTeam:{sid:i.team.id,cid:i.team.leaveTeam,params:[{type:"long",name:"teamId"}]},getTeam:{sid:i.team.id,cid:i.team.getTeam,params:[{type:"long",name:"teamId"}]},getTeams:{sid:i.team.id,cid:i.team.getTeams,params:[{type:"long",name:"timetag"}]},getTeamsById:{sid:i.team.id,cid:i.team.getTeamsById,params:[{type:"longArray",name:"teamIds"}]},getTeamMembers:{sid:i.team.id,cid:i.team.getTeamMembers,params:[{type:"long",name:"teamId"},{type:"long",name:"timetag"}]},dismissTeam:{sid:i.team.id,cid:i.team.dismissTeam,params:[{type:"long",name:"teamId"}]},applyTeam:{sid:i.team.id,cid:i.team.applyTeam,params:[{type:"long",name:"teamId"},{type:"String",name:"ps"}]},passTeamApply:{sid:i.team.id,cid:i.team.passTeamApply,params:[{type:"long",name:"teamId"},{type:"String",name:"from"}]},rejectTeamApply:{sid:i.team.id,cid:i.team.rejectTeamApply,params:[{type:"long",name:"teamId"},{type:"String",name:"from"},{type:"String",name:"ps"}]},addTeamManagers:{sid:i.team.id,cid:i.team.addTeamManagers,params:[{type:"long",name:"teamId"},{type:"StrArray",name:"accounts"}]},removeTeamManagers:{sid:i.team.id,cid:i.team.removeTeamManagers,params:[{type:"long",name:"teamId"},{type:"StrArray",name:"accounts"}]},transferTeam:{sid:i.team.id,cid:i.team.transferTeam,params:[{type:"long",name:"teamId"},{type:"String",name:"account"},{type:"bool",name:"leave"}]},updateInfoInTeam:{sid:i.team.id,cid:i.team.updateInfoInTeam,params:[{type:"Property",name:"teamMember"},{type:"Property",name:"teamSpecialFollowUpdateTag"}]},updateNickInTeam:{sid:i.team.id,cid:i.team.updateNickInTeam,params:[{type:"Property",name:"teamMember"}]},acceptTeamInvite:{sid:i.team.id,cid:i.team.acceptTeamInvite,params:[{type:"long",name:"teamId"},{type:"String",name:"from"}]},rejectTeamInvite:{sid:i.team.id,cid:i.team.rejectTeamInvite,params:[{type:"long",name:"teamId"},{type:"String",name:"from"},{type:"String",name:"ps"}]},getTeamHistoryMsgs:{sid:i.team.id,cid:i.team.getTeamHistoryMsgs,params:[{type:"long",name:"to"},{type:"long",name:"beginTime"},{type:"long",name:"endTime"},{type:"long",name:"lastMsgId"},{type:"int",name:"limit"},{type:"bool",name:"reverse"},{type:"LongArray",name:"msgTypes"}]},searchTeamHistoryMsgs:{sid:i.team.id,cid:i.team.searchTeamHistoryMsgs,params:[{type:"long",name:"to"},{type:"long",name:"beginTime"},{type:"long",name:"endTime"},{type:"String",name:"keyword"},{type:"int",name:"limit"},{type:"bool",name:"reverse"}]},updateMuteStateInTeam:{sid:i.team.id,cid:i.team.updateMuteStateInTeam,params:[{type:"long",name:"teamId"},{type:"String",name:"account"},{type:"int",name:"mute"}]},getMyTeamMembers:{sid:i.team.id,cid:i.team.getMyTeamMembers,params:[{type:"LongArray",name:"teamIds"}]},getMutedTeamMembers:{sid:i.team.id,cid:i.team.getMutedTeamMembers,params:[{type:"long",name:"teamId"}]},sendTeamMsgReceipt:{sid:i.team.id,cid:i.team.sendTeamMsgReceipt,params:[{type:"PropertyArray",name:"teamMsgReceipts",entity:"teamMsgReceipt"}]},getTeamMsgReads:{sid:i.team.id,cid:i.team.getTeamMsgReads,params:[{type:"PropertyArray",name:"teamMsgReceipts",entity:"teamMsgReceipt"}]},getTeamMsgReadAccounts:{sid:i.team.id,cid:i.team.getTeamMsgReadAccounts,params:[{type:"Property",name:"teamMsgReceipt"}]},muteTeamAll:{sid:i.team.id,cid:i.team.muteTeamAll,params:[{type:"long",name:"teamId"},{type:"int",name:"mute"}]},getTeamMemberInvitorAccid:{sid:i.team.id,cid:i.team.getTeamMemberInvitorAccid,params:[{type:"long",name:"teamId"},{type:"StrArray",name:"accounts"}]},friendRequest:{sid:i.friend.id,cid:i.friend.friendRequest,params:[{type:"String",name:"account"},{type:"byte",name:"type"},{type:"String",name:"ps"}]},deleteFriend:{sid:i.friend.id,cid:i.friend.deleteFriend,params:[{type:"String",name:"account"},{type:"Property",name:"delFriendParams"}]},updateFriend:{sid:i.friend.id,cid:i.friend.updateFriend,params:[{type:"Property",name:"friend"}]},getFriends:{sid:i.friend.id,cid:i.friend.getFriends,params:[{type:"long",name:"timetag"}]},getChatroomAddress:{sid:i.chatroom.id,cid:i.chatroom.getChatroomAddress,params:[{type:"long",name:"chatroomId"},{type:"bool",name:"isWeixinApp"},{type:"number",name:"type"}]},sendFilterMsg:{sid:n(i).id,cid:n(i).sendFilterMsg,params:[{type:"Property",name:"msg"}]},sendFilterCustomSysMsg:{sid:n(i).id,cid:n(i).sendFilterCustomSysMsg,params:[{type:"Property",name:"sysMsg"}]},publishEvent:{sid:i.eventService.id,cid:i.eventService.publishEvent,params:[{type:"Property",name:"msgEvent"}]},pushEvent:{sid:i.eventService.id,cid:i.eventService.pushEvent},subscribeEvent:{sid:i.eventService.id,cid:i.eventService.subscribeEvent,params:[{type:"Property",name:"msgEventSubscribe"},{type:"StrArray",name:"accounts"}]},unSubscribeEventsByAccounts:{sid:i.eventService.id,cid:i.eventService.unSubscribeEventsByAccounts,params:[{type:"Property",name:"msgEventSubscribe"},{type:"StrArray",name:"accounts"}]},unSubscribeEventsByType:{sid:i.eventService.id,cid:i.eventService.unSubscribeEventsByType,params:[{type:"Property",name:"msgEventSubscribe"}]},querySubscribeEventsByAccounts:{sid:i.eventService.id,cid:i.eventService.querySubscribeEventsByAccounts,params:[{type:"Property",name:"msgEventSubscribe"},{type:"StrArray",name:"accounts"}]},querySubscribeEventsByType:{sid:i.eventService.id,cid:i.eventService.querySubscribeEventsByType,params:[{type:"Property",name:"msgEventSubscribe"}]},pushEvents:{sid:i.eventService.id,cid:i.eventService.pushEvents},getThreadMsgs:{sid:i.msgExtend.id,cid:i.msgExtend.getThreadMsgs,params:[{type:"Property",name:"msg"},{type:"Property",name:"threadMsgReq"}]},getMsgsByIdServer:{sid:i.msgExtend.id,cid:i.msgExtend.getMsgsByIdServer,params:[{type:"PropertyArray",name:"reqMsgs",entity:"msg"}]},addQuickComment:{sid:i.msgExtend.id,cid:i.msgExtend.addQuickComment,params:[{type:"Property",name:"msg"},{type:"Property",name:"comment"}]},deleteQuickComment:{sid:i.msgExtend.id,cid:i.msgExtend.deleteQuickComment,params:[{type:"Property",name:"msg"},{type:"Property",name:"comment"}]},getQuickComments:{sid:i.msgExtend.id,cid:i.msgExtend.getQuickComments,params:[{type:"PropertyArray",name:"commentReq",entity:"commentReq"}]},addCollect:{sid:i.msgExtend.id,cid:i.msgExtend.addCollect,params:[{type:"Property",name:"collect"}]},deleteCollects:{sid:i.msgExtend.id,cid:i.msgExtend.deleteCollects,params:[{type:"PropertyArray",name:"collectList",entity:"collect"}]},updateCollect:{sid:i.msgExtend.id,cid:i.msgExtend.updateCollect,params:[{type:"Property",name:"collect"}]},getCollects:{sid:i.msgExtend.id,cid:i.msgExtend.getCollects,params:[{type:"Property",name:"collectQuery"}]},addStickTopSession:{sid:i.msgExtend.id,cid:i.msgExtend.addStickTopSession,params:[{type:"Property",name:"stickTopSession"}]},updateStickTopSession:{sid:i.msgExtend.id,cid:i.msgExtend.updateStickTopSession,params:[{type:"Property",name:"stickTopSession"}]},deleteStickTopSession:{sid:i.msgExtend.id,cid:i.msgExtend.deleteStickTopSession,params:[{type:"Property",name:"stickTopSession"}]},addMsgPin:{sid:i.msgExtend.id,cid:i.msgExtend.addMsgPin,params:[{type:"Property",name:"msg"},{type:"Property",name:"pinTag"}]},updateMsgPin:{sid:i.msgExtend.id,cid:i.msgExtend.updateMsgPin,params:[{type:"Property",name:"msg"},{type:"Property",name:"pinTag"}]},deleteMsgPin:{sid:i.msgExtend.id,cid:i.msgExtend.deleteMsgPin,params:[{type:"Property",name:"msg"},{type:"Property",name:"pinTag"}]},getMsgPins:{sid:i.msgExtend.id,cid:i.msgExtend.getMsgPins,params:[{type:"Property",name:"msgPinReq"}]},httpProxy:{sid:i.proxyService.id,cid:i.proxyService.httpProxy,params:[{type:"Property",name:"proxyTag"}]},getQChatAddress:{sid:i.qchat.id,cid:i.qchat.getQChatAddress,params:[{type:"Property",name:"getQChatAddressTag"}]}}),$=g.merge({},y.packetConfig,{"2_3":{service:"auth",cmd:"login",response:[{type:"Property",name:"loginRes"},{type:"PropertyArray",name:"loginPorts",entity:"loginPort"},{type:"Property",name:"aosPushInfo"}]},"2_5":{service:"auth",cmd:"kicked",response:[{type:"Number",name:"from"},{type:"Number",name:"reason"},{type:"String",name:"custom"},{type:"Number",name:"customClientType"}]},"2_6":{service:"auth",cmd:"logout"},"2_7":{service:"auth",cmd:"multiPortLogin",response:[{type:"Number",name:"state"},{type:"PropertyArray",name:"loginPorts",entity:"loginPort"}]},"2_8":{service:"auth",cmd:"kick",response:[{type:"StrArray",name:"deviceIds"}]},"3_1":{service:"user",cmd:"updatePushToken"},"3_2":{service:"user",cmd:"appBackground"},"3_3":{service:"user",cmd:"markInBlacklist"},"3_103":{service:"user",cmd:"syncMarkInBlacklist",response:[{type:"String",name:"account"},{type:"Boolean",name:"isAdd"}]},"3_4":{service:"user",cmd:"getBlacklist",response:[{type:"StrArray",name:"blacklist"}]},"3_5":{service:"user",cmd:"markInMutelist"},"3_105":{service:"user",cmd:"syncMarkInMutelist",response:[{type:"String",name:"account"},{type:"Boolean",name:"isAdd"}]},"3_6":{service:"user",cmd:"getMutelist",response:[{type:"StrArray",name:"mutelist"}]},"3_8":{service:"user",cmd:"getRelations",response:[{type:"PropertyArray",name:"specialRelations",entity:"specialRelation"},{type:"Number",name:"timetag"}]},"3_7":{service:"user",cmd:"getUsers",response:[{type:"PropertyArray",name:"users",entity:"user"}]},"3_10":{service:"user",cmd:"updateMyInfo",response:[{type:"Number",name:"timetag"}]},"3_15":{service:"user",cmd:"updateDonnop",response:[{type:"Number",name:"timetag"}]},"3_115":{service:"user",cmd:"syncUpdateDonnop",response:[{type:"Property",name:"donnop"},{type:"Number",name:"timetag"}]},"3_109":{service:"user",cmd:"syncMyInfo",response:[{type:"Property",name:"user"},{type:"Number",name:"timetag"}]},"3_110":{service:"user",cmd:"syncUpdateMyInfo",response:[{type:"Property",name:"user"}]},"4_1":{service:"notify"},"4_2":{service:"notify"},"4_3":{service:"notify",cmd:"markRead"},"4_4":{service:"notify",cmd:"syncOfflineMsgs",response:[{type:"PropertyArray",name:"msgs",entity:"msg"}]},"4_5":{service:"notify",cmd:"batchMarkRead"},"4_6":{service:"notify",cmd:"syncOfflineSysMsgs",response:[{type:"PropertyArray",name:"sysMsgs",entity:"sysMsg"}]},"4_8":{service:"notify",cmd:"syncOfflineNetcallMsgs",response:[{type:"PropertyArray",name:"msgs",entity:"msg"}]},"4_9":{service:"notify",cmd:"syncRoamingMsgs",response:[{type:"PropertyArray",name:"msgs",entity:"msg"}]},"4_12":{service:"notify",cmd:"syncMsgReceipts",response:[{type:"PropertyArray",name:"msgReceipts",entity:"msgReceipt"},{type:"Number",name:"timetag"}]},"4_13":{service:"notify",cmd:"syncDonnop",response:[{type:"Property",name:"donnop"},{type:"Number",name:"timetag"}]},"4_14":{service:"notify",cmd:"syncSessionAck",response:[{type:"StrLongMap",name:"p2p"},{type:"LongLongMap",name:"team"},{type:"Number",name:"timetag"}]},"4_15":{service:"notify",cmd:"syncRobots",response:[{type:"PropertyArray",name:"robots",entity:"robot"}]},"4_16":{service:"notify",cmd:"syncBroadcastMsgs",response:[{type:"PropertyArray",name:"broadcastMsgs",entity:"broadcastMsg"}]},"4_17":{service:"notify",cmd:"syncSuperTeamRoamingMsgs",response:[{type:"PropertyArray",name:"msgs",entity:"msg"}]},"4_18":{service:"notify",cmd:"syncOfflineSuperTeamSysMsgs",response:[{type:"PropertyArray",name:"sysMsgs",entity:"sysMsg"}]},"4_19":{service:"notify",cmd:"syncDeleteSuperTeamMsgOfflineRoaming",response:[{type:"PropertyArray",name:"sysMsgs",entity:"sysMsg"},{type:"Number",name:"timetag"},{type:"Number",name:"type"}]},"4_20":{service:"notify",cmd:"syncSuperTeamSessionAck",response:[{type:"LongLongMap",name:"superTeam"},{type:"Number",name:"timetag"}]},"4_21":{service:"notify",cmd:"syncDeleteMsgSelf",response:[{type:"PropertyArray",name:"deletedMsgs",entity:"deleteMsgSelfTag"}]},"4_22":{service:"notify",cmd:"syncSessionsWithMoreRoaming",response:[{type:"PropertyArray",name:"sessions",entity:"msg"}]},"4_23":{service:"notify",cmd:"syncStickTopSessions",response:[{type:"Number",name:"timetag"},{type:"boolean",name:"modify"},{type:"PropertyArray",name:"sessions",entity:"stickTopSession"}]},"4_24":{service:"notify",cmd:"syncSessionHistoryMsgsDelete",response:[{type:"PropertyArray",name:"sessionHistoryMsgsDeleteTags",entity:"clearMsgsParamsWithSync"}]},"4_25":{service:"notify",cmd:"syncSessionReliableInfo",response:[{type:"Property",name:"context",entity:"sessionReliableSyncContextTag"},{type:"PropertyArray",name:"datas",entity:"sessionReliableSyncTag"}]},"4_100":{service:"notify",cmd:"syncOfflineFilterMsgs",response:[{type:"PropertyArray",name:"msgs",entity:"msg"}]},"4_101":{service:"notify",cmd:"syncOfflineFilterSysMsgs",response:[{type:"PropertyArray",name:"sysMsgs",entity:"sysMsg"}]},"5_1":{service:"sync",cmd:"syncDone",response:[{type:"Number",name:"timetag"}]},"5_2":{service:"sync",cmd:"syncTeamMembersDone",response:[{type:"Number",name:"timetag"}]},"5_3":{service:"sync",cmd:"syncSuperTeamMembersDone",response:[{type:"Number",name:"timetag"}]},"7_1":{service:"msg",cmd:"sendMsg",response:[{type:"Property",name:"msg"}],trivialErrorCodes:[7101]},"7_2":{service:"msg",cmd:"msg",response:[{type:"Property",name:"msg"}]},"7_3":{service:"msg",cmd:"sysMsg",response:[{type:"Property",name:"sysMsg"}]},"7_6":{service:"msg",cmd:"getHistoryMsgs",response:[{type:"PropertyArray",name:"msgs",entity:"msg"}]},"7_7":{service:"msg",cmd:"sendCustomSysMsg",trivialErrorCodes:[7101]},"7_8":{service:"msg",cmd:"searchHistoryMsgs",response:[{type:"PropertyArray",name:"msgs",entity:"msg"}]},"7_9":{service:"msg",cmd:"deleteSessions"},"7_10":{service:"msg",cmd:"getSessions",response:[{type:"StrArray",name:"sessions"}]},"7_101":{service:"msg",cmd:"syncSendMsg",response:[{type:"Property",name:"msg"}]},"7_11":{service:"msg",cmd:"sendMsgReceipt",response:[{type:"Property",name:"msgReceipt"}]},"7_12":{service:"msg",cmd:"msgReceipt",response:[{type:"Property",name:"msgReceipt"}]},"7_13":{service:"msg",cmd:"onDeleteMsg"},"7_14":{service:"msg",cmd:"onMsgDeleted",response:[{type:"Property",name:"sysMsg"}]},"7_15":{service:"msg",cmd:"onDeleteMsgOfflineRoaming",response:[{type:"PropertyArray",name:"sysMsgs",entity:"sysMsg"},{type:"Number",name:"timetag"},{type:"Number",name:"type"}]},"7_16":{service:"msg",cmd:"onMarkSessionAck"},"7_17":{service:"msg",cmd:"broadcastMsg",response:[{type:"Property",name:"broadcastMsg"}]},"7_18":{service:"msg",cmd:"clearServerHistoryMsgs",response:[{type:"Long",name:"timetag"}]},"7_19":{service:"session",cmd:"getServerSessions",response:[{type:"Property",name:"sessionReqTag"},{type:"PropertyArray",name:"sessionList",entity:"session"}]},"7_20":{service:"session",cmd:"getServerSession",response:[{type:"Property",name:"session"}]},"7_21":{service:"session",cmd:"updateServerSession"},"7_22":{service:"session",cmd:"deleteServerSessions"},"7_23":{service:"msg",cmd:"deleteMsgSelf",response:[{type:"Long",name:"timetag"}]},"7_24":{service:"msg",cmd:"deleteMsgSelfBatch",response:[{type:"Long",name:"timetag"}]},"7_25":{service:"msg",cmd:"onMarkSessionAckBatch"},"7_26":{service:"msg",cmd:"msgFtsInServer",response:[{type:"PropertyArray",name:"msgs",entity:"msg"}]},"7_27":{service:"msg",cmd:"msgFtsInServerByTiming",response:[{type:"PropertyArray",name:"msgs",entity:"msg"}]},"7_118":{service:"msg",cmd:"onClearServerHistoryMsgs",response:[{type:"Property",name:"sessionHistoryMsgsDeleteTag",entity:"clearMsgsParamsWithSync"}]},"7_123":{service:"msg",cmd:"onDeleteMsgSelf",response:[{type:"Property",name:"deleteMsgSelfTag"}]},"7_124":{service:"msg",cmd:"onDeleteMsgSelfBatch",response:[{type:"PropertyArray",name:"deleteMsgSelfTags",entity:"deleteMsgSelfTag"}]},"7_116":{service:"msg",cmd:"syncMarkSessionAck",response:[{type:"Number",name:"scene"},{type:"String",name:"to"},{type:"Number",name:"timetag"}]},"7_121":{service:"msg",cmd:"syncUpdateServerSession",response:[{type:"Property",name:"session"}]},"23_1":{service:"msgExtend",cmd:"getThreadMsgs",response:[{type:"Property",name:"threadMsg",entity:"msg"},{type:"Property",name:"threadMsgsMeta"},{type:"PropertyArray",name:"msgs",entity:"msg"}]},"23_2":{service:"msgExtend",cmd:"getMsgsByIdServer",response:[{type:"PropertyArray",name:"msgs",entity:"msg"}]},"23_3":{service:"msgExtend",cmd:"addQuickComment",response:[{type:"Number",name:"timetag"}]},"23_4":{service:"msgExtend",cmd:"deleteQuickComment",response:[{type:"Number",name:"timetag"}]},"23_5":{service:"msgExtend",cmd:"onQuickComment",response:[{type:"Property",name:"msg"},{type:"Property",name:"comment"}]},"23_6":{service:"msgExtend",cmd:"onDeleteQuickComment",response:[{type:"Property",name:"msg"},{type:"Property",name:"comment"}]},"23_7":{service:"msgExtend",cmd:"getQuickComments",response:[{type:"PropertyArray",name:"commentRes",entity:"commentRes"}]},"23_8":{service:"msgExtend",cmd:"addCollect",response:[{type:"Property",name:"collect"}]},"23_9":{service:"msgExtend",cmd:"deleteCollects",response:[{type:"Number",name:"deleteNum"}]},"23_10":{service:"msgExtend",cmd:"updateCollect",response:[{type:"Property",name:"collect"}]},"23_11":{service:"msgExtend",cmd:"getCollects",response:[{type:"Number",name:"total"},{type:"PropertyArray",name:"collectList",entity:"collect"}]},"23_12":{service:"msgExtend",cmd:"addStickTopSession",response:[{type:"Property",name:"stickTopSession"}]},"23_13":{service:"msgExtend",cmd:"deleteStickTopSession",response:[{type:"Number",name:"timetag"}]},"23_14":{service:"msgExtend",cmd:"updateStickTopSession",response:[{type:"Property",name:"stickTopSession"}]},"23_15":{service:"msgExtend",cmd:"addMsgPin",response:[{type:"Number",name:"timetag"}]},"23_16":{service:"msgExtend",cmd:"updateMsgPin",response:[{type:"Number",name:"timetag"}]},"23_17":{service:"msgExtend",cmd:"deleteMsgPin",response:[{type:"Number",name:"timetag"}]},"23_18":{service:"msgExtend",cmd:"onAddMsgPin",response:[{type:"Property",name:"msg"},{type:"Property",name:"pinTag"},{type:"Number",name:"timetag"}]},"23_19":{service:"msgExtend",cmd:"onUpdateMsgPin",response:[{type:"Property",name:"msg"},{type:"Property",name:"pinTag"},{type:"Number",name:"timetag"}]},"23_20":{service:"msgExtend",cmd:"onDeleteMsgPin",response:[{type:"Property",name:"msg"},{type:"Property",name:"pinTag"},{type:"Number",name:"timetag"}]},"23_21":{service:"msgExtend",cmd:"getMsgPins",response:[{type:"Number",name:"timetag"},{type:"Boolean",name:"modify"},{type:"PropertyArray",name:"pins",entity:"msgPinRes"}]},"23_103":{service:"msgExtend",cmd:"syncAddQuickComment",response:[{type:"Property",name:"msg"},{type:"Property",name:"comment"}]},"23_104":{service:"msgExtend",cmd:"syncDeleteQuickComment",response:[{type:"Property",name:"msg"},{type:"Property",name:"comment"}]},"23_112":{service:"msgExtend",cmd:"syncAddStickTopSession",response:[{type:"Property",name:"stickTopSession"}]},"23_113":{service:"msgExtend",cmd:"syncDeleteStickTopSession",response:[{type:"Number",name:"timetag"},{type:"Property",name:"stickTopSession"}]},"23_114":{service:"msgExtend",cmd:"syncUpdateStickTopSession",response:[{type:"Property",name:"stickTopSession"}]},"23_115":{service:"msgExtend",cmd:"syncAddMsgPin",response:[{type:"Property",name:"msg"},{type:"Property",name:"pinTag"},{type:"Number",name:"timetag"}]},"23_116":{service:"msgExtend",cmd:"syncUpdateMsgPin",response:[{type:"Property",name:"msg"},{type:"Property",name:"pinTag"},{type:"Number",name:"timetag"}]},"23_117":{service:"msgExtend",cmd:"syncDeleteMsgPin",response:[{type:"Property",name:"msg"},{type:"Property",name:"pinTag"},{type:"Number",name:"timetag"}]},"21_2":{service:"superTeam",cmd:"sendSuperTeamMsg",response:[{type:"Property",name:"msg"}]},"21_3":{service:"superTeam",cmd:"superTeamMsg",response:[{type:"Property",name:"msg"}]},"21_5":{service:"superTeam",cmd:"addSuperTeamMembers",response:[{type:"StrArray",name:"abortedAccidList"},{type:"long",name:"timetag"}]},"21_6":{service:"superTeam",cmd:"removeSuperTeamMembers"},"21_7":{service:"superTeam",cmd:"leaveSuperTeam"},"21_8":{service:"superTeam",cmd:"updateSuperTeam",response:[{type:"long",name:"timetag"}]},"21_9":{service:"superTeam",cmd:"getSuperTeam",response:[{type:"Property",name:"team"}]},"21_12":{service:"superTeam",cmd:"getSuperTeams",response:[{type:"PropertyArray",name:"teams",entity:"superTeam"},{type:"bool",name:"isAll"},{type:"long",name:"timetag"}]},"21_10":{service:"superTeam",cmd:"updateInfoInSuperTeam",response:[{type:"Property",name:"superTeamMember"}]},"21_13":{service:"superTeam",cmd:"getSuperTeamMembers",response:[{type:"long",name:"timetag"}]},"21_11":{service:"superTeam",cmd:"getMySuperTeamMembers",response:[{type:"PropertyArray",name:"members",entity:"superTeamMember"}]},"21_14":{service:"superTeam",cmd:"getSuperTeamHistoryMsgs",response:[{type:"PropertyArray",name:"msgs",entity:"msg"}]},"21_15":{service:"superTeam",cmd:"getSuperTeamMembersByJoinTime",response:[{type:"PropertyArray",name:"members",entity:"superTeamMember"}]},"21_16":{service:"superTeam",cmd:"sendSuperTeamCustomSysMsg",trivialErrorCodes:[7101]},"21_17":{service:"superTeam",cmd:"onDeleteSuperTeamMsg"},"21_18":{service:"superTeam",cmd:"onSuperTeamMsgDelete",response:[{type:"Property",name:"sysMsg"}]},"21_19":{service:"superTeam",cmd:"superTeamCustomSysMsg",response:[{type:"Property",name:"sysMsg"}]},"21_20":{service:"superTeam",cmd:"applySuperTeam",response:[{type:"Property",name:"team"}]},"21_21":{service:"superTeam",cmd:"passSuperTeamApply"},"21_22":{service:"superTeam",cmd:"rejectSuperTeamApply"},"21_23":{service:"superTeam",cmd:"acceptSuperTeamInvite",response:[{type:"Property",name:"team"}]},"21_24":{service:"superTeam",cmd:"rejectSuperTeamInvite"},"21_25":{service:"superTeam",cmd:"onMarkSuperTeamSessionAck"},"21_26":{service:"superTeam",cmd:"addSuperTeamManagers"},"21_27":{service:"superTeam",cmd:"removeSuperTeamManagers"},"21_28":{service:"superTeam",cmd:"updateSuperTeamMute"},"21_29":{service:"superTeam",cmd:"updateSuperTeamMembersMute",response:[{type:"long",name:"timetag"}]},"21_30":{service:"superTeam",cmd:"updateNickInSuperTeam"},"21_31":{service:"superTeam",cmd:"transferSuperTeam"},"21_32":{service:"superTeam",cmd:"onMarkSuperTeamSessionsAck"},"21_33":{service:"superTeam",cmd:"getSuperTeamMembersByAccounts",response:[{type:"PropertyArray",name:"members",entity:"superTeamMember"}]},"21_34":{service:"superTeam",cmd:"getMutedSuperTeamMembers",response:[{type:"PropertyArray",name:"members",entity:"superTeamMember"}]},"21_113":{service:"superTeam",cmd:"syncSuperTeamMembers",response:[{type:"Number",name:"teamId"},{type:"PropertyArray",name:"members",entity:"superTeamMember"},{type:"bool",name:"isAll"},{type:"long",name:"timetag"}]},"21_111":{service:"superTeam",cmd:"syncMySuperTeamMembers",response:[{type:"PropertyArray",name:"teamMembers",entity:"superTeamMember"},{type:"long",name:"timetag"}]},"21_109":{service:"superTeam",cmd:"syncSuperTeams",response:[{type:"PropertyArray",name:"teams",entity:"superTeam"},{type:"bool",name:"isAll"},{type:"long",name:"timetag"}]},"21_101":{service:"superTeam",cmd:"syncCreateSuperTeam",response:[{type:"Property",name:"team"}]},"21_102":{service:"superTeam",cmd:"syncSendSuperTeamMsg",response:[{type:"Property",name:"msg"}]},"21_110":{service:"superTeam",cmd:"syncUpdateSuperTeamMember",response:[{type:"Property",name:"teamMember",entity:"superTeamMember"}]},"21_117":{service:"superTeam",cmd:"syncDeleteSuperTeamMsg",response:[{type:"Property",name:"sysMsg"}]},"21_125":{service:"superTeam",cmd:"syncMarkSuperTeamSessionAck",response:[{type:"Long",name:"to"},{type:"Long",name:"timetag"}]},"8_1":{service:"team",cmd:"createTeam",response:[{type:"Property",name:"team"},{type:"StrArray",name:"abortedAccidList"}]},"8_2":{service:"team",cmd:"sendTeamMsg",response:[{type:"Property",name:"msg"}]},"8_3":{service:"team",cmd:"teamMsg",response:[{type:"Property",name:"msg"}]},"8_4":{service:"team",cmd:"teamMsgs",response:[{type:"PropertyArray",name:"msgs",entity:"msg"}]},"8_5":{service:"team",cmd:"addTeamMembers",response:[{type:"long",name:"time"},{type:"StrArray",name:"abortedAccidList"}]},"8_6":{service:"team",cmd:"removeTeamMembers"},"8_7":{service:"team",cmd:"updateTeam",response:[{type:"Number",name:"id"},{type:"Number",name:"time"}]},"8_8":{service:"team",cmd:"leaveTeam"},"8_9":{service:"team",cmd:"getTeam",response:[{type:"Property",name:"team"}]},"8_10":{service:"team",cmd:"getTeams",response:[{type:"PropertyArray",name:"teams",entity:"team"},{type:"Number",name:"timetag"}]},"8_11":{service:"team",cmd:"getTeamMembers",response:[{type:"Number",name:"teamId"},{type:"PropertyArray",name:"members",entity:"teamMember"},{type:"Number",name:"timetag"}]},"8_12":{service:"team",cmd:"dismissTeam"},"8_13":{service:"team",cmd:"applyTeam",response:[{type:"Property",name:"team"}]},"8_14":{service:"team",cmd:"passTeamApply"},"8_15":{service:"team",cmd:"rejectTeamApply"},"8_16":{service:"team",cmd:"addTeamManagers"},"8_17":{service:"team",cmd:"removeTeamManagers"},"8_18":{service:"team",cmd:"transferTeam"},"8_19":{service:"team",cmd:"updateInfoInTeam",response:[{type:"Property",name:"teamMember"}]},"8_20":{service:"team",cmd:"updateNickInTeam"},"8_21":{service:"team",cmd:"acceptTeamInvite",response:[{type:"Property",name:"team"}]},"8_22":{service:"team",cmd:"rejectTeamInvite"},"8_23":{service:"team",cmd:"getTeamHistoryMsgs",response:[{type:"PropertyArray",name:"msgs",entity:"msg"}]},"8_24":{service:"team",cmd:"searchTeamHistoryMsgs",response:[{type:"PropertyArray",name:"msgs",entity:"msg"}]},"8_25":{service:"team",cmd:"updateMuteStateInTeam"},"8_26":{service:"team",cmd:"getMyTeamMembers",response:[{type:"PropertyArray",name:"teamMembers",entity:"teamMember"}]},"8_27":{service:"team",cmd:"getMutedTeamMembers",response:[{type:"Number",name:"teamId"},{type:"PropertyArray",name:"teamMembers",entity:"teamMember"}]},"8_28":{service:"team",cmd:"sendTeamMsgReceipt",response:[{type:"PropertyArray",name:"teamMsgReceipts",entity:"teamMsgReceipt"}]},"8_29":{service:"team",cmd:"getTeamMsgReads",response:[{type:"PropertyArray",name:"teamMsgReceipts",entity:"teamMsgReceipt"}]},"8_30":{service:"team",cmd:"getTeamMsgReadAccounts",response:[{type:"Property",name:"teamMsgReceipt"},{type:"StrArray",name:"readAccounts"},{type:"StrArray",name:"unreadAccounts"}]},"8_31":{service:"team",cmd:"notifyTeamMsgReads",response:[{type:"PropertyArray",name:"teamMsgReceipts",entity:"teamMsgReceipt"}]},"8_32":{service:"team",cmd:"muteTeamAll",response:[]},"8_33":{service:"team",cmd:"getTeamMemberInvitorAccid",response:[{type:"object",name:"accountsMap"}]},"8_34":{service:"team",cmd:"getTeamsById",response:[{type:"PropertyArray",name:"teams",entity:"team"},{type:"StrArray",name:"tids"}],trivialErrorCodes:[816]},"8_126":{service:"team",cmd:"syncMyTeamMembers",response:[{type:"PropertyArray",name:"teamMembers",entity:"teamMember"},{type:"Number",name:"timetag"}]},"8_109":{service:"team",cmd:"syncTeams",response:[{type:"Number",name:"timetag"},{type:"PropertyArray",name:"teams",entity:"team"}]},"8_111":{service:"team",cmd:"syncTeamMembers",response:[{type:"Number",name:"teamId"},{type:"PropertyArray",name:"members",entity:"teamMember"},{type:"Number",name:"timetag"}]},"8_101":{service:"team",cmd:"syncCreateTeam",response:[{type:"Property",name:"team"}]},"8_102":{service:"team",cmd:"syncSendTeamMsg",response:[{type:"Property",name:"msg"}]},"8_119":{service:"team",cmd:"syncUpdateTeamMember",response:[{type:"Property",name:"teamMember"}]},"12_1":{service:"friend",cmd:"friendRequest"},"12_101":{service:"friend",cmd:"syncFriendRequest",response:[{type:"String",name:"account"},{type:"Number",name:"type"},{type:"String",name:"ps"}]},"12_2":{service:"friend",cmd:"deleteFriend"},"12_102":{service:"friend",cmd:"syncDeleteFriend",response:[{type:"String",name:"account"}]},"12_3":{service:"friend",cmd:"updateFriend"},"12_103":{service:"friend",cmd:"syncUpdateFriend",response:[{type:"Property",name:"friend"}]},"12_4":{service:"friend",cmd:"getFriends",response:[{type:"PropertyArray",name:"friends",entity:"friend"},{type:"Number",name:"timetag"}]},"12_5":{service:"friend",cmd:"syncFriends",response:[{type:"PropertyArray",name:"friends",entity:"friend"},{type:"Number",name:"timetag"}]},"12_6":{service:"friend",cmd:"syncFriendUsers",response:[{type:"PropertyArray",name:"users",entity:"user"},{type:"Number",name:"timetag"}]},"13_1":{service:"chatroom",cmd:"getChatroomAddress",response:[{type:"StrArray",name:"address"}]},"14_1":{service:"eventService",cmd:"publishEvent",response:[{type:"Property",name:"msgEvent"}]},"14_2":{service:"eventService",cmd:"pushEvent",response:[{type:"Property",name:"msgEvent"}]},"14_3":{service:"eventService",cmd:"subscribeEvent",response:[{type:"StrArray",name:"accounts"}]},"14_4":{service:"eventService",cmd:"unSubscribeEventsByAccounts",response:[{type:"StrArray",name:"accounts"}]},"14_5":{service:"eventService",cmd:"unSubscribeEventsByType"},"14_6":{service:"eventService",cmd:"querySubscribeEventsByAccounts",response:[{type:"PropertyArray",name:"msgEventSubscribes",entity:"msgEventSubscribe"}]},"14_7":{service:"eventService",cmd:"querySubscribeEventsByType",response:[{type:"PropertyArray",name:"msgEventSubscribes",entity:"msgEventSubscribe"}]},"14_9":{service:"eventService",cmd:"pushEvents",response:[{type:"PropertyArray",name:"msgEvents",entity:"msgEvent"}]},"22_1":{service:"proxyService",cmd:"httpProxy",response:[{type:"Property",name:"proxyTag"}]},"22_2":{service:"proxyService",cmd:"onProxyMsg",response:[{type:"Property",name:"proxyMsg",entity:"proxyMsgTag"}]},"24_1":{service:"qchat",cmd:"getQChatAddress",response:[{type:"StrArray",name:"address"}]},"101_1":{service:"filter",cmd:"sendFilterMsg",response:[{type:"Property",name:"msg"}]},"101_2":{service:"filter",cmd:"filterMsg",response:[{type:"Property",name:"msg"}]},"101_3":{service:"filter",cmd:"filterSysMsg",response:[{type:"Property",name:"sysMsg"}]},"101_7":{service:"filter",cmd:"sendFilterCustomSysMsg"}});t.exports={idMap:i,cmdConfig:k,packetConfig:$}},function(t,r){t.exports={negotiateTransportTag:{version:-1,serializeList:1,serialize:101},initTransportTag:{},nosToken:{objectName:1,token:2,bucket:3,expireTime:4,expireSec:7,tag:8,shortUrl:9},audioToText:{url:2},imageOp:{type:0,stripmeta:1,typeType:2,blurRadius:3,blurSigma:4,qualityQuality:5,cropX:6,cropY:7,cropWidth:8,cropHeight:9,rotateAngle:10,pixelPixel:11,thumbnailMode:12,thumbnailWidth:13,thumbnailHeight:14,thumbnailAxisX:15,thumbnailAxisY:16,thumbnailCenterX:17,thumbnailCenterY:18,thumbnailEnlarge:19,thumbnailToStatic:20,watermarkType:21,watermarkGravity:22,watermarkDissolve:23,watermarkDx:24,watermarkDy:25,watermarkImage:26,watermarkText:27,watermarkFont:28,watermarkFontSize:29,watermarkFontColor:30,interlace:31},robot:{account:4,nick:5,avatar:6,intro:7,config:8,valid:9,createTime:10,updateTime:11,custid:12,botid:13,bindTime:14},clientAntispam:{version:1,md5:2,nosurl:3,thesaurus:4},fileQuickTransfer:{md5:1,url:2,size:3,threshold:4},transToken:{name:1,type:2,transType:3,size:4,extra:5,body:6},transInfo:{docId:1,name:2,prefix:3,size:4,type:5,state:6,transType:7,transSize:8,pageCount:9,picInfo:10,extra:11,flag:12},nosFileUrlTag:{safeUrl:0,originUrl:1},nosAccessTokenTag:{token:0,url:1,userAgent:2,ext:3},fileListParam:{fromDocId:1,limit:2},avSignalTag:{type:1,channelName:2,channelId:3,channelCreateTime:4,channelExpireTime:5,creator:6,ext:7,channelInValid:8,from:10,to:11,requestId:12,needPush:13,pushTitle:14,pushContent:15,pushPayload:16,needBadge:17,members:18,attach:19,attachExt:20,isSave:21,msgid:22,uid:23,time:24,nertcChannelName:25,nertcTokenTtl:26,nertcToken:27,nertcJoinRoomQueryParamMap:28,nertcJoinRoomResponse:29,callStatus:30},login:{clientType:3,os:4,sdkVersion:6,appLogin:8,protocolVersion:9,pushTokenName:10,pushToken:11,deviceId:13,appKey:18,account:19,browser:24,session:26,deviceInfo:32,sdkType:41,userAgent:42,libEnv:44,isReactNative:112,token:1e3,customTag:38,customClientType:39,sdkHumanVersion:40,authType:115,loginExt:116},loginRes:{lastLoginDeviceId:17,customTag:38,connectionId:102,ip:103,port:104,country:106,hasXMPush:111},loginPort:{type:3,os:4,mac:5,deviceId:13,account:19,deviceInfo:32,connectionId:102,ip:103,time:109,customTag:38,customClientType:39},aosPushInfo:{pushType:110,hasTokenPreviously:111},sync:{myInfo:1,offlineMsgs:2,teams:3,netcallMsgs:6,roamingMsgs:7,relations:9,friends:11,sessions:12,friendUsers:13,msgReceipts:14,myTeamMembers:15,donnop:16,deleteMsg:17,sessionAck:18,robots:19,broadcastMsgs:20,avSignal:21,superTeams:22,myInfoInSuperTeams:23,superTeamRoamingMsgs:24,deleteSuperTeamMsg:25,superTeamSessionAck:26,deleteMsgSelf:27,stickTopSessions:28,sessionHistoryMsgsDelete:29,filterMsgs:100},donnop:{open:1},sessionReqTag:{minTimestamp:1,maxTimestamp:2,needLastMsg:3,limit:4,hasMore:5},session:{id:1,updateTime:2,ext:3,lastMsg:4},superTeam:{teamId:1,name:3,type:4,owner:5,level:6,selfCustom:7,valid:8,memberNum:9,memberUpdateTime:10,createTime:11,updateTime:12,validToCurrentUser:13,intro:14,announcement:15,joinMode:16,bits:17,custom:18,serverCustom:19,avatar:20,beInviteMode:21,inviteMode:22,updateTeamMode:23,updateCustomMode:24,mute:100,muteType:101},superTeamMember:{teamId:1,account:3,type:4,nickInTeam:5,bits:7,active:8,valid:9,createTime:10,updateTime:11,custom:12,mute:13,invitoraccid:14,joinTime:15,followAccountIds:17},team:{teamId:1,name:3,type:4,owner:5,level:6,selfCustom:7,valid:8,memberNum:9,memberUpdateTime:10,createTime:11,updateTime:12,validToCurrentUser:13,intro:14,announcement:15,joinMode:16,bits:17,custom:18,serverCustom:19,avatar:20,beInviteMode:21,inviteMode:22,updateTeamMode:23,updateCustomMode:24,mute:100,muteType:101},teamMember:{teamId:1,account:3,type:4,nickInTeam:5,bits:7,active:8,valid:9,joinTime:10,updateTime:11,custom:12,mute:13,invitorAccid:14,followAccountIds:16},teamSpecialFollowUpdateTag:{accountIds:1,type:2},msg:{scene:0,to:1,from:2,fromClientType:4,fromDeviceId:5,fromNick:6,time:7,type:8,body:9,attach:10,idClient:11,idServer:12,resend:13,userUpdateTime:14,custom:15,pushPayload:16,pushContent:17,apnsAccounts:18,apnsContent:19,apnsForcePush:20,yidunEnable:21,antiSpamContent:22,antiSpamBusinessId:23,clientAntiSpam:24,antiSpamUsingYidun:25,needMsgReceipt:26,needUpdateSession:28,replyMsgFromAccount:29,replyMsgToAccount:30,replyMsgTime:31,replyMsgIdServer:32,replyMsgIdClient:33,threadMsgFromAccount:34,threadMsgToAccount:35,threadMsgTime:36,threadMsgIdServer:37,threadMsgIdClient:38,delete:39,callbackExt:40,subType:41,yidunAntiCheating:42,env:43,yidunAntiSpamExt:44,yidunAntiSpamRes:45,__clientExt:46,robotInfoFunction:47,robotInfoTopic:48,robotInfoCustomContent:49,robotInfoAccount:50,isHistoryable:100,isRoamingable:101,isSyncable:102,isMuted:104,cc:105,isInBlackList:106,isPushable:107,isOfflinable:108,isUnreadable:109,needPushNick:110,isReplyMsg:111,tempTeamMemberCount:112},threadMsgReq:{beginTime:1,endTime:2,lastMsgId:3,limit:4,reverse:5},threadMsgsMeta:{total:1,lastMsgTime:2},comment:{from:1,body:2,time:3,custom:4,needPush:5,needBadge:6,pushTitle:7,apnsText:8,pushPayload:9},commentReq:{scene:1,from:2,to:3,time:4,idServer:5,idClient:6,timestamp:100},commentRes:{scene:1,from:2,to:3,time:4,idServer:5,idClient:6,detail:7,modify:8,timestamp:100},collect:{id:1,type:2,data:3,custom:4,uniqueId:5,createTime:6,updateTime:7},collectQuery:{beginTime:1,endTime:2,lastMsgId:3,limit:4,reverse:5,type:6},stickTopSession:{id:1,topCustom:2,createTime:3,updateTime:4},pinTag:{pinFrom:1,pinCustom:2,createTime:3,updateTime:4},msgPinReq:{sessionId:1,timetag:2},msgPinRes:{scene:1,from:2,to:3,time:4,idServer:5,idClient:6,pinFrom:7,pinCustom:8},msgReceipt:{to:1,from:2,time:7,idClient:11},teamMsgReceipt:{teamId:0,idServer:1,read:100,unread:101,idClient:102,account:103},deleteMsgSelfTag:{scene:1,from:2,to:3,idServer:4,idClient:5,time:6,deletedTime:7,custom:8},sysMsg:{time:0,type:1,to:2,from:3,ps:4,attach:5,idServer:6,sendToOnlineUsersOnly:7,apnsText:8,pushPayload:9,deletedIdClient:10,deletedIdServer:11,yidunEnable:12,antiSpamContent:13,deletedMsgTime:14,deletedMsgFromNick:15,opeAccount:16,env:21,idClient:23,callbackExt:22,cc:105,isPushable:107,isUnreadable:109,needPushNick:110},broadcastMsg:{broadcastId:1,fromAccid:2,fromUid:3,timestamp:4,body:5},friend:{account:4,flag:5,beflag:6,source:7,alias:8,bits:9,custom:10,createTime:11,updateTime:12,serverex:13},user:{account:1,nick:3,avatar:4,sign:5,gender:6,email:7,birth:8,tel:9,custom:10,createTime:12,updateTime:13},antispamTag:{antiSpamBusinessId:1},specialRelation:{account:0,isMuted:1,isBlacked:2,createTime:3,updateTime:4},msgType:{text:0,picture:1,audio:2,video:3,location:4,notification:5,file:6,netcall_audio:7,netcall_vedio:8,datatunnel_new:9,tips:10,robot:11,custom:100},msgEvent:{type:1,value:2,idClient:3,custom:4,validTime:5,broadcastType:6,sync:7,validTimeType:8,durable:9,time:10,idServer:11,clientType:12,serverConfig:13,serverCustom:14,appid:101,account:103,enableMultiClient:104,consid:106},msgEventSubscribe:{type:1,subscribeTime:2,sync:3,to:102,from:104,time:105},clearMsgsParams:{account:1,delRoam:2},clearMsgsParamsWithSync:{type:0,otherAccid:1,isDeleteRoam:2,toTid:3,isSyncSelf:4,fromAccid:5,time:6,ext:7},msgFullSearchRequestTag:{keyword:1,fromTime:2,toTime:3,sessionLimit:4,msgLimit:5,order:6,p2pList:7,teamList:8,senderList:9,msgTypeList:10,msgSubTypeList:11},msgTimingFullSearchRequestTag:{keyword:1,fromTime:2,toTime:3,msgLimit:5,order:6,p2pList:7,teamList:8,senderList:9,msgTypeList:10,msgSubTypeList:11},delFriendParams:{delAlias:1},proxyTag:{zone:1,path:2,method:3,header:4,body:5},proxyMsgTag:{from:1,body:2,time:3},sessionAckTag:{scene:1,to:2,timetag:3},mixTokenReq:{provider:0,tokenCount:1,fileExpireSec:2,tag:3,returnBody:4},mixAuthTokenReq:{type:1,urls:2},notifyDetectTag:{type:1,params:2,result:3,t1:100,t2:101,t3:102,t4:103,t5:104,t6:105},getQChatAddressTag:{ipType:1}}},function(t,r){t.exports={negotiateTransportTag:{"-1":"version",1:"serializeList",101:"serialize"},initTransportTag:{},nosToken:{1:"objectName",2:"token",3:"bucket",4:"expireTime",7:"expireSec",8:"tag",9:"shortUrl"},audioToText:{2:"url"},imageOp:{0:"type",1:"stripmeta",2:"typeType",3:"blurRadius",4:"blurSigma",5:"qualityQuality",6:"cropX",7:"cropY",8:"cropWidth",9:"cropHeight",10:"rotateAngle",11:"pixelPixel",12:"thumbnailMode",13:"thumbnailWidth",14:"thumbnailHeight",15:"thumbnailAxisX",16:"thumbnailAxisY",17:"thumbnailCenterX",18:"thumbnailCenterY",19:"thumbnailEnlarge",20:"thumbnailToStatic",21:"watermarkType",22:"watermarkGravity",23:"watermarkDissolve",24:"watermarkDx",25:"watermarkDy",26:"watermarkImage",27:"watermarkText",28:"watermarkFont",29:"watermarkFontSize",30:"watermarkFontColor",31:"interlace"},robot:{4:"account",5:"nick",6:"avatar",7:"intro",8:"config",9:"valid",10:"createTime",11:"updateTime",12:"custid",13:"botid",14:"bindTime",_6_safe:"_avatar_safe"},clientAntispam:{1:"version",2:"md5",3:"nosurl",4:"thesaurus"},fileQuickTransfer:{1:"md5",2:"url",3:"size",4:"threshold",_2_safe:"_url_safe"},transToken:{1:"name",2:"type",3:"transType",4:"size",5:"extra",6:"body"},transInfo:{1:"docId",2:"name",3:"prefix",4:"size",5:"type",6:"state",7:"transType",8:"transSize",9:"pageCount",10:"picInfo",11:"extra",12:"flag"},nosFileUrlTag:{0:"safeUrl",1:"originUrl"},nosAccessTokenTag:{0:"token",1:"url",2:"userAgent",3:"ext"},nosConfigTag:{1:"bucket",2:"cdnDomain",3:"expire",4:"objectNamePrefix"},appGrayConfigTag:{0:"grayConfig",1:"ttl"},mixStorePolicyTag:{0:"providers",1:"ttl",2:"mixEnable",3:"nosPolicy",4:"s3Policy"},mixStoreTokenTag:{0:"provider",1:"accessKeyId",2:"secretAccessKey",3:"sessionToken",4:"token",5:"expireAt",6:"bucket",7:"objectName",8:"fileExpireSec",9:"tag",10:"shortUrl",11:"region"},notifyDetectTag:{1:"type",2:"params",3:"result",100:"t1",101:"t2",102:"t3",103:"t4",104:"t5",105:"t6"},backSourceTokenTag:{1:"type",2:"tokens",3:"token",4:"ttl"},fileListParam:{1:"fromDocId",2:"limit"},avSignalTag:{1:"type",2:"channelName",3:"channelId",4:"channelCreateTime",5:"channelExpireTime",6:"creator",7:"ext",8:"channelInValid",10:"from",11:"to",12:"requestId",13:"needPush",14:"pushTitle",15:"pushContent",16:"pushPayload",17:"needBadge",18:"members",19:"attach",20:"attachExt",21:"isSave",22:"msgid",23:"uid",24:"time",25:"nertcChannelName",26:"nertcTokenTtl",27:"nertcToken",28:"nertcJoinRoomQueryParamMap",29:"nertcJoinRoomResponse",30:"callStatus"},login:{3:"clientType",4:"os",6:"sdkVersion",8:"appLogin",9:"protocolVersion",10:"pushTokenName",11:"pushToken",13:"deviceId",18:"appKey",19:"account",24:"browser",26:"session",32:"deviceInfo",38:"customTag",39:"customClientType",40:"sdkHumanVersion",112:"isReactNative",115:"authType",116:"loginExt",1e3:"token"},loginRes:{17:"lastLoginDeviceId",38:"customTag",102:"connectionId",103:"ip",104:"port",106:"country",111:"hasXMPush"},loginPort:{3:"type",4:"os",5:"mac",13:"deviceId",19:"account",32:"deviceInfo",38:"customTag",39:"customClientType",102:"connectionId",103:"ip",109:"time"},aosPushInfo:{110:"pushType",111:"hasTokenPreviously"},sync:{1:"myInfo",2:"offlineMsgs",3:"teams",6:"netcallMsgs",7:"roamingMsgs",9:"relations",11:"friends",12:"sessions",13:"friendUsers",14:"msgReceipts",15:"myTeamMembers",16:"donnop",17:"deleteMsg",18:"sessionAck",19:"robots",20:"broadcastMsgs",21:"avSignal",22:"superTeams",23:"myInfoInSuperTeams",24:"superTeamRoamingMsgs",25:"deleteSuperTeamMsg",26:"superTeamSessionAck",27:"deleteMsgSelf",28:"stickTopSessions",29:"sessionHistoryMsgsDelete",100:"filterMsgs"},donnop:{1:"open"},sessionReqTag:{1:"minTimestamp",2:"maxTimestamp",3:"needLastMsg",4:"limit",5:"hasMore"},session:{1:"id",2:"updateTime",3:"ext",4:"lastMsg",5:"lastMsgType"},superTeam:{1:"teamId",3:"name",4:"type",5:"owner",6:"level",7:"selfCustom",8:"valid",9:"memberNum",10:"memberUpdateTime",11:"createTime",12:"updateTime",13:"validToCurrentUser",14:"intro",15:"announcement",16:"joinMode",17:"bits",18:"custom",19:"serverCustom",20:"avatar",21:"beInviteMode",22:"inviteMode",23:"updateTeamMode",24:"updateCustomMode",100:"mute",101:"muteType",_20_safe:"_avatar_safe"},superTeamMember:{1:"teamId",3:"account",4:"type",5:"nickInTeam",7:"bits",8:"active",9:"valid",10:"createTime",11:"updateTime",12:"custom",13:"mute",14:"invitoraccid",15:"joinTime",17:"followAccountIds"},team:{1:"teamId",3:"name",4:"type",5:"owner",6:"level",7:"selfCustom",8:"valid",9:"memberNum",10:"memberUpdateTime",11:"createTime",12:"updateTime",13:"validToCurrentUser",14:"intro",15:"announcement",16:"joinMode",17:"bits",18:"custom",19:"serverCustom",20:"avatar",21:"beInviteMode",22:"inviteMode",23:"updateTeamMode",24:"updateCustomMode",100:"mute",101:"muteType",_20_safe:"_avatar_safe"},teamMember:{1:"teamId",3:"account",4:"type",5:"nickInTeam",7:"bits",8:"active",9:"valid",10:"joinTime",11:"updateTime",12:"custom",13:"mute",14:"invitorAccid",16:"followAccountIds"},msg:{0:"scene",1:"to",2:"from",4:"fromClientType",5:"fromDeviceId",6:"fromNick",7:"time",8:"type",9:"body",10:"attach",11:"idClient",12:"idServer",13:"resend",14:"userUpdateTime",15:"custom",16:"pushPayload",17:"pushContent",18:"apnsAccounts",19:"apnsContent",20:"apnsForcePush",21:"yidunEnable",22:"antiSpamContent",23:"antiSpamBusinessId",24:"clientAntiSpam",25:"antiSpamUsingYidun",26:"needMsgReceipt",28:"needUpdateSession",29:"replyMsgFromAccount",30:"replyMsgToAccount",31:"replyMsgTime",32:"replyMsgIdServer",33:"replyMsgIdClient",34:"threadMsgFromAccount",35:"threadMsgToAccount",36:"threadMsgTime",37:"threadMsgIdServer",38:"threadMsgIdClient",39:"delete",40:"callbackExt",41:"subType",42:"yidunAntiCheating",43:"env",44:"yidunAntiSpamExt",45:"yidunAntiSpamRes",46:"__clientExt",47:"robotInfoFunction",48:"robotInfoTopic",49:"robotInfoCustomContent",50:"robotInfoAccount",100:"isHistoryable",101:"isRoamingable",102:"isSyncable",104:"isMuted",105:"cc",106:"isInBlackList",107:"isPushable",108:"isOfflinable",109:"isUnreadable",110:"needPushNick",111:"isReplyMsg",112:"tempTeamMemberCount"},threadMsgReq:{1:"beginTime",2:"endTime",3:"lastMsgId",4:"limit",5:"reverse"},threadMsgsMeta:{1:"total",2:"lastMsgTime"},comment:{1:"from",2:"body",3:"time",4:"custom",5:"needPush",6:"needBadge",7:"pushTitle",8:"apnsText",9:"pushPayload"},commentReq:{1:"scene",2:"from",3:"to",4:"time",5:"idServer",6:"idClient",100:"timestamp"},commentRes:{1:"scene",2:"from",3:"to",4:"time",5:"idServer",6:"idClient",7:"detail",8:"modify",100:"timestamp"},collect:{1:"id",2:"type",3:"data",4:"custom",5:"uniqueId",6:"createTime",7:"updateTime"},collectQuery:{1:"beginTime",2:"endTime",3:"lastMsgId",4:"limit",5:"reverse",6:"type"},stickTopSession:{1:"id",2:"topCustom",3:"createTime",4:"updateTime"},pinTag:{1:"pinFrom",2:"pinCustom",3:"createTime",4:"updateTime"},msgPinReq:{1:"sessionId",2:"timetag"},msgPinRes:{1:"scene",2:"from",3:"to",4:"time",5:"idServer",6:"idClient",7:"pinFrom",8:"pinCustom"},msgReceipt:{1:"to",2:"from",7:"time",11:"idClient"},teamMsgReceipt:{0:"teamId",1:"idServer",100:"read",101:"unread",102:"idClient",103:"account"},deleteMsgSelfTag:{1:"scene",2:"from",3:"to",4:"idServer",5:"idClient",6:"time",7:"deletedTime",8:"custom"},sysMsg:{0:"time",1:"type",2:"to",3:"from",4:"ps",5:"attach",6:"idServer",7:"sendToOnlineUsersOnly",8:"apnsText",9:"pushPayload",10:"deletedIdClient",11:"deletedIdServer",12:"yidunEnable",13:"antiSpamContent",14:"deletedMsgTime",15:"deletedMsgFromNick",16:"opeAccount",21:"env",22:"callbackExt",23:"idClient",105:"cc",107:"isPushable",109:"isUnreadable",110:"needPushNick"},broadcastMsg:{1:"broadcastId",2:"fromAccid",3:"fromUid",4:"timestamp",5:"body"},friend:{4:"account",5:"flag",6:"beflag",7:"source",8:"alias",9:"bits",10:"custom",11:"createTime",12:"updateTime",13:"serverex"},user:{1:"account",3:"nick",4:"avatar",5:"sign",6:"gender",7:"email",8:"birth",9:"tel",10:"custom",12:"createTime",13:"updateTime",_4_safe:"_avatar_safe"},antispamTag:{antiSpamBusinessId:1},specialRelation:{0:"account",1:"isMuted",2:"isBlacked",3:"createTime",4:"updateTime"},msgType:{0:"text",1:"picture",2:"audio",3:"video",4:"location",5:"notification",6:"file",7:"netcall_audio",8:"netcall_vedio",9:"datatunnel_new",10:"tips",11:"robot",100:"custom"},msgEvent:{1:"type",2:"value",3:"idClient",4:"custom",5:"validTime",6:"broadcastType",7:"sync",8:"validTimeType",9:"durable",10:"time",11:"idServer",12:"clientType",13:"serverConfig",14:"serverCustom",101:"appid",103:"account",104:"enableMultiClient",106:"consid"},msgEventSubscribe:{1:"type",2:"subscribeTime",3:"sync",102:"to",104:"from",105:"time"},clearMsgsParams:{1:"account",2:"delRoam"},clearMsgsParamsWithSync:{0:"type",1:"otherAccid",2:"delRoam",3:"toTid",4:"isSyncSelf",5:"fromAccid",6:"time",7:"ext"},msgFullSearchRequestTag:{1:"keyword",2:"fromTime",3:"toTime",4:"sessionLimit",5:"msgLimit",6:"order",7:"p2pList",8:"teamList",9:"senderList",10:"msgTypeList",11:"msgSubTypeList"},delFriendParams:{1:"delAlias"},proxyTag:{1:"zone",2:"path",3:"method",4:"header",5:"body"},proxyMsgTag:{1:"from",2:"body",3:"time"},sessionReliableSyncTag:{1:"scene",2:"sessionId",3:"syncStatus",4:"syncEndMsgId",5:"syncEndMsgidClient",6:"syncEndMsgTime",7:"syncStartMsgid",8:"syncStartMsgidClient",9:"syncStartMsgTime",10:"nextMsgid",11:"nextMsgidClient",12:"nextMsgTime",13:"roamMsgSync",14:"offlineMsgSync",15:"netCallOfflineMsgSync"},sessionReliableSyncContextTag:{1:"timetag",2:"type"}}},function(t,r,e){var n=e(0),g=e(193),y=n.merge({},g.idMap,{chatroom:{id:13,login:2,kicked:3,logout:4,sendMsg:6,msg:7,getChatroomMembers:8,getHistoryMsgs:9,markChatroomMember:11,closeChatroom:12,getChatroom:13,updateChatroom:14,updateMyChatroomMemberInfo:15,getChatroomMembersInfo:16,kickChatroomMember:17,updateChatroomMemberTempMute:19,queueOffer:20,queuePoll:21,queueList:22,peak:23,queueDrop:24,queueInit:25,queueChange:26,updateTagMembersTempMute:30,getChatroomMembersByTag:31,getChatroomMemberCountByTag:32,updateCoordinate:33,updateChatroomTags:34,sendChatroomMsgAck:35,getHistoryMsgsByTags:36,notifyCdnInfo:99},user:{id:3,syncRobot:16}}),i=n.merge({},g.cmdConfig,{login:{sid:y.chatroom.id,cid:y.chatroom.login,params:[{type:"byte",name:"type"},{type:"Property",name:"login"},{type:"Property",name:"imLogin"}]},logout:{sid:y.chatroom.id,cid:y.chatroom.logout},sendMsg:{sid:y.chatroom.id,cid:y.chatroom.sendMsg,params:[{type:"Property",name:"msg"}]},getChatroomMembers:{sid:y.chatroom.id,cid:y.chatroom.getChatroomMembers,params:[{type:"byte",name:"type"},{type:"long",name:"time"},{type:"int",name:"limit"}]},getHistoryMsgs:{sid:y.chatroom.id,cid:y.chatroom.getHistoryMsgs,params:[{type:"long",name:"timetag"},{type:"int",name:"limit"},{type:"bool",name:"reverse"},{type:"LongArray",name:"msgTypes"}]},markChatroomMember:{sid:y.chatroom.id,cid:y.chatroom.markChatroomMember,params:[{type:"string",name:"account"},{type:"int",name:"type"},{type:"bool",name:"isAdd"},{type:"int",name:"level"},{type:"string",name:"custom"}]},closeChatroom:{sid:y.chatroom.id,cid:y.chatroom.closeChatroom,params:[{type:"string",name:"custom"}]},getChatroom:{sid:y.chatroom.id,cid:y.chatroom.getChatroom},updateChatroom:{sid:y.chatroom.id,cid:y.chatroom.updateChatroom,params:[{type:"Property",name:"chatroom"},{type:"bool",name:"needNotify"},{type:"String",name:"custom"},{type:"Property",name:"antispamTag"}]},updateMyChatroomMemberInfo:{sid:y.chatroom.id,cid:y.chatroom.updateMyChatroomMemberInfo,params:[{type:"Property",name:"chatroomMember"},{type:"bool",name:"needNotify"},{type:"String",name:"custom"},{type:"bool",name:"needSave"},{type:"Property",name:"antispamTag"}]},getChatroomMembersInfo:{sid:y.chatroom.id,cid:y.chatroom.getChatroomMembersInfo,params:[{type:"StrArray",name:"accounts"}]},kickChatroomMember:{sid:y.chatroom.id,cid:y.chatroom.kickChatroomMember,params:[{type:"string",name:"account"},{type:"string",name:"custom"}]},updateChatroomMemberTempMute:{sid:y.chatroom.id,cid:y.chatroom.updateChatroomMemberTempMute,params:[{type:"String",name:"account"},{type:"long",name:"duration"},{type:"bool",name:"needNotify"},{type:"String",name:"custom"}]},queueOffer:{sid:y.chatroom.id,cid:y.chatroom.queueOffer,params:[{type:"string",name:"elementKey"},{type:"string",name:"elementValue"},{type:"bool",name:"transient"},{type:"string",name:"elementAccount"}]},queuePoll:{sid:y.chatroom.id,cid:y.chatroom.queuePoll,params:[{type:"string",name:"elementKey"}]},queueList:{sid:y.chatroom.id,cid:y.chatroom.queueList},peak:{sid:y.chatroom.id,cid:y.chatroom.peak},queueDrop:{sid:y.chatroom.id,cid:y.chatroom.queueDrop},queueInit:{sid:y.chatroom.id,cid:y.chatroom.queueInit,params:[{type:"int",name:"limit"}]},queueChange:{sid:y.chatroom.id,cid:y.chatroom.queueChange,params:[{type:"StrStrMap",name:"elementMap"},{type:"bool",name:"needNotify"},{type:"string",name:"notifyExt"}]},updateTagMembersTempMute:{sid:y.chatroom.id,cid:y.chatroom.updateTagMembersTempMute,params:[{type:"Property",name:"tagMuteReq"}]},updateCoordinate:{sid:y.chatroom.id,cid:y.chatroom.updateCoordinate,params:[{type:"Property",name:"coordinateReq"}]},getChatroomMemberCountByTag:{sid:y.chatroom.id,cid:y.chatroom.getChatroomMemberCountByTag,params:[{type:"String",name:"tag"}]},getChatroomMembersByTag:{sid:y.chatroom.id,cid:y.chatroom.getChatroomMembersByTag,params:[{type:"Property",name:"tagMemberReq"}]},updateChatroomTags:{sid:y.chatroom.id,cid:y.chatroom.updateChatroomTags,params:[{type:"Property",name:"chatRoomTagsUpdateTag"}]},sendChatroomMsgAck:{sid:y.chatroom.id,cid:y.chatroom.sendChatroomMsgAck,params:[{type:"Property",name:"chatRoomMsgAckTag"}]},getHistoryMsgsByTags:{sid:y.chatroom.id,cid:y.chatroom.getHistoryMsgsByTags,params:[{type:"Property",name:"chatRoomTagHistoryMsgRequestTag"}]},notifyCdnInfo:{sid:y.chatroom.id,cid:y.chatroom.notifyCdnInfo},syncRobot:{sid:y.user.id,cid:y.user.syncRobot,params:[{type:"long",name:"timetag"}]}}),k=n.merge({},g.packetConfig,{"4_10":{service:"notify"},"4_11":{service:"notify"},"3_16":{service:"chatroom",cmd:"syncRobot",response:[{type:"PropertyArray",name:"robots",entity:"robot"}]},"13_2":{service:"chatroom",cmd:"login",response:[{type:"Property",name:"chatroom"},{type:"Property",name:"chatroomMember"},{type:"Property",name:"chatroomCdnInfo"}]},"13_3":{service:"chatroom",cmd:"kicked",response:[{type:"Number",name:"reason"},{type:"String",name:"custom"}]},"13_4":{service:"chatroom",cmd:"logout"},"13_6":{service:"chatroom",cmd:"sendMsg",response:[{type:"Property",name:"msg"}]},"13_7":{service:"chatroom",cmd:"msg",response:[{type:"Property",name:"msg"}]},"13_8":{service:"chatroom",cmd:"getChatroomMembers",response:[{type:"PropertyArray",name:"members",entity:"chatroomMember"}]},"13_9":{service:"chatroom",cmd:"getHistoryMsgs",response:[{type:"PropertyArray",name:"msgs",entity:"msg"}]},"13_11":{service:"chatroom",cmd:"markChatroomMember",response:[{type:"Property",name:"chatroomMember"}]},"13_12":{service:"chatroom",cmd:"closeChatroom"},"13_13":{service:"chatroom",cmd:"getChatroom",response:[{type:"Property",name:"chatroom"}]},"13_14":{service:"chatroom",cmd:"updateChatroom"},"13_15":{service:"chatroom",cmd:"updateMyChatroomMemberInfo"},"13_16":{service:"chatroom",cmd:"getChatroomMembersInfo",response:[{type:"PropertyArray",name:"members",entity:"chatroomMember"}]},"13_17":{service:"chatroom",cmd:"kickChatroomMember"},"13_19":{service:"chatroom",cmd:"updateChatroomMemberTempMute"},"13_20":{service:"chatroom",cmd:"queueOffer"},"13_21":{service:"chatroom",cmd:"queuePoll",response:[{type:"String",name:"elementKey"},{type:"String",name:"elementValue"}]},"13_22":{service:"chatroom",cmd:"queueList",response:[{type:"KVArray",name:"queueList"}]},"13_23":{service:"chatroom",cmd:"peak",response:[{type:"String",name:"elementKey"},{type:"String",name:"elementValue"}]},"13_24":{service:"chatroom",cmd:"queueDrop"},"13_25":{service:"chatroom",cmd:"queueInit"},"13_26":{service:"chatroom",cmd:"queueChange",response:[{type:"StrArray",name:"elementKeyArray"}]},"13_30":{service:"chatroom",cmd:"updateTagMembersTempMute"},"13_33":{service:"chatroom",cmd:"updateCoordinate"},"13_31":{service:"chatroom",cmd:"getChatroomMembersByTag",response:[{type:"PropertyArray",name:"members",entity:"chatroomMember"}]},"13_32":{service:"chatroom",cmd:"getChatroomMemberCountByTag",response:[{type:"long",name:"count"}]},"13_34":{service:"chatroom",cmd:"updateChatroomTags"},"13_36":{service:"chatroom",cmd:"getHistoryMsgsByTags",response:[{type:"PropertyArray",name:"msgs",entity:"msg"}]},"13_99":{service:"chatroom",cmd:"notifyCdnInfo",response:[{type:"Property",name:"chatroomCdnInfo"}]},"13_101":{service:"chatroom",cmd:"updateChatroomTag",response:[{type:"Property",name:"updateTags"}]}});t.exports={idMap:y,cmdConfig:i,packetConfig:k}},function(t,r){t.exports={imLogin:{clientType:3,os:4,sdkVersion:6,appLogin:8,protocolVersion:9,pushTokenName:10,pushToken:11,deviceId:13,appKey:18,account:19,browser:24,session:26,deviceInfo:32,sdkType:41,userAgent:42,libEnv:44,isReactNative:112,authType:115,loginExt:116,token:1e3,customTag:38},nosToken:{objectName:1,token:2,bucket:3,expireTime:4,expireSec:7,tag:8,shortUrl:9},audioToText:{url:2},imageOp:{type:0,stripmeta:1,typeType:2,blurRadius:3,blurSigma:4,qualityQuality:5,cropX:6,cropY:7,cropWidth:8,cropHeight:9,rotateAngle:10,pixelPixel:11,thumbnailMode:12,thumbnailWidth:13,thumbnailHeight:14,thumbnailAxisX:15,thumbnailAxisY:16,thumbnailCenterX:17,thumbnailCenterY:18,thumbnailEnlarge:19,thumbnailToStatic:20,watermarkType:21,watermarkGravity:22,watermarkDissolve:23,watermarkDx:24,watermarkDy:25,watermarkImage:26,watermarkText:27,watermarkFont:28,watermarkFontSize:29,watermarkFontColor:30,interlace:31},robot:{account:4,nick:5,avatar:6,intro:7,config:8,valid:9,createTime:10,updateTime:11,custid:12,botid:13,bindTime:14},clientAntispam:{version:1,md5:2,nosurl:3,thesaurus:4},fileQuickTransfer:{md5:1,url:2,size:3,threshold:4},transToken:{name:1,type:2,transType:3,size:4,extra:5,body:6},transInfo:{docId:1,name:2,prefix:3,size:4,type:5,state:6,transType:7,transSize:8,pageCount:9,picInfo:10,extra:11,flag:12},nosFileUrlTag:{safeUrl:0,originUrl:1},nosAccessTokenTag:{token:0,url:1,userAgent:2,ext:3},fileListParam:{fromDocId:1,limit:2},avSignalTag:{type:1,channelName:2,channelId:3,channelCreateTime:4,channelExpireTime:5,creator:6,ext:7,channelInValid:8,from:10,to:11,requestId:12,needPush:13,pushTitle:14,pushContent:15,pushPayload:16,needBadge:17,members:18,attach:19,attachExt:20,isSave:21,msgid:22,uid:23,time:24,nertcChannelName:25,nertcTokenTtl:26,nertcToken:27,nertcJoinRoomQueryParamMap:28,nertcJoinRoomResponse:29,callStatus:30},login:{appKey:1,account:2,deviceId:3,chatroomId:5,appLogin:8,chatroomNick:20,chatroomAvatar:21,chatroomCustom:22,chatroomEnterCustom:23,session:26,isAnonymous:38,tags:39,notifyTargetTags:40,loginAuthType:41,loginExt:42,loc_x:43,loc_y:44,loc_z:45,distance:46,antiSpamBusinessId:47},chatroom:{id:1,name:3,announcement:4,broadcastUrl:5,custom:12,createTime:14,updateTime:15,queuelevel:16,creator:100,onlineMemberNum:101,mute:102},msg:{idClient:1,type:2,attach:3,custom:4,resend:5,userUpdateTime:6,fromNick:7,fromAvatar:8,fromCustom:9,yidunEnable:10,antiSpamContent:11,skipHistory:12,body:13,antiSpamBusinessId:14,clientAntiSpam:15,antiSpamUsingYidun:16,time:20,from:21,chatroomId:22,fromClientType:23,highPriority:25,callbackExt:27,subType:28,yidunAntiCheating:29,env:30,notifyTargetTags:31,yidunAntiSpamExt:32,yidunAntiSpamRes:33,loc_x:34,loc_y:35,loc_z:36,toAccids:37,needHighPriorityMsgAck:38,__clientExt:39},chatroomMember:{chatroomId:1,account:2,type:3,level:4,nick:5,avatar:6,custom:7,online:8,guest:9,enterTime:10,blacked:12,gaged:13,valid:14,updateTime:15,tempMuted:16,tempMuteDuration:17},antispamTag:{antiSpamBusinessId:1},chatroomCdnInfo:{enable:1,cdnUrls:2,timestamp:3,interval:4,decryptType:5,decryptKey:6,timeout:7},tagMemberReq:{tag:1,time:2,limit:3},tagMuteReq:{tag:1,duration:2,needNotify:3,custom:4,notifyTargetTags:5},coordinateReq:{x:1,y:2,z:3,distance:4},chatRoomTagsUpdateTag:{tags:1,notifyTargetTags:2,needNotify:3,ext:4},chatRoomMsgAckTag:{idClient:1,chatroomId:2},chatRoomTagHistoryMsgRequestTag:{tags:1,types:2,fromTime:3,toTime:4,limit:5,reverse:6}}},function(t,r){t.exports={imLogin:{3:"clientType",4:"os",6:"sdkVersion",8:"appLogin",9:"protocolVersion",10:"pushTokenName",11:"pushToken",13:"deviceId",18:"appKey",19:"account",24:"browser",26:"session",32:"deviceInfo",38:"customTag",41:"sdkType",42:"userAgent",44:"libEnv",112:"isReactNative",1e3:"token"},nosToken:{1:"objectName",2:"token",3:"bucket",4:"expireTime",7:"expireSec",8:"tag",9:"shortUrl"},audioToText:{2:"url"},imageOp:{0:"type",1:"stripmeta",2:"typeType",3:"blurRadius",4:"blurSigma",5:"qualityQuality",6:"cropX",7:"cropY",8:"cropWidth",9:"cropHeight",10:"rotateAngle",11:"pixelPixel",12:"thumbnailMode",13:"thumbnailWidth",14:"thumbnailHeight",15:"thumbnailAxisX",16:"thumbnailAxisY",17:"thumbnailCenterX",18:"thumbnailCenterY",19:"thumbnailEnlarge",20:"thumbnailToStatic",21:"watermarkType",22:"watermarkGravity",23:"watermarkDissolve",24:"watermarkDx",25:"watermarkDy",26:"watermarkImage",27:"watermarkText",28:"watermarkFont",29:"watermarkFontSize",30:"watermarkFontColor",31:"interlace"},robot:{4:"account",5:"nick",6:"avatar",7:"intro",8:"config",9:"valid",10:"createTime",11:"updateTime",12:"custid",13:"botid",14:"bindTime",_6_safe:"_avatar_safe"},clientAntispam:{1:"version",2:"md5",3:"nosurl",4:"thesaurus"},fileQuickTransfer:{1:"md5",2:"url",3:"size",4:"threshold",_2_safe:"_url_safe"},transToken:{1:"name",2:"type",3:"transType",4:"size",5:"extra",6:"body"},transInfo:{1:"docId",2:"name",3:"prefix",4:"size",5:"type",6:"state",7:"transType",8:"transSize",9:"pageCount",10:"picInfo",11:"extra",12:"flag"},nosFileUrlTag:{0:"safeUrl",1:"originUrl"},nosAccessTokenTag:{0:"token",1:"url",2:"userAgent",3:"ext"},fileListParam:{1:"fromDocId",2:"limit"},avSignalTag:{1:"type",2:"channelName",3:"channelId",4:"channelCreateTime",5:"channelExpireTime",6:"creator",7:"ext",8:"channelInValid",10:"from",11:"to",12:"requestId",13:"needPush",14:"pushTitle",15:"pushContent",16:"pushPayload",17:"needBadge",18:"members",19:"attach",20:"attachExt",21:"isSave",22:"msgid",23:"uid",24:"time",25:"nertcChannelName",26:"nertcTokenTtl",27:"nertcToken",28:"nertcJoinRoomQueryParamMap",29:"nertcJoinRoomResponse",30:"callStatus"},login:{1:"appKey",2:"account",3:"deviceId",5:"chatroomId",8:"appLogin",20:"chatroomNick",21:"chatroomAvatar",22:"chatroomCustom",23:"chatroomEnterCustom",26:"session",38:"isAnonymous",39:"tags",40:"notifyTargetTags",41:"loginAuthType",42:"loginExt",43:"loc_x",44:"loc_y",45:"loc_z",46:"distance",47:"antiSpamBusinessId",_21_safe:"_chatroomAvatar_safe"},chatroom:{1:"id",3:"name",4:"announcement",5:"broadcastUrl",12:"custom",14:"createTime",15:"updateTime",16:"queuelevel",100:"creator",101:"onlineMemberNum",102:"mute"},msg:{1:"idClient",2:"type",3:"attach",4:"custom",5:"resend",6:"userUpdateTime",7:"fromNick",8:"fromAvatar",9:"fromCustom",10:"yidunEnable",11:"antiSpamContent",12:"skipHistory",13:"body",14:"antiSpamBusinessId",15:"clientAntiSpam",16:"antiSpamUsingYidun",20:"time",21:"from",22:"chatroomId",23:"fromClientType",25:"highPriority",27:"callbackExt",28:"subType",29:"yidunAntiCheating",30:"env",31:"notifyTargetTags",32:"yidunAntiSpamExt",33:"yidunAntiSpamRes",34:"loc_x",35:"loc_y",36:"loc_z",37:"toAccids",38:"needHighPriorityMsgAck",39:"__clientExt",_8_safe:"_fromAvatar_safe"},chatroomMember:{1:"chatroomId",2:"account",3:"type",4:"level",5:"nick",6:"avatar",7:"custom",8:"online",9:"guest",10:"enterTime",12:"blacked",13:"gaged",14:"valid",15:"updateTime",16:"tempMuted",17:"tempMuteDuration",_6_safe:"_avatar_safe"},antispamTag:{antiSpamBusinessId:1},chatroomCdnInfo:{1:"enable",2:"cdnUrls",3:"timestamp",4:"interval",5:"decryptType",6:"decryptKey",7:"timeout"},nosConfigTag:{1:"bucket",2:"cdnDomain",3:"expire",4:"objectNamePrefix"},updateTags:{1:"currentTags"}}},function(t,r,e){t.exports=e(791)},function(t,r){t.exports=function(e,n){(n==null||n>e.length)&&(n=e.length);for(var g=0,y=new Array(n);g<n;g++)y[g]=e[g];return y},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,r,e){t.exports=e(795)},function(t,r,e){var n=e(309),g=e(752),y=e(751);t.exports=function(i,k){var $;if(i){if(typeof i=="string")return y(i,k);var L=n($=Object.prototype.toString.call(i)).call($,8,-1);return L==="Object"&&i.constructor&&(L=i.constructor.name),L==="Map"||L==="Set"?g(i):L==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(L)?y(i,k):void 0}},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,r,e){t.exports=e(799)},function(t,r,e){var n=e(4),g=e(37),y=e(0),i=y.notundef,k={addFriend:1,applyFriend:2,passFriendApply:3,rejectFriendApply:4},$={1:"addFriend",2:"applyFriend",3:"passFriendApply",4:"rejectFriendApply"};function L(V){y.verifyOptions(V,"account","friend::Friend"),y.verifyParamAtLeastPresentOne(V,"alias custom","friend::Friend"),this.account=V.account,i(V.alias)&&(this.alias=V.alias),i(V.custom)&&(this.custom=V.custom)}L.reverse=function(V){var z=y.filterObj(V,"account alias custom createTime updateTime serverex");return i(V.flag)&&(z.valid=V.flag==="1"),i(z.createTime)&&(z.createTime=+z.createTime),i(z.updateTime)&&(z.updateTime=+z.updateTime),z},L.validTypes=function(){return n(k)},L.getByteFromType=function(V){return k[V]},L.getTypeFromByte=function(V){return $[V]},L.assembleFriend=function(V){var z=+new Date;return g({},V,{alias:"",createTime:z,custom:"",updateTime:z,valid:!0})},t.exports=L},function(t,r,e){var n=e(757),g=e(37),y=e(0),i=y.notundef;function k($,L){n($.body)||y.onParamError("body只能是整数",L),this.body=$.body,this.from=$.from||"",this.custom=$.custom||"",i($.pushTitle)&&(this.pushTitle=$.pushTitle),i($.apnsText)&&(this.apnsText=$.apnsText),i($.pushPayload)&&(this.pushPayload=$.pushPayload),i($.needPush)&&(this.needPush=$.needPush===!0?1:0),i($.needBadge)&&(this.needBadge=$.needBadge===!0?1:0)}k.reverse=function($){var L=g({},$);return i($.needBadge)&&(L.needBadge=+$.needBadge==1),i($.needPush)&&(L.needPush=+$.needPush==1),L.body=+$.body,L.time=+$.time,L},t.exports=k},function(t,r,e){t.exports=e(817)},function(t,r,e){var n=e(757),g=e(37),y=e(0);function i(k,$){n(k.type)||y.onParamError("Collect.type只能是整数",$),y.notundef(k.uniqueId)&&(this.uniqueId=k.uniqueId),this.type=k.type,this.data=k.data||"",this.custom=k.custom||""}i.reverse=function(k){var $=g({},k);return $.type=+$.type,$.createTime=+$.createTime,$.updateTime=+$.updateTime,$},t.exports=i},function(t,r,e){var n=e(825),g=e(826),y=e(753),i=e(827);t.exports=function(k,$){return n(k)||g(k,$)||y(k,$)||i()},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,r,e){var n=e(761),g=e(762),y=e(763),i=e(764);function k(V,z,re){var ie=V;return g(z)?(re=z,typeof V=="string"&&(ie={uri:V})):ie=i(z,{uri:V}),ie.callback=re,ie}function $(V,z,re){return L(z=k(V,z,re))}function L(V){if(V.callback===void 0)throw new Error("callback argument missing");var z=!1,re=function(dr,Dt,lr){z||(z=!0,V.callback(dr,Dt,lr))};function ie(){var dr=void 0;if(dr=qe.response?qe.response:qe.responseText||function(Dt){try{if(Dt.responseType==="document")return Dt.responseXML;var lr=Dt.responseXML&&Dt.responseXML.documentElement.nodeName==="parsererror";if(Dt.responseType===""&&!lr)return Dt.responseXML}catch{}return null}(qe),Et)try{dr=JSON.parse(dr)}catch{}return dr}function ue(dr){return clearTimeout(de),dr instanceof Error||(dr=new Error(""+(dr||"Unknown XMLHttpRequest Error"))),dr.statusCode=0,re(dr,ir)}function le(){if(!ae){var dr;clearTimeout(de),dr=V.useXDR&&qe.status===void 0?200:qe.status===1223?204:qe.status;var Dt=ir,lr=null;return dr!==0?(Dt={body:ie(),statusCode:dr,method:ze,headers:{},url:Ne,rawRequest:qe},qe.getAllResponseHeaders&&(Dt.headers=y(qe.getAllResponseHeaders()))):lr=new Error("Internal XMLHttpRequest Error"),re(lr,Dt,Dt.body)}}var oe,ae,qe=V.xhr||null;qe||(qe=V.cors||V.useXDR?new $.XDomainRequest:new $.XMLHttpRequest);var de,Ne=qe.url=V.uri||V.url,ze=qe.method=V.method||"GET",$e=V.body||V.data,Lt=qe.headers=V.headers||{},jt=!!V.sync,Et=!1,ir={body:void 0,headers:{},statusCode:0,method:ze,url:Ne,rawRequest:qe};if("json"in V&&V.json!==!1&&(Et=!0,Lt.accept||Lt.Accept||(Lt.Accept="application/json"),ze!=="GET"&&ze!=="HEAD"&&(Lt["content-type"]||Lt["Content-Type"]||(Lt["Content-Type"]="application/json"),$e=JSON.stringify(V.json===!0?$e:V.json))),qe.onreadystatechange=function(){qe.readyState===4&&setTimeout(le,0)},qe.onload=le,qe.onerror=ue,qe.onprogress=function(){},qe.onabort=function(){ae=!0},qe.ontimeout=ue,qe.open(ze,Ne,!jt,V.username,V.password),jt||(qe.withCredentials=!!V.withCredentials),!jt&&V.timeout>0&&(de=setTimeout(function(){if(!ae){ae=!0,qe.abort("timeout");var dr=new Error("XMLHttpRequest timeout");dr.code="ETIMEDOUT",ue(dr)}},V.timeout)),qe.setRequestHeader)for(oe in Lt)Lt.hasOwnProperty(oe)&&qe.setRequestHeader(oe,Lt[oe]);else if(V.headers&&!function(dr){for(var Dt in dr)if(dr.hasOwnProperty(Dt))return!1;return!0}(V.headers))throw new Error("Headers cannot be set on an XDomainRequest object");return"responseType"in V&&(qe.responseType=V.responseType),"beforeSend"in V&&typeof V.beforeSend=="function"&&V.beforeSend(qe),qe.send($e||null),qe}t.exports=$,t.exports.default=$,$.XMLHttpRequest=n.XMLHttpRequest||function(){},$.XDomainRequest="withCredentials"in new $.XMLHttpRequest?$.XMLHttpRequest:n.XDomainRequest,function(V,z){for(var re=0;re<V.length;re++)z(V[re])}(["get","put","post","patch","head","delete"],function(V){$[V==="delete"?"del":V]=function(z,re,ie){return(re=k(z,re,ie)).method=V.toUpperCase(),L(re)}})},function(t,r,e){(function(n){var g;g=typeof window<"u"?window:n!==void 0?n:typeof self<"u"?self:{},t.exports=g}).call(this,e(73))},function(t,r){t.exports=function(n){if(!n)return!1;var g=e.call(n);return g==="[object Function]"||typeof n=="function"&&g!=="[object RegExp]"||typeof window<"u"&&(n===window.setTimeout||n===window.alert||n===window.confirm||n===window.prompt)};var e=Object.prototype.toString},function(t,r){var e=function(n){return n.replace(/^\s+|\s+$/g,"")};t.exports=function(n){if(!n)return{};for(var g,y={},i=e(n).split(`
`),k=0;k<i.length;k++){var $=i[k],L=$.indexOf(":"),V=e($.slice(0,L)).toLowerCase(),z=e($.slice(L+1));y[V]===void 0?y[V]=z:(g=y[V],Object.prototype.toString.call(g)==="[object Array]"?y[V].push(z):y[V]=[y[V],z])}return y}},function(t,r){t.exports=function(){for(var n={},g=0;g<arguments.length;g++){var y=arguments[g];for(var i in y)e.call(y,i)&&(n[i]=y[i])}return n};var e=Object.prototype.hasOwnProperty},function(t,r,e){var n=e(22),g=e(126),y=e(6),i=e(8);function k($){var L=this,V=$.url||null;L.level={debug:0,log:1,info:2,warn:3,error:4}[$.level]||0,L.logCache=[],L.logNum=1,L.timeInterval=5e3,window.onerror=function(z,re,ie,ue,le){L.error(le)},g(function(){L.logCache.length>0&&V&&L.postLogs(V,L.logCache)},L.timeInterval)}k.prototype.debug=function(){var $;this.level>0||(console.debug.apply(this,arguments),this.cacheLogs.apply(this,y($=["[degbug]"]).call($,arguments)))},k.prototype.log=function(){var $;this.level>1||(console.log.apply(this,arguments),this.cacheLogs.apply(this,y($=["[log]"]).call($,arguments)))},k.prototype.info=function(){var $;this.level>2||(console.info.apply(this,arguments),this.cacheLogs.apply(this,y($=["[info]"]).call($,arguments)))},k.prototype.warn=function(){var $;this.level>3||(console.warn.apply(this,arguments),this.cacheLogs.apply(this,y($=["[warn]"]).call($,arguments)))},k.prototype.error=function(){var $;this.level>4||(console.error.apply(this,arguments),this.cacheLogs.apply(this,y($=["[error]"]).call($,arguments)))},k.prototype.cacheLogs=function($,L){for(var V=[],z=0;z<L.length;z++){var re=L[z];n(re)==="object"?V.push(i(re)):V.push(re)}var ie=this.logNum+++" "+$+" "+V.join("; ");this.logCache.push(ie.replace("%c",""))},k.prototype.postLogs=function($,L){var V=this,z=new XMLHttpRequest;z.onreadystatechange=function(){z.readyState===4&&(z.status===200?(console.info("LoggerPlugin::日志上报完成"),V.logCache=[],V.timeInterval=5e3):V.timeInterval+=5e3)},z.open("POST",$),z.setRequestHeader("Content-Type","plain/text;charset=utf-8"),z.timeout=360,z.send(L.join(`
`))},t.exports=k},function(t,r,e){var n=e(3),g=e(45);t.exports=function(y){var i,k,$,L;y.db&&(g.db=y.db),y.rnfs&&(g.rnfs=y.rnfs,g.rnfs.size||(g.rnfs.size=1048576),g.rnfs.nimPromise=(i=g.rnfs,k=i.size/2-256,L=0,$=g.rnfs.DocumentDirectoryPath+"/nimlog_"+L+".log",i.exists($).then(function(V){return V?i.stat($):n.reject(0)}).then(function(V){return V&&V.size>k?n.reject(1):n.reject(0)}).catch(function(V){return typeof V=="number"&&(i.nimIndex=V),n.resolve()})))}},function(t,r,e){var n=e(48),g=e(0),y=g.notundef,i=g.undef;function k($){y($.name)&&(this.name=""+$.name),y($.announcement)&&(this.announcement=""+$.announcement),y($.broadcastUrl)&&(this.broadcastUrl=""+$.broadcastUrl),y($.custom)&&(this.custom=""+$.custom),y($.queuelevel)&&(this.queuelevel=n($.queuelevel))}k.reverse=function($){var L=g.copy($);return i(L.announcement)&&(L.announcement=""),i(L.broadcastUrl)&&(L.broadcastUrl=""),i(L.custom)&&(L.custom=""),y(L.createTime)&&(L.createTime=+L.createTime),y(L.updateTime)&&(L.updateTime=+L.updateTime),y(L.onlineMemberNum)&&(L.onlineMemberNum=+L.onlineMemberNum),y(L.mute)&&(L.mute=L.mute==="1"),L},t.exports=k},function(t,r,e){var n,g,y;t.exports=(y=e(94),g=(n=y).lib.WordArray,n.enc.Base64={stringify:function(i){var k=i.words,$=i.sigBytes,L=this._map;i.clamp();for(var V=[],z=0;z<$;z+=3)for(var re=(k[z>>>2]>>>24-z%4*8&255)<<16|(k[z+1>>>2]>>>24-(z+1)%4*8&255)<<8|k[z+2>>>2]>>>24-(z+2)%4*8&255,ie=0;ie<4&&z+.75*ie<$;ie++)V.push(L.charAt(re>>>6*(3-ie)&63));var ue=L.charAt(64);if(ue)for(;V.length%4;)V.push(ue);return V.join("")},parse:function(i){var k=i.length,$=this._map,L=this._reverseMap;if(!L){L=this._reverseMap=[];for(var V=0;V<$.length;V++)L[$.charCodeAt(V)]=V}var z=$.charAt(64);if(z){var re=i.indexOf(z);re!==-1&&(k=re)}return function(ie,ue,le){for(var oe=[],ae=0,qe=0;qe<ue;qe++)if(qe%4){var de=le[ie.charCodeAt(qe-1)]<<qe%4*2,Ne=le[ie.charCodeAt(qe)]>>>6-qe%4*2,ze=de|Ne;oe[ae>>>2]|=ze<<24-ae%4*8,ae++}return g.create(oe,ae)}(i,k,L)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="},y.enc.Base64)},function(t,r,e){var n,g,y,i,k,$,L,V;t.exports=(V=e(94),e(894),e(895),g=(n=V).lib,y=g.Base,i=g.WordArray,k=n.algo,$=k.MD5,L=k.EvpKDF=y.extend({cfg:y.extend({keySize:4,hasher:$,iterations:1}),init:function(z){this.cfg=this.cfg.extend(z)},compute:function(z,re){for(var ie,ue=this.cfg,le=ue.hasher.create(),oe=i.create(),ae=oe.words,qe=ue.keySize,de=ue.iterations;ae.length<qe;){ie&&le.update(ie),ie=le.update(z).finalize(re),le.reset();for(var Ne=1;Ne<de;Ne++)ie=le.finalize(ie),le.reset();oe.concat(ie)}return oe.sigBytes=4*qe,oe}}),n.EvpKDF=function(z,re,ie){return L.create(ie).compute(z,re)},V.EvpKDF)},function(t,r,e){e(299);var n=e(40);e(311)(n),t.exports=n},function(t,r,e){var n=e(48),g=e(3),y=e(15),i=e(8),k=e(2),$=e(6),L=e(306),V=e(9),z=e(16),re=e(64),ie=e(200),ue=e(304),le=e(772),oe=e(0),ae=e(307),qe=e(41),de=qe.newSupportDBError,Ne=qe.noDBError,ze=!1;function $e(Et){ze=Et,ae.set("db",Et,ue)}if($e(!!oe.getGlobal().indexedDB),re.name==="IE"&&$e(!1),re.name==="Microsoft Edge"&&$e(!1),re.name==="Safari")try{n(re.version.split(".")[0],10)<10&&$e(!1)}catch{}function Lt(Et){this.concurrency=0,this.pendingTasks=[],this.queue=g.resolve(),this.logger=Et.logger,this.reporter=Et.reporter,this.core=Et.core,this.account=Et.account,this.notifyError=Et.notifyError}var jt=Lt.prototype;jt.reset=oe.emptyFunc,ze&&(jt.reset=function(Et){this.enable=Et!==!1}),jt.addTask=function(Et){var ir=this;return new g(function(dr,Dt){function lr(sr){ir.concurrency--;var er=ir.pendingTasks.shift();er&&ir.addTask(er),sr()}if(ir.concurrency<100)return ir.concurrency++,Et().then(function(sr){lr(function(){dr(sr),Et.resolve&&Et.resolve(sr)})},function(sr){lr(function(){var er=(sr=sr||{}).event||sr,cr={event:er,callFunc:sr.callFunc||"db::addTask"};ir.logger.error("db::error event is",er,oe.get(er,"target.error")),Dt(cr),Et.reject&&Et.reject(cr)})});Et.resolve||(Et.resolve=dr,Et.reject=Dt),ir.pendingTasks.push(Et)})},jt.reportError=function(Et){var ir=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},dr=arguments.length>2?arguments[2]:void 0;this.reporter.reportTraceStart("exceptions",{user_id:this.account,trace_id:oe.get(this.core,"socket.socket.sessionid"),action:4,exception_service:0});var Dt,lr=ir.context||"";if(dr)try{var sr;Dt=y(sr=i(dr)).call(sr,0,100),lr+=". ".concat(Dt)}catch{Dt=""}var er=oe.get(Et,"code")||oe.get(Et,"target.error.code")||0,cr=oe.get(Et,"message")||oe.get(Et,"target.error.message")||"unknown";this.reporter.reportTraceUpdateV2("exceptions",{code:er,description:cr,operation_type:ir.operation_type,target:ir.target||this.name,context:lr}),this.reporter.reportTraceEnd("exceptions",1)},jt.init=function(Et){var ir=this;return ir.addTask(function(){return ir.enable?ir.server?g.resolve():(ir.name="nim-"+Et,ue.open({server:ir.name,version:le.version,schema:le.schema}).then(function(dr){ir.logger.info("db::init: ".concat(ir.name)),ir.server=dr},function(dr){throw $e(!1),ir.server=null,ir.name=null,dr}).catch(function(dr){throw ir.reportError(dr,{operation_type:0,context:"version ".concat(le.version),target:"nim-"+Et}),dr})):g.reject(de({callFunc:"db::init"}))})},jt.destroy=function(){var Et=this;return Et.addTask(function(){if(!Et.enable)return g.reject(de({callFunc:"db::destroy"}));if(!Et.server)return g.resolve();try{return ue.remove(Et.name).then(function(){Et.logger.info("db::destroy: ".concat(Et.name)),Et.server=null,Et.name=null}).catch(function(ir){throw Et.reportError(ir,{operation_type:1,context:"remove database failed"}),ir})}catch(ir){throw Et.reportError(ir,{operation_type:1,context:"remove database failed"}),ir}})},jt.clear=function(){var Et=this;return Et.addTask(function(){return Et.enable?Et.server?Et.server.clear("timetag").then(function(){var ir=y([]).call(Et.server.getIndexedDB().objectStoreNames),dr=[];if(k(ir).call(ir,function(Dt){dr.push(Et.server.clear(Dt).catch(function(lr){throw Et.reportError(lr,{operation_type:3,context:"tableName: ".concat(Dt,". clear table failed")}),lr}))}),dr.length)return g.all(dr).then(function(){Et.logger.info("db::clear: ".concat(Et.name))}).catch(function(Dt){return Et.logger.error("db::clear: ",Dt),g.reject(Dt)})}):g.resolve():g.reject(de({callFunc:"db::clear"}))})},jt.close=function(){this.server&&(this.server.close(),this.server=null,this.name=null)},jt.remove=function(Et,ir,dr,Dt,lr,sr,er){var cr=this;return cr.addTask(function(){cr.checkDB();try{return cr.server.remove(Et,ir,dr,Dt,lr,sr,er).then(function(){var or;cr.logger.info($(or="db::delete: ".concat(Et," ")).call(or,ir||dr))}).catch(function(or){throw cr.reportError(or,{operation_type:3,context:"tableName: ".concat(Et,", remove failed")},{name:Et,keys:ir,keyName:dr,lowerBound:Dt,upperBound:lr,lowerOpen:sr,upperOpen:er}),cr.logger.error("db::remove::server.remove error",or),or})}catch(or){throw cr.reportError(or,{operation_type:3,context:"tableName: ".concat(Et,", remove failed")},{name:Et,keys:ir,keyName:dr,lowerBound:Dt,upperBound:lr,lowerOpen:sr,upperOpen:er}),cr.logger.error("db::remove::server.remove error",or),or}})},jt.put=function(Et,ir){var dr=this;return dr.addTask(function(){dr.checkDB(),oe.isArray(ir)||(ir=[ir]);try{return dr.server.update(Et,ir).then(function(Dt){var lr=[Et],sr=le.keyPath(Et),er=[];return sr&&(k(Dt).call(Dt,function(cr){er.push(ie(cr,sr))}),lr.push(er.length===1?er[0]:er)),lr.unshift("db::put:"),Et==="timetag"&&lr.push(Dt[0]),dr.logger.log.apply(dr.logger.log,lr),Dt}).catch(function(Dt){throw dr.reportError(Dt,{operation_type:3,context:"tableName: ".concat(Et,". put failed")},ir),Dt})}catch(Dt){throw dr.reportError(Dt,{operation_type:3,context:"tableName: ".concat(Et,". put failed")},ir),Dt}})},jt.get=function(Et,ir){var dr=this;return dr.addTask(function(){dr.checkDB();try{return dr.server.get(Et,ir).catch(function(lr){var sr;throw dr.reportError(lr,{operation_type:3,context:$(sr="tableName: ".concat(Et,". get failed with key ")).call(sr,ir)}),lr})}catch(lr){var Dt;throw dr.reportError(lr,{operation_type:3,context:$(Dt="tableName: ".concat(Et,". get failed with key ")).call(Dt,ir)}),lr}})},jt.modifyOrPut=function(Et){var ir=this,dr=Et.table,Dt=oe.copy(Et.obj),lr=Et.key,sr=Et.modifyObjWhenPut,er=oe.copy(Dt);return delete er[lr],ir.getOne(dr,null,Dt[lr],{modifyObj:er}).then(function(cr){return cr?(er.idClient?er={idClient:er.idClient,server:er.server,pinFrom:er.pinFrom}:(er.lastMsg=er.lastMsg&&er.lastMsg.idServer+"_"+er.lastMsg.idClient,er.localCustom=er.localCustom&&"***",er.topCustom=er.topCustom&&"***"),ir.logger.log("db::modifyOrPut: update table ".concat(dr),er),cr):(Dt=oe.merge(Dt,sr),ir.put(dr,Dt).then(function(or){return or[0]}))})},jt.updateAndDelete=function(Et,ir,dr){var Dt=this;return Dt.addTask(function(){Dt.checkDB();try{return Dt.server.updateAndDelete(Et,ir,dr).catch(function(lr){throw Dt.reportError(lr,{operation_type:3,context:"tableName: ".concat(Et,". updateAndDelete failed")},{updates:ir,deletes:dr}),lr})}catch(lr){throw Dt.reportError(lr,{operation_type:3,context:"tableName: ".concat(Et,". updateAndDelete failed")},{updates:ir,deletes:dr}),lr}})},jt.getAll=function(Et,ir){var dr=this;return dr.addTask(function(){dr.checkDB(),(ir=ir||{}).keys=L(ir)===!0,ir.desc=ir.desc===!0,ir.distinct=ir.distinct===!0;try{var Dt,lr,sr;return V(Dt=L(lr=z(sr=dr.server.query(Et,ir.index)).call(sr,z(ir))).call(lr,L(ir)).desc(ir.desc).limit(ir.limit).distinct(ir.distinct)).call(Dt,ir.mapper).modify(ir.modifyObj).execute().catch(function(er){throw dr.reportError(er,{operation_type:3,context:"tableName: ".concat(Et,". getAll failed")},ir),er})}catch(er){throw dr.reportError(er,{operation_type:3,context:"tableName: ".concat(Et,". getAll failed")},ir),er}})},jt.getOnly=function(Et,ir,dr,Dt){var lr=this;return lr.addTask(function(){lr.checkDB(),(Dt=Dt||{}).keys=L(Dt)===!0,Dt.desc=Dt.desc===!0,Dt.distinct=Dt.distinct===!0,Dt.remove=Dt.remove===!0;try{var sr,er,cr;return V(sr=L(er=z(cr=lr.server.query(Et,ir).only(dr)).call(cr,z(Dt))).call(er,L(Dt)).desc(Dt.desc).limit(Dt.limit).distinct(Dt.distinct)).call(sr,Dt.mapper).modify(Dt.modifyObj).remove(Dt.remove).execute().catch(function(pr){var Sr,Er;throw lr.reportError(pr,{operation_type:3,context:$(Sr=$(Er="tableName: ".concat(Et,". getOnly failed with index: ")).call(Er,ir,", matchValue: ")).call(Sr,dr)},Dt),pr})}catch(pr){var or,hr;throw lr.reportError(pr,{operation_type:3,context:$(or=$(hr="tableName: ".concat(Et,". getOnly failed with index: ")).call(hr,ir,", matchValue: ")).call(or,dr)},Dt),pr}})},jt.getOne=function(){var Et=this;return Et.getOnly.apply(Et,arguments).then(function(ir){return ir[0]})},jt.clearTable=function(Et){var ir=this;return ir.addTask(function(){ir.checkDB();try{return ir.server.clear(Et).catch(function(dr){throw ir.reportError(dr,{operation_type:3,context:"tableName: ".concat(Et,". clearTable failed")},options),dr})}catch(dr){throw ir.reportError(dr,{operation_type:3,context:"tableName: ".concat(Et,". clearTable failed")},options),dr}})},jt.checkDB=function(){if(!this.enable)throw de({callFunc:"db::checkDB"});if(!this.server)throw Ne({callFunc:"db::checkDB"})},t.exports=Lt},function(t,r){var e={version:13},n={kv:{key:{keyPath:"key"}},timetag:{key:{keyPath:"name"}},sessionsWithMoreRoaming:{key:{keyPath:"id"}},msgReadDetail:{key:{keyPath:"idClient"}},blacklist:{key:{keyPath:"account"}},mutelist:{key:{keyPath:"account"}},friend:{key:{keyPath:"account"}},user:{key:{keyPath:"account"}},team:{key:{keyPath:"teamId"}},teamMember:{key:{keyPath:"id"},indexes:{teamId:{unique:!1},account:{unique:!1}}},superTeam:{key:{keyPath:"teamId"}},superTeamMember:{key:{keyPath:"id"},indexes:{teamId:{unique:!1},account:{unique:!1},id:{unique:!1}}},msg:{key:{autoIncrement:!0},indexes:{idClient:{unique:!0},sessionId:{unique:!1},time:{unique:!1},type:{unique:!1},sessionType:{unique:!1},status:{unique:!1},sessionTime:{key:["sessionId","time"],unique:!1}}},msg1:{key:{keyPath:"idClient"},indexes:{threadMsgIdClient:{unique:!1},sessionId:{unique:!1},time:{unique:!1},status:{unique:!1},sessionTime:{key:["sessionId","time"],unique:!1}}},msgPin:{key:{keyPath:"idClient"},indexes:{sessionId:{unique:!1}}},broadcastMsg:{key:{keyPath:"broadcastId"},indexes:{time:{unique:!1}}},sysMsg:{key:{autoIncrement:!0},indexes:{idServer:{unique:!0},category:{unique:!1},type:{unique:!1}}},sysMsgUnread:{key:{keyPath:"type"}},session:{key:{keyPath:"id"},indexes:{updateTime:{unique:!1}}}};e.keyPath=function(g){return n[g].key.keyPath},e.schema=function(){return window._nimForceSyncIM=!0,n},t.exports=e},function(t,r,e){var n=e(75).fn;n.setKey=function(g,y){return this.put("kv",{key:g,value:y})},n.getKey=function(g){return this.get("kv",g).then(function(y){return y&&y.value})},n.setDonnop=function(g){return this.setKey("donnop",g)},n.getDonnop=function(){return this.getKey("donnop")}},function(t,r,e){var n=e(7),g=e(48),y=e(75).fn;y.getTimetags=function(i){var k={};return this.getAll("timetag",{filter:i,mapper:function($){return k[$.name]=$.value,$}}).then(function(){return k})},y.getTeamMemberTimetags=function(){return this.getTimetags(function(i){var k;return n(k=i.name).call(k,"team-")!==-1})},y.getSuperTeamMemberTimetags=function(){return this.getTimetags(function(i){var k;return n(k=i.name).call(k,"superTeam-")!==-1})},y.getTimetag=function(i){return this.getOne("timetag",null,i).then(function(k){return(k=k||{value:0}).value})},y.getTeamMemberTimetag=function(){return 0},y.updateTimetag=function(i,k){var $=this,L={name:i,value:k};return this.put("timetag",L).catch(function(V){$.notifyError&&$.notifyError(V)})},y.updateMyInfoTimetag=function(i){return this.updateTimetag("myInfo",i)},y.updateRelationTimetag=function(i){return this.updateTimetag("relations",i)},y.getRelationsTimetag=function(){return this.getTimetag("relations")},y.updateFriendTimetag=function(i){return this.updateTimetag("friends",i)},y.getFriendsTimetag=function(){return this.getTimetag("friends")},y.updateFriendUserTimetag=function(i){return this.updateTimetag("friendUsers",i)},y.updateTeamTimetag=function(i){return this.updateTimetag("teams",i)},y.getTeamsTimetag=function(){return this.getTimetag("teams")},y.updateSuperTeamTimetag=function(i){return this.updateTimetag("superTeams",i)},y.getSuperTeamsTimetag=function(){return this.getTimetag("superTeams")},y.updateTeamMemberTimetag=function(i,k){return this.updateTimetag("team-"+i,k)},y.getTeamMembersTimetag=function(i){return this.getTimetag("team-"+i)},y.updateSuperTeamMemberTimetag=function(i,k){return this.updateTimetag("superTeam-"+i,k)},y.getSuperTeamMembersTimetag=function(i){return this.getTimetag("superTeam-"+i)},y.updateMyTeamMembersTimetag=function(i){return this.updateTimetag("myTeamMembers",i)},y.updateMySuperTeamMembersTimetag=function(i){return this.updateTimetag("myInfoInSuperTeams",i)},y.getBroadcastMsgTimetag=function(){return this.getTimetag("broadcastMsg")},y.updateBroadcastMsgTimetag=function(i){return this.updateTimetag("broadcastMsg",g(i))},y.updateRoamingMsgTimetag=function(i){return this.updateTimetag("roamingMsgs",i)},y.updateSuperTeamRoamingMsgTimetag=function(i){return this.updateTimetag("superTeamRoamingMsgs",i)},y.updateMsgReceiptsTimetag=function(i){return this.updateTimetag("msgReceipts",i)},y.updateDonnopTimetag=function(i){return this.updateTimetag("donnop",i)},y.updateSessionAck=function(i){return this.updateTimetag("sessionAck",i)},y.updateDeleteMsgSelf=function(i){return this.updateTimetag("deleteMsgSelf",i)},y.updateSuperTeamSessionAck=function(i){return this.updateTimetag("superTeamSessionAck",i)},y.deleteTimetag=function(i){return this.remove("timetag",i)},y.deleteTeamMemberTimetag=function(i){return this.deleteTimetag("team-"+i)},y.deleteSuperTeamMemberTimetag=function(i){return this.deleteTimetag("superTeam-"+i)}},function(t,r,e){var n=e(3),g=e(75).fn,y=e(0);g.mergeRelations=function(i,k,$,L,V){var z=this,re=z.updateAndDelete("blacklist",i,k),ie=z.updateAndDelete("mutelist",$,L);return n.all([re,ie]).then(function(){return z.logger.info("db::mergeRelations: timetag ".concat(V)),z.updateRelationTimetag(V),[i,k,$,L,V]})},g.getRelations=function(){var i=this.getAll("blacklist"),k=this.getAll("mutelist");return n.all([i,k])},g.markInBlacklist=function(i){if((i=y.copy(i)).isAdd){var k=i.record;return this.put("blacklist",k)}var $=i.account;return this.remove("blacklist",$)},g.markInMutelist=function(i){if((i=y.copy(i)).isAdd){var k=i.record;return this.put("mutelist",k)}var $=i.account;return this.remove("mutelist",$)}},function(t,r,e){var n=e(9),g=e(3),y=e(123),i=e(75).fn,k=e(0);i.mergeFriends=function($,L,V){var z=this;return z.updateAndDelete("friend",$,L).then(function(){return z.logger.log("db::mergeFriends: updateAndDelete done",$&&n($).call($,function(re){return re.account}).join(",")),V&&z.updateFriendTimetag(V),[$,L,V]})},i.putFriend=function($){return this.put("friend",$)},i.updateFriend=function($){var L=this,V=($=k.copy($)).account;return this.getOne("friend",null,V,{modifyObj:$}).then(function(z){return z?L.logger.log("db::updateFriend: ".concat(V)):L.logger.warn("db::updateFriend: no record ".concat(V)),z})},i.deleteFriend=function($){var L=this.remove("friend",$),V=this.deleteUser($);return g.all([L,V])},i.getFriends=function(){var $,L=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},V={};L.accountIds!==void 0&&(V=y($=L.accountIds).call($,function(re,ie){return re[ie]=!0,re},{}));var z=function(re){return!!re.valid&&!(L.updateTime!==void 0&&re.updateTime<=L.updateTime)&&!(L.accountIds!==void 0&&!V[re.account])};return this.getAll("friend",{filter:z})},i.getFriend=function($){return this.getOne("friend",null,$)},i.getUserFromBlackList=function($){return this.getOne("blacklist",null,$)}},function(t,r,e){var n=e(3),g=e(2),y=e(6),i=e(123),k=e(9),$=e(75).fn,L=e(0),V=e(41),z=e(194),re=e(152);function ie(oe){return oe.valid&&oe.validToCurrentUser}function ue(oe){return oe&&oe.valid}function le(oe){return oe&&L.fillUndef(oe,{mute:!1,custom:""}),oe}$.mergeTeams=function(oe,ae,qe){var de=this,Ne=de.put("team",oe),ze=de.leaveTeams(ae,qe);return n.all([Ne,ze]).then(function(){return de.logger.log("db::mergeTeams:"),de.updateTeamTimetag(qe),[oe,ae,qe]})},$.putTeam=function(oe){if(oe)return L.isArray(oe)||(oe=[oe]),g(oe).call(oe,function(ae){ae.validToCurrentUser=!0}),this.put("team",oe)},$.updateTeam=function(oe){var ae=this,qe=(oe=L.copy(oe)).teamId;return ae.getOne("team",null,qe,{modifyObj:oe}).then(function(de){if(de)ae.logger.log("db::updateTeam: ".concat(qe));else if(ae.logger.warn("db::updateTeam: no record ".concat(qe)),oe.validToCurrentUser)return ae.putTeam(oe);return de})},$.transferTeam=function(oe,ae,qe){var de=this,Ne=oe.teamId,ze=oe.memberUpdateTime,$e={teamId:Ne,account:ae,type:"normal",updateTime:ze},Lt={teamId:Ne,account:qe,type:"owner",updateTime:ze};return de.updateTeamMembers([$e,Lt]).then(function(){return de.putTeam(oe).then(function(){var jt,Et;return de.logger.info(y(jt=y(Et="db::transferTeam: ".concat(oe.teamId," ")).call(Et,ae," -> ")).call(jt,qe)),[oe,ae,qe]})})},$.leaveTeam=function(oe){var ae=this;return ae.updateTeam({teamId:oe,validToCurrentUser:!1}).then(function(){return ae.removeAllTeamMembers(oe)})},$.dismissTeam=function(oe,ae){var qe=this,de={teamId:oe,valid:!1,validToCurrentUser:!1,updateTime:ae};return qe.updateTeam(de).then(function(){return qe.removeAllTeamMembers(oe)})},$.leaveTeams=function(oe,ae){var qe,de=this,Ne=[];return g(oe).call(oe,function(ze){qe=de.leaveTeam(ze.teamId,ae),Ne.push(qe)}),n.all(Ne)},$.getTeamsByTeamIds=function(oe){var ae,qe=this,de=[];return g(oe).call(oe,function(Ne){ae=qe.getTeam(Ne),de.push(ae)}),n.all(de)},$.getTeam=function(oe){oe=""+oe;var ae=this;return ae.getOne("team",null,oe).then(function(qe){return qe?(ae.updateTeamProperties([qe]),qe):null})},$.getTeams=function(){var oe,ae=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},qe={};ae.teamIds!==void 0&&(qe=i(oe=ae.teamIds).call(oe,function(Ne,ze){return Ne[ze]=!0,Ne},{}));var de=function(Ne){return!!ie(Ne)&&!(ae.teamIds!==void 0&&!qe[Ne.teamId])};return this.getAll("team",{filter:de})},$.updateTeamProperties=function(oe){g(oe).call(oe,function(ae){ae&&z.fillProperties(ae)})},$.mergeTeamMembers=function(oe,ae,qe,de){var Ne=this,ze=Ne.putTeamMembers(ae),$e=Ne.updateTeamMembers(qe);return n.all([ze,$e]).then(function(){return Ne.logger.log("db::mergeTeamMembers: ".concat(oe)),Ne.updateTeamMemberTimetag(oe,de)})},$.putTeamMembers=function(oe){return this.put("teamMember",oe)},$.getTeamMembersByAccount=function(oe){return this.getOnly("teamMember","account",oe,{filter:ue,mapper:le}).then()},$.getTeamMembers=function(){var oe,ae=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},qe={};ae.accountIds!==void 0&&(qe=i(oe=ae.accountIds).call(oe,function($e,Lt){return $e[Lt]=!0,$e},{}));var de,Ne={};ae.teamIds!==void 0&&(Ne=i(de=ae.teamIds).call(de,function($e,Lt){return $e[Lt]=!0,$e},{}));var ze=function($e){return!!$e.valid&&!(ae.teamIds!==void 0&&!Ne[$e.teamId])&&!(ae.accountIds!==void 0&&!qe[$e.account])};return this.getAll("teamMember",{filter:ze})},$.getTeamMembersByTeamId=function(oe){return this.getOnly("teamMember","teamId",oe,{filter:ue,mapper:le})},$.getTeamMembersById=function(oe){return this.getOnly("teamMember",null,oe,{filter:ue,mapper:le})},$.updateTeamMemberProperties=function(oe){var ae,qe=this,de=[];return g(oe).call(oe,function(Ne){re.fillProperties(Ne)&&(ae=qe.updateTeamMember(Ne),de.push(ae))}),n.all(de)},$.getInvalidTeamMembers=function(oe,ae){var qe=this;oe=""+oe;var de,Ne=[];return g(ae).call(ae,function(ze){de=qe.getOne("teamMember",null,re.genId(oe,ze)).then(function($e){return le($e)}),Ne.push(de)}),n.all(Ne)},$.updateTeamMember=function(oe){var ae=this,qe=oe.teamId,de=oe.account,Ne=re.genId(qe,de),ze=L.filterObj(oe,"nickInTeam muteTeam mute custom updateTime type valid followAccountIds");return this.getOne("teamMember",null,Ne,{modifyObj:ze,mapper:le}).then(function($e){var Lt,jt;return $e?ae.logger.log(y(Lt="db::updateTeamMember: ".concat(qe," ")).call(Lt,de),L.pickAsString(ze,["muteTeam","mute","updateTime","type","valid"])):ae.logger.warn(y(jt="db::updateTeam: no record ".concat(qe," ")).call(jt,de)),$e})},$.updateTeamMembers=function(oe){var ae=this;if(!oe.length)return n.resolve();var qe,de=[];return g(oe).call(oe,function(Ne){qe=ae.updateTeamMember(Ne),de.push(qe)}),n.all(de)},$.updateTeamManagers=function(oe,ae,qe,de){var Ne=k(ae).call(ae,function(ze){return{teamId:oe,account:ze,type:qe?"manager":"normal",updateTime:de}});return this.updateTeamMembers(Ne)},$.removeTeamMembersByAccounts=function(oe,ae){var qe=k(ae).call(ae,function(de){return{teamId:oe,account:de,valid:!1}});return this.updateTeamMembers(qe)},$.removeAllTeamMembers=function(oe){var ae=this;return ae.getOnly("teamMember","teamId",oe,{modifyObj:{valid:!1}}).then(function(){return ae.logger.warn("db::removeAllTeamMembers: ".concat(oe)),ae.deleteTeamMemberTimetag(oe)})},$.deleteTeamMembers=function(oe){var ae=this;return ae.getOnly("teamMember","teamId",oe,{remove:!0}).then(function(){ae.logger.warn("db::deleteTeamMembers: ".concat(oe)),ae.deleteTeamMemberTimetag(oe)})},$.deleteTeam=function(oe){var ae,qe=this,de=[];return L.isArray(oe)||(oe=[oe]),g(oe).call(oe,function(Ne){Ne=""+Ne,ae=qe.get("team",Ne).then(function(ze){if(ze&&ie(ze))throw V.stillInTeamError({callFunc:"team::deleteTeam",team:ze});var $e=qe.remove("team",Ne),Lt=qe.deleteTeamMembers(Ne);return n.all([$e,Lt])}),de.push(ae)}),de.length===1?de[0]:n.all(de)}},function(t,r,e){var n=e(3),g=e(2),y=e(10),i=e(6),k=e(9),$=e(75).fn,L=e(0),V=e(41),z=e(308),re=e(203);function ie(oe){return oe.valid&&oe.validToCurrentUser}function ue(oe){return oe&&oe.valid}function le(oe){return oe&&L.fillUndef(oe,{mute:!1,custom:""}),oe}$.mergeSuperTeams=function(oe,ae,qe){var de=this,Ne=de.put("superTeam",oe),ze=de.leaveTeams(ae,qe);return n.all([Ne,ze]).then(function(){return de.logger.log("db::mergeSuperTeams:"),de.updateSuperTeamTimetag(qe),[oe,ae,qe]})},$.putSuperTeam=function(oe){if(oe)return L.isArray(oe)||(oe=[oe]),g(oe).call(oe,function(ae){ae.validToCurrentUser=!0}),this.put("superTeam",oe)},$.updateSuperTeam=function(oe){var ae=this,qe=(oe=L.copy(oe)).teamId;return ae.getOne("superTeam",null,qe,{modifyObj:oe}).then(function(de){return de?(ae.logger.info("db::updateSuperTeam: ".concat(qe)),de):(ae.logger.warn("db::updateSuperTeam: no record ".concat(qe)),ae.putSuperTeam(oe))})},$.leaveSuperTeam=function(oe){var ae=this;return ae.updateSuperTeam({teamId:oe,validToCurrentUser:!1}).then(function(){return ae.removeAllSuperTeamMembers(oe)})},$.dismissSuperTeam=function(oe,ae){var qe=this,de={teamId:oe,valid:!1,validToCurrentUser:!1,updateTime:ae};return qe.updateSuperTeam(de).then(function(){return qe.removeAllSuperTeamMembers(oe)})},$.leaveSuperTeams=function(oe,ae){var qe,de=this,Ne=[];return g(oe).call(oe,function(ze){qe=de.leaveSuperTeam(ze.teamId,ae),Ne.push(qe)}),n.all(Ne)},$.getSuperTeamsByTeamIds=function(oe){var ae,qe=this,de=[];return g(oe).call(oe,function(Ne){ae=qe.getSuperTeam(Ne),de.push(ae)}),n.all(de)},$.getSuperTeam=function(oe){oe=""+oe;var ae=this;return ae.getOne("superTeam",null,oe).then(function(qe){return qe?(ae.updateSuperTeamProperties([qe]),qe):null})},$.getSuperTeams=function(){var oe=this;return oe.getAll("superTeam",{filter:ie}).then(function(ae){return oe.updateSuperTeamProperties(ae),ae})},$.updateSuperTeamProperties=function(oe){g(oe).call(oe,function(ae){ae&&z.fillProperties(ae)})},$.mergeSuperTeamMembers=function(oe,ae,qe,de){var Ne=this,ze=Ne.putSuperTeamMembers(ae),$e=Ne.updateSuperTeamMembers(qe);return n.all([ze,$e]).then(function(){return Ne.logger.log("db::mergeSuperTeamMembers: ".concat(oe)),de!=null?Ne.updateSuperTeamMemberTimetag(oe,de):n.resolve()})},$.getSuperTeamMembersByTeamId=function(oe){return this.getOnly("superTeamMember","teamId",oe,{filter:ue,mapper:le}).then()},$.getSuperTeamMembersById=function(oe){return this.getOnly("superTeamMember",null,oe,{filter:ue,mapper:le}).then()},$.putSuperTeamMembers=function(oe){return this.put("superTeamMember",oe)},$.getSuperTeamMemberById=function(oe){return this.get("superTeamMember",oe)},$.getSuperTeamMembers=function(oe,ae){var qe=this;oe=""+oe;var de={filter:function(Ne){return Ne.valid},mapper:le};if(ae){if(typeof ae.joinTime!="number")return void qe.logger.error("db::getSuperTeamMembers::params.joinTime should be number, not ",ae.joinTime);ae.limit&&(de.limit=ae.limit),y(ae)?de.filter=function(Ne){return Ne.valid&&Ne.joinTime<=ae.joinTime}:de.filter=function(Ne){return Ne.valid&&Ne.joinTime>=ae.joinTime}}return qe.getOnly("superTeamMember","teamId",oe,de).then(function(Ne){return qe.updateSuperTeamMemberProperties(Ne).then(function(){return Ne})})},$.getSuperTeamMembersByAccount=function(oe){return this.getOnly("superTeamMember","account",oe,{filter:ue,mapper:le}).then()},$.updateSuperTeamMemberProperties=function(oe){var ae,qe=this,de=[];return g(oe).call(oe,function(Ne){re.fillProperties(Ne)&&(ae=qe.updateSuperTeamMember(Ne),de.push(ae))}),n.all(de)},$.getInvalidSuperTeamMembers=function(oe,ae){var qe=this;oe=""+oe;var de,Ne=[];return g(ae).call(ae,function(ze){de=qe.getOne("superTeamMember","id",re.genId(oe,ze)).then(function($e){return le($e)}),Ne.push(de)}),n.all(Ne)},$.updateSuperTeamMember=function(oe){var ae=this,qe=oe.teamId,de=oe.account,Ne=re.genId(qe,de),ze=L.filterObj(oe,"nickInTeam muteTeam mute custom updateTime type valid followAccountIds");return this.getOne("superTeamMember","id",Ne,{modifyObj:ze,mapper:le}).then(function($e){var Lt,jt;return $e?ae.logger.log(i(Lt="db::updateSuperTeamMember: ".concat(qe," ")).call(Lt,de),L.pickAsString(ze,["muteTeam","mute","updateTime","type","valid"])):ae.logger.warn(i(jt="db::updateSuperTeam: no record ".concat(qe," ")).call(jt,de)),$e})},$.updateSuperTeamMembers=function(oe){var ae=this;if(!oe.length)return n.resolve();var qe,de=[];return g(oe).call(oe,function(Ne){qe=ae.updateSuperTeamMember(Ne),de.push(qe)}),n.all(de)},$.removeSuperTeamMembersByAccounts=function(oe,ae){var qe=k(ae).call(ae,function(de){return{teamId:oe,account:de,valid:!1}});return this.updateSuperTeamMembers(qe)},$.removeAllSuperTeamMembers=function(oe){var ae=this;return ae.getOnly("superTeamMember","teamId",oe,{modifyObj:{valid:!1}}).then(function(){return ae.logger.warn("db::removeAllSuperTeamMembers: ".concat(oe)),ae.deleteSuperTeamMemberTimetag(oe)})},$.deleteSuperTeamMembers=function(oe){var ae=this;return ae.getOnly("superTeamMember","teamId",oe,{remove:!0}).then(function(){ae.logger.warn("db::deleteSuperTeamMembers: ".concat(oe)),ae.deleteSuperTeamMemberTimetag(oe)})},$.deleteSuperTeam=function(oe){var ae,qe=this,de=[];return L.isArray(oe)||(oe=[oe]),g(oe).call(oe,function(Ne){Ne=""+Ne,ae=qe.get("superTeam",Ne).then(function(ze){if(ze&&ie(ze))throw V.stillInTeamError({callFunc:"team::deleteTeam",team:ze});var $e=qe.remove("superTeam",Ne),Lt=qe.deleteSuperTeamMembers(Ne);return n.all([$e,Lt])}),de.push(ae)}),de.length===1?de[0]:n.all(de)},$.transferSuperTeam=function(oe,ae,qe){var de=this;return de.updateSuperTeamMembers([ae,qe]).then(function(){return de.putSuperTeam(oe).then(function(){var Ne,ze;return de.logger.info(i(Ne=i(ze="db::transferSuperTeam: ".concat(oe.teamId," ")).call(ze,ae.account," -> ")).call(Ne,qe.account)),[oe,ae,qe]})})}},function(t,r,e){var n=e(2),g=e(3),y=e(123),i=e(75).fn,k=e(0);i.mergeMyInfo=function($,L){var V=this;return V.put("user",$).then(function(){return L?V.updateMyInfoTimetag($.updateTime):$})},i.mergeFriendUsers=function($,L){var V=this;return V.putUsers($).then(function(){V.updateFriendUserTimetag(L)})},i.putUsers=function($){return this.put("user",$)},i.putUser=function($){return this.put("user",$)},i.updateUser=function($){var L=this,V=($=k.copy($)).account;return this.getOne("user",null,V,{modifyObj:$}).then(function(z){return z?L.logger.log("db::updateUser: ".concat(V)):L.logger.warn("db::updateUser: no record ".concat(V)),z})},i.putUsersIfIsFriend=function($){var L,V=this,z=[],re=[];return n($).call($,function(ie){L=V.getFriend(ie.account).then(function(ue){return ue&&(L=V.putUser(ie),re.push(L)),ue}),z.push(L)}),g.all(z).then(function(){return g.all(re).then(function(ie){return ie})})},i.deleteUser=function($){return this.remove("user",$)},i.getUser=function($){return this.getOne("user",null,$)},i.getUsers=function(){var $,L=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},V={};L.accountIds!==void 0&&(V=y($=L.accountIds).call($,function(re,ie){return re[ie]=!0,re},{}));var z=function(re){return!(L.accountIds!==void 0&&!V[re.account])};return this.getAll("user",{filter:z})},i.getAllUsers=function(){return this.getAll("user")}},function(t,r,e){var n=e(16),g=e(3),y=e(6),i=e(2),k=e(37),$=e(32),L=e(7),V=e(122),z=e(9),re=e(75).fn,ie=e(0),ue=e(11);re.putMsg=function(le){var oe=this;return ie.isArray(le)||(le=[le]),!le.length||n(le[0])?g.resolve():(le=n(le).call(le,function(ae){return!ae.ignore}),oe.put("msg1",le).catch(function(ae){return oe.notifyError&&oe.notifyError(ae),g.resolve(le,ae)}))},re.putMsgReadDetail=function(le){var oe=this;if(le.idClient)return this.put("msgReadDetail",le).catch(function(ae){oe.logger.error("putMsgReadDetail error",ae)})},re.getMsgReadDetail=function(le){return this.getOne("msgReadDetail",null,le)},re.updateMsg=function(le){var oe=this;if(!n(le)){var ae=le.idClient,qe=ie.filterObj(le,"resend status idServer time localCustom commentTimetag comments hasSendAck callbackExt");return oe.getOne("msg1",null,ae,{modifyObj:qe}).then(function(de){var Ne,ze,$e;return de?oe.logger.info(y(Ne=y(ze=y($e="db::updateMsg: ".concat(ae,"，idServer: ")).call($e,qe.idServer,"，status: ")).call(ze,qe.status,"，time: ")).call(Ne,qe.time)):oe.logger.warn("db::updateMsg: no record ".concat(ae)),de}).catch(function(de){return oe.notifyError&&oe.notifyError(de),g.resolve(le)})}},re.updateMsgBatch=function(le){var oe=this;if(ue.isRN)this.logger.warn("react native can not support updateMsgBatch");else{this.checkDB();var ae=this.server.getIndexedDB().transaction(["msg1"],"readwrite").objectStore("msg1");i(le).call(le,function(qe){if(qe.idClient){var de=ae.get(qe.idClient);de.onerror=function(Ne){oe.logger.error("updateMsgBatch::store.get:error",Ne)},de.onsuccess=function(){var Ne=de.result||qe;ae.put(k({},Ne,qe)).onerror=function(ze){oe.logger.error("updateMsgBatch::store.put:error",ze)}}}})}},re.getMsgs=function(le){return ue.isBrowser?this.getMsgsIndexedDB(le):ue.isRN?this.getMsgsRN(le):g.resolve()},re.getSubMessages=function(le){return ue.isBrowser?this.getSubMessagesIndexedDB(le):g.resolve([])},re.getMsgsRN=function(le){var oe={};return typeof le.start=="number"&&(oe.lowerBound=["time",le.start]),typeof le.end=="number"&&le.end!==1/0&&(oe.upperBound=["time",le.end]),oe.desc=!1,oe.index="time",typeof le.desc=="boolean"&&(oe.desc=le.desc),typeof le.limit=="number"&&(oe.limit=le.limit),oe.searchIndex=[],le.sessionId&&oe.searchIndex.push(["sessionId",le.sessionId]),typeof le.type=="string"&&oe.searchIndex.push(["type",le.type]),this.getAll("msg1",oe)},re.getMsgsIndexedDB=function(le){var oe,ae=this;ae.checkDB();var qe="time",de=!1,Ne=!1,ze=(le=le||{}).sessionId||[],$e=le.sessionIds||[];ie.isString(ze)?ze=[ze]:$(ze)||(ze=[]),ie.isString($e)?$e=[$e]:$($e)||($e=[]);var Lt=y(ze).call(ze,$e);Lt.length===1?(de=!0,qe="sessionTime",ze=Lt[0]):Lt.length>1&&(de=!0,Ne=!0,$e=Lt);var jt=le.start||0,Et=le.end||1/0,ir=jt,dr=Et;de&&!Ne&&(ir=[ze,jt],dr=[ze,Et]);var Dt=le.desc!==!1,lr=le.limit||100,sr=!1,er=!1,cr=le.type||[],or=le.types||[];ie.isString(cr)?cr=[cr]:$(cr)||(cr=[]),ie.isString(or)?or=[or]:$(or)||(or=[]);var hr=y(cr).call(cr,or);hr.length===1?(sr=!0,cr=hr[0]):hr.length>1&&(sr=!0,er=!0,or=hr);var pr,Sr=le.subTypes&&le.subTypes.length,Er=le.keyword||"",Pr=le.filterFunc;return(Ne||sr||Er||Sr||ie.isFunction(Pr))&&(pr=function(Cr){var rr;if(Ne&&L($e).call($e,Cr.sessionId)===-1)return!1;if(sr){if(er){if(L(or).call(or,Cr.type)===-1)return!1}else if(cr!==Cr.type)return!1}if(Sr&&L(rr=le.subTypes).call(rr,Cr.subType)===-1)return!1;if(Er){var kr=Cr.text||Cr.tip||"";if(L(kr).call(kr,Er)===-1)return!1}return!Pr||Pr(Cr)}),n(oe=ae.server.query("msg1",qe).bound(ir,dr,!0,!0).desc(Dt).limit(lr)).call(oe,pr).execute().catch(function(Cr){throw ae.reportError(Cr,{operation_type:3,context:"tableName: ".concat("msg1",", index ").concat(qe,", getMsgsIndexedDB error")},le),Cr})},re.getSubMessagesIndexedDB=function(le){var oe=this;return oe.checkDB(),oe.getOnly("msg1","threadMsgIdClient",le).then(function(ae){var qe;return V(qe=ae||[]).call(qe,function(de,Ne){return de.time-Ne.time})}).catch(function(ae){throw oe.reportError(ae,{operation_type:3,context:"tableName: ".concat("msg1",", IndexThreadMsgIdClient ").concat(le,", getSubMessagesIndexedDB error")}),ae})},re.getMsgCountAfterAck=function(le){return ue.isBrowser?this.getMsgCountAfterAckIndexedDB(le):ue.isRN?this.getMsgCountAfterAckRN(le):g.resolve()},re.getMsgCountAfterAckRN=function(le){var oe=this,ae=le=le||{},qe=ae.sessionId,de=ae.ack;return oe.checkDB(),oe.getAll("msg1",{searchIndex:["sessionId",qe],lowerBound:["time",de]}).then(function(Ne){var ze=n(Ne).call(Ne,function($e){if($e.flow==="out"||$e.isUnreadable===!1)return!1;if($e.type==="notification")try{return le.shouldCountNotifyUnread($e)}catch(Lt){throw oe.logger.error("userOption:shouldCountNotifyUnread function error",Lt),Lt}return!0});return g.resolve(ze.length)})},re.getMsgCountAfterAckIndexedDB=function(le){var oe=this,ae=(le=le||{}).sessionId;return oe.checkDB(),oe.server.query("msg1","sessionTime").bound([ae,le.ack],[ae,1/0],!0,!0).execute().then(function(qe){var de=n(qe).call(qe,function(Ne){if(Ne.flow==="out"||Ne.isUnreadable===!1)return!1;if(Ne.type==="notification")try{return le.shouldCountNotifyUnread(Ne)}catch(ze){throw oe.logger.error("userOption:shouldCountNotifyUnread function error",ze),ze}return!0});return g.resolve(de.length)}).catch(function(qe){throw oe.reportError(qe,{operation_type:3,context:"tableName: ".concat("msg1",", IndexSessionTime ").concat("sessionTime",", getMsgCountAfterAckIndexedDB error")},le),qe})},re.amendMsg=function(le){return le?(ie.notexist(le.text)&&(le.text=""),le):null},re.getMsgByIdClient=function(le){var oe=this;return oe.getOne("msg1",null,le).then(function(ae){return oe.amendMsg(ae)})},re.getMsgsByIdClients=function(le){var oe,ae=this,qe=[];return i(le).call(le,function(de){oe=ae.getMsgByIdClient(de),qe.push(oe)}),g.all(qe)},re.clearSendingMsgs=function(){var le=this;return le.getOnly("msg1","status","sending",{modifyObj:{status:"fail"}}).then(function(oe){le.logger.info("db::clearSendingMsgs: msgs send failed",oe&&z(oe).call(oe,function(ae){return ae.idClient}).join(","))})},re.deleteMsg=function(le){var oe,ae=this,qe=[];return ie.isArray(le)||(le=[le]),i(le).call(le,function(de){oe=ae.getOne("msg1",null,de,{remove:!0}).then(function(Ne){return ae.logger.info("db::deleteMsg done",de,Ne&&Ne.idClient),Ne}).catch(function(Ne){throw ae.logger.error("db::deleteMsg failed",de,Ne),Ne}),qe.push(oe)}),qe.length===1?qe[0]:g.all(qe)},re.deleteMsgsBySessionId=function(le){var oe=this,ae=null,qe=le.start,de=le.end;return qe!==void 0&&de!==void 0?ae=function(Ne){return Ne>qe&&Ne<de}:qe!==void 0?ae=function(Ne){return Ne>qe}:de!==void 0&&(ae=function(Ne){return Ne<de}),ae?oe.getOnly("msg1","sessionId",le.sessionId).then(function(Ne){var ze=[];return z(Ne=Ne||[]).call(Ne,function($e){ae($e.time)&&ze.push($e.idClient)}),oe.logger.info("db::deleteMsgsBySessionId: session results",ze),oe.deleteMsg(ze)}):oe.getOnly("msg1","sessionId",le.sessionId,{remove:!0})},re.deleteMsgsByTime=function(le){return this.remove("msg1",null,"time",le.start,le.end,!0,!0)},re.getDeletedMsgsCountByTime=function(le){this.checkDB();var oe=this.server.getIndexedDB().transaction(["msg1"],"readonly").objectStore("msg1").index("time"),ae=IDBKeyRange.bound(le.start,le.end,!0,!0),qe=oe.count(ae);return new g(function(de,Ne){qe.onsuccess=function(ze){de(ze.target.result)},qe.onerror=function(ze){this.logger.error("countDeletedMsgsByTime::index.count:error",ze),Ne(ze)}})},re.deleteAllMsgs=function(){var le=this.clearTable("msg1"),oe=this.clearTable("session");return g.all([le,oe])},re.getMsgPins=function(le){return this.getOnly("msgPin","sessionId",le)},re.deleteMsgPins=function(le){return this.getOnly("msgPin","sessionId",le,{remove:!0})},re.putMsgPin=function(le){var oe=this;return this.modifyOrPut({table:"msgPin",obj:le,key:"idClient"}).catch(function(ae){oe.notifyError&&oe.notifyError(ae)})},re.putMsgPins=function(le){return this.put("msgPin",le)},re.deleteMsgPin=function(le){var oe=this;return this.getOne("msgPin",null,le.idClient,{remove:!0}).then(function(ae){return oe.logger.info("db::deleteMsgPin:",ae.idClient),ae})}},function(t,r,e){var n=e(3),g=e(16),y=e(2),i=e(10),k=e(4),$=e(75).fn,L=e(0),V=L.notundef;$.putSysMsg=function(z){var re=this;return new n(function(ie){if(L.isArray(z)||(z=[z]),!g(z[0])){var ue=[],le=z.length;y(z).call(z,function(ae){ae=L.copy(ae),re.put("sysMsg",ae).then(function(qe){ue.push(qe[0]),oe()},oe)})}function oe(){--le===0&&ie(ue)}})},$.getSysMsgs=function(z){var re=!i(z=z||{}),ie=z.limit||100,ue=null,le=null;z.category&&(ue="category",le=z.category),z.type&&(ue="type",le=z.type);var oe,ae=z.lastIdServer,qe=!1,de=z.read;return(V(ae)||V(de))&&(oe=function(Ne){return V(ae)?(ae=""+ae,qe?ze():(Ne.idServer===ae&&(qe=!0),!1)):ze();function ze(){return!V(de)||Ne.read===de}}),z={filter:oe,desc:re,limit:ie},ue?this.getOnly("sysMsg",ue,le,z):this.getAll("sysMsg",z)},$.getSysMsgByIdServer=function(z){return this.getOne("sysMsg","idServer",z)},$.updateSysMsg=function(z){var re=this;if(!g(z)){var ie=""+z.idServer,ue=L.filterObj(z,"read state error localCustom");return this.getOne("sysMsg","idServer",ie,{modifyObj:ue}).then(function(le){return le?re.logger.log("db::updateSysMsg: ".concat(ie),L.pickAsString(ue,["read","state","error"])):re.logger.warn("db::updateSession: ".concat(ie)),le})}},$.markSysMsgRead=function(z){var re=this;return new n(function(ie,ue){L.isArray(z)||(z=[z]);var le,oe,ae=[],qe=[];y(z).call(z,function(de){le=re.getSysMsgByIdServer(de.idServer).then(function(Ne){Ne&&!Ne.read&&(oe=re.updateSysMsg({idServer:Ne.idServer,read:!0}),qe.push(oe))},ue),ae.push(le)}),n.all(ae).then(function(){n.all(qe).then(function(de){ie(de)},ue)},ue)})},$.deleteSysMsg=function(z){var re,ie=this,ue=[];return L.isArray(z)||(z=[z]),y(z).call(z,function(le){le=""+le,re=ie.getOne("sysMsg","idServer",le,{remove:!0}),ue.push(re)}),ue.length===1?ue[0]:n.all(ue)},$.deleteAllSysMsgs=function(){var z=this.clearTable("sysMsg"),re=this.clearTable("sysMsgUnread");return n.all([z,re])},$.getSysMsgUnread=function(){return this.getAll("sysMsgUnread").then(function(z){var re={};return y(z).call(z,function(ie){re[ie.type]=ie.num}),re})},$.updateSysMsgUnread=function(z){var re,ie=this;z=L.copy(z);var ue=[];return y(re=k(z)).call(re,function(le){ue.push({type:le,num:z[le]})}),this.put("sysMsgUnread",ue).then(function(){return ie.logger.info("db::updateSysMsgUnread: ",z),z})}},function(t,r,e){var n=e(3),g=e(2),y=e(75).fn,i=e(0);y.putBroadcastMsg=function(k){var $=this;return new n(function(L){i.isArray(k)||(k=[k]);var V=[],z=k.length;function re(){--z===0&&L(V)}g(k).call(k,function(ie){ie=i.copy(ie),$.put("broadcastMsg",ie).then(function(ue){V.push(ue[0]),re()},re)})})},y.getBroadcastMsgs=function(k){return k=k||{},this.getAll("broadcastMsg",k)}},function(t,r,e){var n=e(3),g=e(10),y=e(6),i=e(32),k=e(2),$=e(75).fn,L=e(0),V=L.notundef;$.putSession=function(z){var re=this,ie=z.unread;return(z=L.merge({},z)).updateTime===void 0&&z.lastMsg&&z.lastMsg.time&&(z.updateTime=z.lastMsg.time),(z.lastMsg||!z.ack&&!z.msgReceiptTime)&&(z.isDeleted=!1),delete z.unread,this.modifyOrPut({table:"session",obj:z,key:"id",modifyObjWhenPut:{unread:0}}).catch(function(ue){return re.notifyError&&re.notifyError(ue),z.unread=ie,n.resolve(z)})},$.getAllSessions=function(){return this.getAll("session",{index:"updateTime",desc:!0}).catch(function(z){self.notifyError&&self.notifyError(z)})},$.getSessions=function(z){var re=!g(z=z||{}),ie=z.limit||100,ue=z.lastSessionId,le=z.sessionId,oe=!1,ae=this,qe=function(){return!0},de=function(){return!0};return V(le)?this.getSession(le,z.isDeleted):(V(ue)&&(qe=function(Ne){return Ne.id===ue&&(oe=!0),oe}),z.includeDeleted||(de=function(Ne){return!Ne.isDeleted}),this.getAll("session",{index:"updateTime",desc:re,limit:ie,filter:function(Ne){return qe(Ne)&&de(Ne)}}).catch(function(Ne){ae.notifyError&&ae.notifyError(Ne)}))},$.getSession=function(z,re){var ie=this;return this.get("session",z).then(function(ue){return n.resolve(!re&&ue&&ue.isDeleted?void 0:ue)}).catch(function(ue){throw ie.notifyError&&ie.notifyError(ue),ue})},$.updateSession=function(z){var re=this,ie=z.id,ue=L.filterObj(z,"ack unread lastMsg localCustom msgReceiptTime msgReceiptServerTime isTop topCustom isDeleted");return z.lastMsg&&(ue.lastMsg=z.lastMsg),this.getOne("session",null,ie,{modifyObj:ue}).then(function(le){if(le){var oe,ae=y(oe="db::updateSession: ".concat(ie," ")).call(oe,L.pickAsString(ue,["ack","unread","msgReceiptTime","msgReceiptServerTime","isTop","isDeleted"]));ae+=ue.lastMsg?" lastMsg.idClient:".concat(L.get(ue,"lastMsg.idClient")):"",re.logger.info(ae)}else re.logger.warn("db::updateSession: no record ".concat(ie));return le}).catch(function(le){re.notifyError&&re.notifyError(le)})},$.getStickTopSessions=function(){var z=this;return this.getAll("session",{filter:function(re){return re&&re.isTop}}).catch(function(re){z.notifyError&&z.notifyError(re)})},$.deleteSession=function(z,re){var ie=re&&re.scene||"";return ie==="superTeam"?this.updateSuperTeamSessionAck(0):(ie==="p2p"||ie==="team"||this.updateSuperTeamSessionAck(0),this.updateSessionAck(0)),this.updateMsgReceiptsTimetag(0),this.remove("session",z)},$.deleteSessionLogic=function(z){var re=this;if(!i(z))return this.getOne("session",null,z,{modifyObj:{isDeleted:!0}});var ie=[];return k(z).call(z,function(ue){ie.push(re.getOne("session",null,ue,{modifyObj:{isDeleted:!0}}))}),n.all(ie)},$.putSessionsWithMoreRoaming=function(z){return this.put("sessionsWithMoreRoaming",z)},$.updateSessionsWithMoreRoaming=function(z){var re=z.id;return delete z.id,this.getOne("sessionsWithMoreRoaming",null,re,{modifyObj:z})},$.deleteSessionsWithMoreRoaming=function(z){return this.remove("sessionsWithMoreRoaming",z)},$.getSessionsWithMoreRoaming=function(z){return z?this.get("sessionsWithMoreRoaming",z):this.getAll("sessionsWithMoreRoaming")}},function(t,r,e){var n=e(6),g=e(92),y=e(93),i=e(0).throttle,k=function(){function $(L){g(this,$),this.arr=[],this.timer=null,this.maxLength=L.maxLength||100,this.throttleTime=L.throttleTime||5e3,this.processFn=L.processFn||function(){},this.throttleFn=L.processFn||function(){},L.processFn&&(this.throttleFn=i(function(V){L.processFn(V),V.length=0},this.throttleTime,{leading:!1}))}return y($,[{key:"add",value:function(L){var V;Object.prototype.toString.call(L)==="[object Array]"?this.arr=n(V=this.arr).call(V,L):this.arr.push(L),this.arr.length>=this.maxLength&&(this.processFn(this.arr),this.arr=[]),this.timer=this.throttleFn(this.arr)}},{key:"destroy",value:function(){this.arr=[],this.timer&&clearTimeout(this.timer),this.processFn=function(){},this.throttleFn=function(){}}},{key:"clear",value:function(){this.arr=[],this.timer&&clearTimeout(this.timer)}}]),$}();t.exports=k},function(t,r,e){var n=e(51),g=e(37),y=e(60),i=e(2),k=e(16),$=e(4),L=e(52),V=e(53),z=e(54),re=e(55),ie=e(43),ue=e(92),le=e(93);function oe(qe,de){var Ne=$(qe);if(L){var ze=L(qe);de&&(ze=k(ze).call(ze,function($e){return V(qe,$e).enumerable})),Ne.push.apply(Ne,ze)}return Ne}var ae={user_id:"",trace_id:"",duration:0,start_time:0,history:[]};t.exports=function(){function qe(de){ue(this,qe),this.clientProto=de,this.reset()}return le(qe,[{key:"reset",value:function(){this.traceData=g({},ae),this.traceData.history=[]}},{key:"start",value:function(){this.reset(),this.traceData.start_time=y()}},{key:"updateBegin",value:function(de){this.traceData.history.push(function(Ne){for(var ze=1;ze<arguments.length;ze++){var $e,Lt,jt=arguments[ze]!=null?arguments[ze]:{};ze%2?i($e=oe(Object(jt),!0)).call($e,function(Et){n(Ne,Et,jt[Et])}):z?re(Ne,z(jt)):i(Lt=oe(Object(jt))).call(Lt,function(Et){ie(Ne,Et,V(jt,Et))})}return Ne}({head:"",body:"",start_time:y(),httpdns:!1,index:0},de))}},{key:"updateComplete",value:function(de){var Ne;i(Ne=this.traceData.history).call(Ne,function(ze){ze.target===de.target&&(g(ze,de),ze.duration=y()-ze.start_time)})}},{key:"end",value:function(de){var Ne;if(this.traceData.succeed=de,this.traceData.history=k(Ne=this.traceData.history).call(Ne,function($e){return $e.code!==void 0}),this.traceData.history.length!==0){this.traceData.duration=y()-this.traceData.start_time;var ze=this.clientProto.checkNetworkAvailable();this.traceData.net_type=0,this.traceData.net_connect=ze,this.clientProto.reporter.report("nim_sdk_lbs_records",this.traceData),this.reset()}else this.reset()}}]),qe}()},function(t,r,e){var n=e(22),g=e(51),y=e(60),i=e(8),k=e(314),$=e(6),L=e(3),V=e(24),z=e(16),re=e(7),ie=e(15),ue=e(26),le=e(2),oe=e(126),ae=e(4),qe=e(52),de=e(53),Ne=e(54),ze=e(55),$e=e(43);function Lt(or,hr){var pr=ae(or);if(qe){var Sr=qe(or);hr&&(Sr=z(Sr).call(Sr,function(Er){return de(or,Er).enumerable})),pr.push.apply(pr,Sr)}return pr}function jt(or){for(var hr=1;hr<arguments.length;hr++){var pr,Sr,Er=arguments[hr]!=null?arguments[hr]:{};hr%2?le(pr=Lt(Object(Er),!0)).call(pr,function(Pr){g(or,Pr,Er[Pr])}):Ne?ze(or,Ne(Er)):le(Sr=Lt(Object(Er))).call(Sr,function(Pr){$e(or,Pr,de(Er,Pr))})}return or}var Et=e(35).fn,ir=e(0),dr=e(11),Dt=e(157).V2NIMConnectStatus;function lr(or,hr){var pr,Sr,Er,Pr,Cr=this,rr=dr.getDefaultLinkUrl(Cr.options.secure);Cr.socketUrls=[rr],Cr.reporterHookLBS.updateComplete({target:hr,code:200,body:or}),Cr.reporterHookLBS.end(!0),Cr.reporter.reportTraceUpdateV2("login",{operation_type:"HTTP",target:hr,code:200,net_connect:Cr.checkNetworkAvailable(),succeed:!0}),Cr.msgStatEnable=!!or.common["msg.stat.enable"],Cr.msgStatEnable&&(Cr.msgDelayTimer=V(ue(Sr=Cr.doReportMsgDelay).call(Sr,Cr),1e4)),or.common&&or.common.link&&le(Er=or.common.link).call(Er,function(xr){Cr.socketUrls.unshift(dr.formatSocketUrl({url:xr,secure:Cr.options.secure}))}),or.common&&or.common["link.default"]&&le(Pr=or.common["link.default"]).call(Pr,function(xr){var vr,_r;xr=dr.formatSocketUrl({url:xr,secure:Cr.options.secure}),re(vr=Cr.socketUrls).call(vr,xr)===-1&&(Cr.socketUrls=$(_r=Cr.socketUrls).call(_r,xr))}),Cr.socketUrls=z(pr=Cr.socketUrls).call(pr,function(xr,vr,_r){return re(_r).call(_r,xr)===vr});try{dr.uploadUrl=or.nosup[0]}catch{}if(dr.chunkUploadUrl=or["nos-chunk"]||dr.chunkUploadUrl||"",Cr.logger.info("link::refreshSocketUrl: ".concat(hr," ajax load , got socket urls "),Cr.socketUrls),dr.hasLocalStorage){or.common["lbs.backup"]&&Cr.options.lbsBackup&&localStorage.setItem("nim_lbs_backup",i(or.common["lbs.backup"]));var kr=ir.get(or,"common.report.apierror.on");or.common.report&&localStorage.setItem("nim_lbs_fail_report_on",kr===!1?"0":"1")}if(or.common.socketConcurrent){var Ir=or.common.socketConcurrent;typeof Ir=="number"&&Ir>=1&&Ir<=3&&(Cr.options.socketConcurrent=Ir,Cr.imsocket.setConfig({socketConcurrent:Ir}))}}function sr(or,hr){if(this.statusProtector.getConnectStatus()===Dt.V2NIM_CONNECT_STATUS_DISCONNECTED)return L.reject(new Error("already disconnected"));if(or>=hr){this.logger.warn("doRequestBackupLbsUrls backup lbs all tried");var pr=dr.getDefaultLinkUrl(this.options.secure);return this.logger.warn("doRequestBackupLbsUrls: use default socket link",pr),this.socketUrls=[pr],this.reporterHookLBS.end(!1),L.resolve()}return this.logger.warn("doRequestBackupLbsUrls: wait for next lbs request"),L.reject(new Error("lbs request failed"))}function er(or,hr){var pr=hr.status||10001,Sr=typeof hr=="string"?hr:hr&&hr.message?hr.message:"Unknown error";this.reporterHookLBS.updateComplete({target:or,code:hr.status||hr.code||0,body:hr&&hr.message||""}),this.reporter.reportTraceUpdateV2("login",{operation_type:"HTTP",target:or,code:pr,description:Sr,net_connect:this.checkNetworkAvailable(),succeed:!1})}function cr(or){var hr=this;if(!(or&&or.length>0))throw new Error("No  lbs url to try");var pr=0,Sr=0,Er=!1,Pr=null;hr.logger.log("doRequestBackupLbsUrls: use lbs url in index ",pr,or),hr.reporterHookLBS.start();var Cr=function(rr){var kr=or[rr],Ir=new Date().getTime();return hr.reporterHookLBS.updateBegin({target:kr,index:rr}),hr.promiseAbortManager.add(hr.doRequestLbs(kr)).then(function(xr){if(Pr&&clearInterval(Pr),Er===!1)return lr.call(hr,xr,kr),Er=!0,L.resolve()}).catch(function(xr){return Sr+=1,hr.logger.warn("doRequestBackupLbsUrls: ".concat(kr," ajax lbs error"),xr),er.call(hr,kr,xr,Ir),sr.call(hr,Sr,or.length)})};return new L(function(rr,kr){Pr=oe(function(){if(!(pr>=or.length))return hr.statusProtector.getConnectStatus()===Dt.V2NIM_CONNECT_STATUS_DISCONNECTED?(Pr&&clearInterval(Pr),void kr(new Error("already disconnected"))):void Cr(pr++).then(function(){Pr&&clearInterval(Pr),rr()}).catch(function(){});Pr&&clearInterval(Pr)},2e3),Cr(pr++).then(function(){Pr&&clearInterval(Pr),rr()}).catch(function(){})})}Et.connect=function(){dr.isBrowser&&this.reporter.restore(),this.createConnectTime=y(),this.reporter.reportTraceCancel("login"),this.autoconnect?this.reporter.reportTraceStart("login",{user_id:this.options.account,action:"auto_login"}):this.reporter.reportTraceStart("login",{user_id:this.options.account,action:"manual_login",process_id:this.processId}),this.reporter.reportTraceUpdateV2("login",{code:0,description:i(jt(jt({},this.options),{},{account:"***",token:"***"}),function(or,hr){return or===""||typeof hr!="function"&&n(hr)!=="object"?hr:void 0}),operation_type:"conf_init",net_connect:this.checkNetworkAvailable(),succeed:!0,target:""}),k(Et).connect.call(this)},Et.onConnect=function(){this.reporter.reportTraceUpdateV2("login",{operation_type:"TCP",target:this.url,code:200,net_connect:this.checkNetworkAvailable(),succeed:!0}),k(Et).onConnect.call(this)},Et.onHandshakeFailed=function(or,hr){var pr;this.reporter.reportTraceUpdateV2("login",{operation_type:"TCP",target:hr,code:408,succeed:!1,net_connect:this.checkNetworkAvailable(),description:"ws_handshake_failed"}),this.reporter.reportTraceEnd("login",!1),this.logger.warn($(pr="link::onHandshakeFailed: shandshake failed, startTime: ".concat(or,", targetUrl: ")).call(pr,hr))},Et.onConnectFailed=function(or,hr,pr){var Sr,Er;this.reporter.reportTraceUpdateV2("login",{operation_type:"TCP",target:pr,code:408,succeed:!1,net_connect:this.checkNetworkAvailable(),description:"ws_connect_failed"}),this.reporter.reportTraceEnd("login",!1),this.logger.warn($(Sr=$(Er="link::onConnectFailed: connect failed due to ".concat(or,", startTime: ")).call(Er,hr,", targetUrl: ")).call(Sr,pr))},Et.onSocketError=function(or,hr,pr){var Sr,Er;this.reporter.reportTraceUpdateV2("login",{operation_type:"TCP",target:pr,description:"ws_onerror:"+or,code:0,net_connect:this.checkNetworkAvailable(),succeed:!1}),this.reporter.reportTraceEnd("login",!1),this.logger.warn($(Sr=$(Er="link::onSocketError: due to ".concat(or,", startTime: ")).call(Er,hr,", targetUrl: ")).call(Sr,pr))},Et.probeIp=function(){var or=this,hr=dr.ipProbeAddr;return new L(function(pr){var Sr=0,Er=-1;function Pr(){++Sr===2&&(Sr=-1,pr(Er))}or.adaptersRequest(hr.ipv4,{timeout:2e3,onerror:Pr,onload:function(Cr){Er++,Pr()}}),or.adaptersRequest(hr.ipv6,{timeout:2e3,onerror:Pr,onload:function(Cr){Er+=2,Pr()}}),V(function(){Sr||Er===-1||(Sr=-1,pr(Er))},100)})},Et.refreshSocketUrl=function(){var or=this;return this.statusProtector.emit("auth/loginLifeCycleAddressing"),dr.isWeixinApp?this.doRefreshSocketUrl(2):this.options.ipVersion===2?this.probeIp().then(function(hr){return or.doRefreshSocketUrl(hr)}):this.doRefreshSocketUrl(this.options.ipVersion)},Et.doRefreshSocketUrl=function(or){var hr,pr,Sr=this.options.lbsUrl||dr.lbsUrl;or!==1&&or!==2&&(or=0),dr.ipVersion=or;var Er=this.options.lbsBackupUrlsCustomer||[],Pr=[];this.options.lbsBackup&&dr.hasLocalStorage&&(Pr=(Pr=localStorage.getItem("nim_lbs_backup"))?JSON.parse(Pr):[]);var Cr=$(hr=$(pr=[Sr]).call(pr,Pr)).call(hr,Er);return Cr=z(Cr).call(Cr,function(rr,kr,Ir){return re(Ir).call(Ir,rr)===kr}),cr.call(this,Cr)},Et.doRequestLbs=function(or){var hr=this,pr=this.options,Sr=dr.info;or=or+ir.genUrlSep(or)+"id="+pr.account+"&sv="+Sr.sdkVersion+"&pv="+Sr.protocolVersion+"&networkType="+dr.ipVersion+"&hostEnv="+dr.hostEnv+"&k="+pr.appKey,this.logger.info("doRequestLbs ".concat(ie(or).call(or,0,-32)));var Er=this;return new L(function(Pr,Cr){dr.isWeixinApp?wx.request({url:or,success:function(rr){var kr=rr&&rr.statusCode,Ir=rr&&rr.data;kr===200?Pr(Ir):Cr(Ir)},fail:function(rr){Cr(rr)}}):hr.adaptersRequest(or,{proxyUrl:ir.url2origin(or)+"/lbs/res/cors/nej_proxy_frame.html",timeout:dr.xhrTimeout,onload:function(rr){try{var kr=JSON.parse(rr);Pr(kr)}catch(Ir){Er.logger.warn("doRequestLbs parse JSON Error. request lbs failed"),Cr(Ir)}},onerror:function(rr){Cr(rr)}},{exception_service:1})})},Et.disconnect=function(){var or=this,hr=arguments.length>0&&arguments[0]!==void 0?arguments[0]:function(){};if(this.isConnected())return this.sendCmd("logout"),void V(function(){k(Et).disconnect.call(or,hr)},0);this.connecting?this.logger.warn("IMProtocolFn api disconnect:: connecting but exiting"):this.statusProtector.getConnectStatus()!==Dt.V2NIM_CONNECT_STATUS_DISCONNECTED?this.logger.warn("IMProtocolFn api disconnect:: has tried to disconnect"):this.logger.warn("IMProtocolFn api disconnect:: other logic entered");var pr=k(Et);pr.disconnect.call(this,hr)},Et.notifyDisconnect=function(or){k(Et).notifyDisconnect.call(this,or)}},function(t,r,e){var n=e(57),g=e(51),y=e(58),i=e(3),k=e(8),$=e(24),L=e(26),V=e(7),z=e(2),re=e(16),ie=e(4),ue=e(52),le=e(53),oe=e(54),ae=e(55),qe=e(43);function de(sr,er){var cr=ie(sr);if(ue){var or=ue(sr);er&&(or=re(or).call(or,function(hr){return le(sr,hr).enumerable})),cr.push.apply(cr,or)}return cr}function Ne(sr){for(var er=1;er<arguments.length;er++){var cr,or,hr=arguments[er]!=null?arguments[er]:{};er%2?z(cr=de(Object(hr),!0)).call(cr,function(pr){g(sr,pr,hr[pr])}):oe?ae(sr,oe(hr)):z(or=de(Object(hr))).call(or,function(pr){qe(sr,pr,le(hr,pr))})}return sr}var ze=e(35).fn,$e=e(195),Lt=e(11),jt="NIM-AllGrayscaleConfig",Et="NIM-AllMixStorePolicy",ir=e(0);function dr(){var sr=this;if(Lt.hasLocalStorage&&localStorage.getItem(jt)){var er=null;try{er=JSON.parse(localStorage.getItem(jt))[sr.options.appKey]}catch(cr){sr.logger.error("appGrayConfig error",cr)}er&&(sr.appGrayConfig=er.timeStamp+1e3*er.ttl>new Date().getTime()?er:null,sr.appGrayConfig&&Dt.apply(sr))}sr.appGrayConfig||sr.sendCmd("getGrayscaleConfig",{providers:""},function(cr,or){if(cr)sr.logger.error("Calculate Delay time, getGrayscaleConfig error",cr);else if(or){var hr=or;if(hr.grayConfig=JSON.parse(hr.grayConfig),hr.ttl=Number(hr.ttl),hr.timeStamp=new Date().getTime(),sr.appGrayConfig=hr,Lt.hasLocalStorage){var pr=localStorage.getItem(jt)?JSON.parse(localStorage.getItem(jt)):{};pr[sr.options.appKey]=hr,localStorage.setItem(jt,k(pr))}Dt.apply(sr)}else sr.logger.error("Calculate Delay time, getGrayscaleConfig error",or)})}function Dt(){var sr=this;if(Lt.hasLocalStorage&&localStorage.getItem(Et)){var er=null;try{er=JSON.parse(localStorage.getItem(Et))[sr.options.appKey]}catch(cr){sr.logger.error("mixStorePolicy error",cr)}er&&(sr.mixStorePolicy=er.timeStamp+1e3*er.ttl>new Date().getTime()?er:null,sr.mixStorePolicy&&er.ttl&&er.ttl!==0&&(sr.mixStorePolicyClock=$(L(Dt).call(Dt,sr),1e3*er.ttl)))}sr.mixStorePolicy||sr.sendCmd("getMixStorePolicy",{providers:sr.options.providers&&sr.options.providers.s3?[1,2]:[1]},function(cr,or){if(cr){sr.logger.error("Calculate Delay time, getMixStorePolicy error",cr);try{or=JSON.parse(localStorage.getItem("NIM-AllMixStorePolicy"))[sr.options.appKey]}catch(Sr){sr.logger.error("error:","get last mixStorePolicy failed",Sr)}}else if(or){var hr=or;if(hr.ttl=Number(hr.ttl),hr.providers=hr.providers.split(","),hr.nosPolicy=hr.nosPolicy?JSON.parse(hr.nosPolicy):null,hr.s3Policy=hr.s3Policy?JSON.parse(hr.s3Policy):null,hr.timeStamp=new Date().getTime(),sr.mixStorePolicy=hr,hr.ttl&&hr.ttl!==0&&(sr.mixStorePolicyClock=$(L(Dt).call(Dt,sr),1e3*hr.ttl)),Lt.hasLocalStorage){var pr=localStorage.getItem(Et)?JSON.parse(localStorage.getItem(Et)):{};pr[sr.options.appKey]=hr,localStorage.setItem(Et,k(pr))}}else sr.logger.error("Calculate Delay time, mixStorePolicy error",or)})}function lr(sr){var er=this,cr=this;sr.code===399?(this.logger.warn("pendingLoginFailed:399, refresh LBS url and reconnecting"),cr.forceDisconnect(),cr.doRefreshSocketUrl(Lt.ipVersion).then(function(){cr.reconnect()}).catch(function(){er.logger.warn("pendingLoginFailed:399, refresh LBS url failed")})):sr.code===398?(this.logger.warn("pendingLoginFailed:398 try to reconnect socket link，backoff set min 5s"),cr.backoff.setMin(5e3),cr.reconnect()):(this.logger.error("pendingLoginFailed: ",sr.code,sr),cr.onAuthError(sr,"link::onLogin"))}ze.assembleLogin=function(){var sr=this.assembleIMLogin();return this.addPushInfo instanceof Function?this.addPushInfo(sr):i.resolve({login:sr})},ze.login=y(n.mark(function sr(){var er,cr,or,hr=this;return n.wrap(function(pr){for(;;)switch(pr.prev=pr.next){case 0:return er=this,pr.next=3,er.assembleLogin();case 3:if(cr=pr.sent,!(or=this.socket&&this.socket.socket&&this.socket.socket.sessionid)){pr.next=13;break}if(this.socketIds||(this.socketIds={}),!this.socketIds[or]){pr.next=10;break}return this.logger.warn("onConnect::repeat login",or),pr.abrupt("return");case 10:this.socketIds[or]=!0,pr.next=14;break;case 13:this.logger.warn("onConnect:: no socketId ",this.socket&&this.socket.socket);case 14:this.logger.warn("link::doLogin: "+or+" appLogin is "+cr.login.appLogin),er.sendCmd("login",Ne({},cr),function(Sr,Er){if(Sr){var Pr=ir.get(Sr,"event.uploadCode")||Sr&&Sr.code;Pr=typeof Pr!="number"?408:Pr;var Cr=ir.get(Sr,"event.disconnectReason"),rr=Cr?k({disconnect_reason:Cr}):Sr&&Sr.message||"login failed";er.reporter.reportTraceUpdateV2("login",{operation_type:"protocol",target:"2-3",code:Pr,description:rr,net_connect:er.checkNetworkAvailable(),succeed:!1}),er.reporter.reportTraceEnd("login",!1),lr.call(er,Sr),er.statusProtector.emit("auth/loginLifeCycleLoginFail",Sr)}else er.reporter.reportTraceUpdateV2("login",{operation_type:"protocol",target:"2-3",succeed:!0,net_connect:er.checkNetworkAvailable(),code:200}),er.reporter.reportTraceEnd("login",!0),er.resetReconnectStatus(),hr.heartbeatFail=0,hr.hasLogin=!0,hr.autoconnect=!0,er.startHeartbeat(),er.initOnlineListener(),er.statusProtector.emit("auth/loginLifeCycleLoginSucc"),er.afterLogin(Er)});case 16:case"end":return pr.stop()}},sr,this)})),ze.afterLogin=function(sr){var er=this;this.sendCmd("getNosCdnHost",{}),(typeof ir.get(this.options,"privateConf.isMixStoreEnable")=="boolean"?this.options.privateConf.isMixStoreEnable:Lt.privateConf.isMixStoreEnable)&&dr.apply(this),this.initPush instanceof Function&&this.initPush();var cr=this.db;if(cr.enable){var or=this.account;this.options.appendAppKeyForDBName&&(or+="-"+this.options.appKey),this.db.init(or).then(function(){er.notifyLogin(sr),er.syncData()},function(hr){er.logger.warn("link::afterLogin: no db",hr),cr.reset(!1),er.notifyLogin(sr),er.syncData()})}else this.logger.info("link::afterLogin: no db"),this.notifyLogin(sr),this.syncData()},ze.getFileAuthToken=function(sr){var er=this,cr=er.mixStorePolicy.nosPolicy.authPolicy.policyType;cr!==-1?V(cr).call(cr,sr.type)<0?er.logger.error("this type Token error not support"):sr.type!=3||sr.urls&&sr.urls.length?er.sendCmd("getBackSourceToken",{mixAuthTokenReq:sr},function(or,hr){if(or)return er.logger.error("getBackSourceToken error",or),or;sr.done&&sr.done(hr)}):er.logger.error("urls is Required when type 3"):er.logger.error("don't need token")},ze.processAuth=function(sr){switch(sr.cmd){case"login":sr.error||(sr.content=sr.content||{},this.loginAndroidPush&&this.loginAndroidPush(sr.content.aosPushInfo||{}),sr.obj=sr.content.loginRes,this.connectionId=sr.content.loginRes.connectionId,this.onLoginPortsChange(sr,2));break;case"kicked":return void this.onKicked(sr);case"multiPortLogin":this.onLoginPortsChange(sr,sr.content.state);break;case"kick":sr.error||(sr.obj.deviceIds=sr.content.deviceIds)}},ze.onLoginPortsChange=function(sr,er){var cr=this,or=sr.content.loginPorts;if(or&&or.length){var hr=!0;switch(er){case 2:hr=!0;break;case 3:hr=!1}z(or).call(or,function(pr){pr.type=$e.reverseType(pr.type),pr.customClientType&&(pr.customClientType=+pr.customClientType),pr.time=+pr.time,pr.online=hr}),(or=re(or).call(or,function(pr){return pr.connectionId!==cr.connectionId})).length&&(cr.logger.info("link::onLoginPortsChange:",or),cr.options.onloginportschange(or))}},ze.kickedReasons=["","samePlatformKick","serverKick","otherPlatformKick","silentlyKick"],ze.kickedMessages=["","不允许同一个帐号在多个地方同时登录","被服务器踢了","被其它端踢了","悄悄被踢"]},function(t,r,e){var n=e(57),g=e(58),y=e(789),i=e(3),k=e(26),$=e(6),L=e(754),V=e(37),z=e(2),re=e(4),ie=e(122),ue=e(7),le=e(71),oe=e(16),ae=e(9),qe=e(121),de=e(803),Ne=e(24),ze=e(32),$e=e(90),Lt=e(35).fn,jt=e(0),Et=e(41),ir=jt.undef,dr=jt.objs2ids,Dt=jt.objs2accounts,lr=jt.teams2ids,sr=e(154),er=jt.getGlobal(),cr=e(107).EMSyncType;Lt.beforeSync=function(){var or=this.db;return or.enable?or.clearSendingMsgs():i.resolve()},Lt.syncData=function(){var or=this,hr=or.db,pr=or.options,Sr=hr.enable;function Er(Pr){var Cr;or.syncPromiseArray=[],or.syncResult={},or.syncTeamMembersPromiseArray=[],or.syncSuperTeamMembersPromiseArray=[],or.syncTeamMembersResult={},or.checkNosReqNum=0,or.getNosOriginUrlReqNum=0,jt.verifyBooleanWithDefault(pr,"syncRelations syncFriends syncFriendUsers syncTeams syncSuperTeams syncRoamingMsgs syncSuperTeamRoamingMsgs syncMsgReceipts syncExtraTeamInfo syncExtraSuperTeamInfo syncAvSignal",!0,"","sync::syncData"),jt.verifyBooleanWithDefault(pr,"syncFilter syncTeamMembers syncSuperTeamMembers",!1,"","sync::syncData");var rr={};Pr=Pr||{},er._nimForceSyncIM&&(or.logger.warn("sync::syncData: nimForceSyncIM"),delete Pr.teams,er._nimForceSyncIM=!1),rr.myInfo=Pr.myInfo||0,rr.deleteMsgSelf=Pr.deleteMsgSelf||0,rr.offlineMsgs=0,pr.syncRelations&&(rr.relations=Pr.relations||0),pr.syncFriends&&(rr.friends=Pr.friends||0),pr.syncFriendUsers&&(rr.friendUsers=Pr.friendUsers||0),pr.syncRobots&&(rr.robots=Pr.robots||0),pr.syncTeams&&(rr.teams=Pr.teams||0),pr.syncSuperTeams&&(rr.superTeams=Pr.superTeams||0),pr.syncStickTopSessions&&(rr.stickTopSessions=Pr.stickTopSessions||0),pr.syncSessionUnread&&(rr.sessionAck=Sr&&Pr.sessionAck||0,rr.superTeamSessionAck=Sr&&Pr.superTeamSessionAck||0),pr.syncRoamingMsgs&&(rr.roamingMsgs=Sr&&Pr.roamingMsgs||Pr.roamingMsgs||0),pr.syncSuperTeamRoamingMsgs&&(rr.superTeamRoamingMsgs=Sr&&Pr.superTeamRoamingMsgs||0),pr.syncMsgReceipts&&(rr.msgReceipts=Pr.msgReceipts||0),pr.syncExtraTeamInfo&&(rr.myTeamMembers=Pr.myTeamMembers||0),pr.syncExtraSuperTeamInfo&&(rr.myInfoInSuperTeams=Pr.myInfoInSuperTeams||0),pr.syncBroadcastMsgs&&(rr.broadcastMsgs=Pr.broadcastMsg||0),rr.donnop=Pr.donnop||0,rr.deleteMsg=Pr.deleteMsg||0,rr.deleteSuperTeamMsg=Pr.deleteSuperTeamMsg||0,rr.sessionHistoryMsgsDelete=Pr.sessionHistoryMsgsDelete||0,rr.netcallMsgs=0,pr.syncFilter&&(rr.filterMsgs=0),pr.syncAvSignal&&(rr.avSignal=0);var kr=k(Cr=or.onSyncData).call(Cr,or);kr.isImSyncDataCb=!0,or.logger.info("syncData:: start sync",rr),or.reporterHook.emit("reporter/syncStart"),or.sendCmd("sync",{sync:rr,isImSyncDataObj:!0},kr)}or.syncing=!0,or.logger.log("sync::syncData: syncing = true"),Sr?or.beforeSync().then(function(){return or.db.getTimetags()}).then(function(Pr){Er(Pr)},function(){Er()}):Er(or.timetags)},Lt.onSyncData=function(or){or&&(or.callFunc="sync::onSyncData",this.onCustomError("SYNC_DATA_ERROR",or))},Lt.processSync=function(or){switch(this.logger.log("sync::processSync cmd: ".concat(or.cmd)),or.cmd){case"syncDone":if(or.error){var hr,pr=jt.get(or.error,"message"),Sr=jt.get(or.error,"code");this.logger.error($(hr="sync::processSync syncDoneError errMsg: ".concat(pr,", errCode: ")).call(hr,Sr)),this.logger.error("sync::processSync disconnect because syncDone failed");var Er=Et.syncError({errMsg:pr,errCode:Sr});this.shouldReconnect=!1,this.markAllCallbackInvalid(Er),this.notifyDisconnect(Er)}else this.timetags.sync=or.content.timetag,this.reporterHook.emit("reporter/syncRecv"),this.onSyncDone();break;case"syncTeamMembersDone":this.onSyncTeamMembersDone();break;case"syncSuperTeamMembersDone":this.onSyncSuperTeamMembersDone()}},Lt.onSyncDone=function(){var or,hr,pr,Sr,Er,Pr,Cr,rr,kr,Ir,xr,vr,_r,Or,Mr,yr,mr,Tr,Br,$r,Lr,Gr,qr,Yr,bn,wn,Xr,Vn,Zr,Nn,Qr=this,kn=Qr.db,Dn=kn.enable,xn=Qr.options,An=Qr.syncPromiseArray,vn=Qr.syncResult;function hn(){if(An){Qr.logger.info("sync::onSyncDone: after sync",jt.promises2cmds(An)),An=[],hr=vn.blacklist||[],pr=vn.invalidBlacklist||[],Sr=vn.mutelist||[],Er=vn.invalidMutelist||[],Pr=vn.friends,kr=vn.myTeamMembers,Ir=vn.mySuperTeamMembers,Cr=vn.invalidFriends||[],rr=vn.myInfo,xr=vn.users,_r=vn.superTeams,Mr=vn.invalidSuperTeams,vr=vn.teams,Or=vn.invalidTeams||[],yr=vn.sessions||{},mr=L(V({},Qr.sessionSet)),Tr=vn.ackMap,vn.msgReceipts,Br=vn.roamingMsgs,$r=vn.offlineMsgs,Lr=vn.offlineFilterMsgs,qr=vn.offlineSysMsgs,Yr=vn.offlineCustomSysMsgs,bn=vn.offlineFilterSysMsgs,wn=vn.offlineFilterCustomSysMsgs,Xr=vn.sysMsgUnread,Vn=vn.sessionsWithMoreRoaming,Nn=vn.clearServerHistoryMsgs||[];var Io=i.resolve();(function(){if(Dn){var ra,Wa=[Yn()];yr&&z(ra=re(yr)).call(ra,function(to){Wa.push(kn.putSession(yr[to]))}),Io=i.all(Wa).then(function(){var to,ba=$(to=[]).call(to,y(re(Tr||{})),y(re(yr||{})));ba=oe(ba).call(ba,function(qa,Ya,Xo){return ue(Xo).call(Xo,qa)===Ya});var ka=[];return z(ba).call(ba,function(qa){var Ya,Xo=yr[qa];(Xo.lastMsg||Xo.ack)&&(Ya=(Ya=Xo.ack?i.resolve(Xo):kn.getSession(Xo.id)).then(function(Co){var Ga=Co.ack||0;return kn.getMsgCountAfterAck({shouldCountNotifyUnread:Qr.options.shouldCountNotifyUnread,sessionId:qa,ack:Ga}).then(function(Xa){return Co.unread=Xa||0,yr[qa]=Qr.mergeSession(Co),kn.updateSession(Co)})}),ka.push(Ya))}),i.all(ka)}).then(function(){var to=[];return Qr.saveAck.p2pTeam&&to.push(kn.updateSessionAck(Qr.saveAck.p2pTeam).catch(function(ba){return Qr.logger.error("sessionAck::syncSessionAck::updatetimetag db",ba),i.reject(ba)})),Qr.saveAck.superTeam&&to.push(kn.updateSuperTeamSessionAck(Qr.saveAck.superTeam).catch(function(ba){return Qr.logger.error("sessionAck::syncSuperTeamSessionAck::updatetimetag db",ba),i.reject(ba)})),i.all(to)})}else if(yr){var Rs,To,Qs;z(Rs=[Br,$r]).call(Rs,function(to){to&&z(to).call(to,function(ba){var ka;(To=yr[ba.sessionId]).unread=To.unread||0,To.unreadMsgs=To.unreadMsgs||[],Qs=To.ack||0,z(ka=ba.msgs).call(ka,function(qa){if(!(Qs>=qa.time))if(qa.type==="notification"){var Ya;try{Ya=Qr.options.shouldCountNotifyUnread(qa)}catch(Xo){throw Qr.logger.error("userOption:shouldCountNotifyUnread function error",Xo),Xo}Ya&&To.unread++}else qa.flow==="in"&&qa.isUnreadable!==!1&&(To.unread++,To.unreadMsgs.push(qa))}),Qr.mergeSession(To)})})}})(),Qr.syncDonePromiseArray=Qr.syncDonePromiseArray||[],Io.then(function(){if(Dn&&!Qr.hasSynced)Qr.hasSynced=!0,function(){xn.syncRelations&&(or=kn.getRelations().then(function(to){hr=to[0],Sr=to[1],hr.invalid=pr,Sr.invalid=Er}).catch(function(to){return to._msg="on relations error",Qr.logger.error("sync::syncRelation: ",to),i.reject(to)}),An.push(or)),xn.syncFriends&&(or=kn.getFriends().then(function(to){(Pr=to).invalid=Cr}).catch(function(to){return to._msg="on friends error",Qr.logger.error("sync::syncFriends: ",to),i.reject(to)}),An.push(or)),ir(rr)&&(or=kn.getUser(Qr.account).then(function(to){rr=to}).catch(function(to){return to._msg="on myInfo error",Qr.logger.error("sync::syncMyInfo: ",to),i.reject(to)}),An.push(or)),xn.syncFriendUsers&&(or=kn.getFriends().then(function(to){return ae(to).call(to,function(ba){return ba.account})}).then(function(to){return kn.getUsers({accountIds:to})}).then(function(to){xr=to}).catch(function(to){return to._msg="on users error",Qr.logger.error("sync::syncFriendUser: ",to),i.reject(to)}),An.push(or)),xn.syncTeams&&(or=kn.getTeams().then(function(to){(vr=to).invalid=Or}).catch(function(to){return to._msg="on teams error",Qr.logger.error("sync::syncTeams: ",to),i.reject(to)}),An.push(or)),xn.syncSuperTeams&&(or=kn.getSuperTeams().then(function(to){(_r=to).invalid=Mr}).catch(function(to){return to._msg="on superteams error",Qr.logger.error("sync::syncSuperTeams: ",to),i.reject(to)}),An.push(or)),or=kn.getTeamMembersByAccount(Qr.account).then(function(to){kr=to,Qr.mergeMyTeamMembers(to)}).catch(function(to){return Qr.logger.error("sync::getTeamMembersByAccount: ",to),i.reject(to)}),An.push(or),or=kn.getSuperTeamMembersByAccount(Qr.account).then(function(to){Ir=to,Qr.mergeMySuperTeamMembers(to)}).catch(function(to){return Qr.logger.error("sync::getSuperTeamMembersByAccount: ",to),i.reject(to)}),An.push(or),or=kn.getDonnop().then(function(to){Qr.mergeDonnop(to)}).catch(function(to){return Qr.logger.error("sync::donnop: ",to),i.reject(to)}),An.push(or),or=kn.getAllSessions().then(function(to){yr=to}).catch(function(to){return Qr.logger.error("sync::getSession: ",to),i.reject(to)}),An.push(or),or=kn.getSysMsgUnread().then(function(to){Xr=to}).catch(function(to){return to._msg="on sysMsgUnread error",Qr.logger.error("sync::getSysMsgUnread: ",to),i.reject(to)}),An.push(or),An.push(kn.getSessionsWithMoreRoaming().then(function(to){Vn=to}))}();else{var ra,Wa,Rs=[];z(ra=re(yr)).call(ra,function(to){(Wa=yr[to]).lastMsg&&Rs.push(Wa)}),yr=ie(Rs).call(Rs,function(to,ba){return ba.updateTime-to.updateTime})}var To=i.all(An);function Qs(to){var ba;to||(Qr.syncDonePromiseSuccessCount+=1);var ka,qa=ue(ba=Qr.syncDonePromiseArray).call(ba,To);qa>-1&&le(ka=Qr.syncDonePromiseArray).call(ka,qa,1),Qr.logger.log("afterSync::syncDonePromiseHandler syncPromiseArray length: ",Qr.syncDonePromiseArray.length,"success count: ",Qr.syncDonePromiseSuccessCount),Qr.syncDonePromiseArray.length===0&&Qr.syncDonePromiseSuccessCount>0?(Qr.logger.log("onSyncDone afterSync last syncDonePromsie. Execute taskAfterSync and notifyData"),function(){Qr.logger.info("sync::onSyncDone: taskAfterSync"),function(){if(vn.deleteMsgSysMsgs){var Xo,Co={};Br&&z(Br).call(Br,function(pa){Co[pa.sessionId]=pa});var Ga={};$r&&z($r).call($r,function(pa){Ga[pa.sessionId]=pa});var Xa=Qr.api;if(z(Xo=vn.deleteMsgSysMsgs).call(Xo,function(pa){var ti;z(ti=pa.sysMsgs).call(ti,function(_u){var ac=_u.msg,Dc=ac.sessionId;pa.type==="roaming"&&Co[Dc]?Co[Dc].msgs=Xa.cutMsgs(Co[Dc].msgs,ac):Ga[Dc]&&(Ga[Dc].msgs=Xa.cutMsgs(Ga[Dc].msgs,ac))})}),!kn.enable){var Gl,Js=$(Gl=[]).call(Gl,y(Br||[]),y($r||[]));z(Js).call(Js,function(pa){if(pa.msgs.length){var ti=Qr.genSessionByMsgs(pa.msgs);Qr.cacheSyncedSession(ti),yr.unshift(ti)}else{var _u=de(yr).call(yr,function(ac){return ac.id===pa.sessionId});le(yr).call(yr,_u,1)}});var wi={};z(yr).call(yr,function(pa){if(wi[pa.id]){var ti=pa.lastMsg.time>wi[pa.id].lastMsg.time?pa.lastMsg:wi[pa.id].lastMsg;wi[pa.id]=pa,wi[pa.id].lastMsg=ti}else wi[pa.id]=pa}),yr=L(wi),yr=ie(yr).call(yr,function(pa,ti){return ti.updateTime-pa.updateTime})}}}(),Zr=Qr.syncResult.stickTopSessions||[],z(Zr).call(Zr,function(Xo){Xo.isTop=!0}),z(yr).call(yr,function(Xo){var Co=Qr.sessionSet[Xo.id];Co&&Co.isTop&&(Xo.isTop=!0),qe(Zr).call(Zr,function(Ga){return Ga.id===Xo.id})&&(Xo.isTop=!0)});var Ya=[Qr.deleteMsgOfflineRoaming(vn.deleteMsgSysMsgs,yr)];return Nn&&z(Nn).call(Nn,function(Xo){Ya.push(function(Co,Ga){var Xa;Qr.logger.info("sync::taskAfterSync:sessionHistoryMsgsDelete ".concat(Co)),Ga=Ga||new Date().getTime();var Gl=oe(yr).call(yr,function(ti){return ti.id===Co}),Js=Qr.getSessionInCache(Co);Xa=Js||Gl[0];var wi=xn.rollbackClearMsgsUnread!==!1,pa=[];return kn.enable&&pa.push(kn.deleteMsgsBySessionId({sessionId:Co,end:Ga})),wi&&Xa&&(Xa.lastMsg=null,Xa.unread=0,Xa=Qr.mergeSession(Xa),kn.enable&&pa.push(kn.updateSession(Xa))),i.all(pa)}(Xo.sessionId,Xo.time))}),i.all(Ya)}().then(Oo,function(Ya){Qr.logger.error("taskAfterSync syncDBDataPromise error:",Ya),Ya.callFunc="sync::onSyncDone",Ya.message="taskAfterSync+notifyData 出错",Qr.onCustomError("SYNC_SESSION_ACK_ERROR",Ya)})):to?(Qr.logger.error("onSyncDone afterSync syncDonePromise Error:",to),to.callFunc="sync::onSyncDone",to.message="pullFullData 出错",Qr.onCustomError("SYNC_SESSION_ACK_ERROR",to)):Qr.logger.log("onSyncDone afterSync syncDonePromise success, wait for next syncDonePromise")}Qr.syncDonePromiseArray.length===0&&(Qr.syncDonePromiseSuccessCount=0),Qr.syncDonePromiseArray.push(To),To.then(function(){return Qs()}).catch(function(to){return Qs(to)})})}else Qr.logger.warn("sync::onSyncDone: after sync --no promiseArray")}function Yn(){var Io=[];return Br&&z(Br).call(Br,function(ra){var Wa;Io=$(Wa=[]).call(Wa,y(Io),y(ra.msgs))}),$r&&z($r).call($r,function(ra){var Wa;Io=$(Wa=[]).call(Wa,y(Io),y(ra.msgs))}),Io.length?kn.putMsg(Io).then(function(){return Io}):i.resolve(Io)}function Oo(){Ne(Vo,0)}function Vo(){var Io,ra,Wa=[],Rs=[];if(hr&&hr.length&&(Qr.logger.info("sync::notifyDataAsync: on blacklist",Dt(hr)),Qr.reporterHook.emit("reporter/syncItemComplete",cr.kSyncType3_8),xn.onblacklist(hr)),Sr&&Sr.length&&(Qr.logger.info("sync::notifyDataAsync: on mutelist",Dt(Sr)),xn.onmutelist(Sr)),Pr&&(Qr.logger.info("sync::notifyDataAsync: on friends",Dt(Pr)),Qr.reporterHook.emit("reporter/syncItemComplete",cr.kSyncType12_5),xn.onfriends(Pr)),rr&&(Qr.logger.info("sync::notifyDataAsync: on myInfo"),Qr.myInfo=rr,Qr.reporterHook.emit("reporter/syncItemComplete",cr.kSyncType3_109),xn.onmyinfo(jt.copy(rr))),kr){Qr.logger.info("sync::notifyDataAsync: on myTeamMembers",kr),Qr.reporterHook.emit("reporter/syncItemComplete",cr.kSyncType8_126);var To=jt.simpleClone(kr);ze(To)||(To=[To]),xn.onMyTeamMembers(To)}if(Ir){Qr.logger.info("sync::notifyDataAsync: on mySuperTeamMembers",Ir),Qr.reporterHook.emit("reporter/syncItemComplete",cr.kSyncType21_111);var Qs=jt.simpleClone(Ir);ze(Qs)||(Qs=[Qs]),xn.onMySuperTeamMembers(Qs)}xr&&(z(xr).call(xr,function(Co){Qr.mergeUser(Co)}),Qr.logger.info("sync::notifyDataAsync: on users",Dt(xr)),Qr.reporterHook.emit("reporter/syncItemComplete",cr.kSyncType12_6),xn.onusers(xr)),vr&&(Qr.logger.info("sync::notifyDataAsync: on teams",lr(vr)),xn.onteams(vr),Qr.reporterHook.emit("reporter/syncItemComplete",cr.kSyncType8_109)),_r&&(Qr.logger.info("sync::notifyDataAsync: onSuperTeams",lr(_r)),xn.onSuperTeams(_r),Qr.reporterHook.emit("reporter/syncItemComplete",cr.kSyncType21_109)),Qr.reporterHook.emit("reporter/syncItemComplete",cr.kSyncType4_12),Qr.reporterHook.emit("reporter/syncItemComplete",cr.kSyncType4_14),Qr.reporterHook.emit("reporter/syncItemComplete",cr.kSyncType4_20),Qr.reporterHook.emit("reporter/syncItemComplete",cr.kSyncType4_21),Qr.reporterHook.emit("reporter/syncItemComplete",cr.kSyncType7_15),yr&&yr.length?(yr=ae(yr).call(yr,function(Co){return Qr.mergeSession(Co),$e(sr).call(sr,Co)}),yr=oe(yr).call(yr,function(Co){return!Co.isDeleted}),Qr.logger.info("sync::notifyDataAsync: on sessions",dr(yr),jt.secureOutput("session",yr)),!Dn&&Qr.timetags&&Qr.timetags.roamingMsgs?xn.onsessions(oe(mr).call(mr,function(Co){return sr.isComplete(Co)})):xn.onsessions(yr)):!Dn&&mr.length&&(Qr.logger.info("sync::notifyDataAsync: on sessions",dr(yr),jt.secureOutput("session",yr)),xn.onsessions(oe(mr).call(mr,function(Co){return sr.isComplete(Co)}))),Zr&&Zr.length&&(Zr=ae(Zr).call(Zr,function(Co){var Ga=Qr.getSessionInCache(Co.id);return Ga?(Ga.isTop=!0,Co=Qr.mergeSession(Ga),$e(sr).call(sr,Ga)):(Co=Qr.mergeSession(Co),$e(sr).call(sr,Co))}),Qr.logger.info("sync::notifyDataAsync: onStickTopSessions",dr(Zr),jt.secureOutput("session",Zr)),Qr.reporterHook.emit("reporter/syncItemComplete",cr.kSyncType4_23),xn.onStickTopSessions(Zr)),Br&&z(Br).call(Br,function(Co){Co.scene==="superTeam"?Rs.push(Co.timetag):Wa.push(Co.timetag),(ra=Co.msgs).length&&(Qr.logger.info("sync::notifyDataAsync: on roaming msgs",Co.sessionId,ra.length),Qr.reporterHook.emit("reporter/syncItemComplete",cr.kSyncType4_9),xn.onroamingmsgs(Co))}),$r&&(Qr.reporterHook.emit("reporter/syncItemComplete",cr.kSyncType4_4),Qr.reporterHook.emit("reporter/syncItemComplete",cr.kSyncType4_17),z($r).call($r,function(Co){Co.scene==="superTeam"?Rs.push(Co.timetag):Wa.push(Co.timetag),(ra=Co.msgs).length&&(Qr.logger.info("sync::notifyDataAsync: on offline msgs",Co.sessionId,ra.length,ae(ra).call(ra,function(Ga){return Ga.idServer})),xn.onofflinemsgs(Co))})),Lr&&(Qr.reporterHook.emit("reporter/syncItemComplete",cr.kSyncType4_100),z(Lr).call(Lr,function(Co){Wa.push(Co.timetag),(ra=Co.msgs).length&&(Qr.logger.info("sync::notifyDataAsync: on offline filter msgs",Co.sessionId,ra.length),xn.onofflinefiltermsgs(ra))})),Vn&&(Qr.logger.info("sync::notifyDataAsync: on sessionsWithMoreRoaming",dr(Vn),Vn),Qr.reporterHook.emit("reporter/syncItemComplete",cr.kSyncType4_22),xn.onSessionsWithMoreRoaming(Vn));var to,ba=[],ka=[];vn.deleteMsgSysMsgs&&z(to=vn.deleteMsgSysMsgs).call(to,function(Co){Co.type==="roaming"?ba=$(ba).call(ba,Co.sysMsgs):ka=$(ka).call(ka,Co.sysMsgs)}),ba.length&&(Gr=$(Gr=Gr||[]).call(Gr,ba)),ka.length&&(qr=$(qr=qr||[]).call(qr,ka)),Gr&&(Qr.logger.info("sync::notifyDataAsync: on roaming sys msgs",Gr.length),Qr.reporterHook.emit("reporter/syncItemComplete",cr.kSyncType4_19),Qr.reporterHook.emit("reporter/syncItemComplete",cr.kSyncType4_15),xn.onroamingsysmsgs(Gr)),qr&&(Qr.logger.info("sync::notifyDataAsync: on offline sys msgs",qr.length),xn.onofflinesysmsgs(qr)),bn&&(Qr.logger.info("sync::notifyDataAsync: on offline filter sys msgs",bn.length),xn.onofflinefiltersysmsgs(bn)),Yr&&(Qr.logger.info("sync::notifyDataAsync: on offline custom sys msgs",Yr.length),Qr.reporterHook.emit("reporter/syncItemComplete",cr.kSyncType4_6),Qr.reporterHook.emit("reporter/syncItemComplete",cr.kSyncType4_18),xn.onofflinecustomsysmsgs(Yr)),wn&&(Qr.logger.info("sync::notifyDataAsync: on offline filter custom sys msgs",wn.length),Qr.reporterHook.emit("reporter/syncItemComplete",cr.kSyncType4_101),xn.onofflinefiltercustomsysmsgs(wn)),Xr&&(Xr=jt.merge({},Qr.sysMsgUnread,Xr),Qr.sysMsgUnread=jt.merge({},Xr),Qr.logger.info("sync::notifyDataAsync: on sysMsgUnread",Xr),Qr.reporterHook.emit("reporter/syncItemComplete",cr.kSyncType4_6),xn.onsysmsgunread(Xr));var qa=Qr.getPushNotificationMultiportConfig();Qr.logger.info("sync::notifyDataAsync: on pushNotificationMultiportConfig",qa),Qr.reporterHook.emit("reporter/syncItemComplete",cr.kSyncType4_13),xn.onPushNotificationMultiportConfig(qa);var Ya=Rs.length&&Math.max.apply(Math,Rs);if(Io=Wa.length&&Math.max.apply(Math,Wa),kn.enable){var Xo=[];Ya&&Xo.push(Qr.db.updateSuperTeamRoamingMsgTimetag(Ya)),Io&&Xo.push(Qr.db.updateRoamingMsgTimetag(Io)),i.all(Xo).then(Uo).catch(Uo)}else Qr.timetags.superTeamRoamingMsgs=Ya,Qr.timetags.roamingMsgs=Io||Qr.timetags.roamingMsgs,Uo();Qr.syncPromiseArray=[],Qr.syncResult={}}function Uo(){Qr.processUnsettledMsgs(),Qr.msgPromise.then(function(){Qr.canHandleDeletedMsgInSyncing=!0,Ne(function(){Qr.processUnsettledSysMsgs()},0)}),Qr.syncing&&xn.onsyncdone(),Qr.syncing=!1,Qr.logger.log("sync::onsyncdone: syncing = false"),Qr.reporterHook.emit("reporter/syncComplete"),kn.enable&&xn.syncTeamMembers&&Qr.syncTeamMembers(vr),kn.enable&&xn.syncSuperTeamMembers&&Qr.syncSuperTeamMembers(_r)}An&&An.length?i.all(An).then(hn).catch(function(Io){hn(),Qr.logger.error(Io),Io.callFunc="sync::onSyncDone",Io.message="afterSync syncNormalPromise 出错",Qr.onCustomError("SYNC_promiseArray_ERROR",Io)}):hn()},Lt.syncTeamMembers=function(){var or=g(n.mark(function hr(pr){var Sr,Er,Pr,Cr,rr,kr,Ir,xr;return n.wrap(function(vr){for(;;)switch(vr.prev=vr.next){case 0:if(Er=(Sr=this).db,Pr={},!Er.enable){vr.next=33;break}return vr.prev=4,vr.next=7,Er.getTeamMemberTimetags();case 7:kr=vr.sent,vr.next=14;break;case 10:vr.prev=10,vr.t0=vr.catch(4),Sr.logger.error("sync::syncTeamMembers: getTeamMemberTimetags error",vr.t0),kr={};case 14:if(ze(pr)){vr.next=25;break}return vr.prev=15,vr.next=18,Er.getTeams();case 18:pr=vr.sent,vr.next=25;break;case 21:vr.prev=21,vr.t1=vr.catch(15),Sr.logger.error("sync::syncTeamMembers: getTeams error",vr.t1),pr=[];case 25:z(pr).call(pr,function(_r){Pr[_r.teamId]=0}),Ir={},z(Cr=re(kr)).call(Cr,function(_r){var Or=_r.split("-")[1];Ir[Or]=kr[_r]}),re(Ir).length&&(Pr=V(Pr,Ir)),Sr.logger.log("sync::syncTeamMembers: getTeamMemberTimetags",Pr),(xr=k(rr=Sr.onSyncTeamMembers).call(rr,Sr)).isImSyncDataCb=!0,Sr.sendCmd("syncTeamMembers",{sync:Pr,isImSyncDataObj:!0},xr);case 33:case"end":return vr.stop()}},hr,this,[[4,10],[15,21]])}));return function(hr){return or.apply(this,arguments)}}(),Lt.syncSuperTeamMembers=function(){var or=g(n.mark(function hr(pr){var Sr,Er,Pr,Cr,rr,kr,Ir,xr;return n.wrap(function(vr){for(;;)switch(vr.prev=vr.next){case 0:if(Er=(Sr=this).db,Pr={},!Er.enable){vr.next=33;break}return vr.prev=4,vr.next=7,Er.getSuperTeamMemberTimetags();case 7:kr=vr.sent,vr.next=14;break;case 10:vr.prev=10,vr.t0=vr.catch(4),Sr.logger.error("sync::syncSuperTeamMembers: getSuperTeamMemberTimetags error",vr.t0),kr={};case 14:if(ze(pr)){vr.next=25;break}return vr.prev=15,vr.next=18,Er.getSuperTeams();case 18:pr=vr.sent,vr.next=25;break;case 21:vr.prev=21,vr.t1=vr.catch(15),Sr.logger.error("sync::syncSuperTeamMembers: getSuperTeams error",vr.t1),pr=[];case 25:z(pr).call(pr,function(_r){Pr[_r.teamId]=0}),Ir={},z(Cr=re(kr)).call(Cr,function(_r){var Or=_r.split("-")[1];Ir[Or]=kr[_r]}),re(Ir).length&&(Pr=V(Pr,Ir)),Sr.logger.log("sync::syncSuperTeamMembers: getSuperTeamMemberTimetags",Pr),(xr=k(rr=Sr.syncSuperTeamMembersCallBack).call(rr,Sr)).isImSyncDataCb=!0,Sr.sendCmd("syncSuperTeamMembers",{sync:Pr,isImSyncDataObj:!0},xr);case 33:case"end":return vr.stop()}},hr,this,[[4,10],[15,21]])}));return function(hr){return or.apply(this,arguments)}}(),Lt.onSyncTeamMembers=function(or){or&&(or.callFunc="sync::onSyncTeamMembers",or.message="同步群成员错误",this.onCustomError("SYNC_TEAM_MEMBERS_ERROR",or))},Lt.syncSuperTeamMembersCallBack=function(or){or&&(or.callFunc="sync::SyncSuperTeamMembersCallBack",or.message="同步超级群成员错误",this.onCustomError("SYNC_SUPERTEAM_MEMBERS_ERROR",or))},Lt.onSyncTeamMembersDone=function(){var or=this,hr=or.options,pr=or.syncTeamMembersResult,Sr=or.syncTeamMembersPromiseArray;i.all(Sr).then(function(){var Er;Sr=[];var Pr={};z(Er=re(pr)).call(Er,function(Cr){var rr,kr,Ir,xr;ue(Cr).call(Cr,"invalid")===-1&&(Cr in Pr?($(rr=Pr[Cr].members).call(rr,pr[Cr]),$(kr=Pr[Cr].invalid).call(kr,pr[Cr+"-invalid"])):Pr[Cr]={members:$(Ir=[]).call(Ir,pr[Cr]||[]),invalid:$(xr=[]).call(xr,pr[Cr+"-invalid"]||[])})}),hr.onsyncteammembersdone(Pr),or.syncTeamMembersResult=[],or.syncTeamMembersPromiseArray=[]})},Lt.onSyncSuperTeamMembersDone=function(){var or=this,hr=or.options,pr=or.syncSuperTeamMembersResult,Sr=or.syncSuperTeamMembersPromiseArray;i.all(Sr).then(function(){var Er;Sr=[];var Pr={};z(Er=re(pr)).call(Er,function(Cr){var rr,kr,Ir,xr;ue(Cr).call(Cr,"invalid")===-1&&(Cr in Pr?($(rr=Pr[Cr].members).call(rr,pr[Cr]),$(kr=Pr[Cr].invalid).call(kr,pr[Cr+"-invalid"])):Pr[Cr]={members:$(Ir=[]).call(Ir,pr[Cr]||[]),invalid:$(xr=[]).call(xr,pr[Cr+"-invalid"]||[])})}),hr.onsyncsuperteammembersdone(Pr),or.syncSuperTeamMembersResult=[],or.syncSuperTeamMembersPromiseArray=[]})}},function(t,r,e){var n=e(790),g=e(794),y=e(753),i=e(798);t.exports=function(k){return n(k)||g(k)||y(k)||i()},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,r,e){var n=e(750),g=e(751);t.exports=function(y){if(n(y))return g(y)},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,r,e){t.exports=e(792)},function(t,r,e){var n=e(793);t.exports=n},function(t,r,e){var n=e(300);t.exports=n},function(t,r,e){var n=e(155),g=e(72),y=e(752);t.exports=function(i){if(n!==void 0&&g(i)!=null||i["@@iterator"]!=null)return y(i)},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,r,e){t.exports=e(796)},function(t,r,e){var n=e(797);t.exports=n},function(t,r,e){var n=e(301);t.exports=n},function(t,r){t.exports=function(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,r,e){var n=e(800);t.exports=n},function(t,r,e){e(801);var n=e(13);t.exports=n.Object.values},function(t,r,e){var n=e(1),g=e(802).values;n({target:"Object",stat:!0},{values:function(y){return g(y)}})},function(t,r,e){var n=e(27),g=e(12),y=e(120),i=e(44),k=g(e(150).f),$=g([].push),L=function(V){return function(z){for(var re,ie=i(z),ue=y(ie),le=ue.length,oe=0,ae=[];le>oe;)re=ue[oe++],n&&!k(ie,re)||$(ae,V?[re,ie[re]]:ie[re]);return ae}};t.exports={entries:L(!0),values:L(!1)}},function(t,r,e){t.exports=e(804)},function(t,r,e){var n=e(805);t.exports=n},function(t,r,e){var n=e(19),g=e(806),y=Array.prototype;t.exports=function(i){var k=i.findIndex;return i===y||n(y,i)&&k===y.findIndex?g:k}},function(t,r,e){e(807);var n=e(29);t.exports=n("Array").findIndex},function(t,r,e){var n=e(1),g=e(74).findIndex,y=e(199),i=!0;"findIndex"in[]&&Array(1).findIndex(function(){i=!1}),n({target:"Array",proto:!0,forced:i},{findIndex:function(k){return g(this,k,arguments.length>1?arguments[1]:void 0)}}),y("findIndex")},function(t,r,e){var n=e(9),g=e(10),y=e(3),i=e(2),k=e(35).fn,$=e(0),L=$.objs2accounts,V=e(809),z=e(204);k.processUser=function(re){var ie,ue=this,le=ue.db,oe=re.obj,ae=re.error,qe=re.content;switch(re.cmd){case"markInBlacklist":ae||ue.markInBlacklist(oe);break;case"syncMarkInBlacklist":ue.markInBlacklist(qe,!0);break;case"markInMutelist":ae||ue.markInMutelist(oe);break;case"syncMarkInMutelist":ue.markInMutelist(qe,!0);break;case"getRelations":ae||ue.onRelations(re);break;case"syncMyInfo":ue.onMyInfo(re,!0);break;case"updateMyInfo":ae||(oe.user.updateTime=qe.timetag,ue.onUpdateMyInfo(re,oe.user));break;case"syncUpdateMyInfo":ue.onUpdateMyInfo(re,qe.user,!0);break;case"getUsers":var de;ae||(ie=n(de=qe.users).call(de,function(Ne){return Ne=g(z).call(z,Ne,ue.mixStorePolicy&&ue.mixStorePolicy.s3Policy?ue.mixStorePolicy.s3Policy.dlcdns:[],ue.mixStorePolicy&&ue.mixStorePolicy.s3Policy?ue.mixStorePolicy.s3Policy.dlcdn:""),ue.mergeUser(Ne),Ne}),re.obj=ie,le.enable&&le.putUsers(ie));break;case"updateDonnop":ue.onUpdateDonnop(re);break;case"syncUpdateDonnop":ue.onDonnop(re,!1)}},k.onMyInfo=function(re){var ie,ue=this,le=ue.db,oe=re.error,ae=re.content,qe=new y(function(Ne,ze){var $e,Lt;oe?(oe&&(oe.callFunc="user::onMyInfo"),Ne(oe),ue.syncData()):(ie=g(z).call(z,ae.user),le.enable?($e=Ne,Lt=ze,le.mergeMyInfo(ie,!0).then(function(){de(),$e()}).then(void 0,function(jt){jt.message="db.mergeMyInfo error",jt.callFunc="user::onMyInfo",Lt(jt)})):(de(),Ne()))}).catch(function(Ne){return ue.logger.error("user::onMyInfo: ",Ne),y.reject(Ne)});function de(){ue.timetags.myInfo=ie.updateTime,ue.syncResult.myInfo=ie}qe.cmd="myInfo",ue.syncPromiseArray.push(qe)},k.onUpdateMyInfo=function(re,ie,ue){var le=this.db,oe=g(z).call(z,ie),ae=$.merge(this.myInfo,oe);this.myInfo=ae,ue?(this.logger.info("user::onUpdateMyInfo:",ae&&ae.account),this.options.onupdatemyinfo(ae)):re.obj=ae,le.enable&&(oe.account=this.account,le.updateUser(oe))},k.onRelations=function(re){var ie,ue=this,le=ue.db,oe=re.error,ae=ue.packetFromSync(re),qe=re.content.specialRelations,de=!0,Ne=[],ze=[],$e=[],Lt=[],jt=new y(function(ir,dr){var Dt,lr;oe?ae&&(ir(oe),ue.syncData()):(i(qe).call(qe,function(sr){var er={account:(sr=V.parse(sr)).account,createTime:sr.createTime,updateTime:sr.updateTime};sr.isBlacked?Ne.push(er):ze.push(er),sr.isMuted?$e.push(er):Lt.push(er)}),ue.logger.info("user::onRelations: parse blacklist",L(Ne),Ne,"delete",L(ze),ze),ue.logger.info("user::onRelations: parse mutelist",L($e),$e,"delete",L(Lt),Lt),qe.length?(de=!0,ie=re.content.timetag):de=!1,le.enable?(Dt=ir,lr=dr,re.promise=new y(function(sr,er){function cr(){ae?(Et(),sr(),Dt()):le.getRelations().then(function(or){Ne=or[0],$e=or[1],Et(),sr(),Dt()}).then(void 0,function(or){or.message="db.getRelations error",or.callFunc="user::onRelations",er(or),lr(or)})}de?le.mergeRelations(Ne,ze,$e,Lt,ie).then(function(){cr()}).then(void 0,function(or){or.message="db.mergeRelations error",or.callFunc="user::onRelations",er(or),lr(or)}):(ue.logger.warn("user::onRelations: no relations need merge"),cr())}).then(void 0,function(sr){throw sr.message="merge relations data error",sr.callFunc="user::onRelations",lr(sr),sr})):(Et(),ir()))}).catch(function(ir){return ue.logger.error("user::onRelations: ",ir),y.reject(ir)});function Et(){ue.timetags.relations=ie,Ne.invalid=ze,$e.invalid=Lt,ae?(ue.syncResult.blacklist=Ne,ue.syncResult.mutelist=$e,ue.syncResult.invalidBlacklist=ze,ue.syncResult.invalidMutelist=Lt):(ue.logger.info("user::onRelations: get relations",Ne,$e),re.obj.blacklist=Ne,re.obj.mutelist=$e)}ae&&(jt.cmd="relations",ue.syncPromiseArray.push(jt))},k.markInBlacklist=function(re,ie){var ue=this.db;re.record={account:re.account,updateTime:+new Date},ue.enable&&ue.markInBlacklist(re),ie&&(this.logger.info("user::markInBlacklist:",re),this.options.onsyncmarkinblacklist(re))},k.markInMutelist=function(re,ie){var ue=this.db;re.record={account:re.account,updateTime:+new Date},ue.enable&&ue.markInMutelist(re),ie&&(this.logger.info("user::markInMutelist:",re),this.options.onsyncmarkinmutelist(re))},k.mergeUser=function(re){this.userSet[re.account]=re}},function(t,r,e){var n=e(0);function g(){}g.parse=function(y){var i=n.copy(y);return i.isBlacked=i.isBlacked==="1",i.isMuted=i.isMuted==="1",i.createTime=+i.createTime,i.updateTime=+i.updateTime,i},t.exports=g},function(t,r,e){var n=e(125),g=e(2),y=e(10),i=e(3),k=e(6),$=e(9),L=["type"],V=e(35).fn,z=e(0),re=z.objs2accounts,ie=e(755),ue=e(204);V.processFriend=function(le){var oe=le.obj,ae=le.content,qe=le.error;switch(le.cmd){case"friendRequest":this.updateFriendSysMsg(le),qe||this.onFriendRequest(oe);break;case"syncFriendRequest":this.onFriendRequest(ae,!0);break;case"deleteFriend":qe||this.onDeleteFriend(oe);break;case"syncDeleteFriend":this.onDeleteFriend(ae,!0);break;case"updateFriend":qe||this.onUpdateFriend(oe);break;case"syncUpdateFriend":this.onUpdateFriend(ae.friend,!0);break;case"getFriends":this.getFriends(le);break;case"syncFriends":this.onFriends(le);break;case"syncFriendUsers":this.onFriendUsers(le)}},V.getFriends=function(le){var oe=le.content.friends,ae=[],qe=[];g(oe).call(oe,function(de){(de=y(ie).call(ie,de)).valid?ae.push(de):qe.push(de)}),ae.invalid=qe,le.obj=ae},V.onFriends=function(le){var oe,ae=this,qe=ae.db,de=le.error,Ne=le.content.friends,ze=!0,$e=[],Lt=[],jt=new i(function(ir,dr){var Dt,lr;de?dr(de):(function(){ze&&g(Ne).call(Ne,function(sr){(sr=y(ie).call(ie,sr)).valid?$e.push(sr):Lt.push(sr)}),ae.logger.info("friend::onFriends: parse friends",re($e),"delete",re(Lt)),Ne.length?(ze=!0,oe=le.content.timetag):ze=!1}(),qe.enable?(Dt=ir,lr=dr,le.promise=new i(function(sr,er){function cr(){Et(),sr(),Dt()}ze?qe.mergeFriends($e,Lt,oe).then(function(){cr()}).then(void 0,function(or){or._msg="merge friends error",er(or),lr(or)}):(ae.logger.info("friend::onFriends: no merge friends"),cr())}).then(void 0,function(sr){throw sr._msg="merge friends data error",lr(sr),sr})):(Et(),ir()))}).catch(function(ir){return ae.logger.error("friend::onFriends: ",ir),i.reject(ir)});function Et(){var ir,dr;ae.timetags.friends=oe,$e.invalid=Lt,ae.syncResult.friends=k(ir=ae.syncResult.friends||[]).call(ir,$e||[]),ae.syncResult.invalidFriends=k(dr=ae.syncResult.invalidFriends||[]).call(dr,Lt||[])}jt.cmd="friends",ae.syncPromiseArray.push(jt)},V.onFriendRequest=function(le,oe){var ae=i.resolve(),qe=this.db,de=le.type,Ne=n(le,L);if((de=le.type=ie.getTypeFromByte(de)||de)==="addFriend"||de==="passFriendApply"){var ze=le.friend=ie.assembleFriend(Ne);qe.enable&&(ae=qe.putFriend(ze))}return oe&&this.onSyncFriendAction(le),ae},V.onSyncFriendAction=function(le){this.logger.info("friend::onSyncFriendActionon: ".concat(le.type,", "),le.account),this.options.onsyncfriendaction(le)},V.onDeleteFriend=function(le,oe){var ae=i.resolve(),qe=this.db;return qe.enable&&(ae=qe.deleteFriend(le.account)),oe&&(le.type="deleteFriend",this.onSyncFriendAction(le)),ae},V.onUpdateFriend=function(le,oe){var ae=this.db,qe=y(ie).call(ie,le);ae.enable&&ae.updateFriend(qe),oe&&this.onSyncFriendAction({type:"updateFriend",friend:qe})},V.onFriendUsers=function(le){var oe,ae,qe=this.db,de=le.content,Ne=$(oe=de.users).call(oe,function(Lt){return y(ue).call(ue,Lt)});this.logger.info("friend::onFriendUsers: parse users",re(Ne));var ze=de.timetag,$e=i.resolve();qe.enable&&($e=qe.mergeFriendUsers(Ne,ze)),this.timetags.friendUsers=ze,$e.cmd="friendUsers",this.syncPromiseArray.push($e),this.syncResult.users=k(ae=this.syncResult.users||[]).call(ae,Ne||[]),this.syncing||this.onSyncDone()},V.updateFriendSysMsg=function(le){var oe,ae,qe=le.obj,de=le.error;if(le.obj.idServer){if(de)oe="error",de=z.filterObj(de,"code message");else{var Ne=qe.type;switch(Ne=ie.getTypeFromByte(Ne)||Ne){case"passFriendApply":oe="passed";break;case"rejectFriendApply":oe="rejected"}}ae={idServer:qe.idServer,state:oe,from:qe.account,type:"applyFriend"},de&&(ae.error=de),this.updateSysMsg(ae)}}},function(t,r,e){var n=e(32),g=e(16),y=e(35).fn,i=e(0);y.onRobots=function(k){var $=k.content;if(i.isFunction(this.options.onrobots)&&n($.robots)){var L,V=g(L=$.robots).call(L,function(z){return!!z.botid});V.length>0&&this.options.onrobots(V||[])}}},function(t,r,e){var n=e(57),g=e(58),y=e(10),i=e(2),k=e(24),$=e(121),L=e(3),V=e(9),z=e(6),re=e(16),ie=e(4),ue=e(35).fn,le=e(0),oe=le.objs2accounts,ae=le.teams2ids,qe=e(194),de=e(152);ue.processTeam=function(Ne){var ze,$e,Lt,jt=Ne.error;switch(Ne.obj===void 0&&(Ne.obj={}),Ne.cmd){case"createTeam":ze=Ne.obj.team,jt||(ze=Ne.content.team),ze=y(qe).call(qe,ze),Ne.obj.team=ze,Lt=de.assembleOwner(ze),Ne.obj.owner=Lt,jt||(this.logger.info("team::processTeam: create team ",ze&&ze.teamId,Lt&&Lt.account),this.onCreateTeam(ze,Lt));break;case"syncCreateTeam":ze=y(qe).call(qe,Ne.content.team),Lt=de.assembleOwner(ze),this.logger.info("team::processTeam: sync createTeam",ze&&ze.teamId,Lt&&Lt.account),this.options.onsynccreateteam(ze,Lt),this.onCreateTeam(ze,Lt);break;case"sendSuperTeamMsg":case"sendTeamMsg":this.onSendMsg(Ne);break;case"teamMsg":this.onMsg(Ne);break;case"teamMsgs":this.onMsgs(Ne);break;case"addTeamMembers":case"removeTeamMembers":case"leaveTeam":case"dismissTeam":case"addTeamManagers":case"removeTeamManagers":case"transferTeam":break;case"updateInfoInTeam":jt||(Ne.promise=this.onUpdateInfoInTeam(Ne));break;case"updateNickInTeam":Ne.obj=y(de).call(de,Ne.obj);break;case"updateTeam":Ne.obj=y(qe).call(qe,Ne.obj,!0);break;case"applyTeam":Ne.error||(Ne.obj=y(qe).call(qe,Ne.content.team));break;case"passTeamApply":this.updateTeamSysMsgState(Ne,"passed");break;case"rejectTeamApply":this.updateTeamSysMsgState(Ne,"rejected");break;case"acceptTeamInvite":this.updateTeamSysMsgState(Ne,"passed"),Ne.error||(Ne.obj=y(qe).call(qe,Ne.content.team));break;case"rejectTeamInvite":this.updateTeamSysMsgState(Ne,"rejected");break;case"getTeam":Ne.error||(Ne.obj=y(qe).call(qe,Ne.content.team));break;case"getTeams":this.onTeams(Ne);break;case"getTeamMembers":this.onTeamMembers(Ne);break;case"syncTeams":this.onTeams(Ne);break;case"syncTeamMembers":this.onTeamMembers(Ne);break;case"getTeamHistoryMsgs":case"searchTeamHistoryMsgs":this.onHistoryMsgs(Ne);break;case"syncSendTeamMsg":this.onMsg(Ne);break;case"notifyTeamMsgReads":this.onTeamMsgReceipt(Ne);break;case"syncUpdateTeamMember":($e=y(de).call(de,Ne.content.teamMember)).account===this.account&&this.mergeMyTeamMembers($e),this.onUpdateTeamMember($e);break;case"updateMuteStateInTeam":break;case"getMyTeamMembers":Ne.error||(Ne.obj=de.reverseMembers(Ne.content.teamMembers));break;case"getMutedTeamMembers":Ne.error||(Ne.obj={teamId:Ne.obj.teamId,members:de.reverseMembers(Ne.content.teamMembers)});break;case"syncMyTeamMembers":this.onSyncMyTeamMembers(Ne);break;case"sendTeamMsgReceipt":this.sendTeamMsgReceipt(Ne);break;case"getTeamMsgReads":this.getTeamMsgReads(Ne);break;case"getTeamMsgReadAccounts":this.getTeamMsgReadAccounts(Ne);break;case"getTeamsById":this.getTeamsById(Ne)}},ue.onUpdateInfoInTeam=function(){var Ne=g(n.mark(function ze($e){var Lt,jt,Et;return n.wrap(function(ir){for(;;)switch(ir.prev=ir.next){case 0:if(Lt=this,!($e.content&&$e.content.teamMember&&$e.content.teamMember.teamId)){ir.next=11;break}if(jt=y(de).call(de,$e.content.teamMember),!Lt.db.enable){ir.next=7;break}return ir.next=6,Lt.db.updateTeamMember(jt);case 6:jt=ir.sent;case 7:return Lt.mergeMyTeamMembers(jt),Lt.onUpdateTeamMember(jt),$e.obj=jt,ir.abrupt("return");case 11:if((Et=$e.obj.teamMember?$e.obj.teamMember:$e.obj).account=Lt.account,Et.account){ir.next=15;break}return ir.abrupt("return");case 15:Et.id=de.genId(Et.teamId,Et.account),Et=y(de).call(de,Et),Lt.mergeMyTeamMembers(Et),$e.obj=Lt.myTeamMembersMap&&Lt.myTeamMembersMap[Et.teamId]||Et,Lt.onUpdateTeamMember(Et);case 20:case"end":return ir.stop()}},ze,this)}));return function(ze){return Ne.apply(this,arguments)}}(),ue.getTeamMsgReads=function(Ne){var ze=this;if(Ne.error)this.logger.error("team::sendTeamMsgReceipt: ",Ne.error);else{var $e=le._get(Ne,"content.teamMsgReceipts")||[];if(this.db.enable){var Lt=[];i($e).call($e,function(jt){jt.idClient&&Lt.push({idClient:jt.idClient,unread:+jt.unread,read:+jt.read})}),Lt.length>0&&k(function(){return ze.db.updateMsgBatch(Lt)},0)}}},ue.getTeamMsgReadAccounts=function(Ne){if(Ne.error)this.logger.error("team::getTeamMsgReadAccounts: ",Ne.error);else{var ze=le._get(Ne,"content.readAccounts")||[],$e=le._get(Ne,"content.unreadAccounts")||[],Lt=le._get(Ne,"content.teamMsgReceipt.idClient")||[];this.db.enable&&this.db.putMsgReadDetail({idClient:Lt,readAccounts:ze,unreadAccounts:$e})}},ue.sendTeamMsgReceipt=function(Ne){var ze=this;if(Ne.error)this.logger.error("team::sendTeamMsgReceipt: ",Ne.error);else{var $e=le._get(Ne,"obj.teamMsgReceipts")||[],Lt=le._get(Ne,"content.teamMsgReceipts")||[];if(this.db.enable){var jt=[];i($e).call($e,function(Et){$(Lt).call(Lt,function(ir){return Et.idServer===ir.idServer})||jt.push({idClient:Et.idClient,hasRead:!0})}),jt.length>0&&(this.logger.log("sendTeamMsgReceipt::updateMsgBatch"),k(function(){return ze.db.updateMsgBatch(jt)},0))}}},ue.onCreateTeam=function(Ne,ze){var $e=this.db;$e.enable&&($e.putTeam(Ne),$e.putTeamMembers(ze)),this.options.onCreateTeam(Ne,ze)},ue.onTeams=function(Ne){Ne.content=Ne.content||{};var ze,$e=this,Lt=$e.db,jt=$e.packetFromSync(Ne),Et=Ne.content.teams||[],ir=!0,dr=[],Dt=[];if(Ne.error)switch(Ne.error.code){case 803:Ne.error=null,ir=!1}var lr=new L(function(er,cr){var or,hr;Ne.error?jt&&cr(Ne.error):(function(){ir&&i(Et).call(Et,function(pr){(pr=y(qe).call(qe,pr)).validToCurrentUser?dr.push(pr):Dt.push(pr)}),Et.length?(ir=!0,ze=Ne.content.timetag):ir=!1}(),Lt.enable?(or=er,hr=cr,Ne.promise=new L(function(pr,Sr){function Er(){jt?(sr(),pr(),or()):Lt.getTeams().then(function(Pr){dr=Pr,sr(),pr(),or()}).catch(function(Pr){Pr.message="db.getTeams error",Pr.callFunc="team::afterMergeData",Sr(Pr),hr(Pr)})}ir?Lt.mergeTeams(dr,Dt,ze).then(function(){Er()}).catch(function(Pr){var Cr={callFunc:"team::onTeams:mergeData",message:"db.mergeTeams error",event:Pr};Sr(Cr),hr(Cr)}):($e.logger.warn("team::onTeams:mergeData: no teams need merge"),Er())}).then(void 0,function(pr){throw pr.message="merge teams data error",pr.callFunc="team::mergeData",hr(pr),pr})):(sr(),er()))}).catch(function(er){return $e.logger.error("team::onTeams: ",er),L.reject(er)});function sr(){$e.timetags.teams=ze,dr.invalid=Dt,jt?($e.syncResult.teams=dr,$e.syncResult.invalidTeams=Dt,$e.syncing||$e.onSyncDone()):($e.logger.info("team::onTeams: not in syncing, get teams",ae(dr)),Ne.obj=dr)}jt&&(lr.cmd="teams",$e.syncPromiseArray.push(lr))},ue.getTeamsById=function(Ne){var ze;if(Ne.error){if(Ne.error.code!==816)return;this.logger.error("team::getTeamsById: ",Ne.error),Ne.error=null}Ne.content.teams=V(ze=Ne.content.teams).call(ze,function($e){return y(qe).call(qe,$e)}),Ne.obj=Ne.content},ue.onTeamMembers=function(Ne){Ne.content=Ne.content||{};var ze,$e=this,Lt=$e.db,jt=$e.packetFromSync(Ne),Et=Ne.content.members||[],ir=!0,dr=[],Dt=[];if(Ne.obj&&(ze=Ne.obj.teamId),ze||(ze=Ne.content.teamId),ze=""+ze,Ne.error)switch(Ne.error.code){case 406:Ne.error=null,ir=!1}var lr=new L(function(sr,er){Ne.error?($e.logger.error("team::onTeamMember: team error:",ze,Ne.error),sr()):(function(){ir&&i(Et).call(Et,function(cr){(cr=y(de).call(de,cr)).valid?dr.push(cr):Dt.push(cr)}),Et.length?(ir=!0,Ne.content.timetag):ir=!1}(),function(cr,or){if(jt){$e.syncTeamMembersResult[ze]=dr,$e.syncTeamMembersResult[ze+"-invalid"]=Dt;var hr=z(dr).call(dr,Dt);Lt.putTeamMembers(hr).catch(function(pr){throw $e.logger.error("team::onTeamMembers: putTeamMembers error: ",pr),pr}).then(function(){return Lt.updateTeamMemberTimetag(ze,Ne.content.timetag)}).catch(function(pr){$e.logger.error("team::onTeamMembers error: ",pr,ze,Ne.content.timetag)}).then(cr)}else $e.logger.info("team::onTeamMembers: not syncing, get members",ze,oe(dr)),Ne.obj={teamId:ze,members:dr},cr()}(sr))});jt&&(lr.cmd=ze,$e.syncTeamMembersPromiseArray.push(lr))},ue.onUpdateTeamMember=function(Ne){if(Ne.updateTime||(Ne.updateTime=+new Date),this.account===Ne.account){var ze=this.myTeamMembersMap[Ne.teamId];this.logger.info("team::onMyTeamMembers: ",[ze]),Ne=ze||Ne,this.options.onMyTeamMembers(le.simpleClone([ze]))}this.logger.info("team::onUpdateTeamMember: ",Ne&&Ne.account),this.options.onupdateteammember(le.simpleClone(Ne));var $e={teamId:Ne.teamId,memberUpdateTime:Ne.updateTime};this.onUpdateTeam($e);var Lt=this.db;Lt.enable&&Lt.updateTeamMember(Ne)},ue.onUpdateTeam=function(Ne){this.logger.info("team::onUpdateTeam:",Ne&&Ne.teamId),this.options.onUpdateTeam(le.simpleClone(Ne));var ze=this.db;ze.enable&&ze.updateTeam(Ne)},ue.onSyncMyTeamMembers=function(Ne){var ze=this,$e=ze.db,Lt=de.reverseMembers(Ne.content.teamMembers);if($e.enable){var jt=$e.putTeamMembers(Lt).then(function(){return $e.updateMyTeamMembersTimetag(Ne.content.timetag)}).catch(function(Et){return ze.logger.error("team::syncMyTeamMember: ",Et),L.reject(Et)});jt.cmd="myTeamMembers",ze.syncTeamMembersPromiseArray.push(jt),ze.syncPromiseArray.push(jt)}else ze.syncResult.myTeamMembers=Lt;ze.mergeMyTeamMembers(Lt)},ue.mergeMyTeamMembers=function(Ne){le.isArray(Ne)||(Ne=[Ne]);var ze=this.myTeamMembersMap=this.myTeamMembersMap||{};i(Ne).call(Ne,function($e){var Lt=$e.teamId;ze[Lt]=le.merge(ze[Lt],$e)})},ue.notifyForNewTeamMsg=function(Ne){le.isArray(Ne)||(Ne=[Ne]);var ze=this,$e=this.myTeamMembersMap||{},Lt={},jt=[];i(Ne).call(Ne,function(ir){le.exist($e[ir])?Lt[ir]=$e[ir].muteNotiType:jt.push(ir)});var Et=L.resolve({map:Lt});return jt.length&&(Et=ze.api.getMyTeamMembers({teamIds:jt,promise:!0}).then(function(ir){ze.mergeMyTeamMembers(ir),i(ir).call(ir,function(Dt){Lt[Dt.teamId]=Dt.muteNotiType});var dr=re(Ne).call(Ne,function(Dt){return!Lt[Dt]});return L.resolve({map:Lt,miss:dr})}).catch(function(ir){return ie(Lt).length>0?L.resolve({map:Lt,miss:jt,error:ir}):L.reject(ir)})),Et},ue.updateTeamSysMsgState=function(Ne,ze){var $e,Lt=Ne.error;Lt&&(ze="error",Lt=le.filterObj(Lt,"code message")),$e={idServer:Ne.obj.idServer,state:ze,from:Ne.obj.from,type:Ne.obj.type},Lt&&($e.error=Lt),this.updateSysMsg($e)},ue.onTeamMsgReceipt=function(Ne){var ze=Ne.content,$e=Ne.error;$e&&this.logger.error("team::onTeamMsgReceipt:",$e),ze&&ze.teamMsgReceipts&&(this.options.onTeamMsgReceipt(ze),this.options.onMsgReceipts(ze.teamMsgReceipts))}},function(t,r,e){var n=e(57),g=e(58),y=e(10),i=e(3),k=e(2),$=e(6),L=e(35).fn,V=e(0),z=V.teams2ids,re=e(308),ie=e(203);L.processSuperTeam=function(ue){var le,oe,ae,qe=ue.error;switch(ue.obj===void 0&&(ue.obj={}),ue.cmd){case"sendSuperTeamMsg":this.onSendMsg(ue);break;case"superTeamMsg":this.onMsg(ue);break;case"sendSuperTeamCustomSysMsg":this.onSendSysMsg(ue);break;case"superTeamCustomSysMsg":this.onSysMsg(ue);break;case"syncSuperTeams":this.onSuperTeams(ue);break;case"syncCreateSuperTeam":le=y(re).call(re,ue.content.team),ae=ie.assembleOwner(le),this.logger.info("team::processTeam: sync createTeam",le&&le.teamId,ae&&ae.account),this.options.onSyncCreateSuperTeam(le,ae),this.onCreateSuperTeam(le,ae);break;case"getSuperTeamHistoryMsgs":case"searchSuperTeamHistoryMsgs":this.onHistoryMsgs(ue);break;case"syncSendSuperTeamMsg":this.onMsg(ue);break;case"addSuperTeamMembers":case"removeSuperTeamMembers":case"leaveSuperTeam":case"addSuperTeamManagers":case"removeSuperTeamManagers":case"transferSuperTeam":break;case"updateInfoInSuperTeam":qe||(ue.promise=this.onUpdateInfoInSuperTeam(ue));break;case"updateNickInTeam":ue.obj=y(ie).call(ie,ue.obj);break;case"syncUpdateSuperTeamMember":(oe=y(ie).call(ie,ue.content.teamMember)).account===this.account&&this.mergeMySuperTeamMembers(oe),this.onUpdateSuperTeamMember(oe);break;case"updateSuperTeam":ue.obj=y(re).call(re,ue.obj,!0);break;case"getSuperTeam":ue.error||(ue.obj=y(re).call(re,ue.content.team));break;case"getSuperTeams":this.onSuperTeams(ue);break;case"syncSuperTeamMembers":this.onSyncSuperTeamMembers(ue);break;case"syncMySuperTeamMembers":this.onSyncMySuperTeamMembers(ue);break;case"getSuperTeamMembers":ue.error||this.onGetAllSuperTeamMembers(ue);break;case"getSuperTeamMembersByJoinTime":case"getSuperTeamMembersByAccounts":case"getMutedSuperTeamMembers":ue.error||this.onSuperTeamMembers(ue);break;case"onDeleteSuperTeamMsg":this.onDeleteMsg(ue);break;case"onSuperTeamMsgDelete":case"syncDeleteSuperTeamMsg":this.onMsgDeleted(ue,!0);break;case"onMarkSuperTeamSessionAck":this.onMarkSessionAck(ue);break;case"syncMarkSuperTeamSessionAck":this.syncMarkSessionAck(ue);break;case"passSuperTeamApply":this.updateSuperTeamSysMsgState(ue,"passed");break;case"rejectSuperTeamApply":this.updateTeamSysMsgState(ue,"rejected");break;case"acceptSuperTeamInvite":this.updateTeamSysMsgState(ue,"passed");break;case"rejectSuperTeamInvite":this.updateSuperTeamSysMsgState(ue,"rejected");break;case"getMySuperTeamMembers":ue.error||(ue.obj=ie.reverseMembers(ue.content.members))}},L.onUpdateInfoInSuperTeam=function(){var ue=g(n.mark(function le(oe){var ae,qe,de;return n.wrap(function(Ne){for(;;)switch(Ne.prev=Ne.next){case 0:if(ae=this,!(oe.content&&oe.content.superTeamMember&&oe.content.superTeamMember.teamId)){Ne.next=11;break}if(qe=y(ie).call(ie,oe.content.superTeamMember),!ae.db.enable){Ne.next=7;break}return Ne.next=6,ae.db.updateSuperTeamMember(qe);case 6:qe=Ne.sent;case 7:return ae.mergeMySuperTeamMembers(qe),ae.onUpdateSuperTeamMember(qe),oe.obj=qe,Ne.abrupt("return");case 11:(de=oe.obj.superTeamMember?oe.obj.superTeamMember:oe.obj).account=ae.account,de.id=ie.genId(de.teamId,de.account),de=y(ie).call(ie,de),ae.mergeMySuperTeamMembers(de),oe.obj=ae.mySuperTeamMembersMap&&ae.mySuperTeamMembersMap[de.teamId]||de,ae.onUpdateSuperTeamMember(de);case 18:case"end":return Ne.stop()}},le,this)}));return function(le){return ue.apply(this,arguments)}}(),L.onSuperTeams=function(ue){ue.content=ue.content||{};var le,oe=this,ae=oe.db,qe=oe.packetFromSync(ue),de=ue.content.teams||[],Ne=!0,ze=[],$e=[];if(ue.error)switch(ue.error.code){case 803:ue.error=null,Ne=!1}var Lt=new i(function(Et,ir){var dr,Dt;ue.error?qe&&ir(ue.error):(function(){Ne&&k(de).call(de,function(lr){(lr=y(re).call(re,lr)).validToCurrentUser?ze.push(lr):$e.push(lr)}),de.length?(Ne=!0,le=ue.content.timetag):Ne=!1}(),ae.enable?(dr=Et,Dt=ir,ue.promise=new i(function(lr,sr){function er(){qe?(jt(),lr(),dr()):ae.getSuperTeams().then(function(cr){ze=cr,jt(),lr(),dr()}).then(void 0,function(cr){cr.message="db.getSuperTeams error",cr.callFunc="superTeam::afterMergeData",sr(cr),Dt(cr)})}Ne?ae.mergeSuperTeams(ze,$e,le).then(function(){er()}).then(void 0,function(cr){var or={callFunc:"superTeam::onSuperTeams:mergeData",message:"db.mergeSuperTeams error",event:cr};sr(or),Dt(or)}):(oe.logger.warn("superTeam::onSuperTeams:mergeData: no teams need merge"),er())}).then(void 0,function(lr){throw lr.message="merge teams data error",lr.callFunc="superTeam::mergeData",Dt(lr),lr})):(jt(),Et()))}).catch(function(Et){return oe.logger.error("superTeam::onSuperTeams: ",Et),i.reject(Et)});function jt(){oe.timetags.superTeams=le,ze.invalid=$e,qe?(oe.syncResult.superTeams=ze,oe.syncResult.invalidSuperTeams=$e):(oe.logger.info("superTeam::onSuperTeams: not in syncing, get teams",z(ze)),ue.obj=ze)}qe&&(Lt.cmd="superteams",oe.syncPromiseArray.push(Lt))},L.onCreateSuperTeam=function(ue,le){var oe=this.db;oe.enable&&(oe.putSuperTeam(ue),oe.putSuperTeamMembers(le))},L.onGetAllSuperTeamMembers=function(ue){var le=this,oe=this.db,ae=ue.raw.ser,qe=this.superTeamMembersData[ae]||{},de=qe.teamId||ue.obj&&ue.obj.teamId;if(oe.enable){var Ne=ue.content&&ue.content.timetag,ze=ue.raw.code===200?i.all(qe.pArr):i.resolve();ue.promise=ze.then(function(){return oe.getSuperTeamMembers(de).then(function($e){Ne&&oe.updateSuperTeamMemberTimetag(de,Ne),ue.obj={members:$e,invalid:[],teamId:de}})}).catch(function($e){return le.logger.error($e)})}else ue.obj={members:qe.members,invalid:qe.invalid,teamId:de};this.superTeamMembersData[ae]=void 0},L.onSyncSuperTeamMembers=function(ue){var le,oe=this,ae=this.db,qe=[],de=[],Ne=ue.content.members||[],ze=ue.raw.ser,$e=oe.packetFromSync(ue);if(ue.obj&&(le=ue.obj.teamId),le||(le=ue.content.teamId),k(Ne).call(Ne,function(ir){(ir=y(ie).call(ie,ir)).valid?de.push(ir):qe.push(ir)}),$e){var Lt=new i(function(ir,dr){if(ue.error)oe.logger.error("team::onSuperTeamMember: team error:",le,ue.error),ir();else{oe.syncSuperTeamMembersResult[le]=de,oe.syncSuperTeamMembersResult[le+"-invalid"]=qe;var Dt=$(de).call(de,qe);ae.putSuperTeamMembers(Dt).catch(function(lr){throw oe.logger.error("team::onSuperTeamMembers: putSuperTeamMembers error: ",lr),lr}).then(function(){return ae.updateSuperTeamMemberTimetag(le,ue.content.timetag)}).catch(function(lr){oe.logger.error("team::onSuperTeamMembers error: ",lr,le,ue.content.timetag)}).then(ir)}});oe.syncSuperTeamMembersPromiseArray.push(Lt)}else{if(ae.enable){oe.superTeamMembersData[ze]=oe.superTeamMembersData[ze]||{teamId:le,pArr:[]};var jt=i.resolve();ue.content&&ue.content.isAll&&(jt=ae.deleteSuperTeamMembers(le));var Et=jt.then(function(){return ae.mergeSuperTeamMembers(le,de,qe)}).then(function(){return i.resolve()});oe.superTeamMembersData[ze].pArr.push(Et)}else oe.superTeamMembersData[ze]=oe.superTeamMembersData[ze]||{teamId:le,members:[],invalid:[]},de.length&&(oe.superTeamMembersData[ze].members=oe.api.mergeTeamMembers(oe.superTeamMembersData[ze].members,de)),qe.length&&(oe.superTeamMembersData[ze].invalid=oe.api.mergeTeamMembers(oe.superTeamMembersData[ze].invalid,qe));ue.raw=void 0}},L.onSyncMySuperTeamMembers=function(ue){var le=this,oe=le.db,ae=ie.reverseMembers(ue.content.teamMembers);if(oe.enable){var qe=oe.putSuperTeamMembers(ae).then(function(){return oe.updateMySuperTeamMembersTimetag(ue.content.timetag)}).catch(function(de){return le.logger.error("superTeam::syncMySuperTeamMember: ",de),i.reject(de)});le.syncPromiseArray.push(qe)}else le.syncResult.mySuperTeamMembers=ae;le.mergeMySuperTeamMembers(ae)},L.onSuperTeamMembers=function(ue,le){var oe,ae=this.db,qe=[],de=[],Ne=ue.content.members||[];k(Ne).call(Ne,function(ze){(ze=y(ie).call(ie,ze)).valid?de.push(ze):qe.push(ze)}),ue.obj&&(oe=ue.obj.teamId),oe||(oe=ue.content.teamId||de[0]&&de[0].teamId),ae.enable&&!le&&ae.mergeSuperTeamMembers(oe,de,qe),ue.obj={members:de,invalid:qe,teamId:oe}},L.onUpdateSuperTeamMember=function(ue){if(ue.updateTime||(ue.updateTime=+new Date),this.account===ue.account){var le=this.mySuperTeamMembersMap[ue.teamId];this.logger.info("superTeam::onMySuperTeamMembers: ",[le]),ue=le||ue,this.options.onMySuperTeamMembers(V.simpleClone([le]))}this.logger.info("superTeam::onUpdateSuperTeamMember: ",ue&&ue.account),this.options.onUpdateSuperTeamMember(V.simpleClone(ue));var oe={teamId:ue.teamId,memberUpdateTime:ue.updateTime};this.onUpdateSuperTeam(oe);var ae=this.db;ae.enable&&ae.updateSuperTeamMember(ue)},L.onUpdateSuperTeam=function(ue){this.logger.info("superteam::onUpdateSuperTeam:",ue&&ue.teamId),this.options.onUpdateSuperTeam(V.simpleClone(ue));var le=this.db;le.enable&&le.updateSuperTeam(ue)},L.mergeMySuperTeamMembers=function(ue){V.isArray(ue)||(ue=[ue]);var le=this.mySuperTeamMembersMap=this.mySuperTeamMembersMap||{};k(ue).call(ue,function(oe){var ae=oe.teamId;le[ae]=V.merge(le[ae],oe)})},L.updateSuperTeamSysMsgState=function(ue,le){var oe,ae=ue.error;ae&&(le="error",ae=V.filterObj(ae,"code message")),oe={idServer:ue.obj.idServer,state:le,from:ue.obj.from,type:ue.obj.type},ae&&(oe.error=ae),this.updateSysMsg(oe)}},function(t,r,e){var n=e(10),g=e(3),y=e(24),i=e(35).fn,k=e(0),$=e(310);i.processNotify=function(L){switch(L.cmd){case"syncOfflineNetcallMsgs":case"syncOfflineMsgs":this.onOfflineMsgs(L);break;case"batchMarkRead":break;case"syncOfflineSysMsgs":case"syncOfflineSuperTeamSysMsgs":this.onOfflineSysMsgs(L);break;case"syncRoamingMsgs":case"syncSuperTeamRoamingMsgs":this.onRoamingMsgs(L);break;case"syncOfflineFilterMsgs":this.onOfflineMsgs(L,!0);break;case"syncOfflineFilterSysMsgs":this.onOfflineSysMsgs(L,!0);break;case"syncMsgReceipts":this.onOfflineMsgReceipts(L);break;case"syncDonnop":this.onDonnop(L,!0);break;case"syncSessionAck":this.syncSessionAck(L);break;case"syncSuperTeamSessionAck":this.syncSuperTeamSessionAck(L);break;case"syncRobots":this.onRobots(L);break;case"syncBroadcastMsgs":this.onBroadcastMsgs(L);break;case"syncDeleteSuperTeamMsgOfflineRoaming":this.onDeleteMsgOfflineRoaming(L);break;case"syncDeleteMsgSelf":this.syncDeleteMsgSelf(L);break;case"syncSessionsWithMoreRoaming":this.syncSessionsWithMoreRoaming(L);break;case"syncStickTopSessions":this.syncStickTopSessions(L);break;case"syncSessionHistoryMsgsDelete":this.syncSessionHistoryMsgsDelete(L)}},i.onDonnop=function(L,V){if(!L.error){var z=this,re=z.db,ie=n($).call($,L.content.donnop);z.mergeDonnop(ie);var ue=z.dbDonnop();if(V){var le=L.content.timetag;z.timetags.donnop=le,re.enable&&(ue=ue.then(function(){return z.db.updateDonnopTimetag(le)}).catch(function(oe){return z.logger.error("notify::onDonnop: ",oe),g.reject(oe)})),ue.cmd="donnop",z.syncPromiseArray.push(ue)}else z.onPushNotificationMultiportConfigUpdate()}},i.onUpdateDonnop=function(L){if(!L.error){var V=L.obj;V&&(this.mergeDonnop(k.filterObj(V,["shouldPushNotificationWhenPCOnline"])),this.dbDonnop(),this.onPushNotificationMultiportConfigUpdate())}},i.getPushNotificationMultiportConfig=function(){return k.merge({},this.pushNotificationMultiportConfig)},i.mergeDonnop=function(L){this.pushNotificationMultiportConfig=k.merge({},this.pushNotificationMultiportConfig,L)},i.dbDonnop=function(){return this.db.enable?this.db.setDonnop(this.pushNotificationMultiportConfig):g.resolve()},i.onPushNotificationMultiportConfigUpdate=function(){var L=this;y(function(){var V=L.getPushNotificationMultiportConfig();L.logger.info("link::onPushNotificationMultiportConfigUpdate:",V),L.options.onPushNotificationMultiportConfigUpdate(V)})}},function(t,r,e){var n=e(51),g=e(2),y=e(16),i=e(9),k=e(3),$=e(4),L=e(7),V=e(8),z=e(10),re=e(122),ie=e(6),ue=e(24),le=e(26),oe=e(48),ae=e(37),qe=e(158),de=e(52),Ne=e(53),ze=e(54),$e=e(55),Lt=e(43),jt=e(15),Et=e(88),ir=e(89),dr=e(72),Dt=e(32);function lr(vr,_r){var Or=ir!==void 0&&dr(vr)||vr["@@iterator"];if(!Or){if(Dt(vr)||(Or=function($r,Lr){var Gr;if($r){if(typeof $r=="string")return sr($r,Lr);var qr=jt(Gr=Object.prototype.toString.call($r)).call(Gr,8,-1);if(qr==="Object"&&$r.constructor&&(qr=$r.constructor.name),qr==="Map"||qr==="Set")return Et($r);if(qr==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(qr))return sr($r,Lr)}}(vr))||_r&&vr&&typeof vr.length=="number"){Or&&(vr=Or);var Mr=0,yr=function(){};return{s:yr,n:function(){return Mr>=vr.length?{done:!0}:{done:!1,value:vr[Mr++]}},e:function($r){throw $r},f:yr}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var mr,Tr=!0,Br=!1;return{s:function(){Or=Or.call(vr)},n:function(){var $r=Or.next();return Tr=$r.done,$r},e:function($r){Br=!0,mr=$r},f:function(){try{Tr||Or.return==null||Or.return()}finally{if(Br)throw mr}}}}function sr(vr,_r){(_r==null||_r>vr.length)&&(_r=vr.length);for(var Or=0,Mr=new Array(_r);Or<_r;Or++)Mr[Or]=vr[Or];return Mr}function er(vr,_r){var Or=$(vr);if(de){var Mr=de(vr);_r&&(Mr=y(Mr).call(Mr,function(yr){return Ne(vr,yr).enumerable})),Or.push.apply(Or,Mr)}return Or}var cr=e(35).fn,or=e(0),hr=or.undef,pr=e(45),Sr=e(152),Er=e(203),Pr=e(154),Cr=e(291),rr=e(11),kr=e(64),Ir=e(76);function xr(vr,_r,Or){var Mr=this,yr=Mr.message.Message,mr=Or?"offlineFilterMsgs":"offlineMsgs";if(!(_r&&_r.length>0))return k.resolve();var Tr=yr.getMaxTimetag(_r),Br=_r[0].scene,$r=_r[0].target;Mr.markMsgRead(_r),_r=yr.deduplication(_r),_r=yr.sortMsgs(_r);var Lr=Mr.genSessionByMsgs(_r);Mr.cacheSyncedSession(Lr);var Gr=Mr.putMsg(_r,"offlineMsgs").then(function(qr){var Yr=qr;(Yr=Mr.filterIgnore(Yr)).length&&(Mr.logger.info("msg::onOfflineMsgs： toreLastSession",mr,vr,Yr.length),Mr.syncResult[mr]=Mr.syncResult[mr]||[],Mr.syncResult[mr].push({sessionId:vr,scene:Br,to:$r,msgs:Yr,timetag:Tr}))}).catch(function(qr){return Mr.logger.error("msg::onOfflineMsgs: ",qr),k.reject(qr)});return Gr.cmd="offlineMsgs-"+vr,Gr}cr.processMsg=function(vr){switch(vr.cmd){case"sendMsg":this.onSendMsg(vr);break;case"msg":this.onMsg(vr);break;case"sysMsg":this.onSysMsg(vr);break;case"broadcastMsg":this.onBroadcastMsg(vr);break;case"sendCustomSysMsg":this.onSendSysMsg(vr);break;case"getHistoryMsgs":case"searchHistoryMsgs":this.onHistoryMsgs(vr);break;case"msgFtsInServer":case"msgFtsInServerByTiming":this.onmsgFtsInServer(vr);break;case"syncSendMsg":this.onMsg(vr);break;case"deleteSessions":this.onDeleteSessions(vr);break;case"sendMsgReceipt":this.onSendMsgReceipt(vr);break;case"msgReceipt":this.onMsgReceipt(vr);break;case"onDeleteMsg":this.onDeleteMsg(vr);break;case"onMsgDeleted":this.onMsgDeleted(vr);break;case"onDeleteMsgOfflineRoaming":this.onDeleteMsgOfflineRoaming(vr);break;case"onMarkSessionAck":this.onMarkSessionAck(vr);break;case"syncMarkSessionAck":this.syncMarkSessionAck(vr);break;case"syncUpdateServerSession":this.onSyncUpdateServerSession(vr);break;case"deleteMsgSelf":this.deleteMsgSelf(vr);break;case"deleteMsgSelfBatch":this.deleteMsgSelfBatch(vr);break;case"onDeleteMsgSelf":this.onDeleteMsgSelf(vr);break;case"onDeleteMsgSelfBatch":this.onDeleteMsgSelfBatch(vr);break;case"clearServerHistoryMsgs":this.clearServerHistoryMsgs(vr);break;case"onClearServerHistoryMsgs":this.onClearServerHistoryMsgs(vr)}},cr.checkIgnore=function(vr){var _r=this;g(vr).call(vr,function(Or){if(!Or.ignore){try{_r.options.shouldIgnoreMsg(Or)&&(Or.ignore=!0)}catch(yr){throw _r.logger.error("userOption:shouldIgnoreMsg function error",yr),yr}var Mr;try{Mr=_r.options.shouldIgnoreNotification(Or)}catch(yr){throw _r.logger.error("userOption:shouldIgnoreNotification function error",yr),yr}Or.type==="notification"&&Mr&&(Or.ignore=!0)}})},cr.filterIgnore=function(vr){return y(vr).call(vr,function(_r){return!_r.ignore})},cr.genSessionByMsgs=function(vr){return this.checkIgnore(vr),Pr.genSessionByMsgs(this.message.Message,vr)},cr.onRoamingMsgs=function(vr){var _r=this,Or=_r.message,Mr=Or.Message,yr=Mr.getMaxTimetag,mr=Or.reverseMsgs(vr.content.msgs),Tr=yr(mr);mr=Mr.deduplication(mr);var Br=(mr=Mr.sortMsgs(mr))[0],$r=Br.sessionId,Lr=_r.genSessionByMsgs(mr);_r.cacheSyncedSession(Lr);var Gr=_r.putMsg(mr,"roamingMsgs").then(function(qr){var Yr,bn=(mr=qr).length,wn=(mr=_r.filterIgnore(mr)).length;bn!==wn&&_r.logger.info("msg::onRoamingMsgs msg length before filter: "+bn+" after filter: "+wn),mr.length&&(_r.logger.info("msg::onRoamingMsgs: putRoamingMsgs",$r,mr.length,i(Yr=mr||[]).call(Yr,function(Xr){return"idServer: "+Xr.idServer+" idClient: "+Xr.idClient+" time:"+Xr.time+" type: "+Xr.type}).join(`
`)),_r.syncResult.roamingMsgs=_r.syncResult.roamingMsgs||[],_r.syncResult.roamingMsgs.push({sessionId:$r,scene:Br.scene,to:Br.target,msgs:mr,timetag:Tr}),_r.syncing||_r.roamingMsgSyncDoneBufferManager.add())}).catch(function(qr){return _r.logger.error("msg::onRoamingMsgs: ",qr),k.reject(qr)});Gr.cmd="roamingMsgs-"+$r,_r.syncPromiseArray.push(Gr)},cr.onOfflineMsgs=function(vr,_r){var Or,Mr=this,yr=this.message,mr=null;_r&&(mr={filter:!0});var Tr=yr.reverseMsgs(vr.content.msgs,{modifyObj:mr});Tr=Ir.deduplication(Tr);var Br={};g(Tr).call(Tr,function(Gr){Br[Gr.sessionId]=Br[Gr.sessionId]||[],Br[Gr.sessionId].push(Gr)});var $r=i(Or=$(Br)).call(Or,function(Gr){return{sessionId:Gr,msgs:Br[Gr]}}),Lr=or.asyncPool(50,$r,function(Gr){return xr.call(Mr,Gr.sessionId,Gr.msgs,_r)});this.syncPromiseArray.push(Lr)},cr.completeMsg=function(vr){return vr.from=this.account,vr.fromNick=this.myInfo&&this.myInfo.nick,vr.fromClientType="Web",vr.fromDeviceId=pr.deviceId,vr.time||(vr.time=+new Date),vr},cr.amendMsg=function(vr){if(vr.scene==="team"){var _r=or.get(this.myTeamMembersMap,vr.to+".nickInTeam");_r&&(vr.fromNick=_r)}else if(vr.scene==="superTeam"){var Or=or.get(this.mySuperTeamMembersMap,vr.to+".nickInTeam");Or&&(vr.fromNick=Or)}return vr},cr.onMsgs=function(vr){var _r=this,Or=_r.reporterHook.getSafeClock(),Mr=_r.message.reverseMsgs(vr.content.msgs,{mapper:function(yr){var mr=function(Tr){for(var Br=1;Br<arguments.length;Br++){var $r,Lr,Gr=arguments[Br]!=null?arguments[Br]:{};Br%2?g($r=er(Object(Gr),!0)).call($r,function(qr){n(Tr,qr,Gr[qr])}):ze?$e(Tr,ze(Gr)):g(Lr=er(Object(Gr))).call(Lr,function(qr){Lt(Tr,qr,Ne(Gr,qr))})}return Tr}({},yr);if(mr.__receiveTime=vr.__receiveTime,mr.__handleTime=Or,mr.__clientExt)try{mr.__clientExt=JSON.parse(mr.__clientExt)}catch{_r.logger.warn("IMProtocolFn:onMsg __clientExt parse failed ".concat(mr.__clientExt))}return _r.handleMsg(mr),mr}});_r.pushMsgDelay(Mr)},cr.onMsg=function(vr,_r){var Or;if(vr.content.msg.attach){var Mr=null;try{Mr=JSON.parse(vr.content.msg.attach)}catch{}if(Mr&&Mr.url&&or.get(this.mixStorePolicy,"s3Policy.dlcdns")){var yr,mr=lr(this.mixStorePolicy.s3Policy.dlcdns);try{for(mr.s();!(yr=mr.n()).done;){var Tr,Br=yr.value;L(Tr=Mr.url).call(Tr,Br)>=0&&(Mr.isS3=!0,Br!==this.mixStorePolicy.s3Policy.dlcdn&&(Mr.url=Mr.url.replace(Br,this.mixStorePolicy.s3Policy.dlcdn)))}}catch(Lr){mr.e(Lr)}finally{mr.f()}}vr.content.msg.attach=V(Mr)}var $r=z(Or=this.message).call(Or,vr.content.msg);if($r.__receiveTime=vr.__receiveTime,$r.__handleTime=this.reporterHook.getSafeClock(),or.get(vr,"content.msg.__clientExt"))try{$r.__clientExt=JSON.parse(vr.content.msg.__clientExt)}catch{this.logger.warn("IMProtocolFn:onMsg __clientExt parse failed ".concat(vr.content.msg.__clientExt))}_r&&($r.filter=!0),vr.cmd!=="syncSendMsg"||$r.from!==$r.to?(this.pushMsgDelay([$r]),this.syncing?(this.logger.info("msg::onMsg:is in syncing ..."),this.unhandledMsgs.push({type:"onMsg",msg:$r})):this.handleMsg($r)):this.logger.warn("onMsg::syncSendMsg to self, so ignore",$r.idClient,$r.idServer)},cr.onBroadcastMsgs=function(vr){var _r=vr.content.broadcastMsgs;_r=re(_r).call(_r,function(Or,Mr){return Or.broadcastId-Mr.broadcastId}),this.putBroadcastMsgs(_r)},cr.onBroadcastMsg=function(vr){var _r=vr.content.broadcastMsg;_r.time=_r.timestamp,this.syncing?this.unhandledMsgs.push({type:"onBroadcastMsg",msg:_r}):_r&&this.putBroadcastMsg(_r)},cr.pushMsgTask=function(vr){this.msgPromise=this.msgPromise.then(function(){return vr()})},cr.pushMsgDelay=function(vr){if(vr&&vr.length>0){var _r=this;if(_r.msgStatEnable&&!rr.isWeixinApp){var Or,Mr=i(vr).call(vr,function(yr){return{appkey:_r.options.appKey,accid:yr.to,fromAccid:yr.from,msgId:yr.idServer,serverTime:yr.time,receiveTime:_r.reporterHook.getNTPTime(),sessionId:_r.sdkSession,platform:"web",sdk_ver:rr.info.version,manufactor:kr.name+" "+kr.version}});_r.msgDelayArr=ie(Or=_r.msgDelayArr).call(Or,Mr),_r.msgDelayArr.length>5&&_r.doReportMsgDelay()}}},cr.doReportMsgDelay=function(){var vr,_r=V(this.msgDelayArr);this.msgDelayArr&&this.msgDelayArr.length>0&&(Cr.sendBeacon("https://statistic.live.126.net/statics/report/im/sdk/msgreceived",_r),this.msgDelayArr=[]),this.msgDelayTimer&&clearTimeout(this.msgDelayTimer),this.socket&&(this.msgDelayTimer=ue(le(vr=this.doReportMsgDelay).call(vr,this),1e4))},cr.handleMsg=function(vr){var _r,Or=this,Mr=Or.db,yr=vr.time;Or.markMsgRead(vr),Or.logger.info(ie(_r="msg::handleMsg:msgPromise start ".concat(vr.idServer," ")).call(_r,vr.idClient)),Or.msgPromise=Or.msgPromise.then(function(){var mr;return Or.logger.info(ie(mr="msg::handleMsg:msgPromise, putMsg start ".concat(vr.idServer," ")).call(mr,vr.idClient)),Or.putMsg(vr,"onMsg")}).then(function(){var mr;return Or.logger.info(ie(mr="msg::handleMsg:msgPromise, putMsg done and update timetag ".concat(vr.idServer," ")).call(mr,vr.idClient)),Mr.enable?vr.scene==="superTeam"?Mr.updateSuperTeamRoamingMsgTimetag(yr):Mr.updateRoamingMsgTimetag(yr):(Or.timetags[vr.scene==="superTeam"?"superTeamRoamingMsgs":"roamingMsgs"]=yr,k.resolve())}).then(function(){if(vr)return Or.checkUserUpdate(vr)}).then(function(){if(vr){var mr=vr.type;switch(Or.logger.info("msg::handleMsg:msgPromise, checkUserUpdate "+vr.scene+" "+mr+" msg"+(mr==="notification"?" "+vr.attach.type:"")),mr){case"notification":return Or.onTeamNotificationMsg(vr)}}}).then(function(){var mr,Tr;Or.logger.info(ie(mr=ie(Tr="msg::handleMsg:msgPromise, onmsg ready: ".concat(vr.idServer," ")).call(Tr,vr.idClient,", ")).call(mr,!!vr.ignore)),vr&&!vr.ignore&&ue(function(){var Br,$r=vr.scene==="p2p";if(rr.isBrowser&&vr.flow!=="out"){var Lr={msgId:vr.idServer,clientId:vr.idClient,receiveTime:Or.reporterHook.getNTPTime(vr.__receiveTime),serverTime:vr.time,callbackTime:Or.reporterHook.getNTPTime(),preHandleTime:Or.reporterHook.getNTPTime(vr.__handleTime),fromAccid:vr.from,toAccid:Or.options.account,type:Or.message.sceneMap[vr.scene],tid:$r?"":vr.to,result:200,failReason:"",rt:oe(Or.reporterHook.getSafeClock()-vr.__receiveTime)},Gr=or.get(vr,"__clientExt.statistics.apiCallingTime"),qr=or.get(vr,"__clientExt.statistics.sendTime");Gr&&qr&&(Lr.apiCallingTime=Gr,Lr.sendTime=qr,Lr.attachUploadDuration=or.get(vr,"__clientExt.statistics.attachUploadDuration")||0),Or.reporter&&Or.reporter.report("msgReceive",Lr)}delete vr.__receiveTime,delete vr.__handleTime,delete vr.__clientExt,Or.logger.info(ie(Br="msg::handleMsg:msgPromise, tigger onmsg: ".concat(vr.idServer," ")).call(Br,vr.idClient)),Or.options.onmsg(or.copy(vr))},0)}).catch(function(mr){var Tr;Or.logger.error(ie(Tr="msg::handleMsg:msgPromise, catch err ".concat(vr.idServer," ")).call(Tr,vr.idClient),mr),mr.callFunc="msg::handleMsg",Or.onCustomError("消息处理错误",mr)})},cr.putMsg=function(vr,_r){if(or.isArray(vr)||(vr=[vr]),y(vr[0]))return k.resolve(vr);var Or,Mr=this,yr=Mr.db,mr=yr.enable,Tr=k.resolve(),Br=Mr.message.Message.getLastMsg(vr),$r=Br.flow,Lr=Mr.genSessionByMsgs(vr);qr(Lr);var Gr=[];function qr(Yr){_r!=="roamingMsgs"&&_r!=="offlineMsgs"||Mr.cacheSyncedSession(Yr)}return Tr=(Tr=(Tr=Tr.then(function(){var Yr;return mr||Mr.options.autoMarkRead||_r==="roamingMsgs"||!Lr||(Mr.sessionUnreadMsgs=Mr.sessionUnreadMsgs||{},Mr.sessionUnreadMsgs[Lr.id]=Mr.sessionUnreadMsgs[Lr.id]||[],Mr.sessionUnreadMsgs[Lr.id]=ie(Yr=Mr.sessionUnreadMsgs[Lr.id]).call(Yr,y(vr).call(vr,function(bn){try{return Mr.options.shouldCountNotifyUnread(bn)}catch(wn){throw Mr.logger.error("userOption:shouldCountNotifyUnread function error",wn),wn}}))),_r==="offlineMsgs"||_r==="roamingMsgs"?k.reject(vr):mr?yr.putMsg(vr):vr}).then(function(Yr){return g(vr).call(vr,function(bn){Mr.checkMsgUnique(bn)&&Mr.logger.warn("msg::putMsg: msg is not unique",bn.idClient,bn.idServer,bn.time)}),Gr=mr?Yr:vr,k.resolve(vr)})).then(function(Yr){return Yr.length&&mr&&Lr?new k(function(bn){yr.getSessions({sessionId:Lr.id}).then(function(wn){if(wn&&wn.lastMsg){var Xr=wn.lastMsg;Lr.lastMsg&&Lr.lastMsg.time<Xr.time&&(Lr.lastMsg=Xr)}Gr&&Gr.length?Lr?yr.putSession(Lr).then(function(Vn){bn(Vn)}):bn(wn):(Gr=Yr,bn(wn))})}):k.resolve(Lr)})).then(function(Yr){if(Lr&&Gr.length){Or=Br.sessionId!==Mr.currSessionId;var bn=_r==="roamingMsgs",wn=Mr.options.syncSessionUnread,Xr=Lr.id,Vn=Mr.getSessionInCache(Xr,!0)||{},Zr=Vn.ack||0;if(_r==="offlineMsgs"||bn&&wn||_r==="onMsg"&&$r==="in"&&Or){var Nn;if(mr&&Yr){var Qr=Vn.unread||0;(Lr=Yr).unread=Qr,Zr=Zr||Lr.ack||0}else(Yr=Vn)&&(Lr.unread=Yr.unread||0);qr(Lr),Lr.unread=Lr.unread||0;var kn=0;g(Gr).call(Gr,function(xn){var An;try{An=Mr.options.shouldCountNotifyUnread(xn)}catch(Yn){throw Mr.logger.error("userOption:shouldCountNotifyUnread function error",Yn),Yn}var vn=(xn.type!=="notification"||xn.type==="notification"&&An)&&(hr(xn.isUnreadable)||xn.isUnreadable);if(vn&&wn&&(vn=xn.time>Zr&&xn.flow!=="out"),vn&&(kn++,wn&&!mr)){var hn=Vn.unreadMsgs||[];hn.push(xn),Lr.unreadMsgs=hn}}),Lr.unread+=kn;var Dn=or.secureOutput("session",Lr);if(Dn.unreadMsgs&&(Dn.unreadMsgs=i(Nn=Dn.unreadMsgs).call(Nn,function(xn){return xn&&xn.idServer})),Mr.logger.info("msg::putMsg:updateSession: ",Dn),qr(Lr),mr)return yr.updateSession({id:Lr.id,unread:Lr.unread})}}}),_r==="onMsg"&&(Tr=Tr.then(function(){vr.length&&Lr&&(Mr.onUpdateSession(Lr),Mr.options.syncSessionUnread&&!Or&&Mr.api.resetSessionUnread(Mr.currSessionId))})),Tr.then(function(){return k.resolve(vr)}).catch(function(Yr){return Yr&&Yr.length?k.resolve(Yr):k.reject(Yr)})},cr.putBroadcastMsgs=function(vr){var _r=this,Or=_r.db,Mr=vr.length;if(Mr>0){if(_r.doMarkBroadcastMsgsRead(vr),Or.enable){var yr=vr[Mr-1].broadcastId;return Or.updateBroadcastMsgTimetag(yr),Or.putBroadcastMsg(vr).then(function(){return ue(function(){_r.doMarkMsgsRead(),_r.options.onbroadcastmsgs(or.copy(vr))},0),k.resolve(vr)})}ue(function(){_r.options.onbroadcastmsgs(or.copy(vr))},0)}return vr},cr.putBroadcastMsg=function(vr){var _r=this,Or=_r.db;return _r.doMarkBroadcastMsgsRead([vr]),Or.enable?(vr.broadcastId&&Or.updateBroadcastMsgTimetag(vr.broadcastId),Or.putBroadcastMsg(vr).then(function(){return ue(function(){_r.options.onbroadcastmsg(or.copy(vr))},0),k.resolve(vr)})):(ue(function(){_r.options.onbroadcastmsg(or.copy(vr))},0),vr)},cr.doMarkBroadcastMsgsRead=function(vr){vr=i(vr).call(vr,function(_r){return _r.broadcastId}),this.sendCmd("batchMarkRead",{sid:7,cid:17,ids:vr})},cr.cacheSyncedSession=function(vr){if(vr&&this.syncResult){vr=ae({},vr),this.syncResult.sessions=this.syncResult.sessions||{};var _r=vr.id,Or=this.syncResult.sessions[_r]||{};Or&&Or.ack>vr.ack&&delete vr.ack,Or&&Or.msgReceiptTime>vr.msgReceiptTime&&delete vr.msgReceiptTime;var Mr=or.get(Or,"lastMsg.time"),yr=or.get(vr,"lastMsg.time");Mr&&yr&&Mr>yr&&(vr.lastMsg=Or.lastMsg),this.syncResult.sessions[_r]=ae(Or,vr),this.syncResult.sessions[_r]=ae({},this.mergeSession(this.syncResult.sessions[_r]))}},cr.checkMsgUnique=or.genCheckUniqueFunc("idClient"),cr.revokeMsgUniqueCheck=function(vr){this.uniqueSet&&this.uniqueSet.idClient&&(this.uniqueSet.idClient[vr]=!1)},cr.storeSendMsg=function(vr){if(!this.syncing){var _r=this.putMsg(vr,"sendMsg");return this.msgPromise=this.msgPromise.then(function(){return _r}),_r}this.unhandledMsgs.push({type:"sendMsg",msg:vr})},cr.updateSendMsgError=function(vr){if(!this.syncing){var _r=this.updateMsg(vr);return this.msgPromise=this.msgPromise.then(function(){return _r}),_r}this.unupdatedMsgs.push(vr)},cr.onSendMsg=function(vr,_r){var Or,Mr,yr=this,mr=vr.content&&vr.content.msg,Tr=vr.obj&&vr.obj.msg||mr;if(Tr)if(this.logger.warn(ie(Or=ie(Mr="sendMsg::end: ".concat(mr&&mr.idServer," ")).call(Mr,Tr.idClient," ")).call(Or,vr&&vr.raw&&vr.raw.ser)),vr.obj)$r();else{var Br=yr.db;Br&&Br.enable&&Br.getMsgByIdClient(Tr.idClient).then(function(Lr){Lr&&(Tr=Lr,$r(!1))}).catch(function(){return $r()})}else this.logger.error("sendMsg::error::get msg failed, msg empty");function $r(){var Lr,Gr=!(arguments.length>0&&arguments[0]!==void 0)||arguments[0];yr.completeMsg(Tr);var qr=vr.error&&vr.error.code===7101;vr.error&&!qr||(Tr.idServer=mr.idServer,Tr.time=+mr.time,mr.yidunAntiSpamRes&&(Tr.yidunAntiSpamRes=mr.yidunAntiSpamRes),mr.callbackExt&&(Tr.callbackExt=mr.callbackExt)),qr&&(Tr.isInBlackList=!0),vr.error?Tr.status="fail":Tr.status="success",Tr=Gr?z(Lr=yr.message).call(Lr,Tr):Tr,Tr=yr.amendMsg(Tr),_r&&(Tr.filter=!0),vr.obj=Tr,yr.syncing?yr.unupdatedMsgs.push(Tr):yr.msgPromise=k.all([yr.msgPromise,vr.obj.promise]).then(function(Yr){return Yr.length||(Tr.resend=!0),yr.updateMsg(Tr).then(function(){return yr.options.syncSessionUnread&&yr.currSessionId===Tr.sessionId&&yr.api.resetSessionUnread(yr.currSessionId),yr.resolveMsgReceiptTask(Tr),Tr})}).catch(function(Yr){yr.logger.error("onSendMsg::dealMsg error",Yr)})}},cr.updateLocalMsg=function(vr){var _r=this.updateMsg(vr);return this.msgPromise=this.msgPromise.then(function(){return _r}),_r},cr.updateMsg=function(vr){if(y(vr)||this.options.shouldIgnoreMsg(vr))return k.resolve(vr);var _r=this,Or=_r.db,Mr=vr.status==="success",yr=Pr.genSessionByMsg(vr),mr=!!vr.isLocal;return _r.onUpdateSession(yr),Or.enable?Or.updateMsg(vr).then(function(Tr){var Br=Or.updateSession(yr),$r=k.resolve();return Mr&&Tr&&!mr&&($r=vr.scene==="superTeam"?Or.updateSuperTeamRoamingMsgTimetag(Tr.time):Or.updateRoamingMsgTimetag(Tr.time)),k.all([Br,$r])}).catch(function(Tr){_r.logger.error("updateMsg error",Tr)}):(Mr&&!mr&&(_r.timetags.roamingMsgs=vr.time),k.resolve(vr))},cr.updateRoamingMsgTimetag=function(vr){var _r=this.db;return _r.enable?_r.updateRoamingMsgTimetag(vr):(this.timetags.roamingMsgs=vr,k.resolve(vr))},cr.checkUserUpdate=function(vr){var _r=this,Or=vr.from;return _r.logger.info("handleMsg::checkUserUpdate: ",Or,_r.account),Or===_r.account?k.resolve():new k(function(Mr){var yr=_r.userSet[Or];if(yr){var mr=+yr.updateTime,Tr=+vr.userUpdateTime;!isNaN(mr)&&!isNaN(Tr)&&or.isNumber(mr)&&or.isNumber(Tr)&&mr<Tr?Br():Mr()}else Br();function Br(){_r.api.getUser({account:Or,sync:!0,done:function($r,Lr){$r||ue(function(){_r.logger.log("user::checkUserUpdate: onupdateuser",Lr&&Lr.account),_r.options.onupdateuser(Lr)},0),Mr()}})}})},cr.processUnsettledMsgs=function(){var vr,_r,Or=this;g(vr=Or.unhandledMsgs).call(vr,function(Mr){var yr=Mr.msg;switch(Mr.type){case"onMsg":Or.handleMsg(yr);break;case"sendMsg":Or.msgPromise=Or.msgPromise.then(function(){return Or.putMsg(yr)});break;case"onBroadcastMsg":Or.msgPromise=Or.msgPromise.then(function(){return Or.putBroadcastMsg(yr)})}}),g(_r=Or.unupdatedMsgs).call(_r,function(Mr){Or.msgPromise=Or.msgPromise.then(function(){return Or.updateMsg(Mr)})}),Or.resetUnsettledMsgs()},cr.onTeamNotificationMsg=function(vr){var _r=vr.attach,Or=_r.type,Mr=vr.from,yr=vr.to,mr=vr.time,Tr=_r.team,Br=_r.account,$r=_r.accounts;switch(Or){case"updateTeam":return Tr.updateTime=mr,this.onUpdateTeam(Tr);case"addTeamMembers":return this.onAddTeamMembers(vr,Tr,$r);case"removeTeamMembers":return this.onRemoveTeamMembers(Tr,yr,$r);case"acceptTeamInvite":return this.onAddTeamMembers(vr,Tr,[Mr]);case"passTeamApply":return this.onAddTeamMembers(vr,Tr,[Br]);case"addTeamManagers":return this.updateTeamManagers(vr,yr,$r,!0,mr);case"removeTeamManagers":return this.updateTeamManagers(vr,yr,$r,!1,mr);case"leaveTeam":return this.onRemoveTeamMembers(Tr,yr,[Mr]);case"dismissTeam":return this.onDismissTeam(yr,mr);case"transferTeam":return this.transferTeam(vr,Tr,Mr,Br);case"updateTeamMute":return this.onUpdateTeamMembersMute(vr,Tr,[Br],_r.mute);case"updateSuperTeam":return Tr.updateTime=mr,this.onUpdateSuperTeam(Tr);case"acceptSuperTeamInvite":return this.onAddSuperTeamMembers(vr,Tr,[vr.from]);case"addSuperTeamMembers":return this.onAddSuperTeamMembers(vr,Tr,$r);case"passSuperTeamApply":return this.onAddSuperTeamMembers(vr,Tr,[Br]);case"removeSuperTeamMembers":return this.onRemoveSuperTeamMembers(Tr,yr,$r);case"leaveSuperTeam":return this.onRemoveSuperTeamMembers(Tr,yr,[Mr]);case"dismissSuperTeam":return this.onDismissSuperTeam(yr,mr);case"transferSuperTeam":return this.transferSuperTeam(vr,Tr,Mr,Br);case"addSuperTeamManagers":return this.updateSuperTeamManagers(vr,yr,$r,!0,mr);case"removeSuperTeamManagers":return this.updateSuperTeamManagers(vr,yr,$r,!1,mr);case"updateSuperTeamMembersMute":return this.onUpdateSuperTeamMembersMute(vr,Tr,$r,_r.mute)}},cr.onAddSuperTeamMembers=function(vr,_r,Or){var Mr=this.db,yr=Er.assembleMembers(_r,Or);vr.attach.members=yr;var mr={team:_r,accounts:Or,members:yr};if(this.logger.info("team::onAddSuperTeamMembers: ".concat(mr.team.teamId,", "),mr.accounts),this.options.onAddSuperTeamMembers(or.simpleClone(mr)),Mr.enable){var Tr=Mr.putSuperTeamMembers(yr),Br=Mr.putSuperTeam(_r);return k.all([Tr,Br])}},cr.onRemoveSuperTeamMembers=function(vr,_r,Or){var Mr=this.db,yr={team:vr,teamId:_r,accounts:Or};if(this.logger.info("team::onRemoveSuperTeamMembers: ".concat(_r,", "),yr.accounts),this.options.onRemoveSuperTeamMembers&&this.options.onRemoveSuperTeamMembers(or.simpleClone(yr)),this.mySuperTeamMembersMap&&this.mySuperTeamMembersMap[_r]&&this.mySuperTeamMembersMap[_r].followAccountIds){var mr=this.mySuperTeamMembersMap[_r].followAccountIds;if(y(mr).call(mr,function(Lr){return qe(Or).call(Or,Lr)}).length>0){this.mySuperTeamMembersMap[_r].followAccountIds=y(mr).call(mr,function(Lr){return!qe(Or).call(Or,Lr)});var Tr=this.mySuperTeamMembersMap[_r];this.db.enable&&this.db.updateSuperTeamMember(Tr),this.mergeMySuperTeamMembers(Tr),this.onUpdateSuperTeamMember(Tr)}}if(vr&&Mr.enable){if(L(Or).call(Or,this.account)===-1){var Br=Mr.removeSuperTeamMembersByAccounts(_r,Or),$r=k.resolve();return vr&&($r=Mr.putSuperTeam(vr)),k.all([Br,$r])}return Mr.leaveSuperTeam(_r)}},cr.onDismissSuperTeam=function(vr,_r){var Or=this.db,Mr={teamId:vr};if(this.logger.info("team::onDismissSuperTeam:",vr),this.options.onDismissSuperTeam(Mr),Or.enable)return Or.dismissSuperTeam(vr,_r)},cr.onAddTeamMembers=function(vr,_r,Or){var Mr=this,yr=Mr.db,mr=_r.teamId,Tr=Sr.assembleMembers(_r,Or);vr.attach.members=Tr;var Br={team:_r,accounts:Or,members:Tr};if(Mr.logger.info("team::onAddTeamMembers: ",mr,Or),L(Or).call(Or,Mr.account)>-1&&Mr.mergeMyTeamMembers(y(Tr).call(Tr,function(Gr){return Gr.account===Mr.account})),Mr.options.onAddTeamMembers(or.simpleClone(Br)),yr.enable){var $r,Lr=yr.putTeam(_r);return L(Or).call(Or,Mr.account)>-1?$r=yr.putTeamMembers(Tr):Mr.logger.log("team::onAddTeamMembers: user join team",mr),k.all([$r,Lr])}},cr.onRemoveTeamMembers=function(vr,_r,Or){var Mr=this.db,yr={team:vr,teamId:_r,accounts:Or};if(this.logger.info("team::onRemoveTeamMembers: ".concat(_r),Or),this.options.onRemoveTeamMembers&&this.options.onRemoveTeamMembers(or.simpleClone(yr)),this.myTeamMembersMap&&this.myTeamMembersMap[_r]&&this.myTeamMembersMap[_r].followAccountIds){var mr=this.myTeamMembersMap[_r].followAccountIds;if(y(mr).call(mr,function(Lr){return qe(Or).call(Or,Lr)}).length>0){this.myTeamMembersMap[_r].followAccountIds=y(mr).call(mr,function(Lr){return!qe(Or).call(Or,Lr)});var Tr=this.myTeamMembersMap[_r];this.db.enable&&this.db.updateTeamMember(Tr),this.mergeMyTeamMembers(Tr),this.onUpdateTeamMember(Tr)}}if(vr&&Mr.enable){if(L(Or).call(Or,this.account)===-1){var Br=Mr.removeTeamMembersByAccounts(_r,Or),$r=k.resolve();return vr&&($r=Mr.putTeam(vr)),k.all([Br,$r])}return Mr.leaveTeam(_r)}},cr.updateTeamManagers=function(vr,_r,Or,Mr,yr){var mr=this.db,Tr=vr.attach.members=i(Or).call(Or,function(qr){return{id:Sr.genId(_r,qr),type:Mr?"manager":"normal",updateTime:yr,account:qr}}),Br={teamId:""+_r,memberUpdateTime:yr};vr.attach.team=Br;var $r={team:Br,accounts:Or,isManager:Mr,members:Tr};if(this.logger.info("team::updateTeamManagers:",_r,Or,Mr),this.options.onUpdateTeamManagers(or.simpleClone($r)),mr.enable){var Lr=mr.updateTeam(Br),Gr=mr.updateTeamManagers(_r,Or,Mr,yr);return k.all([Lr,Gr])}},cr.updateSuperTeamManagers=function(vr,_r,Or,Mr,yr){var mr=this.db,Tr=vr.attach.members=i(Or).call(Or,function(qr){return{id:Sr.genId(_r,qr),teamId:_r,account:qr,type:Mr?"manager":"normal",updateTime:yr}}),Br={teamId:""+_r,memberUpdateTime:yr};vr.attach.team=Br;var $r={team:Br,accounts:Or,isManager:Mr,members:Tr};if(this.logger.info("team::updateSuperTeamManagers:",_r,Or,Mr),this.options.onUpdateSuperTeamManagers(or.simpleClone($r)),mr.enable){var Lr=mr.updateSuperTeam(Br),Gr=mr.updateSuperTeamMembers(Tr);return k.all([Lr,Gr])}},cr.onDismissTeam=function(vr,_r){var Or=this.db,Mr={teamId:vr};if(this.logger.info("team::onDismissTeam:",vr),this.options.onDismissTeam(Mr),Or.enable)return Or.dismissTeam(vr,_r)},cr.transferTeam=function(vr,_r,Or,Mr){var yr=this.db,mr=_r.teamId,Tr=_r.memberUpdateTime,Br={id:Sr.genId(mr,Or),type:"normal",updateTime:Tr},$r={id:Sr.genId(mr,Mr),type:"owner",updateTime:Tr};vr.attach.members=[Br,$r];var Lr={team:_r,from:Br,to:$r};if(this.logger.info("team::transferTeam: from to",mr,Or,Mr),this.options.onTransferTeam(or.simpleClone(Lr)),yr.enable)return yr.transferTeam(_r,Or,Mr)},cr.transferSuperTeam=function(vr,_r,Or,Mr){var yr=this.db,mr=_r.teamId,Tr=_r.memberUpdateTime,Br={teamId:mr,type:"normal",account:Or,updateTime:Tr},$r={teamId:mr,type:"owner",account:Mr,updateTime:Tr};vr.attach.members=[Br,$r];var Lr={team:_r,from:Br,to:$r};if(this.logger.info("team::transferSuperTeam: from to ",mr,Or,Mr),this.options.onTransferSuperTeam(or.simpleClone(Lr)),yr.enable)return yr.transferSuperTeam(_r,Br,$r)},cr.onUpdateTeamMembersMute=function(vr,_r,Or,Mr){var yr=this.db,mr=i(Or).call(Or,function(Lr){return{id:Sr.genId(_r.teamId,Lr),account:Lr,teamId:_r.teamId,mute:Mr,updateTime:_r.memberUpdateTime}});vr.attach.members=mr;var Tr={team:_r,accounts:Or,members:mr,mute:Mr};if(this.logger.info("team::onUpdateTeamMembersMute:",_r.teamId,Or,Mr),this.options.onUpdateTeamMembersMute(or.simpleClone(Tr)),yr.enable){var Br=yr.updateTeamMembers(mr),$r=yr.putTeam(_r);return k.all([Br,$r])}},cr.onUpdateSuperTeamMembersMute=function(vr,_r,Or,Mr){var yr=this.db,mr=i(Or).call(Or,function(Lr){return{id:Er.genId(_r.teamId,Lr),account:Lr,teamId:_r.teamId,mute:Mr,updateTime:_r.memberUpdateTime}});vr.attach.members=mr;var Tr={team:_r,accounts:Or,members:mr,mute:Mr};if(this.logger.info("team::onUpdateSuperTeamMembersMute:",_r.teamId,Or,Mr),this.options.onUpdateSuperTeamMembersMute(or.simpleClone(Tr)),yr.enable){var Br=yr.updateSuperTeamMembers(mr),$r=yr.putSuperTeam(_r);return k.all([Br,$r])}},cr.onHistoryMsgs=function(vr){vr.error||(vr.obj.msgs=this.message.reverseMsgs(vr.content.msgs))},cr.onmsgFtsInServer=function(vr){if(!vr.error){var _r=this.message.reverseMsgs(vr.content.msgs);vr.obj.msgs=_r,vr.content.msgs=_r}},cr.isFilterMsgs=function(vr){return!!y(vr[0])},cr.splitMsgs=function(vr,_r,Or,Mr){g(vr).call(vr,function(yr){if(y(yr))Mr.push(yr);else switch(yr.scene){case"p2p":_r.push(yr);break;case"team":Or.push(yr)}})},cr.markMsgRead=function(vr,_r){if(or.isArray(vr)||(vr=[vr]),this.db.enable||this.options.autoMarkRead||_r){var Or=i(vr).call(vr,function(Mr){return{flag:"msg",idServer:Mr.idServer,scene:Mr.scene,filter:y(Mr),type:Mr.type,attachType:Mr.attach&&Mr.attach.type}});this.msgAckBufferManager.add(Or)}},cr.markSysMsgRead=function(vr,_r){if(or.isArray(vr)||(vr=[vr]),this.db.enable||this.options.autoMarkRead||_r){var Or=i(vr).call(vr,function(Mr){return{flag:"systemMsg",idServer:Mr.idServer,scene:Mr.scene,filter:y(Mr),type:Mr.type}});this.msgAckBufferManager.add(Or)}},cr.handleMsgsAck=function(vr){var _r,Or=this,Mr={p2pSysMsgs:{sid:7,cid:3,msgs:[]},p2pMsgs:{sid:7,cid:2,msgs:[]},superTeamSysMsgs:{sid:21,cid:19,msgs:[]},teamMsgs:{sid:8,cid:3,msgs:[]},filterSysMsgs:{sid:101,cid:3,msgs:[]},filterMsgs:{sid:101,cid:2,msgs:[]},netcallMsgs:{sid:9,cid:11,msgs:[]}};g(vr).call(vr,function(yr){/^(netcallBill|netcallMiss|netcallReject)$/.test(yr.attachType)?Mr.netcallMsgs.msgs.push(yr):y(yr)?yr.flag==="systemMsg"?Mr.filterSysMsgs.msgs.push(yr):Mr.filterMsgs.msgs.push(yr):yr.flag!=="systemMsg"?yr.scene==="p2p"?Mr.p2pMsgs.msgs.push(yr):yr.scene==="team"&&Mr.teamMsgs.msgs.push(yr):yr.scene==="superTeam"?Mr.superTeamSysMsgs.msgs.push(yr):Mr.p2pSysMsgs.msgs.push(yr)}),g(_r=$(Mr)).call(_r,function(yr){return Or.doMarkMsgsRead(Mr[yr].sid,Mr[yr].cid,Mr[yr].msgs)})},cr.doMarkMsgsRead=function(vr,_r,Or){Or&&Or.length&&(this.logger.log("markMsgRead::batchMarkRead",vr,_r,Or),this.sendCmd("batchMarkRead",{sid:vr,cid:_r,ids:i(Or).call(Or,function(Mr){return Mr.idServer})}))}},function(t,r,e){var n=e(51),g=e(10),y=e(2),i=e(4),k=e(16),$=e(3),L=e(37),V=e(52),z=e(53),re=e(54),ie=e(55),ue=e(43);function le($e,Lt){var jt=i($e);if(V){var Et=V($e);Lt&&(Et=k(Et).call(Et,function(ir){return z($e,ir).enumerable})),jt.push.apply(jt,Et)}return jt}function oe($e){for(var Lt=1;Lt<arguments.length;Lt++){var jt,Et,ir=arguments[Lt]!=null?arguments[Lt]:{};Lt%2?y(jt=le(Object(ir),!0)).call(jt,function(dr){n($e,dr,ir[dr])}):re?ie($e,re(ir)):y(Et=le(Object(ir))).call(Et,function(dr){ue($e,dr,z(ir,dr))})}return $e}var ae=e(35).fn,qe=e(756),de=e(758);function Ne($e,Lt,jt){var Et=this,ir=this.timetags&&this.timetags.sync;this.db.enable&&ir&&Lt&&this.db.getMsgByIdClient($e).then(function(dr){if(dr&&!(dr.commentTimetag&&dr.commentTimetag<=ir&&dr.time<=ir)){if(dr.commentTimetag=Lt.time,dr.comments=dr.comments||[],jt){var Dt;dr.comments=k(Dt=dr.comments).call(Dt,function(cr){return cr.body!==Lt.body||cr.from!==Lt.from})}else{for(var lr,sr=0;sr<dr.comments.length;sr++)if(dr.comments[sr].from===Lt.from&&dr.comments[sr].body===Lt.body){dr.comments[sr]=Lt,lr=!0;break}lr||dr.comments.push(Lt)}var er={idClient:dr.idClient,comments:dr.comments,commentTimetag:dr.commentTimetag};Et.db.updateMsg(er)}})}function ze($e){$e.scene=this.message.sceneReverseMap[+$e.scene]||$e.scene,$e.time=+$e.time}ae.processMsgExtend=function($e){switch($e.cmd){case"getThreadMsgs":this.onGetThreadMsgs($e);break;case"getMsgsByIdServer":this.onGetMsgsByIdServer($e);break;case"addQuickComment":this.changeQuickComment($e);break;case"deleteQuickComment":this.changeQuickComment($e,!0);break;case"onQuickComment":case"syncAddQuickComment":this.onQuickComment($e);break;case"onDeleteQuickComment":case"syncDeleteQuickComment":this.onQuickComment($e,!0);break;case"getQuickComments":this.getQuickComments($e);break;case"addCollect":case"updateCollect":this.addCollect($e);break;case"deleteCollects":this.deleteCollects($e);break;case"getCollects":this.getCollects($e);break;case"addStickTopSession":case"syncAddStickTopSession":this.onChangeStickTopSession($e,"add");break;case"updateStickTopSession":case"syncUpdateStickTopSession":this.onChangeStickTopSession($e,"update");break;case"deleteStickTopSession":case"syncDeleteStickTopSession":this.onChangeStickTopSession($e,"delete");break;case"addMsgPin":case"onAddMsgPin":case"syncAddMsgPin":this.pinMsgChange($e,"add");break;case"updateMsgPin":case"onUpdateMsgPin":case"syncUpdateMsgPin":this.pinMsgChange($e,"update");break;case"deleteMsgPin":case"onDeleteMsgPin":case"syncDeleteMsgPin":this.pinMsgChange($e,"delete");break;case"getMsgPins":this.getMsgPins($e)}},ae.onGetThreadMsgs=function($e){if(!$e.error){var Lt;$e.obj.msgs=this.message.reverseMsgs($e.content.msgs),$e.obj.threadMsg=g(Lt=this.message).call(Lt,$e.content.threadMsg);var jt=$e.content.threadMsgsMeta||{};$e.obj.total=jt.total,$e.obj.timetag=jt.lastMsgTime}},ae.onGetMsgsByIdServer=function($e){$e.error||($e.obj.msgs=this.message.reverseMsgs($e.content.msgs))},ae.changeQuickComment=function($e,Lt){$e.error||($e.obj.comment.time=$e.content.timetag,$e.obj.comment=g(qe).call(qe,$e.obj.comment),ze.call(this,$e.obj.msg),Ne.call(this,$e.obj.msg.idClient,$e.obj.comment,Lt))},ae.onQuickComment=function($e,Lt){if($e.content){var jt=$e.content,Et=jt.comment,ir=jt.msg;Et&&ir&&(ze.call(this,ir),Et=g(qe).call(qe,Et),Lt?this.options.onDeleteQuickComment($e.content.msg,Et):this.options.onQuickComment($e.content.msg,Et),Ne.call(this,ir.idClient,Et,Lt))}},ae.getQuickComments=function($e){var Lt,jt=this;if(!$e.error){var Et=$e.obj.idMap,ir=$e.obj.indexMap,dr=$e.content&&$e.content.commentRes||[];y(dr).call(dr,function(Dt){var lr=[],sr=jt.parser.unserializeMap.comment;if(+Dt.modify==1)try{lr=JSON.parse(Dt.detail)}catch(cr){jt.logger.warn("getQuickComments parse detail error",cr)}if(y(lr).call(lr,function(cr,or){var hr,pr={};y(hr=i(cr)).call(hr,function(Sr){pr[sr[Sr]]=cr[Sr]}),pr=g(qe).call(qe,pr),lr[or]=pr}),Dt.timestamp=+Dt.timestamp,Et[Dt.idClient]){var er={idClient:Dt.idClient,commentTimetag:Dt.timestamp};Et[Dt.idClient].commentTimetag=Dt.timestamp,+Dt.modify==1&&(Et[Dt.idClient].comments=lr,er.comments=lr),jt.db.enable&&jt.db.updateMsg(er)}else Et[Dt.idClient]={idServer:Dt.idServer,idClient:Dt.idClient,comments:lr,commentTimetag:Dt.timestamp,scene:jt.message.sceneReverseMap[Dt.scene]||Dt.scene}}),$e.obj=[],y(Lt=i(ir)).call(Lt,function(Dt){$e.obj[ir[Dt]]=Et[Dt]})}},ae.addCollect=function($e){$e.error||($e.obj.collect=g(de).call(de,$e.content.collect))},ae.deleteCollects=function($e){$e.error||($e.obj.deleteNum=$e.content.deleteNum)},ae.getCollects=function($e){if(!$e.error){var Lt=[],jt=$e.content.collectList||[];y(jt).call(jt,function(Et){Lt.push(g(de).call(de,Et))}),$e.obj.collectList=Lt,$e.obj.total=$e.content.total}},ae.onChangeStickTopSession=function($e,Lt){var jt=this;if(!$e.error){var Et=$e.content.stickTopSession||$e.obj.stickTopSession||{},ir=$e.content.timetag||+Et.updateTime,dr=Et.id.split("|");dr[0]==="super_team"&&(dr[0]="superTeam"),Et={id:dr.join("-"),scene:dr[0],to:dr[1],topCustom:Et.topCustom||""},Lt==="delete"?Et.isTop=!1:Lt==="add"&&(Et.isTop=!0),Et=this.onUpdateSession(Et),$e.obj&&($e.obj.stickTopSession=Et),this.db.enable&&(this.db.updateSession(Et).then(function(Dt){Dt||jt.db.putSession(Et)}),this.db.updateTimetag("stickTopSessions",ir))}},ae.pinMsgChange=function($e,Lt){var jt=this;if(!$e.error){$e.content=$e.content||{};var Et=this,ir=this.db,dr=$e.obj&&$e.obj.msg,Dt=$e.content.msg||dr||{},lr=$e.content.pinTag||$e.obj.pinTag,sr=$e.content.timetag||+lr.updateTime,er=$.resolve();ze.call(this,Dt),ir.enable&&(er=ir.getMsgByIdClient(Dt.idClient)),lr.createTime&&(lr.createTime=+lr.createTime),lr.updateTime&&(lr.updateTime=+lr.updateTime),er.then(function(cr){return Dt=cr||Dt,cr?Dt=cr:Dt.sessionId=Dt.scene+"-"+jt.message.Message.getMsgTarget(Dt,jt.account),dr?($e.obj.msg=Dt,$e.obj.pinTag=lr):jt.options.onPinMsgChange({msg:Dt,pinTag:lr},Lt),function(){ir.enable&&ir[Lt==="delete"?"deleteMsgPin":"putMsgPin"](oe(oe({},Dt),{},{pinFrom:lr.pinFrom,pinCustom:lr.pinCustom})).then(function(){var or="pin-"+Dt.sessionId,hr=Et.timetags.sync;return ir.getTimetag(or).then(function(pr){return pr>hr?ir.updateTimetag(or,sr):$.resolve()})}).catch(function(or){Et.logger.error("msgExtend::pinMsgChange:error",or)})}(),$.resolve}).then(function(){}),$e.promise=er}},ae.getMsgPins=function($e){var Lt=this;if(!$e.error){var jt=this.db,Et=$e.content||{};if(Et.pins=Et.pins||[],Et.modify){var ir,dr=[];jt.enable&&(jt.updateTimetag("pin-"+$e.obj.id,Et.timetag),y(ir=Et.pins).call(ir,function(Dt){Dt.sessionId=$e.obj.id,dr.push(jt.getMsgByIdClient(Dt.idClient))})),$e.promise=$.all(dr).then(function(Dt){var lr;y(lr=Et.pins).call(lr,function(sr,er){Dt[er]?L(sr,Dt[er]):(sr.sessionId=$e.obj.id,ze.call(Lt,sr))}),$e.obj.pins=Et.pins,jt.enable&&jt.deleteMsgPins($e.obj.id).then(function(){return jt.putMsgPins(Et.pins)}).catch(function(sr){Lt.logger.error("msgExtend::getMsgPins:change db error",sr)})})}else jt.enable?(jt.updateTimetag("pin-"+$e.obj.id,Et.timetag),$e.promise=jt.getMsgPins($e.obj.id).then(function(Dt){$e.obj.pins=Dt||[]})):$e.obj.pins=[]}}},function(t,r,e){var n=e(818);t.exports=n},function(t,r,e){e(819);var n=e(13);t.exports=n.Number.isInteger},function(t,r,e){e(1)({target:"Number",stat:!0},{isInteger:e(820)})},function(t,r,e){var n=e(28),g=Math.floor;t.exports=Number.isInteger||function(y){return!n(y)&&isFinite(y)&&g(y)===y}},function(t,r,e){var n=e(125),g=e(3),y=e(2),i=e(6),k=["time","from"],$=e(35).fn,L=e(0);$.onOfflineMsgReceipts=function(V){var z,re=this,ie=re.db,ue=V.content.msgReceipts,le=[],oe=g.resolve();this.logger.info("onOfflineMsgReceipts",ue),y(ue).call(ue,function(ae){z={id:"p2p-"+ae.from,msgReceiptTime:+ae.time},re.cacheSyncedSession(z)}),re.syncResult.msgReceipts=le,ie.enable&&(oe=ie.updateMsgReceiptsTimetag(V.content.timetag)),oe.cmd=le,re.syncPromiseArray.push(oe)},$.shouldUpdateSessionFromMsgReceipt=function(V,z){return!V||!V.msgReceiptServerTime||z.time>V.msgReceiptServerTime},$.genSessionFromMsgReceipt=function(V,z){var re=z.time,ie={id:z.sessionId,msgReceiptTime:re,msgReceiptServerTime:re};return V&&V.id===z.sessionId&&(ie=L.merge({},V,ie)),V&&V.updateTime||(ie.updateTime=re),ie},$.onMsgReceipt=function(V){var z=this,re=z.db,ie=V.content.msgReceipt;ie.time=+ie.time;var ue=ie.idClient,le=g.resolve();re.enable&&ue&&(le=re.getMsgByIdClient(ue)),this.logger.info("onMsgReceipt::",ie),le.then(function(oe){if(oe){if(!oe.idServer)return void(z.msgReceiptTasks[ue]=ie);oe.time}else ie.time;ie.msgReceiptTime=ie.time,ie.sessionId="p2p-".concat(ie.from),z.updateSessionMsgReceiptTime(ie),ie.time,ie.from;var ae=n(ie,k);z.options.onMsgReceipts([ae])})},$.resolveMsgReceiptTask=function(V){var z=this.msgReceiptTasks[V.idClient];z&&(z.msgReceiptTime=V.time,this.updateSessionMsgReceiptTime(z))},$.updateSessionMsgReceiptTime=function(V){var z=this.db,re={id:"p2p-"+V.from,msgReceiptTime:V.msgReceiptTime,msgReceiptServerTime:V.time};(this.getSessionInCache(re.id)||{}).msgReceiptTime>=re.msgReceiptTime?this.logger.warn("receive old msgReceiptTime",V):(z.enable&&z.putSession(re),this.onUpdateSession(re))},$.onSendMsgReceipt=function(V){var z;if(!V.error)if(V.obj&&V.obj.msgReceipt){var re=V.obj.msgReceipt,ie=+re.time,ue=+V.content.msgReceipt.time,le=this.getSessionInCache("p2p-"+re.to);le?(this.logger.info(i(z="sendMsgReceipt on:: param time ".concat(ie,", res time ")).call(z,ue)),le.msgReceiptSendTime=Math.min(ie,ue)):this.logger.info("sendMsgReceipt on:: session is undefined or logically deleted, failed to send read receipt")}else this.logger.info("sendMsgReceipt on:: origin msg is missing, it maybe timeout")},$.shouldSendMsgReceipt=function(V){if(V&&V.scene==="p2p"&&V.status==="success"){var z=this.getSessionInCache(V.sessionId);if(z){var re=z.msgReceiptSendTime;return!re||re<V.time}}return!1},$.isMsgRemoteRead=function(V){if(V&&V.scene==="p2p"&&V.flow==="out"&&V.status==="success"){var z=this.getSessionInCache(V.sessionId);if(z&&z.msgReceiptTime)return V.time<=z.msgReceiptTime}return!1}},function(t,r,e){var n=e(57),g=e(58),y=e(60),i=e(10),k=e(2),$=e(6),L=e(9),V=e(3),z=e(90),re=e(123),ie=e(4),ue=e(16),le=e(48),oe=e(15),ae=e(26),qe=e(158),de=e(88),Ne=e(89),ze=e(72),$e=e(32);function Lt(or,hr){var pr=Ne!==void 0&&ze(or)||or["@@iterator"];if(!pr){if($e(or)||(pr=function(kr,Ir){var xr;if(kr){if(typeof kr=="string")return jt(kr,Ir);var vr=oe(xr=Object.prototype.toString.call(kr)).call(xr,8,-1);if(vr==="Object"&&kr.constructor&&(vr=kr.constructor.name),vr==="Map"||vr==="Set")return de(kr);if(vr==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(vr))return jt(kr,Ir)}}(or))||hr&&or&&typeof or.length=="number"){pr&&(or=pr);var Sr=0,Er=function(){};return{s:Er,n:function(){return Sr>=or.length?{done:!0}:{done:!1,value:or[Sr++]}},e:function(kr){throw kr},f:Er}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var Pr,Cr=!0,rr=!1;return{s:function(){pr=pr.call(or)},n:function(){var kr=pr.next();return Cr=kr.done,kr},e:function(kr){rr=!0,Pr=kr},f:function(){try{Cr||pr.return==null||pr.return()}finally{if(rr)throw Pr}}}}function jt(or,hr){(hr==null||hr>or.length)&&(hr=or.length);for(var pr=0,Sr=new Array(hr);pr<hr;pr++)Sr[pr]=or[pr];return Sr}var Et=e(35).fn,ir=e(153),dr=e(154),Dt=e(0),lr=e(107).EMSyncType;function sr(or,hr){return er.apply(this,arguments)}function er(){return(er=g(n.mark(function or(hr,pr){var Sr,Er,Pr,Cr,rr,kr,Ir,xr,vr,_r,Or,Mr,yr,mr=this;return n.wrap(function(Tr){for(;;)switch(Tr.prev=Tr.next){case 0:if(Pr=(Er=this).db,Cr=[],k(hr).call(hr,function(Br){mr.revokeMsgUniqueCheck(Br.idClient),Cr.push(Br.idClient)}),Er.options.rollbackDelMsgUnread){Tr.next=14;break}return Tr.next=7,Pr.deleteMsg(Cr);case 7:if(Tr.t0=Tr.sent,Tr.t0){Tr.next=10;break}Tr.t0=[];case 10:return rr=Tr.t0,rr=Object.prototype.toString.call(rr)==="[object Array]"?rr:[rr],Er.logger.info("msg::_deleteMsgSelfBatchInDb, rollback false, affect: ".concat(rr.length," rows")),Tr.abrupt("return");case 14:return kr=!1,Ir=Er.options.cbUpdateSession||ae(Sr=Er.updateSessionInDbWithNotify).call(Sr,Er),xr=Er.getSessionInCache(pr)||{id:pr},vr=xr.lastMsg||{},qe(Cr).call(Cr,vr.idClient)&&(kr=!0),Er.logger.info("msg::_deleteMsgSelfBatchInDb session change before:",pr,kr,xr.unread),Tr.next=22,Pr.deleteMsg(Cr);case 22:if(Tr.t1=Tr.sent,Tr.t1){Tr.next=25;break}Tr.t1=[];case 25:if(_r=Tr.t1,_r=Object.prototype.toString.call(_r)==="[object Array]"?_r:[_r],Er.logger.info("msg::_deleteMsgSelfBatchInDb affect:",_r.length," rows"),!kr){Tr.next=34;break}return Tr.next=31,Pr.getMsgs({sessionId:pr,limit:1});case 31:Or=Tr.sent,vr=Or&&Or[0]?Or[0]:null,xr.lastMsg=vr;case 34:if(Mr=!1,xr&&xr.unread&&(yr=xr&&xr.ack||0,k(_r).call(_r,function(Br){var $r=!0;if(Br.type==="notification")try{$r=Er.options.shouldCountNotifyUnread(Br)}catch(Lr){throw Er.logger.error("userOption:shouldCountNotifyUnread function error",Lr),Lr}$r&&yr<Br.time&&Br.flow==="in"&&(xr.unread=xr.unread>0?xr.unread-1:0,Mr=!0)})),!kr&&!Mr){Tr.next=39;break}return Er.logger.info("msg::_deleteMsgSelfBatchInDb session change after:",pr,xr.unread),Tr.abrupt("return",Ir(xr));case 39:case"end":return Tr.stop()}},or,this)}))).apply(this,arguments)}function cr(or,hr){hr=hr||new Date().getTime();var pr=this.db,Sr=this.getSessionInCache(or),Er=this.options.rollbackClearMsgsUnread!==!1,Pr=[];return pr.enable&&Pr.push(pr.deleteMsgsBySessionId({sessionId:or,end:hr})),Er&&Sr&&(Sr=this.mergeSession({id:Sr.id,unread:0,lastMsg:null,unreadMsgs:[]}),Sr=this.onUpdateSession(Sr)),pr.enable&&Er&&Sr&&Pr.push(pr.updateSession(Sr)),V.all(Pr)}Et.onDeleteMsg=function(or){var hr=this.db;if(delete or.obj.sysMsg,!or.error){var pr=or.obj.msg;or.promise=this.deleteLocalMsg(pr).then(function(){if(hr.enable){var Sr=pr.scene==="superTeam"?"deleteSuperTeamMsg":"deleteMsg";hr.getTimetag(Sr).then(function(Er){Er=Er||0,y()+1>=Er&&hr.updateTimetag(Sr,y()+1)})}})}},Et.onMsgDeleted=function(or,hr){var pr=this;if(!pr.canHandleDeletedMsgInSyncing)return pr.logger.info("msg::onMsgDeleted:is in syncing ..."),void pr.unhandledSysMsgsForDeletedMsgs.push({packet:or,isSuperTeam:hr});if(!or.error){var Sr=pr.db,Er=i(ir).call(ir,or.content.sysMsg);Er=pr.processDeleteMsgSysMsg(Er),hr||pr.markSysMsgRead(Er),pr.deleteLocalMsg(Er.msg).then(function(){if(Sr.enable){var Pr=hr?"deleteSuperTeamMsg":"deleteMsg";Sr.updateTimetag(Pr,Er.time+1)}pr.handleSysMsg(Er)})}},Et.processDeleteMsgSysMsg=function(or){var hr;return or.msg={},k(hr=["scene","from","to"]).call(hr,function(pr){or.msg[pr]=or[pr]}),or.msg.idClient=or.deletedIdClient,or.msg.idServer=or.deletedIdServer,or.msg.time=or.deletedMsgTime,or.msg.fromNick=or.deletedMsgFromNick,or.opeAccount=or.opeAccount||or.from,or.msg.opeAccount=or.opeAccount,this.message.Message.setExtra(or.msg,this.account),or},Et.onDeleteMsgOfflineRoaming=function(or){if(!or.error){var hr,pr=this,Sr=+or.content.type==1?"offline":"roaming",Er=ir.reverseSysMsgs(or.content.sysMsgs,{mapper:function(kr){return pr.processDeleteMsgSysMsg(kr)}}),Pr=Er&&Er[0]&&Er[0].scene==="superTeam";pr.logger.info($(hr="msg::onDeleteMsgOfflineRoaming: on delete ".concat(Sr," ")).call(hr,Pr?"superTeam":""," idServer deletedIdClient deletedIdClient="),L(Er).call(Er,function(kr){var Ir,xr;return $(Ir=$(xr="".concat(kr.idServer,"-")).call(xr,kr.deletedIdServer,"-")).call(Ir,kr.deletedIdClient)})),Sr==="offline"&&pr.markSysMsgRead(Er);var Cr=or.content.timetag;Pr?(pr.timetags.deleteSuperTeamMsg=Cr,pr.syncResult.deleteSuperTeamMsgTimetag=Cr):(pr.timetags.deleteMsg=Cr,pr.syncResult.deleteMsgTimetag=Cr);var rr=pr.putSysMsg(Er,"offlineSysMsgs").catch(function(kr){return pr.logger.error("msgDelete::onDeleteMsgOfflineRoaming: ",kr),V.reject(kr)});rr.cmd="deleteMsgSysMsgs "+Sr,pr.syncPromiseArray.push(rr),pr.syncResult.deleteMsgSysMsgs=pr.syncResult.deleteMsgSysMsgs||[],pr.syncResult.deleteMsgSysMsgs.push({type:Sr,sysMsgs:Er})}},Et.deleteMsgOfflineRoaming=function(or,hr){if(!or)return V.resolve();var pr=this;pr.logger.info("msg::deleteMsgOfflineRoaming: ",L(or).call(or,function(Pr){var Cr;return Pr.type+" "+L(Cr=Pr.sysMsgs).call(Cr,function(rr){var kr,Ir;return $(kr=$(Ir="".concat(rr.idServer,"-")).call(Ir,rr.deletedIdServer,"-")).call(kr,rr.deletedIdClient)})}),Dt.secureOutput("session",hr));var Sr=pr.db,Er=[];return k(or).call(or,function(Pr){var Cr;k(Cr=Pr.sysMsgs).call(Cr,function(rr){var kr=pr.deleteLocalMsg(rr.msg,{cbUpdateSession:function(Ir){Ir=pr.mergeSession(Ir),Ir=z(dr).call(dr,Ir);var xr=Dt.findObjIndexInArray(hr,{value:Ir.id});if(xr!==-1&&(hr[xr]=Dt.merge({},hr[xr],Ir)),Sr.enable)return Sr.updateSession(Ir)}});Er.push(kr)})}),V.all(Er).then(function(){Sr.enable&&(pr.syncResult.deleteMsgTimetag&&Sr.updateTimetag("deleteMsg",pr.syncResult.deleteMsgTimetag),pr.syncResult.deleteSuperTeamMsgTimetag&&Sr.updateTimetag("deleteSuperTeamMsg",pr.syncResult.deleteSuperTeamMsgTimetag))})},Et.deleteMsgSelf=function(or){if(!or.error){var hr=this.db,pr=or.obj&&or.obj.deleteMsgSelfTag;if(pr){var Sr=or.content&&or.content.timetag;pr.scene=pr.scene+""=="1"?"p2p":"team";var Er=[this.deleteLocalMsg(pr)];Sr<=this.timetags.deleteMsgSelf||(this.timetags.deleteMsgSelf=Sr,hr.enable&&Er.push(hr.updateDeleteMsgSelf(Sr))),or.promise=V.all(Er)}}},Et.deleteMsgSelfBatch=function(){var or=g(n.mark(function hr(pr){var Sr,Er,Pr,Cr,rr,kr,Ir,xr;return n.wrap(function(vr){for(;;)switch(vr.prev=vr.next){case 0:if(!pr.error){vr.next=2;break}return vr.abrupt("return");case 2:if(Er=this,Pr=this.db,(Cr=pr.obj&&pr.obj.deleteMsgSelfTags)&&Cr.length>0){vr.next=7;break}return vr.abrupt("return");case 7:if(rr=re(Cr).call(Cr,function(_r,Or){var Mr=Or.sessionId;if(_r[Mr]=_r[Mr]||[],_r[Mr].push(Or),!Pr.enable){var yr=Er.getSessionInCache(Mr);yr&&yr.lastMsg&&Or&&yr.lastMsg.idClient===Or.idClient&&(yr.lastMsg=null,Er.onUpdateSession(yr))}return _r},{}),Pr.enable){vr.next=11;break}return k(kr=ie(rr)).call(kr,function(_r){var Or=rr[_r],Mr=Er.getSessionInCache(_r);if(Er.options.rollbackDelMsgUnread&&Mr){var yr=Mr.ack||0,mr=ue(Or).call(Or,function(Tr){var Br=!0;if(Tr.type==="notification")try{Br=Er.options.shouldCountNotifyUnread(Tr)}catch($r){throw Er.logger.error("userOption:shouldCountNotifyUnread function error",$r),$r}return Er.message.Message.setFlow(Tr,Er.account),Br&&yr<Tr.time&&Tr.flow==="in"});mr.length>0&&Mr.unread&&(Mr.unread=Mr.unread-mr.length>=0?Mr.unread-mr.length:0,Er.onUpdateSession(Mr))}}),vr.abrupt("return",V.resolve());case 11:Ir=L(Sr=ie(rr)).call(Sr,function(_r){var Or=rr[_r];return sr.call(Er,Or,_r)}),(xr=pr.content&&pr.content.timetag)<=Er.timetags.deleteMsgSelf||(Er.timetags.deleteMsgSelf=xr,Ir.push(Pr.updateDeleteMsgSelf(xr))),pr.promise=V.all(Ir);case 15:case"end":return vr.stop()}},hr,this)}));return function(hr){return or.apply(this,arguments)}}(),Et.onDeleteMsgSelf=function(or){var hr=this,pr=this.db,Sr=or.content.deleteMsgSelfTag;Sr.scene=Sr.scene+""=="1"?"p2p":"team",hr.options.onDeleteMsgSelf([Sr]),hr.deleteLocalMsg(Sr).then(function(){var Er=Sr.deletedTime;return Er<=hr.timetags.deleteMsgSelf||!pr.enable?V.resolve():(hr.timetags.deleteMsgSelf=Er,pr.updateDeleteMsgSelf(Er))}).catch(function(Er){hr.logger.error("onDeleteMsgSelf error",Er)})},Et.onDeleteMsgSelfBatch=function(or){var hr=this;if(!or.error){var pr={1:"p2p",2:"team"},Sr=Dt.get(or,"content.deleteMsgSelfTags")||[];k(Sr).call(Sr,function(Pr){var Cr;Pr.scene=pr[Pr.scene],Pr.sessionId=$(Cr="".concat(Pr.scene,"-")).call(Cr,hr.message.Message.getMsgTarget(Pr,hr.account)),Pr.deletedTime=le(Pr.deletedTime),Pr.time=le(Pr.time)});var Er=Dt.get(or,"content.deleteMsgSelfTags[0].deletedTime");Er=le(Er)||0,this.options.onDeleteMsgSelf(Sr),this.deleteMsgSelfBatch({obj:{deleteMsgSelfTags:Sr},content:{timetag:Er}})}},Et.clearServerHistoryMsgs=function(or){if(!or.error){var hr=this.db,pr=or.obj&&or.obj.clearMsgsParamsWithSync;if(pr){var Sr=(pr.type&&pr.type.toString()==="2"?"team":"p2p")=="p2p"?"p2p-".concat(pr.otherAccid):"team-".concat(pr.toTid),Er=or.content&&le(or.content.timetag);Er&&Er>this.timetags.sessionHistoryMsgsDelete&&(this.timetags.sessionHistoryMsgsDelete=Er,hr.enable&&hr.updateTimetag("sessionHistoryMsgsDelete",this.timetags.sessionHistoryMsgsDelete)),cr.call(this,Sr,Er)}}},Et.onClearServerHistoryMsgs=function(or){if(!or.error){var hr=this.db,pr=or.content&&or.content.sessionHistoryMsgsDeleteTag;if(pr){var Sr=(pr.type&&pr.type.toString()==="2"?"team":"p2p")=="p2p"?"p2p-".concat(pr.otherAccid):"team-".concat(pr.toTid),Er=pr.ext,Pr=le(pr.time);this.options.onClearServerHistoryMsgs&&this.options.onClearServerHistoryMsgs([{sessionId:Sr,time:Pr,ext:Er}]),Pr<=this.timetags.sessionHistoryMsgsDelete||(this.timetags.sessionHistoryMsgsDelete=Pr,hr.enable&&hr.updateTimetag("sessionHistoryMsgsDelete",this.timetags.sessionHistoryMsgsDelete)),cr.call(this,Sr,Pr)}}},Et.syncSessionHistoryMsgsDelete=function(or){if(!or.error){var hr=this.db,pr=or.content&&or.content.sessionHistoryMsgsDeleteTags;if(pr&&pr.length>0){var Sr=L(pr).call(pr,function(Pr){return{sessionId:(Pr.type&&Pr.type.toString()==="2"?"team":"p2p")=="p2p"?"p2p-".concat(Pr.otherAccid):"team-".concat(Pr.toTid),time:le(Pr.time)}});this.reporterHook.emit("reporter/syncItemComplete",lr.kSyncType4_24),this.options.onClearServerHistoryMsgs&&this.options.onClearServerHistoryMsgs(Sr),this.syncResult.clearServerHistoryMsgs=Sr;var Er=0;k(Sr).call(Sr,function(Pr){Pr.time>Er&&(Er=Pr.time)}),hr.enable&&hr.updateTimetag("sessionHistoryMsgsDelete",Er)}}},Et.syncDeleteMsgSelf=function(or){var hr=this,pr=this.db,Sr=or.content.deletedMsgs;if(Sr&&Sr.length!==0){var Er=[];k(Sr).call(Sr,function(Pr){Pr.scene=Pr.scene==="1"?"p2p":"team",Pr.deletedTime=+Pr.deletedTime,Pr.time=+Pr.time,Er.push(hr.deleteLocalMsg(Pr))}),hr.options.onDeleteMsgSelf(Sr),V.all(Er).then(function(){var Pr=oe(Sr).call(Sr,-1)[0].deletedTime;if(!(hr.timetags.deleteMsgSelf>=Pr))return hr.timetags.deleteMsgSelf=Pr,pr.enable?pr.updateDeleteMsgSelf(Pr):void 0}).catch(function(Pr){hr.logger.error("syncDeleteMsgSelf error",Pr)})}},Et.deleteLocalMsg=function(){var or=g(n.mark(function hr(pr,Sr){var Er,Pr,Cr,rr,kr,Ir,xr,vr,_r,Or,Mr,yr;return n.wrap(function(mr){for(;;)switch(mr.prev=mr.next){case 0:if(pr){mr.next=2;break}return mr.abrupt("return");case 2:if(Cr=(Pr=this).db,rr=(Sr=Sr||{}).cbUpdateSession||ae(Er=Pr.updateSessionInDbWithNotify).call(Er,Pr),this.revokeMsgUniqueCheck(pr&&pr.idClient),kr=pr.sessionId||pr.scene+"-"+this.message.Message.getMsgTarget(pr,this.account),Ir=!1,xr=Pr.getSessionInCache(kr),vr=!0,pr.type!=="notification"){mr.next=20;break}mr.prev=12,vr=Pr.options.shouldCountNotifyUnread(pr),mr.next=20;break;case 16:throw mr.prev=16,mr.t0=mr.catch(12),Pr.logger.error("userOption:shouldCountNotifyUnread function error",mr.t0),mr.t0;case 20:if(Pr.options.rollbackDelMsgUnread&&xr&&(_r=xr.ack||0,vr&&xr&&_r<pr.time&&pr.from!==Pr.account&&xr.unread&&(Pr.logger.info("msgDelete::deleteLocalMsg:cache.getSessions: unread",xr.id,xr.unread),xr.unread=xr.unread-1,Ir=!0)),xr&&xr.lastMsg&&xr.lastMsg.idClient==pr.idClient&&(Pr.logger.info("msgDelete::deleteLocalMsg:cache.getSessions: lastMsg",xr.id,xr.unread),xr.lastMsg=null,Ir=!0),!Cr.enable){mr.next=49;break}return Or=null,mr.next=26,Cr.getMsgByIdClient(pr.idClient);case 26:return mr.sent||Pr.logger.info("msgDelete::deleteLocalMsg::db.deleteMsg no find in DB",pr),Pr.logger.info("msgDelete::deleteLocalMsg::db.deleteMsg ",pr.idClient),mr.next=31,Cr.deleteMsg(pr.idClient);case 31:if(!xr||xr.lastMsg!==null){mr.next=36;break}return mr.next=34,Cr.getMsgs({sessionId:kr,limit:1});case 34:(Mr=mr.sent)&&Mr[0]&&(Or=Mr[0]);case 36:if(xr||!Pr.options.rollbackDelMsgUnread){mr.next=46;break}return Pr.logger.info("msgDelete::deleteLocalMsg::Can not find session in cache,will find in DB",kr),mr.next=40,Cr.getSession(kr);case 40:if(yr=mr.sent){mr.next=43;break}return mr.abrupt("return");case 43:_r=(xr=yr).ack||0,vr&&xr&&_r<pr.time&&pr.flow==="in"&&xr.unread&&(Pr.logger.info("msgDelete::deleteLocalMsg:db.getSessions: unread",yr.id,yr.unread),xr.unread=xr.unread-1,Ir=!0);case 46:if(xr&&xr.lastMsg===null&&Or&&(Pr.logger.info("msgDelete::deleteLocalMsg:db.getSessions: lastMsg",kr,Or),xr.lastMsg=Or||null,Ir=!0),!Ir){mr.next=49;break}return mr.abrupt("return",rr(xr));case 49:if(Cr.enable||!Ir){mr.next=52;break}return Pr.onUpdateSession(xr),mr.abrupt("return");case 52:case"end":return mr.stop()}},hr,this,[[12,16]])}));return function(hr,pr){return or.apply(this,arguments)}}(),Et.deleteLocalMsgs=function(or){var hr=this,pr=hr.db;return new V(function(Sr,Er){if(function(Pr){var Cr=hr.getSessionInCache(or.sessionId);if(Cr&&or.updateSession){var rr=Cr.lastMsg;rr&&(!or.start&&!or.end||rr.time>or.start&&rr.time<or.end)&&(Cr.lastMsg=null,hr.logger.log("deleteLocalMsgs::delete cacheSession lastMsg done, options is",or),pr.enable||(hr.onUpdateSession(Cr),Pr()))}}(Sr),pr.enable)return pr.deleteMsgsBySessionId(or).then(function(){or.updateSession&&hr.checkAndUpdateLocalSessionByMsg(or.sessionId),Sr()},function(Pr){return Er(Pr)})})},Et.deleteLocalMsgsByTime=function(){var or=g(n.mark(function hr(pr){var Sr,Er,Pr,Cr,rr,kr,Ir,xr,vr,_r,Or,Mr,yr,mr;return n.wrap(function(Tr){for(;;)switch(Tr.prev=Tr.next){case 0:return Er=(Sr=this).db,Tr.next=4,Er.getDeletedMsgsCountByTime(pr);case 4:return Pr=Tr.sent,Cr=0,rr=[],Tr.next=9,Er.deleteMsgsByTime(pr);case 9:return pr.deletedone&&pr.deletedone({deletedMsgCount:Pr}),Tr.next=12,Er.getAllSessions();case 12:kr=Tr.sent,Ir=Lt(kr),Tr.prev=14,Ir.s();case 16:if((xr=Ir.n()).done){Tr.next=47;break}return vr=xr.value,_r=vr.id,Or=!1,Tr.next=22,Er.getSession(_r);case 22:if(Mr=Tr.sent){Tr.next=25;break}return Tr.abrupt("continue",45);case 25:return Tr.next=27,Er.getMsgCountAfterAck({shouldCountNotifyUnread:Sr.options.shouldCountNotifyUnread,sessionId:_r,ack:Mr.ack||0});case 27:if(yr=Tr.sent,Mr.unread!==yr&&(Mr.unread=yr,Or=!0),!(Mr.lastMsg&&Mr.lastMsg.time>pr.start&&Mr.lastMsg.time<pr.end)){Tr.next=39;break}if(pr.start!==0){Tr.next=34;break}Mr.lastMsg=null,Tr.next=38;break;case 34:return Tr.next=36,Er.getMsgs({sessionId:_r,limit:1});case 36:mr=Tr.sent,Mr.lastMsg=mr&&mr[0]?mr[0]:null;case 38:Or=!0;case 39:if(!Or){Tr.next=45;break}return Tr.next=42,Er.updateSession(Mr);case 42:Sr.sessionSet[_r]&&rr.push(Mr),Cr++;case 45:Tr.next=16;break;case 47:Tr.next=52;break;case 49:Tr.prev=49,Tr.t0=Tr.catch(14),Ir.e(Tr.t0);case 52:return Tr.prev=52,Ir.f(),Tr.finish(52);case 55:return Sr.onUpdateSessions(rr),Tr.abrupt("return",V.resolve({deletedMsgCount:Pr,sessionUpdateCount:Cr}));case 57:case"end":return Tr.stop()}},hr,this,[[14,49,52,55]])}));return function(hr){return or.apply(this,arguments)}}()},function(t,r,e){var n=e(71),g=e(9),y=e(10),i=e(6),k=e(3),$=e(24),L=e(16),V=e(2),z=e(35).fn,re=e(0),ie=e(153);z.splitSysMsgs=function(ue,le){for(var oe,ae=ue.length-1;ae>=0;ae--)oe=ue[ae],ie.isCustom(oe)&&(n(ue).call(ue,ae,1),le.push(oe))},z.onOfflineSysMsgs=function(ue,le){var oe,ae=this,qe=g(oe=ue.content.sysMsgs).call(oe,function(jt){return jt=y(ie).call(ie,jt),le&&(jt.filter=!0),jt});qe=y(qe).call(qe),ae.markSysMsgRead(qe);var de=[];ae.splitSysMsgs(qe,de);var Ne,ze=le?"offlineFilterSysMsgs":"offlineSysMsgs",$e=le?"offlineFilterCustomSysMsgs":"offlineCustomSysMsgs";if(qe.length){var Lt=ae.putSysMsg(qe,"offlineSysMsgs").then(function(jt){var Et;(qe=jt).length&&(ae.logger.info("sysmsg::onOfflineSysMsgs: ",ze,qe.length,qe&&g(qe).call(qe,function(ir){return ir.idServer})),ae.syncResult[ze]=ae.syncResult[ze]||[],ae.syncResult[ze]=i(Et=ae.syncResult[ze]).call(Et,qe))}).catch(function(jt){return ae.logger.error("sysMsg::onOfflineSysMsgs: ",jt),k.reject(jt)});Lt.cmd="sysMsgs",ae.syncPromiseArray.push(Lt)}de.length&&(ae.logger.info("sysmsg::onOfflineSysMsgs: ",$e,g(de).call(de,function(jt){return jt.idServer})),ae.syncResult[$e]=ae.syncResult[$e]||[],ae.syncResult[$e]=i(Ne=ae.syncResult[$e]).call(Ne,de))},z.onSendSysMsg=function(ue,le){var oe=ue.obj||{};oe?(this.completeSysMsg(oe),ue.error?oe.status="fail":oe.status="success",oe=y(ie).call(ie,oe),le&&(ue.obj.filter=!0),ue.obj=oe):this.logger.warn("onSendSysMsg::no obj")},z.completeSysMsg=function(ue){return ue.from=this.account,ue},z.onSysMsg=function(ue,le){var oe=y(ie).call(ie,ue.content.sysMsg);le&&(oe.filter=!0),this.markSysMsgRead(oe),ie.isCustom(oe)?(this.logger.info("sysmsg::onSysMsg: on customSysMsg"),this.options.oncustomsysmsg(oe)):this.syncing?(this.logger.info("sysmsg::onSysMsg:is in syncing ..."),this.unhandledSysMsgs.push(oe)):this.handleSysMsg(oe)},z.handleSysMsg=function(ue){var le=this,oe=ue.type,ae=ue.from,qe=ue.serverex;le.sysMsgPromise=le.sysMsgPromise.then(function(){return le.putSysMsg(ue,"onSysMsg")}).then(function(de){ue=de[0]}).then(function(){if(ue){var de,Ne=k.resolve();switch(oe){case"addFriend":de={type:"addFriend",account:ae},qe&&(de.serverex=qe),Ne=le.onFriendRequest(de);break;case"passFriendApply":de={type:"passFriendApply",account:ae},Ne=le.onFriendRequest(de);break;case"deleteFriend":Ne=le.onDeleteFriend({account:ae})}return de&&de.friend&&(ue.friend=de.friend),Ne}}).then(function(){ue&&(le.logger.info("sysmsg::handleSysMsg: ",oe,re.pickAsString(ue,["idServer","deletedIdClient","deletedIdServer"])),$(function(){le.options.onsysmsg(ue)},0))})},z.putSysMsg=function(ue,le){if(re.isArray(ue)||(ue=[ue]),L(ue[0]))return k.resolve(ue);var oe=this,ae=oe.db,qe=ae.enable,de=k.resolve(),Ne=[];return(de=(de=de.then(function(){return qe?ae.putSysMsg(ue):ue}).then(function(ze){var $e=[];V(ue).call(ue,function(Lt){oe.checkSysMsgUnique(Lt)&&$e.push(Lt)}),ue=$e,Ne=qe?ze:ue})).then(function(){return oe.getSysMsgUnread().then(function(ze){return Ne.length||((Ne=ue).backward=!0),oe.updateSysMsgUnread(Ne,ze,1).then(function($e){le==="offlineSysMsgs"&&(oe.syncResult.sysMsgUnread=$e),le==="onSysMsg"&&oe.onUpdateSysMsgUnread($e)})})})).then(function(){return ue})},z.checkSysMsgUnique=re.genCheckUniqueFunc("idServer"),z.getSysMsgUnread=function(){var ue=this,le=ue.db;return new k(function(oe){le.enable?le.getSysMsgUnread().then(function(ae){oe(ae)},function(){oe(ue.sysMsgUnread)}):oe(ue.sysMsgUnread)})},z.updateSysMsgUnread=function(ue,le,oe){if(re.isArray(ue)||(ue=[ue]),!ue.length)return k.resolve(le);le=le||{};var ae,qe=this.db;return V(ue).call(ue,function(de){(oe>0&&!de.read||oe<0&&de.read)&&(ae=de.type,le[ae]=(le[ae]||0)+oe)}),le=ie.completeUnread(le),this.sysMsgUnread=le,qe.enable&&!ue.backward?qe.updateSysMsgUnread(le):k.resolve(le)},z.reduceSysMsgUnread=function(ue){var le=this;return le.getSysMsgUnread().then(function(oe){return le.updateSysMsgUnread(ue,oe,-1)}).then(function(oe){le.onUpdateSysMsgUnread(oe)})},z.onUpdateSysMsgUnread=function(ue){var le=this;$(function(){le.logger.info("sysmsg::onUpdateSysMsgUnread:",ue),le.options.onupdatesysmsgunread(ue)},0)},z.updateSysMsg=function(ue){var le=this,oe=le.db;(oe.enable?oe.updateSysMsg(ue):k.resolve(ue)).then(function(ae){le.onUpdateSysMsg(ae)})},z.onUpdateSysMsg=function(ue){var le=this;$(function(){re.isArray(ue)||(ue=[ue]),V(ue).call(ue,function(oe){le.logger.info("sysmsg::onUpdateSysMsg:",oe.idServer),le.options.onupdatesysmsg(oe)})},0)},z.processUnsettledSysMsgs=function(){var ue,le,oe=this;V(ue=oe.unhandledSysMsgs).call(ue,function(ae){oe.handleSysMsg(ae)}),V(le=oe.unhandledSysMsgsForDeletedMsgs).call(le,function(ae){oe.onMsgDeleted(ae.packet,ae.isSuperTeam)}),oe.resetUnsettledSysMsgs()}},function(t,r,e){var n=e(759),g=e(51),y=e(2),i=e(7),k=e(15),$=e(10),L=e(3),V=e(9),z=e(90),re=e(16),ie=e(37),ue=e(4),le=e(6),oe=e(52),ae=e(53),qe=e(54),de=e(55),Ne=e(43);function ze(Dt,lr){var sr=ue(Dt);if(oe){var er=oe(Dt);lr&&(er=re(er).call(er,function(cr){return ae(Dt,cr).enumerable})),sr.push.apply(sr,er)}return sr}function $e(Dt){for(var lr=1;lr<arguments.length;lr++){var sr,er,cr=arguments[lr]!=null?arguments[lr]:{};lr%2?y(sr=ze(Object(cr),!0)).call(sr,function(or){g(Dt,or,cr[or])}):qe?de(Dt,qe(cr)):y(er=ze(Object(cr))).call(er,function(or){Ne(Dt,or,ae(cr,or))})}return Dt}var Lt=e(35).fn,jt=e(0),Et=e(154),ir=e(41),dr=e(153);Lt.processSession=function(Dt){if(!Dt.error)switch(Dt.cmd){case"getServerSessions":this.onGetServerSessions(Dt);break;case"getServerSession":this.onGetServerSession(Dt);break;case"updateServerSession":this.onUpdateServerSession(Dt)}},Lt.onGetServerSessions=function(Dt){var lr=this,sr=Dt.content&&Dt.content.sessionReqTag,er=Dt.content&&Dt.content.sessionList,cr=[];y(er).call(er,function(or){var hr,pr;if(or.id=or.id.split("|").join("-"),i(hr=or.id).call(hr,"super_team")===0&&(or.id="superTeam"+k(pr=or.id).call(pr,10)),or.updateTime=+or.updateTime,or.lastMsg){var Sr=or.lastMsgType==="1"?"sysMsg":"msg";cr.push(lr.parser.unserialize(JSON.parse(or.lastMsg),Sr).then(function(Er){var Pr;or.lastMsg=Sr==="msg"?$(Pr=lr.message).call(Pr,Er):$(dr).call(dr,Er)}))}}),Dt.promise=L.all(cr).then(function(){Dt.obj={sessionList:er,hasMore:sr.hasMore==="1"},sr.minTimestamp&&(Dt.obj.minTimestamp=+sr.minTimestamp)})},Lt.onGetServerSession=function(Dt){var lr,sr=this,er=Dt.content&&Dt.content.session;if(er){var cr;if(er.id=er.id.split("|").join("-"),i(lr=er.id).call(lr,"super_team")===0&&(er.id="superTeam"+k(cr=er.id).call(cr,10)),er.updateTime=+er.updateTime,er.lastMsg){var or=Dt.content.session&&Dt.content.session.lastMsgType==="1"?"sysMsg":"msg";Dt.promise=sr.parser.unserialize(JSON.parse(er.lastMsg),or).then(function(hr){var pr;er.lastMsg=or==="msg"?$(pr=sr.message).call(pr,hr):$(dr).call(dr,hr),Dt.obj=er})}else Dt.obj=er}},Lt.onUpdateServerSession=function(Dt){Dt.obj={}},Lt.onSyncUpdateServerSession=function(Dt){var lr,sr=this,er=this,cr=Dt.content&&Dt.content.session;if(cr){var or;cr.id=cr.id.split("|").join("-"),i(lr=cr.id).call(lr,"super_team")===0&&(cr.id="superTeam"+k(or=cr.id).call(or,10)),cr.updateTime=+cr.updateTime,cr.lastMsg?er.parser.unserialize(JSON.parse(cr.lastMsg),"msg").then(function(hr){var pr;cr.lastMsg=$(pr=er.message).call(pr,hr),sr.options.onSyncUpdateServerSession(jt.simpleClone(cr))}):this.options.onSyncUpdateServerSession(jt.simpleClone(cr))}},Lt.mergeSession=function(Dt){Dt=jt.copyWithNull(Dt);var lr=this.sessionSet,sr=Dt.id,er=lr[sr]||{},cr=!1;return Et.isComplete(Dt)?delete er.isDeleted:er.isDeleted&&(cr=!0),lr[sr]=jt.merge(er,Dt),Dt=cr?Dt:lr[sr],jt.undef(Dt.unread)&&(Dt.unread=0),Dt},Lt.mergeSessions=function(Dt){var lr=this;return V(Dt=Dt||[]).call(Dt,function(sr){return lr.mergeSession(sr)})},Lt.onDeleteSessions=function(Dt){var lr;Dt.obj=V(lr=Dt.obj.sessions).call(lr,function(sr){return Et.parse(sr)})},Lt.onUpdateSession=function(Dt){if(Dt){if(Dt=this.mergeSession(Dt),Dt=z(Et).call(Et,Dt),Et.isComplete(Dt))return this.logger.info("session::onUpdateSession: ".concat(Dt.id),Dt.id,jt.secureOutput("session",Dt)),this.options.onupdatesessions?this.options.onupdatesessions([Dt]):this.options.onupdatesession(Dt),Dt;this.logger.warn("session::onUpdateSession::session is not complete",jt.secureOutput("session",Dt))}},Lt.onUpdateSessions=function(Dt){var lr=this;if(Dt){Dt=lr.mergeSessions(Dt),Dt=V(Dt).call(Dt,function(cr){return z(Et).call(Et,cr)});var sr=re(Dt).call(Dt,function(cr){return Et.isComplete(cr)}),er=re(Dt).call(Dt,function(cr){return!Et.isComplete(cr)});if(er&&er.length>0&&lr.logger.warn("session::onUpdateSessions::sessions is not complete",V(er).call(er,function(cr){return cr.id}),jt.secureOutput("session",er)),sr.length!==0)return lr.logger.info("session::onUpdateSessions:",jt.secureOutput("session",sr)),lr.options.onupdatesessions?lr.options.onupdatesessions(sr):y(sr).call(sr,function(cr){lr.options.onupdatesession(cr)}),sr;lr.logger.warn("session::onUpdateSessions::completeSessions is empty")}},Lt.setCurrSession=function(Dt){Dt=""+Dt,this.currSessionId=Dt,this.logger.info("session::setCurrSession:",Dt)},Lt.resetSessionUnread=function(Dt){var lr=Dt.id;this.db.enable&&this.db.updateSession({id:lr,unread:0}),!this.options.autoMarkRead&&this.sessionUnreadMsgs&&this.sessionUnreadMsgs[lr]&&(this.markMsgRead(this.sessionUnreadMsgs[lr],!0),this.sessionUnreadMsgs[lr]=[]),this.getSessionInCache(lr)?this.onUpdateSession({id:lr,unread:0}):this.onUpdateSession($e($e({},Dt),{},{unread:0}))},Lt.resetSessionsUnread=function(Dt){var lr=this,sr=this.db;sr.enable&&V(Dt).call(Dt,function(cr){sr.updateSession({id:cr.id,unread:0})});var er=!this.options.autoMarkRead&&this.sessionUnreadMsgs;Dt=V(Dt).call(Dt,function(cr){return er&&lr.sessionUnreadMsgs[cr.id]&&(lr.markMsgRead(lr.sessionUnreadMsgs[cr.id],!0),lr.sessionUnreadMsgs[cr.id]=[]),lr.getSessionInCache(cr.id)?{id:cr.id,unread:0}:$e($e({},cr),{},{unread:0})}),this.onUpdateSessions(Dt)},Lt.insertLocalSession=function(Dt){var lr=this,sr=lr.db,er=Dt.scene+"-"+Dt.to,cr=lr.getSessionInCache(er);return cr&&Et.isComplete(cr)?L.reject(ir.sessionExist({callFunc:"session::insertLocalSession",session:cr})):(sr.enable?sr.getMsgs({sessionId:er,limit:1}):L.resolve()).then(function(or){if(jt.isArray(or)&&or.length===1){var hr=or[0];(cr=Et.genSessionByMsg(hr)).updateTime=hr.time}else cr={id:er,scene:Dt.scene,to:Dt.to,updateTime:+Dt.updateTime||+new Date,lastMsg:null};return lr.onUpdateSession(cr),sr.enable?sr.putSession(cr):L.resolve(cr)})},Lt.checkAndUpdateLocalSessionByMsg=function(Dt){var lr,sr=this.db,er=this,cr=this.options.syncSessionUnread&&Dt!==this.currSessionId,or=sr.getMsgs({sessionId:Dt,limit:1}),hr=sr.getSession(Dt).then(function(pr){if(pr)return lr=ie({},pr),pr.ack=pr.ack||0,cr?sr.getMsgs({sessionId:Dt,start:pr.ack}):L.resolve();er.logger.error("can't find session that sessionId = ".concat(Dt))});return L.all([or,hr]).then(function(pr){var Sr,Er,Pr=n(pr,2),Cr=Pr[0],rr=Pr[1],kr={id:Dt};if(!lr)return er.logger.error("checkAndUpdateLocalSessionByMsg:can not find session",Dt),L.resolve(200);if(Sr=lr&&!lr.lastMsg?null:lr.lastMsg.idClient,Cr&&Cr[0]?Er=(Cr=Cr[0]).idClient:(Er=null,Cr=null),Sr!==Er&&(kr.lastMsg=Cr),rr!==void 0){var Ir=0;y(rr=rr||[]).call(rr,function(xr){var vr;try{vr=er.options.shouldCountNotifyUnread(xr)}catch(_r){throw er.logger.error("userOption:shouldCountNotifyUnread function error",_r),_r}xr.isUnreadable&&xr.flow==="in"&&(xr.type!=="notification"||vr)&&Ir++}),Ir!==lr.unread&&(kr.unread=Ir)}return ue(kr).length>1?(er.logger.info("session::checkAndUpdateLocalSessionByMsg::needUpdate newSession:",jt.secureOutput("session",kr)),sr.updateSession(kr).then(function(){return er.onUpdateSession(kr)})):L.resolve(200)})},Lt.syncSessionsWithMoreRoaming=function(Dt){var lr=this,sr=Dt&&Dt.content&&Dt.content.sessions;if(sr&&sr.length){var er={0:"p2p",1:"team",5:"superTeam"};if(y(sr).call(sr,function(or){var hr,pr=or.to===lr.options.account?or.from:or.to;or.scene=er[or.scene],or.id=le(hr="".concat(or.scene,"-")).call(hr,pr),or.time=+or.time}),this.db.enable){var cr=this.db.putSessionsWithMoreRoaming(sr);cr.cmd="syncSessionsWithMoreRoaming",this.syncPromiseArray.push(cr)}this.syncing&&this.syncResult?this.syncResult.sessionsWithMoreRoaming=sr:this.logger.warn("syncSessionsWithMoreRoaming::not in syncing or no syncResult")}},Lt.syncStickTopSessions=function(Dt){var lr=this,sr=this.db,er=[],cr=[],or=L.resolve(),hr=Dt.content.sessions||[];this.syncing&&this.syncResult?(y(hr).call(hr,function(pr){var Sr=pr.id.split("|");Sr[0]==="super_team"&&(Sr[0]="superTeam"),pr.id=Sr.join("-"),pr.scene=Sr[0],pr.to=Sr[1],pr.isTop=!0,er.push(Sr.join("-")),delete pr.createTime,delete pr.updateTime,sr.enable&&cr.push(sr.putSession(pr))}),sr.enable&&(or=sr.updateTimetag("stickTopSessions",Dt.content.timetag)),or.then(function(){return sr.enable?sr.getStickTopSessions():[]}).then(function(pr){if(Dt.content.modify){var Sr=[];y(pr).call(pr,function(Er){i(er).call(er,Er.id)>-1||(Sr.push(Er.id),Er.isTop=!1,Er.topCustom="",cr.push(sr.putSession(Er)))})}else lr.syncResult.stickTopSessions=pr;return L.all(cr)}),this.syncResult.stickTopSessions=hr,or.cmd="syncStickTopSessions",this.syncPromiseArray.push(or)):this.logger.warn("syncSessionsWithMoreRoaming::not in syncing or no syncResult")},Lt.getSessionInCache=function(Dt,lr){var sr=this.sessionSet[Dt];return!sr||sr.isDeleted&&!lr?void 0:sr},Lt.deleteSessionInCache=function(Dt,lr){var sr=this;jt.isArray(Dt)||(Dt=[Dt]),lr?y(Dt).call(Dt,function(er){sr.sessionSet[er]&&(sr.sessionSet[er].isDeleted=!0)}):y(Dt).call(Dt,function(er){return delete sr.sessionSet[er]}),this.logger.info("sessions::deleteSessionInCache::delete session done",Dt,lr)},Lt.updateSessionInCache=function(Dt){return this.logger.info("session::updateSessionInCache: ".concat(Dt.id),Dt.id,Dt),this.getSessionInCache(Dt.id)?Dt=this.mergeSession(Dt):(this.logger.info("session::updateSessionInCache: can not find session in cache ".concat(Dt.id)),null)},Lt.updateSessionInDbWithNotify=function(Dt,lr){var sr=this;return new L(function(er,cr){var or=sr.db;if(sr.getSessionInCache(Dt.id)){var hr=L.resolve(),pr=jt.filterObj(Dt,"id lastMsg localCustom unread");or.enable&&(hr=or.updateSession(pr)),hr.then(function(Sr){return sr.onUpdateSession(Sr,lr)}).then(er,function(Sr){cr({callFunc:"session::updateLocalSession",event:Sr})})}else cr(ir.sessionNotExist({sessionId:Dt.id,callFunc:"session::updateLocalSession"}))})}},function(t,r,e){var n=e(750);t.exports=function(g){if(n(g))return g},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,r,e){var n=e(155),g=e(72);t.exports=function(y,i){var k=y==null?null:n!==void 0&&g(y)||y["@@iterator"];if(k!=null){var $,L,V,z,re=[],ie=!0,ue=!1;try{if(V=(k=k.call(y)).next,i===0){if(Object(k)!==k)return;ie=!1}else for(;!(ie=($=V.call(k)).done)&&(re.push($.value),re.length!==i);ie=!0);}catch(le){ue=!0,L=le}finally{try{if(!ie&&k.return!=null&&(z=k.return(),Object(z)!==z))return}finally{if(ue)throw L}}return re}},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,r){t.exports=function(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,r,e){var n=e(2),g=e(4),y=e(6),i=e(37),k=e(35).fn,$=e(0);k.syncSessionAck=function(L){var V,z=this;if(this.logger.info("syncSessionAck::",L.content),z.syncing&&z.syncResult){z.saveAck.p2pTeam=L.content.timetag;var re={};n(V=[[L.content.p2p,"p2p"],[L.content.team.m_map,"team"]]).call(V,function(ie){var ue,le=ie[0],oe=ie[1];n(ue=g(le)).call(ue,function(ae){var qe,de;re[y(qe="".concat(oe,"-")).call(qe,ae)]=le[ae];var Ne={id:y(de="".concat(oe,"-")).call(de,ae),ack:le[ae]};z.cacheSyncedSession(Ne)})}),z.syncResult.ackMap?z.syncResult.ackMap=i(z.syncResult.ackMap,re):z.syncResult.ackMap=re}else z.logger.warn("syncSessionAck: not in syncing or no syncResult",z.syncing,!!z.syncResult)},k.syncSuperTeamSessionAck=function(L){var V,z=this;if(z.syncResult){z.saveAck.superTeam=L.content.timetag;var re={},ie=L.content.superTeam.m_map;n(V=g(ie)).call(V,function(ue){re["superTeam-".concat(ue)]=ie[ue];var le={id:"superTeam-".concat(ue),ack:ie[ue]};z.cacheSyncedSession(le)}),z.syncResult.ackMap?z.syncResult.ackMap=i(z.syncResult.ackMap,re):z.syncResult.ackMap=re}},k.onMarkSessionAck=function(L){L.error||this.storeSessionAck(L.obj)},k.syncMarkSessionAck=function(L){this.storeSessionAck(L.content,!0)},k.storeSessionAck=function(L,V){var z;if(this.options.syncSessionUnread&&L){var re;switch(L.scene){case 0:re="p2p";break;case 1:re="team";break;case void 0:default:re="superTeam"}var ie=y(z="".concat(re,"-")).call(z,L.to),ue=L.timetag;if(ue<=((this.getSessionInCache(ie)||{}).ack||0))this.logger.warn("session::storeSessionAck: ack <= ackInMemory",ue);else{var le={id:ie,ack:ue};this.mergeSession(le),this.logger.info("session::storeSessionAck:",$.secureOutput("session",le)),this.markUnreadBySessionAck({sessionId:ie,ack:le.ack},V)}}},k.markUnreadBySessionAck=function(L,V){var z=L.sessionId,re=L.ack,ie=this,ue=ie.db;if(ue.enable)ie.pushMsgTask(function(){return ue.getMsgCountAfterAck({shouldCountNotifyUnread:ie.options.shouldCountNotifyUnread,sessionId:z,ack:re}).then(function(ze){var $e={id:z,unread:ze,ack:re};return ie.logger.info("session::markUnreadBySessionAck: db.getMsgCountAfterAck done",$e),ie.syncing?ie.cacheSyncedSession($e):V&&ie.onUpdateSession($e),ue.updateSession($e)}).catch(function(ze){ie.logger.error("markUnreadBySessionAck::error",ze)})});else{var le=ie.getSessionInCache(z);if(le){var oe=le.unreadMsgs;if(oe&&oe.length){for(var ae=0,qe=[],de=oe.length-1;de>=0;de--){var Ne=oe[de];if(!(Ne.time>re))break;ae++,qe.push(Ne)}le.unreadMsgs=qe,le.unread=ae,ie.logger.info("session::markUnreadBySessionAck: unread ".concat(ae)),ie.syncing?ie.cacheSyncedSession(le):V&&ie.onUpdateSession(le)}}}}},function(t,r,e){var n=e(35).fn;n.processChatroom=function(g){switch(g.cmd){case"getChatroomAddress":this.onChatroomAddress(g)}},n.onChatroomAddress=function(g){g.error||(g.obj.address=g.content.address)}},function(t,r,e){var n=e(35).fn;n.processQchat=function(g){switch(g.cmd){case"getQChatAddress":this.onQChatAddress(g)}},n.onQChatAddress=function(g){g.error||(g.obj.address=g.content.address)}},function(t,r,e){e(35).fn.processFilter=function(n){switch(n.cmd){case"sendFilterMsg":this.onSendMsg(n,!0);break;case"filterMsg":this.onMsg(n,!0);break;case"filterSysMsg":this.onSysMsg(n,!0);break;case"sendFilterCustomSysMsg":this.onSendSysMsg(n,!0)}}},function(t,r,e){var n=e(9),g=e(45),y=e(35).fn,i=e(0),k=g.clientTypeMap;function $(L){L=L||{};var V=i.copy(L);return V.clientType&&(V.clientType=k[V.clientType]||""),V.serverCustom&&(V.custom=JSON.parse(V.serverCustom),typeof V.custom[0]=="string"&&(V.custom=V.custom[0]),delete V.serverCustom),V}y.processEventService=function(L){var V=L.content,z=L.error,re=this.options||{};switch(z&&(z.callFunc="events::processsEventService",this.onCustomError("事件服务解包失败","EVENT_SERVICE_ERROR",z)),L.cmd){case"pushEvent":if(i.isFunction(re.onpushevents)){var ie={msgEvents:[$(V.msgEvent)]};re.onpushevents(ie)}break;case"pushEvents":if(i.isFunction(re.onpushevents)){var ue=V.msgEvents;ue={msgEvents:n(ue).call(ue,function(le){return $(le)})},re.onpushevents(ue)}}}},function(t,r,e){var n=e(35).fn,g=e(0);n.processProxyService=function(y){var i=y.error;switch(i&&(i.callFunc="events::processProxyService",this.onCustomError("proxyService","EVENT_PROXY_SERVICE_ERROR",i)),y.cmd){case"onProxyMsg":if(g.isFunction(this.options.onProxyMsg)){var k=y.content.proxyMsg||{};k.time&&(k.time=+k.time),this.options.onProxyMsg(k)}break;case"httpProxy":y.obj=y.content&&y.content.proxyTag}}},function(t,r,e){var n=e(10),g=e(9),y=e(0),i=function(ae){this.account=ae.account},k=i.prototype,$=k.Message=e(76),L=k.TextMessage=e(835),V=k.FileMessage=e(205),z=k.GeoMessage=e(839),re=k.NotificationMessage=e(840),ie=k.CustomMessage=e(841),ue=k.TipMessage=e(842),le=k.RobotMessage=e(843),oe=k.G2Message=e(844);k.validScenes=$.validScenes,k.validTypes=$.validTypes,k.sceneMap=$.sceneMap,k.sceneReverseMap=$.sceneReverseMap,k.reverse=function(ae){var qe;switch($.getType(ae)){case"text":qe=n(L).call(L,ae);break;case"image":case"audio":case"video":case"file":qe=n(V).call(V,ae);break;case"geo":qe=n(z).call(z,ae);break;case"notification":qe=n(re).call(re,ae);break;case"custom":qe=n(ie).call(ie,ae);break;case"tip":qe=n(ue).call(ue,ae);break;case"g2":qe=n(oe).call(oe,ae);break;case"robot":qe=n(le).call(le,ae);break;default:qe=n($).call($,ae)}return $.setExtra(qe,this.account),qe},k.reverseMsgs=function(ae,qe){var de,Ne,ze=this;return g(ae).call(ae,function($e){return $e=n(ze).call(ze,$e),qe&&((de=qe.modifyObj)&&($e=y.merge($e,de)),Ne=qe.mapper,y.isFunction(Ne)&&($e=Ne($e))),$e})},t.exports=i},function(t,r,e){var n=e(18),g=e(10),y=e(76),i=e(0);function k($){i.verifyOptions($,"text","msg::TextMessage"),$.type="text",y.call(this,$)}k.prototype=n(y.prototype),k.reverse=function($){return g(y).call(y,$)},t.exports=k},function(t,r,e){var n=e(18),g=e(205);function y(){}y.prototype=n(g.prototype),y.verifyFile=function(i,k){return!0},t.exports=y},function(t,r,e){var n=e(18),g=e(205);function y(){}y.prototype=n(g.prototype),y.verifyFile=function(){},t.exports=y},function(t,r,e){var n=e(18),g=e(205);function y(){}y.prototype=n(g.prototype),y.verifyFile=function(){},t.exports=y},function(t,r,e){var n=e(8),g=e(18),y=e(10),i=e(76),k=e(0);function $(L){L.type="geo",k.verifyOptions(L,"geo","msg::GeoMessage"),k.verifyOptions(L.geo,"lng lat title",!0,"geo.","msg::GeoMessage"),k.verifyParamType("geo.lng",L.geo.lng,"number","msg::GeoMessage"),k.verifyParamType("geo.lat",L.geo.lat,"number","msg::GeoMessage"),k.verifyParamType("geo.title",L.geo.title,"string","msg::GeoMessage"),i.call(this,L),this.attach=n(L.geo)}$.prototype=g(i.prototype),$.reverse=function(L){var V=y(i).call(i,L);return L.attach=L.attach?""+L.attach:"",V.geo=L.attach?JSON.parse(L.attach):{},V},t.exports=$},function(t,r,e){var n=e(18),g=e(10),y=e(9),i=e(121),k=e(0).notundef,$=e(76),L=e(149).IM,V=e(194),z=e(204),re={0:"addTeamMembers",1:"removeTeamMembers",2:"leaveTeam",3:"updateTeam",4:"dismissTeam",5:"passTeamApply",6:"transferTeam",7:"addTeamManagers",8:"removeTeamManagers",9:"acceptTeamInvite",10:"updateTeamMute",101:"netcallMiss",102:"netcallBill",103:"netcallReject",401:"addSuperTeamMembers",402:"removeSuperTeamMembers",403:"leaveSuperTeam",404:"updateSuperTeam",405:"dismissSuperTeam",406:"transferSuperTeam",407:"addSuperTeamManagers",408:"removeSuperTeamManagers",409:"updateSuperTeamMembersMute",410:"passSuperTeamApply",411:"acceptSuperTeamInvite"};function ie(){}ie.prototype=n($.prototype),ie.reverse=function(ue){var le=g($).call($,ue);if(ue.attach=ue.attach?""+ue.attach:"",ue.attach){var oe=JSON.parse(ue.attach);if(le.attach={type:re[oe.id]||oe.id},k(oe.data)){var ae,qe,de=oe.data;k(de.tinfo)&&(le.attach.team=g(V).call(V,L.syncUnserialize(de.tinfo,"team"),!0)),k(de.ids)&&(le.attach.accounts=de.ids),k(de.id)&&(le.attach.account=de.id),k(de.uinfos)&&(le.attach.users=y(ae=de.uinfos).call(ae,function(Ne){return g(z).call(z,L.syncUnserialize(Ne,"user"))})),k(de.mute)&&(le.attach.mute=+de.mute==1),k(de.attach)&&(le.attach.custom=de.attach),k(de.channel)&&(le.attach.channelId=de.channel),k(de.calltype)&&(le.attach.netcallType=de.calltype),k(de.duration)&&(le.attach.duration=de.duration),k(de.time)&&(le.attach.time=de.time),k(de.from)&&(le.attach.from=de.from),k(de.ext)&&(le.attach.ext=de.ext),le.attach.accounts&&le.attach.accounts.length<=2&&le.from===le.to&&i(qe=le.attach.accounts).call(qe,function(Ne){if(Ne!==le.to)return le.to=Ne,!0})}}else le.attach={};return le},t.exports=ie},function(t,r,e){var n=e(18),g=e(10),y=e(76),i=e(0);function k($){i.verifyOptions($,"content","msg::CustomMessage"),$.type="custom",y.call(this,$),this.attach=$.content}k.prototype=n(y.prototype),k.reverse=function($){var L=g(y).call(y,$);return L.content=$.attach,L},t.exports=k},function(t,r,e){var n=e(18),g=e(10),y=e(76),i=e(0);function k($){i.verifyOptions($,"tip","msg::TipMessage"),$.type="tip",y.call(this,$),this.body=$.tip}k.prototype=n(y.prototype),k.reverse=function($){var L=g(y).call(y,$);return L.text="",L.tip=$.body,$.attach&&(L.attach=$.attach),L},t.exports=k},function(t,r,e){var n=e(8),g=e(18),y=e(10),i=e(9),k=e(76),$=e(0),L={welcome:"00",text:"01",link:"03"},V={"01":"text","02":"image","03":"answer",11:"template"};function z(re){$.verifyOptions(re,"content","msg::RobotMessage"),$.undef(re.robotAccid)&&(re.robotAccid=re.to);var ie=re.content;switch(ie.type){case"welcome":$.undef(re.body)&&(this.body="欢迎消息");break;case"text":$.verifyOptions(ie,"content","msg::RobotMessage"),$.undef(re.body)&&(this.body=ie.content);break;case"link":$.verifyOptions(ie,"target","msg::RobotMessage")}ie.type&&(ie.type=L[ie.type]),ie={param:ie,robotAccid:re.robotAccid},this.attach=n(ie),re.type="robot",k.call(this,re)}z.prototype=g(k.prototype),z.reverse=function(re){var ie=y(k).call(k,re);if(ie.type==="robot"){var ue=JSON.parse(re.attach);if(ue.param&&(ue.param.type=V[ue.param.type]||"unknown"),ue.robotMsg){var le=(ue=$.merge(ue,ue.robotMsg)).message;ue.flag==="bot"?ue.message=i(le).call(le,function(oe){return oe.type=V[oe.type]||"unknown",oe}):ue.flag,delete ue.robotMsg}ie.content=ue}return ie},t.exports=z},function(t,r,e){var n=e(8),g=e(18),y=e(10),i=e(76),k=e(0);function $(L){k.verifyOptions(L,"attach","msg::G2Message"),L.type="g2",i.call(this,L),this.attach=n(L.attach)}$.prototype=g(i.prototype),$.reverse=function(L){var V=y(i).call(i,L);return L.attach&&(V.attach=JSON.parse(L.attach)),V},t.exports=$},function(t,r,e){var n=e(51),g=e(57),y=e(22),i=e(58),k=e(9),$=e(16),L=e(7),V=e(3),z=e(2),re=e(37),ie=e(4),ue=e(52),le=e(53),oe=e(54),ae=e(55),qe=e(43);function de(Et,ir){var dr=ie(Et);if(ue){var Dt=ue(Et);ir&&(Dt=$(Dt).call(Dt,function(lr){return le(Et,lr).enumerable})),dr.push.apply(dr,Dt)}return dr}function Ne(Et){for(var ir=1;ir<arguments.length;ir++){var dr,Dt,lr=arguments[ir]!=null?arguments[ir]:{};ir%2?z(dr=de(Object(lr),!0)).call(dr,function(sr){n(Et,sr,lr[sr])}):oe?ae(Et,oe(lr)):z(Dt=de(Object(lr))).call(Dt,function(sr){qe(Et,sr,le(lr,sr))})}return Et}var ze=e(40).fn,$e=e(0),Lt=$e.isArray,jt=e(152);ze.mergeObjArray=function(Et,ir,dr){return Et||(Et=[]),ir?(Lt(ir)||(ir=[ir]),ir.length?(dr=dr||{},$e.mergeObjArray(Et,ir,dr)):Et):Et},ze.cutObjArray=function(Et,ir,dr){return Et&&ir?(Lt(ir)||(ir=[ir]),ir.length?(dr=dr||{},$e.cutObjArray(Et,ir,dr)):Et):Et},ze.mergeLoginPorts=function(Et,ir){return this.mergeObjArray(Et,ir,{keyPath:"deviceId"})},ze.cutLoginPorts=function(Et,ir){return this.cutObjArray(Et,ir,{keyPath:"deviceId",sortPath:"type"})},ze.mergeRelations=function(Et,ir){return this.mergeObjArray(Et,ir,{keyPath:"account"})},ze.cutRelations=function(Et,ir){return this.cutObjArray(Et,ir,{keyPath:"account"})},ze.findRelation=function(Et,ir){return $e.findObjInArray(Et,{keyPath:"account",value:ir})},ze.mergeFriends=function(Et,ir){return this.mergeObjArray(Et,ir,{keyPath:"account"})},ze.cutFriends=function(Et,ir){return this.cutObjArray(Et,ir,{keyPath:"account"})},ze.cutFriendsByAccounts=function(Et,ir){Lt(ir)||(ir=[ir]);var dr=k(ir).call(ir,function(Dt){return{account:Dt}});return this.cutFriends(Et,dr)},ze.findFriend=function(Et,ir){return $e.findObjInArray(Et,{keyPath:"account",value:ir})},ze.mergeUsers=function(Et,ir){return this.mergeObjArray(Et,ir,{keyPath:"account"})},ze.findUser=function(Et,ir){return $e.findObjInArray(Et,{keyPath:"account",value:ir})},ze.mergeTeams=function(Et,ir){return this.mergeObjArray(Et,ir,{keyPath:"teamId"})},ze.cutTeams=function(Et,ir){return this.cutObjArray(Et,ir,{keyPath:"teamId"})},ze.findTeam=function(Et,ir){return $e.findObjInArray(Et,{keyPath:"teamId",value:ir})},ze.assembleTeamOwner=jt.assembleOwner,ze.assembleTeamMembers=jt.assembleMembers,ze.genTeamMemberId=jt.genId,ze.mergeTeamMembers=function(Et,ir){return this.mergeObjArray(Et,ir)},ze.cutTeamMembers=function(Et,ir){return this.cutObjArray(Et,ir)},ze.cutTeamMembersByAccounts=function(Et,ir,dr){Lt(dr)||(dr=[dr]);var Dt=jt.assembleMembers({teamId:ir},dr);return this.cutTeamMembers(Et,Dt)},ze.findTeamMember=function(Et,ir){return $e.findObjInArray(Et,{keyPath:"id",value:ir})},ze.mergeSessions=function(Et,ir){return this.mergeObjArray(Et,ir,{sortPath:"updateTime",desc:!0})},ze.cutSessions=function(Et,ir){return this.cutObjArray(Et,ir)},ze.cutSessionsByIds=function(Et,ir){Lt(ir)||(ir=[ir]);var dr=k(ir).call(ir,function(Dt){return{id:Dt}});return this.cutSessions(Et,dr)},ze.findSession=function(Et,ir){return $e.findObjInArray(Et,{keyPath:"id",value:ir})},ze.mergeMsgs=function(Et,ir){return this.mergeObjArray(Et,ir,{keyPath:"idClient",sortPath:"time"})},ze.cutMsgs=function(Et,ir){return this.cutObjArray(Et,ir,{keyPath:"idClient"})},ze.cutMsgsByIdClients=function(Et,ir){Lt(ir)||(ir=[ir]);var dr=k(ir).call(ir,function(Dt){return{idClient:Dt}});return this.cutMsgs(Et,dr)},ze.findMsg=function(Et,ir){return $e.findObjInArray(Et,{keyPath:"idClient",value:ir})},ze.mergeSysMsgs=function(Et,ir){return this.mergeObjArray(Et,ir,{keyPath:"idServer",desc:!0})},ze.cutSysMsgs=function(Et,ir){return this.cutObjArray(Et,ir,{keyPath:"idServer"})},ze.cutSysMsgsByIdServers=function(Et,ir){Lt(ir)||(ir=[ir]);var dr=k(ir).call(ir,function(Dt){return{idServer:Dt}});return this.cutSysMsgs(Et,dr)},ze.findSysMsg=function(Et,ir){return $e.findObjInArray(Et,{keyPath:"idServer",value:ir})},ze.searchLocal=function(Et){if($e.verifyOptions(Et,"keyword","searchLocal"),this.db.enable){var ir,dr=this,Dt=this.db,lr=Et.keyword+"",sr=["account","nick","alias"],er=["id","scene","lastMsg.type","lastMsg.text","localCustom","target.account","target.nick","target.alias","target.name"],cr="",or=Et.keyPath;switch(or?(cr=(or=(or+"").split(".")).shift(),or=or.join(".")):cr="all",cr){case"user":or&&(sr=$(sr).call(sr,function(Ir){return Ir===or||L(Ir).call(Ir,or+".")===0})),Sr(sr).then(function(Ir){Et.done(null,{sessions:[],users:Ir})});break;case"session":or&&(er=$(er).call(er,function(Ir){return Ir===or||L(Ir).call(Ir,or+".")===0})),hr(er,!or||L(or).call(or,"target")>-1).then(function(Ir){Et.done(null,{sessions:Ir,users:[]})});break;case"all":Pr().then(function(){V.all([hr(er,!0),Sr(sr)]).then(function(Ir){Et.done(null,{sessions:Ir[0],users:Ir[1]})})});break;default:Et.done(null,{sessions:[],users:[],msg:'keyPath must start with "user" or "session"'})}}else Et.done(null,{sessions:[],users:[],msg:"no db"});function hr(Ir,xr){return pr.apply(this,arguments)}function pr(){return(pr=i(g.mark(function Ir(xr,vr){var _r;return g.wrap(function(Or){for(;;)switch(Or.prev=Or.next){case 0:return _r=vr?[Dt.getSessions(),Pr(),Dt.getTeams(),Dt.getSuperTeams()]:[Dt.getSessions()],Or.abrupt("return",V.all(_r).then(function(Mr){var yr,mr=Mr[0]||[],Tr={p2p:Mr[1]||[],team:Mr[2]||[],superTeam:Mr[3]||[]},Br={};return vr&&(z(yr=ie(Tr)).call(yr,function($r){var Lr;z(Lr=Tr[$r]).call(Lr,function(Gr){var qr=Gr.teamId||Gr.account;Br[$r+"-"+qr]=Gr})}),z(mr).call(mr,function($r){$r.target=Br[$r.id]})),rr(xr,mr)}));case 2:case"end":return Or.stop()}},Ir)}))).apply(this,arguments)}function Sr(Ir){return Er.apply(this,arguments)}function Er(){return(Er=i(g.mark(function Ir(xr){var vr;return g.wrap(function(_r){for(;;)switch(_r.prev=_r.next){case 0:return _r.next=2,Pr();case 2:return vr=_r.sent,_r.abrupt("return",rr(xr,vr));case 4:case"end":return _r.stop()}},Ir)}))).apply(this,arguments)}function Pr(){return Cr.apply(this,arguments)}function Cr(){return(Cr=i(g.mark(function Ir(){var xr,vr;return g.wrap(function(_r){for(;;)switch(_r.prev=_r.next){case 0:if(!ir){_r.next=2;break}return _r.abrupt("return",ir);case 2:return _r.next=4,dr.db.getFriends();case 4:if(_r.t0=_r.sent,_r.t0){_r.next=7;break}_r.t0=[];case 7:return xr=_r.t0,vr=dr.protocol.userSet||{},ir=k(xr).call(xr,function(Or){return Ne(Ne({},Or),vr[Or.account])}),_r.abrupt("return",ir);case 11:case"end":return _r.stop()}},Ir)}))).apply(this,arguments)}function rr(Ir,xr){var vr=[];return z(xr).call(xr,function(_r){for(var Or=0;Or<Ir.length;Or++){var Mr=kr(_r,Ir[Or].split("."));if(Mr&&L(Mr).call(Mr,lr)>-1){vr.push(re({},_r));break}}}),vr}function kr(Ir,xr){if(y(Ir)==="object"&&Ir)return xr.length===1?Ir[xr[0]]:kr(Ir[xr.shift()],xr)}}},function(t,r,e){var n=e(15),g=e(40).fn,y=e(0),i=e(25).reportAPI;g.kick=function(k){var $;(k=k||{}).done=i({instance:this,className:"NIMFn",funcName:"kick",done:k.done}),y.verifyOptions(k,"deviceIds","link::kick"),this.processCallback(k),this.sendCmd("kick",{deviceIds:n($=k.deviceIds).call($,0)},k.callback)},g.disconnect=function(k){(k=k||{}).done=i({instance:this,className:"NIMFn",funcName:"disconnect",done:k.done}),k=k||{},this.protocol.disconnect(k.done)}},function(t,r,e){var n=e(40).fn,g=e(0),y=e(25).reportAPI;n.markInBlacklist=function(i){(i=i||{}).done=y({instance:this,className:"NIMFn",funcName:"markInBlacklist",done:i.done}),g.verifyOptions(i,"account isAdd","relation::markInBlacklist"),g.verifyParamType("isAdd",i.isAdd,"boolean","relation::markInBlacklist"),this.processCallback(i),this.sendCmd("markInBlacklist",{account:i.account,isAdd:i.isAdd},i.callback)},n.addToBlacklist=function(i){return(i=i||{}).done=y({instance:this,className:"NIMFn",funcName:"addToBlacklist",done:i.done}),i.isAdd=!0,this.markInBlacklist(i)},n.removeFromBlacklist=function(i){return(i=i||{}).done=y({instance:this,className:"NIMFn",funcName:"removeFromBlacklist",done:i.done}),i.isAdd=!1,this.markInBlacklist(i)},n.markInMutelist=function(i){(i=i||{}).done=y({instance:this,className:"NIMFn",funcName:"markInMutelist",done:i.done}),g.verifyOptions(i,"account","relation::markInMutelist"),g.verifyParamType("isAdd",i.isAdd,"boolean","relation::markInMutelist"),this.processCallback(i),this.sendCmd("markInMutelist",{account:i.account,isAdd:i.isAdd},i.callback)},n.addToMutelist=function(i){return(i=i||{}).done=y({instance:this,className:"NIMFn",funcName:"addToMutelist",done:i.done}),i.isAdd=!0,this.markInMutelist(i)},n.removeFromMutelist=function(i){return(i=i||{}).done=y({instance:this,className:"NIMFn",funcName:"removeFromMutelist",done:i.done}),i.isAdd=!1,this.markInMutelist(i)},n.getRelations=function(i){(i=i||{}).done=y({instance:this,className:"NIMFn",funcName:"getRelations",done:i.done});var k=this,$=k.db,L=0;function V(){k.sendCmd("getRelations",{timetag:L,NOTSTORE:"timetag"},i.callback)}i=g.verifyOptions(i),k.processCallback(i),$.enable?$.getRelationsTimetag().then(function(z){L=z,V()},V):V()}},function(t,r,e){var n=e(57),g=e(58),y=e(6),i=e(2),k=e(7),$=e(40).fn,L=e(0),V=L.objs2accounts,z=e(204),re=e(25).reportAPI;$.updateMyInfo=function(ie){(ie=ie||{}).done=re({instance:this,className:"NIMFn",funcName:"updateMyInfo",done:ie.done}),L.verifyOptions(ie),this.processCallback(ie),ie.user=new z(ie),delete ie.user.account,this.sendCmd("updateMyInfo",{user:ie.user,antispamTag:{antiSpamBusinessId:ie.antiSpamBusinessId},single:!0},ie.callback)},$.getMyInfo=function(ie){return(ie=ie||{}).done=re({instance:this,className:"NIMFn",funcName:"getMyInfo",done:ie.done}),(ie=ie||{}).account=this.account,this.getUser(ie)},$.getUser=function(ie){(ie=ie||{}).done=re({instance:this,className:"NIMFn",funcName:"getUser",done:ie.done});var ue,le=this,oe=le.db;function ae(){le.sendCmd("getUsers",{accounts:[ue],single:!0},ie.callback)}L.verifyOptions(ie,"account","user::getUser"),le.processCallback(ie),ie.cbaop=function(qe,de){if(!qe)return de=de[0]||null,le.logger.info("api::getUser: cbaop ".concat(ue)),de},ue=ie.account,ie.sync?ae():oe.enable?oe.getUser(ue).then(function(qe){qe?ie.done(null,qe):ae()},ae):ae()},$.getUsers=function(ie){(ie=ie||{}).done=re({instance:this,className:"NIMFn",funcName:"getUsers",done:ie.done});var ue,le=this,oe=le.db,ae=[];function qe(){le.sendCmd("getUsers",{accounts:ue,single:!0},ie.callback)}L.verifyOptions(ie,"accounts","user::getUsers"),L.verifyParamType("accounts",ie.accounts,"array","user::getUsers"),le.processCallback(ie),ie.cbaop=function(de,Ne){if(!de)return Ne=y(Ne).call(Ne,ae),le.logger.info("api::getUsers: cbaop ".concat(ue)),Ne},ue=L.deduplicate(ie.accounts),L.verifyArrayMax("accounts",ie.accounts,150,"user::getUsers"),ie.sync?qe():oe.enable?oe.getUsers({accountIds:ue}).then(function(de){if(de&&de.length===ue.length)ie.done(null,de);else{ae=de;var Ne=V(de),ze=[];i(ue).call(ue,function($e){k(Ne).call(Ne,$e)===-1&&ze.push($e)}),ue=ze,qe()}},qe):qe()},$.getUsersFromDB=function(){var ie=g(n.mark(function ue(le){var oe,ae,qe;return n.wrap(function(de){for(;;)switch(de.prev=de.next){case 0:return ae=(oe=this).db,(le=le||{}).done=re({instance:this,className:"NIMFn",funcName:"getUsersFromDB",done:le.done}),L.validate({accountIds:{type:"array",required:!1}},le,"user::getUsersFromDB"),oe.processCallback(le),de.next=8,ae.getUsers(le);case 8:return qe=de.sent,le.callback(null,qe),de.abrupt("return",qe);case 11:case"end":return de.stop()}},ue,this)}));return function(ue){return ie.apply(this,arguments)}}()},function(t,r,e){var n=e(57),g=e(58),y=e(122),i=e(40).fn,k=e(0),$=k.notundef,L=e(755),V=e(25).reportAPI;i.friendRequest=function(z){(z=z||{}).done=V({instance:this,className:"NIMFn",funcName:"friendRequest",done:z.done}),k.verifyOptions(z,"type account","friend::friendRequest"),k.verifyParamValid("type",z.type,L.validTypes(),"friend::friendRequest"),this.processPs(z),this.processCallback(z);var re={account:z.account,type:L.getByteFromType(z.type),ps:z.ps};$(z.idServer)&&(re.idServer=z.idServer),this.sendCmd("friendRequest",re,z.callback)},i.addFriend=function(z){(z=z||{}).done=V({instance:this,className:"NIMFn",funcName:"addFriend",done:z.done}),z.type="addFriend",this.friendRequest(z)},i.applyFriend=function(z){(z=z||{}).done=V({instance:this,className:"NIMFn",funcName:"applyFriend",done:z.done}),z.type="applyFriend",this.friendRequest(z)},i.passFriendApply=function(z){(z=z||{}).done=V({instance:this,className:"NIMFn",funcName:"passFriendApply",done:z.done}),k.verifyOptions(z,"idServer","friend::passFriendApply"),z.type="passFriendApply",this.friendRequest(z)},i.rejectFriendApply=function(z){(z=z||{}).done=V({instance:this,className:"NIMFn",funcName:"rejectFriendApply",done:z.done}),k.verifyOptions(z,"idServer","friend::rejectFriendApply"),z.type="rejectFriendApply",this.friendRequest(z)},i.deleteFriend=function(z){(z=z||{}).done=V({instance:this,className:"NIMFn",funcName:"deleteFriend",done:z.done}),k.verifyOptions(z,"account","friend::deleteFriend");var re=z.delAlias===!0;this.processCallback(z),this.sendCmd("deleteFriend",{account:z.account,delFriendParams:{delAlias:re?1:0}},z.callback)},i.updateFriend=function(z){(z=z||{}).done=V({instance:this,className:"NIMFn",funcName:"updateFriend",done:z.done}),this.processCallback(z);var re=new L(z);this.sendCmd("updateFriend",{friend:re,single:!0},z.callback)},i.getFriends=function(z){(z=z||{}).done=V({instance:this,className:"NIMFn",funcName:"getFriends",done:z.done});var re=this.db;k.validate({timetag:{type:"number",required:!1}},z,"friend::getFriends"),this.processCallback(z),re.enable?re.getFriends({updateTime:z.updateTime||0}).then(function(ie){(ie=y(ie).call(ie,function(ue,le){return ue.updateTime-le.updateTime})).invalid=[],z.done(null,ie)}):this.sendCmd("getFriends",{timetag:z.updateTime||0,NOTSTORE:"timetag"},z.callback)},i.getFriendsFromDB=function(){var z=g(n.mark(function re(ie){var ue,le,oe;return n.wrap(function(ae){for(;;)switch(ae.prev=ae.next){case 0:return le=(ue=this).db,(ie=ie||{}).done=V({instance:this,className:"NIMFn",funcName:"getFriendsFromDB",done:ie.done}),k.validate({accountIds:{type:"array",required:!1}},ie,"friend::getFriendsFromDB"),ue.processCallback(ie),ae.next=8,le.getFriends(ie);case 8:return oe=ae.sent,ie.callback(null,oe),ae.abrupt("return",oe);case 11:case"end":return ae.stop()}},re,this)}));return function(re){return z.apply(this,arguments)}}(),i.isMyFriend=function(z){(z=z||{}).done=V({instance:this,className:"NIMFn",funcName:"isMyFriend",done:z.done});var re=this.db;k.validate({account:{type:"string",allowEmpty:!1,require:!0}},z),this.processCallback(z),re.enable||z.done(null,!1),re.getFriend(z.account).then(function(ie){ie&&ie.valid===!0?z.done(null,!0):z.done(null,!1)})},i.isUserInBlackList=function(z){(z=z||{}).done=V({instance:this,className:"NIMFn",funcName:"isUserInBlackList",done:z.done});var re=this.db;k.validate({account:{type:"string",allowEmpty:!1,require:!0}},z),this.processCallback(z),re.enable||z.done(null,!1),re.getUserFromBlackList(z.account).then(function(ie){ie&&ie.account?z.done(null,!0):z.done(null,!1)})}},function(t,r,e){var n=e(40).fn,g=e(25).reportAPI;n.getRobots=function(y){(y=y||{}).done=g({instance:this,className:"NIMFn",funcName:"getRobots",done:y.done}),this.logger.warn("this api will be abandon"),(y=y||{}).type="getRobots",this.processCallback(y),this.sendCmd("sync",{sync:{robots:0}},y.callback)}},function(t,r,e){var n=e(57),g=e(58),y=e(15),i=e(9),k=e(16),$=e(3),L=e(8),V=e(40).fn,z=e(0),re=z.undef,ie=e(194),ue=e(152),le=e(25).reportAPI;V.createTeam=function(oe){var ae;(oe=oe||{}).done=le({instance:this,className:"NIMFn",funcName:"createTeam",done:oe.done}),z.verifyOptions(oe,"type name","team::createTeam"),re(oe.accounts)?oe.accounts=[]:z.verifyParamType("accounts",oe.accounts,"array","team::createTeam"),oe.action="create",this.processPs(oe),this.processCallback(oe),oe.team=new ie(oe);var qe={team:oe.team,accounts:y(ae=oe.accounts).call(ae,0),ps:oe.ps,antispamTag:{antiSpamBusinessId:oe.antiSpamBusinessId}};this.sendCmd("createTeam",qe,oe.callback)},V.updateTeam=function(oe){(oe=oe||{}).done=le({instance:this,className:"NIMFn",funcName:"updateTeam",done:oe.done}),z.verifyOptions(oe,"teamId","team::updateTeam"),oe.action="update",this.processCallback(oe),oe.team=new ie(oe),this.sendCmd("updateTeam",{team:oe.team,antispamTag:{antiSpamBusinessId:oe.antiSpamBusinessId},single:!0},oe.callback)},V.addTeamMembers=function(oe){var ae;(oe=oe||{}).done=le({instance:this,className:"NIMFn",funcName:"addTeamMembers",done:oe.done}),z.verifyOptions(oe,"teamId accounts","team::addTeamMembers"),z.verifyParamType("accounts",oe.accounts,"array","team::addTeamMembers"),this.processPs(oe),z.notexist(oe.custom)&&(oe.custom=""),this.processCallback(oe);var qe={teamId:oe.teamId,accounts:y(ae=oe.accounts).call(ae,0),ps:oe.ps,attach:oe.custom};this.sendCmd("addTeamMembers",qe,oe.callback)},V.removeTeamMembers=function(oe){var ae;(oe=oe||{}).done=le({instance:this,className:"NIMFn",funcName:"removeTeamMembers",done:oe.done}),z.verifyOptions(oe,"teamId accounts","team::removeTeamMembers"),z.verifyParamType("accounts",oe.accounts,"array","team::removeTeamMembers"),this.processCallback(oe);var qe={teamId:oe.teamId,accounts:y(ae=oe.accounts).call(ae,0)};this.sendCmd("removeTeamMembers",qe,oe.callback)},V.acceptTeamInvite=function(oe){(oe=oe||{}).done=le({instance:this,className:"NIMFn",funcName:"acceptTeamInvite",done:oe.done}),z.verifyOptions(oe,"idServer teamId from","team::acceptTeamInvite"),this.processCallback(oe);var ae={idServer:oe.idServer,teamId:oe.teamId,from:oe.from,type:"teamInvite"};this.sendCmd("acceptTeamInvite",ae,oe.callback)},V.rejectTeamInvite=function(oe){(oe=oe||{}).done=le({instance:this,className:"NIMFn",funcName:"rejectTeamInvite",done:oe.done}),z.verifyOptions(oe,"idServer teamId from","team::rejectTeamInvite"),this.processPs(oe),this.processCallback(oe);var ae={idServer:oe.idServer,teamId:oe.teamId,from:oe.from,ps:oe.ps,type:"teamInvite"};this.sendCmd("rejectTeamInvite",ae,oe.callback)},V.applyTeam=function(oe){(oe=oe||{}).done=le({instance:this,className:"NIMFn",funcName:"applyTeam",done:oe.done}),z.verifyOptions(oe,"teamId","team::applyTeam"),this.processPs(oe),this.processCallback(oe);var ae={teamId:oe.teamId,ps:oe.ps};this.sendCmd("applyTeam",ae,oe.callback)},V.passTeamApply=function(oe){(oe=oe||{}).done=le({instance:this,className:"NIMFn",funcName:"passTeamApply",done:oe.done}),z.verifyOptions(oe,"idServer teamId from","team::passTeamApply"),this.processCallback(oe);var ae={idServer:oe.idServer,teamId:oe.teamId,from:oe.from,type:"applyTeam"};this.sendCmd("passTeamApply",ae,oe.callback)},V.rejectTeamApply=function(oe){(oe=oe||{}).done=le({instance:this,className:"NIMFn",funcName:"rejectTeamApply",done:oe.done}),z.verifyOptions(oe,"idServer teamId from","team::rejectTeamApply"),this.processPs(oe),this.processCallback(oe);var ae={idServer:oe.idServer,teamId:oe.teamId,from:oe.from,ps:oe.ps,type:"applyTeam"};this.sendCmd("rejectTeamApply",ae,oe.callback)},V.addTeamManagers=function(oe){var ae;(oe=oe||{}).done=le({instance:this,className:"NIMFn",funcName:"addTeamManagers",done:oe.done}),z.verifyOptions(oe,"teamId accounts","team::addTeamManagers"),z.verifyParamType("accounts",oe.accounts,"array","team::addTeamManagers"),this.processCallback(oe);var qe={teamId:oe.teamId,accounts:y(ae=oe.accounts).call(ae,0)};this.sendCmd("addTeamManagers",qe,oe.callback)},V.removeTeamManagers=function(oe){var ae;(oe=oe||{}).done=le({instance:this,className:"NIMFn",funcName:"removeTeamManagers",done:oe.done}),z.verifyOptions(oe,"teamId accounts","team::removeTeamManagers"),z.verifyParamType("accounts",oe.accounts,"array","team::removeTeamManagers"),this.processCallback(oe);var qe={teamId:oe.teamId,accounts:y(ae=oe.accounts).call(ae,0)};this.sendCmd("removeTeamManagers",qe,oe.callback)},V.updateInfoInTeam=function(oe){(oe=oe||{}).done=le({instance:this,className:"NIMFn",funcName:"updateInfoInTeam",done:oe.done}),z.verifyOptions(oe,"teamId","team::updateInfoInTeam"),this.processCallback(oe),this.sendCmd("updateInfoInTeam",{teamMember:new ue(oe),single:!0},oe.callback)},V.updateNickInTeam=function(oe){(oe=oe||{}).done=le({instance:this,className:"NIMFn",funcName:"updateNickInTeam",done:oe.done}),z.verifyOptions(oe,"teamId account","team::updateNickInTeam"),this.processCallback(oe),this.sendCmd("updateNickInTeam",{teamMember:new ue(oe),single:!0},oe.callback)},V.updateMuteStateInTeam=function(oe){(oe=oe||{}).done=le({instance:this,className:"NIMFn",funcName:"updateMuteStateInTeam",done:oe.done}),z.verifyOptions(oe,"teamId account mute","team::updateMuteStateInTeam"),this.processCallback(oe),oe.mute=oe.mute?1:0,this.sendCmd("updateMuteStateInTeam",oe)},V.getMutedTeamMembers=function(oe){(oe=oe||{}).done=le({instance:this,className:"NIMFn",funcName:"getMutedTeamMembers",done:oe.done}),z.verifyOptions(oe,"teamId","team::getMutedTeamMembers"),this.processCallback(oe),this.sendCmd("getMutedTeamMembers",oe)},V.leaveTeam=function(oe){(oe=oe||{}).done=le({instance:this,className:"NIMFn",funcName:"leaveTeam",done:oe.done}),z.verifyOptions(oe,"teamId","team::leaveTeam"),this.processCallback(oe);var ae={teamId:oe.teamId};this.sendCmd("leaveTeam",ae,oe.callback)},V.transferTeam=function(oe){(oe=oe||{}).done=le({instance:this,className:"NIMFn",funcName:"transferTeam",done:oe.done}),z.verifyOptions(oe,"teamId account leave","team::transferTeam"),z.verifyParamType("leave",oe.leave,"boolean","team::transferTeam"),this.processCallback(oe);var ae={teamId:oe.teamId,account:oe.account,leave:oe.leave};this.sendCmd("transferTeam",ae,oe.callback)},V.dismissTeam=function(oe){(oe=oe||{}).done=le({instance:this,className:"NIMFn",funcName:"dismissTeam",done:oe.done}),z.verifyOptions(oe,"teamId","team::dismissTeam"),this.processCallback(oe);var ae={teamId:oe.teamId};this.sendCmd("dismissTeam",ae,oe.callback)},V.getTeam=function(oe){(oe=oe||{}).done=le({instance:this,className:"NIMFn",funcName:"getTeam",done:oe.done});var ae,qe=this,de=qe.db;function Ne(){qe.sendCmd("getTeam",{teamId:oe.teamId},oe.callback)}z.verifyOptions(oe,"teamId","team::getTeam"),qe.processCallback(oe),oe.cbaop=function(ze){ze||qe.logger.info("api::getTeam: cbaop ".concat(ae))},ae=oe.teamId,de.enable&&!oe.sync?de.getTeam(ae).then(function(ze){ze&&ze.validToCurrentUser?(qe.logger.log("api::getTeam: db.getTeam ".concat(ae)),oe.done(null,ze)):Ne()},Ne):Ne()},V.getTeams=function(oe){(oe=oe||{}).done=le({instance:this,className:"NIMFn",funcName:"getTeams",done:oe.done});var ae=this,qe=ae.db,de=0;function Ne(){ae.sendCmd("getTeams",{timetag:de,NOTSTORE:"timetag"},oe.callback)}z.verifyOptions(oe),ae.processCallback(oe),qe.enable?qe.getTeamsTimetag().then(function(ze){de=ze,Ne()},Ne):Ne()},V.getTeamsById=function(oe){(oe=oe||{}).done=le({instance:this,className:"NIMFn",funcName:"getTeamsById",done:oe.done}),z.verifyOptions(oe,"teamIds","teams::getTeamsById"),this.processCallback(oe),this.sendCmd("getTeamsById",{teamIds:oe.teamIds},oe.callback)},V.getTeamMembers=function(oe){(oe=oe||{}).done=le({instance:this,className:"NIMFn",funcName:"getTeamMembers",done:oe.done});var ae=this;z.verifyOptions(oe,"teamId","team::getTeamMembers"),ae.processCallback(oe),ae.sendCmd("getTeamMembers",{teamId:oe.teamId,timetag:0,NOTSTORE:"timetag"},oe.callback)},V.getTeamMemberByTeamIdAndAccount=function(oe){(oe=oe||{}).done=le({instance:this,className:"NIMFn",funcName:"getTeamMemberByTeamIdAndAccount",done:oe.done});var ae=this;z.verifyParamType("teamId",oe.teamId,"numeric or numeric string","team::getTeamMemberByTeamIdAndAccount"),z.verifyOptions(oe,"account","team::getTeamMemberByTeamIdAndAccount"),ae.processCallback(oe),ae.sendCmd("getTeamMembers",{teamId:oe.teamId,timetag:0,NOTSTORE:"timetag"},function(qe,de,Ne){var ze={};if(de&&de.members&&de.members.length){for(var $e=0;$e<de.members.length;$e++)if(de.members[$e].account===oe.account){ze[oe.account]=de.members[$e];break}}oe.callback(qe,ze,Ne)})},V.getTeamMemberInvitorAccid=function(oe){(oe=oe||{}).done=le({instance:this,className:"NIMFn",funcName:"getTeamMemberInvitorAccid",done:oe.done}),z.verifyParamType("teamId",oe.teamId,"numeric or numeric string","team::getTeamMemberInvitorAccid"),re(oe.accounts)||(z.verifyParamType("accounts",oe.accounts,"array","team::getTeamMemberInvitorAccid"),oe.accounts.length>200&&z.onParamError("accounts 参数数组长度不能超过200","team::getTeamMemberInvitorAccid"));var ae,qe={teamId:oe.teamId};oe.accounts.length&&(qe.accounts=y(ae=oe.accounts).call(ae,0)),this.processCallback(oe),this.sendCmd("getTeamMemberInvitorAccid",qe,function(de,Ne,ze){oe.callback(de,ze&&ze.accountsMap||{})})},V.notifyForNewTeamMsg=function(oe){(oe=oe||{}).done=le({instance:this,className:"NIMFn",funcName:"notifyForNewTeamMsg",done:oe.done}),z.verifyOptions(oe,"teamIds","team::notifyForNewTeamMsg"),this.protocol.notifyForNewTeamMsg(oe.teamIds).then(function(ae){oe.done(ae.error||null,i(ae),ae.miss)},function(ae){oe.done(ae)})},V.getMyTeamMembers=function(oe){le({instance:this,className:"NIMFn",funcName:"getMyTeamMembers",done:oe.done,hasCallback:!1});var ae=oe.done;z.verifyOptions(oe,"teamIds","team::getMyTeamMembers");var qe=this.processCallbackPromise(oe);return this.sendCmd("getMyTeamMembers",oe),qe.then(function(de){return typeof ae=="function"?ae(null,de):de}).catch(function(de){if(typeof ae=="function")return ae(de);throw de})},V.getLocalTeams=function(oe){(oe=oe||{}).done=le({instance:this,className:"NIMFn",funcName:"getLocalTeams",done:oe.done});var ae,qe=this.db,de=[];function Ne(){oe.teams=de,oe.done(ae,oe)}z.verifyOptions(oe,"teamIds","team::getLocalTeams"),z.verifyParamType("teamIds",oe.teamIds,"array","team::getLocalTeams"),this.processCallback(oe),qe.enable?qe.getTeamsByTeamIds(oe.teamIds).then(function(ze){de=k(ze).call(ze,function($e){return!!$e}),Ne()},function(ze){ae=ze,Ne()}):Ne()},V.getTeamsFromDB=function(){var oe=g(n.mark(function ae(qe){var de,Ne,ze;return n.wrap(function($e){for(;;)switch($e.prev=$e.next){case 0:return Ne=(de=this).db,(qe=qe||{}).done=le({instance:this,className:"NIMFn",funcName:"getTeamsFromDB",done:qe.done}),z.validate({teamIds:{type:"array",required:!1}},qe,"team::getTeamsFromDB"),de.processCallback(qe),$e.next=8,Ne.getTeams(qe);case 8:return ze=$e.sent,qe.callback(null,ze),$e.abrupt("return",ze);case 11:case"end":return $e.stop()}},ae,this)}));return function(ae){return oe.apply(this,arguments)}}(),V.getLocalTeamMembers=function(oe){(oe=oe||{}).done=le({instance:this,className:"NIMFn",funcName:"getLocalTeamMembers",done:oe.done});var ae,qe=this.db,de=[];function Ne(){oe.members=de,oe.done(ae,oe)}z.verifyOptions(oe,"teamId accounts","team::getLocalTeamMembers"),z.verifyParamType("accounts",oe.accounts,"array","team::getLocalTeamMembers"),this.processCallback(oe),qe.enable?qe.getInvalidTeamMembers(oe.teamId,oe.accounts).then(function(ze){de=k(ze).call(ze,function($e){return!!$e}),Ne()},function(ze){ae=ze,Ne()}):Ne()},V.getTeamMembersFromDB=function(){var oe=g(n.mark(function ae(qe){var de,Ne,ze;return n.wrap(function($e){for(;;)switch($e.prev=$e.next){case 0:return Ne=(de=this).db,(qe=qe||{}).done=le({instance:this,className:"NIMFn",funcName:"getTeamMembersFromDB",done:qe.done}),z.validate({teamIds:{type:"array",required:!1},accountIds:{type:"array",required:!1}},qe,"team::getTeamMembersFromDB"),de.processCallback(qe),$e.next=8,Ne.getTeamMembers(qe);case 8:return ze=$e.sent,qe.callback(null,ze),$e.abrupt("return",ze);case 11:case"end":return $e.stop()}},ae,this)}));return function(ae){return oe.apply(this,arguments)}}(),V.deleteLocalTeam=function(oe){(oe=oe||{}).done=le({instance:this,className:"NIMFn",funcName:"deleteLocalTeam",done:oe.done});var ae,qe=this.db;function de(){oe.done(ae,oe)}z.verifyOptions(oe,"teamId","team::deleteLocalTeam"),this.processCallback(oe),qe.enable?qe.deleteTeam(oe.teamId).then(function(){de()},function(Ne){ae=Ne,de()}):de()},V.muteTeamAll=function(oe){(oe=oe||{}).done=le({instance:this,className:"NIMFn",funcName:"muteTeamAll",done:oe.done}),z.verifyOptions(oe,"teamId mute","team::muteTeamAll"),oe.mute=oe.mute?1:0,this.processCallback(oe),this.sendCmd("muteTeamAll",oe)},V.sendTeamMsgReceipt=function(oe){(oe=oe||{}).done=le({instance:this,className:"NIMFn",funcName:"sendTeamMsgReceipt",done:oe.done}),z.verifyOptions(oe,"teamMsgReceipts","team::sendTeamMsgReceipt"),oe.teamMsgReceipts.length>50?this.logger.error("team::sendTeamMsgReceipt：teamMsgReceipts length over 50"):(this.processCallback(oe),this.sendCmd("sendTeamMsgReceipt",oe))},V.getTeamMsgReads=function(oe){(oe=oe||{}).done=le({instance:this,className:"NIMFn",funcName:"getTeamMsgReads",done:oe.done}),z.verifyOptions(oe,"teamMsgReceipts","team::getTeamMsgReads"),this.processCallback(oe),this.sendCmd("getTeamMsgReads",oe)},V.getTeamMsgReadAccounts=function(oe){var ae=this;(oe=oe||{}).done=le({instance:this,className:"NIMFn",funcName:"getTeamMsgReadAccounts",done:oe.done});var qe,de=this;z.verifyOptions(oe,"teamMsgReceipt","team::getTeamMsgReadAccounts"),oe.callback=function(Ne,ze,$e){Ne&&qe?(ze=ze||{teamMsgReceipt:oe.teamMsgReceipt},oe.done(Ne,ze,{teamMsgReceipt:oe.teamMsgReceipt,unreadAccounts:qe.unreadAccounts,readAccounts:qe.readAccounts})):oe.done(Ne,ze,$e)},this.db.enable&&oe.teamMsgReceipt.idClient?this.db.getMsgReadDetail(oe.teamMsgReceipt.idClient).then(function(Ne){if(qe=Ne,!Ne)return $.reject("no record");if(Ne.unreadAccounts&&Ne.unreadAccounts.length>0)return $.reject("unreadAccounts.length > 0");var ze={teamMsgReceipt:oe.teamMsgReceipt,unreadAccounts:Ne.unreadAccounts,readAccounts:Ne.readAccounts};de.logger.info("getTeamMsgReadAccounts from db"),oe.done(null,{teamMsgReceipt:oe.teamMsgReceipt},ze)}).catch(function(Ne){ae.logger.warn("db.getMsgReadDetail invalid",Ne),de.sendCmd("getTeamMsgReadAccounts",oe)}):de.sendCmd("getTeamMsgReadAccounts",oe)},V.addTeamMembersFollow=function(){var oe=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};z.validate({teamId:{type:"string",allowEmpty:!1,required:!0},accountIds:{type:"array",min:1,itemType:"string",required:!0}},oe),oe.done=le({instance:this,className:"NIMFn",funcName:"addTeamMembersFollow",done:oe.done}),this.processCallback(oe),this.sendCmd("updateInfoInTeam",{teamMember:{teamId:oe.teamId},teamSpecialFollowUpdateTag:{accountIds:L(oe.accountIds),type:1},single:!0},oe.callback)},V.removeTeamMembersFollow=function(oe){z.validate({teamId:{type:"string",allowEmpty:!1,required:!0},accountIds:{type:"array",min:1,itemType:"string",required:!0}},oe),oe.done=le({instance:this,className:"NIMFn",funcName:"removeTeamMembersFollow",done:oe.done}),this.processCallback(oe),this.sendCmd("updateInfoInTeam",{teamMember:{teamId:oe.teamId},teamSpecialFollowUpdateTag:{accountIds:L(oe.accountIds),type:0},single:!0},oe.callback)}},function(t,r,e){var n=e(759),g=e(3),y=e(10),i=e(26),k=e(15),$=e(9),L=e(2),V=e(6),z=e(8),re=e(40).fn,ie=e(0),ue=ie.undef,le=e(308),oe=e(203),ae=e(25).reportAPI;function qe(de){var Ne=this.db;if(!Ne.enable)return g.resolve({valid:!1});var ze=Ne.getSuperTeam(de),$e=Ne.getSuperTeamMembersTimetag(de);return g.all([ze,$e]).then(function(Lt){var jt=n(Lt,2),Et=jt[0],ir=jt[1],dr=Et&&Et.memberUpdateTime,Dt={timetag:ir=ir||0};return dr&&ir>=dr&&(Dt.valid=!0),g.resolve(Dt)}).catch(function(){return g.resolve({timetag:0})})}re.addSuperTeamMembers=function(de){(de=de||{}).done=ae({instance:this,className:"NIMFn",funcName:"addSuperTeamMembers",done:de.done}),ie.verifyOptions(de,"teamId accounts","superTeam::addSuperTeamMembers"),ie.verifyParamType("accounts",de.accounts,"array","superTeam::addSuperTeamMembers");var Ne=ie.deduplicate(de.accounts);this.processPs(de),this.processCallback(de);var ze={teamId:de.teamId,accounts:Ne,ps:de.ps};this.sendCmd("addSuperTeamMembers",ze,de.callback)},re.removeSuperTeamMembers=function(de){(de=de||{}).done=ae({instance:this,className:"NIMFn",funcName:"removeSuperTeamMembers",done:de.done}),ie.verifyOptions(de,"teamId accounts","team::removeSuperTeamMembers"),ie.verifyParamType("accounts",de.accounts,"array","team::removeSuperTeamMembers");var Ne=ie.deduplicate(de.accounts);this.processCallback(de);var ze={teamId:de.teamId,accounts:Ne};this.sendCmd("removeSuperTeamMembers",ze,de.callback)},re.leaveSuperTeam=function(de){(de=de||{}).done=ae({instance:this,className:"NIMFn",funcName:"leaveSuperTeam",done:de.done}),ie.verifyOptions(de,"teamId","superTeam::leaveSuperTeam"),this.processCallback(de);var Ne={teamId:de.teamId};this.sendCmd("leaveSuperTeam",Ne,de.callback)},re.getSuperTeam=function(de){(de=de||{}).done=ae({instance:this,className:"NIMFn",funcName:"getSuperTeam",done:de.done});var Ne,ze=this,$e=ze.db;function Lt(){ze.sendCmd("getSuperTeam",{teamId:de.teamId},de.callback)}ie.verifyOptions(de,"teamId","team::getSuperTeam"),ze.processCallback(de),de.cbaop=function(jt){jt||ze.logger.info("api::getSuperTeam: cbaop ".concat(Ne))},Ne=de.teamId,$e.enable&&!de.sync?$e.getSuperTeam(Ne).then(function(jt){jt&&jt.validToCurrentUser?(ze.logger.log("api::getSuperTeam: db.getSuperTeam ".concat(Ne)),de.done(null,jt)):Lt()}).catch(function(){Lt()}):Lt()},re.getSuperTeams=function(de){(de=de||{}).done=ae({instance:this,className:"NIMFn",funcName:"getSuperTeams",done:de.done});var Ne=this,ze=Ne.db,$e=0;function Lt(){Ne.sendCmd("getSuperTeams",{timetag:$e,NOTSTORE:"timetag"},de.callback)}ie.verifyOptions(de),Ne.processCallback(de),ze.enable?ze.getSuperTeamsTimetag().then(function(jt){$e=jt,Lt()},Lt):Lt()},re.updateSuperTeam=function(de){(de=de||{}).done=ae({instance:this,className:"NIMFn",funcName:"updateSuperTeam",done:de.done}),ie.verifyOptions(de,"teamId","superTeam::updateSuperTeam"),de.action="update",this.processCallback(de),de.team=new le(de),this.sendCmd("updateSuperTeam",{team:de.team,antispamTag:{antiSpamBusinessId:de.antiSpamBusinessId},single:!0},de.callback)},re.updateInfoInSuperTeam=function(de){(de=de||{}).done=ae({instance:this,className:"NIMFn",funcName:"updateInfoInSuperTeam",done:de.done}),ie.verifyOptions(de,"teamId","superTeam::updateInfoInSuperTeam"),this.processCallback(de),this.sendCmd("updateInfoInSuperTeam",{superTeamMember:new oe(de),single:!0},de.callback)},re.getSuperTeamMembersByJoinTime=function(de){(de=de||{}).done=ae({instance:this,className:"NIMFn",funcName:"getSuperTeamMembersByJoinTime",done:de.done});var Ne=this,ze=de,$e=ze.joinTime,Lt=y(ze),jt=ze.limit,Et=ze.teamId;Lt=!!Lt,ue($e)&&($e=0),ue(jt)&&(jt=100),ie.verifyOptions(de,"teamId","superTeam::getSuperTeamMembersByJoinTime"),ie.verifyParamType("joinTime",$e,"number","api::superTeam::getSuperTeamMembersByJoinTime"),ie.verifyParamType("limit",jt,"number","api::superTeam::getSuperTeamMembersByJoinTime"),Ne.processCallback(de),Ne.sendCmd("getSuperTeamMembersByJoinTime",{teamId:Et,limit:jt,joinTime:$e,reverse:Lt,timetag:0,NOTSTORE:"timetag"},de.callback)},re.getAllSuperTeamMembers=function(de){(de=de||{}).done=ae({instance:this,className:"NIMFn",funcName:"getAllSuperTeamMembers",done:de.done});var Ne=this,ze=this.db;function $e(Lt){Lt=Lt||0,Ne.sendCmd("getSuperTeamMembers",{teamId:de.teamId,timetag:Lt,NOTSTORE:"timetag"},de.callback)}ie.verifyOptions(de,"teamId","superTeam::getAllSuperTeamMembers"),Ne.processCallback(de),i(qe).call(qe,this)(de.teamId).then(function(Lt){var jt=Lt.valid,Et=Lt.timetag;jt?(Ne.logger.info("getAllSuperTeamMembers from local db"),ze.getSuperTeamMembers(de.teamId).then(function(ir){var dr={teamId:de.teamId,members:ir};de.done(null,dr)},function(){return $e()})):$e(Et)})},re.applySuperTeam=function(de){(de=de||{}).done=ae({instance:this,className:"NIMFn",funcName:"applySuperTeam",done:de.done}),ie.verifyOptions(de,"teamId","team::applySuperTeam"),ie.verifyOptions(de,"teamId","team::applySuperTeam"),this.processPs(de),this.processCallback(de);var Ne={teamId:de.teamId,ps:de.ps};this.sendCmd("applySuperTeam",Ne,de.callback)},re.passSuperTeamApply=function(de){(de=de||{}).done=ae({instance:this,className:"NIMFn",funcName:"passSuperTeamApply",done:de.done}),ie.verifyOptions(de,"idServer teamId from","team::passSuperTeamApply"),this.processCallback(de);var Ne={idServer:de.idServer,teamId:de.teamId,from:de.from};this.sendCmd("passSuperTeamApply",Ne,de.callback)},re.rejectSuperTeamApply=function(de){(de=de||{}).done=ae({instance:this,className:"NIMFn",funcName:"rejectSuperTeamApply",done:de.done}),ie.verifyOptions(de,"idServer teamId from","team::rejectSuperTeamApply"),this.processPs(de),this.processCallback(de);var Ne={idServer:de.idServer,teamId:de.teamId,from:de.from,ps:de.ps};this.sendCmd("rejectSuperTeamApply",Ne,de.callback)},re.acceptSuperTeamInvite=function(de){(de=de||{}).done=ae({instance:this,className:"NIMFn",funcName:"acceptSuperTeamInvite",done:de.done}),ie.verifyOptions(de,"idServer teamId from","team::acceptSuperTeamInvite"),this.processCallback(de);var Ne={idServer:de.idServer,teamId:de.teamId,from:de.from};this.sendCmd("acceptSuperTeamInvite",Ne,de.callback)},re.rejectSuperTeamInvite=function(de){(de=de||{}).done=ae({instance:this,className:"NIMFn",funcName:"rejectSuperTeamInvite",done:de.done}),ie.verifyOptions(de,"idServer teamId from","team::rejectSuperTeamInvite"),this.processPs(de),this.processCallback(de);var Ne={idServer:de.idServer,teamId:de.teamId,from:de.from,ps:de.ps};this.sendCmd("rejectSuperTeamInvite",Ne,de.callback)},re.addSuperTeamManagers=function(de){var Ne;(de=de||{}).done=ae({instance:this,className:"NIMFn",funcName:"addSuperTeamManagers",done:de.done}),ie.verifyOptions(de,"teamId accounts","team::addSuperTeamManagers"),ie.verifyParamType("accounts",de.accounts,"array","team::addSuperTeamManagers"),this.processCallback(de);var ze={teamId:de.teamId,accounts:k(Ne=de.accounts).call(Ne,0)};this.sendCmd("addSuperTeamManagers",ze,de.callback)},re.removeSuperTeamManagers=function(de){var Ne;(de=de||{}).done=ae({instance:this,className:"NIMFn",funcName:"removeSuperTeamManagers",done:de.done}),ie.verifyOptions(de,"teamId accounts","team::removeSuperTeamManagers"),ie.verifyParamType("accounts",de.accounts,"array","team::removeSuperTeamManagers"),this.processCallback(de);var ze={teamId:de.teamId,accounts:k(Ne=de.accounts).call(Ne,0)};this.sendCmd("removeSuperTeamManagers",ze,de.callback)},re.updateSuperTeamMembersMute=function(de){(de=de||{}).done=ae({instance:this,className:"NIMFn",funcName:"updateSuperTeamMembersMute",done:de.done}),ie.verifyOptions(de,"teamId accounts mute","team::updateSuperTeamMembersMute"),ie.verifyParamType("accounts",de.accounts,"array","team::updateSuperTeamMembersMute"),ie.verifyArrayMax("accounts",de.accounts,10),this.processCallback(de),de.mute=de.mute?1:0,this.sendCmd("updateSuperTeamMembersMute",de)},re.updateSuperTeamMute=function(de){(de=de||{}).done=ae({instance:this,className:"NIMFn",funcName:"updateSuperTeamMute",done:de.done}),ie.verifyOptions(de,"teamId mute","team::updateSuperTeamMute"),de.mute=de.mute?1:0,this.processCallback(de),this.sendCmd("updateSuperTeamMute",de)},re.updateNickInSuperTeam=function(de){(de=de||{}).done=ae({instance:this,className:"NIMFn",funcName:"updateNickInSuperTeam",done:de.done}),ie.verifyOptions(de,"teamId account","team::updateNickInSuperTeam"),this.processCallback(de),this.sendCmd("updateNickInSuperTeam",{superTeamMember:new oe(de),single:!0},de.callback)},re.transferSuperTeam=function(de){(de=de||{}).done=ae({instance:this,className:"NIMFn",funcName:"transferSuperTeam",done:de.done}),ie.verifyOptions(de,"teamId account leave","team::transferSuperTeam"),ie.verifyParamType("leave",de.leave,"boolean","team::transferSuperTeam"),this.processCallback(de);var Ne={teamId:de.teamId,account:de.account,leave:de.leave};this.sendCmd("transferSuperTeam",Ne,de.callback)},re.getSuperTeamMembersByAccounts=function(de){(de=de||{}).done=ae({instance:this,className:"NIMFn",funcName:"getSuperTeamMembersByAccounts",done:de.done});var Ne=this,ze=this.db,$e=de,Lt=$e.teamId,jt=$e.accounts;if(ie.verifyOptions(de,"teamId accounts","superTeam::getSuperTeamMembersByAccounts"),ie.verifyParamType("accounts",jt,"array","superTeam::getSuperTeamMembersByAccounts"),ie.verifyArrayMax("accounts",jt,20),jt.length<=0)return ie.onParamError("参数accounts不能为空数组","superTeam::getSuperTeamMembersByAccounts");function Et(){var ir=$(jt).call(jt,function(dr){return Lt+"|"+dr});Ne.processCallback(de),Ne.sendCmd("getSuperTeamMembersByAccounts",{memberIds:ir},function(dr,Dt){de.done(null,{accounts:jt,members:Dt.members,invaldAccounts:Dt.invalid})})}qe.call(this,Lt).then(function(ir){var dr,Dt,lr;return ir.valid?(dr=[],Dt=[],lr=[],L(jt).call(jt,function(sr){var er,cr=ze.getSuperTeamMemberById(V(er="".concat(Lt,"-")).call(er,sr)).then(function(or){Dt.push(or)}).catch(function(){lr.push(sr)});dr.push(cr)}),void g.all(dr).then(function(){de.done(null,{accounts:jt,members:Dt,invaldAccounts:lr})})):Et()}).catch(function(){return Et()})},re.getMutedSuperTeamMembers=function(de){(de=de||{}).done=ae({instance:this,className:"NIMFn",funcName:"getMutedSuperTeamMembers",done:de.done});var Ne=this,ze=de,$e=ze.joinTime,Lt=y(ze),jt=ze.limit,Et=ze.teamId;Lt=!!Lt,ue($e)&&($e=0),ue(jt)&&(jt=100),ie.verifyOptions(de,"teamId","superTeam::getSuperTeamMembersByJoinTime"),ie.verifyParamType("joinTime",$e,"number","api::superTeam::getSuperTeamMembersByJoinTime"),ie.verifyParamType("limit",jt,"number","api::superTeam::getSuperTeamMembersByJoinTime"),this.processCallback(de),Ne.sendCmd("getMutedSuperTeamMembers",{teamId:Et,limit:jt,joinTime:$e,reverse:Lt},de.callback)},re.addSuperTeamMembersFollow=function(){var de=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};ie.validate({teamId:{type:"string",allowEmpty:!1,required:!0},accountIds:{type:"array",min:1,itemType:"string",required:!0}},de),de.done=ae({instance:this,className:"NIMFn",funcName:"addSuperTeamMembersFollow",done:de.done}),this.processCallback(de),this.sendCmd("updateInfoInSuperTeam",{superTeamMember:{teamId:de.teamId},teamSpecialFollowUpdateTag:{accountIds:z(de.accountIds),type:1},single:!0},de.callback)},re.removeSuperTeamMembersFollow=function(de){ie.validate({teamId:{type:"string",allowEmpty:!1,required:!0},accountIds:{type:"array",min:1,itemType:"string",required:!0}},de),de.done=ae({instance:this,className:"NIMFn",funcName:"removeSuperTeamMembersFollow",done:de.done}),this.processCallback(de),this.sendCmd("updateInfoInSuperTeam",{superTeamMember:{teamId:de.teamId},teamSpecialFollowUpdateTag:{accountIds:z(de.accountIds),type:0},single:!0},de.callback)},re.getMySuperTeamMembers=function(de){ae({instance:this,className:"NIMFn",funcName:"getMySuperTeamMembers",done:de.done,hasCallback:!1}),this.processCallback(de),ie.verifyOptions(de,"teamIds","team::getMySuperTeamMembers"),this.sendCmd("getMySuperTeamMembers",de)}},function(t,r,e){var n=e(57),g=e(9),y=e(3),i=e(2),k=e(6),$=e(10),L=e(754),V=e(37),z=e(15),re=e(90),ie=e(32),ue=e(16),le=e(7),oe=e(88),ae=e(89),qe=e(72),de=e(58);function Ne(er,cr){var or=ae!==void 0&&qe(er)||er["@@iterator"];if(!or){if(ie(er)||(or=function(Cr,rr){var kr;if(Cr){if(typeof Cr=="string")return ze(Cr,rr);var Ir=z(kr=Object.prototype.toString.call(Cr)).call(kr,8,-1);if(Ir==="Object"&&Cr.constructor&&(Ir=Cr.constructor.name),Ir==="Map"||Ir==="Set")return oe(Cr);if(Ir==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(Ir))return ze(Cr,rr)}}(er))||cr&&er&&typeof er.length=="number"){or&&(er=or);var hr=0,pr=function(){};return{s:pr,n:function(){return hr>=er.length?{done:!0}:{done:!1,value:er[hr++]}},e:function(Cr){throw Cr},f:pr}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var Sr,Er=!0,Pr=!1;return{s:function(){or=or.call(er)},n:function(){var Cr=or.next();return Er=Cr.done,Cr},e:function(Cr){Pr=!0,Sr=Cr},f:function(){try{Er||or.return==null||or.return()}finally{if(Pr)throw Sr}}}}function ze(er,cr){(cr==null||cr>er.length)&&(cr=er.length);for(var or=0,hr=new Array(cr);or<cr;or++)hr[or]=er[or];return hr}var $e=e(40).fn,Lt=e(0),jt=Lt.undef,Et=Lt.notundef,ir=e(297),dr=e(154),Dt=e(25).reportAPI,lr=e(854);function sr(er,cr){var or=this,hr=[],pr=[],Sr=this.db,Er=this;return Sr.enable?(i(er).call(er,function(Cr){var rr=or.protocol.getSessionInCache(Cr);rr?Pr(rr,Cr):pr.push(Sr.getSession(Cr).then(function(kr){return Pr(kr,Cr)}))}),y.all(pr).then(function(){return hr})):(i(er).call(er,function(Cr){return Pr(or.protocol.getSessionInCache(Cr),Cr)}),y.resolve(hr));function Pr(Cr,rr){var kr,Ir,xr,vr;Cr?Cr.lastMsg?Cr.scene&&Cr.to?Cr.ack>=Cr.lastMsg.time?Er.logger.warn(k(kr="".concat(cr," not need ack ")).call(kr,Cr.id)):hr.push(Cr):Er.logger.warn(k(Ir="".concat(cr," session.scene|to undefined ")).call(Ir,Cr.id)):Er.logger.warn(k(xr="".concat(cr," session.lastMsg undefined ")).call(xr,Cr.id)):Er.logger.warn(k(vr="".concat(cr," session undefined ")).call(vr,rr))}}$e.setCurrSession=function(er){Dt({instance:this,className:"NIMFn",funcName:"setCurrSession",hasCallback:!1}),this.resetSessionUnread(er),this.protocol.setCurrSession(er)},$e.resetAllSessionUnread=function(){Dt({instance:this,className:"NIMFn",funcName:"resetAllSessionUnread",hasCallback:!1});for(var er in this.protocol.sessionSet)this.protocol.sessionSet[er].unread>0&&this.resetSessionUnread(er)},$e.resetSessionsUnread=function(){var er=de(n.mark(function cr(or){var hr,pr,Sr,Er,Pr,Cr,rr,kr,Ir=arguments;return n.wrap(function(xr){for(;;)switch(xr.prev=xr.next){case 0:return hr=Ir.length>1&&Ir[1]!==void 0?Ir[1]:function(){},hr=Dt({instance:this,className:"NIMFn",funcName:"resetSessionsUnread",done:hr}),(pr=this).logger.info("resetSessionsUnread::",or),xr.next=6,sr.call(this,or,"api::resetSessionsUnread");case 6:if(Sr=xr.sent,pr.protocol.resetSessionsUnread(Sr),pr.options.syncSessionUnread&&Sr.length!==0){xr.next=11;break}return hr(),xr.abrupt("return");case 11:Er=g(Sr).call(Sr,function(vr){return{scene:vr.scene==="p2p"?0:1,to:vr.to,timetag:vr.lastMsg.time}}),Pr=lr(Er,50),Cr=Ne(Pr),xr.prev=14,kr=n.mark(function vr(){var _r;return n.wrap(function(Or){for(;;)switch(Or.prev=Or.next){case 0:return _r=rr.value,Or.next=3,new y(function(Mr,yr){pr.sendCmd("markSessionAckBatch",{sessionAckTags:_r},function(mr){mr?(hr(mr),yr(mr)):Mr()})});case 3:case"end":return Or.stop()}},vr)}),Cr.s();case 17:if((rr=Cr.n()).done){xr.next=21;break}return xr.delegateYield(kr(),"t0",19);case 19:xr.next=17;break;case 21:xr.next=26;break;case 23:xr.prev=23,xr.t1=xr.catch(14),Cr.e(xr.t1);case 26:return xr.prev=26,Cr.f(),xr.finish(26);case 29:hr(null);case 30:case"end":return xr.stop()}},cr,this,[[14,23,26,29]])}));return function(cr){return er.apply(this,arguments)}}(),$e.resetSuperTeamSessionsUnread=function(){var er=de(n.mark(function cr(or){var hr,pr,Sr,Er,Pr,Cr,rr,kr,Ir=arguments;return n.wrap(function(xr){for(;;)switch(xr.prev=xr.next){case 0:return hr=Ir.length>1&&Ir[1]!==void 0?Ir[1]:function(){},hr=Dt({instance:this,className:"NIMFn",funcName:"resetSuperTeamSessionsUnread",done:hr}),(pr=this).logger.info("resetSuperTeamSessionsUnread::",or),xr.next=6,sr.call(this,or,"api::resetSuperTeamSessionsUnread");case 6:if(Sr=xr.sent,pr.protocol.resetSessionsUnread(Sr),pr.options.syncSessionUnread&&Sr.length!==0){xr.next=11;break}return hr(),xr.abrupt("return");case 11:Er=g(Sr).call(Sr,function(vr){return{to:vr.to,timetag:vr.lastMsg.time}}),Pr=lr(Er,50),Cr=Ne(Pr),xr.prev=14,kr=n.mark(function vr(){var _r;return n.wrap(function(Or){for(;;)switch(Or.prev=Or.next){case 0:return _r=rr.value,Or.next=3,new y(function(Mr,yr){pr.sendCmd("markSuperTeamSessionsAck",{sessionAckTags:_r},function(mr){mr?(hr(mr),yr(mr)):Mr()})});case 3:case"end":return Or.stop()}},vr)}),Cr.s();case 17:if((rr=Cr.n()).done){xr.next=21;break}return xr.delegateYield(kr(),"t0",19);case 19:xr.next=17;break;case 21:xr.next=26;break;case 23:xr.prev=23,xr.t1=xr.catch(14),Cr.e(xr.t1);case 26:return xr.prev=26,Cr.f(),xr.finish(26);case 29:hr(null);case 30:case"end":return xr.stop()}},cr,this,[[14,23,26,29]])}));return function(cr){return er.apply(this,arguments)}}(),$e.resetSessionUnread=function(er){var cr=arguments.length>1&&arguments[1]!==void 0?arguments[1]:function(){};cr=Dt({instance:this,className:"NIMFn",funcName:"resetSessionUnread",done:cr});var or=this,hr=or.options.resetUnreadMode!==!1,pr=function(){var Cr=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;Cr?cr(Cr,er):cr(null)};or.logger.info("resetSessionUnread::use reset mode",hr);var Sr=or.protocol.getSessionInCache(er),Er=!Sr&&this.db.enable?or.db.getSession(er):y.resolve(Sr);function Pr(Cr){if(!Cr.lastMsg&&!Cr.updateTime)return or.logger.warn("api::resetSessionUnread: session.lastMsg undefined ".concat(er)),pr();if(!Cr.scene||!Cr.to)return or.logger.warn("api::resetSessionUnread: session.scene|to undefined ".concat(er)),pr();var rr;if(rr=Cr.lastMsg?Cr.lastMsg.time:Cr.updateTime,Cr&&Cr.ack&&Cr.ack>=rr)return or.logger.warn("api::resetSessionUnread: session ack not needs ".concat(er)),pr();var kr={done:function(xr){xr?(or.logger.error({message:xr||"mark ack failed",callFunc:"resetSessionUnread"}),pr(xr||"mark ack failed")):(hr||or.protocol.resetSessionUnread(Cr),pr())}};if(or.processCallback(kr),Cr.scene==="superTeam")or.sendCmd("markSuperTeamSessionAck",{to:Cr.to,timetag:rr},kr.callback);else{var Ir={scene:Cr.scene==="p2p"?0:1,to:Cr.to,timetag:rr};or.sendCmd("markSessionAck",Ir,kr.callback)}}Er.then(function(Cr){return Cr?or.options.syncSessionUnread?(hr&&or.protocol.resetSessionUnread(Cr),void Pr(Cr)):(or.protocol.resetSessionUnread(Cr),pr()):(or.logger.warn("api::resetSessionUnread: session undefined ".concat(er)),pr())})},$e.resetCurrSession=function(){Dt({instance:this,className:"NIMFn",funcName:"resetCurrSession",hasCallback:!1}),this.protocol.setCurrSession("")},$e.insertLocalSession=function(er){(er=er||{}).done=Dt({instance:this,className:"NIMFn",funcName:"insertLocalSession",done:er.done});var cr,or;function hr(){er.session=or,er.done(cr,er)}Lt.verifyOptions(er,"scene to","scene::insertLocalSession"),Lt.verifyParamValid("scene",er.scene,this.message.validScenes,"scene::insertLocalSession"),this.protocol.insertLocalSession(er).then(function(pr){or=pr,hr()},function(pr){cr=pr,hr()})},$e.getLocalSessions=function(er){(er=er||{}).done=Dt({instance:this,className:"NIMFn",funcName:"getLocalSessions",done:er.done});var cr=[];Lt.verifyOptions(er),jt(er.limit)&&(er.limit=100),Lt.verifyParamType("limit",er.limit,"number","scene::getLocalSessions"),Et($(er))?Lt.verifyParamType("reverse",$(er),"boolean","scene::getLocalSessions"):er.reverse=!1,this.processCallback(er);var or=L(this.protocol.sessionSet),hr=0,pr=er.lastSessionId;if($(er)){var Sr,Er=Ne(or);try{for(Er.s();!(Sr=Er.n()).done;){var Pr=Sr.value,Cr=Pr.id;if(pr)Cr===pr&&(pr=void 0);else if(Pr.lastMsg!==void 0&&!Pr.isDeleted){if(++hr>er.limit)break;cr.push(V({},Pr))}}}catch(vr){Er.e(vr)}finally{Er.f()}}else{var rr,kr,Ir=Ne(or);try{for(Ir.s();!(kr=Ir.n()).done;){var xr=kr.value;if(pr===xr.id)break;xr.lastMsg===void 0||xr.isDeleted||cr.push(xr)}}catch(vr){Ir.e(vr)}finally{Ir.f()}cr=$(rr=z(cr).call(cr,-er.limit)).call(rr)}this.logger.debug("getLocalSessions::sessions is",cr),cr=g(cr).call(cr,function(vr){return re(dr).call(dr,vr)}),er.sessions=cr,delete er.callback,er.done(void 0,er)},$e.getLocalSession=function(er){(er=er||{}).done=Dt({instance:this,className:"NIMFn",funcName:"getLocalSession",done:er.done});var cr=this,or=cr.db,hr=null;if(Lt.verifyOptions(er,"sessionId","scene::getLocalSession"),Lt.verifyParamType("sessionId",er.sessionId,"string","scene::getLocalSession"),hr=cr.protocol.getSessionInCache(er.sessionId),cr.logger.debug("getLocalSession::cache session is",hr),!hr&&or.enable)return cr.processCallback(er),void or.getSession(er.sessionId).then(function(pr){pr&&(hr=pr,cr.logger.debug("getLocalSession::db session is",hr)),er.done(null,hr)}).catch(function(pr){er.done(pr)});er.done(null,re(dr).call(dr,hr))},$e.getLocalSessionsByMsgType=function(er){var cr;(er=er||{}).done=Dt({instance:this,className:"NIMFn",funcName:"getLocalSessionsByMsgType",done:er.done});var or=this.db,hr=er.exclude,pr=[],Sr=z(cr=ir.validTypes).call(cr,0);if(Et(hr)){if(typeof hr=="string")hr=[hr];else if(!ie(hr))return void Lt.onParamInvalidType("exclude",["string","string array"],"","exclude::getLocalSessionsByMsgType");hr=ue(hr).call(hr,function(Er){return le(Sr).call(Sr,Er)>-1}),Sr=ue(Sr).call(Sr,function(Er){return le(hr).call(hr,Er)===-1})}this.processCallback(er),or.enable?or.getSessions().then(function(Er){hr&&hr.length!==0?Sr&&Sr.length!==0?(i(Er).call(Er,function(Pr,Cr){var rr,kr,Ir;Pr.lastMsg&&le(hr).call(hr,Pr.lastMsg.type)>-1&&(rr=Cr,kr=Pr.id,Ir=or.getMsgs({sessionId:kr,limit:1,types:Sr}).then(function(xr){return xr&&xr[0]?Er[rr].lastMsg=xr[0]:Er[rr].lastMsg=null,y.resolve()}),pr.push(Ir))}),y.all(pr).then(function(){er.done(null,{exclude:hr,sessions:Er})})):er.done(null,{exclude:hr,sessions:g(Er).call(Er,function(Pr){Pr.lastMsg=null})}):er.done(null,{exclude:hr,sessions:Er})}):er.done(null,{exclude:hr,sessions:[]})},$e.updateLocalSession=function(er){(er=er||{}).done=Dt({instance:this,className:"NIMFn",funcName:"updateLocalSession",done:er.done});var cr,or=this,hr=or.db;Lt.verifyOptions(er,"id","scene::updateLocalSession"),or.processCallback(er);var pr=Lt.filterObj(er,"id localCustom");function Sr(){er.needNotify!==!1&&or.protocol.onUpdateSession(pr),er.session=pr,er.done(cr,er)}pr=or.protocol.updateSessionInCache(er),hr.enable&&pr?hr.updateSession(pr).then(function(Er){pr=Er,Sr()},function(Er){cr=Er,Sr()}):Sr()},$e.deleteLocalSession=function(er){(er=er||{}).done=Dt({instance:this,className:"NIMFn",funcName:"deleteLocalSession",done:er.done});var cr,or=this,hr=or.db;Lt.verifyOptions(er,"id","session::deleteLocalSession"),or.processCallback(er);var pr=or.protocol.getSessionInCache(er.id);if(or.protocol.deleteSessionInCache(er.id,er.isLogic),hr.enable?(er.isLogic?hr.deleteSessionLogic(er.id):hr.deleteSession(er.id,pr)).then(function(){or.logger.info("sessions::deleteSessionInDb::delete session done",er.id),Er()},function(Pr){cr=Pr,Er()}):Er(),er.isDeleteRoaming){var Sr=typeof er.id=="string"?[er.id]:er.id;Sr=g(Sr).call(Sr,function(Pr){return Pr.replace("-","|")}),this.sendCmd("deleteSessions",{sessions:Sr},function(){})}function Er(){er.done(cr,er)}},$e.deleteSession=function(er,cr){(er=er||{}).done=Dt({instance:this,className:"NIMFn",funcName:"deleteSession",done:er.done}),cr||this.logger.warn('this api will be abandon,please use "deleteLocalSession"'),Lt.verifyOptions(er,"scene to","session::deleteSession"),this.processCallback(er),er.sessions=[{scene:er.scene,to:er.to}],this.deleteSessions(er)},$e.deleteRoamingMsgBySession=function(er){(er=er||{}).done=Dt({instance:this,className:"NIMFn",funcName:"deleteRoamingMsgBySession",done:er.done}),this.deleteSession(er,!0)},$e.deleteSessions=function(er){var cr,or;(er=er||{}).done=Dt({instance:this,className:"NIMFn",funcName:"deleteSessions",done:er.done}),Lt.verifyOptions(er,"sessions","session::deleteSessions"),Lt.verifyParamType("sessions",er.sessions,"array","session::deleteSessions"),i(cr=er.sessions).call(cr,function(hr,pr){Lt.verifyOptions(hr,"scene to",!0,"sessions["+pr+"].","session::deleteSessions")}),this.processCallback(er),this.sendCmd("deleteSessions",{sessions:g(or=er.sessions).call(or,function(hr){return hr.scene+"|"+hr.to})},er.callback)},$e.getServerSessions=function(er){(er=er||{}).done=Dt({instance:this,className:"NIMFn",funcName:"getServerSessions",done:er.done}),Et(er.minTimestamp)&&Lt.verifyParamType("minTimestamp",er.minTimestamp,"number","session::deleteSessions"),Et(er.maxTimestamp)&&Lt.verifyParamType("maxTimestamp",er.maxTimestamp,"number","session::deleteSessions"),Et(er.needLastMsg)&&(er.needLastMsg=er.needLastMsg===!1?0:1),Et(er.limit)&&(Lt.verifyParamType("limit",er.limit,"number","session::deleteSessions"),Lt.verifyParamMax("limit",er.limit,100,"scene::getLocalSessions")),this.processCallback(er),this.sendCmd("getServerSessions",{sessionReqTag:er},er.callback)},$e.getServerSession=function(er){(er=er||{}).done=Dt({instance:this,className:"NIMFn",funcName:"getServerSession",done:er.done}),Lt.verifyOptions(er,"scene to","scene::getServerSession"),Lt.verifyParamValid("scene",er.scene,this.message.validScenes,"scene::getServerSession"),Lt.verifyParamType("to",er.to,"string","to::getServerSession");var cr=er.scene+"|"+er.to;er.scene==="superTeam"&&(cr="super_team|"+er.to),this.processCallback(er),this.sendCmd("getServerSession",{session:{id:cr}},er.callback)},$e.updateServerSession=function(er){(er=er||{}).done=Dt({instance:this,className:"NIMFn",funcName:"updateServerSession",done:er.done}),Lt.verifyOptions(er,"scene to","scene::updateServerSession"),Lt.verifyParamValid("scene",er.scene,this.message.validScenes,"scene::updateServerSession"),Lt.verifyParamType("to",er.to,"string","to::updateServerSession"),Et(er.extra)&&Lt.verifyParamType("extra",er.extra,"string","extra::updateServerSession");var cr=er.scene+"|"+er.to;er.scene==="superTeam"&&(cr="super_team|"+er.to),this.processCallback(er),this.sendCmd("updateServerSession",{session:{id:cr,ext:er.extra||""}},er.callback)},$e.deleteServerSessions=function(er){var cr,or=this;(er=er||{}).done=Dt({instance:this,className:"NIMFn",funcName:"deleteServerSessions",done:er.done}),Lt.verifyOptions(er,"sessions","scene::deleteServerSessions"),Lt.verifyParamType("sessions",er.sessions,"array","sessions::deleteServerSessions");var hr=[];i(cr=er.sessions).call(cr,function(pr){Lt.verifyParamValid("scene",pr.scene,or.message.validScenes,"scene::deleteServerSessions"),Lt.verifyParamType("to",pr.to,"string","to::deleteServerSessions");var Sr=pr.scene+"|"+pr.to;pr.scene==="superTeam"&&(Sr="super_team|"+pr.to),hr.push({id:Sr})}),this.processCallback(er),this.sendCmd("deleteServerSessions",{sessions:hr},er.callback)},$e.updateSessionsWithMoreRoaming=function(er){var cr;if((er=er||{}).done=Dt({instance:this,className:"NIMFn",funcName:"updateSessionsWithMoreRoaming",done:er.done}),Lt.verifyOptions(er,"msg","session::updateSessionsWithMoreRoaming"),Lt.verifyCallback(er,"done","session::updateSessionsWithMoreRoaming"),!this.db.enable)return er.done(null,"db is disable");var or={time:er.msg.time,idServer:er.msg.idServer,to:er.msg.to,from:er.msg.from};Lt.verifyParamType("msg.time",er.msg.time,"number","time::updateSessionsWithMoreRoaming"),Lt.verifyParamType("msg.idServer",er.msg.idServer,"string","idServer::updateSessionsWithMoreRoaming"),Lt.verifyParamType("msg.from",er.msg.from,"string","from::updateSessionsWithMoreRoaming"),Lt.verifyParamType("msg.to",er.msg.to,"string","to::updateSessionsWithMoreRoaming"),Lt.verifyParamValid("scene",er.msg.scene,this.message.validScenes,"scene::updateSessionsWithMoreRoaming");var hr=or.to===this.account?or.from:or.to;or.id=k(cr="".concat(er.msg.scene,"-")).call(cr,hr),this.db.updateSessionsWithMoreRoaming(or).then(function(pr){er.done(null,pr)}).catch(function(pr){er.done(pr)})},$e.deleteSessionsWithMoreRoaming=function(er){if((er=er||{}).done=Dt({instance:this,className:"NIMFn",funcName:"deleteSessionsWithMoreRoaming",done:er.done}),Lt.verifyOptions(er,"id","session::deleteSessionsWithMoreRoaming"),Lt.verifyCallback(er,"done","session::deleteSessionsWithMoreRoaming"),!this.db.enable)return er.done(null,"db is disable");this.db.deleteSessionsWithMoreRoaming(er.id).then(function(cr){er.done(null,cr)}).catch(function(cr){er.done(cr)})},$e.getSessionsWithMoreRoaming=function(er){if((er=er||{}).done=Dt({instance:this,className:"NIMFn",funcName:"getSessionsWithMoreRoaming",done:er.done}),Lt.verifyCallback(er,"done","session::getSessionsWithMoreRoaming"),!this.db.enable)return er.done(null,"db is disable");this.db.getSessionsWithMoreRoaming(er.id).then(function(cr){er.done(null,cr)}).catch(function(cr){er.done(cr)})}},function(t,r,e){var n=e(855),g=e(856),y=e(857),i=Math.ceil,k=Math.max;t.exports=function($,L,V){L=(V?g($,L,V):L===void 0)?1:k(y(L),0);var z=$==null?0:$.length;if(!z||L<1)return[];for(var re=0,ie=0,ue=Array(i(z/L));re<z;)ue[ie++]=n($,re,re+=L);return ue}},function(t,r){t.exports=function(e,n,g){var y=-1,i=e.length;n<0&&(n=-n>i?0:i+n),(g=g>i?i:g)<0&&(g+=i),i=n>g?0:g-n>>>0,n>>>=0;for(var k=Array(i);++y<i;)k[y]=e[y+n];return k}},function(t,r,e){var n=e(201),g=e(202),y=e(302),i=e(91);t.exports=function(k,$,L){if(!i(L))return!1;var V=typeof $;return!!(V=="number"?g(L)&&y($,L.length):V=="string"&&$ in L)&&n(L[$],k)}},function(t,r,e){var n=e(858);t.exports=function(g){var y=n(g),i=y%1;return y==y?i?y-i:y:0}},function(t,r,e){var n=e(859);t.exports=function(g){return g?(g=n(g))===1/0||g===-1/0?17976931348623157e292*(g<0?-1:1):g==g?g:0:g===0?g:0}},function(t,r,e){var n=e(860),g=e(91),y=e(862),i=/^[-+]0x[0-9a-f]+$/i,k=/^0b[01]+$/i,$=/^0o[0-7]+$/i,L=parseInt;t.exports=function(V){if(typeof V=="number")return V;if(y(V))return NaN;if(g(V)){var z=typeof V.valueOf=="function"?V.valueOf():V;V=g(z)?z+"":z}if(typeof V!="string")return V===0?V:+V;V=n(V);var re=k.test(V);return re||$.test(V)?L(V.slice(2),re?2:8):i.test(V)?NaN:+V}},function(t,r,e){var n=e(861),g=/^\s+/;t.exports=function(y){return y&&y.slice(0,n(y)+1).replace(g,"")}},function(t,r){var e=/\s/;t.exports=function(n){for(var g=n.length;g--&&e.test(n.charAt(g)););return g}},function(t,r,e){var n=e(124),g=e(106);t.exports=function(y){return typeof y=="symbol"||g(y)&&n(y)=="[object Symbol]"}},function(t,r,e){var n=e(125),g=e(864),y=e(865),i=e(57),k=e(58),$=e(51),L=e(16),V=e(15),z=e(2),re=e(32),ie=e(121),ue=e(9),le=e(6),oe=e(10),ae=e(8),qe=e(870),de=e(4),Ne=e(52),ze=e(53),$e=e(54),Lt=e(55),jt=e(43),Et=["callback","done"];function ir(rr,kr){var Ir=de(rr);if(Ne){var xr=Ne(rr);kr&&(xr=L(xr).call(xr,function(vr){return ze(rr,vr).enumerable})),Ir.push.apply(Ir,xr)}return Ir}function dr(rr){for(var kr=1;kr<arguments.length;kr++){var Ir,xr,vr=arguments[kr]!=null?arguments[kr]:{};kr%2?z(Ir=ir(Object(vr),!0)).call(Ir,function(_r){$(rr,_r,vr[_r])}):$e?Lt(rr,$e(vr)):z(xr=ir(Object(vr))).call(xr,function(_r){jt(rr,_r,ze(vr,_r))})}return rr}var Dt=e(40).fn,lr=e(0),sr=lr.undef,er=lr.notundef,cr=e(45),or=e(154),hr=e(153),pr=e(41),Sr=e(76),Er=e(25).reportAPI,Pr=e(11);Dt.sendG2Msg=function(rr){return(rr=rr||{}).done=Er({instance:this,className:"NIMFn",funcName:"sendG2Msg",done:rr.done}),this.processCallback(rr),rr.msg=new this.message.G2Message(rr),this.sendMsg(rr)},Dt.beforeSendMsg=function(rr){var kr,Ir=this.protocol,xr=rr.msg;switch(xr.to===this.account&&(xr.fromDeviceId=cr.deviceId),xr.userUpdateTime=Ir.myInfo&&Ir.myInfo.updateTime,xr.getScene()){case"p2p":kr="sendMsg";break;case"team":kr="sendTeamMsg";break;case"superTeam":kr="sendSuperTeamMsg"}L(rr)&&(kr="sendFilterMsg",xr.filter=!0),rr.cmd=kr},Dt.afterSendMsg=function(rr){var kr=rr.rtnMsg;if(!kr||!kr.ignore){var Ir=this.protocol.getSessionInCache(kr.sessionId);rr.isLocal&&Ir&&Ir.lastMsg&&kr.time<Ir.lastMsg.time||this.protocol.onUpdateSession(or.genSessionByMsg(kr))}},Dt.beforeForwardMsg=function(rr){lr.verifyOptions(rr,"msg scene to","msg::beforeForwardMsg"),rr.msg.scene=rr.scene,rr.msg.to=rr.to},Dt.markMsgRead=function(rr){var kr=this.protocol;!rr||this.db.enable||kr.options.autoMarkRead?this.logger.warn("api::markMsgRead: 不需要标记消息为已收到 (没有消息, 或者启用了数据库, 或者启用了自动标记已收到)"):kr.markMsgRead(rr,!0)},Dt.sendMsgReceipt=function(rr){if((rr=rr||{}).done=Er({instance:this,className:"NIMFn",funcName:"sendMsgReceipt",done:rr.done}),lr.verifyOptions(rr),this.processCallback(rr),rr.msg){lr.verifyOptions(rr,"msg","msg::sendMsgReceipt");var kr=rr.msg;lr.verifyOptions(kr,"target idClient time",!0,"msg.","msg::sendMsgReceipt"),this.protocol.shouldSendMsgReceipt(kr)?this.sendCmd("sendMsgReceipt",{msgReceipt:{to:kr.target,idClient:kr.idClient,time:kr.time}},rr.callback):rr.done()}else rr.done()},Dt.isMsgRemoteRead=function(rr){return Er({instance:this,className:"NIMFn",funcName:"isMsgRemoteRead",hasCallback:!1}),this.protocol.isMsgRemoteRead(rr)},Dt.recallMsg=function(rr){(rr=rr||{}).done=Er({instance:this,className:"NIMFn",funcName:"recallMsg",done:rr.done}),this.deleteMsg(rr,!0)},Dt.deleteMsg=function(rr,kr){var Ir;(rr=rr||{}).done=Er({instance:this,className:"NIMFn",funcName:"deleteMsg",done:rr.done}),kr||this.logger.warn("this api will be abandon,please use “recallMsg”"),lr.verifyOptions(rr,"msg","msg::deleteMsg");var xr=rr.msg;if(xr.scene!=="team"&&xr.from!==this.account||xr.status!=="success"||xr.isLocal)return rr.done(pr.newParamError("只能删除自己发的, 并且发送成功的消息，且不能是本地消息",{callFunc:"msg::deleteMsg"}),rr);lr.verifyOptions(xr,["scene","to","from","time","idClient","idServer"],!0,"msg.","msg::deleteMsg"),lr.verifyParamValid("msg.scene",xr.scene,this.message.validScenes,"msg::deleteMsg"),this.processPs(rr),this.processCallback(rr);var vr={deletedIdClient:xr.idClient,deletedIdServer:xr.idServer,time:xr.time,from:xr.from,to:xr.to,opeAccount:xr.from},_r=xr.scene==="superTeam"?"deleteSuperTeamMsg":"deleteMsg";vr.type="deleteMsg"+xr.scene[0].toUpperCase()+V(Ir=xr.scene).call(Ir,1);var Or=["ps","apnsText","pushPayload","env","opeAccount","attach"];z(Or).call(Or,function(Mr){rr[Mr]&&(vr[Mr]=rr[Mr])}),vr=new hr(vr),this.sendCmd(_r,{sysMsg:vr,msg:xr},rr.callback)},Dt.deleteMsgSelf=function(rr){(rr=rr||{}).done=Er({instance:this,className:"NIMFn",funcName:"deleteMsgSelf",done:rr.done}),lr.verifyOptions(rr,"msg","msg::deleteMsgSelf");var kr=rr.msg;if(kr.scene==="superTeam")return rr.done(pr.newParamError("单向删除暂不支持超大群场景",{callFunc:"msg::deleteMsgSelf"}),rr);lr.verifyOptions(kr,["scene","to","from","time","idClient","idServer"],!0,"msg.","msg::deleteMsgSelf"),lr.verifyParamValid("msg.scene",kr.scene,this.message.validScenes,"msg::deleteMsgSelf"),this.processCallback(rr);var Ir={scene:kr.scene==="p2p"?1:2,from:kr.from,to:kr.to,time:kr.time,idClient:kr.idClient,idServer:kr.idServer,custom:rr.custom,type:kr.type};this.sendCmd("deleteMsgSelf",{deleteMsgSelfTag:Ir},rr.callback)},Dt.deleteMsgSelfBatch=function(rr){var kr,Ir,xr,vr=this;if((rr=rr||{}).done=Er({instance:this,className:"NIMFn",funcName:"deleteMsgSelfBatch",done:rr.done}),lr.verifyOptions(rr,"msgs","msg::deleteMsgSelfBatch"),(!re(rr.msgs)||rr.msgs.length===0||rr.msgs.length>100)&&lr.onParamError("msgs应该是数组且数据长度应大于0小于等于100","msg::deleteMsgSelfBatch"),ie(kr=rr.msgs).call(kr,function(Or){return Or.scene==="superTeam"}))return rr.done(pr.newParamError("消息列表中存在超大群消息，单向删除暂不支持超大群场景",{callFunc:"msg::deleteMsgSelfBatch"}),rr);z(Ir=rr.msgs).call(Ir,function(Or){lr.verifyOptions(Or,["scene","to","from","time","idClient","idServer"],!0,"msg.","msg::deleteMsgSelfBatch"),lr.verifyParamValid("msg.scene",Or.scene,vr.message.validScenes,"msg::deleteMsgSelfBatch")}),this.processCallback(rr);var _r=ue(xr=rr.msgs).call(xr,function(Or){var Mr;return{scene:Or.scene==="p2p"?1:2,from:Or.from,to:Or.to,time:Or.time,idClient:Or.idClient,idServer:Or.idServer,sessionId:Or.sessionId||le(Mr="".concat(Or.scene,"-")).call(Mr,Or.to),custom:rr.custom,type:Or.type}});this.sendCmd("deleteMsgSelfBatch",{deleteMsgSelfTags:_r},rr.callback)};var Cr={text:0,image:1,audio:2,video:3,geo:4,notification:5,file:6,tip:10,robot:11,custom:100};Dt.getHistoryMsgs=function(rr){(rr=rr||{}).done=Er({instance:this,className:"NIMFn",funcName:"getHistoryMsgs",done:rr.done}),this.protocol.syncing&&this.logger.warn("Please call getHistoryMsgs after onsyncdone callback"),lr.verifyOptions(rr,"scene to","msg::getHistoryMsgs"),lr.verifyParamValid("scene",rr.scene,this.message.validScenes,"msg::getHistoryMsgs"),rr.beginTime===void 0&&(rr.beginTime=0);var kr,Ir=this.protocol.getSessionInCache(rr.scene+"-"+rr.to),xr=Ir&&Ir.lastEmptyTime;if(xr>rr.beginTime&&(rr.beginTime=xr),lr.verifyParamType("beginTime",rr.beginTime,"number","msg::getHistoryMsgs"),rr.endTime===void 0&&(rr.endTime=0),lr.verifyParamType("endTime",rr.endTime,"number","msg::getHistoryMsgs"),rr.lastMsgId=rr.lastMsgId&&+rr.lastMsgId?rr.lastMsgId:"0",rr.limit===void 0&&(rr.limit=100),lr.verifyParamType("limit",rr.limit,"number","msg::getHistoryMsgs"),lr.verifyParamMax("limit",rr.limit,100,"msg::getHistoryMsgs"),er(oe(rr))?lr.verifyParamType("reverse",oe(rr),"boolean","msg::getHistoryMsgs"):rr.reverse=!1,er(rr.asc)?lr.verifyParamType("asc",rr.asc,"boolean","msg::getHistoryMsgs"):rr.asc=!1,sr(rr.msgTypes))rr.msgTypes=[];else if(re(rr.msgTypes)){var vr,_r;rr.msgTypes=ue(vr=rr.msgTypes).call(vr,function(Mr){return Cr[Mr]}),rr.msgTypes=L(_r=rr.msgTypes).call(_r,function(Mr){return typeof Mr=="number"})}else typeof Cr[rr.msgTypes]=="number"?rr.msgTypes=[Cr[rr.msgTypes]]:rr.msgTypes=[];switch(this.processCallback(rr),rr.cbaop=function(Mr,yr){if(!Mr){var mr;rr.asc&&(yr.msgs=oe(mr=yr.msgs).call(mr)),yr.msgs=Sr.deduplication(yr.msgs)}},rr.scene){case"p2p":kr="getHistoryMsgs";break;case"team":kr="getTeamHistoryMsgs";break;case"superTeam":kr="getSuperTeamHistoryMsgs"}var Or={scene:rr.scene,to:rr.to,beginTime:rr.beginTime,endTime:rr.endTime,lastMsgId:rr.lastMsgId,limit:rr.limit,reverse:oe(rr),msgTypes:rr.msgTypes};this.sendCmd(kr,Or,rr.callback)},Dt.searchHistoryMsgs=function(rr){(rr=rr||{}).done=Er({instance:this,className:"NIMFn",funcName:"searchHistoryMsgs",done:rr.done}),lr.verifyOptions(rr,"scene to keyword","msg::searchHistoryMsgs"),lr.verifyParamValid("scene",rr.scene,this.message.validScenes,"msg::searchHistoryMsgs"),rr.beginTime===void 0&&(rr.beginTime=0);var kr,Ir=this.protocol.getSessionInCache(rr.scene+"-"+rr.to),xr=Ir&&Ir.lastEmptyTime;switch(xr>rr.beginTime&&(rr.beginTime=xr),lr.verifyParamType("beginTime",rr.beginTime,"number","msg::searchHistoryMsgs"),rr.endTime===void 0&&(rr.endTime=0),lr.verifyParamType("endTime",rr.endTime,"number","msg::searchHistoryMsgs"),rr.limit===void 0&&(rr.limit=100),lr.verifyParamType("limit",rr.limit,"number","msg::searchHistoryMsgs"),lr.verifyParamMax("limit",rr.limit,100,"msg::searchHistoryMsgs"),er(oe(rr))?lr.verifyParamType("reverse",oe(rr),"boolean","msg::searchHistoryMsgs"):rr.reverse=!1,er(rr.asc)?lr.verifyParamType("asc",rr.asc,"boolean","msg::searchHistoryMsgs"):rr.asc=!1,this.processCallback(rr),rr.asc&&(rr.cbaop=function(_r,Or){var Mr;_r||(Or.msgs=oe(Mr=Or.msgs).call(Mr))}),rr.scene){case"p2p":kr="searchHistoryMsgs";break;case"team":kr="searchTeamHistoryMsgs"}var vr=lr.filterObj(rr,"scene to beginTime endTime keyword limit reverse");this.sendCmd(kr,vr,rr.callback)},Dt.getLocalMsgs=function(rr){(rr=rr||{}).done=Er({instance:this,className:"NIMFn",funcName:"getLocalMsgs",done:rr.done});var kr=this,Ir=kr.db,xr=[];lr.verifyOptions(rr);var vr=!1;er(rr.start)&&(vr=!0,lr.verifyParamType("start",rr.start,"number","msg::getLocalMsgs"));var _r=!1;if(er(rr.end)&&(_r=!0,lr.verifyParamType("end",rr.end,"number","msg::getLocalMsgs")),vr&&_r&&rr.end<=rr.start&&lr.onParamError("参数 end 必须晚于 start"),er(rr.subTypes)&&lr.verifyParamType("subTypes",rr.subTypes,"array","msg::getLocalMsgs"),sr(rr.limit)&&(rr.limit=100),lr.verifyParamType("limit",rr.limit,"number","msg::getLocalMsgs"),lr.verifyParamMin("limit",rr.limit,1,"msg::getLocalMsgs"),kr.processCallback(rr),Ir.enable){var Or=new Date().getTime();Ir.getMsgs(rr).then(function(yr){var mr;xr=yr,kr.logger.info(le(mr="api::getLocalMsgs: query db cost ".concat(new Date().getTime()-Or," ms and the conditions is ")).call(mr,ae(rr))),Mr()},function(yr){(yr=yr||{}).message=yr.message||"msg::getLocalMsgs:db error",Mr()})}else Mr();function Mr(){var yr=lr.simpleClone(rr);yr.msgs=xr,delete yr.callback,delete yr.done,rr.done(null,yr)}},Dt.getLocalMsgsInUnread=function(rr){(rr=rr||{}).done=Er({instance:this,className:"NIMFn",funcName:"getLocalMsgsInUnread",done:rr.done});var kr=this;lr.validate({sessionId:{type:"string",allowEmpty:!1}},rr),this.getLocalSession({sessionId:rr.sessionId,done:function(Ir,xr){Ir?rr.done&&rr.done(Ir):xr?(xr.ack=xr.ack||0,kr.getLocalMsgs(dr({sessionId:rr.sessionId,start:xr.ack,limit:qe,filterFunc:function(vr){return vr.flow==="in"&&vr.isUnreadable===!0},done:function(){}},rr))):rr.done&&rr.done(new Error("session ".concat(rr.sessionId," not exist")))}})},Dt.getLocalMsgByIdClient=function(rr){(rr=rr||{}).done=Er({instance:this,className:"NIMFn",funcName:"getLocalMsgByIdClient",done:rr.done});var kr=this.db,Ir=null,xr=null;function vr(){rr.msg=xr,rr.done(Ir,rr)}lr.verifyOptions(rr,"idClient","msg::getLocalMsgByIdClient"),this.processCallback(rr),kr.enable?kr.getMsgByIdClient(rr.idClient).then(function(_r){_r&&(xr=_r),vr()},function(_r){Ir=_r,vr()}):(this.logger.warn("because db is false,error is null"),vr())},Dt.getLocalMsgsByIdClients=function(rr){(rr=rr||{}).done=Er({instance:this,className:"NIMFn",funcName:"getLocalMsgsByIdClients",done:rr.done});var kr,Ir=this.db,xr=[];function vr(){rr.msgs=xr,rr.done(kr,rr)}lr.verifyOptions(rr,"idClients","msg::getLocalMsgByIdClients"),lr.verifyParamType("idClients",rr.idClients,"array","msg::getLocalMsgByIdClients"),this.processCallback(rr),Ir.enable?Ir.getMsgsByIdClients(rr.idClients).then(function(_r){xr=L(_r).call(_r,function(Or){return!!Or}),vr()},function(_r){kr=_r,vr()}):vr()},Dt.updateLocalMsg=function(rr){(rr=rr||{}).done=Er({instance:this,className:"NIMFn",funcName:"updateLocalMsg",done:rr.done});var kr,Ir=this.db,xr=null;if(lr.verifyOptions(rr,"idClient","msg::updateLocalMsg"),this.processCallback(rr),Ir.enable){var vr=lr.filterObj(rr,"idClient localCustom");Ir.updateMsg(vr).then(function(Or){xr=Or,_r()},function(Or){kr=Or,_r()})}else _r();function _r(){rr.msg=xr,rr.done(kr,rr)}},Dt.deleteLocalMsg=function(){var rr=k(i.mark(function kr(Ir){var xr,vr,_r,Or;return i.wrap(function(Mr){for(;;)switch(Mr.prev=Mr.next){case 0:return Or=function(){Ir.done(vr,Ir)},(Ir=Ir||{}).done=Er({instance:this,className:"NIMFn",funcName:"deleteLocalMsg",done:Ir.done}),xr=this,lr.verifyOptions(Ir,"msg","msg::deleteLocalMsg"),_r=Ir.msg,lr.verifyOptions(_r,"idClient sessionId",!0,"msg.","msg::deleteLocalMsg"),xr.processCallback(Ir),Mr.prev=8,Mr.next=11,xr.protocol.deleteLocalMsg(_r);case 11:Or(),Mr.next=18;break;case 14:Mr.prev=14,Mr.t0=Mr.catch(8),vr=Mr.t0,Or();case 18:case"end":return Mr.stop()}},kr,this,[[8,14]])}));return function(kr){return rr.apply(this,arguments)}}(),Dt.deleteLocalMsgsBySession=function(rr){(rr=rr||{}).done=Er({instance:this,className:"NIMFn",funcName:"deleteLocalMsgsBySession",done:rr.done});var kr,Ir=this,xr=Ir.db;lr.verifyOptions(rr,"scene to","msg::deleteLocalMsgsBySession"),lr.verifyParamValid("scene",rr.scene,Ir.message.validScenes,"msg::deleteLocalMsgsBySession"),rr.sessionId=rr.scene+"-"+rr.to,rr.delLastMsg=rr.delLastMsg===!0,rr.isTag=rr.isTag===!0;var vr=new Date().getTime();function _r(){rr.done(kr,rr)}Ir.processCallback(rr);var Or={id:rr.sessionId};rr.delLastMsg&&(Or.lastMsg=null),rr.isTag&&(Or.lastEmptyTime=vr),xr.enable?xr.deleteMsgsBySessionId(rr).then(function(){rr.delLastMsg||rr.isTag?xr.updateSession(Or).then(function(Mr){Ir.protocol.onUpdateSession(Mr),rr.session=Mr,_r()}):_r()}).catch(function(Mr){kr=Mr,_r()}):(this.logger.warn("because db is false,error is null"),_r(),(rr.delLastMsg||rr.isTag)&&Ir.protocol.onUpdateSession(Or))},Dt.deleteLocalMsgsByTime=function(rr){var kr=this.db;Pr.isBrowser&&kr.enable&&(er((rr=rr||{}).start)?lr.verifyParamType("start",rr.start,"number","msg::deleteLocalMsgsByTime"):rr.start=0,er(rr.end)?lr.verifyParamType("end",rr.end,"number","msg::deleteLocalMsgsByTime"):rr.end=1/0,er(rr.end)&&er(rr.start)&&rr.end<=rr.start&&lr.onParamError("参数 end 必须大于 start"),this.processCallback(rr),this.protocol.deleteLocalMsgsByTime(rr).then(function(Ir){rr.done(null,Ir)},function(Ir){rr.done(Ir,null)}))},Dt.deleteLocalMsgs=function(rr){(rr=rr||{}).done=Er({instance:this,className:"NIMFn",funcName:"deleteLocalMsgs",done:rr.done});var kr;function Ir(){rr.done(kr,rr)}rr.updateSession=rr.updateSession!==!1,lr.verifyOptions(rr,"sessionId","msg::deleteLocalMsgsBySession"),er(rr.start)&&lr.verifyParamType("start",rr.start,"number","msg::deleteLocalMsgs"),er(rr.end)&&lr.verifyParamType("end",rr.end,"number","msg::deleteLocalMsgs"),er(rr.end)&&er(rr.start)&&rr.end<=rr.start&&lr.onParamError("参数 end 必须大于 start"),this.processCallback(rr),this.protocol.deleteLocalMsgs(rr).then(function(){Ir()},function(xr){kr=xr,Ir()})},Dt.deleteAllLocalMsgs=function(rr){(rr=rr||{}).done=Er({instance:this,className:"NIMFn",funcName:"deleteAllLocalMsgs",done:rr.done});var kr,Ir=this.db;function xr(){rr.done(kr,rr)}this.processCallback(rr),this.protocol.sessionSet={},Ir.enable?Ir.deleteAllMsgs().then(function(){xr()},function(vr){kr=vr,xr()}):(this.logger.warn("because db is false,error is null"),xr())},Dt.saveMsgsToLocal=function(rr){var kr;(rr=rr||{}).done=Er({instance:this,className:"NIMFn",funcName:"saveMsgsToLocal",done:rr.done}),this.db.enable||(this.logger.warn("because db is false,error is null"),rr.done(null,[])),lr.verifyOptions(rr,"msgs done","msg::saveMsgsToLocal"),lr.verifyParamType("msgs",rr.msgs,"Array","msg::saveMsgsToLocal");var Ir=ue(kr=rr.msgs).call(kr,function(xr){var vr=dr({},xr);return vr.hasOwnProperty("needUpdateSession")||(vr.needUpdateSession=!0),vr});this.db.putMsg(Ir).then(function(xr,vr){vr?rr.done(vr):rr.done(null,xr)})},Dt.clearServerHistoryMsgs=function(rr){(rr=rr||{}).done=Er({instance:this,className:"NIMFn",funcName:"clearServerHistoryMsgs",done:rr.done}),lr.verifyOptions(rr,"account","msg::clearServerHistoryMsgs");var kr=rr.delRoam!==!1;this.processCallback(rr),this.sendCmd("clearServerHistoryMsgs",{clearMsgsParams:{account:rr.account,delRoam:kr?1:0}},rr.callback)},Dt.clearServerHistoryMsgsWithSync=function(rr){(rr=rr||{}).done=Er({instance:this,className:"NIMFn",funcName:"clearServerHistoryMsgsWithSync",done:rr.done}),lr.verifyOptions(rr,"scene to","msg::clearServerHistoryMsgsWithSync");var kr=rr.isDeleteRoam===void 0||rr.isDeleteRoam===!0,Ir={type:rr.scene==="team"?2:1,isDeleteRoam:kr?1:0,isSyncSelf:rr.isSyncSelf===!0?1:0};Ir[Ir.type===2?"toTid":"otherAccid"]=rr.to,rr.ext!==void 0&&(Ir.ext=rr.ext),this.processCallback(rr),this.sendCmd("clearServerHistoryMsgsWithSync",{clearMsgsParamsWithSync:Ir},rr.callback)},Dt.msgFtsInServer=function(rr){(rr=rr||{}).done=Er({instance:this,className:"NIMFn",funcName:"msgFtsInServer",done:rr.done}),this.processCallback(rr);var kr=rr,Ir=y({},(g(kr),kr));lr.validate({keyword:{type:"string"},fromTime:{type:"number",required:!1},toTime:{type:"number",required:!1},sessionLimit:{type:"number",min:0,required:!1},msgLimit:{type:"number",min:0,required:!1},order:{type:"enum",values:["ASC","DESC"],required:!1},p2pList:{type:"array",required:!1},teamList:{type:"array",required:!1},senderList:{type:"array",required:!1},msgTypeList:{type:"array",required:!1},msgSubTypeList:{type:"array",required:!1}},Ir,"msg::msgFtsInServer"),er(Ir.toTime)&&er(Ir.fromTime)&&Ir.toTime<Ir.fromTime&&lr.onParamError("Options error: toTime should be greater than fromTime");var xr,vr={ASC:1,DESC:2};Ir.order&&vr[Ir.order]&&(Ir.order=vr[Ir.order]),Ir.msgTypeList&&(Ir.msgTypeList=ue(xr=Ir.msgTypeList).call(xr,function(Or){return Cr[Or]}));var _r=["p2pList","teamList","senderList","msgTypeList","msgSubTypeList"];z(_r).call(_r,function(Or){re(Ir[Or])&&(Ir[Or]=Ir[Or].join(","))}),this.sendCmd("msgFtsInServer",{msgFullSearchRequestTag:Ir},rr.callback)},Dt.msgFtsInServerByTiming=function(rr){(rr=rr||{}).done=Er({instance:this,className:"NIMFn",funcName:"msgFtsInServerByTiming",done:rr.done}),this.processCallback(rr);var kr=rr,Ir=(kr.callback,kr.done,n(kr,Et));lr.validate({keyword:{type:"string"},fromTime:{type:"number",required:!1},toTime:{type:"number",required:!1},msgLimit:{type:"number",min:0,required:!1},order:{type:"enum",values:["ASC","DESC"],required:!1},p2pList:{type:"array",required:!1},teamList:{type:"array",required:!1},senderList:{type:"array",required:!1},msgTypeList:{type:"array",required:!1},msgSubTypeList:{type:"array",required:!1}},Ir,"msg::msgFtsInServerByTimeSort"),er(Ir.toTime)&&er(Ir.fromTime)&&Ir.toTime<Ir.fromTime&&lr.onParamError("Options error: toTime should be greater than fromTime");var xr,vr={ASC:1,DESC:2};Ir.msgLimit===void 0&&(Ir.msgLimit=20),Ir.order&&vr[Ir.order]&&(Ir.order=vr[Ir.order]),Ir.msgTypeList&&(Ir.msgTypeList=ue(xr=Ir.msgTypeList).call(xr,function(Or){return Cr[Or]}));var _r=["p2pList","teamList","senderList","msgTypeList","msgSubTypeList"];z(_r).call(_r,function(Or){re(Ir[Or])&&(Ir[Or]=Ir[Or].join(","))}),this.sendCmd("msgFtsInServerByTiming",{msgTimingFullSearchRequestTag:Ir},rr.callback)},Dt.subMessages=function(){var rr=k(i.mark(function kr(Ir){var xr,vr,_r;return i.wrap(function(Or){for(;;)switch(Or.prev=Or.next){case 0:if(xr=this,(Ir=Ir||{}).done=Er({instance:this,className:"NIMFn",funcName:"subMessages",done:Ir.done}),lr.verifyOptions(Ir,"msg","msg::subMessages"),lr.verifyOptions(Ir.msg,"idClient","msg::subMessages"),this.processCallback(Ir),!xr.db.enable){Or.next=23;break}return vr=[],Or.prev=8,Or.next=11,xr.db.getSubMessages(Ir.msg.idClient);case 11:vr=Or.sent,Or.next=20;break;case 14:return Or.prev=14,Or.t0=Or.catch(8),(_r=Or.t0||{}).message=_r.message||"msg::subMessages:db error",Ir&&typeof Ir.done=="function"&&Ir.done(_r),Or.abrupt("return");case 20:Ir.done(null,vr),Or.next=25;break;case 23:xr.logger.warn("subMessages need db"),Ir&&typeof Ir.done=="function"&&Ir.done(pr.noDBError("subMessages need db"));case 25:case"end":return Or.stop()}},kr,this,[[8,14]])}));return function(kr){return rr.apply(this,arguments)}}(),Dt.subMessagesCount=function(){var rr=k(i.mark(function kr(Ir){var xr,vr,_r;return i.wrap(function(Or){for(;;)switch(Or.prev=Or.next){case 0:if(xr=this,(Ir=Ir||{}).done=Er({instance:this,className:"NIMFn",funcName:"subMessagesCount",done:Ir.done}),lr.verifyOptions(Ir,"msg","msg::subMessagesCount"),lr.verifyOptions(Ir.msg,"idClient","msg::subMessagesCount"),this.processCallback(Ir),!xr.db.enable){Or.next=23;break}return vr=[],Or.prev=8,Or.next=11,xr.db.getSubMessages(Ir.msg.idClient);case 11:vr=Or.sent,Or.next=20;break;case 14:return Or.prev=14,Or.t0=Or.catch(8),(_r=Or.t0||{}).message=_r.message||"msg::subMessages:db error",Ir&&typeof Ir.done=="function"&&Ir.done(_r),Or.abrupt("return");case 20:Ir.done(null,vr.length),Or.next=25;break;case 23:xr.logger.warn("subMessagesCount need db"),Ir&&typeof Ir.done=="function"&&Ir.done(pr.noDBError("subMessagesCount need db"));case 25:case"end":return Or.stop()}},kr,this,[[8,14]])}));return function(kr){return rr.apply(this,arguments)}}()},function(t,r){t.exports=function(e){if(e==null)throw new TypeError("Cannot destructure "+e)},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,r,e){var n=e(866),g=e(151);function y(){var i;return t.exports=y=n?g(i=n).call(i):function(k){for(var $=1;$<arguments.length;$++){var L=arguments[$];for(var V in L)Object.prototype.hasOwnProperty.call(L,V)&&(k[V]=L[V])}return k},t.exports.__esModule=!0,t.exports.default=t.exports,y.apply(this,arguments)}t.exports=y,t.exports.__esModule=!0,t.exports.default=t.exports},function(t,r,e){t.exports=e(867)},function(t,r,e){t.exports=e(868)},function(t,r,e){var n=e(869);t.exports=n},function(t,r,e){var n=e(305);t.exports=n},function(t,r,e){t.exports=e(871)},function(t,r,e){var n=e(872);t.exports=n},function(t,r,e){e(873),t.exports=9007199254740991},function(t,r,e){e(1)({target:"Number",stat:!0,nonConfigurable:!0,nonWritable:!0},{MAX_SAFE_INTEGER:9007199254740991})},function(t,r,e){var n=e(10),g=e(32),y=e(15),i=e(2),k=e(8),$=e(4),L=e(16),V=e(40).fn,z=e(0),re=e(756),ie=e(758),ue=(e(76),z.notundef),le=e(25).reportAPI;function oe(ae,qe,de,Ne){de=de||"",z.verifyParamType(de+"from",ae.from,"string",qe),z.verifyParamType(de+"to",ae.to,"string",qe),z.verifyParamType(de+"idServer",ae.idServer,"string",qe),z.verifyParamType(de+"time",ae.time,"number",qe),z.verifyParamValid(de+"scene",ae.scene,this.message.validScenes,qe),Ne||z.verifyParamType(de+"idClient",ae.idClient,"string",qe)}V.getThreadMsgs=function(ae){(ae=ae||{}).done=le({instance:this,className:"NIMFn",funcName:"getThreadMsgs",done:ae.done}),z.verifyCallback(ae,"done","msg::getThreadMsgs"),z.verifyOptions(ae,"scene threadMsgFromAccount threadMsgToAccount threadMsgIdServer threadMsgTime","msg::getThreadMsgs"),z.verifyParamType("threadMsgFromAccount",ae.threadMsgFromAccount,"string","msg::getThreadMsgs"),z.verifyParamType("threadMsgToAccount",ae.threadMsgToAccount,"string","msg::getThreadMsgs"),z.verifyParamType("threadMsgIdServer",ae.threadMsgIdServer,"string","msg::getThreadMsgs"),z.verifyParamType("threadMsgTime",ae.threadMsgTime,"number","msg::getThreadMsgs"),z.verifyParamValid("scene",ae.scene,this.message.validScenes,"msg::getThreadMsgs"),this.processCallback(ae);var qe={scene:this.message.sceneMap[ae.scene],from:ae.threadMsgFromAccount,to:ae.threadMsgToAccount,time:ae.threadMsgTime,idServer:ae.threadMsgIdServer},de={limit:ae.limit<100?ae.limit:100,beginTime:typeof ae.beginTime=="number"?ae.beginTime:0,reverse:n(ae)===!0?1:0};typeof ae.endTime=="number"&&(de.endTime=ae.endTime,de.endTime<=de.beginTime&&z.onParamError("endTime应该大于beginTime","msg::getThreadMsgs")),ae.lastMsgId&&(de.lastMsgId=ae.lastMsgId),this.sendCmd("getThreadMsgs",{msg:qe,threadMsgReq:de,NOTSTORE:"msg threadMsgReq"},ae.callback)},V.getMsgsByIdServer=function(ae){var qe,de,Ne=this;(ae=ae||{}).done=le({instance:this,className:"NIMFn",funcName:"getMsgsByIdServer",done:ae.done});var ze=this,$e="msg::getMsgsByIdServer";z.verifyCallback(ae,"done",$e),(!g(ae.reqMsgs)||ae.reqMsgs.length===0||ae.reqMsgs.length>100)&&z.onParamError("reqMsgs应该是数组且数据长度应大于0小于等于100",$e),ae.reqMsgs=y(qe=ae.reqMsgs).call(qe,0),i(de=ae.reqMsgs).call(de,function(Lt,jt){oe.call(ze,Lt,$e,"reqMsgs[".concat(jt,"]."),!0),Lt.scene=Ne.message.sceneMap[Lt.scene]}),this.processCallback(ae),this.sendCmd("getMsgsByIdServer",{reqMsgs:ae.reqMsgs},ae.callback)},V.addQuickComment=function(ae){(ae=ae||{}).done=le({instance:this,className:"NIMFn",funcName:"addQuickComment",done:ae.done}),z.verifyOptions(ae,"msg body","msg::addQuickComment"),oe.call(this,ae.msg,"msg::addQuickComment");var qe=new re(ae,"msg::addQuickComment");qe.from=this.account;var de={scene:this.message.sceneMap[ae.msg.scene],from:ae.msg.from,to:ae.msg.to,time:ae.msg.time,idServer:ae.msg.idServer,idClient:ae.msg.idClient};this.processCallback(ae),this.sendCmd("addQuickComment",{msg:de,comment:qe},ae.callback)},V.deleteQuickComment=function(ae){(ae=ae||{}).done=le({instance:this,className:"NIMFn",funcName:"deleteQuickComment",done:ae.done}),z.verifyOptions(ae,"msg body","msg::deleteQuickComment"),oe.call(this,ae.msg,"msg::deleteQuickComment");var qe=new re(ae,"msg::addQuickComment");qe.from=this.account;var de={scene:this.message.sceneMap[ae.msg.scene],from:ae.msg.from,to:ae.msg.to,time:ae.msg.time,idServer:ae.msg.idServer,idClient:ae.msg.idClient};this.processCallback(ae),this.sendCmd("deleteQuickComment",{msg:de,comment:qe},ae.callback)},V.getQuickComments=function(ae){var qe=this;(ae=ae||{}).done=le({instance:this,className:"NIMFn",funcName:"getQuickComments",done:ae.done});var de="msg::getQuickComments",Ne=this,ze={},$e={};z.verifyOptions(ae,"msgs","msg::getQuickComments"),(!g(ae.msgs)||ae.msgs.length===0||ae.msgs.length>20)&&z.onParamError("msgs应该是数组且数据长度应大于0小于等于20",de);var Lt=[];try{Lt=JSON.parse(k(ae.msgs))}catch{z.onParamError("msgs 不是合法的对象",de)}i(Lt).call(Lt,function(jt,Et){oe.call(Ne,jt,de,"msgs[".concat(Et,"]."),!0),jt.scene=qe.message.sceneMap[jt.scene],ze[jt.idClient]=null,$e[jt.idClient]=Et}),this.processCallback(ae),this.getLocalMsgsByIdClients({idClients:$(ze),done:function(jt,Et){var ir,dr=Ne.protocol.timetags.sync;!jt&&Et.msgs&&Et.msgs.length&&dr&&(i(ir=Et.msgs).call(ir,function(Dt){ze[Dt.idClient]=Dt}),Lt=L(Lt).call(Lt,function(Dt){var lr=ze[Dt.idClient];return!lr||(lr.commentTimetag&&(Dt.timestamp=lr.commentTimetag),!(lr.commentTimetag>dr))})),Ne.sendCmd("getQuickComments",{commentReq:Lt,idMap:ze,indexMap:$e},ae.callback)}})},V.addCollect=function(ae){(ae=ae||{}).done=le({instance:this,className:"NIMFn",funcName:"addCollect",done:ae.done}),z.verifyOptions(ae,"type data","msg::addCollect");var qe=new ie(ae,"msg::addCollect");this.processCallback(ae),this.sendCmd("addCollect",{collect:qe},ae.callback)},V.deleteCollects=function(ae){var qe;(ae=ae||{}).done=le({instance:this,className:"NIMFn",funcName:"deleteCollects",done:ae.done}),z.verifyOptions(ae,"collectList","msg::deleteCollects"),(!g(ae.collectList)||ae.collectList.length===0||ae.collectList.length>100)&&z.onParamError("collectList应该是数组且数据长度应大于0小于等于100","msg::deleteCollects"),i(qe=ae.collectList).call(qe,function(de,Ne){z.verifyParamType("collectList[".concat(Ne,"].id"),de.id,"string","msg::deleteCollects"),z.verifyParamType("collectList[".concat(Ne,"].createTime"),de.createTime,"number","msg::deleteCollects")}),this.processCallback(ae),this.sendCmd("deleteCollects",{collectList:ae.collectList},ae.callback)},V.updateCollect=function(ae){(ae=ae||{}).done=le({instance:this,className:"NIMFn",funcName:"updateCollect",done:ae.done}),z.verifyOptions(ae,"collect","msg::updateCollect"),z.verifyParamType("collect.id",ae.collect.id,"string","msg::updateCollect"),z.verifyParamType("collect.createTime",ae.collect.createTime,"number","msg::updateCollect"),this.processCallback(ae),this.sendCmd("updateCollect",{collect:ae.collect},ae.callback)},V.getCollects=function(ae){(ae=ae||{}).done=le({instance:this,className:"NIMFn",funcName:"getCollects",done:ae.done}),z.verifyCallback(ae,"done","msg::getCollects");var qe={},de=["type","beginTime","endTime","limit"];i(de).call(de,function(Ne){ue(ae[Ne])&&(z.verifyParamType(Ne,ae[Ne],"number","msg::getCollects"),qe[Ne]=ae[Ne])}),ae.limit>100&&z.onParamError("limit不能大于100","msg::getCollects"),ae.beginTime>ae.endTime&&z.onParamError("beginTime不能大于endTime","msg::getCollects"),ue(ae.lastId)&&(z.verifyParamType("lastId",ae.lastId,"string","msg::getCollects"),qe.lastMsgId=ae.lastId),ue(n(ae))&&(qe.reverse=n(ae)===!0?1:0),this.processCallback(ae),this.sendCmd("getCollects",{collectQuery:qe,NOTSTORE:"collectQuery"},ae.callback)},V.addStickTopSession=function(ae){(ae=ae||{}).done=le({instance:this,className:"NIMFn",funcName:"addStickTopSession",done:ae.done}),z.verifyOptions(ae,"id","msg::addStickTopSession");var qe=z.getIdArray(ae.id);z.verifyParamValid("id的前半部分",qe[0],this.message.validScenes,"msg::addStickTopSession"),z.verifyParamType("id的后半部分",qe[1],"string","msg::addStickTopSession"),qe[0]==="superTeam"&&(qe[0]="super_team");var de={id:qe=qe.join("|")};ae.topCustom&&(z.verifyParamType("topCustom",ae.topCustom,"string","msg::addStickTopSession"),de.topCustom=ae.topCustom),this.processCallback(ae),this.sendCmd("addStickTopSession",{stickTopSession:de},ae.callback)},V.deleteStickTopSession=function(ae){(ae=ae||{}).done=le({instance:this,className:"NIMFn",funcName:"deleteStickTopSession",done:ae.done}),z.verifyOptions(ae,"id","msg::deleteStickTopSession");var qe=z.getIdArray(ae.id);z.verifyParamValid("id的前半部分",qe[0],this.message.validScenes,"msg::deleteStickTopSession"),z.verifyParamType("id的后半部分",qe[1],"string","msg::deleteStickTopSession"),qe[0]==="superTeam"&&(qe[0]="super_team"),qe=qe.join("|"),this.processCallback(ae),this.sendCmd("deleteStickTopSession",{stickTopSession:{id:qe}},ae.callback)},V.updateStickTopSession=function(ae){(ae=ae||{}).done=le({instance:this,className:"NIMFn",funcName:"updateStickTopSession",done:ae.done}),z.verifyOptions(ae,"id","msg::updateStickTopSession");var qe=z.getIdArray(ae.id);z.verifyParamValid("id的前半部分",qe[0],this.message.validScenes,"msg::updateStickTopSession"),z.verifyParamType("id的后半部分",qe[1],"string","msg::updateStickTopSession"),qe[0]==="superTeam"&&(qe[0]="super_team");var de={id:qe=qe.join("|")};ae.topCustom&&(z.verifyParamType("topCustom",ae.topCustom,"string","msg::updateStickTopSession"),de.topCustom=ae.topCustom),this.processCallback(ae),this.sendCmd("updateStickTopSession",{stickTopSession:de},ae.callback)},V.getStickTopSessions=function(ae){(ae=ae||{}).done=le({instance:this,className:"NIMFn",funcName:"getStickTopSessions",done:ae.done}),z.verifyOptions(ae,"done","msg::getStickTopSessions"),this.processCallback(ae);var qe,de=this.protocol.sessionSet,Ne=[];for(var ze in de)(qe=this.protocol.getSessionInCache(ze,ae.findDelete))&&qe.isTop&&Ne.push(de[ze]);ae.callback(null,Ne)},V.addMsgPin=function(ae){(ae=ae||{}).done=le({instance:this,className:"NIMFn",funcName:"addMsgPin",done:ae.done}),z.verifyOptions(ae,"msg","msg::addMsgPin"),oe.call(this,ae.msg,"msg::addMsgPin");var qe={pinFrom:this.account};ue(ae.pinCustom)&&(z.verifyParamType("pinCustom",ae.pinCustom,"string","msg::addMsgPin"),qe.pinCustom=ae.pinCustom);var de={scene:this.message.sceneMap[ae.msg.scene],from:ae.msg.from,to:ae.msg.to,time:ae.msg.time,idServer:ae.msg.idServer,idClient:ae.msg.idClient};this.processCallback(ae),this.sendCmd("addMsgPin",{msg:de,pinTag:qe},ae.callback)},V.updateMsgPin=function(ae){(ae=ae||{}).done=le({instance:this,className:"NIMFn",funcName:"updateMsgPin",done:ae.done}),z.verifyOptions(ae,"msg","msg::updateMsgPin"),oe.call(this,ae.msg,"msg::updateMsgPin");var qe={pinFrom:this.account};ue(ae.pinCustom)&&(z.verifyParamType("pinCustom",ae.pinCustom,"string","msg::updateMsgPin"),qe.pinCustom=ae.pinCustom);var de={scene:this.message.sceneMap[ae.msg.scene],from:ae.msg.from,to:ae.msg.to,time:ae.msg.time,idServer:ae.msg.idServer,idClient:ae.msg.idClient};this.processCallback(ae),this.sendCmd("updateMsgPin",{msg:de,pinTag:qe},ae.callback)},V.deleteMsgPin=function(ae){(ae=ae||{}).done=le({instance:this,className:"NIMFn",funcName:"deleteMsgPin",done:ae.done}),z.verifyOptions(ae,"msg","msg::deleteMsgPin"),oe.call(this,ae.msg,"msg::deleteMsgPin");var qe={pinFrom:this.account},de={scene:this.message.sceneMap[ae.msg.scene],from:ae.msg.from,to:ae.msg.to,time:ae.msg.time,idServer:ae.msg.idServer,idClient:ae.msg.idClient};this.processCallback(ae),this.sendCmd("deleteMsgPin",{msg:de,pinTag:qe},ae.callback)},V.getMsgPins=function(ae){var qe=this;(ae=ae||{}).done=le({instance:this,className:"NIMFn",funcName:"getMsgPins",done:ae.done}),z.verifyOptions(ae,"id","msg::getMsgPins");var de=this.db,Ne=z.getIdArray(ae.id);z.verifyParamValid("id的前半部分",Ne[0],this.message.validScenes,"msg::getMsgPins"),z.verifyParamType("id的后半部分",Ne[1],"string","msg::getMsgPins"),Ne[0]==="superTeam"&&(Ne[0]="super_team");var ze={sessionId:Ne=Ne.join("|"),timetag:0};if(this.processCallback(ae),de.enable){var $e=this.protocol.timetags.sync;de.getTimetag("pin-"+ae.id).then(function(jt){jt>$e?de.getMsgPins(ae.id).then(function(Et){return ae.callback(null,{pins:Et||[]})}).catch(function(Et){return ae.callback(Et)}):(ze.timetag=jt,Lt.call(qe))})}else Lt.call(this);function Lt(){this.sendCmd("getMsgPins",{msgPinReq:ze,id:ae.id,NOTSTORE:"msgPinReq"},ae.callback)}}},function(t,r,e){var n=e(3),g=e(16),y=e(2),i=e(10),k=e(40).fn,$=e(0),L=$.undef,V=$.notundef,z=e(153),re=e(25).reportAPI;k.markSysMsgRead=function(ie){(ie=ie||{}).done=re({instance:this,className:"NIMFn",funcName:"markSysMsgRead",done:ie.done});var ue,le=this.db,oe=n.resolve(),ae=this.protocol;$.verifyOptions(ie,"sysMsgs","sysmsg::markSysMsgRead");var qe=ie.sysMsgs;function de(){ie.done(ue,ie)}$.isArray(qe)||(qe=[qe]),le.enable?oe=le.markSysMsgRead(qe).then(function(Ne){qe=Ne,ae.onUpdateSysMsg(Ne)}):(qe=g(qe).call(qe,function(Ne){return!Ne.read})).length&&(ae.options.autoMarkRead||ae.markSysMsgRead(qe,!0),y(qe).call(qe,function(Ne){Ne.read=!0}),ae.onUpdateSysMsg(qe)),oe.then(function(){return ae.reduceSysMsgUnread(qe)}).then(de,function(Ne){ue=Ne,de()})},k.sendCustomSysMsg=function(ie){(ie=ie||{}).done=re({instance:this,className:"NIMFn",funcName:"sendCustomSysMsg",done:ie.done}),$.verifyOptions(ie,"scene to content","sysmsg::sendCustomSysMsg"),$.verifyParamValid("scene",ie.scene,this.message.validScenes,"sysmsg::sendCustomSysMsg"),this.processCallback(ie);var ue="sendCustomSysMsg";return ie.scene==="p2p"?ie.type="customP2p":ie.scene==="superTeam"?(ie.type="customSuperTeam",ue="sendSuperTeamCustomSysMsg"):ie.type="customTeam",ie.sysMsg=new z(ie),g(ie)&&(ue="sendFilterCustomSysMsg"),this.sendCmd(ue,{sysMsg:ie.sysMsg,single:!0},ie.callback),this.formatReturnSysMsg(ie.sysMsg)},k.formatReturnSysMsg=function(ie){return ie=$.copy(ie),this.protocol.completeSysMsg(ie),ie.status="sending",ie=i(z).call(z,ie)},k.getLocalSysMsgs=function(ie){(ie=ie||{}).done=re({instance:this,className:"NIMFn",funcName:"getLocalSysMsgs",done:ie.done});var ue,le=this.db,oe=[];function ae(){ie.sysMsgs=oe,ie.done(ue,ie)}$.verifyOptions(ie),ie.category&&$.verifyParamValid("category",ie.category,z.validCategories,"sysmsg::getLocalSysMsgs"),ie.type&&$.verifyParamValid("type",ie.type,z.validTypes,"sysmsg::getLocalSysMsgs"),L(ie.limit)&&(ie.limit=100),$.verifyParamType("limit",ie.limit,"number","sysmsg::getLocalSysMsgs"),$.verifyParamMax("limit",ie.limit,100,"sysmsg::getLocalSysMsgs"),V(i(ie))?$.verifyParamType("reverse",i(ie),"boolean","sysmsg::getLocalSysMsgs"):ie.reverse=!1,this.processCallback(ie),le.enable?le.getSysMsgs(ie).then(function(qe){oe=qe,ae()},function(qe){ue=qe,ae()}):ae()},k.updateLocalSysMsg=function(ie){(ie=ie||{}).done=re({instance:this,className:"NIMFn",funcName:"updateLocalSysMsg",done:ie.done});var ue,le=this.db,oe=null;if($.verifyOptions(ie,"idServer","sysmsg::updateLocalSysMsg"),this.processCallback(ie),le.enable){var ae=$.filterObj(ie,"idServer state localCustom");le.updateSysMsg(ae).then(function(de){oe=de,qe()},function(de){ue=de,qe()})}else qe();function qe(){ie.sysMsg=oe,ie.done(ue,ie)}},k.deleteLocalSysMsg=function(ie){(ie=ie||{}).done=re({instance:this,className:"NIMFn",funcName:"deleteLocalSysMsg",done:ie.done});var ue,le=this.db;function oe(){ie.done(ue,ie)}$.verifyOptions(ie,"idServer","sysmsg::deleteLocalSysMsg"),this.processCallback(ie),le.enable?le.deleteSysMsg(ie.idServer).then(function(){oe()},function(ae){ue=ae,oe()}):oe()},k.deleteAllLocalSysMsgs=function(ie){var ue;(ie=ie||{}).done=re({instance:this,className:"NIMFn",funcName:"deleteAllLocalSysMsgs",done:ie.done});var le=this,oe=le.db;function ae(){le.protocol.onUpdateSysMsgUnread({}),ie.done(ue,ie)}le.processCallback(ie),oe.enable?oe.deleteAllSysMsgs().then(function(){ae()},function(qe){ue=qe,ae()}):ae()}},function(t,r,e){var n=e(40).fn,g=e(0),y=e(11),i=e(25).reportAPI;n.getChatroomAddress=function(k){(k=k||{}).done=i({instance:this,className:"NIMFn",funcName:"getChatroomAddress",done:k.done}),g.verifyOptions(k,"chatroomId","chatroom::getChatroomAddress"),k.isWeixinApp=y.isWeixinApp,k.type=y.ipVersion,this.processCallback(k),this.sendCmd("getChatroomAddress",k)}},function(t,r){},function(t,r){},function(t,r,e){var n=e(40).fn,g=e(0),y=e(25).reportAPI;n.audioToText=function(i){(i=i||{}).done=y({instance:this,className:"NIMFn",funcName:"audioToText",done:i.done}),g.verifyOptions(i,"url","audio::audioToText"),i.audioToText=g.filterObj(i,"url"),this.processCallback(i),this.sendCmd("audioToText",i)}},function(t,r,e){var n=e(40).fn;n.clearDB=function(g){var y=this.db;this.processCallback(g);var i=g.done;y.enable?y.clear().then(i,i):i()},n.removeDB=function(g){var y=this.db;this.processCallback(g);var i=g.done;y.enable?y.destroy().then(i,i):i()},n.closeDB=function(g){var y=this.db;this.processCallback(g);var i=g.done;y.enable?y.close().then(i,i):i()}},function(t,r,e){var n=e(40).fn,g=e(310),y=e(0),i=y.undef,k=e(25).reportAPI;n.getPushNotificationMultiportConfig=function(){return k({instance:this,className:"NIMFn",funcName:"getPushNotificationMultiportConfig",hasCallback:!1}),this.protocol.getPushNotificationMultiportConfig()},n.updatePushNotificationMultiportConfig=function($){($=$||{}).done=k({instance:this,className:"NIMFn",funcName:"updatePushNotificationMultiportConfig",done:$.done}),y.verifyOptions($),i($.shouldPushNotificationWhenPCOnline)&&($.shouldPushNotificationWhenPCOnline=!0),$.donnop=new g($),this.processCallback($),this.sendCmd("updateDonnop",$)}},function(t,r,e){var n=e(2),g=e(3),y=e(6),i=e(22),k=e(40).fn,$=e(0),L=e(883),V=e(884),z=e(25).reportAPI;function re(ie){return i(ie)==="object"&&(ie.msgEventSubscribes?ie=ie.msgEventSubscribes:ie.msgEventSubscribe?ie=ie.msgEventSubscribe:ie.accounts?ie=ie.accounts:ie.msgEvent&&(ie=ie.msgEvent).time&&(ie.time=+ie.time),ie.sync===1?ie.sync=!0:ie.sync===0&&(ie.sync=!1)),ie}k.batchSendEventsCmds=function(ie,ue,le){var oe=this,ae=$.dropArrayDuplicates(ue.accounts);ae=$.reshape2d(ae,100);var qe=[];n(ae).call(ae,function(de){qe.push(new g(function(Ne,ze){var $e=$.simpleClone(ue);$e.accounts=de,oe.sendCmdWithResp(ie,$e,function(Lt,jt){Lt?ze(Lt):Ne(re(jt))})}))}),g.all(qe).then(function(de){var Ne=null;if(de.length>0)if(de[0].msgEventSubscribe){var ze=de[0].msgEventSubscribe;ze=re(ze);var $e=[];n(de).call(de,function(Lt){$e=y($e).call($e,Lt.accounts)}),Ne={accounts:$e,msgEventSubscribe:ze}}else Ne=[],n(de).call(de,function(Lt){Ne=y(Ne).call(Ne,Lt)});le(null,Ne)},function(de){le(de,null)})},k.publishEvent=function(ie){(ie=ie||{}).done=z({instance:this,className:"NIMFn",funcName:"publishEvent",done:ie.done});var ue=new L(ie);ue=ue.assembleEvent(),this.processCallback(ie),this.sendCmdWithResp("publishEvent",{msgEvent:ue},function(le,oe){le||(oe=re(oe)),ie.callback(le,oe)})},k.subscribeEvent=function(ie){(ie=ie||{}).done=z({instance:this,className:"NIMFn",funcName:"subscribeEvent",done:ie.done}),$.verifyOptions(ie,"accounts","event::subscribeEvent");var ue=new V(ie);$.verifyParamType("accounts",ie.accounts,"array","event::subscribeEvent"),this.processCallback(ie),ue=ue.assembleEvent(),this.batchSendEventsCmds("subscribeEvent",{msgEventSubscribe:ue,accounts:ie.accounts},function(le,oe){!le&&oe&&(oe={failedAccounts:oe}),ie.callback(le,oe)})},k.unSubscribeEventsByAccounts=function(ie){(ie=ie||{}).done=z({instance:this,className:"NIMFn",funcName:"unSubscribeEventsByAccounts",done:ie.done}),$.verifyOptions(ie,"accounts","event::unSubscribeEventsByAccounts"),$.verifyParamType("accounts",ie.accounts,"array","event::unSubscribeEventsByAccounts");var ue=new V(ie);ue=ue.assembleEvent(),this.processCallback(ie),this.batchSendEventsCmds("unSubscribeEventsByAccounts",{msgEventSubscribe:ue,accounts:ie.accounts},function(le,oe){!le&&oe&&(oe={failedAccounts:oe}),ie.callback(le,oe)})},k.unSubscribeEventsByType=function(ie){(ie=ie||{}).done=z({instance:this,className:"NIMFn",funcName:"unSubscribeEventsByType",done:ie.done});var ue=new V(ie);ue=ue.assembleEvent(),this.processCallback(ie),this.sendCmdWithResp("unSubscribeEventsByType",{msgEventSubscribe:ue},function(le,oe){ie.callback(le,oe)})},k.querySubscribeEventsByAccounts=function(ie){(ie=ie||{}).done=z({instance:this,className:"NIMFn",funcName:"querySubscribeEventsByAccounts",done:ie.done}),$.verifyOptions(ie,"accounts","event::querySubscribeEventsByAccounts"),$.verifyParamType("accounts",ie.accounts,"array","event::querySubscribeEventsByAccounts");var ue=new V(ie);ue=ue.assembleEvent(),this.processCallback(ie),this.batchSendEventsCmds("querySubscribeEventsByAccounts",{msgEventSubscribe:ue,accounts:ie.accounts},function(le,oe){!le&&oe&&(oe={msgEventSubscribes:oe}),ie.callback(le,oe)})},k.querySubscribeEventsByType=function(ie){(ie=ie||{}).done=z({instance:this,className:"NIMFn",funcName:"querySubscribeEventsByType",done:ie.done});var ue=new V(ie);ue=ue.assembleEvent(),this.processCallback(ie),this.sendCmdWithResp("querySubscribeEventsByType",{msgEventSubscribe:ue},function(le,oe){le||(oe={msgEventSubscribes:re(oe)}),ie.callback(le,oe)})}},function(t,r,e){var n=e(7),g=e(0),y=g.notundef,i=e(41);function k($){if(g.verifyOptions($,"type value","event::MsgEvent"),g.verifyParamType("type",$.type,"number","event::MsgEvent"),g.verifyParamType("value",$.value,"number","event::MsgEvent"),this.type=$.type,this.value=$.value,this.idClient=g.guid(),y($.custom)&&(this.custom=""+$.custom),this.validTime=$.validTime||604800,g.verifyParamType("validTime",this.validTime,"number","event::MsgEvent"),g.verifyParamMin("validTime",this.validTime,60,"event::MsgEvent"),g.verifyParamMax("validTime",this.validTime,604800,"event::MsgEvent"),y($.broadcastType)){var L;if(g.verifyParamType("broadcastType",$.broadcastType,"number","event::MsgEvent"),n(L=[1,2]).call(L,$.broadcastType)<0)throw new i('参数错误"broadcastType":只能为1或2');this.broadcastType=$.broadcastType}else this.broadcastType=2;y($.sync)?(g.verifyParamType("sync",$.sync,"boolean","event::MsgEvent"),this.sync=$.sync):this.sync=!1}k.prototype.assembleEvent=function(){return{type:this.type,value:this.value,idClient:this.idClient,custom:this.custom||"",validTime:this.validTime,broadcastType:this.broadcastType,sync:this.sync===!0?1:0}},t.exports=k},function(t,r,e){var n=e(0),g=n.notundef;function y(i){n.verifyOptions(i,"type","event::MsgEventSubscribe"),n.verifyParamType("type",i.type,"number","event::MsgEventSubscribe"),n.findObjIndexInArray([1,2,3],i.type)<0&&n.verifyParamMin("type",i.type,1e5,"event::MsgEventSubscribe"),this.type=i.type,g(i.subscribeTime)?(n.verifyParamType("subscribeTime",i.subscribeTime,"number","event::MsgEventSubscribe"),n.verifyParamMin("subscribeTime",i.subscribeTime,60,"event::MsgEventSubscribe"),n.verifyParamMax("subscribeTime",i.subscribeTime,2592e3,"event::MsgEventSubscribe"),this.subscribeTime=i.subscribeTime):this.subscribeTime=2592e3,g(i.sync)?(n.verifyParamType("sync",i.sync,"boolean","event::MsgEventSubscribe"),this.sync=i.sync):this.sync=!0}y.prototype.assembleEvent=function(){return{type:this.type,subscribeTime:this.subscribeTime,sync:this.sync===!0?1:0}},t.exports=y},function(t,r,e){var n=e(37),g=e(40).fn,y=e(0),i=e(25).reportAPI;g.httpRequestProxy=function(k){(k=k||{}).done=i({instance:this,className:"NIMFn",funcName:"httpRequestProxy",done:k.done}),y.verifyOptions(k,"path","misc::httpRequestProxy");var $=n({},k);delete $.done,this.processCallback(k),this.sendCmd("httpProxy",{proxyTag:$},k.callback)}},function(t,r,e){var n=e(40).fn,g=e(11),y=e(25).reportAPI;n.getQChatAddress=function(i){(i=i||{}).done=y({instance:this,className:"NIMFn",funcName:"getQChatAddress",done:i.done}),this.processCallback(i),this.sendCmd("getQChatAddress",{getQChatAddressTag:{ipType:g.ipVersion}},i.done)}},function(t,r,e){e(299);var n=e(197);e(311)(n),t.exports=n},function(t,r,e){var n=e(314),g=e(15),y=e(3),i=e(60),k=e(6),$=e(24),L=e(198).fn,V=e(11),z=e(157).V2NIMConnectStatus;L.connect=function(){V.isBrowser&&this.reporter.restore(),n(L).connect.call(this)},L.refreshSocketUrl=function(){var re;return this.socketUrlsBackup=this.socketUrlsBackup||[],this.socketUrls=g(re=this.socketUrlsBackup).call(re,0),this.logger.info("link::refreshSocketUrl"),this.statusProtector.emit("auth/loginLifeCycleAddressing"),y.resolve(this.socketUrls)},L.onHandshakeFailed=function(re,ie){var ue;this.reporter.report("chatroomLogin",{accid:this.account,roomId:this.options&&this.options.chatroomId,serverIps:this.options&&this.options.chatroomAddresses&&this.options.chatroomAddresses.join(","),currentServerIp:ie,rt:i()-re,result:408,failReason:"ws_handshake_failed",time:i(),net_connect:this.checkNetworkAvailable()}),this.logger.warn(k(ue="link::onHandshakeFailed: shandshake failed, startTime: ".concat(re,", targetUrl: ")).call(ue,ie))},L.onConnectFailed=function(re,ie,ue){var le,oe,ae=typeof re=="string"?"connect_failed:".concat(re):"connect_failed";this.reporter.report("chatroomLogin",{accid:this.account,roomId:this.options&&this.options.chatroomId,serverIps:this.options&&this.options.chatroomAddresses&&this.options.chatroomAddresses.join(","),currentServerIp:ue,rt:i()-ie,result:408,failReason:"ws_".concat(ae),time:i(),net_connect:this.checkNetworkAvailable()}),this.logger.warn(k(le=k(oe="link::onConnectFailed: connect failed due to ".concat(re,", startTime: ")).call(oe,ie,", targetUrl: ")).call(le,ue))},L.onSocketError=function(re,ie,ue){var le,oe,ae=typeof re=="string"?"socket.io error:".concat(re):"socket.io error";this.reporter.report("chatroomLogin",{accid:this.account,roomId:this.options&&this.options.chatroomId,serverIps:this.options&&this.options.chatroomAddresses&&this.options.chatroomAddresses.join(","),currentServerIp:ue,rt:i()-ie,result:408,failReason:"ws_".concat(ae),time:i(),net_connect:this.checkNetworkAvailable()}),this.logger.warn(k(le=k(oe="link::onSocketError: due to ".concat(re,", startTime: ")).call(oe,ie,", targetUrl: ")).call(le,ue))},L.notifyDisconnect=function(re){n(L).notifyDisconnect.call(this,re)},L.disconnect=function(){var re=this,ie=arguments.length>0&&arguments[0]!==void 0?arguments[0]:function(){};if(this.isConnected())return this.sendCmd("logout"),void $(function(){n(L).disconnect.call(re,ie)},0);this.connecting?this.logger.warn("ChatroomProtocolFn api disconnect:: connecting but exiting"):this.statusProtector.getConnectStatus()!==z.V2NIM_CONNECT_STATUS_DISCONNECTED?this.logger.warn("ChatroomProtocolFn api disconnect:: has tried to disconnect actively"):this.logger.warn("ChatroomProtocolFn api disconnect:: other logic entered");var ue=n(L);ue.disconnect.call(this,ie)}},function(t,r,e){var n=e(57),g=e(51),y=e(58),i=e(8),k=e(60),$=e(3),L=e(26),V=e(4),z=e(52),re=e(16),ie=e(53),ue=e(2),le=e(54),oe=e(55),ae=e(43);function qe(jt,Et){var ir=V(jt);if(z){var dr=z(jt);Et&&(dr=re(dr).call(dr,function(Dt){return ie(jt,Dt).enumerable})),ir.push.apply(ir,dr)}return ir}function de(jt){for(var Et=1;Et<arguments.length;Et++){var ir,dr,Dt=arguments[Et]!=null?arguments[Et]:{};Et%2?ue(ir=qe(Object(Dt),!0)).call(ir,function(lr){g(jt,lr,Dt[lr])}):le?oe(jt,le(Dt)):ue(dr=qe(Object(Dt))).call(dr,function(lr){ae(jt,lr,ie(Dt,lr))})}return jt}var Ne=e(198).fn,ze=e(45),$e=e(0);function Lt(jt){var Et=this;if(jt.code===398)return this.logger.warn("pendingLoginFailed:398 try to reconnect socket link，backoff set min 5s"),Et.forceDisconnect(),Et.backoff.setMin(5e3),void(Et.retryCount===0?Et.refreshSocketUrl():$.resolve()).then(function(){var ir;Et.reconnect({allFailedCB:L(ir=function(dr){this.logger.error("pendingLoginFailed: ",dr.code,dr),this.onAuthError(dr,"link::onLoginReconnectFailed")}).call(ir,Et,jt)})});this.logger.error("pendingLoginFailed: ",jt.code,jt),Et.onAuthError(jt,"link::onLogin")}Ne.assembleLogin=function(){var jt=this.options;this.sdkSession=this.genSessionKey();var Et={appKey:jt.appKey,account:jt.account,deviceId:ze.deviceId,chatroomId:jt.chatroomId,session:this.sdkSession,appLogin:this.autoconnect?1:0},ir=!0;if(jt.loc_x===void 0||jt.loc_y===void 0||jt.loc_z===void 0?ir=!1:(typeof jt.loc_x!="number"&&(jt.loc_x=0),typeof jt.loc_y!="number"&&(jt.loc_y=0),typeof jt.loc_z!="number"&&(jt.loc_z=0)),jt.authType=jt.loginAuthType,Et=$e.merge(Et,$e.filterObj(jt,ir?"chatroomNick chatroomAvatar chatroomCustom chatroomEnterCustom isAnonymous notifyTargetTags loginAuthType loginExt loc_x loc_y loc_z distance antiSpamBusinessId":"chatroomNick chatroomAvatar chatroomCustom chatroomEnterCustom isAnonymous notifyTargetTags loginAuthType loginExt distance antiSpamBusinessId")),jt.tags&&jt.tags.length>0)try{Et.tags=i(jt.tags)}catch(dr){this.logger.error("assembleLogin::format tags error",jt.tags,dr)}return{type:1,login:Et,imLogin:this.assembleIMLogin()}},Ne.login=y(n.mark(function jt(){var Et,ir,dr,Dt=this;return n.wrap(function(lr){for(;;)switch(lr.prev=lr.next){case 0:return Et=this,lr.next=3,Et.assembleLogin();case 3:if(ir=lr.sent,!(dr=this.socket&&this.socket.socket&&this.socket.socket.sessionid)){lr.next=13;break}if(this.socketIds||(this.socketIds={}),!this.socketIds[dr]){lr.next=10;break}return this.logger.warn("onConnect::repeat login",dr),lr.abrupt("return");case 10:this.socketIds[dr]=!0,lr.next=14;break;case 13:this.logger.warn("onConnect:: no socketId ",this.socket&&this.socket.socket);case 14:this.logger.warn("link::doLogin: "+dr+" appLogin is "+ir.login.appLogin),Et.createLoginTime=k(),Et.sendCmd("login",de({},ir),function(sr,er){if(sr)Et.reporter.report("chatroomLogin",{accid:Et.account,roomId:Et.options&&Et.options.chatroomId,serverIps:Et.options&&Et.options.chatroomAddresses&&Et.options.chatroomAddresses.join(","),currentServerIp:Et.url,rt:k()-Et.createLoginTime,result:sr?sr.code:408,failReason:sr?sr.message:"",time:k(),net_connect:Et.checkNetworkAvailable()}),Lt.call(Et,sr),Et.statusProtector.emit("auth/loginLifeCycleLoginFail",sr);else if(Et.reporter.report("chatroomLogin",{accid:Et.account,roomId:Et.options&&Et.options.chatroomId,serverIps:Et.options&&Et.options.chatroomAddresses&&Et.options.chatroomAddresses.join(","),currentServerIp:Et.url,rt:k()-Et.createLoginTime,result:200,failReason:"",time:k(),net_connect:Et.checkNetworkAvailable()}),Et.resetReconnectStatus(),Dt.heartbeatFail=0,Dt.hasLogin=!0,Dt.autoconnect=!0,Et.startHeartbeat(),Et.initOnlineListener(),Et.statusProtector.emit("auth/loginLifeCycleLoginSucc"),Et.keepNosSafeUrl)Et.afterLogin(er);else{var cr=[];Et.parser.checkObjSafeUrl(er,cr,[]),$.all(cr).then(function(){Et.afterLogin(er)}).catch(function(){Et.afterLogin(er)})}});case 17:case"end":return lr.stop()}},jt,this)})),Ne.afterLogin=function(jt){var Et=jt.chatroom;this.sendCmd("getNosCdnHost",{}),this.chatroom=Et,this.notifyLogin(jt)},Ne.kickedReasons=["","chatroomClosed","managerKick","samePlatformKick","silentlyKick","blacked"],Ne.kickedMessages=["","聊天室关闭了","被房主或者管理员踢出","不允许同一个帐号在多个地方同时登录","悄悄被踢","被拉黑了"]},function(t,r,e){var n=e(10),g=e(24),y=e(71),i=e(2),k=e(48),$=e(37),L=e(15),V=e(32),z=e(126),re=e(4),ie=e(198).fn,ue=e(0),le=e(11),oe=e(891),ae=e(768),qe=e(896),de=e(897),Ne=e(898);ie.completeMsg=function(ze){ze.chatroomId=this.chatroom&&this.chatroom.id,ze.from=this.options.account,ze.fromClientType="Web",ze.time||(ze.time=+new Date)},ie.amendMsg=function(ze){return ze},ie.onMsg=function(ze){var $e,Lt=n($e=this.message).call($e,ze.content.msg);if(this.checkMsgUnique(Lt)){if(Lt.__handleTime=this.reporterHook.getSafeClock(),Lt.__receiveTime=ze.__receiveTime,ue.get(ze,"content.msg.__clientExt"))try{Lt.__clientExt=JSON.parse(ze.content.msg.__clientExt)}catch{this.logger.warn("ChatroomProtocolFn:onMsg __clientExt parse failed ".concat(ze.content.msg.__clientExt))}this.msgBuffer.push(Lt),this.msgFlushTimer||this.startMsgFlushTimer(),ze&&ze.content&&ze.content.msg&&ze.content.msg.needHighPriorityMsgAck==="1"&&this.sendCmd("sendChatroomMsgAck",{chatRoomMsgAckTag:{idClient:Lt.idClient,chatroomId:Lt.chatroomId}})}else this.logger.warn("onMsg::msg::repeat",Lt.idClient)},ie.startMsgFlushTimer=function(){var ze=this,$e=ze.options;ze.msgFlushTimer=g(function(){var Lt,jt=y(Lt=ze.msgBuffer).call(Lt,0,$e.msgBufferSize);if(le.isBrowser){var Et=ze.reporterHook.getSafeClock();i(jt).call(jt,function(ir){if(ir.flow!=="out"){var dr={msgId:ir.idServer,clientId:ir.idClient,receiveTime:ze.reporterHook.getNTPTime(ir.__receiveTime),serverTime:ir.time,callbackTime:ze.reporterHook.getNTPTime(Et),preHandleTime:ze.reporterHook.getNTPTime(ir.__handleTime),fromAccid:ir.from,toAccid:ze.options.account,type:4,tid:"",roomId:ir.chatroomId,result:200,failReason:"",rt:k(Et-ir.__receiveTime)},Dt=ue.get(ir,"__clientExt.statistics.apiCallingTime"),lr=ue.get(ir,"__clientExt.statistics.sendTime");Dt&&lr&&(dr.apiCallingTime=Dt,dr.sendTime=lr,dr.attachUploadDuration=ue.get(ir,"__clientExt.statistics.attachUploadDuration")||0),ze.reporter&&ze.reporter.report("msgReceive",dr)}delete ir.__handleTime,delete ir.__receiveTime,delete ir.__clientExt})}ze.options.onmsgs(jt),ze.msgBuffer.length?ze.startMsgFlushTimer():delete ze.msgFlushTimer},$e.msgBufferInterval)},ie.checkMsgUnique=ue.genCheckUniqueFunc("idClient"),ie.onSendMsg=function(ze){var $e,Lt=ze.obj.msg;ze.error?Lt.status="fail":(Lt=ze.content.msg).status="success",$(Lt,ze.obj.msg),Lt=n($e=this.message).call($e,Lt),this.checkMsgUnique(Lt),ze.obj=Lt},ie.onHistoryMsgs=function(ze){ze.error||(ze.obj||(ze.obj={}),ze.obj.msgs=this.message.reverseMsgs(ze.content.msgs))},ie.onCdnMsgInfo=function(ze){if(ze){ze.cdnUrls&&(ze.cdnUrls=ze.cdnUrls.split("|")),ze.interval&&(ze.interval=1e3*k(ze.interval)),ze.timeout&&(ze.timeout=+ze.timeout),ze.enable&&(ze.enable=+ze.enable),ze.timestamp&&(ze.timestamp=+ze.timestamp,this.correctCdnTime(ze.timestamp));var $e=!this.cdnInfo.enable&&ze.enable;$(this.cdnInfo,ze),$e&&this.queryCdnMsgs()}},ie.correctCdnTime=function(ze){ze&&typeof ze=="number"&&(this.cdnInfo||(this.cdnInfo={}),this.cdnInfo.timestamp=ze,this.cdnInfo.localTime=+new Date,this.cdnInfo.lastNow=null,this.logger.info("correctCdnTime: timestamp, localTime",ze,this.cdnInfo.localTime,new Date(ze),new Date(this.cdnInfo.localTime)))},ie.queryCdnMsgs=function(ze){var $e,Lt=this;if(this.cdnInfo&&this.cdnInfo.enable&&this.isConnected()){this.queryCdnTimer=g(function(){return Lt.queryCdnMsgs()},this.cdnInfo.interval);var jt=+new Date;if(jt=jt-this.cdnInfo.localTime+this.cdnInfo.timestamp,jt-=jt%this.cdnInfo.interval,this.cdnInfo.lastNow!==jt&&this.cdnInfo.cdnUrls&&this.cdnInfo.cdnUrls.length){this.cdnInfo.cdnUrls.push(this.cdnInfo.cdnUrls.shift());var Et=this,ir=this.cdnInfo.decryptKey,dr=this.cdnInfo.timeout||Math.ceil(this.cdnInfo.interval/2),Dt=L($e=this.cdnInfo.cdnUrls).call($e,0);ze=ze||0,function lr(){if(ze>=3)return void Et.finalFail++;if(Dt.length){var sr=Dt.shift().replace("#time",jt),er=sr.split("/")[2],cr=+new Date;Et.adaptersRequest(sr,{timeout:dr,onload:function(or){if(Et.cdnInfo.lastNow>jt)Et.logger.warn("queryCdnMsgs::doQuery cdnInfo.lastNow > now, will throw data ",Et.cdnInfo.lastNow,jt,or);else{Et.cdnInfo.lastNow=jt,Et.afterQueryCdn(er,+new Date-cr,!0);try{or=JSON.parse(or)}catch(Er){Et.logger.warn("queryCdnMsgs::doQuery::onload parse res error: ",Er)}if(or&&or.data){or.ptm&&(Et.cdnInfo.timeout=or.ptm),or.pis&&(Et.cdnInfo.interval=1e3*or.pis);var hr,pr,Sr=or.e===!0?(hr=or.data,pr=ir,oe.decrypt(hr,ae.parse(pr),{mode:qe,padding:de}).toString(Ne)):or.data;Et.onCdnMsgsSmoothly(Sr,jt,1e3*or.c)}}},onerror:function(or){if(ze++,Et.afterQueryCdn(er,+new Date-cr,!1),or.status===404){var hr;try{var pr=JSON.parse(or.result);pr.code===404&&pr.timestamp&&(hr=pr.timestamp)}catch(Sr){Et.logger.warn("queryCdnMsgs::doQuery::parse 404 result error",Sr,or)}!hr&&or.date&&(hr=+new Date(or.date)),hr&&(Et.correctCdnTime(hr),clearTimeout(Et.queryCdnTimer),Et.queryCdnMsgs(ze))}else lr()}},{exception_service:8})}}()}}},ie.onCdnMsgsSmoothly=function(ze,$e,Lt){try{ze=JSON.parse(ze)}catch(Dt){this.logger.warn("onCdnMsgsSmoothly::JSON.parse error",Dt)}if(this.logger.info("receive cdn msgs "+ze.length+" and request time is "+new Date($e)),V(ze)&&ze.length){var jt=this,Et=this.options.msgBufferInterval,ir=Math.ceil(ze.length*Et/Lt);dr(),clearInterval(jt.cdnSmoothTimer),jt.cdnSmoothTimer=z(function(){return dr()},Et)}function dr(){if(jt.isConnected()){var Dt=y(ze).call(ze,0,ir);i(Dt).call(Dt,function(lr){var sr=jt.parser.syncUnserialize(lr,"msg");jt.onMsg({content:{msg:sr}})}),ze.length||clearInterval(jt.cdnSmoothTimer)}}},ie.resetCdnData=function(){this.cdnData={},this.finalFail=0,this.cdnDataTime=+new Date},ie.initCdnData=function(){this.resetCdnData(),ue.isFunction(this.options.onCdnRequestData)?(this.options.cdnRequestDataInterval=this.options.cdnRequestDataInterval||3e4,this.afterQueryCdn=function(ze,$e,Lt){var jt,Et=this;this.cdnData[ze]||(this.cdnData[ze]={success:0,fail:0,sr:0,fr:0,smr:0,fmr:0}),Lt?(this.cdnData[ze].success++,this.cdnData[ze].sr+=$e,$e>this.cdnData[ze].smr&&(this.cdnData[ze].smr=$e)):(this.cdnData[ze].fail++,this.cdnData[ze].fr+=$e,$e>this.cdnData[ze].fmr&&(this.cdnData[ze].fmr=$e)),+new Date-this.cdnDataTime<this.options.cdnRequestDataInterval||(i(jt=re(this.cdnData)).call(jt,function(ir){Et.cdnData[ir].sr=Et.cdnData[ir].sr/Et.cdnData[ir].success||0,Et.cdnData[ir].fr=Et.cdnData[ir].fr/Et.cdnData[ir].fail||0}),this.options.onCdnRequestData($({},this.cdnData),this.finalFail),this.resetCdnData())}):this.afterQueryCdn=function(){}}},function(t,r,e){var n;t.exports=(n=e(94),e(768),e(893),e(769),e(313),function(){var g=n,y=g.lib.BlockCipher,i=g.algo,k=[],$=[],L=[],V=[],z=[],re=[],ie=[],ue=[],le=[],oe=[];(function(){for(var de=[],Ne=0;Ne<256;Ne++)de[Ne]=Ne<128?Ne<<1:Ne<<1^283;var ze=0,$e=0;for(Ne=0;Ne<256;Ne++){var Lt=$e^$e<<1^$e<<2^$e<<3^$e<<4;Lt=Lt>>>8^255&Lt^99,k[ze]=Lt,$[Lt]=ze;var jt=de[ze],Et=de[jt],ir=de[Et],dr=257*de[Lt]^16843008*Lt;L[ze]=dr<<24|dr>>>8,V[ze]=dr<<16|dr>>>16,z[ze]=dr<<8|dr>>>24,re[ze]=dr,dr=16843009*ir^65537*Et^257*jt^16843008*ze,ie[Lt]=dr<<24|dr>>>8,ue[Lt]=dr<<16|dr>>>16,le[Lt]=dr<<8|dr>>>24,oe[Lt]=dr,ze?(ze=jt^de[de[de[ir^jt]]],$e^=de[de[$e]]):ze=$e=1}})();var ae=[0,1,2,4,8,16,32,64,128,27,54],qe=i.AES=y.extend({_doReset:function(){if(!this._nRounds||this._keyPriorReset!==this._key){for(var de=this._keyPriorReset=this._key,Ne=de.words,ze=de.sigBytes/4,$e=4*((this._nRounds=ze+6)+1),Lt=this._keySchedule=[],jt=0;jt<$e;jt++)jt<ze?Lt[jt]=Ne[jt]:(dr=Lt[jt-1],jt%ze?ze>6&&jt%ze==4&&(dr=k[dr>>>24]<<24|k[dr>>>16&255]<<16|k[dr>>>8&255]<<8|k[255&dr]):(dr=k[(dr=dr<<8|dr>>>24)>>>24]<<24|k[dr>>>16&255]<<16|k[dr>>>8&255]<<8|k[255&dr],dr^=ae[jt/ze|0]<<24),Lt[jt]=Lt[jt-ze]^dr);for(var Et=this._invKeySchedule=[],ir=0;ir<$e;ir++){if(jt=$e-ir,ir%4)var dr=Lt[jt];else dr=Lt[jt-4];Et[ir]=ir<4||jt<=4?dr:ie[k[dr>>>24]]^ue[k[dr>>>16&255]]^le[k[dr>>>8&255]]^oe[k[255&dr]]}}},encryptBlock:function(de,Ne){this._doCryptBlock(de,Ne,this._keySchedule,L,V,z,re,k)},decryptBlock:function(de,Ne){var ze=de[Ne+1];de[Ne+1]=de[Ne+3],de[Ne+3]=ze,this._doCryptBlock(de,Ne,this._invKeySchedule,ie,ue,le,oe,$),ze=de[Ne+1],de[Ne+1]=de[Ne+3],de[Ne+3]=ze},_doCryptBlock:function(de,Ne,ze,$e,Lt,jt,Et,ir){for(var dr=this._nRounds,Dt=de[Ne]^ze[0],lr=de[Ne+1]^ze[1],sr=de[Ne+2]^ze[2],er=de[Ne+3]^ze[3],cr=4,or=1;or<dr;or++){var hr=$e[Dt>>>24]^Lt[lr>>>16&255]^jt[sr>>>8&255]^Et[255&er]^ze[cr++],pr=$e[lr>>>24]^Lt[sr>>>16&255]^jt[er>>>8&255]^Et[255&Dt]^ze[cr++],Sr=$e[sr>>>24]^Lt[er>>>16&255]^jt[Dt>>>8&255]^Et[255&lr]^ze[cr++],Er=$e[er>>>24]^Lt[Dt>>>16&255]^jt[lr>>>8&255]^Et[255&sr]^ze[cr++];Dt=hr,lr=pr,sr=Sr,er=Er}hr=(ir[Dt>>>24]<<24|ir[lr>>>16&255]<<16|ir[sr>>>8&255]<<8|ir[255&er])^ze[cr++],pr=(ir[lr>>>24]<<24|ir[sr>>>16&255]<<16|ir[er>>>8&255]<<8|ir[255&Dt])^ze[cr++],Sr=(ir[sr>>>24]<<24|ir[er>>>16&255]<<16|ir[Dt>>>8&255]<<8|ir[255&lr])^ze[cr++],Er=(ir[er>>>24]<<24|ir[Dt>>>16&255]<<16|ir[lr>>>8&255]<<8|ir[255&sr])^ze[cr++],de[Ne]=hr,de[Ne+1]=pr,de[Ne+2]=Sr,de[Ne+3]=Er},keySize:8});g.AES=y._createHelper(qe)}(),n.AES)},function(t,r){},function(t,r,e){var n;t.exports=(n=e(94),function(g){var y=n,i=y.lib,k=i.WordArray,$=i.Hasher,L=y.algo,V=[];(function(){for(var oe=0;oe<64;oe++)V[oe]=4294967296*g.abs(g.sin(oe+1))|0})();var z=L.MD5=$.extend({_doReset:function(){this._hash=new k.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(oe,ae){for(var qe=0;qe<16;qe++){var de=ae+qe,Ne=oe[de];oe[de]=16711935&(Ne<<8|Ne>>>24)|4278255360&(Ne<<24|Ne>>>8)}var ze=this._hash.words,$e=oe[ae+0],Lt=oe[ae+1],jt=oe[ae+2],Et=oe[ae+3],ir=oe[ae+4],dr=oe[ae+5],Dt=oe[ae+6],lr=oe[ae+7],sr=oe[ae+8],er=oe[ae+9],cr=oe[ae+10],or=oe[ae+11],hr=oe[ae+12],pr=oe[ae+13],Sr=oe[ae+14],Er=oe[ae+15],Pr=ze[0],Cr=ze[1],rr=ze[2],kr=ze[3];Pr=re(Pr,Cr,rr,kr,$e,7,V[0]),kr=re(kr,Pr,Cr,rr,Lt,12,V[1]),rr=re(rr,kr,Pr,Cr,jt,17,V[2]),Cr=re(Cr,rr,kr,Pr,Et,22,V[3]),Pr=re(Pr,Cr,rr,kr,ir,7,V[4]),kr=re(kr,Pr,Cr,rr,dr,12,V[5]),rr=re(rr,kr,Pr,Cr,Dt,17,V[6]),Cr=re(Cr,rr,kr,Pr,lr,22,V[7]),Pr=re(Pr,Cr,rr,kr,sr,7,V[8]),kr=re(kr,Pr,Cr,rr,er,12,V[9]),rr=re(rr,kr,Pr,Cr,cr,17,V[10]),Cr=re(Cr,rr,kr,Pr,or,22,V[11]),Pr=re(Pr,Cr,rr,kr,hr,7,V[12]),kr=re(kr,Pr,Cr,rr,pr,12,V[13]),rr=re(rr,kr,Pr,Cr,Sr,17,V[14]),Pr=ie(Pr,Cr=re(Cr,rr,kr,Pr,Er,22,V[15]),rr,kr,Lt,5,V[16]),kr=ie(kr,Pr,Cr,rr,Dt,9,V[17]),rr=ie(rr,kr,Pr,Cr,or,14,V[18]),Cr=ie(Cr,rr,kr,Pr,$e,20,V[19]),Pr=ie(Pr,Cr,rr,kr,dr,5,V[20]),kr=ie(kr,Pr,Cr,rr,cr,9,V[21]),rr=ie(rr,kr,Pr,Cr,Er,14,V[22]),Cr=ie(Cr,rr,kr,Pr,ir,20,V[23]),Pr=ie(Pr,Cr,rr,kr,er,5,V[24]),kr=ie(kr,Pr,Cr,rr,Sr,9,V[25]),rr=ie(rr,kr,Pr,Cr,Et,14,V[26]),Cr=ie(Cr,rr,kr,Pr,sr,20,V[27]),Pr=ie(Pr,Cr,rr,kr,pr,5,V[28]),kr=ie(kr,Pr,Cr,rr,jt,9,V[29]),rr=ie(rr,kr,Pr,Cr,lr,14,V[30]),Pr=ue(Pr,Cr=ie(Cr,rr,kr,Pr,hr,20,V[31]),rr,kr,dr,4,V[32]),kr=ue(kr,Pr,Cr,rr,sr,11,V[33]),rr=ue(rr,kr,Pr,Cr,or,16,V[34]),Cr=ue(Cr,rr,kr,Pr,Sr,23,V[35]),Pr=ue(Pr,Cr,rr,kr,Lt,4,V[36]),kr=ue(kr,Pr,Cr,rr,ir,11,V[37]),rr=ue(rr,kr,Pr,Cr,lr,16,V[38]),Cr=ue(Cr,rr,kr,Pr,cr,23,V[39]),Pr=ue(Pr,Cr,rr,kr,pr,4,V[40]),kr=ue(kr,Pr,Cr,rr,$e,11,V[41]),rr=ue(rr,kr,Pr,Cr,Et,16,V[42]),Cr=ue(Cr,rr,kr,Pr,Dt,23,V[43]),Pr=ue(Pr,Cr,rr,kr,er,4,V[44]),kr=ue(kr,Pr,Cr,rr,hr,11,V[45]),rr=ue(rr,kr,Pr,Cr,Er,16,V[46]),Pr=le(Pr,Cr=ue(Cr,rr,kr,Pr,jt,23,V[47]),rr,kr,$e,6,V[48]),kr=le(kr,Pr,Cr,rr,lr,10,V[49]),rr=le(rr,kr,Pr,Cr,Sr,15,V[50]),Cr=le(Cr,rr,kr,Pr,dr,21,V[51]),Pr=le(Pr,Cr,rr,kr,hr,6,V[52]),kr=le(kr,Pr,Cr,rr,Et,10,V[53]),rr=le(rr,kr,Pr,Cr,cr,15,V[54]),Cr=le(Cr,rr,kr,Pr,Lt,21,V[55]),Pr=le(Pr,Cr,rr,kr,sr,6,V[56]),kr=le(kr,Pr,Cr,rr,Er,10,V[57]),rr=le(rr,kr,Pr,Cr,Dt,15,V[58]),Cr=le(Cr,rr,kr,Pr,pr,21,V[59]),Pr=le(Pr,Cr,rr,kr,ir,6,V[60]),kr=le(kr,Pr,Cr,rr,or,10,V[61]),rr=le(rr,kr,Pr,Cr,jt,15,V[62]),Cr=le(Cr,rr,kr,Pr,er,21,V[63]),ze[0]=ze[0]+Pr|0,ze[1]=ze[1]+Cr|0,ze[2]=ze[2]+rr|0,ze[3]=ze[3]+kr|0},_doFinalize:function(){var oe=this._data,ae=oe.words,qe=8*this._nDataBytes,de=8*oe.sigBytes;ae[de>>>5]|=128<<24-de%32;var Ne=g.floor(qe/4294967296),ze=qe;ae[15+(de+64>>>9<<4)]=16711935&(Ne<<8|Ne>>>24)|4278255360&(Ne<<24|Ne>>>8),ae[14+(de+64>>>9<<4)]=16711935&(ze<<8|ze>>>24)|4278255360&(ze<<24|ze>>>8),oe.sigBytes=4*(ae.length+1),this._process();for(var $e=this._hash,Lt=$e.words,jt=0;jt<4;jt++){var Et=Lt[jt];Lt[jt]=16711935&(Et<<8|Et>>>24)|4278255360&(Et<<24|Et>>>8)}return $e},clone:function(){var oe=$.clone.call(this);return oe._hash=this._hash.clone(),oe}});function re(oe,ae,qe,de,Ne,ze,$e){var Lt=oe+(ae&qe|~ae&de)+Ne+$e;return(Lt<<ze|Lt>>>32-ze)+ae}function ie(oe,ae,qe,de,Ne,ze,$e){var Lt=oe+(ae&de|qe&~de)+Ne+$e;return(Lt<<ze|Lt>>>32-ze)+ae}function ue(oe,ae,qe,de,Ne,ze,$e){var Lt=oe+(ae^qe^de)+Ne+$e;return(Lt<<ze|Lt>>>32-ze)+ae}function le(oe,ae,qe,de,Ne,ze,$e){var Lt=oe+(qe^(ae|~de))+Ne+$e;return(Lt<<ze|Lt>>>32-ze)+ae}y.MD5=$._createHelper(z),y.HmacMD5=$._createHmacHelper(z)}(Math),n.MD5)},function(t,r,e){var n,g,y,i,k,$,L,V;t.exports=(V=e(94),g=(n=V).lib,y=g.WordArray,i=g.Hasher,k=n.algo,$=[],L=k.SHA1=i.extend({_doReset:function(){this._hash=new y.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(z,re){for(var ie=this._hash.words,ue=ie[0],le=ie[1],oe=ie[2],ae=ie[3],qe=ie[4],de=0;de<80;de++){if(de<16)$[de]=0|z[re+de];else{var Ne=$[de-3]^$[de-8]^$[de-14]^$[de-16];$[de]=Ne<<1|Ne>>>31}var ze=(ue<<5|ue>>>27)+qe+$[de];ze+=de<20?1518500249+(le&oe|~le&ae):de<40?1859775393+(le^oe^ae):de<60?(le&oe|le&ae|oe&ae)-1894007588:(le^oe^ae)-899497514,qe=ae,ae=oe,oe=le<<30|le>>>2,le=ue,ue=ze}ie[0]=ie[0]+ue|0,ie[1]=ie[1]+le|0,ie[2]=ie[2]+oe|0,ie[3]=ie[3]+ae|0,ie[4]=ie[4]+qe|0},_doFinalize:function(){var z=this._data,re=z.words,ie=8*this._nDataBytes,ue=8*z.sigBytes;return re[ue>>>5]|=128<<24-ue%32,re[14+(ue+64>>>9<<4)]=Math.floor(ie/4294967296),re[15+(ue+64>>>9<<4)]=ie,z.sigBytes=4*re.length,this._process(),this._hash},clone:function(){var z=i.clone.call(this);return z._hash=this._hash.clone(),z}}),n.SHA1=i._createHelper(L),n.HmacSHA1=i._createHmacHelper(L),V.SHA1)},function(t,r,e){var n,g,y,i;t.exports=(n=e(94),y=(g=n).lib.Base,i=g.enc.Utf8,void(g.algo.HMAC=y.extend({init:function(k,$){k=this._hasher=new k.init,typeof $=="string"&&($=i.parse($));var L=k.blockSize,V=4*L;$.sigBytes>V&&($=k.finalize($)),$.clamp();for(var z=this._oKey=$.clone(),re=this._iKey=$.clone(),ie=z.words,ue=re.words,le=0;le<L;le++)ie[le]^=1549556828,ue[le]^=909522486;z.sigBytes=re.sigBytes=V,this.reset()},reset:function(){var k=this._hasher;k.reset(),k.update(this._iKey)},update:function(k){return this._hasher.update(k),this},finalize:function(k){var $=this._hasher,L=$.finalize(k);return $.reset(),$.finalize(this._oKey.clone().concat(L))}})))},function(t,r,e){var n,g;t.exports=(g=e(94),e(313),g.mode.ECB=((n=g.lib.BlockCipherMode.extend()).Encryptor=n.extend({processBlock:function(y,i){this._cipher.encryptBlock(y,i)}}),n.Decryptor=n.extend({processBlock:function(y,i){this._cipher.decryptBlock(y,i)}}),n),g.mode.ECB)},function(t,r,e){var n;t.exports=(n=e(94),e(313),n.pad.Pkcs7)},function(t,r,e){var n;t.exports=(n=e(94),n.enc.Utf8)},function(t,r,e){var n=e(10),g=e(198).fn,y=e(312);g.onChatroomMembersInfo=g.onChatroomMembers=function(i){i.error||(i.obj.members=y.reverseMembers(i.content.members))},g.onGetChatroomMemberCountByTag=function(i){i.error||(i.obj=i.content)},g.onMarkChatroomMember=function(i){i.error||(i.obj.member=n(y).call(y,i.content.chatroomMember))},g.onSyncRobot=function(i){!i.error&&this.options.onrobots?this.options.onrobots(null,i.content):this.ontions.onrobots(i.error,{})}},function(t,r,e){var n=e(10),g=e(9),y=e(0),i=function(oe){this.account=oe.account},k=i.prototype,$=k.Message=e(119),L=k.TextMessage=e(901),V=k.FileMessage=e(206),z=k.GeoMessage=e(905),re=k.NotificationMessage=e(906),ie=k.CustomMessage=e(907),ue=k.TipMessage=e(908),le=k.RobotMessage=e(909);k.validTypes=$.validTypes,k.reverse=function(oe){var ae;switch($.getType(oe)){case"text":ae=n(L).call(L,oe);break;case"image":case"audio":case"video":case"file":ae=n(V).call(V,oe);break;case"geo":ae=n(z).call(z,oe);break;case"notification":ae=n(re).call(re,oe);break;case"custom":ae=n(ie).call(ie,oe);break;case"tip":ae=n(ue).call(ue,oe);break;case"robot":ae=n(le).call(le,oe);break;default:ae=n($).call($,oe)}return $.setExtra(ae,this.account),ae},k.reverseMsgs=function(oe,ae){var qe,de,Ne=this;return g(oe).call(oe,function(ze){return ze=n(Ne).call(Ne,ze),ae&&((qe=ae.modifyObj)&&(ze=y.merge(ze,qe)),de=ae.mapper,y.isFunction(de)&&(ze=de(ze))),ze})},t.exports=i},function(t,r,e){var n=e(18),g=e(10),y=e(119),i=e(0);function k($){i.verifyOptions($,"text","msg::TextMessage"),$.type="text",y.call(this,$),this.attach=$.text,this.body=""}k.prototype=n(y.prototype),k.reverse=function($){var L=g(y).call(y,$);return L.text=$.attach,L},t.exports=k},function(t,r,e){var n=e(18),g=e(0),y=e(206);function i(){}i.prototype=n(y.prototype),i.verifyFile=function(k,$){g.verifyOptions(k,"w h",!0,"file.",$)},t.exports=i},function(t,r,e){var n=e(18),g=e(206),y=e(0);function i(){}i.prototype=n(g.prototype),i.verifyFile=function(k,$){y.verifyOptions(k,"dur",!0,"file.",$)},t.exports=i},function(t,r,e){var n=e(18),g=e(206),y=e(0);function i(){}i.prototype=n(g.prototype),i.verifyFile=function(k,$){y.verifyOptions(k,"dur w h",!0,"file.",$)},t.exports=i},function(t,r,e){var n=e(8),g=e(18),y=e(10),i=e(119),k=e(0);function $(L){L.type="geo",k.verifyOptions(L,"geo","msg::GeoMessage"),k.verifyOptions(L.geo,"lng lat title",!0,"geo.","msg::GeoMessage"),k.verifyParamType("geo.lng",L.geo.lng,"number","msg::GeoMessage"),k.verifyParamType("geo.lat",L.geo.lat,"number","msg::GeoMessage"),k.verifyParamType("geo.title",L.geo.title,"string","msg::GeoMessage"),i.call(this,L),this.attach=n(L.geo)}$.prototype=g(i.prototype),$.reverse=function(L){var V=y(i).call(i,L);return L.attach=L.attach?""+L.attach:"",V.geo=L.attach?JSON.parse(L.attach):{},V},t.exports=$},function(t,r,e){var n=e(18),g=e(10),y=e(48),i=e(0).notundef,k=e(119),$={301:"memberEnter",302:"memberExit",303:"blackMember",304:"unblackMember",305:"gagMember",306:"ungagMember",307:"addManager",308:"removeManager",309:"addCommon",310:"removeCommon",311:"closeChatroom",312:"updateChatroom",313:"kickMember",314:"addTempMute",315:"removeTempMute",316:"updateMemberInfo",317:"updateQueue",318:"muteRoom",319:"unmuteRoom",320:"batchUpdateQueue",321:"addTempMuteTag",322:"removeTempMuteTag",324:"batchQueueOffer",323:"deleteChatroomMsg",325:"updateChatroomTags"};function L(){}L.prototype=n(k.prototype),L.reverse=function(V){var z=g(k).call(k,V);if(V.attach=V.attach?""+V.attach:"",V.attach){var re=JSON.parse(V.attach);if(z.attach={type:$[re.id]},i(re.data)){var ie=re.data;if(i(ie.operator)&&(z.attach.from=ie.operator),i(ie.opeNick)&&(z.attach.fromNick=ie.opeNick),i(ie.target)&&(z.attach.to=ie.target),i(ie.tarNick)&&(z.attach.toNick=ie.tarNick),i(ie.muteDuration)&&(z.attach.duration=y(ie.muteDuration,10)),i(ie.tags)&&(z.attach.tags=ie.tags),z.attach.type==="memberEnter"&&(i(ie.muted)?z.attach.gaged=+ie.muted==1:z.attach.gaged=!1,i(ie.tempMuted)?z.attach.tempMuted=+ie.tempMuted==1:z.attach.tempMuted=!1,i(ie.muteTtl)?z.attach.tempMuteDuration=+ie.muteTtl:z.attach.tempMuteDuration=0),z.attach.type==="deleteChatroomMsg"&&(z.attach.msgId=ie.msgId,z.attach.msgTime=ie.msgTime),i(ie.ext)&&(z.attach.custom=ie.ext),i(ie.queueChange)){var ue=JSON.parse(ie.queueChange);switch(ue._e){case"OFFER":z.attach.queueChange={type:"OFFER",elementKey:ue.key,elementValue:ue.content};break;case"POLL":z.attach.queueChange={type:"POLL",elementKey:ue.key,elementValue:ue.content};break;case"DROP":z.attach.queueChange={type:"DROP"};break;case"PARTCLEAR":case"BATCH_UPDATE":z.attach.queueChange={type:ue._e,elementKv:ue.kvObject};break;case"BATCH_OFFER":z.attach.queueChange={type:ue._e,elements:ue.elements}}}}}else z.attach={};return z},t.exports=L},function(t,r,e){var n=e(8),g=e(18),y=e(10),i=e(119),k=e(0);function $(L){k.verifyOptions(L,"content","msg::CustomMessage"),L.type="custom",i.call(this,L),typeof L.content!="string"&&(L.content=n(L.content)),this.attach=L.content}$.prototype=g(i.prototype),$.reverse=function(L){var V=y(i).call(i,L);return V.content=L.attach,V},t.exports=$},function(t,r,e){var n=e(18),g=e(10),y=e(119),i=e(0);function k($){i.verifyOptions($,"tip","msg::TipMessage"),$.type="tip",y.call(this,$),this.attach=$.tip}k.prototype=n(y.prototype),k.reverse=function($){var L=g(y).call(y,$);return L.tip=$.attach,L},t.exports=k},function(t,r,e){var n=e(8),g=e(18),y=e(10),i=e(9),k=e(119),$=e(0),L={welcome:"00",text:"01",link:"03"},V={"01":"text","02":"image","03":"answer",11:"template"};function z(re){$.verifyOptions(re,"content","msg::RobotMessage");var ie=re.content;switch(ie.type){case"welcome":$.undef(re.body)&&(this.body="欢迎消息");break;case"text":$.verifyOptions(ie,"content","msg::RobotMessage"),$.undef(re.body)&&(this.body=ie.content);break;case"link":$.verifyOptions(ie,"target","msg::RobotMessage")}ie.type&&(ie.type=L[ie.type]),ie={param:ie,robotAccid:re.robotAccid},this.attach=n(ie),re.type="robot",k.call(this,re)}z.prototype=g(k.prototype),z.reverse=function(re){var ie=y(k).call(k,re);if(ie.type==="robot"){var ue=JSON.parse(re.attach);if(ue.param&&(ue.param.type=V[ue.param.type]||"unknown"),ue.robotMsg){var le=(ue=$.merge(ue,ue.robotMsg)).message;ue.flag==="bot"?ue.message=i(le).call(le,function(oe){return oe.type=V[oe.type]||"unknown",oe}):ue.flag,delete ue.robotMsg}ie.content=ue}return ie},t.exports=z},function(t,r,e){var n=e(10),g=e(32),y=e(9),i=e(16),k=e(8),$=e(0),L=$.undef,V=e(197).fn,z=e(25).reportAPI;V.beforeSendMsg=function(ie){ie.cmd="sendMsg"};var re={text:0,image:1,audio:2,video:3,geo:4,notification:5,file:6,tip:10,robot:11,custom:100};V.getHistoryMsgs=function(ie){if((ie=ie||{}).done=z({instance:this,className:"ChatroomFn",funcName:"getHistoryMsgs",done:ie.done}),$.verifyOptions(ie),L(ie.timetag)?ie.timetag=0:$.verifyParamType("timetag",ie.timetag,"number","msg::getHistoryMsgs"),L(ie.limit)?ie.limit=100:$.verifyParamType("limit",ie.limit,"number","msg::getHistoryMsgs"),L(n(ie))?ie.reverse=!1:$.verifyParamType("reverse",n(ie),"boolean","msg::getHistoryMsgs"),L(ie.msgTypes))ie.msgTypes=[];else if(g(ie.msgTypes)){var ue,le;ie.msgTypes=y(ue=ie.msgTypes).call(ue,function(oe){return re[oe]}),ie.msgTypes=i(le=ie.msgTypes).call(le,function(oe){return typeof oe=="number"})}else typeof re[ie.msgTypes]=="number"?ie.msgTypes=[re[ie.msgTypes]]:ie.msgTypes=[];this.processCallback(ie),this.sendCmd("getHistoryMsgs",ie,function(oe,ae,qe){g(qe)&&(qe=y(qe).call(qe,function(de){return re[de.type]&&(de.type=re[de.type]),de})),ie.callback(oe,ae,qe)})},V.getHistoryMsgsByTags=function(ie){if((ie=ie||{}).done=z({instance:this,className:"ChatroomFn",funcName:"getHistoryMsgsByTags",done:ie.done}),$.verifyOptions(ie,"tags","api::msg::getHistoryMsgsByTags"),$.verifyParamType("tags",ie.tags,"array","api::msg::getHistoryMsgsByTags"),L(ie.fromTime)?ie.fromTime=0:$.verifyParamType("fromTime",ie.fromTime,"number","api::msg::getHistoryMsgsByTags"),L(ie.toTime)?ie.toTime=0:$.verifyParamType("toTime",ie.toTime,"number","api::msg::getHistoryMsgsByTags"),L(ie.limit)?ie.limit=100:$.verifyParamType("limit",ie.limit,"number","msg::getHistoryMsgs"),L(n(ie))?ie.reverse=0:$.verifyParamType("reverse",n(ie),"number","msg::getHistoryMsgs"),L(ie.types))ie.types=[];else if(g(ie.types)){var ue,le;ie.types=y(ue=ie.types).call(ue,function(oe){return re[oe]}),ie.types=i(le=ie.types).call(le,function(oe){return typeof oe=="number"})}else typeof re[ie.types]=="number"?ie.types=[re[ie.types]]:ie.types=[];this.processCallback(ie),ie.types=k(ie.types),ie.tags=k(ie.tags),this.sendCmd("getHistoryMsgsByTags",{chatRoomTagHistoryMsgRequestTag:ie},ie.callback)}},function(t,r,e){var n=e(197).fn,g=e(25).reportAPI;n.disconnect=function(y){(y=y||{}).done=g({instance:this,className:"ChatroomFn",funcName:"disconnect",done:y.done}),this.protocol.disconnect(y.done)}},function(t,r,e){var n=e(0),g=n.undef,y=n.verifyOptions,i=n.verifyParamType,k=e(312),$=e(197).fn,L=e(25).reportAPI;$.updateMyChatroomMemberInfo=function(V){(V=V||{}).done=L({instance:this,className:"ChatroomFn",funcName:"updateMyChatroomMemberInfo",done:V.done}),y(V,"member needNotify","member::updateMyChatroomMemberInfo"),i("needNotify",V.needNotify,"boolean","member::updateMyChatroomMemberInfo"),V.needSave=V.needSave||!1,i("needSave",V.needSave,"boolean","member::updateMyChatroomMemberInfo"),this.processCustom(V),this.processCallback(V),V.chatroomMember=new k(V.member),V.antispamTag={antiSpamBusinessId:V.antiSpamBusinessId},this.sendCmd("updateMyChatroomMemberInfo",V)},$.getChatroomMembers=function(V){(V=V||{}).done=L({instance:this,className:"ChatroomFn",funcName:"getChatroomMembers",done:V.done}),y(V,"guest","member::getChatroomMembers"),i("guest",V.guest,"boolean","member::getChatroomMembers"),g(V.time)?V.time=0:i("time",V.time,"number","member::getChatroomMembers"),g(V.limit)?V.limit=100:i("limit",V.limit,"number","member::getChatroomMembers"),this.processCallback(V),V.guest?V.type=V.desc===!1?3:1:V.type=V.onlyOnline?2:0,this.sendCmd("getChatroomMembers",V)},$.getChatroomMembersByTag=function(V){(V=V||{}).done=L({instance:this,className:"ChatroomFn",funcName:"getChatroomMembersByTag",done:V.done}),y(V,"tag","getChatroomMembersByTag::rag"),g(V.time)?V.time=0:i("time",V.time,"number","getChatroomMembersByTag::time"),g(V.limit)?V.limit=100:i("limit",V.limit,"number","getChatroomMembersByTag::limit"),this.processCallback(V),this.sendCmd("getChatroomMembersByTag",{tagMemberReq:n.filterObj(V,"tag limit time"),callback:V.callback})},$.getChatroomMemberCountByTag=function(V){(V=V||{}).done=L({instance:this,className:"ChatroomFn",funcName:"getChatroomMemberCountByTag",done:V.done}),y(V,"tag","getChatroomMemberCountByTag::rag"),this.processCallback(V),this.sendCmd("getChatroomMemberCountByTag",V)},$.getChatroomMembersInfo=function(V){(V=V||{}).done=L({instance:this,className:"ChatroomFn",funcName:"getChatroomMembersInfo",done:V.done}),y(V,"accounts","member::getChatroomMembersInfo"),i("accounts",V.accounts,"array","member::getChatroomMembersInfo"),this.processCallback(V),this.sendCmd("getChatroomMembersInfo",V)},$.markChatroomIdentity=function(V){(V=V||{}).done=L({instance:this,className:"ChatroomFn",funcName:"markChatroomIdentity",done:V.done}),y(V,"identity","member::markChatroomIdentity"),V.type={manager:1,common:2,black:-1,mute:-2}[V.identity],delete V.identity,isNaN(V.type)?y(V,"identity",'member::markChatroomIdentity. The valid value of the identity is "manager" or "common" or "black" or "mute".'):this.markChatroomMember(V)},$.markChatroomManager=function(V){(V=V||{}).done=L({instance:this,className:"ChatroomFn",funcName:"markChatroomManager",done:V.done}),V.type=1,this.markChatroomMember(V)},$.markChatroomCommonMember=function(V){(V=V||{}).done=L({instance:this,className:"ChatroomFn",funcName:"markChatroomCommonMember",done:V.done}),V.type=2,this.markChatroomMember(V)},$.markChatroomBlacklist=function(V){(V=V||{}).done=L({instance:this,className:"ChatroomFn",funcName:"markChatroomBlacklist",done:V.done}),V.type=-1,this.markChatroomMember(V)},$.markChatroomGaglist=function(V){(V=V||{}).done=L({instance:this,className:"ChatroomFn",funcName:"markChatroomGaglist",done:V.done}),V.type=-2,this.markChatroomMember(V)},$.markChatroomMember=function(V){(V=V||{}).done=L({instance:this,className:"ChatroomFn",funcName:"markChatroomMember",done:V.done}),y(V,"account type isAdd","member::markChatroomMember"),i("isAdd",V.isAdd,"boolean","member::markChatroomMember"),g(V.level)?V.level=0:i("level",V.level,"number","member::markChatroomMember"),this.processCustom(V),this.processCallback(V),this.sendCmd("markChatroomMember",V)},$.kickChatroomMember=function(V){(V=V||{}).done=L({instance:this,className:"ChatroomFn",funcName:"kickChatroomMember",done:V.done}),y(V,"account","member::kickChatroomMember"),this.processCustom(V),this.processCallback(V),this.sendCmd("kickChatroomMember",V)},$.updateChatroomMemberTempMute=function(V){(V=V||{}).done=L({instance:this,className:"ChatroomFn",funcName:"updateChatroomMemberTempMute",done:V.done}),y(V,"account duration needNotify","member::updateChatroomMemberTempMute"),i("duration",V.duration,"number","member::updateChatroomMemberTempMute"),i("needNotify",V.needNotify,"boolean","member::updateChatroomMemberTempMute"),this.processCustom(V),this.processCallback(V),this.sendCmd("updateChatroomMemberTempMute",V)},$.updateTagMembersTempMute=function(V){(V=V||{}).done=L({instance:this,className:"ChatroomFn",funcName:"updateTagMembersTempMute",done:V.done}),y(V,"tag duration needNotify","member::updateTagMembersTempMute"),i("duration",V.duration,"number","member::updateTagMembersTempMute"),i("needNotify",V.needNotify,"boolean","member::updateTagMembersTempMute"),this.processCustom(V),this.processCallback(V);var z=n.filterObj(V,"tag duration custom notifyTargetTags");z.needNotify=V.needNotify?1:0,this.sendCmd("updateTagMembersTempMute",{tagMuteReq:z,callback:V.callback})},$.updateCoordinate=n.throttle(function(V){(V=V||{}).done=L({instance:this,className:"ChatroomFn",funcName:"updateCoordinate",done:V.done});var z=!0;V.x===void 0||V.y===void 0||V.z===void 0?z=!1:(typeof V.x!="number"&&(V.x=0),typeof V.y!="number"&&(V.y=0),typeof V.z!="number"&&(V.z=0)),this.processCallback(V);var re=n.filterObj(V,z?"x y z distance":"distance");this.sendCmd("updateCoordinate",{coordinateReq:re,callback:V.callback})},300,{},function(V){V&&V.done&&V.done({code:416,chatroomId:this.options.chatroomId})}),$.getRobotList=function(V){(V=V||{}).done=L({instance:this,className:"ChatroomFn",funcName:"getRobotList",done:V.done}),this.logger.warn("this api will be abandon"),g(V.timetag)&&(V.timetag=0),this.processCallback(V),this.sendCmd("syncRobot",V)}},function(t,r,e){var n=e(197).fn,g=e(0),y=e(25).reportAPI;n.queueOffer=function(i){(i=i||{}).done=y({instance:this,className:"ChatroomFn",funcName:"queueOffer",done:i.done}),g.verifyOptions(i,"elementKey elementValue","msg::queueOffer");var k={elementKey:i.elementKey,elementValue:i.elementValue,transient:!!i.transient};i.elementAccount&&(k.elementAccount=i.elementAccount),this.processCallback(i),this.sendCmd("queueOffer",k,i.callback)},n.queuePoll=function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};(i=i||{}).done=y({instance:this,className:"ChatroomFn",funcName:"queuePoll",done:i.done}),i.elementKey=i.elementKey||"",this.processCallback(i),this.sendCmd("queuePoll",i,i.callback)},n.queueList=function(i){(i=i||{}).done=y({instance:this,className:"ChatroomFn",funcName:"queueList",done:i.done}),this.processCallback(i),this.sendCmd("queueList",i,i.callback)},n.peak=function(i){(i=i||{}).done=y({instance:this,className:"ChatroomFn",funcName:"peak",done:i.done}),this.processCallback(i),this.sendCmd("peak",i,i.callback)},n.queueDrop=function(i){(i=i||{}).done=y({instance:this,className:"ChatroomFn",funcName:"queueDrop",done:i.done}),this.processCallback(i),this.sendCmd("queueDrop",i,i.callback)},n.queueChange=function(i){(i=i||{}).done=y({instance:this,className:"ChatroomFn",funcName:"queueChange",done:i.done}),g.verifyOptions(i,"elementMap","msg::queueOffer"),i.needNotify?(i.needNotify=!0,g.verifyOptions(i,"notifyExt","msg::queueOffer")):i.needNotify=!1,this.processCallback(i),this.sendCmd("queueChange",i,i.callback)}},,,function(t,r,e){t.exports=e(917)},function(t,r,e){e(299);var n={NIM:e(770),Chatroom:e(887)};e(311)(n),t.exports=n}])})})(NIM_Web_SDK);var NIM_Web_SDKExports=NIM_Web_SDK.exports;const NIM_SDK=getDefaultExportFromCjs(NIM_Web_SDKExports);class NimChatroomSocket{constructor(r){xu(this,"liveId");xu(this,"nimChatroomSocket");xu(this,"onMessage");xu(this,"handleRoomSocketMessage",r=>{this.onMessage(this,r)});xu(this,"onConnet",r=>{let e="进入小偶像的直播间成功。";console.log(e),logApi().addSystem(e)});xu(this,"handleRoomSocketError",(r,e)=>{console.log("发生错误",r,e),logApi().addSystem("发生错误"+r)});xu(this,"handleRoomSocketDisconnect",r=>{console.log("连接断开",r),logApi().addSystem("直播间连接断开")});this.liveId=r.liveId,this.onMessage=r.onMessage}init(r){this.nimChatroomSocket=NIM_SDK.Chatroom.getInstance({appKey:atob(r),chatroomId:this.liveId,chatroomAddresses:["chatweblink01.netease.im:443"],onconnect:this.onConnet,onmsgs:this.handleRoomSocketMessage,onerror:this.handleRoomSocketError,ondisconnect:this.handleRoomSocketDisconnect,isAnonymous:!0,chatroomNick:this.uuid(),chatroomAvatar:"",db:!1,dbLog:!1})}disconnect(){var r,e;(e=(r=this.nimChatroomSocket)==null?void 0:r.disconnect)==null||e.call(r,{done(){}}),this.nimChatroomSocket=void 0}uuid(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(r){var e=Math.random()*16|0,n=r==="x"?e:e&3|8;return n.toString(16)})}}var QCHAT_BROWSER_SDK={exports:{}};(function(t,r){(function(e,n){t.exports=n()})(commonjsGlobal,function(){var e=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof commonjsGlobal<"u"?commonjsGlobal:typeof self<"u"?self:{};function n(pe){return pe&&pe.__esModule&&Object.prototype.hasOwnProperty.call(pe,"default")?pe.default:pe}function g(pe){var _e={exports:{}};return pe(_e,_e.exports),_e.exports}var y,i,k=n(g(function(pe){pe.exports=function(Ve){if(Ve===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return Ve},pe.exports.__esModule=!0,pe.exports.default=pe.exports})),$=function(pe){return pe&&pe.Math==Math&&pe},L=$(typeof globalThis=="object"&&globalThis)||$(typeof window=="object"&&window)||$(typeof self=="object"&&self)||$(typeof e=="object"&&e)||function(){return this}()||Function("return this")(),V=function(pe){try{return!!pe()}catch{return!0}},z=!V(function(){var pe=(function(){}).bind();return typeof pe!="function"||pe.hasOwnProperty("prototype")}),re=Function.prototype,ie=re.apply,ue=re.call,le=typeof Reflect=="object"&&Reflect.apply||(z?ue.bind(ie):function(){return ue.apply(ie,arguments)}),oe=Function.prototype,ae=oe.bind,qe=oe.call,de=z&&ae.bind(qe,qe),Ne=z?function(pe){return pe&&de(pe)}:function(pe){return pe&&function(){return qe.apply(pe,arguments)}},ze=function(pe){return typeof pe=="function"},$e=!V(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!=7}),Lt=Function.prototype.call,jt=z?Lt.bind(Lt):function(){return Lt.apply(Lt,arguments)},Et={}.propertyIsEnumerable,ir=Object.getOwnPropertyDescriptor,dr={f:ir&&!Et.call({1:2},1)?function(_e){var Ve=ir(this,_e);return!!Ve&&Ve.enumerable}:Et},Dt=function(pe,_e){return{enumerable:!(1&pe),configurable:!(2&pe),writable:!(4&pe),value:_e}},lr=Ne({}.toString),sr=Ne("".slice),er=function(pe){return sr(lr(pe),8,-1)},cr=Object,or=Ne("".split),hr=V(function(){return!cr("z").propertyIsEnumerable(0)})?function(pe){return er(pe)=="String"?or(pe,""):cr(pe)}:cr,pr=function(pe){return pe==null},Sr=TypeError,Er=function(pe){if(pr(pe))throw Sr("Can't call method on "+pe);return pe},Pr=function(pe){return hr(Er(pe))},Cr=typeof document=="object"&&document.all,rr=Cr===void 0&&Cr!==void 0?function(pe){return typeof pe=="object"?pe!==null:ze(pe)||pe===Cr}:function(pe){return typeof pe=="object"?pe!==null:ze(pe)},kr={},Ir=function(pe){return ze(pe)?pe:void 0},xr=function(pe,_e){return arguments.length<2?Ir(kr[pe])||Ir(L[pe]):kr[pe]&&kr[pe][_e]||L[pe]&&L[pe][_e]},vr=Ne({}.isPrototypeOf),_r=xr("navigator","userAgent")||"",Or=L.process,Mr=L.Deno,yr=Or&&Or.versions||Mr&&Mr.version,mr=yr&&yr.v8;mr&&(i=(y=mr.split("."))[0]>0&&y[0]<4?1:+(y[0]+y[1])),!i&&_r&&(!(y=_r.match(/Edge\/(\d+)/))||y[1]>=74)&&(y=_r.match(/Chrome\/(\d+)/))&&(i=+y[1]);var Tr,Br=i,$r=!!Object.getOwnPropertySymbols&&!V(function(){var pe=Symbol();return!String(pe)||!(Object(pe)instanceof Symbol)||!Symbol.sham&&Br&&Br<41}),Lr=$r&&!Symbol.sham&&typeof Symbol.iterator=="symbol",Gr=Object,qr=Lr?function(pe){return typeof pe=="symbol"}:function(pe){var _e=xr("Symbol");return ze(_e)&&vr(_e.prototype,Gr(pe))},Yr=String,bn=function(pe){try{return Yr(pe)}catch{return"Object"}},wn=TypeError,Xr=function(pe){if(ze(pe))return pe;throw wn(bn(pe)+" is not a function")},Vn=function(pe,_e){var Ve=pe[_e];return pr(Ve)?void 0:Xr(Ve)},Zr=TypeError,Nn=Object.defineProperty,Qr="__core-js_shared__",kn=L[Qr]||function(pe,_e){try{Nn(L,pe,{value:_e,configurable:!0,writable:!0})}catch{L[pe]=_e}return _e}(Qr,{}),Dn=g(function(pe){(pe.exports=function(_e,Ve){return kn[_e]||(kn[_e]=Ve!==void 0?Ve:{})})("versions",[]).push({version:"3.25.0",mode:"pure",copyright:"© 2014-2022 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.25.0/LICENSE",source:"https://github.com/zloirock/core-js"})}),xn=Object,An=function(pe){return xn(Er(pe))},vn=Ne({}.hasOwnProperty),hn=Object.hasOwn||function(_e,Ve){return vn(An(_e),Ve)},Yn=0,Oo=Math.random(),Vo=Ne(1 .toString),Uo=function(pe){return"Symbol("+(pe===void 0?"":pe)+")_"+Vo(++Yn+Oo,36)},Io=Dn("wks"),ra=L.Symbol,Wa=ra&&ra.for,Rs=Lr?ra:ra&&ra.withoutSetter||Uo,To=function(pe){if(!hn(Io,pe)||!$r&&typeof Io[pe]!="string"){var _e="Symbol."+pe;$r&&hn(ra,pe)?Io[pe]=ra[pe]:Io[pe]=Lr&&Wa?Wa(_e):Rs(_e)}return Io[pe]},Qs=TypeError,to=To("toPrimitive"),ba=function(pe,_e){if(!rr(pe)||qr(pe))return pe;var Ve,Oe=Vn(pe,to);if(Oe){if(_e===void 0&&(_e="default"),Ve=jt(Oe,pe,_e),!rr(Ve)||qr(Ve))return Ve;throw Qs("Can't convert object to primitive value")}return _e===void 0&&(_e="number"),function(Ie,At){var nr,kt;if(At==="string"&&ze(nr=Ie.toString)&&!rr(kt=jt(nr,Ie))||ze(nr=Ie.valueOf)&&!rr(kt=jt(nr,Ie))||At!=="string"&&ze(nr=Ie.toString)&&!rr(kt=jt(nr,Ie)))return kt;throw Zr("Can't convert object to primitive value")}(pe,_e)},ka=function(pe){var _e=ba(pe,"string");return qr(_e)?_e:_e+""},qa=L.document,Ya=rr(qa)&&rr(qa.createElement),Xo=function(pe){return Ya?qa.createElement(pe):{}},Co=!$e&&!V(function(){return Object.defineProperty(Xo("div"),"a",{get:function(){return 7}}).a!=7}),Ga=Object.getOwnPropertyDescriptor,Xa={f:$e?Ga:function(_e,Ve){if(_e=Pr(_e),Ve=ka(Ve),Co)try{return Ga(_e,Ve)}catch{}if(hn(_e,Ve))return Dt(!jt(dr.f,_e,Ve),_e[Ve])}},Gl=/#|\.prototype\./,Js=function(pe,_e){var Ve=pa[wi(pe)];return Ve==_u||Ve!=ti&&(ze(_e)?V(_e):!!_e)},wi=Js.normalize=function(pe){return String(pe).replace(Gl,".").toLowerCase()},pa=Js.data={},ti=Js.NATIVE="N",_u=Js.POLYFILL="P",ac=Js,Dc=Ne(Ne.bind),Zo=function(pe,_e){return Xr(pe),_e===void 0?pe:z?Dc(pe,_e):function(){return pe.apply(_e,arguments)}},Nf=$e&&V(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!=42}),Cb=String,kb=TypeError,lo=function(pe){if(rr(pe))return pe;throw kb(Cb(pe)+" is not an object")},wb=TypeError,Iu=Object.defineProperty,xb=Object.getOwnPropertyDescriptor,_b="enumerable",Ib="configurable",Eb="writable",Pa={f:$e?Nf?function(_e,Ve,Oe){if(lo(_e),Ve=ka(Ve),lo(Oe),typeof _e=="function"&&Ve==="prototype"&&"value"in Oe&&Eb in Oe&&!Oe.writable){var Ie=xb(_e,Ve);Ie&&Ie.writable&&(_e[Ve]=Oe.value,Oe={configurable:Ib in Oe?Oe.configurable:Ie.configurable,enumerable:_b in Oe?Oe.enumerable:Ie.enumerable,writable:!1})}return Iu(_e,Ve,Oe)}:Iu:function(_e,Ve,Oe){if(lo(_e),Ve=ka(Ve),lo(Oe),Co)try{return Iu(_e,Ve,Oe)}catch{}if("get"in Oe||"set"in Oe)throw wb("Accessors not supported");return"value"in Oe&&(_e[Ve]=Oe.value),_e}},fa=$e?function(pe,_e,Ve){return Pa.f(pe,_e,Dt(1,Ve))}:function(pe,_e,Ve){return pe[_e]=Ve,pe},Pb=Xa.f,Ab=function(pe){var _e=function(Ve,Oe,Ie){if(this instanceof _e){switch(arguments.length){case 0:return new pe;case 1:return new pe(Ve);case 2:return new pe(Ve,Oe)}return new pe(Ve,Oe,Ie)}return le(pe,this,arguments)};return _e.prototype=pe.prototype,_e},_n=function(pe,_e){var Ve,Oe,Ie,At,nr,kt,ur,gr,Ar=pe.target,Rr=pe.global,Ur=pe.stat,Dr=pe.proto,Jr=Rr?L:Ur?L[Ar]:(L[Ar]||{}).prototype,Cn=Rr?kr:kr[Ar]||fa(kr,Ar,{})[Ar],Sn=Cn.prototype;for(Ie in _e)Ve=!ac(Rr?Ie:Ar+(Ur?".":"#")+Ie,pe.forced)&&Jr&&hn(Jr,Ie),nr=Cn[Ie],Ve&&(kt=pe.dontCallGetSet?(gr=Pb(Jr,Ie))&&gr.value:Jr[Ie]),At=Ve&&kt?kt:_e[Ie],Ve&&typeof nr==typeof At||(ur=pe.bind&&Ve?Zo(At,L):pe.wrap&&Ve?Ab(At):Dr&&ze(At)?Ne(At):At,(pe.sham||At&&At.sham||nr&&nr.sham)&&fa(ur,"sham",!0),fa(Cn,Ie,ur),Dr&&(hn(kr,Oe=Ar+"Prototype")||fa(kr,Oe,{}),fa(kr[Oe],Ie,At),pe.real&&Sn&&!Sn[Ie]&&fa(Sn,Ie,At)))},Nb=Math.ceil,Ob=Math.floor,Rb=Math.trunc||function(_e){var Ve=+_e;return(Ve>0?Ob:Nb)(Ve)},sc=function(pe){var _e=+pe;return _e!=_e||_e===0?0:Rb(_e)},Bb=Math.max,Fb=Math.min,xi=function(pe,_e){var Ve=sc(pe);return Ve<0?Bb(Ve+_e,0):Fb(Ve,_e)},$b=Math.min,Ka=function(pe){return(_e=pe.length)>0?$b(sc(_e),9007199254740991):0;var _e},Of=function(pe){return function(_e,Ve,Oe){var Ie,At=Pr(_e),nr=Ka(At),kt=xi(Oe,nr);if(pe&&Ve!=Ve){for(;nr>kt;)if((Ie=At[kt++])!=Ie)return!0}else for(;nr>kt;kt++)if((pe||kt in At)&&At[kt]===Ve)return pe||kt||0;return!pe&&-1}},Eu={includes:Of(!0),indexOf:Of(!1)},_i={},Lb=Eu.indexOf,Rf=Ne([].push),Bf=function(pe,_e){var Ve,Oe=Pr(pe),Ie=0,At=[];for(Ve in Oe)!hn(_i,Ve)&&hn(Oe,Ve)&&Rf(At,Ve);for(;_e.length>Ie;)hn(Oe,Ve=_e[Ie++])&&(~Lb(At,Ve)||Rf(At,Ve));return At},il=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],Bs=Object.keys||function(_e){return Bf(_e,il)},jb=$e&&!Nf?Object.defineProperties:function(_e,Ve){lo(_e);for(var Oe,Ie=Pr(Ve),At=Bs(Ve),nr=At.length,kt=0;nr>kt;)Pa.f(_e,Oe=At[kt++],Ie[Oe]);return _e},Ff={f:jb},Pu=xr("document","documentElement"),$f=Dn("keys"),cl=function(pe){return $f[pe]||($f[pe]=Uo(pe))},Lf=cl("IE_PROTO"),Au=function(){},jf=function(pe){return"<script>"+pe+"<\/script>"},Df=function(pe){pe.write(jf("")),pe.close();var _e=pe.parentWindow.Object;return pe=null,_e},ll=function(){try{Tr=new ActiveXObject("htmlfile")}catch{}var pe,_e;ll=typeof document<"u"?document.domain&&Tr?Df(Tr):((_e=Xo("iframe")).style.display="none",Pu.appendChild(_e),_e.src="javascript:",(pe=_e.contentWindow.document).open(),pe.write(jf("document.F=Object")),pe.close(),pe.F):Df(Tr);for(var Ve=il.length;Ve--;)delete ll.prototype[il[Ve]];return ll()};_i[Lf]=!0;var Qa=Object.create||function(_e,Ve){var Oe;return _e!==null?(Au.prototype=lo(_e),Oe=new Au,Au.prototype=null,Oe[Lf]=_e):Oe=ll(),Ve===void 0?Oe:Ff.f(Oe,Ve)};_n({target:"Object",stat:!0,sham:!$e},{create:Qa});var Db=kr.Object,vs=function(_e,Ve){return Db.create(_e,Ve)},Ub=String,qb=TypeError,ic=Object.setPrototypeOf||("__proto__"in{}?function(){var pe,_e=!1,Ve={};try{(pe=Ne(Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set))(Ve,[]),_e=Ve instanceof Array}catch{}return function(Ie,At){return lo(Ie),function(nr){if(typeof nr=="object"||ze(nr))return nr;throw qb("Can't set "+Ub(nr)+" as a prototype")}(At),_e?pe(Ie,At):Ie.__proto__=At,Ie}}():void 0);_n({target:"Object",stat:!0},{setPrototypeOf:ic});var ri=kr.Object.setPrototypeOf,Fs=Ne([].slice),Uf=Function,Vb=Ne([].concat),Hb=Ne([].join),Nu={},zb=function(pe,_e,Ve){if(!hn(Nu,_e)){for(var Oe=[],Ie=0;Ie<_e;Ie++)Oe[Ie]="a["+Ie+"]";Nu[_e]=Uf("C,a","return new C("+Hb(Oe,",")+")")}return Nu[_e](pe,Ve)},Ou=z?Uf.bind:function(_e){var Ve=Xr(this),Oe=Ve.prototype,Ie=Fs(arguments,1),At=function(){var kt=Vb(Ie,Fs(arguments));return this instanceof At?zb(Ve,kt.length,kt):Ve.apply(_e,kt)};return rr(Oe)&&(At.prototype=Oe),At};_n({target:"Function",proto:!0,forced:Function.bind!==Ou},{bind:Ou});var na=function(pe){return kr[pe+"Prototype"]},Wb=na("Function").bind,Ru=Function.prototype,Go=function(pe){var _e=pe.bind;return pe===Ru||vr(Ru,pe)&&_e===Ru.bind?Wb:_e},Bu=g(function(pe){function _e(Ve,Oe){var Ie;return pe.exports=_e=ri?Go(Ie=ri).call(Ie):function(nr,kt){return nr.__proto__=kt,nr},pe.exports.__esModule=!0,pe.exports.default=pe.exports,_e(Ve,Oe)}pe.exports=_e,pe.exports.__esModule=!0,pe.exports.default=pe.exports}),Ko=n(g(function(pe){pe.exports=function(Ve,Oe){Ve.prototype=vs(Oe.prototype),Ve.prototype.constructor=Ve,Bu(Ve,Oe)},pe.exports.__esModule=!0,pe.exports.default=pe.exports})),ys=Array.isArray||function(_e){return er(_e)=="Array"},Gb=TypeError,Fu=function(pe){if(pe>9007199254740991)throw Gb("Maximum allowed index exceeded");return pe},ni=function(pe,_e,Ve){var Oe=ka(_e);Oe in pe?Pa.f(pe,Oe,Dt(0,Ve)):pe[Oe]=Ve},qf={};qf[To("toStringTag")]="z";var $u=String(qf)==="[object z]",Kb=To("toStringTag"),Qb=Object,Jb=er(function(){return arguments}())=="Arguments",oi=$u?er:function(pe){var _e,Ve,Oe;return pe===void 0?"Undefined":pe===null?"Null":typeof(Ve=function(Ie,At){try{return Ie[At]}catch{}}(_e=Qb(pe),Kb))=="string"?Ve:Jb?er(_e):(Oe=er(_e))=="Object"&&ze(_e.callee)?"Arguments":Oe},Yb=Ne(Function.toString);ze(kn.inspectSource)||(kn.inspectSource=function(pe){return Yb(pe)});var Vf=kn.inspectSource,Hf=function(){},Xb=[],zf=xr("Reflect","construct"),Lu=/^\s*(?:class|function)\b/,Zb=Ne(Lu.exec),e0=!Lu.exec(Hf),cc=function(_e){if(!ze(_e))return!1;try{return zf(Hf,Xb,_e),!0}catch{return!1}},Wf=function(_e){if(!ze(_e))return!1;switch(oi(_e)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return e0||!!Zb(Lu,Vf(_e))}catch{return!0}};Wf.sham=!0;var ul=!zf||V(function(){var pe;return cc(cc.call)||!cc(Object)||!cc(function(){pe=!0})||pe})?Wf:cc,t0=To("species"),Gf=Array,ju=function(pe,_e){return new(function(Ve){var Oe;return ys(Ve)&&(Oe=Ve.constructor,(ul(Oe)&&(Oe===Gf||ys(Oe.prototype))||rr(Oe)&&(Oe=Oe[t0])===null)&&(Oe=void 0)),Oe===void 0?Gf:Oe}(pe))(_e===0?0:_e)},r0=To("species"),lc=function(pe){return Br>=51||!V(function(){var _e=[];return(_e.constructor={})[r0]=function(){return{foo:1}},_e[pe](Boolean).foo!==1})},Kf=To("isConcatSpreadable"),n0=Br>=51||!V(function(){var pe=[];return pe[Kf]=!1,pe.concat()[0]!==pe}),o0=lc("concat"),a0=function(pe){if(!rr(pe))return!1;var _e=pe[Kf];return _e!==void 0?!!_e:ys(pe)};_n({target:"Array",proto:!0,arity:1,forced:!n0||!o0},{concat:function(_e){var Ve,Oe,Ie,At,nr,kt=An(this),ur=ju(kt,0),gr=0;for(Ve=-1,Ie=arguments.length;Ve<Ie;Ve++)if(a0(nr=Ve===-1?kt:arguments[Ve]))for(At=Ka(nr),Fu(gr+At),Oe=0;Oe<At;Oe++,gr++)Oe in nr&&ni(ur,gr,nr[Oe]);else Fu(gr+1),ni(ur,gr++,nr);return ur.length=gr,ur}});var dl,uc,pl,s0=String,Za=function(pe){if(oi(pe)==="Symbol")throw TypeError("Cannot convert a Symbol value to a string");return s0(pe)},i0=il.concat("length","prototype"),dc={f:Object.getOwnPropertyNames||function(_e){return Bf(_e,i0)}},c0=Array,l0=Math.max,Du=function(pe,_e,Ve){for(var Oe=Ka(pe),Ie=xi(_e,Oe),At=xi(Ve===void 0?Oe:Ve,Oe),nr=c0(l0(At-Ie,0)),kt=0;Ie<At;Ie++,kt++)ni(nr,kt,pe[Ie]);return nr.length=kt,nr},Qf=dc.f,Jf=typeof window=="object"&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],Uu={f:function(_e){return Jf&&er(_e)=="Window"?function(Ve){try{return Qf(Ve)}catch{return Du(Jf)}}(_e):Qf(Pr(_e))}},pc={f:Object.getOwnPropertySymbols},$s=function(pe,_e,Ve,Oe){return Oe&&Oe.enumerable?pe[_e]=Ve:fa(pe,_e,Ve),pe},qu={f:To},u0=Pa.f,jo=function(pe){var _e=kr.Symbol||(kr.Symbol={});hn(_e,pe)||u0(_e,pe,{value:qu.f(pe)})},Yf=function(){var pe=xr("Symbol"),_e=pe&&pe.prototype,Ve=_e&&_e.valueOf,Oe=To("toPrimitive");_e&&!_e[Oe]&&$s(_e,Oe,function(Ie){return jt(Ve,this)},{arity:1})},d0=$u?{}.toString:function(){return"[object "+oi(this)+"]"},p0=Pa.f,Xf=To("toStringTag"),ai=function(pe,_e,Ve,Oe){if(pe){var Ie=Ve?pe:pe.prototype;hn(Ie,Xf)||p0(Ie,Xf,{configurable:!0,value:_e}),Oe&&!$u&&fa(Ie,"toString",d0)}},Zf=L.WeakMap,f0=ze(Zf)&&/native code/.test(String(Zf)),em="Object already initialized",Vu=L.TypeError,m0=L.WeakMap;if(f0||kn.state){var si=kn.state||(kn.state=new m0),g0=Ne(si.get),tm=Ne(si.has),h0=Ne(si.set);dl=function(pe,_e){if(tm(si,pe))throw Vu(em);return _e.facade=pe,h0(si,pe,_e),_e},uc=function(pe){return g0(si,pe)||{}},pl=function(pe){return tm(si,pe)}}else{var Ii=cl("state");_i[Ii]=!0,dl=function(pe,_e){if(hn(pe,Ii))throw Vu(em);return _e.facade=pe,fa(pe,Ii,_e),_e},uc=function(pe){return hn(pe,Ii)?pe[Ii]:{}},pl=function(pe){return hn(pe,Ii)}}var Ja={set:dl,get:uc,has:pl,enforce:function(pe){return pl(pe)?uc(pe):dl(pe,{})},getterFor:function(pe){return function(_e){var Ve;if(!rr(_e)||(Ve=uc(_e)).type!==pe)throw Vu("Incompatible receiver, "+pe+" required");return Ve}}},rm=Ne([].push),Ls=function(pe){var _e=pe==1,Ve=pe==2,Oe=pe==3,Ie=pe==4,At=pe==6,nr=pe==7,kt=pe==5||At;return function(ur,gr,Ar,Rr){for(var Ur,Dr,Jr=An(ur),Cn=hr(Jr),Sn=Zo(gr,Ar),$n=Ka(Cn),Rn=0,Wn=Rr||ju,Fn=_e?Wn(ur,$n):Ve||nr?Wn(ur,0):void 0;$n>Rn;Rn++)if((kt||Rn in Cn)&&(Dr=Sn(Ur=Cn[Rn],Rn,Jr),pe))if(_e)Fn[Rn]=Dr;else if(Dr)switch(pe){case 3:return!0;case 5:return Ur;case 6:return Rn;case 2:rm(Fn,Ur)}else switch(pe){case 4:return!1;case 7:rm(Fn,Ur)}return At?-1:Oe||Ie?Ie:Fn}},js={forEach:Ls(0),map:Ls(1),filter:Ls(2),some:Ls(3),every:Ls(4),find:Ls(5),findIndex:Ls(6),filterReject:Ls(7)},fl=js.forEach,Aa=cl("hidden"),ml="Symbol",v0=Ja.set,nm=Ja.getterFor(ml),rs=Object.prototype,ii=L.Symbol,fc=ii&&ii.prototype,y0=L.TypeError,Hu=L.QObject,om=Xa.f,Ds=Pa.f,am=Uu.f,b0=dr.f,sm=Ne([].push),bs=Dn("symbols"),mc=Dn("op-symbols"),T0=Dn("wks"),zu=!Hu||!Hu.prototype||!Hu.prototype.findChild,Wu=$e&&V(function(){return Qa(Ds({},"a",{get:function(){return Ds(this,"a",{value:7}).a}})).a!=7})?function(pe,_e,Ve){var Oe=om(rs,_e);Oe&&delete rs[_e],Ds(pe,_e,Ve),Oe&&pe!==rs&&Ds(rs,_e,Oe)}:Ds,Gu=function(pe,_e){var Ve=bs[pe]=Qa(fc);return v0(Ve,{type:ml,tag:pe,description:_e}),$e||(Ve.description=_e),Ve},gl=function(_e,Ve,Oe){_e===rs&&gl(mc,Ve,Oe),lo(_e);var Ie=ka(Ve);return lo(Oe),hn(bs,Ie)?(Oe.enumerable?(hn(_e,Aa)&&_e[Aa][Ie]&&(_e[Aa][Ie]=!1),Oe=Qa(Oe,{enumerable:Dt(0,!1)})):(hn(_e,Aa)||Ds(_e,Aa,Dt(1,{})),_e[Aa][Ie]=!0),Wu(_e,Ie,Oe)):Ds(_e,Ie,Oe)},Ku=function(_e,Ve){lo(_e);var Oe=Pr(Ve),Ie=Bs(Oe).concat(um(Oe));return fl(Ie,function(At){$e&&!jt(im,Oe,At)||gl(_e,At,Oe[At])}),_e},im=function(_e){var Ve=ka(_e),Oe=jt(b0,this,Ve);return!(this===rs&&hn(bs,Ve)&&!hn(mc,Ve))&&(!(Oe||!hn(this,Ve)||!hn(bs,Ve)||hn(this,Aa)&&this[Aa][Ve])||Oe)},cm=function(_e,Ve){var Oe=Pr(_e),Ie=ka(Ve);if(Oe!==rs||!hn(bs,Ie)||hn(mc,Ie)){var At=om(Oe,Ie);return!At||!hn(bs,Ie)||hn(Oe,Aa)&&Oe[Aa][Ie]||(At.enumerable=!0),At}},lm=function(_e){var Ve=am(Pr(_e)),Oe=[];return fl(Ve,function(Ie){hn(bs,Ie)||hn(_i,Ie)||sm(Oe,Ie)}),Oe},um=function(pe){var _e=pe===rs,Ve=am(_e?mc:Pr(pe)),Oe=[];return fl(Ve,function(Ie){!hn(bs,Ie)||_e&&!hn(rs,Ie)||sm(Oe,bs[Ie])}),Oe};$r||(ii=function(){if(vr(fc,this))throw y0("Symbol is not a constructor");var _e=arguments.length&&arguments[0]!==void 0?Za(arguments[0]):void 0,Ve=Uo(_e),Oe=function(Ie){this===rs&&jt(Oe,mc,Ie),hn(this,Aa)&&hn(this[Aa],Ve)&&(this[Aa][Ve]=!1),Wu(this,Ve,Dt(1,Ie))};return $e&&zu&&Wu(rs,Ve,{configurable:!0,set:Oe}),Gu(Ve,_e)},fc=ii.prototype,$s(fc,"toString",function(){return nm(this).tag}),$s(ii,"withoutSetter",function(pe){return Gu(Uo(pe),pe)}),dr.f=im,Pa.f=gl,Ff.f=Ku,Xa.f=cm,dc.f=Uu.f=lm,pc.f=um,qu.f=function(pe){return Gu(To(pe),pe)},$e&&Ds(fc,"description",{configurable:!0,get:function(){return nm(this).description}})),_n({global:!0,constructor:!0,wrap:!0,forced:!$r,sham:!$r},{Symbol:ii}),fl(Bs(T0),function(pe){jo(pe)}),_n({target:ml,stat:!0,forced:!$r},{useSetter:function(){zu=!0},useSimple:function(){zu=!1}}),_n({target:"Object",stat:!0,forced:!$r,sham:!$e},{create:function(_e,Ve){return Ve===void 0?Qa(_e):Ku(Qa(_e),Ve)},defineProperty:gl,defineProperties:Ku,getOwnPropertyDescriptor:cm}),_n({target:"Object",stat:!0,forced:!$r},{getOwnPropertyNames:lm}),Yf(),ai(ii,ml),_i[Aa]=!0;var dm=$r&&!!Symbol.for&&!!Symbol.keyFor,Qu=Dn("string-to-symbol-registry"),S0=Dn("symbol-to-string-registry");_n({target:"Symbol",stat:!0,forced:!dm},{for:function(pe){var _e=Za(pe);if(hn(Qu,_e))return Qu[_e];var Ve=xr("Symbol")(_e);return Qu[_e]=Ve,S0[Ve]=_e,Ve}});var pm=Dn("symbol-to-string-registry");_n({target:"Symbol",stat:!0,forced:!dm},{keyFor:function(_e){if(!qr(_e))throw TypeError(bn(_e)+" is not a symbol");if(hn(pm,_e))return pm[_e]}});var Us=xr("JSON","stringify"),hl=Ne(/./.exec),fm=Ne("".charAt),M0=Ne("".charCodeAt),C0=Ne("".replace),k0=Ne(1 .toString),w0=/[\uD800-\uDFFF]/g,mm=/^[\uD800-\uDBFF]$/,gm=/^[\uDC00-\uDFFF]$/,hm=!$r||V(function(){var pe=xr("Symbol")();return Us([pe])!="[null]"||Us({a:pe})!="{}"||Us(Object(pe))!="{}"}),vm=V(function(){return Us("\uDF06\uD834")!=='"\\udf06\\ud834"'||Us("\uDEAD")!=='"\\udead"'}),x0=function(pe,_e){var Ve=Fs(arguments),Oe=_e;if((rr(_e)||pe!==void 0)&&!qr(pe))return ys(_e)||(_e=function(Ie,At){if(ze(Oe)&&(At=jt(Oe,this,Ie,At)),!qr(At))return At}),Ve[1]=_e,le(Us,null,Ve)},_0=function(pe,_e,Ve){var Oe=fm(Ve,_e-1),Ie=fm(Ve,_e+1);return hl(mm,pe)&&!hl(gm,Ie)||hl(gm,pe)&&!hl(mm,Oe)?"\\u"+k0(M0(pe,0),16):pe};Us&&_n({target:"JSON",stat:!0,arity:3,forced:hm||vm},{stringify:function(_e,Ve,Oe){var Ie=Fs(arguments),At=le(hm?x0:Us,null,Ie);return vm&&typeof At=="string"?C0(At,w0,_0):At}});var I0=!$r||V(function(){pc.f(1)});_n({target:"Object",stat:!0,forced:I0},{getOwnPropertySymbols:function(_e){var Ve=pc.f;return Ve?Ve(An(_e)):[]}}),jo("asyncIterator"),jo("hasInstance"),jo("isConcatSpreadable"),jo("iterator"),jo("match"),jo("matchAll"),jo("replace"),jo("search"),jo("species"),jo("split"),jo("toPrimitive"),Yf(),jo("toStringTag"),ai(xr("Symbol"),"Symbol"),jo("unscopables"),ai(L.JSON,"JSON",!0);var qs,ym,bm,E0=kr.Symbol,Ts={},Tm=Function.prototype,P0=$e&&Object.getOwnPropertyDescriptor,Ju=hn(Tm,"name"),A0={EXISTS:Ju,PROPER:Ju&&(function(){}).name==="something",CONFIGURABLE:Ju&&(!$e||$e&&P0(Tm,"name").configurable)},Sm=!V(function(){function pe(){}return pe.prototype.constructor=null,Object.getPrototypeOf(new pe)!==pe.prototype}),Mm=cl("IE_PROTO"),Yu=Object,N0=Yu.prototype,Ei=Sm?Yu.getPrototypeOf:function(pe){var _e=An(pe);if(hn(_e,Mm))return _e[Mm];var Ve=_e.constructor;return ze(Ve)&&_e instanceof Ve?Ve.prototype:_e instanceof Yu?N0:null},Xu=To("iterator"),Cm=!1;[].keys&&("next"in(bm=[].keys())?(ym=Ei(Ei(bm)))!==Object.prototype&&(qs=ym):Cm=!0);var O0=!rr(qs)||V(function(){var pe={};return qs[Xu].call(pe)!==pe});qs=O0?{}:Qa(qs),ze(qs[Xu])||$s(qs,Xu,function(){return this});var km={IteratorPrototype:qs,BUGGY_SAFARI_ITERATORS:Cm},R0=km.IteratorPrototype,B0=function(){return this},F0=A0.PROPER,vl=km.BUGGY_SAFARI_ITERATORS,Zu=To("iterator"),wm="keys",yl="values",xm="entries",$0=function(){return this},ed=function(pe,_e,Ve,Oe,Ie,At,nr){(function($n,Rn,Wn,Fn){var mo=Rn+" Iterator";$n.prototype=Qa(R0,{next:Dt(+!Fn,Wn)}),ai($n,mo,!1,!0),Ts[mo]=B0})(Ve,_e,Oe);var kt,ur,gr,Ar=function($n){if($n===Ie&&Cn)return Cn;if(!vl&&$n in Dr)return Dr[$n];switch($n){case wm:return function(){return new Ve(this,$n)};case yl:return function(){return new Ve(this,$n)};case xm:return function(){return new Ve(this,$n)}}return function(){return new Ve(this)}},Rr=_e+" Iterator",Ur=!1,Dr=pe.prototype,Jr=Dr[Zu]||Dr["@@iterator"]||Ie&&Dr[Ie],Cn=!vl&&Jr||Ar(Ie),Sn=_e=="Array"&&Dr.entries||Jr;if(Sn&&(kt=Ei(Sn.call(new pe)))!==Object.prototype&&kt.next&&(ai(kt,Rr,!0,!0),Ts[Rr]=$0),F0&&Ie==yl&&Jr&&Jr.name!==yl&&(Ur=!0,Cn=function(){return jt(Jr,this)}),Ie)if(ur={values:Ar(yl),keys:At?Cn:Ar(wm),entries:Ar(xm)},nr)for(gr in ur)(vl||Ur||!(gr in Dr))&&$s(Dr,gr,ur[gr]);else _n({target:_e,proto:!0,forced:vl||Ur},ur);return nr&&Dr[Zu]!==Cn&&$s(Dr,Zu,Cn,{name:Ie}),Ts[_e]=Cn,ur};Pa.f;var _m="Array Iterator",L0=Ja.set,j0=Ja.getterFor(_m);ed(Array,"Array",function(pe,_e){L0(this,{type:_m,target:Pr(pe),index:0,kind:_e})},function(){var pe=j0(this),_e=pe.target,Ve=pe.kind,Oe=pe.index++;return!_e||Oe>=_e.length?(pe.target=void 0,{value:void 0,done:!0}):Ve=="keys"?{value:Oe,done:!1}:Ve=="values"?{value:_e[Oe],done:!1}:{value:[Oe,_e[Oe]],done:!1}},"values"),Ts.Arguments=Ts.Array;var Im=To("toStringTag");for(var td in{CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}){var Em=L[td],rd=Em&&Em.prototype;rd&&oi(rd)!==Im&&fa(rd,Im,td),Ts[td]=Ts.Array}var D0=E0;jo("asyncDispose"),jo("dispose"),jo("matcher"),jo("metadataKey"),jo("observable"),jo("metadata"),jo("patternMatch"),jo("replaceAll");var Ba=D0,U0=Ne("".charAt),Pm=Ne("".charCodeAt),q0=Ne("".slice),Am=function(pe){return function(_e,Ve){var Oe,Ie,At=Za(Er(_e)),nr=sc(Ve),kt=At.length;return nr<0||nr>=kt?pe?"":void 0:(Oe=Pm(At,nr))<55296||Oe>56319||nr+1===kt||(Ie=Pm(At,nr+1))<56320||Ie>57343?pe?U0(At,nr):Oe:pe?q0(At,nr,nr+2):Ie-56320+(Oe-55296<<10)+65536}},V0={codeAt:Am(!1),charAt:Am(!0)}.charAt,Nm="String Iterator",H0=Ja.set,z0=Ja.getterFor(Nm);ed(String,"String",function(pe){H0(this,{type:Nm,string:Za(pe),index:0})},function(){var _e,Ve=z0(this),Oe=Ve.string,Ie=Ve.index;return Ie>=Oe.length?{value:void 0,done:!0}:(_e=V0(Oe,Ie),Ve.index+=_e.length,{value:_e,done:!1})});var Om=qu.f("iterator"),W0=g(function(pe){function _e(Ve){return pe.exports=_e=typeof Ba=="function"&&typeof Om=="symbol"?function(Oe){return typeof Oe}:function(Oe){return Oe&&typeof Ba=="function"&&Oe.constructor===Ba&&Oe!==Ba.prototype?"symbol":typeof Oe},pe.exports.__esModule=!0,pe.exports.default=pe.exports,_e(Ve)}pe.exports=_e,pe.exports.__esModule=!0,pe.exports.default=pe.exports}),Rm=Pa.f;_n({target:"Object",stat:!0,forced:Object.defineProperty!==Rm,sham:!$e},{defineProperty:Rm});var G0=g(function(pe){var _e=kr.Object,Ve=pe.exports=function(Ie,At,nr){return _e.defineProperty(Ie,At,nr)};_e.defineProperty.sham&&(Ve.sham=!0)}),gc=G0,K0=V(function(){Ei(1)});_n({target:"Object",stat:!0,forced:K0,sham:!Sm},{getPrototypeOf:function(_e){return Ei(An(_e))}});var ci=kr.Object.getPrototypeOf,li=function(pe,_e){var Ve=[][pe];return!!Ve&&V(function(){Ve.call(null,_e||function(){return 1},1)})},Q0=js.forEach,Bm=li("forEach")?[].forEach:function(_e){return Q0(this,_e,arguments.length>1?arguments[1]:void 0)};_n({target:"Array",proto:!0,forced:[].forEach!=Bm},{forEach:Bm});var J0=na("Array").forEach,nd=Array.prototype,Y0={DOMTokenList:!0,NodeList:!0},Kn=function(pe){var _e=pe.forEach;return pe===nd||vr(nd,pe)&&_e===nd.forEach||hn(Y0,oi(pe))?J0:_e},X0=Ne([].concat),Z0=xr("Reflect","ownKeys")||function(_e){var Ve=dc.f(lo(_e)),Oe=pc.f;return Oe?X0(Ve,Oe(_e)):Ve},Fm=Error,e1=Ne("".replace),t1=String(Fm("zxcasd").stack),$m=/\n\s*at [^:]*:[^\n]*/,r1=$m.test(t1),n1=function(pe,_e){if(r1&&typeof pe=="string"&&!Fm.prepareStackTrace)for(;_e--;)pe=e1(pe,$m,"");return pe},o1=function(pe,_e){rr(_e)&&"cause"in _e&&fa(pe,"cause",_e.cause)},a1=To("iterator"),s1=Array.prototype,Lm=function(pe){return pe!==void 0&&(Ts.Array===pe||s1[a1]===pe)},i1=To("iterator"),bl=function(pe){if(!pr(pe))return Vn(pe,i1)||Vn(pe,"@@iterator")||Ts[oi(pe)]},c1=TypeError,hc=function(pe,_e){var Ve=arguments.length<2?bl(pe):_e;if(Xr(Ve))return lo(jt(Ve,pe));throw c1(bn(pe)+" is not iterable")},od=function(pe,_e,Ve){var Oe,Ie;lo(pe);try{if(!(Oe=Vn(pe,"return"))){if(_e==="throw")throw Ve;return Ve}Oe=jt(Oe,pe)}catch(At){Ie=!0,Oe=At}if(_e==="throw")throw Ve;if(Ie)throw Oe;return lo(Oe),Ve},l1=TypeError,Tl=function(pe,_e){this.stopped=pe,this.result=_e},jm=Tl.prototype,ko=function(pe,_e,Ve){var Oe,Ie,At,nr,kt,ur,gr,Ar=Ve&&Ve.that,Rr=!(!Ve||!Ve.AS_ENTRIES),Ur=!(!Ve||!Ve.IS_RECORD),Dr=!(!Ve||!Ve.IS_ITERATOR),Jr=!(!Ve||!Ve.INTERRUPTED),Cn=Zo(_e,Ar),Sn=function(Rn){return Oe&&od(Oe,"normal",Rn),new Tl(!0,Rn)},$n=function(Rn){return Rr?(lo(Rn),Jr?Cn(Rn[0],Rn[1],Sn):Cn(Rn[0],Rn[1])):Jr?Cn(Rn,Sn):Cn(Rn)};if(Ur)Oe=pe.iterator;else if(Dr)Oe=pe;else{if(!(Ie=bl(pe)))throw l1(bn(pe)+" is not iterable");if(Lm(Ie)){for(At=0,nr=Ka(pe);nr>At;At++)if((kt=$n(pe[At]))&&vr(jm,kt))return kt;return new Tl(!1)}Oe=hc(pe,Ie)}for(ur=Ur?pe.next:Oe.next;!(gr=jt(ur,Oe)).done;){try{kt=$n(gr.value)}catch(Rn){od(Oe,"throw",Rn)}if(typeof kt=="object"&&kt&&vr(jm,kt))return kt}return new Tl(!1)},u1=function(pe,_e){return pe===void 0?arguments.length<2?"":_e:Za(pe)},d1=!V(function(){var pe=Error("a");return!("stack"in pe)||(Object.defineProperty(pe,"stack",Dt(1,7)),pe.stack!==7)}),p1=To("toStringTag"),Sl=Error,f1=[].push,vc=function(_e,Ve){var Oe,Ie=arguments.length>2?arguments[2]:void 0,At=vr(ad,this);ic?Oe=ic(Sl(),At?Ei(this):ad):(Oe=At?this:Qa(ad),fa(Oe,p1,"Error")),Ve!==void 0&&fa(Oe,"message",u1(Ve)),d1&&fa(Oe,"stack",n1(Oe.stack,1)),o1(Oe,Ie);var nr=[];return ko(_e,f1,{that:nr}),fa(Oe,"errors",nr),Oe};ic?ic(vc,Sl):function(pe,_e,Ve){for(var Oe=Z0(_e),Ie=Pa.f,At=Xa.f,nr=0;nr<Oe.length;nr++){var kt=Oe[nr];hn(pe,kt)||Ve&&hn(Ve,kt)||Ie(pe,kt,At(_e,kt))}}(vc,Sl,{name:!0});var ad=vc.prototype=Qa(Sl.prototype,{constructor:Dt(1,vc),message:Dt(1,""),name:Dt(1,"AggregateError")});_n({global:!0,constructor:!0,arity:2},{AggregateError:vc});var yc,Pi,Dm,sd,cs=er(L.process)=="process",Um=To("species"),qm=function(pe){var _e=xr(pe),Ve=Pa.f;$e&&_e&&!_e[Um]&&Ve(_e,Um,{configurable:!0,get:function(){return this}})},m1=TypeError,id=function(pe,_e){if(vr(_e,pe))return pe;throw m1("Incorrect invocation")},g1=TypeError,Ml=function(pe){if(ul(pe))return pe;throw g1(bn(pe)+" is not a constructor")},h1=To("species"),Vs=function(pe,_e){var Ve,Oe=lo(pe).constructor;return Oe===void 0||pr(Ve=lo(Oe)[h1])?_e:Ml(Ve)},v1=TypeError,Vm=function(pe,_e){if(pe<_e)throw v1("Not enough arguments");return pe},Hm=/(?:ipad|iphone|ipod).*applewebkit/i.test(_r),cd=L.setImmediate,ld=L.clearImmediate,y1=L.process,ud=L.Dispatch,b1=L.Function,zm=L.MessageChannel,T1=L.String,dd=0,bc={},S1="onreadystatechange";try{yc=L.location}catch{}var pd=function(pe){if(hn(bc,pe)){var _e=bc[pe];delete bc[pe],_e()}},fd=function(pe){return function(){pd(pe)}},Wm=function(pe){pd(pe.data)},Gm=function(pe){L.postMessage(T1(pe),yc.protocol+"//"+yc.host)};cd&&ld||(cd=function(_e){Vm(arguments.length,1);var Ve=ze(_e)?_e:b1(_e),Oe=Fs(arguments,1);return bc[++dd]=function(){le(Ve,void 0,Oe)},Pi(dd),dd},ld=function(_e){delete bc[_e]},cs?Pi=function(pe){y1.nextTick(fd(pe))}:ud&&ud.now?Pi=function(pe){ud.now(fd(pe))}:zm&&!Hm?(sd=(Dm=new zm).port2,Dm.port1.onmessage=Wm,Pi=Zo(sd.postMessage,sd)):L.addEventListener&&ze(L.postMessage)&&!L.importScripts&&yc&&yc.protocol!=="file:"&&!V(Gm)?(Pi=Gm,L.addEventListener("message",Wm,!1)):Pi=S1 in Xo("script")?function(pe){Pu.appendChild(Xo("script")).onreadystatechange=function(){Pu.removeChild(this),pd(pe)}}:function(pe){setTimeout(fd(pe),0)});var Tc,ui,Sc,Ai,md,gd,hd,Km,Qm={set:cd,clear:ld},M1=/ipad|iphone|ipod/i.test(_r)&&L.Pebble!==void 0,C1=/web0s(?!.*chrome)/i.test(_r),k1=Xa.f,vd=Qm.set,Jm=L.MutationObserver||L.WebKitMutationObserver,Ym=L.document,Xm=L.process,Cl=L.Promise,Zm=k1(L,"queueMicrotask"),eg=Zm&&Zm.value;eg||(Tc=function(){var pe,_e;for(cs&&(pe=Xm.domain)&&pe.exit();ui;){_e=ui.fn,ui=ui.next;try{_e()}catch(Ve){throw ui?Ai():Sc=void 0,Ve}}Sc=void 0,pe&&pe.enter()},Hm||cs||C1||!Jm||!Ym?!M1&&Cl&&Cl.resolve?((hd=Cl.resolve(void 0)).constructor=Cl,Km=Zo(hd.then,hd),Ai=function(){Km(Tc)}):cs?Ai=function(){Xm.nextTick(Tc)}:(vd=Zo(vd,L),Ai=function(){vd(Tc)}):(md=!0,gd=Ym.createTextNode(""),new Jm(Tc).observe(gd,{characterData:!0}),Ai=function(){gd.data=md=!md}));var yd=eg||function(pe){var _e={fn:pe,next:void 0};Sc&&(Sc.next=_e),ui||(ui=_e,Ai()),Sc=_e},Ni=function(pe){try{return{error:!1,value:pe()}}catch(_e){return{error:!0,value:_e}}},tg=function(){this.head=null,this.tail=null};tg.prototype={add:function(pe){var _e={item:pe,next:null};this.head?this.tail.next=_e:this.head=_e,this.tail=_e},get:function(){var pe=this.head;if(pe)return this.head=pe.next,this.tail===pe&&(this.tail=null),pe.item}};var bd,rg,w1=tg,Ta=L.Promise,ng=typeof Deno=="object"&&Deno&&typeof Deno.version=="object",x1=!ng&&!cs&&typeof window=="object"&&typeof document=="object",og=Ta&&Ta.prototype,_1=To("species"),ag=!1,sg=ze(L.PromiseRejectionEvent),I1=ac("Promise",function(){var pe=Vf(Ta),_e=pe!==String(Ta);if(!_e&&Br===66||!og.catch||!og.finally)return!0;if(!Br||Br<51||!/native code/.test(pe)){var Ve=new Ta(function(Ie){Ie(1)}),Oe=function(Ie){Ie(function(){},function(){})};if((Ve.constructor={})[_1]=Oe,!(ag=Ve.then(function(){})instanceof Oe))return!0}return!_e&&(x1||ng)&&!sg}),Oi={CONSTRUCTOR:I1,REJECTION_EVENT:sg,SUBCLASSING:ag},E1=TypeError,P1=function(pe){var _e,Ve;this.promise=new pe(function(Oe,Ie){if(_e!==void 0||Ve!==void 0)throw E1("Bad Promise constructor");_e=Oe,Ve=Ie}),this.resolve=Xr(_e),this.reject=Xr(Ve)},Ss={f:function(pe){return new P1(pe)}},ig=Qm.set,kl="Promise",cg=Oi.CONSTRUCTOR,A1=Oi.REJECTION_EVENT,Td=Ja.getterFor(kl),N1=Ja.set,O1=Ta&&Ta.prototype,Mc=Ta,Sd=O1,lg=L.TypeError,Md=L.document,Cd=L.process,kd=Ss.f,R1=kd,B1=!!(Md&&Md.createEvent&&L.dispatchEvent),ug="unhandledrejection",dg=function(pe){var _e;return!(!rr(pe)||!ze(_e=pe.then))&&_e},pg=function(pe,_e){var Ve,Oe,Ie,At=_e.value,nr=_e.state==1,kt=nr?pe.ok:pe.fail,ur=pe.resolve,gr=pe.reject,Ar=pe.domain;try{kt?(nr||(_e.rejection===2&&$1(_e),_e.rejection=1),kt===!0?Ve=At:(Ar&&Ar.enter(),Ve=kt(At),Ar&&(Ar.exit(),Ie=!0)),Ve===pe.promise?gr(lg("Promise-chain cycle")):(Oe=dg(Ve))?jt(Oe,Ve,ur,gr):ur(Ve)):gr(At)}catch(Rr){Ar&&!Ie&&Ar.exit(),gr(Rr)}},fg=function(pe,_e){pe.notified||(pe.notified=!0,yd(function(){for(var Ve,Oe=pe.reactions;Ve=Oe.get();)pg(Ve,pe);pe.notified=!1,_e&&!pe.rejection&&F1(pe)}))},mg=function(pe,_e,Ve){var Oe,Ie;B1?((Oe=Md.createEvent("Event")).promise=_e,Oe.reason=Ve,Oe.initEvent(pe,!1,!0),L.dispatchEvent(Oe)):Oe={promise:_e,reason:Ve},!A1&&(Ie=L["on"+pe])?Ie(Oe):pe===ug&&function(At,nr){var kt=L.console;kt&&kt.error&&(arguments.length==1?kt.error(At):kt.error(At,nr))}("Unhandled promise rejection",Ve)},F1=function(pe){jt(ig,L,function(){var _e,Ve=pe.facade,Oe=pe.value;if(gg(pe)&&(_e=Ni(function(){cs?Cd.emit("unhandledRejection",Oe,Ve):mg(ug,Ve,Oe)}),pe.rejection=cs||gg(pe)?2:1,_e.error))throw _e.value})},gg=function(pe){return pe.rejection!==1&&!pe.parent},$1=function(pe){jt(ig,L,function(){var _e=pe.facade;cs?Cd.emit("rejectionHandled",_e):mg("rejectionhandled",_e,pe.value)})},Ri=function(pe,_e,Ve){return function(Oe){pe(_e,Oe,Ve)}},Bi=function(pe,_e,Ve){pe.done||(pe.done=!0,Ve&&(pe=Ve),pe.value=_e,pe.state=2,fg(pe,!0))},wd=function(pe,_e,Ve){if(!pe.done){pe.done=!0,Ve&&(pe=Ve);try{if(pe.facade===_e)throw lg("Promise can't be resolved itself");var Oe=dg(_e);Oe?yd(function(){var Ie={done:!1};try{jt(Oe,_e,Ri(wd,Ie,pe),Ri(Bi,Ie,pe))}catch(At){Bi(Ie,At,pe)}}):(pe.value=_e,pe.state=1,fg(pe,!1))}catch(Ie){Bi({done:!1},Ie,pe)}}};cg&&(Sd=(Mc=function(_e){id(this,Sd),Xr(_e),jt(bd,this);var Ve=Td(this);try{_e(Ri(wd,Ve),Ri(Bi,Ve))}catch(Oe){Bi(Ve,Oe)}}).prototype,(bd=function(_e){N1(this,{type:kl,done:!1,notified:!1,parent:!1,reactions:new w1,rejection:!1,state:0,value:void 0})}).prototype=$s(Sd,"then",function(_e,Ve){var Oe=Td(this),Ie=kd(Vs(this,Mc));return Oe.parent=!0,Ie.ok=!ze(_e)||_e,Ie.fail=ze(Ve)&&Ve,Ie.domain=cs?Cd.domain:void 0,Oe.state==0?Oe.reactions.add(Ie):yd(function(){pg(Ie,Oe)}),Ie.promise}),rg=function(){var pe=new bd,_e=Td(pe);this.promise=pe,this.resolve=Ri(wd,_e),this.reject=Ri(Bi,_e)},Ss.f=kd=function(pe){return pe===Mc||pe===void 0?new rg(pe):R1(pe)}),_n({global:!0,constructor:!0,wrap:!0,forced:cg},{Promise:Mc}),ai(Mc,kl,!1,!0),qm(kl);var hg=To("iterator"),vg=!1;try{var L1=0,yg={next:function(){return{done:!!L1++}},return:function(){vg=!0}};yg[hg]=function(){return this},Array.from(yg,function(){throw 2})}catch{}var bg=function(pe,_e){if(!_e&&!vg)return!1;var Ve=!1;try{var Oe={};Oe[hg]=function(){return{next:function(){return{done:Ve=!0}}}},pe(Oe)}catch{}return Ve},Tg=Oi.CONSTRUCTOR||!bg(function(pe){Ta.all(pe).then(void 0,function(){})});_n({target:"Promise",stat:!0,forced:Tg},{all:function(_e){var Ve=this,Oe=Ss.f(Ve),Ie=Oe.resolve,At=Oe.reject,nr=Ni(function(){var kt=Xr(Ve.resolve),ur=[],gr=0,Ar=1;ko(_e,function(Rr){var Ur=gr++,Dr=!1;Ar++,jt(kt,Ve,Rr).then(function(Jr){Dr||(Dr=!0,ur[Ur]=Jr,--Ar||Ie(ur))},At)}),--Ar||Ie(ur)});return nr.error&&At(nr.value),Oe.promise}});var j1=Oi.CONSTRUCTOR;Ta&&Ta.prototype,_n({target:"Promise",proto:!0,forced:j1,real:!0},{catch:function(pe){return this.then(void 0,pe)}}),_n({target:"Promise",stat:!0,forced:Tg},{race:function(_e){var Ve=this,Oe=Ss.f(Ve),Ie=Oe.reject,At=Ni(function(){var nr=Xr(Ve.resolve);ko(_e,function(kt){jt(nr,Ve,kt).then(Oe.resolve,Ie)})});return At.error&&Ie(At.value),Oe.promise}}),_n({target:"Promise",stat:!0,forced:Oi.CONSTRUCTOR},{reject:function(_e){var Ve=Ss.f(this);return jt(Ve.reject,void 0,_e),Ve.promise}});var xd=function(pe,_e){if(lo(pe),rr(_e)&&_e.constructor===pe)return _e;var Ve=Ss.f(pe);return(0,Ve.resolve)(_e),Ve.promise},D1=Oi.CONSTRUCTOR,U1=xr("Promise"),q1=!D1;_n({target:"Promise",stat:!0,forced:!0},{resolve:function(_e){return xd(q1&&this===U1?Ta:this,_e)}}),_n({target:"Promise",stat:!0},{allSettled:function(_e){var Ve=this,Oe=Ss.f(Ve),Ie=Oe.resolve,At=Oe.reject,nr=Ni(function(){var kt=Xr(Ve.resolve),ur=[],gr=0,Ar=1;ko(_e,function(Rr){var Ur=gr++,Dr=!1;Ar++,jt(kt,Ve,Rr).then(function(Jr){Dr||(Dr=!0,ur[Ur]={status:"fulfilled",value:Jr},--Ar||Ie(ur))},function(Jr){Dr||(Dr=!0,ur[Ur]={status:"rejected",reason:Jr},--Ar||Ie(ur))})}),--Ar||Ie(ur)});return nr.error&&At(nr.value),Oe.promise}});var Sg="No one promise resolved";_n({target:"Promise",stat:!0},{any:function(_e){var Ve=this,Oe=xr("AggregateError"),Ie=Ss.f(Ve),At=Ie.resolve,nr=Ie.reject,kt=Ni(function(){var ur=Xr(Ve.resolve),gr=[],Ar=0,Rr=1,Ur=!1;ko(_e,function(Dr){var Jr=Ar++,Cn=!1;Rr++,jt(ur,Ve,Dr).then(function(Sn){Cn||Ur||(Ur=!0,At(Sn))},function(Sn){Cn||Ur||(Cn=!0,gr[Jr]=Sn,--Rr||nr(new Oe(gr,Sg)))})}),--Rr||nr(new Oe(gr,Sg))});return kt.error&&nr(kt.value),Ie.promise}});var V1=Ta&&Ta.prototype,H1=!!Ta&&V(function(){V1.finally.call({then:function(){}},function(){})});_n({target:"Promise",proto:!0,real:!0,forced:H1},{finally:function(pe){var _e=Vs(this,xr("Promise")),Ve=ze(pe);return this.then(Ve?function(Oe){return xd(_e,pe()).then(function(){return Oe})}:pe,Ve?function(Oe){return xd(_e,pe()).then(function(){throw Oe})}:pe)}});var z1=kr.Promise;_n({target:"Promise",stat:!0,forced:!0},{try:function(pe){var _e=Ss.f(this),Ve=Ni(pe);return(Ve.error?_e.reject:_e.resolve)(Ve.value),_e.promise}});var wo=z1,W1=Ne([].reverse),Mg=[1,2];_n({target:"Array",proto:!0,forced:String(Mg)===String(Mg.reverse())},{reverse:function(){return ys(this)&&(this.length=this.length),W1(this)}});var G1=na("Array").reverse,_d=Array.prototype,Kl=function(pe){var _e=pe.reverse;return pe===_d||vr(_d,pe)&&_e===_d.reverse?G1:_e},K1=lc("slice"),Q1=To("species"),Id=Array,J1=Math.max;_n({target:"Array",proto:!0,forced:!K1},{slice:function(_e,Ve){var Oe,Ie,At,nr=Pr(this),kt=Ka(nr),ur=xi(_e,kt),gr=xi(Ve===void 0?kt:Ve,kt);if(ys(nr)&&(Oe=nr.constructor,(ul(Oe)&&(Oe===Id||ys(Oe.prototype))||rr(Oe)&&(Oe=Oe[Q1])===null)&&(Oe=void 0),Oe===Id||Oe===void 0))return Fs(nr,ur,gr);for(Ie=new(Oe===void 0?Id:Oe)(J1(gr-ur,0)),At=0;ur<gr;ur++,At++)ur in nr&&ni(Ie,At,nr[ur]);return Ie.length=At,Ie}});var Y1=na("Array").slice,Ed=Array.prototype,Fo=function(pe){var _e=pe.slice;return pe===Ed||vr(Ed,pe)&&_e===Ed.slice?Y1:_e},X1=g(function(pe){var _e=W0.default;function Ve(){pe.exports=Ve=function(){return Oe},pe.exports.__esModule=!0,pe.exports.default=pe.exports;var Oe={},Ie=Object.prototype,At=Ie.hasOwnProperty,nr=typeof Ba=="function"?Ba:{},kt=nr.iterator||"@@iterator",ur=nr.asyncIterator||"@@asyncIterator",gr=nr.toStringTag||"@@toStringTag";function Ar(qn,Bn,Xn){return gc(qn,Bn,{value:Xn,enumerable:!0,configurable:!0,writable:!0}),qn[Bn]}try{Ar({},"")}catch{Ar=function(Xn,so,yo){return Xn[so]=yo}}function Rr(qn,Bn,Xn,so){var yo=Bn&&Bn.prototype instanceof Jr?Bn:Jr,bo=vs(yo.prototype),ta=new Wr(so||[]);return bo._invoke=function(Po,ha,Bo){var qo="suspendedStart";return function(va,Wi){if(qo==="executing")throw new Error("Generator is already running");if(qo==="completed"){if(va==="throw")throw Wi;return Zn()}for(Bo.method=va,Bo.arg=Wi;;){var Ho=Bo.delegate;if(Ho){var Gi=ao(Ho,Bo);if(Gi){if(Gi===Dr)continue;return Gi}}if(Bo.method==="next")Bo.sent=Bo._sent=Bo.arg;else if(Bo.method==="throw"){if(qo==="suspendedStart")throw qo="completed",Bo.arg;Bo.dispatchException(Bo.arg)}else Bo.method==="return"&&Bo.abrupt("return",Bo.arg);qo="executing";var as=Ur(Po,ha,Bo);if(as.type==="normal"){if(qo=Bo.done?"completed":"suspendedYield",as.arg===Dr)continue;return{value:as.arg,done:Bo.done}}as.type==="throw"&&(qo="completed",Bo.method="throw",Bo.arg=as.arg)}}}(qn,Xn,ta),bo}function Ur(qn,Bn,Xn){try{return{type:"normal",arg:qn.call(Bn,Xn)}}catch(so){return{type:"throw",arg:so}}}Oe.wrap=Rr;var Dr={};function Jr(){}function Cn(){}function Sn(){}var $n={};Ar($n,kt,function(){return this});var Rn=ci&&ci(ci(Gn([])));Rn&&Rn!==Ie&&At.call(Rn,kt)&&($n=Rn);var Wn=Sn.prototype=Jr.prototype=vs($n);function Fn(qn){var Bn;Kn(Bn=["next","throw","return"]).call(Bn,function(Xn){Ar(qn,Xn,function(so){return this._invoke(Xn,so)})})}function mo(qn,Bn){function Xn(yo,bo,ta,Po){var ha=Ur(qn[yo],qn,bo);if(ha.type!=="throw"){var Bo=ha.arg,qo=Bo.value;return qo&&_e(qo)=="object"&&At.call(qo,"__await")?Bn.resolve(qo.__await).then(function(va){Xn("next",va,ta,Po)},function(va){Xn("throw",va,ta,Po)}):Bn.resolve(qo).then(function(va){Bo.value=va,ta(Bo)},function(va){return Xn("throw",va,ta,Po)})}Po(ha.arg)}var so;this._invoke=function(yo,bo){function ta(){return new Bn(function(Po,ha){Xn(yo,bo,Po,ha)})}return so=so?so.then(ta,ta):ta()}}function ao(qn,Bn){var Xn=qn.iterator[Bn.method];if(Xn===void 0){if(Bn.delegate=null,Bn.method==="throw"){if(qn.iterator.return&&(Bn.method="return",Bn.arg=void 0,ao(qn,Bn),Bn.method==="throw"))return Dr;Bn.method="throw",Bn.arg=new TypeError("The iterator does not provide a 'throw' method")}return Dr}var so=Ur(Xn,qn.iterator,Bn.arg);if(so.type==="throw")return Bn.method="throw",Bn.arg=so.arg,Bn.delegate=null,Dr;var yo=so.arg;return yo?yo.done?(Bn[qn.resultName]=yo.value,Bn.next=qn.nextLoc,Bn.method!=="return"&&(Bn.method="next",Bn.arg=void 0),Bn.delegate=null,Dr):yo:(Bn.method="throw",Bn.arg=new TypeError("iterator result is not an object"),Bn.delegate=null,Dr)}function ea(qn){var Bn={tryLoc:qn[0]};1 in qn&&(Bn.catchLoc=qn[1]),2 in qn&&(Bn.finallyLoc=qn[2],Bn.afterLoc=qn[3]),this.tryEntries.push(Bn)}function oo(qn){var Bn=qn.completion||{};Bn.type="normal",delete Bn.arg,qn.completion=Bn}function Wr(qn){this.tryEntries=[{tryLoc:"root"}],Kn(qn).call(qn,ea,this),this.reset(!0)}function Gn(qn){if(qn){var Bn=qn[kt];if(Bn)return Bn.call(qn);if(typeof qn.next=="function")return qn;if(!isNaN(qn.length)){var Xn=-1,so=function yo(){for(;++Xn<qn.length;)if(At.call(qn,Xn))return yo.value=qn[Xn],yo.done=!1,yo;return yo.value=void 0,yo.done=!0,yo};return so.next=so}}return{next:Zn}}function Zn(){return{value:void 0,done:!0}}return Cn.prototype=Sn,Ar(Wn,"constructor",Sn),Ar(Sn,"constructor",Cn),Cn.displayName=Ar(Sn,gr,"GeneratorFunction"),Oe.isGeneratorFunction=function(qn){var Bn=typeof qn=="function"&&qn.constructor;return!!Bn&&(Bn===Cn||(Bn.displayName||Bn.name)==="GeneratorFunction")},Oe.mark=function(qn){return ri?ri(qn,Sn):(qn.__proto__=Sn,Ar(qn,gr,"GeneratorFunction")),qn.prototype=vs(Wn),qn},Oe.awrap=function(qn){return{__await:qn}},Fn(mo.prototype),Ar(mo.prototype,ur,function(){return this}),Oe.AsyncIterator=mo,Oe.async=function(qn,Bn,Xn,so,yo){yo===void 0&&(yo=wo);var bo=new mo(Rr(qn,Bn,Xn,so),yo);return Oe.isGeneratorFunction(Bn)?bo:bo.next().then(function(ta){return ta.done?ta.value:bo.next()})},Fn(Wn),Ar(Wn,gr,"Generator"),Ar(Wn,kt,function(){return this}),Ar(Wn,"toString",function(){return"[object Generator]"}),Oe.keys=function(qn){var Bn=[];for(var Xn in qn)Bn.push(Xn);return Kl(Bn).call(Bn),function so(){for(;Bn.length;){var yo=Bn.pop();if(yo in qn)return so.value=yo,so.done=!1,so}return so.done=!0,so}},Oe.values=Gn,Wr.prototype={constructor:Wr,reset:function(Bn){var Xn;if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,Kn(Xn=this.tryEntries).call(Xn,oo),!Bn)for(var so in this)so.charAt(0)==="t"&&At.call(this,so)&&!isNaN(+Fo(so).call(so,1))&&(this[so]=void 0)},stop:function(){this.done=!0;var Bn=this.tryEntries[0].completion;if(Bn.type==="throw")throw Bn.arg;return this.rval},dispatchException:function(Bn){if(this.done)throw Bn;var Xn=this;function so(Bo,qo){return ta.type="throw",ta.arg=Bn,Xn.next=Bo,qo&&(Xn.method="next",Xn.arg=void 0),!!qo}for(var yo=this.tryEntries.length-1;yo>=0;--yo){var bo=this.tryEntries[yo],ta=bo.completion;if(bo.tryLoc==="root")return so("end");if(bo.tryLoc<=this.prev){var Po=At.call(bo,"catchLoc"),ha=At.call(bo,"finallyLoc");if(Po&&ha){if(this.prev<bo.catchLoc)return so(bo.catchLoc,!0);if(this.prev<bo.finallyLoc)return so(bo.finallyLoc)}else if(Po){if(this.prev<bo.catchLoc)return so(bo.catchLoc,!0)}else{if(!ha)throw new Error("try statement without catch or finally");if(this.prev<bo.finallyLoc)return so(bo.finallyLoc)}}}},abrupt:function(Bn,Xn){for(var so=this.tryEntries.length-1;so>=0;--so){var yo=this.tryEntries[so];if(yo.tryLoc<=this.prev&&At.call(yo,"finallyLoc")&&this.prev<yo.finallyLoc){var bo=yo;break}}bo&&(Bn==="break"||Bn==="continue")&&bo.tryLoc<=Xn&&Xn<=bo.finallyLoc&&(bo=null);var ta=bo?bo.completion:{};return ta.type=Bn,ta.arg=Xn,bo?(this.method="next",this.next=bo.finallyLoc,Dr):this.complete(ta)},complete:function(Bn,Xn){if(Bn.type==="throw")throw Bn.arg;return Bn.type==="break"||Bn.type==="continue"?this.next=Bn.arg:Bn.type==="return"?(this.rval=this.arg=Bn.arg,this.method="return",this.next="end"):Bn.type==="normal"&&Xn&&(this.next=Xn),Dr},finish:function(Bn){for(var Xn=this.tryEntries.length-1;Xn>=0;--Xn){var so=this.tryEntries[Xn];if(so.finallyLoc===Bn)return this.complete(so.completion,so.afterLoc),oo(so),Dr}},catch:function(Bn){for(var Xn=this.tryEntries.length-1;Xn>=0;--Xn){var so=this.tryEntries[Xn];if(so.tryLoc===Bn){var yo=so.completion;if(yo.type==="throw"){var bo=yo.arg;oo(so)}return bo}}throw new Error("illegal catch attempt")},delegateYield:function(Bn,Xn,so){return this.delegate={iterator:Gn(Bn),resultName:Xn,nextLoc:so},this.method==="next"&&(this.arg=void 0),Dr}},Oe}pe.exports=Ve,pe.exports.__esModule=!0,pe.exports.default=pe.exports}),wl=X1(),wr=wl;try{regeneratorRuntime=wl}catch{typeof globalThis=="object"?globalThis.regeneratorRuntime=wl:Function("r","regeneratorRuntime = r")(wl)}_n({target:"Number",stat:!0,nonConfigurable:!0,nonWritable:!0},{MAX_SAFE_INTEGER:9007199254740991});var Cg=9007199254740991,Ql=Object.assign,aa=Object.defineProperty,Jl=Ne([].concat),kg=!Ql||V(function(){if($e&&Ql({b:1},Ql(aa({},"a",{enumerable:!0,get:function(){aa(this,"b",{value:3,enumerable:!1})}}),{b:2})).b!==1)return!0;var pe={},_e={},Ve=Symbol(),Oe="abcdefghijklmnopqrst";return pe[Ve]=7,Oe.split("").forEach(function(Ie){_e[Ie]=Ie}),Ql({},pe)[Ve]!=7||Bs(Ql({},_e)).join("")!=Oe})?function(_e,Ve){for(var Oe=An(_e),Ie=arguments.length,At=1,nr=pc.f,kt=dr.f;Ie>At;)for(var ur,gr=hr(arguments[At++]),Ar=nr?Jl(Bs(gr),nr(gr)):Bs(gr),Rr=Ar.length,Ur=0;Rr>Ur;)ur=Ar[Ur++],$e&&!jt(kt,gr,ur)||(Oe[ur]=gr[ur]);return Oe}:Ql;_n({target:"Object",stat:!0,arity:2,forced:Object.assign!==kg},{assign:kg});var jn=kr.Object.assign;function Yl(pe,_e){var Ve={};for(var Oe in pe)Object.prototype.hasOwnProperty.call(pe,Oe)&&_e.indexOf(Oe)<0&&(Ve[Oe]=pe[Oe]);if(pe!=null&&typeof Object.getOwnPropertySymbols=="function"){var Ie=0;for(Oe=Object.getOwnPropertySymbols(pe);Ie<Oe.length;Ie++)_e.indexOf(Oe[Ie])<0&&Object.prototype.propertyIsEnumerable.call(pe,Oe[Ie])&&(Ve[Oe[Ie]]=pe[Oe[Ie]])}return Ve}function Hr(pe,_e,Ve,Oe){return new(Ve||(Ve=Promise))(function(Ie,At){function nr(gr){try{ur(Oe.next(gr))}catch(Ar){At(Ar)}}function kt(gr){try{ur(Oe.throw(gr))}catch(Ar){At(Ar)}}function ur(gr){gr.done?Ie(gr.value):function(Rr){return Rr instanceof Ve?Rr:new Ve(function(Ur){Ur(Rr)})}(gr.value).then(nr,kt)}ur((Oe=Oe.apply(pe,_e||[])).next())})}var yv=V(function(){if(typeof ArrayBuffer=="function"){var pe=new ArrayBuffer(8);Object.isExtensible(pe)&&Object.defineProperty(pe,"a",{value:8})}}),la=Object.isExtensible,wg=V(function(){la(1)})||yv?function(_e){return!!rr(_e)&&(!yv||er(_e)!="ArrayBuffer")&&(!la||la(_e))}:la,xg=!V(function(){return Object.isExtensible(Object.preventExtensions({}))}),_g=g(function(pe){var _e=Pa.f,Ve=!1,Oe=Uo("meta"),Ie=0,At=function(kt){_e(kt,Oe,{value:{objectID:"O"+Ie++,weakData:{}}})},nr=pe.exports={enable:function(){nr.enable=function(){},Ve=!0;var kt=dc.f,ur=Ne([].splice),gr={};gr[Oe]=1,kt(gr).length&&(dc.f=function(Ar){for(var Rr=kt(Ar),Ur=0,Dr=Rr.length;Ur<Dr;Ur++)if(Rr[Ur]===Oe){ur(Rr,Ur,1);break}return Rr},_n({target:"Object",stat:!0,forced:!0},{getOwnPropertyNames:Uu.f}))},fastKey:function(kt,ur){if(!rr(kt))return typeof kt=="symbol"?kt:(typeof kt=="string"?"S":"P")+kt;if(!hn(kt,Oe)){if(!wg(kt))return"F";if(!ur)return"E";At(kt)}return kt[Oe].objectID},getWeakData:function(kt,ur){if(!hn(kt,Oe)){if(!wg(kt))return!0;if(!ur)return!1;At(kt)}return kt[Oe].weakData},onFreeze:function(kt){return xg&&Ve&&wg(kt)&&!hn(kt,Oe)&&At(kt),kt}};_i[Oe]=!0}),Z1=Pa.f,eT=js.forEach,Ig=Ja.set,Va=Ja.getterFor,bv=function(pe,_e,Ve){var Oe,Ie=pe.indexOf("Map")!==-1,At=pe.indexOf("Weak")!==-1,nr=Ie?"set":"add",kt=L[pe],ur=kt&&kt.prototype,gr={};if($e&&ze(kt)&&(At||ur.forEach&&!V(function(){new kt().entries().next()}))){var Ar=(Oe=_e(function(Ur,Dr){Ig(id(Ur,Ar),{type:pe,collection:new kt}),Dr!=null&&ko(Dr,Ur[nr],{that:Ur,AS_ENTRIES:Ie})})).prototype,Rr=Va(pe);eT(["add","clear","delete","forEach","get","has","set","keys","values","entries"],function(Ur){var Dr=Ur=="add"||Ur=="set";!(Ur in ur)||At&&Ur=="clear"||fa(Ar,Ur,function(Jr,Cn){var Sn=Rr(this).collection;if(!Dr&&At&&!rr(Jr))return Ur=="get"&&void 0;var $n=Sn[Ur](Jr===0?0:Jr,Cn);return Dr?this:$n})}),At||Z1(Ar,"size",{configurable:!0,get:function(){return Rr(this).collection.size}})}else Oe=Ve.getConstructor(_e,pe,Ie,nr),_g.enable();return ai(Oe,pe,!1,!0),gr[pe]=Oe,_n({global:!0,forced:!0},gr),At||Ve.setStrong(Oe,pe,Ie),Oe},Sp=function(pe,_e,Ve){for(var Oe in _e)Ve&&Ve.unsafe&&pe[Oe]?pe[Oe]=_e[Oe]:$s(pe,Oe,_e[Oe],Ve);return pe},Hs=Pa.f,Ys=_g.fastKey,Un=Ja.set,Mp=Ja.getterFor,Pd={getConstructor:function(pe,_e,Ve,Oe){var Ie=pe(function(gr,Ar){id(gr,At),Un(gr,{type:_e,index:Qa(null),first:void 0,last:void 0,size:0}),$e||(gr.size=0),pr(Ar)||ko(Ar,gr[Oe],{that:gr,AS_ENTRIES:Ve})}),At=Ie.prototype,nr=Mp(_e),kt=function(gr,Ar,Rr){var Ur,Dr,Jr=nr(gr),Cn=ur(gr,Ar);return Cn?Cn.value=Rr:(Jr.last=Cn={index:Dr=Ys(Ar,!0),key:Ar,value:Rr,previous:Ur=Jr.last,next:void 0,removed:!1},Jr.first||(Jr.first=Cn),Ur&&(Ur.next=Cn),$e?Jr.size++:gr.size++,Dr!=="F"&&(Jr.index[Dr]=Cn)),gr},ur=function(gr,Ar){var Rr,Ur=nr(gr),Dr=Ys(Ar);if(Dr!=="F")return Ur.index[Dr];for(Rr=Ur.first;Rr;Rr=Rr.next)if(Rr.key==Ar)return Rr};return Sp(At,{clear:function(){for(var Ar=nr(this),Rr=Ar.index,Ur=Ar.first;Ur;)Ur.removed=!0,Ur.previous&&(Ur.previous=Ur.previous.next=void 0),delete Rr[Ur.index],Ur=Ur.next;Ar.first=Ar.last=void 0,$e?Ar.size=0:this.size=0},delete:function(gr){var Ar=this,Rr=nr(Ar),Ur=ur(Ar,gr);if(Ur){var Dr=Ur.next,Jr=Ur.previous;delete Rr.index[Ur.index],Ur.removed=!0,Jr&&(Jr.next=Dr),Dr&&(Dr.previous=Jr),Rr.first==Ur&&(Rr.first=Dr),Rr.last==Ur&&(Rr.last=Jr),$e?Rr.size--:Ar.size--}return!!Ur},forEach:function(Ar){for(var Rr,Ur=nr(this),Dr=Zo(Ar,arguments.length>1?arguments[1]:void 0);Rr=Rr?Rr.next:Ur.first;)for(Dr(Rr.value,Rr.key,this);Rr&&Rr.removed;)Rr=Rr.previous},has:function(Ar){return!!ur(this,Ar)}}),Sp(At,Ve?{get:function(Ar){var Rr=ur(this,Ar);return Rr&&Rr.value},set:function(Ar,Rr){return kt(this,Ar===0?0:Ar,Rr)}}:{add:function(Ar){return kt(this,Ar=Ar===0?0:Ar,Ar)}}),$e&&Hs(At,"size",{get:function(){return nr(this).size}}),Ie},setStrong:function(pe,_e,Ve){var Oe=_e+" Iterator",Ie=Mp(_e),At=Mp(Oe);ed(pe,_e,function(nr,kt){Un(this,{type:Oe,target:nr,state:Ie(nr),kind:kt,last:void 0})},function(){for(var nr=At(this),kt=nr.kind,ur=nr.last;ur&&ur.removed;)ur=ur.previous;return nr.target&&(nr.last=ur=ur?ur.next:nr.state.first)?kt=="keys"?{value:ur.key,done:!1}:kt=="values"?{value:ur.value,done:!1}:{value:[ur.key,ur.value],done:!1}:(nr.target=void 0,{value:void 0,done:!0})},Ve?"entries":"values",!Ve,!0),qm(_e)}};bv("Map",function(pe){return function(){return pe(this,arguments.length?arguments[0]:void 0)}},Pd);var Eg=kr.Map,Tv=[].push,Pg=function(_e){var Ve,Oe,Ie,At,nr=arguments.length,kt=nr>1?arguments[1]:void 0;return Ml(this),(Ve=kt!==void 0)&&Xr(kt),pr(_e)?new this:(Oe=[],Ve?(Ie=0,At=Zo(kt,nr>2?arguments[2]:void 0),ko(_e,function(ur){jt(Tv,Oe,At(ur,Ie++))})):ko(_e,Tv,{that:Oe}),new this(Oe))};_n({target:"Map",stat:!0,forced:!0},{from:Pg});var Sv=function(){return new this(Fs(arguments))};_n({target:"Map",stat:!0,forced:!0},{of:Sv});var Mv=function(){for(var _e,Ve=lo(this),Oe=Xr(Ve.delete),Ie=!0,At=0,nr=arguments.length;At<nr;At++)_e=jt(Oe,Ve,arguments[At]),Ie=Ie&&_e;return!!Ie};_n({target:"Map",proto:!0,real:!0,forced:!0},{deleteAll:Mv}),_n({target:"Map",proto:!0,real:!0,forced:!0},{emplace:function(_e,Ve){var Oe,Ie,At=lo(this),nr=Xr(At.get),kt=Xr(At.has),ur=Xr(At.set);return jt(kt,At,_e)?(Oe=jt(nr,At,_e),"update"in Ve&&(Oe=Ve.update(Oe,_e,At),jt(ur,At,_e,Oe)),Oe):(Ie=Ve.insert(_e,At),jt(ur,At,_e,Ie),Ie)}});var Ki=hc;_n({target:"Map",proto:!0,real:!0,forced:!0},{every:function(_e){var Ve=lo(this),Oe=Ki(Ve),Ie=Zo(_e,arguments.length>1?arguments[1]:void 0);return!ko(Oe,function(At,nr,kt){if(!Ie(nr,At,Ve))return kt()},{AS_ENTRIES:!0,IS_ITERATOR:!0,INTERRUPTED:!0}).stopped}}),_n({target:"Map",proto:!0,real:!0,forced:!0},{filter:function(_e){var Ve=lo(this),Oe=Ki(Ve),Ie=Zo(_e,arguments.length>1?arguments[1]:void 0),At=new(Vs(Ve,xr("Map"))),nr=Xr(At.set);return ko(Oe,function(kt,ur){Ie(ur,kt,Ve)&&jt(nr,At,kt,ur)},{AS_ENTRIES:!0,IS_ITERATOR:!0}),At}}),_n({target:"Map",proto:!0,real:!0,forced:!0},{find:function(_e){var Ve=lo(this),Oe=Ki(Ve),Ie=Zo(_e,arguments.length>1?arguments[1]:void 0);return ko(Oe,function(At,nr,kt){if(Ie(nr,At,Ve))return kt(nr)},{AS_ENTRIES:!0,IS_ITERATOR:!0,INTERRUPTED:!0}).result}}),_n({target:"Map",proto:!0,real:!0,forced:!0},{findKey:function(_e){var Ve=lo(this),Oe=Ki(Ve),Ie=Zo(_e,arguments.length>1?arguments[1]:void 0);return ko(Oe,function(At,nr,kt){if(Ie(nr,At,Ve))return kt(At)},{AS_ENTRIES:!0,IS_ITERATOR:!0,INTERRUPTED:!0}).result}});var tT=Ne([].push);_n({target:"Map",stat:!0,forced:!0},{groupBy:function(_e,Ve){Xr(Ve);var Oe=hc(_e),Ie=new this,At=Xr(Ie.has),nr=Xr(Ie.get),kt=Xr(Ie.set);return ko(Oe,function(ur){var gr=Ve(ur);jt(At,Ie,gr)?tT(jt(nr,Ie,gr),ur):jt(kt,Ie,gr,[ur])},{IS_ITERATOR:!0}),Ie}}),_n({target:"Map",proto:!0,real:!0,forced:!0},{includes:function(_e){return ko(Ki(lo(this)),function(Ve,Oe,Ie){if((At=Oe)===(nr=_e)||At!=At&&nr!=nr)return Ie();var At,nr},{AS_ENTRIES:!0,IS_ITERATOR:!0,INTERRUPTED:!0}).stopped}}),_n({target:"Map",stat:!0,forced:!0},{keyBy:function(_e,Ve){var Oe=new this;Xr(Ve);var Ie=Xr(Oe.set);return ko(_e,function(At){jt(Ie,Oe,Ve(At),At)}),Oe}}),_n({target:"Map",proto:!0,real:!0,forced:!0},{keyOf:function(_e){return ko(Ki(lo(this)),function(Ve,Oe,Ie){if(Oe===_e)return Ie(Ve)},{AS_ENTRIES:!0,IS_ITERATOR:!0,INTERRUPTED:!0}).result}}),_n({target:"Map",proto:!0,real:!0,forced:!0},{mapKeys:function(_e){var Ve=lo(this),Oe=Ki(Ve),Ie=Zo(_e,arguments.length>1?arguments[1]:void 0),At=new(Vs(Ve,xr("Map"))),nr=Xr(At.set);return ko(Oe,function(kt,ur){jt(nr,At,Ie(ur,kt,Ve),ur)},{AS_ENTRIES:!0,IS_ITERATOR:!0}),At}}),_n({target:"Map",proto:!0,real:!0,forced:!0},{mapValues:function(_e){var Ve=lo(this),Oe=Ki(Ve),Ie=Zo(_e,arguments.length>1?arguments[1]:void 0),At=new(Vs(Ve,xr("Map"))),nr=Xr(At.set);return ko(Oe,function(kt,ur){jt(nr,At,kt,Ie(ur,kt,Ve))},{AS_ENTRIES:!0,IS_ITERATOR:!0}),At}}),_n({target:"Map",proto:!0,real:!0,arity:1,forced:!0},{merge:function(_e){for(var Ve=lo(this),Oe=Xr(Ve.set),Ie=arguments.length,At=0;At<Ie;)ko(arguments[At++],Oe,{that:Ve,AS_ENTRIES:!0});return Ve}});var Cv=TypeError;_n({target:"Map",proto:!0,real:!0,forced:!0},{reduce:function(_e){var Ve=lo(this),Oe=Ki(Ve),Ie=arguments.length<2,At=Ie?void 0:arguments[1];if(Xr(_e),ko(Oe,function(nr,kt){Ie?(Ie=!1,At=kt):At=_e(At,kt,nr,Ve)},{AS_ENTRIES:!0,IS_ITERATOR:!0}),Ie)throw Cv("Reduce of empty map with no initial value");return At}}),_n({target:"Map",proto:!0,real:!0,forced:!0},{some:function(_e){var Ve=lo(this),Oe=Ki(Ve),Ie=Zo(_e,arguments.length>1?arguments[1]:void 0);return ko(Oe,function(At,nr,kt){if(Ie(nr,At,Ve))return kt()},{AS_ENTRIES:!0,IS_ITERATOR:!0,INTERRUPTED:!0}).stopped}});var rT=TypeError;_n({target:"Map",proto:!0,real:!0,forced:!0},{update:function(_e,Ve){var Oe=lo(this),Ie=Xr(Oe.get),At=Xr(Oe.has),nr=Xr(Oe.set),kt=arguments.length;Xr(Ve);var ur=jt(At,Oe,_e);if(!ur&&kt<3)throw rT("Updating absent value");var gr=ur?jt(Ie,Oe,_e):Xr(kt>2?arguments[2]:void 0)(_e,Oe);return jt(nr,Oe,_e,Ve(gr,_e,Oe)),Oe}});var kv=TypeError,Ag=function(_e,Ve){var Oe,Ie=lo(this),At=Xr(Ie.get),nr=Xr(Ie.has),kt=Xr(Ie.set),ur=arguments.length>2?arguments[2]:void 0;if(!ze(Ve)&&!ze(ur))throw kv("At least one callback required");return jt(nr,Ie,_e)?(Oe=jt(At,Ie,_e),ze(Ve)&&(Oe=Ve(Oe),jt(kt,Ie,_e,Oe))):ze(ur)&&(Oe=ur(),jt(kt,Ie,_e,Oe)),Oe};_n({target:"Map",proto:!0,real:!0,forced:!0},{upsert:Ag}),_n({target:"Map",proto:!0,real:!0,name:"upsert",forced:!0},{updateOrInsert:Ag});var xl=Eg,wv=Date,nT=Ne(wv.prototype.getTime);_n({target:"Date",stat:!0},{now:function(){return nT(new wv)}});var Ms=kr.Date.now,Qi=na("Array").concat,Ng=Array.prototype,di=function(pe){var _e=pe.concat;return pe===Ng||vr(Ng,pe)&&_e===Ng.concat?Qi:_e},oT=/MSIE .\./.test(_r),aT=L.Function,Og=function(pe){return oT?function(_e,Ve){var Oe=Vm(arguments.length,1)>2,Ie=ze(_e)?_e:aT(_e),At=Oe?Fs(arguments,2):void 0;return pe(Oe?function(){le(Ie,this,At)}:Ie,Ve)}:pe},Cc={setTimeout:Og(L.setTimeout),setInterval:Og(L.setInterval)},Rg=Cc.setInterval;_n({global:!0,bind:!0,forced:L.setInterval!==Rg},{setInterval:Rg});var xv=Cc.setTimeout;_n({global:!0,bind:!0,forced:L.setTimeout!==xv},{setTimeout:xv});var wa=kr.setTimeout;kr.JSON||(kr.JSON={stringify:JSON.stringify});var sT=function(_e,Ve,Oe){return le(kr.JSON.stringify,null,arguments)},Eo=sT,_v=js.map,Iv=lc("map");_n({target:"Array",proto:!0,forced:!Iv},{map:function(_e){return _v(this,_e,arguments.length>1?arguments[1]:void 0)}});var Ev=na("Array").map,Cp=Array.prototype,Ao=function(pe){var _e=pe.map;return pe===Cp||vr(Cp,pe)&&_e===Cp.map?Ev:_e},Bg=g(function(pe){var _e=Object.prototype.hasOwnProperty,Ve="~";function Oe(){}function Ie(ur,gr,Ar){this.fn=ur,this.context=gr,this.once=Ar||!1}function At(ur,gr,Ar,Rr,Ur){if(typeof Ar!="function")throw new TypeError("The listener must be a function");var Dr=new Ie(Ar,Rr||ur,Ur),Jr=Ve?Ve+gr:gr;return ur._events[Jr]?ur._events[Jr].fn?ur._events[Jr]=[ur._events[Jr],Dr]:ur._events[Jr].push(Dr):(ur._events[Jr]=Dr,ur._eventsCount++),ur}function nr(ur,gr){--ur._eventsCount==0?ur._events=new Oe:delete ur._events[gr]}function kt(){this._events=new Oe,this._eventsCount=0}Object.create&&(Oe.prototype=Object.create(null),new Oe().__proto__||(Ve=!1)),kt.prototype.eventNames=function(){var gr,Ar,Rr=[];if(this._eventsCount===0)return Rr;for(Ar in gr=this._events)_e.call(gr,Ar)&&Rr.push(Ve?Ar.slice(1):Ar);return Object.getOwnPropertySymbols?Rr.concat(Object.getOwnPropertySymbols(gr)):Rr},kt.prototype.listeners=function(gr){var Ar=Ve?Ve+gr:gr,Rr=this._events[Ar];if(!Rr)return[];if(Rr.fn)return[Rr.fn];for(var Ur=0,Dr=Rr.length,Jr=new Array(Dr);Ur<Dr;Ur++)Jr[Ur]=Rr[Ur].fn;return Jr},kt.prototype.listenerCount=function(gr){var Ar=Ve?Ve+gr:gr,Rr=this._events[Ar];return Rr?Rr.fn?1:Rr.length:0},kt.prototype.emit=function(gr,Ar,Rr,Ur,Dr,Jr){var Cn=Ve?Ve+gr:gr;if(!this._events[Cn])return!1;var Sn,$n,Rn=this._events[Cn],Wn=arguments.length;if(Rn.fn){switch(Rn.once&&this.removeListener(gr,Rn.fn,void 0,!0),Wn){case 1:return Rn.fn.call(Rn.context),!0;case 2:return Rn.fn.call(Rn.context,Ar),!0;case 3:return Rn.fn.call(Rn.context,Ar,Rr),!0;case 4:return Rn.fn.call(Rn.context,Ar,Rr,Ur),!0;case 5:return Rn.fn.call(Rn.context,Ar,Rr,Ur,Dr),!0;case 6:return Rn.fn.call(Rn.context,Ar,Rr,Ur,Dr,Jr),!0}for($n=1,Sn=new Array(Wn-1);$n<Wn;$n++)Sn[$n-1]=arguments[$n];Rn.fn.apply(Rn.context,Sn)}else{var Fn,mo=Rn.length;for($n=0;$n<mo;$n++)switch(Rn[$n].once&&this.removeListener(gr,Rn[$n].fn,void 0,!0),Wn){case 1:Rn[$n].fn.call(Rn[$n].context);break;case 2:Rn[$n].fn.call(Rn[$n].context,Ar);break;case 3:Rn[$n].fn.call(Rn[$n].context,Ar,Rr);break;case 4:Rn[$n].fn.call(Rn[$n].context,Ar,Rr,Ur);break;default:if(!Sn)for(Fn=1,Sn=new Array(Wn-1);Fn<Wn;Fn++)Sn[Fn-1]=arguments[Fn];Rn[$n].fn.apply(Rn[$n].context,Sn)}}return!0},kt.prototype.on=function(gr,Ar,Rr){return At(this,gr,Ar,Rr,!1)},kt.prototype.once=function(gr,Ar,Rr){return At(this,gr,Ar,Rr,!0)},kt.prototype.removeListener=function(gr,Ar,Rr,Ur){var Dr=Ve?Ve+gr:gr;if(!this._events[Dr])return this;if(!Ar)return nr(this,Dr),this;var Jr=this._events[Dr];if(Jr.fn)Jr.fn!==Ar||Ur&&!Jr.once||Rr&&Jr.context!==Rr||nr(this,Dr);else{for(var Cn=0,Sn=[],$n=Jr.length;Cn<$n;Cn++)(Jr[Cn].fn!==Ar||Ur&&!Jr[Cn].once||Rr&&Jr[Cn].context!==Rr)&&Sn.push(Jr[Cn]);Sn.length?this._events[Dr]=Sn.length===1?Sn[0]:Sn:nr(this,Dr)}return this},kt.prototype.removeAllListeners=function(gr){var Ar;return gr?(Ar=Ve?Ve+gr:gr,this._events[Ar]&&nr(this,Ar)):(this._events=new Oe,this._eventsCount=0),this},kt.prototype.off=kt.prototype.removeListener,kt.prototype.addListener=kt.prototype.on,kt.prefixed=Ve,kt.EventEmitter=kt,pe.exports=kt}),iT=Xl;function Xl(pe){pe=pe||{},this.ms=pe.min||100,this.max=pe.max||1e4,this.factor=pe.factor||2,this.jitter=pe.jitter>0&&pe.jitter<=1?pe.jitter:0,this.attempts=0}Xl.prototype.duration=function(){var pe=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var _e=Math.random(),Ve=Math.floor(_e*this.jitter*pe);pe=1&Math.floor(10*_e)?pe+Ve:pe-Ve}return 0|Math.min(pe,this.max)},Xl.prototype.reset=function(){this.attempts=0},Xl.prototype.setMin=function(pe){this.ms=pe},Xl.prototype.setMax=function(pe){this.max=pe},Xl.prototype.setJitter=function(pe){this.jitter=pe};var kp=typeof e=="object"&&e&&e.Object===Object&&e,Ro=typeof self=="object"&&self&&self.Object===Object&&self,pi=kp||Ro||Function("return this")(),Ji=pi.Symbol,_l=Object.prototype,Pv=_l.hasOwnProperty,cT=_l.toString,Xs=Ji?Ji.toStringTag:void 0,vi=function(_e){var Ve=Pv.call(_e,Xs),Oe=_e[Xs];try{_e[Xs]=void 0;var Ie=!0}catch{}var At=cT.call(_e);return Ie&&(Ve?_e[Xs]=Oe:delete _e[Xs]),At},Av=Object.prototype.toString,lT=function(_e){return Av.call(_e)},Nv=Ji?Ji.toStringTag:void 0,yi=function(_e){return _e==null?_e===void 0?"[object Undefined]":"[object Null]":Nv&&Nv in Object(_e)?vi(_e):lT(_e)},Fi=function(_e){var Ve=typeof _e;return _e!=null&&(Ve=="object"||Ve=="function")},wp=function(_e){if(!Fi(_e))return!1;var Ve=yi(_e);return Ve=="[object Function]"||Ve=="[object GeneratorFunction]"||Ve=="[object AsyncFunction]"||Ve=="[object Proxy]"},Ov={deviceId:"",timeout:8e3},Rv={account:"",appkey:"",token:"",debugLevel:"off",needReconnect:!0,reconnectionAttempts:Cg,isAbtestEnable:!0,abtestUrl:"https://abt-online.netease.im/v1/api/abt/client/getExperimentInfo",abtestProjectKey:"imElite_sdk_abtest_web"},Uc=Eu.includes,$i=V(function(){return!Array(1).includes()});_n({target:"Array",proto:!0,forced:$i},{includes:function(_e){return Uc(this,_e,arguments.length>1?arguments[1]:void 0)}});var xp=na("Array").includes,Bv=To("match"),uT=TypeError,Fv=function(pe){if(function(_e){var Ve;return rr(_e)&&((Ve=_e[Bv])!==void 0?!!Ve:er(_e)=="RegExp")}(pe))throw uT("The method doesn't accept regular expressions");return pe},dT=To("match"),pT=Ne("".indexOf);_n({target:"String",proto:!0,forced:!function(pe){var _e=/./;try{"/./"[pe](_e)}catch{try{return _e[dT]=!1,"/./"[pe](_e)}catch{}}return!1}("includes")},{includes:function(_e){return!!~pT(Za(Er(this)),Za(Fv(_e)),arguments.length>1?arguments[1]:void 0)}});var fT=na("String").includes,Fg=Array.prototype,$g=String.prototype,Li=function(pe){var _e=pe.includes;return pe===Fg||vr(Fg,pe)&&_e===Fg.includes?xp:typeof pe=="string"||pe===$g||vr($g,pe)&&_e===$g.includes?fT:_e},mT=js.findIndex,gT="findIndex",$v=!0;gT in[]&&Array(1).findIndex(function(){$v=!1}),_n({target:"Array",proto:!0,forced:$v},{findIndex:function(_e){return mT(this,_e,arguments.length>1?arguments[1]:void 0)}});var Lg=na("Array").findIndex,Ad=Array.prototype,qc=function(pe){var _e=pe.findIndex;return pe===Ad||vr(Ad,pe)&&_e===Ad.findIndex?Lg:_e},hT=g(function(pe){function _e(Ve){var Oe;return pe.exports=_e=ri?Go(Oe=ci).call(Oe):function(At){return At.__proto__||ci(At)},pe.exports.__esModule=!0,pe.exports.default=pe.exports,_e(Ve)}pe.exports=_e,pe.exports.__esModule=!0,pe.exports.default=pe.exports}),vT=Eu.indexOf,_p=Ne([].indexOf),Lv=!!_p&&1/_p([1],1,-0)<0,jg=li("indexOf");_n({target:"Array",proto:!0,forced:Lv||!jg},{indexOf:function(_e){var Ve=arguments.length>1?arguments[1]:void 0;return Lv?_p(this,_e,Ve)||0:vT(this,_e,Ve)}});var yT=na("Array").indexOf,Dg=Array.prototype,Na=function(pe){var _e=pe.indexOf;return pe===Dg||vr(Dg,pe)&&_e===Dg.indexOf?yT:_e},Ug=g(function(pe){pe.exports=function(Ve){var Oe;return Na(Oe=Function.toString.call(Ve)).call(Oe,"[native code]")!==-1},pe.exports.__esModule=!0,pe.exports.default=pe.exports}),qg=xr("Reflect","construct"),bT=Object.prototype,jv=[].push,Vg=V(function(){function pe(){}return!(qg(function(){},[],pe)instanceof pe)}),Hg=!V(function(){qg(function(){})}),Yi=Vg||Hg;_n({target:"Reflect",stat:!0,forced:Yi,sham:Yi},{construct:function(_e,Ve){Ml(_e),lo(Ve);var Oe=arguments.length<3?_e:Ml(arguments[2]);if(Hg&&!Vg)return qg(_e,Ve,Oe);if(_e==Oe){switch(Ve.length){case 0:return new _e;case 1:return new _e(Ve[0]);case 2:return new _e(Ve[0],Ve[1]);case 3:return new _e(Ve[0],Ve[1],Ve[2]);case 4:return new _e(Ve[0],Ve[1],Ve[2],Ve[3])}var Ie=[null];return le(jv,Ie,Ve),new(le(Ou,_e,Ie))}var At=Oe.prototype,nr=Qa(rr(At)?At:bT),kt=le(_e,nr,Ve);return rr(kt)?kt:nr}});var kc=kr.Reflect.construct,TT=g(function(pe){pe.exports=function(){if(typeof Reflect>"u"||!kc||kc.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(kc(Boolean,[],function(){})),!0}catch{return!1}},pe.exports.__esModule=!0,pe.exports.default=pe.exports}),ST=g(function(pe){function _e(Ve,Oe,Ie){var At;return TT()?(pe.exports=_e=Go(At=kc).call(At),pe.exports.__esModule=!0,pe.exports.default=pe.exports):(pe.exports=_e=function(kt,ur,gr){var Ar=[null];Ar.push.apply(Ar,ur);var Rr=new(Go(Function).apply(kt,Ar));return gr&&Bu(Rr,gr.prototype),Rr},pe.exports.__esModule=!0,pe.exports.default=pe.exports),_e.apply(null,arguments)}pe.exports=_e,pe.exports.__esModule=!0,pe.exports.default=pe.exports}),wc=g(function(pe){function _e(Ve){var Oe=typeof xl=="function"?new xl:void 0;return pe.exports=_e=function(At){if(At===null||!Ug(At))return At;if(typeof At!="function")throw new TypeError("Super expression must either be null or a function");if(Oe!==void 0){if(Oe.has(At))return Oe.get(At);Oe.set(At,nr)}function nr(){return ST(At,arguments,hT(this).constructor)}return nr.prototype=vs(At.prototype,{constructor:{value:nr,enumerable:!1,writable:!0,configurable:!0}}),Bu(nr,At)},pe.exports.__esModule=!0,pe.exports.default=pe.exports,_e(Ve)}pe.exports=_e,pe.exports.__esModule=!0,pe.exports.default=pe.exports}),No=function(pe){function _e(Ve,Oe,Ie){var At;return Oe===void 0&&(Oe={}),Ie===void 0&&(Ie=400),(At=pe.call(this,Ve)||this).data=Oe,At.code=Ie,At.name="customError",At}return Ko(_e,pe),_e}(n(wc)(Error)),Il=function(pe){function _e(Ve,Oe,Ie){var At;return Oe===void 0&&(Oe={}),(At=pe.call(this,Ve,Oe,414)||this).code=414,At.name="validateError",At.rules=Ie,At}return Ko(_e,pe),_e}(No),Ip={200:null,406:null,808:null,810:null,201:"The client version is incorrect. You need to upgrade the SDK",302:"The user name or password is incorrect. Please check whether the appkey and token are valid and whether the account and token match",403:"Illegal operation or no permission",404:"Target object does not exist",405:"Parameter length too long",408:"Client request timed out",414:"Request parameter error",415:"Service unavailable",416:"Frequency control",417:"Repeat operation",422:"Account disabled",500:"Server internal error",503:"Server busy",508:"Expiration date",509:"Invalid",7101:"Be pulled black",700:"Partial failure of batch operation",801:"The number of people in the team has reached the upper limit",802:"No permission",803:"The team does not exist or has not changed",804:"The user is not in the team",805:"Team type mismatch",806:"The number of teams created has reached the limit",807:"Team member not valid",809:"Already in the team",811:"The number of accounts in the forced push list exceeds the limit",812:"The team is muted",813:"Due to the limited number of team, some pull people successfully",814:"Disable team message read service",815:"Maximum number of team administrators",816:"Batch operation partial failure",997:"The packet has expired",998:"Deserialize packet error",999:"Serialize packet error",9102:"Channel failure",9103:"This call has been answered / rejected at another end",10201:"Signaling: target NIM client is offline",10202:"Signaling: push is unreachable",10404:"Signaling: channel not exists",10405:"Signaling: channel already exists",10406:"Signaling: member of channel not exists",10407:"Signaling: member of channel already exists",10408:"Signaling: the invitation request does not exist or has expired",10409:"Signaling: the invitation request has been rejected",10410:"Signaling: the invitation request has been accepted",10414:"Signaling: request parameter error",10417:"Signaling: uid conflict",10419:"Signaling: the number of members of channel exceed the limit",10420:"Signaling: member is already in the channel on other client",10700:"Signaling: phased success",13002:"Abnormal chatroom status",13003:"In the blacklist",13004:"In the mute list",13006:"All members are muted, and only the administrator can speak"},zg=function(pe){function _e(Ve,Oe,Ie,At,nr){var kt;return Ie===void 0&&(Ie=""),At===void 0&&(At=new Date().getTime()),nr===void 0&&(nr={}),Ie=Ie||Ip[Ve],(kt=pe.call(this,Ie,nr,Ve)||this).name="cmdError",kt.cmd=Oe,kt.timetag=At,kt}return Ko(_e,pe),_e}(No),Zl=function(pe){function _e(Ve,Oe,Ie){var At;return(At=pe.call(this,Ve,{},412)||this).code=412,At.name="formatError",At.key=Oe,At.reason=Ie,At}return Ko(_e,pe),_e}(No),Vc=function(pe){function _e(Ve,Oe,Ie,At,nr){var kt;return(kt=pe.call(this,Ve,{file:nr},400)||this).name="uploadError",kt.rawError=Oe,kt.curProvider=Ie||1,kt.mixStorePolicy=At,kt}return Ko(_e,pe),_e}(No),El=["error","warn","log","debug"],Nd=function(){},Ep=["off","error","warn","log","debug"],Dv=function(){function pe(Ve,Oe){this.name=Oe,this.strategies={debug:console.log,log:console.log,warn:console.warn,error:console.error},this.debug=Nd,this.log=Nd,this.warn=Nd,this.error=Nd,this.name=Oe,pe.instancesName.push(Oe),Li(Ep).call(Ep,Ve)||(Ve="off"),this.setLogFunc(Ve)}var _e=pe.prototype;return _e.setLogFunc=function(Oe){var Ie=this,At=qc(El).call(El,function(nr){return nr===Oe});Kn(El).call(El,function(nr,kt){kt<=At&&(Ie[nr]=function(){var ur=Fo(Array.prototype).call(arguments),gr=this.formatArgs(ur,nr);this.strategies[nr](gr)})})},_e.formatArgs=function(Oe,Ie){var At=new Date,nr=At.getMonth()+1+"-"+At.getDate()+" "+At.getHours()+":"+At.getMinutes()+":"+At.getSeconds()+":"+At.getMilliseconds();return"[NIM "+Ie+" "+this.name+" "+nr+"] "+Ao(Oe).call(Oe,function(kt){return kt instanceof No?kt.name+", "+kt.code+", "+kt.message:kt instanceof Error?kt&&kt.message?kt.message:kt:typeof kt=="object"?Eo(kt):kt}).join(" ")},pe}();Dv.instancesName=[],_n({global:!0},{globalThis:L});var MT=V(function(){Bs(1)});_n({target:"Object",stat:!0,forced:MT},{keys:function(_e){return Bs(An(_e))}});var Sa=kr.Object.keys,Wg=js.filter,Is=lc("filter");_n({target:"Array",proto:!0,forced:!Is},{filter:function(_e){return Wg(this,_e,arguments.length>1?arguments[1]:void 0)}});var CT=na("Array").filter,sa=Array.prototype,bi=function(pe){var _e=pe.filter;return pe===sa||vr(sa,pe)&&_e===sa.filter?CT:_e},Uv=g(function(pe,_e){pe.exports=function(){function Ve(gr,Ar){if(!(gr instanceof Ar))throw new TypeError("Cannot call a class as a function")}function Oe(gr,Ar){for(var Rr=0;Rr<Ar.length;Rr++){var Ur=Ar[Rr];Ur.enumerable=Ur.enumerable||!1,Ur.configurable=!0,"value"in Ur&&(Ur.writable=!0),gc(gr,Ur.key,Ur)}}function Ie(gr,Ar,Rr){return Ar&&Oe(gr.prototype,Ar),Rr&&Oe(gr,Rr),gc(gr,"prototype",{writable:!1}),gr}var At={reportUrl:"https://statistic.live.126.net/statics/report/common/form",maxSize:100,msgListMaxSize:1e3,cacheMaxSize:1e3,maxDelay:3e5,maxInterval:3e4,minInterval:1e4,timeout:5e3,autoStart:!0},nr="https://statistic.live.126.net/dispatcher/req",kt=function(){},ur=function(){function gr(Ar){Ve(this,gr),this.enable=!1,this.initConfigLoaded=!1,this.loading=!1,this.isDestroyed=!1,this.reportConfig=At,this.msgList=[],this.traceMsgCache={},this.lowPriorityMsgList=[],this.cacheMsgList=[],this.lastReportTime=Ms(),this.timer=null,this.setConfig(Ar),this.reportConfig.autoStart&&this.initUploadConfig()}return Ie(gr,[{key:"setConfig",value:function(Rr){this.reportConfig=jn({},this.reportConfig,Rr)}},{key:"reportImmediately",value:function(Rr,Ur){var Dr=this;this.reportConfig.request(Rr,jn({dataType:"json",method:"POST",timeout:this.reportConfig.timeout},Ur)).catch(function(Jr){var Cn,Sn;(Sn=(Cn=Dr.reportConfig)===null||Cn===void 0?void 0:Cn.logger)===null||Sn===void 0||Sn.warn("Reporter immediately upload failed",Jr)})}},{key:"report",value:function(Rr,Ur){var Dr=arguments.length>2&&arguments[2]!==void 0&&arguments[2];if(Rr){var Jr=Ms();Dr?this.lowPriorityMsgList.push({module:Rr,msg:Ur,createTime:Jr}):this.msgList.push({module:Rr,msg:Ur,createTime:Jr}),this.msgList.length>this.reportConfig.msgListMaxSize&&this.msgList.shift(),this.lowPriorityMsgList.length>this.reportConfig.msgListMaxSize&&this.lowPriorityMsgList.shift(),this.doReport()}}},{key:"reportTraceStart",value:function(Rr,Ur){if(Rr&&!this.traceMsgCache[Rr]){var Dr=jn(jn({start_time:Ms()},Ur),{extension:[]});this.traceMsgCache[Rr]=Dr}}},{key:"reportTraceUpdate",value:function(Rr){}},{key:"reportTraceUpdateV2",value:function(Rr,Ur){if(this.traceMsgCache[Rr]){var Dr=this.traceMsgCache[Rr].extension.length,Jr=new Date().getTime();Ur.duration=Dr===0?Jr-this.traceMsgCache[Rr].start_time:Jr-this.traceMsgCache[Rr].extension[Dr-1].end_time,this.traceMsgCache[Rr].extension.push(jn({end_time:Jr},Ur))}}},{key:"reportTraceEnd",value:function(Rr){var Ur,Dr=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];this.traceMsgCache[Rr]&&(Rr!=="nos"||Dr===!1?(typeof Dr=="boolean"?this.traceMsgCache[Rr].succeed=!!Dr:this.traceMsgCache[Rr].state=Dr,this.traceMsgCache[Rr].duration=Ms()-this.traceMsgCache[Rr].start_time,Kn(Ur=this.traceMsgCache[Rr].extension).call(Ur,function(Jr){delete Jr.end_time}),this.report(Rr,this.traceMsgCache[Rr]),this.traceMsgCache[Rr]=null):this.traceMsgCache[Rr]=null)}},{key:"reportTraceCancel",value:function(Rr){this.traceMsgCache[Rr]=null}},{key:"pause",value:function(){this.enable=!1}},{key:"restore",value:function(){this.enable=!0,this.initConfigLoaded||this.initUploadConfig()}},{key:"destroy",value:function(){var Rr,Ur=this;Kn(Rr=Sa(this.traceMsgCache)).call(Rr,function(Dr){Ur.reportTraceEnd(Dr,1)}),this.timer!==null&&clearTimeout(this.timer),this.setConfig=kt,this.report=kt,this.reportTraceStart=kt,this.reportTraceUpdate=kt,this.reportTraceEnd=kt,this.pause=kt,this.restore=kt,this.destroy=kt,this.cacheMsgList=[],this.traceMsgCache={},this.lowPriorityMsgList=[],this.msgList=[],this.reportConfig={},this.isDestroyed=!0}},{key:"initUploadConfig",value:function(){var Rr,Ur,Dr=this;if(!this.loading){this.loading=!0;var Jr=this.reportConfig.common||{};try{this.reportConfig.request(nr,{method:"GET",dataType:"json",params:{deviceId:Jr.dev_id,sdkVer:Jr.sdk_ver,platform:Jr.platform,appkey:Jr.app_key},timeout:this.reportConfig.timeout}).then(function(Cn){var Sn,$n;if(!Dr.isDestroyed){if(Cn.status===200&&Cn.data&&Cn.data.code===200){var Rn=Cn.data.data||{};Dr.reportConfig.maxSize=Rn.maxSize>1e3?1e3:Rn.maxSize,Dr.reportConfig.maxInterval=Rn.maxInterval>1e4?1e4:Rn.maxInterval,Dr.reportConfig.maxInterval=Rn.maxInterval<10?10:Rn.maxInterval,Dr.reportConfig.minInterval=Rn.minInterval<2?2:Rn.minInterval,Dr.reportConfig.maxDelay=Rn.maxDelay||300,Dr.reportConfig.maxInterval=1e3*Dr.reportConfig.maxInterval,Dr.reportConfig.minInterval=1e3*Dr.reportConfig.minInterval,Dr.reportConfig.maxDelay=1e3*Dr.reportConfig.maxDelay,Dr.enable=!0,Dr.initConfigLoaded=!0,Dr.loading=!1,Dr.reportHeartBeat()}($n=(Sn=Dr.reportConfig)===null||Sn===void 0?void 0:Sn.logger)===null||$n===void 0||$n.log("Get reporter upload config success")}}).catch(function(Cn){var Sn,$n;Dr.loading=!1,($n=(Sn=Dr.reportConfig)===null||Sn===void 0?void 0:Sn.logger)===null||$n===void 0||$n.error("Get reporter upload config failed",Cn)})}catch(Cn){this.loading=!1,(Ur=(Rr=this.reportConfig)===null||Rr===void 0?void 0:Rr.logger)===null||Ur===void 0||Ur.error("Exec reporter request failed",Cn)}}}},{key:"reportHeartBeat",value:function(){var Rr=this;this.isDestroyed||(this.timer=wa(function(){Rr.reportHeartBeat()},this.reportConfig.minInterval),this.doReport())}},{key:"doReport",value:function(){if(!this.isDestroyed){var Rr=this.msgList.length+this.lowPriorityMsgList.length+this.cacheMsgList.length>2*this.reportConfig.maxSize?this.reportConfig.minInterval:this.reportConfig.maxInterval;Ms()-this.lastReportTime>=Rr&&this.upload()}}},{key:"getUploadMsg",value:function(){var Rr,Ur,Dr,Jr,Cn,Sn=this,$n={},Rn=Ms();this.msgList=bi(Rr=this.msgList).call(Rr,function(Gn){return Rn-Gn.createTime<Sn.reportConfig.maxDelay}),this.lowPriorityMsgList=bi(Ur=this.lowPriorityMsgList).call(Ur,function(Gn){return Rn-Gn.createTime<Sn.reportConfig.maxDelay}),this.cacheMsgList=bi(Dr=this.cacheMsgList).call(Dr,function(Gn){return Rn-Gn.createTime<Sn.reportConfig.maxDelay});var Wn=Fo(Jr=this.msgList).call(Jr,0,this.reportConfig.maxSize);if(this.msgList=Fo(Cn=this.msgList).call(Cn,Wn.length),Wn.length<this.reportConfig.maxSize){var Fn,mo,ao=this.reportConfig.maxSize-Wn.length;Wn=di(Wn).call(Wn,Fo(Fn=this.lowPriorityMsgList).call(Fn,0,ao)),this.lowPriorityMsgList=Fo(mo=this.lowPriorityMsgList).call(mo,ao)}if(Wn.length<this.reportConfig.maxSize){var ea,oo,Wr=this.reportConfig.maxSize-Wn.length;Wn=di(Wn).call(Wn,Fo(ea=this.cacheMsgList).call(ea,0,Wr)),this.cacheMsgList=Fo(oo=this.cacheMsgList).call(oo,Wr)}return Kn(Wn).call(Wn,function(Gn){$n[Gn.module]?$n[Gn.module].push(Gn.msg):$n[Gn.module]=[Gn.msg]}),{uploadMsgArr:Wn,uploadMsg:$n}}},{key:"upload",value:function(){var Rr,Ur,Dr=this;if(this.enable&&!(this.lastReportTime&&Ms()-this.lastReportTime<this.reportConfig.minInterval)){var Jr=this.getUploadMsg(),Cn=Jr.uploadMsgArr,Sn=Jr.uploadMsg;if(Cn.length){this.lastReportTime=Ms();try{this.reportConfig.request(this.reportConfig.reportUrl,{dataType:"json",method:"POST",data:{common:this.reportConfig.common,event:Sn},headers:{sdktype:"im"},timeout:this.reportConfig.timeout}).catch(function($n){var Rn,Wn,Fn,mo;Dr.cacheMsgList=Fo(Rn=di(Wn=Dr.cacheMsgList).call(Wn,Cn)).call(Rn,0,Dr.reportConfig.cacheMaxSize),(mo=(Fn=Dr.reportConfig)===null||Fn===void 0?void 0:Fn.logger)===null||mo===void 0||mo.warn("Reporter upload failed",$n)})}catch($n){(Ur=(Rr=this.reportConfig)===null||Rr===void 0?void 0:Rr.logger)===null||Ur===void 0||Ur.warn("Exec reporter request failed",$n)}clearTimeout(this.timer),this.reportHeartBeat()}}}}]),gr}();return ur}()}),ya={setLogger:function(_e){throw new Error("Function not implemented.")},platform:"",WebSocket:function(){function pe(Ve,Oe){throw this.CONNECTING=0,this.OPEN=1,this.CLOSING=2,this.CLOSED=3,new Error("Method not implemented.")}var _e=pe.prototype;return _e.close=function(Oe,Ie){throw new Error("Method not implemented.")},_e.send=function(Oe){throw new Error("Method not implemented.")},_e.onclose=function(Oe){throw new Error("Method not implemented.")},_e.onerror=function(Oe){throw new Error("Method not implemented.")},_e.onmessage=function(Oe){throw new Error("Method not implemented.")},_e.onopen=function(Oe){throw new Error("Method not implemented.")},pe}(),localStorage:{},request:function(_e,Ve){throw new Error("Function not implemented.")},uploadFile:function(_e){throw new Error("Function not implemented.")},getSystemInfo:function(){throw new Error("Function not implemented.")}},kT=TypeError,qv=function(pe){return function(_e,Ve,Oe,Ie){Xr(Ve);var At=An(_e),nr=hr(At),kt=Ka(At),ur=pe?kt-1:0,gr=pe?-1:1;if(Oe<2)for(;;){if(ur in nr){Ie=nr[ur],ur+=gr;break}if(ur+=gr,pe?ur<0:kt<=ur)throw kT("Reduce of empty array with no initial value")}for(;pe?ur>=0:kt>ur;ur+=gr)ur in nr&&(Ie=Ve(Ie,nr[ur],ur,At));return Ie}},Gg={left:qv(!1),right:qv(!0)}.left,Pp=li("reduce");_n({target:"Array",proto:!0,forced:!Pp||!cs&&Br>79&&Br<83},{reduce:function(_e){var Ve=arguments.length;return Gg(this,_e,Ve,Ve>1?arguments[1]:void 0)}});var Vv=na("Array").reduce,eu=Array.prototype,Hc=function(pe){var _e=pe.reduce;return pe===eu||vr(eu,pe)&&_e===eu.reduce?Vv:_e},Hv=function(_e){return _e===void 0},Od={},Xi={};function ls(pe,_e){var Ve,Oe,Ie;try{Ie=JSON.parse(pe)}catch(Dr){throw _e.error("Parse command error: ",pe),Dr}var At=Ie.sid+"_"+Ie.cid,nr=Ie.r;if(Li(Ve=["4_1","4_2","4_10","4_11"]).call(Ve,At)){var kt=Ie.r[1].headerPacket;At=kt.sid+"_"+kt.cid,nr=Ie.r[1].body}var ur,gr=Xi[At],Ar=Od[gr],Rr=function(Jr,Cn){var Sn=Ip[Jr];return Sn===null?null:new zg(Jr,Cn,Sn,new Date().getTime())}(Ie.code,gr),Ur={cmd:gr,raw:Ie,error:Rr,service:Ar==null?void 0:Ar.service,content:{}};if(Ur.error){if(Ur.error.cmd=gr,Ur.error.callFunc="parseCmd",!(!((Oe=Ar==null?void 0:Ar.ignoreErrCodes)===null||Oe===void 0)&&Li(Oe).call(Oe,Ie.code)))return Ur;_e.warn("parseCmd:: ignore error ",Ur.error),Ur.error.ignore=!0}return!gr||!Ar?(Ur.notFound=!0,Ur):(Ar.response&&Kn(ur=Ar.response).call(ur,function(Dr,Jr){var Cn=nr[Jr],Sn=Dr.type,$n=Dr.name,Rn=Dr.reflectMapper;if(!Hv(Cn))switch(Sn){case"Property":Ur.content[$n]=Rn?es(Cn,Rn):Cn;break;case"PropertyArray":Ur.content[$n]=Ao(Cn).call(Cn,function(Wn){return Rn?es(Wn,Rn):Wn});break;case"long":case"Long":case"byte":case"Byte":case"Number":Ur.content[$n]=+Cn;break;default:Ur.content[$n]=Cn}}),Ur)}function Cs(pe,_e){var Ve={};for(var Oe in pe)_e[Oe]!==void 0&&(Ve[_e[Oe]]=pe[Oe]);return Ve}function es(pe,_e){var Ve={};for(var Oe in pe)_e[Oe]!==void 0&&(Ve[_e[Oe]]=pe[Oe]);return Ve}function Zi(pe){Od=jn(Od,pe.cmdConfig),Xi=jn(Xi,pe.cmdMap)}function zc(pe){var _e;return Hc(_e=Sa(pe)).call(_e,function(Ve,Oe){var Ie,At=pe[Oe];return Ve[Oe]=Hc(Ie=Sa(At)).call(Ie,function(nr,kt){return nr[At[kt]]=kt,nr},{}),Ve},{})}var Kg=["disconnect","connect","heartbeat","message","json","event","ack","error","noop"],Qg=["transport not supported","client not handshaken","unauthorized"],Ap=["reconnect"],wT=function(pe){function _e(Oe,Ie,At){var nr;return(nr=pe.call(this)||this).url=Ie,nr.logger=At,nr.websocket=null,nr.core=Oe,nr.url=Ie,nr.status="disconnected",nr.logger=At,nr.connect(),nr}Ko(_e,pe);var Ve=_e.prototype;return Ve.connect=function(){var Ie=this;this.status!=="connecting"&&this.status!=="connected"?(this.status="connecting",this.core.adapters.request("https://"+this.url+"/socket.io/1/?t="+Ms(),{method:"GET",dataType:"text",timeout:8e3}).then(function(At){var nr=At.data.split(":"),kt=nr[0],ur=nr[1];return Ie.sessionId=kt,Ie.closeTimeout=1e3*ur,Ie._createWebsocket("wss://"+Ie.url+"/socket.io/1/websocket/"+kt)}).catch(function(At){Ie.logger.error("imsocket::handshake fail. ",At&&At.message),Ie.status="disconnected",Ie.emit("handshakeFailed")})):this.logger.warn("imsocket::socket is connecting or connected",this.status)},Ve.close=function(){if(this.websocket){this.logger.log("imsocket:: close websocket");try{this.websocket.send(this.encodePacket({type:"disconnect"})),this.websocket.close()}catch(Ie){this.logger.warn("attempt to close websocket error",Ie)}this.clean()}},Ve.clean=function(){this.status="disconnected",this.websocket&&(this.websocket.onmessage=null,this.websocket.onopen=null,this.websocket.onerror=null,this.websocket.onclose=null,this.websocket=null,this.emit("disconnect"))},Ve.onConnect=function(){this.status="connected",this.resetCloseTimer(),this.emit("connect")},Ve._createWebsocket=function(Ie){var At,nr=this;this.websocket=new ya.WebSocket(Ie),this.websocket.onmessage=Go(At=this.onMessage).call(At,this),this.websocket.onclose=function(){nr.logger.log("imsocket:: receive websocket onclose event, current status",nr.status),nr.clean()},this.websocket.onerror=function(kt){nr.logger.error("imsocket:: onerror",kt)}},Ve.onMessage=function(Ie){var At;this.resetCloseTimer();var nr=this.decodePacket(Ie.data);if(nr)switch(nr.type){case"connect":this.onConnect();break;case"disconnect":this.close();break;case"message":case"json":this.emit("message",nr.data);break;case"event":nr.name&&this.emit(nr.name,nr.args);break;case"error":nr.reason==="unauthorized"?this.emit("connect_failed",nr.reason):this.emit("error",nr.reason);break;case"heartbeat":(At=this.websocket)===null||At===void 0||At.send(this.encodePacket({type:"heartbeat"}));break;default:this.logger.warn("imsocket::no handler type",nr.type)}},Ve.encodePacket=function(Ie){var At,nr,kt=Ie.type,ur=Ie.id,gr=ur===void 0?"":ur,Ar=Ie.endpoint,Rr=Ar===void 0?"":Ar,Ur=Ie.ack,Dr=null;if(!kt)return"";switch(kt){case"error":At=Ie.reason?Na(Qg).call(Qg,Ie.reason):"",nr=Ie.advice?Na(Ap).call(Ap,Ie.advice):"",At===""&&nr===""||(Dr=At+(nr!==""?"+"+nr:""));break;case"message":Ie.data!==""&&(Dr=Ie.data);break;case"event":At={name:Ie.name},At=Ie.args&&Ie.args.length?{name:Ie.name,args:Ie.args}:{name:Ie.name},Dr=Eo(At);break;case"json":Dr=Eo(Ie.data);break;case"connect":Ie.qs&&(Dr=Ie.qs);break;case"ack":Dr=Ie.ackId+(Ie.args&&Ie.args.length?"+"+Eo(Ie.args):"")}var Jr=[Na(Kg).call(Kg,kt),gr+(Ur==="data"?"+":""),Rr];return Dr!=null&&Jr.push(Dr),Jr.join(":")},Ve.decodePacket=function(Ie){if(Ie)if(Ie.charAt(0)!="�"){var At=Ie.match(/([^:]+):([0-9]+)?(\+)?:([^:]+)?:?([\s\S]*)?/);if(At){var nr,kt=At[1],ur=At[2],gr=At[3],Ar=At[4],Rr=At[5],Ur={type:Kg[+kt],endpoint:Ar};switch(ur&&(Ur.id=ur,Ur.ack=!gr||"data"),Ur.type){case"error":nr=Rr.split("+"),Ur.reason=Qg[+nr[0]]||"";break;case"message":Ur.data=Rr||"";break;case"connect":Ur.qs=Rr||"";break;case"event":try{var Dr=JSON.parse(Rr);Ur.name=Dr.name,Ur.args=Dr.args}catch(Jr){this.logger.error("imsocket::parseData::type::event error",Jr)}Ur.args=Ur.args||[];break;case"json":try{Ur.data=JSON.parse(Rr)}catch(Jr){this.logger.error("imsocket::parseData::type::json error",Jr)}break;case"ack":if((nr=Rr.match(/^([0-9]+)(\+)?(.*)/))&&(Ur.ackId=nr[1],Ur.args=[],nr[3]))try{Ur.args=nr[3]?JSON.parse(nr[3]):[]}catch(Jr){this.logger.error("imsocket::parseData::type::ack error",Jr)}}return Ur}}else this.logger.error("imsocket::unrecognize dataStr",Fo(Ie).call(Ie,0,20))},Ve.send=function(Ie){var At,nr={data:Ie,type:"message",endpoint:""};(At=this.websocket)===null||At===void 0||At.send(this.encodePacket(nr))},Ve.resetCloseTimer=function(){var Ie=this;this.closeTimeout&&(clearTimeout(this.closeTimer),this.closeTimer=wa(function(){Ie.close()},this.closeTimeout))},_e}(Bg),Np=na("Array").values,ji=Array.prototype,xT={DOMTokenList:!0,NodeList:!0},Op=function(pe){var _e=pe.values;return pe===ji||vr(ji,pe)&&_e===ji.values||hn(xT,oi(pe))?Np:_e};_n({target:"Array",stat:!0},{isArray:ys});var ks=kr.Array.isArray,Jg=js.every,_T=li("every");_n({target:"Array",proto:!0,forced:!_T},{every:function(_e){return Jg(this,_e,arguments.length>1?arguments[1]:void 0)}});var Di=na("Array").every,Yg=Array.prototype,tu=function(pe){var _e=pe.every;return pe===Yg||vr(Yg,pe)&&_e===Yg.every?Di:_e},Es=function(_e){return _e!=null&&typeof _e=="object"},zv=function(_e){return Es(_e)&&yi(_e)=="[object RegExp]"},Xg=function(_e){return function(Ve){return _e(Ve)}},ru=g(function(pe,_e){var Ve=_e&&!_e.nodeType&&_e,Oe=Ve&&pe&&!pe.nodeType&&pe,Ie=Oe&&Oe.exports===Ve&&kp.process,At=function(){try{var nr=Oe&&Oe.require&&Oe.require("util").types;return nr||Ie&&Ie.binding&&Ie.binding("util")}catch{}}();pe.exports=At}),Zg=ru&&ru.isRegExp,IT=Zg?Xg(Zg):zv,eh=pi["__core-js_shared__"],Wc=function(){var pe=/[^.]+$/.exec(eh&&eh.keys&&eh.keys.IE_PROTO||"");return pe?"Symbol(src)_1."+pe:""}(),ET=function(_e){return!!Wc&&Wc in _e},PT=Function.prototype.toString,Pl=function(_e){if(_e!=null){try{return PT.call(_e)}catch{}try{return _e+""}catch{}}return""},AT=/^\[object .+?Constructor\]$/,NT=Function.prototype,OT=Object.prototype,RT=NT.toString,BT=OT.hasOwnProperty,Al=RegExp("^"+RT.call(BT).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Rd=function(_e){return!(!Fi(_e)||ET(_e))&&(wp(_e)?Al:AT).test(Pl(_e))},FT=function(_e,Ve){return _e==null?void 0:_e[Ve]},Nl=function(_e,Ve){var Oe=FT(_e,Ve);return Rd(Oe)?Oe:void 0},Bd=Nl(Object,"create"),$T=function(){this.__data__=Bd?Bd(null):{},this.size=0},LT=function(_e){var Ve=this.has(_e)&&delete this.__data__[_e];return this.size-=Ve?1:0,Ve},jT=Object.prototype.hasOwnProperty,DT=function(_e){var Ve=this.__data__;if(Bd){var Oe=Ve[_e];return Oe==="__lodash_hash_undefined__"?void 0:Oe}return jT.call(Ve,_e)?Ve[_e]:void 0},nu=Object.prototype.hasOwnProperty,Wv=function(_e){var Ve=this.__data__;return Bd?Ve[_e]!==void 0:nu.call(Ve,_e)},UT=function(_e,Ve){var Oe=this.__data__;return this.size+=this.has(_e)?0:1,Oe[_e]=Bd&&Ve===void 0?"__lodash_hash_undefined__":Ve,this};function xc(pe){var _e=-1,Ve=pe==null?0:pe.length;for(this.clear();++_e<Ve;){var Oe=pe[_e];this.set(Oe[0],Oe[1])}}xc.prototype.clear=$T,xc.prototype.delete=LT,xc.prototype.get=DT,xc.prototype.has=Wv,xc.prototype.set=UT;var Fd=xc,qT=function(){this.__data__=[],this.size=0},Rp=function(_e,Ve){return _e===Ve||_e!=_e&&Ve!=Ve},Bp=function(_e,Ve){for(var Oe=_e.length;Oe--;)if(Rp(_e[Oe][0],Ve))return Oe;return-1},VT=Array.prototype.splice,HT=function(_e){var Ve=this.__data__,Oe=Bp(Ve,_e);return!(Oe<0)&&(Oe==Ve.length-1?Ve.pop():VT.call(Ve,Oe,1),--this.size,!0)},ou=function(_e){var Ve=this.__data__,Oe=Bp(Ve,_e);return Oe<0?void 0:Ve[Oe][1]},Fp=function(_e){return Bp(this.__data__,_e)>-1},$d=function(_e,Ve){var Oe=this.__data__,Ie=Bp(Oe,_e);return Ie<0?(++this.size,Oe.push([_e,Ve])):Oe[Ie][1]=Ve,this};function au(pe){var _e=-1,Ve=pe==null?0:pe.length;for(this.clear();++_e<Ve;){var Oe=pe[_e];this.set(Oe[0],Oe[1])}}au.prototype.clear=qT,au.prototype.delete=HT,au.prototype.get=ou,au.prototype.has=Fp,au.prototype.set=$d;var $p=au,Gc=Nl(pi,"Map"),zT=function(){this.size=0,this.__data__={hash:new Fd,map:new(Gc||$p),string:new Fd}},WT=function(_e){var Ve=typeof _e;return Ve=="string"||Ve=="number"||Ve=="symbol"||Ve=="boolean"?_e!=="__proto__":_e===null},Lp=function(_e,Ve){var Oe=_e.__data__;return WT(Ve)?Oe[typeof Ve=="string"?"string":"hash"]:Oe.map},GT=function(_e){var Ve=Lp(this,_e).delete(_e);return this.size-=Ve?1:0,Ve},su=function(_e){return Lp(this,_e).get(_e)},jp=function(_e){return Lp(this,_e).has(_e)},KT=function(_e,Ve){var Oe=Lp(this,_e),Ie=Oe.size;return Oe.set(_e,Ve),this.size+=Oe.size==Ie?0:1,this};function iu(pe){var _e=-1,Ve=pe==null?0:pe.length;for(this.clear();++_e<Ve;){var Oe=pe[_e];this.set(Oe[0],Oe[1])}}iu.prototype.clear=zT,iu.prototype.delete=GT,iu.prototype.get=su,iu.prototype.has=jp,iu.prototype.set=KT;var Ol=iu,th=function(_e){return this.__data__.set(_e,"__lodash_hash_undefined__"),this},Gv=function(_e){return this.__data__.has(_e)};function Dp(pe){var _e=-1,Ve=pe==null?0:pe.length;for(this.__data__=new Ol;++_e<Ve;)this.add(pe[_e])}Dp.prototype.add=Dp.prototype.push=th,Dp.prototype.has=Gv;var rh=Dp,QT=function(_e,Ve,Oe,Ie){for(var At=_e.length,nr=Oe+(Ie?1:-1);Ie?nr--:++nr<At;)if(Ve(_e[nr],nr,_e))return nr;return-1},Kv=function(_e){return _e!=_e},Qv=function(_e,Ve,Oe){for(var Ie=Oe-1,At=_e.length;++Ie<At;)if(_e[Ie]===Ve)return Ie;return-1},nh=function(_e,Ve,Oe){return Ve==Ve?Qv(_e,Ve,Oe):QT(_e,Kv,Oe)},Up=function(_e,Ve){return!!(_e!=null&&_e.length)&&nh(_e,Ve,0)>-1},Jv=function(_e,Ve,Oe){for(var Ie=-1,At=_e==null?0:_e.length;++Ie<At;)if(Oe(Ve,_e[Ie]))return!0;return!1},cu=function(_e,Ve){for(var Oe=-1,Ie=_e==null?0:_e.length,At=Array(Ie);++Oe<Ie;)At[Oe]=Ve(_e[Oe],Oe,_e);return At},oh=function(_e,Ve){return _e.has(Ve)},ah=function(_e,Ve,Oe,Ie){var At=-1,nr=Up,kt=!0,ur=_e.length,gr=[],Ar=Ve.length;if(!ur)return gr;Oe&&(Ve=cu(Ve,Xg(Oe))),Ie?(nr=Jv,kt=!1):Ve.length>=200&&(nr=oh,kt=!1,Ve=new rh(Ve));e:for(;++At<ur;){var Rr=_e[At],Ur=Oe==null?Rr:Oe(Rr);if(Rr=Ie||Rr!==0?Rr:0,kt&&Ur==Ur){for(var Dr=Ar;Dr--;)if(Ve[Dr]===Ur)continue e;gr.push(Rr)}else nr(Ve,Ur,Ie)||gr.push(Rr)}return gr},qp=function(_e){return _e},Yv=function(_e,Ve,Oe){switch(Oe.length){case 0:return _e.call(Ve);case 1:return _e.call(Ve,Oe[0]);case 2:return _e.call(Ve,Oe[0],Oe[1]);case 3:return _e.call(Ve,Oe[0],Oe[1],Oe[2])}return _e.apply(Ve,Oe)},Ld=Math.max,Xv=function(_e,Ve,Oe){return Ve=Ld(Ve===void 0?_e.length-1:Ve,0),function(){for(var Ie=arguments,At=-1,nr=Ld(Ie.length-Ve,0),kt=Array(nr);++At<nr;)kt[At]=Ie[Ve+At];At=-1;for(var ur=Array(Ve+1);++At<Ve;)ur[At]=Ie[At];return ur[Ve]=Oe(kt),Yv(_e,this,ur)}},JT=function(_e){return function(){return _e}},Vp=function(){try{var pe=Nl(Object,"defineProperty");return pe({},"",{}),pe}catch{}}(),Zv=Vp?function(pe,_e){return Vp(pe,"toString",{configurable:!0,enumerable:!1,value:JT(_e),writable:!0})}:qp,sh=Date.now,Hp=function(_e){var Ve=0,Oe=0;return function(){var Ie=sh(),At=16-(Ie-Oe);if(Oe=Ie,At>0){if(++Ve>=800)return arguments[0]}else Ve=0;return _e.apply(void 0,arguments)}},ey=Hp(Zv),ty=function(_e,Ve){return ey(Xv(_e,Ve,qp),_e+"")},ih=function(_e){return typeof _e=="number"&&_e>-1&&_e%1==0&&_e<=9007199254740991},zp=function(_e){return _e!=null&&ih(_e.length)&&!wp(_e)},Qn=function(_e){return Es(_e)&&zp(_e)},YT=ty(function(pe,_e){return Qn(pe)?ah(pe,_e):[]}),lu=YT;function XT(pe,_e){return _e instanceof RegExp?"__REGEXP "+_e.toString():_e}function On(pe,_e,Ve){var Oe;_e===void 0&&(_e={});var Ie={};return Kn(Oe=Sa(pe)).call(Oe,function(At){var nr=pe[At].type,kt=Ve?"In "+Ve+", ":"";if(_e[At]===void 0){if(pe[At].required===!1)return void(Ie[At]=_e[At]);throw new Il(kt+'param "'+At+'" is required',{key:At},"required")}var ur=ZT[nr];if(ur&&!ur(_e,At,pe[At]))throw new Il(kt+'param "'+At+'" expects '+Eo(pe[At],XT),{key:At,value:_e[At]},Eo(pe[At]));Ie[At]=_e[At]}),Ie}var ZT={string:function(_e,Ve,Oe){var Ie=Oe.allowEmpty,At=Oe.max,nr=Oe.min,kt=Oe.regExp,ur=_e[Ve];return typeof ur=="string"&&(Ie!==!1||ur!=="")&&!(typeof At=="number"&&ur.length>At)&&!(typeof nr=="number"&&ur.length<nr)&&!(IT(kt)&&!kt.test(ur))},number:function(_e,Ve,Oe){var Ie=Oe.min,At=Oe.max,nr=_e[Ve];return typeof nr=="number"&&!(typeof Ie=="number"&&nr<Ie)&&!(typeof At=="number"&&nr>At)},boolean:function(_e,Ve){return typeof _e[Ve]=="boolean"},enum:function(_e,Ve,Oe){var Ie=Op(Oe),At=_e[Ve];return!Ie||Na(Ie).call(Ie,At)>-1},array:function(_e,Ve,Oe){var Ie,At=Oe.itemType,nr=Oe.rules,kt=Oe.min,ur=Oe.max,gr=Op(Oe),Ar=_e[Ve];return!!ks(Ar)&&!(typeof ur=="number"&&Ar.length>ur)&&!(typeof kt=="number"&&Ar.length<kt)&&!(At&&At!=="enum"&&!tu(Ar).call(Ar,function(Rr){return typeof Rr===At}))&&(At!=="enum"||!gr||!lu.apply(void 0,di(Ie=[Ar]).call(Ie,gr)).length)&&(nr&&Kn(Ar).call(Ar,function(Rr,Ur){return On(nr,Rr,Ve+"["+Ur+"]")}),!0)},object:function(_e,Ve,Oe){var Ie=Oe.rules,At=_e[Ve];return Ie&&On(Ie,At,Ve),!0}},uu=Nl(pi,"Set"),eS=function(){},Wp=function(_e){var Ve=-1,Oe=Array(_e.size);return _e.forEach(function(Ie){Oe[++Ve]=Ie}),Oe},ch=uu&&1/Wp(new uu([,-0]))[1]==1/0?function(pe){return new uu(pe)}:eS,ry=ch,Gp=function(_e,Ve,Oe){var Ie=-1,At=Up,nr=_e.length,kt=!0,ur=[],gr=ur;if(Oe)kt=!1,At=Jv;else if(nr>=200){var Ar=Ve?null:ry(_e);if(Ar)return Wp(Ar);kt=!1,At=oh,gr=new rh}else gr=Ve?[]:ur;e:for(;++Ie<nr;){var Rr=_e[Ie],Ur=Ve?Ve(Rr):Rr;if(Rr=Oe||Rr!==0?Rr:0,kt&&Ur==Ur){for(var Dr=gr.length;Dr--;)if(gr[Dr]===Ur)continue e;Ve&&gr.push(Ur),ur.push(Rr)}else At(gr,Ur,Oe)||(gr!==ur&&gr.push(Ur),ur.push(Rr))}return ur},tS=function(_e){return _e&&_e.length?Gp(_e):[]},lh=`	
\v\f\r                　\u2028\u2029\uFEFF`,Kp=Ne("".replace),Qp="["+lh+"]",jd=RegExp("^"+Qp+Qp+"*"),ny=RegExp(Qp+Qp+"*$"),Jp=function(pe){return function(_e){var Ve=Za(Er(_e));return 1&pe&&(Ve=Kp(Ve,jd,"")),2&pe&&(Ve=Kp(Ve,ny,"")),Ve}},oy={start:Jp(1),end:Jp(2),trim:Jp(3)}.trim,Dd=L.parseInt,uh=L.Symbol,ec=uh&&uh.iterator,Lo=/^[+-]?0x/i,Yp=Ne(Lo.exec),Ui=Dd(lh+"08")!==8||Dd(lh+"0x16")!==22||ec&&!V(function(){Dd(Object(ec))})?function(_e,Ve){var Oe=oy(Za(_e));return Dd(Oe,Ve>>>0||(Yp(Lo,Oe)?16:10))}:Dd;_n({global:!0,forced:parseInt!=Ui},{parseInt:Ui});var tc,Yo=kr.parseInt,dh=(tc=function(){return(65536*(1+Math.random())|0).toString(16).substring(1)},function(){return tc()+tc()+tc()+tc()+tc()+tc()+tc()+tc()});function xa(pe){var _e;return bi(_e=Sa(pe)).call(_e,function(Ve){return!(+Ve>=0)})}function ay(pe,_e){var Ve,Oe=bi(Ve=Sa(pe)).call(Ve,function(Ie){return pe[Ie]==_e});return Oe.length>0?Oe[0]:void 0}var rS=TypeError,Xp=Object.getOwnPropertyDescriptor,nS=$e&&!function(){if(this!==void 0)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(pe){return pe instanceof TypeError}}()?function(pe,_e){if(ys(pe)&&!Xp(pe,"length").writable)throw rS("Cannot set read only .length");return pe.length=_e}:function(pe,_e){return pe.length=_e},oS=TypeError,Zp=function(pe,_e){if(!delete pe[_e])throw oS("Cannot delete property "+bn(_e)+" of "+bn(pe))},aS=lc("splice"),ph=Math.max,fh=Math.min;_n({target:"Array",proto:!0,forced:!aS},{splice:function(_e,Ve){var Oe,Ie,At,nr,kt,ur,gr=An(this),Ar=Ka(gr),Rr=xi(_e,Ar),Ur=arguments.length;for(Ur===0?Oe=Ie=0:Ur===1?(Oe=0,Ie=Ar-Rr):(Oe=Ur-2,Ie=fh(ph(sc(Ve),0),Ar-Rr)),Fu(Ar+Oe-Ie),At=ju(gr,Ie),nr=0;nr<Ie;nr++)(kt=Rr+nr)in gr&&ni(At,nr,gr[kt]);if(At.length=Ie,Oe<Ie){for(nr=Rr;nr<Ar-Ie;nr++)ur=nr+Oe,(kt=nr+Ie)in gr?gr[ur]=gr[kt]:Zp(gr,ur);for(nr=Ar;nr>Ar-Ie+Oe;nr--)Zp(gr,nr-1)}else if(Oe>Ie)for(nr=Ar-Ie;nr>Rr;nr--)ur=nr+Oe-1,(kt=nr+Ie-1)in gr?gr[ur]=gr[kt]:Zp(gr,ur);for(nr=0;nr<Oe;nr++)gr[nr+Rr]=arguments[nr+2];return nS(gr,Ar-Ie+Oe),At}});var sS=na("Array").splice,ef=Array.prototype,sy=function(pe){var _e=pe.splice;return pe===ef||vr(ef,pe)&&_e===ef.splice?sS:_e},tf=function(pe,_e,Ve,Oe){try{return Oe?_e(lo(Ve)[0],Ve[1]):_e(Ve)}catch(Ie){od(pe,"throw",Ie)}},Ud=Array,iy=!bg(function(pe){Array.from(pe)});_n({target:"Array",stat:!0,forced:iy},{from:function(_e){var Ve=An(_e),Oe=ul(this),Ie=arguments.length,At=Ie>1?arguments[1]:void 0,nr=At!==void 0;nr&&(At=Zo(At,Ie>2?arguments[2]:void 0));var kt,ur,gr,Ar,Rr,Ur,Dr=bl(Ve),Jr=0;if(!Dr||this===Ud&&Lm(Dr))for(kt=Ka(Ve),ur=Oe?new this(kt):Ud(kt);kt>Jr;Jr++)Ur=nr?At(Ve[Jr],Jr):Ve[Jr],ni(ur,Jr,Ur);else for(Rr=(Ar=hc(Ve,Dr)).next,ur=Oe?new this:[];!(gr=jt(Rr,Ar)).done;Jr++)Ur=nr?tf(Ar,At,[gr.value,Jr],!0):gr.value,ni(ur,Jr,Ur);return ur.length=Jr,ur}});var Kc=kr.Array.from,us=bl;function cy(pe,_e){var Ve,Oe=Ba!==void 0&&us(pe)||pe["@@iterator"];if(Oe)return Go(Ve=(Oe=Oe.call(pe)).next).call(Ve,Oe);if(ks(pe)||(Oe=function(nr,kt){var ur;if(nr){if(typeof nr=="string")return ly(nr,kt);var gr=Fo(ur=Object.prototype.toString.call(nr)).call(ur,8,-1);if(gr==="Object"&&nr.constructor&&(gr=nr.constructor.name),gr==="Map"||gr==="Set")return Kc(nr);if(gr==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(gr))return ly(nr,kt)}}(pe))||_e&&pe&&typeof pe.length=="number"){Oe&&(pe=Oe);var Ie=0;return function(){return Ie>=pe.length?{done:!0}:{done:!1,value:pe[Ie++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ly(pe,_e){(_e==null||_e>pe.length)&&(_e=pe.length);for(var Ve=0,Oe=new Array(_e);Ve<_e;Ve++)Oe[Ve]=pe[Ve];return Oe}var Ps,uy=function(){function pe(){this.timerList=[],this.id=0,this.timer=null,this.timeout=0}var _e=pe.prototype;return _e.addTimer=function(Oe,Ie,At){Ie===void 0&&(Ie=0),At===void 0&&(At=1);var nr=new Date().getTime(),kt=this.id;return this.timerList.push({id:kt,loop:At,count:0,timeout:nr+Ie,interval:Ie,callback:Oe}),this.id++,this.checkTimer(nr),kt},_e.checkTimer=function(Oe){if(Oe===void 0&&(Oe=new Date().getTime()),this.removeFinished(),this.timerList.length!==0||this.timer==null){for(var Ie,At,nr=0,kt=cy(this.timerList);!(Ie=kt()).done;){var ur=Ie.value;(nr===0||nr>ur.timeout)&&(nr=ur.timeout)}this.timerList.length!==0&&(this.timer===null||nr<this.timeout||this.timeout<Oe)&&(this.timer=wa(Go(At=this.nowTime).call(At,this),nr-Oe),this.timeout=nr)}},_e.nowTime=function(){for(var Oe,Ie=new Date().getTime(),At=cy(this.timerList);!(Oe=At()).done;){var nr=Oe.value;Ie>=nr.timeout&&(nr.callback(),nr.count++,nr.timeout=Ie+nr.interval)}this.clerTime(),this.checkTimer(Ie)},_e.clerTime=function(){this.timer!==null&&(clearTimeout(this.timer),this.timer=null)},_e.deleteTimer=function(Oe){for(var Ie=this.timerList.length-1;Ie>=0;Ie--){var At;this.timerList[Ie].id===Oe&&sy(At=this.timerList).call(At,Ie,1)}},_e.removeFinished=function(){for(var Oe=this.timerList.length-1;Oe>=0;Oe--){var Ie,At=this.timerList[Oe];At.loop>=0&&At.count>=At.loop&&sy(Ie=this.timerList).call(Ie,Oe,1)}},_e.destroy=function(){this.clerTime(),this.timerList=[],this.id=0,this.timer=null},pe}(),dy=function(){function pe(Ve){this.core=Ve}var _e=pe.prototype;return _e.request=function(Oe,Ie){var At=this,nr=new Date().getTime();return ya.request(Oe,Ie).catch(function(kt){var ur,gr,Ar=kt;throw At.core.reporter.reportTraceStart("exceptions",{user_id:At.core.options.account,trace_id:(gr=(ur=At.core)===null||ur===void 0?void 0:ur.socket)===null||gr===void 0?void 0:gr.sessionId,start_time:nr,action:1}),At.core.reporter.reportTraceUpdateV2("exceptions",{code:typeof Ar.code=="number"?Ar.code:0,description:Ar.message||""+Ar.code,operation_type:0,target:Oe,context:Ie?Eo(Ie):""}),At.core.reporter.reportTraceEnd("exceptions",1),kt})},_e.uploadFile=function(Oe){var Ie=this,At=new Date().getTime();return ya.uploadFile(Oe).catch(function(nr){var kt,ur,gr=nr;Ie.core.reporter.reportTraceStart("exceptions",{user_id:Ie.core.options.account,trace_id:(ur=(kt=Ie.core)===null||kt===void 0?void 0:kt.socket)===null||ur===void 0?void 0:ur.sessionId,start_time:At,action:1});var Ar=ya.platform==="BROWSER"?Oe.chunkUploadHost:Oe.commonUploadHost?Oe.commonUploadHost+"/"+(Oe.nosToken&&Oe.nosToken.bucket):"https://nos.netease.com/nim";throw Ie.core.reporter.reportTraceUpdateV2("exceptions",{code:typeof gr.code=="number"?gr.code:0,description:gr.message||""+gr.code,operation_type:1,target:Ar}),Ie.core.reporter.reportTraceEnd("exceptions",1),nr})},pe}();(function(pe){pe[pe.ACTIVE=1]="ACTIVE",pe[pe.KICKED=2]="KICKED",pe[pe.OFFLINE=3]="OFFLINE"})(Ps||(Ps={}));var py=window&&wp(window.addEventListener)&&wp(window.removeEventListener),qd=function(pe){function _e(Oe,Ie){var At;(At=pe.call(this)||this).status="unconnected",At.linkUrls=[],At.eventBus=new Bg,At.packetSer=1,At.retryCount=0,At.reconnectTimer=0,At.backoff=new iT({max:8e3,min:1600,jitter:.01}),At.sendingCmdMap=new xl,At.pingTimer=0,At.config=Ov,At.abtInfo={},On({linkUrls:{type:"array",itemType:"string",required:!1}},Oe),At.options=jn(jn({},Rv),Oe),At.adapters=new dy(k(At));var nr=ya.localStorage.getItem("__NIM_DEVC_ID__");At.options.isFixedDeviceId?(nr=ya.localStorage.getItem("__NIM_DEVC_ID__")||dh(),ya.localStorage.setItem("__NIM_DEVC_ID__",nr)):nr=dh(),At.config=jn(jn(jn({},Ov),Ie),{deviceId:nr}),At.timerManager=new uy,At.logger=new Dv(At.options.debugLevel,At.options.account);var kt=ya.getSystemInfo();return At.reporter=new Uv({common:{app_key:Oe.appkey,dev_id:nr,platform:"Web",sdk_ver:"0.13.1",env:"online",os_name:kt.os,os_ver:kt.osVer,model:kt.hostEnvVer,manufactor:kt.hostEnv,host_env:kt.hostEnv,host_info:kt.hostInfo,host_env_ver:kt.hostEnvVer},request:ya.request,logger:At.logger,autoStart:ya.platform==="BROWSER"}),ya.setLogger(At.logger),At.logger.log("Core init, version ","0.13.1"," sdk version ",91001," appkey ",Oe.appkey),At}Ko(_e,pe);var Ve=_e.prototype;return Ve.emit=function(Ie){try{for(var At,nr,kt=Ms(),ur=arguments.length,gr=new Array(ur>1?ur-1:0),Ar=1;Ar<ur;Ar++)gr[Ar-1]=arguments[Ar];var Rr=(At=pe.prototype.emit).call.apply(At,di(nr=[this,Ie]).call(nr,gr)),Ur=Ms()-kt;return Ur>=10&&this.logger.warn("Core::emit event: "+Ie+" process takes: "+Ur+"ms"),Rr}catch(Dr){return this.logger.error("Core::emit event: "+Ie+". Error: "+Dr),!1}},Ve.connect=function(Ie,At){return Ie===void 0&&(Ie={}),Hr(this,void 0,void 0,wr.mark(function nr(){var kt,ur,gr,Ar,Rr,Ur;return wr.wrap(function(Jr){for(;;)switch(Jr.prev=Jr.next){case 0:if(On({linkUrls:{type:"array",itemType:"string",required:!1}},Ie),/^(unconnected|waitReconnect)$/.test(this.status)){Jr.next=5;break}return kt="Core socket status is "+this.status+", and would not connect",this.logger.warn(kt),Jr.abrupt("return",wo.reject(kt));case 5:this.status="connecting",Ie.linkUrls&&Ie.linkUrls.length>0&&(this.linkUrls=di(ur=Ie.linkUrls).call(ur,this.linkUrls),this.linkUrls=tS(this.linkUrls)),this.linkUrls.length===0&&this.linkUrls.push("weblink.netease.im:443"),gr=0;case 9:if(!(gr<this.linkUrls.length)){Jr.next=32;break}return Ar=this.linkUrls[gr],Rr=new Date().getTime(),Jr.prev=12,Jr.next=15,this.doConnect(Ar);case 15:return this.status="connected",this.logger.log("core:: connect success with url: "+Ar),this.abtRequest(),Jr.abrupt("return",Ar);case 21:Jr.prev=21,Jr.t0=Jr.catch(12),Ur=Jr.t0,At&&At(Ur,Ar),this.reporter.reportTraceStart("exceptions",{user_id:this.options.account,start_time:Rr,action:0}),this.reporter.reportTraceUpdateV2("exceptions",{code:typeof Ur.code=="number"?Ur.code:0,description:Ur.message||""+Ur.code,operation_type:0,target:Ar}),this.reporter.reportTraceEnd("exceptions",1),this.logger.warn("core:: connect failed with url: "+Ar,Jr.t0);case 29:gr++,Jr.next=9;break;case 32:throw this.retryCount===0?this.doDisconnect(Ps.ACTIVE,"SocketHandshakeFailed"):this.doDisconnect(Ps.OFFLINE,"ReconnectHadRetryAllLinks"),new Error("core: socket handshake failed");case 34:case"end":return Jr.stop()}},nr,this,[[12,21]])}))},Ve.doConnect=function(Ie){var At=this;return new wo(function(nr,kt){var ur;At.socket=new wT(At,Ie,At.logger),At.socket.on("connect",function(){At.logger.log("socket on connect",Ie),nr()}),At.socket.on("message",Go(ur=At.onMessage).call(ur,At)),At.socket.on("disconnect",function(gr){At.logger.log("core:: socket on disconnect",gr),At.doDisconnect(Ps.OFFLINE,"SocketOnDisconnect")}),At.socket.on("handshakeFailed",function(){At.logger.warn("core:: socket handshake failed"),kt(new No("handshake failed",{},408))})})},Ve.resetConnectStatus=function(){clearTimeout(this.reconnectTimer),this.backoff.reset(),this.retryCount=0,this.initOnlineListener()},Ve.doDisconnect=function(Ie,At){if(this.logger.log("doDisconnect: type "+Ie+", description "+At),this.status!=="unconnected"){this.markAllCmdInvaild(new No("Packet timeout due to instance disconnect",{},408)),this.timerManager.destroy(),clearTimeout(this.pingTimer),this.socket&&(typeof this.socket.removeAllListeners=="function"&&this.socket.removeAllListeners(),typeof this.socket.close=="function"&&this.socket.close(),this.socket=void 0);var nr=!this.options.needReconnect||this.retryCount>=this.options.reconnectionAttempts;if(Ie===Ps.ACTIVE||nr)this.logger.log("doDisconnect: emit disconnect, type "+Ie,nr),this.status="unconnected",this.reconnectTimer&&clearTimeout(this.reconnectTimer),this.eventBus.emit("disconnect"),this.emit("disconnect"),this.destroyOnlineListener();else if(Ie===Ps.KICKED){this.logger.log("doDisconnect: kicked"),this.status="unconnected",this.reconnectTimer&&clearTimeout(this.reconnectTimer);var kt=typeof At=="string"?{reason:"unknow",message:At}:At;this.eventBus.emit("kicked",kt),this.emit("kicked",kt),this.destroyOnlineListener()}else Ie===Ps.OFFLINE?(this.logger.log("doDisconnect: start to reconnect"),this.attempToReconnect()):this.logger.log("doDisconnect: nothing to do")}else this.logger.warn("doDisconnect: already unconnected")},Ve.attempToReconnect=function(){var Ie=this;if(this.status!=="waitReconnect"){var At=this.backoff.duration();this.retryCount++,this.logger.log("willReconnect "+this.retryCount+" "+At),this.eventBus.emit("willReconnect",{retryCount:this.retryCount,duration:At}),this.emit("willReconnect",{retryCount:this.retryCount,duration:At}),this.status="waitReconnect",this.reconnectTimer&&clearTimeout(this.reconnectTimer),this.reconnectTimer=wa(function(){Ie.status==="waitReconnect"?Ie.connect({isAutoReconnect:!0}).catch(function(){Ie.logger.error("core::attempToReconnect failed "+Ie.retryCount)}):Ie.logger.warn("doDisconnect: reconnectTimer status is "+Ie.status+", would not go on reconnecting")},At)}else this.logger.warn("doDisconnect: already is waiting reconnect")},Ve.sendCmd=function(Ie,At,nr){var kt=this;if(this.status!=="logined"&&Ie!=="login"&&Ie!=="chatroomLogin"&&Ie!=="qchatLogin")return this.logger.warn("nim status is "+this.status+", so can not sendCmd "+Ie),wo.reject({cmd:Ie,error:{code:"No_connected",message:"Connection not established",timetag:new Date().getTime()}});if(!this.socket||!this.socket.send)return wo.reject("No_socket");var ur=Ie!=="heartbeat",gr=ur?this.packetSer++:0,Ar=function($n,Rn,Wn,Fn){var mo=Od[$n];if(!mo)return Wn.error("createCmd:: can not find cmd config: ",$n),null;var ao,ea={SER:Rn,SID:mo.sid,CID:mo.cid,Q:[]};return mo.params&&Fn&&Kn(ao=mo.params).call(ao,function(oo){var Wr=Fn[oo.name];if(!Hv(Wr)){var Gn=oo.type,Zn=oo.reflectMapper;switch(oo.type){case"PropertyArray":Gn="ArrayMable",Wr=Ao(Wr).call(Wr,function(qn){return{t:"Property",v:Zn?Cs(qn,Zn):qn}});break;case"Property":Wr=Zn?Cs(Wr,Zn):Wr;break;case"Bool":case"bool":Wr=Wr?"true":"false"}ea.Q.push({t:Gn,v:Wr})}}),{packet:ea,isNoResponse:mo.isNoResponse||!1}}(Ie,gr,this.logger,At);if(!Ar){var Rr="SendCmd "+gr+" "+Ie+" error";return this.logger.error(Rr),wo.reject(Rr)}var Ur=Ar.packet,Dr=Ar.isNoResponse,Jr=Eo(Ur);ur&&(this.options.debugLevel==="debug"?this.logger.debug("core::sendCmd",Ie,"ser:"+gr,Jr):this.logger.log("core::sendCmd",Ie,"ser:"+gr));var Cn=new Date().getTime();return new wo(function(Sn,$n){kt.sendingCmdMap.set(gr,{cmd:Ie,params:At,callback:[Sn,$n],timer:Dr?null:wa(function(){var Wn,Fn=new zg(504,Ie,"Packet Timeout",new Date().getTime(),{message:"ser "+gr+" cmd "+Ie+" timeout"});Fn.callFunc="sendCmd",kt.markCmdInvalid(gr,Fn,Ie),kt.reporter.reportTraceStart("exceptions",{user_id:kt.options.account,trace_id:(Wn=kt.socket)===null||Wn===void 0?void 0:Wn.sessionId,start_time:Cn,action:2}),kt.reporter.reportTraceUpdateV2("exceptions",{code:408,description:"Packet timeout",operation_type:1,target:Ur.SID+"-"+Ur.CID,context:""+Ur.SER}),kt.reporter.reportTraceEnd("exceptions",1)},nr&&nr.timeout?nr.timeout:kt.config.timeout)});try{kt.socket.send(Jr)}catch(Wn){var Rn=new zg(415,Ie,Wn&&Wn.message||"Unable to send packet",new Date().getTime(),{message:"send json error",rawError:Wn});Rn.callFunc="sendCmd",kt.markCmdInvalid(gr,Rn,Ie),$n(Wn)}})},Ve.onMessage=function(Ie){var At=ls(Ie,this.logger);if(At){var nr=At.raw.ser;if(At.error&&this.logger.error("core:onMessage packet error",At.raw.sid+"_"+At.raw.cid+", ser:"+nr+",",At.error),!At.notFound)return At.cmd!=="heartbeat"&&(this.options.debugLevel==="debug"?this.logger.debug("imsocket::recvCmd ser:"+nr,At.cmd,At.content):this.logger.log("imsocket::recvCmd ser:"+nr,At.cmd)),At.__receiveTime=Ms(),At;this.logger.warn("core::onMessage packet not found",At.raw.sid+"_"+At.raw.cid+", ser:"+nr)}},Ve.markCmdInvalid=function(Ie,At,nr){var kt=this.sendingCmdMap.get(Ie);if(kt){var ur=kt.callback,gr=kt.timer;gr&&clearTimeout(gr),this.sendingCmdMap.delete(Ie),this.logger.warn("packet "+Ie+", "+nr+" is invalid:",At),ur[1](At)}},Ve.markAllCmdInvaild=function(Ie){var At;this.logger.log("markAllCmdInvaild"),Kn(At=this.sendingCmdMap).call(At,function(nr){var kt=nr.callback,ur=nr.timer;ur&&clearTimeout(ur),kt[1](Ie)}),this.sendingCmdMap.clear()},Ve.ping=function(){return Hr(this,void 0,void 0,wr.mark(function Ie(){var At=this;return wr.wrap(function(kt){for(;;)switch(kt.prev=kt.next){case 0:return clearTimeout(this.pingTimer),kt.prev=1,kt.next=4,this.sendCmd("heartbeat");case 4:kt.next=14;break;case 6:return kt.prev=6,kt.t0=kt.catch(1),kt.next=10,this.testHeartBeat5Timeout();case 10:if(!kt.sent){kt.next=14;break}return this.doDisconnect(Ps.OFFLINE,"PingError"),kt.abrupt("return");case 14:this.pingTimer=wa(function(){At.ping()},3e4);case 15:case"end":return kt.stop()}},Ie,this,[[1,6]])}))},Ve.testHeartBeat5Timeout=function(){return Hr(this,void 0,void 0,wr.mark(function Ie(){var At;return wr.wrap(function(kt){for(;;)switch(kt.prev=kt.next){case 0:clearTimeout(this.pingTimer),At=0;case 2:if(!(At<5)){kt.next=15;break}return kt.prev=3,kt.next=6,this.sendCmd("heartbeat",{},{timeout:3e3});case 6:return kt.abrupt("return",!1);case 9:kt.prev=9,kt.t0=kt.catch(3),this.logger.debug("core:: test heartbeat "+At+" Timeout");case 12:At++,kt.next=2;break;case 15:return kt.abrupt("return",!0);case 16:case"end":return kt.stop()}},Ie,this,[[3,9]])}))},Ve.initOnlineListener=function(){var Ie,At;this.onlineListener||(py?(this.onlineListener=Go(Ie=function(){this.status==="logined"&&this.ping()}).call(Ie,this),this.offlineListener=Go(At=function(){this.logger.log("offline"),this.doDisconnect(Ps.OFFLINE,"OfflineListener")}).call(At,this),window.addEventListener("online",this.onlineListener),window.addEventListener("offline",this.offlineListener)):this.logger.warn("initOnlineListener not support add listener"))},Ve.destroyOnlineListener=function(){this.onlineListener&&(window.removeEventListener("online",this.onlineListener),this.onlineListener=void 0),this.offlineListener&&(window.removeEventListener("offline",this.offlineListener),this.offlineListener=void 0)},Ve.disconnect=function(){switch(this.status){case"connected":case"logined":case"connecting":case"waitReconnect":return this.doDisconnect(Ps.ACTIVE,"UserActiveDisconnect"),wo.resolve();case"unconnected":case"destroyed":return wo.resolve()}},Ve.destroy=function(){var Ie=this;return this.disconnect().then(function(){Ie.status="destroyed",Ie.removeAllListeners(),Ie.eventBus.removeAllListeners(),Ie.reporter.destroy(),Ie.connect=function(){return wo.resolve()},Ie.disconnect=function(){return wo.resolve()},Ie.destroy=function(){return wo.resolve()}})},Ve.abtRequest=function(){var Ie,At;return Hr(this,void 0,void 0,wr.mark(function nr(){var kt,ur;return wr.wrap(function(Ar){for(;;)switch(Ar.prev=Ar.next){case 0:if(this.options.isAbtestEnable){Ar.next=2;break}return Ar.abrupt("return");case 2:if(!this.abtInfo.experiments){Ar.next=4;break}return Ar.abrupt("return");case 4:if(this.options.abtestUrl){Ar.next=6;break}return Ar.abrupt("return");case 6:return Ar.prev=6,Ar.next=9,this.adapters.request(this.options.abtestUrl,{method:"POST",dataType:"json",headers:{sdktype:"ABTest"},data:{clientInfo:{projectKey:this.options.abtestProjectKey,appKey:this.options.appkey,osType:"Web",sdkVersion:"0.13.1",deviceId:this.config.deviceId},useLocalCache:!0}});case 9:kt=Ar.sent,Ar.next=15;break;case 12:Ar.prev=12,Ar.t0=Ar.catch(6),this.logger.warn("ABTest request failed");case 15:this.abtInfo=((At=(Ie=kt==null?void 0:kt.data)===null||Ie===void 0?void 0:Ie.data)===null||At===void 0?void 0:At.abtInfo)||{},this.abtInfo.experiments&&this.abtInfo.experiments.length>0&&this.reporter.reportImmediately("https://statistic.live.126.net/statics/report/abtest/result",{params:{app_key:this.options.appkey,biz_sdk_type:"IM",sdk_ver:"0.13.1",device_id:this.config.deviceId,platform:"Web",projectKey:this.options.abtestProjectKey,experiments:Ao(ur=this.abtInfo.experiments).call(ur,function(Rr){return{experimentKey:Rr.experimentKey,schemeKey:Rr.schemeKey}})},headers:{sdktype:"ABTest"},method:"POST",dataType:"json"});case 17:case"end":return Ar.stop()}},nr,this,[[6,12]])}))},_e}(Bg);qd.setAdapters=function(_e){jn(ya,_e)};var fy=js.some,qi=li("some");_n({target:"Array",proto:!0,forced:!qi},{some:function(_e){return fy(this,_e,arguments.length>1?arguments[1]:void 0)}});var rf=na("Array").some,mh=Array.prototype,nf=function(pe){var _e=pe.some;return pe===mh||vr(mh,pe)&&_e===mh.some?rf:_e},gh=function(){this.__data__=new $p,this.size=0},hh=function(_e){var Ve=this.__data__,Oe=Ve.delete(_e);return this.size=Ve.size,Oe},iS=function(_e){return this.__data__.get(_e)},cS=function(_e){return this.__data__.has(_e)},lS=function(_e,Ve){var Oe=this.__data__;if(Oe instanceof $p){var Ie=Oe.__data__;if(!Gc||Ie.length<199)return Ie.push([_e,Ve]),this.size=++Oe.size,this;Oe=this.__data__=new Ol(Ie)}return Oe.set(_e,Ve),this.size=Oe.size,this};function du(pe){var _e=this.__data__=new $p(pe);this.size=_e.size}du.prototype.clear=gh,du.prototype.delete=hh,du.prototype.get=iS,du.prototype.has=cS,du.prototype.set=lS;var of=du,gy=function(_e,Ve){for(var Oe=-1,Ie=_e==null?0:_e.length;++Oe<Ie;)if(Ve(_e[Oe],Oe,_e))return!0;return!1},vh=function(_e,Ve,Oe,Ie,At,nr){var kt=1&Oe,ur=_e.length,gr=Ve.length;if(ur!=gr&&!(kt&&gr>ur))return!1;var Ar=nr.get(_e),Rr=nr.get(Ve);if(Ar&&Rr)return Ar==Ve&&Rr==_e;var Ur=-1,Dr=!0,Jr=2&Oe?new rh:void 0;for(nr.set(_e,Ve),nr.set(Ve,_e);++Ur<ur;){var Cn=_e[Ur],Sn=Ve[Ur];if(Ie)var $n=kt?Ie(Sn,Cn,Ur,Ve,_e,nr):Ie(Cn,Sn,Ur,_e,Ve,nr);if($n!==void 0){if($n)continue;Dr=!1;break}if(Jr){if(!gy(Ve,function(Rn,Wn){if(!oh(Jr,Wn)&&(Cn===Rn||At(Cn,Rn,Oe,Ie,nr)))return Jr.push(Wn)})){Dr=!1;break}}else if(Cn!==Sn&&!At(Cn,Sn,Oe,Ie,nr)){Dr=!1;break}}return nr.delete(_e),nr.delete(Ve),Dr},hy=pi.Uint8Array,uS=function(_e){var Ve=-1,Oe=Array(_e.size);return _e.forEach(function(Ie,At){Oe[++Ve]=[At,Ie]}),Oe},Vd=Ji?Ji.prototype:void 0,Rl=Vd?Vd.valueOf:void 0,yh=function(_e,Ve,Oe,Ie,At,nr,kt){switch(Oe){case"[object DataView]":if(_e.byteLength!=Ve.byteLength||_e.byteOffset!=Ve.byteOffset)return!1;_e=_e.buffer,Ve=Ve.buffer;case"[object ArrayBuffer]":return!(_e.byteLength!=Ve.byteLength||!nr(new hy(_e),new hy(Ve)));case"[object Boolean]":case"[object Date]":case"[object Number]":return Rp(+_e,+Ve);case"[object Error]":return _e.name==Ve.name&&_e.message==Ve.message;case"[object RegExp]":case"[object String]":return _e==Ve+"";case"[object Map]":var ur=uS;case"[object Set]":var gr=1&Ie;if(ur||(ur=Wp),_e.size!=Ve.size&&!gr)return!1;var Ar=kt.get(_e);if(Ar)return Ar==Ve;Ie|=2,kt.set(_e,Ve);var Rr=vh(ur(_e),ur(Ve),Ie,At,nr,kt);return kt.delete(_e),Rr;case"[object Symbol]":if(Rl)return Rl.call(_e)==Rl.call(Ve)}return!1},Zs=function(_e,Ve){for(var Oe=-1,Ie=Ve.length,At=_e.length;++Oe<Ie;)_e[At+Oe]=Ve[Oe];return _e},rc=Array.isArray,af=function(_e,Ve,Oe){var Ie=Ve(_e);return rc(_e)?Ie:Zs(Ie,Oe(_e))},ns=function(_e,Ve){for(var Oe=-1,Ie=_e==null?0:_e.length,At=0,nr=[];++Oe<Ie;){var kt=_e[Oe];Ve(kt,Oe,_e)&&(nr[At++]=kt)}return nr},vy=function(){return[]},bh=Object.prototype.propertyIsEnumerable,Th=Object.getOwnPropertySymbols,dS=Th?function(pe){return pe==null?[]:(pe=Object(pe),ns(Th(pe),function(_e){return bh.call(pe,_e)}))}:vy,Sh=dS,pS=function(_e,Ve){for(var Oe=-1,Ie=Array(_e);++Oe<_e;)Ie[Oe]=Ve(Oe);return Ie},sf=function(_e){return Es(_e)&&yi(_e)=="[object Arguments]"},Mh=Object.prototype,pu=Mh.hasOwnProperty,fS=Mh.propertyIsEnumerable,Ch=sf(function(){return arguments}())?sf:function(pe){return Es(pe)&&pu.call(pe,"callee")&&!fS.call(pe,"callee")},kh=Ch,mS=function(){return!1},wh=g(function(pe,_e){var Ve=_e&&!_e.nodeType&&_e,Oe=Ve&&pe&&!pe.nodeType&&pe,Ie=Oe&&Oe.exports===Ve?pi.Buffer:void 0,At=(Ie?Ie.isBuffer:void 0)||mS;pe.exports=At}),yy=/^(?:0|[1-9]\d*)$/,Hd=function(_e,Ve){var Oe=typeof _e;return!!(Ve=Ve??9007199254740991)&&(Oe=="number"||Oe!="symbol"&&yy.test(_e))&&_e>-1&&_e%1==0&&_e<Ve},Da={};Da["[object Float32Array]"]=Da["[object Float64Array]"]=Da["[object Int8Array]"]=Da["[object Int16Array]"]=Da["[object Int32Array]"]=Da["[object Uint8Array]"]=Da["[object Uint8ClampedArray]"]=Da["[object Uint16Array]"]=Da["[object Uint32Array]"]=!0,Da["[object Arguments]"]=Da["[object Array]"]=Da["[object ArrayBuffer]"]=Da["[object Boolean]"]=Da["[object DataView]"]=Da["[object Date]"]=Da["[object Error]"]=Da["[object Function]"]=Da["[object Map]"]=Da["[object Number]"]=Da["[object Object]"]=Da["[object RegExp]"]=Da["[object Set]"]=Da["[object String]"]=Da["[object WeakMap]"]=!1;var by=function(_e){return Es(_e)&&ih(_e.length)&&!!Da[yi(_e)]},xh=ru&&ru.isTypedArray,_c=xh?Xg(xh):by,Ty=Object.prototype.hasOwnProperty,Sy=function(_e,Ve){var Oe=rc(_e),Ie=!Oe&&kh(_e),At=!Oe&&!Ie&&wh(_e),nr=!Oe&&!Ie&&!At&&_c(_e),kt=Oe||Ie||At||nr,ur=kt?pS(_e.length,String):[],gr=ur.length;for(var Ar in _e)!Ve&&!Ty.call(_e,Ar)||kt&&(Ar=="length"||At&&(Ar=="offset"||Ar=="parent")||nr&&(Ar=="buffer"||Ar=="byteLength"||Ar=="byteOffset")||Hd(Ar,gr))||ur.push(Ar);return ur},gS=Object.prototype,My=function(_e){var Ve=_e&&_e.constructor;return _e===(typeof Ve=="function"&&Ve.prototype||gS)},Cy=function(_e,Ve){return function(Oe){return _e(Ve(Oe))}},ky=Cy(Object.keys,Object),hS=Object.prototype.hasOwnProperty,_h=function(_e){if(!My(_e))return ky(_e);var Ve=[];for(var Oe in Object(_e))hS.call(_e,Oe)&&Oe!="constructor"&&Ve.push(Oe);return Ve},Qc=function(_e){return zp(_e)?Sy(_e):_h(_e)},Ih=function(_e){return af(_e,Qc,Sh)},vS=Object.prototype.hasOwnProperty,wy=function(_e,Ve,Oe,Ie,At,nr){var kt=1&Oe,ur=Ih(_e),gr=ur.length;if(gr!=Ih(Ve).length&&!kt)return!1;for(var Ar=gr;Ar--;){var Rr=ur[Ar];if(!(kt?Rr in Ve:vS.call(Ve,Rr)))return!1}var Ur=nr.get(_e),Dr=nr.get(Ve);if(Ur&&Dr)return Ur==Ve&&Dr==_e;var Jr=!0;nr.set(_e,Ve),nr.set(Ve,_e);for(var Cn=kt;++Ar<gr;){var Sn=_e[Rr=ur[Ar]],$n=Ve[Rr];if(Ie)var Rn=kt?Ie($n,Sn,Rr,Ve,_e,nr):Ie(Sn,$n,Rr,_e,Ve,nr);if(!(Rn===void 0?Sn===$n||At(Sn,$n,Oe,Ie,nr):Rn)){Jr=!1;break}Cn||(Cn=Rr=="constructor")}if(Jr&&!Cn){var Wn=_e.constructor,Fn=Ve.constructor;Wn==Fn||!("constructor"in _e)||!("constructor"in Ve)||typeof Wn=="function"&&Wn instanceof Wn&&typeof Fn=="function"&&Fn instanceof Fn||(Jr=!1)}return nr.delete(_e),nr.delete(Ve),Jr},Ic=Nl(pi,"DataView"),is=Nl(pi,"Promise"),fu=Nl(pi,"WeakMap"),Fa="[object Map]",Ti="[object Promise]",xy="[object Set]",ws="[object WeakMap]",Eh="[object DataView]",Ph=Pl(Ic),yS=Pl(Gc),bS=Pl(is),_y=Pl(uu),TS=Pl(fu),Bl=yi;(Ic&&Bl(new Ic(new ArrayBuffer(1)))!=Eh||Gc&&Bl(new Gc)!=Fa||is&&Bl(is.resolve())!=Ti||uu&&Bl(new uu)!=xy||fu&&Bl(new fu)!=ws)&&(Bl=function(pe){var _e=yi(pe),Ve=_e=="[object Object]"?pe.constructor:void 0,Oe=Ve?Pl(Ve):"";if(Oe)switch(Oe){case Ph:return Eh;case yS:return Fa;case bS:return Ti;case _y:return xy;case TS:return ws}return _e});var zd=Bl,Si="[object Arguments]",Ah="[object Array]",cf="[object Object]",Wd=Object.prototype.hasOwnProperty,Iy=function(_e,Ve,Oe,Ie,At,nr){var kt=rc(_e),ur=rc(Ve),gr=kt?Ah:zd(_e),Ar=ur?Ah:zd(Ve),Rr=(gr=gr==Si?cf:gr)==cf,Ur=(Ar=Ar==Si?cf:Ar)==cf,Dr=gr==Ar;if(Dr&&wh(_e)){if(!wh(Ve))return!1;kt=!0,Rr=!1}if(Dr&&!Rr)return nr||(nr=new of),kt||_c(_e)?vh(_e,Ve,Oe,Ie,At,nr):yh(_e,Ve,gr,Oe,Ie,At,nr);if(!(1&Oe)){var Jr=Rr&&Wd.call(_e,"__wrapped__"),Cn=Ur&&Wd.call(Ve,"__wrapped__");if(Jr||Cn){var Sn=Jr?_e.value():_e,$n=Cn?Ve.value():Ve;return nr||(nr=new of),At(Sn,$n,Oe,Ie,nr)}}return!!Dr&&(nr||(nr=new of),wy(_e,Ve,Oe,Ie,At,nr))},Nh=function pe(_e,Ve,Oe,Ie,At){return _e===Ve||(_e==null||Ve==null||!Es(_e)&&!Es(Ve)?_e!=_e&&Ve!=Ve:Iy(_e,Ve,Oe,Ie,pe,At))},SS=function(_e,Ve,Oe,Ie){var At=Oe.length,nr=At,kt=!Ie;if(_e==null)return!nr;for(_e=Object(_e);At--;){var ur=Oe[At];if(kt&&ur[2]?ur[1]!==_e[ur[0]]:!(ur[0]in _e))return!1}for(;++At<nr;){var gr=(ur=Oe[At])[0],Ar=_e[gr],Rr=ur[1];if(kt&&ur[2]){if(Ar===void 0&&!(gr in _e))return!1}else{var Ur=new of;if(Ie)var Dr=Ie(Ar,Rr,gr,_e,Ve,Ur);if(!(Dr===void 0?Nh(Rr,Ar,3,Ie,Ur):Dr))return!1}}return!0},Ey=function(_e){return _e==_e&&!Fi(_e)},MS=function(_e){for(var Ve=Qc(_e),Oe=Ve.length;Oe--;){var Ie=Ve[Oe],At=_e[Ie];Ve[Oe]=[Ie,At,Ey(At)]}return Ve},Oh=function(_e,Ve){return function(Oe){return Oe!=null&&Oe[_e]===Ve&&(Ve!==void 0||_e in Object(Oe))}},Py=function(_e){var Ve=MS(_e);return Ve.length==1&&Ve[0][2]?Oh(Ve[0][0],Ve[0][1]):function(Oe){return Oe===_e||SS(Oe,_e,Ve)}},lf=function(_e){return typeof _e=="symbol"||Es(_e)&&yi(_e)=="[object Symbol]"},CS=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,kS=/^\w*$/,Gd=function(_e,Ve){if(rc(_e))return!1;var Oe=typeof _e;return!(Oe!="number"&&Oe!="symbol"&&Oe!="boolean"&&_e!=null&&!lf(_e))||kS.test(_e)||!CS.test(_e)||Ve!=null&&_e in Object(Ve)};function Rh(pe,_e){if(typeof pe!="function"||_e!=null&&typeof _e!="function")throw new TypeError("Expected a function");var Ve=function(){var Oe=arguments,Ie=_e?_e.apply(this,Oe):Oe[0],At=Ve.cache;if(At.has(Ie))return At.get(Ie);var nr=pe.apply(this,Oe);return Ve.cache=At.set(Ie,nr)||At,nr};return Ve.cache=new(Rh.Cache||Ol),Ve}Rh.Cache=Ol;var uf=Rh,wS=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,df=/\\(\\)?/g,Ua=function(_e){var Ve=uf(_e,function(Ie){return Oe.size===500&&Oe.clear(),Ie}),Oe=Ve.cache;return Ve}(function(pe){var _e=[];return pe.charCodeAt(0)===46&&_e.push(""),pe.replace(wS,function(Ve,Oe,Ie,At){_e.push(Ie?At.replace(df,"$1"):Oe||Ve)}),_e}),xS=Ua,Bh=Ji?Ji.prototype:void 0,Fh=Bh?Bh.toString:void 0,_S=function pe(_e){if(typeof _e=="string")return _e;if(rc(_e))return cu(_e,pe)+"";if(lf(_e))return Fh?Fh.call(_e):"";var Ve=_e+"";return Ve=="0"&&1/_e==-1/0?"-0":Ve},Ay=function(_e){return _e==null?"":_S(_e)},pf=function(_e,Ve){return rc(_e)?_e:Gd(_e,Ve)?[_e]:xS(Ay(_e))},Fl=function(_e){if(typeof _e=="string"||lf(_e))return _e;var Ve=_e+"";return Ve=="0"&&1/_e==-1/0?"-0":Ve},$h=function(_e,Ve){for(var Oe=0,Ie=(Ve=pf(Ve,_e)).length;_e!=null&&Oe<Ie;)_e=_e[Fl(Ve[Oe++])];return Oe&&Oe==Ie?_e:void 0},ms=function(_e,Ve,Oe){var Ie=_e==null?void 0:$h(_e,Ve);return Ie===void 0?Oe:Ie},IS=function(_e,Ve){return _e!=null&&Ve in Object(_e)},Kd=function(_e,Ve,Oe){for(var Ie=-1,At=(Ve=pf(Ve,_e)).length,nr=!1;++Ie<At;){var kt=Fl(Ve[Ie]);if(!(nr=_e!=null&&Oe(_e,kt)))break;_e=_e[kt]}return nr||++Ie!=At?nr:!!(At=_e==null?0:_e.length)&&ih(At)&&Hd(kt,At)&&(rc(_e)||kh(_e))},Ny=function(_e,Ve){return _e!=null&&Kd(_e,Ve,IS)},ES=function(_e,Ve){return Gd(_e)&&Ey(Ve)?Oh(Fl(_e),Ve):function(Oe){var Ie=ms(Oe,_e);return Ie===void 0&&Ie===Ve?Ny(Oe,_e):Nh(Ve,Ie,3)}},Lh=function(_e){return function(Ve){return Ve==null?void 0:Ve[_e]}},PS=function(_e){return function(Ve){return $h(Ve,_e)}},AS=function(_e){return Gd(_e)?Lh(Fl(_e)):PS(_e)},gs=function(_e){return typeof _e=="function"?_e:_e==null?qp:typeof _e=="object"?rc(_e)?ES(_e[0],_e[1]):Py(_e):AS(_e)},NS=function(_e,Ve,Oe){Ve=="__proto__"&&Vp?Vp(_e,Ve,{configurable:!0,enumerable:!0,value:Oe,writable:!0}):_e[Ve]=Oe},jh=Object.prototype.hasOwnProperty,Oy=function(_e,Ve,Oe){var Ie=_e[Ve];jh.call(_e,Ve)&&Rp(Ie,Oe)&&(Oe!==void 0||Ve in _e)||NS(_e,Ve,Oe)},OS=function(_e,Ve,Oe,Ie){if(!Fi(_e))return _e;for(var At=-1,nr=(Ve=pf(Ve,_e)).length,kt=nr-1,ur=_e;ur!=null&&++At<nr;){var gr=Fl(Ve[At]),Ar=Oe;if(gr==="__proto__"||gr==="constructor"||gr==="prototype")return _e;if(At!=kt){var Rr=ur[gr];(Ar=Ie?Ie(Rr,gr,ur):void 0)===void 0&&(Ar=Fi(Rr)?Rr:Hd(Ve[At+1])?[]:{})}Oy(ur,gr,Ar),ur=ur[gr]}return _e},Ry=function(_e,Ve,Oe){for(var Ie=-1,At=Ve.length,nr={};++Ie<At;){var kt=Ve[Ie],ur=$h(_e,kt);Oe(ur,kt)&&OS(nr,pf(kt,_e),ur)}return nr},By=Cy(Object.getPrototypeOf,Object),Qd=Object.getOwnPropertySymbols?function(pe){for(var _e=[];pe;)Zs(_e,Sh(pe)),pe=By(pe);return _e}:vy,RS=function(_e){var Ve=[];if(_e!=null)for(var Oe in Object(_e))Ve.push(Oe);return Ve},BS=Object.prototype.hasOwnProperty,Fy=function(_e){if(!Fi(_e))return RS(_e);var Ve=My(_e),Oe=[];for(var Ie in _e)(Ie!="constructor"||!Ve&&BS.call(_e,Ie))&&Oe.push(Ie);return Oe},FS=function(_e){return zp(_e)?Sy(_e,!0):Fy(_e)},$S=function(_e){return af(_e,FS,Qd)},Dh,$y,Ly=function(_e,Ve){if(_e==null)return{};var Oe=cu($S(_e),function(Ie){return[Ie]});return Ve=gs(Ve),Ry(_e,Oe,function(Ie,At){return Ve(Ie,At[0])})},jy={"6_2":"getNosToken","6_22":"getOriginUrl","6_26":"getNosCdnHost","6_27":"getGrayscaleConfig","6_28":"getMixStorePolicy","6_29":"getMixStoreToken","6_30":"getFileAuthToken"},mu={nosToken:{objectName:1,token:2,bucket:3,expireTime:4,expireSec:7,tag:8,shortUrl:9},mixStoreTokenReqTag:{provider:0,tokenCount:1,fileExpireSec:2,tag:3,returnBody:4},nosConfigTag:{bucket:1,cdnDomain:2,expire:3,objectNamePrefix:4},grayConfigTag:{config:0,ttl:1},mixStorePolicyTag:{providers:0,ttl:1,mixEnable:2,nosPolicy:3,s3Policy:4},mixStoreTokenResTag:{provider:0,accessKeyId:1,secretAccessKey:2,sessionToken:3,token:4,expireTime:5,bucket:6,objectName:7,fileExpireSec:8,tag:9,shortUrl:10,region:11},nosSafeUrlTag:{safeUrl:0,originUrl:1},mixStoreAuthTokenReqTag:{type:1,urls:2},mixStoreAuthTokenResTag:{type:1,tokens:2,token:3,ttl:4}},$l=zc(mu),Uh={getNosToken:{sid:6,cid:2,service:"cloudStorage",response:[{type:"Property",name:"nosToken",reflectMapper:$l.nosToken}],params:[{type:"String",name:"responseBody"},{type:"Property",name:"nosToken",entity:"nosToken",reflectMapper:mu.nosToken}]},getOriginUrl:{sid:6,cid:22,service:"cloudStorage",response:[{type:"Property",name:"nosSafeUrlTag",reflectMapper:$l.nosSafeUrlTag}],params:[{type:"Property",name:"nosSafeUrlTag",reflectMapper:mu.nosSafeUrlTag}]},getNosCdnHost:{sid:6,cid:26,service:"misc",response:[{type:"Property",name:"nosConfigTag",reflectMapper:$l.nosConfigTag}]},getGrayscaleConfig:{sid:6,cid:27,service:"cloudStorage",response:[{type:"Property",name:"grayConfigTag",reflectMapper:$l.grayConfigTag}],params:[{type:"Property",name:"config"}]},getMixStorePolicy:{sid:6,cid:28,service:"cloudStorage",params:[{type:"LongArray",name:"supportType"}],response:[{type:"Property",name:"mixStorePolicyTag",reflectMapper:$l.mixStorePolicyTag}]},getMixStoreToken:{sid:6,cid:29,service:"cloudStorage",params:[{type:"Property",name:"mixStoreTokenReqTag",reflectMapper:mu.mixStoreTokenReqTag}],response:[{type:"Property",name:"mixStoreTokenResTag",reflectMapper:$l.mixStoreTokenResTag}]},getFileAuthToken:{sid:6,cid:30,service:"cloudStorage",params:[{type:"Property",name:"mixStoreAuthTokenReqTag",reflectMapper:mu.mixStoreAuthTokenReqTag}],response:[{type:"Property",name:"mixStoreAuthTokenResTag",reflectMapper:$l.mixStoreAuthTokenResTag}]}};(function(pe){pe[pe.nos=1]="nos",pe[pe.s3=2]="s3"})(Dh||(Dh={})),function(pe){pe[pe.dontNeed=-1]="dontNeed",pe[pe.time=2]="time",pe[pe.urls=3]="urls"}($y||($y={}));var fi,nc,LS={chunkUploadHost:"https://wanproxy-web.127.net",commonUploadHost:"https://nos.netease.com",chunkMaxSize:4194304e4,commonMaxSize:104857600,uploadReplaceFormat:"https://{host}/{object}",cdn:{defaultCdnDomain:"nim.nosdn.127.net",cdnDomain:"",bucket:"",objectNamePrefix:""},downloadUrl:"https://{bucket}-nosdn.netease.im/{object}",downloadHostList:["nos.netease.com"],nosCdnEnable:!0,isNeedToGetUploadPolicyFromServer:!0},Jc={file:{md5:"$(Etag)",size:"$(ObjectSize)"},image:{md5:"$(Etag)",size:"$(ObjectSize)",w:"$(ImageInfo.Width)",h:"$(ImageInfo.Height)",orientation:"$(ImageInfo.Orientation)"},audio:{md5:"$(Etag)",size:"$(ObjectSize)",dur:"$(AVinfo.Audio.Duration)"},video:{md5:"$(Etag)",size:"$(ObjectSize)",dur:"$(AVinfo.Video.Duration)",w:"$(AVinfo.Video.Width)",h:"$(AVinfo.Video.Height)"}},qh={accessKeyId:"",secretAccessKey:"",sessionToken:"",region:"",maxRetries:0,bucket:"",objectName:"",token:"",shortUrl:""};function Vh(pe){return pe===void 0&&(pe="file"),Eo(Jc[pe]||{}).replace(/"/gi,'\\"')}(function(pe){pe[pe.nos=1]="nos",pe[pe.s3=2]="s3"})(fi||(fi={})),function(pe){pe[pe.dontNeed=-1]="dontNeed",pe[pe.time=2]="time",pe[pe.urls=3]="urls"}(nc||(nc={}));var Dy=function(){function pe(Ve,Oe){Oe===void 0&&(Oe={}),this.GRAYKEY="AllGrayscaleConfig",this.MIXSTOREKEY="AllMixStorePolicy",this.config={},this.nosCdnHostTimer=0,this.grayConfig={mixStoreEnable:!1,timeStamp:0,ttl:0},this.mixStorePolicy={providers:[],timeStamp:0,ttl:0,s3Policy:null,nosPolicy:null},this.curProvider=fi.nos,this.s3=null,this.mixStoreErrorCount=10,this.nosErrorCount=0,this.circuitTimer=0,this.name="cloudStorage",this.logger=Ve.logger,this.core=Ve,Zi({cmdMap:jy,cmdConfig:Uh}),this.setOptions(Oe)}var _e=pe.prototype;return _e.setOptions=function(Oe){Oe===void 0&&(Oe={});var Ie=Oe.storageKeyPrefix||"NIMClient";this.GRAYKEY=Ie+"-AllGrayscaleConfig",this.MIXSTOREKEY=Ie+"-AllMixStorePolicy";var At=Oe.s3,nr=Yl(Oe,["s3"]),kt=jn({},LS,this.config);if(nr&&Object.prototype.hasOwnProperty.call(nr,"cdn")){var ur={cdn:jn(jn({},kt.cdn),nr.cdn)};this.config=jn({},kt,nr,ur)}else this.config=jn({},kt,nr);At&&(this.s3=At)},_e.init=function(){return Hr(this,void 0,void 0,wr.mark(function Oe(){return wr.wrap(function(At){for(;;)switch(At.prev=At.next){case 0:if(this.grayConfig=null,this.mixStorePolicy={providers:[],timeStamp:0,ttl:0,s3Policy:null,nosPolicy:null},this.curProvider=fi.nos,this.mixStoreErrorCount=10,!this.config.isNeedToGetUploadPolicyFromServer){At.next=9;break}return At.next=7,this.getGrayscaleConfig(this.core.options.appkey);case 7:return At.next=9,this.getNosCdnHost();case 9:case"end":return At.stop()}},Oe,this)}))},_e.uploadFile=function(Oe){return Hr(this,void 0,void 0,wr.mark(function Ie(){var At,nr,kt;return wr.wrap(function(gr){for(;;)switch(gr.prev=gr.next){case 0:if(On({maxSize:{type:"number",required:!1},type:{type:"enum",values:["file","image","audio","video"]}},Oe),Oe.fileInput||Oe.file||Oe.filePath){gr.next=3;break}throw new Error("uploadFile needs target file object or a filePath");case 3:if(!Oe.type||Oe.type==="file"){gr.next=7;break}if(typeof(At=ms(Oe,"file.type"))!="string"||Na(At).call(At,Oe.type)!==-1){gr.next=7;break}throw new Error('The meta type "'+At+'" does not match "'+Oe.type+'"');case 7:if(this.grayConfig&&this.grayConfig.mixStoreEnable&&this.mixStorePolicy.providers.length){gr.next=10;break}return this.logger.log("uploadFile:: uploadFile begin, use old nos"),gr.abrupt("return",this.nosUpload(Oe));case 10:return this.logger.log("uploadFile:: uploadFile begin,Current settings grayConfig mixStoreEnable:"+this.grayConfig.mixStoreEnable+" curProvider:"+this.curProvider),this.s3||(this.curProvider=fi.nos),nr=qh,gr.prev=13,gr.next=16,this.core.sendCmd("getMixStoreToken",{mixStoreTokenReqTag:{provider:this.curProvider,tokenCount:1,tag:"qchat",returnBody:Vh(Oe.type)}});case 16:kt=gr.sent,nr=kt.content.mixStoreTokenResTag,gr.next=24;break;case 20:throw gr.prev=20,gr.t0=gr.catch(13),this.core.logger.error("uploadFile:: getMixStoreToken error",gr.t0),new Vc("getMixStoreToken error",gr.t0,this.curProvider,this.mixStorePolicy);case 24:return gr.abrupt("return",this.curProvider===fi.s3?this.s3Upload(Oe,nr):this.nosUpload(Oe,nr));case 25:case"end":return gr.stop()}},Ie,this,[[13,20]])}))},_e.nosUpload=function(Oe,Ie){var At,nr;return Hr(this,void 0,void 0,wr.mark(function kt(){var ur,gr,Ar,Rr,Ur,Dr,Jr,Cn,Sn,$n,Rn,Wn,Fn;return wr.wrap(function(ao){for(;;)switch(ao.prev=ao.next){case 0:if(ur=ms(this.core,"config.cdn.bucket"),gr={tag:Oe.nosScenes||ur||"nim",expireSec:Oe.nosSurvivalTime},Ie){ao.next=13;break}return ao.prev=3,ao.next=6,this.core.sendCmd("getNosToken",{responseBody:Vh(Oe.type),nosToken:gr});case 6:Ar=ao.sent,ao.next=13;break;case 9:throw ao.prev=9,ao.t0=ao.catch(3),this.core.logger.error("uploadFile:: getNosToken error",ao.t0),new Vc("getNosToken error",ao.t0,1);case 13:return ao.prev=13,Ur=Ar?Ar.content.nosToken:Ie,this.core.logger.debug("uploadFile:: uploadFile params",{nosToken:Ur,chunkUploadHost:this.config.chunkUploadHost,commonUploadHost:this.config.commonUploadHost,platform:ya.platform}),ao.next=18,this.core.adapters.uploadFile(jn(jn({},Oe),{nosToken:Ur,chunkUploadHost:this.config.chunkUploadHost,commonUploadHost:this.config.commonUploadHost,maxSize:Oe.maxSize||this.config.chunkMaxSize}));case 18:Rr=ao.sent,ao.next=42;break;case 21:if(ao.prev=21,ao.t1=ao.catch(13),this.core.logger.error("uploadFile::nos uploadFile error",ao.t1),!Ie){ao.next=41;break}if(this.nosErrorCount!==0){ao.next=37;break}ao.prev=26,this._addCircuitTimer(),ao.next=33;break;case 30:throw ao.prev=30,ao.t2=ao.catch(26),new Vc("upload file error",ao.t2,this.curProvider,this.mixStorePolicy,Oe.file||Oe.filePath);case 33:return this.nosErrorCount=(At=this.mixStorePolicy.nosPolicy)===null||At===void 0?void 0:At.uploadConfig.retryPolicy.retry,ao.abrupt("return",this.uploadFile(Oe));case 37:return this.nosErrorCount--,ao.abrupt("return",this.nosUpload(Oe,Ie));case 39:ao.next=42;break;case 41:throw new Vc("nos uploadFile error",ao.t1,1);case 42:if(Dr=Rr==null?void 0:Rr.type,Jr=Dr&&Na(Dr).call(Dr,"/")>-1?Fo(Dr).call(Dr,0,Na(Dr).call(Dr,"/")):"",Cn={image:"imageInfo",video:"vinfo",audio:"vinfo"},Sn=this.config.uploadReplaceFormat.replace("{host}",this.config.cdn.cdnDomain||this.config.cdn.defaultCdnDomain).replace("{object}",Ar?Ar.content.nosToken.objectName:Ie==null?void 0:Ie.objectName),Ie&&Ie.shortUrl&&(Sn=Ie.shortUrl),Cn[Jr]){ao.next=49;break}return ao.abrupt("return",jn({url:Sn},Rr));case 49:if(ao.prev=49,!(Na(Sn).call(Sn,"_im_url=1")<0)){ao.next=54;break}return ao.next=53,this.core.adapters.request(Sn+"?"+Cn[Jr],{method:"GET",dataType:"json",timeout:5e3});case 53:$n=ao.sent;case 54:ao.next=60;break;case 56:return ao.prev=56,ao.t3=ao.catch(49),this.core.logger.error("uploadFile:: fetch file info error",ao.t3),ao.abrupt("return",jn({url:Sn},Rr));case 60:if(!$n){ao.next=67;break}return Rn=$n.data,Wn=Cn[Jr]==="imageInfo"?Rn:(nr=Rn==null?void 0:Rn.GetVideoInfo)===null||nr===void 0?void 0:nr.VideoInfo,Fn={url:Sn,name:Rr.name,size:Rr.size,ext:Rr.ext,w:Wn.Width,h:Wn.Height,orientation:Wn.Orientation,dur:Wn.Duration,audioCodec:Wn.AudioCodec,videoCodec:Wn.VideoCodec,container:Wn.Container},ao.abrupt("return",Ly(Fn,function(ea,oo){return oo!==void 0}));case 67:return ao.abrupt("return",jn({url:Sn},Rr));case 68:case"end":return ao.stop()}},kt,this,[[3,9],[13,21],[26,30],[49,56]])}))},_e.getNosCdnHost=function(){var Oe;return Hr(this,void 0,void 0,wr.mark(function Ie(){var At,nr,kt,ur=this;return wr.wrap(function(Ar){for(;;)switch(Ar.prev=Ar.next){case 0:return Ar.prev=0,Ar.next=3,this.core.sendCmd("getNosCdnHost");case 3:At=Ar.sent,Ar.next=10;break;case 6:return Ar.prev=6,Ar.t0=Ar.catch(0),this.logger.error("getNosCdnHost::error",Ar.t0),Ar.abrupt("return");case 10:if(At){Ar.next=12;break}return Ar.abrupt("return");case 12:nr=(Oe=At==null?void 0:At.content)===null||Oe===void 0?void 0:Oe.nosConfigTag,(kt=Yo(nr==null?void 0:nr.expire))!==0&&nr.cdnDomain?kt===-1?(this.config.cdn.bucket=nr.bucket,this.config.cdn.cdnDomain=nr.cdnDomain,this.config.cdn.objectNamePrefix=nr.objectNamePrefix):(this.config.cdn.bucket=nr.bucket,this.config.cdn.cdnDomain=nr.cdnDomain,this.config.cdn.objectNamePrefix=nr.objectNamePrefix,this.nosCdnHostTimer=this.core.timerManager.addTimer(function(){ur.getNosCdnHost()},1e3*kt)):(this.config.cdn.bucket="",this.config.cdn.cdnDomain="",this.config.cdn.objectNamePrefix="");case 15:case"end":return Ar.stop()}},Ie,this,[[0,6]])}))},_e.getGrayscaleConfig=function(Oe){var Ie;return Hr(this,void 0,void 0,wr.mark(function At(){var nr,kt;return wr.wrap(function(gr){for(;;)switch(gr.prev=gr.next){case 0:if(ya.localStorage)try{ya.localStorage.getItem&&ya.localStorage.getItem(this.GRAYKEY)&&(this.grayConfig=JSON.parse(ya.localStorage.getItem(this.GRAYKEY))[Oe])}catch(Ar){ya.localStorage.getItem(this.GRAYKEY)&&this.core.logger.error("uploadFile:: JSON.parse grayscaleConfig error ",Ar)}if(this.grayConfig&&!(this.grayConfig.timeStamp+1e3*this.grayConfig.ttl<new Date().getTime())){gr.next=17;break}return gr.next=4,this.core.sendCmd("getGrayscaleConfig",{config:{}});case 4:if(!(nr=gr.sent).content||!nr.content.grayConfigTag){gr.next=16;break}this.logger.log("uploadFile::getAppGrayConfigRequest success ");try{this.grayConfig=JSON.parse(nr.content.grayConfigTag.config),this.grayConfig.ttl=JSON.parse(nr.content.grayConfigTag.ttl)}catch(Ar){this.logger.error("getGrayscaleConfig error",Ar)}if(this.grayConfig){gr.next=10;break}return gr.abrupt("return");case 10:kt=ya.localStorage.getItem(this.GRAYKEY)?JSON.parse(ya.localStorage.getItem(this.GRAYKEY)):{},this.grayConfig.timeStamp=new Date().getTime(),kt[Oe]=this.grayConfig,ya.localStorage.setItem(this.GRAYKEY,Eo(kt)),gr.next=17;break;case 16:this.logger.debug("uploadFile:: result grayConfig:",nr.content);case 17:if(!(!((Ie=this.grayConfig)===null||Ie===void 0)&&Ie.mixStoreEnable)){gr.next=20;break}return gr.next=20,this._getMixStorePolicy(Oe);case 20:case"end":return gr.stop()}},At,this)}))},_e._getMixStorePolicy=function(Oe){return Hr(this,void 0,void 0,wr.mark(function Ie(){var At,nr,kt,ur,gr,Ar,Rr;return wr.wrap(function(Dr){for(;;)switch(Dr.prev=Dr.next){case 0:if(At=new Date().getTime(),ya.localStorage)try{this.mixStorePolicy=JSON.parse(ya.localStorage.getItem(this.MIXSTOREKEY))[Oe],this.curProvider=Yo(this.mixStorePolicy.providers[0]),this.mixStorePolicy.timeStamp&&this.mixStorePolicy.timeStamp+1e3*this.mixStorePolicy.ttl>At&&(kt=this.mixStorePolicy.timeStamp+1e3*this.mixStorePolicy.ttl-At,this.core.timerManager.addTimer(Go(nr=this._getMixStorePolicy).call(nr,this,Oe),kt))}catch(Jr){ya.localStorage.getItem(this.MIXSTOREKEY)&&JSON.parse(ya.localStorage.getItem(this.MIXSTOREKEY))[Oe]&&this.core.logger.error("uploadFile:: JSON.parse mixStorePolicy error ",Jr)}if(this.mixStorePolicy&&!(this.mixStorePolicy.timeStamp+1e3*this.mixStorePolicy.ttl<=At)){Dr.next=30;break}return Dr.prev=3,Dr.next=6,this.core.sendCmd("getMixStorePolicy",{supportType:this.s3?[1,2]:[1]});case 6:gr=Dr.sent,Ar=gr.content.mixStorePolicyTag,this.mixStorePolicy={providers:[],timeStamp:0,ttl:0,s3Policy:null,nosPolicy:null},this.mixStorePolicy.ttl=Number(Ar.ttl),this.mixStorePolicy.providers=Ar.providers.split(","),this.circuitTimer&&this.core.timerManager.deleteTimer(this.circuitTimer),this.curProvider=Yo(this.mixStorePolicy.providers[0]),this.mixStorePolicy.nosPolicy=Ar.nosPolicy?JSON.parse(Ar.nosPolicy):null,this.mixStorePolicy.s3Policy=Ar.s3Policy?JSON.parse(Ar.s3Policy):null,this.mixStorePolicy.s3Policy===null?this.mixStorePolicy.providers=["1"]:this.mixStorePolicy.nosPolicy===null?this.mixStorePolicy.providers=["2"]:this.mixStorePolicy.providers=this.mixStorePolicy.s3Policy.priority<this.mixStorePolicy.nosPolicy.priority?["2","1"]:["1","2"],this.core.timerManager.addTimer(Go(ur=this._getMixStorePolicy).call(ur,this,Oe),1e3*this.mixStorePolicy.ttl),Rr=ya.localStorage.getItem(this.MIXSTOREKEY)?JSON.parse(ya.localStorage.getItem(this.MIXSTOREKEY)):{},this.mixStorePolicy.timeStamp=new Date().getTime(),Rr[Oe]=this.mixStorePolicy,ya.localStorage.setItem(this.MIXSTOREKEY,Eo(Rr)),Dr.next=30;break;case 23:if(Dr.prev=23,Dr.t0=Dr.catch(3),this.logger.error("getMixStorePolicy error",Dr.t0),this.mixStoreErrorCount!==0){Dr.next=28;break}throw new Error("getMixStorePolicy all count error");case 28:this._getMixStorePolicy(Oe),this.mixStoreErrorCount--;case 30:this.mixStorePolicy.nosPolicy&&(this.nosErrorCount=this.mixStorePolicy.nosPolicy.uploadConfig.retryPolicy.retry);case 31:case"end":return Dr.stop()}},Ie,this,[[3,23]])}))},_e.s3Upload=function(Oe,Ie){return Hr(this,void 0,void 0,wr.mark(function At(){var nr,kt,ur,gr,Ar,Rr,Ur,Dr,Jr,Cn,Sn=this;return wr.wrap(function(Rn){for(;;)switch(Rn.prev=Rn.next){case 0:if(!Oe.file){Rn.next=4;break}nr=Oe.file,Rn.next=19;break;case 4:if(typeof Oe.fileInput!="string"){Rn.next=14;break}if(this.logger.warn("fileInput will abandon,Please use file or filepath"),!((kt=document.getElementById(Oe.fileInput))&&kt.files&&kt.files[0])){Rn.next=11;break}nr=kt.files[0],Rn.next=12;break;case 11:throw new Error("Can not get file from fileInput");case 12:Rn.next=19;break;case 14:if(!(Oe.fileInput&&Oe.fileInput.files&&Oe.fileInput.files[0])){Rn.next=18;break}nr=Oe.fileInput.files[0],Rn.next=19;break;case 18:throw new Error("Can not get file from fileInput "+Oe.fileInput);case 19:if(this.mixStorePolicy.s3Policy){Rn.next=21;break}throw new Error("dont get s3 policy");case 21:return ur={accessKeyId:Ie.accessKeyId,secretAccessKey:Ie.secretAccessKey,sessionToken:Ie.sessionToken,region:Ie.region,maxRetries:this.mixStorePolicy.s3Policy.uploadConfig.retryPolicy.retry},gr=this.s3,(Ar=new gr).config.update(ur),Rr=decodeURIComponent(Ie.bucket),Ur=decodeURIComponent(Ie.objectName),Jr={Bucket:Rr,Key:Ur,Body:Dr=nr,Metadata:{token:Ie.token},ContentType:Dr.type||"application/octet-stream"},this.core.logger.debug("uploadFile:: s3 upload params:",Jr),Cn=Ar.upload(Jr),Rn.abrupt("return",new wo(function(Wn){var Fn=new Date().getTime();Cn.send(function(mo,ao){var ea,oo;if(mo){Sn.logger.error("uploadFile:","api::s3:upload file failed",mo),Sn.core.reporter.reportTraceStart("exceptions",{user_id:Sn.core.options.account,trace_id:(oo=(ea=Sn.core)===null||ea===void 0?void 0:ea.socket)===null||oo===void 0?void 0:oo.sessionId,start_time:Fn,action:1}),Sn.core.reporter.reportTraceUpdateV2("exceptions",{code:typeof mo.status=="number"?mo.status:typeof mo.code=="number"?mo.code:0,description:mo.message||""+mo.code,operation_type:1,target:mo.hostname}),Sn.core.reporter.reportTraceEnd("exceptions",1);try{Sn._addCircuitTimer()}catch(Gn){throw new Vc("upload file error",Gn,Sn.curProvider,Sn.mixStorePolicy,Oe.file||Oe.filePath)}Wn(Sn.uploadFile(Oe))}else{var Wr=Sn.mixStorePolicy.s3Policy.cdnSchema;Wr=(Wr=Wr.replace("{cdnDomain}",Sn.mixStorePolicy.s3Policy.dlcdn)).replace("{objectName}",ao.Key),Wn({size:Dr.size,name:Dr.name,url:Ie.shortUrl?Ie.shortUrl:Wr,ext:Dr.name.split(".")[1]||"unknown"})}})}));case 32:case"end":return Rn.stop()}},At,this)}))},_e.getPrivateUrl=function(Oe){var Ie;if(!new RegExp(/http(s)?:\/\/([\w-]+\.)+[\w-]+(\/[\w- ./?%&=]*)?/).test(Oe))return this.logger.error("illegal file url:"+Oe),"";var At=/^(?:([A-Za-z]+):)?(\/{0,3})([0-9.\-A-Za-z]+)(?::(\d+))?(?:\/([^?#]*))?(?:\?([^#]*))?(?:#(.*))?$/.exec(Oe);At[0];var nr=At[1];At[2];var kt=At[3];At[4];var ur=At[5];if(At[6],At[7],(Ie=this.grayConfig)===null||Ie===void 0?void 0:Ie.mixStoreEnable){var gr=this._getUrlType(Oe);return gr===fi.s3&&this.mixStorePolicy.s3Policy&&(Oe=this.mixStorePolicy.s3Policy.cdnSchema.replace("{cdnDomain}",this.mixStorePolicy.s3Policy.dlcdn).replace("{objectName}",ur)),gr===fi.nos&&this.mixStorePolicy.nosPolicy&&(Oe=this.mixStorePolicy.nosPolicy.cdnSchema.replace("{cdnDomain}",this.mixStorePolicy.nosPolicy.dlcdn).replace("{objectName}",ur)),Oe}var Ar=this.config,Rr=Ar.downloadUrl,Ur=Ar.downloadHostList,Dr=Ar.nosCdnEnable,Jr=this.config.cdn.cdnDomain,Cn=this.config.cdn.objectNamePrefix?decodeURIComponent(this.config.cdn.objectNamePrefix):"",Sn=decodeURIComponent(ur),$n=Na(Sn).call(Sn,Cn);if(Jr&&$n>-1&&Dr)return""+nr+Jr+"/"+Fo(Sn).call(Sn,$n);if(Li(Ur).call(Ur,kt)&&Li(ur).call(ur,"/")){var Rn=Na(ur).call(ur,"/"),Wn=ur.substring(0,Rn),Fn=ur.substring(Rn+1);return Rr.replace("{bucket}",Wn).replace("{object}",Fn)}var mo=bi(Ur).call(Ur,function(ea){return typeof kt=="string"&&Li(kt).call(kt,ea)})[0],ao=mo?kt.replace(mo,"").replace(/\W/g,""):null;return ao?Rr.replace("{bucket}",ao).replace("{object}",ur):Oe},_e.getOriginUrl=function(Oe){return Hr(this,void 0,void 0,wr.mark(function Ie(){var At;return wr.wrap(function(kt){for(;;)switch(kt.prev=kt.next){case 0:return kt.next=2,this.core.sendCmd("getOriginUrl",{nosSafeUrlTag:{safeUrl:Oe}});case 2:return At=kt.sent,kt.abrupt("return",At.content.nosSafeUrlTag.originUrl);case 4:case"end":return kt.stop()}},Ie,this)}))},_e.getFileToken=function(Oe){return Hr(this,void 0,void 0,wr.mark(function Ie(){var At,nr,kt,ur,gr,Ar=this;return wr.wrap(function(Ur){for(;;)switch(Ur.prev=Ur.next){case 0:if(On({type:{type:"number",min:2,max:3},urls:{type:"array",required:!1,itemType:"string"}},Oe),At=this.mixStorePolicy.nosPolicy?this.mixStorePolicy.nosPolicy.authPolicy.policyType:null,nr=this.mixStorePolicy.s3Policy?this.mixStorePolicy.s3Policy.authPolicy.policyType:null,At!==String(nc.dontNeed)||nr!==String(nc.dontNeed)){Ur.next=8;break}throw this.logger.error("don't need token"),new Error("don't need token");case 8:if(Oe.type!==nc.time){Ur.next=17;break}if(!(At&&Na(At).call(At,String(nc.time))>=0||nr&&Na(nr).call(nr,String(nc.time))>0)){Ur.next=13;break}return Ur.abrupt("return",this.getFileAuthToken(Oe));case 13:throw this.logger.error("don't support time token "),new Error("don't support type time token ");case 15:Ur.next=33;break;case 17:if(Oe.urls&&Oe.urls.length){Ur.next=20;break}throw this.logger.error("urls is required when urls token"),new Error("urls is required when urls token");case 20:if(ur=[],gr=[],Kn(kt=Oe.urls).call(kt,function(Dr){var Jr=Ar._getUrlType(Dr);Jr===fi.nos&&gr.push(Dr),Jr===fi.s3&&ur.push(Dr)}),(!nr||ur.length!==0&&Na(nr).call(nr,String(nc.urls))<0)&&(this.logger.warn("s3 url don't support url token"),ur=[]),(!At||gr.length!==0&&Na(At).call(At,String(nc.urls))<0)&&(this.logger.warn("nos url don't support url token"),gr=[]),ur.length!==0||gr.length!==0){Ur.next=30;break}throw this.logger.error("not support urls"),new Error("not support urls");case 30:if(ur.length!==0&&gr.length!==0){Ur.next=33;break}return Oe.urls=Eo(Oe.urls),Ur.abrupt("return",this.getFileAuthToken(Oe));case 33:case"end":return Ur.stop()}},Ie,this)}))},_e.getFileAuthToken=function(Oe){return Hr(this,void 0,void 0,wr.mark(function Ie(){var At;return wr.wrap(function(kt){for(;;)switch(kt.prev=kt.next){case 0:return kt.next=2,this.core.sendCmd("getFileAuthToken",{mixStoreAuthTokenReqTag:Oe});case 2:return At=kt.sent,kt.abrupt("return",At.content.mixStoreAuthTokenResTag);case 4:case"end":return kt.stop()}},Ie,this)}))},_e._getUrlType=function(Oe){var Ie,At;return this.mixStorePolicy.nosPolicy&&nf(Ie=this.mixStorePolicy.nosPolicy.dlcdns).call(Ie,function(nr){return Na(Oe).call(Oe,nr)>=0})?fi.nos:this.mixStorePolicy.s3Policy&&nf(At=this.mixStorePolicy.s3Policy.dlcdns).call(At,function(nr){return Na(Oe).call(Oe,nr)>=0})?fi.s3:null},_e._addCircuitTimer=function(){var Oe=this,Ie=this.mixStorePolicy.providers,At=Ie[(Na(Ie).call(Ie,String(this.curProvider))+1)%Ie.length];if(At===Ie[0])throw new Error("uploadFile all policy fail");var nr=ms(this.mixStorePolicy,"s3Policy.uploadConfig.retryPolicy");if(nr&&nr.retryNext&&At&&(this.logger.log("uploadFile:: upload policy will change,now policy:"+this.curProvider+" nextProvider:"+At),this.curProvider=Yo(At),this.mixStorePolicy.nosPolicy&&this.mixStorePolicy.s3Policy)){var kt=this.mixStorePolicy[this.curProvider===fi.nos?"nosPolicy":"s3Policy"].uploadConfig.retryPolicy.circuit;if(!kt||kt===0)return;this.circuitTimer=this.core.timerManager.addTimer(function(){Oe.logger.log("uploadFile:: upload policy will change,now policy:"+Oe.curProvider+" nextProvider:"+Yo(Oe.mixStorePolicy.providers[0])),Oe.curProvider=Yo(Oe.mixStorePolicy.providers[0]),Oe.core.timerManager.deleteTimer(Oe.circuitTimer)},1e3*kt)}},_e.process=function(Oe){var Ie=this[Oe.cmd+"Handler"];return typeof Ie=="function"?Ie.call(this,Oe):Oe.error&&!Oe.error.ignore?wo.reject(Oe.error):wo.resolve(Oe)},pe}(),Jd=Math.floor,ff=function(pe,_e){var Ve=pe.length,Oe=Jd(Ve/2);return Ve<8?Uy(pe,_e):jS(pe,ff(Du(pe,0,Oe),_e),ff(Du(pe,Oe),_e),_e)},Uy=function(pe,_e){for(var Ve,Oe,Ie=pe.length,At=1;At<Ie;){for(Oe=At,Ve=pe[At];Oe&&_e(pe[Oe-1],Ve)>0;)pe[Oe]=pe[--Oe];Oe!==At++&&(pe[Oe]=Ve)}return pe},jS=function(pe,_e,Ve,Oe){for(var Ie=_e.length,At=Ve.length,nr=0,kt=0;nr<Ie||kt<At;)pe[nr+kt]=nr<Ie&&kt<At?Oe(_e[nr],Ve[kt])<=0?_e[nr++]:Ve[kt++]:nr<Ie?_e[nr++]:Ve[kt++];return pe},gu=ff,qy=_r.match(/firefox\/(\d+)/i),Ec=!!qy&&+qy[1],xs=/MSIE|Trident/.test(_r),Vy=_r.match(/AppleWebKit\/(\d+)\./),Hy=!!Vy&&+Vy[1],Pc=[],hu=Ne(Pc.sort),DS=Ne(Pc.push),zy=V(function(){Pc.sort(void 0)}),US=V(function(){Pc.sort(null)}),Wy=li("sort"),Hh=!V(function(){if(Br)return Br<70;if(!(Ec&&Ec>3)){if(xs)return!0;if(Hy)return Hy<603;var pe,_e,Ve,Oe,Ie="";for(pe=65;pe<76;pe++){switch(_e=String.fromCharCode(pe),pe){case 66:case 69:case 70:case 72:Ve=3;break;case 68:case 71:Ve=4;break;default:Ve=2}for(Oe=0;Oe<47;Oe++)Pc.push({k:_e+Oe,v:Ve})}for(Pc.sort(function(At,nr){return nr.v-At.v}),Oe=0;Oe<Pc.length;Oe++)_e=Pc[Oe].k.charAt(0),Ie.charAt(Ie.length-1)!==_e&&(Ie+=_e);return Ie!=="DGBEFHACIJK"}});_n({target:"Array",proto:!0,forced:zy||!US||!Wy||!Hh},{sort:function(_e){_e!==void 0&&Xr(_e);var Ve=An(this);if(Hh)return _e===void 0?hu(Ve):hu(Ve,_e);var Oe,Ie,At=[],nr=Ka(Ve);for(Ie=0;Ie<nr;Ie++)Ie in Ve&&DS(At,Ve[Ie]);for(gu(At,function(kt){return function(ur,gr){return gr===void 0?-1:ur===void 0?1:kt!==void 0?+kt(ur,gr)||0:Za(ur)>Za(gr)?1:-1}}(_e)),Oe=Ka(At),Ie=0;Ie<Oe;)Ve[Ie]=At[Ie++];for(;Ie<nr;)Zp(Ve,Ie++);return Ve}});var Yc,Vi,mf,oc=na("Array").sort,Yd=Array.prototype,vu=function(pe){var _e=pe.sort;return pe===Yd||vr(Yd,pe)&&_e===Yd.sort?oc:_e};(function(pe){pe[pe.ASC=1]="ASC",pe[pe.DESC=2]="DESC"})(Yc||(Yc={})),function(pe){pe[pe.reorderWeight=0]="reorderWeight",pe[pe.createTime=1]="createTime",pe[pe.totalMember=2]="totalMember"}(Vi||(Vi={})),function(pe){pe[pe.square=1]="square",pe[pe.person=2]="person"}(mf||(mf={}));var Ll=function(){function pe(_e,Ve){this.name=_e,this.core=Ve,this.name=_e,this.logger=Ve.logger,this.core=Ve}return pe.prototype.process=function(Ve){var Oe=this[Ve.cmd+"Handler"];return typeof Oe=="function"?Oe.call(this,Ve):Ve.error&&!Ve.error.ignore?wo.reject(Ve.error):wo.resolve(Ve)},pe}(),Xd={"24_15":"qchatSubscribe","24_27":"qchatGetUnreadInfo","24_48":"qchatCreateChannel","24_49":"qchatDeleteChannel","24_50":"qchatUpdateChannel","24_51":"qchatGetChannels","24_52":"qchatGetChannelsByPage","24_53":"qchatGetMembersByPage","24_54":"qchatUpdateWhiteBlackRole","24_55":"qchatGetWhiteBlackRolesPage","24_56":"qchatUpdateWhiteBlackMembers","24_57":"qchatGetWhiteBlackMembersPage","24_58":"qchatGetExistingWhiteBlackRoles","24_59":"qchatGetExistingWhiteBlackMembers","24_60":"qchatUpdateCategoryInfoOfChannel","24_109":"qchatCreateChannelCategory","24_110":"qchatRemoveChannelCategory","24_111":"qchatUpdateChannelCategory","24_112":"qchatGetChannelCategoriesByID","24_113":"qchatUpdateChannelCategoryWhiteBlackRole","24_114":"qchatGetChannelCategoryWhiteBlackRolesPage","24_115":"qchatUpdateChannelCategoryWhiteBlackMembers","24_116":"qchatGetChannelCategoryWhiteBlackMembersPage","24_117":"qchatGetChannelCategoryWhiteBlackRoles","24_118":"qchatGetChannelCategoryWhiteBlackMembers","24_119":"qchatGetChannelCategoriesPage","24_120":"qchatGetChannelCategoryChannelsPage","24_93":"qchatGetChannelSearchByPage","24_95":"qchatChannelMemberSearch","25_8":"qchatGetRoleIdsByServerId","25_9":"qchatSubscribeAsVisitor"},zh={serverId:1,channelId:2,ackTimestamp:3,unreadCount:4,mentionedCount:5,maxCount:6,lastMsgTime:7},ma={channelInfo:{channelId:1,serverId:2,name:4,topic:5,ext:6,type:7,validFlag:8,createTime:9,updateTime:10,owner:11,viewMode:12,categoryId:13,syncMode:14,reorderWeight:15,visitorMode:16},antispamTag:{antiSpamBusinessId:1},memberInfo:{serverId:1,accid:3,nick:4,avatar:5,ext:6,type:7,joinTime:8,inviter:9,validFlag:10,createTime:11,updateTime:12},serverRole:{serverId:1,roleId:2,name:3,icon:4,ext:5,auths:6,type:7,memberCount:8,priority:9,createTime:10,updateTime:11},qchatSubReqTag:{type:1,opeType:2},qchatChannelIdInfoTag:{serverId:1,channelId:2},unreadInfo:zh,qchatGetChannelListPageTag:{serverId:1,timetag:2,limit:3},qchatGetMembersByPageTag:{serverId:1,channelId:2,timetag:3,limit:4},qchatUpdateWhiteBlackRoleTag:{serverId:1,channelId:2,type:3,opeType:4,roleId:5},qchatGetWhiteBlackRolesPageTag:{serverId:1,channelId:2,type:3,timetag:4,limit:5},qchatUpdateWhiteBlackMembersTag:{serverId:1,channelId:2,type:3,opeType:4,toAccids:5},qchatGetWhiteBlackMembersPageTag:{serverId:1,channelId:2,type:3,timetag:4,limit:5},qchatGetExistingWhiteBlackRolesTag:{serverId:1,channelId:2,type:3,roleIds:4},qchatGetExistingWhiteBlackMembersTag:{serverId:1,channelId:2,type:3,accids:4},QChatChannelCategoryInfo:{categoryId:1,serverId:2,name:4,ext:5,owner:6,viewMode:7,validFlag:8,createTime:9,updateTime:10,channelNumber:11},qchatUpdateChannelCategoryWhiteBlackRoleTag:{serverId:1,categoryId:2,type:3,opeType:4,roleId:5},qchatGetChannelCategoryWhiteBlackRolesPageTag:{serverId:1,categoryId:2,type:3,timetag:4,limit:5},qchatUpdateChannelCategoryWhiteBlackMembersTag:{serverId:1,categoryId:2,type:3,opeType:4,toAccids:5},qchatGetChannelCategoryWhiteBlackMembersPageTag:{serverId:1,categoryId:2,type:3,timetag:4,limit:5},qchatGetChannelCategoryWhiteBlackRolesTag:{serverId:1,categoryId:2,type:3,roleIds:4},qchatGetChannelCategoryWhiteBlackMembersTag:{serverId:1,categoryId:2,type:3,accids:4},qchatGetChannelCategoriesPageTag:{serverId:1,timetag:2,limit:3},qchatGetChannelCategoryChannelsPageTag:{serverId:1,categoryId:2,timetag:3,limit:4},qchatGetChannelSearchByPageTag:{keyword:1,startTime:2,endTime:3,order:4,limit:5,serverId:6,sort:7,cursor:8},qchatUpdateChannelTag:{channelId:1,name:4,topic:5,ext:6,viewMode:12,visitorMode:16},serverRoles:{serverId:1,roleIds:2,timeTag:3},qchatChannelMemberSearchTag:{serverId:1,channelId:2,keyword:3,limit:4},qchatChannelMemberInfo:{serverId:1,channelId:2,avatar:3,accid:4,nick:5,createTime:6,updateTime:7}},ia=zc(ma),Wh={qchatCreateChannel:{sid:24,cid:48,service:"qchatChannel",params:[{type:"Property",name:"channelInfo",reflectMapper:ma.channelInfo},{type:"Property",name:"antispamTag",reflectMapper:ma.antispamTag}],response:[{type:"Property",name:"channelInfo",reflectMapper:ia.channelInfo}]},qchatDeleteChannel:{sid:24,cid:49,service:"qchatChannel",params:[{type:"Long",name:"channelId"}]},qchatUpdateChannel:{sid:24,cid:50,service:"qchatChannel",params:[{type:"Property",name:"channelInfo",reflectMapper:ma.qchatUpdateChannelTag},{type:"Property",name:"antispamTag",reflectMapper:ma.antispamTag}],response:[{type:"Property",name:"channelInfo",reflectMapper:ia.channelInfo}]},qchatGetChannels:{sid:24,cid:51,service:"qchatChannel",params:[{type:"LongArray",name:"channelIds"}],response:[{type:"PropertyArray",name:"channelList",reflectMapper:ia.channelInfo}]},qchatGetChannelsByPage:{sid:24,cid:52,service:"qchatChannel",params:[{type:"Property",name:"qchatGetChannelListPageTag",reflectMapper:ma.qchatGetChannelListPageTag}],response:[{type:"Property",name:"listQueryTag",reflectMapper:{1:"hasMore",2:"nextTimetag"}},{type:"PropertyArray",name:"datas",reflectMapper:ia.channelInfo}]},qchatGetMembersByPage:{sid:24,cid:53,service:"qchatChannel",params:[{type:"Property",name:"qchatGetMembersByPageTag",reflectMapper:ma.qchatGetMembersByPageTag}],response:[{type:"Property",name:"listQueryTag",reflectMapper:{1:"hasMore",2:"nextTimetag"}},{type:"PropertyArray",name:"datas",reflectMapper:ia.memberInfo}]},qchatUpdateWhiteBlackRole:{sid:24,cid:54,service:"qchatChannel",params:[{type:"Property",name:"qchatUpdateWhiteBlackRoleTag",reflectMapper:ma.qchatUpdateWhiteBlackRoleTag}],response:[{type:"Property",name:"listQueryTag",reflectMapper:{1:"hasMore",2:"nextTimetag"}},{type:"PropertyArray",name:"datas",reflectMapper:ia.memberInfo}]},qchatGetWhiteBlackRolesPage:{sid:24,cid:55,service:"qchatChannel",params:[{type:"Property",name:"qchatGetWhiteBlackRolesPageTag",reflectMapper:ma.qchatGetWhiteBlackRolesPageTag}],response:[{type:"Property",name:"listQueryTag",reflectMapper:{1:"hasMore",2:"nextTimetag"}},{type:"PropertyArray",name:"datas",reflectMapper:ia.serverRole}]},qchatUpdateWhiteBlackMembers:{sid:24,cid:56,service:"qchatChannel",params:[{type:"Property",name:"qchatUpdateWhiteBlackMembersTag",reflectMapper:ma.qchatUpdateWhiteBlackMembersTag}]},qchatGetWhiteBlackMembersPage:{sid:24,cid:57,service:"qchatChannel",params:[{type:"Property",name:"qchatGetWhiteBlackMembersPageTag",reflectMapper:ma.qchatGetWhiteBlackMembersPageTag}],response:[{type:"Property",name:"listQueryTag",reflectMapper:{1:"hasMore",2:"nextTimetag"}},{type:"PropertyArray",name:"datas",reflectMapper:ia.memberInfo}]},qchatGetExistingWhiteBlackRoles:{sid:24,cid:58,service:"qchatChannel",params:[{type:"Property",name:"qchatGetExistingWhiteBlackRolesTag",reflectMapper:ma.qchatGetExistingWhiteBlackRolesTag}],response:[{type:"PropertyArray",name:"datas",reflectMapper:ia.serverRole}]},qchatGetExistingWhiteBlackMembers:{sid:24,cid:59,service:"qchatChannel",params:[{type:"Property",name:"qchatGetExistingWhiteBlackMembersTag",reflectMapper:ma.qchatGetExistingWhiteBlackMembersTag}],response:[{type:"PropertyArray",name:"datas",reflectMapper:ia.memberInfo}]},qchatUpdateCategoryInfoOfChannel:{sid:24,cid:60,service:"qchatChannel",params:[{type:"Property",name:"qchatUpdateCategoryInfoOfChannelTag",reflectMapper:ma.channelInfo}],response:[{type:"Property",name:"channelInfo",reflectMapper:ia.channelInfo}]},qchatCreateChannelCategory:{sid:24,cid:109,service:"qchatChannel",params:[{type:"Property",name:"qchatCreateChannelCategoryTag",reflectMapper:ma.QChatChannelCategoryInfo}],response:[{type:"Property",name:"QChatChannelCategoryInfo",reflectMapper:ia.QChatChannelCategoryInfo}]},qchatRemoveChannelCategory:{sid:24,cid:110,service:"qchatChannel",params:[{type:"Long",name:"categoryId"}]},qchatUpdateChannelCategory:{sid:24,cid:111,service:"qchatChannel",params:[{type:"Property",name:"qchatUpdateChannelCategoryTag",reflectMapper:ma.QChatChannelCategoryInfo}],response:[{type:"Property",name:"QChatChannelCategoryInfo",reflectMapper:ia.QChatChannelCategoryInfo}]},qchatGetChannelCategoriesByID:{sid:24,cid:112,service:"qchatChannel",params:[{type:"LongArray",name:"categoryIds"}],response:[{type:"PropertyArray",name:"channelCategoryList",reflectMapper:ia.QChatChannelCategoryInfo}]},qchatUpdateChannelCategoryWhiteBlackRole:{sid:24,cid:113,service:"qchatChannel",params:[{type:"Property",name:"qchatUpdateChannelCategoryWhiteBlackRoleTag",reflectMapper:ma.qchatUpdateChannelCategoryWhiteBlackRoleTag}]},qchatGetChannelCategoryWhiteBlackRolesPage:{sid:24,cid:114,service:"qchatChannel",params:[{type:"Property",name:"qchatGetChannelCategoryWhiteBlackRolesPageTag",reflectMapper:ma.qchatGetChannelCategoryWhiteBlackRolesPageTag}],response:[{type:"Property",name:"listQueryTag",reflectMapper:{1:"hasMore",2:"nextTimetag"}},{type:"PropertyArray",name:"datas",reflectMapper:ia.serverRole}]},qchatUpdateChannelCategoryWhiteBlackMembers:{sid:24,cid:115,service:"qchatChannel",params:[{type:"Property",name:"qchatUpdateChannelCategoryWhiteBlackMembersTag",reflectMapper:ma.qchatUpdateChannelCategoryWhiteBlackMembersTag}]},qchatGetChannelCategoryWhiteBlackMembersPage:{sid:24,cid:116,service:"qchatChannel",params:[{type:"Property",name:"qchatGetChannelCategoryWhiteBlackMembersPageTag",reflectMapper:ma.qchatGetChannelCategoryWhiteBlackMembersPageTag}],response:[{type:"Property",name:"listQueryTag",reflectMapper:{1:"hasMore",2:"nextTimetag"}},{type:"PropertyArray",name:"datas",reflectMapper:ia.memberInfo}]},qchatGetChannelCategoryWhiteBlackRoles:{sid:24,cid:117,service:"qchatChannel",params:[{type:"Property",name:"qchatGetChannelCategoryWhiteBlackRolesTag",reflectMapper:ma.qchatGetChannelCategoryWhiteBlackRolesTag}],response:[{type:"PropertyArray",name:"datas",reflectMapper:ia.serverRole}]},qchatGetChannelCategoryWhiteBlackMembers:{sid:24,cid:118,service:"qchatChannel",params:[{type:"Property",name:"qchatGetChannelCategoryWhiteBlackMembersTag",reflectMapper:ma.qchatGetChannelCategoryWhiteBlackMembersTag}],response:[{type:"PropertyArray",name:"datas",reflectMapper:ia.memberInfo}]},qchatGetChannelCategoriesPage:{sid:24,cid:119,service:"qchatChannel",params:[{type:"Property",name:"qchatGetChannelCategoriesPageTag",reflectMapper:ma.qchatGetChannelCategoriesPageTag}],response:[{type:"Property",name:"listQueryTag",reflectMapper:{1:"hasMore",2:"nextTimetag"}},{type:"PropertyArray",name:"datas",reflectMapper:ia.QChatChannelCategoryInfo}]},qchatGetChannelCategoryChannelsPage:{sid:24,cid:120,service:"qchatChannel",params:[{type:"Property",name:"qchatGetChannelCategoryChannelsPageTag",reflectMapper:ma.qchatGetChannelCategoryChannelsPageTag}],response:[{type:"Property",name:"listQueryTag",reflectMapper:{1:"hasMore",2:"nextTimetag"}},{type:"PropertyArray",name:"datas",reflectMapper:ia.channelInfo}]},qchatSubscribe:{sid:24,cid:15,service:"qchatChannel",params:[{type:"Property",name:"qchatSubReqTag",reflectMapper:ma.qchatSubReqTag},{type:"PropertyArray",name:"channels",reflectMapper:ma.qchatChannelIdInfoTag}],response:[{type:"PropertyArray",name:"unreadInfos",reflectMapper:ia.unreadInfo},{type:"PropertyArray",name:"failedChannels",reflectMapper:ia.qchatChannelIdInfoTag}]},qchatGetUnreadInfo:{sid:24,cid:27,service:"qchatChannel",params:[{type:"PropertyArray",name:"channels",reflectMapper:ma.qchatChannelIdInfoTag}],response:[{type:"PropertyArray",name:"unreadInfos",reflectMapper:ia.unreadInfo}]},qchatGetChannelSearchByPage:{sid:24,cid:93,service:"qchatChannel",params:[{type:"Property",name:"qchatGetChannelSearchByPageTag",reflectMapper:ma.qchatGetChannelSearchByPageTag}],response:[{type:"Property",name:"listQueryTag",reflectMapper:{1:"hasMore",2:"nextTimetag",3:"cursor"}},{type:"PropertyArray",name:"datas",reflectMapper:ia.channelInfo}]},qchatGetRoleIdsByServerId:{sid:25,cid:8,service:"qchatChannel",params:[{type:"Property",name:"qchatGetRoleIdsByServerIdTag",reflectMapper:{serverIdTimeTags:1}}],response:[{type:"PropertyArray",name:"serverRoles",reflectMapper:ia.serverRoles},{type:"LongArray",name:"failServerIds"}]},qchatChannelMemberSearch:{sid:24,cid:95,service:"qchatChannel",params:[{type:"Property",name:"qchatChannelMemberSearchTag",reflectMapper:ma.qchatChannelMemberSearchTag}],response:[{type:"PropertyArray",name:"datas",reflectMapper:ia.qchatChannelMemberInfo}]},qchatSubscribeAsVisitor:{sid:25,cid:9,service:"qchatChannel",params:[{type:"Property",name:"tag",reflectMapper:ma.qchatSubReqTag},{type:"PropertyArray",name:"datas",reflectMapper:ma.qchatChannelIdInfoTag}],response:[{type:"PropertyArray",name:"failedArr",reflectMapper:ia.qchatChannelIdInfoTag}]}},Gy={"24_31":"qchatCreateServer","24_32":"qchatDeleteServer","24_33":"qchatUpdateServer","24_34":"qchatGetServers","24_35":"qchatGetServersByPage","24_36":"qchatInviteServerMembers","24_37":"qchatAcceptServerInvite","24_38":"qchatRejectInviteServer","24_39":"qchatApplyServerJoin","24_40":"qchatAcceptServerApply","24_41":"qchatRejectServerApply","24_42":"qchatKickServerMembers","24_43":"qchatLeaveServer","24_44":"qchatUpdateMyMemberInfo","24_45":"qchatUpdateServerMemberInfo","24_46":"qchatGetServerMembers","24_47":"qchatGetServerMembersByPage","24_104":"qchatUpdateServerMemberBan","24_105":"qchatGetBannedMembersByPage","24_91":"qchatServerSearchByPage","24_92":"qchatServerMemberSearchByPage","24_122":"qchatGenerateInviteCode","24_123":"qchatJoinByInviteCode","24_124":"qchatGetInviteApplyRecordOfServer","24_125":"qchatGetInviteApplyRecordOfSelf","25_5":"qchatClearServersUnread","25_7":"qchatSubscribeChannelsByServers","25_10":"qchatEnterAsVisitor","25_11":"qchatLeaveAsVisitor"},ds={serverInfo:{serverId:1,name:3,icon:4,ext:5,owner:6,memberNumber:7,inviteMode:8,applyMode:9,validFlag:10,createTime:11,updateTime:12,channelNumber:13,categoryNumber:14,searchType:15,searchEnable:16,reorderWeight:17},antispamTag:{antiSpamBusinessId:1},memberInfo:{serverId:1,accid:3,nick:4,avatar:5,ext:6,type:7,joinTime:8,inviter:9,validFlag:10,createTime:11,updateTime:12},otherMemberInfo:{serverId:1,accid:3,nick:4,avatar:5,type:7,joinTime:8,inviter:9,validFlag:10,createTime:11,updateTime:12},getServerListPageTag:{timestamp:1,limit:2},getServerMemberListPageTag:{serverId:1,timetag:2,limit:3},updateServerMemberBanTag:{serverId:1,opeType:2,accid:3,ext:4},getBannedMembersByPageTag:{serverId:1,timetag:2,limit:3},serverMemberBanInfo:{serverId:1,appid:2,accid:3,ext:4,banTime:5,validFlag:6,createTime:7,updateTime:8},serverSearchByPageTag:{keyword:1,startTime:2,endTime:3,order:4,limit:5,serverType:6,searchType:7,sort:8,cursor:9},serverMemberSearchByPageTag:{serverId:1,keyword:3,limit:4},inviteRespParamTag:{requestId:1},applyRespParamTag:{requestId:1,expireTime:2},inviteApplyRecord:{accid:1,type:2,serverId:3,status:4,requestId:5,createTime:6,updateTime:7,expireTime:8,data:9,recordId:10},clearServersUnreadTag:{successServerIds:1,failServerIds:2,ackTimestamp:3},unreadInfo:zh},os=zc(ds),Xc={qchatCreateServer:{sid:24,cid:31,service:"qchatServer",params:[{type:"Property",name:"serverInfo",reflectMapper:ds.serverInfo},{type:"Property",name:"antispamTag",reflectMapper:ds.antispamTag}],response:[{type:"Property",name:"serverInfo",reflectMapper:os.serverInfo}]},qchatDeleteServer:{sid:24,cid:32,service:"qchatServer",params:[{type:"Long",name:"serverId"}]},qchatUpdateServer:{sid:24,cid:33,service:"qchatServer",params:[{type:"Property",name:"serverInfo",reflectMapper:ds.serverInfo},{type:"Property",name:"antispamTag",reflectMapper:ds.antispamTag}],response:[{type:"Property",name:"serverInfo",reflectMapper:os.serverInfo}]},qchatGetServers:{sid:24,cid:34,service:"qchatServer",params:[{type:"LongArray",name:"serverIds"}],response:[{type:"PropertyArray",name:"serverList",reflectMapper:os.serverInfo}]},qchatGetServersByPage:{sid:24,cid:35,service:"qchatServer",params:[{type:"Property",name:"tag",reflectMapper:ds.getServerListPageTag}],response:[{type:"Property",name:"listQueryTag",reflectMapper:{1:"hasMore",2:"nextTimetag"}},{type:"PropertyArray",name:"datas",reflectMapper:os.serverInfo}]},qchatInviteServerMembers:{sid:24,cid:36,service:"qchatServer",params:[{type:"Long",name:"serverId"},{type:"StrArray",name:"accids"},{type:"String",name:"ps"},{type:"Property",name:"params",reflectMapper:{ttl:1}}],response:[{type:"StrArray",name:"failByOverAccids"},{type:"StrArray",name:"failByBanAccids"},{type:"Property",name:"record",reflectMapper:os.applyRespParamTag}]},qchatAcceptServerInvite:{sid:24,cid:37,service:"qchatServer",params:[{type:"Long",name:"serverId"},{type:"String",name:"accid"},{type:"Property",name:"recordInfo",reflectMapper:ds.inviteRespParamTag}]},qchatRejectInviteServer:{sid:24,cid:38,service:"qchatServer",params:[{type:"Long",name:"serverId"},{type:"String",name:"accid"},{type:"String",name:"ps"},{type:"Property",name:"recordInfo",reflectMapper:ds.inviteRespParamTag}]},qchatApplyServerJoin:{sid:24,cid:39,service:"qchatServer",params:[{type:"Long",name:"serverId"},{type:"String",name:"ps"},{type:"Property",name:"params",reflectMapper:{ttl:1}}],response:[{type:"Property",name:"data",reflectMapper:os.applyRespParamTag}]},qchatAcceptServerApply:{sid:24,cid:40,service:"qchatServer",params:[{type:"Long",name:"serverId"},{type:"String",name:"accid"},{type:"Property",name:"recordInfo",reflectMapper:ds.applyRespParamTag}]},qchatRejectServerApply:{sid:24,cid:41,service:"qchatServer",params:[{type:"Long",name:"serverId"},{type:"String",name:"accid"},{type:"String",name:"ps"},{type:"Property",name:"recordInfo",reflectMapper:ds.applyRespParamTag}]},qchatKickServerMembers:{sid:24,cid:42,service:"qchatServer",params:[{type:"Long",name:"serverId"},{type:"StrArray",name:"accids"}]},qchatLeaveServer:{sid:24,cid:43,service:"qchatServer",params:[{type:"Long",name:"serverId"}]},qchatUpdateMyMemberInfo:{sid:24,cid:44,service:"qchatServer",params:[{type:"Property",name:"memberInfo",reflectMapper:ds.memberInfo},{type:"Property",name:"antispamTag",reflectMapper:ds.antispamTag}],response:[{type:"Property",name:"memberInfo",reflectMapper:os.memberInfo}]},qchatUpdateServerMemberInfo:{sid:24,cid:45,service:"qchatServer",params:[{type:"Property",name:"memberInfo",reflectMapper:ds.otherMemberInfo},{type:"Property",name:"antispamTag",reflectMapper:ds.antispamTag}],response:[{type:"Property",name:"memberInfo",reflectMapper:os.memberInfo}]},qchatGetServerMembers:{sid:24,cid:46,service:"qchatServer",params:[{type:"StrArray",name:"accids"}],response:[{type:"PropertyArray",name:"accidList",reflectMapper:os.memberInfo}]},qchatGetServerMembersByPage:{sid:24,cid:47,service:"qchatServer",params:[{type:"Property",name:"tag",reflectMapper:ds.getServerMemberListPageTag}],response:[{type:"Property",name:"listQueryTag",reflectMapper:{1:"hasMore",2:"nextTimetag"}},{type:"PropertyArray",name:"datas",reflectMapper:os.memberInfo}]},qchatUpdateServerMemberBan:{sid:24,cid:104,service:"qchatServer",params:[{type:"Property",name:"tag",reflectMapper:ds.updateServerMemberBanTag}]},qchatGetBannedMembersByPage:{sid:24,cid:105,service:"qchatServer",params:[{type:"Property",name:"tag",reflectMapper:ds.getBannedMembersByPageTag}],response:[{type:"Property",name:"listQueryTag",reflectMapper:{1:"hasMore",2:"nextTimetag"}},{type:"PropertyArray",name:"datas",reflectMapper:os.serverMemberBanInfo}]},qchatServerSearchByPage:{sid:24,cid:91,service:"qchatServer",params:[{type:"Property",name:"tag",reflectMapper:ds.serverSearchByPageTag}],response:[{type:"Property",name:"listQueryTag",reflectMapper:{1:"hasMore",2:"nextTimetag",3:"cursor"}},{type:"PropertyArray",name:"datas",reflectMapper:os.serverInfo}]},qchatServerMemberSearchByPage:{sid:24,cid:92,service:"qchatServer",params:[{type:"Property",name:"tag",reflectMapper:ds.serverMemberSearchByPageTag}],response:[{type:"PropertyArray",name:"members",reflectMapper:os.serverMemberBanInfo}]},qchatGenerateInviteCode:{sid:24,cid:122,service:"qchatServer",params:[{type:"Property",name:"tag",reflectMapper:{serverId:1,ttl:2}}],response:[{type:"Property",name:"data",reflectMapper:{1:"serverId",2:"requestId",3:"inviteCode",4:"expireTime"}}]},qchatJoinByInviteCode:{sid:24,cid:123,service:"qchatServer",params:[{type:"Property",name:"tag",reflectMapper:{serverId:1,inviteCode:2,ps:3}}]},qchatGetInviteApplyRecordOfServer:{sid:24,cid:124,service:"qchatServer",params:[{type:"Property",name:"tag",reflectMapper:{serverId:1,fromTime:2,toTime:3,reverse:4,limit:5,cursor:6}}],response:[{type:"PropertyArray",name:"data",reflectMapper:os.inviteApplyRecord}]},qchatGetInviteApplyRecordOfSelf:{sid:24,cid:125,service:"qchatServer",params:[{type:"Property",name:"tag",reflectMapper:{fromTime:1,toTime:2,reverse:3,limit:4,cursor:5}}],response:[{type:"PropertyArray",name:"data",reflectMapper:os.inviteApplyRecord}]},qchatClearServersUnread:{sid:25,cid:5,service:"qchatServer",params:[{type:"LongArray",name:"serverIds"}],response:[{type:"Property",name:"clearServersUnreadTag",reflectMapper:os.clearServersUnreadTag}]},qchatSubscribeChannelsByServers:{sid:25,cid:7,service:"qchatServer",params:[{type:"int",name:"type"},{type:"LongArray",name:"serverIds"}],response:[{type:"PropertyArray",name:"unreadInfos",reflectMapper:os.unreadInfo},{type:"LongArray",name:"failServerIds"}]},qchatEnterAsVisitor:{sid:25,cid:10,service:"qchatServer",params:[{type:"Property",name:"tag",reflectMapper:{serverIds:1}}],response:[{type:"LongArray",name:"failServerIds"}]},qchatLeaveAsVisitor:{sid:25,cid:11,service:"qchatServer",params:[{type:"Property",name:"tag",reflectMapper:{serverIds:1}}],response:[{type:"LongArray",name:"failServerIds"}]}},_s=Function.prototype,qS=Object.prototype,Ky=_s.toString,VS=qS.hasOwnProperty,HS=Ky.call(Object),gf=function(_e){if(!Es(_e)||yi(_e)!="[object Object]")return!1;var Ve=By(_e);if(Ve===null)return!0;var Oe=VS.call(Ve,"constructor")&&Ve.constructor;return typeof Oe=="function"&&Oe instanceof Oe&&Ky.call(Oe)==HS};function $a(pe,_e){if(!gf(_e))return{};var Ve=JSON.parse(Eo(_e)),Oe=Qy(pe,Ve);return JSON.parse(Eo(jn(jn({},Ve),Oe)))}function Qy(pe,_e){if(!gf(_e))return{};var Ve={},Oe=Sa(pe);return Kn(Oe).call(Oe,function(Ie){var At=pe[Ie].type;if(typeof At!="string"){var nr=Qy(pe[Ie],_e);Sa(nr).length>0&&(Ve[Ie]=nr)}else{var kt=pe[Ie],ur=kt.rawKey||Ie,gr=zS[At](_e,ur,kt);gr!==void 0&&(_e[ur]=void 0,Ve[Ie]=gr)}}),Ve}var zS={number:function(_e,Ve){if(_e[Ve]!==void 0)return+_e[Ve]},string:function(_e,Ve){if(_e[Ve]!==void 0)return _e[Ve]},boolean:function(_e,Ve){return+_e[Ve]>0||+_e[Ve]!=0&&void 0},enum:function(_e,Ve,Oe){return Op(Oe)[_e[Ve]]},object:function(_e,Ve){if(_e[Ve]!==void 0)try{return JSON.parse(_e[Ve])}catch{return{}}}};function yu(pe,_e){if(!gf(_e))return{};var Ve=JSON.parse(Eo(_e)),Oe=Jy(pe,Ve);return JSON.parse(Eo(jn(jn({},Ve),Oe)))}function Jy(pe,_e){var Ve;if(!gf(_e))return Hc(Ve=Sa(pe)).call(Ve,function(At,nr){return At[pe[nr].rawKey||nr]=void 0,At},{});var Oe={},Ie=Sa(pe);return Kn(Ie).call(Ie,function(At){var nr=pe[At].type;if(typeof nr!="string"){var kt=Jy(pe[At],_e[At]);return jn(Oe,kt),void(_e[At]=void 0)}var ur=pe[At],gr=ur.rawKey||At,Ar=hf[nr](_e,At,ur);_e[gr]=void 0,Oe[gr]=Ar}),Oe}var hf={number:function(_e,Ve){return _e[Ve]},string:function(_e,Ve){return _e[Ve]},boolean:function(_e,Ve){return _e[Ve]===!0?1:_e[Ve]===!1?0:void 0},enum:function(_e,Ve,Oe){return Op(Oe)[_e[Ve]]},object:function(_e,Ve){if(_e[Ve]!==void 0)try{return Eo(_e[Ve])}catch{return""}}},Gh=hf,Yy={serverId:{type:"string"},name:{type:"string"},icon:{type:"string"},ext:{type:"string"},owner:{type:"string"},memberNumber:{type:"number"},inviteMode:{type:"number"},applyMode:{type:"number"},validFlag:{type:"boolean"},createTime:{type:"number"},updateTime:{type:"number"},channelNumber:{type:"number"},categoryNumber:{type:"number"},searchType:{type:"number"},searchEnable:{type:"boolean"},reorderWeight:{type:"string"}},WS={serverId:{type:"string"},uid:{type:"string"},accid:{type:"string"},nick:{type:"string"},avatar:{type:"string"},ext:{type:"string"},type:{type:"number"},joinTime:{type:"number"},inviter:{type:"string"},validFlag:{type:"boolean"},createTime:{type:"number"},updateTime:{type:"number"}},GS={serverId:{type:"string"},appid:{type:"string"},accid:{type:"string"},ext:{type:"string"},banTime:{type:"number"},validFlag:{type:"boolean"},createTime:{type:"number"},updateTime:{type:"number"}};function Zd(pe){return $a(Yy,pe)}function Kh(pe){return ks(pe)&&pe.length>0?Ao(pe).call(pe,function(_e){return Zd(_e)}):[]}function bu(pe){return $a(WS,pe)}function Ac(pe){return ks(pe)&&pe.length>0?Ao(pe).call(pe,function(_e){return bu(_e)}):[]}function KS(pe){return ks(pe)&&pe.length>0?Ao(pe).call(pe,function(_e){return function(Oe){return $a(GS,Oe)}(_e)}):[]}function Zc(pe){var _e,Ve,Oe;if(!pe.antispamTag)return{};var Ie=jn({},pe.antispamTag);return!((_e=pe.antispamTag)===null||_e===void 0)&&_e.antiSpamBusinessId&&typeof((Ve=pe.antispamTag)===null||Ve===void 0?void 0:Ve.antiSpamBusinessId)!="string"&&(Ie.antiSpamBusinessId=Eo((Oe=pe.antispamTag)===null||Oe===void 0?void 0:Oe.antiSpamBusinessId)),Ie}var QS={accid:{type:"string"},type:{type:"number"},serverId:{type:"string"},status:{type:"number"},requestId:{type:"string"},createTime:{type:"number"},updateTime:{type:"number"},expireTime:{type:"number"},data:{type:"object"}};function ep(pe){return $a(QS,pe)}function Xy(pe){return ks(pe)&&pe.length>0?Ao(pe).call(pe,function(_e){return ep(_e)}):[]}var vf,Ia,Mi,jl,JS={successServerIds:{type:"object"},failServerIds:{type:"object"},ackTimestamp:{type:"number"}};function Dl(pe){return $a(JS,pe)}(function(pe){pe[pe.reorderWeight=0]="reorderWeight",pe[pe.createTime=1]="createTime"})(vf||(vf={})),function(pe){pe[pe.white=1]="white",pe[pe.black=2]="black"}(Ia||(Ia={})),function(pe){pe[pe.add=1]="add",pe[pe.remove=2]="remove"}(Mi||(Mi={})),function(pe){pe[pe.message=0]="message",pe[pe.media=1]="media",pe[pe.ext=100]="ext"}(jl||(jl={}));var tp={channelId:{type:"string"},serverId:{type:"string"},name:{type:"string"},topic:{type:"string"},ext:{type:"string"},type:{type:"enum",values:jl},validFlag:{type:"boolean"},createTime:{type:"number"},updateTime:{type:"number"},viewMode:{type:"number"},categoryId:{type:"string"},syncMode:{type:"number"},visitorMode:{type:"number"},reorderWeight:{type:"string"}},YS={serverId:{type:"string"},channelId:{type:"string"},ackTimestamp:{type:"number"},unreadCount:{type:"number"},mentionedCount:{type:"number"},maxCount:{type:"number"},lastMsgTime:{type:"number"}},Zy={serverId:{type:"string"},channelId:{type:"string"},type:{type:"enum",values:Ia},opeType:{type:"enum",values:Mi},toAccids:{type:"object"}},yf={serverId:{type:"string"},channelId:{type:"string"},type:{type:"enum",values:Ia},opeType:{type:"enum",values:Mi},roleId:{type:"string"}},XS={categoryId:{type:"string"},serverId:{type:"string"},name:{type:"string"},ext:{type:"string"},owner:{type:"string"},viewMode:{type:"number"},validFlag:{type:"boolean"},createTime:{type:"number"},updateTime:{type:"number"},channelNumber:{type:"number"}},eb={serverId:{type:"string"},channelId:{type:"string"},accid:{type:"string"},avatar:{type:"string"},nick:{type:"string"},createTime:{type:"number"},updateTime:{type:"number"}};function rp(pe){return $a(yf,pe)}function np(pe){return $a(tp,pe)}function op(pe){return ks(pe)&&pe.length>0?Ao(pe).call(pe,function(_e){return np(_e)}):[]}function Qh(pe){return $a(YS,pe)}function ap(pe){return ks(pe)&&pe.length>0?Ao(pe).call(pe,function(_e){return Qh(_e)}):[]}function sp(pe){return $a(XS,pe)}function Jh(pe){return ks(pe)&&pe.length>0?Ao(pe).call(pe,function(_e){return sp(_e)}):[]}function ZS(pe){return ks(pe)&&pe.length>0?Ao(pe).call(pe,function(_e){return function(Oe){return $a(eb,Oe)}(_e)}):[]}function ip(pe){try{return JSON.parse(pe)}catch{return[]}}var bf=Ji?Ji.isConcatSpreadable:void 0,eM=function(_e){return rc(_e)||kh(_e)||!!(bf&&_e&&_e[bf])},tb=function pe(_e,Ve,Oe,Ie,At){var nr=-1,kt=_e.length;for(Oe||(Oe=eM),At||(At=[]);++nr<kt;){var ur=_e[nr];Ve>0&&Oe(ur)?Ve>1?pe(ur,Ve-1,Oe,Ie,At):Zs(At,ur):Ie||(At[At.length]=ur)}return At},Yh=ty(function(pe,_e){return Qn(pe)?ah(pe,tb(_e,1,Qn,!0)):[]}),Tf=Yh;function Xh(pe,_e){var Ve,Oe=Ba!==void 0&&us(pe)||pe["@@iterator"];if(Oe)return Go(Ve=(Oe=Oe.call(pe)).next).call(Ve,Oe);if(ks(pe)||(Oe=function(nr,kt){var ur;if(nr){if(typeof nr=="string")return Zh(nr,kt);var gr=Fo(ur=Object.prototype.toString.call(nr)).call(ur,8,-1);if(gr==="Object"&&nr.constructor&&(gr=nr.constructor.name),gr==="Map"||gr==="Set")return Kc(nr);if(gr==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(gr))return Zh(nr,kt)}}(pe))||_e&&pe&&typeof pe.length=="number"){Oe&&(pe=Oe);var Ie=0;return function(){return Ie>=pe.length?{done:!0}:{done:!1,value:pe[Ie++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Zh(pe,_e){(_e==null||_e>pe.length)&&(_e=pe.length);for(var Ve=0,Oe=new Array(_e);Ve<_e;Ve++)Oe[Ve]=pe[Ve];return Oe}var Tu,cp,Ul,ql,tM=function(pe){function _e(Oe){var Ie;return(Ie=pe.call(this,"qchatServer",Oe)||this).core=Oe,Zi({cmdMap:Gy,cmdConfig:Xc}),Ie}Ko(_e,pe);var Ve=_e.prototype;return Ve.createServer=function(Ie){return Hr(this,void 0,void 0,wr.mark(function At(){var nr;return wr.wrap(function(ur){for(;;)switch(ur.prev=ur.next){case 0:return On({icon:{type:"string",required:!1},name:{type:"string",required:!1},ext:{type:"string",required:!1},searchType:{type:"number",required:!1,min:0},searchEnable:{type:"boolean",required:!1},inviteMode:{type:"number",min:0,max:1,required:!1},applyMode:{type:"number",min:0,max:1,required:!1}},Ie),ur.next=3,this.core.sendCmd("qchatCreateServer",{serverInfo:jn(jn({},Ie),{searchEnable:Ie.searchEnable===!1?0:1}),antispamTag:Zc(Ie)});case 3:return nr=ur.sent,ur.abrupt("return",Zd(nr.content.serverInfo));case 5:case"end":return ur.stop()}},At,this)}))},Ve.deleteServer=function(Ie){return Hr(this,void 0,void 0,wr.mark(function At(){return wr.wrap(function(kt){for(;;)switch(kt.prev=kt.next){case 0:return On({serverId:{type:"string",min:1}},Ie),kt.next=3,this.core.sendCmd("qchatDeleteServer",Ie);case 3:case"end":return kt.stop()}},At,this)}))},Ve.updateServer=function(Ie){return Hr(this,void 0,void 0,wr.mark(function At(){var nr;return wr.wrap(function(ur){for(;;)switch(ur.prev=ur.next){case 0:return On({serverId:{type:"string",min:1},icon:{type:"string",required:!1},name:{type:"string",required:!1},ext:{type:"string",required:!1},searchType:{type:"number",required:!1,min:0},searchEnable:{type:"boolean",required:!1},inviteMode:{type:"number",min:0,max:1,required:!1},applyMode:{type:"number",min:0,max:1,required:!1}},Ie),ur.next=3,this.core.sendCmd("qchatUpdateServer",{serverInfo:jn(jn({},Ie),{searchEnable:Ie.searchEnable===!1?0:1}),antispamTag:Zc(Ie)});case 3:return nr=ur.sent,ur.abrupt("return",Zd(nr.content.serverInfo));case 5:case"end":return ur.stop()}},At,this)}))},Ve.getServers=function(Ie){return Hr(this,void 0,void 0,wr.mark(function At(){var nr;return wr.wrap(function(ur){for(;;)switch(ur.prev=ur.next){case 0:return On({serverIds:{type:"array",itemType:"string",min:1}},Ie),ur.next=3,this.core.sendCmd("qchatGetServers",Ie);case 3:return nr=ur.sent,ur.abrupt("return",Kh(nr.content.serverList));case 5:case"end":return ur.stop()}},At,this)}))},Ve.getServersByPage=function(Ie){return Hr(this,void 0,void 0,wr.mark(function At(){var nr,kt,ur,gr;return wr.wrap(function(Rr){for(;;)switch(Rr.prev=Rr.next){case 0:return On({timestamp:{type:"number"},limit:{type:"number",min:1,required:!1}},Ie),Rr.next=3,this.core.sendCmd("qchatGetServersByPage",{tag:Ie});case 3:return nr=Rr.sent,kt=nr.content,ur=kt.datas,gr=kt.listQueryTag,Rr.abrupt("return",{listQueryTag:{hasMore:+gr.hasMore==1,nextTimetag:Yo(gr.nextTimetag)},datas:Kh(ur)});case 6:case"end":return Rr.stop()}},At,this)}))},Ve.inviteServerMembers=function(Ie){return Hr(this,void 0,void 0,wr.mark(function At(){var nr,kt;return wr.wrap(function(gr){for(;;)switch(gr.prev=gr.next){case 0:return On({serverId:{type:"string",min:1},accids:{type:"array",itemType:"string",min:1},ps:{type:"string"},params:{type:"object",rules:{ttl:{type:"number"}},required:!1}},Ie),gr.next=3,this.core.sendCmd("qchatInviteServerMembers",Ie);case 3:return nr=gr.sent,kt=nr.content.record||{},gr.abrupt("return",{failByOverAccids:nr.content.failByOverAccids,failByBanAccids:nr.content.failByBanAccids,recordInfo:ep(kt)});case 6:case"end":return gr.stop()}},At,this)}))},Ve.acceptServerInvite=function(Ie){return Hr(this,void 0,void 0,wr.mark(function At(){return wr.wrap(function(kt){for(;;)switch(kt.prev=kt.next){case 0:return On({serverId:{type:"string",allowEmpty:!1},accid:{type:"string",allowEmpty:!1},recordInfo:{type:"object",rules:{requestId:{type:"string",allowEmpty:!1}}}},Ie),kt.next=3,this.core.sendCmd("qchatAcceptServerInvite",Ie);case 3:case"end":return kt.stop()}},At,this)}))},Ve.rejectInviteServer=function(Ie){return Hr(this,void 0,void 0,wr.mark(function At(){return wr.wrap(function(kt){for(;;)switch(kt.prev=kt.next){case 0:return On({serverId:{type:"string",min:1},accid:{type:"string",min:1},ps:{type:"string"},recordInfo:{type:"object",rules:{requestId:{type:"string",allowEmpty:!1}}}},Ie),kt.next=3,this.core.sendCmd("qchatRejectInviteServer",Ie);case 3:case"end":return kt.stop()}},At,this)}))},Ve.applyServerJoin=function(Ie){return Hr(this,void 0,void 0,wr.mark(function At(){var nr;return wr.wrap(function(ur){for(;;)switch(ur.prev=ur.next){case 0:return On({serverId:{type:"string",min:1},ps:{type:"string"},params:{type:"object",rules:{ttl:{type:"number"}},required:!1}},Ie),ur.next=3,this.core.sendCmd("qchatApplyServerJoin",Ie);case 3:return nr=ur.sent,ur.abrupt("return",ep(nr.content.data));case 5:case"end":return ur.stop()}},At,this)}))},Ve.acceptServerApply=function(Ie){return Hr(this,void 0,void 0,wr.mark(function At(){return wr.wrap(function(kt){for(;;)switch(kt.prev=kt.next){case 0:return On({serverId:{type:"string",min:1},accid:{type:"string",min:1},recordInfo:{type:"object",rules:{requestId:{type:"string",allowEmpty:!1}}}},Ie),kt.next=3,this.core.sendCmd("qchatAcceptServerApply",Ie);case 3:case"end":return kt.stop()}},At,this)}))},Ve.rejectServerApply=function(Ie){return Hr(this,void 0,void 0,wr.mark(function At(){return wr.wrap(function(kt){for(;;)switch(kt.prev=kt.next){case 0:return On({serverId:{type:"string",min:1},accid:{type:"string",min:1},ps:{type:"string"},recordInfo:{type:"object",rules:{requestId:{type:"string",allowEmpty:!1}}}},Ie),kt.next=3,this.core.sendCmd("qchatRejectServerApply",Ie);case 3:case"end":return kt.stop()}},At,this)}))},Ve.kickServerMembers=function(Ie){return Hr(this,void 0,void 0,wr.mark(function At(){return wr.wrap(function(kt){for(;;)switch(kt.prev=kt.next){case 0:return On({serverId:{type:"string",min:1},accids:{type:"array",itemType:"string",min:1}},Ie),kt.next=3,this.core.sendCmd("qchatKickServerMembers",Ie);case 3:case"end":return kt.stop()}},At,this)}))},Ve.leaveServer=function(Ie){return Hr(this,void 0,void 0,wr.mark(function At(){return wr.wrap(function(kt){for(;;)switch(kt.prev=kt.next){case 0:return On({serverId:{type:"string",min:1}},Ie),kt.next=3,this.core.sendCmd("qchatLeaveServer",Ie);case 3:case"end":return kt.stop()}},At,this)}))},Ve.updateMyMemberInfo=function(Ie){return Hr(this,void 0,void 0,wr.mark(function At(){var nr;return wr.wrap(function(ur){for(;;)switch(ur.prev=ur.next){case 0:return On({serverId:{type:"string",min:1},accid:{type:"string",required:!1},nick:{type:"string",required:!1},avatar:{type:"string",required:!1},ext:{type:"string",required:!1}},Ie),ur.next=3,this.core.sendCmd("qchatUpdateMyMemberInfo",{memberInfo:Ie,antispamTag:Zc(Ie)});case 3:return nr=ur.sent,ur.abrupt("return",bu(nr.content.memberInfo));case 5:case"end":return ur.stop()}},At,this)}))},Ve.updateServerMemberInfo=function(Ie){return Hr(this,void 0,void 0,wr.mark(function At(){var nr;return wr.wrap(function(ur){for(;;)switch(ur.prev=ur.next){case 0:return On({serverId:{type:"string",min:1},accid:{type:"string",min:1},nick:{type:"string",required:!1},avatar:{type:"string",required:!1}},Ie),ur.next=3,this.core.sendCmd("qchatUpdateServerMemberInfo",{memberInfo:Ie,antispamTag:Zc(Ie)});case 3:return nr=ur.sent,ur.abrupt("return",bu(nr.content.memberInfo));case 5:case"end":return ur.stop()}},At,this)}))},Ve.getServerMembers=function(Ie){return Hr(this,void 0,void 0,wr.mark(function At(){var nr,kt,ur,gr,Ar;return wr.wrap(function(Ur){for(;;)switch(Ur.prev=Ur.next){case 0:if(On({accids:{type:"array"}},Ie),nr=[],Ie.accids.length)for(kt=Xh(Ie.accids);!(ur=kt()).done;)gr=ur.value,nr.push(gr.serverId+"|"+gr.accid);return Ur.next=5,this.core.sendCmd("qchatGetServerMembers",{accids:nr});case 5:return Ar=Ur.sent,Ur.abrupt("return",Ac(Ar.content.accidList));case 7:case"end":return Ur.stop()}},At,this)}))},Ve.getServerMembersByPage=function(Ie){return Hr(this,void 0,void 0,wr.mark(function At(){var nr,kt,ur,gr;return wr.wrap(function(Rr){for(;;)switch(Rr.prev=Rr.next){case 0:return On({serverId:{type:"string",min:1},timetag:{type:"number"},limit:{type:"number",min:1,required:!1}},Ie),Rr.next=3,this.core.sendCmd("qchatGetServerMembersByPage",{tag:Ie});case 3:return nr=Rr.sent,kt=nr.content,ur=kt.datas,gr=kt.listQueryTag,Rr.abrupt("return",{listQueryTag:{hasMore:+gr.hasMore==1,nextTimetag:Yo(gr.nextTimetag)},datas:Ac(ur)});case 6:case"end":return Rr.stop()}},At,this)}))},Ve.subscribeServer=function(Ie){return Hr(this,void 0,void 0,wr.mark(function At(){var nr,kt,ur,gr;return wr.wrap(function(Rr){for(;;)switch(Rr.prev=Rr.next){case 0:if(On({type:{type:"number",min:4,max:4,required:!1},opeType:{type:"number",min:1,max:2}},Ie),Ie.type||(Ie.type=4),!Ie.servers.length){Rr.next=10;break}return kt=jn(jn({},Ie),{channels:Ao(nr=Ie.servers).call(nr,function(Ur){return{serverId:Ur.serverId,channelId:""}})}),Rr.next=6,this.core.qchatChannel.subscribeModuleService.subscribe(kt);case 6:return ur=Rr.sent,gr=ur.failedChannels,this.core.qchatChannel.subscribeModuleService.cacheSubscribe(kt),Rr.abrupt("return",{failedServers:gr});case 10:case"end":return Rr.stop()}},At,this)}))},Ve.banServerMember=function(Ie){return Hr(this,void 0,void 0,wr.mark(function At(){return wr.wrap(function(kt){for(;;)switch(kt.prev=kt.next){case 0:return On({serverId:{type:"string",allowEmpty:!1},accid:{type:"string",allowEmpty:!1},ext:{type:"string",required:!1}},Ie),kt.next=3,this.core.sendCmd("qchatUpdateServerMemberBan",{tag:jn(jn({},Ie),{opeType:1})});case 3:case"end":return kt.stop()}},At,this)}))},Ve.unbanServerMember=function(Ie){return Hr(this,void 0,void 0,wr.mark(function At(){return wr.wrap(function(kt){for(;;)switch(kt.prev=kt.next){case 0:return On({serverId:{type:"string",allowEmpty:!1},accid:{type:"string",allowEmpty:!1},ext:{type:"string",required:!1}},Ie),kt.next=3,this.core.sendCmd("qchatUpdateServerMemberBan",{tag:jn(jn({},Ie),{opeType:2})});case 3:case"end":return kt.stop()}},At,this)}))},Ve.getBannedMembersByPage=function(Ie){return Hr(this,void 0,void 0,wr.mark(function At(){var nr,kt,ur,gr;return wr.wrap(function(Rr){for(;;)switch(Rr.prev=Rr.next){case 0:return On({serverId:{type:"string",allowEmpty:!1},timetag:{type:"number",min:0},limit:{type:"number",min:1,required:!1}},Ie),Rr.next=3,this.core.sendCmd("qchatGetBannedMembersByPage",{tag:Ie});case 3:return nr=Rr.sent,kt=nr.content,ur=kt.datas,gr=kt.listQueryTag,Rr.abrupt("return",{listQueryTag:{hasMore:+gr.hasMore==1,nextTimetag:Yo(gr.nextTimetag)},datas:KS(ur)});case 6:case"end":return Rr.stop()}},At,this)}))},Ve.serverSearchByPage=function(Ie){return Hr(this,void 0,void 0,wr.mark(function At(){var nr,kt,ur,gr;return wr.wrap(function(Rr){for(;;)switch(Rr.prev=Rr.next){case 0:if(On({keyword:{type:"string",allowEmpty:!1},startTime:{type:"number",min:0,required:!1},endTime:{type:"number",min:0,required:!1},limit:{type:"number",min:1,required:!1},serverType:{type:"array",itemType:"number",min:0,required:!1},order:{type:"enum",values:xa(Yc),required:!1},searchType:{type:"enum",values:xa(mf)},sort:{type:"enum",values:xa(Vi),required:!1},cursor:{type:"string",allowEmpty:!1,required:!1}},Ie),!(Ie.startTime&&Ie.endTime&&Ie.startTime>=Ie.endTime)){Rr.next=3;break}throw new Il("startTime more than endTime",Ie,"timeRule");case 3:return Rr.next=5,this.core.sendCmd("qchatServerSearchByPage",{tag:jn(jn({},Ie),{order:Ie.order&&Yc[Ie.order],searchType:mf[Ie.searchType],sort:vu(Ie)&&Vi[vu(Ie)],serverType:Eo(Ie.serverType)})});case 5:return nr=Rr.sent,kt=nr.content,ur=kt.datas,gr=kt.listQueryTag,Rr.abrupt("return",{listQueryTag:{hasMore:+gr.hasMore==1,nextTimetag:Yo(gr.nextTimetag),cursor:gr.cursor},datas:Kh(ur)});case 8:case"end":return Rr.stop()}},At,this)}))},Ve.serverMemberSearchByPage=function(Ie){return Hr(this,void 0,void 0,wr.mark(function At(){var nr;return wr.wrap(function(ur){for(;;)switch(ur.prev=ur.next){case 0:return On({serverId:{type:"string",allowEmpty:!1},keyword:{type:"string",allowEmpty:!1},limit:{type:"number",min:1,required:!1}},Ie),ur.next=3,this.core.sendCmd("qchatServerMemberSearchByPage",{tag:Ie});case 3:return nr=ur.sent,ur.abrupt("return",Ac(nr.content.members));case 5:case"end":return ur.stop()}},At,this)}))},Ve.generateInviteCode=function(Ie){return Hr(this,void 0,void 0,wr.mark(function At(){var nr;return wr.wrap(function(ur){for(;;)switch(ur.prev=ur.next){case 0:return On({serverId:{type:"string",allowEmpty:!1},ttl:{type:"number",min:0,required:!1}},Ie),ur.next=3,this.core.sendCmd("qchatGenerateInviteCode",{tag:Ie});case 3:return nr=ur.sent,ur.abrupt("return",$a({expireTime:{type:"number"}},nr.content.data));case 5:case"end":return ur.stop()}},At,this)}))},Ve.joinByInviteCode=function(Ie){return Hr(this,void 0,void 0,wr.mark(function At(){return wr.wrap(function(kt){for(;;)switch(kt.prev=kt.next){case 0:return On({serverId:{type:"string",allowEmpty:!1},inviteCode:{type:"string",allowEmpty:!1},ps:{type:"string",required:!1}},Ie),kt.next=3,this.core.sendCmd("qchatJoinByInviteCode",{tag:Ie});case 3:case"end":return kt.stop()}},At,this)}))},Ve.getInviteApplyRecordOfServer=function(Ie){return Hr(this,void 0,void 0,wr.mark(function At(){var nr;return wr.wrap(function(ur){for(;;)switch(ur.prev=ur.next){case 0:return On({serverId:{type:"string",allowEmpty:!1},fromTime:{type:"number",min:0},toTime:{type:"number",min:0},reverse:{type:"boolean",required:!1},limit:{type:"number",min:1,required:!1},cursor:{type:"string",allowEmpty:!1,required:!1}},Ie),ur.next=3,this.core.sendCmd("qchatGetInviteApplyRecordOfServer",{tag:jn(jn({},Ie),{reverse:Kl(Ie)?1:0})});case 3:return nr=ur.sent,ur.abrupt("return",Xy(nr.content.data));case 5:case"end":return ur.stop()}},At,this)}))},Ve.getInviteApplyRecordOfSelf=function(Ie){return Hr(this,void 0,void 0,wr.mark(function At(){var nr;return wr.wrap(function(ur){for(;;)switch(ur.prev=ur.next){case 0:return On({fromTime:{type:"number",min:0},toTime:{type:"number",min:0},reverse:{type:"boolean",required:!1},limit:{type:"number",min:1,required:!1},cursor:{type:"string",allowEmpty:!1,required:!1}},Ie),ur.next=3,this.core.sendCmd("qchatGetInviteApplyRecordOfSelf",{tag:jn(jn({},Ie),{reverse:Kl(Ie)?1:0})});case 3:return nr=ur.sent,ur.abrupt("return",Xy(nr.content.data));case 5:case"end":return ur.stop()}},At,this)}))},Ve.markRead=function(Ie){return Hr(this,void 0,void 0,wr.mark(function At(){var nr,kt,ur,gr;return wr.wrap(function(Rr){for(;;)switch(Rr.prev=Rr.next){case 0:return On({serverIds:{type:"array",itemType:"string",required:!0}},Ie),Rr.next=3,this.core.sendCmd("qchatClearServersUnread",Ie);case 3:return nr=Rr.sent,kt=Dl(nr.content.clearServersUnreadTag),ur=kt.successServerIds,gr=kt.ackTimestamp,this.logger.log("qchatServer::clearServersUnread:: begin auto clear servers unreadInfo"),this.core.eventBus.emit("qchatChannel/clearUnreadCountByServers",ur,gr),Rr.abrupt("return",kt);case 9:case"end":return Rr.stop()}},At,this)}))},Ve.subscribeAllChannel=function(Ie){return Hr(this,void 0,void 0,wr.mark(function At(){var nr,kt,ur;return wr.wrap(function(Ar){for(;;)switch(Ar.prev=Ar.next){case 0:return On({type:{type:"number",required:!0},serverIds:{type:"array",itemType:"string",required:!0,max:10}},Ie),Ar.next=3,this.core.sendCmd("qchatSubscribeChannelsByServers",Ie,{timeout:3e4});case 3:return(kt=Ar.sent).content.unreadInfos=ap(kt.content.unreadInfos),kt.content.failServerIds=ip(kt.content.failServerIds),ur={type:Ie.type,opeType:1,channels:Ao(nr=kt.content.unreadInfos).call(nr,function(Rr){return{serverId:Rr.serverId,channelId:Rr.channelId}})},this.core.eventBus.emit("qchatChannel/cacheSubscribe",ur),this.core.eventBus.emit("qchatChannel/getRoleIdsByServerId",Ie.serverIds),this.core.eventBus.emit("qchatChannel/updateUnreads",kt.content.unreadInfos),Ar.abrupt("return",kt.content);case 11:case"end":return Ar.stop()}},At,this)}))},Ve.enterAsVisitor=function(Ie){return Hr(this,void 0,void 0,wr.mark(function At(){var nr,kt,ur;return wr.wrap(function(Ar){for(;;)switch(Ar.prev=Ar.next){case 0:return On({serverIds:{type:"array",itemType:"string",min:1}},Ie),Ar.next=3,this.core.sendCmd("qchatEnterAsVisitor",{tag:{serverIds:Eo(Ie.serverIds)}});case 3:return nr=Ar.sent,kt=ip(nr.content.failServerIds),ur=Tf(Ie.serverIds,kt),this.core.qchatChannel.subscribeForVisitorService.cacheServer(ur),Ar.abrupt("return",{failedServers:kt});case 8:case"end":return Ar.stop()}},At,this)}))},Ve.leaveAsVisitor=function(Ie){return Hr(this,void 0,void 0,wr.mark(function At(){var nr,kt,ur,gr=this;return wr.wrap(function(Rr){for(;;)switch(Rr.prev=Rr.next){case 0:return On({serverIds:{type:"array",itemType:"string",min:1}},Ie),Rr.next=3,this.core.sendCmd("qchatLeaveAsVisitor",{tag:{serverIds:Eo(Ie.serverIds)}});case 3:return nr=Rr.sent,kt=ip(nr.content.failServerIds),ur=Tf(Ie.serverIds,kt),Kn(ur).call(ur,function(Ur){gr.core.qchatChannel.subscribeForVisitorService.deleteServer(Ur)}),Rr.abrupt("return",{failedServers:kt});case 8:case"end":return Rr.stop()}},At,this)}))},Ve.subscribeAsVisitor=function(Ie){return Hr(this,void 0,void 0,wr.mark(function At(){return wr.wrap(function(kt){for(;;)switch(kt.prev=kt.next){case 0:if(On({opeType:{type:"number",min:1,max:2},type:{type:"number",required:!1},serverIds:{type:"array",itemType:"string",min:1}},Ie),!Ie.serverIds.length){kt.next=5;break}return kt.next=4,this.core.qchatChannel.subscribeForVisitorService.subscribeServerAsVisitor(Ie);case 4:return kt.abrupt("return",kt.sent);case 5:return kt.abrupt("return",{failedServers:[]});case 6:case"end":return kt.stop()}},At,this)}))},_e}(Ll);(function(pe){pe[pe.everyone=1]="everyone",pe[pe.custom=2]="custom"})(Tu||(Tu={})),function(pe){pe[pe.normal=0]="normal",pe[pe.owner=1]="owner"}(cp||(cp={})),function(pe){pe[pe.ignore=0]="ignore",pe[pe.deny=-1]="deny",pe[pe.allow=1]="allow"}(Ul||(Ul={})),function(pe){pe[pe.manageServer=1]="manageServer",pe[pe.manageChannel=2]="manageChannel",pe[pe.manageRole=3]="manageRole",pe[pe.sendMsg=4]="sendMsg",pe[pe.accountInfoSelf=5]="accountInfoSelf",pe[pe.inviteServer=6]="inviteServer",pe[pe.kickServer=7]="kickServer",pe[pe.accountInfoOther=8]="accountInfoOther",pe[pe.recallMsg=9]="recallMsg",pe[pe.deleteMsg=10]="deleteMsg",pe[pe.remindOther=11]="remindOther",pe[pe.remindEveryone=12]="remindEveryone",pe[pe.manageBlackWhiteList=13]="manageBlackWhiteList",pe[pe.banServerMember=14]="banServerMember",pe[pe.RTCChannelConnect=15]="RTCChannelConnect",pe[pe.RTCChannelDisconnectOther=16]="RTCChannelDisconnectOther",pe[pe.RTCChannelOpenMicrophone=17]="RTCChannelOpenMicrophone",pe[pe.RTCChannelOpenCamera=18]="RTCChannelOpenCamera",pe[pe.RTCChannelOpenCloseOtherMicrophone=19]="RTCChannelOpenCloseOtherMicrophone",pe[pe.RTCChannelOpenCloseOtherCamera=20]="RTCChannelOpenCloseOtherCamera",pe[pe.RTCChannelOpenCloseEveryoneMicrophone=21]="RTCChannelOpenCloseEveryoneMicrophone",pe[pe.RTCChannelOpenCloseEveryoneCamera=22]="RTCChannelOpenCloseEveryoneCamera",pe[pe.RTCChannelOpenShareScreen=23]="RTCChannelOpenShareScreen",pe[pe.RTCChannelCloseOtherShareScreen=24]="RTCChannelCloseOtherShareScreen",pe[pe.manageInviteApply=25]="manageInviteApply",pe[pe.manageInviteApplyHistory=26]="manageInviteApplyHistory",pe[pe.mentionedRole=27]="mentionedRole"}(ql||(ql={}));var rb={type:{type:"enum",values:Tu},memberType:{type:"enum",values:cp},createTime:{type:"number"},updateTime:{type:"number"},priority:{type:"number"},memberCount:{type:"number"},joinTime:{type:"number"}},rM={roleId:{type:"string"},categoryId:{type:"string"},serverId:{type:"string"},type:{type:"enum",values:Tu},validFlag:{type:"boolean"},createTime:{type:"number"},updateTime:{type:"number"},name:{type:"string"},icon:{type:"string"},ext:{type:"string"}},nM={id:{type:"string"},accid:{type:"string"},categoryId:{type:"string"},serverId:{type:"string"},validFlag:{type:"boolean"},createTime:{type:"number"},updateTime:{type:"number"},nick:{type:"string"},avatar:{type:"string"},ext:{type:"string"},memberType:{type:"enum",values:cp},joinTime:{type:"number"},inviter:{type:"string"}};function el(pe){var _e=jn({},pe),Ve=yu(rb,_e);return Ve.auths&&(Ve.auths=function(Ie){var At,nr=Hc(At=Sa(Ie)).call(At,function(kt,ur){var gr=ql[ur];return gr?kt[gr]=Ul[Ie[ur]]:kt[ur]=Ul[Ie[ur]],kt},{});return Eo(nr)}(Ve.auths)),Ve}function Hi(pe){var _e;return Hc(_e=Sa(pe)).call(_e,function(Ve,Oe){var Ie=ay(ql,Oe);return Ie?Ve[Ie]=Ul[pe[Oe]]:Ve[Yo(Oe)]=Ul[pe[Oe]],Ve},{})}function As(pe){var _e=$a(rb,pe);return pe.auths&&(_e.auths=Hi(JSON.parse(_e.auths))),_e.isMember&&delete _e.isMember,_e}function mi(pe){return ks(pe)&&pe.length>0?Ao(pe).call(pe,function(_e){return As(_e)}):[]}function Sf(pe){return pe.auths&&(pe.auths=Hi(JSON.parse(pe.auths))),$a(rM,pe)}function Su(pe){return pe.auths&&(pe.auths=Hi(JSON.parse(pe.auths))),$a(nM,pe)}bv("Set",function(pe){return function(){return pe(this,arguments.length?arguments[0]:void 0)}},Pd);var nb=kr.Set;_n({target:"Set",stat:!0,forced:!0},{from:Pg}),_n({target:"Set",stat:!0,forced:!0},{of:Sv}),_n({target:"Set",proto:!0,real:!0,forced:!0},{addAll:function(){for(var _e=lo(this),Ve=Xr(_e.add),Oe=0,Ie=arguments.length;Oe<Ie;Oe++)jt(Ve,_e,arguments[Oe]);return _e}}),_n({target:"Set",proto:!0,real:!0,forced:!0},{deleteAll:Mv});var Vl=hc;_n({target:"Set",proto:!0,real:!0,forced:!0},{every:function(_e){var Ve=lo(this),Oe=Vl(Ve),Ie=Zo(_e,arguments.length>1?arguments[1]:void 0);return!ko(Oe,function(At,nr){if(!Ie(At,At,Ve))return nr()},{IS_ITERATOR:!0,INTERRUPTED:!0}).stopped}}),_n({target:"Set",proto:!0,real:!0,forced:!0},{difference:function(_e){var Ve=lo(this),Oe=new(Vs(Ve,xr("Set")))(Ve),Ie=Xr(Oe.delete);return ko(_e,function(At){jt(Ie,Oe,At)}),Oe}}),_n({target:"Set",proto:!0,real:!0,forced:!0},{filter:function(_e){var Ve=lo(this),Oe=Vl(Ve),Ie=Zo(_e,arguments.length>1?arguments[1]:void 0),At=new(Vs(Ve,xr("Set"))),nr=Xr(At.add);return ko(Oe,function(kt){Ie(kt,kt,Ve)&&jt(nr,At,kt)},{IS_ITERATOR:!0}),At}}),_n({target:"Set",proto:!0,real:!0,forced:!0},{find:function(_e){var Ve=lo(this),Oe=Vl(Ve),Ie=Zo(_e,arguments.length>1?arguments[1]:void 0);return ko(Oe,function(At,nr){if(Ie(At,At,Ve))return nr(At)},{IS_ITERATOR:!0,INTERRUPTED:!0}).result}}),_n({target:"Set",proto:!0,real:!0,forced:!0},{intersection:function(_e){var Ve=lo(this),Oe=new(Vs(Ve,xr("Set"))),Ie=Xr(Ve.has),At=Xr(Oe.add);return ko(_e,function(nr){jt(Ie,Ve,nr)&&jt(At,Oe,nr)}),Oe}}),_n({target:"Set",proto:!0,real:!0,forced:!0},{isDisjointFrom:function(_e){var Ve=lo(this),Oe=Xr(Ve.has);return!ko(_e,function(Ie,At){if(jt(Oe,Ve,Ie)===!0)return At()},{INTERRUPTED:!0}).stopped}}),_n({target:"Set",proto:!0,real:!0,forced:!0},{isSubsetOf:function(_e){var Ve=hc(this),Oe=lo(_e),Ie=Oe.has;return ze(Ie)||(Oe=new(xr("Set"))(_e),Ie=Xr(Oe.has)),!ko(Ve,function(At,nr){if(jt(Ie,Oe,At)===!1)return nr()},{IS_ITERATOR:!0,INTERRUPTED:!0}).stopped}}),_n({target:"Set",proto:!0,real:!0,forced:!0},{isSupersetOf:function(_e){var Ve=lo(this),Oe=Xr(Ve.has);return!ko(_e,function(Ie,At){if(jt(Oe,Ve,Ie)===!1)return At()},{INTERRUPTED:!0}).stopped}});var ob=Ne([].join),oM=[].push;_n({target:"Set",proto:!0,real:!0,forced:!0},{join:function(_e){var Ve=lo(this),Oe=Vl(Ve),Ie=_e===void 0?",":Za(_e),At=[];return ko(Oe,oM,{that:At,IS_ITERATOR:!0}),ob(At,Ie)}}),_n({target:"Set",proto:!0,real:!0,forced:!0},{map:function(_e){var Ve=lo(this),Oe=Vl(Ve),Ie=Zo(_e,arguments.length>1?arguments[1]:void 0),At=new(Vs(Ve,xr("Set"))),nr=Xr(At.add);return ko(Oe,function(kt){jt(nr,At,Ie(kt,kt,Ve))},{IS_ITERATOR:!0}),At}});var ab=TypeError;_n({target:"Set",proto:!0,real:!0,forced:!0},{reduce:function(_e){var Ve=lo(this),Oe=Vl(Ve),Ie=arguments.length<2,At=Ie?void 0:arguments[1];if(Xr(_e),ko(Oe,function(nr){Ie?(Ie=!1,At=nr):At=_e(At,nr,nr,Ve)},{IS_ITERATOR:!0}),Ie)throw ab("Reduce of empty set with no initial value");return At}}),_n({target:"Set",proto:!0,real:!0,forced:!0},{some:function(_e){var Ve=lo(this),Oe=Vl(Ve),Ie=Zo(_e,arguments.length>1?arguments[1]:void 0);return ko(Oe,function(At,nr){if(Ie(At,At,Ve))return nr()},{IS_ITERATOR:!0,INTERRUPTED:!0}).stopped}}),_n({target:"Set",proto:!0,real:!0,forced:!0},{symmetricDifference:function(_e){var Ve=lo(this),Oe=new(Vs(Ve,xr("Set")))(Ve),Ie=Xr(Oe.delete),At=Xr(Oe.add);return ko(_e,function(nr){jt(Ie,Oe,nr)||jt(At,Oe,nr)}),Oe}}),_n({target:"Set",proto:!0,real:!0,forced:!0},{union:function(_e){var Ve=lo(this),Oe=new(Vs(Ve,xr("Set")))(Ve);return ko(_e,Xr(Oe.add),{that:Oe}),Oe}});var Mf,lp,zi,up,tl,ga,Nc,Mu=nb;(function(pe){pe[pe.sendTime=1]="sendTime"})(Mf||(Mf={})),function(pe){pe[pe.text=0]="text",pe[pe.image=1]="image",pe[pe.audio=2]="audio",pe[pe.video=3]="video",pe[pe.geo=4]="geo",pe[pe.notification=5]="notification",pe[pe.file=6]="file",pe[pe.tip=10]="tip",pe[pe.robot=11]="robot",pe[pe.g2=12]="g2",pe[pe.custom=100]="custom"}(lp||(lp={})),function(pe){pe[pe.sending=1]="sending",pe[pe.success=2]="success",pe[pe.failed=3]="failed"}(zi||(zi={})),function(pe){pe[pe.notifyAll=1]="notifyAll",pe[pe.notifySubscribe=2]="notifySubscribe"}(up||(up={})),function(pe){pe[pe.unknown=0]="unknown",pe[pe.server=1]="server",pe[pe.channel=2]="channel",pe[pe.serverAccids=3]="serverAccids",pe[pe.channelAccids=4]="channelAccids",pe[pe.accids=5]="accids"}(tl||(tl={})),function(pe){pe[pe.serverMemberInvite=1]="serverMemberInvite",pe[pe.serverMemberInviteReject=2]="serverMemberInviteReject",pe[pe.serverMemberApply=3]="serverMemberApply",pe[pe.serverMemberApplyReject=4]="serverMemberApplyReject",pe[pe.serverCreate=5]="serverCreate",pe[pe.serverRemove=6]="serverRemove",pe[pe.serverUpdate=7]="serverUpdate",pe[pe.serverMemberInviteDone=8]="serverMemberInviteDone",pe[pe.serverMemberInviteAccept=9]="serverMemberInviteAccept",pe[pe.serverMemberApplyDone=10]="serverMemberApplyDone",pe[pe.serverMemberApplyAccept=11]="serverMemberApplyAccept",pe[pe.serverMemberKick=12]="serverMemberKick",pe[pe.serverMemberLeave=13]="serverMemberLeave",pe[pe.serverMemberUpdate=14]="serverMemberUpdate",pe[pe.channelCreate=15]="channelCreate",pe[pe.channelRemove=16]="channelRemove",pe[pe.channelUpdate=17]="channelUpdate",pe[pe.channelUpdateWhiteBlackIdentify=18]="channelUpdateWhiteBlackIdentify",pe[pe.channelUpdateWhiteBlackIdentifyUser=19]="channelUpdateWhiteBlackIdentifyUser",pe[pe.updateQuickComment=20]="updateQuickComment",pe[pe.channelCategoryCreate=21]="channelCategoryCreate",pe[pe.channelCategoryRemove=22]="channelCategoryRemove",pe[pe.channelCategoryUpdate=23]="channelCategoryUpdate",pe[pe.channelCategoryUpdateWhiteBlackIdentify=24]="channelCategoryUpdateWhiteBlackIdentify",pe[pe.channelCategoryUpdateWhiteBlackIdentifyUser=25]="channelCategoryUpdateWhiteBlackIdentifyUser",pe[pe.serverIdentifyAdd=26]="serverIdentifyAdd",pe[pe.serverIdentifyRemove=27]="serverIdentifyRemove",pe[pe.serverIdentifyUpdate=28]="serverIdentifyUpdate",pe[pe.channelIdentifyUpdate=29]="channelIdentifyUpdate",pe[pe.userIdentifyUpdate=30]="userIdentifyUpdate",pe[pe.channelVisibilityUpdate=31]="channelVisibilityUpdate",pe[pe.serverEnterLeave=32]="serverEnterLeave",pe[pe.serverMemberJoinByInviteCode=33]="serverMemberJoinByInviteCode",pe[pe.channelVisibilityToVisitorUpdate=34]="channelVisibilityToVisitorUpdate",pe[pe.myMemberInfoUpdated=35]="myMemberInfoUpdated",pe[pe.custom=100]="custom",pe[pe.msgTyping=101]="msgTyping"}(ga||(ga={})),function(pe){pe[pe.reply=1]="reply",pe[pe.thread=2]="thread",pe[pe.all=3]="all"}(Nc||(Nc={}));var ev=function(){return pi.Date.now()},aM=/\s/,sM=function(_e){for(var Ve=_e.length;Ve--&&aM.test(_e.charAt(Ve)););return Ve},iM=/^\s+/,cM=function(_e){return _e&&_e.slice(0,sM(_e)+1).replace(iM,"")},lM=/^[-+]0x[0-9a-f]+$/i,uM=/^0b[01]+$/i,dM=/^0o[0-7]+$/i,pM=parseInt,tv=function(_e){if(typeof _e=="number")return _e;if(lf(_e))return NaN;if(Fi(_e)){var Ve=typeof _e.valueOf=="function"?_e.valueOf():_e;_e=Fi(Ve)?Ve+"":Ve}if(typeof _e!="string")return _e===0?_e:+_e;_e=cM(_e);var Oe=uM.test(_e);return Oe||dM.test(_e)?pM(_e.slice(2),Oe?2:8):lM.test(_e)?NaN:+_e},fM=Math.max,sb=Math.min,mM=function(_e,Ve,Oe){var Ie,At,nr,kt,ur,gr,Ar=0,Rr=!1,Ur=!1,Dr=!0;if(typeof _e!="function")throw new TypeError("Expected a function");function Jr(Fn){var mo=Ie,ao=At;return Ie=At=void 0,Ar=Fn,kt=_e.apply(ao,mo)}function Cn(Fn){return Ar=Fn,ur=setTimeout($n,Ve),Rr?Jr(Fn):kt}function Sn(Fn){var mo=Fn-gr;return gr===void 0||mo>=Ve||mo<0||Ur&&Fn-Ar>=nr}function $n(){var Fn=ev();if(Sn(Fn))return Rn(Fn);ur=setTimeout($n,function(ao){var ea=Ve-(ao-gr);return Ur?sb(ea,nr-(ao-Ar)):ea}(Fn))}function Rn(Fn){return ur=void 0,Dr&&Ie?Jr(Fn):(Ie=At=void 0,kt)}function Wn(){var Fn=ev(),mo=Sn(Fn);if(Ie=arguments,At=this,gr=Fn,mo){if(ur===void 0)return Cn(gr);if(Ur)return clearTimeout(ur),ur=setTimeout($n,Ve),Jr(gr)}return ur===void 0&&(ur=setTimeout($n,Ve)),kt}return Ve=tv(Ve)||0,Fi(Oe)&&(Rr=!!Oe.leading,nr=(Ur="maxWait"in Oe)?fM(tv(Oe.maxWait)||0,Ve):nr,Dr="trailing"in Oe?!!Oe.trailing:Dr),Wn.cancel=function(){ur!==void 0&&clearTimeout(ur),Ar=0,Ie=gr=At=ur=void 0},Wn.flush=function(){return ur===void 0?kt:Rn(ev())},Wn},rv=function(_e,Ve,Oe){var Ie=!0,At=!0;if(typeof _e!="function")throw new TypeError("Expected a function");return Fi(Oe)&&(Ie="leading"in Oe?!!Oe.leading:Ie,At="trailing"in Oe?!!Oe.trailing:At),mM(_e,Ve,{leading:Ie,maxWait:Ve,trailing:At})},gM=function(_e,Ve,Oe){var Ie=-1,At=_e.length;Ve<0&&(Ve=-Ve>At?0:At+Ve),(Oe=Oe>At?At:Oe)<0&&(Oe+=At),At=Ve>Oe?0:Oe-Ve>>>0,Ve>>>=0;for(var nr=Array(At);++Ie<At;)nr[Ie]=_e[Ie+Ve];return nr},Cu=function(_e,Ve,Oe){if(!Fi(Oe))return!1;var Ie=typeof Ve;return!!(Ie=="number"?zp(Oe)&&Hd(Ve,Oe.length):Ie=="string"&&Ve in Oe)&&Rp(Oe[Ve],_e)},Oc=1/0,hM=function(_e){return _e?(_e=tv(_e))===Oc||_e===-1/0?17976931348623157e292*(_e<0?-1:1):_e==_e?_e:0:_e===0?_e:0},vM=function(_e){var Ve=hM(_e),Oe=Ve%1;return Ve==Ve?Oe?Ve-Oe:Ve:0},Cf=Math.ceil,yM=Math.max,dp,ku=function(_e,Ve,Oe){Ve=(Oe?Cu(_e,Ve,Oe):Ve===void 0)?1:yM(vM(Ve),0);var Ie=_e==null?0:_e.length;if(!Ie||Ve<1)return[];for(var At=0,nr=0,kt=Array(Cf(Ie/Ve));At<Ie;)kt[nr++]=gM(_e,At,At+=Ve);return kt};(function(pe){pe[pe.sub=1]="sub",pe[pe.unSub=2]="unSub"})(dp||(dp={}));var nv,bM=function(){function pe(Ve){var Oe=this;this.unreadCount={},this.autoSubscribeUnreadMap={},this.autoSubscribeServerMap={},this.autoSubscribeTypingMap={},this.unreadServerCount={},this.serverRoleIdsMap={},this._serverUnreadInfo=rv(function(Ie){Oe.core.emit("serverUnreadInfo",Oe.getServerUnreadInfo(Ie))},100),this.core=Ve}var _e=pe.prototype;return _e.changeCacheServerRoleIds=function(Oe){return Hr(this,void 0,void 0,wr.mark(function Ie(){var At,nr,kt,ur,gr,Ar,Rr,Ur=this;return wr.wrap(function(Jr){for(;;)switch(Jr.prev=Jr.next){case 0:if(nr=Oe.attach.serverIdentifyInfo,kt=nr.serverId,ur=nr.roleId,this.serverRoleIdsMap[kt]){Jr.next=4;break}return Jr.next=4,this.getRoleIdsByServerId([kt]);case 4:if(gr=this.serverRoleIdsMap[kt],!(Oe.time<gr.timeTag)){Jr.next=7;break}return Jr.abrupt("return");case 7:if(Oe.type===ga[ga.serverIdentifyAdd]?gr.roleIds.add(ur):gr.roleIds.delete(ur),this.core.logger.debug("QChatChannel::qchatChannel/serverIdentifyChange::now "+kt+" roleIds is",di(At=[]).call(At,gr.roleIds)),Ar=this.unreadServerCount[kt]){Jr.next=12;break}return Jr.abrupt("return");case 12:Rr=ku(Sa(Ar),100),Kn(Rr).call(Rr,function(Cn){Ur.core.qchatChannel.getChannelUnreadInfos({channels:Ao(Cn).call(Cn,function(Sn){return{serverId:kt,channelId:Sn}})})});case 14:case"end":return Jr.stop()}},Ie,this)}))},_e.getRoleIdsByServerId=function(Oe){return Hr(this,void 0,void 0,wr.mark(function Ie(){var At,nr,kt,ur,gr=this;return wr.wrap(function(Rr){for(;;)switch(Rr.prev=Rr.next){case 0:if((nr=bi(Oe).call(Oe,function(Ur){return!gr.serverRoleIdsMap[Ur]})).length){Rr.next=3;break}return Rr.abrupt("return");case 3:return kt={serverIdTimeTags:nr},Rr.next=6,this.core.sendCmd("qchatGetRoleIdsByServerId",{qchatGetRoleIdsByServerIdTag:kt});case 6:ur=Rr.sent,this.core.logger.debug("QChatChannel:: getRoleIdsByServerId, params is ",kt,"result is",ur),Kn(At=ur.content.serverRoles).call(At,function(Ur){try{Ur.roleIds=JSON.parse(Ur.roleIds)}catch(Dr){gr.core.logger.error("QChatChannel:: getRoleIdsByServerId JSON parse roleIds error",Dr)}gr.serverRoleIdsMap[Ur.serverId]={roleIds:new Mu(Ur.roleIds),timeTag:Ur.timeTag}});case 9:case"end":return Rr.stop()}},Ie,this)}))},_e._unSubscribeChannel=function(Oe,Ie){return Hr(this,void 0,void 0,wr.mark(function At(){var nr,kt;return wr.wrap(function(gr){for(;;)switch(gr.prev=gr.next){case 0:if(nr=Oe+"_"+Ie,kt=this.autoSubscribeUnreadMap[nr]){gr.next=4;break}return gr.abrupt("return");case 4:this.subscribe({opeType:dp.unSub,type:kt,channels:[{serverId:Oe,channelId:Ie}]}),this.autoSubscribeUnreadMap[nr]=void 0;case 6:case"end":return gr.stop()}},At,this)}))},_e.subscribe=function(Oe){return Hr(this,void 0,void 0,wr.mark(function Ie(){var At,nr,kt,ur,gr=this;return wr.wrap(function(Rr){for(;;)switch(Rr.prev=Rr.next){case 0:return On({type:{type:"number",min:1,max:5},opeType:{type:"number",min:1,max:2}},Oe),Rr.next=3,this.core.sendCmd("qchatSubscribe",{qchatSubReqTag:{type:Oe.type,opeType:Oe.opeType},channels:Oe.channels});case 3:return nr=Rr.sent,kt=new Mu,Kn(At=Oe.channels).call(At,function(Ur){return Hr(gr,void 0,void 0,wr.mark(function Dr(){return wr.wrap(function(Cn){for(;;)switch(Cn.prev=Cn.next){case 0:this.serverRoleIdsMap[Ur.serverId]||kt.add(Ur.serverId);case 1:case"end":return Cn.stop()}},Dr,this)}))}),ur=ku(Kc(kt),10),Kn(ur).call(ur,function(Ur){gr.getRoleIdsByServerId(Ur)}),Rr.abrupt("return",nr.content);case 9:case"end":return Rr.stop()}},Ie,this)}))},_e.resumeSubscribe=function(Oe){return Hr(this,void 0,void 0,wr.mark(function Ie(){var At,nr,kt,ur,gr,Ar,Rr,Ur=this;return wr.wrap(function(Jr){for(;;)switch(Jr.prev=Jr.next){case 0:if(this.serverRoleIdsMap={},this.unreadServerCount={},this.unreadCount={},gr=100,Oe.isAutoReconnect){Jr.next=6;break}return Jr.abrupt("return");case 6:return Ar={},Kn(At=Sa(this.autoSubscribeUnreadMap)).call(At,function(Cn){var Sn=Ur.autoSubscribeUnreadMap[Cn];if(Sn){var $n=Cn.split("_"),Rn={serverId:$n[0],channelId:$n[1]};Ar[Sn]=Ar[Sn]||[],Ar[Sn].push(Rn)}}),Ar[5]=[],Kn(nr=Sa(this.autoSubscribeTypingMap)).call(nr,function(Cn){return Hr(Ur,void 0,void 0,wr.mark(function Sn(){var $n,Rn,Wn,Fn;return wr.wrap(function(ao){for(;;)switch(ao.prev=ao.next){case 0:this.autoSubscribeTypingMap[Cn]&&($n=Cn.split("_"),Rn=$n[0],Wn=$n[1],Fn={serverId:Rn,channelId:Wn},Ar[5].push(Fn));case 2:case"end":return ao.stop()}},Sn,this)}))}),Ar[4]=[],Kn(kt=Sa(this.autoSubscribeServerMap)).call(kt,function(Cn){return Hr(Ur,void 0,void 0,wr.mark(function Sn(){var $n;return wr.wrap(function(Wn){for(;;)switch(Wn.prev=Wn.next){case 0:this.autoSubscribeServerMap[Cn]&&($n={serverId:Cn},Ar[4].push($n));case 2:case"end":return Wn.stop()}},Sn,this)}))}),Rr=[],Kn(ur=Sa(Ar)).call(ur,function(Cn){var Sn=Ar[Cn];if(Sn&&Sn.length===0)return wo.resolve();if(Sn.length>gr){var $n=ku(Sn,100);return Kn($n).call($n,function(Rn){Rr.push(Ur.createSubscribePromise(Rn,Cn))})}Rr.push(Ur.createSubscribePromise(Sn,Cn))}),Jr.next=16,wo.all(Rr);case 16:case"end":return Jr.stop()}},Ie,this)}))},_e.createSubscribePromise=function(Oe,Ie){var At=this,nr={type:Yo(Ie),opeType:1,channels:Oe};return this.core.logger.debug("qchatChannel:: autoSubscribeUnread params",nr),this.subscribe(nr).then(function(kt){var ur=kt.unreadInfos;ur&&ur.length>0&&(ur=ap(ur),At.cacheUnreadCount(ur))}).catch(function(kt){At.core.logger.error("qchatChannel:: autoSubscribeUnread error ",kt)})},_e.cacheSubscribe=function(Oe){var Ie,At=this;Kn(Ie=Oe.channels).call(Ie,function(nr){var kt=nr.channelId?nr.serverId+"_"+nr.channelId:""+nr.serverId,ur=Oe.type===5?At.autoSubscribeTypingMap:Oe.type===4?At.autoSubscribeServerMap:At.autoSubscribeUnreadMap;Oe.opeType===dp.sub?ur[kt]=Oe.type:Oe.opeType===dp.unSub&&(ur[kt]=void 0)})},_e.cacheUnreadCount=function(Oe){var Ie=this;Kn(Oe).call(Oe,function(At){var nr=At.serverId+"_"+At.channelId;Ie.unreadCount[nr]=jn({},At),Ie.unreadServerCount[At.serverId]||(Ie.unreadServerCount[At.serverId]={}),Ie.unreadServerCount[At.serverId][At.channelId]=!0})},_e.getServerUnreadInfo=function(Oe){var Ie,At=this,nr={serverId:Oe,unreadCount:0,mentionedCount:0,maxCount:0},kt=this.unreadServerCount[Oe];return kt&&(Kn(Ie=Sa(kt)).call(Ie,function(ur){var gr=Oe+"_"+ur,Ar=At.unreadCount[gr];nr.unreadCount+=Ar.unreadCount,nr.mentionedCount+=Ar.mentionedCount,Ar.maxCount!==void 0&&(nr.maxCount=Ar.maxCount)}),nr.unreadCount=nr.unreadCount>nr.maxCount?nr.maxCount:nr.unreadCount,nr.mentionedCount=nr.mentionedCount>nr.maxCount?nr.maxCount:nr.mentionedCount),nr},_e.getUnreadInfo=function(Oe){On({serverId:{type:"string"},channelId:{type:"string"}},Oe);var Ie=Oe.serverId+"_"+Oe.channelId;return this.unreadCount[Ie]?this.unreadCount[Ie]:null},_e.shouldChangeUnread=function(Oe,Ie){if(!Oe.serverId||!Oe.channelId||this.core.qchatChannel.subscribeForVisitorService.isInSubscribeChannels(Oe.serverId,Oe.channelId)||Oe.historyEnable===!1||Oe.needBadge===!1||Oe.fromAccount===this.core.account||Ie&&(Oe==null?void 0:Oe.status)!==2)return!1;if(Oe.notifyReason&&Oe.notifyReason===ay(up,up.notifySubscribe)){if(!Oe.serverId||!Oe.channelId)return!1;var At=this.getUnreadInfo({serverId:Oe.serverId,channelId:Oe.channelId}),nr=Ie?"ackTimestamp":"lastMsgTime";if(!At||Oe.time&&At[nr]&&At[nr]>Oe.time)return!1}return!0},_e.shouldChangeMentionedUnread=function(Oe,Ie){return Ie===void 0&&(Ie=!1),Hr(this,void 0,void 0,wr.mark(function At(){var nr,kt;return wr.wrap(function(gr){for(;;)switch(gr.prev=gr.next){case 0:if(!Oe.accidsOfMentionedRoles||!Li(nr=Oe.accidsOfMentionedRoles).call(nr,this.core.account)){gr.next=2;break}return gr.abrupt("return",!0);case 2:if(!Oe.mentionRoleIds||!Oe.serverId){gr.next=16;break}if(this.serverRoleIdsMap[Oe.serverId]){gr.next=9;break}if(Ie){gr.next=7;break}return this.handledRoleMsg(Oe),gr.abrupt("return",!1);case 7:return gr.next=9,this.getRoleIdsByServerId([Oe.serverId]);case 9:kt=0;case 10:if(!(kt<Oe.mentionRoleIds.length)){gr.next=16;break}if(!this.serverRoleIdsMap[Oe.serverId].roleIds.has(Oe.mentionRoleIds[kt])){gr.next=13;break}return gr.abrupt("return",!0);case 13:kt++,gr.next=10;break;case 16:return gr.abrupt("return",!1);case 17:case"end":return gr.stop()}},At,this)}))},_e.handledRoleMsg=function(Oe){return Hr(this,void 0,void 0,wr.mark(function Ie(){var At,nr,kt,ur,gr,Ar=this;return wr.wrap(function(Ur){for(;;)switch(Ur.prev=Ur.next){case 0:if(Oe.mentionRoleIds){Ur.next=2;break}return Ur.abrupt("return");case 2:if(this.serverRoleIdsMap[Oe.serverId]){Ur.next=5;break}return Ur.next=5,this.getRoleIdsByServerId([Oe.serverId]);case 5:if(this.serverRoleIdsMap[Oe.serverId]){Ur.next=8;break}return this.core.logger.warn("QChatChannel::handledRoleMsg::can not get serverRoleIds,server id",Oe.serverId),Ur.abrupt("return");case 8:if(nr=!1,Kn(At=Oe.mentionRoleIds).call(At,function(Dr){Ar.serverRoleIdsMap[Oe.serverId].roleIds.has(Dr)&&(nr=!0,Ar.core.logger.debug("QChatChannel::handledRoleMsg::will update message mentionedCount，message is ",Oe))}),nr){Ur.next=12;break}return Ur.abrupt("return");case 12:if(kt=this.unreadCount[Oe.serverId+"_"+Oe.channelId],ur=(Oe==null?void 0:Oe.status)===2,kt.mentionedCount=ur?kt.mentionedCount?kt.mentionedCount-1:0:kt.mentionedCount?kt.mentionedCount+1:1,typeof kt.maxCount!="number"){Ur.next=24;break}if(!((gr=(gr=kt.mentionedCount)>kt.maxCount?kt.maxCount:gr)>kt.maxCount)){Ur.next=21;break}return this.core.logger.debug("QChatChannel::handledRoleMsg::tempUnreadCount more than maxCount"),Ur.abrupt("return");case 21:this.core.emit("unreadInfo",jn(jn({},kt),{mentionedCount:gr})),this.core.emit("unreadInfos",[jn(jn({},kt),{mentionedCount:gr})]),this._serverUnreadInfo(Oe.serverId);case 24:case"end":return Ur.stop()}},Ie,this)}))},_e.getMentionedFlag=function(Oe,Ie){return Ie===void 0&&(Ie=!1),Hr(this,void 0,void 0,wr.mark(function At(){var nr;return wr.wrap(function(ur){for(;;)switch(ur.prev=ur.next){case 0:if(!Oe.mentionAll){ur.next=4;break}return ur.abrupt("return",!0);case 4:if(!Oe.mentionRoleIds&&!Oe.accidsOfMentionedRoles){ur.next=10;break}return ur.next=7,this.shouldChangeMentionedUnread(Oe,Ie);case 7:return ur.abrupt("return",ur.sent);case 10:if(!Oe.mentionAccids||!Li(nr=Oe.mentionAccids).call(nr,this.core.account)){ur.next=12;break}return ur.abrupt("return",!0);case 12:return ur.abrupt("return",!1);case 13:case"end":return ur.stop()}},At,this)}))},_e.changeUnread=function(Oe,Ie){return Hr(this,void 0,void 0,wr.mark(function At(){var nr,kt,ur,gr,Ar,Rr,Ur;return wr.wrap(function(Jr){for(;;)switch(Jr.prev=Jr.next){case 0:if(nr=Oe.serverId,kt=Oe.channelId,ur=nr+"_"+kt,this.shouldChangeUnread(Oe,Ie)){Jr.next=6;break}return this.core.logger.debug("changeUnread: "+ur+" does not need to update unreadInfo"),Jr.abrupt("return");case 6:if(this.unreadCount[ur]){Jr.next=11;break}return Jr.next=9,this.core.qchatChannel.getChannelUnreadInfos({channels:[{serverId:nr,channelId:kt}]});case 9:return!this.serverRoleIdsMap[nr]&&Oe.mentionRoleIds&&this.getRoleIdsByServerId([nr]),Jr.abrupt("return");case 11:return gr=this.unreadCount[ur],Ar=(Oe==null?void 0:Oe.status)===2,Jr.next=15,this.getMentionedFlag(Oe);case 15:if(Rr=Jr.sent,Ar?(gr.unreadCount=gr.unreadCount?gr.unreadCount-1:0,Rr&&(gr.mentionedCount=gr.mentionedCount?gr.mentionedCount-1:0),delete gr.lastMsgTime,this.core.logger.debug("changeUnread: "+ur+" unread reduce ",gr)):(gr.unreadCount=gr.unreadCount?gr.unreadCount+1:1,Rr&&(gr.mentionedCount=gr.mentionedCount?gr.mentionedCount+1:1),Oe.time&&(gr.lastMsgTime=Oe.time),this.core.logger.debug("changeUnread: "+ur+" unread add ",gr)),Ur=typeof gr.maxCount=="number"?gr.maxCount:100,!(gr.unreadCount>Ur)){Jr.next=21;break}return this.core.logger.debug("QChatChannel::subscribe::tempUnreadCount more than maxCount"),Jr.abrupt("return");case 21:this.core.logger.warn("unreadInfo event will abandon,please use unreadInfos"),this.core.emit("unreadInfo",jn(jn({},gr),{mentionedCount:gr.mentionedCount>Ur?Ur:gr.mentionedCount,unreadCount:gr.unreadCount>Ur?Ur:gr.unreadCount})),this.core.emit("unreadInfos",[jn(jn({},gr),{mentionedCount:gr.mentionedCount>Ur?Ur:gr.mentionedCount,unreadCount:gr.unreadCount>Ur?Ur:gr.unreadCount})]),this._serverUnreadInfo(nr);case 25:case"end":return Jr.stop()}},At,this)}))},_e.updateUnreads=function(Oe){var Ie,At=this;if(Oe&&Oe.length>0){var nr=this.getServerUnreadInfo(Oe[0].serverId),kt=this.unreadServerCount[Oe[0].serverId],ur=Ao(Ie=bi(Oe).call(Oe,function(Cn){var Sn=Cn.serverId+"_"+Cn.channelId,$n=At.unreadCount[Sn],Rn=ms($n,"ackTimestamp"),Wn=ms(Cn,"ackTimestamp");return!(Rn&&Wn&&Wn<Rn)&&(ms($n,"unreadCount")!==ms(Cn,"unreadCount")||ms($n,"mentionedCount")!==ms(Cn,"mentionedCount"))})).call(Ie,function(Cn){var Sn=Cn.serverId,$n=Cn.channelId,Rn=Sn+"_"+$n;return At.core.logger.debug("qchat channel updateUnread: ",Cn),At.unreadCount[Rn]=jn({},Cn),At.unreadServerCount[Sn]||(At.unreadServerCount[Sn]={}),At.unreadServerCount[Sn][$n]=!0,Cn});if(ur.length>0){this.core.emit("unreadInfos",ur);var gr=this.getServerUnreadInfo(Oe[0].serverId),Ar=this.unreadServerCount[Oe[0].serverId],Rr=nr.unreadCount!==gr.unreadCount,Ur=!kt||Sa(kt).length===0,Dr=Ar&&Sa(Ar).length>0,Jr=nr.mentionedCount!==gr.mentionedCount;(Rr||Jr||Ur&&Dr)&&this._serverUnreadInfo(ur[0].serverId)}Kn(ur).call(ur,function(Cn){At.core.emit("unreadInfo",Cn)})}},_e.clearUnreadCountByServers=function(Oe,Ie){var At=this,nr=[];Kn(Oe).call(Oe,function(ur){var gr;At.unreadServerCount[ur]&&Kn(gr=Sa(At.unreadServerCount[ur])).call(gr,function(Ar){nr.push(ur+"_"+Ar)})});var kt=[];Kn(nr).call(nr,function(ur){kt.push(jn(jn({},At.unreadCount[ur]),{unreadCount:0,mentionedCount:0,ackTimestamp:Ie}))}),this.updateUnreads(kt)},pe}(),TM=function(){function pe(Ve){this.limitForBatchEnter=10,this.limitForBatchSubscribe=100,this.autoServers=new Mu,this.autoVisitorSubscribeServer=new Mu,this.autoVisitorSubscribeChannel=new Mu,this.core=Ve}var _e=pe.prototype;return _e.subscribeChannelAsVisitor=function(Oe){return Hr(this,void 0,void 0,wr.mark(function Ie(){var At,nr,kt,ur,gr=this;return wr.wrap(function(Rr){for(;;)switch(Rr.prev=Rr.next){case 0:return Rr.next=2,this.core.sendCmd("qchatSubscribeAsVisitor",{tag:{type:Oe.type||6,opeType:Oe.opeType},datas:Oe.channels});case 2:return nr=Rr.sent,kt=nr.content.failedArr,ur=bi(At=Oe.channels).call(At,function(Ur){return!nf(kt).call(kt,function(Dr){return Dr.channelId===Ur.channelId&&Dr.serverId===Ur.serverId})}),Kn(ur).call(ur,function(Ur){Oe.opeType===1?gr.autoVisitorSubscribeChannel.add(Ur.serverId+"&"+Ur.channelId):gr.autoVisitorSubscribeChannel.delete(Ur.serverId+"&"+Ur.channelId)}),Rr.abrupt("return",{failedChannels:kt});case 7:case"end":return Rr.stop()}},Ie,this)}))},_e.subscribeServerAsVisitor=function(Oe){return Hr(this,void 0,void 0,wr.mark(function Ie(){var At,nr,kt,ur,gr,Ar,Rr=this;return wr.wrap(function(Dr){for(;;)switch(Dr.prev=Dr.next){case 0:return Dr.next=2,this.core.sendCmd("qchatSubscribeAsVisitor",{tag:{type:Oe.type||7,opeType:Oe.opeType},datas:Ao(At=Oe.serverIds).call(At,function(Jr){return{serverId:Jr}})});case 2:return ur=Dr.sent,gr=ur.content.failedArr,Ar=bi(nr=Oe.serverIds).call(nr,function(Jr){return!nf(gr).call(gr,function(Cn){return Cn.serverId===Jr})}),Kn(Ar).call(Ar,function(Jr){Oe.opeType===1?Rr.autoVisitorSubscribeServer.add(Jr):Rr.autoVisitorSubscribeServer.delete(Jr)}),Dr.abrupt("return",{failedServers:Ao(kt=ur.content.failedArr).call(kt,function(Jr){return Jr.serverId})});case 7:case"end":return Dr.stop()}},Ie,this)}))},_e.deleteServer=function(Oe){var Ie;this.autoServers.delete(Oe),this.autoVisitorSubscribeServer.has(Oe)&&this.subscribeServerAsVisitor({opeType:2,serverIds:[Oe]});var At=[];Kn(Ie=this.autoVisitorSubscribeChannel).call(Ie,function(nr){if(Na(nr).call(nr,Oe)===0){var kt=nr.replace(Oe+"&","");At.push({serverId:Oe,channelId:kt})}}),At.length>0&&this.subscribeChannelAsVisitor({opeType:2,channels:At})},_e.deleteAutoSetInServerId=function(Oe){var Ie,At=this;this.autoServers.delete(Oe),this.autoVisitorSubscribeServer.delete(Oe),Kn(Ie=this.autoVisitorSubscribeChannel).call(Ie,function(nr){Na(nr).call(nr,Oe)===0&&At.autoVisitorSubscribeChannel.delete(nr)})},_e.deleteAutoSetInChannel=function(Oe,Ie){this.autoVisitorSubscribeChannel.delete(Oe+"&"+Ie)},_e.unSubscribeChannel=function(Oe,Ie){this.subscribeChannelAsVisitor({opeType:2,channels:[{serverId:Oe,channelId:Ie}]})},_e.isInSubscribeChannels=function(Oe,Ie){return this.autoVisitorSubscribeChannel.has(Oe+"&"+Ie)},_e.isInAutoServers=function(Oe){return this.autoServers.has(Oe)},_e.doAutoSubscribe=function(){var Oe=this,Ie=[],At=ku(Kc(this.autoVisitorSubscribeServer),this.limitForBatchSubscribe);Kn(At).call(At,function(kt){Ie.push(Oe.subscribeServerAsVisitor({opeType:1,serverIds:kt}))});var nr=ku(Kc(this.autoVisitorSubscribeChannel),this.limitForBatchSubscribe);return Kn(nr).call(nr,function(kt){Ie.push(Oe.subscribeChannelAsVisitor({opeType:1,channels:Ao(kt).call(kt,function(ur){var gr=Na(ur).call(ur,"&");return{serverId:Fo(ur).call(ur,0,gr),channelId:Fo(ur).call(ur,gr+1)}})}))}),wo.all(Ie)},_e.doAutoEnterServer=function(){return Hr(this,void 0,void 0,wr.mark(function Oe(){var Ie,At,nr,kt=this;return wr.wrap(function(gr){for(;;)switch(gr.prev=gr.next){case 0:return Ie=ku(Kc(this.autoServers),this.limitForBatchEnter),At=[],Kn(Ie).call(Ie,function(Ar){At.push(kt.core.qchatServer.enterAsVisitor({serverIds:Ar}))}),gr.next=5,wo.all(At);case 5:nr=gr.sent,Kn(nr).call(nr,function(Ar){var Rr;Kn(Rr=Ar.failedServers).call(Rr,function(Ur){kt.deleteAutoSetInServerId(Ur)})});case 7:case"end":return gr.stop()}},Oe,this)}))},_e.resumeSubscribe=function(Oe){return Hr(this,void 0,void 0,wr.mark(function Ie(){return wr.wrap(function(nr){for(;;)switch(nr.prev=nr.next){case 0:if(!Oe.isAutoReconnect){nr.next=7;break}return nr.next=3,this.doAutoEnterServer();case 3:return nr.next=5,this.doAutoSubscribe();case 5:nr.next=10;break;case 7:this.autoServers.clear(),this.autoVisitorSubscribeChannel.clear(),this.autoVisitorSubscribeServer.clear();case 10:case"end":return nr.stop()}},Ie,this)}))},_e.cacheServer=function(Oe){var Ie=this;Kn(Oe).call(Oe,function(At){return Ie.autoServers.add(At)})},pe}();(function(pe){pe[pe.sub=1]="sub",pe[pe.unSub=2]="unSub"})(nv||(nv={}));var SM=function(pe){function _e(Oe){var Ie,At,nr,kt,ur,gr;return(gr=pe.call(this,"qchatChannel",Oe)||this).core=Oe,Zi({cmdMap:Xd,cmdConfig:Wh}),gr.subscribeModuleService=new bM(Oe),gr.subscribeForVisitorService=new TM(Oe),gr.core.eventBus.on("qchatChannel/changeUnread",Go(Ie=gr.subscribeModuleService.changeUnread).call(Ie,gr.subscribeModuleService)),gr.core.eventBus.on("qchatChannel/updateUnreads",Go(At=gr.subscribeModuleService.updateUnreads).call(At,gr.subscribeModuleService)),gr.core.eventBus.on("qchatChannel/cacheSubscribe",Go(nr=gr.subscribeModuleService.cacheSubscribe).call(nr,gr.subscribeModuleService)),gr.core.eventBus.on("qchatChannel/clearUnreadCountByServers",Go(kt=gr.subscribeModuleService.clearUnreadCountByServers).call(kt,gr.subscribeModuleService)),gr.core.eventBus.on("qchatChannel/getRoleIdsByServerId",Go(ur=gr.subscribeModuleService.getRoleIdsByServerId).call(ur,gr.subscribeModuleService)),gr.core.eventBus.on("logined",function(Ar){gr.subscribeModuleService.resumeSubscribe(Ar),gr.subscribeForVisitorService.resumeSubscribe(Ar)}),gr.core.eventBus.on("qchatChannel/autoUnSubscribe",function(Ar){if(gr.logger.log("QChatChannel::enter autoUnSubscribe sysMsg is",Ar),Ar.type===ga[ga.channelVisibilityUpdate])gr.logger.log("QChatChannel::begin autoUnSubscribe channel key is",Ar.serverId+"_"+Ar.channelId),gr.subscribeModuleService._unSubscribeChannel(Ar.serverId,Ar.channelId),gr.logger.log("QChatChannel::autoUnSubscribe channel done key is",Ar.serverId+"_"+Ar.channelId);else if(Ar.type===ga[ga.serverEnterLeave]){var Rr;gr.subscribeModuleService.autoSubscribeServerMap[Ar.serverId]&&(gr.logger.log("QChatChannel::begin autoUnSubscribe server key is",Ar.serverId),gr.subscribeModuleService.subscribe({type:4,opeType:nv.unSub,channels:[{serverId:Ar.serverId,channelId:""}]}),gr.logger.log("QChatChannel::autoUnSubscribe server done key is",Ar.serverId));var Ur=gr.subscribeModuleService.unreadServerCount[Ar.serverId];if(!Ur)return;gr.logger.log("QChatChannel::begin autoUnSubscribe channels key is",Sa(Ur)),Kn(Rr=Sa(Ur)).call(Rr,function(Dr){gr.subscribeModuleService._unSubscribeChannel(Ar.serverId,Dr)}),gr.logger.log("QChatChannel::autoUnSubscribe channels done key is",Sa(Ur))}}),gr.core.eventBus.on("qchatChannel/serverIdentifyChange",function(Ar){gr.subscribeModuleService.changeCacheServerRoleIds(Ar)}),gr}Ko(_e,pe);var Ve=_e.prototype;return Ve.createChannel=function(Ie){return Hr(this,void 0,void 0,wr.mark(function At(){var nr;return wr.wrap(function(ur){for(;;)switch(ur.prev=ur.next){case 0:return On({serverId:{type:"string",min:1},type:{type:"enum",values:xa(jl)},name:{type:"string",required:!1},topic:{type:"string",required:!1},ext:{type:"string",required:!1},visitorMode:{type:"number",required:!1}},Ie),ur.next=3,this.core.sendCmd("qchatCreateChannel",{channelInfo:jn(jn({},Ie),{type:jl[Ie.type]}),antispamTag:Zc(Ie)});case 3:return nr=ur.sent,ur.abrupt("return",np(nr.content.channelInfo));case 5:case"end":return ur.stop()}},At,this)}))},Ve.deleteChannel=function(Ie){return Hr(this,void 0,void 0,wr.mark(function At(){return wr.wrap(function(kt){for(;;)switch(kt.prev=kt.next){case 0:return On({channelId:{type:"string",allowEmpty:!1}},Ie),kt.next=3,this.core.sendCmd("qchatDeleteChannel",Ie);case 3:case"end":return kt.stop()}},At,this)}))},Ve.updateChannel=function(Ie){return Hr(this,void 0,void 0,wr.mark(function At(){var nr,kt;return wr.wrap(function(gr){for(;;)switch(gr.prev=gr.next){case 0:return On({channelId:{type:"string",min:1},serverId:{type:"string",required:!1},type:{type:"enum",values:xa(jl),required:!1},name:{type:"string",required:!1},topic:{type:"string",required:!1},ext:{type:"string",required:!1},visitorMode:{type:"number",required:!1}},Ie),nr=Ie,Ie.type&&(nr.type=jl[Ie.type]),gr.next=5,this.core.sendCmd("qchatUpdateChannel",{channelInfo:nr,antispamTag:Zc(Ie)});case 5:return kt=gr.sent,gr.abrupt("return",np(kt.content.channelInfo));case 7:case"end":return gr.stop()}},At,this)}))},Ve.getChannels=function(Ie){return Hr(this,void 0,void 0,wr.mark(function At(){var nr;return wr.wrap(function(ur){for(;;)switch(ur.prev=ur.next){case 0:return On({channelIds:{type:"array",itemType:"string",min:1}},Ie),ur.next=3,this.core.sendCmd("qchatGetChannels",Ie);case 3:return nr=ur.sent,ur.abrupt("return",op(nr.content.channelList));case 5:case"end":return ur.stop()}},At,this)}))},Ve.getChannelsByPage=function(Ie){return Hr(this,void 0,void 0,wr.mark(function At(){var nr,kt,ur,gr;return wr.wrap(function(Rr){for(;;)switch(Rr.prev=Rr.next){case 0:return On({serverId:{type:"string",min:1},timetag:{type:"number"},limit:{type:"number",min:1,required:!1}},Ie),Rr.next=3,this.core.sendCmd("qchatGetChannelsByPage",{qchatGetChannelListPageTag:jn({limit:100},Ie)});case 3:return nr=Rr.sent,kt=nr.content,ur=kt.datas,gr=kt.listQueryTag,Rr.abrupt("return",{listQueryTag:{hasMore:+gr.hasMore==1,nextTimetag:Yo(gr.nextTimetag)},datas:op(ur)});case 6:case"end":return Rr.stop()}},At,this)}))},Ve.getMembersByPage=function(Ie){return Hr(this,void 0,void 0,wr.mark(function At(){var nr,kt,ur,gr;return wr.wrap(function(Rr){for(;;)switch(Rr.prev=Rr.next){case 0:return On({serverId:{type:"string",min:1},channelId:{type:"string",min:1},timetag:{type:"number"},limit:{type:"number",min:1,required:!1}},Ie),Rr.next=3,this.core.sendCmd("qchatGetMembersByPage",{qchatGetMembersByPageTag:Ie});case 3:return nr=Rr.sent,kt=nr.content,ur=kt.datas,gr=kt.listQueryTag,Rr.abrupt("return",{listQueryTag:{hasMore:+gr.hasMore==1,nextTimetag:Yo(gr.nextTimetag)},datas:Ac(ur)});case 6:case"end":return Rr.stop()}},At,this)}))},Ve.updateWhiteBlackRole=function(Ie){return Hr(this,void 0,void 0,wr.mark(function At(){return wr.wrap(function(kt){for(;;)switch(kt.prev=kt.next){case 0:return On({serverId:{type:"string",min:1},channelId:{type:"string",min:1},roleId:{type:"string",min:1},type:{type:"enum",values:xa(Ia)},opeType:{type:"enum",values:xa(Mi)}},Ie),kt.next=3,this.core.sendCmd("qchatUpdateWhiteBlackRole",{qchatUpdateWhiteBlackRoleTag:jn(jn({},Ie),{type:Ia[Ie.type],opeType:Mi[Ie.opeType]})});case 3:case"end":return kt.stop()}},At,this)}))},Ve.getWhiteBlackRolesPage=function(Ie){return Hr(this,void 0,void 0,wr.mark(function At(){var nr,kt,ur,gr;return wr.wrap(function(Rr){for(;;)switch(Rr.prev=Rr.next){case 0:return On({serverId:{type:"string",min:1},channelId:{type:"string",min:1},type:{type:"enum",values:xa(Ia)},timetag:{type:"number"},limit:{type:"number",min:1,required:!1}},Ie),Rr.next=3,this.core.sendCmd("qchatGetWhiteBlackRolesPage",{qchatGetWhiteBlackRolesPageTag:jn(jn({},Ie),{type:Ia[Ie.type]})});case 3:return nr=Rr.sent,kt=nr.content,ur=kt.datas,gr=kt.listQueryTag,Rr.abrupt("return",{listQueryTag:{hasMore:+gr.hasMore==1,nextTimetag:Yo(gr.nextTimetag)},datas:mi(ur)});case 6:case"end":return Rr.stop()}},At,this)}))},Ve.updateWhiteBlackMembers=function(Ie){return Hr(this,void 0,void 0,wr.mark(function At(){return wr.wrap(function(kt){for(;;)switch(kt.prev=kt.next){case 0:return On({serverId:{type:"string",min:1},channelId:{type:"string",min:1},type:{type:"enum",values:xa(Ia)},opeType:{type:"enum",values:xa(Mi)},toAccids:{type:"array",itemType:"string",min:1}},Ie),kt.next=3,this.core.sendCmd("qchatUpdateWhiteBlackMembers",{qchatUpdateWhiteBlackMembersTag:jn(jn({},Ie),{type:Ia[Ie.type],opeType:Mi[Ie.opeType],toAccids:Eo(Ie.toAccids)})});case 3:case"end":return kt.stop()}},At,this)}))},Ve.getWhiteBlackMembersPage=function(Ie){return Hr(this,void 0,void 0,wr.mark(function At(){var nr,kt,ur,gr;return wr.wrap(function(Rr){for(;;)switch(Rr.prev=Rr.next){case 0:return On({serverId:{type:"string",min:1},channelId:{type:"string",min:1},type:{type:"enum",values:xa(Ia)},timetag:{type:"number"},limit:{type:"number",min:1,required:!1}},Ie),Rr.next=3,this.core.sendCmd("qchatGetWhiteBlackMembersPage",{qchatGetWhiteBlackMembersPageTag:jn(jn({limit:100},Ie),{type:Ia[Ie.type]})});case 3:return nr=Rr.sent,kt=nr.content,ur=kt.datas,gr=kt.listQueryTag,Rr.abrupt("return",{listQueryTag:{hasMore:+gr.hasMore==1,nextTimetag:Yo(gr.nextTimetag)},datas:Ac(ur)});case 6:case"end":return Rr.stop()}},At,this)}))},Ve.getExistingWhiteBlackRoles=function(Ie){return Hr(this,void 0,void 0,wr.mark(function At(){var nr,kt;return wr.wrap(function(gr){for(;;)switch(gr.prev=gr.next){case 0:return On({serverId:{type:"string",min:1},channelId:{type:"string",min:1},type:{type:"enum",values:xa(Ia)},roleIds:{type:"array",itemType:"string",min:1}},Ie),gr.next=3,this.core.sendCmd("qchatGetExistingWhiteBlackRoles",{qchatGetExistingWhiteBlackRolesTag:jn(jn({},Ie),{type:Ia[Ie.type],roleIds:Eo(Ie.roleIds)})});case 3:return nr=gr.sent,kt=nr.content.datas,gr.abrupt("return",{datas:mi(kt)});case 6:case"end":return gr.stop()}},At,this)}))},Ve.getExistingWhiteBlackMembers=function(Ie){return Hr(this,void 0,void 0,wr.mark(function At(){var nr,kt;return wr.wrap(function(gr){for(;;)switch(gr.prev=gr.next){case 0:return On({serverId:{type:"string",min:1},channelId:{type:"string",min:1},type:{type:"enum",values:xa(Ia)},accids:{type:"array",itemType:"string",min:1}},Ie),gr.next=3,this.core.sendCmd("qchatGetExistingWhiteBlackMembers",{qchatGetExistingWhiteBlackMembersTag:jn(jn({},Ie),{type:Ia[Ie.type],accids:Eo(Ie.accids)})});case 3:return nr=gr.sent,kt=nr.content.datas,gr.abrupt("return",{datas:Ac(kt)});case 6:case"end":return gr.stop()}},At,this)}))},Ve.updateCategoryInfoOfChannel=function(Ie){return Hr(this,void 0,void 0,wr.mark(function At(){var nr;return wr.wrap(function(ur){for(;;)switch(ur.prev=ur.next){case 0:return On({channelId:{type:"string",min:1},categoryId:{type:"string",allowEmpty:!1,required:!1},syncMode:{type:"number",min:0,max:1,required:!1}},Ie),ur.next=3,this.core.sendCmd("qchatUpdateCategoryInfoOfChannel",{qchatUpdateCategoryInfoOfChannelTag:Ie});case 3:return nr=ur.sent,ur.abrupt("return",np(nr.content.channelInfo));case 5:case"end":return ur.stop()}},At,this)}))},Ve.createChannelCategory=function(Ie){return Hr(this,void 0,void 0,wr.mark(function At(){var nr;return wr.wrap(function(ur){for(;;)switch(ur.prev=ur.next){case 0:return On({serverId:{type:"string",allowEmpty:!1},name:{type:"string",allowEmpty:!1,required:!1},ext:{type:"string",required:!1},viewMode:{type:"number",min:0,max:1,required:!1}},Ie),ur.next=3,this.core.sendCmd("qchatCreateChannelCategory",{qchatCreateChannelCategoryTag:Ie});case 3:return nr=ur.sent,ur.abrupt("return",sp(nr.content.QChatChannelCategoryInfo));case 5:case"end":return ur.stop()}},At,this)}))},Ve.removeChannelCategory=function(Ie){return Hr(this,void 0,void 0,wr.mark(function At(){return wr.wrap(function(kt){for(;;)switch(kt.prev=kt.next){case 0:return On({categoryId:{type:"string",allowEmpty:!1}},Ie),kt.next=3,this.core.sendCmd("qchatRemoveChannelCategory",Ie);case 3:case"end":return kt.stop()}},At,this)}))},Ve.updateChannelCategory=function(Ie){return Hr(this,void 0,void 0,wr.mark(function At(){var nr;return wr.wrap(function(ur){for(;;)switch(ur.prev=ur.next){case 0:return On({categoryId:{type:"string",allowEmpty:!1},name:{type:"string",allowEmpty:!1,required:!1},ext:{type:"string",required:!1},viewMode:{type:"number",min:0,max:1,required:!1}},Ie),ur.next=3,this.core.sendCmd("qchatUpdateChannelCategory",{qchatUpdateChannelCategoryTag:Ie});case 3:return nr=ur.sent,ur.abrupt("return",sp(nr.content.QChatChannelCategoryInfo));case 5:case"end":return ur.stop()}},At,this)}))},Ve.getChannelCategoriesByID=function(Ie){return Hr(this,void 0,void 0,wr.mark(function At(){var nr;return wr.wrap(function(ur){for(;;)switch(ur.prev=ur.next){case 0:return On({categoryIds:{type:"array",itemType:"string",min:1}},Ie),ur.next=3,this.core.sendCmd("qchatGetChannelCategoriesByID",Ie);case 3:return nr=ur.sent,ur.abrupt("return",Jh(nr.content.channelCategoryList));case 5:case"end":return ur.stop()}},At,this)}))},Ve.updateChannelCategoryWhiteBlackRole=function(Ie){return Hr(this,void 0,void 0,wr.mark(function At(){return wr.wrap(function(kt){for(;;)switch(kt.prev=kt.next){case 0:return On({categoryId:{type:"string",allowEmpty:!1},serverId:{type:"string",allowEmpty:!1},type:{type:"enum",values:xa(Ia)},opeType:{type:"enum",values:xa(Mi)},roleId:{type:"string",allowEmpty:!1}},Ie),kt.next=3,this.core.sendCmd("qchatUpdateChannelCategoryWhiteBlackRole",{qchatUpdateChannelCategoryWhiteBlackRoleTag:jn(jn({},Ie),{type:Ia[Ie.type],opeType:Mi[Ie.opeType]})});case 3:case"end":return kt.stop()}},At,this)}))},Ve.getChannelCategoryWhiteBlackRolesPage=function(Ie){return Hr(this,void 0,void 0,wr.mark(function At(){var nr,kt,ur,gr;return wr.wrap(function(Rr){for(;;)switch(Rr.prev=Rr.next){case 0:return On({categoryId:{type:"string",allowEmpty:!1},serverId:{type:"string",allowEmpty:!1},type:{type:"enum",values:xa(Ia)},timetag:{type:"number",min:0},limit:{type:"number",min:1,required:!1}},Ie),Rr.next=3,this.core.sendCmd("qchatGetChannelCategoryWhiteBlackRolesPage",{qchatGetChannelCategoryWhiteBlackRolesPageTag:jn(jn({},Ie),{type:Ia[Ie.type]})});case 3:return nr=Rr.sent,kt=nr.content,ur=kt.datas,gr=kt.listQueryTag,Rr.abrupt("return",{listQueryTag:{hasMore:+gr.hasMore==1,nextTimetag:Yo(gr.nextTimetag)},datas:mi(ur)});case 6:case"end":return Rr.stop()}},At,this)}))},Ve.updateChannelCategoryWhiteBlackMembers=function(Ie){return Hr(this,void 0,void 0,wr.mark(function At(){return wr.wrap(function(kt){for(;;)switch(kt.prev=kt.next){case 0:return On({categoryId:{type:"string",allowEmpty:!1},serverId:{type:"string",allowEmpty:!1},type:{type:"enum",values:xa(Ia)},opeType:{type:"enum",values:xa(Mi)},toAccids:{type:"array",itemType:"string",min:1}},Ie),kt.next=3,this.core.sendCmd("qchatUpdateChannelCategoryWhiteBlackMembers",{qchatUpdateChannelCategoryWhiteBlackMembersTag:jn(jn({},Ie),{type:Ia[Ie.type],opeType:Mi[Ie.opeType],toAccids:Eo(Ie.toAccids)})});case 3:case"end":return kt.stop()}},At,this)}))},Ve.getChannelCategoryWhiteBlackMembersPage=function(Ie){return Hr(this,void 0,void 0,wr.mark(function At(){var nr,kt,ur,gr;return wr.wrap(function(Rr){for(;;)switch(Rr.prev=Rr.next){case 0:return On({categoryId:{type:"string",allowEmpty:!1},serverId:{type:"string",allowEmpty:!1},type:{type:"enum",values:xa(Ia)},timetag:{type:"number",min:0},limit:{type:"number",min:1,required:!1}},Ie),Rr.next=3,this.core.sendCmd("qchatGetChannelCategoryWhiteBlackMembersPage",{qchatGetChannelCategoryWhiteBlackMembersPageTag:jn(jn({},Ie),{type:Ia[Ie.type]})});case 3:return nr=Rr.sent,kt=nr.content,ur=kt.datas,gr=kt.listQueryTag,Rr.abrupt("return",{listQueryTag:{hasMore:+gr.hasMore==1,nextTimetag:Yo(gr.nextTimetag)},datas:Ac(ur)});case 6:case"end":return Rr.stop()}},At,this)}))},Ve.getChannelCategoryWhiteBlackRoles=function(Ie){return Hr(this,void 0,void 0,wr.mark(function At(){var nr,kt;return wr.wrap(function(gr){for(;;)switch(gr.prev=gr.next){case 0:return On({categoryId:{type:"string",allowEmpty:!1},serverId:{type:"string",allowEmpty:!1},type:{type:"enum",values:xa(Ia)},roleIds:{type:"array",itemType:"string",min:1}},Ie),gr.next=3,this.core.sendCmd("qchatGetChannelCategoryWhiteBlackRoles",{qchatGetChannelCategoryWhiteBlackRolesTag:jn(jn({},Ie),{type:Ia[Ie.type],roleIds:Eo(Ie.roleIds)})});case 3:return nr=gr.sent,kt=nr.content.datas,gr.abrupt("return",mi(kt));case 6:case"end":return gr.stop()}},At,this)}))},Ve.getChannelCategoryWhiteBlackMembers=function(Ie){return Hr(this,void 0,void 0,wr.mark(function At(){var nr,kt;return wr.wrap(function(gr){for(;;)switch(gr.prev=gr.next){case 0:return On({categoryId:{type:"string",allowEmpty:!1},serverId:{type:"string",allowEmpty:!1},type:{type:"enum",values:xa(Ia)},accids:{type:"array",itemType:"string",min:1}},Ie),gr.next=3,this.core.sendCmd("qchatGetChannelCategoryWhiteBlackMembers",{qchatGetChannelCategoryWhiteBlackMembersTag:jn(jn({},Ie),{type:Ia[Ie.type],accids:Eo(Ie.accids)})});case 3:return nr=gr.sent,kt=nr.content.datas,gr.abrupt("return",Ac(kt));case 6:case"end":return gr.stop()}},At,this)}))},Ve.getChannelCategoriesPage=function(Ie){return Hr(this,void 0,void 0,wr.mark(function At(){var nr,kt,ur,gr;return wr.wrap(function(Rr){for(;;)switch(Rr.prev=Rr.next){case 0:return On({serverId:{type:"string",allowEmpty:!1},timetag:{type:"number",min:0},limit:{type:"number",min:1,required:!1}},Ie),Rr.next=3,this.core.sendCmd("qchatGetChannelCategoriesPage",{qchatGetChannelCategoriesPageTag:Ie});case 3:return nr=Rr.sent,kt=nr.content,ur=kt.datas,gr=kt.listQueryTag,Rr.abrupt("return",{listQueryTag:{hasMore:+gr.hasMore==1,nextTimetag:Yo(gr.nextTimetag)},datas:Jh(ur)});case 6:case"end":return Rr.stop()}},At,this)}))},Ve.getChannelCategoryChannelsPage=function(Ie){return Hr(this,void 0,void 0,wr.mark(function At(){var nr,kt,ur,gr;return wr.wrap(function(Rr){for(;;)switch(Rr.prev=Rr.next){case 0:return On({serverId:{type:"string",allowEmpty:!1},categoryId:{type:"string",allowEmpty:!1},timetag:{type:"number",min:0},limit:{type:"number",min:1,required:!1}},Ie),Rr.next=3,this.core.sendCmd("qchatGetChannelCategoryChannelsPage",{qchatGetChannelCategoryChannelsPageTag:Ie});case 3:return nr=Rr.sent,kt=nr.content,ur=kt.datas,gr=kt.listQueryTag,Rr.abrupt("return",{listQueryTag:{hasMore:+gr.hasMore==1,nextTimetag:Yo(gr.nextTimetag)},datas:op(ur)});case 6:case"end":return Rr.stop()}},At,this)}))},Ve.subscribeChannel=function(Ie){return Hr(this,void 0,void 0,wr.mark(function At(){var nr,kt;return wr.wrap(function(gr){for(;;)switch(gr.prev=gr.next){case 0:return On({type:{type:"number",min:1,max:5},opeType:{type:"number",min:1,max:2}},Ie),gr.next=3,this.subscribeModuleService.subscribe(Ie);case 3:if((nr=gr.sent).unreadInfos=ap(nr.unreadInfos),Ie.opeType===1&&(Ie.channels=Ao(kt=nr.unreadInfos).call(kt,function(Ar){return{serverId:Ar.serverId,channelId:Ar.channelId}})),this.logger.debug("QChatChannel::subscribeChannel:: cacheSubscribe ",Ie),this.subscribeModuleService.cacheSubscribe(Ie),Ie.type!==5){gr.next=10;break}return gr.abrupt("return");case 10:return this.subscribeModuleService.updateUnreads(nr.unreadInfos),gr.abrupt("return",nr);case 12:case"end":return gr.stop()}},At,this)}))},Ve.getChannelUnreadInfos=function(Ie){return Hr(this,void 0,void 0,wr.mark(function At(){var nr,kt;return wr.wrap(function(gr){for(;;)switch(gr.prev=gr.next){case 0:return gr.next=2,this.core.sendCmd("qchatGetUnreadInfo",Ie);case 2:return nr=gr.sent,kt=ap(nr.content.unreadInfos),this.subscribeModuleService.updateUnreads(kt),gr.abrupt("return",kt);case 6:case"end":return gr.stop()}},At,this)}))},Ve.getChannelSearchByPage=function(Ie){return Hr(this,void 0,void 0,wr.mark(function At(){var nr,kt,ur,gr;return wr.wrap(function(Rr){for(;;)switch(Rr.prev=Rr.next){case 0:if(On({keyword:{type:"string",allowEmpty:!1},startTime:{type:"number",min:0,required:!1},endTime:{type:"number",min:1,required:!1},order:{type:"enum",values:xa(Yc),required:!1},limit:{type:"number",min:1,required:!1},serverId:{type:"string",required:!1},sort:{type:"enum",values:xa(vf),required:!1},cursor:{type:"string",allowEmpty:!1,required:!1}},Ie),!(Ie.startTime&&Ie.endTime&&Ie.startTime>=Ie.endTime)){Rr.next=3;break}throw new Il("startTime more than endTime",Ie,"timeRule");case 3:return Rr.next=5,this.core.sendCmd("qchatGetChannelSearchByPage",{qchatGetChannelSearchByPageTag:jn(jn({},Ie),{order:Ie.order&&Yc[Ie.order],sort:vu(Ie)&&vf[vu(Ie)]})});case 5:return nr=Rr.sent,kt=nr.content,ur=kt.datas,gr=kt.listQueryTag,Rr.abrupt("return",{listQueryTag:{hasMore:+gr.hasMore==1,nextTimetag:Yo(gr.nextTimetag),cursor:gr.cursor},datas:op(ur)});case 8:case"end":return Rr.stop()}},At,this)}))},Ve.channelMemberSearch=function(Ie){return Hr(this,void 0,void 0,wr.mark(function At(){var nr;return wr.wrap(function(ur){for(;;)switch(ur.prev=ur.next){case 0:return On({serverId:{type:"string",allowEmpty:!1},channelId:{type:"string",allowEmpty:!1},keyword:{type:"string",allowEmpty:!1},limit:{type:"number",min:1,required:!1}},Ie),ur.next=3,this.core.sendCmd("qchatChannelMemberSearch",{qchatChannelMemberSearchTag:Ie});case 3:return nr=ur.sent,ur.abrupt("return",ZS(nr.content.datas));case 5:case"end":return ur.stop()}},At,this)}))},Ve.subscribeAsVisitor=function(Ie){return Hr(this,void 0,void 0,wr.mark(function At(){return wr.wrap(function(kt){for(;;)switch(kt.prev=kt.next){case 0:return On({opeType:{type:"number",min:1,max:2},type:{type:"number",required:!1},channels:{type:"array",rules:{serverId:{type:"string",allowEmpty:!1},channelId:{type:"string",allowEmpty:!1}},min:1}},Ie),kt.next=3,this.subscribeForVisitorService.subscribeChannelAsVisitor(Ie);case 3:return kt.abrupt("return",kt.sent);case 4:case"end":return kt.stop()}},At,this)}))},_e}(Ll),ib={"24_61":"qchatCreateServerRole","24_62":"qchatDeleteServerRole","24_63":"qchatUpdateServerRole","24_64":"qchatGetServerRoles","24_65":"qchatAddChannelRole","24_66":"qchatRemoveChannelRole","24_67":"qchatUpdateChannelRole","24_68":"qchatGetChannelRoles","24_69":"qchatAddMemberRole","24_70":"qchatRemoveMemberRole","24_71":"qchatUpdateMemberRole","24_72":"qchatGetMemberRoles","24_73":"qchatAddMembersToServerRole","24_74":"qchatRemoveMembersFromServerRole","24_75":"qchatGetMembersFromServerRole","24_76":"qchatGetServerRolesByAccid","24_77":"qchatGetExistingServerRolesByAccids","24_78":"qchatGetExistingChannelRolesByServerRoleIds","24_79":"qchatGetExistingAccidsOfMemberRoles","24_80":"qchatUpdateServerRolePriorities","24_81":"qchatGetExistingAccidsInServerRole","24_82":"qchatCheckPermission","24_83":"qchatAddChannelCategoryRole","24_84":"qchatRemoveChannelCategoryRole","24_85":"qchatUpdateChannelCategoryRole","24_86":"qchatGetChannelCategoryRole","24_87":"qchatAddChannelCategoryMemberRole","24_88":"qchatRemoveChannelCategoryMemberRole","24_89":"qchatUpdateChannelCategoryMemberRole","24_90":"qchatGetChannelCategoryMemberRole","24_126":"qchatCheckPermissions"},ps={channelRole:{serverId:1,roleId:2,parentRoleId:3,channelId:4,name:5,icon:6,ext:7,auths:8,type:9,createTime:10,updateTime:11},memberRole:{serverId:1,id:2,accid:3,channelId:4,auths:5,createTime:6,updateTime:7,nick:8,avatar:9,ext:10,memberType:11,joinTime:12,inviter:13},antispamTag:{antiSpamBusinessId:1},serverRole:{serverId:1,roleId:2,name:3,icon:4,ext:5,auths:6,type:7,memberCount:8,priority:9,createTime:10,updateTime:11,isMember:12},getRoleByPagesTag:{serverId:1,channelId:2,time:3,limit:4},checkPermissionTag:{serverId:1,channelId:2,auth:3},member:{serverId:1,roleId:2,accid:3,createTime:4,updateTime:5,nick:6,avatar:7,ext:8,type:9,joinTime:10,inviter:11},qchatAddChannelCategoryRoleTag:{categoryId:3,serverId:4,parentRoleId:5},channelCategoryRole:{roleId:1,categoryId:3,serverId:4,parentRoleId:5,type:6,validFlag:7,createTime:8,updateTime:9,auths:10,name:11,icon:12,ext:13},qchatGetChannelCategoryRoleTag:{serverId:1,categoryId:2,timetag:3,limit:4},channelCategoryMemberRole:{id:1,accid:3,categoryId:4,serverId:5,validFlag:6,createTime:7,updateTime:8,auths:9,nick:10,avatar:11,ext:12,memberType:13,joinTime:14,inviter:15},qchatGetChannelCategoryMemberRoleTag:{serverId:1,categoryId:2,timetag:3,limit:4},checkPermissionsTag:{serverId:1,channelId:2,auths:3}},Ea=zc(ps),MM={qchatCreateServerRole:{service:"qchatRole",sid:24,cid:61,params:[{type:"Property",name:"serverRole",reflectMapper:ps.serverRole},{type:"Property",name:"antispamTag",reflectMapper:ps.antispamTag}],response:[{type:"Property",name:"serverRole",reflectMapper:Ea.serverRole}]},qchatDeleteServerRole:{service:"qchatRole",sid:24,cid:62,params:[{type:"Long",name:"serverId"},{type:"Long",name:"roleId"}]},qchatUpdateServerRole:{service:"qchatRole",sid:24,cid:63,params:[{type:"Property",name:"updateServerRoleTag",reflectMapper:{serverId:1,roleId:2,name:3,icon:4,ext:5,auths:6,priority:7}},{type:"Property",name:"antispamTag",reflectMapper:ps.antispamTag}],response:[{type:"Property",name:"serverRole",reflectMapper:Ea.serverRole}]},qchatGetServerRoles:{service:"qchatRole",sid:24,cid:64,params:[{type:"Property",name:"getServerRolesTag",reflectMapper:{serverId:1,timetag:2,limit:3,priority:4,channelId:5,categoryId:6}}],response:[{type:"PropertyArray",name:"serverRoles",reflectMapper:Ea.serverRole}]},qchatAddChannelRole:{service:"qchatRole",sid:24,cid:65,params:[{type:"Property",name:"channelRole",reflectMapper:ps.channelRole}],response:[{type:"Property",name:"channelRole",reflectMapper:Ea.channelRole}]},qchatRemoveChannelRole:{service:"qchatRole",sid:24,cid:66,params:[{type:"Long",name:"serverId"},{type:"Long",name:"channelId"},{type:"Long",name:"roleId"}]},qchatUpdateChannelRole:{service:"qchatRole",sid:24,cid:67,params:[{type:"Property",name:"updateChannelRoleTag",reflectMapper:{serverId:1,roleId:2,channelId:3,auths:4}}],response:[{type:"Property",name:"channelRole",reflectMapper:Ea.channelRole}]},qchatGetChannelRoles:{service:"qchatRole",sid:24,cid:68,params:[{type:"Property",name:"getChannelRolesTag",reflectMapper:{serverId:1,channelId:2,timetag:3,limit:4}}],response:[{type:"PropertyArray",name:"channelRoles",reflectMapper:Ea.channelRole}]},qchatAddMemberRole:{service:"qchatRole",sid:24,cid:69,params:[{type:"Property",name:"memberRole",reflectMapper:ps.memberRole}],response:[{type:"Property",name:"memberRole",reflectMapper:Ea.memberRole}]},qchatRemoveMemberRole:{service:"qchatRole",sid:24,cid:70,params:[{type:"Property",name:"memberRole",reflectMapper:ps.memberRole}]},qchatUpdateMemberRole:{service:"qchatRole",sid:24,cid:71,params:[{type:"Property",name:"updateMemberRoleTag",reflectMapper:{serverId:1,accid:2,channelId:3,auths:4}}],response:[{type:"Property",name:"memberRole",reflectMapper:Ea.memberRole}]},qchatGetMemberRoles:{service:"qchatRole",sid:24,cid:72,params:[{type:"Property",name:"getMemberRolesTag",reflectMapper:{serverId:1,channelId:2,timetag:3,limit:4}}],response:[{type:"PropertyArray",name:"memberRoles",reflectMapper:Ea.memberRole}]},qchatAddMembersToServerRole:{service:"qchatRole",sid:24,cid:73,params:[{type:"Long",name:"serverId"},{type:"Long",name:"roleId"},{type:"String",name:"accids"}],response:[{type:"Property",name:"accids",reflectMapper:{1:"successAccids",2:"failedAccids"}}]},qchatRemoveMembersFromServerRole:{service:"qchatRole",sid:24,cid:74,params:[{type:"Long",name:"serverId"},{type:"Long",name:"roleId"},{type:"String",name:"accids"}],response:[{type:"Property",name:"accids",reflectMapper:{1:"successAccids",2:"failedAccids"}}]},qchatGetMembersFromServerRole:{service:"qchatRole",sid:24,cid:75,params:[{type:"Property",name:"getMembersFromServerRoleTag",reflectMapper:{serverId:1,roleId:2,timetag:3,accid:4,limit:5}}],response:[{type:"PropertyArray",name:"members",reflectMapper:Ea.member}]},qchatGetServerRolesByAccid:{service:"qchatRole",sid:24,cid:76,params:[{type:"Property",name:"getServerRolesByAccidTag",reflectMapper:{serverId:1,accid:2,timetag:3,limit:4}}],response:[{type:"PropertyArray",name:"serverRoles",reflectMapper:Ea.serverRole}]},qchatGetExistingServerRolesByAccids:{service:"qchatRole",sid:24,cid:77,params:[{type:"Long",name:"serverId"},{type:"String",name:"accids"}],response:[{type:"String",name:"serverRoles"}]},qchatGetExistingChannelRolesByServerRoleIds:{service:"qchatRole",sid:24,cid:78,params:[{type:"Long",name:"serverId"},{type:"Long",name:"channelId"},{type:"String",name:"roleIds"}],response:[{type:"PropertyArray",name:"channelRoles",reflectMapper:Ea.channelRole}]},qchatGetExistingAccidsOfMemberRoles:{service:"qchatRole",sid:24,cid:79,params:[{type:"Long",name:"serverId"},{type:"Long",name:"channelId"},{type:"String",name:"accids"}],response:[{type:"PropertyArray",name:"memberRoles",reflectMapper:Ea.memberRole}]},qchatUpdateServerRolePriorities:{service:"qchatRole",sid:24,cid:80,params:[{type:"Long",name:"serverId"},{type:"PropertyArray",name:"serverRoles",reflectMapper:{serverId:1,roleId:2,priority:7}}],response:[{type:"PropertyArray",name:"serverRoles",reflectMapper:Ea.serverRole}]},qchatGetExistingAccidsInServerRole:{service:"qchatRole",sid:24,cid:81,params:[{type:"Long",name:"serverId"},{type:"Long",name:"roleId"},{type:"String",name:"accids"}],response:[{type:"PropertyArray",name:"members",reflectMapper:Ea.member}]},qchatCheckPermission:{service:"qchatRole",sid:24,cid:82,params:[{type:"Property",name:"checkPermissionTag",reflectMapper:ps.checkPermissionTag}],response:[{type:"Boolean",name:"checked"}]},qchatAddChannelCategoryRole:{service:"qchatRole",sid:24,cid:83,params:[{type:"Property",name:"qchatAddChannelCategoryRoleTag",reflectMapper:ps.channelCategoryRole}],response:[{type:"Property",name:"channelCategoryRole",reflectMapper:Ea.channelCategoryRole}]},qchatRemoveChannelCategoryRole:{service:"qchatRole",sid:24,cid:84,params:[{type:"Long",name:"serverId"},{type:"Long",name:"categoryId"},{type:"Long",name:"roleId"}]},qchatUpdateChannelCategoryRole:{service:"qchatRole",sid:24,cid:85,params:[{type:"Property",name:"qchatUpdateChannelCategoryRoleTag",reflectMapper:ps.channelCategoryRole}],response:[{type:"Property",name:"channelCategoryRole",reflectMapper:Ea.channelCategoryRole}]},qchatGetChannelCategoryRole:{service:"qchatRole",sid:24,cid:86,params:[{type:"Property",name:"qchatGetChannelCategoryRoleTag",reflectMapper:ps.qchatGetChannelCategoryRoleTag}],response:[{type:"PropertyArray",name:"list",reflectMapper:Ea.channelCategoryRole}]},qchatAddChannelCategoryMemberRole:{service:"qchatRole",sid:24,cid:87,params:[{type:"Property",name:"qchatAddChannelCategoryMemberRoleTag",reflectMapper:ps.channelCategoryMemberRole}],response:[{type:"Property",name:"channelCategoryMemberRole",reflectMapper:Ea.channelCategoryMemberRole}]},qchatRemoveChannelCategoryMemberRole:{service:"qchatRole",sid:24,cid:88,params:[{type:"Long",name:"serverId"},{type:"Long",name:"categoryId"},{type:"String",name:"accid"}]},qchatUpdateChannelCategoryMemberRole:{service:"qchatRole",sid:24,cid:89,params:[{type:"Property",name:"qchatUpdateChannelCategoryMemberRoleTag",reflectMapper:ps.channelCategoryMemberRole}],response:[{type:"Property",name:"channelCategoryMemberRole",reflectMapper:Ea.channelCategoryMemberRole}]},qchatGetChannelCategoryMemberRole:{service:"qchatRole",sid:24,cid:90,params:[{type:"Property",name:"qchatGetChannelCategoryMemberRoleTag",reflectMapper:ps.qchatGetChannelCategoryMemberRoleTag}],response:[{type:"PropertyArray",name:"list",reflectMapper:Ea.channelCategoryMemberRole}]},qchatCheckPermissions:{service:"qchatRole",sid:24,cid:126,params:[{type:"Property",name:"checkPermissionsTag",reflectMapper:ps.checkPermissionsTag}],response:[{type:"PropertyArray",name:"checkPermissionsResult",reflectMapper:{1:"auth",2:"isAllow"}}]}},CM=function(){function pe(Ve){this.core=Ve}var _e=pe.prototype;return _e.addChannelCategoryRole=function(Oe){return Hr(this,void 0,void 0,wr.mark(function Ie(){var At;return wr.wrap(function(kt){for(;;)switch(kt.prev=kt.next){case 0:return On({serverId:{type:"string",allowEmpty:!1},categoryId:{type:"string",allowEmpty:!1},parentRoleId:{type:"string",allowEmpty:!1}},Oe),kt.next=3,this.core.sendCmd("qchatAddChannelCategoryRole",{qchatAddChannelCategoryRoleTag:Oe});case 3:return At=kt.sent,kt.abrupt("return",Sf(At.content.channelCategoryRole));case 5:case"end":return kt.stop()}},Ie,this)}))},_e.removeChannelCategoryRole=function(Oe){return Hr(this,void 0,void 0,wr.mark(function Ie(){return wr.wrap(function(nr){for(;;)switch(nr.prev=nr.next){case 0:return On({serverId:{type:"string",allowEmpty:!1},categoryId:{type:"string",allowEmpty:!1},roleId:{type:"string",allowEmpty:!1}},Oe),nr.next=3,this.core.sendCmd("qchatRemoveChannelCategoryRole",Oe);case 3:case"end":return nr.stop()}},Ie,this)}))},_e.updateChannelCategoryRole=function(Oe){return Hr(this,void 0,void 0,wr.mark(function Ie(){var At;return wr.wrap(function(kt){for(;;)switch(kt.prev=kt.next){case 0:return On({serverId:{type:"string",allowEmpty:!1},categoryId:{type:"string",allowEmpty:!1},roleId:{type:"string",allowEmpty:!1},auths:{type:"object"}},Oe),kt.next=3,this.core.sendCmd("qchatUpdateChannelCategoryRole",{qchatUpdateChannelCategoryRoleTag:el(Oe)});case 3:if((At=kt.sent).raw.code!==406){kt.next=6;break}throw new No("No update required",{},406);case 6:return kt.abrupt("return",Sf(At.content.channelCategoryRole));case 7:case"end":return kt.stop()}},Ie,this)}))},_e.getChannelCategoryRole=function(Oe){return Hr(this,void 0,void 0,wr.mark(function Ie(){var At;return wr.wrap(function(kt){for(;;)switch(kt.prev=kt.next){case 0:return On({serverId:{type:"string",allowEmpty:!1},categoryId:{type:"string",allowEmpty:!1},timetag:{type:"number",min:0,required:!1},limit:{type:"number",min:1,required:!1}},Oe),kt.next=3,this.core.sendCmd("qchatGetChannelCategoryRole",{qchatGetChannelCategoryRoleTag:Oe});case 3:return At=kt.sent,kt.abrupt("return",(ur=At.content.list,ks(ur)&&ur.length>0?Ao(ur).call(ur,function(gr){return Sf(gr)}):[]));case 5:case"end":return kt.stop()}var ur},Ie,this)}))},_e.addChannelCategoryMemberRole=function(Oe){return Hr(this,void 0,void 0,wr.mark(function Ie(){var At;return wr.wrap(function(kt){for(;;)switch(kt.prev=kt.next){case 0:return On({serverId:{type:"string",allowEmpty:!1},categoryId:{type:"string",allowEmpty:!1},accid:{type:"string",allowEmpty:!1}},Oe),kt.next=3,this.core.sendCmd("qchatAddChannelCategoryMemberRole",{qchatAddChannelCategoryMemberRoleTag:Oe});case 3:return At=kt.sent,kt.abrupt("return",Su(At.content.channelCategoryMemberRole));case 5:case"end":return kt.stop()}},Ie,this)}))},_e.removeChannelCategoryMemberRole=function(Oe){return Hr(this,void 0,void 0,wr.mark(function Ie(){return wr.wrap(function(nr){for(;;)switch(nr.prev=nr.next){case 0:return On({serverId:{type:"string",allowEmpty:!1},categoryId:{type:"string",allowEmpty:!1},accid:{type:"string",allowEmpty:!1}},Oe),nr.next=3,this.core.sendCmd("qchatRemoveChannelCategoryMemberRole",Oe);case 3:case"end":return nr.stop()}},Ie,this)}))},_e.updateChannelCategoryMemberRole=function(Oe){return Hr(this,void 0,void 0,wr.mark(function Ie(){var At;return wr.wrap(function(kt){for(;;)switch(kt.prev=kt.next){case 0:return On({serverId:{type:"string",allowEmpty:!1},categoryId:{type:"string",allowEmpty:!1},accid:{type:"string",allowEmpty:!1},auths:{type:"object"}},Oe),kt.next=3,this.core.sendCmd("qchatUpdateChannelCategoryMemberRole",{qchatUpdateChannelCategoryMemberRoleTag:el(Oe)});case 3:if((At=kt.sent).raw.code!==406){kt.next=6;break}throw new No("No update required",{},406);case 6:return kt.abrupt("return",Su(At.content.channelCategoryMemberRole));case 7:case"end":return kt.stop()}},Ie,this)}))},_e.getChannelCategoryMemberRole=function(Oe){return Hr(this,void 0,void 0,wr.mark(function Ie(){var At;return wr.wrap(function(kt){for(;;)switch(kt.prev=kt.next){case 0:return On({serverId:{type:"string",allowEmpty:!1},categoryId:{type:"string",allowEmpty:!1},timetag:{type:"number",min:0,required:!1},limit:{type:"number",min:1,required:!1}},Oe),kt.next=3,this.core.sendCmd("qchatGetChannelCategoryMemberRole",{qchatGetChannelCategoryMemberRoleTag:Oe});case 3:return At=kt.sent,kt.abrupt("return",(ur=At.content.list,ks(ur)&&ur.length>0?Ao(ur).call(ur,function(gr){return Su(gr)}):[]));case 5:case"end":return kt.stop()}var ur},Ie,this)}))},pe}(),kM=function(pe){function _e(Oe){var Ie;return(Ie=pe.call(this,"qchatRole",Oe)||this).core=Oe,Zi({cmdMap:ib,cmdConfig:MM}),Ie.category=new CM(Oe),Ie}Ko(_e,pe);var Ve=_e.prototype;return Ve.createServerRole=function(Ie){return Hr(this,void 0,void 0,wr.mark(function At(){var nr;return wr.wrap(function(ur){for(;;)switch(ur.prev=ur.next){case 0:return On({serverId:{type:"string",allowEmpty:!1},name:{type:"string",allowEmpty:!1},priority:{type:"number",min:1},icon:{type:"string",required:!1},ext:{type:"string",required:!1}},Ie),ur.next=3,this.core.sendCmd("qchatCreateServerRole",{serverRole:jn(jn({},el(Ie)),{type:Tu.custom}),antispamTag:Zc(Ie)});case 3:return nr=ur.sent,ur.abrupt("return",As(nr.content.serverRole));case 5:case"end":return ur.stop()}},At,this)}))},Ve.updateServerRole=function(Ie){return Hr(this,void 0,void 0,wr.mark(function At(){var nr;return wr.wrap(function(ur){for(;;)switch(ur.prev=ur.next){case 0:return On({serverId:{type:"string",allowEmpty:!1},roleId:{type:"string",allowEmpty:!1},name:{type:"string",required:!1},icon:{type:"string",required:!1},ext:{type:"string",required:!1},priority:{type:"number",required:!1},auths:{type:"object",required:!1}},Ie),ur.next=3,this.core.sendCmd("qchatUpdateServerRole",{updateServerRoleTag:el(Ie),antispamTag:Zc(Ie)});case 3:return nr=ur.sent,ur.abrupt("return",As(nr.content.serverRole));case 5:case"end":return ur.stop()}},At,this)}))},Ve.deleteServerRole=function(Ie){return Hr(this,void 0,void 0,wr.mark(function At(){return wr.wrap(function(kt){for(;;)switch(kt.prev=kt.next){case 0:return On({serverId:{type:"string",allowEmpty:!1},roleId:{type:"string",allowEmpty:!1}},Ie),kt.next=3,this.core.sendCmd("qchatDeleteServerRole",Ie);case 3:case"end":return kt.stop()}},At,this)}))},Ve.getServerRoles=function(Ie){return Hr(this,void 0,void 0,wr.mark(function At(){var nr,kt,ur;return wr.wrap(function(Ar){for(;;)switch(Ar.prev=Ar.next){case 0:return On({serverId:{type:"string",allowEmpty:!1},channelId:{type:"string",allowEmpty:!1,required:!1},categoryId:{type:"string",allowEmpty:!1,required:!1},limit:{type:"number",min:1,required:!1},priority:{type:"number",required:!1}},Ie),Ar.next=3,this.core.sendCmd("qchatGetServerRoles",{getServerRolesTag:el(Ie)});case 3:return kt=Ar.sent,ur=bi(nr=kt.content.serverRoles).call(nr,function(Rr){return Yo(Rr.isMember)===1}),ur=Ao(ur).call(ur,function(Rr){return Rr.roleId}),Ar.abrupt("return",{roles:mi(kt.content.serverRoles),isMemberRoles:ur});case 7:case"end":return Ar.stop()}},At,this)}))},Ve.addChannelRole=function(Ie){return Hr(this,void 0,void 0,wr.mark(function At(){var nr;return wr.wrap(function(ur){for(;;)switch(ur.prev=ur.next){case 0:return On({serverId:{type:"string",allowEmpty:!1},channelId:{type:"string",allowEmpty:!1},parentRoleId:{type:"string",allowEmpty:!1}},Ie),ur.next=3,this.core.sendCmd("qchatAddChannelRole",{channelRole:el(Ie)});case 3:return nr=ur.sent,ur.abrupt("return",As(nr.content.channelRole));case 5:case"end":return ur.stop()}},At,this)}))},Ve.getChannelRoles=function(Ie){return Hr(this,void 0,void 0,wr.mark(function At(){var nr;return wr.wrap(function(ur){for(;;)switch(ur.prev=ur.next){case 0:return On({serverId:{type:"string",allowEmpty:!1},channelId:{type:"string",allowEmpty:!1},timetag:{type:"number",required:!1},limit:{type:"number",min:1,required:!1}},Ie),ur.next=3,this.core.sendCmd("qchatGetChannelRoles",{getChannelRolesTag:Ie});case 3:return nr=ur.sent,ur.abrupt("return",mi(nr.content.channelRoles));case 5:case"end":return ur.stop()}},At,this)}))},Ve.removeChannelRole=function(Ie){return Hr(this,void 0,void 0,wr.mark(function At(){return wr.wrap(function(kt){for(;;)switch(kt.prev=kt.next){case 0:return On({serverId:{type:"string",allowEmpty:!1},channelId:{type:"string",allowEmpty:!1},roleId:{type:"string",allowEmpty:!1}},Ie),kt.next=3,this.core.sendCmd("qchatRemoveChannelRole",Ie);case 3:case"end":return kt.stop()}},At,this)}))},Ve.updateChannelRole=function(Ie){return Hr(this,void 0,void 0,wr.mark(function At(){var nr;return wr.wrap(function(ur){for(;;)switch(ur.prev=ur.next){case 0:return On({serverId:{type:"string",allowEmpty:!1},channelId:{type:"string",allowEmpty:!1},roleId:{type:"string",allowEmpty:!1},auths:{type:"object",required:!1}},Ie),ur.next=3,this.core.sendCmd("qchatUpdateChannelRole",{updateChannelRoleTag:el(Ie)});case 3:if((nr=ur.sent).raw.code!==406){ur.next=6;break}throw new No("No update required",{},406);case 6:return ur.abrupt("return",As(nr.content.channelRole));case 7:case"end":return ur.stop()}},At,this)}))},Ve.addMemberRole=function(Ie){return Hr(this,void 0,void 0,wr.mark(function At(){var nr;return wr.wrap(function(ur){for(;;)switch(ur.prev=ur.next){case 0:return On({serverId:{type:"string",allowEmpty:!1},channelId:{type:"string",allowEmpty:!1},accid:{type:"string",allowEmpty:!1}},Ie),ur.next=3,this.core.sendCmd("qchatAddMemberRole",{memberRole:Ie});case 3:return nr=ur.sent,ur.abrupt("return",As(nr.content.memberRole));case 5:case"end":return ur.stop()}},At,this)}))},Ve.getMemberRoles=function(Ie){return Hr(this,void 0,void 0,wr.mark(function At(){var nr;return wr.wrap(function(ur){for(;;)switch(ur.prev=ur.next){case 0:return On({serverId:{type:"string",allowEmpty:!1},channelId:{type:"string",allowEmpty:!1},timetag:{type:"number",required:!1},limit:{type:"number",min:1,required:!1}},Ie),ur.next=3,this.core.sendCmd("qchatGetMemberRoles",{getMemberRolesTag:Ie});case 3:return nr=ur.sent,ur.abrupt("return",mi(nr.content.memberRoles));case 5:case"end":return ur.stop()}},At,this)}))},Ve.removeMemberRole=function(Ie){return Hr(this,void 0,void 0,wr.mark(function At(){return wr.wrap(function(kt){for(;;)switch(kt.prev=kt.next){case 0:return On({serverId:{type:"string",allowEmpty:!1},channelId:{type:"string",allowEmpty:!1},accid:{type:"string",allowEmpty:!1}},Ie),kt.next=3,this.core.sendCmd("qchatRemoveMemberRole",{memberRole:Ie});case 3:case"end":return kt.stop()}},At,this)}))},Ve.updateMemberRole=function(Ie){return Hr(this,void 0,void 0,wr.mark(function At(){var nr;return wr.wrap(function(ur){for(;;)switch(ur.prev=ur.next){case 0:return On({serverId:{type:"string",allowEmpty:!1},channelId:{type:"string",allowEmpty:!1},accid:{type:"string",allowEmpty:!1},auths:{type:"object",required:!1}},Ie),ur.next=3,this.core.sendCmd("qchatUpdateMemberRole",{updateMemberRoleTag:el(Ie)});case 3:if((nr=ur.sent).raw.code!==406){ur.next=6;break}throw new No("No update required",{},406);case 6:return ur.abrupt("return",As(nr.content.memberRole));case 7:case"end":return ur.stop()}},At,this)}))},Ve.addMembersToServerRole=function(Ie){return Hr(this,void 0,void 0,wr.mark(function At(){var nr,kt,ur;return wr.wrap(function(Ar){for(;;)switch(Ar.prev=Ar.next){case 0:return On({serverId:{type:"string",allowEmpty:!1},roleId:{type:"string",allowEmpty:!1},accids:{type:"array",itemType:"string",min:1}},Ie),Ar.next=3,this.core.sendCmd("qchatAddMembersToServerRole",jn(jn({},Ie),{accids:Eo(Ie.accids)}));case 3:return nr=Ar.sent,kt=ms(nr,"content.accids.successAccids"),ur=ms(nr,"content.accids.failedAccids"),Ar.abrupt("return",{successAccids:kt?JSON.parse(kt):[],failedAccids:ur?JSON.parse(ur):[]});case 7:case"end":return Ar.stop()}},At,this)}))},Ve.removeMembersFromServerRole=function(Ie){return Hr(this,void 0,void 0,wr.mark(function At(){var nr,kt,ur;return wr.wrap(function(Ar){for(;;)switch(Ar.prev=Ar.next){case 0:return On({serverId:{type:"string",allowEmpty:!1},roleId:{type:"string",allowEmpty:!1},accids:{type:"array",itemType:"string",min:1}},Ie),Ar.next=3,this.core.sendCmd("qchatRemoveMembersFromServerRole",jn(jn({},Ie),{accids:Eo(Ie.accids)}));case 3:return nr=Ar.sent,kt=ms(nr,"content.accids.successAccids"),ur=ms(nr,"content.accids.failedAccids"),Ar.abrupt("return",{successAccids:kt?JSON.parse(kt):[],failedAccids:ur?JSON.parse(ur):[]});case 7:case"end":return Ar.stop()}},At,this)}))},Ve.getMembersFromServerRole=function(Ie){return Hr(this,void 0,void 0,wr.mark(function At(){var nr;return wr.wrap(function(ur){for(;;)switch(ur.prev=ur.next){case 0:return On({serverId:{type:"string",allowEmpty:!1},roleId:{type:"string",allowEmpty:!1},timetag:{type:"number",required:!1},accid:{type:"string",allowEmpty:!1,required:!1},limit:{type:"number",min:1,required:!1}},Ie),ur.next=3,this.core.sendCmd("qchatGetMembersFromServerRole",{getMembersFromServerRoleTag:Ie});case 3:return nr=ur.sent,ur.abrupt("return",mi(nr.content.members));case 5:case"end":return ur.stop()}},At,this)}))},Ve.getServerRolesByAccid=function(Ie){return Hr(this,void 0,void 0,wr.mark(function At(){var nr;return wr.wrap(function(ur){for(;;)switch(ur.prev=ur.next){case 0:return On({serverId:{type:"string",allowEmpty:!1},accid:{type:"string",allowEmpty:!1},timetag:{type:"number",required:!1},limit:{type:"number",min:1,required:!1}},Ie),ur.next=3,this.core.sendCmd("qchatGetServerRolesByAccid",{getServerRolesByAccidTag:Ie});case 3:return nr=ur.sent,ur.abrupt("return",mi(nr.content.serverRoles));case 5:case"end":return ur.stop()}},At,this)}))},Ve.getExistingServerRolesByAccids=function(Ie){return Hr(this,void 0,void 0,wr.mark(function At(){var nr,kt,ur;return wr.wrap(function(Ar){for(;;)switch(Ar.prev=Ar.next){case 0:return On({serverId:{type:"string",allowEmpty:!1},accids:{type:"array",itemType:"string"}},Ie),Ar.next=3,this.core.sendCmd("qchatGetExistingServerRolesByAccids",{serverId:Ie.serverId,accids:Eo(Ie.accids)});case 3:return nr=Ar.sent,Ar.prev=4,ur=JSON.parse(nr.content.serverRoles),Kn(kt=Sa(ur)).call(kt,function(Rr){var Ur;Kn(Ur=ur[Rr]).call(Ur,function(Dr,Jr){ur[Rr][Jr]=es(Dr,Ea.serverRole)}),ur[Rr]=mi(ur[Rr])}),Ar.abrupt("return",ur);case 10:throw Ar.prev=10,Ar.t0=Ar.catch(4),this.logger.error("can not parse serverRolesGroupByAccid from "+Ie.serverId+" and "+Ie.accids,nr.content.serverRoles),Ar.t0;case 14:case"end":return Ar.stop()}},At,this,[[4,10]])}))},Ve.getExistingChannelRolesByServerRoleIds=function(Ie){return Hr(this,void 0,void 0,wr.mark(function At(){var nr;return wr.wrap(function(ur){for(;;)switch(ur.prev=ur.next){case 0:return On({serverId:{type:"string",allowEmpty:!1},channelId:{type:"string",allowEmpty:!1},roleIds:{type:"array",itemType:"string"}},Ie),ur.next=3,this.core.sendCmd("qchatGetExistingChannelRolesByServerRoleIds",{serverId:Ie.serverId,channelId:Ie.channelId,roleIds:Eo(Ie.roleIds)});case 3:return nr=ur.sent,ur.abrupt("return",mi(nr.content.channelRoles));case 5:case"end":return ur.stop()}},At,this)}))},Ve.getExistingAccidsOfMemberRoles=function(Ie){return Hr(this,void 0,void 0,wr.mark(function At(){var nr,kt;return wr.wrap(function(gr){for(;;)switch(gr.prev=gr.next){case 0:return On({serverId:{type:"string",allowEmpty:!1},channelId:{type:"string",allowEmpty:!1},accids:{type:"array",itemType:"string"}},Ie),gr.next=3,this.core.sendCmd("qchatGetExistingAccidsOfMemberRoles",{serverId:Ie.serverId,channelId:Ie.channelId,accids:Eo(Ie.accids)});case 3:return nr=gr.sent,kt=nr.content.memberRoles,gr.abrupt("return",kt&&kt.length>0?Ao(kt).call(kt,function(Ar){return Ar.accid}):[]);case 6:case"end":return gr.stop()}},At,this)}))},Ve.getExistingAccidsInServerRole=function(Ie){return Hr(this,void 0,void 0,wr.mark(function At(){var nr,kt;return wr.wrap(function(gr){for(;;)switch(gr.prev=gr.next){case 0:return On({serverId:{type:"string",allowEmpty:!1},roleId:{type:"string",allowEmpty:!1},accids:{type:"array",itemType:"string"}},Ie),gr.next=3,this.core.sendCmd("qchatGetExistingAccidsInServerRole",{serverId:Ie.serverId,roleId:Ie.roleId,accids:Eo(Ie.accids)});case 3:return nr=gr.sent,kt=nr.content.members,gr.abrupt("return",kt&&kt.length>0?Ao(kt).call(kt,function(Ar){return Ar.accid}):[]);case 6:case"end":return gr.stop()}},At,this)}))},Ve.updateServerRolePriorities=function(Ie){return Hr(this,void 0,void 0,wr.mark(function At(){var nr,kt;return wr.wrap(function(gr){for(;;)switch(gr.prev=gr.next){case 0:return On({serverId:{type:"string",allowEmpty:!1},serverRoles:{type:"array"}},Ie),gr.next=3,this.core.sendCmd("qchatUpdateServerRolePriorities",{serverId:Ie.serverId,serverRoles:Ao(nr=Ie.serverRoles).call(nr,function(Ar){return{serverId:Ar.serverId,roleId:Ar.roleId,priority:Ar.priority}})});case 3:return kt=gr.sent,gr.abrupt("return",mi(kt.content.serverRoles));case 5:case"end":return gr.stop()}},At,this)}))},Ve.checkPermission=function(Ie){return Hr(this,void 0,void 0,wr.mark(function At(){var nr;return wr.wrap(function(ur){for(;;)switch(ur.prev=ur.next){case 0:return On({serverId:{type:"string",allowEmpty:!1},channelId:{type:"string",allowEmpty:!1,required:!1},auth:{type:"string"}},Ie),ur.next=3,this.core.sendCmd("qchatCheckPermission",{checkPermissionTag:jn(jn({},Ie),{auth:ql[Ie.auth]||Ie.auth})});case 3:return nr=ur.sent,ur.abrupt("return",nr.content.checked);case 5:case"end":return ur.stop()}},At,this)}))},Ve.addChannelCategoryRole=function(Ie){return Hr(this,void 0,void 0,wr.mark(function At(){return wr.wrap(function(kt){for(;;)switch(kt.prev=kt.next){case 0:return kt.next=2,this.category.addChannelCategoryRole(Ie);case 2:return kt.abrupt("return",kt.sent);case 3:case"end":return kt.stop()}},At,this)}))},Ve.removeChannelCategoryRole=function(Ie){return Hr(this,void 0,void 0,wr.mark(function At(){return wr.wrap(function(kt){for(;;)switch(kt.prev=kt.next){case 0:return kt.next=2,this.category.removeChannelCategoryRole(Ie);case 2:return kt.abrupt("return",kt.sent);case 3:case"end":return kt.stop()}},At,this)}))},Ve.updateChannelCategoryRole=function(Ie){return Hr(this,void 0,void 0,wr.mark(function At(){return wr.wrap(function(kt){for(;;)switch(kt.prev=kt.next){case 0:return kt.next=2,this.category.updateChannelCategoryRole(Ie);case 2:return kt.abrupt("return",kt.sent);case 3:case"end":return kt.stop()}},At,this)}))},Ve.getChannelCategoryRole=function(Ie){return Hr(this,void 0,void 0,wr.mark(function At(){return wr.wrap(function(kt){for(;;)switch(kt.prev=kt.next){case 0:return kt.next=2,this.category.getChannelCategoryRole(Ie);case 2:return kt.abrupt("return",kt.sent);case 3:case"end":return kt.stop()}},At,this)}))},Ve.addChannelCategoryMemberRole=function(Ie){return Hr(this,void 0,void 0,wr.mark(function At(){return wr.wrap(function(kt){for(;;)switch(kt.prev=kt.next){case 0:return kt.next=2,this.category.addChannelCategoryMemberRole(Ie);case 2:return kt.abrupt("return",kt.sent);case 3:case"end":return kt.stop()}},At,this)}))},Ve.removeChannelCategoryMemberRole=function(Ie){return Hr(this,void 0,void 0,wr.mark(function At(){return wr.wrap(function(kt){for(;;)switch(kt.prev=kt.next){case 0:return kt.next=2,this.category.removeChannelCategoryMemberRole(Ie);case 2:return kt.abrupt("return",kt.sent);case 3:case"end":return kt.stop()}},At,this)}))},Ve.updateChannelCategoryMemberRole=function(Ie){return Hr(this,void 0,void 0,wr.mark(function At(){return wr.wrap(function(kt){for(;;)switch(kt.prev=kt.next){case 0:return kt.next=2,this.category.updateChannelCategoryMemberRole(Ie);case 2:return kt.abrupt("return",kt.sent);case 3:case"end":return kt.stop()}},At,this)}))},Ve.getChannelCategoryMemberRole=function(Ie){return Hr(this,void 0,void 0,wr.mark(function At(){return wr.wrap(function(kt){for(;;)switch(kt.prev=kt.next){case 0:return kt.next=2,this.category.getChannelCategoryMemberRole(Ie);case 2:return kt.abrupt("return",kt.sent);case 3:case"end":return kt.stop()}},At,this)}))},Ve.checkPermissions=function(Ie){return Hr(this,void 0,void 0,wr.mark(function At(){var nr,kt,ur,gr;return wr.wrap(function(Rr){for(;;)switch(Rr.prev=Rr.next){case 0:return On({serverId:{type:"string",allowEmpty:!1},channelId:{type:"string",allowEmpty:!1,required:!1},auths:{type:"array",itemType:"string"}},Ie),this.core.logger.log("qchatRole::checkPermission options is",Ie),Rr.next=4,this.core.sendCmd("qchatCheckPermissions",{checkPermissionsTag:jn(jn({},Ie),{auths:Eo(Ao(nr=Ie.auths).call(nr,function(Ur){return ql[Ur]||Ur}))})});case 4:return ur=Rr.sent,this.core.logger.log("qchatRole::checkPermission result is",ur.content),gr={},Kn(kt=ur.content.checkPermissionsResult).call(kt,function(Ur){gr[Ur.auth]=Ur.isAllow}),this.core.logger.log("qchatRole::checkPermission auths is",gr),Rr.abrupt("return",Hi(gr));case 10:case"end":return Rr.stop()}},At,this)}))},_e}(Ll),kf=function(_e,Ve){return Ry(_e,Ve,function(Oe,Ie){return Ny(_e,Ie)})},wM=function(_e){return _e!=null&&_e.length?tb(_e,1):[]},Rc,ei,wf=function(_e){return ey(Xv(_e,void 0,wM),_e+"")}(function(pe,_e){return pe==null?{}:kf(pe,_e)}),ov={"24_10":"qchatSendMsg","24_11":"qchatOnMsg","24_12":"qchatOnRecvUnreadInfo","24_13":"qchatSendCustomSysMsg","24_14":"qchatOnSysMsg","24_16":"qchatGetHistoryMsg","24_17":"qchatMarkMessageRead","24_18":"qchatMultiSyncMessageRead","24_22":"qchatUpdateSystemNotification","24_23":"qchatMultiSyncSystemNotificationUpdate","24_24":"qchatSyncSystemNotification","24_25":"qchatUpdateMessage","24_26":"qchatRecvMessageUpdate","24_28":"qchatMarkSysMsgRead","24_94":"qchatMessageSearchByPage","24_100":"qchatGetMessageHistoryByIds","24_101":"qchatGetThreadMessages","24_102":"qchatUpdateQuickComment","24_103":"qchatGetQuickComments","24_108":"qchatGetThreadRootMessagesMeta","24_121":"qchatGetLastMessageOfChannels","24_127":"qchatGetMentionedMeMessages","25_6":"qchatMultiSyncServersMessageRead"},Ns={getHistoryMsgTag:{serverId:1,channelId:2,beginTime:3,endTime:4,excludeMsgId:5,limit:6,reverse:7},getThreadHistoryMsgTag:{beginTime:1,endTime:2,excludeMsgId:3,limit:4,reverse:5},qchatMsgTag:{serverId:1,channelId:2,fromAccount:3,fromClientType:4,fromDeviceId:5,fromNick:6,time:7,updateTime:8,type:9,body:10,attach:11,ext:12,msgIdClient:13,msgIdServer:14,resendFlag:15,status:16,pushPayload:17,pushContent:18,mentionAccids:19,mentionAll:20,env:21,callbackExt:22,replyMsgFromAccount:23,replyMsgTime:24,replyMsgIdServer:25,replyMsgIdClient:26,threadMsgFromAccount:27,threadMsgTime:28,threadMsgIdServer:29,threadMsgIdClient:30,useCustomContent:31,antiSpamContent:32,antiSpamBusinessId:33,antiSpamUsingYidun:34,yidunCallback:35,yidunAntiCheating:36,yidunAntiSpamExt:37,yidunAntiSpamRes:38,mentionRoleIds:41,accidsOfMentionedRoles:42,updateContent:39,updateOperatorInfo:40,subType:61,historyEnable:100,pushEnable:101,needBadge:102,needPushNick:103,notifyReason:104,routeEnable:105,isAntispam:106},sysMsg:{toType:1,serverId:2,channelId:3,toAccids:4,fromAccount:5,fromClientType:6,fromDeviceId:7,fromNick:8,time:9,updateTime:10,type:11,msgIdClient:12,msgIdServer:13,body:14,attach:15,ext:16,resendFlag:17,status:18,pushPayload:19,pushContent:20,env:21,callbackExt:22,persistEnable:100,pushEnable:101,needBadge:102,needPushNick:103,routeEnable:104},qchatMsgUpdateTag:{operatorAccount:1,operatorClientType:2,ps:3,ext:4,pushContent:5,pushPayload:6,env:7,routeEnable:100},markMsgReadTag:{serverId:1,channelId:2,time:3},qchatQuickCommentRequestTag:{serverId:1,channelId:2,fromAccount:3,msgIdServer:4,time:5,type:6,opeType:7,opeAccid:8},qchatQuickCommentQueryTag:{serverId:1,channelId:2,msgIdServerList:3},qchatGetLastMessageOfChannelsTag:{serverId:1,channelIdList:2},qchatMultiSyncServersMessageReadTag:{successServerIds:1,failServerIds:2,ackTimestamp:3},qchatMessageSearchByPageTag:{keyword:1,serverId:2,channelId:3,fromAccid:4,fromTime:5,toTime:6,msgTypes:7,subTypes:8,includeSelf:9,order:10,limit:11,sort:12,cursor:13},qchatPageQueryTag:{hasMore:1,nextTimetag:2,cursor:3},unreadInfo:zh},Oa=zc(Ns),xM={qchatSendMsg:{service:"qchatMsg",sid:24,cid:10,params:[{type:"Property",name:"qchatMsg",reflectMapper:Ns.qchatMsgTag}],response:[{type:"Property",name:"qchatMsg",reflectMapper:Oa.qchatMsgTag}]},qchatOnMsg:{service:"qchatMsg",sid:24,cid:11,response:[{type:"Property",name:"qchatMsg",reflectMapper:Oa.qchatMsgTag}]},qchatOnRecvUnreadInfo:{service:"qchatMsg",sid:24,cid:12,response:[{type:"Property",name:"qchatMsg",reflectMapper:Oa.qchatMsgTag}]},qchatSendCustomSysMsg:{service:"qchatMsg",sid:24,cid:13,params:[{type:"Property",name:"sysMsg",reflectMapper:Ns.sysMsg}],response:[{type:"Property",name:"sysMsg",reflectMapper:Oa.sysMsg}]},qchatOnSysMsg:{service:"qchatMsg",sid:24,cid:14,response:[{type:"Property",name:"sysMsg",reflectMapper:Oa.sysMsg}]},qchatGetHistoryMsg:{service:"qchatMsg",sid:24,cid:16,params:[{type:"Property",name:"getHistoryMsgTag",reflectMapper:Ns.getHistoryMsgTag}],response:[{type:"PropertyArray",name:"qchatMsgs",reflectMapper:Oa.qchatMsgTag}]},qchatUpdateMessage:{service:"qchatMsg",sid:24,cid:25,params:[{type:"Property",name:"qchatMsgUpdateTag",reflectMapper:Ns.qchatMsgUpdateTag},{type:"Property",name:"qchatMsg",reflectMapper:Ns.qchatMsgTag}],response:[{type:"Property",name:"qchatMsg",reflectMapper:Oa.qchatMsgTag}]},qchatRecvMessageUpdate:{service:"qchatMsg",sid:24,cid:26,response:[{type:"Property",name:"qchatMsgUpdateInfo",reflectMapper:Oa.qchatMsgUpdateTag},{type:"Property",name:"qchatMsg",reflectMapper:Oa.qchatMsgTag}]},qchatMarkMessageRead:{sid:24,cid:17,service:"qchatMsg",params:[{type:"Property",name:"markMsgReadTag",reflectMapper:Ns.markMsgReadTag}],response:[{type:"Property",name:"unreadInfo",reflectMapper:Oa.unreadInfo}]},qchatMultiSyncMessageRead:{sid:24,cid:18,service:"qchatMsg",response:[{type:"Property",name:"unreadInfo",reflectMapper:Oa.unreadInfo}]},qchatUpdateSystemNotification:{service:"qchatMsg",sid:24,cid:22,params:[{type:"Property",name:"qchatMsgUpdateTag",reflectMapper:Ns.qchatMsgUpdateTag},{type:"Property",name:"sysMsg",reflectMapper:Ns.sysMsg}],response:[{type:"Property",name:"sysMsg",reflectMapper:Oa.sysMsg}]},qchatMultiSyncSystemNotificationUpdate:{service:"qchatMsg",sid:24,cid:23,response:[{type:"Property",name:"qchatMsgUpdateTag",reflectMapper:Oa.qchatMsgUpdateTag},{type:"Property",name:"sysMsg",reflectMapper:Oa.sysMsg}]},qchatSyncSystemNotification:{service:"qchatMsg",sid:24,cid:24,response:[{type:"PropertyArray",name:"systemNotifications",reflectMapper:Oa.sysMsg}]},qchatMarkSysMsgRead:{service:"qchatMsg",sid:24,cid:28,params:[{type:"PropertyArray",name:"sysMsgs",reflectMapper:Ns.sysMsg}]},qchatMessageSearchByPage:{service:"qchatMsg",sid:24,cid:94,params:[{type:"Property",name:"qchatMessageSearchByPageTag",reflectMapper:Ns.qchatMessageSearchByPageTag}],response:[{type:"Property",name:"listQueryTag",reflectMapper:Oa.qchatPageQueryTag},{type:"PropertyArray",name:"datas",reflectMapper:Oa.qchatMsgTag}]},qchatGetMessageHistoryByIds:{service:"qchatMsg",sid:24,cid:100,params:[{type:"Property",name:"channelInfo",reflectMapper:{serverId:1,channelId:2}},{type:"PropertyArray",name:"messageReferList",reflectMapper:{msgIdServer:1,time:2}}],response:[{type:"PropertyArray",name:"qchatMsgs",reflectMapper:Oa.qchatMsgTag}]},qchatGetThreadMessages:{service:"qchatMsg",sid:24,cid:101,params:[{type:"Property",name:"qchatMsg",reflectMapper:Ns.qchatMsgTag},{type:"Property",name:"getThreadHistoryMsgTag",reflectMapper:Ns.getThreadHistoryMsgTag}],response:[{type:"Property",name:"thread",reflectMapper:Oa.qchatMsgTag},{type:"Property",name:"threadInfo",reflectMapper:{1:"messageCount",2:"lastMessageTimestamp"}},{type:"PropertyArray",name:"qchatMsgs",reflectMapper:Oa.qchatMsgTag}]},qchatUpdateQuickComment:{service:"qchatMsg",sid:24,cid:102,params:[{type:"Property",name:"tag",reflectMapper:Ns.qchatQuickCommentRequestTag}]},qchatGetQuickComments:{service:"qchatMsg",sid:24,cid:103,params:[{type:"Property",name:"tag",reflectMapper:Ns.qchatQuickCommentQueryTag}],response:[{type:"PropertyArray",name:"quickCommentResponse",reflectMapper:{1:"serverId",2:"channelId",3:"msgIdServer",4:"totalCount",5:"lastUpdateTime",6:"details"}}]},qchatGetThreadRootMessagesMeta:{service:"qchatMsg",sid:24,cid:108,params:[{type:"Property",name:"tag",reflectMapper:{serverId:1,channelId:2}},{type:"PropertyArray",name:"qchatMsgs",reflectMapper:{time:7,msgIdServer:14}}],response:[{type:"PropertyArray",name:"metas",reflectMapper:{1:"total",2:"timestamp",3:"msgIdServer",4:"msgTime"}}]},qchatGetLastMessageOfChannels:{service:"qchatMsg",sid:24,cid:121,params:[{type:"Property",name:"tag",reflectMapper:Ns.qchatGetLastMessageOfChannelsTag}],response:[{type:"PropertyArray",name:"msgs",reflectMapper:Oa.qchatMsgTag}]},qchatMultiSyncServersMessageRead:{service:"qchatMsg",sid:25,cid:6,response:[{type:"Property",name:"qchatMultiSyncServersMessageReadTag",reflectMapper:Oa.qchatMultiSyncServersMessageReadTag}]},qchatGetMentionedMeMessages:{service:"qchatMsg",sid:24,cid:127,params:[{type:"Property",name:"tag",reflectMapper:{serverId:1,channelId:2,timestamp:3,limit:4}}],response:[{type:"Property",name:"page",reflectMapper:Oa.qchatPageQueryTag},{type:"PropertyArray",name:"datas",reflectMapper:Oa.qchatMsgTag}]}};(function(pe){pe[pe.Android=1]="Android",pe[pe.iOS=2]="iOS",pe[pe.PC=4]="PC",pe[pe.WindowsPhone=8]="WindowsPhone",pe[pe.Web=16]="Web",pe[pe.Server=32]="Server",pe[pe.Mac=64]="Mac"})(Rc||(Rc={}));var cb=["image","audio","video","file"],xf={time:{type:"number"},updateTime:{type:"number"},resendFlag:{type:"boolean"},persistEnable:{type:"boolean"},routeEnable:{type:"boolean"},pushEnable:{type:"boolean"},needBadge:{type:"boolean"},needPushNick:{type:"boolean"},type:{type:"enum",values:ga},fromClientType:{type:"enum",values:Rc},status:{type:"number"},toAccids:{type:"object"},toType:{type:"number"},attach:{type:"object"},pushPayload:{type:"object"}};function av(pe,_e){var Ve=jn({},pe),Oe=jn({type:_e||ga.custom},yu(xf,Ve));return Oe.serverId&&Oe.channelId&&Oe.toAccids?Oe.toType=tl.channelAccids:Oe.serverId&&Oe.toAccids?Oe.toType=tl.serverAccids:Oe.serverId&&Oe.channelId?Oe.toType=tl.channel:Oe.serverId?Oe.toType=tl.server:Oe.toAccids?Oe.toType=tl.accids:Oe.toType=tl.unknown,Oe}function lb(pe){var _e=wf(pe,["msgIdServer","type"]);return yu(xf,_e)}var ub=((ei={})[ga.channelUpdateWhiteBlackIdentify]=function(pe){return pe.notify=rp(es(pe.notify,ia.qchatUpdateWhiteBlackRoleTag)),pe},ei[ga.channelUpdateWhiteBlackIdentifyUser]=function(pe){return pe.notify=function(Ve){return $a(Zy,Ve)}(es(pe.notify,ia.qchatUpdateWhiteBlackMembersTag)),pe},ei[ga.updateQuickComment]=function(pe){return pe.notify=function(Ve){return $a(EM,Ve)}(es(pe.notify,Oa.qchatQuickCommentRequestTag)),pe},ei[ga.channelCategoryCreate]=function(pe){return pe.categoryInfo=sp(es(pe.categoryInfo,ia.QChatChannelCategoryInfo)),pe},ei[ga.channelCategoryUpdate]=function(pe){return pe.categoryInfo=sp(es(pe.categoryInfo,ia.QChatChannelCategoryInfo)),pe},ei[ga.channelCategoryUpdateWhiteBlackIdentify]=function(pe){return pe.notify=rp(es(pe.notify,ia.qchatUpdateChannelCategoryWhiteBlackRoleTag)),pe},ei[ga.channelCategoryUpdateWhiteBlackIdentifyUser]=function(pe){return pe.notify=rp(es(pe.notify,ia.qchatUpdateChannelCategoryWhiteBlackMembersTag)),pe},ei[ga.serverIdentifyAdd]=function(pe){return pe.serverIdentifyInfo=As(es(pe.serverIdentifyInfo,Ea.serverRole)),pe},ei[ga.serverIdentifyRemove]=function(pe){return pe.serverIdentifyInfo=As(es(pe.serverIdentifyInfo,Ea.serverRole)),pe},ei[ga.serverIdentifyUpdate]=function(pe){return pe.serverIdentifyInfo=As(es(pe.serverIdentifyInfo,Ea.serverRole)),pe},ei[ga.channelIdentifyUpdate]=function(pe){return pe.channelIdentifyInfo=As(es(pe.channelIdentifyInfo,Ea.channelRole)),pe},ei[ga.userIdentifyUpdate]=function(pe){return pe.userIdentifyInfo=As(es(pe.userIdentifyInfo,Ea.memberRole)),pe},ei[ga.myMemberInfoUpdated]=function(pe){var _e,Ve=ms(pe,"userInfo.name"),Oe=ms(pe,"userInfo.icon");return pe.updatedInfos=Ao(_e=pe.reuseServers).call(_e,function(Ie){var At={serverId:Ie.serverId};return(1&Ie.bits)==1&&typeof Ve=="string"&&jn(At,{nickChanged:!0,nick:Ve}),(2&Ie.bits)==2&&typeof Oe=="string"&&jn(At,{avatarChanged:!0,avatar:Oe}),At}),delete pe.userInfo,delete pe.reuseServers,pe},ei);function pp(pe,_e){var Ve=$a(xf,pe);if(!Ve.attach)return Ve;if(Ve.attach.serverInfo&&(Ve.attach.serverInfo=Zd(es(Ve.attach.serverInfo,os.serverInfo))),Ve.attach.channelInfo&&(Ve.attach.channelInfo=np(es(Ve.attach.channelInfo,ia.channelInfo))),Ve.attach.serverMember&&(Ve.attach.serverMember=bu(es(Ve.attach.serverMember,os.memberInfo))),ub[Ve.attach.type]&&(Ve.attach=ub[Ve.attach.type](Ve.attach)),Ve.attach.updateAuths)try{Ve.attach.updateAuths=Hi(JSON.parse(Ve.attach.updateAuths))}catch(Oe){_e.error("formatSystemNotification:JSON parse updateAuths error: ",Oe)}return Ve.attach.type&&(Ve.attach.rawType=Ve.attach.type,Ve.attach.type=ga[Ve.attach.type]),Ve}var _f={type:{type:"enum",values:lp},fromClientType:{type:"enum",values:Rc},status:{type:"number"},resendFlag:{type:"boolean"},mentionAll:{type:"boolean"},notifyReason:{type:"enum",values:up},pushEnable:{type:"boolean"},historyEnable:{type:"boolean"},needBadge:{type:"boolean"},needPushNick:{type:"boolean"},routeEnable:{type:"boolean"},time:{type:"number"},updateTime:{type:"number"},mentionAccids:{type:"object"},mentionRoleIds:{type:"object"},accidsOfMentionedRoles:{type:"object"},attach:{type:"object"},pushPayload:{type:"object"},isAntispam:{type:"boolean"},antiSpamInfo:{useCustomContent:{type:"boolean"},antiSpamContent:{type:"string"},antiSpamBusinessId:{type:"string"},antiSpamUsingYidun:{type:"boolean"},yidunCallback:{type:"string"},yidunAntiCheating:{type:"object"},yidunAntiSpamExt:{type:"object"},yidunAntiSpamRes:{type:"string"}},replyRefer:{fromAccount:{type:"string",rawKey:"replyMsgFromAccount"},time:{type:"number",rawKey:"replyMsgTime"},msgIdServer:{type:"string",rawKey:"replyMsgIdServer"},msgIdClient:{type:"string",rawKey:"replyMsgIdClient"}},threadRefer:{fromAccount:{type:"string",rawKey:"threadMsgFromAccount"},time:{type:"number",rawKey:"threadMsgTime"},msgIdServer:{type:"string",rawKey:"threadMsgIdServer"},msgIdClient:{type:"string",rawKey:"threadMsgIdClient"}}};function sv(pe){pe.onSendBefore,pe.onUploadStart,pe.onUploadDone,pe.onUploadProgress;var _e=Yl(pe,["onSendBefore","onUploadStart","onUploadDone","onUploadProgress"]),Ve=yu(_f,_e);if(Ve.msgIdClient=pe.resendFlag?pe.msgIdClient:dh(),!Ve.msgIdClient)throw new Zl("msgIdClient is required for resend a message","msgIdClient","required");return pe.replyMessage&&pe.replyMessage.msgIdServer&&(Ve.replyMsgFromAccount=pe.replyMessage.fromAccount,Ve.replyMsgTime=+pe.replyMessage.time,Ve.replyMsgIdServer=pe.replyMessage.msgIdServer,Ve.replyMsgIdClient=pe.replyMessage.msgIdClient,pe.replyMessage.threadRefer&&pe.replyMessage.threadRefer.msgIdServer?(Ve.threadMsgFromAccount=pe.replyMessage.threadRefer.fromAccount,Ve.threadMsgTime=+pe.replyMessage.threadRefer.time,Ve.threadMsgIdServer=pe.replyMessage.threadRefer.msgIdServer,Ve.threadMsgIdClient=pe.replyMessage.threadRefer.msgIdClient):(Ve.threadMsgFromAccount=pe.replyMessage.fromAccount,Ve.threadMsgTime=+pe.replyMessage.time,Ve.threadMsgIdServer=pe.replyMessage.msgIdServer,Ve.threadMsgIdClient=pe.replyMessage.msgIdClient),delete Ve.replyMessage),Ve}function db(pe){return $a({operatorClientType:{type:"enum",values:Rc},pushPayload:{type:"object"}},pe)}function zs(pe,_e,Ve){var Oe,Ie;return _e===void 0&&(_e={}),Hr(this,void 0,void 0,wr.mark(function At(){var nr,kt,ur;return wr.wrap(function(Ar){for(;;)switch(Ar.prev=Ar.next){case 0:return(nr=$a(_f,pe)).deliveryStatus=_e.deliveryStatus?zi[_e.deliveryStatus]:zi[zi.success],_e.time&&(nr.time=_e.time),nr.updateContent&&(kt=$a({status:{type:"number"}},kt=es(kt=JSON.parse(nr.updateContent),Oa.qchatMsgTag)),nr.updateContent=kt),nr.updateOperatorInfo&&(ur=db(es(ur=JSON.parse(nr.updateOperatorInfo),Oa.qchatMsgUpdateTag)),nr.updateOperatorInfo=ur),((Oe=nr==null?void 0:nr.threadRefer)===null||Oe===void 0?void 0:Oe.fromAccount)===""&&delete nr.threadRefer,((Ie=nr==null?void 0:nr.replyRefer)===null||Ie===void 0?void 0:Ie.fromAccount)===""&&delete nr.replyRefer,nr.attach&&_e.attachUrl&&(nr.attach.url=_e.attachUrl),Ar.next=10,pb(nr,Ve);case 10:return Ar.abrupt("return",Ar.sent);case 11:case"end":return Ar.stop()}},At)}))}function pb(pe,_e){return Hr(this,void 0,void 0,wr.mark(function Ve(){var Oe;return wr.wrap(function(At){for(;;)switch(At.prev=At.next){case 0:if(Li(cb).call(cb,pe.type)&&pe.attach&&pe.attach.url){At.next=2;break}return At.abrupt("return",pe);case 2:if(_e&&_e.cloudStorage&&typeof _e.cloudStorage.getPrivateUrl=="function"&&typeof _e.cloudStorage.getOriginUrl=="function"){At.next=4;break}return At.abrupt("return",pe);case 4:if(!(Na(Oe=pe.attach.url).call(Oe,"_im_url=1")<0)){At.next=7;break}return pe.attach.url=_e.cloudStorage.getPrivateUrl(pe.attach.url),At.abrupt("return",pe);case 7:return At.prev=7,At.next=10,_e.cloudStorage.getOriginUrl(pe.attach.url);case 10:pe.attach.url=At.sent,At.next=16;break;case 13:throw At.prev=13,At.t0=At.catch(7),new Zl('url "'+pe.attach.url+'" parse error',"message.attach.url","parse error");case 16:return At.abrupt("return",pe);case 17:case"end":return At.stop()}},Ve,null,[[7,13]])}))}function iv(pe,_e,Ve){return _e===void 0&&(_e={}),Hr(this,void 0,void 0,wr.mark(function Oe(){var Ie;return wr.wrap(function(nr){for(;;)switch(nr.prev=nr.next){case 0:if(ks(pe)&&pe.length>0){nr.next=2;break}return nr.abrupt("return",[]);case 2:return Ie=Ao(pe).call(pe,function(kt){return zs(kt,_e,Ve)}),nr.next=5,wo.all(Ie);case 5:return nr.abrupt("return",nr.sent);case 6:case"end":return nr.stop()}},Oe)}))}var _M={totalCount:{type:"number"},lastUpdateTime:{type:"number"},details:{type:"object"}};function IM(pe){var _e=Ao(pe).call(pe,function(Oe){var Ie,At=$a(_M,Oe);return At.details=Ao(Ie=At.details).call(Ie,function(nr){return{count:nr.count,hasSelf:nr.self,severalAccids:nr.topN,type:nr.type}}),At}),Ve={};return Kn(_e).call(_e,function(Oe){return Ve[Oe.msgIdServer]=Oe}),Ve}var EM={type:{type:"number"},time:{type:"number"},opeType:{type:"number"}},fb={includeSelf:{type:"number"},order:{type:"enum",values:Yc},sort:{type:"enum",values:Mf},msgTypes:{type:"object"},subTypes:{type:"object"}},PM={hasMore:{type:"boolean"},nextTimetag:{type:"number"},cursor:{type:"string"}},AM={6:function(_e){return this.core.qchatChannel.subscribeForVisitorService.deleteAutoSetInServerId(_e.serverId),!0},16:function(_e){return this.core.qchatChannel.subscribeForVisitorService.deleteAutoSetInChannel(_e.serverId,_e.channelId),!0},26:function(_e){var Ve=ms(_e,"attach.addAccids");return Ve&&Li(Ve).call(Ve,this.core.account)&&this.core.eventBus.emit("qchatChannel/serverIdentifyChange",_e),!0},27:function(_e){var Ve=ms(_e,"attach.deleteAccids");return Ve&&Li(Ve).call(Ve,this.core.account)&&this.core.eventBus.emit("qchatChannel/serverIdentifyChange",_e),!0},31:function(_e){return _e.attach.event===2&&(this.core.eventBus.emit("qchatChannel/autoUnSubscribe",_e),this.core.eventBus.emit("qchatMedia/serverOrChannelLeave",_e)),!0},32:function(_e){return _e.attach.event===2?(this.core.eventBus.emit("qchatChannel/autoUnSubscribe",_e),this.core.eventBus.emit("qchatMedia/serverOrChannelLeave",_e)):_e.attach.event===1&&this.core.qchatChannel.subscribeForVisitorService.deleteServer(_e.serverId),!0},34:function(_e){return _e.attach.event===2&&this.core.qchatChannel.subscribeForVisitorService.unSubscribeChannel(_e.serverId,_e.channelId),!0},101:function(_e){var Ve=wf(_e,["serverId","channelId","ext","fromAccount","fromNick","time"]);return this.logger.log("qchat on recvTypingEvent: ",Ve),this.core.emit("recvTypingEvent",Ve),!1}},NM=function(){function pe(Ve){this.core=Ve,this.logger=Ve.logger}var _e=pe.prototype;return _e.sendSystemNotification=function(Oe){return Hr(this,void 0,void 0,wr.mark(function Ie(){var At,nr;return wr.wrap(function(ur){for(;;)switch(ur.prev=ur.next){case 0:return ur.next=2,this.core.sendCmd("qchatSendCustomSysMsg",{sysMsg:av(Oe)});case 2:return At=ur.sent,nr=pp(At.content.sysMsg,this.logger),this.core.options.debugLevel==="debug"?this.logger.debug("sendCustomSysMsg success",nr):this.logger.log("sendCustomSysMsg success",nr.serverId,nr.channelId,nr.msgIdServer),ur.abrupt("return",nr);case 6:case"end":return ur.stop()}},Ie,this)}))},_e.updateSystemNotification=function(Oe){return Hr(this,void 0,void 0,wr.mark(function Ie(){var At,nr,kt,ur,gr;return wr.wrap(function(Rr){for(;;)switch(Rr.prev=Rr.next){case 0:return At=Oe.systemNotification,nr=Yl(Oe,["systemNotification"]),kt=wf(At,["msgIdServer","type","body","ext","status"]),ur=av(kt),Rr.next=5,this.core.sendCmd("qchatUpdateSystemNotification",{sysMsg:ur,qchatMsgUpdateTag:jn(jn({},nr),{operatorAccount:this.core.account,operatorClientType:Rc.Web,pushPayload:Eo(Oe.pushPayload),routeEnable:Gh.boolean(Oe,"routeEnable")})});case 5:return gr=Rr.sent,Rr.abrupt("return",pp(gr.content.sysMsg,this.logger));case 7:case"end":return Rr.stop()}},Ie,this)}))},_e.markSystemNotificationsRead=function(Oe){return Hr(this,void 0,void 0,wr.mark(function Ie(){var At;return wr.wrap(function(kt){for(;;)switch(kt.prev=kt.next){case 0:return kt.next=2,this.core.sendCmd("qchatMarkSysMsgRead",{sysMsgs:Ao(At=Oe.systemNotifications).call(At,function(ur){return lb(ur)})});case 2:case"end":return kt.stop()}},Ie,this)}))},_e.onSysMsg=function(Oe){var Ie=Oe.content.sysMsg;if(Ie){var At=pp(Ie,this.core.logger),nr=AM[ga[At.type]];if(nr&&nr.call(this,At)===!1)return;var kt={feature:"default",systemNotifications:[At]};this.logger.log("qchat on systemNotification: ",kt),this.core.emit("systemNotification",kt)}else this.core.logger.warn("No sysMsg in onSysMsg packet")},_e.onMultiSysMsg=function(Oe){var Ie=Oe.content.sysMsg;if(Ie){var At=pp(Ie,this.logger);this.core.emit("systemNotificationUpdate",At)}},_e.onSyncSysMsg=function(Oe){var Ie=this,At=Oe.content.systemNotifications;if(At&&At.length>0){var nr=Ao(At).call(At,function(kt){return pp(kt,Ie.logger)});this.core.emit("systemNotification",{feature:"sync",systemNotifications:nr})}else this.logger.warn("sync system notification not exist")},pe}(),cv=["image","audio","video","file"],OM=function(){function pe(Ve){var Oe=this;this.markMessageRead=rv(function(Ie){return Hr(Oe,void 0,void 0,wr.mark(function At(){var nr,kt;return wr.wrap(function(gr){for(;;)switch(gr.prev=gr.next){case 0:return gr.next=2,this.core.sendCmd("qchatMarkMessageRead",{markMsgReadTag:Ie});case 2:nr=gr.sent,kt=Qh(nr.content.unreadInfo),this.core.eventBus.emit("qchatChannel/updateUnreads",[kt]);case 5:case"end":return gr.stop()}},At,this)}))},200),this.core=Ve,this.logger=Ve.logger}var _e=pe.prototype;return _e.sendMessage=function(Oe){var Ie,At,nr,kt;return Hr(this,void 0,void 0,wr.mark(function ur(){var gr,Ar,Rr,Ur,Dr,Jr;return wr.wrap(function(Sn){for(;;)switch(Sn.prev=Sn.next){case 0:if(!(Na(cv).call(cv,Oe.type)>-1)){Sn.next=4;break}return Sn.next=3,this.doSendFile(Oe);case 3:Oe.attach=Sn.sent;case 4:return gr=sv(jn({fromAccount:this.core.account},Oe)),Sn.next=7,zs(gr,{time:new Date().getTime(),deliveryStatus:zi.sending},this.core);case 7:Ar=Sn.sent;try{Oe.onSendBefore&&Oe.onSendBefore(Ar)}catch($n){this.logger.error("sendMsg: options.onSendBefore error",$n)}return Sn.prev=9,Sn.next=12,this.core.sendCmd("qchatSendMsg",{qchatMsg:gr});case 12:Rr=Sn.sent,Sn.next=22;break;case 15:return Sn.prev=15,Sn.t0=Sn.catch(9),Sn.next=19,zs(gr,{time:new Date().getTime(),deliveryStatus:zi.failed,attachUrl:(Ie=Ar.attach)===null||Ie===void 0?void 0:Ie.url},this.core);case 19:throw Ur=Sn.sent,Sn.t0.msg=Ur,Sn.t0;case 22:return Dr=Rr.content,Sn.next=25,zs(jn({},Dr.qchatMsg),{deliveryStatus:zi.success,attachUrl:(At=Ar.attach)===null||At===void 0?void 0:At.url},this.core);case 25:if(!(Jr=Sn.sent).isAntispam){Sn.next=29;break}throw{code:10403,msg:Jr,message:((nr=Jr==null?void 0:Jr.antiSpamInfo)===null||nr===void 0?void 0:nr.yidunAntiSpamRes)||"message has be antispam",isAntispam:!0,yidunAntiSpamRes:((kt=Jr==null?void 0:Jr.antiSpamInfo)===null||kt===void 0?void 0:kt.yidunAntiSpamRes)||""};case 29:return Sn.abrupt("return",Jr);case 30:case"end":return Sn.stop()}},ur,this,[[9,15]])}))},_e.doSendFile=function(Oe){return Hr(this,void 0,void 0,wr.mark(function Ie(){var At;return wr.wrap(function(kt){for(;;)switch(kt.prev=kt.next){case 0:if(On({type:{type:"enum",values:["image","audio","video","file"]},attach:{type:"object",rules:{url:{type:"string",allowEmpty:!1}},required:!1},maxSize:{type:"number",min:1,required:!1}},Oe),At=Oe.attach){kt.next=23;break}if(this.core.cloudStorage&&this.core.cloudStorage.uploadFile){kt.next=5;break}throw new Error('Service "cloudStorage" does not exist');case 5:return kt.prev=5,kt.next=8,this.core.cloudStorage.uploadFile(Oe);case 8:At=kt.sent,kt.next=15;break;case 11:throw kt.prev=11,kt.t0=kt.catch(5),this.logger.error("sendFile:: upload File error or abort",kt.t0),kt.t0;case 15:kt.prev=15,Oe.onUploadDone&&Oe.onUploadDone(At),kt.next=23;break;case 19:throw kt.prev=19,kt.t1=kt.catch(15),this.logger.error("sendFile options.onUploadDone err",kt.t1),kt.t1;case 23:return kt.abrupt("return",At);case 24:case"end":return kt.stop()}},Ie,this,[[5,11],[15,19]])}))},_e.resendMessage=function(Oe){var Ie,At;return Hr(this,void 0,void 0,wr.mark(function nr(){var kt,ur,gr,Ar,Rr;return wr.wrap(function(Dr){for(;;)switch(Dr.prev=Dr.next){case 0:return(kt=sv(jn(jn({},Oe),{resendFlag:!0}))).deliveryStatus=zi.sending,Dr.prev=2,Dr.next=5,this.core.sendCmd("qchatSendMsg",{qchatMsg:kt});case 5:ur=Dr.sent,Dr.next=15;break;case 8:return Dr.prev=8,Dr.t0=Dr.catch(2),Dr.next=12,zs(kt,{time:new Date().getTime(),deliveryStatus:zi.failed},this.core);case 12:throw gr=Dr.sent,Dr.t0.msg=gr,Dr.t0;case 15:return Ar=ur.content,Dr.next=18,zs(jn({},Ar.qchatMsg),{deliveryStatus:zi.success},this.core);case 18:if(!(Rr=Dr.sent).isAntispam){Dr.next=22;break}throw{code:10403,msg:Rr,message:((Ie=Rr==null?void 0:Rr.antiSpamInfo)===null||Ie===void 0?void 0:Ie.yidunAntiSpamRes)||"message has be antispam",isAntispam:!0,yidunAntiSpamRes:((At=Rr==null?void 0:Rr.antiSpamInfo)===null||At===void 0?void 0:At.yidunAntiSpamRes)||""};case 22:return Dr.abrupt("return",Rr);case 23:case"end":return Dr.stop()}},nr,this,[[2,8]])}))},_e.doUpdateMessage=function(Oe){var Ie,At;return Hr(this,void 0,void 0,wr.mark(function nr(){var kt,ur,gr,Ar,Rr;return wr.wrap(function(Dr){for(;;)switch(Dr.prev=Dr.next){case 0:return kt=Oe.message,ur=Yl(Oe,["message"]),(gr=sv(kt)).msgIdClient=void 0,gr.time=kt.time,Dr.next=6,this.core.sendCmd("qchatUpdateMessage",{qchatMsg:gr,qchatMsgUpdateTag:jn(jn({},ur),{operatorAccount:this.core.account,operatorClientType:Rc.Web,pushPayload:Eo(Oe.pushPayload),routeEnable:Gh.boolean(Oe,"routeEnable")})});case 6:return Ar=Dr.sent,Dr.next=9,zs(Ar.content.qchatMsg,{},this.core);case 9:if(Rr=Dr.sent,this.core.eventBus.emit("qchatChannel/changeUnread",Rr,!0),!Ar.content.qchatMsg.isAntispam){Dr.next=14;break}throw{code:10403,msg:gr,message:((Ie=Ar.content.qchatMsg)===null||Ie===void 0?void 0:Ie.yidunAntiSpamRes)||"message has be antispam",isAntispam:!0,yidunAntiSpamRes:((At=Ar.content.qchatMsg)===null||At===void 0?void 0:At.yidunAntiSpamRes)||""};case 14:return Dr.abrupt("return",Rr);case 15:case"end":return Dr.stop()}},nr,this)}))},_e.getHistoryMessage=function(Oe){return Hr(this,void 0,void 0,wr.mark(function Ie(){var At,nr,kt,ur=this;return wr.wrap(function(Ar){for(;;)switch(Ar.prev=Ar.next){case 0:return Ar.next=2,this.core.sendCmd("qchatGetHistoryMsg",{getHistoryMsgTag:jn(jn({},Oe),{reverse:Kl(Oe)?1:0})});case 2:return nr=Ar.sent,kt=nr.content,Ar.next=6,wo.all(Ao(At=kt.qchatMsgs).call(At,function(Rr){return zs(Rr,{},ur.core)}));case 6:return Ar.abrupt("return",Ar.sent);case 7:case"end":return Ar.stop()}},Ie,this)}))},_e.getMentionedMeMessages=function(Oe){return Hr(this,void 0,void 0,wr.mark(function Ie(){var At,nr,kt,ur,gr,Ar=this;return wr.wrap(function(Ur){for(;;)switch(Ur.prev=Ur.next){case 0:return Ur.next=2,this.core.sendCmd("qchatGetMentionedMeMessages",{tag:Oe});case 2:return nr=Ur.sent,kt=nr.content,Dr=kt.page,ur=$a(PM,Dr),Ur.next=7,wo.all(Ao(At=kt.datas).call(At,function(Jr){return zs(Jr,{},Ar.core)}));case 7:return gr=Ur.sent,Ur.abrupt("return",{pageInfo:ur,messages:gr});case 9:case"end":return Ur.stop()}var Dr},Ie,this)}))},_e.areMentionedMeMessages=function(Oe){return Hr(this,void 0,void 0,wr.mark(function Ie(){var At,nr,kt;return wr.wrap(function(gr){for(;;)switch(gr.prev=gr.next){case 0:At={},nr=0;case 2:if(!(nr<Oe.length)){gr.next=13;break}if((kt=Oe[nr]).fromAccount!==this.core.account){gr.next=7;break}return At[kt.msgIdClient]=!1,gr.abrupt("continue",10);case 7:return gr.next=9,this.core.qchatChannel.subscribeModuleService.getMentionedFlag(kt,!0);case 9:At[kt.msgIdClient]=gr.sent;case 10:nr++,gr.next=2;break;case 13:return gr.abrupt("return",At);case 14:case"end":return gr.stop()}},Ie,this)}))},_e.getLastMessageOfChannels=function(Oe){return Hr(this,void 0,void 0,wr.mark(function Ie(){var At,nr,kt;return wr.wrap(function(gr){for(;;)switch(gr.prev=gr.next){case 0:return gr.next=2,this.core.sendCmd("qchatGetLastMessageOfChannels",{tag:Oe});case 2:return At=gr.sent,nr=At.content.msgs,gr.next=6,iv(nr,{},this.core);case 6:return kt=gr.sent,gr.abrupt("return",Hc(kt).call(kt,function(Ar,Rr){return Ar[Rr.channelId]=Rr,Ar},{}));case 8:case"end":return gr.stop()}},Ie,this)}))},_e.messageSearchByPage=function(Oe){return Hr(this,void 0,void 0,wr.mark(function Ie(){var At,nr,kt,ur,gr;return wr.wrap(function(Rr){for(;;)switch(Rr.prev=Rr.next){case 0:return Rr.next=2,this.core.sendCmd("qchatMessageSearchByPage",{qchatMessageSearchByPageTag:jn(jn({},(Ur=Oe,yu(fb,Ur))),{includeSelf:Oe.includeSelf?1:""})});case 2:return At=Rr.sent,nr=At.content,kt=nr.datas,ur=nr.listQueryTag,Rr.next=6,iv(kt,{},this.core);case 6:return gr=Rr.sent,Rr.abrupt("return",{listQueryTag:{hasMore:+ur.hasMore==1,nextTimetag:ur.nextTimetag?Yo(ur.nextTimetag):0,cursor:ur.cursor},datas:gr});case 8:case"end":return Rr.stop()}var Ur},Ie,this)}))},_e.onMsg=function(Oe){return Hr(this,void 0,void 0,wr.mark(function Ie(){var At,nr;return wr.wrap(function(ur){for(;;)switch(ur.prev=ur.next){case 0:if(At=Oe.content.qchatMsg){ur.next=4;break}return this.logger.warn("No qchatMsg in qchatMsg packet"),ur.abrupt("return");case 4:return ur.next=6,zs(At,{},this.core);case 6:nr=ur.sent,this.core.eventBus.emit("qchatChannel/changeUnread",nr,!1),this.core.emit("message",nr);case 9:case"end":return ur.stop()}},Ie,this)}))},_e.onRecvUnreadInfo=function(Oe){return Hr(this,void 0,void 0,wr.mark(function Ie(){var At,nr;return wr.wrap(function(ur){for(;;)switch(ur.prev=ur.next){case 0:if(At=Oe.content.qchatMsg){ur.next=3;break}return ur.abrupt("return");case 3:return ur.next=5,zs(At);case 5:nr=ur.sent,this.core.eventBus.emit("qchatChannel/changeUnread",nr,!1);case 7:case"end":return ur.stop()}},Ie,this)}))},_e.onMultiSyncRead=function(Oe){var Ie=Oe.content.unreadInfo;if(Ie){var At=Qh(Ie);this.core.eventBus.emit("qchatChannel/updateUnreads",[At])}},_e.onMultiSyncServersRead=function(Oe){var Ie=Oe.content.qchatMultiSyncServersMessageReadTag;if(Ie){var At=Dl(Ie),nr=At.successServerIds,kt=At.ackTimestamp;this.core.eventBus.emit("qchatChannel/clearUnreadCountByServers",nr,kt)}},_e.onRecvMsgUpdate=function(Oe){return Hr(this,void 0,void 0,wr.mark(function Ie(){var At,nr,kt,ur;return wr.wrap(function(Ar){for(;;)switch(Ar.prev=Ar.next){case 0:if(At=Oe.content.qchatMsg,nr=Oe.content.qchatMsgUpdateInfo,At){Ar.next=4;break}return Ar.abrupt("return");case 4:return Ar.next=6,zs(At,{},this.core);case 6:kt=Ar.sent,ur=db(nr),this.core.eventBus.emit("qchatChannel/changeUnread",kt,!0),this.core.emit("messageUpdate",kt,ur);case 10:case"end":return Ar.stop()}},Ie,this)}))},pe}(),RM=function(){function pe(Ve){var Oe=this;this._sendTypingEvent=rv(function(Ie){return Hr(Oe,void 0,void 0,wr.mark(function At(){return wr.wrap(function(kt){for(;;)switch(kt.prev=kt.next){case 0:return kt.next=2,this.core.sendCmd("qchatSendCustomSysMsg",{sysMsg:av(jn(jn({},Ie),{resendFlag:!1,persistEnable:!1,routeEnable:!1,pushEnable:!1,needBadge:!1,needPushNick:!1}),ga.msgTyping)});case 2:case"end":return kt.stop()}},At,this)}))},3e3),this.core=Ve,this.logger=Ve.logger,this.lastChannelIdInTyping=""}var _e=pe.prototype;return _e.getMessageHistoryByIds=function(Oe){return Hr(this,void 0,void 0,wr.mark(function Ie(){var At,nr;return wr.wrap(function(ur){for(;;)switch(ur.prev=ur.next){case 0:return ur.next=2,this.core.sendCmd("qchatGetMessageHistoryByIds",{channelInfo:{serverId:Oe.serverId,channelId:Oe.channelId},messageReferList:Oe.messageReferList});case 2:return nr=ur.sent,ur.abrupt("return",wo.all(Ao(At=nr.content.qchatMsgs).call(At,function(gr){return zs(gr)})));case 4:case"end":return ur.stop()}},Ie,this)}))},_e.getReferMessages=function(Oe){var Ie,At;return Hr(this,void 0,void 0,wr.mark(function nr(){var kt;return wr.wrap(function(gr){for(;;)switch(gr.prev=gr.next){case 0:if(!((Ie=Oe.message.replyRefer)===null||Ie===void 0)&&Ie.msgIdServer&&(!((At=Oe.message.threadRefer)===null||At===void 0)&&At.msgIdServer)){gr.next=2;break}throw new Error("Message has no reply");case 2:return gr.next=4,this.getMessageHistoryByIds({serverId:Oe.message.serverId,channelId:Oe.message.channelId,messageReferList:[Oe.message.replyRefer,Oe.message.threadRefer]});case 4:if(kt=gr.sent,Oe.referType!==Nc[Nc.all]){gr.next=9;break}return gr.abrupt("return",{replyMessage:kt[0],threadMessage:kt[1]});case 9:if(Oe.referType!==Nc[Nc.reply]){gr.next=13;break}return gr.abrupt("return",{replyMessage:kt[0]});case 13:if(Oe.referType!==Nc[Nc.thread]){gr.next=15;break}return gr.abrupt("return",{threadMessage:kt[1]});case 15:return gr.abrupt("return",{replyMessage:kt[0],threadMessage:kt[1]});case 16:case"end":return gr.stop()}},nr,this)}))},_e.getThreadMessages=function(Oe){var Ie;return Hr(this,void 0,void 0,wr.mark(function At(){var nr,kt,ur,gr,Ar;return wr.wrap(function(Ur){for(;;)switch(Ur.prev=Ur.next){case 0:return kt=!((Ie=Oe.message.threadRefer)===null||Ie===void 0)&&Ie.msgIdServer?jn({serverId:Oe.message.serverId,channelId:Oe.message.channelId},Oe.message.threadRefer):Oe.message,Ur.next=3,this.core.sendCmd("qchatGetThreadMessages",{qchatMsg:kt,getThreadHistoryMsgTag:jn(jn({},Oe.messageQueryOption),{reverse:Gh.boolean(Oe.messageQueryOption,"reverse")})});case 3:return ur=Ur.sent,Ur.next=6,zs(ur.content.thread);case 6:return gr=Ur.sent,Ur.next=9,wo.all(Ao(nr=ur.content.qchatMsgs).call(nr,function(Dr){return zs(Dr)}));case 9:return Ar=Ur.sent,Ur.abrupt("return",{thread:gr,threadInfo:{messageCount:+ur.content.threadInfo.messageCount,lastMessageTimestamp:+ur.content.threadInfo.lastMessageTimestamp},messages:Ar});case 11:case"end":return Ur.stop()}},At,this)}))},_e.getThreadRootMessagesMeta=function(Oe){return Hr(this,void 0,void 0,wr.mark(function Ie(){var At,nr,kt,ur;return wr.wrap(function(Ar){for(;;)switch(Ar.prev=Ar.next){case 0:return At=Oe.threadRootMessages,nr=Yl(Oe,["threadRootMessages"]),Ar.next=3,this.core.sendCmd("qchatGetThreadRootMessagesMeta",{qchatMsgs:At,tag:nr});case 3:if(kt=Ar.sent,!((ur=kt.content.metas)&&ur.length>0)){Ar.next=7;break}return Ar.abrupt("return",Ao(ur).call(ur,function(Rr){return jn(jn({},Rr),{total:Yo(Rr.total),timestamp:Yo(Rr.timestamp),msgTime:Yo(Rr.msgTime)})}));case 7:return Ar.abrupt("return",[]);case 8:case"end":return Ar.stop()}},Ie,this)}))},_e.getQuickComments=function(Oe){return Hr(this,void 0,void 0,wr.mark(function Ie(){var At,nr,kt;return wr.wrap(function(gr){for(;;)switch(gr.prev=gr.next){case 0:return gr.next=2,this.core.sendCmd("qchatGetQuickComments",{tag:{serverId:Oe.serverId,channelId:Oe.channelId,msgIdServerList:Eo(Ao(At=Oe.msgList).call(At,function(Ar){return Ar.msgIdServer}))}});case 2:return nr=gr.sent,kt=nr.content.quickCommentResponse,gr.abrupt("return",IM(kt));case 5:case"end":return gr.stop()}},Ie,this)}))},_e.updateQuickComment=function(Oe,Ie){return Hr(this,void 0,void 0,wr.mark(function At(){var nr,kt,ur,gr,Ar,Rr;return wr.wrap(function(Dr){for(;;)switch(Dr.prev=Dr.next){case 0:return On({type:{type:"number"},commentMessage:{type:"object",rules:{msgIdServer:{type:"string",allowEmpty:!1}}}},Oe),nr=Oe.commentMessage,kt=nr.serverId,ur=nr.channelId,gr=nr.fromAccount,Ar=nr.msgIdServer,Rr=nr.time,Dr.next=4,this.core.sendCmd("qchatUpdateQuickComment",{tag:{serverId:kt,channelId:ur,fromAccount:gr,msgIdServer:Ar,time:Rr,type:Oe.type,opeType:Ie,opeAccid:this.core.account}});case 4:case"end":return Dr.stop()}},At,this)}))},_e.sendTypingEvent=function(Oe){return Hr(this,void 0,void 0,wr.mark(function Ie(){return wr.wrap(function(nr){for(;;)switch(nr.prev=nr.next){case 0:if(Oe.channelId!==this.lastChannelIdInTyping){nr.next=4;break}return this.logger.log("qchatMsg sendTypingEvent throttle"),this._sendTypingEvent(Oe),nr.abrupt("return");case 4:this.lastChannelIdInTyping=Oe.channelId,this._sendTypingEvent.flush(),this._sendTypingEvent(Oe);case 7:case"end":return nr.stop()}},Ie,this)}))},pe}(),mb=function(pe){function _e(Oe){var Ie;return(Ie=pe.call(this,"qchatMsg",Oe)||this).core=Oe,Ie.lastChannelIdInMark="",Zi({cmdMap:ov,cmdConfig:xM}),Ie.notificationModuleService=new NM(Oe),Ie.messageModuleService=new OM(Oe),Ie.extendModuleService=new RM(Oe),Ie}Ko(_e,pe);var Ve=_e.prototype;return Ve.sendMessage=function(Ie){return Hr(this,void 0,void 0,wr.mark(function At(){return wr.wrap(function(kt){for(;;)switch(kt.prev=kt.next){case 0:return On({serverId:{type:"string",allowEmpty:!1},channelId:{type:"string",allowEmpty:!1},type:{type:"enum",values:xa(lp)},ext:{type:"string",required:!1},mentionAll:{type:"boolean",required:!1},mentionAccids:{type:"array",itemType:"string",required:!1},mentionRoleIds:{type:"array",itemType:"string",required:!1,min:1},historyEnable:{type:"boolean",required:!1},pushEnable:{type:"boolean",required:!1}},Ie),kt.next=3,this.messageModuleService.sendMessage(Ie);case 3:return kt.abrupt("return",kt.sent);case 4:case"end":return kt.stop()}},At,this)}))},Ve.updateMessage=function(Ie){return Hr(this,void 0,void 0,wr.mark(function At(){return wr.wrap(function(kt){for(;;)switch(kt.prev=kt.next){case 0:if(On({message:{type:"object",rules:{serverId:{type:"string",allowEmpty:!1},channelId:{type:"string",allowEmpty:!1},msgIdServer:{type:"string",allowEmpty:!1},time:{type:"number",min:0},body:{type:"string",required:!1},ext:{type:"string",required:!1}}}},Ie),!(typeof Ie.message.status=="number"&&Ie.message.status<1e4)){kt.next=3;break}throw new No("Status should be greater than or equal to 10000");case 3:return kt.next=5,this.messageModuleService.doUpdateMessage(Ie);case 5:return kt.abrupt("return",kt.sent);case 6:case"end":return kt.stop()}},At,this)}))},Ve.resendMessage=function(Ie){return Hr(this,void 0,void 0,wr.mark(function At(){return wr.wrap(function(kt){for(;;)switch(kt.prev=kt.next){case 0:return On({serverId:{type:"string",allowEmpty:!1},channelId:{type:"string",allowEmpty:!1},msgIdClient:{type:"string",allowEmpty:!1}},Ie),kt.next=3,this.messageModuleService.resendMessage(Ie);case 3:return kt.abrupt("return",kt.sent);case 4:case"end":return kt.stop()}},At,this)}))},Ve.deleteMessage=function(Ie){return Hr(this,void 0,void 0,wr.mark(function At(){var nr;return wr.wrap(function(ur){for(;;)switch(ur.prev=ur.next){case 0:return On({message:{type:"object",rules:{serverId:{type:"string",allowEmpty:!1},channelId:{type:"string",allowEmpty:!1},msgIdServer:{type:"string",allowEmpty:!1},time:{type:"number",min:0}}}},Ie),(nr=JSON.parse(Eo(Ie))).message.status=2,ur.next=5,this.messageModuleService.doUpdateMessage(nr);case 5:return ur.abrupt("return",ur.sent);case 6:case"end":return ur.stop()}},At,this)}))},Ve.revokeMessage=function(Ie){return Hr(this,void 0,void 0,wr.mark(function At(){var nr;return wr.wrap(function(ur){for(;;)switch(ur.prev=ur.next){case 0:return On({message:{type:"object",rules:{serverId:{type:"string",allowEmpty:!1},channelId:{type:"string",allowEmpty:!1},msgIdServer:{type:"string",allowEmpty:!1},time:{type:"number",min:0}}}},Ie),(nr=JSON.parse(Eo(Ie))).message=wf(nr.message,["serverId","channelId","msgIdServer","time"]),nr.message.status=1,ur.next=6,this.messageModuleService.doUpdateMessage(nr);case 6:return ur.abrupt("return",ur.sent);case 7:case"end":return ur.stop()}},At,this)}))},Ve.markMessageRead=function(Ie){return Hr(this,void 0,void 0,wr.mark(function At(){return wr.wrap(function(kt){for(;;)switch(kt.prev=kt.next){case 0:On({serverId:{type:"string"},channelId:{type:"string"},time:{type:"number",min:0}},Ie),Ie.channelId!==this.lastChannelIdInMark&&this.messageModuleService.markMessageRead.flush(),this.lastChannelIdInMark=Ie.channelId,this.messageModuleService.markMessageRead(Ie);case 4:case"end":return kt.stop()}},At,this)}))},Ve.replyMessage=function(Ie){On({replyMessage:{type:"object",rules:{msgIdServer:{type:"string",allowEmpty:!1}}}},Ie);var At=Ie.replyMessage;if(Ie.serverId!==At.serverId||Ie.channelId!==At.channelId)throw new No("Forbid replying to message from other server, channel");return this.sendMessage(Ie)},Ve.getMessageHistoryByIds=function(Ie){return Hr(this,void 0,void 0,wr.mark(function At(){return wr.wrap(function(kt){for(;;)switch(kt.prev=kt.next){case 0:return On({serverId:{type:"string",allowEmpty:!1},channelId:{type:"string",allowEmpty:!1},messageReferList:{type:"array",rules:{msgIdServer:{type:"string",allowEmpty:!1},time:{type:"number"}}}},Ie),kt.next=3,this.extendModuleService.getMessageHistoryByIds(Ie);case 3:return kt.abrupt("return",kt.sent);case 4:case"end":return kt.stop()}},At,this)}))},Ve.getReferMessages=function(Ie){return Hr(this,void 0,void 0,wr.mark(function At(){return wr.wrap(function(kt){for(;;)switch(kt.prev=kt.next){case 0:return On({message:{type:"object",rules:{msgIdServer:{type:"string",allowEmpty:!1},time:{type:"number"}}},referType:{type:"enum",values:xa(Nc),required:!1}},Ie),kt.next=3,this.extendModuleService.getReferMessages(Ie);case 3:return kt.abrupt("return",kt.sent);case 4:case"end":return kt.stop()}},At,this)}))},Ve.getThreadMessages=function(Ie){return Hr(this,void 0,void 0,wr.mark(function At(){return wr.wrap(function(kt){for(;;)switch(kt.prev=kt.next){case 0:return On({message:{type:"object",rules:{msgIdServer:{type:"string",allowEmpty:!1},time:{type:"number"}}},messageQueryOption:{type:"object",rules:{beginTime:{type:"number",required:!1},endTime:{type:"number",required:!1},excludeMsgId:{type:"string",required:!1},limit:{type:"number",required:!1},reverse:{type:"boolean",required:!1}}}},Ie),kt.next=3,this.extendModuleService.getThreadMessages(Ie);case 3:return kt.abrupt("return",kt.sent);case 4:case"end":return kt.stop()}},At,this)}))},Ve.getThreadRootMessagesMeta=function(Ie){return Hr(this,void 0,void 0,wr.mark(function At(){return wr.wrap(function(kt){for(;;)switch(kt.prev=kt.next){case 0:return On({serverId:{type:"string",allowEmpty:!1},channelId:{type:"string",allowEmpty:!1},threadRootMessages:{type:"array",rules:{msgIdServer:{type:"string",allowEmpty:!1},time:{type:"number"}}}},Ie),kt.next=3,this.extendModuleService.getThreadRootMessagesMeta(Ie);case 3:return kt.abrupt("return",kt.sent);case 4:case"end":return kt.stop()}},At,this)}))},Ve.sendSystemNotification=function(Ie){return Hr(this,void 0,void 0,wr.mark(function At(){return wr.wrap(function(kt){for(;;)switch(kt.prev=kt.next){case 0:return On({serverId:{type:"string",allowEmpty:!1},channelId:{type:"string",allowEmpty:!1,required:!1},attach:{type:"object",required:!1}},Ie),kt.next=3,this.notificationModuleService.sendSystemNotification(Ie);case 3:return kt.abrupt("return",kt.sent);case 4:case"end":return kt.stop()}},At,this)}))},Ve.updateSystemNotification=function(Ie){return Hr(this,void 0,void 0,wr.mark(function At(){return wr.wrap(function(kt){for(;;)switch(kt.prev=kt.next){case 0:return On({systemNotification:{type:"object",rules:{msgIdServer:{type:"string",allowEmpty:!1},type:{type:"enum",values:xa(ga)},body:{type:"string",required:!1},ext:{type:"string",required:!1},status:{type:"number",required:!1}}}},Ie),kt.next=3,this.notificationModuleService.updateSystemNotification(Ie);case 3:return kt.abrupt("return",kt.sent);case 4:case"end":return kt.stop()}},At,this)}))},Ve.markSystemNotificationsRead=function(Ie){return Hr(this,void 0,void 0,wr.mark(function At(){return wr.wrap(function(kt){for(;;)switch(kt.prev=kt.next){case 0:return On({systemNotifications:{type:"array",rules:{msgIdServer:{type:"string",allowEmpty:!1},type:{type:"string",allowEmpty:!1}},min:1}},Ie),kt.next=3,this.notificationModuleService.markSystemNotificationsRead(Ie);case 3:case"end":return kt.stop()}},At,this)}))},Ve.getHistoryMessage=function(Ie){return Hr(this,void 0,void 0,wr.mark(function At(){return wr.wrap(function(kt){for(;;)switch(kt.prev=kt.next){case 0:return On({serverId:{type:"string",allowEmpty:!1},channelId:{type:"string",allowEmpty:!1},beginTime:{type:"number",min:0,required:!1},endTime:{type:"number",min:0,required:!1},excludeMsgId:{type:"string",allowEmpty:!1,required:!1},limit:{type:"number",min:1,required:!1},reverse:{type:"boolean",required:!1}},Ie),kt.next=3,this.messageModuleService.getHistoryMessage(Ie);case 3:return kt.abrupt("return",kt.sent);case 4:case"end":return kt.stop()}},At,this)}))},Ve.getMentionedMeMessages=function(Ie){return Hr(this,void 0,void 0,wr.mark(function At(){return wr.wrap(function(kt){for(;;)switch(kt.prev=kt.next){case 0:return On({serverId:{type:"string",allowEmpty:!1},channelId:{type:"string",allowEmpty:!1},timestamp:{type:"number",min:0,required:!1},limit:{type:"number",min:1,required:!1}},Ie),kt.next=3,this.messageModuleService.getMentionedMeMessages(Ie);case 3:return kt.abrupt("return",kt.sent);case 4:case"end":return kt.stop()}},At,this)}))},Ve.areMentionedMeMessages=function(Ie){return Hr(this,void 0,void 0,wr.mark(function At(){var nr;return wr.wrap(function(ur){for(;;)switch(ur.prev=ur.next){case 0:if(On({messages:{type:"array",rules:{serverId:{type:"string",allowEmpty:!1},channelId:{type:"string",allowEmpty:!1},msgIdServer:{type:"string",allowEmpty:!1}},min:1}},Ie),tu(nr=Ie.messages).call(nr,function(gr){return Ie.messages[0].serverId===gr.serverId})){ur.next=4;break}throw new No("Different serverId",Ie,10414);case 4:if(!this.core.qchatChannel.subscribeForVisitorService.isInAutoServers(Ie.messages[0].serverId)){ur.next=7;break}throw new No("Not allowed for visitor",Ie,10403);case 7:return ur.next=9,this.messageModuleService.areMentionedMeMessages(Ie.messages);case 9:return ur.abrupt("return",ur.sent);case 10:case"end":return ur.stop()}},At,this)}))},Ve.addQuickComment=function(Ie){return Hr(this,void 0,void 0,wr.mark(function At(){return wr.wrap(function(kt){for(;;)switch(kt.prev=kt.next){case 0:return kt.next=2,this.extendModuleService.updateQuickComment(Ie,1);case 2:case"end":return kt.stop()}},At,this)}))},Ve.removeQuickComment=function(Ie){return Hr(this,void 0,void 0,wr.mark(function At(){return wr.wrap(function(kt){for(;;)switch(kt.prev=kt.next){case 0:return kt.next=2,this.extendModuleService.updateQuickComment(Ie,2);case 2:case"end":return kt.stop()}},At,this)}))},Ve.getQuickComments=function(Ie){return Hr(this,void 0,void 0,wr.mark(function At(){return wr.wrap(function(kt){for(;;)switch(kt.prev=kt.next){case 0:return On({serverId:{type:"string",allowEmpty:!1},channelId:{type:"string",allowEmpty:!1},msgList:{type:"array",rules:{msgIdServer:{type:"string",allowEmpty:!1}},min:1}},Ie),kt.next=3,this.extendModuleService.getQuickComments(Ie);case 3:return kt.abrupt("return",kt.sent);case 4:case"end":return kt.stop()}},At,this)}))},Ve.sendTypingEvent=function(Ie){return Hr(this,void 0,void 0,wr.mark(function At(){return wr.wrap(function(kt){for(;;)switch(kt.prev=kt.next){case 0:return On({serverId:{type:"string",allowEmpty:!1},channelId:{type:"string",allowEmpty:!1},ext:{type:"string",required:!1}},Ie),kt.next=3,this.extendModuleService.sendTypingEvent(Ie);case 3:return kt.abrupt("return",kt.sent);case 4:case"end":return kt.stop()}},At,this)}))},Ve.getLastMessageOfChannels=function(Ie){return Hr(this,void 0,void 0,wr.mark(function At(){return wr.wrap(function(kt){for(;;)switch(kt.prev=kt.next){case 0:return On({serverId:{type:"string",allowEmpty:!1},channelIdList:{type:"array",itemType:"string"}},Ie),kt.next=3,this.messageModuleService.getLastMessageOfChannels(Ie);case 3:return kt.abrupt("return",kt.sent);case 4:case"end":return kt.stop()}},At,this)}))},Ve.qchatOnMsgHandler=function(Ie){return Hr(this,void 0,void 0,wr.mark(function At(){return wr.wrap(function(kt){for(;;)switch(kt.prev=kt.next){case 0:this.messageModuleService.onMsg(Ie);case 1:case"end":return kt.stop()}},At,this)}))},Ve.qchatOnRecvUnreadInfoHandler=function(Ie){return Hr(this,void 0,void 0,wr.mark(function At(){return wr.wrap(function(kt){for(;;)switch(kt.prev=kt.next){case 0:this.messageModuleService.onRecvUnreadInfo(Ie);case 1:case"end":return kt.stop()}},At,this)}))},Ve.qchatOnSysMsgHandler=function(Ie){this.notificationModuleService.onSysMsg(Ie)},Ve.qchatMultiSyncMessageReadHandler=function(Ie){this.messageModuleService.onMultiSyncRead(Ie)},Ve.qchatMultiSyncSystemNotificationUpdateHandler=function(Ie){this.notificationModuleService.onMultiSysMsg(Ie)},Ve.qchatSyncSystemNotificationHandler=function(Ie){this.notificationModuleService.onSyncSysMsg(Ie)},Ve.qchatRecvMessageUpdateHandler=function(Ie){return Hr(this,void 0,void 0,wr.mark(function At(){return wr.wrap(function(kt){for(;;)switch(kt.prev=kt.next){case 0:this.messageModuleService.onRecvMsgUpdate(Ie);case 1:case"end":return kt.stop()}},At,this)}))},Ve.searchMsgByPage=function(Ie){return Hr(this,void 0,void 0,wr.mark(function At(){return wr.wrap(function(kt){for(;;)switch(kt.prev=kt.next){case 0:return On({keyword:{type:"string",allowEmpty:!1,required:!1},serverId:{type:"string",allowEmpty:!1,required:!0},channelId:{type:"string",allowEmpty:!1,required:!1},fromAccid:{type:"string",allowEmpty:!1,required:!1},fromTime:{type:"number",allowEmpty:!1,required:!1},toTime:{type:"number",allowEmpty:!1,required:!1},msgTypes:{type:"array",itemType:"string",allowEmpty:!1,required:!0},subTypes:{type:"array",itemType:"string",allowEmpty:!1,required:!1},includeSelf:{type:"boolean",allowEmpty:!1,required:!1},order:{type:"enum",values:xa(Yc),required:!1},limit:{type:"number",min:0,required:!1},sort:{type:"enum",values:xa(Mf),required:!1},cursor:{type:"string",allowEmpty:!1,required:!1}},Ie),kt.next=3,this.messageModuleService.messageSearchByPage(Ie);case 3:return kt.abrupt("return",kt.sent);case 4:case"end":return kt.stop()}},At,this)}))},Ve.qchatMultiSyncServersMessageReadHandler=function(Ie){this.messageModuleService.onMultiSyncServersRead(Ie)},_e}(Ll);function lv(pe,_e){_e===void 0&&(_e=1);var Ve=$a({clientPort:{type:"number"},clientType:{type:"enum",values:Rc},customClientType:{type:"number"},loginTime:{type:"number"},hasTokenPreviously:{type:"boolean"},pushType:{type:"number"}},pe);return jn(jn({},Ve),{account:Ve.account,connectionId:Ve.connectionId,deviceId:Ve.deviceId,ip:Ve.ip,mac:Ve.ip,os:Ve.os,clientType:Ve.clientType,time:Ve.time,online:_e!==2})}var gb={1:{reason:"samePlatformKick",message:"The same account is not allowed to multiple login at the same time"},2:{reason:"serverKick",message:"Kicked out by IM server"},3:{reason:"otherPlatformKick",message:"Kicked out by other client of your account"},4:{reason:"silentlyKick",message:"Quietly kicked"}},uv,Ws,La={BROWSER:0,RN:2,UNIAPP:3,WECHAT:6},BM=function(pe){function _e(Oe){var Ie;return(Ie=pe.call(this,"qchatAuth",Oe)||this).syncTimeTag=0,Ie}Ko(_e,pe);var Ve=_e.prototype;return Ve.doLogin=function(Ie){var At;return Ie===void 0&&(Ie=!1),Hr(this,void 0,void 0,wr.mark(function nr(){var kt,ur,gr,Ar,Rr,Ur,Dr;return wr.wrap(function(Cn){for(;;)switch(Cn.prev=Cn.next){case 0:return kt=this.core.options,ur=ya.getSystemInfo(),gr=jn(jn({},kt),{appLogin:Ie?0:1,clientType:16,clientSession:(At=this.core.socket)===null||At===void 0?void 0:At.sessionId,deviceId:this.core.config.deviceId,sdkVersion:91001,sdkType:La[ya.platform]||0,userAgent:"Native/0.13.1",sdkHumanVersion:"0.13.1",os:ur.os,browser:ur.browser}),Cn.next=5,this.core.sendCmd("qchatLogin",{qchatLoginReqTag:gr});case 5:if(!(Ar=Cn.sent).error){Cn.next=8;break}throw Ar.error;case 8:return Rr=Ar.content,Ur=Rr.qchatLoginResTag,Dr=Rr.qchatMultiLoginResult,Ur.isAutoReconnect=Ie,Cn.abrupt("return",{loginResult:lv(Ur),multiLoginResults:Ao(Dr).call(Dr,function(Sn){return lv(Sn)})});case 11:case"end":return Cn.stop()}},nr,this)}))},Ve.kick=function(Ie){var At;return Hr(this,void 0,void 0,wr.mark(function nr(){var kt;return wr.wrap(function(gr){for(;;)switch(gr.prev=gr.next){case 0:return gr.next=2,this.core.sendCmd("qchatKick",Ie);case 2:return kt=gr.sent,gr.abrupt("return",(At=kt.content)===null||At===void 0?void 0:At.deviceIds);case 4:case"end":return gr.stop()}},nr,this)}))},Ve.sync=function(){return Hr(this,void 0,void 0,wr.mark(function Ie(){return wr.wrap(function(nr){for(;;)switch(nr.prev=nr.next){case 0:return nr.next=2,this.core.sendCmd("qchatSync",{qchatSyncTag:{systemNotification:this.syncTimeTag||0}});case 2:case"end":return nr.stop()}},Ie,this)}))},Ve.qchatSyncHandler=function(Ie){var At,nr;this.logger.log("sync: emit syncdone",(At=Ie.content)===null||At===void 0?void 0:At.timetag),this.core.emit("syncdone"),this.syncTimeTag=((nr=Ie.content)===null||nr===void 0?void 0:nr.timetag)||0},Ve.qchatMultiSpotLoginHandler=function(Ie){if(Ie.error)this.logger.error("qchatMultiPortLoginHandler:: error, ",Ie.error);else{var At=Ie.content,nr=lv(At.qchatLoginResTag,At.state);this.core.emit("multiSpotLogin",[nr])}},Ve.qchatBeKickedHandler=function(Ie){if(Ie.error)this.logger.error("qchatBeKickedHandler error, ",Ie.error);else{var At=function(kt){var ur=$a({clientType:{type:"enum",values:Rc},customClientType:{type:"number"}},kt),gr=gb[ur.reason];return jn(ur,gr=gr||{reason:"unknow",message:"Unknown reason"})}(Ie.content.beKickedTag);this.logger.warn("bekicked::",At),this.core.doDisconnect(Ps.KICKED,At)}},_e}(Ll);(function(pe){pe.UNKNOWN="UNKNOWN",pe.LOGIN_STATE_ERROR="LOGIN_STATE_ERROR",pe.CLOSE_BY_BACKEND="CLOSE_BY_BACKEND",pe.ALL_MEMBERS_OUT="ALL_MEMBERS_OUT",pe.END_OF_LIFE="END_OF_LIFE",pe.CLOSE_BY_MEMBER="CLOSE_BY_MEMBER",pe.KICK_OUT="KICK_OUT",pe.SYNC_DATA_ERROR="SYNC_DATA_ERROR",pe.LEAVE_BY_SELF="LEAVE_BY_SELF",pe.kICK_BY_SELF="kICK_BY_SELF"})(uv||(uv={})),function(pe){pe.offNotAllowSelfOn="offNotAllowSelfOn",pe.offAllowSelfOn="offAllowSelfOn",pe.disable="disable"}(Ws||(Ws={}));var rl={serverId:{type:"string"},uid:{type:"string"},accid:{type:"string"},nick:{type:"string"},avatar:{type:"string"},ext:{type:"string"},type:{type:"number"},joinTime:{type:"number"},inviter:{type:"string"},validFlag:{type:"boolean"},createTime:{type:"number"},updateTime:{type:"number"}},Bc={limit:{type:"number"}};function Fc(pe){return ks(pe)&&pe.length>0?Ao(pe).call(pe,function(_e){return function(Oe){return $a(rl,Oe)}(_e)}):[]}function FM(pe){try{pe.audio&&(pe.audio=JSON.parse(pe.audio))}catch{throw new Il('result "audio" JSON parse error',{key:"audio"},"JSON parse error")}try{pe.video&&(pe.video=JSON.parse(pe.video))}catch{throw new Il('result "video" JSON parse error',{key:"video"},"JSON parse error")}return $a(Bc,pe)}var fp={"25_1":"qchatGetNeroomToken","25_2":"qchatUpdateRTCChannelConfig","25_3":"qchatGetRTCChannelConfig","25_4":"qchatGetRTCChannelMembers"},mp={QChatRTCChannelConfigTag:{serverId:1,channelId:2,limit:3,audio:4,video:5},QChatRTCChannelConfigResultTag:{limit:1,audio:2,video:3},QChatGetRTCParams:{serverId:1,channelId:2},qchatGetRTCChannelMembersTag:{serverId:1,channelId:2},memberInfo:{serverId:1,accid:3,nick:4,avatar:5,ext:6,type:7,joinTime:8,inviter:9,validFlag:10,createTime:11,updateTime:12},QChatGetNeroomTokenResultTag:{token:1,expire:2},QChatGetNeroomTokenParams:{neroomDeviceId:1}},If=zc(mp),gp={qchatGetNeroomToken:{sid:25,cid:1,service:"qchatMedia",params:[{type:"Property",name:"qchatGetNeroomTokenTag",reflectMapper:mp.QChatGetNeroomTokenParams}],response:[{type:"Property",name:"neroomToken",reflectMapper:If.QChatGetNeroomTokenResultTag}]},qchatUpdateRTCChannelConfig:{sid:25,cid:2,service:"qchatMedia",params:[{type:"Property",name:"RTCChannelConfig",reflectMapper:mp.QChatRTCChannelConfigTag}]},qchatGetRTCChannelConfig:{sid:25,cid:3,service:"qchatMedia",params:[{type:"Property",name:"qchatGetRTCChannelConfigTag",reflectMapper:mp.QChatGetRTCParams}],response:[{type:"Property",name:"RTCChannelConfig",reflectMapper:If.QChatRTCChannelConfigResultTag}]},qchatGetRTCChannelMembers:{sid:25,cid:4,service:"qchatMedia",params:[{type:"Property",name:"qchatGetRTCChannelMembersTag",reflectMapper:mp.QChatGetRTCParams}],response:[{type:"PropertyArray",name:"memberList",reflectMapper:If.memberInfo}]}},$M=function(pe){function _e(Oe){var Ie;return(Ie=pe.call(this,"qchatMedia",Oe)||this).tokenExpireTime=24e4,Ie.getTokenState=!1,Ie.core=Oe,Zi({cmdMap:fp,cmdConfig:gp}),Ie.core.on("disconnect",function(){return Hr(k(Ie),void 0,void 0,wr.mark(function At(){return wr.wrap(function(kt){for(;;)switch(kt.prev=kt.next){case 0:if(!this.roomContext){kt.next=3;break}return kt.next=3,this.disconnectChannel();case 3:this.tokenTimer&&(this.core.timerManager.deleteTimer(this.tokenTimer),this.tokenTimer=void 0);case 4:case"end":return kt.stop()}},At,this)}))}),Ie.core.on("kicked",function(){return Hr(k(Ie),void 0,void 0,wr.mark(function At(){return wr.wrap(function(kt){for(;;)switch(kt.prev=kt.next){case 0:if(!this.roomContext){kt.next=3;break}return kt.next=3,this.disconnectChannel();case 3:this.tokenTimer&&(this.core.timerManager.deleteTimer(this.tokenTimer),this.tokenTimer=void 0);case 4:case"end":return kt.stop()}},At,this)}))}),Ie.core.eventBus.on("qchatMedia/serverOrChannelLeave",function(At){return Hr(k(Ie),void 0,void 0,wr.mark(function nr(){return wr.wrap(function(ur){for(;;)switch(ur.prev=ur.next){case 0:if(!(At.type===ga[ga.channelVisibilityUpdate]&&At.channelId===this.channelId||At.type===ga[ga.serverEnterLeave]&&At.serverId===this.serverId)){ur.next=4;break}if(!this.roomContext||!this.roomContext.roomUuid){ur.next=4;break}return ur.next=4,this.disconnectChannel();case 4:case"end":return ur.stop()}},nr,this)}))}),Ie.tokenExpireTime=24e4,Ie.channelId="",Ie.serverId="",Ie}Ko(_e,pe);var Ve=_e.prototype;return Ve.setNeroom=function(Ie){this.neroom=new Ie},Ve._checkPermission=function(Ie){return Hr(this,void 0,void 0,wr.mark(function At(){var nr;return wr.wrap(function(ur){for(;;)switch(ur.prev=ur.next){case 0:return ur.next=2,this.core.qchatRole.checkPermission(Ie);case 2:return nr=ur.sent,ur.abrupt("return",nr);case 4:case"end":return ur.stop()}},At,this)}))},Ve._checkConnectState=function(){if(this.state!=="connect")throw new No("QChatMedia::you should connect first")},Ve.kickMemberOut=function(Ie){var At;return Hr(this,void 0,void 0,wr.mark(function nr(){return wr.wrap(function(ur){for(;;)switch(ur.prev=ur.next){case 0:return this._checkConnectState(),On({accid:{type:"string",allowEmpty:!1}},Ie),ur.prev=2,ur.next=5,(At=this.roomContext)===null||At===void 0?void 0:At.kickMemberOut(Ie.accid);case 5:ur.next=11;break;case 7:throw ur.prev=7,ur.t0=ur.catch(2),this.logger.error("QChatMedia::kickMemberOut error params is "+Eo(Ie),ur.t0),new No("QChatMedia::kickMemberOut error",ur.t0);case 11:case"end":return ur.stop()}},nr,this,[[2,7]])}))},Ve.disconnectChannel=function(){var Ie;return Hr(this,void 0,void 0,wr.mark(function At(){return wr.wrap(function(kt){for(;;)switch(kt.prev=kt.next){case 0:return this._checkConnectState(),this.logger.debug("QChatMedia::disconnect begin disconnect"),kt.prev=2,kt.next=5,(Ie=this.roomContext)===null||Ie===void 0?void 0:Ie.leaveRoom();case 5:kt.next=10;break;case 7:kt.prev=7,kt.t0=kt.catch(2),this.logger.error("QChatMedia::disconnect error",kt.t0);case 10:if(!this.authService){kt.next=13;break}return kt.next=13,this.authService.logout();case 13:this._setStateInit(),this.core.emit("qchatMediaDisconnect");case 15:case"end":return kt.stop()}},At,this,[[2,7]])}))},Ve._setStateInit=function(){this.logger.debug("QChatMedia::disconnect end"),this.roomContext=void 0,this.rtcController=void 0,this.state="init",this.tokenTimer&&(this.core.timerManager.deleteTimer(this.tokenTimer),this.tokenTimer=void 0),this.channelId="",this.serverId=""},Ve.muteAudio=function(Ie){var At,nr,kt,ur,gr;return Hr(this,void 0,void 0,wr.mark(function Ar(){var Rr;return wr.wrap(function(Dr){for(;;)switch(Dr.prev=Dr.next){case 0:if(this._checkConnectState(),On({accid:{type:"string",allowEmpty:!1}},Ie),((At=this.roomContext)===null||At===void 0?void 0:At.localMember.uuid)!==Ie.accid){Dr.next=14;break}return Dr.prev=3,Dr.next=6,(nr=this.rtcController)===null||nr===void 0?void 0:nr.muteMyAudio();case 6:Dr.next=12;break;case 8:throw Dr.prev=8,Dr.t0=Dr.catch(3),this.logger.error("QChatMedia::muteAudio error",Dr.t0),new No("QChatMedia::muteAudio error",Dr.t0);case 12:case 25:Dr.next=31;break;case 14:if(Dr.prev=14,!(Rr=(kt=this.roomContext)===null||kt===void 0?void 0:kt.roomProperties.audioOff)||((ur=Rr.value)===null||ur===void 0?void 0:ur.split("_")[0])!==Ws.offNotAllowSelfOn){Dr.next=23;break}return Dr.next=19,this._checkPermission({serverId:this.serverId,channelId:this.channelId,auth:"RTCChannelOpenCloseEveryoneMicrophone"});case 19:if(Dr.sent){Dr.next=23;break}return this.logger.error("QChatMedia::unMuteAudio not allow open auido"),Dr.abrupt("return");case 23:return Dr.next=25,(gr=this.rtcController)===null||gr===void 0?void 0:gr.muteMemberAudio(Ie.accid);case 27:throw Dr.prev=27,Dr.t1=Dr.catch(14),this.logger.error("QChatMedia::muteAudio error params is "+Eo(Ie),Dr.t1),new No("QChatMedia::muteAudio error",Dr.t1);case 31:case"end":return Dr.stop()}},Ar,this,[[3,8],[14,27]])}))},Ve.unMuteAudio=function(Ie){var At,nr,kt,ur,gr;return Hr(this,void 0,void 0,wr.mark(function Ar(){var Rr;return wr.wrap(function(Dr){for(;;)switch(Dr.prev=Dr.next){case 0:if(this._checkConnectState(),On({accid:{type:"string",allowEmpty:!1}},Ie),!(Rr=(At=this.roomContext)===null||At===void 0?void 0:At.roomProperties.audioOff)||((nr=Rr.value)===null||nr===void 0?void 0:nr.split("_")[0])!==Ws.offNotAllowSelfOn){Dr.next=10;break}return Dr.next=6,this._checkPermission({serverId:this.serverId,channelId:this.channelId,auth:"RTCChannelOpenCloseEveryoneMicrophone"});case 6:if(Dr.sent){Dr.next=10;break}return this.logger.error("QChatMedia::unMuteAudio not allow open auido"),Dr.abrupt("return");case 10:if(((kt=this.roomContext)===null||kt===void 0?void 0:kt.localMember.uuid)!==Ie.accid){Dr.next=22;break}return Dr.prev=11,Dr.next=14,(ur=this.rtcController)===null||ur===void 0?void 0:ur.unmuteMyAudio();case 14:Dr.next=20;break;case 16:throw Dr.prev=16,Dr.t0=Dr.catch(11),this.logger.error("QChatMedia::unMuteAudio error",Dr.t0),new No("QChatMedia::unMuteAudio error",Dr.t0);case 20:case 25:Dr.next=31;break;case 22:return Dr.prev=22,Dr.next=25,(gr=this.rtcController)===null||gr===void 0?void 0:gr.unmuteMemberAudio(Ie.accid);case 27:throw Dr.prev=27,Dr.t1=Dr.catch(22),this.logger.error("QChatMedia::unMuteAudio error params is "+Eo(Ie),Dr.t1),new No("QChatMedia::unMuteAudio error",Dr.t1);case 31:case"end":return Dr.stop()}},Ar,this,[[11,16],[22,27]])}))},Ve.muteVideo=function(Ie){var At,nr,kt,ur,gr;return Hr(this,void 0,void 0,wr.mark(function Ar(){var Rr;return wr.wrap(function(Dr){for(;;)switch(Dr.prev=Dr.next){case 0:if(this._checkConnectState(),On({accid:{type:"string",allowEmpty:!1}},Ie),((At=this.roomContext)===null||At===void 0?void 0:At.localMember.uuid)!==Ie.accid){Dr.next=14;break}return Dr.prev=3,Dr.next=6,(nr=this.rtcController)===null||nr===void 0?void 0:nr.muteMyVideo();case 6:Dr.next=12;break;case 8:throw Dr.prev=8,Dr.t0=Dr.catch(3),this.logger.error("QChatMedia::muteVideo error",Dr.t0),new No("QChatMedia::muteVideo error",Dr.t0);case 12:case 25:Dr.next=31;break;case 14:if(Dr.prev=14,!(Rr=(kt=this.roomContext)===null||kt===void 0?void 0:kt.roomProperties.videoOff)||((ur=Rr.value)===null||ur===void 0?void 0:ur.split("_")[0])!==Ws.offNotAllowSelfOn){Dr.next=23;break}return Dr.next=19,this._checkPermission({serverId:this.serverId,channelId:this.channelId,auth:"RTCChannelOpenCloseEveryoneCamera"});case 19:if(Dr.sent){Dr.next=23;break}return this.logger.error("QChatMedia::unMuteVideo not allow open video"),Dr.abrupt("return");case 23:return Dr.next=25,(gr=this.rtcController)===null||gr===void 0?void 0:gr.muteMemberVideo(Ie.accid);case 27:throw Dr.prev=27,Dr.t1=Dr.catch(14),this.logger.error("QChatMedia::muteVideo error params is "+Eo(Ie),Dr.t1),new No("QChatMedia::muteVideo error",Dr.t1);case 31:case"end":return Dr.stop()}},Ar,this,[[3,8],[14,27]])}))},Ve.unMuteVideo=function(Ie){var At,nr,kt,ur,gr;return Hr(this,void 0,void 0,wr.mark(function Ar(){var Rr;return wr.wrap(function(Dr){for(;;)switch(Dr.prev=Dr.next){case 0:if(this._checkConnectState(),On({accid:{type:"string",allowEmpty:!1}},Ie),!(Rr=(At=this.roomContext)===null||At===void 0?void 0:At.roomProperties.videoOff)||((nr=Rr.value)===null||nr===void 0?void 0:nr.split("_")[0])!==Ws.offNotAllowSelfOn){Dr.next=10;break}return Dr.next=6,this._checkPermission({serverId:this.serverId,channelId:this.channelId,auth:"RTCChannelOpenCloseEveryoneCamera"});case 6:if(Dr.sent){Dr.next=10;break}return this.logger.error("QChatMedia::unMuteVideo not allow open video"),Dr.abrupt("return");case 10:if(((kt=this.roomContext)===null||kt===void 0?void 0:kt.localMember.uuid)!==Ie.accid){Dr.next=22;break}return Dr.prev=11,Dr.next=14,(ur=this.rtcController)===null||ur===void 0?void 0:ur.unmuteMyVideo();case 14:Dr.next=20;break;case 16:throw Dr.prev=16,Dr.t0=Dr.catch(11),this.logger.error("QChatMedia::unMuteVideo error",Dr.t0),new No("QChatMedia::unMuteVideo error",Dr.t0);case 20:Dr.next=30;break;case 22:Dr.prev=22,(gr=this.rtcController)===null||gr===void 0||gr.unmuteMemberVideo(Ie.accid),Dr.next=30;break;case 26:throw Dr.prev=26,Dr.t1=Dr.catch(22),this.logger.error("QChatMedia::unMuteVideo error",Dr.t1),new No("QChatMedia::unMuteVideo error",Dr.t1);case 30:case"end":return Dr.stop()}},Ar,this,[[11,16],[22,26]])}))},Ve.startScreenShare=function(){var Ie;return Hr(this,void 0,void 0,wr.mark(function At(){return wr.wrap(function(kt){for(;;)switch(kt.prev=kt.next){case 0:this._checkConnectState(),kt.prev=1,(Ie=this.rtcController)===null||Ie===void 0||Ie.startScreenShare(),kt.next=9;break;case 5:throw kt.prev=5,kt.t0=kt.catch(1),this.logger.error("QChatMedia::startScreenShare error",kt.t0),new No("QChatMedia::startScreenShare error",kt.t0);case 9:case"end":return kt.stop()}},At,this,[[1,5]])}))},Ve.stopScreenShare=function(){var Ie;return Hr(this,void 0,void 0,wr.mark(function At(){return wr.wrap(function(kt){for(;;)switch(kt.prev=kt.next){case 0:this._checkConnectState(),kt.prev=1,(Ie=this.rtcController)===null||Ie===void 0||Ie.stopScreenShare(),kt.next=9;break;case 5:throw kt.prev=5,kt.t0=kt.catch(1),this.logger.error("QChatMedia::stopScreenShare error",kt.t0),new No("QChatMedia::stopScreenShare error",kt.t0);case 9:case"end":return kt.stop()}},At,this,[[1,5]])}))},Ve.stopMemberScreenShare=function(Ie){var At;return Hr(this,void 0,void 0,wr.mark(function nr(){return wr.wrap(function(ur){for(;;)switch(ur.prev=ur.next){case 0:this._checkConnectState(),On({accid:{type:"string",allowEmpty:!1}},Ie),ur.prev=2,(At=this.rtcController)===null||At===void 0||At.stopMemberScreenShare(Ie.accid),ur.next=10;break;case 6:throw ur.prev=6,ur.t0=ur.catch(2),this.logger.error("QChatMedia::stopMemberScreenShare error",ur.t0),new No("QChatMedia::stopMemberScreenShare error",ur.t0);case 10:case"end":return ur.stop()}},nr,this,[[2,6]])}))},Ve.subscribeRemoteVideoStream=function(Ie){var At;return Hr(this,void 0,void 0,wr.mark(function nr(){return wr.wrap(function(ur){for(;;)switch(ur.prev=ur.next){case 0:this._checkConnectState(),On({accid:{type:"string",allowEmpty:!1},streamType:{type:"number",allowEmpty:!1,min:0,max:1}},Ie),ur.prev=2,(At=this.rtcController)===null||At===void 0||At.subscribeRemoteVideoStream(Ie.accid,Ie.streamType),ur.next=10;break;case 6:throw ur.prev=6,ur.t0=ur.catch(2),this.logger.error("QChatMedia::subscribeRemoteVideoStream error",ur.t0),new No("QChatMedia::subscribeRemoteVideoStream error",ur.t0);case 10:case"end":return ur.stop()}},nr,this,[[2,6]])}))},Ve.unSubscribeRemoteVideoStream=function(Ie){var At;return Hr(this,void 0,void 0,wr.mark(function nr(){return wr.wrap(function(ur){for(;;)switch(ur.prev=ur.next){case 0:this._checkConnectState(),On({accid:{type:"string",allowEmpty:!1},streamType:{type:"number",allowEmpty:!1,min:0,max:1}},Ie),ur.prev=2,(At=this.rtcController)===null||At===void 0||At.unsubscribeRemoteVideoStream(Ie.accid,Ie.streamType),ur.next=10;break;case 6:throw ur.prev=6,ur.t0=ur.catch(2),this.logger.error("QChatMedia::unSubscribeRemoteVideoStream error",ur.t0),new No("QChatMedia::unSubscribeRemoteVideoStream error",ur.t0);case 10:case"end":return ur.stop()}},nr,this,[[2,6]])}))},Ve.setupVideoCanvas=function(Ie){var At;if(this._checkConnectState(),((At=this.roomContext)===null||At===void 0?void 0:At.localMember.uuid)===Ie.accid)try{return this.rtcController.setupLocalVideoCanvas(Ie.videoView)}catch(nr){throw this.logger.error("QChatMedia::setupVideoCanvas error",nr),new No("QChatMedia::setupVideoCanvas error",nr)}else try{return this.rtcController.setupRemoteVideoCanvas(Ie.videoView,Ie.accid)}catch(nr){throw this.logger.error("QChatMedia::setupVideoCanvas error",nr),new No("QChatMedia::setupVideoCanvas error",nr)}},Ve.setupRemoteVideoSubStreamCanvas=function(Ie){this._checkConnectState(),On({accid:{type:"string",allowEmpty:!1}},Ie);try{return this.rtcController.setupRemoteVideoSubStreamCanvas(Ie.videoView,Ie.accid)}catch(At){throw this.logger.error("QChatMedia::setupRemoteVideoSubStreamCanvas error",At),new No("QChatMedia::setupRemoteVideoSubStreamCanvas error",At)}},Ve.getScreenSharingUserUuid=function(){this._checkConnectState();try{return this.rtcController.getScreenSharingUserUuid()}catch(Ie){throw this.logger.error("QChatMedia::getScreenSharingUserUuid error",Ie),new No("QChatMedia::getScreenSharingUserUuid error",Ie)}},Ve.initQChatMedia=function(Ie){return Hr(this,void 0,void 0,wr.mark(function At(){return wr.wrap(function(kt){for(;;)switch(kt.prev=kt.next){case 0:if(this.neroom){kt.next=3;break}return this.logger.warn("QChatMedia::init::you should import neroom SDK"),kt.abrupt("return");case 3:if(this.state===void 0){kt.next=6;break}return this.logger.error("QChatMedia::init::you already init QChatMedia"),kt.abrupt("return");case 6:kt.prev=6,this.neroom.initialize({appKey:this.core.options.appkey,serverConfig:Ie.serverConfig}),kt.next=14;break;case 10:throw kt.prev=10,kt.t0=kt.catch(6),this.logger.error("QChatMedia::initQChatMedia error",kt.t0),new No("QChatMedia::initQChatMedia error",kt.t0);case 14:this.authService=this.neroom.authService,this.roomService=this.neroom.roomService,this.messageChannelService=this.neroom.messageChannelService,this.state="init";case 18:case"end":return kt.stop()}},At,this,[[6,10]])}))},Ve.loginByIM=function(){var Ie;return Hr(this,void 0,void 0,wr.mark(function At(){var nr,kt;return wr.wrap(function(gr){for(;;)switch(gr.prev=gr.next){case 0:if(this.state==="init"){gr.next=3;break}return this.logger.error("QChatMedia::connect::you should init before login"),gr.abrupt("return");case 3:return nr=this.core.options,gr.next=6,this._getToken();case 6:return kt=gr.sent,gr.prev=7,gr.next=10,(Ie=this.authService)===null||Ie===void 0?void 0:Ie.loginByIM(nr.account,kt,nr.token);case 10:gr.next=16;break;case 12:throw gr.prev=12,gr.t0=gr.catch(7),this.logger.error("QChatMedia::loginByIM error",gr.t0),new No("QChatMedia::loginByIM error",gr.t0);case 16:this.state="login";case 17:case"end":return gr.stop()}},At,this,[[7,12]])}))},Ve._getToken=function(){var Ie;return Hr(this,void 0,void 0,wr.mark(function At(){var nr,kt,ur,gr,Ar=this;return wr.wrap(function(Ur){for(;;)switch(Ur.prev=Ur.next){case 0:return this.logger.log("QChatMedia::getToken begin getToken"),Ur.next=3,this.core.sendCmd("qchatGetNeroomToken",{qchatGetNeroomTokenTag:{neroomDeviceId:(Ie=this.neroom)===null||Ie===void 0?void 0:Ie.deviceId}});case 3:return nr=Ur.sent,kt=nr.content.neroomToken,ur=kt.token,gr=kt.expire,this.logger.log("QChatMedia::getToken success token is "+ur+",expire is "+gr+" "),this.tokenTimer||(this.logger.debug("QChatMedia::getToken set token timer,expire is "+(1e3*gr-this.tokenExpireTime)+" "),this.tokenTimer=this.core.timerManager.addTimer(function(){return Hr(Ar,void 0,void 0,wr.mark(function Dr(){var Jr;return wr.wrap(function(Sn){for(;;)switch(Sn.prev=Sn.next){case 0:return this.tokenTimer&&this.core.timerManager.deleteTimer(this.tokenTimer),this.tokenTimer=void 0,Sn.next=4,this._getToken();case 4:Jr=Sn.sent,this.authService&&this.authService.renewToken(Jr);case 6:case"end":return Sn.stop()}},Dr,this)}))},1e3*gr-this.tokenExpireTime)),Ur.abrupt("return",ur);case 8:case"end":return Ur.stop()}},At,this)}))},Ve.connectChannel=function(Ie){var At,nr;return Hr(this,void 0,void 0,wr.mark(function kt(){var ur;return wr.wrap(function(Ar){for(;;)switch(Ar.prev=Ar.next){case 0:if(this.state!==void 0){Ar.next=3;break}return this.logger.error("QChatMedia::connect::you should init before login"),Ar.abrupt("return");case 3:if(this.state!=="init"){Ar.next=6;break}return Ar.next=6,this.loginByIM();case 6:return this.serverId=Ie.serverId,this.channelId=Ie.channelId,Ar.prev=8,Ar.next=11,(At=this.roomService)===null||At===void 0?void 0:At.joinRoom({roomUuid:Ie.channelId,role:"qchatAudience",userName:this.core.options.account,initialProperties:{}},{});case 11:Ar.next=17;break;case 13:throw Ar.prev=13,Ar.t0=Ar.catch(8),this.logger.error("QChatMedia::connectChannel error",Ar.t0),new No("QChatMedia::connectChannel error",Ar.t0);case 17:if(!(ur=(nr=this.roomService)===null||nr===void 0?void 0:nr.getRoomContext(Ie.channelId))){Ar.next=27;break}return this.roomContext=ur,this.rtcController=this.roomContext.rtcController,this.state="connect",Ar.next=24,this.rtcController.joinRtcChannel();case 24:this.core.emit("connectChannel"),Ar.next=28;break;case 27:this.logger.error("QChatMedia::connect room not exited");case 28:case"end":return Ar.stop()}},kt,this,[[8,13]])}))},Ve.updateRTCChannelInfo=function(Ie){return Hr(this,void 0,void 0,wr.mark(function At(){return wr.wrap(function(kt){for(;;)switch(kt.prev=kt.next){case 0:return On({serverId:{type:"string",allowEmpty:!1},channelId:{type:"string",allowEmpty:!1},limit:{type:"number",allowEmpty:!1}},Ie),kt.next=3,this.core.sendCmd("qchatUpdateRTCChannelConfig",{RTCChannelConfig:jn(jn({},Ie),{audio:Eo(Ie.audio),video:Eo(Ie.video)})});case 3:case"end":return kt.stop()}},At,this)}))},Ve.getRTCChannelInfo=function(Ie){return Hr(this,void 0,void 0,wr.mark(function At(){var nr;return wr.wrap(function(ur){for(;;)switch(ur.prev=ur.next){case 0:return On({serverId:{type:"string",allowEmpty:!1},channelId:{type:"string",allowEmpty:!1}},Ie),ur.next=3,this.core.sendCmd("qchatGetRTCChannelConfig",{qchatGetRTCChannelConfigTag:Ie});case 3:return nr=ur.sent,ur.abrupt("return",FM(nr.content.RTCChannelConfig));case 5:case"end":return ur.stop()}},At,this)}))},Ve.getRTCChannelOnlineMembers=function(Ie){return Hr(this,void 0,void 0,wr.mark(function At(){var nr;return wr.wrap(function(ur){for(;;)switch(ur.prev=ur.next){case 0:return On({serverId:{type:"string",allowEmpty:!1},channelId:{type:"string",allowEmpty:!1}},Ie),ur.next=3,this.core.sendCmd("qchatGetRTCChannelMembers",{qchatGetRTCChannelMembersTag:Ie});case 3:return nr=ur.sent,ur.abrupt("return",Fc(nr.content.memberList));case 5:case"end":return ur.stop()}},At,this)}))},Ve.addRTCChannelListener=function(){var Ie,At,nr=this;this._checkConnectState();try{(Ie=this.authService)===null||Ie===void 0||Ie.addAuthListener({onAuthEvent:function(ur){return Hr(nr,void 0,void 0,wr.mark(function gr(){var Ar;return wr.wrap(function(Ur){for(;;)switch(Ur.prev=Ur.next){case 0:if(ur!==1026||this.getTokenState){Ur.next=10;break}return this.logger.log("QChatMedia::loginByIM token expire,begin get new token "),this.getTokenState=!0,Ur.next=5,this._getToken();case 5:if(Ar=Ur.sent,!this.authService){Ur.next=9;break}return Ur.next=9,this.authService.renewToken(Ar);case 9:this.getTokenState=!1;case 10:case"end":return Ur.stop()}},gr,this)}))}})}catch(kt){throw this.getTokenState=!1,this.logger.error("QChatMedia::loginByIM addAuthListener error",kt),new No("QChatMedia::loginByIM addAuthListener error",kt)}(At=this.roomContext)===null||At===void 0||At.addRoomListener({onRoomPropertiesChanged:function(ur){var gr,Ar,Rr,Ur,Dr,Jr;if(nr.logger.log("QChatMedia::addRTCChannelListener::onRoomPropertiesChanged",ur),ur.audioOff){var Cn=(gr=ur.audioOff.value)===null||gr===void 0?void 0:gr.split("_")[0];Cn!==Ws.offNotAllowSelfOn&&Cn!==Ws.offAllowSelfOn||!((Ar=nr.roomContext)===null||Ar===void 0)&&Ar.localMember.isAudioOn&&((Rr=nr.rtcController)===null||Rr===void 0||Rr.muteMyAudio())}else if(ur.videoOff){var Sn=(Ur=ur.videoOff.value)===null||Ur===void 0?void 0:Ur.split("_")[0];Sn!==Ws.offNotAllowSelfOn&&Sn!==Ws.offAllowSelfOn||!((Dr=nr.roomContext)===null||Dr===void 0)&&Dr.localMember.isVideoOn&&((Jr=nr.rtcController)===null||Jr===void 0||Jr.muteMyVideo())}},onRoomPropertiesDeleted:function(ur){nr.logger.log("QChatMedia::addRTCChannelListener::onRoomPropertiesDeleted",ur)},onMemberJoinRtcChannel:function(ur){nr.logger.log("QChatMedia::addRTCChannelListener::onMemberJoinRTCChannel",ur);var gr=Ao(ur).call(ur,function(Ar){return Ar.uuid});nr.core.emit("memberJoinRTCChannel",gr)},onMemberLeaveRoom:function(ur){nr.logger.log("QChatMedia::addRTCChannelListener::onMemberLeaveRoom",ur);var gr=Ao(ur).call(ur,function(Ar){return Ar.uuid});nr.core.emit("memberLeaveRTCChannel",gr)},onRoomEnded:function(ur){nr.authService&&nr.authService.logout(),nr._setStateInit(),nr.logger.log("QChatMedia::addRTCChannelListener::onRoomEnded",ur),nr.core.emit("RTCChannelEnded",ur)},onRtcChannelError:function(ur){nr.logger.log("QChatMedia::addRTCChannelListener::onRtcChannelError",ur),ur==="SOCKET_ERROR"&&nr.disconnectChannel(),nr.core.emit("RTCChannelError",ur)},onRtcAudioVolumeIndication:function(ur){nr.logger.log("QChatMedia::addRTCChannelListener::onRtcAudioVolumeIndication",ur),nr.core.emit("onRtcAudioVolumeIndication",ur)},onMemberAudioMuteChanged:function(ur,gr,Ar){nr.logger.log("QChatMedia::addRTCChannelListener::onMemberAudioMuteChanged",ur,gr),nr.core.emit("memberAudioMuteChanged",{memberAccId:ur.uuid,mute:gr,operateByAccId:Ar.uuid})},onMemberScreenShareStateChanged:function(ur,gr,Ar){nr.logger.log("QChatMedia::addRTCChannelListener::onMemberScreenShareStateChanged",ur,gr),nr.core.emit("memberScreenShareStateChanged",{memberAccId:ur.uuid,isSharing:gr,operateByAccId:Ar.uuid})},onMemberVideoMuteChanged:function(ur,gr,Ar){nr.logger.log("QChatMedia::addRTCChannelListener::onMemberVideoMuteChanged",ur,gr),nr.core.emit("memberVideoMuteChanged",{memberAccId:ur.uuid,mute:gr,operateByAccId:Ar.uuid})}})},Ve.enumCameraDevices=function(){var Ie=this;return this._checkConnectState(),this.rtcController.enumCameraDevices().then(function(At){return At.data},function(At){throw Ie.logger.error("QChatMedia::enumCameraDevices error",At),new No("QChatMedia::enumCameraDevices error",At)})},Ve.enumPlayoutDevices=function(){var Ie=this;return this._checkConnectState(),this.rtcController.enumPlayoutDevices().then(function(At){return At.data},function(At){throw Ie.logger.error("QChatMedia::enumPlayoutDevices error",At),new No("QChatMedia::enumPlayoutDevices error",At)})},Ve.enumRecordDevices=function(){var Ie=this;return this._checkConnectState(),this.rtcController.enumRecordDevices().then(function(At){return At.data},function(At){throw Ie.logger.error("QChatMedia::enumRecordDevices error",At),new No("QChatMedia::enumRecordDevices error",At)})},Ve.removeRTCChannelListener=function(){var Ie,At;this._checkConnectState(),(Ie=this.roomContext)===null||Ie===void 0||Ie.removeRoomListener({}),(At=this.authService)===null||At===void 0||At.removeAuthListener({})},Ve.setSelectedCameraDevice=function(Ie){var At=this;return this._checkConnectState(),On({deviceId:{type:"string",allowEmpty:!1}},Ie),this.rtcController.setSelectedCameraDevice(Ie.deviceId).then(function(nr){return nr.data},function(nr){throw At.logger.error("QChatMedia::setSelectedCameraDevice error",nr),new No("QChatMedia::setSelectedCameraDevice error",nr)})},Ve.setSelectedPlayoutDevice=function(Ie){var At=this;return this._checkConnectState(),On({deviceId:{type:"string",allowEmpty:!1}},Ie),this.rtcController.setSelectedPlayoutDevice(Ie.deviceId).then(function(nr){return nr.data},function(nr){throw At.logger.error("QChatMedia::setSelectedPlayoutDevice error",nr),new No("QChatMedia::setSelectedPlayoutDevice error",nr)})},Ve.setSelectedRecordDevice=function(Ie){var At=this;return this._checkConnectState(),On({deviceId:{type:"string",allowEmpty:!1}},Ie),this.rtcController.setSelectedRecordDevice(Ie.deviceId).then(function(nr){return nr.data},function(nr){throw At.logger.error("QChatMedia::setSelectedRecordDevice error",nr),new No("QChatMedia::setSelectedRecordDevice error",nr)})},Ve.getRTCMembers=function(){var Ie,At;return this._checkConnectState(),Ao(Ie=bi(At=this.roomContext.remoteMembers).call(At,function(nr){return nr.isInRtcChannel})).call(Ie,function(nr){return{accid:nr.uuid,isAudioOn:!!nr.isAudioOn,isVideoOn:!!nr.isVideoOn,isSharingScreen:!!nr.isSharingScreen,properties:nr.properties}})},Ve.subscribeRemoteVideoSubStream=function(Ie){var At;return Hr(this,void 0,void 0,wr.mark(function nr(){return wr.wrap(function(ur){for(;;)switch(ur.prev=ur.next){case 0:this._checkConnectState(),On({accid:{type:"string",allowEmpty:!1}},Ie),ur.prev=2,(At=this.rtcController)===null||At===void 0||At.subscribeRemoteVideoSubStream(Ie.accid),ur.next=10;break;case 6:throw ur.prev=6,ur.t0=ur.catch(2),this.logger.error("QChatMedia::subscribeRemoteVideoSubStream error",ur.t0),new No("QChatMedia::subscribeRemoteVideoSubStream error",ur.t0);case 10:case"end":return ur.stop()}},nr,this,[[2,6]])}))},Ve.unsubscribeRemoteVideoSubStream=function(Ie){var At;return Hr(this,void 0,void 0,wr.mark(function nr(){return wr.wrap(function(ur){for(;;)switch(ur.prev=ur.next){case 0:this._checkConnectState(),On({accid:{type:"string",allowEmpty:!1}},Ie),ur.prev=2,(At=this.rtcController)===null||At===void 0||At.unsubscribeRemoteVideoSubStream(Ie.accid),ur.next=10;break;case 6:throw ur.prev=6,ur.t0=ur.catch(2),this.logger.error("QChatMedia::unsubscribeRemoteVideoSubStream error",ur.t0),new No("QChatMedia::unsubscribeRemoteVideoSubStream error",ur.t0);case 10:case"end":return ur.stop()}},nr,this,[[2,6]])}))},Ve.muteAllAudio=function(){var Ie;return Hr(this,void 0,void 0,wr.mark(function At(){return wr.wrap(function(kt){for(;;)switch(kt.prev=kt.next){case 0:return this._checkConnectState(),kt.next=3,this._checkPermission({serverId:this.serverId,channelId:this.channelId,auth:"RTCChannelOpenCloseEveryoneMicrophone"});case 3:if(kt.sent){kt.next=7;break}return this.logger.error("QChatMedia::connect::auth your have not RTCChannelOpenCloseEveryoneMicrophone auth"),kt.abrupt("return");case 7:kt.prev=7,(Ie=this.roomContext)===null||Ie===void 0||Ie.updateRoomProperty("audioOff",Eo({value:Ws.offNotAllowSelfOn+"_"+new Date().getTime()})),kt.next=15;break;case 11:throw kt.prev=11,kt.t0=kt.catch(7),this.logger.error("QChatMedia::muteAllAudio error",kt.t0),new No("QChatMedia::muteAllAudio error",kt.t0);case 15:case"end":return kt.stop()}},At,this,[[7,11]])}))},Ve.muteAllVideo=function(){var Ie;return Hr(this,void 0,void 0,wr.mark(function At(){return wr.wrap(function(kt){for(;;)switch(kt.prev=kt.next){case 0:return this._checkConnectState(),kt.next=3,this._checkPermission({serverId:this.serverId,channelId:this.channelId,auth:"RTCChannelOpenCloseEveryoneCamera"});case 3:if(kt.sent){kt.next=7;break}return this.logger.error("QChatMedia::connect::auth your have not RTCChannelOpenCloseEveryoneCamera auth"),kt.abrupt("return");case 7:kt.prev=7,(Ie=this.roomContext)===null||Ie===void 0||Ie.updateRoomProperty("videoOff",Eo({value:Ws.offNotAllowSelfOn+"_"+new Date().getTime()})),kt.next=15;break;case 11:throw kt.prev=11,kt.t0=kt.catch(7),this.logger.error("QChatMedia::muteAllVideo error",kt.t0),new No("QChatMedia::muteAllVideo error",kt.t0);case 15:case"end":return kt.stop()}},At,this,[[7,11]])}))},Ve.unMuteAllAudio=function(){var Ie;return Hr(this,void 0,void 0,wr.mark(function At(){return wr.wrap(function(kt){for(;;)switch(kt.prev=kt.next){case 0:return this._checkConnectState(),kt.next=3,this._checkPermission({serverId:this.serverId,channelId:this.channelId,auth:"RTCChannelOpenCloseEveryoneMicrophone"});case 3:if(kt.sent){kt.next=7;break}return this.logger.error("QChatMedia::connect::auth your have not RTCChannelOpenCloseEveryoneMicrophone auth"),kt.abrupt("return");case 7:kt.prev=7,(Ie=this.roomContext)===null||Ie===void 0||Ie.updateRoomProperty("audioOff",Eo({value:Ws.disable+"_"+new Date().getTime()})),kt.next=15;break;case 11:throw kt.prev=11,kt.t0=kt.catch(7),this.logger.error("QChatMedia::unMuteAllAudio error",kt.t0),new No("QChatMedia::unMuteAllAudio error",kt.t0);case 15:case"end":return kt.stop()}},At,this,[[7,11]])}))},Ve.unMuteAllVideo=function(){var Ie;return Hr(this,void 0,void 0,wr.mark(function At(){return wr.wrap(function(kt){for(;;)switch(kt.prev=kt.next){case 0:return this._checkConnectState(),kt.next=3,this._checkPermission({serverId:this.serverId,channelId:this.channelId,auth:"RTCChannelOpenCloseEveryoneCamera"});case 3:if(kt.sent){kt.next=7;break}return this.logger.error("QChatMedia::connect::auth your have not RTCChannelOpenCloseEveryoneCamera auth"),kt.abrupt("return");case 7:kt.prev=7,(Ie=this.roomContext)===null||Ie===void 0||Ie.updateRoomProperty("videoOff",Eo({value:Ws.disable+"_"+new Date().getTime()})),kt.next=15;break;case 11:throw kt.prev=11,kt.t0=kt.catch(7),this.logger.error("QChatMedia::unMuteAllVideo error",kt.t0),new No("QChatMedia::unMuteAllVideo error",kt.t0);case 15:case"end":return kt.stop()}},At,this,[[7,11]])}))},_e}(Ll),LM={"1_2":"heartbeat","24_2":"qchatLogin","24_4":"qchatExit","24_5":"qchatBeKicked","24_8":"qchatMultiSpotLogin","24_9":"qchatKick","24_19":"qchatSync"},hp={qchatLoginTag:{appkey:1,account:2,authType:3,token:4,loginExt:5,clientType:6,clientSession:7,deviceId:8,sdkVersion:9,sdkType:10,userAgent:11,customTag:12,customClientType:13,sdkHumanVersion:14,pushTokenName:20,pushToken:21,pushkitTokenName:22,pushkitToken:23,deviceInfo:24,customPushContentType:25,os:30,mac:31,bundleId:32,simCarrierCode:33,simCountryCode:34,networkCode:35,browser:36,deviceModel:37,androidid:38,imei:39,idfv:40,openuuid:41,pushType:100,hasTokenPreviously:101,consid:102,clientIP:103,clientPort:104,loginTime:105}},Hl=zc(hp),jM={heartbeat:{sid:1,cid:2,service:"qchatAuth"},qchatLogin:{sid:24,cid:2,service:"qchatAuth",params:[{type:"Property",name:"qchatLoginReqTag",reflectMapper:hp.qchatLoginTag}],response:[{type:"Property",name:"qchatLoginResTag",reflectMapper:Hl.qchatLoginTag},{type:"PropertyArray",name:"qchatMultiLoginResult",reflectMapper:Hl.qchatLoginTag}]},qchatExit:{sid:24,cid:4,service:"qchatAuth"},qchatBeKicked:{sid:24,cid:5,service:"qchatAuth",response:[{type:"Property",name:"beKickedTag",reflectMapper:{1:"clientType",2:"reason",3:"ext",4:"customClientType"}}]},qchatMultiSpotLogin:{sid:24,cid:8,service:"qchatAuth",response:[{type:"Number",name:"state"},{type:"Property",name:"qchatLoginResTag",reflectMapper:Hl.qchatLoginTag}]},qchatKick:{sid:24,cid:9,service:"qchatAuth",params:[{type:"StrArray",name:"deviceIds"}],response:[{type:"StrArray",name:"deviceIds"}]},qchatSync:{sid:24,cid:19,service:"qchatAuth",isNoResponse:!0,params:[{type:"Property",name:"qchatSyncTag",reflectMapper:{systemNotification:1,pushConfig:2}}],response:[{type:"Number",name:"timetag"}]}},DM={debugLevel:"off",needReconnect:!0,reconnectionAttempts:Cg,isAbtestEnable:!0,abtestUrl:"https://abt-online.netease.im/v1/api/abt/client/getExperimentInfo",abtestProjectKey:"imElite_sdk_abtest_web"},vp=function(pe){function _e(Oe,Ie){var At;return Ie===void 0&&(Ie={cloudStorageConfig:{}}),(At=pe.call(this,Oe)||this).instanceName="QChat",At.account="",At.options={},At.qchatAuth={},At.qchatServer={},At.qchatChannel={},At.qchatMsg={},At.qchatRole={},At.qchatMedia={},At.cloudStorage={},At.setOptions(Oe),Zi({cmdMap:LM,cmdConfig:jM}),Zi({cmdMap:jy,cmdConfig:Uh}),At.qchatAuth=new BM(k(At)),At.qchatServer=new tM(k(At)),At.qchatChannel=new SM(k(At)),At.qchatMsg=new mb(k(At)),At.qchatRole=new kM(k(At)),At.qchatMedia=new $M(k(At)),At.cloudStorage=new Dy(k(At),jn({storageKeyPrefix:At.instanceName},Ie.cloudStorageConfig)),Ie&&At.setOtherOptions(Ie),_e.instance=k(At),At}Ko(_e,pe),_e.getInstance=function(Ie,At){if(!_e.instance){if(Ie)return new _e(Ie,At);throw new Error("Instance not exist, please input options")}if(Ie){if(_e.instance.options.account===Ie.account&&_e.instance.options.appkey===Ie.appkey)return _e.instance.setOptions(Ie),At&&_e.instance.setOtherOptions(At),_e.instance;throw new Error("Unexpected login")}return _e.instance};var Ve=_e.prototype;return Ve.connect=function(Ie){Ie===void 0&&(Ie={});var At=vs(null,{connect:{get:function(){return pe.prototype.connect}}});return Hr(this,void 0,void 0,wr.mark(function nr(){var kt,ur,gr;return wr.wrap(function(Rr){for(;;)switch(Rr.prev=Rr.next){case 0:if(/^(unconnected|waitReconnect)$/.test(this.status)){Rr.next=4;break}return kt="QChat status is "+this.status+", and would not connect",this.logger.warn(kt),Rr.abrupt("return",wo.reject(kt));case 4:return ur=Ie.isAutoReconnect||!1,Rr.next=7,At.connect.call(this,{linkUrls:this.options.linkAddresses,isAutoReconnect:ur});case 7:return Rr.prev=7,Rr.next=10,this.qchatAuth.doLogin(ur);case 10:gr=Rr.sent,Rr.next=21;break;case 13:if(Rr.prev=13,Rr.t0=Rr.catch(7),this.logger.warn("qchat connect:: login failed",Rr.t0),this.retryCount!==0){Rr.next=19;break}throw this.doDisconnect(Ps.ACTIVE,"FailedToInitializeLogin"),Rr.t0;case 19:return this.doDisconnect(Ps.OFFLINE,"ReconnectLoginFailed"),Rr.abrupt("return");case 21:return this.status="logined",gr.loginResult.appkey=this.options.appkey,this.eventBus.emit("logined",gr.loginResult),this.emit("logined",gr.loginResult),gr.multiLoginResults&&gr.multiLoginResults.length>0&&this.emit("multiSpotLogin",gr.multiLoginResults),this.resetConnectStatus(),this.ping(),Rr.prev=28,Rr.next=31,this.cloudStorage.init();case 31:Rr.next=36;break;case 33:Rr.prev=33,Rr.t1=Rr.catch(28),this.logger.error("NIM:login cloudStorage init failed ",Rr.t1);case 36:return Rr.next=38,this.qchatAuth.sync();case 38:case"end":return Rr.stop()}},nr,this,[[7,13],[28,33]])}))},Ve.login=function(Ie){return Ie===void 0&&(Ie={}),this.connect(Ie)},Ve.setOptions=function(Ie){On({account:{type:"string"},appkey:{type:"string"},token:{type:"string"},linkAddresses:{type:"array",itemType:"string",min:1},needReconnect:{type:"boolean",required:!1},reconnectionAttempts:{type:"number",required:!1},debugLevel:{type:"enum",values:Ep,required:!1}},Ie),this.logger.log("QChat::setOptions options is",Ie),this.account=Ie.account,this.options=jn(jn({},DM),Ie)},Ve.setOtherOptions=function(Ie){var At;!((At=Ie==null?void 0:Ie.QChatMedia)===null||At===void 0)&&At.neroom&&this.qchatMedia.setNeroom(Ie.QChatMedia.neroom)},Ve.onMessage=function(Ie){var At,nr,kt=pe.prototype.onMessage.call(this,Ie);if(kt){var ur=kt.raw.ser,gr=this.sendingCmdMap.get(ur);if(gr&&gr.cmd===kt.cmd){var Ar=gr.callback,Rr=gr.timer,Ur=gr.params;if(clearTimeout(Rr),kt.params=Ur,this.sendingCmdMap.delete(ur),kt.cmd==="heartbeat")return void Ar[0]();var Dr=(At=this[kt.service])===null||At===void 0?void 0:At.process(kt);Dr&&typeof Dr.then=="function"?Dr.then(function(Jr){Ar[0](Jr)}).catch(function(Jr){Ar[1](Jr)}):(this.logger.log("imsocket:: handlerFn without promise",kt.service,kt.cmd),Ar[0]())}else(nr=this[kt.service])===null||nr===void 0||nr.process(kt)}},Ve.disconnect=function(){var Ie=this;switch(this.status){case"logined":return this.sendCmd("qchatExit").then(function(){pe.prototype.doDisconnect.call(Ie,Ps.ACTIVE,"UserActiveDisconnect")});case"connected":case"connecting":case"waitReconnect":return pe.prototype.doDisconnect.call(this,Ps.ACTIVE,"UserActiveDisconnect"),wo.resolve();case"unconnected":case"destroyed":return wo.resolve()}},Ve.logout=function(){return this.disconnect()},Ve.destroy=function(){return _e.instance=null,pe.prototype.destroy.call(this)},Ve.kickOtherClients=function(Ie){return On({deviceIds:{type:"array",itemType:"string"}},Ie),this.qchatAuth.kick(Ie)},_e}(qd);vp.instance=null;var UM=Math.min,dv=[].lastIndexOf,Ef=!!dv&&1/[1].lastIndexOf(1,-0)<0,Pf=li("lastIndexOf"),hb=Ef||!Pf?function(_e){if(Ef)return le(dv,this,arguments)||0;var Ve=Pr(this),Oe=Ka(Ve),Ie=Oe-1;for(arguments.length>1&&(Ie=UM(Ie,sc(arguments[1]))),Ie<0&&(Ie=Oe+Ie);Ie>=0;Ie--)if(Ie in Ve&&Ve[Ie]===_e)return Ie||0;return-1}:dv;_n({target:"Array",proto:!0,forced:hb!==[].lastIndexOf},{lastIndexOf:hb});var qM=na("Array").lastIndexOf,pv=Array.prototype,vb=function(pe){var _e=pe.lastIndexOf;return pe===pv||vr(pv,pe)&&_e===pv.lastIndexOf?qM:_e},nl=g(function(pe,_e){(function(){var Ve={function:!0,object:!0}[typeof window]&&window||this,Oe=_e,Ie=pe&&!pe.nodeType&&pe,At=Oe&&Ie&&typeof e=="object"&&e;!At||At.global!==At&&At.window!==At&&At.self!==At||(Ve=At);var nr=Math.pow(2,53)-1,kt=/\bOpera/,ur=Object.prototype,gr=ur.hasOwnProperty,Ar=ur.toString;function Rr(Wn){return(Wn=String(Wn)).charAt(0).toUpperCase()+Wn.slice(1)}function Ur(Wn){return Wn=$n(Wn),/^(?:webOS|i(?:OS|P))/.test(Wn)?Wn:Rr(Wn)}function Dr(Wn,Fn){for(var mo in Wn)gr.call(Wn,mo)&&Fn(Wn[mo],mo,Wn)}function Jr(Wn){return Wn==null?Rr(Wn):Ar.call(Wn).slice(8,-1)}function Cn(Wn){return String(Wn).replace(/([ -])(?!$)/g,"$1?")}function Sn(Wn,Fn){var mo=null;return function(ea,oo){var Wr=-1,Gn=ea?ea.length:0;if(typeof Gn=="number"&&Gn>-1&&Gn<=nr)for(;++Wr<Gn;)oo(ea[Wr],Wr,ea);else Dr(ea,oo)}(Wn,function(ao,ea){mo=Fn(mo,ao,ea,Wn)}),mo}function $n(Wn){return String(Wn).replace(/^ +| +$/g,"")}var Rn=function Wn(Fn){var mo=Ve,ao=Fn&&typeof Fn=="object"&&Jr(Fn)!="String";ao&&(mo=Fn,Fn=null);var ea=mo.navigator||{},oo=ea.userAgent||"";Fn||(Fn=oo);var Wr,Gn,Zn=ao?!!ea.likeChrome:/\bChrome\b/.test(Fn)&&!/internal|\n/i.test(Ar.toString()),qn="Object",Bn=ao?qn:"ScriptBridgingProxyObject",Xn=ao?qn:"Environment",so=ao&&mo.java?"JavaPackage":Jr(mo.java),yo=ao?qn:"RuntimeObject",bo=/\bJava/.test(so)&&mo.java,ta=bo&&Jr(mo.environment)==Xn,Po=bo?"a":"α",ha=bo?"b":"β",Bo=mo.document||{},qo=mo.operamini||mo.opera,va=kt.test(va=ao&&qo?qo["[[Class]]"]:Jr(qo))?va:qo=null,Wi=Fn,Ho=[],Gi=null,as=Fn==oo,xo=as&&qo&&typeof qo.version=="function"&&qo.version(),ua=function(Ha){return Sn(Ha,function(da,Ra){return da||RegExp("\\b"+(Ra.pattern||Cn(Ra))+"\\b","i").exec(Fn)&&(Ra.label||Ra)})}([{label:"EdgeHTML",pattern:"Edge"},"Trident",{label:"WebKit",pattern:"AppleWebKit"},"iCab","Presto","NetFront","Tasman","KHTML","Gecko"]),po=function(Ha){return Sn(Ha,function(da,Ra){return da||RegExp("\\b"+(Ra.pattern||Cn(Ra))+"\\b","i").exec(Fn)&&(Ra.label||Ra)})}(["Adobe AIR","Arora","Avant Browser","Breach","Camino","Electron","Epiphany","Fennec","Flock","Galeon","GreenBrowser","iCab","Iceweasel","K-Meleon","Konqueror","Lunascape","Maxthon",{label:"Microsoft Edge",pattern:"(?:Edge|Edg|EdgA|EdgiOS)"},"Midori","Nook Browser","PaleMoon","PhantomJS","Raven","Rekonq","RockMelt",{label:"Samsung Internet",pattern:"SamsungBrowser"},"SeaMonkey",{label:"Silk",pattern:"(?:Cloud9|Silk-Accelerated)"},"Sleipnir","SlimBrowser",{label:"SRWare Iron",pattern:"Iron"},"Sunrise","Swiftfox","Vivaldi","Waterfox","WebPositive",{label:"Yandex Browser",pattern:"YaBrowser"},{label:"UC Browser",pattern:"UCBrowser"},"Opera Mini",{label:"Opera Mini",pattern:"OPiOS"},"Opera",{label:"Opera",pattern:"OPR"},"Chromium","Chrome",{label:"Chrome",pattern:"(?:HeadlessChrome)"},{label:"Chrome Mobile",pattern:"(?:CriOS|CrMo)"},{label:"Firefox",pattern:"(?:Firefox|Minefield)"},{label:"Firefox for iOS",pattern:"FxiOS"},{label:"IE",pattern:"IEMobile"},{label:"IE",pattern:"MSIE"},"Safari"]),Qo=bb([{label:"BlackBerry",pattern:"BB10"},"BlackBerry",{label:"Galaxy S",pattern:"GT-I9000"},{label:"Galaxy S2",pattern:"GT-I9100"},{label:"Galaxy S3",pattern:"GT-I9300"},{label:"Galaxy S4",pattern:"GT-I9500"},{label:"Galaxy S5",pattern:"SM-G900"},{label:"Galaxy S6",pattern:"SM-G920"},{label:"Galaxy S6 Edge",pattern:"SM-G925"},{label:"Galaxy S7",pattern:"SM-G930"},{label:"Galaxy S7 Edge",pattern:"SM-G935"},"Google TV","Lumia","iPad","iPod","iPhone","Kindle",{label:"Kindle Fire",pattern:"(?:Cloud9|Silk-Accelerated)"},"Nexus","Nook","PlayBook","PlayStation Vita","PlayStation","TouchPad","Transformer",{label:"Wii U",pattern:"WiiU"},"Wii","Xbox One",{label:"Xbox 360",pattern:"Xbox"},"Xoom"]),hs=function(Ha){return Sn(Ha,function(da,Ra,yp){return da||(Ra[Qo]||Ra[/^[a-z]+(?: +[a-z]+\b)*/i.exec(Qo)]||RegExp("\\b"+Cn(yp)+"(?:\\b|\\w*\\d)","i").exec(Fn))&&yp})}({Apple:{iPad:1,iPhone:1,iPod:1},Alcatel:{},Archos:{},Amazon:{Kindle:1,"Kindle Fire":1},Asus:{Transformer:1},"Barnes & Noble":{Nook:1},BlackBerry:{PlayBook:1},Google:{"Google TV":1,Nexus:1},HP:{TouchPad:1},HTC:{},Huawei:{},Lenovo:{},LG:{},Microsoft:{Xbox:1,"Xbox One":1},Motorola:{Xoom:1},Nintendo:{"Wii U":1,Wii:1},Nokia:{Lumia:1},Oppo:{},Samsung:{"Galaxy S":1,"Galaxy S2":1,"Galaxy S3":1,"Galaxy S4":1},Sony:{PlayStation:1,"PlayStation Vita":1},Xiaomi:{Mi:1,Redmi:1}}),go=function(Ha){return Sn(Ha,function(da,Ra){var yp=Ra.pattern||Cn(Ra);return!da&&(da=RegExp("\\b"+yp+"(?:/[\\d.]+|[ \\w.]*)","i").exec(Fn))&&(da=function(gi,bp,Af){var mv={"10.0":"10",6.4:"10 Technical Preview",6.3:"8.1",6.2:"8",6.1:"Server 2008 R2 / 7","6.0":"Server 2008 / Vista",5.2:"Server 2003 / XP 64-bit",5.1:"XP",5.01:"2000 SP1","5.0":"2000","4.0":"NT","4.90":"ME"};return bp&&Af&&/^Win/i.test(gi)&&!/^Windows Phone /i.test(gi)&&(mv=mv[/[\d.]+$/.exec(gi)])&&(gi="Windows "+mv),gi=String(gi),bp&&Af&&(gi=gi.replace(RegExp(bp,"i"),Af)),Ur(gi.replace(/ ce$/i," CE").replace(/\bhpw/i,"web").replace(/\bMacintosh\b/,"Mac OS").replace(/_PowerPC\b/i," OS").replace(/\b(OS X) [^ \d]+/i,"$1").replace(/\bMac (OS X)\b/,"$1").replace(/\/(\d)/," $1").replace(/_/g,".").replace(/(?: BePC|[ .]*fc[ \d.]+)$/i,"").replace(/\bx86\.64\b/gi,"x86_64").replace(/\b(Windows Phone) OS\b/,"$1").replace(/\b(Chrome OS \w+) [\d.]+\b/,"$1").split(" on ")[0])}(da,yp,Ra.label||Ra)),da})}(["Windows Phone","KaiOS","Android","CentOS",{label:"Chrome OS",pattern:"CrOS"},"Debian",{label:"DragonFly BSD",pattern:"DragonFly"},"Fedora","FreeBSD","Gentoo","Haiku","Kubuntu","Linux Mint","OpenBSD","Red Hat","SuSE","Ubuntu","Xubuntu","Cygwin","Symbian OS","hpwOS","webOS ","webOS","Tablet OS","Tizen","Linux","Mac OS X","Macintosh","Mac","Windows 98;","Windows "]);function bb(Ks){return Sn(Ks,function(Ha,da){var Ra=da.pattern||Cn(da);return!Ha&&(Ha=RegExp("\\b"+Ra+" *\\d+[.\\w_]*","i").exec(Fn)||RegExp("\\b"+Ra+" *\\w+-[\\w]*","i").exec(Fn)||RegExp("\\b"+Ra+"(?:; *(?:[a-z]+[_-])?[a-z]+\\d+|[^ ();-]*)","i").exec(Fn))&&((Ha=String(da.label&&!RegExp(Ra,"i").test(da.label)?da.label:Ha).split("/"))[1]&&!/[\d.]+/.test(Ha[0])&&(Ha[0]+=" "+Ha[1]),da=da.label||da,Ha=Ur(Ha[0].replace(RegExp(Ra,"i"),da).replace(RegExp("; *(?:"+da+"[_-])?","i")," ").replace(RegExp("("+da+")[-_.]?(\\w)","i"),"$1 $2"))),Ha})}function fv(Ks){return Sn(Ks,function(Ha,da){return Ha||(RegExp(da+"(?:-[\\d.]+/|(?: for [\\w-]+)?[ /-])([\\d.]+[^ ();/_-]*)","i").exec(Fn)||0)[1]||null})}if(ua&&(ua=[ua]),/\bAndroid\b/.test(go)&&!Qo&&(Wr=/\bAndroid[^;]*;(.*?)(?:Build|\) AppleWebKit)\b/i.exec(Fn))&&(Qo=$n(Wr[1]).replace(/^[a-z]{2}-[a-z]{2};\s*/i,"")||null),hs&&!Qo?Qo=bb([hs]):hs&&Qo&&(Qo=Qo.replace(RegExp("^("+Cn(hs)+")[-_.\\s]","i"),hs+" ").replace(RegExp("^("+Cn(hs)+")[-_.]?(\\w)","i"),hs+" $2")),(Wr=/\bGoogle TV\b/.exec(Qo))&&(Qo=Wr[0]),/\bSimulator\b/i.test(Fn)&&(Qo=(Qo?Qo+" ":"")+"Simulator"),po=="Opera Mini"&&/\bOPiOS\b/.test(Fn)&&Ho.push("running in Turbo/Uncompressed mode"),po=="IE"&&/\blike iPhone OS\b/.test(Fn)?(hs=(Wr=Wn(Fn.replace(/like iPhone OS/,""))).manufacturer,Qo=Wr.product):/^iP/.test(Qo)?(po||(po="Safari"),go="iOS"+((Wr=/ OS ([\d_]+)/i.exec(Fn))?" "+Wr[1].replace(/_/g,"."):"")):po=="Konqueror"&&/^Linux\b/i.test(go)?go="Kubuntu":hs&&hs!="Google"&&(/Chrome/.test(po)&&!/\bMobile Safari\b/i.test(Fn)||/\bVita\b/.test(Qo))||/\bAndroid\b/.test(go)&&/^Chrome/.test(po)&&/\bVersion\//i.test(Fn)?(po="Android Browser",go=/\bAndroid\b/.test(go)?go:"Android"):po=="Silk"?(/\bMobi/i.test(Fn)||(go="Android",Ho.unshift("desktop mode")),/Accelerated *= *true/i.test(Fn)&&Ho.unshift("accelerated")):po=="UC Browser"&&/\bUCWEB\b/.test(Fn)?Ho.push("speed mode"):po=="PaleMoon"&&(Wr=/\bFirefox\/([\d.]+)\b/.exec(Fn))?Ho.push("identifying as Firefox "+Wr[1]):po=="Firefox"&&(Wr=/\b(Mobile|Tablet|TV)\b/i.exec(Fn))?(go||(go="Firefox OS"),Qo||(Qo=Wr[1])):!po||(Wr=!/\bMinefield\b/i.test(Fn)&&/\b(?:Firefox|Safari)\b/.exec(po))?(po&&!Qo&&/[\/,]|^[^(]+?\)/.test(Fn.slice(Fn.indexOf(Wr+"/")+8))&&(po=null),(Wr=Qo||hs||go)&&(Qo||hs||/\b(?:Android|Symbian OS|Tablet OS|webOS)\b/.test(go))&&(po=/[a-z]+(?: Hat)?/i.exec(/\bAndroid\b/.test(go)?go:Wr)+" Browser")):po=="Electron"&&(Wr=(/\bChrome\/([\d.]+)\b/.exec(Fn)||0)[1])&&Ho.push("Chromium "+Wr),xo||(xo=fv(["(?:Cloud9|CriOS|CrMo|Edge|Edg|EdgA|EdgiOS|FxiOS|HeadlessChrome|IEMobile|Iron|Opera ?Mini|OPiOS|OPR|Raven|SamsungBrowser|Silk(?!/[\\d.]+$)|UCBrowser|YaBrowser)","Version",Cn(po),"(?:Firefox|Minefield|NetFront)"])),(Wr=(ua=="iCab"&&parseFloat(xo)>3?"WebKit":/\bOpera\b/.test(po)&&(/\bOPR\b/.test(Fn)?"Blink":"Presto"))||/\b(?:Midori|Nook|Safari)\b/i.test(Fn)&&!/^(?:Trident|EdgeHTML)$/.test(ua)&&"WebKit"||!ua&&/\bMSIE\b/i.test(Fn)&&(go=="Mac OS"?"Tasman":"Trident")||ua=="WebKit"&&/\bPlayStation\b(?! Vita\b)/i.test(po)&&"NetFront")&&(ua=[Wr]),po=="IE"&&(Wr=(/; *(?:XBLWP|ZuneWP)(\d+)/i.exec(Fn)||0)[1])?(po+=" Mobile",go="Windows Phone "+(/\+$/.test(Wr)?Wr:Wr+".x"),Ho.unshift("desktop mode")):/\bWPDesktop\b/i.test(Fn)?(po="IE Mobile",go="Windows Phone 8.x",Ho.unshift("desktop mode"),xo||(xo=(/\brv:([\d.]+)/.exec(Fn)||0)[1])):po!="IE"&&ua=="Trident"&&(Wr=/\brv:([\d.]+)/.exec(Fn))&&(po&&Ho.push("identifying as "+po+(xo?" "+xo:"")),po="IE",xo=Wr[1]),as){if(function(Ha,da){var Ra=Ha!=null?typeof Ha[da]:"number";return!(/^(?:boolean|number|string|undefined)$/.test(Ra)||Ra=="object"&&!Ha[da])}(mo,"global"))if(bo&&(Wi=(Wr=bo.lang.System).getProperty("os.arch"),go=go||Wr.getProperty("os.name")+" "+Wr.getProperty("os.version")),ta){try{xo=mo.require("ringo/engine").version.join("."),po="RingoJS"}catch{(Wr=mo.system)&&Wr.global.system==mo.system&&(po="Narwhal",go||(go=Wr[0].os||null))}po||(po="Rhino")}else typeof mo.process=="object"&&!mo.process.browser&&(Wr=mo.process)&&(typeof Wr.versions=="object"&&(typeof Wr.versions.electron=="string"?(Ho.push("Node "+Wr.versions.node),po="Electron",xo=Wr.versions.electron):typeof Wr.versions.nw=="string"&&(Ho.push("Chromium "+xo,"Node "+Wr.versions.node),po="NW.js",xo=Wr.versions.nw)),po||(po="Node.js",Wi=Wr.arch,go=Wr.platform,xo=(xo=/[\d.]+/.exec(Wr.version))?xo[0]:null));else Jr(Wr=mo.runtime)==Bn?(po="Adobe AIR",go=Wr.flash.system.Capabilities.os):Jr(Wr=mo.phantom)==yo?(po="PhantomJS",xo=(Wr=Wr.version||null)&&Wr.major+"."+Wr.minor+"."+Wr.patch):typeof Bo.documentMode=="number"&&(Wr=/\bTrident\/(\d+)/i.exec(Fn))?(xo=[xo,Bo.documentMode],(Wr=+Wr[1]+4)!=xo[1]&&(Ho.push("IE "+xo[1]+" mode"),ua&&(ua[1]=""),xo[1]=Wr),xo=po=="IE"?String(xo[1].toFixed(1)):xo[0]):typeof Bo.documentMode=="number"&&/^(?:Chrome|Firefox)\b/.test(po)&&(Ho.push("masking as "+po+" "+xo),po="IE",xo="11.0",ua=["Trident"],go="Windows");go=go&&Ur(go)}if(xo&&(Wr=/(?:[ab]|dp|pre|[ab]\d+pre)(?:\d+\+?)?$/i.exec(xo)||/(?:alpha|beta)(?: ?\d)?/i.exec(Fn+";"+(as&&ea.appMinorVersion))||/\bMinefield\b/i.test(Fn)&&"a")&&(Gi=/b/i.test(Wr)?"beta":"alpha",xo=xo.replace(RegExp(Wr+"\\+?$"),"")+(Gi=="beta"?ha:Po)+(/\d+\+?/.exec(Wr)||"")),po=="Fennec"||po=="Firefox"&&/\b(?:Android|Firefox OS|KaiOS)\b/.test(go))po="Firefox Mobile";else if(po=="Maxthon"&&xo)xo=xo.replace(/\.[\d.]+/,".x");else if(/\bXbox\b/i.test(Qo))Qo=="Xbox 360"&&(go=null),Qo=="Xbox 360"&&/\bIEMobile\b/.test(Fn)&&Ho.unshift("mobile mode");else if(!/^(?:Chrome|IE|Opera)$/.test(po)&&(!po||Qo||/Browser|Mobi/.test(po))||go!="Windows CE"&&!/Mobi/i.test(Fn))if(po=="IE"&&as)try{mo.external===null&&Ho.unshift("platform preview")}catch{Ho.unshift("embedded")}else(/\bBlackBerry\b/.test(Qo)||/\bBB10\b/.test(Fn))&&(Wr=(RegExp(Qo.replace(/ +/g," *")+"/([.\\d]+)","i").exec(Fn)||0)[1]||xo)?(go=((Wr=[Wr,/BB10/.test(Fn)])[1]?(Qo=null,hs="BlackBerry"):"Device Software")+" "+Wr[0],xo=null):this!=Dr&&Qo!="Wii"&&(as&&qo||/Opera/.test(po)&&/\b(?:MSIE|Firefox)\b/i.test(Fn)||po=="Firefox"&&/\bOS X (?:\d+\.){2,}/.test(go)||po=="IE"&&(go&&!/^Win/.test(go)&&xo>5.5||/\bWindows XP\b/.test(go)&&xo>8||xo==8&&!/\bTrident\b/.test(Fn)))&&!kt.test(Wr=Wn.call(Dr,Fn.replace(kt,"")+";"))&&Wr.name&&(Wr="ing as "+Wr.name+((Wr=Wr.version)?" "+Wr:""),kt.test(po)?(/\bIE\b/.test(Wr)&&go=="Mac OS"&&(go=null),Wr="identify"+Wr):(Wr="mask"+Wr,po=va?Ur(va.replace(/([a-z])([A-Z])/g,"$1 $2")):"Opera",/\bIE\b/.test(Wr)&&(go=null),as||(xo=null)),ua=["Presto"],Ho.push(Wr));else po+=" Mobile";(Wr=(/\bAppleWebKit\/([\d.]+\+?)/i.exec(Fn)||0)[1])&&(Wr=[parseFloat(Wr.replace(/\.(\d)$/,".0$1")),Wr],po=="Safari"&&Wr[1].slice(-1)=="+"?(po="WebKit Nightly",Gi="alpha",xo=Wr[1].slice(0,-1)):xo!=Wr[1]&&xo!=(Wr[2]=(/\bSafari\/([\d.]+\+?)/i.exec(Fn)||0)[1])||(xo=null),Wr[1]=(/\b(?:Headless)?Chrome\/([\d.]+)/i.exec(Fn)||0)[1],Wr[0]==537.36&&Wr[2]==537.36&&parseFloat(Wr[1])>=28&&ua=="WebKit"&&(ua=["Blink"]),as&&(Zn||Wr[1])?(ua&&(ua[1]="like Chrome"),Wr=Wr[1]||((Wr=Wr[0])<530?1:Wr<532?2:Wr<532.05?3:Wr<533?4:Wr<534.03?5:Wr<534.07?6:Wr<534.1?7:Wr<534.13?8:Wr<534.16?9:Wr<534.24?10:Wr<534.3?11:Wr<535.01?12:Wr<535.02?"13+":Wr<535.07?15:Wr<535.11?16:Wr<535.19?17:Wr<536.05?18:Wr<536.1?19:Wr<537.01?20:Wr<537.11?"21+":Wr<537.13?23:Wr<537.18?24:Wr<537.24?25:Wr<537.36?26:ua!="Blink"?"27":"28")):(ua&&(ua[1]="like Safari"),Wr=(Wr=Wr[0])<400?1:Wr<500?2:Wr<526?3:Wr<533?4:Wr<534?"4+":Wr<535?5:Wr<537?6:Wr<538?7:Wr<601?8:Wr<602?9:Wr<604?10:Wr<606?11:Wr<608?12:"12"),ua&&(ua[1]+=" "+(Wr+=typeof Wr=="number"?".x":/[.+]/.test(Wr)?"":"+")),po=="Safari"&&(!xo||parseInt(xo)>45)?xo=Wr:po=="Chrome"&&/\bHeadlessChrome/i.test(Fn)&&Ho.unshift("headless")),po=="Opera"&&(Wr=/\bzbov|zvav$/.exec(go))?(po+=" ",Ho.unshift("desktop mode"),Wr=="zvav"?(po+="Mini",xo=null):po+="Mobile",go=go.replace(RegExp(" *"+Wr+"$"),"")):po=="Safari"&&/\bChrome\b/.exec(ua&&ua[1])?(Ho.unshift("desktop mode"),po="Chrome Mobile",xo=null,/\bOS X\b/.test(go)?(hs="Apple",go="iOS 4.3+"):go=null):/\bSRWare Iron\b/.test(po)&&!xo&&(xo=fv("Chrome")),xo&&xo.indexOf(Wr=/[\d.]+$/.exec(go))==0&&Fn.indexOf("/"+Wr+"-")>-1&&(go=$n(go.replace(Wr,""))),go&&go.indexOf(po)!=-1&&!RegExp(po+" OS").test(go)&&(go=go.replace(RegExp(" *"+Cn(po)+" *"),"")),ua&&!/\b(?:Avant|Nook)\b/.test(po)&&(/Browser|Lunascape|Maxthon/.test(po)||po!="Safari"&&/^iOS/.test(go)&&/\bSafari\b/.test(ua[1])||/^(?:Adobe|Arora|Breach|Midori|Opera|Phantom|Rekonq|Rock|Samsung Internet|Sleipnir|SRWare Iron|Vivaldi|Web)/.test(po)&&ua[1])&&(Wr=ua[ua.length-1])&&Ho.push(Wr),Ho.length&&(Ho=["("+Ho.join("; ")+")"]),hs&&Qo&&Qo.indexOf(hs)<0&&Ho.push("on "+hs),Qo&&Ho.push((/^on /.test(Ho[Ho.length-1])?"":"on ")+Qo),go&&(Wr=/ ([\d.+]+)$/.exec(go),Gn=Wr&&go.charAt(go.length-Wr[0].length-1)=="/",go={architecture:32,family:Wr&&!Gn?go.replace(Wr[0],""):go,version:Wr?Wr[1]:null,toString:function(){var Ks=this.version;return this.family+(Ks&&!Gn?" "+Ks:"")+(this.architecture==64?" 64-bit":"")}}),(Wr=/\b(?:AMD|IA|Win|WOW|x86_|x)64\b/i.exec(Wi))&&!/\bi686\b/i.test(Wi)?(go&&(go.architecture=64,go.family=go.family.replace(RegExp(" *"+Wr),"")),po&&(/\bWOW64\b/i.test(Fn)||as&&/\w(?:86|32)$/.test(ea.cpuClass||ea.platform)&&!/\bWin64; x64\b/i.test(Fn))&&Ho.unshift("32-bit")):go&&/^OS X/.test(go.family)&&po=="Chrome"&&parseFloat(xo)>=39&&(go.architecture=64),Fn||(Fn=null);var Gs={};return Gs.description=Fn,Gs.layout=ua&&ua[0],Gs.manufacturer=hs,Gs.name=po,Gs.prerelease=Gi,Gs.product=Qo,Gs.ua=Fn,Gs.version=po&&xo,Gs.os=go||{architecture:null,family:null,version:null,toString:function(){return"null"}},Gs.parse=Wn,Gs.toString=function(){return this.description||""},Gs.version&&Ho.unshift(xo),Gs.name&&Ho.unshift(po),go&&po&&(go!=String(go).split(" ")[0]||go!=po.split(" ")[0]&&!Qo)&&Ho.push(Qo?"("+go+")":"on "+go),Ho.length&&(Gs.description=Ho.join(" ")),Gs}();Oe&&Ie?Dr(Rn,function(Wn,Fn){Oe[Fn]=Wn}):Ve.platform=Rn}).call(e)}),yb=g(function(pe,_e){pe.exports=function(){var Ve={d:function(Wr,Gn){for(var Zn in Gn)Ve.o(Gn,Zn)&&!Ve.o(Wr,Zn)&&gc(Wr,Zn,{enumerable:!0,get:Gn[Zn]})},o:function(Wr,Gn){return Object.prototype.hasOwnProperty.call(Wr,Gn)}},Oe={};Ve.d(Oe,{default:function(){return ea}});var Ie=function oo(Wr){for(var Gn in function(Zn,qn){if(!(Zn instanceof qn))throw new TypeError("Cannot call a class as a function")}(this,oo),this.directUploadAddr="https://wanproxy-web.127.net",this.retryCount=4,this.trunkSize=4194304,this.trunkUploadTimeout=5e4,this.getOffsetTimeout=1e4,this.version="1.0",this.enableCache=!0,this.logger=console,this.onError=function(Zn){},this.onProgress=function(Zn){},this.onUploadProgress=function(Zn){},this.onComplete=function(Zn){},Wr)this[Gn]=Wr[Gn]};function At(oo,Wr){var Gn=Ba!==void 0&&us(oo)||oo["@@iterator"];if(!Gn){if(ks(oo)||(Gn=function(yo,bo){if(yo){var ta;if(typeof yo=="string")return nr(yo,bo);var Po=Fo(ta=Object.prototype.toString.call(yo)).call(ta,8,-1);return Po==="Object"&&yo.constructor&&(Po=yo.constructor.name),Po==="Map"||Po==="Set"?Kc(yo):Po==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(Po)?nr(yo,bo):void 0}}(oo))||Wr&&oo&&typeof oo.length=="number"){Gn&&(oo=Gn);var Zn=0,qn=function(){};return{s:qn,n:function(){return Zn>=oo.length?{done:!0}:{done:!1,value:oo[Zn++]}},e:function(bo){throw bo},f:qn}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var Bn,Xn=!0,so=!1;return{s:function(){Gn=Gn.call(oo)},n:function(){var bo=Gn.next();return Xn=bo.done,bo},e:function(bo){so=!0,Bn=bo},f:function(){try{Xn||Gn.return==null||Gn.return()}finally{if(so)throw Bn}}}}function nr(oo,Wr){(Wr==null||Wr>oo.length)&&(Wr=oo.length);for(var Gn=0,Zn=new Array(Wr);Gn<Wr;Gn++)Zn[Gn]=oo[Gn];return Zn}var kt=window.localStorage;window.localStorage&&typeof window.localStorage.getItem=="function"&&typeof window.localStorage.setItem=="function"&&typeof window.localStorage.removeItem=="function"||(kt={privateObj:{},setItem:function(Wr,Gn){kt.privateObj[Wr]=Gn},getItem:function(Wr){return kt.privateObj[Wr]},removeItem:function(Wr){delete kt.privateObj[Wr]},getKeys:function(){return Sa(kt.privateObj)}});var ur={getFileKey:function(Wr){var Gn=Wr.size.toString(),Zn=Wr.lastModified.toString();return"_NosUploader_"+Wr.name+Fo(Gn).call(Gn,Gn.length-5)+Fo(Zn).call(Zn,Zn.length-5)},getFileInfo:function(Wr){var Gn=kt.getItem(Wr);if(!Gn)return null;try{return JSON.parse(Gn)}catch{return null}},initFile:function(Wr,Gn,Zn){ur.clearExpiredInfo();var qn=this.getFileKey(Gn),Bn={ctx:Wr.ctx!==void 0?Wr.ctx:"",bucket:Wr.bucketName,obj:Wr.objectName,token:Wr.token,modifyAt:Ms(),end:!1};return Wr.payload&&(Bn.payload=Wr.payload),Zn&&kt.setItem(qn,Eo(Bn)),qn},setUploadContext:function(Wr,Gn,Zn){var qn=this.getFileInfo(Wr);qn&&(qn.ctx=Gn,Zn&&kt.setItem(Wr,Eo(qn)))},setComplete:function(Wr,Gn){var Zn=this.getFileInfo(Wr);Zn&&(Zn.modifyAt=Ms(),Zn.end=!0,Gn&&kt.setItem(Wr,Eo(Zn)))},getUploadContext:function(Wr){var Gn=this.getFileInfo(Wr);return Gn?Gn.ctx:""},removeFileInfo:function(Wr){Na(Wr).call(Wr,"_NosUploader_")===0&&kt.removeItem(Wr)},clearExpiredInfo:function(){var Wr,Gn=typeof kt.getKeys=="function"?kt.getKeys():Sa(kt),Zn=Ms(),qn=[],Bn=At(Gn);try{for(Bn.s();!(Wr=Bn.n()).done;){var Xn=Wr.value;if(Na(Xn).call(Xn,"_NosUploader_")===0){var so=ur.getFileInfo(Xn);so===null||Zn-so.modifyAt>ea.expireTime?kt.removeItem(Xn):qn.push({fileInfo:so,key:Xn})}}}catch(Bo){Bn.e(Bo)}finally{Bn.f()}if(qn.length>ea.maxFileCache){var yo,bo,ta=At(Fo(yo=vu(qn).call(qn,function(Bo,qo){return qo.fileInfo.modifyAt-Bo.fileInfo.modifyAt})).call(yo,ea.maxFileCache));try{for(ta.s();!(bo=ta.n()).done;){var Po,ha=bo.value;Na(Po=ha.key).call(Po,"_NosUploader_")===0&&kt.removeItem(ha.key)}}catch(Bo){ta.e(Bo)}finally{ta.f()}}}},gr=ur;function Ar(oo){return(Ar=typeof Ba=="function"&&typeof Om=="symbol"?function(Wr){return typeof Wr}:function(Wr){return Wr&&typeof Ba=="function"&&Wr.constructor===Ba&&Wr!==Ba.prototype?"symbol":typeof Wr})(oo)}function Rr(oo,Wr){return!Wr||Ar(Wr)!=="object"&&typeof Wr!="function"?function(Gn){if(Gn===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return Gn}(oo):Wr}function Ur(oo){var Wr=typeof xl=="function"?new xl:void 0;return(Ur=function(Zn){var qn,Bn;if(Zn===null||(Bn=Zn,Na(qn=Function.toString.call(Bn)).call(qn,"[native code]")===-1))return Zn;if(typeof Zn!="function")throw new TypeError("Super expression must either be null or a function");if(Wr!==void 0){if(Wr.has(Zn))return Wr.get(Zn);Wr.set(Zn,Xn)}function Xn(){return Dr(Zn,arguments,Sn(this).constructor)}return Xn.prototype=vs(Zn.prototype,{constructor:{value:Xn,enumerable:!1,writable:!0,configurable:!0}}),Cn(Xn,Zn)})(oo)}function Dr(oo,Wr,Gn){return(Dr=Jr()?kc:function(Zn,qn,Bn){var Xn=[null];Xn.push.apply(Xn,qn);var so=new(Go(Function).apply(Zn,Xn));return Bn&&Cn(so,Bn.prototype),so}).apply(null,arguments)}function Jr(){if(typeof Reflect>"u"||!kc||kc.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(kc(Boolean,[],function(){})),!0}catch{return!1}}function Cn(oo,Wr){return(Cn=ri||function(Gn,Zn){return Gn.__proto__=Zn,Gn})(oo,Wr)}function Sn(oo){return(Sn=ri?ci:function(Wr){return Wr.__proto__||ci(Wr)})(oo)}var $n=function(oo){(function(Bn,Xn){if(typeof Xn!="function"&&Xn!==null)throw new TypeError("Super expression must either be null or a function");Bn.prototype=vs(Xn&&Xn.prototype,{constructor:{value:Bn,writable:!0,configurable:!0}}),Xn&&Cn(Bn,Xn)})(qn,oo);var Wr,Gn,Zn=(Wr=qn,Gn=Jr(),function(){var Bn,Xn=Sn(Wr);if(Gn){var so=Sn(this).constructor;Bn=kc(Xn,arguments,so)}else Bn=Xn.apply(this,arguments);return Rr(this,Bn)});function qn(Bn,Xn){var so;return function(yo,bo){if(!(yo instanceof bo))throw new TypeError("Cannot call a class as a function")}(this,qn),(so=Zn.call(this,"NosUploadError:"+Bn)).errCode=Xn,so.errMsg=Bn,so}return qn}(Ur(Error)),Rn=function oo(Wr,Gn,Zn){if(Wr.uploadState==="uploading"){var qn=Wr.config,Bn=Wr.param,Xn=gr.getUploadContext(Wr.fileKey);if(!Xn)return Zn(0);var so=new XMLHttpRequest,yo=qn.directUploadAddr+"/".concat(Bn.bucketName)+"/".concat(encodeURIComponent(Bn.objectName))+"?uploadContext"+"&context=".concat(Xn)+"&version=".concat(qn.version);so.onreadystatechange=function(){var bo;if(Wr.uploadState!=="abort"&&so.readyState===4){var ta,Po,ha,Bo;try{Bo=JSON.parse(so.responseText)}catch{Bo={errMsg:"JsonParseError in getOffset",errCode:500}}so.status===200?Bo.errCode?Wr.config.onError(new $n(Bo.errMsg,Bo.errCode)):Zn(Bo.offset):so.status.toString().match(/^5/)?oo(Wr,Gn-1,Zn):Gn>0?(typeof((bo=qn.logger)===null||bo===void 0?void 0:bo.error)=="function"&&qn.logger.error(di(ta="getOffset(".concat(yo,") error. retry after 3 seconds. ")).call(ta,new Date().toTimeString())),wa(function(){oo(Wr,Gn-1,Zn)},3500)):(gr.removeFileInfo(Wr.fileKey),so.status?qn.onError(new $n(di(Po=di(ha="getOffset(".concat(yo,") error: ")).call(ha,so.status," ")).call(Po,so.statusText))):qn.onError(new $n("getOffset(".concat(yo,") error. no Error Code"))))}},so.open("get",yo),so.setRequestHeader("x-nos-token",Bn.token),so.timeout=qn.getOffsetTimeout,so.send()}},Wn=function oo(Wr,Gn,Zn,qn){if(Wr.uploadState==="uploading"){var Bn=Wr.param,Xn=Wr.config,so=Fo(File.prototype),yo=Bn.ctx!==void 0?Bn.ctx:"",bo=Gn+Xn.trunkSize>Wr.file.size,ta=bo?Wr.file.size:Gn+Xn.trunkSize,Po=new XMLHttpRequest,ha=Xn.directUploadAddr+"/".concat(Bn.bucketName)+"/".concat(encodeURIComponent(Bn.objectName));if(Po.upload.onprogress=function(qo){if(Wr.uploadState!=="abort"){var va=0;qo.lengthComputable?(va=(Gn+qo.loaded)/Wr.file.size,Xn.onProgress(va),Xn.onUploadProgress({loaded:qo.loaded,total:Wr.file.size,percentage:va,percentageText:(100*va).toFixed(2)+"%"})):Xn.onError(new $n("browser does not support query upload progress"))}},Po.onreadystatechange=function(){var qo,va;if(Wr.uploadState!=="abort"&&Po.readyState===4){var Wi,Ho,Gi,as;try{as=JSON.parse(Po.responseText)}catch(xo){typeof((qo=Xn.logger)===null||qo===void 0?void 0:qo.error)=="function"&&Xn.logger.error("JsonParseError in uploadTrunk",xo),as={errMsg:"JsonParseError in uploadTrunk"}}Po.status===200?(Wr.setContext(as.context),bo?(qn(),Wr.setComplete()):oo(Wr,as.offset,Xn.retryCount,qn)):Po.status.toString().match(/^5/)?Zn>0?oo(Wr,Gn,Zn-1,qn):(gr.removeFileInfo(Wr.fileKey),Xn.onError(new $n(as.errMsg,as.errCode))):Zn>0?(typeof((va=Xn.logger)===null||va===void 0?void 0:va.error)=="function"&&Xn.logger.error(di(Wi="uploadTrunk(".concat(ha,") error. retry after 3 seconds. ")).call(Wi,new Date().toTimeString())),wa(function(){oo(Wr,Gn,Zn-1,qn)},3500)):(gr.removeFileInfo(Wr.fileKey),Po.status?Xn.onError(new $n(di(Ho=di(Gi="uploadTrunk(".concat(ha,") error: ")).call(Gi,Po.status," ")).call(Ho,Po.statusText))):Xn.onError(new $n("uploadTrunk(".concat(ha,") error. no Error Code. Please check your network"))))}},Po.open("post",ha+"?offset=".concat(Gn)+"&complete=".concat(bo)+"&context=".concat(yo)+"&version=".concat(Xn.version)),Po.setRequestHeader("x-nos-token",Bn.token),Wr.file.type&&Po.setRequestHeader("content-type",Wr.file.type),Po.timeout=Xn.trunkUploadTimeout,typeof FileReader<"u"){var Bo=new FileReader;Bo.addEventListener("load",function(qo){var va;!((va=qo==null?void 0:qo.target)===null||va===void 0)&&va.result?Po.send(qo.target.result):Xn.onError(new $n("Read ArrayBuffer failed"))}),Bo.addEventListener("error",function(qo){var va=qo.target.error;Xn.onError(new $n("Read ArrayBuffer error. ".concat(va.toString()),va.code))}),Bo.readAsArrayBuffer(so.call(Wr.file,Gn,ta))}else Po.send(so.call(Wr.file,Gn,ta))}};function Fn(oo,Wr){for(var Gn=0;Gn<Wr.length;Gn++){var Zn=Wr[Gn];Zn.enumerable=Zn.enumerable||!1,Zn.configurable=!0,"value"in Zn&&(Zn.writable=!0),gc(oo,Zn.key,Zn)}}var mo=function(){function oo(Gn,Zn,qn){(function(Bn,Xn){if(!(Bn instanceof Xn))throw new TypeError("Cannot call a class as a function")})(this,oo),this.uploadState="paused",this.config=qn,this.file=Gn,this.param=Zn,this.fileKey=gr.initFile(Zn,Gn,this.config.enableCache),this.resume()}var Wr;return(Wr=[{key:"resume",value:function(){var Zn=this;if(this.uploadState!=="uploading"){this.setUploadState("uploading");var qn=this.config;Rn(this,qn.retryCount,function(Bn){Wn(Zn,Bn,qn.retryCount,function(){Zn.setUploadState("ended"),typeof qn.onComplete=="function"&&qn.onComplete(Zn.param)})})}}},{key:"pause",value:function(){this.setUploadState("paused")}},{key:"abort",value:function(){this.setUploadState("abort"),gr.removeFileInfo(this.fileKey),this.config.onError(new $n("Upload Aborted",10499))}},{key:"setUploadState",value:function(Zn){Zn!==this.uploadState&&(this.uploadState=Zn)}},{key:"setContext",value:function(Zn){gr.setUploadContext(this.fileKey,Zn,this.config.enableCache),this.param.ctx=Zn}},{key:"setComplete",value:function(){gr.setComplete(this.fileKey,this.config.enableCache),this.setUploadState("ended")}}])&&Fn(oo.prototype,Wr),oo}(),ao={maxFileCache:6,expireTime:864e5,getFileUploadInformation:function(Wr){var Gn=gr.getFileKey(Wr),Zn=gr.getFileInfo(Gn);return Zn===null?null:Ms()-Zn.modifyAt>ao.expireTime?(gr.removeFileInfo(Gn),null):{uploadInfo:jn({bucketName:Zn.bucket,objectName:Zn.obj,token:Zn.token,ctx:Zn.ctx},Zn.payload?{payload:Zn.payload}:{}),complete:Zn.end}},setMaxFileCache:function(Wr){ao.maxFileCache=Wr},setExpireTime:function(Wr){ao.expireTime=Wr},printCaches:function(){for(var Wr=0,Gn=Sa(localStorage);Wr<Gn.length;Wr++){var Zn=Gn[Wr],qn=gr.getFileInfo(Zn);qn&&console.log(qn,"modifiedAt",new Date(qn.modifyAt).toTimeString())}},createConfig:function(Wr){return new Ie(Wr)},createTask:function(Wr,Gn,Zn){return new mo(Wr,Gn,Zn)}},ea=ao;return Oe.default}()}),zl=g(function(pe,_e){pe.exports=function(){function Ve(nr){if(nr){var kt,ur="";return Kn(kt=Sa(nr)).call(kt,function(gr,Ar){ur+=Ar===0?"?":"&",ur+=gr+"="+nr[gr]}),ur}return""}function Oe(nr,kt,ur,gr){return Error.call(this,ur),this.source=nr,this.code=kt,this.desc=ur,this.detail=gr||{},this}function Ie(nr,kt){var ur=vs(kt.prototype);ur.constructor=nr,nr.prototype=ur}function At(nr,kt){kt===void 0&&(kt={dataType:"json",method:"GET",timeout:5e3});var ur=kt.dataType==="text"?"text/plain; charset=UTF-8":"application/json; charset=UTF-8",gr=kt.method==="GET"?Ve(kt.params):"";return new wo(function(Ar,Rr){if(window.XMLHttpRequest){var Ur,Dr=new XMLHttpRequest;if(Dr.onreadystatechange=function(){if(Dr.readyState===4)if(Dr.status===200){try{Ur=JSON.parse(Dr.response||"{}")}catch{Ur=Dr.response}Ar({status:Dr.status,data:Ur})}else Rr(new Oe(1,Dr.status,Dr.statusText))},Dr.open(kt.method,""+nr+gr),Dr.timeout=kt.timeout||5e3,Dr.setRequestHeader("Content-Type",ur),kt.headers)for(var Jr in kt.headers)Dr.setRequestHeader(Jr,kt.headers[Jr]);Dr.ontimeout=function(Cn){Rr(new Oe(1,408,Cn&&Cn.message?Cn.message:"request timeout"))},Dr.send(Eo(kt.data))}else Rr(new Oe(2,10400,"request no suppout"))})}return Ie(Oe,Error),At}()}),wu=console,VM={setLogger:function(_e){wu=_e},platform:"BROWSER",localStorage:window.localStorage,request:zl,WebSocket:window.WebSocket,uploadFile:function(_e){return Hr(this,void 0,void 0,wr.mark(function Ve(){var Oe,Ie,At,nr,kt,ur;return wr.wrap(function(Ar){for(;;)switch(Ar.prev=Ar.next){case 0:if(_e.fileInput||_e.file){Ar.next=2;break}throw new Error("File not exist");case 2:if(!_e.file){Ar.next=6;break}nr=_e.file,Ar.next=20;break;case 6:if(typeof _e.fileInput!="string"){Ar.next=15;break}if(!((kt=document.getElementById(_e.fileInput))&&kt.files&&kt.files[0])){Ar.next=12;break}nr=kt.files[0],Ar.next=13;break;case 12:throw new Error("Can not get file from fileInput");case 13:Ar.next=20;break;case 15:if(!(_e.fileInput&&_e.fileInput.files&&_e.fileInput.files[0])){Ar.next=19;break}nr=_e.fileInput.files[0],Ar.next=20;break;case 19:throw new Error("Can not get file from fileInput "+_e.fileInput);case 20:if(!(_e.maxSize&&nr.size>_e.maxSize)){Ar.next=22;break}throw new Error("The file exceeds maxSize limit. maxSize: "+_e.maxSize+", get "+nr.size);case 22:return Ar.next=24,new wo(function(Rr,Ur){var Dr=yb.createConfig({enableCache:!1,directUploadAddr:_e.chunkUploadHost,onError:function(Sn){Ur(Sn)},onProgress:_e.onUploadProgress||function(){},onComplete:function(Sn){Rr(Sn)}}),Jr=yb.createTask(nr,{bucketName:_e.nosToken.bucket,objectName:decodeURIComponent(_e.nosToken.objectName),token:_e.nosToken.token},Dr);try{_e.onUploadStart&&_e.onUploadStart(Jr)}catch(Cn){wu.error("Adapter uploadFile: options.onUploadStart error",Cn&&Cn.message),Jr.abort(),Ur(Cn)}});case 24:return(ur=Ar.sent).name=nr.name,ur.size=nr.size,ur.type=nr.type,ur.ext=vb(Oe=ur.name).call(Oe,".")>-1?Fo(Ie=ur.name).call(Ie,vb(At=ur.name).call(At,".")+1).toLowerCase():"",Ar.abrupt("return",ur);case 30:case"end":return Ar.stop()}},Ve)}))},getSystemInfo:function(){var _e,Ve;return{os:((_e=nl.os)===null||_e===void 0?void 0:_e.family)||"",osVer:((Ve=nl.os)===null||Ve===void 0?void 0:Ve.version)||"",browser:nl.name||"",browserVer:nl.version||"",hostEnv:"BROWSER",hostEnvVer:nl.version||"",hostInfo:nl.ua||""}}};return vp.setAdapters(VM),vp})})(QCHAT_BROWSER_SDK);var QCHAT_BROWSER_SDKExports=QCHAT_BROWSER_SDK.exports;const QChatSDK=getDefaultExportFromCjs(QCHAT_BROWSER_SDKExports);var NIM_BROWSER_SDK={exports:{}};(function(t,r){(function(e,n){t.exports=n()})(commonjsGlobal,function(){var e=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof commonjsGlobal<"u"?commonjsGlobal:typeof self<"u"?self:{};function n(xe){return xe&&xe.__esModule&&Object.prototype.hasOwnProperty.call(xe,"default")?xe.default:xe}function g(xe){var he={exports:{}};return xe(he,he.exports),he.exports}var y,i,k=n(g(function(xe){xe.exports=function(Fe){if(Fe===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return Fe},xe.exports.__esModule=!0,xe.exports.default=xe.exports})),$=function(xe){return xe&&xe.Math==Math&&xe},L=$(typeof globalThis=="object"&&globalThis)||$(typeof window=="object"&&window)||$(typeof self=="object"&&self)||$(typeof e=="object"&&e)||function(){return this}()||Function("return this")(),V=function(xe){try{return!!xe()}catch{return!0}},z=!V(function(){var xe=(function(){}).bind();return typeof xe!="function"||xe.hasOwnProperty("prototype")}),re=Function.prototype,ie=re.apply,ue=re.call,le=typeof Reflect=="object"&&Reflect.apply||(z?ue.bind(ie):function(){return ue.apply(ie,arguments)}),oe=Function.prototype,ae=oe.bind,qe=oe.call,de=z&&ae.bind(qe,qe),Ne=z?function(xe){return xe&&de(xe)}:function(xe){return xe&&function(){return qe.apply(xe,arguments)}},ze=function(xe){return typeof xe=="function"},$e=!V(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!=7}),Lt=Function.prototype.call,jt=z?Lt.bind(Lt):function(){return Lt.apply(Lt,arguments)},Et={}.propertyIsEnumerable,ir=Object.getOwnPropertyDescriptor,dr={f:ir&&!Et.call({1:2},1)?function(he){var Fe=ir(this,he);return!!Fe&&Fe.enumerable}:Et},Dt=function(xe,he){return{enumerable:!(1&xe),configurable:!(2&xe),writable:!(4&xe),value:he}},lr=Ne({}.toString),sr=Ne("".slice),er=function(xe){return sr(lr(xe),8,-1)},cr=Object,or=Ne("".split),hr=V(function(){return!cr("z").propertyIsEnumerable(0)})?function(xe){return er(xe)=="String"?or(xe,""):cr(xe)}:cr,pr=function(xe){return xe==null},Sr=TypeError,Er=function(xe){if(pr(xe))throw Sr("Can't call method on "+xe);return xe},Pr=function(xe){return hr(Er(xe))},Cr=typeof document=="object"&&document.all,rr=Cr===void 0&&Cr!==void 0?function(xe){return typeof xe=="object"?xe!==null:ze(xe)||xe===Cr}:function(xe){return typeof xe=="object"?xe!==null:ze(xe)},kr={},Ir=function(xe){return ze(xe)?xe:void 0},xr=function(xe,he){return arguments.length<2?Ir(kr[xe])||Ir(L[xe]):kr[xe]&&kr[xe][he]||L[xe]&&L[xe][he]},vr=Ne({}.isPrototypeOf),_r=xr("navigator","userAgent")||"",Or=L.process,Mr=L.Deno,yr=Or&&Or.versions||Mr&&Mr.version,mr=yr&&yr.v8;mr&&(i=(y=mr.split("."))[0]>0&&y[0]<4?1:+(y[0]+y[1])),!i&&_r&&(!(y=_r.match(/Edge\/(\d+)/))||y[1]>=74)&&(y=_r.match(/Chrome\/(\d+)/))&&(i=+y[1]);var Tr,Br=i,$r=!!Object.getOwnPropertySymbols&&!V(function(){var xe=Symbol();return!String(xe)||!(Object(xe)instanceof Symbol)||!Symbol.sham&&Br&&Br<41}),Lr=$r&&!Symbol.sham&&typeof Symbol.iterator=="symbol",Gr=Object,qr=Lr?function(xe){return typeof xe=="symbol"}:function(xe){var he=xr("Symbol");return ze(he)&&vr(he.prototype,Gr(xe))},Yr=String,bn=function(xe){try{return Yr(xe)}catch{return"Object"}},wn=TypeError,Xr=function(xe){if(ze(xe))return xe;throw wn(bn(xe)+" is not a function")},Vn=function(xe,he){var Fe=xe[he];return pr(Fe)?void 0:Xr(Fe)},Zr=TypeError,Nn=Object.defineProperty,Qr="__core-js_shared__",kn=L[Qr]||function(xe,he){try{Nn(L,xe,{value:he,configurable:!0,writable:!0})}catch{L[xe]=he}return he}(Qr,{}),Dn=g(function(xe){(xe.exports=function(he,Fe){return kn[he]||(kn[he]=Fe!==void 0?Fe:{})})("versions",[]).push({version:"3.25.0",mode:"pure",copyright:"© 2014-2022 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.25.0/LICENSE",source:"https://github.com/zloirock/core-js"})}),xn=Object,An=function(xe){return xn(Er(xe))},vn=Ne({}.hasOwnProperty),hn=Object.hasOwn||function(he,Fe){return vn(An(he),Fe)},Yn=0,Oo=Math.random(),Vo=Ne(1 .toString),Uo=function(xe){return"Symbol("+(xe===void 0?"":xe)+")_"+Vo(++Yn+Oo,36)},Io=Dn("wks"),ra=L.Symbol,Wa=ra&&ra.for,Rs=Lr?ra:ra&&ra.withoutSetter||Uo,To=function(xe){if(!hn(Io,xe)||!$r&&typeof Io[xe]!="string"){var he="Symbol."+xe;$r&&hn(ra,xe)?Io[xe]=ra[xe]:Io[xe]=Lr&&Wa?Wa(he):Rs(he)}return Io[xe]},Qs=TypeError,to=To("toPrimitive"),ba=function(xe,he){if(!rr(xe)||qr(xe))return xe;var Fe,Ue=Vn(xe,to);if(Ue){if(he===void 0&&(he="default"),Fe=jt(Ue,xe,he),!rr(Fe)||qr(Fe))return Fe;throw Qs("Can't convert object to primitive value")}return he===void 0&&(he="number"),function(Ce,Pt){var ar,tr;if(Pt==="string"&&ze(ar=Ce.toString)&&!rr(tr=jt(ar,Ce))||ze(ar=Ce.valueOf)&&!rr(tr=jt(ar,Ce))||Pt!=="string"&&ze(ar=Ce.toString)&&!rr(tr=jt(ar,Ce)))return tr;throw Zr("Can't convert object to primitive value")}(xe,he)},ka=function(xe){var he=ba(xe,"string");return qr(he)?he:he+""},qa=L.document,Ya=rr(qa)&&rr(qa.createElement),Xo=function(xe){return Ya?qa.createElement(xe):{}},Co=!$e&&!V(function(){return Object.defineProperty(Xo("div"),"a",{get:function(){return 7}}).a!=7}),Ga=Object.getOwnPropertyDescriptor,Xa={f:$e?Ga:function(he,Fe){if(he=Pr(he),Fe=ka(Fe),Co)try{return Ga(he,Fe)}catch{}if(hn(he,Fe))return Dt(!jt(dr.f,he,Fe),he[Fe])}},Gl=/#|\.prototype\./,Js=function(xe,he){var Fe=pa[wi(xe)];return Fe==_u||Fe!=ti&&(ze(he)?V(he):!!he)},wi=Js.normalize=function(xe){return String(xe).replace(Gl,".").toLowerCase()},pa=Js.data={},ti=Js.NATIVE="N",_u=Js.POLYFILL="P",ac=Js,Dc=Ne(Ne.bind),Zo=function(xe,he){return Xr(xe),he===void 0?xe:z?Dc(xe,he):function(){return xe.apply(he,arguments)}},Nf=$e&&V(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!=42}),Cb=String,kb=TypeError,lo=function(xe){if(rr(xe))return xe;throw kb(Cb(xe)+" is not an object")},wb=TypeError,Iu=Object.defineProperty,xb=Object.getOwnPropertyDescriptor,_b="enumerable",Ib="configurable",Eb="writable",Pa={f:$e?Nf?function(he,Fe,Ue){if(lo(he),Fe=ka(Fe),lo(Ue),typeof he=="function"&&Fe==="prototype"&&"value"in Ue&&Eb in Ue&&!Ue.writable){var Ce=xb(he,Fe);Ce&&Ce.writable&&(he[Fe]=Ue.value,Ue={configurable:Ib in Ue?Ue.configurable:Ce.configurable,enumerable:_b in Ue?Ue.enumerable:Ce.enumerable,writable:!1})}return Iu(he,Fe,Ue)}:Iu:function(he,Fe,Ue){if(lo(he),Fe=ka(Fe),lo(Ue),Co)try{return Iu(he,Fe,Ue)}catch{}if("get"in Ue||"set"in Ue)throw wb("Accessors not supported");return"value"in Ue&&(he[Fe]=Ue.value),he}},fa=$e?function(xe,he,Fe){return Pa.f(xe,he,Dt(1,Fe))}:function(xe,he,Fe){return xe[he]=Fe,xe},Pb=Xa.f,Ab=function(xe){var he=function(Fe,Ue,Ce){if(this instanceof he){switch(arguments.length){case 0:return new xe;case 1:return new xe(Fe);case 2:return new xe(Fe,Ue)}return new xe(Fe,Ue,Ce)}return le(xe,this,arguments)};return he.prototype=xe.prototype,he},_n=function(xe,he){var Fe,Ue,Ce,Pt,ar,tr,fr,br,Nr=xe.target,Fr=xe.global,jr=xe.stat,Vr=xe.proto,Kr=Fr?L:jr?L[Nr]:(L[Nr]||{}).prototype,Tn=Fr?kr:kr[Nr]||fa(kr,Nr,{})[Nr],Mn=Tn.prototype;for(Ce in he)Fe=!ac(Fr?Ce:Nr+(jr?".":"#")+Ce,xe.forced)&&Kr&&hn(Kr,Ce),ar=Tn[Ce],Fe&&(tr=xe.dontCallGetSet?(br=Pb(Kr,Ce))&&br.value:Kr[Ce]),Pt=Fe&&tr?tr:he[Ce],Fe&&typeof ar==typeof Pt||(fr=xe.bind&&Fe?Zo(Pt,L):xe.wrap&&Fe?Ab(Pt):Vr&&ze(Pt)?Ne(Pt):Pt,(xe.sham||Pt&&Pt.sham||ar&&ar.sham)&&fa(fr,"sham",!0),fa(Tn,Ce,fr),Vr&&(hn(kr,Ue=Nr+"Prototype")||fa(kr,Ue,{}),fa(kr[Ue],Ce,Pt),xe.real&&Mn&&!Mn[Ce]&&fa(Mn,Ce,Pt)))},Nb=Math.ceil,Ob=Math.floor,Rb=Math.trunc||function(he){var Fe=+he;return(Fe>0?Ob:Nb)(Fe)},sc=function(xe){var he=+xe;return he!=he||he===0?0:Rb(he)},Bb=Math.max,Fb=Math.min,xi=function(xe,he){var Fe=sc(xe);return Fe<0?Bb(Fe+he,0):Fb(Fe,he)},$b=Math.min,Ka=function(xe){return(he=xe.length)>0?$b(sc(he),9007199254740991):0;var he},Of=function(xe){return function(he,Fe,Ue){var Ce,Pt=Pr(he),ar=Ka(Pt),tr=xi(Ue,ar);if(xe&&Fe!=Fe){for(;ar>tr;)if((Ce=Pt[tr++])!=Ce)return!0}else for(;ar>tr;tr++)if((xe||tr in Pt)&&Pt[tr]===Fe)return xe||tr||0;return!xe&&-1}},Eu={includes:Of(!0),indexOf:Of(!1)},_i={},Lb=Eu.indexOf,Rf=Ne([].push),Bf=function(xe,he){var Fe,Ue=Pr(xe),Ce=0,Pt=[];for(Fe in Ue)!hn(_i,Fe)&&hn(Ue,Fe)&&Rf(Pt,Fe);for(;he.length>Ce;)hn(Ue,Fe=he[Ce++])&&(~Lb(Pt,Fe)||Rf(Pt,Fe));return Pt},il=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],Bs=Object.keys||function(he){return Bf(he,il)},jb=$e&&!Nf?Object.defineProperties:function(he,Fe){lo(he);for(var Ue,Ce=Pr(Fe),Pt=Bs(Fe),ar=Pt.length,tr=0;ar>tr;)Pa.f(he,Ue=Pt[tr++],Ce[Ue]);return he},Ff={f:jb},Pu=xr("document","documentElement"),$f=Dn("keys"),cl=function(xe){return $f[xe]||($f[xe]=Uo(xe))},Lf=cl("IE_PROTO"),Au=function(){},jf=function(xe){return"<script>"+xe+"<\/script>"},Df=function(xe){xe.write(jf("")),xe.close();var he=xe.parentWindow.Object;return xe=null,he},ll=function(){try{Tr=new ActiveXObject("htmlfile")}catch{}var xe,he;ll=typeof document<"u"?document.domain&&Tr?Df(Tr):((he=Xo("iframe")).style.display="none",Pu.appendChild(he),he.src="javascript:",(xe=he.contentWindow.document).open(),xe.write(jf("document.F=Object")),xe.close(),xe.F):Df(Tr);for(var Fe=il.length;Fe--;)delete ll.prototype[il[Fe]];return ll()};_i[Lf]=!0;var Qa=Object.create||function(he,Fe){var Ue;return he!==null?(Au.prototype=lo(he),Ue=new Au,Au.prototype=null,Ue[Lf]=he):Ue=ll(),Fe===void 0?Ue:Ff.f(Ue,Fe)};_n({target:"Object",stat:!0,sham:!$e},{create:Qa});var Db=kr.Object,vs=function(he,Fe){return Db.create(he,Fe)},Ub=String,qb=TypeError,ic=Object.setPrototypeOf||("__proto__"in{}?function(){var xe,he=!1,Fe={};try{(xe=Ne(Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set))(Fe,[]),he=Fe instanceof Array}catch{}return function(Ce,Pt){return lo(Ce),function(ar){if(typeof ar=="object"||ze(ar))return ar;throw qb("Can't set "+Ub(ar)+" as a prototype")}(Pt),he?xe(Ce,Pt):Ce.__proto__=Pt,Ce}}():void 0);_n({target:"Object",stat:!0},{setPrototypeOf:ic});var ri=kr.Object.setPrototypeOf,Fs=Ne([].slice),Uf=Function,Vb=Ne([].concat),Hb=Ne([].join),Nu={},zb=function(xe,he,Fe){if(!hn(Nu,he)){for(var Ue=[],Ce=0;Ce<he;Ce++)Ue[Ce]="a["+Ce+"]";Nu[he]=Uf("C,a","return new C("+Hb(Ue,",")+")")}return Nu[he](xe,Fe)},Ou=z?Uf.bind:function(he){var Fe=Xr(this),Ue=Fe.prototype,Ce=Fs(arguments,1),Pt=function(){var tr=Vb(Ce,Fs(arguments));return this instanceof Pt?zb(Fe,tr.length,tr):Fe.apply(he,tr)};return rr(Ue)&&(Pt.prototype=Ue),Pt};_n({target:"Function",proto:!0,forced:Function.bind!==Ou},{bind:Ou});var na=function(xe){return kr[xe+"Prototype"]},Wb=na("Function").bind,Ru=Function.prototype,Go=function(xe){var he=xe.bind;return xe===Ru||vr(Ru,xe)&&he===Ru.bind?Wb:he},Bu=g(function(xe){function he(Fe,Ue){var Ce;return xe.exports=he=ri?Go(Ce=ri).call(Ce):function(ar,tr){return ar.__proto__=tr,ar},xe.exports.__esModule=!0,xe.exports.default=xe.exports,he(Fe,Ue)}xe.exports=he,xe.exports.__esModule=!0,xe.exports.default=xe.exports}),Ko=n(g(function(xe){xe.exports=function(Fe,Ue){Fe.prototype=vs(Ue.prototype),Fe.prototype.constructor=Fe,Bu(Fe,Ue)},xe.exports.__esModule=!0,xe.exports.default=xe.exports})),ys=Array.isArray||function(he){return er(he)=="Array"},Gb=TypeError,Fu=function(xe){if(xe>9007199254740991)throw Gb("Maximum allowed index exceeded");return xe},ni=function(xe,he,Fe){var Ue=ka(he);Ue in xe?Pa.f(xe,Ue,Dt(0,Fe)):xe[Ue]=Fe},qf={};qf[To("toStringTag")]="z";var $u=String(qf)==="[object z]",Kb=To("toStringTag"),Qb=Object,Jb=er(function(){return arguments}())=="Arguments",oi=$u?er:function(xe){var he,Fe,Ue;return xe===void 0?"Undefined":xe===null?"Null":typeof(Fe=function(Ce,Pt){try{return Ce[Pt]}catch{}}(he=Qb(xe),Kb))=="string"?Fe:Jb?er(he):(Ue=er(he))=="Object"&&ze(he.callee)?"Arguments":Ue},Yb=Ne(Function.toString);ze(kn.inspectSource)||(kn.inspectSource=function(xe){return Yb(xe)});var Vf=kn.inspectSource,Hf=function(){},Xb=[],zf=xr("Reflect","construct"),Lu=/^\s*(?:class|function)\b/,Zb=Ne(Lu.exec),e0=!Lu.exec(Hf),cc=function(he){if(!ze(he))return!1;try{return zf(Hf,Xb,he),!0}catch{return!1}},Wf=function(he){if(!ze(he))return!1;switch(oi(he)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return e0||!!Zb(Lu,Vf(he))}catch{return!0}};Wf.sham=!0;var ul=!zf||V(function(){var xe;return cc(cc.call)||!cc(Object)||!cc(function(){xe=!0})||xe})?Wf:cc,t0=To("species"),Gf=Array,ju=function(xe,he){return new(function(Fe){var Ue;return ys(Fe)&&(Ue=Fe.constructor,(ul(Ue)&&(Ue===Gf||ys(Ue.prototype))||rr(Ue)&&(Ue=Ue[t0])===null)&&(Ue=void 0)),Ue===void 0?Gf:Ue}(xe))(he===0?0:he)},r0=To("species"),lc=function(xe){return Br>=51||!V(function(){var he=[];return(he.constructor={})[r0]=function(){return{foo:1}},he[xe](Boolean).foo!==1})},Kf=To("isConcatSpreadable"),n0=Br>=51||!V(function(){var xe=[];return xe[Kf]=!1,xe.concat()[0]!==xe}),o0=lc("concat"),a0=function(xe){if(!rr(xe))return!1;var he=xe[Kf];return he!==void 0?!!he:ys(xe)};_n({target:"Array",proto:!0,arity:1,forced:!n0||!o0},{concat:function(he){var Fe,Ue,Ce,Pt,ar,tr=An(this),fr=ju(tr,0),br=0;for(Fe=-1,Ce=arguments.length;Fe<Ce;Fe++)if(a0(ar=Fe===-1?tr:arguments[Fe]))for(Pt=Ka(ar),Fu(br+Pt),Ue=0;Ue<Pt;Ue++,br++)Ue in ar&&ni(fr,br,ar[Ue]);else Fu(br+1),ni(fr,br++,ar);return fr.length=br,fr}});var dl,uc,pl,s0=String,Za=function(xe){if(oi(xe)==="Symbol")throw TypeError("Cannot convert a Symbol value to a string");return s0(xe)},i0=il.concat("length","prototype"),dc={f:Object.getOwnPropertyNames||function(he){return Bf(he,i0)}},c0=Array,l0=Math.max,Du=function(xe,he,Fe){for(var Ue=Ka(xe),Ce=xi(he,Ue),Pt=xi(Fe===void 0?Ue:Fe,Ue),ar=c0(l0(Pt-Ce,0)),tr=0;Ce<Pt;Ce++,tr++)ni(ar,tr,xe[Ce]);return ar.length=tr,ar},Qf=dc.f,Jf=typeof window=="object"&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],Uu={f:function(he){return Jf&&er(he)=="Window"?function(Fe){try{return Qf(Fe)}catch{return Du(Jf)}}(he):Qf(Pr(he))}},pc={f:Object.getOwnPropertySymbols},$s=function(xe,he,Fe,Ue){return Ue&&Ue.enumerable?xe[he]=Fe:fa(xe,he,Fe),xe},qu={f:To},u0=Pa.f,jo=function(xe){var he=kr.Symbol||(kr.Symbol={});hn(he,xe)||u0(he,xe,{value:qu.f(xe)})},Yf=function(){var xe=xr("Symbol"),he=xe&&xe.prototype,Fe=he&&he.valueOf,Ue=To("toPrimitive");he&&!he[Ue]&&$s(he,Ue,function(Ce){return jt(Fe,this)},{arity:1})},d0=$u?{}.toString:function(){return"[object "+oi(this)+"]"},p0=Pa.f,Xf=To("toStringTag"),ai=function(xe,he,Fe,Ue){if(xe){var Ce=Fe?xe:xe.prototype;hn(Ce,Xf)||p0(Ce,Xf,{configurable:!0,value:he}),Ue&&!$u&&fa(Ce,"toString",d0)}},Zf=L.WeakMap,f0=ze(Zf)&&/native code/.test(String(Zf)),em="Object already initialized",Vu=L.TypeError,m0=L.WeakMap;if(f0||kn.state){var si=kn.state||(kn.state=new m0),g0=Ne(si.get),tm=Ne(si.has),h0=Ne(si.set);dl=function(xe,he){if(tm(si,xe))throw Vu(em);return he.facade=xe,h0(si,xe,he),he},uc=function(xe){return g0(si,xe)||{}},pl=function(xe){return tm(si,xe)}}else{var Ii=cl("state");_i[Ii]=!0,dl=function(xe,he){if(hn(xe,Ii))throw Vu(em);return he.facade=xe,fa(xe,Ii,he),he},uc=function(xe){return hn(xe,Ii)?xe[Ii]:{}},pl=function(xe){return hn(xe,Ii)}}var Ja={set:dl,get:uc,has:pl,enforce:function(xe){return pl(xe)?uc(xe):dl(xe,{})},getterFor:function(xe){return function(he){var Fe;if(!rr(he)||(Fe=uc(he)).type!==xe)throw Vu("Incompatible receiver, "+xe+" required");return Fe}}},rm=Ne([].push),Ls=function(xe){var he=xe==1,Fe=xe==2,Ue=xe==3,Ce=xe==4,Pt=xe==6,ar=xe==7,tr=xe==5||Pt;return function(fr,br,Nr,Fr){for(var jr,Vr,Kr=An(fr),Tn=hr(Kr),Mn=Zo(br,Nr),En=Ka(Tn),In=0,Pn=Fr||ju,Hn=he?Pn(fr,En):Fe||ar?Pn(fr,0):void 0;En>In;In++)if((tr||In in Tn)&&(Vr=Mn(jr=Tn[In],In,Kr),xe))if(he)Hn[In]=Vr;else if(Vr)switch(xe){case 3:return!0;case 5:return jr;case 6:return In;case 2:rm(Hn,jr)}else switch(xe){case 4:return!1;case 7:rm(Hn,jr)}return Pt?-1:Ue||Ce?Ce:Hn}},js={forEach:Ls(0),map:Ls(1),filter:Ls(2),some:Ls(3),every:Ls(4),find:Ls(5),findIndex:Ls(6),filterReject:Ls(7)},fl=js.forEach,Aa=cl("hidden"),ml="Symbol",v0=Ja.set,nm=Ja.getterFor(ml),rs=Object.prototype,ii=L.Symbol,fc=ii&&ii.prototype,y0=L.TypeError,Hu=L.QObject,om=Xa.f,Ds=Pa.f,am=Uu.f,b0=dr.f,sm=Ne([].push),bs=Dn("symbols"),mc=Dn("op-symbols"),T0=Dn("wks"),zu=!Hu||!Hu.prototype||!Hu.prototype.findChild,Wu=$e&&V(function(){return Qa(Ds({},"a",{get:function(){return Ds(this,"a",{value:7}).a}})).a!=7})?function(xe,he,Fe){var Ue=om(rs,he);Ue&&delete rs[he],Ds(xe,he,Fe),Ue&&xe!==rs&&Ds(rs,he,Ue)}:Ds,Gu=function(xe,he){var Fe=bs[xe]=Qa(fc);return v0(Fe,{type:ml,tag:xe,description:he}),$e||(Fe.description=he),Fe},gl=function(he,Fe,Ue){he===rs&&gl(mc,Fe,Ue),lo(he);var Ce=ka(Fe);return lo(Ue),hn(bs,Ce)?(Ue.enumerable?(hn(he,Aa)&&he[Aa][Ce]&&(he[Aa][Ce]=!1),Ue=Qa(Ue,{enumerable:Dt(0,!1)})):(hn(he,Aa)||Ds(he,Aa,Dt(1,{})),he[Aa][Ce]=!0),Wu(he,Ce,Ue)):Ds(he,Ce,Ue)},Ku=function(he,Fe){lo(he);var Ue=Pr(Fe),Ce=Bs(Ue).concat(um(Ue));return fl(Ce,function(Pt){$e&&!jt(im,Ue,Pt)||gl(he,Pt,Ue[Pt])}),he},im=function(he){var Fe=ka(he),Ue=jt(b0,this,Fe);return!(this===rs&&hn(bs,Fe)&&!hn(mc,Fe))&&(!(Ue||!hn(this,Fe)||!hn(bs,Fe)||hn(this,Aa)&&this[Aa][Fe])||Ue)},cm=function(he,Fe){var Ue=Pr(he),Ce=ka(Fe);if(Ue!==rs||!hn(bs,Ce)||hn(mc,Ce)){var Pt=om(Ue,Ce);return!Pt||!hn(bs,Ce)||hn(Ue,Aa)&&Ue[Aa][Ce]||(Pt.enumerable=!0),Pt}},lm=function(he){var Fe=am(Pr(he)),Ue=[];return fl(Fe,function(Ce){hn(bs,Ce)||hn(_i,Ce)||sm(Ue,Ce)}),Ue},um=function(xe){var he=xe===rs,Fe=am(he?mc:Pr(xe)),Ue=[];return fl(Fe,function(Ce){!hn(bs,Ce)||he&&!hn(rs,Ce)||sm(Ue,bs[Ce])}),Ue};$r||(ii=function(){if(vr(fc,this))throw y0("Symbol is not a constructor");var he=arguments.length&&arguments[0]!==void 0?Za(arguments[0]):void 0,Fe=Uo(he),Ue=function(Ce){this===rs&&jt(Ue,mc,Ce),hn(this,Aa)&&hn(this[Aa],Fe)&&(this[Aa][Fe]=!1),Wu(this,Fe,Dt(1,Ce))};return $e&&zu&&Wu(rs,Fe,{configurable:!0,set:Ue}),Gu(Fe,he)},fc=ii.prototype,$s(fc,"toString",function(){return nm(this).tag}),$s(ii,"withoutSetter",function(xe){return Gu(Uo(xe),xe)}),dr.f=im,Pa.f=gl,Ff.f=Ku,Xa.f=cm,dc.f=Uu.f=lm,pc.f=um,qu.f=function(xe){return Gu(To(xe),xe)},$e&&Ds(fc,"description",{configurable:!0,get:function(){return nm(this).description}})),_n({global:!0,constructor:!0,wrap:!0,forced:!$r,sham:!$r},{Symbol:ii}),fl(Bs(T0),function(xe){jo(xe)}),_n({target:ml,stat:!0,forced:!$r},{useSetter:function(){zu=!0},useSimple:function(){zu=!1}}),_n({target:"Object",stat:!0,forced:!$r,sham:!$e},{create:function(he,Fe){return Fe===void 0?Qa(he):Ku(Qa(he),Fe)},defineProperty:gl,defineProperties:Ku,getOwnPropertyDescriptor:cm}),_n({target:"Object",stat:!0,forced:!$r},{getOwnPropertyNames:lm}),Yf(),ai(ii,ml),_i[Aa]=!0;var dm=$r&&!!Symbol.for&&!!Symbol.keyFor,Qu=Dn("string-to-symbol-registry"),S0=Dn("symbol-to-string-registry");_n({target:"Symbol",stat:!0,forced:!dm},{for:function(xe){var he=Za(xe);if(hn(Qu,he))return Qu[he];var Fe=xr("Symbol")(he);return Qu[he]=Fe,S0[Fe]=he,Fe}});var pm=Dn("symbol-to-string-registry");_n({target:"Symbol",stat:!0,forced:!dm},{keyFor:function(he){if(!qr(he))throw TypeError(bn(he)+" is not a symbol");if(hn(pm,he))return pm[he]}});var Us=xr("JSON","stringify"),hl=Ne(/./.exec),fm=Ne("".charAt),M0=Ne("".charCodeAt),C0=Ne("".replace),k0=Ne(1 .toString),w0=/[\uD800-\uDFFF]/g,mm=/^[\uD800-\uDBFF]$/,gm=/^[\uDC00-\uDFFF]$/,hm=!$r||V(function(){var xe=xr("Symbol")();return Us([xe])!="[null]"||Us({a:xe})!="{}"||Us(Object(xe))!="{}"}),vm=V(function(){return Us("\uDF06\uD834")!=='"\\udf06\\ud834"'||Us("\uDEAD")!=='"\\udead"'}),x0=function(xe,he){var Fe=Fs(arguments),Ue=he;if((rr(he)||xe!==void 0)&&!qr(xe))return ys(he)||(he=function(Ce,Pt){if(ze(Ue)&&(Pt=jt(Ue,this,Ce,Pt)),!qr(Pt))return Pt}),Fe[1]=he,le(Us,null,Fe)},_0=function(xe,he,Fe){var Ue=fm(Fe,he-1),Ce=fm(Fe,he+1);return hl(mm,xe)&&!hl(gm,Ce)||hl(gm,xe)&&!hl(mm,Ue)?"\\u"+k0(M0(xe,0),16):xe};Us&&_n({target:"JSON",stat:!0,arity:3,forced:hm||vm},{stringify:function(he,Fe,Ue){var Ce=Fs(arguments),Pt=le(hm?x0:Us,null,Ce);return vm&&typeof Pt=="string"?C0(Pt,w0,_0):Pt}});var I0=!$r||V(function(){pc.f(1)});_n({target:"Object",stat:!0,forced:I0},{getOwnPropertySymbols:function(he){var Fe=pc.f;return Fe?Fe(An(he)):[]}}),jo("asyncIterator"),jo("hasInstance"),jo("isConcatSpreadable"),jo("iterator"),jo("match"),jo("matchAll"),jo("replace"),jo("search"),jo("species"),jo("split"),jo("toPrimitive"),Yf(),jo("toStringTag"),ai(xr("Symbol"),"Symbol"),jo("unscopables"),ai(L.JSON,"JSON",!0);var qs,ym,bm,E0=kr.Symbol,Ts={},Tm=Function.prototype,P0=$e&&Object.getOwnPropertyDescriptor,Ju=hn(Tm,"name"),A0={EXISTS:Ju,PROPER:Ju&&(function(){}).name==="something",CONFIGURABLE:Ju&&(!$e||$e&&P0(Tm,"name").configurable)},Sm=!V(function(){function xe(){}return xe.prototype.constructor=null,Object.getPrototypeOf(new xe)!==xe.prototype}),Mm=cl("IE_PROTO"),Yu=Object,N0=Yu.prototype,Ei=Sm?Yu.getPrototypeOf:function(xe){var he=An(xe);if(hn(he,Mm))return he[Mm];var Fe=he.constructor;return ze(Fe)&&he instanceof Fe?Fe.prototype:he instanceof Yu?N0:null},Xu=To("iterator"),Cm=!1;[].keys&&("next"in(bm=[].keys())?(ym=Ei(Ei(bm)))!==Object.prototype&&(qs=ym):Cm=!0);var O0=!rr(qs)||V(function(){var xe={};return qs[Xu].call(xe)!==xe});qs=O0?{}:Qa(qs),ze(qs[Xu])||$s(qs,Xu,function(){return this});var km={IteratorPrototype:qs,BUGGY_SAFARI_ITERATORS:Cm},R0=km.IteratorPrototype,B0=function(){return this},F0=A0.PROPER,vl=km.BUGGY_SAFARI_ITERATORS,Zu=To("iterator"),wm="keys",yl="values",xm="entries",$0=function(){return this},ed=function(xe,he,Fe,Ue,Ce,Pt,ar){(function(En,In,Pn,Hn){var ho=In+" Iterator";En.prototype=Qa(R0,{next:Dt(+!Hn,Pn)}),ai(En,ho,!1,!0),Ts[ho]=B0})(Fe,he,Ue);var tr,fr,br,Nr=function(En){if(En===Ce&&Tn)return Tn;if(!vl&&En in Vr)return Vr[En];switch(En){case wm:return function(){return new Fe(this,En)};case yl:return function(){return new Fe(this,En)};case xm:return function(){return new Fe(this,En)}}return function(){return new Fe(this)}},Fr=he+" Iterator",jr=!1,Vr=xe.prototype,Kr=Vr[Zu]||Vr["@@iterator"]||Ce&&Vr[Ce],Tn=!vl&&Kr||Nr(Ce),Mn=he=="Array"&&Vr.entries||Kr;if(Mn&&(tr=Ei(Mn.call(new xe)))!==Object.prototype&&tr.next&&(ai(tr,Fr,!0,!0),Ts[Fr]=$0),F0&&Ce==yl&&Kr&&Kr.name!==yl&&(jr=!0,Tn=function(){return jt(Kr,this)}),Ce)if(fr={values:Nr(yl),keys:Pt?Tn:Nr(wm),entries:Nr(xm)},ar)for(br in fr)(vl||jr||!(br in Vr))&&$s(Vr,br,fr[br]);else _n({target:he,proto:!0,forced:vl||jr},fr);return ar&&Vr[Zu]!==Tn&&$s(Vr,Zu,Tn,{name:Ce}),Ts[he]=Tn,fr};Pa.f;var _m="Array Iterator",L0=Ja.set,j0=Ja.getterFor(_m);ed(Array,"Array",function(xe,he){L0(this,{type:_m,target:Pr(xe),index:0,kind:he})},function(){var xe=j0(this),he=xe.target,Fe=xe.kind,Ue=xe.index++;return!he||Ue>=he.length?(xe.target=void 0,{value:void 0,done:!0}):Fe=="keys"?{value:Ue,done:!1}:Fe=="values"?{value:he[Ue],done:!1}:{value:[Ue,he[Ue]],done:!1}},"values"),Ts.Arguments=Ts.Array;var Im=To("toStringTag");for(var td in{CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}){var Em=L[td],rd=Em&&Em.prototype;rd&&oi(rd)!==Im&&fa(rd,Im,td),Ts[td]=Ts.Array}var D0=E0;jo("asyncDispose"),jo("dispose"),jo("matcher"),jo("metadataKey"),jo("observable"),jo("metadata"),jo("patternMatch"),jo("replaceAll");var Ba=D0,U0=Ne("".charAt),Pm=Ne("".charCodeAt),q0=Ne("".slice),Am=function(xe){return function(he,Fe){var Ue,Ce,Pt=Za(Er(he)),ar=sc(Fe),tr=Pt.length;return ar<0||ar>=tr?xe?"":void 0:(Ue=Pm(Pt,ar))<55296||Ue>56319||ar+1===tr||(Ce=Pm(Pt,ar+1))<56320||Ce>57343?xe?U0(Pt,ar):Ue:xe?q0(Pt,ar,ar+2):Ce-56320+(Ue-55296<<10)+65536}},V0={codeAt:Am(!1),charAt:Am(!0)}.charAt,Nm="String Iterator",H0=Ja.set,z0=Ja.getterFor(Nm);ed(String,"String",function(xe){H0(this,{type:Nm,string:Za(xe),index:0})},function(){var he,Fe=z0(this),Ue=Fe.string,Ce=Fe.index;return Ce>=Ue.length?{value:void 0,done:!0}:(he=V0(Ue,Ce),Fe.index+=he.length,{value:he,done:!1})});var Om=qu.f("iterator"),W0=g(function(xe){function he(Fe){return xe.exports=he=typeof Ba=="function"&&typeof Om=="symbol"?function(Ue){return typeof Ue}:function(Ue){return Ue&&typeof Ba=="function"&&Ue.constructor===Ba&&Ue!==Ba.prototype?"symbol":typeof Ue},xe.exports.__esModule=!0,xe.exports.default=xe.exports,he(Fe)}xe.exports=he,xe.exports.__esModule=!0,xe.exports.default=xe.exports}),Rm=Pa.f;_n({target:"Object",stat:!0,forced:Object.defineProperty!==Rm,sham:!$e},{defineProperty:Rm});var G0=g(function(xe){var he=kr.Object,Fe=xe.exports=function(Ce,Pt,ar){return he.defineProperty(Ce,Pt,ar)};he.defineProperty.sham&&(Fe.sham=!0)}),gc=G0,K0=V(function(){Ei(1)});_n({target:"Object",stat:!0,forced:K0,sham:!Sm},{getPrototypeOf:function(he){return Ei(An(he))}});var ci=kr.Object.getPrototypeOf,li=function(xe,he){var Fe=[][xe];return!!Fe&&V(function(){Fe.call(null,he||function(){return 1},1)})},Q0=js.forEach,Bm=li("forEach")?[].forEach:function(he){return Q0(this,he,arguments.length>1?arguments[1]:void 0)};_n({target:"Array",proto:!0,forced:[].forEach!=Bm},{forEach:Bm});var J0=na("Array").forEach,nd=Array.prototype,Y0={DOMTokenList:!0,NodeList:!0},Kn=function(xe){var he=xe.forEach;return xe===nd||vr(nd,xe)&&he===nd.forEach||hn(Y0,oi(xe))?J0:he},X0=Ne([].concat),Z0=xr("Reflect","ownKeys")||function(he){var Fe=dc.f(lo(he)),Ue=pc.f;return Ue?X0(Fe,Ue(he)):Fe},Fm=Error,e1=Ne("".replace),t1=String(Fm("zxcasd").stack),$m=/\n\s*at [^:]*:[^\n]*/,r1=$m.test(t1),n1=function(xe,he){if(r1&&typeof xe=="string"&&!Fm.prepareStackTrace)for(;he--;)xe=e1(xe,$m,"");return xe},o1=function(xe,he){rr(he)&&"cause"in he&&fa(xe,"cause",he.cause)},a1=To("iterator"),s1=Array.prototype,Lm=function(xe){return xe!==void 0&&(Ts.Array===xe||s1[a1]===xe)},i1=To("iterator"),bl=function(xe){if(!pr(xe))return Vn(xe,i1)||Vn(xe,"@@iterator")||Ts[oi(xe)]},c1=TypeError,hc=function(xe,he){var Fe=arguments.length<2?bl(xe):he;if(Xr(Fe))return lo(jt(Fe,xe));throw c1(bn(xe)+" is not iterable")},od=function(xe,he,Fe){var Ue,Ce;lo(xe);try{if(!(Ue=Vn(xe,"return"))){if(he==="throw")throw Fe;return Fe}Ue=jt(Ue,xe)}catch(Pt){Ce=!0,Ue=Pt}if(he==="throw")throw Fe;if(Ce)throw Ue;return lo(Ue),Fe},l1=TypeError,Tl=function(xe,he){this.stopped=xe,this.result=he},jm=Tl.prototype,ko=function(xe,he,Fe){var Ue,Ce,Pt,ar,tr,fr,br,Nr=Fe&&Fe.that,Fr=!(!Fe||!Fe.AS_ENTRIES),jr=!(!Fe||!Fe.IS_RECORD),Vr=!(!Fe||!Fe.IS_ITERATOR),Kr=!(!Fe||!Fe.INTERRUPTED),Tn=Zo(he,Nr),Mn=function(In){return Ue&&od(Ue,"normal",In),new Tl(!0,In)},En=function(In){return Fr?(lo(In),Kr?Tn(In[0],In[1],Mn):Tn(In[0],In[1])):Kr?Tn(In,Mn):Tn(In)};if(jr)Ue=xe.iterator;else if(Vr)Ue=xe;else{if(!(Ce=bl(xe)))throw l1(bn(xe)+" is not iterable");if(Lm(Ce)){for(Pt=0,ar=Ka(xe);ar>Pt;Pt++)if((tr=En(xe[Pt]))&&vr(jm,tr))return tr;return new Tl(!1)}Ue=hc(xe,Ce)}for(fr=jr?xe.next:Ue.next;!(br=jt(fr,Ue)).done;){try{tr=En(br.value)}catch(In){od(Ue,"throw",In)}if(typeof tr=="object"&&tr&&vr(jm,tr))return tr}return new Tl(!1)},u1=function(xe,he){return xe===void 0?arguments.length<2?"":he:Za(xe)},d1=!V(function(){var xe=Error("a");return!("stack"in xe)||(Object.defineProperty(xe,"stack",Dt(1,7)),xe.stack!==7)}),p1=To("toStringTag"),Sl=Error,f1=[].push,vc=function(he,Fe){var Ue,Ce=arguments.length>2?arguments[2]:void 0,Pt=vr(ad,this);ic?Ue=ic(Sl(),Pt?Ei(this):ad):(Ue=Pt?this:Qa(ad),fa(Ue,p1,"Error")),Fe!==void 0&&fa(Ue,"message",u1(Fe)),d1&&fa(Ue,"stack",n1(Ue.stack,1)),o1(Ue,Ce);var ar=[];return ko(he,f1,{that:ar}),fa(Ue,"errors",ar),Ue};ic?ic(vc,Sl):function(xe,he,Fe){for(var Ue=Z0(he),Ce=Pa.f,Pt=Xa.f,ar=0;ar<Ue.length;ar++){var tr=Ue[ar];hn(xe,tr)||Fe&&hn(Fe,tr)||Ce(xe,tr,Pt(he,tr))}}(vc,Sl,{name:!0});var ad=vc.prototype=Qa(Sl.prototype,{constructor:Dt(1,vc),message:Dt(1,""),name:Dt(1,"AggregateError")});_n({global:!0,constructor:!0,arity:2},{AggregateError:vc});var yc,Pi,Dm,sd,cs=er(L.process)=="process",Um=To("species"),qm=function(xe){var he=xr(xe),Fe=Pa.f;$e&&he&&!he[Um]&&Fe(he,Um,{configurable:!0,get:function(){return this}})},m1=TypeError,id=function(xe,he){if(vr(he,xe))return xe;throw m1("Incorrect invocation")},g1=TypeError,Ml=function(xe){if(ul(xe))return xe;throw g1(bn(xe)+" is not a constructor")},h1=To("species"),Vs=function(xe,he){var Fe,Ue=lo(xe).constructor;return Ue===void 0||pr(Fe=lo(Ue)[h1])?he:Ml(Fe)},v1=TypeError,Vm=function(xe,he){if(xe<he)throw v1("Not enough arguments");return xe},Hm=/(?:ipad|iphone|ipod).*applewebkit/i.test(_r),cd=L.setImmediate,ld=L.clearImmediate,y1=L.process,ud=L.Dispatch,b1=L.Function,zm=L.MessageChannel,T1=L.String,dd=0,bc={},S1="onreadystatechange";try{yc=L.location}catch{}var pd=function(xe){if(hn(bc,xe)){var he=bc[xe];delete bc[xe],he()}},fd=function(xe){return function(){pd(xe)}},Wm=function(xe){pd(xe.data)},Gm=function(xe){L.postMessage(T1(xe),yc.protocol+"//"+yc.host)};cd&&ld||(cd=function(he){Vm(arguments.length,1);var Fe=ze(he)?he:b1(he),Ue=Fs(arguments,1);return bc[++dd]=function(){le(Fe,void 0,Ue)},Pi(dd),dd},ld=function(he){delete bc[he]},cs?Pi=function(xe){y1.nextTick(fd(xe))}:ud&&ud.now?Pi=function(xe){ud.now(fd(xe))}:zm&&!Hm?(sd=(Dm=new zm).port2,Dm.port1.onmessage=Wm,Pi=Zo(sd.postMessage,sd)):L.addEventListener&&ze(L.postMessage)&&!L.importScripts&&yc&&yc.protocol!=="file:"&&!V(Gm)?(Pi=Gm,L.addEventListener("message",Wm,!1)):Pi=S1 in Xo("script")?function(xe){Pu.appendChild(Xo("script")).onreadystatechange=function(){Pu.removeChild(this),pd(xe)}}:function(xe){setTimeout(fd(xe),0)});var Tc,ui,Sc,Ai,md,gd,hd,Km,Qm={set:cd,clear:ld},M1=/ipad|iphone|ipod/i.test(_r)&&L.Pebble!==void 0,C1=/web0s(?!.*chrome)/i.test(_r),k1=Xa.f,vd=Qm.set,Jm=L.MutationObserver||L.WebKitMutationObserver,Ym=L.document,Xm=L.process,Cl=L.Promise,Zm=k1(L,"queueMicrotask"),eg=Zm&&Zm.value;eg||(Tc=function(){var xe,he;for(cs&&(xe=Xm.domain)&&xe.exit();ui;){he=ui.fn,ui=ui.next;try{he()}catch(Fe){throw ui?Ai():Sc=void 0,Fe}}Sc=void 0,xe&&xe.enter()},Hm||cs||C1||!Jm||!Ym?!M1&&Cl&&Cl.resolve?((hd=Cl.resolve(void 0)).constructor=Cl,Km=Zo(hd.then,hd),Ai=function(){Km(Tc)}):cs?Ai=function(){Xm.nextTick(Tc)}:(vd=Zo(vd,L),Ai=function(){vd(Tc)}):(md=!0,gd=Ym.createTextNode(""),new Jm(Tc).observe(gd,{characterData:!0}),Ai=function(){gd.data=md=!md}));var yd=eg||function(xe){var he={fn:xe,next:void 0};Sc&&(Sc.next=he),ui||(ui=he,Ai()),Sc=he},Ni=function(xe){try{return{error:!1,value:xe()}}catch(he){return{error:!0,value:he}}},tg=function(){this.head=null,this.tail=null};tg.prototype={add:function(xe){var he={item:xe,next:null};this.head?this.tail.next=he:this.head=he,this.tail=he},get:function(){var xe=this.head;if(xe)return this.head=xe.next,this.tail===xe&&(this.tail=null),xe.item}};var bd,rg,w1=tg,Ta=L.Promise,ng=typeof Deno=="object"&&Deno&&typeof Deno.version=="object",x1=!ng&&!cs&&typeof window=="object"&&typeof document=="object",og=Ta&&Ta.prototype,_1=To("species"),ag=!1,sg=ze(L.PromiseRejectionEvent),I1=ac("Promise",function(){var xe=Vf(Ta),he=xe!==String(Ta);if(!he&&Br===66||!og.catch||!og.finally)return!0;if(!Br||Br<51||!/native code/.test(xe)){var Fe=new Ta(function(Ce){Ce(1)}),Ue=function(Ce){Ce(function(){},function(){})};if((Fe.constructor={})[_1]=Ue,!(ag=Fe.then(function(){})instanceof Ue))return!0}return!he&&(x1||ng)&&!sg}),Oi={CONSTRUCTOR:I1,REJECTION_EVENT:sg,SUBCLASSING:ag},E1=TypeError,P1=function(xe){var he,Fe;this.promise=new xe(function(Ue,Ce){if(he!==void 0||Fe!==void 0)throw E1("Bad Promise constructor");he=Ue,Fe=Ce}),this.resolve=Xr(he),this.reject=Xr(Fe)},Ss={f:function(xe){return new P1(xe)}},ig=Qm.set,kl="Promise",cg=Oi.CONSTRUCTOR,A1=Oi.REJECTION_EVENT,Td=Ja.getterFor(kl),N1=Ja.set,O1=Ta&&Ta.prototype,Mc=Ta,Sd=O1,lg=L.TypeError,Md=L.document,Cd=L.process,kd=Ss.f,R1=kd,B1=!!(Md&&Md.createEvent&&L.dispatchEvent),ug="unhandledrejection",dg=function(xe){var he;return!(!rr(xe)||!ze(he=xe.then))&&he},pg=function(xe,he){var Fe,Ue,Ce,Pt=he.value,ar=he.state==1,tr=ar?xe.ok:xe.fail,fr=xe.resolve,br=xe.reject,Nr=xe.domain;try{tr?(ar||(he.rejection===2&&$1(he),he.rejection=1),tr===!0?Fe=Pt:(Nr&&Nr.enter(),Fe=tr(Pt),Nr&&(Nr.exit(),Ce=!0)),Fe===xe.promise?br(lg("Promise-chain cycle")):(Ue=dg(Fe))?jt(Ue,Fe,fr,br):fr(Fe)):br(Pt)}catch(Fr){Nr&&!Ce&&Nr.exit(),br(Fr)}},fg=function(xe,he){xe.notified||(xe.notified=!0,yd(function(){for(var Fe,Ue=xe.reactions;Fe=Ue.get();)pg(Fe,xe);xe.notified=!1,he&&!xe.rejection&&F1(xe)}))},mg=function(xe,he,Fe){var Ue,Ce;B1?((Ue=Md.createEvent("Event")).promise=he,Ue.reason=Fe,Ue.initEvent(xe,!1,!0),L.dispatchEvent(Ue)):Ue={promise:he,reason:Fe},!A1&&(Ce=L["on"+xe])?Ce(Ue):xe===ug&&function(Pt,ar){var tr=L.console;tr&&tr.error&&(arguments.length==1?tr.error(Pt):tr.error(Pt,ar))}("Unhandled promise rejection",Fe)},F1=function(xe){jt(ig,L,function(){var he,Fe=xe.facade,Ue=xe.value;if(gg(xe)&&(he=Ni(function(){cs?Cd.emit("unhandledRejection",Ue,Fe):mg(ug,Fe,Ue)}),xe.rejection=cs||gg(xe)?2:1,he.error))throw he.value})},gg=function(xe){return xe.rejection!==1&&!xe.parent},$1=function(xe){jt(ig,L,function(){var he=xe.facade;cs?Cd.emit("rejectionHandled",he):mg("rejectionhandled",he,xe.value)})},Ri=function(xe,he,Fe){return function(Ue){xe(he,Ue,Fe)}},Bi=function(xe,he,Fe){xe.done||(xe.done=!0,Fe&&(xe=Fe),xe.value=he,xe.state=2,fg(xe,!0))},wd=function(xe,he,Fe){if(!xe.done){xe.done=!0,Fe&&(xe=Fe);try{if(xe.facade===he)throw lg("Promise can't be resolved itself");var Ue=dg(he);Ue?yd(function(){var Ce={done:!1};try{jt(Ue,he,Ri(wd,Ce,xe),Ri(Bi,Ce,xe))}catch(Pt){Bi(Ce,Pt,xe)}}):(xe.value=he,xe.state=1,fg(xe,!1))}catch(Ce){Bi({done:!1},Ce,xe)}}};cg&&(Sd=(Mc=function(he){id(this,Sd),Xr(he),jt(bd,this);var Fe=Td(this);try{he(Ri(wd,Fe),Ri(Bi,Fe))}catch(Ue){Bi(Fe,Ue)}}).prototype,(bd=function(he){N1(this,{type:kl,done:!1,notified:!1,parent:!1,reactions:new w1,rejection:!1,state:0,value:void 0})}).prototype=$s(Sd,"then",function(he,Fe){var Ue=Td(this),Ce=kd(Vs(this,Mc));return Ue.parent=!0,Ce.ok=!ze(he)||he,Ce.fail=ze(Fe)&&Fe,Ce.domain=cs?Cd.domain:void 0,Ue.state==0?Ue.reactions.add(Ce):yd(function(){pg(Ce,Ue)}),Ce.promise}),rg=function(){var xe=new bd,he=Td(xe);this.promise=xe,this.resolve=Ri(wd,he),this.reject=Ri(Bi,he)},Ss.f=kd=function(xe){return xe===Mc||xe===void 0?new rg(xe):R1(xe)}),_n({global:!0,constructor:!0,wrap:!0,forced:cg},{Promise:Mc}),ai(Mc,kl,!1,!0),qm(kl);var hg=To("iterator"),vg=!1;try{var L1=0,yg={next:function(){return{done:!!L1++}},return:function(){vg=!0}};yg[hg]=function(){return this},Array.from(yg,function(){throw 2})}catch{}var bg=function(xe,he){if(!he&&!vg)return!1;var Fe=!1;try{var Ue={};Ue[hg]=function(){return{next:function(){return{done:Fe=!0}}}},xe(Ue)}catch{}return Fe},Tg=Oi.CONSTRUCTOR||!bg(function(xe){Ta.all(xe).then(void 0,function(){})});_n({target:"Promise",stat:!0,forced:Tg},{all:function(he){var Fe=this,Ue=Ss.f(Fe),Ce=Ue.resolve,Pt=Ue.reject,ar=Ni(function(){var tr=Xr(Fe.resolve),fr=[],br=0,Nr=1;ko(he,function(Fr){var jr=br++,Vr=!1;Nr++,jt(tr,Fe,Fr).then(function(Kr){Vr||(Vr=!0,fr[jr]=Kr,--Nr||Ce(fr))},Pt)}),--Nr||Ce(fr)});return ar.error&&Pt(ar.value),Ue.promise}});var j1=Oi.CONSTRUCTOR;Ta&&Ta.prototype,_n({target:"Promise",proto:!0,forced:j1,real:!0},{catch:function(xe){return this.then(void 0,xe)}}),_n({target:"Promise",stat:!0,forced:Tg},{race:function(he){var Fe=this,Ue=Ss.f(Fe),Ce=Ue.reject,Pt=Ni(function(){var ar=Xr(Fe.resolve);ko(he,function(tr){jt(ar,Fe,tr).then(Ue.resolve,Ce)})});return Pt.error&&Ce(Pt.value),Ue.promise}}),_n({target:"Promise",stat:!0,forced:Oi.CONSTRUCTOR},{reject:function(he){var Fe=Ss.f(this);return jt(Fe.reject,void 0,he),Fe.promise}});var xd=function(xe,he){if(lo(xe),rr(he)&&he.constructor===xe)return he;var Fe=Ss.f(xe);return(0,Fe.resolve)(he),Fe.promise},D1=Oi.CONSTRUCTOR,U1=xr("Promise"),q1=!D1;_n({target:"Promise",stat:!0,forced:!0},{resolve:function(he){return xd(q1&&this===U1?Ta:this,he)}}),_n({target:"Promise",stat:!0},{allSettled:function(he){var Fe=this,Ue=Ss.f(Fe),Ce=Ue.resolve,Pt=Ue.reject,ar=Ni(function(){var tr=Xr(Fe.resolve),fr=[],br=0,Nr=1;ko(he,function(Fr){var jr=br++,Vr=!1;Nr++,jt(tr,Fe,Fr).then(function(Kr){Vr||(Vr=!0,fr[jr]={status:"fulfilled",value:Kr},--Nr||Ce(fr))},function(Kr){Vr||(Vr=!0,fr[jr]={status:"rejected",reason:Kr},--Nr||Ce(fr))})}),--Nr||Ce(fr)});return ar.error&&Pt(ar.value),Ue.promise}});var Sg="No one promise resolved";_n({target:"Promise",stat:!0},{any:function(he){var Fe=this,Ue=xr("AggregateError"),Ce=Ss.f(Fe),Pt=Ce.resolve,ar=Ce.reject,tr=Ni(function(){var fr=Xr(Fe.resolve),br=[],Nr=0,Fr=1,jr=!1;ko(he,function(Vr){var Kr=Nr++,Tn=!1;Fr++,jt(fr,Fe,Vr).then(function(Mn){Tn||jr||(jr=!0,Pt(Mn))},function(Mn){Tn||jr||(Tn=!0,br[Kr]=Mn,--Fr||ar(new Ue(br,Sg)))})}),--Fr||ar(new Ue(br,Sg))});return tr.error&&ar(tr.value),Ce.promise}});var V1=Ta&&Ta.prototype,H1=!!Ta&&V(function(){V1.finally.call({then:function(){}},function(){})});_n({target:"Promise",proto:!0,real:!0,forced:H1},{finally:function(xe){var he=Vs(this,xr("Promise")),Fe=ze(xe);return this.then(Fe?function(Ue){return xd(he,xe()).then(function(){return Ue})}:xe,Fe?function(Ue){return xd(he,xe()).then(function(){throw Ue})}:xe)}});var z1=kr.Promise;_n({target:"Promise",stat:!0,forced:!0},{try:function(xe){var he=Ss.f(this),Fe=Ni(xe);return(Fe.error?he.reject:he.resolve)(Fe.value),he.promise}});var wo=z1,W1=Ne([].reverse),Mg=[1,2];_n({target:"Array",proto:!0,forced:String(Mg)===String(Mg.reverse())},{reverse:function(){return ys(this)&&(this.length=this.length),W1(this)}});var G1=na("Array").reverse,_d=Array.prototype,Kl=function(xe){var he=xe.reverse;return xe===_d||vr(_d,xe)&&he===_d.reverse?G1:he},K1=lc("slice"),Q1=To("species"),Id=Array,J1=Math.max;_n({target:"Array",proto:!0,forced:!K1},{slice:function(he,Fe){var Ue,Ce,Pt,ar=Pr(this),tr=Ka(ar),fr=xi(he,tr),br=xi(Fe===void 0?tr:Fe,tr);if(ys(ar)&&(Ue=ar.constructor,(ul(Ue)&&(Ue===Id||ys(Ue.prototype))||rr(Ue)&&(Ue=Ue[Q1])===null)&&(Ue=void 0),Ue===Id||Ue===void 0))return Fs(ar,fr,br);for(Ce=new(Ue===void 0?Id:Ue)(J1(br-fr,0)),Pt=0;fr<br;fr++,Pt++)fr in ar&&ni(Ce,Pt,ar[fr]);return Ce.length=Pt,Ce}});var Y1=na("Array").slice,Ed=Array.prototype,Fo=function(xe){var he=xe.slice;return xe===Ed||vr(Ed,xe)&&he===Ed.slice?Y1:he},X1=g(function(xe){var he=W0.default;function Fe(){xe.exports=Fe=function(){return Ue},xe.exports.__esModule=!0,xe.exports.default=xe.exports;var Ue={},Ce=Object.prototype,Pt=Ce.hasOwnProperty,ar=typeof Ba=="function"?Ba:{},tr=ar.iterator||"@@iterator",fr=ar.asyncIterator||"@@asyncIterator",br=ar.toStringTag||"@@toStringTag";function Nr(zn,Ln,eo){return gc(zn,Ln,{value:eo,enumerable:!0,configurable:!0,writable:!0}),zn[Ln]}try{Nr({},"")}catch{Nr=function(eo,co,So){return eo[co]=So}}function Fr(zn,Ln,eo,co){var So=Ln&&Ln.prototype instanceof Kr?Ln:Kr,Mo=vs(So.prototype),ca=new zr(co||[]);return Mo._invoke=function(zo,ss,$o){var Wo="suspendedStart";return function(Ma,sl){if(Wo==="executing")throw new Error("Generator is already running");if(Wo==="completed"){if(Ma==="throw")throw sl;return ro()}for($o.method=Ma,$o.arg=sl;;){var Jo=$o.delegate;if(Jo){var jc=uo(Jo,$o);if(jc){if(jc===Vr)continue;return jc}}if($o.method==="next")$o.sent=$o._sent=$o.arg;else if($o.method==="throw"){if(Wo==="suspendedStart")throw Wo="completed",$o.arg;$o.dispatchException($o.arg)}else $o.method==="return"&&$o.abrupt("return",$o.arg);Wo="executing";var fs=jr(zo,ss,$o);if(fs.type==="normal"){if(Wo=$o.done?"completed":"suspendedYield",fs.arg===Vr)continue;return{value:fs.arg,done:$o.done}}fs.type==="throw"&&(Wo="completed",$o.method="throw",$o.arg=fs.arg)}}}(zn,eo,ca),Mo}function jr(zn,Ln,eo){try{return{type:"normal",arg:zn.call(Ln,eo)}}catch(co){return{type:"throw",arg:co}}}Ue.wrap=Fr;var Vr={};function Kr(){}function Tn(){}function Mn(){}var En={};Nr(En,tr,function(){return this});var In=ci&&ci(ci(Jn([])));In&&In!==Ce&&Pt.call(In,tr)&&(En=In);var Pn=Mn.prototype=Kr.prototype=vs(En);function Hn(zn){var Ln;Kn(Ln=["next","throw","return"]).call(Ln,function(eo){Nr(zn,eo,function(co){return this._invoke(eo,co)})})}function ho(zn,Ln){function eo(So,Mo,ca,zo){var ss=jr(zn[So],zn,Mo);if(ss.type!=="throw"){var $o=ss.arg,Wo=$o.value;return Wo&&he(Wo)=="object"&&Pt.call(Wo,"__await")?Ln.resolve(Wo.__await).then(function(Ma){eo("next",Ma,ca,zo)},function(Ma){eo("throw",Ma,ca,zo)}):Ln.resolve(Wo).then(function(Ma){$o.value=Ma,ca($o)},function(Ma){return eo("throw",Ma,ca,zo)})}zo(ss.arg)}var co;this._invoke=function(So,Mo){function ca(){return new Ln(function(zo,ss){eo(So,Mo,zo,ss)})}return co=co?co.then(ca,ca):ca()}}function uo(zn,Ln){var eo=zn.iterator[Ln.method];if(eo===void 0){if(Ln.delegate=null,Ln.method==="throw"){if(zn.iterator.return&&(Ln.method="return",Ln.arg=void 0,uo(zn,Ln),Ln.method==="throw"))return Vr;Ln.method="throw",Ln.arg=new TypeError("The iterator does not provide a 'throw' method")}return Vr}var co=jr(eo,zn.iterator,Ln.arg);if(co.type==="throw")return Ln.method="throw",Ln.arg=co.arg,Ln.delegate=null,Vr;var So=co.arg;return So?So.done?(Ln[zn.resultName]=So.value,Ln.next=zn.nextLoc,Ln.method!=="return"&&(Ln.method="next",Ln.arg=void 0),Ln.delegate=null,Vr):So:(Ln.method="throw",Ln.arg=new TypeError("iterator result is not an object"),Ln.delegate=null,Vr)}function Do(zn){var Ln={tryLoc:zn[0]};1 in zn&&(Ln.catchLoc=zn[1]),2 in zn&&(Ln.finallyLoc=zn[2],Ln.afterLoc=zn[3]),this.tryEntries.push(Ln)}function no(zn){var Ln=zn.completion||{};Ln.type="normal",delete Ln.arg,zn.completion=Ln}function zr(zn){this.tryEntries=[{tryLoc:"root"}],Kn(zn).call(zn,Do,this),this.reset(!0)}function Jn(zn){if(zn){var Ln=zn[tr];if(Ln)return Ln.call(zn);if(typeof zn.next=="function")return zn;if(!isNaN(zn.length)){var eo=-1,co=function So(){for(;++eo<zn.length;)if(Pt.call(zn,eo))return So.value=zn[eo],So.done=!1,So;return So.value=void 0,So.done=!0,So};return co.next=co}}return{next:ro}}function ro(){return{value:void 0,done:!0}}return Tn.prototype=Mn,Nr(Pn,"constructor",Mn),Nr(Mn,"constructor",Tn),Tn.displayName=Nr(Mn,br,"GeneratorFunction"),Ue.isGeneratorFunction=function(zn){var Ln=typeof zn=="function"&&zn.constructor;return!!Ln&&(Ln===Tn||(Ln.displayName||Ln.name)==="GeneratorFunction")},Ue.mark=function(zn){return ri?ri(zn,Mn):(zn.__proto__=Mn,Nr(zn,br,"GeneratorFunction")),zn.prototype=vs(Pn),zn},Ue.awrap=function(zn){return{__await:zn}},Hn(ho.prototype),Nr(ho.prototype,fr,function(){return this}),Ue.AsyncIterator=ho,Ue.async=function(zn,Ln,eo,co,So){So===void 0&&(So=wo);var Mo=new ho(Fr(zn,Ln,eo,co),So);return Ue.isGeneratorFunction(Ln)?Mo:Mo.next().then(function(ca){return ca.done?ca.value:Mo.next()})},Hn(Pn),Nr(Pn,br,"Generator"),Nr(Pn,tr,function(){return this}),Nr(Pn,"toString",function(){return"[object Generator]"}),Ue.keys=function(zn){var Ln=[];for(var eo in zn)Ln.push(eo);return Kl(Ln).call(Ln),function co(){for(;Ln.length;){var So=Ln.pop();if(So in zn)return co.value=So,co.done=!1,co}return co.done=!0,co}},Ue.values=Jn,zr.prototype={constructor:zr,reset:function(Ln){var eo;if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,Kn(eo=this.tryEntries).call(eo,no),!Ln)for(var co in this)co.charAt(0)==="t"&&Pt.call(this,co)&&!isNaN(+Fo(co).call(co,1))&&(this[co]=void 0)},stop:function(){this.done=!0;var Ln=this.tryEntries[0].completion;if(Ln.type==="throw")throw Ln.arg;return this.rval},dispatchException:function(Ln){if(this.done)throw Ln;var eo=this;function co($o,Wo){return ca.type="throw",ca.arg=Ln,eo.next=$o,Wo&&(eo.method="next",eo.arg=void 0),!!Wo}for(var So=this.tryEntries.length-1;So>=0;--So){var Mo=this.tryEntries[So],ca=Mo.completion;if(Mo.tryLoc==="root")return co("end");if(Mo.tryLoc<=this.prev){var zo=Pt.call(Mo,"catchLoc"),ss=Pt.call(Mo,"finallyLoc");if(zo&&ss){if(this.prev<Mo.catchLoc)return co(Mo.catchLoc,!0);if(this.prev<Mo.finallyLoc)return co(Mo.finallyLoc)}else if(zo){if(this.prev<Mo.catchLoc)return co(Mo.catchLoc,!0)}else{if(!ss)throw new Error("try statement without catch or finally");if(this.prev<Mo.finallyLoc)return co(Mo.finallyLoc)}}}},abrupt:function(Ln,eo){for(var co=this.tryEntries.length-1;co>=0;--co){var So=this.tryEntries[co];if(So.tryLoc<=this.prev&&Pt.call(So,"finallyLoc")&&this.prev<So.finallyLoc){var Mo=So;break}}Mo&&(Ln==="break"||Ln==="continue")&&Mo.tryLoc<=eo&&eo<=Mo.finallyLoc&&(Mo=null);var ca=Mo?Mo.completion:{};return ca.type=Ln,ca.arg=eo,Mo?(this.method="next",this.next=Mo.finallyLoc,Vr):this.complete(ca)},complete:function(Ln,eo){if(Ln.type==="throw")throw Ln.arg;return Ln.type==="break"||Ln.type==="continue"?this.next=Ln.arg:Ln.type==="return"?(this.rval=this.arg=Ln.arg,this.method="return",this.next="end"):Ln.type==="normal"&&eo&&(this.next=eo),Vr},finish:function(Ln){for(var eo=this.tryEntries.length-1;eo>=0;--eo){var co=this.tryEntries[eo];if(co.finallyLoc===Ln)return this.complete(co.completion,co.afterLoc),no(co),Vr}},catch:function(Ln){for(var eo=this.tryEntries.length-1;eo>=0;--eo){var co=this.tryEntries[eo];if(co.tryLoc===Ln){var So=co.completion;if(So.type==="throw"){var Mo=So.arg;no(co)}return Mo}}throw new Error("illegal catch attempt")},delegateYield:function(Ln,eo,co){return this.delegate={iterator:Jn(Ln),resultName:eo,nextLoc:co},this.method==="next"&&(this.arg=void 0),Vr}},Ue}xe.exports=Fe,xe.exports.__esModule=!0,xe.exports.default=xe.exports}),wl=X1(),wr=wl;try{regeneratorRuntime=wl}catch{typeof globalThis=="object"?globalThis.regeneratorRuntime=wl:Function("r","regeneratorRuntime = r")(wl)}_n({target:"Number",stat:!0,nonConfigurable:!0,nonWritable:!0},{MAX_SAFE_INTEGER:9007199254740991});var Cg=9007199254740991,Ql=V(function(){Bs(1)});_n({target:"Object",stat:!0,forced:Ql},{keys:function(he){return Bs(An(he))}});var aa=kr.Object.keys,Jl=Object.assign,kg=Object.defineProperty,jn=Ne([].concat),Yl=!Jl||V(function(){if($e&&Jl({b:1},Jl(kg({},"a",{enumerable:!0,get:function(){kg(this,"b",{value:3,enumerable:!1})}}),{b:2})).b!==1)return!0;var xe={},he={},Fe=Symbol(),Ue="abcdefghijklmnopqrst";return xe[Fe]=7,Ue.split("").forEach(function(Ce){he[Ce]=Ce}),Jl({},xe)[Fe]!=7||Bs(Jl({},he)).join("")!=Ue})?function(he,Fe){for(var Ue=An(he),Ce=arguments.length,Pt=1,ar=pc.f,tr=dr.f;Ce>Pt;)for(var fr,br=hr(arguments[Pt++]),Nr=ar?jn(Bs(br),ar(br)):Bs(br),Fr=Nr.length,jr=0;Fr>jr;)fr=Nr[jr++],$e&&!jt(tr,br,fr)||(Ue[fr]=br[fr]);return Ue}:Jl;_n({target:"Object",stat:!0,arity:2,forced:Object.assign!==Yl},{assign:Yl});var Hr=kr.Object.assign;kr.JSON||(kr.JSON={stringify:JSON.stringify});var yv=function(he,Fe,Ue){return le(kr.JSON.stringify,null,arguments)},la=yv,wg=Eu.indexOf,xg=Ne([].indexOf),_g=!!xg&&1/xg([1],1,-0)<0,Z1=li("indexOf");_n({target:"Array",proto:!0,forced:_g||!Z1},{indexOf:function(he){var Fe=arguments.length>1?arguments[1]:void 0;return _g?xg(this,he,Fe)||0:wg(this,he,Fe)}});var eT=na("Array").indexOf,Ig=Array.prototype,Va=function(xe){var he=xe.indexOf;return xe===Ig||vr(Ig,xe)&&he===Ig.indexOf?eT:he},bv=na("Array").concat,Sp=Array.prototype,Hs=function(xe){var he=xe.concat;return xe===Sp||vr(Sp,xe)&&he===Sp.concat?bv:he};function Ys(xe,he){var Fe={};for(var Ue in xe)Object.prototype.hasOwnProperty.call(xe,Ue)&&he.indexOf(Ue)<0&&(Fe[Ue]=xe[Ue]);if(xe!=null&&typeof Object.getOwnPropertySymbols=="function"){var Ce=0;for(Ue=Object.getOwnPropertySymbols(xe);Ce<Ue.length;Ce++)he.indexOf(Ue[Ce])<0&&Object.prototype.propertyIsEnumerable.call(xe,Ue[Ce])&&(Fe[Ue[Ce]]=xe[Ue[Ce]])}return Fe}function Un(xe,he,Fe,Ue){return new(Fe||(Fe=Promise))(function(Ce,Pt){function ar(br){try{fr(Ue.next(br))}catch(Nr){Pt(Nr)}}function tr(br){try{fr(Ue.throw(br))}catch(Nr){Pt(Nr)}}function fr(br){br.done?Ce(br.value):function(Fr){return Fr instanceof Fe?Fr:new Fe(function(jr){jr(Fr)})}(br.value).then(ar,tr)}fr((Ue=Ue.apply(xe,he||[])).next())})}var Mp=V(function(){if(typeof ArrayBuffer=="function"){var xe=new ArrayBuffer(8);Object.isExtensible(xe)&&Object.defineProperty(xe,"a",{value:8})}}),Pd=Object.isExtensible,Eg=V(function(){Pd(1)})||Mp?function(he){return!!rr(he)&&(!Mp||er(he)!="ArrayBuffer")&&(!Pd||Pd(he))}:Pd,Tv=!V(function(){return Object.isExtensible(Object.preventExtensions({}))}),Pg=g(function(xe){var he=Pa.f,Fe=!1,Ue=Uo("meta"),Ce=0,Pt=function(tr){he(tr,Ue,{value:{objectID:"O"+Ce++,weakData:{}}})},ar=xe.exports={enable:function(){ar.enable=function(){},Fe=!0;var tr=dc.f,fr=Ne([].splice),br={};br[Ue]=1,tr(br).length&&(dc.f=function(Nr){for(var Fr=tr(Nr),jr=0,Vr=Fr.length;jr<Vr;jr++)if(Fr[jr]===Ue){fr(Fr,jr,1);break}return Fr},_n({target:"Object",stat:!0,forced:!0},{getOwnPropertyNames:Uu.f}))},fastKey:function(tr,fr){if(!rr(tr))return typeof tr=="symbol"?tr:(typeof tr=="string"?"S":"P")+tr;if(!hn(tr,Ue)){if(!Eg(tr))return"F";if(!fr)return"E";Pt(tr)}return tr[Ue].objectID},getWeakData:function(tr,fr){if(!hn(tr,Ue)){if(!Eg(tr))return!0;if(!fr)return!1;Pt(tr)}return tr[Ue].weakData},onFreeze:function(tr){return Tv&&Fe&&Eg(tr)&&!hn(tr,Ue)&&Pt(tr),tr}};_i[Ue]=!0}),Sv=Pa.f,Mv=js.forEach,Ki=Ja.set,tT=Ja.getterFor,Cv=function(xe,he,Fe){for(var Ue in he)Fe&&Fe.unsafe&&xe[Ue]?xe[Ue]=he[Ue]:$s(xe,Ue,he[Ue],Fe);return xe},rT=Pa.f,kv=Pg.fastKey,Ag=Ja.set,xl=Ja.getterFor,wv={getConstructor:function(xe,he,Fe,Ue){var Ce=xe(function(br,Nr){id(br,Pt),Ag(br,{type:he,index:Qa(null),first:void 0,last:void 0,size:0}),$e||(br.size=0),pr(Nr)||ko(Nr,br[Ue],{that:br,AS_ENTRIES:Fe})}),Pt=Ce.prototype,ar=xl(he),tr=function(br,Nr,Fr){var jr,Vr,Kr=ar(br),Tn=fr(br,Nr);return Tn?Tn.value=Fr:(Kr.last=Tn={index:Vr=kv(Nr,!0),key:Nr,value:Fr,previous:jr=Kr.last,next:void 0,removed:!1},Kr.first||(Kr.first=Tn),jr&&(jr.next=Tn),$e?Kr.size++:br.size++,Vr!=="F"&&(Kr.index[Vr]=Tn)),br},fr=function(br,Nr){var Fr,jr=ar(br),Vr=kv(Nr);if(Vr!=="F")return jr.index[Vr];for(Fr=jr.first;Fr;Fr=Fr.next)if(Fr.key==Nr)return Fr};return Cv(Pt,{clear:function(){for(var Nr=ar(this),Fr=Nr.index,jr=Nr.first;jr;)jr.removed=!0,jr.previous&&(jr.previous=jr.previous.next=void 0),delete Fr[jr.index],jr=jr.next;Nr.first=Nr.last=void 0,$e?Nr.size=0:this.size=0},delete:function(br){var Nr=this,Fr=ar(Nr),jr=fr(Nr,br);if(jr){var Vr=jr.next,Kr=jr.previous;delete Fr.index[jr.index],jr.removed=!0,Kr&&(Kr.next=Vr),Vr&&(Vr.previous=Kr),Fr.first==jr&&(Fr.first=Vr),Fr.last==jr&&(Fr.last=Kr),$e?Fr.size--:Nr.size--}return!!jr},forEach:function(Nr){for(var Fr,jr=ar(this),Vr=Zo(Nr,arguments.length>1?arguments[1]:void 0);Fr=Fr?Fr.next:jr.first;)for(Vr(Fr.value,Fr.key,this);Fr&&Fr.removed;)Fr=Fr.previous},has:function(Nr){return!!fr(this,Nr)}}),Cv(Pt,Fe?{get:function(Nr){var Fr=fr(this,Nr);return Fr&&Fr.value},set:function(Nr,Fr){return tr(this,Nr===0?0:Nr,Fr)}}:{add:function(Nr){return tr(this,Nr=Nr===0?0:Nr,Nr)}}),$e&&rT(Pt,"size",{get:function(){return ar(this).size}}),Ce},setStrong:function(xe,he,Fe){var Ue=he+" Iterator",Ce=xl(he),Pt=xl(Ue);ed(xe,he,function(ar,tr){Ag(this,{type:Ue,target:ar,state:Ce(ar),kind:tr,last:void 0})},function(){for(var ar=Pt(this),tr=ar.kind,fr=ar.last;fr&&fr.removed;)fr=fr.previous;return ar.target&&(ar.last=fr=fr?fr.next:ar.state.first)?tr=="keys"?{value:fr.key,done:!1}:tr=="values"?{value:fr.value,done:!1}:{value:[fr.key,fr.value],done:!1}:(ar.target=void 0,{value:void 0,done:!0})},Fe?"entries":"values",!Fe,!0),qm(he)}};(function(xe,he,Fe){var Ue,Ce=xe.indexOf("Map")!==-1,Pt=xe.indexOf("Weak")!==-1,ar=Ce?"set":"add",tr=L[xe],fr=tr&&tr.prototype,br={};if($e&&ze(tr)&&(Pt||fr.forEach&&!V(function(){new tr().entries().next()}))){var Nr=(Ue=he(function(jr,Vr){Ki(id(jr,Nr),{type:xe,collection:new tr}),Vr!=null&&ko(Vr,jr[ar],{that:jr,AS_ENTRIES:Ce})})).prototype,Fr=tT(xe);Mv(["add","clear","delete","forEach","get","has","set","keys","values","entries"],function(jr){var Vr=jr=="add"||jr=="set";!(jr in fr)||Pt&&jr=="clear"||fa(Nr,jr,function(Kr,Tn){var Mn=Fr(this).collection;if(!Vr&&Pt&&!rr(Kr))return jr=="get"&&void 0;var En=Mn[jr](Kr===0?0:Kr,Tn);return Vr?this:En})}),Pt||Sv(Nr,"size",{configurable:!0,get:function(){return Fr(this).collection.size}})}else Ue=Fe.getConstructor(he,xe,Ce,ar),Pg.enable();ai(Ue,xe,!1,!0),br[xe]=Ue,_n({global:!0,forced:!0},br),Pt||Fe.setStrong(Ue,xe,Ce)})("Map",function(xe){return function(){return xe(this,arguments.length?arguments[0]:void 0)}},wv);var nT=kr.Map,Ms=[].push;_n({target:"Map",stat:!0,forced:!0},{from:function(he){var Fe,Ue,Ce,Pt,ar=arguments.length,tr=ar>1?arguments[1]:void 0;return Ml(this),(Fe=tr!==void 0)&&Xr(tr),pr(he)?new this:(Ue=[],Fe?(Ce=0,Pt=Zo(tr,ar>2?arguments[2]:void 0),ko(he,function(fr){jt(Ms,Ue,Pt(fr,Ce++))})):ko(he,Ms,{that:Ue}),new this(Ue))}}),_n({target:"Map",stat:!0,forced:!0},{of:function(){return new this(Fs(arguments))}}),_n({target:"Map",proto:!0,real:!0,forced:!0},{deleteAll:function(){for(var he,Fe=lo(this),Ue=Xr(Fe.delete),Ce=!0,Pt=0,ar=arguments.length;Pt<ar;Pt++)he=jt(Ue,Fe,arguments[Pt]),Ce=Ce&&he;return!!Ce}}),_n({target:"Map",proto:!0,real:!0,forced:!0},{emplace:function(he,Fe){var Ue,Ce,Pt=lo(this),ar=Xr(Pt.get),tr=Xr(Pt.has),fr=Xr(Pt.set);return jt(tr,Pt,he)?(Ue=jt(ar,Pt,he),"update"in Fe&&(Ue=Fe.update(Ue,he,Pt),jt(fr,Pt,he,Ue)),Ue):(Ce=Fe.insert(he,Pt),jt(fr,Pt,he,Ce),Ce)}});var Qi=hc;_n({target:"Map",proto:!0,real:!0,forced:!0},{every:function(he){var Fe=lo(this),Ue=Qi(Fe),Ce=Zo(he,arguments.length>1?arguments[1]:void 0);return!ko(Ue,function(Pt,ar,tr){if(!Ce(ar,Pt,Fe))return tr()},{AS_ENTRIES:!0,IS_ITERATOR:!0,INTERRUPTED:!0}).stopped}}),_n({target:"Map",proto:!0,real:!0,forced:!0},{filter:function(he){var Fe=lo(this),Ue=Qi(Fe),Ce=Zo(he,arguments.length>1?arguments[1]:void 0),Pt=new(Vs(Fe,xr("Map"))),ar=Xr(Pt.set);return ko(Ue,function(tr,fr){Ce(fr,tr,Fe)&&jt(ar,Pt,tr,fr)},{AS_ENTRIES:!0,IS_ITERATOR:!0}),Pt}}),_n({target:"Map",proto:!0,real:!0,forced:!0},{find:function(he){var Fe=lo(this),Ue=Qi(Fe),Ce=Zo(he,arguments.length>1?arguments[1]:void 0);return ko(Ue,function(Pt,ar,tr){if(Ce(ar,Pt,Fe))return tr(ar)},{AS_ENTRIES:!0,IS_ITERATOR:!0,INTERRUPTED:!0}).result}}),_n({target:"Map",proto:!0,real:!0,forced:!0},{findKey:function(he){var Fe=lo(this),Ue=Qi(Fe),Ce=Zo(he,arguments.length>1?arguments[1]:void 0);return ko(Ue,function(Pt,ar,tr){if(Ce(ar,Pt,Fe))return tr(Pt)},{AS_ENTRIES:!0,IS_ITERATOR:!0,INTERRUPTED:!0}).result}});var Ng=Ne([].push);_n({target:"Map",stat:!0,forced:!0},{groupBy:function(he,Fe){Xr(Fe);var Ue=hc(he),Ce=new this,Pt=Xr(Ce.has),ar=Xr(Ce.get),tr=Xr(Ce.set);return ko(Ue,function(fr){var br=Fe(fr);jt(Pt,Ce,br)?Ng(jt(ar,Ce,br),fr):jt(tr,Ce,br,[fr])},{IS_ITERATOR:!0}),Ce}}),_n({target:"Map",proto:!0,real:!0,forced:!0},{includes:function(he){return ko(Qi(lo(this)),function(Fe,Ue,Ce){if((Pt=Ue)===(ar=he)||Pt!=Pt&&ar!=ar)return Ce();var Pt,ar},{AS_ENTRIES:!0,IS_ITERATOR:!0,INTERRUPTED:!0}).stopped}}),_n({target:"Map",stat:!0,forced:!0},{keyBy:function(he,Fe){var Ue=new this;Xr(Fe);var Ce=Xr(Ue.set);return ko(he,function(Pt){jt(Ce,Ue,Fe(Pt),Pt)}),Ue}}),_n({target:"Map",proto:!0,real:!0,forced:!0},{keyOf:function(he){return ko(Qi(lo(this)),function(Fe,Ue,Ce){if(Ue===he)return Ce(Fe)},{AS_ENTRIES:!0,IS_ITERATOR:!0,INTERRUPTED:!0}).result}}),_n({target:"Map",proto:!0,real:!0,forced:!0},{mapKeys:function(he){var Fe=lo(this),Ue=Qi(Fe),Ce=Zo(he,arguments.length>1?arguments[1]:void 0),Pt=new(Vs(Fe,xr("Map"))),ar=Xr(Pt.set);return ko(Ue,function(tr,fr){jt(ar,Pt,Ce(fr,tr,Fe),fr)},{AS_ENTRIES:!0,IS_ITERATOR:!0}),Pt}}),_n({target:"Map",proto:!0,real:!0,forced:!0},{mapValues:function(he){var Fe=lo(this),Ue=Qi(Fe),Ce=Zo(he,arguments.length>1?arguments[1]:void 0),Pt=new(Vs(Fe,xr("Map"))),ar=Xr(Pt.set);return ko(Ue,function(tr,fr){jt(ar,Pt,tr,Ce(fr,tr,Fe))},{AS_ENTRIES:!0,IS_ITERATOR:!0}),Pt}}),_n({target:"Map",proto:!0,real:!0,arity:1,forced:!0},{merge:function(he){for(var Fe=lo(this),Ue=Xr(Fe.set),Ce=arguments.length,Pt=0;Pt<Ce;)ko(arguments[Pt++],Ue,{that:Fe,AS_ENTRIES:!0});return Fe}});var di=TypeError;_n({target:"Map",proto:!0,real:!0,forced:!0},{reduce:function(he){var Fe=lo(this),Ue=Qi(Fe),Ce=arguments.length<2,Pt=Ce?void 0:arguments[1];if(Xr(he),ko(Ue,function(ar,tr){Ce?(Ce=!1,Pt=tr):Pt=he(Pt,tr,ar,Fe)},{AS_ENTRIES:!0,IS_ITERATOR:!0}),Ce)throw di("Reduce of empty map with no initial value");return Pt}}),_n({target:"Map",proto:!0,real:!0,forced:!0},{some:function(he){var Fe=lo(this),Ue=Qi(Fe),Ce=Zo(he,arguments.length>1?arguments[1]:void 0);return ko(Ue,function(Pt,ar,tr){if(Ce(ar,Pt,Fe))return tr()},{AS_ENTRIES:!0,IS_ITERATOR:!0,INTERRUPTED:!0}).stopped}});var oT=TypeError;_n({target:"Map",proto:!0,real:!0,forced:!0},{update:function(he,Fe){var Ue=lo(this),Ce=Xr(Ue.get),Pt=Xr(Ue.has),ar=Xr(Ue.set),tr=arguments.length;Xr(Fe);var fr=jt(Pt,Ue,he);if(!fr&&tr<3)throw oT("Updating absent value");var br=fr?jt(Ce,Ue,he):Xr(tr>2?arguments[2]:void 0)(he,Ue);return jt(ar,Ue,he,Fe(br,he,Ue)),Ue}});var aT=TypeError,Og=function(he,Fe){var Ue,Ce=lo(this),Pt=Xr(Ce.get),ar=Xr(Ce.has),tr=Xr(Ce.set),fr=arguments.length>2?arguments[2]:void 0;if(!ze(Fe)&&!ze(fr))throw aT("At least one callback required");return jt(ar,Ce,he)?(Ue=jt(Pt,Ce,he),ze(Fe)&&(Ue=Fe(Ue),jt(tr,Ce,he,Ue))):ze(fr)&&(Ue=fr(),jt(tr,Ce,he,Ue)),Ue};_n({target:"Map",proto:!0,real:!0,forced:!0},{upsert:Og}),_n({target:"Map",proto:!0,real:!0,name:"upsert",forced:!0},{updateOrInsert:Og});var Cc=nT,Rg=Date,xv=Ne(Rg.prototype.getTime);_n({target:"Date",stat:!0},{now:function(){return xv(new Rg)}});var wa=kr.Date.now,sT=/MSIE .\./.test(_r),Eo=L.Function,_v=function(xe){return sT?function(he,Fe){var Ue=Vm(arguments.length,1)>2,Ce=ze(he)?he:Eo(he),Pt=Ue?Fs(arguments,2):void 0;return xe(Ue?function(){le(Ce,this,Pt)}:Ce,Fe)}:xe},Iv={setTimeout:_v(L.setTimeout),setInterval:_v(L.setInterval)},Ev=Iv.setInterval;_n({global:!0,bind:!0,forced:L.setInterval!==Ev},{setInterval:Ev});var Cp=Iv.setTimeout;_n({global:!0,bind:!0,forced:L.setTimeout!==Cp},{setTimeout:Cp});var Ao=kr.setTimeout,Bg=js.map,iT=lc("map");_n({target:"Array",proto:!0,forced:!iT},{map:function(he){return Bg(this,he,arguments.length>1?arguments[1]:void 0)}});var Xl=na("Array").map,kp=Array.prototype,Ro=function(xe){var he=xe.map;return xe===kp||vr(kp,xe)&&he===kp.map?Xl:he},pi=g(function(xe){var he=Object.prototype.hasOwnProperty,Fe="~";function Ue(){}function Ce(fr,br,Nr){this.fn=fr,this.context=br,this.once=Nr||!1}function Pt(fr,br,Nr,Fr,jr){if(typeof Nr!="function")throw new TypeError("The listener must be a function");var Vr=new Ce(Nr,Fr||fr,jr),Kr=Fe?Fe+br:br;return fr._events[Kr]?fr._events[Kr].fn?fr._events[Kr]=[fr._events[Kr],Vr]:fr._events[Kr].push(Vr):(fr._events[Kr]=Vr,fr._eventsCount++),fr}function ar(fr,br){--fr._eventsCount==0?fr._events=new Ue:delete fr._events[br]}function tr(){this._events=new Ue,this._eventsCount=0}Object.create&&(Ue.prototype=Object.create(null),new Ue().__proto__||(Fe=!1)),tr.prototype.eventNames=function(){var br,Nr,Fr=[];if(this._eventsCount===0)return Fr;for(Nr in br=this._events)he.call(br,Nr)&&Fr.push(Fe?Nr.slice(1):Nr);return Object.getOwnPropertySymbols?Fr.concat(Object.getOwnPropertySymbols(br)):Fr},tr.prototype.listeners=function(br){var Nr=Fe?Fe+br:br,Fr=this._events[Nr];if(!Fr)return[];if(Fr.fn)return[Fr.fn];for(var jr=0,Vr=Fr.length,Kr=new Array(Vr);jr<Vr;jr++)Kr[jr]=Fr[jr].fn;return Kr},tr.prototype.listenerCount=function(br){var Nr=Fe?Fe+br:br,Fr=this._events[Nr];return Fr?Fr.fn?1:Fr.length:0},tr.prototype.emit=function(br,Nr,Fr,jr,Vr,Kr){var Tn=Fe?Fe+br:br;if(!this._events[Tn])return!1;var Mn,En,In=this._events[Tn],Pn=arguments.length;if(In.fn){switch(In.once&&this.removeListener(br,In.fn,void 0,!0),Pn){case 1:return In.fn.call(In.context),!0;case 2:return In.fn.call(In.context,Nr),!0;case 3:return In.fn.call(In.context,Nr,Fr),!0;case 4:return In.fn.call(In.context,Nr,Fr,jr),!0;case 5:return In.fn.call(In.context,Nr,Fr,jr,Vr),!0;case 6:return In.fn.call(In.context,Nr,Fr,jr,Vr,Kr),!0}for(En=1,Mn=new Array(Pn-1);En<Pn;En++)Mn[En-1]=arguments[En];In.fn.apply(In.context,Mn)}else{var Hn,ho=In.length;for(En=0;En<ho;En++)switch(In[En].once&&this.removeListener(br,In[En].fn,void 0,!0),Pn){case 1:In[En].fn.call(In[En].context);break;case 2:In[En].fn.call(In[En].context,Nr);break;case 3:In[En].fn.call(In[En].context,Nr,Fr);break;case 4:In[En].fn.call(In[En].context,Nr,Fr,jr);break;default:if(!Mn)for(Hn=1,Mn=new Array(Pn-1);Hn<Pn;Hn++)Mn[Hn-1]=arguments[Hn];In[En].fn.apply(In[En].context,Mn)}}return!0},tr.prototype.on=function(br,Nr,Fr){return Pt(this,br,Nr,Fr,!1)},tr.prototype.once=function(br,Nr,Fr){return Pt(this,br,Nr,Fr,!0)},tr.prototype.removeListener=function(br,Nr,Fr,jr){var Vr=Fe?Fe+br:br;if(!this._events[Vr])return this;if(!Nr)return ar(this,Vr),this;var Kr=this._events[Vr];if(Kr.fn)Kr.fn!==Nr||jr&&!Kr.once||Fr&&Kr.context!==Fr||ar(this,Vr);else{for(var Tn=0,Mn=[],En=Kr.length;Tn<En;Tn++)(Kr[Tn].fn!==Nr||jr&&!Kr[Tn].once||Fr&&Kr[Tn].context!==Fr)&&Mn.push(Kr[Tn]);Mn.length?this._events[Vr]=Mn.length===1?Mn[0]:Mn:ar(this,Vr)}return this},tr.prototype.removeAllListeners=function(br){var Nr;return br?(Nr=Fe?Fe+br:br,this._events[Nr]&&ar(this,Nr)):(this._events=new Ue,this._eventsCount=0),this},tr.prototype.off=tr.prototype.removeListener,tr.prototype.addListener=tr.prototype.on,tr.prefixed=Fe,tr.EventEmitter=tr,xe.exports=tr}),Ji=_l;function _l(xe){xe=xe||{},this.ms=xe.min||100,this.max=xe.max||1e4,this.factor=xe.factor||2,this.jitter=xe.jitter>0&&xe.jitter<=1?xe.jitter:0,this.attempts=0}_l.prototype.duration=function(){var xe=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var he=Math.random(),Fe=Math.floor(he*this.jitter*xe);xe=1&Math.floor(10*he)?xe+Fe:xe-Fe}return 0|Math.min(xe,this.max)},_l.prototype.reset=function(){this.attempts=0},_l.prototype.setMin=function(xe){this.ms=xe},_l.prototype.setMax=function(xe){this.max=xe},_l.prototype.setJitter=function(xe){this.jitter=xe};var Pv=typeof e=="object"&&e&&e.Object===Object&&e,cT=typeof self=="object"&&self&&self.Object===Object&&self,Xs=Pv||cT||Function("return this")(),vi=Xs.Symbol,Av=Object.prototype,lT=Av.hasOwnProperty,Nv=Av.toString,yi=vi?vi.toStringTag:void 0,Fi=function(he){var Fe=lT.call(he,yi),Ue=he[yi];try{he[yi]=void 0;var Ce=!0}catch{}var Pt=Nv.call(he);return Ce&&(Fe?he[yi]=Ue:delete he[yi]),Pt},wp=Object.prototype.toString,Ov=function(he){return wp.call(he)},Rv=vi?vi.toStringTag:void 0,Uc=function(he){return he==null?he===void 0?"[object Undefined]":"[object Null]":Rv&&Rv in Object(he)?Fi(he):Ov(he)},$i=function(he){var Fe=typeof he;return he!=null&&(Fe=="object"||Fe=="function")},xp=function(he){if(!$i(he))return!1;var Fe=Uc(he);return Fe=="[object Function]"||Fe=="[object GeneratorFunction]"||Fe=="[object AsyncFunction]"||Fe=="[object Proxy]"},Bv={deviceId:"",timeout:8e3},uT={account:"",appkey:"",token:"",debugLevel:"off",needReconnect:!0,reconnectionAttempts:Cg,isAbtestEnable:!0,abtestUrl:"https://abt-online.netease.im/v1/api/abt/client/getExperimentInfo",abtestProjectKey:"imElite_sdk_abtest_web"},Fv="weblink.netease.im:443",dT=Eu.includes,pT=V(function(){return!Array(1).includes()});_n({target:"Array",proto:!0,forced:pT},{includes:function(he){return dT(this,he,arguments.length>1?arguments[1]:void 0)}});var fT=na("Array").includes,Fg=To("match"),$g=TypeError,Li=function(xe){if(function(he){var Fe;return rr(he)&&((Fe=he[Fg])!==void 0?!!Fe:er(he)=="RegExp")}(xe))throw $g("The method doesn't accept regular expressions");return xe},mT=To("match"),gT=Ne("".indexOf);_n({target:"String",proto:!0,forced:!function(xe){var he=/./;try{"/./"[xe](he)}catch{try{return he[mT]=!1,"/./"[xe](he)}catch{}}return!1}("includes")},{includes:function(he){return!!~gT(Za(Er(this)),Za(Li(he)),arguments.length>1?arguments[1]:void 0)}});var $v=na("String").includes,Lg=Array.prototype,Ad=String.prototype,qc=function(xe){var he=xe.includes;return xe===Lg||vr(Lg,xe)&&he===Lg.includes?fT:typeof xe=="string"||xe===Ad||vr(Ad,xe)&&he===Ad.includes?$v:he},hT=js.findIndex,vT="findIndex",_p=!0;vT in[]&&Array(1).findIndex(function(){_p=!1}),_n({target:"Array",proto:!0,forced:_p},{findIndex:function(he){return hT(this,he,arguments.length>1?arguments[1]:void 0)}});var Lv=na("Array").findIndex,jg=Array.prototype,yT=function(xe){var he=xe.findIndex;return xe===jg||vr(jg,xe)&&he===jg.findIndex?Lv:he},Dg=g(function(xe){function he(Fe){var Ue;return xe.exports=he=ri?Go(Ue=ci).call(Ue):function(Pt){return Pt.__proto__||ci(Pt)},xe.exports.__esModule=!0,xe.exports.default=xe.exports,he(Fe)}xe.exports=he,xe.exports.__esModule=!0,xe.exports.default=xe.exports}),Na=g(function(xe){xe.exports=function(Fe){var Ue;return Va(Ue=Function.toString.call(Fe)).call(Ue,"[native code]")!==-1},xe.exports.__esModule=!0,xe.exports.default=xe.exports}),Ug=xr("Reflect","construct"),qg=Object.prototype,bT=[].push,jv=V(function(){function xe(){}return!(Ug(function(){},[],xe)instanceof xe)}),Vg=!V(function(){Ug(function(){})}),Hg=jv||Vg;_n({target:"Reflect",stat:!0,forced:Hg,sham:Hg},{construct:function(he,Fe){Ml(he),lo(Fe);var Ue=arguments.length<3?he:Ml(arguments[2]);if(Vg&&!jv)return Ug(he,Fe,Ue);if(he==Ue){switch(Fe.length){case 0:return new he;case 1:return new he(Fe[0]);case 2:return new he(Fe[0],Fe[1]);case 3:return new he(Fe[0],Fe[1],Fe[2]);case 4:return new he(Fe[0],Fe[1],Fe[2],Fe[3])}var Ce=[null];return le(bT,Ce,Fe),new(le(Ou,he,Ce))}var Pt=Ue.prototype,ar=Qa(rr(Pt)?Pt:qg),tr=le(he,ar,Fe);return rr(tr)?tr:ar}});var Yi=kr.Reflect.construct,kc=g(function(xe){xe.exports=function(){if(typeof Reflect>"u"||!Yi||Yi.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Yi(Boolean,[],function(){})),!0}catch{return!1}},xe.exports.__esModule=!0,xe.exports.default=xe.exports}),TT=g(function(xe){function he(Fe,Ue,Ce){var Pt;return kc()?(xe.exports=he=Go(Pt=Yi).call(Pt),xe.exports.__esModule=!0,xe.exports.default=xe.exports):(xe.exports=he=function(tr,fr,br){var Nr=[null];Nr.push.apply(Nr,fr);var Fr=new(Go(Function).apply(tr,Nr));return br&&Bu(Fr,br.prototype),Fr},xe.exports.__esModule=!0,xe.exports.default=xe.exports),he.apply(null,arguments)}xe.exports=he,xe.exports.__esModule=!0,xe.exports.default=xe.exports}),ST=g(function(xe){function he(Fe){var Ue=typeof Cc=="function"?new Cc:void 0;return xe.exports=he=function(Pt){if(Pt===null||!Na(Pt))return Pt;if(typeof Pt!="function")throw new TypeError("Super expression must either be null or a function");if(Ue!==void 0){if(Ue.has(Pt))return Ue.get(Pt);Ue.set(Pt,ar)}function ar(){return TT(Pt,arguments,Dg(this).constructor)}return ar.prototype=vs(Pt.prototype,{constructor:{value:ar,enumerable:!1,writable:!0,configurable:!0}}),Bu(ar,Pt)},xe.exports.__esModule=!0,xe.exports.default=xe.exports,he(Fe)}xe.exports=he,xe.exports.__esModule=!0,xe.exports.default=xe.exports}),wc=function(xe){function he(Fe,Ue,Ce){var Pt;return Ue===void 0&&(Ue={}),Ce===void 0&&(Ce=400),(Pt=xe.call(this,Fe)||this).data=Ue,Pt.code=Ce,Pt.name="customError",Pt}return Ko(he,xe),he}(n(ST)(Error)),No=function(xe){function he(Fe,Ue,Ce){var Pt;return Ue===void 0&&(Ue={}),(Pt=xe.call(this,Fe,Ue,414)||this).code=414,Pt.name="validateError",Pt.rules=Ce,Pt}return Ko(he,xe),he}(wc),Il={200:null,406:null,808:null,810:null,201:"The client version is incorrect. You need to upgrade the SDK",302:"The user name or password is incorrect. Please check whether the appkey and token are valid and whether the account and token match",403:"Illegal operation or no permission",404:"Target object does not exist",405:"Parameter length too long",408:"Client request timed out",414:"Request parameter error",415:"Service unavailable",416:"Frequency control",417:"Repeat operation",422:"Account disabled",500:"Server internal error",503:"Server busy",508:"Expiration date",509:"Invalid",7101:"Be pulled black",700:"Partial failure of batch operation",801:"The number of people in the team has reached the upper limit",802:"No permission",803:"The team does not exist or has not changed",804:"The user is not in the team",805:"Team type mismatch",806:"The number of teams created has reached the limit",807:"Team member not valid",809:"Already in the team",811:"The number of accounts in the forced push list exceeds the limit",812:"The team is muted",813:"Due to the limited number of team, some pull people successfully",814:"Disable team message read service",815:"Maximum number of team administrators",816:"Batch operation partial failure",997:"The packet has expired",998:"Deserialize packet error",999:"Serialize packet error",9102:"Channel failure",9103:"This call has been answered / rejected at another end",10201:"Signaling: target NIM client is offline",10202:"Signaling: push is unreachable",10404:"Signaling: channel not exists",10405:"Signaling: channel already exists",10406:"Signaling: member of channel not exists",10407:"Signaling: member of channel already exists",10408:"Signaling: the invitation request does not exist or has expired",10409:"Signaling: the invitation request has been rejected",10410:"Signaling: the invitation request has been accepted",10414:"Signaling: request parameter error",10417:"Signaling: uid conflict",10419:"Signaling: the number of members of channel exceed the limit",10420:"Signaling: member is already in the channel on other client",10700:"Signaling: phased success",13002:"Abnormal chatroom status",13003:"In the blacklist",13004:"In the mute list",13006:"All members are muted, and only the administrator can speak"},Ip=function(xe){function he(Fe,Ue,Ce,Pt,ar){var tr;return Ce===void 0&&(Ce=""),Pt===void 0&&(Pt=new Date().getTime()),ar===void 0&&(ar={}),Ce=Ce||Il[Fe],(tr=xe.call(this,Ce,ar,Fe)||this).name="cmdError",tr.cmd=Ue,tr.timetag=Pt,tr}return Ko(he,xe),he}(wc),zg=function(xe){function he(Fe,Ue,Ce){var Pt;return(Pt=xe.call(this,Fe,{},412)||this).code=412,Pt.name="formatError",Pt.key=Ue,Pt.reason=Ce,Pt}return Ko(he,xe),he}(wc),Zl=function(xe){function he(Fe,Ue,Ce,Pt,ar){var tr;return(tr=xe.call(this,Fe,{file:ar},400)||this).name="uploadError",tr.rawError=Ue,tr.curProvider=Ce||1,tr.mixStorePolicy=Pt,tr}return Ko(he,xe),he}(wc),Vc=["error","warn","log","debug"],El=function(){},Nd=["off","error","warn","log","debug"],Ep=function(){function xe(Fe,Ue){this.name=Ue,this.strategies={debug:console.log,log:console.log,warn:console.warn,error:console.error},this.debug=El,this.log=El,this.warn=El,this.error=El,this.name=Ue,xe.instancesName.push(Ue),qc(Nd).call(Nd,Fe)||(Fe="off"),this.setLogFunc(Fe)}var he=xe.prototype;return he.setLogFunc=function(Ue){var Ce=this,Pt=yT(Vc).call(Vc,function(ar){return ar===Ue});Kn(Vc).call(Vc,function(ar,tr){tr<=Pt&&(Ce[ar]=function(){var fr=Fo(Array.prototype).call(arguments),br=this.formatArgs(fr,ar);this.strategies[ar](br)})})},he.formatArgs=function(Ue,Ce){var Pt=new Date,ar=Pt.getMonth()+1+"-"+Pt.getDate()+" "+Pt.getHours()+":"+Pt.getMinutes()+":"+Pt.getSeconds()+":"+Pt.getMilliseconds();return"[NIM "+Ce+" "+this.name+" "+ar+"] "+Ro(Ue).call(Ue,function(tr){return tr instanceof wc?tr.name+", "+tr.code+", "+tr.message:tr instanceof Error?tr&&tr.message?tr.message:tr:typeof tr=="object"?la(tr):tr}).join(" ")},xe}();Ep.instancesName=[],_n({global:!0},{globalThis:L});var Dv=js.filter,MT=lc("filter");_n({target:"Array",proto:!0,forced:!MT},{filter:function(he){return Dv(this,he,arguments.length>1?arguments[1]:void 0)}});var Sa=na("Array").filter,Wg=Array.prototype,Is=function(xe){var he=xe.filter;return xe===Wg||vr(Wg,xe)&&he===Wg.filter?Sa:he},CT=g(function(xe,he){xe.exports=function(){function Fe(br,Nr){if(!(br instanceof Nr))throw new TypeError("Cannot call a class as a function")}function Ue(br,Nr){for(var Fr=0;Fr<Nr.length;Fr++){var jr=Nr[Fr];jr.enumerable=jr.enumerable||!1,jr.configurable=!0,"value"in jr&&(jr.writable=!0),gc(br,jr.key,jr)}}function Ce(br,Nr,Fr){return Nr&&Ue(br.prototype,Nr),Fr&&Ue(br,Fr),gc(br,"prototype",{writable:!1}),br}var Pt={reportUrl:"https://statistic.live.126.net/statics/report/common/form",maxSize:100,msgListMaxSize:1e3,cacheMaxSize:1e3,maxDelay:3e5,maxInterval:3e4,minInterval:1e4,timeout:5e3,autoStart:!0},ar="https://statistic.live.126.net/dispatcher/req",tr=function(){},fr=function(){function br(Nr){Fe(this,br),this.enable=!1,this.initConfigLoaded=!1,this.loading=!1,this.isDestroyed=!1,this.reportConfig=Pt,this.msgList=[],this.traceMsgCache={},this.lowPriorityMsgList=[],this.cacheMsgList=[],this.lastReportTime=wa(),this.timer=null,this.setConfig(Nr),this.reportConfig.autoStart&&this.initUploadConfig()}return Ce(br,[{key:"setConfig",value:function(Fr){this.reportConfig=Hr({},this.reportConfig,Fr)}},{key:"reportImmediately",value:function(Fr,jr){var Vr=this;this.reportConfig.request(Fr,Hr({dataType:"json",method:"POST",timeout:this.reportConfig.timeout},jr)).catch(function(Kr){var Tn,Mn;(Mn=(Tn=Vr.reportConfig)===null||Tn===void 0?void 0:Tn.logger)===null||Mn===void 0||Mn.warn("Reporter immediately upload failed",Kr)})}},{key:"report",value:function(Fr,jr){var Vr=arguments.length>2&&arguments[2]!==void 0&&arguments[2];if(Fr){var Kr=wa();Vr?this.lowPriorityMsgList.push({module:Fr,msg:jr,createTime:Kr}):this.msgList.push({module:Fr,msg:jr,createTime:Kr}),this.msgList.length>this.reportConfig.msgListMaxSize&&this.msgList.shift(),this.lowPriorityMsgList.length>this.reportConfig.msgListMaxSize&&this.lowPriorityMsgList.shift(),this.doReport()}}},{key:"reportTraceStart",value:function(Fr,jr){if(Fr&&!this.traceMsgCache[Fr]){var Vr=Hr(Hr({start_time:wa()},jr),{extension:[]});this.traceMsgCache[Fr]=Vr}}},{key:"reportTraceUpdate",value:function(Fr){}},{key:"reportTraceUpdateV2",value:function(Fr,jr){if(this.traceMsgCache[Fr]){var Vr=this.traceMsgCache[Fr].extension.length,Kr=new Date().getTime();jr.duration=Vr===0?Kr-this.traceMsgCache[Fr].start_time:Kr-this.traceMsgCache[Fr].extension[Vr-1].end_time,this.traceMsgCache[Fr].extension.push(Hr({end_time:Kr},jr))}}},{key:"reportTraceEnd",value:function(Fr){var jr,Vr=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];this.traceMsgCache[Fr]&&(Fr!=="nos"||Vr===!1?(typeof Vr=="boolean"?this.traceMsgCache[Fr].succeed=!!Vr:this.traceMsgCache[Fr].state=Vr,this.traceMsgCache[Fr].duration=wa()-this.traceMsgCache[Fr].start_time,Kn(jr=this.traceMsgCache[Fr].extension).call(jr,function(Kr){delete Kr.end_time}),this.report(Fr,this.traceMsgCache[Fr]),this.traceMsgCache[Fr]=null):this.traceMsgCache[Fr]=null)}},{key:"reportTraceCancel",value:function(Fr){this.traceMsgCache[Fr]=null}},{key:"pause",value:function(){this.enable=!1}},{key:"restore",value:function(){this.enable=!0,this.initConfigLoaded||this.initUploadConfig()}},{key:"destroy",value:function(){var Fr,jr=this;Kn(Fr=aa(this.traceMsgCache)).call(Fr,function(Vr){jr.reportTraceEnd(Vr,1)}),this.timer!==null&&clearTimeout(this.timer),this.setConfig=tr,this.report=tr,this.reportTraceStart=tr,this.reportTraceUpdate=tr,this.reportTraceEnd=tr,this.pause=tr,this.restore=tr,this.destroy=tr,this.cacheMsgList=[],this.traceMsgCache={},this.lowPriorityMsgList=[],this.msgList=[],this.reportConfig={},this.isDestroyed=!0}},{key:"initUploadConfig",value:function(){var Fr,jr,Vr=this;if(!this.loading){this.loading=!0;var Kr=this.reportConfig.common||{};try{this.reportConfig.request(ar,{method:"GET",dataType:"json",params:{deviceId:Kr.dev_id,sdkVer:Kr.sdk_ver,platform:Kr.platform,appkey:Kr.app_key},timeout:this.reportConfig.timeout}).then(function(Tn){var Mn,En;if(!Vr.isDestroyed){if(Tn.status===200&&Tn.data&&Tn.data.code===200){var In=Tn.data.data||{};Vr.reportConfig.maxSize=In.maxSize>1e3?1e3:In.maxSize,Vr.reportConfig.maxInterval=In.maxInterval>1e4?1e4:In.maxInterval,Vr.reportConfig.maxInterval=In.maxInterval<10?10:In.maxInterval,Vr.reportConfig.minInterval=In.minInterval<2?2:In.minInterval,Vr.reportConfig.maxDelay=In.maxDelay||300,Vr.reportConfig.maxInterval=1e3*Vr.reportConfig.maxInterval,Vr.reportConfig.minInterval=1e3*Vr.reportConfig.minInterval,Vr.reportConfig.maxDelay=1e3*Vr.reportConfig.maxDelay,Vr.enable=!0,Vr.initConfigLoaded=!0,Vr.loading=!1,Vr.reportHeartBeat()}(En=(Mn=Vr.reportConfig)===null||Mn===void 0?void 0:Mn.logger)===null||En===void 0||En.log("Get reporter upload config success")}}).catch(function(Tn){var Mn,En;Vr.loading=!1,(En=(Mn=Vr.reportConfig)===null||Mn===void 0?void 0:Mn.logger)===null||En===void 0||En.error("Get reporter upload config failed",Tn)})}catch(Tn){this.loading=!1,(jr=(Fr=this.reportConfig)===null||Fr===void 0?void 0:Fr.logger)===null||jr===void 0||jr.error("Exec reporter request failed",Tn)}}}},{key:"reportHeartBeat",value:function(){var Fr=this;this.isDestroyed||(this.timer=Ao(function(){Fr.reportHeartBeat()},this.reportConfig.minInterval),this.doReport())}},{key:"doReport",value:function(){if(!this.isDestroyed){var Fr=this.msgList.length+this.lowPriorityMsgList.length+this.cacheMsgList.length>2*this.reportConfig.maxSize?this.reportConfig.minInterval:this.reportConfig.maxInterval;wa()-this.lastReportTime>=Fr&&this.upload()}}},{key:"getUploadMsg",value:function(){var Fr,jr,Vr,Kr,Tn,Mn=this,En={},In=wa();this.msgList=Is(Fr=this.msgList).call(Fr,function(Jn){return In-Jn.createTime<Mn.reportConfig.maxDelay}),this.lowPriorityMsgList=Is(jr=this.lowPriorityMsgList).call(jr,function(Jn){return In-Jn.createTime<Mn.reportConfig.maxDelay}),this.cacheMsgList=Is(Vr=this.cacheMsgList).call(Vr,function(Jn){return In-Jn.createTime<Mn.reportConfig.maxDelay});var Pn=Fo(Kr=this.msgList).call(Kr,0,this.reportConfig.maxSize);if(this.msgList=Fo(Tn=this.msgList).call(Tn,Pn.length),Pn.length<this.reportConfig.maxSize){var Hn,ho,uo=this.reportConfig.maxSize-Pn.length;Pn=Hs(Pn).call(Pn,Fo(Hn=this.lowPriorityMsgList).call(Hn,0,uo)),this.lowPriorityMsgList=Fo(ho=this.lowPriorityMsgList).call(ho,uo)}if(Pn.length<this.reportConfig.maxSize){var Do,no,zr=this.reportConfig.maxSize-Pn.length;Pn=Hs(Pn).call(Pn,Fo(Do=this.cacheMsgList).call(Do,0,zr)),this.cacheMsgList=Fo(no=this.cacheMsgList).call(no,zr)}return Kn(Pn).call(Pn,function(Jn){En[Jn.module]?En[Jn.module].push(Jn.msg):En[Jn.module]=[Jn.msg]}),{uploadMsgArr:Pn,uploadMsg:En}}},{key:"upload",value:function(){var Fr,jr,Vr=this;if(this.enable&&!(this.lastReportTime&&wa()-this.lastReportTime<this.reportConfig.minInterval)){var Kr=this.getUploadMsg(),Tn=Kr.uploadMsgArr,Mn=Kr.uploadMsg;if(Tn.length){this.lastReportTime=wa();try{this.reportConfig.request(this.reportConfig.reportUrl,{dataType:"json",method:"POST",data:{common:this.reportConfig.common,event:Mn},headers:{sdktype:"im"},timeout:this.reportConfig.timeout}).catch(function(En){var In,Pn,Hn,ho;Vr.cacheMsgList=Fo(In=Hs(Pn=Vr.cacheMsgList).call(Pn,Tn)).call(In,0,Vr.reportConfig.cacheMaxSize),(ho=(Hn=Vr.reportConfig)===null||Hn===void 0?void 0:Hn.logger)===null||ho===void 0||ho.warn("Reporter upload failed",En)})}catch(En){(jr=(Fr=this.reportConfig)===null||Fr===void 0?void 0:Fr.logger)===null||jr===void 0||jr.warn("Exec reporter request failed",En)}clearTimeout(this.timer),this.reportHeartBeat()}}}}]),br}();return fr}()}),sa={setLogger:function(he){throw new Error("Function not implemented.")},platform:"",WebSocket:function(){function xe(Fe,Ue){throw this.CONNECTING=0,this.OPEN=1,this.CLOSING=2,this.CLOSED=3,new Error("Method not implemented.")}var he=xe.prototype;return he.close=function(Ue,Ce){throw new Error("Method not implemented.")},he.send=function(Ue){throw new Error("Method not implemented.")},he.onclose=function(Ue){throw new Error("Method not implemented.")},he.onerror=function(Ue){throw new Error("Method not implemented.")},he.onmessage=function(Ue){throw new Error("Method not implemented.")},he.onopen=function(Ue){throw new Error("Method not implemented.")},xe}(),localStorage:{},request:function(he,Fe){throw new Error("Function not implemented.")},uploadFile:function(he){throw new Error("Function not implemented.")},getSystemInfo:function(){throw new Error("Function not implemented.")}},bi=TypeError,Uv=function(xe){return function(he,Fe,Ue,Ce){Xr(Fe);var Pt=An(he),ar=hr(Pt),tr=Ka(Pt),fr=xe?tr-1:0,br=xe?-1:1;if(Ue<2)for(;;){if(fr in ar){Ce=ar[fr],fr+=br;break}if(fr+=br,xe?fr<0:tr<=fr)throw bi("Reduce of empty array with no initial value")}for(;xe?fr>=0:tr>fr;fr+=br)fr in ar&&(Ce=Fe(Ce,ar[fr],fr,Pt));return Ce}},ya={left:Uv(!1),right:Uv(!0)}.left,kT=li("reduce");_n({target:"Array",proto:!0,forced:!kT||!cs&&Br>79&&Br<83},{reduce:function(he){var Fe=arguments.length;return ya(this,he,Fe,Fe>1?arguments[1]:void 0)}});var qv=na("Array").reduce,Gg=Array.prototype,Pp=function(xe){var he=xe.reduce;return xe===Gg||vr(Gg,xe)&&he===Gg.reduce?qv:he},Vv=function(he){return he===void 0},eu={},Hc={};function Hv(xe,he){var Fe,Ue,Ce;try{Ce=JSON.parse(xe)}catch(Vr){throw he.error("Parse command error: ",xe),Vr}var Pt=Ce.sid+"_"+Ce.cid,ar=Ce.r;if(qc(Fe=["4_1","4_2","4_10","4_11"]).call(Fe,Pt)){var tr=Ce.r[1].headerPacket;Pt=tr.sid+"_"+tr.cid,ar=Ce.r[1].body}var fr,br=Hc[Pt],Nr=eu[br],Fr=function(Kr,Tn){var Mn=Il[Kr];return Mn===null?null:new Ip(Kr,Tn,Mn,new Date().getTime())}(Ce.code,br),jr={cmd:br,raw:Ce,error:Fr,service:Nr==null?void 0:Nr.service,content:{}};if(jr.error){if(jr.error.cmd=br,jr.error.callFunc="parseCmd",!(!((Ue=Nr==null?void 0:Nr.ignoreErrCodes)===null||Ue===void 0)&&qc(Ue).call(Ue,Ce.code)))return jr;he.warn("parseCmd:: ignore error ",jr.error),jr.error.ignore=!0}return!br||!Nr?(jr.notFound=!0,jr):(Nr.response&&Kn(fr=Nr.response).call(fr,function(Vr,Kr){var Tn=ar[Kr],Mn=Vr.type,En=Vr.name,In=Vr.reflectMapper;if(!Vv(Tn))switch(Mn){case"Property":jr.content[En]=In?Xi(Tn,In):Tn;break;case"PropertyArray":jr.content[En]=Ro(Tn).call(Tn,function(Pn){return In?Xi(Pn,In):Pn});break;case"long":case"Long":case"byte":case"Byte":case"Number":jr.content[En]=+Tn;break;default:jr.content[En]=Tn}}),jr)}function Od(xe,he){var Fe={};for(var Ue in xe)he[Ue]!==void 0&&(Fe[he[Ue]]=xe[Ue]);return Fe}function Xi(xe,he){var Fe={};for(var Ue in xe)he[Ue]!==void 0&&(Fe[he[Ue]]=xe[Ue]);return Fe}function ls(xe){eu=Hr(eu,xe.cmdConfig),Hc=Hr(Hc,xe.cmdMap)}function Cs(xe){var he;return Pp(he=aa(xe)).call(he,function(Fe,Ue){var Ce,Pt=xe[Ue];return Fe[Ue]=Pp(Ce=aa(Pt)).call(Ce,function(ar,tr){return ar[Pt[tr]]=tr,ar},{}),Fe},{})}var es=["disconnect","connect","heartbeat","message","json","event","ack","error","noop"],Zi=["transport not supported","client not handshaken","unauthorized"],zc=["reconnect"],Kg=function(xe){function he(Ue,Ce,Pt){var ar;return(ar=xe.call(this)||this).url=Ce,ar.logger=Pt,ar.websocket=null,ar.core=Ue,ar.url=Ce,ar.status="disconnected",ar.logger=Pt,ar.connect(),ar}Ko(he,xe);var Fe=he.prototype;return Fe.connect=function(){var Ce=this;this.status!=="connecting"&&this.status!=="connected"?(this.status="connecting",this.core.adapters.request("https://"+this.url+"/socket.io/1/?t="+wa(),{method:"GET",dataType:"text",timeout:8e3}).then(function(Pt){var ar=Pt.data.split(":"),tr=ar[0],fr=ar[1];return Ce.sessionId=tr,Ce.closeTimeout=1e3*fr,Ce._createWebsocket("wss://"+Ce.url+"/socket.io/1/websocket/"+tr)}).catch(function(Pt){Ce.logger.error("imsocket::handshake fail. ",Pt&&Pt.message),Ce.status="disconnected",Ce.emit("handshakeFailed")})):this.logger.warn("imsocket::socket is connecting or connected",this.status)},Fe.close=function(){if(this.websocket){this.logger.log("imsocket:: close websocket");try{this.websocket.send(this.encodePacket({type:"disconnect"})),this.websocket.close()}catch(Ce){this.logger.warn("attempt to close websocket error",Ce)}this.clean()}},Fe.clean=function(){this.status="disconnected",this.websocket&&(this.websocket.onmessage=null,this.websocket.onopen=null,this.websocket.onerror=null,this.websocket.onclose=null,this.websocket=null,this.emit("disconnect"))},Fe.onConnect=function(){this.status="connected",this.resetCloseTimer(),this.emit("connect")},Fe._createWebsocket=function(Ce){var Pt,ar=this;this.websocket=new sa.WebSocket(Ce),this.websocket.onmessage=Go(Pt=this.onMessage).call(Pt,this),this.websocket.onclose=function(){ar.logger.log("imsocket:: receive websocket onclose event, current status",ar.status),ar.clean()},this.websocket.onerror=function(tr){ar.logger.error("imsocket:: onerror",tr)}},Fe.onMessage=function(Ce){var Pt;this.resetCloseTimer();var ar=this.decodePacket(Ce.data);if(ar)switch(ar.type){case"connect":this.onConnect();break;case"disconnect":this.close();break;case"message":case"json":this.emit("message",ar.data);break;case"event":ar.name&&this.emit(ar.name,ar.args);break;case"error":ar.reason==="unauthorized"?this.emit("connect_failed",ar.reason):this.emit("error",ar.reason);break;case"heartbeat":(Pt=this.websocket)===null||Pt===void 0||Pt.send(this.encodePacket({type:"heartbeat"}));break;default:this.logger.warn("imsocket::no handler type",ar.type)}},Fe.encodePacket=function(Ce){var Pt,ar,tr=Ce.type,fr=Ce.id,br=fr===void 0?"":fr,Nr=Ce.endpoint,Fr=Nr===void 0?"":Nr,jr=Ce.ack,Vr=null;if(!tr)return"";switch(tr){case"error":Pt=Ce.reason?Va(Zi).call(Zi,Ce.reason):"",ar=Ce.advice?Va(zc).call(zc,Ce.advice):"",Pt===""&&ar===""||(Vr=Pt+(ar!==""?"+"+ar:""));break;case"message":Ce.data!==""&&(Vr=Ce.data);break;case"event":Pt={name:Ce.name},Pt=Ce.args&&Ce.args.length?{name:Ce.name,args:Ce.args}:{name:Ce.name},Vr=la(Pt);break;case"json":Vr=la(Ce.data);break;case"connect":Ce.qs&&(Vr=Ce.qs);break;case"ack":Vr=Ce.ackId+(Ce.args&&Ce.args.length?"+"+la(Ce.args):"")}var Kr=[Va(es).call(es,tr),br+(jr==="data"?"+":""),Fr];return Vr!=null&&Kr.push(Vr),Kr.join(":")},Fe.decodePacket=function(Ce){if(Ce)if(Ce.charAt(0)!="�"){var Pt=Ce.match(/([^:]+):([0-9]+)?(\+)?:([^:]+)?:?([\s\S]*)?/);if(Pt){var ar,tr=Pt[1],fr=Pt[2],br=Pt[3],Nr=Pt[4],Fr=Pt[5],jr={type:es[+tr],endpoint:Nr};switch(fr&&(jr.id=fr,jr.ack=!br||"data"),jr.type){case"error":ar=Fr.split("+"),jr.reason=Zi[+ar[0]]||"";break;case"message":jr.data=Fr||"";break;case"connect":jr.qs=Fr||"";break;case"event":try{var Vr=JSON.parse(Fr);jr.name=Vr.name,jr.args=Vr.args}catch(Kr){this.logger.error("imsocket::parseData::type::event error",Kr)}jr.args=jr.args||[];break;case"json":try{jr.data=JSON.parse(Fr)}catch(Kr){this.logger.error("imsocket::parseData::type::json error",Kr)}break;case"ack":if((ar=Fr.match(/^([0-9]+)(\+)?(.*)/))&&(jr.ackId=ar[1],jr.args=[],ar[3]))try{jr.args=ar[3]?JSON.parse(ar[3]):[]}catch(Kr){this.logger.error("imsocket::parseData::type::ack error",Kr)}}return jr}}else this.logger.error("imsocket::unrecognize dataStr",Fo(Ce).call(Ce,0,20))},Fe.send=function(Ce){var Pt,ar={data:Ce,type:"message",endpoint:""};(Pt=this.websocket)===null||Pt===void 0||Pt.send(this.encodePacket(ar))},Fe.resetCloseTimer=function(){var Ce=this;this.closeTimeout&&(clearTimeout(this.closeTimer),this.closeTimer=Ao(function(){Ce.close()},this.closeTimeout))},he}(pi),Qg=na("Array").values,Ap=Array.prototype,wT={DOMTokenList:!0,NodeList:!0},Np=function(xe){var he=xe.values;return xe===Ap||vr(Ap,xe)&&he===Ap.values||hn(wT,oi(xe))?Qg:he};_n({target:"Array",stat:!0},{isArray:ys});var ji=kr.Array.isArray,xT=js.every,Op=li("every");_n({target:"Array",proto:!0,forced:!Op},{every:function(he){return xT(this,he,arguments.length>1?arguments[1]:void 0)}});var ks=na("Array").every,Jg=Array.prototype,_T=function(xe){var he=xe.every;return xe===Jg||vr(Jg,xe)&&he===Jg.every?ks:he},Di=function(he){return he!=null&&typeof he=="object"},Yg=function(he){return Di(he)&&Uc(he)=="[object RegExp]"},tu=function(he){return function(Fe){return he(Fe)}},Es=g(function(xe,he){var Fe=he&&!he.nodeType&&he,Ue=Fe&&xe&&!xe.nodeType&&xe,Ce=Ue&&Ue.exports===Fe&&Pv.process,Pt=function(){try{var ar=Ue&&Ue.require&&Ue.require("util").types;return ar||Ce&&Ce.binding&&Ce.binding("util")}catch{}}();xe.exports=Pt}),zv=Es&&Es.isRegExp,Xg=zv?tu(zv):Yg,ru=Xs["__core-js_shared__"],Zg=function(){var xe=/[^.]+$/.exec(ru&&ru.keys&&ru.keys.IE_PROTO||"");return xe?"Symbol(src)_1."+xe:""}(),IT=function(he){return!!Zg&&Zg in he},eh=Function.prototype.toString,Wc=function(he){if(he!=null){try{return eh.call(he)}catch{}try{return he+""}catch{}}return""},ET=/^\[object .+?Constructor\]$/,PT=Function.prototype,Pl=Object.prototype,AT=PT.toString,NT=Pl.hasOwnProperty,OT=RegExp("^"+AT.call(NT).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),RT=function(he){return!(!$i(he)||IT(he))&&(xp(he)?OT:ET).test(Wc(he))},BT=function(he,Fe){return he==null?void 0:he[Fe]},Al=function(he,Fe){var Ue=BT(he,Fe);return RT(Ue)?Ue:void 0},Rd=Al(Object,"create"),FT=function(){this.__data__=Rd?Rd(null):{},this.size=0},Nl=function(he){var Fe=this.has(he)&&delete this.__data__[he];return this.size-=Fe?1:0,Fe},Bd=Object.prototype.hasOwnProperty,$T=function(he){var Fe=this.__data__;if(Rd){var Ue=Fe[he];return Ue==="__lodash_hash_undefined__"?void 0:Ue}return Bd.call(Fe,he)?Fe[he]:void 0},LT=Object.prototype.hasOwnProperty,jT=function(he){var Fe=this.__data__;return Rd?Fe[he]!==void 0:LT.call(Fe,he)},DT=function(he,Fe){var Ue=this.__data__;return this.size+=this.has(he)?0:1,Ue[he]=Rd&&Fe===void 0?"__lodash_hash_undefined__":Fe,this};function nu(xe){var he=-1,Fe=xe==null?0:xe.length;for(this.clear();++he<Fe;){var Ue=xe[he];this.set(Ue[0],Ue[1])}}nu.prototype.clear=FT,nu.prototype.delete=Nl,nu.prototype.get=$T,nu.prototype.has=jT,nu.prototype.set=DT;var Wv=nu,UT=function(){this.__data__=[],this.size=0},xc=function(he,Fe){return he===Fe||he!=he&&Fe!=Fe},Fd=function(he,Fe){for(var Ue=he.length;Ue--;)if(xc(he[Ue][0],Fe))return Ue;return-1},qT=Array.prototype.splice,Rp=function(he){var Fe=this.__data__,Ue=Fd(Fe,he);return!(Ue<0)&&(Ue==Fe.length-1?Fe.pop():qT.call(Fe,Ue,1),--this.size,!0)},Bp=function(he){var Fe=this.__data__,Ue=Fd(Fe,he);return Ue<0?void 0:Fe[Ue][1]},VT=function(he){return Fd(this.__data__,he)>-1},HT=function(he,Fe){var Ue=this.__data__,Ce=Fd(Ue,he);return Ce<0?(++this.size,Ue.push([he,Fe])):Ue[Ce][1]=Fe,this};function ou(xe){var he=-1,Fe=xe==null?0:xe.length;for(this.clear();++he<Fe;){var Ue=xe[he];this.set(Ue[0],Ue[1])}}ou.prototype.clear=UT,ou.prototype.delete=Rp,ou.prototype.get=Bp,ou.prototype.has=VT,ou.prototype.set=HT;var Fp=ou,$d=Al(Xs,"Map"),au=function(){this.size=0,this.__data__={hash:new Wv,map:new($d||Fp),string:new Wv}},$p=function(he){var Fe=typeof he;return Fe=="string"||Fe=="number"||Fe=="symbol"||Fe=="boolean"?he!=="__proto__":he===null},Gc=function(he,Fe){var Ue=he.__data__;return $p(Fe)?Ue[typeof Fe=="string"?"string":"hash"]:Ue.map},zT=function(he){var Fe=Gc(this,he).delete(he);return this.size-=Fe?1:0,Fe},WT=function(he){return Gc(this,he).get(he)},Lp=function(he){return Gc(this,he).has(he)},GT=function(he,Fe){var Ue=Gc(this,he),Ce=Ue.size;return Ue.set(he,Fe),this.size+=Ue.size==Ce?0:1,this};function su(xe){var he=-1,Fe=xe==null?0:xe.length;for(this.clear();++he<Fe;){var Ue=xe[he];this.set(Ue[0],Ue[1])}}su.prototype.clear=au,su.prototype.delete=zT,su.prototype.get=WT,su.prototype.has=Lp,su.prototype.set=GT;var jp=su,KT=function(he){return this.__data__.set(he,"__lodash_hash_undefined__"),this},iu=function(he){return this.__data__.has(he)};function Ol(xe){var he=-1,Fe=xe==null?0:xe.length;for(this.__data__=new jp;++he<Fe;)this.add(xe[he])}Ol.prototype.add=Ol.prototype.push=KT,Ol.prototype.has=iu;var th=Ol,Gv=function(he,Fe,Ue,Ce){for(var Pt=he.length,ar=Ue+(Ce?1:-1);Ce?ar--:++ar<Pt;)if(Fe(he[ar],ar,he))return ar;return-1},Dp=function(he){return he!=he},rh=function(he,Fe,Ue){for(var Ce=Ue-1,Pt=he.length;++Ce<Pt;)if(he[Ce]===Fe)return Ce;return-1},QT=function(he,Fe,Ue){return Fe==Fe?rh(he,Fe,Ue):Gv(he,Dp,Ue)},Kv=function(he,Fe){return!!(he!=null&&he.length)&&QT(he,Fe,0)>-1},Qv=function(he,Fe,Ue){for(var Ce=-1,Pt=he==null?0:he.length;++Ce<Pt;)if(Ue(Fe,he[Ce]))return!0;return!1},nh=function(he,Fe){for(var Ue=-1,Ce=he==null?0:he.length,Pt=Array(Ce);++Ue<Ce;)Pt[Ue]=Fe(he[Ue],Ue,he);return Pt},Up=function(he,Fe){return he.has(Fe)},Jv=function(he,Fe,Ue,Ce){var Pt=-1,ar=Kv,tr=!0,fr=he.length,br=[],Nr=Fe.length;if(!fr)return br;Ue&&(Fe=nh(Fe,tu(Ue))),Ce?(ar=Qv,tr=!1):Fe.length>=200&&(ar=Up,tr=!1,Fe=new th(Fe));e:for(;++Pt<fr;){var Fr=he[Pt],jr=Ue==null?Fr:Ue(Fr);if(Fr=Ce||Fr!==0?Fr:0,tr&&jr==jr){for(var Vr=Nr;Vr--;)if(Fe[Vr]===jr)continue e;br.push(Fr)}else ar(Fe,jr,Ce)||br.push(Fr)}return br},cu=function(he){return he},oh=function(he,Fe,Ue){switch(Ue.length){case 0:return he.call(Fe);case 1:return he.call(Fe,Ue[0]);case 2:return he.call(Fe,Ue[0],Ue[1]);case 3:return he.call(Fe,Ue[0],Ue[1],Ue[2])}return he.apply(Fe,Ue)},ah=Math.max,qp=function(he,Fe,Ue){return Fe=ah(Fe===void 0?he.length-1:Fe,0),function(){for(var Ce=arguments,Pt=-1,ar=ah(Ce.length-Fe,0),tr=Array(ar);++Pt<ar;)tr[Pt]=Ce[Fe+Pt];Pt=-1;for(var fr=Array(Fe+1);++Pt<Fe;)fr[Pt]=Ce[Pt];return fr[Fe]=Ue(tr),oh(he,this,fr)}},Yv=function(he){return function(){return he}},Ld=function(){try{var xe=Al(Object,"defineProperty");return xe({},"",{}),xe}catch{}}(),Xv=Ld?function(xe,he){return Ld(xe,"toString",{configurable:!0,enumerable:!1,value:Yv(he),writable:!0})}:cu,JT=Date.now,Vp=function(he){var Fe=0,Ue=0;return function(){var Ce=JT(),Pt=16-(Ce-Ue);if(Ue=Ce,Pt>0){if(++Fe>=800)return arguments[0]}else Fe=0;return he.apply(void 0,arguments)}},Zv=Vp(Xv),sh=function(he){return typeof he=="number"&&he>-1&&he%1==0&&he<=9007199254740991},Hp=function(he){return he!=null&&sh(he.length)&&!xp(he)},ey=function(he){return Di(he)&&Hp(he)},ty=function(he,Fe){return Zv(qp(he,Fe,cu),he+"")}(function(xe,he){return ey(xe)?Jv(xe,he):[]}),ih=ty;function zp(xe,he){return he instanceof RegExp?"__REGEXP "+he.toString():he}function Qn(xe,he,Fe){var Ue;he===void 0&&(he={});var Ce={};return Kn(Ue=aa(xe)).call(Ue,function(Pt){var ar=xe[Pt].type,tr=Fe?"In "+Fe+", ":"";if(he[Pt]===void 0){if(xe[Pt].required===!1)return void(Ce[Pt]=he[Pt]);throw new No(tr+'param "'+Pt+'" is required',{key:Pt},"required")}var fr=YT[ar];if(fr&&!fr(he,Pt,xe[Pt]))throw new No(tr+'param "'+Pt+'" expects '+la(xe[Pt],zp),{key:Pt,value:he[Pt]},la(xe[Pt]));Ce[Pt]=he[Pt]}),Ce}var YT={string:function(he,Fe,Ue){var Ce=Ue.allowEmpty,Pt=Ue.max,ar=Ue.min,tr=Ue.regExp,fr=he[Fe];return typeof fr=="string"&&(Ce!==!1||fr!=="")&&!(typeof Pt=="number"&&fr.length>Pt)&&!(typeof ar=="number"&&fr.length<ar)&&!(Xg(tr)&&!tr.test(fr))},number:function(he,Fe,Ue){var Ce=Ue.min,Pt=Ue.max,ar=he[Fe];return typeof ar=="number"&&!(typeof Ce=="number"&&ar<Ce)&&!(typeof Pt=="number"&&ar>Pt)},boolean:function(he,Fe){return typeof he[Fe]=="boolean"},enum:function(he,Fe,Ue){var Ce=Np(Ue),Pt=he[Fe];return!Ce||Va(Ce).call(Ce,Pt)>-1},array:function(he,Fe,Ue){var Ce,Pt=Ue.itemType,ar=Ue.rules,tr=Ue.min,fr=Ue.max,br=Np(Ue),Nr=he[Fe];return!!ji(Nr)&&!(typeof fr=="number"&&Nr.length>fr)&&!(typeof tr=="number"&&Nr.length<tr)&&!(Pt&&Pt!=="enum"&&!_T(Nr).call(Nr,function(Fr){return typeof Fr===Pt}))&&(Pt!=="enum"||!br||!ih.apply(void 0,Hs(Ce=[Nr]).call(Ce,br)).length)&&(ar&&Kn(Nr).call(Nr,function(Fr,jr){return Qn(ar,Fr,Fe+"["+jr+"]")}),!0)},object:function(he,Fe,Ue){var Ce=Ue.rules,Pt=he[Fe];return Ce&&Qn(Ce,Pt,Fe),!0}},lu=Al(Xs,"Set"),XT=function(){},On=function(he){var Fe=-1,Ue=Array(he.size);return he.forEach(function(Ce){Ue[++Fe]=Ce}),Ue},ZT=lu&&1/On(new lu([,-0]))[1]==1/0?function(xe){return new lu(xe)}:XT,uu=ZT,eS=function(he,Fe,Ue){var Ce=-1,Pt=Kv,ar=he.length,tr=!0,fr=[],br=fr;if(Ue)tr=!1,Pt=Qv;else if(ar>=200){var Nr=Fe?null:uu(he);if(Nr)return On(Nr);tr=!1,Pt=Up,br=new th}else br=Fe?[]:fr;e:for(;++Ce<ar;){var Fr=he[Ce],jr=Fe?Fe(Fr):Fr;if(Fr=Ue||Fr!==0?Fr:0,tr&&jr==jr){for(var Vr=br.length;Vr--;)if(br[Vr]===jr)continue e;Fe&&br.push(jr),fr.push(Fr)}else Pt(br,jr,Ue)||(br!==fr&&br.push(jr),fr.push(Fr))}return fr},Wp=function(he){return he&&he.length?eS(he):[]},ch=`	
\v\f\r                　\u2028\u2029\uFEFF`,ry=Ne("".replace),Gp="["+ch+"]",tS=RegExp("^"+Gp+Gp+"*"),lh=RegExp(Gp+Gp+"*$"),Kp=function(xe){return function(he){var Fe=Za(Er(he));return 1&xe&&(Fe=ry(Fe,tS,"")),2&xe&&(Fe=ry(Fe,lh,"")),Fe}},Qp={start:Kp(1),end:Kp(2),trim:Kp(3)}.trim,jd=L.parseInt,ny=L.Symbol,Jp=ny&&ny.iterator,oy=/^[+-]?0x/i,Dd=Ne(oy.exec),uh=jd(ch+"08")!==8||jd(ch+"0x16")!==22||Jp&&!V(function(){jd(Object(Jp))})?function(he,Fe){var Ue=Qp(Za(he));return jd(Ue,Fe>>>0||(Dd(oy,Ue)?16:10))}:jd;_n({global:!0,forced:parseInt!=uh},{parseInt:uh});var ec,Lo=kr.parseInt,Yp=(ec=function(){return(65536*(1+Math.random())|0).toString(16).substring(1)},function(){return ec()+ec()+ec()+ec()+ec()+ec()+ec()+ec()});function Ui(xe){var he;return Is(he=aa(xe)).call(he,function(Fe){return!(+Fe>=0)})}function tc(xe,he){var Fe,Ue=Is(Fe=aa(xe)).call(Fe,function(Ce){return xe[Ce]==he});return Ue.length>0?Ue[0]:void 0}function Yo(xe,he){if(he===void 0&&(he="-"),!xe)throw new wc("No sessionId",{},400);var Fe=Va(xe).call(xe,he);if(Fe===-1)throw new wc("Can not find conjunctions",{},400);var Ue=Fo(xe).call(xe,0,Fe);return{accid:Fo(xe).call(xe,Fe+1),scene:Ue==="super_team"?"superTeam":Ue}}var dh=TypeError,xa=Object.getOwnPropertyDescriptor,ay=$e&&!function(){if(this!==void 0)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(xe){return xe instanceof TypeError}}()?function(xe,he){if(ys(xe)&&!xa(xe,"length").writable)throw dh("Cannot set read only .length");return xe.length=he}:function(xe,he){return xe.length=he},rS=TypeError,Xp=function(xe,he){if(!delete xe[he])throw rS("Cannot delete property "+bn(he)+" of "+bn(xe))},nS=lc("splice"),oS=Math.max,Zp=Math.min;_n({target:"Array",proto:!0,forced:!nS},{splice:function(he,Fe){var Ue,Ce,Pt,ar,tr,fr,br=An(this),Nr=Ka(br),Fr=xi(he,Nr),jr=arguments.length;for(jr===0?Ue=Ce=0:jr===1?(Ue=0,Ce=Nr-Fr):(Ue=jr-2,Ce=Zp(oS(sc(Fe),0),Nr-Fr)),Fu(Nr+Ue-Ce),Pt=ju(br,Ce),ar=0;ar<Ce;ar++)(tr=Fr+ar)in br&&ni(Pt,ar,br[tr]);if(Pt.length=Ce,Ue<Ce){for(ar=Fr;ar<Nr-Ce;ar++)fr=ar+Ue,(tr=ar+Ce)in br?br[fr]=br[tr]:Xp(br,fr);for(ar=Nr;ar>Nr-Ce+Ue;ar--)Xp(br,ar-1)}else if(Ue>Ce)for(ar=Nr-Ce;ar>Fr;ar--)fr=ar+Ue-1,(tr=ar+Ce-1)in br?br[fr]=br[tr]:Xp(br,fr);for(ar=0;ar<Ue;ar++)br[ar+Fr]=arguments[ar+2];return ay(br,Nr-Ce+Ue),Pt}});var aS=na("Array").splice,ph=Array.prototype,fh=function(xe){var he=xe.splice;return xe===ph||vr(ph,xe)&&he===ph.splice?aS:he},sS=function(xe,he,Fe,Ue){try{return Ue?he(lo(Fe)[0],Fe[1]):he(Fe)}catch(Ce){od(xe,"throw",Ce)}},ef=Array,sy=!bg(function(xe){Array.from(xe)});_n({target:"Array",stat:!0,forced:sy},{from:function(he){var Fe=An(he),Ue=ul(this),Ce=arguments.length,Pt=Ce>1?arguments[1]:void 0,ar=Pt!==void 0;ar&&(Pt=Zo(Pt,Ce>2?arguments[2]:void 0));var tr,fr,br,Nr,Fr,jr,Vr=bl(Fe),Kr=0;if(!Vr||this===ef&&Lm(Vr))for(tr=Ka(Fe),fr=Ue?new this(tr):ef(tr);tr>Kr;Kr++)jr=ar?Pt(Fe[Kr],Kr):Fe[Kr],ni(fr,Kr,jr);else for(Fr=(Nr=hc(Fe,Vr)).next,fr=Ue?new this:[];!(br=jt(Fr,Nr)).done;Kr++)jr=ar?sS(Nr,Pt,[br.value,Kr],!0):br.value,ni(fr,Kr,jr);return fr.length=Kr,fr}});var tf=kr.Array.from,Ud=bl;function iy(xe,he){var Fe,Ue=Ba!==void 0&&Ud(xe)||xe["@@iterator"];if(Ue)return Go(Fe=(Ue=Ue.call(xe)).next).call(Fe,Ue);if(ji(xe)||(Ue=function(ar,tr){var fr;if(ar){if(typeof ar=="string")return Kc(ar,tr);var br=Fo(fr=Object.prototype.toString.call(ar)).call(fr,8,-1);if(br==="Object"&&ar.constructor&&(br=ar.constructor.name),br==="Map"||br==="Set")return tf(ar);if(br==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(br))return Kc(ar,tr)}}(xe))||he&&xe&&typeof xe.length=="number"){Ue&&(xe=Ue);var Ce=0;return function(){return Ce>=xe.length?{done:!0}:{done:!1,value:xe[Ce++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Kc(xe,he){(he==null||he>xe.length)&&(he=xe.length);for(var Fe=0,Ue=new Array(he);Fe<he;Fe++)Ue[Fe]=xe[Fe];return Ue}var us,cy=function(){function xe(){this.timerList=[],this.id=0,this.timer=null,this.timeout=0}var he=xe.prototype;return he.addTimer=function(Ue,Ce,Pt){Ce===void 0&&(Ce=0),Pt===void 0&&(Pt=1);var ar=new Date().getTime(),tr=this.id;return this.timerList.push({id:tr,loop:Pt,count:0,timeout:ar+Ce,interval:Ce,callback:Ue}),this.id++,this.checkTimer(ar),tr},he.checkTimer=function(Ue){if(Ue===void 0&&(Ue=new Date().getTime()),this.removeFinished(),this.timerList.length!==0||this.timer==null){for(var Ce,Pt,ar=0,tr=iy(this.timerList);!(Ce=tr()).done;){var fr=Ce.value;(ar===0||ar>fr.timeout)&&(ar=fr.timeout)}this.timerList.length!==0&&(this.timer===null||ar<this.timeout||this.timeout<Ue)&&(this.timer=Ao(Go(Pt=this.nowTime).call(Pt,this),ar-Ue),this.timeout=ar)}},he.nowTime=function(){for(var Ue,Ce=new Date().getTime(),Pt=iy(this.timerList);!(Ue=Pt()).done;){var ar=Ue.value;Ce>=ar.timeout&&(ar.callback(),ar.count++,ar.timeout=Ce+ar.interval)}this.clerTime(),this.checkTimer(Ce)},he.clerTime=function(){this.timer!==null&&(clearTimeout(this.timer),this.timer=null)},he.deleteTimer=function(Ue){for(var Ce=this.timerList.length-1;Ce>=0;Ce--){var Pt;this.timerList[Ce].id===Ue&&fh(Pt=this.timerList).call(Pt,Ce,1)}},he.removeFinished=function(){for(var Ue=this.timerList.length-1;Ue>=0;Ue--){var Ce,Pt=this.timerList[Ue];Pt.loop>=0&&Pt.count>=Pt.loop&&fh(Ce=this.timerList).call(Ce,Ue,1)}},he.destroy=function(){this.clerTime(),this.timerList=[],this.id=0,this.timer=null},xe}(),ly=function(){function xe(Fe){this.core=Fe}var he=xe.prototype;return he.request=function(Ue,Ce){var Pt=this,ar=new Date().getTime();return sa.request(Ue,Ce).catch(function(tr){var fr,br,Nr=tr;throw Pt.core.reporter.reportTraceStart("exceptions",{user_id:Pt.core.options.account,trace_id:(br=(fr=Pt.core)===null||fr===void 0?void 0:fr.socket)===null||br===void 0?void 0:br.sessionId,start_time:ar,action:1}),Pt.core.reporter.reportTraceUpdateV2("exceptions",{code:typeof Nr.code=="number"?Nr.code:0,description:Nr.message||""+Nr.code,operation_type:0,target:Ue,context:Ce?la(Ce):""}),Pt.core.reporter.reportTraceEnd("exceptions",1),tr})},he.uploadFile=function(Ue){var Ce=this,Pt=new Date().getTime();return sa.uploadFile(Ue).catch(function(ar){var tr,fr,br=ar;Ce.core.reporter.reportTraceStart("exceptions",{user_id:Ce.core.options.account,trace_id:(fr=(tr=Ce.core)===null||tr===void 0?void 0:tr.socket)===null||fr===void 0?void 0:fr.sessionId,start_time:Pt,action:1});var Nr=sa.platform==="BROWSER"?Ue.chunkUploadHost:Ue.commonUploadHost?Ue.commonUploadHost+"/"+(Ue.nosToken&&Ue.nosToken.bucket):"https://nos.netease.com/nim";throw Ce.core.reporter.reportTraceUpdateV2("exceptions",{code:typeof br.code=="number"?br.code:0,description:br.message||""+br.code,operation_type:1,target:Nr}),Ce.core.reporter.reportTraceEnd("exceptions",1),ar})},xe}();(function(xe){xe[xe.ACTIVE=1]="ACTIVE",xe[xe.KICKED=2]="KICKED",xe[xe.OFFLINE=3]="OFFLINE"})(us||(us={}));var Ps=window&&xp(window.addEventListener)&&xp(window.removeEventListener),uy=function(xe){function he(Ue,Ce){var Pt;(Pt=xe.call(this)||this).status="unconnected",Pt.linkUrls=[],Pt.eventBus=new pi,Pt.packetSer=1,Pt.retryCount=0,Pt.reconnectTimer=0,Pt.backoff=new Ji({max:8e3,min:1600,jitter:.01}),Pt.sendingCmdMap=new Cc,Pt.pingTimer=0,Pt.config=Bv,Pt.abtInfo={},Qn({linkUrls:{type:"array",itemType:"string",required:!1}},Ue),Pt.options=Hr(Hr({},uT),Ue),Pt.adapters=new ly(k(Pt));var ar=sa.localStorage.getItem("__NIM_DEVC_ID__");Pt.options.isFixedDeviceId?(ar=sa.localStorage.getItem("__NIM_DEVC_ID__")||Yp(),sa.localStorage.setItem("__NIM_DEVC_ID__",ar)):ar=Yp(),Pt.config=Hr(Hr(Hr({},Bv),Ce),{deviceId:ar}),Pt.timerManager=new cy,Pt.logger=new Ep(Pt.options.debugLevel,Pt.options.account);var tr=sa.getSystemInfo();return Pt.reporter=new CT({common:{app_key:Ue.appkey,dev_id:ar,platform:"Web",sdk_ver:"0.13.1",env:"online",os_name:tr.os,os_ver:tr.osVer,model:tr.hostEnvVer,manufactor:tr.hostEnv,host_env:tr.hostEnv,host_info:tr.hostInfo,host_env_ver:tr.hostEnvVer},request:sa.request,logger:Pt.logger,autoStart:sa.platform==="BROWSER"}),sa.setLogger(Pt.logger),Pt.logger.log("Core init, version ","0.13.1"," sdk version ",91001," appkey ",Ue.appkey),Pt}Ko(he,xe);var Fe=he.prototype;return Fe.emit=function(Ce){try{for(var Pt,ar,tr=wa(),fr=arguments.length,br=new Array(fr>1?fr-1:0),Nr=1;Nr<fr;Nr++)br[Nr-1]=arguments[Nr];var Fr=(Pt=xe.prototype.emit).call.apply(Pt,Hs(ar=[this,Ce]).call(ar,br)),jr=wa()-tr;return jr>=10&&this.logger.warn("Core::emit event: "+Ce+" process takes: "+jr+"ms"),Fr}catch(Vr){return this.logger.error("Core::emit event: "+Ce+". Error: "+Vr),!1}},Fe.connect=function(Ce,Pt){return Ce===void 0&&(Ce={}),Un(this,void 0,void 0,wr.mark(function ar(){var tr,fr,br,Nr,Fr,jr;return wr.wrap(function(Kr){for(;;)switch(Kr.prev=Kr.next){case 0:if(Qn({linkUrls:{type:"array",itemType:"string",required:!1}},Ce),/^(unconnected|waitReconnect)$/.test(this.status)){Kr.next=5;break}return tr="Core socket status is "+this.status+", and would not connect",this.logger.warn(tr),Kr.abrupt("return",wo.reject(tr));case 5:this.status="connecting",Ce.linkUrls&&Ce.linkUrls.length>0&&(this.linkUrls=Hs(fr=Ce.linkUrls).call(fr,this.linkUrls),this.linkUrls=Wp(this.linkUrls)),this.linkUrls.length===0&&this.linkUrls.push(Fv),br=0;case 9:if(!(br<this.linkUrls.length)){Kr.next=32;break}return Nr=this.linkUrls[br],Fr=new Date().getTime(),Kr.prev=12,Kr.next=15,this.doConnect(Nr);case 15:return this.status="connected",this.logger.log("core:: connect success with url: "+Nr),this.abtRequest(),Kr.abrupt("return",Nr);case 21:Kr.prev=21,Kr.t0=Kr.catch(12),jr=Kr.t0,Pt&&Pt(jr,Nr),this.reporter.reportTraceStart("exceptions",{user_id:this.options.account,start_time:Fr,action:0}),this.reporter.reportTraceUpdateV2("exceptions",{code:typeof jr.code=="number"?jr.code:0,description:jr.message||""+jr.code,operation_type:0,target:Nr}),this.reporter.reportTraceEnd("exceptions",1),this.logger.warn("core:: connect failed with url: "+Nr,Kr.t0);case 29:br++,Kr.next=9;break;case 32:throw this.retryCount===0?this.doDisconnect(us.ACTIVE,"SocketHandshakeFailed"):this.doDisconnect(us.OFFLINE,"ReconnectHadRetryAllLinks"),new Error("core: socket handshake failed");case 34:case"end":return Kr.stop()}},ar,this,[[12,21]])}))},Fe.doConnect=function(Ce){var Pt=this;return new wo(function(ar,tr){var fr;Pt.socket=new Kg(Pt,Ce,Pt.logger),Pt.socket.on("connect",function(){Pt.logger.log("socket on connect",Ce),ar()}),Pt.socket.on("message",Go(fr=Pt.onMessage).call(fr,Pt)),Pt.socket.on("disconnect",function(br){Pt.logger.log("core:: socket on disconnect",br),Pt.doDisconnect(us.OFFLINE,"SocketOnDisconnect")}),Pt.socket.on("handshakeFailed",function(){Pt.logger.warn("core:: socket handshake failed"),tr(new wc("handshake failed",{},408))})})},Fe.resetConnectStatus=function(){clearTimeout(this.reconnectTimer),this.backoff.reset(),this.retryCount=0,this.initOnlineListener()},Fe.doDisconnect=function(Ce,Pt){if(this.logger.log("doDisconnect: type "+Ce+", description "+Pt),this.status!=="unconnected"){this.markAllCmdInvaild(new wc("Packet timeout due to instance disconnect",{},408)),this.timerManager.destroy(),clearTimeout(this.pingTimer),this.socket&&(typeof this.socket.removeAllListeners=="function"&&this.socket.removeAllListeners(),typeof this.socket.close=="function"&&this.socket.close(),this.socket=void 0);var ar=!this.options.needReconnect||this.retryCount>=this.options.reconnectionAttempts;if(Ce===us.ACTIVE||ar)this.logger.log("doDisconnect: emit disconnect, type "+Ce,ar),this.status="unconnected",this.reconnectTimer&&clearTimeout(this.reconnectTimer),this.eventBus.emit("disconnect"),this.emit("disconnect"),this.destroyOnlineListener();else if(Ce===us.KICKED){this.logger.log("doDisconnect: kicked"),this.status="unconnected",this.reconnectTimer&&clearTimeout(this.reconnectTimer);var tr=typeof Pt=="string"?{reason:"unknow",message:Pt}:Pt;this.eventBus.emit("kicked",tr),this.emit("kicked",tr),this.destroyOnlineListener()}else Ce===us.OFFLINE?(this.logger.log("doDisconnect: start to reconnect"),this.attempToReconnect()):this.logger.log("doDisconnect: nothing to do")}else this.logger.warn("doDisconnect: already unconnected")},Fe.attempToReconnect=function(){var Ce=this;if(this.status!=="waitReconnect"){var Pt=this.backoff.duration();this.retryCount++,this.logger.log("willReconnect "+this.retryCount+" "+Pt),this.eventBus.emit("willReconnect",{retryCount:this.retryCount,duration:Pt}),this.emit("willReconnect",{retryCount:this.retryCount,duration:Pt}),this.status="waitReconnect",this.reconnectTimer&&clearTimeout(this.reconnectTimer),this.reconnectTimer=Ao(function(){Ce.status==="waitReconnect"?Ce.connect({isAutoReconnect:!0}).catch(function(){Ce.logger.error("core::attempToReconnect failed "+Ce.retryCount)}):Ce.logger.warn("doDisconnect: reconnectTimer status is "+Ce.status+", would not go on reconnecting")},Pt)}else this.logger.warn("doDisconnect: already is waiting reconnect")},Fe.sendCmd=function(Ce,Pt,ar){var tr=this;if(this.status!=="logined"&&Ce!=="login"&&Ce!=="chatroomLogin"&&Ce!=="qchatLogin")return this.logger.warn("nim status is "+this.status+", so can not sendCmd "+Ce),wo.reject({cmd:Ce,error:{code:"No_connected",message:"Connection not established",timetag:new Date().getTime()}});if(!this.socket||!this.socket.send)return wo.reject("No_socket");var fr=Ce!=="heartbeat",br=fr?this.packetSer++:0,Nr=function(En,In,Pn,Hn){var ho=eu[En];if(!ho)return Pn.error("createCmd:: can not find cmd config: ",En),null;var uo,Do={SER:In,SID:ho.sid,CID:ho.cid,Q:[]};return ho.params&&Hn&&Kn(uo=ho.params).call(uo,function(no){var zr=Hn[no.name];if(!Vv(zr)){var Jn=no.type,ro=no.reflectMapper;switch(no.type){case"PropertyArray":Jn="ArrayMable",zr=Ro(zr).call(zr,function(zn){return{t:"Property",v:ro?Od(zn,ro):zn}});break;case"Property":zr=ro?Od(zr,ro):zr;break;case"Bool":case"bool":zr=zr?"true":"false"}Do.Q.push({t:Jn,v:zr})}}),{packet:Do,isNoResponse:ho.isNoResponse||!1}}(Ce,br,this.logger,Pt);if(!Nr){var Fr="SendCmd "+br+" "+Ce+" error";return this.logger.error(Fr),wo.reject(Fr)}var jr=Nr.packet,Vr=Nr.isNoResponse,Kr=la(jr);fr&&(this.options.debugLevel==="debug"?this.logger.debug("core::sendCmd",Ce,"ser:"+br,Kr):this.logger.log("core::sendCmd",Ce,"ser:"+br));var Tn=new Date().getTime();return new wo(function(Mn,En){tr.sendingCmdMap.set(br,{cmd:Ce,params:Pt,callback:[Mn,En],timer:Vr?null:Ao(function(){var Pn,Hn=new Ip(504,Ce,"Packet Timeout",new Date().getTime(),{message:"ser "+br+" cmd "+Ce+" timeout"});Hn.callFunc="sendCmd",tr.markCmdInvalid(br,Hn,Ce),tr.reporter.reportTraceStart("exceptions",{user_id:tr.options.account,trace_id:(Pn=tr.socket)===null||Pn===void 0?void 0:Pn.sessionId,start_time:Tn,action:2}),tr.reporter.reportTraceUpdateV2("exceptions",{code:408,description:"Packet timeout",operation_type:1,target:jr.SID+"-"+jr.CID,context:""+jr.SER}),tr.reporter.reportTraceEnd("exceptions",1)},ar&&ar.timeout?ar.timeout:tr.config.timeout)});try{tr.socket.send(Kr)}catch(Pn){var In=new Ip(415,Ce,Pn&&Pn.message||"Unable to send packet",new Date().getTime(),{message:"send json error",rawError:Pn});In.callFunc="sendCmd",tr.markCmdInvalid(br,In,Ce),En(Pn)}})},Fe.onMessage=function(Ce){var Pt=Hv(Ce,this.logger);if(Pt){var ar=Pt.raw.ser;if(Pt.error&&this.logger.error("core:onMessage packet error",Pt.raw.sid+"_"+Pt.raw.cid+", ser:"+ar+",",Pt.error),!Pt.notFound)return Pt.cmd!=="heartbeat"&&(this.options.debugLevel==="debug"?this.logger.debug("imsocket::recvCmd ser:"+ar,Pt.cmd,Pt.content):this.logger.log("imsocket::recvCmd ser:"+ar,Pt.cmd)),Pt.__receiveTime=wa(),Pt;this.logger.warn("core::onMessage packet not found",Pt.raw.sid+"_"+Pt.raw.cid+", ser:"+ar)}},Fe.markCmdInvalid=function(Ce,Pt,ar){var tr=this.sendingCmdMap.get(Ce);if(tr){var fr=tr.callback,br=tr.timer;br&&clearTimeout(br),this.sendingCmdMap.delete(Ce),this.logger.warn("packet "+Ce+", "+ar+" is invalid:",Pt),fr[1](Pt)}},Fe.markAllCmdInvaild=function(Ce){var Pt;this.logger.log("markAllCmdInvaild"),Kn(Pt=this.sendingCmdMap).call(Pt,function(ar){var tr=ar.callback,fr=ar.timer;fr&&clearTimeout(fr),tr[1](Ce)}),this.sendingCmdMap.clear()},Fe.ping=function(){return Un(this,void 0,void 0,wr.mark(function Ce(){var Pt=this;return wr.wrap(function(tr){for(;;)switch(tr.prev=tr.next){case 0:return clearTimeout(this.pingTimer),tr.prev=1,tr.next=4,this.sendCmd("heartbeat");case 4:tr.next=14;break;case 6:return tr.prev=6,tr.t0=tr.catch(1),tr.next=10,this.testHeartBeat5Timeout();case 10:if(!tr.sent){tr.next=14;break}return this.doDisconnect(us.OFFLINE,"PingError"),tr.abrupt("return");case 14:this.pingTimer=Ao(function(){Pt.ping()},3e4);case 15:case"end":return tr.stop()}},Ce,this,[[1,6]])}))},Fe.testHeartBeat5Timeout=function(){return Un(this,void 0,void 0,wr.mark(function Ce(){var Pt;return wr.wrap(function(tr){for(;;)switch(tr.prev=tr.next){case 0:clearTimeout(this.pingTimer),Pt=0;case 2:if(!(Pt<5)){tr.next=15;break}return tr.prev=3,tr.next=6,this.sendCmd("heartbeat",{},{timeout:3e3});case 6:return tr.abrupt("return",!1);case 9:tr.prev=9,tr.t0=tr.catch(3),this.logger.debug("core:: test heartbeat "+Pt+" Timeout");case 12:Pt++,tr.next=2;break;case 15:return tr.abrupt("return",!0);case 16:case"end":return tr.stop()}},Ce,this,[[3,9]])}))},Fe.initOnlineListener=function(){var Ce,Pt;this.onlineListener||(Ps?(this.onlineListener=Go(Ce=function(){this.status==="logined"&&this.ping()}).call(Ce,this),this.offlineListener=Go(Pt=function(){this.logger.log("offline"),this.doDisconnect(us.OFFLINE,"OfflineListener")}).call(Pt,this),window.addEventListener("online",this.onlineListener),window.addEventListener("offline",this.offlineListener)):this.logger.warn("initOnlineListener not support add listener"))},Fe.destroyOnlineListener=function(){this.onlineListener&&(window.removeEventListener("online",this.onlineListener),this.onlineListener=void 0),this.offlineListener&&(window.removeEventListener("offline",this.offlineListener),this.offlineListener=void 0)},Fe.disconnect=function(){switch(this.status){case"connected":case"logined":case"connecting":case"waitReconnect":return this.doDisconnect(us.ACTIVE,"UserActiveDisconnect"),wo.resolve();case"unconnected":case"destroyed":return wo.resolve()}},Fe.destroy=function(){var Ce=this;return this.disconnect().then(function(){Ce.status="destroyed",Ce.removeAllListeners(),Ce.eventBus.removeAllListeners(),Ce.reporter.destroy(),Ce.connect=function(){return wo.resolve()},Ce.disconnect=function(){return wo.resolve()},Ce.destroy=function(){return wo.resolve()}})},Fe.abtRequest=function(){var Ce,Pt;return Un(this,void 0,void 0,wr.mark(function ar(){var tr,fr;return wr.wrap(function(Nr){for(;;)switch(Nr.prev=Nr.next){case 0:if(this.options.isAbtestEnable){Nr.next=2;break}return Nr.abrupt("return");case 2:if(!this.abtInfo.experiments){Nr.next=4;break}return Nr.abrupt("return");case 4:if(this.options.abtestUrl){Nr.next=6;break}return Nr.abrupt("return");case 6:return Nr.prev=6,Nr.next=9,this.adapters.request(this.options.abtestUrl,{method:"POST",dataType:"json",headers:{sdktype:"ABTest"},data:{clientInfo:{projectKey:this.options.abtestProjectKey,appKey:this.options.appkey,osType:"Web",sdkVersion:"0.13.1",deviceId:this.config.deviceId},useLocalCache:!0}});case 9:tr=Nr.sent,Nr.next=15;break;case 12:Nr.prev=12,Nr.t0=Nr.catch(6),this.logger.warn("ABTest request failed");case 15:this.abtInfo=((Pt=(Ce=tr==null?void 0:tr.data)===null||Ce===void 0?void 0:Ce.data)===null||Pt===void 0?void 0:Pt.abtInfo)||{},this.abtInfo.experiments&&this.abtInfo.experiments.length>0&&this.reporter.reportImmediately("https://statistic.live.126.net/statics/report/abtest/result",{params:{app_key:this.options.appkey,biz_sdk_type:"IM",sdk_ver:"0.13.1",device_id:this.config.deviceId,platform:"Web",projectKey:this.options.abtestProjectKey,experiments:Ro(fr=this.abtInfo.experiments).call(fr,function(Fr){return{experimentKey:Fr.experimentKey,schemeKey:Fr.schemeKey}})},headers:{sdktype:"ABTest"},method:"POST",dataType:"json"});case 17:case"end":return Nr.stop()}},ar,this,[[6,12]])}))},he}(pi);uy.setAdapters=function(he){Hr(sa,he)};var dy={"1_2":"heartbeat","2_3":"login","2_5":"kicked","2_6":"logout","2_7":"multiPortLogin","2_8":"kick"},py={login:{clientType:3,os:4,sdkVersion:6,appLogin:8,protocolVersion:9,pushTokenName:10,pushToken:11,deviceId:13,appkey:18,account:19,browser:24,session:26,deviceInfo:32,isReactNative:112,token:1e3,customTag:38,customClientType:39,sdkHumanVersion:40,sdkType:41,userAgent:42,authType:115,loginExt:116},loginRes:{lastLoginDeviceId:17,customTag:38,connectionId:102,ip:103,port:104,country:106,hasXMPush:111},loginPort:{type:3,os:4,mac:5,deviceId:13,account:19,deviceInfo:32,customTag:38,connectionId:102,ip:103,time:109},aosPushInfo:{pushType:110,hasTokenPreviously:111}},qd=Cs(py),fy={login:{sid:2,cid:3,service:"auth",params:[{type:"Property",name:"login",reflectMapper:py.login}],response:[{type:"Property",name:"loginRes",reflectMapper:qd.loginRes},{type:"PropertyArray",name:"loginPorts",reflectMapper:qd.loginPort},{type:"Property",name:"aosPushInfo",reflectMapper:qd.aosPushInfo}]},logout:{sid:2,cid:6,service:"auth"},heartbeat:{sid:1,cid:2,service:"auth"},kicked:{sid:2,cid:5,service:"auth",response:[{type:"Number",name:"clientType"},{type:"Number",name:"reason"},{type:"String",name:"ext"},{type:"Number",name:"customClientType"}]},multiPortLogin:{sid:2,cid:7,service:"auth",response:[{type:"Number",name:"state"},{type:"PropertyArray",name:"loginPorts",reflectMapper:qd.loginPort}]},kick:{sid:2,cid:8,service:"auth",params:[{type:"StrArray",name:"deviceIds"}],response:[{type:"StrArray",name:"deviceIds"}]}},qi=Array.isArray,rf=function(he){return typeof he=="symbol"||Di(he)&&Uc(he)=="[object Symbol]"},mh=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,nf=/^\w*$/,gh=function(he,Fe){if(qi(he))return!1;var Ue=typeof he;return!(Ue!="number"&&Ue!="symbol"&&Ue!="boolean"&&he!=null&&!rf(he))||nf.test(he)||!mh.test(he)||Fe!=null&&he in Object(Fe)};function hh(xe,he){if(typeof xe!="function"||he!=null&&typeof he!="function")throw new TypeError("Expected a function");var Fe=function(){var Ue=arguments,Ce=he?he.apply(this,Ue):Ue[0],Pt=Fe.cache;if(Pt.has(Ce))return Pt.get(Ce);var ar=xe.apply(this,Ue);return Fe.cache=Pt.set(Ce,ar)||Pt,ar};return Fe.cache=new(hh.Cache||jp),Fe}hh.Cache=jp;var iS=hh,cS=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,lS=/\\(\\)?/g,du=function(he){var Fe=iS(he,function(Ce){return Ue.size===500&&Ue.clear(),Ce}),Ue=Fe.cache;return Fe}(function(xe){var he=[];return xe.charCodeAt(0)===46&&he.push(""),xe.replace(cS,function(Fe,Ue,Ce,Pt){he.push(Ce?Pt.replace(lS,"$1"):Ue||Fe)}),he}),of=du,gy=vi?vi.prototype:void 0,vh=gy?gy.toString:void 0,hy=function xe(he){if(typeof he=="string")return he;if(qi(he))return nh(he,xe)+"";if(rf(he))return vh?vh.call(he):"";var Fe=he+"";return Fe=="0"&&1/he==-1/0?"-0":Fe},uS=function(he){return he==null?"":hy(he)},Vd=function(he,Fe){return qi(he)?he:gh(he,Fe)?[he]:of(uS(he))},Rl=function(he){if(typeof he=="string"||rf(he))return he;var Fe=he+"";return Fe=="0"&&1/he==-1/0?"-0":Fe},yh=function(he,Fe){for(var Ue=0,Ce=(Fe=Vd(Fe,he)).length;he!=null&&Ue<Ce;)he=he[Rl(Fe[Ue++])];return Ue&&Ue==Ce?he:void 0},Zs=function(he,Fe,Ue){var Ce=he==null?void 0:yh(he,Fe);return Ce===void 0?Ue:Ce},rc={debugLevel:"off",needReconnect:!0,reconnectionAttempts:Cg,lbsUrls:["https://lbs.netease.im/lbs/webconf.jsp"],linkUrl:Fv,isAbtestEnable:!0,abtestUrl:"https://abt-online.netease.im/v1/api/abt/client/getExperimentInfo",abtestProjectKey:"imElite_sdk_abtest_web"},af={},ns=function(xe){function he(Ue,Ce){var Pt,ar;Ce===void 0&&(Ce={serverConfig:{},syncOptions:{},sessionConfig:{}}),(ar=xe.call(this,Ue)||this).instanceName="NIM",ar.account="",ar.options={},ar.auth={},ar.offlinePush={},ar.sync={},ar.msg={},ar.msgLog={},ar.session={},ar.cloudSession={},ar.misc={},ar.user={},ar.friend={},ar.systemMessage={},ar.team={},ar.event={},ar.msgExtend={},ar.cloudStorage={},ar.passThrough={},ar.superTeam={},ar.plugin={},ar.signaling={},ar.setOptions(Ue),ls({cmdMap:dy,cmdConfig:fy});var tr=null;return Kn(Pt=aa(af)).call(Pt,function(fr){var br=af[fr];fr==="sync"?tr=br:ar[fr]=fr==="session"?new br(k(ar),Ce.sessionConfig):fr==="cloudStorage"?new br(k(ar),Hr({storageKeyPrefix:ar.instanceName},Ce.serverConfig,Ce.cloudStorageConfig)):new br(k(ar))}),tr&&(ar.sync=new tr(k(ar),Ce.syncOptions)),he.instance=k(ar),ar}Ko(he,xe),he.getInstance=function(Ce,Pt){if(!he.instance){if(Ce)return new he(Ce,Pt);throw new Error("Instance not exist, please input options")}if(Ce){if(he.instance.options.account===Ce.account&&he.instance.options.appkey===Ce.appkey)return he.instance.setOptions(Ce),he.instance;throw new Error("Unexpected login")}return he.instance};var Fe=he.prototype;return Fe.setOptions=function(Ce){Qn({account:{type:"string"},appkey:{type:"string"},token:{type:"string"},needReconnect:{type:"boolean",required:!1},reconnectionAttempts:{type:"number",required:!1},customClientType:{type:"number",min:1,required:!1},authType:{type:"number",min:0,max:2,required:!1},lbsUrls:{type:"array",itemType:"string",min:1,required:!1},linkUrl:{type:"string",allowEmpty:!1,required:!1}},Ce),this.logger.log("NIM::setOptions options is",Ce),this.account=Ce.account,this.options=Hr(Hr({},rc),Ce)},Fe.connect=function(Ce){Ce===void 0&&(Ce={});var Pt=vs(null,{connect:{get:function(){return xe.prototype.connect}}});return Un(this,void 0,void 0,wr.mark(function ar(){var tr,fr,br=this;return wr.wrap(function(Fr){for(;;)switch(Fr.prev=Fr.next){case 0:if(/^(unconnected|waitReconnect)$/.test(this.status)){Fr.next=4;break}return tr="NIM status is "+this.status+", and would not connect",this.logger.warn(tr),Fr.abrupt("return",wo.reject(tr));case 4:return this.reporter.reportTraceCancel("login"),this.reporter.reportTraceStart("login",{user_id:this.options.account,action:Ce.isAutoReconnect?"auto_login":"manual_login"}),this.reporter.reportTraceUpdateV2("login",{code:0,description:la(Hr(Hr({},this.options),{account:"***",token:"***"})),operation_type:"conf_init",succeed:!0,duration:0,target:""}),Fr.next=9,this.getLbsInfos();case 9:return Fr.prev=9,Fr.next=12,Pt.connect.call(this,Ce,function(jr,Vr){br.reporter.reportTraceUpdateV2("login",{operation_type:"TCP",target:Vr,code:jr.code||408,description:"ws_handshake_failed:"+jr.message,succeed:!1})});case 12:(fr=Fr.sent)&&this.reporter.reportTraceUpdateV2("login",{operation_type:"TCP",target:fr,code:200,succeed:!0}),Fr.next=20;break;case 16:throw Fr.prev=16,Fr.t0=Fr.catch(9),this.reporter.reportTraceEnd("login",!1),Fr.t0;case 20:return Fr.next=22,this.login(Ce.isAutoReconnect);case 22:case"end":return Fr.stop()}},ar,this,[[9,16]])}))},Fe.login=function(Ce){return Ce===void 0&&(Ce=!1),Un(this,void 0,void 0,wr.mark(function Pt(){var ar,tr;return wr.wrap(function(br){for(;;)switch(br.prev=br.next){case 0:return br.prev=0,br.next=3,this.auth.doLogin(Ce);case 3:ar=br.sent,this.reporter.reportTraceUpdateV2("login",{operation_type:"protocol",target:"2-3",code:200,succeed:!0}),this.reporter.reportTraceEnd("login",!0),this.status="logined",br.next=20;break;case 9:if(br.prev=9,br.t0=br.catch(0),tr=br.t0,this.logger.warn("nim login:: login failed",br.t0),this.reporter.reportTraceUpdateV2("login",{operation_type:"protocol",target:"2-3",code:tr.code||0,succeed:!1,description:tr.message}),this.reporter.reportTraceEnd("login",!1),this.retryCount!==0){br.next=18;break}throw this.doDisconnect(us.ACTIVE,"FailedToInitializeLogin"),br.t0;case 18:return this.doDisconnect(us.OFFLINE,"ReconnectLoginFailed"),br.abrupt("return");case 20:return br.prev=20,br.next=23,this.cloudStorage.init();case 23:br.next=28;break;case 25:br.prev=25,br.t1=br.catch(20),this.logger.error("NIM:login cloudStorage init failed ",br.t1);case 28:if(this.eventBus.emit("logined",ar),this.emit("logined",ar),this.logger.log("login done"),this.resetConnectStatus(),!this.sync||!this.sync.doSync){br.next=35;break}return br.next=35,this.sync.doSync();case 35:this.ping();case 36:case"end":return br.stop()}},Pt,this,[[0,9],[20,25]])}))},Fe.onMessage=function(Ce){var Pt,ar,tr=xe.prototype.onMessage.call(this,Ce);if(tr){var fr=tr.raw.ser,br=this.sendingCmdMap.get(fr);if(br&&br.cmd===tr.cmd){var Nr=br.callback,Fr=br.timer,jr=br.params;if(clearTimeout(Fr),tr.params=jr,this.sendingCmdMap.delete(fr),tr.cmd==="heartbeat")return void Nr[0]();var Vr=(Pt=this[tr.service])===null||Pt===void 0?void 0:Pt.process(tr);Vr&&typeof Vr.then=="function"?Vr.then(function(Kr){Nr[0](Kr)}).catch(function(Kr){Nr[1](Kr)}):(this.logger.log("imsocket:: handlerFn without promise",tr.service,tr.cmd),Nr[0]())}else(ar=this[tr.service])===null||ar===void 0||ar.process(tr)}},Fe.getLbsInfos=function(){var Ce;return Un(this,void 0,void 0,wr.mark(function Pt(){var ar,tr,fr,br,Nr,Fr,jr,Vr,Kr;return wr.wrap(function(Mn){for(;;)switch(Mn.prev=Mn.next){case 0:return ar=this.options.lbsUrls[0],tr=Va(ar).call(ar,"?")>-1?"&":"?",fr=ar+tr+"k="+this.options.appkey+"&id="+this.options.account+"&sv=180&pv=1&networkType=0",Mn.prev=3,this.logger.log("getLbsInfos ",fr),Mn.next=7,this.adapters.request(fr,{method:"GET",dataType:"json",timeout:1e4});case 7:if((Nr=Mn.sent).status===200&&Nr.data){Mn.next=11;break}throw this.logger.error("getLbsInfos::error status",Nr.status,Nr),new Error("getLbsInfos failed, status "+Nr.status);case 11:this.reporter.reportTraceUpdateV2("login",{operation_type:"HTTP",target:fr,code:200,succeed:!0}),Fr=Nr.data,jr=[this.options.linkUrl],Zs(Fr,"common.link")&&(jr=Hs(Vr=Zs(Fr,"common.link")).call(Vr,jr)),Zs(Fr,'common["link.default"]')&&(jr=Hs(jr).call(jr,Zs(Fr,'common["link.default"]'))),this.linkUrls=Wp(jr),Nr.data["nos-chunk"]&&((Ce=this.cloudStorage)===null||Ce===void 0||Ce.setOptions({chunkUploadHost:Nr.data["nos-chunk"]})),this.logger.log("getLbsInfos success, socket link:",Fo(br=this.linkUrls).call(br,0),"chunkUploadHost: ",Nr.data["nos-chunk"]),Mn.next=27;break;case 21:Mn.prev=21,Mn.t0=Mn.catch(3),Kr=Mn.t0,this.logger.error("getLbsInfos::error",Kr),this.linkUrls=[this.options.linkUrl],this.reporter.reportTraceUpdateV2("login",{operation_type:"HTTP",target:fr,description:Kr.message,code:Kr.code||0,succeed:!1});case 27:case"end":return Mn.stop()}},Pt,this,[[3,21]])}))},Fe.disconnect=function(){var Ce=this;switch(this.status){case"logined":return this.sendCmd("logout",void 0,{timeout:1e3}).then(function(){xe.prototype.doDisconnect.call(Ce,us.ACTIVE,"UserActiveDisconnect")}).catch(function(Pt){Ce.logger.error("NIM::disconnect sendCmd:logout error",Pt),xe.prototype.doDisconnect.call(Ce,us.ACTIVE,"UserActiveDisconnect")});case"connected":case"connecting":case"waitReconnect":return xe.prototype.doDisconnect.call(this,us.ACTIVE,"UserActiveDisconnect"),wo.resolve();case"unconnected":case"destroyed":return wo.resolve()}},Fe.destroy=function(){return he.instance=null,xe.prototype.destroy.call(this)},Fe.kick=function(Ce){return Qn({deviceIds:{type:"array",itemType:"string"}},Ce),this.auth.kick(Ce)},he.registerService=function(Ce,Pt){af[Pt]=Ce},he}(uy);ns.instance=null;var vy=Math.min,bh=[].lastIndexOf,Th=!!bh&&1/[1].lastIndexOf(1,-0)<0,dS=li("lastIndexOf"),Sh=Th||!dS?function(he){if(Th)return le(bh,this,arguments)||0;var Fe=Pr(this),Ue=Ka(Fe),Ce=Ue-1;for(arguments.length>1&&(Ce=vy(Ce,sc(arguments[1]))),Ce<0&&(Ce=Ue+Ce);Ce>=0;Ce--)if(Ce in Fe&&Fe[Ce]===he)return Ce||0;return-1}:bh;_n({target:"Array",proto:!0,forced:Sh!==[].lastIndexOf},{lastIndexOf:Sh});var pS=na("Array").lastIndexOf,sf=Array.prototype,Mh=function(xe){var he=xe.lastIndexOf;return xe===sf||vr(sf,xe)&&he===sf.lastIndexOf?pS:he},pu=g(function(xe,he){(function(){var Fe={function:!0,object:!0}[typeof window]&&window||this,Ue=he,Ce=xe&&!xe.nodeType&&xe,Pt=Ue&&Ce&&typeof e=="object"&&e;!Pt||Pt.global!==Pt&&Pt.window!==Pt&&Pt.self!==Pt||(Fe=Pt);var ar=Math.pow(2,53)-1,tr=/\bOpera/,fr=Object.prototype,br=fr.hasOwnProperty,Nr=fr.toString;function Fr(Pn){return(Pn=String(Pn)).charAt(0).toUpperCase()+Pn.slice(1)}function jr(Pn){return Pn=En(Pn),/^(?:webOS|i(?:OS|P))/.test(Pn)?Pn:Fr(Pn)}function Vr(Pn,Hn){for(var ho in Pn)br.call(Pn,ho)&&Hn(Pn[ho],ho,Pn)}function Kr(Pn){return Pn==null?Fr(Pn):Nr.call(Pn).slice(8,-1)}function Tn(Pn){return String(Pn).replace(/([ -])(?!$)/g,"$1?")}function Mn(Pn,Hn){var ho=null;return function(Do,no){var zr=-1,Jn=Do?Do.length:0;if(typeof Jn=="number"&&Jn>-1&&Jn<=ar)for(;++zr<Jn;)no(Do[zr],zr,Do);else Vr(Do,no)}(Pn,function(uo,Do){ho=Hn(ho,uo,Do,Pn)}),ho}function En(Pn){return String(Pn).replace(/^ +| +$/g,"")}var In=function Pn(Hn){var ho=Fe,uo=Hn&&typeof Hn=="object"&&Kr(Hn)!="String";uo&&(ho=Hn,Hn=null);var Do=ho.navigator||{},no=Do.userAgent||"";Hn||(Hn=no);var zr,Jn,ro=uo?!!Do.likeChrome:/\bChrome\b/.test(Hn)&&!/internal|\n/i.test(Nr.toString()),zn="Object",Ln=uo?zn:"ScriptBridgingProxyObject",eo=uo?zn:"Environment",co=uo&&ho.java?"JavaPackage":Kr(ho.java),So=uo?zn:"RuntimeObject",Mo=/\bJava/.test(co)&&ho.java,ca=Mo&&Kr(ho.environment)==eo,zo=Mo?"a":"α",ss=Mo?"b":"β",$o=ho.document||{},Wo=ho.operamini||ho.opera,Ma=tr.test(Ma=uo&&Wo?Wo["[[Class]]"]:Kr(Wo))?Ma:Wo=null,sl=Hn,Jo=[],jc=null,fs=Hn==no,_o=fs&&Wo&&typeof Wo.version=="function"&&Wo.version(),Ca=function(ts){return Mn(ts,function(ja,za){return ja||RegExp("\\b"+(za.pattern||Tn(za))+"\\b","i").exec(Hn)&&(za.label||za)})}([{label:"EdgeHTML",pattern:"Edge"},"Trident",{label:"WebKit",pattern:"AppleWebKit"},"iCab","Presto","NetFront","Tasman","KHTML","Gecko"]),fo=function(ts){return Mn(ts,function(ja,za){return ja||RegExp("\\b"+(za.pattern||Tn(za))+"\\b","i").exec(Hn)&&(za.label||za)})}(["Adobe AIR","Arora","Avant Browser","Breach","Camino","Electron","Epiphany","Fennec","Flock","Galeon","GreenBrowser","iCab","Iceweasel","K-Meleon","Konqueror","Lunascape","Maxthon",{label:"Microsoft Edge",pattern:"(?:Edge|Edg|EdgA|EdgiOS)"},"Midori","Nook Browser","PaleMoon","PhantomJS","Raven","Rekonq","RockMelt",{label:"Samsung Internet",pattern:"SamsungBrowser"},"SeaMonkey",{label:"Silk",pattern:"(?:Cloud9|Silk-Accelerated)"},"Sleipnir","SlimBrowser",{label:"SRWare Iron",pattern:"Iron"},"Sunrise","Swiftfox","Vivaldi","Waterfox","WebPositive",{label:"Yandex Browser",pattern:"YaBrowser"},{label:"UC Browser",pattern:"UCBrowser"},"Opera Mini",{label:"Opera Mini",pattern:"OPiOS"},"Opera",{label:"Opera",pattern:"OPR"},"Chromium","Chrome",{label:"Chrome",pattern:"(?:HeadlessChrome)"},{label:"Chrome Mobile",pattern:"(?:CriOS|CrMo)"},{label:"Firefox",pattern:"(?:Firefox|Minefield)"},{label:"Firefox for iOS",pattern:"FxiOS"},{label:"IE",pattern:"IEMobile"},{label:"IE",pattern:"MSIE"},"Safari"]),oa=YM([{label:"BlackBerry",pattern:"BB10"},"BlackBerry",{label:"Galaxy S",pattern:"GT-I9000"},{label:"Galaxy S2",pattern:"GT-I9100"},{label:"Galaxy S3",pattern:"GT-I9300"},{label:"Galaxy S4",pattern:"GT-I9500"},{label:"Galaxy S5",pattern:"SM-G900"},{label:"Galaxy S6",pattern:"SM-G920"},{label:"Galaxy S6 Edge",pattern:"SM-G925"},{label:"Galaxy S7",pattern:"SM-G930"},{label:"Galaxy S7 Edge",pattern:"SM-G935"},"Google TV","Lumia","iPad","iPod","iPhone","Kindle",{label:"Kindle Fire",pattern:"(?:Cloud9|Silk-Accelerated)"},"Nexus","Nook","PlayBook","PlayStation Vita","PlayStation","TouchPad","Transformer",{label:"Wii U",pattern:"WiiU"},"Wii","Xbox One",{label:"Xbox 360",pattern:"Xbox"},"Xoom"]),Os=function(ts){return Mn(ts,function(ja,za,vv){return ja||(za[oa]||za[/^[a-z]+(?: +[a-z]+\b)*/i.exec(oa)]||RegExp("\\b"+Tn(vv)+"(?:\\b|\\w*\\d)","i").exec(Hn))&&vv})}({Apple:{iPad:1,iPhone:1,iPod:1},Alcatel:{},Archos:{},Amazon:{Kindle:1,"Kindle Fire":1},Asus:{Transformer:1},"Barnes & Noble":{Nook:1},BlackBerry:{PlayBook:1},Google:{"Google TV":1,Nexus:1},HP:{TouchPad:1},HTC:{},Huawei:{},Lenovo:{},LG:{},Microsoft:{Xbox:1,"Xbox One":1},Motorola:{Xoom:1},Nintendo:{"Wii U":1,Wii:1},Nokia:{Lumia:1},Oppo:{},Samsung:{"Galaxy S":1,"Galaxy S2":1,"Galaxy S3":1,"Galaxy S4":1},Sony:{PlayStation:1,"PlayStation Vita":1},Xiaomi:{Mi:1,Redmi:1}}),vo=function(ts){return Mn(ts,function(ja,za){var vv=za.pattern||Tn(za);return!ja&&(ja=RegExp("\\b"+vv+"(?:/[\\d.]+|[ \\w.]*)","i").exec(Hn))&&(ja=function(Wl,GM,KM){var QM={"10.0":"10",6.4:"10 Technical Preview",6.3:"8.1",6.2:"8",6.1:"Server 2008 R2 / 7","6.0":"Server 2008 / Vista",5.2:"Server 2003 / XP 64-bit",5.1:"XP",5.01:"2000 SP1","5.0":"2000","4.0":"NT","4.90":"ME"};return GM&&KM&&/^Win/i.test(Wl)&&!/^Windows Phone /i.test(Wl)&&(QM=QM[/[\d.]+$/.exec(Wl)])&&(Wl="Windows "+QM),Wl=String(Wl),GM&&KM&&(Wl=Wl.replace(RegExp(GM,"i"),KM)),jr(Wl.replace(/ ce$/i," CE").replace(/\bhpw/i,"web").replace(/\bMacintosh\b/,"Mac OS").replace(/_PowerPC\b/i," OS").replace(/\b(OS X) [^ \d]+/i,"$1").replace(/\bMac (OS X)\b/,"$1").replace(/\/(\d)/," $1").replace(/_/g,".").replace(/(?: BePC|[ .]*fc[ \d.]+)$/i,"").replace(/\bx86\.64\b/gi,"x86_64").replace(/\b(Windows Phone) OS\b/,"$1").replace(/\b(Chrome OS \w+) [\d.]+\b/,"$1").split(" on ")[0])}(ja,vv,za.label||za)),ja})}(["Windows Phone","KaiOS","Android","CentOS",{label:"Chrome OS",pattern:"CrOS"},"Debian",{label:"DragonFly BSD",pattern:"DragonFly"},"Fedora","FreeBSD","Gentoo","Haiku","Kubuntu","Linux Mint","OpenBSD","Red Hat","SuSE","Ubuntu","Xubuntu","Cygwin","Symbian OS","hpwOS","webOS ","webOS","Tablet OS","Tizen","Linux","Mac OS X","Macintosh","Mac","Windows 98;","Windows "]);function YM(ki){return Mn(ki,function(ts,ja){var za=ja.pattern||Tn(ja);return!ts&&(ts=RegExp("\\b"+za+" *\\d+[.\\w_]*","i").exec(Hn)||RegExp("\\b"+za+" *\\w+-[\\w]*","i").exec(Hn)||RegExp("\\b"+za+"(?:; *(?:[a-z]+[_-])?[a-z]+\\d+|[^ ();-]*)","i").exec(Hn))&&((ts=String(ja.label&&!RegExp(za,"i").test(ja.label)?ja.label:ts).split("/"))[1]&&!/[\d.]+/.test(ts[0])&&(ts[0]+=" "+ts[1]),ja=ja.label||ja,ts=jr(ts[0].replace(RegExp(za,"i"),ja).replace(RegExp("; *(?:"+ja+"[_-])?","i")," ").replace(RegExp("("+ja+")[-_.]?(\\w)","i"),"$1 $2"))),ts})}function XM(ki){return Mn(ki,function(ts,ja){return ts||(RegExp(ja+"(?:-[\\d.]+/|(?: for [\\w-]+)?[ /-])([\\d.]+[^ ();/_-]*)","i").exec(Hn)||0)[1]||null})}if(Ca&&(Ca=[Ca]),/\bAndroid\b/.test(vo)&&!oa&&(zr=/\bAndroid[^;]*;(.*?)(?:Build|\) AppleWebKit)\b/i.exec(Hn))&&(oa=En(zr[1]).replace(/^[a-z]{2}-[a-z]{2};\s*/i,"")||null),Os&&!oa?oa=YM([Os]):Os&&oa&&(oa=oa.replace(RegExp("^("+Tn(Os)+")[-_.\\s]","i"),Os+" ").replace(RegExp("^("+Tn(Os)+")[-_.]?(\\w)","i"),Os+" $2")),(zr=/\bGoogle TV\b/.exec(oa))&&(oa=zr[0]),/\bSimulator\b/i.test(Hn)&&(oa=(oa?oa+" ":"")+"Simulator"),fo=="Opera Mini"&&/\bOPiOS\b/.test(Hn)&&Jo.push("running in Turbo/Uncompressed mode"),fo=="IE"&&/\blike iPhone OS\b/.test(Hn)?(Os=(zr=Pn(Hn.replace(/like iPhone OS/,""))).manufacturer,oa=zr.product):/^iP/.test(oa)?(fo||(fo="Safari"),vo="iOS"+((zr=/ OS ([\d_]+)/i.exec(Hn))?" "+zr[1].replace(/_/g,"."):"")):fo=="Konqueror"&&/^Linux\b/i.test(vo)?vo="Kubuntu":Os&&Os!="Google"&&(/Chrome/.test(fo)&&!/\bMobile Safari\b/i.test(Hn)||/\bVita\b/.test(oa))||/\bAndroid\b/.test(vo)&&/^Chrome/.test(fo)&&/\bVersion\//i.test(Hn)?(fo="Android Browser",vo=/\bAndroid\b/.test(vo)?vo:"Android"):fo=="Silk"?(/\bMobi/i.test(Hn)||(vo="Android",Jo.unshift("desktop mode")),/Accelerated *= *true/i.test(Hn)&&Jo.unshift("accelerated")):fo=="UC Browser"&&/\bUCWEB\b/.test(Hn)?Jo.push("speed mode"):fo=="PaleMoon"&&(zr=/\bFirefox\/([\d.]+)\b/.exec(Hn))?Jo.push("identifying as Firefox "+zr[1]):fo=="Firefox"&&(zr=/\b(Mobile|Tablet|TV)\b/i.exec(Hn))?(vo||(vo="Firefox OS"),oa||(oa=zr[1])):!fo||(zr=!/\bMinefield\b/i.test(Hn)&&/\b(?:Firefox|Safari)\b/.exec(fo))?(fo&&!oa&&/[\/,]|^[^(]+?\)/.test(Hn.slice(Hn.indexOf(zr+"/")+8))&&(fo=null),(zr=oa||Os||vo)&&(oa||Os||/\b(?:Android|Symbian OS|Tablet OS|webOS)\b/.test(vo))&&(fo=/[a-z]+(?: Hat)?/i.exec(/\bAndroid\b/.test(vo)?vo:zr)+" Browser")):fo=="Electron"&&(zr=(/\bChrome\/([\d.]+)\b/.exec(Hn)||0)[1])&&Jo.push("Chromium "+zr),_o||(_o=XM(["(?:Cloud9|CriOS|CrMo|Edge|Edg|EdgA|EdgiOS|FxiOS|HeadlessChrome|IEMobile|Iron|Opera ?Mini|OPiOS|OPR|Raven|SamsungBrowser|Silk(?!/[\\d.]+$)|UCBrowser|YaBrowser)","Version",Tn(fo),"(?:Firefox|Minefield|NetFront)"])),(zr=(Ca=="iCab"&&parseFloat(_o)>3?"WebKit":/\bOpera\b/.test(fo)&&(/\bOPR\b/.test(Hn)?"Blink":"Presto"))||/\b(?:Midori|Nook|Safari)\b/i.test(Hn)&&!/^(?:Trident|EdgeHTML)$/.test(Ca)&&"WebKit"||!Ca&&/\bMSIE\b/i.test(Hn)&&(vo=="Mac OS"?"Tasman":"Trident")||Ca=="WebKit"&&/\bPlayStation\b(?! Vita\b)/i.test(fo)&&"NetFront")&&(Ca=[zr]),fo=="IE"&&(zr=(/; *(?:XBLWP|ZuneWP)(\d+)/i.exec(Hn)||0)[1])?(fo+=" Mobile",vo="Windows Phone "+(/\+$/.test(zr)?zr:zr+".x"),Jo.unshift("desktop mode")):/\bWPDesktop\b/i.test(Hn)?(fo="IE Mobile",vo="Windows Phone 8.x",Jo.unshift("desktop mode"),_o||(_o=(/\brv:([\d.]+)/.exec(Hn)||0)[1])):fo!="IE"&&Ca=="Trident"&&(zr=/\brv:([\d.]+)/.exec(Hn))&&(fo&&Jo.push("identifying as "+fo+(_o?" "+_o:"")),fo="IE",_o=zr[1]),fs){if(function(ts,ja){var za=ts!=null?typeof ts[ja]:"number";return!(/^(?:boolean|number|string|undefined)$/.test(za)||za=="object"&&!ts[ja])}(ho,"global"))if(Mo&&(sl=(zr=Mo.lang.System).getProperty("os.arch"),vo=vo||zr.getProperty("os.name")+" "+zr.getProperty("os.version")),ca){try{_o=ho.require("ringo/engine").version.join("."),fo="RingoJS"}catch{(zr=ho.system)&&zr.global.system==ho.system&&(fo="Narwhal",vo||(vo=zr[0].os||null))}fo||(fo="Rhino")}else typeof ho.process=="object"&&!ho.process.browser&&(zr=ho.process)&&(typeof zr.versions=="object"&&(typeof zr.versions.electron=="string"?(Jo.push("Node "+zr.versions.node),fo="Electron",_o=zr.versions.electron):typeof zr.versions.nw=="string"&&(Jo.push("Chromium "+_o,"Node "+zr.versions.node),fo="NW.js",_o=zr.versions.nw)),fo||(fo="Node.js",sl=zr.arch,vo=zr.platform,_o=(_o=/[\d.]+/.exec(zr.version))?_o[0]:null));else Kr(zr=ho.runtime)==Ln?(fo="Adobe AIR",vo=zr.flash.system.Capabilities.os):Kr(zr=ho.phantom)==So?(fo="PhantomJS",_o=(zr=zr.version||null)&&zr.major+"."+zr.minor+"."+zr.patch):typeof $o.documentMode=="number"&&(zr=/\bTrident\/(\d+)/i.exec(Hn))?(_o=[_o,$o.documentMode],(zr=+zr[1]+4)!=_o[1]&&(Jo.push("IE "+_o[1]+" mode"),Ca&&(Ca[1]=""),_o[1]=zr),_o=fo=="IE"?String(_o[1].toFixed(1)):_o[0]):typeof $o.documentMode=="number"&&/^(?:Chrome|Firefox)\b/.test(fo)&&(Jo.push("masking as "+fo+" "+_o),fo="IE",_o="11.0",Ca=["Trident"],vo="Windows");vo=vo&&jr(vo)}if(_o&&(zr=/(?:[ab]|dp|pre|[ab]\d+pre)(?:\d+\+?)?$/i.exec(_o)||/(?:alpha|beta)(?: ?\d)?/i.exec(Hn+";"+(fs&&Do.appMinorVersion))||/\bMinefield\b/i.test(Hn)&&"a")&&(jc=/b/i.test(zr)?"beta":"alpha",_o=_o.replace(RegExp(zr+"\\+?$"),"")+(jc=="beta"?ss:zo)+(/\d+\+?/.exec(zr)||"")),fo=="Fennec"||fo=="Firefox"&&/\b(?:Android|Firefox OS|KaiOS)\b/.test(vo))fo="Firefox Mobile";else if(fo=="Maxthon"&&_o)_o=_o.replace(/\.[\d.]+/,".x");else if(/\bXbox\b/i.test(oa))oa=="Xbox 360"&&(vo=null),oa=="Xbox 360"&&/\bIEMobile\b/.test(Hn)&&Jo.unshift("mobile mode");else if(!/^(?:Chrome|IE|Opera)$/.test(fo)&&(!fo||oa||/Browser|Mobi/.test(fo))||vo!="Windows CE"&&!/Mobi/i.test(Hn))if(fo=="IE"&&fs)try{ho.external===null&&Jo.unshift("platform preview")}catch{Jo.unshift("embedded")}else(/\bBlackBerry\b/.test(oa)||/\bBB10\b/.test(Hn))&&(zr=(RegExp(oa.replace(/ +/g," *")+"/([.\\d]+)","i").exec(Hn)||0)[1]||_o)?(vo=((zr=[zr,/BB10/.test(Hn)])[1]?(oa=null,Os="BlackBerry"):"Device Software")+" "+zr[0],_o=null):this!=Vr&&oa!="Wii"&&(fs&&Wo||/Opera/.test(fo)&&/\b(?:MSIE|Firefox)\b/i.test(Hn)||fo=="Firefox"&&/\bOS X (?:\d+\.){2,}/.test(vo)||fo=="IE"&&(vo&&!/^Win/.test(vo)&&_o>5.5||/\bWindows XP\b/.test(vo)&&_o>8||_o==8&&!/\bTrident\b/.test(Hn)))&&!tr.test(zr=Pn.call(Vr,Hn.replace(tr,"")+";"))&&zr.name&&(zr="ing as "+zr.name+((zr=zr.version)?" "+zr:""),tr.test(fo)?(/\bIE\b/.test(zr)&&vo=="Mac OS"&&(vo=null),zr="identify"+zr):(zr="mask"+zr,fo=Ma?jr(Ma.replace(/([a-z])([A-Z])/g,"$1 $2")):"Opera",/\bIE\b/.test(zr)&&(vo=null),fs||(_o=null)),Ca=["Presto"],Jo.push(zr));else fo+=" Mobile";(zr=(/\bAppleWebKit\/([\d.]+\+?)/i.exec(Hn)||0)[1])&&(zr=[parseFloat(zr.replace(/\.(\d)$/,".0$1")),zr],fo=="Safari"&&zr[1].slice(-1)=="+"?(fo="WebKit Nightly",jc="alpha",_o=zr[1].slice(0,-1)):_o!=zr[1]&&_o!=(zr[2]=(/\bSafari\/([\d.]+\+?)/i.exec(Hn)||0)[1])||(_o=null),zr[1]=(/\b(?:Headless)?Chrome\/([\d.]+)/i.exec(Hn)||0)[1],zr[0]==537.36&&zr[2]==537.36&&parseFloat(zr[1])>=28&&Ca=="WebKit"&&(Ca=["Blink"]),fs&&(ro||zr[1])?(Ca&&(Ca[1]="like Chrome"),zr=zr[1]||((zr=zr[0])<530?1:zr<532?2:zr<532.05?3:zr<533?4:zr<534.03?5:zr<534.07?6:zr<534.1?7:zr<534.13?8:zr<534.16?9:zr<534.24?10:zr<534.3?11:zr<535.01?12:zr<535.02?"13+":zr<535.07?15:zr<535.11?16:zr<535.19?17:zr<536.05?18:zr<536.1?19:zr<537.01?20:zr<537.11?"21+":zr<537.13?23:zr<537.18?24:zr<537.24?25:zr<537.36?26:Ca!="Blink"?"27":"28")):(Ca&&(Ca[1]="like Safari"),zr=(zr=zr[0])<400?1:zr<500?2:zr<526?3:zr<533?4:zr<534?"4+":zr<535?5:zr<537?6:zr<538?7:zr<601?8:zr<602?9:zr<604?10:zr<606?11:zr<608?12:"12"),Ca&&(Ca[1]+=" "+(zr+=typeof zr=="number"?".x":/[.+]/.test(zr)?"":"+")),fo=="Safari"&&(!_o||parseInt(_o)>45)?_o=zr:fo=="Chrome"&&/\bHeadlessChrome/i.test(Hn)&&Jo.unshift("headless")),fo=="Opera"&&(zr=/\bzbov|zvav$/.exec(vo))?(fo+=" ",Jo.unshift("desktop mode"),zr=="zvav"?(fo+="Mini",_o=null):fo+="Mobile",vo=vo.replace(RegExp(" *"+zr+"$"),"")):fo=="Safari"&&/\bChrome\b/.exec(Ca&&Ca[1])?(Jo.unshift("desktop mode"),fo="Chrome Mobile",_o=null,/\bOS X\b/.test(vo)?(Os="Apple",vo="iOS 4.3+"):vo=null):/\bSRWare Iron\b/.test(fo)&&!_o&&(_o=XM("Chrome")),_o&&_o.indexOf(zr=/[\d.]+$/.exec(vo))==0&&Hn.indexOf("/"+zr+"-")>-1&&(vo=En(vo.replace(zr,""))),vo&&vo.indexOf(fo)!=-1&&!RegExp(fo+" OS").test(vo)&&(vo=vo.replace(RegExp(" *"+Tn(fo)+" *"),"")),Ca&&!/\b(?:Avant|Nook)\b/.test(fo)&&(/Browser|Lunascape|Maxthon/.test(fo)||fo!="Safari"&&/^iOS/.test(vo)&&/\bSafari\b/.test(Ca[1])||/^(?:Adobe|Arora|Breach|Midori|Opera|Phantom|Rekonq|Rock|Samsung Internet|Sleipnir|SRWare Iron|Vivaldi|Web)/.test(fo)&&Ca[1])&&(zr=Ca[Ca.length-1])&&Jo.push(zr),Jo.length&&(Jo=["("+Jo.join("; ")+")"]),Os&&oa&&oa.indexOf(Os)<0&&Jo.push("on "+Os),oa&&Jo.push((/^on /.test(Jo[Jo.length-1])?"":"on ")+oa),vo&&(zr=/ ([\d.+]+)$/.exec(vo),Jn=zr&&vo.charAt(vo.length-zr[0].length-1)=="/",vo={architecture:32,family:zr&&!Jn?vo.replace(zr[0],""):vo,version:zr?zr[1]:null,toString:function(){var ki=this.version;return this.family+(ki&&!Jn?" "+ki:"")+(this.architecture==64?" 64-bit":"")}}),(zr=/\b(?:AMD|IA|Win|WOW|x86_|x)64\b/i.exec(sl))&&!/\bi686\b/i.test(sl)?(vo&&(vo.architecture=64,vo.family=vo.family.replace(RegExp(" *"+zr),"")),fo&&(/\bWOW64\b/i.test(Hn)||fs&&/\w(?:86|32)$/.test(Do.cpuClass||Do.platform)&&!/\bWin64; x64\b/i.test(Hn))&&Jo.unshift("32-bit")):vo&&/^OS X/.test(vo.family)&&fo=="Chrome"&&parseFloat(_o)>=39&&(vo.architecture=64),Hn||(Hn=null);var hi={};return hi.description=Hn,hi.layout=Ca&&Ca[0],hi.manufacturer=Os,hi.name=fo,hi.prerelease=jc,hi.product=oa,hi.ua=Hn,hi.version=fo&&_o,hi.os=vo||{architecture:null,family:null,version:null,toString:function(){return"null"}},hi.parse=Pn,hi.toString=function(){return this.description||""},hi.version&&Jo.unshift(_o),hi.name&&Jo.unshift(fo),vo&&fo&&(vo!=String(vo).split(" ")[0]||vo!=fo.split(" ")[0]&&!oa)&&Jo.push(oa?"("+vo+")":"on "+vo),Jo.length&&(hi.description=Jo.join(" ")),hi}();Ue&&Ce?Vr(In,function(Pn,Hn){Ue[Hn]=Pn}):Fe.platform=In}).call(e)}),fS=Math.floor,Ch=function(xe,he){var Fe=xe.length,Ue=fS(Fe/2);return Fe<8?kh(xe,he):mS(xe,Ch(Du(xe,0,Ue),he),Ch(Du(xe,Ue),he),he)},kh=function(xe,he){for(var Fe,Ue,Ce=xe.length,Pt=1;Pt<Ce;){for(Ue=Pt,Fe=xe[Pt];Ue&&he(xe[Ue-1],Fe)>0;)xe[Ue]=xe[--Ue];Ue!==Pt++&&(xe[Ue]=Fe)}return xe},mS=function(xe,he,Fe,Ue){for(var Ce=he.length,Pt=Fe.length,ar=0,tr=0;ar<Ce||tr<Pt;)xe[ar+tr]=ar<Ce&&tr<Pt?Ue(he[ar],Fe[tr])<=0?he[ar++]:Fe[tr++]:ar<Ce?he[ar++]:Fe[tr++];return xe},wh=Ch,yy=_r.match(/firefox\/(\d+)/i),Hd=!!yy&&+yy[1],Da=/MSIE|Trident/.test(_r),by=_r.match(/AppleWebKit\/(\d+)\./),xh=!!by&&+by[1],_c=[],Ty=Ne(_c.sort),Sy=Ne(_c.push),gS=V(function(){_c.sort(void 0)}),My=V(function(){_c.sort(null)}),Cy=li("sort"),ky=!V(function(){if(Br)return Br<70;if(!(Hd&&Hd>3)){if(Da)return!0;if(xh)return xh<603;var xe,he,Fe,Ue,Ce="";for(xe=65;xe<76;xe++){switch(he=String.fromCharCode(xe),xe){case 66:case 69:case 70:case 72:Fe=3;break;case 68:case 71:Fe=4;break;default:Fe=2}for(Ue=0;Ue<47;Ue++)_c.push({k:he+Ue,v:Fe})}for(_c.sort(function(Pt,ar){return ar.v-Pt.v}),Ue=0;Ue<_c.length;Ue++)he=_c[Ue].k.charAt(0),Ce.charAt(Ce.length-1)!==he&&(Ce+=he);return Ce!=="DGBEFHACIJK"}});_n({target:"Array",proto:!0,forced:gS||!My||!Cy||!ky},{sort:function(he){he!==void 0&&Xr(he);var Fe=An(this);if(ky)return he===void 0?Ty(Fe):Ty(Fe,he);var Ue,Ce,Pt=[],ar=Ka(Fe);for(Ce=0;Ce<ar;Ce++)Ce in Fe&&Sy(Pt,Fe[Ce]);for(wh(Pt,function(tr){return function(fr,br){return br===void 0?-1:fr===void 0?1:tr!==void 0?+tr(fr,br)||0:Za(fr)>Za(br)?1:-1}}(he)),Ue=Ka(Pt),Ce=0;Ce<Ue;)Fe[Ce]=Pt[Ce++];for(;Ce<ar;)Xp(Fe,Ce++);return Fe}});var hS=na("Array").sort,_h=Array.prototype,Qc=function(xe){var he=xe.sort;return xe===_h||vr(_h,xe)&&he===_h.sort?hS:he},Ih=g(function(xe,he){xe.exports=function(){var Fe={d:function(zr,Jn){for(var ro in Jn)Fe.o(Jn,ro)&&!Fe.o(zr,ro)&&gc(zr,ro,{enumerable:!0,get:Jn[ro]})},o:function(zr,Jn){return Object.prototype.hasOwnProperty.call(zr,Jn)}},Ue={};Fe.d(Ue,{default:function(){return Do}});var Ce=function no(zr){for(var Jn in function(ro,zn){if(!(ro instanceof zn))throw new TypeError("Cannot call a class as a function")}(this,no),this.directUploadAddr="https://wanproxy-web.127.net",this.retryCount=4,this.trunkSize=4194304,this.trunkUploadTimeout=5e4,this.getOffsetTimeout=1e4,this.version="1.0",this.enableCache=!0,this.logger=console,this.onError=function(ro){},this.onProgress=function(ro){},this.onUploadProgress=function(ro){},this.onComplete=function(ro){},zr)this[Jn]=zr[Jn]};function Pt(no,zr){var Jn=Ba!==void 0&&Ud(no)||no["@@iterator"];if(!Jn){if(ji(no)||(Jn=function(So,Mo){if(So){var ca;if(typeof So=="string")return ar(So,Mo);var zo=Fo(ca=Object.prototype.toString.call(So)).call(ca,8,-1);return zo==="Object"&&So.constructor&&(zo=So.constructor.name),zo==="Map"||zo==="Set"?tf(So):zo==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(zo)?ar(So,Mo):void 0}}(no))||zr&&no&&typeof no.length=="number"){Jn&&(no=Jn);var ro=0,zn=function(){};return{s:zn,n:function(){return ro>=no.length?{done:!0}:{done:!1,value:no[ro++]}},e:function(Mo){throw Mo},f:zn}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var Ln,eo=!0,co=!1;return{s:function(){Jn=Jn.call(no)},n:function(){var Mo=Jn.next();return eo=Mo.done,Mo},e:function(Mo){co=!0,Ln=Mo},f:function(){try{eo||Jn.return==null||Jn.return()}finally{if(co)throw Ln}}}}function ar(no,zr){(zr==null||zr>no.length)&&(zr=no.length);for(var Jn=0,ro=new Array(zr);Jn<zr;Jn++)ro[Jn]=no[Jn];return ro}var tr=window.localStorage;window.localStorage&&typeof window.localStorage.getItem=="function"&&typeof window.localStorage.setItem=="function"&&typeof window.localStorage.removeItem=="function"||(tr={privateObj:{},setItem:function(zr,Jn){tr.privateObj[zr]=Jn},getItem:function(zr){return tr.privateObj[zr]},removeItem:function(zr){delete tr.privateObj[zr]},getKeys:function(){return aa(tr.privateObj)}});var fr={getFileKey:function(zr){var Jn=zr.size.toString(),ro=zr.lastModified.toString();return"_NosUploader_"+zr.name+Fo(Jn).call(Jn,Jn.length-5)+Fo(ro).call(ro,ro.length-5)},getFileInfo:function(zr){var Jn=tr.getItem(zr);if(!Jn)return null;try{return JSON.parse(Jn)}catch{return null}},initFile:function(zr,Jn,ro){fr.clearExpiredInfo();var zn=this.getFileKey(Jn),Ln={ctx:zr.ctx!==void 0?zr.ctx:"",bucket:zr.bucketName,obj:zr.objectName,token:zr.token,modifyAt:wa(),end:!1};return zr.payload&&(Ln.payload=zr.payload),ro&&tr.setItem(zn,la(Ln)),zn},setUploadContext:function(zr,Jn,ro){var zn=this.getFileInfo(zr);zn&&(zn.ctx=Jn,ro&&tr.setItem(zr,la(zn)))},setComplete:function(zr,Jn){var ro=this.getFileInfo(zr);ro&&(ro.modifyAt=wa(),ro.end=!0,Jn&&tr.setItem(zr,la(ro)))},getUploadContext:function(zr){var Jn=this.getFileInfo(zr);return Jn?Jn.ctx:""},removeFileInfo:function(zr){Va(zr).call(zr,"_NosUploader_")===0&&tr.removeItem(zr)},clearExpiredInfo:function(){var zr,Jn=typeof tr.getKeys=="function"?tr.getKeys():aa(tr),ro=wa(),zn=[],Ln=Pt(Jn);try{for(Ln.s();!(zr=Ln.n()).done;){var eo=zr.value;if(Va(eo).call(eo,"_NosUploader_")===0){var co=fr.getFileInfo(eo);co===null||ro-co.modifyAt>Do.expireTime?tr.removeItem(eo):zn.push({fileInfo:co,key:eo})}}}catch($o){Ln.e($o)}finally{Ln.f()}if(zn.length>Do.maxFileCache){var So,Mo,ca=Pt(Fo(So=Qc(zn).call(zn,function($o,Wo){return Wo.fileInfo.modifyAt-$o.fileInfo.modifyAt})).call(So,Do.maxFileCache));try{for(ca.s();!(Mo=ca.n()).done;){var zo,ss=Mo.value;Va(zo=ss.key).call(zo,"_NosUploader_")===0&&tr.removeItem(ss.key)}}catch($o){ca.e($o)}finally{ca.f()}}}},br=fr;function Nr(no){return(Nr=typeof Ba=="function"&&typeof Om=="symbol"?function(zr){return typeof zr}:function(zr){return zr&&typeof Ba=="function"&&zr.constructor===Ba&&zr!==Ba.prototype?"symbol":typeof zr})(no)}function Fr(no,zr){return!zr||Nr(zr)!=="object"&&typeof zr!="function"?function(Jn){if(Jn===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return Jn}(no):zr}function jr(no){var zr=typeof Cc=="function"?new Cc:void 0;return(jr=function(ro){var zn,Ln;if(ro===null||(Ln=ro,Va(zn=Function.toString.call(Ln)).call(zn,"[native code]")===-1))return ro;if(typeof ro!="function")throw new TypeError("Super expression must either be null or a function");if(zr!==void 0){if(zr.has(ro))return zr.get(ro);zr.set(ro,eo)}function eo(){return Vr(ro,arguments,Mn(this).constructor)}return eo.prototype=vs(ro.prototype,{constructor:{value:eo,enumerable:!1,writable:!0,configurable:!0}}),Tn(eo,ro)})(no)}function Vr(no,zr,Jn){return(Vr=Kr()?Yi:function(ro,zn,Ln){var eo=[null];eo.push.apply(eo,zn);var co=new(Go(Function).apply(ro,eo));return Ln&&Tn(co,Ln.prototype),co}).apply(null,arguments)}function Kr(){if(typeof Reflect>"u"||!Yi||Yi.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Yi(Boolean,[],function(){})),!0}catch{return!1}}function Tn(no,zr){return(Tn=ri||function(Jn,ro){return Jn.__proto__=ro,Jn})(no,zr)}function Mn(no){return(Mn=ri?ci:function(zr){return zr.__proto__||ci(zr)})(no)}var En=function(no){(function(Ln,eo){if(typeof eo!="function"&&eo!==null)throw new TypeError("Super expression must either be null or a function");Ln.prototype=vs(eo&&eo.prototype,{constructor:{value:Ln,writable:!0,configurable:!0}}),eo&&Tn(Ln,eo)})(zn,no);var zr,Jn,ro=(zr=zn,Jn=Kr(),function(){var Ln,eo=Mn(zr);if(Jn){var co=Mn(this).constructor;Ln=Yi(eo,arguments,co)}else Ln=eo.apply(this,arguments);return Fr(this,Ln)});function zn(Ln,eo){var co;return function(So,Mo){if(!(So instanceof Mo))throw new TypeError("Cannot call a class as a function")}(this,zn),(co=ro.call(this,"NosUploadError:"+Ln)).errCode=eo,co.errMsg=Ln,co}return zn}(jr(Error)),In=function no(zr,Jn,ro){if(zr.uploadState==="uploading"){var zn=zr.config,Ln=zr.param,eo=br.getUploadContext(zr.fileKey);if(!eo)return ro(0);var co=new XMLHttpRequest,So=zn.directUploadAddr+"/".concat(Ln.bucketName)+"/".concat(encodeURIComponent(Ln.objectName))+"?uploadContext"+"&context=".concat(eo)+"&version=".concat(zn.version);co.onreadystatechange=function(){var Mo;if(zr.uploadState!=="abort"&&co.readyState===4){var ca,zo,ss,$o;try{$o=JSON.parse(co.responseText)}catch{$o={errMsg:"JsonParseError in getOffset",errCode:500}}co.status===200?$o.errCode?zr.config.onError(new En($o.errMsg,$o.errCode)):ro($o.offset):co.status.toString().match(/^5/)?no(zr,Jn-1,ro):Jn>0?(typeof((Mo=zn.logger)===null||Mo===void 0?void 0:Mo.error)=="function"&&zn.logger.error(Hs(ca="getOffset(".concat(So,") error. retry after 3 seconds. ")).call(ca,new Date().toTimeString())),Ao(function(){no(zr,Jn-1,ro)},3500)):(br.removeFileInfo(zr.fileKey),co.status?zn.onError(new En(Hs(zo=Hs(ss="getOffset(".concat(So,") error: ")).call(ss,co.status," ")).call(zo,co.statusText))):zn.onError(new En("getOffset(".concat(So,") error. no Error Code"))))}},co.open("get",So),co.setRequestHeader("x-nos-token",Ln.token),co.timeout=zn.getOffsetTimeout,co.send()}},Pn=function no(zr,Jn,ro,zn){if(zr.uploadState==="uploading"){var Ln=zr.param,eo=zr.config,co=Fo(File.prototype),So=Ln.ctx!==void 0?Ln.ctx:"",Mo=Jn+eo.trunkSize>zr.file.size,ca=Mo?zr.file.size:Jn+eo.trunkSize,zo=new XMLHttpRequest,ss=eo.directUploadAddr+"/".concat(Ln.bucketName)+"/".concat(encodeURIComponent(Ln.objectName));if(zo.upload.onprogress=function(Wo){if(zr.uploadState!=="abort"){var Ma=0;Wo.lengthComputable?(Ma=(Jn+Wo.loaded)/zr.file.size,eo.onProgress(Ma),eo.onUploadProgress({loaded:Wo.loaded,total:zr.file.size,percentage:Ma,percentageText:(100*Ma).toFixed(2)+"%"})):eo.onError(new En("browser does not support query upload progress"))}},zo.onreadystatechange=function(){var Wo,Ma;if(zr.uploadState!=="abort"&&zo.readyState===4){var sl,Jo,jc,fs;try{fs=JSON.parse(zo.responseText)}catch(_o){typeof((Wo=eo.logger)===null||Wo===void 0?void 0:Wo.error)=="function"&&eo.logger.error("JsonParseError in uploadTrunk",_o),fs={errMsg:"JsonParseError in uploadTrunk"}}zo.status===200?(zr.setContext(fs.context),Mo?(zn(),zr.setComplete()):no(zr,fs.offset,eo.retryCount,zn)):zo.status.toString().match(/^5/)?ro>0?no(zr,Jn,ro-1,zn):(br.removeFileInfo(zr.fileKey),eo.onError(new En(fs.errMsg,fs.errCode))):ro>0?(typeof((Ma=eo.logger)===null||Ma===void 0?void 0:Ma.error)=="function"&&eo.logger.error(Hs(sl="uploadTrunk(".concat(ss,") error. retry after 3 seconds. ")).call(sl,new Date().toTimeString())),Ao(function(){no(zr,Jn,ro-1,zn)},3500)):(br.removeFileInfo(zr.fileKey),zo.status?eo.onError(new En(Hs(Jo=Hs(jc="uploadTrunk(".concat(ss,") error: ")).call(jc,zo.status," ")).call(Jo,zo.statusText))):eo.onError(new En("uploadTrunk(".concat(ss,") error. no Error Code. Please check your network"))))}},zo.open("post",ss+"?offset=".concat(Jn)+"&complete=".concat(Mo)+"&context=".concat(So)+"&version=".concat(eo.version)),zo.setRequestHeader("x-nos-token",Ln.token),zr.file.type&&zo.setRequestHeader("content-type",zr.file.type),zo.timeout=eo.trunkUploadTimeout,typeof FileReader<"u"){var $o=new FileReader;$o.addEventListener("load",function(Wo){var Ma;!((Ma=Wo==null?void 0:Wo.target)===null||Ma===void 0)&&Ma.result?zo.send(Wo.target.result):eo.onError(new En("Read ArrayBuffer failed"))}),$o.addEventListener("error",function(Wo){var Ma=Wo.target.error;eo.onError(new En("Read ArrayBuffer error. ".concat(Ma.toString()),Ma.code))}),$o.readAsArrayBuffer(co.call(zr.file,Jn,ca))}else zo.send(co.call(zr.file,Jn,ca))}};function Hn(no,zr){for(var Jn=0;Jn<zr.length;Jn++){var ro=zr[Jn];ro.enumerable=ro.enumerable||!1,ro.configurable=!0,"value"in ro&&(ro.writable=!0),gc(no,ro.key,ro)}}var ho=function(){function no(Jn,ro,zn){(function(Ln,eo){if(!(Ln instanceof eo))throw new TypeError("Cannot call a class as a function")})(this,no),this.uploadState="paused",this.config=zn,this.file=Jn,this.param=ro,this.fileKey=br.initFile(ro,Jn,this.config.enableCache),this.resume()}var zr;return(zr=[{key:"resume",value:function(){var ro=this;if(this.uploadState!=="uploading"){this.setUploadState("uploading");var zn=this.config;In(this,zn.retryCount,function(Ln){Pn(ro,Ln,zn.retryCount,function(){ro.setUploadState("ended"),typeof zn.onComplete=="function"&&zn.onComplete(ro.param)})})}}},{key:"pause",value:function(){this.setUploadState("paused")}},{key:"abort",value:function(){this.setUploadState("abort"),br.removeFileInfo(this.fileKey),this.config.onError(new En("Upload Aborted",10499))}},{key:"setUploadState",value:function(ro){ro!==this.uploadState&&(this.uploadState=ro)}},{key:"setContext",value:function(ro){br.setUploadContext(this.fileKey,ro,this.config.enableCache),this.param.ctx=ro}},{key:"setComplete",value:function(){br.setComplete(this.fileKey,this.config.enableCache),this.setUploadState("ended")}}])&&Hn(no.prototype,zr),no}(),uo={maxFileCache:6,expireTime:864e5,getFileUploadInformation:function(zr){var Jn=br.getFileKey(zr),ro=br.getFileInfo(Jn);return ro===null?null:wa()-ro.modifyAt>uo.expireTime?(br.removeFileInfo(Jn),null):{uploadInfo:Hr({bucketName:ro.bucket,objectName:ro.obj,token:ro.token,ctx:ro.ctx},ro.payload?{payload:ro.payload}:{}),complete:ro.end}},setMaxFileCache:function(zr){uo.maxFileCache=zr},setExpireTime:function(zr){uo.expireTime=zr},printCaches:function(){for(var zr=0,Jn=aa(localStorage);zr<Jn.length;zr++){var ro=Jn[zr],zn=br.getFileInfo(ro);zn&&console.log(zn,"modifiedAt",new Date(zn.modifyAt).toTimeString())}},createConfig:function(zr){return new Ce(zr)},createTask:function(zr,Jn,ro){return new ho(zr,Jn,ro)}},Do=uo;return Ue.default}()}),vS=g(function(xe,he){xe.exports=function(){function Fe(ar){if(ar){var tr,fr="";return Kn(tr=aa(ar)).call(tr,function(br,Nr){fr+=Nr===0?"?":"&",fr+=br+"="+ar[br]}),fr}return""}function Ue(ar,tr,fr,br){return Error.call(this,fr),this.source=ar,this.code=tr,this.desc=fr,this.detail=br||{},this}function Ce(ar,tr){var fr=vs(tr.prototype);fr.constructor=ar,ar.prototype=fr}function Pt(ar,tr){tr===void 0&&(tr={dataType:"json",method:"GET",timeout:5e3});var fr=tr.dataType==="text"?"text/plain; charset=UTF-8":"application/json; charset=UTF-8",br=tr.method==="GET"?Fe(tr.params):"";return new wo(function(Nr,Fr){if(window.XMLHttpRequest){var jr,Vr=new XMLHttpRequest;if(Vr.onreadystatechange=function(){if(Vr.readyState===4)if(Vr.status===200){try{jr=JSON.parse(Vr.response||"{}")}catch{jr=Vr.response}Nr({status:Vr.status,data:jr})}else Fr(new Ue(1,Vr.status,Vr.statusText))},Vr.open(tr.method,""+ar+br),Vr.timeout=tr.timeout||5e3,Vr.setRequestHeader("Content-Type",fr),tr.headers)for(var Kr in tr.headers)Vr.setRequestHeader(Kr,tr.headers[Kr]);Vr.ontimeout=function(Tn){Fr(new Ue(1,408,Tn&&Tn.message?Tn.message:"request timeout"))},Vr.send(la(tr.data))}else Fr(new Ue(2,10400,"request no suppout"))})}return Ce(Ue,Error),Pt}()}),wy=console,Ic,is,fu,Fa,Ti,xy={setLogger:function(he){wy=he},platform:"BROWSER",localStorage:window.localStorage,request:vS,WebSocket:window.WebSocket,uploadFile:function(he){return Un(this,void 0,void 0,wr.mark(function Fe(){var Ue,Ce,Pt,ar,tr,fr;return wr.wrap(function(Nr){for(;;)switch(Nr.prev=Nr.next){case 0:if(he.fileInput||he.file){Nr.next=2;break}throw new Error("File not exist");case 2:if(!he.file){Nr.next=6;break}ar=he.file,Nr.next=20;break;case 6:if(typeof he.fileInput!="string"){Nr.next=15;break}if(!((tr=document.getElementById(he.fileInput))&&tr.files&&tr.files[0])){Nr.next=12;break}ar=tr.files[0],Nr.next=13;break;case 12:throw new Error("Can not get file from fileInput");case 13:Nr.next=20;break;case 15:if(!(he.fileInput&&he.fileInput.files&&he.fileInput.files[0])){Nr.next=19;break}ar=he.fileInput.files[0],Nr.next=20;break;case 19:throw new Error("Can not get file from fileInput "+he.fileInput);case 20:if(!(he.maxSize&&ar.size>he.maxSize)){Nr.next=22;break}throw new Error("The file exceeds maxSize limit. maxSize: "+he.maxSize+", get "+ar.size);case 22:return Nr.next=24,new wo(function(Fr,jr){var Vr=Ih.createConfig({enableCache:!1,directUploadAddr:he.chunkUploadHost,onError:function(Mn){jr(Mn)},onProgress:he.onUploadProgress||function(){},onComplete:function(Mn){Fr(Mn)}}),Kr=Ih.createTask(ar,{bucketName:he.nosToken.bucket,objectName:decodeURIComponent(he.nosToken.objectName),token:he.nosToken.token},Vr);try{he.onUploadStart&&he.onUploadStart(Kr)}catch(Tn){wy.error("Adapter uploadFile: options.onUploadStart error",Tn&&Tn.message),Kr.abort(),jr(Tn)}});case 24:return(fr=Nr.sent).name=ar.name,fr.size=ar.size,fr.type=ar.type,fr.ext=Mh(Ue=fr.name).call(Ue,".")>-1?Fo(Ce=fr.name).call(Ce,Mh(Pt=fr.name).call(Pt,".")+1).toLowerCase():"",Nr.abrupt("return",fr);case 30:case"end":return Nr.stop()}},Fe)}))},getSystemInfo:function(){var he,Fe;return{os:((he=pu.os)===null||he===void 0?void 0:he.family)||"",osVer:((Fe=pu.os)===null||Fe===void 0?void 0:Fe.version)||"",browser:pu.name||"",browserVer:pu.version||"",hostEnv:"BROWSER",hostEnvVer:pu.version||"",hostInfo:pu.ua||""}}},ws=function(){function xe(he,Fe){this.name=he,this.core=Fe,this.name=he,this.logger=Fe.logger,this.core=Fe}return xe.prototype.process=function(Fe){var Ue=this[Fe.cmd+"Handler"];return typeof Ue=="function"?Ue.call(this,Fe):Fe.error&&!Fe.error.ignore?wo.reject(Fe.error):wo.resolve(Fe)},xe}();(function(xe){xe[xe.text=0]="text",xe[xe.image=1]="image",xe[xe.audio=2]="audio",xe[xe.video=3]="video",xe[xe.geo=4]="geo",xe[xe.notification=5]="notification",xe[xe.file=6]="file",xe[xe.tip=10]="tip",xe[xe.robot=11]="robot",xe[xe.g2=12]="g2",xe[xe.custom=100]="custom"})(Ic||(Ic={})),function(xe){xe[xe.p2p=0]="p2p",xe[xe.team=1]="team",xe[xe.superTeam=5]="superTeam"}(is||(is={})),function(xe){xe[xe.Android=1]="Android",xe[xe.iOS=2]="iOS",xe[xe.PC=4]="PC",xe[xe.WindowsPhone=8]="WindowsPhone",xe[xe.Web=16]="Web",xe[xe.Server=32]="Server",xe[xe.Mac=64]="Mac"}(fu||(fu={})),function(xe){xe[xe.unread=1]="unread",xe[xe.read=2]="read",xe[xe.deleted=3]="deleted",xe[xe.sending=4]="sending",xe[xe.sendFailed=5]="sendFailed",xe[xe.sent=6]="sent",xe[xe.receipt=7]="receipt",xe[xe.refused=10]="refused"}(Fa||(Fa={})),function(xe){xe[xe.default=0]="default",xe[xe.leave=1]="leave",xe[xe.roam=2]="roam"}(Ti||(Ti={}));var Eh=function(he,Fe){return function(Ue){return he(Fe(Ue))}},Ph=Eh(Object.getPrototypeOf,Object),yS=Function.prototype,bS=Object.prototype,_y=yS.toString,TS=bS.hasOwnProperty,Bl=_y.call(Object),zd=function(he){if(!Di(he)||Uc(he)!="[object Object]")return!1;var Fe=Ph(he);if(Fe===null)return!0;var Ue=TS.call(Fe,"constructor")&&Fe.constructor;return typeof Ue=="function"&&Ue instanceof Ue&&_y.call(Ue)==Bl};function Si(xe,he){if(!zd(he))return{};var Fe=JSON.parse(la(he)),Ue=Ah(xe,Fe);return JSON.parse(la(Hr(Hr({},Fe),Ue)))}function Ah(xe,he){if(!zd(he))return{};var Fe={},Ue=aa(xe);return Kn(Ue).call(Ue,function(Ce){var Pt=xe[Ce].type;if(typeof Pt!="string"){var ar=Ah(xe[Ce],he);aa(ar).length>0&&(Fe[Ce]=ar)}else{var tr=xe[Ce],fr=tr.rawKey||Ce,br=cf[Pt](he,fr,tr);br!==void 0&&(he[fr]=void 0,Fe[Ce]=br)}}),Fe}var cf={number:function(he,Fe){if(he[Fe]!==void 0)return+he[Fe]},string:function(he,Fe){if(he[Fe]!==void 0)return he[Fe]},boolean:function(he,Fe){return+he[Fe]>0||+he[Fe]!=0&&void 0},enum:function(he,Fe,Ue){return Np(Ue)[he[Fe]]},object:function(he,Fe){if(he[Fe]!==void 0)try{return JSON.parse(he[Fe])}catch{return{}}}};function Wd(xe,he){if(!zd(he))return{};var Fe=JSON.parse(la(he)),Ue=Iy(xe,Fe);return JSON.parse(la(Hr(Hr({},Fe),Ue)))}function Iy(xe,he){var Fe;if(!zd(he))return Pp(Fe=aa(xe)).call(Fe,function(Pt,ar){return Pt[xe[ar].rawKey||ar]=void 0,Pt},{});var Ue={},Ce=aa(xe);return Kn(Ce).call(Ce,function(Pt){var ar=xe[Pt].type;if(typeof ar!="string"){var tr=Iy(xe[Pt],he[Pt]);return Hr(Ue,tr),void(he[Pt]=void 0)}var fr=xe[Pt],br=fr.rawKey||Pt,Nr=Nh[ar](he,Pt,fr);he[br]=void 0,Ue[br]=Nr}),Ue}var Nh={number:function(he,Fe){return he[Fe]},string:function(he,Fe){return he[Fe]},boolean:function(he,Fe){return he[Fe]===!0?1:he[Fe]===!1?0:void 0},enum:function(he,Fe,Ue){return Np(Ue)[he[Fe]]},object:function(he,Fe){if(he[Fe]!==void 0)try{return la(he[Fe])}catch{return""}}},SS=Nh,Ey=function(he){return function(Fe,Ue,Ce){for(var Pt=-1,ar=Object(Fe),tr=Ce(Fe),fr=tr.length;fr--;){var br=tr[he?fr:++Pt];if(Ue(ar[br],br,ar)===!1)break}return Fe}}(),MS=function(he,Fe){for(var Ue=-1,Ce=Array(he);++Ue<he;)Ce[Ue]=Fe(Ue);return Ce},Oh=function(he){return Di(he)&&Uc(he)=="[object Arguments]"},Py=Object.prototype,lf=Py.hasOwnProperty,CS=Py.propertyIsEnumerable,kS=Oh(function(){return arguments}())?Oh:function(xe){return Di(xe)&&lf.call(xe,"callee")&&!CS.call(xe,"callee")},Gd=kS,Rh=function(){return!1},uf=g(function(xe,he){var Fe=he&&!he.nodeType&&he,Ue=Fe&&xe&&!xe.nodeType&&xe,Ce=Ue&&Ue.exports===Fe?Xs.Buffer:void 0,Pt=(Ce?Ce.isBuffer:void 0)||Rh;xe.exports=Pt}),wS=/^(?:0|[1-9]\d*)$/,df=function(he,Fe){var Ue=typeof he;return!!(Fe=Fe??9007199254740991)&&(Ue=="number"||Ue!="symbol"&&wS.test(he))&&he>-1&&he%1==0&&he<Fe},Ua={};Ua["[object Float32Array]"]=Ua["[object Float64Array]"]=Ua["[object Int8Array]"]=Ua["[object Int16Array]"]=Ua["[object Int32Array]"]=Ua["[object Uint8Array]"]=Ua["[object Uint8ClampedArray]"]=Ua["[object Uint16Array]"]=Ua["[object Uint32Array]"]=!0,Ua["[object Arguments]"]=Ua["[object Array]"]=Ua["[object ArrayBuffer]"]=Ua["[object Boolean]"]=Ua["[object DataView]"]=Ua["[object Date]"]=Ua["[object Error]"]=Ua["[object Function]"]=Ua["[object Map]"]=Ua["[object Number]"]=Ua["[object Object]"]=Ua["[object RegExp]"]=Ua["[object Set]"]=Ua["[object String]"]=Ua["[object WeakMap]"]=!1;var xS=function(he){return Di(he)&&sh(he.length)&&!!Ua[Uc(he)]},Bh=Es&&Es.isTypedArray,Fh=Bh?tu(Bh):xS,_S=Object.prototype.hasOwnProperty,Ay=function(he,Fe){var Ue=qi(he),Ce=!Ue&&Gd(he),Pt=!Ue&&!Ce&&uf(he),ar=!Ue&&!Ce&&!Pt&&Fh(he),tr=Ue||Ce||Pt||ar,fr=tr?MS(he.length,String):[],br=fr.length;for(var Nr in he)!Fe&&!_S.call(he,Nr)||tr&&(Nr=="length"||Pt&&(Nr=="offset"||Nr=="parent")||ar&&(Nr=="buffer"||Nr=="byteLength"||Nr=="byteOffset")||df(Nr,br))||fr.push(Nr);return fr},pf=Object.prototype,Fl=function(he){var Fe=he&&he.constructor;return he===(typeof Fe=="function"&&Fe.prototype||pf)},$h=Eh(Object.keys,Object),ms=Object.prototype.hasOwnProperty,IS=function(he){if(!Fl(he))return $h(he);var Fe=[];for(var Ue in Object(he))ms.call(he,Ue)&&Ue!="constructor"&&Fe.push(Ue);return Fe},Kd=function(he){return Hp(he)?Ay(he):IS(he)},Ny=function(he,Fe){return he&&Ey(he,Fe,Kd)},ES=function(he,Fe,Ue,Ce){return Ny(he,function(Pt,ar,tr){Fe(Ce,Ue(Pt),ar,tr)}),Ce},Lh,PS=function(he,Fe){return function(Ue,Ce){return ES(Ue,he,Fe(Ce),{})}},AS=Object.prototype.toString,gs=PS(function(xe,he,Fe){he!=null&&typeof he.toString!="function"&&(he=AS.call(he)),xe[he]=Fe},Yv(cu)),NS=gs({Android:1,iOS:2,PC:4,WindowsPhone:8,Web:16,Server:32,Mac:64}),jh={p2p:0,team:1,superTeam:5};function Oy(xe,he){return xe&&xe.length>0?Ro(xe).call(xe,function(Fe){return Hr(Hr({},Fe),{account:Fe.account,connectionId:Fe.connectionId,deviceId:Fe.deviceId,ip:Fe.ip,mac:Fe.mac,os:Fe.os,type:NS[Fe.type]||Fe.type,time:Lo(Fe.time),online:he!==3})}):[]}gs(jh),function(xe){xe[xe.text=0]="text",xe[xe.image=1]="image",xe[xe.audio=2]="audio",xe[xe.video=3]="video",xe[xe.geo=4]="geo",xe[xe.notification=5]="notification",xe[xe.file=6]="file",xe[xe.tip=10]="tip",xe[xe.robot=11]="robot",xe[xe.g2=12]="g2",xe[xe.custom=100]="custom"}(Lh||(Lh={}));var OS={1:{reason:"samePlatformKick",message:"The same account is not allowed to multiple login at the same time"},2:{reason:"serverKick",message:"Kicked out by IM server"},3:{reason:"otherPlatformKick",message:"Kicked out by other client of your account"},4:{reason:"silentlyKick",message:"Quietly kicked"}},Ry={BROWSER:0,RN:2,UNIAPP:3,WECHAT:6},By=function(xe){function he(Ue){var Ce;return Ce=xe.call(this,"auth",Ue)||this,ls({cmdMap:dy,cmdConfig:fy}),Ce}Ko(he,xe);var Fe=he.prototype;return Fe.doLogin=function(Ce){var Pt,ar;return Ce===void 0&&(Ce=!1),Un(this,void 0,void 0,wr.mark(function tr(){var fr,br,Nr,Fr,jr,Vr,Kr,Tn,Mn,En;return wr.wrap(function(Pn){for(;;)switch(Pn.prev=Pn.next){case 0:return fr=this.core.options,br=sa.getSystemInfo(),Nr=Hr(Hr({},fr),{appLogin:Ce?0:1,appkey:fr.appkey,account:fr.account,token:fr.token,deviceId:this.core.config.deviceId,clientType:16,protocolVersion:1,sdkVersion:91001,sdkHumanVersion:"0.13.1",os:br.os,browser:br.browser,session:(Pt=this.core.socket)===null||Pt===void 0?void 0:Pt.sessionId,sdkType:Ry[sa.platform]||0,userAgent:"Native/0.13.1"}),Fr=br.os.toLowerCase(),sa.platform!=="UNIAPP"||Fr!=="ios"&&Fr!=="android"||(Nr.isReactNative=1,Nr.clientType=Fr==="ios"?2:1,br.pushDeviceInfo&&br.pushDeviceInfo.MANUFACTURER&&(Nr.deviceInfo=la(br.pushDeviceInfo))),this.logger.log("auth::do login ",fr.account,(ar=this.core.socket)===null||ar===void 0?void 0:ar.sessionId),Pn.next=8,this.core.sendCmd("login",{login:Nr});case 8:if(!(jr=Pn.sent).error){Pn.next=11;break}throw jr.error;case 11:return Vr=jr.content,Kr=Vr.loginRes,Tn=Vr.loginPorts,Mn=Vr.aosPushInfo,En=Oy(Tn,2),(En=Is(En).call(En,function(Hn){return Hn.connectionId!==Kr.connectionId})).length>0&&this.core.emit("multiPortLogin",En),Pn.abrupt("return",Hr(Hr({},Kr),{aosPushInfo:Mn}));case 16:case"end":return Pn.stop()}},tr,this)}))},Fe.kick=function(Ce){var Pt;return Un(this,void 0,void 0,wr.mark(function ar(){var tr;return wr.wrap(function(br){for(;;)switch(br.prev=br.next){case 0:return br.next=2,this.core.sendCmd("kick",Ce);case 2:return tr=br.sent,br.abrupt("return",(Pt=tr.content)===null||Pt===void 0?void 0:Pt.deviceIds);case 4:case"end":return br.stop()}},ar,this)}))},Fe.multiPortLoginHandler=function(Ce){if(Ce.error)this.logger.error("multiPortLoginHandler:: error, ",Ce.error);else{var Pt=Ce.content,ar=Oy(Pt.loginPorts,Pt.state);ar.length>0&&this.core.emit("multiPortLogin",ar)}},Fe.kickedHandler=function(Ce){if(Ce.error)this.logger.error("kickedHandler:: error, ",Ce.error);else{var Pt=function(tr){var fr=Si({clientType:{type:"enum",values:fu},customClientType:{type:"number"}},tr),br=OS[fr.reason];return Hr(fr,br=br||{reason:"unknow",message:"Unknown reason"})}(Ce.content);this.logger.warn("kicked::",Pt),this.core.doDisconnect(us.KICKED,Pt)}},he}(ws);_n({target:"Number",stat:!0},{isNaN:function(he){return he!=he}});var Qd,RS=kr.Number.isNaN,BS=gs({none:0,normal:1,all:3}),Fy={normal:0,advanced:1},FS=gs(Fy),$S=gs({normal:0,owner:1,manager:2}),Dh={noVerify:0,needVerify:1,rejectAll:2},$y=gs(Dh),Ly={needVerify:0,noVerify:1},jy=gs(Ly),mu={manager:0,all:1},$l=gs(mu),Uh={manager:0,all:1},fi=gs(Uh),nc={manager:0,all:1},LS=gs(nc);function Jc(xe){var he,Fe=["teamId"],Ue=["level","memberNum","memberUpdateTime","createTime","updateTime"],Ce=["valid","validToCurrentUser","mute"],Pt={type:FS,muteType:BS,joinMode:$y,beInviteMode:jy,inviteMode:$l,updateTeamMode:fi,updateExtMode:LS};xe.bits;var ar=Ys(xe,["bits"]);return Kn(Fe).call(Fe,function(tr){ar[tr]&&(ar[tr]=ar[tr].toString())}),Kn(Ue).call(Ue,function(tr){ar[tr]!==void 0&&(ar[tr]=Lo(ar[tr]))}),Kn(Ce).call(Ce,function(tr){ar[tr]!==void 0&&(ar[tr]=Lo(ar[tr])===1)}),Kn(he=aa(Pt)).call(he,function(tr){ar[tr]!==void 0&&(ar[tr]=Pt[tr][ar[tr]]||ar[tr])}),ar}function qh(xe){return xe&&xe.length>0?Ro(xe).call(xe,function(he){return Jc(he)}):[]}function Vh(xe){var he,Fe=Hr({},xe),Ue=["avatar","name","intro","announcement","ext"],Ce={type:Fy,joinMode:Dh,beInviteMode:Ly,inviteMode:mu,updateTeamMode:Uh,updateExtMode:nc};return Kn(Ue).call(Ue,function(Pt){Fe[Pt]!==void 0&&(Fe[Pt]=Fe[Pt].toString())}),Kn(he=aa(Ce)).call(he,function(Pt){Fe[Pt]!==void 0&&(Fe[Pt]=Ce[Pt][Fe[Pt]])}),Fe}function Dy(xe){var he=["teamId","ext","account","nickInTeam"],Fe={};return xe.bitConfigMask!==void 0&&(Fe.bits=Lo(xe.bitConfigMask)),Kn(he).call(he,function(Ue){xe[Ue]&&(Fe[Ue]=xe[Ue].toString())}),Fe}function Jd(xe){var he,Fe=["teamId"],Ue=["joinTime","updateTime","bitConfigMask"],Ce=["active","valid","mute"],Pt={type:$S},ar=xe.bits,tr=Ys(xe,["bits"]);return ar!==void 0&&(tr.muteTeam=Lo(ar)===1,tr.bitConfigMask=ar),tr.id=tr.teamId+"-"+tr.account,Kn(Fe).call(Fe,function(fr){tr[fr]&&(tr[fr]=tr[fr].toString())}),Kn(Ue).call(Ue,function(fr){tr[fr]!==void 0&&(tr[fr]=Lo(tr[fr]))}),Kn(Ce).call(Ce,function(fr){tr[fr]!==void 0&&(tr[fr]=Lo(tr[fr])===1)}),Kn(he=aa(Pt)).call(he,function(fr){tr[fr]!==void 0&&(tr[fr]=Pt[fr][tr[fr]]||tr[fr])}),tr}function ff(xe){return xe&&xe.length>0?Ro(xe).call(xe,function(he){return Jd(he)}):[]}function Uy(xe,he,Fe){return Fe===void 0&&(Fe="normal"),{id:xe.teamId+"-"+he,teamId:xe.teamId,account:he,type:Fe,nickInTeam:"",muteTeam:!1,mute:!1,joinTime:xe.memberUpdateTime,updateTime:xe.memberUpdateTime,active:!0,valid:!0}}function jS(xe,he,Fe){return Fe===void 0&&(Fe="normal"),he&&he.length>0?Ro(he).call(he,function(Ue){return Uy(xe,Ue,Fe)}):[]}function gu(xe){var he=Hr({},xe);return he.createTime&&(he.createTime=+he.createTime),he.updateTime&&(he.updateTime=+he.updateTime),he.gender&&(he.gender=Qd[+he.gender]),he}(function(xe){xe[xe.unknown=0]="unknown",xe[xe.male=1]="male",xe[xe.female=2]="female"})(Qd||(Qd={}));var qy={"8_1":"createTeam","8_5":"addTeamMembers","8_6":"removeTeamMembers","8_7":"updateTeamInfo","8_8":"leaveTeam","8_9":"getTeamInfo","8_10":"getTeams","8_11":"getTeamMembers","8_12":"dismissTeam","8_13":"applyTeam","8_14":"passTeamApply","8_15":"rejectTeamApply","8_16":"addTeamManagers","8_17":"removeTeamManagers","8_18":"transferTeam","8_19":"updateMyMemberInfo","8_20":"updateNickInTeam","8_21":"acceptTeamInvite","8_22":"rejectTeamInvite","8_25":"muteTeamMember","8_27":"getMutedTeamMembers","8_28":"sendTeamMsgReceipt","8_29":"getTeamMsgReads","8_30":"getTeamMsgReadAccounts","8_31":"notifyTeamMsgReceipts","8_32":"muteTeam","8_33":"getTeamMemberInvitorAccid","8_34":"getTeamsById","8_101":"syncCreateTeam","8_109":"syncTeams","8_119":"syncUpdateTeamMember","8_126":"syncMyTeamMembers"},Ec={team:{teamId:1,name:3,type:4,owner:5,level:6,selfCustom:7,valid:8,memberNum:9,memberUpdateTime:10,createTime:11,updateTime:12,validToCurrentUser:13,intro:14,announcement:15,joinMode:16,bits:17,ext:18,serverExt:19,avatar:20,beInviteMode:21,inviteMode:22,updateTeamMode:23,updateExtMode:24,mute:100,muteType:101},teamMsgReceiptTag:{teamId:0,idServer:1,read:100,unread:101,idClient:102,account:103},teamMember:{teamId:1,account:3,type:4,nickInTeam:5,bits:7,active:8,valid:9,joinTime:10,updateTime:11,ext:12,mute:13,invitorAccid:14}},xs=Cs(Ec),Vy={getTeamInfo:{sid:8,cid:9,service:"team",params:[{type:"Long",name:"teamId"}],response:[{type:"Property",name:"team",reflectMapper:xs.team}]},getTeams:{sid:8,cid:10,service:"team",params:[{type:"long",name:"timetag"}],response:[{type:"PropertyArray",name:"teams",reflectMapper:xs.team},{type:"Number",name:"timetag"}],ignoreErrCodes:[803]},createTeam:{sid:8,cid:1,service:"team",params:[{type:"Property",name:"team",reflectMapper:Ec.team},{type:"StrArray",name:"accounts"},{type:"String",name:"ps"}],response:[{type:"Property",name:"team",reflectMapper:xs.team},{type:"StrArray",name:"abortedAccidList"}]},sendTeamMsgReceipt:{sid:8,cid:28,service:"team",params:[{type:"PropertyArray",name:"teamMsgReceipts",reflectMapper:Ec.teamMsgReceiptTag}],response:[{type:"PropertyArray",name:"teamMsgReceipts",reflectMapper:xs.teamMsgReceiptTag}]},getTeamMsgReads:{sid:8,cid:29,service:"team",params:[{type:"PropertyArray",name:"teamMsgReceipts",reflectMapper:Ec.teamMsgReceiptTag}],response:[{type:"PropertyArray",name:"teamMsgReceipts",reflectMapper:xs.teamMsgReceiptTag}]},getTeamMsgReadAccounts:{sid:8,cid:30,service:"team",params:[{type:"Property",name:"teamMsgReceiptTag",reflectMapper:Ec.teamMsgReceiptTag}],response:[{type:"Property",name:"teamMsgReceipt",reflectMapper:xs.teamMsgReceiptTag},{type:"StrArray",name:"readAccounts"},{type:"StrArray",name:"unreadAccounts"}]},notifyTeamMsgReceipts:{sid:8,cid:31,service:"team",response:[{type:"PropertyArray",name:"teamMsgReceipts",reflectMapper:xs.teamMsgReceiptTag}]},dismissTeam:{sid:8,cid:12,service:"team",params:[{type:"Long",name:"teamId"}]},leaveTeam:{sid:8,cid:8,service:"team",params:[{type:"Long",name:"teamId"}]},transferTeam:{sid:8,cid:18,service:"team",params:[{type:"Long",name:"teamId"},{type:"String",name:"account"},{type:"bool",name:"leave"}]},updateTeamInfo:{sid:8,cid:7,service:"team",params:[{type:"Property",name:"team",reflectMapper:Ec.team}],response:[{type:"Number",name:"id"},{type:"Number",name:"time"}]},getTeamsById:{sid:8,cid:34,service:"team",params:[{type:"LongArray",name:"teamIds"}],response:[{type:"PropertyArray",name:"teams",reflectMapper:xs.team},{type:"StrArray",name:"tids"}],ignoreErrCodes:[816]},getTeamMembers:{sid:8,cid:11,service:"team",params:[{type:"Long",name:"teamId"},{type:"Long",name:"timetag"}],response:[{type:"String",name:"teamId"},{type:"PropertyArray",name:"teamMembers",reflectMapper:xs.teamMember},{type:"Number",name:"timetag"}]},getMutedTeamMembers:{sid:8,cid:27,service:"team",params:[{type:"Long",name:"teamId"}],response:[{type:"String",name:"teamId"},{type:"PropertyArray",name:"teamMembers",reflectMapper:xs.teamMember}]},addTeamMembers:{sid:8,cid:5,service:"team",params:[{type:"Long",name:"teamId"},{type:"StrArray",name:"accounts"},{type:"String",name:"ps"},{type:"String",name:"attach"}],response:[{type:"Long",name:"time"},{type:"StrArray",name:"abortedAccidList"}]},removeTeamMembers:{sid:8,cid:6,service:"team",params:[{type:"Long",name:"teamId"},{type:"StrArray",name:"accounts"}]},applyTeam:{sid:8,cid:13,service:"team",params:[{type:"Long",name:"teamId"},{type:"String",name:"ps"}],response:[{type:"Property",name:"team",reflectMapper:xs.team}]},addTeamManagers:{sid:8,cid:16,service:"team",params:[{type:"Long",name:"teamId"},{type:"StrArray",name:"accounts"}]},removeTeamManagers:{sid:8,cid:17,service:"team",params:[{type:"Long",name:"teamId"},{type:"StrArray",name:"accounts"}]},updateMyMemberInfo:{sid:8,cid:19,service:"team",params:[{type:"Property",name:"teamMember",reflectMapper:Ec.teamMember}]},updateNickInTeam:{sid:8,cid:20,service:"team",params:[{type:"Property",name:"teamMember",reflectMapper:Ec.teamMember}]},muteTeamMember:{sid:8,cid:25,service:"team",params:[{type:"Long",name:"teamId"},{type:"String",name:"account"},{type:"Int",name:"mute"}]},getTeamMemberInvitorAccid:{sid:8,cid:33,service:"team",params:[{type:"Long",name:"teamId"},{type:"StrArray",name:"accounts"}],response:[{type:"Object",name:"accountsMap"}]},muteTeam:{sid:8,cid:32,service:"team",params:[{type:"Long",name:"teamId"},{type:"Int",name:"mute"}]},passTeamApply:{sid:8,cid:14,service:"team",params:[{type:"Long",name:"teamId"},{type:"String",name:"from"}]},rejectTeamApply:{sid:8,cid:15,service:"team",params:[{type:"Long",name:"teamId"},{type:"String",name:"from"},{type:"String",name:"ps"}]},acceptTeamInvite:{sid:8,cid:21,service:"team",params:[{type:"Long",name:"teamId"},{type:"String",name:"from"}]},rejectTeamInvite:{sid:8,cid:22,service:"team",params:[{type:"Long",name:"teamId"},{type:"String",name:"from"},{type:"String",name:"ps"}]},syncTeams:{sid:8,cid:109,service:"team",response:[{type:"Number",name:"timetag"},{type:"PropertyArray",name:"teams",reflectMapper:xs.team}]},syncCreateTeam:{sid:8,cid:101,service:"team",response:[{type:"Property",name:"team",reflectMapper:xs.team}]},syncUpdateTeamMember:{sid:8,cid:119,service:"team",response:[{type:"Property",name:"teamMember",reflectMapper:xs.teamMember}]},syncMyTeamMembers:{sid:8,cid:126,ext:"sync",service:"team",response:[{type:"PropertyArray",name:"teamMembers",entity:"teamMember",reflectMapper:xs.teamMember},{type:"Number",name:"timetag"}]}},Hy={"3_7":"getUsersNameCardFromServer","3_10":"updateMyNameCard","3_109":"syncMyNameCard","3_110":"onUpdateMyNameCard","3_3":"setBlack","3_103":"onUpdateBlackList","3_5":"setMute","3_105":"onUpdateMuteList","3_8":"syncRelations"},Pc={user:{account:1,nick:3,avatar:4,signature:5,gender:6,email:7,birth:8,tel:9,ext:10,createTime:12,updateTime:13},relationMember:{account:0,isMuted:1,isBlack:2,createTime:3,updateTime:4}},hu=Cs(Pc),DS={syncMyNameCard:{sid:3,cid:109,service:"user",response:[{type:"Property",name:"user",reflectMapper:hu.user},{type:"Number",name:"timetag"}]},setBlack:{service:"user",sid:3,cid:3,params:[{type:"String",name:"account"},{type:"bool",name:"isAdd"}]},onUpdateBlackList:{service:"user",sid:3,cid:103,response:[{type:"String",name:"account"},{type:"Boolean",name:"isAdd"}]},setMute:{service:"user",sid:3,cid:5,params:[{type:"String",name:"account"},{type:"bool",name:"isAdd"}]},onUpdateMuteList:{service:"user",sid:3,cid:105,response:[{type:"String",name:"account"},{type:"Boolean",name:"isAdd"}]},syncRelations:{service:"user",sid:3,cid:8,params:[{type:"long",name:"timetag"}],response:[{type:"PropertyArray",name:"list",reflectMapper:hu.relationMember},{type:"Number",name:"timetag"}]},getUsersNameCardFromServer:{service:"user",sid:3,cid:7,params:[{type:"StrArray",name:"accounts"}],response:[{type:"PropertyArray",name:"users",reflectMapper:hu.user}]},updateMyNameCard:{service:"user",sid:3,cid:10,params:[{type:"Property",name:"user",reflectMapper:Pc.user}],response:[{type:"Number",name:"timetag"}]},onUpdateMyNameCard:{service:"user",sid:3,cid:110,response:[{type:"Property",name:"user",reflectMapper:hu.user}]}},zy={needPush:{type:"boolean",required:!1},needPushBadge:{type:"boolean",required:!1},needPushNick:{type:"boolean",required:!1},pushContent:{type:"string",allowEmpty:!1,required:!1},pushPayload:{type:"string",allowEmpty:!1,required:!1},needForcePush:{type:"boolean",required:!1},forcePushIDsList:{type:"string",allowEmpty:!1,required:!1},forcePushContent:{type:"string",allowEmpty:!1,required:!1}};function US(xe,he){var Fe,Ue=Ba!==void 0&&Ud(xe)||xe["@@iterator"];if(Ue)return Go(Fe=(Ue=Ue.call(xe)).next).call(Fe,Ue);if(ji(xe)||(Ue=function(ar,tr){var fr;if(ar){if(typeof ar=="string")return Wy(ar,tr);var br=Fo(fr=Object.prototype.toString.call(ar)).call(fr,8,-1);if(br==="Object"&&ar.constructor&&(br=ar.constructor.name),br==="Map"||br==="Set")return tf(ar);if(br==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(br))return Wy(ar,tr)}}(xe))||he&&xe&&typeof xe.length=="number"){Ue&&(xe=Ue);var Ce=0;return function(){return Ce>=xe.length?{done:!0}:{done:!1,value:xe[Ce++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Wy(xe,he){(he==null||he>xe.length)&&(he=xe.length);for(var Fe=0,Ue=new Array(he);Fe<he;Fe++)Ue[Fe]=xe[Fe];return Ue}var Hh={subType:{type:"string"},setting:{resendFlag:{type:"boolean"},envConfig:{type:"string"},needSaveHistory:{type:"boolean"},needRoaming:{type:"boolean"},needOffline:{type:"boolean"},needSelfSync:{type:"boolean"},needRouted:{type:"boolean"},needUpdateSession:{type:"boolean"},isMuted:{type:"boolean"}},antiSpamInfo:{needAntiSpam:{type:"boolean"},antiSpamContent:{type:"string"},antiSpamBIZID:{type:"string"},clientAntispamHitting:{type:"boolean"},antiSpamUsingYidun:{type:"boolean"},yidunCallbackURL:{type:"string"},yidunAntiCheating:{type:"string"},yidunAntiSpamExtension:{type:"string"},yidunAntiSpamResult:{type:"string"}},pushInfo:zy,teamSpecializationInfo:{needACK:{type:"boolean"},isACKSent:{type:"boolean"},ackSnapshot:{type:"number"}},threadMessageInfo:{replyMsgFromAccount:{type:"string"},replyMsgToAccount:{type:"string"},replyMsgTime:{type:"number"},replyMsgIdServer:{type:"string"},replyMsgIdClient:{type:"string"},threadMsgFromAccount:{type:"string"},threadMsgToAccount:{type:"string"},threadMsgTime:{type:"number"},threadMsgIdServer:{type:"string"},threadMsgIdClient:{type:"string"}}},Yc={0:"addTeamMembers",1:"removeTeamMembers",2:"leaveTeam",3:"updateTeam",4:"dismissTeam",5:"passTeamApply",6:"transferTeam",7:"addTeamManagers",8:"removeTeamManagers",9:"acceptTeamInvite",10:"updateTeamMemberMute",101:"netcallMiss",102:"netcallBill",103:"netcallReject",401:"addSuperTeamMembers",402:"removeSuperTeamMembers",403:"leaveSuperTeam",404:"updateSuperTeam",405:"dismissSuperTeam",406:"transferSuperTeam",407:"addSuperTeamManagers",408:"removeSuperTeamManagers",409:"updateSuperTeamMembersMute",410:"passSuperTeamApply",411:"acceptSuperTeamInvite"};function Vi(xe,he){return is[xe.scene]+"-"+(xe.to===he?xe.from:xe.to)}function mf(xe,he){return xe.from===he?xe.to===he?"in":"out":"in"}function oc(xe,he){var Fe=he.account,Ue=he.featureValue,Ce=he.statusValue,Pt=he.sessionAck,ar=he.msgReceiptTime,tr=is[xe.scene],fr=xe.to===Fe?xe.from:xe.to,br=Ti.default,Nr=Fa.unread;Lo(xe.isInBlackList)>0?(Nr=Fa.refused,delete xe.isInBlackList):Nr=xe.from===Fe?ar&&ar>=+xe.time?Fa.receipt:Fa.sent:Pt&&Pt>=+xe.time?Fa.read:Fa.unread;var Fr=Hr(Hr({},Si(Hh,xe)),{scene:tr,type:Ic[xe.type],fromClientType:fu[xe.fromClientType],flow:mf(xe,Fe),target:fr,to:xe.to,from:xe.from,time:xe.time?+xe.time:void 0,userUpdateTime:xe.userUpdateTime?+xe.userUpdateTime:void 0,idClient:xe.idClient,sessionId:tr+"-"+fr,status:Fa[Ce||Nr],feature:Ti[Ue||br]});if(typeof Fr.attach=="string")try{Fr.attach=JSON.parse(Fr.attach)}catch{}return Fr.type==="notification"&&(Fr.attach=Fr.attach?function(Vr){var Kr,Tn={};if(Tn.type=Yc[Vr.id]||Vr.id,!Vr.data)return Tn;var Mn,En={ids:"accounts",id:"account",attach:"custom",channel:"channelId",calltype:"netcallType",mute:"mute",duration:"duration",time:"time",from:"from",ext:"ext"},In=Vr.data;return Kn(Kr=aa(En)).call(Kr,function(Pn){In[Pn]!==void 0&&(Tn[En[Pn]]=In[Pn])}),In.tinfo&&(Tn.team=Jc(Xi(In.tinfo,xs.team))),In.uinfos&&(Tn.users=Ro(Mn=In.uinfos).call(Mn,function(Pn){return gu(Xi(Pn,hu.user))})),In.mute!==void 0&&(Tn.mute=Lo(In.mute)===1),Tn}(Fr.attach):{}),Fr}function Yd(xe,he){return xe&&xe.length>0?vu(Ro(xe).call(xe,function(Fe){return oc(Fe,he)})):[]}function vu(xe){for(var he,Fe,Ue={},Ce=US(xe);!(Fe=Ce()).done;){var Pt=Fe.value,ar=Ue[Pt.idClient];ar&&ar.time>Pt.time||(Ue[Pt.idClient]=Pt)}return Ro(he=aa(Ue)).call(he,function(tr){return Ue[tr]})}function Ll(xe,he){he===void 0&&(he=!0);var Fe=Hr({},xe);if(Fe.pushInfo&&he){for(var Ue in Fe.pushInfo)typeof Fe.pushInfo[Ue]=="boolean"?Fe[Ue]=Fe.pushInfo[Ue]?1:0:Fe[Ue]=Fe.pushInfo[Ue];delete Fe.pushInfo}return Fe.scene===is.team&&Fe.needForcePush&&(Fe.forcePushContent=Fe.forcePushContent||Fe.pushContent,Fe.forcePushIDsList=Fe.forcePushIDsList?Fe.forcePushIDsList:"#%@all@%#"),Fe}function Xd(xe,he){return Ro(xe).call(xe,function(Fe){var Ue;return Ue=he||(RS(Lo(Fe.scene))?Fe.scene:Lo(Fe.scene)===1?"p2p":"team"),{deletedTime:Lo(Fe.time),from:Fe.from,idClient:Fe.deletedIdClient||Fe.idClient,idServer:Fe.deletedIdServer||Fe.idServer,scene:Ue,time:Lo(Fe.time),to:Fe.to}})}var zh=Array.prototype.reverse,ma=function(he){return he==null?he:zh.call(he)},ia=function(){function xe(he){this.core=he}return xe.prototype.processBroadcastMsg=function(Fe){var Ue=Ro(Fe).call(Fe,function(Ce){return Hr(Hr({},Ce),{time:Lo(Ce.time)})});return this.core.sendCmd("batchMarkRead",{sid:7,cid:17,ids:Ro(Ue).call(Ue,function(Ce){return Ce.id})}),Ue},xe}(),Wh={needPush:{type:"boolean",required:!1},needPushBadge:{type:"boolean",required:!1},needPushNick:{type:"boolean",required:!1},pushContent:{type:"string",allowEmpty:!1,required:!1},pushPayload:{type:"string",allowEmpty:!1,required:!1}},Gy={pushContent:8,pushPayload:9,needPush:107,needPushBadge:109,needPushNick:110},ds={"4_4":"syncOfflineMsgs","4_9":"syncRoamingMsgs","4_17":"syncRoamingMsgs","4_21":"syncDeleteSelfMsgs","7_1":"sendMsg","8_23":"getHistoryTeamMsgs","21_14":"getHistorySuperTeamMsgs","8_2":"sendTeamMsg","21_2":"sendSuperTeamMsg","7_11":"sendMsgReceipt","7_13":"recallMsg","7_24":"deleteSelfMsgs","21_17":"recallSuperTeamMsg","7_2":"onMsg","8_3":"onMsg","21_3":"onMsg","7_101":"onMsg","8_102":"onMsg","21_102":"onMsg","8_4":"nimOnTeamMsgs","4_16":"syncBroadcastMsg","7_17":"onBroadcastMsg","7_123":"onDeleteSelfMsg","7_124":"onDeleteSelfMsgs"},os=Hr({scene:0,to:1,from:2,fromClientType:4,fromDeviceId:5,fromNick:6,time:7,type:8,body:9,attach:10,idClient:11,idServer:12,resendFlag:13,userUpdateTime:14,ext:15,needAntiSpam:21,antiSpamContent:22,antiSpamBIZID:23,clientAntispamHitting:24,antiSpamUsingYidun:25,needACK:26,yidunCallbackURL:27,needUpdateSession:28,replyMsgFromAccount:29,replyMsgToAccount:30,replyMsgTime:31,replyMsgIdServer:32,replyMsgIdClient:33,threadMsgFromAccount:34,threadMsgToAccount:35,threadMsgTime:36,threadMsgIdServer:37,threadMsgIdClient:38,isDeleted:39,callbackExt:40,subType:41,yidunAntiCheating:42,envConfig:43,yidunAntiSpamExtension:44,yidunAntiSpamResult:45,needSaveHistory:100,needRoaming:101,needSelfSync:102,isMuted:104,needRouted:105,isInBlackList:106,needOffline:108,isReplyMsg:111,ackSnapshot:112},{pushContent:17,pushPayload:16,forcePushIDsList:18,forcePushContent:19,needForcePush:20,needPush:107,needPushBadge:109,needPushNick:110}),Xc={msg:os,recallMsgTag:Hr({time:0,type:1,to:2,from:3,ps:4,attach:5,deletedIdClient:10,deletedIdServer:11,opeAccount:16,env:21},Gy),deleteSelfMsgTag:{scene:1,from:2,to:3,idServer:4,idClient:5,time:6,deletedTime:7,ext:8},msgReceiptTag:{to:1,from:2,time:7,idClient:11},broadcastMsg:{id:1,fromAccid:2,time:4,body:5}},_s=Cs(Xc),qS={sendMsg:{sid:7,cid:1,service:"msg",params:[{type:"Property",name:"msg",reflectMapper:Xc.msg}],response:[{type:"Property",name:"msg",reflectMapper:_s.msg}],ignoreErrCodes:[7101]},sendTeamMsg:{sid:8,cid:2,service:"msg",params:[{type:"Property",name:"msg",reflectMapper:Xc.msg}],response:[{type:"Property",name:"msg",reflectMapper:_s.msg}]},sendSuperTeamMsg:{sid:21,cid:2,service:"msg",params:[{type:"Property",name:"msg",reflectMapper:Xc.msg}],response:[{type:"Property",name:"msg",reflectMapper:_s.msg}]},onMsg:{sid:7,cid:2,service:"msg",response:[{type:"Property",name:"msg",reflectMapper:_s.msg}]},nimOnTeamMsgs:{sid:8,cid:4,service:"msg",response:[{type:"PropertyArray",name:"datas",reflectMapper:_s.msg}]},getHistoryTeamMsgs:{sid:8,cid:23,service:"msg",params:[{type:"Long",name:"to"},{type:"Long",name:"beginTime"},{type:"Long",name:"endTime"},{type:"Long",name:"lastMsgId"},{type:"int",name:"limit"},{type:"bool",name:"reverse"},{type:"LongArray",name:"msgTypes"}],response:[{type:"PropertyArray",name:"msgs",reflectMapper:_s.msg}]},getHistorySuperTeamMsgs:{sid:21,cid:14,params:[{type:"Long",name:"to"},{type:"Long",name:"beginTime"},{type:"Long",name:"endTime"},{type:"Long",name:"lastMsgId"},{type:"int",name:"limit"},{type:"bool",name:"reverse"},{type:"LongArray",name:"msgTypes"}],response:[{type:"PropertyArray",name:"msgs",reflectMapper:_s.msg}],service:"msg"},recallMsg:{sid:7,cid:13,service:"msg",params:[{type:"Property",name:"recallMsgTag",reflectMapper:Xc.recallMsgTag}]},deleteSelfMsgs:{sid:7,cid:24,service:"msg",params:[{type:"PropertyArray",name:"deletedMsgs",reflectMapper:Xc.deleteSelfMsgTag}],response:[{type:"Long",name:"timetag"}]},recallSuperTeamMsg:{sid:21,cid:17,service:"msg",params:[{type:"Property",name:"recallMsgTag",reflectMapper:Xc.recallMsgTag}]},sendMsgReceipt:{sid:7,cid:11,service:"msg",params:[{type:"Property",name:"msgReceiptTag",reflectMapper:Xc.msgReceiptTag}],response:[{type:"Property",name:"msgReceiptTag",reflectMapper:_s.msgReceiptTag}]},batchMarkRead:{sid:4,cid:5,service:"msg",isNoResponse:!0,params:[{type:"byte",name:"sid"},{type:"byte",name:"cid"},{type:"LongArray",name:"ids"}]},syncMsgReceipts:{sid:4,cid:12,service:"msg",response:[{type:"PropertyArray",name:"msgReceipts",reflectMapper:_s.msgReceiptTag},{type:"Number",name:"timetag"}]},syncOfflineMsgs:{sid:4,cid:4,service:"msg",response:[{type:"PropertyArray",name:"msgs",reflectMapper:_s.msg}]},syncRoamingMsgs:{sid:4,cid:9,service:"msg",response:[{type:"PropertyArray",name:"msgs",reflectMapper:_s.msg}]},syncBroadcastMsg:{sid:4,cid:16,service:"msg",response:[{type:"PropertyArray",name:"msgs",reflectMapper:_s.broadcastMsg}]},onBroadcastMsg:{sid:7,cid:17,service:"msg",response:[{type:"Property",name:"msg",reflectMapper:_s.broadcastMsg}]},onDeleteSelfMsg:{sid:7,cid:123,service:"msg",response:[{type:"Property",name:"deletedMsg",reflectMapper:_s.deleteSelfMsgTag}]},onDeleteSelfMsgs:{sid:7,cid:124,service:"msg",response:[{type:"PropertyArray",name:"deletedMsgs",reflectMapper:_s.deleteSelfMsgTag}]},syncDeleteSelfMsgs:{sid:4,cid:21,service:"msg",response:[{type:"PropertyArray",name:"deletedMsgs",reflectMapper:_s.deleteSelfMsgTag}]}},Ky=function(xe){function he(Ue){var Ce;return(Ce=xe.call(this,"msg",Ue)||this).service=new ia(Ue),ls({cmdMap:ds,cmdConfig:qS}),Ce}Ko(he,xe);var Fe=he.prototype;return Fe.sendTextMsg=function(Ce){return Qn({body:{type:"string",allowEmpty:!1}},Ce),this.sendMsg(Hr(Hr({},Ce),{type:"text"}))},Fe.sendTipMsg=function(Ce){return Qn({body:{type:"string",allowEmpty:!1}},Ce),this.sendMsg(Hr(Hr({},Ce),{type:"tip"}))},Fe.sendGeoLocationMsg=function(Ce){return Qn({attach:{type:"object",rules:{title:{type:"string",allowEmpty:!1},lat:{type:"number"},lng:{type:"number"}}}},Ce),this.sendMsg(Hr(Hr({},Ce),{type:"geo",attach:la(Ce.attach)}))},Fe.sendCustomMsg=function(Ce){return Qn({attach:{type:"string",allowEmpty:!1}},Ce),this.sendMsg(Hr(Hr({},Ce),{type:"custom"}))},Fe.sendMsg=function(Ce){var Pt,ar,tr=this;!((Pt=this.core.sync)===null||Pt===void 0)&&Pt.getSyncDoneFlag()||this.logger.warn("Please send message after syncdone event"),Qn({scene:{type:"enum",values:Ui(is)},type:{type:"enum",values:Ui(Ic)},to:{type:"string",allowEmpty:!1},ext:{type:"string",required:!1},setting:{type:"object",rules:{resendFlag:{type:"boolean",required:!1},needSaveHistory:{type:"boolean",required:!1},needRoaming:{type:"boolean",required:!1},needOffline:{type:"boolean",required:!1},needSelfSync:{type:"boolean",required:!1},needRouted:{type:"boolean",required:!1},needUpdateSession:{type:"boolean",required:!1}},required:!1},antiSpamInfo:{type:"object",required:!1,rules:{clientAntispamHitting:{type:"boolean",required:!1},antiSpamUsingYidun:{type:"boolean",required:!1}}},pushInfo:{type:"object",required:!1,rules:zy},teamSpecializationInfo:{type:"object",required:!1,rules:{needACK:{type:"boolean",required:!1}}}},Ce);var fr,br=Ce.scene==="p2p"?"sendMsg":Ce.scene==="team"?"sendTeamMsg":"sendSuperTeamMsg",Nr=function(Vr,Kr,Tn,Mn){Vr.onSendBefore,Vr.onUploadStart,Vr.onUploadDone;var En=Vr.replyMsg,In=Ys(Vr,["onSendBefore","onUploadStart","onUploadDone","replyMsg"]),Pn=Hr(Hr({},Wd(Hh,In)),{scene:is[Vr.scene],type:Ic[Vr.type],from:Kr,fromClientType:16,fromDeviceId:Tn,fromNick:Mn==null?void 0:Mn.nick,userUpdateTime:Mn==null?void 0:Mn.updateTime,status:Fa[Fa.sending]});if(Pn.idClient=Pn.resendFlag?Vr.idClient:Yp(),!Pn.idClient)throw new zg("idClient is required to resend a message","idClient","required");return Pn=Ll(Pn,!1),En&&(Pn.replyMsgFromAccount=En.from,Pn.replyMsgToAccount=En.to,Pn.replyMsgTime=+En.time,Pn.replyMsgIdServer=En.idServer,Pn.replyMsgIdClient=En.idClient,Pn.threadMsgFromAccount=En.from,Pn.threadMsgToAccount=En.to,Pn.threadMsgTime=+En.time,Pn.threadMsgIdServer=En.idServer,Pn.threadMsgIdClient=En.idClient,En.threadMessageInfo&&En.threadMessageInfo.threadMsgIdServer&&(Pn.threadMsgFromAccount=En.threadMessageInfo.threadMsgFromAccount,Pn.threadMsgToAccount=En.threadMessageInfo.threadMsgToAccount,Pn.threadMsgTime=En.threadMessageInfo.threadMsgTime,Pn.threadMsgIdServer=En.threadMessageInfo.threadMsgIdServer,Pn.threadMsgIdClient=En.threadMessageInfo.threadMsgIdClient)),Pn}(Ce,this.core.account,this.core.config.deviceId,(ar=this.core.user)===null||ar===void 0?void 0:ar.myInfo),Fr=oc(Hr(Hr({},Nr),{time:new Date().getTime()}),{account:this.core.account,featureValue:Ti.default,statusValue:Fa.sending});try{Ce.onSendBefore&&Ce.onSendBefore(Fr)}catch(jr){this.logger.error("sendMsg: options.onSendBefore error",jr)}return this.core.eventBus.emit("session/updateForNewMsg",Fr),this.core.sendCmd(br,{msg:Nr}).then(function(jr){var Vr=jr.content,Kr=jr.error;if(fr=Vr.msg,Kr)throw Kr;var Tn=oc(Hr(Hr({},Nr),Vr.msg),{account:tr.core.account,featureValue:Ti.default,statusValue:Fa.sent});return Tn.from===Tn.to&&tr.markMsgsAck([Tn]),tr.core.eventBus.emit("session/updateForNewMsg",Tn),tr.core.reporter.report("msgSend",{msgId:Tn.idServer,clientId:Tn.idClient,msgTime:Tn.time,fromAccid:Ce.scene==="p2p"?tr.core.account:"",toAccid:Tn.to,type:is[Tn.scene],roomId:"",tid:Ce.scene==="p2p"?"":Tn.to,result:200,faiReason:"",rt:wa()-Fr.time}),Tn}).catch(function(jr){var Vr=oc(Hr(Hr(Hr({},Nr),{time:new Date().getTime()}),fr),{account:tr.core.account,featureValue:Ti.default,statusValue:jr.code===7101?Fa.refused:Fa.sendFailed});throw jr.msg=Vr,tr.core.eventBus.emit("session/updateForNewMsg",Vr),tr.core.reporter.report("msgSend",{msgId:Vr.idServer,clientId:Vr.idClient,msgTime:Vr.time,fromAccid:Ce.scene==="p2p"?tr.core.account:"",toAccid:Vr.to,type:is[Vr.scene],roomId:"",tid:Ce.scene==="p2p"?"":Vr.to,result:jr==null?void 0:jr.code,faiReason:(jr==null?void 0:jr.message)||"",rt:wa()-Fr.time}),jr})},Fe.resendMsg=function(Ce){return Un(this,void 0,void 0,wr.mark(function Pt(){var ar,tr;return wr.wrap(function(br){for(;;)switch(br.prev=br.next){case 0:if(Qn({msg:{type:"object",rules:{idClient:{type:"string",allowEmpty:!1}}}},Ce),ar=Ce.msg,tr=Hr(Hr({},ar),{attach:ar.attach?la(ar.attach):void 0,setting:{resendFlag:!0}}),ar.from===this.core.account){br.next=5;break}throw new Error("You can only resend messages that you sent: "+ar.idClient);case 5:return br.abrupt("return",this.sendMsg(tr));case 6:case"end":return br.stop()}},Pt,this)}))},Fe.forwardMsg=function(Ce){return Un(this,void 0,void 0,wr.mark(function Pt(){var ar,tr;return wr.wrap(function(br){for(;;)switch(br.prev=br.next){case 0:return Qn({msg:{type:"object",rules:{idClient:{type:"string",allowEmpty:!1}}},scene:{type:"enum",values:Ui(is)},to:{type:"string",allowEmpty:!1}},Ce),ar=Ce.msg,tr=Hr(Hr({},ar),{scene:Ce.scene,to:Ce.to,attach:ar.attach?la(ar.attach):void 0}),br.abrupt("return",this.sendMsg(tr));case 4:case"end":return br.stop()}},Pt,this)}))},Fe.sendImageMsg=function(Ce){return this.doSendFile(Hr(Hr({},Ce),{type:"image"}))},Fe.sendFileMsg=function(Ce){return this.doSendFile(Hr(Hr({},Ce),{type:"file"}))},Fe.sendAudioMsg=function(Ce){return this.doSendFile(Hr(Hr({},Ce),{type:"audio"}))},Fe.sendVideoMsg=function(Ce){return this.doSendFile(Hr(Hr({},Ce),{type:"video"}))},Fe.doSendFile=function(Ce){return Un(this,void 0,void 0,wr.mark(function Pt(){var ar,tr;return wr.wrap(function(br){for(;;)switch(br.prev=br.next){case 0:if(Qn({scene:{type:"enum",values:Ui(is)},to:{type:"string",allowEmpty:!1},type:{type:"string",allowEmpty:!1},attach:{type:"object",rules:{url:{type:"string",allowEmpty:!1}},required:!1},maxSize:{type:"number",min:1,required:!1}},Ce),ar=Ce.attach){br.next=28;break}if(this.core.cloudStorage&&this.core.cloudStorage.uploadFile){br.next=5;break}throw new Error('Service "cloudStorage" does not exist');case 5:return br.prev=5,this.core.reporter.reportTraceStart("nos",{user_id:this.core.account,action:"upload"}),br.next=9,this.core.cloudStorage.uploadFile(Ce);case 9:ar=br.sent,this.core.reporter.reportTraceEnd("nos",!0),br.next=20;break;case 13:throw br.prev=13,br.t0=br.catch(5),tr=br.t0,this.core.reporter.reportTraceUpdateV2("nos",{operation_type:"transfer",description:tr.message,code:tr.code||0,target:"",succeed:!1}),this.core.reporter.reportTraceEnd("nos",!1),this.logger.error("sendFile:: upload File error or abort",br.t0),br.t0;case 20:br.prev=20,Ce.onUploadDone&&Ce.onUploadDone(ar),br.next=28;break;case 24:throw br.prev=24,br.t1=br.catch(20),this.logger.error("sendFile options.onUploadDone err",br.t1),br.t1;case 28:return br.abrupt("return",this.sendMsg(Hr(Hr({},Ce),{attach:la(ar),type:Ce.type})));case 29:case"end":return br.stop()}},Pt,this,[[5,13],[20,24]])}))},Fe.recallMsg=function(Ce){var Pt;return Un(this,void 0,void 0,wr.mark(function ar(){var tr,fr,br;return wr.wrap(function(Fr){for(;;)switch(Fr.prev=Fr.next){case 0:return!((Pt=this.core.sync)===null||Pt===void 0)&&Pt.getSyncDoneFlag()||this.logger.warn("Please call recallMsg after syncdone event"),Qn({msg:{type:"object",rules:{idClient:{type:"string",allowEmpty:!1},idServer:{type:"string",allowEmpty:!1},scene:{type:"enum",values:Ui(is)},time:{type:"number"}}},pushInfo:{type:"object",required:!1,rules:Wh},ps:{type:"string",allowEmpty:!1,required:!1}},Ce),tr=Ce.msg,fr={p2p:"recallMsg",team:"recallMsg",superTeam:"recallSuperTeamMsg"},br={p2p:7,team:8,superTeam:12},Fr.next=7,this.core.sendCmd(fr[tr.scene],{recallMsgTag:Ll({time:tr.time,type:br[tr.scene],to:tr.to,from:tr.from,ps:Ce.ps,attach:Ce.attach,deletedIdClient:tr.idClient,deletedIdServer:tr.idServer,opeAccount:tr.from,env:Ce.env,pushInfo:Ce.pushInfo})});case 7:return this.core.eventBus.emit("session/updateForDeletedMsg",Xd([tr])),Fr.abrupt("return",tr);case 9:case"end":return Fr.stop()}},ar,this)}))},Fe.deleteSelfMsgs=function(Ce){var Pt;return Un(this,void 0,void 0,wr.mark(function ar(){var tr,fr,br;return wr.wrap(function(Fr){for(;;)switch(Fr.prev=Fr.next){case 0:return!((Pt=this.core.sync)===null||Pt===void 0)&&Pt.getSyncDoneFlag()||this.logger.warn("Please call deleteSelfMsgs after syncdone event"),Qn({msgs:{type:"array",rules:{scene:{type:"enum",values:["p2p","team"]},from:{type:"string",allowEmpty:!1},to:{type:"string",allowEmpty:!1},idServer:{type:"string",allowEmpty:!1},idClient:{type:"string",allowEmpty:!1},time:{type:"number",allowEmpty:!1}}},ext:{type:"string",allowEmpty:!1,required:!1}},Ce),tr=Ce.msgs,fr=Ro(tr).call(tr,function(jr){return{scene:jr.scene==="p2p"?1:2,from:jr.from,to:jr.to,idServer:jr.idServer,idClient:jr.idClient,time:jr.time,ext:Ce.ext}}),Fr.next=6,this.core.sendCmd("deleteSelfMsgs",{deletedMsgs:fr});case 6:return br=Xd(fr),this.core.eventBus.emit("session/updateForDeletedMsg",br),Fr.abrupt("return",br);case 9:case"end":return Fr.stop()}},ar,this)}))},Fe.sendMsgReceipt=function(Ce){var Pt,ar,tr;return Un(this,void 0,void 0,wr.mark(function fr(){var br,Nr,Fr,jr;return wr.wrap(function(Kr){for(;;)switch(Kr.prev=Kr.next){case 0:if(!((Pt=this.core.sync)===null||Pt===void 0)&&Pt.getSyncDoneFlag()||this.logger.warn("Please call sendMsgReceipt after syncdone event"),Qn({msg:{type:"object",rules:{idClient:{type:"string",allowEmpty:!1},target:{type:"string",allowEmpty:!1},time:{type:"number"}}}},Ce),(br=Ce.msg).scene==="p2p"&&br.flow==="in"){Kr.next=6;break}return this.logger.warn("Msg scene: "+br.scene+", flow: "+br.flow+" is not allowed to send msg receipt"),Kr.abrupt("return",void 0);case 6:return Nr={to:br.target,idClient:br.idClient,time:br.time},Kr.next=9,this.core.sendCmd("sendMsgReceipt",{msgReceiptTag:Nr});case 9:return Fr=Kr.sent,jr=Lo((tr=(ar=Fr.content)===null||ar===void 0?void 0:ar.msgReceiptTag)===null||tr===void 0?void 0:tr.time),Kr.abrupt("return",Hr(Hr({},Nr),{time:jr?Math.min(jr,Nr.time):Nr.time}));case 12:case"end":return Kr.stop()}},fr,this)}))},Fe.sendTeamMsgReceipt=function(Ce){var Pt;return Un(this,void 0,void 0,wr.mark(function ar(){var tr;return wr.wrap(function(br){for(;;)switch(br.prev=br.next){case 0:return!((Pt=this.core.sync)===null||Pt===void 0)&&Pt.getSyncDoneFlag()||this.logger.warn("Please call sendTeamMsgReceipt after syncdone event"),Qn({teamMsgReceipts:{type:"array",rules:{teamId:{type:"string",allowEmpty:!1},idClient:{type:"string",allowEmpty:!1},idServer:{type:"string",allowEmpty:!1}},max:50}},Ce),tr=Ce.teamMsgReceipts,this.core.sendCmd("sendTeamMsgReceipt",{teamMsgReceipts:tr}),br.abrupt("return",void 0);case 5:case"end":return br.stop()}},ar,this)}))},Fe.getTeamMsgReads=function(Ce){var Pt;return Un(this,void 0,void 0,wr.mark(function ar(){var tr,fr,br;return wr.wrap(function(Fr){for(;;)switch(Fr.prev=Fr.next){case 0:return Qn({teamMsgReceipts:{type:"array",rules:{teamId:{type:"string",allowEmpty:!1},idClient:{type:"string",allowEmpty:!1},idServer:{type:"string",allowEmpty:!1}}}},Ce),tr=Ce.teamMsgReceipts,Fr.next=4,this.core.sendCmd("getTeamMsgReads",{teamMsgReceipts:tr});case 4:return fr=Fr.sent,br=(br=(Pt=fr.content)===null||Pt===void 0?void 0:Pt.teamMsgReceipts)?Ro(br).call(br,function(jr){return Hr(Hr({},jr),{read:Lo(jr.read),unread:Lo(jr.unread)})}):[],Fr.abrupt("return",br);case 8:case"end":return Fr.stop()}},ar,this)}))},Fe.getTeamMsgReadAccounts=function(Ce){return Un(this,void 0,void 0,wr.mark(function Pt(){var ar,tr;return wr.wrap(function(br){for(;;)switch(br.prev=br.next){case 0:return Qn({teamMsgReceipt:{type:"object",rules:{teamId:{type:"string",allowEmpty:!1},idClient:{type:"string",allowEmpty:!1},idServer:{type:"string",allowEmpty:!1}}}},Ce),ar=Ce.teamMsgReceipt,br.next=4,this.core.sendCmd("getTeamMsgReadAccounts",{teamMsgReceiptTag:ar});case 4:return tr=br.sent,br.abrupt("return",tr.content);case 6:case"end":return br.stop()}},Pt,this)}))},Fe.markMsgsAck=function(Ce){if(Ce&&Ce.length>0){var Pt=[],ar=[];Kn(Ce).call(Ce,function(tr){tr.scene==="p2p"&&tr.flow==="in"?Pt.push(tr):tr.scene==="team"&&tr.flow==="in"&&ar.push(tr)}),Pt.length>0&&this.core.sendCmd("batchMarkRead",{sid:7,cid:2,ids:Ro(Pt).call(Pt,function(tr){return tr.idServer})}),ar.length>0&&this.core.sendCmd("batchMarkRead",{sid:8,cid:3,ids:Ro(ar).call(ar,function(tr){return tr.idServer})})}},Fe.onMsgHandler=function(Ce){var Pt;if(Ce.error)this.logger.error("msgHandler::recvError",Ce.error);else{var ar=typeof Zs(Ce,"raw.r[0]")=="number"?""+Ce.raw.r[0]:void 0,tr=Ce.content.msg;tr.idServer=tr.idServer||ar;var fr=wa(),br=Vi(tr,this.core.account),Nr=(Pt=this.core.session)===null||Pt===void 0?void 0:Pt.getSessionWithUncomplete({id:br}),Fr=oc(tr,Nr?{account:this.core.account,sessionAck:Nr.ack,msgReceiptTime:Nr.msgReceiptTime}:{account:this.core.account});if(this.core.options.debugLevel==="debug"?this.logger.debug("msgHandler::recvMsg",Fr.idClient,Fr.idServer,Fr):this.logger.log("msgHandler::recvMsg",Fr.idClient,Fr.idServer),this.markMsgsAck([Fr]),this.core.eventBus.emit("session/updateForNewMsg",Fr),this.core.emit("msg",Fr),Fr.type==="notification")this.core.eventBus.emit("team/onNotification",Fr);else if(Fr.flow!=="out"){var jr=Fr.scene==="p2p",Vr={msgId:Fr.idServer,clientId:Fr.idClient,receiveTime:Ce.__receiveTime,serverTime:Fr.time,callbackTime:wa(),preHandleTime:fr,fromAccid:Fr.from,toAccid:this.core.account,type:is[Fr.scene],tid:jr?"":Fr.to,result:200,failReason:"",rt:wa()-Fr.time};this.core.reporter.report("msgReceive",Vr,!0)}}},Fe.nimOnTeamMsgsHandler=function(Ce){var Pt,ar=this;Kn(Pt=Ce.content.datas).call(Pt,function(tr){ar.onMsgHandler(Hr({},Ce,{content:{msg:tr}}))})},Fe.syncRoamingMsgsHandler=function(Ce){var Pt,ar,tr=Ce.content.msgs||[];if(tr.length!==0){var fr=Vi(tr[0],this.core.account),br=(Pt=this.core.session)===null||Pt===void 0?void 0:Pt.getSessionWithUncomplete({id:fr}),Nr=(tr=Yd(tr,br?{account:this.core.account,featureValue:Ti.roam,sessionAck:br.ack,msgReceiptTime:br.msgReceiptTime}:{account:this.core.account,featureValue:Ti.roam}))[0].time,Fr={timetag:Nr,sessionId:fr,msgs:ma(tr)};!((ar=this.core.sync)===null||ar===void 0)&&ar.getSyncDoneFlag()||this.core.eventBus.emit("session/syncMsgs",Fr),this.core.emit("syncRoamingMsgs",Fr),this.core.eventBus.emit("sync/updateTimetag",{roamingMsgs:Nr})}},Fe.syncOfflineMsgsHandler=function(Ce){var Pt,ar=this,tr=Ce.content.msgs||[];if(tr.length!==0){var fr={},br=[];Kn(tr).call(tr,function(Fr){var jr=Vi(Fr,ar.core.account),Vr=ar.core.session.getSessionWithUncomplete({id:jr}),Kr=oc(Fr,Vr?{account:ar.core.account,featureValue:Ti.leave,sessionAck:Vr.ack,msgReceiptTime:Vr.msgReceiptTime}:{account:ar.core.account,featureValue:Ti.leave});br.push(Kr),fr[Kr.sessionId]?fr[Kr.sessionId].push(Kr):fr[Kr.sessionId]=[Kr]}),this.markMsgsAck(br);var Nr=0;Kn(Pt=aa(fr)).call(Pt,function(Fr){var jr,Vr=Qc(jr=fr[Fr]).call(jr,function(Tn,Mn){return Mn.time-Tn.time});(Vr=vu(Vr))[0].time>Nr&&(Nr=Vr[0].time);var Kr={timetag:Vr[0].time,sessionId:Fr,msgs:Vr};ar.core.eventBus.emit("session/syncMsgs",Kr),ar.core.emit("syncOfflineMsgs",Kr)}),this.core.eventBus.emit("sync/updateTimetag",{offlineMsgs:Nr})}},Fe.syncDeleteSelfMsgsHandler=function(Ce){var Pt,ar=(Pt=Ce.content)===null||Pt===void 0?void 0:Pt.deletedMsgs;ar&&ar.length>0||this.logger.warn("syncDeleteSelfMsgs:: no msgs");var tr=ar[ar.length-1].time;this.core.eventBus.emit("sync/updateTimetag",{deleteSelfMsgs:tr})},Fe.onDeleteSelfMsgHandler=function(Ce){var Pt=Xd([Ce.content.deletedMsg]);this.core.eventBus.emit("session/updateForDeletedMsg",Pt),this.core.emit("deleteSelfMsgs",Pt)},Fe.onDeleteSelfMsgsHandler=function(Ce){var Pt=Xd(Ce.content.deletedMsgs);this.core.eventBus.emit("session/updateForDeletedMsg",Pt),this.core.emit("deleteSelfMsgs",Pt)},Fe.onBroadcastMsgHandler=function(Ce){var Pt=Ce.content.msg,ar=this.service.processBroadcastMsg([Pt]);this.core.emit("broadcastMsgs",ar)},Fe.syncBroadcastMsgHandler=function(Ce){var Pt=Ce.content.msgs,ar=this.service.processBroadcastMsg(Pt);this.core.emit("broadcastMsgs",ar)},he}(ws),VS={"5_1":"sync"},HS={sync:{sid:5,cid:1,service:"sync",isNoResponse:!0,params:[{type:"Property",name:"sync",reflectMapper:{myInfo:1,offlineMsgs:2,teams:3,roamingMsgs:7,relations:9,friends:11,friendUsers:13,msgReceipts:14,myTeamMembers:15,donnop:16,recallMsg:17,sessionAck:18,broadcastMsgs:20,signaling:21,superTeams:22,mySuperTeamMembers:23,superTeamRoamingMsgs:24,deleteSuperTeamMsg:25,superTeamSessionAck:26,deleteSelfMsgs:27,stickTopSessions:28,sessionHistoryMsgsDelete:29}}],response:[{type:"Number",name:"timetag"}]}},gf=function(xe){function he(Ue,Ce){var Pt;return Ce===void 0&&(Ce={}),(Pt=xe.call(this,"sync",Ue)||this).options=Ce,Pt.syncDoneFlag=!1,Pt.options=Hr({myInfo:!!Ue.user.name,offlineMsgs:!!Ue.msg.name,teams:!!Ue.team.name,myTeamMembers:!!Ue.team.name,roamingMsgs:!!Ue.msg.name,relations:!!Ue.user.name,friends:!!Ue.friend.name,friendUsers:!!Ue.user.name,msgReceipts:!!Ue.msg.name,recallMsg:!!Ue.msg.name,sessionAck:!!Ue.session.name,superTeamSessionAck:!!Ue.session.name,superTeams:!!Ue.superTeam.name,mySuperTeamMembers:!!Ue.superTeam.name,superTeamRoamingMsgs:!!Ue.superTeam.name,deleteSuperTeamMsg:!!Ue.superTeam.name,deleteSelfMsgs:!!Ue.msg.name,sessionHistoryMsgsDelete:!!Ue.msgLog.name,signaling:!!Ue.signaling.name},Ce),Pt.timetags={},Pt.pArray=[],Pt.initEventListeners(),ls({cmdMap:VS,cmdConfig:HS}),Pt}Ko(he,xe);var Fe=he.prototype;return Fe.getSyncDoneFlag=function(){return this.syncDoneFlag},Fe.doSync=function(){return Un(this,void 0,void 0,wr.mark(function Ce(){var Pt;return wr.wrap(function(tr){for(;;)switch(tr.prev=tr.next){case 0:return Pt=this.genSyncParams(),this.logger.log("doSync: ",Pt),tr.next=4,this.core.sendCmd("sync",{sync:Pt});case 4:case"end":return tr.stop()}},Ce,this)}))},Fe.initEventListeners=function(){var Ce=this;this.core.eventBus.on("sync/updateTimetag",function(Pt){var ar;Kn(ar=aa(Pt)).call(ar,function(tr){Pt[tr]>(Ce.timetags[tr]||0)&&(Ce.timetags[tr]=Pt[tr])})}),this.core.eventBus.on("logined",function(){Ce.syncDoneFlag=!1})},Fe.genSyncParams=function(){var Ce,Pt,ar=this;return Pp(Ce=Is(Pt=aa(this.options)).call(Pt,function(tr){var fr=tr;return ar.options[fr]})).call(Ce,function(tr,fr){var br=fr;return tr[br]=ar.timetags[br]||0,tr},{})},Fe.handleImmediate=function(Ce){var Pt;this.core.session&&this.core.session.onSyncDone&&this.core.session.onSyncDone(),this.logger.log("sync: emit syncdone",(Pt=Ce.content)===null||Pt===void 0?void 0:Pt.timetag),this.syncDoneFlag=!0,this.core.emit("syncdone")},Fe.syncHandler=function(Ce){var Pt=this;(function(){return typeof tt<"u"&&tt.getSystemInfo?"TT":typeof swan<"u"&&swan.getSystemInfo?"BAIDU":typeof my<"u"&&my.getSystemInfo?"ALI":typeof wx<"u"&&wx.getSystemInfo?"WX":"unknow environment"})()==="ALI"?(this.logger.log("sync: emit ALIAPP sycnHandler, handle later"),Ao(function(){Pt.handleImmediate(Ce)},100)):this.handleImmediate(Ce)},he}(ws),$a={"6_26":"getNosCdnHost"},Qy={getNosCdnHost:{sid:6,cid:26,service:"misc",response:[{type:"Property",name:"nosConfigTag",reflectMapper:Cs({nosConfigTag:{bucket:1,cdnDomain:2,expire:3,objectNamePrefix:4}}).nosConfigTag}]}},zS=function(xe){function he(Fe){var Ue;return(Ue=xe.call(this,"misc",Fe)||this).core=Fe,Ue.nosCdnHostTimer=0,ls({cmdMap:$a,cmdConfig:Qy}),Ue}return Ko(he,xe),he}(ws),yu=function(he,Fe,Ue){Fe=="__proto__"&&Ld?Ld(he,Fe,{configurable:!0,enumerable:!0,value:Ue,writable:!0}):he[Fe]=Ue},Jy=Object.prototype.hasOwnProperty,hf=function(he,Fe,Ue){var Ce=he[Fe];Jy.call(he,Fe)&&xc(Ce,Ue)&&(Ue!==void 0||Fe in he)||yu(he,Fe,Ue)},Gh=function(he,Fe,Ue,Ce){if(!$i(he))return he;for(var Pt=-1,ar=(Fe=Vd(Fe,he)).length,tr=ar-1,fr=he;fr!=null&&++Pt<ar;){var br=Rl(Fe[Pt]),Nr=Ue;if(br==="__proto__"||br==="constructor"||br==="prototype")return he;if(Pt!=tr){var Fr=fr[br];(Nr=Ce?Ce(Fr,br,fr):void 0)===void 0&&(Nr=$i(Fr)?Fr:df(Fe[Pt+1])?[]:{})}hf(fr,br,Nr),fr=fr[br]}return he},Yy=function(he,Fe,Ue){for(var Ce=-1,Pt=Fe.length,ar={};++Ce<Pt;){var tr=Fe[Ce],fr=yh(he,tr);Ue(fr,tr)&&Gh(ar,Vd(tr,he),fr)}return ar},WS=function(he,Fe){return he!=null&&Fe in Object(he)},GS=function(he,Fe,Ue){for(var Ce=-1,Pt=(Fe=Vd(Fe,he)).length,ar=!1;++Ce<Pt;){var tr=Rl(Fe[Ce]);if(!(ar=he!=null&&Ue(he,tr)))break;he=he[tr]}return ar||++Ce!=Pt?ar:!!(Pt=he==null?0:he.length)&&sh(Pt)&&df(tr,Pt)&&(qi(he)||Gd(he))},Zd=function(he,Fe){return he!=null&&GS(he,Fe,WS)},Kh=function(he,Fe){return Yy(he,Fe,function(Ue,Ce){return Zd(he,Ce)})},bu=function(he,Fe){for(var Ue=-1,Ce=Fe.length,Pt=he.length;++Ue<Ce;)he[Pt+Ue]=Fe[Ue];return he},Ac=vi?vi.isConcatSpreadable:void 0,KS=function(he){return qi(he)||Gd(he)||!!(Ac&&he&&he[Ac])},Zc=function xe(he,Fe,Ue,Ce,Pt){var ar=-1,tr=he.length;for(Ue||(Ue=KS),Pt||(Pt=[]);++ar<tr;){var fr=he[ar];Fe>0&&Ue(fr)?Fe>1?xe(fr,Fe-1,Ue,Ce,Pt):bu(Pt,fr):Ce||(Pt[Pt.length]=fr)}return Pt},QS=function(he){return he!=null&&he.length?Zc(he,1):[]},ep=function(he){return Zv(qp(he,void 0,QS),he+"")}(function(xe,he){return xe==null?{}:Kh(xe,he)}),Xy=function(xe){function he(Ue){var Ce;return(Ce=xe.call(this,"user",Ue)||this).myInfo=gu({}),ls({cmdMap:Hy,cmdConfig:DS}),Ce}Ko(he,xe);var Fe=he.prototype;return Fe.setBlack=function(Ce){return Qn({account:{type:"string",allowEmpty:!1},isAdd:{type:"boolean"}},Ce),this.core.sendCmd("setBlack",Ce).then(function(){})},Fe.setMute=function(Ce){return Qn({account:{type:"string",allowEmpty:!1},isAdd:{type:"boolean"}},Ce),this.core.sendCmd("setMute",Ce).then(function(){})},Fe.getRelations=function(){return this.core.sendCmd("syncRelations",{timetag:0})},Fe.getBlackList=function(){return Un(this,void 0,void 0,wr.mark(function Ce(){var Pt;return wr.wrap(function(tr){for(;;)switch(tr.prev=tr.next){case 0:return tr.next=2,this.core.sendCmd("syncRelations",{timetag:0});case 2:return Pt=tr.sent,tr.abrupt("return",Pt.blackList||[]);case 4:case"end":return tr.stop()}},Ce,this)}))},Fe.getMuteList=function(){return Un(this,void 0,void 0,wr.mark(function Ce(){var Pt;return wr.wrap(function(tr){for(;;)switch(tr.prev=tr.next){case 0:return tr.next=2,this.core.sendCmd("syncRelations",{timetag:0});case 2:return Pt=tr.sent,tr.abrupt("return",Pt.muteList||[]);case 4:case"end":return tr.stop()}},Ce,this)}))},Fe.updatePushToken=function(){return Un(this,void 0,void 0,wr.mark(function Ce(){return wr.wrap(function(ar){for(;;)switch(ar.prev=ar.next){case 0:this.logger.error("This function is deprecated, please use nim.offlinePush.setOfflinePushConfig instead");case 1:case"end":return ar.stop()}},Ce,this)}))},Fe.updateAppBackground=function(){return Un(this,void 0,void 0,wr.mark(function Ce(){return wr.wrap(function(ar){for(;;)switch(ar.prev=ar.next){case 0:this.logger.error("This function is deprecated, please use nim.offlinePush.setOfflinePushConfig instead");case 1:case"end":return ar.stop()}},Ce,this)}))},Fe.getUsersNameCardFromServer=function(Ce){var Pt=this;return Qn({accounts:{type:"array",max:150,itemType:"string"}},Ce),this.core.sendCmd("getUsersNameCardFromServer",ep(Ce,["accounts"])).then(function(ar){var tr,fr=ar.content;return Pt.logger.log("user:: getUsers done",Ce.accounts),fr&&fr.users?Ro(tr=fr.users).call(tr,function(br){return gu(br)}):[]})},Fe.updateMyNameCard=function(Ce){var Pt=this;if(Qn({nick:{type:"string",required:!1},avatar:{type:"string",required:!1},signature:{type:"string",required:!1},gender:{type:"enum",values:Ui(Qd),required:!1},email:{type:"string",required:!1},birth:{type:"string",required:!1},tel:{type:"string",required:!1},ext:{type:"string",required:!1}},Ce),aa(Ce).length===0)return wo.resolve(this.myInfo);var ar=ep(Ce,["nick","avatar","signature","email","birth","tel","ext"]);return Ce.gender&&(ar.gender=Qd[Ce.gender]),this.core.sendCmd("updateMyNameCard",{user:ar}).then(function(tr){var fr=tr.content;return fr&&fr.timetag&&Pt.core.eventBus.emit("sync/updateTimetag",{myInfo:+fr.timetag}),Ce.gender&&(ar.gender=Ce.gender),Pt.myInfo=Hr({},Pt.myInfo,ar),Pt.myInfo})},Fe.onUpdateBlackListHandler=function(Ce){var Pt=Ce.content;Pt.account?this.core.emit("updateBlackList",Pt):this.logger.warn("onUpdateBlackListHandler: no account")},Fe.onUpdateMuteListHandler=function(Ce){var Pt=Ce.content;Pt.account?this.core.emit("updateMuteList",Pt):this.logger.warn("onUpdateBlackListHandler: no account")},Fe.syncRelationsHandler=function(Ce){var Pt=Ce.content,ar=Pt.list,tr=Pt.timetag,fr={blackList:[],muteList:[]};return tr&&this.core.eventBus.emit("sync/updateTimetag",{relations:tr}),ar&&ar.length&&Kn(ar).call(ar,function(br){var Nr=function(jr){var Vr={account:jr.account,updateTime:+jr.updateTime,createTime:+jr.createTime};return jr.isMuted==="1"&&(Vr.isMuted=!0),jr.isBlack==="1"&&(Vr.isBlack=!0),Vr}(br);Nr.isBlack&&fr.blackList.push(Nr),Nr.isMuted&&fr.muteList.push(Nr)}),this.core.emit("relations",fr),wo.resolve(fr)},Fe.syncMyNameCardHandler=function(Ce){Ce.content.user&&(this.myInfo=gu(Ce.content.user),this.core.emit("syncMyNameCard",this.myInfo),this.core.eventBus.emit("sync/updateTimetag",{myInfo:Ce.content.timetag}))},Fe.onUpdateMyNameCardHandler=function(Ce){var Pt=Ce.content.user;Pt?(Hr(this.myInfo,gu(Pt)),this.core.emit("updateMyNameCard",this.myInfo)):this.logger.warn("onUpdateMyNameCardHandler no user info")},he}(ws),vf=function(){this.__data__=new Fp,this.size=0},Ia=function(he){var Fe=this.__data__,Ue=Fe.delete(he);return this.size=Fe.size,Ue},Mi=function(he){return this.__data__.get(he)},jl=function(he){return this.__data__.has(he)},JS=function(he,Fe){var Ue=this.__data__;if(Ue instanceof Fp){var Ce=Ue.__data__;if(!$d||Ce.length<199)return Ce.push([he,Fe]),this.size=++Ue.size,this;Ue=this.__data__=new jp(Ce)}return Ue.set(he,Fe),this.size=Ue.size,this};function Dl(xe){var he=this.__data__=new Fp(xe);this.size=he.size}Dl.prototype.clear=vf,Dl.prototype.delete=Ia,Dl.prototype.get=Mi,Dl.prototype.has=jl,Dl.prototype.set=JS;var tp=Dl,YS=function(he,Fe){for(var Ue=-1,Ce=he==null?0:he.length;++Ue<Ce;)if(Fe(he[Ue],Ue,he))return!0;return!1},Zy=function(he,Fe,Ue,Ce,Pt,ar){var tr=1&Ue,fr=he.length,br=Fe.length;if(fr!=br&&!(tr&&br>fr))return!1;var Nr=ar.get(he),Fr=ar.get(Fe);if(Nr&&Fr)return Nr==Fe&&Fr==he;var jr=-1,Vr=!0,Kr=2&Ue?new th:void 0;for(ar.set(he,Fe),ar.set(Fe,he);++jr<fr;){var Tn=he[jr],Mn=Fe[jr];if(Ce)var En=tr?Ce(Mn,Tn,jr,Fe,he,ar):Ce(Tn,Mn,jr,he,Fe,ar);if(En!==void 0){if(En)continue;Vr=!1;break}if(Kr){if(!YS(Fe,function(In,Pn){if(!Up(Kr,Pn)&&(Tn===In||Pt(Tn,In,Ue,Ce,ar)))return Kr.push(Pn)})){Vr=!1;break}}else if(Tn!==Mn&&!Pt(Tn,Mn,Ue,Ce,ar)){Vr=!1;break}}return ar.delete(he),ar.delete(Fe),Vr},yf=Xs.Uint8Array,XS=function(he){var Fe=-1,Ue=Array(he.size);return he.forEach(function(Ce,Pt){Ue[++Fe]=[Pt,Ce]}),Ue},eb=vi?vi.prototype:void 0,rp=eb?eb.valueOf:void 0,np=function(he,Fe,Ue,Ce,Pt,ar,tr){switch(Ue){case"[object DataView]":if(he.byteLength!=Fe.byteLength||he.byteOffset!=Fe.byteOffset)return!1;he=he.buffer,Fe=Fe.buffer;case"[object ArrayBuffer]":return!(he.byteLength!=Fe.byteLength||!ar(new yf(he),new yf(Fe)));case"[object Boolean]":case"[object Date]":case"[object Number]":return xc(+he,+Fe);case"[object Error]":return he.name==Fe.name&&he.message==Fe.message;case"[object RegExp]":case"[object String]":return he==Fe+"";case"[object Map]":var fr=XS;case"[object Set]":var br=1&Ce;if(fr||(fr=On),he.size!=Fe.size&&!br)return!1;var Nr=tr.get(he);if(Nr)return Nr==Fe;Ce|=2,tr.set(he,Fe);var Fr=Zy(fr(he),fr(Fe),Ce,Pt,ar,tr);return tr.delete(he),Fr;case"[object Symbol]":if(rp)return rp.call(he)==rp.call(Fe)}return!1},op=function(he,Fe,Ue){var Ce=Fe(he);return qi(he)?Ce:bu(Ce,Ue(he))},Qh=function(he,Fe){for(var Ue=-1,Ce=he==null?0:he.length,Pt=0,ar=[];++Ue<Ce;){var tr=he[Ue];Fe(tr,Ue,he)&&(ar[Pt++]=tr)}return ar},ap=function(){return[]},sp=Object.prototype.propertyIsEnumerable,Jh=Object.getOwnPropertySymbols,ZS=Jh?function(xe){return xe==null?[]:(xe=Object(xe),Qh(Jh(xe),function(he){return sp.call(xe,he)}))}:ap,ip=ZS,bf=function(he){return op(he,Kd,ip)},eM=Object.prototype.hasOwnProperty,tb=function(he,Fe,Ue,Ce,Pt,ar){var tr=1&Ue,fr=bf(he),br=fr.length;if(br!=bf(Fe).length&&!tr)return!1;for(var Nr=br;Nr--;){var Fr=fr[Nr];if(!(tr?Fr in Fe:eM.call(Fe,Fr)))return!1}var jr=ar.get(he),Vr=ar.get(Fe);if(jr&&Vr)return jr==Fe&&Vr==he;var Kr=!0;ar.set(he,Fe),ar.set(Fe,he);for(var Tn=tr;++Nr<br;){var Mn=he[Fr=fr[Nr]],En=Fe[Fr];if(Ce)var In=tr?Ce(En,Mn,Fr,Fe,he,ar):Ce(Mn,En,Fr,he,Fe,ar);if(!(In===void 0?Mn===En||Pt(Mn,En,Ue,Ce,ar):In)){Kr=!1;break}Tn||(Tn=Fr=="constructor")}if(Kr&&!Tn){var Pn=he.constructor,Hn=Fe.constructor;Pn==Hn||!("constructor"in he)||!("constructor"in Fe)||typeof Pn=="function"&&Pn instanceof Pn&&typeof Hn=="function"&&Hn instanceof Hn||(Kr=!1)}return ar.delete(he),ar.delete(Fe),Kr},Yh=Al(Xs,"DataView"),Tf=Al(Xs,"Promise"),Xh=Al(Xs,"WeakMap"),Zh="[object Map]",Tu="[object Promise]",cp="[object Set]",Ul="[object WeakMap]",ql="[object DataView]",tM=Wc(Yh),rb=Wc($d),rM=Wc(Tf),nM=Wc(lu),el=Wc(Xh),Hi=Uc;(Yh&&Hi(new Yh(new ArrayBuffer(1)))!=ql||$d&&Hi(new $d)!=Zh||Tf&&Hi(Tf.resolve())!=Tu||lu&&Hi(new lu)!=cp||Xh&&Hi(new Xh)!=Ul)&&(Hi=function(xe){var he=Uc(xe),Fe=he=="[object Object]"?xe.constructor:void 0,Ue=Fe?Wc(Fe):"";if(Ue)switch(Ue){case tM:return ql;case rb:return Zh;case rM:return Tu;case nM:return cp;case el:return Ul}return he});var As=Hi,mi="[object Arguments]",Sf="[object Array]",Su="[object Object]",nb=Object.prototype.hasOwnProperty,Vl=function(he,Fe,Ue,Ce,Pt,ar){var tr=qi(he),fr=qi(Fe),br=tr?Sf:As(he),Nr=fr?Sf:As(Fe),Fr=(br=br==mi?Su:br)==Su,jr=(Nr=Nr==mi?Su:Nr)==Su,Vr=br==Nr;if(Vr&&uf(he)){if(!uf(Fe))return!1;tr=!0,Fr=!1}if(Vr&&!Fr)return ar||(ar=new tp),tr||Fh(he)?Zy(he,Fe,Ue,Ce,Pt,ar):np(he,Fe,br,Ue,Ce,Pt,ar);if(!(1&Ue)){var Kr=Fr&&nb.call(he,"__wrapped__"),Tn=jr&&nb.call(Fe,"__wrapped__");if(Kr||Tn){var Mn=Kr?he.value():he,En=Tn?Fe.value():Fe;return ar||(ar=new tp),Pt(Mn,En,Ue,Ce,ar)}}return!!Vr&&(ar||(ar=new tp),tb(he,Fe,Ue,Ce,Pt,ar))},ob=function xe(he,Fe,Ue,Ce,Pt){return he===Fe||(he==null||Fe==null||!Di(he)&&!Di(Fe)?he!=he&&Fe!=Fe:Vl(he,Fe,Ue,Ce,xe,Pt))},oM=function(he,Fe,Ue,Ce){var Pt=Ue.length,ar=Pt,tr=!Ce;if(he==null)return!ar;for(he=Object(he);Pt--;){var fr=Ue[Pt];if(tr&&fr[2]?fr[1]!==he[fr[0]]:!(fr[0]in he))return!1}for(;++Pt<ar;){var br=(fr=Ue[Pt])[0],Nr=he[br],Fr=fr[1];if(tr&&fr[2]){if(Nr===void 0&&!(br in he))return!1}else{var jr=new tp;if(Ce)var Vr=Ce(Nr,Fr,br,he,Fe,jr);if(!(Vr===void 0?ob(Fr,Nr,3,Ce,jr):Vr))return!1}}return!0},ab=function(he){return he==he&&!$i(he)},Mf=function(he){for(var Fe=Kd(he),Ue=Fe.length;Ue--;){var Ce=Fe[Ue],Pt=he[Ce];Fe[Ue]=[Ce,Pt,ab(Pt)]}return Fe},lp=function(he,Fe){return function(Ue){return Ue!=null&&Ue[he]===Fe&&(Fe!==void 0||he in Object(Ue))}},zi=function(he){var Fe=Mf(he);return Fe.length==1&&Fe[0][2]?lp(Fe[0][0],Fe[0][1]):function(Ue){return Ue===he||oM(Ue,he,Fe)}},up=function(he,Fe){return gh(he)&&ab(Fe)?lp(Rl(he),Fe):function(Ue){var Ce=Zs(Ue,he);return Ce===void 0&&Ce===Fe?Zd(Ue,he):ob(Fe,Ce,3)}},tl=function(he){return function(Fe){return Fe==null?void 0:Fe[he]}},ga=function(he){return function(Fe){return yh(Fe,he)}},Nc=function(he){return gh(he)?tl(Rl(he)):ga(he)},Mu=function(he){return typeof he=="function"?he:he==null?cu:typeof he=="object"?qi(he)?up(he[0],he[1]):zi(he):Nc(he)},ev=/\s/,aM=function(he){for(var Fe=he.length;Fe--&&ev.test(he.charAt(Fe)););return Fe},sM=/^\s+/,iM=function(he){return he&&he.slice(0,aM(he)+1).replace(sM,"")},cM=/^[-+]0x[0-9a-f]+$/i,lM=/^0b[01]+$/i,uM=/^0o[0-7]+$/i,dM=parseInt,pM=function(he){if(typeof he=="number")return he;if(rf(he))return NaN;if($i(he)){var Fe=typeof he.valueOf=="function"?he.valueOf():he;he=$i(Fe)?Fe+"":Fe}if(typeof he!="string")return he===0?he:+he;he=iM(he);var Ue=lM.test(he);return Ue||uM.test(he)?dM(he.slice(2),Ue?2:8):cM.test(he)?NaN:+he},tv=1/0,fM=function(he){return he?(he=pM(he))===tv||he===-1/0?17976931348623157e292*(he<0?-1:1):he==he?he:0:he===0?he:0},sb=function(he){var Fe=fM(he),Ue=Fe%1;return Fe==Fe?Ue?Fe-Ue:Fe:0},mM=Math.max,rv=function(he,Fe,Ue){var Ce=he==null?0:he.length;if(!Ce)return-1;var Pt=Ue==null?0:sb(Ue);return Pt<0&&(Pt=mM(Ce+Pt,0)),Gv(he,Mu(Fe),Pt)},gM={"4_12":"syncMsgReceipts","4_14":"syncSessionAck","4_20":"syncSuperTeamSessionAck","4_22":"nimSyncSessionsWithMoreRoaming","4_25":"syncSessionReliableInfo","7_12":"multiSyncMsgReceipt","7_16":"markSessionAck","7_25":"markMultSessionsAck","7_116":"syncMarkSessionAck","21_25":"markSuperTeamSessionAck","21_32":"markMultSuperTeamSessionsAck","21_125":"syncMarkSuperTeamSessionAck","4_23":"nimSyncStickTopSessions","23_12":"nimAddStickTopSession","23_13":"nimDeleteStickTopSession","23_14":"nimUpdateStickTopSession","23_112":"nimMultiSyncAddStickTopSession","23_113":"nimMultiSyncDeleteStickTopSession","23_114":"nimMultiSyncUpdateStickTopSession"},Cu={msgReceiptTag:{to:1,from:2,time:7,idClient:11},stickTopSessionTag:{id:1,ext:2,createTime:3,updateTime:4},sessionAckTag:{scene:1,to:2,timetag:3},sessionReliableSyncTag:{scene:1,sessionId:2,syncStatus:3,syncEndMsgId:4,syncEndMsgidClient:5,syncEndMsgTime:6,syncStartMsgid:7,syncStartMsgidClient:8,syncStartMsgTime:9,nextMsgid:10,nextMsgidClient:11,nextMsgTime:12,roamMsgSync:13,offlineMsgSync:14,netCallOfflineMsgSync:15}},Oc=Cs(Cu),hM={syncMsgReceipts:{sid:4,cid:12,service:"session",response:[{type:"PropertyArray",name:"msgReceipts",reflectMapper:Oc.msgReceiptTag},{type:"Number",name:"timetag"}]},syncSessionAck:{sid:4,cid:14,service:"session",response:[{type:"StrLongMap",name:"p2p"},{type:"LongLongMap",name:"team"},{type:"Number",name:"timetag"}]},syncSuperTeamSessionAck:{sid:4,cid:20,service:"session",response:[{type:"LongLongMap",name:"superTeam"},{type:"Number",name:"timetag"}]},multiSyncMsgReceipt:{sid:7,cid:12,service:"session",response:[{type:"Property",name:"msgReceiptTag",reflectMapper:Oc.msgReceiptTag}]},markSessionAck:{sid:7,cid:16,service:"session",params:[{type:"byte",name:"scene"},{type:"String",name:"to"},{type:"long",name:"timetag"}]},syncMarkSessionAck:{sid:7,cid:116,service:"session",response:[{type:"byte",name:"scene"},{type:"String",name:"to"},{type:"long",name:"timetag"}]},syncMarkSuperTeamSessionAck:{sid:21,cid:125,service:"session",response:[{type:"String",name:"to"},{type:"long",name:"timetag"}]},markMultSessionsAck:{sid:7,cid:25,service:"session",ignoreErrCodes:[700],params:[{type:"PropertyArray",name:"datas",reflectMapper:Cu.sessionAckTag}]},markSuperTeamSessionAck:{sid:21,cid:25,service:"session",params:[{type:"long",name:"to"},{type:"long",name:"timetag"}]},nimAddStickTopSession:{sid:23,cid:12,service:"session",params:[{type:"Property",name:"tag",reflectMapper:Cu.stickTopSessionTag}],response:[{type:"Property",name:"data",reflectMapper:Oc.stickTopSessionTag}]},nimDeleteStickTopSession:{sid:23,cid:13,service:"session",params:[{type:"Property",name:"tag",reflectMapper:Cu.stickTopSessionTag}],response:[{type:"Number",name:"timetag"}]},nimUpdateStickTopSession:{sid:23,cid:14,service:"session",params:[{type:"Property",name:"tag",reflectMapper:Cu.stickTopSessionTag}],response:[{type:"Property",name:"data",reflectMapper:Oc.stickTopSessionTag}]},nimMultiSyncAddStickTopSession:{sid:23,cid:112,service:"session",response:[{type:"Property",name:"data",reflectMapper:Oc.stickTopSessionTag}]},nimMultiSyncDeleteStickTopSession:{sid:23,cid:113,service:"session",response:[{type:"Number",name:"timetag"},{type:"Property",name:"data",reflectMapper:Oc.stickTopSessionTag}]},nimMultiSyncUpdateStickTopSession:{sid:23,cid:114,service:"session",response:[{type:"Property",name:"data",reflectMapper:Oc.stickTopSessionTag}]},nimSyncStickTopSessions:{sid:4,cid:23,service:"session",response:[{type:"Number",name:"timetag"},{type:"Boolean",name:"isThereAnyChange"},{type:"PropertyArray",name:"datas",reflectMapper:Oc.stickTopSessionTag}]},markMultSuperTeamSessionsAck:{sid:21,cid:32,service:"session",ignoreErrCodes:[700],params:[{type:"PropertyArray",name:"datas",reflectMapper:Cu.sessionAckTag}]},nimSyncSessionsWithMoreRoaming:{sid:21,cid:22,service:"session",response:[{type:"PropertyArray",name:"datas",reflectMapper:{0:"scene",1:"to",2:"from",7:"time",12:"idServer"}}]},syncSessionReliableInfo:{sid:4,cid:25,service:"session",response:[{type:"Property",name:"context",reflectMapper:{1:"timetag",2:"type"}},{type:"PropertyArray",name:"datas",reflectMapper:Oc.sessionReliableSyncTag}]}},vM={id:{type:"string"},ext:{type:"string"},createTime:{type:"number"},updateTime:{type:"number"}};function Cf(xe,he,Fe){Fe===void 0&&(Fe=!0);var Ue=Si(vM,xe);return Ue.isStickOnTop=Fe,Ue.id=he.id,Hr(Hr({},he),{stickTopInfo:he.stickTopInfo?Hr({},he.stickTopInfo,Ue):Ue})}var yM={scene:{type:"enum",values:is},time:{type:"number"}},dp=function(){function xe(Fe){this.core=Fe}var he=xe.prototype;return he.getSession=function(Ue){return this.core.session.getSessionWithUncomplete({id:Ue})||this.core.session.createSession(Ue)},he.addStickTopSession=function(Ue){return Un(this,void 0,void 0,wr.mark(function Ce(){var Pt,ar,tr,fr,br,Nr;return wr.wrap(function(jr){for(;;)switch(jr.prev=jr.next){case 0:return Qn({id:{type:"string",allowEmpty:!1},ext:{type:"string",required:!1}},Ue),Pt=Yo(Ue.id),ar=Pt.scene,tr=Pt.accid,jr.next=4,this.core.sendCmd("nimAddStickTopSession",{tag:{id:(ar==="superTeam"?"super_team":ar)+"|"+tr,ext:Ue.ext}});case 4:return fr=jr.sent,br=this.getSession(Ue.id),Nr=Cf(fr.content.data,br),jr.abrupt("return",Nr);case 8:case"end":return jr.stop()}},Ce,this)}))},he.deleteStickTopSession=function(Ue){return Un(this,void 0,void 0,wr.mark(function Ce(){var Pt,ar,tr,fr,br,Nr;return wr.wrap(function(jr){for(;;)switch(jr.prev=jr.next){case 0:return Qn({id:{type:"string",allowEmpty:!1}},Ue),Pt=Yo(Ue.id),ar=Pt.scene,tr=Pt.accid,jr.next=4,this.core.sendCmd("nimDeleteStickTopSession",{tag:{id:(ar==="superTeam"?"super_team":ar)+"|"+tr}});case 4:return fr=jr.sent,br=this.getSession(Ue.id),Nr=Cf({updateTime:fr.content.timetag},br,!1),jr.abrupt("return",Nr);case 8:case"end":return jr.stop()}},Ce,this)}))},he.updateStickTopSession=function(Ue){return Un(this,void 0,void 0,wr.mark(function Ce(){var Pt,ar,tr,fr,br,Nr;return wr.wrap(function(jr){for(;;)switch(jr.prev=jr.next){case 0:return Qn({id:{type:"string",allowEmpty:!1},ext:{type:"string",required:!1}},Ue),Pt=Yo(Ue.id),ar=Pt.scene,tr=Pt.accid,jr.next=4,this.core.sendCmd("nimUpdateStickTopSession",{tag:{id:(ar==="superTeam"?"super_team":ar)+"|"+tr,ext:Ue.ext}});case 4:return fr=jr.sent,br=this.getSession(Ue.id),Nr=Cf(fr.content.data,br),jr.abrupt("return",Nr);case 8:case"end":return jr.stop()}},Ce,this)}))},he.stickTopSessionHandler=function(Ue,Ce){Ce===void 0&&(Ce=!0);var Pt=Yo(Ue.id,"|"),ar=Pt.scene+"-"+Pt.accid;return Cf(Ue,this.getSession(ar),Ce)},xe}(),ku=function(){function xe(Fe){this.core=Fe,this.logger=Fe.logger}var he=xe.prototype;return he.canSessionResetUnreadCount=function(Ue){var Ce=Ue.id;if(Ue.lastMsg===void 0)throw new Error("Session::canSessionResetUnreadCount: session "+Ce+" is not completly, lastMsg undefined");return Ue.lastMsg!==null||Ue.unread>0?!(Ue.ack&&Ue.lastMsg&&Ue.ack>=Ue.lastMsg.time)||(this.logger.log("Session::canSessionResetUnreadCount: session "+Ce+" reset failed, ack time is greater than last message time"),!1):(this.logger.log("Session::canSessionResetUnreadCount: session "+Ce+" doesn't need to be updated, lastMsg null and unread 0"),!1)},he.filterSessionForResetUnreadCount=function(Ue){var Ce=this,Pt={cmd:"markMultSuperTeamSessionsAck",params:[]},ar={cmd:"markMultSessionsAck",params:[]};return Kn(Ue).call(Ue,function(tr){var fr;try{if(!Ce.canSessionResetUnreadCount(tr))return;var br=Yo(tr.id),Nr=br.accid,Fr=br.scene,jr={to:Nr,sessionId:tr.id,timetag:((fr=tr==null?void 0:tr.lastMsg)===null||fr===void 0?void 0:fr.time)||tr.updateTime||0},Vr=function(Tn){return Wd({scene:{type:"enum",values:is}},Tn)}({scene:Fr});Fr==="superTeam"?Pt.params.push(jr):ar.params.push(Hr(Hr({},jr),Vr))}catch(Kr){Ce.logger.warn(Kr)}}),{superTeam:Pt,p2pOrTeam:ar}},xe}(),nv=function(he,Fe,Ue){var Ce=-1,Pt=he.length;Fe<0&&(Fe=-Fe>Pt?0:Pt+Fe),(Ue=Ue>Pt?Pt:Ue)<0&&(Ue+=Pt),Pt=Fe>Ue?0:Ue-Fe>>>0,Fe>>>=0;for(var ar=Array(Pt);++Ce<Pt;)ar[Ce]=he[Ce+Fe];return ar},bM=function(he,Fe,Ue){if(!$i(Ue))return!1;var Ce=typeof Fe;return!!(Ce=="number"?Hp(Ue)&&df(Fe,Ue.length):Ce=="string"&&Fe in Ue)&&xc(Ue[Fe],he)},TM=Math.ceil,SM=Math.max,ib=function(he,Fe,Ue){Fe=(Ue?bM(he,Fe,Ue):Fe===void 0)?1:SM(sb(Fe),0);var Ce=he==null?0:he.length;if(!Ce||Fe<1)return[];for(var Pt=0,ar=0,tr=Array(TM(Ce/Fe));Pt<Ce;)tr[ar++]=nv(he,Pt,Pt+=Fe);return tr};function ps(xe,he){var Fe,Ue=Ba!==void 0&&Ud(xe)||xe["@@iterator"];if(Ue)return Go(Fe=(Ue=Ue.call(xe)).next).call(Fe,Ue);if(ji(xe)||(Ue=function(ar,tr){var fr;if(ar){if(typeof ar=="string")return Ea(ar,tr);var br=Fo(fr=Object.prototype.toString.call(ar)).call(fr,8,-1);if(br==="Object"&&ar.constructor&&(br=ar.constructor.name),br==="Map"||br==="Set")return tf(ar);if(br==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(br))return Ea(ar,tr)}}(xe))||he&&xe&&typeof xe.length=="number"){Ue&&(xe=Ue);var Ce=0;return function(){return Ce>=xe.length?{done:!0}:{done:!1,value:xe[Ce++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ea(xe,he){(he==null||he>xe.length)&&(he=xe.length);for(var Fe=0,Ue=new Array(he);Fe<he;Fe++)Ue[Fe]=xe[Fe];return Ue}var MM=function(xe){function he(Ue,Ce){var Pt;return(Pt=xe.call(this,"session",Ue)||this).list=new Cc,Pt.unreadCountFilterFn=function(ar){return!0},Pt.lastMessageFilterFn=function(ar){return!0},Pt.initEventListeners(),ls({cmdMap:gM,cmdConfig:hM}),typeof(Ce==null?void 0:Ce.unreadCountFilterFn)=="function"&&(Pt.unreadCountFilterFn=Ce.unreadCountFilterFn),typeof(Ce==null?void 0:Ce.lastMessageFilterFn)=="function"&&(Pt.lastMessageFilterFn=Ce.lastMessageFilterFn),Pt.stickTopService=new dp(Ue),Pt.unreadModule=new ku(Ue),Pt}Ko(he,xe);var Fe=he.prototype;return Fe.initEventListeners=function(){var Ce,Pt,ar,tr=this;this.core.eventBus.on("session/syncMsgs",Go(Ce=this.onSyncMsgs).call(Ce,this)),this.core.eventBus.on("session/updateForNewMsg",Go(Pt=this.updateSessionWithMsg).call(Pt,this)),this.core.eventBus.on("session/updateForClearMsg",function(fr,br){br===void 0&&(br=!0),fr&&fr.length>0&&Kn(fr).call(fr,function(Nr){tr.updateSession({id:Nr.sessionId,lastMsg:null,unread:0,unreadMsgs:[]},br)})}),this.core.eventBus.on("session/updateForDeletedMsg",Go(ar=this.updateSessionForDeletedMsg).call(ar,this))},Fe.createSession=function(Ce,Pt){try{var ar=Yo(Ce);return{id:Ce,scene:ar.scene,to:ar.accid,lastMsg:Pt,updateTime:Pt?Pt.time:0,unread:0,unreadMsgs:[],ack:0}}catch(tr){throw this.logger.error("Failed to create session with "+Ce,tr),new Error("Failed to create session with "+Ce)}},Fe.getSession=function(Ce){Qn({id:{type:"string",allowEmpty:!1}},Ce);var Pt=this.list.get(Ce.id);if(this.isSessionComplete(Pt))return Pt},Fe.getSessionWithUncomplete=function(Ce){return this.list.get(Ce.id)},Fe.getAllSessions=function(){for(var Ce,Pt=[],ar=ps(this.list);!(Ce=ar()).done;){var tr=Ce.value;tr[0];var fr=tr[1];this.isSessionComplete(fr)&&Pt.push(fr)}return Pt},Fe.getSessions=function(Ce){Qn({limit:{type:"number",required:!1},lastSessionId:{type:"string",allowEmpty:!1,required:!1},desc:{type:"boolean",required:!1}},Ce);var Pt=[],ar=Ce.limit,tr=ar===void 0?100:ar,fr=Ce.desc,br=fr===void 0||fr,Nr=Ce.lastSessionId,Fr=0;if(br){for(var jr,Vr,Kr=ps(this.list);!(Vr=Kr()).done;){var Tn=Vr.value,Mn=Tn[0],En=Tn[1];if(Nr===Mn)break;this.isSessionComplete(En)&&Pt.push(En)}return Kl(jr=Fo(Pt).call(Pt,-tr)).call(jr)}for(var In,Pn=ps(this.list);!(In=Pn()).done;){var Hn=In.value,ho=Hn[0],uo=Hn[1];if(Nr)ho===Nr&&(Nr=void 0);else if(this.isSessionComplete(uo)){if(++Fr>tr)break;Pt.push(uo)}}return Pt},Fe.resetSessionUnreadCount=function(Ce){var Pt,ar;return Un(this,void 0,void 0,wr.mark(function tr(){var fr,br,Nr,Fr,jr,Vr,Kr,Tn,Mn=this;return wr.wrap(function(In){for(;;)switch(In.prev=In.next){case 0:if(!((Pt=this.core.sync)===null||Pt===void 0)&&Pt.getSyncDoneFlag()||this.logger.warn("Please call resetSessionUnreadCount after syncdone event"),Qn({id:{type:"string",allowEmpty:!1}},Ce),Qn({id:{type:"string",allowEmpty:!1}},Ce),fr=Ce.id,br=this.list.get(fr)){In.next=8;break}throw this.logger.warn("resetSessionUnreadCount: can not find session "+fr),new Error("Session::canSessionResetUnreadCount: can not find session "+fr);case 8:Nr=!1;try{Nr=this.unreadModule.canSessionResetUnreadCount(br)}catch(Pn){this.logger.warn(Pn)}if(Nr!==!1){In.next=12;break}return In.abrupt("return");case 12:return Fr=Yo(fr),jr=Fr.accid,Vr=Fr.scene,Kr={to:jr,timetag:((ar=br==null?void 0:br.lastMsg)===null||ar===void 0?void 0:ar.time)||br.updateTime||0},Tn="markSuperTeamSessionAck",Vr!=="superTeam"&&(Kr.scene=Vr==="p2p"?0:1,Tn="markSessionAck"),In.abrupt("return",this.core.sendCmd(Tn,Kr).then(function(){var Pn=Mn.storeUnreadByAck(fr,Kr.timetag);Pn&&Mn.core.emit("updateSession",Pn)}));case 17:case"end":return In.stop()}},tr,this)}))},Fe.resetMultiSessionUnreadCount=function(Ce){var Pt;return Un(this,void 0,void 0,wr.mark(function ar(){var tr,fr,br,Nr,Fr,jr,Vr,Kr,Tn,Mn,En,In,Pn,Hn,ho=this;return wr.wrap(function(Do){for(;;)switch(Do.prev=Do.next){case 0:!((Pt=this.core.sync)===null||Pt===void 0)&&Pt.getSyncDoneFlag()||this.logger.warn("Please call resetMultiSessionUnreadCount after syncdone event"),Qn({ids:{type:"array",itemType:"string",min:1}},Ce),br=Is(tr=Ro(fr=Ce.ids).call(fr,function(no){return ho.list.get(no)})).call(tr,function(no,zr){return!!no||(ho.logger.warn("Session::canSessionResetUnreadCount: can not find session "+Ce.ids[zr]),!1)}),Nr=this.unreadModule.filterSessionForResetUnreadCount(br),Fr=Nr.superTeam,jr=Nr.p2pOrTeam,Vr=ib(Fr.params,10),Kr=ib(jr.params,10),Tn=ps(Vr);case 7:if((Mn=Tn()).done){Do.next=14;break}return En=Mn.value,Do.next=11,this.core.sendCmd(Fr.cmd,{datas:En});case 11:Kn(En).call(En,function(no){var zr=ho.storeUnreadByAck(no.sessionId,no.timetag);zr&&ho.core.emit("updateSession",zr)});case 12:Do.next=7;break;case 14:In=ps(Kr);case 15:if((Pn=In()).done){Do.next=22;break}return Hn=Pn.value,Do.next=19,this.core.sendCmd(jr.cmd,{datas:Hn});case 19:Kn(Hn).call(Hn,function(no){var zr=ho.storeUnreadByAck(no.sessionId,no.timetag);zr&&ho.core.emit("updateSession",zr)});case 20:Do.next=15;break;case 22:case"end":return Do.stop()}},ar,this)}))},Fe.resetAllSessionsUnreadCount=function(){var Ce,Pt;!((Pt=this.core.sync)===null||Pt===void 0)&&Pt.getSyncDoneFlag()||this.logger.warn("Please call resetAllSessionsUnreadCount after syncdone event");var ar=[];return Kn(Ce=this.list).call(Ce,function(tr){ar.push(tr.id)}),this.resetMultiSessionUnreadCount({ids:ar})},Fe.deleteSession=function(Ce){return Un(this,void 0,void 0,wr.mark(function Pt(){return wr.wrap(function(tr){for(;;)switch(tr.prev=tr.next){case 0:if(Qn({id:{type:"string",allowEmpty:!1},isSyncToServer:{type:"boolean",required:!1}},Ce),this.list.delete(Ce.id),!this.core.msgLog||!Ce.isSyncToServer){tr.next=5;break}return tr.next=5,this.core.msgLog.deleteRoamingMsgs({ids:[Ce.id]});case 5:case"end":return tr.stop()}},Pt,this)}))},Fe.deleteAllSessionsFromLocal=function(){this.list.clear()},Fe.addStickTopSession=function(Ce){return Un(this,void 0,void 0,wr.mark(function Pt(){var ar;return wr.wrap(function(fr){for(;;)switch(fr.prev=fr.next){case 0:return fr.next=2,this.stickTopService.addStickTopSession(Ce);case 2:return ar=fr.sent,this.list.set(ar.id,ar),fr.abrupt("return",ar);case 5:case"end":return fr.stop()}},Pt,this)}))},Fe.deleteStickTopSession=function(Ce){return Un(this,void 0,void 0,wr.mark(function Pt(){var ar;return wr.wrap(function(fr){for(;;)switch(fr.prev=fr.next){case 0:return fr.next=2,this.stickTopService.deleteStickTopSession(Ce);case 2:return ar=fr.sent,this.list.set(ar.id,ar),fr.abrupt("return",ar);case 5:case"end":return fr.stop()}},Pt,this)}))},Fe.updateStickTopSession=function(Ce){return Un(this,void 0,void 0,wr.mark(function Pt(){var ar;return wr.wrap(function(fr){for(;;)switch(fr.prev=fr.next){case 0:return fr.next=2,this.stickTopService.updateStickTopSession(Ce);case 2:return ar=fr.sent,this.list.set(ar.id,ar),fr.abrupt("return",ar);case 5:case"end":return fr.stop()}},Pt,this)}))},Fe.nimMultiSyncAddStickTopSessionHandler=function(Ce){var Pt=this.stickTopService.stickTopSessionHandler(Ce.content.data);this.list.set(Pt.id,Pt),this.core.emit("updateSession",Pt)},Fe.nimMultiSyncDeleteStickTopSessionHandler=function(Ce){var Pt=this.stickTopService.stickTopSessionHandler({id:Ce.content.data.id,updateTime:Ce.content.timetag},!1);this.list.set(Pt.id,Pt),this.core.emit("updateSession",Pt)},Fe.nimMultiSyncUpdateStickTopSessionHandler=function(Ce){var Pt=this.stickTopService.stickTopSessionHandler(Ce.content.data);this.list.set(Pt.id,Pt),this.core.emit("updateSession",Pt)},Fe.nimSyncStickTopSessionsHandler=function(Ce){var Pt=this,ar=Ce.content.datas;Kn(ar).call(ar,function(tr){var fr=Pt.stickTopService.stickTopSessionHandler(tr);Pt.list.set(fr.id,fr)})},Fe.updateSessionWithMsg=function(Ce){var Pt=!0,ar=!0;try{Pt=!!this.unreadCountFilterFn(Ce)}catch(Nr){this.logger.error("session:updateSessionWithMsg, unreadCountFilterFn error",Nr)}try{ar=!!this.lastMessageFilterFn(Ce)}catch(Nr){this.logger.error("session:updateSessionWithMsg, lastMessageFilterFn error",Nr)}var tr=this.list.get(Ce.sessionId)||this.createSession(Ce.sessionId),fr=!1;if(this.logger.log("session:updateSessionWithMsg, pending ",Ce.sessionId,Ce.idClient,Ce.idServer,ar,Pt),ar&&(!tr.lastMsg||tr.lastMsg.time<Ce.time||Ce.status===Fa[Fa.sending]||tr.lastMsg.status===Fa[Fa.sending])&&(tr.lastMsg=Ce,tr.updateTime=Ce.time,fr=!0),Pt&&Ce.status===Fa[Fa.unread]&&Ce.time>(tr.ack||0)){tr.unread++;var br=tr.unreadMsgs||[];br.unshift(Ce),Qc(br).call(br,function(Nr,Fr){return Fr.time-Nr.time}),fr=!0}fr&&(this.logger.log("session:updateSessionWithMsg updating ",tr.id,tr.unread,tr.lastMsg&&tr.lastMsg.idClient),this.list.set(tr.id,tr),this.core.emit("updateSession",tr))},Fe.storeUnreadByAck=function(Ce,Pt){var ar=this.list.get(Ce)||this.createSession(Ce);if(!(ar.ack&&Pt<ar.ack)){var tr=ar.unreadMsgs||[],fr=[],br=0;return ar.unreadMsgs=[],tr.length>0&&(Kn(tr).call(tr,function(Nr){Nr.time>Pt&&(br++,fr.push(Nr))}),ar.unreadMsgs=Qc(fr).call(fr,function(Nr,Fr){return Fr.time-Nr.time})),ar.ack=Pt,ar.unread=br,ar.lastMsg&&ar.lastMsg.status==="unread"&&Pt>=ar.lastMsg.time&&(ar.lastMsg.status="read"),this.list.set(Ce,ar),ar}this.logger.warn("storeUnreadByAck: not need update ack",Ce,Pt,ar.ack)},Fe.updateSession=function(Ce,Pt){Pt===void 0&&(Pt=!0);var ar=Ce.id,tr=this.list.get(ar)||this.createSession(Ce.id),fr=Hr(tr,Ce);return this.list.set(ar,fr),this.logger.log("updateSession: update",Pt,ep(Ce,["id","ack","unread"]),fr.lastMsg&&fr.lastMsg.idClient),Pt&&this.core.emit("updateSession",fr),fr},Fe.isSessionComplete=function(Ce){return!!Ce&&!!(Ce.id&&Ce.scene&&Ce.to)&&Ce.lastMsg!==void 0},Fe.syncSessionAckHandler=function(Ce){var Pt,ar,tr=this,fr=Ce.content.p2p||{},br=Ce.content.team.m_map||{};this.logger.log("syncSessionAck::",fr,br),Kn(Pt=aa(fr)).call(Pt,function(Nr){tr.updateSession({id:"p2p-"+Nr,ack:fr[Nr]},!1)}),Kn(ar=aa(br)).call(ar,function(Nr){tr.updateSession({id:"team-"+Nr,ack:br[Nr]},!1)})},Fe.syncSuperTeamSessionAckHandler=function(Ce){var Pt,ar=this,tr=Ce.content.superTeam.m_map;this.logger.log("syncSuperTeamSessionAck::",tr),Kn(Pt=aa(tr)).call(Pt,function(fr){ar.updateSession({id:"superTeam-"+fr,ack:tr[fr]},!1)})},Fe.syncMarkSessionAckHandler=function(Ce){var Pt=Ce.content,ar=(Pt.scene===0?"p2p":Pt.scene===1?"team":"superTeam")+"-"+Pt.to,tr=this.list.get(ar);if(tr&&tr.ack&&Pt.timetag<tr.ack)this.logger.warn("syncMarkSessionAckHandler: "+ar+" do not need update ack",tr.ack,Pt.timetag);else{var fr=this.storeUnreadByAck(ar,Pt.timetag);fr&&this.core.emit("updateSession",fr)}},Fe.syncMarkSuperTeamSessionAckHandler=function(Ce){Ce.content.scene=5,this.syncMarkSessionAckHandler(Ce)},Fe.onSyncDone=function(){var Ce,Pt,ar,tr=this,fr=[];Kn(Ce=this.list).call(Ce,function(br,Nr){fr.push(tr.storeUnreadByAck(Nr,br.ack||0))}),this.list.clear(),Kn(Pt=Qc(fr).call(fr,function(br,Nr){return br.updateTime-Nr.updateTime})).call(Pt,function(br){tr.list.set(br.id,br)}),(fr=Qc(ar=Is(fr).call(fr,function(br){return tr.isSessionComplete(br)})).call(ar,function(br,Nr){return Nr.updateTime-br.updateTime})).length>0&&this.core.emit("sessions",fr)},Fe.onSyncMsgs=function(Ce){var Pt,ar=this,tr=this.list.get(Ce.sessionId),fr=[];try{var br;fr=Is(br=Ce.msgs).call(br,function(Kr){return ar.unreadCountFilterFn(JSON.parse(la(Kr)))})}catch(Kr){this.logger.error("session:onSyncMsgs, unreadCountFilterFn error ",Kr)}var Nr,Fr=[];try{var jr;Fr=Is(jr=Ce.msgs).call(jr,function(Kr){return ar.lastMessageFilterFn(JSON.parse(la(Kr)))})}catch(Kr){this.logger.error("session:onSyncMsgs, lastMessageFilterFn error ",Kr)}Fr&&Fr.length>0&&(Nr=Fr[Fr.length-1],Nr=Fr[0].time>Nr.time?Fr[0]:Nr);var Vr=Nr?Nr.time:0;tr||(tr=Nr?this.createSession(Ce.sessionId,Nr):this.createSession(Ce.sessionId)),tr.unreadMsgs=tr.unreadMsgs?Is(Pt=Hs(fr).call(fr,tr.unreadMsgs)).call(Pt,function(Kr){return Kr.status===Fa[Fa.unread]}):Is(fr).call(fr,function(Kr){return Kr.status===Fa[Fa.unread]}),tr.updateTime&&tr.updateTime>=Vr||(tr.updateTime=Vr),tr.lastMsg&&tr.lastMsg.time>=Vr||(tr.lastMsg=Nr),this.list.set(tr.id,tr)},Fe.updateSessionForDeletedMsg=function(Ce){var Pt,ar=this,tr={};Kn(Ce).call(Ce,function(fr){var br=fr.to===ar.core.account?fr.from:fr.to,Nr=fr.scene+"-"+br,Fr=ar.list.get(Nr);if(Fr){if((Fr.ack||0)<fr.time&&fr.from!==ar.core.account&&Fr.unread>0&&(Fr.unread=Fr.unread-1,Fr.unreadMsgs&&Fr.unreadMsgs.length>0)){var jr,Vr=rv(Fr.unreadMsgs,{idClient:fr.idClient});Vr>=0&&fh(jr=Fr.unreadMsgs).call(jr,Vr,1)}Fr.lastMsg&&Fr.lastMsg.idClient===fr.idClient&&(Fr.lastMsg=null),tr[Fr.id]=!0}}),Kn(Pt=aa(tr)).call(Pt,function(fr){var br=ar.list.get(fr);br&&ar.core.emit("updateSession",br)})},Fe.multiSyncMsgReceiptHandler=function(Ce){var Pt,ar=(Pt=Ce.content)===null||Pt===void 0?void 0:Pt.msgReceiptTag;if(ar){this.updateSessionMsgReceiptTime([ar],!0),ar.msgReceiptTime=ar.time,ar.sessionId="p2p-"+ar.from,ar.time,ar.from;var tr=Ys(ar,["time","from"]);this.core.emit("msgReceipts",[tr])}},Fe.syncMsgReceiptsHandler=function(Ce){var Pt,ar=(Pt=Ce.content)===null||Pt===void 0?void 0:Pt.msgReceipts;ar&&this.updateSessionMsgReceiptTime(ar,!1)},Fe.updateSessionMsgReceiptTime=function(Ce,Pt){var ar=this;Pt===void 0&&(Pt=!0),Ce&&Ce.length>0&&Kn(Ce).call(Ce,function(tr){var fr=ar.list.get("p2p-"+tr.from);fr||(fr=ar.createSession("p2p-"+tr.from));var br=Lo(tr.time);fr.msgReceiptTime&&fr.msgReceiptTime>=br||(fr.msgReceiptTime=br,fr.lastMsg&&fr.lastMsg.status==="sent"&&br>=fr.lastMsg.time&&(fr.lastMsg.status="receipt"),ar.logger.log("session: update session "+fr.id+" msgReceiptTime: "+fr.msgReceiptTime),ar.list.set(fr.id,fr),Pt&&ar.core.emit("updateSession",fr))})},Fe.nimSyncSessionsWithMoreRoamingHandler=function(Ce){var Pt=function(tr,fr){return Ro(tr).call(tr,function(br){var Nr=Si(yM,br);return Nr.sessionId=Vi(br,fr),Nr})}(Ce.content.datas,this.core.account);this.logger.log("session:syncSessionsWithMoreRoaming",Pt)},he}(ws),CM=function(){function xe(Fe){this.core=Fe}var he=xe.prototype;return he.notifyAddTeamMembers=function(Ue,Ce){this.core.emit("addTeamMembers",{team:Ue,accounts:Ce,members:jS(Ue,Ce)})},he.notifyUpdateTeamManagers=function(Ue,Ce,Pt,ar){this.core.emit("updateTeamManagers",{team:{teamId:Ue,memberUpdateTime:ar},accounts:Ce,isManager:Pt,members:Ro(Ce).call(Ce,function(tr){return{id:Ue+"-"+tr,account:tr,type:"manager",updateTime:ar}})})},he.notifyRemoveTeamMembers=function(Ue,Ce){this.core.emit("removeTeamMembers",{team:Ue,accounts:Ce})},he.notifyTransferTeam=function(Ue,Ce,Pt){this.core.emit("transferTeam",{team:Ue,from:{id:Ue.teamId+"-"+Ce,type:"normal",account:Ce,updateTime:Ue.memberUpdateTime},to:{id:Ue.teamId+"-"+Pt,type:"owner",account:Pt,updateTime:Ue.memberUpdateTime}})},he.notifyUpdateTeamMembersMute=function(Ue,Ce,Pt){this.core.emit("updateTeamMembersMute",{team:Ue,accounts:Ce,members:Ro(Ce).call(Ce,function(ar){return{id:Ue.teamId+"-"+ar,account:ar,teamId:Ue.teamId,mute:Pt,updateTime:Ue.memberUpdateTime}}),mute:Pt})},xe}(),kM=function(he,Fe){for(var Ue=-1,Ce=he==null?0:he.length;++Ue<Ce&&Fe(he[Ue],Ue,he)!==!1;);return he},kf=function(he,Fe,Ue,Ce){var Pt=!Ue;Ue||(Ue={});for(var ar=-1,tr=Fe.length;++ar<tr;){var fr=Fe[ar],br=Ce?Ce(Ue[fr],he[fr],fr,Ue,he):void 0;br===void 0&&(br=he[fr]),Pt?yu(Ue,fr,br):hf(Ue,fr,br)}return Ue},wM=function(he,Fe){return he&&kf(Fe,Kd(Fe),he)},Rc=function(he){var Fe=[];if(he!=null)for(var Ue in Object(he))Fe.push(Ue);return Fe},ei=Object.prototype.hasOwnProperty,wf=function(he){if(!$i(he))return Rc(he);var Fe=Fl(he),Ue=[];for(var Ce in he)(Ce!="constructor"||!Fe&&ei.call(he,Ce))&&Ue.push(Ce);return Ue},ov=function(he){return Hp(he)?Ay(he,!0):wf(he)},Ns=function(he,Fe){return he&&kf(Fe,ov(Fe),he)},Oa=g(function(xe,he){var Fe=he&&!he.nodeType&&he,Ue=Fe&&xe&&!xe.nodeType&&xe,Ce=Ue&&Ue.exports===Fe?Xs.Buffer:void 0,Pt=Ce?Ce.allocUnsafe:void 0;xe.exports=function(tr,fr){if(fr)return tr.slice();var br=tr.length,Nr=Pt?Pt(br):new tr.constructor(br);return tr.copy(Nr),Nr}}),xM=function(he,Fe){var Ue=-1,Ce=he.length;for(Fe||(Fe=Array(Ce));++Ue<Ce;)Fe[Ue]=he[Ue];return Fe},cb=function(he,Fe){return kf(he,ip(he),Fe)},xf=Object.getOwnPropertySymbols?function(xe){for(var he=[];xe;)bu(he,ip(xe)),xe=Ph(xe);return he}:ap,av=function(he,Fe){return kf(he,xf(he),Fe)},lb=function(he){return op(he,ov,xf)},ub=Object.prototype.hasOwnProperty,pp=function(he){var Fe=he.length,Ue=new he.constructor(Fe);return Fe&&typeof he[0]=="string"&&ub.call(he,"index")&&(Ue.index=he.index,Ue.input=he.input),Ue},_f=function(he){var Fe=new he.constructor(he.byteLength);return new yf(Fe).set(new yf(he)),Fe},sv=function(he,Fe){var Ue=Fe?_f(he.buffer):he.buffer;return new he.constructor(Ue,he.byteOffset,he.byteLength)},db=/\w*$/,zs=function(he){var Fe=new he.constructor(he.source,db.exec(he));return Fe.lastIndex=he.lastIndex,Fe},pb=vi?vi.prototype:void 0,iv=pb?pb.valueOf:void 0,_M=function(he){return iv?Object(iv.call(he)):{}},IM=function(he,Fe){var Ue=Fe?_f(he.buffer):he.buffer;return new he.constructor(Ue,he.byteOffset,he.length)},EM=function(he,Fe,Ue){var Ce=he.constructor;switch(Fe){case"[object ArrayBuffer]":return _f(he);case"[object Boolean]":case"[object Date]":return new Ce(+he);case"[object DataView]":return sv(he,Ue);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return IM(he,Ue);case"[object Map]":case"[object Set]":return new Ce;case"[object Number]":case"[object String]":return new Ce(he);case"[object RegExp]":return zs(he);case"[object Symbol]":return _M(he)}},fb=Object.create,PM=function(){function xe(){}return function(he){if(!$i(he))return{};if(fb)return fb(he);xe.prototype=he;var Fe=new xe;return xe.prototype=void 0,Fe}}(),AM=function(he){return typeof he.constructor!="function"||Fl(he)?{}:PM(Ph(he))},NM=function(he){return Di(he)&&As(he)=="[object Map]"},cv=Es&&Es.isMap,OM=cv?tu(cv):NM,RM=function(he){return Di(he)&&As(he)=="[object Set]"},mb=Es&&Es.isSet,lv=mb?tu(mb):RM,gb="[object Arguments]",uv="[object Function]",Ws="[object Object]",La={};La[gb]=La["[object Array]"]=La["[object ArrayBuffer]"]=La["[object DataView]"]=La["[object Boolean]"]=La["[object Date]"]=La["[object Float32Array]"]=La["[object Float64Array]"]=La["[object Int8Array]"]=La["[object Int16Array]"]=La["[object Int32Array]"]=La["[object Map]"]=La["[object Number]"]=La[Ws]=La["[object RegExp]"]=La["[object Set]"]=La["[object String]"]=La["[object Symbol]"]=La["[object Uint8Array]"]=La["[object Uint8ClampedArray]"]=La["[object Uint16Array]"]=La["[object Uint32Array]"]=!0,La["[object Error]"]=La[uv]=La["[object WeakMap]"]=!1;var BM=function xe(he,Fe,Ue,Ce,Pt,ar){var tr,fr=1&Fe,br=2&Fe,Nr=4&Fe;if(Ue&&(tr=Pt?Ue(he,Ce,Pt,ar):Ue(he)),tr!==void 0)return tr;if(!$i(he))return he;var Fr=qi(he);if(Fr){if(tr=pp(he),!fr)return xM(he,tr)}else{var jr=As(he),Vr=jr==uv||jr=="[object GeneratorFunction]";if(uf(he))return Oa(he,fr);if(jr==Ws||jr==gb||Vr&&!Pt){if(tr=br||Vr?{}:AM(he),!fr)return br?av(he,Ns(tr,he)):cb(he,wM(tr,he))}else{if(!La[jr])return Pt?he:{};tr=EM(he,jr,fr)}}ar||(ar=new tp);var Kr=ar.get(he);if(Kr)return Kr;ar.set(he,tr),lv(he)?he.forEach(function(Mn){tr.add(xe(Mn,Fe,Ue,Mn,he,ar))}):OM(he)&&he.forEach(function(Mn,En){tr.set(En,xe(Mn,Fe,Ue,En,he,ar))});var Tn=Fr?void 0:(Nr?br?lb:bf:br?ov:Kd)(he);return kM(Tn||he,function(Mn,En){Tn&&(Mn=he[En=Mn]),hf(tr,En,xe(Mn,Fe,Ue,En,he,ar))}),tr},rl,Bc,Fc=function(he){return BM(he,5)},FM=function(xe){function he(Ue){var Ce;return(Ce=xe.call(this,"team",Ue)||this).myTeamMembersMap=new Cc,Ce.service=new CM(Ue),Ce.core.eventBus.on("team/onNotification",function(Pt){return Ce.notificationHandler(Pt)}),ls({cmdMap:qy,cmdConfig:Vy}),Ce}Ko(he,xe);var Fe=he.prototype;return Fe.mergeMyTeamMembers=function(Ce){var Pt=this;Kn(Ce).call(Ce,function(ar){var tr=ar.teamId,fr=Pt.myTeamMembersMap.get(tr),br=Hr({},fr,ar);Pt.myTeamMembersMap.set(tr,br)})},Fe.getTeamInfo=function(Ce){return Un(this,void 0,void 0,wr.mark(function Pt(){var ar,tr;return wr.wrap(function(br){for(;;)switch(br.prev=br.next){case 0:return Qn({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1}},Ce),br.next=3,this.core.sendCmd("getTeamInfo",{teamId:Ce.teamId});case 3:return ar=br.sent,tr=ar.content.team,br.abrupt("return",Jc(tr));case 6:case"end":return br.stop()}},Pt,this)}))},Fe.getTeams=function(){return Un(this,void 0,void 0,wr.mark(function Ce(){var Pt,ar;return wr.wrap(function(fr){for(;;)switch(fr.prev=fr.next){case 0:return fr.next=2,this.core.sendCmd("getTeams",{timetag:0});case 2:return Pt=fr.sent,ar=Pt.content.teams,fr.abrupt("return",qh(ar));case 5:case"end":return fr.stop()}},Ce,this)}))},Fe.getTeamsById=function(Ce){return Un(this,void 0,void 0,wr.mark(function Pt(){var ar,tr;return wr.wrap(function(br){for(;;)switch(br.prev=br.next){case 0:return Qn({teamIds:{type:"array",itemType:"string"}},Ce),br.next=3,this.core.sendCmd("getTeamsById",{teamIds:Ce.teamIds});case 3:return ar=br.sent,tr=qh(ar.content.teams),br.abrupt("return",{teams:tr,tids:ar.content.tids});case 6:case"end":return br.stop()}},Pt,this)}))},Fe.createTeam=function(Ce){return Un(this,void 0,void 0,wr.mark(function Pt(){var ar,tr,fr;return wr.wrap(function(Nr){for(;;)switch(Nr.prev=Nr.next){case 0:return Qn({type:{type:"enum",values:["advanced","normal"]},name:{type:"string",allowEmpty:!1},level:{type:"number",required:!1},accounts:{type:"array",itemType:"string",required:!1},ps:{type:"string",allowEmpty:!1,max:5e3,required:!1},joinMode:{type:"enum",values:["noVerify","needVerify","rejectAll"],required:!1},beInviteMode:{type:"enum",values:["noVerify","needVerify"],required:!1},inviteMode:{type:"enum",values:["manager","all"],required:!1},updateTeamMode:{type:"enum",values:["manager","all"],required:!1},updateExtMode:{type:"enum",values:["manager","all"],required:!1},intro:{type:"string",allowEmpty:!1,required:!1},announcement:{type:"string",allowEmpty:!1,required:!1},avatar:{type:"string",allowEmpty:!1,required:!1},ext:{type:"string",allowEmpty:!1,required:!1}},Ce),ar=Vh(Ce),Nr.next=4,this.core.sendCmd("createTeam",{team:ar,accounts:Ce.accounts||[],ps:Ce.ps||""});case 4:return tr=Nr.sent,fr=Jc(tr.content.team),Nr.abrupt("return",fr);case 7:case"end":return Nr.stop()}},Pt,this)}))},Fe.dismissTeam=function(Ce){return Un(this,void 0,void 0,wr.mark(function Pt(){return wr.wrap(function(tr){for(;;)switch(tr.prev=tr.next){case 0:return Qn({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1}},Ce),tr.next=3,this.core.sendCmd("dismissTeam",{teamId:Ce.teamId});case 3:case"end":return tr.stop()}},Pt,this)}))},Fe.leaveTeam=function(Ce){return Un(this,void 0,void 0,wr.mark(function Pt(){return wr.wrap(function(tr){for(;;)switch(tr.prev=tr.next){case 0:return Qn({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1}},Ce),tr.next=3,this.core.sendCmd("leaveTeam",{teamId:Ce.teamId});case 3:case"end":return tr.stop()}},Pt,this)}))},Fe.transferTeam=function(Ce){return Un(this,void 0,void 0,wr.mark(function Pt(){return wr.wrap(function(tr){for(;;)switch(tr.prev=tr.next){case 0:return Qn({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1},account:{type:"string",allowEmpty:!1},leave:{type:"boolean"}},Ce),tr.next=3,this.core.sendCmd("transferTeam",Ce);case 3:case"end":return tr.stop()}},Pt,this)}))},Fe.updateTeamInfo=function(Ce){return Un(this,void 0,void 0,wr.mark(function Pt(){var ar;return wr.wrap(function(fr){for(;;)switch(fr.prev=fr.next){case 0:return Qn({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1},joinMode:{type:"enum",values:["noVerify","needVerify","rejectAll"],required:!1},beInviteMode:{type:"enum",values:["noVerify","needVerify"],required:!1},inviteMode:{type:"enum",values:["manager","all"],required:!1},updateTeamMode:{type:"enum",values:["manager","all"],required:!1},updateExtMode:{type:"enum",values:["manager","all"],required:!1},intro:{type:"string",allowEmpty:!1,required:!1},announcement:{type:"string",allowEmpty:!1,required:!1},avatar:{type:"string",allowEmpty:!1,required:!1},ext:{type:"string",allowEmpty:!1,required:!1}},Ce),ar=Vh(Ce),fr.next=4,this.core.sendCmd("updateTeamInfo",{team:ar});case 4:return fr.abrupt("return",Jc(ar));case 5:case"end":return fr.stop()}},Pt,this)}))},Fe.getTeamMembers=function(Ce){var Pt;return Un(this,void 0,void 0,wr.mark(function ar(){var tr,fr;return wr.wrap(function(Nr){for(;;)switch(Nr.prev=Nr.next){case 0:return Qn({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1},accounts:{type:"array",itemType:"string",required:!1}},Ce),Nr.next=3,this.core.sendCmd("getTeamMembers",{teamId:Ce.teamId,timetag:0});case 3:if(tr=Nr.sent,fr=ff((Pt=tr.content)===null||Pt===void 0?void 0:Pt.teamMembers),Ce.accounts&&Ce.accounts.length>0){Nr.next=7;break}return Nr.abrupt("return",fr);case 7:return Nr.abrupt("return",Is(fr).call(fr,function(Fr){var jr;return(jr=Ce.accounts)===null||jr===void 0?void 0:qc(jr).call(jr,Fr.account)}));case 8:case"end":return Nr.stop()}},ar,this)}))},Fe.getMutedTeamMembers=function(Ce){return Un(this,void 0,void 0,wr.mark(function Pt(){var ar,tr;return wr.wrap(function(br){for(;;)switch(br.prev=br.next){case 0:return Qn({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1}},Ce),br.next=3,this.core.sendCmd("getMutedTeamMembers",{teamId:Ce.teamId});case 3:return ar=br.sent,tr=ar.content,br.abrupt("return",ff(tr.teamMembers));case 6:case"end":return br.stop()}},Pt,this)}))},Fe.addTeamMembers=function(Ce){return Un(this,void 0,void 0,wr.mark(function Pt(){return wr.wrap(function(tr){for(;;)switch(tr.prev=tr.next){case 0:return Qn({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1},accounts:{type:"array",itemType:"string",min:1},ps:{type:"string",allowEmpty:!0,max:5e3,required:!1}},Ce),tr.next=3,this.core.sendCmd("addTeamMembers",{teamId:Ce.teamId,accounts:Ce.accounts,ps:Ce.ps||"",attach:Ce.ext||""});case 3:case"end":return tr.stop()}},Pt,this)}))},Fe.removeTeamMembers=function(Ce){return Un(this,void 0,void 0,wr.mark(function Pt(){return wr.wrap(function(tr){for(;;)switch(tr.prev=tr.next){case 0:return Qn({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1},accounts:{type:"array",itemType:"string",min:1}},Ce),tr.next=3,this.core.sendCmd("removeTeamMembers",{teamId:Ce.teamId,accounts:Ce.accounts});case 3:case"end":return tr.stop()}},Pt,this)}))},Fe.applyTeam=function(Ce){return Un(this,void 0,void 0,wr.mark(function Pt(){var ar;return wr.wrap(function(fr){for(;;)switch(fr.prev=fr.next){case 0:return Qn({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1},ps:{type:"string",allowEmpty:!0,max:5e3,required:!1}},Ce),fr.next=3,this.core.sendCmd("applyTeam",{teamId:Ce.teamId,ps:Ce.ps||""});case 3:return ar=fr.sent,fr.abrupt("return",Jc(ar.content.team));case 5:case"end":return fr.stop()}},Pt,this)}))},Fe.addTeamManagers=function(Ce){return Un(this,void 0,void 0,wr.mark(function Pt(){return wr.wrap(function(tr){for(;;)switch(tr.prev=tr.next){case 0:return Qn({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1},accounts:{type:"array",min:1,itemType:"string"}},Ce),tr.next=3,this.core.sendCmd("addTeamManagers",Ce);case 3:case"end":return tr.stop()}},Pt,this)}))},Fe.removeTeamManagers=function(Ce){return Un(this,void 0,void 0,wr.mark(function Pt(){return wr.wrap(function(tr){for(;;)switch(tr.prev=tr.next){case 0:return Qn({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1},accounts:{type:"array",min:1,itemType:"string"}},Ce),tr.next=3,this.core.sendCmd("removeTeamManagers",Ce);case 3:case"end":return tr.stop()}},Pt,this)}))},Fe.updateMyMemberInfo=function(Ce){return Un(this,void 0,void 0,wr.mark(function Pt(){var ar,tr,fr;return wr.wrap(function(Nr){for(;;)switch(Nr.prev=Nr.next){case 0:return Qn({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1},nickInTeam:{type:"string",allowEmpty:!1,required:!1},bitConfigMask:{type:"number",min:0,max:2,required:!1},ext:{type:"string",required:!1}},Ce),ar=Dy({teamId:Ce.teamId,nickInTeam:Ce.nickInTeam,bitConfigMask:Ce.bitConfigMask,ext:Ce.ext}),Nr.next=4,this.core.sendCmd("updateMyMemberInfo",{teamMember:ar});case 4:return tr=Jd(Hr({updateTime:new Date().getTime(),account:this.core.account},ar)),this.mergeMyTeamMembers([tr]),this.core.emit("updateTeamMember",tr),fr=Fc(this.myTeamMembersMap.get(tr.teamId)),this.core.emit("myTeamMembers",[fr]),Nr.abrupt("return",tr);case 10:case"end":return Nr.stop()}},Pt,this)}))},Fe.updateMemberNick=function(Ce){return Un(this,void 0,void 0,wr.mark(function Pt(){var ar,tr;return wr.wrap(function(br){for(;;)switch(br.prev=br.next){case 0:return Qn({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1},account:{type:"string",allowEmpty:!1},nickInTeam:{type:"string",allowEmpty:!1}},Ce),ar=Dy({teamId:Ce.teamId,nickInTeam:Ce.nickInTeam,account:Ce.account}),br.next=4,this.core.sendCmd("updateNickInTeam",{teamMember:ar});case 4:return tr=Jd(Hr({updateTime:new Date().getTime()},ar)),br.abrupt("return",tr);case 6:case"end":return br.stop()}},Pt,this)}))},Fe.muteTeamMember=function(Ce){return Un(this,void 0,void 0,wr.mark(function Pt(){return wr.wrap(function(tr){for(;;)switch(tr.prev=tr.next){case 0:return Qn({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1},account:{type:"string",allowEmpty:!1},mute:{type:"boolean"}},Ce),tr.next=3,this.core.sendCmd("muteTeamMember",{teamId:Ce.teamId,account:Ce.account,mute:Ce.mute?1:0});case 3:case"end":return tr.stop()}},Pt,this)}))},Fe.getTeamMemberInvitorAccid=function(Ce){var Pt;return Un(this,void 0,void 0,wr.mark(function ar(){var tr,fr;return wr.wrap(function(Nr){for(;;)switch(Nr.prev=Nr.next){case 0:return Qn({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1},accounts:{type:"array",itemType:"string",max:200}},Ce),tr={teamId:Ce.teamId},Ce.accounts&&Ce.accounts.length>0&&(tr.accounts=Ce.accounts),Nr.next=5,this.core.sendCmd("getTeamMemberInvitorAccid",tr);case 5:return fr=Nr.sent,Nr.abrupt("return",((Pt=fr.content)===null||Pt===void 0?void 0:Pt.accountsMap)||{});case 7:case"end":return Nr.stop()}},ar,this)}))},Fe.muteTeam=function(Ce){return Un(this,void 0,void 0,wr.mark(function Pt(){return wr.wrap(function(tr){for(;;)switch(tr.prev=tr.next){case 0:return Qn({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1},mute:{type:"boolean"}},Ce),tr.next=3,this.core.sendCmd("muteTeam",{teamId:Ce.teamId,mute:Ce.mute?1:0});case 3:case"end":return tr.stop()}},Pt,this)}))},Fe.passTeamApply=function(Ce){return Un(this,void 0,void 0,wr.mark(function Pt(){return wr.wrap(function(tr){for(;;)switch(tr.prev=tr.next){case 0:return Qn({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1},from:{type:"string",allowEmpty:!1}},Ce),tr.next=3,this.core.sendCmd("passTeamApply",Ce);case 3:case"end":return tr.stop()}},Pt,this)}))},Fe.rejectTeamApply=function(Ce){return Un(this,void 0,void 0,wr.mark(function Pt(){return wr.wrap(function(tr){for(;;)switch(tr.prev=tr.next){case 0:return Qn({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1},from:{type:"string",allowEmpty:!1},ps:{type:"string",max:5e3,required:!1}},Ce),tr.next=3,this.core.sendCmd("rejectTeamApply",{teamId:Ce.teamId,from:Ce.from,ps:Ce.ps||""});case 3:case"end":return tr.stop()}},Pt,this)}))},Fe.acceptTeamInvite=function(Ce){return Un(this,void 0,void 0,wr.mark(function Pt(){return wr.wrap(function(tr){for(;;)switch(tr.prev=tr.next){case 0:return Qn({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1},from:{type:"string",allowEmpty:!1}},Ce),tr.next=3,this.core.sendCmd("acceptTeamInvite",Ce);case 3:case"end":return tr.stop()}},Pt,this)}))},Fe.rejectTeamInvite=function(Ce){return Un(this,void 0,void 0,wr.mark(function Pt(){return wr.wrap(function(tr){for(;;)switch(tr.prev=tr.next){case 0:return Qn({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1},from:{type:"string",allowEmpty:!1},ps:{type:"string",max:5e3,required:!1}},Ce),tr.next=3,this.core.sendCmd("rejectTeamInvite",{teamId:Ce.teamId,from:Ce.from,ps:Ce.ps||""});case 3:case"end":return tr.stop()}},Pt,this)}))},Fe.notifyTeamMsgReceiptsHandler=function(Ce){var Pt,ar=(Pt=Ce.content)===null||Pt===void 0?void 0:Pt.teamMsgReceipts;ar&&ar.length>0&&(this.core.emit("teamMsgReceipts",ar),this.core.emit("msgReceipts",ar))},Fe.syncTeamsHandler=function(Ce){var Pt=Ce.content;this.core.eventBus.emit("sync/updateTimetag",{teams:Lo(Pt.timetag)});var ar=Pt==null?void 0:Pt.teams;if(ar&&ar.length){var tr=qh(ar);this.core.emit("teams",tr)}},Fe.syncCreateTeamHandler=function(Ce){var Pt=Ce.content,ar=Jc(Pt==null?void 0:Pt.team),tr=Uy(ar,ar.owner,"owner");this.core.emit("createTeam",ar,tr)},Fe.syncUpdateTeamMemberHandler=function(Ce){var Pt=Ce.content,ar=Jd(Pt==null?void 0:Pt.teamMember);ar.updateTime||(ar.updateTime=new Date().getTime()),this.mergeMyTeamMembers([ar]),this.core.emit("updateTeamMember",ar);var tr=Fc(this.myTeamMembersMap.get(ar.teamId));this.core.emit("myTeamMembers",[tr])},Fe.syncMyTeamMembersHandler=function(Ce){var Pt,ar=Ce.content;this.core.eventBus.emit("sync/updateTimetag",{myTeamMembers:Lo(ar.timetag)});var tr=ar==null?void 0:Ro(Pt=ar.teamMembers).call(Pt,function(fr){return Jd(fr)});this.mergeMyTeamMembers(tr),this.core.emit("myTeamMembers",Fc(tr))},Fe.notificationHandler=function(Ce){var Pt=Ce.attach,ar=Ce.scene,tr=Ce.from,fr=Ce.to,br=Ce.time,Nr=Ce.idServer,Fr=Ce.idClient,jr=Pt.team,Vr=Pt.account,Kr=Pt.accounts,Tn=Pt.type;if(ar==="team")switch(this.core.options.debugLevel==="debug"?this.logger.debug("team::recvNotification",Nr,Fr,Pt):this.logger.log("team::recvNotification",Nr,Fr,fr,Tn,Vr,Kr),Tn){case"updateTeam":jr.updateTime=br,this.core.emit("updateTeam",jr);break;case"addTeamMembers":this.service.notifyAddTeamMembers(jr,Kr);break;case"acceptTeamInvite":this.service.notifyAddTeamMembers(jr,[tr]);break;case"passTeamApply":this.service.notifyAddTeamMembers(jr,[Vr]);break;case"addTeamManagers":this.service.notifyUpdateTeamManagers(fr,Kr,!0,br);break;case"removeTeamManagers":this.service.notifyUpdateTeamManagers(fr,Kr,!1,br);break;case"removeTeamMembers":this.service.notifyRemoveTeamMembers(jr,Kr);break;case"leaveTeam":this.service.notifyRemoveTeamMembers(jr,[tr]);break;case"dismissTeam":this.core.emit("dismissTeam",{teamId:fr});break;case"transferTeam":this.service.notifyTransferTeam(jr,tr,Vr);break;case"updateTeamMemberMute":this.service.notifyUpdateTeamMembersMute(jr,[Vr],Pt.mute)}},he}(ws);(function(xe){xe[xe.none=0]="none",xe[xe.pass=1]="pass",xe[xe.decline=2]="decline",xe[xe.read=3]="read",xe[xe.deleted=4]="deleted",xe[xe.invalid=5]="invalid"})(rl||(rl={})),function(xe){xe[xe.default=0]="default",xe[xe.leave=1]="leave",xe[xe.roam=2]="roam"}(Bc||(Bc={}));var fp={applyTeam:0,rejectTeamApply:1,teamInvite:2,rejectTeamInvite:3,friendRequest:5,deleteFriend:6,recallMsgP2p:7,recallMsgTeam:8,recallMsgSuperTeam:12,deleteMsgP2pOneWay:13,deleteMsgTeamOneWay:14,applySuperTeam:15,rejectSuperTeamApply:16,superTeamInvite:17,rejectSuperTeamInvite:18,customP2p:100,customTeam:101,customSuperTeam:103},mp={1:"addFriend",2:"applyFriend",3:"passFriendApply",4:"rejectFriendApply"},If={setting:{needSaveOffline:{type:"boolean"},isRoutable:{type:"boolean"},envConfig:{type:"string"}},antiSpamInfo:{needAntiSpam:{type:"boolean"},antiSpamContent:{type:"boolean"}},pushInfo:Wh,recallMessageInfo:{idClient:{type:"string",rawKey:"deletedIdClient"},idServer:{type:"string",rawKey:"deletedIdServer"},createTime:{type:"number",rawKey:"deletedMsgTime"},fromNick:{type:"string",rawKey:"deletedMsgFromNick"},opeAccount:{type:"string"}}};function gp(xe,he,Fe){var Ue=+xe.type,Ce=tc(fp,Ue);Fe=Fe||Bc.default;var Pt=Hr(Hr({},Si(If,xe)),{type:Ce,time:+xe.time,to:xe.to,from:xe.from,idServer:xe.idServer,state:rl[rl.none],feature:Bc[Fe]});if(typeof Pt.attach=="string")try{Pt.attach=JSON.parse(Pt.attach)}catch(ar){he.error("formatSystemMessage: "+Pt.idServer+" parse attach error",ar&&ar.message)}return Ue===5&&Pt.attach?(Pt.attach.type=mp[+Pt.attach.vt],Pt.attach.type==="passFriendApply"?Pt.state=rl[rl.pass]:Pt.attach.type==="rejectFriendApply"&&(Pt.state=rl[rl.decline])):Ue<=3&&Pt.attach&&(Pt.attach=function(tr){var fr=tr.attach,br=tr.tinfo,Nr=Ys(tr,["attach","tinfo"]);return Nr.ext=fr,br!==void 0&&(Nr.team=Jc(Xi(tr.tinfo,xs.team))),Nr}(Pt.attach)),Pt}function $M(xe){var he=Hr({},xe);return Hr(Hr({},Wd(If,he)),{type:fp[he.type],to:he.to,attach:he.attach})}var LM={"4_6":"syncOfflineSysMsgs","4_18":"syncOfflineSysMsgs","4_19":"syncRecallMsgOfflineAndRoaming","4_101":"syncOfflineSysMsgs","7_3":"onSysMsg","7_7":"sendCustomSysMsg","7_14":"onRecallMsg","21_18":"onRecallMsg","21_117":"onRecallMsg","7_15":"syncRecallMsgOfflineAndRoaming","21_19":"onSysMsg","21_16":"sendSuperTeamCustomSysMsg","101_3":"onSysMsg","101_7":"sendFilterCustomSysMsg"},hp={sysMsg:Hr({time:0,type:1,to:2,from:3,content:4,attach:5,idServer:6,needSaveOffline:7,deletedIdClient:10,deletedIdServer:11,needcAntiSpam:12,antiSpamContent:13,deletedMsgTime:14,deletedMsgFromNick:15,opeAccount:16,envConfig:21,callbackExt:22,isRoutable:105},Gy)},Hl=Cs(hp),jM={onSysMsg:{service:"systemMessage",sid:7,cid:3,response:[{type:"Property",name:"sysMsg",reflectMapper:Hl.sysMsg}]},sendCustomSysMsg:{service:"systemMessage",sid:7,cid:7,params:[{type:"Property",name:"sysMsg",reflectMapper:hp.sysMsg}]},sendSuperTeamCustomSysMsg:{service:"systemMessage",sid:21,cid:16,params:[{type:"Property",name:"sysMsg",reflectMapper:hp.sysMsg}]},sendFilterCustomSysMsg:{service:"systemMessage",sid:101,cid:7,params:[{type:"Property",name:"sysMsg",reflectMapper:hp.sysMsg}]},batchMarkRead:{service:"systemMessage",sid:4,cid:5,isNoResponse:!0,params:[{type:"byte",name:"sid"},{type:"byte",name:"cid"},{type:"LongArray",name:"ids"}]},onRecallMsg:{sid:7,cid:14,service:"systemMessage",response:[{type:"Property",name:"sysMsg",reflectMapper:Hl.sysMsg}]},syncRecallMsgOfflineAndRoaming:{sid:7,cid:15,service:"systemMessage",response:[{type:"PropertyArray",name:"sysMsgs",reflectMapper:Hl.sysMsg},{type:"Number",name:"timetag"},{type:"Number",name:"type"}]},syncOfflineSysMsgs:{sid:4,cid:9,service:"systemMessage",response:[{type:"PropertyArray",name:"sysMsgs",reflectMapper:Hl.sysMsg}]}},DM=function(xe){function he(Ue){var Ce;return(Ce=xe.call(this,"systemMessage",Ue)||this).sysMsgUnread={total:0,friend:0,msg:0,team:0,superTeam:0},Ce.core.eventBus.on("logined",function(){Ce.initEventListeners()}),ls({cmdMap:LM,cmdConfig:jM}),Ce}Ko(he,xe);var Fe=he.prototype;return Fe.initEventListeners=function(){var Ce=this;this.core.eventBus.on("systemMessage/passFriendApply",function(Pt){Ce.core.emit("updateSystemMessages",[{idServer:Pt.idServer,from:Pt.account,state:"pass",type:"friendRequest"}])}),this.core.eventBus.on("systemMessage/rejectFriendApply",function(Pt){Ce.core.emit("updateSystemMessages",[{idServer:Pt.idServer,from:Pt.account,state:"decline",type:"friendRequest"}])})},Fe.doMarkSysMsgAck=function(Ce){var Pt=[],ar=[],tr=["applySuperTeam","rejectSuperTeamApply","superTeamInvite","rejectSuperTeamInvite","customSuperTeam"];Kn(Ce).call(Ce,function(fr){fr.idServer&&(qc(tr).call(tr,fr.type)?ar.push(fr.idServer):Pt.push(fr.idServer))}),Pt.length>0&&this.core.sendCmd("batchMarkRead",{sid:"7",cid:"3",ids:Pt}),ar.length>0&&this.core.sendCmd("batchMarkRead",{sid:"21",cid:"19",ids:ar})},Fe.sendCustomSysMsg=function(Ce){var Pt=this;Qn({to:{type:"string",allowEmpty:!1},type:{type:"enum",values:["customP2p","customTeam","customSuperTeam"]},attach:{type:"string",allowEmpty:!1},setting:{type:"object",rules:{needSaveOffline:{type:"boolean",required:!1},env:{type:"string",allowEmpty:!1,required:!1}},required:!1},pushInfo:{type:"object",required:!1,rules:Wh}},Ce);var ar=Ce.type==="customSuperTeam"?"sendSuperTeamCustomSysMsg":"sendCustomSysMsg";return this.core.sendCmd(ar,{sysMsg:$M(Ce)}).then(function(){Pt.logger.log("sendCustomSysMsg success")}).catch(function(tr){throw Pt.logger.error("sendCustomSysMsg failed",tr.message),tr})},Fe.onSysMsgHandler=function(Ce){var Pt,ar=(Pt=Ce.content)===null||Pt===void 0?void 0:Pt.sysMsg;if(ar){var tr=typeof Zs(Ce,"raw.r[0]")=="number"?""+Ce.raw.r[0]:void 0;ar.idServer=ar.idServer||tr;var fr=gp(ar,this.logger,Bc.default);this.core.emit("sysMsg",fr),this.doMarkSysMsgAck([fr])}else this.logger.warn("onSysMsg no content.sysMsg")},Fe.syncOfflineSysMsgsHandler=function(Ce){var Pt,ar=this;if(Ce.content.sysMsgs&&Ce.content.sysMsgs.length>0){var tr=Ro(Pt=Ce.content.sysMsgs).call(Pt,function(fr){return gp(fr,ar.logger,Bc.leave)});this.core.emit("syncSysMsgs",tr),this.doMarkSysMsgAck(tr)}},Fe.onRecallMsgHandler=function(Ce){var Pt,ar=(Pt=Ce.content)===null||Pt===void 0?void 0:Pt.sysMsg;if(ar){var tr=typeof Zs(Ce,"raw.r[0]")=="number"?""+Ce.raw.r[0]:void 0;ar.idServer=ar.idServer||tr;var fr=Xd([ar],function(Fr){return Fr===fp.recallMsgP2p?"p2p":Fr===fp.recallMsgTeam?"team":Fr===fp.recallMsgSuperTeam?"superTeam":""}(+ar.type));this.core.eventBus.emit("session/updateForDeletedMsg",fr);var br=gp(ar,this.logger,Bc.default);this.core.emit("sysMsg",br),this.doMarkSysMsgAck([br])}else this.logger.warn("onSysMsg no content.sysMsg")},Fe.syncRecallMsgOfflineAndRoamingHandler=function(Ce){var Pt=this,ar=Ce.content,tr=ar.timetag,fr=ar.type,br=ar.sysMsgs,Nr=Lo(fr),Fr=Nr===1?Bc.leave:Bc.roam,jr=Ro(br).call(br,function(Vr){return gp(Vr,Pt.logger,Fr)});Nr===1&&this.doMarkSysMsgAck(jr),this.core.eventBus.emit("sync/updateTimetag",{recallMsg:tr}),this.core.emit("syncSysMsgs",jr)},he}(ws);function vp(xe){var he=["bitsExtension","createTime","updateTime","passRelationShip","relationShip","source"],Fe=Hr({},xe);return Kn(he).call(he,function(Ue){Fe[Ue]!==void 0&&(Fe[Ue]=Lo(Fe[Ue]))}),Fe.relationShip!==void 0&&(Fe.valid=Fe.relationShip===1),Fe}var UM={1:"addFriend",2:"applyFriend",3:"passFriendApply",4:"rejectFriendApply"},dv={"12_4":"getFriends","12_1":"friendReuqest","12_2":"deleteFriend","12_3":"updateFriend","12_5":"syncFriends","12_6":"syncFriendUsers","12_101":"syncFriendRequest","12_102":"syncDeleteFriend","12_103":"syncUpdateFriend"},Ef={updateFriendTag:{account:4,alias:8,ext:10},delFriendParams:{delAlias:1},friendTag:{account:4,relationShip:5,passRelationShip:6,source:7,alias:8,bitsExtension:9,ext:10,createTime:11,updateTime:12,serverex:13},userTag:{account:1,nick:3,avatar:4,sign:5,gender:6,email:7,birth:8,tel:9,ext:10,createTime:12,updateTime:13}},Pf=Cs(Ef),hb={getFriends:{sid:12,cid:4,service:"friend",params:[{type:"Long",name:"timetag"}],response:[{type:"PropertyArray",name:"friends",reflectMapper:Pf.friendTag},{type:"Number",name:"timetag"}]},friendReuqest:{sid:12,cid:1,service:"friend",params:[{type:"String",name:"account"},{type:"Byte",name:"type"},{type:"String",name:"ps"}]},deleteFriend:{sid:12,cid:2,service:"friend",params:[{type:"String",name:"account"},{type:"Property",name:"delFriendParams",reflectMapper:Ef.delFriendParams}]},updateFriend:{sid:12,cid:3,service:"friend",params:[{type:"Property",name:"updateFriendTag",reflectMapper:Ef.updateFriendTag}]},syncFriends:{sid:12,cid:5,service:"friend",response:[{type:"PropertyArray",name:"friends",entity:"friendTag",reflectMapper:Pf.friendTag},{type:"Number",name:"timetag"}]},syncFriendUsers:{sid:12,cid:6,service:"friend",response:[{type:"PropertyArray",name:"users",entity:"userTag",reflectMapper:Pf.userTag},{type:"Number",name:"timetag"}]},syncFriendRequest:{sid:12,cid:101,service:"friend",params:[{type:"String",name:"account"},{type:"Number",name:"type"},{type:"String",name:"ps"}],response:[{type:"String",name:"account"},{type:"Number",name:"type"},{type:"String",name:"ps"}]},syncDeleteFriend:{sid:12,cid:102,service:"friend",response:[{type:"String",name:"account"}]},syncUpdateFriend:{sid:12,cid:103,service:"friend",response:[{type:"Property",name:"friend",reflectMapper:Pf.friendTag}]}},qM=function(xe){function he(Ue){var Ce;return Ce=xe.call(this,"friend",Ue)||this,ls({cmdMap:dv,cmdConfig:hb}),Ce}Ko(he,xe);var Fe=he.prototype;return Fe.getFriends=function(){var Ce;return Un(this,void 0,void 0,wr.mark(function Pt(){var ar,tr;return wr.wrap(function(br){for(;;)switch(br.prev=br.next){case 0:return br.next=2,this.core.sendCmd("getFriends",{timetag:0});case 2:return ar=br.sent,tr=((Ce=ar.content)===null||Ce===void 0?void 0:Ce.friends)||[],tr=Ro(tr).call(tr,function(Nr){return vp(Nr)}),br.abrupt("return",tr);case 6:case"end":return br.stop()}},Pt,this)}))},Fe.addFriend=function(Ce){return Un(this,void 0,void 0,wr.mark(function Pt(){var ar;return wr.wrap(function(fr){for(;;)switch(fr.prev=fr.next){case 0:return Qn({account:{type:"string",allowEmpty:!1},ps:{type:"string",allowEmpty:!1,required:!1}},Ce),fr.next=3,this.core.sendCmd("friendReuqest",{account:Ce.account,type:1,ps:Ce.ps||""});case 3:return ar=new Date().getTime(),fr.abrupt("return",{account:Ce.account,createTime:ar,updateTime:ar,valid:!0,source:0,passRelationShip:1,relationShip:1,bitsExtension:0});case 5:case"end":return fr.stop()}},Pt,this)}))},Fe.applyFriend=function(Ce){return Un(this,void 0,void 0,wr.mark(function Pt(){return wr.wrap(function(tr){for(;;)switch(tr.prev=tr.next){case 0:return Qn({account:{type:"string",allowEmpty:!1}},Ce),tr.next=3,this.core.sendCmd("friendReuqest",{account:Ce.account,type:2,ps:Ce.ps||""});case 3:case"end":return tr.stop()}},Pt,this)}))},Fe.passFriendApply=function(Ce){return Un(this,void 0,void 0,wr.mark(function Pt(){var ar=this;return wr.wrap(function(fr){for(;;)switch(fr.prev=fr.next){case 0:return Qn({account:{type:"string",allowEmpty:!1}},Ce),fr.next=3,this.core.sendCmd("friendReuqest",{account:Ce.account,type:3,ps:Ce.ps||""}).then(function(br){return ar.core.eventBus.emit("systemMessage/passFriendApply",Ce),br});case 3:case"end":return fr.stop()}},Pt,this)}))},Fe.rejectFriendApply=function(Ce){return Un(this,void 0,void 0,wr.mark(function Pt(){var ar=this;return wr.wrap(function(fr){for(;;)switch(fr.prev=fr.next){case 0:return Qn({account:{type:"string",allowEmpty:!1}},Ce),fr.next=3,this.core.sendCmd("friendReuqest",{account:Ce.account,type:4,ps:Ce.ps||""}).then(function(br){return ar.core.eventBus.emit("systemMessage/rejectFriendApply",Ce),br});case 3:case"end":return fr.stop()}},Pt,this)}))},Fe.deleteFriend=function(Ce){return Un(this,void 0,void 0,wr.mark(function Pt(){return wr.wrap(function(tr){for(;;)switch(tr.prev=tr.next){case 0:return Qn({account:{type:"string",allowEmpty:!1},delAlias:{type:"boolean"}},Ce),tr.next=3,this.core.sendCmd("deleteFriend",{account:Ce.account,delFriendParams:{delAlias:Ce.delAlias===!0?1:0}});case 3:case"end":return tr.stop()}},Pt,this)}))},Fe.updateFriend=function(Ce){return Un(this,void 0,void 0,wr.mark(function Pt(){return wr.wrap(function(tr){for(;;)switch(tr.prev=tr.next){case 0:return Qn({account:{type:"string",allowEmpty:!1},alias:{type:"string"},ext:{type:"string",required:!1}},Ce),tr.next=3,this.core.sendCmd("updateFriend",{updateFriendTag:Ce});case 3:case"end":return tr.stop()}},Pt,this)}))},Fe.syncFriendRequestHandler=function(Ce){var Pt=function(tr){var fr=Hr({},tr);try{fr.ps=fr.ps&&JSON.parse(fr.ps)}catch{}if(fr.type=UM[fr.type],fr.type==="addFriend"||fr.type==="passFriendApply"){var br=new Date().getTime();fr.friend={account:tr.account,alias:"",createTime:br,ext:"",updateTime:br,valid:!0}}return fr}(Ce.content);this.core.emit("syncFriend",Pt)},Fe.syncDeleteFriendHandler=function(Ce){var Pt=Ce.content.account;this.logger.log("friend::emit syncFriendAction: deleteFriend "+Pt),this.core.emit("syncFriend",{type:"deleteFriend",account:Pt})},Fe.syncUpdateFriendHandler=function(Ce){var Pt=vp(Ce.content.friend);this.logger.log("friend::emit syncFriendAction: updateFriend, ",Pt==null?void 0:Pt.account),this.core.emit("syncFriend",{type:"updateFriend",friend:Pt})},Fe.syncFriendsHandler=function(Ce){var Pt=Ce.content;this.core.eventBus.emit("sync/updateTimetag",{friends:Lo(Pt.timetag)});var ar=Pt==null?void 0:Pt.friends;if(ar&&ar.length){var tr=Ro(ar).call(ar,function(fr){return vp(fr)});this.core.emit("friends",tr)}},Fe.syncFriendUsersHandler=function(Ce){var Pt=Ce.content;this.core.eventBus.emit("sync/updateTimetag",{friendUsers:Lo(Pt.timetag)});var ar=Pt==null?void 0:Pt.users;if(ar&&ar.length){var tr=Ro(ar).call(ar,function(fr){return gu(fr)});this.core.emit("users",tr)}},he}(ws),pv={1:"Android",2:"iOS",4:"PC",8:"WindowsPhone",16:"Web",32:"Server",64:"Mac"};function vb(xe){return xe&&xe.length>0?Ro(xe).call(xe,function(he){return function(Ue){var Ce=Hr({},Ue),Pt=["subscribeTime","time"];return Kn(Pt).call(Pt,function(ar){Ce[ar]&&(Ce[ar]=Lo(Ce[ar]))}),Ce}(he)}):[]}function nl(xe){if(!xe)return xe;var he=xe.serverExt,Fe=Ys(xe,["serverExt"]),Ue=["time","type","value"];if(Kn(Ue).call(Ue,function(Ce){Fe[Ce]&&(Fe[Ce]=Lo(Fe[Ce]))}),Fe.clientType&&(Fe.clientType=pv[Fe.clientType]||""),he)try{Fe.ext=JSON.parse(he),typeof Fe.ext[0]=="string"&&(Fe.ext=Fe.ext[0])}catch{}return Fe}var yb={"14_1":"publishEvent","14_2":"pushEvent","14_3":"subscribeEvent","14_4":"unSubscribeEventsByAccounts","14_5":"unSubscribeEventsByType","14_6":"querySubscribeEventsByAccounts","14_7":"querySubscribeEventsByType","14_9":"pushEvents"},zl={msgEvent:{type:1,value:2,idClient:3,ext:4,validTime:5,broadcastType:6,sync:7,validTimeType:8,durable:9,time:10,idServer:11,clientType:12,serverConfig:13,serverExt:14,appid:101,account:103,enableMultiClient:104,consid:106},msgEventSubscribe:{type:1,subscribeTime:2,sync:3,to:102,from:104,time:105}},wu=Cs(zl),VM={publishEvent:{sid:14,cid:1,service:"event",params:[{type:"Property",name:"msgEvent",reflectMapper:zl.msgEvent}],response:[{type:"Property",name:"msgEvent",reflectMapper:wu.msgEvent}]},pushEvent:{sid:14,cid:2,service:"event",response:[{type:"Property",name:"msgEvent",reflectMapper:wu.msgEvent}]},subscribeEvent:{sid:14,cid:3,service:"event",params:[{type:"Property",name:"msgEventSubscribe",reflectMapper:zl.msgEventSubscribe},{type:"StrArray",name:"accounts"}],response:[{type:"StrArray",name:"accounts"}]},unSubscribeEventsByAccounts:{sid:14,cid:4,service:"event",params:[{type:"Property",name:"msgEventSubscribe",reflectMapper:zl.msgEventSubscribe},{type:"StrArray",name:"accounts"}],response:[{type:"StrArray",name:"accounts"}]},unSubscribeEventsByType:{sid:14,cid:5,service:"event",params:[{type:"Property",name:"msgEventSubscribe",reflectMapper:zl.msgEventSubscribe}]},querySubscribeEventsByAccounts:{sid:14,cid:6,service:"event",params:[{type:"Property",name:"msgEventSubscribe",reflectMapper:zl.msgEventSubscribe},{type:"StrArray",name:"accounts"}],response:[{type:"PropertyArray",name:"msgEventSubscribes",reflectMapper:wu.msgEventSubscribe}]},querySubscribeEventsByType:{sid:14,cid:7,service:"event",params:[{type:"Property",name:"msgEventSubscribe",reflectMapper:zl.msgEventSubscribe}],response:[{type:"PropertyArray",name:"msgEventSubscribes",reflectMapper:wu.msgEventSubscribe}]},pushEvents:{sid:14,cid:9,service:"event",response:[{type:"PropertyArray",name:"msgEvents",reflectMapper:wu.msgEvent}]}},pe=function(xe){function he(Ue){var Ce;return Ce=xe.call(this,"event",Ue)||this,ls({cmdMap:yb,cmdConfig:VM}),Ce}Ko(he,xe);var Fe=he.prototype;return Fe.publishEvent=function(Ce){var Pt;return Un(this,void 0,void 0,wr.mark(function ar(){var tr,fr,br;return wr.wrap(function(Fr){for(;;)switch(Fr.prev=Fr.next){case 0:return Qn({type:{type:"number"},value:{type:"number"},ext:{type:"string",required:!1},validTime:{type:"number",min:60,max:2592e3,required:!1},broadcastType:{type:"number",required:!1},sync:{type:"boolean",required:!1}},Ce),tr=Hr(Hr({validTime:604800},Ce),{idClient:Yp(),sync:Ce.sync===!0?1:0}),Fr.next=4,this.core.sendCmd("publishEvent",{msgEvent:tr});case 4:return fr=Fr.sent,br=((Pt=fr.content)===null||Pt===void 0?void 0:Pt.msgEvent)||{},Fr.abrupt("return",nl(br));case 7:case"end":return Fr.stop()}},ar,this)}))},Fe.subscribeEvent=function(Ce){var Pt;return Un(this,void 0,void 0,wr.mark(function ar(){var tr,fr,br;return wr.wrap(function(Fr){for(;;)switch(Fr.prev=Fr.next){case 0:return Qn({type:{type:"number"},accounts:{type:"array",itemType:"string",max:100},subscribeTime:{type:"number",min:60,max:2592e3,required:!1}},Ce),tr=Hr(Hr({subscribeTime:2592e3},Ce),{sync:Ce.sync===!0?1:0}),Fr.next=4,this.core.sendCmd("subscribeEvent",{msgEventSubscribe:tr,accounts:Ce.accounts});case 4:return fr=Fr.sent,br=((Pt=fr.content)===null||Pt===void 0?void 0:Pt.accounts)||[],Fr.abrupt("return",{failedAccounts:br});case 7:case"end":return Fr.stop()}},ar,this)}))},Fe.unSubscribeEvents=function(Ce){var Pt;return Un(this,void 0,void 0,wr.mark(function ar(){var tr,fr,br;return wr.wrap(function(Fr){for(;;)switch(Fr.prev=Fr.next){case 0:if(Qn({type:{type:"number"},accounts:{type:"array",itemType:"string",max:100,required:!1}},Ce),tr={type:Ce.type},!(Ce.accounts&&Ce.accounts.length>0)){Fr.next=9;break}return Fr.next=5,this.core.sendCmd("unSubscribeEventsByAccounts",{msgEventSubscribe:tr,accounts:Ce.accounts});case 5:br=Fr.sent,fr=((Pt=br.content)===null||Pt===void 0?void 0:Pt.accounts)||[],Fr.next=12;break;case 9:return Fr.next=11,this.core.sendCmd("unSubscribeEventsByType",{msgEventSubscribe:tr});case 11:fr=[];case 12:return Fr.abrupt("return",{failedAccounts:fr});case 13:case"end":return Fr.stop()}},ar,this)}))},Fe.querySubscribeEvents=function(Ce){var Pt;return Un(this,void 0,void 0,wr.mark(function ar(){var tr;return wr.wrap(function(br){for(;;)switch(br.prev=br.next){case 0:if(Qn({type:{type:"number"},accounts:{type:"array",itemType:"string",max:100,required:!1}},Ce),!(Ce.accounts&&Ce.accounts.length>0)){br.next=7;break}return br.next=4,this.core.sendCmd("querySubscribeEventsByAccounts",{msgEventSubscribe:{type:Ce.type},accounts:Ce.accounts});case 4:tr=br.sent,br.next=10;break;case 7:return br.next=9,this.core.sendCmd("querySubscribeEventsByType",{msgEventSubscribe:{type:Ce.type}});case 9:tr=br.sent;case 10:return br.abrupt("return",vb((Pt=tr.content)===null||Pt===void 0?void 0:Pt.msgEventSubscribes));case 11:case"end":return br.stop()}},ar,this)}))},Fe.pushEventHandler=function(Ce){var Pt,ar=((Pt=Ce.content)===null||Pt===void 0?void 0:Pt.msgEvent)||{};this.core.emit("pushEvents",[nl(ar)])},Fe.pushEventsHandler=function(Ce){var Pt,ar=((Pt=Ce.content)===null||Pt===void 0?void 0:Pt.msgEvents)||{};this.core.emit("pushEvents",function(fr){return ji(fr)&&fr.length>0?Ro(fr).call(fr,function(br){return nl(br)}):[]}(ar))},he}(ws);function _e(xe){var he={scene:jh[xe.scene],from:xe.threadMsgFromAccount,to:xe.threadMsgToAccount,time:xe.threadMsgTime,idServer:xe.threadMsgIdServer},Fe={limit:xe.limit<100?xe.limit:100,beginTime:typeof xe.beginTime=="number"?xe.beginTime:0,reverse:Kl(xe)===!0?1:0};return xe.lastMsgId&&(Fe.lastMsgId=xe.lastMsgId),{msg:he,threadMsgReq:Fe}}var Ve,Oe={"23_1":"getThreadMsgs","23_2":"getMsgsByIdServer"},Ie={msg:os,threadMsgReq:{beginTime:1,endTime:2,lastMsgId:3,limit:4,reverse:5},threadMsgsMeta:{total:1,lastMsgTime:2}},At=Cs(Ie),nr={getThreadMsgs:{sid:23,cid:1,service:"msgExtend",params:[{type:"Property",name:"msg",reflectMapper:Ie.msg},{type:"Property",name:"threadMsgReq",reflectMapper:Ie.threadMsgReq}],response:[{type:"Property",name:"threadMsg",reflectMapper:At.msg},{type:"Property",name:"threadMsgsMeta",reflectMapper:At.threadMsgsMeta},{type:"PropertyArray",name:"msgs",reflectMapper:At.msg}]},getMsgsByIdServer:{sid:23,cid:2,service:"msgExtend",params:[{type:"PropertyArray",name:"reqMsgs",reflectMapper:Ie.msg}],response:[{type:"PropertyArray",name:"msgs",reflectMapper:At.msg}]}},kt=function(xe){function he(Ue){var Ce;return Ce=xe.call(this,"msgExtend",Ue)||this,ls({cmdMap:Oe,cmdConfig:nr}),Ce}Ko(he,xe);var Fe=he.prototype;return Fe.getThreadMsgs=function(Ce){var Pt;return Un(this,void 0,void 0,wr.mark(function ar(){var tr,fr,br,Nr,Fr,jr,Vr;return wr.wrap(function(Tn){for(;;)switch(Tn.prev=Tn.next){case 0:return Qn({scene:{type:"enum",values:Ui(is)},threadMsgFromAccount:{type:"string",allowEmpty:!1},threadMsgIdServer:{type:"string",allowEmpty:!1},threadMsgTime:{type:"number"},threadMsgToAccount:{type:"string",allowEmpty:!1},beginTime:{type:"number",required:!1},endTime:{type:"number",required:!1},lastMsgId:{type:"string",allowEmpty:!1,required:!1},limit:{type:"number",min:1,max:100,required:!1},reverse:{type:"boolean",required:!1}},Ce),Tn.next=3,this.core.sendCmd("getThreadMsgs",_e(Ce));case 3:return tr=Tn.sent,fr=tr.content,br=fr.msgs,Nr=fr.threadMsg,Fr=tr.content.threadMsgsMeta,jr=Vi(Nr,this.core.account),Vr=(Pt=this.core.session)===null||Pt===void 0?void 0:Pt.getSessionWithUncomplete({id:jr}),br=Yd(br,Vr?{account:this.core.account,sessionAck:Vr.ack,msgReceiptTime:Vr.msgReceiptTime}:{account:this.core.account}),Nr=oc(Nr,Vr?{account:this.core.account,sessionAck:Vr.ack,msgReceiptTime:Vr.msgReceiptTime}:{account:this.core.account}),Tn.abrupt("return",{msgs:br,threadMsg:Nr,total:Lo(Fr.total),timetag:Lo(Fr.lastMsgTime)});case 11:case"end":return Tn.stop()}},ar,this)}))},Fe.getMsgsByIdServer=function(Ce){return Un(this,void 0,void 0,wr.mark(function Pt(){var ar,tr,fr,br,Nr=this;return wr.wrap(function(jr){for(;;)switch(jr.prev=jr.next){case 0:return Qn({reqMsgs:{type:"array",rules:{scene:{type:"enum",values:Ui(is)},from:{type:"string",allowEmpty:!1},to:{type:"string",allowEmpty:!1},idServer:{type:"string",allowEmpty:!1},time:{type:"number"}},min:1,max:100}},Ce),jr.next=3,this.core.sendCmd("getMsgsByIdServer",{reqMsgs:Ro(ar=Ce.reqMsgs).call(ar,function(Vr){return Hr(Hr({},Vr),{scene:tc(is,Vr.scene)})})});case 3:return fr=jr.sent,br=Ro(tr=fr.content.msgs).call(tr,function(Vr){var Kr,Tn=Vi(Vr,Nr.core.account),Mn=(Kr=Nr.core.session)===null||Kr===void 0?void 0:Kr.getSessionWithUncomplete({id:Tn});return oc(Vr,Mn?{account:Nr.core.account,sessionAck:Mn.ack,msgReceiptTime:Mn.msgReceiptTime}:{account:Nr.core.account})}),jr.abrupt("return",br);case 6:case"end":return jr.stop()}},Pt,this)}))},he}(ws);(function(xe){xe[xe.ASC=1]="ASC",xe[xe.DESC=2]="DESC"})(Ve||(Ve={}));var ur,gr={"7_6":"getHistoryMsgs","7_9":"deleteRoamingMsgs","4_24":"syncClearServerHistoryMsgs","7_18":"clearHistoryMsgsFromServer","7_118":"multiSyncClearServerHistoryMsgs","7_26":"nimFtsCloudMsgLogsAggWithSession","7_27":"nimFtsCloudMsgLogs"},Ar={msg:os,clearHistoryMsgsFromServerReqTag:{type:0,otherAccid:1,isDeleteRoam:2,toTid:3,isSyncSelf:4,ext:7},clearMsgsParamsWithSync:{type:0,otherAccid:1,isDeleteRoam:2,toTid:3,isSyncSelf:4,fromAccid:5,time:6,ext:7},ftsReqTag:{keyword:1,fromTime:2,toTime:3,sessionLimit:4,msglogsLimit:5,orderRule:6,p2pSessionList:7,teamSessionList:8,senderList:9,msgTypeList:10,msgSubTypeList:11}},Rr=Cs(Ar),Ur={deleteRoamingMsgs:{sid:7,cid:9,service:"msgLog",params:[{type:"StrArray",name:"ids"}]},getHistoryMsgs:{sid:7,cid:6,params:[{type:"String",name:"to"},{type:"Long",name:"beginTime"},{type:"Long",name:"endTime"},{type:"Long",name:"lastMsgId"},{type:"int",name:"limit"},{type:"bool",name:"reverse"},{type:"LongArray",name:"msgTypes"}],response:[{type:"PropertyArray",name:"msgs",reflectMapper:Rr.msg}],service:"msgLog"},clearHistoryMsgsFromServer:{sid:7,cid:18,params:[{type:"Property",name:"clearHistoryMsgsFromServerReqTag",reflectMapper:Ar.clearHistoryMsgsFromServerReqTag}],response:[{type:"Long",name:"timetag"}],service:"msgLog"},multiSyncClearServerHistoryMsgs:{sid:7,cid:118,response:[{type:"Property",name:"data",reflectMapper:Rr.clearMsgsParamsWithSync}],service:"msgLog"},syncClearServerHistoryMsgs:{sid:4,cid:24,service:"msgLog",response:[{type:"PropertyArray",name:"datas",reflectMapper:Rr.clearMsgsParamsWithSync}]},nimFtsCloudMsgLogsAggWithSession:{sid:7,cid:26,service:"msgLog",params:[{type:"Property",name:"tag",reflectMapper:Ar.ftsReqTag}],response:[{type:"PropertyArray",name:"datas",reflectMapper:Rr.msg}]},nimFtsCloudMsgLogs:{sid:7,cid:27,service:"msgLog",params:[{type:"Property",name:"tag",reflectMapper:Ar.ftsReqTag}],response:[{type:"PropertyArray",name:"datas",reflectMapper:Rr.msg}]}};(function(xe){xe[xe.p2p=1]="p2p",xe[xe.team=2]="team"})(ur||(ur={}));var Dr={type:{type:"enum",values:ur},isDeleteRoam:{type:"boolean"},isSyncSelf:{type:"boolean"},time:{type:"number"}};function Jr(xe){var he=Si(Dr,xe);return{sessionId:he.type==="p2p"?"p2p-"+he.otherAccid:"team-"+he.toTid,time:he.time}}var Cn={orderRule:{type:"enum",values:Ve}};function Sn(xe){var he,Fe=Si(Cn,xe);ji(Fe.msgTypeList)&&(Fe.msgTypeList=Ro(he=Fe.msgTypeList).call(he,function(Ce){return Ic[Ce]}).join(","));var Ue=["p2pSessionList","teamSessionList","senderList","msgSubTypeList"];return Kn(Ue).call(Ue,function(Ce){ji(Fe[Ce])&&(Fe[Ce]=Fe[Ce].join(","))}),Fe}var $n=function(xe){function he(Ue){var Ce;return Ce=xe.call(this,"msgLog",Ue)||this,ls({cmdMap:gr,cmdConfig:Ur}),Ce}Ko(he,xe);var Fe=he.prototype;return Fe.deleteRoamingMsgs=function(Ce){return Un(this,void 0,void 0,wr.mark(function Pt(){var ar,tr;return wr.wrap(function(br){for(;;)switch(br.prev=br.next){case 0:Qn({ids:{type:"array",itemType:"string"}},Ce),ar=[],br.prev=2,ar=Ro(tr=Ce.ids).call(tr,function(Nr){var Fr=Yo(Nr);return Fr.scene+"|"+Fr.accid}),br.next=10;break;case 6:throw br.prev=6,br.t0=br.catch(2),this.logger.error("Failed to delete roaming msgs with "+Ce.ids,br.t0),new Error("Failed to create session with "+Ce.ids);case 10:return br.next=12,this.core.sendCmd("deleteRoamingMsgs",{ids:ar});case 12:case"end":return br.stop()}},Pt,this,[[2,6]])}))},Fe.getHistoryMsgs=function(Ce){var Pt,ar;return Un(this,void 0,void 0,wr.mark(function tr(){var fr,br,Nr,Fr,jr,Vr,Kr;return wr.wrap(function(Mn){for(;;)switch(Mn.prev=Mn.next){case 0:return!((Pt=this.core.sync)===null||Pt===void 0)&&Pt.getSyncDoneFlag()||this.logger.warn("Please call getHistoryMsgs after syncdone event"),Qn({scene:{type:"enum",values:aa(jh)},to:{type:"string",allowEmpty:!1},beginTime:{type:"number",required:!1},endTime:{type:"number",required:!1},limit:{type:"number",min:1,max:100,required:!1},reverse:{type:"boolean",required:!1},lastMsgId:{type:"string",required:!1,allowEmpty:!1},asc:{type:"boolean",required:!1},msgTypes:{type:"array",itemType:"string",required:!1}},Ce),br=Ce.scene==="p2p"?"getHistoryMsgs":Ce.scene==="team"?"getHistoryTeamMsgs":"getHistorySuperTeamMsgs",Mn.next=5,this.core.sendCmd(br,Hr(Hr({beginTime:0,endTime:0,lastMsgId:0,limit:100,reverse:!1},Ce),{msgTypes:Ce.msgTypes?Ro(fr=Ce.msgTypes).call(fr,function(En){return Lh[En]}):[]}));case 5:if(Nr=Mn.sent,(Fr=Nr.content).msgs&&Fr.msgs.length>0){Mn.next=9;break}return Mn.abrupt("return",[]);case 9:if(jr=Vi(Fr.msgs[0],this.core.account),Vr=(ar=this.core.session)===null||ar===void 0?void 0:ar.getSessionWithUncomplete({id:jr}),Kr=Yd(Fr.msgs,Vr?{account:this.core.account,sessionAck:Vr.ack,msgReceiptTime:Vr.msgReceiptTime}:{account:this.core.account}),Ce.asc!==!0){Mn.next=14;break}return Mn.abrupt("return",Qc(Kr).call(Kr,function(En,In){return En.time-In.time}));case 14:return Mn.abrupt("return",Kr);case 15:case"end":return Mn.stop()}},tr,this)}))},Fe.clearHistoryMsgsFromServer=function(Ce){return Un(this,void 0,void 0,wr.mark(function Pt(){var ar,tr,fr;return wr.wrap(function(Nr){for(;;)switch(Nr.prev=Nr.next){case 0:return Qn({scene:{type:"enum",values:["p2p","team"]},to:{type:"string",allowEmpty:!1},ext:{type:"string",required:!1},isSyncSelf:{type:"boolean",required:!1}},Ce),(ar=Hr(Hr({isDeleteRoam:1},Ce),{type:Ce.scene==="team"?2:1,isSyncSelf:Ce.isSyncSelf===!0?1:0}))[ar.type===2?"toTid":"otherAccid"]=Ce.to,Nr.next=5,this.core.sendCmd("clearHistoryMsgsFromServer",{clearHistoryMsgsFromServerReqTag:ar});case 5:return tr=Nr.sent,fr=tr.content,this.core.eventBus.emit("session/updateForClearMsg",[{sessionId:Ce.scene+"-"+Ce.to}],!0),Nr.abrupt("return",fr);case 9:case"end":return Nr.stop()}},Pt,this)}))},Fe.multiSyncClearServerHistoryMsgsHandler=function(Ce){var Pt=Jr(Ce.content.data);this.core.eventBus.emit("session/updateForClearMsg",[Pt],!0),this.core.emit("clearServerHistoryMsgs",[Pt])},Fe.ftsCloudMsgLogs=function(Ce){return Un(this,void 0,void 0,wr.mark(function Pt(){return wr.wrap(function(tr){for(;;)switch(tr.prev=tr.next){case 0:return tr.abrupt("return",this.baseFtsCloudMsgLogs(Ce,"nimFtsCloudMsgLogs"));case 1:case"end":return tr.stop()}},Pt,this)}))},Fe.ftsCloudMsgLogsAggWithSession=function(Ce){return Un(this,void 0,void 0,wr.mark(function Pt(){return wr.wrap(function(tr){for(;;)switch(tr.prev=tr.next){case 0:return tr.abrupt("return",this.baseFtsCloudMsgLogs(Ce,"nimFtsCloudMsgLogsAggWithSession"));case 1:case"end":return tr.stop()}},Pt,this)}))},Fe.baseFtsCloudMsgLogs=function(Ce,Pt){return Un(this,void 0,void 0,wr.mark(function ar(){var tr,fr,br,Nr=this;return wr.wrap(function(jr){for(;;)switch(jr.prev=jr.next){case 0:if(Qn({keyword:{type:"string",allowEmpty:!1},fromTime:{type:"number",required:!1},toTime:{type:"number",required:!1},sessionLimit:{type:"number",required:!1},msglogsLimit:{type:"number",required:!1},orderRule:{type:"enum",values:Ui(Ve),required:!1},p2pSessionList:{type:"array",itemType:"string",required:!1},teamSessionList:{type:"array",itemType:"string",required:!1},senderList:{type:"array",itemType:"string",required:!1},msgTypeList:{type:"array",itemType:"enum",values:Ui(Ic),required:!1},msgSubTypeList:{type:"array",itemType:"number",required:!1}},Ce),!(Ce.fromTime&&Ce.toTime&&Ce.toTime<Ce.fromTime)){jr.next=3;break}throw new No("Request parameter error: toTime should be greater than fromTime",Ce,"");case 3:return fr=Sn(Ce),jr.next=6,this.core.sendCmd(Pt,{tag:fr});case 6:return br=jr.sent,jr.abrupt("return",Ro(tr=br.content.datas).call(tr,function(Vr){var Kr,Tn=Vi(Vr,Nr.core.account),Mn=(Kr=Nr.core.session)===null||Kr===void 0?void 0:Kr.getSessionWithUncomplete({id:Tn});return oc(Vr,Mn?{account:Nr.core.account,sessionAck:Mn.ack,msgReceiptTime:Mn.msgReceiptTime}:{account:Nr.core.account})}));case 8:case"end":return jr.stop()}},ar,this)}))},Fe.syncClearServerHistoryMsgsHandler=function(Ce){var Pt=function(tr){return ji(tr)&&tr.length>0?Ro(tr).call(tr,function(fr){return Jr(fr)}):[]}(Ce.content.datas);this.core.emit("clearServerHistoryMsgs",Pt)},he}(ws),Rn={"22_1":"requestProxy","22_2":"onRequestProxy"},Wn={requestProxyTag:{zone:1,path:2,method:3,header:4,body:5},requestProxyMsgTag:{from:1,body:2,time:3}},Fn=Cs(Wn),mo={requestProxy:{sid:22,cid:1,service:"passThrough",params:[{type:"Property",name:"requestProxyTag",reflectMapper:Wn.requestProxyTag}],response:[{type:"Property",name:"requestProxyTag",reflectMapper:Fn.requestProxyTag}]},onRequestProxy:{sid:22,cid:2,service:"passThrough",response:[{type:"Property",name:"proxyMsg",reflectMapper:Fn.requestProxyMsgTag}]}},ao=function(xe){function he(Ue){var Ce;return(Ce=xe.call(this,"passThrough",Ue)||this).core=Ue,ls({cmdMap:Rn,cmdConfig:mo}),Ce}Ko(he,xe);var Fe=he.prototype;return Fe.request=function(Ce){return Qn({path:{type:"string",allowEmpty:!1}},Ce),this.core.sendCmd("requestProxy",{requestProxyTag:Ce}).then(function(Pt){return Pt.content.proxyTag})},Fe.onRequestProxyHandler=function(Ce){var Pt=Ce.content.proxyMsg;Pt&&Pt.time&&(Pt.time=+Pt.time),this.core.emit("proxyMsg",Pt)},he}(ws),ea=js.some,oo=li("some");_n({target:"Array",proto:!0,forced:!oo},{some:function(he){return ea(this,he,arguments.length>1?arguments[1]:void 0)}});var Wr=na("Array").some,Gn=Array.prototype,Zn=function(xe){var he=xe.some;return xe===Gn||vr(Gn,xe)&&he===Gn.some?Wr:he},qn,Bn,Xn=function(he,Fe){if(he==null)return{};var Ue=nh(lb(he),function(Ce){return[Ce]});return Fe=Mu(Fe),Yy(he,Ue,function(Ce,Pt){return Fe(Ce,Pt[0])})},so={"6_2":"getNosToken","6_22":"getOriginUrl","6_26":"getNosCdnHost","6_27":"getGrayscaleConfig","6_28":"getMixStorePolicy","6_29":"getMixStoreToken","6_30":"getFileAuthToken"},yo={nosToken:{objectName:1,token:2,bucket:3,expireTime:4,expireSec:7,tag:8,shortUrl:9},mixStoreTokenReqTag:{provider:0,tokenCount:1,fileExpireSec:2,tag:3,returnBody:4},nosConfigTag:{bucket:1,cdnDomain:2,expire:3,objectNamePrefix:4},grayConfigTag:{config:0,ttl:1},mixStorePolicyTag:{providers:0,ttl:1,mixEnable:2,nosPolicy:3,s3Policy:4},mixStoreTokenResTag:{provider:0,accessKeyId:1,secretAccessKey:2,sessionToken:3,token:4,expireTime:5,bucket:6,objectName:7,fileExpireSec:8,tag:9,shortUrl:10,region:11},nosSafeUrlTag:{safeUrl:0,originUrl:1},mixStoreAuthTokenReqTag:{type:1,urls:2},mixStoreAuthTokenResTag:{type:1,tokens:2,token:3,ttl:4}},bo=Cs(yo),ta={getNosToken:{sid:6,cid:2,service:"cloudStorage",response:[{type:"Property",name:"nosToken",reflectMapper:bo.nosToken}],params:[{type:"String",name:"responseBody"},{type:"Property",name:"nosToken",entity:"nosToken",reflectMapper:yo.nosToken}]},getOriginUrl:{sid:6,cid:22,service:"cloudStorage",response:[{type:"Property",name:"nosSafeUrlTag",reflectMapper:bo.nosSafeUrlTag}],params:[{type:"Property",name:"nosSafeUrlTag",reflectMapper:yo.nosSafeUrlTag}]},getNosCdnHost:{sid:6,cid:26,service:"misc",response:[{type:"Property",name:"nosConfigTag",reflectMapper:bo.nosConfigTag}]},getGrayscaleConfig:{sid:6,cid:27,service:"cloudStorage",response:[{type:"Property",name:"grayConfigTag",reflectMapper:bo.grayConfigTag}],params:[{type:"Property",name:"config"}]},getMixStorePolicy:{sid:6,cid:28,service:"cloudStorage",params:[{type:"LongArray",name:"supportType"}],response:[{type:"Property",name:"mixStorePolicyTag",reflectMapper:bo.mixStorePolicyTag}]},getMixStoreToken:{sid:6,cid:29,service:"cloudStorage",params:[{type:"Property",name:"mixStoreTokenReqTag",reflectMapper:yo.mixStoreTokenReqTag}],response:[{type:"Property",name:"mixStoreTokenResTag",reflectMapper:bo.mixStoreTokenResTag}]},getFileAuthToken:{sid:6,cid:30,service:"cloudStorage",params:[{type:"Property",name:"mixStoreAuthTokenReqTag",reflectMapper:yo.mixStoreAuthTokenReqTag}],response:[{type:"Property",name:"mixStoreAuthTokenResTag",reflectMapper:bo.mixStoreAuthTokenResTag}]}};(function(xe){xe[xe.nos=1]="nos",xe[xe.s3=2]="s3"})(qn||(qn={})),function(xe){xe[xe.dontNeed=-1]="dontNeed",xe[xe.time=2]="time",xe[xe.urls=3]="urls"}(Bn||(Bn={}));var Po,ha,Bo={chunkUploadHost:"https://wanproxy-web.127.net",commonUploadHost:"https://nos.netease.com",chunkMaxSize:4194304e4,commonMaxSize:104857600,uploadReplaceFormat:"https://{host}/{object}",cdn:{defaultCdnDomain:"nim.nosdn.127.net",cdnDomain:"",bucket:"",objectNamePrefix:""},downloadUrl:"https://{bucket}-nosdn.netease.im/{object}",downloadHostList:["nos.netease.com"],nosCdnEnable:!0,isNeedToGetUploadPolicyFromServer:!0},qo={file:{md5:"$(Etag)",size:"$(ObjectSize)"},image:{md5:"$(Etag)",size:"$(ObjectSize)",w:"$(ImageInfo.Width)",h:"$(ImageInfo.Height)",orientation:"$(ImageInfo.Orientation)"},audio:{md5:"$(Etag)",size:"$(ObjectSize)",dur:"$(AVinfo.Audio.Duration)"},video:{md5:"$(Etag)",size:"$(ObjectSize)",dur:"$(AVinfo.Video.Duration)",w:"$(AVinfo.Video.Width)",h:"$(AVinfo.Video.Height)"}},va={accessKeyId:"",secretAccessKey:"",sessionToken:"",region:"",maxRetries:0,bucket:"",objectName:"",token:"",shortUrl:""};function Wi(xe){return xe===void 0&&(xe="file"),la(qo[xe]||{}).replace(/"/gi,'\\"')}(function(xe){xe[xe.nos=1]="nos",xe[xe.s3=2]="s3"})(Po||(Po={})),function(xe){xe[xe.dontNeed=-1]="dontNeed",xe[xe.time=2]="time",xe[xe.urls=3]="urls"}(ha||(ha={}));var Ho=function(){function xe(Fe,Ue){Ue===void 0&&(Ue={}),this.GRAYKEY="AllGrayscaleConfig",this.MIXSTOREKEY="AllMixStorePolicy",this.config={},this.nosCdnHostTimer=0,this.grayConfig={mixStoreEnable:!1,timeStamp:0,ttl:0},this.mixStorePolicy={providers:[],timeStamp:0,ttl:0,s3Policy:null,nosPolicy:null},this.curProvider=Po.nos,this.s3=null,this.mixStoreErrorCount=10,this.nosErrorCount=0,this.circuitTimer=0,this.name="cloudStorage",this.logger=Fe.logger,this.core=Fe,ls({cmdMap:so,cmdConfig:ta}),this.setOptions(Ue)}var he=xe.prototype;return he.setOptions=function(Ue){Ue===void 0&&(Ue={});var Ce=Ue.storageKeyPrefix||"NIMClient";this.GRAYKEY=Ce+"-AllGrayscaleConfig",this.MIXSTOREKEY=Ce+"-AllMixStorePolicy";var Pt=Ue.s3,ar=Ys(Ue,["s3"]),tr=Hr({},Bo,this.config);if(ar&&Object.prototype.hasOwnProperty.call(ar,"cdn")){var fr={cdn:Hr(Hr({},tr.cdn),ar.cdn)};this.config=Hr({},tr,ar,fr)}else this.config=Hr({},tr,ar);Pt&&(this.s3=Pt)},he.init=function(){return Un(this,void 0,void 0,wr.mark(function Ue(){return wr.wrap(function(Pt){for(;;)switch(Pt.prev=Pt.next){case 0:if(this.grayConfig=null,this.mixStorePolicy={providers:[],timeStamp:0,ttl:0,s3Policy:null,nosPolicy:null},this.curProvider=Po.nos,this.mixStoreErrorCount=10,!this.config.isNeedToGetUploadPolicyFromServer){Pt.next=9;break}return Pt.next=7,this.getGrayscaleConfig(this.core.options.appkey);case 7:return Pt.next=9,this.getNosCdnHost();case 9:case"end":return Pt.stop()}},Ue,this)}))},he.uploadFile=function(Ue){return Un(this,void 0,void 0,wr.mark(function Ce(){var Pt,ar,tr;return wr.wrap(function(br){for(;;)switch(br.prev=br.next){case 0:if(Qn({maxSize:{type:"number",required:!1},type:{type:"enum",values:["file","image","audio","video"]}},Ue),Ue.fileInput||Ue.file||Ue.filePath){br.next=3;break}throw new Error("uploadFile needs target file object or a filePath");case 3:if(!Ue.type||Ue.type==="file"){br.next=7;break}if(typeof(Pt=Zs(Ue,"file.type"))!="string"||Va(Pt).call(Pt,Ue.type)!==-1){br.next=7;break}throw new Error('The meta type "'+Pt+'" does not match "'+Ue.type+'"');case 7:if(this.grayConfig&&this.grayConfig.mixStoreEnable&&this.mixStorePolicy.providers.length){br.next=10;break}return this.logger.log("uploadFile:: uploadFile begin, use old nos"),br.abrupt("return",this.nosUpload(Ue));case 10:return this.logger.log("uploadFile:: uploadFile begin,Current settings grayConfig mixStoreEnable:"+this.grayConfig.mixStoreEnable+" curProvider:"+this.curProvider),this.s3||(this.curProvider=Po.nos),ar=va,br.prev=13,br.next=16,this.core.sendCmd("getMixStoreToken",{mixStoreTokenReqTag:{provider:this.curProvider,tokenCount:1,tag:"qchat",returnBody:Wi(Ue.type)}});case 16:tr=br.sent,ar=tr.content.mixStoreTokenResTag,br.next=24;break;case 20:throw br.prev=20,br.t0=br.catch(13),this.core.logger.error("uploadFile:: getMixStoreToken error",br.t0),new Zl("getMixStoreToken error",br.t0,this.curProvider,this.mixStorePolicy);case 24:return br.abrupt("return",this.curProvider===Po.s3?this.s3Upload(Ue,ar):this.nosUpload(Ue,ar));case 25:case"end":return br.stop()}},Ce,this,[[13,20]])}))},he.nosUpload=function(Ue,Ce){var Pt,ar;return Un(this,void 0,void 0,wr.mark(function tr(){var fr,br,Nr,Fr,jr,Vr,Kr,Tn,Mn,En,In,Pn,Hn;return wr.wrap(function(uo){for(;;)switch(uo.prev=uo.next){case 0:if(fr=Zs(this.core,"config.cdn.bucket"),br={tag:Ue.nosScenes||fr||"nim",expireSec:Ue.nosSurvivalTime},Ce){uo.next=13;break}return uo.prev=3,uo.next=6,this.core.sendCmd("getNosToken",{responseBody:Wi(Ue.type),nosToken:br});case 6:Nr=uo.sent,uo.next=13;break;case 9:throw uo.prev=9,uo.t0=uo.catch(3),this.core.logger.error("uploadFile:: getNosToken error",uo.t0),new Zl("getNosToken error",uo.t0,1);case 13:return uo.prev=13,jr=Nr?Nr.content.nosToken:Ce,this.core.logger.debug("uploadFile:: uploadFile params",{nosToken:jr,chunkUploadHost:this.config.chunkUploadHost,commonUploadHost:this.config.commonUploadHost,platform:sa.platform}),uo.next=18,this.core.adapters.uploadFile(Hr(Hr({},Ue),{nosToken:jr,chunkUploadHost:this.config.chunkUploadHost,commonUploadHost:this.config.commonUploadHost,maxSize:Ue.maxSize||this.config.chunkMaxSize}));case 18:Fr=uo.sent,uo.next=42;break;case 21:if(uo.prev=21,uo.t1=uo.catch(13),this.core.logger.error("uploadFile::nos uploadFile error",uo.t1),!Ce){uo.next=41;break}if(this.nosErrorCount!==0){uo.next=37;break}uo.prev=26,this._addCircuitTimer(),uo.next=33;break;case 30:throw uo.prev=30,uo.t2=uo.catch(26),new Zl("upload file error",uo.t2,this.curProvider,this.mixStorePolicy,Ue.file||Ue.filePath);case 33:return this.nosErrorCount=(Pt=this.mixStorePolicy.nosPolicy)===null||Pt===void 0?void 0:Pt.uploadConfig.retryPolicy.retry,uo.abrupt("return",this.uploadFile(Ue));case 37:return this.nosErrorCount--,uo.abrupt("return",this.nosUpload(Ue,Ce));case 39:uo.next=42;break;case 41:throw new Zl("nos uploadFile error",uo.t1,1);case 42:if(Vr=Fr==null?void 0:Fr.type,Kr=Vr&&Va(Vr).call(Vr,"/")>-1?Fo(Vr).call(Vr,0,Va(Vr).call(Vr,"/")):"",Tn={image:"imageInfo",video:"vinfo",audio:"vinfo"},Mn=this.config.uploadReplaceFormat.replace("{host}",this.config.cdn.cdnDomain||this.config.cdn.defaultCdnDomain).replace("{object}",Nr?Nr.content.nosToken.objectName:Ce==null?void 0:Ce.objectName),Ce&&Ce.shortUrl&&(Mn=Ce.shortUrl),Tn[Kr]){uo.next=49;break}return uo.abrupt("return",Hr({url:Mn},Fr));case 49:if(uo.prev=49,!(Va(Mn).call(Mn,"_im_url=1")<0)){uo.next=54;break}return uo.next=53,this.core.adapters.request(Mn+"?"+Tn[Kr],{method:"GET",dataType:"json",timeout:5e3});case 53:En=uo.sent;case 54:uo.next=60;break;case 56:return uo.prev=56,uo.t3=uo.catch(49),this.core.logger.error("uploadFile:: fetch file info error",uo.t3),uo.abrupt("return",Hr({url:Mn},Fr));case 60:if(!En){uo.next=67;break}return In=En.data,Pn=Tn[Kr]==="imageInfo"?In:(ar=In==null?void 0:In.GetVideoInfo)===null||ar===void 0?void 0:ar.VideoInfo,Hn={url:Mn,name:Fr.name,size:Fr.size,ext:Fr.ext,w:Pn.Width,h:Pn.Height,orientation:Pn.Orientation,dur:Pn.Duration,audioCodec:Pn.AudioCodec,videoCodec:Pn.VideoCodec,container:Pn.Container},uo.abrupt("return",Xn(Hn,function(Do,no){return no!==void 0}));case 67:return uo.abrupt("return",Hr({url:Mn},Fr));case 68:case"end":return uo.stop()}},tr,this,[[3,9],[13,21],[26,30],[49,56]])}))},he.getNosCdnHost=function(){var Ue;return Un(this,void 0,void 0,wr.mark(function Ce(){var Pt,ar,tr,fr=this;return wr.wrap(function(Nr){for(;;)switch(Nr.prev=Nr.next){case 0:return Nr.prev=0,Nr.next=3,this.core.sendCmd("getNosCdnHost");case 3:Pt=Nr.sent,Nr.next=10;break;case 6:return Nr.prev=6,Nr.t0=Nr.catch(0),this.logger.error("getNosCdnHost::error",Nr.t0),Nr.abrupt("return");case 10:if(Pt){Nr.next=12;break}return Nr.abrupt("return");case 12:ar=(Ue=Pt==null?void 0:Pt.content)===null||Ue===void 0?void 0:Ue.nosConfigTag,(tr=Lo(ar==null?void 0:ar.expire))!==0&&ar.cdnDomain?tr===-1?(this.config.cdn.bucket=ar.bucket,this.config.cdn.cdnDomain=ar.cdnDomain,this.config.cdn.objectNamePrefix=ar.objectNamePrefix):(this.config.cdn.bucket=ar.bucket,this.config.cdn.cdnDomain=ar.cdnDomain,this.config.cdn.objectNamePrefix=ar.objectNamePrefix,this.nosCdnHostTimer=this.core.timerManager.addTimer(function(){fr.getNosCdnHost()},1e3*tr)):(this.config.cdn.bucket="",this.config.cdn.cdnDomain="",this.config.cdn.objectNamePrefix="");case 15:case"end":return Nr.stop()}},Ce,this,[[0,6]])}))},he.getGrayscaleConfig=function(Ue){var Ce;return Un(this,void 0,void 0,wr.mark(function Pt(){var ar,tr;return wr.wrap(function(br){for(;;)switch(br.prev=br.next){case 0:if(sa.localStorage)try{sa.localStorage.getItem&&sa.localStorage.getItem(this.GRAYKEY)&&(this.grayConfig=JSON.parse(sa.localStorage.getItem(this.GRAYKEY))[Ue])}catch(Nr){sa.localStorage.getItem(this.GRAYKEY)&&this.core.logger.error("uploadFile:: JSON.parse grayscaleConfig error ",Nr)}if(this.grayConfig&&!(this.grayConfig.timeStamp+1e3*this.grayConfig.ttl<new Date().getTime())){br.next=17;break}return br.next=4,this.core.sendCmd("getGrayscaleConfig",{config:{}});case 4:if(!(ar=br.sent).content||!ar.content.grayConfigTag){br.next=16;break}this.logger.log("uploadFile::getAppGrayConfigRequest success ");try{this.grayConfig=JSON.parse(ar.content.grayConfigTag.config),this.grayConfig.ttl=JSON.parse(ar.content.grayConfigTag.ttl)}catch(Nr){this.logger.error("getGrayscaleConfig error",Nr)}if(this.grayConfig){br.next=10;break}return br.abrupt("return");case 10:tr=sa.localStorage.getItem(this.GRAYKEY)?JSON.parse(sa.localStorage.getItem(this.GRAYKEY)):{},this.grayConfig.timeStamp=new Date().getTime(),tr[Ue]=this.grayConfig,sa.localStorage.setItem(this.GRAYKEY,la(tr)),br.next=17;break;case 16:this.logger.debug("uploadFile:: result grayConfig:",ar.content);case 17:if(!(!((Ce=this.grayConfig)===null||Ce===void 0)&&Ce.mixStoreEnable)){br.next=20;break}return br.next=20,this._getMixStorePolicy(Ue);case 20:case"end":return br.stop()}},Pt,this)}))},he._getMixStorePolicy=function(Ue){return Un(this,void 0,void 0,wr.mark(function Ce(){var Pt,ar,tr,fr,br,Nr,Fr;return wr.wrap(function(Vr){for(;;)switch(Vr.prev=Vr.next){case 0:if(Pt=new Date().getTime(),sa.localStorage)try{this.mixStorePolicy=JSON.parse(sa.localStorage.getItem(this.MIXSTOREKEY))[Ue],this.curProvider=Lo(this.mixStorePolicy.providers[0]),this.mixStorePolicy.timeStamp&&this.mixStorePolicy.timeStamp+1e3*this.mixStorePolicy.ttl>Pt&&(tr=this.mixStorePolicy.timeStamp+1e3*this.mixStorePolicy.ttl-Pt,this.core.timerManager.addTimer(Go(ar=this._getMixStorePolicy).call(ar,this,Ue),tr))}catch(Kr){sa.localStorage.getItem(this.MIXSTOREKEY)&&JSON.parse(sa.localStorage.getItem(this.MIXSTOREKEY))[Ue]&&this.core.logger.error("uploadFile:: JSON.parse mixStorePolicy error ",Kr)}if(this.mixStorePolicy&&!(this.mixStorePolicy.timeStamp+1e3*this.mixStorePolicy.ttl<=Pt)){Vr.next=30;break}return Vr.prev=3,Vr.next=6,this.core.sendCmd("getMixStorePolicy",{supportType:this.s3?[1,2]:[1]});case 6:br=Vr.sent,Nr=br.content.mixStorePolicyTag,this.mixStorePolicy={providers:[],timeStamp:0,ttl:0,s3Policy:null,nosPolicy:null},this.mixStorePolicy.ttl=Number(Nr.ttl),this.mixStorePolicy.providers=Nr.providers.split(","),this.circuitTimer&&this.core.timerManager.deleteTimer(this.circuitTimer),this.curProvider=Lo(this.mixStorePolicy.providers[0]),this.mixStorePolicy.nosPolicy=Nr.nosPolicy?JSON.parse(Nr.nosPolicy):null,this.mixStorePolicy.s3Policy=Nr.s3Policy?JSON.parse(Nr.s3Policy):null,this.mixStorePolicy.s3Policy===null?this.mixStorePolicy.providers=["1"]:this.mixStorePolicy.nosPolicy===null?this.mixStorePolicy.providers=["2"]:this.mixStorePolicy.providers=this.mixStorePolicy.s3Policy.priority<this.mixStorePolicy.nosPolicy.priority?["2","1"]:["1","2"],this.core.timerManager.addTimer(Go(fr=this._getMixStorePolicy).call(fr,this,Ue),1e3*this.mixStorePolicy.ttl),Fr=sa.localStorage.getItem(this.MIXSTOREKEY)?JSON.parse(sa.localStorage.getItem(this.MIXSTOREKEY)):{},this.mixStorePolicy.timeStamp=new Date().getTime(),Fr[Ue]=this.mixStorePolicy,sa.localStorage.setItem(this.MIXSTOREKEY,la(Fr)),Vr.next=30;break;case 23:if(Vr.prev=23,Vr.t0=Vr.catch(3),this.logger.error("getMixStorePolicy error",Vr.t0),this.mixStoreErrorCount!==0){Vr.next=28;break}throw new Error("getMixStorePolicy all count error");case 28:this._getMixStorePolicy(Ue),this.mixStoreErrorCount--;case 30:this.mixStorePolicy.nosPolicy&&(this.nosErrorCount=this.mixStorePolicy.nosPolicy.uploadConfig.retryPolicy.retry);case 31:case"end":return Vr.stop()}},Ce,this,[[3,23]])}))},he.s3Upload=function(Ue,Ce){return Un(this,void 0,void 0,wr.mark(function Pt(){var ar,tr,fr,br,Nr,Fr,jr,Vr,Kr,Tn,Mn=this;return wr.wrap(function(In){for(;;)switch(In.prev=In.next){case 0:if(!Ue.file){In.next=4;break}ar=Ue.file,In.next=19;break;case 4:if(typeof Ue.fileInput!="string"){In.next=14;break}if(this.logger.warn("fileInput will abandon,Please use file or filepath"),!((tr=document.getElementById(Ue.fileInput))&&tr.files&&tr.files[0])){In.next=11;break}ar=tr.files[0],In.next=12;break;case 11:throw new Error("Can not get file from fileInput");case 12:In.next=19;break;case 14:if(!(Ue.fileInput&&Ue.fileInput.files&&Ue.fileInput.files[0])){In.next=18;break}ar=Ue.fileInput.files[0],In.next=19;break;case 18:throw new Error("Can not get file from fileInput "+Ue.fileInput);case 19:if(this.mixStorePolicy.s3Policy){In.next=21;break}throw new Error("dont get s3 policy");case 21:return fr={accessKeyId:Ce.accessKeyId,secretAccessKey:Ce.secretAccessKey,sessionToken:Ce.sessionToken,region:Ce.region,maxRetries:this.mixStorePolicy.s3Policy.uploadConfig.retryPolicy.retry},br=this.s3,(Nr=new br).config.update(fr),Fr=decodeURIComponent(Ce.bucket),jr=decodeURIComponent(Ce.objectName),Kr={Bucket:Fr,Key:jr,Body:Vr=ar,Metadata:{token:Ce.token},ContentType:Vr.type||"application/octet-stream"},this.core.logger.debug("uploadFile:: s3 upload params:",Kr),Tn=Nr.upload(Kr),In.abrupt("return",new wo(function(Pn){var Hn=new Date().getTime();Tn.send(function(ho,uo){var Do,no;if(ho){Mn.logger.error("uploadFile:","api::s3:upload file failed",ho),Mn.core.reporter.reportTraceStart("exceptions",{user_id:Mn.core.options.account,trace_id:(no=(Do=Mn.core)===null||Do===void 0?void 0:Do.socket)===null||no===void 0?void 0:no.sessionId,start_time:Hn,action:1}),Mn.core.reporter.reportTraceUpdateV2("exceptions",{code:typeof ho.status=="number"?ho.status:typeof ho.code=="number"?ho.code:0,description:ho.message||""+ho.code,operation_type:1,target:ho.hostname}),Mn.core.reporter.reportTraceEnd("exceptions",1);try{Mn._addCircuitTimer()}catch(Jn){throw new Zl("upload file error",Jn,Mn.curProvider,Mn.mixStorePolicy,Ue.file||Ue.filePath)}Pn(Mn.uploadFile(Ue))}else{var zr=Mn.mixStorePolicy.s3Policy.cdnSchema;zr=(zr=zr.replace("{cdnDomain}",Mn.mixStorePolicy.s3Policy.dlcdn)).replace("{objectName}",uo.Key),Pn({size:Vr.size,name:Vr.name,url:Ce.shortUrl?Ce.shortUrl:zr,ext:Vr.name.split(".")[1]||"unknown"})}})}));case 32:case"end":return In.stop()}},Pt,this)}))},he.getPrivateUrl=function(Ue){var Ce;if(!new RegExp(/http(s)?:\/\/([\w-]+\.)+[\w-]+(\/[\w- ./?%&=]*)?/).test(Ue))return this.logger.error("illegal file url:"+Ue),"";var Pt=/^(?:([A-Za-z]+):)?(\/{0,3})([0-9.\-A-Za-z]+)(?::(\d+))?(?:\/([^?#]*))?(?:\?([^#]*))?(?:#(.*))?$/.exec(Ue);Pt[0];var ar=Pt[1];Pt[2];var tr=Pt[3];Pt[4];var fr=Pt[5];if(Pt[6],Pt[7],(Ce=this.grayConfig)===null||Ce===void 0?void 0:Ce.mixStoreEnable){var br=this._getUrlType(Ue);return br===Po.s3&&this.mixStorePolicy.s3Policy&&(Ue=this.mixStorePolicy.s3Policy.cdnSchema.replace("{cdnDomain}",this.mixStorePolicy.s3Policy.dlcdn).replace("{objectName}",fr)),br===Po.nos&&this.mixStorePolicy.nosPolicy&&(Ue=this.mixStorePolicy.nosPolicy.cdnSchema.replace("{cdnDomain}",this.mixStorePolicy.nosPolicy.dlcdn).replace("{objectName}",fr)),Ue}var Nr=this.config,Fr=Nr.downloadUrl,jr=Nr.downloadHostList,Vr=Nr.nosCdnEnable,Kr=this.config.cdn.cdnDomain,Tn=this.config.cdn.objectNamePrefix?decodeURIComponent(this.config.cdn.objectNamePrefix):"",Mn=decodeURIComponent(fr),En=Va(Mn).call(Mn,Tn);if(Kr&&En>-1&&Vr)return""+ar+Kr+"/"+Fo(Mn).call(Mn,En);if(qc(jr).call(jr,tr)&&qc(fr).call(fr,"/")){var In=Va(fr).call(fr,"/"),Pn=fr.substring(0,In),Hn=fr.substring(In+1);return Fr.replace("{bucket}",Pn).replace("{object}",Hn)}var ho=Is(jr).call(jr,function(Do){return typeof tr=="string"&&qc(tr).call(tr,Do)})[0],uo=ho?tr.replace(ho,"").replace(/\W/g,""):null;return uo?Fr.replace("{bucket}",uo).replace("{object}",fr):Ue},he.getOriginUrl=function(Ue){return Un(this,void 0,void 0,wr.mark(function Ce(){var Pt;return wr.wrap(function(tr){for(;;)switch(tr.prev=tr.next){case 0:return tr.next=2,this.core.sendCmd("getOriginUrl",{nosSafeUrlTag:{safeUrl:Ue}});case 2:return Pt=tr.sent,tr.abrupt("return",Pt.content.nosSafeUrlTag.originUrl);case 4:case"end":return tr.stop()}},Ce,this)}))},he.getFileToken=function(Ue){return Un(this,void 0,void 0,wr.mark(function Ce(){var Pt,ar,tr,fr,br,Nr=this;return wr.wrap(function(jr){for(;;)switch(jr.prev=jr.next){case 0:if(Qn({type:{type:"number",min:2,max:3},urls:{type:"array",required:!1,itemType:"string"}},Ue),Pt=this.mixStorePolicy.nosPolicy?this.mixStorePolicy.nosPolicy.authPolicy.policyType:null,ar=this.mixStorePolicy.s3Policy?this.mixStorePolicy.s3Policy.authPolicy.policyType:null,Pt!==String(ha.dontNeed)||ar!==String(ha.dontNeed)){jr.next=8;break}throw this.logger.error("don't need token"),new Error("don't need token");case 8:if(Ue.type!==ha.time){jr.next=17;break}if(!(Pt&&Va(Pt).call(Pt,String(ha.time))>=0||ar&&Va(ar).call(ar,String(ha.time))>0)){jr.next=13;break}return jr.abrupt("return",this.getFileAuthToken(Ue));case 13:throw this.logger.error("don't support time token "),new Error("don't support type time token ");case 15:jr.next=33;break;case 17:if(Ue.urls&&Ue.urls.length){jr.next=20;break}throw this.logger.error("urls is required when urls token"),new Error("urls is required when urls token");case 20:if(fr=[],br=[],Kn(tr=Ue.urls).call(tr,function(Vr){var Kr=Nr._getUrlType(Vr);Kr===Po.nos&&br.push(Vr),Kr===Po.s3&&fr.push(Vr)}),(!ar||fr.length!==0&&Va(ar).call(ar,String(ha.urls))<0)&&(this.logger.warn("s3 url don't support url token"),fr=[]),(!Pt||br.length!==0&&Va(Pt).call(Pt,String(ha.urls))<0)&&(this.logger.warn("nos url don't support url token"),br=[]),fr.length!==0||br.length!==0){jr.next=30;break}throw this.logger.error("not support urls"),new Error("not support urls");case 30:if(fr.length!==0&&br.length!==0){jr.next=33;break}return Ue.urls=la(Ue.urls),jr.abrupt("return",this.getFileAuthToken(Ue));case 33:case"end":return jr.stop()}},Ce,this)}))},he.getFileAuthToken=function(Ue){return Un(this,void 0,void 0,wr.mark(function Ce(){var Pt;return wr.wrap(function(tr){for(;;)switch(tr.prev=tr.next){case 0:return tr.next=2,this.core.sendCmd("getFileAuthToken",{mixStoreAuthTokenReqTag:Ue});case 2:return Pt=tr.sent,tr.abrupt("return",Pt.content.mixStoreAuthTokenResTag);case 4:case"end":return tr.stop()}},Ce,this)}))},he._getUrlType=function(Ue){var Ce,Pt;return this.mixStorePolicy.nosPolicy&&Zn(Ce=this.mixStorePolicy.nosPolicy.dlcdns).call(Ce,function(ar){return Va(Ue).call(Ue,ar)>=0})?Po.nos:this.mixStorePolicy.s3Policy&&Zn(Pt=this.mixStorePolicy.s3Policy.dlcdns).call(Pt,function(ar){return Va(Ue).call(Ue,ar)>=0})?Po.s3:null},he._addCircuitTimer=function(){var Ue=this,Ce=this.mixStorePolicy.providers,Pt=Ce[(Va(Ce).call(Ce,String(this.curProvider))+1)%Ce.length];if(Pt===Ce[0])throw new Error("uploadFile all policy fail");var ar=Zs(this.mixStorePolicy,"s3Policy.uploadConfig.retryPolicy");if(ar&&ar.retryNext&&Pt&&(this.logger.log("uploadFile:: upload policy will change,now policy:"+this.curProvider+" nextProvider:"+Pt),this.curProvider=Lo(Pt),this.mixStorePolicy.nosPolicy&&this.mixStorePolicy.s3Policy)){var tr=this.mixStorePolicy[this.curProvider===Po.nos?"nosPolicy":"s3Policy"].uploadConfig.retryPolicy.circuit;if(!tr||tr===0)return;this.circuitTimer=this.core.timerManager.addTimer(function(){Ue.logger.log("uploadFile:: upload policy will change,now policy:"+Ue.curProvider+" nextProvider:"+Lo(Ue.mixStorePolicy.providers[0])),Ue.curProvider=Lo(Ue.mixStorePolicy.providers[0]),Ue.core.timerManager.deleteTimer(Ue.circuitTimer)},1e3*tr)}},he.process=function(Ue){var Ce=this[Ue.cmd+"Handler"];return typeof Ce=="function"?Ce.call(this,Ue):Ue.error&&!Ue.error.ignore?wo.reject(Ue.error):wo.resolve(Ue)},xe}(),Gi=gs({none:0,normal:1,all:3}),as=gs({normal:0,advanced:1}),xo=gs({normal:0,owner:1,manager:2}),ua={noVerify:0,needVerify:1,rejectAll:2},po=gs(ua),Qo={needVerify:0,noVerify:1},hs=gs(Qo),go={manager:0,all:1},bb=gs(go),fv={manager:0,all:1},Gs=gs(fv),Ks={manager:0,all:1},Ha=gs(Ks);function da(xe){var he,Fe=["teamId"],Ue=["level","memberNum","memberUpdateTime","createTime","updateTime"],Ce=["valid","validToCurrentUser","mute"],Pt={type:as,muteType:Gi,joinMode:po,beInviteMode:hs,inviteMode:bb,updateTeamMode:Gs,updateExtMode:Ha};xe.bits;var ar=Ys(xe,["bits"]);return Kn(Fe).call(Fe,function(tr){ar[tr]&&(ar[tr]=ar[tr].toString())}),Kn(Ue).call(Ue,function(tr){ar[tr]!==void 0&&(ar[tr]=Lo(ar[tr]))}),Kn(Ce).call(Ce,function(tr){ar[tr]!==void 0&&(ar[tr]=Lo(ar[tr])===1)}),Kn(he=aa(Pt)).call(he,function(tr){ar[tr]!==void 0&&(ar[tr]=Pt[tr][ar[tr]]||ar[tr])}),ar}function Ra(xe){return xe&&xe.length>0?Ro(xe).call(xe,function(he){return da(he)}):[]}function yp(xe){var he,Fe=Hr({},xe),Ue=["avatar","name","intro","announcement","ext"],Ce={joinMode:ua,beInviteMode:Qo,inviteMode:go,updateTeamMode:fv,updateExtMode:Ks};return Kn(Ue).call(Ue,function(Pt){Fe[Pt]!==void 0&&(Fe[Pt]=Fe[Pt].toString())}),Kn(he=aa(Ce)).call(he,function(Pt){Fe[Pt]!==void 0&&(Fe[Pt]=Ce[Pt][Fe[Pt]])}),Fe}function HM(xe){var he=["teamId","ext","account","nickInTeam"],Fe={};return xe.bitConfigMask!==void 0&&(Fe.bits=Lo(xe.bitConfigMask)),Kn(he).call(he,function(Ue){xe[Ue]&&(Fe[Ue]=xe[Ue].toString())}),Fe}function gi(xe){var he,Fe=["teamId"],Ue=["joinTime","updateTime","bitConfigMask"],Ce=["active","valid","mute"],Pt={type:xo},ar=xe.bits,tr=Ys(xe,["bits"]);return ar!==void 0&&(tr.muteTeam=Lo(ar)===1,tr.bitConfigMask=ar),tr.id=tr.teamId+"-"+tr.account,Kn(Fe).call(Fe,function(fr){tr[fr]&&(tr[fr]=tr[fr].toString())}),Kn(Ue).call(Ue,function(fr){tr[fr]!==void 0&&(tr[fr]=Lo(tr[fr]))}),Kn(Ce).call(Ce,function(fr){tr[fr]!==void 0&&(tr[fr]=Lo(tr[fr])===1)}),Kn(he=aa(Pt)).call(he,function(fr){tr[fr]!==void 0&&(tr[fr]=Pt[fr][tr[fr]]||tr[fr])}),tr}function bp(xe){return xe&&xe.length>0?Ro(xe).call(xe,function(he){return gi(he)}):[]}function Af(xe,he,Fe){return Fe===void 0&&(Fe="normal"),{id:xe.teamId+"-"+he,teamId:xe.teamId,account:he,type:Fe,nickInTeam:"",muteTeam:!1,mute:!1,joinTime:xe.memberUpdateTime,updateTime:xe.memberUpdateTime,active:!0,valid:!0}}function mv(xe,he,Fe){return Fe===void 0&&(Fe="normal"),he&&he.length>0?Ro(he).call(he,function(Ue){return Af(xe,Ue,Fe)}):[]}var ZM=function(){function xe(Fe){this.core=Fe}var he=xe.prototype;return he.notifyAddSuperTeamMembers=function(Ue,Ce){this.core.emit("addSuperTeamMembers",{team:Ue,accounts:Ce,members:mv(Ue,Ce)})},he.notifyUpdateSuperTeamManagers=function(Ue,Ce,Pt,ar){this.core.emit("updateSuperTeamManagers",{team:{teamId:Ue,memberUpdateTime:ar},accounts:Ce,isManager:Pt,members:Ro(Ce).call(Ce,function(tr){return{id:Ue+"-"+tr,type:"manager",account:tr,updateTime:ar}})})},he.notifyRemoveSuperTeamMembers=function(Ue,Ce){this.core.emit("removeSuperTeamMembers",{team:Ue,accounts:Ce})},he.notifyTransferSuperTeam=function(Ue,Ce,Pt){this.core.emit("transferSuperTeam",{team:Ue,from:{id:Ue.teamId+"-"+Ce,account:Ce,type:"normal",updateTime:Ue.memberUpdateTime},to:{id:Ue.teamId+"-"+Pt,account:Pt,type:"owner",updateTime:Ue.memberUpdateTime}})},he.notifyUpdateSuperTeamMembersMute=function(Ue,Ce,Pt){this.core.emit("updateSuperTeamMembersMute",{team:Ue,accounts:Ce,members:Ro(Ce).call(Ce,function(ar){return{id:Ue.teamId+"-"+ar,account:ar,teamId:Ue.teamId,mute:Pt,updateTime:Ue.memberUpdateTime}}),mute:Pt})},xe}(),eC={"21_5":"addSuperTeamMembers","21_6":"removeSuperTeamMembers","21_7":"leaveSuperTeam","21_8":"updateSuperTeamInfo","21_9":"getSuperTeamInfo","21_12":"getSuperTeams","21_15":"getSuperTeamMembers","21_10":"updateMySuperTeamMemberInfo","21_20":"applySuperTeam","21_21":"passSuperTeamApply","21_22":"rejectSuperTeamApply","21_23":"acceptSuperTeamInvite","21_24":"rejectSuperTeamInvite","21_26":"addSuperTeamManagers","21_27":"removeSuperTeamManagers","21_28":"muteSuperTeam","21_29":"muteSuperTeamMembers","21_30":"updateSuperTeamMemberNick","21_31":"transferSuperTeam","21_33":"getSuperTeamMembersByAccounts","21_34":"queryMuteSuperTeamMembers","21_101":"syncCreateSuperTeam","21_109":"syncSuperTeams","21_110":"syncUpdateSuperTeamMember","21_111":"syncMySuperTeamMembers"},Tb={superTeam:{teamId:1,name:3,type:4,owner:5,level:6,selfCustom:7,valid:8,memberNum:9,memberUpdateTime:10,createTime:11,updateTime:12,validToCurrentUser:13,intro:14,announcement:15,joinMode:16,bits:17,ext:18,serverExt:19,avatar:20,beInviteMode:21,inviteMode:22,updateTeamMode:23,updateExtMode:24,mute:100,muteType:101},superTeamMember:{teamId:1,account:3,type:4,nickInTeam:5,bits:7,active:8,valid:9,updateTime:11,ext:12,mute:13,invitorAccid:14,joinTime:15}},ol=Cs(Tb),tC={getSuperTeamInfo:{sid:21,cid:9,service:"superTeam",params:[{type:"Long",name:"teamId"}],response:[{type:"Property",name:"superTeam",reflectMapper:ol.superTeam}]},getSuperTeams:{sid:21,cid:12,service:"superTeam",params:[{type:"long",name:"timetag"}],response:[{type:"PropertyArray",name:"superTeams",reflectMapper:ol.superTeam},{type:"Number",name:"timetag"}]},updateSuperTeamInfo:{sid:21,cid:8,service:"superTeam",params:[{type:"Property",name:"superTeam",reflectMapper:Tb.superTeam}],response:[{type:"Number",name:"time"}]},addSuperTeamMembers:{sid:21,cid:5,service:"superTeam",params:[{type:"Long",name:"teamId"},{type:"StrArray",name:"accounts"},{type:"String",name:"ps"}],response:[{type:"StrArray",name:"abortedAccidList"},{type:"Long",name:"time"}]},removeSuperTeamMembers:{sid:21,cid:6,service:"superTeam",params:[{type:"Long",name:"teamId"},{type:"StrArray",name:"accounts"}]},addSuperTeamManagers:{sid:21,cid:26,service:"superTeam",params:[{type:"Long",name:"teamId"},{type:"StrArray",name:"accounts"}]},removeSuperTeamManagers:{sid:21,cid:27,service:"superTeam",params:[{type:"Long",name:"teamId"},{type:"StrArray",name:"accounts"}]},applySuperTeam:{sid:21,cid:20,service:"superTeam",params:[{type:"Long",name:"teamId"},{type:"String",name:"ps"}],response:[{type:"Property",name:"superTeam",reflectMapper:ol.superTeam}]},transferSuperTeam:{sid:21,cid:31,service:"superTeam",params:[{type:"Long",name:"teamId"},{type:"String",name:"account"},{type:"bool",name:"leave"}]},muteSuperTeam:{sid:21,cid:28,service:"superTeam",params:[{type:"Long",name:"teamId"},{type:"Int",name:"mute"}]},muteSuperTeamMembers:{sid:21,cid:29,service:"superTeam",params:[{type:"Long",name:"teamId"},{type:"StrArray",name:"accounts"},{type:"Int",name:"mute"}]},updateSuperTeamMemberNick:{sid:21,cid:30,service:"superTeam",params:[{type:"Property",name:"teamMember",reflectMapper:Tb.superTeamMember}]},updateMySuperTeamMemberInfo:{sid:21,cid:10,service:"superTeam",params:[{type:"Property",name:"teamMember",reflectMapper:Tb.superTeamMember}]},getSuperTeamMembersByAccounts:{sid:21,cid:33,service:"superTeam",params:[{type:"StrArray",name:"memberIds"}],response:[{type:"PropertyArray",name:"superTeamMembers",reflectMapper:ol.superTeamMember}]},getSuperTeamMembers:{sid:21,cid:15,service:"superTeam",params:[{type:"Long",name:"teamId"},{type:"Long",name:"joinTime"},{type:"Int",name:"limit"},{type:"Bool",name:"reverse"}],response:[{type:"PropertyArray",name:"superTeamMembers",reflectMapper:ol.superTeamMember}]},queryMuteSuperTeamMembers:{sid:21,cid:34,service:"superTeam",params:[{type:"Long",name:"teamId"},{type:"Long",name:"joinTime"},{type:"Int",name:"limit"},{type:"Bool",name:"reverse"}],response:[{type:"PropertyArray",name:"superTeamMembers",reflectMapper:ol.superTeamMember}]},leaveSuperTeam:{sid:21,cid:7,service:"superTeam",params:[{type:"Long",name:"teamId"}]},passSuperTeamApply:{sid:21,cid:21,service:"superTeam",params:[{type:"Long",name:"teamId"},{type:"String",name:"from"}]},rejectSuperTeamApply:{sid:21,cid:22,service:"superTeam",params:[{type:"Long",name:"teamId"},{type:"String",name:"from"},{type:"String",name:"ps"}]},acceptSuperTeamInvite:{sid:21,cid:23,service:"superTeam",params:[{type:"Long",name:"teamId"},{type:"String",name:"from"}]},rejectSuperTeamInvite:{sid:21,cid:24,service:"superTeam",params:[{type:"Long",name:"teamId"},{type:"String",name:"from"},{type:"String",name:"ps"}]},syncSuperTeams:{sid:21,cid:109,service:"superTeam",response:[{type:"PropertyArray",name:"teams",reflectMapper:ol.superTeam},{type:"Bool",name:"isAll"},{type:"Long",name:"timetag"}]},syncCreateSuperTeam:{sid:21,cid:101,service:"superTeam",response:[{type:"Property",name:"superTeam",reflectMapper:ol.superTeam}]},syncUpdateSuperTeamMember:{sid:21,cid:110,service:"superTeam",response:[{type:"Property",name:"teamMember",reflectMapper:ol.superTeamMember}]},syncMySuperTeamMembers:{sid:21,cid:111,ext:"sync",service:"superTeam",response:[{type:"PropertyArray",name:"teamMembers",reflectMapper:ol.superTeamMember},{type:"Number",name:"timetag"}]}},rC=function(xe){function he(Ue){var Ce;return(Ce=xe.call(this,"superTeam",Ue)||this).mySuperTeamMembersMap=new Cc,Ce.service=new ZM(Ue),ls({cmdMap:eC,cmdConfig:tC}),Ce.core.eventBus.on("team/onNotification",function(Pt){return Ce.notificationHandler(Pt)}),Ce}Ko(he,xe);var Fe=he.prototype;return Fe.mergeMySuperTeamMembers=function(Ce){var Pt=this;Kn(Ce).call(Ce,function(ar){var tr=ar.teamId,fr=Pt.mySuperTeamMembersMap.get(tr),br=Hr({},fr,ar);Pt.mySuperTeamMembersMap.set(tr,br)})},Fe.getSuperTeamInfo=function(Ce){return Un(this,void 0,void 0,wr.mark(function Pt(){var ar,tr;return wr.wrap(function(br){for(;;)switch(br.prev=br.next){case 0:return Qn({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1}},Ce),br.next=3,this.core.sendCmd("getSuperTeamInfo",{teamId:Ce.teamId});case 3:return ar=br.sent,tr=ar.content.superTeam,br.abrupt("return",da(tr));case 6:case"end":return br.stop()}},Pt,this)}))},Fe.getSuperTeams=function(){return Un(this,void 0,void 0,wr.mark(function Ce(){var Pt,ar;return wr.wrap(function(fr){for(;;)switch(fr.prev=fr.next){case 0:return fr.next=2,this.core.sendCmd("getSuperTeams",{timetag:0});case 2:return Pt=fr.sent,ar=Pt.content.superTeams,fr.abrupt("return",Ra(ar));case 5:case"end":return fr.stop()}},Ce,this)}))},Fe.updateSuperTeamInfo=function(Ce){return Un(this,void 0,void 0,wr.mark(function Pt(){var ar;return wr.wrap(function(fr){for(;;)switch(fr.prev=fr.next){case 0:return Qn({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1},name:{type:"string",allowEmpty:!1,required:!1},joinMode:{type:"enum",values:["noVerify","needVerify","rejectAll"],required:!1},beInviteMode:{type:"enum",values:["noVerify","needVerify"],required:!1},inviteMode:{type:"enum",values:["manager","all"],required:!1},updateTeamMode:{type:"enum",values:["manager","all"],required:!1},updateExtMode:{type:"enum",values:["manager","all"],required:!1},intro:{type:"string",allowEmpty:!1,required:!1},announcement:{type:"string",allowEmpty:!1,required:!1},avatar:{type:"string",allowEmpty:!1,required:!1},ext:{type:"string",allowEmpty:!1,required:!1}},Ce),ar=yp(Ce),fr.next=4,this.core.sendCmd("updateSuperTeamInfo",{superTeam:ar});case 4:return fr.abrupt("return",da(ar));case 5:case"end":return fr.stop()}},Pt,this)}))},Fe.addSuperTeamMembers=function(Ce){return Un(this,void 0,void 0,wr.mark(function Pt(){return wr.wrap(function(tr){for(;;)switch(tr.prev=tr.next){case 0:return Qn({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1},accounts:{type:"array",itemType:"string",min:1},ps:{type:"string",allowEmpty:!0,max:5e3,required:!1}},Ce),tr.next=3,this.core.sendCmd("addSuperTeamMembers",{teamId:Ce.teamId,accounts:Ce.accounts,ps:Ce.ps||"",attach:Ce.ext||""});case 3:case"end":return tr.stop()}},Pt,this)}))},Fe.removeSuperTeamMembers=function(Ce){return Un(this,void 0,void 0,wr.mark(function Pt(){return wr.wrap(function(tr){for(;;)switch(tr.prev=tr.next){case 0:return Qn({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1},accounts:{type:"array",itemType:"string",min:1}},Ce),tr.next=3,this.core.sendCmd("removeSuperTeamMembers",{teamId:Ce.teamId,accounts:Ce.accounts});case 3:case"end":return tr.stop()}},Pt,this)}))},Fe.addSuperTeamManagers=function(Ce){return Un(this,void 0,void 0,wr.mark(function Pt(){return wr.wrap(function(tr){for(;;)switch(tr.prev=tr.next){case 0:return Qn({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1},accounts:{type:"array",min:1,itemType:"string"}},Ce),tr.next=3,this.core.sendCmd("addSuperTeamManagers",Ce);case 3:case"end":return tr.stop()}},Pt,this)}))},Fe.removeSuperTeamManagers=function(Ce){return Un(this,void 0,void 0,wr.mark(function Pt(){return wr.wrap(function(tr){for(;;)switch(tr.prev=tr.next){case 0:return Qn({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1},accounts:{type:"array",min:1,itemType:"string"}},Ce),tr.next=3,this.core.sendCmd("removeSuperTeamManagers",Ce);case 3:case"end":return tr.stop()}},Pt,this)}))},Fe.applySuperTeam=function(Ce){return Un(this,void 0,void 0,wr.mark(function Pt(){var ar;return wr.wrap(function(fr){for(;;)switch(fr.prev=fr.next){case 0:return Qn({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1},ps:{type:"string",allowEmpty:!0,max:5e3,required:!1}},Ce),fr.next=3,this.core.sendCmd("applySuperTeam",{teamId:Ce.teamId,ps:Ce.ps||""});case 3:return ar=fr.sent,fr.abrupt("return",da(ar.content.superTeam));case 5:case"end":return fr.stop()}},Pt,this)}))},Fe.transferSuperTeam=function(Ce){return Un(this,void 0,void 0,wr.mark(function Pt(){return wr.wrap(function(tr){for(;;)switch(tr.prev=tr.next){case 0:return Qn({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1},account:{type:"string",allowEmpty:!1},leave:{type:"boolean"}},Ce),tr.next=3,this.core.sendCmd("transferSuperTeam",Ce);case 3:case"end":return tr.stop()}},Pt,this)}))},Fe.muteSuperTeam=function(Ce){return Un(this,void 0,void 0,wr.mark(function Pt(){return wr.wrap(function(tr){for(;;)switch(tr.prev=tr.next){case 0:return Qn({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1},mute:{type:"boolean"}},Ce),tr.next=3,this.core.sendCmd("muteSuperTeam",{teamId:Ce.teamId,mute:Ce.mute?1:0});case 3:case"end":return tr.stop()}},Pt,this)}))},Fe.muteSuperTeamMembers=function(Ce){return Un(this,void 0,void 0,wr.mark(function Pt(){return wr.wrap(function(tr){for(;;)switch(tr.prev=tr.next){case 0:return Qn({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1},accounts:{type:"array",itemType:"string"},mute:{type:"boolean"}},Ce),tr.next=3,this.core.sendCmd("muteSuperTeamMembers",{teamId:Ce.teamId,accounts:Ce.accounts,mute:Ce.mute?1:0});case 3:case"end":return tr.stop()}},Pt,this)}))},Fe.updateMemberNick=function(Ce){return Un(this,void 0,void 0,wr.mark(function Pt(){var ar,tr;return wr.wrap(function(br){for(;;)switch(br.prev=br.next){case 0:return Qn({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1},account:{type:"string",allowEmpty:!1},nickInTeam:{type:"string",allowEmpty:!1}},Ce),ar=HM({teamId:Ce.teamId,nickInTeam:Ce.nickInTeam,account:Ce.account}),br.next=4,this.core.sendCmd("updateSuperTeamMemberNick",{teamMember:ar});case 4:return tr=gi(Hr({updateTime:new Date().getTime()},ar)),br.abrupt("return",tr);case 6:case"end":return br.stop()}},Pt,this)}))},Fe.updateMyMemberInfo=function(Ce){return Un(this,void 0,void 0,wr.mark(function Pt(){var ar,tr,fr;return wr.wrap(function(Nr){for(;;)switch(Nr.prev=Nr.next){case 0:return Qn({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1},nickInTeam:{type:"string",allowEmpty:!1,required:!1},bitConfigMask:{type:"number",min:0,max:2,required:!1},ext:{type:"string",required:!1}},Ce),ar=HM({teamId:Ce.teamId,nickInTeam:Ce.nickInTeam,bitConfigMask:Ce.bitConfigMask,ext:Ce.ext}),Nr.next=4,this.core.sendCmd("updateMySuperTeamMemberInfo",{teamMember:ar});case 4:return tr=gi(Hr({updateTime:new Date().getTime(),account:this.core.account},ar)),this.mergeMySuperTeamMembers([tr]),this.core.emit("updateSuperTeamMember",tr),fr=Fc(this.mySuperTeamMembersMap.get(tr.teamId)),this.core.emit("mySuperTeamMembers",[fr]),Nr.abrupt("return",tr);case 10:case"end":return Nr.stop()}},Pt,this)}))},Fe.getSuperTeamMembersByAccounts=function(Ce){var Pt;return Un(this,void 0,void 0,wr.mark(function ar(){var tr,fr,br;return wr.wrap(function(Fr){for(;;)switch(Fr.prev=Fr.next){case 0:return Qn({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1},accounts:{type:"array",itemType:"string",max:20,min:1}},Ce),fr=Ro(tr=Ce.accounts).call(tr,function(jr){return Ce.teamId+"|"+jr}),Fr.next=4,this.core.sendCmd("getSuperTeamMembersByAccounts",{memberIds:fr});case 4:return br=Fr.sent,Fr.abrupt("return",bp((Pt=br.content)===null||Pt===void 0?void 0:Pt.superTeamMembers));case 6:case"end":return Fr.stop()}},ar,this)}))},Fe.getSuperTeamMembers=function(Ce){var Pt;return Un(this,void 0,void 0,wr.mark(function ar(){var tr;return wr.wrap(function(br){for(;;)switch(br.prev=br.next){case 0:return Qn({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1},joinTime:{type:"number",min:0,required:!1},limit:{type:"number",min:1,max:1e3,required:!1},reverse:{type:"boolean",required:!1}},Ce),br.next=3,this.core.sendCmd("getSuperTeamMembers",Hr({joinTime:0,limit:100,reverse:!1},Ce));case 3:return tr=br.sent,br.abrupt("return",bp((Pt=tr.content)===null||Pt===void 0?void 0:Pt.superTeamMembers));case 5:case"end":return br.stop()}},ar,this)}))},Fe.queryMuteMembers=function(Ce){return Un(this,void 0,void 0,wr.mark(function Pt(){var ar,tr;return wr.wrap(function(br){for(;;)switch(br.prev=br.next){case 0:return Qn({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1},joinTime:{type:"number",min:0,required:!1},limit:{type:"number",min:1,required:!1},reverse:{type:"boolean",required:!1}},Ce),br.next=3,this.core.sendCmd("queryMuteSuperTeamMembers",Hr({limit:100,joinTime:0,reverse:!1},Ce));case 3:return ar=br.sent,tr=ar.content,br.abrupt("return",bp(tr.superTeamMembers));case 6:case"end":return br.stop()}},Pt,this)}))},Fe.leaveSuperTeam=function(Ce){return Un(this,void 0,void 0,wr.mark(function Pt(){return wr.wrap(function(tr){for(;;)switch(tr.prev=tr.next){case 0:return Qn({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1}},Ce),tr.next=3,this.core.sendCmd("leaveSuperTeam",{teamId:Ce.teamId});case 3:case"end":return tr.stop()}},Pt,this)}))},Fe.passSuperTeamApply=function(Ce){return Un(this,void 0,void 0,wr.mark(function Pt(){return wr.wrap(function(tr){for(;;)switch(tr.prev=tr.next){case 0:return Qn({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1},from:{type:"string",allowEmpty:!1}},Ce),tr.next=3,this.core.sendCmd("passSuperTeamApply",Ce);case 3:case"end":return tr.stop()}},Pt,this)}))},Fe.rejectSuperTeamApply=function(Ce){return Un(this,void 0,void 0,wr.mark(function Pt(){return wr.wrap(function(tr){for(;;)switch(tr.prev=tr.next){case 0:return Qn({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1},from:{type:"string",allowEmpty:!1},ps:{type:"string",max:5e3,required:!1}},Ce),tr.next=3,this.core.sendCmd("rejectSuperTeamApply",{teamId:Ce.teamId,from:Ce.from,ps:Ce.ps||""});case 3:case"end":return tr.stop()}},Pt,this)}))},Fe.acceptSuperTeamInvite=function(Ce){return Un(this,void 0,void 0,wr.mark(function Pt(){return wr.wrap(function(tr){for(;;)switch(tr.prev=tr.next){case 0:return Qn({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1},from:{type:"string",allowEmpty:!1}},Ce),tr.next=3,this.core.sendCmd("acceptSuperTeamInvite",Ce);case 3:case"end":return tr.stop()}},Pt,this)}))},Fe.rejectSuperTeamInvite=function(Ce){return Un(this,void 0,void 0,wr.mark(function Pt(){return wr.wrap(function(tr){for(;;)switch(tr.prev=tr.next){case 0:return Qn({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1},from:{type:"string",allowEmpty:!1},ps:{type:"string",max:5e3,required:!1}},Ce),tr.next=3,this.core.sendCmd("rejectSuperTeamInvite",{teamId:Ce.teamId,from:Ce.from,ps:Ce.ps||""});case 3:case"end":return tr.stop()}},Pt,this)}))},Fe.syncSuperTeamsHandler=function(Ce){var Pt=Ce.content;this.core.eventBus.emit("sync/updateTimetag",{superTeams:Lo(Pt.timetag)});var ar=Pt==null?void 0:Pt.superTeams;if(ar&&ar.length){var tr=Ra(ar);this.core.emit("superTeams",tr)}},Fe.syncCreateSuperTeamHandler=function(Ce){var Pt=Ce.content,ar=da(Pt==null?void 0:Pt.superTeam),tr=Af(ar,ar.owner,"owner");this.core.emit("createSuperTeam",ar,tr)},Fe.syncUpdateSuperTeamMemberHandler=function(Ce){var Pt=Ce.content,ar=gi(Pt==null?void 0:Pt.teamMember);ar.updateTime||(ar.updateTime=new Date().getTime()),this.mergeMySuperTeamMembers([ar]),this.core.emit("updateSuperTeamMember",ar);var tr=Fc(this.mySuperTeamMembersMap.get(ar.teamId));this.core.emit("mySuperTeamMembers",[tr])},Fe.syncMySuperTeamMembersHandler=function(Ce){var Pt,ar=Ce.content;this.core.eventBus.emit("sync/updateTimetag",{mySuperTeamMembers:Lo(ar.timetag)});var tr=ar==null?void 0:Ro(Pt=ar.teamMembers).call(Pt,function(fr){return gi(fr)});this.mergeMySuperTeamMembers(tr),this.core.emit("mySuperTeamMembers",Fc(tr))},Fe.notificationHandler=function(Ce){var Pt=Ce.attach,ar=Ce.scene,tr=Ce.from,fr=Ce.to,br=Ce.time,Nr=Ce.idServer,Fr=Ce.idClient,jr=Pt.team,Vr=Pt.account,Kr=Pt.accounts,Tn=Pt.type;if(ar==="superTeam")switch(this.core.options.debugLevel==="debug"?this.logger.debug("superTeam::recvNotification",Nr,Fr,Pt):this.logger.log("superTeam::recvNotification",Nr,Fr,fr,Tn,Vr,Kr),Tn){case"updateSuperTeam":jr.updateTime=br,this.core.emit("updateSuperTeam",jr);break;case"addSuperTeamMembers":this.service.notifyAddSuperTeamMembers(jr,Kr);break;case"acceptSuperTeamInvite":this.service.notifyAddSuperTeamMembers(jr,[tr]);break;case"passSuperTeamApply":this.service.notifyAddSuperTeamMembers(jr,[Vr]);break;case"addSuperTeamManagers":this.service.notifyUpdateSuperTeamManagers(fr,Kr,!0,br);break;case"removeSuperTeamManagers":this.service.notifyUpdateSuperTeamManagers(fr,Kr,!1,br);break;case"removeSuperTeamMembers":this.service.notifyRemoveSuperTeamMembers(jr,Kr);break;case"leaveSuperTeam":this.service.notifyRemoveSuperTeamMembers(jr,[tr]);break;case"dismissSuperTeam":this.core.emit("dismissSuperTeam",{teamId:fr});break;case"transferSuperTeam":this.service.notifyTransferSuperTeam(jr,tr,Vr);break;case"updateSuperTeamMembersMute":this.service.notifyUpdateSuperTeamMembersMute(jr,Kr,Pt.mute)}},he}(ws),nC={"13_1":"getChatroomAddress","24_1":"getQChatAddress"},oC={getChatroomAddress:{sid:13,cid:1,service:"plugin",params:[{type:"Long",name:"chatroomId"},{type:"Boolean",name:"isWeixinApp"},{type:"Number",name:"ipType"}],response:[{type:"StrArray",name:"address"}]},getQChatAddress:{sid:24,cid:1,service:"plugin",params:[{type:"Property",name:"getQChatAddressTag",reflectMapper:{ipType:1}}],response:[{type:"StrArray",name:"address"}]}},aC=function(xe){function he(Ue){var Ce;return(Ce=xe.call(this,"plugin",Ue)||this).core=Ue,ls({cmdMap:nC,cmdConfig:oC}),Ce}Ko(he,xe);var Fe=he.prototype;return Fe.getChatroomAddress=function(Ce){return Un(this,void 0,void 0,wr.mark(function Pt(){var ar;return wr.wrap(function(fr){for(;;)switch(fr.prev=fr.next){case 0:return Qn({chatroomId:{type:"string",allowEmpty:!1},ipType:{type:"number",required:!1}},Ce),fr.next=3,this.core.sendCmd("getChatroomAddress",{chatroomId:Ce.chatroomId,isWeixinApp:sa.platform==="WXAPP",ipType:Ce.ipType||0});case 3:return ar=fr.sent,fr.abrupt("return",ar.content.address);case 5:case"end":return fr.stop()}},Pt,this)}))},Fe.getQChatAddress=function(Ce){return Un(this,void 0,void 0,wr.mark(function Pt(){var ar;return wr.wrap(function(fr){for(;;)switch(fr.prev=fr.next){case 0:return Qn({ipType:{type:"number",required:!1}},Ce),fr.next=3,this.core.sendCmd("getQChatAddress",{getQChatAddressTag:{ipType:(Ce==null?void 0:Ce.ipType)||0}});case 3:return ar=fr.sent,fr.abrupt("return",ar.content.address);case 5:case"end":return fr.stop()}},Pt,this)}))},he}(ws),sC={"7_19":"nimQueryCloudSessionList","7_20":"nimQueryCloudSession","7_21":"nimUpdateCloudSession","7_22":"nimDeleteCloudSessionList","7_121":"nimMultiSyncUpdateCloudSession"},gv={sessionReqTag:{minTimestamp:1,maxTimestamp:2,includedLastMsg:3,limit:4,hasMore:5},sessionTag:{sessionId:1,updateTime:2,ext:3,lastMsg:4,lastMsgType:5}},Sb=Cs(gv),iC={nimQueryCloudSessionList:{sid:7,cid:19,service:"cloudSession",params:[{type:"Property",name:"tag",reflectMapper:gv.sessionReqTag}],response:[{type:"Property",name:"tag",reflectMapper:Sb.sessionReqTag},{type:"PropertyArray",name:"sessions",reflectMapper:Sb.sessionTag}]},nimQueryCloudSession:{sid:7,cid:20,service:"cloudSession",params:[{type:"Property",name:"tag",reflectMapper:gv.sessionTag}],response:[{type:"Property",name:"session",reflectMapper:Sb.sessionTag}]},nimUpdateCloudSession:{sid:7,cid:21,service:"cloudSession",params:[{type:"Property",name:"tag",reflectMapper:gv.sessionTag}]},nimDeleteCloudSessionList:{sid:7,cid:22,service:"cloudSession",params:[{type:"PropertyArray",name:"tags",reflectMapper:gv.sessionTag}]},nimMultiSyncUpdateCloudSession:{sid:7,cid:121,service:"cloudSession",response:[{type:"Property",name:"session",reflectMapper:Sb.sessionTag}]}},cC={sessionId:{type:"string"},updateTime:{type:"number"},ext:{type:"string"},lastMsg:{type:"object"},lastMsgType:{type:"number"}};function zM(xe,he,Fe){var Ue=Si(cC,xe),Ce=Yo(Ue.sessionId,"|"),Pt=Ce.accid,ar=Ce.scene;if(Ue.sessionId=ar+"-"+Pt,Ue.lastMsg){var tr=Ue.lastMsgType===1;Ue.lastMsgInfo=tr?{isLastMsgRecalled:tr,revokedMsg:gp(Xi(Ue.lastMsg,Hl.sysMsg),Fe)}:{isLastMsgRecalled:tr,lastMsg:oc(Xi(Ue.lastMsg,_s.msg),{account:he})}}return delete Ue.lastMsg,delete Ue.lastMsgType,Ue}function lC(xe,he,Fe){return xe&&xe.length>0?Ro(xe).call(xe,function(Ue){return zM(Ue,he,Fe)}):[]}var JM,al,hv,uC=function(xe){function he(Ue){var Ce;return Ce=xe.call(this,"cloudSession",Ue)||this,ls({cmdMap:sC,cmdConfig:iC}),Ce}Ko(he,xe);var Fe=he.prototype;return Fe.queryCloudSessionList=function(Ce){var Pt;return Un(this,void 0,void 0,wr.mark(function ar(){var tr,fr,br,Nr;return wr.wrap(function(jr){for(;;)switch(jr.prev=jr.next){case 0:return Qn({minTimestamp:{type:"number",min:0,required:!1},maxTimestamp:{type:"number",min:0,required:!1},limit:{type:"number",min:1,required:!1},includedLastMsg:{type:"boolean",required:!1}},Ce),(tr=Hr({limit:100,includedLastMsg:!0},Ce)).includedLastMsg=SS.boolean(Ce,"includedLastMsg"),jr.next=5,this.core.sendCmd("nimQueryCloudSessionList",{tag:tr});case 5:return fr=jr.sent,br=((Pt=fr.content)===null||Pt===void 0?void 0:Pt.tag)||{},Nr=fr.content.sessions,jr.abrupt("return",{hasMore:+br.hasMore>0,sessionList:lC(Nr,this.core.account,this.logger)});case 9:case"end":return jr.stop()}},ar,this)}))},Fe.queryCloudSession=function(Ce){return Un(this,void 0,void 0,wr.mark(function Pt(){var ar,tr,fr,br;return wr.wrap(function(Fr){for(;;)switch(Fr.prev=Fr.next){case 0:return Qn({sessionId:{type:"string",allowEmpty:!1}},Ce),ar=Yo(Ce.sessionId,"-"),tr=ar.accid,fr=ar.scene,Fr.next=4,this.core.sendCmd("nimQueryCloudSession",{tag:{sessionId:fr==="superTeam"?"super_team|"+tr:fr+"|"+tr}});case 4:return br=Fr.sent,Fr.abrupt("return",zM(br.content.session,this.core.account,this.logger));case 6:case"end":return Fr.stop()}},Pt,this)}))},Fe.updateCloudSession=function(Ce){return Un(this,void 0,void 0,wr.mark(function Pt(){var ar,tr,fr;return wr.wrap(function(Nr){for(;;)switch(Nr.prev=Nr.next){case 0:return Qn({sessionId:{type:"string",allowEmpty:!1},ext:{type:"string",allowEmpty:!1,required:!1}},Ce),ar=Yo(Ce.sessionId,"-"),tr=ar.accid,fr=ar.scene,Nr.next=4,this.core.sendCmd("nimUpdateCloudSession",{tag:{sessionId:fr==="superTeam"?"super_team|"+tr:fr+"|"+tr,ext:Ce.ext}});case 4:case"end":return Nr.stop()}},Pt,this)}))},Fe.deleteCloudSessionList=function(Ce){return Un(this,void 0,void 0,wr.mark(function Pt(){var ar,tr;return wr.wrap(function(br){for(;;)switch(br.prev=br.next){case 0:return Qn({sessionIdList:{type:"array",itemType:"string"}},Ce),tr=Ro(ar=Ce.sessionIdList).call(ar,function(Nr){var Fr=Yo(Nr,"-"),jr=Fr.accid,Vr=Fr.scene;return{sessionId:Vr==="superTeam"?"super_team|"+jr:Vr+"|"+jr}}),br.next=4,this.core.sendCmd("nimDeleteCloudSessionList",{tags:tr});case 4:case"end":return br.stop()}},Pt,this)}))},Fe.nimMultiSyncUpdateCloudSessionHandler=function(Ce){var Pt=zM(Ce.content.session,this.core.account,this.logger);this.core.emit("multiSyncUpdateCloudSession",Pt)},he}(ws);(function(xe){xe[xe.audio=1]="audio",xe[xe.video=2]="video",xe[xe.custom=3]="custom"})(JM||(JM={})),function(xe){xe[xe.kClose=1]="kClose",xe[xe.kJoin=2]="kJoin",xe[xe.kInvite=3]="kInvite",xe[xe.kCancelInvite=4]="kCancelInvite",xe[xe.kReject=5]="kReject",xe[xe.kAccept=6]="kAccept",xe[xe.kLeave=7]="kLeave",xe[xe.kCustom=8]="kCustom"}(al||(al={})),function(xe){xe[xe.kDefault=0]="kDefault",xe[xe.kLeave=1]="kLeave",xe[xe.kSelfSync=3]="kSelfSync"}(hv||(hv={}));var WM={needPush:{type:"boolean",required:!1},pushTitle:{type:"string",required:!1},pushContent:{type:"string",required:!1},pushPayload:{type:"string",required:!1},needPushBadge:{type:"boolean",required:!1}},dC={"15_1":"signalingCreate","15_2":"signalingDelay","15_3":"signalingClose","15_4":"signalingJoin","15_5":"signalingLeave","15_6":"signalingInvite","15_7":"signalingCancelInvite","15_8":"signalingReject","15_9":"signalingAccept","15_10":"signalingSendCustomCommand","15_11":"signalingRecvNotification","15_12":"signalingMultiSyncNotification","15_13":"signalingSyncNotification","15_14":"singalingSyncChannels","15_15":"signalingQueryInfo","15_16":"signalingCallEx","15_17":"signalingJoinAndAccept"},Ci={avSignalTag:Hr({type:1,name:2,channelId:3,createTime:4,expireTime:5,creatorAccid:6,ext:7,invalid:8,fromAccid:10,toAccid:11,requestId:12,members:18,attach:19,attachExt:20,needOffline:21,msgId:22,uid:23,time:24,nertcChannelName:25,nertcTokenTtl:26,nertcToken:27,nertcJoinRoomQueryParamMap:28,nertcJoinRoomResponse:29,callStatus:30},{needPush:13,pushTitle:14,pushContent:15,pushPayload:16,needPushBadge:17})},$c=Cs(Ci),pC={signalingCreate:{sid:15,cid:1,service:"signaling",params:[{type:"Property",name:"tag",reflectMapper:Ci.avSignalTag}],response:[{type:"Property",name:"data",reflectMapper:$c.avSignalTag}]},signalingDelay:{sid:15,cid:2,service:"signaling",params:[{type:"Property",name:"tag",reflectMapper:Ci.avSignalTag}],response:[{type:"Property",name:"data",reflectMapper:$c.avSignalTag}]},signalingClose:{sid:15,cid:3,service:"signaling",params:[{type:"Property",name:"tag",reflectMapper:Ci.avSignalTag}],response:[{type:"Property",name:"data",reflectMapper:$c.avSignalTag}]},signalingJoin:{sid:15,cid:4,service:"signaling",params:[{type:"Property",name:"tag",reflectMapper:Ci.avSignalTag}],response:[{type:"Property",name:"data",reflectMapper:$c.avSignalTag}]},signalingLeave:{sid:15,cid:5,service:"signaling",params:[{type:"Property",name:"tag",reflectMapper:Ci.avSignalTag}]},signalingInvite:{sid:15,cid:6,service:"signaling",params:[{type:"Property",name:"tag",reflectMapper:Ci.avSignalTag}]},signalingCancelInvite:{sid:15,cid:7,service:"signaling",params:[{type:"Property",name:"tag",reflectMapper:Ci.avSignalTag}]},signalingReject:{sid:15,cid:8,service:"signaling",params:[{type:"Property",name:"tag",reflectMapper:Ci.avSignalTag}]},signalingAccept:{sid:15,cid:9,service:"signaling",params:[{type:"Property",name:"tag",reflectMapper:Ci.avSignalTag}]},signalingSendCustomCommand:{sid:15,cid:10,service:"signaling",params:[{type:"Property",name:"tag",reflectMapper:Ci.avSignalTag}]},signalingRecvNotification:{sid:15,cid:11,service:"signaling",response:[{type:"Property",name:"data",reflectMapper:$c.avSignalTag}]},signalingMultiSyncNotification:{sid:15,cid:12,service:"signaling",response:[{type:"Property",name:"data",reflectMapper:$c.avSignalTag}]},signalingSyncNotification:{sid:15,cid:13,service:"signaling",response:[{type:"PropertyArray",name:"datas",reflectMapper:$c.avSignalTag}]},singalingSyncChannels:{sid:15,cid:14,service:"signaling",response:[{type:"PropertyArray",name:"datas",reflectMapper:$c.avSignalTag}]},signalingQueryInfo:{sid:15,cid:15,service:"signaling",params:[{type:"Property",name:"tag",reflectMapper:Ci.avSignalTag}],response:[{type:"Property",name:"data",reflectMapper:$c.avSignalTag}]},signalingCallEx:{sid:15,cid:16,service:"signaling",params:[{type:"Property",name:"tag",reflectMapper:Ci.avSignalTag}],response:[{type:"Property",name:"data",reflectMapper:$c.avSignalTag}]},signalingJoinAndAccept:{sid:15,cid:17,service:"signaling",params:[{type:"Property",name:"tag",reflectMapper:Ci.avSignalTag}],response:[{type:"Property",name:"data",reflectMapper:$c.avSignalTag}]},signalingBatchMarkRead:{sid:4,cid:5,isNoResponse:!0,service:"signaling",params:[{type:"byte",name:"sid"},{type:"byte",name:"cid"},{type:"LongArray",name:"ids"}]}},Mb={type:{type:"number"},createTime:{type:"number"},expireTime:{type:"number"},invalid:{type:"boolean"},pushInfo:WM,pluginSetting:{nertcInfo:{nertcChannelName:{type:"string"},nertcTokenTtl:{type:"number"},nertcToken:{type:"string"},nertcJoinRoomQueryParamMap:{type:"string"},callStatus:{type:"number"}}},attach:{type:"object"},members:{type:"object"},needOffline:{type:"boolean"},uid:{type:"number"},time:{type:"number"}};function Tp(xe){var he,Fe=Si(Mb,xe),Ue=[];return Fe.members&&Fe.members.length>0&&(Ue=Ro(he=Fe.members).call(he,function(Ce){return function(ar){return Si(Mb,Xi(ar,{1:"accid",2:"uid",3:"createTime",4:"expireTime"}))}(Ce)}),delete Fe.members),Ue.length>0?{channelInfo:Fe,memberList:Ue}:{channelInfo:Fe}}function Lc(xe){return Wd(Mb,xe)}var fC=function(xe){function he(Ue){var Ce;return(Ce=xe.call(this)||this).timer=0,Ce.pollingInterval=12e4,Ce.name="signaling",Ce.logger=Ue.logger,Ce.core=Ue,Ce.channels={},ls({cmdMap:dC,cmdConfig:pC}),Ce}Ko(he,xe);var Fe=he.prototype;return Fe.callEx=function(Ce){var Pt;return Un(this,void 0,void 0,wr.mark(function ar(){var tr,fr,br,Nr;return wr.wrap(function(jr){for(;;)switch(jr.prev=jr.next){case 0:return Qn({type:{type:"number"},toAccid:{type:"string",allowEmpty:!1},requestId:{type:"string",allowEmpty:!1},needOffline:{type:"boolean",required:!1},pushInfo:{type:"object",required:!1,rules:WM},pluginSetting:{type:"object",required:!1,rules:{nertcInfo:{type:"object",required:!1}}}},Ce),jr.next=3,this.core.sendCmd("signalingCallEx",{tag:Lc(Ce)});case 3:return tr=jr.sent,fr=((Pt=tr.content)===null||Pt===void 0?void 0:Pt.data)||{},br=Tp(fr),this.channels[br.channelInfo.channelId]=Fc(br.channelInfo),this.timer||(this.timer=this.core.timerManager.addTimer(Go(Nr=this.aotoDelay).call(Nr,this),this.pollingInterval,-1)),jr.abrupt("return",br);case 9:case"end":return jr.stop()}},ar,this)}))},Fe.joinAndAccept=function(Ce){var Pt;return Un(this,void 0,void 0,wr.mark(function ar(){var tr,fr,br,Nr,Fr,jr;return wr.wrap(function(Kr){for(;;)switch(Kr.prev=Kr.next){case 0:return Qn({channelId:{type:"string",allowEmpty:!1},fromAccid:{type:"string",allowEmpty:!1},requestId:{type:"string",required:!1},needOffline:{type:"boolean",required:!1},uid:{type:"number",required:!1},pluginSetting:{type:"object",required:!1,rules:{nertcInfo:{type:"object",required:!1}}}},Ce),tr=Ce.fromAccid,(fr=Ys(Ce,["fromAccid"])).toAccid=tr,Kr.next=5,this.core.sendCmd("signalingJoinAndAccept",{tag:Lc(fr)});case 5:return br=Kr.sent,Nr=((Pt=br.content)===null||Pt===void 0?void 0:Pt.data)||{},Fr=Tp(Nr),this.channels[Fr.channelInfo.channelId]=Fc(Fr.channelInfo),this.timer||(this.timer=this.core.timerManager.addTimer(Go(jr=this.aotoDelay).call(jr,this),this.pollingInterval,-1)),Kr.abrupt("return",Fr);case 11:case"end":return Kr.stop()}},ar,this)}))},Fe.create=function(Ce){var Pt;return Un(this,void 0,void 0,wr.mark(function ar(){var tr,fr;return wr.wrap(function(Nr){for(;;)switch(Nr.prev=Nr.next){case 0:return Qn({type:{type:"number"},ext:{type:"string",required:!1}},Ce),Nr.next=3,this.core.sendCmd("signalingCreate",{tag:Lc(Ce)});case 3:return tr=Nr.sent,fr=((Pt=tr.content)===null||Pt===void 0?void 0:Pt.data)||{},Nr.abrupt("return",Tp(fr));case 6:case"end":return Nr.stop()}},ar,this)}))},Fe.close=function(Ce){return Un(this,void 0,void 0,wr.mark(function Pt(){return wr.wrap(function(tr){for(;;)switch(tr.prev=tr.next){case 0:return Qn({channelId:{type:"string",allowEmpty:!1},attachExt:{type:"string",required:!1},needOffline:{type:"boolean",required:!1}},Ce),tr.next=3,this.core.sendCmd("signalingClose",{tag:Lc(Ce)});case 3:case"end":return tr.stop()}},Pt,this)}))},Fe.queryInfo=function(Ce){var Pt;return Un(this,void 0,void 0,wr.mark(function ar(){var tr,fr;return wr.wrap(function(Nr){for(;;)switch(Nr.prev=Nr.next){case 0:return Qn({name:{type:"string",allowEmpty:!1}},Ce),Nr.next=3,this.core.sendCmd("signalingQueryInfo",{tag:Ce});case 3:return tr=Nr.sent,fr=((Pt=tr.content)===null||Pt===void 0?void 0:Pt.data)||{},Nr.abrupt("return",Tp(fr));case 6:case"end":return Nr.stop()}},ar,this)}))},Fe.join=function(Ce){var Pt;return Un(this,void 0,void 0,wr.mark(function ar(){var tr,fr,br,Nr;return wr.wrap(function(jr){for(;;)switch(jr.prev=jr.next){case 0:return Qn({channelId:{type:"string",allowEmpty:!1},attachExt:{type:"string",required:!1},uid:{type:"number",min:0,required:!1},needOffline:{type:"boolean",required:!1}},Ce),jr.next=3,this.core.sendCmd("signalingJoin",{tag:Lc(Ce)});case 3:return tr=jr.sent,fr=((Pt=tr.content)===null||Pt===void 0?void 0:Pt.data)||{},br=Tp(fr),this.channels[br.channelInfo.channelId]=Fc(br.channelInfo),this.timer||(this.timer=this.core.timerManager.addTimer(Go(Nr=this.aotoDelay).call(Nr,this),this.pollingInterval,-1)),jr.abrupt("return",br);case 9:case"end":return jr.stop()}},ar,this)}))},Fe.aotoDelay=function(){return Un(this,void 0,void 0,wr.mark(function Ce(){var Pt,ar,tr,fr,br;return wr.wrap(function(Fr){for(;;)switch(Fr.prev=Fr.next){case 0:if((Pt=aa(this.channels)).length!==0){Fr.next=4;break}return this.timer&&this.core.timerManager.deleteTimer(this.timer),Fr.abrupt("return");case 4:this.logger.log("signling:autoDelay",Pt),ar=0;case 6:if(!(ar<Pt.length)){Fr.next=23;break}return tr=Pt[ar],Fr.prev=8,Fr.next=11,this.core.sendCmd("signalingDelay",{tag:{channelId:tr}});case 11:fr=Fr.sent,br=Tp(fr.content.data),this.channels[tr]=br.channelInfo,Fr.next=20;break;case 16:Fr.prev=16,Fr.t0=Fr.catch(8),this.logger.warn("signling:autoDelay "+tr+" failed",Fr.t0),delete this.channels[tr];case 20:ar++,Fr.next=6;break;case 23:case"end":return Fr.stop()}},Ce,this,[[8,16]])}))},Fe.leave=function(Ce){return Un(this,void 0,void 0,wr.mark(function Pt(){return wr.wrap(function(tr){for(;;)switch(tr.prev=tr.next){case 0:return Qn({channelId:{type:"string",allowEmpty:!1},attachExt:{type:"string",required:!1},needOffline:{type:"boolean",required:!1}},Ce),tr.next=3,this.core.sendCmd("signalingLeave",{tag:Lc(Ce)});case 3:delete this.channels[Ce.channelId];case 4:case"end":return tr.stop()}},Pt,this)}))},Fe.invite=function(Ce){return Un(this,void 0,void 0,wr.mark(function Pt(){return wr.wrap(function(tr){for(;;)switch(tr.prev=tr.next){case 0:return Qn({channelId:{type:"string",allowEmpty:!1},toAccid:{type:"string",allowEmpty:!1},requestId:{type:"string",allowEmpty:!1},attachExt:{type:"string",required:!1},needOffline:{type:"boolean",required:!1},pushInfo:{type:"object",required:!1,rules:WM}},Ce),tr.next=3,this.core.sendCmd("signalingInvite",{tag:Lc(Ce)});case 3:case"end":return tr.stop()}},Pt,this)}))},Fe.cancelInvite=function(Ce){return Un(this,void 0,void 0,wr.mark(function Pt(){return wr.wrap(function(tr){for(;;)switch(tr.prev=tr.next){case 0:return Qn({channelId:{type:"string",allowEmpty:!1},toAccid:{type:"string",allowEmpty:!1},requestId:{type:"string",allowEmpty:!1},attachExt:{type:"string",required:!1},needOffline:{type:"boolean",required:!1}},Ce),tr.next=3,this.core.sendCmd("signalingCancelInvite",{tag:Lc(Ce)});case 3:case"end":return tr.stop()}},Pt,this)}))},Fe.reject=function(Ce){return Un(this,void 0,void 0,wr.mark(function Pt(){var ar,tr;return wr.wrap(function(br){for(;;)switch(br.prev=br.next){case 0:return Qn({channelId:{type:"string",allowEmpty:!1},fromAccid:{type:"string",allowEmpty:!1},requestId:{type:"string",allowEmpty:!1},attachExt:{type:"string",required:!1},needOffline:{type:"boolean",required:!1}},Ce),ar=Ce.fromAccid,(tr=Ys(Ce,["fromAccid"])).toAccid=ar,br.next=5,this.core.sendCmd("signalingReject",{tag:Lc(tr)});case 5:case"end":return br.stop()}},Pt,this)}))},Fe.accept=function(Ce){return Un(this,void 0,void 0,wr.mark(function Pt(){var ar,tr,fr,br,Nr;return wr.wrap(function(jr){for(;;)switch(jr.prev=jr.next){case 0:return Qn({channelId:{type:"string",allowEmpty:!1},fromAccid:{type:"string",allowEmpty:!1},requestId:{type:"string",allowEmpty:!1},attachExt:{type:"string",required:!1},needOffline:{type:"boolean",required:!1},autoJoin:{type:"boolean",required:!1},uid:{type:"number",min:0,required:!1},joinAttachExt:{type:"string",required:!1}},Ce),ar=Ce.autoJoin,tr=Ce.joinAttachExt,fr=Ce.fromAccid,(br=Ys(Ce,["autoJoin","joinAttachExt","fromAccid"])).toAccid=fr,jr.next=5,this.core.sendCmd("signalingAccept",{tag:Lc(br)});case 5:if(this.logger.log("Signaling:accept, accept success, autoJoin "+Ce.autoJoin),!ar){jr.next=10;break}return Nr={channelId:Ce.channelId,needOffline:Ce.needOffline,attachExt:tr,uid:Ce.uid},jr.next=10,this.join(Nr);case 10:case"end":return jr.stop()}},Pt,this)}))},Fe.sendCustomCommand=function(Ce){return Un(this,void 0,void 0,wr.mark(function Pt(){return wr.wrap(function(tr){for(;;)switch(tr.prev=tr.next){case 0:return Qn({channelId:{type:"string",allowEmpty:!1},fromAccid:{type:"string",allowEmpty:!1,required:!1},attachExt:{type:"string",required:!1}},Ce),tr.next=3,this.core.sendCmd("signalingSendCustomCommand",{tag:Lc(Ce)});case 3:case"end":return tr.stop()}},Pt,this)}))},Fe.signalingRecvNotificationHandler=function(Ce){var Pt=typeof Zs(Ce,"raw.r[0]")=="number"?""+Ce.raw.r[0]:void 0;Ce.content.data.msgId=Pt,this.doNotify(Ce.content.data),Pt&&Lo(Pt)&&this.core.sendCmd("signalingBatchMarkRead",{sid:15,cid:11,ids:[Pt]})},Fe.signalingMultiSyncNotificationHandler=function(Ce){this.doNotify(Ce.content.data,hv.kSelfSync)},Fe.doNotify=function(Ce,Pt){Pt===void 0&&(Pt=hv.kDefault);var ar=function(Mn,En){En===void 0&&(En=hv.kDefault);var In=Si(Mb,Mn),Pn=In.attach,Hn=In.time,ho=In.msgId;In.fromAccid,In.toAccid,In.members,In.requestId,In.pushInfo;var uo=Ys(In,["attach","time","msgId","fromAccid","toAccid","members","requestId","pushInfo"]),Do=Pn.type,no=In.ext;return delete In.attach,{metaData:{eventType:Do,channelInfo:uo,feature:En,ext:no,time:Hn,msgId:ho},rawData:In}}(Ce,Pt),tr=ar.metaData,fr=ar.rawData,br=fr.fromAccid,Nr=fr.toAccid,Fr=fr.members,jr=fr.requestId,Vr=fr.pushInfo,Kr=fr.msgId;switch(tr.eventType){case al.kClose:this.emit("signalingClose",{fromAccid:br,metaData:tr});break;case al.kJoin:this.emit("signalingJoin",{member:Fr,metaData:tr});break;case al.kInvite:this.emit("signalingInvite",{fromAccid:br,toAccid:Nr,requestId:jr,pushInfo:Vr,metaData:tr});break;case al.kCancelInvite:this.emit("signalingCancelInvite",{fromAccid:br,toAccid:Nr,requestId:jr,metaData:tr});break;case al.kReject:this.emit("signalingReject",{toAccid:Nr,requestId:jr,metaData:tr});break;case al.kAccept:this.emit("signalingAccept",{toAccid:Nr,requestId:jr,metaData:tr});break;case al.kLeave:this.emit("signalingLeave",{fromAccid:br,metaData:tr});break;case al.kCustom:this.emit("signalingCustomCommand",{fromAccid:br,metaData:tr});break;default:this.logger.warn("signaling:notification, no such a type "+tr.eventType,fr)}return Kr},Fe.signalingSyncNotificationHandler=function(Ce){var Pt,ar,tr=this;if(Ce.content.datas&&Ce.content.datas.length>0){var fr=Is(Pt=Ro(ar=Ce.content.datas).call(ar,function(br){return tr.doNotify(br)})).call(Pt,function(br){return br});fr.length>0&&this.core.sendCmd("signalingBatchMarkRead",{sid:15,cid:11,ids:fr})}},Fe.singalingSyncChannelsHandler=function(Ce){var Pt;if(this.timer=0,this.channels={},Ce.content.datas&&Ce.content.datas.length>0){var ar=Ro(Pt=Ce.content.datas).call(Pt,function(tr){return Tp(tr)});this.emit("singalingSyncChannels",ar)}},Fe.process=function(Ce){var Pt=this[Ce.cmd+"Handler"];return typeof Pt=="function"?(Pt.call(this,Ce),wo.resolve(Ce)):Ce.error&&!Ce.error.ignore?wo.reject(Ce.error):wo.resolve(Ce)},he}(pi.EventEmitter);return ns.setAdapters(xy),ns.registerService(By,"auth"),ns.registerService(Ky,"msg"),ns.registerService(zS,"misc"),ns.registerService(Xy,"user"),ns.registerService(MM,"session"),ns.registerService(FM,"team"),ns.registerService(DM,"systemMessage"),ns.registerService(qM,"friend"),ns.registerService(pe,"event"),ns.registerService(kt,"msgExtend"),ns.registerService($n,"msgLog"),ns.registerService(ao,"passThrough"),ns.registerService(Ho,"cloudStorage"),ns.registerService(rC,"superTeam"),ns.registerService(gf,"sync"),ns.registerService(aC,"plugin"),ns.registerService(uC,"cloudSession"),ns.registerService(fC,"signaling"),ns})})(NIM_BROWSER_SDK);var NIM_BROWSER_SDKExports=NIM_BROWSER_SDK.exports;const NIMSDK=getDefaultExportFromCjs(NIM_BROWSER_SDKExports),elBadge="",elMessage="",_hoisted_1$9={class:"mt10"},_hoisted_2$4={style:{color:"gray","font-size":"small"}},_hoisted_3$4={class:"mt10"},_hoisted_4$3=createBaseVNode("label",null,"当前时间：",-1),_hoisted_5$2={style:{color:"gray"}},_hoisted_6={class:"mt10"},_hoisted_7=createBaseVNode("label",null,"上次启动：",-1),_hoisted_8={style:{color:"gray"}},_hoisted_9={class:"mt10"},_hoisted_10=createBaseVNode("label",null,"运行时长：",-1),_hoisted_11={style:{color:"gray"}},_hoisted_12=createBaseVNode("span",{title:"每分钟更新一次"},"错误日志",-1),_hoisted_13={style:{"margin-top":"-3px"}},_hoisted_14={style:{cursor:"pointer"}},_hoisted_15=["onClick"],_hoisted_16=createBaseVNode("span",{title:"每分钟更新一次"},"数据总览",-1),_hoisted_17=createBaseVNode("label",null,"系统日志",-1),_hoisted_18=createBaseVNode("label",null,"图片信息",-1),_hoisted_19={key:0},_hoisted_20=createBaseVNode("label",null,"插件信息",-1),_hoisted_21=createBaseVNode("span",{title:"实时更新"},"口袋消息",-1),_hoisted_22=["onClick"],_hoisted_23={key:1},_hoisted_24={style:{"margin-top":"-3px"}},_hoisted_25={style:{cursor:"pointer"}},_hoisted_26=["onClick"],_sfc_main$e=defineComponent({__name:"index",props:{enable:{type:Object,default:{bot:!1,qq:!1,wb:!1,bz:!1,kd:!1,xhs:!1,dy:!1,bd:!1}}},setup(t){const r=t,e=ref(),n=ref("点击启动"),g=ref(),y=ref(),i=ref(),k=ref(!1),$=ref("无记录"),L=ref("0小时0分钟"),V=ref(),z=ref(),re=ref({pic:{total:0,today:0,old:0},plugin:{total:0,using:0,unusing:0},log:{total:0,idol:0,other:0}}),ie=ref(),ue=ref(),le=ref(),oe=ref(),ae=ref(),qe=ref("help"),de=async()=>{if(Object.values(r.enable).every(Er=>Er===!1)){ElMessageBox.alert("没有启用任何功能");return}n.value="启动中！",(!oe.value||oe.value<0)&&er(),(!ae.value||ae.value<0)&&or(),ze();let Sr=await startBot();if(Sr.success)ElMessage.success("启动成功"),k.value=!0,n.value="正在运行",$.value=g.value;else{let Er=Sr.msg??"启动失败：未知错误";ElMessage.error(Er),logApi().addSystem(Er),lr(),n.value="点击启动"}r.enable.kd&&(await $e(),Lt())},Ne=()=>{n.value="关闭中！",ElMessageBox.confirm("确定要关闭机器人吗？","温馨提示！",{type:"warning",confirmButtonText:"关闭",cancelButtonText:"我点错了"}).then(async()=>{await startBot(!1),ElMessage.success("关闭成功"),k.value=!1,n.value="点击启动"}).catch(()=>{k.value=!0,n.value="正在运行"})},ze=()=>{ie.value&&ie.value.destroy(),ue.value&&ue.value.destroy(),le.value&&le.value.disconnect()},$e=async()=>{if(ze(),e.value&&e.value.KD)try{ie.value=new NIMSDK({appkey:atob(e.value.KD.appKey),account:e.value.KD.account,token:e.value.KD.token}),await ie.value.connect(),ue.value=new QChatSDK({appkey:atob(e.value.KD.appKey),account:e.value.KD.account,token:e.value.KD.token,linkAddresses:await ie.value.plugin.getQChatAddress({ipType:2})}),ue.value.on("logined",jt),ue.value.on("message",Et),ue.value.on("disconnect",ir),await ue.value.login()}catch(pr){throw pr}},Lt=()=>{le.value=new NimChatroomSocket({liveId:e.value.KD.liveRoomId,onMessage:dr}),le.value.init(e.value.KD.appKey)},jt=async function(){var pr=`口袋已登录。正在进入小偶像${e.value.KD.idolName}的口袋房间。`;if(logApi().addSystem(pr),ue.value==null)throw"进入口袋房间失败，聊天室未成功实例化";if((await ue.value.qchatServer.subscribeAllChannel({type:1,serverIds:[e.value.KD.serverId]})).failServerIds.length){pr=`进入小偶像${e.value.KD.idolName}的口袋房间失败。请检查配置后重试，如仍有问题，请联系开发者。`,logApi().addSystem(pr);return}pr=`成功进入小偶像${e.value.KD.idolName}的口袋房间。`,logApi().addSystem(pr),lr()},Et=async function(pr){var Er,Pr;pr.fromType=1,pr.ext=JSON.parse(pr.ext),pr.channelName=await Dt(pr.channelId),pr.time=dayjs(pr.time).format("YYYY-MM-DD HH:mm:ss"),await postMsg(JSON.stringify(pr));let Sr={type:"text",name:e.value.KD.idolName+`【${pr.channelName}】`,time:pr.time,avatar:pr.ext.avatar??"",color:"#409eff"};pr.type=="text"?Sr.content=pr.body:pr.type=="image"?(Sr.type="pic",Sr.url=(Er=pr==null?void 0:pr.attach)==null?void 0:Er.url):pr.type=="video"||pr.type=="audio"?(Sr.type="link",Sr.url=(Pr=pr==null?void 0:pr.attach)==null?void 0:Pr.url):Sr.content="发送了一条特殊消息！",logApi().add(Sr),lr()},ir=function(...pr){logApi().addSystem("口袋登录连接状态已断开。"),lr()},dr=function(pr,Sr){Sr.forEach(Er=>{postMsg(JSON.stringify(Er),1)})},Dt=async function(pr){if(ue.value==null)return;const Sr=await ue.value.qchatChannel.getChannels({channelIds:[`${pr}`]});return Sr?Sr[0].name:""},lr=()=>{let pr=logApi().getLogs();!pr||pr.length<=0||(z.value=pr.filter(Sr=>Sr.type=="system").splice(-10),!(!r.enable.kd||!e.value||!e.value.KD||!e.value.KD.idolName)&&(pr=pr.filter(Sr=>Sr.name&&Sr.name.includes(e.value.KD.idolName)),V.value=pr.slice(-10)))},sr=(pr,Sr="错误")=>{ElMessageBox.alert(pr,Sr+"详情")},er=()=>{oe.value=setInterval(cr,1e3*60)},cr=async()=>{var Pr,Cr;i.value=(await getLogs()).data;let pr=(await getFun()).data,Sr=await(await getCache()).data;re.value.plugin.total=pr.length,re.value.plugin.unusing=pr.filter(rr=>!rr.status).length,re.value.plugin.using=pr.filter(rr=>rr.status).length,re.value.pic.total=Sr.length,re.value.pic.today=Sr.filter(rr=>new Date(rr.createDate).getDate()===new Date().getDate()).length,re.value.pic.old=re.value.pic.total-re.value.pic.today;let Er=logApi().getLogs();Er&&(re.value.log.total=Er.length??0,(Cr=(Pr=e.value)==null?void 0:Pr.KD)!=null&&Cr.idolName&&(re.value.log.idol=Er.filter(rr=>{var kr;return(kr=rr.name)==null?void 0:kr.includes(e.value.KD.idolName)}).length),re.value.log.other=re.value.log.total-re.value.log.idol)},or=()=>{ae.value=setInterval(hr,1e3)},hr=()=>{var pr=new Date,Sr=pr.getHours();if(g.value=pr.toLocaleString(),Sr>=0&&Sr<6&&(y.value="凌晨好"),Sr>=6&&Sr<11&&(y.value="早上好"),Sr>=11&&Sr<14&&(y.value="中午好"),Sr>=14&&Sr<17&&(y.value="下午好"),Sr>=17&&Sr<19&&(y.value="傍晚好"),Sr>=19&&Sr<0&&(y.value="晚上好"),$.value=="无记录")L.value="0小时0分钟";else{let rr=new Date($.value);var Er=pr.getTime()-rr.getTime(),Pr=Math.floor(Er/(1e3*60*60)),Cr=Math.floor(Er%(1e3*60*60)/(1e3*60));L.value=`${Pr}小时${Cr}分钟`}};return onMounted(async()=>{let pr=await getConfig();e.value=pr.data,cr(),hr(),or(),lr()}),(pr,Sr)=>{const Er=ElCol,Pr=ElRow,Cr=ElCard,rr=ElIcon,kr=ElScrollbar,Ir=ElDivider;return openBlock(),createBlock(kr,{style:{height:"calc(100vh - 30px)"}},{default:withCtx(()=>[createVNode(Pr,null,{default:withCtx(()=>[createVNode(Er,{span:12},{default:withCtx(()=>[createVNode(Cr,{shadow:"hover",class:"ch250"},{header:withCtx(()=>[createTextVNode(" StarBot ")]),default:withCtx(()=>[createVNode(Pr,null,{default:withCtx(()=>[createVNode(Er,{span:6},{default:withCtx(()=>[k.value?(openBlock(),createElementBlock("img",{key:0,title:"点击关闭",onClick:Ne,src:_imports_0,style:{width:"100px",height:"100px",cursor:"pointer","margin-left":"-17px"}})):(openBlock(),createElementBlock("img",{key:1,title:"点击启动",onClick:de,src:_imports_1,style:{width:"100px",height:"100px",cursor:"pointer","margin-left":"-17px"}})),createBaseVNode("div",{style:normalizeStyle({color:k.value?"green":n.value.includes("启动中")?"red":"blue"})},[createBaseVNode("span",null,toDisplayString(n.value),1)],4)]),_:1}),createVNode(Er,{span:18},{default:withCtx(()=>[createBaseVNode("div",_hoisted_1$9,[createBaseVNode("span",_hoisted_2$4,toDisplayString(y.value)+"！生活变的再糟糕，也不妨碍我变得更好！",1)]),createBaseVNode("div",_hoisted_3$4,[_hoisted_4$3,createBaseVNode("span",_hoisted_5$2,toDisplayString(g.value),1)]),createBaseVNode("div",_hoisted_6,[_hoisted_7,createBaseVNode("span",_hoisted_8,toDisplayString($.value),1)]),createBaseVNode("div",_hoisted_9,[_hoisted_10,createBaseVNode("span",_hoisted_11,toDisplayString(k.value?"已运行"+L.value:"未启动"),1)])]),_:1})]),_:1})]),_:1})]),_:1}),createVNode(Er,{span:1}),createVNode(Er,{span:11},{default:withCtx(()=>[createVNode(Cr,{shadow:"hover",class:"ch250"},{header:withCtx(()=>[createVNode(Pr,null,{default:withCtx(()=>[createVNode(Er,null,{default:withCtx(()=>[_hoisted_12,createVNode(rr,{size:18},{default:withCtx(()=>[createVNode(unref(refresh_default),{class:"et5",onClick:Sr[0]||(Sr[0]=async()=>i.value=(await unref(getLogs)()).data)})]),_:1})]),_:1})]),_:1})]),default:withCtx(()=>[createVNode(kr,{height:"180px",style:{"margin-top":"-10px"}},{default:withCtx(()=>[createBaseVNode("ul",_hoisted_13,[(openBlock(!0),createElementBlock(Fragment,null,renderList(i.value,xr=>(openBlock(),createElementBlock("li",_hoisted_14,[createBaseVNode("span",{onClick:vr=>sr(xr.content),title:"点击查看"},toDisplayString(xr.content.substring(0,20))+"--"+toDisplayString(xr.time),9,_hoisted_15)]))),256))])]),_:1})]),_:1})]),_:1})]),_:1}),createVNode(Pr,{style:{"margin-top":"20px"}},{default:withCtx(()=>[createVNode(Er,{span:24},{default:withCtx(()=>[createVNode(Cr,{shadow:"hover",header:"快速预览",class:"chauto"},{default:withCtx(()=>[createVNode(Pr,{gutter:15},{default:withCtx(()=>[createVNode(Er,{span:8},{default:withCtx(()=>[createVNode(Cr,{shadow:"hover",class:"ch320"},{header:withCtx(()=>[_hoisted_16]),default:withCtx(()=>[createBaseVNode("div",null,[_hoisted_17,createBaseVNode("div",null,[createBaseVNode("span",null,"全部:"+toDisplayString(re.value.log.total),1),createVNode(Ir,{direction:"vertical"}),createBaseVNode("span",null,"主要:"+toDisplayString(re.value.log.idol),1),createVNode(Ir,{direction:"vertical"}),createBaseVNode("span",null,"其他:"+toDisplayString(re.value.log.other),1)])]),createVNode(Ir),createBaseVNode("div",null,[_hoisted_18,createBaseVNode("div",null,[createBaseVNode("span",null,"全部:"+toDisplayString(re.value.pic.total),1),createVNode(Ir,{direction:"vertical"}),createBaseVNode("span",null,"今日:"+toDisplayString(re.value.pic.today),1),createVNode(Ir,{direction:"vertical"}),createBaseVNode("span",null,"更早:"+toDisplayString(re.value.pic.old),1)])]),createVNode(Ir),t.enable.bot?(openBlock(),createElementBlock("div",_hoisted_19,[_hoisted_20,createBaseVNode("div",null,[createBaseVNode("span",null,"全部:"+toDisplayString(re.value.plugin.total),1),createVNode(Ir,{direction:"vertical"}),createBaseVNode("span",null,"启用:"+toDisplayString(re.value.plugin.using),1),createVNode(Ir,{direction:"vertical"}),createBaseVNode("span",null,"启用:"+toDisplayString(re.value.plugin.unusing),1)])])):createCommentVNode("",!0)]),_:1})]),_:1}),t.enable.kd?(openBlock(),createBlock(Er,{key:0,span:8},{default:withCtx(()=>[createVNode(Cr,{shadow:"hover",class:"ch320"},{header:withCtx(()=>[_hoisted_21]),default:withCtx(()=>[createBaseVNode("div",null,[createBaseVNode("ul",null,[(openBlock(!0),createElementBlock(Fragment,null,renderList(V.value,xr=>{var vr;return openBlock(),createElementBlock("li",null,[xr.type=="text"?(openBlock(),createElementBlock("span",{key:0,onClick:_r=>sr(xr.name+":"+xr.content+"--"+xr.time,"口袋消息"),title:"点击查看"},toDisplayString(xr.name+":"+((vr=xr.content)==null?void 0:vr.substring(0,20)))+"--"+toDisplayString(xr.time),9,_hoisted_22)):createCommentVNode("",!0),xr.type=="pic"||xr.type=="link"?(openBlock(),createElementBlock("span",_hoisted_23,toDisplayString(xr.url),1)):createCommentVNode("",!0)])}),256))])])]),_:1})]),_:1})):createCommentVNode("",!0),withDirectives(createVNode(Er,{span:8},{default:withCtx(()=>[createVNode(Cr,{shadow:"hover",class:"ch320"},{header:withCtx(()=>[createTextVNode("帮助反馈 "),createVNode(rr,{size:16},{default:withCtx(()=>[createVNode(unref(switch_default),{class:"et2",circle:"",onClick:Sr[1]||(Sr[1]=()=>qe.value="log")})]),_:1})]),_:1})]),_:1},512),[[vShow,qe.value=="help"]]),withDirectives(createVNode(Er,{span:8},{default:withCtx(()=>[createVNode(Cr,{shadow:"hover",class:"ch320"},{header:withCtx(()=>[createTextVNode("本地日志 "),createVNode(rr,{size:16},{default:withCtx(()=>[createVNode(unref(switch_default),{class:"et2",circle:"",onClick:Sr[2]||(Sr[2]=()=>qe.value="help")})]),_:1})]),default:withCtx(()=>[createVNode(kr,{height:"250px",style:{"margin-top":"-10px"}},{default:withCtx(()=>[createBaseVNode("ul",_hoisted_24,[(openBlock(!0),createElementBlock(Fragment,null,renderList(z.value,xr=>{var vr;return openBlock(),createElementBlock("li",_hoisted_25,[createBaseVNode("span",{onClick:_r=>sr(xr.content??"","日志"),title:"点击查看"},toDisplayString((vr=xr.content)==null?void 0:vr.substring(0,20))+"--"+toDisplayString(xr.time),9,_hoisted_26)])}),256))])]),_:1})]),_:1})]),_:1},512),[[vShow,qe.value=="log"]])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})}}}),index_vue_vue_type_style_index_0_lang="",elAffix="",elButton="",elForm="",elFormItem="",elCheckbox="",_sfc_main$d=defineComponent({__name:"enable",props:{enable:{type:Object,default:{qq:!1,wb:!1,bz:!1,kd:!1,xhs:!1,dy:!1,bd:!1}}},emits:["enable-change"],setup(t,{emit:r}){var n=toRef(t.enable);const g=r;watch(n.value,()=>{g("enable-change",n.value)});const y=i=>{n.value.qq=i};return(i,k)=>{const $=ElCheckbox,L=ElFormItem,V=ElForm;return openBlock(),createBlock(V,{ref:"bdform","label-width":"150px","label-position":"left"},{default:withCtx(()=>[createVNode(L,{label:"启用模块："},{default:withCtx(()=>[createVNode($,{modelValue:unref(n).bot,"onUpdate:modelValue":k[0]||(k[0]=z=>unref(n).bot=z),label:"QQ&Bot",onChange:y},null,8,["modelValue"]),createVNode($,{modelValue:unref(n).wb,"onUpdate:modelValue":k[1]||(k[1]=z=>unref(n).wb=z),label:"微博"},null,8,["modelValue"]),createVNode($,{modelValue:unref(n).bz,"onUpdate:modelValue":k[2]||(k[2]=z=>unref(n).bz=z),label:"B站"},null,8,["modelValue"]),createVNode($,{modelValue:unref(n).kd,"onUpdate:modelValue":k[3]||(k[3]=z=>unref(n).kd=z),label:"口袋48"},null,8,["modelValue"]),createVNode($,{modelValue:unref(n).xhs,"onUpdate:modelValue":k[4]||(k[4]=z=>unref(n).xhs=z),label:"小红书"},null,8,["modelValue"]),createVNode($,{modelValue:unref(n).bd,"onUpdate:modelValue":k[5]||(k[5]=z=>unref(n).bd=z),label:"百度"},null,8,["modelValue"]),createVNode($,{modelValue:unref(n).dy,"onUpdate:modelValue":k[6]||(k[6]=z=>unref(n).dy=z),label:"抖音"},null,8,["modelValue"])]),_:1})]),_:1},512)}}}),elInput="",_hoisted_1$8=createBaseVNode("span",{id:"bot"},"机器人",-1),_sfc_main$c=defineComponent({__name:"bot",props:{bot:{type:Object,default:{host:"",websocktPort:"",httpPort:"",token:""}}},setup(t,{expose:r}){const e=ref(),n=ref({common:[{required:!0,message:"请输入该值",trigger:"blur"}],websocktPort:[{required:!0,message:"请输入该值",trigger:"blur"}],httpPort:[{required:!0,message:"请输入该值",trigger:"blur"}]});return r({validForm:async()=>{var y;return await((y=e.value)==null?void 0:y.validate(i=>!!i))}}),(y,i)=>{const k=ElInput,$=ElFormItem,L=ElForm,V=ElCard;return openBlock(),createBlock(V,{class:"card-bot"},{header:withCtx(()=>[_hoisted_1$8]),default:withCtx(()=>[createVNode(L,{ref_key:"botform",ref:e,rules:n.value,model:t.bot,"label-width":"150px","label-position":"left"},{default:withCtx(()=>[createVNode($,{label:"IP地址",prop:"host"},{default:withCtx(()=>[createVNode(k,{modelValue:t.bot.host,"onUpdate:modelValue":i[0]||(i[0]=z=>t.bot.host=z)},null,8,["modelValue"])]),_:1}),createVNode($,{label:"WebScoket端口",prop:"websocktPort"},{default:withCtx(()=>[createVNode(k,{modelValue:t.bot.websocktPort,"onUpdate:modelValue":i[1]||(i[1]=z=>t.bot.websocktPort=z)},null,8,["modelValue"])]),_:1}),createVNode($,{label:"Http端口",prop:"httpPort"},{default:withCtx(()=>[createVNode(k,{modelValue:t.bot.httpPort,"onUpdate:modelValue":i[2]||(i[2]=z=>t.bot.httpPort=z)},null,8,["modelValue"])]),_:1}),createVNode($,{label:"token"},{default:withCtx(()=>[createVNode(k,{modelValue:t.bot.token,"onUpdate:modelValue":i[3]||(i[3]=z=>t.bot.token=z)},null,8,["modelValue"])]),_:1})]),_:1},8,["rules","model"])]),_:1})}}}),elSwitch="",_hoisted_1$7=createBaseVNode("span",{id:"qq"},"QQ",-1),_sfc_main$b=defineComponent({__name:"qq",props:{qq:{type:Object,default:{funcAdmin:new Array,group:"",save:!1,admin:"",notice:!1,permission:"",debug:!1}}},setup(t,{expose:r}){const e=ref(),n=ref({admin:[{required:!0,message:"请输入该值",trigger:"blur"}]});return r({validForm:async()=>{var y;return await((y=e.value)==null?void 0:y.validate(i=>!!i))}}),(y,i)=>{const k=ElInput,$=ElFormItem,L=ElSwitch,V=ElForm,z=ElCard;return openBlock(),createBlock(z,{class:"card-qq"},{header:withCtx(()=>[_hoisted_1$7]),default:withCtx(()=>[createVNode(V,{ref_key:"qqform",ref:e,model:t.qq,rules:n.value,"label-width":"150px","label-position":"left"},{default:withCtx(()=>[createVNode($,{label:"超管",prop:"admin"},{default:withCtx(()=>[createVNode(k,{modelValue:t.qq.admin,"onUpdate:modelValue":i[0]||(i[0]=re=>t.qq.admin=re)},null,8,["modelValue"])]),_:1}),createVNode($,{label:"管理员",prop:"permission"},{default:withCtx(()=>[createVNode(k,{modelValue:t.qq.permission,"onUpdate:modelValue":i[1]||(i[1]=re=>t.qq.permission=re)},null,8,["modelValue"])]),_:1}),createVNode($,{label:"群",prop:"group"},{default:withCtx(()=>[createVNode(k,{modelValue:t.qq.group,"onUpdate:modelValue":i[2]||(i[2]=re=>t.qq.group=re)},null,8,["modelValue"])]),_:1}),createVNode($,{label:"程序错误通知"},{default:withCtx(()=>[createVNode(L,{modelValue:t.qq.debug,"onUpdate:modelValue":i[3]||(i[3]=re=>t.qq.debug=re),"active-text":"启用","inactive-text":"禁用"},null,8,["modelValue"])]),_:1}),createVNode($,{label:"新动态消息通知"},{default:withCtx(()=>[createVNode(L,{modelValue:t.qq.notice,"onUpdate:modelValue":i[4]||(i[4]=re=>t.qq.notice=re),"active-text":"启用","inactive-text":"禁用"},null,8,["modelValue"])]),_:1}),createVNode($,{label:"保存群消息"},{default:withCtx(()=>[createVNode(L,{modelValue:t.qq.save,"onUpdate:modelValue":i[5]||(i[5]=re=>t.qq.save=re),"active-text":"保存","inactive-text":"不保存"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1})}}}),elInputNumber="",_hoisted_1$6=createBaseVNode("span",{id:"wb"},"微博",-1),_hoisted_2$3=createBaseVNode("span",{style:{color:"red"}},"用于转发动态和图片保存，一般是填idol",-1),_hoisted_3$3=createBaseVNode("span",{style:{color:"red"}},"仅用于图片保存，一般是填返图用户",-1),_hoisted_4$2=createBaseVNode("span",{style:{color:"red"}},"监听某些用户是否发送了包含关键词的动态",-1),_sfc_main$a=defineComponent({__name:"wb",props:{wb:{type:Object,default:{userAll:"",userPart:"",chiGuaUser:"",keyword:"",chiGuaQQ:"",chiGuaForwardQQ:!1,chiGuaGroup:"",chiGuaForwardGroup:!1,timeSpan:3,group:"",forwardGroup:!1,forwardQQ:!1,qq:""}}},setup(t,{expose:r}){const e=ref(),n=ref({userAll:[{required:!0,message:"请输入该值",trigger:"blur"}]});return r({validForm:async()=>{var y;return await((y=e.value)==null?void 0:y.validate(i=>!!i))}}),(y,i)=>{const k=ElInput,$=ElFormItem,L=ElSwitch,V=ElInputNumber,z=ElForm,re=ElCard;return openBlock(),createBlock(re,{class:"card-wb"},{header:withCtx(()=>[_hoisted_1$6]),default:withCtx(()=>[createVNode(z,{ref_key:"wbform",ref:e,model:t.wb,rules:n.value,"label-width":"150px","label-position":"left"},{default:withCtx(()=>[createVNode($,{label:"微博用户",prop:"userAll"},{default:withCtx(()=>[createVNode(k,{modelValue:t.wb.userAll,"onUpdate:modelValue":i[0]||(i[0]=ie=>t.wb.userAll=ie)},null,8,["modelValue"]),_hoisted_2$3]),_:1}),createVNode($,{label:"返图用户"},{default:withCtx(()=>[createVNode(k,{modelValue:t.wb.userPart,"onUpdate:modelValue":i[1]||(i[1]=ie=>t.wb.userPart=ie)},null,8,["modelValue"]),_hoisted_3$3]),_:1}),createVNode($,{label:"转发至群"},{default:withCtx(()=>[createVNode(L,{modelValue:t.wb.forwardGroup,"onUpdate:modelValue":i[2]||(i[2]=ie=>t.wb.forwardGroup=ie),"active-text":"转发","inactive-text":"不转发"},null,8,["modelValue"])]),_:1}),t.wb.forwardGroup?(openBlock(),createBlock($,{key:0,label:"群qq号"},{default:withCtx(()=>[createVNode(k,{modelValue:t.wb.group,"onUpdate:modelValue":i[3]||(i[3]=ie=>t.wb.group=ie)},null,8,["modelValue"])]),_:1})):createCommentVNode("",!0),createVNode($,{label:"转发至好友"},{default:withCtx(()=>[createVNode(L,{modelValue:t.wb.forwardQQ,"onUpdate:modelValue":i[4]||(i[4]=ie=>t.wb.forwardQQ=ie),"active-text":"转发","inactive-text":"不转发"},null,8,["modelValue"])]),_:1}),t.wb.forwardQQ?(openBlock(),createBlock($,{key:1,label:"好友qq"},{default:withCtx(()=>[createVNode(k,{modelValue:t.wb.qq,"onUpdate:modelValue":i[5]||(i[5]=ie=>t.wb.qq=ie)},null,8,["modelValue"])]),_:1})):createCommentVNode("",!0),createVNode($,{label:"吃瓜用户"},{default:withCtx(()=>[createVNode(k,{modelValue:t.wb.chiGuaUser,"onUpdate:modelValue":i[6]||(i[6]=ie=>t.wb.chiGuaUser=ie)},null,8,["modelValue"]),_hoisted_4$2]),_:1}),createVNode($,{label:"关键词"},{default:withCtx(()=>[createVNode(k,{modelValue:t.wb.keyword,"onUpdate:modelValue":i[7]||(i[7]=ie=>t.wb.keyword=ie)},null,8,["modelValue"])]),_:1}),createVNode($,{label:"转发至群"},{default:withCtx(()=>[createVNode(L,{modelValue:t.wb.chiGuaForwardGroup,"onUpdate:modelValue":i[8]||(i[8]=ie=>t.wb.chiGuaForwardGroup=ie),"active-text":"转发","inactive-text":"不转发"},null,8,["modelValue"])]),_:1}),t.wb.chiGuaForwardGroup?(openBlock(),createBlock($,{key:2,label:"群qq号"},{default:withCtx(()=>[createVNode(k,{modelValue:t.wb.chiGuaGroup,"onUpdate:modelValue":i[9]||(i[9]=ie=>t.wb.chiGuaGroup=ie)},null,8,["modelValue"])]),_:1})):createCommentVNode("",!0),createVNode($,{label:"转发至好友"},{default:withCtx(()=>[createVNode(L,{modelValue:t.wb.chiGuaForwardQQ,"onUpdate:modelValue":i[10]||(i[10]=ie=>t.wb.chiGuaForwardQQ=ie),"active-text":"转发","inactive-text":"不转发"},null,8,["modelValue"])]),_:1}),t.wb.chiGuaForwardQQ?(openBlock(),createBlock($,{key:3,label:"好友qq"},{default:withCtx(()=>[createVNode(k,{modelValue:t.wb.chiGuaQQ,"onUpdate:modelValue":i[11]||(i[11]=ie=>t.wb.chiGuaQQ=ie)},null,8,["modelValue"])]),_:1})):createCommentVNode("",!0),t.wb.forwardQQ||t.wb.forwardGroup||t.wb.chiGuaForwardGroup||t.wb.chiGuaForwardQQ?(openBlock(),createBlock($,{key:4,label:"监听间隔"},{default:withCtx(()=>[createVNode(V,{modelValue:t.wb.timeSpan,"onUpdate:modelValue":i[12]||(i[12]=ie=>t.wb.timeSpan=ie)},null,8,["modelValue"])]),_:1})):createCommentVNode("",!0)]),_:1},8,["model","rules"])]),_:1})}}}),elCascader="",elTag="",elCascaderPanel="",elRadio="",elDialog="",elOverlay="",elCheckboxGroup="",elRadioGroup="",_hoisted_1$5=createBaseVNode("span",{id:"kd"},"口袋48",-1),_hoisted_2$2=createBaseVNode("span",{style:{color:"red"}},"*以上信息可通过查询获取",-1),_hoisted_3$2=createBaseVNode("span",{style:{color:"red"}},"*IM账号和IMtoken可点此登录口袋后自动获取",-1),_hoisted_4$1={key:0,style:{width:"95%","margin-top":"5px"}},_hoisted_5$1=createBaseVNode("span",null,"未查询到小偶像，检查名称等后重新查询或者点击下方地址自行获取小偶像信息填入：",-1),_sfc_main$9=defineComponent({__name:"kd",props:{kd:{type:Object,default:{group:"",forwardGroup:!1,forwardQQ:!1,qq:"",idolName:"",account:"",token:"",serverId:"",liveRoomId:"",msgTypeAll:new Array,msgType:[],saveMsg:0,saveImg:!1}}},setup(t,{expose:r}){const e=t,n=ref(),g=ref({idolName:[{required:!0,message:"请输入该值",trigger:"blur"}],serverId:[{required:!0,message:"请输入该值",trigger:"blur"}],liveRoomId:[{required:!0,message:"请输入该值",trigger:"blur"}],account:[{required:!0,message:"请输入该值",trigger:"blur"}],token:[{required:!0,message:"请输入该值",trigger:"blur"}],phone:[{required:!0,message:"请输入该值",trigger:"blur"}],code:[{required:!0,message:"请输入该值",trigger:"blur"}],name:[{required:!0,message:"请输入该值",trigger:"blur"}]}),y=ref(!1),i=ref({show:!1,group:[],name:"",loading:!1,url:""}),k=ref({phone:"",area:"86",hasSend:!1,code:"",sec:60}),$=ref([{label:"SNH48",value:"SNH48",children:[{value:"TEAM SII",label:"TEAM SII"},{value:"TEAM HII",label:"TEAM HII"},{value:"TEAM X",label:"TEAM X"}]},{label:"GNZ48",value:"GNZ48",children:[{value:"TEAM G",label:"TEAM G"},{value:"TEAM NIII",label:"TEAM NIII"},{value:"TEAM Z",label:"TEAM Z"},{value:"TEAM CII",label:"TEAM CII"}]},{label:"CGT48",value:"CGT48",children:[{value:"TEAM GII",label:"TEAM GII"}]},{label:"BEJ48",value:"BEJ48",children:[{value:"TEAM B",label:"TEAM B"},{value:"TEAM E",label:"TEAM E"}]},{label:"CKG48",value:"CKG48"}]),L=async()=>{if(!i.value.name){ElMessage({message:"请输入小偶像姓名",type:"error"});return}i.value.loading=!0;var oe=await searchIdol(i.value.group.toString(),i.value.name);if(oe.success){var ae=oe.data;e.kd.idolName=ae.name,e.kd.liveRoomId=ae.liveId,e.kd.serverId=ae.serverId,V()}else i.value.url=oe.msg||"";i.value.loading=!1},V=()=>{i.value.loading=!1,i.value.show=!1,i.value.name="",i.value.url="",i.value.group=[],y.value=!1,k.value.hasSend=!1,k.value.sec=60},z=async()=>{if(!k.value.phone){ElMessage({message:"请输入手机号码！",type:"warning"});return}var oe=/^1[3456789]\d{9}$/;if(oe.test(k.value.phone)==!1){ElMessage({message:"手机号码格式有误，请重新输入！",type:"warning"});return}k.value.hasSend=!0,ie();var ae=await sendSmsCode(k.value.phone,k.value.area);ae.success?ElMessage({message:"发送成功，请注意查收！",type:"success"}):ElMessage({message:ae.msg??"发送失败！",type:"error"})},re=async()=>{if(!k.value.phone){ElMessage({message:"请输入手机号码！",type:"warning"});return}if(!k.value.code){ElMessage({message:"请输入验证码！",type:"warning"});return}var oe=/^1[3456789]\d{9}$/;if(oe.test(k.value.phone)==!1){ElMessage({message:"手机号码格式有误，请重新输入！",type:"warning"});return}var ae=await pocketLogin(k.value.phone,k.value.code);if(ae.success){var qe=await kdUserInfo({token:ae.data.content.token});qe.success?(e.kd.token=qe.data.content.pwd,e.kd.account=qe.data.content.accid,setTimeout(()=>{V()},1e3),ElMessage({message:qe.msg??"登录成功",type:"success"})):ElMessage({message:qe.msg??"登录失败！",type:"error"})}else ElMessage({message:ae.msg??"登录失败！",type:"error"})},ie=()=>{k.value.sec=60;let oe;oe=setInterval(()=>{k.value.sec>0?k.value.sec--:(clearInterval(oe),k.value.sec=60,k.value.hasSend=!1)},1e3)},ue=async()=>{var oe;return await((oe=n.value)==null?void 0:oe.validate(ae=>!!ae))},le=oe=>{openWindow(oe)};return r({validForm:ue}),(oe,ae)=>{const qe=ElInput,de=ElFormItem,Ne=ElButton,ze=ElRadio,$e=ElRadioGroup,Lt=ElCheckbox,jt=ElCheckboxGroup$1,Et=ElSwitch,ir=ElForm,dr=ElDialog,Dt=ElCascader,lr=ElCard;return openBlock(),createBlock(lr,{class:"card-kd"},{header:withCtx(()=>[_hoisted_1$5]),default:withCtx(()=>[createVNode(ir,{ref_key:"kdform",ref:n,rules:g.value,model:t.kd,"label-width":"150px","label-position":"left"},{default:withCtx(()=>[createVNode(de,{label:"姓名",prop:"idolName"},{default:withCtx(()=>[createVNode(qe,{modelValue:t.kd.idolName,"onUpdate:modelValue":ae[0]||(ae[0]=sr=>t.kd.idolName=sr)},null,8,["modelValue"])]),_:1}),createVNode(de,{label:"IMServerId",prop:"serverId"},{default:withCtx(()=>[createVNode(qe,{modelValue:t.kd.serverId,"onUpdate:modelValue":ae[1]||(ae[1]=sr=>t.kd.serverId=sr)},null,8,["modelValue"])]),_:1}),createVNode(de,{label:"直播房间Id",prop:"liveRoomId"},{default:withCtx(()=>[createVNode(qe,{modelValue:t.kd.liveRoomId,"onUpdate:modelValue":ae[2]||(ae[2]=sr=>t.kd.liveRoomId=sr)},null,8,["modelValue"])]),_:1}),createVNode(de,null,{default:withCtx(()=>[createVNode(Ne,{onClick:ae[3]||(ae[3]=sr=>i.value.show=!0)},{default:withCtx(()=>[createTextVNode("查询小偶像信息")]),_:1}),_hoisted_2$2]),_:1}),createVNode(de,{label:"IM账号",prop:"account"},{default:withCtx(()=>[createVNode(qe,{modelValue:t.kd.account,"onUpdate:modelValue":ae[4]||(ae[4]=sr=>t.kd.account=sr)},null,8,["modelValue"])]),_:1}),createVNode(de,{label:"IMtoken",prop:"token"},{default:withCtx(()=>[createVNode(qe,{modelValue:t.kd.token,"onUpdate:modelValue":ae[5]||(ae[5]=sr=>t.kd.token=sr)},null,8,["modelValue"])]),_:1}),createVNode(de,null,{default:withCtx(()=>[createVNode(Ne,{onClick:ae[6]||(ae[6]=sr=>y.value=!0)},{default:withCtx(()=>[createTextVNode("登录口袋48")]),_:1}),_hoisted_3$2]),_:1}),createVNode(de,{label:"保存消息"},{default:withCtx(()=>[createVNode($e,{modelValue:t.kd.saveMsg,"onUpdate:modelValue":ae[7]||(ae[7]=sr=>t.kd.saveMsg=sr)},{default:withCtx(()=>[createVNode(ze,{label:0,value:0},{default:withCtx(()=>[createTextVNode("不保存")]),_:1}),createVNode(ze,{label:1,value:1},{default:withCtx(()=>[createTextVNode("仅小偶像")]),_:1}),createVNode(ze,{label:2,value:2},{default:withCtx(()=>[createTextVNode("全部")]),_:1})]),_:1},8,["modelValue"])]),_:1}),createVNode(de,{label:"保存小偶像图片"},{default:withCtx(()=>[createVNode($e,{modelValue:t.kd.saveImg,"onUpdate:modelValue":ae[8]||(ae[8]=sr=>t.kd.saveImg=sr)},{default:withCtx(()=>[createVNode(ze,{label:!1,value:!1},{default:withCtx(()=>[createTextVNode("不保存")]),_:1}),createVNode(ze,{label:!0,value:!0},{default:withCtx(()=>[createTextVNode("保存")]),_:1})]),_:1},8,["modelValue"])]),_:1}),createVNode(de,{label:"监听消息类型"},{default:withCtx(()=>[createVNode(jt,{modelValue:t.kd.msgType,"onUpdate:modelValue":ae[9]||(ae[9]=sr=>t.kd.msgType=sr)},{default:withCtx(()=>[(openBlock(!0),createElementBlock(Fragment,null,renderList(t.kd.msgTypeAll,(sr,er)=>(openBlock(),createBlock(Lt,{label:sr.value,key:er},{default:withCtx(()=>[createTextVNode(toDisplayString(sr.name),1)]),_:2},1032,["label"]))),128))]),_:1},8,["modelValue"])]),_:1}),createVNode(de,{label:"转发至群"},{default:withCtx(()=>[createVNode(Et,{modelValue:t.kd.forwardGroup,"onUpdate:modelValue":ae[10]||(ae[10]=sr=>t.kd.forwardGroup=sr),"active-text":"转发","inactive-text":"不转发"},null,8,["modelValue"])]),_:1}),t.kd.forwardGroup?(openBlock(),createBlock(de,{key:0,label:"群qq号"},{default:withCtx(()=>[createVNode(qe,{modelValue:t.kd.group,"onUpdate:modelValue":ae[11]||(ae[11]=sr=>t.kd.group=sr)},null,8,["modelValue"])]),_:1})):createCommentVNode("",!0),createVNode(de,{label:"转发至好友"},{default:withCtx(()=>[createVNode(Et,{modelValue:t.kd.forwardQQ,"onUpdate:modelValue":ae[12]||(ae[12]=sr=>t.kd.forwardQQ=sr),"active-text":"转发","inactive-text":"不转发"},null,8,["modelValue"])]),_:1}),t.kd.forwardQQ?(openBlock(),createBlock(de,{key:1,label:"好友qq"},{default:withCtx(()=>[createVNode(qe,{modelValue:t.kd.qq,"onUpdate:modelValue":ae[13]||(ae[13]=sr=>t.kd.qq=sr)},null,8,["modelValue"])]),_:1})):createCommentVNode("",!0)]),_:1},8,["rules","model"]),createVNode(dr,{title:"登录口袋48",modelValue:y.value,"onUpdate:modelValue":ae[16]||(ae[16]=sr=>y.value=sr),"before-close":V,"close-on-click-modal":!1},{default:withCtx(()=>[createVNode(ir,{"label-width":"100px",rules:g.value,model:k.value},{default:withCtx(()=>[createVNode(de,{label:"手机号",class:"mt-4",prop:"phone"},{default:withCtx(()=>[createVNode(qe,{modelValue:k.value.phone,"onUpdate:modelValue":ae[14]||(ae[14]=sr=>k.value.phone=sr),style:{width:"95%"}},{prepend:withCtx(()=>[createTextVNode("+"+toDisplayString(k.value.area),1)]),_:1},8,["modelValue"])]),_:1}),createVNode(de,{label:"验证码",prop:"code"},{default:withCtx(()=>[createVNode(qe,{type:"primary",modelValue:k.value.code,"onUpdate:modelValue":ae[15]||(ae[15]=sr=>k.value.code=sr),style:{width:"65%"}},null,8,["modelValue"]),withDirectives(createVNode(Ne,{style:{width:"25%","margin-left":"5%"},onClick:z},{default:withCtx(()=>[createTextVNode("发送验证码")]),_:1},512),[[vShow,!k.value.hasSend]]),withDirectives(createVNode(Ne,{style:{width:"25%","margin-left":"5%"}},{default:withCtx(()=>[createTextVNode(toDisplayString(k.value.sec)+"秒",1)]),_:1},512),[[vShow,k.value.hasSend]])]),_:1}),createVNode(de,null,{default:withCtx(()=>[createVNode(Ne,{type:"primary",onClick:re},{default:withCtx(()=>[createTextVNode("登录")]),_:1})]),_:1})]),_:1},8,["rules","model"])]),_:1},8,["modelValue"]),createVNode(dr,{title:"查询小偶像 ",modelValue:i.value.show,"onUpdate:modelValue":ae[20]||(ae[20]=sr=>i.value.show=sr),"before-close":V,"close-on-click-modal":!1},{default:withCtx(()=>[createVNode(ir,{"label-width":"100px",rules:g.value,model:i.value},{default:withCtx(()=>[createVNode(de,{label:"队伍",class:"mt-4"},{default:withCtx(()=>[createVNode(Dt,{props:{expandTrigger:"hover",checkStrictly:"true"},placeholder:"请选择",modelValue:i.value.group,"onUpdate:modelValue":ae[17]||(ae[17]=sr=>i.value.group=sr),options:$.value,style:{width:"95%"}},null,8,["modelValue","options"])]),_:1}),createVNode(de,{label:"姓名",prop:"name"},{default:withCtx(()=>[createVNode(qe,{modelValue:i.value.name,"onUpdate:modelValue":ae[18]||(ae[18]=sr=>i.value.name=sr),style:{width:"95%"}},null,8,["modelValue"])]),_:1}),createVNode(de,null,{default:withCtx(()=>[createVNode(Ne,{type:"primary",loading:i.value.loading,onClick:L},{default:withCtx(()=>[createTextVNode("查询")]),_:1},8,["loading"])]),_:1}),i.value.url?(openBlock(),createElementBlock("div",_hoisted_4$1,[_hoisted_5$1,createBaseVNode("a",{style:{"word-break":"break-all"},onClick:ae[19]||(ae[19]=sr=>le(i.value.url))},toDisplayString(i.value.url),1)])):createCommentVNode("",!0)]),_:1},8,["rules","model"])]),_:1},8,["modelValue"])]),_:1})}}}),_hoisted_1$4=createBaseVNode("span",{id:"bz"},"b站",-1),_sfc_main$8=defineComponent({__name:"bz",props:{bz:{type:Object,default:{user:"",group:"",forwardGroup:!1,forwardQQ:!1,qq:"",timeSpan:3}}},setup(t,{expose:r}){const e=ref(),n=ref({user:[{required:!0,message:"请输入该值",trigger:"blur"}]});return r({validForm:async()=>{var y;return await((y=e.value)==null?void 0:y.validate(i=>!!i))}}),(y,i)=>{const k=ElInput,$=ElFormItem,L=ElSwitch,V=ElInputNumber,z=ElForm,re=ElCard;return openBlock(),createBlock(re,{class:"card-bz"},{header:withCtx(()=>[_hoisted_1$4]),default:withCtx(()=>[createVNode(z,{ref_key:"bzform",ref:e,model:t.bz,rules:n.value,"label-width":"150px","label-position":"left"},{default:withCtx(()=>[createVNode($,{label:"b站用户",prop:"user"},{default:withCtx(()=>[createVNode(k,{modelValue:t.bz.user,"onUpdate:modelValue":i[0]||(i[0]=ie=>t.bz.user=ie)},null,8,["modelValue"])]),_:1}),createVNode($,{label:"转发至群"},{default:withCtx(()=>[createVNode(L,{modelValue:t.bz.forwardGroup,"onUpdate:modelValue":i[1]||(i[1]=ie=>t.bz.forwardGroup=ie),"active-text":"转发","inactive-text":"不转发"},null,8,["modelValue"])]),_:1}),t.bz.forwardGroup?(openBlock(),createBlock($,{key:0,label:"群qq号"},{default:withCtx(()=>[createVNode(k,{modelValue:t.bz.group,"onUpdate:modelValue":i[2]||(i[2]=ie=>t.bz.group=ie)},null,8,["modelValue"])]),_:1})):createCommentVNode("",!0),createVNode($,{label:"转发至好友"},{default:withCtx(()=>[createVNode(L,{modelValue:t.bz.forwardQQ,"onUpdate:modelValue":i[3]||(i[3]=ie=>t.bz.forwardQQ=ie),"active-text":"转发","inactive-text":"不转发"},null,8,["modelValue"])]),_:1}),t.bz.forwardQQ?(openBlock(),createBlock($,{key:1,label:"好友qq"},{default:withCtx(()=>[createVNode(k,{modelValue:t.bz.qq,"onUpdate:modelValue":i[4]||(i[4]=ie=>t.bz.qq=ie)},null,8,["modelValue"])]),_:1})):createCommentVNode("",!0),t.bz.forwardQQ||t.bz.forwardGroup?(openBlock(),createBlock($,{key:2,label:"监听间隔"},{default:withCtx(()=>[createVNode(V,{modelValue:t.bz.timeSpan,"onUpdate:modelValue":i[5]||(i[5]=ie=>t.bz.timeSpan=ie)},null,8,["modelValue"])]),_:1})):createCommentVNode("",!0)]),_:1},8,["model","rules"])]),_:1})}}}),_hoisted_1$3=createBaseVNode("span",{id:"xhs"},"小红书",-1),_sfc_main$7=defineComponent({__name:"xhs",props:{xhs:{type:Object,default:{user:"",group:"",forwardGroup:!1,forwardQQ:!1,qq:"",timeSpan:3}}},setup(t,{expose:r}){const e=ref(),n=ref({user:[{required:!0,message:"请输入该值",trigger:"blur"}]});return r({validForm:async()=>{var y;return await((y=e.value)==null?void 0:y.validate(i=>!!i))}}),(y,i)=>{const k=ElInput,$=ElFormItem,L=ElSwitch,V=ElInputNumber,z=ElForm,re=ElCard;return openBlock(),createBlock(re,{class:"card-xhs"},{header:withCtx(()=>[_hoisted_1$3]),default:withCtx(()=>[createVNode(z,{ref_key:"xhsform",ref:e,model:t.xhs,rules:n.value,"label-width":"150px","label-position":"left"},{default:withCtx(()=>[createVNode($,{label:"小红书用户",prop:"user"},{default:withCtx(()=>[createVNode(k,{modelValue:t.xhs.user,"onUpdate:modelValue":i[0]||(i[0]=ie=>t.xhs.user=ie)},null,8,["modelValue"])]),_:1}),createVNode($,{label:"转发至群"},{default:withCtx(()=>[createVNode(L,{modelValue:t.xhs.forwardGroup,"onUpdate:modelValue":i[1]||(i[1]=ie=>t.xhs.forwardGroup=ie),"active-text":"转发","inactive-text":"不转发"},null,8,["modelValue"])]),_:1}),t.xhs.forwardGroup?(openBlock(),createBlock($,{key:0,label:"群qq号"},{default:withCtx(()=>[createVNode(k,{modelValue:t.xhs.group,"onUpdate:modelValue":i[2]||(i[2]=ie=>t.xhs.group=ie)},null,8,["modelValue"])]),_:1})):createCommentVNode("",!0),createVNode($,{label:"转发至好友"},{default:withCtx(()=>[createVNode(L,{modelValue:t.xhs.forwardQQ,"onUpdate:modelValue":i[3]||(i[3]=ie=>t.xhs.forwardQQ=ie),"active-text":"转发","inactive-text":"不转发"},null,8,["modelValue"])]),_:1}),t.xhs.forwardQQ?(openBlock(),createBlock($,{key:1,label:"好友qq"},{default:withCtx(()=>[createVNode(k,{modelValue:t.xhs.qq,"onUpdate:modelValue":i[4]||(i[4]=ie=>t.xhs.qq=ie)},null,8,["modelValue"])]),_:1})):createCommentVNode("",!0),t.xhs.forwardQQ||t.xhs.forwardGroup?(openBlock(),createBlock($,{key:2,label:"监听间隔"},{default:withCtx(()=>[createVNode(V,{modelValue:t.xhs.timeSpan,"onUpdate:modelValue":i[5]||(i[5]=ie=>t.xhs.timeSpan=ie)},null,8,["modelValue"])]),_:1})):createCommentVNode("",!0)]),_:1},8,["model","rules"])]),_:1})}}}),elUpload="",elProgress="",_hoisted_1$2=createBaseVNode("span",{id:"bd"},"百度",-1),_hoisted_2$1=createBaseVNode("span",{style:{color:"red"}},"*上传人脸轮廓清晰的图片",-1),_hoisted_3$1=createBaseVNode("span",{style:{color:"red"}},"*直接保存(非双胞胎建议80，双胞胎建议70)",-1),_hoisted_4=createBaseVNode("span",{style:{color:"red"}},"*超过该值，但未超过上面的值，将加入审核列表，审核通过才会保存",-1),_hoisted_5=createBaseVNode("span",{style:{color:"red"}},"*启用会将图片自动上传到阿里云盘相册",-1),_sfc_main$6=defineComponent({__name:"bd",props:{bd:{type:Object,default:{appKey:"",appSeret:"",similarity:0,saveAliyunDisk:!1,audit:0,albumName:"",faceVerify:!1,imageList:[]}}},setup(t,{expose:r}){const e=t,n=ref(),g=($,L)=>{e.bd.imageList?e.bd.imageList.push(L.name):e.bd.imageList=[]},y=$=>{if(e.bd.imageList){var L=-1;e.bd.imageList.forEach((V,z)=>{if(V===$.name){L=z;return}}),L>=0&&e.bd.imageList.splice(L,1)}},i=ref({appKey:[{required:!0,message:"请输入该值",trigger:"blur"}],appSeret:[{required:!0,message:"请输入该值",trigger:"blur"}],albumName:[{required:!0,message:"请输入该值",trigger:"blur"}]});return r({validForm:async()=>{var $;return await(($=n.value)==null?void 0:$.validate(L=>!!L))}}),($,L)=>{const V=ElInput,z=ElFormItem,re=ElSwitch,ie=resolveComponent("Plus"),ue=ElIcon,le=ElUpload,oe=ElCol,ae=ElForm,qe=ElCard;return openBlock(),createBlock(qe,{class:"card-bd"},{header:withCtx(()=>[_hoisted_1$2]),default:withCtx(()=>[createVNode(ae,{ref_key:"bdform",ref:n,model:t.bd,rules:i.value,"label-width":"150px","label-position":"left"},{default:withCtx(()=>[createVNode(z,{label:"apiKey",prop:"appKey"},{default:withCtx(()=>[createVNode(V,{modelValue:t.bd.appKey,"onUpdate:modelValue":L[0]||(L[0]=de=>t.bd.appKey=de),placeholder:"百度appKey"},null,8,["modelValue"])]),_:1}),createVNode(z,{label:"appSeret",prop:"appSeret"},{default:withCtx(()=>[createVNode(V,{modelValue:t.bd.appSeret,"onUpdate:modelValue":L[1]||(L[1]=de=>t.bd.appSeret=de),placeholder:"百度appSeret"},null,8,["modelValue"])]),_:1}),createVNode(z,{label:"开启人脸验证"},{default:withCtx(()=>[createVNode(re,{modelValue:t.bd.faceVerify,"onUpdate:modelValue":L[2]||(L[2]=de=>t.bd.faceVerify=de),"active-value":!0,"inactive-value":!1},null,8,["modelValue"])]),_:1}),withDirectives(createVNode(z,{label:"基础人脸"},{default:withCtx(()=>[createVNode(le,{"file-list":t.bd.imageList,action:unref(ApiPrefix)+"/upload","on-success":g,"on-remove":y,"list-type":"picture-card",limit:3,accept:".jpg,.png,.jpeg"},{default:withCtx(()=>[createVNode(ue,null,{default:withCtx(()=>[createVNode(ie)]),_:1})]),_:1},8,["file-list","action"]),_hoisted_2$1]),_:1},512),[[vShow,t.bd.faceVerify]]),withDirectives(createVNode(z,{label:"人脸相似度"},{default:withCtx(()=>[createVNode(oe,{span:8},{default:withCtx(()=>[createVNode(V,{type:"number",modelValue:t.bd.similarity,"onUpdate:modelValue":L[3]||(L[3]=de=>t.bd.similarity=de)},null,8,["modelValue"])]),_:1}),_hoisted_3$1]),_:1},512),[[vShow,t.bd.faceVerify]]),withDirectives(createVNode(z,{label:"审核相似度"},{default:withCtx(()=>[createVNode(oe,{span:8},{default:withCtx(()=>[createVNode(V,{type:"number",modelValue:t.bd.audit,"onUpdate:modelValue":L[4]||(L[4]=de=>t.bd.audit=de)},null,8,["modelValue"])]),_:1}),_hoisted_4]),_:1},512),[[vShow,t.bd.faceVerify]]),withDirectives(createVNode(z,{label:"上传云盘"},{default:withCtx(()=>[createVNode(re,{modelValue:t.bd.saveAliyunDisk,"onUpdate:modelValue":L[5]||(L[5]=de=>t.bd.saveAliyunDisk=de),"active-value":!0,"inactive-value":!1},null,8,["modelValue"]),_hoisted_5]),_:1},512),[[vShow,t.bd.faceVerify]]),withDirectives(createVNode(z,{label:"相册名称",prop:"albumName"},{default:withCtx(()=>[createVNode(oe,{span:8},{default:withCtx(()=>[createVNode(V,{modelValue:t.bd.albumName,"onUpdate:modelValue":L[6]||(L[6]=de=>t.bd.albumName=de)},null,8,["modelValue"])]),_:1})]),_:1},512),[[vShow,t.bd.saveAliyunDisk]])]),_:1},8,["model","rules"])]),_:1})}}}),_hoisted_1$1=createBaseVNode("span",{id:"dy"},"抖音",-1),_sfc_main$5=defineComponent({__name:"dy",props:{dy:{type:Object,default:{user:"",group:"",forwardGroup:!1,forwardQQ:!1,qq:"",timeSpan:3}}},setup(t,{expose:r}){const e=ref(),n=ref({user:[{required:!0,message:"请输入该值",trigger:"blur"}]});return r({validForm:async()=>{var y;return await((y=e.value)==null?void 0:y.validate(i=>!!i))}}),(y,i)=>{const k=ElInput,$=ElFormItem,L=ElSwitch,V=ElInputNumber,z=ElForm,re=ElCard;return openBlock(),createBlock(re,{class:"card-dy"},{header:withCtx(()=>[_hoisted_1$1]),default:withCtx(()=>[createVNode(z,{ref_key:"dyform",ref:e,model:t.dy,rules:n.value,"label-width":"150px","label-position":"left"},{default:withCtx(()=>[createVNode($,{label:"抖音用户",prop:"user"},{default:withCtx(()=>[createVNode(k,{modelValue:t.dy.user,"onUpdate:modelValue":i[0]||(i[0]=ie=>t.dy.user=ie)},null,8,["modelValue"])]),_:1}),createVNode($,{label:"转发至群"},{default:withCtx(()=>[createVNode(L,{modelValue:t.dy.forwardGroup,"onUpdate:modelValue":i[1]||(i[1]=ie=>t.dy.forwardGroup=ie),"active-text":"转发","inactive-text":"不转发"},null,8,["modelValue"])]),_:1}),t.dy.forwardGroup?(openBlock(),createBlock($,{key:0,label:"群qq号"},{default:withCtx(()=>[createVNode(k,{modelValue:t.dy.group,"onUpdate:modelValue":i[2]||(i[2]=ie=>t.dy.group=ie)},null,8,["modelValue"])]),_:1})):createCommentVNode("",!0),createVNode($,{label:"转发至好友"},{default:withCtx(()=>[createVNode(L,{modelValue:t.dy.forwardQQ,"onUpdate:modelValue":i[3]||(i[3]=ie=>t.dy.forwardQQ=ie),"active-text":"转发","inactive-text":"不转发"},null,8,["modelValue"])]),_:1}),t.dy.forwardQQ?(openBlock(),createBlock($,{key:1,label:"好友qq"},{default:withCtx(()=>[createVNode(k,{modelValue:t.dy.qq,"onUpdate:modelValue":i[4]||(i[4]=ie=>t.dy.qq=ie)},null,8,["modelValue"])]),_:1})):createCommentVNode("",!0),t.dy.forwardQQ||t.dy.forwardGroup?(openBlock(),createBlock($,{key:2,label:"监听间隔"},{default:withCtx(()=>[createVNode(V,{modelValue:t.dy.timeSpan,"onUpdate:modelValue":i[5]||(i[5]=ie=>t.dy.timeSpan=ie)},null,8,["modelValue"])]),_:1})):createCommentVNode("",!0)]),_:1},8,["model","rules"])]),_:1})}}}),elMessageBox="",_sfc_main$4=defineComponent({__name:"config",props:{enable:{type:Object,default:{qq:!1,wb:!1,bz:!1,kd:!1,xhs:!1,dy:!1,bd:!1}}},emits:["top-enable-change"],setup(t,{expose:r,emit:e}){const n=t,g=ref(),y=ref(),i=ref(),k=ref(),$=ref(),L=ref(),V=ref(),z=ref(),re=ref({EnableModule:n.enable}),ie=ref(),ue=e,le=de=>{re.value.EnableModule=de,ue("top-enable-change",de)},oe=async()=>{let de=!0;if(re.value.EnableModule.bot&&(de=await g.value.validForm()),re.value.EnableModule.wb&&(de=await y.value.validForm()),re.value.EnableModule.qq&&(de=await i.value.validForm()),re.value.EnableModule.bz&&(de=await k.value.validForm()),re.value.EnableModule.bd&&(de=await $.value.validForm()),re.value.EnableModule.kd&&(de=await L.value.validForm()),re.value.EnableModule.xhs&&(de=await V.value.validForm()),re.value.EnableModule.dy&&(de=await z.value.validForm()),!de){ElMessage.error("请填入配置中的必填项！");return}var Ne=await saveConfig(re.value);Ne&&Ne.success?(ie.value=re.value,ElMessage.success(Ne.msg)):ElMessage.error(Ne.msg||"保存失败！")},ae=async()=>{var de=await getConfig();de&&de.success&&(re.value.EnableModule=de.data.enableModule,re.value.Bot=de.data.bot,re.value.QQ=de.data.qq,re.value.WB=de.data.wb,re.value.KD=de.data.kd,re.value.BZ=de.data.bz,re.value.BD=de.data.bd,re.value.XHS=de.data.xhs,re.value.DY=de.data.dy);let Ne=JSON.stringify(re.value),ze=JSON.parse(Ne);ie.value=ze},qe=()=>{let de=JSON.stringify(ie.value),Ne=JSON.stringify(re.value);return de!=Ne?ElMessageBox.confirm("配置已被修改，但未保存，是否保存","警告",{confirmButtonText:"保存",cancelButtonText:"取消",type:"warning"}).then(async()=>(await oe(),!0)).catch(async()=>!0):new Promise((ze,$e)=>{ze(!0)})};return onMounted(async()=>{await ae()}),r({checkData:qe}),(de,Ne)=>{const ze=ElButton,$e=ElCard,Lt=ElAffix,jt=ElScrollbar;return openBlock(),createElementBlock(Fragment,null,[createVNode(Lt,{target:".el-scrollbar__view"},{default:withCtx(()=>[createVNode($e,{id:"enable"},{header:withCtx(()=>[createVNode(ze,{type:"primary","native-type":"button",icon:unref(edit_default),onClick:Ne[0]||(Ne[0]=Et=>oe())},{default:withCtx(()=>[createTextVNode("保存")]),_:1},8,["icon"]),createVNode(ze,{type:"primary","native-type":"button",icon:unref(setting_default),onClick:Ne[1]||(Ne[1]=Et=>ae())},{default:withCtx(()=>[createTextVNode("重置")]),_:1},8,["icon"])]),default:withCtx(()=>[createVNode(_sfc_main$d,{enable:re.value.EnableModule,onEnableChange:le},null,8,["enable"])]),_:1})]),_:1}),createVNode(jt,{style:{height:"calc(100vh - 230px)"},id:"pdom"},{default:withCtx(()=>[re.value.EnableModule.bot?(openBlock(),createBlock(_sfc_main$c,{key:0,ref_key:"botRef",ref:g,bot:re.value.Bot,class:"mt10"},null,8,["bot"])):createCommentVNode("",!0),re.value.EnableModule.qq?(openBlock(),createBlock(_sfc_main$b,{key:1,ref_key:"qqRef",ref:i,qq:re.value.QQ,class:"mt10"},null,8,["qq"])):createCommentVNode("",!0),re.value.EnableModule.wb?(openBlock(),createBlock(_sfc_main$a,{key:2,ref_key:"wbRef",ref:y,wb:re.value.WB,class:"mt10"},null,8,["wb"])):createCommentVNode("",!0),re.value.EnableModule.kd?(openBlock(),createBlock(_sfc_main$9,{key:3,ref_key:"kdRef",ref:L,kd:re.value.KD,class:"mt10"},null,8,["kd"])):createCommentVNode("",!0),re.value.EnableModule.bz?(openBlock(),createBlock(_sfc_main$8,{key:4,ref_key:"bzRef",ref:k,bz:re.value.BZ,class:"mt10"},null,8,["bz"])):createCommentVNode("",!0),re.value.EnableModule.xhs?(openBlock(),createBlock(_sfc_main$7,{key:5,ref_key:"xhsRef",ref:V,xhs:re.value.XHS,class:"mt10"},null,8,["xhs"])):createCommentVNode("",!0),re.value.EnableModule.bd?(openBlock(),createBlock(_sfc_main$6,{key:6,ref_key:"bdRef",ref:$,bd:re.value.BD,class:"mt10"},null,8,["bd"])):createCommentVNode("",!0),re.value.EnableModule.dy?(openBlock(),createBlock(_sfc_main$5,{key:7,ref_key:"dyRef",ref:z,dy:re.value.DY,class:"mt10 mb50"},null,8,["dy"])):createCommentVNode("",!0)]),_:1})],64)}}}),config_vue_vue_type_style_index_0_lang="",elImage="",elImageViewer="",elAvatar="";var FileSaver_min={exports:{}};(function(t,r){(function(e,n){n()})(commonjsGlobal,function(){function e(L,V){return typeof V>"u"?V={autoBom:!1}:typeof V!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),V={autoBom:!V}),V.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(L.type)?new Blob(["\uFEFF",L],{type:L.type}):L}function n(L,V,z){var re=new XMLHttpRequest;re.open("GET",L),re.responseType="blob",re.onload=function(){$(re.response,V,z)},re.onerror=function(){console.error("could not download file")},re.send()}function g(L){var V=new XMLHttpRequest;V.open("HEAD",L,!1);try{V.send()}catch{}return 200<=V.status&&299>=V.status}function y(L){try{L.dispatchEvent(new MouseEvent("click"))}catch{var V=document.createEvent("MouseEvents");V.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),L.dispatchEvent(V)}}var i=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof commonjsGlobal=="object"&&commonjsGlobal.global===commonjsGlobal?commonjsGlobal:void 0,k=i.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),$=i.saveAs||(typeof window!="object"||window!==i?function(){}:"download"in HTMLAnchorElement.prototype&&!k?function(L,V,z){var re=i.URL||i.webkitURL,ie=document.createElement("a");V=V||L.name||"download",ie.download=V,ie.rel="noopener",typeof L=="string"?(ie.href=L,ie.origin===location.origin?y(ie):g(ie.href)?n(L,V,z):y(ie,ie.target="_blank")):(ie.href=re.createObjectURL(L),setTimeout(function(){re.revokeObjectURL(ie.href)},4e4),setTimeout(function(){y(ie)},0))}:"msSaveOrOpenBlob"in navigator?function(L,V,z){if(V=V||L.name||"download",typeof L!="string")navigator.msSaveOrOpenBlob(e(L,z),V);else if(g(L))n(L,V,z);else{var re=document.createElement("a");re.href=L,re.target="_blank",setTimeout(function(){y(re)})}}:function(L,V,z,re){if(re=re||open("","_blank"),re&&(re.document.title=re.document.body.innerText="downloading..."),typeof L=="string")return n(L,V,z);var ie=L.type==="application/octet-stream",ue=/constructor/i.test(i.HTMLElement)||i.safari,le=/CriOS\/[\d]+/.test(navigator.userAgent);if((le||ie&&ue||k)&&typeof FileReader<"u"){var oe=new FileReader;oe.onloadend=function(){var de=oe.result;de=le?de:de.replace(/^data:[^;]*;/,"data:attachment/file;"),re?re.location.href=de:location=de,re=null},oe.readAsDataURL(L)}else{var ae=i.URL||i.webkitURL,qe=ae.createObjectURL(L);re?re.location=qe:location.href=qe,re=null,setTimeout(function(){ae.revokeObjectURL(qe)},4e4)}});i.saveAs=$.saveAs=$,t.exports=$})})(FileSaver_min);var FileSaver_minExports=FileSaver_min.exports;const _hoisted_1={key:0,style:{"margin-top":"10px"}},_hoisted_2={key:1},_hoisted_3=["onClick"],_sfc_main$3=defineComponent({__name:"log",setup(t){const r=ref(new Array),e=k=>{k&&openWindow(k)},n=async()=>{if(r.value.length<=0){ElMessage.info("无日志");return}ElMessageBox.confirm("此操作将永久清空日志，是否删除","警告",{cancelButtonText:"取消",confirmButtonText:"确定"}).then(()=>{r.value=new Array,logApi().clearLog()})},g=()=>{if(r.value.length<=0){ElMessage.info("无日志");return}let k=[""];r.value.forEach(L=>{L.type=="link"||L.type=="pic"?k.push(L.name+":"+L.url):k.push(L.name+":"+L.content)});const $=new Blob(k,{type:"text/plain;charset=utf-8"});FileSaver_minExports.saveAs($,"logs.txt")},y=()=>{var k=r.value.filter($=>$.type=="pic").map($=>$.url);return k??[]},i=k=>{var $=y().findIndex(L=>L==k);return $};return onMounted(()=>{let k=logApi().getLogs();k&&(r.value=k)}),(k,$)=>{const L=ElButton,V=ElAvatar,z=ElImage,re=ElScrollbar;return openBlock(),createElementBlock("div",null,[createBaseVNode("div",null,[createVNode(L,{type:"primary",onClick:n},{default:withCtx(()=>[createTextVNode("清空")]),_:1}),createVNode(L,{type:"primary",onClick:g},{default:withCtx(()=>[createTextVNode("导出")]),_:1})]),createVNode(re,{style:{height:"calc(100vh - 100px)","margin-top":"10px"}},{default:withCtx(()=>[(openBlock(!0),createElementBlock(Fragment,null,renderList(r.value,(ie,ue)=>(openBlock(),createElementBlock("div",null,[createBaseVNode("span",null,toDisplayString(ue+1)+".",1),ie.type!=="system"?(openBlock(),createElementBlock("span",_hoisted_1,[createVNode(V,{src:ie.avatar},null,8,["src"]),createTextVNode(toDisplayString(ie.name)+"：",1)])):(openBlock(),createElementBlock("span",_hoisted_2,"系统信息：")),(ie.type=="text",openBlock(),createElementBlock("span",{key:2,style:normalizeStyle({color:ie.color})},toDisplayString(ie.content),5)),ie.type=="link"?(openBlock(),createElementBlock("span",{key:3,style:normalizeStyle({color:ie.color,"text-decoration":"underline",cursor:"pointer"}),onClick:le=>e(ie.url)},toDisplayString(ie.url),13,_hoisted_3)):createCommentVNode("",!0),ie.type=="pic"?(openBlock(),createBlock(z,{key:4,src:ie.url,"initial-index":i(ie.url),"preview-src-list":y(),style:{width:"120px",height:"auto"}},null,8,["src","initial-index","preview-src-list"])):createCommentVNode("",!0),createBaseVNode("span",null,"--"+toDisplayString(ie.time),1)]))),256))]),_:1})])}}}),elTable="",elTableColumn="",elSpace="",_sfc_main$2=defineComponent({__name:"pic",setup(t){const r=ref(),e=async y=>{let i=await saveImg(y);i.success?ElMessage.success(i.msg):ElMessage.error(i.msg),await g()},n=async y=>{let i=await delImg(y);i.success?ElMessage.success(i.msg):ElMessage.error(i.msg),await g()},g=async()=>{var y=await getCache();r.value=y.data};return onMounted(async()=>{await g()}),(y,i)=>{const k=ElButton,$=ElSpace,L=ElRow,V=ElTableColumn,z=ElImage,re=ElTable;return openBlock(),createElementBlock("div",null,[createVNode(L,null,{default:withCtx(()=>[createVNode($,{wrap:""},{default:withCtx(()=>[createVNode(k,{type:"primary",icon:unref(refresh_default),onClick:g},{default:withCtx(()=>[createTextVNode("刷新")]),_:1},8,["icon"])]),_:1})]),_:1}),createVNode(L,{style:{"margin-top":"10px"}},{default:withCtx(()=>[createVNode(re,{data:r.value,stripe:"",style:{width:"100%",height:"calc(100vh - 100px)"}},{default:withCtx(()=>[createVNode(V,{type:"index",width:"50"}),createVNode(V,{prop:"createDate",label:"时间"}),createVNode(V,{prop:"content",label:"图片"},{default:withCtx(ie=>[createVNode(z,{style:{width:"auto",height:"120px"},src:ie.row.content,"preview-teleported":"","preview-src-list":[ie.row.content]},null,8,["src","preview-src-list"])]),_:1}),createVNode(V,{label:"操作"},{default:withCtx(ie=>[createVNode(k,{type:"primary",onClick:ue=>e(ie.row.id)},{default:withCtx(()=>[createTextVNode("保存")]),_:2},1032,["onClick"]),createVNode(k,{type:"primary",onClick:ue=>n(ie.row.id)},{default:withCtx(()=>[createTextVNode("删除")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])]),_:1})])}}}),_sfc_main$1=defineComponent({__name:"plugin",setup(t){const r=ref(),e=async()=>{var k=await getFun();r.value=k.data},n=async k=>{let $=await startPlugin(k);$.success?ElMessage.success($.msg):ElMessage.error($.msg),await e()},g=async k=>{let $=await stopPlugin(k);$.success?ElMessage.success($.msg):ElMessage.error($.msg),await e()},y=async k=>{let $=await delPlugin(k);$.success?ElMessage.success($.msg):ElMessage.error($.msg),await e()},i=async()=>{await e()};return onMounted(async()=>{await e()}),(k,$)=>{const L=ElButton,V=ElUpload,z=ElSpace,re=ElRow,ie=ElTableColumn,ue=ElTag,le=ElTable;return openBlock(),createElementBlock("div",null,[createVNode(re,null,{default:withCtx(()=>[createVNode(z,{wrap:""},{default:withCtx(()=>[createVNode(V,{accept:".dll",action:unref(ApiPrefix)+"/uploaddll",multiple:"","show-file-list":!1,"on-success":i},{default:withCtx(()=>[createVNode(L,{type:"info",icon:unref(upload_default)},{default:withCtx(()=>[createTextVNode("上传插件")]),_:1},8,["icon"])]),_:1},8,["action"]),createVNode(L,{type:"primary",icon:unref(refresh_default),onClick:e},{default:withCtx(()=>[createTextVNode("刷新")]),_:1},8,["icon"])]),_:1})]),_:1}),createVNode(re,{style:{"margin-top":"10px"}},{default:withCtx(()=>[createVNode(le,{data:r.value,stripe:"",style:{width:"100%",height:"calc(100vh - 100px)"}},{default:withCtx(()=>[createVNode(ie,{type:"index",width:"50"}),createVNode(ie,{label:"插件名",width:"120"},{default:withCtx(oe=>[createTextVNode(toDisplayString(oe.row.pluginInfo.name),1)]),_:1}),createVNode(ie,{label:"版本",width:"120"},{default:withCtx(oe=>[createTextVNode(toDisplayString(oe.row.pluginInfo.version),1)]),_:1}),createVNode(ie,{label:"状态",width:"120"},{default:withCtx(oe=>[oe.row.status?(openBlock(),createBlock(ue,{key:0,type:"success"},{default:withCtx(()=>[createTextVNode("启用")]),_:1})):(openBlock(),createBlock(ue,{key:1,type:"danger"},{default:withCtx(()=>[createTextVNode("禁用")]),_:1}))]),_:1}),createVNode(ie,{label:"描述"},{default:withCtx(oe=>[createTextVNode(toDisplayString(oe.row.pluginInfo.desc),1)]),_:1}),createVNode(ie,{label:"操作",width:"180"},{default:withCtx(oe=>[oe.row.status?(openBlock(),createBlock(L,{key:1,type:"warning",onClick:ae=>g(oe.row.pluginInfo.name)},{default:withCtx(()=>[createTextVNode("禁用")]),_:2},1032,["onClick"])):(openBlock(),createBlock(L,{key:0,type:"primary",onClick:ae=>n(oe.row.pluginInfo.name)},{default:withCtx(()=>[createTextVNode("启用")]),_:2},1032,["onClick"])),createVNode(L,{type:"danger",onClick:ae=>y(oe.row.pluginInfo.name)},{default:withCtx(()=>[createTextVNode("删除")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])]),_:1})])}}}),_sfc_main=defineComponent({__name:"App",setup(t){const r=ref(),e=ref({bot:!1,qq:!1,wb:!1,bz:!1,kd:!1,xhs:!1,dy:!1,bd:!1}),n=["index","log","pic","plugin"],g=ref(),y=ref("index"),i=async V=>{n.find(z=>z===V)?(g.value&&(await g.value.checkData(),await L()),y.value=V):k("enable")},k=async V=>{var ie;n.find(ue=>ue===y.value)&&(y.value="config",setTimeout(async()=>{await k(V)},100));const z=document.getElementById(V),re=(ie=document.getElementById("pdom"))==null?void 0:ie.parentElement;if(re&&z){const ue=re.getBoundingClientRect(),oe=z.getBoundingClientRect().top+re.scrollTop-ue.top-28;re.scrollTo({top:oe,behavior:"smooth"})}},$=V=>{e.value=V},L=async()=>{let V=await getConfig();e.value=V.data.enableModule;let z=JSON.stringify(V.data.enableModule),re=JSON.parse(z);r.value=re};return onMounted(async()=>{await L()}),(V,z)=>{const re=ElIcon,ie=ElMenuItem,ue=ElSubMenu,le=ElMenu,oe=ElScrollbar,ae=ElAside,qe=ElCard,de=ElMain,Ne=ElContainer;return openBlock(),createBlock(Ne,{class:"layout-container"},{default:withCtx(()=>[createVNode(qe,null,{default:withCtx(()=>[createVNode(ae,{width:"15vw"},{default:withCtx(()=>[createVNode(oe,{style:{height:"calc(100vh - 30px)"}},{default:withCtx(()=>[createVNode(le,{"default-openeds":["99"],"default-active":"1"},{default:withCtx(()=>[createVNode(ie,{index:"1",onClick:z[0]||(z[0]=ze=>i("index"))},{default:withCtx(()=>[createVNode(re,null,{default:withCtx(()=>[createVNode(unref(house_default))]),_:1}),createTextVNode(" 开始 ")]),_:1}),createVNode(ie,{index:"2",onClick:z[1]||(z[1]=ze=>i("log"))},{default:withCtx(()=>[createVNode(re,null,{default:withCtx(()=>[createVNode(unref(tickets_default))]),_:1}),createTextVNode(" 日志 ")]),_:1}),createVNode(ie,{index:"3",onClick:z[2]||(z[2]=ze=>i("pic"))},{default:withCtx(()=>[createVNode(re,null,{default:withCtx(()=>[createVNode(unref(picture_default))]),_:1}),createTextVNode(" 图片 ")]),_:1}),withDirectives(createVNode(ie,{index:"4",onClick:z[3]||(z[3]=ze=>i("plugin"))},{default:withCtx(()=>[createVNode(re,null,{default:withCtx(()=>[createVNode(unref(cpu_default))]),_:1}),createTextVNode(" 插件 ")]),_:1},512),[[vShow,e.value.qq]]),createVNode(ue,{index:"99"},{title:withCtx(()=>[createVNode(re,null,{default:withCtx(()=>[createVNode(unref(set_up_default))]),_:1}),createTextVNode("配置 ")]),default:withCtx(()=>[createVNode(ie,{index:"99-0",onClick:z[4]||(z[4]=ze=>i("config"))},{default:withCtx(()=>[createTextVNode("启用模块")]),_:1}),withDirectives(createVNode(ie,{index:"99-1",onClick:z[5]||(z[5]=ze=>k("bot"))},{default:withCtx(()=>[createTextVNode("机器人")]),_:1},512),[[vShow,e.value.bot]]),withDirectives(createVNode(ie,{index:"99-2",onClick:z[6]||(z[6]=ze=>k("qq"))},{default:withCtx(()=>[createTextVNode("QQ")]),_:1},512),[[vShow,e.value.qq]]),withDirectives(createVNode(ie,{index:"99-3",onClick:z[7]||(z[7]=ze=>k("wb"))},{default:withCtx(()=>[createTextVNode("微博")]),_:1},512),[[vShow,e.value.wb]]),withDirectives(createVNode(ie,{index:"99-4",onClick:z[8]||(z[8]=ze=>k("kd"))},{default:withCtx(()=>[createTextVNode("口袋")]),_:1},512),[[vShow,e.value.kd]]),withDirectives(createVNode(ie,{index:"99-5",onClick:z[9]||(z[9]=ze=>k("bz"))},{default:withCtx(()=>[createTextVNode("B站")]),_:1},512),[[vShow,e.value.bz]]),withDirectives(createVNode(ie,{index:"99-6",onClick:z[10]||(z[10]=ze=>k("xhs"))},{default:withCtx(()=>[createTextVNode("小红书")]),_:1},512),[[vShow,e.value.xhs]]),withDirectives(createVNode(ie,{index:"99-7",onClick:z[11]||(z[11]=ze=>k("bd"))},{default:withCtx(()=>[createTextVNode("百度")]),_:1},512),[[vShow,e.value.bd]]),withDirectives(createVNode(ie,{index:"99-8",onClick:z[12]||(z[12]=ze=>k("dy"))},{default:withCtx(()=>[createTextVNode("抖音")]),_:1},512),[[vShow,e.value.dy]])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),createVNode(qe,{style:{width:"90%","margin-left":"10px"}},{default:withCtx(()=>[createVNode(Ne,null,{default:withCtx(()=>[createVNode(de,{style:{"padding-left":"20px","padding-right":"20px"},id:"parentContainer"},{default:withCtx(()=>[withDirectives(createVNode(_sfc_main$e,{enable:e.value},null,8,["enable"]),[[vShow,y.value==="index"]]),withDirectives(createVNode(_sfc_main$3,null,null,512),[[vShow,y.value==="log"]]),withDirectives(createVNode(_sfc_main$2,null,null,512),[[vShow,y.value==="pic"]]),y.value==="plugin"&&e.value.qq?(openBlock(),createBlock(_sfc_main$1,{key:0})):createCommentVNode("",!0),y.value==="config"?(openBlock(),createBlock(_sfc_main$4,{key:1,ref_key:"configRef",ref:g,enable:e.value,onTopEnableChange:$},null,8,["enable"])):createCommentVNode("",!0)]),_:1})]),_:1})]),_:1})]),_:1})}}}),App_vue_vue_type_style_index_0_scoped_16bd3738_lang="",_export_sfc=(t,r)=>{const e=t.__vccOpts||t;for(const[n,g]of r)e[n]=g;return e},App=_export_sfc(_sfc_main,[["__scopeId","data-v-16bd3738"]]),app=createApp(App);app.mount("#app");
