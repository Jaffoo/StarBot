var mM=Object.defineProperty;var gM=(t,r,e)=>r in t?mM(t,r,{enumerable:!0,configurable:!0,writable:!0,value:e}):t[r]=e;var Eu=(t,r,e)=>(gM(t,typeof r!="symbol"?r+"":r,e),e);(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const g of document.querySelectorAll('link[rel="modulepreload"]'))n(g);new MutationObserver(g=>{for(const y of g)if(y.type==="childList")for(const i of y.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function e(g){const y={};return g.integrity&&(y.integrity=g.integrity),g.referrerPolicy&&(y.referrerPolicy=g.referrerPolicy),g.crossOrigin==="use-credentials"?y.credentials="include":g.crossOrigin==="anonymous"?y.credentials="omit":y.credentials="same-origin",y}function n(g){if(g.ep)return;g.ep=!0;const y=e(g);fetch(g.href,y)}})();/**
* @vue/shared v3.4.20
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function makeMap(t,r){const e=new Set(t.split(","));return r?n=>e.has(n.toLowerCase()):n=>e.has(n)}const EMPTY_OBJ={},EMPTY_ARR=[],NOOP=()=>{},NO=()=>!1,isOn=t=>t.charCodeAt(0)===111&&t.charCodeAt(1)===110&&(t.charCodeAt(2)>122||t.charCodeAt(2)<97),isModelListener=t=>t.startsWith("onUpdate:"),extend$1=Object.assign,remove=(t,r)=>{const e=t.indexOf(r);e>-1&&t.splice(e,1)},hasOwnProperty$f=Object.prototype.hasOwnProperty,hasOwn=(t,r)=>hasOwnProperty$f.call(t,r),isArray$3=Array.isArray,isMap$2=t=>toTypeString(t)==="[object Map]",isSet$2=t=>toTypeString(t)==="[object Set]",isDate$1=t=>toTypeString(t)==="[object Date]",isFunction$3=t=>typeof t=="function",isString$2=t=>typeof t=="string",isSymbol$1=t=>typeof t=="symbol",isObject$2=t=>t!==null&&typeof t=="object",isPromise=t=>(isObject$2(t)||isFunction$3(t))&&isFunction$3(t.then)&&isFunction$3(t.catch),objectToString$1=Object.prototype.toString,toTypeString=t=>objectToString$1.call(t),toRawType=t=>toTypeString(t).slice(8,-1),isPlainObject$2=t=>toTypeString(t)==="[object Object]",isIntegerKey=t=>isString$2(t)&&t!=="NaN"&&t[0]!=="-"&&""+parseInt(t,10)===t,isReservedProp=makeMap(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),cacheStringFunction=t=>{const r=Object.create(null);return e=>r[e]||(r[e]=t(e))},camelizeRE=/-(\w)/g,camelize=cacheStringFunction(t=>t.replace(camelizeRE,(r,e)=>e?e.toUpperCase():"")),hyphenateRE=/\B([A-Z])/g,hyphenate=cacheStringFunction(t=>t.replace(hyphenateRE,"-$1").toLowerCase()),capitalize$1=cacheStringFunction(t=>t.charAt(0).toUpperCase()+t.slice(1)),toHandlerKey=cacheStringFunction(t=>t?`on${capitalize$1(t)}`:""),hasChanged=(t,r)=>!Object.is(t,r),invokeArrayFns=(t,r)=>{for(let e=0;e<t.length;e++)t[e](r)},def=(t,r,e)=>{Object.defineProperty(t,r,{configurable:!0,enumerable:!1,value:e})},looseToNumber=t=>{const r=parseFloat(t);return isNaN(r)?t:r},toNumber$1=t=>{const r=isString$2(t)?Number(t):NaN;return isNaN(r)?t:r};let _globalThis;const getGlobalThis=()=>_globalThis||(_globalThis=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function normalizeStyle(t){if(isArray$3(t)){const r={};for(let e=0;e<t.length;e++){const n=t[e],g=isString$2(n)?parseStringStyle(n):normalizeStyle(n);if(g)for(const y in g)r[y]=g[y]}return r}else if(isString$2(t)||isObject$2(t))return t}const listDelimiterRE=/;(?![^(]*\))/g,propertyDelimiterRE=/:([^]+)/,styleCommentRE=/\/\*[^]*?\*\//g;function parseStringStyle(t){const r={};return t.replace(styleCommentRE,"").split(listDelimiterRE).forEach(e=>{if(e){const n=e.split(propertyDelimiterRE);n.length>1&&(r[n[0].trim()]=n[1].trim())}}),r}function normalizeClass(t){let r="";if(isString$2(t))r=t;else if(isArray$3(t))for(let e=0;e<t.length;e++){const n=normalizeClass(t[e]);n&&(r+=n+" ")}else if(isObject$2(t))for(const e in t)t[e]&&(r+=e+" ");return r.trim()}const specialBooleanAttrs="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",isSpecialBooleanAttr=makeMap(specialBooleanAttrs);function includeBooleanAttr(t){return!!t||t===""}function looseCompareArrays(t,r){if(t.length!==r.length)return!1;let e=!0;for(let n=0;e&&n<t.length;n++)e=looseEqual(t[n],r[n]);return e}function looseEqual(t,r){if(t===r)return!0;let e=isDate$1(t),n=isDate$1(r);if(e||n)return e&&n?t.getTime()===r.getTime():!1;if(e=isSymbol$1(t),n=isSymbol$1(r),e||n)return t===r;if(e=isArray$3(t),n=isArray$3(r),e||n)return e&&n?looseCompareArrays(t,r):!1;if(e=isObject$2(t),n=isObject$2(r),e||n){if(!e||!n)return!1;const g=Object.keys(t).length,y=Object.keys(r).length;if(g!==y)return!1;for(const i in t){const k=t.hasOwnProperty(i),L=r.hasOwnProperty(i);if(k&&!L||!k&&L||!looseEqual(t[i],r[i]))return!1}}return String(t)===String(r)}function looseIndexOf(t,r){return t.findIndex(e=>looseEqual(e,r))}const toDisplayString=t=>isString$2(t)?t:t==null?"":isArray$3(t)||isObject$2(t)&&(t.toString===objectToString$1||!isFunction$3(t.toString))?JSON.stringify(t,replacer,2):String(t),replacer=(t,r)=>r&&r.__v_isRef?replacer(t,r.value):isMap$2(r)?{[`Map(${r.size})`]:[...r.entries()].reduce((e,[n,g],y)=>(e[stringifySymbol(n,y)+" =>"]=g,e),{})}:isSet$2(r)?{[`Set(${r.size})`]:[...r.values()].map(e=>stringifySymbol(e))}:isSymbol$1(r)?stringifySymbol(r):isObject$2(r)&&!isArray$3(r)&&!isPlainObject$2(r)?String(r):r,stringifySymbol=(t,r="")=>{var e;return isSymbol$1(t)?`Symbol(${(e=t.description)!=null?e:r})`:t};/**
* @vue/reactivity v3.4.20
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let activeEffectScope;class EffectScope{constructor(r=!1){this.detached=r,this._active=!0,this.effects=[],this.cleanups=[],this.parent=activeEffectScope,!r&&activeEffectScope&&(this.index=(activeEffectScope.scopes||(activeEffectScope.scopes=[])).push(this)-1)}get active(){return this._active}run(r){if(this._active){const e=activeEffectScope;try{return activeEffectScope=this,r()}finally{activeEffectScope=e}}}on(){activeEffectScope=this}off(){activeEffectScope=this.parent}stop(r){if(this._active){let e,n;for(e=0,n=this.effects.length;e<n;e++)this.effects[e].stop();for(e=0,n=this.cleanups.length;e<n;e++)this.cleanups[e]();if(this.scopes)for(e=0,n=this.scopes.length;e<n;e++)this.scopes[e].stop(!0);if(!this.detached&&this.parent&&!r){const g=this.parent.scopes.pop();g&&g!==this&&(this.parent.scopes[this.index]=g,g.index=this.index)}this.parent=void 0,this._active=!1}}}function effectScope(t){return new EffectScope(t)}function recordEffectScope(t,r=activeEffectScope){r&&r.active&&r.effects.push(t)}function getCurrentScope(){return activeEffectScope}function onScopeDispose(t){activeEffectScope&&activeEffectScope.cleanups.push(t)}let activeEffect;class ReactiveEffect{constructor(r,e,n,g){this.fn=r,this.trigger=e,this.scheduler=n,this.active=!0,this.deps=[],this._dirtyLevel=4,this._trackId=0,this._runnings=0,this._shouldSchedule=!1,this._depsLength=0,recordEffectScope(this,g)}get dirty(){if(this._dirtyLevel===2||this._dirtyLevel===3){this._dirtyLevel=1,pauseTracking();for(let r=0;r<this._depsLength;r++){const e=this.deps[r];if(e.computed&&(triggerComputed(e.computed),this._dirtyLevel>=4))break}this._dirtyLevel===1&&(this._dirtyLevel=0),resetTracking()}return this._dirtyLevel>=4}set dirty(r){this._dirtyLevel=r?4:0}run(){if(this._dirtyLevel=0,!this.active)return this.fn();let r=shouldTrack,e=activeEffect;try{return shouldTrack=!0,activeEffect=this,this._runnings++,preCleanupEffect(this),this.fn()}finally{postCleanupEffect(this),this._runnings--,activeEffect=e,shouldTrack=r}}stop(){var r;this.active&&(preCleanupEffect(this),postCleanupEffect(this),(r=this.onStop)==null||r.call(this),this.active=!1)}}function triggerComputed(t){return t.value}function preCleanupEffect(t){t._trackId++,t._depsLength=0}function postCleanupEffect(t){if(t.deps.length>t._depsLength){for(let r=t._depsLength;r<t.deps.length;r++)cleanupDepEffect(t.deps[r],t);t.deps.length=t._depsLength}}function cleanupDepEffect(t,r){const e=t.get(r);e!==void 0&&r._trackId!==e&&(t.delete(r),t.size===0&&t.cleanup())}let shouldTrack=!0,pauseScheduleStack=0;const trackStack=[];function pauseTracking(){trackStack.push(shouldTrack),shouldTrack=!1}function resetTracking(){const t=trackStack.pop();shouldTrack=t===void 0?!0:t}function pauseScheduling(){pauseScheduleStack++}function resetScheduling(){for(pauseScheduleStack--;!pauseScheduleStack&&queueEffectSchedulers.length;)queueEffectSchedulers.shift()()}function trackEffect(t,r,e){if(r.get(t)!==t._trackId){r.set(t,t._trackId);const n=t.deps[t._depsLength];n!==r?(n&&cleanupDepEffect(n,t),t.deps[t._depsLength++]=r):t._depsLength++}}const queueEffectSchedulers=[];function triggerEffects(t,r,e){pauseScheduling();for(const n of t.keys()){let g;n._dirtyLevel<r&&(g??(g=t.get(n)===n._trackId))&&(n._shouldSchedule||(n._shouldSchedule=n._dirtyLevel===0),n._dirtyLevel=r),n._shouldSchedule&&(g??(g=t.get(n)===n._trackId))&&(n.trigger(),(!n._runnings||n.allowRecurse)&&n._dirtyLevel!==2&&(n._shouldSchedule=!1,n.scheduler&&queueEffectSchedulers.push(n.scheduler)))}resetScheduling()}const createDep=(t,r)=>{const e=new Map;return e.cleanup=t,e.computed=r,e},targetMap=new WeakMap,ITERATE_KEY=Symbol(""),MAP_KEY_ITERATE_KEY=Symbol("");function track(t,r,e){if(shouldTrack&&activeEffect){let n=targetMap.get(t);n||targetMap.set(t,n=new Map);let g=n.get(e);g||n.set(e,g=createDep(()=>n.delete(e))),trackEffect(activeEffect,g)}}function trigger(t,r,e,n,g,y){const i=targetMap.get(t);if(!i)return;let k=[];if(r==="clear")k=[...i.values()];else if(e==="length"&&isArray$3(t)){const L=Number(n);i.forEach(($,V)=>{(V==="length"||!isSymbol$1(V)&&V>=L)&&k.push($)})}else switch(e!==void 0&&k.push(i.get(e)),r){case"add":isArray$3(t)?isIntegerKey(e)&&k.push(i.get("length")):(k.push(i.get(ITERATE_KEY)),isMap$2(t)&&k.push(i.get(MAP_KEY_ITERATE_KEY)));break;case"delete":isArray$3(t)||(k.push(i.get(ITERATE_KEY)),isMap$2(t)&&k.push(i.get(MAP_KEY_ITERATE_KEY)));break;case"set":isMap$2(t)&&k.push(i.get(ITERATE_KEY));break}pauseScheduling();for(const L of k)L&&triggerEffects(L,4);resetScheduling()}function getDepFromReactive(t,r){var e;return(e=targetMap.get(t))==null?void 0:e.get(r)}const isNonTrackableKeys=makeMap("__proto__,__v_isRef,__isVue"),builtInSymbols=new Set(Object.getOwnPropertyNames(Symbol).filter(t=>t!=="arguments"&&t!=="caller").map(t=>Symbol[t]).filter(isSymbol$1)),arrayInstrumentations=createArrayInstrumentations();function createArrayInstrumentations(){const t={};return["includes","indexOf","lastIndexOf"].forEach(r=>{t[r]=function(...e){const n=toRaw(this);for(let y=0,i=this.length;y<i;y++)track(n,"get",y+"");const g=n[r](...e);return g===-1||g===!1?n[r](...e.map(toRaw)):g}}),["push","pop","shift","unshift","splice"].forEach(r=>{t[r]=function(...e){pauseTracking(),pauseScheduling();const n=toRaw(this)[r].apply(this,e);return resetScheduling(),resetTracking(),n}}),t}function hasOwnProperty$e(t){const r=toRaw(this);return track(r,"has",t),r.hasOwnProperty(t)}class BaseReactiveHandler{constructor(r=!1,e=!1){this._isReadonly=r,this._isShallow=e}get(r,e,n){const g=this._isReadonly,y=this._isShallow;if(e==="__v_isReactive")return!g;if(e==="__v_isReadonly")return g;if(e==="__v_isShallow")return y;if(e==="__v_raw")return n===(g?y?shallowReadonlyMap:readonlyMap:y?shallowReactiveMap:reactiveMap).get(r)||Object.getPrototypeOf(r)===Object.getPrototypeOf(n)?r:void 0;const i=isArray$3(r);if(!g){if(i&&hasOwn(arrayInstrumentations,e))return Reflect.get(arrayInstrumentations,e,n);if(e==="hasOwnProperty")return hasOwnProperty$e}const k=Reflect.get(r,e,n);return(isSymbol$1(e)?builtInSymbols.has(e):isNonTrackableKeys(e))||(g||track(r,"get",e),y)?k:isRef(k)?i&&isIntegerKey(e)?k:k.value:isObject$2(k)?g?readonly(k):reactive(k):k}}class MutableReactiveHandler extends BaseReactiveHandler{constructor(r=!1){super(!1,r)}set(r,e,n,g){let y=r[e];if(!this._isShallow){const L=isReadonly(y);if(!isShallow(n)&&!isReadonly(n)&&(y=toRaw(y),n=toRaw(n)),!isArray$3(r)&&isRef(y)&&!isRef(n))return L?!1:(y.value=n,!0)}const i=isArray$3(r)&&isIntegerKey(e)?Number(e)<r.length:hasOwn(r,e),k=Reflect.set(r,e,n,g);return r===toRaw(g)&&(i?hasChanged(n,y)&&trigger(r,"set",e,n):trigger(r,"add",e,n)),k}deleteProperty(r,e){const n=hasOwn(r,e);r[e];const g=Reflect.deleteProperty(r,e);return g&&n&&trigger(r,"delete",e,void 0),g}has(r,e){const n=Reflect.has(r,e);return(!isSymbol$1(e)||!builtInSymbols.has(e))&&track(r,"has",e),n}ownKeys(r){return track(r,"iterate",isArray$3(r)?"length":ITERATE_KEY),Reflect.ownKeys(r)}}class ReadonlyReactiveHandler extends BaseReactiveHandler{constructor(r=!1){super(!0,r)}set(r,e){return!0}deleteProperty(r,e){return!0}}const mutableHandlers=new MutableReactiveHandler,readonlyHandlers=new ReadonlyReactiveHandler,shallowReactiveHandlers=new MutableReactiveHandler(!0),toShallow=t=>t,getProto=t=>Reflect.getPrototypeOf(t);function get$1(t,r,e=!1,n=!1){t=t.__v_raw;const g=toRaw(t),y=toRaw(r);e||(hasChanged(r,y)&&track(g,"get",r),track(g,"get",y));const{has:i}=getProto(g),k=n?toShallow:e?toReadonly:toReactive;if(i.call(g,r))return k(t.get(r));if(i.call(g,y))return k(t.get(y));t!==g&&t.get(r)}function has(t,r=!1){const e=this.__v_raw,n=toRaw(e),g=toRaw(t);return r||(hasChanged(t,g)&&track(n,"has",t),track(n,"has",g)),t===g?e.has(t):e.has(t)||e.has(g)}function size(t,r=!1){return t=t.__v_raw,!r&&track(toRaw(t),"iterate",ITERATE_KEY),Reflect.get(t,"size",t)}function add(t){t=toRaw(t);const r=toRaw(this);return getProto(r).has.call(r,t)||(r.add(t),trigger(r,"add",t,t)),this}function set$1(t,r){r=toRaw(r);const e=toRaw(this),{has:n,get:g}=getProto(e);let y=n.call(e,t);y||(t=toRaw(t),y=n.call(e,t));const i=g.call(e,t);return e.set(t,r),y?hasChanged(r,i)&&trigger(e,"set",t,r):trigger(e,"add",t,r),this}function deleteEntry(t){const r=toRaw(this),{has:e,get:n}=getProto(r);let g=e.call(r,t);g||(t=toRaw(t),g=e.call(r,t)),n&&n.call(r,t);const y=r.delete(t);return g&&trigger(r,"delete",t,void 0),y}function clear(){const t=toRaw(this),r=t.size!==0,e=t.clear();return r&&trigger(t,"clear",void 0,void 0),e}function createForEach(t,r){return function(n,g){const y=this,i=y.__v_raw,k=toRaw(i),L=r?toShallow:t?toReadonly:toReactive;return!t&&track(k,"iterate",ITERATE_KEY),i.forEach(($,V)=>n.call(g,L($),L(V),y))}}function createIterableMethod(t,r,e){return function(...n){const g=this.__v_raw,y=toRaw(g),i=isMap$2(y),k=t==="entries"||t===Symbol.iterator&&i,L=t==="keys"&&i,$=g[t](...n),V=e?toShallow:r?toReadonly:toReactive;return!r&&track(y,"iterate",L?MAP_KEY_ITERATE_KEY:ITERATE_KEY),{next(){const{value:z,done:re}=$.next();return re?{value:z,done:re}:{value:k?[V(z[0]),V(z[1])]:V(z),done:re}},[Symbol.iterator](){return this}}}}function createReadonlyMethod(t){return function(...r){return t==="delete"?!1:t==="clear"?void 0:this}}function createInstrumentations(){const t={get(y){return get$1(this,y)},get size(){return size(this)},has,add,set:set$1,delete:deleteEntry,clear,forEach:createForEach(!1,!1)},r={get(y){return get$1(this,y,!1,!0)},get size(){return size(this)},has,add,set:set$1,delete:deleteEntry,clear,forEach:createForEach(!1,!0)},e={get(y){return get$1(this,y,!0)},get size(){return size(this,!0)},has(y){return has.call(this,y,!0)},add:createReadonlyMethod("add"),set:createReadonlyMethod("set"),delete:createReadonlyMethod("delete"),clear:createReadonlyMethod("clear"),forEach:createForEach(!0,!1)},n={get(y){return get$1(this,y,!0,!0)},get size(){return size(this,!0)},has(y){return has.call(this,y,!0)},add:createReadonlyMethod("add"),set:createReadonlyMethod("set"),delete:createReadonlyMethod("delete"),clear:createReadonlyMethod("clear"),forEach:createForEach(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach(y=>{t[y]=createIterableMethod(y,!1,!1),e[y]=createIterableMethod(y,!0,!1),r[y]=createIterableMethod(y,!1,!0),n[y]=createIterableMethod(y,!0,!0)}),[t,e,r,n]}const[mutableInstrumentations,readonlyInstrumentations,shallowInstrumentations,shallowReadonlyInstrumentations]=createInstrumentations();function createInstrumentationGetter(t,r){const e=r?t?shallowReadonlyInstrumentations:shallowInstrumentations:t?readonlyInstrumentations:mutableInstrumentations;return(n,g,y)=>g==="__v_isReactive"?!t:g==="__v_isReadonly"?t:g==="__v_raw"?n:Reflect.get(hasOwn(e,g)&&g in n?e:n,g,y)}const mutableCollectionHandlers={get:createInstrumentationGetter(!1,!1)},shallowCollectionHandlers={get:createInstrumentationGetter(!1,!0)},readonlyCollectionHandlers={get:createInstrumentationGetter(!0,!1)},reactiveMap=new WeakMap,shallowReactiveMap=new WeakMap,readonlyMap=new WeakMap,shallowReadonlyMap=new WeakMap;function targetTypeMap(t){switch(t){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function getTargetType(t){return t.__v_skip||!Object.isExtensible(t)?0:targetTypeMap(toRawType(t))}function reactive(t){return isReadonly(t)?t:createReactiveObject(t,!1,mutableHandlers,mutableCollectionHandlers,reactiveMap)}function shallowReactive(t){return createReactiveObject(t,!1,shallowReactiveHandlers,shallowCollectionHandlers,shallowReactiveMap)}function readonly(t){return createReactiveObject(t,!0,readonlyHandlers,readonlyCollectionHandlers,readonlyMap)}function createReactiveObject(t,r,e,n,g){if(!isObject$2(t)||t.__v_raw&&!(r&&t.__v_isReactive))return t;const y=g.get(t);if(y)return y;const i=getTargetType(t);if(i===0)return t;const k=new Proxy(t,i===2?n:e);return g.set(t,k),k}function isReactive(t){return isReadonly(t)?isReactive(t.__v_raw):!!(t&&t.__v_isReactive)}function isReadonly(t){return!!(t&&t.__v_isReadonly)}function isShallow(t){return!!(t&&t.__v_isShallow)}function isProxy(t){return isReactive(t)||isReadonly(t)}function toRaw(t){const r=t&&t.__v_raw;return r?toRaw(r):t}function markRaw(t){return Object.isExtensible(t)&&def(t,"__v_skip",!0),t}const toReactive=t=>isObject$2(t)?reactive(t):t,toReadonly=t=>isObject$2(t)?readonly(t):t;class ComputedRefImpl{constructor(r,e,n,g){this.getter=r,this._setter=e,this.dep=void 0,this.__v_isRef=!0,this.__v_isReadonly=!1,this.effect=new ReactiveEffect(()=>r(this._value),()=>triggerRefValue(this,this.effect._dirtyLevel===2?2:3)),this.effect.computed=this,this.effect.active=this._cacheable=!g,this.__v_isReadonly=n}get value(){const r=toRaw(this);return(!r._cacheable||r.effect.dirty)&&hasChanged(r._value,r._value=r.effect.run())&&triggerRefValue(r,4),trackRefValue(r),r.effect._dirtyLevel>=2&&triggerRefValue(r,2),r._value}set value(r){this._setter(r)}get _dirty(){return this.effect.dirty}set _dirty(r){this.effect.dirty=r}}function computed$1(t,r,e=!1){let n,g;const y=isFunction$3(t);return y?(n=t,g=NOOP):(n=t.get,g=t.set),new ComputedRefImpl(n,g,y||!g,e)}function trackRefValue(t){var r;shouldTrack&&activeEffect&&(t=toRaw(t),trackEffect(activeEffect,(r=t.dep)!=null?r:t.dep=createDep(()=>t.dep=void 0,t instanceof ComputedRefImpl?t:void 0)))}function triggerRefValue(t,r=4,e){t=toRaw(t);const n=t.dep;n&&triggerEffects(n,r)}function isRef(t){return!!(t&&t.__v_isRef===!0)}function ref(t){return createRef(t,!1)}function shallowRef(t){return createRef(t,!0)}function createRef(t,r){return isRef(t)?t:new RefImpl(t,r)}class RefImpl{constructor(r,e){this.__v_isShallow=e,this.dep=void 0,this.__v_isRef=!0,this._rawValue=e?r:toRaw(r),this._value=e?r:toReactive(r)}get value(){return trackRefValue(this),this._value}set value(r){const e=this.__v_isShallow||isShallow(r)||isReadonly(r);r=e?r:toRaw(r),hasChanged(r,this._rawValue)&&(this._rawValue=r,this._value=e?r:toReactive(r),triggerRefValue(this,4))}}function unref(t){return isRef(t)?t.value:t}const shallowUnwrapHandlers={get:(t,r,e)=>unref(Reflect.get(t,r,e)),set:(t,r,e,n)=>{const g=t[r];return isRef(g)&&!isRef(e)?(g.value=e,!0):Reflect.set(t,r,e,n)}};function proxyRefs(t){return isReactive(t)?t:new Proxy(t,shallowUnwrapHandlers)}function toRefs(t){const r=isArray$3(t)?new Array(t.length):{};for(const e in t)r[e]=propertyToRef(t,e);return r}class ObjectRefImpl{constructor(r,e,n){this._object=r,this._key=e,this._defaultValue=n,this.__v_isRef=!0}get value(){const r=this._object[this._key];return r===void 0?this._defaultValue:r}set value(r){this._object[this._key]=r}get dep(){return getDepFromReactive(toRaw(this._object),this._key)}}class GetterRefImpl{constructor(r){this._getter=r,this.__v_isRef=!0,this.__v_isReadonly=!0}get value(){return this._getter()}}function toRef(t,r,e){return isRef(t)?t:isFunction$3(t)?new GetterRefImpl(t):isObject$2(t)&&arguments.length>1?propertyToRef(t,r,e):ref(t)}function propertyToRef(t,r,e){const n=t[r];return isRef(n)?n:new ObjectRefImpl(t,r,e)}/**
* @vue/runtime-core v3.4.20
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/const stack=[];function warn$1(t,...r){pauseTracking();const e=stack.length?stack[stack.length-1].component:null,n=e&&e.appContext.config.warnHandler,g=getComponentTrace();if(n)callWithErrorHandling(n,e,11,[t+r.join(""),e&&e.proxy,g.map(({vnode:y})=>`at <${formatComponentName(e,y.type)}>`).join(`
`),g]);else{const y=[`[Vue warn]: ${t}`,...r];g.length&&y.push(`
`,...formatTrace(g)),console.warn(...y)}resetTracking()}function getComponentTrace(){let t=stack[stack.length-1];if(!t)return[];const r=[];for(;t;){const e=r[0];e&&e.vnode===t?e.recurseCount++:r.push({vnode:t,recurseCount:0});const n=t.component&&t.component.parent;t=n&&n.vnode}return r}function formatTrace(t){const r=[];return t.forEach((e,n)=>{r.push(...n===0?[]:[`
`],...formatTraceEntry(e))}),r}function formatTraceEntry({vnode:t,recurseCount:r}){const e=r>0?`... (${r} recursive calls)`:"",n=t.component?t.component.parent==null:!1,g=` at <${formatComponentName(t.component,t.type,n)}`,y=">"+e;return t.props?[g,...formatProps(t.props),y]:[g+y]}function formatProps(t){const r=[],e=Object.keys(t);return e.slice(0,3).forEach(n=>{r.push(...formatProp(n,t[n]))}),e.length>3&&r.push(" ..."),r}function formatProp(t,r,e){return isString$2(r)?(r=JSON.stringify(r),e?r:[`${t}=${r}`]):typeof r=="number"||typeof r=="boolean"||r==null?e?r:[`${t}=${r}`]:isRef(r)?(r=formatProp(t,toRaw(r.value),!0),e?r:[`${t}=Ref<`,r,">"]):isFunction$3(r)?[`${t}=fn${r.name?`<${r.name}>`:""}`]:(r=toRaw(r),e?r:[`${t}=`,r])}function callWithErrorHandling(t,r,e,n){try{return n?t(...n):t()}catch(g){handleError(g,r,e)}}function callWithAsyncErrorHandling(t,r,e,n){if(isFunction$3(t)){const y=callWithErrorHandling(t,r,e,n);return y&&isPromise(y)&&y.catch(i=>{handleError(i,r,e)}),y}const g=[];for(let y=0;y<t.length;y++)g.push(callWithAsyncErrorHandling(t[y],r,e,n));return g}function handleError(t,r,e,n=!0){const g=r?r.vnode:null;if(r){let y=r.parent;const i=r.proxy,k=`https://vuejs.org/error-reference/#runtime-${e}`;for(;y;){const $=y.ec;if($){for(let V=0;V<$.length;V++)if($[V](t,i,k)===!1)return}y=y.parent}const L=r.appContext.config.errorHandler;if(L){callWithErrorHandling(L,null,10,[t,i,k]);return}}logError(t,e,g,n)}function logError(t,r,e,n=!0){console.error(t)}let isFlushing=!1,isFlushPending=!1;const queue=[];let flushIndex=0;const pendingPostFlushCbs=[];let activePostFlushCbs=null,postFlushIndex=0;const resolvedPromise=Promise.resolve();let currentFlushPromise=null;function nextTick(t){const r=currentFlushPromise||resolvedPromise;return t?r.then(this?t.bind(this):t):r}function findInsertionIndex(t){let r=flushIndex+1,e=queue.length;for(;r<e;){const n=r+e>>>1,g=queue[n],y=getId(g);y<t||y===t&&g.pre?r=n+1:e=n}return r}function queueJob(t){(!queue.length||!queue.includes(t,isFlushing&&t.allowRecurse?flushIndex+1:flushIndex))&&(t.id==null?queue.push(t):queue.splice(findInsertionIndex(t.id),0,t),queueFlush())}function queueFlush(){!isFlushing&&!isFlushPending&&(isFlushPending=!0,currentFlushPromise=resolvedPromise.then(flushJobs))}function invalidateJob(t){const r=queue.indexOf(t);r>flushIndex&&queue.splice(r,1)}function queuePostFlushCb(t){isArray$3(t)?pendingPostFlushCbs.push(...t):(!activePostFlushCbs||!activePostFlushCbs.includes(t,t.allowRecurse?postFlushIndex+1:postFlushIndex))&&pendingPostFlushCbs.push(t),queueFlush()}function flushPreFlushCbs(t,r,e=isFlushing?flushIndex+1:0){for(;e<queue.length;e++){const n=queue[e];if(n&&n.pre){if(t&&n.id!==t.uid)continue;queue.splice(e,1),e--,n()}}}function flushPostFlushCbs(t){if(pendingPostFlushCbs.length){const r=[...new Set(pendingPostFlushCbs)].sort((e,n)=>getId(e)-getId(n));if(pendingPostFlushCbs.length=0,activePostFlushCbs){activePostFlushCbs.push(...r);return}for(activePostFlushCbs=r,postFlushIndex=0;postFlushIndex<activePostFlushCbs.length;postFlushIndex++)activePostFlushCbs[postFlushIndex]();activePostFlushCbs=null,postFlushIndex=0}}const getId=t=>t.id==null?1/0:t.id,comparator=(t,r)=>{const e=getId(t)-getId(r);if(e===0){if(t.pre&&!r.pre)return-1;if(r.pre&&!t.pre)return 1}return e};function flushJobs(t){isFlushPending=!1,isFlushing=!0,queue.sort(comparator);const r=NOOP;try{for(flushIndex=0;flushIndex<queue.length;flushIndex++){const e=queue[flushIndex];e&&e.active!==!1&&callWithErrorHandling(e,null,14)}}finally{flushIndex=0,queue.length=0,flushPostFlushCbs(),isFlushing=!1,currentFlushPromise=null,(queue.length||pendingPostFlushCbs.length)&&flushJobs()}}function emit(t,r,...e){if(t.isUnmounted)return;const n=t.vnode.props||EMPTY_OBJ;let g=e;const y=r.startsWith("update:"),i=y&&r.slice(7);if(i&&i in n){const V=`${i==="modelValue"?"model":i}Modifiers`,{number:z,trim:re}=n[V]||EMPTY_OBJ;re&&(g=e.map(oe=>isString$2(oe)?oe.trim():oe)),z&&(g=e.map(looseToNumber))}let k,L=n[k=toHandlerKey(r)]||n[k=toHandlerKey(camelize(r))];!L&&y&&(L=n[k=toHandlerKey(hyphenate(r))]),L&&callWithAsyncErrorHandling(L,t,6,g);const $=n[k+"Once"];if($){if(!t.emitted)t.emitted={};else if(t.emitted[k])return;t.emitted[k]=!0,callWithAsyncErrorHandling($,t,6,g)}}function normalizeEmitsOptions(t,r,e=!1){const n=r.emitsCache,g=n.get(t);if(g!==void 0)return g;const y=t.emits;let i={},k=!1;if(!isFunction$3(t)){const L=$=>{const V=normalizeEmitsOptions($,r,!0);V&&(k=!0,extend$1(i,V))};!e&&r.mixins.length&&r.mixins.forEach(L),t.extends&&L(t.extends),t.mixins&&t.mixins.forEach(L)}return!y&&!k?(isObject$2(t)&&n.set(t,null),null):(isArray$3(y)?y.forEach(L=>i[L]=null):extend$1(i,y),isObject$2(t)&&n.set(t,i),i)}function isEmitListener(t,r){return!t||!isOn(r)?!1:(r=r.slice(2).replace(/Once$/,""),hasOwn(t,r[0].toLowerCase()+r.slice(1))||hasOwn(t,hyphenate(r))||hasOwn(t,r))}let currentRenderingInstance=null,currentScopeId=null;function setCurrentRenderingInstance(t){const r=currentRenderingInstance;return currentRenderingInstance=t,currentScopeId=t&&t.type.__scopeId||null,r}function withCtx(t,r=currentRenderingInstance,e){if(!r||t._n)return t;const n=(...g)=>{n._d&&setBlockTracking(-1);const y=setCurrentRenderingInstance(r);let i;try{i=t(...g)}finally{setCurrentRenderingInstance(y),n._d&&setBlockTracking(1)}return i};return n._n=!0,n._c=!0,n._d=!0,n}function markAttrsAccessed(){}function renderComponentRoot(t){const{type:r,vnode:e,proxy:n,withProxy:g,props:y,propsOptions:[i],slots:k,attrs:L,emit:$,render:V,renderCache:z,data:re,setupState:oe,ctx:le,inheritAttrs:ue}=t;let ie,ae;const Ie=setCurrentRenderingInstance(t);try{if(e.shapeFlag&4){const Ce=g||n,Ue=Ce;ie=normalizeVNode(V.call(Ue,Ce,z,y,oe,re,le)),ae=L}else{const Ce=r;ie=normalizeVNode(Ce.length>1?Ce(y,{attrs:L,slots:k,emit:$}):Ce(y,null)),ae=r.props?L:getFunctionalFallthrough(L)}}catch(Ce){blockStack.length=0,handleError(Ce,t,1),ie=createVNode(Comment)}let de=ie;if(ae&&ue!==!1){const Ce=Object.keys(ae),{shapeFlag:Ue}=de;Ce.length&&Ue&7&&(i&&Ce.some(isModelListener)&&(ae=filterModelListeners(ae,i)),de=cloneVNode(de,ae))}return e.dirs&&(de=cloneVNode(de),de.dirs=de.dirs?de.dirs.concat(e.dirs):e.dirs),e.transition&&(de.transition=e.transition),ie=de,setCurrentRenderingInstance(Ie),ie}const getFunctionalFallthrough=t=>{let r;for(const e in t)(e==="class"||e==="style"||isOn(e))&&((r||(r={}))[e]=t[e]);return r},filterModelListeners=(t,r)=>{const e={};for(const n in t)(!isModelListener(n)||!(n.slice(9)in r))&&(e[n]=t[n]);return e};function shouldUpdateComponent(t,r,e){const{props:n,children:g,component:y}=t,{props:i,children:k,patchFlag:L}=r,$=y.emitsOptions;if(r.dirs||r.transition)return!0;if(e&&L>=0){if(L&1024)return!0;if(L&16)return n?hasPropsChanged(n,i,$):!!i;if(L&8){const V=r.dynamicProps;for(let z=0;z<V.length;z++){const re=V[z];if(i[re]!==n[re]&&!isEmitListener($,re))return!0}}}else return(g||k)&&(!k||!k.$stable)?!0:n===i?!1:n?i?hasPropsChanged(n,i,$):!0:!!i;return!1}function hasPropsChanged(t,r,e){const n=Object.keys(r);if(n.length!==Object.keys(t).length)return!0;for(let g=0;g<n.length;g++){const y=n[g];if(r[y]!==t[y]&&!isEmitListener(e,y))return!0}return!1}function updateHOCHostEl({vnode:t,parent:r},e){for(;r;){const n=r.subTree;if(n.suspense&&n.suspense.activeBranch===t&&(n.el=t.el),n===t)(t=r.vnode).el=e,r=r.parent;else break}}const COMPONENTS="components",DIRECTIVES="directives";function resolveComponent(t,r){return resolveAsset(COMPONENTS,t,!0,r)||t}const NULL_DYNAMIC_COMPONENT=Symbol.for("v-ndc");function resolveDynamicComponent(t){return isString$2(t)?resolveAsset(COMPONENTS,t,!1)||t:t||NULL_DYNAMIC_COMPONENT}function resolveDirective(t){return resolveAsset(DIRECTIVES,t)}function resolveAsset(t,r,e=!0,n=!1){const g=currentRenderingInstance||currentInstance;if(g){const y=g.type;if(t===COMPONENTS){const k=getComponentName(y,!1);if(k&&(k===r||k===camelize(r)||k===capitalize$1(camelize(r))))return y}const i=resolve(g[t]||y[t],r)||resolve(g.appContext[t],r);return!i&&n?y:i}}function resolve(t,r){return t&&(t[r]||t[camelize(r)]||t[capitalize$1(camelize(r))])}const isSuspense=t=>t.__isSuspense;function queueEffectWithSuspense(t,r){r&&r.pendingBranch?isArray$3(t)?r.effects.push(...t):r.effects.push(t):queuePostFlushCb(t)}const ssrContextKey=Symbol.for("v-scx"),useSSRContext=()=>inject(ssrContextKey);function watchEffect(t,r){return doWatch(t,null,r)}const INITIAL_WATCHER_VALUE={};function watch(t,r,e){return doWatch(t,r,e)}function doWatch(t,r,{immediate:e,deep:n,flush:g,once:y,onTrack:i,onTrigger:k}=EMPTY_OBJ){if(r&&y){const qe=r;r=(...jt)=>{qe(...jt),Ue()}}const L=currentInstance,$=qe=>n===!0?qe:traverse(qe,n===!1?1:void 0);let V,z=!1,re=!1;if(isRef(t)?(V=()=>t.value,z=isShallow(t)):isReactive(t)?(V=()=>$(t),z=!0):isArray$3(t)?(re=!0,z=t.some(qe=>isReactive(qe)||isShallow(qe)),V=()=>t.map(qe=>{if(isRef(qe))return qe.value;if(isReactive(qe))return $(qe);if(isFunction$3(qe))return callWithErrorHandling(qe,L,2)})):isFunction$3(t)?r?V=()=>callWithErrorHandling(t,L,2):V=()=>(oe&&oe(),callWithAsyncErrorHandling(t,L,3,[le])):V=NOOP,r&&n){const qe=V;V=()=>traverse(qe())}let oe,le=qe=>{oe=de.onStop=()=>{callWithErrorHandling(qe,L,4),oe=de.onStop=void 0}},ue;if(isInSSRComponentSetup)if(le=NOOP,r?e&&callWithAsyncErrorHandling(r,L,3,[V(),re?[]:void 0,le]):V(),g==="sync"){const qe=useSSRContext();ue=qe.__watcherHandles||(qe.__watcherHandles=[])}else return NOOP;let ie=re?new Array(t.length).fill(INITIAL_WATCHER_VALUE):INITIAL_WATCHER_VALUE;const ae=()=>{if(!(!de.active||!de.dirty))if(r){const qe=de.run();(n||z||(re?qe.some((jt,Fe)=>hasChanged(jt,ie[Fe])):hasChanged(qe,ie)))&&(oe&&oe(),callWithAsyncErrorHandling(r,L,3,[qe,ie===INITIAL_WATCHER_VALUE?void 0:re&&ie[0]===INITIAL_WATCHER_VALUE?[]:ie,le]),ie=qe)}else de.run()};ae.allowRecurse=!!r;let Ie;g==="sync"?Ie=ae:g==="post"?Ie=()=>queuePostRenderEffect(ae,L&&L.suspense):(ae.pre=!0,L&&(ae.id=L.uid),Ie=()=>queueJob(ae));const de=new ReactiveEffect(V,NOOP,Ie),Ce=getCurrentScope(),Ue=()=>{de.stop(),Ce&&remove(Ce.effects,de)};return r?e?ae():ie=de.run():g==="post"?queuePostRenderEffect(de.run.bind(de),L&&L.suspense):de.run(),ue&&ue.push(Ue),Ue}function instanceWatch(t,r,e){const n=this.proxy,g=isString$2(t)?t.includes(".")?createPathGetter(n,t):()=>n[t]:t.bind(n,n);let y;isFunction$3(r)?y=r:(y=r.handler,e=r);const i=setCurrentInstance(this),k=doWatch(g,y.bind(n),e);return i(),k}function createPathGetter(t,r){const e=r.split(".");return()=>{let n=t;for(let g=0;g<e.length&&n;g++)n=n[e[g]];return n}}function traverse(t,r,e=0,n){if(!isObject$2(t)||t.__v_skip)return t;if(r&&r>0){if(e>=r)return t;e++}if(n=n||new Set,n.has(t))return t;if(n.add(t),isRef(t))traverse(t.value,r,e,n);else if(isArray$3(t))for(let g=0;g<t.length;g++)traverse(t[g],r,e,n);else if(isSet$2(t)||isMap$2(t))t.forEach(g=>{traverse(g,r,e,n)});else if(isPlainObject$2(t))for(const g in t)traverse(t[g],r,e,n);return t}function withDirectives(t,r){if(currentRenderingInstance===null)return t;const e=getExposeProxy(currentRenderingInstance)||currentRenderingInstance.proxy,n=t.dirs||(t.dirs=[]);for(let g=0;g<r.length;g++){let[y,i,k,L=EMPTY_OBJ]=r[g];y&&(isFunction$3(y)&&(y={mounted:y,updated:y}),y.deep&&traverse(i),n.push({dir:y,instance:e,value:i,oldValue:void 0,arg:k,modifiers:L}))}return t}function invokeDirectiveHook(t,r,e,n){const g=t.dirs,y=r&&r.dirs;for(let i=0;i<g.length;i++){const k=g[i];y&&(k.oldValue=y[i].value);let L=k.dir[n];L&&(pauseTracking(),callWithAsyncErrorHandling(L,e,8,[t.el,k,t,r]),resetTracking())}}const leaveCbKey=Symbol("_leaveCb"),enterCbKey$1=Symbol("_enterCb");function useTransitionState(){const t={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return onMounted(()=>{t.isMounted=!0}),onBeforeUnmount(()=>{t.isUnmounting=!0}),t}const TransitionHookValidator=[Function,Array],BaseTransitionPropsValidators={mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:TransitionHookValidator,onEnter:TransitionHookValidator,onAfterEnter:TransitionHookValidator,onEnterCancelled:TransitionHookValidator,onBeforeLeave:TransitionHookValidator,onLeave:TransitionHookValidator,onAfterLeave:TransitionHookValidator,onLeaveCancelled:TransitionHookValidator,onBeforeAppear:TransitionHookValidator,onAppear:TransitionHookValidator,onAfterAppear:TransitionHookValidator,onAppearCancelled:TransitionHookValidator},BaseTransitionImpl={name:"BaseTransition",props:BaseTransitionPropsValidators,setup(t,{slots:r}){const e=getCurrentInstance(),n=useTransitionState();return()=>{const g=r.default&&getTransitionRawChildren(r.default(),!0);if(!g||!g.length)return;let y=g[0];if(g.length>1){for(const re of g)if(re.type!==Comment){y=re;break}}const i=toRaw(t),{mode:k}=i;if(n.isLeaving)return emptyPlaceholder(y);const L=getKeepAliveChild(y);if(!L)return emptyPlaceholder(y);const $=resolveTransitionHooks(L,i,n,e);setTransitionHooks(L,$);const V=e.subTree,z=V&&getKeepAliveChild(V);if(z&&z.type!==Comment&&!isSameVNodeType(L,z)){const re=resolveTransitionHooks(z,i,n,e);if(setTransitionHooks(z,re),k==="out-in")return n.isLeaving=!0,re.afterLeave=()=>{n.isLeaving=!1,e.update.active!==!1&&(e.effect.dirty=!0,e.update())},emptyPlaceholder(y);k==="in-out"&&L.type!==Comment&&(re.delayLeave=(oe,le,ue)=>{const ie=getLeavingNodesForType(n,z);ie[String(z.key)]=z,oe[leaveCbKey]=()=>{le(),oe[leaveCbKey]=void 0,delete $.delayedLeave},$.delayedLeave=ue})}return y}}},BaseTransition=BaseTransitionImpl;function getLeavingNodesForType(t,r){const{leavingVNodes:e}=t;let n=e.get(r.type);return n||(n=Object.create(null),e.set(r.type,n)),n}function resolveTransitionHooks(t,r,e,n){const{appear:g,mode:y,persisted:i=!1,onBeforeEnter:k,onEnter:L,onAfterEnter:$,onEnterCancelled:V,onBeforeLeave:z,onLeave:re,onAfterLeave:oe,onLeaveCancelled:le,onBeforeAppear:ue,onAppear:ie,onAfterAppear:ae,onAppearCancelled:Ie}=r,de=String(t.key),Ce=getLeavingNodesForType(e,t),Ue=(Fe,Et)=>{Fe&&callWithAsyncErrorHandling(Fe,n,9,Et)},qe=(Fe,Et)=>{const cr=Et[1];Ue(Fe,Et),isArray$3(Fe)?Fe.every(er=>er.length<=1)&&cr():Fe.length<=1&&cr()},jt={mode:y,persisted:i,beforeEnter(Fe){let Et=k;if(!e.isMounted)if(g)Et=ue||k;else return;Fe[leaveCbKey]&&Fe[leaveCbKey](!0);const cr=Ce[de];cr&&isSameVNodeType(t,cr)&&cr.el[leaveCbKey]&&cr.el[leaveCbKey](),Ue(Et,[Fe])},enter(Fe){let Et=L,cr=$,er=V;if(!e.isMounted)if(g)Et=ie||L,cr=ae||$,er=Ie||V;else return;let nr=!1;const dr=Fe[enterCbKey$1]=ir=>{nr||(nr=!0,ir?Ue(er,[Fe]):Ue(cr,[Fe]),jt.delayedLeave&&jt.delayedLeave(),Fe[enterCbKey$1]=void 0)};Et?qe(Et,[Fe,dr]):dr()},leave(Fe,Et){const cr=String(t.key);if(Fe[enterCbKey$1]&&Fe[enterCbKey$1](!0),e.isUnmounting)return Et();Ue(z,[Fe]);let er=!1;const nr=Fe[leaveCbKey]=dr=>{er||(er=!0,Et(),dr?Ue(le,[Fe]):Ue(oe,[Fe]),Fe[leaveCbKey]=void 0,Ce[cr]===t&&delete Ce[cr])};Ce[cr]=t,re?qe(re,[Fe,nr]):nr()},clone(Fe){return resolveTransitionHooks(Fe,r,e,n)}};return jt}function emptyPlaceholder(t){if(isKeepAlive(t))return t=cloneVNode(t),t.children=null,t}function getKeepAliveChild(t){return isKeepAlive(t)?t.children?t.children[0]:void 0:t}function setTransitionHooks(t,r){t.shapeFlag&6&&t.component?setTransitionHooks(t.component.subTree,r):t.shapeFlag&128?(t.ssContent.transition=r.clone(t.ssContent),t.ssFallback.transition=r.clone(t.ssFallback)):t.transition=r}function getTransitionRawChildren(t,r=!1,e){let n=[],g=0;for(let y=0;y<t.length;y++){let i=t[y];const k=e==null?i.key:String(e)+String(i.key!=null?i.key:y);i.type===Fragment?(i.patchFlag&128&&g++,n=n.concat(getTransitionRawChildren(i.children,r,k))):(r||i.type!==Comment)&&n.push(k!=null?cloneVNode(i,{key:k}):i)}if(g>1)for(let y=0;y<n.length;y++)n[y].patchFlag=-2;return n}/*! #__NO_SIDE_EFFECTS__ */function defineComponent(t,r){return isFunction$3(t)?(()=>extend$1({name:t.name},r,{setup:t}))():t}const isAsyncWrapper=t=>!!t.type.__asyncLoader,isKeepAlive=t=>t.type.__isKeepAlive;function onActivated(t,r){registerKeepAliveHook(t,"a",r)}function onDeactivated(t,r){registerKeepAliveHook(t,"da",r)}function registerKeepAliveHook(t,r,e=currentInstance){const n=t.__wdc||(t.__wdc=()=>{let g=e;for(;g;){if(g.isDeactivated)return;g=g.parent}return t()});if(injectHook(r,n,e),e){let g=e.parent;for(;g&&g.parent;)isKeepAlive(g.parent.vnode)&&injectToKeepAliveRoot(n,r,e,g),g=g.parent}}function injectToKeepAliveRoot(t,r,e,n){const g=injectHook(r,t,n,!0);onUnmounted(()=>{remove(n[r],g)},e)}function injectHook(t,r,e=currentInstance,n=!1){if(e){const g=e[t]||(e[t]=[]),y=r.__weh||(r.__weh=(...i)=>{if(e.isUnmounted)return;pauseTracking();const k=setCurrentInstance(e),L=callWithAsyncErrorHandling(r,e,t,i);return k(),resetTracking(),L});return n?g.unshift(y):g.push(y),y}}const createHook=t=>(r,e=currentInstance)=>(!isInSSRComponentSetup||t==="sp")&&injectHook(t,(...n)=>r(...n),e),onBeforeMount=createHook("bm"),onMounted=createHook("m"),onBeforeUpdate=createHook("bu"),onUpdated=createHook("u"),onBeforeUnmount=createHook("bum"),onUnmounted=createHook("um"),onServerPrefetch=createHook("sp"),onRenderTriggered=createHook("rtg"),onRenderTracked=createHook("rtc");function onErrorCaptured(t,r=currentInstance){injectHook("ec",t,r)}function renderList(t,r,e,n){let g;const y=e&&e[n];if(isArray$3(t)||isString$2(t)){g=new Array(t.length);for(let i=0,k=t.length;i<k;i++)g[i]=r(t[i],i,void 0,y&&y[i])}else if(typeof t=="number"){g=new Array(t);for(let i=0;i<t;i++)g[i]=r(i+1,i,void 0,y&&y[i])}else if(isObject$2(t))if(t[Symbol.iterator])g=Array.from(t,(i,k)=>r(i,k,void 0,y&&y[k]));else{const i=Object.keys(t);g=new Array(i.length);for(let k=0,L=i.length;k<L;k++){const $=i[k];g[k]=r(t[$],$,k,y&&y[k])}}else g=[];return e&&(e[n]=g),g}function createSlots(t,r){for(let e=0;e<r.length;e++){const n=r[e];if(isArray$3(n))for(let g=0;g<n.length;g++)t[n[g].name]=n[g].fn;else n&&(t[n.name]=n.key?(...g)=>{const y=n.fn(...g);return y&&(y.key=n.key),y}:n.fn)}return t}function renderSlot(t,r,e={},n,g){if(currentRenderingInstance.isCE||currentRenderingInstance.parent&&isAsyncWrapper(currentRenderingInstance.parent)&&currentRenderingInstance.parent.isCE)return r!=="default"&&(e.name=r),createVNode("slot",e,n&&n());let y=t[r];y&&y._c&&(y._d=!1),openBlock();const i=y&&ensureValidVNode(y(e)),k=createBlock(Fragment,{key:e.key||i&&i.key||`_${r}`},i||(n?n():[]),i&&t._===1?64:-2);return!g&&k.scopeId&&(k.slotScopeIds=[k.scopeId+"-s"]),y&&y._c&&(y._d=!0),k}function ensureValidVNode(t){return t.some(r=>isVNode(r)?!(r.type===Comment||r.type===Fragment&&!ensureValidVNode(r.children)):!0)?t:null}function toHandlers(t,r){const e={};for(const n in t)e[r&&/[A-Z]/.test(n)?`on:${n}`:toHandlerKey(n)]=t[n];return e}const getPublicInstance=t=>t?isStatefulComponent(t)?getExposeProxy(t)||t.proxy:getPublicInstance(t.parent):null,publicPropertiesMap=extend$1(Object.create(null),{$:t=>t,$el:t=>t.vnode.el,$data:t=>t.data,$props:t=>t.props,$attrs:t=>t.attrs,$slots:t=>t.slots,$refs:t=>t.refs,$parent:t=>getPublicInstance(t.parent),$root:t=>getPublicInstance(t.root),$emit:t=>t.emit,$options:t=>resolveMergedOptions(t),$forceUpdate:t=>t.f||(t.f=()=>{t.effect.dirty=!0,queueJob(t.update)}),$nextTick:t=>t.n||(t.n=nextTick.bind(t.proxy)),$watch:t=>instanceWatch.bind(t)}),hasSetupBinding=(t,r)=>t!==EMPTY_OBJ&&!t.__isScriptSetup&&hasOwn(t,r),PublicInstanceProxyHandlers={get({_:t},r){const{ctx:e,setupState:n,data:g,props:y,accessCache:i,type:k,appContext:L}=t;let $;if(r[0]!=="$"){const oe=i[r];if(oe!==void 0)switch(oe){case 1:return n[r];case 2:return g[r];case 4:return e[r];case 3:return y[r]}else{if(hasSetupBinding(n,r))return i[r]=1,n[r];if(g!==EMPTY_OBJ&&hasOwn(g,r))return i[r]=2,g[r];if(($=t.propsOptions[0])&&hasOwn($,r))return i[r]=3,y[r];if(e!==EMPTY_OBJ&&hasOwn(e,r))return i[r]=4,e[r];shouldCacheAccess&&(i[r]=0)}}const V=publicPropertiesMap[r];let z,re;if(V)return r==="$attrs"&&track(t,"get",r),V(t);if((z=k.__cssModules)&&(z=z[r]))return z;if(e!==EMPTY_OBJ&&hasOwn(e,r))return i[r]=4,e[r];if(re=L.config.globalProperties,hasOwn(re,r))return re[r]},set({_:t},r,e){const{data:n,setupState:g,ctx:y}=t;return hasSetupBinding(g,r)?(g[r]=e,!0):n!==EMPTY_OBJ&&hasOwn(n,r)?(n[r]=e,!0):hasOwn(t.props,r)||r[0]==="$"&&r.slice(1)in t?!1:(y[r]=e,!0)},has({_:{data:t,setupState:r,accessCache:e,ctx:n,appContext:g,propsOptions:y}},i){let k;return!!e[i]||t!==EMPTY_OBJ&&hasOwn(t,i)||hasSetupBinding(r,i)||(k=y[0])&&hasOwn(k,i)||hasOwn(n,i)||hasOwn(publicPropertiesMap,i)||hasOwn(g.config.globalProperties,i)},defineProperty(t,r,e){return e.get!=null?t._.accessCache[r]=0:hasOwn(e,"value")&&this.set(t,r,e.value,null),Reflect.defineProperty(t,r,e)}};function useSlots(){return getContext().slots}function useAttrs$1(){return getContext().attrs}function getContext(){const t=getCurrentInstance();return t.setupContext||(t.setupContext=createSetupContext(t))}function normalizePropsOrEmits(t){return isArray$3(t)?t.reduce((r,e)=>(r[e]=null,r),{}):t}let shouldCacheAccess=!0;function applyOptions(t){const r=resolveMergedOptions(t),e=t.proxy,n=t.ctx;shouldCacheAccess=!1,r.beforeCreate&&callHook$1(r.beforeCreate,t,"bc");const{data:g,computed:y,methods:i,watch:k,provide:L,inject:$,created:V,beforeMount:z,mounted:re,beforeUpdate:oe,updated:le,activated:ue,deactivated:ie,beforeDestroy:ae,beforeUnmount:Ie,destroyed:de,unmounted:Ce,render:Ue,renderTracked:qe,renderTriggered:jt,errorCaptured:Fe,serverPrefetch:Et,expose:cr,inheritAttrs:er,components:nr,directives:dr,filters:ir}=r;if($&&resolveInjections($,n,null),i)for(const or in i){const fr=i[or];isFunction$3(fr)&&(n[or]=fr.bind(e))}if(g){const or=g.call(e,e);isObject$2(or)&&(t.data=reactive(or))}if(shouldCacheAccess=!0,y)for(const or in y){const fr=y[or],lr=isFunction$3(fr)?fr.bind(e,e):isFunction$3(fr.get)?fr.get.bind(e,e):NOOP,gr=!isFunction$3(fr)&&isFunction$3(fr.set)?fr.set.bind(e):NOOP,Sr=computed({get:lr,set:gr});Object.defineProperty(n,or,{enumerable:!0,configurable:!0,get:()=>Sr.value,set:wr=>Sr.value=wr})}if(k)for(const or in k)createWatcher(k[or],n,e,or);if(L){const or=isFunction$3(L)?L.call(e):L;Reflect.ownKeys(or).forEach(fr=>{provide(fr,or[fr])})}V&&callHook$1(V,t,"c");function ur(or,fr){isArray$3(fr)?fr.forEach(lr=>or(lr.bind(e))):fr&&or(fr.bind(e))}if(ur(onBeforeMount,z),ur(onMounted,re),ur(onBeforeUpdate,oe),ur(onUpdated,le),ur(onActivated,ue),ur(onDeactivated,ie),ur(onErrorCaptured,Fe),ur(onRenderTracked,qe),ur(onRenderTriggered,jt),ur(onBeforeUnmount,Ie),ur(onUnmounted,Ce),ur(onServerPrefetch,Et),isArray$3(cr))if(cr.length){const or=t.exposed||(t.exposed={});cr.forEach(fr=>{Object.defineProperty(or,fr,{get:()=>e[fr],set:lr=>e[fr]=lr})})}else t.exposed||(t.exposed={});Ue&&t.render===NOOP&&(t.render=Ue),er!=null&&(t.inheritAttrs=er),nr&&(t.components=nr),dr&&(t.directives=dr)}function resolveInjections(t,r,e=NOOP){isArray$3(t)&&(t=normalizeInject(t));for(const n in t){const g=t[n];let y;isObject$2(g)?"default"in g?y=inject(g.from||n,g.default,!0):y=inject(g.from||n):y=inject(g),isRef(y)?Object.defineProperty(r,n,{enumerable:!0,configurable:!0,get:()=>y.value,set:i=>y.value=i}):r[n]=y}}function callHook$1(t,r,e){callWithAsyncErrorHandling(isArray$3(t)?t.map(n=>n.bind(r.proxy)):t.bind(r.proxy),r,e)}function createWatcher(t,r,e,n){const g=n.includes(".")?createPathGetter(e,n):()=>e[n];if(isString$2(t)){const y=r[t];isFunction$3(y)&&watch(g,y)}else if(isFunction$3(t))watch(g,t.bind(e));else if(isObject$2(t))if(isArray$3(t))t.forEach(y=>createWatcher(y,r,e,n));else{const y=isFunction$3(t.handler)?t.handler.bind(e):r[t.handler];isFunction$3(y)&&watch(g,y,t)}}function resolveMergedOptions(t){const r=t.type,{mixins:e,extends:n}=r,{mixins:g,optionsCache:y,config:{optionMergeStrategies:i}}=t.appContext,k=y.get(r);let L;return k?L=k:!g.length&&!e&&!n?L=r:(L={},g.length&&g.forEach($=>mergeOptions$1(L,$,i,!0)),mergeOptions$1(L,r,i)),isObject$2(r)&&y.set(r,L),L}function mergeOptions$1(t,r,e,n=!1){const{mixins:g,extends:y}=r;y&&mergeOptions$1(t,y,e,!0),g&&g.forEach(i=>mergeOptions$1(t,i,e,!0));for(const i in r)if(!(n&&i==="expose")){const k=internalOptionMergeStrats[i]||e&&e[i];t[i]=k?k(t[i],r[i]):r[i]}return t}const internalOptionMergeStrats={data:mergeDataFn,props:mergeEmitsOrPropsOptions,emits:mergeEmitsOrPropsOptions,methods:mergeObjectOptions,computed:mergeObjectOptions,beforeCreate:mergeAsArray,created:mergeAsArray,beforeMount:mergeAsArray,mounted:mergeAsArray,beforeUpdate:mergeAsArray,updated:mergeAsArray,beforeDestroy:mergeAsArray,beforeUnmount:mergeAsArray,destroyed:mergeAsArray,unmounted:mergeAsArray,activated:mergeAsArray,deactivated:mergeAsArray,errorCaptured:mergeAsArray,serverPrefetch:mergeAsArray,components:mergeObjectOptions,directives:mergeObjectOptions,watch:mergeWatchOptions,provide:mergeDataFn,inject:mergeInject};function mergeDataFn(t,r){return r?t?function(){return extend$1(isFunction$3(t)?t.call(this,this):t,isFunction$3(r)?r.call(this,this):r)}:r:t}function mergeInject(t,r){return mergeObjectOptions(normalizeInject(t),normalizeInject(r))}function normalizeInject(t){if(isArray$3(t)){const r={};for(let e=0;e<t.length;e++)r[t[e]]=t[e];return r}return t}function mergeAsArray(t,r){return t?[...new Set([].concat(t,r))]:r}function mergeObjectOptions(t,r){return t?extend$1(Object.create(null),t,r):r}function mergeEmitsOrPropsOptions(t,r){return t?isArray$3(t)&&isArray$3(r)?[...new Set([...t,...r])]:extend$1(Object.create(null),normalizePropsOrEmits(t),normalizePropsOrEmits(r??{})):r}function mergeWatchOptions(t,r){if(!t)return r;if(!r)return t;const e=extend$1(Object.create(null),t);for(const n in r)e[n]=mergeAsArray(t[n],r[n]);return e}function createAppContext(){return{app:null,config:{isNativeTag:NO,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let uid$1=0;function createAppAPI(t,r){return function(n,g=null){isFunction$3(n)||(n=extend$1({},n)),g!=null&&!isObject$2(g)&&(g=null);const y=createAppContext(),i=new WeakSet;let k=!1;const L=y.app={_uid:uid$1++,_component:n,_props:g,_container:null,_context:y,_instance:null,version,get config(){return y.config},set config($){},use($,...V){return i.has($)||($&&isFunction$3($.install)?(i.add($),$.install(L,...V)):isFunction$3($)&&(i.add($),$(L,...V))),L},mixin($){return y.mixins.includes($)||y.mixins.push($),L},component($,V){return V?(y.components[$]=V,L):y.components[$]},directive($,V){return V?(y.directives[$]=V,L):y.directives[$]},mount($,V,z){if(!k){const re=createVNode(n,g);return re.appContext=y,z===!0?z="svg":z===!1&&(z=void 0),V&&r?r(re,$):t(re,$,z),k=!0,L._container=$,$.__vue_app__=L,getExposeProxy(re.component)||re.component.proxy}},unmount(){k&&(t(null,L._container),delete L._container.__vue_app__)},provide($,V){return y.provides[$]=V,L},runWithContext($){const V=currentApp;currentApp=L;try{return $()}finally{currentApp=V}}};return L}}let currentApp=null;function provide(t,r){if(currentInstance){let e=currentInstance.provides;const n=currentInstance.parent&&currentInstance.parent.provides;n===e&&(e=currentInstance.provides=Object.create(n)),e[t]=r}}function inject(t,r,e=!1){const n=currentInstance||currentRenderingInstance;if(n||currentApp){const g=n?n.parent==null?n.vnode.appContext&&n.vnode.appContext.provides:n.parent.provides:currentApp._context.provides;if(g&&t in g)return g[t];if(arguments.length>1)return e&&isFunction$3(r)?r.call(n&&n.proxy):r}}function initProps(t,r,e,n=!1){const g={},y={};def(y,InternalObjectKey,1),t.propsDefaults=Object.create(null),setFullProps(t,r,g,y);for(const i in t.propsOptions[0])i in g||(g[i]=void 0);e?t.props=n?g:shallowReactive(g):t.type.props?t.props=g:t.props=y,t.attrs=y}function updateProps(t,r,e,n){const{props:g,attrs:y,vnode:{patchFlag:i}}=t,k=toRaw(g),[L]=t.propsOptions;let $=!1;if((n||i>0)&&!(i&16)){if(i&8){const V=t.vnode.dynamicProps;for(let z=0;z<V.length;z++){let re=V[z];if(isEmitListener(t.emitsOptions,re))continue;const oe=r[re];if(L)if(hasOwn(y,re))oe!==y[re]&&(y[re]=oe,$=!0);else{const le=camelize(re);g[le]=resolvePropValue(L,k,le,oe,t,!1)}else oe!==y[re]&&(y[re]=oe,$=!0)}}}else{setFullProps(t,r,g,y)&&($=!0);let V;for(const z in k)(!r||!hasOwn(r,z)&&((V=hyphenate(z))===z||!hasOwn(r,V)))&&(L?e&&(e[z]!==void 0||e[V]!==void 0)&&(g[z]=resolvePropValue(L,k,z,void 0,t,!0)):delete g[z]);if(y!==k)for(const z in y)(!r||!hasOwn(r,z))&&(delete y[z],$=!0)}$&&trigger(t,"set","$attrs")}function setFullProps(t,r,e,n){const[g,y]=t.propsOptions;let i=!1,k;if(r)for(let L in r){if(isReservedProp(L))continue;const $=r[L];let V;g&&hasOwn(g,V=camelize(L))?!y||!y.includes(V)?e[V]=$:(k||(k={}))[V]=$:isEmitListener(t.emitsOptions,L)||(!(L in n)||$!==n[L])&&(n[L]=$,i=!0)}if(y){const L=toRaw(e),$=k||EMPTY_OBJ;for(let V=0;V<y.length;V++){const z=y[V];e[z]=resolvePropValue(g,L,z,$[z],t,!hasOwn($,z))}}return i}function resolvePropValue(t,r,e,n,g,y){const i=t[e];if(i!=null){const k=hasOwn(i,"default");if(k&&n===void 0){const L=i.default;if(i.type!==Function&&!i.skipFactory&&isFunction$3(L)){const{propsDefaults:$}=g;if(e in $)n=$[e];else{const V=setCurrentInstance(g);n=$[e]=L.call(null,r),V()}}else n=L}i[0]&&(y&&!k?n=!1:i[1]&&(n===""||n===hyphenate(e))&&(n=!0))}return n}function normalizePropsOptions(t,r,e=!1){const n=r.propsCache,g=n.get(t);if(g)return g;const y=t.props,i={},k=[];let L=!1;if(!isFunction$3(t)){const V=z=>{L=!0;const[re,oe]=normalizePropsOptions(z,r,!0);extend$1(i,re),oe&&k.push(...oe)};!e&&r.mixins.length&&r.mixins.forEach(V),t.extends&&V(t.extends),t.mixins&&t.mixins.forEach(V)}if(!y&&!L)return isObject$2(t)&&n.set(t,EMPTY_ARR),EMPTY_ARR;if(isArray$3(y))for(let V=0;V<y.length;V++){const z=camelize(y[V]);validatePropName(z)&&(i[z]=EMPTY_OBJ)}else if(y)for(const V in y){const z=camelize(V);if(validatePropName(z)){const re=y[V],oe=i[z]=isArray$3(re)||isFunction$3(re)?{type:re}:extend$1({},re);if(oe){const le=getTypeIndex(Boolean,oe.type),ue=getTypeIndex(String,oe.type);oe[0]=le>-1,oe[1]=ue<0||le<ue,(le>-1||hasOwn(oe,"default"))&&k.push(z)}}}const $=[i,k];return isObject$2(t)&&n.set(t,$),$}function validatePropName(t){return t[0]!=="$"&&!isReservedProp(t)}function getType(t){return t===null?"null":typeof t=="function"?t.name||"":typeof t=="object"&&t.constructor&&t.constructor.name||""}function isSameType(t,r){return getType(t)===getType(r)}function getTypeIndex(t,r){return isArray$3(r)?r.findIndex(e=>isSameType(e,t)):isFunction$3(r)&&isSameType(r,t)?0:-1}const isInternalKey=t=>t[0]==="_"||t==="$stable",normalizeSlotValue=t=>isArray$3(t)?t.map(normalizeVNode):[normalizeVNode(t)],normalizeSlot=(t,r,e)=>{if(r._n)return r;const n=withCtx((...g)=>normalizeSlotValue(r(...g)),e);return n._c=!1,n},normalizeObjectSlots=(t,r,e)=>{const n=t._ctx;for(const g in t){if(isInternalKey(g))continue;const y=t[g];if(isFunction$3(y))r[g]=normalizeSlot(g,y,n);else if(y!=null){const i=normalizeSlotValue(y);r[g]=()=>i}}},normalizeVNodeSlots=(t,r)=>{const e=normalizeSlotValue(r);t.slots.default=()=>e},initSlots=(t,r)=>{if(t.vnode.shapeFlag&32){const e=r._;e?(t.slots=toRaw(r),def(r,"_",e)):normalizeObjectSlots(r,t.slots={})}else t.slots={},r&&normalizeVNodeSlots(t,r);def(t.slots,InternalObjectKey,1)},updateSlots=(t,r,e)=>{const{vnode:n,slots:g}=t;let y=!0,i=EMPTY_OBJ;if(n.shapeFlag&32){const k=r._;k?e&&k===1?y=!1:(extend$1(g,r),!e&&k===1&&delete g._):(y=!r.$stable,normalizeObjectSlots(r,g)),i=r}else r&&(normalizeVNodeSlots(t,r),i={default:1});if(y)for(const k in g)!isInternalKey(k)&&i[k]==null&&delete g[k]};function setRef(t,r,e,n,g=!1){if(isArray$3(t)){t.forEach((re,oe)=>setRef(re,r&&(isArray$3(r)?r[oe]:r),e,n,g));return}if(isAsyncWrapper(n)&&!g)return;const y=n.shapeFlag&4?getExposeProxy(n.component)||n.component.proxy:n.el,i=g?null:y,{i:k,r:L}=t,$=r&&r.r,V=k.refs===EMPTY_OBJ?k.refs={}:k.refs,z=k.setupState;if($!=null&&$!==L&&(isString$2($)?(V[$]=null,hasOwn(z,$)&&(z[$]=null)):isRef($)&&($.value=null)),isFunction$3(L))callWithErrorHandling(L,k,12,[i,V]);else{const re=isString$2(L),oe=isRef(L);if(re||oe){const le=()=>{if(t.f){const ue=re?hasOwn(z,L)?z[L]:V[L]:L.value;g?isArray$3(ue)&&remove(ue,y):isArray$3(ue)?ue.includes(y)||ue.push(y):re?(V[L]=[y],hasOwn(z,L)&&(z[L]=V[L])):(L.value=[y],t.k&&(V[t.k]=L.value))}else re?(V[L]=i,hasOwn(z,L)&&(z[L]=i)):oe&&(L.value=i,t.k&&(V[t.k]=i))};i?(le.id=-1,queuePostRenderEffect(le,e)):le()}}}const queuePostRenderEffect=queueEffectWithSuspense;function createRenderer(t){return baseCreateRenderer(t)}function baseCreateRenderer(t,r){const e=getGlobalThis();e.__VUE__=!0;const{insert:n,remove:g,patchProp:y,createElement:i,createText:k,createComment:L,setText:$,setElementText:V,parentNode:z,nextSibling:re,setScopeId:oe=NOOP,insertStaticContent:le}=t,ue=(hr,Tr,Br,Fr=null,Lr=null,qr=null,Ur=void 0,Qr=null,vn=!!Tr.dynamicChildren)=>{if(hr===Tr)return;hr&&!isSameVNodeType(hr,Tr)&&(Fr=Er(hr),wr(hr,Lr,qr,!0),hr=null),Tr.patchFlag===-2&&(vn=!1,Tr.dynamicChildren=null);const{type:_n,ref:Yr,shapeFlag:jn}=Tr;switch(_n){case Text:ie(hr,Tr,Br,Fr);break;case Comment:ae(hr,Tr,Br,Fr);break;case Static:hr==null&&Ie(Tr,Br,Fr,Ur);break;case Fragment:nr(hr,Tr,Br,Fr,Lr,qr,Ur,Qr,vn);break;default:jn&1?Ue(hr,Tr,Br,Fr,Lr,qr,Ur,Qr,vn):jn&6?dr(hr,Tr,Br,Fr,Lr,qr,Ur,Qr,vn):(jn&64||jn&128)&&_n.process(hr,Tr,Br,Fr,Lr,qr,Ur,Qr,vn,Or)}Yr!=null&&Lr&&setRef(Yr,hr&&hr.ref,qr,Tr||hr,!Tr)},ie=(hr,Tr,Br,Fr)=>{if(hr==null)n(Tr.el=k(Tr.children),Br,Fr);else{const Lr=Tr.el=hr.el;Tr.children!==hr.children&&$(Lr,Tr.children)}},ae=(hr,Tr,Br,Fr)=>{hr==null?n(Tr.el=L(Tr.children||""),Br,Fr):Tr.el=hr.el},Ie=(hr,Tr,Br,Fr)=>{[hr.el,hr.anchor]=le(hr.children,Tr,Br,Fr,hr.el,hr.anchor)},de=({el:hr,anchor:Tr},Br,Fr)=>{let Lr;for(;hr&&hr!==Tr;)Lr=re(hr),n(hr,Br,Fr),hr=Lr;n(Tr,Br,Fr)},Ce=({el:hr,anchor:Tr})=>{let Br;for(;hr&&hr!==Tr;)Br=re(hr),g(hr),hr=Br;g(Tr)},Ue=(hr,Tr,Br,Fr,Lr,qr,Ur,Qr,vn)=>{Tr.type==="svg"?Ur="svg":Tr.type==="math"&&(Ur="mathml"),hr==null?qe(Tr,Br,Fr,Lr,qr,Ur,Qr,vn):Et(hr,Tr,Lr,qr,Ur,Qr,vn)},qe=(hr,Tr,Br,Fr,Lr,qr,Ur,Qr)=>{let vn,_n;const{props:Yr,shapeFlag:jn,transition:Zr,dirs:An}=hr;if(vn=hr.el=i(hr.type,qr,Yr&&Yr.is,Yr),jn&8?V(vn,hr.children):jn&16&&Fe(hr.children,vn,null,Fr,Lr,resolveChildrenNamespace(hr,qr),Ur,Qr),An&&invokeDirectiveHook(hr,null,Fr,"created"),jt(vn,hr,hr.scopeId,Ur,Fr),Yr){for(const Mn in Yr)Mn!=="value"&&!isReservedProp(Mn)&&y(vn,Mn,null,Yr[Mn],qr,hr.children,Fr,Lr,Nr);"value"in Yr&&y(vn,"value",null,Yr.value,qr),(_n=Yr.onVnodeBeforeMount)&&invokeVNodeHook(_n,Fr,hr)}An&&invokeDirectiveHook(hr,null,Fr,"beforeMount");const Jr=needTransition(Lr,Zr);Jr&&Zr.beforeEnter(vn),n(vn,Tr,Br),((_n=Yr&&Yr.onVnodeMounted)||Jr||An)&&queuePostRenderEffect(()=>{_n&&invokeVNodeHook(_n,Fr,hr),Jr&&Zr.enter(vn),An&&invokeDirectiveHook(hr,null,Fr,"mounted")},Lr)},jt=(hr,Tr,Br,Fr,Lr)=>{if(Br&&oe(hr,Br),Fr)for(let qr=0;qr<Fr.length;qr++)oe(hr,Fr[qr]);if(Lr){let qr=Lr.subTree;if(Tr===qr){const Ur=Lr.vnode;jt(hr,Ur,Ur.scopeId,Ur.slotScopeIds,Lr.parent)}}},Fe=(hr,Tr,Br,Fr,Lr,qr,Ur,Qr,vn=0)=>{for(let _n=vn;_n<hr.length;_n++){const Yr=hr[_n]=Qr?cloneIfMounted(hr[_n]):normalizeVNode(hr[_n]);ue(null,Yr,Tr,Br,Fr,Lr,qr,Ur,Qr)}},Et=(hr,Tr,Br,Fr,Lr,qr,Ur)=>{const Qr=Tr.el=hr.el;let{patchFlag:vn,dynamicChildren:_n,dirs:Yr}=Tr;vn|=hr.patchFlag&16;const jn=hr.props||EMPTY_OBJ,Zr=Tr.props||EMPTY_OBJ;let An;if(Br&&toggleRecurse(Br,!1),(An=Zr.onVnodeBeforeUpdate)&&invokeVNodeHook(An,Br,Tr,hr),Yr&&invokeDirectiveHook(Tr,hr,Br,"beforeUpdate"),Br&&toggleRecurse(Br,!0),_n?cr(hr.dynamicChildren,_n,Qr,Br,Fr,resolveChildrenNamespace(Tr,Lr),qr):Ur||fr(hr,Tr,Qr,null,Br,Fr,resolveChildrenNamespace(Tr,Lr),qr,!1),vn>0){if(vn&16)er(Qr,Tr,jn,Zr,Br,Fr,Lr);else if(vn&2&&jn.class!==Zr.class&&y(Qr,"class",null,Zr.class,Lr),vn&4&&y(Qr,"style",jn.style,Zr.style,Lr),vn&8){const Jr=Tr.dynamicProps;for(let Mn=0;Mn<Jr.length;Mn++){const Bn=Jr[Mn],wn=jn[Bn],In=Zr[Bn];(In!==wn||Bn==="value")&&y(Qr,Bn,wn,In,Lr,hr.children,Br,Fr,Nr)}}vn&1&&hr.children!==Tr.children&&V(Qr,Tr.children)}else!Ur&&_n==null&&er(Qr,Tr,jn,Zr,Br,Fr,Lr);((An=Zr.onVnodeUpdated)||Yr)&&queuePostRenderEffect(()=>{An&&invokeVNodeHook(An,Br,Tr,hr),Yr&&invokeDirectiveHook(Tr,hr,Br,"updated")},Fr)},cr=(hr,Tr,Br,Fr,Lr,qr,Ur)=>{for(let Qr=0;Qr<Tr.length;Qr++){const vn=hr[Qr],_n=Tr[Qr],Yr=vn.el&&(vn.type===Fragment||!isSameVNodeType(vn,_n)||vn.shapeFlag&70)?z(vn.el):Br;ue(vn,_n,Yr,null,Fr,Lr,qr,Ur,!0)}},er=(hr,Tr,Br,Fr,Lr,qr,Ur)=>{if(Br!==Fr){if(Br!==EMPTY_OBJ)for(const Qr in Br)!isReservedProp(Qr)&&!(Qr in Fr)&&y(hr,Qr,Br[Qr],null,Ur,Tr.children,Lr,qr,Nr);for(const Qr in Fr){if(isReservedProp(Qr))continue;const vn=Fr[Qr],_n=Br[Qr];vn!==_n&&Qr!=="value"&&y(hr,Qr,_n,vn,Ur,Tr.children,Lr,qr,Nr)}"value"in Fr&&y(hr,"value",Br.value,Fr.value,Ur)}},nr=(hr,Tr,Br,Fr,Lr,qr,Ur,Qr,vn)=>{const _n=Tr.el=hr?hr.el:k(""),Yr=Tr.anchor=hr?hr.anchor:k("");let{patchFlag:jn,dynamicChildren:Zr,slotScopeIds:An}=Tr;An&&(Qr=Qr?Qr.concat(An):An),hr==null?(n(_n,Br,Fr),n(Yr,Br,Fr),Fe(Tr.children||[],Br,Yr,Lr,qr,Ur,Qr,vn)):jn>0&&jn&64&&Zr&&hr.dynamicChildren?(cr(hr.dynamicChildren,Zr,Br,Lr,qr,Ur,Qr),(Tr.key!=null||Lr&&Tr===Lr.subTree)&&traverseStaticChildren(hr,Tr,!0)):fr(hr,Tr,Br,Yr,Lr,qr,Ur,Qr,vn)},dr=(hr,Tr,Br,Fr,Lr,qr,Ur,Qr,vn)=>{Tr.slotScopeIds=Qr,hr==null?Tr.shapeFlag&512?Lr.ctx.activate(Tr,Br,Fr,Ur,vn):ir(Tr,Br,Fr,Lr,qr,Ur,vn):tr(hr,Tr,vn)},ir=(hr,Tr,Br,Fr,Lr,qr,Ur)=>{const Qr=hr.component=createComponentInstance(hr,Fr,Lr);if(isKeepAlive(hr)&&(Qr.ctx.renderer=Or),setupComponent(Qr),Qr.asyncDep){if(Lr&&Lr.registerDep(Qr,ur),!hr.el){const vn=Qr.subTree=createVNode(Comment);ae(null,vn,Tr,Br)}}else ur(Qr,hr,Tr,Br,Lr,qr,Ur)},tr=(hr,Tr,Br)=>{const Fr=Tr.component=hr.component;if(shouldUpdateComponent(hr,Tr,Br))if(Fr.asyncDep&&!Fr.asyncResolved){or(Fr,Tr,Br);return}else Fr.next=Tr,invalidateJob(Fr.update),Fr.effect.dirty=!0,Fr.update();else Tr.el=hr.el,Fr.vnode=Tr},ur=(hr,Tr,Br,Fr,Lr,qr,Ur)=>{const Qr=()=>{if(hr.isMounted){let{next:Yr,bu:jn,u:Zr,parent:An,vnode:Jr}=hr;{const bn=locateNonHydratedAsyncRoot(hr);if(bn){Yr&&(Yr.el=Jr.el,or(hr,Yr,Ur)),bn.asyncDep.then(()=>{hr.isUnmounted||Qr()});return}}let Mn=Yr,Bn;toggleRecurse(hr,!1),Yr?(Yr.el=Jr.el,or(hr,Yr,Ur)):Yr=Jr,jn&&invokeArrayFns(jn),(Bn=Yr.props&&Yr.props.onVnodeBeforeUpdate)&&invokeVNodeHook(Bn,An,Yr,Jr),toggleRecurse(hr,!0);const wn=renderComponentRoot(hr),In=hr.subTree;hr.subTree=wn,ue(In,wn,z(In.el),Er(In),hr,Lr,qr),Yr.el=wn.el,Mn===null&&updateHOCHostEl(hr,wn.el),Zr&&queuePostRenderEffect(Zr,Lr),(Bn=Yr.props&&Yr.props.onVnodeUpdated)&&queuePostRenderEffect(()=>invokeVNodeHook(Bn,An,Yr,Jr),Lr)}else{let Yr;const{el:jn,props:Zr}=Tr,{bm:An,m:Jr,parent:Mn}=hr,Bn=isAsyncWrapper(Tr);if(toggleRecurse(hr,!1),An&&invokeArrayFns(An),!Bn&&(Yr=Zr&&Zr.onVnodeBeforeMount)&&invokeVNodeHook(Yr,Mn,Tr),toggleRecurse(hr,!0),jn&&br){const wn=()=>{hr.subTree=renderComponentRoot(hr),br(jn,hr.subTree,hr,Lr,null)};Bn?Tr.type.__asyncLoader().then(()=>!hr.isUnmounted&&wn()):wn()}else{const wn=hr.subTree=renderComponentRoot(hr);ue(null,wn,Br,Fr,hr,Lr,qr),Tr.el=wn.el}if(Jr&&queuePostRenderEffect(Jr,Lr),!Bn&&(Yr=Zr&&Zr.onVnodeMounted)){const wn=Tr;queuePostRenderEffect(()=>invokeVNodeHook(Yr,Mn,wn),Lr)}(Tr.shapeFlag&256||Mn&&isAsyncWrapper(Mn.vnode)&&Mn.vnode.shapeFlag&256)&&hr.a&&queuePostRenderEffect(hr.a,Lr),hr.isMounted=!0,Tr=Br=Fr=null}},vn=hr.effect=new ReactiveEffect(Qr,NOOP,()=>queueJob(_n),hr.scope),_n=hr.update=()=>{vn.dirty&&vn.run()};_n.id=hr.uid,toggleRecurse(hr,!0),_n()},or=(hr,Tr,Br)=>{Tr.component=hr;const Fr=hr.vnode.props;hr.vnode=Tr,hr.next=null,updateProps(hr,Tr.props,Fr,Br),updateSlots(hr,Tr.children,Br),pauseTracking(),flushPreFlushCbs(hr),resetTracking()},fr=(hr,Tr,Br,Fr,Lr,qr,Ur,Qr,vn=!1)=>{const _n=hr&&hr.children,Yr=hr?hr.shapeFlag:0,jn=Tr.children,{patchFlag:Zr,shapeFlag:An}=Tr;if(Zr>0){if(Zr&128){gr(_n,jn,Br,Fr,Lr,qr,Ur,Qr,vn);return}else if(Zr&256){lr(_n,jn,Br,Fr,Lr,qr,Ur,Qr,vn);return}}An&8?(Yr&16&&Nr(_n,Lr,qr),jn!==_n&&V(Br,jn)):Yr&16?An&16?gr(_n,jn,Br,Fr,Lr,qr,Ur,Qr,vn):Nr(_n,Lr,qr,!0):(Yr&8&&V(Br,""),An&16&&Fe(jn,Br,Fr,Lr,qr,Ur,Qr,vn))},lr=(hr,Tr,Br,Fr,Lr,qr,Ur,Qr,vn)=>{hr=hr||EMPTY_ARR,Tr=Tr||EMPTY_ARR;const _n=hr.length,Yr=Tr.length,jn=Math.min(_n,Yr);let Zr;for(Zr=0;Zr<jn;Zr++){const An=Tr[Zr]=vn?cloneIfMounted(Tr[Zr]):normalizeVNode(Tr[Zr]);ue(hr[Zr],An,Br,null,Lr,qr,Ur,Qr,vn)}_n>Yr?Nr(hr,Lr,qr,!0,!1,jn):Fe(Tr,Br,Fr,Lr,qr,Ur,Qr,vn,jn)},gr=(hr,Tr,Br,Fr,Lr,qr,Ur,Qr,vn)=>{let _n=0;const Yr=Tr.length;let jn=hr.length-1,Zr=Yr-1;for(;_n<=jn&&_n<=Zr;){const An=hr[_n],Jr=Tr[_n]=vn?cloneIfMounted(Tr[_n]):normalizeVNode(Tr[_n]);if(isSameVNodeType(An,Jr))ue(An,Jr,Br,null,Lr,qr,Ur,Qr,vn);else break;_n++}for(;_n<=jn&&_n<=Zr;){const An=hr[jn],Jr=Tr[Zr]=vn?cloneIfMounted(Tr[Zr]):normalizeVNode(Tr[Zr]);if(isSameVNodeType(An,Jr))ue(An,Jr,Br,null,Lr,qr,Ur,Qr,vn);else break;jn--,Zr--}if(_n>jn){if(_n<=Zr){const An=Zr+1,Jr=An<Yr?Tr[An].el:Fr;for(;_n<=Zr;)ue(null,Tr[_n]=vn?cloneIfMounted(Tr[_n]):normalizeVNode(Tr[_n]),Br,Jr,Lr,qr,Ur,Qr,vn),_n++}}else if(_n>Zr)for(;_n<=jn;)wr(hr[_n],Lr,qr,!0),_n++;else{const An=_n,Jr=_n,Mn=new Map;for(_n=Jr;_n<=Zr;_n++){const Ho=Tr[_n]=vn?cloneIfMounted(Tr[_n]):normalizeVNode(Tr[_n]);Ho.key!=null&&Mn.set(Ho.key,_n)}let Bn,wn=0;const In=Zr-Jr+1;let bn=!1,hn=0;const Zn=new Array(In);for(_n=0;_n<In;_n++)Zn[_n]=0;for(_n=An;_n<=jn;_n++){const Ho=hr[_n];if(wn>=In){wr(Ho,Lr,qr,!0);continue}let Do;if(Ho.key!=null)Do=Mn.get(Ho.key);else for(Bn=Jr;Bn<=Zr;Bn++)if(Zn[Bn-Jr]===0&&isSameVNodeType(Ho,Tr[Bn])){Do=Bn;break}Do===void 0?wr(Ho,Lr,qr,!0):(Zn[Do-Jr]=_n+1,Do>=hn?hn=Do:bn=!0,ue(Ho,Tr[Do],Br,null,Lr,qr,Ur,Qr,vn),wn++)}const Oo=bn?getSequence(Zn):EMPTY_ARR;for(Bn=Oo.length-1,_n=In-1;_n>=0;_n--){const Ho=Jr+_n,Do=Tr[Ho],Eo=Ho+1<Yr?Tr[Ho+1].el:Fr;Zn[_n]===0?ue(null,Do,Br,Eo,Lr,qr,Ur,Qr,vn):bn&&(Bn<0||_n!==Oo[Bn]?Sr(Do,Br,Eo,2):Bn--)}}},Sr=(hr,Tr,Br,Fr,Lr=null)=>{const{el:qr,type:Ur,transition:Qr,children:vn,shapeFlag:_n}=hr;if(_n&6){Sr(hr.component.subTree,Tr,Br,Fr);return}if(_n&128){hr.suspense.move(Tr,Br,Fr);return}if(_n&64){Ur.move(hr,Tr,Br,Or);return}if(Ur===Fragment){n(qr,Tr,Br);for(let jn=0;jn<vn.length;jn++)Sr(vn[jn],Tr,Br,Fr);n(hr.anchor,Tr,Br);return}if(Ur===Static){de(hr,Tr,Br);return}if(Fr!==2&&_n&1&&Qr)if(Fr===0)Qr.beforeEnter(qr),n(qr,Tr,Br),queuePostRenderEffect(()=>Qr.enter(qr),Lr);else{const{leave:jn,delayLeave:Zr,afterLeave:An}=Qr,Jr=()=>n(qr,Tr,Br),Mn=()=>{jn(qr,()=>{Jr(),An&&An()})};Zr?Zr(qr,Jr,Mn):Mn()}else n(qr,Tr,Br)},wr=(hr,Tr,Br,Fr=!1,Lr=!1)=>{const{type:qr,props:Ur,ref:Qr,children:vn,dynamicChildren:_n,shapeFlag:Yr,patchFlag:jn,dirs:Zr}=hr;if(Qr!=null&&setRef(Qr,null,Br,hr,!0),Yr&256){Tr.ctx.deactivate(hr);return}const An=Yr&1&&Zr,Jr=!isAsyncWrapper(hr);let Mn;if(Jr&&(Mn=Ur&&Ur.onVnodeBeforeUnmount)&&invokeVNodeHook(Mn,Tr,hr),Yr&6)Ir(hr.component,Br,Fr);else{if(Yr&128){hr.suspense.unmount(Br,Fr);return}An&&invokeDirectiveHook(hr,null,Tr,"beforeUnmount"),Yr&64?hr.type.remove(hr,Tr,Br,Lr,Or,Fr):_n&&(qr!==Fragment||jn>0&&jn&64)?Nr(_n,Tr,Br,!1,!0):(qr===Fragment&&jn&384||!Lr&&Yr&16)&&Nr(vn,Tr,Br),Fr&&kr(hr)}(Jr&&(Mn=Ur&&Ur.onVnodeUnmounted)||An)&&queuePostRenderEffect(()=>{Mn&&invokeVNodeHook(Mn,Tr,hr),An&&invokeDirectiveHook(hr,null,Tr,"unmounted")},Br)},kr=hr=>{const{type:Tr,el:Br,anchor:Fr,transition:Lr}=hr;if(Tr===Fragment){mr(Br,Fr);return}if(Tr===Static){Ce(hr);return}const qr=()=>{g(Br),Lr&&!Lr.persisted&&Lr.afterLeave&&Lr.afterLeave()};if(hr.shapeFlag&1&&Lr&&!Lr.persisted){const{leave:Ur,delayLeave:Qr}=Lr,vn=()=>Ur(Br,qr);Qr?Qr(hr.el,qr,vn):vn()}else qr()},mr=(hr,Tr)=>{let Br;for(;hr!==Tr;)Br=re(hr),g(hr),hr=Br;g(Tr)},Ir=(hr,Tr,Br)=>{const{bum:Fr,scope:Lr,update:qr,subTree:Ur,um:Qr}=hr;Fr&&invokeArrayFns(Fr),Lr.stop(),qr&&(qr.active=!1,wr(Ur,hr,Tr,Br)),Qr&&queuePostRenderEffect(Qr,Tr),queuePostRenderEffect(()=>{hr.isUnmounted=!0},Tr),Tr&&Tr.pendingBranch&&!Tr.isUnmounted&&hr.asyncDep&&!hr.asyncResolved&&hr.suspenseId===Tr.pendingId&&(Tr.deps--,Tr.deps===0&&Tr.resolve())},Nr=(hr,Tr,Br,Fr=!1,Lr=!1,qr=0)=>{for(let Ur=qr;Ur<hr.length;Ur++)wr(hr[Ur],Tr,Br,Fr,Lr)},Er=hr=>hr.shapeFlag&6?Er(hr.component.subTree):hr.shapeFlag&128?hr.suspense.next():re(hr.anchor||hr.el);let sr=!1;const xr=(hr,Tr,Br)=>{hr==null?Tr._vnode&&wr(Tr._vnode,null,null,!0):ue(Tr._vnode||null,hr,Tr,null,null,null,Br),sr||(sr=!0,flushPreFlushCbs(),flushPostFlushCbs(),sr=!1),Tr._vnode=hr},Or={p:ue,um:wr,m:Sr,r:kr,mt:ir,mc:Fe,pc:fr,pbc:cr,n:Er,o:t};let Mr,br;return r&&([Mr,br]=r(Or)),{render:xr,hydrate:Mr,createApp:createAppAPI(xr,Mr)}}function resolveChildrenNamespace({type:t,props:r},e){return e==="svg"&&t==="foreignObject"||e==="mathml"&&t==="annotation-xml"&&r&&r.encoding&&r.encoding.includes("html")?void 0:e}function toggleRecurse({effect:t,update:r},e){t.allowRecurse=r.allowRecurse=e}function needTransition(t,r){return(!t||t&&!t.pendingBranch)&&r&&!r.persisted}function traverseStaticChildren(t,r,e=!1){const n=t.children,g=r.children;if(isArray$3(n)&&isArray$3(g))for(let y=0;y<n.length;y++){const i=n[y];let k=g[y];k.shapeFlag&1&&!k.dynamicChildren&&((k.patchFlag<=0||k.patchFlag===32)&&(k=g[y]=cloneIfMounted(g[y]),k.el=i.el),e||traverseStaticChildren(i,k)),k.type===Text&&(k.el=i.el)}}function getSequence(t){const r=t.slice(),e=[0];let n,g,y,i,k;const L=t.length;for(n=0;n<L;n++){const $=t[n];if($!==0){if(g=e[e.length-1],t[g]<$){r[n]=g,e.push(n);continue}for(y=0,i=e.length-1;y<i;)k=y+i>>1,t[e[k]]<$?y=k+1:i=k;$<t[e[y]]&&(y>0&&(r[n]=e[y-1]),e[y]=n)}}for(y=e.length,i=e[y-1];y-- >0;)e[y]=i,i=r[i];return e}function locateNonHydratedAsyncRoot(t){const r=t.subTree.component;if(r)return r.asyncDep&&!r.asyncResolved?r:locateNonHydratedAsyncRoot(r)}const isTeleport=t=>t.__isTeleport,isTeleportDisabled=t=>t&&(t.disabled||t.disabled===""),isTargetSVG=t=>typeof SVGElement<"u"&&t instanceof SVGElement,isTargetMathML=t=>typeof MathMLElement=="function"&&t instanceof MathMLElement,resolveTarget=(t,r)=>{const e=t&&t.to;return isString$2(e)?r?r(e):null:e},TeleportImpl={name:"Teleport",__isTeleport:!0,process(t,r,e,n,g,y,i,k,L,$){const{mc:V,pc:z,pbc:re,o:{insert:oe,querySelector:le,createText:ue,createComment:ie}}=$,ae=isTeleportDisabled(r.props);let{shapeFlag:Ie,children:de,dynamicChildren:Ce}=r;if(t==null){const Ue=r.el=ue(""),qe=r.anchor=ue("");oe(Ue,e,n),oe(qe,e,n);const jt=r.target=resolveTarget(r.props,le),Fe=r.targetAnchor=ue("");jt&&(oe(Fe,jt),i==="svg"||isTargetSVG(jt)?i="svg":(i==="mathml"||isTargetMathML(jt))&&(i="mathml"));const Et=(cr,er)=>{Ie&16&&V(de,cr,er,g,y,i,k,L)};ae?Et(e,qe):jt&&Et(jt,Fe)}else{r.el=t.el;const Ue=r.anchor=t.anchor,qe=r.target=t.target,jt=r.targetAnchor=t.targetAnchor,Fe=isTeleportDisabled(t.props),Et=Fe?e:qe,cr=Fe?Ue:jt;if(i==="svg"||isTargetSVG(qe)?i="svg":(i==="mathml"||isTargetMathML(qe))&&(i="mathml"),Ce?(re(t.dynamicChildren,Ce,Et,g,y,i,k),traverseStaticChildren(t,r,!0)):L||z(t,r,Et,cr,g,y,i,k,!1),ae)Fe?r.props&&t.props&&r.props.to!==t.props.to&&(r.props.to=t.props.to):moveTeleport(r,e,Ue,$,1);else if((r.props&&r.props.to)!==(t.props&&t.props.to)){const er=r.target=resolveTarget(r.props,le);er&&moveTeleport(r,er,null,$,0)}else Fe&&moveTeleport(r,qe,jt,$,1)}updateCssVars(r)},remove(t,r,e,n,{um:g,o:{remove:y}},i){const{shapeFlag:k,children:L,anchor:$,targetAnchor:V,target:z,props:re}=t;if(z&&y(V),i&&y($),k&16){const oe=i||!isTeleportDisabled(re);for(let le=0;le<L.length;le++){const ue=L[le];g(ue,r,e,oe,!!ue.dynamicChildren)}}},move:moveTeleport,hydrate:hydrateTeleport};function moveTeleport(t,r,e,{o:{insert:n},m:g},y=2){y===0&&n(t.targetAnchor,r,e);const{el:i,anchor:k,shapeFlag:L,children:$,props:V}=t,z=y===2;if(z&&n(i,r,e),(!z||isTeleportDisabled(V))&&L&16)for(let re=0;re<$.length;re++)g($[re],r,e,2);z&&n(k,r,e)}function hydrateTeleport(t,r,e,n,g,y,{o:{nextSibling:i,parentNode:k,querySelector:L}},$){const V=r.target=resolveTarget(r.props,L);if(V){const z=V._lpa||V.firstChild;if(r.shapeFlag&16)if(isTeleportDisabled(r.props))r.anchor=$(i(t),r,k(t),e,n,g,y),r.targetAnchor=z;else{r.anchor=i(t);let re=z;for(;re;)if(re=i(re),re&&re.nodeType===8&&re.data==="teleport anchor"){r.targetAnchor=re,V._lpa=r.targetAnchor&&i(r.targetAnchor);break}$(z,r,V,e,n,g,y)}updateCssVars(r)}return r.anchor&&i(r.anchor)}const Teleport=TeleportImpl;function updateCssVars(t){const r=t.ctx;if(r&&r.ut){let e=t.children[0].el;for(;e&&e!==t.targetAnchor;)e.nodeType===1&&e.setAttribute("data-v-owner",r.uid),e=e.nextSibling;r.ut()}}const Fragment=Symbol.for("v-fgt"),Text=Symbol.for("v-txt"),Comment=Symbol.for("v-cmt"),Static=Symbol.for("v-stc"),blockStack=[];let currentBlock=null;function openBlock(t=!1){blockStack.push(currentBlock=t?null:[])}function closeBlock(){blockStack.pop(),currentBlock=blockStack[blockStack.length-1]||null}let isBlockTreeEnabled=1;function setBlockTracking(t){isBlockTreeEnabled+=t}function setupBlock(t){return t.dynamicChildren=isBlockTreeEnabled>0?currentBlock||EMPTY_ARR:null,closeBlock(),isBlockTreeEnabled>0&&currentBlock&&currentBlock.push(t),t}function createElementBlock(t,r,e,n,g,y){return setupBlock(createBaseVNode(t,r,e,n,g,y,!0))}function createBlock(t,r,e,n,g){return setupBlock(createVNode(t,r,e,n,g,!0))}function isVNode(t){return t?t.__v_isVNode===!0:!1}function isSameVNodeType(t,r){return t.type===r.type&&t.key===r.key}const InternalObjectKey="__vInternal",normalizeKey=({key:t})=>t??null,normalizeRef=({ref:t,ref_key:r,ref_for:e})=>(typeof t=="number"&&(t=""+t),t!=null?isString$2(t)||isRef(t)||isFunction$3(t)?{i:currentRenderingInstance,r:t,k:r,f:!!e}:t:null);function createBaseVNode(t,r=null,e=null,n=0,g=null,y=t===Fragment?0:1,i=!1,k=!1){const L={__v_isVNode:!0,__v_skip:!0,type:t,props:r,key:r&&normalizeKey(r),ref:r&&normalizeRef(r),scopeId:currentScopeId,slotScopeIds:null,children:e,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetAnchor:null,staticCount:0,shapeFlag:y,patchFlag:n,dynamicProps:g,dynamicChildren:null,appContext:null,ctx:currentRenderingInstance};return k?(normalizeChildren(L,e),y&128&&t.normalize(L)):e&&(L.shapeFlag|=isString$2(e)?8:16),isBlockTreeEnabled>0&&!i&&currentBlock&&(L.patchFlag>0||y&6)&&L.patchFlag!==32&&currentBlock.push(L),L}const createVNode=_createVNode;function _createVNode(t,r=null,e=null,n=0,g=null,y=!1){if((!t||t===NULL_DYNAMIC_COMPONENT)&&(t=Comment),isVNode(t)){const k=cloneVNode(t,r,!0);return e&&normalizeChildren(k,e),isBlockTreeEnabled>0&&!y&&currentBlock&&(k.shapeFlag&6?currentBlock[currentBlock.indexOf(t)]=k:currentBlock.push(k)),k.patchFlag|=-2,k}if(isClassComponent(t)&&(t=t.__vccOpts),r){r=guardReactiveProps(r);let{class:k,style:L}=r;k&&!isString$2(k)&&(r.class=normalizeClass(k)),isObject$2(L)&&(isProxy(L)&&!isArray$3(L)&&(L=extend$1({},L)),r.style=normalizeStyle(L))}const i=isString$2(t)?1:isSuspense(t)?128:isTeleport(t)?64:isObject$2(t)?4:isFunction$3(t)?2:0;return createBaseVNode(t,r,e,n,g,i,y,!0)}function guardReactiveProps(t){return t?isProxy(t)||InternalObjectKey in t?extend$1({},t):t:null}function cloneVNode(t,r,e=!1){const{props:n,ref:g,patchFlag:y,children:i}=t,k=r?mergeProps(n||{},r):n;return{__v_isVNode:!0,__v_skip:!0,type:t.type,props:k,key:k&&normalizeKey(k),ref:r&&r.ref?e&&g?isArray$3(g)?g.concat(normalizeRef(r)):[g,normalizeRef(r)]:normalizeRef(r):g,scopeId:t.scopeId,slotScopeIds:t.slotScopeIds,children:i,target:t.target,targetAnchor:t.targetAnchor,staticCount:t.staticCount,shapeFlag:t.shapeFlag,patchFlag:r&&t.type!==Fragment?y===-1?16:y|16:y,dynamicProps:t.dynamicProps,dynamicChildren:t.dynamicChildren,appContext:t.appContext,dirs:t.dirs,transition:t.transition,component:t.component,suspense:t.suspense,ssContent:t.ssContent&&cloneVNode(t.ssContent),ssFallback:t.ssFallback&&cloneVNode(t.ssFallback),el:t.el,anchor:t.anchor,ctx:t.ctx,ce:t.ce}}function createTextVNode(t=" ",r=0){return createVNode(Text,null,t,r)}function createCommentVNode(t="",r=!1){return r?(openBlock(),createBlock(Comment,null,t)):createVNode(Comment,null,t)}function normalizeVNode(t){return t==null||typeof t=="boolean"?createVNode(Comment):isArray$3(t)?createVNode(Fragment,null,t.slice()):typeof t=="object"?cloneIfMounted(t):createVNode(Text,null,String(t))}function cloneIfMounted(t){return t.el===null&&t.patchFlag!==-1||t.memo?t:cloneVNode(t)}function normalizeChildren(t,r){let e=0;const{shapeFlag:n}=t;if(r==null)r=null;else if(isArray$3(r))e=16;else if(typeof r=="object")if(n&65){const g=r.default;g&&(g._c&&(g._d=!1),normalizeChildren(t,g()),g._c&&(g._d=!0));return}else{e=32;const g=r._;!g&&!(InternalObjectKey in r)?r._ctx=currentRenderingInstance:g===3&&currentRenderingInstance&&(currentRenderingInstance.slots._===1?r._=1:(r._=2,t.patchFlag|=1024))}else isFunction$3(r)?(r={default:r,_ctx:currentRenderingInstance},e=32):(r=String(r),n&64?(e=16,r=[createTextVNode(r)]):e=8);t.children=r,t.shapeFlag|=e}function mergeProps(...t){const r={};for(let e=0;e<t.length;e++){const n=t[e];for(const g in n)if(g==="class")r.class!==n.class&&(r.class=normalizeClass([r.class,n.class]));else if(g==="style")r.style=normalizeStyle([r.style,n.style]);else if(isOn(g)){const y=r[g],i=n[g];i&&y!==i&&!(isArray$3(y)&&y.includes(i))&&(r[g]=y?[].concat(y,i):i)}else g!==""&&(r[g]=n[g])}return r}function invokeVNodeHook(t,r,e,n=null){callWithAsyncErrorHandling(t,r,7,[e,n])}const emptyAppContext=createAppContext();let uid$2=0;function createComponentInstance(t,r,e){const n=t.type,g=(r?r.appContext:t.appContext)||emptyAppContext,y={uid:uid$2++,vnode:t,type:n,parent:r,appContext:g,root:null,next:null,subTree:null,effect:null,update:null,scope:new EffectScope(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:r?r.provides:Object.create(g.provides),accessCache:null,renderCache:[],components:null,directives:null,propsOptions:normalizePropsOptions(n,g),emitsOptions:normalizeEmitsOptions(n,g),emit:null,emitted:null,propsDefaults:EMPTY_OBJ,inheritAttrs:n.inheritAttrs,ctx:EMPTY_OBJ,data:EMPTY_OBJ,props:EMPTY_OBJ,attrs:EMPTY_OBJ,slots:EMPTY_OBJ,refs:EMPTY_OBJ,setupState:EMPTY_OBJ,setupContext:null,attrsProxy:null,slotsProxy:null,suspense:e,suspenseId:e?e.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return y.ctx={_:y},y.root=r?r.root:y,y.emit=emit.bind(null,y),t.ce&&t.ce(y),y}let currentInstance=null;const getCurrentInstance=()=>currentInstance||currentRenderingInstance;let internalSetCurrentInstance,setInSSRSetupState;{const t=getGlobalThis(),r=(e,n)=>{let g;return(g=t[e])||(g=t[e]=[]),g.push(n),y=>{g.length>1?g.forEach(i=>i(y)):g[0](y)}};internalSetCurrentInstance=r("__VUE_INSTANCE_SETTERS__",e=>currentInstance=e),setInSSRSetupState=r("__VUE_SSR_SETTERS__",e=>isInSSRComponentSetup=e)}const setCurrentInstance=t=>{const r=currentInstance;return internalSetCurrentInstance(t),t.scope.on(),()=>{t.scope.off(),internalSetCurrentInstance(r)}},unsetCurrentInstance=()=>{currentInstance&&currentInstance.scope.off(),internalSetCurrentInstance(null)};function isStatefulComponent(t){return t.vnode.shapeFlag&4}let isInSSRComponentSetup=!1;function setupComponent(t,r=!1){r&&setInSSRSetupState(r);const{props:e,children:n}=t.vnode,g=isStatefulComponent(t);initProps(t,e,g,r),initSlots(t,n);const y=g?setupStatefulComponent(t,r):void 0;return r&&setInSSRSetupState(!1),y}function setupStatefulComponent(t,r){const e=t.type;t.accessCache=Object.create(null),t.proxy=markRaw(new Proxy(t.ctx,PublicInstanceProxyHandlers));const{setup:n}=e;if(n){const g=t.setupContext=n.length>1?createSetupContext(t):null,y=setCurrentInstance(t);pauseTracking();const i=callWithErrorHandling(n,t,0,[t.props,g]);if(resetTracking(),y(),isPromise(i)){if(i.then(unsetCurrentInstance,unsetCurrentInstance),r)return i.then(k=>{handleSetupResult(t,k,r)}).catch(k=>{handleError(k,t,0)});t.asyncDep=i}else handleSetupResult(t,i,r)}else finishComponentSetup(t,r)}function handleSetupResult(t,r,e){isFunction$3(r)?t.type.__ssrInlineRender?t.ssrRender=r:t.render=r:isObject$2(r)&&(t.setupState=proxyRefs(r)),finishComponentSetup(t,e)}let compile;function finishComponentSetup(t,r,e){const n=t.type;if(!t.render){if(!r&&compile&&!n.render){const g=n.template||resolveMergedOptions(t).template;if(g){const{isCustomElement:y,compilerOptions:i}=t.appContext.config,{delimiters:k,compilerOptions:L}=n,$=extend$1(extend$1({isCustomElement:y,delimiters:k},i),L);n.render=compile(g,$)}}t.render=n.render||NOOP}{const g=setCurrentInstance(t);pauseTracking();try{applyOptions(t)}finally{resetTracking(),g()}}}function getAttrsProxy(t){return t.attrsProxy||(t.attrsProxy=new Proxy(t.attrs,{get(r,e){return track(t,"get","$attrs"),r[e]}}))}function createSetupContext(t){const r=e=>{t.exposed=e||{}};return{get attrs(){return getAttrsProxy(t)},slots:t.slots,emit:t.emit,expose:r}}function getExposeProxy(t){if(t.exposed)return t.exposeProxy||(t.exposeProxy=new Proxy(proxyRefs(markRaw(t.exposed)),{get(r,e){if(e in r)return r[e];if(e in publicPropertiesMap)return publicPropertiesMap[e](t)},has(r,e){return e in r||e in publicPropertiesMap}}))}const classifyRE=/(?:^|[-_])(\w)/g,classify=t=>t.replace(classifyRE,r=>r.toUpperCase()).replace(/[-_]/g,"");function getComponentName(t,r=!0){return isFunction$3(t)?t.displayName||t.name:t.name||r&&t.__name}function formatComponentName(t,r,e=!1){let n=getComponentName(r);if(!n&&r.__file){const g=r.__file.match(/([^/\\]+)\.\w+$/);g&&(n=g[1])}if(!n&&t&&t.parent){const g=y=>{for(const i in y)if(y[i]===r)return i};n=g(t.components||t.parent.type.components)||g(t.appContext.components)}return n?classify(n):e?"App":"Anonymous"}function isClassComponent(t){return isFunction$3(t)&&"__vccOpts"in t}const computed=(t,r)=>computed$1(t,r,isInSSRComponentSetup);function h$1(t,r,e){const n=arguments.length;return n===2?isObject$2(r)&&!isArray$3(r)?isVNode(r)?createVNode(t,null,[r]):createVNode(t,r):createVNode(t,null,r):(n>3?e=Array.prototype.slice.call(arguments,2):n===3&&isVNode(e)&&(e=[e]),createVNode(t,r,e))}const version="3.4.20",warn=NOOP;/**
* @vue/runtime-dom v3.4.20
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/const svgNS="http://www.w3.org/2000/svg",mathmlNS="http://www.w3.org/1998/Math/MathML",doc=typeof document<"u"?document:null,templateContainer=doc&&doc.createElement("template"),nodeOps={insert:(t,r,e)=>{r.insertBefore(t,e||null)},remove:t=>{const r=t.parentNode;r&&r.removeChild(t)},createElement:(t,r,e,n)=>{const g=r==="svg"?doc.createElementNS(svgNS,t):r==="mathml"?doc.createElementNS(mathmlNS,t):doc.createElement(t,e?{is:e}:void 0);return t==="select"&&n&&n.multiple!=null&&g.setAttribute("multiple",n.multiple),g},createText:t=>doc.createTextNode(t),createComment:t=>doc.createComment(t),setText:(t,r)=>{t.nodeValue=r},setElementText:(t,r)=>{t.textContent=r},parentNode:t=>t.parentNode,nextSibling:t=>t.nextSibling,querySelector:t=>doc.querySelector(t),setScopeId(t,r){t.setAttribute(r,"")},insertStaticContent(t,r,e,n,g,y){const i=e?e.previousSibling:r.lastChild;if(g&&(g===y||g.nextSibling))for(;r.insertBefore(g.cloneNode(!0),e),!(g===y||!(g=g.nextSibling)););else{templateContainer.innerHTML=n==="svg"?`<svg>${t}</svg>`:n==="mathml"?`<math>${t}</math>`:t;const k=templateContainer.content;if(n==="svg"||n==="mathml"){const L=k.firstChild;for(;L.firstChild;)k.appendChild(L.firstChild);k.removeChild(L)}r.insertBefore(k,e)}return[i?i.nextSibling:r.firstChild,e?e.previousSibling:r.lastChild]}},TRANSITION="transition",ANIMATION="animation",vtcKey=Symbol("_vtc"),Transition=(t,{slots:r})=>h$1(BaseTransition,resolveTransitionProps(t),r);Transition.displayName="Transition";const DOMTransitionPropsValidators={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String},TransitionPropsValidators=Transition.props=extend$1({},BaseTransitionPropsValidators,DOMTransitionPropsValidators),callHook=(t,r=[])=>{isArray$3(t)?t.forEach(e=>e(...r)):t&&t(...r)},hasExplicitCallback=t=>t?isArray$3(t)?t.some(r=>r.length>1):t.length>1:!1;function resolveTransitionProps(t){const r={};for(const nr in t)nr in DOMTransitionPropsValidators||(r[nr]=t[nr]);if(t.css===!1)return r;const{name:e="v",type:n,duration:g,enterFromClass:y=`${e}-enter-from`,enterActiveClass:i=`${e}-enter-active`,enterToClass:k=`${e}-enter-to`,appearFromClass:L=y,appearActiveClass:$=i,appearToClass:V=k,leaveFromClass:z=`${e}-leave-from`,leaveActiveClass:re=`${e}-leave-active`,leaveToClass:oe=`${e}-leave-to`}=t,le=normalizeDuration(g),ue=le&&le[0],ie=le&&le[1],{onBeforeEnter:ae,onEnter:Ie,onEnterCancelled:de,onLeave:Ce,onLeaveCancelled:Ue,onBeforeAppear:qe=ae,onAppear:jt=Ie,onAppearCancelled:Fe=de}=r,Et=(nr,dr,ir)=>{removeTransitionClass(nr,dr?V:k),removeTransitionClass(nr,dr?$:i),ir&&ir()},cr=(nr,dr)=>{nr._isLeaving=!1,removeTransitionClass(nr,z),removeTransitionClass(nr,oe),removeTransitionClass(nr,re),dr&&dr()},er=nr=>(dr,ir)=>{const tr=nr?jt:Ie,ur=()=>Et(dr,nr,ir);callHook(tr,[dr,ur]),nextFrame(()=>{removeTransitionClass(dr,nr?L:y),addTransitionClass(dr,nr?V:k),hasExplicitCallback(tr)||whenTransitionEnds(dr,n,ue,ur)})};return extend$1(r,{onBeforeEnter(nr){callHook(ae,[nr]),addTransitionClass(nr,y),addTransitionClass(nr,i)},onBeforeAppear(nr){callHook(qe,[nr]),addTransitionClass(nr,L),addTransitionClass(nr,$)},onEnter:er(!1),onAppear:er(!0),onLeave(nr,dr){nr._isLeaving=!0;const ir=()=>cr(nr,dr);addTransitionClass(nr,z),forceReflow(),addTransitionClass(nr,re),nextFrame(()=>{nr._isLeaving&&(removeTransitionClass(nr,z),addTransitionClass(nr,oe),hasExplicitCallback(Ce)||whenTransitionEnds(nr,n,ie,ir))}),callHook(Ce,[nr,ir])},onEnterCancelled(nr){Et(nr,!1),callHook(de,[nr])},onAppearCancelled(nr){Et(nr,!0),callHook(Fe,[nr])},onLeaveCancelled(nr){cr(nr),callHook(Ue,[nr])}})}function normalizeDuration(t){if(t==null)return null;if(isObject$2(t))return[NumberOf(t.enter),NumberOf(t.leave)];{const r=NumberOf(t);return[r,r]}}function NumberOf(t){return toNumber$1(t)}function addTransitionClass(t,r){r.split(/\s+/).forEach(e=>e&&t.classList.add(e)),(t[vtcKey]||(t[vtcKey]=new Set)).add(r)}function removeTransitionClass(t,r){r.split(/\s+/).forEach(n=>n&&t.classList.remove(n));const e=t[vtcKey];e&&(e.delete(r),e.size||(t[vtcKey]=void 0))}function nextFrame(t){requestAnimationFrame(()=>{requestAnimationFrame(t)})}let endId=0;function whenTransitionEnds(t,r,e,n){const g=t._endId=++endId,y=()=>{g===t._endId&&n()};if(e)return setTimeout(y,e);const{type:i,timeout:k,propCount:L}=getTransitionInfo(t,r);if(!i)return n();const $=i+"end";let V=0;const z=()=>{t.removeEventListener($,re),y()},re=oe=>{oe.target===t&&++V>=L&&z()};setTimeout(()=>{V<L&&z()},k+1),t.addEventListener($,re)}function getTransitionInfo(t,r){const e=window.getComputedStyle(t),n=le=>(e[le]||"").split(", "),g=n(`${TRANSITION}Delay`),y=n(`${TRANSITION}Duration`),i=getTimeout(g,y),k=n(`${ANIMATION}Delay`),L=n(`${ANIMATION}Duration`),$=getTimeout(k,L);let V=null,z=0,re=0;r===TRANSITION?i>0&&(V=TRANSITION,z=i,re=y.length):r===ANIMATION?$>0&&(V=ANIMATION,z=$,re=L.length):(z=Math.max(i,$),V=z>0?i>$?TRANSITION:ANIMATION:null,re=V?V===TRANSITION?y.length:L.length:0);const oe=V===TRANSITION&&/\b(transform|all)(,|$)/.test(n(`${TRANSITION}Property`).toString());return{type:V,timeout:z,propCount:re,hasTransform:oe}}function getTimeout(t,r){for(;t.length<r.length;)t=t.concat(t);return Math.max(...r.map((e,n)=>toMs(e)+toMs(t[n])))}function toMs(t){return t==="auto"?0:Number(t.slice(0,-1).replace(",","."))*1e3}function forceReflow(){return document.body.offsetHeight}function patchClass(t,r,e){const n=t[vtcKey];n&&(r=(r?[r,...n]:[...n]).join(" ")),r==null?t.removeAttribute("class"):e?t.setAttribute("class",r):t.className=r}const vShowOriginalDisplay=Symbol("_vod"),vShowHidden=Symbol("_vsh"),vShow={beforeMount(t,{value:r},{transition:e}){t[vShowOriginalDisplay]=t.style.display==="none"?"":t.style.display,e&&r?e.beforeEnter(t):setDisplay(t,r)},mounted(t,{value:r},{transition:e}){e&&r&&e.enter(t)},updated(t,{value:r,oldValue:e},{transition:n}){!r!=!e&&(n?r?(n.beforeEnter(t),setDisplay(t,!0),n.enter(t)):n.leave(t,()=>{setDisplay(t,!1)}):setDisplay(t,r))},beforeUnmount(t,{value:r}){setDisplay(t,r)}};function setDisplay(t,r){t.style.display=r?t[vShowOriginalDisplay]:"none",t[vShowHidden]=!r}const CSS_VAR_TEXT=Symbol(""),displayRE=/(^|;)\s*display\s*:/;function patchStyle(t,r,e){const n=t.style,g=isString$2(e);let y=!1;if(e&&!g){if(r)if(isString$2(r))for(const i of r.split(";")){const k=i.slice(0,i.indexOf(":")).trim();e[k]==null&&setStyle(n,k,"")}else for(const i in r)e[i]==null&&setStyle(n,i,"");for(const i in e)i==="display"&&(y=!0),setStyle(n,i,e[i])}else if(g){if(r!==e){const i=n[CSS_VAR_TEXT];i&&(e+=";"+i),n.cssText=e,y=displayRE.test(e)}}else r&&t.removeAttribute("style");vShowOriginalDisplay in t&&(t[vShowOriginalDisplay]=y?n.display:"",t[vShowHidden]&&(n.display="none"))}const importantRE=/\s*!important$/;function setStyle(t,r,e){if(isArray$3(e))e.forEach(n=>setStyle(t,r,n));else if(e==null&&(e=""),r.startsWith("--"))t.setProperty(r,e);else{const n=autoPrefix(t,r);importantRE.test(e)?t.setProperty(hyphenate(n),e.replace(importantRE,""),"important"):t[n]=e}}const prefixes=["Webkit","Moz","ms"],prefixCache={};function autoPrefix(t,r){const e=prefixCache[r];if(e)return e;let n=camelize(r);if(n!=="filter"&&n in t)return prefixCache[r]=n;n=capitalize$1(n);for(let g=0;g<prefixes.length;g++){const y=prefixes[g]+n;if(y in t)return prefixCache[r]=y}return r}const xlinkNS="http://www.w3.org/1999/xlink";function patchAttr(t,r,e,n,g){if(n&&r.startsWith("xlink:"))e==null?t.removeAttributeNS(xlinkNS,r.slice(6,r.length)):t.setAttributeNS(xlinkNS,r,e);else{const y=isSpecialBooleanAttr(r);e==null||y&&!includeBooleanAttr(e)?t.removeAttribute(r):t.setAttribute(r,y?"":e)}}function patchDOMProp(t,r,e,n,g,y,i){if(r==="innerHTML"||r==="textContent"){n&&i(n,g,y),t[r]=e??"";return}const k=t.tagName;if(r==="value"&&k!=="PROGRESS"&&!k.includes("-")){t._value=e;const $=k==="OPTION"?t.getAttribute("value")||"":t.value,V=e??"";$!==V&&(t.value=V),e==null&&t.removeAttribute(r);return}let L=!1;if(e===""||e==null){const $=typeof t[r];$==="boolean"?e=includeBooleanAttr(e):e==null&&$==="string"?(e="",L=!0):$==="number"&&(e=0,L=!0)}try{t[r]=e}catch{}L&&t.removeAttribute(r)}function addEventListener(t,r,e,n){t.addEventListener(r,e,n)}function removeEventListener(t,r,e,n){t.removeEventListener(r,e,n)}const veiKey=Symbol("_vei");function patchEvent(t,r,e,n,g=null){const y=t[veiKey]||(t[veiKey]={}),i=y[r];if(n&&i)i.value=n;else{const[k,L]=parseName(r);if(n){const $=y[r]=createInvoker(n,g);addEventListener(t,k,$,L)}else i&&(removeEventListener(t,k,i,L),y[r]=void 0)}}const optionsModifierRE=/(?:Once|Passive|Capture)$/;function parseName(t){let r;if(optionsModifierRE.test(t)){r={};let n;for(;n=t.match(optionsModifierRE);)t=t.slice(0,t.length-n[0].length),r[n[0].toLowerCase()]=!0}return[t[2]===":"?t.slice(3):hyphenate(t.slice(2)),r]}let cachedNow=0;const p$1=Promise.resolve(),getNow=()=>cachedNow||(p$1.then(()=>cachedNow=0),cachedNow=Date.now());function createInvoker(t,r){const e=n=>{if(!n._vts)n._vts=Date.now();else if(n._vts<=e.attached)return;callWithAsyncErrorHandling(patchStopImmediatePropagation(n,e.value),r,5,[n])};return e.value=t,e.attached=getNow(),e}function patchStopImmediatePropagation(t,r){if(isArray$3(r)){const e=t.stopImmediatePropagation;return t.stopImmediatePropagation=()=>{e.call(t),t._stopped=!0},r.map(n=>g=>!g._stopped&&n&&n(g))}else return r}const isNativeOn=t=>t.charCodeAt(0)===111&&t.charCodeAt(1)===110&&t.charCodeAt(2)>96&&t.charCodeAt(2)<123,patchProp=(t,r,e,n,g,y,i,k,L)=>{const $=g==="svg";r==="class"?patchClass(t,n,$):r==="style"?patchStyle(t,e,n):isOn(r)?isModelListener(r)||patchEvent(t,r,e,n,i):(r[0]==="."?(r=r.slice(1),!0):r[0]==="^"?(r=r.slice(1),!1):shouldSetAsProp(t,r,n,$))?patchDOMProp(t,r,n,y,i,k,L):(r==="true-value"?t._trueValue=n:r==="false-value"&&(t._falseValue=n),patchAttr(t,r,n,$))};function shouldSetAsProp(t,r,e,n){if(n)return!!(r==="innerHTML"||r==="textContent"||r in t&&isNativeOn(r)&&isFunction$3(e));if(r==="spellcheck"||r==="draggable"||r==="translate"||r==="form"||r==="list"&&t.tagName==="INPUT"||r==="type"&&t.tagName==="TEXTAREA")return!1;if(r==="width"||r==="height"){const g=t.tagName;if(g==="IMG"||g==="VIDEO"||g==="CANVAS"||g==="SOURCE")return!1}return isNativeOn(r)&&isString$2(e)?!1:r in t}const positionMap=new WeakMap,newPositionMap=new WeakMap,moveCbKey=Symbol("_moveCb"),enterCbKey=Symbol("_enterCb"),TransitionGroupImpl={name:"TransitionGroup",props:extend$1({},TransitionPropsValidators,{tag:String,moveClass:String}),setup(t,{slots:r}){const e=getCurrentInstance(),n=useTransitionState();let g,y;return onUpdated(()=>{if(!g.length)return;const i=t.moveClass||`${t.name||"v"}-move`;if(!hasCSSTransform(g[0].el,e.vnode.el,i))return;g.forEach(callPendingCbs),g.forEach(recordPosition);const k=g.filter(applyTranslation);forceReflow(),k.forEach(L=>{const $=L.el,V=$.style;addTransitionClass($,i),V.transform=V.webkitTransform=V.transitionDuration="";const z=$[moveCbKey]=re=>{re&&re.target!==$||(!re||/transform$/.test(re.propertyName))&&($.removeEventListener("transitionend",z),$[moveCbKey]=null,removeTransitionClass($,i))};$.addEventListener("transitionend",z)})}),()=>{const i=toRaw(t),k=resolveTransitionProps(i);let L=i.tag||Fragment;g=y,y=r.default?getTransitionRawChildren(r.default()):[];for(let $=0;$<y.length;$++){const V=y[$];V.key!=null&&setTransitionHooks(V,resolveTransitionHooks(V,k,n,e))}if(g)for(let $=0;$<g.length;$++){const V=g[$];setTransitionHooks(V,resolveTransitionHooks(V,k,n,e)),positionMap.set(V,V.el.getBoundingClientRect())}return createVNode(L,null,y)}}},removeMode=t=>delete t.mode;TransitionGroupImpl.props;const TransitionGroup=TransitionGroupImpl;function callPendingCbs(t){const r=t.el;r[moveCbKey]&&r[moveCbKey](),r[enterCbKey]&&r[enterCbKey]()}function recordPosition(t){newPositionMap.set(t,t.el.getBoundingClientRect())}function applyTranslation(t){const r=positionMap.get(t),e=newPositionMap.get(t),n=r.left-e.left,g=r.top-e.top;if(n||g){const y=t.el.style;return y.transform=y.webkitTransform=`translate(${n}px,${g}px)`,y.transitionDuration="0s",t}}function hasCSSTransform(t,r,e){const n=t.cloneNode(),g=t[vtcKey];g&&g.forEach(k=>{k.split(/\s+/).forEach(L=>L&&n.classList.remove(L))}),e.split(/\s+/).forEach(k=>k&&n.classList.add(k)),n.style.display="none";const y=r.nodeType===1?r:r.parentNode;y.appendChild(n);const{hasTransform:i}=getTransitionInfo(n);return y.removeChild(n),i}const getModelAssigner=t=>{const r=t.props["onUpdate:modelValue"]||!1;return isArray$3(r)?e=>invokeArrayFns(r,e):r};function onCompositionStart(t){t.target.composing=!0}function onCompositionEnd(t){const r=t.target;r.composing&&(r.composing=!1,r.dispatchEvent(new Event("input")))}const assignKey=Symbol("_assign"),vModelText={created(t,{modifiers:{lazy:r,trim:e,number:n}},g){t[assignKey]=getModelAssigner(g);const y=n||g.props&&g.props.type==="number";addEventListener(t,r?"change":"input",i=>{if(i.target.composing)return;let k=t.value;e&&(k=k.trim()),y&&(k=looseToNumber(k)),t[assignKey](k)}),e&&addEventListener(t,"change",()=>{t.value=t.value.trim()}),r||(addEventListener(t,"compositionstart",onCompositionStart),addEventListener(t,"compositionend",onCompositionEnd),addEventListener(t,"change",onCompositionEnd))},mounted(t,{value:r}){t.value=r??""},beforeUpdate(t,{value:r,modifiers:{lazy:e,trim:n,number:g}},y){if(t[assignKey]=getModelAssigner(y),t.composing)return;const i=g||t.type==="number"?looseToNumber(t.value):t.value,k=r??"";i!==k&&(document.activeElement===t&&t.type!=="range"&&(e||n&&t.value.trim()===k)||(t.value=k))}},vModelCheckbox={deep:!0,created(t,r,e){t[assignKey]=getModelAssigner(e),addEventListener(t,"change",()=>{const n=t._modelValue,g=getValue$2(t),y=t.checked,i=t[assignKey];if(isArray$3(n)){const k=looseIndexOf(n,g),L=k!==-1;if(y&&!L)i(n.concat(g));else if(!y&&L){const $=[...n];$.splice(k,1),i($)}}else if(isSet$2(n)){const k=new Set(n);y?k.add(g):k.delete(g),i(k)}else i(getCheckboxValue(t,y))})},mounted:setChecked,beforeUpdate(t,r,e){t[assignKey]=getModelAssigner(e),setChecked(t,r,e)}};function setChecked(t,{value:r,oldValue:e},n){t._modelValue=r,isArray$3(r)?t.checked=looseIndexOf(r,n.props.value)>-1:isSet$2(r)?t.checked=r.has(n.props.value):r!==e&&(t.checked=looseEqual(r,getCheckboxValue(t,!0)))}const vModelRadio={created(t,{value:r},e){t.checked=looseEqual(r,e.props.value),t[assignKey]=getModelAssigner(e),addEventListener(t,"change",()=>{t[assignKey](getValue$2(t))})},beforeUpdate(t,{value:r,oldValue:e},n){t[assignKey]=getModelAssigner(n),r!==e&&(t.checked=looseEqual(r,n.props.value))}};function getValue$2(t){return"_value"in t?t._value:t.value}function getCheckboxValue(t,r){const e=r?"_trueValue":"_falseValue";return e in t?t[e]:r}const systemModifiers=["ctrl","shift","alt","meta"],modifierGuards={stop:t=>t.stopPropagation(),prevent:t=>t.preventDefault(),self:t=>t.target!==t.currentTarget,ctrl:t=>!t.ctrlKey,shift:t=>!t.shiftKey,alt:t=>!t.altKey,meta:t=>!t.metaKey,left:t=>"button"in t&&t.button!==0,middle:t=>"button"in t&&t.button!==1,right:t=>"button"in t&&t.button!==2,exact:(t,r)=>systemModifiers.some(e=>t[`${e}Key`]&&!r.includes(e))},withModifiers=(t,r)=>{const e=t._withMods||(t._withMods={}),n=r.join(".");return e[n]||(e[n]=(g,...y)=>{for(let i=0;i<r.length;i++){const k=modifierGuards[r[i]];if(k&&k(g,r))return}return t(g,...y)})},keyNames={esc:"escape",space:" ",up:"arrow-up",left:"arrow-left",right:"arrow-right",down:"arrow-down",delete:"backspace"},withKeys=(t,r)=>{const e=t._withKeys||(t._withKeys={}),n=r.join(".");return e[n]||(e[n]=g=>{if(!("key"in g))return;const y=hyphenate(g.key);if(r.some(i=>i===y||keyNames[i]===y))return t(g)})},rendererOptions=extend$1({patchProp},nodeOps);let renderer;function ensureRenderer(){return renderer||(renderer=createRenderer(rendererOptions))}const render=(...t)=>{ensureRenderer().render(...t)},createApp=(...t)=>{const r=ensureRenderer().createApp(...t),{mount:e}=r;return r.mount=n=>{const g=normalizeContainer(n);if(!g)return;const y=r._component;!isFunction$3(y)&&!y.render&&!y.template&&(y.template=g.innerHTML),g.innerHTML="";const i=e(g,!1,resolveRootNamespace(g));return g instanceof Element&&(g.removeAttribute("v-cloak"),g.setAttribute("data-v-app","")),i},r};function resolveRootNamespace(t){if(t instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&t instanceof MathMLElement)return"mathml"}function normalizeContainer(t){return isString$2(t)?document.querySelector(t):t}const FOCUSABLE_ELEMENT_SELECTORS='a[href],button:not([disabled]),button:not([hidden]),:not([tabindex="-1"]),input:not([disabled]),input:not([type="hidden"]),select:not([disabled]),textarea:not([disabled])',isVisible=t=>getComputedStyle(t).position==="fixed"?!1:t.offsetParent!==null,obtainAllFocusableElements$1=t=>Array.from(t.querySelectorAll(FOCUSABLE_ELEMENT_SELECTORS)).filter(r=>isFocusable(r)&&isVisible(r)),isFocusable=t=>{if(t.tabIndex>0||t.tabIndex===0&&t.getAttribute("tabIndex")!==null)return!0;if(t.disabled)return!1;switch(t.nodeName){case"A":return!!t.href&&t.rel!=="ignore";case"INPUT":return!(t.type==="hidden"||t.type==="file");case"BUTTON":case"SELECT":case"TEXTAREA":return!0;default:return!1}},triggerEvent=function(t,r,...e){let n;r.includes("mouse")||r.includes("click")?n="MouseEvents":r.includes("key")?n="KeyboardEvent":n="HTMLEvents";const g=document.createEvent(n);return g.initEvent(r,...e),t.dispatchEvent(g),t},isLeaf=t=>!t.getAttribute("aria-owns"),getSibling=(t,r,e)=>{const{parentNode:n}=t;if(!n)return null;const g=n.querySelectorAll(e),y=Array.prototype.indexOf.call(g,t);return g[y+r]||null},focusNode=t=>{t&&(t.focus(),!isLeaf(t)&&t.click())},composeEventHandlers=(t,r,{checkForDefaultPrevented:e=!0}={})=>g=>{const y=t==null?void 0:t(g);if(e===!1||!y)return r==null?void 0:r(g)};var _a;const isClient=typeof window<"u",isDef=t=>typeof t<"u",isFunction$2=t=>typeof t=="function",isString$1=t=>typeof t=="string",noop$1=()=>{},isIOS=isClient&&((_a=window==null?void 0:window.navigator)==null?void 0:_a.userAgent)&&/iP(ad|hone|od)/.test(window.navigator.userAgent);function resolveUnref(t){return typeof t=="function"?t():unref(t)}function createFilterWrapper(t,r){function e(...n){return new Promise((g,y)=>{Promise.resolve(t(()=>r.apply(this,n),{fn:r,thisArg:this,args:n})).then(g).catch(y)})}return e}function debounceFilter(t,r={}){let e,n,g=noop$1;const y=k=>{clearTimeout(k),g(),g=noop$1};return k=>{const L=resolveUnref(t),$=resolveUnref(r.maxWait);return e&&y(e),L<=0||$!==void 0&&$<=0?(n&&(y(n),n=null),Promise.resolve(k())):new Promise((V,z)=>{g=r.rejectOnCancel?z:V,$&&!n&&(n=setTimeout(()=>{e&&y(e),n=null,V(k())},$)),e=setTimeout(()=>{n&&y(n),n=null,V(k())},L)})}}function throttleFilter(t,r=!0,e=!0,n=!1){let g=0,y,i=!0,k=noop$1,L;const $=()=>{y&&(clearTimeout(y),y=void 0,k(),k=noop$1)};return z=>{const re=resolveUnref(t),oe=Date.now()-g,le=()=>L=z();return $(),re<=0?(g=Date.now(),le()):(oe>re&&(e||!i)?(g=Date.now(),le()):r&&(L=new Promise((ue,ie)=>{k=n?ie:ue,y=setTimeout(()=>{g=Date.now(),i=!0,ue(le()),$()},Math.max(0,re-oe))})),!e&&!y&&(y=setTimeout(()=>i=!0,re)),i=!1,L)}}function identity$1(t){return t}function tryOnScopeDispose(t){return getCurrentScope()?(onScopeDispose(t),!0):!1}function useDebounceFn(t,r=200,e={}){return createFilterWrapper(debounceFilter(r,e),t)}function refDebounced(t,r=200,e={}){const n=ref(t.value),g=useDebounceFn(()=>{n.value=t.value},r,e);return watch(t,()=>g()),n}function useThrottleFn(t,r=200,e=!1,n=!0,g=!1){return createFilterWrapper(throttleFilter(r,e,n,g),t)}function tryOnMounted(t,r=!0){getCurrentInstance()?onMounted(t):r?t():nextTick(t)}function useTimeoutFn(t,r,e={}){const{immediate:n=!0}=e,g=ref(!1);let y=null;function i(){y&&(clearTimeout(y),y=null)}function k(){g.value=!1,i()}function L(...$){i(),g.value=!0,y=setTimeout(()=>{g.value=!1,y=null,t(...$)},resolveUnref(r))}return n&&(g.value=!0,isClient&&L()),tryOnScopeDispose(k),{isPending:readonly(g),start:L,stop:k}}function unrefElement(t){var r;const e=resolveUnref(t);return(r=e==null?void 0:e.$el)!=null?r:e}const defaultWindow=isClient?window:void 0;function useEventListener(...t){let r,e,n,g;if(isString$1(t[0])||Array.isArray(t[0])?([e,n,g]=t,r=defaultWindow):[r,e,n,g]=t,!r)return noop$1;Array.isArray(e)||(e=[e]),Array.isArray(n)||(n=[n]);const y=[],i=()=>{y.forEach(V=>V()),y.length=0},k=(V,z,re,oe)=>(V.addEventListener(z,re,oe),()=>V.removeEventListener(z,re,oe)),L=watch(()=>[unrefElement(r),resolveUnref(g)],([V,z])=>{i(),V&&y.push(...e.flatMap(re=>n.map(oe=>k(V,re,oe,z))))},{immediate:!0,flush:"post"}),$=()=>{L(),i()};return tryOnScopeDispose($),$}let _iOSWorkaround=!1;function onClickOutside(t,r,e={}){const{window:n=defaultWindow,ignore:g=[],capture:y=!0,detectIframe:i=!1}=e;if(!n)return;isIOS&&!_iOSWorkaround&&(_iOSWorkaround=!0,Array.from(n.document.body.children).forEach(re=>re.addEventListener("click",noop$1)));let k=!0;const L=re=>g.some(oe=>{if(typeof oe=="string")return Array.from(n.document.querySelectorAll(oe)).some(le=>le===re.target||re.composedPath().includes(le));{const le=unrefElement(oe);return le&&(re.target===le||re.composedPath().includes(le))}}),V=[useEventListener(n,"click",re=>{const oe=unrefElement(t);if(!(!oe||oe===re.target||re.composedPath().includes(oe))){if(re.detail===0&&(k=!L(re)),!k){k=!0;return}r(re)}},{passive:!0,capture:y}),useEventListener(n,"pointerdown",re=>{const oe=unrefElement(t);oe&&(k=!re.composedPath().includes(oe)&&!L(re))},{passive:!0}),i&&useEventListener(n,"blur",re=>{var oe;const le=unrefElement(t);((oe=n.document.activeElement)==null?void 0:oe.tagName)==="IFRAME"&&!(le!=null&&le.contains(n.document.activeElement))&&r(re)})].filter(Boolean);return()=>V.forEach(re=>re())}function useSupported(t,r=!1){const e=ref(),n=()=>e.value=!!t();return n(),tryOnMounted(n,r),e}function cloneFnJSON(t){return JSON.parse(JSON.stringify(t))}const _global$1=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},globalKey="__vueuse_ssr_handlers__";_global$1[globalKey]=_global$1[globalKey]||{};function useCssVar(t,r,{window:e=defaultWindow,initialValue:n=""}={}){const g=ref(n),y=computed(()=>{var i;return unrefElement(r)||((i=e==null?void 0:e.document)==null?void 0:i.documentElement)});return watch([y,()=>resolveUnref(t)],([i,k])=>{var L;if(i&&e){const $=(L=e.getComputedStyle(i).getPropertyValue(k))==null?void 0:L.trim();g.value=$||n}},{immediate:!0}),watch(g,i=>{var k;(k=y.value)!=null&&k.style&&y.value.style.setProperty(resolveUnref(t),i)}),g}var __getOwnPropSymbols$g=Object.getOwnPropertySymbols,__hasOwnProp$g=Object.prototype.hasOwnProperty,__propIsEnum$g=Object.prototype.propertyIsEnumerable,__objRest$2=(t,r)=>{var e={};for(var n in t)__hasOwnProp$g.call(t,n)&&r.indexOf(n)<0&&(e[n]=t[n]);if(t!=null&&__getOwnPropSymbols$g)for(var n of __getOwnPropSymbols$g(t))r.indexOf(n)<0&&__propIsEnum$g.call(t,n)&&(e[n]=t[n]);return e};function useResizeObserver(t,r,e={}){const n=e,{window:g=defaultWindow}=n,y=__objRest$2(n,["window"]);let i;const k=useSupported(()=>g&&"ResizeObserver"in g),L=()=>{i&&(i.disconnect(),i=void 0)},$=watch(()=>unrefElement(t),z=>{L(),k.value&&g&&z&&(i=new ResizeObserver(r),i.observe(z,y))},{immediate:!0,flush:"post"}),V=()=>{L(),$()};return tryOnScopeDispose(V),{isSupported:k,stop:V}}function useElementBounding(t,r={}){const{reset:e=!0,windowResize:n=!0,windowScroll:g=!0,immediate:y=!0}=r,i=ref(0),k=ref(0),L=ref(0),$=ref(0),V=ref(0),z=ref(0),re=ref(0),oe=ref(0);function le(){const ue=unrefElement(t);if(!ue){e&&(i.value=0,k.value=0,L.value=0,$.value=0,V.value=0,z.value=0,re.value=0,oe.value=0);return}const ie=ue.getBoundingClientRect();i.value=ie.height,k.value=ie.bottom,L.value=ie.left,$.value=ie.right,V.value=ie.top,z.value=ie.width,re.value=ie.x,oe.value=ie.y}return useResizeObserver(t,le),watch(()=>unrefElement(t),ue=>!ue&&le()),g&&useEventListener("scroll",le,{capture:!0,passive:!0}),n&&useEventListener("resize",le,{passive:!0}),tryOnMounted(()=>{y&&le()}),{height:i,bottom:k,left:L,right:$,top:V,width:z,x:re,y:oe,update:le}}var __getOwnPropSymbols$8=Object.getOwnPropertySymbols,__hasOwnProp$8=Object.prototype.hasOwnProperty,__propIsEnum$8=Object.prototype.propertyIsEnumerable,__objRest$1=(t,r)=>{var e={};for(var n in t)__hasOwnProp$8.call(t,n)&&r.indexOf(n)<0&&(e[n]=t[n]);if(t!=null&&__getOwnPropSymbols$8)for(var n of __getOwnPropSymbols$8(t))r.indexOf(n)<0&&__propIsEnum$8.call(t,n)&&(e[n]=t[n]);return e};function useMutationObserver(t,r,e={}){const n=e,{window:g=defaultWindow}=n,y=__objRest$1(n,["window"]);let i;const k=useSupported(()=>g&&"MutationObserver"in g),L=()=>{i&&(i.disconnect(),i=void 0)},$=watch(()=>unrefElement(t),z=>{L(),k.value&&g&&z&&(i=new MutationObserver(r),i.observe(z,y))},{immediate:!0}),V=()=>{L(),$()};return tryOnScopeDispose(V),{isSupported:k,stop:V}}var SwipeDirection;(function(t){t.UP="UP",t.RIGHT="RIGHT",t.DOWN="DOWN",t.LEFT="LEFT",t.NONE="NONE"})(SwipeDirection||(SwipeDirection={}));var __defProp=Object.defineProperty,__getOwnPropSymbols=Object.getOwnPropertySymbols,__hasOwnProp=Object.prototype.hasOwnProperty,__propIsEnum=Object.prototype.propertyIsEnumerable,__defNormalProp=(t,r,e)=>r in t?__defProp(t,r,{enumerable:!0,configurable:!0,writable:!0,value:e}):t[r]=e,__spreadValues=(t,r)=>{for(var e in r||(r={}))__hasOwnProp.call(r,e)&&__defNormalProp(t,e,r[e]);if(__getOwnPropSymbols)for(var e of __getOwnPropSymbols(r))__propIsEnum.call(r,e)&&__defNormalProp(t,e,r[e]);return t};const _TransitionPresets={easeInSine:[.12,0,.39,0],easeOutSine:[.61,1,.88,1],easeInOutSine:[.37,0,.63,1],easeInQuad:[.11,0,.5,0],easeOutQuad:[.5,1,.89,1],easeInOutQuad:[.45,0,.55,1],easeInCubic:[.32,0,.67,0],easeOutCubic:[.33,1,.68,1],easeInOutCubic:[.65,0,.35,1],easeInQuart:[.5,0,.75,0],easeOutQuart:[.25,1,.5,1],easeInOutQuart:[.76,0,.24,1],easeInQuint:[.64,0,.78,0],easeOutQuint:[.22,1,.36,1],easeInOutQuint:[.83,0,.17,1],easeInExpo:[.7,0,.84,0],easeOutExpo:[.16,1,.3,1],easeInOutExpo:[.87,0,.13,1],easeInCirc:[.55,0,1,.45],easeOutCirc:[0,.55,.45,1],easeInOutCirc:[.85,0,.15,1],easeInBack:[.36,0,.66,-.56],easeOutBack:[.34,1.56,.64,1],easeInOutBack:[.68,-.6,.32,1.6]};__spreadValues({linear:identity$1},_TransitionPresets);function useVModel(t,r,e,n={}){var g,y,i;const{clone:k=!1,passive:L=!1,eventName:$,deep:V=!1,defaultValue:z}=n,re=getCurrentInstance(),oe=e||(re==null?void 0:re.emit)||((g=re==null?void 0:re.$emit)==null?void 0:g.bind(re))||((i=(y=re==null?void 0:re.proxy)==null?void 0:y.$emit)==null?void 0:i.bind(re==null?void 0:re.proxy));let le=$;r||(r="modelValue"),le=$||le||`update:${r.toString()}`;const ue=ae=>k?isFunction$2(k)?k(ae):cloneFnJSON(ae):ae,ie=()=>isDef(t[r])?ue(t[r]):z;if(L){const ae=ie(),Ie=ref(ae);return watch(()=>t[r],de=>Ie.value=ue(de)),watch(Ie,de=>{(de!==t[r]||V)&&oe(le,de)},{deep:V}),Ie}else return computed({get(){return ie()},set(ae){oe(le,ae)}})}function useWindowSize(t={}){const{window:r=defaultWindow,initialWidth:e=1/0,initialHeight:n=1/0,listenOrientation:g=!0,includeScrollbar:y=!0}=t,i=ref(e),k=ref(n),L=()=>{r&&(y?(i.value=r.innerWidth,k.value=r.innerHeight):(i.value=r.document.documentElement.clientWidth,k.value=r.document.documentElement.clientHeight))};return L(),tryOnMounted(L),useEventListener("resize",L,{passive:!0}),g&&useEventListener("orientationchange",L,{passive:!0}),{width:i,height:k}}const isFirefox=()=>isClient&&/firefox/i.test(window.navigator.userAgent),isInContainer=(t,r)=>{if(!isClient||!t||!r)return!1;const e=t.getBoundingClientRect();let n;return r instanceof Element?n=r.getBoundingClientRect():n={top:0,right:window.innerWidth,bottom:window.innerHeight,left:0},e.top<n.bottom&&e.bottom>n.top&&e.right>n.left&&e.left<n.right};var freeGlobal=typeof global=="object"&&global&&global.Object===Object&&global;const freeGlobal$1=freeGlobal;var freeSelf=typeof self=="object"&&self&&self.Object===Object&&self,root=freeGlobal$1||freeSelf||Function("return this")();const root$1=root;var Symbol$1=root$1.Symbol;const Symbol$2=Symbol$1;var objectProto$f=Object.prototype,hasOwnProperty$d=objectProto$f.hasOwnProperty,nativeObjectToString$1=objectProto$f.toString,symToStringTag$1=Symbol$2?Symbol$2.toStringTag:void 0;function getRawTag(t){var r=hasOwnProperty$d.call(t,symToStringTag$1),e=t[symToStringTag$1];try{t[symToStringTag$1]=void 0;var n=!0}catch{}var g=nativeObjectToString$1.call(t);return n&&(r?t[symToStringTag$1]=e:delete t[symToStringTag$1]),g}var objectProto$e=Object.prototype,nativeObjectToString=objectProto$e.toString;function objectToString(t){return nativeObjectToString.call(t)}var nullTag="[object Null]",undefinedTag="[object Undefined]",symToStringTag=Symbol$2?Symbol$2.toStringTag:void 0;function baseGetTag(t){return t==null?t===void 0?undefinedTag:nullTag:symToStringTag&&symToStringTag in Object(t)?getRawTag(t):objectToString(t)}function isObjectLike(t){return t!=null&&typeof t=="object"}var symbolTag$3="[object Symbol]";function isSymbol(t){return typeof t=="symbol"||isObjectLike(t)&&baseGetTag(t)==symbolTag$3}function arrayMap(t,r){for(var e=-1,n=t==null?0:t.length,g=Array(n);++e<n;)g[e]=r(t[e],e,t);return g}var isArray$1=Array.isArray;const isArray$2=isArray$1;var INFINITY$3=1/0,symbolProto$2=Symbol$2?Symbol$2.prototype:void 0,symbolToString=symbolProto$2?symbolProto$2.toString:void 0;function baseToString(t){if(typeof t=="string")return t;if(isArray$2(t))return arrayMap(t,baseToString)+"";if(isSymbol(t))return symbolToString?symbolToString.call(t):"";var r=t+"";return r=="0"&&1/t==-INFINITY$3?"-0":r}var reWhitespace=/\s/;function trimmedEndIndex(t){for(var r=t.length;r--&&reWhitespace.test(t.charAt(r)););return r}var reTrimStart=/^\s+/;function baseTrim(t){return t&&t.slice(0,trimmedEndIndex(t)+1).replace(reTrimStart,"")}function isObject$1(t){var r=typeof t;return t!=null&&(r=="object"||r=="function")}var NAN=0/0,reIsBadHex=/^[-+]0x[0-9a-f]+$/i,reIsBinary=/^0b[01]+$/i,reIsOctal=/^0o[0-7]+$/i,freeParseInt=parseInt;function toNumber(t){if(typeof t=="number")return t;if(isSymbol(t))return NAN;if(isObject$1(t)){var r=typeof t.valueOf=="function"?t.valueOf():t;t=isObject$1(r)?r+"":r}if(typeof t!="string")return t===0?t:+t;t=baseTrim(t);var e=reIsBinary.test(t);return e||reIsOctal.test(t)?freeParseInt(t.slice(2),e?2:8):reIsBadHex.test(t)?NAN:+t}var INFINITY$2=1/0,MAX_INTEGER=17976931348623157e292;function toFinite(t){if(!t)return t===0?t:0;if(t=toNumber(t),t===INFINITY$2||t===-INFINITY$2){var r=t<0?-1:1;return r*MAX_INTEGER}return t===t?t:0}function toInteger(t){var r=toFinite(t),e=r%1;return r===r?e?r-e:r:0}function identity(t){return t}var asyncTag="[object AsyncFunction]",funcTag$2="[object Function]",genTag$1="[object GeneratorFunction]",proxyTag="[object Proxy]";function isFunction$1(t){if(!isObject$1(t))return!1;var r=baseGetTag(t);return r==funcTag$2||r==genTag$1||r==asyncTag||r==proxyTag}var coreJsData=root$1["__core-js_shared__"];const coreJsData$1=coreJsData;var maskSrcKey=function(){var t=/[^.]+$/.exec(coreJsData$1&&coreJsData$1.keys&&coreJsData$1.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}();function isMasked(t){return!!maskSrcKey&&maskSrcKey in t}var funcProto$2=Function.prototype,funcToString$2=funcProto$2.toString;function toSource(t){if(t!=null){try{return funcToString$2.call(t)}catch{}try{return t+""}catch{}}return""}var reRegExpChar=/[\\^$.*+?()[\]{}|]/g,reIsHostCtor=/^\[object .+?Constructor\]$/,funcProto$1=Function.prototype,objectProto$d=Object.prototype,funcToString$1=funcProto$1.toString,hasOwnProperty$c=objectProto$d.hasOwnProperty,reIsNative=RegExp("^"+funcToString$1.call(hasOwnProperty$c).replace(reRegExpChar,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function baseIsNative(t){if(!isObject$1(t)||isMasked(t))return!1;var r=isFunction$1(t)?reIsNative:reIsHostCtor;return r.test(toSource(t))}function getValue$1(t,r){return t==null?void 0:t[r]}function getNative(t,r){var e=getValue$1(t,r);return baseIsNative(e)?e:void 0}var WeakMap$1=getNative(root$1,"WeakMap");const WeakMap$2=WeakMap$1;var objectCreate=Object.create,baseCreate=function(){function t(){}return function(r){if(!isObject$1(r))return{};if(objectCreate)return objectCreate(r);t.prototype=r;var e=new t;return t.prototype=void 0,e}}();const baseCreate$1=baseCreate;function apply(t,r,e){switch(e.length){case 0:return t.call(r);case 1:return t.call(r,e[0]);case 2:return t.call(r,e[0],e[1]);case 3:return t.call(r,e[0],e[1],e[2])}return t.apply(r,e)}function copyArray(t,r){var e=-1,n=t.length;for(r||(r=Array(n));++e<n;)r[e]=t[e];return r}var HOT_COUNT=800,HOT_SPAN=16,nativeNow=Date.now;function shortOut(t){var r=0,e=0;return function(){var n=nativeNow(),g=HOT_SPAN-(n-e);if(e=n,g>0){if(++r>=HOT_COUNT)return arguments[0]}else r=0;return t.apply(void 0,arguments)}}function constant(t){return function(){return t}}var defineProperty=function(){try{var t=getNative(Object,"defineProperty");return t({},"",{}),t}catch{}}();const defineProperty$1=defineProperty;var baseSetToString=defineProperty$1?function(t,r){return defineProperty$1(t,"toString",{configurable:!0,enumerable:!1,value:constant(r),writable:!0})}:identity;const baseSetToString$1=baseSetToString;var setToString=shortOut(baseSetToString$1);const setToString$1=setToString;function arrayEach(t,r){for(var e=-1,n=t==null?0:t.length;++e<n&&r(t[e],e,t)!==!1;);return t}function baseFindIndex(t,r,e,n){for(var g=t.length,y=e+(n?1:-1);n?y--:++y<g;)if(r(t[y],y,t))return y;return-1}var MAX_SAFE_INTEGER$1=9007199254740991,reIsUint=/^(?:0|[1-9]\d*)$/;function isIndex(t,r){var e=typeof t;return r=r??MAX_SAFE_INTEGER$1,!!r&&(e=="number"||e!="symbol"&&reIsUint.test(t))&&t>-1&&t%1==0&&t<r}function baseAssignValue(t,r,e){r=="__proto__"&&defineProperty$1?defineProperty$1(t,r,{configurable:!0,enumerable:!0,value:e,writable:!0}):t[r]=e}function eq(t,r){return t===r||t!==t&&r!==r}var objectProto$c=Object.prototype,hasOwnProperty$b=objectProto$c.hasOwnProperty;function assignValue(t,r,e){var n=t[r];(!(hasOwnProperty$b.call(t,r)&&eq(n,e))||e===void 0&&!(r in t))&&baseAssignValue(t,r,e)}function copyObject(t,r,e,n){var g=!e;e||(e={});for(var y=-1,i=r.length;++y<i;){var k=r[y],L=n?n(e[k],t[k],k,e,t):void 0;L===void 0&&(L=t[k]),g?baseAssignValue(e,k,L):assignValue(e,k,L)}return e}var nativeMax$2=Math.max;function overRest(t,r,e){return r=nativeMax$2(r===void 0?t.length-1:r,0),function(){for(var n=arguments,g=-1,y=nativeMax$2(n.length-r,0),i=Array(y);++g<y;)i[g]=n[r+g];g=-1;for(var k=Array(r+1);++g<r;)k[g]=n[g];return k[r]=e(i),apply(t,this,k)}}function baseRest(t,r){return setToString$1(overRest(t,r,identity),t+"")}var MAX_SAFE_INTEGER=9007199254740991;function isLength(t){return typeof t=="number"&&t>-1&&t%1==0&&t<=MAX_SAFE_INTEGER}function isArrayLike(t){return t!=null&&isLength(t.length)&&!isFunction$1(t)}function isIterateeCall(t,r,e){if(!isObject$1(e))return!1;var n=typeof r;return(n=="number"?isArrayLike(e)&&isIndex(r,e.length):n=="string"&&r in e)?eq(e[r],t):!1}function createAssigner(t){return baseRest(function(r,e){var n=-1,g=e.length,y=g>1?e[g-1]:void 0,i=g>2?e[2]:void 0;for(y=t.length>3&&typeof y=="function"?(g--,y):void 0,i&&isIterateeCall(e[0],e[1],i)&&(y=g<3?void 0:y,g=1),r=Object(r);++n<g;){var k=e[n];k&&t(r,k,n,y)}return r})}var objectProto$b=Object.prototype;function isPrototype(t){var r=t&&t.constructor,e=typeof r=="function"&&r.prototype||objectProto$b;return t===e}function baseTimes(t,r){for(var e=-1,n=Array(t);++e<t;)n[e]=r(e);return n}var argsTag$3="[object Arguments]";function baseIsArguments(t){return isObjectLike(t)&&baseGetTag(t)==argsTag$3}var objectProto$a=Object.prototype,hasOwnProperty$a=objectProto$a.hasOwnProperty,propertyIsEnumerable$1=objectProto$a.propertyIsEnumerable,isArguments=baseIsArguments(function(){return arguments}())?baseIsArguments:function(t){return isObjectLike(t)&&hasOwnProperty$a.call(t,"callee")&&!propertyIsEnumerable$1.call(t,"callee")};const isArguments$1=isArguments;function stubFalse(){return!1}var freeExports$2=typeof exports=="object"&&exports&&!exports.nodeType&&exports,freeModule$2=freeExports$2&&typeof module=="object"&&module&&!module.nodeType&&module,moduleExports$2=freeModule$2&&freeModule$2.exports===freeExports$2,Buffer$2=moduleExports$2?root$1.Buffer:void 0,nativeIsBuffer=Buffer$2?Buffer$2.isBuffer:void 0,isBuffer$1=nativeIsBuffer||stubFalse;const isBuffer$2=isBuffer$1;var argsTag$2="[object Arguments]",arrayTag$2="[object Array]",boolTag$3="[object Boolean]",dateTag$3="[object Date]",errorTag$2="[object Error]",funcTag$1="[object Function]",mapTag$5="[object Map]",numberTag$3="[object Number]",objectTag$4="[object Object]",regexpTag$3="[object RegExp]",setTag$5="[object Set]",stringTag$3="[object String]",weakMapTag$2="[object WeakMap]",arrayBufferTag$3="[object ArrayBuffer]",dataViewTag$4="[object DataView]",float32Tag$2="[object Float32Array]",float64Tag$2="[object Float64Array]",int8Tag$2="[object Int8Array]",int16Tag$2="[object Int16Array]",int32Tag$2="[object Int32Array]",uint8Tag$2="[object Uint8Array]",uint8ClampedTag$2="[object Uint8ClampedArray]",uint16Tag$2="[object Uint16Array]",uint32Tag$2="[object Uint32Array]",typedArrayTags={};typedArrayTags[float32Tag$2]=typedArrayTags[float64Tag$2]=typedArrayTags[int8Tag$2]=typedArrayTags[int16Tag$2]=typedArrayTags[int32Tag$2]=typedArrayTags[uint8Tag$2]=typedArrayTags[uint8ClampedTag$2]=typedArrayTags[uint16Tag$2]=typedArrayTags[uint32Tag$2]=!0;typedArrayTags[argsTag$2]=typedArrayTags[arrayTag$2]=typedArrayTags[arrayBufferTag$3]=typedArrayTags[boolTag$3]=typedArrayTags[dataViewTag$4]=typedArrayTags[dateTag$3]=typedArrayTags[errorTag$2]=typedArrayTags[funcTag$1]=typedArrayTags[mapTag$5]=typedArrayTags[numberTag$3]=typedArrayTags[objectTag$4]=typedArrayTags[regexpTag$3]=typedArrayTags[setTag$5]=typedArrayTags[stringTag$3]=typedArrayTags[weakMapTag$2]=!1;function baseIsTypedArray(t){return isObjectLike(t)&&isLength(t.length)&&!!typedArrayTags[baseGetTag(t)]}function baseUnary(t){return function(r){return t(r)}}var freeExports$1=typeof exports=="object"&&exports&&!exports.nodeType&&exports,freeModule$1=freeExports$1&&typeof module=="object"&&module&&!module.nodeType&&module,moduleExports$1=freeModule$1&&freeModule$1.exports===freeExports$1,freeProcess=moduleExports$1&&freeGlobal$1.process,nodeUtil=function(){try{var t=freeModule$1&&freeModule$1.require&&freeModule$1.require("util").types;return t||freeProcess&&freeProcess.binding&&freeProcess.binding("util")}catch{}}();const nodeUtil$1=nodeUtil;var nodeIsTypedArray=nodeUtil$1&&nodeUtil$1.isTypedArray,isTypedArray$1=nodeIsTypedArray?baseUnary(nodeIsTypedArray):baseIsTypedArray;const isTypedArray$2=isTypedArray$1;var objectProto$9=Object.prototype,hasOwnProperty$9=objectProto$9.hasOwnProperty;function arrayLikeKeys(t,r){var e=isArray$2(t),n=!e&&isArguments$1(t),g=!e&&!n&&isBuffer$2(t),y=!e&&!n&&!g&&isTypedArray$2(t),i=e||n||g||y,k=i?baseTimes(t.length,String):[],L=k.length;for(var $ in t)(r||hasOwnProperty$9.call(t,$))&&!(i&&($=="length"||g&&($=="offset"||$=="parent")||y&&($=="buffer"||$=="byteLength"||$=="byteOffset")||isIndex($,L)))&&k.push($);return k}function overArg(t,r){return function(e){return t(r(e))}}var nativeKeys=overArg(Object.keys,Object);const nativeKeys$1=nativeKeys;var objectProto$8=Object.prototype,hasOwnProperty$8=objectProto$8.hasOwnProperty;function baseKeys(t){if(!isPrototype(t))return nativeKeys$1(t);var r=[];for(var e in Object(t))hasOwnProperty$8.call(t,e)&&e!="constructor"&&r.push(e);return r}function keys(t){return isArrayLike(t)?arrayLikeKeys(t):baseKeys(t)}function nativeKeysIn(t){var r=[];if(t!=null)for(var e in Object(t))r.push(e);return r}var objectProto$7=Object.prototype,hasOwnProperty$7=objectProto$7.hasOwnProperty;function baseKeysIn(t){if(!isObject$1(t))return nativeKeysIn(t);var r=isPrototype(t),e=[];for(var n in t)n=="constructor"&&(r||!hasOwnProperty$7.call(t,n))||e.push(n);return e}function keysIn(t){return isArrayLike(t)?arrayLikeKeys(t,!0):baseKeysIn(t)}var reIsDeepProp=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,reIsPlainProp=/^\w*$/;function isKey(t,r){if(isArray$2(t))return!1;var e=typeof t;return e=="number"||e=="symbol"||e=="boolean"||t==null||isSymbol(t)?!0:reIsPlainProp.test(t)||!reIsDeepProp.test(t)||r!=null&&t in Object(r)}var nativeCreate=getNative(Object,"create");const nativeCreate$1=nativeCreate;function hashClear(){this.__data__=nativeCreate$1?nativeCreate$1(null):{},this.size=0}function hashDelete(t){var r=this.has(t)&&delete this.__data__[t];return this.size-=r?1:0,r}var HASH_UNDEFINED$2="__lodash_hash_undefined__",objectProto$6=Object.prototype,hasOwnProperty$6=objectProto$6.hasOwnProperty;function hashGet(t){var r=this.__data__;if(nativeCreate$1){var e=r[t];return e===HASH_UNDEFINED$2?void 0:e}return hasOwnProperty$6.call(r,t)?r[t]:void 0}var objectProto$5=Object.prototype,hasOwnProperty$5=objectProto$5.hasOwnProperty;function hashHas(t){var r=this.__data__;return nativeCreate$1?r[t]!==void 0:hasOwnProperty$5.call(r,t)}var HASH_UNDEFINED$1="__lodash_hash_undefined__";function hashSet(t,r){var e=this.__data__;return this.size+=this.has(t)?0:1,e[t]=nativeCreate$1&&r===void 0?HASH_UNDEFINED$1:r,this}function Hash(t){var r=-1,e=t==null?0:t.length;for(this.clear();++r<e;){var n=t[r];this.set(n[0],n[1])}}Hash.prototype.clear=hashClear;Hash.prototype.delete=hashDelete;Hash.prototype.get=hashGet;Hash.prototype.has=hashHas;Hash.prototype.set=hashSet;function listCacheClear(){this.__data__=[],this.size=0}function assocIndexOf(t,r){for(var e=t.length;e--;)if(eq(t[e][0],r))return e;return-1}var arrayProto=Array.prototype,splice=arrayProto.splice;function listCacheDelete(t){var r=this.__data__,e=assocIndexOf(r,t);if(e<0)return!1;var n=r.length-1;return e==n?r.pop():splice.call(r,e,1),--this.size,!0}function listCacheGet(t){var r=this.__data__,e=assocIndexOf(r,t);return e<0?void 0:r[e][1]}function listCacheHas(t){return assocIndexOf(this.__data__,t)>-1}function listCacheSet(t,r){var e=this.__data__,n=assocIndexOf(e,t);return n<0?(++this.size,e.push([t,r])):e[n][1]=r,this}function ListCache(t){var r=-1,e=t==null?0:t.length;for(this.clear();++r<e;){var n=t[r];this.set(n[0],n[1])}}ListCache.prototype.clear=listCacheClear;ListCache.prototype.delete=listCacheDelete;ListCache.prototype.get=listCacheGet;ListCache.prototype.has=listCacheHas;ListCache.prototype.set=listCacheSet;var Map$1=getNative(root$1,"Map");const Map$2=Map$1;function mapCacheClear(){this.size=0,this.__data__={hash:new Hash,map:new(Map$2||ListCache),string:new Hash}}function isKeyable(t){var r=typeof t;return r=="string"||r=="number"||r=="symbol"||r=="boolean"?t!=="__proto__":t===null}function getMapData(t,r){var e=t.__data__;return isKeyable(r)?e[typeof r=="string"?"string":"hash"]:e.map}function mapCacheDelete(t){var r=getMapData(this,t).delete(t);return this.size-=r?1:0,r}function mapCacheGet(t){return getMapData(this,t).get(t)}function mapCacheHas(t){return getMapData(this,t).has(t)}function mapCacheSet(t,r){var e=getMapData(this,t),n=e.size;return e.set(t,r),this.size+=e.size==n?0:1,this}function MapCache(t){var r=-1,e=t==null?0:t.length;for(this.clear();++r<e;){var n=t[r];this.set(n[0],n[1])}}MapCache.prototype.clear=mapCacheClear;MapCache.prototype.delete=mapCacheDelete;MapCache.prototype.get=mapCacheGet;MapCache.prototype.has=mapCacheHas;MapCache.prototype.set=mapCacheSet;var FUNC_ERROR_TEXT$2="Expected a function";function memoize(t,r){if(typeof t!="function"||r!=null&&typeof r!="function")throw new TypeError(FUNC_ERROR_TEXT$2);var e=function(){var n=arguments,g=r?r.apply(this,n):n[0],y=e.cache;if(y.has(g))return y.get(g);var i=t.apply(this,n);return e.cache=y.set(g,i)||y,i};return e.cache=new(memoize.Cache||MapCache),e}memoize.Cache=MapCache;var MAX_MEMOIZE_SIZE=500;function memoizeCapped(t){var r=memoize(t,function(n){return e.size===MAX_MEMOIZE_SIZE&&e.clear(),n}),e=r.cache;return r}var rePropName=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,reEscapeChar=/\\(\\)?/g,stringToPath=memoizeCapped(function(t){var r=[];return t.charCodeAt(0)===46&&r.push(""),t.replace(rePropName,function(e,n,g,y){r.push(g?y.replace(reEscapeChar,"$1"):n||e)}),r});const stringToPath$1=stringToPath;function toString$1(t){return t==null?"":baseToString(t)}function castPath(t,r){return isArray$2(t)?t:isKey(t,r)?[t]:stringToPath$1(toString$1(t))}var INFINITY$1=1/0;function toKey(t){if(typeof t=="string"||isSymbol(t))return t;var r=t+"";return r=="0"&&1/t==-INFINITY$1?"-0":r}function baseGet(t,r){r=castPath(r,t);for(var e=0,n=r.length;t!=null&&e<n;)t=t[toKey(r[e++])];return e&&e==n?t:void 0}function get(t,r,e){var n=t==null?void 0:baseGet(t,r);return n===void 0?e:n}function arrayPush(t,r){for(var e=-1,n=r.length,g=t.length;++e<n;)t[g+e]=r[e];return t}var spreadableSymbol=Symbol$2?Symbol$2.isConcatSpreadable:void 0;function isFlattenable(t){return isArray$2(t)||isArguments$1(t)||!!(spreadableSymbol&&t&&t[spreadableSymbol])}function baseFlatten(t,r,e,n,g){var y=-1,i=t.length;for(e||(e=isFlattenable),g||(g=[]);++y<i;){var k=t[y];r>0&&e(k)?r>1?baseFlatten(k,r-1,e,n,g):arrayPush(g,k):n||(g[g.length]=k)}return g}function flatten(t){var r=t==null?0:t.length;return r?baseFlatten(t,1):[]}function flatRest(t){return setToString$1(overRest(t,void 0,flatten),t+"")}var getPrototype=overArg(Object.getPrototypeOf,Object);const getPrototype$1=getPrototype;var objectTag$3="[object Object]",funcProto=Function.prototype,objectProto$4=Object.prototype,funcToString=funcProto.toString,hasOwnProperty$4=objectProto$4.hasOwnProperty,objectCtorString=funcToString.call(Object);function isPlainObject$1(t){if(!isObjectLike(t)||baseGetTag(t)!=objectTag$3)return!1;var r=getPrototype$1(t);if(r===null)return!0;var e=hasOwnProperty$4.call(r,"constructor")&&r.constructor;return typeof e=="function"&&e instanceof e&&funcToString.call(e)==objectCtorString}function castArray$1(){if(!arguments.length)return[];var t=arguments[0];return isArray$2(t)?t:[t]}function stackClear(){this.__data__=new ListCache,this.size=0}function stackDelete(t){var r=this.__data__,e=r.delete(t);return this.size=r.size,e}function stackGet(t){return this.__data__.get(t)}function stackHas(t){return this.__data__.has(t)}var LARGE_ARRAY_SIZE=200;function stackSet(t,r){var e=this.__data__;if(e instanceof ListCache){var n=e.__data__;if(!Map$2||n.length<LARGE_ARRAY_SIZE-1)return n.push([t,r]),this.size=++e.size,this;e=this.__data__=new MapCache(n)}return e.set(t,r),this.size=e.size,this}function Stack(t){var r=this.__data__=new ListCache(t);this.size=r.size}Stack.prototype.clear=stackClear;Stack.prototype.delete=stackDelete;Stack.prototype.get=stackGet;Stack.prototype.has=stackHas;Stack.prototype.set=stackSet;function baseAssign(t,r){return t&&copyObject(r,keys(r),t)}function baseAssignIn(t,r){return t&&copyObject(r,keysIn(r),t)}var freeExports=typeof exports=="object"&&exports&&!exports.nodeType&&exports,freeModule=freeExports&&typeof module=="object"&&module&&!module.nodeType&&module,moduleExports=freeModule&&freeModule.exports===freeExports,Buffer$1=moduleExports?root$1.Buffer:void 0,allocUnsafe=Buffer$1?Buffer$1.allocUnsafe:void 0;function cloneBuffer(t,r){if(r)return t.slice();var e=t.length,n=allocUnsafe?allocUnsafe(e):new t.constructor(e);return t.copy(n),n}function arrayFilter(t,r){for(var e=-1,n=t==null?0:t.length,g=0,y=[];++e<n;){var i=t[e];r(i,e,t)&&(y[g++]=i)}return y}function stubArray(){return[]}var objectProto$3=Object.prototype,propertyIsEnumerable=objectProto$3.propertyIsEnumerable,nativeGetSymbols$1=Object.getOwnPropertySymbols,getSymbols=nativeGetSymbols$1?function(t){return t==null?[]:(t=Object(t),arrayFilter(nativeGetSymbols$1(t),function(r){return propertyIsEnumerable.call(t,r)}))}:stubArray;const getSymbols$1=getSymbols;function copySymbols(t,r){return copyObject(t,getSymbols$1(t),r)}var nativeGetSymbols=Object.getOwnPropertySymbols,getSymbolsIn=nativeGetSymbols?function(t){for(var r=[];t;)arrayPush(r,getSymbols$1(t)),t=getPrototype$1(t);return r}:stubArray;const getSymbolsIn$1=getSymbolsIn;function copySymbolsIn(t,r){return copyObject(t,getSymbolsIn$1(t),r)}function baseGetAllKeys(t,r,e){var n=r(t);return isArray$2(t)?n:arrayPush(n,e(t))}function getAllKeys(t){return baseGetAllKeys(t,keys,getSymbols$1)}function getAllKeysIn(t){return baseGetAllKeys(t,keysIn,getSymbolsIn$1)}var DataView$1=getNative(root$1,"DataView");const DataView$2=DataView$1;var Promise$1=getNative(root$1,"Promise");const Promise$2=Promise$1;var Set$1=getNative(root$1,"Set");const Set$2=Set$1;var mapTag$4="[object Map]",objectTag$2="[object Object]",promiseTag="[object Promise]",setTag$4="[object Set]",weakMapTag$1="[object WeakMap]",dataViewTag$3="[object DataView]",dataViewCtorString=toSource(DataView$2),mapCtorString=toSource(Map$2),promiseCtorString=toSource(Promise$2),setCtorString=toSource(Set$2),weakMapCtorString=toSource(WeakMap$2),getTag=baseGetTag;(DataView$2&&getTag(new DataView$2(new ArrayBuffer(1)))!=dataViewTag$3||Map$2&&getTag(new Map$2)!=mapTag$4||Promise$2&&getTag(Promise$2.resolve())!=promiseTag||Set$2&&getTag(new Set$2)!=setTag$4||WeakMap$2&&getTag(new WeakMap$2)!=weakMapTag$1)&&(getTag=function(t){var r=baseGetTag(t),e=r==objectTag$2?t.constructor:void 0,n=e?toSource(e):"";if(n)switch(n){case dataViewCtorString:return dataViewTag$3;case mapCtorString:return mapTag$4;case promiseCtorString:return promiseTag;case setCtorString:return setTag$4;case weakMapCtorString:return weakMapTag$1}return r});const getTag$1=getTag;var objectProto$2=Object.prototype,hasOwnProperty$3=objectProto$2.hasOwnProperty;function initCloneArray(t){var r=t.length,e=new t.constructor(r);return r&&typeof t[0]=="string"&&hasOwnProperty$3.call(t,"index")&&(e.index=t.index,e.input=t.input),e}var Uint8Array$1=root$1.Uint8Array;const Uint8Array$2=Uint8Array$1;function cloneArrayBuffer(t){var r=new t.constructor(t.byteLength);return new Uint8Array$2(r).set(new Uint8Array$2(t)),r}function cloneDataView(t,r){var e=r?cloneArrayBuffer(t.buffer):t.buffer;return new t.constructor(e,t.byteOffset,t.byteLength)}var reFlags=/\w*$/;function cloneRegExp(t){var r=new t.constructor(t.source,reFlags.exec(t));return r.lastIndex=t.lastIndex,r}var symbolProto$1=Symbol$2?Symbol$2.prototype:void 0,symbolValueOf$1=symbolProto$1?symbolProto$1.valueOf:void 0;function cloneSymbol(t){return symbolValueOf$1?Object(symbolValueOf$1.call(t)):{}}function cloneTypedArray(t,r){var e=r?cloneArrayBuffer(t.buffer):t.buffer;return new t.constructor(e,t.byteOffset,t.length)}var boolTag$2="[object Boolean]",dateTag$2="[object Date]",mapTag$3="[object Map]",numberTag$2="[object Number]",regexpTag$2="[object RegExp]",setTag$3="[object Set]",stringTag$2="[object String]",symbolTag$2="[object Symbol]",arrayBufferTag$2="[object ArrayBuffer]",dataViewTag$2="[object DataView]",float32Tag$1="[object Float32Array]",float64Tag$1="[object Float64Array]",int8Tag$1="[object Int8Array]",int16Tag$1="[object Int16Array]",int32Tag$1="[object Int32Array]",uint8Tag$1="[object Uint8Array]",uint8ClampedTag$1="[object Uint8ClampedArray]",uint16Tag$1="[object Uint16Array]",uint32Tag$1="[object Uint32Array]";function initCloneByTag(t,r,e){var n=t.constructor;switch(r){case arrayBufferTag$2:return cloneArrayBuffer(t);case boolTag$2:case dateTag$2:return new n(+t);case dataViewTag$2:return cloneDataView(t,e);case float32Tag$1:case float64Tag$1:case int8Tag$1:case int16Tag$1:case int32Tag$1:case uint8Tag$1:case uint8ClampedTag$1:case uint16Tag$1:case uint32Tag$1:return cloneTypedArray(t,e);case mapTag$3:return new n;case numberTag$2:case stringTag$2:return new n(t);case regexpTag$2:return cloneRegExp(t);case setTag$3:return new n;case symbolTag$2:return cloneSymbol(t)}}function initCloneObject(t){return typeof t.constructor=="function"&&!isPrototype(t)?baseCreate$1(getPrototype$1(t)):{}}var mapTag$2="[object Map]";function baseIsMap(t){return isObjectLike(t)&&getTag$1(t)==mapTag$2}var nodeIsMap=nodeUtil$1&&nodeUtil$1.isMap,isMap=nodeIsMap?baseUnary(nodeIsMap):baseIsMap;const isMap$1=isMap;var setTag$2="[object Set]";function baseIsSet(t){return isObjectLike(t)&&getTag$1(t)==setTag$2}var nodeIsSet=nodeUtil$1&&nodeUtil$1.isSet,isSet=nodeIsSet?baseUnary(nodeIsSet):baseIsSet;const isSet$1=isSet;var CLONE_DEEP_FLAG$1=1,CLONE_FLAT_FLAG=2,CLONE_SYMBOLS_FLAG$2=4,argsTag$1="[object Arguments]",arrayTag$1="[object Array]",boolTag$1="[object Boolean]",dateTag$1="[object Date]",errorTag$1="[object Error]",funcTag="[object Function]",genTag="[object GeneratorFunction]",mapTag$1="[object Map]",numberTag$1="[object Number]",objectTag$1="[object Object]",regexpTag$1="[object RegExp]",setTag$1="[object Set]",stringTag$1="[object String]",symbolTag$1="[object Symbol]",weakMapTag="[object WeakMap]",arrayBufferTag$1="[object ArrayBuffer]",dataViewTag$1="[object DataView]",float32Tag="[object Float32Array]",float64Tag="[object Float64Array]",int8Tag="[object Int8Array]",int16Tag="[object Int16Array]",int32Tag="[object Int32Array]",uint8Tag="[object Uint8Array]",uint8ClampedTag="[object Uint8ClampedArray]",uint16Tag="[object Uint16Array]",uint32Tag="[object Uint32Array]",cloneableTags={};cloneableTags[argsTag$1]=cloneableTags[arrayTag$1]=cloneableTags[arrayBufferTag$1]=cloneableTags[dataViewTag$1]=cloneableTags[boolTag$1]=cloneableTags[dateTag$1]=cloneableTags[float32Tag]=cloneableTags[float64Tag]=cloneableTags[int8Tag]=cloneableTags[int16Tag]=cloneableTags[int32Tag]=cloneableTags[mapTag$1]=cloneableTags[numberTag$1]=cloneableTags[objectTag$1]=cloneableTags[regexpTag$1]=cloneableTags[setTag$1]=cloneableTags[stringTag$1]=cloneableTags[symbolTag$1]=cloneableTags[uint8Tag]=cloneableTags[uint8ClampedTag]=cloneableTags[uint16Tag]=cloneableTags[uint32Tag]=!0;cloneableTags[errorTag$1]=cloneableTags[funcTag]=cloneableTags[weakMapTag]=!1;function baseClone(t,r,e,n,g,y){var i,k=r&CLONE_DEEP_FLAG$1,L=r&CLONE_FLAT_FLAG,$=r&CLONE_SYMBOLS_FLAG$2;if(e&&(i=g?e(t,n,g,y):e(t)),i!==void 0)return i;if(!isObject$1(t))return t;var V=isArray$2(t);if(V){if(i=initCloneArray(t),!k)return copyArray(t,i)}else{var z=getTag$1(t),re=z==funcTag||z==genTag;if(isBuffer$2(t))return cloneBuffer(t,k);if(z==objectTag$1||z==argsTag$1||re&&!g){if(i=L||re?{}:initCloneObject(t),!k)return L?copySymbolsIn(t,baseAssignIn(i,t)):copySymbols(t,baseAssign(i,t))}else{if(!cloneableTags[z])return g?t:{};i=initCloneByTag(t,z,k)}}y||(y=new Stack);var oe=y.get(t);if(oe)return oe;y.set(t,i),isSet$1(t)?t.forEach(function(ie){i.add(baseClone(ie,r,e,ie,t,y))}):isMap$1(t)&&t.forEach(function(ie,ae){i.set(ae,baseClone(ie,r,e,ae,t,y))});var le=$?L?getAllKeysIn:getAllKeys:L?keysIn:keys,ue=V?void 0:le(t);return arrayEach(ue||t,function(ie,ae){ue&&(ae=ie,ie=t[ae]),assignValue(i,ae,baseClone(ie,r,e,ae,t,y))}),i}var CLONE_SYMBOLS_FLAG$1=4;function clone(t){return baseClone(t,CLONE_SYMBOLS_FLAG$1)}var CLONE_DEEP_FLAG=1,CLONE_SYMBOLS_FLAG=4;function cloneDeep(t){return baseClone(t,CLONE_DEEP_FLAG|CLONE_SYMBOLS_FLAG)}var HASH_UNDEFINED="__lodash_hash_undefined__";function setCacheAdd(t){return this.__data__.set(t,HASH_UNDEFINED),this}function setCacheHas(t){return this.__data__.has(t)}function SetCache(t){var r=-1,e=t==null?0:t.length;for(this.__data__=new MapCache;++r<e;)this.add(t[r])}SetCache.prototype.add=SetCache.prototype.push=setCacheAdd;SetCache.prototype.has=setCacheHas;function arraySome(t,r){for(var e=-1,n=t==null?0:t.length;++e<n;)if(r(t[e],e,t))return!0;return!1}function cacheHas(t,r){return t.has(r)}var COMPARE_PARTIAL_FLAG$5=1,COMPARE_UNORDERED_FLAG$3=2;function equalArrays(t,r,e,n,g,y){var i=e&COMPARE_PARTIAL_FLAG$5,k=t.length,L=r.length;if(k!=L&&!(i&&L>k))return!1;var $=y.get(t),V=y.get(r);if($&&V)return $==r&&V==t;var z=-1,re=!0,oe=e&COMPARE_UNORDERED_FLAG$3?new SetCache:void 0;for(y.set(t,r),y.set(r,t);++z<k;){var le=t[z],ue=r[z];if(n)var ie=i?n(ue,le,z,r,t,y):n(le,ue,z,t,r,y);if(ie!==void 0){if(ie)continue;re=!1;break}if(oe){if(!arraySome(r,function(ae,Ie){if(!cacheHas(oe,Ie)&&(le===ae||g(le,ae,e,n,y)))return oe.push(Ie)})){re=!1;break}}else if(!(le===ue||g(le,ue,e,n,y))){re=!1;break}}return y.delete(t),y.delete(r),re}function mapToArray(t){var r=-1,e=Array(t.size);return t.forEach(function(n,g){e[++r]=[g,n]}),e}function setToArray(t){var r=-1,e=Array(t.size);return t.forEach(function(n){e[++r]=n}),e}var COMPARE_PARTIAL_FLAG$4=1,COMPARE_UNORDERED_FLAG$2=2,boolTag="[object Boolean]",dateTag="[object Date]",errorTag="[object Error]",mapTag="[object Map]",numberTag="[object Number]",regexpTag="[object RegExp]",setTag="[object Set]",stringTag="[object String]",symbolTag="[object Symbol]",arrayBufferTag="[object ArrayBuffer]",dataViewTag="[object DataView]",symbolProto=Symbol$2?Symbol$2.prototype:void 0,symbolValueOf=symbolProto?symbolProto.valueOf:void 0;function equalByTag(t,r,e,n,g,y,i){switch(e){case dataViewTag:if(t.byteLength!=r.byteLength||t.byteOffset!=r.byteOffset)return!1;t=t.buffer,r=r.buffer;case arrayBufferTag:return!(t.byteLength!=r.byteLength||!y(new Uint8Array$2(t),new Uint8Array$2(r)));case boolTag:case dateTag:case numberTag:return eq(+t,+r);case errorTag:return t.name==r.name&&t.message==r.message;case regexpTag:case stringTag:return t==r+"";case mapTag:var k=mapToArray;case setTag:var L=n&COMPARE_PARTIAL_FLAG$4;if(k||(k=setToArray),t.size!=r.size&&!L)return!1;var $=i.get(t);if($)return $==r;n|=COMPARE_UNORDERED_FLAG$2,i.set(t,r);var V=equalArrays(k(t),k(r),n,g,y,i);return i.delete(t),V;case symbolTag:if(symbolValueOf)return symbolValueOf.call(t)==symbolValueOf.call(r)}return!1}var COMPARE_PARTIAL_FLAG$3=1,objectProto$1=Object.prototype,hasOwnProperty$2=objectProto$1.hasOwnProperty;function equalObjects(t,r,e,n,g,y){var i=e&COMPARE_PARTIAL_FLAG$3,k=getAllKeys(t),L=k.length,$=getAllKeys(r),V=$.length;if(L!=V&&!i)return!1;for(var z=L;z--;){var re=k[z];if(!(i?re in r:hasOwnProperty$2.call(r,re)))return!1}var oe=y.get(t),le=y.get(r);if(oe&&le)return oe==r&&le==t;var ue=!0;y.set(t,r),y.set(r,t);for(var ie=i;++z<L;){re=k[z];var ae=t[re],Ie=r[re];if(n)var de=i?n(Ie,ae,re,r,t,y):n(ae,Ie,re,t,r,y);if(!(de===void 0?ae===Ie||g(ae,Ie,e,n,y):de)){ue=!1;break}ie||(ie=re=="constructor")}if(ue&&!ie){var Ce=t.constructor,Ue=r.constructor;Ce!=Ue&&"constructor"in t&&"constructor"in r&&!(typeof Ce=="function"&&Ce instanceof Ce&&typeof Ue=="function"&&Ue instanceof Ue)&&(ue=!1)}return y.delete(t),y.delete(r),ue}var COMPARE_PARTIAL_FLAG$2=1,argsTag="[object Arguments]",arrayTag="[object Array]",objectTag="[object Object]",objectProto=Object.prototype,hasOwnProperty$1=objectProto.hasOwnProperty;function baseIsEqualDeep(t,r,e,n,g,y){var i=isArray$2(t),k=isArray$2(r),L=i?arrayTag:getTag$1(t),$=k?arrayTag:getTag$1(r);L=L==argsTag?objectTag:L,$=$==argsTag?objectTag:$;var V=L==objectTag,z=$==objectTag,re=L==$;if(re&&isBuffer$2(t)){if(!isBuffer$2(r))return!1;i=!0,V=!1}if(re&&!V)return y||(y=new Stack),i||isTypedArray$2(t)?equalArrays(t,r,e,n,g,y):equalByTag(t,r,L,e,n,g,y);if(!(e&COMPARE_PARTIAL_FLAG$2)){var oe=V&&hasOwnProperty$1.call(t,"__wrapped__"),le=z&&hasOwnProperty$1.call(r,"__wrapped__");if(oe||le){var ue=oe?t.value():t,ie=le?r.value():r;return y||(y=new Stack),g(ue,ie,e,n,y)}}return re?(y||(y=new Stack),equalObjects(t,r,e,n,g,y)):!1}function baseIsEqual(t,r,e,n,g){return t===r?!0:t==null||r==null||!isObjectLike(t)&&!isObjectLike(r)?t!==t&&r!==r:baseIsEqualDeep(t,r,e,n,baseIsEqual,g)}var COMPARE_PARTIAL_FLAG$1=1,COMPARE_UNORDERED_FLAG$1=2;function baseIsMatch(t,r,e,n){var g=e.length,y=g,i=!n;if(t==null)return!y;for(t=Object(t);g--;){var k=e[g];if(i&&k[2]?k[1]!==t[k[0]]:!(k[0]in t))return!1}for(;++g<y;){k=e[g];var L=k[0],$=t[L],V=k[1];if(i&&k[2]){if($===void 0&&!(L in t))return!1}else{var z=new Stack;if(n)var re=n($,V,L,t,r,z);if(!(re===void 0?baseIsEqual(V,$,COMPARE_PARTIAL_FLAG$1|COMPARE_UNORDERED_FLAG$1,n,z):re))return!1}}return!0}function isStrictComparable(t){return t===t&&!isObject$1(t)}function getMatchData(t){for(var r=keys(t),e=r.length;e--;){var n=r[e],g=t[n];r[e]=[n,g,isStrictComparable(g)]}return r}function matchesStrictComparable(t,r){return function(e){return e==null?!1:e[t]===r&&(r!==void 0||t in Object(e))}}function baseMatches(t){var r=getMatchData(t);return r.length==1&&r[0][2]?matchesStrictComparable(r[0][0],r[0][1]):function(e){return e===t||baseIsMatch(e,t,r)}}function baseHasIn(t,r){return t!=null&&r in Object(t)}function hasPath(t,r,e){r=castPath(r,t);for(var n=-1,g=r.length,y=!1;++n<g;){var i=toKey(r[n]);if(!(y=t!=null&&e(t,i)))break;t=t[i]}return y||++n!=g?y:(g=t==null?0:t.length,!!g&&isLength(g)&&isIndex(i,g)&&(isArray$2(t)||isArguments$1(t)))}function hasIn(t,r){return t!=null&&hasPath(t,r,baseHasIn)}var COMPARE_PARTIAL_FLAG=1,COMPARE_UNORDERED_FLAG=2;function baseMatchesProperty(t,r){return isKey(t)&&isStrictComparable(r)?matchesStrictComparable(toKey(t),r):function(e){var n=get(e,t);return n===void 0&&n===r?hasIn(e,t):baseIsEqual(r,n,COMPARE_PARTIAL_FLAG|COMPARE_UNORDERED_FLAG)}}function baseProperty(t){return function(r){return r==null?void 0:r[t]}}function basePropertyDeep(t){return function(r){return baseGet(r,t)}}function property(t){return isKey(t)?baseProperty(toKey(t)):basePropertyDeep(t)}function baseIteratee(t){return typeof t=="function"?t:t==null?identity:typeof t=="object"?isArray$2(t)?baseMatchesProperty(t[0],t[1]):baseMatches(t):property(t)}function createBaseFor(t){return function(r,e,n){for(var g=-1,y=Object(r),i=n(r),k=i.length;k--;){var L=i[t?k:++g];if(e(y[L],L,y)===!1)break}return r}}var baseFor=createBaseFor();const baseFor$1=baseFor;function baseForOwn(t,r){return t&&baseFor$1(t,r,keys)}function createBaseEach(t,r){return function(e,n){if(e==null)return e;if(!isArrayLike(e))return t(e,n);for(var g=e.length,y=r?g:-1,i=Object(e);(r?y--:++y<g)&&n(i[y],y,i)!==!1;);return e}}var baseEach=createBaseEach(baseForOwn);const baseEach$1=baseEach;var now=function(){return root$1.Date.now()};const now$1=now;var FUNC_ERROR_TEXT$1="Expected a function",nativeMax$1=Math.max,nativeMin$1=Math.min;function debounce(t,r,e){var n,g,y,i,k,L,$=0,V=!1,z=!1,re=!0;if(typeof t!="function")throw new TypeError(FUNC_ERROR_TEXT$1);r=toNumber(r)||0,isObject$1(e)&&(V=!!e.leading,z="maxWait"in e,y=z?nativeMax$1(toNumber(e.maxWait)||0,r):y,re="trailing"in e?!!e.trailing:re);function oe(qe){var jt=n,Fe=g;return n=g=void 0,$=qe,i=t.apply(Fe,jt),i}function le(qe){return $=qe,k=setTimeout(ae,r),V?oe(qe):i}function ue(qe){var jt=qe-L,Fe=qe-$,Et=r-jt;return z?nativeMin$1(Et,y-Fe):Et}function ie(qe){var jt=qe-L,Fe=qe-$;return L===void 0||jt>=r||jt<0||z&&Fe>=y}function ae(){var qe=now$1();if(ie(qe))return Ie(qe);k=setTimeout(ae,ue(qe))}function Ie(qe){return k=void 0,re&&n?oe(qe):(n=g=void 0,i)}function de(){k!==void 0&&clearTimeout(k),$=0,n=L=g=k=void 0}function Ce(){return k===void 0?i:Ie(now$1())}function Ue(){var qe=now$1(),jt=ie(qe);if(n=arguments,g=this,L=qe,jt){if(k===void 0)return le(L);if(z)return clearTimeout(k),k=setTimeout(ae,r),oe(L)}return k===void 0&&(k=setTimeout(ae,r)),i}return Ue.cancel=de,Ue.flush=Ce,Ue}function assignMergeValue(t,r,e){(e!==void 0&&!eq(t[r],e)||e===void 0&&!(r in t))&&baseAssignValue(t,r,e)}function isArrayLikeObject(t){return isObjectLike(t)&&isArrayLike(t)}function safeGet(t,r){if(!(r==="constructor"&&typeof t[r]=="function")&&r!="__proto__")return t[r]}function toPlainObject(t){return copyObject(t,keysIn(t))}function baseMergeDeep(t,r,e,n,g,y,i){var k=safeGet(t,e),L=safeGet(r,e),$=i.get(L);if($){assignMergeValue(t,e,$);return}var V=y?y(k,L,e+"",t,r,i):void 0,z=V===void 0;if(z){var re=isArray$2(L),oe=!re&&isBuffer$2(L),le=!re&&!oe&&isTypedArray$2(L);V=L,re||oe||le?isArray$2(k)?V=k:isArrayLikeObject(k)?V=copyArray(k):oe?(z=!1,V=cloneBuffer(L,!0)):le?(z=!1,V=cloneTypedArray(L,!0)):V=[]:isPlainObject$1(L)||isArguments$1(L)?(V=k,isArguments$1(k)?V=toPlainObject(k):(!isObject$1(k)||isFunction$1(k))&&(V=initCloneObject(L))):z=!1}z&&(i.set(L,V),g(V,L,n,y,i),i.delete(L)),assignMergeValue(t,e,V)}function baseMerge(t,r,e,n,g){t!==r&&baseFor$1(r,function(y,i){if(g||(g=new Stack),isObject$1(y))baseMergeDeep(t,r,i,e,baseMerge,n,g);else{var k=n?n(safeGet(t,i),y,i+"",t,r,g):void 0;k===void 0&&(k=y),assignMergeValue(t,i,k)}},keysIn)}var nativeMax=Math.max,nativeMin=Math.min;function findLastIndex(t,r,e){var n=t==null?0:t.length;if(!n)return-1;var g=n-1;return e!==void 0&&(g=toInteger(e),g=e<0?nativeMax(n+g,0):nativeMin(g,n-1)),baseFindIndex(t,baseIteratee(r),g,!0)}function baseMap(t,r){var e=-1,n=isArrayLike(t)?Array(t.length):[];return baseEach$1(t,function(g,y,i){n[++e]=r(g,y,i)}),n}function map(t,r){var e=isArray$2(t)?arrayMap:baseMap;return e(t,baseIteratee(r))}function flatMap(t,r){return baseFlatten(map(t,r),1)}var INFINITY=1/0;function flattenDeep(t){var r=t==null?0:t.length;return r?baseFlatten(t,INFINITY):[]}function fromPairs(t){for(var r=-1,e=t==null?0:t.length,n={};++r<e;){var g=t[r];n[g[0]]=g[1]}return n}function isEqual(t,r){return baseIsEqual(t,r)}function isNil(t){return t==null}function isUndefined$2(t){return t===void 0}var merge$1=createAssigner(function(t,r,e){baseMerge(t,r,e)});const merge$2=merge$1;function baseSet(t,r,e,n){if(!isObject$1(t))return t;r=castPath(r,t);for(var g=-1,y=r.length,i=y-1,k=t;k!=null&&++g<y;){var L=toKey(r[g]),$=e;if(L==="__proto__"||L==="constructor"||L==="prototype")return t;if(g!=i){var V=k[L];$=n?n(V,L,k):void 0,$===void 0&&($=isObject$1(V)?V:isIndex(r[g+1])?[]:{})}assignValue(k,L,$),k=k[L]}return t}function basePickBy(t,r,e){for(var n=-1,g=r.length,y={};++n<g;){var i=r[n],k=baseGet(t,i);e(k,i)&&baseSet(y,castPath(i,t),k)}return y}function basePick(t,r){return basePickBy(t,r,function(e,n){return hasIn(t,n)})}var pick=flatRest(function(t,r){return t==null?{}:basePick(t,r)});const pick$1=pick;function set(t,r,e){return t==null?t:baseSet(t,r,e)}var FUNC_ERROR_TEXT="Expected a function";function throttle(t,r,e){var n=!0,g=!0;if(typeof t!="function")throw new TypeError(FUNC_ERROR_TEXT);return isObject$1(e)&&(n="leading"in e?!!e.leading:n,g="trailing"in e?!!e.trailing:g),debounce(t,r,{leading:n,maxWait:r,trailing:g})}const isUndefined$1=t=>t===void 0,isBoolean$1=t=>typeof t=="boolean",isNumber$1=t=>typeof t=="number",isEmpty=t=>!t&&t!==0||isArray$3(t)&&t.length===0||isObject$2(t)&&!Object.keys(t).length,isElement=t=>typeof Element>"u"?!1:t instanceof Element,isStringNumber=t=>isString$2(t)?!Number.isNaN(Number(t)):!1,escapeStringRegexp=(t="")=>t.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&").replace(/-/g,"\\x2d"),capitalize=t=>capitalize$1(t),keysOf=t=>Object.keys(t),entriesOf=t=>Object.entries(t),getProp=(t,r,e)=>({get value(){return get(t,r,e)},set value(n){set(t,r,n)}});class ElementPlusError extends Error{constructor(r){super(r),this.name="ElementPlusError"}}function throwError(t,r){throw new ElementPlusError(`[${t}] ${r}`)}function debugWarn(t,r){}const classNameToArray=(t="")=>t.split(" ").filter(r=>!!r.trim()),hasClass=(t,r)=>{if(!t||!r)return!1;if(r.includes(" "))throw new Error("className should not contain space.");return t.classList.contains(r)},addClass=(t,r)=>{!t||!r.trim()||t.classList.add(...classNameToArray(r))},removeClass=(t,r)=>{!t||!r.trim()||t.classList.remove(...classNameToArray(r))},getStyle=(t,r)=>{var e;if(!isClient||!t||!r)return"";let n=camelize(r);n==="float"&&(n="cssFloat");try{const g=t.style[n];if(g)return g;const y=(e=document.defaultView)==null?void 0:e.getComputedStyle(t,"");return y?y[n]:""}catch{return t.style[n]}};function addUnit(t,r="px"){if(!t)return"";if(isNumber$1(t)||isStringNumber(t))return`${t}${r}`;if(isString$2(t))return t}const isScroll=(t,r)=>{if(!isClient)return!1;const e={undefined:"overflow",true:"overflow-y",false:"overflow-x"}[String(r)],n=getStyle(t,e);return["scroll","auto","overlay"].some(g=>n.includes(g))},getScrollContainer=(t,r)=>{if(!isClient)return;let e=t;for(;e;){if([window,document,document.documentElement].includes(e))return window;if(isScroll(e,r))return e;e=e.parentNode}return e};let scrollBarWidth;const getScrollBarWidth=t=>{var r;if(!isClient)return 0;if(scrollBarWidth!==void 0)return scrollBarWidth;const e=document.createElement("div");e.className=`${t}-scrollbar__wrap`,e.style.visibility="hidden",e.style.width="100px",e.style.position="absolute",e.style.top="-9999px",document.body.appendChild(e);const n=e.offsetWidth;e.style.overflow="scroll";const g=document.createElement("div");g.style.width="100%",e.appendChild(g);const y=g.offsetWidth;return(r=e.parentNode)==null||r.removeChild(e),scrollBarWidth=n-y,scrollBarWidth};function scrollIntoView(t,r){if(!isClient)return;if(!r){t.scrollTop=0;return}const e=[];let n=r.offsetParent;for(;n!==null&&t!==n&&t.contains(n);)e.push(n),n=n.offsetParent;const g=r.offsetTop+e.reduce((L,$)=>L+$.offsetTop,0),y=g+r.offsetHeight,i=t.scrollTop,k=i+t.clientHeight;g<i?t.scrollTop=g:y>k&&(t.scrollTop=y-t.clientHeight)}/*! Element Plus Icons Vue v2.3.1 */var arrow_down_vue_vue_type_script_setup_true_lang_default=defineComponent({name:"ArrowDown",__name:"arrow-down",setup(t){return(r,e)=>(openBlock(),createElementBlock("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[createBaseVNode("path",{fill:"currentColor",d:"M831.872 340.864 512 652.672 192.128 340.864a30.592 30.592 0 0 0-42.752 0 29.12 29.12 0 0 0 0 41.6L489.664 714.24a32 32 0 0 0 44.672 0l340.288-331.712a29.12 29.12 0 0 0 0-41.728 30.592 30.592 0 0 0-42.752 0z"})]))}}),arrow_down_default=arrow_down_vue_vue_type_script_setup_true_lang_default,arrow_left_vue_vue_type_script_setup_true_lang_default=defineComponent({name:"ArrowLeft",__name:"arrow-left",setup(t){return(r,e)=>(openBlock(),createElementBlock("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[createBaseVNode("path",{fill:"currentColor",d:"M609.408 149.376 277.76 489.6a32 32 0 0 0 0 44.672l331.648 340.352a29.12 29.12 0 0 0 41.728 0 30.592 30.592 0 0 0 0-42.752L339.264 511.936l311.872-319.872a30.592 30.592 0 0 0 0-42.688 29.12 29.12 0 0 0-41.728 0z"})]))}}),arrow_left_default=arrow_left_vue_vue_type_script_setup_true_lang_default,arrow_right_vue_vue_type_script_setup_true_lang_default=defineComponent({name:"ArrowRight",__name:"arrow-right",setup(t){return(r,e)=>(openBlock(),createElementBlock("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[createBaseVNode("path",{fill:"currentColor",d:"M340.864 149.312a30.592 30.592 0 0 0 0 42.752L652.736 512 340.864 831.872a30.592 30.592 0 0 0 0 42.752 29.12 29.12 0 0 0 41.728 0L714.24 534.336a32 32 0 0 0 0-44.672L382.592 149.376a29.12 29.12 0 0 0-41.728 0z"})]))}}),arrow_right_default=arrow_right_vue_vue_type_script_setup_true_lang_default,arrow_up_vue_vue_type_script_setup_true_lang_default=defineComponent({name:"ArrowUp",__name:"arrow-up",setup(t){return(r,e)=>(openBlock(),createElementBlock("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[createBaseVNode("path",{fill:"currentColor",d:"m488.832 344.32-339.84 356.672a32 32 0 0 0 0 44.16l.384.384a29.44 29.44 0 0 0 42.688 0l320-335.872 319.872 335.872a29.44 29.44 0 0 0 42.688 0l.384-.384a32 32 0 0 0 0-44.16L535.168 344.32a32 32 0 0 0-46.336 0"})]))}}),arrow_up_default=arrow_up_vue_vue_type_script_setup_true_lang_default,check_vue_vue_type_script_setup_true_lang_default=defineComponent({name:"Check",__name:"check",setup(t){return(r,e)=>(openBlock(),createElementBlock("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[createBaseVNode("path",{fill:"currentColor",d:"M406.656 706.944 195.84 496.256a32 32 0 1 0-45.248 45.248l256 256 512-512a32 32 0 0 0-45.248-45.248L406.592 706.944z"})]))}}),check_default=check_vue_vue_type_script_setup_true_lang_default,circle_check_vue_vue_type_script_setup_true_lang_default=defineComponent({name:"CircleCheck",__name:"circle-check",setup(t){return(r,e)=>(openBlock(),createElementBlock("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[createBaseVNode("path",{fill:"currentColor",d:"M512 896a384 384 0 1 0 0-768 384 384 0 0 0 0 768m0 64a448 448 0 1 1 0-896 448 448 0 0 1 0 896"}),createBaseVNode("path",{fill:"currentColor",d:"M745.344 361.344a32 32 0 0 1 45.312 45.312l-288 288a32 32 0 0 1-45.312 0l-160-160a32 32 0 1 1 45.312-45.312L480 626.752l265.344-265.408z"})]))}}),circle_check_default=circle_check_vue_vue_type_script_setup_true_lang_default,circle_close_filled_vue_vue_type_script_setup_true_lang_default=defineComponent({name:"CircleCloseFilled",__name:"circle-close-filled",setup(t){return(r,e)=>(openBlock(),createElementBlock("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[createBaseVNode("path",{fill:"currentColor",d:"M512 64a448 448 0 1 1 0 896 448 448 0 0 1 0-896m0 393.664L407.936 353.6a38.4 38.4 0 1 0-54.336 54.336L457.664 512 353.6 616.064a38.4 38.4 0 1 0 54.336 54.336L512 566.336 616.064 670.4a38.4 38.4 0 1 0 54.336-54.336L566.336 512 670.4 407.936a38.4 38.4 0 1 0-54.336-54.336z"})]))}}),circle_close_filled_default=circle_close_filled_vue_vue_type_script_setup_true_lang_default,circle_close_vue_vue_type_script_setup_true_lang_default=defineComponent({name:"CircleClose",__name:"circle-close",setup(t){return(r,e)=>(openBlock(),createElementBlock("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[createBaseVNode("path",{fill:"currentColor",d:"m466.752 512-90.496-90.496a32 32 0 0 1 45.248-45.248L512 466.752l90.496-90.496a32 32 0 1 1 45.248 45.248L557.248 512l90.496 90.496a32 32 0 1 1-45.248 45.248L512 557.248l-90.496 90.496a32 32 0 0 1-45.248-45.248z"}),createBaseVNode("path",{fill:"currentColor",d:"M512 896a384 384 0 1 0 0-768 384 384 0 0 0 0 768m0 64a448 448 0 1 1 0-896 448 448 0 0 1 0 896"})]))}}),circle_close_default=circle_close_vue_vue_type_script_setup_true_lang_default,close_vue_vue_type_script_setup_true_lang_default=defineComponent({name:"Close",__name:"close",setup(t){return(r,e)=>(openBlock(),createElementBlock("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[createBaseVNode("path",{fill:"currentColor",d:"M764.288 214.592 512 466.88 259.712 214.592a31.936 31.936 0 0 0-45.12 45.12L466.752 512 214.528 764.224a31.936 31.936 0 1 0 45.12 45.184L512 557.184l252.288 252.288a31.936 31.936 0 0 0 45.12-45.12L557.12 512.064l252.288-252.352a31.936 31.936 0 1 0-45.12-45.184z"})]))}}),close_default=close_vue_vue_type_script_setup_true_lang_default,cpu_vue_vue_type_script_setup_true_lang_default=defineComponent({name:"Cpu",__name:"cpu",setup(t){return(r,e)=>(openBlock(),createElementBlock("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[createBaseVNode("path",{fill:"currentColor",d:"M320 256a64 64 0 0 0-64 64v384a64 64 0 0 0 64 64h384a64 64 0 0 0 64-64V320a64 64 0 0 0-64-64zm0-64h384a128 128 0 0 1 128 128v384a128 128 0 0 1-128 128H320a128 128 0 0 1-128-128V320a128 128 0 0 1 128-128"}),createBaseVNode("path",{fill:"currentColor",d:"M512 64a32 32 0 0 1 32 32v128h-64V96a32 32 0 0 1 32-32m160 0a32 32 0 0 1 32 32v128h-64V96a32 32 0 0 1 32-32m-320 0a32 32 0 0 1 32 32v128h-64V96a32 32 0 0 1 32-32m160 896a32 32 0 0 1-32-32V800h64v128a32 32 0 0 1-32 32m160 0a32 32 0 0 1-32-32V800h64v128a32 32 0 0 1-32 32m-320 0a32 32 0 0 1-32-32V800h64v128a32 32 0 0 1-32 32M64 512a32 32 0 0 1 32-32h128v64H96a32 32 0 0 1-32-32m0-160a32 32 0 0 1 32-32h128v64H96a32 32 0 0 1-32-32m0 320a32 32 0 0 1 32-32h128v64H96a32 32 0 0 1-32-32m896-160a32 32 0 0 1-32 32H800v-64h128a32 32 0 0 1 32 32m0-160a32 32 0 0 1-32 32H800v-64h128a32 32 0 0 1 32 32m0 320a32 32 0 0 1-32 32H800v-64h128a32 32 0 0 1 32 32"})]))}}),cpu_default=cpu_vue_vue_type_script_setup_true_lang_default,d_arrow_left_vue_vue_type_script_setup_true_lang_default=defineComponent({name:"DArrowLeft",__name:"d-arrow-left",setup(t){return(r,e)=>(openBlock(),createElementBlock("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[createBaseVNode("path",{fill:"currentColor",d:"M529.408 149.376a29.12 29.12 0 0 1 41.728 0 30.592 30.592 0 0 1 0 42.688L259.264 511.936l311.872 319.936a30.592 30.592 0 0 1-.512 43.264 29.12 29.12 0 0 1-41.216-.512L197.76 534.272a32 32 0 0 1 0-44.672l331.648-340.224zm256 0a29.12 29.12 0 0 1 41.728 0 30.592 30.592 0 0 1 0 42.688L515.264 511.936l311.872 319.936a30.592 30.592 0 0 1-.512 43.264 29.12 29.12 0 0 1-41.216-.512L453.76 534.272a32 32 0 0 1 0-44.672l331.648-340.224z"})]))}}),d_arrow_left_default=d_arrow_left_vue_vue_type_script_setup_true_lang_default,d_arrow_right_vue_vue_type_script_setup_true_lang_default=defineComponent({name:"DArrowRight",__name:"d-arrow-right",setup(t){return(r,e)=>(openBlock(),createElementBlock("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[createBaseVNode("path",{fill:"currentColor",d:"M452.864 149.312a29.12 29.12 0 0 1 41.728.064L826.24 489.664a32 32 0 0 1 0 44.672L494.592 874.624a29.12 29.12 0 0 1-41.728 0 30.592 30.592 0 0 1 0-42.752L764.736 512 452.864 192a30.592 30.592 0 0 1 0-42.688m-256 0a29.12 29.12 0 0 1 41.728.064L570.24 489.664a32 32 0 0 1 0 44.672L238.592 874.624a29.12 29.12 0 0 1-41.728 0 30.592 30.592 0 0 1 0-42.752L508.736 512 196.864 192a30.592 30.592 0 0 1 0-42.688z"})]))}}),d_arrow_right_default=d_arrow_right_vue_vue_type_script_setup_true_lang_default,delete_vue_vue_type_script_setup_true_lang_default=defineComponent({name:"Delete",__name:"delete",setup(t){return(r,e)=>(openBlock(),createElementBlock("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[createBaseVNode("path",{fill:"currentColor",d:"M160 256H96a32 32 0 0 1 0-64h256V95.936a32 32 0 0 1 32-32h256a32 32 0 0 1 32 32V192h256a32 32 0 1 1 0 64h-64v672a32 32 0 0 1-32 32H192a32 32 0 0 1-32-32zm448-64v-64H416v64zM224 896h576V256H224zm192-128a32 32 0 0 1-32-32V416a32 32 0 0 1 64 0v320a32 32 0 0 1-32 32m192 0a32 32 0 0 1-32-32V416a32 32 0 0 1 64 0v320a32 32 0 0 1-32 32"})]))}}),delete_default=delete_vue_vue_type_script_setup_true_lang_default,document_vue_vue_type_script_setup_true_lang_default=defineComponent({name:"Document",__name:"document",setup(t){return(r,e)=>(openBlock(),createElementBlock("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[createBaseVNode("path",{fill:"currentColor",d:"M832 384H576V128H192v768h640zm-26.496-64L640 154.496V320zM160 64h480l256 256v608a32 32 0 0 1-32 32H160a32 32 0 0 1-32-32V96a32 32 0 0 1 32-32m160 448h384v64H320zm0-192h160v64H320zm0 384h384v64H320z"})]))}}),document_default=document_vue_vue_type_script_setup_true_lang_default,edit_vue_vue_type_script_setup_true_lang_default=defineComponent({name:"Edit",__name:"edit",setup(t){return(r,e)=>(openBlock(),createElementBlock("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[createBaseVNode("path",{fill:"currentColor",d:"M832 512a32 32 0 1 1 64 0v352a32 32 0 0 1-32 32H160a32 32 0 0 1-32-32V160a32 32 0 0 1 32-32h352a32 32 0 0 1 0 64H192v640h640z"}),createBaseVNode("path",{fill:"currentColor",d:"m469.952 554.24 52.8-7.552L847.104 222.4a32 32 0 1 0-45.248-45.248L477.44 501.44l-7.552 52.8zm422.4-422.4a96 96 0 0 1 0 135.808l-331.84 331.84a32 32 0 0 1-18.112 9.088L436.8 623.68a32 32 0 0 1-36.224-36.224l15.104-105.6a32 32 0 0 1 9.024-18.112l331.904-331.84a96 96 0 0 1 135.744 0z"})]))}}),edit_default=edit_vue_vue_type_script_setup_true_lang_default,full_screen_vue_vue_type_script_setup_true_lang_default=defineComponent({name:"FullScreen",__name:"full-screen",setup(t){return(r,e)=>(openBlock(),createElementBlock("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[createBaseVNode("path",{fill:"currentColor",d:"m160 96.064 192 .192a32 32 0 0 1 0 64l-192-.192V352a32 32 0 0 1-64 0V96h64zm0 831.872V928H96V672a32 32 0 1 1 64 0v191.936l192-.192a32 32 0 1 1 0 64zM864 96.064V96h64v256a32 32 0 1 1-64 0V160.064l-192 .192a32 32 0 1 1 0-64l192-.192zm0 831.872-192-.192a32 32 0 0 1 0-64l192 .192V672a32 32 0 1 1 64 0v256h-64z"})]))}}),full_screen_default=full_screen_vue_vue_type_script_setup_true_lang_default,hide_vue_vue_type_script_setup_true_lang_default=defineComponent({name:"Hide",__name:"hide",setup(t){return(r,e)=>(openBlock(),createElementBlock("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[createBaseVNode("path",{fill:"currentColor",d:"M876.8 156.8c0-9.6-3.2-16-9.6-22.4-6.4-6.4-12.8-9.6-22.4-9.6-9.6 0-16 3.2-22.4 9.6L736 220.8c-64-32-137.6-51.2-224-60.8-160 16-288 73.6-377.6 176C44.8 438.4 0 496 0 512s48 73.6 134.4 176c22.4 25.6 44.8 48 73.6 67.2l-86.4 89.6c-6.4 6.4-9.6 12.8-9.6 22.4 0 9.6 3.2 16 9.6 22.4 6.4 6.4 12.8 9.6 22.4 9.6 9.6 0 16-3.2 22.4-9.6l704-710.4c3.2-6.4 6.4-12.8 6.4-22.4Zm-646.4 528c-76.8-70.4-128-128-153.6-172.8 28.8-48 80-105.6 153.6-172.8C304 272 400 230.4 512 224c64 3.2 124.8 19.2 176 44.8l-54.4 54.4C598.4 300.8 560 288 512 288c-64 0-115.2 22.4-160 64s-64 96-64 160c0 48 12.8 89.6 35.2 124.8L256 707.2c-9.6-6.4-19.2-16-25.6-22.4Zm140.8-96c-12.8-22.4-19.2-48-19.2-76.8 0-44.8 16-83.2 48-112 32-28.8 67.2-48 112-48 28.8 0 54.4 6.4 73.6 19.2zM889.599 336c-12.8-16-28.8-28.8-41.6-41.6l-48 48c73.6 67.2 124.8 124.8 150.4 169.6-28.8 48-80 105.6-153.6 172.8-73.6 67.2-172.8 108.8-284.8 115.2-51.2-3.2-99.2-12.8-140.8-28.8l-48 48c57.6 22.4 118.4 38.4 188.8 44.8 160-16 288-73.6 377.6-176C979.199 585.6 1024 528 1024 512s-48.001-73.6-134.401-176Z"}),createBaseVNode("path",{fill:"currentColor",d:"M511.998 672c-12.8 0-25.6-3.2-38.4-6.4l-51.2 51.2c28.8 12.8 57.6 19.2 89.6 19.2 64 0 115.2-22.4 160-64 41.6-41.6 64-96 64-160 0-32-6.4-64-19.2-89.6l-51.2 51.2c3.2 12.8 6.4 25.6 6.4 38.4 0 44.8-16 83.2-48 112-32 28.8-67.2 48-112 48Z"})]))}}),hide_default=hide_vue_vue_type_script_setup_true_lang_default,house_vue_vue_type_script_setup_true_lang_default=defineComponent({name:"House",__name:"house",setup(t){return(r,e)=>(openBlock(),createElementBlock("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[createBaseVNode("path",{fill:"currentColor",d:"M192 413.952V896h640V413.952L512 147.328zM139.52 374.4l352-293.312a32 32 0 0 1 40.96 0l352 293.312A32 32 0 0 1 896 398.976V928a32 32 0 0 1-32 32H160a32 32 0 0 1-32-32V398.976a32 32 0 0 1 11.52-24.576"})]))}}),house_default=house_vue_vue_type_script_setup_true_lang_default,info_filled_vue_vue_type_script_setup_true_lang_default=defineComponent({name:"InfoFilled",__name:"info-filled",setup(t){return(r,e)=>(openBlock(),createElementBlock("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[createBaseVNode("path",{fill:"currentColor",d:"M512 64a448 448 0 1 1 0 896.064A448 448 0 0 1 512 64m67.2 275.072c33.28 0 60.288-23.104 60.288-57.344s-27.072-57.344-60.288-57.344c-33.28 0-60.16 23.104-60.16 57.344s26.88 57.344 60.16 57.344M590.912 699.2c0-6.848 2.368-24.64 1.024-34.752l-52.608 60.544c-10.88 11.456-24.512 19.392-30.912 17.28a12.992 12.992 0 0 1-8.256-14.72l87.68-276.992c7.168-35.136-12.544-67.2-54.336-71.296-44.096 0-108.992 44.736-148.48 101.504 0 6.784-1.28 23.68.064 33.792l52.544-60.608c10.88-11.328 23.552-19.328 29.952-17.152a12.8 12.8 0 0 1 7.808 16.128L388.48 728.576c-10.048 32.256 8.96 63.872 55.04 71.04 67.84 0 107.904-43.648 147.456-100.416z"})]))}}),info_filled_default=info_filled_vue_vue_type_script_setup_true_lang_default,loading_vue_vue_type_script_setup_true_lang_default=defineComponent({name:"Loading",__name:"loading",setup(t){return(r,e)=>(openBlock(),createElementBlock("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[createBaseVNode("path",{fill:"currentColor",d:"M512 64a32 32 0 0 1 32 32v192a32 32 0 0 1-64 0V96a32 32 0 0 1 32-32m0 640a32 32 0 0 1 32 32v192a32 32 0 1 1-64 0V736a32 32 0 0 1 32-32m448-192a32 32 0 0 1-32 32H736a32 32 0 1 1 0-64h192a32 32 0 0 1 32 32m-640 0a32 32 0 0 1-32 32H96a32 32 0 0 1 0-64h192a32 32 0 0 1 32 32M195.2 195.2a32 32 0 0 1 45.248 0L376.32 331.008a32 32 0 0 1-45.248 45.248L195.2 240.448a32 32 0 0 1 0-45.248zm452.544 452.544a32 32 0 0 1 45.248 0L828.8 783.552a32 32 0 0 1-45.248 45.248L647.744 692.992a32 32 0 0 1 0-45.248zM828.8 195.264a32 32 0 0 1 0 45.184L692.992 376.32a32 32 0 0 1-45.248-45.248l135.808-135.808a32 32 0 0 1 45.248 0m-452.544 452.48a32 32 0 0 1 0 45.248L240.448 828.8a32 32 0 0 1-45.248-45.248l135.808-135.808a32 32 0 0 1 45.248 0z"})]))}}),loading_default=loading_vue_vue_type_script_setup_true_lang_default,minus_vue_vue_type_script_setup_true_lang_default=defineComponent({name:"Minus",__name:"minus",setup(t){return(r,e)=>(openBlock(),createElementBlock("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[createBaseVNode("path",{fill:"currentColor",d:"M128 544h768a32 32 0 1 0 0-64H128a32 32 0 0 0 0 64"})]))}}),minus_default=minus_vue_vue_type_script_setup_true_lang_default,more_filled_vue_vue_type_script_setup_true_lang_default=defineComponent({name:"MoreFilled",__name:"more-filled",setup(t){return(r,e)=>(openBlock(),createElementBlock("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[createBaseVNode("path",{fill:"currentColor",d:"M176 416a112 112 0 1 1 0 224 112 112 0 0 1 0-224m336 0a112 112 0 1 1 0 224 112 112 0 0 1 0-224m336 0a112 112 0 1 1 0 224 112 112 0 0 1 0-224"})]))}}),more_filled_default=more_filled_vue_vue_type_script_setup_true_lang_default,more_vue_vue_type_script_setup_true_lang_default=defineComponent({name:"More",__name:"more",setup(t){return(r,e)=>(openBlock(),createElementBlock("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[createBaseVNode("path",{fill:"currentColor",d:"M176 416a112 112 0 1 0 0 224 112 112 0 0 0 0-224m0 64a48 48 0 1 1 0 96 48 48 0 0 1 0-96m336-64a112 112 0 1 1 0 224 112 112 0 0 1 0-224m0 64a48 48 0 1 0 0 96 48 48 0 0 0 0-96m336-64a112 112 0 1 1 0 224 112 112 0 0 1 0-224m0 64a48 48 0 1 0 0 96 48 48 0 0 0 0-96"})]))}}),more_default=more_vue_vue_type_script_setup_true_lang_default,picture_vue_vue_type_script_setup_true_lang_default=defineComponent({name:"Picture",__name:"picture",setup(t){return(r,e)=>(openBlock(),createElementBlock("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[createBaseVNode("path",{fill:"currentColor",d:"M160 160v704h704V160zm-32-64h768a32 32 0 0 1 32 32v768a32 32 0 0 1-32 32H128a32 32 0 0 1-32-32V128a32 32 0 0 1 32-32"}),createBaseVNode("path",{fill:"currentColor",d:"M384 288q64 0 64 64t-64 64q-64 0-64-64t64-64M185.408 876.992l-50.816-38.912L350.72 556.032a96 96 0 0 1 134.592-17.856l1.856 1.472 122.88 99.136a32 32 0 0 0 44.992-4.864l216-269.888 49.92 39.936-215.808 269.824-.256.32a96 96 0 0 1-135.04 14.464l-122.88-99.072-.64-.512a32 32 0 0 0-44.8 5.952z"})]))}}),picture_default=picture_vue_vue_type_script_setup_true_lang_default,plus_vue_vue_type_script_setup_true_lang_default=defineComponent({name:"Plus",__name:"plus",setup(t){return(r,e)=>(openBlock(),createElementBlock("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[createBaseVNode("path",{fill:"currentColor",d:"M480 480V128a32 32 0 0 1 64 0v352h352a32 32 0 1 1 0 64H544v352a32 32 0 1 1-64 0V544H128a32 32 0 0 1 0-64z"})]))}}),plus_default=plus_vue_vue_type_script_setup_true_lang_default,refresh_left_vue_vue_type_script_setup_true_lang_default=defineComponent({name:"RefreshLeft",__name:"refresh-left",setup(t){return(r,e)=>(openBlock(),createElementBlock("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[createBaseVNode("path",{fill:"currentColor",d:"M289.088 296.704h92.992a32 32 0 0 1 0 64H232.96a32 32 0 0 1-32-32V179.712a32 32 0 0 1 64 0v50.56a384 384 0 0 1 643.84 282.88 384 384 0 0 1-383.936 384 384 384 0 0 1-384-384h64a320 320 0 1 0 640 0 320 320 0 0 0-555.712-216.448z"})]))}}),refresh_left_default=refresh_left_vue_vue_type_script_setup_true_lang_default,refresh_right_vue_vue_type_script_setup_true_lang_default=defineComponent({name:"RefreshRight",__name:"refresh-right",setup(t){return(r,e)=>(openBlock(),createElementBlock("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[createBaseVNode("path",{fill:"currentColor",d:"M784.512 230.272v-50.56a32 32 0 1 1 64 0v149.056a32 32 0 0 1-32 32H667.52a32 32 0 1 1 0-64h92.992A320 320 0 1 0 524.8 833.152a320 320 0 0 0 320-320h64a384 384 0 0 1-384 384 384 384 0 0 1-384-384 384 384 0 0 1 643.712-282.88z"})]))}}),refresh_right_default=refresh_right_vue_vue_type_script_setup_true_lang_default,refresh_vue_vue_type_script_setup_true_lang_default=defineComponent({name:"Refresh",__name:"refresh",setup(t){return(r,e)=>(openBlock(),createElementBlock("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[createBaseVNode("path",{fill:"currentColor",d:"M771.776 794.88A384 384 0 0 1 128 512h64a320 320 0 0 0 555.712 216.448H654.72a32 32 0 1 1 0-64h149.056a32 32 0 0 1 32 32v148.928a32 32 0 1 1-64 0v-50.56zM276.288 295.616h92.992a32 32 0 0 1 0 64H220.16a32 32 0 0 1-32-32V178.56a32 32 0 0 1 64 0v50.56A384 384 0 0 1 896.128 512h-64a320 320 0 0 0-555.776-216.384z"})]))}}),refresh_default=refresh_vue_vue_type_script_setup_true_lang_default,scale_to_original_vue_vue_type_script_setup_true_lang_default=defineComponent({name:"ScaleToOriginal",__name:"scale-to-original",setup(t){return(r,e)=>(openBlock(),createElementBlock("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[createBaseVNode("path",{fill:"currentColor",d:"M813.176 180.706a60.235 60.235 0 0 1 60.236 60.235v481.883a60.235 60.235 0 0 1-60.236 60.235H210.824a60.235 60.235 0 0 1-60.236-60.235V240.94a60.235 60.235 0 0 1 60.236-60.235h602.352zm0-60.235H210.824A120.47 120.47 0 0 0 90.353 240.94v481.883a120.47 120.47 0 0 0 120.47 120.47h602.353a120.47 120.47 0 0 0 120.471-120.47V240.94a120.47 120.47 0 0 0-120.47-120.47zm-120.47 180.705a30.118 30.118 0 0 0-30.118 30.118v301.177a30.118 30.118 0 0 0 60.236 0V331.294a30.118 30.118 0 0 0-30.118-30.118zm-361.412 0a30.118 30.118 0 0 0-30.118 30.118v301.177a30.118 30.118 0 1 0 60.236 0V331.294a30.118 30.118 0 0 0-30.118-30.118M512 361.412a30.118 30.118 0 0 0-30.118 30.117v30.118a30.118 30.118 0 0 0 60.236 0V391.53A30.118 30.118 0 0 0 512 361.412M512 512a30.118 30.118 0 0 0-30.118 30.118v30.117a30.118 30.118 0 0 0 60.236 0v-30.117A30.118 30.118 0 0 0 512 512"})]))}}),scale_to_original_default=scale_to_original_vue_vue_type_script_setup_true_lang_default,set_up_vue_vue_type_script_setup_true_lang_default=defineComponent({name:"SetUp",__name:"set-up",setup(t){return(r,e)=>(openBlock(),createElementBlock("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[createBaseVNode("path",{fill:"currentColor",d:"M224 160a64 64 0 0 0-64 64v576a64 64 0 0 0 64 64h576a64 64 0 0 0 64-64V224a64 64 0 0 0-64-64zm0-64h576a128 128 0 0 1 128 128v576a128 128 0 0 1-128 128H224A128 128 0 0 1 96 800V224A128 128 0 0 1 224 96"}),createBaseVNode("path",{fill:"currentColor",d:"M384 416a64 64 0 1 0 0-128 64 64 0 0 0 0 128m0 64a128 128 0 1 1 0-256 128 128 0 0 1 0 256"}),createBaseVNode("path",{fill:"currentColor",d:"M480 320h256q32 0 32 32t-32 32H480q-32 0-32-32t32-32m160 416a64 64 0 1 0 0-128 64 64 0 0 0 0 128m0 64a128 128 0 1 1 0-256 128 128 0 0 1 0 256"}),createBaseVNode("path",{fill:"currentColor",d:"M288 640h256q32 0 32 32t-32 32H288q-32 0-32-32t32-32"})]))}}),set_up_default=set_up_vue_vue_type_script_setup_true_lang_default,setting_vue_vue_type_script_setup_true_lang_default=defineComponent({name:"Setting",__name:"setting",setup(t){return(r,e)=>(openBlock(),createElementBlock("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[createBaseVNode("path",{fill:"currentColor",d:"M600.704 64a32 32 0 0 1 30.464 22.208l35.2 109.376c14.784 7.232 28.928 15.36 42.432 24.512l112.384-24.192a32 32 0 0 1 34.432 15.36L944.32 364.8a32 32 0 0 1-4.032 37.504l-77.12 85.12a357.12 357.12 0 0 1 0 49.024l77.12 85.248a32 32 0 0 1 4.032 37.504l-88.704 153.6a32 32 0 0 1-34.432 15.296L708.8 803.904c-13.44 9.088-27.648 17.28-42.368 24.512l-35.264 109.376A32 32 0 0 1 600.704 960H423.296a32 32 0 0 1-30.464-22.208L357.696 828.48a351.616 351.616 0 0 1-42.56-24.64l-112.32 24.256a32 32 0 0 1-34.432-15.36L79.68 659.2a32 32 0 0 1 4.032-37.504l77.12-85.248a357.12 357.12 0 0 1 0-48.896l-77.12-85.248A32 32 0 0 1 79.68 364.8l88.704-153.6a32 32 0 0 1 34.432-15.296l112.32 24.256c13.568-9.152 27.776-17.408 42.56-24.64l35.2-109.312A32 32 0 0 1 423.232 64H600.64zm-23.424 64H446.72l-36.352 113.088-24.512 11.968a294.113 294.113 0 0 0-34.816 20.096l-22.656 15.36-116.224-25.088-65.28 113.152 79.68 88.192-1.92 27.136a293.12 293.12 0 0 0 0 40.192l1.92 27.136-79.808 88.192 65.344 113.152 116.224-25.024 22.656 15.296a294.113 294.113 0 0 0 34.816 20.096l24.512 11.968L446.72 896h130.688l36.48-113.152 24.448-11.904a288.282 288.282 0 0 0 34.752-20.096l22.592-15.296 116.288 25.024 65.28-113.152-79.744-88.192 1.92-27.136a293.12 293.12 0 0 0 0-40.256l-1.92-27.136 79.808-88.128-65.344-113.152-116.288 24.96-22.592-15.232a287.616 287.616 0 0 0-34.752-20.096l-24.448-11.904L577.344 128zM512 320a192 192 0 1 1 0 384 192 192 0 0 1 0-384m0 64a128 128 0 1 0 0 256 128 128 0 0 0 0-256"})]))}}),setting_default=setting_vue_vue_type_script_setup_true_lang_default,success_filled_vue_vue_type_script_setup_true_lang_default=defineComponent({name:"SuccessFilled",__name:"success-filled",setup(t){return(r,e)=>(openBlock(),createElementBlock("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[createBaseVNode("path",{fill:"currentColor",d:"M512 64a448 448 0 1 1 0 896 448 448 0 0 1 0-896m-55.808 536.384-99.52-99.584a38.4 38.4 0 1 0-54.336 54.336l126.72 126.72a38.272 38.272 0 0 0 54.336 0l262.4-262.464a38.4 38.4 0 1 0-54.272-54.336z"})]))}}),success_filled_default=success_filled_vue_vue_type_script_setup_true_lang_default,switch_vue_vue_type_script_setup_true_lang_default=defineComponent({name:"Switch",__name:"switch",setup(t){return(r,e)=>(openBlock(),createElementBlock("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[createBaseVNode("path",{fill:"currentColor",d:"M118.656 438.656a32 32 0 0 1 0-45.248L416 96l4.48-3.776A32 32 0 0 1 461.248 96l3.712 4.48a32.064 32.064 0 0 1-3.712 40.832L218.56 384H928a32 32 0 1 1 0 64H141.248a32 32 0 0 1-22.592-9.344zM64 608a32 32 0 0 1 32-32h786.752a32 32 0 0 1 22.656 54.592L608 928l-4.48 3.776a32.064 32.064 0 0 1-40.832-49.024L805.632 640H96a32 32 0 0 1-32-32"})]))}}),switch_default=switch_vue_vue_type_script_setup_true_lang_default,tickets_vue_vue_type_script_setup_true_lang_default=defineComponent({name:"Tickets",__name:"tickets",setup(t){return(r,e)=>(openBlock(),createElementBlock("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[createBaseVNode("path",{fill:"currentColor",d:"M192 128v768h640V128zm-32-64h704a32 32 0 0 1 32 32v832a32 32 0 0 1-32 32H160a32 32 0 0 1-32-32V96a32 32 0 0 1 32-32m160 448h384v64H320zm0-192h192v64H320zm0 384h384v64H320z"})]))}}),tickets_default=tickets_vue_vue_type_script_setup_true_lang_default,upload_vue_vue_type_script_setup_true_lang_default=defineComponent({name:"Upload",__name:"upload",setup(t){return(r,e)=>(openBlock(),createElementBlock("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[createBaseVNode("path",{fill:"currentColor",d:"M160 832h704a32 32 0 1 1 0 64H160a32 32 0 1 1 0-64m384-578.304V704h-64V247.296L237.248 490.048 192 444.8 508.8 128l316.8 316.8-45.312 45.248z"})]))}}),upload_default=upload_vue_vue_type_script_setup_true_lang_default,view_vue_vue_type_script_setup_true_lang_default=defineComponent({name:"View",__name:"view",setup(t){return(r,e)=>(openBlock(),createElementBlock("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[createBaseVNode("path",{fill:"currentColor",d:"M512 160c320 0 512 352 512 352S832 864 512 864 0 512 0 512s192-352 512-352m0 64c-225.28 0-384.128 208.064-436.8 288 52.608 79.872 211.456 288 436.8 288 225.28 0 384.128-208.064 436.8-288-52.608-79.872-211.456-288-436.8-288zm0 64a224 224 0 1 1 0 448 224 224 0 0 1 0-448m0 64a160.192 160.192 0 0 0-160 160c0 88.192 71.744 160 160 160s160-71.808 160-160-71.744-160-160-160"})]))}}),view_default=view_vue_vue_type_script_setup_true_lang_default,warning_filled_vue_vue_type_script_setup_true_lang_default=defineComponent({name:"WarningFilled",__name:"warning-filled",setup(t){return(r,e)=>(openBlock(),createElementBlock("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[createBaseVNode("path",{fill:"currentColor",d:"M512 64a448 448 0 1 1 0 896 448 448 0 0 1 0-896m0 192a58.432 58.432 0 0 0-58.24 63.744l23.36 256.384a35.072 35.072 0 0 0 69.76 0l23.296-256.384A58.432 58.432 0 0 0 512 256m0 512a51.2 51.2 0 1 0 0-102.4 51.2 51.2 0 0 0 0 102.4"})]))}}),warning_filled_default=warning_filled_vue_vue_type_script_setup_true_lang_default,zoom_in_vue_vue_type_script_setup_true_lang_default=defineComponent({name:"ZoomIn",__name:"zoom-in",setup(t){return(r,e)=>(openBlock(),createElementBlock("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[createBaseVNode("path",{fill:"currentColor",d:"m795.904 750.72 124.992 124.928a32 32 0 0 1-45.248 45.248L750.656 795.904a416 416 0 1 1 45.248-45.248zM480 832a352 352 0 1 0 0-704 352 352 0 0 0 0 704m-32-384v-96a32 32 0 0 1 64 0v96h96a32 32 0 0 1 0 64h-96v96a32 32 0 0 1-64 0v-96h-96a32 32 0 0 1 0-64z"})]))}}),zoom_in_default=zoom_in_vue_vue_type_script_setup_true_lang_default,zoom_out_vue_vue_type_script_setup_true_lang_default=defineComponent({name:"ZoomOut",__name:"zoom-out",setup(t){return(r,e)=>(openBlock(),createElementBlock("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[createBaseVNode("path",{fill:"currentColor",d:"m795.904 750.72 124.992 124.928a32 32 0 0 1-45.248 45.248L750.656 795.904a416 416 0 1 1 45.248-45.248zM480 832a352 352 0 1 0 0-704 352 352 0 0 0 0 704M352 448h256a32 32 0 0 1 0 64H352a32 32 0 0 1 0-64"})]))}}),zoom_out_default=zoom_out_vue_vue_type_script_setup_true_lang_default;const epPropKey="__epPropKey",definePropType=t=>t,isEpProp=t=>isObject$2(t)&&!!t[epPropKey],buildProp=(t,r)=>{if(!isObject$2(t)||isEpProp(t))return t;const{values:e,required:n,default:g,type:y,validator:i}=t,L={type:y,required:!!n,validator:e||i?$=>{let V=!1,z=[];if(e&&(z=Array.from(e),hasOwn(t,"default")&&z.push(g),V||(V=z.includes($))),i&&(V||(V=i($))),!V&&z.length>0){const re=[...new Set(z)].map(oe=>JSON.stringify(oe)).join(", ");warn(`Invalid prop: validation failed${r?` for prop "${r}"`:""}. Expected one of [${re}], got value ${JSON.stringify($)}.`)}return V}:void 0,[epPropKey]:!0};return hasOwn(t,"default")&&(L.default=g),L},buildProps=t=>fromPairs(Object.entries(t).map(([r,e])=>[r,buildProp(e,r)])),iconPropType=definePropType([String,Object,Function]),CloseComponents={Close:close_default},TypeComponents={Close:close_default,SuccessFilled:success_filled_default,InfoFilled:info_filled_default,WarningFilled:warning_filled_default,CircleCloseFilled:circle_close_filled_default},TypeComponentsMap={success:success_filled_default,warning:warning_filled_default,error:circle_close_filled_default,info:info_filled_default},ValidateComponentsMap={validating:loading_default,success:circle_check_default,error:circle_close_default},withInstall=(t,r)=>{if(t.install=e=>{for(const n of[t,...Object.values(r??{})])e.component(n.name,n)},r)for(const[e,n]of Object.entries(r))t[e]=n;return t},withInstallFunction=(t,r)=>(t.install=e=>{t._context=e._context,e.config.globalProperties[r]=t},t),withNoopInstall=t=>(t.install=NOOP,t),composeRefs=(...t)=>r=>{t.forEach(e=>{isFunction$3(e)?e(r):e.value=r})},EVENT_CODE={tab:"Tab",enter:"Enter",space:"Space",left:"ArrowLeft",up:"ArrowUp",right:"ArrowRight",down:"ArrowDown",esc:"Escape",delete:"Delete",backspace:"Backspace",numpadEnter:"NumpadEnter",pageUp:"PageUp",pageDown:"PageDown",home:"Home",end:"End"},UPDATE_MODEL_EVENT="update:modelValue",CHANGE_EVENT="change",INPUT_EVENT="input",componentSizes=["","default","small","large"],isValidComponentSize=t=>["",...componentSizes].includes(t);var PatchFlags=(t=>(t[t.TEXT=1]="TEXT",t[t.CLASS=2]="CLASS",t[t.STYLE=4]="STYLE",t[t.PROPS=8]="PROPS",t[t.FULL_PROPS=16]="FULL_PROPS",t[t.HYDRATE_EVENTS=32]="HYDRATE_EVENTS",t[t.STABLE_FRAGMENT=64]="STABLE_FRAGMENT",t[t.KEYED_FRAGMENT=128]="KEYED_FRAGMENT",t[t.UNKEYED_FRAGMENT=256]="UNKEYED_FRAGMENT",t[t.NEED_PATCH=512]="NEED_PATCH",t[t.DYNAMIC_SLOTS=1024]="DYNAMIC_SLOTS",t[t.HOISTED=-1]="HOISTED",t[t.BAIL=-2]="BAIL",t))(PatchFlags||{});function isFragment(t){return isVNode(t)&&t.type===Fragment}function isComment(t){return isVNode(t)&&t.type===Comment}function isValidElementNode(t){return isVNode(t)&&!isFragment(t)&&!isComment(t)}const flattedChildren=t=>{const r=isArray$3(t)?t:[t],e=[];return r.forEach(n=>{var g;isArray$3(n)?e.push(...flattedChildren(n)):isVNode(n)&&isArray$3(n.children)?e.push(...flattedChildren(n.children)):(e.push(n),isVNode(n)&&((g=n.component)!=null&&g.subTree)&&e.push(...flattedChildren(n.component.subTree)))}),e},unique=t=>[...new Set(t)],castArray=t=>!t&&t!==0?[]:Array.isArray(t)?t:[t],isKorean=t=>/([\uAC00-\uD7AF\u3130-\u318F])+/gi.test(t),rAF=t=>isClient?window.requestAnimationFrame(t):setTimeout(t,16),mutable=t=>t,DEFAULT_EXCLUDE_KEYS=["class","style"],LISTENER_PREFIX=/^on[A-Z]/,useAttrs=(t={})=>{const{excludeListeners:r=!1,excludeKeys:e}=t,n=computed(()=>((e==null?void 0:e.value)||[]).concat(DEFAULT_EXCLUDE_KEYS)),g=getCurrentInstance();return computed(g?()=>{var y;return fromPairs(Object.entries((y=g.proxy)==null?void 0:y.$attrs).filter(([i])=>!n.value.includes(i)&&!(r&&LISTENER_PREFIX.test(i))))}:()=>({}))},useDeprecated=({from:t,replacement:r,scope:e,version:n,ref:g,type:y="API"},i)=>{watch(()=>unref(i),k=>{},{immediate:!0})},useDraggable=(t,r,e,n)=>{let g={offsetX:0,offsetY:0};const y=L=>{const $=L.clientX,V=L.clientY,{offsetX:z,offsetY:re}=g,oe=t.value.getBoundingClientRect(),le=oe.left,ue=oe.top,ie=oe.width,ae=oe.height,Ie=document.documentElement.clientWidth,de=document.documentElement.clientHeight,Ce=-le+z,Ue=-ue+re,qe=Ie-le-ie+z,jt=de-ue-ae+re,Fe=cr=>{let er=z+cr.clientX-$,nr=re+cr.clientY-V;n!=null&&n.value||(er=Math.min(Math.max(er,Ce),qe),nr=Math.min(Math.max(nr,Ue),jt)),g={offsetX:er,offsetY:nr},t.value&&(t.value.style.transform=`translate(${addUnit(er)}, ${addUnit(nr)})`)},Et=()=>{document.removeEventListener("mousemove",Fe),document.removeEventListener("mouseup",Et)};document.addEventListener("mousemove",Fe),document.addEventListener("mouseup",Et)},i=()=>{r.value&&t.value&&r.value.addEventListener("mousedown",y)},k=()=>{r.value&&t.value&&r.value.removeEventListener("mousedown",y)};onMounted(()=>{watchEffect(()=>{e.value?i():k()})}),onBeforeUnmount(()=>{k()})};var English={name:"en",el:{colorpicker:{confirm:"OK",clear:"Clear",defaultLabel:"color picker",description:"current color is {color}. press enter to select a new color."},datepicker:{now:"Now",today:"Today",cancel:"Cancel",clear:"Clear",confirm:"OK",dateTablePrompt:"Use the arrow keys and enter to select the day of the month",monthTablePrompt:"Use the arrow keys and enter to select the month",yearTablePrompt:"Use the arrow keys and enter to select the year",selectedDate:"Selected date",selectDate:"Select date",selectTime:"Select time",startDate:"Start Date",startTime:"Start Time",endDate:"End Date",endTime:"End Time",prevYear:"Previous Year",nextYear:"Next Year",prevMonth:"Previous Month",nextMonth:"Next Month",year:"",month1:"January",month2:"February",month3:"March",month4:"April",month5:"May",month6:"June",month7:"July",month8:"August",month9:"September",month10:"October",month11:"November",month12:"December",week:"week",weeks:{sun:"Sun",mon:"Mon",tue:"Tue",wed:"Wed",thu:"Thu",fri:"Fri",sat:"Sat"},weeksFull:{sun:"Sunday",mon:"Monday",tue:"Tuesday",wed:"Wednesday",thu:"Thursday",fri:"Friday",sat:"Saturday"},months:{jan:"Jan",feb:"Feb",mar:"Mar",apr:"Apr",may:"May",jun:"Jun",jul:"Jul",aug:"Aug",sep:"Sep",oct:"Oct",nov:"Nov",dec:"Dec"}},inputNumber:{decrease:"decrease number",increase:"increase number"},select:{loading:"Loading",noMatch:"No matching data",noData:"No data",placeholder:"Select"},dropdown:{toggleDropdown:"Toggle Dropdown"},cascader:{noMatch:"No matching data",loading:"Loading",placeholder:"Select",noData:"No data"},pagination:{goto:"Go to",pagesize:"/page",total:"Total {total}",pageClassifier:"",page:"Page",prev:"Go to previous page",next:"Go to next page",currentPage:"page {pager}",prevPages:"Previous {pager} pages",nextPages:"Next {pager} pages",deprecationWarning:"Deprecated usages detected, please refer to the el-pagination documentation for more details"},dialog:{close:"Close this dialog"},drawer:{close:"Close this dialog"},messagebox:{title:"Message",confirm:"OK",cancel:"Cancel",error:"Illegal input",close:"Close this dialog"},upload:{deleteTip:"press delete to remove",delete:"Delete",preview:"Preview",continue:"Continue"},slider:{defaultLabel:"slider between {min} and {max}",defaultRangeStartLabel:"pick start value",defaultRangeEndLabel:"pick end value"},table:{emptyText:"No Data",confirmFilter:"Confirm",resetFilter:"Reset",clearFilter:"All",sumText:"Sum"},tour:{next:"Next",previous:"Previous",finish:"Finish"},tree:{emptyText:"No Data"},transfer:{noMatch:"No matching data",noData:"No data",titles:["List 1","List 2"],filterPlaceholder:"Enter keyword",noCheckedFormat:"{total} items",hasCheckedFormat:"{checked}/{total} checked"},image:{error:"FAILED"},pageHeader:{title:"Back"},popconfirm:{confirmButtonText:"Yes",cancelButtonText:"No"},carousel:{leftArrow:"Carousel arrow left",rightArrow:"Carousel arrow right",indicator:"Carousel switch to index {index}"}}};const buildTranslator=t=>(r,e)=>translate(r,e,unref(t)),translate=(t,r,e)=>get(e,t,t).replace(/\{(\w+)\}/g,(n,g)=>{var y;return`${(y=r==null?void 0:r[g])!=null?y:`{${g}}`}`}),buildLocaleContext=t=>{const r=computed(()=>unref(t).name),e=isRef(t)?t:ref(t);return{lang:r,locale:e,t:buildTranslator(t)}},localeContextKey=Symbol("localeContextKey"),useLocale=t=>{const r=t||inject(localeContextKey,ref());return buildLocaleContext(computed(()=>r.value||English))},defaultNamespace="el",statePrefix="is-",_bem=(t,r,e,n,g)=>{let y=`${t}-${r}`;return e&&(y+=`-${e}`),n&&(y+=`__${n}`),g&&(y+=`--${g}`),y},namespaceContextKey=Symbol("namespaceContextKey"),useGetDerivedNamespace=t=>{const r=t||(getCurrentInstance()?inject(namespaceContextKey,ref(defaultNamespace)):ref(defaultNamespace));return computed(()=>unref(r)||defaultNamespace)},useNamespace=(t,r)=>{const e=useGetDerivedNamespace(r);return{namespace:e,b:(ue="")=>_bem(e.value,t,ue,"",""),e:ue=>ue?_bem(e.value,t,"",ue,""):"",m:ue=>ue?_bem(e.value,t,"","",ue):"",be:(ue,ie)=>ue&&ie?_bem(e.value,t,ue,ie,""):"",em:(ue,ie)=>ue&&ie?_bem(e.value,t,"",ue,ie):"",bm:(ue,ie)=>ue&&ie?_bem(e.value,t,ue,"",ie):"",bem:(ue,ie,ae)=>ue&&ie&&ae?_bem(e.value,t,ue,ie,ae):"",is:(ue,...ie)=>{const ae=ie.length>=1?ie[0]:!0;return ue&&ae?`${statePrefix}${ue}`:""},cssVar:ue=>{const ie={};for(const ae in ue)ue[ae]&&(ie[`--${e.value}-${ae}`]=ue[ae]);return ie},cssVarName:ue=>`--${e.value}-${ue}`,cssVarBlock:ue=>{const ie={};for(const ae in ue)ue[ae]&&(ie[`--${e.value}-${t}-${ae}`]=ue[ae]);return ie},cssVarBlockName:ue=>`--${e.value}-${t}-${ue}`}},useLockscreen=(t,r={})=>{isRef(t)||throwError("[useLockscreen]","You need to pass a ref param to this function");const e=r.ns||useNamespace("popup"),n=computed$1(()=>e.bm("parent","hidden"));if(!isClient||hasClass(document.body,n.value))return;let g=0,y=!1,i="0";const k=()=>{setTimeout(()=>{removeClass(document==null?void 0:document.body,n.value),y&&document&&(document.body.style.width=i)},200)};watch(t,L=>{if(!L){k();return}y=!hasClass(document.body,n.value),y&&(i=document.body.style.width),g=getScrollBarWidth(e.namespace.value);const $=document.documentElement.clientHeight<document.body.scrollHeight,V=getStyle(document.body,"overflowY");g>0&&($||V==="scroll")&&y&&(document.body.style.width=`calc(100% - ${g}px)`),addClass(document.body,n.value)}),onScopeDispose(()=>k())},_prop=buildProp({type:definePropType(Boolean),default:null}),_event=buildProp({type:definePropType(Function)}),createModelToggleComposable=t=>{const r=`update:${t}`,e=`onUpdate:${t}`,n=[r],g={[t]:_prop,[e]:_event};return{useModelToggle:({indicator:i,toggleReason:k,shouldHideWhenRouteChanges:L,shouldProceed:$,onShow:V,onHide:z})=>{const re=getCurrentInstance(),{emit:oe}=re,le=re.props,ue=computed(()=>isFunction$3(le[e])),ie=computed(()=>le[t]===null),ae=jt=>{i.value!==!0&&(i.value=!0,k&&(k.value=jt),isFunction$3(V)&&V(jt))},Ie=jt=>{i.value!==!1&&(i.value=!1,k&&(k.value=jt),isFunction$3(z)&&z(jt))},de=jt=>{if(le.disabled===!0||isFunction$3($)&&!$())return;const Fe=ue.value&&isClient;Fe&&oe(r,!0),(ie.value||!Fe)&&ae(jt)},Ce=jt=>{if(le.disabled===!0||!isClient)return;const Fe=ue.value&&isClient;Fe&&oe(r,!1),(ie.value||!Fe)&&Ie(jt)},Ue=jt=>{isBoolean$1(jt)&&(le.disabled&&jt?ue.value&&oe(r,!1):i.value!==jt&&(jt?ae():Ie()))},qe=()=>{i.value?Ce():de()};return watch(()=>le[t],Ue),L&&re.appContext.config.globalProperties.$route!==void 0&&watch(()=>({...re.proxy.$route}),()=>{L.value&&i.value&&Ce()}),onMounted(()=>{Ue(le[t])}),{hide:Ce,show:de,toggle:qe,hasUpdateHandler:ue}},useModelToggleProps:g,useModelToggleEmits:n}};createModelToggleComposable("modelValue");const useProp=t=>{const r=getCurrentInstance();return computed(()=>{var e,n;return(n=(e=r==null?void 0:r.proxy)==null?void 0:e.$props)==null?void 0:n[t]})};var E$1="top",R="bottom",W="right",P$1="left",me="auto",G=[E$1,R,W,P$1],U$1="start",J="end",Xe="clippingParents",je="viewport",K="popper",Ye="reference",De=G.reduce(function(t,r){return t.concat([r+"-"+U$1,r+"-"+J])},[]),Ee=[].concat(G,[me]).reduce(function(t,r){return t.concat([r,r+"-"+U$1,r+"-"+J])},[]),Ge="beforeRead",Je="read",Ke="afterRead",Qe="beforeMain",Ze="main",et="afterMain",tt$1="beforeWrite",nt="write",rt="afterWrite",ot=[Ge,Je,Ke,Qe,Ze,et,tt$1,nt,rt];function C(t){return t?(t.nodeName||"").toLowerCase():null}function H(t){if(t==null)return window;if(t.toString()!=="[object Window]"){var r=t.ownerDocument;return r&&r.defaultView||window}return t}function Q(t){var r=H(t).Element;return t instanceof r||t instanceof Element}function B(t){var r=H(t).HTMLElement;return t instanceof r||t instanceof HTMLElement}function Pe(t){if(typeof ShadowRoot>"u")return!1;var r=H(t).ShadowRoot;return t instanceof r||t instanceof ShadowRoot}function Mt(t){var r=t.state;Object.keys(r.elements).forEach(function(e){var n=r.styles[e]||{},g=r.attributes[e]||{},y=r.elements[e];!B(y)||!C(y)||(Object.assign(y.style,n),Object.keys(g).forEach(function(i){var k=g[i];k===!1?y.removeAttribute(i):y.setAttribute(i,k===!0?"":k)}))})}function Rt(t){var r=t.state,e={popper:{position:r.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(r.elements.popper.style,e.popper),r.styles=e,r.elements.arrow&&Object.assign(r.elements.arrow.style,e.arrow),function(){Object.keys(r.elements).forEach(function(n){var g=r.elements[n],y=r.attributes[n]||{},i=Object.keys(r.styles.hasOwnProperty(n)?r.styles[n]:e[n]),k=i.reduce(function(L,$){return L[$]="",L},{});!B(g)||!C(g)||(Object.assign(g.style,k),Object.keys(y).forEach(function(L){g.removeAttribute(L)}))})}}var Ae={name:"applyStyles",enabled:!0,phase:"write",fn:Mt,effect:Rt,requires:["computeStyles"]};function q(t){return t.split("-")[0]}var X$1=Math.max,ve=Math.min,Z=Math.round;function ee(t,r){r===void 0&&(r=!1);var e=t.getBoundingClientRect(),n=1,g=1;if(B(t)&&r){var y=t.offsetHeight,i=t.offsetWidth;i>0&&(n=Z(e.width)/i||1),y>0&&(g=Z(e.height)/y||1)}return{width:e.width/n,height:e.height/g,top:e.top/g,right:e.right/n,bottom:e.bottom/g,left:e.left/n,x:e.left/n,y:e.top/g}}function ke(t){var r=ee(t),e=t.offsetWidth,n=t.offsetHeight;return Math.abs(r.width-e)<=1&&(e=r.width),Math.abs(r.height-n)<=1&&(n=r.height),{x:t.offsetLeft,y:t.offsetTop,width:e,height:n}}function it(t,r){var e=r.getRootNode&&r.getRootNode();if(t.contains(r))return!0;if(e&&Pe(e)){var n=r;do{if(n&&t.isSameNode(n))return!0;n=n.parentNode||n.host}while(n)}return!1}function N$1(t){return H(t).getComputedStyle(t)}function Wt(t){return["table","td","th"].indexOf(C(t))>=0}function I$1(t){return((Q(t)?t.ownerDocument:t.document)||window.document).documentElement}function ge(t){return C(t)==="html"?t:t.assignedSlot||t.parentNode||(Pe(t)?t.host:null)||I$1(t)}function at(t){return!B(t)||N$1(t).position==="fixed"?null:t.offsetParent}function Bt(t){var r=navigator.userAgent.toLowerCase().indexOf("firefox")!==-1,e=navigator.userAgent.indexOf("Trident")!==-1;if(e&&B(t)){var n=N$1(t);if(n.position==="fixed")return null}var g=ge(t);for(Pe(g)&&(g=g.host);B(g)&&["html","body"].indexOf(C(g))<0;){var y=N$1(g);if(y.transform!=="none"||y.perspective!=="none"||y.contain==="paint"||["transform","perspective"].indexOf(y.willChange)!==-1||r&&y.willChange==="filter"||r&&y.filter&&y.filter!=="none")return g;g=g.parentNode}return null}function se(t){for(var r=H(t),e=at(t);e&&Wt(e)&&N$1(e).position==="static";)e=at(e);return e&&(C(e)==="html"||C(e)==="body"&&N$1(e).position==="static")?r:e||Bt(t)||r}function Le(t){return["top","bottom"].indexOf(t)>=0?"x":"y"}function fe(t,r,e){return X$1(t,ve(r,e))}function St(t,r,e){var n=fe(t,r,e);return n>e?e:n}function st(){return{top:0,right:0,bottom:0,left:0}}function ft(t){return Object.assign({},st(),t)}function ct(t,r){return r.reduce(function(e,n){return e[n]=t,e},{})}var Tt=function(t,r){return t=typeof t=="function"?t(Object.assign({},r.rects,{placement:r.placement})):t,ft(typeof t!="number"?t:ct(t,G))};function Ht(t){var r,e=t.state,n=t.name,g=t.options,y=e.elements.arrow,i=e.modifiersData.popperOffsets,k=q(e.placement),L=Le(k),$=[P$1,W].indexOf(k)>=0,V=$?"height":"width";if(!(!y||!i)){var z=Tt(g.padding,e),re=ke(y),oe=L==="y"?E$1:P$1,le=L==="y"?R:W,ue=e.rects.reference[V]+e.rects.reference[L]-i[L]-e.rects.popper[V],ie=i[L]-e.rects.reference[L],ae=se(y),Ie=ae?L==="y"?ae.clientHeight||0:ae.clientWidth||0:0,de=ue/2-ie/2,Ce=z[oe],Ue=Ie-re[V]-z[le],qe=Ie/2-re[V]/2+de,jt=fe(Ce,qe,Ue),Fe=L;e.modifiersData[n]=(r={},r[Fe]=jt,r.centerOffset=jt-qe,r)}}function Ct(t){var r=t.state,e=t.options,n=e.element,g=n===void 0?"[data-popper-arrow]":n;g!=null&&(typeof g=="string"&&(g=r.elements.popper.querySelector(g),!g)||!it(r.elements.popper,g)||(r.elements.arrow=g))}var pt={name:"arrow",enabled:!0,phase:"main",fn:Ht,effect:Ct,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function te(t){return t.split("-")[1]}var qt={top:"auto",right:"auto",bottom:"auto",left:"auto"};function Vt(t){var r=t.x,e=t.y,n=window,g=n.devicePixelRatio||1;return{x:Z(r*g)/g||0,y:Z(e*g)/g||0}}function ut(t){var r,e=t.popper,n=t.popperRect,g=t.placement,y=t.variation,i=t.offsets,k=t.position,L=t.gpuAcceleration,$=t.adaptive,V=t.roundOffsets,z=t.isFixed,re=i.x,oe=re===void 0?0:re,le=i.y,ue=le===void 0?0:le,ie=typeof V=="function"?V({x:oe,y:ue}):{x:oe,y:ue};oe=ie.x,ue=ie.y;var ae=i.hasOwnProperty("x"),Ie=i.hasOwnProperty("y"),de=P$1,Ce=E$1,Ue=window;if($){var qe=se(e),jt="clientHeight",Fe="clientWidth";if(qe===H(e)&&(qe=I$1(e),N$1(qe).position!=="static"&&k==="absolute"&&(jt="scrollHeight",Fe="scrollWidth")),qe=qe,g===E$1||(g===P$1||g===W)&&y===J){Ce=R;var Et=z&&qe===Ue&&Ue.visualViewport?Ue.visualViewport.height:qe[jt];ue-=Et-n.height,ue*=L?1:-1}if(g===P$1||(g===E$1||g===R)&&y===J){de=W;var cr=z&&qe===Ue&&Ue.visualViewport?Ue.visualViewport.width:qe[Fe];oe-=cr-n.width,oe*=L?1:-1}}var er=Object.assign({position:k},$&&qt),nr=V===!0?Vt({x:oe,y:ue}):{x:oe,y:ue};if(oe=nr.x,ue=nr.y,L){var dr;return Object.assign({},er,(dr={},dr[Ce]=Ie?"0":"",dr[de]=ae?"0":"",dr.transform=(Ue.devicePixelRatio||1)<=1?"translate("+oe+"px, "+ue+"px)":"translate3d("+oe+"px, "+ue+"px, 0)",dr))}return Object.assign({},er,(r={},r[Ce]=Ie?ue+"px":"",r[de]=ae?oe+"px":"",r.transform="",r))}function Nt(t){var r=t.state,e=t.options,n=e.gpuAcceleration,g=n===void 0?!0:n,y=e.adaptive,i=y===void 0?!0:y,k=e.roundOffsets,L=k===void 0?!0:k,$={placement:q(r.placement),variation:te(r.placement),popper:r.elements.popper,popperRect:r.rects.popper,gpuAcceleration:g,isFixed:r.options.strategy==="fixed"};r.modifiersData.popperOffsets!=null&&(r.styles.popper=Object.assign({},r.styles.popper,ut(Object.assign({},$,{offsets:r.modifiersData.popperOffsets,position:r.options.strategy,adaptive:i,roundOffsets:L})))),r.modifiersData.arrow!=null&&(r.styles.arrow=Object.assign({},r.styles.arrow,ut(Object.assign({},$,{offsets:r.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:L})))),r.attributes.popper=Object.assign({},r.attributes.popper,{"data-popper-placement":r.placement})}var Me={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:Nt,data:{}},ye={passive:!0};function It(t){var r=t.state,e=t.instance,n=t.options,g=n.scroll,y=g===void 0?!0:g,i=n.resize,k=i===void 0?!0:i,L=H(r.elements.popper),$=[].concat(r.scrollParents.reference,r.scrollParents.popper);return y&&$.forEach(function(V){V.addEventListener("scroll",e.update,ye)}),k&&L.addEventListener("resize",e.update,ye),function(){y&&$.forEach(function(V){V.removeEventListener("scroll",e.update,ye)}),k&&L.removeEventListener("resize",e.update,ye)}}var Re={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:It,data:{}},_t={left:"right",right:"left",bottom:"top",top:"bottom"};function be(t){return t.replace(/left|right|bottom|top/g,function(r){return _t[r]})}var zt={start:"end",end:"start"};function lt(t){return t.replace(/start|end/g,function(r){return zt[r]})}function We(t){var r=H(t),e=r.pageXOffset,n=r.pageYOffset;return{scrollLeft:e,scrollTop:n}}function Be(t){return ee(I$1(t)).left+We(t).scrollLeft}function Ft(t){var r=H(t),e=I$1(t),n=r.visualViewport,g=e.clientWidth,y=e.clientHeight,i=0,k=0;return n&&(g=n.width,y=n.height,/^((?!chrome|android).)*safari/i.test(navigator.userAgent)||(i=n.offsetLeft,k=n.offsetTop)),{width:g,height:y,x:i+Be(t),y:k}}function Ut(t){var r,e=I$1(t),n=We(t),g=(r=t.ownerDocument)==null?void 0:r.body,y=X$1(e.scrollWidth,e.clientWidth,g?g.scrollWidth:0,g?g.clientWidth:0),i=X$1(e.scrollHeight,e.clientHeight,g?g.scrollHeight:0,g?g.clientHeight:0),k=-n.scrollLeft+Be(t),L=-n.scrollTop;return N$1(g||e).direction==="rtl"&&(k+=X$1(e.clientWidth,g?g.clientWidth:0)-y),{width:y,height:i,x:k,y:L}}function Se(t){var r=N$1(t),e=r.overflow,n=r.overflowX,g=r.overflowY;return/auto|scroll|overlay|hidden/.test(e+g+n)}function dt(t){return["html","body","#document"].indexOf(C(t))>=0?t.ownerDocument.body:B(t)&&Se(t)?t:dt(ge(t))}function ce(t,r){var e;r===void 0&&(r=[]);var n=dt(t),g=n===((e=t.ownerDocument)==null?void 0:e.body),y=H(n),i=g?[y].concat(y.visualViewport||[],Se(n)?n:[]):n,k=r.concat(i);return g?k:k.concat(ce(ge(i)))}function Te(t){return Object.assign({},t,{left:t.x,top:t.y,right:t.x+t.width,bottom:t.y+t.height})}function Xt(t){var r=ee(t);return r.top=r.top+t.clientTop,r.left=r.left+t.clientLeft,r.bottom=r.top+t.clientHeight,r.right=r.left+t.clientWidth,r.width=t.clientWidth,r.height=t.clientHeight,r.x=r.left,r.y=r.top,r}function ht(t,r){return r===je?Te(Ft(t)):Q(r)?Xt(r):Te(Ut(I$1(t)))}function Yt(t){var r=ce(ge(t)),e=["absolute","fixed"].indexOf(N$1(t).position)>=0,n=e&&B(t)?se(t):t;return Q(n)?r.filter(function(g){return Q(g)&&it(g,n)&&C(g)!=="body"}):[]}function Gt(t,r,e){var n=r==="clippingParents"?Yt(t):[].concat(r),g=[].concat(n,[e]),y=g[0],i=g.reduce(function(k,L){var $=ht(t,L);return k.top=X$1($.top,k.top),k.right=ve($.right,k.right),k.bottom=ve($.bottom,k.bottom),k.left=X$1($.left,k.left),k},ht(t,y));return i.width=i.right-i.left,i.height=i.bottom-i.top,i.x=i.left,i.y=i.top,i}function mt(t){var r=t.reference,e=t.element,n=t.placement,g=n?q(n):null,y=n?te(n):null,i=r.x+r.width/2-e.width/2,k=r.y+r.height/2-e.height/2,L;switch(g){case E$1:L={x:i,y:r.y-e.height};break;case R:L={x:i,y:r.y+r.height};break;case W:L={x:r.x+r.width,y:k};break;case P$1:L={x:r.x-e.width,y:k};break;default:L={x:r.x,y:r.y}}var $=g?Le(g):null;if($!=null){var V=$==="y"?"height":"width";switch(y){case U$1:L[$]=L[$]-(r[V]/2-e[V]/2);break;case J:L[$]=L[$]+(r[V]/2-e[V]/2);break}}return L}function ne(t,r){r===void 0&&(r={});var e=r,n=e.placement,g=n===void 0?t.placement:n,y=e.boundary,i=y===void 0?Xe:y,k=e.rootBoundary,L=k===void 0?je:k,$=e.elementContext,V=$===void 0?K:$,z=e.altBoundary,re=z===void 0?!1:z,oe=e.padding,le=oe===void 0?0:oe,ue=ft(typeof le!="number"?le:ct(le,G)),ie=V===K?Ye:K,ae=t.rects.popper,Ie=t.elements[re?ie:V],de=Gt(Q(Ie)?Ie:Ie.contextElement||I$1(t.elements.popper),i,L),Ce=ee(t.elements.reference),Ue=mt({reference:Ce,element:ae,strategy:"absolute",placement:g}),qe=Te(Object.assign({},ae,Ue)),jt=V===K?qe:Ce,Fe={top:de.top-jt.top+ue.top,bottom:jt.bottom-de.bottom+ue.bottom,left:de.left-jt.left+ue.left,right:jt.right-de.right+ue.right},Et=t.modifiersData.offset;if(V===K&&Et){var cr=Et[g];Object.keys(Fe).forEach(function(er){var nr=[W,R].indexOf(er)>=0?1:-1,dr=[E$1,R].indexOf(er)>=0?"y":"x";Fe[er]+=cr[dr]*nr})}return Fe}function Jt(t,r){r===void 0&&(r={});var e=r,n=e.placement,g=e.boundary,y=e.rootBoundary,i=e.padding,k=e.flipVariations,L=e.allowedAutoPlacements,$=L===void 0?Ee:L,V=te(n),z=V?k?De:De.filter(function(le){return te(le)===V}):G,re=z.filter(function(le){return $.indexOf(le)>=0});re.length===0&&(re=z);var oe=re.reduce(function(le,ue){return le[ue]=ne(t,{placement:ue,boundary:g,rootBoundary:y,padding:i})[q(ue)],le},{});return Object.keys(oe).sort(function(le,ue){return oe[le]-oe[ue]})}function Kt(t){if(q(t)===me)return[];var r=be(t);return[lt(t),r,lt(r)]}function Qt(t){var r=t.state,e=t.options,n=t.name;if(!r.modifiersData[n]._skip){for(var g=e.mainAxis,y=g===void 0?!0:g,i=e.altAxis,k=i===void 0?!0:i,L=e.fallbackPlacements,$=e.padding,V=e.boundary,z=e.rootBoundary,re=e.altBoundary,oe=e.flipVariations,le=oe===void 0?!0:oe,ue=e.allowedAutoPlacements,ie=r.options.placement,ae=q(ie),Ie=ae===ie,de=L||(Ie||!le?[be(ie)]:Kt(ie)),Ce=[ie].concat(de).reduce(function(mr,Ir){return mr.concat(q(Ir)===me?Jt(r,{placement:Ir,boundary:V,rootBoundary:z,padding:$,flipVariations:le,allowedAutoPlacements:ue}):Ir)},[]),Ue=r.rects.reference,qe=r.rects.popper,jt=new Map,Fe=!0,Et=Ce[0],cr=0;cr<Ce.length;cr++){var er=Ce[cr],nr=q(er),dr=te(er)===U$1,ir=[E$1,R].indexOf(nr)>=0,tr=ir?"width":"height",ur=ne(r,{placement:er,boundary:V,rootBoundary:z,altBoundary:re,padding:$}),or=ir?dr?W:P$1:dr?R:E$1;Ue[tr]>qe[tr]&&(or=be(or));var fr=be(or),lr=[];if(y&&lr.push(ur[nr]<=0),k&&lr.push(ur[or]<=0,ur[fr]<=0),lr.every(function(mr){return mr})){Et=er,Fe=!1;break}jt.set(er,lr)}if(Fe)for(var gr=le?3:1,Sr=function(mr){var Ir=Ce.find(function(Nr){var Er=jt.get(Nr);if(Er)return Er.slice(0,mr).every(function(sr){return sr})});if(Ir)return Et=Ir,"break"},wr=gr;wr>0;wr--){var kr=Sr(wr);if(kr==="break")break}r.placement!==Et&&(r.modifiersData[n]._skip=!0,r.placement=Et,r.reset=!0)}}var vt={name:"flip",enabled:!0,phase:"main",fn:Qt,requiresIfExists:["offset"],data:{_skip:!1}};function gt(t,r,e){return e===void 0&&(e={x:0,y:0}),{top:t.top-r.height-e.y,right:t.right-r.width+e.x,bottom:t.bottom-r.height+e.y,left:t.left-r.width-e.x}}function yt(t){return[E$1,W,R,P$1].some(function(r){return t[r]>=0})}function Zt(t){var r=t.state,e=t.name,n=r.rects.reference,g=r.rects.popper,y=r.modifiersData.preventOverflow,i=ne(r,{elementContext:"reference"}),k=ne(r,{altBoundary:!0}),L=gt(i,n),$=gt(k,g,y),V=yt(L),z=yt($);r.modifiersData[e]={referenceClippingOffsets:L,popperEscapeOffsets:$,isReferenceHidden:V,hasPopperEscaped:z},r.attributes.popper=Object.assign({},r.attributes.popper,{"data-popper-reference-hidden":V,"data-popper-escaped":z})}var bt={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:Zt};function en(t,r,e){var n=q(t),g=[P$1,E$1].indexOf(n)>=0?-1:1,y=typeof e=="function"?e(Object.assign({},r,{placement:t})):e,i=y[0],k=y[1];return i=i||0,k=(k||0)*g,[P$1,W].indexOf(n)>=0?{x:k,y:i}:{x:i,y:k}}function tn(t){var r=t.state,e=t.options,n=t.name,g=e.offset,y=g===void 0?[0,0]:g,i=Ee.reduce(function(V,z){return V[z]=en(z,r.rects,y),V},{}),k=i[r.placement],L=k.x,$=k.y;r.modifiersData.popperOffsets!=null&&(r.modifiersData.popperOffsets.x+=L,r.modifiersData.popperOffsets.y+=$),r.modifiersData[n]=i}var wt={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:tn};function nn(t){var r=t.state,e=t.name;r.modifiersData[e]=mt({reference:r.rects.reference,element:r.rects.popper,strategy:"absolute",placement:r.placement})}var He={name:"popperOffsets",enabled:!0,phase:"read",fn:nn,data:{}};function rn(t){return t==="x"?"y":"x"}function on(t){var r=t.state,e=t.options,n=t.name,g=e.mainAxis,y=g===void 0?!0:g,i=e.altAxis,k=i===void 0?!1:i,L=e.boundary,$=e.rootBoundary,V=e.altBoundary,z=e.padding,re=e.tether,oe=re===void 0?!0:re,le=e.tetherOffset,ue=le===void 0?0:le,ie=ne(r,{boundary:L,rootBoundary:$,padding:z,altBoundary:V}),ae=q(r.placement),Ie=te(r.placement),de=!Ie,Ce=Le(ae),Ue=rn(Ce),qe=r.modifiersData.popperOffsets,jt=r.rects.reference,Fe=r.rects.popper,Et=typeof ue=="function"?ue(Object.assign({},r.rects,{placement:r.placement})):ue,cr=typeof Et=="number"?{mainAxis:Et,altAxis:Et}:Object.assign({mainAxis:0,altAxis:0},Et),er=r.modifiersData.offset?r.modifiersData.offset[r.placement]:null,nr={x:0,y:0};if(qe){if(y){var dr,ir=Ce==="y"?E$1:P$1,tr=Ce==="y"?R:W,ur=Ce==="y"?"height":"width",or=qe[Ce],fr=or+ie[ir],lr=or-ie[tr],gr=oe?-Fe[ur]/2:0,Sr=Ie===U$1?jt[ur]:Fe[ur],wr=Ie===U$1?-Fe[ur]:-jt[ur],kr=r.elements.arrow,mr=oe&&kr?ke(kr):{width:0,height:0},Ir=r.modifiersData["arrow#persistent"]?r.modifiersData["arrow#persistent"].padding:st(),Nr=Ir[ir],Er=Ir[tr],sr=fe(0,jt[ur],mr[ur]),xr=de?jt[ur]/2-gr-sr-Nr-cr.mainAxis:Sr-sr-Nr-cr.mainAxis,Or=de?-jt[ur]/2+gr+sr+Er+cr.mainAxis:wr+sr+Er+cr.mainAxis,Mr=r.elements.arrow&&se(r.elements.arrow),br=Mr?Ce==="y"?Mr.clientTop||0:Mr.clientLeft||0:0,hr=(dr=er==null?void 0:er[Ce])!=null?dr:0,Tr=or+xr-hr-br,Br=or+Or-hr,Fr=fe(oe?ve(fr,Tr):fr,or,oe?X$1(lr,Br):lr);qe[Ce]=Fr,nr[Ce]=Fr-or}if(k){var Lr,qr=Ce==="x"?E$1:P$1,Ur=Ce==="x"?R:W,Qr=qe[Ue],vn=Ue==="y"?"height":"width",_n=Qr+ie[qr],Yr=Qr-ie[Ur],jn=[E$1,P$1].indexOf(ae)!==-1,Zr=(Lr=er==null?void 0:er[Ue])!=null?Lr:0,An=jn?_n:Qr-jt[vn]-Fe[vn]-Zr+cr.altAxis,Jr=jn?Qr+jt[vn]+Fe[vn]-Zr-cr.altAxis:Yr,Mn=oe&&jn?St(An,Qr,Jr):fe(oe?An:_n,Qr,oe?Jr:Yr);qe[Ue]=Mn,nr[Ue]=Mn-Qr}r.modifiersData[n]=nr}}var xt={name:"preventOverflow",enabled:!0,phase:"main",fn:on,requiresIfExists:["offset"]};function an(t){return{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}}function sn(t){return t===H(t)||!B(t)?We(t):an(t)}function fn(t){var r=t.getBoundingClientRect(),e=Z(r.width)/t.offsetWidth||1,n=Z(r.height)/t.offsetHeight||1;return e!==1||n!==1}function cn(t,r,e){e===void 0&&(e=!1);var n=B(r),g=B(r)&&fn(r),y=I$1(r),i=ee(t,g),k={scrollLeft:0,scrollTop:0},L={x:0,y:0};return(n||!n&&!e)&&((C(r)!=="body"||Se(y))&&(k=sn(r)),B(r)?(L=ee(r,!0),L.x+=r.clientLeft,L.y+=r.clientTop):y&&(L.x=Be(y))),{x:i.left+k.scrollLeft-L.x,y:i.top+k.scrollTop-L.y,width:i.width,height:i.height}}function pn(t){var r=new Map,e=new Set,n=[];t.forEach(function(y){r.set(y.name,y)});function g(y){e.add(y.name);var i=[].concat(y.requires||[],y.requiresIfExists||[]);i.forEach(function(k){if(!e.has(k)){var L=r.get(k);L&&g(L)}}),n.push(y)}return t.forEach(function(y){e.has(y.name)||g(y)}),n}function un(t){var r=pn(t);return ot.reduce(function(e,n){return e.concat(r.filter(function(g){return g.phase===n}))},[])}function ln(t){var r;return function(){return r||(r=new Promise(function(e){Promise.resolve().then(function(){r=void 0,e(t())})})),r}}function dn(t){var r=t.reduce(function(e,n){var g=e[n.name];return e[n.name]=g?Object.assign({},g,n,{options:Object.assign({},g.options,n.options),data:Object.assign({},g.data,n.data)}):n,e},{});return Object.keys(r).map(function(e){return r[e]})}var Ot={placement:"bottom",modifiers:[],strategy:"absolute"};function $t(){for(var t=arguments.length,r=new Array(t),e=0;e<t;e++)r[e]=arguments[e];return!r.some(function(n){return!(n&&typeof n.getBoundingClientRect=="function")})}function we(t){t===void 0&&(t={});var r=t,e=r.defaultModifiers,n=e===void 0?[]:e,g=r.defaultOptions,y=g===void 0?Ot:g;return function(i,k,L){L===void 0&&(L=y);var $={placement:"bottom",orderedModifiers:[],options:Object.assign({},Ot,y),modifiersData:{},elements:{reference:i,popper:k},attributes:{},styles:{}},V=[],z=!1,re={state:$,setOptions:function(ue){var ie=typeof ue=="function"?ue($.options):ue;le(),$.options=Object.assign({},y,$.options,ie),$.scrollParents={reference:Q(i)?ce(i):i.contextElement?ce(i.contextElement):[],popper:ce(k)};var ae=un(dn([].concat(n,$.options.modifiers)));return $.orderedModifiers=ae.filter(function(Ie){return Ie.enabled}),oe(),re.update()},forceUpdate:function(){if(!z){var ue=$.elements,ie=ue.reference,ae=ue.popper;if($t(ie,ae)){$.rects={reference:cn(ie,se(ae),$.options.strategy==="fixed"),popper:ke(ae)},$.reset=!1,$.placement=$.options.placement,$.orderedModifiers.forEach(function(Fe){return $.modifiersData[Fe.name]=Object.assign({},Fe.data)});for(var Ie=0;Ie<$.orderedModifiers.length;Ie++){if($.reset===!0){$.reset=!1,Ie=-1;continue}var de=$.orderedModifiers[Ie],Ce=de.fn,Ue=de.options,qe=Ue===void 0?{}:Ue,jt=de.name;typeof Ce=="function"&&($=Ce({state:$,options:qe,name:jt,instance:re})||$)}}}},update:ln(function(){return new Promise(function(ue){re.forceUpdate(),ue($)})}),destroy:function(){le(),z=!0}};if(!$t(i,k))return re;re.setOptions(L).then(function(ue){!z&&L.onFirstUpdate&&L.onFirstUpdate(ue)});function oe(){$.orderedModifiers.forEach(function(ue){var ie=ue.name,ae=ue.options,Ie=ae===void 0?{}:ae,de=ue.effect;if(typeof de=="function"){var Ce=de({state:$,name:ie,instance:re,options:Ie}),Ue=function(){};V.push(Ce||Ue)}})}function le(){V.forEach(function(ue){return ue()}),V=[]}return re}}we();var mn=[Re,He,Me,Ae];we({defaultModifiers:mn});var gn=[Re,He,Me,Ae,wt,vt,xt,pt,bt],yn=we({defaultModifiers:gn});const usePopper=(t,r,e={})=>{const n={name:"updateState",enabled:!0,phase:"write",fn:({state:L})=>{const $=deriveState(L);Object.assign(i.value,$)},requires:["computeStyles"]},g=computed(()=>{const{onFirstUpdate:L,placement:$,strategy:V,modifiers:z}=unref(e);return{onFirstUpdate:L,placement:$||"bottom",strategy:V||"absolute",modifiers:[...z||[],n,{name:"applyStyles",enabled:!1}]}}),y=shallowRef(),i=ref({styles:{popper:{position:unref(g).strategy,left:"0",top:"0"},arrow:{position:"absolute"}},attributes:{}}),k=()=>{y.value&&(y.value.destroy(),y.value=void 0)};return watch(g,L=>{const $=unref(y);$&&$.setOptions(L)},{deep:!0}),watch([t,r],([L,$])=>{k(),!(!L||!$)&&(y.value=yn(L,$,unref(g)))}),onBeforeUnmount(()=>{k()}),{state:computed(()=>{var L;return{...((L=unref(y))==null?void 0:L.state)||{}}}),styles:computed(()=>unref(i).styles),attributes:computed(()=>unref(i).attributes),update:()=>{var L;return(L=unref(y))==null?void 0:L.update()},forceUpdate:()=>{var L;return(L=unref(y))==null?void 0:L.forceUpdate()},instanceRef:computed(()=>unref(y))}};function deriveState(t){const r=Object.keys(t.elements),e=fromPairs(r.map(g=>[g,t.styles[g]||{}])),n=fromPairs(r.map(g=>[g,t.attributes[g]]));return{styles:e,attributes:n}}const useSameTarget=t=>{if(!t)return{onClick:NOOP,onMousedown:NOOP,onMouseup:NOOP};let r=!1,e=!1;return{onClick:i=>{r&&e&&t(i),r=e=!1},onMousedown:i=>{r=i.target===i.currentTarget},onMouseup:i=>{e=i.target===i.currentTarget}}};function useTimeout(){let t;const r=(n,g)=>{e(),t=window.setTimeout(n,g)},e=()=>window.clearTimeout(t);return tryOnScopeDispose(()=>e()),{registerTimeout:r,cancelTimeout:e}}const defaultIdInjection={prefix:Math.floor(Math.random()*1e4),current:0},ID_INJECTION_KEY=Symbol("elIdInjection"),useIdInjection=()=>getCurrentInstance()?inject(ID_INJECTION_KEY,defaultIdInjection):defaultIdInjection,useId=t=>{const r=useIdInjection(),e=useGetDerivedNamespace();return computed(()=>unref(t)||`${e.value}-id-${r.prefix}-${r.current++}`)};let registeredEscapeHandlers=[];const cachedHandler=t=>{const r=t;r.key===EVENT_CODE.esc&&registeredEscapeHandlers.forEach(e=>e(r))},useEscapeKeydown=t=>{onMounted(()=>{registeredEscapeHandlers.length===0&&document.addEventListener("keydown",cachedHandler),isClient&&registeredEscapeHandlers.push(t)}),onBeforeUnmount(()=>{registeredEscapeHandlers=registeredEscapeHandlers.filter(r=>r!==t),registeredEscapeHandlers.length===0&&isClient&&document.removeEventListener("keydown",cachedHandler)})};let cachedContainer;const usePopperContainerId=()=>{const t=useGetDerivedNamespace(),r=useIdInjection(),e=computed(()=>`${t.value}-popper-container-${r.prefix}`),n=computed(()=>`#${e.value}`);return{id:e,selector:n}},createContainer=t=>{const r=document.createElement("div");return r.id=t,document.body.appendChild(r),r},usePopperContainer=()=>{const{id:t,selector:r}=usePopperContainerId();return onBeforeMount(()=>{isClient&&!cachedContainer&&!document.body.querySelector(r.value)&&(cachedContainer=createContainer(t.value))}),{id:t,selector:r}},useDelayedToggleProps=buildProps({showAfter:{type:Number,default:0},hideAfter:{type:Number,default:200},autoClose:{type:Number,default:0}}),useDelayedToggle=({showAfter:t,hideAfter:r,autoClose:e,open:n,close:g})=>{const{registerTimeout:y}=useTimeout(),{registerTimeout:i,cancelTimeout:k}=useTimeout();return{onOpen:V=>{y(()=>{n(V);const z=unref(e);isNumber$1(z)&&z>0&&i(()=>{g(V)},z)},unref(t))},onClose:V=>{k(),y(()=>{g(V)},unref(r))}}},FORWARD_REF_INJECTION_KEY=Symbol("elForwardRef"),useForwardRef=t=>{provide(FORWARD_REF_INJECTION_KEY,{setForwardRef:e=>{t.value=e}})},useForwardRefDirective=t=>({mounted(r){t(r)},updated(r){t(r)},unmounted(){t(null)}}),zIndex=ref(0),defaultInitialZIndex=2e3,zIndexContextKey=Symbol("zIndexContextKey"),useZIndex=t=>{const r=t||(getCurrentInstance()?inject(zIndexContextKey,void 0):void 0),e=computed(()=>{const y=unref(r);return isNumber$1(y)?y:defaultInitialZIndex}),n=computed(()=>e.value+zIndex.value);return{initialZIndex:e,currentZIndex:n,nextZIndex:()=>(zIndex.value++,n.value)}};function useCursor(t){const r=ref();function e(){if(t.value==null)return;const{selectionStart:g,selectionEnd:y,value:i}=t.value;if(g==null||y==null)return;const k=i.slice(0,Math.max(0,g)),L=i.slice(Math.max(0,y));r.value={selectionStart:g,selectionEnd:y,value:i,beforeTxt:k,afterTxt:L}}function n(){if(t.value==null||r.value==null)return;const{value:g}=t.value,{beforeTxt:y,afterTxt:i,selectionStart:k}=r.value;if(y==null||i==null||k==null)return;let L=g.length;if(g.endsWith(i))L=g.length-i.length;else if(g.startsWith(y))L=y.length;else{const $=y[k-1],V=g.indexOf($,k-1);V!==-1&&(L=V+1)}t.value.setSelectionRange(L,L)}return[e,n]}const useSizeProp=buildProp({type:String,values:componentSizes,required:!1}),SIZE_INJECTION_KEY=Symbol("size"),useGlobalSize=()=>{const t=inject(SIZE_INJECTION_KEY,{});return computed(()=>unref(t.size)||"")};function useFocusController(t,{afterFocus:r,beforeBlur:e,afterBlur:n}={}){const g=getCurrentInstance(),{emit:y}=g,i=shallowRef(),k=ref(!1),L=z=>{k.value||(k.value=!0,y("focus",z),r==null||r())},$=z=>{var re;isFunction$3(e)&&e(z)||z.relatedTarget&&((re=i.value)!=null&&re.contains(z.relatedTarget))||(k.value=!1,y("blur",z),n==null||n())},V=()=>{var z;(z=t.value)==null||z.focus()};return watch(i,z=>{z&&z.setAttribute("tabindex","-1")}),useEventListener(i,"click",V),{wrapperRef:i,isFocused:k,handleFocus:L,handleBlur:$}}const configProviderContextKey=Symbol(),globalConfig=ref();function useGlobalConfig(t,r=void 0){const e=getCurrentInstance()?inject(configProviderContextKey,globalConfig):globalConfig;return t?computed(()=>{var n,g;return(g=(n=e.value)==null?void 0:n[t])!=null?g:r}):e}function useGlobalComponentSettings(t,r){const e=useGlobalConfig(),n=useNamespace(t,computed(()=>{var k;return((k=e.value)==null?void 0:k.namespace)||defaultNamespace})),g=useLocale(computed(()=>{var k;return(k=e.value)==null?void 0:k.locale})),y=useZIndex(computed(()=>{var k;return((k=e.value)==null?void 0:k.zIndex)||defaultInitialZIndex})),i=computed(()=>{var k;return unref(r)||((k=e.value)==null?void 0:k.size)||""});return provideGlobalConfig(computed(()=>unref(e)||{})),{ns:n,locale:g,zIndex:y,size:i}}const provideGlobalConfig=(t,r,e=!1)=>{var n;const g=!!getCurrentInstance(),y=g?useGlobalConfig():void 0,i=(n=r==null?void 0:r.provide)!=null?n:g?provide:void 0;if(!i)return;const k=computed(()=>{const L=unref(t);return y!=null&&y.value?mergeConfig$1(y.value,L):L});return i(configProviderContextKey,k),i(localeContextKey,computed(()=>k.value.locale)),i(namespaceContextKey,computed(()=>k.value.namespace)),i(zIndexContextKey,computed(()=>k.value.zIndex)),i(SIZE_INJECTION_KEY,{size:computed(()=>k.value.size||"")}),(e||!globalConfig.value)&&(globalConfig.value=k.value),k},mergeConfig$1=(t,r)=>{var e;const n=[...new Set([...keysOf(t),...keysOf(r)])],g={};for(const y of n)g[y]=(e=r[y])!=null?e:t[y];return g},configProviderProps=buildProps({a11y:{type:Boolean,default:!0},locale:{type:definePropType(Object)},size:useSizeProp,button:{type:definePropType(Object)},experimentalFeatures:{type:definePropType(Object)},keyboardNavigation:{type:Boolean,default:!0},message:{type:definePropType(Object)},zIndex:Number,namespace:{type:String,default:"el"}}),messageConfig={},ConfigProvider=defineComponent({name:"ElConfigProvider",props:configProviderProps,setup(t,{slots:r}){watch(()=>t.message,n=>{Object.assign(messageConfig,n??{})},{immediate:!0,deep:!0});const e=provideGlobalConfig(t);return()=>renderSlot(r,"default",{config:e==null?void 0:e.value})}}),ElConfigProvider=withInstall(ConfigProvider),affixProps=buildProps({zIndex:{type:definePropType([Number,String]),default:100},target:{type:String,default:""},offset:{type:Number,default:0},position:{type:String,values:["top","bottom"],default:"top"}}),affixEmits={scroll:({scrollTop:t,fixed:r})=>isNumber$1(t)&&isBoolean$1(r),[CHANGE_EVENT]:t=>isBoolean$1(t)};var _export_sfc$1=(t,r)=>{const e=t.__vccOpts||t;for(const[n,g]of r)e[n]=g;return e};const COMPONENT_NAME$b="ElAffix",__default__$Q=defineComponent({name:COMPONENT_NAME$b}),_sfc_main$1j=defineComponent({...__default__$Q,props:affixProps,emits:affixEmits,setup(t,{expose:r,emit:e}){const n=t,g=useNamespace("affix"),y=shallowRef(),i=shallowRef(),k=shallowRef(),{height:L}=useWindowSize(),{height:$,width:V,top:z,bottom:re,update:oe}=useElementBounding(i,{windowScroll:!1}),le=useElementBounding(y),ue=ref(!1),ie=ref(0),ae=ref(0),Ie=computed(()=>({height:ue.value?`${$.value}px`:"",width:ue.value?`${V.value}px`:""})),de=computed(()=>{if(!ue.value)return{};const qe=n.offset?addUnit(n.offset):0;return{height:`${$.value}px`,width:`${V.value}px`,top:n.position==="top"?qe:"",bottom:n.position==="bottom"?qe:"",transform:ae.value?`translateY(${ae.value}px)`:"",zIndex:n.zIndex}}),Ce=()=>{if(k.value)if(ie.value=k.value instanceof Window?document.documentElement.scrollTop:k.value.scrollTop||0,n.position==="top")if(n.target){const qe=le.bottom.value-n.offset-$.value;ue.value=n.offset>z.value&&le.bottom.value>0,ae.value=qe<0?qe:0}else ue.value=n.offset>z.value;else if(n.target){const qe=L.value-le.top.value-n.offset-$.value;ue.value=L.value-n.offset<re.value&&L.value>le.top.value,ae.value=qe<0?-qe:0}else ue.value=L.value-n.offset<re.value},Ue=()=>{oe(),e("scroll",{scrollTop:ie.value,fixed:ue.value})};return watch(ue,qe=>e("change",qe)),onMounted(()=>{var qe;n.target?(y.value=(qe=document.querySelector(n.target))!=null?qe:void 0,y.value||throwError(COMPONENT_NAME$b,`Target is not existed: ${n.target}`)):y.value=document.documentElement,k.value=getScrollContainer(i.value,!0),oe()}),useEventListener(k,"scroll",Ue),watchEffect(Ce),r({update:Ce,updateRoot:oe}),(qe,jt)=>(openBlock(),createElementBlock("div",{ref_key:"root",ref:i,class:normalizeClass(unref(g).b()),style:normalizeStyle(unref(Ie))},[createBaseVNode("div",{class:normalizeClass({[unref(g).m("fixed")]:ue.value}),style:normalizeStyle(unref(de))},[renderSlot(qe.$slots,"default")],6)],6))}});var Affix=_export_sfc$1(_sfc_main$1j,[["__file","affix.vue"]]);const ElAffix=withInstall(Affix),iconProps=buildProps({size:{type:definePropType([Number,String])},color:{type:String}}),__default__$P=defineComponent({name:"ElIcon",inheritAttrs:!1}),_sfc_main$1i=defineComponent({...__default__$P,props:iconProps,setup(t){const r=t,e=useNamespace("icon"),n=computed(()=>{const{size:g,color:y}=r;return!g&&!y?{}:{fontSize:isUndefined$1(g)?void 0:addUnit(g),"--color":y}});return(g,y)=>(openBlock(),createElementBlock("i",mergeProps({class:unref(e).b(),style:unref(n)},g.$attrs),[renderSlot(g.$slots,"default")],16))}});var Icon=_export_sfc$1(_sfc_main$1i,[["__file","icon.vue"]]);const ElIcon=withInstall(Icon),formContextKey=Symbol("formContextKey"),formItemContextKey=Symbol("formItemContextKey"),useFormSize=(t,r={})=>{const e=ref(void 0),n=r.prop?e:useProp("size"),g=r.global?e:useGlobalSize(),y=r.form?{size:void 0}:inject(formContextKey,void 0),i=r.formItem?{size:void 0}:inject(formItemContextKey,void 0);return computed(()=>n.value||unref(t)||(i==null?void 0:i.size)||(y==null?void 0:y.size)||g.value||"")},useFormDisabled=t=>{const r=useProp("disabled"),e=inject(formContextKey,void 0);return computed(()=>r.value||unref(t)||(e==null?void 0:e.disabled)||!1)},useFormItem=()=>{const t=inject(formContextKey,void 0),r=inject(formItemContextKey,void 0);return{form:t,formItem:r}},useFormItemInputId=(t,{formItemContext:r,disableIdGeneration:e,disableIdManagement:n})=>{e||(e=ref(!1)),n||(n=ref(!1));const g=ref();let y;const i=computed(()=>{var k;return!!(!t.label&&r&&r.inputIds&&((k=r.inputIds)==null?void 0:k.length)<=1)});return onMounted(()=>{y=watch([toRef(t,"id"),e],([k,L])=>{const $=k??(L?void 0:useId().value);$!==g.value&&(r!=null&&r.removeInputId&&(g.value&&r.removeInputId(g.value),!(n!=null&&n.value)&&!L&&$&&r.addInputId($)),g.value=$)},{immediate:!0})}),onUnmounted(()=>{y&&y(),r!=null&&r.removeInputId&&g.value&&r.removeInputId(g.value)}),{isLabeledByFormItem:i,inputId:g}},formMetaProps=buildProps({size:{type:String,values:componentSizes},disabled:Boolean}),formProps=buildProps({...formMetaProps,model:Object,rules:{type:definePropType(Object)},labelPosition:{type:String,values:["left","right","top"],default:"right"},requireAsteriskPosition:{type:String,values:["left","right"],default:"left"},labelWidth:{type:[String,Number],default:""},labelSuffix:{type:String,default:""},inline:Boolean,inlineMessage:Boolean,statusIcon:Boolean,showMessage:{type:Boolean,default:!0},validateOnRuleChange:{type:Boolean,default:!0},hideRequiredAsterisk:Boolean,scrollToError:Boolean,scrollIntoViewOptions:{type:[Object,Boolean]}}),formEmits={validate:(t,r,e)=>(isArray$3(t)||isString$2(t))&&isBoolean$1(r)&&isString$2(e)};function useFormLabelWidth(){const t=ref([]),r=computed(()=>{if(!t.value.length)return"0";const y=Math.max(...t.value);return y?`${y}px`:""});function e(y){const i=t.value.indexOf(y);return i===-1&&r.value,i}function n(y,i){if(y&&i){const k=e(i);t.value.splice(k,1,y)}else y&&t.value.push(y)}function g(y){const i=e(y);i>-1&&t.value.splice(i,1)}return{autoLabelWidth:r,registerLabelWidth:n,deregisterLabelWidth:g}}const filterFields=(t,r)=>{const e=castArray$1(r);return e.length>0?t.filter(n=>n.prop&&e.includes(n.prop)):t},COMPONENT_NAME$a="ElForm",__default__$O=defineComponent({name:COMPONENT_NAME$a}),_sfc_main$1h=defineComponent({...__default__$O,props:formProps,emits:formEmits,setup(t,{expose:r,emit:e}){const n=t,g=[],y=useFormSize(),i=useNamespace("form"),k=computed(()=>{const{labelPosition:de,inline:Ce}=n;return[i.b(),i.m(y.value||"default"),{[i.m(`label-${de}`)]:de,[i.m("inline")]:Ce}]}),L=de=>g.find(Ce=>Ce.prop===de),$=de=>{g.push(de)},V=de=>{de.prop&&g.splice(g.indexOf(de),1)},z=(de=[])=>{n.model&&filterFields(g,de).forEach(Ce=>Ce.resetField())},re=(de=[])=>{filterFields(g,de).forEach(Ce=>Ce.clearValidate())},oe=computed(()=>!!n.model),le=de=>{if(g.length===0)return[];const Ce=filterFields(g,de);return Ce.length?Ce:[]},ue=async de=>ae(void 0,de),ie=async(de=[])=>{if(!oe.value)return!1;const Ce=le(de);if(Ce.length===0)return!0;let Ue={};for(const qe of Ce)try{await qe.validate("")}catch(jt){Ue={...Ue,...jt}}return Object.keys(Ue).length===0?!0:Promise.reject(Ue)},ae=async(de=[],Ce)=>{const Ue=!isFunction$3(Ce);try{const qe=await ie(de);return qe===!0&&(Ce==null||Ce(qe)),qe}catch(qe){if(qe instanceof Error)throw qe;const jt=qe;return n.scrollToError&&Ie(Object.keys(jt)[0]),Ce==null||Ce(!1,jt),Ue&&Promise.reject(jt)}},Ie=de=>{var Ce;const Ue=filterFields(g,de)[0];Ue&&((Ce=Ue.$el)==null||Ce.scrollIntoView(n.scrollIntoViewOptions))};return watch(()=>n.rules,()=>{n.validateOnRuleChange&&ue().catch(de=>void 0)},{deep:!0}),provide(formContextKey,reactive({...toRefs(n),emit:e,resetFields:z,clearValidate:re,validateField:ae,getField:L,addField:$,removeField:V,...useFormLabelWidth()})),r({validate:ue,validateField:ae,resetFields:z,clearValidate:re,scrollToField:Ie}),(de,Ce)=>(openBlock(),createElementBlock("form",{class:normalizeClass(unref(k))},[renderSlot(de.$slots,"default")],2))}});var Form=_export_sfc$1(_sfc_main$1h,[["__file","form.vue"]]);function _extends(){return _extends=Object.assign?Object.assign.bind():function(t){for(var r=1;r<arguments.length;r++){var e=arguments[r];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])}return t},_extends.apply(this,arguments)}function _inheritsLoose(t,r){t.prototype=Object.create(r.prototype),t.prototype.constructor=t,_setPrototypeOf(t,r)}function _getPrototypeOf(t){return _getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},_getPrototypeOf(t)}function _setPrototypeOf(t,r){return _setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,g){return n.__proto__=g,n},_setPrototypeOf(t,r)}function _isNativeReflectConstruct(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function _construct(t,r,e){return _isNativeReflectConstruct()?_construct=Reflect.construct.bind():_construct=function(g,y,i){var k=[null];k.push.apply(k,y);var L=Function.bind.apply(g,k),$=new L;return i&&_setPrototypeOf($,i.prototype),$},_construct.apply(null,arguments)}function _isNativeFunction(t){return Function.toString.call(t).indexOf("[native code]")!==-1}function _wrapNativeSuper(t){var r=typeof Map=="function"?new Map:void 0;return _wrapNativeSuper=function(n){if(n===null||!_isNativeFunction(n))return n;if(typeof n!="function")throw new TypeError("Super expression must either be null or a function");if(typeof r<"u"){if(r.has(n))return r.get(n);r.set(n,g)}function g(){return _construct(n,arguments,_getPrototypeOf(this).constructor)}return g.prototype=Object.create(n.prototype,{constructor:{value:g,enumerable:!1,writable:!0,configurable:!0}}),_setPrototypeOf(g,n)},_wrapNativeSuper(t)}var formatRegExp=/%[sdj%]/g,warning=function(){};typeof process<"u"&&process.env;function convertFieldsError(t){if(!t||!t.length)return null;var r={};return t.forEach(function(e){var n=e.field;r[n]=r[n]||[],r[n].push(e)}),r}function format(t){for(var r=arguments.length,e=new Array(r>1?r-1:0),n=1;n<r;n++)e[n-1]=arguments[n];var g=0,y=e.length;if(typeof t=="function")return t.apply(null,e);if(typeof t=="string"){var i=t.replace(formatRegExp,function(k){if(k==="%%")return"%";if(g>=y)return k;switch(k){case"%s":return String(e[g++]);case"%d":return Number(e[g++]);case"%j":try{return JSON.stringify(e[g++])}catch{return"[Circular]"}break;default:return k}});return i}return t}function isNativeStringType(t){return t==="string"||t==="url"||t==="hex"||t==="email"||t==="date"||t==="pattern"}function isEmptyValue(t,r){return!!(t==null||r==="array"&&Array.isArray(t)&&!t.length||isNativeStringType(r)&&typeof t=="string"&&!t)}function asyncParallelArray(t,r,e){var n=[],g=0,y=t.length;function i(k){n.push.apply(n,k||[]),g++,g===y&&e(n)}t.forEach(function(k){r(k,i)})}function asyncSerialArray(t,r,e){var n=0,g=t.length;function y(i){if(i&&i.length){e(i);return}var k=n;n=n+1,k<g?r(t[k],y):e([])}y([])}function flattenObjArr(t){var r=[];return Object.keys(t).forEach(function(e){r.push.apply(r,t[e]||[])}),r}var AsyncValidationError=function(t){_inheritsLoose(r,t);function r(e,n){var g;return g=t.call(this,"Async Validation Error")||this,g.errors=e,g.fields=n,g}return r}(_wrapNativeSuper(Error));function asyncMap(t,r,e,n,g){if(r.first){var y=new Promise(function(re,oe){var le=function(ae){return n(ae),ae.length?oe(new AsyncValidationError(ae,convertFieldsError(ae))):re(g)},ue=flattenObjArr(t);asyncSerialArray(ue,e,le)});return y.catch(function(re){return re}),y}var i=r.firstFields===!0?Object.keys(t):r.firstFields||[],k=Object.keys(t),L=k.length,$=0,V=[],z=new Promise(function(re,oe){var le=function(ie){if(V.push.apply(V,ie),$++,$===L)return n(V),V.length?oe(new AsyncValidationError(V,convertFieldsError(V))):re(g)};k.length||(n(V),re(g)),k.forEach(function(ue){var ie=t[ue];i.indexOf(ue)!==-1?asyncSerialArray(ie,e,le):asyncParallelArray(ie,e,le)})});return z.catch(function(re){return re}),z}function isErrorObj(t){return!!(t&&t.message!==void 0)}function getValue(t,r){for(var e=t,n=0;n<r.length;n++){if(e==null)return e;e=e[r[n]]}return e}function complementError(t,r){return function(e){var n;return t.fullFields?n=getValue(r,t.fullFields):n=r[e.field||t.fullField],isErrorObj(e)?(e.field=e.field||t.fullField,e.fieldValue=n,e):{message:typeof e=="function"?e():e,fieldValue:n,field:e.field||t.fullField}}}function deepMerge(t,r){if(r){for(var e in r)if(r.hasOwnProperty(e)){var n=r[e];typeof n=="object"&&typeof t[e]=="object"?t[e]=_extends({},t[e],n):t[e]=n}}return t}var required$1=function(r,e,n,g,y,i){r.required&&(!n.hasOwnProperty(r.field)||isEmptyValue(e,i||r.type))&&g.push(format(y.messages.required,r.fullField))},whitespace=function(r,e,n,g,y){(/^\s+$/.test(e)||e==="")&&g.push(format(y.messages.whitespace,r.fullField))},urlReg,getUrlRegex=function(){if(urlReg)return urlReg;var t="[a-fA-F\\d:]",r=function(Ce){return Ce&&Ce.includeBoundaries?"(?:(?<=\\s|^)(?="+t+")|(?<="+t+")(?=\\s|$))":""},e="(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)(?:\\.(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)){3}",n="[a-fA-F\\d]{1,4}",g=(`
(?:
(?:`+n+":){7}(?:"+n+`|:)|                                    // 1:2:3:4:5:6:7::  1:2:3:4:5:6:7:8
(?:`+n+":){6}(?:"+e+"|:"+n+`|:)|                             // 1:2:3:4:5:6::    1:2:3:4:5:6::8   1:2:3:4:5:6::8  1:2:3:4:5:6::1.2.3.4
(?:`+n+":){5}(?::"+e+"|(?::"+n+`){1,2}|:)|                   // 1:2:3:4:5::      1:2:3:4:5::7:8   1:2:3:4:5::8    1:2:3:4:5::7:1.2.3.4
(?:`+n+":){4}(?:(?::"+n+"){0,1}:"+e+"|(?::"+n+`){1,3}|:)| // 1:2:3:4::        1:2:3:4::6:7:8   1:2:3:4::8      1:2:3:4::6:7:1.2.3.4
(?:`+n+":){3}(?:(?::"+n+"){0,2}:"+e+"|(?::"+n+`){1,4}|:)| // 1:2:3::          1:2:3::5:6:7:8   1:2:3::8        1:2:3::5:6:7:1.2.3.4
(?:`+n+":){2}(?:(?::"+n+"){0,3}:"+e+"|(?::"+n+`){1,5}|:)| // 1:2::            1:2::4:5:6:7:8   1:2::8          1:2::4:5:6:7:1.2.3.4
(?:`+n+":){1}(?:(?::"+n+"){0,4}:"+e+"|(?::"+n+`){1,6}|:)| // 1::              1::3:4:5:6:7:8   1::8            1::3:4:5:6:7:1.2.3.4
(?::(?:(?::`+n+"){0,5}:"+e+"|(?::"+n+`){1,7}|:))             // ::2:3:4:5:6:7:8  ::2:3:4:5:6:7:8  ::8             ::1.2.3.4
)(?:%[0-9a-zA-Z]{1,})?                                             // %eth0            %1
`).replace(/\s*\/\/.*$/gm,"").replace(/\n/g,"").trim(),y=new RegExp("(?:^"+e+"$)|(?:^"+g+"$)"),i=new RegExp("^"+e+"$"),k=new RegExp("^"+g+"$"),L=function(Ce){return Ce&&Ce.exact?y:new RegExp("(?:"+r(Ce)+e+r(Ce)+")|(?:"+r(Ce)+g+r(Ce)+")","g")};L.v4=function(de){return de&&de.exact?i:new RegExp(""+r(de)+e+r(de),"g")},L.v6=function(de){return de&&de.exact?k:new RegExp(""+r(de)+g+r(de),"g")};var $="(?:(?:[a-z]+:)?//)",V="(?:\\S+(?::\\S*)?@)?",z=L.v4().source,re=L.v6().source,oe="(?:(?:[a-z\\u00a1-\\uffff0-9][-_]*)*[a-z\\u00a1-\\uffff0-9]+)",le="(?:\\.(?:[a-z\\u00a1-\\uffff0-9]-*)*[a-z\\u00a1-\\uffff0-9]+)*",ue="(?:\\.(?:[a-z\\u00a1-\\uffff]{2,}))",ie="(?::\\d{2,5})?",ae='(?:[/?#][^\\s"]*)?',Ie="(?:"+$+"|www\\.)"+V+"(?:localhost|"+z+"|"+re+"|"+oe+le+ue+")"+ie+ae;return urlReg=new RegExp("(?:^"+Ie+"$)","i"),urlReg},pattern$2={email:/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+\.)+[a-zA-Z\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]{2,}))$/,hex:/^#?([a-f0-9]{6}|[a-f0-9]{3})$/i},types={integer:function(r){return types.number(r)&&parseInt(r,10)===r},float:function(r){return types.number(r)&&!types.integer(r)},array:function(r){return Array.isArray(r)},regexp:function(r){if(r instanceof RegExp)return!0;try{return!!new RegExp(r)}catch{return!1}},date:function(r){return typeof r.getTime=="function"&&typeof r.getMonth=="function"&&typeof r.getYear=="function"&&!isNaN(r.getTime())},number:function(r){return isNaN(r)?!1:typeof r=="number"},object:function(r){return typeof r=="object"&&!types.array(r)},method:function(r){return typeof r=="function"},email:function(r){return typeof r=="string"&&r.length<=320&&!!r.match(pattern$2.email)},url:function(r){return typeof r=="string"&&r.length<=2048&&!!r.match(getUrlRegex())},hex:function(r){return typeof r=="string"&&!!r.match(pattern$2.hex)}},type$1=function(r,e,n,g,y){if(r.required&&e===void 0){required$1(r,e,n,g,y);return}var i=["integer","float","array","regexp","object","method","email","number","date","url","hex"],k=r.type;i.indexOf(k)>-1?types[k](e)||g.push(format(y.messages.types[k],r.fullField,r.type)):k&&typeof e!==r.type&&g.push(format(y.messages.types[k],r.fullField,r.type))},range$1=function(r,e,n,g,y){var i=typeof r.len=="number",k=typeof r.min=="number",L=typeof r.max=="number",$=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,V=e,z=null,re=typeof e=="number",oe=typeof e=="string",le=Array.isArray(e);if(re?z="number":oe?z="string":le&&(z="array"),!z)return!1;le&&(V=e.length),oe&&(V=e.replace($,"_").length),i?V!==r.len&&g.push(format(y.messages[z].len,r.fullField,r.len)):k&&!L&&V<r.min?g.push(format(y.messages[z].min,r.fullField,r.min)):L&&!k&&V>r.max?g.push(format(y.messages[z].max,r.fullField,r.max)):k&&L&&(V<r.min||V>r.max)&&g.push(format(y.messages[z].range,r.fullField,r.min,r.max))},ENUM$1="enum",enumerable$1=function(r,e,n,g,y){r[ENUM$1]=Array.isArray(r[ENUM$1])?r[ENUM$1]:[],r[ENUM$1].indexOf(e)===-1&&g.push(format(y.messages[ENUM$1],r.fullField,r[ENUM$1].join(", ")))},pattern$1=function(r,e,n,g,y){if(r.pattern){if(r.pattern instanceof RegExp)r.pattern.lastIndex=0,r.pattern.test(e)||g.push(format(y.messages.pattern.mismatch,r.fullField,e,r.pattern));else if(typeof r.pattern=="string"){var i=new RegExp(r.pattern);i.test(e)||g.push(format(y.messages.pattern.mismatch,r.fullField,e,r.pattern))}}},rules={required:required$1,whitespace,type:type$1,range:range$1,enum:enumerable$1,pattern:pattern$1},string=function(r,e,n,g,y){var i=[],k=r.required||!r.required&&g.hasOwnProperty(r.field);if(k){if(isEmptyValue(e,"string")&&!r.required)return n();rules.required(r,e,g,i,y,"string"),isEmptyValue(e,"string")||(rules.type(r,e,g,i,y),rules.range(r,e,g,i,y),rules.pattern(r,e,g,i,y),r.whitespace===!0&&rules.whitespace(r,e,g,i,y))}n(i)},method=function(r,e,n,g,y){var i=[],k=r.required||!r.required&&g.hasOwnProperty(r.field);if(k){if(isEmptyValue(e)&&!r.required)return n();rules.required(r,e,g,i,y),e!==void 0&&rules.type(r,e,g,i,y)}n(i)},number=function(r,e,n,g,y){var i=[],k=r.required||!r.required&&g.hasOwnProperty(r.field);if(k){if(e===""&&(e=void 0),isEmptyValue(e)&&!r.required)return n();rules.required(r,e,g,i,y),e!==void 0&&(rules.type(r,e,g,i,y),rules.range(r,e,g,i,y))}n(i)},_boolean=function(r,e,n,g,y){var i=[],k=r.required||!r.required&&g.hasOwnProperty(r.field);if(k){if(isEmptyValue(e)&&!r.required)return n();rules.required(r,e,g,i,y),e!==void 0&&rules.type(r,e,g,i,y)}n(i)},regexp=function(r,e,n,g,y){var i=[],k=r.required||!r.required&&g.hasOwnProperty(r.field);if(k){if(isEmptyValue(e)&&!r.required)return n();rules.required(r,e,g,i,y),isEmptyValue(e)||rules.type(r,e,g,i,y)}n(i)},integer=function(r,e,n,g,y){var i=[],k=r.required||!r.required&&g.hasOwnProperty(r.field);if(k){if(isEmptyValue(e)&&!r.required)return n();rules.required(r,e,g,i,y),e!==void 0&&(rules.type(r,e,g,i,y),rules.range(r,e,g,i,y))}n(i)},floatFn=function(r,e,n,g,y){var i=[],k=r.required||!r.required&&g.hasOwnProperty(r.field);if(k){if(isEmptyValue(e)&&!r.required)return n();rules.required(r,e,g,i,y),e!==void 0&&(rules.type(r,e,g,i,y),rules.range(r,e,g,i,y))}n(i)},array=function(r,e,n,g,y){var i=[],k=r.required||!r.required&&g.hasOwnProperty(r.field);if(k){if(e==null&&!r.required)return n();rules.required(r,e,g,i,y,"array"),e!=null&&(rules.type(r,e,g,i,y),rules.range(r,e,g,i,y))}n(i)},object=function(r,e,n,g,y){var i=[],k=r.required||!r.required&&g.hasOwnProperty(r.field);if(k){if(isEmptyValue(e)&&!r.required)return n();rules.required(r,e,g,i,y),e!==void 0&&rules.type(r,e,g,i,y)}n(i)},ENUM="enum",enumerable=function(r,e,n,g,y){var i=[],k=r.required||!r.required&&g.hasOwnProperty(r.field);if(k){if(isEmptyValue(e)&&!r.required)return n();rules.required(r,e,g,i,y),e!==void 0&&rules[ENUM](r,e,g,i,y)}n(i)},pattern=function(r,e,n,g,y){var i=[],k=r.required||!r.required&&g.hasOwnProperty(r.field);if(k){if(isEmptyValue(e,"string")&&!r.required)return n();rules.required(r,e,g,i,y),isEmptyValue(e,"string")||rules.pattern(r,e,g,i,y)}n(i)},date=function(r,e,n,g,y){var i=[],k=r.required||!r.required&&g.hasOwnProperty(r.field);if(k){if(isEmptyValue(e,"date")&&!r.required)return n();if(rules.required(r,e,g,i,y),!isEmptyValue(e,"date")){var L;e instanceof Date?L=e:L=new Date(e),rules.type(r,L,g,i,y),L&&rules.range(r,L.getTime(),g,i,y)}}n(i)},required=function(r,e,n,g,y){var i=[],k=Array.isArray(e)?"array":typeof e;rules.required(r,e,g,i,y,k),n(i)},type=function(r,e,n,g,y){var i=r.type,k=[],L=r.required||!r.required&&g.hasOwnProperty(r.field);if(L){if(isEmptyValue(e,i)&&!r.required)return n();rules.required(r,e,g,k,y,i),isEmptyValue(e,i)||rules.type(r,e,g,k,y)}n(k)},any=function(r,e,n,g,y){var i=[],k=r.required||!r.required&&g.hasOwnProperty(r.field);if(k){if(isEmptyValue(e)&&!r.required)return n();rules.required(r,e,g,i,y)}n(i)},validators$2={string,method,number,boolean:_boolean,regexp,integer,float:floatFn,array,object,enum:enumerable,pattern,date,url:type,hex:type,email:type,required,any};function newMessages(){return{default:"Validation error on field %s",required:"%s is required",enum:"%s must be one of %s",whitespace:"%s cannot be empty",date:{format:"%s date %s is invalid for format %s",parse:"%s date could not be parsed, %s is invalid ",invalid:"%s date %s is invalid"},types:{string:"%s is not a %s",method:"%s is not a %s (function)",array:"%s is not an %s",object:"%s is not an %s",number:"%s is not a %s",date:"%s is not a %s",boolean:"%s is not a %s",integer:"%s is not an %s",float:"%s is not a %s",regexp:"%s is not a valid %s",email:"%s is not a valid %s",url:"%s is not a valid %s",hex:"%s is not a valid %s"},string:{len:"%s must be exactly %s characters",min:"%s must be at least %s characters",max:"%s cannot be longer than %s characters",range:"%s must be between %s and %s characters"},number:{len:"%s must equal %s",min:"%s cannot be less than %s",max:"%s cannot be greater than %s",range:"%s must be between %s and %s"},array:{len:"%s must be exactly %s in length",min:"%s cannot be less than %s in length",max:"%s cannot be greater than %s in length",range:"%s must be between %s and %s in length"},pattern:{mismatch:"%s value %s does not match pattern %s"},clone:function(){var r=JSON.parse(JSON.stringify(this));return r.clone=this.clone,r}}}var messages=newMessages(),Schema=function(){function t(e){this.rules=null,this._messages=messages,this.define(e)}var r=t.prototype;return r.define=function(n){var g=this;if(!n)throw new Error("Cannot configure a schema with no rules");if(typeof n!="object"||Array.isArray(n))throw new Error("Rules must be an object");this.rules={},Object.keys(n).forEach(function(y){var i=n[y];g.rules[y]=Array.isArray(i)?i:[i]})},r.messages=function(n){return n&&(this._messages=deepMerge(newMessages(),n)),this._messages},r.validate=function(n,g,y){var i=this;g===void 0&&(g={}),y===void 0&&(y=function(){});var k=n,L=g,$=y;if(typeof L=="function"&&($=L,L={}),!this.rules||Object.keys(this.rules).length===0)return $&&$(null,k),Promise.resolve(k);function V(ue){var ie=[],ae={};function Ie(Ce){if(Array.isArray(Ce)){var Ue;ie=(Ue=ie).concat.apply(Ue,Ce)}else ie.push(Ce)}for(var de=0;de<ue.length;de++)Ie(ue[de]);ie.length?(ae=convertFieldsError(ie),$(ie,ae)):$(null,k)}if(L.messages){var z=this.messages();z===messages&&(z=newMessages()),deepMerge(z,L.messages),L.messages=z}else L.messages=this.messages();var re={},oe=L.keys||Object.keys(this.rules);oe.forEach(function(ue){var ie=i.rules[ue],ae=k[ue];ie.forEach(function(Ie){var de=Ie;typeof de.transform=="function"&&(k===n&&(k=_extends({},k)),ae=k[ue]=de.transform(ae)),typeof de=="function"?de={validator:de}:de=_extends({},de),de.validator=i.getValidationMethod(de),de.validator&&(de.field=ue,de.fullField=de.fullField||ue,de.type=i.getType(de),re[ue]=re[ue]||[],re[ue].push({rule:de,value:ae,source:k,field:ue}))})});var le={};return asyncMap(re,L,function(ue,ie){var ae=ue.rule,Ie=(ae.type==="object"||ae.type==="array")&&(typeof ae.fields=="object"||typeof ae.defaultField=="object");Ie=Ie&&(ae.required||!ae.required&&ue.value),ae.field=ue.field;function de(qe,jt){return _extends({},jt,{fullField:ae.fullField+"."+qe,fullFields:ae.fullFields?[].concat(ae.fullFields,[qe]):[qe]})}function Ce(qe){qe===void 0&&(qe=[]);var jt=Array.isArray(qe)?qe:[qe];!L.suppressWarning&&jt.length&&t.warning("async-validator:",jt),jt.length&&ae.message!==void 0&&(jt=[].concat(ae.message));var Fe=jt.map(complementError(ae,k));if(L.first&&Fe.length)return le[ae.field]=1,ie(Fe);if(!Ie)ie(Fe);else{if(ae.required&&!ue.value)return ae.message!==void 0?Fe=[].concat(ae.message).map(complementError(ae,k)):L.error&&(Fe=[L.error(ae,format(L.messages.required,ae.field))]),ie(Fe);var Et={};ae.defaultField&&Object.keys(ue.value).map(function(nr){Et[nr]=ae.defaultField}),Et=_extends({},Et,ue.rule.fields);var cr={};Object.keys(Et).forEach(function(nr){var dr=Et[nr],ir=Array.isArray(dr)?dr:[dr];cr[nr]=ir.map(de.bind(null,nr))});var er=new t(cr);er.messages(L.messages),ue.rule.options&&(ue.rule.options.messages=L.messages,ue.rule.options.error=L.error),er.validate(ue.value,ue.rule.options||L,function(nr){var dr=[];Fe&&Fe.length&&dr.push.apply(dr,Fe),nr&&nr.length&&dr.push.apply(dr,nr),ie(dr.length?dr:null)})}}var Ue;if(ae.asyncValidator)Ue=ae.asyncValidator(ae,ue.value,Ce,ue.source,L);else if(ae.validator){try{Ue=ae.validator(ae,ue.value,Ce,ue.source,L)}catch(qe){console.error==null||console.error(qe),L.suppressValidatorError||setTimeout(function(){throw qe},0),Ce(qe.message)}Ue===!0?Ce():Ue===!1?Ce(typeof ae.message=="function"?ae.message(ae.fullField||ae.field):ae.message||(ae.fullField||ae.field)+" fails"):Ue instanceof Array?Ce(Ue):Ue instanceof Error&&Ce(Ue.message)}Ue&&Ue.then&&Ue.then(function(){return Ce()},function(qe){return Ce(qe)})},function(ue){V(ue)},k)},r.getType=function(n){if(n.type===void 0&&n.pattern instanceof RegExp&&(n.type="pattern"),typeof n.validator!="function"&&n.type&&!validators$2.hasOwnProperty(n.type))throw new Error(format("Unknown rule type %s",n.type));return n.type||"string"},r.getValidationMethod=function(n){if(typeof n.validator=="function")return n.validator;var g=Object.keys(n),y=g.indexOf("message");return y!==-1&&g.splice(y,1),g.length===1&&g[0]==="required"?validators$2.required:validators$2[this.getType(n)]||void 0},t}();Schema.register=function(r,e){if(typeof e!="function")throw new Error("Cannot register a validator by type, validator is not a function");validators$2[r]=e};Schema.warning=warning;Schema.messages=messages;Schema.validators=validators$2;const formItemValidateStates=["","error","validating","success"],formItemProps=buildProps({label:String,labelWidth:{type:[String,Number],default:""},prop:{type:definePropType([String,Array])},required:{type:Boolean,default:void 0},rules:{type:definePropType([Object,Array])},error:String,validateStatus:{type:String,values:formItemValidateStates},for:String,inlineMessage:{type:[String,Boolean],default:""},showMessage:{type:Boolean,default:!0},size:{type:String,values:componentSizes}}),COMPONENT_NAME$9="ElLabelWrap";var FormLabelWrap=defineComponent({name:COMPONENT_NAME$9,props:{isAutoWidth:Boolean,updateAll:Boolean},setup(t,{slots:r}){const e=inject(formContextKey,void 0),n=inject(formItemContextKey);n||throwError(COMPONENT_NAME$9,"usage: <el-form-item><label-wrap /></el-form-item>");const g=useNamespace("form"),y=ref(),i=ref(0),k=()=>{var V;if((V=y.value)!=null&&V.firstElementChild){const z=window.getComputedStyle(y.value.firstElementChild).width;return Math.ceil(Number.parseFloat(z))}else return 0},L=(V="update")=>{nextTick(()=>{r.default&&t.isAutoWidth&&(V==="update"?i.value=k():V==="remove"&&(e==null||e.deregisterLabelWidth(i.value)))})},$=()=>L("update");return onMounted(()=>{$()}),onBeforeUnmount(()=>{L("remove")}),onUpdated(()=>$()),watch(i,(V,z)=>{t.updateAll&&(e==null||e.registerLabelWidth(V,z))}),useResizeObserver(computed(()=>{var V,z;return(z=(V=y.value)==null?void 0:V.firstElementChild)!=null?z:null}),$),()=>{var V,z;if(!r)return null;const{isAutoWidth:re}=t;if(re){const oe=e==null?void 0:e.autoLabelWidth,le=n==null?void 0:n.hasLabel,ue={};if(le&&oe&&oe!=="auto"){const ie=Math.max(0,Number.parseInt(oe,10)-i.value),ae=e.labelPosition==="left"?"marginRight":"marginLeft";ie&&(ue[ae]=`${ie}px`)}return createVNode("div",{ref:y,class:[g.be("item","label-wrap")],style:ue},[(V=r.default)==null?void 0:V.call(r)])}else return createVNode(Fragment,{ref:y},[(z=r.default)==null?void 0:z.call(r)])}}});const _hoisted_1$G=["role","aria-labelledby"],__default__$N=defineComponent({name:"ElFormItem"}),_sfc_main$1g=defineComponent({...__default__$N,props:formItemProps,setup(t,{expose:r}){const e=t,n=useSlots(),g=inject(formContextKey,void 0),y=inject(formItemContextKey,void 0),i=useFormSize(void 0,{formItem:!1}),k=useNamespace("form-item"),L=useId().value,$=ref([]),V=ref(""),z=refDebounced(V,100),re=ref(""),oe=ref();let le,ue=!1;const ie=computed(()=>{if((g==null?void 0:g.labelPosition)==="top")return{};const Er=addUnit(e.labelWidth||(g==null?void 0:g.labelWidth)||"");return Er?{width:Er}:{}}),ae=computed(()=>{if((g==null?void 0:g.labelPosition)==="top"||g!=null&&g.inline)return{};if(!e.label&&!e.labelWidth&&Et)return{};const Er=addUnit(e.labelWidth||(g==null?void 0:g.labelWidth)||"");return!e.label&&!n.label?{marginLeft:Er}:{}}),Ie=computed(()=>[k.b(),k.m(i.value),k.is("error",V.value==="error"),k.is("validating",V.value==="validating"),k.is("success",V.value==="success"),k.is("required",ir.value||e.required),k.is("no-asterisk",g==null?void 0:g.hideRequiredAsterisk),(g==null?void 0:g.requireAsteriskPosition)==="right"?"asterisk-right":"asterisk-left",{[k.m("feedback")]:g==null?void 0:g.statusIcon}]),de=computed(()=>isBoolean$1(e.inlineMessage)?e.inlineMessage:(g==null?void 0:g.inlineMessage)||!1),Ce=computed(()=>[k.e("error"),{[k.em("error","inline")]:de.value}]),Ue=computed(()=>e.prop?isString$2(e.prop)?e.prop:e.prop.join("."):""),qe=computed(()=>!!(e.label||n.label)),jt=computed(()=>e.for||($.value.length===1?$.value[0]:void 0)),Fe=computed(()=>!jt.value&&qe.value),Et=!!y,cr=computed(()=>{const Er=g==null?void 0:g.model;if(!(!Er||!e.prop))return getProp(Er,e.prop).value}),er=computed(()=>{const{required:Er}=e,sr=[];e.rules&&sr.push(...castArray$1(e.rules));const xr=g==null?void 0:g.rules;if(xr&&e.prop){const Or=getProp(xr,e.prop).value;Or&&sr.push(...castArray$1(Or))}if(Er!==void 0){const Or=sr.map((Mr,br)=>[Mr,br]).filter(([Mr])=>Object.keys(Mr).includes("required"));if(Or.length>0)for(const[Mr,br]of Or)Mr.required!==Er&&(sr[br]={...Mr,required:Er});else sr.push({required:Er})}return sr}),nr=computed(()=>er.value.length>0),dr=Er=>er.value.filter(xr=>!xr.trigger||!Er?!0:Array.isArray(xr.trigger)?xr.trigger.includes(Er):xr.trigger===Er).map(({trigger:xr,...Or})=>Or),ir=computed(()=>er.value.some(Er=>Er.required)),tr=computed(()=>{var Er;return z.value==="error"&&e.showMessage&&((Er=g==null?void 0:g.showMessage)!=null?Er:!0)}),ur=computed(()=>`${e.label||""}${(g==null?void 0:g.labelSuffix)||""}`),or=Er=>{V.value=Er},fr=Er=>{var sr,xr;const{errors:Or,fields:Mr}=Er;(!Or||!Mr)&&console.error(Er),or("error"),re.value=Or?(xr=(sr=Or==null?void 0:Or[0])==null?void 0:sr.message)!=null?xr:`${e.prop} is required`:"",g==null||g.emit("validate",e.prop,!1,re.value)},lr=()=>{or("success"),g==null||g.emit("validate",e.prop,!0,"")},gr=async Er=>{const sr=Ue.value;return new Schema({[sr]:Er}).validate({[sr]:cr.value},{firstFields:!0}).then(()=>(lr(),!0)).catch(Or=>(fr(Or),Promise.reject(Or)))},Sr=async(Er,sr)=>{if(ue||!e.prop)return!1;const xr=isFunction$3(sr);if(!nr.value)return sr==null||sr(!1),!1;const Or=dr(Er);return Or.length===0?(sr==null||sr(!0),!0):(or("validating"),gr(Or).then(()=>(sr==null||sr(!0),!0)).catch(Mr=>{const{fields:br}=Mr;return sr==null||sr(!1,br),xr?!1:Promise.reject(br)}))},wr=()=>{or(""),re.value="",ue=!1},kr=async()=>{const Er=g==null?void 0:g.model;if(!Er||!e.prop)return;const sr=getProp(Er,e.prop);ue=!0,sr.value=clone(le),await nextTick(),wr(),ue=!1},mr=Er=>{$.value.includes(Er)||$.value.push(Er)},Ir=Er=>{$.value=$.value.filter(sr=>sr!==Er)};watch(()=>e.error,Er=>{re.value=Er||"",or(Er?"error":"")},{immediate:!0}),watch(()=>e.validateStatus,Er=>or(Er||""));const Nr=reactive({...toRefs(e),$el:oe,size:i,validateState:V,labelId:L,inputIds:$,isGroup:Fe,hasLabel:qe,fieldValue:cr,addInputId:mr,removeInputId:Ir,resetField:kr,clearValidate:wr,validate:Sr});return provide(formItemContextKey,Nr),onMounted(()=>{e.prop&&(g==null||g.addField(Nr),le=clone(cr.value))}),onBeforeUnmount(()=>{g==null||g.removeField(Nr)}),r({size:i,validateMessage:re,validateState:V,validate:Sr,clearValidate:wr,resetField:kr}),(Er,sr)=>{var xr;return openBlock(),createElementBlock("div",{ref_key:"formItemRef",ref:oe,class:normalizeClass(unref(Ie)),role:unref(Fe)?"group":void 0,"aria-labelledby":unref(Fe)?unref(L):void 0},[createVNode(unref(FormLabelWrap),{"is-auto-width":unref(ie).width==="auto","update-all":((xr=unref(g))==null?void 0:xr.labelWidth)==="auto"},{default:withCtx(()=>[unref(qe)?(openBlock(),createBlock(resolveDynamicComponent(unref(jt)?"label":"div"),{key:0,id:unref(L),for:unref(jt),class:normalizeClass(unref(k).e("label")),style:normalizeStyle(unref(ie))},{default:withCtx(()=>[renderSlot(Er.$slots,"label",{label:unref(ur)},()=>[createTextVNode(toDisplayString(unref(ur)),1)])]),_:3},8,["id","for","class","style"])):createCommentVNode("v-if",!0)]),_:3},8,["is-auto-width","update-all"]),createBaseVNode("div",{class:normalizeClass(unref(k).e("content")),style:normalizeStyle(unref(ae))},[renderSlot(Er.$slots,"default"),createVNode(TransitionGroup,{name:`${unref(k).namespace.value}-zoom-in-top`},{default:withCtx(()=>[unref(tr)?renderSlot(Er.$slots,"error",{key:0,error:re.value},()=>[createBaseVNode("div",{class:normalizeClass(unref(Ce))},toDisplayString(re.value),3)]):createCommentVNode("v-if",!0)]),_:3},8,["name"])],6)],10,_hoisted_1$G)}}});var FormItem=_export_sfc$1(_sfc_main$1g,[["__file","form-item.vue"]]);const ElForm=withInstall(Form,{FormItem}),ElFormItem=withNoopInstall(FormItem);let hiddenTextarea;const HIDDEN_STYLE=`
  height:0 !important;
  visibility:hidden !important;
  ${isFirefox()?"":"overflow:hidden !important;"}
  position:absolute !important;
  z-index:-1000 !important;
  top:0 !important;
  right:0 !important;
`,CONTEXT_STYLE=["letter-spacing","line-height","padding-top","padding-bottom","font-family","font-weight","font-size","text-rendering","text-transform","width","text-indent","padding-left","padding-right","border-width","box-sizing"];function calculateNodeStyling(t){const r=window.getComputedStyle(t),e=r.getPropertyValue("box-sizing"),n=Number.parseFloat(r.getPropertyValue("padding-bottom"))+Number.parseFloat(r.getPropertyValue("padding-top")),g=Number.parseFloat(r.getPropertyValue("border-bottom-width"))+Number.parseFloat(r.getPropertyValue("border-top-width"));return{contextStyle:CONTEXT_STYLE.map(i=>`${i}:${r.getPropertyValue(i)}`).join(";"),paddingSize:n,borderSize:g,boxSizing:e}}function calcTextareaHeight(t,r=1,e){var n;hiddenTextarea||(hiddenTextarea=document.createElement("textarea"),document.body.appendChild(hiddenTextarea));const{paddingSize:g,borderSize:y,boxSizing:i,contextStyle:k}=calculateNodeStyling(t);hiddenTextarea.setAttribute("style",`${k};${HIDDEN_STYLE}`),hiddenTextarea.value=t.value||t.placeholder||"";let L=hiddenTextarea.scrollHeight;const $={};i==="border-box"?L=L+y:i==="content-box"&&(L=L-g),hiddenTextarea.value="";const V=hiddenTextarea.scrollHeight-g;if(isNumber$1(r)){let z=V*r;i==="border-box"&&(z=z+g+y),L=Math.max(z,L),$.minHeight=`${z}px`}if(isNumber$1(e)){let z=V*e;i==="border-box"&&(z=z+g+y),L=Math.min(z,L)}return $.height=`${L}px`,(n=hiddenTextarea.parentNode)==null||n.removeChild(hiddenTextarea),hiddenTextarea=void 0,$}const inputProps=buildProps({id:{type:String,default:void 0},size:useSizeProp,disabled:Boolean,modelValue:{type:definePropType([String,Number,Object]),default:""},maxlength:{type:[String,Number]},minlength:{type:[String,Number]},type:{type:String,default:"text"},resize:{type:String,values:["none","both","horizontal","vertical"]},autosize:{type:definePropType([Boolean,Object]),default:!1},autocomplete:{type:String,default:"off"},formatter:{type:Function},parser:{type:Function},placeholder:{type:String},form:{type:String},readonly:{type:Boolean,default:!1},clearable:{type:Boolean,default:!1},showPassword:{type:Boolean,default:!1},showWordLimit:{type:Boolean,default:!1},suffixIcon:{type:iconPropType},prefixIcon:{type:iconPropType},containerRole:{type:String,default:void 0},label:{type:String,default:void 0},tabindex:{type:[String,Number],default:0},validateEvent:{type:Boolean,default:!0},inputStyle:{type:definePropType([Object,Array,String]),default:()=>mutable({})},autofocus:{type:Boolean,default:!1}}),inputEmits={[UPDATE_MODEL_EVENT]:t=>isString$2(t),input:t=>isString$2(t),change:t=>isString$2(t),focus:t=>t instanceof FocusEvent,blur:t=>t instanceof FocusEvent,clear:()=>!0,mouseleave:t=>t instanceof MouseEvent,mouseenter:t=>t instanceof MouseEvent,keydown:t=>t instanceof Event,compositionstart:t=>t instanceof CompositionEvent,compositionupdate:t=>t instanceof CompositionEvent,compositionend:t=>t instanceof CompositionEvent},_hoisted_1$F=["role"],_hoisted_2$p=["id","minlength","maxlength","type","disabled","readonly","autocomplete","tabindex","aria-label","placeholder","form","autofocus"],_hoisted_3$d=["id","minlength","maxlength","tabindex","disabled","readonly","autocomplete","aria-label","placeholder","form","autofocus"],__default__$M=defineComponent({name:"ElInput",inheritAttrs:!1}),_sfc_main$1f=defineComponent({...__default__$M,props:inputProps,emits:inputEmits,setup(t,{expose:r,emit:e}){const n=t,g=useAttrs$1(),y=useSlots(),i=computed(()=>{const Zr={};return n.containerRole==="combobox"&&(Zr["aria-haspopup"]=g["aria-haspopup"],Zr["aria-owns"]=g["aria-owns"],Zr["aria-expanded"]=g["aria-expanded"]),Zr}),k=computed(()=>[n.type==="textarea"?ie.b():ue.b(),ue.m(oe.value),ue.is("disabled",le.value),ue.is("exceed",mr.value),{[ue.b("group")]:y.prepend||y.append,[ue.bm("group","append")]:y.append,[ue.bm("group","prepend")]:y.prepend,[ue.m("prefix")]:y.prefix||n.prefixIcon,[ue.m("suffix")]:y.suffix||n.suffixIcon||n.clearable||n.showPassword,[ue.bm("suffix","password-clear")]:gr.value&&Sr.value},g.class]),L=computed(()=>[ue.e("wrapper"),ue.is("focus",cr.value)]),$=useAttrs({excludeKeys:computed(()=>Object.keys(i.value))}),{form:V,formItem:z}=useFormItem(),{inputId:re}=useFormItemInputId(n,{formItemContext:z}),oe=useFormSize(),le=useFormDisabled(),ue=useNamespace("input"),ie=useNamespace("textarea"),ae=shallowRef(),Ie=shallowRef(),de=ref(!1),Ce=ref(!1),Ue=ref(!1),qe=ref(),jt=shallowRef(n.inputStyle),Fe=computed(()=>ae.value||Ie.value),{wrapperRef:Et,isFocused:cr,handleFocus:er,handleBlur:nr}=useFocusController(Fe,{afterBlur(){var Zr;n.validateEvent&&((Zr=z==null?void 0:z.validate)==null||Zr.call(z,"blur").catch(An=>void 0))}}),dr=computed(()=>{var Zr;return(Zr=V==null?void 0:V.statusIcon)!=null?Zr:!1}),ir=computed(()=>(z==null?void 0:z.validateState)||""),tr=computed(()=>ir.value&&ValidateComponentsMap[ir.value]),ur=computed(()=>Ue.value?view_default:hide_default),or=computed(()=>[g.style]),fr=computed(()=>[n.inputStyle,jt.value,{resize:n.resize}]),lr=computed(()=>isNil(n.modelValue)?"":String(n.modelValue)),gr=computed(()=>n.clearable&&!le.value&&!n.readonly&&!!lr.value&&(cr.value||de.value)),Sr=computed(()=>n.showPassword&&!le.value&&!n.readonly&&!!lr.value&&(!!lr.value||cr.value)),wr=computed(()=>n.showWordLimit&&!!n.maxlength&&(n.type==="text"||n.type==="textarea")&&!le.value&&!n.readonly&&!n.showPassword),kr=computed(()=>lr.value.length),mr=computed(()=>!!wr.value&&kr.value>Number(n.maxlength)),Ir=computed(()=>!!y.suffix||!!n.suffixIcon||gr.value||n.showPassword||wr.value||!!ir.value&&dr.value),[Nr,Er]=useCursor(ae);useResizeObserver(Ie,Zr=>{if(Or(),!wr.value||n.resize!=="both")return;const An=Zr[0],{width:Jr}=An.contentRect;qe.value={right:`calc(100% - ${Jr+15+6}px)`}});const sr=()=>{const{type:Zr,autosize:An}=n;if(!(!isClient||Zr!=="textarea"||!Ie.value))if(An){const Jr=isObject$2(An)?An.minRows:void 0,Mn=isObject$2(An)?An.maxRows:void 0,Bn=calcTextareaHeight(Ie.value,Jr,Mn);jt.value={overflowY:"hidden",...Bn},nextTick(()=>{Ie.value.offsetHeight,jt.value=Bn})}else jt.value={minHeight:calcTextareaHeight(Ie.value).minHeight}},Or=(Zr=>{let An=!1;return()=>{var Jr;if(An||!n.autosize)return;((Jr=Ie.value)==null?void 0:Jr.offsetParent)===null||(Zr(),An=!0)}})(sr),Mr=()=>{const Zr=Fe.value,An=n.formatter?n.formatter(lr.value):lr.value;!Zr||Zr.value===An||(Zr.value=An)},br=async Zr=>{Nr();let{value:An}=Zr.target;if(n.formatter&&(An=n.parser?n.parser(An):An),!Ce.value){if(An===lr.value){Mr();return}e(UPDATE_MODEL_EVENT,An),e("input",An),await nextTick(),Mr(),Er()}},hr=Zr=>{e("change",Zr.target.value)},Tr=Zr=>{e("compositionstart",Zr),Ce.value=!0},Br=Zr=>{var An;e("compositionupdate",Zr);const Jr=(An=Zr.target)==null?void 0:An.value,Mn=Jr[Jr.length-1]||"";Ce.value=!isKorean(Mn)},Fr=Zr=>{e("compositionend",Zr),Ce.value&&(Ce.value=!1,br(Zr))},Lr=()=>{Ue.value=!Ue.value,qr()},qr=async()=>{var Zr;await nextTick(),(Zr=Fe.value)==null||Zr.focus()},Ur=()=>{var Zr;return(Zr=Fe.value)==null?void 0:Zr.blur()},Qr=Zr=>{de.value=!1,e("mouseleave",Zr)},vn=Zr=>{de.value=!0,e("mouseenter",Zr)},_n=Zr=>{e("keydown",Zr)},Yr=()=>{var Zr;(Zr=Fe.value)==null||Zr.select()},jn=()=>{e(UPDATE_MODEL_EVENT,""),e("change",""),e("clear"),e("input","")};return watch(()=>n.modelValue,()=>{var Zr;nextTick(()=>sr()),n.validateEvent&&((Zr=z==null?void 0:z.validate)==null||Zr.call(z,"change").catch(An=>void 0))}),watch(lr,()=>Mr()),watch(()=>n.type,async()=>{await nextTick(),Mr(),sr()}),onMounted(()=>{!n.formatter&&n.parser,Mr(),nextTick(sr)}),r({input:ae,textarea:Ie,ref:Fe,textareaStyle:fr,autosize:toRef(n,"autosize"),focus:qr,blur:Ur,select:Yr,clear:jn,resizeTextarea:sr}),(Zr,An)=>withDirectives((openBlock(),createElementBlock("div",mergeProps(unref(i),{class:unref(k),style:unref(or),role:Zr.containerRole,onMouseenter:vn,onMouseleave:Qr}),[createCommentVNode(" input "),Zr.type!=="textarea"?(openBlock(),createElementBlock(Fragment,{key:0},[createCommentVNode(" prepend slot "),Zr.$slots.prepend?(openBlock(),createElementBlock("div",{key:0,class:normalizeClass(unref(ue).be("group","prepend"))},[renderSlot(Zr.$slots,"prepend")],2)):createCommentVNode("v-if",!0),createBaseVNode("div",{ref_key:"wrapperRef",ref:Et,class:normalizeClass(unref(L))},[createCommentVNode(" prefix slot "),Zr.$slots.prefix||Zr.prefixIcon?(openBlock(),createElementBlock("span",{key:0,class:normalizeClass(unref(ue).e("prefix"))},[createBaseVNode("span",{class:normalizeClass(unref(ue).e("prefix-inner"))},[renderSlot(Zr.$slots,"prefix"),Zr.prefixIcon?(openBlock(),createBlock(unref(ElIcon),{key:0,class:normalizeClass(unref(ue).e("icon"))},{default:withCtx(()=>[(openBlock(),createBlock(resolveDynamicComponent(Zr.prefixIcon)))]),_:1},8,["class"])):createCommentVNode("v-if",!0)],2)],2)):createCommentVNode("v-if",!0),createBaseVNode("input",mergeProps({id:unref(re),ref_key:"input",ref:ae,class:unref(ue).e("inner")},unref($),{minlength:Zr.minlength,maxlength:Zr.maxlength,type:Zr.showPassword?Ue.value?"text":"password":Zr.type,disabled:unref(le),readonly:Zr.readonly,autocomplete:Zr.autocomplete,tabindex:Zr.tabindex,"aria-label":Zr.label,placeholder:Zr.placeholder,style:Zr.inputStyle,form:Zr.form,autofocus:Zr.autofocus,onCompositionstart:Tr,onCompositionupdate:Br,onCompositionend:Fr,onInput:br,onFocus:An[0]||(An[0]=(...Jr)=>unref(er)&&unref(er)(...Jr)),onBlur:An[1]||(An[1]=(...Jr)=>unref(nr)&&unref(nr)(...Jr)),onChange:hr,onKeydown:_n}),null,16,_hoisted_2$p),createCommentVNode(" suffix slot "),unref(Ir)?(openBlock(),createElementBlock("span",{key:1,class:normalizeClass(unref(ue).e("suffix"))},[createBaseVNode("span",{class:normalizeClass(unref(ue).e("suffix-inner"))},[!unref(gr)||!unref(Sr)||!unref(wr)?(openBlock(),createElementBlock(Fragment,{key:0},[renderSlot(Zr.$slots,"suffix"),Zr.suffixIcon?(openBlock(),createBlock(unref(ElIcon),{key:0,class:normalizeClass(unref(ue).e("icon"))},{default:withCtx(()=>[(openBlock(),createBlock(resolveDynamicComponent(Zr.suffixIcon)))]),_:1},8,["class"])):createCommentVNode("v-if",!0)],64)):createCommentVNode("v-if",!0),unref(gr)?(openBlock(),createBlock(unref(ElIcon),{key:1,class:normalizeClass([unref(ue).e("icon"),unref(ue).e("clear")]),onMousedown:withModifiers(unref(NOOP),["prevent"]),onClick:jn},{default:withCtx(()=>[createVNode(unref(circle_close_default))]),_:1},8,["class","onMousedown"])):createCommentVNode("v-if",!0),unref(Sr)?(openBlock(),createBlock(unref(ElIcon),{key:2,class:normalizeClass([unref(ue).e("icon"),unref(ue).e("password")]),onClick:Lr},{default:withCtx(()=>[(openBlock(),createBlock(resolveDynamicComponent(unref(ur))))]),_:1},8,["class"])):createCommentVNode("v-if",!0),unref(wr)?(openBlock(),createElementBlock("span",{key:3,class:normalizeClass(unref(ue).e("count"))},[createBaseVNode("span",{class:normalizeClass(unref(ue).e("count-inner"))},toDisplayString(unref(kr))+" / "+toDisplayString(Zr.maxlength),3)],2)):createCommentVNode("v-if",!0),unref(ir)&&unref(tr)&&unref(dr)?(openBlock(),createBlock(unref(ElIcon),{key:4,class:normalizeClass([unref(ue).e("icon"),unref(ue).e("validateIcon"),unref(ue).is("loading",unref(ir)==="validating")])},{default:withCtx(()=>[(openBlock(),createBlock(resolveDynamicComponent(unref(tr))))]),_:1},8,["class"])):createCommentVNode("v-if",!0)],2)],2)):createCommentVNode("v-if",!0)],2),createCommentVNode(" append slot "),Zr.$slots.append?(openBlock(),createElementBlock("div",{key:1,class:normalizeClass(unref(ue).be("group","append"))},[renderSlot(Zr.$slots,"append")],2)):createCommentVNode("v-if",!0)],64)):(openBlock(),createElementBlock(Fragment,{key:1},[createCommentVNode(" textarea "),createBaseVNode("textarea",mergeProps({id:unref(re),ref_key:"textarea",ref:Ie,class:unref(ie).e("inner")},unref($),{minlength:Zr.minlength,maxlength:Zr.maxlength,tabindex:Zr.tabindex,disabled:unref(le),readonly:Zr.readonly,autocomplete:Zr.autocomplete,style:unref(fr),"aria-label":Zr.label,placeholder:Zr.placeholder,form:Zr.form,autofocus:Zr.autofocus,onCompositionstart:Tr,onCompositionupdate:Br,onCompositionend:Fr,onInput:br,onFocus:An[2]||(An[2]=(...Jr)=>unref(er)&&unref(er)(...Jr)),onBlur:An[3]||(An[3]=(...Jr)=>unref(nr)&&unref(nr)(...Jr)),onChange:hr,onKeydown:_n}),null,16,_hoisted_3$d),unref(wr)?(openBlock(),createElementBlock("span",{key:0,style:normalizeStyle(qe.value),class:normalizeClass(unref(ue).e("count"))},toDisplayString(unref(kr))+" / "+toDisplayString(Zr.maxlength),7)):createCommentVNode("v-if",!0)],64))],16,_hoisted_1$F)),[[vShow,Zr.type!=="hidden"]])}});var Input=_export_sfc$1(_sfc_main$1f,[["__file","input.vue"]]);const ElInput=withInstall(Input),GAP=4,BAR_MAP={vertical:{offset:"offsetHeight",scroll:"scrollTop",scrollSize:"scrollHeight",size:"height",key:"vertical",axis:"Y",client:"clientY",direction:"top"},horizontal:{offset:"offsetWidth",scroll:"scrollLeft",scrollSize:"scrollWidth",size:"width",key:"horizontal",axis:"X",client:"clientX",direction:"left"}},renderThumbStyle=({move:t,size:r,bar:e})=>({[e.size]:r,transform:`translate${e.axis}(${t}%)`}),scrollbarContextKey=Symbol("scrollbarContextKey"),thumbProps=buildProps({vertical:Boolean,size:String,move:Number,ratio:{type:Number,required:!0},always:Boolean}),COMPONENT_NAME$8="Thumb",_sfc_main$1e=defineComponent({__name:"thumb",props:thumbProps,setup(t){const r=t,e=inject(scrollbarContextKey),n=useNamespace("scrollbar");e||throwError(COMPONENT_NAME$8,"can not inject scrollbar context");const g=ref(),y=ref(),i=ref({}),k=ref(!1);let L=!1,$=!1,V=isClient?document.onselectstart:null;const z=computed(()=>BAR_MAP[r.vertical?"vertical":"horizontal"]),re=computed(()=>renderThumbStyle({size:r.size,move:r.move,bar:z.value})),oe=computed(()=>g.value[z.value.offset]**2/e.wrapElement[z.value.scrollSize]/r.ratio/y.value[z.value.offset]),le=qe=>{var jt;if(qe.stopPropagation(),qe.ctrlKey||[1,2].includes(qe.button))return;(jt=window.getSelection())==null||jt.removeAllRanges(),ie(qe);const Fe=qe.currentTarget;Fe&&(i.value[z.value.axis]=Fe[z.value.offset]-(qe[z.value.client]-Fe.getBoundingClientRect()[z.value.direction]))},ue=qe=>{if(!y.value||!g.value||!e.wrapElement)return;const jt=Math.abs(qe.target.getBoundingClientRect()[z.value.direction]-qe[z.value.client]),Fe=y.value[z.value.offset]/2,Et=(jt-Fe)*100*oe.value/g.value[z.value.offset];e.wrapElement[z.value.scroll]=Et*e.wrapElement[z.value.scrollSize]/100},ie=qe=>{qe.stopImmediatePropagation(),L=!0,document.addEventListener("mousemove",ae),document.addEventListener("mouseup",Ie),V=document.onselectstart,document.onselectstart=()=>!1},ae=qe=>{if(!g.value||!y.value||L===!1)return;const jt=i.value[z.value.axis];if(!jt)return;const Fe=(g.value.getBoundingClientRect()[z.value.direction]-qe[z.value.client])*-1,Et=y.value[z.value.offset]-jt,cr=(Fe-Et)*100*oe.value/g.value[z.value.offset];e.wrapElement[z.value.scroll]=cr*e.wrapElement[z.value.scrollSize]/100},Ie=()=>{L=!1,i.value[z.value.axis]=0,document.removeEventListener("mousemove",ae),document.removeEventListener("mouseup",Ie),Ue(),$&&(k.value=!1)},de=()=>{$=!1,k.value=!!r.size},Ce=()=>{$=!0,k.value=L};onBeforeUnmount(()=>{Ue(),document.removeEventListener("mouseup",Ie)});const Ue=()=>{document.onselectstart!==V&&(document.onselectstart=V)};return useEventListener(toRef(e,"scrollbarElement"),"mousemove",de),useEventListener(toRef(e,"scrollbarElement"),"mouseleave",Ce),(qe,jt)=>(openBlock(),createBlock(Transition,{name:unref(n).b("fade"),persisted:""},{default:withCtx(()=>[withDirectives(createBaseVNode("div",{ref_key:"instance",ref:g,class:normalizeClass([unref(n).e("bar"),unref(n).is(unref(z).key)]),onMousedown:ue},[createBaseVNode("div",{ref_key:"thumb",ref:y,class:normalizeClass(unref(n).e("thumb")),style:normalizeStyle(unref(re)),onMousedown:le},null,38)],34),[[vShow,qe.always||k.value]])]),_:1},8,["name"]))}});var Thumb=_export_sfc$1(_sfc_main$1e,[["__file","thumb.vue"]]);const barProps=buildProps({always:{type:Boolean,default:!0},minSize:{type:Number,required:!0}}),_sfc_main$1d=defineComponent({__name:"bar",props:barProps,setup(t,{expose:r}){const e=t,n=inject(scrollbarContextKey),g=ref(0),y=ref(0),i=ref(""),k=ref(""),L=ref(1),$=ref(1);return r({handleScroll:re=>{if(re){const oe=re.offsetHeight-GAP,le=re.offsetWidth-GAP;y.value=re.scrollTop*100/oe*L.value,g.value=re.scrollLeft*100/le*$.value}},update:()=>{const re=n==null?void 0:n.wrapElement;if(!re)return;const oe=re.offsetHeight-GAP,le=re.offsetWidth-GAP,ue=oe**2/re.scrollHeight,ie=le**2/re.scrollWidth,ae=Math.max(ue,e.minSize),Ie=Math.max(ie,e.minSize);L.value=ue/(oe-ue)/(ae/(oe-ae)),$.value=ie/(le-ie)/(Ie/(le-Ie)),k.value=ae+GAP<oe?`${ae}px`:"",i.value=Ie+GAP<le?`${Ie}px`:""}}),(re,oe)=>(openBlock(),createElementBlock(Fragment,null,[createVNode(Thumb,{move:g.value,ratio:$.value,size:i.value,always:re.always},null,8,["move","ratio","size","always"]),createVNode(Thumb,{move:y.value,ratio:L.value,size:k.value,vertical:"",always:re.always},null,8,["move","ratio","size","always"])],64))}});var Bar=_export_sfc$1(_sfc_main$1d,[["__file","bar.vue"]]);const scrollbarProps=buildProps({height:{type:[String,Number],default:""},maxHeight:{type:[String,Number],default:""},native:{type:Boolean,default:!1},wrapStyle:{type:definePropType([String,Object,Array]),default:""},wrapClass:{type:[String,Array],default:""},viewClass:{type:[String,Array],default:""},viewStyle:{type:[String,Array,Object],default:""},noresize:Boolean,tag:{type:String,default:"div"},always:Boolean,minSize:{type:Number,default:20},id:String,role:String,ariaLabel:String,ariaOrientation:{type:String,values:["horizontal","vertical"]}}),scrollbarEmits={scroll:({scrollTop:t,scrollLeft:r})=>[t,r].every(isNumber$1)},COMPONENT_NAME$7="ElScrollbar",__default__$L=defineComponent({name:COMPONENT_NAME$7}),_sfc_main$1c=defineComponent({...__default__$L,props:scrollbarProps,emits:scrollbarEmits,setup(t,{expose:r,emit:e}){const n=t,g=useNamespace("scrollbar");let y,i;const k=ref(),L=ref(),$=ref(),V=ref(),z=computed(()=>{const de={};return n.height&&(de.height=addUnit(n.height)),n.maxHeight&&(de.maxHeight=addUnit(n.maxHeight)),[n.wrapStyle,de]}),re=computed(()=>[n.wrapClass,g.e("wrap"),{[g.em("wrap","hidden-default")]:!n.native}]),oe=computed(()=>[g.e("view"),n.viewClass]),le=()=>{var de;L.value&&((de=V.value)==null||de.handleScroll(L.value),e("scroll",{scrollTop:L.value.scrollTop,scrollLeft:L.value.scrollLeft}))};function ue(de,Ce){isObject$2(de)?L.value.scrollTo(de):isNumber$1(de)&&isNumber$1(Ce)&&L.value.scrollTo(de,Ce)}const ie=de=>{isNumber$1(de)&&(L.value.scrollTop=de)},ae=de=>{isNumber$1(de)&&(L.value.scrollLeft=de)},Ie=()=>{var de;(de=V.value)==null||de.update()};return watch(()=>n.noresize,de=>{de?(y==null||y(),i==null||i()):({stop:y}=useResizeObserver($,Ie),i=useEventListener("resize",Ie))},{immediate:!0}),watch(()=>[n.maxHeight,n.height],()=>{n.native||nextTick(()=>{var de;Ie(),L.value&&((de=V.value)==null||de.handleScroll(L.value))})}),provide(scrollbarContextKey,reactive({scrollbarElement:k,wrapElement:L})),onMounted(()=>{n.native||nextTick(()=>{Ie()})}),onUpdated(()=>Ie()),r({wrapRef:L,update:Ie,scrollTo:ue,setScrollTop:ie,setScrollLeft:ae,handleScroll:le}),(de,Ce)=>(openBlock(),createElementBlock("div",{ref_key:"scrollbarRef",ref:k,class:normalizeClass(unref(g).b())},[createBaseVNode("div",{ref_key:"wrapRef",ref:L,class:normalizeClass(unref(re)),style:normalizeStyle(unref(z)),onScroll:le},[(openBlock(),createBlock(resolveDynamicComponent(de.tag),{id:de.id,ref_key:"resizeRef",ref:$,class:normalizeClass(unref(oe)),style:normalizeStyle(de.viewStyle),role:de.role,"aria-label":de.ariaLabel,"aria-orientation":de.ariaOrientation},{default:withCtx(()=>[renderSlot(de.$slots,"default")]),_:3},8,["id","class","style","role","aria-label","aria-orientation"]))],38),de.native?createCommentVNode("v-if",!0):(openBlock(),createBlock(Bar,{key:0,ref_key:"barRef",ref:V,always:de.always,"min-size":de.minSize},null,8,["always","min-size"]))],2))}});var Scrollbar=_export_sfc$1(_sfc_main$1c,[["__file","scrollbar.vue"]]);const ElScrollbar=withInstall(Scrollbar),POPPER_INJECTION_KEY=Symbol("popper"),POPPER_CONTENT_INJECTION_KEY=Symbol("popperContent"),roleTypes=["dialog","grid","group","listbox","menu","navigation","tooltip","tree"],popperProps=buildProps({role:{type:String,values:roleTypes,default:"tooltip"}}),__default__$K=defineComponent({name:"ElPopper",inheritAttrs:!1}),_sfc_main$1b=defineComponent({...__default__$K,props:popperProps,setup(t,{expose:r}){const e=t,n=ref(),g=ref(),y=ref(),i=ref(),k=computed(()=>e.role),L={triggerRef:n,popperInstanceRef:g,contentRef:y,referenceRef:i,role:k};return r(L),provide(POPPER_INJECTION_KEY,L),($,V)=>renderSlot($.$slots,"default")}});var Popper=_export_sfc$1(_sfc_main$1b,[["__file","popper.vue"]]);const popperArrowProps=buildProps({arrowOffset:{type:Number,default:5}}),__default__$J=defineComponent({name:"ElPopperArrow",inheritAttrs:!1}),_sfc_main$1a=defineComponent({...__default__$J,props:popperArrowProps,setup(t,{expose:r}){const e=t,n=useNamespace("popper"),{arrowOffset:g,arrowRef:y,arrowStyle:i}=inject(POPPER_CONTENT_INJECTION_KEY,void 0);return watch(()=>e.arrowOffset,k=>{g.value=k}),onBeforeUnmount(()=>{y.value=void 0}),r({arrowRef:y}),(k,L)=>(openBlock(),createElementBlock("span",{ref_key:"arrowRef",ref:y,class:normalizeClass(unref(n).e("arrow")),style:normalizeStyle(unref(i)),"data-popper-arrow":""},null,6))}});var ElPopperArrow=_export_sfc$1(_sfc_main$1a,[["__file","arrow.vue"]]);const NAME="ElOnlyChild",OnlyChild=defineComponent({name:NAME,setup(t,{slots:r,attrs:e}){var n;const g=inject(FORWARD_REF_INJECTION_KEY),y=useForwardRefDirective((n=g==null?void 0:g.setForwardRef)!=null?n:NOOP);return()=>{var i;const k=(i=r.default)==null?void 0:i.call(r,e);if(!k||k.length>1)return null;const L=findFirstLegitChild(k);return L?withDirectives(cloneVNode(L,e),[[y]]):null}}});function findFirstLegitChild(t){if(!t)return null;const r=t;for(const e of r){if(isObject$2(e))switch(e.type){case Comment:continue;case Text:case"svg":return wrapTextContent(e);case Fragment:return findFirstLegitChild(e.children);default:return e}return wrapTextContent(e)}return null}function wrapTextContent(t){const r=useNamespace("only-child");return createVNode("span",{class:r.e("content")},[t])}const popperTriggerProps=buildProps({virtualRef:{type:definePropType(Object)},virtualTriggering:Boolean,onMouseenter:{type:definePropType(Function)},onMouseleave:{type:definePropType(Function)},onClick:{type:definePropType(Function)},onKeydown:{type:definePropType(Function)},onFocus:{type:definePropType(Function)},onBlur:{type:definePropType(Function)},onContextmenu:{type:definePropType(Function)},id:String,open:Boolean}),__default__$I=defineComponent({name:"ElPopperTrigger",inheritAttrs:!1}),_sfc_main$19=defineComponent({...__default__$I,props:popperTriggerProps,setup(t,{expose:r}){const e=t,{role:n,triggerRef:g}=inject(POPPER_INJECTION_KEY,void 0);useForwardRef(g);const y=computed(()=>k.value?e.id:void 0),i=computed(()=>{if(n&&n.value==="tooltip")return e.open&&e.id?e.id:void 0}),k=computed(()=>{if(n&&n.value!=="tooltip")return n.value}),L=computed(()=>k.value?`${e.open}`:void 0);let $;return onMounted(()=>{watch(()=>e.virtualRef,V=>{V&&(g.value=unrefElement(V))},{immediate:!0}),watch(g,(V,z)=>{$==null||$(),$=void 0,isElement(V)&&(["onMouseenter","onMouseleave","onClick","onKeydown","onFocus","onBlur","onContextmenu"].forEach(re=>{var oe;const le=e[re];le&&(V.addEventListener(re.slice(2).toLowerCase(),le),(oe=z==null?void 0:z.removeEventListener)==null||oe.call(z,re.slice(2).toLowerCase(),le))}),$=watch([y,i,k,L],re=>{["aria-controls","aria-describedby","aria-haspopup","aria-expanded"].forEach((oe,le)=>{isNil(re[le])?V.removeAttribute(oe):V.setAttribute(oe,re[le])})},{immediate:!0})),isElement(z)&&["aria-controls","aria-describedby","aria-haspopup","aria-expanded"].forEach(re=>z.removeAttribute(re))},{immediate:!0})}),onBeforeUnmount(()=>{$==null||$(),$=void 0}),r({triggerRef:g}),(V,z)=>V.virtualTriggering?createCommentVNode("v-if",!0):(openBlock(),createBlock(unref(OnlyChild),mergeProps({key:0},V.$attrs,{"aria-controls":unref(y),"aria-describedby":unref(i),"aria-expanded":unref(L),"aria-haspopup":unref(k)}),{default:withCtx(()=>[renderSlot(V.$slots,"default")]),_:3},16,["aria-controls","aria-describedby","aria-expanded","aria-haspopup"]))}});var ElPopperTrigger=_export_sfc$1(_sfc_main$19,[["__file","trigger.vue"]]);const FOCUS_AFTER_TRAPPED="focus-trap.focus-after-trapped",FOCUS_AFTER_RELEASED="focus-trap.focus-after-released",FOCUSOUT_PREVENTED="focus-trap.focusout-prevented",FOCUS_AFTER_TRAPPED_OPTS={cancelable:!0,bubbles:!1},FOCUSOUT_PREVENTED_OPTS={cancelable:!0,bubbles:!1},ON_TRAP_FOCUS_EVT="focusAfterTrapped",ON_RELEASE_FOCUS_EVT="focusAfterReleased",FOCUS_TRAP_INJECTION_KEY=Symbol("elFocusTrap"),focusReason=ref(),lastUserFocusTimestamp=ref(0),lastAutomatedFocusTimestamp=ref(0);let focusReasonUserCount=0;const obtainAllFocusableElements=t=>{const r=[],e=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,{acceptNode:n=>{const g=n.tagName==="INPUT"&&n.type==="hidden";return n.disabled||n.hidden||g?NodeFilter.FILTER_SKIP:n.tabIndex>=0||n===document.activeElement?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;e.nextNode();)r.push(e.currentNode);return r},getVisibleElement=(t,r)=>{for(const e of t)if(!isHidden(e,r))return e},isHidden=(t,r)=>{if(getComputedStyle(t).visibility==="hidden")return!0;for(;t;){if(r&&t===r)return!1;if(getComputedStyle(t).display==="none")return!0;t=t.parentElement}return!1},getEdges=t=>{const r=obtainAllFocusableElements(t),e=getVisibleElement(r,t),n=getVisibleElement(r.reverse(),t);return[e,n]},isSelectable=t=>t instanceof HTMLInputElement&&"select"in t,tryFocus=(t,r)=>{if(t&&t.focus){const e=document.activeElement;t.focus({preventScroll:!0}),lastAutomatedFocusTimestamp.value=window.performance.now(),t!==e&&isSelectable(t)&&r&&t.select()}};function removeFromStack(t,r){const e=[...t],n=t.indexOf(r);return n!==-1&&e.splice(n,1),e}const createFocusableStack=()=>{let t=[];return{push:n=>{const g=t[0];g&&n!==g&&g.pause(),t=removeFromStack(t,n),t.unshift(n)},remove:n=>{var g,y;t=removeFromStack(t,n),(y=(g=t[0])==null?void 0:g.resume)==null||y.call(g)}}},focusFirstDescendant=(t,r=!1)=>{const e=document.activeElement;for(const n of t)if(tryFocus(n,r),document.activeElement!==e)return},focusableStack=createFocusableStack(),isFocusCausedByUserEvent=()=>lastUserFocusTimestamp.value>lastAutomatedFocusTimestamp.value,notifyFocusReasonPointer=()=>{focusReason.value="pointer",lastUserFocusTimestamp.value=window.performance.now()},notifyFocusReasonKeydown=()=>{focusReason.value="keyboard",lastUserFocusTimestamp.value=window.performance.now()},useFocusReason=()=>(onMounted(()=>{focusReasonUserCount===0&&(document.addEventListener("mousedown",notifyFocusReasonPointer),document.addEventListener("touchstart",notifyFocusReasonPointer),document.addEventListener("keydown",notifyFocusReasonKeydown)),focusReasonUserCount++}),onBeforeUnmount(()=>{focusReasonUserCount--,focusReasonUserCount<=0&&(document.removeEventListener("mousedown",notifyFocusReasonPointer),document.removeEventListener("touchstart",notifyFocusReasonPointer),document.removeEventListener("keydown",notifyFocusReasonKeydown))}),{focusReason,lastUserFocusTimestamp,lastAutomatedFocusTimestamp}),createFocusOutPreventedEvent=t=>new CustomEvent(FOCUSOUT_PREVENTED,{...FOCUSOUT_PREVENTED_OPTS,detail:t}),_sfc_main$18=defineComponent({name:"ElFocusTrap",inheritAttrs:!1,props:{loop:Boolean,trapped:Boolean,focusTrapEl:Object,focusStartEl:{type:[Object,String],default:"first"}},emits:[ON_TRAP_FOCUS_EVT,ON_RELEASE_FOCUS_EVT,"focusin","focusout","focusout-prevented","release-requested"],setup(t,{emit:r}){const e=ref();let n,g;const{focusReason:y}=useFocusReason();useEscapeKeydown(le=>{t.trapped&&!i.paused&&r("release-requested",le)});const i={paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}},k=le=>{if(!t.loop&&!t.trapped||i.paused)return;const{key:ue,altKey:ie,ctrlKey:ae,metaKey:Ie,currentTarget:de,shiftKey:Ce}=le,{loop:Ue}=t,qe=ue===EVENT_CODE.tab&&!ie&&!ae&&!Ie,jt=document.activeElement;if(qe&&jt){const Fe=de,[Et,cr]=getEdges(Fe);if(Et&&cr){if(!Ce&&jt===cr){const nr=createFocusOutPreventedEvent({focusReason:y.value});r("focusout-prevented",nr),nr.defaultPrevented||(le.preventDefault(),Ue&&tryFocus(Et,!0))}else if(Ce&&[Et,Fe].includes(jt)){const nr=createFocusOutPreventedEvent({focusReason:y.value});r("focusout-prevented",nr),nr.defaultPrevented||(le.preventDefault(),Ue&&tryFocus(cr,!0))}}else if(jt===Fe){const nr=createFocusOutPreventedEvent({focusReason:y.value});r("focusout-prevented",nr),nr.defaultPrevented||le.preventDefault()}}};provide(FOCUS_TRAP_INJECTION_KEY,{focusTrapRef:e,onKeydown:k}),watch(()=>t.focusTrapEl,le=>{le&&(e.value=le)},{immediate:!0}),watch([e],([le],[ue])=>{le&&(le.addEventListener("keydown",k),le.addEventListener("focusin",V),le.addEventListener("focusout",z)),ue&&(ue.removeEventListener("keydown",k),ue.removeEventListener("focusin",V),ue.removeEventListener("focusout",z))});const L=le=>{r(ON_TRAP_FOCUS_EVT,le)},$=le=>r(ON_RELEASE_FOCUS_EVT,le),V=le=>{const ue=unref(e);if(!ue)return;const ie=le.target,ae=le.relatedTarget,Ie=ie&&ue.contains(ie);t.trapped||ae&&ue.contains(ae)||(n=ae),Ie&&r("focusin",le),!i.paused&&t.trapped&&(Ie?g=ie:tryFocus(g,!0))},z=le=>{const ue=unref(e);if(!(i.paused||!ue))if(t.trapped){const ie=le.relatedTarget;!isNil(ie)&&!ue.contains(ie)&&setTimeout(()=>{if(!i.paused&&t.trapped){const ae=createFocusOutPreventedEvent({focusReason:y.value});r("focusout-prevented",ae),ae.defaultPrevented||tryFocus(g,!0)}},0)}else{const ie=le.target;ie&&ue.contains(ie)||r("focusout",le)}};async function re(){await nextTick();const le=unref(e);if(le){focusableStack.push(i);const ue=le.contains(document.activeElement)?n:document.activeElement;if(n=ue,!le.contains(ue)){const ae=new Event(FOCUS_AFTER_TRAPPED,FOCUS_AFTER_TRAPPED_OPTS);le.addEventListener(FOCUS_AFTER_TRAPPED,L),le.dispatchEvent(ae),ae.defaultPrevented||nextTick(()=>{let Ie=t.focusStartEl;isString$2(Ie)||(tryFocus(Ie),document.activeElement!==Ie&&(Ie="first")),Ie==="first"&&focusFirstDescendant(obtainAllFocusableElements(le),!0),(document.activeElement===ue||Ie==="container")&&tryFocus(le)})}}}function oe(){const le=unref(e);if(le){le.removeEventListener(FOCUS_AFTER_TRAPPED,L);const ue=new CustomEvent(FOCUS_AFTER_RELEASED,{...FOCUS_AFTER_TRAPPED_OPTS,detail:{focusReason:y.value}});le.addEventListener(FOCUS_AFTER_RELEASED,$),le.dispatchEvent(ue),!ue.defaultPrevented&&(y.value=="keyboard"||!isFocusCausedByUserEvent()||le.contains(document.activeElement))&&tryFocus(n??document.body),le.removeEventListener(FOCUS_AFTER_RELEASED,$),focusableStack.remove(i)}}return onMounted(()=>{t.trapped&&re(),watch(()=>t.trapped,le=>{le?re():oe()})}),onBeforeUnmount(()=>{t.trapped&&oe()}),{onKeydown:k}}});function _sfc_render$d(t,r,e,n,g,y){return renderSlot(t.$slots,"default",{handleKeydown:t.onKeydown})}var ElFocusTrap=_export_sfc$1(_sfc_main$18,[["render",_sfc_render$d],["__file","focus-trap.vue"]]);const POSITIONING_STRATEGIES=["fixed","absolute"],popperCoreConfigProps=buildProps({boundariesPadding:{type:Number,default:0},fallbackPlacements:{type:definePropType(Array),default:void 0},gpuAcceleration:{type:Boolean,default:!0},offset:{type:Number,default:12},placement:{type:String,values:Ee,default:"bottom"},popperOptions:{type:definePropType(Object),default:()=>({})},strategy:{type:String,values:POSITIONING_STRATEGIES,default:"absolute"}}),popperContentProps=buildProps({...popperCoreConfigProps,id:String,style:{type:definePropType([String,Array,Object])},className:{type:definePropType([String,Array,Object])},effect:{type:String,default:"dark"},visible:Boolean,enterable:{type:Boolean,default:!0},pure:Boolean,focusOnShow:{type:Boolean,default:!1},trapping:{type:Boolean,default:!1},popperClass:{type:definePropType([String,Array,Object])},popperStyle:{type:definePropType([String,Array,Object])},referenceEl:{type:definePropType(Object)},triggerTargetEl:{type:definePropType(Object)},stopPopperMouseEvent:{type:Boolean,default:!0},ariaLabel:{type:String,default:void 0},virtualTriggering:Boolean,zIndex:Number}),popperContentEmits={mouseenter:t=>t instanceof MouseEvent,mouseleave:t=>t instanceof MouseEvent,focus:()=>!0,blur:()=>!0,close:()=>!0},buildPopperOptions=(t,r=[])=>{const{placement:e,strategy:n,popperOptions:g}=t,y={placement:e,strategy:n,...g,modifiers:[...genModifiers(t),...r]};return deriveExtraModifiers(y,g==null?void 0:g.modifiers),y},unwrapMeasurableEl=t=>{if(isClient)return unrefElement(t)};function genModifiers(t){const{offset:r,gpuAcceleration:e,fallbackPlacements:n}=t;return[{name:"offset",options:{offset:[0,r??12]}},{name:"preventOverflow",options:{padding:{top:2,bottom:2,left:5,right:5}}},{name:"flip",options:{padding:5,fallbackPlacements:n}},{name:"computeStyles",options:{gpuAcceleration:e}}]}function deriveExtraModifiers(t,r){r&&(t.modifiers=[...t.modifiers,...r??[]])}const DEFAULT_ARROW_OFFSET=0,usePopperContent=t=>{const{popperInstanceRef:r,contentRef:e,triggerRef:n,role:g}=inject(POPPER_INJECTION_KEY,void 0),y=ref(),i=ref(),k=computed(()=>({name:"eventListeners",enabled:!!t.visible})),L=computed(()=>{var ae;const Ie=unref(y),de=(ae=unref(i))!=null?ae:DEFAULT_ARROW_OFFSET;return{name:"arrow",enabled:!isUndefined$2(Ie),options:{element:Ie,padding:de}}}),$=computed(()=>({onFirstUpdate:()=>{le()},...buildPopperOptions(t,[unref(L),unref(k)])})),V=computed(()=>unwrapMeasurableEl(t.referenceEl)||unref(n)),{attributes:z,state:re,styles:oe,update:le,forceUpdate:ue,instanceRef:ie}=usePopper(V,e,$);return watch(ie,ae=>r.value=ae),onMounted(()=>{watch(()=>{var ae;return(ae=unref(V))==null?void 0:ae.getBoundingClientRect()},()=>{le()})}),{attributes:z,arrowRef:y,contentRef:e,instanceRef:ie,state:re,styles:oe,role:g,forceUpdate:ue,update:le}},usePopperContentDOM=(t,{attributes:r,styles:e,role:n})=>{const{nextZIndex:g}=useZIndex(),y=useNamespace("popper"),i=computed(()=>unref(r).popper),k=ref(isNumber$1(t.zIndex)?t.zIndex:g()),L=computed(()=>[y.b(),y.is("pure",t.pure),y.is(t.effect),t.popperClass]),$=computed(()=>[{zIndex:unref(k)},unref(e).popper,t.popperStyle||{}]),V=computed(()=>n.value==="dialog"?"false":void 0),z=computed(()=>unref(e).arrow||{});return{ariaModal:V,arrowStyle:z,contentAttrs:i,contentClass:L,contentStyle:$,contentZIndex:k,updateZIndex:()=>{k.value=isNumber$1(t.zIndex)?t.zIndex:g()}}},usePopperContentFocusTrap=(t,r)=>{const e=ref(!1),n=ref();return{focusStartRef:n,trapped:e,onFocusAfterReleased:$=>{var V;((V=$.detail)==null?void 0:V.focusReason)!=="pointer"&&(n.value="first",r("blur"))},onFocusAfterTrapped:()=>{r("focus")},onFocusInTrap:$=>{t.visible&&!e.value&&($.target&&(n.value=$.target),e.value=!0)},onFocusoutPrevented:$=>{t.trapping||($.detail.focusReason==="pointer"&&$.preventDefault(),e.value=!1)},onReleaseRequested:()=>{e.value=!1,r("close")}}},__default__$H=defineComponent({name:"ElPopperContent"}),_sfc_main$17=defineComponent({...__default__$H,props:popperContentProps,emits:popperContentEmits,setup(t,{expose:r,emit:e}){const n=t,{focusStartRef:g,trapped:y,onFocusAfterReleased:i,onFocusAfterTrapped:k,onFocusInTrap:L,onFocusoutPrevented:$,onReleaseRequested:V}=usePopperContentFocusTrap(n,e),{attributes:z,arrowRef:re,contentRef:oe,styles:le,instanceRef:ue,role:ie,update:ae}=usePopperContent(n),{ariaModal:Ie,arrowStyle:de,contentAttrs:Ce,contentClass:Ue,contentStyle:qe,updateZIndex:jt}=usePopperContentDOM(n,{styles:le,attributes:z,role:ie}),Fe=inject(formItemContextKey,void 0),Et=ref();provide(POPPER_CONTENT_INJECTION_KEY,{arrowStyle:de,arrowRef:re,arrowOffset:Et}),Fe&&(Fe.addInputId||Fe.removeInputId)&&provide(formItemContextKey,{...Fe,addInputId:NOOP,removeInputId:NOOP});let cr;const er=(dr=!0)=>{ae(),dr&&jt()},nr=()=>{er(!1),n.visible&&n.focusOnShow?y.value=!0:n.visible===!1&&(y.value=!1)};return onMounted(()=>{watch(()=>n.triggerTargetEl,(dr,ir)=>{cr==null||cr(),cr=void 0;const tr=unref(dr||oe.value),ur=unref(ir||oe.value);isElement(tr)&&(cr=watch([ie,()=>n.ariaLabel,Ie,()=>n.id],or=>{["role","aria-label","aria-modal","id"].forEach((fr,lr)=>{isNil(or[lr])?tr.removeAttribute(fr):tr.setAttribute(fr,or[lr])})},{immediate:!0})),ur!==tr&&isElement(ur)&&["role","aria-label","aria-modal","id"].forEach(or=>{ur.removeAttribute(or)})},{immediate:!0}),watch(()=>n.visible,nr,{immediate:!0})}),onBeforeUnmount(()=>{cr==null||cr(),cr=void 0}),r({popperContentRef:oe,popperInstanceRef:ue,updatePopper:er,contentStyle:qe}),(dr,ir)=>(openBlock(),createElementBlock("div",mergeProps({ref_key:"contentRef",ref:oe},unref(Ce),{style:unref(qe),class:unref(Ue),tabindex:"-1",onMouseenter:ir[0]||(ir[0]=tr=>dr.$emit("mouseenter",tr)),onMouseleave:ir[1]||(ir[1]=tr=>dr.$emit("mouseleave",tr))}),[createVNode(unref(ElFocusTrap),{trapped:unref(y),"trap-on-focus-in":!0,"focus-trap-el":unref(oe),"focus-start-el":unref(g),onFocusAfterTrapped:unref(k),onFocusAfterReleased:unref(i),onFocusin:unref(L),onFocusoutPrevented:unref($),onReleaseRequested:unref(V)},{default:withCtx(()=>[renderSlot(dr.$slots,"default")]),_:3},8,["trapped","focus-trap-el","focus-start-el","onFocusAfterTrapped","onFocusAfterReleased","onFocusin","onFocusoutPrevented","onReleaseRequested"])],16))}});var ElPopperContent=_export_sfc$1(_sfc_main$17,[["__file","content.vue"]]);const ElPopper=withInstall(Popper),TOOLTIP_INJECTION_KEY=Symbol("elTooltip"),useTooltipContentProps=buildProps({...useDelayedToggleProps,...popperContentProps,appendTo:{type:definePropType([String,Object])},content:{type:String,default:""},rawContent:{type:Boolean,default:!1},persistent:Boolean,ariaLabel:String,visible:{type:definePropType(Boolean),default:null},transition:String,teleported:{type:Boolean,default:!0},disabled:Boolean}),useTooltipTriggerProps=buildProps({...popperTriggerProps,disabled:Boolean,trigger:{type:definePropType([String,Array]),default:"hover"},triggerKeys:{type:definePropType(Array),default:()=>[EVENT_CODE.enter,EVENT_CODE.space]}}),{useModelToggleProps:useTooltipModelToggleProps,useModelToggleEmits:useTooltipModelToggleEmits,useModelToggle:useTooltipModelToggle}=createModelToggleComposable("visible"),useTooltipProps=buildProps({...popperProps,...useTooltipModelToggleProps,...useTooltipContentProps,...useTooltipTriggerProps,...popperArrowProps,showArrow:{type:Boolean,default:!0}}),tooltipEmits=[...useTooltipModelToggleEmits,"before-show","before-hide","show","hide","open","close"],isTriggerType=(t,r)=>isArray$3(t)?t.includes(r):t===r,whenTrigger=(t,r,e)=>n=>{isTriggerType(unref(t),r)&&e(n)},__default__$G=defineComponent({name:"ElTooltipTrigger"}),_sfc_main$16=defineComponent({...__default__$G,props:useTooltipTriggerProps,setup(t,{expose:r}){const e=t,n=useNamespace("tooltip"),{controlled:g,id:y,open:i,onOpen:k,onClose:L,onToggle:$}=inject(TOOLTIP_INJECTION_KEY,void 0),V=ref(null),z=()=>{if(unref(g)||e.disabled)return!0},re=toRef(e,"trigger"),oe=composeEventHandlers(z,whenTrigger(re,"hover",k)),le=composeEventHandlers(z,whenTrigger(re,"hover",L)),ue=composeEventHandlers(z,whenTrigger(re,"click",Ce=>{Ce.button===0&&$(Ce)})),ie=composeEventHandlers(z,whenTrigger(re,"focus",k)),ae=composeEventHandlers(z,whenTrigger(re,"focus",L)),Ie=composeEventHandlers(z,whenTrigger(re,"contextmenu",Ce=>{Ce.preventDefault(),$(Ce)})),de=composeEventHandlers(z,Ce=>{const{code:Ue}=Ce;e.triggerKeys.includes(Ue)&&(Ce.preventDefault(),$(Ce))});return r({triggerRef:V}),(Ce,Ue)=>(openBlock(),createBlock(unref(ElPopperTrigger),{id:unref(y),"virtual-ref":Ce.virtualRef,open:unref(i),"virtual-triggering":Ce.virtualTriggering,class:normalizeClass(unref(n).e("trigger")),onBlur:unref(ae),onClick:unref(ue),onContextmenu:unref(Ie),onFocus:unref(ie),onMouseenter:unref(oe),onMouseleave:unref(le),onKeydown:unref(de)},{default:withCtx(()=>[renderSlot(Ce.$slots,"default")]),_:3},8,["id","virtual-ref","open","virtual-triggering","class","onBlur","onClick","onContextmenu","onFocus","onMouseenter","onMouseleave","onKeydown"]))}});var ElTooltipTrigger=_export_sfc$1(_sfc_main$16,[["__file","trigger.vue"]]);const __default__$F=defineComponent({name:"ElTooltipContent",inheritAttrs:!1}),_sfc_main$15=defineComponent({...__default__$F,props:useTooltipContentProps,setup(t,{expose:r}){const e=t,{selector:n}=usePopperContainerId(),g=useNamespace("tooltip"),y=ref(null),i=ref(!1),{controlled:k,id:L,open:$,trigger:V,onClose:z,onOpen:re,onShow:oe,onHide:le,onBeforeShow:ue,onBeforeHide:ie}=inject(TOOLTIP_INJECTION_KEY,void 0),ae=computed(()=>e.transition||`${g.namespace.value}-fade-in-linear`),Ie=computed(()=>e.persistent);onBeforeUnmount(()=>{i.value=!0});const de=computed(()=>unref(Ie)?!0:unref($)),Ce=computed(()=>e.disabled?!1:unref($)),Ue=computed(()=>e.appendTo||n.value),qe=computed(()=>{var or;return(or=e.style)!=null?or:{}}),jt=computed(()=>!unref($)),Fe=()=>{le()},Et=()=>{if(unref(k))return!0},cr=composeEventHandlers(Et,()=>{e.enterable&&unref(V)==="hover"&&re()}),er=composeEventHandlers(Et,()=>{unref(V)==="hover"&&z()}),nr=()=>{var or,fr;(fr=(or=y.value)==null?void 0:or.updatePopper)==null||fr.call(or),ue==null||ue()},dr=()=>{ie==null||ie()},ir=()=>{oe(),ur=onClickOutside(computed(()=>{var or;return(or=y.value)==null?void 0:or.popperContentRef}),()=>{if(unref(k))return;unref(V)!=="hover"&&z()})},tr=()=>{e.virtualTriggering||z()};let ur;return watch(()=>unref($),or=>{or||ur==null||ur()},{flush:"post"}),watch(()=>e.content,()=>{var or,fr;(fr=(or=y.value)==null?void 0:or.updatePopper)==null||fr.call(or)}),r({contentRef:y}),(or,fr)=>(openBlock(),createBlock(Teleport,{disabled:!or.teleported,to:unref(Ue)},[createVNode(Transition,{name:unref(ae),onAfterLeave:Fe,onBeforeEnter:nr,onAfterEnter:ir,onBeforeLeave:dr},{default:withCtx(()=>[unref(de)?withDirectives((openBlock(),createBlock(unref(ElPopperContent),mergeProps({key:0,id:unref(L),ref_key:"contentRef",ref:y},or.$attrs,{"aria-label":or.ariaLabel,"aria-hidden":unref(jt),"boundaries-padding":or.boundariesPadding,"fallback-placements":or.fallbackPlacements,"gpu-acceleration":or.gpuAcceleration,offset:or.offset,placement:or.placement,"popper-options":or.popperOptions,strategy:or.strategy,effect:or.effect,enterable:or.enterable,pure:or.pure,"popper-class":or.popperClass,"popper-style":[or.popperStyle,unref(qe)],"reference-el":or.referenceEl,"trigger-target-el":or.triggerTargetEl,visible:unref(Ce),"z-index":or.zIndex,onMouseenter:unref(cr),onMouseleave:unref(er),onBlur:tr,onClose:unref(z)}),{default:withCtx(()=>[i.value?createCommentVNode("v-if",!0):renderSlot(or.$slots,"default",{key:0})]),_:3},16,["id","aria-label","aria-hidden","boundaries-padding","fallback-placements","gpu-acceleration","offset","placement","popper-options","strategy","effect","enterable","pure","popper-class","popper-style","reference-el","trigger-target-el","visible","z-index","onMouseenter","onMouseleave","onClose"])),[[vShow,unref(Ce)]]):createCommentVNode("v-if",!0)]),_:3},8,["name"])],8,["disabled","to"]))}});var ElTooltipContent=_export_sfc$1(_sfc_main$15,[["__file","content.vue"]]);const _hoisted_1$E=["innerHTML"],_hoisted_2$o={key:1},__default__$E=defineComponent({name:"ElTooltip"}),_sfc_main$14=defineComponent({...__default__$E,props:useTooltipProps,emits:tooltipEmits,setup(t,{expose:r,emit:e}){const n=t;usePopperContainer();const g=useId(),y=ref(),i=ref(),k=()=>{var ae;const Ie=unref(y);Ie&&((ae=Ie.popperInstanceRef)==null||ae.update())},L=ref(!1),$=ref(),{show:V,hide:z,hasUpdateHandler:re}=useTooltipModelToggle({indicator:L,toggleReason:$}),{onOpen:oe,onClose:le}=useDelayedToggle({showAfter:toRef(n,"showAfter"),hideAfter:toRef(n,"hideAfter"),autoClose:toRef(n,"autoClose"),open:V,close:z}),ue=computed(()=>isBoolean$1(n.visible)&&!re.value);provide(TOOLTIP_INJECTION_KEY,{controlled:ue,id:g,open:readonly(L),trigger:toRef(n,"trigger"),onOpen:ae=>{oe(ae)},onClose:ae=>{le(ae)},onToggle:ae=>{unref(L)?le(ae):oe(ae)},onShow:()=>{e("show",$.value)},onHide:()=>{e("hide",$.value)},onBeforeShow:()=>{e("before-show",$.value)},onBeforeHide:()=>{e("before-hide",$.value)},updatePopper:k}),watch(()=>n.disabled,ae=>{ae&&L.value&&(L.value=!1)});const ie=ae=>{var Ie,de;const Ce=(de=(Ie=i.value)==null?void 0:Ie.contentRef)==null?void 0:de.popperContentRef,Ue=(ae==null?void 0:ae.relatedTarget)||document.activeElement;return Ce&&Ce.contains(Ue)};return onDeactivated(()=>L.value&&z()),r({popperRef:y,contentRef:i,isFocusInsideContent:ie,updatePopper:k,onOpen:oe,onClose:le,hide:z}),(ae,Ie)=>(openBlock(),createBlock(unref(ElPopper),{ref_key:"popperRef",ref:y,role:ae.role},{default:withCtx(()=>[createVNode(ElTooltipTrigger,{disabled:ae.disabled,trigger:ae.trigger,"trigger-keys":ae.triggerKeys,"virtual-ref":ae.virtualRef,"virtual-triggering":ae.virtualTriggering},{default:withCtx(()=>[ae.$slots.default?renderSlot(ae.$slots,"default",{key:0}):createCommentVNode("v-if",!0)]),_:3},8,["disabled","trigger","trigger-keys","virtual-ref","virtual-triggering"]),createVNode(ElTooltipContent,{ref_key:"contentRef",ref:i,"aria-label":ae.ariaLabel,"boundaries-padding":ae.boundariesPadding,content:ae.content,disabled:ae.disabled,effect:ae.effect,enterable:ae.enterable,"fallback-placements":ae.fallbackPlacements,"hide-after":ae.hideAfter,"gpu-acceleration":ae.gpuAcceleration,offset:ae.offset,persistent:ae.persistent,"popper-class":ae.popperClass,"popper-style":ae.popperStyle,placement:ae.placement,"popper-options":ae.popperOptions,pure:ae.pure,"raw-content":ae.rawContent,"reference-el":ae.referenceEl,"trigger-target-el":ae.triggerTargetEl,"show-after":ae.showAfter,strategy:ae.strategy,teleported:ae.teleported,transition:ae.transition,"virtual-triggering":ae.virtualTriggering,"z-index":ae.zIndex,"append-to":ae.appendTo},{default:withCtx(()=>[renderSlot(ae.$slots,"content",{},()=>[ae.rawContent?(openBlock(),createElementBlock("span",{key:0,innerHTML:ae.content},null,8,_hoisted_1$E)):(openBlock(),createElementBlock("span",_hoisted_2$o,toDisplayString(ae.content),1))]),ae.showArrow?(openBlock(),createBlock(unref(ElPopperArrow),{key:0,"arrow-offset":ae.arrowOffset},null,8,["arrow-offset"])):createCommentVNode("v-if",!0)]),_:3},8,["aria-label","boundaries-padding","content","disabled","effect","enterable","fallback-placements","hide-after","gpu-acceleration","offset","persistent","popper-class","popper-style","placement","popper-options","pure","raw-content","reference-el","trigger-target-el","show-after","strategy","teleported","transition","virtual-triggering","z-index","append-to"])]),_:3},8,["role"]))}});var Tooltip=_export_sfc$1(_sfc_main$14,[["__file","tooltip.vue"]]);const ElTooltip=withInstall(Tooltip),avatarProps=buildProps({size:{type:[Number,String],values:componentSizes,default:"",validator:t=>isNumber$1(t)},shape:{type:String,values:["circle","square"],default:"circle"},icon:{type:iconPropType},src:{type:String,default:""},alt:String,srcSet:String,fit:{type:definePropType(String),default:"cover"}}),avatarEmits={error:t=>t instanceof Event},_hoisted_1$D=["src","alt","srcset"],__default__$D=defineComponent({name:"ElAvatar"}),_sfc_main$13=defineComponent({...__default__$D,props:avatarProps,emits:avatarEmits,setup(t,{emit:r}){const e=t,n=useNamespace("avatar"),g=ref(!1),y=computed(()=>{const{size:$,icon:V,shape:z}=e,re=[n.b()];return isString$2($)&&re.push(n.m($)),V&&re.push(n.m("icon")),z&&re.push(n.m(z)),re}),i=computed(()=>{const{size:$}=e;return isNumber$1($)?n.cssVarBlock({size:addUnit($)||""}):void 0}),k=computed(()=>({objectFit:e.fit}));watch(()=>e.src,()=>g.value=!1);function L($){g.value=!0,r("error",$)}return($,V)=>(openBlock(),createElementBlock("span",{class:normalizeClass(unref(y)),style:normalizeStyle(unref(i))},[($.src||$.srcSet)&&!g.value?(openBlock(),createElementBlock("img",{key:0,src:$.src,alt:$.alt,srcset:$.srcSet,style:normalizeStyle(unref(k)),onError:L},null,44,_hoisted_1$D)):$.icon?(openBlock(),createBlock(unref(ElIcon),{key:1},{default:withCtx(()=>[(openBlock(),createBlock(resolveDynamicComponent($.icon)))]),_:1})):renderSlot($.$slots,"default",{key:2})],6))}});var Avatar=_export_sfc$1(_sfc_main$13,[["__file","avatar.vue"]]);const ElAvatar=withInstall(Avatar),badgeProps=buildProps({value:{type:[String,Number],default:""},max:{type:Number,default:99},isDot:Boolean,hidden:Boolean,type:{type:String,values:["primary","success","warning","info","danger"],default:"danger"}}),_hoisted_1$C=["textContent"],__default__$C=defineComponent({name:"ElBadge"}),_sfc_main$12=defineComponent({...__default__$C,props:badgeProps,setup(t,{expose:r}){const e=t,n=useNamespace("badge"),g=computed(()=>e.isDot?"":isNumber$1(e.value)&&isNumber$1(e.max)?e.max<e.value?`${e.max}+`:`${e.value}`:`${e.value}`);return r({content:g}),(y,i)=>(openBlock(),createElementBlock("div",{class:normalizeClass(unref(n).b())},[renderSlot(y.$slots,"default"),createVNode(Transition,{name:`${unref(n).namespace.value}-zoom-in-center`,persisted:""},{default:withCtx(()=>[withDirectives(createBaseVNode("sup",{class:normalizeClass([unref(n).e("content"),unref(n).em("content",y.type),unref(n).is("fixed",!!y.$slots.default),unref(n).is("dot",y.isDot)]),textContent:toDisplayString(unref(g))},null,10,_hoisted_1$C),[[vShow,!y.hidden&&(unref(g)||y.isDot)]])]),_:1},8,["name"])],2))}});var Badge=_export_sfc$1(_sfc_main$12,[["__file","badge.vue"]]);const ElBadge=withInstall(Badge),buttonGroupContextKey=Symbol("buttonGroupContextKey"),useButton=(t,r)=>{useDeprecated({from:"type.text",replacement:"link",version:"3.0.0",scope:"props",ref:"https://element-plus.org/en-US/component/button.html#button-attributes"},computed(()=>t.type==="text"));const e=inject(buttonGroupContextKey,void 0),n=useGlobalConfig("button"),{form:g}=useFormItem(),y=useFormSize(computed(()=>e==null?void 0:e.size)),i=useFormDisabled(),k=ref(),L=useSlots(),$=computed(()=>t.type||(e==null?void 0:e.type)||""),V=computed(()=>{var le,ue,ie;return(ie=(ue=t.autoInsertSpace)!=null?ue:(le=n.value)==null?void 0:le.autoInsertSpace)!=null?ie:!1}),z=computed(()=>t.tag==="button"?{ariaDisabled:i.value||t.loading,disabled:i.value||t.loading,autofocus:t.autofocus,type:t.nativeType}:{}),re=computed(()=>{var le;const ue=(le=L.default)==null?void 0:le.call(L);if(V.value&&(ue==null?void 0:ue.length)===1){const ie=ue[0];if((ie==null?void 0:ie.type)===Text){const ae=ie.children;return/^\p{Unified_Ideograph}{2}$/u.test(ae.trim())}}return!1});return{_disabled:i,_size:y,_type:$,_ref:k,_props:z,shouldAddSpace:re,handleClick:le=>{t.nativeType==="reset"&&(g==null||g.resetFields()),r("click",le)}}},buttonTypes=["default","primary","success","warning","info","danger","text",""],buttonNativeTypes=["button","submit","reset"],buttonProps=buildProps({size:useSizeProp,disabled:Boolean,type:{type:String,values:buttonTypes,default:""},icon:{type:iconPropType},nativeType:{type:String,values:buttonNativeTypes,default:"button"},loading:Boolean,loadingIcon:{type:iconPropType,default:()=>loading_default},plain:Boolean,text:Boolean,link:Boolean,bg:Boolean,autofocus:Boolean,round:Boolean,circle:Boolean,color:String,dark:Boolean,autoInsertSpace:{type:Boolean,default:void 0},tag:{type:definePropType([String,Object]),default:"button"}}),buttonEmits={click:t=>t instanceof MouseEvent};function bound01(t,r){isOnePointZero(t)&&(t="100%");var e=isPercentage(t);return t=r===360?t:Math.min(r,Math.max(0,parseFloat(t))),e&&(t=parseInt(String(t*r),10)/100),Math.abs(t-r)<1e-6?1:(r===360?t=(t<0?t%r+r:t%r)/parseFloat(String(r)):t=t%r/parseFloat(String(r)),t)}function clamp01(t){return Math.min(1,Math.max(0,t))}function isOnePointZero(t){return typeof t=="string"&&t.indexOf(".")!==-1&&parseFloat(t)===1}function isPercentage(t){return typeof t=="string"&&t.indexOf("%")!==-1}function boundAlpha(t){return t=parseFloat(t),(isNaN(t)||t<0||t>1)&&(t=1),t}function convertToPercentage(t){return t<=1?"".concat(Number(t)*100,"%"):t}function pad2(t){return t.length===1?"0"+t:String(t)}function rgbToRgb(t,r,e){return{r:bound01(t,255)*255,g:bound01(r,255)*255,b:bound01(e,255)*255}}function rgbToHsl(t,r,e){t=bound01(t,255),r=bound01(r,255),e=bound01(e,255);var n=Math.max(t,r,e),g=Math.min(t,r,e),y=0,i=0,k=(n+g)/2;if(n===g)i=0,y=0;else{var L=n-g;switch(i=k>.5?L/(2-n-g):L/(n+g),n){case t:y=(r-e)/L+(r<e?6:0);break;case r:y=(e-t)/L+2;break;case e:y=(t-r)/L+4;break}y/=6}return{h:y,s:i,l:k}}function hue2rgb(t,r,e){return e<0&&(e+=1),e>1&&(e-=1),e<1/6?t+(r-t)*(6*e):e<1/2?r:e<2/3?t+(r-t)*(2/3-e)*6:t}function hslToRgb(t,r,e){var n,g,y;if(t=bound01(t,360),r=bound01(r,100),e=bound01(e,100),r===0)g=e,y=e,n=e;else{var i=e<.5?e*(1+r):e+r-e*r,k=2*e-i;n=hue2rgb(k,i,t+1/3),g=hue2rgb(k,i,t),y=hue2rgb(k,i,t-1/3)}return{r:n*255,g:g*255,b:y*255}}function rgbToHsv(t,r,e){t=bound01(t,255),r=bound01(r,255),e=bound01(e,255);var n=Math.max(t,r,e),g=Math.min(t,r,e),y=0,i=n,k=n-g,L=n===0?0:k/n;if(n===g)y=0;else{switch(n){case t:y=(r-e)/k+(r<e?6:0);break;case r:y=(e-t)/k+2;break;case e:y=(t-r)/k+4;break}y/=6}return{h:y,s:L,v:i}}function hsvToRgb(t,r,e){t=bound01(t,360)*6,r=bound01(r,100),e=bound01(e,100);var n=Math.floor(t),g=t-n,y=e*(1-r),i=e*(1-g*r),k=e*(1-(1-g)*r),L=n%6,$=[e,i,y,y,k,e][L],V=[k,e,e,i,y,y][L],z=[y,y,k,e,e,i][L];return{r:$*255,g:V*255,b:z*255}}function rgbToHex(t,r,e,n){var g=[pad2(Math.round(t).toString(16)),pad2(Math.round(r).toString(16)),pad2(Math.round(e).toString(16))];return n&&g[0].startsWith(g[0].charAt(1))&&g[1].startsWith(g[1].charAt(1))&&g[2].startsWith(g[2].charAt(1))?g[0].charAt(0)+g[1].charAt(0)+g[2].charAt(0):g.join("")}function rgbaToHex(t,r,e,n,g){var y=[pad2(Math.round(t).toString(16)),pad2(Math.round(r).toString(16)),pad2(Math.round(e).toString(16)),pad2(convertDecimalToHex(n))];return g&&y[0].startsWith(y[0].charAt(1))&&y[1].startsWith(y[1].charAt(1))&&y[2].startsWith(y[2].charAt(1))&&y[3].startsWith(y[3].charAt(1))?y[0].charAt(0)+y[1].charAt(0)+y[2].charAt(0)+y[3].charAt(0):y.join("")}function convertDecimalToHex(t){return Math.round(parseFloat(t)*255).toString(16)}function convertHexToDecimal(t){return parseIntFromHex(t)/255}function parseIntFromHex(t){return parseInt(t,16)}function numberInputToObject(t){return{r:t>>16,g:(t&65280)>>8,b:t&255}}var names={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",goldenrod:"#daa520",gold:"#ffd700",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavenderblush:"#fff0f5",lavender:"#e6e6fa",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};function inputToRGB(t){var r={r:0,g:0,b:0},e=1,n=null,g=null,y=null,i=!1,k=!1;return typeof t=="string"&&(t=stringInputToObject(t)),typeof t=="object"&&(isValidCSSUnit(t.r)&&isValidCSSUnit(t.g)&&isValidCSSUnit(t.b)?(r=rgbToRgb(t.r,t.g,t.b),i=!0,k=String(t.r).substr(-1)==="%"?"prgb":"rgb"):isValidCSSUnit(t.h)&&isValidCSSUnit(t.s)&&isValidCSSUnit(t.v)?(n=convertToPercentage(t.s),g=convertToPercentage(t.v),r=hsvToRgb(t.h,n,g),i=!0,k="hsv"):isValidCSSUnit(t.h)&&isValidCSSUnit(t.s)&&isValidCSSUnit(t.l)&&(n=convertToPercentage(t.s),y=convertToPercentage(t.l),r=hslToRgb(t.h,n,y),i=!0,k="hsl"),Object.prototype.hasOwnProperty.call(t,"a")&&(e=t.a)),e=boundAlpha(e),{ok:i,format:t.format||k,r:Math.min(255,Math.max(r.r,0)),g:Math.min(255,Math.max(r.g,0)),b:Math.min(255,Math.max(r.b,0)),a:e}}var CSS_INTEGER="[-\\+]?\\d+%?",CSS_NUMBER="[-\\+]?\\d*\\.\\d+%?",CSS_UNIT="(?:".concat(CSS_NUMBER,")|(?:").concat(CSS_INTEGER,")"),PERMISSIVE_MATCH3="[\\s|\\(]+(".concat(CSS_UNIT,")[,|\\s]+(").concat(CSS_UNIT,")[,|\\s]+(").concat(CSS_UNIT,")\\s*\\)?"),PERMISSIVE_MATCH4="[\\s|\\(]+(".concat(CSS_UNIT,")[,|\\s]+(").concat(CSS_UNIT,")[,|\\s]+(").concat(CSS_UNIT,")[,|\\s]+(").concat(CSS_UNIT,")\\s*\\)?"),matchers={CSS_UNIT:new RegExp(CSS_UNIT),rgb:new RegExp("rgb"+PERMISSIVE_MATCH3),rgba:new RegExp("rgba"+PERMISSIVE_MATCH4),hsl:new RegExp("hsl"+PERMISSIVE_MATCH3),hsla:new RegExp("hsla"+PERMISSIVE_MATCH4),hsv:new RegExp("hsv"+PERMISSIVE_MATCH3),hsva:new RegExp("hsva"+PERMISSIVE_MATCH4),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/};function stringInputToObject(t){if(t=t.trim().toLowerCase(),t.length===0)return!1;var r=!1;if(names[t])t=names[t],r=!0;else if(t==="transparent")return{r:0,g:0,b:0,a:0,format:"name"};var e=matchers.rgb.exec(t);return e?{r:e[1],g:e[2],b:e[3]}:(e=matchers.rgba.exec(t),e?{r:e[1],g:e[2],b:e[3],a:e[4]}:(e=matchers.hsl.exec(t),e?{h:e[1],s:e[2],l:e[3]}:(e=matchers.hsla.exec(t),e?{h:e[1],s:e[2],l:e[3],a:e[4]}:(e=matchers.hsv.exec(t),e?{h:e[1],s:e[2],v:e[3]}:(e=matchers.hsva.exec(t),e?{h:e[1],s:e[2],v:e[3],a:e[4]}:(e=matchers.hex8.exec(t),e?{r:parseIntFromHex(e[1]),g:parseIntFromHex(e[2]),b:parseIntFromHex(e[3]),a:convertHexToDecimal(e[4]),format:r?"name":"hex8"}:(e=matchers.hex6.exec(t),e?{r:parseIntFromHex(e[1]),g:parseIntFromHex(e[2]),b:parseIntFromHex(e[3]),format:r?"name":"hex"}:(e=matchers.hex4.exec(t),e?{r:parseIntFromHex(e[1]+e[1]),g:parseIntFromHex(e[2]+e[2]),b:parseIntFromHex(e[3]+e[3]),a:convertHexToDecimal(e[4]+e[4]),format:r?"name":"hex8"}:(e=matchers.hex3.exec(t),e?{r:parseIntFromHex(e[1]+e[1]),g:parseIntFromHex(e[2]+e[2]),b:parseIntFromHex(e[3]+e[3]),format:r?"name":"hex"}:!1)))))))))}function isValidCSSUnit(t){return!!matchers.CSS_UNIT.exec(String(t))}var TinyColor=function(){function t(r,e){r===void 0&&(r=""),e===void 0&&(e={});var n;if(r instanceof t)return r;typeof r=="number"&&(r=numberInputToObject(r)),this.originalInput=r;var g=inputToRGB(r);this.originalInput=r,this.r=g.r,this.g=g.g,this.b=g.b,this.a=g.a,this.roundA=Math.round(100*this.a)/100,this.format=(n=e.format)!==null&&n!==void 0?n:g.format,this.gradientType=e.gradientType,this.r<1&&(this.r=Math.round(this.r)),this.g<1&&(this.g=Math.round(this.g)),this.b<1&&(this.b=Math.round(this.b)),this.isValid=g.ok}return t.prototype.isDark=function(){return this.getBrightness()<128},t.prototype.isLight=function(){return!this.isDark()},t.prototype.getBrightness=function(){var r=this.toRgb();return(r.r*299+r.g*587+r.b*114)/1e3},t.prototype.getLuminance=function(){var r=this.toRgb(),e,n,g,y=r.r/255,i=r.g/255,k=r.b/255;return y<=.03928?e=y/12.92:e=Math.pow((y+.055)/1.055,2.4),i<=.03928?n=i/12.92:n=Math.pow((i+.055)/1.055,2.4),k<=.03928?g=k/12.92:g=Math.pow((k+.055)/1.055,2.4),.2126*e+.7152*n+.0722*g},t.prototype.getAlpha=function(){return this.a},t.prototype.setAlpha=function(r){return this.a=boundAlpha(r),this.roundA=Math.round(100*this.a)/100,this},t.prototype.isMonochrome=function(){var r=this.toHsl().s;return r===0},t.prototype.toHsv=function(){var r=rgbToHsv(this.r,this.g,this.b);return{h:r.h*360,s:r.s,v:r.v,a:this.a}},t.prototype.toHsvString=function(){var r=rgbToHsv(this.r,this.g,this.b),e=Math.round(r.h*360),n=Math.round(r.s*100),g=Math.round(r.v*100);return this.a===1?"hsv(".concat(e,", ").concat(n,"%, ").concat(g,"%)"):"hsva(".concat(e,", ").concat(n,"%, ").concat(g,"%, ").concat(this.roundA,")")},t.prototype.toHsl=function(){var r=rgbToHsl(this.r,this.g,this.b);return{h:r.h*360,s:r.s,l:r.l,a:this.a}},t.prototype.toHslString=function(){var r=rgbToHsl(this.r,this.g,this.b),e=Math.round(r.h*360),n=Math.round(r.s*100),g=Math.round(r.l*100);return this.a===1?"hsl(".concat(e,", ").concat(n,"%, ").concat(g,"%)"):"hsla(".concat(e,", ").concat(n,"%, ").concat(g,"%, ").concat(this.roundA,")")},t.prototype.toHex=function(r){return r===void 0&&(r=!1),rgbToHex(this.r,this.g,this.b,r)},t.prototype.toHexString=function(r){return r===void 0&&(r=!1),"#"+this.toHex(r)},t.prototype.toHex8=function(r){return r===void 0&&(r=!1),rgbaToHex(this.r,this.g,this.b,this.a,r)},t.prototype.toHex8String=function(r){return r===void 0&&(r=!1),"#"+this.toHex8(r)},t.prototype.toHexShortString=function(r){return r===void 0&&(r=!1),this.a===1?this.toHexString(r):this.toHex8String(r)},t.prototype.toRgb=function(){return{r:Math.round(this.r),g:Math.round(this.g),b:Math.round(this.b),a:this.a}},t.prototype.toRgbString=function(){var r=Math.round(this.r),e=Math.round(this.g),n=Math.round(this.b);return this.a===1?"rgb(".concat(r,", ").concat(e,", ").concat(n,")"):"rgba(".concat(r,", ").concat(e,", ").concat(n,", ").concat(this.roundA,")")},t.prototype.toPercentageRgb=function(){var r=function(e){return"".concat(Math.round(bound01(e,255)*100),"%")};return{r:r(this.r),g:r(this.g),b:r(this.b),a:this.a}},t.prototype.toPercentageRgbString=function(){var r=function(e){return Math.round(bound01(e,255)*100)};return this.a===1?"rgb(".concat(r(this.r),"%, ").concat(r(this.g),"%, ").concat(r(this.b),"%)"):"rgba(".concat(r(this.r),"%, ").concat(r(this.g),"%, ").concat(r(this.b),"%, ").concat(this.roundA,")")},t.prototype.toName=function(){if(this.a===0)return"transparent";if(this.a<1)return!1;for(var r="#"+rgbToHex(this.r,this.g,this.b,!1),e=0,n=Object.entries(names);e<n.length;e++){var g=n[e],y=g[0],i=g[1];if(r===i)return y}return!1},t.prototype.toString=function(r){var e=!!r;r=r??this.format;var n=!1,g=this.a<1&&this.a>=0,y=!e&&g&&(r.startsWith("hex")||r==="name");return y?r==="name"&&this.a===0?this.toName():this.toRgbString():(r==="rgb"&&(n=this.toRgbString()),r==="prgb"&&(n=this.toPercentageRgbString()),(r==="hex"||r==="hex6")&&(n=this.toHexString()),r==="hex3"&&(n=this.toHexString(!0)),r==="hex4"&&(n=this.toHex8String(!0)),r==="hex8"&&(n=this.toHex8String()),r==="name"&&(n=this.toName()),r==="hsl"&&(n=this.toHslString()),r==="hsv"&&(n=this.toHsvString()),n||this.toHexString())},t.prototype.toNumber=function(){return(Math.round(this.r)<<16)+(Math.round(this.g)<<8)+Math.round(this.b)},t.prototype.clone=function(){return new t(this.toString())},t.prototype.lighten=function(r){r===void 0&&(r=10);var e=this.toHsl();return e.l+=r/100,e.l=clamp01(e.l),new t(e)},t.prototype.brighten=function(r){r===void 0&&(r=10);var e=this.toRgb();return e.r=Math.max(0,Math.min(255,e.r-Math.round(255*-(r/100)))),e.g=Math.max(0,Math.min(255,e.g-Math.round(255*-(r/100)))),e.b=Math.max(0,Math.min(255,e.b-Math.round(255*-(r/100)))),new t(e)},t.prototype.darken=function(r){r===void 0&&(r=10);var e=this.toHsl();return e.l-=r/100,e.l=clamp01(e.l),new t(e)},t.prototype.tint=function(r){return r===void 0&&(r=10),this.mix("white",r)},t.prototype.shade=function(r){return r===void 0&&(r=10),this.mix("black",r)},t.prototype.desaturate=function(r){r===void 0&&(r=10);var e=this.toHsl();return e.s-=r/100,e.s=clamp01(e.s),new t(e)},t.prototype.saturate=function(r){r===void 0&&(r=10);var e=this.toHsl();return e.s+=r/100,e.s=clamp01(e.s),new t(e)},t.prototype.greyscale=function(){return this.desaturate(100)},t.prototype.spin=function(r){var e=this.toHsl(),n=(e.h+r)%360;return e.h=n<0?360+n:n,new t(e)},t.prototype.mix=function(r,e){e===void 0&&(e=50);var n=this.toRgb(),g=new t(r).toRgb(),y=e/100,i={r:(g.r-n.r)*y+n.r,g:(g.g-n.g)*y+n.g,b:(g.b-n.b)*y+n.b,a:(g.a-n.a)*y+n.a};return new t(i)},t.prototype.analogous=function(r,e){r===void 0&&(r=6),e===void 0&&(e=30);var n=this.toHsl(),g=360/e,y=[this];for(n.h=(n.h-(g*r>>1)+720)%360;--r;)n.h=(n.h+g)%360,y.push(new t(n));return y},t.prototype.complement=function(){var r=this.toHsl();return r.h=(r.h+180)%360,new t(r)},t.prototype.monochromatic=function(r){r===void 0&&(r=6);for(var e=this.toHsv(),n=e.h,g=e.s,y=e.v,i=[],k=1/r;r--;)i.push(new t({h:n,s:g,v:y})),y=(y+k)%1;return i},t.prototype.splitcomplement=function(){var r=this.toHsl(),e=r.h;return[this,new t({h:(e+72)%360,s:r.s,l:r.l}),new t({h:(e+216)%360,s:r.s,l:r.l})]},t.prototype.onBackground=function(r){var e=this.toRgb(),n=new t(r).toRgb(),g=e.a+n.a*(1-e.a);return new t({r:(e.r*e.a+n.r*n.a*(1-e.a))/g,g:(e.g*e.a+n.g*n.a*(1-e.a))/g,b:(e.b*e.a+n.b*n.a*(1-e.a))/g,a:g})},t.prototype.triad=function(){return this.polyad(3)},t.prototype.tetrad=function(){return this.polyad(4)},t.prototype.polyad=function(r){for(var e=this.toHsl(),n=e.h,g=[this],y=360/r,i=1;i<r;i++)g.push(new t({h:(n+i*y)%360,s:e.s,l:e.l}));return g},t.prototype.equals=function(r){return this.toRgbString()===new t(r).toRgbString()},t}();function darken(t,r=20){return t.mix("#141414",r).toString()}function useButtonCustomStyle(t){const r=useFormDisabled(),e=useNamespace("button");return computed(()=>{let n={};const g=t.color;if(g){const y=new TinyColor(g),i=t.dark?y.tint(20).toString():darken(y,20);if(t.plain)n=e.cssVarBlock({"bg-color":t.dark?darken(y,90):y.tint(90).toString(),"text-color":g,"border-color":t.dark?darken(y,50):y.tint(50).toString(),"hover-text-color":`var(${e.cssVarName("color-white")})`,"hover-bg-color":g,"hover-border-color":g,"active-bg-color":i,"active-text-color":`var(${e.cssVarName("color-white")})`,"active-border-color":i}),r.value&&(n[e.cssVarBlockName("disabled-bg-color")]=t.dark?darken(y,90):y.tint(90).toString(),n[e.cssVarBlockName("disabled-text-color")]=t.dark?darken(y,50):y.tint(50).toString(),n[e.cssVarBlockName("disabled-border-color")]=t.dark?darken(y,80):y.tint(80).toString());else{const k=t.dark?darken(y,30):y.tint(30).toString(),L=y.isDark()?`var(${e.cssVarName("color-white")})`:`var(${e.cssVarName("color-black")})`;if(n=e.cssVarBlock({"bg-color":g,"text-color":L,"border-color":g,"hover-bg-color":k,"hover-text-color":L,"hover-border-color":k,"active-bg-color":i,"active-border-color":i}),r.value){const $=t.dark?darken(y,50):y.tint(50).toString();n[e.cssVarBlockName("disabled-bg-color")]=$,n[e.cssVarBlockName("disabled-text-color")]=t.dark?"rgba(255, 255, 255, 0.5)":`var(${e.cssVarName("color-white")})`,n[e.cssVarBlockName("disabled-border-color")]=$}}}return n})}const __default__$B=defineComponent({name:"ElButton"}),_sfc_main$11=defineComponent({...__default__$B,props:buttonProps,emits:buttonEmits,setup(t,{expose:r,emit:e}){const n=t,g=useButtonCustomStyle(n),y=useNamespace("button"),{_ref:i,_size:k,_type:L,_disabled:$,_props:V,shouldAddSpace:z,handleClick:re}=useButton(n,e);return r({ref:i,size:k,type:L,disabled:$,shouldAddSpace:z}),(oe,le)=>(openBlock(),createBlock(resolveDynamicComponent(oe.tag),mergeProps({ref_key:"_ref",ref:i},unref(V),{class:[unref(y).b(),unref(y).m(unref(L)),unref(y).m(unref(k)),unref(y).is("disabled",unref($)),unref(y).is("loading",oe.loading),unref(y).is("plain",oe.plain),unref(y).is("round",oe.round),unref(y).is("circle",oe.circle),unref(y).is("text",oe.text),unref(y).is("link",oe.link),unref(y).is("has-bg",oe.bg)],style:unref(g),onClick:unref(re)}),{default:withCtx(()=>[oe.loading?(openBlock(),createElementBlock(Fragment,{key:0},[oe.$slots.loading?renderSlot(oe.$slots,"loading",{key:0}):(openBlock(),createBlock(unref(ElIcon),{key:1,class:normalizeClass(unref(y).is("loading"))},{default:withCtx(()=>[(openBlock(),createBlock(resolveDynamicComponent(oe.loadingIcon)))]),_:1},8,["class"]))],64)):oe.icon||oe.$slots.icon?(openBlock(),createBlock(unref(ElIcon),{key:1},{default:withCtx(()=>[oe.icon?(openBlock(),createBlock(resolveDynamicComponent(oe.icon),{key:0})):renderSlot(oe.$slots,"icon",{key:1})]),_:3})):createCommentVNode("v-if",!0),oe.$slots.default?(openBlock(),createElementBlock("span",{key:2,class:normalizeClass({[unref(y).em("text","expand")]:unref(z)})},[renderSlot(oe.$slots,"default")],2)):createCommentVNode("v-if",!0)]),_:3},16,["class","style","onClick"]))}});var Button=_export_sfc$1(_sfc_main$11,[["__file","button.vue"]]);const buttonGroupProps={size:buttonProps.size,type:buttonProps.type},__default__$A=defineComponent({name:"ElButtonGroup"}),_sfc_main$10=defineComponent({...__default__$A,props:buttonGroupProps,setup(t){const r=t;provide(buttonGroupContextKey,reactive({size:toRef(r,"size"),type:toRef(r,"type")}));const e=useNamespace("button");return(n,g)=>(openBlock(),createElementBlock("div",{class:normalizeClass(`${unref(e).b("group")}`)},[renderSlot(n.$slots,"default")],2))}});var ButtonGroup=_export_sfc$1(_sfc_main$10,[["__file","button-group.vue"]]);const ElButton=withInstall(Button,{ButtonGroup});withNoopInstall(ButtonGroup);var commonjsGlobal=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function getDefaultExportFromCjs(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var dayjs_min={exports:{}};(function(t,r){(function(e,n){t.exports=n()})(commonjsGlobal,function(){var e=1e3,n=6e4,g=36e5,y="millisecond",i="second",k="minute",L="hour",$="day",V="week",z="month",re="quarter",oe="year",le="date",ue="Invalid Date",ie=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,ae=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,Ie={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(ir){var tr=["th","st","nd","rd"],ur=ir%100;return"["+ir+(tr[(ur-20)%10]||tr[ur]||tr[0])+"]"}},de=function(ir,tr,ur){var or=String(ir);return!or||or.length>=tr?ir:""+Array(tr+1-or.length).join(ur)+ir},Ce={s:de,z:function(ir){var tr=-ir.utcOffset(),ur=Math.abs(tr),or=Math.floor(ur/60),fr=ur%60;return(tr<=0?"+":"-")+de(or,2,"0")+":"+de(fr,2,"0")},m:function ir(tr,ur){if(tr.date()<ur.date())return-ir(ur,tr);var or=12*(ur.year()-tr.year())+(ur.month()-tr.month()),fr=tr.clone().add(or,z),lr=ur-fr<0,gr=tr.clone().add(or+(lr?-1:1),z);return+(-(or+(ur-fr)/(lr?fr-gr:gr-fr))||0)},a:function(ir){return ir<0?Math.ceil(ir)||0:Math.floor(ir)},p:function(ir){return{M:z,y:oe,w:V,d:$,D:le,h:L,m:k,s:i,ms:y,Q:re}[ir]||String(ir||"").toLowerCase().replace(/s$/,"")},u:function(ir){return ir===void 0}},Ue="en",qe={};qe[Ue]=Ie;var jt="$isDayjsObject",Fe=function(ir){return ir instanceof nr||!(!ir||!ir[jt])},Et=function ir(tr,ur,or){var fr;if(!tr)return Ue;if(typeof tr=="string"){var lr=tr.toLowerCase();qe[lr]&&(fr=lr),ur&&(qe[lr]=ur,fr=lr);var gr=tr.split("-");if(!fr&&gr.length>1)return ir(gr[0])}else{var Sr=tr.name;qe[Sr]=tr,fr=Sr}return!or&&fr&&(Ue=fr),fr||!or&&Ue},cr=function(ir,tr){if(Fe(ir))return ir.clone();var ur=typeof tr=="object"?tr:{};return ur.date=ir,ur.args=arguments,new nr(ur)},er=Ce;er.l=Et,er.i=Fe,er.w=function(ir,tr){return cr(ir,{locale:tr.$L,utc:tr.$u,x:tr.$x,$offset:tr.$offset})};var nr=function(){function ir(ur){this.$L=Et(ur.locale,null,!0),this.parse(ur),this.$x=this.$x||ur.x||{},this[jt]=!0}var tr=ir.prototype;return tr.parse=function(ur){this.$d=function(or){var fr=or.date,lr=or.utc;if(fr===null)return new Date(NaN);if(er.u(fr))return new Date;if(fr instanceof Date)return new Date(fr);if(typeof fr=="string"&&!/Z$/i.test(fr)){var gr=fr.match(ie);if(gr){var Sr=gr[2]-1||0,wr=(gr[7]||"0").substring(0,3);return lr?new Date(Date.UTC(gr[1],Sr,gr[3]||1,gr[4]||0,gr[5]||0,gr[6]||0,wr)):new Date(gr[1],Sr,gr[3]||1,gr[4]||0,gr[5]||0,gr[6]||0,wr)}}return new Date(fr)}(ur),this.init()},tr.init=function(){var ur=this.$d;this.$y=ur.getFullYear(),this.$M=ur.getMonth(),this.$D=ur.getDate(),this.$W=ur.getDay(),this.$H=ur.getHours(),this.$m=ur.getMinutes(),this.$s=ur.getSeconds(),this.$ms=ur.getMilliseconds()},tr.$utils=function(){return er},tr.isValid=function(){return this.$d.toString()!==ue},tr.isSame=function(ur,or){var fr=cr(ur);return this.startOf(or)<=fr&&fr<=this.endOf(or)},tr.isAfter=function(ur,or){return cr(ur)<this.startOf(or)},tr.isBefore=function(ur,or){return this.endOf(or)<cr(ur)},tr.$g=function(ur,or,fr){return er.u(ur)?this[or]:this.set(fr,ur)},tr.unix=function(){return Math.floor(this.valueOf()/1e3)},tr.valueOf=function(){return this.$d.getTime()},tr.startOf=function(ur,or){var fr=this,lr=!!er.u(or)||or,gr=er.p(ur),Sr=function(xr,Or){var Mr=er.w(fr.$u?Date.UTC(fr.$y,Or,xr):new Date(fr.$y,Or,xr),fr);return lr?Mr:Mr.endOf($)},wr=function(xr,Or){return er.w(fr.toDate()[xr].apply(fr.toDate("s"),(lr?[0,0,0,0]:[23,59,59,999]).slice(Or)),fr)},kr=this.$W,mr=this.$M,Ir=this.$D,Nr="set"+(this.$u?"UTC":"");switch(gr){case oe:return lr?Sr(1,0):Sr(31,11);case z:return lr?Sr(1,mr):Sr(0,mr+1);case V:var Er=this.$locale().weekStart||0,sr=(kr<Er?kr+7:kr)-Er;return Sr(lr?Ir-sr:Ir+(6-sr),mr);case $:case le:return wr(Nr+"Hours",0);case L:return wr(Nr+"Minutes",1);case k:return wr(Nr+"Seconds",2);case i:return wr(Nr+"Milliseconds",3);default:return this.clone()}},tr.endOf=function(ur){return this.startOf(ur,!1)},tr.$set=function(ur,or){var fr,lr=er.p(ur),gr="set"+(this.$u?"UTC":""),Sr=(fr={},fr[$]=gr+"Date",fr[le]=gr+"Date",fr[z]=gr+"Month",fr[oe]=gr+"FullYear",fr[L]=gr+"Hours",fr[k]=gr+"Minutes",fr[i]=gr+"Seconds",fr[y]=gr+"Milliseconds",fr)[lr],wr=lr===$?this.$D+(or-this.$W):or;if(lr===z||lr===oe){var kr=this.clone().set(le,1);kr.$d[Sr](wr),kr.init(),this.$d=kr.set(le,Math.min(this.$D,kr.daysInMonth())).$d}else Sr&&this.$d[Sr](wr);return this.init(),this},tr.set=function(ur,or){return this.clone().$set(ur,or)},tr.get=function(ur){return this[er.p(ur)]()},tr.add=function(ur,or){var fr,lr=this;ur=Number(ur);var gr=er.p(or),Sr=function(mr){var Ir=cr(lr);return er.w(Ir.date(Ir.date()+Math.round(mr*ur)),lr)};if(gr===z)return this.set(z,this.$M+ur);if(gr===oe)return this.set(oe,this.$y+ur);if(gr===$)return Sr(1);if(gr===V)return Sr(7);var wr=(fr={},fr[k]=n,fr[L]=g,fr[i]=e,fr)[gr]||1,kr=this.$d.getTime()+ur*wr;return er.w(kr,this)},tr.subtract=function(ur,or){return this.add(-1*ur,or)},tr.format=function(ur){var or=this,fr=this.$locale();if(!this.isValid())return fr.invalidDate||ue;var lr=ur||"YYYY-MM-DDTHH:mm:ssZ",gr=er.z(this),Sr=this.$H,wr=this.$m,kr=this.$M,mr=fr.weekdays,Ir=fr.months,Nr=fr.meridiem,Er=function(Or,Mr,br,hr){return Or&&(Or[Mr]||Or(or,lr))||br[Mr].slice(0,hr)},sr=function(Or){return er.s(Sr%12||12,Or,"0")},xr=Nr||function(Or,Mr,br){var hr=Or<12?"AM":"PM";return br?hr.toLowerCase():hr};return lr.replace(ae,function(Or,Mr){return Mr||function(br){switch(br){case"YY":return String(or.$y).slice(-2);case"YYYY":return er.s(or.$y,4,"0");case"M":return kr+1;case"MM":return er.s(kr+1,2,"0");case"MMM":return Er(fr.monthsShort,kr,Ir,3);case"MMMM":return Er(Ir,kr);case"D":return or.$D;case"DD":return er.s(or.$D,2,"0");case"d":return String(or.$W);case"dd":return Er(fr.weekdaysMin,or.$W,mr,2);case"ddd":return Er(fr.weekdaysShort,or.$W,mr,3);case"dddd":return mr[or.$W];case"H":return String(Sr);case"HH":return er.s(Sr,2,"0");case"h":return sr(1);case"hh":return sr(2);case"a":return xr(Sr,wr,!0);case"A":return xr(Sr,wr,!1);case"m":return String(wr);case"mm":return er.s(wr,2,"0");case"s":return String(or.$s);case"ss":return er.s(or.$s,2,"0");case"SSS":return er.s(or.$ms,3,"0");case"Z":return gr}return null}(Or)||gr.replace(":","")})},tr.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},tr.diff=function(ur,or,fr){var lr,gr=this,Sr=er.p(or),wr=cr(ur),kr=(wr.utcOffset()-this.utcOffset())*n,mr=this-wr,Ir=function(){return er.m(gr,wr)};switch(Sr){case oe:lr=Ir()/12;break;case z:lr=Ir();break;case re:lr=Ir()/3;break;case V:lr=(mr-kr)/6048e5;break;case $:lr=(mr-kr)/864e5;break;case L:lr=mr/g;break;case k:lr=mr/n;break;case i:lr=mr/e;break;default:lr=mr}return fr?lr:er.a(lr)},tr.daysInMonth=function(){return this.endOf(z).$D},tr.$locale=function(){return qe[this.$L]},tr.locale=function(ur,or){if(!ur)return this.$L;var fr=this.clone(),lr=Et(ur,or,!0);return lr&&(fr.$L=lr),fr},tr.clone=function(){return er.w(this.$d,this)},tr.toDate=function(){return new Date(this.valueOf())},tr.toJSON=function(){return this.isValid()?this.toISOString():null},tr.toISOString=function(){return this.$d.toISOString()},tr.toString=function(){return this.$d.toUTCString()},ir}(),dr=nr.prototype;return cr.prototype=dr,[["$ms",y],["$s",i],["$m",k],["$H",L],["$W",$],["$M",z],["$y",oe],["$D",le]].forEach(function(ir){dr[ir[1]]=function(tr){return this.$g(tr,ir[0],ir[1])}}),cr.extend=function(ir,tr){return ir.$i||(ir(tr,nr,cr),ir.$i=!0),cr},cr.locale=Et,cr.isDayjs=Fe,cr.unix=function(ir){return cr(1e3*ir)},cr.en=qe[Ue],cr.Ls=qe,cr.p={},cr})})(dayjs_min);var dayjs_minExports=dayjs_min.exports;const dayjs=getDefaultExportFromCjs(dayjs_minExports),nodeList=new Map;let startClick;isClient&&(document.addEventListener("mousedown",t=>startClick=t),document.addEventListener("mouseup",t=>{for(const r of nodeList.values())for(const{documentHandler:e}of r)e(t,startClick)}));function createDocumentHandler(t,r){let e=[];return Array.isArray(r.arg)?e=r.arg:isElement(r.arg)&&e.push(r.arg),function(n,g){const y=r.instance.popperRef,i=n.target,k=g==null?void 0:g.target,L=!r||!r.instance,$=!i||!k,V=t.contains(i)||t.contains(k),z=t===i,re=e.length&&e.some(le=>le==null?void 0:le.contains(i))||e.length&&e.includes(k),oe=y&&(y.contains(i)||y.contains(k));L||$||V||z||re||oe||r.value(n,g)}}const ClickOutside={beforeMount(t,r){nodeList.has(t)||nodeList.set(t,[]),nodeList.get(t).push({documentHandler:createDocumentHandler(t,r),bindingFn:r.value})},updated(t,r){nodeList.has(t)||nodeList.set(t,[]);const e=nodeList.get(t),n=e.findIndex(y=>y.bindingFn===r.oldValue),g={documentHandler:createDocumentHandler(t,r),bindingFn:r.value};n>=0?e.splice(n,1,g):e.push(g)},unmounted(t){nodeList.delete(t)}},REPEAT_INTERVAL=100,REPEAT_DELAY=600,vRepeatClick={beforeMount(t,r){const e=r.value,{interval:n=REPEAT_INTERVAL,delay:g=REPEAT_DELAY}=isFunction$3(e)?{}:e;let y,i;const k=()=>isFunction$3(e)?e():e.handler(),L=()=>{i&&(clearTimeout(i),i=void 0),y&&(clearInterval(y),y=void 0)};t.addEventListener("mousedown",$=>{$.button===0&&(L(),k(),document.addEventListener("mouseup",()=>L(),{once:!0}),i=setTimeout(()=>{y=setInterval(()=>{k()},n)},g))})}},FOCUSABLE_CHILDREN="_trap-focus-children",FOCUS_STACK=[],FOCUS_HANDLER=t=>{if(FOCUS_STACK.length===0)return;const r=FOCUS_STACK[FOCUS_STACK.length-1][FOCUSABLE_CHILDREN];if(r.length>0&&t.code===EVENT_CODE.tab){if(r.length===1){t.preventDefault(),document.activeElement!==r[0]&&r[0].focus();return}const e=t.shiftKey,n=t.target===r[0],g=t.target===r[r.length-1];n&&e&&(t.preventDefault(),r[r.length-1].focus()),g&&!e&&(t.preventDefault(),r[0].focus())}},TrapFocus={beforeMount(t){t[FOCUSABLE_CHILDREN]=obtainAllFocusableElements$1(t),FOCUS_STACK.push(t),FOCUS_STACK.length<=1&&document.addEventListener("keydown",FOCUS_HANDLER)},updated(t){nextTick(()=>{t[FOCUSABLE_CHILDREN]=obtainAllFocusableElements$1(t)})},unmounted(){FOCUS_STACK.shift(),FOCUS_STACK.length===0&&document.removeEventListener("keydown",FOCUS_HANDLER)}};var v=!1,o,f,s,u,d,N,l$1,p,m,w,D,x,E,M,F;function a(){if(!v){v=!0;var t=navigator.userAgent,r=/(?:MSIE.(\d+\.\d+))|(?:(?:Firefox|GranParadiso|Iceweasel).(\d+\.\d+))|(?:Opera(?:.+Version.|.)(\d+\.\d+))|(?:AppleWebKit.(\d+(?:\.\d+)?))|(?:Trident\/\d+\.\d+.*rv:(\d+\.\d+))/.exec(t),e=/(Mac OS X)|(Windows)|(Linux)/.exec(t);if(x=/\b(iPhone|iP[ao]d)/.exec(t),E=/\b(iP[ao]d)/.exec(t),w=/Android/i.exec(t),M=/FBAN\/\w+;/i.exec(t),F=/Mobile/i.exec(t),D=!!/Win64/.exec(t),r){o=r[1]?parseFloat(r[1]):r[5]?parseFloat(r[5]):NaN,o&&document&&document.documentMode&&(o=document.documentMode);var n=/(?:Trident\/(\d+.\d+))/.exec(t);N=n?parseFloat(n[1])+4:o,f=r[2]?parseFloat(r[2]):NaN,s=r[3]?parseFloat(r[3]):NaN,u=r[4]?parseFloat(r[4]):NaN,u?(r=/(?:Chrome\/(\d+\.\d+))/.exec(t),d=r&&r[1]?parseFloat(r[1]):NaN):d=NaN}else o=f=s=d=u=NaN;if(e){if(e[1]){var g=/(?:Mac OS X (\d+(?:[._]\d+)?))/.exec(t);l$1=g?parseFloat(g[1].replace("_",".")):!0}else l$1=!1;p=!!e[2],m=!!e[3]}else l$1=p=m=!1}}var _={ie:function(){return a()||o},ieCompatibilityMode:function(){return a()||N>o},ie64:function(){return _.ie()&&D},firefox:function(){return a()||f},opera:function(){return a()||s},webkit:function(){return a()||u},safari:function(){return _.webkit()},chrome:function(){return a()||d},windows:function(){return a()||p},osx:function(){return a()||l$1},linux:function(){return a()||m},iphone:function(){return a()||x},mobile:function(){return a()||x||E||w||F},nativeApp:function(){return a()||M},android:function(){return a()||w},ipad:function(){return a()||E}},A=_,c=!!(typeof window<"u"&&window.document&&window.document.createElement),U={canUseDOM:c,canUseWorkers:typeof Worker<"u",canUseEventListeners:c&&!!(window.addEventListener||window.attachEvent),canUseViewport:c&&!!window.screen,isInWorker:!c},h=U,X;h.canUseDOM&&(X=document.implementation&&document.implementation.hasFeature&&document.implementation.hasFeature("","")!==!0);function S(t,r){if(!h.canUseDOM||r&&!("addEventListener"in document))return!1;var e="on"+t,n=e in document;if(!n){var g=document.createElement("div");g.setAttribute(e,"return;"),n=typeof g[e]=="function"}return!n&&X&&t==="wheel"&&(n=document.implementation.hasFeature("Events.wheel","3.0")),n}var b=S,O=10,I=40,P=800;function T(t){var r=0,e=0,n=0,g=0;return"detail"in t&&(e=t.detail),"wheelDelta"in t&&(e=-t.wheelDelta/120),"wheelDeltaY"in t&&(e=-t.wheelDeltaY/120),"wheelDeltaX"in t&&(r=-t.wheelDeltaX/120),"axis"in t&&t.axis===t.HORIZONTAL_AXIS&&(r=e,e=0),n=r*O,g=e*O,"deltaY"in t&&(g=t.deltaY),"deltaX"in t&&(n=t.deltaX),(n||g)&&t.deltaMode&&(t.deltaMode==1?(n*=I,g*=I):(n*=P,g*=P)),n&&!r&&(r=n<1?-1:1),g&&!e&&(e=g<1?-1:1),{spinX:r,spinY:e,pixelX:n,pixelY:g}}T.getEventType=function(){return A.firefox()?"DOMMouseScroll":b("wheel")?"wheel":"mousewheel"};var Y=T;/**
* Checks if an event is supported in the current execution environment.
*
* NOTE: This will not work correctly for non-generic events such as `change`,
* `reset`, `load`, `error`, and `select`.
*
* Borrows from Modernizr.
*
* @param {string} eventNameSuffix Event name, e.g. "click".
* @param {?boolean} capture Check if the capture phase is supported.
* @return {boolean} True if the event is supported.
* @internal
* @license Modernizr 3.0.0pre (Custom Build) | MIT
*/const mousewheel=function(t,r){if(t&&t.addEventListener){const e=function(n){const g=Y(n);r&&Reflect.apply(r,this,[n,g])};t.addEventListener("wheel",e,{passive:!0})}},Mousewheel={beforeMount(t,r){mousewheel(t,r.value)}},cardProps=buildProps({header:{type:String,default:""},footer:{type:String,default:""},bodyStyle:{type:definePropType([String,Object,Array]),default:""},bodyClass:String,shadow:{type:String,values:["always","hover","never"],default:"always"}}),__default__$z=defineComponent({name:"ElCard"}),_sfc_main$$=defineComponent({...__default__$z,props:cardProps,setup(t){const r=useNamespace("card");return(e,n)=>(openBlock(),createElementBlock("div",{class:normalizeClass([unref(r).b(),unref(r).is(`${e.shadow}-shadow`)])},[e.$slots.header||e.header?(openBlock(),createElementBlock("div",{key:0,class:normalizeClass(unref(r).e("header"))},[renderSlot(e.$slots,"header",{},()=>[createTextVNode(toDisplayString(e.header),1)])],2)):createCommentVNode("v-if",!0),createBaseVNode("div",{class:normalizeClass([unref(r).e("body"),e.bodyClass]),style:normalizeStyle(e.bodyStyle)},[renderSlot(e.$slots,"default")],6),e.$slots.footer||e.footer?(openBlock(),createElementBlock("div",{key:1,class:normalizeClass(unref(r).e("footer"))},[renderSlot(e.$slots,"footer",{},()=>[createTextVNode(toDisplayString(e.footer),1)])],2)):createCommentVNode("v-if",!0)],2))}});var Card=_export_sfc$1(_sfc_main$$,[["__file","card.vue"]]);const ElCard=withInstall(Card),checkboxProps={modelValue:{type:[Number,String,Boolean],default:void 0},label:{type:[String,Boolean,Number,Object],default:void 0},indeterminate:Boolean,disabled:Boolean,checked:Boolean,name:{type:String,default:void 0},trueLabel:{type:[String,Number],default:void 0},falseLabel:{type:[String,Number],default:void 0},id:{type:String,default:void 0},controls:{type:String,default:void 0},border:Boolean,size:useSizeProp,tabindex:[String,Number],validateEvent:{type:Boolean,default:!0}},checkboxEmits={[UPDATE_MODEL_EVENT]:t=>isString$2(t)||isNumber$1(t)||isBoolean$1(t),change:t=>isString$2(t)||isNumber$1(t)||isBoolean$1(t)},checkboxGroupContextKey=Symbol("checkboxGroupContextKey"),useCheckboxDisabled=({model:t,isChecked:r})=>{const e=inject(checkboxGroupContextKey,void 0),n=computed(()=>{var y,i;const k=(y=e==null?void 0:e.max)==null?void 0:y.value,L=(i=e==null?void 0:e.min)==null?void 0:i.value;return!isUndefined$1(k)&&t.value.length>=k&&!r.value||!isUndefined$1(L)&&t.value.length<=L&&r.value});return{isDisabled:useFormDisabled(computed(()=>(e==null?void 0:e.disabled.value)||n.value)),isLimitDisabled:n}},useCheckboxEvent=(t,{model:r,isLimitExceeded:e,hasOwnLabel:n,isDisabled:g,isLabeledByFormItem:y})=>{const i=inject(checkboxGroupContextKey,void 0),{formItem:k}=useFormItem(),{emit:L}=getCurrentInstance();function $(le){var ue,ie;return le===t.trueLabel||le===!0?(ue=t.trueLabel)!=null?ue:!0:(ie=t.falseLabel)!=null?ie:!1}function V(le,ue){L("change",$(le),ue)}function z(le){if(e.value)return;const ue=le.target;L("change",$(ue.checked),le)}async function re(le){e.value||!n.value&&!g.value&&y.value&&(le.composedPath().some(ae=>ae.tagName==="LABEL")||(r.value=$([!1,t.falseLabel].includes(r.value)),await nextTick(),V(r.value,le)))}const oe=computed(()=>(i==null?void 0:i.validateEvent)||t.validateEvent);return watch(()=>t.modelValue,()=>{oe.value&&(k==null||k.validate("change").catch(le=>void 0))}),{handleChange:z,onClickRoot:re}},useCheckboxModel=t=>{const r=ref(!1),{emit:e}=getCurrentInstance(),n=inject(checkboxGroupContextKey,void 0),g=computed(()=>isUndefined$1(n)===!1),y=ref(!1),i=computed({get(){var k,L;return g.value?(k=n==null?void 0:n.modelValue)==null?void 0:k.value:(L=t.modelValue)!=null?L:r.value},set(k){var L,$;g.value&&isArray$3(k)?(y.value=((L=n==null?void 0:n.max)==null?void 0:L.value)!==void 0&&k.length>(n==null?void 0:n.max.value)&&k.length>i.value.length,y.value===!1&&(($=n==null?void 0:n.changeEvent)==null||$.call(n,k))):(e(UPDATE_MODEL_EVENT,k),r.value=k)}});return{model:i,isGroup:g,isLimitExceeded:y}},useCheckboxStatus=(t,r,{model:e})=>{const n=inject(checkboxGroupContextKey,void 0),g=ref(!1),y=computed(()=>{const $=e.value;return isBoolean$1($)?$:isArray$3($)?isObject$2(t.label)?$.map(toRaw).some(V=>isEqual(V,t.label)):$.map(toRaw).includes(t.label):$!=null?$===t.trueLabel:!!$}),i=useFormSize(computed(()=>{var $;return($=n==null?void 0:n.size)==null?void 0:$.value}),{prop:!0}),k=useFormSize(computed(()=>{var $;return($=n==null?void 0:n.size)==null?void 0:$.value})),L=computed(()=>!!r.default||!isNil(t.label));return{checkboxButtonSize:i,isChecked:y,isFocused:g,checkboxSize:k,hasOwnLabel:L}},setStoreValue=(t,{model:r})=>{function e(){isArray$3(r.value)&&!r.value.includes(t.label)?r.value.push(t.label):r.value=t.trueLabel||!0}t.checked&&e()},useCheckbox=(t,r)=>{const{formItem:e}=useFormItem(),{model:n,isGroup:g,isLimitExceeded:y}=useCheckboxModel(t),{isFocused:i,isChecked:k,checkboxButtonSize:L,checkboxSize:$,hasOwnLabel:V}=useCheckboxStatus(t,r,{model:n}),{isDisabled:z}=useCheckboxDisabled({model:n,isChecked:k}),{inputId:re,isLabeledByFormItem:oe}=useFormItemInputId(t,{formItemContext:e,disableIdGeneration:V,disableIdManagement:g}),{handleChange:le,onClickRoot:ue}=useCheckboxEvent(t,{model:n,isLimitExceeded:y,hasOwnLabel:V,isDisabled:z,isLabeledByFormItem:oe});return setStoreValue(t,{model:n}),{inputId:re,isLabeledByFormItem:oe,isChecked:k,isDisabled:z,isFocused:i,checkboxButtonSize:L,checkboxSize:$,hasOwnLabel:V,model:n,handleChange:le,onClickRoot:ue}},_hoisted_1$B=["id","indeterminate","name","tabindex","disabled","true-value","false-value"],_hoisted_2$n=["id","indeterminate","disabled","value","name","tabindex"],__default__$y=defineComponent({name:"ElCheckbox"}),_sfc_main$_=defineComponent({...__default__$y,props:checkboxProps,emits:checkboxEmits,setup(t){const r=t,e=useSlots(),{inputId:n,isLabeledByFormItem:g,isChecked:y,isDisabled:i,isFocused:k,checkboxSize:L,hasOwnLabel:$,model:V,handleChange:z,onClickRoot:re}=useCheckbox(r,e),oe=useNamespace("checkbox"),le=computed(()=>[oe.b(),oe.m(L.value),oe.is("disabled",i.value),oe.is("bordered",r.border),oe.is("checked",y.value)]),ue=computed(()=>[oe.e("input"),oe.is("disabled",i.value),oe.is("checked",y.value),oe.is("indeterminate",r.indeterminate),oe.is("focus",k.value)]);return(ie,ae)=>(openBlock(),createBlock(resolveDynamicComponent(!unref($)&&unref(g)?"span":"label"),{class:normalizeClass(unref(le)),"aria-controls":ie.indeterminate?ie.controls:null,onClick:unref(re)},{default:withCtx(()=>[createBaseVNode("span",{class:normalizeClass(unref(ue))},[ie.trueLabel||ie.falseLabel?withDirectives((openBlock(),createElementBlock("input",{key:0,id:unref(n),"onUpdate:modelValue":ae[0]||(ae[0]=Ie=>isRef(V)?V.value=Ie:null),class:normalizeClass(unref(oe).e("original")),type:"checkbox",indeterminate:ie.indeterminate,name:ie.name,tabindex:ie.tabindex,disabled:unref(i),"true-value":ie.trueLabel,"false-value":ie.falseLabel,onChange:ae[1]||(ae[1]=(...Ie)=>unref(z)&&unref(z)(...Ie)),onFocus:ae[2]||(ae[2]=Ie=>k.value=!0),onBlur:ae[3]||(ae[3]=Ie=>k.value=!1),onClick:ae[4]||(ae[4]=withModifiers(()=>{},["stop"]))},null,42,_hoisted_1$B)),[[vModelCheckbox,unref(V)]]):withDirectives((openBlock(),createElementBlock("input",{key:1,id:unref(n),"onUpdate:modelValue":ae[5]||(ae[5]=Ie=>isRef(V)?V.value=Ie:null),class:normalizeClass(unref(oe).e("original")),type:"checkbox",indeterminate:ie.indeterminate,disabled:unref(i),value:ie.label,name:ie.name,tabindex:ie.tabindex,onChange:ae[6]||(ae[6]=(...Ie)=>unref(z)&&unref(z)(...Ie)),onFocus:ae[7]||(ae[7]=Ie=>k.value=!0),onBlur:ae[8]||(ae[8]=Ie=>k.value=!1),onClick:ae[9]||(ae[9]=withModifiers(()=>{},["stop"]))},null,42,_hoisted_2$n)),[[vModelCheckbox,unref(V)]]),createBaseVNode("span",{class:normalizeClass(unref(oe).e("inner"))},null,2)],2),unref($)?(openBlock(),createElementBlock("span",{key:0,class:normalizeClass(unref(oe).e("label"))},[renderSlot(ie.$slots,"default"),ie.$slots.default?createCommentVNode("v-if",!0):(openBlock(),createElementBlock(Fragment,{key:0},[createTextVNode(toDisplayString(ie.label),1)],64))],2)):createCommentVNode("v-if",!0)]),_:3},8,["class","aria-controls","onClick"]))}});var Checkbox=_export_sfc$1(_sfc_main$_,[["__file","checkbox.vue"]]);const _hoisted_1$A=["name","tabindex","disabled","true-value","false-value"],_hoisted_2$m=["name","tabindex","disabled","value"],__default__$x=defineComponent({name:"ElCheckboxButton"}),_sfc_main$Z=defineComponent({...__default__$x,props:checkboxProps,emits:checkboxEmits,setup(t){const r=t,e=useSlots(),{isFocused:n,isChecked:g,isDisabled:y,checkboxButtonSize:i,model:k,handleChange:L}=useCheckbox(r,e),$=inject(checkboxGroupContextKey,void 0),V=useNamespace("checkbox"),z=computed(()=>{var oe,le,ue,ie;const ae=(le=(oe=$==null?void 0:$.fill)==null?void 0:oe.value)!=null?le:"";return{backgroundColor:ae,borderColor:ae,color:(ie=(ue=$==null?void 0:$.textColor)==null?void 0:ue.value)!=null?ie:"",boxShadow:ae?`-1px 0 0 0 ${ae}`:void 0}}),re=computed(()=>[V.b("button"),V.bm("button",i.value),V.is("disabled",y.value),V.is("checked",g.value),V.is("focus",n.value)]);return(oe,le)=>(openBlock(),createElementBlock("label",{class:normalizeClass(unref(re))},[oe.trueLabel||oe.falseLabel?withDirectives((openBlock(),createElementBlock("input",{key:0,"onUpdate:modelValue":le[0]||(le[0]=ue=>isRef(k)?k.value=ue:null),class:normalizeClass(unref(V).be("button","original")),type:"checkbox",name:oe.name,tabindex:oe.tabindex,disabled:unref(y),"true-value":oe.trueLabel,"false-value":oe.falseLabel,onChange:le[1]||(le[1]=(...ue)=>unref(L)&&unref(L)(...ue)),onFocus:le[2]||(le[2]=ue=>n.value=!0),onBlur:le[3]||(le[3]=ue=>n.value=!1),onClick:le[4]||(le[4]=withModifiers(()=>{},["stop"]))},null,42,_hoisted_1$A)),[[vModelCheckbox,unref(k)]]):withDirectives((openBlock(),createElementBlock("input",{key:1,"onUpdate:modelValue":le[5]||(le[5]=ue=>isRef(k)?k.value=ue:null),class:normalizeClass(unref(V).be("button","original")),type:"checkbox",name:oe.name,tabindex:oe.tabindex,disabled:unref(y),value:oe.label,onChange:le[6]||(le[6]=(...ue)=>unref(L)&&unref(L)(...ue)),onFocus:le[7]||(le[7]=ue=>n.value=!0),onBlur:le[8]||(le[8]=ue=>n.value=!1),onClick:le[9]||(le[9]=withModifiers(()=>{},["stop"]))},null,42,_hoisted_2$m)),[[vModelCheckbox,unref(k)]]),oe.$slots.default||oe.label?(openBlock(),createElementBlock("span",{key:2,class:normalizeClass(unref(V).be("button","inner")),style:normalizeStyle(unref(g)?unref(z):void 0)},[renderSlot(oe.$slots,"default",{},()=>[createTextVNode(toDisplayString(oe.label),1)])],6)):createCommentVNode("v-if",!0)],2))}});var CheckboxButton=_export_sfc$1(_sfc_main$Z,[["__file","checkbox-button.vue"]]);const checkboxGroupProps=buildProps({modelValue:{type:definePropType(Array),default:()=>[]},disabled:Boolean,min:Number,max:Number,size:useSizeProp,label:String,fill:String,textColor:String,tag:{type:String,default:"div"},validateEvent:{type:Boolean,default:!0}}),checkboxGroupEmits={[UPDATE_MODEL_EVENT]:t=>isArray$3(t),change:t=>isArray$3(t)},__default__$w=defineComponent({name:"ElCheckboxGroup"}),_sfc_main$Y=defineComponent({...__default__$w,props:checkboxGroupProps,emits:checkboxGroupEmits,setup(t,{emit:r}){const e=t,n=useNamespace("checkbox"),{formItem:g}=useFormItem(),{inputId:y,isLabeledByFormItem:i}=useFormItemInputId(e,{formItemContext:g}),k=async $=>{r(UPDATE_MODEL_EVENT,$),await nextTick(),r("change",$)},L=computed({get(){return e.modelValue},set($){k($)}});return provide(checkboxGroupContextKey,{...pick$1(toRefs(e),["size","min","max","disabled","validateEvent","fill","textColor"]),modelValue:L,changeEvent:k}),watch(()=>e.modelValue,()=>{e.validateEvent&&(g==null||g.validate("change").catch($=>void 0))}),($,V)=>{var z;return openBlock(),createBlock(resolveDynamicComponent($.tag),{id:unref(y),class:normalizeClass(unref(n).b("group")),role:"group","aria-label":unref(i)?void 0:$.label||"checkbox-group","aria-labelledby":unref(i)?(z=unref(g))==null?void 0:z.labelId:void 0},{default:withCtx(()=>[renderSlot($.$slots,"default")]),_:3},8,["id","class","aria-label","aria-labelledby"])}}});var CheckboxGroup=_export_sfc$1(_sfc_main$Y,[["__file","checkbox-group.vue"]]);const ElCheckbox=withInstall(Checkbox,{CheckboxButton,CheckboxGroup});withNoopInstall(CheckboxButton);const ElCheckboxGroup$1=withNoopInstall(CheckboxGroup),radioPropsBase=buildProps({size:useSizeProp,disabled:Boolean,label:{type:[String,Number,Boolean],default:""}}),radioProps=buildProps({...radioPropsBase,modelValue:{type:[String,Number,Boolean],default:""},name:{type:String,default:""},border:Boolean}),radioEmits={[UPDATE_MODEL_EVENT]:t=>isString$2(t)||isNumber$1(t)||isBoolean$1(t),[CHANGE_EVENT]:t=>isString$2(t)||isNumber$1(t)||isBoolean$1(t)},radioGroupKey=Symbol("radioGroupKey"),useRadio=(t,r)=>{const e=ref(),n=inject(radioGroupKey,void 0),g=computed(()=>!!n),y=computed({get(){return g.value?n.modelValue:t.modelValue},set(V){g.value?n.changeEvent(V):r&&r(UPDATE_MODEL_EVENT,V),e.value.checked=t.modelValue===t.label}}),i=useFormSize(computed(()=>n==null?void 0:n.size)),k=useFormDisabled(computed(()=>n==null?void 0:n.disabled)),L=ref(!1),$=computed(()=>k.value||g.value&&y.value!==t.label?-1:0);return{radioRef:e,isGroup:g,radioGroup:n,focus:L,size:i,disabled:k,tabIndex:$,modelValue:y}},_hoisted_1$z=["value","name","disabled"],__default__$v=defineComponent({name:"ElRadio"}),_sfc_main$X=defineComponent({...__default__$v,props:radioProps,emits:radioEmits,setup(t,{emit:r}){const e=t,n=useNamespace("radio"),{radioRef:g,radioGroup:y,focus:i,size:k,disabled:L,modelValue:$}=useRadio(e,r);function V(){nextTick(()=>r("change",$.value))}return(z,re)=>{var oe;return openBlock(),createElementBlock("label",{class:normalizeClass([unref(n).b(),unref(n).is("disabled",unref(L)),unref(n).is("focus",unref(i)),unref(n).is("bordered",z.border),unref(n).is("checked",unref($)===z.label),unref(n).m(unref(k))])},[createBaseVNode("span",{class:normalizeClass([unref(n).e("input"),unref(n).is("disabled",unref(L)),unref(n).is("checked",unref($)===z.label)])},[withDirectives(createBaseVNode("input",{ref_key:"radioRef",ref:g,"onUpdate:modelValue":re[0]||(re[0]=le=>isRef($)?$.value=le:null),class:normalizeClass(unref(n).e("original")),value:z.label,name:z.name||((oe=unref(y))==null?void 0:oe.name),disabled:unref(L),type:"radio",onFocus:re[1]||(re[1]=le=>i.value=!0),onBlur:re[2]||(re[2]=le=>i.value=!1),onChange:V,onClick:re[3]||(re[3]=withModifiers(()=>{},["stop"]))},null,42,_hoisted_1$z),[[vModelRadio,unref($)]]),createBaseVNode("span",{class:normalizeClass(unref(n).e("inner"))},null,2)],2),createBaseVNode("span",{class:normalizeClass(unref(n).e("label")),onKeydown:re[4]||(re[4]=withModifiers(()=>{},["stop"]))},[renderSlot(z.$slots,"default",{},()=>[createTextVNode(toDisplayString(z.label),1)])],34)],2)}}});var Radio=_export_sfc$1(_sfc_main$X,[["__file","radio.vue"]]);const radioButtonProps=buildProps({...radioPropsBase,name:{type:String,default:""}}),_hoisted_1$y=["value","name","disabled"],__default__$u=defineComponent({name:"ElRadioButton"}),_sfc_main$W=defineComponent({...__default__$u,props:radioButtonProps,setup(t){const r=t,e=useNamespace("radio"),{radioRef:n,focus:g,size:y,disabled:i,modelValue:k,radioGroup:L}=useRadio(r),$=computed(()=>({backgroundColor:(L==null?void 0:L.fill)||"",borderColor:(L==null?void 0:L.fill)||"",boxShadow:L!=null&&L.fill?`-1px 0 0 0 ${L.fill}`:"",color:(L==null?void 0:L.textColor)||""}));return(V,z)=>{var re;return openBlock(),createElementBlock("label",{class:normalizeClass([unref(e).b("button"),unref(e).is("active",unref(k)===V.label),unref(e).is("disabled",unref(i)),unref(e).is("focus",unref(g)),unref(e).bm("button",unref(y))])},[withDirectives(createBaseVNode("input",{ref_key:"radioRef",ref:n,"onUpdate:modelValue":z[0]||(z[0]=oe=>isRef(k)?k.value=oe:null),class:normalizeClass(unref(e).be("button","original-radio")),value:V.label,type:"radio",name:V.name||((re=unref(L))==null?void 0:re.name),disabled:unref(i),onFocus:z[1]||(z[1]=oe=>g.value=!0),onBlur:z[2]||(z[2]=oe=>g.value=!1),onClick:z[3]||(z[3]=withModifiers(()=>{},["stop"]))},null,42,_hoisted_1$y),[[vModelRadio,unref(k)]]),createBaseVNode("span",{class:normalizeClass(unref(e).be("button","inner")),style:normalizeStyle(unref(k)===V.label?unref($):{}),onKeydown:z[4]||(z[4]=withModifiers(()=>{},["stop"]))},[renderSlot(V.$slots,"default",{},()=>[createTextVNode(toDisplayString(V.label),1)])],38)],2)}}});var RadioButton=_export_sfc$1(_sfc_main$W,[["__file","radio-button.vue"]]);const radioGroupProps=buildProps({id:{type:String,default:void 0},size:useSizeProp,disabled:Boolean,modelValue:{type:[String,Number,Boolean],default:""},fill:{type:String,default:""},label:{type:String,default:void 0},textColor:{type:String,default:""},name:{type:String,default:void 0},validateEvent:{type:Boolean,default:!0}}),radioGroupEmits=radioEmits,_hoisted_1$x=["id","aria-label","aria-labelledby"],__default__$t=defineComponent({name:"ElRadioGroup"}),_sfc_main$V=defineComponent({...__default__$t,props:radioGroupProps,emits:radioGroupEmits,setup(t,{emit:r}){const e=t,n=useNamespace("radio"),g=useId(),y=ref(),{formItem:i}=useFormItem(),{inputId:k,isLabeledByFormItem:L}=useFormItemInputId(e,{formItemContext:i}),$=z=>{r(UPDATE_MODEL_EVENT,z),nextTick(()=>r("change",z))};onMounted(()=>{const z=y.value.querySelectorAll("[type=radio]"),re=z[0];!Array.from(z).some(oe=>oe.checked)&&re&&(re.tabIndex=0)});const V=computed(()=>e.name||g.value);return provide(radioGroupKey,reactive({...toRefs(e),changeEvent:$,name:V})),watch(()=>e.modelValue,()=>{e.validateEvent&&(i==null||i.validate("change").catch(z=>void 0))}),(z,re)=>(openBlock(),createElementBlock("div",{id:unref(k),ref_key:"radioGroupRef",ref:y,class:normalizeClass(unref(n).b("group")),role:"radiogroup","aria-label":unref(L)?void 0:z.label||"radio-group","aria-labelledby":unref(L)?unref(i).labelId:void 0},[renderSlot(z.$slots,"default")],10,_hoisted_1$x))}});var RadioGroup=_export_sfc$1(_sfc_main$V,[["__file","radio-group.vue"]]);const ElRadio=withInstall(Radio,{RadioButton,RadioGroup}),ElRadioGroup=withNoopInstall(RadioGroup);withNoopInstall(RadioButton);var NodeContent=defineComponent({name:"NodeContent",setup(){return{ns:useNamespace("cascader-node")}},render(){const{ns:t}=this,{node:r,panel:e}=this.$parent,{data:n,label:g}=r,{renderLabelFn:y}=e;return h$1("span",{class:t.e("label")},y?y({node:r,data:n}):g)}});const CASCADER_PANEL_INJECTION_KEY=Symbol(),_sfc_main$U=defineComponent({name:"ElCascaderNode",components:{ElCheckbox,ElRadio,NodeContent,ElIcon,Check:check_default,Loading:loading_default,ArrowRight:arrow_right_default},props:{node:{type:Object,required:!0},menuId:String},emits:["expand"],setup(t,{emit:r}){const e=inject(CASCADER_PANEL_INJECTION_KEY),n=useNamespace("cascader-node"),g=computed(()=>e.isHoverMenu),y=computed(()=>e.config.multiple),i=computed(()=>e.config.checkStrictly),k=computed(()=>{var qe;return(qe=e.checkedNodes[0])==null?void 0:qe.uid}),L=computed(()=>t.node.isDisabled),$=computed(()=>t.node.isLeaf),V=computed(()=>i.value&&!$.value||!L.value),z=computed(()=>oe(e.expandingNode)),re=computed(()=>i.value&&e.checkedNodes.some(oe)),oe=qe=>{var jt;const{level:Fe,uid:Et}=t.node;return((jt=qe==null?void 0:qe.pathNodes[Fe-1])==null?void 0:jt.uid)===Et},le=()=>{z.value||e.expandNode(t.node)},ue=qe=>{const{node:jt}=t;qe!==jt.checked&&e.handleCheckChange(jt,qe)},ie=()=>{e.lazyLoad(t.node,()=>{$.value||le()})},ae=qe=>{g.value&&(Ie(),!$.value&&r("expand",qe))},Ie=()=>{const{node:qe}=t;!V.value||qe.loading||(qe.loaded?le():ie())},de=()=>{g.value&&!$.value||($.value&&!L.value&&!i.value&&!y.value?Ue(!0):Ie())},Ce=qe=>{i.value?(ue(qe),t.node.loaded&&le()):Ue(qe)},Ue=qe=>{t.node.loaded?(ue(qe),!i.value&&le()):ie()};return{panel:e,isHoverMenu:g,multiple:y,checkStrictly:i,checkedNodeId:k,isDisabled:L,isLeaf:$,expandable:V,inExpandingPath:z,inCheckedPath:re,ns:n,handleHoverExpand:ae,handleExpand:Ie,handleClick:de,handleCheck:Ue,handleSelectCheck:Ce}}}),_hoisted_1$w=["id","aria-haspopup","aria-owns","aria-expanded","tabindex"],_hoisted_2$l=createBaseVNode("span",null,null,-1);function _sfc_render$c(t,r,e,n,g,y){const i=resolveComponent("el-checkbox"),k=resolveComponent("el-radio"),L=resolveComponent("check"),$=resolveComponent("el-icon"),V=resolveComponent("node-content"),z=resolveComponent("loading"),re=resolveComponent("arrow-right");return openBlock(),createElementBlock("li",{id:`${t.menuId}-${t.node.uid}`,role:"menuitem","aria-haspopup":!t.isLeaf,"aria-owns":t.isLeaf?null:t.menuId,"aria-expanded":t.inExpandingPath,tabindex:t.expandable?-1:void 0,class:normalizeClass([t.ns.b(),t.ns.is("selectable",t.checkStrictly),t.ns.is("active",t.node.checked),t.ns.is("disabled",!t.expandable),t.inExpandingPath&&"in-active-path",t.inCheckedPath&&"in-checked-path"]),onMouseenter:r[2]||(r[2]=(...oe)=>t.handleHoverExpand&&t.handleHoverExpand(...oe)),onFocus:r[3]||(r[3]=(...oe)=>t.handleHoverExpand&&t.handleHoverExpand(...oe)),onClick:r[4]||(r[4]=(...oe)=>t.handleClick&&t.handleClick(...oe))},[createCommentVNode(" prefix "),t.multiple?(openBlock(),createBlock(i,{key:0,"model-value":t.node.checked,indeterminate:t.node.indeterminate,disabled:t.isDisabled,onClick:r[0]||(r[0]=withModifiers(()=>{},["stop"])),"onUpdate:modelValue":t.handleSelectCheck},null,8,["model-value","indeterminate","disabled","onUpdate:modelValue"])):t.checkStrictly?(openBlock(),createBlock(k,{key:1,"model-value":t.checkedNodeId,label:t.node.uid,disabled:t.isDisabled,"onUpdate:modelValue":t.handleSelectCheck,onClick:r[1]||(r[1]=withModifiers(()=>{},["stop"]))},{default:withCtx(()=>[createCommentVNode(`
        Add an empty element to avoid render label,
        do not use empty fragment here for https://github.com/vuejs/vue-next/pull/2485
      `),_hoisted_2$l]),_:1},8,["model-value","label","disabled","onUpdate:modelValue"])):t.isLeaf&&t.node.checked?(openBlock(),createBlock($,{key:2,class:normalizeClass(t.ns.e("prefix"))},{default:withCtx(()=>[createVNode(L)]),_:1},8,["class"])):createCommentVNode("v-if",!0),createCommentVNode(" content "),createVNode(V),createCommentVNode(" postfix "),t.isLeaf?createCommentVNode("v-if",!0):(openBlock(),createElementBlock(Fragment,{key:3},[t.node.loading?(openBlock(),createBlock($,{key:0,class:normalizeClass([t.ns.is("loading"),t.ns.e("postfix")])},{default:withCtx(()=>[createVNode(z)]),_:1},8,["class"])):(openBlock(),createBlock($,{key:1,class:normalizeClass(["arrow-right",t.ns.e("postfix")])},{default:withCtx(()=>[createVNode(re)]),_:1},8,["class"]))],64))],42,_hoisted_1$w)}var ElCascaderNode=_export_sfc$1(_sfc_main$U,[["render",_sfc_render$c],["__file","node.vue"]]);const _sfc_main$T=defineComponent({name:"ElCascaderMenu",components:{Loading:loading_default,ElIcon,ElScrollbar,ElCascaderNode},props:{nodes:{type:Array,required:!0},index:{type:Number,required:!0}},setup(t){const r=getCurrentInstance(),e=useNamespace("cascader-menu"),{t:n}=useLocale(),g=useId();let y=null,i=null;const k=inject(CASCADER_PANEL_INJECTION_KEY),L=ref(null),$=computed(()=>!t.nodes.length),V=computed(()=>!k.initialLoaded),z=computed(()=>`${g.value}-${t.index}`),re=ie=>{y=ie.target},oe=ie=>{if(!(!k.isHoverMenu||!y||!L.value))if(y.contains(ie.target)){le();const ae=r.vnode.el,{left:Ie}=ae.getBoundingClientRect(),{offsetWidth:de,offsetHeight:Ce}=ae,Ue=ie.clientX-Ie,qe=y.offsetTop,jt=qe+y.offsetHeight;L.value.innerHTML=`
          <path style="pointer-events: auto;" fill="transparent" d="M${Ue} ${qe} L${de} 0 V${qe} Z" />
          <path style="pointer-events: auto;" fill="transparent" d="M${Ue} ${jt} L${de} ${Ce} V${jt} Z" />
        `}else i||(i=window.setTimeout(ue,k.config.hoverThreshold))},le=()=>{i&&(clearTimeout(i),i=null)},ue=()=>{L.value&&(L.value.innerHTML="",le())};return{ns:e,panel:k,hoverZone:L,isEmpty:$,isLoading:V,menuId:z,t:n,handleExpand:re,handleMouseMove:oe,clearHoverZone:ue}}});function _sfc_render$b(t,r,e,n,g,y){const i=resolveComponent("el-cascader-node"),k=resolveComponent("loading"),L=resolveComponent("el-icon"),$=resolveComponent("el-scrollbar");return openBlock(),createBlock($,{key:t.menuId,tag:"ul",role:"menu",class:normalizeClass(t.ns.b()),"wrap-class":t.ns.e("wrap"),"view-class":[t.ns.e("list"),t.ns.is("empty",t.isEmpty)],onMousemove:t.handleMouseMove,onMouseleave:t.clearHoverZone},{default:withCtx(()=>{var V;return[(openBlock(!0),createElementBlock(Fragment,null,renderList(t.nodes,z=>(openBlock(),createBlock(i,{key:z.uid,node:z,"menu-id":t.menuId,onExpand:t.handleExpand},null,8,["node","menu-id","onExpand"]))),128)),t.isLoading?(openBlock(),createElementBlock("div",{key:0,class:normalizeClass(t.ns.e("empty-text"))},[createVNode(L,{size:"14",class:normalizeClass(t.ns.is("loading"))},{default:withCtx(()=>[createVNode(k)]),_:1},8,["class"]),createTextVNode(" "+toDisplayString(t.t("el.cascader.loading")),1)],2)):t.isEmpty?(openBlock(),createElementBlock("div",{key:1,class:normalizeClass(t.ns.e("empty-text"))},toDisplayString(t.t("el.cascader.noData")),3)):(V=t.panel)!=null&&V.isHoverMenu?(openBlock(),createElementBlock("svg",{key:2,ref:"hoverZone",class:normalizeClass(t.ns.e("hover-zone"))},null,2)):createCommentVNode("v-if",!0)]}),_:1},8,["class","wrap-class","view-class","onMousemove","onMouseleave"])}var ElCascaderMenu=_export_sfc$1(_sfc_main$T,[["render",_sfc_render$b],["__file","menu.vue"]]);let uid=0;const calculatePathNodes=t=>{const r=[t];let{parent:e}=t;for(;e;)r.unshift(e),e=e.parent;return r};class Node{constructor(r,e,n,g=!1){this.data=r,this.config=e,this.parent=n,this.root=g,this.uid=uid++,this.checked=!1,this.indeterminate=!1,this.loading=!1;const{value:y,label:i,children:k}=e,L=r[k],$=calculatePathNodes(this);this.level=g?0:n?n.level+1:1,this.value=r[y],this.label=r[i],this.pathNodes=$,this.pathValues=$.map(V=>V.value),this.pathLabels=$.map(V=>V.label),this.childrenData=L,this.children=(L||[]).map(V=>new Node(V,e,this)),this.loaded=!e.lazy||this.isLeaf||!isEmpty(L)}get isDisabled(){const{data:r,parent:e,config:n}=this,{disabled:g,checkStrictly:y}=n;return(isFunction$3(g)?g(r,this):!!r[g])||!y&&(e==null?void 0:e.isDisabled)}get isLeaf(){const{data:r,config:e,childrenData:n,loaded:g}=this,{lazy:y,leaf:i}=e,k=isFunction$3(i)?i(r,this):r[i];return isUndefined$1(k)?y&&!g?!1:!(Array.isArray(n)&&n.length):!!k}get valueByOption(){return this.config.emitPath?this.pathValues:this.value}appendChild(r){const{childrenData:e,children:n}=this,g=new Node(r,this.config,this);return Array.isArray(e)?e.push(r):this.childrenData=[r],n.push(g),g}calcText(r,e){const n=r?this.pathLabels.join(e):this.label;return this.text=n,n}broadcast(r,...e){const n=`onParent${capitalize(r)}`;this.children.forEach(g=>{g&&(g.broadcast(r,...e),g[n]&&g[n](...e))})}emit(r,...e){const{parent:n}=this,g=`onChild${capitalize(r)}`;n&&(n[g]&&n[g](...e),n.emit(r,...e))}onParentCheck(r){this.isDisabled||this.setCheckState(r)}onChildCheck(){const{children:r}=this,e=r.filter(g=>!g.isDisabled),n=e.length?e.every(g=>g.checked):!1;this.setCheckState(n)}setCheckState(r){const e=this.children.length,n=this.children.reduce((g,y)=>{const i=y.checked?1:y.indeterminate?.5:0;return g+i},0);this.checked=this.loaded&&this.children.filter(g=>!g.isDisabled).every(g=>g.loaded&&g.checked)&&r,this.indeterminate=this.loaded&&n!==e&&n>0}doCheck(r){if(this.checked===r)return;const{checkStrictly:e,multiple:n}=this.config;e||!n?this.checked=r:(this.broadcast("check",r),this.setCheckState(r),this.emit("check"))}}const flatNodes=(t,r)=>t.reduce((e,n)=>(n.isLeaf?e.push(n):(!r&&e.push(n),e=e.concat(flatNodes(n.children,r))),e),[]);class Store{constructor(r,e){this.config=e;const n=(r||[]).map(g=>new Node(g,this.config));this.nodes=n,this.allNodes=flatNodes(n,!1),this.leafNodes=flatNodes(n,!0)}getNodes(){return this.nodes}getFlattedNodes(r){return r?this.leafNodes:this.allNodes}appendNode(r,e){const n=e?e.appendChild(r):new Node(r,this.config);e||this.nodes.push(n),this.allNodes.push(n),n.isLeaf&&this.leafNodes.push(n)}appendNodes(r,e){r.forEach(n=>this.appendNode(n,e))}getNodeByValue(r,e=!1){return!r&&r!==0?null:this.getFlattedNodes(e).find(g=>isEqual(g.value,r)||isEqual(g.pathValues,r))||null}getSameNode(r){return r&&this.getFlattedNodes(!1).find(({value:n,level:g})=>isEqual(r.value,n)&&r.level===g)||null}}const CommonProps=buildProps({modelValue:{type:definePropType([Number,String,Array])},options:{type:definePropType(Array),default:()=>[]},props:{type:definePropType(Object),default:()=>({})}}),DefaultProps={expandTrigger:"click",multiple:!1,checkStrictly:!1,emitPath:!0,lazy:!1,lazyLoad:NOOP,value:"value",label:"label",children:"children",leaf:"leaf",disabled:"disabled",hoverThreshold:500},useCascaderConfig=t=>computed(()=>({...DefaultProps,...t.props})),getMenuIndex=t=>{if(!t)return 0;const r=t.id.split("-");return Number(r[r.length-2])},checkNode=t=>{if(!t)return;const r=t.querySelector("input");r?r.click():isLeaf(t)&&t.click()},sortByOriginalOrder=(t,r)=>{const e=r.slice(0),n=e.map(y=>y.uid),g=t.reduce((y,i)=>{const k=n.indexOf(i.uid);return k>-1&&(y.push(i),e.splice(k,1),n.splice(k,1)),y},[]);return g.push(...e),g},_sfc_main$S=defineComponent({name:"ElCascaderPanel",components:{ElCascaderMenu},props:{...CommonProps,border:{type:Boolean,default:!0},renderLabel:Function},emits:[UPDATE_MODEL_EVENT,CHANGE_EVENT,"close","expand-change"],setup(t,{emit:r,slots:e}){let n=!1;const g=useNamespace("cascader"),y=useCascaderConfig(t);let i=null;const k=ref(!0),L=ref([]),$=ref(null),V=ref([]),z=ref(null),re=ref([]),oe=computed(()=>y.value.expandTrigger==="hover"),le=computed(()=>t.renderLabel||e.default),ue=()=>{const{options:nr}=t,dr=y.value;n=!1,i=new Store(nr,dr),V.value=[i.getNodes()],dr.lazy&&isEmpty(t.options)?(k.value=!1,ie(void 0,ir=>{ir&&(i=new Store(ir,dr),V.value=[i.getNodes()]),k.value=!0,Fe(!1,!0)})):Fe(!1,!0)},ie=(nr,dr)=>{const ir=y.value;nr=nr||new Node({},ir,void 0,!0),nr.loading=!0;const tr=ur=>{const or=nr,fr=or.root?null:or;ur&&(i==null||i.appendNodes(ur,fr)),or.loading=!1,or.loaded=!0,or.childrenData=or.childrenData||[],dr&&dr(ur)};ir.lazyLoad(nr,tr)},ae=(nr,dr)=>{var ir;const{level:tr}=nr,ur=V.value.slice(0,tr);let or;nr.isLeaf?or=nr.pathNodes[tr-2]:(or=nr,ur.push(nr.children)),((ir=z.value)==null?void 0:ir.uid)!==(or==null?void 0:or.uid)&&(z.value=nr,V.value=ur,!dr&&r("expand-change",(nr==null?void 0:nr.pathValues)||[]))},Ie=(nr,dr,ir=!0)=>{const{checkStrictly:tr,multiple:ur}=y.value,or=re.value[0];n=!0,!ur&&(or==null||or.doCheck(!1)),nr.doCheck(dr),jt(),ir&&!ur&&!tr&&r("close"),!ir&&!ur&&!tr&&de(nr)},de=nr=>{nr&&(nr=nr.parent,de(nr),nr&&ae(nr))},Ce=nr=>i==null?void 0:i.getFlattedNodes(nr),Ue=nr=>{var dr;return(dr=Ce(nr))==null?void 0:dr.filter(ir=>ir.checked!==!1)},qe=()=>{re.value.forEach(nr=>nr.doCheck(!1)),jt(),V.value=V.value.slice(0,1),z.value=null,r("expand-change",[])},jt=()=>{var nr;const{checkStrictly:dr,multiple:ir}=y.value,tr=re.value,ur=Ue(!dr),or=sortByOriginalOrder(tr,ur),fr=or.map(lr=>lr.valueByOption);re.value=or,$.value=ir?fr:(nr=fr[0])!=null?nr:null},Fe=(nr=!1,dr=!1)=>{const{modelValue:ir}=t,{lazy:tr,multiple:ur,checkStrictly:or}=y.value,fr=!or;if(!(!k.value||n||!dr&&isEqual(ir,$.value)))if(tr&&!nr){const gr=unique(flattenDeep(castArray(ir))).map(Sr=>i==null?void 0:i.getNodeByValue(Sr)).filter(Sr=>!!Sr&&!Sr.loaded&&!Sr.loading);gr.length?gr.forEach(Sr=>{ie(Sr,()=>Fe(!1,dr))}):Fe(!0,dr)}else{const lr=ur?castArray(ir):[ir],gr=unique(lr.map(Sr=>i==null?void 0:i.getNodeByValue(Sr,fr)));Et(gr,dr),$.value=cloneDeep(ir)}},Et=(nr,dr=!0)=>{const{checkStrictly:ir}=y.value,tr=re.value,ur=nr.filter(lr=>!!lr&&(ir||lr.isLeaf)),or=i==null?void 0:i.getSameNode(z.value),fr=dr&&or||ur[0];fr?fr.pathNodes.forEach(lr=>ae(lr,!0)):z.value=null,tr.forEach(lr=>lr.doCheck(!1)),t.props.multiple?reactive(ur).forEach(lr=>lr.doCheck(!0)):ur.forEach(lr=>lr.doCheck(!0)),re.value=ur,nextTick(cr)},cr=()=>{isClient&&L.value.forEach(nr=>{const dr=nr==null?void 0:nr.$el;if(dr){const ir=dr.querySelector(`.${g.namespace.value}-scrollbar__wrap`),tr=dr.querySelector(`.${g.b("node")}.${g.is("active")}`)||dr.querySelector(`.${g.b("node")}.in-active-path`);scrollIntoView(ir,tr)}})},er=nr=>{const dr=nr.target,{code:ir}=nr;switch(ir){case EVENT_CODE.up:case EVENT_CODE.down:{nr.preventDefault();const tr=ir===EVENT_CODE.up?-1:1;focusNode(getSibling(dr,tr,`.${g.b("node")}[tabindex="-1"]`));break}case EVENT_CODE.left:{nr.preventDefault();const tr=L.value[getMenuIndex(dr)-1],ur=tr==null?void 0:tr.$el.querySelector(`.${g.b("node")}[aria-expanded="true"]`);focusNode(ur);break}case EVENT_CODE.right:{nr.preventDefault();const tr=L.value[getMenuIndex(dr)+1],ur=tr==null?void 0:tr.$el.querySelector(`.${g.b("node")}[tabindex="-1"]`);focusNode(ur);break}case EVENT_CODE.enter:checkNode(dr);break}};return provide(CASCADER_PANEL_INJECTION_KEY,reactive({config:y,expandingNode:z,checkedNodes:re,isHoverMenu:oe,initialLoaded:k,renderLabelFn:le,lazyLoad:ie,expandNode:ae,handleCheckChange:Ie})),watch([y,()=>t.options],ue,{deep:!0,immediate:!0}),watch(()=>t.modelValue,()=>{n=!1,Fe()},{deep:!0}),watch(()=>$.value,nr=>{isEqual(nr,t.modelValue)||(r(UPDATE_MODEL_EVENT,nr),r(CHANGE_EVENT,nr))}),onBeforeUpdate(()=>L.value=[]),onMounted(()=>!isEmpty(t.modelValue)&&Fe()),{ns:g,menuList:L,menus:V,checkedNodes:re,handleKeyDown:er,handleCheckChange:Ie,getFlattedNodes:Ce,getCheckedNodes:Ue,clearCheckedNodes:qe,calculateCheckedValue:jt,scrollToExpandingNode:cr}}});function _sfc_render$a(t,r,e,n,g,y){const i=resolveComponent("el-cascader-menu");return openBlock(),createElementBlock("div",{class:normalizeClass([t.ns.b("panel"),t.ns.is("bordered",t.border)]),onKeydown:r[0]||(r[0]=(...k)=>t.handleKeyDown&&t.handleKeyDown(...k))},[(openBlock(!0),createElementBlock(Fragment,null,renderList(t.menus,(k,L)=>(openBlock(),createBlock(i,{key:L,ref_for:!0,ref:$=>t.menuList[L]=$,index:L,nodes:[...k]},null,8,["index","nodes"]))),128))],34)}var CascaderPanel=_export_sfc$1(_sfc_main$S,[["render",_sfc_render$a],["__file","index.vue"]]);CascaderPanel.install=t=>{t.component(CascaderPanel.name,CascaderPanel)};const _CascaderPanel=CascaderPanel,tagProps=buildProps({type:{type:String,values:["primary","success","info","warning","danger"],default:"primary"},closable:Boolean,disableTransitions:Boolean,hit:Boolean,color:String,size:{type:String,values:componentSizes},effect:{type:String,values:["dark","light","plain"],default:"light"},round:Boolean}),tagEmits={close:t=>t instanceof MouseEvent,click:t=>t instanceof MouseEvent},__default__$s=defineComponent({name:"ElTag"}),_sfc_main$R=defineComponent({...__default__$s,props:tagProps,emits:tagEmits,setup(t,{emit:r}){const e=t,n=useFormSize(),g=useNamespace("tag"),y=computed(()=>{const{type:L,hit:$,effect:V,closable:z,round:re}=e;return[g.b(),g.is("closable",z),g.m(L||"primary"),g.m(n.value),g.m(V),g.is("hit",$),g.is("round",re)]}),i=L=>{r("close",L)},k=L=>{r("click",L)};return(L,$)=>L.disableTransitions?(openBlock(),createElementBlock("span",{key:0,class:normalizeClass(unref(y)),style:normalizeStyle({backgroundColor:L.color}),onClick:k},[createBaseVNode("span",{class:normalizeClass(unref(g).e("content"))},[renderSlot(L.$slots,"default")],2),L.closable?(openBlock(),createBlock(unref(ElIcon),{key:0,class:normalizeClass(unref(g).e("close")),onClick:withModifiers(i,["stop"])},{default:withCtx(()=>[createVNode(unref(close_default))]),_:1},8,["class","onClick"])):createCommentVNode("v-if",!0)],6)):(openBlock(),createBlock(Transition,{key:1,name:`${unref(g).namespace.value}-zoom-in-center`,appear:""},{default:withCtx(()=>[createBaseVNode("span",{class:normalizeClass(unref(y)),style:normalizeStyle({backgroundColor:L.color}),onClick:k},[createBaseVNode("span",{class:normalizeClass(unref(g).e("content"))},[renderSlot(L.$slots,"default")],2),L.closable?(openBlock(),createBlock(unref(ElIcon),{key:0,class:normalizeClass(unref(g).e("close")),onClick:withModifiers(i,["stop"])},{default:withCtx(()=>[createVNode(unref(close_default))]),_:1},8,["class","onClick"])):createCommentVNode("v-if",!0)],6)]),_:3},8,["name"]))}});var Tag=_export_sfc$1(_sfc_main$R,[["__file","tag.vue"]]);const ElTag=withInstall(Tag),cascaderProps=buildProps({...CommonProps,size:useSizeProp,placeholder:String,disabled:Boolean,clearable:Boolean,filterable:Boolean,filterMethod:{type:definePropType(Function),default:(t,r)=>t.text.includes(r)},separator:{type:String,default:" / "},showAllLevels:{type:Boolean,default:!0},collapseTags:Boolean,maxCollapseTags:{type:Number,default:1},collapseTagsTooltip:{type:Boolean,default:!1},debounce:{type:Number,default:300},beforeFilter:{type:definePropType(Function),default:()=>!0},popperClass:{type:String,default:""},teleported:useTooltipContentProps.teleported,tagType:{...tagProps.type,default:"info"},validateEvent:{type:Boolean,default:!0}}),cascaderEmits={[UPDATE_MODEL_EVENT]:t=>!!t||t===null,[CHANGE_EVENT]:t=>!!t||t===null,focus:t=>t instanceof FocusEvent,blur:t=>t instanceof FocusEvent,visibleChange:t=>isBoolean$1(t),expandChange:t=>!!t,removeTag:t=>!!t},_hoisted_1$v={key:0},_hoisted_2$k=["placeholder","onKeydown"],_hoisted_3$c=["onClick"],COMPONENT_NAME$6="ElCascader",__default__$r=defineComponent({name:COMPONENT_NAME$6}),_sfc_main$Q=defineComponent({...__default__$r,props:cascaderProps,emits:cascaderEmits,setup(t,{expose:r,emit:e}){const n=t,g={modifiers:[{name:"arrowPosition",enabled:!0,phase:"main",fn:({state:bn})=>{const{modifiersData:hn,placement:Zn}=bn;["right","left","bottom","top"].includes(Zn)||(hn.arrow.x=35)},requires:["arrow"]}]},y=useAttrs$1();let i=0,k=0;const L=useNamespace("cascader"),$=useNamespace("input"),{t:V}=useLocale(),{form:z,formItem:re}=useFormItem(),oe=ref(null),le=ref(null),ue=ref(null),ie=ref(null),ae=ref(null),Ie=ref(!1),de=ref(!1),Ce=ref(!1),Ue=ref(!1),qe=ref(""),jt=ref(""),Fe=ref([]),Et=ref([]),cr=ref([]),er=ref(!1),nr=computed(()=>y.style),dr=computed(()=>n.disabled||(z==null?void 0:z.disabled)),ir=computed(()=>n.placeholder||V("el.cascader.placeholder")),tr=computed(()=>jt.value||Fe.value.length>0||er.value?"":ir.value),ur=useFormSize(),or=computed(()=>["small"].includes(ur.value)?"small":"default"),fr=computed(()=>!!n.props.multiple),lr=computed(()=>!n.filterable||fr.value),gr=computed(()=>fr.value?jt.value:qe.value),Sr=computed(()=>{var bn;return((bn=ie.value)==null?void 0:bn.checkedNodes)||[]}),wr=computed(()=>!n.clearable||dr.value||Ce.value||!de.value?!1:!!Sr.value.length),kr=computed(()=>{const{showAllLevels:bn,separator:hn}=n,Zn=Sr.value;return Zn.length?fr.value?"":Zn[0].calcText(bn,hn):""}),mr=computed({get(){return cloneDeep(n.modelValue)},set(bn){e(UPDATE_MODEL_EVENT,bn),e(CHANGE_EVENT,bn),n.validateEvent&&(re==null||re.validate("change").catch(hn=>void 0))}}),Ir=computed(()=>[L.b(),L.m(ur.value),L.is("disabled",dr.value),y.class]),Nr=computed(()=>[$.e("icon"),"icon-arrow-down",L.is("reverse",Ie.value)]),Er=computed(()=>L.is("focus",Ie.value||Ue.value)),sr=computed(()=>{var bn,hn;return(hn=(bn=oe.value)==null?void 0:bn.popperRef)==null?void 0:hn.contentRef}),xr=bn=>{var hn,Zn,Oo;dr.value||(bn=bn??!Ie.value,bn!==Ie.value&&(Ie.value=bn,(Zn=(hn=le.value)==null?void 0:hn.input)==null||Zn.setAttribute("aria-expanded",`${bn}`),bn?(Or(),nextTick((Oo=ie.value)==null?void 0:Oo.scrollToExpandingNode)):n.filterable&&Yr(),e("visibleChange",bn)))},Or=()=>{nextTick(()=>{var bn;(bn=oe.value)==null||bn.updatePopper()})},Mr=()=>{Ce.value=!1},br=bn=>{const{showAllLevels:hn,separator:Zn}=n;return{node:bn,key:bn.uid,text:bn.calcText(hn,Zn),hitState:!1,closable:!dr.value&&!bn.isDisabled,isCollapseTag:!1}},hr=bn=>{var hn;const Zn=bn.node;Zn.doCheck(!1),(hn=ie.value)==null||hn.calculateCheckedValue(),e("removeTag",Zn.valueByOption)},Tr=()=>{if(!fr.value)return;const bn=Sr.value,hn=[],Zn=[];if(bn.forEach(Oo=>Zn.push(br(Oo))),Et.value=Zn,bn.length){bn.slice(0,n.maxCollapseTags).forEach(Do=>hn.push(br(Do)));const Oo=bn.slice(n.maxCollapseTags),Ho=Oo.length;Ho&&(n.collapseTags?hn.push({key:-1,text:`+ ${Ho}`,closable:!1,isCollapseTag:!0}):Oo.forEach(Do=>hn.push(br(Do))))}Fe.value=hn},Br=()=>{var bn,hn;const{filterMethod:Zn,showAllLevels:Oo,separator:Ho}=n,Do=(hn=(bn=ie.value)==null?void 0:bn.getFlattedNodes(!n.props.checkStrictly))==null?void 0:hn.filter(Eo=>Eo.isDisabled?!1:(Eo.calcText(Oo,Ho),Zn(Eo,gr.value)));fr.value&&(Fe.value.forEach(Eo=>{Eo.hitState=!1}),Et.value.forEach(Eo=>{Eo.hitState=!1})),Ce.value=!0,cr.value=Do,Or()},Fr=()=>{var bn;let hn;Ce.value&&ae.value?hn=ae.value.$el.querySelector(`.${L.e("suggestion-item")}`):hn=(bn=ie.value)==null?void 0:bn.$el.querySelector(`.${L.b("node")}[tabindex="-1"]`),hn&&(hn.focus(),!Ce.value&&hn.click())},Lr=()=>{var bn,hn;const Zn=(bn=le.value)==null?void 0:bn.input,Oo=ue.value,Ho=(hn=ae.value)==null?void 0:hn.$el;if(!(!isClient||!Zn)){if(Ho){const Do=Ho.querySelector(`.${L.e("suggestion-list")}`);Do.style.minWidth=`${Zn.offsetWidth}px`}if(Oo){const{offsetHeight:Do}=Oo,Eo=Fe.value.length>0?`${Math.max(Do+6,i)}px`:`${i}px`;Zn.style.height=Eo,Or()}}},qr=bn=>{var hn;return(hn=ie.value)==null?void 0:hn.getCheckedNodes(bn)},Ur=bn=>{Or(),e("expandChange",bn)},Qr=bn=>{var hn;const Zn=(hn=bn.target)==null?void 0:hn.value;if(bn.type==="compositionend")er.value=!1,nextTick(()=>wn(Zn));else{const Oo=Zn[Zn.length-1]||"";er.value=!isKorean(Oo)}},vn=bn=>{if(!er.value)switch(bn.code){case EVENT_CODE.enter:xr();break;case EVENT_CODE.down:xr(!0),nextTick(Fr),bn.preventDefault();break;case EVENT_CODE.esc:Ie.value===!0&&(bn.preventDefault(),bn.stopPropagation(),xr(!1));break;case EVENT_CODE.tab:xr(!1);break}},_n=()=>{var bn;(bn=ie.value)==null||bn.clearCheckedNodes(),!Ie.value&&n.filterable&&Yr(),xr(!1)},Yr=()=>{const{value:bn}=kr;qe.value=bn,jt.value=bn},jn=bn=>{var hn,Zn;const{checked:Oo}=bn;fr.value?(hn=ie.value)==null||hn.handleCheckChange(bn,!Oo,!1):(!Oo&&((Zn=ie.value)==null||Zn.handleCheckChange(bn,!0,!1)),xr(!1))},Zr=bn=>{const hn=bn.target,{code:Zn}=bn;switch(Zn){case EVENT_CODE.up:case EVENT_CODE.down:{const Oo=Zn===EVENT_CODE.up?-1:1;focusNode(getSibling(hn,Oo,`.${L.e("suggestion-item")}[tabindex="-1"]`));break}case EVENT_CODE.enter:hn.click();break}},An=()=>{const bn=Fe.value,hn=bn[bn.length-1];k=jt.value?0:k+1,!(!hn||!k||n.collapseTags&&bn.length>1)&&(hn.hitState?hr(hn):hn.hitState=!0)},Jr=bn=>{const hn=bn.target,Zn=L.e("search-input");hn.className===Zn&&(Ue.value=!0),e("focus",bn)},Mn=bn=>{Ue.value=!1,e("blur",bn)},Bn=debounce(()=>{const{value:bn}=gr;if(!bn)return;const hn=n.beforeFilter(bn);isPromise(hn)?hn.then(Br).catch(()=>{}):hn!==!1?Br():Mr()},n.debounce),wn=(bn,hn)=>{!Ie.value&&xr(!0),!(hn!=null&&hn.isComposing)&&(bn?Bn():Mr())},In=bn=>Number.parseFloat(useCssVar($.cssVarName("input-height"),bn).value)-2;return watch(Ce,Or),watch([Sr,dr],Tr),watch(Fe,()=>{nextTick(()=>Lr())}),watch(ur,async()=>{await nextTick();const bn=le.value.input;i=In(bn)||i,Lr()}),watch(kr,Yr,{immediate:!0}),onMounted(()=>{const bn=le.value.input,hn=In(bn);i=bn.offsetHeight||hn,useResizeObserver(bn,Lr)}),r({getCheckedNodes:qr,cascaderPanelRef:ie,togglePopperVisible:xr,contentRef:sr}),(bn,hn)=>(openBlock(),createBlock(unref(ElTooltip),{ref_key:"tooltipRef",ref:oe,visible:Ie.value,teleported:bn.teleported,"popper-class":[unref(L).e("dropdown"),bn.popperClass],"popper-options":g,"fallback-placements":["bottom-start","bottom","top-start","top","right","left"],"stop-popper-mouse-event":!1,"gpu-acceleration":!1,placement:"bottom-start",transition:`${unref(L).namespace.value}-zoom-in-top`,effect:"light",pure:"",persistent:"",onHide:Mr},{default:withCtx(()=>[withDirectives((openBlock(),createElementBlock("div",{class:normalizeClass(unref(Ir)),style:normalizeStyle(unref(nr)),onClick:hn[5]||(hn[5]=()=>xr(unref(lr)?void 0:!0)),onKeydown:vn,onMouseenter:hn[6]||(hn[6]=Zn=>de.value=!0),onMouseleave:hn[7]||(hn[7]=Zn=>de.value=!1)},[createVNode(unref(ElInput),{ref_key:"input",ref:le,modelValue:qe.value,"onUpdate:modelValue":hn[1]||(hn[1]=Zn=>qe.value=Zn),placeholder:unref(tr),readonly:unref(lr),disabled:unref(dr),"validate-event":!1,size:unref(ur),class:normalizeClass(unref(Er)),tabindex:unref(fr)&&bn.filterable&&!unref(dr)?-1:void 0,onCompositionstart:Qr,onCompositionupdate:Qr,onCompositionend:Qr,onFocus:Jr,onBlur:Mn,onInput:wn},{suffix:withCtx(()=>[unref(wr)?(openBlock(),createBlock(unref(ElIcon),{key:"clear",class:normalizeClass([unref($).e("icon"),"icon-circle-close"]),onClick:withModifiers(_n,["stop"])},{default:withCtx(()=>[createVNode(unref(circle_close_default))]),_:1},8,["class","onClick"])):(openBlock(),createBlock(unref(ElIcon),{key:"arrow-down",class:normalizeClass(unref(Nr)),onClick:hn[0]||(hn[0]=withModifiers(Zn=>xr(),["stop"]))},{default:withCtx(()=>[createVNode(unref(arrow_down_default))]),_:1},8,["class"]))]),_:1},8,["modelValue","placeholder","readonly","disabled","size","class","tabindex"]),unref(fr)?(openBlock(),createElementBlock("div",{key:0,ref_key:"tagWrapper",ref:ue,class:normalizeClass(unref(L).e("tags"))},[(openBlock(!0),createElementBlock(Fragment,null,renderList(Fe.value,Zn=>(openBlock(),createBlock(unref(ElTag),{key:Zn.key,type:bn.tagType,size:unref(or),hit:Zn.hitState,closable:Zn.closable,"disable-transitions":"",onClose:Oo=>hr(Zn)},{default:withCtx(()=>[Zn.isCollapseTag===!1?(openBlock(),createElementBlock("span",_hoisted_1$v,toDisplayString(Zn.text),1)):(openBlock(),createBlock(unref(ElTooltip),{key:1,disabled:Ie.value||!bn.collapseTagsTooltip,"fallback-placements":["bottom","top","right","left"],placement:"bottom",effect:"light"},{default:withCtx(()=>[createBaseVNode("span",null,toDisplayString(Zn.text),1)]),content:withCtx(()=>[createBaseVNode("div",{class:normalizeClass(unref(L).e("collapse-tags"))},[(openBlock(!0),createElementBlock(Fragment,null,renderList(Et.value.slice(bn.maxCollapseTags),(Oo,Ho)=>(openBlock(),createElementBlock("div",{key:Ho,class:normalizeClass(unref(L).e("collapse-tag"))},[(openBlock(),createBlock(unref(ElTag),{key:Oo.key,class:"in-tooltip",type:bn.tagType,size:unref(or),hit:Oo.hitState,closable:Oo.closable,"disable-transitions":"",onClose:Do=>hr(Oo)},{default:withCtx(()=>[createBaseVNode("span",null,toDisplayString(Oo.text),1)]),_:2},1032,["type","size","hit","closable","onClose"]))],2))),128))],2)]),_:2},1032,["disabled"]))]),_:2},1032,["type","size","hit","closable","onClose"]))),128)),bn.filterable&&!unref(dr)?withDirectives((openBlock(),createElementBlock("input",{key:0,"onUpdate:modelValue":hn[2]||(hn[2]=Zn=>jt.value=Zn),type:"text",class:normalizeClass(unref(L).e("search-input")),placeholder:unref(kr)?"":unref(ir),onInput:hn[3]||(hn[3]=Zn=>wn(jt.value,Zn)),onClick:hn[4]||(hn[4]=withModifiers(Zn=>xr(!0),["stop"])),onKeydown:withKeys(An,["delete"]),onCompositionstart:Qr,onCompositionupdate:Qr,onCompositionend:Qr,onFocus:Jr,onBlur:Mn},null,42,_hoisted_2$k)),[[vModelText,jt.value]]):createCommentVNode("v-if",!0)],2)):createCommentVNode("v-if",!0)],38)),[[unref(ClickOutside),()=>xr(!1),unref(sr)]])]),content:withCtx(()=>[withDirectives(createVNode(unref(_CascaderPanel),{ref_key:"cascaderPanelRef",ref:ie,modelValue:unref(mr),"onUpdate:modelValue":hn[8]||(hn[8]=Zn=>isRef(mr)?mr.value=Zn:null),options:bn.options,props:n.props,border:!1,"render-label":bn.$slots.default,onExpandChange:Ur,onClose:hn[9]||(hn[9]=Zn=>bn.$nextTick(()=>xr(!1)))},null,8,["modelValue","options","props","render-label"]),[[vShow,!Ce.value]]),bn.filterable?withDirectives((openBlock(),createBlock(unref(ElScrollbar),{key:0,ref_key:"suggestionPanel",ref:ae,tag:"ul",class:normalizeClass(unref(L).e("suggestion-panel")),"view-class":unref(L).e("suggestion-list"),onKeydown:Zr},{default:withCtx(()=>[cr.value.length?(openBlock(!0),createElementBlock(Fragment,{key:0},renderList(cr.value,Zn=>(openBlock(),createElementBlock("li",{key:Zn.uid,class:normalizeClass([unref(L).e("suggestion-item"),unref(L).is("checked",Zn.checked)]),tabindex:-1,onClick:Oo=>jn(Zn)},[createBaseVNode("span",null,toDisplayString(Zn.text),1),Zn.checked?(openBlock(),createBlock(unref(ElIcon),{key:0},{default:withCtx(()=>[createVNode(unref(check_default))]),_:1})):createCommentVNode("v-if",!0)],10,_hoisted_3$c))),128)):renderSlot(bn.$slots,"empty",{key:1},()=>[createBaseVNode("li",{class:normalizeClass(unref(L).e("empty-text"))},toDisplayString(unref(V)("el.cascader.noMatch")),3)])]),_:3},8,["class","view-class"])),[[vShow,Ce.value]]):createCommentVNode("v-if",!0)]),_:3},8,["visible","teleported","popper-class","transition"]))}});var Cascader=_export_sfc$1(_sfc_main$Q,[["__file","cascader.vue"]]);Cascader.install=t=>{t.component(Cascader.name,Cascader)};const _Cascader=Cascader,ElCascader=_Cascader,rowContextKey=Symbol("rowContextKey"),RowJustify=["start","center","end","space-around","space-between","space-evenly"],RowAlign=["top","middle","bottom"],rowProps=buildProps({tag:{type:String,default:"div"},gutter:{type:Number,default:0},justify:{type:String,values:RowJustify,default:"start"},align:{type:String,values:RowAlign}}),__default__$q=defineComponent({name:"ElRow"}),_sfc_main$P=defineComponent({...__default__$q,props:rowProps,setup(t){const r=t,e=useNamespace("row"),n=computed(()=>r.gutter);provide(rowContextKey,{gutter:n});const g=computed(()=>{const i={};return r.gutter&&(i.marginRight=i.marginLeft=`-${r.gutter/2}px`),i}),y=computed(()=>[e.b(),e.is(`justify-${r.justify}`,r.justify!=="start"),e.is(`align-${r.align}`,!!r.align)]);return(i,k)=>(openBlock(),createBlock(resolveDynamicComponent(i.tag),{class:normalizeClass(unref(y)),style:normalizeStyle(unref(g))},{default:withCtx(()=>[renderSlot(i.$slots,"default")]),_:3},8,["class","style"]))}});var Row=_export_sfc$1(_sfc_main$P,[["__file","row.vue"]]);const ElRow=withInstall(Row),colProps=buildProps({tag:{type:String,default:"div"},span:{type:Number,default:24},offset:{type:Number,default:0},pull:{type:Number,default:0},push:{type:Number,default:0},xs:{type:definePropType([Number,Object]),default:()=>mutable({})},sm:{type:definePropType([Number,Object]),default:()=>mutable({})},md:{type:definePropType([Number,Object]),default:()=>mutable({})},lg:{type:definePropType([Number,Object]),default:()=>mutable({})},xl:{type:definePropType([Number,Object]),default:()=>mutable({})}}),__default__$p=defineComponent({name:"ElCol"}),_sfc_main$O=defineComponent({...__default__$p,props:colProps,setup(t){const r=t,{gutter:e}=inject(rowContextKey,{gutter:computed(()=>0)}),n=useNamespace("col"),g=computed(()=>{const i={};return e.value&&(i.paddingLeft=i.paddingRight=`${e.value/2}px`),i}),y=computed(()=>{const i=[];return["span","offset","pull","push"].forEach($=>{const V=r[$];isNumber$1(V)&&($==="span"?i.push(n.b(`${r[$]}`)):V>0&&i.push(n.b(`${$}-${r[$]}`)))}),["xs","sm","md","lg","xl"].forEach($=>{isNumber$1(r[$])?i.push(n.b(`${$}-${r[$]}`)):isObject$2(r[$])&&Object.entries(r[$]).forEach(([V,z])=>{i.push(V!=="span"?n.b(`${$}-${V}-${z}`):n.b(`${$}-${z}`))})}),e.value&&i.push(n.is("guttered")),[n.b(),i]});return(i,k)=>(openBlock(),createBlock(resolveDynamicComponent(i.tag),{class:normalizeClass(unref(y)),style:normalizeStyle(unref(g))},{default:withCtx(()=>[renderSlot(i.$slots,"default")]),_:3},8,["class","style"]))}});var Col=_export_sfc$1(_sfc_main$O,[["__file","col.vue"]]);const ElCol=withInstall(Col),__default__$o=defineComponent({name:"ElCollapseTransition"}),_sfc_main$N=defineComponent({...__default__$o,setup(t){const r=useNamespace("collapse-transition"),e=g=>{g.style.maxHeight="",g.style.overflow=g.dataset.oldOverflow,g.style.paddingTop=g.dataset.oldPaddingTop,g.style.paddingBottom=g.dataset.oldPaddingBottom},n={beforeEnter(g){g.dataset||(g.dataset={}),g.dataset.oldPaddingTop=g.style.paddingTop,g.dataset.oldPaddingBottom=g.style.paddingBottom,g.style.height&&(g.dataset.elExistsHeight=g.style.height),g.style.maxHeight=0,g.style.paddingTop=0,g.style.paddingBottom=0},enter(g){requestAnimationFrame(()=>{g.dataset.oldOverflow=g.style.overflow,g.dataset.elExistsHeight?g.style.maxHeight=g.dataset.elExistsHeight:g.scrollHeight!==0?g.style.maxHeight=`${g.scrollHeight}px`:g.style.maxHeight=0,g.style.paddingTop=g.dataset.oldPaddingTop,g.style.paddingBottom=g.dataset.oldPaddingBottom,g.style.overflow="hidden"})},afterEnter(g){g.style.maxHeight="",g.style.overflow=g.dataset.oldOverflow},enterCancelled(g){e(g)},beforeLeave(g){g.dataset||(g.dataset={}),g.dataset.oldPaddingTop=g.style.paddingTop,g.dataset.oldPaddingBottom=g.style.paddingBottom,g.dataset.oldOverflow=g.style.overflow,g.style.maxHeight=`${g.scrollHeight}px`,g.style.overflow="hidden"},leave(g){g.scrollHeight!==0&&(g.style.maxHeight=0,g.style.paddingTop=0,g.style.paddingBottom=0)},afterLeave(g){e(g)},leaveCancelled(g){e(g)}};return(g,y)=>(openBlock(),createBlock(Transition,mergeProps({name:unref(r).b()},toHandlers(n)),{default:withCtx(()=>[renderSlot(g.$slots,"default")]),_:3},16,["name"]))}});var CollapseTransition=_export_sfc$1(_sfc_main$N,[["__file","collapse-transition.vue"]]);CollapseTransition.install=t=>{t.component(CollapseTransition.name,CollapseTransition)};const _CollapseTransition=CollapseTransition,__default__$n=defineComponent({name:"ElContainer"}),_sfc_main$M=defineComponent({...__default__$n,props:{direction:{type:String}},setup(t){const r=t,e=useSlots(),n=useNamespace("container"),g=computed(()=>r.direction==="vertical"?!0:r.direction==="horizontal"?!1:e&&e.default?e.default().some(i=>{const k=i.type.name;return k==="ElHeader"||k==="ElFooter"}):!1);return(y,i)=>(openBlock(),createElementBlock("section",{class:normalizeClass([unref(n).b(),unref(n).is("vertical",unref(g))])},[renderSlot(y.$slots,"default")],2))}});var Container=_export_sfc$1(_sfc_main$M,[["__file","container.vue"]]);const __default__$m=defineComponent({name:"ElAside"}),_sfc_main$L=defineComponent({...__default__$m,props:{width:{type:String,default:null}},setup(t){const r=t,e=useNamespace("aside"),n=computed(()=>r.width?e.cssVarBlock({width:r.width}):{});return(g,y)=>(openBlock(),createElementBlock("aside",{class:normalizeClass(unref(e).b()),style:normalizeStyle(unref(n))},[renderSlot(g.$slots,"default")],6))}});var Aside=_export_sfc$1(_sfc_main$L,[["__file","aside.vue"]]);const __default__$l=defineComponent({name:"ElFooter"}),_sfc_main$K=defineComponent({...__default__$l,props:{height:{type:String,default:null}},setup(t){const r=t,e=useNamespace("footer"),n=computed(()=>r.height?e.cssVarBlock({height:r.height}):{});return(g,y)=>(openBlock(),createElementBlock("footer",{class:normalizeClass(unref(e).b()),style:normalizeStyle(unref(n))},[renderSlot(g.$slots,"default")],6))}});var Footer=_export_sfc$1(_sfc_main$K,[["__file","footer.vue"]]);const __default__$k=defineComponent({name:"ElHeader"}),_sfc_main$J=defineComponent({...__default__$k,props:{height:{type:String,default:null}},setup(t){const r=t,e=useNamespace("header"),n=computed(()=>r.height?e.cssVarBlock({height:r.height}):{});return(g,y)=>(openBlock(),createElementBlock("header",{class:normalizeClass(unref(e).b()),style:normalizeStyle(unref(n))},[renderSlot(g.$slots,"default")],6))}});var Header=_export_sfc$1(_sfc_main$J,[["__file","header.vue"]]);const __default__$j=defineComponent({name:"ElMain"}),_sfc_main$I=defineComponent({...__default__$j,setup(t){const r=useNamespace("main");return(e,n)=>(openBlock(),createElementBlock("main",{class:normalizeClass(unref(r).b())},[renderSlot(e.$slots,"default")],2))}});var Main=_export_sfc$1(_sfc_main$I,[["__file","main.vue"]]);const ElContainer=withInstall(Container,{Aside,Footer,Header,Main}),ElAside=withNoopInstall(Aside);withNoopInstall(Footer);withNoopInstall(Header);const ElMain=withNoopInstall(Main),overlayProps=buildProps({mask:{type:Boolean,default:!0},customMaskEvent:{type:Boolean,default:!1},overlayClass:{type:definePropType([String,Array,Object])},zIndex:{type:definePropType([String,Number])}}),overlayEmits={click:t=>t instanceof MouseEvent},BLOCK="overlay";var Overlay=defineComponent({name:"ElOverlay",props:overlayProps,emits:overlayEmits,setup(t,{slots:r,emit:e}){const n=useNamespace(BLOCK),g=L=>{e("click",L)},{onClick:y,onMousedown:i,onMouseup:k}=useSameTarget(t.customMaskEvent?void 0:g);return()=>t.mask?createVNode("div",{class:[n.b(),t.overlayClass],style:{zIndex:t.zIndex},onClick:y,onMousedown:i,onMouseup:k},[renderSlot(r,"default")],PatchFlags.STYLE|PatchFlags.CLASS|PatchFlags.PROPS,["onClick","onMouseup","onMousedown"]):h$1("div",{class:t.overlayClass,style:{zIndex:t.zIndex,position:"fixed",top:"0px",right:"0px",bottom:"0px",left:"0px"}},[renderSlot(r,"default")])}});const ElOverlay=Overlay,dialogInjectionKey=Symbol("dialogInjectionKey"),dialogContentProps=buildProps({center:Boolean,alignCenter:Boolean,closeIcon:{type:iconPropType},draggable:Boolean,overflow:Boolean,fullscreen:Boolean,showClose:{type:Boolean,default:!0},title:{type:String,default:""},ariaLevel:{type:String,default:"2"}}),dialogContentEmits={close:()=>!0},_hoisted_1$u=["aria-level"],_hoisted_2$j=["aria-label"],_hoisted_3$b=["id"],__default__$i=defineComponent({name:"ElDialogContent"}),_sfc_main$H=defineComponent({...__default__$i,props:dialogContentProps,emits:dialogContentEmits,setup(t){const r=t,{t:e}=useLocale(),{Close:n}=CloseComponents,{dialogRef:g,headerRef:y,bodyId:i,ns:k,style:L}=inject(dialogInjectionKey),{focusTrapRef:$}=inject(FOCUS_TRAP_INJECTION_KEY),V=computed(()=>[k.b(),k.is("fullscreen",r.fullscreen),k.is("draggable",r.draggable),k.is("align-center",r.alignCenter),{[k.m("center")]:r.center}]),z=composeRefs($,g),re=computed(()=>r.draggable),oe=computed(()=>r.overflow);return useDraggable(g,y,re,oe),(le,ue)=>(openBlock(),createElementBlock("div",{ref:unref(z),class:normalizeClass(unref(V)),style:normalizeStyle(unref(L)),tabindex:"-1"},[createBaseVNode("header",{ref_key:"headerRef",ref:y,class:normalizeClass([unref(k).e("header"),{"show-close":le.showClose}])},[renderSlot(le.$slots,"header",{},()=>[createBaseVNode("span",{role:"heading","aria-level":le.ariaLevel,class:normalizeClass(unref(k).e("title"))},toDisplayString(le.title),11,_hoisted_1$u)]),le.showClose?(openBlock(),createElementBlock("button",{key:0,"aria-label":unref(e)("el.dialog.close"),class:normalizeClass(unref(k).e("headerbtn")),type:"button",onClick:ue[0]||(ue[0]=ie=>le.$emit("close"))},[createVNode(unref(ElIcon),{class:normalizeClass(unref(k).e("close"))},{default:withCtx(()=>[(openBlock(),createBlock(resolveDynamicComponent(le.closeIcon||unref(n))))]),_:1},8,["class"])],10,_hoisted_2$j)):createCommentVNode("v-if",!0)],2),createBaseVNode("div",{id:unref(i),class:normalizeClass(unref(k).e("body"))},[renderSlot(le.$slots,"default")],10,_hoisted_3$b),le.$slots.footer?(openBlock(),createElementBlock("footer",{key:0,class:normalizeClass(unref(k).e("footer"))},[renderSlot(le.$slots,"footer")],2)):createCommentVNode("v-if",!0)],6))}});var ElDialogContent=_export_sfc$1(_sfc_main$H,[["__file","dialog-content.vue"]]);const dialogProps=buildProps({...dialogContentProps,appendToBody:Boolean,appendTo:{type:definePropType(String),default:"body"},beforeClose:{type:definePropType(Function)},destroyOnClose:Boolean,closeOnClickModal:{type:Boolean,default:!0},closeOnPressEscape:{type:Boolean,default:!0},lockScroll:{type:Boolean,default:!0},modal:{type:Boolean,default:!0},openDelay:{type:Number,default:0},closeDelay:{type:Number,default:0},top:{type:String},modelValue:Boolean,modalClass:String,width:{type:[String,Number]},zIndex:{type:Number},trapFocus:{type:Boolean,default:!1},headerAriaLevel:{type:String,default:"2"}}),dialogEmits={open:()=>!0,opened:()=>!0,close:()=>!0,closed:()=>!0,[UPDATE_MODEL_EVENT]:t=>isBoolean$1(t),openAutoFocus:()=>!0,closeAutoFocus:()=>!0},useDialog=(t,r)=>{var e;const g=getCurrentInstance().emit,{nextZIndex:y}=useZIndex();let i="";const k=useId(),L=useId(),$=ref(!1),V=ref(!1),z=ref(!1),re=ref((e=t.zIndex)!=null?e:y());let oe,le;const ue=useGlobalConfig("namespace",defaultNamespace),ie=computed(()=>{const tr={},ur=`--${ue.value}-dialog`;return t.fullscreen||(t.top&&(tr[`${ur}-margin-top`]=t.top),t.width&&(tr[`${ur}-width`]=addUnit(t.width))),tr}),ae=computed(()=>t.alignCenter?{display:"flex"}:{});function Ie(){g("opened")}function de(){g("closed"),g(UPDATE_MODEL_EVENT,!1),t.destroyOnClose&&(z.value=!1)}function Ce(){g("close")}function Ue(){le==null||le(),oe==null||oe(),t.openDelay&&t.openDelay>0?{stop:oe}=useTimeoutFn(()=>Et(),t.openDelay):Et()}function qe(){oe==null||oe(),le==null||le(),t.closeDelay&&t.closeDelay>0?{stop:le}=useTimeoutFn(()=>cr(),t.closeDelay):cr()}function jt(){function tr(ur){ur||(V.value=!0,$.value=!1)}t.beforeClose?t.beforeClose(tr):qe()}function Fe(){t.closeOnClickModal&&jt()}function Et(){isClient&&($.value=!0)}function cr(){$.value=!1}function er(){g("openAutoFocus")}function nr(){g("closeAutoFocus")}function dr(tr){var ur;((ur=tr.detail)==null?void 0:ur.focusReason)==="pointer"&&tr.preventDefault()}t.lockScroll&&useLockscreen($);function ir(){t.closeOnPressEscape&&jt()}return watch(()=>t.modelValue,tr=>{tr?(V.value=!1,Ue(),z.value=!0,re.value=isUndefined$2(t.zIndex)?y():re.value++,nextTick(()=>{g("open"),r.value&&(r.value.scrollTop=0)})):$.value&&qe()}),watch(()=>t.fullscreen,tr=>{r.value&&(tr?(i=r.value.style.transform,r.value.style.transform=""):r.value.style.transform=i)}),onMounted(()=>{t.modelValue&&($.value=!0,z.value=!0,Ue())}),{afterEnter:Ie,afterLeave:de,beforeLeave:Ce,handleClose:jt,onModalClick:Fe,close:qe,doClose:cr,onOpenAutoFocus:er,onCloseAutoFocus:nr,onCloseRequested:ir,onFocusoutPrevented:dr,titleId:k,bodyId:L,closed:V,style:ie,overlayDialogStyle:ae,rendered:z,visible:$,zIndex:re}},_hoisted_1$t=["aria-label","aria-labelledby","aria-describedby"],__default__$h=defineComponent({name:"ElDialog",inheritAttrs:!1}),_sfc_main$G=defineComponent({...__default__$h,props:dialogProps,emits:dialogEmits,setup(t,{expose:r}){const e=t,n=useSlots();useDeprecated({scope:"el-dialog",from:"the title slot",replacement:"the header slot",version:"3.0.0",ref:"https://element-plus.org/en-US/component/dialog.html#slots"},computed(()=>!!n.title));const g=useNamespace("dialog"),y=ref(),i=ref(),k=ref(),{visible:L,titleId:$,bodyId:V,style:z,overlayDialogStyle:re,rendered:oe,zIndex:le,afterEnter:ue,afterLeave:ie,beforeLeave:ae,handleClose:Ie,onModalClick:de,onOpenAutoFocus:Ce,onCloseAutoFocus:Ue,onCloseRequested:qe,onFocusoutPrevented:jt}=useDialog(e,y);provide(dialogInjectionKey,{dialogRef:y,headerRef:i,bodyId:V,ns:g,rendered:oe,style:z});const Fe=useSameTarget(de),Et=computed(()=>e.draggable&&!e.fullscreen);return r({visible:L,dialogContentRef:k}),(cr,er)=>(openBlock(),createBlock(Teleport,{to:cr.appendTo,disabled:cr.appendTo!=="body"?!1:!cr.appendToBody},[createVNode(Transition,{name:"dialog-fade",onAfterEnter:unref(ue),onAfterLeave:unref(ie),onBeforeLeave:unref(ae),persisted:""},{default:withCtx(()=>[withDirectives(createVNode(unref(ElOverlay),{"custom-mask-event":"",mask:cr.modal,"overlay-class":cr.modalClass,"z-index":unref(le)},{default:withCtx(()=>[createBaseVNode("div",{role:"dialog","aria-modal":"true","aria-label":cr.title||void 0,"aria-labelledby":cr.title?void 0:unref($),"aria-describedby":unref(V),class:normalizeClass(`${unref(g).namespace.value}-overlay-dialog`),style:normalizeStyle(unref(re)),onClick:er[0]||(er[0]=(...nr)=>unref(Fe).onClick&&unref(Fe).onClick(...nr)),onMousedown:er[1]||(er[1]=(...nr)=>unref(Fe).onMousedown&&unref(Fe).onMousedown(...nr)),onMouseup:er[2]||(er[2]=(...nr)=>unref(Fe).onMouseup&&unref(Fe).onMouseup(...nr))},[createVNode(unref(ElFocusTrap),{loop:"",trapped:unref(L),"focus-start-el":"container",onFocusAfterTrapped:unref(Ce),onFocusAfterReleased:unref(Ue),onFocusoutPrevented:unref(jt),onReleaseRequested:unref(qe)},{default:withCtx(()=>[unref(oe)?(openBlock(),createBlock(ElDialogContent,mergeProps({key:0,ref_key:"dialogContentRef",ref:k},cr.$attrs,{center:cr.center,"align-center":cr.alignCenter,"close-icon":cr.closeIcon,draggable:unref(Et),overflow:cr.overflow,fullscreen:cr.fullscreen,"show-close":cr.showClose,title:cr.title,"aria-level":cr.headerAriaLevel,onClose:unref(Ie)}),createSlots({header:withCtx(()=>[cr.$slots.title?renderSlot(cr.$slots,"title",{key:1}):renderSlot(cr.$slots,"header",{key:0,close:unref(Ie),titleId:unref($),titleClass:unref(g).e("title")})]),default:withCtx(()=>[renderSlot(cr.$slots,"default")]),_:2},[cr.$slots.footer?{name:"footer",fn:withCtx(()=>[renderSlot(cr.$slots,"footer")])}:void 0]),1040,["center","align-center","close-icon","draggable","overflow","fullscreen","show-close","title","aria-level","onClose"])):createCommentVNode("v-if",!0)]),_:3},8,["trapped","onFocusAfterTrapped","onFocusAfterReleased","onFocusoutPrevented","onReleaseRequested"])],46,_hoisted_1$t)]),_:3},8,["mask","overlay-class","z-index"]),[[vShow,unref(L)]])]),_:3},8,["onAfterEnter","onAfterLeave","onBeforeLeave"])],8,["to","disabled"]))}});var Dialog=_export_sfc$1(_sfc_main$G,[["__file","dialog.vue"]]);const ElDialog=withInstall(Dialog),dividerProps=buildProps({direction:{type:String,values:["horizontal","vertical"],default:"horizontal"},contentPosition:{type:String,values:["left","center","right"],default:"center"},borderStyle:{type:definePropType(String),default:"solid"}}),__default__$g=defineComponent({name:"ElDivider"}),_sfc_main$F=defineComponent({...__default__$g,props:dividerProps,setup(t){const r=t,e=useNamespace("divider"),n=computed(()=>e.cssVar({"border-style":r.borderStyle}));return(g,y)=>(openBlock(),createElementBlock("div",{class:normalizeClass([unref(e).b(),unref(e).m(g.direction)]),style:normalizeStyle(unref(n)),role:"separator"},[g.$slots.default&&g.direction!=="vertical"?(openBlock(),createElementBlock("div",{key:0,class:normalizeClass([unref(e).e("text"),unref(e).is(g.contentPosition)])},[renderSlot(g.$slots,"default")],2)):createCommentVNode("v-if",!0)],6))}});var Divider=_export_sfc$1(_sfc_main$F,[["__file","divider.vue"]]);const ElDivider=withInstall(Divider),imageViewerProps=buildProps({urlList:{type:definePropType(Array),default:()=>mutable([])},zIndex:{type:Number},initialIndex:{type:Number,default:0},infinite:{type:Boolean,default:!0},hideOnClickModal:Boolean,teleported:Boolean,closeOnPressEscape:{type:Boolean,default:!0},zoomRate:{type:Number,default:1.2},minScale:{type:Number,default:.2},maxScale:{type:Number,default:7},crossorigin:{type:definePropType(String)}}),imageViewerEmits={close:()=>!0,switch:t=>isNumber$1(t),rotate:t=>isNumber$1(t)},_hoisted_1$s=["src","crossorigin"],__default__$f=defineComponent({name:"ElImageViewer"}),_sfc_main$E=defineComponent({...__default__$f,props:imageViewerProps,emits:imageViewerEmits,setup(t,{expose:r,emit:e}){var n;const g=t,y={CONTAIN:{name:"contain",icon:markRaw(full_screen_default)},ORIGINAL:{name:"original",icon:markRaw(scale_to_original_default)}},{t:i}=useLocale(),k=useNamespace("image-viewer"),{nextZIndex:L}=useZIndex(),$=ref(),V=ref([]),z=effectScope(),re=ref(!0),oe=ref(g.initialIndex),le=shallowRef(y.CONTAIN),ue=ref({scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}),ie=ref((n=g.zIndex)!=null?n:L()),ae=computed(()=>{const{urlList:gr}=g;return gr.length<=1}),Ie=computed(()=>oe.value===0),de=computed(()=>oe.value===g.urlList.length-1),Ce=computed(()=>g.urlList[oe.value]),Ue=computed(()=>[k.e("btn"),k.e("prev"),k.is("disabled",!g.infinite&&Ie.value)]),qe=computed(()=>[k.e("btn"),k.e("next"),k.is("disabled",!g.infinite&&de.value)]),jt=computed(()=>{const{scale:gr,deg:Sr,offsetX:wr,offsetY:kr,enableTransition:mr}=ue.value;let Ir=wr/gr,Nr=kr/gr;switch(Sr%360){case 90:case-270:[Ir,Nr]=[Nr,-Ir];break;case 180:case-180:[Ir,Nr]=[-Ir,-Nr];break;case 270:case-90:[Ir,Nr]=[-Nr,Ir];break}const Er={transform:`scale(${gr}) rotate(${Sr}deg) translate(${Ir}px, ${Nr}px)`,transition:mr?"transform .3s":""};return le.value.name===y.CONTAIN.name&&(Er.maxWidth=Er.maxHeight="100%"),Er});function Fe(){cr(),e("close")}function Et(){const gr=throttle(wr=>{switch(wr.code){case EVENT_CODE.esc:g.closeOnPressEscape&&Fe();break;case EVENT_CODE.space:tr();break;case EVENT_CODE.left:or();break;case EVENT_CODE.up:lr("zoomIn");break;case EVENT_CODE.right:fr();break;case EVENT_CODE.down:lr("zoomOut");break}}),Sr=throttle(wr=>{const kr=wr.deltaY||wr.deltaX;lr(kr<0?"zoomIn":"zoomOut",{zoomRate:g.zoomRate,enableTransition:!1})});z.run(()=>{useEventListener(document,"keydown",gr),useEventListener(document,"wheel",Sr)})}function cr(){z.stop()}function er(){re.value=!1}function nr(gr){re.value=!1,gr.target.alt=i("el.image.error")}function dr(gr){if(re.value||gr.button!==0||!$.value)return;ue.value.enableTransition=!1;const{offsetX:Sr,offsetY:wr}=ue.value,kr=gr.pageX,mr=gr.pageY,Ir=throttle(Er=>{ue.value={...ue.value,offsetX:Sr+Er.pageX-kr,offsetY:wr+Er.pageY-mr}}),Nr=useEventListener(document,"mousemove",Ir);useEventListener(document,"mouseup",()=>{Nr()}),gr.preventDefault()}function ir(){ue.value={scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}}function tr(){if(re.value)return;const gr=keysOf(y),Sr=Object.values(y),wr=le.value.name,mr=(Sr.findIndex(Ir=>Ir.name===wr)+1)%gr.length;le.value=y[gr[mr]],ir()}function ur(gr){const Sr=g.urlList.length;oe.value=(gr+Sr)%Sr}function or(){Ie.value&&!g.infinite||ur(oe.value-1)}function fr(){de.value&&!g.infinite||ur(oe.value+1)}function lr(gr,Sr={}){if(re.value)return;const{minScale:wr,maxScale:kr}=g,{zoomRate:mr,rotateDeg:Ir,enableTransition:Nr}={zoomRate:g.zoomRate,rotateDeg:90,enableTransition:!0,...Sr};switch(gr){case"zoomOut":ue.value.scale>wr&&(ue.value.scale=Number.parseFloat((ue.value.scale/mr).toFixed(3)));break;case"zoomIn":ue.value.scale<kr&&(ue.value.scale=Number.parseFloat((ue.value.scale*mr).toFixed(3)));break;case"clockwise":ue.value.deg+=Ir,e("rotate",ue.value.deg);break;case"anticlockwise":ue.value.deg-=Ir,e("rotate",ue.value.deg);break}ue.value.enableTransition=Nr}return watch(Ce,()=>{nextTick(()=>{const gr=V.value[0];gr!=null&&gr.complete||(re.value=!0)})}),watch(oe,gr=>{ir(),e("switch",gr)}),onMounted(()=>{var gr,Sr;Et(),(Sr=(gr=$.value)==null?void 0:gr.focus)==null||Sr.call(gr)}),r({setActiveItem:ur}),(gr,Sr)=>(openBlock(),createBlock(Teleport,{to:"body",disabled:!gr.teleported},[createVNode(Transition,{name:"viewer-fade",appear:""},{default:withCtx(()=>[createBaseVNode("div",{ref_key:"wrapper",ref:$,tabindex:-1,class:normalizeClass(unref(k).e("wrapper")),style:normalizeStyle({zIndex:ie.value})},[createBaseVNode("div",{class:normalizeClass(unref(k).e("mask")),onClick:Sr[0]||(Sr[0]=withModifiers(wr=>gr.hideOnClickModal&&Fe(),["self"]))},null,2),createCommentVNode(" CLOSE "),createBaseVNode("span",{class:normalizeClass([unref(k).e("btn"),unref(k).e("close")]),onClick:Fe},[createVNode(unref(ElIcon),null,{default:withCtx(()=>[createVNode(unref(close_default))]),_:1})],2),createCommentVNode(" ARROW "),unref(ae)?createCommentVNode("v-if",!0):(openBlock(),createElementBlock(Fragment,{key:0},[createBaseVNode("span",{class:normalizeClass(unref(Ue)),onClick:or},[createVNode(unref(ElIcon),null,{default:withCtx(()=>[createVNode(unref(arrow_left_default))]),_:1})],2),createBaseVNode("span",{class:normalizeClass(unref(qe)),onClick:fr},[createVNode(unref(ElIcon),null,{default:withCtx(()=>[createVNode(unref(arrow_right_default))]),_:1})],2)],64)),createCommentVNode(" ACTIONS "),createBaseVNode("div",{class:normalizeClass([unref(k).e("btn"),unref(k).e("actions")])},[createBaseVNode("div",{class:normalizeClass(unref(k).e("actions__inner"))},[createVNode(unref(ElIcon),{onClick:Sr[1]||(Sr[1]=wr=>lr("zoomOut"))},{default:withCtx(()=>[createVNode(unref(zoom_out_default))]),_:1}),createVNode(unref(ElIcon),{onClick:Sr[2]||(Sr[2]=wr=>lr("zoomIn"))},{default:withCtx(()=>[createVNode(unref(zoom_in_default))]),_:1}),createBaseVNode("i",{class:normalizeClass(unref(k).e("actions__divider"))},null,2),createVNode(unref(ElIcon),{onClick:tr},{default:withCtx(()=>[(openBlock(),createBlock(resolveDynamicComponent(unref(le).icon)))]),_:1}),createBaseVNode("i",{class:normalizeClass(unref(k).e("actions__divider"))},null,2),createVNode(unref(ElIcon),{onClick:Sr[3]||(Sr[3]=wr=>lr("anticlockwise"))},{default:withCtx(()=>[createVNode(unref(refresh_left_default))]),_:1}),createVNode(unref(ElIcon),{onClick:Sr[4]||(Sr[4]=wr=>lr("clockwise"))},{default:withCtx(()=>[createVNode(unref(refresh_right_default))]),_:1})],2)],2),createCommentVNode(" CANVAS "),createBaseVNode("div",{class:normalizeClass(unref(k).e("canvas"))},[(openBlock(!0),createElementBlock(Fragment,null,renderList(gr.urlList,(wr,kr)=>withDirectives((openBlock(),createElementBlock("img",{ref_for:!0,ref:mr=>V.value[kr]=mr,key:wr,src:wr,style:normalizeStyle(unref(jt)),class:normalizeClass(unref(k).e("img")),crossorigin:gr.crossorigin,onLoad:er,onError:nr,onMousedown:dr},null,46,_hoisted_1$s)),[[vShow,kr===oe.value]])),128))],2),renderSlot(gr.$slots,"default")],6)]),_:3})],8,["disabled"]))}});var ImageViewer=_export_sfc$1(_sfc_main$E,[["__file","image-viewer.vue"]]);const ElImageViewer=withInstall(ImageViewer),imageProps=buildProps({hideOnClickModal:Boolean,src:{type:String,default:""},fit:{type:String,values:["","contain","cover","fill","none","scale-down"],default:""},loading:{type:String,values:["eager","lazy"]},lazy:Boolean,scrollContainer:{type:definePropType([String,Object])},previewSrcList:{type:definePropType(Array),default:()=>mutable([])},previewTeleported:Boolean,zIndex:{type:Number},initialIndex:{type:Number,default:0},infinite:{type:Boolean,default:!0},closeOnPressEscape:{type:Boolean,default:!0},zoomRate:{type:Number,default:1.2},minScale:{type:Number,default:.2},maxScale:{type:Number,default:7},crossorigin:{type:definePropType(String)}}),imageEmits={load:t=>t instanceof Event,error:t=>t instanceof Event,switch:t=>isNumber$1(t),close:()=>!0,show:()=>!0},_hoisted_1$r=["src","loading","crossorigin"],_hoisted_2$i={key:0},__default__$e=defineComponent({name:"ElImage",inheritAttrs:!1}),_sfc_main$D=defineComponent({...__default__$e,props:imageProps,emits:imageEmits,setup(t,{emit:r}){const e=t;let n="";const{t:g}=useLocale(),y=useNamespace("image"),i=useAttrs$1(),k=useAttrs(),L=ref(),$=ref(!1),V=ref(!0),z=ref(!1),re=ref(),oe=ref(),le=isClient&&"loading"in HTMLImageElement.prototype;let ue,ie;const ae=computed(()=>[y.e("inner"),Ce.value&&y.e("preview"),V.value&&y.is("loading")]),Ie=computed(()=>i.style),de=computed(()=>{const{fit:fr}=e;return isClient&&fr?{objectFit:fr}:{}}),Ce=computed(()=>{const{previewSrcList:fr}=e;return Array.isArray(fr)&&fr.length>0}),Ue=computed(()=>{const{previewSrcList:fr,initialIndex:lr}=e;let gr=lr;return lr>fr.length-1&&(gr=0),gr}),qe=computed(()=>e.loading==="eager"?!1:!le&&e.loading==="lazy"||e.lazy),jt=()=>{isClient&&(V.value=!0,$.value=!1,L.value=e.src)};function Fe(fr){V.value=!1,$.value=!1,r("load",fr)}function Et(fr){V.value=!1,$.value=!0,r("error",fr)}function cr(){isInContainer(re.value,oe.value)&&(jt(),dr())}const er=useThrottleFn(cr,200,!0);async function nr(){var fr;if(!isClient)return;await nextTick();const{scrollContainer:lr}=e;isElement(lr)?oe.value=lr:isString$2(lr)&&lr!==""?oe.value=(fr=document.querySelector(lr))!=null?fr:void 0:re.value&&(oe.value=getScrollContainer(re.value)),oe.value&&(ue=useEventListener(oe,"scroll",er),setTimeout(()=>cr(),100))}function dr(){!isClient||!oe.value||!er||(ue==null||ue(),oe.value=void 0)}function ir(fr){if(fr.ctrlKey){if(fr.deltaY<0)return fr.preventDefault(),!1;if(fr.deltaY>0)return fr.preventDefault(),!1}}function tr(){Ce.value&&(ie=useEventListener("wheel",ir,{passive:!1}),n=document.body.style.overflow,document.body.style.overflow="hidden",z.value=!0,r("show"))}function ur(){ie==null||ie(),document.body.style.overflow=n,z.value=!1,r("close")}function or(fr){r("switch",fr)}return watch(()=>e.src,()=>{qe.value?(V.value=!0,$.value=!1,dr(),nr()):jt()}),onMounted(()=>{qe.value?nr():jt()}),(fr,lr)=>(openBlock(),createElementBlock("div",{ref_key:"container",ref:re,class:normalizeClass([unref(y).b(),fr.$attrs.class]),style:normalizeStyle(unref(Ie))},[$.value?renderSlot(fr.$slots,"error",{key:0},()=>[createBaseVNode("div",{class:normalizeClass(unref(y).e("error"))},toDisplayString(unref(g)("el.image.error")),3)]):(openBlock(),createElementBlock(Fragment,{key:1},[L.value!==void 0?(openBlock(),createElementBlock("img",mergeProps({key:0},unref(k),{src:L.value,loading:fr.loading,style:unref(de),class:unref(ae),crossorigin:fr.crossorigin,onClick:tr,onLoad:Fe,onError:Et}),null,16,_hoisted_1$r)):createCommentVNode("v-if",!0),V.value?(openBlock(),createElementBlock("div",{key:1,class:normalizeClass(unref(y).e("wrapper"))},[renderSlot(fr.$slots,"placeholder",{},()=>[createBaseVNode("div",{class:normalizeClass(unref(y).e("placeholder"))},null,2)])],2)):createCommentVNode("v-if",!0)],64)),unref(Ce)?(openBlock(),createElementBlock(Fragment,{key:2},[z.value?(openBlock(),createBlock(unref(ElImageViewer),{key:0,"z-index":fr.zIndex,"initial-index":unref(Ue),infinite:fr.infinite,"zoom-rate":fr.zoomRate,"min-scale":fr.minScale,"max-scale":fr.maxScale,"url-list":fr.previewSrcList,"hide-on-click-modal":fr.hideOnClickModal,teleported:fr.previewTeleported,"close-on-press-escape":fr.closeOnPressEscape,onClose:ur,onSwitch:or},{default:withCtx(()=>[fr.$slots.viewer?(openBlock(),createElementBlock("div",_hoisted_2$i,[renderSlot(fr.$slots,"viewer")])):createCommentVNode("v-if",!0)]),_:3},8,["z-index","initial-index","infinite","zoom-rate","min-scale","max-scale","url-list","hide-on-click-modal","teleported","close-on-press-escape"])):createCommentVNode("v-if",!0)],64)):createCommentVNode("v-if",!0)],6))}});var Image$1=_export_sfc$1(_sfc_main$D,[["__file","image.vue"]]);const ElImage=withInstall(Image$1),inputNumberProps=buildProps({id:{type:String,default:void 0},step:{type:Number,default:1},stepStrictly:Boolean,max:{type:Number,default:Number.POSITIVE_INFINITY},min:{type:Number,default:Number.NEGATIVE_INFINITY},modelValue:Number,readonly:Boolean,disabled:Boolean,size:useSizeProp,controls:{type:Boolean,default:!0},controlsPosition:{type:String,default:"",values:["","right"]},valueOnClear:{type:[String,Number,null],validator:t=>t===null||isNumber$1(t)||["min","max"].includes(t),default:null},name:String,label:String,placeholder:String,precision:{type:Number,validator:t=>t>=0&&t===Number.parseInt(`${t}`,10)},validateEvent:{type:Boolean,default:!0}}),inputNumberEmits={[CHANGE_EVENT]:(t,r)=>r!==t,blur:t=>t instanceof FocusEvent,focus:t=>t instanceof FocusEvent,[INPUT_EVENT]:t=>isNumber$1(t)||isNil(t),[UPDATE_MODEL_EVENT]:t=>isNumber$1(t)||isNil(t)},_hoisted_1$q=["aria-label","onKeydown"],_hoisted_2$h=["aria-label","onKeydown"],__default__$d=defineComponent({name:"ElInputNumber"}),_sfc_main$C=defineComponent({...__default__$d,props:inputNumberProps,emits:inputNumberEmits,setup(t,{expose:r,emit:e}){const n=t,{t:g}=useLocale(),y=useNamespace("input-number"),i=ref(),k=reactive({currentValue:n.modelValue,userInput:null}),{formItem:L}=useFormItem(),$=computed(()=>isNumber$1(n.modelValue)&&n.modelValue<=n.min),V=computed(()=>isNumber$1(n.modelValue)&&n.modelValue>=n.max),z=computed(()=>{const tr=ae(n.step);return isUndefined$1(n.precision)?Math.max(ae(n.modelValue),tr):(tr>n.precision,n.precision)}),re=computed(()=>n.controls&&n.controlsPosition==="right"),oe=useFormSize(),le=useFormDisabled(),ue=computed(()=>{if(k.userInput!==null)return k.userInput;let tr=k.currentValue;if(isNil(tr))return"";if(isNumber$1(tr)){if(Number.isNaN(tr))return"";isUndefined$1(n.precision)||(tr=tr.toFixed(n.precision))}return tr}),ie=(tr,ur)=>{if(isUndefined$1(ur)&&(ur=z.value),ur===0)return Math.round(tr);let or=String(tr);const fr=or.indexOf(".");if(fr===-1||!or.replace(".","").split("")[fr+ur])return tr;const Sr=or.length;return or.charAt(Sr-1)==="5"&&(or=`${or.slice(0,Math.max(0,Sr-1))}6`),Number.parseFloat(Number(or).toFixed(ur))},ae=tr=>{if(isNil(tr))return 0;const ur=tr.toString(),or=ur.indexOf(".");let fr=0;return or!==-1&&(fr=ur.length-or-1),fr},Ie=(tr,ur=1)=>isNumber$1(tr)?ie(tr+n.step*ur):k.currentValue,de=()=>{if(n.readonly||le.value||V.value)return;const tr=Number(ue.value)||0,ur=Ie(tr);qe(ur),e(INPUT_EVENT,k.currentValue),dr()},Ce=()=>{if(n.readonly||le.value||$.value)return;const tr=Number(ue.value)||0,ur=Ie(tr,-1);qe(ur),e(INPUT_EVENT,k.currentValue),dr()},Ue=(tr,ur)=>{const{max:or,min:fr,step:lr,precision:gr,stepStrictly:Sr,valueOnClear:wr}=n;or<fr&&throwError("InputNumber","min should not be greater than max.");let kr=Number(tr);if(isNil(tr)||Number.isNaN(kr))return null;if(tr===""){if(wr===null)return null;kr=isString$2(wr)?{min:fr,max:or}[wr]:wr}return Sr&&(kr=ie(Math.round(kr/lr)*lr,gr)),isUndefined$1(gr)||(kr=ie(kr,gr)),(kr>or||kr<fr)&&(kr=kr>or?or:fr,ur&&e(UPDATE_MODEL_EVENT,kr)),kr},qe=(tr,ur=!0)=>{var or;const fr=k.currentValue,lr=Ue(tr);if(!ur){e(UPDATE_MODEL_EVENT,lr);return}fr!==lr&&(k.userInput=null,e(UPDATE_MODEL_EVENT,lr),e(CHANGE_EVENT,lr,fr),n.validateEvent&&((or=L==null?void 0:L.validate)==null||or.call(L,"change").catch(gr=>void 0)),k.currentValue=lr)},jt=tr=>{k.userInput=tr;const ur=tr===""?null:Number(tr);e(INPUT_EVENT,ur),qe(ur,!1)},Fe=tr=>{const ur=tr!==""?Number(tr):"";(isNumber$1(ur)&&!Number.isNaN(ur)||tr==="")&&qe(ur),dr(),k.userInput=null},Et=()=>{var tr,ur;(ur=(tr=i.value)==null?void 0:tr.focus)==null||ur.call(tr)},cr=()=>{var tr,ur;(ur=(tr=i.value)==null?void 0:tr.blur)==null||ur.call(tr)},er=tr=>{e("focus",tr)},nr=tr=>{var ur;k.userInput=null,e("blur",tr),n.validateEvent&&((ur=L==null?void 0:L.validate)==null||ur.call(L,"blur").catch(or=>void 0))},dr=()=>{k.currentValue!==n.modelValue&&(k.currentValue=n.modelValue)},ir=tr=>{document.activeElement===tr.target&&tr.preventDefault()};return watch(()=>n.modelValue,(tr,ur)=>{const or=Ue(tr,!0);k.userInput===null&&or!==ur&&(k.currentValue=or)},{immediate:!0}),onMounted(()=>{var tr;const{min:ur,max:or,modelValue:fr}=n,lr=(tr=i.value)==null?void 0:tr.input;if(lr.setAttribute("role","spinbutton"),Number.isFinite(or)?lr.setAttribute("aria-valuemax",String(or)):lr.removeAttribute("aria-valuemax"),Number.isFinite(ur)?lr.setAttribute("aria-valuemin",String(ur)):lr.removeAttribute("aria-valuemin"),lr.setAttribute("aria-valuenow",k.currentValue||k.currentValue===0?String(k.currentValue):""),lr.setAttribute("aria-disabled",String(le.value)),!isNumber$1(fr)&&fr!=null){let gr=Number(fr);Number.isNaN(gr)&&(gr=null),e(UPDATE_MODEL_EVENT,gr)}}),onUpdated(()=>{var tr,ur;const or=(tr=i.value)==null?void 0:tr.input;or==null||or.setAttribute("aria-valuenow",`${(ur=k.currentValue)!=null?ur:""}`)}),r({focus:Et,blur:cr}),(tr,ur)=>(openBlock(),createElementBlock("div",{class:normalizeClass([unref(y).b(),unref(y).m(unref(oe)),unref(y).is("disabled",unref(le)),unref(y).is("without-controls",!tr.controls),unref(y).is("controls-right",unref(re))]),onDragstart:ur[0]||(ur[0]=withModifiers(()=>{},["prevent"]))},[tr.controls?withDirectives((openBlock(),createElementBlock("span",{key:0,role:"button","aria-label":unref(g)("el.inputNumber.decrease"),class:normalizeClass([unref(y).e("decrease"),unref(y).is("disabled",unref($))]),onKeydown:withKeys(Ce,["enter"])},[createVNode(unref(ElIcon),null,{default:withCtx(()=>[unref(re)?(openBlock(),createBlock(unref(arrow_down_default),{key:0})):(openBlock(),createBlock(unref(minus_default),{key:1}))]),_:1})],42,_hoisted_1$q)),[[unref(vRepeatClick),Ce]]):createCommentVNode("v-if",!0),tr.controls?withDirectives((openBlock(),createElementBlock("span",{key:1,role:"button","aria-label":unref(g)("el.inputNumber.increase"),class:normalizeClass([unref(y).e("increase"),unref(y).is("disabled",unref(V))]),onKeydown:withKeys(de,["enter"])},[createVNode(unref(ElIcon),null,{default:withCtx(()=>[unref(re)?(openBlock(),createBlock(unref(arrow_up_default),{key:0})):(openBlock(),createBlock(unref(plus_default),{key:1}))]),_:1})],42,_hoisted_2$h)),[[unref(vRepeatClick),de]]):createCommentVNode("v-if",!0),createVNode(unref(ElInput),{id:tr.id,ref_key:"input",ref:i,type:"number",step:tr.step,"model-value":unref(ue),placeholder:tr.placeholder,readonly:tr.readonly,disabled:unref(le),size:unref(oe),max:tr.max,min:tr.min,name:tr.name,label:tr.label,"validate-event":!1,onWheel:ir,onKeydown:[withKeys(withModifiers(de,["prevent"]),["up"]),withKeys(withModifiers(Ce,["prevent"]),["down"])],onBlur:nr,onFocus:er,onInput:jt,onChange:Fe},null,8,["id","step","model-value","placeholder","readonly","disabled","size","max","min","name","label","onKeydown"])],34))}});var InputNumber=_export_sfc$1(_sfc_main$C,[["__file","input-number.vue"]]);const ElInputNumber=withInstall(InputNumber);let SubMenu$1=class{constructor(r,e){this.parent=r,this.domNode=e,this.subIndex=0,this.subIndex=0,this.init()}init(){this.subMenuItems=this.domNode.querySelectorAll("li"),this.addListeners()}gotoSubIndex(r){r===this.subMenuItems.length?r=0:r<0&&(r=this.subMenuItems.length-1),this.subMenuItems[r].focus(),this.subIndex=r}addListeners(){const r=this.parent.domNode;Array.prototype.forEach.call(this.subMenuItems,e=>{e.addEventListener("keydown",n=>{let g=!1;switch(n.code){case EVENT_CODE.down:{this.gotoSubIndex(this.subIndex+1),g=!0;break}case EVENT_CODE.up:{this.gotoSubIndex(this.subIndex-1),g=!0;break}case EVENT_CODE.tab:{triggerEvent(r,"mouseleave");break}case EVENT_CODE.enter:case EVENT_CODE.space:{g=!0,n.currentTarget.click();break}}return g&&(n.preventDefault(),n.stopPropagation()),!1})})}},MenuItem$1=class{constructor(r,e){this.domNode=r,this.submenu=null,this.submenu=null,this.init(e)}init(r){this.domNode.setAttribute("tabindex","0");const e=this.domNode.querySelector(`.${r}-menu`);e&&(this.submenu=new SubMenu$1(this,e)),this.addListeners()}addListeners(){this.domNode.addEventListener("keydown",r=>{let e=!1;switch(r.code){case EVENT_CODE.down:{triggerEvent(r.currentTarget,"mouseenter"),this.submenu&&this.submenu.gotoSubIndex(0),e=!0;break}case EVENT_CODE.up:{triggerEvent(r.currentTarget,"mouseenter"),this.submenu&&this.submenu.gotoSubIndex(this.submenu.subMenuItems.length-1),e=!0;break}case EVENT_CODE.tab:{triggerEvent(r.currentTarget,"mouseleave");break}case EVENT_CODE.enter:case EVENT_CODE.space:{e=!0,r.currentTarget.click();break}}e&&r.preventDefault()})}},Menu$1=class{constructor(r,e){this.domNode=r,this.init(e)}init(r){const e=this.domNode.childNodes;Array.from(e).forEach(n=>{n.nodeType===1&&new MenuItem$1(n,r)})}};const _sfc_main$B=defineComponent({name:"ElMenuCollapseTransition",setup(){const t=useNamespace("menu");return{listeners:{onBeforeEnter:e=>e.style.opacity="0.2",onEnter(e,n){addClass(e,`${t.namespace.value}-opacity-transition`),e.style.opacity="1",n()},onAfterEnter(e){removeClass(e,`${t.namespace.value}-opacity-transition`),e.style.opacity=""},onBeforeLeave(e){e.dataset||(e.dataset={}),hasClass(e,t.m("collapse"))?(removeClass(e,t.m("collapse")),e.dataset.oldOverflow=e.style.overflow,e.dataset.scrollWidth=e.clientWidth.toString(),addClass(e,t.m("collapse"))):(addClass(e,t.m("collapse")),e.dataset.oldOverflow=e.style.overflow,e.dataset.scrollWidth=e.clientWidth.toString(),removeClass(e,t.m("collapse"))),e.style.width=`${e.scrollWidth}px`,e.style.overflow="hidden"},onLeave(e){addClass(e,"horizontal-collapse-transition"),e.style.width=`${e.dataset.scrollWidth}px`}}}}});function _sfc_render$9(t,r,e,n,g,y){return openBlock(),createBlock(Transition,mergeProps({mode:"out-in"},t.listeners),{default:withCtx(()=>[renderSlot(t.$slots,"default")]),_:3},16)}var ElMenuCollapseTransition=_export_sfc$1(_sfc_main$B,[["render",_sfc_render$9],["__file","menu-collapse-transition.vue"]]);function useMenu(t,r){const e=computed(()=>{let g=t.parent;const y=[r.value];for(;g.type.name!=="ElMenu";)g.props.index&&y.unshift(g.props.index),g=g.parent;return y});return{parentMenu:computed(()=>{let g=t.parent;for(;g&&!["ElMenu","ElSubMenu"].includes(g.type.name);)g=g.parent;return g}),indexPath:e}}function useMenuColor(t){return computed(()=>{const e=t.backgroundColor;return e?new TinyColor(e).shade(20).toString():""})}const useMenuCssVar=(t,r)=>{const e=useNamespace("menu");return computed(()=>e.cssVarBlock({"text-color":t.textColor||"","hover-text-color":t.textColor||"","bg-color":t.backgroundColor||"","hover-bg-color":useMenuColor(t).value||"","active-color":t.activeTextColor||"",level:`${r}`}))},subMenuProps=buildProps({index:{type:String,required:!0},showTimeout:Number,hideTimeout:Number,popperClass:String,disabled:Boolean,popperAppendToBody:{type:Boolean,default:void 0},teleported:{type:Boolean,default:void 0},popperOffset:Number,expandCloseIcon:{type:iconPropType},expandOpenIcon:{type:iconPropType},collapseCloseIcon:{type:iconPropType},collapseOpenIcon:{type:iconPropType}}),COMPONENT_NAME$5="ElSubMenu";var SubMenu=defineComponent({name:COMPONENT_NAME$5,props:subMenuProps,setup(t,{slots:r,expose:e}){useDeprecated({from:"popper-append-to-body",replacement:"teleported",scope:COMPONENT_NAME$5,version:"2.3.0",ref:"https://element-plus.org/en-US/component/menu.html#submenu-attributes"},computed(()=>t.popperAppendToBody!==void 0));const n=getCurrentInstance(),{indexPath:g,parentMenu:y}=useMenu(n,computed(()=>t.index)),i=useNamespace("menu"),k=useNamespace("sub-menu"),L=inject("rootMenu");L||throwError(COMPONENT_NAME$5,"can not inject root menu");const $=inject(`subMenu:${y.value.uid}`);$||throwError(COMPONENT_NAME$5,"can not inject sub menu");const V=ref({}),z=ref({});let re;const oe=ref(!1),le=ref(),ue=ref(null),ie=computed(()=>Fe.value==="horizontal"&&Ie.value?"bottom-start":"right-start"),ae=computed(()=>Fe.value==="horizontal"&&Ie.value||Fe.value==="vertical"&&!L.props.collapse?t.expandCloseIcon&&t.expandOpenIcon?qe.value?t.expandOpenIcon:t.expandCloseIcon:arrow_down_default:t.collapseCloseIcon&&t.collapseOpenIcon?qe.value?t.collapseOpenIcon:t.collapseCloseIcon:arrow_right_default),Ie=computed(()=>$.level===0),de=computed(()=>{var gr;const Sr=(gr=t.teleported)!=null?gr:t.popperAppendToBody;return Sr===void 0?Ie.value:Sr}),Ce=computed(()=>L.props.collapse?`${i.namespace.value}-zoom-in-left`:`${i.namespace.value}-zoom-in-top`),Ue=computed(()=>Fe.value==="horizontal"&&Ie.value?["bottom-start","bottom-end","top-start","top-end","right-start","left-start"]:["right-start","right","right-end","left-start","bottom-start","bottom-end","top-start","top-end"]),qe=computed(()=>L.openedMenus.includes(t.index)),jt=computed(()=>{let gr=!1;return Object.values(V.value).forEach(Sr=>{Sr.active&&(gr=!0)}),Object.values(z.value).forEach(Sr=>{Sr.active&&(gr=!0)}),gr}),Fe=computed(()=>L.props.mode),Et=reactive({index:t.index,indexPath:g,active:jt}),cr=useMenuCssVar(L.props,$.level+1),er=computed(()=>{var gr;return(gr=t.popperOffset)!=null?gr:L.props.popperOffset}),nr=computed(()=>{var gr;return(gr=t.popperClass)!=null?gr:L.props.popperClass}),dr=computed(()=>{var gr;return(gr=t.showTimeout)!=null?gr:L.props.showTimeout}),ir=computed(()=>{var gr;return(gr=t.hideTimeout)!=null?gr:L.props.hideTimeout}),tr=()=>{var gr,Sr,wr;return(wr=(Sr=(gr=ue.value)==null?void 0:gr.popperRef)==null?void 0:Sr.popperInstanceRef)==null?void 0:wr.destroy()},ur=gr=>{gr||tr()},or=()=>{L.props.menuTrigger==="hover"&&L.props.mode==="horizontal"||L.props.collapse&&L.props.mode==="vertical"||t.disabled||L.handleSubMenuClick({index:t.index,indexPath:g.value,active:jt.value})},fr=(gr,Sr=dr.value)=>{var wr;if(gr.type!=="focus"){if(L.props.menuTrigger==="click"&&L.props.mode==="horizontal"||!L.props.collapse&&L.props.mode==="vertical"||t.disabled){$.mouseInChild.value=!0;return}$.mouseInChild.value=!0,re==null||re(),{stop:re}=useTimeoutFn(()=>{L.openMenu(t.index,g.value)},Sr),de.value&&((wr=y.value.vnode.el)==null||wr.dispatchEvent(new MouseEvent("mouseenter")))}},lr=(gr=!1)=>{var Sr;if(L.props.menuTrigger==="click"&&L.props.mode==="horizontal"||!L.props.collapse&&L.props.mode==="vertical"){$.mouseInChild.value=!1;return}re==null||re(),$.mouseInChild.value=!1,{stop:re}=useTimeoutFn(()=>!oe.value&&L.closeMenu(t.index,g.value),ir.value),de.value&&gr&&((Sr=$.handleMouseleave)==null||Sr.call($,!0))};watch(()=>L.props.collapse,gr=>ur(!!gr));{const gr=wr=>{z.value[wr.index]=wr},Sr=wr=>{delete z.value[wr.index]};provide(`subMenu:${n.uid}`,{addSubMenu:gr,removeSubMenu:Sr,handleMouseleave:lr,mouseInChild:oe,level:$.level+1})}return e({opened:qe}),onMounted(()=>{L.addSubMenu(Et),$.addSubMenu(Et)}),onBeforeUnmount(()=>{$.removeSubMenu(Et),L.removeSubMenu(Et)}),()=>{var gr;const Sr=[(gr=r.title)==null?void 0:gr.call(r),h$1(ElIcon,{class:k.e("icon-arrow"),style:{transform:qe.value?t.expandCloseIcon&&t.expandOpenIcon||t.collapseCloseIcon&&t.collapseOpenIcon&&L.props.collapse?"none":"rotateZ(180deg)":"none"}},{default:()=>isString$2(ae.value)?h$1(n.appContext.components[ae.value]):h$1(ae.value)})],wr=L.isMenuPopup?h$1(ElTooltip,{ref:ue,visible:qe.value,effect:"light",pure:!0,offset:er.value,showArrow:!1,persistent:!0,popperClass:nr.value,placement:ie.value,teleported:de.value,fallbackPlacements:Ue.value,transition:Ce.value,gpuAcceleration:!1},{content:()=>{var kr;return h$1("div",{class:[i.m(Fe.value),i.m("popup-container"),nr.value],onMouseenter:mr=>fr(mr,100),onMouseleave:()=>lr(!0),onFocus:mr=>fr(mr,100)},[h$1("ul",{class:[i.b(),i.m("popup"),i.m(`popup-${ie.value}`)],style:cr.value},[(kr=r.default)==null?void 0:kr.call(r)])])},default:()=>h$1("div",{class:k.e("title"),onClick:or},Sr)}):h$1(Fragment,{},[h$1("div",{class:k.e("title"),ref:le,onClick:or},Sr),h$1(_CollapseTransition,{},{default:()=>{var kr;return withDirectives(h$1("ul",{role:"menu",class:[i.b(),i.m("inline")],style:cr.value},[(kr=r.default)==null?void 0:kr.call(r)]),[[vShow,qe.value]])}})]);return h$1("li",{class:[k.b(),k.is("active",jt.value),k.is("opened",qe.value),k.is("disabled",t.disabled)],role:"menuitem",ariaHaspopup:!0,ariaExpanded:qe.value,onMouseenter:fr,onMouseleave:()=>lr(),onFocus:fr},[wr])}}});const menuProps=buildProps({mode:{type:String,values:["horizontal","vertical"],default:"vertical"},defaultActive:{type:String,default:""},defaultOpeneds:{type:definePropType(Array),default:()=>mutable([])},uniqueOpened:Boolean,router:Boolean,menuTrigger:{type:String,values:["hover","click"],default:"hover"},collapse:Boolean,backgroundColor:String,textColor:String,activeTextColor:String,closeOnClickOutside:Boolean,collapseTransition:{type:Boolean,default:!0},ellipsis:{type:Boolean,default:!0},popperOffset:{type:Number,default:6},ellipsisIcon:{type:iconPropType,default:()=>more_default},popperEffect:{type:String,values:["dark","light"],default:"dark"},popperClass:String,showTimeout:{type:Number,default:300},hideTimeout:{type:Number,default:300}}),checkIndexPath=t=>Array.isArray(t)&&t.every(r=>isString$2(r)),menuEmits={close:(t,r)=>isString$2(t)&&checkIndexPath(r),open:(t,r)=>isString$2(t)&&checkIndexPath(r),select:(t,r,e,n)=>isString$2(t)&&checkIndexPath(r)&&isObject$2(e)&&(n===void 0||n instanceof Promise)};var Menu=defineComponent({name:"ElMenu",props:menuProps,emits:menuEmits,setup(t,{emit:r,slots:e,expose:n}){const g=getCurrentInstance(),y=g.appContext.config.globalProperties.$router,i=ref(),k=useNamespace("menu"),L=useNamespace("sub-menu"),$=ref(-1),V=ref(t.defaultOpeneds&&!t.collapse?t.defaultOpeneds.slice(0):[]),z=ref(t.defaultActive),re=ref({}),oe=ref({}),le=computed(()=>t.mode==="horizontal"||t.mode==="vertical"&&t.collapse),ue=()=>{const ir=z.value&&re.value[z.value];if(!ir||t.mode==="horizontal"||t.collapse)return;ir.indexPath.forEach(ur=>{const or=oe.value[ur];or&&ie(ur,or.indexPath)})},ie=(ir,tr)=>{V.value.includes(ir)||(t.uniqueOpened&&(V.value=V.value.filter(ur=>tr.includes(ur))),V.value.push(ir),r("open",ir,tr))},ae=ir=>{const tr=V.value.indexOf(ir);tr!==-1&&V.value.splice(tr,1)},Ie=(ir,tr)=>{ae(ir),r("close",ir,tr)},de=({index:ir,indexPath:tr})=>{V.value.includes(ir)?Ie(ir,tr):ie(ir,tr)},Ce=ir=>{(t.mode==="horizontal"||t.collapse)&&(V.value=[]);const{index:tr,indexPath:ur}=ir;if(!(isNil(tr)||isNil(ur)))if(t.router&&y){const or=ir.route||tr,fr=y.push(or).then(lr=>(lr||(z.value=tr),lr));r("select",tr,ur,{index:tr,indexPath:ur,route:or},fr)}else z.value=tr,r("select",tr,ur,{index:tr,indexPath:ur})},Ue=ir=>{const tr=re.value,ur=tr[ir]||z.value&&tr[z.value]||tr[t.defaultActive];ur?z.value=ur.index:z.value=ir},qe=ir=>{const tr=getComputedStyle(ir),ur=Number.parseInt(tr.marginLeft,10),or=Number.parseInt(tr.marginRight,10);return ir.offsetWidth+ur+or||0},jt=()=>{var ir,tr;if(!i.value)return-1;const ur=Array.from((tr=(ir=i.value)==null?void 0:ir.childNodes)!=null?tr:[]).filter(mr=>mr.nodeName!=="#comment"&&(mr.nodeName!=="#text"||mr.nodeValue)),or=64,fr=getComputedStyle(i.value),lr=Number.parseInt(fr.paddingLeft,10),gr=Number.parseInt(fr.paddingRight,10),Sr=i.value.clientWidth-lr-gr;let wr=0,kr=0;return ur.forEach((mr,Ir)=>{wr+=qe(mr),wr<=Sr-or&&(kr=Ir+1)}),kr===ur.length?-1:kr},Fe=ir=>oe.value[ir].indexPath,Et=(ir,tr=33.34)=>{let ur;return()=>{ur&&clearTimeout(ur),ur=setTimeout(()=>{ir()},tr)}};let cr=!0;const er=()=>{const ir=()=>{$.value=-1,nextTick(()=>{$.value=jt()})};cr?ir():Et(ir)(),cr=!1};watch(()=>t.defaultActive,ir=>{re.value[ir]||(z.value=""),Ue(ir)}),watch(()=>t.collapse,ir=>{ir&&(V.value=[])}),watch(re.value,ue);let nr;watchEffect(()=>{t.mode==="horizontal"&&t.ellipsis?nr=useResizeObserver(i,er).stop:nr==null||nr()});const dr=ref(!1);{const ir=fr=>{oe.value[fr.index]=fr},tr=fr=>{delete oe.value[fr.index]};provide("rootMenu",reactive({props:t,openedMenus:V,items:re,subMenus:oe,activeIndex:z,isMenuPopup:le,addMenuItem:fr=>{re.value[fr.index]=fr},removeMenuItem:fr=>{delete re.value[fr.index]},addSubMenu:ir,removeSubMenu:tr,openMenu:ie,closeMenu:Ie,handleMenuItemClick:Ce,handleSubMenuClick:de})),provide(`subMenu:${g.uid}`,{addSubMenu:ir,removeSubMenu:tr,mouseInChild:dr,level:0})}return onMounted(()=>{t.mode==="horizontal"&&new Menu$1(g.vnode.el,k.namespace.value)}),n({open:tr=>{const{indexPath:ur}=oe.value[tr];ur.forEach(or=>ie(or,ur))},close:ae,handleResize:er}),()=>{var ir,tr;let ur=(tr=(ir=e.default)==null?void 0:ir.call(e))!=null?tr:[];const or=[];if(t.mode==="horizontal"&&i.value){const Sr=flattedChildren(ur),wr=$.value===-1?Sr:Sr.slice(0,$.value),kr=$.value===-1?[]:Sr.slice($.value);kr!=null&&kr.length&&t.ellipsis&&(ur=wr,or.push(h$1(SubMenu,{index:"sub-menu-more",class:L.e("hide-arrow"),popperOffset:t.popperOffset},{title:()=>h$1(ElIcon,{class:L.e("icon-more")},{default:()=>h$1(t.ellipsisIcon)}),default:()=>kr})))}const fr=useMenuCssVar(t,0),lr=t.closeOnClickOutside?[[ClickOutside,()=>{V.value.length&&(dr.value||(V.value.forEach(Sr=>r("close",Sr,Fe(Sr))),V.value=[]))}]]:[],gr=withDirectives(h$1("ul",{key:String(t.collapse),role:"menubar",ref:i,style:fr.value,class:{[k.b()]:!0,[k.m(t.mode)]:!0,[k.m("collapse")]:t.collapse}},[...ur,...or]),lr);return t.collapseTransition&&t.mode==="vertical"?h$1(ElMenuCollapseTransition,()=>gr):gr}}});const menuItemProps=buildProps({index:{type:definePropType([String,null]),default:null},route:{type:definePropType([String,Object])},disabled:Boolean}),menuItemEmits={click:t=>isString$2(t.index)&&Array.isArray(t.indexPath)},COMPONENT_NAME$4="ElMenuItem",_sfc_main$A=defineComponent({name:COMPONENT_NAME$4,components:{ElTooltip},props:menuItemProps,emits:menuItemEmits,setup(t,{emit:r}){const e=getCurrentInstance(),n=inject("rootMenu"),g=useNamespace("menu"),y=useNamespace("menu-item");n||throwError(COMPONENT_NAME$4,"can not inject root menu");const{parentMenu:i,indexPath:k}=useMenu(e,toRef(t,"index")),L=inject(`subMenu:${i.value.uid}`);L||throwError(COMPONENT_NAME$4,"can not inject sub menu");const $=computed(()=>t.index===n.activeIndex),V=reactive({index:t.index,indexPath:k,active:$}),z=()=>{t.disabled||(n.handleMenuItemClick({index:t.index,indexPath:k.value,route:t.route}),r("click",V))};return onMounted(()=>{L.addSubMenu(V),n.addMenuItem(V)}),onBeforeUnmount(()=>{L.removeSubMenu(V),n.removeMenuItem(V)}),{parentMenu:i,rootMenu:n,active:$,nsMenu:g,nsMenuItem:y,handleClick:z}}});function _sfc_render$8(t,r,e,n,g,y){const i=resolveComponent("el-tooltip");return openBlock(),createElementBlock("li",{class:normalizeClass([t.nsMenuItem.b(),t.nsMenuItem.is("active",t.active),t.nsMenuItem.is("disabled",t.disabled)]),role:"menuitem",tabindex:"-1",onClick:r[0]||(r[0]=(...k)=>t.handleClick&&t.handleClick(...k))},[t.parentMenu.type.name==="ElMenu"&&t.rootMenu.props.collapse&&t.$slots.title?(openBlock(),createBlock(i,{key:0,effect:t.rootMenu.props.popperEffect,placement:"right","fallback-placements":["left"],persistent:""},{content:withCtx(()=>[renderSlot(t.$slots,"title")]),default:withCtx(()=>[createBaseVNode("div",{class:normalizeClass(t.nsMenu.be("tooltip","trigger"))},[renderSlot(t.$slots,"default")],2)]),_:3},8,["effect"])):(openBlock(),createElementBlock(Fragment,{key:1},[renderSlot(t.$slots,"default"),renderSlot(t.$slots,"title")],64))],2)}var MenuItem=_export_sfc$1(_sfc_main$A,[["render",_sfc_render$8],["__file","menu-item.vue"]]);const menuItemGroupProps={title:String},COMPONENT_NAME$3="ElMenuItemGroup",_sfc_main$z=defineComponent({name:COMPONENT_NAME$3,props:menuItemGroupProps,setup(){return{ns:useNamespace("menu-item-group")}}});function _sfc_render$7(t,r,e,n,g,y){return openBlock(),createElementBlock("li",{class:normalizeClass(t.ns.b())},[createBaseVNode("div",{class:normalizeClass(t.ns.e("title"))},[t.$slots.title?renderSlot(t.$slots,"title",{key:1}):(openBlock(),createElementBlock(Fragment,{key:0},[createTextVNode(toDisplayString(t.title),1)],64))],2),createBaseVNode("ul",null,[renderSlot(t.$slots,"default")])],2)}var MenuItemGroup=_export_sfc$1(_sfc_main$z,[["render",_sfc_render$7],["__file","menu-item-group.vue"]]);const ElMenu=withInstall(Menu,{MenuItem,MenuItemGroup,SubMenu}),ElMenuItem=withNoopInstall(MenuItem);withNoopInstall(MenuItemGroup);const ElSubMenu=withNoopInstall(SubMenu),elPaginationKey=Symbol("elPaginationKey"),paginationPrevProps=buildProps({disabled:Boolean,currentPage:{type:Number,default:1},prevText:{type:String},prevIcon:{type:iconPropType}}),paginationPrevEmits={click:t=>t instanceof MouseEvent},_hoisted_1$p=["disabled","aria-label","aria-disabled"],_hoisted_2$g={key:0},__default__$c=defineComponent({name:"ElPaginationPrev"}),_sfc_main$y=defineComponent({...__default__$c,props:paginationPrevProps,emits:paginationPrevEmits,setup(t){const r=t,{t:e}=useLocale(),n=computed(()=>r.disabled||r.currentPage<=1);return(g,y)=>(openBlock(),createElementBlock("button",{type:"button",class:"btn-prev",disabled:unref(n),"aria-label":g.prevText||unref(e)("el.pagination.prev"),"aria-disabled":unref(n),onClick:y[0]||(y[0]=i=>g.$emit("click",i))},[g.prevText?(openBlock(),createElementBlock("span",_hoisted_2$g,toDisplayString(g.prevText),1)):(openBlock(),createBlock(unref(ElIcon),{key:1},{default:withCtx(()=>[(openBlock(),createBlock(resolveDynamicComponent(g.prevIcon)))]),_:1}))],8,_hoisted_1$p))}});var Prev=_export_sfc$1(_sfc_main$y,[["__file","prev.vue"]]);const paginationNextProps=buildProps({disabled:Boolean,currentPage:{type:Number,default:1},pageCount:{type:Number,default:50},nextText:{type:String},nextIcon:{type:iconPropType}}),_hoisted_1$o=["disabled","aria-label","aria-disabled"],_hoisted_2$f={key:0},__default__$b=defineComponent({name:"ElPaginationNext"}),_sfc_main$x=defineComponent({...__default__$b,props:paginationNextProps,emits:["click"],setup(t){const r=t,{t:e}=useLocale(),n=computed(()=>r.disabled||r.currentPage===r.pageCount||r.pageCount===0);return(g,y)=>(openBlock(),createElementBlock("button",{type:"button",class:"btn-next",disabled:unref(n),"aria-label":g.nextText||unref(e)("el.pagination.next"),"aria-disabled":unref(n),onClick:y[0]||(y[0]=i=>g.$emit("click",i))},[g.nextText?(openBlock(),createElementBlock("span",_hoisted_2$f,toDisplayString(g.nextText),1)):(openBlock(),createBlock(unref(ElIcon),{key:1},{default:withCtx(()=>[(openBlock(),createBlock(resolveDynamicComponent(g.nextIcon)))]),_:1}))],8,_hoisted_1$o))}});var Next=_export_sfc$1(_sfc_main$x,[["__file","next.vue"]]);const selectGroupKey=Symbol("ElSelectGroup"),selectKey=Symbol("ElSelect");function useOption(t,r){const e=inject(selectKey),n=inject(selectGroupKey,{disabled:!1}),g=computed(()=>e.props.multiple?V(e.props.modelValue,t.value):V([e.props.modelValue],t.value)),y=computed(()=>{if(e.props.multiple){const oe=e.props.modelValue||[];return!g.value&&oe.length>=e.props.multipleLimit&&e.props.multipleLimit>0}else return!1}),i=computed(()=>t.label||(isObject$2(t.value)?"":t.value)),k=computed(()=>t.value||t.label||""),L=computed(()=>t.disabled||r.groupDisabled||y.value),$=getCurrentInstance(),V=(oe=[],le)=>{if(isObject$2(t.value)){const ue=e.props.valueKey;return oe&&oe.some(ie=>toRaw(get(ie,ue))===get(le,ue))}else return oe&&oe.includes(le)},z=()=>{!t.disabled&&!n.disabled&&(e.states.hoveringIndex=e.optionsArray.indexOf($.proxy))},re=oe=>{const le=new RegExp(escapeStringRegexp(oe),"i");r.visible=le.test(i.value)||t.created};return watch(()=>i.value,()=>{!t.created&&!e.props.remote&&e.setSelected()}),watch(()=>t.value,(oe,le)=>{const{remote:ue,valueKey:ie}=e.props;if(isEqual(oe,le)||(e.onOptionDestroy(le,$.proxy),e.onOptionCreate($.proxy)),!t.created&&!ue){if(ie&&isObject$2(oe)&&isObject$2(le)&&oe[ie]===le[ie])return;e.setSelected()}}),watch(()=>n.disabled,()=>{r.groupDisabled=n.disabled},{immediate:!0}),{select:e,currentLabel:i,currentValue:k,itemSelected:g,isDisabled:L,hoverItem:z,updateOption:re}}const _sfc_main$w=defineComponent({name:"ElOption",componentName:"ElOption",props:{value:{required:!0,type:[String,Number,Boolean,Object]},label:[String,Number],created:Boolean,disabled:Boolean},setup(t){const r=useNamespace("select"),e=useId(),n=computed(()=>[r.be("dropdown","item"),r.is("disabled",unref(k)),r.is("selected",unref(i)),r.is("hovering",unref(re))]),g=reactive({index:-1,groupDisabled:!1,visible:!0,hover:!1}),{currentLabel:y,itemSelected:i,isDisabled:k,select:L,hoverItem:$,updateOption:V}=useOption(t,g),{visible:z,hover:re}=toRefs(g),oe=getCurrentInstance().proxy;L.onOptionCreate(oe),onBeforeUnmount(()=>{const ue=oe.value,{selected:ie}=L.states,Ie=(L.props.multiple?ie:[ie]).some(de=>de.value===oe.value);nextTick(()=>{L.states.cachedOptions.get(ue)===oe&&!Ie&&L.states.cachedOptions.delete(ue)}),L.onOptionDestroy(ue,oe)});function le(){t.disabled!==!0&&g.groupDisabled!==!0&&L.handleOptionSelect(oe)}return{ns:r,id:e,containerKls:n,currentLabel:y,itemSelected:i,isDisabled:k,select:L,hoverItem:$,updateOption:V,visible:z,hover:re,selectOptionClick:le,states:g}}}),_hoisted_1$n=["id","aria-disabled","aria-selected"];function _sfc_render$6(t,r,e,n,g,y){return withDirectives((openBlock(),createElementBlock("li",{id:t.id,class:normalizeClass(t.containerKls),role:"option","aria-disabled":t.isDisabled||void 0,"aria-selected":t.itemSelected,onMouseenter:r[0]||(r[0]=(...i)=>t.hoverItem&&t.hoverItem(...i)),onClick:r[1]||(r[1]=withModifiers((...i)=>t.selectOptionClick&&t.selectOptionClick(...i),["stop"]))},[renderSlot(t.$slots,"default",{},()=>[createBaseVNode("span",null,toDisplayString(t.currentLabel),1)])],42,_hoisted_1$n)),[[vShow,t.visible]])}var Option=_export_sfc$1(_sfc_main$w,[["render",_sfc_render$6],["__file","option.vue"]]);const _sfc_main$v=defineComponent({name:"ElSelectDropdown",componentName:"ElSelectDropdown",setup(){const t=inject(selectKey),r=useNamespace("select"),e=computed(()=>t.props.popperClass),n=computed(()=>t.props.multiple),g=computed(()=>t.props.fitInputWidth),y=ref("");function i(){var k;y.value=`${(k=t.selectRef)==null?void 0:k.offsetWidth}px`}return onMounted(()=>{i(),useResizeObserver(t.selectRef,i)}),{ns:r,minWidth:y,popperClass:e,isMultiple:n,isFitInputWidth:g}}});function _sfc_render$5(t,r,e,n,g,y){return openBlock(),createElementBlock("div",{class:normalizeClass([t.ns.b("dropdown"),t.ns.is("multiple",t.isMultiple),t.popperClass]),style:normalizeStyle({[t.isFitInputWidth?"width":"minWidth"]:t.minWidth})},[t.$slots.header?(openBlock(),createElementBlock("div",{key:0,class:normalizeClass(t.ns.be("dropdown","header"))},[renderSlot(t.$slots,"header")],2)):createCommentVNode("v-if",!0),renderSlot(t.$slots,"default"),t.$slots.footer?(openBlock(),createElementBlock("div",{key:1,class:normalizeClass(t.ns.be("dropdown","footer"))},[renderSlot(t.$slots,"footer")],2)):createCommentVNode("v-if",!0)],6)}var ElSelectMenu=_export_sfc$1(_sfc_main$v,[["render",_sfc_render$5],["__file","select-dropdown.vue"]]);function useInput(t){const r=ref(!1);return{handleCompositionStart:()=>{r.value=!0},handleCompositionUpdate:y=>{const i=y.target.value,k=i[i.length-1]||"";r.value=!isKorean(k)},handleCompositionEnd:y=>{r.value&&(r.value=!1,isFunction$3(t)&&t(y))}}}const MINIMUM_INPUT_WIDTH=11,useSelect=(t,r)=>{const{t:e}=useLocale(),n=useId(),g=useNamespace("select"),y=useNamespace("input"),i=reactive({inputValue:"",options:new Map,cachedOptions:new Map,disabledOptions:new Map,optionValues:[],selected:t.multiple?[]:{},selectionWidth:0,calculatorWidth:0,collapseItemWidth:0,selectedLabel:"",hoveringIndex:-1,previousQuery:null,inputHovering:!1,menuVisibleOnFocus:!1,isBeforeHide:!1});useDeprecated({from:"suffixTransition",replacement:"override style scheme",version:"2.3.0",scope:"props",ref:"https://element-plus.org/en-US/component/select.html#select-attributes"},computed(()=>t.suffixTransition===!1));const k=ref(null),L=ref(null),$=ref(null),V=ref(null),z=ref(null),re=ref(null),oe=ref(null),le=ref(null),ue=ref(null),ie=ref(null),ae=ref(null),Ie=ref(null),{wrapperRef:de,isFocused:Ce,handleFocus:Ue,handleBlur:qe}=useFocusController(z,{afterFocus(){t.automaticDropdown&&!jt.value&&(jt.value=!0,i.menuVisibleOnFocus=!0)},beforeBlur(Rn){var Xn,zo;return((Xn=$.value)==null?void 0:Xn.isFocusInsideContent(Rn))||((zo=V.value)==null?void 0:zo.isFocusInsideContent(Rn))},afterBlur(){jt.value=!1,i.menuVisibleOnFocus=!1}}),jt=ref(!1),Fe=ref(),{form:Et,formItem:cr}=useFormItem(),{inputId:er}=useFormItemInputId(t,{formItemContext:cr}),nr=computed(()=>t.disabled||(Et==null?void 0:Et.disabled)),dr=computed(()=>t.multiple?isArray$3(t.modelValue)&&t.modelValue.length>0:t.modelValue!==void 0&&t.modelValue!==null&&t.modelValue!==""),ir=computed(()=>t.clearable&&!nr.value&&i.inputHovering&&dr.value),tr=computed(()=>t.remote&&t.filterable&&!t.remoteShowSuffix?"":t.suffixIcon),ur=computed(()=>g.is("reverse",tr.value&&jt.value&&t.suffixTransition)),or=computed(()=>(cr==null?void 0:cr.validateState)||""),fr=computed(()=>ValidateComponentsMap[or.value]),lr=computed(()=>t.remote?300:0),gr=computed(()=>t.loading?t.loadingText||e("el.select.loading"):t.remote&&!i.inputValue&&i.options.size===0?!1:t.filterable&&i.inputValue&&i.options.size>0&&Sr.value===0?t.noMatchText||e("el.select.noMatch"):i.options.size===0?t.noDataText||e("el.select.noData"):null),Sr=computed(()=>wr.value.filter(Rn=>Rn.visible).length),wr=computed(()=>{const Rn=Array.from(i.options.values()),Xn=[];return i.optionValues.forEach(zo=>{const Na=Rn.findIndex(vs=>vs.value===zo);Na>-1&&Xn.push(Rn[Na])}),Xn.length>=Rn.length?Xn:Rn}),kr=computed(()=>Array.from(i.cachedOptions.values())),mr=computed(()=>{const Rn=wr.value.filter(Xn=>!Xn.created).some(Xn=>Xn.currentLabel===i.inputValue);return t.filterable&&t.allowCreate&&i.inputValue!==""&&!Rn}),Ir=()=>{t.filterable&&isFunction$3(t.filterMethod)||t.filterable&&t.remote&&isFunction$3(t.remoteMethod)||wr.value.forEach(Rn=>{Rn.updateOption(i.inputValue)})},Nr=useFormSize(),Er=computed(()=>["small"].includes(Nr.value)?"small":"default"),sr=computed({get(){return jt.value&&gr.value!==!1},set(Rn){jt.value=Rn}}),xr=computed(()=>isArray$3(t.modelValue)?t.modelValue.length===0&&!i.inputValue:t.filterable?!i.inputValue:!0),Or=computed(()=>{var Rn;const Xn=(Rn=t.placeholder)!=null?Rn:e("el.select.placeholder");return t.multiple||!dr.value?Xn:i.selectedLabel});watch(()=>t.modelValue,(Rn,Xn)=>{t.multiple&&t.filterable&&!t.reserveKeyword&&(i.inputValue="",Mr("")),hr(),!isEqual(Rn,Xn)&&t.validateEvent&&(cr==null||cr.validate("change").catch(zo=>void 0))},{flush:"post",deep:!0}),watch(()=>jt.value,Rn=>{Rn?Mr(i.inputValue):(i.inputValue="",i.previousQuery=null,i.isBeforeHide=!0),r("visible-change",Rn)}),watch(()=>i.options.entries(),()=>{var Rn;if(!isClient)return;const Xn=((Rn=k.value)==null?void 0:Rn.querySelectorAll("input"))||[];(!t.filterable&&!t.defaultFirstOption&&!isUndefined$1(t.modelValue)||!Array.from(Xn).includes(document.activeElement))&&hr(),t.defaultFirstOption&&(t.filterable||t.remote)&&Sr.value&&br()},{flush:"post"}),watch(()=>i.hoveringIndex,Rn=>{isNumber$1(Rn)&&Rn>-1?Fe.value=wr.value[Rn]||{}:Fe.value={},wr.value.forEach(Xn=>{Xn.hover=Fe.value===Xn})}),watchEffect(()=>{i.isBeforeHide||Ir()});const Mr=Rn=>{i.previousQuery!==Rn&&(i.previousQuery=Rn,t.filterable&&isFunction$3(t.filterMethod)?t.filterMethod(Rn):t.filterable&&t.remote&&isFunction$3(t.remoteMethod)&&t.remoteMethod(Rn),t.defaultFirstOption&&(t.filterable||t.remote)&&Sr.value?nextTick(br):nextTick(Br))},br=()=>{const Rn=wr.value.filter(Na=>Na.visible&&!Na.disabled&&!Na.states.groupDisabled),Xn=Rn.find(Na=>Na.created),zo=Rn[0];i.hoveringIndex=wn(wr.value,Xn||zo)},hr=()=>{if(t.multiple)i.selectedLabel="";else{const Xn=Tr(t.modelValue);i.selectedLabel=Xn.currentLabel,i.selected=Xn;return}const Rn=[];isArray$3(t.modelValue)&&t.modelValue.forEach(Xn=>{Rn.push(Tr(Xn))}),i.selected=Rn},Tr=Rn=>{let Xn;const zo=toRawType(Rn).toLowerCase()==="object",Na=toRawType(Rn).toLowerCase()==="null",vs=toRawType(Rn).toLowerCase()==="undefined";for(let Pi=i.cachedOptions.size-1;Pi>=0;Pi--){const Ti=kr.value[Pi];if(zo?get(Ti.value,t.valueKey)===get(Rn,t.valueKey):Ti.value===Rn){Xn={value:Rn,currentLabel:Ti.currentLabel,isDisabled:Ti.isDisabled};break}}if(Xn)return Xn;const Us=zo?Rn.label:!Na&&!vs?Rn:"";return{value:Rn,currentLabel:Us}},Br=()=>{t.multiple?i.selected.length>0?i.hoveringIndex=Math.min(...i.selected.map(Rn=>wr.value.findIndex(Xn=>ca(Xn)===ca(Rn)))):i.hoveringIndex=-1:i.hoveringIndex=wr.value.findIndex(Rn=>ca(Rn)===ca(i.selected))},Fr=()=>{i.selectionWidth=L.value.getBoundingClientRect().width},Lr=()=>{i.calculatorWidth=re.value.getBoundingClientRect().width},qr=()=>{i.collapseItemWidth=ae.value.getBoundingClientRect().width},Ur=()=>{var Rn,Xn;(Xn=(Rn=$.value)==null?void 0:Rn.updatePopper)==null||Xn.call(Rn)},Qr=()=>{var Rn,Xn;(Xn=(Rn=V.value)==null?void 0:Rn.updatePopper)==null||Xn.call(Rn)},vn=()=>{i.inputValue.length>0&&!jt.value&&(jt.value=!0),Mr(i.inputValue)},_n=Rn=>{if(i.inputValue=Rn.target.value,t.remote)Yr();else return vn()},Yr=debounce(()=>{vn()},lr.value),jn=Rn=>{isEqual(t.modelValue,Rn)||r(CHANGE_EVENT,Rn)},Zr=Rn=>findLastIndex(Rn,Xn=>!i.disabledOptions.has(Xn)),An=Rn=>{if(t.multiple&&Rn.code!==EVENT_CODE.delete&&Rn.target.value.length<=0){const Xn=t.modelValue.slice(),zo=Zr(Xn);if(zo<0)return;Xn.splice(zo,1),r(UPDATE_MODEL_EVENT,Xn),jn(Xn)}},Jr=(Rn,Xn)=>{const zo=i.selected.indexOf(Xn);if(zo>-1&&!nr.value){const Na=t.modelValue.slice();Na.splice(zo,1),r(UPDATE_MODEL_EVENT,Na),jn(Na),r("remove-tag",Xn.value)}Rn.stopPropagation(),Ko()},Mn=Rn=>{Rn.stopPropagation();const Xn=t.multiple?[]:"";if(!isString$2(Xn))for(const zo of i.selected)zo.isDisabled&&Xn.push(zo.value);r(UPDATE_MODEL_EVENT,Xn),jn(Xn),i.hoveringIndex=-1,jt.value=!1,r("clear"),Ko()},Bn=Rn=>{if(t.multiple){const Xn=(t.modelValue||[]).slice(),zo=wn(Xn,Rn.value);zo>-1?Xn.splice(zo,1):(t.multipleLimit<=0||Xn.length<t.multipleLimit)&&Xn.push(Rn.value),r(UPDATE_MODEL_EVENT,Xn),jn(Xn),Rn.created&&Mr(""),t.filterable&&!t.reserveKeyword&&(i.inputValue="")}else r(UPDATE_MODEL_EVENT,Rn.value),jn(Rn.value),jt.value=!1;Ko(),!jt.value&&nextTick(()=>{In(Rn)})},wn=(Rn=[],Xn)=>{if(!isObject$2(Xn))return Rn.indexOf(Xn);const zo=t.valueKey;let Na=-1;return Rn.some((vs,Us)=>toRaw(get(vs,zo))===get(Xn,zo)?(Na=Us,!0):!1),Na},In=Rn=>{var Xn,zo,Na,vs,Us;const Go=isArray$3(Rn)?Rn[0]:Rn;let Pi=null;if(Go!=null&&Go.value){const Ti=wr.value.filter(Mp=>Mp.value===Go.value);Ti.length>0&&(Pi=Ti[0].$el)}if($.value&&Pi){const Ti=(vs=(Na=(zo=(Xn=$.value)==null?void 0:Xn.popperRef)==null?void 0:zo.contentRef)==null?void 0:Na.querySelector)==null?void 0:vs.call(Na,`.${g.be("dropdown","wrap")}`);Ti&&scrollIntoView(Ti,Pi)}(Us=Ie.value)==null||Us.handleScroll()},bn=Rn=>{i.options.set(Rn.value,Rn),i.cachedOptions.set(Rn.value,Rn),Rn.disabled&&i.disabledOptions.set(Rn.value,Rn)},hn=(Rn,Xn)=>{i.options.get(Rn)===Xn&&i.options.delete(Rn)},{handleCompositionStart:Zn,handleCompositionUpdate:Oo,handleCompositionEnd:Ho}=useInput(Rn=>_n(Rn)),Do=computed(()=>{var Rn,Xn;return(Xn=(Rn=$.value)==null?void 0:Rn.popperRef)==null?void 0:Xn.contentRef}),Eo=()=>{nextTick(()=>In(i.selected))},Ko=()=>{var Rn;(Rn=z.value)==null||Rn.focus()},Wa=()=>{To()},Ts=Rn=>{Mn(Rn)},To=Rn=>{if(jt.value=!1,Ce.value){const Xn=new FocusEvent("focus",Rn);nextTick(()=>qe(Xn))}},Os=()=>{i.inputValue.length>0?i.inputValue="":jt.value=!1},to=()=>{nr.value||(i.menuVisibleOnFocus?i.menuVisibleOnFocus=!1:jt.value=!jt.value)},ha=()=>{jt.value?wr.value[i.hoveringIndex]&&Bn(wr.value[i.hoveringIndex]):to()},ca=Rn=>isObject$2(Rn.value)?get(Rn.value,t.valueKey):Rn.value,$a=computed(()=>wr.value.filter(Rn=>Rn.visible).every(Rn=>Rn.disabled)),Qa=computed(()=>t.multiple?t.collapseTags?i.selected.slice(0,t.maxCollapseTags):i.selected:[]),Xo=computed(()=>t.multiple?t.collapseTags?i.selected.slice(t.maxCollapseTags):[]:[]),ko=Rn=>{if(!jt.value){jt.value=!0;return}if(!(i.options.size===0||Sr.value===0)&&!$a.value){Rn==="next"?(i.hoveringIndex++,i.hoveringIndex===i.options.size&&(i.hoveringIndex=0)):Rn==="prev"&&(i.hoveringIndex--,i.hoveringIndex<0&&(i.hoveringIndex=i.options.size-1));const Xn=wr.value[i.hoveringIndex];(Xn.disabled===!0||Xn.states.groupDisabled===!0||!Xn.visible)&&ko(Rn),nextTick(()=>In(Fe.value))}},ja=()=>{if(!L.value)return 0;const Rn=window.getComputedStyle(L.value);return Number.parseFloat(Rn.gap||"6px")},Da=computed(()=>{const Rn=ja();return{maxWidth:`${ae.value&&t.maxCollapseTags===1?i.selectionWidth-i.collapseItemWidth-Rn:i.selectionWidth}px`}}),Hc=computed(()=>({maxWidth:`${i.selectionWidth}px`})),Rs=computed(()=>({width:`${Math.max(i.calculatorWidth,MINIMUM_INPUT_WIDTH)}px`}));return t.multiple&&!isArray$3(t.modelValue)&&r(UPDATE_MODEL_EVENT,[]),!t.multiple&&isArray$3(t.modelValue)&&r(UPDATE_MODEL_EVENT,""),useResizeObserver(L,Fr),useResizeObserver(re,Lr),useResizeObserver(ue,Ur),useResizeObserver(de,Ur),useResizeObserver(ie,Qr),useResizeObserver(ae,qr),onMounted(()=>{hr()}),{inputId:er,contentId:n,nsSelect:g,nsInput:y,states:i,isFocused:Ce,expanded:jt,optionsArray:wr,hoverOption:Fe,selectSize:Nr,filteredOptionsCount:Sr,resetCalculatorWidth:Lr,updateTooltip:Ur,updateTagTooltip:Qr,debouncedOnInputChange:Yr,onInput:_n,deletePrevTag:An,deleteTag:Jr,deleteSelected:Mn,handleOptionSelect:Bn,scrollToOption:In,hasModelValue:dr,shouldShowPlaceholder:xr,currentPlaceholder:Or,showClose:ir,iconComponent:tr,iconReverse:ur,validateState:or,validateIcon:fr,showNewOption:mr,updateOptions:Ir,collapseTagSize:Er,setSelected:hr,selectDisabled:nr,emptyText:gr,handleCompositionStart:Zn,handleCompositionUpdate:Oo,handleCompositionEnd:Ho,onOptionCreate:bn,onOptionDestroy:hn,handleMenuEnter:Eo,handleFocus:Ue,focus:Ko,blur:Wa,handleBlur:qe,handleClearClick:Ts,handleClickOutside:To,handleEsc:Os,toggleMenu:to,selectOption:ha,getValueKey:ca,navigateOptions:ko,dropdownMenuVisible:sr,showTagList:Qa,collapseTagList:Xo,tagStyle:Da,collapseTagStyle:Hc,inputStyle:Rs,popperRef:Do,inputRef:z,tooltipRef:$,tagTooltipRef:V,calculatorRef:re,prefixRef:oe,suffixRef:le,selectRef:k,wrapperRef:de,selectionRef:L,scrollbarRef:Ie,menuRef:ue,tagMenuRef:ie,collapseItemRef:ae}};var ElOptions=defineComponent({name:"ElOptions",setup(t,{slots:r}){const e=inject(selectKey);let n=[];return()=>{var g,y;const i=(g=r.default)==null?void 0:g.call(r),k=[];function L($){isArray$3($)&&$.forEach(V=>{var z,re,oe,le;const ue=(z=(V==null?void 0:V.type)||{})==null?void 0:z.name;ue==="ElOptionGroup"?L(!isString$2(V.children)&&!isArray$3(V.children)&&isFunction$3((re=V.children)==null?void 0:re.default)?(oe=V.children)==null?void 0:oe.default():V.children):ue==="ElOption"?k.push((le=V.props)==null?void 0:le.value):isArray$3(V.children)&&L(V.children)})}return i.length&&L((y=i[0])==null?void 0:y.children),isEqual(k,n)||(n=k,e&&(e.states.optionValues=k)),i}}});const SelectProps=buildProps({name:String,id:String,modelValue:{type:[Array,String,Number,Boolean,Object],default:void 0},autocomplete:{type:String,default:"off"},automaticDropdown:Boolean,size:useSizeProp,effect:{type:definePropType(String),default:"light"},disabled:Boolean,clearable:Boolean,filterable:Boolean,allowCreate:Boolean,loading:Boolean,popperClass:{type:String,default:""},popperOptions:{type:definePropType(Object),default:()=>({})},remote:Boolean,loadingText:String,noMatchText:String,noDataText:String,remoteMethod:Function,filterMethod:Function,multiple:Boolean,multipleLimit:{type:Number,default:0},placeholder:{type:String},defaultFirstOption:Boolean,reserveKeyword:{type:Boolean,default:!0},valueKey:{type:String,default:"value"},collapseTags:Boolean,collapseTagsTooltip:Boolean,maxCollapseTags:{type:Number,default:1},teleported:useTooltipContentProps.teleported,persistent:{type:Boolean,default:!0},clearIcon:{type:iconPropType,default:circle_close_default},fitInputWidth:Boolean,suffixIcon:{type:iconPropType,default:arrow_down_default},tagType:{...tagProps.type,default:"info"},validateEvent:{type:Boolean,default:!0},remoteShowSuffix:Boolean,suffixTransition:{type:Boolean,default:!0},placement:{type:definePropType(String),values:Ee,default:"bottom-start"},fallbackPlacements:{type:definePropType(Array),default:["bottom-start","top-start","right","left"]},ariaLabel:{type:String,default:void 0}}),COMPONENT_NAME$2="ElSelect",_sfc_main$u=defineComponent({name:COMPONENT_NAME$2,componentName:COMPONENT_NAME$2,components:{ElInput,ElSelectMenu,ElOption:Option,ElOptions,ElTag,ElScrollbar,ElTooltip,ElIcon},directives:{ClickOutside},props:SelectProps,emits:[UPDATE_MODEL_EVENT,CHANGE_EVENT,"remove-tag","clear","visible-change","focus","blur"],setup(t,{emit:r}){const e=useSelect(t,r);return provide(selectKey,reactive({props:t,states:e.states,optionsArray:e.optionsArray,handleOptionSelect:e.handleOptionSelect,onOptionCreate:e.onOptionCreate,onOptionDestroy:e.onOptionDestroy,selectRef:e.selectRef,setSelected:e.setSelected})),{...e}}}),_hoisted_1$m=["id","disabled","autocomplete","readonly","aria-activedescendant","aria-controls","aria-expanded","aria-label"],_hoisted_2$e=["textContent"];function _sfc_render$4(t,r,e,n,g,y){const i=resolveComponent("el-tag"),k=resolveComponent("el-tooltip"),L=resolveComponent("el-icon"),$=resolveComponent("el-option"),V=resolveComponent("el-options"),z=resolveComponent("el-scrollbar"),re=resolveComponent("el-select-menu"),oe=resolveDirective("click-outside");return withDirectives((openBlock(),createElementBlock("div",{ref:"selectRef",class:normalizeClass([t.nsSelect.b(),t.nsSelect.m(t.selectSize)]),onMouseenter:r[14]||(r[14]=le=>t.states.inputHovering=!0),onMouseleave:r[15]||(r[15]=le=>t.states.inputHovering=!1),onClick:r[16]||(r[16]=withModifiers((...le)=>t.toggleMenu&&t.toggleMenu(...le),["stop"]))},[createVNode(k,{ref:"tooltipRef",visible:t.dropdownMenuVisible,placement:t.placement,teleported:t.teleported,"popper-class":[t.nsSelect.e("popper"),t.popperClass],"popper-options":t.popperOptions,"fallback-placements":t.fallbackPlacements,effect:t.effect,pure:"",trigger:"click",transition:`${t.nsSelect.namespace.value}-zoom-in-top`,"stop-popper-mouse-event":!1,"gpu-acceleration":!1,persistent:t.persistent,onBeforeShow:t.handleMenuEnter,onHide:r[13]||(r[13]=le=>t.states.isBeforeHide=!1)},{default:withCtx(()=>{var le;return[createBaseVNode("div",{ref:"wrapperRef",class:normalizeClass([t.nsSelect.e("wrapper"),t.nsSelect.is("focused",t.isFocused),t.nsSelect.is("hovering",t.states.inputHovering),t.nsSelect.is("filterable",t.filterable),t.nsSelect.is("disabled",t.selectDisabled)])},[t.$slots.prefix?(openBlock(),createElementBlock("div",{key:0,ref:"prefixRef",class:normalizeClass(t.nsSelect.e("prefix"))},[renderSlot(t.$slots,"prefix")],2)):createCommentVNode("v-if",!0),createBaseVNode("div",{ref:"selectionRef",class:normalizeClass([t.nsSelect.e("selection"),t.nsSelect.is("near",t.multiple&&!t.$slots.prefix&&!!t.states.selected.length)])},[t.multiple?renderSlot(t.$slots,"tag",{key:0},()=>[(openBlock(!0),createElementBlock(Fragment,null,renderList(t.showTagList,ue=>(openBlock(),createElementBlock("div",{key:t.getValueKey(ue),class:normalizeClass(t.nsSelect.e("selected-item"))},[createVNode(i,{closable:!t.selectDisabled&&!ue.isDisabled,size:t.collapseTagSize,type:t.tagType,"disable-transitions":"",style:normalizeStyle(t.tagStyle),onClose:ie=>t.deleteTag(ie,ue)},{default:withCtx(()=>[createBaseVNode("span",{class:normalizeClass(t.nsSelect.e("tags-text"))},toDisplayString(ue.currentLabel),3)]),_:2},1032,["closable","size","type","style","onClose"])],2))),128)),t.collapseTags&&t.states.selected.length>t.maxCollapseTags?(openBlock(),createBlock(k,{key:0,ref:"tagTooltipRef",disabled:t.dropdownMenuVisible||!t.collapseTagsTooltip,"fallback-placements":["bottom","top","right","left"],effect:t.effect,placement:"bottom",teleported:t.teleported},{default:withCtx(()=>[createBaseVNode("div",{ref:"collapseItemRef",class:normalizeClass(t.nsSelect.e("selected-item"))},[createVNode(i,{closable:!1,size:t.collapseTagSize,type:t.tagType,"disable-transitions":"",style:normalizeStyle(t.collapseTagStyle)},{default:withCtx(()=>[createBaseVNode("span",{class:normalizeClass(t.nsSelect.e("tags-text"))}," + "+toDisplayString(t.states.selected.length-t.maxCollapseTags),3)]),_:1},8,["size","type","style"])],2)]),content:withCtx(()=>[createBaseVNode("div",{ref:"tagMenuRef",class:normalizeClass(t.nsSelect.e("selection"))},[(openBlock(!0),createElementBlock(Fragment,null,renderList(t.collapseTagList,ue=>(openBlock(),createElementBlock("div",{key:t.getValueKey(ue),class:normalizeClass(t.nsSelect.e("selected-item"))},[createVNode(i,{class:"in-tooltip",closable:!t.selectDisabled&&!ue.isDisabled,size:t.collapseTagSize,type:t.tagType,"disable-transitions":"",onClose:ie=>t.deleteTag(ie,ue)},{default:withCtx(()=>[createBaseVNode("span",{class:normalizeClass(t.nsSelect.e("tags-text"))},toDisplayString(ue.currentLabel),3)]),_:2},1032,["closable","size","type","onClose"])],2))),128))],2)]),_:1},8,["disabled","effect","teleported"])):createCommentVNode("v-if",!0)]):createCommentVNode("v-if",!0),t.selectDisabled?createCommentVNode("v-if",!0):(openBlock(),createElementBlock("div",{key:1,class:normalizeClass([t.nsSelect.e("selected-item"),t.nsSelect.e("input-wrapper"),t.nsSelect.is("hidden",!t.filterable)])},[withDirectives(createBaseVNode("input",{id:t.inputId,ref:"inputRef","onUpdate:modelValue":r[0]||(r[0]=ue=>t.states.inputValue=ue),type:"text",class:normalizeClass([t.nsSelect.e("input"),t.nsSelect.is(t.selectSize)]),disabled:t.selectDisabled,autocomplete:t.autocomplete,style:normalizeStyle(t.inputStyle),role:"combobox",readonly:!t.filterable,spellcheck:"false","aria-activedescendant":((le=t.hoverOption)==null?void 0:le.id)||"","aria-controls":t.contentId,"aria-expanded":t.dropdownMenuVisible,"aria-label":t.ariaLabel,"aria-autocomplete":"none","aria-haspopup":"listbox",onFocus:r[1]||(r[1]=(...ue)=>t.handleFocus&&t.handleFocus(...ue)),onBlur:r[2]||(r[2]=(...ue)=>t.handleBlur&&t.handleBlur(...ue)),onKeydown:[r[3]||(r[3]=withKeys(withModifiers(ue=>t.navigateOptions("next"),["stop","prevent"]),["down"])),r[4]||(r[4]=withKeys(withModifiers(ue=>t.navigateOptions("prev"),["stop","prevent"]),["up"])),r[5]||(r[5]=withKeys(withModifiers((...ue)=>t.handleEsc&&t.handleEsc(...ue),["stop","prevent"]),["esc"])),r[6]||(r[6]=withKeys(withModifiers((...ue)=>t.selectOption&&t.selectOption(...ue),["stop","prevent"]),["enter"])),r[7]||(r[7]=withKeys(withModifiers((...ue)=>t.deletePrevTag&&t.deletePrevTag(...ue),["stop"]),["delete"]))],onCompositionstart:r[8]||(r[8]=(...ue)=>t.handleCompositionStart&&t.handleCompositionStart(...ue)),onCompositionupdate:r[9]||(r[9]=(...ue)=>t.handleCompositionUpdate&&t.handleCompositionUpdate(...ue)),onCompositionend:r[10]||(r[10]=(...ue)=>t.handleCompositionEnd&&t.handleCompositionEnd(...ue)),onInput:r[11]||(r[11]=(...ue)=>t.onInput&&t.onInput(...ue)),onClick:r[12]||(r[12]=withModifiers((...ue)=>t.toggleMenu&&t.toggleMenu(...ue),["stop"]))},null,46,_hoisted_1$m),[[vModelText,t.states.inputValue]]),t.filterable?(openBlock(),createElementBlock("span",{key:0,ref:"calculatorRef","aria-hidden":"true",class:normalizeClass(t.nsSelect.e("input-calculator")),textContent:toDisplayString(t.states.inputValue)},null,10,_hoisted_2$e)):createCommentVNode("v-if",!0)],2)),t.shouldShowPlaceholder?(openBlock(),createElementBlock("div",{key:2,class:normalizeClass([t.nsSelect.e("selected-item"),t.nsSelect.e("placeholder"),t.nsSelect.is("transparent",!t.hasModelValue||t.expanded&&!t.states.inputValue)])},[createBaseVNode("span",null,toDisplayString(t.currentPlaceholder),1)],2)):createCommentVNode("v-if",!0)],2),createBaseVNode("div",{ref:"suffixRef",class:normalizeClass(t.nsSelect.e("suffix"))},[t.iconComponent&&!t.showClose?(openBlock(),createBlock(L,{key:0,class:normalizeClass([t.nsSelect.e("caret"),t.nsSelect.e("icon"),t.iconReverse])},{default:withCtx(()=>[(openBlock(),createBlock(resolveDynamicComponent(t.iconComponent)))]),_:1},8,["class"])):createCommentVNode("v-if",!0),t.showClose&&t.clearIcon?(openBlock(),createBlock(L,{key:1,class:normalizeClass([t.nsSelect.e("caret"),t.nsSelect.e("icon")]),onClick:t.handleClearClick},{default:withCtx(()=>[(openBlock(),createBlock(resolveDynamicComponent(t.clearIcon)))]),_:1},8,["class","onClick"])):createCommentVNode("v-if",!0),t.validateState&&t.validateIcon?(openBlock(),createBlock(L,{key:2,class:normalizeClass([t.nsInput.e("icon"),t.nsInput.e("validateIcon")])},{default:withCtx(()=>[(openBlock(),createBlock(resolveDynamicComponent(t.validateIcon)))]),_:1},8,["class"])):createCommentVNode("v-if",!0)],2)],2)]}),content:withCtx(()=>[createVNode(re,{ref:"menuRef"},{default:withCtx(()=>[t.$slots.header?(openBlock(),createElementBlock("div",{key:0,class:normalizeClass(t.nsSelect.be("dropdown","header"))},[renderSlot(t.$slots,"header")],2)):createCommentVNode("v-if",!0),withDirectives(createVNode(z,{id:t.contentId,ref:"scrollbarRef",tag:"ul","wrap-class":t.nsSelect.be("dropdown","wrap"),"view-class":t.nsSelect.be("dropdown","list"),class:normalizeClass([t.nsSelect.is("empty",t.filteredOptionsCount===0)]),role:"listbox","aria-label":t.ariaLabel,"aria-orientation":"vertical"},{default:withCtx(()=>[t.showNewOption?(openBlock(),createBlock($,{key:0,value:t.states.inputValue,created:!0},null,8,["value"])):createCommentVNode("v-if",!0),createVNode(V,null,{default:withCtx(()=>[renderSlot(t.$slots,"default")]),_:3})]),_:3},8,["id","wrap-class","view-class","class","aria-label"]),[[vShow,t.states.options.size>0&&!t.loading]]),t.$slots.loading&&t.loading?(openBlock(),createElementBlock("div",{key:1,class:normalizeClass(t.nsSelect.be("dropdown","loading"))},[renderSlot(t.$slots,"loading")],2)):t.loading||t.filteredOptionsCount===0?(openBlock(),createElementBlock("div",{key:2,class:normalizeClass(t.nsSelect.be("dropdown","empty"))},[renderSlot(t.$slots,"empty",{},()=>[createBaseVNode("span",null,toDisplayString(t.emptyText),1)])],2)):createCommentVNode("v-if",!0),t.$slots.footer?(openBlock(),createElementBlock("div",{key:3,class:normalizeClass(t.nsSelect.be("dropdown","footer"))},[renderSlot(t.$slots,"footer")],2)):createCommentVNode("v-if",!0)]),_:3},512)]),_:3},8,["visible","placement","teleported","popper-class","popper-options","fallback-placements","effect","transition","persistent","onBeforeShow"])],34)),[[oe,t.handleClickOutside,t.popperRef]])}var Select=_export_sfc$1(_sfc_main$u,[["render",_sfc_render$4],["__file","select.vue"]]);const _sfc_main$t=defineComponent({name:"ElOptionGroup",componentName:"ElOptionGroup",props:{label:String,disabled:Boolean},setup(t){const r=useNamespace("select"),e=ref(null),n=getCurrentInstance(),g=ref([]);provide(selectGroupKey,reactive({...toRefs(t)}));const y=computed(()=>g.value.some(L=>L.visible===!0)),i=L=>{const $=[];return isArray$3(L.children)&&L.children.forEach(V=>{var z,re;V.type&&V.type.name==="ElOption"&&V.component&&V.component.proxy?$.push(V.component.proxy):(z=V.children)!=null&&z.length?$.push(...i(V)):(re=V.component)!=null&&re.subTree&&$.push(...i(V.component.subTree))}),$},k=()=>{g.value=i(n.subTree)};return onMounted(()=>{k()}),useMutationObserver(e,k,{attributes:!0,subtree:!0,childList:!0}),{groupRef:e,visible:y,ns:r}}});function _sfc_render$3(t,r,e,n,g,y){return withDirectives((openBlock(),createElementBlock("ul",{ref:"groupRef",class:normalizeClass(t.ns.be("group","wrap"))},[createBaseVNode("li",{class:normalizeClass(t.ns.be("group","title"))},toDisplayString(t.label),3),createBaseVNode("li",null,[createBaseVNode("ul",{class:normalizeClass(t.ns.b("group"))},[renderSlot(t.$slots,"default")],2)])],2)),[[vShow,t.visible]])}var OptionGroup=_export_sfc$1(_sfc_main$t,[["render",_sfc_render$3],["__file","option-group.vue"]]);const ElSelect=withInstall(Select,{Option,OptionGroup}),ElOption=withNoopInstall(Option);withNoopInstall(OptionGroup);const usePagination=()=>inject(elPaginationKey,{}),paginationSizesProps=buildProps({pageSize:{type:Number,required:!0},pageSizes:{type:definePropType(Array),default:()=>mutable([10,20,30,40,50,100])},popperClass:{type:String},disabled:Boolean,teleported:Boolean,size:{type:String,values:componentSizes}}),__default__$a=defineComponent({name:"ElPaginationSizes"}),_sfc_main$s=defineComponent({...__default__$a,props:paginationSizesProps,emits:["page-size-change"],setup(t,{emit:r}){const e=t,{t:n}=useLocale(),g=useNamespace("pagination"),y=usePagination(),i=ref(e.pageSize);watch(()=>e.pageSizes,($,V)=>{if(!isEqual($,V)&&Array.isArray($)){const z=$.includes(e.pageSize)?e.pageSize:e.pageSizes[0];r("page-size-change",z)}}),watch(()=>e.pageSize,$=>{i.value=$});const k=computed(()=>e.pageSizes);function L($){var V;$!==i.value&&(i.value=$,(V=y.handleSizeChange)==null||V.call(y,Number($)))}return($,V)=>(openBlock(),createElementBlock("span",{class:normalizeClass(unref(g).e("sizes"))},[createVNode(unref(ElSelect),{"model-value":i.value,disabled:$.disabled,"popper-class":$.popperClass,size:$.size,teleported:$.teleported,"validate-event":!1,onChange:L},{default:withCtx(()=>[(openBlock(!0),createElementBlock(Fragment,null,renderList(unref(k),z=>(openBlock(),createBlock(unref(ElOption),{key:z,value:z,label:z+unref(n)("el.pagination.pagesize")},null,8,["value","label"]))),128))]),_:1},8,["model-value","disabled","popper-class","size","teleported"])],2))}});var Sizes=_export_sfc$1(_sfc_main$s,[["__file","sizes.vue"]]);const paginationJumperProps=buildProps({size:{type:String,values:componentSizes}}),_hoisted_1$l=["disabled"],__default__$9=defineComponent({name:"ElPaginationJumper"}),_sfc_main$r=defineComponent({...__default__$9,props:paginationJumperProps,setup(t){const{t:r}=useLocale(),e=useNamespace("pagination"),{pageCount:n,disabled:g,currentPage:y,changeEvent:i}=usePagination(),k=ref(),L=computed(()=>{var z;return(z=k.value)!=null?z:y==null?void 0:y.value});function $(z){k.value=z?+z:""}function V(z){z=Math.trunc(+z),i==null||i(z),k.value=void 0}return(z,re)=>(openBlock(),createElementBlock("span",{class:normalizeClass(unref(e).e("jump")),disabled:unref(g)},[createBaseVNode("span",{class:normalizeClass([unref(e).e("goto")])},toDisplayString(unref(r)("el.pagination.goto")),3),createVNode(unref(ElInput),{size:z.size,class:normalizeClass([unref(e).e("editor"),unref(e).is("in-pagination")]),min:1,max:unref(n),disabled:unref(g),"model-value":unref(L),"validate-event":!1,label:unref(r)("el.pagination.page"),type:"number","onUpdate:modelValue":$,onChange:V},null,8,["size","class","max","disabled","model-value","label"]),createBaseVNode("span",{class:normalizeClass([unref(e).e("classifier")])},toDisplayString(unref(r)("el.pagination.pageClassifier")),3)],10,_hoisted_1$l))}});var Jumper=_export_sfc$1(_sfc_main$r,[["__file","jumper.vue"]]);const paginationTotalProps=buildProps({total:{type:Number,default:1e3}}),_hoisted_1$k=["disabled"],__default__$8=defineComponent({name:"ElPaginationTotal"}),_sfc_main$q=defineComponent({...__default__$8,props:paginationTotalProps,setup(t){const{t:r}=useLocale(),e=useNamespace("pagination"),{disabled:n}=usePagination();return(g,y)=>(openBlock(),createElementBlock("span",{class:normalizeClass(unref(e).e("total")),disabled:unref(n)},toDisplayString(unref(r)("el.pagination.total",{total:g.total})),11,_hoisted_1$k))}});var Total=_export_sfc$1(_sfc_main$q,[["__file","total.vue"]]);const paginationPagerProps=buildProps({currentPage:{type:Number,default:1},pageCount:{type:Number,required:!0},pagerCount:{type:Number,default:7},disabled:Boolean}),_hoisted_1$j=["onKeyup"],_hoisted_2$d=["aria-current","aria-label","tabindex"],_hoisted_3$a=["tabindex","aria-label"],_hoisted_4$8=["aria-current","aria-label","tabindex"],_hoisted_5$7=["tabindex","aria-label"],_hoisted_6$4=["aria-current","aria-label","tabindex"],__default__$7=defineComponent({name:"ElPaginationPager"}),_sfc_main$p=defineComponent({...__default__$7,props:paginationPagerProps,emits:["change"],setup(t,{emit:r}){const e=t,n=useNamespace("pager"),g=useNamespace("icon"),{t:y}=useLocale(),i=ref(!1),k=ref(!1),L=ref(!1),$=ref(!1),V=ref(!1),z=ref(!1),re=computed(()=>{const Ce=e.pagerCount,Ue=(Ce-1)/2,qe=Number(e.currentPage),jt=Number(e.pageCount);let Fe=!1,Et=!1;jt>Ce&&(qe>Ce-Ue&&(Fe=!0),qe<jt-Ue&&(Et=!0));const cr=[];if(Fe&&!Et){const er=jt-(Ce-2);for(let nr=er;nr<jt;nr++)cr.push(nr)}else if(!Fe&&Et)for(let er=2;er<Ce;er++)cr.push(er);else if(Fe&&Et){const er=Math.floor(Ce/2)-1;for(let nr=qe-er;nr<=qe+er;nr++)cr.push(nr)}else for(let er=2;er<jt;er++)cr.push(er);return cr}),oe=computed(()=>["more","btn-quickprev",g.b(),n.is("disabled",e.disabled)]),le=computed(()=>["more","btn-quicknext",g.b(),n.is("disabled",e.disabled)]),ue=computed(()=>e.disabled?-1:0);watchEffect(()=>{const Ce=(e.pagerCount-1)/2;i.value=!1,k.value=!1,e.pageCount>e.pagerCount&&(e.currentPage>e.pagerCount-Ce&&(i.value=!0),e.currentPage<e.pageCount-Ce&&(k.value=!0))});function ie(Ce=!1){e.disabled||(Ce?L.value=!0:$.value=!0)}function ae(Ce=!1){Ce?V.value=!0:z.value=!0}function Ie(Ce){const Ue=Ce.target;if(Ue.tagName.toLowerCase()==="li"&&Array.from(Ue.classList).includes("number")){const qe=Number(Ue.textContent);qe!==e.currentPage&&r("change",qe)}else Ue.tagName.toLowerCase()==="li"&&Array.from(Ue.classList).includes("more")&&de(Ce)}function de(Ce){const Ue=Ce.target;if(Ue.tagName.toLowerCase()==="ul"||e.disabled)return;let qe=Number(Ue.textContent);const jt=e.pageCount,Fe=e.currentPage,Et=e.pagerCount-2;Ue.className.includes("more")&&(Ue.className.includes("quickprev")?qe=Fe-Et:Ue.className.includes("quicknext")&&(qe=Fe+Et)),Number.isNaN(+qe)||(qe<1&&(qe=1),qe>jt&&(qe=jt)),qe!==Fe&&r("change",qe)}return(Ce,Ue)=>(openBlock(),createElementBlock("ul",{class:normalizeClass(unref(n).b()),onClick:de,onKeyup:withKeys(Ie,["enter"])},[Ce.pageCount>0?(openBlock(),createElementBlock("li",{key:0,class:normalizeClass([[unref(n).is("active",Ce.currentPage===1),unref(n).is("disabled",Ce.disabled)],"number"]),"aria-current":Ce.currentPage===1,"aria-label":unref(y)("el.pagination.currentPage",{pager:1}),tabindex:unref(ue)}," 1 ",10,_hoisted_2$d)):createCommentVNode("v-if",!0),i.value?(openBlock(),createElementBlock("li",{key:1,class:normalizeClass(unref(oe)),tabindex:unref(ue),"aria-label":unref(y)("el.pagination.prevPages",{pager:Ce.pagerCount-2}),onMouseenter:Ue[0]||(Ue[0]=qe=>ie(!0)),onMouseleave:Ue[1]||(Ue[1]=qe=>L.value=!1),onFocus:Ue[2]||(Ue[2]=qe=>ae(!0)),onBlur:Ue[3]||(Ue[3]=qe=>V.value=!1)},[(L.value||V.value)&&!Ce.disabled?(openBlock(),createBlock(unref(d_arrow_left_default),{key:0})):(openBlock(),createBlock(unref(more_filled_default),{key:1}))],42,_hoisted_3$a)):createCommentVNode("v-if",!0),(openBlock(!0),createElementBlock(Fragment,null,renderList(unref(re),qe=>(openBlock(),createElementBlock("li",{key:qe,class:normalizeClass([[unref(n).is("active",Ce.currentPage===qe),unref(n).is("disabled",Ce.disabled)],"number"]),"aria-current":Ce.currentPage===qe,"aria-label":unref(y)("el.pagination.currentPage",{pager:qe}),tabindex:unref(ue)},toDisplayString(qe),11,_hoisted_4$8))),128)),k.value?(openBlock(),createElementBlock("li",{key:2,class:normalizeClass(unref(le)),tabindex:unref(ue),"aria-label":unref(y)("el.pagination.nextPages",{pager:Ce.pagerCount-2}),onMouseenter:Ue[4]||(Ue[4]=qe=>ie()),onMouseleave:Ue[5]||(Ue[5]=qe=>$.value=!1),onFocus:Ue[6]||(Ue[6]=qe=>ae()),onBlur:Ue[7]||(Ue[7]=qe=>z.value=!1)},[($.value||z.value)&&!Ce.disabled?(openBlock(),createBlock(unref(d_arrow_right_default),{key:0})):(openBlock(),createBlock(unref(more_filled_default),{key:1}))],42,_hoisted_5$7)):createCommentVNode("v-if",!0),Ce.pageCount>1?(openBlock(),createElementBlock("li",{key:3,class:normalizeClass([[unref(n).is("active",Ce.currentPage===Ce.pageCount),unref(n).is("disabled",Ce.disabled)],"number"]),"aria-current":Ce.currentPage===Ce.pageCount,"aria-label":unref(y)("el.pagination.currentPage",{pager:Ce.pageCount}),tabindex:unref(ue)},toDisplayString(Ce.pageCount),11,_hoisted_6$4)):createCommentVNode("v-if",!0)],42,_hoisted_1$j))}});var Pager=_export_sfc$1(_sfc_main$p,[["__file","pager.vue"]]);const isAbsent=t=>typeof t!="number",paginationProps=buildProps({pageSize:Number,defaultPageSize:Number,total:Number,pageCount:Number,pagerCount:{type:Number,validator:t=>isNumber$1(t)&&Math.trunc(t)===t&&t>4&&t<22&&t%2===1,default:7},currentPage:Number,defaultCurrentPage:Number,layout:{type:String,default:["prev","pager","next","jumper","->","total"].join(", ")},pageSizes:{type:definePropType(Array),default:()=>mutable([10,20,30,40,50,100])},popperClass:{type:String,default:""},prevText:{type:String,default:""},prevIcon:{type:iconPropType,default:()=>arrow_left_default},nextText:{type:String,default:""},nextIcon:{type:iconPropType,default:()=>arrow_right_default},teleported:{type:Boolean,default:!0},small:Boolean,background:Boolean,disabled:Boolean,hideOnSinglePage:Boolean}),paginationEmits={"update:current-page":t=>isNumber$1(t),"update:page-size":t=>isNumber$1(t),"size-change":t=>isNumber$1(t),change:(t,r)=>isNumber$1(t)&&isNumber$1(r),"current-change":t=>isNumber$1(t),"prev-click":t=>isNumber$1(t),"next-click":t=>isNumber$1(t)},componentName="ElPagination";var Pagination=defineComponent({name:componentName,props:paginationProps,emits:paginationEmits,setup(t,{emit:r,slots:e}){const{t:n}=useLocale(),g=useNamespace("pagination"),y=getCurrentInstance().vnode.props||{},i="onUpdate:currentPage"in y||"onUpdate:current-page"in y||"onCurrentChange"in y,k="onUpdate:pageSize"in y||"onUpdate:page-size"in y||"onSizeChange"in y,L=computed(()=>{if(isAbsent(t.total)&&isAbsent(t.pageCount)||!isAbsent(t.currentPage)&&!i)return!1;if(t.layout.includes("sizes")){if(isAbsent(t.pageCount)){if(!isAbsent(t.total)&&!isAbsent(t.pageSize)&&!k)return!1}else if(!k)return!1}return!0}),$=ref(isAbsent(t.defaultPageSize)?10:t.defaultPageSize),V=ref(isAbsent(t.defaultCurrentPage)?1:t.defaultCurrentPage),z=computed({get(){return isAbsent(t.pageSize)?$.value:t.pageSize},set(de){isAbsent(t.pageSize)&&($.value=de),k&&(r("update:page-size",de),r("size-change",de))}}),re=computed(()=>{let de=0;return isAbsent(t.pageCount)?isAbsent(t.total)||(de=Math.max(1,Math.ceil(t.total/z.value))):de=t.pageCount,de}),oe=computed({get(){return isAbsent(t.currentPage)?V.value:t.currentPage},set(de){let Ce=de;de<1?Ce=1:de>re.value&&(Ce=re.value),isAbsent(t.currentPage)&&(V.value=Ce),i&&(r("update:current-page",Ce),r("current-change",Ce))}});watch(re,de=>{oe.value>de&&(oe.value=de)}),watch([oe,z],de=>{r("change",...de)},{flush:"post"});function le(de){oe.value=de}function ue(de){z.value=de;const Ce=re.value;oe.value>Ce&&(oe.value=Ce)}function ie(){t.disabled||(oe.value-=1,r("prev-click",oe.value))}function ae(){t.disabled||(oe.value+=1,r("next-click",oe.value))}function Ie(de,Ce){de&&(de.props||(de.props={}),de.props.class=[de.props.class,Ce].join(" "))}return provide(elPaginationKey,{pageCount:re,disabled:computed(()=>t.disabled),currentPage:oe,changeEvent:le,handleSizeChange:ue}),()=>{var de,Ce;if(!L.value)return n("el.pagination.deprecationWarning"),null;if(!t.layout||t.hideOnSinglePage&&re.value<=1)return null;const Ue=[],qe=[],jt=h$1("div",{class:g.e("rightwrapper")},qe),Fe={prev:h$1(Prev,{disabled:t.disabled,currentPage:oe.value,prevText:t.prevText,prevIcon:t.prevIcon,onClick:ie}),jumper:h$1(Jumper,{size:t.small?"small":"default"}),pager:h$1(Pager,{currentPage:oe.value,pageCount:re.value,pagerCount:t.pagerCount,onChange:le,disabled:t.disabled}),next:h$1(Next,{disabled:t.disabled,currentPage:oe.value,pageCount:re.value,nextText:t.nextText,nextIcon:t.nextIcon,onClick:ae}),sizes:h$1(Sizes,{pageSize:z.value,pageSizes:t.pageSizes,popperClass:t.popperClass,disabled:t.disabled,teleported:t.teleported,size:t.small?"small":"default"}),slot:(Ce=(de=e==null?void 0:e.default)==null?void 0:de.call(e))!=null?Ce:null,total:h$1(Total,{total:isAbsent(t.total)?0:t.total})},Et=t.layout.split(",").map(er=>er.trim());let cr=!1;return Et.forEach(er=>{if(er==="->"){cr=!0;return}cr?qe.push(Fe[er]):Ue.push(Fe[er])}),Ie(Ue[0],g.is("first")),Ie(Ue[Ue.length-1],g.is("last")),cr&&qe.length>0&&(Ie(qe[0],g.is("first")),Ie(qe[qe.length-1],g.is("last")),Ue.push(jt)),h$1("div",{class:[g.b(),g.is("background",t.background),{[g.m("small")]:t.small}]},Ue)}}});const ElPagination=withInstall(Pagination),progressProps=buildProps({type:{type:String,default:"line",values:["line","circle","dashboard"]},percentage:{type:Number,default:0,validator:t=>t>=0&&t<=100},status:{type:String,default:"",values:["","success","exception","warning"]},indeterminate:{type:Boolean,default:!1},duration:{type:Number,default:3},strokeWidth:{type:Number,default:6},strokeLinecap:{type:definePropType(String),default:"round"},textInside:{type:Boolean,default:!1},width:{type:Number,default:126},showText:{type:Boolean,default:!0},color:{type:definePropType([String,Array,Function]),default:""},striped:Boolean,stripedFlow:Boolean,format:{type:definePropType(Function),default:t=>`${t}%`}}),_hoisted_1$i=["aria-valuenow"],_hoisted_2$c={viewBox:"0 0 100 100"},_hoisted_3$9=["d","stroke","stroke-linecap","stroke-width"],_hoisted_4$7=["d","stroke","opacity","stroke-linecap","stroke-width"],_hoisted_5$6={key:0},__default__$6=defineComponent({name:"ElProgress"}),_sfc_main$o=defineComponent({...__default__$6,props:progressProps,setup(t){const r=t,e={success:"#13ce66",exception:"#ff4949",warning:"#e6a23c",default:"#20a0ff"},n=useNamespace("progress"),g=computed(()=>({width:`${r.percentage}%`,animationDuration:`${r.duration}s`,backgroundColor:Ie(r.percentage)})),y=computed(()=>(r.strokeWidth/r.width*100).toFixed(1)),i=computed(()=>["circle","dashboard"].includes(r.type)?Number.parseInt(`${50-Number.parseFloat(y.value)/2}`,10):0),k=computed(()=>{const de=i.value,Ce=r.type==="dashboard";return`
          M 50 50
          m 0 ${Ce?"":"-"}${de}
          a ${de} ${de} 0 1 1 0 ${Ce?"-":""}${de*2}
          a ${de} ${de} 0 1 1 0 ${Ce?"":"-"}${de*2}
          `}),L=computed(()=>2*Math.PI*i.value),$=computed(()=>r.type==="dashboard"?.75:1),V=computed(()=>`${-1*L.value*(1-$.value)/2}px`),z=computed(()=>({strokeDasharray:`${L.value*$.value}px, ${L.value}px`,strokeDashoffset:V.value})),re=computed(()=>({strokeDasharray:`${L.value*$.value*(r.percentage/100)}px, ${L.value}px`,strokeDashoffset:V.value,transition:"stroke-dasharray 0.6s ease 0s, stroke 0.6s ease, opacity ease 0.6s"})),oe=computed(()=>{let de;return r.color?de=Ie(r.percentage):de=e[r.status]||e.default,de}),le=computed(()=>r.status==="warning"?warning_filled_default:r.type==="line"?r.status==="success"?circle_check_default:circle_close_default:r.status==="success"?check_default:close_default),ue=computed(()=>r.type==="line"?12+r.strokeWidth*.4:r.width*.111111+2),ie=computed(()=>r.format(r.percentage));function ae(de){const Ce=100/de.length;return de.map((qe,jt)=>isString$2(qe)?{color:qe,percentage:(jt+1)*Ce}:qe).sort((qe,jt)=>qe.percentage-jt.percentage)}const Ie=de=>{var Ce;const{color:Ue}=r;if(isFunction$3(Ue))return Ue(de);if(isString$2(Ue))return Ue;{const qe=ae(Ue);for(const jt of qe)if(jt.percentage>de)return jt.color;return(Ce=qe[qe.length-1])==null?void 0:Ce.color}};return(de,Ce)=>(openBlock(),createElementBlock("div",{class:normalizeClass([unref(n).b(),unref(n).m(de.type),unref(n).is(de.status),{[unref(n).m("without-text")]:!de.showText,[unref(n).m("text-inside")]:de.textInside}]),role:"progressbar","aria-valuenow":de.percentage,"aria-valuemin":"0","aria-valuemax":"100"},[de.type==="line"?(openBlock(),createElementBlock("div",{key:0,class:normalizeClass(unref(n).b("bar"))},[createBaseVNode("div",{class:normalizeClass(unref(n).be("bar","outer")),style:normalizeStyle({height:`${de.strokeWidth}px`})},[createBaseVNode("div",{class:normalizeClass([unref(n).be("bar","inner"),{[unref(n).bem("bar","inner","indeterminate")]:de.indeterminate},{[unref(n).bem("bar","inner","striped")]:de.striped},{[unref(n).bem("bar","inner","striped-flow")]:de.stripedFlow}]),style:normalizeStyle(unref(g))},[(de.showText||de.$slots.default)&&de.textInside?(openBlock(),createElementBlock("div",{key:0,class:normalizeClass(unref(n).be("bar","innerText"))},[renderSlot(de.$slots,"default",{percentage:de.percentage},()=>[createBaseVNode("span",null,toDisplayString(unref(ie)),1)])],2)):createCommentVNode("v-if",!0)],6)],6)],2)):(openBlock(),createElementBlock("div",{key:1,class:normalizeClass(unref(n).b("circle")),style:normalizeStyle({height:`${de.width}px`,width:`${de.width}px`})},[(openBlock(),createElementBlock("svg",_hoisted_2$c,[createBaseVNode("path",{class:normalizeClass(unref(n).be("circle","track")),d:unref(k),stroke:`var(${unref(n).cssVarName("fill-color-light")}, #e5e9f2)`,"stroke-linecap":de.strokeLinecap,"stroke-width":unref(y),fill:"none",style:normalizeStyle(unref(z))},null,14,_hoisted_3$9),createBaseVNode("path",{class:normalizeClass(unref(n).be("circle","path")),d:unref(k),stroke:unref(oe),fill:"none",opacity:de.percentage?1:0,"stroke-linecap":de.strokeLinecap,"stroke-width":unref(y),style:normalizeStyle(unref(re))},null,14,_hoisted_4$7)]))],6)),(de.showText||de.$slots.default)&&!de.textInside?(openBlock(),createElementBlock("div",{key:2,class:normalizeClass(unref(n).e("text")),style:normalizeStyle({fontSize:`${unref(ue)}px`})},[renderSlot(de.$slots,"default",{percentage:de.percentage},()=>[de.status?(openBlock(),createBlock(unref(ElIcon),{key:1},{default:withCtx(()=>[(openBlock(),createBlock(resolveDynamicComponent(unref(le))))]),_:1})):(openBlock(),createElementBlock("span",_hoisted_5$6,toDisplayString(unref(ie)),1))])],6)):createCommentVNode("v-if",!0)],10,_hoisted_1$i))}});var Progress=_export_sfc$1(_sfc_main$o,[["__file","progress.vue"]]);const ElProgress=withInstall(Progress),spaceItemProps=buildProps({prefixCls:{type:String}}),SpaceItem=defineComponent({name:"ElSpaceItem",props:spaceItemProps,setup(t,{slots:r}){const e=useNamespace("space"),n=computed(()=>`${t.prefixCls||e.b()}__item`);return()=>h$1("div",{class:n.value},renderSlot(r,"default"))}}),SIZE_MAP={small:8,default:12,large:16};function useSpace(t){const r=useNamespace("space"),e=computed(()=>[r.b(),r.m(t.direction),t.class]),n=ref(0),g=ref(0),y=computed(()=>{const k=t.wrap||t.fill?{flexWrap:"wrap"}:{},L={alignItems:t.alignment},$={rowGap:`${g.value}px`,columnGap:`${n.value}px`};return[k,L,$,t.style]}),i=computed(()=>t.fill?{flexGrow:1,minWidth:`${t.fillRatio}%`}:{});return watchEffect(()=>{const{size:k="small",wrap:L,direction:$,fill:V}=t;if(isArray$3(k)){const[z=0,re=0]=k;n.value=z,g.value=re}else{let z;isNumber$1(k)?z=k:z=SIZE_MAP[k||"small"]||SIZE_MAP.small,(L||V)&&$==="horizontal"?n.value=g.value=z:$==="horizontal"?(n.value=z,g.value=0):(g.value=z,n.value=0)}}),{classes:e,containerStyle:y,itemStyle:i}}const spaceProps=buildProps({direction:{type:String,values:["horizontal","vertical"],default:"horizontal"},class:{type:definePropType([String,Object,Array]),default:""},style:{type:definePropType([String,Array,Object]),default:""},alignment:{type:definePropType(String),default:"center"},prefixCls:{type:String},spacer:{type:definePropType([Object,String,Number,Array]),default:null,validator:t=>isVNode(t)||isNumber$1(t)||isString$2(t)},wrap:Boolean,fill:Boolean,fillRatio:{type:Number,default:100},size:{type:[String,Array,Number],values:componentSizes,validator:t=>isNumber$1(t)||isArray$3(t)&&t.length===2&&t.every(isNumber$1)}}),Space=defineComponent({name:"ElSpace",props:spaceProps,setup(t,{slots:r}){const{classes:e,containerStyle:n,itemStyle:g}=useSpace(t);function y(i,k="",L=[]){const{prefixCls:$}=t;return i.forEach((V,z)=>{isFragment(V)?isArray$3(V.children)&&V.children.forEach((re,oe)=>{isFragment(re)&&isArray$3(re.children)?y(re.children,`${k+oe}-`,L):L.push(createVNode(SpaceItem,{style:g.value,prefixCls:$,key:`nested-${k+oe}`},{default:()=>[re]},PatchFlags.PROPS|PatchFlags.STYLE,["style","prefixCls"]))}):isValidElementNode(V)&&L.push(createVNode(SpaceItem,{style:g.value,prefixCls:$,key:`LoopKey${k+z}`},{default:()=>[V]},PatchFlags.PROPS|PatchFlags.STYLE,["style","prefixCls"]))}),L}return()=>{var i;const{spacer:k,direction:L}=t,$=renderSlot(r,"default",{key:0},()=>[]);if(((i=$.children)!=null?i:[]).length===0)return null;if(isArray$3($.children)){let V=y($.children);if(k){const z=V.length-1;V=V.reduce((re,oe,le)=>{const ue=[...re,oe];return le!==z&&ue.push(createVNode("span",{style:[g.value,L==="vertical"?"width: 100%":null],key:le},[isVNode(k)?k:createTextVNode(k,PatchFlags.TEXT)],PatchFlags.STYLE)),ue},[])}return createVNode("div",{class:e.value,style:n.value},V,PatchFlags.STYLE|PatchFlags.CLASS)}return $.children}}}),ElSpace=withInstall(Space),switchProps=buildProps({modelValue:{type:[Boolean,String,Number],default:!1},disabled:{type:Boolean,default:!1},loading:{type:Boolean,default:!1},size:{type:String,validator:isValidComponentSize},width:{type:[String,Number],default:""},inlinePrompt:{type:Boolean,default:!1},inactiveActionIcon:{type:iconPropType},activeActionIcon:{type:iconPropType},activeIcon:{type:iconPropType},inactiveIcon:{type:iconPropType},activeText:{type:String,default:""},inactiveText:{type:String,default:""},activeValue:{type:[Boolean,String,Number],default:!0},inactiveValue:{type:[Boolean,String,Number],default:!1},activeColor:{type:String,default:""},inactiveColor:{type:String,default:""},borderColor:{type:String,default:""},name:{type:String,default:""},validateEvent:{type:Boolean,default:!0},beforeChange:{type:definePropType(Function)},id:String,tabindex:{type:[String,Number]},value:{type:[Boolean,String,Number],default:!1},label:{type:String,default:void 0}}),switchEmits={[UPDATE_MODEL_EVENT]:t=>isBoolean$1(t)||isString$2(t)||isNumber$1(t),[CHANGE_EVENT]:t=>isBoolean$1(t)||isString$2(t)||isNumber$1(t),[INPUT_EVENT]:t=>isBoolean$1(t)||isString$2(t)||isNumber$1(t)},_hoisted_1$h=["onClick"],_hoisted_2$b=["id","aria-checked","aria-disabled","aria-label","name","true-value","false-value","disabled","tabindex","onKeydown"],_hoisted_3$8=["aria-hidden"],_hoisted_4$6=["aria-hidden"],_hoisted_5$5=["aria-hidden"],COMPONENT_NAME$1="ElSwitch",__default__$5=defineComponent({name:COMPONENT_NAME$1}),_sfc_main$n=defineComponent({...__default__$5,props:switchProps,emits:switchEmits,setup(t,{expose:r,emit:e}){const n=t,g=getCurrentInstance(),{formItem:y}=useFormItem(),i=useFormSize(),k=useNamespace("switch");(Fe=>{Fe.forEach(Et=>{useDeprecated({from:Et[0],replacement:Et[1],scope:COMPONENT_NAME$1,version:"2.3.0",ref:"https://element-plus.org/en-US/component/switch.html#attributes",type:"Attribute"},computed(()=>{var cr;return!!((cr=g.vnode.props)!=null&&cr[Et[2]])}))})})([['"value"','"model-value" or "v-model"',"value"],['"active-color"',"CSS var `--el-switch-on-color`","activeColor"],['"inactive-color"',"CSS var `--el-switch-off-color`","inactiveColor"],['"border-color"',"CSS var `--el-switch-border-color`","borderColor"]]);const{inputId:$}=useFormItemInputId(n,{formItemContext:y}),V=useFormDisabled(computed(()=>n.loading)),z=ref(n.modelValue!==!1),re=ref(),oe=ref(),le=computed(()=>[k.b(),k.m(i.value),k.is("disabled",V.value),k.is("checked",de.value)]),ue=computed(()=>[k.e("label"),k.em("label","left"),k.is("active",!de.value)]),ie=computed(()=>[k.e("label"),k.em("label","right"),k.is("active",de.value)]),ae=computed(()=>({width:addUnit(n.width)}));watch(()=>n.modelValue,()=>{z.value=!0}),watch(()=>n.value,()=>{z.value=!1});const Ie=computed(()=>z.value?n.modelValue:n.value),de=computed(()=>Ie.value===n.activeValue);[n.activeValue,n.inactiveValue].includes(Ie.value)||(e(UPDATE_MODEL_EVENT,n.inactiveValue),e(CHANGE_EVENT,n.inactiveValue),e(INPUT_EVENT,n.inactiveValue)),watch(de,Fe=>{var Et;re.value.checked=Fe,n.validateEvent&&((Et=y==null?void 0:y.validate)==null||Et.call(y,"change").catch(cr=>void 0))});const Ce=()=>{const Fe=de.value?n.inactiveValue:n.activeValue;e(UPDATE_MODEL_EVENT,Fe),e(CHANGE_EVENT,Fe),e(INPUT_EVENT,Fe),nextTick(()=>{re.value.checked=de.value})},Ue=()=>{if(V.value)return;const{beforeChange:Fe}=n;if(!Fe){Ce();return}const Et=Fe();[isPromise(Et),isBoolean$1(Et)].includes(!0)||throwError(COMPONENT_NAME$1,"beforeChange must return type `Promise<boolean>` or `boolean`"),isPromise(Et)?Et.then(er=>{er&&Ce()}).catch(er=>{}):Et&&Ce()},qe=computed(()=>k.cssVarBlock({...n.activeColor?{"on-color":n.activeColor}:null,...n.inactiveColor?{"off-color":n.inactiveColor}:null,...n.borderColor?{"border-color":n.borderColor}:null})),jt=()=>{var Fe,Et;(Et=(Fe=re.value)==null?void 0:Fe.focus)==null||Et.call(Fe)};return onMounted(()=>{re.value.checked=de.value}),r({focus:jt,checked:de}),(Fe,Et)=>(openBlock(),createElementBlock("div",{class:normalizeClass(unref(le)),style:normalizeStyle(unref(qe)),onClick:withModifiers(Ue,["prevent"])},[createBaseVNode("input",{id:unref($),ref_key:"input",ref:re,class:normalizeClass(unref(k).e("input")),type:"checkbox",role:"switch","aria-checked":unref(de),"aria-disabled":unref(V),"aria-label":Fe.label,name:Fe.name,"true-value":Fe.activeValue,"false-value":Fe.inactiveValue,disabled:unref(V),tabindex:Fe.tabindex,onChange:Ce,onKeydown:withKeys(Ue,["enter"])},null,42,_hoisted_2$b),!Fe.inlinePrompt&&(Fe.inactiveIcon||Fe.inactiveText)?(openBlock(),createElementBlock("span",{key:0,class:normalizeClass(unref(ue))},[Fe.inactiveIcon?(openBlock(),createBlock(unref(ElIcon),{key:0},{default:withCtx(()=>[(openBlock(),createBlock(resolveDynamicComponent(Fe.inactiveIcon)))]),_:1})):createCommentVNode("v-if",!0),!Fe.inactiveIcon&&Fe.inactiveText?(openBlock(),createElementBlock("span",{key:1,"aria-hidden":unref(de)},toDisplayString(Fe.inactiveText),9,_hoisted_3$8)):createCommentVNode("v-if",!0)],2)):createCommentVNode("v-if",!0),createBaseVNode("span",{ref_key:"core",ref:oe,class:normalizeClass(unref(k).e("core")),style:normalizeStyle(unref(ae))},[Fe.inlinePrompt?(openBlock(),createElementBlock("div",{key:0,class:normalizeClass(unref(k).e("inner"))},[Fe.activeIcon||Fe.inactiveIcon?(openBlock(),createBlock(unref(ElIcon),{key:0,class:normalizeClass(unref(k).is("icon"))},{default:withCtx(()=>[(openBlock(),createBlock(resolveDynamicComponent(unref(de)?Fe.activeIcon:Fe.inactiveIcon)))]),_:1},8,["class"])):Fe.activeText||Fe.inactiveText?(openBlock(),createElementBlock("span",{key:1,class:normalizeClass(unref(k).is("text")),"aria-hidden":!unref(de)},toDisplayString(unref(de)?Fe.activeText:Fe.inactiveText),11,_hoisted_4$6)):createCommentVNode("v-if",!0)],2)):createCommentVNode("v-if",!0),createBaseVNode("div",{class:normalizeClass(unref(k).e("action"))},[Fe.loading?(openBlock(),createBlock(unref(ElIcon),{key:0,class:normalizeClass(unref(k).is("loading"))},{default:withCtx(()=>[createVNode(unref(loading_default))]),_:1},8,["class"])):unref(de)?renderSlot(Fe.$slots,"active-action",{key:1},()=>[Fe.activeActionIcon?(openBlock(),createBlock(unref(ElIcon),{key:0},{default:withCtx(()=>[(openBlock(),createBlock(resolveDynamicComponent(Fe.activeActionIcon)))]),_:1})):createCommentVNode("v-if",!0)]):unref(de)?createCommentVNode("v-if",!0):renderSlot(Fe.$slots,"inactive-action",{key:2},()=>[Fe.inactiveActionIcon?(openBlock(),createBlock(unref(ElIcon),{key:0},{default:withCtx(()=>[(openBlock(),createBlock(resolveDynamicComponent(Fe.inactiveActionIcon)))]),_:1})):createCommentVNode("v-if",!0)])],2)],6),!Fe.inlinePrompt&&(Fe.activeIcon||Fe.activeText)?(openBlock(),createElementBlock("span",{key:1,class:normalizeClass(unref(ie))},[Fe.activeIcon?(openBlock(),createBlock(unref(ElIcon),{key:0},{default:withCtx(()=>[(openBlock(),createBlock(resolveDynamicComponent(Fe.activeIcon)))]),_:1})):createCommentVNode("v-if",!0),!Fe.activeIcon&&Fe.activeText?(openBlock(),createElementBlock("span",{key:1,"aria-hidden":!unref(de)},toDisplayString(Fe.activeText),9,_hoisted_5$5)):createCommentVNode("v-if",!0)],2)):createCommentVNode("v-if",!0)],14,_hoisted_1$h))}});var Switch=_export_sfc$1(_sfc_main$n,[["__file","switch.vue"]]);const ElSwitch=withInstall(Switch),getCell=function(t){var r;return(r=t.target)==null?void 0:r.closest("td")},orderBy=function(t,r,e,n,g){if(!r&&!n&&(!g||Array.isArray(g)&&!g.length))return t;typeof e=="string"?e=e==="descending"?-1:1:e=e&&e<0?-1:1;const y=n?null:function(k,L){return g?(Array.isArray(g)||(g=[g]),g.map($=>typeof $=="string"?get(k,$):$(k,L,t))):(r!=="$key"&&isObject$2(k)&&"$value"in k&&(k=k.$value),[isObject$2(k)?get(k,r):k])},i=function(k,L){if(n)return n(k.value,L.value);for(let $=0,V=k.key.length;$<V;$++){if(k.key[$]<L.key[$])return-1;if(k.key[$]>L.key[$])return 1}return 0};return t.map((k,L)=>({value:k,index:L,key:y?y(k,L):null})).sort((k,L)=>{let $=i(k,L);return $||($=k.index-L.index),$*+e}).map(k=>k.value)},getColumnById=function(t,r){let e=null;return t.columns.forEach(n=>{n.id===r&&(e=n)}),e},getColumnByKey=function(t,r){let e=null;for(let n=0;n<t.columns.length;n++){const g=t.columns[n];if(g.columnKey===r){e=g;break}}return e||throwError("ElTable",`No column matching with column-key: ${r}`),e},getColumnByCell=function(t,r,e){const n=(r.className||"").match(new RegExp(`${e}-table_[^\\s]+`,"gm"));return n?getColumnById(t,n[0]):null},getRowIdentity=(t,r)=>{if(!t)throw new Error("Row is required when get row identity");if(typeof r=="string"){if(!r.includes("."))return`${t[r]}`;const e=r.split(".");let n=t;for(const g of e)n=n[g];return`${n}`}else if(typeof r=="function")return r.call(null,t)},getKeysMap=function(t,r){const e={};return(t||[]).forEach((n,g)=>{e[getRowIdentity(n,r)]={row:n,index:g}}),e};function mergeOptions(t,r){const e={};let n;for(n in t)e[n]=t[n];for(n in r)if(hasOwn(r,n)){const g=r[n];typeof g<"u"&&(e[n]=g)}return e}function parseWidth(t){return t===""||t!==void 0&&(t=Number.parseInt(t,10),Number.isNaN(t)&&(t="")),t}function parseMinWidth(t){return t===""||t!==void 0&&(t=parseWidth(t),Number.isNaN(t)&&(t=80)),t}function parseHeight(t){return typeof t=="number"?t:typeof t=="string"?/^\d+(?:px)?$/.test(t)?Number.parseInt(t,10):t:null}function compose(...t){return t.length===0?r=>r:t.length===1?t[0]:t.reduce((r,e)=>(...n)=>r(e(...n)))}function toggleRowStatus(t,r,e){let n=!1;const g=t.indexOf(r),y=g!==-1,i=k=>{k==="add"?t.push(r):t.splice(g,1),n=!0,isArray$3(r.children)&&r.children.forEach(L=>{toggleRowStatus(t,L,e??!y)})};return isBoolean$1(e)?e&&!y?i("add"):!e&&y&&i("remove"):i(y?"remove":"add"),n}function walkTreeNode(t,r,e="children",n="hasChildren"){const g=i=>!(Array.isArray(i)&&i.length);function y(i,k,L){r(i,k,L),k.forEach($=>{if($[n]){r($,null,L+1);return}const V=$[e];g(V)||y($,V,L+1)})}t.forEach(i=>{if(i[n]){r(i,null,0);return}const k=i[e];g(k)||y(i,k,0)})}let removePopper=null;function createTablePopper(t,r,e,n){if((removePopper==null?void 0:removePopper.trigger)===e)return;removePopper==null||removePopper();const g=n==null?void 0:n.refs.tableWrapper,y=g==null?void 0:g.dataset.prefix,i={strategy:"fixed",...t.popperOptions},k=createVNode(ElTooltip,{content:r,virtualTriggering:!0,virtualRef:e,appendTo:g,placement:"top",transition:"none",offset:0,hideAfter:0,...t,popperOptions:i,onHide:()=>{removePopper==null||removePopper()}});k.appContext={...n.appContext,...n};const L=document.createElement("div");render(k,L),k.component.exposed.onOpen();const $=g==null?void 0:g.querySelector(`.${y}-scrollbar__wrap`);removePopper=()=>{render(null,L),$==null||$.removeEventListener("scroll",removePopper),removePopper=null},removePopper.trigger=e,$==null||$.addEventListener("scroll",removePopper)}function getCurrentColumns(t){return t.children?flatMap(t.children,getCurrentColumns):[t]}function getColSpan(t,r){return t+r.colSpan}const isFixedColumn=(t,r,e,n)=>{let g=0,y=t;const i=e.states.columns.value;if(n){const L=getCurrentColumns(n[t]);g=i.slice(0,i.indexOf(L[0])).reduce(getColSpan,0),y=g+L.reduce(getColSpan,0)-1}else g=t;let k;switch(r){case"left":y<e.states.fixedLeafColumnsLength.value&&(k="left");break;case"right":g>=i.length-e.states.rightFixedLeafColumnsLength.value&&(k="right");break;default:y<e.states.fixedLeafColumnsLength.value?k="left":g>=i.length-e.states.rightFixedLeafColumnsLength.value&&(k="right")}return k?{direction:k,start:g,after:y}:{}},getFixedColumnsClass=(t,r,e,n,g,y=0)=>{const i=[],{direction:k,start:L,after:$}=isFixedColumn(r,e,n,g);if(k){const V=k==="left";i.push(`${t}-fixed-column--${k}`),V&&$+y===n.states.fixedLeafColumnsLength.value-1?i.push("is-last-column"):!V&&L-y===n.states.columns.value.length-n.states.rightFixedLeafColumnsLength.value&&i.push("is-first-column")}return i};function getOffset(t,r){return t+(r.realWidth===null||Number.isNaN(r.realWidth)?Number(r.width):r.realWidth)}const getFixedColumnOffset=(t,r,e,n)=>{const{direction:g,start:y=0,after:i=0}=isFixedColumn(t,r,e,n);if(!g)return;const k={},L=g==="left",$=e.states.columns.value;return L?k.left=$.slice(0,y).reduce(getOffset,0):k.right=$.slice(i+1).reverse().reduce(getOffset,0),k},ensurePosition=(t,r)=>{t&&(Number.isNaN(t[r])||(t[r]=`${t[r]}px`))};function useExpand(t){const r=getCurrentInstance(),e=ref(!1),n=ref([]);return{updateExpandRows:()=>{const L=t.data.value||[],$=t.rowKey.value;if(e.value)n.value=L.slice();else if($){const V=getKeysMap(n.value,$);n.value=L.reduce((z,re)=>{const oe=getRowIdentity(re,$);return V[oe]&&z.push(re),z},[])}else n.value=[]},toggleRowExpansion:(L,$)=>{toggleRowStatus(n.value,L,$)&&r.emit("expand-change",L,n.value.slice())},setExpandRowKeys:L=>{r.store.assertRowKey();const $=t.data.value||[],V=t.rowKey.value,z=getKeysMap($,V);n.value=L.reduce((re,oe)=>{const le=z[oe];return le&&re.push(le.row),re},[])},isRowExpanded:L=>{const $=t.rowKey.value;return $?!!getKeysMap(n.value,$)[getRowIdentity(L,$)]:n.value.includes(L)},states:{expandRows:n,defaultExpandAll:e}}}function useCurrent(t){const r=getCurrentInstance(),e=ref(null),n=ref(null),g=$=>{r.store.assertRowKey(),e.value=$,i($)},y=()=>{e.value=null},i=$=>{const{data:V,rowKey:z}=t;let re=null;z.value&&(re=(unref(V)||[]).find(oe=>getRowIdentity(oe,z.value)===$)),n.value=re,r.emit("current-change",n.value,null)};return{setCurrentRowKey:g,restoreCurrentRowKey:y,setCurrentRowByKey:i,updateCurrentRow:$=>{const V=n.value;if($&&$!==V){n.value=$,r.emit("current-change",n.value,V);return}!$&&V&&(n.value=null,r.emit("current-change",null,V))},updateCurrentRowData:()=>{const $=t.rowKey.value,V=t.data.value||[],z=n.value;if(!V.includes(z)&&z){if($){const re=getRowIdentity(z,$);i(re)}else n.value=null;n.value===null&&r.emit("current-change",null,z)}else e.value&&(i(e.value),y())},states:{_currentRowKey:e,currentRow:n}}}function useTree(t){const r=ref([]),e=ref({}),n=ref(16),g=ref(!1),y=ref({}),i=ref("hasChildren"),k=ref("children"),L=getCurrentInstance(),$=computed(()=>{if(!t.rowKey.value)return{};const ae=t.data.value||[];return z(ae)}),V=computed(()=>{const ae=t.rowKey.value,Ie=Object.keys(y.value),de={};return Ie.length&&Ie.forEach(Ce=>{if(y.value[Ce].length){const Ue={children:[]};y.value[Ce].forEach(qe=>{const jt=getRowIdentity(qe,ae);Ue.children.push(jt),qe[i.value]&&!de[jt]&&(de[jt]={children:[]})}),de[Ce]=Ue}}),de}),z=ae=>{const Ie=t.rowKey.value,de={};return walkTreeNode(ae,(Ce,Ue,qe)=>{const jt=getRowIdentity(Ce,Ie);Array.isArray(Ue)?de[jt]={children:Ue.map(Fe=>getRowIdentity(Fe,Ie)),level:qe}:g.value&&(de[jt]={children:[],lazy:!0,level:qe})},k.value,i.value),de},re=(ae=!1,Ie=(de=>(de=L.store)==null?void 0:de.states.defaultExpandAll.value)())=>{var de;const Ce=$.value,Ue=V.value,qe=Object.keys(Ce),jt={};if(qe.length){const Fe=unref(e),Et=[],cr=(nr,dr)=>{if(ae)return r.value?Ie||r.value.includes(dr):!!(Ie||nr!=null&&nr.expanded);{const ir=Ie||r.value&&r.value.includes(dr);return!!(nr!=null&&nr.expanded||ir)}};qe.forEach(nr=>{const dr=Fe[nr],ir={...Ce[nr]};if(ir.expanded=cr(dr,nr),ir.lazy){const{loaded:tr=!1,loading:ur=!1}=dr||{};ir.loaded=!!tr,ir.loading=!!ur,Et.push(nr)}jt[nr]=ir});const er=Object.keys(Ue);g.value&&er.length&&Et.length&&er.forEach(nr=>{const dr=Fe[nr],ir=Ue[nr].children;if(Et.includes(nr)){if(jt[nr].children.length!==0)throw new Error("[ElTable]children must be an empty array.");jt[nr].children=ir}else{const{loaded:tr=!1,loading:ur=!1}=dr||{};jt[nr]={lazy:!0,loaded:!!tr,loading:!!ur,expanded:cr(dr,nr),children:ir,level:""}}})}e.value=jt,(de=L.store)==null||de.updateTableScrollY()};watch(()=>r.value,()=>{re(!0)}),watch(()=>$.value,()=>{re()}),watch(()=>V.value,()=>{re()});const oe=ae=>{r.value=ae,re()},le=(ae,Ie)=>{L.store.assertRowKey();const de=t.rowKey.value,Ce=getRowIdentity(ae,de),Ue=Ce&&e.value[Ce];if(Ce&&Ue&&"expanded"in Ue){const qe=Ue.expanded;Ie=typeof Ie>"u"?!Ue.expanded:Ie,e.value[Ce].expanded=Ie,qe!==Ie&&L.emit("expand-change",ae,Ie),L.store.updateTableScrollY()}},ue=ae=>{L.store.assertRowKey();const Ie=t.rowKey.value,de=getRowIdentity(ae,Ie),Ce=e.value[de];g.value&&Ce&&"loaded"in Ce&&!Ce.loaded?ie(ae,de,Ce):le(ae,void 0)},ie=(ae,Ie,de)=>{const{load:Ce}=L.props;Ce&&!e.value[Ie].loaded&&(e.value[Ie].loading=!0,Ce(ae,de,Ue=>{if(!Array.isArray(Ue))throw new TypeError("[ElTable] data must be an array");e.value[Ie].loading=!1,e.value[Ie].loaded=!0,e.value[Ie].expanded=!0,Ue.length&&(y.value[Ie]=Ue),L.emit("expand-change",ae,!0)}))};return{loadData:ie,loadOrToggle:ue,toggleTreeExpansion:le,updateTreeExpandKeys:oe,updateTreeData:re,normalize:z,states:{expandRowKeys:r,treeData:e,indent:n,lazy:g,lazyTreeNodeMap:y,lazyColumnIdentifier:i,childrenColumnName:k}}}const sortData=(t,r)=>{const e=r.sortingColumn;return!e||typeof e.sortable=="string"?t:orderBy(t,r.sortProp,r.sortOrder,e.sortMethod,e.sortBy)},doFlattenColumns=t=>{const r=[];return t.forEach(e=>{e.children&&e.children.length>0?r.push.apply(r,doFlattenColumns(e.children)):r.push(e)}),r};function useWatcher$1(){var t;const r=getCurrentInstance(),{size:e}=toRefs((t=r.proxy)==null?void 0:t.$props),n=ref(null),g=ref([]),y=ref([]),i=ref(!1),k=ref([]),L=ref([]),$=ref([]),V=ref([]),z=ref([]),re=ref([]),oe=ref([]),le=ref([]),ue=[],ie=ref(0),ae=ref(0),Ie=ref(0),de=ref(!1),Ce=ref([]),Ue=ref(!1),qe=ref(!1),jt=ref(null),Fe=ref({}),Et=ref(null),cr=ref(null),er=ref(null),nr=ref(null),dr=ref(null);watch(g,()=>r.state&&or(!1),{deep:!0});const ir=()=>{if(!n.value)throw new Error("[ElTable] prop row-key is required")},tr=wn=>{var In;(In=wn.children)==null||In.forEach(bn=>{bn.fixed=wn.fixed,tr(bn)})},ur=()=>{k.value.forEach(Zn=>{tr(Zn)}),V.value=k.value.filter(Zn=>Zn.fixed===!0||Zn.fixed==="left"),z.value=k.value.filter(Zn=>Zn.fixed==="right"),V.value.length>0&&k.value[0]&&k.value[0].type==="selection"&&!k.value[0].fixed&&(k.value[0].fixed=!0,V.value.unshift(k.value[0]));const wn=k.value.filter(Zn=>!Zn.fixed);L.value=[].concat(V.value).concat(wn).concat(z.value);const In=doFlattenColumns(wn),bn=doFlattenColumns(V.value),hn=doFlattenColumns(z.value);ie.value=In.length,ae.value=bn.length,Ie.value=hn.length,$.value=[].concat(bn).concat(In).concat(hn),i.value=V.value.length>0||z.value.length>0},or=(wn,In=!1)=>{wn&&ur(),In?r.state.doLayout():r.state.debouncedUpdateLayout()},fr=wn=>Ce.value.includes(wn),lr=()=>{de.value=!1,Ce.value.length&&(Ce.value=[],r.emit("selection-change",[]))},gr=()=>{let wn;if(n.value){wn=[];const In=getKeysMap(Ce.value,n.value),bn=getKeysMap(g.value,n.value);for(const hn in In)hasOwn(In,hn)&&!bn[hn]&&wn.push(In[hn].row)}else wn=Ce.value.filter(In=>!g.value.includes(In));if(wn.length){const In=Ce.value.filter(bn=>!wn.includes(bn));Ce.value=In,r.emit("selection-change",In.slice())}},Sr=()=>(Ce.value||[]).slice(),wr=(wn,In=void 0,bn=!0)=>{if(toggleRowStatus(Ce.value,wn,In)){const Zn=(Ce.value||[]).slice();bn&&r.emit("select",Zn,wn),r.emit("selection-change",Zn)}},kr=()=>{var wn,In;const bn=qe.value?!de.value:!(de.value||Ce.value.length);de.value=bn;let hn=!1,Zn=0;const Oo=(In=(wn=r==null?void 0:r.store)==null?void 0:wn.states)==null?void 0:In.rowKey.value;g.value.forEach((Ho,Do)=>{const Eo=Do+Zn;jt.value?jt.value.call(null,Ho,Eo)&&toggleRowStatus(Ce.value,Ho,bn)&&(hn=!0):toggleRowStatus(Ce.value,Ho,bn)&&(hn=!0),Zn+=Nr(getRowIdentity(Ho,Oo))}),hn&&r.emit("selection-change",Ce.value?Ce.value.slice():[]),r.emit("select-all",Ce.value)},mr=()=>{const wn=getKeysMap(Ce.value,n.value);g.value.forEach(In=>{const bn=getRowIdentity(In,n.value),hn=wn[bn];hn&&(Ce.value[hn.index]=In)})},Ir=()=>{var wn,In,bn;if(((wn=g.value)==null?void 0:wn.length)===0){de.value=!1;return}let hn;n.value&&(hn=getKeysMap(Ce.value,n.value));const Zn=function(Eo){return hn?!!hn[getRowIdentity(Eo,n.value)]:Ce.value.includes(Eo)};let Oo=!0,Ho=0,Do=0;for(let Eo=0,Ko=(g.value||[]).length;Eo<Ko;Eo++){const Wa=(bn=(In=r==null?void 0:r.store)==null?void 0:In.states)==null?void 0:bn.rowKey.value,Ts=Eo+Do,To=g.value[Eo],Os=jt.value&&jt.value.call(null,To,Ts);if(Zn(To))Ho++;else if(!jt.value||Os){Oo=!1;break}Do+=Nr(getRowIdentity(To,Wa))}Ho===0&&(Oo=!1),de.value=Oo},Nr=wn=>{var In;if(!r||!r.store)return 0;const{treeData:bn}=r.store.states;let hn=0;const Zn=(In=bn.value[wn])==null?void 0:In.children;return Zn&&(hn+=Zn.length,Zn.forEach(Oo=>{hn+=Nr(Oo)})),hn},Er=(wn,In)=>{Array.isArray(wn)||(wn=[wn]);const bn={};return wn.forEach(hn=>{Fe.value[hn.id]=In,bn[hn.columnKey||hn.id]=In}),bn},sr=(wn,In,bn)=>{cr.value&&cr.value!==wn&&(cr.value.order=null),cr.value=wn,er.value=In,nr.value=bn},xr=()=>{let wn=unref(y);Object.keys(Fe.value).forEach(In=>{const bn=Fe.value[In];if(!bn||bn.length===0)return;const hn=getColumnById({columns:$.value},In);hn&&hn.filterMethod&&(wn=wn.filter(Zn=>bn.some(Oo=>hn.filterMethod.call(null,Oo,Zn,hn))))}),Et.value=wn},Or=()=>{g.value=sortData(Et.value,{sortingColumn:cr.value,sortProp:er.value,sortOrder:nr.value})},Mr=(wn=void 0)=>{wn&&wn.filter||xr(),Or()},br=wn=>{const{tableHeaderRef:In}=r.refs;if(!In)return;const bn=Object.assign({},In.filterPanels),hn=Object.keys(bn);if(hn.length)if(typeof wn=="string"&&(wn=[wn]),Array.isArray(wn)){const Zn=wn.map(Oo=>getColumnByKey({columns:$.value},Oo));hn.forEach(Oo=>{const Ho=Zn.find(Do=>Do.id===Oo);Ho&&(Ho.filteredValue=[])}),r.store.commit("filterChange",{column:Zn,values:[],silent:!0,multi:!0})}else hn.forEach(Zn=>{const Oo=$.value.find(Ho=>Ho.id===Zn);Oo&&(Oo.filteredValue=[])}),Fe.value={},r.store.commit("filterChange",{column:{},values:[],silent:!0})},hr=()=>{cr.value&&(sr(null,null,null),r.store.commit("changeSortCondition",{silent:!0}))},{setExpandRowKeys:Tr,toggleRowExpansion:Br,updateExpandRows:Fr,states:Lr,isRowExpanded:qr}=useExpand({data:g,rowKey:n}),{updateTreeExpandKeys:Ur,toggleTreeExpansion:Qr,updateTreeData:vn,loadOrToggle:_n,states:Yr}=useTree({data:g,rowKey:n}),{updateCurrentRowData:jn,updateCurrentRow:Zr,setCurrentRowKey:An,states:Jr}=useCurrent({data:g,rowKey:n});return{assertRowKey:ir,updateColumns:ur,scheduleLayout:or,isSelected:fr,clearSelection:lr,cleanSelection:gr,getSelectionRows:Sr,toggleRowSelection:wr,_toggleAllSelection:kr,toggleAllSelection:null,updateSelectionByRowKey:mr,updateAllSelected:Ir,updateFilters:Er,updateCurrentRow:Zr,updateSort:sr,execFilter:xr,execSort:Or,execQuery:Mr,clearFilter:br,clearSort:hr,toggleRowExpansion:Br,setExpandRowKeysAdapter:wn=>{Tr(wn),Ur(wn)},setCurrentRowKey:An,toggleRowExpansionAdapter:(wn,In)=>{$.value.some(({type:hn})=>hn==="expand")?Br(wn,In):Qr(wn,In)},isRowExpanded:qr,updateExpandRows:Fr,updateCurrentRowData:jn,loadOrToggle:_n,updateTreeData:vn,states:{tableSize:e,rowKey:n,data:g,_data:y,isComplex:i,_columns:k,originColumns:L,columns:$,fixedColumns:V,rightFixedColumns:z,leafColumns:re,fixedLeafColumns:oe,rightFixedLeafColumns:le,updateOrderFns:ue,leafColumnsLength:ie,fixedLeafColumnsLength:ae,rightFixedLeafColumnsLength:Ie,isAllSelected:de,selection:Ce,reserveSelection:Ue,selectOnIndeterminate:qe,selectable:jt,filters:Fe,filteredData:Et,sortingColumn:cr,sortProp:er,sortOrder:nr,hoverRow:dr,...Lr,...Yr,...Jr}}}function replaceColumn(t,r){return t.map(e=>{var n;return e.id===r.id?r:((n=e.children)!=null&&n.length&&(e.children=replaceColumn(e.children,r)),e)})}function sortColumn(t){t.forEach(r=>{var e,n;r.no=(e=r.getColumnIndex)==null?void 0:e.call(r),(n=r.children)!=null&&n.length&&sortColumn(r.children)}),t.sort((r,e)=>r.no-e.no)}function useStore(){const t=getCurrentInstance(),r=useWatcher$1();return{ns:useNamespace("table"),...r,mutations:{setData(i,k){const L=unref(i._data)!==k;i.data.value=k,i._data.value=k,t.store.execQuery(),t.store.updateCurrentRowData(),t.store.updateExpandRows(),t.store.updateTreeData(t.store.states.defaultExpandAll.value),unref(i.reserveSelection)?(t.store.assertRowKey(),t.store.updateSelectionByRowKey()):L?t.store.clearSelection():t.store.cleanSelection(),t.store.updateAllSelected(),t.$ready&&t.store.scheduleLayout()},insertColumn(i,k,L,$){const V=unref(i._columns);let z=[];L?(L&&!L.children&&(L.children=[]),L.children.push(k),z=replaceColumn(V,L)):(V.push(k),z=V),sortColumn(z),i._columns.value=z,i.updateOrderFns.push($),k.type==="selection"&&(i.selectable.value=k.selectable,i.reserveSelection.value=k.reserveSelection),t.$ready&&(t.store.updateColumns(),t.store.scheduleLayout())},updateColumnOrder(i,k){var L;((L=k.getColumnIndex)==null?void 0:L.call(k))!==k.no&&(sortColumn(i._columns.value),t.$ready&&t.store.updateColumns())},removeColumn(i,k,L,$){const V=unref(i._columns)||[];if(L)L.children.splice(L.children.findIndex(re=>re.id===k.id),1),nextTick(()=>{var re;((re=L.children)==null?void 0:re.length)===0&&delete L.children}),i._columns.value=replaceColumn(V,L);else{const re=V.indexOf(k);re>-1&&(V.splice(re,1),i._columns.value=V)}const z=i.updateOrderFns.indexOf($);z>-1&&i.updateOrderFns.splice(z,1),t.$ready&&(t.store.updateColumns(),t.store.scheduleLayout())},sort(i,k){const{prop:L,order:$,init:V}=k;if(L){const z=unref(i.columns).find(re=>re.property===L);z&&(z.order=$,t.store.updateSort(z,L,$),t.store.commit("changeSortCondition",{init:V}))}},changeSortCondition(i,k){const{sortingColumn:L,sortProp:$,sortOrder:V}=i,z=unref(L),re=unref($),oe=unref(V);oe===null&&(i.sortingColumn.value=null,i.sortProp.value=null);const le={filter:!0};t.store.execQuery(le),(!k||!(k.silent||k.init))&&t.emit("sort-change",{column:z,prop:re,order:oe}),t.store.updateTableScrollY()},filterChange(i,k){const{column:L,values:$,silent:V}=k,z=t.store.updateFilters(L,$);t.store.execQuery(),V||t.emit("filter-change",z),t.store.updateTableScrollY()},toggleAllSelection(){t.store.toggleAllSelection()},rowSelectedChanged(i,k){t.store.toggleRowSelection(k),t.store.updateAllSelected()},setHoverRow(i,k){i.hoverRow.value=k},setCurrentRow(i,k){t.store.updateCurrentRow(k)}},commit:function(i,...k){const L=t.store.mutations;if(L[i])L[i].apply(t,[t.store.states].concat(k));else throw new Error(`Action not found: ${i}`)},updateTableScrollY:function(){nextTick(()=>t.layout.updateScrollY.apply(t.layout))}}}const InitialStateMap={rowKey:"rowKey",defaultExpandAll:"defaultExpandAll",selectOnIndeterminate:"selectOnIndeterminate",indent:"indent",lazy:"lazy",data:"data","treeProps.hasChildren":{key:"lazyColumnIdentifier",default:"hasChildren"},"treeProps.children":{key:"childrenColumnName",default:"children"}};function createStore(t,r){if(!t)throw new Error("Table is required.");const e=useStore();return e.toggleAllSelection=debounce(e._toggleAllSelection,10),Object.keys(InitialStateMap).forEach(n=>{handleValue(getArrKeysValue(r,n),n,e)}),proxyTableProps(e,r),e}function proxyTableProps(t,r){Object.keys(InitialStateMap).forEach(e=>{watch(()=>getArrKeysValue(r,e),n=>{handleValue(n,e,t)})})}function handleValue(t,r,e){let n=t,g=InitialStateMap[r];typeof InitialStateMap[r]=="object"&&(g=g.key,n=n||InitialStateMap[r].default),e.states[g].value=n}function getArrKeysValue(t,r){if(r.includes(".")){const e=r.split(".");let n=t;return e.forEach(g=>{n=n[g]}),n}else return t[r]}class TableLayout{constructor(r){this.observers=[],this.table=null,this.store=null,this.columns=[],this.fit=!0,this.showHeader=!0,this.height=ref(null),this.scrollX=ref(!1),this.scrollY=ref(!1),this.bodyWidth=ref(null),this.fixedWidth=ref(null),this.rightFixedWidth=ref(null),this.gutterWidth=0;for(const e in r)hasOwn(r,e)&&(isRef(this[e])?this[e].value=r[e]:this[e]=r[e]);if(!this.table)throw new Error("Table is required for Table Layout");if(!this.store)throw new Error("Store is required for Table Layout")}updateScrollY(){if(this.height.value===null)return!1;const e=this.table.refs.scrollBarRef;if(this.table.vnode.el&&(e!=null&&e.wrapRef)){let n=!0;const g=this.scrollY.value;return n=e.wrapRef.scrollHeight>e.wrapRef.clientHeight,this.scrollY.value=n,g!==n}return!1}setHeight(r,e="height"){if(!isClient)return;const n=this.table.vnode.el;if(r=parseHeight(r),this.height.value=Number(r),!n&&(r||r===0))return nextTick(()=>this.setHeight(r,e));typeof r=="number"?(n.style[e]=`${r}px`,this.updateElsHeight()):typeof r=="string"&&(n.style[e]=r,this.updateElsHeight())}setMaxHeight(r){this.setHeight(r,"max-height")}getFlattenColumns(){const r=[];return this.table.store.states.columns.value.forEach(n=>{n.isColumnGroup?r.push.apply(r,n.columns):r.push(n)}),r}updateElsHeight(){this.updateScrollY(),this.notifyObservers("scrollable")}headerDisplayNone(r){if(!r)return!0;let e=r;for(;e.tagName!=="DIV";){if(getComputedStyle(e).display==="none")return!0;e=e.parentElement}return!1}updateColumnsWidth(){if(!isClient)return;const r=this.fit,e=this.table.vnode.el.clientWidth;let n=0;const g=this.getFlattenColumns(),y=g.filter(L=>typeof L.width!="number");if(g.forEach(L=>{typeof L.width=="number"&&L.realWidth&&(L.realWidth=null)}),y.length>0&&r){if(g.forEach(L=>{n+=Number(L.width||L.minWidth||80)}),n<=e){this.scrollX.value=!1;const L=e-n;if(y.length===1)y[0].realWidth=Number(y[0].minWidth||80)+L;else{const $=y.reduce((re,oe)=>re+Number(oe.minWidth||80),0),V=L/$;let z=0;y.forEach((re,oe)=>{if(oe===0)return;const le=Math.floor(Number(re.minWidth||80)*V);z+=le,re.realWidth=Number(re.minWidth||80)+le}),y[0].realWidth=Number(y[0].minWidth||80)+L-z}}else this.scrollX.value=!0,y.forEach(L=>{L.realWidth=Number(L.minWidth)});this.bodyWidth.value=Math.max(n,e),this.table.state.resizeState.value.width=this.bodyWidth.value}else g.forEach(L=>{!L.width&&!L.minWidth?L.realWidth=80:L.realWidth=Number(L.width||L.minWidth),n+=L.realWidth}),this.scrollX.value=n>e,this.bodyWidth.value=n;const i=this.store.states.fixedColumns.value;if(i.length>0){let L=0;i.forEach($=>{L+=Number($.realWidth||$.width)}),this.fixedWidth.value=L}const k=this.store.states.rightFixedColumns.value;if(k.length>0){let L=0;k.forEach($=>{L+=Number($.realWidth||$.width)}),this.rightFixedWidth.value=L}this.notifyObservers("columns")}addObserver(r){this.observers.push(r)}removeObserver(r){const e=this.observers.indexOf(r);e!==-1&&this.observers.splice(e,1)}notifyObservers(r){this.observers.forEach(n=>{var g,y;switch(r){case"columns":(g=n.state)==null||g.onColumnsChange(this);break;case"scrollable":(y=n.state)==null||y.onScrollableChange(this);break;default:throw new Error(`Table Layout don't have event ${r}.`)}})}}const{CheckboxGroup:ElCheckboxGroup}=ElCheckbox,_sfc_main$m=defineComponent({name:"ElTableFilterPanel",components:{ElCheckbox,ElCheckboxGroup,ElScrollbar,ElTooltip,ElIcon,ArrowDown:arrow_down_default,ArrowUp:arrow_up_default},directives:{ClickOutside},props:{placement:{type:String,default:"bottom-start"},store:{type:Object},column:{type:Object},upDataColumn:{type:Function}},setup(t){const r=getCurrentInstance(),{t:e}=useLocale(),n=useNamespace("table-filter"),g=r==null?void 0:r.parent;g.filterPanels.value[t.column.id]||(g.filterPanels.value[t.column.id]=r);const y=ref(!1),i=ref(null),k=computed(()=>t.column&&t.column.filters),L=computed(()=>t.column.filterClassName?`${n.b()} ${t.column.filterClassName}`:n.b()),$=computed({get:()=>{var Ue;return(((Ue=t.column)==null?void 0:Ue.filteredValue)||[])[0]},set:Ue=>{V.value&&(typeof Ue<"u"&&Ue!==null?V.value.splice(0,1,Ue):V.value.splice(0,1))}}),V=computed({get(){return t.column?t.column.filteredValue||[]:[]},set(Ue){t.column&&t.upDataColumn("filteredValue",Ue)}}),z=computed(()=>t.column?t.column.filterMultiple:!0),re=Ue=>Ue.value===$.value,oe=()=>{y.value=!1},le=Ue=>{Ue.stopPropagation(),y.value=!y.value},ue=()=>{y.value=!1},ie=()=>{de(V.value),oe()},ae=()=>{V.value=[],de(V.value),oe()},Ie=Ue=>{$.value=Ue,de(typeof Ue<"u"&&Ue!==null?V.value:[]),oe()},de=Ue=>{t.store.commit("filterChange",{column:t.column,values:Ue}),t.store.updateAllSelected()};watch(y,Ue=>{t.column&&t.upDataColumn("filterOpened",Ue)},{immediate:!0});const Ce=computed(()=>{var Ue,qe;return(qe=(Ue=i.value)==null?void 0:Ue.popperRef)==null?void 0:qe.contentRef});return{tooltipVisible:y,multiple:z,filterClassName:L,filteredValue:V,filterValue:$,filters:k,handleConfirm:ie,handleReset:ae,handleSelect:Ie,isActive:re,t:e,ns:n,showFilterPanel:le,hideFilterPanel:ue,popperPaneRef:Ce,tooltip:i}}}),_hoisted_1$g={key:0},_hoisted_2$a=["disabled"],_hoisted_3$7=["label","onClick"];function _sfc_render$2(t,r,e,n,g,y){const i=resolveComponent("el-checkbox"),k=resolveComponent("el-checkbox-group"),L=resolveComponent("el-scrollbar"),$=resolveComponent("arrow-up"),V=resolveComponent("arrow-down"),z=resolveComponent("el-icon"),re=resolveComponent("el-tooltip"),oe=resolveDirective("click-outside");return openBlock(),createBlock(re,{ref:"tooltip",visible:t.tooltipVisible,offset:0,placement:t.placement,"show-arrow":!1,"stop-popper-mouse-event":!1,teleported:"",effect:"light",pure:"","popper-class":t.filterClassName,persistent:""},{content:withCtx(()=>[t.multiple?(openBlock(),createElementBlock("div",_hoisted_1$g,[createBaseVNode("div",{class:normalizeClass(t.ns.e("content"))},[createVNode(L,{"wrap-class":t.ns.e("wrap")},{default:withCtx(()=>[createVNode(k,{modelValue:t.filteredValue,"onUpdate:modelValue":r[0]||(r[0]=le=>t.filteredValue=le),class:normalizeClass(t.ns.e("checkbox-group"))},{default:withCtx(()=>[(openBlock(!0),createElementBlock(Fragment,null,renderList(t.filters,le=>(openBlock(),createBlock(i,{key:le.value,label:le.value},{default:withCtx(()=>[createTextVNode(toDisplayString(le.text),1)]),_:2},1032,["label"]))),128))]),_:1},8,["modelValue","class"])]),_:1},8,["wrap-class"])],2),createBaseVNode("div",{class:normalizeClass(t.ns.e("bottom"))},[createBaseVNode("button",{class:normalizeClass({[t.ns.is("disabled")]:t.filteredValue.length===0}),disabled:t.filteredValue.length===0,type:"button",onClick:r[1]||(r[1]=(...le)=>t.handleConfirm&&t.handleConfirm(...le))},toDisplayString(t.t("el.table.confirmFilter")),11,_hoisted_2$a),createBaseVNode("button",{type:"button",onClick:r[2]||(r[2]=(...le)=>t.handleReset&&t.handleReset(...le))},toDisplayString(t.t("el.table.resetFilter")),1)],2)])):(openBlock(),createElementBlock("ul",{key:1,class:normalizeClass(t.ns.e("list"))},[createBaseVNode("li",{class:normalizeClass([t.ns.e("list-item"),{[t.ns.is("active")]:t.filterValue===void 0||t.filterValue===null}]),onClick:r[3]||(r[3]=le=>t.handleSelect(null))},toDisplayString(t.t("el.table.clearFilter")),3),(openBlock(!0),createElementBlock(Fragment,null,renderList(t.filters,le=>(openBlock(),createElementBlock("li",{key:le.value,class:normalizeClass([t.ns.e("list-item"),t.ns.is("active",t.isActive(le))]),label:le.value,onClick:ue=>t.handleSelect(le.value)},toDisplayString(le.text),11,_hoisted_3$7))),128))],2))]),default:withCtx(()=>[withDirectives((openBlock(),createElementBlock("span",{class:normalizeClass([`${t.ns.namespace.value}-table__column-filter-trigger`,`${t.ns.namespace.value}-none-outline`]),onClick:r[4]||(r[4]=(...le)=>t.showFilterPanel&&t.showFilterPanel(...le))},[createVNode(z,null,{default:withCtx(()=>[t.column.filterOpened?(openBlock(),createBlock($,{key:0})):(openBlock(),createBlock(V,{key:1}))]),_:1})],2)),[[oe,t.hideFilterPanel,t.popperPaneRef]])]),_:1},8,["visible","placement","popper-class"])}var FilterPanel=_export_sfc$1(_sfc_main$m,[["render",_sfc_render$2],["__file","filter-panel.vue"]]);function useLayoutObserver(t){const r=getCurrentInstance();onBeforeMount(()=>{e.value.addObserver(r)}),onMounted(()=>{n(e.value),g(e.value)}),onUpdated(()=>{n(e.value),g(e.value)}),onUnmounted(()=>{e.value.removeObserver(r)});const e=computed(()=>{const y=t.layout;if(!y)throw new Error("Can not find table layout.");return y}),n=y=>{var i;const k=((i=t.vnode.el)==null?void 0:i.querySelectorAll("colgroup > col"))||[];if(!k.length)return;const L=y.getFlattenColumns(),$={};L.forEach(V=>{$[V.id]=V});for(let V=0,z=k.length;V<z;V++){const re=k[V],oe=re.getAttribute("name"),le=$[oe];le&&re.setAttribute("width",le.realWidth||le.width)}},g=y=>{var i,k;const L=((i=t.vnode.el)==null?void 0:i.querySelectorAll("colgroup > col[name=gutter]"))||[];for(let V=0,z=L.length;V<z;V++)L[V].setAttribute("width",y.scrollY.value?y.gutterWidth:"0");const $=((k=t.vnode.el)==null?void 0:k.querySelectorAll("th.gutter"))||[];for(let V=0,z=$.length;V<z;V++){const re=$[V];re.style.width=y.scrollY.value?`${y.gutterWidth}px`:"0",re.style.display=y.scrollY.value?"":"none"}};return{tableLayout:e.value,onColumnsChange:n,onScrollableChange:g}}const TABLE_INJECTION_KEY=Symbol("ElTable");function useEvent(t,r){const e=getCurrentInstance(),n=inject(TABLE_INJECTION_KEY),g=ue=>{ue.stopPropagation()},y=(ue,ie)=>{!ie.filters&&ie.sortable?le(ue,ie,!1):ie.filterable&&!ie.sortable&&g(ue),n==null||n.emit("header-click",ie,ue)},i=(ue,ie)=>{n==null||n.emit("header-contextmenu",ie,ue)},k=ref(null),L=ref(!1),$=ref({}),V=(ue,ie)=>{if(isClient&&!(ie.children&&ie.children.length>0)&&k.value&&t.border){L.value=!0;const ae=n;r("set-drag-visible",!0);const de=(ae==null?void 0:ae.vnode.el).getBoundingClientRect().left,Ce=e.vnode.el.querySelector(`th.${ie.id}`),Ue=Ce.getBoundingClientRect(),qe=Ue.left-de+30;addClass(Ce,"noclick"),$.value={startMouseLeft:ue.clientX,startLeft:Ue.right-de,startColumnLeft:Ue.left-de,tableLeft:de};const jt=ae==null?void 0:ae.refs.resizeProxy;jt.style.left=`${$.value.startLeft}px`,document.onselectstart=function(){return!1},document.ondragstart=function(){return!1};const Fe=cr=>{const er=cr.clientX-$.value.startMouseLeft,nr=$.value.startLeft+er;jt.style.left=`${Math.max(qe,nr)}px`},Et=()=>{if(L.value){const{startColumnLeft:cr,startLeft:er}=$.value,dr=Number.parseInt(jt.style.left,10)-cr;ie.width=ie.realWidth=dr,ae==null||ae.emit("header-dragend",ie.width,er-cr,ie,ue),requestAnimationFrame(()=>{t.store.scheduleLayout(!1,!0)}),document.body.style.cursor="",L.value=!1,k.value=null,$.value={},r("set-drag-visible",!1)}document.removeEventListener("mousemove",Fe),document.removeEventListener("mouseup",Et),document.onselectstart=null,document.ondragstart=null,setTimeout(()=>{removeClass(Ce,"noclick")},0)};document.addEventListener("mousemove",Fe),document.addEventListener("mouseup",Et)}},z=(ue,ie)=>{if(ie.children&&ie.children.length>0)return;const ae=ue.target;if(!isElement(ae))return;const Ie=ae==null?void 0:ae.closest("th");if(!(!ie||!ie.resizable)&&!L.value&&t.border){const de=Ie.getBoundingClientRect(),Ce=document.body.style;de.width>12&&de.right-ue.pageX<8?(Ce.cursor="col-resize",hasClass(Ie,"is-sortable")&&(Ie.style.cursor="col-resize"),k.value=ie):L.value||(Ce.cursor="",hasClass(Ie,"is-sortable")&&(Ie.style.cursor="pointer"),k.value=null)}},re=()=>{isClient&&(document.body.style.cursor="")},oe=({order:ue,sortOrders:ie})=>{if(ue==="")return ie[0];const ae=ie.indexOf(ue||null);return ie[ae>ie.length-2?0:ae+1]},le=(ue,ie,ae)=>{var Ie;ue.stopPropagation();const de=ie.order===ae?null:ae||oe(ie),Ce=(Ie=ue.target)==null?void 0:Ie.closest("th");if(Ce&&hasClass(Ce,"noclick")){removeClass(Ce,"noclick");return}if(!ie.sortable)return;const Ue=t.store.states;let qe=Ue.sortProp.value,jt;const Fe=Ue.sortingColumn.value;(Fe!==ie||Fe===ie&&Fe.order===null)&&(Fe&&(Fe.order=null),Ue.sortingColumn.value=ie,qe=ie.property),de?jt=ie.order=de:jt=ie.order=null,Ue.sortProp.value=qe,Ue.sortOrder.value=jt,n==null||n.store.commit("changeSortCondition")};return{handleHeaderClick:y,handleHeaderContextMenu:i,handleMouseDown:V,handleMouseMove:z,handleMouseOut:re,handleSortClick:le,handleFilterClick:g}}function useStyle$2(t){const r=inject(TABLE_INJECTION_KEY),e=useNamespace("table");return{getHeaderRowStyle:k=>{const L=r==null?void 0:r.props.headerRowStyle;return typeof L=="function"?L.call(null,{rowIndex:k}):L},getHeaderRowClass:k=>{const L=[],$=r==null?void 0:r.props.headerRowClassName;return typeof $=="string"?L.push($):typeof $=="function"&&L.push($.call(null,{rowIndex:k})),L.join(" ")},getHeaderCellStyle:(k,L,$,V)=>{var z;let re=(z=r==null?void 0:r.props.headerCellStyle)!=null?z:{};typeof re=="function"&&(re=re.call(null,{rowIndex:k,columnIndex:L,row:$,column:V}));const oe=getFixedColumnOffset(L,V.fixed,t.store,$);return ensurePosition(oe,"left"),ensurePosition(oe,"right"),Object.assign({},re,oe)},getHeaderCellClass:(k,L,$,V)=>{const z=getFixedColumnsClass(e.b(),L,V.fixed,t.store,$),re=[V.id,V.order,V.headerAlign,V.className,V.labelClassName,...z];V.children||re.push("is-leaf"),V.sortable&&re.push("is-sortable");const oe=r==null?void 0:r.props.headerCellClassName;return typeof oe=="string"?re.push(oe):typeof oe=="function"&&re.push(oe.call(null,{rowIndex:k,columnIndex:L,row:$,column:V})),re.push(e.e("cell")),re.filter(le=>!!le).join(" ")}}}const getAllColumns=t=>{const r=[];return t.forEach(e=>{e.children?(r.push(e),r.push.apply(r,getAllColumns(e.children))):r.push(e)}),r},convertToRows=t=>{let r=1;const e=(y,i)=>{if(i&&(y.level=i.level+1,r<y.level&&(r=y.level)),y.children){let k=0;y.children.forEach(L=>{e(L,y),k+=L.colSpan}),y.colSpan=k}else y.colSpan=1};t.forEach(y=>{y.level=1,e(y,void 0)});const n=[];for(let y=0;y<r;y++)n.push([]);return getAllColumns(t).forEach(y=>{y.children?(y.rowSpan=1,y.children.forEach(i=>i.isSubColumn=!0)):y.rowSpan=r-y.level+1,n[y.level-1].push(y)}),n};function useUtils$1(t){const r=inject(TABLE_INJECTION_KEY),e=computed(()=>convertToRows(t.store.states.originColumns.value));return{isGroup:computed(()=>{const y=e.value.length>1;return y&&r&&(r.state.isGroup.value=!0),y}),toggleAllSelection:y=>{y.stopPropagation(),r==null||r.store.commit("toggleAllSelection")},columnRows:e}}var TableHeader=defineComponent({name:"ElTableHeader",components:{ElCheckbox},props:{fixed:{type:String,default:""},store:{required:!0,type:Object},border:Boolean,defaultSort:{type:Object,default:()=>({prop:"",order:""})}},setup(t,{emit:r}){const e=getCurrentInstance(),n=inject(TABLE_INJECTION_KEY),g=useNamespace("table"),y=ref({}),{onColumnsChange:i,onScrollableChange:k}=useLayoutObserver(n);onMounted(async()=>{await nextTick(),await nextTick();const{prop:qe,order:jt}=t.defaultSort;n==null||n.store.commit("sort",{prop:qe,order:jt,init:!0})});const{handleHeaderClick:L,handleHeaderContextMenu:$,handleMouseDown:V,handleMouseMove:z,handleMouseOut:re,handleSortClick:oe,handleFilterClick:le}=useEvent(t,r),{getHeaderRowStyle:ue,getHeaderRowClass:ie,getHeaderCellStyle:ae,getHeaderCellClass:Ie}=useStyle$2(t),{isGroup:de,toggleAllSelection:Ce,columnRows:Ue}=useUtils$1(t);return e.state={onColumnsChange:i,onScrollableChange:k},e.filterPanels=y,{ns:g,filterPanels:y,onColumnsChange:i,onScrollableChange:k,columnRows:Ue,getHeaderRowClass:ie,getHeaderRowStyle:ue,getHeaderCellClass:Ie,getHeaderCellStyle:ae,handleHeaderClick:L,handleHeaderContextMenu:$,handleMouseDown:V,handleMouseMove:z,handleMouseOut:re,handleSortClick:oe,handleFilterClick:le,isGroup:de,toggleAllSelection:Ce}},render(){const{ns:t,isGroup:r,columnRows:e,getHeaderCellStyle:n,getHeaderCellClass:g,getHeaderRowClass:y,getHeaderRowStyle:i,handleHeaderClick:k,handleHeaderContextMenu:L,handleMouseDown:$,handleMouseMove:V,handleSortClick:z,handleMouseOut:re,store:oe,$parent:le}=this;let ue=1;return h$1("thead",{class:{[t.is("group")]:r}},e.map((ie,ae)=>h$1("tr",{class:y(ae),key:ae,style:i(ae)},ie.map((Ie,de)=>(Ie.rowSpan>ue&&(ue=Ie.rowSpan),h$1("th",{class:g(ae,de,ie,Ie),colspan:Ie.colSpan,key:`${Ie.id}-thead`,rowspan:Ie.rowSpan,style:n(ae,de,ie,Ie),onClick:Ce=>k(Ce,Ie),onContextmenu:Ce=>L(Ce,Ie),onMousedown:Ce=>$(Ce,Ie),onMousemove:Ce=>V(Ce,Ie),onMouseout:re},[h$1("div",{class:["cell",Ie.filteredValue&&Ie.filteredValue.length>0?"highlight":""]},[Ie.renderHeader?Ie.renderHeader({column:Ie,$index:de,store:oe,_self:le}):Ie.label,Ie.sortable&&h$1("span",{onClick:Ce=>z(Ce,Ie),class:"caret-wrapper"},[h$1("i",{onClick:Ce=>z(Ce,Ie,"ascending"),class:"sort-caret ascending"}),h$1("i",{onClick:Ce=>z(Ce,Ie,"descending"),class:"sort-caret descending"})]),Ie.filterable&&h$1(FilterPanel,{store:oe,placement:Ie.filterPlacement||"bottom-start",column:Ie,upDataColumn:(Ce,Ue)=>{Ie[Ce]=Ue}})])]))))))}});function useEvents(t){const r=inject(TABLE_INJECTION_KEY),e=ref(""),n=ref(h$1("div")),g=(le,ue,ie)=>{var ae;const Ie=r,de=getCell(le);let Ce;const Ue=(ae=Ie==null?void 0:Ie.vnode.el)==null?void 0:ae.dataset.prefix;de&&(Ce=getColumnByCell({columns:t.store.states.columns.value},de,Ue),Ce&&(Ie==null||Ie.emit(`cell-${ie}`,ue,Ce,de,le))),Ie==null||Ie.emit(`row-${ie}`,ue,Ce,le)},y=(le,ue)=>{g(le,ue,"dblclick")},i=(le,ue)=>{t.store.commit("setCurrentRow",ue),g(le,ue,"click")},k=(le,ue)=>{g(le,ue,"contextmenu")},L=debounce(le=>{t.store.commit("setHoverRow",le)},30),$=debounce(()=>{t.store.commit("setHoverRow",null)},30),V=le=>{const ue=window.getComputedStyle(le,null),ie=Number.parseInt(ue.paddingLeft,10)||0,ae=Number.parseInt(ue.paddingRight,10)||0,Ie=Number.parseInt(ue.paddingTop,10)||0,de=Number.parseInt(ue.paddingBottom,10)||0;return{left:ie,right:ae,top:Ie,bottom:de}},z=(le,ue,ie)=>{let ae=ue.target.parentNode;for(;le>1&&(ae=ae==null?void 0:ae.nextSibling,!(!ae||ae.nodeName!=="TR"));)ie(ae,"hover-row hover-fixed-row"),le--};return{handleDoubleClick:y,handleClick:i,handleContextMenu:k,handleMouseEnter:L,handleMouseLeave:$,handleCellMouseEnter:(le,ue,ie)=>{var ae;const Ie=r,de=getCell(le),Ce=(ae=Ie==null?void 0:Ie.vnode.el)==null?void 0:ae.dataset.prefix;if(de){const or=getColumnByCell({columns:t.store.states.columns.value},de,Ce);de.rowSpan>1&&z(de.rowSpan,le,addClass);const fr=Ie.hoverState={cell:de,column:or,row:ue};Ie==null||Ie.emit("cell-mouse-enter",fr.row,fr.column,fr.cell,le)}if(!ie)return;const Ue=le.target.querySelector(".cell");if(!(hasClass(Ue,`${Ce}-tooltip`)&&Ue.childNodes.length))return;const qe=document.createRange();qe.setStart(Ue,0),qe.setEnd(Ue,Ue.childNodes.length);let jt=qe.getBoundingClientRect().width,Fe=qe.getBoundingClientRect().height;jt-Math.floor(jt)<.001&&(jt=Math.floor(jt)),Fe-Math.floor(Fe)<.001&&(Fe=Math.floor(Fe));const{top:er,left:nr,right:dr,bottom:ir}=V(Ue),tr=nr+dr,ur=er+ir;(jt+tr>Ue.offsetWidth||Fe+ur>Ue.offsetHeight||Ue.scrollWidth>Ue.offsetWidth)&&createTablePopper(ie,de.innerText||de.textContent,de,Ie)},handleCellMouseLeave:le=>{const ue=getCell(le);if(!ue)return;ue.rowSpan>1&&z(ue.rowSpan,le,removeClass);const ie=r==null?void 0:r.hoverState;r==null||r.emit("cell-mouse-leave",ie==null?void 0:ie.row,ie==null?void 0:ie.column,ie==null?void 0:ie.cell,le)},tooltipContent:e,tooltipTrigger:n}}function useStyles(t){const r=inject(TABLE_INJECTION_KEY),e=useNamespace("table");return{getRowStyle:($,V)=>{const z=r==null?void 0:r.props.rowStyle;return typeof z=="function"?z.call(null,{row:$,rowIndex:V}):z||null},getRowClass:($,V)=>{const z=[e.e("row")];r!=null&&r.props.highlightCurrentRow&&$===t.store.states.currentRow.value&&z.push("current-row"),t.stripe&&V%2===1&&z.push(e.em("row","striped"));const re=r==null?void 0:r.props.rowClassName;return typeof re=="string"?z.push(re):typeof re=="function"&&z.push(re.call(null,{row:$,rowIndex:V})),z},getCellStyle:($,V,z,re)=>{const oe=r==null?void 0:r.props.cellStyle;let le=oe??{};typeof oe=="function"&&(le=oe.call(null,{rowIndex:$,columnIndex:V,row:z,column:re}));const ue=getFixedColumnOffset(V,t==null?void 0:t.fixed,t.store);return ensurePosition(ue,"left"),ensurePosition(ue,"right"),Object.assign({},le,ue)},getCellClass:($,V,z,re,oe)=>{const le=getFixedColumnsClass(e.b(),V,t==null?void 0:t.fixed,t.store,void 0,oe),ue=[re.id,re.align,re.className,...le],ie=r==null?void 0:r.props.cellClassName;return typeof ie=="string"?ue.push(ie):typeof ie=="function"&&ue.push(ie.call(null,{rowIndex:$,columnIndex:V,row:z,column:re})),ue.push(e.e("cell")),ue.filter(ae=>!!ae).join(" ")},getSpan:($,V,z,re)=>{let oe=1,le=1;const ue=r==null?void 0:r.props.spanMethod;if(typeof ue=="function"){const ie=ue({row:$,column:V,rowIndex:z,columnIndex:re});Array.isArray(ie)?(oe=ie[0],le=ie[1]):typeof ie=="object"&&(oe=ie.rowspan,le=ie.colspan)}return{rowspan:oe,colspan:le}},getColspanRealWidth:($,V,z)=>{if(V<1)return $[z].realWidth;const re=$.map(({realWidth:oe,width:le})=>oe||le).slice(z,z+V);return Number(re.reduce((oe,le)=>Number(oe)+Number(le),-1))}}}function useRender$1(t){const r=inject(TABLE_INJECTION_KEY),e=useNamespace("table"),{handleDoubleClick:n,handleClick:g,handleContextMenu:y,handleMouseEnter:i,handleMouseLeave:k,handleCellMouseEnter:L,handleCellMouseLeave:$,tooltipContent:V,tooltipTrigger:z}=useEvents(t),{getRowStyle:re,getRowClass:oe,getCellStyle:le,getCellClass:ue,getSpan:ie,getColspanRealWidth:ae}=useStyles(t),Ie=computed(()=>t.store.states.columns.value.findIndex(({type:jt})=>jt==="default")),de=(jt,Fe)=>{const Et=r.props.rowKey;return Et?getRowIdentity(jt,Et):Fe},Ce=(jt,Fe,Et,cr=!1)=>{const{tooltipEffect:er,tooltipOptions:nr,store:dr}=t,{indent:ir,columns:tr}=dr.states,ur=oe(jt,Fe);let or=!0;return Et&&(ur.push(e.em("row",`level-${Et.level}`)),or=Et.display),h$1("tr",{style:[or?null:{display:"none"},re(jt,Fe)],class:ur,key:de(jt,Fe),onDblclick:lr=>n(lr,jt),onClick:lr=>g(lr,jt),onContextmenu:lr=>y(lr,jt),onMouseenter:()=>i(Fe),onMouseleave:k},tr.value.map((lr,gr)=>{const{rowspan:Sr,colspan:wr}=ie(jt,lr,Fe,gr);if(!Sr||!wr)return null;const kr=Object.assign({},lr);kr.realWidth=ae(tr.value,wr,gr);const mr={store:t.store,_self:t.context||r,column:kr,row:jt,$index:Fe,cellIndex:gr,expanded:cr};gr===Ie.value&&Et&&(mr.treeNode={indent:Et.level*ir.value,level:Et.level},typeof Et.expanded=="boolean"&&(mr.treeNode.expanded=Et.expanded,"loading"in Et&&(mr.treeNode.loading=Et.loading),"noLazyChildren"in Et&&(mr.treeNode.noLazyChildren=Et.noLazyChildren)));const Ir=`${Fe},${gr}`,Nr=kr.columnKey||kr.rawColumnKey||"",Er=Ue(gr,lr,mr),sr=lr.showOverflowTooltip&&merge$2({effect:er},nr,lr.showOverflowTooltip);return h$1("td",{style:le(Fe,gr,jt,lr),class:ue(Fe,gr,jt,lr,wr-1),key:`${Nr}${Ir}`,rowspan:Sr,colspan:wr,onMouseenter:xr=>L(xr,jt,sr),onMouseleave:$},[Er])}))},Ue=(jt,Fe,Et)=>Fe.renderCell(Et);return{wrappedRowRender:(jt,Fe)=>{const Et=t.store,{isRowExpanded:cr,assertRowKey:er}=Et,{treeData:nr,lazyTreeNodeMap:dr,childrenColumnName:ir,rowKey:tr}=Et.states,ur=Et.states.columns.value;if(ur.some(({type:fr})=>fr==="expand")){const fr=cr(jt),lr=Ce(jt,Fe,void 0,fr),gr=r.renderExpanded;return fr?gr?[[lr,h$1("tr",{key:`expanded-row__${lr.key}`},[h$1("td",{colspan:ur.length,class:`${e.e("cell")} ${e.e("expanded-cell")}`},[gr({row:jt,$index:Fe,store:Et,expanded:fr})])])]]:(console.error("[Element Error]renderExpanded is required."),lr):[[lr]]}else if(Object.keys(nr.value).length){er();const fr=getRowIdentity(jt,tr.value);let lr=nr.value[fr],gr=null;lr&&(gr={expanded:lr.expanded,level:lr.level,display:!0},typeof lr.lazy=="boolean"&&(typeof lr.loaded=="boolean"&&lr.loaded&&(gr.noLazyChildren=!(lr.children&&lr.children.length)),gr.loading=lr.loading));const Sr=[Ce(jt,Fe,gr)];if(lr){let wr=0;const kr=(Ir,Nr)=>{Ir&&Ir.length&&Nr&&Ir.forEach(Er=>{const sr={display:Nr.display&&Nr.expanded,level:Nr.level+1,expanded:!1,noLazyChildren:!1,loading:!1},xr=getRowIdentity(Er,tr.value);if(xr==null)throw new Error("For nested data item, row-key is required.");if(lr={...nr.value[xr]},lr&&(sr.expanded=lr.expanded,lr.level=lr.level||sr.level,lr.display=!!(lr.expanded&&sr.display),typeof lr.lazy=="boolean"&&(typeof lr.loaded=="boolean"&&lr.loaded&&(sr.noLazyChildren=!(lr.children&&lr.children.length)),sr.loading=lr.loading)),wr++,Sr.push(Ce(Er,Fe+wr,sr)),lr){const Or=dr.value[xr]||Er[ir.value];kr(Or,lr)}})};lr.display=!0;const mr=dr.value[fr]||jt[ir.value];kr(mr,lr)}return Sr}else return Ce(jt,Fe,void 0)},tooltipContent:V,tooltipTrigger:z}}const defaultProps$2={store:{required:!0,type:Object},stripe:Boolean,tooltipEffect:String,tooltipOptions:{type:Object},context:{default:()=>({}),type:Object},rowClassName:[String,Function],rowStyle:[Object,Function],fixed:{type:String,default:""},highlight:Boolean};var TableBody=defineComponent({name:"ElTableBody",props:defaultProps$2,setup(t){const r=getCurrentInstance(),e=inject(TABLE_INJECTION_KEY),n=useNamespace("table"),{wrappedRowRender:g,tooltipContent:y,tooltipTrigger:i}=useRender$1(t),{onColumnsChange:k,onScrollableChange:L}=useLayoutObserver(e),$=[];return watch(t.store.states.hoverRow,(V,z)=>{var re;const oe=r==null?void 0:r.vnode.el,le=Array.from((oe==null?void 0:oe.children)||[]).filter(ae=>ae==null?void 0:ae.classList.contains(`${n.e("row")}`));let ue=V;const ie=(re=le[ue])==null?void 0:re.childNodes;ie!=null&&ie.length?Array.from(ie).reduce((Ie,de,Ce)=>{var Ue,qe;const jt=((Ue=ie[Ce-1])==null?void 0:Ue.colSpan)>1,Fe=((qe=ie[Ce+1])==null?void 0:qe.colSpan)>1;return de.nodeName!=="TD"&&!jt&&!Fe&&Ie.push(Ce),Ie},[]).forEach(Ie=>{for(var de;ue>0;){const Ce=(de=le[ue-1])==null?void 0:de.childNodes;if(Ce[Ie]&&Ce[Ie].nodeName==="TD"){addClass(Ce[Ie],"hover-cell"),$.push(Ce[Ie]);break}ue--}}):($.forEach(ae=>removeClass(ae,"hover-cell")),$.length=0),!(!t.store.states.isComplex.value||!isClient)&&rAF(()=>{const ae=le[z],Ie=le[V];ae&&!ae.classList.contains("hover-fixed-row")&&removeClass(ae,"hover-row"),Ie&&addClass(Ie,"hover-row")})}),onUnmounted(()=>{var V;(V=removePopper)==null||V()}),{ns:n,onColumnsChange:k,onScrollableChange:L,wrappedRowRender:g,tooltipContent:y,tooltipTrigger:i}},render(){const{wrappedRowRender:t,store:r}=this,e=r.states.data.value||[];return h$1("tbody",{tabIndex:-1},[e.reduce((n,g)=>n.concat(t(g,n.length)),[])])}});function useMapState(){const t=inject(TABLE_INJECTION_KEY),r=t==null?void 0:t.store,e=computed(()=>r.states.fixedLeafColumnsLength.value),n=computed(()=>r.states.rightFixedColumns.value.length),g=computed(()=>r.states.columns.value.length),y=computed(()=>r.states.fixedColumns.value.length),i=computed(()=>r.states.rightFixedColumns.value.length);return{leftFixedLeafCount:e,rightFixedLeafCount:n,columnsCount:g,leftFixedCount:y,rightFixedCount:i,columns:r.states.columns}}function useStyle$1(t){const{columns:r}=useMapState(),e=useNamespace("table");return{getCellClasses:(y,i)=>{const k=y[i],L=[e.e("cell"),k.id,k.align,k.labelClassName,...getFixedColumnsClass(e.b(),i,k.fixed,t.store)];return k.className&&L.push(k.className),k.children||L.push(e.is("leaf")),L},getCellStyles:(y,i)=>{const k=getFixedColumnOffset(i,y.fixed,t.store);return ensurePosition(k,"left"),ensurePosition(k,"right"),k},columns:r}}var TableFooter=defineComponent({name:"ElTableFooter",props:{fixed:{type:String,default:""},store:{required:!0,type:Object},summaryMethod:Function,sumText:String,border:Boolean,defaultSort:{type:Object,default:()=>({prop:"",order:""})}},setup(t){const{getCellClasses:r,getCellStyles:e,columns:n}=useStyle$1(t);return{ns:useNamespace("table"),getCellClasses:r,getCellStyles:e,columns:n}},render(){const{columns:t,getCellStyles:r,getCellClasses:e,summaryMethod:n,sumText:g}=this,y=this.store.states.data.value;let i=[];return n?i=n({columns:t,data:y}):t.forEach((k,L)=>{if(L===0){i[L]=g;return}const $=y.map(oe=>Number(oe[k.property])),V=[];let z=!0;$.forEach(oe=>{if(!Number.isNaN(+oe)){z=!1;const le=`${oe}`.split(".")[1];V.push(le?le.length:0)}});const re=Math.max.apply(null,V);z?i[L]="":i[L]=$.reduce((oe,le)=>{const ue=Number(le);return Number.isNaN(+ue)?oe:Number.parseFloat((oe+le).toFixed(Math.min(re,20)))},0)}),h$1(h$1("tfoot",[h$1("tr",{},[...t.map((k,L)=>h$1("td",{key:L,colspan:k.colSpan,rowspan:k.rowSpan,class:e(t,L),style:r(k,L)},[h$1("div",{class:["cell",k.labelClassName]},[i[L]])]))])]))}});function useUtils(t){return{setCurrentRow:V=>{t.commit("setCurrentRow",V)},getSelectionRows:()=>t.getSelectionRows(),toggleRowSelection:(V,z)=>{t.toggleRowSelection(V,z,!1),t.updateAllSelected()},clearSelection:()=>{t.clearSelection()},clearFilter:V=>{t.clearFilter(V)},toggleAllSelection:()=>{t.commit("toggleAllSelection")},toggleRowExpansion:(V,z)=>{t.toggleRowExpansionAdapter(V,z)},clearSort:()=>{t.clearSort()},sort:(V,z)=>{t.commit("sort",{prop:V,order:z})}}}function useStyle(t,r,e,n){const g=ref(!1),y=ref(null),i=ref(!1),k=lr=>{i.value=lr},L=ref({width:null,height:null,headerHeight:null}),$=ref(!1),V={display:"inline-block",verticalAlign:"middle"},z=ref(),re=ref(0),oe=ref(0),le=ref(0),ue=ref(0),ie=ref(0);watchEffect(()=>{r.setHeight(t.height)}),watchEffect(()=>{r.setMaxHeight(t.maxHeight)}),watch(()=>[t.currentRowKey,e.states.rowKey],([lr,gr])=>{!unref(gr)||!unref(lr)||e.setCurrentRowKey(`${lr}`)},{immediate:!0}),watch(()=>t.data,lr=>{n.store.commit("setData",lr)},{immediate:!0,deep:!0}),watchEffect(()=>{t.expandRowKeys&&e.setExpandRowKeysAdapter(t.expandRowKeys)});const ae=()=>{n.store.commit("setHoverRow",null),n.hoverState&&(n.hoverState=null)},Ie=(lr,gr)=>{const{pixelX:Sr,pixelY:wr}=gr;Math.abs(Sr)>=Math.abs(wr)&&(n.refs.bodyWrapper.scrollLeft+=gr.pixelX/5)},de=computed(()=>t.height||t.maxHeight||e.states.fixedColumns.value.length>0||e.states.rightFixedColumns.value.length>0),Ce=computed(()=>({width:r.bodyWidth.value?`${r.bodyWidth.value}px`:""})),Ue=()=>{de.value&&r.updateElsHeight(),r.updateColumnsWidth(),requestAnimationFrame(Et)};onMounted(async()=>{await nextTick(),e.updateColumns(),cr(),requestAnimationFrame(Ue);const lr=n.vnode.el,gr=n.refs.headerWrapper;t.flexible&&lr&&lr.parentElement&&(lr.parentElement.style.minWidth="0"),L.value={width:z.value=lr.offsetWidth,height:lr.offsetHeight,headerHeight:t.showHeader&&gr?gr.offsetHeight:null},e.states.columns.value.forEach(Sr=>{Sr.filteredValue&&Sr.filteredValue.length&&n.store.commit("filterChange",{column:Sr,values:Sr.filteredValue,silent:!0})}),n.$ready=!0});const qe=(lr,gr)=>{if(!lr)return;const Sr=Array.from(lr.classList).filter(wr=>!wr.startsWith("is-scrolling-"));Sr.push(r.scrollX.value?gr:"is-scrolling-none"),lr.className=Sr.join(" ")},jt=lr=>{const{tableWrapper:gr}=n.refs;qe(gr,lr)},Fe=lr=>{const{tableWrapper:gr}=n.refs;return!!(gr&&gr.classList.contains(lr))},Et=function(){if(!n.refs.scrollBarRef)return;if(!r.scrollX.value){const Nr="is-scrolling-none";Fe(Nr)||jt(Nr);return}const lr=n.refs.scrollBarRef.wrapRef;if(!lr)return;const{scrollLeft:gr,offsetWidth:Sr,scrollWidth:wr}=lr,{headerWrapper:kr,footerWrapper:mr}=n.refs;kr&&(kr.scrollLeft=gr),mr&&(mr.scrollLeft=gr);const Ir=wr-Sr-1;gr>=Ir?jt("is-scrolling-right"):jt(gr===0?"is-scrolling-left":"is-scrolling-middle")},cr=()=>{n.refs.scrollBarRef&&(n.refs.scrollBarRef.wrapRef&&useEventListener(n.refs.scrollBarRef.wrapRef,"scroll",Et,{passive:!0}),t.fit?useResizeObserver(n.vnode.el,er):useEventListener(window,"resize",er),useResizeObserver(n.refs.bodyWrapper,()=>{var lr,gr;er(),(gr=(lr=n.refs)==null?void 0:lr.scrollBarRef)==null||gr.update()}))},er=()=>{var lr,gr,Sr,wr;const kr=n.vnode.el;if(!n.$ready||!kr)return;let mr=!1;const{width:Ir,height:Nr,headerHeight:Er}=L.value,sr=z.value=kr.offsetWidth;Ir!==sr&&(mr=!0);const xr=kr.offsetHeight;(t.height||de.value)&&Nr!==xr&&(mr=!0);const Or=t.tableLayout==="fixed"?n.refs.headerWrapper:(lr=n.refs.tableHeaderRef)==null?void 0:lr.$el;t.showHeader&&(Or==null?void 0:Or.offsetHeight)!==Er&&(mr=!0),re.value=((gr=n.refs.tableWrapper)==null?void 0:gr.scrollHeight)||0,le.value=(Or==null?void 0:Or.scrollHeight)||0,ue.value=((Sr=n.refs.footerWrapper)==null?void 0:Sr.offsetHeight)||0,ie.value=((wr=n.refs.appendWrapper)==null?void 0:wr.offsetHeight)||0,oe.value=re.value-le.value-ue.value-ie.value,mr&&(L.value={width:sr,height:xr,headerHeight:t.showHeader&&(Or==null?void 0:Or.offsetHeight)||0},Ue())},nr=useFormSize(),dr=computed(()=>{const{bodyWidth:lr,scrollY:gr,gutterWidth:Sr}=r;return lr.value?`${lr.value-(gr.value?Sr:0)}px`:""}),ir=computed(()=>t.maxHeight?"fixed":t.tableLayout),tr=computed(()=>{if(t.data&&t.data.length)return null;let lr="100%";t.height&&oe.value&&(lr=`${oe.value}px`);const gr=z.value;return{width:gr?`${gr}px`:"",height:lr}}),ur=computed(()=>t.height?{height:Number.isNaN(Number(t.height))?t.height:`${t.height}px`}:t.maxHeight?{maxHeight:Number.isNaN(Number(t.maxHeight))?t.maxHeight:`${t.maxHeight}px`}:{}),or=computed(()=>t.height?{height:"100%"}:t.maxHeight?Number.isNaN(Number(t.maxHeight))?{maxHeight:`calc(${t.maxHeight} - ${le.value+ue.value}px)`}:{maxHeight:`${t.maxHeight-le.value-ue.value}px`}:{});return{isHidden:g,renderExpanded:y,setDragVisible:k,isGroup:$,handleMouseLeave:ae,handleHeaderFooterMousewheel:Ie,tableSize:nr,emptyBlockStyle:tr,handleFixedMousewheel:(lr,gr)=>{const Sr=n.refs.bodyWrapper;if(Math.abs(gr.spinY)>0){const wr=Sr.scrollTop;gr.pixelY<0&&wr!==0&&lr.preventDefault(),gr.pixelY>0&&Sr.scrollHeight-Sr.clientHeight>wr&&lr.preventDefault(),Sr.scrollTop+=Math.ceil(gr.pixelY/5)}else Sr.scrollLeft+=Math.ceil(gr.pixelX/5)},resizeProxyVisible:i,bodyWidth:dr,resizeState:L,doLayout:Ue,tableBodyStyles:Ce,tableLayout:ir,scrollbarViewStyle:V,tableInnerStyle:ur,scrollbarStyle:or}}function useKeyRender(t){const r=ref(),e=()=>{const g=t.vnode.el.querySelector(".hidden-columns"),y={childList:!0,subtree:!0},i=t.store.states.updateOrderFns;r.value=new MutationObserver(()=>{i.forEach(k=>k())}),r.value.observe(g,y)};onMounted(()=>{e()}),onUnmounted(()=>{var n;(n=r.value)==null||n.disconnect()})}var defaultProps$1={data:{type:Array,default:()=>[]},size:useSizeProp,width:[String,Number],height:[String,Number],maxHeight:[String,Number],fit:{type:Boolean,default:!0},stripe:Boolean,border:Boolean,rowKey:[String,Function],showHeader:{type:Boolean,default:!0},showSummary:Boolean,sumText:String,summaryMethod:Function,rowClassName:[String,Function],rowStyle:[Object,Function],cellClassName:[String,Function],cellStyle:[Object,Function],headerRowClassName:[String,Function],headerRowStyle:[Object,Function],headerCellClassName:[String,Function],headerCellStyle:[Object,Function],highlightCurrentRow:Boolean,currentRowKey:[String,Number],emptyText:String,expandRowKeys:Array,defaultExpandAll:Boolean,defaultSort:Object,tooltipEffect:String,tooltipOptions:Object,spanMethod:Function,selectOnIndeterminate:{type:Boolean,default:!0},indent:{type:Number,default:16},treeProps:{type:Object,default:()=>({hasChildren:"hasChildren",children:"children"})},lazy:Boolean,load:Function,style:{type:Object,default:()=>({})},className:{type:String,default:""},tableLayout:{type:String,default:"fixed"},scrollbarAlwaysOn:{type:Boolean,default:!1},flexible:Boolean,showOverflowTooltip:[Boolean,Object]};function hColgroup(t){const r=t.tableLayout==="auto";let e=t.columns||[];r&&e.every(g=>g.width===void 0)&&(e=[]);const n=g=>{const y={key:`${t.tableLayout}_${g.id}`,style:{},name:void 0};return r?y.style={width:`${g.width}px`}:y.name=g.id,y};return h$1("colgroup",{},e.map(g=>h$1("col",n(g))))}hColgroup.props=["columns","tableLayout"];const useScrollbar=()=>{const t=ref(),r=(y,i)=>{const k=t.value;k&&k.scrollTo(y,i)},e=(y,i)=>{const k=t.value;k&&isNumber$1(i)&&["Top","Left"].includes(y)&&k[`setScroll${y}`](i)};return{scrollBarRef:t,scrollTo:r,setScrollTop:y=>e("Top",y),setScrollLeft:y=>e("Left",y)}};let tableIdSeed=1;const _sfc_main$l=defineComponent({name:"ElTable",directives:{Mousewheel},components:{TableHeader,TableBody,TableFooter,ElScrollbar,hColgroup},props:defaultProps$1,emits:["select","select-all","selection-change","cell-mouse-enter","cell-mouse-leave","cell-contextmenu","cell-click","cell-dblclick","row-click","row-contextmenu","row-dblclick","header-click","header-contextmenu","sort-change","filter-change","current-change","header-dragend","expand-change"],setup(t){const{t:r}=useLocale(),e=useNamespace("table"),n=getCurrentInstance();provide(TABLE_INJECTION_KEY,n);const g=createStore(n,t);n.store=g;const y=new TableLayout({store:n.store,table:n,fit:t.fit,showHeader:t.showHeader});n.layout=y;const i=computed(()=>(g.states.data.value||[]).length===0),{setCurrentRow:k,getSelectionRows:L,toggleRowSelection:$,clearSelection:V,clearFilter:z,toggleAllSelection:re,toggleRowExpansion:oe,clearSort:le,sort:ue}=useUtils(g),{isHidden:ie,renderExpanded:ae,setDragVisible:Ie,isGroup:de,handleMouseLeave:Ce,handleHeaderFooterMousewheel:Ue,tableSize:qe,emptyBlockStyle:jt,handleFixedMousewheel:Fe,resizeProxyVisible:Et,bodyWidth:cr,resizeState:er,doLayout:nr,tableBodyStyles:dr,tableLayout:ir,scrollbarViewStyle:tr,tableInnerStyle:ur,scrollbarStyle:or}=useStyle(t,y,g,n),{scrollBarRef:fr,scrollTo:lr,setScrollLeft:gr,setScrollTop:Sr}=useScrollbar(),wr=debounce(nr,50),kr=`${e.namespace.value}-table_${tableIdSeed++}`;n.tableId=kr,n.state={isGroup:de,resizeState:er,doLayout:nr,debouncedUpdateLayout:wr};const mr=computed(()=>t.sumText||r("el.table.sumText")),Ir=computed(()=>t.emptyText||r("el.table.emptyText"));return useKeyRender(n),{ns:e,layout:y,store:g,handleHeaderFooterMousewheel:Ue,handleMouseLeave:Ce,tableId:kr,tableSize:qe,isHidden:ie,isEmpty:i,renderExpanded:ae,resizeProxyVisible:Et,resizeState:er,isGroup:de,bodyWidth:cr,tableBodyStyles:dr,emptyBlockStyle:jt,debouncedUpdateLayout:wr,handleFixedMousewheel:Fe,setCurrentRow:k,getSelectionRows:L,toggleRowSelection:$,clearSelection:V,clearFilter:z,toggleAllSelection:re,toggleRowExpansion:oe,clearSort:le,doLayout:nr,sort:ue,t:r,setDragVisible:Ie,context:n,computedSumText:mr,computedEmptyText:Ir,tableLayout:ir,scrollbarViewStyle:tr,tableInnerStyle:ur,scrollbarStyle:or,scrollBarRef:fr,scrollTo:lr,setScrollLeft:gr,setScrollTop:Sr}}}),_hoisted_1$f=["data-prefix"],_hoisted_2$9={ref:"hiddenColumns",class:"hidden-columns"};function _sfc_render$1(t,r,e,n,g,y){const i=resolveComponent("hColgroup"),k=resolveComponent("table-header"),L=resolveComponent("table-body"),$=resolveComponent("table-footer"),V=resolveComponent("el-scrollbar"),z=resolveDirective("mousewheel");return openBlock(),createElementBlock("div",{ref:"tableWrapper",class:normalizeClass([{[t.ns.m("fit")]:t.fit,[t.ns.m("striped")]:t.stripe,[t.ns.m("border")]:t.border||t.isGroup,[t.ns.m("hidden")]:t.isHidden,[t.ns.m("group")]:t.isGroup,[t.ns.m("fluid-height")]:t.maxHeight,[t.ns.m("scrollable-x")]:t.layout.scrollX.value,[t.ns.m("scrollable-y")]:t.layout.scrollY.value,[t.ns.m("enable-row-hover")]:!t.store.states.isComplex.value,[t.ns.m("enable-row-transition")]:(t.store.states.data.value||[]).length!==0&&(t.store.states.data.value||[]).length<100,"has-footer":t.showSummary},t.ns.m(t.tableSize),t.className,t.ns.b(),t.ns.m(`layout-${t.tableLayout}`)]),style:normalizeStyle(t.style),"data-prefix":t.ns.namespace.value,onMouseleave:r[0]||(r[0]=(...re)=>t.handleMouseLeave&&t.handleMouseLeave(...re))},[createBaseVNode("div",{class:normalizeClass(t.ns.e("inner-wrapper")),style:normalizeStyle(t.tableInnerStyle)},[createBaseVNode("div",_hoisted_2$9,[renderSlot(t.$slots,"default")],512),t.showHeader&&t.tableLayout==="fixed"?withDirectives((openBlock(),createElementBlock("div",{key:0,ref:"headerWrapper",class:normalizeClass(t.ns.e("header-wrapper"))},[createBaseVNode("table",{ref:"tableHeader",class:normalizeClass(t.ns.e("header")),style:normalizeStyle(t.tableBodyStyles),border:"0",cellpadding:"0",cellspacing:"0"},[createVNode(i,{columns:t.store.states.columns.value,"table-layout":t.tableLayout},null,8,["columns","table-layout"]),createVNode(k,{ref:"tableHeaderRef",border:t.border,"default-sort":t.defaultSort,store:t.store,onSetDragVisible:t.setDragVisible},null,8,["border","default-sort","store","onSetDragVisible"])],6)],2)),[[z,t.handleHeaderFooterMousewheel]]):createCommentVNode("v-if",!0),createBaseVNode("div",{ref:"bodyWrapper",class:normalizeClass(t.ns.e("body-wrapper"))},[createVNode(V,{ref:"scrollBarRef","view-style":t.scrollbarViewStyle,"wrap-style":t.scrollbarStyle,always:t.scrollbarAlwaysOn},{default:withCtx(()=>[createBaseVNode("table",{ref:"tableBody",class:normalizeClass(t.ns.e("body")),cellspacing:"0",cellpadding:"0",border:"0",style:normalizeStyle({width:t.bodyWidth,tableLayout:t.tableLayout})},[createVNode(i,{columns:t.store.states.columns.value,"table-layout":t.tableLayout},null,8,["columns","table-layout"]),t.showHeader&&t.tableLayout==="auto"?(openBlock(),createBlock(k,{key:0,ref:"tableHeaderRef",class:normalizeClass(t.ns.e("body-header")),border:t.border,"default-sort":t.defaultSort,store:t.store,onSetDragVisible:t.setDragVisible},null,8,["class","border","default-sort","store","onSetDragVisible"])):createCommentVNode("v-if",!0),createVNode(L,{context:t.context,highlight:t.highlightCurrentRow,"row-class-name":t.rowClassName,"tooltip-effect":t.tooltipEffect,"tooltip-options":t.tooltipOptions,"row-style":t.rowStyle,store:t.store,stripe:t.stripe},null,8,["context","highlight","row-class-name","tooltip-effect","tooltip-options","row-style","store","stripe"]),t.showSummary&&t.tableLayout==="auto"?(openBlock(),createBlock($,{key:1,class:normalizeClass(t.ns.e("body-footer")),border:t.border,"default-sort":t.defaultSort,store:t.store,"sum-text":t.computedSumText,"summary-method":t.summaryMethod},null,8,["class","border","default-sort","store","sum-text","summary-method"])):createCommentVNode("v-if",!0)],6),t.isEmpty?(openBlock(),createElementBlock("div",{key:0,ref:"emptyBlock",style:normalizeStyle(t.emptyBlockStyle),class:normalizeClass(t.ns.e("empty-block"))},[createBaseVNode("span",{class:normalizeClass(t.ns.e("empty-text"))},[renderSlot(t.$slots,"empty",{},()=>[createTextVNode(toDisplayString(t.computedEmptyText),1)])],2)],6)):createCommentVNode("v-if",!0),t.$slots.append?(openBlock(),createElementBlock("div",{key:1,ref:"appendWrapper",class:normalizeClass(t.ns.e("append-wrapper"))},[renderSlot(t.$slots,"append")],2)):createCommentVNode("v-if",!0)]),_:3},8,["view-style","wrap-style","always"])],2),t.showSummary&&t.tableLayout==="fixed"?withDirectives((openBlock(),createElementBlock("div",{key:1,ref:"footerWrapper",class:normalizeClass(t.ns.e("footer-wrapper"))},[createBaseVNode("table",{class:normalizeClass(t.ns.e("footer")),cellspacing:"0",cellpadding:"0",border:"0",style:normalizeStyle(t.tableBodyStyles)},[createVNode(i,{columns:t.store.states.columns.value,"table-layout":t.tableLayout},null,8,["columns","table-layout"]),createVNode($,{border:t.border,"default-sort":t.defaultSort,store:t.store,"sum-text":t.computedSumText,"summary-method":t.summaryMethod},null,8,["border","default-sort","store","sum-text","summary-method"])],6)],2)),[[vShow,!t.isEmpty],[z,t.handleHeaderFooterMousewheel]]):createCommentVNode("v-if",!0),t.border||t.isGroup?(openBlock(),createElementBlock("div",{key:2,class:normalizeClass(t.ns.e("border-left-patch"))},null,2)):createCommentVNode("v-if",!0)],6),withDirectives(createBaseVNode("div",{ref:"resizeProxy",class:normalizeClass(t.ns.e("column-resize-proxy"))},null,2),[[vShow,t.resizeProxyVisible]])],46,_hoisted_1$f)}var Table=_export_sfc$1(_sfc_main$l,[["render",_sfc_render$1],["__file","table.vue"]]);const defaultClassNames={selection:"table-column--selection",expand:"table__expand-column"},cellStarts={default:{order:""},selection:{width:48,minWidth:48,realWidth:48,order:""},expand:{width:48,minWidth:48,realWidth:48,order:""},index:{width:48,minWidth:48,realWidth:48,order:""}},getDefaultClassName=t=>defaultClassNames[t]||"",cellForced={selection:{renderHeader({store:t,column:r}){function e(){return t.states.data.value&&t.states.data.value.length===0}return h$1(ElCheckbox,{disabled:e(),size:t.states.tableSize.value,indeterminate:t.states.selection.value.length>0&&!t.states.isAllSelected.value,"onUpdate:modelValue":t.toggleAllSelection,modelValue:t.states.isAllSelected.value,ariaLabel:r.label})},renderCell({row:t,column:r,store:e,$index:n}){return h$1(ElCheckbox,{disabled:r.selectable?!r.selectable.call(null,t,n):!1,size:e.states.tableSize.value,onChange:()=>{e.commit("rowSelectedChanged",t)},onClick:g=>g.stopPropagation(),modelValue:e.isSelected(t),ariaLabel:r.label})},sortable:!1,resizable:!1},index:{renderHeader({column:t}){return t.label||"#"},renderCell({column:t,$index:r}){let e=r+1;const n=t.index;return typeof n=="number"?e=r+n:typeof n=="function"&&(e=n(r)),h$1("div",{},[e])},sortable:!1},expand:{renderHeader({column:t}){return t.label||""},renderCell({row:t,store:r,expanded:e}){const{ns:n}=r,g=[n.e("expand-icon")];return e&&g.push(n.em("expand-icon","expanded")),h$1("div",{class:g,onClick:function(i){i.stopPropagation(),r.toggleRowExpansion(t)}},{default:()=>[h$1(ElIcon,null,{default:()=>[h$1(arrow_right_default)]})]})},sortable:!1,resizable:!1}};function defaultRenderCell({row:t,column:r,$index:e}){var n;const g=r.property,y=g&&getProp(t,g).value;return r&&r.formatter?r.formatter(t,r,y,e):((n=y==null?void 0:y.toString)==null?void 0:n.call(y))||""}function treeCellPrefix({row:t,treeNode:r,store:e},n=!1){const{ns:g}=e;if(!r)return n?[h$1("span",{class:g.e("placeholder")})]:null;const y=[],i=function(k){k.stopPropagation(),!r.loading&&e.loadOrToggle(t)};if(r.indent&&y.push(h$1("span",{class:g.e("indent"),style:{"padding-left":`${r.indent}px`}})),typeof r.expanded=="boolean"&&!r.noLazyChildren){const k=[g.e("expand-icon"),r.expanded?g.em("expand-icon","expanded"):""];let L=arrow_right_default;r.loading&&(L=loading_default),y.push(h$1("div",{class:k,onClick:i},{default:()=>[h$1(ElIcon,{class:{[g.is("loading")]:r.loading}},{default:()=>[h$1(L)]})]}))}else y.push(h$1("span",{class:g.e("placeholder")}));return y}function getAllAliases(t,r){return t.reduce((e,n)=>(e[n]=n,e),r)}function useWatcher(t,r){const e=getCurrentInstance();return{registerComplexWatchers:()=>{const y=["fixed"],i={realWidth:"width",realMinWidth:"minWidth"},k=getAllAliases(y,i);Object.keys(k).forEach(L=>{const $=i[L];hasOwn(r,$)&&watch(()=>r[$],V=>{let z=V;$==="width"&&L==="realWidth"&&(z=parseWidth(V)),$==="minWidth"&&L==="realMinWidth"&&(z=parseMinWidth(V)),e.columnConfig.value[$]=z,e.columnConfig.value[L]=z;const re=$==="fixed";t.value.store.scheduleLayout(re)})})},registerNormalWatchers:()=>{const y=["label","filters","filterMultiple","filteredValue","sortable","index","formatter","className","labelClassName","filterClassName","showOverflowTooltip"],i={property:"prop",align:"realAlign",headerAlign:"realHeaderAlign"},k=getAllAliases(y,i);Object.keys(k).forEach(L=>{const $=i[L];hasOwn(r,$)&&watch(()=>r[$],V=>{e.columnConfig.value[L]=V})})}}}function useRender(t,r,e){const n=getCurrentInstance(),g=ref(""),y=ref(!1),i=ref(),k=ref(),L=useNamespace("table");watchEffect(()=>{i.value=t.align?`is-${t.align}`:null,i.value}),watchEffect(()=>{k.value=t.headerAlign?`is-${t.headerAlign}`:i.value,k.value});const $=computed(()=>{let Ce=n.vnode.vParent||n.parent;for(;Ce&&!Ce.tableId&&!Ce.columnId;)Ce=Ce.vnode.vParent||Ce.parent;return Ce}),V=computed(()=>{const{store:Ce}=n.parent;if(!Ce)return!1;const{treeData:Ue}=Ce.states,qe=Ue.value;return qe&&Object.keys(qe).length>0}),z=ref(parseWidth(t.width)),re=ref(parseMinWidth(t.minWidth)),oe=Ce=>(z.value&&(Ce.width=z.value),re.value&&(Ce.minWidth=re.value),!z.value&&re.value&&(Ce.width=void 0),Ce.minWidth||(Ce.minWidth=80),Ce.realWidth=Number(Ce.width===void 0?Ce.minWidth:Ce.width),Ce),le=Ce=>{const Ue=Ce.type,qe=cellForced[Ue]||{};Object.keys(qe).forEach(Fe=>{const Et=qe[Fe];Fe!=="className"&&Et!==void 0&&(Ce[Fe]=Et)});const jt=getDefaultClassName(Ue);if(jt){const Fe=`${unref(L.namespace)}-${jt}`;Ce.className=Ce.className?`${Ce.className} ${Fe}`:Fe}return Ce},ue=Ce=>{Array.isArray(Ce)?Ce.forEach(qe=>Ue(qe)):Ue(Ce);function Ue(qe){var jt;((jt=qe==null?void 0:qe.type)==null?void 0:jt.name)==="ElTableColumn"&&(qe.vParent=n)}};return{columnId:g,realAlign:i,isSubColumn:y,realHeaderAlign:k,columnOrTableParent:$,setColumnWidth:oe,setColumnForcedProps:le,setColumnRenders:Ce=>{t.renderHeader||Ce.type!=="selection"&&(Ce.renderHeader=qe=>(n.columnConfig.value.label,renderSlot(r,"header",qe,()=>[Ce.label])));let Ue=Ce.renderCell;return Ce.type==="expand"?(Ce.renderCell=qe=>h$1("div",{class:"cell"},[Ue(qe)]),e.value.renderExpanded=qe=>r.default?r.default(qe):r.default):(Ue=Ue||defaultRenderCell,Ce.renderCell=qe=>{let jt=null;if(r.default){const dr=r.default(qe);jt=dr.some(ir=>ir.type!==Comment)?dr:Ue(qe)}else jt=Ue(qe);const{columns:Fe}=e.value.store.states,Et=Fe.value.findIndex(dr=>dr.type==="default"),cr=V.value&&qe.cellIndex===Et,er=treeCellPrefix(qe,cr),nr={class:"cell",style:{}};return Ce.showOverflowTooltip&&(nr.class=`${nr.class} ${unref(L.namespace)}-tooltip`,nr.style={width:`${(qe.column.realWidth||Number(qe.column.width))-1}px`}),ue(jt),h$1("div",nr,[er,jt])}),Ce},getPropsData:(...Ce)=>Ce.reduce((Ue,qe)=>(Array.isArray(qe)&&qe.forEach(jt=>{Ue[jt]=t[jt]}),Ue),{}),getColumnElIndex:(Ce,Ue)=>Array.prototype.indexOf.call(Ce,Ue),updateColumnOrder:()=>{e.value.store.commit("updateColumnOrder",n.columnConfig.value)}}}var defaultProps={type:{type:String,default:"default"},label:String,className:String,labelClassName:String,property:String,prop:String,width:{type:[String,Number],default:""},minWidth:{type:[String,Number],default:""},renderHeader:Function,sortable:{type:[Boolean,String],default:!1},sortMethod:Function,sortBy:[String,Function,Array],resizable:{type:Boolean,default:!0},columnKey:String,align:String,headerAlign:String,showOverflowTooltip:{type:[Boolean,Object],default:void 0},fixed:[Boolean,String],formatter:Function,selectable:Function,reserveSelection:Boolean,filterMethod:Function,filteredValue:Array,filters:Array,filterPlacement:String,filterMultiple:{type:Boolean,default:!0},filterClassName:String,index:[Number,Function],sortOrders:{type:Array,default:()=>["ascending","descending",null],validator:t=>t.every(r=>["ascending","descending",null].includes(r))}};let columnIdSeed=1;var ElTableColumn$1=defineComponent({name:"ElTableColumn",components:{ElCheckbox},props:defaultProps,setup(t,{slots:r}){const e=getCurrentInstance(),n=ref({}),g=computed(()=>{let de=e.parent;for(;de&&!de.tableId;)de=de.parent;return de}),{registerNormalWatchers:y,registerComplexWatchers:i}=useWatcher(g,t),{columnId:k,isSubColumn:L,realHeaderAlign:$,columnOrTableParent:V,setColumnWidth:z,setColumnForcedProps:re,setColumnRenders:oe,getPropsData:le,getColumnElIndex:ue,realAlign:ie,updateColumnOrder:ae}=useRender(t,r,g),Ie=V.value;k.value=`${Ie.tableId||Ie.columnId}_column_${columnIdSeed++}`,onBeforeMount(()=>{L.value=g.value!==Ie;const de=t.type||"default",Ce=t.sortable===""?!0:t.sortable,Ue=isUndefined$1(t.showOverflowTooltip)?Ie.props.showOverflowTooltip:t.showOverflowTooltip,qe={...cellStarts[de],id:k.value,type:de,property:t.prop||t.property,align:ie,headerAlign:$,showOverflowTooltip:Ue,filterable:t.filters||t.filterMethod,filteredValue:[],filterPlacement:"",filterClassName:"",isColumnGroup:!1,isSubColumn:!1,filterOpened:!1,sortable:Ce,index:t.index,rawColumnKey:e.vnode.key};let er=le(["columnKey","label","className","labelClassName","type","renderHeader","formatter","fixed","resizable"],["sortMethod","sortBy","sortOrders"],["selectable","reserveSelection"],["filterMethod","filters","filterMultiple","filterOpened","filteredValue","filterPlacement","filterClassName"]);er=mergeOptions(qe,er),er=compose(oe,z,re)(er),n.value=er,y(),i()}),onMounted(()=>{var de;const Ce=V.value,Ue=L.value?Ce.vnode.el.children:(de=Ce.refs.hiddenColumns)==null?void 0:de.children,qe=()=>ue(Ue||[],e.vnode.el);n.value.getColumnIndex=qe,qe()>-1&&g.value.store.commit("insertColumn",n.value,L.value?Ce.columnConfig.value:null,ae)}),onBeforeUnmount(()=>{g.value.store.commit("removeColumn",n.value,L.value?Ie.columnConfig.value:null,ae)}),e.columnId=k.value,e.columnConfig=n},render(){var t,r,e;try{const n=(r=(t=this.$slots).default)==null?void 0:r.call(t,{row:{},column:{},$index:-1}),g=[];if(Array.isArray(n))for(const i of n)((e=i.type)==null?void 0:e.name)==="ElTableColumn"||i.shapeFlag&2?g.push(i):i.type===Fragment&&Array.isArray(i.children)&&i.children.forEach(k=>{(k==null?void 0:k.patchFlag)!==1024&&!isString$2(k==null?void 0:k.children)&&g.push(k)});return h$1("div",g)}catch{return h$1("div",[])}}});const ElTable=withInstall(Table,{TableColumn:ElTableColumn$1}),ElTableColumn=withNoopInstall(ElTableColumn$1),uploadContextKey=Symbol("uploadContextKey"),SCOPE$1="ElUpload";class UploadAjaxError extends Error{constructor(r,e,n,g){super(r),this.name="UploadAjaxError",this.status=e,this.method=n,this.url=g}}function getError(t,r,e){let n;return e.response?n=`${e.response.error||e.response}`:e.responseText?n=`${e.responseText}`:n=`fail to ${r.method} ${t} ${e.status}`,new UploadAjaxError(n,e.status,r.method,t)}function getBody(t){const r=t.responseText||t.response;if(!r)return r;try{return JSON.parse(r)}catch{return r}}const ajaxUpload=t=>{typeof XMLHttpRequest>"u"&&throwError(SCOPE$1,"XMLHttpRequest is undefined");const r=new XMLHttpRequest,e=t.action;r.upload&&r.upload.addEventListener("progress",y=>{const i=y;i.percent=y.total>0?y.loaded/y.total*100:0,t.onProgress(i)});const n=new FormData;if(t.data)for(const[y,i]of Object.entries(t.data))isArray$3(i)&&i.length?n.append(y,...i):n.append(y,i);n.append(t.filename,t.file,t.file.name),r.addEventListener("error",()=>{t.onError(getError(e,t,r))}),r.addEventListener("load",()=>{if(r.status<200||r.status>=300)return t.onError(getError(e,t,r));t.onSuccess(getBody(r))}),r.open(t.method,e,!0),t.withCredentials&&"withCredentials"in r&&(r.withCredentials=!0);const g=t.headers||{};if(g instanceof Headers)g.forEach((y,i)=>r.setRequestHeader(i,y));else for(const[y,i]of Object.entries(g))isNil(i)||r.setRequestHeader(y,String(i));return r.send(n),r},uploadListTypes=["text","picture","picture-card"];let fileId=1;const genFileId=()=>Date.now()+fileId++,uploadBaseProps=buildProps({action:{type:String,default:"#"},headers:{type:definePropType(Object)},method:{type:String,default:"post"},data:{type:definePropType([Object,Function,Promise]),default:()=>mutable({})},multiple:{type:Boolean,default:!1},name:{type:String,default:"file"},drag:{type:Boolean,default:!1},withCredentials:Boolean,showFileList:{type:Boolean,default:!0},accept:{type:String,default:""},fileList:{type:definePropType(Array),default:()=>mutable([])},autoUpload:{type:Boolean,default:!0},listType:{type:String,values:uploadListTypes,default:"text"},httpRequest:{type:definePropType(Function),default:ajaxUpload},disabled:Boolean,limit:Number}),uploadProps=buildProps({...uploadBaseProps,beforeUpload:{type:definePropType(Function),default:NOOP},beforeRemove:{type:definePropType(Function)},onRemove:{type:definePropType(Function),default:NOOP},onChange:{type:definePropType(Function),default:NOOP},onPreview:{type:definePropType(Function),default:NOOP},onSuccess:{type:definePropType(Function),default:NOOP},onProgress:{type:definePropType(Function),default:NOOP},onError:{type:definePropType(Function),default:NOOP},onExceed:{type:definePropType(Function),default:NOOP},crossorigin:{type:definePropType(String)}}),uploadListProps=buildProps({files:{type:definePropType(Array),default:()=>mutable([])},disabled:{type:Boolean,default:!1},handlePreview:{type:definePropType(Function),default:NOOP},listType:{type:String,values:uploadListTypes,default:"text"},crossorigin:{type:definePropType(String)}}),uploadListEmits={remove:t=>!!t},_hoisted_1$e=["onKeydown"],_hoisted_2$8=["src","crossorigin"],_hoisted_3$6=["onClick"],_hoisted_4$5=["title"],_hoisted_5$4=["onClick"],_hoisted_6$3=["onClick"],__default__$4=defineComponent({name:"ElUploadList"}),_sfc_main$k=defineComponent({...__default__$4,props:uploadListProps,emits:uploadListEmits,setup(t,{emit:r}){const e=t,{t:n}=useLocale(),g=useNamespace("upload"),y=useNamespace("icon"),i=useNamespace("list"),k=useFormDisabled(),L=ref(!1),$=computed(()=>[g.b("list"),g.bm("list",e.listType),g.is("disabled",e.disabled)]),V=z=>{r("remove",z)};return(z,re)=>(openBlock(),createBlock(TransitionGroup,{tag:"ul",class:normalizeClass(unref($)),name:unref(i).b()},{default:withCtx(()=>[(openBlock(!0),createElementBlock(Fragment,null,renderList(z.files,oe=>(openBlock(),createElementBlock("li",{key:oe.uid||oe.name,class:normalizeClass([unref(g).be("list","item"),unref(g).is(oe.status),{focusing:L.value}]),tabindex:"0",onKeydown:withKeys(le=>!unref(k)&&V(oe),["delete"]),onFocus:re[0]||(re[0]=le=>L.value=!0),onBlur:re[1]||(re[1]=le=>L.value=!1),onClick:re[2]||(re[2]=le=>L.value=!1)},[renderSlot(z.$slots,"default",{file:oe},()=>[z.listType==="picture"||oe.status!=="uploading"&&z.listType==="picture-card"?(openBlock(),createElementBlock("img",{key:0,class:normalizeClass(unref(g).be("list","item-thumbnail")),src:oe.url,crossorigin:z.crossorigin,alt:""},null,10,_hoisted_2$8)):createCommentVNode("v-if",!0),oe.status==="uploading"||z.listType!=="picture-card"?(openBlock(),createElementBlock("div",{key:1,class:normalizeClass(unref(g).be("list","item-info"))},[createBaseVNode("a",{class:normalizeClass(unref(g).be("list","item-name")),onClick:withModifiers(le=>z.handlePreview(oe),["prevent"])},[createVNode(unref(ElIcon),{class:normalizeClass(unref(y).m("document"))},{default:withCtx(()=>[createVNode(unref(document_default))]),_:1},8,["class"]),createBaseVNode("span",{class:normalizeClass(unref(g).be("list","item-file-name")),title:oe.name},toDisplayString(oe.name),11,_hoisted_4$5)],10,_hoisted_3$6),oe.status==="uploading"?(openBlock(),createBlock(unref(ElProgress),{key:0,type:z.listType==="picture-card"?"circle":"line","stroke-width":z.listType==="picture-card"?6:2,percentage:Number(oe.percentage),style:normalizeStyle(z.listType==="picture-card"?"":"margin-top: 0.5rem")},null,8,["type","stroke-width","percentage","style"])):createCommentVNode("v-if",!0)],2)):createCommentVNode("v-if",!0),createBaseVNode("label",{class:normalizeClass(unref(g).be("list","item-status-label"))},[z.listType==="text"?(openBlock(),createBlock(unref(ElIcon),{key:0,class:normalizeClass([unref(y).m("upload-success"),unref(y).m("circle-check")])},{default:withCtx(()=>[createVNode(unref(circle_check_default))]),_:1},8,["class"])):["picture-card","picture"].includes(z.listType)?(openBlock(),createBlock(unref(ElIcon),{key:1,class:normalizeClass([unref(y).m("upload-success"),unref(y).m("check")])},{default:withCtx(()=>[createVNode(unref(check_default))]),_:1},8,["class"])):createCommentVNode("v-if",!0)],2),unref(k)?createCommentVNode("v-if",!0):(openBlock(),createBlock(unref(ElIcon),{key:2,class:normalizeClass(unref(y).m("close")),onClick:le=>V(oe)},{default:withCtx(()=>[createVNode(unref(close_default))]),_:2},1032,["class","onClick"])),createCommentVNode(" Due to close btn only appears when li gets focused disappears after li gets blurred, thus keyboard navigation can never reach close btn"),createCommentVNode(" This is a bug which needs to be fixed "),createCommentVNode(" TODO: Fix the incorrect navigation interaction "),unref(k)?createCommentVNode("v-if",!0):(openBlock(),createElementBlock("i",{key:3,class:normalizeClass(unref(y).m("close-tip"))},toDisplayString(unref(n)("el.upload.deleteTip")),3)),z.listType==="picture-card"?(openBlock(),createElementBlock("span",{key:4,class:normalizeClass(unref(g).be("list","item-actions"))},[createBaseVNode("span",{class:normalizeClass(unref(g).be("list","item-preview")),onClick:le=>z.handlePreview(oe)},[createVNode(unref(ElIcon),{class:normalizeClass(unref(y).m("zoom-in"))},{default:withCtx(()=>[createVNode(unref(zoom_in_default))]),_:1},8,["class"])],10,_hoisted_5$4),unref(k)?createCommentVNode("v-if",!0):(openBlock(),createElementBlock("span",{key:0,class:normalizeClass(unref(g).be("list","item-delete")),onClick:le=>V(oe)},[createVNode(unref(ElIcon),{class:normalizeClass(unref(y).m("delete"))},{default:withCtx(()=>[createVNode(unref(delete_default))]),_:1},8,["class"])],10,_hoisted_6$3))],2)):createCommentVNode("v-if",!0)])],42,_hoisted_1$e))),128)),renderSlot(z.$slots,"append")]),_:3},8,["class","name"]))}});var UploadList=_export_sfc$1(_sfc_main$k,[["__file","upload-list.vue"]]);const uploadDraggerProps=buildProps({disabled:{type:Boolean,default:!1}}),uploadDraggerEmits={file:t=>isArray$3(t)},_hoisted_1$d=["onDrop","onDragover"],COMPONENT_NAME="ElUploadDrag",__default__$3=defineComponent({name:COMPONENT_NAME}),_sfc_main$j=defineComponent({...__default__$3,props:uploadDraggerProps,emits:uploadDraggerEmits,setup(t,{emit:r}){const e=inject(uploadContextKey);e||throwError(COMPONENT_NAME,"usage: <el-upload><el-upload-dragger /></el-upload>");const n=useNamespace("upload"),g=ref(!1),y=useFormDisabled(),i=L=>{if(y.value)return;g.value=!1,L.stopPropagation();const $=Array.from(L.dataTransfer.files),V=e.accept.value;if(!V){r("file",$);return}const z=$.filter(re=>{const{type:oe,name:le}=re,ue=le.includes(".")?`.${le.split(".").pop()}`:"",ie=oe.replace(/\/.*$/,"");return V.split(",").map(ae=>ae.trim()).filter(ae=>ae).some(ae=>ae.startsWith(".")?ue===ae:/\/\*$/.test(ae)?ie===ae.replace(/\/\*$/,""):/^[^/]+\/[^/]+$/.test(ae)?oe===ae:!1)});r("file",z)},k=()=>{y.value||(g.value=!0)};return(L,$)=>(openBlock(),createElementBlock("div",{class:normalizeClass([unref(n).b("dragger"),unref(n).is("dragover",g.value)]),onDrop:withModifiers(i,["prevent"]),onDragover:withModifiers(k,["prevent"]),onDragleave:$[0]||($[0]=withModifiers(V=>g.value=!1,["prevent"]))},[renderSlot(L.$slots,"default")],42,_hoisted_1$d))}});var UploadDragger=_export_sfc$1(_sfc_main$j,[["__file","upload-dragger.vue"]]);const uploadContentProps=buildProps({...uploadBaseProps,beforeUpload:{type:definePropType(Function),default:NOOP},onRemove:{type:definePropType(Function),default:NOOP},onStart:{type:definePropType(Function),default:NOOP},onSuccess:{type:definePropType(Function),default:NOOP},onProgress:{type:definePropType(Function),default:NOOP},onError:{type:definePropType(Function),default:NOOP},onExceed:{type:definePropType(Function),default:NOOP}}),_hoisted_1$c=["onKeydown"],_hoisted_2$7=["name","multiple","accept"],__default__$2=defineComponent({name:"ElUploadContent",inheritAttrs:!1}),_sfc_main$i=defineComponent({...__default__$2,props:uploadContentProps,setup(t,{expose:r}){const e=t,n=useNamespace("upload"),g=useFormDisabled(),y=shallowRef({}),i=shallowRef(),k=ue=>{if(ue.length===0)return;const{autoUpload:ie,limit:ae,fileList:Ie,multiple:de,onStart:Ce,onExceed:Ue}=e;if(ae&&Ie.length+ue.length>ae){Ue(ue,Ie);return}de||(ue=ue.slice(0,1));for(const qe of ue){const jt=qe;jt.uid=genFileId(),Ce(jt),ie&&L(jt)}},L=async ue=>{if(i.value.value="",!e.beforeUpload)return V(ue);let ie,ae={};try{const de=e.data,Ce=e.beforeUpload(ue);ae=isPlainObject$2(e.data)?cloneDeep(e.data):e.data,ie=await Ce,isPlainObject$2(e.data)&&isEqual(de,ae)&&(ae=cloneDeep(e.data))}catch{ie=!1}if(ie===!1){e.onRemove(ue);return}let Ie=ue;ie instanceof Blob&&(ie instanceof File?Ie=ie:Ie=new File([ie],ue.name,{type:ue.type})),V(Object.assign(Ie,{uid:ue.uid}),ae)},$=async(ue,ie)=>isFunction$3(ue)?ue(ie):ue,V=async(ue,ie)=>{const{headers:ae,data:Ie,method:de,withCredentials:Ce,name:Ue,action:qe,onProgress:jt,onSuccess:Fe,onError:Et,httpRequest:cr}=e;try{ie=await $(ie??Ie,ue)}catch{e.onRemove(ue);return}const{uid:er}=ue,nr={headers:ae||{},withCredentials:Ce,file:ue,data:ie,method:de,filename:Ue,action:qe,onProgress:ir=>{jt(ir,ue)},onSuccess:ir=>{Fe(ir,ue),delete y.value[er]},onError:ir=>{Et(ir,ue),delete y.value[er]}},dr=cr(nr);y.value[er]=dr,dr instanceof Promise&&dr.then(nr.onSuccess,nr.onError)},z=ue=>{const ie=ue.target.files;ie&&k(Array.from(ie))},re=()=>{g.value||(i.value.value="",i.value.click())},oe=()=>{re()};return r({abort:ue=>{entriesOf(y.value).filter(ue?([ae])=>String(ue.uid)===ae:()=>!0).forEach(([ae,Ie])=>{Ie instanceof XMLHttpRequest&&Ie.abort(),delete y.value[ae]})},upload:L}),(ue,ie)=>(openBlock(),createElementBlock("div",{class:normalizeClass([unref(n).b(),unref(n).m(ue.listType),unref(n).is("drag",ue.drag)]),tabindex:"0",onClick:re,onKeydown:withKeys(withModifiers(oe,["self"]),["enter","space"])},[ue.drag?(openBlock(),createBlock(UploadDragger,{key:0,disabled:unref(g),onFile:k},{default:withCtx(()=>[renderSlot(ue.$slots,"default")]),_:3},8,["disabled"])):renderSlot(ue.$slots,"default",{key:1}),createBaseVNode("input",{ref_key:"inputRef",ref:i,class:normalizeClass(unref(n).e("input")),name:ue.name,multiple:ue.multiple,accept:ue.accept,type:"file",onChange:z,onClick:ie[0]||(ie[0]=withModifiers(()=>{},["stop"]))},null,42,_hoisted_2$7)],42,_hoisted_1$c))}});var UploadContent=_export_sfc$1(_sfc_main$i,[["__file","upload-content.vue"]]);const SCOPE="ElUpload",revokeFileObjectURL=t=>{var r;(r=t.url)!=null&&r.startsWith("blob:")&&URL.revokeObjectURL(t.url)},useHandlers=(t,r)=>{const e=useVModel(t,"fileList",void 0,{passive:!0}),n=re=>e.value.find(oe=>oe.uid===re.uid);function g(re){var oe;(oe=r.value)==null||oe.abort(re)}function y(re=["ready","uploading","success","fail"]){e.value=e.value.filter(oe=>!re.includes(oe.status))}const i=(re,oe)=>{const le=n(oe);le&&(console.error(re),le.status="fail",e.value.splice(e.value.indexOf(le),1),t.onError(re,le,e.value),t.onChange(le,e.value))},k=(re,oe)=>{const le=n(oe);le&&(t.onProgress(re,le,e.value),le.status="uploading",le.percentage=Math.round(re.percent))},L=(re,oe)=>{const le=n(oe);le&&(le.status="success",le.response=re,t.onSuccess(re,le,e.value),t.onChange(le,e.value))},$=re=>{isNil(re.uid)&&(re.uid=genFileId());const oe={name:re.name,percentage:0,status:"ready",size:re.size,raw:re,uid:re.uid};if(t.listType==="picture-card"||t.listType==="picture")try{oe.url=URL.createObjectURL(re)}catch(le){le.message,t.onError(le,oe,e.value)}e.value=[...e.value,oe],t.onChange(oe,e.value)},V=async re=>{const oe=re instanceof File?n(re):re;oe||throwError(SCOPE,"file to be removed not found");const le=ue=>{g(ue);const ie=e.value;ie.splice(ie.indexOf(ue),1),t.onRemove(ue,ie),revokeFileObjectURL(ue)};t.beforeRemove?await t.beforeRemove(oe,e.value)!==!1&&le(oe):le(oe)};function z(){e.value.filter(({status:re})=>re==="ready").forEach(({raw:re})=>{var oe;return re&&((oe=r.value)==null?void 0:oe.upload(re))})}return watch(()=>t.listType,re=>{re!=="picture-card"&&re!=="picture"||(e.value=e.value.map(oe=>{const{raw:le,url:ue}=oe;if(!ue&&le)try{oe.url=URL.createObjectURL(le)}catch(ie){t.onError(ie,oe,e.value)}return oe}))}),watch(e,re=>{for(const oe of re)oe.uid||(oe.uid=genFileId()),oe.status||(oe.status="success")},{immediate:!0,deep:!0}),{uploadFiles:e,abort:g,clearFiles:y,handleError:i,handleProgress:k,handleStart:$,handleSuccess:L,handleRemove:V,submit:z,revokeFileObjectURL}},__default__$1=defineComponent({name:"ElUpload"}),_sfc_main$h=defineComponent({...__default__$1,props:uploadProps,setup(t,{expose:r}){const e=t,n=useFormDisabled(),g=shallowRef(),{abort:y,submit:i,clearFiles:k,uploadFiles:L,handleStart:$,handleError:V,handleRemove:z,handleSuccess:re,handleProgress:oe,revokeFileObjectURL:le}=useHandlers(e,g),ue=computed(()=>e.listType==="picture-card"),ie=computed(()=>({...e,fileList:L.value,onStart:$,onProgress:oe,onSuccess:re,onError:V,onRemove:z}));return onBeforeUnmount(()=>{L.value.forEach(le)}),provide(uploadContextKey,{accept:toRef(e,"accept")}),r({abort:y,submit:i,clearFiles:k,handleStart:$,handleRemove:z}),(ae,Ie)=>(openBlock(),createElementBlock("div",null,[unref(ue)&&ae.showFileList?(openBlock(),createBlock(UploadList,{key:0,disabled:unref(n),"list-type":ae.listType,files:unref(L),crossorigin:ae.crossorigin,"handle-preview":ae.onPreview,onRemove:unref(z)},createSlots({append:withCtx(()=>[createVNode(UploadContent,mergeProps({ref_key:"uploadRef",ref:g},unref(ie)),{default:withCtx(()=>[ae.$slots.trigger?renderSlot(ae.$slots,"trigger",{key:0}):createCommentVNode("v-if",!0),!ae.$slots.trigger&&ae.$slots.default?renderSlot(ae.$slots,"default",{key:1}):createCommentVNode("v-if",!0)]),_:3},16)]),_:2},[ae.$slots.file?{name:"default",fn:withCtx(({file:de})=>[renderSlot(ae.$slots,"file",{file:de})])}:void 0]),1032,["disabled","list-type","files","crossorigin","handle-preview","onRemove"])):createCommentVNode("v-if",!0),!unref(ue)||unref(ue)&&!ae.showFileList?(openBlock(),createBlock(UploadContent,mergeProps({key:1,ref_key:"uploadRef",ref:g},unref(ie)),{default:withCtx(()=>[ae.$slots.trigger?renderSlot(ae.$slots,"trigger",{key:0}):createCommentVNode("v-if",!0),!ae.$slots.trigger&&ae.$slots.default?renderSlot(ae.$slots,"default",{key:1}):createCommentVNode("v-if",!0)]),_:3},16)):createCommentVNode("v-if",!0),ae.$slots.trigger?renderSlot(ae.$slots,"default",{key:2}):createCommentVNode("v-if",!0),renderSlot(ae.$slots,"tip"),!unref(ue)&&ae.showFileList?(openBlock(),createBlock(UploadList,{key:3,disabled:unref(n),"list-type":ae.listType,files:unref(L),crossorigin:ae.crossorigin,"handle-preview":ae.onPreview,onRemove:unref(z)},createSlots({_:2},[ae.$slots.file?{name:"default",fn:withCtx(({file:de})=>[renderSlot(ae.$slots,"file",{file:de})])}:void 0]),1032,["disabled","list-type","files","crossorigin","handle-preview","onRemove"])):createCommentVNode("v-if",!0)]))}});var Upload=_export_sfc$1(_sfc_main$h,[["__file","upload.vue"]]);const ElUpload=withInstall(Upload),messageTypes=["success","info","warning","error"],messageDefaults=mutable({customClass:"",center:!1,dangerouslyUseHTMLString:!1,duration:3e3,icon:void 0,id:"",message:"",onClose:void 0,showClose:!1,type:"info",offset:16,zIndex:0,grouping:!1,repeatNum:1,appendTo:isClient?document.body:void 0}),messageProps=buildProps({customClass:{type:String,default:messageDefaults.customClass},center:{type:Boolean,default:messageDefaults.center},dangerouslyUseHTMLString:{type:Boolean,default:messageDefaults.dangerouslyUseHTMLString},duration:{type:Number,default:messageDefaults.duration},icon:{type:iconPropType,default:messageDefaults.icon},id:{type:String,default:messageDefaults.id},message:{type:definePropType([String,Object,Function]),default:messageDefaults.message},onClose:{type:definePropType(Function),required:!1},showClose:{type:Boolean,default:messageDefaults.showClose},type:{type:String,values:messageTypes,default:messageDefaults.type},offset:{type:Number,default:messageDefaults.offset},zIndex:{type:Number,default:messageDefaults.zIndex},grouping:{type:Boolean,default:messageDefaults.grouping},repeatNum:{type:Number,default:messageDefaults.repeatNum}}),messageEmits={destroy:()=>!0},instances=shallowReactive([]),getInstance=t=>{const r=instances.findIndex(g=>g.id===t),e=instances[r];let n;return r>0&&(n=instances[r-1]),{current:e,prev:n}},getLastOffset=t=>{const{prev:r}=getInstance(t);return r?r.vm.exposed.bottom.value:0},getOffsetOrSpace=(t,r)=>instances.findIndex(n=>n.id===t)>0?20:r,_hoisted_1$b=["id"],_hoisted_2$6=["innerHTML"],__default__=defineComponent({name:"ElMessage"}),_sfc_main$g=defineComponent({...__default__,props:messageProps,emits:messageEmits,setup(t,{expose:r}){const e=t,{Close:n}=TypeComponents,{ns:g,zIndex:y}=useGlobalComponentSettings("message"),{currentZIndex:i,nextZIndex:k}=y,L=ref(),$=ref(!1),V=ref(0);let z;const re=computed(()=>e.type?e.type==="error"?"danger":e.type:"info"),oe=computed(()=>{const jt=e.type;return{[g.bm("icon",jt)]:jt&&TypeComponentsMap[jt]}}),le=computed(()=>e.icon||TypeComponentsMap[e.type]||""),ue=computed(()=>getLastOffset(e.id)),ie=computed(()=>getOffsetOrSpace(e.id,e.offset)+ue.value),ae=computed(()=>V.value+ie.value),Ie=computed(()=>({top:`${ie.value}px`,zIndex:i.value}));function de(){e.duration!==0&&({stop:z}=useTimeoutFn(()=>{Ue()},e.duration))}function Ce(){z==null||z()}function Ue(){$.value=!1}function qe({code:jt}){jt===EVENT_CODE.esc&&Ue()}return onMounted(()=>{de(),k(),$.value=!0}),watch(()=>e.repeatNum,()=>{Ce(),de()}),useEventListener(document,"keydown",qe),useResizeObserver(L,()=>{V.value=L.value.getBoundingClientRect().height}),r({visible:$,bottom:ae,close:Ue}),(jt,Fe)=>(openBlock(),createBlock(Transition,{name:unref(g).b("fade"),onBeforeLeave:jt.onClose,onAfterLeave:Fe[0]||(Fe[0]=Et=>jt.$emit("destroy")),persisted:""},{default:withCtx(()=>[withDirectives(createBaseVNode("div",{id:jt.id,ref_key:"messageRef",ref:L,class:normalizeClass([unref(g).b(),{[unref(g).m(jt.type)]:jt.type},unref(g).is("center",jt.center),unref(g).is("closable",jt.showClose),jt.customClass]),style:normalizeStyle(unref(Ie)),role:"alert",onMouseenter:Ce,onMouseleave:de},[jt.repeatNum>1?(openBlock(),createBlock(unref(ElBadge),{key:0,value:jt.repeatNum,type:unref(re),class:normalizeClass(unref(g).e("badge"))},null,8,["value","type","class"])):createCommentVNode("v-if",!0),unref(le)?(openBlock(),createBlock(unref(ElIcon),{key:1,class:normalizeClass([unref(g).e("icon"),unref(oe)])},{default:withCtx(()=>[(openBlock(),createBlock(resolveDynamicComponent(unref(le))))]),_:1},8,["class"])):createCommentVNode("v-if",!0),renderSlot(jt.$slots,"default",{},()=>[jt.dangerouslyUseHTMLString?(openBlock(),createElementBlock(Fragment,{key:1},[createCommentVNode(" Caution here, message could've been compromised, never use user's input as message "),createBaseVNode("p",{class:normalizeClass(unref(g).e("content")),innerHTML:jt.message},null,10,_hoisted_2$6)],2112)):(openBlock(),createElementBlock("p",{key:0,class:normalizeClass(unref(g).e("content"))},toDisplayString(jt.message),3))]),jt.showClose?(openBlock(),createBlock(unref(ElIcon),{key:2,class:normalizeClass(unref(g).e("closeBtn")),onClick:withModifiers(Ue,["stop"])},{default:withCtx(()=>[createVNode(unref(n))]),_:1},8,["class","onClick"])):createCommentVNode("v-if",!0)],46,_hoisted_1$b),[[vShow,$.value]])]),_:3},8,["name","onBeforeLeave"]))}});var MessageConstructor=_export_sfc$1(_sfc_main$g,[["__file","message.vue"]]);let seed=1;const normalizeOptions=t=>{const r=!t||isString$2(t)||isVNode(t)||isFunction$3(t)?{message:t}:t,e={...messageDefaults,...r};if(!e.appendTo)e.appendTo=document.body;else if(isString$2(e.appendTo)){let n=document.querySelector(e.appendTo);isElement(n)||(n=document.body),e.appendTo=n}return e},closeMessage=t=>{const r=instances.indexOf(t);if(r===-1)return;instances.splice(r,1);const{handler:e}=t;e.close()},createMessage=({appendTo:t,...r},e)=>{const n=`message_${seed++}`,g=r.onClose,y=document.createElement("div"),i={...r,id:n,onClose:()=>{g==null||g(),closeMessage(V)},onDestroy:()=>{render(null,y)}},k=createVNode(MessageConstructor,i,isFunction$3(i.message)||isVNode(i.message)?{default:isFunction$3(i.message)?i.message:()=>i.message}:null);k.appContext=e||message._context,render(k,y),t.appendChild(y.firstElementChild);const L=k.component,V={id:n,vnode:k,vm:L,handler:{close:()=>{L.exposed.visible.value=!1}},props:k.component.props};return V},message=(t={},r)=>{if(!isClient)return{close:()=>{}};if(isNumber$1(messageConfig.max)&&instances.length>=messageConfig.max)return{close:()=>{}};const e=normalizeOptions(t);if(e.grouping&&instances.length){const g=instances.find(({vnode:y})=>{var i;return((i=y.props)==null?void 0:i.message)===e.message});if(g)return g.props.repeatNum+=1,g.props.type=e.type,g.handler}const n=createMessage(e,r);return instances.push(n),n.handler};messageTypes.forEach(t=>{message[t]=(r={},e)=>{const n=normalizeOptions(r);return message({...n,type:t},e)}});function closeAll(t){for(const r of instances)(!t||t===r.props.type)&&r.handler.close()}message.closeAll=closeAll;message._context=null;const ElMessage=withInstallFunction(message,"$message"),_sfc_main$f=defineComponent({name:"ElMessageBox",directives:{TrapFocus},components:{ElButton,ElFocusTrap,ElInput,ElOverlay,ElIcon,...TypeComponents},inheritAttrs:!1,props:{buttonSize:{type:String,validator:isValidComponentSize},modal:{type:Boolean,default:!0},lockScroll:{type:Boolean,default:!0},showClose:{type:Boolean,default:!0},closeOnClickModal:{type:Boolean,default:!0},closeOnPressEscape:{type:Boolean,default:!0},closeOnHashChange:{type:Boolean,default:!0},center:Boolean,draggable:Boolean,overflow:Boolean,roundButton:{default:!1,type:Boolean},container:{type:String,default:"body"},boxType:{type:String,default:""}},emits:["vanish","action"],setup(t,{emit:r}){const{locale:e,zIndex:n,ns:g,size:y}=useGlobalComponentSettings("message-box",computed(()=>t.buttonSize)),{t:i}=e,{nextZIndex:k}=n,L=ref(!1),$=reactive({autofocus:!0,beforeClose:null,callback:null,cancelButtonText:"",cancelButtonClass:"",confirmButtonText:"",confirmButtonClass:"",customClass:"",customStyle:{},dangerouslyUseHTMLString:!1,distinguishCancelAndClose:!1,icon:"",inputPattern:null,inputPlaceholder:"",inputType:"text",inputValue:null,inputValidator:null,inputErrorMessage:"",message:null,modalFade:!0,modalClass:"",showCancelButton:!1,showConfirmButton:!0,type:"",title:void 0,showInput:!1,action:"",confirmButtonLoading:!1,cancelButtonLoading:!1,confirmButtonDisabled:!1,editorErrorMessage:"",validateError:!1,zIndex:k()}),V=computed(()=>{const ur=$.type;return{[g.bm("icon",ur)]:ur&&TypeComponentsMap[ur]}}),z=useId(),re=useId(),oe=computed(()=>$.icon||TypeComponentsMap[$.type]||""),le=computed(()=>!!$.message),ue=ref(),ie=ref(),ae=ref(),Ie=ref(),de=ref(),Ce=computed(()=>$.confirmButtonClass);watch(()=>$.inputValue,async ur=>{await nextTick(),t.boxType==="prompt"&&ur!==null&&nr()},{immediate:!0}),watch(()=>L.value,ur=>{var or,fr;ur&&(t.boxType!=="prompt"&&($.autofocus?ae.value=(fr=(or=de.value)==null?void 0:or.$el)!=null?fr:ue.value:ae.value=ue.value),$.zIndex=k()),t.boxType==="prompt"&&(ur?nextTick().then(()=>{var lr;Ie.value&&Ie.value.$el&&($.autofocus?ae.value=(lr=dr())!=null?lr:ue.value:ae.value=ue.value)}):($.editorErrorMessage="",$.validateError=!1))});const Ue=computed(()=>t.draggable),qe=computed(()=>t.overflow);useDraggable(ue,ie,Ue,qe),onMounted(async()=>{await nextTick(),t.closeOnHashChange&&window.addEventListener("hashchange",jt)}),onBeforeUnmount(()=>{t.closeOnHashChange&&window.removeEventListener("hashchange",jt)});function jt(){L.value&&(L.value=!1,nextTick(()=>{$.action&&r("action",$.action)}))}const Fe=()=>{t.closeOnClickModal&&er($.distinguishCancelAndClose?"close":"cancel")},Et=useSameTarget(Fe),cr=ur=>{if($.inputType!=="textarea")return ur.preventDefault(),er("confirm")},er=ur=>{var or;t.boxType==="prompt"&&ur==="confirm"&&!nr()||($.action=ur,$.beforeClose?(or=$.beforeClose)==null||or.call($,ur,$,jt):jt())},nr=()=>{if(t.boxType==="prompt"){const ur=$.inputPattern;if(ur&&!ur.test($.inputValue||""))return $.editorErrorMessage=$.inputErrorMessage||i("el.messagebox.error"),$.validateError=!0,!1;const or=$.inputValidator;if(typeof or=="function"){const fr=or($.inputValue);if(fr===!1)return $.editorErrorMessage=$.inputErrorMessage||i("el.messagebox.error"),$.validateError=!0,!1;if(typeof fr=="string")return $.editorErrorMessage=fr,$.validateError=!0,!1}}return $.editorErrorMessage="",$.validateError=!1,!0},dr=()=>{const ur=Ie.value.$refs;return ur.input||ur.textarea},ir=()=>{er("close")},tr=()=>{t.closeOnPressEscape&&ir()};return t.lockScroll&&useLockscreen(L),{...toRefs($),ns:g,overlayEvent:Et,visible:L,hasMessage:le,typeClass:V,contentId:z,inputId:re,btnSize:y,iconComponent:oe,confirmButtonClasses:Ce,rootRef:ue,focusStartRef:ae,headerRef:ie,inputRef:Ie,confirmRef:de,doClose:jt,handleClose:ir,onCloseRequested:tr,handleWrapperClick:Fe,handleInputEnter:cr,handleAction:er,t:i}}}),_hoisted_1$a=["aria-label","aria-describedby"],_hoisted_2$5=["aria-label"],_hoisted_3$5=["id"];function _sfc_render(t,r,e,n,g,y){const i=resolveComponent("el-icon"),k=resolveComponent("close"),L=resolveComponent("el-input"),$=resolveComponent("el-button"),V=resolveComponent("el-focus-trap"),z=resolveComponent("el-overlay");return openBlock(),createBlock(Transition,{name:"fade-in-linear",onAfterLeave:r[11]||(r[11]=re=>t.$emit("vanish")),persisted:""},{default:withCtx(()=>[withDirectives(createVNode(z,{"z-index":t.zIndex,"overlay-class":[t.ns.is("message-box"),t.modalClass],mask:t.modal},{default:withCtx(()=>[createBaseVNode("div",{role:"dialog","aria-label":t.title,"aria-modal":"true","aria-describedby":t.showInput?void 0:t.contentId,class:normalizeClass(`${t.ns.namespace.value}-overlay-message-box`),onClick:r[8]||(r[8]=(...re)=>t.overlayEvent.onClick&&t.overlayEvent.onClick(...re)),onMousedown:r[9]||(r[9]=(...re)=>t.overlayEvent.onMousedown&&t.overlayEvent.onMousedown(...re)),onMouseup:r[10]||(r[10]=(...re)=>t.overlayEvent.onMouseup&&t.overlayEvent.onMouseup(...re))},[createVNode(V,{loop:"",trapped:t.visible,"focus-trap-el":t.rootRef,"focus-start-el":t.focusStartRef,onReleaseRequested:t.onCloseRequested},{default:withCtx(()=>[createBaseVNode("div",{ref:"rootRef",class:normalizeClass([t.ns.b(),t.customClass,t.ns.is("draggable",t.draggable),{[t.ns.m("center")]:t.center}]),style:normalizeStyle(t.customStyle),tabindex:"-1",onClick:r[7]||(r[7]=withModifiers(()=>{},["stop"]))},[t.title!==null&&t.title!==void 0?(openBlock(),createElementBlock("div",{key:0,ref:"headerRef",class:normalizeClass([t.ns.e("header"),{"show-close":t.showClose}])},[createBaseVNode("div",{class:normalizeClass(t.ns.e("title"))},[t.iconComponent&&t.center?(openBlock(),createBlock(i,{key:0,class:normalizeClass([t.ns.e("status"),t.typeClass])},{default:withCtx(()=>[(openBlock(),createBlock(resolveDynamicComponent(t.iconComponent)))]),_:1},8,["class"])):createCommentVNode("v-if",!0),createBaseVNode("span",null,toDisplayString(t.title),1)],2),t.showClose?(openBlock(),createElementBlock("button",{key:0,type:"button",class:normalizeClass(t.ns.e("headerbtn")),"aria-label":t.t("el.messagebox.close"),onClick:r[0]||(r[0]=re=>t.handleAction(t.distinguishCancelAndClose?"close":"cancel")),onKeydown:r[1]||(r[1]=withKeys(withModifiers(re=>t.handleAction(t.distinguishCancelAndClose?"close":"cancel"),["prevent"]),["enter"]))},[createVNode(i,{class:normalizeClass(t.ns.e("close"))},{default:withCtx(()=>[createVNode(k)]),_:1},8,["class"])],42,_hoisted_2$5)):createCommentVNode("v-if",!0)],2)):createCommentVNode("v-if",!0),createBaseVNode("div",{id:t.contentId,class:normalizeClass(t.ns.e("content"))},[createBaseVNode("div",{class:normalizeClass(t.ns.e("container"))},[t.iconComponent&&!t.center&&t.hasMessage?(openBlock(),createBlock(i,{key:0,class:normalizeClass([t.ns.e("status"),t.typeClass])},{default:withCtx(()=>[(openBlock(),createBlock(resolveDynamicComponent(t.iconComponent)))]),_:1},8,["class"])):createCommentVNode("v-if",!0),t.hasMessage?(openBlock(),createElementBlock("div",{key:1,class:normalizeClass(t.ns.e("message"))},[renderSlot(t.$slots,"default",{},()=>[t.dangerouslyUseHTMLString?(openBlock(),createBlock(resolveDynamicComponent(t.showInput?"label":"p"),{key:1,for:t.showInput?t.inputId:void 0,innerHTML:t.message},null,8,["for","innerHTML"])):(openBlock(),createBlock(resolveDynamicComponent(t.showInput?"label":"p"),{key:0,for:t.showInput?t.inputId:void 0},{default:withCtx(()=>[createTextVNode(toDisplayString(t.dangerouslyUseHTMLString?"":t.message),1)]),_:1},8,["for"]))])],2)):createCommentVNode("v-if",!0)],2),withDirectives(createBaseVNode("div",{class:normalizeClass(t.ns.e("input"))},[createVNode(L,{id:t.inputId,ref:"inputRef",modelValue:t.inputValue,"onUpdate:modelValue":r[2]||(r[2]=re=>t.inputValue=re),type:t.inputType,placeholder:t.inputPlaceholder,"aria-invalid":t.validateError,class:normalizeClass({invalid:t.validateError}),onKeydown:withKeys(t.handleInputEnter,["enter"])},null,8,["id","modelValue","type","placeholder","aria-invalid","class","onKeydown"]),createBaseVNode("div",{class:normalizeClass(t.ns.e("errormsg")),style:normalizeStyle({visibility:t.editorErrorMessage?"visible":"hidden"})},toDisplayString(t.editorErrorMessage),7)],2),[[vShow,t.showInput]])],10,_hoisted_3$5),createBaseVNode("div",{class:normalizeClass(t.ns.e("btns"))},[t.showCancelButton?(openBlock(),createBlock($,{key:0,loading:t.cancelButtonLoading,class:normalizeClass([t.cancelButtonClass]),round:t.roundButton,size:t.btnSize,onClick:r[3]||(r[3]=re=>t.handleAction("cancel")),onKeydown:r[4]||(r[4]=withKeys(withModifiers(re=>t.handleAction("cancel"),["prevent"]),["enter"]))},{default:withCtx(()=>[createTextVNode(toDisplayString(t.cancelButtonText||t.t("el.messagebox.cancel")),1)]),_:1},8,["loading","class","round","size"])):createCommentVNode("v-if",!0),withDirectives(createVNode($,{ref:"confirmRef",type:"primary",loading:t.confirmButtonLoading,class:normalizeClass([t.confirmButtonClasses]),round:t.roundButton,disabled:t.confirmButtonDisabled,size:t.btnSize,onClick:r[5]||(r[5]=re=>t.handleAction("confirm")),onKeydown:r[6]||(r[6]=withKeys(withModifiers(re=>t.handleAction("confirm"),["prevent"]),["enter"]))},{default:withCtx(()=>[createTextVNode(toDisplayString(t.confirmButtonText||t.t("el.messagebox.confirm")),1)]),_:1},8,["loading","class","round","disabled","size"]),[[vShow,t.showConfirmButton]])],2)],6)]),_:3},8,["trapped","focus-trap-el","focus-start-el","onReleaseRequested"])],42,_hoisted_1$a)]),_:3},8,["z-index","overlay-class","mask"]),[[vShow,t.visible]])]),_:3})}var MessageBoxConstructor=_export_sfc$1(_sfc_main$f,[["render",_sfc_render],["__file","index.vue"]]);const messageInstance=new Map,getAppendToElement=t=>{let r=document.body;return t.appendTo&&(isString$2(t.appendTo)&&(r=document.querySelector(t.appendTo)),isElement(t.appendTo)&&(r=t.appendTo),isElement(r)||(r=document.body)),r},initInstance=(t,r,e=null)=>{const n=createVNode(MessageBoxConstructor,t,isFunction$3(t.message)||isVNode(t.message)?{default:isFunction$3(t.message)?t.message:()=>t.message}:null);return n.appContext=e,render(n,r),getAppendToElement(t).appendChild(r.firstElementChild),n.component},genContainer=()=>document.createElement("div"),showMessage=(t,r)=>{const e=genContainer();t.onVanish=()=>{render(null,e),messageInstance.delete(g)},t.onAction=y=>{const i=messageInstance.get(g);let k;t.showInput?k={value:g.inputValue,action:y}:k=y,t.callback?t.callback(k,n.proxy):y==="cancel"||y==="close"?t.distinguishCancelAndClose&&y!=="cancel"?i.reject("close"):i.reject("cancel"):i.resolve(k)};const n=initInstance(t,e,r),g=n.proxy;for(const y in t)hasOwn(t,y)&&!hasOwn(g.$props,y)&&(g[y]=t[y]);return g.visible=!0,g};function MessageBox(t,r=null){if(!isClient)return Promise.reject();let e;return isString$2(t)||isVNode(t)?t={message:t}:e=t.callback,new Promise((n,g)=>{const y=showMessage(t,r??MessageBox._context);messageInstance.set(y,{options:t,callback:e,resolve:n,reject:g})})}const MESSAGE_BOX_VARIANTS=["alert","confirm","prompt"],MESSAGE_BOX_DEFAULT_OPTS={alert:{closeOnPressEscape:!1,closeOnClickModal:!1},confirm:{showCancelButton:!0},prompt:{showCancelButton:!0,showInput:!0}};MESSAGE_BOX_VARIANTS.forEach(t=>{MessageBox[t]=messageBoxFactory(t)});function messageBoxFactory(t){return(r,e,n,g)=>{let y="";return isObject$2(e)?(n=e,y=""):isUndefined$1(e)?y="":y=e,MessageBox(Object.assign({title:y,message:r,type:"",...MESSAGE_BOX_DEFAULT_OPTS[t]},n,{boxType:t}),g)}}MessageBox.close=()=>{messageInstance.forEach((t,r)=>{r.doClose()}),messageInstance.clear()};MessageBox._context=null;const _MessageBox=MessageBox;_MessageBox.install=t=>{_MessageBox._context=t._context,t.config.globalProperties.$msgbox=_MessageBox,t.config.globalProperties.$messageBox=_MessageBox,t.config.globalProperties.$alert=_MessageBox.alert,t.config.globalProperties.$confirm=_MessageBox.confirm,t.config.globalProperties.$prompt=_MessageBox.prompt};const ElMessageBox=_MessageBox,base="",elContainer="",elAside="",elFooter="",elHeader="",elMain="",elCard="",elScrollbar="",elMenu="",elTooltip="",elPopper="",elSubMenu="",elMenuItem="",elIcon="",elImage="",elImageViewer="",elDivider="",elRow="",elCol="",_imports_0=""+new URL("rocket.gif",import.meta.url).href,_imports_1=""+new URL("rocket.png",import.meta.url).href,logApi=()=>({add:y=>{try{var i=localStorage.getItem("localLog"),k;return i?k=JSON.parse(i):k=new Array,y.type=="link"&&(y.color="#409eff"),k.push(y),localStorage.setItem("localLog",JSON.stringify(k)),!0}catch{return!1}},addRange:y=>{try{var i=localStorage.getItem("localLog"),k;return i?k=JSON.parse(i):k=new Array,y.forEach(L=>k.push(L)),localStorage.setItem("localLog",JSON.stringify(k)),!0}catch{return!1}},getLogs:()=>{try{var y=localStorage.getItem("localLog"),i;if(y)i=JSON.parse(y);else return;return i}catch{return}},addSystem:y=>{try{var i=localStorage.getItem("localLog"),k;return i?k=JSON.parse(i):k=new Array,k.push({type:"system",time:new Date().toLocaleString(),content:y}),localStorage.setItem("localLog",JSON.stringify(k)),!0}catch{return!1}},clearLog:()=>{localStorage.removeItem("localLog")}});function bind(t,r){return function(){return t.apply(r,arguments)}}const{toString}=Object.prototype,{getPrototypeOf}=Object,kindOf=(t=>r=>{const e=toString.call(r);return t[e]||(t[e]=e.slice(8,-1).toLowerCase())})(Object.create(null)),kindOfTest=t=>(t=t.toLowerCase(),r=>kindOf(r)===t),typeOfTest=t=>r=>typeof r===t,{isArray}=Array,isUndefined=typeOfTest("undefined");function isBuffer(t){return t!==null&&!isUndefined(t)&&t.constructor!==null&&!isUndefined(t.constructor)&&isFunction(t.constructor.isBuffer)&&t.constructor.isBuffer(t)}const isArrayBuffer=kindOfTest("ArrayBuffer");function isArrayBufferView(t){let r;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?r=ArrayBuffer.isView(t):r=t&&t.buffer&&isArrayBuffer(t.buffer),r}const isString=typeOfTest("string"),isFunction=typeOfTest("function"),isNumber=typeOfTest("number"),isObject=t=>t!==null&&typeof t=="object",isBoolean=t=>t===!0||t===!1,isPlainObject=t=>{if(kindOf(t)!=="object")return!1;const r=getPrototypeOf(t);return(r===null||r===Object.prototype||Object.getPrototypeOf(r)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)},isDate=kindOfTest("Date"),isFile=kindOfTest("File"),isBlob=kindOfTest("Blob"),isFileList=kindOfTest("FileList"),isStream=t=>isObject(t)&&isFunction(t.pipe),isFormData=t=>{let r;return t&&(typeof FormData=="function"&&t instanceof FormData||isFunction(t.append)&&((r=kindOf(t))==="formdata"||r==="object"&&isFunction(t.toString)&&t.toString()==="[object FormData]"))},isURLSearchParams=kindOfTest("URLSearchParams"),trim=t=>t.trim?t.trim():t.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function forEach(t,r,{allOwnKeys:e=!1}={}){if(t===null||typeof t>"u")return;let n,g;if(typeof t!="object"&&(t=[t]),isArray(t))for(n=0,g=t.length;n<g;n++)r.call(null,t[n],n,t);else{const y=e?Object.getOwnPropertyNames(t):Object.keys(t),i=y.length;let k;for(n=0;n<i;n++)k=y[n],r.call(null,t[k],k,t)}}function findKey(t,r){r=r.toLowerCase();const e=Object.keys(t);let n=e.length,g;for(;n-- >0;)if(g=e[n],r===g.toLowerCase())return g;return null}const _global=(()=>typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global)(),isContextDefined=t=>!isUndefined(t)&&t!==_global;function merge(){const{caseless:t}=isContextDefined(this)&&this||{},r={},e=(n,g)=>{const y=t&&findKey(r,g)||g;isPlainObject(r[y])&&isPlainObject(n)?r[y]=merge(r[y],n):isPlainObject(n)?r[y]=merge({},n):isArray(n)?r[y]=n.slice():r[y]=n};for(let n=0,g=arguments.length;n<g;n++)arguments[n]&&forEach(arguments[n],e);return r}const extend=(t,r,e,{allOwnKeys:n}={})=>(forEach(r,(g,y)=>{e&&isFunction(g)?t[y]=bind(g,e):t[y]=g},{allOwnKeys:n}),t),stripBOM=t=>(t.charCodeAt(0)===65279&&(t=t.slice(1)),t),inherits=(t,r,e,n)=>{t.prototype=Object.create(r.prototype,n),t.prototype.constructor=t,Object.defineProperty(t,"super",{value:r.prototype}),e&&Object.assign(t.prototype,e)},toFlatObject=(t,r,e,n)=>{let g,y,i;const k={};if(r=r||{},t==null)return r;do{for(g=Object.getOwnPropertyNames(t),y=g.length;y-- >0;)i=g[y],(!n||n(i,t,r))&&!k[i]&&(r[i]=t[i],k[i]=!0);t=e!==!1&&getPrototypeOf(t)}while(t&&(!e||e(t,r))&&t!==Object.prototype);return r},endsWith=(t,r,e)=>{t=String(t),(e===void 0||e>t.length)&&(e=t.length),e-=r.length;const n=t.indexOf(r,e);return n!==-1&&n===e},toArray=t=>{if(!t)return null;if(isArray(t))return t;let r=t.length;if(!isNumber(r))return null;const e=new Array(r);for(;r-- >0;)e[r]=t[r];return e},isTypedArray=(t=>r=>t&&r instanceof t)(typeof Uint8Array<"u"&&getPrototypeOf(Uint8Array)),forEachEntry=(t,r)=>{const n=(t&&t[Symbol.iterator]).call(t);let g;for(;(g=n.next())&&!g.done;){const y=g.value;r.call(t,y[0],y[1])}},matchAll=(t,r)=>{let e;const n=[];for(;(e=t.exec(r))!==null;)n.push(e);return n},isHTMLForm=kindOfTest("HTMLFormElement"),toCamelCase=t=>t.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(e,n,g){return n.toUpperCase()+g}),hasOwnProperty=(({hasOwnProperty:t})=>(r,e)=>t.call(r,e))(Object.prototype),isRegExp=kindOfTest("RegExp"),reduceDescriptors=(t,r)=>{const e=Object.getOwnPropertyDescriptors(t),n={};forEach(e,(g,y)=>{let i;(i=r(g,y,t))!==!1&&(n[y]=i||g)}),Object.defineProperties(t,n)},freezeMethods=t=>{reduceDescriptors(t,(r,e)=>{if(isFunction(t)&&["arguments","caller","callee"].indexOf(e)!==-1)return!1;const n=t[e];if(isFunction(n)){if(r.enumerable=!1,"writable"in r){r.writable=!1;return}r.set||(r.set=()=>{throw Error("Can not rewrite read-only method '"+e+"'")})}})},toObjectSet=(t,r)=>{const e={},n=g=>{g.forEach(y=>{e[y]=!0})};return isArray(t)?n(t):n(String(t).split(r)),e},noop=()=>{},toFiniteNumber=(t,r)=>(t=+t,Number.isFinite(t)?t:r),ALPHA="abcdefghijklmnopqrstuvwxyz",DIGIT="0123456789",ALPHABET={DIGIT,ALPHA,ALPHA_DIGIT:ALPHA+ALPHA.toUpperCase()+DIGIT},generateString=(t=16,r=ALPHABET.ALPHA_DIGIT)=>{let e="";const{length:n}=r;for(;t--;)e+=r[Math.random()*n|0];return e};function isSpecCompliantForm(t){return!!(t&&isFunction(t.append)&&t[Symbol.toStringTag]==="FormData"&&t[Symbol.iterator])}const toJSONObject=t=>{const r=new Array(10),e=(n,g)=>{if(isObject(n)){if(r.indexOf(n)>=0)return;if(!("toJSON"in n)){r[g]=n;const y=isArray(n)?[]:{};return forEach(n,(i,k)=>{const L=e(i,g+1);!isUndefined(L)&&(y[k]=L)}),r[g]=void 0,y}}return n};return e(t,0)},isAsyncFn=kindOfTest("AsyncFunction"),isThenable=t=>t&&(isObject(t)||isFunction(t))&&isFunction(t.then)&&isFunction(t.catch),utils$1={isArray,isArrayBuffer,isBuffer,isFormData,isArrayBufferView,isString,isNumber,isBoolean,isObject,isPlainObject,isUndefined,isDate,isFile,isBlob,isRegExp,isFunction,isStream,isURLSearchParams,isTypedArray,isFileList,forEach,merge,extend,trim,stripBOM,inherits,toFlatObject,kindOf,kindOfTest,endsWith,toArray,forEachEntry,matchAll,isHTMLForm,hasOwnProperty,hasOwnProp:hasOwnProperty,reduceDescriptors,freezeMethods,toObjectSet,toCamelCase,noop,toFiniteNumber,findKey,global:_global,isContextDefined,ALPHABET,generateString,isSpecCompliantForm,toJSONObject,isAsyncFn,isThenable};function AxiosError(t,r,e,n,g){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=t,this.name="AxiosError",r&&(this.code=r),e&&(this.config=e),n&&(this.request=n),g&&(this.response=g)}utils$1.inherits(AxiosError,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:utils$1.toJSONObject(this.config),code:this.code,status:this.response&&this.response.status?this.response.status:null}}});const prototype$1=AxiosError.prototype,descriptors={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(t=>{descriptors[t]={value:t}});Object.defineProperties(AxiosError,descriptors);Object.defineProperty(prototype$1,"isAxiosError",{value:!0});AxiosError.from=(t,r,e,n,g,y)=>{const i=Object.create(prototype$1);return utils$1.toFlatObject(t,i,function(L){return L!==Error.prototype},k=>k!=="isAxiosError"),AxiosError.call(i,t.message,r,e,n,g),i.cause=t,i.name=t.name,y&&Object.assign(i,y),i};const httpAdapter=null;function isVisitable(t){return utils$1.isPlainObject(t)||utils$1.isArray(t)}function removeBrackets(t){return utils$1.endsWith(t,"[]")?t.slice(0,-2):t}function renderKey(t,r,e){return t?t.concat(r).map(function(g,y){return g=removeBrackets(g),!e&&y?"["+g+"]":g}).join(e?".":""):r}function isFlatArray(t){return utils$1.isArray(t)&&!t.some(isVisitable)}const predicates=utils$1.toFlatObject(utils$1,{},null,function(r){return/^is[A-Z]/.test(r)});function toFormData(t,r,e){if(!utils$1.isObject(t))throw new TypeError("target must be an object");r=r||new FormData,e=utils$1.toFlatObject(e,{metaTokens:!0,dots:!1,indexes:!1},!1,function(ue,ie){return!utils$1.isUndefined(ie[ue])});const n=e.metaTokens,g=e.visitor||V,y=e.dots,i=e.indexes,L=(e.Blob||typeof Blob<"u"&&Blob)&&utils$1.isSpecCompliantForm(r);if(!utils$1.isFunction(g))throw new TypeError("visitor must be a function");function $(le){if(le===null)return"";if(utils$1.isDate(le))return le.toISOString();if(!L&&utils$1.isBlob(le))throw new AxiosError("Blob is not supported. Use a Buffer instead.");return utils$1.isArrayBuffer(le)||utils$1.isTypedArray(le)?L&&typeof Blob=="function"?new Blob([le]):Buffer.from(le):le}function V(le,ue,ie){let ae=le;if(le&&!ie&&typeof le=="object"){if(utils$1.endsWith(ue,"{}"))ue=n?ue:ue.slice(0,-2),le=JSON.stringify(le);else if(utils$1.isArray(le)&&isFlatArray(le)||(utils$1.isFileList(le)||utils$1.endsWith(ue,"[]"))&&(ae=utils$1.toArray(le)))return ue=removeBrackets(ue),ae.forEach(function(de,Ce){!(utils$1.isUndefined(de)||de===null)&&r.append(i===!0?renderKey([ue],Ce,y):i===null?ue:ue+"[]",$(de))}),!1}return isVisitable(le)?!0:(r.append(renderKey(ie,ue,y),$(le)),!1)}const z=[],re=Object.assign(predicates,{defaultVisitor:V,convertValue:$,isVisitable});function oe(le,ue){if(!utils$1.isUndefined(le)){if(z.indexOf(le)!==-1)throw Error("Circular reference detected in "+ue.join("."));z.push(le),utils$1.forEach(le,function(ae,Ie){(!(utils$1.isUndefined(ae)||ae===null)&&g.call(r,ae,utils$1.isString(Ie)?Ie.trim():Ie,ue,re))===!0&&oe(ae,ue?ue.concat(Ie):[Ie])}),z.pop()}}if(!utils$1.isObject(t))throw new TypeError("data must be an object");return oe(t),r}function encode$1(t){const r={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(t).replace(/[!'()~]|%20|%00/g,function(n){return r[n]})}function AxiosURLSearchParams(t,r){this._pairs=[],t&&toFormData(t,this,r)}const prototype=AxiosURLSearchParams.prototype;prototype.append=function(r,e){this._pairs.push([r,e])};prototype.toString=function(r){const e=r?function(n){return r.call(this,n,encode$1)}:encode$1;return this._pairs.map(function(g){return e(g[0])+"="+e(g[1])},"").join("&")};function encode(t){return encodeURIComponent(t).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function buildURL(t,r,e){if(!r)return t;const n=e&&e.encode||encode,g=e&&e.serialize;let y;if(g?y=g(r,e):y=utils$1.isURLSearchParams(r)?r.toString():new AxiosURLSearchParams(r,e).toString(n),y){const i=t.indexOf("#");i!==-1&&(t=t.slice(0,i)),t+=(t.indexOf("?")===-1?"?":"&")+y}return t}class InterceptorManager{constructor(){this.handlers=[]}use(r,e,n){return this.handlers.push({fulfilled:r,rejected:e,synchronous:n?n.synchronous:!1,runWhen:n?n.runWhen:null}),this.handlers.length-1}eject(r){this.handlers[r]&&(this.handlers[r]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(r){utils$1.forEach(this.handlers,function(n){n!==null&&r(n)})}}const InterceptorManager$1=InterceptorManager,transitionalDefaults={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},URLSearchParams$1=typeof URLSearchParams<"u"?URLSearchParams:AxiosURLSearchParams,FormData$1=typeof FormData<"u"?FormData:null,Blob$1=typeof Blob<"u"?Blob:null,platform$1={isBrowser:!0,classes:{URLSearchParams:URLSearchParams$1,FormData:FormData$1,Blob:Blob$1},protocols:["http","https","file","blob","url","data"]},hasBrowserEnv=typeof window<"u"&&typeof document<"u",hasStandardBrowserEnv=(t=>hasBrowserEnv&&["ReactNative","NativeScript","NS"].indexOf(t)<0)(typeof navigator<"u"&&navigator.product),hasStandardBrowserWebWorkerEnv=(()=>typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function")(),utils=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv,hasStandardBrowserEnv,hasStandardBrowserWebWorkerEnv},Symbol.toStringTag,{value:"Module"})),platform={...utils,...platform$1};function toURLEncodedForm(t,r){return toFormData(t,new platform.classes.URLSearchParams,Object.assign({visitor:function(e,n,g,y){return platform.isNode&&utils$1.isBuffer(e)?(this.append(n,e.toString("base64")),!1):y.defaultVisitor.apply(this,arguments)}},r))}function parsePropPath(t){return utils$1.matchAll(/\w+|\[(\w*)]/g,t).map(r=>r[0]==="[]"?"":r[1]||r[0])}function arrayToObject(t){const r={},e=Object.keys(t);let n;const g=e.length;let y;for(n=0;n<g;n++)y=e[n],r[y]=t[y];return r}function formDataToJSON(t){function r(e,n,g,y){let i=e[y++];if(i==="__proto__")return!0;const k=Number.isFinite(+i),L=y>=e.length;return i=!i&&utils$1.isArray(g)?g.length:i,L?(utils$1.hasOwnProp(g,i)?g[i]=[g[i],n]:g[i]=n,!k):((!g[i]||!utils$1.isObject(g[i]))&&(g[i]=[]),r(e,n,g[i],y)&&utils$1.isArray(g[i])&&(g[i]=arrayToObject(g[i])),!k)}if(utils$1.isFormData(t)&&utils$1.isFunction(t.entries)){const e={};return utils$1.forEachEntry(t,(n,g)=>{r(parsePropPath(n),g,e,0)}),e}return null}function stringifySafely(t,r,e){if(utils$1.isString(t))try{return(r||JSON.parse)(t),utils$1.trim(t)}catch(n){if(n.name!=="SyntaxError")throw n}return(e||JSON.stringify)(t)}const defaults={transitional:transitionalDefaults,adapter:["xhr","http"],transformRequest:[function(r,e){const n=e.getContentType()||"",g=n.indexOf("application/json")>-1,y=utils$1.isObject(r);if(y&&utils$1.isHTMLForm(r)&&(r=new FormData(r)),utils$1.isFormData(r))return g?JSON.stringify(formDataToJSON(r)):r;if(utils$1.isArrayBuffer(r)||utils$1.isBuffer(r)||utils$1.isStream(r)||utils$1.isFile(r)||utils$1.isBlob(r))return r;if(utils$1.isArrayBufferView(r))return r.buffer;if(utils$1.isURLSearchParams(r))return e.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),r.toString();let k;if(y){if(n.indexOf("application/x-www-form-urlencoded")>-1)return toURLEncodedForm(r,this.formSerializer).toString();if((k=utils$1.isFileList(r))||n.indexOf("multipart/form-data")>-1){const L=this.env&&this.env.FormData;return toFormData(k?{"files[]":r}:r,L&&new L,this.formSerializer)}}return y||g?(e.setContentType("application/json",!1),stringifySafely(r)):r}],transformResponse:[function(r){const e=this.transitional||defaults.transitional,n=e&&e.forcedJSONParsing,g=this.responseType==="json";if(r&&utils$1.isString(r)&&(n&&!this.responseType||g)){const i=!(e&&e.silentJSONParsing)&&g;try{return JSON.parse(r)}catch(k){if(i)throw k.name==="SyntaxError"?AxiosError.from(k,AxiosError.ERR_BAD_RESPONSE,this,null,this.response):k}}return r}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:platform.classes.FormData,Blob:platform.classes.Blob},validateStatus:function(r){return r>=200&&r<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};utils$1.forEach(["delete","get","head","post","put","patch"],t=>{defaults.headers[t]={}});const defaults$1=defaults,ignoreDuplicateOf=utils$1.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),parseHeaders=t=>{const r={};let e,n,g;return t&&t.split(`
`).forEach(function(i){g=i.indexOf(":"),e=i.substring(0,g).trim().toLowerCase(),n=i.substring(g+1).trim(),!(!e||r[e]&&ignoreDuplicateOf[e])&&(e==="set-cookie"?r[e]?r[e].push(n):r[e]=[n]:r[e]=r[e]?r[e]+", "+n:n)}),r},$internals=Symbol("internals");function normalizeHeader(t){return t&&String(t).trim().toLowerCase()}function normalizeValue(t){return t===!1||t==null?t:utils$1.isArray(t)?t.map(normalizeValue):String(t)}function parseTokens(t){const r=Object.create(null),e=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let n;for(;n=e.exec(t);)r[n[1]]=n[2];return r}const isValidHeaderName=t=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(t.trim());function matchHeaderValue(t,r,e,n,g){if(utils$1.isFunction(n))return n.call(this,r,e);if(g&&(r=e),!!utils$1.isString(r)){if(utils$1.isString(n))return r.indexOf(n)!==-1;if(utils$1.isRegExp(n))return n.test(r)}}function formatHeader(t){return t.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(r,e,n)=>e.toUpperCase()+n)}function buildAccessors(t,r){const e=utils$1.toCamelCase(" "+r);["get","set","has"].forEach(n=>{Object.defineProperty(t,n+e,{value:function(g,y,i){return this[n].call(this,r,g,y,i)},configurable:!0})})}class AxiosHeaders{constructor(r){r&&this.set(r)}set(r,e,n){const g=this;function y(k,L,$){const V=normalizeHeader(L);if(!V)throw new Error("header name must be a non-empty string");const z=utils$1.findKey(g,V);(!z||g[z]===void 0||$===!0||$===void 0&&g[z]!==!1)&&(g[z||L]=normalizeValue(k))}const i=(k,L)=>utils$1.forEach(k,($,V)=>y($,V,L));return utils$1.isPlainObject(r)||r instanceof this.constructor?i(r,e):utils$1.isString(r)&&(r=r.trim())&&!isValidHeaderName(r)?i(parseHeaders(r),e):r!=null&&y(e,r,n),this}get(r,e){if(r=normalizeHeader(r),r){const n=utils$1.findKey(this,r);if(n){const g=this[n];if(!e)return g;if(e===!0)return parseTokens(g);if(utils$1.isFunction(e))return e.call(this,g,n);if(utils$1.isRegExp(e))return e.exec(g);throw new TypeError("parser must be boolean|regexp|function")}}}has(r,e){if(r=normalizeHeader(r),r){const n=utils$1.findKey(this,r);return!!(n&&this[n]!==void 0&&(!e||matchHeaderValue(this,this[n],n,e)))}return!1}delete(r,e){const n=this;let g=!1;function y(i){if(i=normalizeHeader(i),i){const k=utils$1.findKey(n,i);k&&(!e||matchHeaderValue(n,n[k],k,e))&&(delete n[k],g=!0)}}return utils$1.isArray(r)?r.forEach(y):y(r),g}clear(r){const e=Object.keys(this);let n=e.length,g=!1;for(;n--;){const y=e[n];(!r||matchHeaderValue(this,this[y],y,r,!0))&&(delete this[y],g=!0)}return g}normalize(r){const e=this,n={};return utils$1.forEach(this,(g,y)=>{const i=utils$1.findKey(n,y);if(i){e[i]=normalizeValue(g),delete e[y];return}const k=r?formatHeader(y):String(y).trim();k!==y&&delete e[y],e[k]=normalizeValue(g),n[k]=!0}),this}concat(...r){return this.constructor.concat(this,...r)}toJSON(r){const e=Object.create(null);return utils$1.forEach(this,(n,g)=>{n!=null&&n!==!1&&(e[g]=r&&utils$1.isArray(n)?n.join(", "):n)}),e}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([r,e])=>r+": "+e).join(`
`)}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(r){return r instanceof this?r:new this(r)}static concat(r,...e){const n=new this(r);return e.forEach(g=>n.set(g)),n}static accessor(r){const n=(this[$internals]=this[$internals]={accessors:{}}).accessors,g=this.prototype;function y(i){const k=normalizeHeader(i);n[k]||(buildAccessors(g,i),n[k]=!0)}return utils$1.isArray(r)?r.forEach(y):y(r),this}}AxiosHeaders.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);utils$1.reduceDescriptors(AxiosHeaders.prototype,({value:t},r)=>{let e=r[0].toUpperCase()+r.slice(1);return{get:()=>t,set(n){this[e]=n}}});utils$1.freezeMethods(AxiosHeaders);const AxiosHeaders$1=AxiosHeaders;function transformData(t,r){const e=this||defaults$1,n=r||e,g=AxiosHeaders$1.from(n.headers);let y=n.data;return utils$1.forEach(t,function(k){y=k.call(e,y,g.normalize(),r?r.status:void 0)}),g.normalize(),y}function isCancel(t){return!!(t&&t.__CANCEL__)}function CanceledError(t,r,e){AxiosError.call(this,t??"canceled",AxiosError.ERR_CANCELED,r,e),this.name="CanceledError"}utils$1.inherits(CanceledError,AxiosError,{__CANCEL__:!0});function settle(t,r,e){const n=e.config.validateStatus;!e.status||!n||n(e.status)?t(e):r(new AxiosError("Request failed with status code "+e.status,[AxiosError.ERR_BAD_REQUEST,AxiosError.ERR_BAD_RESPONSE][Math.floor(e.status/100)-4],e.config,e.request,e))}const cookies=platform.hasStandardBrowserEnv?{write(t,r,e,n,g,y){const i=[t+"="+encodeURIComponent(r)];utils$1.isNumber(e)&&i.push("expires="+new Date(e).toGMTString()),utils$1.isString(n)&&i.push("path="+n),utils$1.isString(g)&&i.push("domain="+g),y===!0&&i.push("secure"),document.cookie=i.join("; ")},read(t){const r=document.cookie.match(new RegExp("(^|;\\s*)("+t+")=([^;]*)"));return r?decodeURIComponent(r[3]):null},remove(t){this.write(t,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function isAbsoluteURL(t){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(t)}function combineURLs(t,r){return r?t.replace(/\/?\/$/,"")+"/"+r.replace(/^\/+/,""):t}function buildFullPath(t,r){return t&&!isAbsoluteURL(r)?combineURLs(t,r):r}const isURLSameOrigin=platform.hasStandardBrowserEnv?function(){const r=/(msie|trident)/i.test(navigator.userAgent),e=document.createElement("a");let n;function g(y){let i=y;return r&&(e.setAttribute("href",i),i=e.href),e.setAttribute("href",i),{href:e.href,protocol:e.protocol?e.protocol.replace(/:$/,""):"",host:e.host,search:e.search?e.search.replace(/^\?/,""):"",hash:e.hash?e.hash.replace(/^#/,""):"",hostname:e.hostname,port:e.port,pathname:e.pathname.charAt(0)==="/"?e.pathname:"/"+e.pathname}}return n=g(window.location.href),function(i){const k=utils$1.isString(i)?g(i):i;return k.protocol===n.protocol&&k.host===n.host}}():function(){return function(){return!0}}();function parseProtocol(t){const r=/^([-+\w]{1,25})(:?\/\/|:)/.exec(t);return r&&r[1]||""}function speedometer(t,r){t=t||10;const e=new Array(t),n=new Array(t);let g=0,y=0,i;return r=r!==void 0?r:1e3,function(L){const $=Date.now(),V=n[y];i||(i=$),e[g]=L,n[g]=$;let z=y,re=0;for(;z!==g;)re+=e[z++],z=z%t;if(g=(g+1)%t,g===y&&(y=(y+1)%t),$-i<r)return;const oe=V&&$-V;return oe?Math.round(re*1e3/oe):void 0}}function progressEventReducer(t,r){let e=0;const n=speedometer(50,250);return g=>{const y=g.loaded,i=g.lengthComputable?g.total:void 0,k=y-e,L=n(k),$=y<=i;e=y;const V={loaded:y,total:i,progress:i?y/i:void 0,bytes:k,rate:L||void 0,estimated:L&&i&&$?(i-y)/L:void 0,event:g};V[r?"download":"upload"]=!0,t(V)}}const isXHRAdapterSupported=typeof XMLHttpRequest<"u",xhrAdapter=isXHRAdapterSupported&&function(t){return new Promise(function(e,n){let g=t.data;const y=AxiosHeaders$1.from(t.headers).normalize();let{responseType:i,withXSRFToken:k}=t,L;function $(){t.cancelToken&&t.cancelToken.unsubscribe(L),t.signal&&t.signal.removeEventListener("abort",L)}let V;if(utils$1.isFormData(g)){if(platform.hasStandardBrowserEnv||platform.hasStandardBrowserWebWorkerEnv)y.setContentType(!1);else if((V=y.getContentType())!==!1){const[ue,...ie]=V?V.split(";").map(ae=>ae.trim()).filter(Boolean):[];y.setContentType([ue||"multipart/form-data",...ie].join("; "))}}let z=new XMLHttpRequest;if(t.auth){const ue=t.auth.username||"",ie=t.auth.password?unescape(encodeURIComponent(t.auth.password)):"";y.set("Authorization","Basic "+btoa(ue+":"+ie))}const re=buildFullPath(t.baseURL,t.url);z.open(t.method.toUpperCase(),buildURL(re,t.params,t.paramsSerializer),!0),z.timeout=t.timeout;function oe(){if(!z)return;const ue=AxiosHeaders$1.from("getAllResponseHeaders"in z&&z.getAllResponseHeaders()),ae={data:!i||i==="text"||i==="json"?z.responseText:z.response,status:z.status,statusText:z.statusText,headers:ue,config:t,request:z};settle(function(de){e(de),$()},function(de){n(de),$()},ae),z=null}if("onloadend"in z?z.onloadend=oe:z.onreadystatechange=function(){!z||z.readyState!==4||z.status===0&&!(z.responseURL&&z.responseURL.indexOf("file:")===0)||setTimeout(oe)},z.onabort=function(){z&&(n(new AxiosError("Request aborted",AxiosError.ECONNABORTED,t,z)),z=null)},z.onerror=function(){n(new AxiosError("Network Error",AxiosError.ERR_NETWORK,t,z)),z=null},z.ontimeout=function(){let ie=t.timeout?"timeout of "+t.timeout+"ms exceeded":"timeout exceeded";const ae=t.transitional||transitionalDefaults;t.timeoutErrorMessage&&(ie=t.timeoutErrorMessage),n(new AxiosError(ie,ae.clarifyTimeoutError?AxiosError.ETIMEDOUT:AxiosError.ECONNABORTED,t,z)),z=null},platform.hasStandardBrowserEnv&&(k&&utils$1.isFunction(k)&&(k=k(t)),k||k!==!1&&isURLSameOrigin(re))){const ue=t.xsrfHeaderName&&t.xsrfCookieName&&cookies.read(t.xsrfCookieName);ue&&y.set(t.xsrfHeaderName,ue)}g===void 0&&y.setContentType(null),"setRequestHeader"in z&&utils$1.forEach(y.toJSON(),function(ie,ae){z.setRequestHeader(ae,ie)}),utils$1.isUndefined(t.withCredentials)||(z.withCredentials=!!t.withCredentials),i&&i!=="json"&&(z.responseType=t.responseType),typeof t.onDownloadProgress=="function"&&z.addEventListener("progress",progressEventReducer(t.onDownloadProgress,!0)),typeof t.onUploadProgress=="function"&&z.upload&&z.upload.addEventListener("progress",progressEventReducer(t.onUploadProgress)),(t.cancelToken||t.signal)&&(L=ue=>{z&&(n(!ue||ue.type?new CanceledError(null,t,z):ue),z.abort(),z=null)},t.cancelToken&&t.cancelToken.subscribe(L),t.signal&&(t.signal.aborted?L():t.signal.addEventListener("abort",L)));const le=parseProtocol(re);if(le&&platform.protocols.indexOf(le)===-1){n(new AxiosError("Unsupported protocol "+le+":",AxiosError.ERR_BAD_REQUEST,t));return}z.send(g||null)})},knownAdapters={http:httpAdapter,xhr:xhrAdapter};utils$1.forEach(knownAdapters,(t,r)=>{if(t){try{Object.defineProperty(t,"name",{value:r})}catch{}Object.defineProperty(t,"adapterName",{value:r})}});const renderReason=t=>`- ${t}`,isResolvedHandle=t=>utils$1.isFunction(t)||t===null||t===!1,adapters={getAdapter:t=>{t=utils$1.isArray(t)?t:[t];const{length:r}=t;let e,n;const g={};for(let y=0;y<r;y++){e=t[y];let i;if(n=e,!isResolvedHandle(e)&&(n=knownAdapters[(i=String(e)).toLowerCase()],n===void 0))throw new AxiosError(`Unknown adapter '${i}'`);if(n)break;g[i||"#"+y]=n}if(!n){const y=Object.entries(g).map(([k,L])=>`adapter ${k} `+(L===!1?"is not supported by the environment":"is not available in the build"));let i=r?y.length>1?`since :
`+y.map(renderReason).join(`
`):" "+renderReason(y[0]):"as no adapter specified";throw new AxiosError("There is no suitable adapter to dispatch the request "+i,"ERR_NOT_SUPPORT")}return n},adapters:knownAdapters};function throwIfCancellationRequested(t){if(t.cancelToken&&t.cancelToken.throwIfRequested(),t.signal&&t.signal.aborted)throw new CanceledError(null,t)}function dispatchRequest(t){return throwIfCancellationRequested(t),t.headers=AxiosHeaders$1.from(t.headers),t.data=transformData.call(t,t.transformRequest),["post","put","patch"].indexOf(t.method)!==-1&&t.headers.setContentType("application/x-www-form-urlencoded",!1),adapters.getAdapter(t.adapter||defaults$1.adapter)(t).then(function(n){return throwIfCancellationRequested(t),n.data=transformData.call(t,t.transformResponse,n),n.headers=AxiosHeaders$1.from(n.headers),n},function(n){return isCancel(n)||(throwIfCancellationRequested(t),n&&n.response&&(n.response.data=transformData.call(t,t.transformResponse,n.response),n.response.headers=AxiosHeaders$1.from(n.response.headers))),Promise.reject(n)})}const headersToObject=t=>t instanceof AxiosHeaders$1?t.toJSON():t;function mergeConfig(t,r){r=r||{};const e={};function n($,V,z){return utils$1.isPlainObject($)&&utils$1.isPlainObject(V)?utils$1.merge.call({caseless:z},$,V):utils$1.isPlainObject(V)?utils$1.merge({},V):utils$1.isArray(V)?V.slice():V}function g($,V,z){if(utils$1.isUndefined(V)){if(!utils$1.isUndefined($))return n(void 0,$,z)}else return n($,V,z)}function y($,V){if(!utils$1.isUndefined(V))return n(void 0,V)}function i($,V){if(utils$1.isUndefined(V)){if(!utils$1.isUndefined($))return n(void 0,$)}else return n(void 0,V)}function k($,V,z){if(z in r)return n($,V);if(z in t)return n(void 0,$)}const L={url:y,method:y,data:y,baseURL:i,transformRequest:i,transformResponse:i,paramsSerializer:i,timeout:i,timeoutMessage:i,withCredentials:i,withXSRFToken:i,adapter:i,responseType:i,xsrfCookieName:i,xsrfHeaderName:i,onUploadProgress:i,onDownloadProgress:i,decompress:i,maxContentLength:i,maxBodyLength:i,beforeRedirect:i,transport:i,httpAgent:i,httpsAgent:i,cancelToken:i,socketPath:i,responseEncoding:i,validateStatus:k,headers:($,V)=>g(headersToObject($),headersToObject(V),!0)};return utils$1.forEach(Object.keys(Object.assign({},t,r)),function(V){const z=L[V]||g,re=z(t[V],r[V],V);utils$1.isUndefined(re)&&z!==k||(e[V]=re)}),e}const VERSION="1.6.7",validators$1={};["object","boolean","number","function","string","symbol"].forEach((t,r)=>{validators$1[t]=function(n){return typeof n===t||"a"+(r<1?"n ":" ")+t}});const deprecatedWarnings={};validators$1.transitional=function(r,e,n){function g(y,i){return"[Axios v"+VERSION+"] Transitional option '"+y+"'"+i+(n?". "+n:"")}return(y,i,k)=>{if(r===!1)throw new AxiosError(g(i," has been removed"+(e?" in "+e:"")),AxiosError.ERR_DEPRECATED);return e&&!deprecatedWarnings[i]&&(deprecatedWarnings[i]=!0,console.warn(g(i," has been deprecated since v"+e+" and will be removed in the near future"))),r?r(y,i,k):!0}};function assertOptions(t,r,e){if(typeof t!="object")throw new AxiosError("options must be an object",AxiosError.ERR_BAD_OPTION_VALUE);const n=Object.keys(t);let g=n.length;for(;g-- >0;){const y=n[g],i=r[y];if(i){const k=t[y],L=k===void 0||i(k,y,t);if(L!==!0)throw new AxiosError("option "+y+" must be "+L,AxiosError.ERR_BAD_OPTION_VALUE);continue}if(e!==!0)throw new AxiosError("Unknown option "+y,AxiosError.ERR_BAD_OPTION)}}const validator={assertOptions,validators:validators$1},validators=validator.validators;class Axios{constructor(r){this.defaults=r,this.interceptors={request:new InterceptorManager$1,response:new InterceptorManager$1}}async request(r,e){try{return await this._request(r,e)}catch(n){if(n instanceof Error){let g;Error.captureStackTrace?Error.captureStackTrace(g={}):g=new Error;const y=g.stack?g.stack.replace(/^.+\n/,""):"";n.stack?y&&!String(n.stack).endsWith(y.replace(/^.+\n.+\n/,""))&&(n.stack+=`
`+y):n.stack=y}throw n}}_request(r,e){typeof r=="string"?(e=e||{},e.url=r):e=r||{},e=mergeConfig(this.defaults,e);const{transitional:n,paramsSerializer:g,headers:y}=e;n!==void 0&&validator.assertOptions(n,{silentJSONParsing:validators.transitional(validators.boolean),forcedJSONParsing:validators.transitional(validators.boolean),clarifyTimeoutError:validators.transitional(validators.boolean)},!1),g!=null&&(utils$1.isFunction(g)?e.paramsSerializer={serialize:g}:validator.assertOptions(g,{encode:validators.function,serialize:validators.function},!0)),e.method=(e.method||this.defaults.method||"get").toLowerCase();let i=y&&utils$1.merge(y.common,y[e.method]);y&&utils$1.forEach(["delete","get","head","post","put","patch","common"],le=>{delete y[le]}),e.headers=AxiosHeaders$1.concat(i,y);const k=[];let L=!0;this.interceptors.request.forEach(function(ue){typeof ue.runWhen=="function"&&ue.runWhen(e)===!1||(L=L&&ue.synchronous,k.unshift(ue.fulfilled,ue.rejected))});const $=[];this.interceptors.response.forEach(function(ue){$.push(ue.fulfilled,ue.rejected)});let V,z=0,re;if(!L){const le=[dispatchRequest.bind(this),void 0];for(le.unshift.apply(le,k),le.push.apply(le,$),re=le.length,V=Promise.resolve(e);z<re;)V=V.then(le[z++],le[z++]);return V}re=k.length;let oe=e;for(z=0;z<re;){const le=k[z++],ue=k[z++];try{oe=le(oe)}catch(ie){ue.call(this,ie);break}}try{V=dispatchRequest.call(this,oe)}catch(le){return Promise.reject(le)}for(z=0,re=$.length;z<re;)V=V.then($[z++],$[z++]);return V}getUri(r){r=mergeConfig(this.defaults,r);const e=buildFullPath(r.baseURL,r.url);return buildURL(e,r.params,r.paramsSerializer)}}utils$1.forEach(["delete","get","head","options"],function(r){Axios.prototype[r]=function(e,n){return this.request(mergeConfig(n||{},{method:r,url:e,data:(n||{}).data}))}});utils$1.forEach(["post","put","patch"],function(r){function e(n){return function(y,i,k){return this.request(mergeConfig(k||{},{method:r,headers:n?{"Content-Type":"multipart/form-data"}:{},url:y,data:i}))}}Axios.prototype[r]=e(),Axios.prototype[r+"Form"]=e(!0)});const Axios$1=Axios;class CancelToken{constructor(r){if(typeof r!="function")throw new TypeError("executor must be a function.");let e;this.promise=new Promise(function(y){e=y});const n=this;this.promise.then(g=>{if(!n._listeners)return;let y=n._listeners.length;for(;y-- >0;)n._listeners[y](g);n._listeners=null}),this.promise.then=g=>{let y;const i=new Promise(k=>{n.subscribe(k),y=k}).then(g);return i.cancel=function(){n.unsubscribe(y)},i},r(function(y,i,k){n.reason||(n.reason=new CanceledError(y,i,k),e(n.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(r){if(this.reason){r(this.reason);return}this._listeners?this._listeners.push(r):this._listeners=[r]}unsubscribe(r){if(!this._listeners)return;const e=this._listeners.indexOf(r);e!==-1&&this._listeners.splice(e,1)}static source(){let r;return{token:new CancelToken(function(g){r=g}),cancel:r}}}const CancelToken$1=CancelToken;function spread(t){return function(e){return t.apply(null,e)}}function isAxiosError(t){return utils$1.isObject(t)&&t.isAxiosError===!0}const HttpStatusCode={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(HttpStatusCode).forEach(([t,r])=>{HttpStatusCode[r]=t});const HttpStatusCode$1=HttpStatusCode;function createInstance(t){const r=new Axios$1(t),e=bind(Axios$1.prototype.request,r);return utils$1.extend(e,Axios$1.prototype,r,{allOwnKeys:!0}),utils$1.extend(e,r,null,{allOwnKeys:!0}),e.create=function(g){return createInstance(mergeConfig(t,g))},e}const axios=createInstance(defaults$1);axios.Axios=Axios$1;axios.CanceledError=CanceledError;axios.CancelToken=CancelToken$1;axios.isCancel=isCancel;axios.VERSION=VERSION;axios.toFormData=toFormData;axios.AxiosError=AxiosError;axios.Cancel=axios.CanceledError;axios.all=function(r){return Promise.all(r)};axios.spread=spread;axios.isAxiosError=isAxiosError;axios.mergeConfig=mergeConfig;axios.AxiosHeaders=AxiosHeaders$1;axios.formToJSON=t=>formDataToJSON(utils$1.isHTMLForm(t)?new FormData(t):t);axios.getAdapter=adapters.getAdapter;axios.HttpStatusCode=HttpStatusCode$1;axios.default=axios;const axios$1=axios,_port=sessionStorage.getItem("HttpPort")||5266,getApiurl=()=>(console.log("environment","production"),`http://localhost:${_port}/api/v1`),_baseUrl=getApiurl(),ApiPrefix=_baseUrl,startBot=async(t=!0)=>(await axios$1.get(`${_baseUrl}/startbot?botReady=${t}`)).data,getConfig=async()=>(await axios$1.get(`${_baseUrl}/getconfig`)).data,saveConfig=async t=>(await axios$1.post(`${_baseUrl}/saveconfig`,t)).data,postMsg=async(t,r=0)=>(await axios$1.post(`${_baseUrl}/postmsg?type=`+r,t)).data,getCache=async t=>(await axios$1.get(`${_baseUrl}/getCache?pageIndex=${t.pageIndex}&pageSize=${t.pageSize}`)).data,saveImg=async t=>(await axios$1.get(`${_baseUrl}/saveimg/${t}`)).data,delImg=async t=>(await axios$1.get(`${_baseUrl}/delimg/${t}`)).data,getFun=async()=>(await axios$1.get(`${_baseUrl}/getfun`)).data,startPlugin=async(t,r)=>(await axios$1.get(`${_baseUrl}/startplugin?name=${t}&version=${r}`)).data,stopPlugin=async t=>(await axios$1.get(`${_baseUrl}/stopplugin?name=${t}`)).data,delPlugin=async t=>(await axios$1.get(`${_baseUrl}/delplugin?name=${t}`)).data,startAliYunPan=async()=>(await axios$1.get(`${_baseUrl}/startaliyunpan`)).data,searchIdol=async(t,r)=>(await axios$1.get(`${_baseUrl}/searchidol?group=${t}&name=${r}`)).data,sendSmsCode=async(t,r="86")=>(await axios$1.get(`${_baseUrl}/sendsmscode?mobile=${t}&area=${r}`)).data,pocketLogin=async(t,r)=>(await axios$1.get(`${_baseUrl}/pocketlogin?mobile=${t}&code=${r}`)).data,kdUserInfo=async t=>(await axios$1.post(`${_baseUrl}/kduserinfo`,t)).data,openWindow=async t=>(await axios$1.get(`${_baseUrl}/openwindow?url=${t}`)).data,getLogs=async()=>(await axios$1.get(`${_baseUrl}/getlogs`)).data;var NIM_Web_SDK={exports:{}};/*!
 * 
 * VERSION: 9.16.2
 * Git Hash: 1ddefb74af2685d8546990b4a578f520ed738e86
 * 
 * Create At: 2024/5/22 下午2:28:56
 * 
 * Target: NIM_Web_SDK
 */(function(module,exports){(function(t,r){module.exports=r()})(window,function(){return function(t){var r={};function e(n){if(r[n])return r[n].exports;var g=r[n]={i:n,l:!1,exports:{}};return t[n].call(g.exports,g,g.exports,e),g.l=!0,g.exports}return e.m=t,e.c=r,e.d=function(n,g,y){e.o(n,g)||Object.defineProperty(n,g,{enumerable:!0,get:y})},e.r=function(n){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(n,"__esModule",{value:!0})},e.t=function(n,g){if(1&g&&(n=e(n)),8&g||4&g&&typeof n=="object"&&n&&n.__esModule)return n;var y=Object.create(null);if(e.r(y),Object.defineProperty(y,"default",{enumerable:!0,value:n}),2&g&&typeof n!="string")for(var i in n)e.d(y,i,(function(k){return n[k]}).bind(null,i));return y},e.n=function(n){var g=n&&n.__esModule?function(){return n.default}:function(){return n};return e.d(g,"a",g),g},e.o=function(n,g){return Object.prototype.hasOwnProperty.call(n,g)},e.p="",e(e.s=938)}([function(t,r,e){var n=e(51),g=e(2),y=e(8),i=e(9),k=e(5),L=e(121),$=e(63),V=e(143),z=e(28),re=e(4),oe=e(11),le=e(6),ue=e(125),ie=e(144),ae=e(22),Ie=e(15),de=e(468),Ce=e(472),Ue=e(3),qe=e(68),jt=e(78),Fe=e(64),Et=e(52),cr=e(53),er=e(54),nr=e(55),dr=e(42),ir=e(24);function tr(Mr,br){var hr=k(Mr);if(Et){var Tr=Et(Mr);br&&(Tr=Ie(Tr).call(Tr,function(Br){return cr(Mr,Br).enumerable})),hr.push.apply(hr,Tr)}return hr}function ur(Mr,br){var hr=jt!==void 0&&Fe(Mr)||Mr["@@iterator"];if(!hr){if(z(Mr)||(hr=function(Ur,Qr){var vn;if(Ur){if(typeof Ur=="string")return or(Ur,Qr);var _n=i(vn=Object.prototype.toString.call(Ur)).call(vn,8,-1);if(_n==="Object"&&Ur.constructor&&(_n=Ur.constructor.name),_n==="Map"||_n==="Set")return qe(Ur);if(_n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(_n))return or(Ur,Qr)}}(Mr))||br&&Mr&&typeof Mr.length=="number"){hr&&(Mr=hr);var Tr=0,Br=function(){};return{s:Br,n:function(){return Tr>=Mr.length?{done:!0}:{done:!1,value:Mr[Tr++]}},e:function(Ur){throw Ur},f:Br}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var Fr,Lr=!0,qr=!1;return{s:function(){hr=hr.call(Mr)},n:function(){var Ur=hr.next();return Lr=Ur.done,Ur},e:function(Ur){qr=!0,Fr=Ur},f:function(){try{Lr||hr.return==null||hr.return()}finally{if(qr)throw Fr}}}}function or(Mr,br){(br==null||br>Mr.length)&&(br=Mr.length);for(var hr=0,Tr=new Array(br);hr<br;hr++)Tr[hr]=Mr[hr];return Tr}var fr=e(263),lr=e(203);function gr(Mr){ir(Mr)==="object"?(this.callFunc=Mr.callFunc||null,this.message=Mr.message||"UNKNOW ERROR"):this.message=Mr,this.time=new Date,this.timetag=+this.time}e(496);var Sr,wr,kr=e(66),mr=kr.getGlobal(),Ir=/\s+/;kr.deduplicate=function(Mr){var br=[];return g(Mr).call(Mr,function(hr){y(br).call(br,hr)===-1&&br.push(hr)}),br},kr.capFirstLetter=function(Mr){return Mr?i(Mr=""+Mr).call(Mr,0,1).toUpperCase()+i(Mr).call(Mr,1):""},kr.guid=(Sr=function(){return(65536*(1+Math.random())|0).toString(16).substring(1)},function(){return Sr()+Sr()+Sr()+Sr()+Sr()+Sr()+Sr()+Sr()}),kr.extend=function(Mr,br,hr){for(var Tr in br)Mr[Tr]!==void 0&&hr!==!0||(Mr[Tr]=br[Tr])},kr.filterObj=function(Mr,br){var hr={};return kr.isString(br)&&(br=br.split(Ir)),g(br).call(br,function(Tr){Mr.hasOwnProperty(Tr)&&(hr[Tr]=Mr[Tr])}),hr},kr.copy=function(Mr,br){var hr;return br=br||{},Mr&&g(hr=k(Mr)).call(hr,function(Tr){kr.exist(Mr[Tr])&&(br[Tr]=Mr[Tr])}),br},kr.copyWithNull=function(Mr,br){var hr;return br=br||{},Mr&&g(hr=k(Mr)).call(hr,function(Tr){(kr.exist(Mr[Tr])||kr.isnull(Mr[Tr]))&&(br[Tr]=Mr[Tr])}),br},kr.findObjIndexInArray=function(Mr,br){Mr=Mr||[];var hr=br.keyPath||"id",Tr=-1;return L(Mr).call(Mr,function(Br,Fr){if(lr(Br,hr)===br.value)return Tr=Fr,!0}),Tr},kr.findObjInArray=function(Mr,br){var hr=kr.findObjIndexInArray(Mr,br);return hr===-1?null:Mr[hr]},kr.mergeObjArray=function(){var Mr=[],br=i([]).call(arguments,0,-1),hr=arguments[arguments.length-1];kr.isArray(hr)&&(br.push(hr),hr={});var Tr,Br=hr.keyPath=hr.keyPath||"id";for(hr.sortPath=hr.sortPath||Br;!Mr.length&&br.length;)Mr=br.shift()||[],Mr=i(Mr).call(Mr,0);return g(br).call(br,function(Fr){Fr&&g(Fr).call(Fr,function(Lr){(Tr=kr.findObjIndexInArray(Mr,{keyPath:Br,value:lr(Lr,Br)}))!==-1?Mr[Tr]=kr.merge({},Mr[Tr],Lr):Mr.push(Lr)})}),hr.notSort||(Mr=kr.sortObjArray(Mr,hr)),Mr},kr.cutObjArray=function(Mr){var br=i(Mr).call(Mr,0),hr=arguments.length,Tr=i([]).call(arguments,1,hr-1),Br=arguments[hr-1];kr.isObject(Br)||(Tr.push(Br),Br={});var Fr,Lr=Br.keyPath=Br.keyPath||"id";return g(Tr).call(Tr,function(qr){kr.isArray(qr)||(qr=[qr]),g(qr).call(qr,function(Ur){Ur&&(Br.value=lr(Ur,Lr),(Fr=kr.findObjIndexInArray(br,Br))!==-1&&$(br).call(br,Fr,1))})}),br},kr.sortObjArray=function(Mr,br){var hr=(br=br||{}).sortPath||"id";fr.insensitive=!!br.insensitive;var Tr,Br,Fr,Lr=!!br.desc;return Fr=kr.isFunction(br.compare)?br.compare:function(qr,Ur){return Tr=lr(qr,hr),Br=lr(Ur,hr),Lr?fr(Br,Tr):fr(Tr,Br)},V(Mr).call(Mr,Fr)},kr.emptyFunc=function(){},kr.isEmptyFunc=function(Mr){return Mr===kr.emptyFunc},kr.notEmptyFunc=function(Mr){return Mr!==kr.emptyFunc},kr.splice=function(Mr,br,hr){return $([]).call(Mr,br,hr)},kr.reshape2d=function(Mr,br){if(z(Mr)){kr.verifyParamType("type",br,"number","util::reshape2d");var hr=Mr.length;if(hr<=br)return[Mr];for(var Tr=Math.ceil(hr/br),Br=[],Fr=0;Fr<Tr;Fr++)Br.push(i(Mr).call(Mr,Fr*br,(Fr+1)*br));return Br}return Mr},kr.flatten2d=function(Mr){if(z(Mr)){var br=[];return g(Mr).call(Mr,function(hr){br=re(br).call(br,hr)}),br}return Mr},kr.dropArrayDuplicates=function(Mr){if(z(Mr)){for(var br={},hr=[];Mr.length>0;)br[Mr.shift()]=!0;for(var Tr in br)br[Tr]===!0&&hr.push(Tr);return hr}return Mr},kr.onError=function(Mr){throw new gr(Mr)},kr.verifyParamPresent=function(Mr,br,hr,Tr){hr=hr||"";var Br=!1;switch(kr.typeOf(br)){case"undefined":case"null":Br=!0;break;case"string":br===""&&(Br=!0);break;case"StrStrMap":case"object":k(br).length||(Br=!0);break;case"array":br.length?L(br).call(br,function(Fr){if(kr.notexist(Fr))return Br=!0,!0}):Br=!0}Br&&kr.onParamAbsent(hr+Mr,Tr)},kr.onParamAbsent=function(Mr,br){kr.onParamError("缺少参数 ".concat(Mr,", 请确保参数不是 空字符串、空对象、空数组、null或undefined, 或数组的内容不是 null/undefined"),br)},kr.verifyParamAbsent=function(Mr,br,hr,Tr){hr=hr||"",br!==void 0&&kr.onParamPresent(hr+Mr,Tr)},kr.onParamPresent=function(Mr,br){kr.onParamError("多余的参数 ".concat(Mr),br)},kr.verifyParamType=function(Mr,br,hr,Tr){var Br=kr.typeOf(br).toLowerCase();kr.isArray(hr)||(hr=[hr]),hr=oe(hr).call(hr,function(Lr){return Lr.toLowerCase()});var Fr=!0;switch(y(hr).call(hr,Br)===-1&&(Fr=!1),Br){case"number":isNaN(br)&&(Fr=!1);break;case"string":hr.join("")==="numeric or numeric string"&&(Fr=!!/^[0-9]+$/.test(br))}Fr||kr.onParamInvalidType(Mr,hr,"",Tr)},kr.onParamInvalidType=function(Mr,br,hr,Tr){hr=hr||"",br=kr.isArray(br)?(br=oe(br).call(br,function(Br){return'"'+Br+'"'})).join(", "):'"'+br+'"',kr.onParamError('参数"'+hr+Mr+'"类型错误, 合法的类型包括: ['+br+"]",Tr)},kr.verifyParamValid=function(Mr,br,hr,Tr){kr.isArray(hr)||(hr=[hr]),y(hr).call(hr,br)===-1&&kr.onParamInvalidValue(Mr,hr,Tr)},kr.onParamInvalidValue=function(Mr,br,hr){var Tr;kr.isArray(br)||(br=[br]),br=oe(br).call(br,function(Br){return'"'+Br+'"'}),kr.isArray(br)&&(br=br.join(", ")),kr.onParamError(re(Tr="参数 ".concat(Mr,"值错误, 合法的值包括: [")).call(Tr,le(br),"]"),hr)},kr.verifyParamMin=function(Mr,br,hr,Tr){br<hr&&kr.onParamError("参数"+Mr+"的值不能小于"+hr,Tr)},kr.verifyParamMax=function(Mr,br,hr,Tr){br>hr&&kr.onParamError("参数"+Mr+"的值不能大于"+hr,Tr)},kr.verifyArrayMax=function(Mr,br,hr,Tr){br.length>hr&&kr.onParamError("参数"+Mr+"的长度不能大于"+hr,Tr)},kr.verifyEmail=(wr=/^\S+@\S+$/,function(Mr,br,hr){wr.test(br)||kr.onParamError("参数"+Mr+"邮箱格式错误, 合法格式必须包含@符号, @符号前后至少要各有一个字符",hr)}),kr.verifyTel=function(){var Mr=/^[+\-()\d]+$/;return function(br,hr,Tr){Mr.test(hr)||kr.onParamError("参数"+br+"电话号码格式错误, 合法字符包括+、-、英文括号和数字",Tr)}}(),kr.verifyBirth=function(){var Mr=/^(\d{4})-(0[1-9]|1[012])-(0[1-9]|[12][0-9]|3[01])$/;return function(br,hr,Tr){Mr.test(hr)||kr.onParamError("参数"+br+'生日格式错误, 合法为"yyyy-MM-dd"',Tr)}}(),kr.onParamError=function(Mr,br){kr.onError({message:Mr,callFunc:br})},kr.verifyOptions=function(Mr,br,hr,Tr,Br){if(Mr=Mr||{},br&&(kr.isString(br)&&(br=br.split(Ir)),kr.isArray(br))){typeof hr!="boolean"&&(Br=hr||null,hr=!0,Tr="");var Fr=hr?kr.verifyParamPresent:kr.verifyParamAbsent;g(br).call(br,function(Lr){Fr.call(kr,Lr,Mr[Lr],Tr,Br)})}return Mr},kr.verifyParamAtLeastPresentOne=function(Mr,br,hr){br&&(kr.isString(br)&&(br=br.split(Ir)),kr.isArray(br)&&(L(br).call(br,function(Tr){return kr.exist(Mr[Tr])})||kr.onParamError("以下参数["+br.join(", ")+"]至少需要传入一个",hr)))},kr.verifyParamPresentJustOne=function(Mr,br,hr){br&&(kr.isString(br)&&(br=br.split(Ir)),kr.isArray(br)&&ue(br).call(br,function(Tr,Br){return kr.exist(Mr[Br])&&Tr++,Tr},0)!==1&&kr.onParamError("以下参数["+br.join(", ")+"]必须且只能传入一个",hr))},kr.verifyBooleanWithDefault=function(Mr,br,hr,Tr,Br){kr.undef(hr)&&(hr=!0),Ir.test(br)&&(br=br.split(Ir)),kr.isArray(br)?g(br).call(br,function(Fr){kr.verifyBooleanWithDefault(Mr,Fr,hr,Tr,Br)}):Mr[br]===void 0?Mr[br]=hr:kr.isBoolean(Mr[br])||kr.onParamInvalidType(br,"boolean",Tr,Br)},kr.verifyFileInput=function(Mr,br){var hr;return kr.verifyParamPresent("fileInput",Mr,"",br),kr.isString(Mr)&&((Mr=typeof document>"u"?void 0:document.getElementById(Mr))||kr.onParamError("找不到要上传的文件对应的input, 请检查fileInput id ".concat(Mr),br)),Mr.tagName&&Mr.tagName.toLowerCase()==="input"&&Mr.type.toLowerCase()==="file"||kr.onParamError(re(hr="请提供正确的 fileInput, 必须为 file 类型的 input 节点 tagname:".concat(Mr.tagName,", filetype:")).call(hr,Mr.type),br),Mr},kr.verifyFileType=function(Mr,br){kr.verifyParamValid("type",Mr,kr.validFileTypes,br)},kr.verifyCallback=function(Mr,br,hr){Ir.test(br)&&(br=br.split(Ir)),kr.isArray(br)?g(br).call(br,function(Tr){kr.verifyCallback(Mr,Tr,hr)}):Mr[br]?kr.isFunction(Mr[br])||kr.onParamInvalidType(br,"function","",hr):Mr[br]=kr.emptyFunc},kr.verifyFileUploadCallback=function(Mr,br){kr.verifyCallback(Mr,"uploadprogress uploaddone uploaderror uploadcancel",br)},kr.validFileTypes=["image","audio","video","file"],kr.validFileExts={image:["bmp","gif","jpg","jpeg","jng","png","webp"],audio:["mp3","wav","aac","wma","wmv","amr","mp2","flac","vorbis","ac3"],video:["mp4","rm","rmvb","wmv","avi","mpg","mpeg","mov"]},kr.filterFiles=function(Mr,br){var hr,Tr,Br=(br=br.toLowerCase())==="file",Fr=[];return g([]).call(Mr,function(Lr){var qr,Ur;if(Br)Fr.push(Lr);else if(hr=i(qr=Lr.name).call(qr,ie(Ur=Lr.name).call(Ur,".")+1),(Tr=Lr.type.split("/"))[0]&&Tr[1]){var Qr,vn=!1;Tr[0].toLowerCase()===br?vn=!0:vn=y(Qr=kr.validFileExts[br]).call(Qr,hr)!==-1,vn&&Fr.push(Lr)}}),Fr};var Nr,Er,sr=kr.supportFormData=kr.notundef(mr.FormData);kr.getFileName=function(Mr){return Mr=kr.verifyFileInput(Mr),sr?Mr.files[0].name:i(br=Mr.value).call(br,ie(hr=Mr.value).call(hr,"\\")+1);var br,hr},kr.getFileInfo=(Nr={ppt:1,pptx:2,pdf:3,doc:6,docx:7},function(Mr){var br={};if(!(Mr=kr.verifyFileInput(Mr)).files)return br;var hr=Mr.files[0];return sr&&(br.name=hr.name,br.size=hr.size,br.type=hr.name.match(/\.(\w+)$/),br.type=br.type&&br.type[1].toLowerCase(),br.transcodeType=Nr[br.type]||0),br}),kr.sizeText=(Er=["B","KB","MB","GB","TB","PB","EB","ZB","BB"],function(Mr){var br,hr=0;do br=(Mr=Math.floor(100*Mr)/100)+Er[hr],Mr/=1024,hr++;while(Mr>1);return br}),kr.promises2cmds=function(Mr){return oe(Mr).call(Mr,function(br){return br.cmd})},kr.objs2accounts=function(Mr){return oe(Mr).call(Mr,function(br){return br.account})},kr.teams2ids=function(Mr){return oe(Mr).call(Mr,function(br){return br.teamId})},kr.objs2ids=function(Mr){return oe(Mr).call(Mr,function(br){return br.id})},kr.getMaxUpdateTime=function(Mr){var br=oe(Mr).call(Mr,function(hr){return+hr.updateTime});return Math.max.apply(Math,br)},kr.genCheckUniqueFunc=function(Mr){return Mr=Mr||"id",function(br){this.uniqueSet=this.uniqueSet||{},this.uniqueSet[Mr]=this.uniqueSet[Mr]||{};var hr=this.uniqueSet[Mr],Tr=br[Mr];return!hr[Tr]&&(hr[Tr]=!0,!0)}},kr.fillPropertyWithDefault=function(Mr,br,hr){return!!kr.undef(Mr[br])&&(Mr[br]=hr,!0)},kr.throttle=function(Mr,br,hr,Tr){var Br,Fr,Lr=null,qr=0;hr||(hr={});var Ur=function(){qr=hr.leading===!1?0:new Date().getTime(),Lr=null,Mr.apply(Br,Fr),Lr||(Br=Fr=null)};return function(){var Qr=new Date().getTime();qr||hr.leading!==!1||(qr=Qr);var vn=br-(Qr-qr);return Br=this,Fr=arguments,vn<=0||vn>br?(clearTimeout(Lr),Lr=null,qr=Qr,Mr.apply(Br,Fr),Lr||(Br=Fr=null)):Lr||hr.trailing===!1?Lr&&Tr&&Tr.apply(Br,Fr):(Lr=ae(Ur,vn),Tr&&Tr.apply(Br,Fr)),Lr}},kr.get=function(Mr,br){var hr=arguments.length>2&&arguments[2]!==void 0?arguments[2]:void 0;if(ir(Mr)!=="object")return hr;var Tr,Br=br.replace(/\[(\d+)\]/g,".$1").split("."),Fr=Mr,Lr=ur(Br);try{for(Lr.s();!(Tr=Lr.n()).done;){var qr=Tr.value;if((Fr=Object(Fr)[qr])===void 0)return hr}}catch(Ur){Lr.e(Ur)}finally{Lr.f()}return Fr},kr.pickAsString=function(Mr,br){var hr;return Mr?oe(hr=Ie(br).call(br,function(Tr){return Mr[Tr]!==void 0})).call(hr,function(Tr){var Br;return re(Br="".concat(Tr,"=")).call(Br,Mr[Tr])}).join(","):""},kr.omitAsString=function(Mr,br){var hr,Tr;if(!Mr)return"";var Br={};return g(br).call(br,function(Fr){Br[Fr]=!0}),oe(hr=Ie(Tr=k(Mr)).call(Tr,function(Fr){return!Br[Fr]})).call(hr,function(Fr){var Lr;return re(Lr="".concat(Fr,"=")).call(Lr,Mr[Fr])}).join(",")};var xr={session:function(Mr){var br=function(Tr){for(var Br=1;Br<arguments.length;Br++){var Fr,Lr,qr=arguments[Br]!=null?arguments[Br]:{};Br%2?g(Fr=tr(Object(qr),!0)).call(Fr,function(Ur){n(Tr,Ur,qr[Ur])}):er?nr(Tr,er(qr)):g(Lr=tr(Object(qr))).call(Lr,function(Ur){dr(Tr,Ur,cr(qr,Ur))})}return Tr}({},Mr),hr=["topCustom","localCustom","extra"];return g(hr).call(hr,function(Tr){br[Tr]&&(br[Tr]="***")}),br.lastMsg&&(br.lastMsg={idServer:br.lastMsg.idServer,idClient:br.lastMsg.idClient}),br}};kr.secureOutput=function(Mr,br){z(br)||(br=[br]);var hr=xr[Mr];return(br=oe(br).call(br,function(Tr){return hr(Tr)})).length===1?br[0]:br};var Or={string:function(Mr,br,hr){var Tr=hr.required,Br=hr.allowEmpty,Fr=Mr[br];return Tr===!1&&Fr===void 0||typeof Fr=="string"&&!(!Br&&Fr==="")},number:function(Mr,br,hr){var Tr=hr.required,Br=hr.min,Fr=Mr[br];return Tr===!1&&Fr===void 0||typeof Fr=="number"&&!(Fr<Br)},enum:function(Mr,br,hr){var Tr=hr.required,Br=de(hr),Fr=Mr[br];return Tr===!1&&Fr===void 0||y(Br).call(Br,Fr)>-1},array:function(Mr,br,hr){var Tr=hr.itemType,Br=hr.min,Fr=hr.max,Lr=hr.required,qr=Mr[br];return Lr===!1&&qr===void 0||!!z(qr)&&!(typeof Fr=="number"&&qr.length>Fr)&&!(typeof Br=="number"&&qr.length<Br)&&!(Tr&&Tr!=="enum"&&!Ce(qr).call(qr,function(Ur){return ir(Ur)===Tr}))}};kr.validate=function(Mr,br,hr){var Tr,Br={};return g(Tr=k(Mr)).call(Tr,function(Fr){var Lr,qr=Mr[Fr].type,Ur=Or[qr];Ur&&!Ur(br,Fr,Mr[Fr])?kr.onError({message:re(Lr="Error in parameter verification, ".concat(Fr," expected value is ")).call(Lr,le(Mr[Fr])),callFunc:hr}):Br[Fr]=br[Fr]}),Br},kr.asyncPool=function(Mr,br,hr){if(typeof Mr!="number"||typeof hr!="function"||!br||!br.length)return Ue.resolve();var Tr=0,Br=[],Fr=[];return function Lr(){if(Tr===br.length)return Ue.resolve();var qr=br[Tr++],Ur=Ue.resolve().then(function(){return hr(qr,br)});Br.push(Ur);var Qr=Ue.resolve();if(Mr<=br.length){var vn=Ur.then(function(){return $(Fr).call(Fr,y(Fr).call(Fr,vn),1)});Fr.push(vn),Fr.length>=Mr&&(Qr=Ue.race(Fr))}return Qr.then(function(){return Lr()})}().then(function(){return Ue.all(Br)})},kr.getIdArray=function(Mr){if(!Mr||typeof Mr!="string")throw new Error("id type error");var br=y(Mr).call(Mr,"-");if(br<0||br===Mr.length-1)throw new Error("id format error");return[i(Mr).call(Mr,0,br),i(Mr).call(Mr,br+1)]},t.exports=kr},function(t,r,e){var n=e(16),g=e(83),y=e(166),i=e(17),k=e(97).f,L=e(215),$=e(14),V=e(36),z=e(65),re=e(31),oe=function(le){var ue=function(ie,ae,Ie){if(this instanceof ue){switch(arguments.length){case 0:return new le;case 1:return new le(ie);case 2:return new le(ie,ae)}return new le(ie,ae,Ie)}return g(le,this,arguments)};return ue.prototype=le.prototype,ue};t.exports=function(le,ue){var ie,ae,Ie,de,Ce,Ue,qe,jt,Fe,Et=le.target,cr=le.global,er=le.stat,nr=le.proto,dr=cr?n:er?n[Et]:(n[Et]||{}).prototype,ir=cr?$:$[Et]||z($,Et,{})[Et],tr=ir.prototype;for(de in ue)ae=!(ie=L(cr?de:Et+(er?".":"#")+de,le.forced))&&dr&&re(dr,de),Ue=ir[de],ae&&(qe=le.dontCallGetSet?(Fe=k(dr,de))&&Fe.value:dr[de]),Ce=ae&&qe?qe:ue[de],ae&&typeof Ue==typeof Ce||(jt=le.bind&&ae?V(Ce,n):le.wrap&&ae?oe(Ce):nr&&i(Ce)?y(Ce):Ce,(le.sham||Ce&&Ce.sham||Ue&&Ue.sham)&&z(jt,"sham",!0),z(ir,de,jt),nr&&(re($,Ie=Et+"Prototype")||z($,Ie,{}),z($[Ie],de,Ce),le.real&&tr&&(ie||!tr[de])&&z(tr,de,Ce)))}},function(t,r,e){t.exports=e(236)},function(t,r,e){t.exports=e(238)},function(t,r,e){t.exports=e(330)},function(t,r,e){t.exports=e(237)},function(t,r,e){t.exports=e(390)},function(t,r){t.exports=function(e){try{return!!e()}catch{return!0}}},function(t,r,e){t.exports=e(211)},function(t,r,e){t.exports=e(257)},function(t,r,e){t.exports=e(283)},function(t,r,e){t.exports=e(446)},function(t,r,e){var n=e(8),g=e(4),y=!1;try{typeof localStorage.setItem=="function"&&typeof localStorage.getItem=="function"&&(localStorage.setItem("nim_localstorage_exist_test","1"),y=localStorage.getItem("nim_localstorage_exist_test")==="1",localStorage.removeItem("nim_localstorage_exist_test"))}catch{y=!1}var i={nodeEnv:"production",info:{hash:"1ddefb74af2685d8546990b4a578f520ed738e86",shortHash:"1ddefb7",version:"9.16.2",sdkVersion:"91602",sdkHumanVersion:"9.16.2",protocolVersion:1},lbsUrl:"https://lbs.netease.im/lbs/webconf.jsp",needToXHR:!0,connectTimeout:1e4,xhrTimeout:8e3,reconnectionDelay:1600,reconnectionDelayMax:8e3,reconnectionJitter:.01,reconnectiontimer:null,heartbeatInterval:3e4,cmdTimeout:8e3,hbCmdTimeout:5e3,isWeixinApp:!1,isNodejs:!1,isRN:!1,ipVersion:0,PUSHTOKEN:"",PUSHCONFIG:{},CLIENTTYPE:16,PushPermissionAsked:!1,iosPushConfig:null,androidPushConfig:null,optionDefaultLinkUrl:"",defaultLinkUrl:"weblink.netease.im",ipv6DefaultLinkUrl:"weblink.netease.im",optionIpv6DefaultLinkUrl:"",wxDefaultLinkUrl:"wlnimsc0.netease.im",serverNosConfig:y?{cdnDomain:localStorage.getItem("nim_cdn_domain")||"",objectPrefix:localStorage.getItem("nim_object_prefix")||""}:{},hasLocalStorage:y,privateConf:{isABTestEnable:!0,isDataReportEnable:!0,isMixStoreEnable:!0,reportConfigUrl:"https://statistic.live.126.net/dispatcher/req",reportUrl:"https://statistic.live.126.net/statics/report/common/form"},getDefaultLinkUrl:function(k){var L,$;i.ipVersion===1?(L=i.optionIpv6DefaultLinkUrl,$=i.ipv6DefaultLinkUrl):(L=i.optionDefaultLinkUrl,$=i.defaultLinkUrl);var V=L||(i.isWeixinApp?i.wxDefaultLinkUrl:$);if(!V)return!1;var z=k?"https":"http",re=k?"443":"80",oe=V;return n(V).call(V,"http")===-1&&(oe=z+"://"+oe),n(V).call(V,":")===-1&&(oe=oe+":"+re),oe},ipProbeAddr:{ipv4:"https://check-ipv4.netease.im/test/",ipv6:"https://check-ipv6.netease.im/test/"},formatSocketUrl:function(k){var L=k.url,$=k.secure?"https":"http";return n(L).call(L,"http")===-1?$+"://"+L:L},uploadUrl:"https://nos.netease.com",chunkUploadUrl:"https://wanproxy-web.127.net",commonMaxSize:104857600,chunkSize:4194304,chunkMaxSize:4194304e4,replaceUrl:"https://{bucket}-nosdn.netease.im/{object}",downloadHost:"nos.netease.com",downloadHostList:["nos.netease.com"],downloadUrl:"https://{bucket}-nosdn.netease.im/{object}",nosCdnEnable:!0,httpsEnabled:!1,threshold:0,nosLbsUrls:[],edgeList:["https://wanproxy-web.127.net","https://nosup-hz1.127.net"],genUploadUrl:function(k){return i.uploadUrl+"/"+k},genChunkUploadUrl:function(k){return i.chunkUploadUrl?i.chunkUploadUrl+"/"+k.bucket+"/"+k.objectName:""},genDownloadUrl:function(k,L,$){var V,z,re,oe,le,ue=k.bucket,ie=k.expireSec,ae=+new Date,Ie=ie?"&survivalTime=".concat(ie):"";if($)return g(re=g(oe=g(le="https://".concat($,"/")).call(le,L,"?createTime=")).call(oe,ae)).call(re,Ie);var de=g(V=g(z="".concat(i.replaceUrl,"?createTime=")).call(z,ae)).call(V,Ie);return(de=i.genNosProtocolUrl(de)).replace("{bucket}",ue).replace("{object}",L)},genFileUrl:function(k){var L=k.bucket,$=k.objectName;return i.genNosProtocolUrl(i.replaceUrl).replace("{bucket}",L).replace("{object}",$)},genNosProtocolUrl:function(k){return/^http/.test(k)?i.httpsEnabled&&n(k).call(k,"https://")!==0&&(k=k.replace("http","https")):k=i.httpsEnabled?"https://".concat(k):"http://".concat(k),k}};i.hostEnv="BROWSER",t.exports=i},function(t,r,e){var n=e(111),g=Function.prototype,y=g.call,i=n&&g.bind.bind(y,y);t.exports=n?i:function(k){return function(){return y.apply(k,arguments)}}},function(t,r){t.exports={}},function(t,r,e){t.exports=e(464)},function(t,r,e){(function(n){var g=function(y){return y&&y.Math==Math&&y};t.exports=g(typeof globalThis=="object"&&globalThis)||g(typeof window=="object"&&window)||g(typeof self=="object"&&self)||g(typeof n=="object"&&n)||function(){return this}()||Function("return this")()}).call(this,e(77))},function(t,r,e){var n=e(212),g=n.all;t.exports=n.IS_HTMLDDA?function(y){return typeof y=="function"||y===g}:function(y){return typeof y=="function"}},function(t,r,e){var n=e(13);t.exports=n({}.isPrototypeOf)},function(t,r,e){t.exports=e(220)},function(t,r,e){var n=e(111),g=Function.prototype.call;t.exports=n?g.bind(g):function(){return g.apply(g,arguments)}},function(t,r,e){var n=e(16),g=e(113),y=e(31),i=e(132),k=e(99),L=e(213),$=g("wks"),V=n.Symbol,z=V&&V.for,re=L?V:V&&V.withoutSetter||i;t.exports=function(oe){if(!y($,oe)||!k&&typeof $[oe]!="string"){var le="Symbol."+oe;k&&y(V,oe)?$[oe]=V[oe]:$[oe]=L&&z?z(le):re(le)}return $[oe]}},function(t,r,e){t.exports=e(460)},function(t,r,e){t.exports=e(280)},function(t,r,e){var n=e(158),g=e(372);function y(i){return t.exports=y=typeof n=="function"&&typeof g=="symbol"?function(k){return typeof k}:function(k){return k&&typeof n=="function"&&k.constructor===n&&k!==n.prototype?"symbol":typeof k},t.exports.__esModule=!0,t.exports.default=t.exports,y(i)}t.exports=y,t.exports.__esModule=!0,t.exports.default=t.exports},function(t,r,e){var n=e(14),g=e(31),y=e(137),i=e(40).f;t.exports=function(k){var L=n.Symbol||(n.Symbol={});g(L,k)||i(L,k,{value:y.f(k)})}},function(t,r,e){var n=e(51),g=e(56),y=e(4),i=e(22),k=e(6),L=e(28),$=e(5),V=e(52),z=e(15),re=e(53),oe=e(2),le=e(54),ue=e(55),ie=e(42),ae=e(9),Ie=e(68),de=e(78),Ce=e(64);function Ue(dr,ir){var tr=de!==void 0&&Ce(dr)||dr["@@iterator"];if(!tr){if(L(dr)||(tr=function(Sr,wr){var kr;if(Sr){if(typeof Sr=="string")return qe(Sr,wr);var mr=ae(kr=Object.prototype.toString.call(Sr)).call(kr,8,-1);if(mr==="Object"&&Sr.constructor&&(mr=Sr.constructor.name),mr==="Map"||mr==="Set")return Ie(Sr);if(mr==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(mr))return qe(Sr,wr)}}(dr))||ir&&dr&&typeof dr.length=="number"){tr&&(dr=tr);var ur=0,or=function(){};return{s:or,n:function(){return ur>=dr.length?{done:!0}:{done:!1,value:dr[ur++]}},e:function(Sr){throw Sr},f:or}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var fr,lr=!0,gr=!1;return{s:function(){tr=tr.call(dr)},n:function(){var Sr=tr.next();return lr=Sr.done,Sr},e:function(Sr){gr=!0,fr=Sr},f:function(){try{lr||tr.return==null||tr.return()}finally{if(gr)throw fr}}}}function qe(dr,ir){(ir==null||ir>dr.length)&&(ir=dr.length);for(var tr=0,ur=new Array(ir);tr<ir;tr++)ur[tr]=dr[tr];return ur}function jt(dr,ir){var tr=$(dr);if(V){var ur=V(dr);ir&&(ur=z(ur).call(ur,function(or){return re(dr,or).enumerable})),tr.push.apply(tr,ur)}return tr}function Fe(dr){for(var ir=1;ir<arguments.length;ir++){var tr,ur,or=arguments[ir]!=null?arguments[ir]:{};ir%2?oe(tr=jt(Object(or),!0)).call(tr,function(fr){n(dr,fr,or[fr])}):le?ue(dr,le(or)):oe(ur=jt(Object(or))).call(ur,function(fr){ie(dr,fr,re(or,fr))})}return dr}var Et=e(48),cr=e(0);function er(dr){return cr.get(dr,"code")||cr.get(dr,"msg.code")||cr.get(dr,"statusCode")||cr.get(dr,"event.code")||0}function nr(dr){var ir,tr,ur=typeof dr=="string"?dr:cr.get(dr,"msg")||cr.get(dr,"message")||cr.get(dr,"error")||cr.get(dr,"event.msg")||cr.get(dr,"event.message")||cr.get(dr,"event")||"unknown",or="",fr="";dr&&typeof dr.toString=="function"&&(or=dr.toString());try{fr=k(dr)}catch{}return y(ir=y(tr=`
errMsg: `.concat(ur,`
errStr: `)).call(tr,or,`
errJsonStr: `)).call(ir,fr,`
  `)}t.exports={reportAPI:function(dr){var ir=dr.instance,tr=dr.className,ur=dr.funcName,or=dr.hasCallback,fr=or===void 0||or,lr=dr.done;if(!function(wr){if(!wr||!L(wr.experiments))return!1;var kr,mr=Ue(wr.experiments);try{for(mr.s();!(kr=mr.n()).done;){var Ir=kr.value;if(Ir.experimentKey==="api_trace_collection"&&Ir.schemeKey==="open_flow"&&L(Ir.variates)){var Nr,Er=Ue(Ir.variates);try{for(Er.s();!(Nr=Er.n()).done;){var sr=Nr.value;if(sr.key==="open"&&sr.value===!0)return!0}}catch(xr){Er.e(xr)}finally{Er.f()}}}}catch(xr){mr.e(xr)}finally{mr.f()}return!1}(ir.abtInfo)||!ir.reporter||!ir.reporter.isUploadEnable)return lr;var gr,Sr={user_id:cr.get(ir,"options.account")||"",trace_id:cr.get(ir,"socket.socket.sessionid"),class_name:tr,api_name:ur,action:fr?1:0,active_id:Et.deviceId,start_time:g()};return fr?(gr=i(function(){ir&&ir.logger&&ir.logger.warn("API 数据上报回调函数未调用",Sr),ir&&ir.reporter&&ir.reporter.report("nim_api_trace",Fe(Fe({},Sr),{},{state:1,error_code:408,error_msg:"API回调函数未被调用",duration:g()-Sr.start_time}))},1e4),function(wr){if(clearTimeout(gr),typeof lr=="function"){for(var kr,mr=arguments.length,Ir=new Array(mr>1?mr-1:0),Nr=1;Nr<mr;Nr++)Ir[Nr-1]=arguments[Nr];lr.apply(void 0,y(kr=[wr]).call(kr,Ir))}try{if(!ir||!ir.reporter)return;wr?ir.reporter.report("nim_api_trace",Fe(Fe({},Sr),{},{state:1,error_code:er(wr),error_msg:nr(wr),duration:g()-Sr.start_time})):ir.reporter.report("nim_api_trace",Fe(Fe({},Sr),{},{state:0,duration:g()-Sr.start_time}))}catch(Er){ir&&ir.logger&&ir.logger.error("api report error",Er)}}):(ir.reporter.report("nim_api_trace",Fe(Fe({},Sr),{},{state:0,duration:1})),lr)}}},function(t,r,e){var n=e(14);t.exports=function(g){return n[g+"Prototype"]}},function(t,r,e){t.exports=e(235)},function(t,r,e){var n=e(7);t.exports=!n(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!=7})},function(t,r,e){var n=e(17),g=e(212),y=g.all;t.exports=g.IS_HTMLDDA?function(i){return typeof i=="object"?i!==null:n(i)||i===y}:function(i){return typeof i=="object"?i!==null:n(i)}},function(t,r,e){var n=e(13),g=e(46),y=n({}.hasOwnProperty);t.exports=Object.hasOwn||function(i,k){return y(g(i),k)}},function(t,r,e){var n=e(17),g=e(85),y=TypeError;t.exports=function(i){if(n(i))return i;throw y(g(i)+" is not a function")}},function(t,r,e){var n=e(14),g=e(16),y=e(17),i=function(k){return y(k)?k:void 0};t.exports=function(k,L){return arguments.length<2?i(n[k])||i(g[k]):n[k]&&n[k][L]||g[k]&&g[k][L]}},function(t,r,e){t.exports=e(309)},function(t,r,e){var n=e(19),g=e(2),y=e(95),i=e(4),k=e(24),L=e(0);function $(re,oe){var le=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},ue=this;ue.message=re||le.message||"",k(oe)==="object"?(ue.event=oe,ue.code="Other_Error"):oe!==void 0&&(ue.code=oe),ue.timetag=+new Date,le!==void 0&&(ue.event=le),ue.event&&(ue.callFunc=ue.event.callFunc||null,delete ue.event.callFunc)}$.prototype=n(Error.prototype),$.prototype.name="NIMError";var V={201:"客户端版本不对, 需升级sdk",302:"用户名或密码错误, 请检查appKey和token是否有效, account和token是否匹配",403:"非法操作或没有权限",404:"对象(用户/群/聊天室)不存在",405:"参数长度过长",408:"客户端请求超时",414:"参数错误",415:"服务不可用/没有聊天室服务器可分配",416:"频率控制",417:"重复操作",422:"帐号被禁用",500:"服务器内部错误",501:"数据库操作失败",503:"服务器繁忙",508:"删除有效期过了",509:"已失效",7101:"被拉黑",700:"批量操作部分失败",801:"群人数达到上限",802:"没有权限",803:"群不存在或未发生变化",804:"用户不在群里面",805:"群类型不匹配",806:"创建群数量达到限制",807:"群成员状态不对",809:"已经在群里",811:"强推列表中帐号数量超限",812:"群被禁言",813:"因群数量限制，部分拉人成功",814:"禁止使用群组消息已读服务",815:"群管理员人数上限",816:"批量操作部分失败",997:"协议已失效",998:"解包错误",999:"打包错误",9102:"通道失效",9103:"已经在其他端接听/拒绝过这通电话",11001:"对方离线, 通话不可送达",13002:"聊天室状态异常",13003:"在黑名单中",13004:"在禁言名单中",13006:"聊天室处于整体禁言状态,只有管理员能发言",Connect_Failed:"无法建立连接, 请确保能 ping/telnet 到云信服务器; 如果是IE8/9, 请确保项目部署在 HTTPS 环境下",Error_Internet_Disconnected:"网断了",Error_Connection_is_not_Established:"连接未建立",Error_Connection_Socket_State_not_Match:"socket状态不对",Error_Timeout:"超时",Param_Error:"参数错误",No_File_Selected:"请选择文件",Wrong_File_Type:"文件类型错误",File_Too_Large:"文件过大",Cross_Origin_Iframe:"不能获取跨域Iframe的内容",Not_Support:"不支持",NO_DB:"无数据库。请确保在 onsyncdone 同步结束后再操作数据库",DB:"数据库错误",Still_In_Team:"还在群里",Session_Exist:"会话已存在",Session_Not_Exist:"会话不存在",Error_Unknown:"未知错误",Operation_Canceled:"操作取消",Sync_Error:"同步数据失败"},z=[200,406,808,810];g(z).call(z,function(re){V[re]=null}),$.genError=function(re){var oe=V[re];return oe===void 0&&(oe="操作失败"),oe===null?null:new $(oe,re)},$.multiInstance=function(re){return new $("不允许初始化多个实例","Not_Allow_Multi_Instance",re)},$.newNetworkError=function(re){var oe="Error_Internet_Disconnected";return new $(V[oe],oe,re)},$.newConnectError=function(re){var oe="Connect_Failed";return new $(V[oe]||null,oe,re)},$.newConnectionError=function(re){var oe="Error_Connection_is_not_Established";return new $(V[oe],oe,re)},$.newSocketStateError=function(re){var oe="Error_Connection_Socket_State_not_Match";return new $(V[oe],oe,re)},$.newTimeoutError=function(re){var oe="Error_Timeout";return new $(V[oe],oe,re)},$.newFrequencyControlError=function(re){var oe=new $(V[416],416,re);return oe.from="local",oe},$.newParamError=function(re,oe){return new $(re||V.Param_Error,"Param_Error",oe)},$.newNoFileError=function(re,oe){var le="No_File_Selected";return new $(re||V[le],le,oe)},$.newWrongFileTypeError=function(re,oe){var le="Wrong_File_Type";return new $(re||V[le],le,oe)},$.newFileTooLargeError=function(re,oe){var le="File_Too_Large";return new $(re||V[le],le,oe)},$.newCORSIframeError=function(re){var oe="Cross_Origin_Iframe";return new $(V[oe],oe,re)},$.newSupportError=function(re,oe,le){return new $("不支持"+re,"Not_Support_"+oe,le)},$.newSupportDBError=function(re){return $.newSupportError("数据库","DB",re)},$.noDBError=function(re){return new $(V.NO_DB,"NO_DB",re)},$.newDBError=function(re){return new $(V.DB,"DB",re)},$.newUnknownError=function(re){var oe="Error_Unknown";return new $(V[oe],oe,re)},$.stillInTeamError=function(re){var oe="Still_In_Team";return new $(V[oe],oe,re)},$.sessionExist=function(re){var oe="Session_Exist";return new $(V[oe],oe,re)},$.sessionNotExist=function(re){var oe="Session_Not_Exist";return new $(V[oe],oe,re)},$.cancel=function(re){var oe="Operation_Canceled";return new $(V[oe],oe,re)},$.syncError=function(re){return new $(V.Sync_Error,"Sync_Error",re)},$.customError=function(re,oe){re=re||"Other_Error";var le="";return(oe=oe||{}).message||(le=V[re]||re),k(re)!=="object"?new $(le,re,oe):new $(le,"Other_Error",oe===void 0?re:oe)},t.exports=$,t.exports.formatError=function(re,oe){var le,ue=oe||{},ie=ue.fallbackCode,ae=ue.fallbackMessage,Ie=ue.suffix;if(re instanceof $){var de,Ce;return y(de=re.message).call(de,Ie)||(re.message=i(Ce="".concat(re.message," ")).call(Ce,Ie||"")),re}if(re.code!==void 0&&re.message!==void 0)return re.message=i(le="".concat(re.message," ")).call(le,Ie||""),re;var Ue=re.code||re.errCode||(ie===void 0?"Error_Unknown":ie);return new $((L.get(re,"message")||L.get(re,"Message")||L.get(re,"errMsg")||L.get(re,"status")||L.get(re,"result")||ae||V[Ue]||"未知错误")+" "+(Ie||""),Ue,re)}},function(t,r,e){var n=e(166),g=e(32),y=e(111),i=n(n.bind);t.exports=function(k,L){return g(k),L===void 0?k:y?i(k,L):function(){return k.apply(L,arguments)}}},function(t,r,e){var n=e(19),g=e(23),y=e(3),i=e(79),k=e(82),L=e(12),$=e(0),V=e(297),z=$.undef,re=e(317),oe=e(156),le=e(161),ue=e(811),ie=e(812);function ae(Ce){var Ue,qe,jt,Fe=this;$.verifyOptions(Ce,"appKey account token","protocol::IMProtocol"),$.verifyCallback(Ce,["onconnect","onerror","onwillreconnect","ondisconnect","onloginportschange","onmyinfo","onblacklist","onmutelist","onfriends","onusers","onrobots","onteams","onSuperTeams","onsessions","onSessionsWithMoreRoaming","onStickTopSessions","onroamingmsgs","onofflinemsgs","onofflinefiltermsgs","onroamingsysmsgs","onofflinesysmsgs","onofflinefiltersysmsgs","onofflinecustomsysmsgs","onofflinefiltercustomsysmsgs","onbroadcastmsg","onbroadcastmsgs","onsysmsgunread","onsyncdone","onteammembers","onsyncteammembersdone","onsyncsuperteammembersdone","onmsg","onsysmsg","oncustomsysmsg","onupdatemyinfo","onupdateuser","onSyncUpdateServerSession","onUpdateSuperTeamMember","onMySuperTeamMembers","onCreateSuperTeam","onUpdateSuperTeam","onAddSuperTeamMembers","onRemoveSuperTeamMembers","onUpdateSuperTeamManagers","onDismissSuperTeam","onTransferSuperTeam","onUpdateSuperTeamMembersMute","onupdateteammember","onMyTeamMembers","onMsgReceipts","onCreateTeam","onUpdateTeam","onAddTeamMembers","onRemoveTeamMembers","onUpdateTeamManagers","onDismissTeam","onTransferTeam","onUpdateTeamMembersMute","onTeamMsgReceipt","onupdatesession","onQuickComment","onDeleteQuickComment","onPinMsgChange","onupdatesysmsgunread","onupdatesysmsg","onsynccreateteam","onsyncsupercreateteam","onsyncmarkinblacklist","onsyncmarkinmutelist","onsyncfriendaction","shouldIgnoreNotification","shouldIgnoreMsg","onDeleteMsgSelf","shouldCountNotifyUnread","onPushNotificationMultiportConfig","onPushNotificationMultiportConfigUpdate","onpushevents"],"protocol::IMProtocol"),Ue=typeof $.get(Ce,"privateConf.isDataReportEnable")=="boolean"?Ce.privateConf.isDataReportEnable:L.privateConf.isDataReportEnable,qe=typeof $.get(Ce,"privateConf.reportConfigUrl")=="string"?Ce.privateConf.reportConfigUrl:L.privateConf.reportConfigUrl,jt=typeof $.get(Ce,"privateConf.reportUrl")=="string"?Ce.privateConf.reportUrl:L.privateConf.reportUrl,Fe.reporter=V.initReporter({isDataReportEnable:Ue,reportConfigUrl:qe,reportUrl:jt,appKey:Ce.appKey,logger:Fe.logger}),Fe.db=Ce.api.db=new i({logger:Ce.logger,reporter:Fe.reporter,account:Ce.account,core:Fe,notifyError:function(Et){Fe.notifyError&&Fe.notifyError("DB error",Et)}}),this.processId=$.guid(),k.call(Fe,Ce)}var Ie=k.fn,de=ae.fn=ae.prototype=n(Ie);de.init=function(){var Ce,Ue,qe;Ie.init.call(this),oe.IM.setProtocol(this),this.parser=oe.IM,g(Ce=this.sendCmd).call(Ce,this),this.socketUrls=[],this.syncing=!0,this.canHandleDeletedMsgInSyncing=!1,this.hasSynced=!1,this.hasSyncedTeamMembers=!1,this.syncPromiseArray=[],this.syncResult={},this.syncTeamMembersPromiseArray=[],this.syncSuperTeamMembersPromiseArray=[],this.syncTeamMembersResult={},this.syncSuperTeamMembersResult={},this.timetags={},this.superTeamMembersData={},this.saveAck={},this.sysMsgUnread=le.completeUnread({}),this.resetUnsettledMsgs(),this.resetUnsettledSysMsgs(),this.msgPromise=y.resolve(),this.sysMsgPromise=y.resolve(),this.msgDelayArr=[],this.msgDelayTimer=null,this.msgStatEnable=!1,this.nosCdnHostTimer=null,this.relativeServerTime=0,this.sessionSet={},this.msgReceiptTasks={},this.userSet={},this.pushNotificationMultiportConfig=re.getDefaultConfig(),this.msgAckBufferManager=new ue({processFn:g(Ue=this.handleMsgsAck).call(Ue,this),throttleTime:500}),this.roamingMsgSyncDoneBufferManager=new ue({processFn:g(qe=this.onSyncDone).call(qe,this),throttleTime:1500}),this.reporterHookLBS=new ie(this)},de.reset=function(){Ie.reset.call(this);var Ce=this.options;this.db.reset(Ce.db),z(Ce.lbsUrl)&&(Ce.lbsUrl=L.lbsUrl),this.autoconnect=!!Ce.autoconnect,this.resetAutoMarkRead()},de.resetAutoMarkRead=function(){var Ce=this.options;$.verifyBooleanWithDefault(Ce,"autoMarkRead",!0,"","protocol::resetAutoMarkRead")},de.resetUnsettledMsgs=function(){this.unhandledMsgs=[],this.unupdatedMsgs=[]},de.resetUnsettledSysMsgs=function(){this.unhandledSysMsgs=[],this.unhandledSysMsgsForDeletedMsgs=[],this.unupdatedSysMsgs=[]},de.packetFromSync=function(Ce){return!Ce.obj||!!Ce.obj.sync},t.exports=ae,e(813),e(814),e(815),e(833),e(835),e(836),e(837),e(838),e(839),e(840),e(841),e(846),e(847),e(848),e(849),e(850),e(851),e(852),e(853),e(854),e(855)},function(t,r,e){var n=e(30),g=String,y=TypeError;t.exports=function(i){if(n(i))return i;throw y(g(i)+" is not an object")}},function(t,r,e){var n=e(85);t.exports=function(g){if(typeof g=="object"&&"size"in g&&"has"in g&&"get"in g&&"set"in g&&"delete"in g&&"entries"in g)return g;throw TypeError(n(g)+" is not a map")}},function(t,r,e){var n=e(29),g=e(214),y=e(216),i=e(38),k=e(130),L=TypeError,$=Object.defineProperty,V=Object.getOwnPropertyDescriptor;r.f=n?y?function(z,re,oe){if(i(z),re=k(re),i(oe),typeof z=="function"&&re==="prototype"&&"value"in oe&&"writable"in oe&&!oe.writable){var le=V(z,re);le&&le.writable&&(z[re]=oe.value,oe={configurable:"configurable"in oe?oe.configurable:le.configurable,enumerable:"enumerable"in oe?oe.enumerable:le.enumerable,writable:!1})}return $(z,re,oe)}:$:function(z,re,oe){if(i(z),re=k(re),i(oe),g)try{return $(z,re,oe)}catch{}if("get"in oe||"set"in oe)throw L("Accessors not supported");return"value"in oe&&(z[re]=oe.value),z}},function(t,r,e){var n=e(19),g=e(81),y=e(37),i=e(12),k=e(856),L=e(156).IM,$=e(164);function V(re){var oe=$(re);return this.subType="im",this.nosScene=oe.nosScene||"im",this.nosSurvivalTime=oe.nosSurvivalTime,oe.Protocol=y,oe.Message=k,oe.constructor=V,this.init(oe)}V.Protocol=y,V.parser=L,V.use=g.use,V.getInstance=g.getInstance,V.rmAllInstances=g.rmAllInstances,V.genInstanceName=function(re){return"NIM-account-"+re.account};var z=V.fn=V.prototype=n(g.prototype);V.info=z.info=i.info,t.exports=V,e(867),e(868),e(869),e(870),e(871),e(872),e(873),e(874),e(875),e(885),e(896),e(897),e(898),e(899),e(900),e(901),e(902),e(903),e(904),e(907),e(908)},function(t,r,e){t.exports=e(255)},function(t,r,e){t.exports=e(569)},function(t,r){t.exports=function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,r,e){var n=e(142),g=e(256);function y(i,k){for(var L=0;L<k.length;L++){var $=k[L];$.enumerable=$.enumerable||!1,$.configurable=!0,"value"in $&&($.writable=!0),n(i,g($.key),$)}}t.exports=function(i,k,L){return k&&y(i.prototype,k),L&&y(i,L),n(i,"prototype",{writable:!1}),i},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,r,e){var n=e(112),g=Object;t.exports=function(y){return g(n(y))}},function(t,r,e){var n=e(129),g=e(112);t.exports=function(y){return n(g(y))}},function(t,r,e){var n=e(0),g={init:function(){g.deviceId=n.guid()}};g.init(),g.clientTypeMap={1:"Android",2:"iOS",4:"PC",8:"WindowsPhone",16:"Web",32:"Server",64:"Mac",65:"HarmonyOS"},g.db={open:function(){}},g.rnfs=null,t.exports=g},function(t,r,e){var n=e(329);t.exports=function(g){return n(g.length)}},function(t,r,e){var n=e(36),g=e(20),y=e(38),i=e(85),k=e(241),L=e(49),$=e(18),V=e(242),z=e(140),re=e(243),oe=TypeError,le=function(ie,ae){this.stopped=ie,this.result=ae},ue=le.prototype;t.exports=function(ie,ae,Ie){var de,Ce,Ue,qe,jt,Fe,Et,cr=Ie&&Ie.that,er=!(!Ie||!Ie.AS_ENTRIES),nr=!(!Ie||!Ie.IS_RECORD),dr=!(!Ie||!Ie.IS_ITERATOR),ir=!(!Ie||!Ie.INTERRUPTED),tr=n(ae,cr),ur=function(fr){return de&&re(de,"normal",fr),new le(!0,fr)},or=function(fr){return er?(y(fr),ir?tr(fr[0],fr[1],ur):tr(fr[0],fr[1])):ir?tr(fr,ur):tr(fr)};if(nr)de=ie.iterator;else if(dr)de=ie;else{if(!(Ce=z(ie)))throw oe(i(ie)+" is not iterable");if(k(Ce)){for(Ue=0,qe=L(ie);qe>Ue;Ue++)if((jt=or(ie[Ue]))&&$(ue,jt))return jt;return new le(!1)}de=V(ie,Ce)}for(Fe=nr?ie.next:de.next;!(Et=g(Fe,de)).done;){try{jt=or(Et.value)}catch(fr){re(de,"throw",fr)}if(typeof jt=="object"&&jt&&$(ue,jt))return jt}return new le(!1)}},function(t,r,e){var n=e(142),g=e(256);t.exports=function(y,i,k){return(i=g(i))in y?n(y,i,{value:k,enumerable:!0,configurable:!0,writable:!0}):y[i]=k,y},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,r,e){t.exports=e(262)},function(t,r,e){t.exports=e(487)},function(t,r,e){t.exports=e(490)},function(t,r,e){t.exports=e(493)},function(t,r,e){t.exports=e(591)},function(t,r){t.exports=!0},function(t,r,e){var n=e(73),g=String;t.exports=function(y){if(n(y)==="Symbol")throw TypeError("Cannot convert a Symbol value to a string");return g(y)}},function(t,r,e){var n=e(265),g=typeof self=="object"&&self&&self.Object===Object&&self,y=n||g||Function("return this")();t.exports=y},function(t,r,e){var n=e(657)();t.exports=n;try{regeneratorRuntime=n}catch{typeof globalThis=="object"?globalThis.regeneratorRuntime=n:Function("r","regeneratorRuntime = r")(n)}},function(t,r,e){var n=e(292);function g(y,i,k,L,$,V,z){try{var re=y[V](z),oe=re.value}catch(le){return void k(le)}re.done?i(oe):n.resolve(oe).then(L,$)}t.exports=function(y){return function(){var i=this,k=arguments;return new n(function(L,$){var V=y.apply(i,k);function z(oe){g(V,L,$,z,re,"next",oe)}function re(oe){g(V,L,$,z,re,"throw",oe)}z(void 0)})}},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,r,e){var n=e(752);t.exports=function(g,y,i){return i?n(g.entries(),function(k){return y(k[1],k[0])}):g.forEach(y)}},function(t,r,e){t.exports=e(433)},function(t,r,e){t.exports=e(481)},function(t,r,e){var n=e(29),g=e(40),y=e(84);t.exports=n?function(i,k,L){return g.f(i,k,y(1,L))}:function(i,k,L){return i[k]=L,i}},function(t,r,e){(function(n){var g=e(9),y=e(22),i=e(8),k=e(144),L=e(2),$=e(6),V=e(5),z=e(143),re=e(3),oe=e(68),le=e(78),ue=e(64),ie=e(28);function ae(br,hr){var Tr=le!==void 0&&ue(br)||br["@@iterator"];if(!Tr){if(ie(br)||(Tr=function(Qr,vn){var _n;if(Qr){if(typeof Qr=="string")return Ie(Qr,vn);var Yr=g(_n=Object.prototype.toString.call(Qr)).call(_n,8,-1);if(Yr==="Object"&&Qr.constructor&&(Yr=Qr.constructor.name),Yr==="Map"||Yr==="Set")return oe(Qr);if(Yr==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(Yr))return Ie(Qr,vn)}}(br))||hr&&br&&typeof br.length=="number"){Tr&&(br=Tr);var Br=0,Fr=function(){};return{s:Fr,n:function(){return Br>=br.length?{done:!0}:{done:!1,value:br[Br++]}},e:function(Qr){throw Qr},f:Fr}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var Lr,qr=!0,Ur=!1;return{s:function(){Tr=Tr.call(br)},n:function(){var Qr=Tr.next();return qr=Qr.done,Qr},e:function(Qr){Ur=!0,Lr=Qr},f:function(){try{qr||Tr.return==null||Tr.return()}finally{if(Ur)throw Lr}}}}function Ie(br,hr){(hr==null||hr>br.length)&&(hr=br.length);for(var Tr=0,Br=new Array(hr);Tr<hr;Tr++)Br[Tr]=br[Tr];return Br}var de=e(164);function Ce(){return typeof window<"u"?window:n!==void 0?n:typeof self<"u"?self:{}}function Ue(br){var hr;return g(hr=Object.prototype.toString.call(br)).call(hr,8,-1)}function qe(br){return Ue(br).toLowerCase()}function jt(br){return qe(br)==="string"}function Fe(br){return qe(br)==="number"}function Et(br){return qe(br)==="array"}function cr(br){return typeof br=="function"}function er(br){return qe(br)==="date"}function nr(br){return br===null}function dr(br){return br!==null}function ir(br){return br===void 0}function tr(br){return br!==void 0}function ur(br){return tr(br)&&dr(br)}function or(br){return ir(br)||nr(br)}function fr(br){return ur(br)&&qe(br)==="object"}var lr=function(br,hr,Tr){br.addEventListener?br.addEventListener(hr,Tr,!1):br.attachEvent&&br.attachEvent("on"+hr,Tr)},gr=lr,Sr=function(br,hr,Tr){br.removeEventListener?br.removeEventListener(hr,Tr,!1):br.detachEvent&&br.detachEvent("on"+hr,Tr)},wr=Sr;function kr(){var br=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},hr=arguments.length>1&&arguments[1]!==void 0?arguments[1]:function(){},Tr=arguments.length>2?arguments[2]:void 0;for(var Br in br)br.hasOwnProperty(Br)&&hr.call(Tr,Br,br[Br])}function mr(br,hr){kr(hr,function(Tr,Br){br[Tr]=Br})}var Ir,Nr=(Ir=0,function(){return""+Ir++});function Er(br){return jt(br)&&i(br).call(br,"{")===0&&k(br).call(br,"}")===br.length-1}function sr(br,hr,Tr){if(!br)return"";var Br=[];return kr(br,function(Fr,Lr){cr(Lr)||(er(Lr)?Lr=Lr.getTime():Et(Lr)?Lr=Lr.join(","):fr(Lr)&&(Lr=$(Lr)),Tr&&(Lr=encodeURIComponent(Lr)),Br.push(encodeURIComponent(Fr)+"="+Lr))}),Br.join(hr||",")}var xr,Or=(xr=/^([\w]+?:\/\/.*?(?=\/|$))/i,function(br){return xr.test(br||"")?RegExp.$1.toLowerCase():""});function Mr(br){var hr=Ce();return br.tagName&&br.tagName.toUpperCase()==="INPUT"||hr.Blob&&br instanceof hr.Blob}t.exports={o:{},emptyObj:{},f:function(){},emptyFunc:function(){},regBlank:/\s+/gi,regWhiteSpace:/\s+/gi,getGlobal:Ce,getClass:Ue,typeOf:qe,isString:jt,isNumber:Fe,isInt:function(br){return Fe(br)&&br%1==0},isBoolean:function(br){return qe(br)==="boolean"},isArray:Et,isFunction:cr,isDate:er,isRegExp:function(br){return qe(br)==="regexp"},isError:function(br){return qe(br)==="error"},isnull:nr,notnull:dr,undef:ir,notundef:tr,exist:ur,notexist:or,isObject:fr,isEmpty:function(br){return or(br)||(jt(br)||Et(br))&&br.length===0},remove:function(br){br.parentNode&&br.parentNode.removeChild(br)},dataset:function(br,hr,Tr){if(!ur(Tr))return br.getAttribute("data-"+hr);br.setAttribute("data-"+hr,Tr)},addEventListener:lr,on:gr,removeEventListener:Sr,off:wr,target:function(br){return br.target||br.srcElement},createIframe:function(br){if(typeof document<"u"){var hr;if((br=br||{}).name)try{(hr=document.createElement('<iframe name="'+br.name+'"></iframe>')).frameBorder=0}catch{(hr=document.createElement("iframe")).name=br.name}else hr=document.createElement("iframe");br.visible||(hr.style.display="none"),cr(br.onload)&&gr(hr,"load",function Br(Fr){hr.src&&(br.multi||wr(hr,"load",Br),br.onload(Fr))}),(br.parent||document.body).appendChild(hr);var Tr=br.src||"about:blank";return y(function(){hr.src=Tr},0),hr}},html2node:function(br){if(typeof document<"u"){var hr=document.createElement("div");hr.innerHTML=br;var Tr,Br,Fr=[];if(hr.children)for(Tr=0,Br=hr.children.length;Tr<Br;Tr++)Fr.push(hr.children[Tr]);else for(Tr=0,Br=hr.childNodes.length;Tr<Br;Tr++){var Lr=hr.childNodes[Tr];Lr.nodeType===1&&Fr.push(Lr)}return Fr.length>1?hr:Fr[0]}},forOwn:kr,mixin:mr,uniqueID:Nr,isJSON:Er,parseJSON:function br(hr){try{Er(hr)&&(hr=JSON.parse(hr)),fr(hr)&&kr(hr,function(Tr,Br){switch(qe(Br)){case"string":case"object":hr[Tr]=br(Br)}})}catch{}return hr},simpleClone:function(br){return de(br)},merge:function(){for(var br=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},hr=arguments.length,Tr=new Array(hr>1?hr-1:0),Br=1;Br<hr;Br++)Tr[Br-1]=arguments[Br];return L(Tr).call(Tr,function(Fr){mr(br,Fr)}),br},fillUndef:function(br,hr){return kr(hr,function(Tr,Br){ir(br[Tr])&&(br[Tr]=Br)}),br},checkWithDefault:function(br,hr,Tr){var Br=br[hr]||br[hr.toLowerCase()];return or(Br)&&(Br=Tr,br[hr]=Br),Br},fetch:function(br,hr){return kr(br,function(Tr){ur(hr[Tr])&&(br[Tr]=hr[Tr])}),br},string2object:function(){var br,hr=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",Tr=arguments.length>1&&arguments[1]!==void 0?arguments[1]:",",Br={};return L(br=hr.split(Tr)).call(br,function(Fr){var Lr=Fr.split("="),qr=Lr.shift();qr&&(Br[decodeURIComponent(qr)]=decodeURIComponent(Lr.join("=")))}),Br},object2string:sr,genUrlSep:function(br){return i(br).call(br,"?")<0?"?":"&"},object2query:function(br){return sr(br,"&",!0)},url2origin:Or,isFileInput:Mr,getKeys:function(br,hr){var Tr=V(br);return hr&&z(Tr).call(Tr,function(Br,Fr){var Lr=Mr(br[Br]);return Lr===Mr(br[Fr])?0:Lr?1:-1}),Tr},_get:function(br,hr){var Tr,Br=arguments.length>2&&arguments[2]!==void 0?arguments[2]:void 0,Fr=hr.replace(/\[(\d+)\]/g,".$1").split("."),Lr=br,qr=ae(Fr);try{for(qr.s();!(Tr=qr.n()).done;){var Ur=Tr.value;if((Lr=Object(Lr)[Ur])===void 0)return Br}}catch(Qr){qr.e(Qr)}finally{qr.f()}return Lr},getPromiseWithAbort:function(br){var hr={},Tr=new re(function(Br,Fr){hr.abort=Fr});return hr.promise=re.race([br,Tr]),hr}}}).call(this,e(77))},function(t,r,e){var n=e(33),g=e(749),y=n("Map");t.exports={Map:y,set:g("set",2),get:g("get",1),has:g("has",1),remove:g("delete",1),proto:y.prototype}},function(t,r,e){t.exports=e(261)},function(t,r,e){var n=e(36),g=e(13),y=e(129),i=e(46),k=e(49),L=e(171),$=g([].push),V=function(z){var re=z==1,oe=z==2,le=z==3,ue=z==4,ie=z==6,ae=z==7,Ie=z==5||ie;return function(de,Ce,Ue,qe){for(var jt,Fe,Et=i(de),cr=y(Et),er=n(Ce,Ue),nr=k(cr),dr=0,ir=qe||L,tr=re?ir(de,nr):oe||ae?ir(de,0):void 0;nr>dr;dr++)if((Ie||dr in cr)&&(Fe=er(jt=cr[dr],dr,Et),z))if(re)tr[dr]=Fe;else if(Fe)switch(z){case 3:return!0;case 5:return jt;case 6:return dr;case 2:$(tr,jt)}else switch(z){case 4:return!1;case 7:$(tr,jt)}return ie?-1:le||ue?ue:tr}};t.exports={forEach:V(0),map:V(1),filter:V(2),some:V(3),every:V(4),find:V(5),findIndex:V(6),filterReject:V(7)}},function(t,r,e){(function(n){var g=e(9),y=e(8),i=e(307),k=e(43),L=e(24),$=function(){var V=(n===void 0?"undefined":L(n))==="object"?n:window,z=Math.pow(2,53)-1,re=/\bOpera/,oe=Object.prototype,le=oe.hasOwnProperty,ue=oe.toString;function ie(jt){return(jt=String(jt)).charAt(0).toUpperCase()+g(jt).call(jt,1)}function ae(jt){return jt=qe(jt),/^(?:webOS|i(?:OS|P))/.test(jt)?jt:ie(jt)}function Ie(jt,Fe){for(var Et in jt)le.call(jt,Et)&&Fe(jt[Et],Et,jt)}function de(jt){var Fe;return jt==null?ie(jt):g(Fe=ue.call(jt)).call(Fe,8,-1)}function Ce(jt){return String(jt).replace(/([ -])(?!$)/g,"$1?")}function Ue(jt,Fe){var Et=null;return function(cr,er){var nr=-1,dr=cr?cr.length:0;if(typeof dr=="number"&&dr>-1&&dr<=z)for(;++nr<dr;)er(cr[nr],nr,cr);else Ie(cr,er)}(jt,function(cr,er){Et=Fe(Et,cr,er,jt)}),Et}function qe(jt){return String(jt).replace(/^ +| +$/g,"")}return function jt(Fe){var Et=V,cr=Fe&&L(Fe)==="object"&&de(Fe)!="String";cr&&(Et=Fe,Fe=null);var er=Et.navigator||{},nr=er.userAgent||"";Fe||(Fe=nr);var dr,ir,tr,ur,or,fr=cr?!!er.likeChrome:/\bChrome\b/.test(Fe)&&!/internal|\n/i.test(ue.toString()),lr=cr?"Object":"ScriptBridgingProxyObject",gr=cr?"Object":"Environment",Sr=cr&&Et.java?"JavaPackage":de(Et.java),wr=cr?"Object":"RuntimeObject",kr=/\bJava/.test(Sr)&&Et.java,mr=kr&&de(Et.environment)==gr,Ir=kr?"a":"α",Nr=kr?"b":"β",Er=Et.document||{},sr=Et.operamini||Et.opera,xr=re.test(xr=cr&&sr?sr["[[Class]]"]:de(sr))?xr:sr=null,Or=Fe,Mr=[],br=null,hr=Fe==nr,Tr=hr&&sr&&typeof sr.version=="function"&&sr.version(),Br=Ue([{label:"EdgeHTML",pattern:"Edge"},"Trident",{label:"WebKit",pattern:"AppleWebKit"},"iCab","Presto","NetFront","Tasman","KHTML","Gecko"],function(jn,Zr){return jn||RegExp("\\b"+(Zr.pattern||Ce(Zr))+"\\b","i").exec(Fe)&&(Zr.label||Zr)}),Fr=function(jn){return Ue(jn,function(Zr,An){return Zr||RegExp("\\b"+(An.pattern||Ce(An))+"\\b","i").exec(Fe)&&(An.label||An)})}(["Adobe AIR","Arora","Avant Browser","Breach","Camino","Electron","Epiphany","Fennec","Flock","Galeon","GreenBrowser","iCab","Iceweasel","K-Meleon","Konqueror","Lunascape","Maxthon",{label:"Microsoft Edge",pattern:"Edge"},"Midori","Nook Browser","PaleMoon","PhantomJS","Raven","Rekonq","RockMelt",{label:"Samsung Internet",pattern:"SamsungBrowser"},"SeaMonkey",{label:"Silk",pattern:"(?:Cloud9|Silk-Accelerated)"},"Sleipnir","SlimBrowser",{label:"SRWare Iron",pattern:"Iron"},"Sunrise","Swiftfox","Waterfox","WebPositive","Opera Mini",{label:"Opera Mini",pattern:"OPiOS"},"Opera",{label:"Opera",pattern:"OPR"},"Chrome",{label:"Chrome",pattern:"(?:HeadlessChrome)"},{label:"Chrome Mobile",pattern:"(?:CriOS|CrMo)"},{label:"Firefox",pattern:"(?:Firefox|Minefield)"},{label:"Firefox for iOS",pattern:"FxiOS"},{label:"IE",pattern:"IEMobile"},{label:"IE",pattern:"MSIE"},"Safari"]),Lr=Qr([{label:"BlackBerry",pattern:"BB10"},"BlackBerry",{label:"Galaxy S",pattern:"GT-I9000"},{label:"Galaxy S2",pattern:"GT-I9100"},{label:"Galaxy S3",pattern:"GT-I9300"},{label:"Galaxy S4",pattern:"GT-I9500"},{label:"Galaxy S5",pattern:"SM-G900"},{label:"Galaxy S6",pattern:"SM-G920"},{label:"Galaxy S6 Edge",pattern:"SM-G925"},{label:"Galaxy S7",pattern:"SM-G930"},{label:"Galaxy S7 Edge",pattern:"SM-G935"},"Google TV","Lumia","iPad","iPod","iPhone","Kindle",{label:"Kindle Fire",pattern:"(?:Cloud9|Silk-Accelerated)"},"Nexus","Nook","PlayBook","PlayStation Vita","PlayStation","TouchPad","Transformer",{label:"Wii U",pattern:"WiiU"},"Wii","Xbox One",{label:"Xbox 360",pattern:"Xbox"},"Xoom"]),qr=function(jn){return Ue(jn,function(Zr,An,Jr){return Zr||(An[Lr]||An[/^[a-z]+(?: +[a-z]+\b)*/i.exec(Lr)]||RegExp("\\b"+Ce(Jr)+"(?:\\b|\\w*\\d)","i").exec(Fe))&&Jr})}({Apple:{iPad:1,iPhone:1,iPod:1},Archos:{},Amazon:{Kindle:1,"Kindle Fire":1},Asus:{Transformer:1},"Barnes & Noble":{Nook:1},BlackBerry:{PlayBook:1},Google:{"Google TV":1,Nexus:1},HP:{TouchPad:1},HTC:{},LG:{},Microsoft:{Xbox:1,"Xbox One":1},Motorola:{Xoom:1},Nintendo:{"Wii U":1,Wii:1},Nokia:{Lumia:1},Samsung:{"Galaxy S":1,"Galaxy S2":1,"Galaxy S3":1,"Galaxy S4":1},Sony:{PlayStation:1,"PlayStation Vita":1}}),Ur=function(jn){return Ue(jn,function(Zr,An){var Jr=An.pattern||Ce(An);return!Zr&&(Zr=RegExp("\\b"+Jr+"(?:/[\\d.]+|[ \\w.]*)","i").exec(Fe))&&(Zr=function(Mn,Bn,wn){var In={"10.0":"10",6.4:"10 Technical Preview",6.3:"8.1",6.2:"8",6.1:"Server 2008 R2 / 7","6.0":"Server 2008 / Vista",5.2:"Server 2003 / XP 64-bit",5.1:"XP",5.01:"2000 SP1","5.0":"2000","4.0":"NT","4.90":"ME"};return Bn&&wn&&/^Win/i.test(Mn)&&!/^Windows Phone /i.test(Mn)&&(In=In[/[\d.]+$/.exec(Mn)])&&(Mn="Windows "+In),Mn=String(Mn),Bn&&wn&&(Mn=Mn.replace(RegExp(Bn,"i"),wn)),Mn=ae(Mn.replace(/ ce$/i," CE").replace(/\bhpw/i,"web").replace(/\bMacintosh\b/,"Mac OS").replace(/_PowerPC\b/i," OS").replace(/\b(OS X) [^ \d]+/i,"$1").replace(/\bMac (OS X)\b/,"$1").replace(/\/(\d)/," $1").replace(/_/g,".").replace(/(?: BePC|[ .]*fc[ \d.]+)$/i,"").replace(/\bx86\.64\b/gi,"x86_64").replace(/\b(Windows Phone) OS\b/,"$1").replace(/\b(Chrome OS \w+) [\d.]+\b/,"$1").split(" on ")[0])}(Zr,Jr,An.label||An)),Zr})}(["Windows Phone","Android","CentOS",{label:"Chrome OS",pattern:"CrOS"},"Debian","Fedora","FreeBSD","Gentoo","Haiku","Kubuntu","Linux Mint","OpenBSD","Red Hat","SuSE","Ubuntu","Xubuntu","Cygwin","Symbian OS","hpwOS","webOS ","webOS","Tablet OS","Tizen","Linux","Mac OS X","Macintosh","Mac","Windows 98;","Windows "]);function Qr(jn){return Ue(jn,function(Zr,An){var Jr=An.pattern||Ce(An);return!Zr&&(Zr=RegExp("\\b"+Jr+" *\\d+[.\\w_]*","i").exec(Fe)||RegExp("\\b"+Jr+" *\\w+-[\\w]*","i").exec(Fe)||RegExp("\\b"+Jr+"(?:; *(?:[a-z]+[_-])?[a-z]+\\d+|[^ ();-]*)","i").exec(Fe))&&((Zr=String(An.label&&!RegExp(Jr,"i").test(An.label)?An.label:Zr).split("/"))[1]&&!/[\d.]+/.test(Zr[0])&&(Zr[0]+=" "+Zr[1]),An=An.label||An,Zr=ae(Zr[0].replace(RegExp(Jr,"i"),An).replace(RegExp("; *(?:"+An+"[_-])?","i")," ").replace(RegExp("("+An+")[-_.]?(\\w)","i"),"$1 $2"))),Zr})}if(Br&&(Br=[Br]),qr&&!Lr&&(Lr=Qr([qr])),(dr=/\bGoogle TV\b/.exec(Lr))&&(Lr=dr[0]),/\bSimulator\b/i.test(Fe)&&(Lr=(Lr?Lr+" ":"")+"Simulator"),Fr=="Opera Mini"&&/\bOPiOS\b/.test(Fe)&&Mr.push("running in Turbo/Uncompressed mode"),Fr=="IE"&&/\blike iPhone OS\b/.test(Fe)?(qr=(dr=jt(Fe.replace(/like iPhone OS/,""))).manufacturer,Lr=dr.product):/^iP/.test(Lr)?(Fr||(Fr="Safari"),Ur="iOS"+((dr=/ OS ([\d_]+)/i.exec(Fe))?" "+dr[1].replace(/_/g,"."):"")):Fr!="Konqueror"||/buntu/i.test(Ur)?qr&&qr!="Google"&&(/Chrome/.test(Fr)&&!/\bMobile Safari\b/i.test(Fe)||/\bVita\b/.test(Lr))||/\bAndroid\b/.test(Ur)&&/^Chrome/.test(Fr)&&/\bVersion\//i.test(Fe)?(Fr="Android Browser",Ur=/\bAndroid\b/.test(Ur)?Ur:"Android"):Fr=="Silk"?(/\bMobi/i.test(Fe)||(Ur="Android",Mr.unshift("desktop mode")),/Accelerated *= *true/i.test(Fe)&&Mr.unshift("accelerated")):Fr=="PaleMoon"&&(dr=/\bFirefox\/([\d.]+)\b/.exec(Fe))?Mr.push("identifying as Firefox "+dr[1]):Fr=="Firefox"&&(dr=/\b(Mobile|Tablet|TV)\b/i.exec(Fe))?(Ur||(Ur="Firefox OS"),Lr||(Lr=dr[1])):!Fr||(dr=!/\bMinefield\b/i.test(Fe)&&/\b(?:Firefox|Safari)\b/.exec(Fr))?(Fr&&!Lr&&/[\/,]|^[^(]+?\)/.test(g(Fe).call(Fe,y(Fe).call(Fe,dr+"/")+8))&&(Fr=null),(dr=Lr||qr||Ur)&&(Lr||qr||/\b(?:Android|Symbian OS|Tablet OS|webOS)\b/.test(Ur))&&(Fr=/[a-z]+(?: Hat)?/i.exec(/\bAndroid\b/.test(Ur)?Ur:dr)+" Browser")):Fr=="Electron"&&(dr=(/\bChrome\/([\d.]+)\b/.exec(Fe)||0)[1])&&Mr.push("Chromium "+dr):Ur="Kubuntu",Tr||(Tr=Ue(["(?:Cloud9|CriOS|CrMo|Edge|FxiOS|IEMobile|Iron|Opera ?Mini|OPiOS|OPR|Raven|SamsungBrowser|Silk(?!/[\\d.]+$))","Version","HeadlessChrome",Ce(Fr),"(?:Firefox|Minefield|NetFront)"],function(jn,Zr){return jn||(RegExp(Zr+"(?:-[\\d.]+/|(?: for [\\w-]+)?[ /-])([\\d.]+[^ ();/_-]*)","i").exec(Fe)||0)[1]||null})),(dr=(Br=="iCab"&&i(Tr)>3?"WebKit":/\bOpera\b/.test(Fr)&&(/\bOPR\b/.test(Fe)?"Blink":"Presto"))||/\b(?:Midori|Nook|Safari)\b/i.test(Fe)&&!/^(?:Trident|EdgeHTML)$/.test(Br)&&"WebKit"||!Br&&/\bMSIE\b/i.test(Fe)&&(Ur=="Mac OS"?"Tasman":"Trident")||Br=="WebKit"&&/\bPlayStation\b(?! Vita\b)/i.test(Fr)&&"NetFront")&&(Br=[dr]),Fr=="IE"&&(dr=(/; *(?:XBLWP|ZuneWP)(\d+)/i.exec(Fe)||0)[1])?(Fr+=" Mobile",Ur="Windows Phone "+(/\+$/.test(dr)?dr:dr+".x"),Mr.unshift("desktop mode")):/\bWPDesktop\b/i.test(Fe)?(Fr="IE Mobile",Ur="Windows Phone 8.x",Mr.unshift("desktop mode"),Tr||(Tr=(/\brv:([\d.]+)/.exec(Fe)||0)[1])):Fr!="IE"&&Br=="Trident"&&(dr=/\brv:([\d.]+)/.exec(Fe))&&(Fr&&Mr.push("identifying as "+Fr+(Tr?" "+Tr:"")),Fr="IE",Tr=dr[1]),hr){if(ur="global",or=(tr=Et)!=null?L(tr[ur]):"number",/^(?:boolean|number|string|undefined)$/.test(or)||or=="object"&&!tr[ur])de(dr=Et.runtime)==lr?(Fr="Adobe AIR",Ur=dr.flash.system.Capabilities.os):de(dr=Et.phantom)==wr?(Fr="PhantomJS",Tr=(dr=dr.version||null)&&dr.major+"."+dr.minor+"."+dr.patch):typeof Er.documentMode=="number"&&(dr=/\bTrident\/(\d+)/i.exec(Fe))?(Tr=[Tr,Er.documentMode],(dr=+dr[1]+4)!=Tr[1]&&(Mr.push("IE "+Tr[1]+" mode"),Br&&(Br[1]=""),Tr[1]=dr),Tr=Fr=="IE"?String(Tr[1].toFixed(1)):Tr[0]):typeof Er.documentMode=="number"&&/^(?:Chrome|Firefox)\b/.test(Fr)&&(Mr.push("masking as "+Fr+" "+Tr),Fr="IE",Tr="11.0",Br=["Trident"],Ur="Windows");else if(kr&&(Or=(dr=kr.lang.System).getProperty("os.arch"),Ur=Ur||dr.getProperty("os.name")+" "+dr.getProperty("os.version")),mr){try{Tr=Et.require("ringo/engine").version.join("."),Fr="RingoJS"}catch{(dr=Et.system)&&dr.global.system==Et.system&&(Fr="Narwhal",Ur||(Ur=dr[0].os||null))}Fr||(Fr="Rhino")}else L(Et.process)==="object"&&!Et.process.browser&&(dr=Et.process)&&(L(dr.versions)==="object"&&(typeof dr.versions.electron=="string"?(Mr.push("Node "+dr.versions.node),Fr="Electron",Tr=dr.versions.electron):typeof dr.versions.nw=="string"&&(Mr.push("Chromium "+Tr,"Node "+dr.versions.node),Fr="NW.js",Tr=dr.versions.nw)),Fr||(Fr="Node.js",Or=dr.arch,Ur=dr.platform,Tr=(Tr=/[\d.]+/.exec(dr.version))?Tr[0]:null));Ur=Ur&&ae(Ur)}if(Tr&&(dr=/(?:[ab]|dp|pre|[ab]\d+pre)(?:\d+\+?)?$/i.exec(Tr)||/(?:alpha|beta)(?: ?\d)?/i.exec(Fe+";"+(hr&&er.appMinorVersion))||/\bMinefield\b/i.test(Fe)&&"a")&&(br=/b/i.test(dr)?"beta":"alpha",Tr=Tr.replace(RegExp(dr+"\\+?$"),"")+(br=="beta"?Nr:Ir)+(/\d+\+?/.exec(dr)||"")),Fr=="Fennec"||Fr=="Firefox"&&/\b(?:Android|Firefox OS)\b/.test(Ur))Fr="Firefox Mobile";else if(Fr=="Maxthon"&&Tr)Tr=Tr.replace(/\.[\d.]+/,".x");else if(/\bXbox\b/i.test(Lr))Lr=="Xbox 360"&&(Ur=null),Lr=="Xbox 360"&&/\bIEMobile\b/.test(Fe)&&Mr.unshift("mobile mode");else if(!/^(?:Chrome|IE|Opera)$/.test(Fr)&&(!Fr||Lr||/Browser|Mobi/.test(Fr))||Ur!="Windows CE"&&!/Mobi/i.test(Fe))if(Fr=="IE"&&hr)try{Et.external===null&&Mr.unshift("platform preview")}catch{Mr.unshift("embedded")}else(/\bBlackBerry\b/.test(Lr)||/\bBB10\b/.test(Fe))&&(dr=(RegExp(Lr.replace(/ +/g," *")+"/([.\\d]+)","i").exec(Fe)||0)[1]||Tr)?(Ur=((dr=[dr,/BB10/.test(Fe)])[1]?(Lr=null,qr="BlackBerry"):"Device Software")+" "+dr[0],Tr=null):this!=Ie&&Lr!="Wii"&&(hr&&sr||/Opera/.test(Fr)&&/\b(?:MSIE|Firefox)\b/i.test(Fe)||Fr=="Firefox"&&/\bOS X (?:\d+\.){2,}/.test(Ur)||Fr=="IE"&&(Ur&&!/^Win/.test(Ur)&&Tr>5.5||/\bWindows XP\b/.test(Ur)&&Tr>8||Tr==8&&!/\bTrident\b/.test(Fe)))&&!re.test(dr=jt.call(Ie,Fe.replace(re,"")+";"))&&dr.name&&(dr="ing as "+dr.name+((dr=dr.version)?" "+dr:""),re.test(Fr)?(/\bIE\b/.test(dr)&&Ur=="Mac OS"&&(Ur=null),dr="identify"+dr):(dr="mask"+dr,Fr=xr?ae(xr.replace(/([a-z])([A-Z])/g,"$1 $2")):"Opera",/\bIE\b/.test(dr)&&(Ur=null),hr||(Tr=null)),Br=["Presto"],Mr.push(dr));else Fr+=" Mobile";if(dr=(/\bAppleWebKit\/([\d.]+\+?)/i.exec(Fe)||0)[1]){var vn,_n;dr=[i(dr.replace(/\.(\d)$/,".0$1")),dr],Fr=="Safari"&&g(vn=dr[1]).call(vn,-1)=="+"?(Fr="WebKit Nightly",br="alpha",Tr=g(_n=dr[1]).call(_n,0,-1)):Tr!=dr[1]&&Tr!=(dr[2]=(/\bSafari\/([\d.]+\+?)/i.exec(Fe)||0)[1])||(Tr=null),dr[1]=(/\b(?:Headless)?Chrome\/([\d.]+)/i.exec(Fe)||0)[1],dr[0]==537.36&&dr[2]==537.36&&i(dr[1])>=28&&Br=="WebKit"&&(Br=["Blink"]),hr&&(fr||dr[1])?(Br&&(Br[1]="like Chrome"),dr=dr[1]||((dr=dr[0])<530?1:dr<532?2:dr<532.05?3:dr<533?4:dr<534.03?5:dr<534.07?6:dr<534.1?7:dr<534.13?8:dr<534.16?9:dr<534.24?10:dr<534.3?11:dr<535.01?12:dr<535.02?"13+":dr<535.07?15:dr<535.11?16:dr<535.19?17:dr<536.05?18:dr<536.1?19:dr<537.01?20:dr<537.11?"21+":dr<537.13?23:dr<537.18?24:dr<537.24?25:dr<537.36?26:Br!="Blink"?"27":"28")):(Br&&(Br[1]="like Safari"),dr=(dr=dr[0])<400?1:dr<500?2:dr<526?3:dr<533?4:dr<534?"4+":dr<535?5:dr<537?6:dr<538?7:dr<601?8:"8"),Br&&(Br[1]+=" "+(dr+=typeof dr=="number"?".x":/[.+]/.test(dr)?"":"+")),Fr=="Safari"&&(!Tr||k(Tr)>45)&&(Tr=dr)}Fr=="Opera"&&(dr=/\bzbov|zvav$/.exec(Ur))?(Fr+=" ",Mr.unshift("desktop mode"),dr=="zvav"?(Fr+="Mini",Tr=null):Fr+="Mobile",Ur=Ur.replace(RegExp(" *"+dr+"$"),"")):Fr=="Safari"&&/\bChrome\b/.exec(Br&&Br[1])&&(Mr.unshift("desktop mode"),Fr="Chrome Mobile",Tr=null,/\bOS X\b/.test(Ur)?(qr="Apple",Ur="iOS 4.3+"):Ur=null),Tr&&y(Tr).call(Tr,dr=/[\d.]+$/.exec(Ur))==0&&y(Fe).call(Fe,"/"+dr+"-")>-1&&(Ur=qe(Ur.replace(dr,""))),Br&&!/\b(?:Avant|Nook)\b/.test(Fr)&&(/Browser|Lunascape|Maxthon/.test(Fr)||Fr!="Safari"&&/^iOS/.test(Ur)&&/\bSafari\b/.test(Br[1])||/^(?:Adobe|Arora|Breach|Midori|Opera|Phantom|Rekonq|Rock|Samsung Internet|Sleipnir|Web)/.test(Fr)&&Br[1])&&(dr=Br[Br.length-1])&&Mr.push(dr),Mr.length&&(Mr=["("+Mr.join("; ")+")"]),qr&&Lr&&y(Lr).call(Lr,qr)<0&&Mr.push("on "+qr),Lr&&Mr.push((/^on /.test(Mr[Mr.length-1])?"":"on ")+Lr),Ur&&(dr=/ ([\d.+]+)$/.exec(Ur),ir=dr&&Ur.charAt(Ur.length-dr[0].length-1)=="/",Ur={architecture:32,family:dr&&!ir?Ur.replace(dr[0],""):Ur,version:dr?dr[1]:null,toString:function(){var jn=this.version;return this.family+(jn&&!ir?" "+jn:"")+(this.architecture==64?" 64-bit":"")}}),(dr=/\b(?:AMD|IA|Win|WOW|x86_|x)64\b/i.exec(Or))&&!/\bi686\b/i.test(Or)?(Ur&&(Ur.architecture=64,Ur.family=Ur.family.replace(RegExp(" *"+dr),"")),Fr&&(/\bWOW64\b/i.test(Fe)||hr&&/\w(?:86|32)$/.test(er.cpuClass||er.platform)&&!/\bWin64; x64\b/i.test(Fe))&&Mr.unshift("32-bit")):Ur&&/^OS X/.test(Ur.family)&&Fr=="Chrome"&&i(Tr)>=39&&(Ur.architecture=64),Fe||(Fe=null);var Yr={};return Yr.description=Fe,Yr.layout=Br&&Br[0],Yr.manufacturer=qr,Yr.name=Fr,Yr.prerelease=br,Yr.product=Lr,Yr.ua=Fe,Yr.version=Fr&&Tr,Yr.os=Ur||{architecture:null,family:null,version:null,toString:function(){return"null"}},Yr.parse=jt,Yr.toString=function(){return this.description||""},Yr.version&&Mr.unshift(Tr),Yr.name&&Mr.unshift(Fr),Ur&&Fr&&(Ur!=String(Ur).split(" ")[0]||Ur!=Fr.split(" ")[0]&&!Lr)&&Mr.push(Lr?"("+Ur+")":"on "+Ur),Mr.length&&(Yr.description=Mr.join(" ")),Yr}()}();t.exports=$}).call(this,e(77))},function(t,r,e){var n=e(13),g=n({}.toString),y=n("".slice);t.exports=function(i){return y(g(i),8,-1)}},function(t,r,e){var n=e(33);t.exports=n("navigator","userAgent")||""},function(t,r,e){var n=e(172),g=e(17),y=e(71),i=e(21)("toStringTag"),k=Object,L=y(function(){return arguments}())=="Arguments";t.exports=n?y:function($){var V,z,re;return $===void 0?"Undefined":$===null?"Null":typeof(z=function(oe,le){try{return oe[le]}catch{}}(V=k($),i))=="string"?z:L?y(V):(re=y(V))=="Object"&&g(V.callee)?"Arguments":re}},function(t,r,e){var n=e(65);t.exports=function(g,y,i,k){return k&&k.enumerable?g[y]=i:n(g,y,i),g}},function(t,r,e){e(90);var n=e(363),g=e(16),y=e(73),i=e(65),k=e(105),L=e(21)("toStringTag");for(var $ in n){var V=g[$],z=V&&V.prototype;z&&y(z)!==L&&i(z,L,$),k[$]=k.Array}},function(t,r,e){var n=e(32),g=TypeError,y=function(i){var k,L;this.promise=new i(function($,V){if(k!==void 0||L!==void 0)throw g("Bad Promise constructor");k=$,L=V}),this.resolve=n(k),this.reject=n(L)};t.exports.f=function(i){return new y(i)}},function(t,r){var e;e=function(){return this}();try{e=e||new Function("return this")()}catch{typeof window=="object"&&(e=window)}t.exports=e},function(t,r,e){t.exports=e(223)},function(t,r,e){var n=e(798);n.fn=n.prototype,t.exports=n,e(800),e(801),e(802),e(803),e(804),e(805),e(806),e(807),e(808),e(809),e(810)},function(t,r,e){var n=e(24),g=e(5),y=e(6),i=e(15),k=e(2),L=e(11),$=e(9),V=e(68),z=e(78),re=e(64),oe=e(28);function le(nr,dr){var ir=z!==void 0&&re(nr)||nr["@@iterator"];if(!ir){if(oe(nr)||(ir=function(gr,Sr){var wr;if(gr){if(typeof gr=="string")return ue(gr,Sr);var kr=$(wr=Object.prototype.toString.call(gr)).call(wr,8,-1);if(kr==="Object"&&gr.constructor&&(kr=gr.constructor.name),kr==="Map"||kr==="Set")return V(gr);if(kr==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(kr))return ue(gr,Sr)}}(nr))||dr&&nr&&typeof nr.length=="number"){ir&&(nr=ir);var tr=0,ur=function(){};return{s:ur,n:function(){return tr>=nr.length?{done:!0}:{done:!1,value:nr[tr++]}},e:function(gr){throw gr},f:ur}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var or,fr=!0,lr=!1;return{s:function(){ir=ir.call(nr)},n:function(){var gr=ir.next();return fr=gr.done,gr},e:function(gr){lr=!0,or=gr},f:function(){try{fr||ir.return==null||ir.return()}finally{if(lr)throw or}}}}function ue(nr,dr){(dr==null||dr>nr.length)&&(dr=nr.length);for(var ir=0,tr=new Array(dr);ir<dr;ir++)tr[ir]=nr[ir];return tr}var ie=e(0),ae=ie.undef,Ie=ie.notundef,de=ie.exist,Ce=e(199),Ue=e(303),qe={p2p:0,team:1,superTeam:5},jt={0:"p2p",1:"team",5:"superTeam"},Fe=g(qe),Et=Ue.typeMap,cr=Ue.validTypes;function er(nr){ie.verifyOptions(nr,"scene to type","msg::Message"),ie.verifyParamValid("scene",nr.scene,Fe,"msg::Message"),this.scene=qe[nr.scene],this.to=""+nr.to,this.type=Et[nr.type],this.resend=nr.resend?1:0,nr.resend?(ie.verifyOptions(nr,"idClient","msg::Message"),this.idClient=nr.idClient):this.idClient=ie.guid(),Ie(nr.subType)&&(ie.isInt(+nr.subType)&&+nr.subType>0?this.subType=+nr.subType:ie.onParamError("subType只能是大于0的整数","msg::Message"));var dr=nr.replyMsg;dr&&dr.idServer&&dr.from&&dr.to&&dr.time&&(this.replyMsgFromAccount=dr.from,this.replyMsgToAccount=dr.to,this.replyMsgTime=dr.time,this.replyMsgIdServer=dr.idServer,this.replyMsgIdClient=dr.idClient,dr.threadMsgFromAccount&&dr.threadMsgIdServer&&dr.threadMsgTime&&dr.threadMsgToAccount?(this.threadMsgFromAccount=dr.threadMsgFromAccount,this.threadMsgToAccount=dr.threadMsgToAccount,this.threadMsgTime=dr.threadMsgTime,this.threadMsgIdServer=dr.threadMsgIdServer,this.threadMsgIdClient=dr.threadMsgIdClient):(this.threadMsgFromAccount=dr.from,this.threadMsgToAccount=dr.to,this.threadMsgTime=dr.time,this.threadMsgIdServer=dr.idServer,this.threadMsgIdClient=dr.idClient)),Ie(nr.text)&&(this.body=""+nr.text),Ie(nr.custom)&&(n(nr.custom)==="object"?this.custom=y(nr.custom):this.custom=""+nr.custom),Ie(nr.body)&&(this.body=""+nr.body),Ie(nr.pushContent)&&(this.pushContent=""+nr.pushContent),Ie(nr.pushPayload)&&(this.pushPayload=""+nr.pushPayload);var ir=nr.apns;if(Ie(ir)&&nr.scene==="team"){var tr=ir.accounts;Ie(tr)&&ie.verifyParamType("apns.accounts",tr,"array","msg::Message"),this.apnsAccounts=tr?y(tr):"#%@all@%#",this.apnsContent=ir.content||nr.pushContent||"",ie.verifyBooleanWithDefault(ir,"forcePush",!0,"options.apns","msg::Message"),this.apnsForcePush=ir.forcePush?1:0}var ur=nr.robotInfo;Ie(ur)&&(nr.scene==="team"&&ie.verifyOptions(nr.robotInfo,"account","msg::Message::robotInfo scene === team"),ur.function&&(this.robotInfoFunction=ur.function),ur.topic&&(this.robotInfoTopic=ur.topic),ur.customContent&&(this.robotInfoCustomContent=ur.customContent),ur.account&&(this.robotInfoAccount=ur.account)),Ie(nr.isHistoryable)&&(this.isHistoryable=nr.isHistoryable?1:0),Ie(nr.isRoamingable)&&(this.isRoamingable=nr.isRoamingable?1:0),Ie(nr.isSyncable)&&(this.isSyncable=nr.isSyncable?1:0),Ie(nr.cc)&&(this.cc=nr.cc?1:0),Ie(nr.env)&&(this.env=nr.env),Ie(nr.isPushable)&&(this.isPushable=nr.isPushable?1:0),Ie(nr.isOfflinable)&&(this.isOfflinable=nr.isOfflinable?1:0),Ie(nr.isUnreadable)&&(this.isUnreadable=nr.isUnreadable?1:0),Ie(nr.needPushNick)&&(this.needPushNick=nr.needPushNick?1:0),Ie(nr.needMsgReceipt)&&(this.needMsgReceipt=nr.needMsgReceipt?1:0),Ie(nr.yidunEnable)&&(this.yidunEnable=nr.yidunEnable?1:0),this.needUpdateSession=nr.needUpdateSession===!1?0:1,Ie(nr.antiSpamUsingYidun)&&(this.antiSpamUsingYidun=nr.antiSpamUsingYidun?1:0),Ie(nr.clientAntiSpam)&&(this.clientAntiSpam=nr.clientAntiSpam?1:0),Ie(nr.antiSpamContent)&&(n(nr.antiSpamContent)==="object"?this.antiSpamContent=y(nr.antiSpamContent):this.antiSpamContent=""+nr.antiSpamContent),Ie(nr.antiSpamBusinessId)&&(n(nr.antiSpamBusinessId)==="object"?this.antiSpamBusinessId=y(nr.antiSpamBusinessId):this.antiSpamBusinessId=""+nr.antiSpamBusinessId),Ie(nr.yidunAntiCheating)&&(this.yidunAntiCheating=nr.yidunAntiCheating),Ie(nr.yidunAntiSpamExt)&&(this.yidunAntiSpamExt=nr.yidunAntiSpamExt)}ie.merge(er.prototype,Ue.prototype),er.prototype.getScene=function(){return jt[this.scene]},er.getType=Ue.getType,er.setFlow=Ue.setFlow,er.reverse=function(nr){var dr,ir=jt[nr.scene];if(dr=nr.delete==="1"?{delete:!0,scene:ir||nr.scene,from:nr.from,time:+nr.time,to:""+nr.to}:{scene:ir||nr.scene,from:nr.from,fromNick:nr.fromNick,fromClientType:Ce.reverseType(nr.fromClientType),fromDeviceId:nr.fromDeviceId,to:""+nr.to,time:+nr.time,type:er.getType(nr),text:de(nr.body)?nr.body:nr.text||"",isHistoryable:ae(nr.isHistoryable)||+nr.isHistoryable==1,isRoamingable:ae(nr.isRoamingable)||+nr.isRoamingable==1,isSyncable:ae(nr.isSyncable)||+nr.isSyncable==1,cc:ae(nr.cc)||+nr.cc==1,isPushable:ae(nr.isPushable)||+nr.isPushable==1,isOfflinable:ae(nr.isOfflinable)||+nr.isOfflinable==1,isUnreadable:ae(nr.isUnreadable)||+nr.isUnreadable==1,isReplyMsg:ae(nr.isReplyMsg)||+nr.isReplyMsg==1,needPushNick:ae(nr.needPushNick)||+nr.needPushNick==1,needMsgReceipt:+nr.needMsgReceipt==1,isLocal:!1},nr.isInBlackList&&(dr.isInBlackList=+nr.isInBlackList==1,dr.isInBlackList&&(nr.status="fail")),Ie(nr.isMuted)&&(dr.isMuted=+nr.isMuted==1),Ie(nr.resend)&&(dr.resend=+nr.resend==1),Ie(nr.idClient)&&(dr.idClient=nr.idClient),Ie(nr.idServer)&&(dr.idServer=""+nr.idServer),Ie(nr.userUpdateTime)&&(dr.userUpdateTime=+nr.userUpdateTime),Ie(nr.custom)&&(dr.custom=nr.custom),Ie(nr.callbackExt)&&(dr.callbackExt=nr.callbackExt),Ie(nr.subType)&&(dr.subType=+nr.subType),Ie(nr.pushContent)&&(dr.pushContent=nr.pushContent),Ie(nr.pushPayload)&&(dr.pushPayload=nr.pushPayload),Ie(nr.tempTeamMemberCount)&&(dr.tempTeamMemberCount=+nr.tempTeamMemberCount),Ie(nr.yidunAntiSpamRes)&&(dr.yidunAntiSpamRes=nr.yidunAntiSpamRes),Ie(nr.apnsAccounts)){if(dr.apns={},nr.apnsAccounts!=="#%@all@%#"){var tr=nr.apnsAccounts;try{dr.apns.accounts=JSON.parse(tr)}catch{dr.apns.accounts=[]}}dr.apns.content=nr.apnsContent||"",dr.apns.forcePush=+nr.apnsForcePush==1}if(Ie(nr.robotInfoFunction)&&(dr.robotInfo=dr.robotInfo||{},nr.robotInfoFunction&&(dr.robotInfo.function=nr.robotInfoFunction)),Ie(nr.robotInfoCustomContent)&&(dr.robotInfo=dr.robotInfo||{},nr.robotInfoCustomContent&&(dr.robotInfo.customContent=nr.robotInfoCustomContent)),Ie(nr.robotInfoTopic)&&(dr.robotInfo=dr.robotInfo||{},nr.robotInfoTopic&&(dr.robotInfo.topic=nr.robotInfoTopic)),Ie(nr.robotInfoAccount)&&(dr.robotInfo=dr.robotInfo||{},nr.robotInfoAccount&&(dr.robotInfo.account=nr.robotInfoAccount)),Ie(nr.needUpdateSession)&&(dr.needUpdateSession=+nr.needUpdateSession==1),dr.status=nr.status||"success",Ie(i(nr))&&(dr.filter=i(nr)),nr.replyMsgIdServer&&nr.threadMsgIdServer){var ur=["replyMsgFromAccount","replyMsgToAccount","replyMsgTime","replyMsgIdServer","replyMsgIdClient","threadMsgFromAccount","threadMsgToAccount","threadMsgTime","threadMsgIdServer","threadMsgIdClient"];k(ur).call(ur,function(or){dr[or]=nr[or]}),dr.replyMsgTime=+dr.replyMsgTime,dr.threadMsgTime=+dr.threadMsgTime}return dr},er.setExtra=function(nr,dr){nr.target=er.getMsgTarget(nr,dr),nr.sessionId=nr.scene+"-"+nr.target,Ue.setFlow(nr,dr)},er.getMsgTarget=function(nr,dr){return nr.scene==="p2p"?nr.to===dr?nr.from:nr.to:nr.scene==="team"||nr.scene==="superTeam"?nr.to:void 0},er.deduplication=function(nr){var dr,ir,tr={},ur=le(nr);try{for(ur.s();!(ir=ur.n()).done;){var or=ir.value,fr=tr[or.idClient];fr&&fr.time>or.time||(tr[or.idClient]=or)}}catch(lr){ur.e(lr)}finally{ur.f()}return L(dr=g(tr)).call(dr,function(lr){return tr[lr]})},er.sortMsgs=function(nr){return nr=$(nr).call(nr,0),ie.sortObjArray(nr,{sortPath:"time"}),nr},er.getLastMsg=function(nr){return(nr=er.sortMsgs(nr))[nr.length-1]},er.getLastNotIgnoredMsg=function(nr){for(var dr=null,ir=(nr=er.sortMsgs(nr)).length-1;ir>=0;ir--)if(!(dr=nr[ir]).ignore)return dr;return null},er.getMaxTimetag=function(nr){return er.getLastMsg(nr).time},er.validScenes=Fe,er.validTypes=cr,er.sceneMap=qe,er.sceneReverseMap=jt,t.exports=er},function(t,r,e){var n=e(24),g=e(19),y=e(28),i=e(2),k=e(384),L=e(8),$=e(5),V=e(6),z=e(3),re=e(141),oe=e(0),le=oe.notundef,ue=e(564),ie=e(12),ae=(e(192),e(12)),Ie=e(48),de=e(590).wrapSafeCallback,Ce=e(26).reportAPI,Ue=e(164);function qe(){}var jt={};qe.getInstance=function(er){er=Et(er),oe.verifyOptions(er,"account","api::Base.getInstance");var nr=this.genInstanceName(er),dr=jt[nr];return dr?qe.updateInstance(dr,er):dr=jt[nr]=new this(er),dr},qe.updateInstance=function(er,nr){er.setOptions(nr),nr.skipConnectionOnInitialize||er.connect()};var Fe=qe.fn=qe.prototype=g(new re),Et=function(er){return er.nosSurvivalTime?(oe.verifyParamType("nosSurvivalTime",er.nosSurvivalTime,"number","api::Base.getInstance"),oe.verifyParamMin("nosSurvivalTime",er.nosSurvivalTime,86400,"api::Base.getInstance")):er.nosSurvivalTime=1/0,er};Fe.updatePrivateConf=function(er){if(Ce({instance:this,className:"ApiBaseFn",funcName:"updatePrivateConf",hasCallback:!1}),er&&n(er.privateConf)==="object"){var nr=er.privateConf;typeof nr.lbs_web=="string"&&(er.lbsUrl=nr.lbs_web),typeof nr.link_ssl_web=="boolean"&&(er.secure=nr.link_ssl_web),typeof nr.https_enabled=="boolean"&&(er.httpsEnabled=nr.https_enabled),er.uploadUrl=nr.nos_uploader_web?nr.nos_uploader_web:null,er.chunkUploadUrl=nr.nos_uploader_web?nr.nos_uploader_web:null,er.replaceUrl=nr.nos_downloader?nr.nos_downloader:null,er.downloadUrl=nr.nos_accelerate?nr.nos_accelerate:null,er.downloadHost=nr.nos_accelerate_host?nr.nos_accelerate_host:null,er.downloadHostList=nr.nos_accelerate_host_list||[],er.downloadHost&&er.downloadHostList.push(er.downloadHost),er.nosCdnEnable=nr.nos_cdn_enable!==!1,er.ntServerAddress=nr.nt_server||null,er.kibanaServer=nr.kibana_server,er.statisticServer=nr.statistic_server,er.reportGlobalServer=nr.report_global_server,er.ipVersion=nr.ip_protocol_version||er.ipVersion,er.defaultLink=nr.link_web||er.defaultLink,er.ipv6DefaultLink=nr.link_ipv6_web||er.ipv6DefaultLink,typeof nr.nos_lbs=="string"?er.nosLbsUrls=[nr.nos_lbs]:er.nosLbsUrls=[],y(nr.nos_edge_list)&&(er.edgeList=nr.nos_edge_list)}return er.ntServerAddress===null||er.ntServerAddress===""?ie.ntServerAddress=null:ie.ntServerAddress=er.ntServerAddress,ie.uploadUrl=er.uploadUrl||ie.uploadUrl,ie.chunkUploadUrl=er.chunkUploadUrl||ie.chunkUploadUrl,ie.downloadUrl=er.downloadUrl||ie.downloadUrl,ie.downloadHost=er.downloadHost||ie.downloadHost,ie.downloadHostList=er.downloadHostList&&er.downloadHostList.length>0?er.downloadHostList:ie.downloadHostList,ie.nosCdnEnable=er.nosCdnEnable!==!1,ie.replaceUrl=er.replaceUrl||ie.replaceUrl,ie.httpsEnabled=er.httpsEnabled||ie.httpsEnabled,er.probe_ipv4_url&&(ie.ipProbeAddr.ipv4=er.probe_ipv4_url),er.probe_ipv6_url&&(ie.ipProbeAddr.ipv6=er.probe_ipv6_url),er},Fe.init=function(er){oe.verifyOptions(er,"account","api::Base.init"),er=this.updatePrivateConf(er),oe.verifyBooleanWithDefault(er,"exifOrientation",!0,"","api::Base.init"),er.lbsBackup=er.lbsBackup===void 0||er.lbsBackup;var nr=this.account=er.account=er.account+"",dr=er.constructor.genInstanceName(er),ir=jt[dr];if(er._disableSingleton&&(ir=null),ir)return qe.updateInstance(ir,er),ir;this.logger=er.logger=new ue({debug:er.debug,logFunc:er.logFunc,prefix:this.subType,dbLog:er.dbLog!==!1,account:er.account,expire:er.expire,logLevel:er.logLevel}),this.options=de(er,this),er.api=this;var tr=this.protocol=new er.Protocol(er);return tr.name="Protocol-"+dr,tr.account=nr,tr.api=this,tr.message=this.message=new er.Message({account:nr}),this.reporter=tr.reporter,this.statusProtector=tr.statusProtector,this.reporterHook=tr.reporterHook,this.abtInfo={},(typeof oe.get(er,"privateConf.isABTestEnable")=="boolean"?er.privateConf.isABTestEnable:ie.privateConf.isABTestEnable)&&this.abTestConfigRequset(),this.name=dr,jt[dr]=this,this},Fe.destroy=function(er){var nr=this;(er=er||{}).done=Ce({instance:this,className:"ApiBaseFn",funcName:"destroy",done:er.done});var dr=this;if(!dr.__beginDestroy){var ir;dr.__beginDestroy=!0,er=er||{};var tr,ur=this.name;if(this.logger.warn("destroy::start"),!ur)return this.logger&&this.logger.warn&&this.logger.warn("destroy::no instanceName"),void(dr.__beginDestroy=void 0);this.protocol&&(ir=this.protocol.connectTimer),this.protocol&&this.protocol.resetPush&&this.protocol.resetPush(),this.eventNames&&typeof this.eventNames=="function"&&i(tr=this.eventNames()).call(tr,function(or){delete nr._events[or]}),this.disconnect({done:function(or){var fr,lr,gr;dr.logger.warn(`ApiBase::destroy: instance destroyed ...

`),dr.__beginDestroy=void 0,dr.reporter.destroy(),dr.statusProtector.destroy(),dr.reporterHook.destroy(),i(fr=k(dr.options)).call(fr,function(wr){L(wr).call(wr,"on")===0&&(dr.options[wr]=function(){},dr.protocol.options[wr]=function(){},dr.protocol.api.options[wr]=function(){})}),dr.logger.destroy(),n(dr.protocol.sessionSet)==="object"&&i(lr=$(dr.protocol.sessionSet)).call(lr,function(wr){dr.protocol.sessionSet[wr].unreadMsgs=[],dr.protocol.sessionSet[wr]=void 0}),dr.protocol.syncResult={},dr.db&&dr.db.close();var Sr=dr.protocol;i(gr=k(dr)).call(gr,function(wr){dr[wr]=void 0}),jt&&(jt[ur]=null,clearTimeout(ir)),Sr&&(Sr.__destroyed=!0),er.done instanceof Function&&er.done(or)}})}},Fe.setOptions=function(er){var nr=Ue(er);nr=de(nr,this),this.protocol.setOptions(nr)},Fe.abTestConfigRequset=function(){var er=this,nr=er.options.abTestUrl||"https://abt-online.netease.im/v1/api/abt/client/getExperimentInfo",dr={projectKey:"im1_sdk_abtest_web",appKey:er.options.appKey,osType:"Web",sdkVersion:er.info.version,deviceId:Ie.deviceId},ir=V({clientInfo:dr});this.protocol.adaptersRequest(nr,{method:"POST",timeout:5e3,headers:{"Content-Type":"application/json"},data:ir,onload:function(tr){var ur=JSON.parse(tr);er.abtInfo=ur.data.abtInfo||{},er.logger&&er.logger.info("abTestConfigRequset::success",er.abtInfo),ae.hasLocalStorage&&localStorage.setItem("nim-abtInfo",V(er.abtInfo))},onerror:function(){er.logger&&er.logger.info("abTestConfigRequset::fail")}},{exception_service:7})},Fe.processCallback=function(er,nr){cr(er,nr)},Fe.processCallbackPromise=function(er,nr){return new z(function(dr,ir){cr(er,nr,!0,dr,ir)})};var cr=function(er,nr,dr,ir,tr){var ur="api::processCallback";dr&&(ur="api::processCallbackPromise"),oe.verifyCallback(er,"done",ur),er.callback=function(or,fr,lr){var gr=er.callback.options;if(fr=fr||gr,nr&&(fr=gr),oe.isFunction(er.cbaop)){var Sr=er.cbaop(or,fr);le(Sr)&&(fr=Sr)}var wr=er.done;oe.isObject(fr)&&(delete fr.done,delete fr.cb,delete fr.callback),dr?or?tr({message:"生成接口回调错误",callFunc:ur,event:or}):ir(fr):wr(or,fr,lr)},er.callback.options=oe.copy(er)};Fe.processPs=function(er){oe.notexist(er.ps)&&(er.ps=""),oe.verifyArrayMax("ps",er.ps,5e3)},Fe.processCustom=function(er){oe.notexist(er.custom)&&(er.custom="")},Fe.sendCmd=function(){this.protocol.sendCmd.apply(this.protocol,arguments)},Fe.sendCmdWithResp=function(er,nr,dr){this.sendCmd(er,nr,function(ir,tr,ur){oe.isFunction(dr)&&(ir?dr(ir,tr):dr(null,ur))})},Fe.cbAndSendCmd=function(er,nr){var dr=this.processCallbackPromise(nr);return this.sendCmd(er,nr),dr},Fe.sendCmdUsePromise=function(er,nr){var dr=this,ir=Ce({instance:this,className:"ApiBaseFn",funcName:er,hasCallback:!0});return new z(function(tr,ur){dr.sendCmd(er,nr,function(or,fr,lr){if(or)typeof ir=="function"&&ir(or),ur(or);else{var gr=oe.merge({},fr,lr);typeof ir=="function"&&ir(void 0),tr(gr)}})})},qe.use=function(er,nr){er&&er.install&&oe.isFunction(er.install)&&er.install(this,nr)},qe.rmAllInstances=function(){for(var er in jt)jt[er].destroy();jt={}},Fe.logout=function(){var er=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};er.callback=Ce({instance:this,className:"ApiBaseFn",funcName:"logout",done:er.callback}),er=er||{},this.protocol.shouldReconnect=!1,this.protocol.doLogout=!0,this.processCallback(er),this.protocol.statusProtector.processEvent("auth/loginLifeCycleLogout"),this.sendCmd("logout",er,er.callback)},t.exports=qe,e(594),e(595),e(647),e(648),e(649),e(653)},function(t,r,e){var n=e(93),g=e(28),y=e(5),i=e(15),k=e(95),L=e(8),$=e(63),V=e(4),z=e(2),re=e(6),oe=e(56),le=e(22),ue=e(23),ie=e(9),ae=e(68),Ie=e(78),de=e(64);function Ce(lr,gr){var Sr=Ie!==void 0&&de(lr)||lr["@@iterator"];if(!Sr){if(g(lr)||(Sr=function(Er,sr){var xr;if(Er){if(typeof Er=="string")return Ue(Er,sr);var Or=ie(xr=Object.prototype.toString.call(Er)).call(xr,8,-1);if(Or==="Object"&&Er.constructor&&(Or=Er.constructor.name),Or==="Map"||Or==="Set")return ae(Er);if(Or==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(Or))return Ue(Er,sr)}}(lr))||gr&&lr&&typeof lr.length=="number"){Sr&&(lr=Sr);var wr=0,kr=function(){};return{s:kr,n:function(){return wr>=lr.length?{done:!0}:{done:!1,value:lr[wr++]}},e:function(Er){throw Er},f:kr}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var mr,Ir=!0,Nr=!1;return{s:function(){Sr=Sr.call(lr)},n:function(){var Er=Sr.next();return Ir=Er.done,Er},e:function(Er){Nr=!0,mr=Er},f:function(){try{Ir||Sr.return==null||Sr.return()}finally{if(Nr)throw mr}}}}function Ue(lr,gr){(gr==null||gr>lr.length)&&(gr=lr.length);for(var Sr=0,wr=new Array(gr);Sr<gr;Sr++)wr[Sr]=lr[Sr];return wr}var qe=e(0),jt=qe.undef,Fe=e(12),Et=e(35),cr=e(165).StatusProtector,er=e(109),nr=er.ReporterHook,dr=er.EMSyncType,ir=e(654),tr=e(655),ur=e(656);function or(lr){qe.undef(lr.secure)&&(lr.secure=!0),this.options=lr,this.keepNosSafeUrl=this.options.keepNosSafeUrl||!1;var gr=lr.defaultLink||lr.defaultLinkUrl;qe.notundef(gr)&&qe.isString(gr)&&(Fe.optionDefaultLinkUrl=n(gr).call(gr)),qe.notundef(lr.ipv6DefaultLink)&&qe.isString(lr.ipv6DefaultLink)&&(Fe.optionIpv6DefaultLinkUrl=lr.ipv6DefaultLink),typeof lr.heartbeatInterval=="number"&&(Fe.heartbeatInterval=lr.heartbeatInterval),g(lr.nosLbsUrls)&&(Fe.nosLbsUrls=lr.nosLbsUrls);var Sr=this.options.socketConcurrent;Sr=typeof Sr=="number"&&Sr>=1&&Sr<=3?Sr:1,this.options.socketConcurrent=Sr,this.options.rollbackDelMsgUnread!==void 0&&typeof this.options.rollbackDelMsgUnread=="boolean"||(this.options.rollbackDelMsgUnread=!0),this.init(),lr.skipConnectionOnInitialize||this.connect()}var fr=or.fn=or.prototype;fr.init=function(){var lr=this;this.logger=this.options.logger,this.getNosOriginUrlReqNum=0,this.checkNosReqNum=0,this.timerMap={},this.cmdCallbackMap={},this.cmdContentMap={},this.initConnect(),this.reset(),this.statusProtector=new cr(this),this.reporterHook=new nr(this,this.options.reporterHookConfig),this.reporterHookLinkKeep=new ir(this),this.promiseAbortManager=new tr,this.imsocket=new ur(this,{socketConcurrent:this.options.socketConcurrent,binaryWebsocket:this.useBinaryWebSocket()}),this.statusProtector.on("auth/loginLifeCycleLogout",function(){lr.promiseAbortManager.clear()}),this.statusProtector.on("auth/loginLifeCycleLoginSucc",function(){lr.reporterHook.reset(),lr.reporterHook.setOriginTimetick()})},fr.useBinaryWebSocket=function(){if(!(Fe.isBrowser&&typeof TextDecoder<"u"&&typeof Uint8Array<"u"))return!1;if(typeof this.options.binaryWebsocket=="boolean")return this.options.binaryWebsocket;if(Fe.hasLocalStorage&&localStorage.getItem("nim-abtInfo"))try{var lr,gr=Ce(JSON.parse(localStorage.getItem("nim-abtInfo")).experiments);try{for(gr.s();!(lr=gr.n()).done;){var Sr=lr.value;if(Sr.experimentKey=Sr.schemeKey==="open_flow")return!0}}catch(wr){gr.e(wr)}finally{gr.f()}}catch{return!1}return!1},fr.reset=function(){jt(this.options.thumbnailToStatic)&&(this.options.thumbnailToStatic=!0),this.resetConnect()},fr.setOptions=function(lr){var gr=this.options,Sr=y(gr),wr=y(lr),kr=["onconnect","onerror","onwillreconnect","ondisconnect","onloginportschange","onmyinfo","onblacklist","onmutelist","onfriends","onusers","onrobots","onteams","onSuperTeams","onsessions","onSessionsWithMoreRoaming","onStickTopSessions","onroamingmsgs","onofflinemsgs","onofflinefiltermsgs","onroamingsysmsgs","onofflinesysmsgs","onofflinefiltersysmsgs","onofflinecustomsysmsgs","onofflinefiltercustomsysmsgs","onbroadcastmsg","onbroadcastmsgs","onsysmsgunread","onsyncdone","onteammembers","onsyncteammembersdone","onsyncsuperteammembersdone","onmsg","onsysmsg","oncustomsysmsg","onupdatemyinfo","onupdateuser","onSyncUpdateServerSession","onUpdateSuperTeamMember","onMySuperTeamMembers","onCreateSuperTeam","onUpdateSuperTeam","onAddSuperTeamMembers","onRemoveSuperTeamMembers","onUpdateSuperTeamManagers","onDismissSuperTeam","onTransferSuperTeam","onUpdateSuperTeamMembersMute","onupdateteammember","onMyTeamMembers","onMsgReceipts","onCreateTeam","onUpdateTeam","onAddTeamMembers","onRemoveTeamMembers","onUpdateTeamManagers","onDismissTeam","onTransferTeam","onUpdateTeamMembersMute","onTeamMsgReceipt","onupdatesession","onQuickComment","onDeleteQuickComment","onPinMsgChange","onupdatesysmsgunread","onupdatesysmsg","onsynccreateteam","onsyncsupercreateteam","onsyncmarkinblacklist","onsyncmarkinmutelist","onsyncfriendaction","reconnectDelayProvider","shouldIgnoreNotification","shouldIgnoreMsg","onDeleteMsgSelf","shouldCountNotifyUnread","onPushNotificationMultiportConfig","onPushNotificationMultiportConfigUpdate","onpushevents"],mr=i(wr).call(wr,function(Nr){return k(kr).call(kr,Nr)}),Ir=L(Sr).call(Sr,"account");qe.verifyCallback(lr,mr,"protocol::IMProtocol"),this.logger.info("setOptions::",qe.omitAsString(lr,["appKey","token","loginExt","customTag"])),Ir!==-1&&$(Sr).call(Sr,Ir,1),lr=qe.filterObj(lr,Sr),this.options=qe.merge(gr,lr),this.reset()},fr.sendCmd=function(lr){var gr,Sr=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",wr=arguments.length>2?arguments[2]:void 0,kr=this;kr.heartbeat();var mr,Ir=lr,Nr=(lr=kr.parser.createCmd(lr,Sr)).SER;Sr=Sr||{},kr.cmdContentMap[Nr]=Sr,Sr.single&&(delete Sr.single,(mr=y(Sr)).length===1&&(kr.cmdContentMap[Nr]=Sr[mr[0]])),Sr.__exceptionInfo={target:V(gr="".concat(lr.SID,"-")).call(gr,lr.CID),context:Nr,startTime:kr.reporterHook.getSafeClock()},Sr.NOTSTORE&&(mr=Sr.NOTSTORE.split(" "),z(mr).call(mr,function(Er){delete Sr[Er]}),delete Sr.NOTSTORE),(wr=wr||Sr.callback)&&(kr.cmdCallbackMap[Nr]=wr),kr.executeCmdTask({cmdName:Ir,cmd:re(lr)})},fr.executeCmdTask=function(lr){var gr=lr.cmdName,Sr=lr.cmd,wr=(Sr=JSON.parse(Sr)).SER;this.isFrequencyControlled(gr)?(this.logger.warn("protocol::executeCmdTask: ".concat(gr," hit freq control")),this.markCallbackInvalid(wr,Et.newFrequencyControlError({callFunc:"protocol::executeCmdTask",message:"".concat(gr," hit freq control")}))):this.hasLogin?(gr!=="heartbeat"&&(this.logger.debugEnable?this.logger.debug("protocol::sendCmd: ".concat(lr.cmd)):this.logger.info("protocol::sendCmd: ".concat(gr))),this.doSendCmd(Sr,gr)):gr==="login"&&this.isConnected()?(this.logger.debugEnable?this.logger.debug("protocol::sendCmd: ".concat(lr.cmd)):this.logger.info("protocol::sendCmd: ".concat(gr)),this.doSendCmd(Sr,gr)):(this.logger.warn("protocol::executeCmdTask: ".concat(gr," not connected or login")),this.markCallbackInvalid(wr,Et.newSocketStateError({callFunc:"protocol::executeCmdTask",message:"".concat(gr," not connected or not login")})))},fr.isFrequencyControlled=function(lr){var gr=this.frequencyControlMap&&this.frequencyControlMap[lr];if(gr){if(oe()<gr.from+gr.duration)return!0;delete this.frequencyControlMap[lr]}},fr.doSendCmd=function(lr,gr){var Sr=this,wr=lr.SER,kr=wr===0?Fe.hbCmdTimeout:Fe.cmdTimeout,mr=new Date().getTime(),Ir=Sr.cmdContentMap[wr];function Nr(Er){Sr.markCallbackInvalid(wr,Er||Et.newSocketStateError({callFunc:"protocol::doSendCmd",message:"ser ".concat(wr," socketSendJson Error")}))}Ir&&Ir.__exceptionInfo&&(Ir.__exceptionInfo.startTime=Sr.reporterHook.getSafeClock()),lr.isAwaitable&&(Sr.timerMap[wr]=le(function(){var Er;lr.SID!==1&&lr.CID!==2&&Sr.detectHeartbeat(),Sr.markCallbackInvalid(wr,Et.newTimeoutError({callFunc:"protocol::doSendCmd",message:"ser ".concat(wr," Timeout Error")})),Sr.reporter.reportTraceStart("exceptions",{user_id:qe.get(Sr,"options.account")||"",trace_id:qe.get(Sr,"socket.socket.sessionid"),start_time:mr,action:2,exception_service:6}),Sr.reporter.reportTraceUpdateV2("exceptions",{code:408,description:"Packet timeout",operation_type:1,target:V(Er="".concat(lr.SID,"-")).call(Er,lr.CID),context:"".concat(lr.SER),net_connect:Sr.checkNetworkAvailable()}),Sr.reporter.reportTraceEnd("exceptions",1)},kr));try{Sr.socket&&Sr.socket.send&&Sr.socket.binaryType==="arraybuffer"?Sr.socket.send(lr,gr):Sr.socket&&Sr.socket.send?Sr.socket.send(re(lr)):Nr()}catch(Er){Nr(Er)}},fr.getObjWithSer=function(lr){var gr=this.cmdContentMap[lr];return gr&&!gr.isImSyncDataObj&&delete this.cmdContentMap[lr],gr&&qe.copy(gr)},fr.getCallbackWithSer=function(lr){var gr=this.cmdCallbackMap[lr];return gr&&!gr.isImSyncDataCb&&delete this.cmdCallbackMap[lr],gr},fr.getTimerWithSer=function(lr){var gr=this.timerMap[lr];return delete this.timerMap[lr],gr},fr.clearTimerWithSer=function(lr){var gr=this.getTimerWithSer(lr);gr&&clearTimeout(gr)},fr.markCallbackInvalid=function(lr,gr){this.getObjWithSer(lr),this.clearTimerWithSer(lr);var Sr=this.getCallbackWithSer(lr);if(Sr){var wr=Sr.options;le(function(){Sr(gr||Et.newUnknownError({ser:lr}),wr)},0)}},fr.markAllCallbackInvalid=function(lr){var gr=this;try{var Sr,wr;z(Sr=y(this.cmdContentMap)).call(Sr,function(kr){var mr=gr.getObjWithSer(kr);if((!mr||!mr.isImSyncDataObj)&&mr&&mr.__exceptionInfo){var Ir=mr.__exceptionInfo.target,Nr=mr.__exceptionInfo.context,Er=qe.get(lr,"event.uploadCode")||lr&&lr.code;Er=typeof Er!="number"?415:Er;var sr=qe.get(lr,"event.disconnectReason"),xr=sr?re({disconnect_reason:sr}):lr&&lr.message||"send cmd failed";gr.reporter.reportTraceStart("exceptions",{user_id:qe.get(gr,"options.account")||"",trace_id:qe.get(gr,"socket.socket.sessionid"),start_time:gr.reporterHook.getNTPTime(mr.__exceptionInfo.startTime),action:2,exception_service:6}),gr.reporter.reportTraceUpdateV2("exceptions",{code:Er,description:xr,operation_type:1,target:Ir,context:Nr,net_connect:gr.checkNetworkAvailable()}),gr.reporter.reportTraceEnd("exceptions",1),delete mr.__exceptionInfo}}),z(wr=y(this.cmdCallbackMap)).call(wr,function(kr){gr.markCallbackInvalid(kr,lr)})}catch(kr){gr.logger&&gr.logger.error("protocol::markAllCallbackInvalid error: ",kr)}},fr.getPacketObj=function(lr){var gr=null;if(lr&&lr.raw){var Sr=lr.raw.ser;qe.notundef(Sr)&&(gr=this.getObjWithSer(Sr))}return gr},fr.callPacketAckCallback=function(lr){var gr=this;if(lr&&lr.raw){var Sr=lr.raw.ser;if(qe.notundef(Sr)){gr.clearTimerWithSer(Sr);var wr=gr.getCallbackWithSer(Sr);if(wr){var kr;wr.originUrl&&lr.obj&&lr.obj.file&&(lr.obj.file._url_safe=lr.obj.file.url,lr.obj.file.url=wr.originUrl,lr.obj.type==="audio"&&(lr.obj.file.mp3Url=wr.originUrl+(~L(kr=wr.originUrl).call(kr,"?")?"&":"?")+"audioTrans&type=mp3")),lr.promise?lr.promise.then(function(){wr(lr.error,lr.obj)},function(mr){var Ir,Nr;mr.callFunc="protocol::callPacketAckCallback",mr.message=V(Ir=V(Nr="Resp Promoise Error: cmd: ".concat(lr.cmd,", ser: ")).call(Nr,Sr,", reason: ")).call(Ir,mr.message);var Er=Et.customError("CALLBACK_ACK_ERR",mr);gr.logger.error(`protocol::callPacketAckCallback error stack: 
`.concat(mr.stack||mr.event&&mr.event.stack)),wr(Er,lr.obj,lr.content)}):wr(lr.error,lr.obj,lr.content)}}}},fr.onMessage=function(lr){var gr=this;gr.heartbeat(),gr.parser.parseResponse(lr).then(function(Sr){var wr;if(Sr.notFound&&gr.logger.warn("protocol::onMessage: packet not found ".concat(re(Sr))),Sr.error){var kr,mr;Sr.error.message=V(kr="".concat(Sr.cmd," error: ")).call(kr,Sr.error.message),gr.logger.error(V(mr="protocol::onMessage: packet error ".concat(re(Sr.error),"，raw cmd ")).call(mr,Sr.rawStr));var Ir=Sr.raw||{};Ir.code!==408&&Ir.code!==415&&Ir.code!==500||gr.reporter.report("nimErrEvent",{code:Ir.code,module:Sr.cmd,accid:gr.account})}Sr.__receiveTime=gr.reporterHook.getSafeClock();var Nr=dr[V(wr="kSyncType".concat(Sr.raw.sid,"_")).call(wr,Sr.raw.cid)];if(Nr){var Er=qe.get(Sr,"raw.r"),sr=1;if(Er&&Er.length>0){var xr=i(Er).call(Er,function(Fr){return g(Fr)}),Or=qe.get(xr,"0.length");sr=typeof Or=="number"?Or:1}gr.reporterHook.emit("reporter/syncItem",Nr,sr)}Sr.frequencyControlDuration&&(gr.logger.error("protocol::onMessage: server freq control ".concat(re(Sr.cmd))),gr.frequencyControlMap=gr.frequencyControlMap||{},gr.frequencyControlMap[Sr.cmd]={from:+new Date,duration:Sr.frequencyControlDuration}),Sr.obj=gr.getPacketObj(Sr),Sr.obj&&Sr.obj.__exceptionInfo&&delete Sr.obj.__exceptionInfo,Sr.cmd!=="heartbeat"&&(gr.logger.debugEnable?gr.logger.debug("protocol::recvCmd: ".concat(Sr.rawStr)):gr.logger.log("protocol::recvCmd: ".concat(Sr.cmd)));var Mr="process"+qe.capFirstLetter(Sr.service);if(gr[Mr])if(Sr.cmd==="syncDone"){if(gr.cmdCallbackMap[Sr.raw.ser]&&gr.cmdCallbackMap[Sr.raw.ser].isImSyncDataCb){var br;gr.cmdCallbackMap[Sr.raw.ser].isImSyncDataCb=!1;var hr=ue(br=function(Fr,Lr){this.checkNosReqNum++,this.getNosOriginUrlReqNum<=0||this.checkNosReqNum>=20?this[Fr](Lr):le(hr,300)}).call(br,gr,Mr,Sr);le(function(){hr.call(gr,Mr,Sr)},10)}}else{Sr.cmd!=="syncTeamMembersDone"&&Sr.cmd!=="syncSuperTeamMembersDone"||gr.cmdCallbackMap[Sr.raw.ser]&&gr.cmdCallbackMap[Sr.raw.ser].isImSyncDataCb&&(gr.cmdCallbackMap[Sr.raw.ser].isImSyncDataCb=!1);try{gr[Mr](Sr)}catch(Fr){var Tr,Br;gr.logger.warn(V(Tr=V(Br="protocol::onMessage: ".concat(Mr,".")).call(Br,Sr.cmd," excute failed ")).call(Tr,Sr.obj?"":", maybe the packet timed out",": "),Fr.message)}}else gr.logger.warn("protocol::onMessage: ".concat(Mr," not found"));gr.callPacketAckCallback(Sr)})},fr.onMiscError=function(lr,gr,Sr){gr&&this.notifyError(lr,gr,Sr)},fr.onCustomError=function(lr,gr){var Sr=Et.customError(lr,gr),wr=gr.message||"未知错误";this.onMiscError(wr,Sr)},fr.notifyError=function(lr,gr,Sr){var wr;this.isConnected()&&(this.logger.error(V(wr="".concat(lr||""," ")).call(wr,this.name),gr,Sr),this.options.onerror(gr,Sr))},fr.emitAPI=function(lr){var gr=lr.type,Sr=lr.obj;this.api.emit(gr,Sr)},t.exports=or,e(700),e(716),e(717),e(718),e(719),e(720)},function(t,r,e){var n=e(111),g=Function.prototype,y=g.apply,i=g.call;t.exports=typeof Reflect=="object"&&Reflect.apply||(n?i.bind(y):function(){return i.apply(y,arguments)})},function(t,r){t.exports=function(e,n){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:n}}},function(t,r){var e=String;t.exports=function(n){try{return e(n)}catch{return"Object"}}},function(t,r,e){var n=e(7);t.exports=function(g,y){var i=[][g];return!!i&&n(function(){i.call(null,y||function(){return 1},1)})}},function(t,r,e){var n=e(71);t.exports=Array.isArray||function(g){return n(g)=="Array"}},function(t,r,e){var n,g=e(38),y=e(173),i=e(174),k=e(117),L=e(222),$=e(169),V=e(134),z=V("IE_PROTO"),re=function(){},oe=function(ie){return"<script>"+ie+"<\/script>"},le=function(ie){ie.write(oe("")),ie.close();var ae=ie.parentWindow.Object;return ie=null,ae},ue=function(){try{n=new ActiveXObject("htmlfile")}catch{}var ie,ae;ue=typeof document<"u"?document.domain&&n?le(n):((ae=$("iframe")).style.display="none",L.appendChild(ae),ae.src="javascript:",(ie=ae.contentWindow.document).open(),ie.write(oe("document.F=Object")),ie.close(),ie.F):le(n);for(var Ie=i.length;Ie--;)delete ue.prototype[i[Ie]];return ue()};k[z]=!0,t.exports=Object.create||function(ie,ae){var Ie;return ie!==null?(re.prototype=g(ie),Ie=new re,re.prototype=null,Ie[z]=ie):Ie=ue(),ae===void 0?Ie:y.f(Ie,ae)}},function(t,r,e){var n=e(172),g=e(40).f,y=e(65),i=e(31),k=e(341),L=e(21)("toStringTag");t.exports=function($,V,z,re){if($){var oe=z?$:$.prototype;i(oe,L)||g(oe,L,{configurable:!0,value:V}),re&&!n&&y(oe,"toString",k)}}},function(t,r,e){var n=e(47),g=e(163),y=e(105),i=e(103),k=e(40).f,L=e(176),$=e(177),V=e(57),z=e(29),re=i.set,oe=i.getterFor("Array Iterator");t.exports=L(Array,"Array",function(ue,ie){re(this,{type:"Array Iterator",target:n(ue),index:0,kind:ie})},function(){var ue=oe(this),ie=ue.target,ae=ue.kind,Ie=ue.index++;return!ie||Ie>=ie.length?(ue.target=void 0,$(void 0,!0)):$(ae=="keys"?Ie:ae=="values"?ie[Ie]:[Ie,ie[Ie]],!1)},"values");var le=y.Arguments=y.Array;if(g("keys"),g("values"),g("entries"),!V&&z&&le.name!=="values")try{k(le,"name",{value:"values"})}catch{}},function(t,r,e){var n=e(509),g=e(514);t.exports=function(y,i){var k=g(y,i);return n(k)?k:void 0}},function(t,r,e){var n=e(23),g=e(66),y=e(580),i=e(582),k=e(588),L={},$=g.f;function V(ie){var ae=ie.upload=(ie.headers||g.o)["Content-Type"]==="multipart/form-data",Ie=!1;try{Ie=(location.protocol+"//"+location.host).toLowerCase()!==g.url2origin(ie.url)}catch{}return ie.cors=Ie,ae||Ie||ie.mode?function(de){var Ce=de.mode,Ue=y,qe=g.getGlobal();return!qe.FormData&&qe.document&&(Ce="iframe"),Ce==="iframe"&&(Ue=de.upload?i:k),new Ue(de)}(ie):new y(ie)}function z(ie,ae,Ie){var de=L[ie];if(de){ae==="onload"&&de.result&&(Ie=function(Ue,qe){qe={data:qe};var jt=Ue.result.headers;return jt&&(qe.headers=Ue.req.header(jt)),qe}(de,Ie)),function(Ue){var qe=L[Ue];qe&&(qe.req.destroy(),delete L[Ue])}(ie);var Ce={type:ae,result:Ie};$(Ce),Ce.stopped||de[ae](Ce.result)}}function re(ie,ae){z(ie,"onload",ae)}function oe(ie,ae){z(ie,"onerror",ae)}function le(ie,ae){var Ie=g.genUrlSep(ie);return ae=ae||"",g.isObject(ae)&&(ae=g.object2query(ae)),ae&&(ie+=Ie+ae),ie}function ue(ie,ae){ae=ae||{};var Ie=g.uniqueID(),de={result:ae.result,onload:ae.onload||g.f,onerror:ae.onerror||g.f};L[Ie]=de,ae.onload=n(re).call(re,null,Ie),ae.onerror=n(oe).call(oe,null,Ie),ae.query&&(ie=le(ie,ae.query));var Ce=ae.method||"";return Ce&&!/get/i.test(Ce)||!ae.data||(ie=le(ie,ae.data),ae.data=null),ae.url=ie,de.req=V(ae),Ie}ue.filter=function(ie){g.isFunction(ie)&&($=ie)},ue.abort=function(ie){var ae=L[ie];ae&&ae.req&&ae.req.abort()},t.exports=ue},function(t,r,e){t.exports=e(583)},function(t,r){t.exports=function(e){var n=typeof e;return e!=null&&(n=="object"||n=="function")}},function(t,r,e){t.exports=e(615)},function(t,r,e){(function(n){var g;t.exports=(g=g||function(y,i){var k;if(typeof window<"u"&&window.crypto&&(k=window.crypto),typeof self<"u"&&self.crypto&&(k=self.crypto),typeof globalThis<"u"&&globalThis.crypto&&(k=globalThis.crypto),!k&&typeof window<"u"&&window.msCrypto&&(k=window.msCrypto),!k&&n!==void 0&&n.crypto&&(k=n.crypto),!k)try{k=e(914)}catch{}var L=function(){if(k){if(typeof k.getRandomValues=="function")try{return k.getRandomValues(new Uint32Array(1))[0]}catch{}if(typeof k.randomBytes=="function")try{return k.randomBytes(4).readInt32LE()}catch{}}throw new Error("Native crypto module could not be used to get secure random number.")},$=Object.create||function(){function Ce(){}return function(Ue){var qe;return Ce.prototype=Ue,qe=new Ce,Ce.prototype=null,qe}}(),V={},z=V.lib={},re=z.Base={extend:function(Ce){var Ue=$(this);return Ce&&Ue.mixIn(Ce),Ue.hasOwnProperty("init")&&this.init!==Ue.init||(Ue.init=function(){Ue.$super.init.apply(this,arguments)}),Ue.init.prototype=Ue,Ue.$super=this,Ue},create:function(){var Ce=this.extend();return Ce.init.apply(Ce,arguments),Ce},init:function(){},mixIn:function(Ce){for(var Ue in Ce)Ce.hasOwnProperty(Ue)&&(this[Ue]=Ce[Ue]);Ce.hasOwnProperty("toString")&&(this.toString=Ce.toString)},clone:function(){return this.init.prototype.extend(this)}},oe=z.WordArray=re.extend({init:function(Ce,Ue){Ce=this.words=Ce||[],this.sigBytes=Ue??4*Ce.length},toString:function(Ce){return(Ce||ue).stringify(this)},concat:function(Ce){var Ue=this.words,qe=Ce.words,jt=this.sigBytes,Fe=Ce.sigBytes;if(this.clamp(),jt%4)for(var Et=0;Et<Fe;Et++){var cr=qe[Et>>>2]>>>24-Et%4*8&255;Ue[jt+Et>>>2]|=cr<<24-(jt+Et)%4*8}else for(var er=0;er<Fe;er+=4)Ue[jt+er>>>2]=qe[er>>>2];return this.sigBytes+=Fe,this},clamp:function(){var Ce=this.words,Ue=this.sigBytes;Ce[Ue>>>2]&=4294967295<<32-Ue%4*8,Ce.length=y.ceil(Ue/4)},clone:function(){var Ce=re.clone.call(this);return Ce.words=this.words.slice(0),Ce},random:function(Ce){for(var Ue=[],qe=0;qe<Ce;qe+=4)Ue.push(L());return new oe.init(Ue,Ce)}}),le=V.enc={},ue=le.Hex={stringify:function(Ce){for(var Ue=Ce.words,qe=Ce.sigBytes,jt=[],Fe=0;Fe<qe;Fe++){var Et=Ue[Fe>>>2]>>>24-Fe%4*8&255;jt.push((Et>>>4).toString(16)),jt.push((15&Et).toString(16))}return jt.join("")},parse:function(Ce){for(var Ue=Ce.length,qe=[],jt=0;jt<Ue;jt+=2)qe[jt>>>3]|=parseInt(Ce.substr(jt,2),16)<<24-jt%8*4;return new oe.init(qe,Ue/2)}},ie=le.Latin1={stringify:function(Ce){for(var Ue=Ce.words,qe=Ce.sigBytes,jt=[],Fe=0;Fe<qe;Fe++){var Et=Ue[Fe>>>2]>>>24-Fe%4*8&255;jt.push(String.fromCharCode(Et))}return jt.join("")},parse:function(Ce){for(var Ue=Ce.length,qe=[],jt=0;jt<Ue;jt++)qe[jt>>>2]|=(255&Ce.charCodeAt(jt))<<24-jt%4*8;return new oe.init(qe,Ue)}},ae=le.Utf8={stringify:function(Ce){try{return decodeURIComponent(escape(ie.stringify(Ce)))}catch{throw new Error("Malformed UTF-8 data")}},parse:function(Ce){return ie.parse(unescape(encodeURIComponent(Ce)))}},Ie=z.BufferedBlockAlgorithm=re.extend({reset:function(){this._data=new oe.init,this._nDataBytes=0},_append:function(Ce){typeof Ce=="string"&&(Ce=ae.parse(Ce)),this._data.concat(Ce),this._nDataBytes+=Ce.sigBytes},_process:function(Ce){var Ue,qe=this._data,jt=qe.words,Fe=qe.sigBytes,Et=this.blockSize,cr=Fe/(4*Et),er=(cr=Ce?y.ceil(cr):y.max((0|cr)-this._minBufferSize,0))*Et,nr=y.min(4*er,Fe);if(er){for(var dr=0;dr<er;dr+=Et)this._doProcessBlock(jt,dr);Ue=jt.splice(0,er),qe.sigBytes-=nr}return new oe.init(Ue,nr)},clone:function(){var Ce=re.clone.call(this);return Ce._data=this._data.clone(),Ce},_minBufferSize:0}),de=(z.Hasher=Ie.extend({cfg:re.extend(),init:function(Ce){this.cfg=this.cfg.extend(Ce),this.reset()},reset:function(){Ie.reset.call(this),this._doReset()},update:function(Ce){return this._append(Ce),this._process(),this},finalize:function(Ce){return Ce&&this._append(Ce),this._doFinalize()},blockSize:16,_createHelper:function(Ce){return function(Ue,qe){return new Ce.init(qe).finalize(Ue)}},_createHmacHelper:function(Ce){return function(Ue,qe){return new de.HMAC.init(Ce,qe).finalize(Ue)}}}),V.algo={});return V}(Math),g)}).call(this,e(77))},function(t,r,e){var n=e(29),g=e(20),y=e(157),i=e(84),k=e(47),L=e(130),$=e(31),V=e(214),z=Object.getOwnPropertyDescriptor;r.f=n?z:function(re,oe){if(re=k(re),oe=L(oe),V)try{return z(re,oe)}catch{}if($(re,oe))return i(!g(y.f,re,oe),re[oe])}},function(t,r){t.exports=function(e){return e==null}},function(t,r,e){var n=e(100),g=e(7);t.exports=!!Object.getOwnPropertySymbols&&!g(function(){var y=Symbol();return!String(y)||!(Object(y)instanceof Symbol)||!Symbol.sham&&n&&n<41})},function(t,r,e){var n,g,y=e(16),i=e(72),k=y.process,L=y.Deno,$=k&&k.versions||L&&L.version,V=$&&$.v8;V&&(g=(n=V.split("."))[0]>0&&n[0]<4?1:+(n[0]+n[1])),!g&&i&&(!(n=i.match(/Edge\/(\d+)/))||n[1]>=74)&&(n=i.match(/Chrome\/(\d+)/))&&(g=+n[1]),t.exports=g},function(t,r,e){var n=e(130),g=e(40),y=e(84);t.exports=function(i,k,L){var $=n(k);$ in i?g.f(i,$,y(0,L)):i[$]=L}},function(t,r){},function(t,r,e){var n,g,y,i=e(342),k=e(16),L=e(30),$=e(65),V=e(31),z=e(168),re=e(134),oe=e(117),le=k.TypeError,ue=k.WeakMap;if(i||z.state){var ie=z.state||(z.state=new ue);ie.get=ie.get,ie.has=ie.has,ie.set=ie.set,n=function(Ie,de){if(ie.has(Ie))throw le("Object already initialized");return de.facade=Ie,ie.set(Ie,de),de},g=function(Ie){return ie.get(Ie)||{}},y=function(Ie){return ie.has(Ie)}}else{var ae=re("state");oe[ae]=!0,n=function(Ie,de){if(V(Ie,ae))throw le("Object already initialized");return de.facade=Ie,$(Ie,ae,de),de},g=function(Ie){return V(Ie,ae)?Ie[ae]:{}},y=function(Ie){return V(Ie,ae)}}t.exports={set:n,get:g,has:y,enforce:function(Ie){return y(Ie)?g(Ie):n(Ie,{})},getterFor:function(Ie){return function(de){var Ce;if(!L(de)||(Ce=g(de)).type!==Ie)throw le("Incompatible receiver, "+Ie+" required");return Ce}}}},function(t,r,e){var n=e(13);t.exports=n([].slice)},function(t,r){t.exports={}},function(t,r){t.exports=function(e){try{return{error:!1,value:e()}}catch(n){return{error:!0,value:n}}}},function(t,r,e){var n=e(16);t.exports=n.Promise},function(t,r){t.exports=function(e){return e!=null&&typeof e=="object"}},function(t,r,e){var n=e(152),g=e(56),y=e(3),i=e(22),k=e(23),L=e(4),$=e(43),V=e(15),z=e(2),re=e(5),oe=e(11),le=e(125),ue=e(34),ie=e(44),ae=e(45),Ie=e(153),de=e(154),Ce=e(122);function Ue(ir){var tr=function(){if(typeof Reflect>"u"||!n||n.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(n(Boolean,[],function(){})),!0}catch{return!1}}();return function(){var ur,or=Ce(ir);if(tr){var fr=Ce(this).constructor;ur=n(or,arguments,fr)}else ur=or.apply(this,arguments);return de(this,ur)}}var qe=e(141),jt=e(0),Fe=e(12).heartbeatInterval,Et=e(165).V2NIMLoginStatus,cr=e(12),er={kSyncAction5_1:0,kSyncAction5_2:1,kSyncAction5_3:2},nr={kKnown:-1,kSucceed:0,kFailed:1,kAborted:2,kCanceled:3},dr=function(ir){Ie(ur,ir);var tr=Ue(ur);function ur(or){var fr,lr=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return ie(this,ur),(fr=tr.call(this)).clientProto=or,fr.logger=or.logger,fr.reporter=or.reporter,fr.timer=null,fr.setClientOrigin(),fr.serverOrigin={timeStamp:null,rtt:null,baseTimeStamp:null},fr.tolerantRTT=lr.tolerantRTT||3e3,fr.bestRTT=lr.bestRTT||100,fr.maxChances=lr.maxChances||10,fr.isSettingNTP=!1,fr.currentChance=0,fr.syncTraceData={},fr.syncTraceMap={},fr.syncTraceLastItem={},fr.uploadTraceData={},fr.setMonitorForSync(),fr.setMonitorForResources(),fr}return ae(ur,[{key:"hasOriginTimetick",value:function(){return!!this.serverOrigin.timeStamp}},{key:"setOriginTimetick",value:function(){var or=this,fr=this.clientProto.options;if((typeof jt.get(fr,"privateConf.isDataReportEnable")=="boolean"?fr.privateConf.isDataReportEnable:cr.privateConf.isDataReportEnable)&&cr.isBrowser&&performance&&performance.now&&!(this.isSettingNTP||this.currentChance>=this.maxChances)){this.isSettingNTP=!0,this.currentChance++,clearTimeout(this.timer),this.timer=null;var lr="ReporterHook::setOriginTimetick:",gr=g();return this.logger.info("".concat(lr," getServerTime start, times ").concat(this.currentChance)),new y(function(Sr){or.clientProto.sendCmd("getServerTime",{},function(wr,kr){if(or.isSettingNTP=!1,wr){var mr;or.logger.warn("".concat(lr," Calculate Delay time, getServerTime error"),wr),or.clientProto.statusProtector.getLoginStatus()===Et.V2NIM_LOGIN_STATUS_LOGINED&&(or.timer=i(k(mr=or.setOriginTimetick).call(mr,or),Fe)),Sr()}else{if(!kr)return or.logger.warn("".concat(lr," Calculate Delay time, getServerTime not correct")),void Sr();var Ir,Nr=g()-gr;if(Nr>or.tolerantRTT)or.logger.warn("".concat(lr," Denied, cause of exceeding the maximum tolerance range of RTT: ").concat(Nr)),or.timer=i(k(Ir=or.setOriginTimetick).call(Ir,or),Fe);else if(Nr>or.bestRTT){var Er,sr,xr;or.serverOrigin.rtt&&Nr>=or.serverOrigin.rtt?or.logger.info("".concat(lr," Denied, cause of current.RTT >= serverOrigin.RTT: ").concat(Nr)):(or.setServerOrigin(Nr,kr),or.logger.info(L(sr=L(xr="".concat(lr," Accept within maximum tolerance range of RTT: ").concat(Nr,", ntpTimestamp: ")).call(xr,or.serverOrigin.timeStamp,", localClock: ")).call(sr,or.serverOrigin.baseTimeStamp))),or.timer=i(k(Er=or.setOriginTimetick).call(Er,or),Fe)}else{var Or,Mr;or.setServerOrigin(Nr,kr),or.logger.info(L(Or=L(Mr="".concat(lr," Accept within best RTT: ").concat(Nr,", ntpTimestamp: ")).call(Mr,or.serverOrigin.timeStamp,", localClock: ")).call(Or,or.serverOrigin.baseTimeStamp))}Sr()}})})}}},{key:"getNTPTime",value:function(or){if(typeof or!="number"&&(or=this.getSafeClock()),this.serverOrigin.timeStamp){var fr=$(or-this.serverOrigin.baseTimeStamp);return this.serverOrigin.timeStamp+fr}var lr=$(or-this.clientOrigin.baseTimeStamp);return this.clientOrigin.timeStamp+lr}},{key:"getSafeClock",value:function(){return cr.isBrowser&&performance&&performance.now?performance.now():g()}},{key:"setMonitorForSync",value:function(){var or=this,fr="ReporterHook::setMonitorForSync:";this.on("reporter/syncStart",function(){or.logger.info("".concat(fr," sync start")),or.syncTraceData={user_id:or.clientProto.account,trace_id:jt.get(or.clientProto,"socket.socket.sessionid"),action:er.kSyncAction5_1,sync_begin_time:or.getSafeClock(),sync_end_time:0,sync_duration:0,overall_duration:0,extension:[]}}),this.on("reporter/syncRecv",function(){or.syncTraceData.user_id&&(or.logger.info("".concat(fr," sync receive packet")),or.syncTraceData.sync_end_time=or.getSafeClock(),or.syncTraceData.sync_duration=$(or.syncTraceData.sync_end_time-or.syncTraceData.sync_begin_time))}),this.on("reporter/syncItem",function(lr,gr){var Sr;if(typeof lr=="number"&&or.syncTraceData.user_id){or.logger.info(L(Sr="".concat(fr," receive sync item: ").concat(lr,", total: ")).call(Sr,gr));var wr=or.getSafeClock();or.syncTraceMap[lr]=or.syncTraceMap[lr]?or.syncTraceMap[lr]:{sync_type:lr,times:0,total:0,sync_duration:0,proc_duration:0,description:"",items:[]};var kr={total:gr,pre_item_recv_time:or.syncTraceLastItem.cur_item_recv_time?or.syncTraceLastItem.cur_item_recv_time:or.syncTraceData.sync_begin_time,cur_item_recv_time:wr};or.syncTraceMap[lr].items.push(kr),or.syncTraceLastItem=kr}}),this.on("reporter/syncItemComplete",function(lr){var gr;if(typeof lr=="number"&&or.syncTraceData.user_id){var Sr=or.syncTraceMap[lr];if(Sr){or.logger.info("".concat(fr," sync item ").concat(lr," callback done"));var wr=V(gr=Sr.items).call(gr,function(kr){return!kr.callback_time});wr.length!==0&&(wr[0].callback_time=or.getSafeClock())}}}),this.on("reporter/syncComplete",function(){var lr;or.syncTraceData.user_id&&(or.logger.info("".concat(fr," sync complete")),z(lr=re(or.syncTraceMap)).call(lr,function(gr){var Sr,wr=oe(Sr=or.syncTraceMap[gr].items).call(Sr,function(mr){return{total:mr.total,pre_item_recv_time:or.getNTPTime(mr.pre_item_recv_time),cur_item_recv_time:or.getNTPTime(mr.cur_item_recv_time),callback_time:or.getNTPTime(mr.callback_time)}}),kr=le(wr).call(wr,function(mr,Ir){return mr.times+=1,mr.total+=Ir.total,mr.sync_duration+=Ir.cur_item_recv_time-Ir.pre_item_recv_time,mr.proc_duration+=Ir.callback_time-Ir.cur_item_recv_time,mr},{times:0,total:0,sync_duration:0,proc_duration:0});or.syncTraceMap[gr].items=wr,ue(or.syncTraceMap[gr],kr),or.syncTraceData.extension.push(or.syncTraceMap[gr])}),or.syncTraceData.sync_begin_time=or.getNTPTime(or.syncTraceData.sync_begin_time),or.syncTraceData.sync_end_time=or.getNTPTime(or.syncTraceData.sync_end_time),or.syncTraceData.overall_duration=or.getNTPTime()-or.syncTraceData.sync_begin_time,or.reporter.report("nim_sdk_sync",or.syncTraceData),or.syncTraceData={},or.syncTraceMap={})})}},{key:"setMonitorForResources",value:function(){var or=this,fr="ReporterHook::setMonitorForResources:";this.on("reporter/uploadStart",function(){or.logger.info("".concat(fr," upload start")),or.uploadTraceData={user_id:or.clientProto.account,trace_id:jt.get(or.clientProto,"socket.socket.sessionid"),action:0,duration:0,start_time:or.getSafeClock(),offset:0,full_size:0,transferred_size:0}}),this.on("reporter/uploadUpdate",function(){var lr,gr=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};or.uploadTraceData.user_id&&(or.logger.info("".concat(fr," upload update"),gr),z(lr=re(gr)).call(lr,function(Sr){or.uploadTraceData[Sr]=gr[Sr]}))}),this.on("reporter/uploadEnd",function(){var lr=arguments.length>0&&arguments[0]!==void 0?arguments[0]:nr.kKnown;or.uploadTraceData.user_id&&(or.logger.info("".concat(fr," upload end cause of ").concat(lr)),or.uploadTraceData.state=lr,or.uploadTraceData.start_time=or.getNTPTime(or.uploadTraceData.start_time),or.uploadTraceData.duration=or.getNTPTime(or.getSafeClock())-or.uploadTraceData.start_time,or.reporter.report("nim_sdk_resources",or.uploadTraceData),or.uploadTraceData={})})}},{key:"destroy",value:function(){this.reset(),this.removeAllListeners(),this.logger.info("ReporterHook::destroy: complete")}},{key:"reset",value:function(){this.logger.info("ReporterHook::reset"),this.serverOrigin={},this.setClientOrigin(),this.currentChance=0,this.timer&&clearTimeout(this.timer),this.syncTraceData={},this.syncTraceMap={},this.syncTraceLastItem={},this.uploadTraceData={}}},{key:"setClientOrigin",value:function(){this.clientOrigin={timeStamp:g(),baseTimeStamp:this.getSafeClock()}}},{key:"setServerOrigin",value:function(or,fr){this.serverOrigin={timeStamp:fr+$(or/2),rtt:or,baseTimeStamp:this.getSafeClock()}}}]),ur}(qe);t.exports={EMSyncAction:er,EMSyncType:{kSyncType3_8:30008,kSyncType3_109:30109,kSyncType4_4:40004,kSyncType4_6:40006,kSyncType4_9:40009,kSyncType4_12:40012,kSyncType4_13:40013,kSyncType4_14:40014,kSyncType4_16:40016,kSyncType4_17:40017,kSyncType4_18:40018,kSyncType4_19:40019,kSyncType4_20:40020,kSyncType4_21:40021,kSyncType4_23:40023,kSyncType4_24:40024,kSyncType4_100:40100,kSyncType4_101:40101,kSyncType7_15:70015,kSyncType8_109:80109,kSyncType8_126:80126,kSyncType12_5:12005,kSyncType12_6:12006,kSyncType15_13:15013,kSyncType21_109:21109,kSyncType21_111:21111},ReporterHook:dr,EMExceptionState:nr,EMResourceUploadWay:{kResourceUploadWayNOS:0,kResourceUploadWayAWSPlugin:1,kResourceUploadWayNOSPlugin:2}}},function(t,r,e){var n=e(8),g=e(9),y=e(2),i=e(4),k=e(95),L=e(15),$=e(68),V=e(78),z=e(64),re=e(28);function oe(ae,Ie){var de=V!==void 0&&z(ae)||ae["@@iterator"];if(!de){if(re(ae)||(de=function(Et,cr){var er;if(Et){if(typeof Et=="string")return le(Et,cr);var nr=g(er=Object.prototype.toString.call(Et)).call(er,8,-1);if(nr==="Object"&&Et.constructor&&(nr=Et.constructor.name),nr==="Map"||nr==="Set")return $(Et);if(nr==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(nr))return le(Et,cr)}}(ae))||Ie&&ae&&typeof ae.length=="number"){de&&(ae=de);var Ce=0,Ue=function(){};return{s:Ue,n:function(){return Ce>=ae.length?{done:!0}:{done:!1,value:ae[Ce++]}},e:function(Et){throw Et},f:Ue}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var qe,jt=!0,Fe=!1;return{s:function(){de=de.call(ae)},n:function(){var Et=de.next();return jt=Et.done,Et},e:function(Et){Fe=!0,qe=Et},f:function(){try{jt||de.return==null||de.return()}finally{if(Fe)throw qe}}}}function le(ae,Ie){(Ie==null||Ie>ae.length)&&(Ie=ae.length);for(var de=0,Ce=new Array(Ie);de<Ie;de++)Ce[de]=ae[de];return Ce}var ue=e(12),ie={genUrlSep:function(ae){return n(ae=""+ae).call(ae,"?")===-1?"?imageView&":"&"},urlQuery2Object:function(ae){if(Object.prototype.toString.call(ae)!=="[object String]"||ae==="")return{};var Ie=n(ae).call(ae,"?");if(Ie!==-1){var de=g(ae).call(ae,Ie+1).split("&"),Ce={};return y(de).call(de,function(Ue){if(~n(Ue).call(Ue,"=")){var qe=Ue.split("=");Ce[qe[0]]=decodeURIComponent(qe[1])}else Ce[Ue]=""}),Ce}},url2object:function(ae){Object.prototype.toString.call(ae)!=="[object String]"&&(ae="");var Ie=n(ae=ae||"").call(ae,"https")>=0?"https://":"http://",de=ae.replace(Ie,"");n(de).call(de,"?")>=0&&(de=de.substring(0,n(de).call(de,"?")));var Ce=de.split("/");de=Ce[0];var Ue="";if(Ce.length>0&&(Ue=g(Ce).call(Ce,1).join("/")),n(ae).call(ae,"?")===-1)return{protocol:Ie,hostname:de,path:Ue,query:{}};var qe=ae.substr(n(ae).call(ae,"?")+1).split("&"),jt={};return y(qe).call(qe,function(Fe){if(n(Fe).call(Fe,"=")>0){var Et=Fe.split("=");jt[Et[0]]=decodeURIComponent(Et[1])}else jt[Fe]=""}),{protocol:Ie,hostname:de,path:Ue,query:jt}},object2url:function(ae){var Ie,de=ae.protocol,Ce=ae.hostname,Ue=ae.path,qe=ae.query;de=de||"http://",Ce=Ce||"",Ue&&(Ce=i(Ie="".concat(Ce,"/")).call(Ie,Ue)),qe=qe||{};var jt,Fe,Et,cr=[];for(var er in qe){var nr;er!=="imageView"&&cr.push(i(nr="".concat(er,"=")).call(nr,encodeURIComponent(qe[er])))}return cr.length>0?i(jt=i(Fe="".concat(de)).call(Fe,Ce,"?imageView&")).call(jt,cr.join("&")):i(Et="".concat(de)).call(Et,Ce)},genPrivateUrl:function(ae,Ie,de){if(Ie&&Ie.length){var Ce,Ue=oe(Ie);try{for(Ue.s();!(Ce=Ue.n()).done;){var qe=Ce.value;if(n(ae).call(ae,qe)>=0)return qe!==de&&(ae=ae.replace(qe,de)),ae;if(n(ae).call(ae,qe)>=0&&qe===de)return ae}}catch(mr){Ue.e(mr)}finally{Ue.f()}}var jt,Fe,Et=ie.url2object(ae),cr=Et.hostname,er=Et.path,nr=ue.downloadUrl,dr=ue.downloadHostList,ir=ue.nosCdnEnable,tr=ue.serverNosConfig.cdnDomain,ur=decodeURIComponent(ue.serverNosConfig.objectPrefix),or=decodeURIComponent(er),fr=n(or).call(or,ur);if(tr&&fr>-1&&ir)return i(jt=i(Fe="".concat(Et.protocol)).call(Fe,tr,"/")).call(jt,g(or).call(or,fr));if(k(dr).call(dr,cr)&&k(er).call(er,"/")){var lr=n(er).call(er,"/"),gr=er.substring(0,lr),Sr=er.substring(lr+1);return nr.replace("{bucket}",gr).replace("{object}",Sr)}var wr=L(dr).call(dr,function(mr){return typeof cr=="string"&&k(cr).call(cr,mr)})[0],kr=wr?cr.replace(wr,"").replace(/\W/g,""):null;return kr?nr.replace("{bucket}",kr).replace("{object}",er):ae}};t.exports=ie},function(t,r,e){var n=e(7);t.exports=!n(function(){var g=(function(){}).bind();return typeof g!="function"||g.hasOwnProperty("prototype")})},function(t,r,e){var n=e(98),g=TypeError;t.exports=function(y){if(n(y))throw g("Can't call method on "+y);return y}},function(t,r,e){var n=e(57),g=e(168);(t.exports=function(y,i){return g[y]||(g[y]=i!==void 0?i:{})})("versions",[]).push({version:"3.27.1",mode:n?"pure":"global",copyright:"© 2014-2022 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.27.1/LICENSE",source:"https://github.com/zloirock/core-js"})},function(t,r,e){var n=e(115),g=Math.max,y=Math.min;t.exports=function(i,k){var L=n(i);return L<0?g(L+k,0):y(L,k)}},function(t,r,e){var n=e(328);t.exports=function(g){var y=+g;return y!=y||y===0?0:n(y)}},function(t,r,e){var n=e(7),g=e(21),y=e(100),i=g("species");t.exports=function(k){return y>=51||!n(function(){var L=[];return(L.constructor={})[i]=function(){return{foo:1}},L[k](Boolean).foo!==1})}},function(t,r){t.exports={}},function(t,r,e){var n=e(234).charAt,g=e(58),y=e(103),i=e(176),k=e(177),L=y.set,$=y.getterFor("String Iterator");i(String,"String",function(V){L(this,{type:"String Iterator",string:g(V),index:0})},function(){var V,z=$(this),re=z.string,oe=z.index;return oe>=re.length?k(void 0,!0):(V=n(re,oe),z.index+=V.length,k(V,!1))})},function(t,r,e){var n=e(71),g=e(16);t.exports=n(g.process)=="process"},function(t,r,e){var n=e(16),g=e(107),y=e(17),i=e(215),k=e(219),L=e(21),$=e(406),V=e(249),z=e(57),re=e(100),oe=g&&g.prototype,le=L("species"),ue=!1,ie=y(n.PromiseRejectionEvent),ae=i("Promise",function(){var Ie=k(g),de=Ie!==String(g);if(!de&&re===66||z&&(!oe.catch||!oe.finally))return!0;if(!re||re<51||!/native code/.test(Ie)){var Ce=new g(function(qe){qe(1)}),Ue=function(qe){qe(function(){},function(){})};if((Ce.constructor={})[le]=Ue,!(ue=Ce.then(function(){})instanceof Ue))return!0}return!de&&($||V)&&!ie});t.exports={CONSTRUCTOR:ae,REJECTION_EVENT:ie,SUBCLASSING:ue}},function(t,r,e){t.exports=e(429)},function(t,r,e){var n=e(197),g=e(159),y=e(287);function i(k){var L;return t.exports=i=n?g(L=y).call(L):function($){return $.__proto__||y($)},t.exports.__esModule=!0,t.exports.default=t.exports,i(k)}t.exports=i,t.exports.__esModule=!0,t.exports.default=t.exports},function(t,r,e){var n=e(6),g=e(307),y=e(24),i=e(110).genPrivateUrl,k=e(0),L=k.notundef,$=k.exist,V=e(199),z=e(303),re=z.typeMap;function oe(le){le.resend?(k.verifyOptions(le,"idClient","msg::Message"),this.idClient=le.idClient):this.idClient=k.guid(),this.type=re[le.type],this.resend=le.resend?1:0,L(le.subType)&&(k.isInt(+le.subType)&&+le.subType>0?this.subType=+le.subType:k.onParamError("subType只能是大于0的整数","msg::Message")),L(le.custom)&&(y(le.custom)==="object"?this.custom=n(le.custom):this.custom=""+le.custom),L(le.text)&&(this.body=""+le.text),L(le.body)&&(this.body=""+le.body),L(le.yidunEnable)&&(this.yidunEnable=le.yidunEnable?1:0),L(le.antiSpamUsingYidun)&&(this.antiSpamUsingYidun=le.antiSpamUsingYidun?1:0),L(le.antiSpamContent)&&(y(le.antiSpamContent)==="object"?this.antiSpamContent=n(le.antiSpamContent):this.antiSpamContent=""+le.antiSpamContent),L(le.antiSpamBusinessId)&&(y(le.antiSpamBusinessId)==="object"?this.antiSpamBusinessId=n(le.antiSpamBusinessId):this.antiSpamBusinessId=""+le.antiSpamBusinessId),L(le.yidunAntiCheating)&&(this.yidunAntiCheating=le.yidunAntiCheating+""),L(le.skipHistory)&&(this.skipHistory=le.skipHistory?1:0),L(le.highPriority)&&(this.highPriority=le.highPriority?1:0),L(le.clientAntiSpam)&&(this.clientAntiSpam=le.clientAntiSpam?1:0),L(le.env)&&(this.env=le.env),L(le.notifyTargetTags)&&(this.notifyTargetTags=le.notifyTargetTags),L(le.yidunAntiSpamExt)&&(this.yidunAntiSpamExt=le.yidunAntiSpamExt),(L(le.loc_x)||L(le.loc_y)||L(le.loc_z))&&(this.loc_x=le.loc_x,this.loc_y=le.loc_y,this.loc_z=le.loc_z)}oe.validTypes=z.validTypes,k.merge(oe.prototype,z.prototype),oe.getType=z.getType,oe.setFlow=z.setFlow,oe.reverse=function(le){var ue=k.filterObj(le,"chatroomId idClient from fromNick fromAvatar _fromAvatar_safe fromCustom userUpdateTime custom status notifyTargetTags");return L(ue.fromAvatar)&&(ue.fromAvatar=i(ue.fromAvatar)),ue=k.merge(ue,{fromClientType:V.reverseType(le.fromClientType),time:+le.time,type:oe.getType(le),text:$(le.body)?le.body:le.text||"",resend:+le.resend==1}),L(ue.userUpdateTime)&&(ue.userUpdateTime=+ue.userUpdateTime),L(le.callbackExt)&&(ue.callbackExt=le.callbackExt),L(le.subType)&&(ue.subType=+le.subType),L(le.yidunAntiSpamRes)&&(ue.yidunAntiSpamRes=le.yidunAntiSpamRes),L(le.loc_x)&&(ue.x=g(le.loc_x),ue.y=g(le.loc_y),ue.z=g(le.loc_z)),L(le.toAccids)&&(ue.toAccids=le.toAccids),ue.status=ue.status||"success",ue},oe.setExtra=function(le,ue){z.setFlow(le,ue)},t.exports=oe},function(t,r,e){var n=e(221),g=e(174);t.exports=Object.keys||function(y){return n(y,g)}},function(t,r,e){t.exports=e(450)},function(t,r,e){var n=e(181),g=e(510),y=e(511),i=n?n.toStringTag:void 0;t.exports=function(k){return k==null?k===void 0?"[object Undefined]":"[object Null]":i&&i in Object(k)?g(k):y(k)}},function(t,r,e){var n=e(602),g=e(194),y=e(609);t.exports=function(i,k){if(i==null)return{};var L,$,V=y(i,k);if(n){var z=n(i);for($=0;$<z.length;$++)L=z[$],g(k).call(k,L)>=0||Object.prototype.propertyIsEnumerable.call(i,L)&&(V[L]=i[L])}return V},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,r,e){t.exports=e(576)},function(t,r,e){var n=e(13),g=e(7),y=e(71),i=Object,k=n("".split);t.exports=g(function(){return!i("z").propertyIsEnumerable(0)})?function(L){return y(L)=="String"?k(L,""):i(L)}:i},function(t,r,e){var n=e(325),g=e(131);t.exports=function(y){var i=n(y,"string");return g(i)?i:i+""}},function(t,r,e){var n=e(33),g=e(17),y=e(18),i=e(213),k=Object;t.exports=i?function(L){return typeof L=="symbol"}:function(L){var $=n("Symbol");return g($)&&y($.prototype,k(L))}},function(t,r,e){var n=e(13),g=0,y=Math.random(),i=n(1 .toString);t.exports=function(k){return"Symbol("+(k===void 0?"":k)+")_"+i(++g+y,36)}},function(t,r,e){var n=e(13),g=e(7),y=e(17),i=e(73),k=e(33),L=e(219),$=function(){},V=[],z=k("Reflect","construct"),re=/^\s*(?:class|function)\b/,oe=n(re.exec),le=!re.exec($),ue=function(ae){if(!y(ae))return!1;try{return z($,V,ae),!0}catch{return!1}},ie=function(ae){if(!y(ae))return!1;switch(i(ae)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return le||!!oe(re,L(ae))}catch{return!0}};ie.sham=!0,t.exports=!z||g(function(){var ae;return ue(ue.call)||!ue(Object)||!ue(function(){ae=!0})||ae})?ie:ue},function(t,r,e){var n=e(113),g=e(132),y=n("keys");t.exports=function(i){return y[i]||(y[i]=g(i))}},function(t,r,e){var n=e(221),g=e(174).concat("length","prototype");r.f=Object.getOwnPropertyNames||function(y){return n(y,g)}},function(t,r){r.f=Object.getOwnPropertySymbols},function(t,r,e){var n=e(21);r.f=n},function(t,r,e){var n=e(31),g=e(17),y=e(46),i=e(134),k=e(233),L=i("IE_PROTO"),$=Object,V=$.prototype;t.exports=k?$.getPrototypeOf:function(z){var re=y(z);if(n(re,L))return re[L];var oe=re.constructor;return g(oe)&&re instanceof oe?oe.prototype:re instanceof $?V:null}},function(t,r,e){var n=e(13),g=e(38),y=e(362);t.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var i,k=!1,L={};try{(i=n(Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set))(L,[]),k=L instanceof Array}catch{}return function($,V){return g($),y(V),k?i($,V):$.__proto__=V,$}}():void 0)},function(t,r,e){var n=e(73),g=e(167),y=e(98),i=e(105),k=e(21)("iterator");t.exports=function(L){if(!y(L))return g(L,k)||g(L,"@@iterator")||i[n(L)]}},function(t,r,e){var n=Object.prototype.hasOwnProperty,g="~";function y(){}function i(V,z,re){this.fn=V,this.context=z,this.once=re||!1}function k(V,z,re,oe,le){if(typeof re!="function")throw new TypeError("The listener must be a function");var ue=new i(re,oe||V,le),ie=g?g+z:z;return V._events[ie]?V._events[ie].fn?V._events[ie]=[V._events[ie],ue]:V._events[ie].push(ue):(V._events[ie]=ue,V._eventsCount++),V}function L(V,z){--V._eventsCount==0?V._events=new y:delete V._events[z]}function $(){this._events=new y,this._eventsCount=0}Object.create&&(y.prototype=Object.create(null),new y().__proto__||(g=!1)),$.prototype.eventNames=function(){var V,z,re=[];if(this._eventsCount===0)return re;for(z in V=this._events)n.call(V,z)&&re.push(g?z.slice(1):z);return Object.getOwnPropertySymbols?re.concat(Object.getOwnPropertySymbols(V)):re},$.prototype.listeners=function(V){var z=g?g+V:V,re=this._events[z];if(!re)return[];if(re.fn)return[re.fn];for(var oe=0,le=re.length,ue=new Array(le);oe<le;oe++)ue[oe]=re[oe].fn;return ue},$.prototype.listenerCount=function(V){var z=g?g+V:V,re=this._events[z];return re?re.fn?1:re.length:0},$.prototype.emit=function(V,z,re,oe,le,ue){var ie=g?g+V:V;if(!this._events[ie])return!1;var ae,Ie,de=this._events[ie],Ce=arguments.length;if(de.fn){switch(de.once&&this.removeListener(V,de.fn,void 0,!0),Ce){case 1:return de.fn.call(de.context),!0;case 2:return de.fn.call(de.context,z),!0;case 3:return de.fn.call(de.context,z,re),!0;case 4:return de.fn.call(de.context,z,re,oe),!0;case 5:return de.fn.call(de.context,z,re,oe,le),!0;case 6:return de.fn.call(de.context,z,re,oe,le,ue),!0}for(Ie=1,ae=new Array(Ce-1);Ie<Ce;Ie++)ae[Ie-1]=arguments[Ie];de.fn.apply(de.context,ae)}else{var Ue,qe=de.length;for(Ie=0;Ie<qe;Ie++)switch(de[Ie].once&&this.removeListener(V,de[Ie].fn,void 0,!0),Ce){case 1:de[Ie].fn.call(de[Ie].context);break;case 2:de[Ie].fn.call(de[Ie].context,z);break;case 3:de[Ie].fn.call(de[Ie].context,z,re);break;case 4:de[Ie].fn.call(de[Ie].context,z,re,oe);break;default:if(!ae)for(Ue=1,ae=new Array(Ce-1);Ue<Ce;Ue++)ae[Ue-1]=arguments[Ue];de[Ie].fn.apply(de[Ie].context,ae)}}return!0},$.prototype.on=function(V,z,re){return k(this,V,z,re,!1)},$.prototype.once=function(V,z,re){return k(this,V,z,re,!0)},$.prototype.removeListener=function(V,z,re,oe){var le=g?g+V:V;if(!this._events[le])return this;if(!z)return L(this,le),this;var ue=this._events[le];if(ue.fn)ue.fn!==z||oe&&!ue.once||re&&ue.context!==re||L(this,le);else{for(var ie=0,ae=[],Ie=ue.length;ie<Ie;ie++)(ue[ie].fn!==z||oe&&!ue[ie].once||re&&ue[ie].context!==re)&&ae.push(ue[ie]);ae.length?this._events[le]=ae.length===1?ae[0]:ae:L(this,le)}return this},$.prototype.removeAllListeners=function(V){var z;return V?(z=g?g+V:V,this._events[z]&&L(this,z)):(this._events=new y,this._eventsCount=0),this},$.prototype.off=$.prototype.removeListener,$.prototype.addListener=$.prototype.on,$.prefixed=g,$.EventEmitter=$,t.exports=$},function(t,r,e){t.exports=e(413)},function(t,r,e){t.exports=e(438)},function(t,r,e){t.exports=e(455)},function(t,r,e){var n=e(499),g=e(500),y=e(501),i=e(502),k=e(503);function L($){var V=-1,z=$==null?0:$.length;for(this.clear();++V<z;){var re=$[V];this.set(re[0],re[1])}}L.prototype.clear=n,L.prototype.delete=g,L.prototype.get=y,L.prototype.has=i,L.prototype.set=k,t.exports=L},function(t,r,e){var n=e(204);t.exports=function(g,y){for(var i=g.length;i--;)if(n(g[i][0],y))return i;return-1}},function(t,r,e){var n=e(91)(Object,"create");t.exports=n},function(t,r,e){var n=e(523);t.exports=function(g,y){var i=g.__data__;return n(y)?i[typeof y=="string"?"string":"hash"]:i.map}},function(t,r,e){var n=e(268),g=e(269);t.exports=function(y,i,k,L){var $=!k;k||(k={});for(var V=-1,z=i.length;++V<z;){var re=i[V],oe=L?L(k[re],y[re],re,k,y):void 0;oe===void 0&&(oe=y[re]),$?g(k,re,oe):n(k,re,oe)}return k}},function(t,r){t.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},function(t,r){t.exports=`	
\v\f\r                　\u2028\u2029\uFEFF`},function(t,r,e){t.exports=e(286)},function(t,r,e){var n=e(195),g=e(142),y=e(196);t.exports=function(i,k){if(typeof k!="function"&&k!==null)throw new TypeError("Super expression must either be null or a function");i.prototype=n(k&&k.prototype,{constructor:{value:i,writable:!0,configurable:!0}}),g(i,"prototype",{writable:!1}),k&&y(i,k)},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,r,e){var n=e(24).default,g=e(640);t.exports=function(y,i){if(i&&(n(i)==="object"||typeof i=="function"))return i;if(i!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return g(y)},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,r){var e={link:{id:1,heartbeat:2,negotiateTransport:5,initTransport:6},sync:{id:5,sync:1,syncTeamMembers:2},misc:{id:6,getSimpleNosToken:1,getNosToken:2,notifyUploadLog:3,uploadSdkLogUrl:4,audioToText:5,processImage:6,getNosTokenTrans:7,notifyTransLog:8,fetchFile:9,fetchFileList:10,removeFile:11,getClientAntispam:17,fileQuickTransfer:18,getNosOriginUrl:22,getServerTime:23,getNosAccessToken:24,deleteNosAccessToken:25,getNosCdnHost:26,getGrayscaleConfig:27,getMixStorePolicy:28,getMixStoreToken:29,getBackSourceToken:30,uploadDetect:32},avSignal:{id:15,signalingCreate:1,signalingDelay:2,signalingClose:3,signalingJoin:4,signalingLeave:5,signalingInvite:6,signalingCancel:7,signalingReject:8,signalingAccept:9,signalingControl:10,signalingNotify:11,signalingMutilClientSyncNotify:12,signalingUnreadMessageSyncNotify:13,signalingChannelsSyncNotify:14,signalingGetChannelInfo:15,signalingCallEx:16,signalingJoinAndAccept:17}},n={heartbeat:{sid:e.link.id,cid:e.link.heartbeat},negotiateTransport:{sid:e.link.id,cid:e.link.negotiateTransport,params:[{type:"Int",name:"sdkVersion"},{type:"Property",name:"negotiateTransportTag"}]},initTransport:{sid:e.link.id,cid:e.link.initTransport,params:[{type:"Property",name:"initTransportTag"}]},getGrayscaleConfig:{sid:e.misc.id,cid:e.misc.getGrayscaleConfig,params:[{type:"Property",name:"providers"}]},getMixStorePolicy:{sid:e.misc.id,cid:e.misc.getMixStorePolicy,params:[{type:"LongArray",name:"providers"}]},getMixStoreToken:{sid:e.misc.id,cid:e.misc.getMixStoreToken,params:[{type:"Property",name:"mixTokenReq"}]},getBackSourceToken:{sid:e.misc.id,cid:e.misc.getBackSourceToken,params:[{type:"Property",name:"mixAuthTokenReq"}]},uploadDetect:{sid:e.misc.id,cid:e.misc.uploadDetect,isAwaitable:!1,params:[{type:"Property",name:"notifyDetectTag"}]},getSimpleNosToken:{sid:e.misc.id,cid:e.misc.getSimpleNosToken,params:[{type:"Int",name:"num"}]},getNosToken:{sid:e.misc.id,cid:e.misc.getNosToken,params:[{type:"String",name:"responseBody"},{type:"Property",name:"nosToken",entity:"nosToken"}]},uploadSdkLogUrl:{sid:e.misc.id,cid:e.misc.uploadSdkLogUrl,params:[{type:"String",name:"url"},{type:"Property",name:"uploadTaskTag"}]},audioToText:{sid:e.misc.id,cid:e.misc.audioToText,params:[{type:"Property",name:"audioToText"}]},processImage:{sid:e.misc.id,cid:e.misc.processImage,params:[{type:"String",name:"url"},{type:"PropertyArray",name:"imageOps",entity:"imageOp"}]},getClientAntispam:{sid:e.misc.id,cid:e.misc.getClientAntispam,params:[{type:"Property",name:"clientAntispam"}]},fileQuickTransfer:{sid:e.misc.id,cid:e.misc.fileQuickTransfer,params:[{type:"Property",name:"fileQuickTransfer"}]},getNosOriginUrl:{sid:e.misc.id,cid:e.misc.getNosOriginUrl,params:[{type:"Property",name:"nosFileUrlTag"}]},getServerTime:{sid:e.misc.id,cid:e.misc.getServerTime,params:[]},getNosAccessToken:{sid:e.misc.id,cid:e.misc.getNosAccessToken,params:[{type:"Property",name:"nosAccessTokenTag"}]},deleteNosAccessToken:{sid:e.misc.id,cid:e.misc.deleteNosAccessToken,params:[{type:"Property",name:"nosAccessTokenTag"}]},getNosTokenTrans:{sid:e.misc.id,cid:e.misc.getNosTokenTrans,params:[{type:"Property",name:"transToken"}]},fetchFile:{sid:e.misc.id,cid:e.misc.fetchFile,params:[{type:"String",name:"docId"}]},fetchFileList:{sid:e.misc.id,cid:e.misc.fetchFileList,params:[{type:"Property",name:"fileListParam"}]},removeFile:{sid:e.misc.id,cid:e.misc.removeFile,params:[{type:"String",name:"docId"}]},getNosCdnHost:{sid:e.misc.id,cid:e.misc.getNosCdnHost,params:[]},signalingCreate:{sid:e.avSignal.id,cid:e.avSignal.signalingCreate,params:[{type:"Property",name:"avSignalTag"}]},signalingDelay:{sid:e.avSignal.id,cid:e.avSignal.signalingDelay,params:[{type:"Property",name:"avSignalTag"}]},signalingClose:{sid:e.avSignal.id,cid:e.avSignal.signalingClose,params:[{type:"Property",name:"avSignalTag"}]},signalingJoin:{sid:e.avSignal.id,cid:e.avSignal.signalingJoin,params:[{type:"Property",name:"avSignalTag"}]},signalingLeave:{sid:e.avSignal.id,cid:e.avSignal.signalingLeave,params:[{type:"Property",name:"avSignalTag"}]},signalingInvite:{sid:e.avSignal.id,cid:e.avSignal.signalingInvite,params:[{type:"Property",name:"avSignalTag"}]},signalingCancel:{sid:e.avSignal.id,cid:e.avSignal.signalingCancel,params:[{type:"Property",name:"avSignalTag"}]},signalingReject:{sid:e.avSignal.id,cid:e.avSignal.signalingReject,params:[{type:"Property",name:"avSignalTag"}]},signalingAccept:{sid:e.avSignal.id,cid:e.avSignal.signalingAccept,params:[{type:"Property",name:"avSignalTag"}]},signalingControl:{sid:e.avSignal.id,cid:e.avSignal.signalingControl,params:[{type:"Property",name:"avSignalTag"}]},signalingGetChannelInfo:{sid:e.avSignal.id,cid:e.avSignal.signalingGetChannelInfo,params:[{type:"Property",name:"avSignalTag"}]},signalingCallEx:{sid:e.avSignal.id,cid:e.avSignal.signalingCallEx,params:[{type:"Property",name:"avSignalTag"}]},signalingJoinAndAccept:{sid:e.avSignal.id,cid:e.avSignal.signalingJoinAndAccept,params:[{type:"Property",name:"avSignalTag"}]}};t.exports={idMap:e,cmdConfig:n,packetConfig:{"1_2":{service:"link",cmd:"heartbeat",response:[]},"1_5":{service:"link",cmd:"negotiateTransport",response:[{type:"Property",name:"negotiateTransportTag"}]},"1_6":{service:"link",cmd:"initTransport",response:[{type:"Property",name:"initTransportTag"}]},"6_1":{service:"misc",cmd:"getSimpleNosToken",response:[{type:"PropertyArray",name:"nosTokens",entity:"nosToken"}]},"6_2":{service:"misc",cmd:"getNosToken",response:[{type:"Property",name:"nosToken"}]},"6_3":{service:"misc",cmd:"notifyUploadLog"},"6_4":{service:"misc",cmd:"uploadSdkLogUrl"},"6_5":{service:"misc",cmd:"audioToText",response:[{type:"String",name:"text"}]},"6_6":{service:"misc",cmd:"processImage",response:[{type:"String",name:"url"}]},"6_7":{service:"misc",cmd:"getNosTokenTrans",response:[{type:"Property",name:"nosToken"},{type:"String",name:"docId"}]},"6_8":{service:"misc",cmd:"notifyTransLog",response:[{type:"Property",name:"transInfo"}]},"6_9":{service:"misc",cmd:"fetchFile",response:[{type:"Property",name:"info",entity:"transInfo"}]},"6_10":{service:"misc",cmd:"fetchFileList",response:[{type:"PropertyArray",name:"list",entity:"transInfo"},{type:"Int",name:"totalCount"}]},"6_11":{service:"misc",cmd:"removeFile",response:[{type:"String",name:"res"}]},"6_17":{service:"misc",cmd:"getClientAntispam",response:[{type:"Property",name:"clientAntispam"}]},"6_18":{service:"misc",cmd:"fileQuickTransfer",response:[{type:"Property",name:"fileQuickTransfer"}]},"6_22":{service:"misc",cmd:"getNosOriginUrl",response:[{type:"Property",name:"nosFileUrlTag"}]},"6_23":{service:"misc",cmd:"getServerTime",response:[{type:"Long",name:"time"}]},"6_24":{service:"misc",cmd:"getNosAccessToken",response:[{type:"Property",name:"nosAccessTokenTag"}]},"6_25":{service:"misc",cmd:"deleteNosAccessToken"},"6_26":{service:"misc",cmd:"getNosCdnHost",response:[{type:"Property",name:"nosConfigTag"}]},"6_27":{service:"misc",cmd:"getGrayscaleConfig",response:[{type:"Property",name:"appGrayConfigTag"}]},"6_28":{service:"misc",cmd:"getMixStorePolicy",response:[{type:"Property",name:"mixStorePolicyTag"}]},"6_29":{service:"misc",cmd:"getMixStoreToken",response:[{type:"Property",name:"mixStoreTokenTag"}]},"6_30":{service:"misc",cmd:"getBackSourceToken",response:[{type:"Property",name:"backSourceTokenTag"}]},"6_31":{service:"link",cmd:"notifyDetect",response:[{type:"Property",name:"notifyDetectTag"}]},"6_32":{service:"link",cmd:"uploadDetect",response:[]},"15_1":{service:"avSignal",cmd:"signalingCreate",response:[{type:"Property",name:"avSignalTag"}]},"15_2":{service:"avSignal",cmd:"signalingDelay",response:[{type:"Property",name:"avSignalTag"}]},"15_3":{service:"avSignal",cmd:"signalingClose",response:[{type:"Property",name:"avSignalTag"}]},"15_4":{service:"avSignal",cmd:"signalingJoin",response:[{type:"Property",name:"avSignalTag"}]},"15_5":{service:"avSignal",cmd:"signalingLeave",response:[]},"15_6":{service:"avSignal",cmd:"signalingInvite",response:[]},"15_7":{service:"avSignal",cmd:"signalingCancel",response:[]},"15_8":{service:"avSignal",cmd:"signalingReject",response:[]},"15_9":{service:"avSignal",cmd:"signalingAccept",response:[]},"15_10":{service:"avSignal",cmd:"signalingControl",response:[]},"15_11":{service:"avSignal",cmd:"signalingNotify",response:[{type:"Property",name:"avSignalTag"}]},"15_12":{service:"avSignal",cmd:"signalingMutilClientSyncNotify",response:[{type:"Property",name:"avSignalTag"}]},"15_13":{service:"avSignal",cmd:"signalingUnreadMessageSyncNotify",response:[{type:"PropertyArray",name:"avSignalTag"}]},"15_14":{service:"avSignal",cmd:"signalingChannelsSyncNotify",response:[{type:"PropertyArray",name:"avSignalTag"}]},"15_15":{service:"avSignal",cmd:"signalingGetChannelInfo",response:[{type:"Property",name:"avSignalTag"}]},"15_16":{service:"avSignal",cmd:"signalingCallEx",response:[{type:"Property",name:"avSignalTag"}]},"15_17":{service:"avSignal",cmd:"signalingJoinAndAccept",response:[{type:"Property",name:"avSignalTag"}]}},CMD_TYPE_PROPERTY:"Property",CMD_TYPE_BYTE:"Byte",CMD_TYPE_INT:"Int",CMD_TYPE_BOOL:"Bool",CMD_TYPE_LONG:"Long",CMD_TYPE_STRING:"String",CMD_TYPE_STR_STR_MAP:"StrStrMap",CMD_TYPE_STR_LONG_MAP:"StrLongMap",CMD_TYPE_LONG_LONG_MAP:"LongLongMap",CMD_TYPE_STR_ARRAY:"StrArray",CMD_TYPE_LONG_ARRAY:"LongArray",CMD_TYPE_PROPERTY_ARRAY:"PropertyArray",CMD_TYPE_KV_ARRAY:"KVArray"}},function(t,r,e){var n,g=e(19),y=e(2),i=e(11),k=e(3),L=e(4),$=e(8),V=e(23),z=e(6),re=e(110).urlQuery2Object,oe=e(0),le=e(35),ue=e(775),ie=e(776),ae=e(777),Ie=e(778),de=e(779),Ce=e(780);function Ue(Et){this.mixin(Et)}Ue.prototype=g((function(){}).prototype,{protocol:{value:null,writable:!0,enumerable:!0,configurable:!0}}),Ue.prototype.setProtocol=function(Et){this.protocol=Et},Ue.prototype.mixin=function(Et){var cr,er,nr=this;this.configMap=this.configMap||{},y(cr=["idMap","cmdConfig","packetConfig"]).call(cr,function(dr){nr.configMap[dr]=oe.merge({},nr.configMap[dr],Et.configMap&&Et.configMap[dr])}),y(er=["serializeMap","unserializeMap"]).call(er,function(dr){nr[dr]=oe.merge({},nr[dr],Et[dr])})},Ue.prototype.createCmd=(n=1,function(Et,cr){var er,nr=this,dr=this.configMap.cmdConfig[Et],ir=this.configMap.packetConfig[dr.sid+"_"+dr.cid],tr=Et==="heartbeat"?0:n++;return tr>32767&&(tr=1,n=2),Et={SID:dr.sid,CID:dr.cid,SER:tr,isAwaitable:typeof dr.isAwaitable=="boolean"?dr.isAwaitable:!(!ir||!ir.response)},dr.params&&(Et.Q=[],y(er=dr.params).call(er,function(ur){var or=ur.type,fr=ur.name,lr=ur.entity,gr=cr[fr];if(!oe.undef(gr)){switch(or){case"PropertyArray":or="ArrayMable",gr=i(gr).call(gr,function(Sr){return{t:"Property",v:nr.serialize(Sr,lr)}});break;case"Property":gr=nr.serialize(gr,fr);break;case"bool":gr=gr?"true":"false"}Et.Q.push({t:or,v:gr})}})),Et}),Ue.prototype.parseResponse=function(Et){var cr=this;return new k(function(er){var nr=JSON.parse(Et),dr={raw:nr,rawStr:Et,error:le.genError(nr.code)},ir=cr.configMap.packetConfig[nr.sid+"_"+nr.cid];if(!ir)return dr.notFound={sid:nr.sid,cid:nr.cid},void er(dr);var tr=nr.r,ur=ir.service==="notify"&&!ir.cmd;if(dr.isNotify=ur,ur){var or=nr.r[1].headerPacket;if(ir=cr.configMap.packetConfig[or.sid+"_"+or.cid],tr=nr.r[1].body,!ir)return dr.notFound={sid:or.sid,cid:or.cid},void er(dr)}if(dr.service=ir.service,dr.cmd=ir.cmd,dr.error){var fr,lr,gr=L(fr="".concat(nr.sid,"_")).call(fr,nr.cid);if(ur&&(gr=L(lr="".concat(or.sid,"_")).call(lr,or.cid)),dr.error.cmd=dr.cmd,dr.error.callFunc="protocol::parseResponse: ".concat(gr),dr.error.code===416){var Sr=tr[0];Sr&&(dr.frequencyControlDuration=1e3*Sr)}}var wr,kr=!1;dr.error&&ir.trivialErrorCodes&&(kr=$(wr=ir.trivialErrorCodes).call(wr,dr.error.code)!==-1);var mr=[];if((!dr.error||kr)&&ir.response){var Ir;dr.content={};var Nr=function(Er,sr,xr,Or){if(Er&&Or==="msg"||Or==="sysMsg"){var Mr=xr.content[Or];oe.isObject(Mr)&&!Mr.idServer&&(Mr.idServer=""+sr.r[0])}};y(Ir=ir.response).call(Ir,function(Er,sr){var xr,Or=tr[sr];if(!oe.undef(Or)){var Mr=Er.type,br=Er.name,hr=Er.entity||br;switch(Mr){case"Property":mr.push(cr.unserialize(Or,hr).then(V(xr=function(Tr,Br,Fr,Lr,qr){Fr.content[Lr]=qr,Nr(Tr,Br,Fr,Lr)}).call(xr,this,ur,nr,dr,br)));break;case"PropertyArray":dr.content[br]=[],y(Or).call(Or,function(Tr,Br){var Fr;mr.push(cr.unserialize(Tr,hr).then(V(Fr=function(Lr,qr,Ur){Lr.content[qr][Br]=Ur}).call(Fr,this,dr,br)))});break;case"KVArray":dr.content[br]=Or,Nr(ur,nr,dr,br);break;case"long":case"Long":case"byte":case"Byte":case"Number":dr.content[br]=+Or;break;default:dr.content[br]=Or,Nr(ur,nr,dr,br)}}})}k.all(mr).then(function(){er(dr)})})},Ue.prototype.serialize=function(Et,cr){var er=this.serializeMap[cr],nr={};for(var dr in er)Et.hasOwnProperty(dr)&&(nr[er[dr]]=Et[dr]);return nr},Ue.prototype.matchNosSafeUrl=function(Et){if(!oe.isString(Et)||!~$(Et).call(Et,"_im_url=1"))return!1;var cr=re(Et);return!(!cr||!cr._im_url||cr._im_url!=1)},Ue.prototype.getOneNosOriginUrl=function(Et,cr,er){var nr=this;return new k(function(dr){nr.protocol.getNosOriginUrlReqNum++,nr.protocol.sendCmd("getNosOriginUrl",{nosFileUrlTag:{safeUrl:Et}},function(ir,tr,ur){nr.protocol.getNosOriginUrlReqNum--,ir?nr.protocol.logger.warn("error: get nos originUrl failed",ir):(cr["_"+er+"_safe"]=cr[er],cr[er]=ur.nosFileUrlTag&&ur.nosFileUrlTag.originUrl),dr()})})},Ue.prototype.checkObjSafeUrl=function(Et,cr,er){var nr=this;for(var dr in Et)if(Et.hasOwnProperty(dr)){var ir=Et[dr];if(oe.isString(ir)){if(this.matchNosSafeUrl(ir)){var tr=this.getOneNosOriginUrl(ir,Et,dr);cr.push(tr),er.push(tr)}}else oe.isObject(ir)?this.checkObjSafeUrl(ir,cr,er):oe.isArray(ir)&&y(ir).call(ir,function(ur){oe.isObject(ur)&&nr.checkObjSafeUrl(ur,cr,er)})}};var qe=["url","avatar","fromAvatar","chatroomAvatar"];Ue.prototype.unserialize=function(Et,cr){var er=this;return new k(function(nr){var dr=er.unserializeMap[cr],ir={},tr=[];if(Et)for(var ur in dr){var or,fr=[];if(Et.hasOwnProperty(ur)&&(ir[dr[ur]]=Et[ur],er.protocol.hasLogin&&!er.protocol.keepNosSafeUrl))if(dr[ur]==="attach"&&Et[ur]&&$(Et[ur])&&~$(or=Et[ur]).call(or,"_im_url=1"))try{var lr,gr=JSON.parse(Et[ur]);gr.isS3||er.checkObjSafeUrl(gr,fr,tr),k.all(fr).then(V(lr=function(Sr,wr){Sr.attach=z(wr)}).call(lr,er,ir,gr))}catch(Sr){er.logger.warn("unserialize",Sr&&Sr.message)}else~$(qe).call(qe,dr[ur])&&Et[ur]&&er.matchNosSafeUrl(Et[ur])&&tr.push(er.getOneNosOriginUrl(Et[ur],ir,dr[ur]))}k.all(tr).then(function(){nr(ir)})})},Ue.prototype.syncUnserialize=function(Et,cr){var er=this.unserializeMap[cr],nr={};if(Et)for(var dr in er)Et.hasOwnProperty(dr)&&(nr[er[dr]]=Et[dr]);return nr};var jt=new Ue({configMap:ue,serializeMap:ie,unserializeMap:ae}),Fe=new Ue({configMap:Ie,serializeMap:de,unserializeMap:Ce});t.exports={IM:jt,Chatroom:Fe}},function(t,r,e){var n={}.propertyIsEnumerable,g=Object.getOwnPropertyDescriptor,y=g&&!n.call({1:2},1);r.f=y?function(i){var k=g(this,i);return!!k&&k.enumerable}:n},function(t,r,e){t.exports=e(336)},function(t,r,e){t.exports=e(637)},function(t,r,e){var n=e(11),g=e(10),y=e(0),i=y.notundef,k=y.fillPropertyWithDefault,L={0:"normal",1:"owner",2:"manager"};function $(V){y.verifyOptions(V,"teamId","team::TeamMember"),y.verifyParamAtLeastPresentOne(V,"nickInTeam muteTeam muteNotiType custom","team::TeamMember"),this.teamId=V.teamId,i(V.account)&&(this.account=V.account),i(V.nickInTeam)&&(this.nickInTeam=V.nickInTeam),i(V.muteNotiType)?this.bits=V.muteNotiType:i(V.muteTeam)&&(this.bits=0,V.muteTeam&&(this.bits+=1)),i(V.mute)&&(this.mute=V.mute?1:0),i(V.custom)&&(this.custom=""+V.custom)}$.reverse=function(V){var z=y.copy(V);if(i(z.teamId)&&(z.teamId=""+z.teamId),i(z.type)&&(z.type=L[z.type]),i(z.active)&&(z.active=+z.active==1),i(z.valid)&&(z.valid=+z.valid==1),i(z.mute)&&(z.mute=+z.mute==1),i(z.joinTime)&&(z.joinTime=+z.joinTime),i(z.updateTime)&&(z.updateTime=+z.updateTime),i(z.bits)){var re=z.bits;delete z.bits,z.muteTeam=!!(1&re),z.muteNotiType=re}return i(z.teamId)&&i(z.account)&&(z.id=$.genId(z.teamId,z.account)),i(z.followAccountIds)&&(z.followAccountIds=JSON.parse(z.followAccountIds)),z},$.reverseMembers=function(V){return n(V).call(V,function(z){return g($).call($,z)})},$.fillProperties=function(V){var z=k(V,"mute",!1),re=k(V,"custom","");return z||re},$.genId=function(V,z){return V+"-"+z},$.accounts2ids=function(V,z){return n(z).call(z,function(re){return $.genId(V,re)})},$.assembleMembers=function(V,z){return y.isArray(z)||(z=[z]),n(z).call(z,function(re){return $.assembleMember(V,re)})},$.assembleMember=function(V,z){return{id:$.genId(V.teamId,z),account:z,teamId:V.teamId,type:"normal",nickInTeam:"",muteTeam:!1,mute:!1,joinTime:V.memberUpdateTime,updateTime:V.memberUpdateTime,active:!0,valid:!0,invitorAccid:"",followAccountIds:[]}},$.assembleOwner=function(V){var z=$.assembleMember(V,V.owner);return z.type="owner",z},t.exports=$},function(t,r,e){var n,g=e(24),y=e(8),i=e(6),k=e(4),L=e(5),$=e(10),V=e(15),z=e(11),re=e(2),oe=e(0),le=oe.undef,ue=oe.notundef,ie=e(156).IM,ae=e(198),Ie=e(160),de={customP2p:100,customTeam:101,customSuperTeam:103,deleteMsgP2p:7,deleteMsgTeam:8,deleteMsgSuperTeam:12,deleteOnewayMsgP2p:13,deleteOnewayMsgTeam:14},Ce={0:"applyTeam",1:"rejectTeamApply",2:"teamInvite",3:"rejectTeamInvite",5:"friendRequest",6:"deleteFriend",7:"deleteMsgP2p",8:"deleteMsgTeam",12:"deleteMsgSuperTeam",13:"deleteMsgP2pOneWay",14:"deleteMsgTeamOneWay",15:"applySuperTeam",16:"rejectSuperTeamApply",17:"superTeamInvite",18:"rejectSuperTeamInvite",100:"customP2p",101:"customTeam",103:"customSuperTeam",102:"customP2p"},Ue={1:"addFriend",2:"applyFriend",3:"passFriendApply",4:"rejectFriendApply"},qe=["team","superTeam","friend","msg"],jt={applyTeam:"team",rejectTeamApply:"team",teamInvite:"team",rejectTeamInvite:"team",applySuperTeam:"superTeam",rejectSuperTeamApply:"superTeam",superTeamInvite:"superTeam",rejectSuperTeamInvite:"superTeam",addFriend:"friend",applyFriend:"friend",passFriendApply:"friend",rejectFriendApply:"friend",deleteFriend:"friend",deleteMsg:"msg"};function Fe(Et){var cr,er;oe.verifyOptions(Et,"type to","sysmsg::SystemMessage"),oe.verifyParamValid("type",Et.type,Fe.validTypes,"sysmsg::SystemMessage"),y(cr=Et.type).call(cr,"custom")!==-1&&(oe.verifyOptions(Et,"content","sysmsg::SystemMessage"),this.attach=Et.content,ue(Et.apnsText)&&(this.apnsText=""+Et.apnsText),ue(Et.pushPayload)&&(g(Et.pushPayload)==="object"?this.pushPayload=i(Et.pushPayload):this.pushPayload=""+Et.pushPayload),ue(Et.sendToOnlineUsersOnly)&&(this.sendToOnlineUsersOnly=Et.sendToOnlineUsersOnly?0:1),ue(Et.cc)&&(this.cc=Et.cc?1:0),ue(Et.isPushable)&&(this.isPushable=Et.isPushable?1:0),ue(Et.isUnreadable)&&(this.isUnreadable=Et.isUnreadable?1:0),ue(Et.needPushNick)&&(this.needPushNick=Et.needPushNick?1:0)),y(er=Et.type).call(er,"deleteMsg")===0&&(Et.apnsText&&(this.apnsText=Et.apnsText),Et.pushPayload&&(this.pushPayload=Et.pushPayload),Et.attach&&(this.attach=Et.attach)),this.time=Et.time||+new Date,this.type=de[Et.type],this.to=Et.to,ue(Et.from)&&(this.from=Et.from),ue(Et.ps)&&(this.ps=Et.ps),ue(Et.deletedIdClient)&&(this.deletedIdClient=Et.deletedIdClient),ue(Et.deletedIdServer)&&(this.deletedIdServer=Et.deletedIdServer),ue(Et.opeAccount)&&(this.opeAccount=Et.opeAccount),ue(Et.yidunEnable)&&(this.yidunEnable=Et.yidunEnable?1:0),ue(Et.antiSpamContent)&&(g(Et.antiSpamContent)==="object"?this.antiSpamContent=i(Et.antiSpamContent):this.antiSpamContent=""+Et.antiSpamContent),ue(Et.antiSpamBusinessId)&&(g(Et.antiSpamBusinessId)==="object"?this.antiSpamBusinessId=i(Et.antiSpamBusinessId):this.antiSpamBusinessId=""+Et.antiSpamBusinessId),ue(Et.env)&&(this.env=Et.env),this.idClient=Et.idClient||oe.guid()}Fe.validTypes=k(n=L(de)).call(n,L(jt)),Fe.validCategories=["team","friend"],Fe.isCustom=function(Et){return Et.type==="custom"},Fe.reverse=function(Et){var cr,er={time:+Et.time,to:Et.to,type:Ce[Et.type]};if(ue(Et.from)&&(er.from=Et.from),ue(Et.idClient)&&(er.idClient=Et.idClient),ue(Et.idServer)&&(er.idServer=""+Et.idServer),ue(Et.deletedIdClient)&&(er.deletedIdClient=Et.deletedIdClient),ue(Et.deletedIdServer)&&(er.deletedIdServer=""+Et.deletedIdServer),ue(Et.deletedMsgTime)&&(er.deletedMsgTime=+Et.deletedMsgTime),ue(Et.deletedMsgFromNick)&&(er.deletedMsgFromNick=""+Et.deletedMsgFromNick),ue(Et.opeAccount)&&(er.opeAccount=Et.opeAccount),ue(Et.ps)&&(er.ps=Et.ps),ue(Et.callbackExt)&&(er.callbackExt=Et.callbackExt),Et.attach=Et.attach?""+Et.attach:"",er.type==="customP2p"||er.type==="customTeam"||er.type==="customSuperTeam")er.content=Et.attach,ue(Et.apnsText)&&(er.apnsText=Et.apnsText),ue(Et.pushPayload)&&(er.pushPayload=Et.pushPayload),oe.merge(er,{sendToOnlineUsersOnly:le(Et.sendToOnlineUsersOnly)||+Et.sendToOnlineUsersOnly==0,cc:le(Et.cc)||+Et.cc==1,isPushable:le(Et.isPushable)||+Et.isPushable==1,isUnreadable:le(Et.isUnreadable)||+Et.isUnreadable==1,needPushNick:ue(Et.needPushNick)&&+Et.needPushNick==1}),er.type==="customP2p"?er.scene="p2p":er.type==="customSuperTeam"?er.scene="superTeam":er.type==="customTeam"&&(er.scene="team"),er.type="custom";else if(y(cr=er.type).call(cr,"deleteMsg")===0){Et.apnsText&&(er.apnsText=Et.apnsText),Et.pushPayload&&(er.pushPayload=Et.pushPayload),Et.attach&&(er.attach=Et.attach);var nr=er.type.toLowerCase();y(nr).call(nr,"p2p")>-1?er.scene="p2p":y(nr).call(nr,"superteam")>-1?er.scene="superTeam":y(nr).call(nr,"team")>-1&&(er.scene="team"),er.type="deleteMsg"}else{if(Et.attach){er.attach={};var dr=JSON.parse(Et.attach);ue(dr.vt)?(er.type=Ue[dr.vt],dr.serverex&&dr.serverex[0]===1&&(er.serverex=dr.serverex[1]),delete er.attach):(ue(dr.tinfo)&&(er.attach.team=$(ae).call(ae,ie.syncUnserialize(dr.tinfo,"team"))),ue(dr.tlist)&&(er.attach.member=$(Ie).call(Ie,ie.syncUnserialize(dr.tlist,"teamMember"))),ue(dr.attach)&&(er.attach.custom=dr.attach))}er.category=jt[er.type],er.read=!1,er.state="init"}return ue(Et.cc)&&(er.cc=+Et.cc==1),er.status=Et.status||"success",ue(V(Et))&&(er.filter=V(Et)),er},Fe.reverseSysMsgs=function(Et,cr){var er=(cr=cr||{}).mapper,nr=oe.isFunction(er);return z(Et).call(Et,function(dr){return dr=$(Fe).call(Fe,dr),nr&&(dr=er(dr)),dr})},Fe.completeUnread=function(Et){var cr,er;return Et=Et||{},re(qe).call(qe,function(nr){delete Et[nr]}),re(cr=L(jt)).call(cr,function(nr){Et[nr]=Et[nr]||0,Et[nr]<0&&(Et[nr]=0),Et[er=jt[nr]]=Et[er]||0,Et[er]=Et[er]+Et[nr]}),Et.total=0,re(qe).call(qe,function(nr){Et.total+=Et[nr]}),Et},t.exports=Fe},function(t,r,e){var n=e(127),g=["unreadMsgs"],y=e(0);function i(){}i.parse=function(k){var L=k.split("|");return{scene:L[0],to:L[1]}},i.genSessionByMsg=function(k){return{id:k.sessionId,scene:k.scene,to:k.target,updateTime:k.time,lastMsg:k}},i.appendLastMsg=function(k){var L=k.lastMsg;k["last"+y.capFirstLetter(L.type)+"Msg"]=L,k["last"+y.capFirstLetter(L.flow)+"Msg"]=L},i.genSessionByMsgs=function(k,L){var $=k.getLastNotIgnoredMsg(L);return $?i.genSessionByMsg($):null},i.trim=function(k){if(Object.prototype.toString.call(k)!=="[object Object]")return k;var L=k=y.simpleClone(k);return L.unreadMsgs,n(L,g)},i.isComplete=function(k){return k.id&&k.scene&&k.to},t.exports=i},function(t,r){t.exports=function(){}},function(t,r,e){var n=e(497);t.exports=function(g){return n(g,5)}},function(t,r,e){var n=e(152),g=e(44),y=e(45),i=e(153),k=e(154),L=e(122);function $(le){var ue=function(){if(typeof Reflect>"u"||!n||n.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(n(Boolean,[],function(){})),!0}catch{return!1}}();return function(){var ie,ae=L(le);if(ue){var Ie=L(this).constructor;ie=n(ae,arguments,Ie)}else ie=ae.apply(this,arguments);return k(this,ie)}}var V=e(141),z={V2NIM_LOGIN_STATUS_LOGOUT:0,V2NIM_LOGIN_STATUS_LOGINED:1,V2NIM_LOGIN_STATUS_LOGINING:2,V2NIM_LOGIN_STATUS_UNLOGIN:3},re={V2NIM_CONNECT_STATUS_DISCONNECTED:0,V2NIM_CONNECT_STATUS_CONNECTED:1,V2NIM_CONNECT_STATUS_CONNECTING:2,V2NIM_CONNECT_STATUS_WAITING:3},oe=function(le){i(ie,le);var ue=$(ie);function ie(ae){var Ie;return g(this,ie),(Ie=ue.call(this)).loginStatus=z.V2NIM_LOGIN_STATUS_LOGOUT,Ie.connectStatus=re.V2NIM_CONNECT_STATUS_DISCONNECTED,Ie.logger=ae.logger,Ie.clientProto=ae,Ie.lastErrorFromLoginCmd=null,Ie}return y(ie,[{key:"processEvent",value:function(ae,Ie,de){this.getConnectStatus();var Ce=this.clientProto.willReconnect();switch(ae){case"auth/loginLifeCycleAddressing":this.logger.log("auth::life cycle addressing"),this.lastErrorFromLoginCmd=null,this.setLoginStatus(z.V2NIM_LOGIN_STATUS_LOGINING),this.setConnectStatus(re.V2NIM_CONNECT_STATUS_CONNECTING);break;case"auth/loginLifeCycleConnect":this.logger.log("auth::life cycle connecting"),this.lastErrorFromLoginCmd=null,this.setLoginStatus(z.V2NIM_LOGIN_STATUS_LOGINING),this.setConnectStatus(re.V2NIM_CONNECT_STATUS_CONNECTING);break;case"auth/loginLifeCycleConnectSucc":this.logger.log("auth::life cycle connect success"),this.setLoginStatus(z.V2NIM_LOGIN_STATUS_LOGINING),this.setConnectStatus(re.V2NIM_CONNECT_STATUS_CONNECTED);break;case"auth/loginLifeCycleConnectFail":this.logger.log("auth::life cycle connect fail, isWillReconnect ".concat(Ce,", due to:"),Ie&&Ie.message),this.setLoginStatus(Ce?z.V2NIM_LOGIN_STATUS_UNLOGIN:z.V2NIM_LOGIN_STATUS_LOGOUT,Ie),this.setConnectStatus(re.V2NIM_CONNECT_STATUS_DISCONNECTED,Ie);break;case"auth/loginLifeCycleConnectionBroken":this.logger.log("auth::life cycle connection broken. isWillReconnect ".concat(Ce,", due to:"),Ie&&Ie.message),this.setLoginStatus(Ce?z.V2NIM_LOGIN_STATUS_UNLOGIN:z.V2NIM_LOGIN_STATUS_LOGOUT,Ie),this.setConnectStatus(re.V2NIM_CONNECT_STATUS_DISCONNECTED,Ie);break;case"auth/loginLifeCycleLoginSucc":this.logger.log("auth::life cycle login success, verify authentication success"),this.setLoginStatus(z.V2NIM_LOGIN_STATUS_LOGINED),this.emit("auth/loginLifeCycleLoginSucc");break;case"auth/loginLifeCycleLoginFail":this.lastErrorFromLoginCmd=Ie,this.logger.log("auth::life cycle login fail. isWillReconnect ".concat(Ce,", due to verify authentication failed:"),Ie&&Ie.message),this.setLoginStatus(Ce?z.V2NIM_LOGIN_STATUS_UNLOGIN:z.V2NIM_LOGIN_STATUS_LOGOUT,Ie),this.setConnectStatus(re.V2NIM_CONNECT_STATUS_DISCONNECTED,Ie);break;case"auth/loginLifeCycleLogout":this.logger.log("auth::life cycle logout"),this.setLoginStatus(z.V2NIM_LOGIN_STATUS_LOGOUT),this.setConnectStatus(re.V2NIM_CONNECT_STATUS_DISCONNECTED,new Error("disconnect due to logout"));break;case"auth/loginLifeCycleKicked":this.logger.log("auth::life cycle kicked",de),this.setLoginStatus(z.V2NIM_LOGIN_STATUS_LOGOUT),this.setConnectStatus(re.V2NIM_CONNECT_STATUS_DISCONNECTED,new Error("disconnect due to kicked"));break;case"auth/loginLifeCycleWaiting":this.logger.log("auth::life cycle waiting to reconnect"),this.setLoginStatus(z.V2NIM_LOGIN_STATUS_UNLOGIN),this.setConnectStatus(re.V2NIM_CONNECT_STATUS_WAITING)}}},{key:"getConnectStatus",value:function(){return this.connectStatus}},{key:"getLoginStatus",value:function(){return this.loginStatus}},{key:"getLastErrorFromLoginCmd",value:function(){return this.lastErrorFromLoginCmd}},{key:"setLoginStatus",value:function(ae,Ie){if(ae!==this.loginStatus){var de=this.loginStatus;this.loginStatus=ae,this.emit("loginStatus",ae),this.logger.log("auth::life cycle loginStatus:",ae),this.delegateLoginEvent(de,ae,Ie)}}},{key:"delegateLoginEvent",value:function(ae,Ie,de){ae===z.V2NIM_LOGIN_STATUS_LOGINING&&Ie===z.V2NIM_LOGIN_STATUS_LOGOUT&&this.emit("loginFailed",de)}},{key:"setConnectStatus",value:function(ae,Ie){if(ae!==this.connectStatus){var de=this.connectStatus;this.connectStatus=ae,this.emit("connectStatus",ae),this.delegateConnectEvent(de,ae,Ie)}}},{key:"delegateConnectEvent",value:function(ae,Ie,de){ae===re.V2NIM_CONNECT_STATUS_CONNECTED&&Ie===re.V2NIM_CONNECT_STATUS_DISCONNECTED&&this.emit("disconnected",de),ae===re.V2NIM_CONNECT_STATUS_CONNECTING&&Ie===re.V2NIM_CONNECT_STATUS_DISCONNECTED&&this.emit("connectFailed",de)}},{key:"destroy",value:function(){this.removeAllListeners()}}]),ie}(V);t.exports={V2NIMLoginStatus:z,V2NIMConnectStatus:re,StatusProtector:oe}},function(t,r,e){var n=e(71),g=e(13);t.exports=function(y){if(n(y)==="Function")return g(y)}},function(t,r,e){var n=e(32),g=e(98);t.exports=function(y,i){var k=y[i];return g(k)?void 0:n(k)}},function(t,r,e){var n=e(16),g=e(327),y=n["__core-js_shared__"]||g("__core-js_shared__",{});t.exports=y},function(t,r,e){var n=e(16),g=e(30),y=n.document,i=g(y)&&g(y.createElement);t.exports=function(k){return i?y.createElement(k):{}}},function(t,r,e){var n=e(47),g=e(114),y=e(49),i=function(k){return function(L,$,V){var z,re=n(L),oe=y(re),le=g(V,oe);if(k&&$!=$){for(;oe>le;)if((z=re[le++])!=z)return!0}else for(;oe>le;le++)if((k||le in re)&&re[le]===$)return k||le||0;return!k&&-1}};t.exports={includes:i(!0),indexOf:i(!1)}},function(t,r,e){var n=e(333);t.exports=function(g,y){return new(n(g))(y===0?0:y)}},function(t,r,e){var n={};n[e(21)("toStringTag")]="z",t.exports=String(n)==="[object z]"},function(t,r,e){var n=e(29),g=e(216),y=e(40),i=e(38),k=e(47),L=e(124);r.f=n&&!g?Object.defineProperties:function($,V){i($);for(var z,re=k(V),oe=L(V),le=oe.length,ue=0;le>ue;)y.f($,z=oe[ue++],re[z]);return $}},function(t,r){t.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},function(t,r,e){var n=e(71),g=e(47),y=e(135).f,i=e(225),k=typeof window=="object"&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];t.exports.f=function(L){return k&&n(L)=="Window"?function($){try{return y($)}catch{return i(k)}}(L):y(g(L))}},function(t,r,e){var n=e(1),g=e(20),y=e(57),i=e(231),k=e(17),L=e(361),$=e(138),V=e(139),z=e(89),re=e(65),oe=e(74),le=e(21),ue=e(105),ie=e(232),ae=i.PROPER,Ie=i.CONFIGURABLE,de=ie.IteratorPrototype,Ce=ie.BUGGY_SAFARI_ITERATORS,Ue=le("iterator"),qe=function(){return this};t.exports=function(jt,Fe,Et,cr,er,nr,dr){L(Et,Fe,cr);var ir,tr,ur,or=function(mr){if(mr===er&&wr)return wr;if(!Ce&&mr in gr)return gr[mr];switch(mr){case"keys":case"values":case"entries":return function(){return new Et(this,mr)}}return function(){return new Et(this)}},fr=Fe+" Iterator",lr=!1,gr=jt.prototype,Sr=gr[Ue]||gr["@@iterator"]||er&&gr[er],wr=!Ce&&Sr||or(er),kr=Fe=="Array"&&gr.entries||Sr;if(kr&&(ir=$(kr.call(new jt)))!==Object.prototype&&ir.next&&(y||$(ir)===de||(V?V(ir,de):k(ir[Ue])||oe(ir,Ue,qe)),z(ir,fr,!0,!0),y&&(ue[fr]=qe)),ae&&er=="values"&&Sr&&Sr.name!=="values"&&(!y&&Ie?re(gr,"name","values"):(lr=!0,wr=function(){return g(Sr,this)})),er)if(tr={values:or("values"),keys:nr?wr:or("keys"),entries:or("entries")},dr)for(ur in tr)(Ce||lr||!(ur in gr))&&oe(gr,ur,tr[ur]);else n({target:Fe,proto:!0,forced:Ce||lr},tr);return y&&!dr||gr[Ue]===wr||oe(gr,Ue,wr,{name:er}),ue[Fe]=wr,tr}},function(t,r){t.exports=function(e,n){return{value:e,done:n}}},function(t,r,e){var n=e(18),g=TypeError;t.exports=function(y,i){if(n(i,y))return y;throw g("Incorrect invocation")}},function(t,r,e){var n=e(133),g=e(85),y=TypeError;t.exports=function(i){if(n(i))return i;throw y(g(i)+" is not a constructor")}},function(t,r,e){var n=e(91)(e(59),"Map");t.exports=n},function(t,r,e){var n=e(59).Symbol;t.exports=n},function(t,r,e){var n=e(270),g=e(536),y=e(205);t.exports=function(i){return y(i)?n(i):g(i)}},function(t,r){var e=Array.isArray;t.exports=e},function(t,r){t.exports=function(e){return function(n){return e(n)}}},function(t,r,e){(function(n){var g=e(265),y=r&&!r.nodeType&&r,i=y&&typeof n=="object"&&n&&!n.nodeType&&n,k=i&&i.exports===y&&g.process,L=function(){try{var $=i&&i.require&&i.require("util").types;return $||k&&k.binding&&k.binding("util")}catch{}}();n.exports=L}).call(this,e(150)(t))},function(t,r){var e=Object.prototype;t.exports=function(n){var g=n&&n.constructor;return n===(typeof g=="function"&&g.prototype||e)}},function(t,r,e){var n=e(270),g=e(539),y=e(205);t.exports=function(i){return y(i)?n(i,!0):g(i)}},function(t,r,e){var n=e(544),g=e(274),y=Object.prototype.propertyIsEnumerable,i=Object.getOwnPropertySymbols,k=i?function(L){return L==null?[]:(L=Object(L),n(i(L),function($){return y.call(L,$)}))}:g;t.exports=k},function(t,r,e){var n=e(548),g=e(180),y=e(549),i=e(279),k=e(550),L=e(126),$=e(266),V=$(n),z=$(g),re=$(y),oe=$(i),le=$(k),ue=L;(n&&ue(new n(new ArrayBuffer(1)))!="[object DataView]"||g&&ue(new g)!="[object Map]"||y&&ue(y.resolve())!="[object Promise]"||i&&ue(new i)!="[object Set]"||k&&ue(new k)!="[object WeakMap]")&&(ue=function(ie){var ae=L(ie),Ie=ae=="[object Object]"?ie.constructor:void 0,de=Ie?$(Ie):"";if(de)switch(de){case V:return"[object DataView]";case z:return"[object Map]";case re:return"[object Promise]";case oe:return"[object Set]";case le:return"[object WeakMap]"}return ae}),t.exports=ue},function(t,r,e){var n=e(553);t.exports=function(g){var y=new g.constructor(g.byteLength);return new n(y).set(new n(g)),y}},function(t,r,e){var n=e(13),g=e(112),y=e(58),i=e(151),k=n("".replace),L="["+i+"]",$=RegExp("^"+L+L+"*"),V=RegExp(L+L+"*$"),z=function(re){return function(oe){var le=y(g(oe));return 1&re&&(le=k(le,$,"")),2&re&&(le=k(le,V,"")),le}};t.exports={start:z(1),end:z(2),trim:z(3)}},function(t,r,e){var n=e(92),g=e(589);n.json=g,t.exports=n},function(t,r,e){var n=e(19),g=e(22),y=e(8),i=e(2),k=e(66),L=k.f,$=e(581);function V(re){re.onload&&this.once("load",re.onload),re.onerror&&this.once("error",re.onerror),re.onbeforesend&&this.once("beforesend",re.onbeforesend),re.onaftersend&&this.once("aftersend",re.onaftersend);var oe=(re=this.options=k.fetch({method:"GET",url:"",sync:!1,data:null,headers:{},cookie:!1,timeout:6e4,type:"text",form:null,input:null,putFileAtEnd:!1,proxyUrl:""},re)).headers;k.notexist(oe["Content-Type"])&&(oe["Content-Type"]="application/x-www-form-urlencoded"),this.send()}var z=V.prototype=n($.prototype);z.send=function(){var re=this,oe=re.options;g(function(){try{try{re.emit("beforesend",oe)}catch{}re.doSend()}catch(le){re.onError("serverError","请求失败:"+le.message)}},0)},z.doSend=L,z.afterSend=function(){var re=this;g(function(){re.emit("aftersend",re.options)},0)},z.onLoad=function(re){var oe,le=this.options,ue=re.status,ie=re.result;if(typeof ue!="number"||ue!==0)if(y(oe=""+ue).call(oe,"2")===0){if(le.type==="json")try{ie=JSON.parse(ie)}catch{return void this.onError("parseError",ie)}this.emit("load",ie)}else this.onError("serverError","服务器返回异常状态 status: "+ue,{status:ue,result:ie,date:re.date});else this.onError("netError","网络错误",{status:408})},z.onError=function(re,oe,le){var ue=k.isObject(le)?le:{};ue.code=re||"error",ue.message=oe||"发生错误",this.emit("error",ue)},z.onTimeout=function(){this.onError("timeout","请求超时",{status:408})},z.abort=function(){this.onError("abort","客户端中止",{status:415})},z.header=function(re){var oe=this;if(!k.isArray(re))return oe.getResponseHeader(re||"");var le={};return i(re).call(re,function(ue){le[ue]=oe.header(ue)}),le},z.getResponseHeader=L,z.destroy=L,t.exports=V},function(t,r,e){t.exports=e(606)},function(t,r,e){t.exports=e(628)},function(t,r,e){var n=e(197),g=e(159);function y(i,k){var L;return t.exports=y=n?g(L=n).call(L):function($,V){return $.__proto__=V,$},t.exports.__esModule=!0,t.exports.default=t.exports,y(i,k)}t.exports=y,t.exports.__esModule=!0,t.exports.default=t.exports},function(t,r,e){t.exports=e(631)},function(t,r,e){var n=e(5),g=e(2),y=e(23),i=e(0),k=i.notundef,L=i.fillPropertyWithDefault,$=n,V={},z={},re=[],oe={},le={normal:0,advanced:1},ue={0:"normal",1:"advanced"},ie=$(le),ae=V.joinMode={noVerify:0,needVerify:1,rejectAll:2};z.joinMode={0:"noVerify",1:"needVerify",2:"rejectAll"},re.push("join"),oe.joinMode=$(ae);var Ie=V.beInviteMode={needVerify:0,noVerify:1};z.beInviteMode={0:"needVerify",1:"noVerify"},re.push("beInvite"),oe.beInviteMode=$(Ie);var de=V.inviteMode={manager:0,all:1};z.inviteMode={0:"manager",1:"all"},re.push("invite"),oe.inviteMode=$(de);var Ce=V.updateTeamMode={manager:0,all:1};z.updateTeamMode={0:"manager",1:"all"},re.push("updateTeam"),oe.updateTeamMode=$(Ce);var Ue=V.updateCustomMode={manager:0,all:1};function qe(Fe){var Et;switch(i.verifyOptions(Fe,"action","team::Team"),Fe.action){case"create":i.verifyOptions(Fe,"teamId",!1,"team::Team"),i.verifyOptions(Fe,"type name","team::Team"),i.verifyParamValid("type",Fe.type,ie,"team::Team"),k(Fe.level)&&(i.verifyParamType("level",Fe.level,"number","team::Team"),this.level=Fe.level);break;case"update":i.verifyOptions(Fe,"teamId","team::Team"),i.verifyOptions(Fe,"type",!1,"team::Team")}k(Fe.teamId)&&(this.teamId=Fe.teamId),k(Fe.type)&&(this.type=le[Fe.type]),k(Fe.avatar)&&(this.avatar=""+Fe.avatar),k(Fe.name)&&(this.name=""+Fe.name),k(Fe.intro)&&(this.intro=""+Fe.intro),k(Fe.announcement)&&(this.announcement=""+Fe.announcement),g(re).call(re,y(Et=this.setMode).call(Et,this,Fe)),k(Fe.custom)&&(this.custom=""+Fe.custom)}function jt(Fe,Et){k(Fe[Et+="Mode"])&&(Fe[Et]=z[Et][Fe[Et]])}z.updateCustomMode={0:"manager",1:"all"},re.push("updateCustom"),oe.updateCustomMode=$(Ue),qe.prototype.setMode=function(Fe,Et){k(Fe[Et+="Mode"])&&(i.verifyParamValid(Et,Fe[Et],oe[Et],"team::Team"),this[Et]=V[Et][Fe[Et]])},qe.reverse=function(Fe,Et){var cr=i.copy(Fe);if(k(cr.teamId)&&(cr.teamId=""+cr.teamId),k(cr.type)&&(cr.type=ue[cr.type]),k(cr.level)&&(cr.level=+cr.level),k(cr.valid)&&(cr.valid=+cr.valid==1),k(cr.memberNum)&&(cr.memberNum=+cr.memberNum),k(cr.memberUpdateTime)&&(cr.memberUpdateTime=+cr.memberUpdateTime),k(cr.createTime)&&(cr.createTime=+cr.createTime),k(cr.updateTime)&&(cr.updateTime=+cr.updateTime),k(cr.validToCurrentUser)&&(cr.validToCurrentUser=cr.validToCurrentUser==="1"),k(cr.mute)&&(cr.mute=cr.mute==="1"),k(cr.muteType))switch(cr.muteType){case"0":cr.mute=!1,cr.muteType="none";break;case"1":cr.mute=!0,cr.muteType="normal";break;case"3":cr.mute=!0,cr.muteType="all"}else k(cr.mute)&&(cr.mute===1?(cr.mute=!0,cr.muteType="normal"):(cr.mute=!1,cr.muteType="none"));return g(re).call(re,y(jt).call(jt,null,cr)),delete cr.bits,Et||qe.fillProperties(cr),cr},qe.fillProperties=function(Fe){var Et=L(Fe,"beInviteMode","needVerify"),cr=L(Fe,"inviteMode","manager"),er=L(Fe,"updateTeamMode","manager"),nr=L(Fe,"updateCustomMode","manager"),dr=L(Fe,"avatar","");return Et||cr||er||nr||dr},t.exports=qe},function(t,r,e){var n=e(48).clientTypeMap;function g(){}g.reverse=function(y){var i=y;return i.type=n[i.type],i},g.reverseType=function(y){return n[y]||y},t.exports=g},function(t,r,e){var n=e(24),g=e(121),y=e(8),i=e(12),k=e(70);function L(){if(!navigator||!navigator.userAgent)return!1;var z=[/Android/i,/webOS/i,/iPhone/i,/iPad/i,/iPod/i,/BlackBerry/i,/Windows Phone/i];return g(z).call(z,function(re){return navigator.userAgent.match(re)})}function $(){var z;return!(!navigator||!navigator.userAgent)&&(typeof navigator>"u"?"undefined":n(navigator))==="object"&&typeof navigator.userAgent=="string"&&y(z=navigator.userAgent).call(z,"Electron")>=0}function V(){return navigator&&navigator.userAgent}t.exports={getHostEnv:function(){return i.isBrowser?$()?"Electron":L()?"H5":V()?"BROWSER":"Unset":i.isRN?"RN":i.isWeixinApp?"Weixin":"Unset"},getHostEnvEnum:function(){return i.isBrowser?$()?5:L()?101:V()?100:0:i.isRN?2:i.isWeixinApp?6:0},getHostEnvVer:function(){if(!i.isBrowser)return"";if(!$())return k.version;try{return navigator.userAgent.match(/Electron\/([\d.]+\d+)/)[1]||k.version}catch{return k.version}},getLibEnv:function(){return"BROWSER"}}},function(t,r,e){var n=e(19),g=e(34),y=e(6),i=e(81),k=e(202),L=e(12),$=e(794),V=e(922),z=e(0),re=z.verifyOptions,oe=z.verifyParamType,le=e(26).reportAPI,ue=e(156).Chatroom,ie=e(164);function ae(de){var Ce=ie(de);return this.subType="chatroom",this.nosScene=Ce.nosScene||"chatroom",this.nosSurvivalTime=Ce.nosSurvivalTime,Ce.Protocol=k,Ce.Message=V,Ce.constructor=ae,Ce.isAnonymous&&(Ce.account=Ce.account||"nimanon_".concat(z.guid()),Ce.isAnonymous=1,z.verifyOptions(Ce,"chatroomNick","api::Chatroom"),Ce.chatroomAvatar=Ce.chatroomAvatar||" "),this.init(Ce)}ae.Protocol=k,ae.parser=ue,ae.use=i.use,ae.getInstance=function(de){return de.isAnonymous&&(de.account=de.account||"nimanon_".concat(z.guid()),de.isAnonymous=1,z.verifyOptions(de,"chatroomNick","api::Chatroom.getInstance"),de.chatroomAvatar=de.chatroomAvatar||" "),i.getInstance.call(this,de)},ae.genInstanceName=function(de){return z.verifyOptions(de,"chatroomId","api::Chatroom.genInstanceName"),"Chatroom-account-"+de.account+"-chatroomId-"+de.chatroomId};var Ie=ae.fn=ae.prototype=n(i.prototype);ae.info=Ie.info=L.info,Ie.getChatroom=function(de){(de=de||{}).done=le({instance:this,className:"ChatroomFn",funcName:"getChatroom",done:de.done}),this.processCallback(de),this.sendCmd("getChatroom",de)},Ie.updateChatroom=function(de){(de=de||{}).done=le({instance:this,className:"ChatroomFn",funcName:"updateChatroom",done:de.done}),re(de,"chatroom needNotify","api::updateChatroom"),oe("needNotify",de.needNotify,"boolean"),this.processCustom(de),this.processCallback(de),de.chatroom=new $(de.chatroom),de.antispamTag={antiSpamBusinessId:de.antiSpamBusinessId},this.sendCmd("updateChatroom",de)},Ie.closeChatroom=function(de){(de=de||{}).done=le({instance:this,className:"ChatroomFn",funcName:"closeChatroom",done:de.done}),this.processCustom(de),this.processCallback(de),this.sendCmd("closeChatroom",de)},Ie.updateTags=function(de){(de=de||{}).done=le({instance:this,className:"ChatroomFn",funcName:"updateTags",done:de.done}),z.validate({tags:{type:"array",required:!1},notifyTargetTags:{type:"string",allowEmpty:!0,required:!1},needNotify:{type:"boolean",required:!1}},de,"chatroom::updateTags");var Ce=g({},de);this.processCallback(Ce),Ce.tags&&(Ce.tags=y(Ce.tags)),Ce.needNotify&&(Ce.needNotify=Ce.needNotify?1:0),this.sendCmd("updateChatroomTags",{chatRoomTagsUpdateTag:Ce},Ce.done)},t.exports=ae,e(932),e(933),e(934),e(935)},function(t,r,e){var n=e(19),g=e(23),y=e(11),i=e(10),k=e(82),L=e(0),$=L.undef,V=L.notundef,z=e(297),re=e(12),oe=e(156),le=e(794),ue=e(319);function ie(de){var Ce,Ue,qe;L.verifyOptions(de,"appKey account chatroomId chatroomAddresses","protocol::ChatroomProtocol"),de.isAnonymous||L.verifyOptions(de,"token","protocol::ChatroomProtocol"),L.verifyParamType("chatroomAddresses",de.chatroomAddresses,"array","protocol::ChatroomProtocol"),L.verifyCallback(de,"onconnect onerror onwillreconnect ondisconnect onmsg onmsgs onrobots","protocol::ChatroomProtocol"),Ce=typeof L.get(de,"privateConf.isDataReportEnable")=="boolean"?de.privateConf.isDataReportEnable:re.privateConf.isDataReportEnable,Ue=typeof L.get(de,"privateConf.reportConfigUrl")=="string"?de.privateConf.reportConfigUrl:re.privateConf.reportConfigUrl,qe=typeof L.get(de,"privateConf.reportUrl")=="string"?de.privateConf.reportUrl:re.privateConf.reportUrl,this.reporter=z.initReporter({isDataReportEnable:Ce,reportConfigUrl:Ue,reportUrl:qe,appKey:de.appKey,logger:this.logger}),k.call(this,de)}var ae=k.fn,Ie=ie.fn=ie.prototype=n(ae);Ie.init=function(){var de;ae.init.call(this),oe.Chatroom.setProtocol(this),this.parser=oe.Chatroom,g(de=this.sendCmd).call(de,this),this.syncResult={},this.timetags={},this.msgBuffer=[]},Ie.reset=function(){var de=this;ae.reset.call(de);var Ce,Ue=de.options;de.autoconnect=!!Ue.autoconnect,$(Ue.msgBufferInterval)&&(Ue.msgBufferInterval=300),L.verifyParamType("msgBufferInterval",Ue.msgBufferInterval,"number","protocol::ChatroomProtocol.reset"),$(Ue.msgBufferSize)&&(Ue.msgBufferSize=500),L.verifyParamType("msgBufferSize",Ue.msgBufferSize,"number","protocol::ChatroomProtocol.reset"),V(Ue.chatroomAddresses)&&(de.socketUrlsBackup=y(Ce=Ue.chatroomAddresses).call(Ce,function(qe){return re.formatSocketUrl({url:qe,secure:de.options.secure})}))},Ie.processChatroom=function(de){switch(de.cmd){case"login":de.error||(de.obj={chatroom:i(le).call(le,de.content.chatroom),member:i(ue).call(ue,de.content.chatroomMember)},this.cdnInfo={},this.initCdnData(),clearTimeout(this.queryCdnTimer),this.onCdnMsgInfo(de.content.chatroomCdnInfo));break;case"kicked":this.onKicked(de);break;case"logout":break;case"sendMsg":this.onSendMsg(de);break;case"msg":this.onMsg(de),this.cdnInfo&&this.cdnInfo.enable&&this.correctCdnTime(+de.content.msg.time);break;case"getChatroomMembers":case"getChatroomMembersByTag":this.onChatroomMembers(de);break;case"getChatroomMemberCountByTag":this.onGetChatroomMemberCountByTag(de);break;case"getHistoryMsgs":case"getHistoryMsgsByTags":this.onHistoryMsgs(de);break;case"markChatroomMember":this.onMarkChatroomMember(de);break;case"closeChatroom":break;case"getChatroom":this.onChatroom(de);break;case"updateChatroom":break;case"updateMyChatroomMemberInfo":delete de.obj.chatroomMember;break;case"getChatroomMembersInfo":this.onChatroomMembersInfo(de);break;case"kickChatroomMember":case"updateChatroomMemberTempMute":break;case"queueList":de.error||(de.obj=de.content);break;case"syncRobot":this.onSyncRobot(de);break;case"notifyCdnInfo":this.onCdnMsgInfo(de.content&&de.content.chatroomCdnInfo);break;case"updateChatroomTag":this.onTagsUpdate(de.content)}},Ie.onChatroom=function(de){de.error||(de.obj.chatroom=i(le).call(le,de.content.chatroom))},Ie.onTagsUpdate=function(de){if(this.logger.info("onTagsUpdate:: ",de),this.options.onTagsUpdate&&typeof this.options.onTagsUpdate=="function"){var Ce=de.updateTags&&de.updateTags.currentTags;try{Ce=JSON.parse(Ce)}catch(Ue){this.logger.error("onTagsUpdate:: parse tags failed",Ue)}this.options.onTagsUpdate(Ce)}},t.exports=ie,e(910),e(911),e(912),e(921)},function(t,r){t.exports=function(e,n){for(var g=n.split(".");g.length;){var y=g.shift(),i=!1;if(y[y.length-1]=="?"&&(y=y.slice(0,-1),i=!0),!(e=e[y])&&i)return e}return e}},function(t,r){t.exports=function(e,n){return e===n||e!=e&&n!=n}},function(t,r,e){var n=e(264),g=e(272);t.exports=function(y){return y!=null&&g(y.length)&&!n(y)}},function(t,r,e){var n=e(11),g=e(10),y=e(0),i=y.notundef,k=y.fillPropertyWithDefault,L={0:"normal",1:"owner",2:"manager"};function $(V){y.verifyOptions(V,"teamId","superTeam::TeamMember"),y.verifyParamAtLeastPresentOne(V,"nickInTeam muteTeam custom muteNotiType","superTeam::SuperTeamMember"),this.teamId=V.teamId,i(V.account)&&(this.account=V.account),i(V.nickInTeam)&&(this.nickInTeam=V.nickInTeam),i(V.muteNotiType)?this.bits=V.muteNotiType:i(V.muteTeam)&&(this.bits=0,V.muteTeam&&(this.bits+=1)),i(V.mute)&&(this.mute=V.mute?1:0),i(V.custom)&&(this.custom=""+V.custom)}$.reverse=function(V){var z=y.copy(V);if(i(z.teamId)&&(z.teamId=""+z.teamId),i(z.type)&&(z.type=L[z.type]),i(z.active)&&(z.active=+z.active==1),i(z.valid)&&(z.valid=+z.valid==1),i(z.mute)&&(z.mute=+z.mute==1),i(z.joinTime)&&(z.joinTime=+z.joinTime),i(z.updateTime)&&(z.updateTime=+z.updateTime),i(z.bits)){var re=z.bits;delete z.bits,z.muteTeam=!!(1&re),z.muteNotiType=re}return i(z.teamId)&&i(z.account)&&(z.id=$.genId(z.teamId,z.account)),i(z.followAccountIds)&&(z.followAccountIds=JSON.parse(z.followAccountIds)),z},$.reverseMembers=function(V){return n(V).call(V,function(z){return g($).call($,z)})},$.fillProperties=function(V){var z=k(V,"mute",!1),re=k(V,"custom","");return z||re},$.genId=function(V,z){return V+"-"+z},$.accounts2ids=function(V,z){return n(z).call(z,function(re){return $.genId(V,re)})},$.assembleMembers=function(V,z){return y.isArray(z)||(z=[z]),n(z).call(z,function(re){return $.assembleMember(V,re)})},$.assembleMember=function(V,z){return{id:$.genId(V.teamId,z),account:z,teamId:V.teamId,type:"normal",nickInTeam:"",muteTeam:!1,mute:!1,joinTime:V.memberUpdateTime,updateTime:V.memberUpdateTime,active:!0,valid:!0,followAccountIds:[]}},$.assembleOwner=function(V){var z=$.assembleMember(V,V.owner);return z.type="owner",z},t.exports=$},function(t,r,e){var n=e(688),g=e(692),y=e(314),i=e(696);t.exports=function(k,L){return n(k)||g(k,L)||y(k,L)||i()},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,r,e){var n=e(11),g=e(10),y=e(5),i=e(110).genPrivateUrl,k=e(0),L={unknown:0,male:1,female:2},$={0:"unknown",1:"male",2:"female"};function V(z){k.merge(this,z),k.notundef(this.gender)&&(k.verifyParamValid("gender",this.gender,V.validGenders,"user::User"),this.gender=L[this.gender]),k.notundef(this.email)&&this.email!==""&&k.verifyEmail("email",this.email,"user::User"),k.notundef(this.birth)&&this.birth!==""&&k.verifyBirth("birth",this.birth,"user::User"),k.notundef(this.tel)&&this.tel!==""&&k.verifyTel("tel",this.tel,"user::User")}V.reverse=function(z,re,oe){var le=k.filterObj(z,"account nick avatar _avatar_safe sign gender email birth tel custom createTime updateTime");return k.notundef(le.avatar)&&(le.avatar=i(le.avatar,re,oe)),k.notundef(le.gender)&&(le.gender=$[le.gender]),k.notundef(le.createTime)&&(le.createTime=+le.createTime),k.notundef(le.updateTime)&&(le.updateTime=+le.updateTime),le},V.reverseUsers=function(z){return n(z).call(z,function(re){return g(V).call(V,re)})},V.validGenders=y(L),t.exports=V},function(t,r,e){var n=e(6),g=e(19),y=e(10),i=e(8),k=e(110).genPrivateUrl,L=e(80),$=e(0),V=e(12);function z(ue,ie){switch($.notundef(ue.type)?$.verifyFileType(ue.type,"msg::FileMessage"):ue.type="file",$.verifyOptions(ue,"file","msg::FileMessage"),$.verifyOptions(ue.file,"url ext size",!0,"file.","msg::FileMessage"),ue.type){case"image":re.verifyFile(ue.file,"msg::FileMessage");break;case"audio":oe.verifyFile(ue.file,"msg::FileMessage");break;case"video":le.verifyFile(ue.file,"msg::FileMessage")}L.call(this,ue),ie&&(this.idClient=ie),this.attach=n(ue.file)}z.prototype=g(L.prototype),z.reverse=function(ue){var ie=y(L).call(L,ue);if(ue.attach=ue.attach?""+ue.attach:"",ue.attach&&(ie.file=JSON.parse(ue.attach),!ie.file.isS3)){var ae,Ie;ie.file.url=k(ie.file.url)||"",ie.type==="audio"&&ie.file.url&&!ie.file.mp3Url&&(ie.file.mp3Url=ie.file.url+(~i(Ie=ie.file.url).call(Ie,"?")?"&":"?")+"audioTrans&type=mp3"),V.httpsEnabled&&i(ae=ie.file.url).call(ae,"https://")!==0&&(ie.file.url=ie.file.url.replace("http","https"))}return ie},t.exports=z;var re=e(858),oe=e(859),le=e(860)},function(t,r,e){var n=e(6),g=e(19),y=e(10),i=e(8),k=e(110).genPrivateUrl,L=e(123),$=e(0),V=e(12);function z(ue,ie){switch($.notundef(ue.type)?$.verifyFileType(ue.type,"msg::FileMessage"):ue.type="file",$.verifyOptions(ue,"file","msg::FileMessage"),$.verifyOptions(ue.file,"url ext size",!0,"file.","msg::FileMessage"),ue.type){case"image":re.verifyFile(ue.file,"msg::FileMessage");break;case"audio":oe.verifyFile(ue.file,"msg::FileMessage");break;case"video":le.verifyFile(ue.file,"msg::FileMessage")}L.call(this,ue),ie&&(this.idClient=ie),this.attach=n(ue.file)}z.prototype=g(L.prototype),z.reverse=function(ue){var ie=y(L).call(L,ue);if(ue.attach=ue.attach?""+ue.attach:"",ue.attach&&(ie.file=JSON.parse(ue.attach),!ie.file.isS3)){var ae,Ie;ie.file.url=k(ie.file.url)||"",ie.type==="audio"&&ie.file.url&&!ie.file.mp3Url&&(ie.file.mp3Url=ie.file.url+(~i(Ie=ie.file.url).call(Ie,"?")?"&":"?")+"audioTrans&type=mp3"),V.httpsEnabled&&i(ae=ie.file.url).call(ae,"https://")!==0&&(ie.file.url=ie.file.url.replace("http","https"))}return ie},t.exports=z;var re=e(924),oe=e(925),le=e(926)},function(t,r,e){var n=e(322);t.exports=n},function(t,r){var e=typeof document=="object"&&document.all,n=e===void 0&&e!==void 0;t.exports={all:e,IS_HTMLDDA:n}},function(t,r,e){var n=e(99);t.exports=n&&!Symbol.sham&&typeof Symbol.iterator=="symbol"},function(t,r,e){var n=e(29),g=e(7),y=e(169);t.exports=!n&&!g(function(){return Object.defineProperty(y("div"),"a",{get:function(){return 7}}).a!=7})},function(t,r,e){var n=e(7),g=e(17),y=/#|\.prototype\./,i=function(z,re){var oe=L[k(z)];return oe==V||oe!=$&&(g(re)?n(re):!!re)},k=i.normalize=function(z){return String(z).replace(y,".").toLowerCase()},L=i.data={},$=i.NATIVE="N",V=i.POLYFILL="P";t.exports=i},function(t,r,e){var n=e(29),g=e(7);t.exports=n&&g(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!=42})},function(t,r,e){var n=e(1),g=e(7),y=e(87),i=e(30),k=e(46),L=e(49),$=e(218),V=e(101),z=e(171),re=e(116),oe=e(21),le=e(100),ue=oe("isConcatSpreadable"),ie=le>=51||!g(function(){var de=[];return de[ue]=!1,de.concat()[0]!==de}),ae=re("concat"),Ie=function(de){if(!i(de))return!1;var Ce=de[ue];return Ce!==void 0?!!Ce:y(de)};n({target:"Array",proto:!0,arity:1,forced:!ie||!ae},{concat:function(de){var Ce,Ue,qe,jt,Fe,Et=k(this),cr=z(Et,0),er=0;for(Ce=-1,qe=arguments.length;Ce<qe;Ce++)if(Ie(Fe=Ce===-1?Et:arguments[Ce]))for(jt=L(Fe),$(er+jt),Ue=0;Ue<jt;Ue++,er++)Ue in Fe&&V(cr,er,Fe[Ue]);else $(er+1),V(cr,er++,Fe);return cr.length=er,cr}})},function(t,r){var e=TypeError;t.exports=function(n){if(n>9007199254740991)throw e("Maximum allowed index exceeded");return n}},function(t,r,e){var n=e(13),g=e(17),y=e(168),i=n(Function.toString);g(y.inspectSource)||(y.inspectSource=function(k){return i(k)}),t.exports=y.inspectSource},function(t,r,e){var n=e(334);t.exports=n},function(t,r,e){var n=e(13),g=e(31),y=e(47),i=e(170).indexOf,k=e(117),L=n([].push);t.exports=function($,V){var z,re=y($),oe=0,le=[];for(z in re)!g(k,z)&&g(re,z)&&L(le,z);for(;V.length>oe;)g(re,z=V[oe++])&&(~i(le,z)||L(le,z));return le}},function(t,r,e){var n=e(33);t.exports=n("document","documentElement")},function(t,r,e){var n=e(339);e(75),t.exports=n},function(t,r,e){e(340),e(343),e(344),e(228),e(345)},function(t,r,e){var n=e(114),g=e(49),y=e(101),i=Array,k=Math.max;t.exports=function(L,$,V){for(var z=g(L),re=n($,z),oe=n(V===void 0?z:V,z),le=i(k(oe-re,0)),ue=0;re<oe;re++,ue++)y(le,ue,L[re]);return le.length=ue,le}},function(t,r,e){var n=e(20),g=e(33),y=e(21),i=e(74);t.exports=function(){var k=g("Symbol"),L=k&&k.prototype,$=L&&L.valueOf,V=y("toPrimitive");L&&!L[V]&&i(L,V,function(z){return n($,this)},{arity:1})}},function(t,r,e){var n=e(99);t.exports=n&&!!Symbol.for&&!!Symbol.keyFor},function(t,r,e){var n=e(1),g=e(33),y=e(83),i=e(20),k=e(13),L=e(7),$=e(87),V=e(17),z=e(30),re=e(131),oe=e(104),le=e(99),ue=g("JSON","stringify"),ie=k(/./.exec),ae=k("".charAt),Ie=k("".charCodeAt),de=k("".replace),Ce=k(1 .toString),Ue=/[\uD800-\uDFFF]/g,qe=/^[\uD800-\uDBFF]$/,jt=/^[\uDC00-\uDFFF]$/,Fe=!le||L(function(){var nr=g("Symbol")();return ue([nr])!="[null]"||ue({a:nr})!="{}"||ue(Object(nr))!="{}"}),Et=L(function(){return ue("\uDF06\uD834")!=='"\\udf06\\ud834"'||ue("\uDEAD")!=='"\\udead"'}),cr=function(nr,dr){var ir=oe(arguments),tr=dr;if((z(dr)||nr!==void 0)&&!re(nr))return $(dr)||(dr=function(ur,or){if(V(tr)&&(or=i(tr,this,ur,or)),!re(or))return or}),ir[1]=dr,y(ue,null,ir)},er=function(nr,dr,ir){var tr=ae(ir,dr-1),ur=ae(ir,dr+1);return ie(qe,nr)&&!ie(jt,ur)||ie(jt,nr)&&!ie(qe,tr)?"\\u"+Ce(Ie(nr,0),16):nr};ue&&n({target:"JSON",stat:!0,arity:3,forced:Fe||Et},{stringify:function(nr,dr,ir){var tr=oe(arguments),ur=y(Fe?cr:ue,null,tr);return Et&&typeof ur=="string"?de(ur,Ue,er):ur}})},function(t,r,e){e(25)("iterator")},function(t,r,e){var n=e(25),g=e(226);n("toPrimitive"),g()},function(t,r,e){var n=e(29),g=e(31),y=Function.prototype,i=n&&Object.getOwnPropertyDescriptor,k=g(y,"name"),L=k&&(function(){}).name==="something",$=k&&(!n||n&&i(y,"name").configurable);t.exports={EXISTS:k,PROPER:L,CONFIGURABLE:$}},function(t,r,e){var n,g,y,i=e(7),k=e(17),L=e(30),$=e(88),V=e(138),z=e(74),re=e(21),oe=e(57),le=re("iterator"),ue=!1;[].keys&&("next"in(y=[].keys())?(g=V(V(y)))!==Object.prototype&&(n=g):ue=!0),!L(n)||i(function(){var ie={};return n[le].call(ie)!==ie})?n={}:oe&&(n=$(n)),k(n[le])||z(n,le,function(){return this}),t.exports={IteratorPrototype:n,BUGGY_SAFARI_ITERATORS:ue}},function(t,r,e){var n=e(7);t.exports=!n(function(){function g(){}return g.prototype.constructor=null,Object.getPrototypeOf(new g)!==g.prototype})},function(t,r,e){var n=e(13),g=e(115),y=e(58),i=e(112),k=n("".charAt),L=n("".charCodeAt),$=n("".slice),V=function(z){return function(re,oe){var le,ue,ie=y(i(re)),ae=g(oe),Ie=ie.length;return ae<0||ae>=Ie?z?"":void 0:(le=L(ie,ae))<55296||le>56319||ae+1===Ie||(ue=L(ie,ae+1))<56320||ue>57343?z?k(ie,ae):le:z?$(ie,ae,ae+2):ue-56320+(le-55296<<10)+65536}};t.exports={codeAt:V(!1),charAt:V(!0)}},function(t,r,e){var n=e(378);t.exports=n},function(t,r,e){e(75);var n=e(73),g=e(31),y=e(18),i=e(380),k=Array.prototype,L={DOMTokenList:!0,NodeList:!0};t.exports=function($){var V=$.forEach;return $===k||y(k,$)&&V===k.forEach||g(L,n($))?i:V}},function(t,r,e){var n=e(388);t.exports=n},function(t,r,e){var n=e(392);e(75),t.exports=n},function(t,r,e){e(393)},function(t,r,e){var n=e(33),g=e(13),y=e(135),i=e(136),k=e(38),L=g([].concat);t.exports=n("Reflect","ownKeys")||function($){var V=y.f(k($)),z=i.f;return z?L(V,z($)):V}},function(t,r,e){var n=e(21),g=e(105),y=n("iterator"),i=Array.prototype;t.exports=function(k){return k!==void 0&&(g.Array===k||i[y]===k)}},function(t,r,e){var n=e(20),g=e(32),y=e(38),i=e(85),k=e(140),L=TypeError;t.exports=function($,V){var z=arguments.length<2?k($):V;if(g(z))return y(n(z,$));throw L(i($)+" is not iterable")}},function(t,r,e){var n=e(20),g=e(38),y=e(167);t.exports=function(i,k,L){var $,V;g(i);try{if(!($=y(i,"return"))){if(k==="throw")throw L;return L}$=n($,i)}catch(z){V=!0,$=z}if(k==="throw")throw L;if(V)throw $;return g($),L}},function(t,r,e){var n=e(33),g=e(40),y=e(21),i=e(29),k=y("species");t.exports=function(L){var $=n(L),V=g.f;i&&$&&!$[k]&&V($,k,{configurable:!0,get:function(){return this}})}},function(t,r,e){var n=e(38),g=e(179),y=e(98),i=e(21)("species");t.exports=function(k,L){var $,V=n(k).constructor;return V===void 0||y($=n(V)[i])?L:g($)}},function(t,r,e){var n,g,y,i,k=e(16),L=e(83),$=e(36),V=e(17),z=e(31),re=e(7),oe=e(222),le=e(104),ue=e(169),ie=e(247),ae=e(248),Ie=e(119),de=k.setImmediate,Ce=k.clearImmediate,Ue=k.process,qe=k.Dispatch,jt=k.Function,Fe=k.MessageChannel,Et=k.String,cr=0,er={};try{n=k.location}catch{}var nr=function(ur){if(z(er,ur)){var or=er[ur];delete er[ur],or()}},dr=function(ur){return function(){nr(ur)}},ir=function(ur){nr(ur.data)},tr=function(ur){k.postMessage(Et(ur),n.protocol+"//"+n.host)};de&&Ce||(de=function(ur){ie(arguments.length,1);var or=V(ur)?ur:jt(ur),fr=le(arguments,1);return er[++cr]=function(){L(or,void 0,fr)},g(cr),cr},Ce=function(ur){delete er[ur]},Ie?g=function(ur){Ue.nextTick(dr(ur))}:qe&&qe.now?g=function(ur){qe.now(dr(ur))}:Fe&&!ae?(i=(y=new Fe).port2,y.port1.onmessage=ir,g=$(i.postMessage,i)):k.addEventListener&&V(k.postMessage)&&!k.importScripts&&n&&n.protocol!=="file:"&&!re(tr)?(g=tr,k.addEventListener("message",ir,!1)):g="onreadystatechange"in ue("script")?function(ur){oe.appendChild(ue("script")).onreadystatechange=function(){oe.removeChild(this),nr(ur)}}:function(ur){setTimeout(dr(ur),0)}),t.exports={set:de,clear:Ce}},function(t,r){var e=TypeError;t.exports=function(n,g){if(n<g)throw e("Not enough arguments");return n}},function(t,r,e){var n=e(72);t.exports=/(?:ipad|iphone|ipod).*applewebkit/i.test(n)},function(t,r){t.exports=typeof Deno=="object"&&Deno&&typeof Deno.version=="object"},function(t,r,e){var n=e(107),g=e(251),y=e(120).CONSTRUCTOR;t.exports=y||!g(function(i){n.all(i).then(void 0,function(){})})},function(t,r,e){var n=e(21)("iterator"),g=!1;try{var y=0,i={next:function(){return{done:!!y++}},return:function(){g=!0}};i[n]=function(){return this},Array.from(i,function(){throw 2})}catch{}t.exports=function(k,L){if(!L&&!g)return!1;var $=!1;try{var V={};V[n]=function(){return{next:function(){return{done:$=!0}}}},k(V)}catch{}return $}},function(t,r,e){var n=e(38),g=e(30),y=e(76);t.exports=function(i,k){if(n(i),g(k)&&k.constructor===i)return k;var L=y.f(i);return(0,L.resolve)(k),L.promise}},function(t,r,e){var n=e(1),g=e(20),y=e(32),i=e(76),k=e(106),L=e(50);n({target:"Promise",stat:!0},{allSettled:function($){var V=this,z=i.f(V),re=z.resolve,oe=z.reject,le=k(function(){var ue=y(V.resolve),ie=[],ae=0,Ie=1;L($,function(de){var Ce=ae++,Ue=!1;Ie++,g(ue,V,de).then(function(qe){Ue||(Ue=!0,ie[Ce]={status:"fulfilled",value:qe},--Ie||re(ie))},function(qe){Ue||(Ue=!0,ie[Ce]={status:"rejected",reason:qe},--Ie||re(ie))})}),--Ie||re(ie)});return le.error&&oe(le.value),z.promise}})},function(t,r,e){var n=e(1),g=e(20),y=e(32),i=e(33),k=e(76),L=e(106),$=e(50);n({target:"Promise",stat:!0},{any:function(V){var z=this,re=i("AggregateError"),oe=k.f(z),le=oe.resolve,ue=oe.reject,ie=L(function(){var ae=y(z.resolve),Ie=[],de=0,Ce=1,Ue=!1;$(V,function(qe){var jt=de++,Fe=!1;Ce++,g(ae,z,qe).then(function(Et){Fe||Ue||(Ue=!0,le(Et))},function(Et){Fe||Ue||(Fe=!0,Ie[jt]=Et,--Ce||ue(new re(Ie,"No one promise resolved")))})}),--Ce||ue(new re(Ie,"No one promise resolved"))});return ie.error&&ue(ie.value),oe.promise}})},function(t,r,e){var n=e(416);t.exports=n},function(t,r,e){var n=e(24).default,g=e(418);t.exports=function(y){var i=g(y,"string");return n(i)==="symbol"?i:String(i)},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,r,e){var n=e(426);t.exports=n},function(t,r,e){var n=e(85),g=TypeError;t.exports=function(y,i){if(!delete y[i])throw g("Cannot delete property "+n(i)+" of "+n(y))}},function(t,r,e){e(461),e(463)},function(t,r,e){var n,g=e(16),y=e(83),i=e(17),k=e(462),L=e(72),$=e(104),V=e(247),z=g.Function,re=/MSIE .\./.test(L)||k&&((n=g.Bun.version.split(".")).length<3||n[0]==0&&(n[1]<3||n[1]==3&&n[2]==0));t.exports=function(oe,le){var ue=le?2:1;return re?function(ie,ae){var Ie=V(arguments.length,1)>ue,de=i(ie)?ie:z(ie),Ce=Ie?$(arguments,ue):[],Ue=Ie?function(){y(de,this,Ce)}:de;return le?oe(Ue,ae):oe(Ue)}:oe}},function(t,r,e){var n=e(477);t.exports=n},function(t,r,e){var n=e(486);t.exports=n},function(t,r){t.exports=function e(n,g){var y,i,k=/(^([+\-]?(?:0|[1-9]\d*)(?:\.\d*)?(?:[eE][+\-]?\d+)?)?$|^0x[0-9a-f]+$|\d+)/gi,L=/(^[ ]*|[ ]*$)/g,$=/(^([\w ]+,?[\w ]+)?[\w ]+,?[\w ]+\d+:\d+(:\d+)?[\w ]?|^\d{1,4}[\/\-]\d{1,4}[\/\-]\d{1,4}|^\w+, \w+ \d+, \d{4})/,V=/^0x[0-9a-f]+$/i,z=/^0/,re=function(Ue){return e.insensitive&&(""+Ue).toLowerCase()||""+Ue},oe=re(n).replace(L,"")||"",le=re(g).replace(L,"")||"",ue=oe.replace(k,"\0$1\0").replace(/\0$/,"").replace(/^\0/,"").split("\0"),ie=le.replace(k,"\0$1\0").replace(/\0$/,"").replace(/^\0/,"").split("\0"),ae=parseInt(oe.match(V),16)||ue.length!==1&&oe.match($)&&Date.parse(oe),Ie=parseInt(le.match(V),16)||ae&&le.match($)&&Date.parse(le)||null;if(Ie){if(ae<Ie)return-1;if(ae>Ie)return 1}for(var de=0,Ce=Math.max(ue.length,ie.length);de<Ce;de++){if(y=!(ue[de]||"").match(z)&&parseFloat(ue[de])||ue[de]||0,i=!(ie[de]||"").match(z)&&parseFloat(ie[de])||ie[de]||0,isNaN(y)!==isNaN(i))return isNaN(y)?1:-1;if(typeof y!=typeof i&&(y+="",i+=""),y<i)return-1;if(y>i)return 1}return 0}},function(t,r,e){var n=e(126),g=e(94);t.exports=function(y){if(!g(y))return!1;var i=n(y);return i=="[object Function]"||i=="[object GeneratorFunction]"||i=="[object AsyncFunction]"||i=="[object Proxy]"}},function(t,r,e){(function(n){var g=typeof n=="object"&&n&&n.Object===Object&&n;t.exports=g}).call(this,e(77))},function(t,r){var e=Function.prototype.toString;t.exports=function(n){if(n!=null){try{return e.call(n)}catch{}try{return n+""}catch{}}return""}},function(t,r,e){var n=e(515),g=e(522),y=e(524),i=e(525),k=e(526);function L($){var V=-1,z=$==null?0:$.length;for(this.clear();++V<z;){var re=$[V];this.set(re[0],re[1])}}L.prototype.clear=n,L.prototype.delete=g,L.prototype.get=y,L.prototype.has=i,L.prototype.set=k,t.exports=L},function(t,r,e){var n=e(269),g=e(204),y=Object.prototype.hasOwnProperty;t.exports=function(i,k,L){var $=i[k];y.call(i,k)&&g($,L)&&(L!==void 0||k in i)||n(i,k,L)}},function(t,r,e){var n=e(528);t.exports=function(g,y,i){y=="__proto__"&&n?n(g,y,{configurable:!0,enumerable:!0,value:i,writable:!0}):g[y]=i}},function(t,r,e){var n=e(530),g=e(531),y=e(183),i=e(271),k=e(306),L=e(534),$=Object.prototype.hasOwnProperty;t.exports=function(V,z){var re=y(V),oe=!re&&g(V),le=!re&&!oe&&i(V),ue=!re&&!oe&&!le&&L(V),ie=re||oe||le||ue,ae=ie?n(V.length,String):[],Ie=ae.length;for(var de in V)!z&&!$.call(V,de)||ie&&(de=="length"||le&&(de=="offset"||de=="parent")||ue&&(de=="buffer"||de=="byteLength"||de=="byteOffset")||k(de,Ie))||ae.push(de);return ae}},function(t,r,e){(function(n){var g=e(59),y=e(533),i=r&&!r.nodeType&&r,k=i&&typeof n=="object"&&n&&!n.nodeType&&n,L=k&&k.exports===i?g.Buffer:void 0,$=(L?L.isBuffer:void 0)||y;n.exports=$}).call(this,e(150)(t))},function(t,r){t.exports=function(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=9007199254740991}},function(t,r){t.exports=function(e,n){return function(g){return e(n(g))}}},function(t,r){t.exports=function(){return[]}},function(t,r,e){var n=e(276),g=e(277),y=e(188),i=e(274),k=Object.getOwnPropertySymbols?function(L){for(var $=[];L;)n($,y(L)),L=g(L);return $}:i;t.exports=k},function(t,r){t.exports=function(e,n){for(var g=-1,y=n.length,i=e.length;++g<y;)e[i+g]=n[g];return e}},function(t,r,e){var n=e(273)(Object.getPrototypeOf,Object);t.exports=n},function(t,r,e){var n=e(276),g=e(183);t.exports=function(y,i,k){var L=i(y);return g(y)?L:n(L,k(y))}},function(t,r,e){var n=e(91)(e(59),"Set");t.exports=n},function(t,r,e){var n=e(577);t.exports=n},function(t,r,e){var n=e(13),g=e(32),y=e(30),i=e(31),k=e(104),L=e(111),$=Function,V=n([].concat),z=n([].join),re={},oe=function(le,ue,ie){if(!i(re,ue)){for(var ae=[],Ie=0;Ie<ue;Ie++)ae[Ie]="a["+Ie+"]";re[ue]=$("C,a","return new C("+z(ae,",")+")")}return re[ue](le,ie)};t.exports=L?$.bind:function(le){var ue=g(this),ie=ue.prototype,ae=k(arguments,1),Ie=function(){var de=V(ae,k(arguments));return this instanceof Ie?oe(ue,de.length,de):ue.apply(le,de)};return y(ie)&&(Ie.prototype=ie),Ie}},function(t,r,e){var n=e(93),g=e(8),y=e(63),i=e(128),k=e(6),L=e(66),$=L.getGlobal(),V={},z=$.name||"_parent",re=[],oe=[];V.addMsgListener=function(qe){re.push(qe)};var le,ue,ie,ae,Ie=(le=/^([\w]+?:\/\/.*?(?=\/|$))/i,function(qe){return qe=qe||"",le.test(qe)?RegExp.$1:"*"}),de=function(){var qe,jt,Fe=n(qe=unescape($.name||"")).call(qe);if(Fe&&g(Fe).call(Fe,"MSG|")===0){$.name="";var Et=L.string2object(Fe.replace("MSG|",""),"|"),cr=(Et.origin||"").toLowerCase();cr&&cr!=="*"&&g(jt=location.href.toLowerCase()).call(jt,cr)!==0||function(er){for(var nr=0,dr=re.length;nr<dr;nr++)try{re[nr].call(null,er)}catch{}}({data:JSON.parse(Et.data||"null"),source:$.frames[Et.self]||Et.self,origin:Ie(Et.ref||(typeof document>"u"?"":document.referrer))})}},Ce=(ie=function(qe,jt){for(var Fe=0,Et=qe.length;Fe<Et;Fe++)if(qe[Fe]===jt)return!0;return!1},function(){if(oe.length){ue=[];for(var qe,jt=oe.length-1;jt>=0;jt--)qe=oe[jt],ie(ue,qe.w)||(ue.push(qe.w),y(oe).call(oe,jt,1),qe.w.name=qe.d);ue=null}}),Ue=V.startTimer=(ae=!1,function(){ae||(ae=!0,$.postMessage||(i(Ce,100),i(de,20)))});V.postMessage=function(qe){var jt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(L.fillUndef(jt,{origin:"*",source:z}),$.postMessage){var Fe=jt.data;$.FormData||(Fe=k(Fe)),qe.postMessage(Fe,jt.origin)}else{if(Ue(),L.isObject(jt)){var Et={};Et.origin=jt.origin||"",Et.ref=location.href,Et.self=jt.source,Et.data=k(jt.data),jt="MSG|"+L.object2string(Et,"|",!0)}oe.unshift({w:qe,d:escape(jt)})}},t.exports=V},function(t,r,e){var n=e(599);t.exports=n},function(t,r,e){var n=e(0),g={file:{md5:"$(Etag)",size:"$(ObjectSize)"},image:{md5:"$(Etag)",size:"$(ObjectSize)",w:"$(ImageInfo.Width)",h:"$(ImageInfo.Height)",orientation:"$(ImageInfo.Orientation)"},audio:{md5:"$(Etag)",size:"$(ObjectSize)",dur:"$(AVinfo.Audio.Duration)"},video:{md5:"$(Etag)",size:"$(ObjectSize)",dur:"$(AVinfo.Video.Duration)",w:"$(AVinfo.Video.Width)",h:"$(AVinfo.Video.Height)"}},y={genResponseBody:function(i){return g[i=i||"file"]},parseResponse:function(i,k){n.notundef(i.size)&&(i.size=+i.size),n.notundef(i.w)&&(i.w=+i.w),n.notundef(i.h)&&(i.h=+i.h),n.notundef(i.dur)&&(i.dur=+i.dur);var L=i.orientation;if(n.notundef(L)&&(delete i.orientation,k&&(L==="right, top"||L==="left, bottom"))){var $=i.w;i.w=i.h,i.h=$}return i}};t.exports=y},function(t,r,e){var n=e(127),g=e(9),y=e(8),i=e(28),k=e(56),L=e(43),$=e(22),V=["Code","code","Message","message"],z=e(12),re=e(0),oe=e(35),le=e(624),ue=e(625),ie=e(109),ae=ie.EMResourceUploadWay,Ie=ie.EMExceptionState,de=e(192).abort,Ce=-1,Ue=re.supportFormData;function qe(Fe,Et){var cr=this,er=Fe.uploadprogress,nr=Fe.uploaddone,dr=Fe.beginupload;return{beginupload:typeof dr=="function"?function(ir){try{dr(ir,Et)}catch(tr){cr.logger.error("Upload::options.beginupload execute error",tr)}}:function(){},uploadprogress:typeof er=="function"?function(ir){cr.reporterHook.emit("reporter/uploadUpdate",{transferred_size:ir.loaded});try{er(ir,Et)}catch(tr){cr.logger.error("Upload::options.uploadprogress execute error",tr)}}:function(ir){cr.reporterHook.emit("reporter/uploadUpdate",{transferred_size:ir.loaded})},uploaddone:function(ir,tr){ir?cr.reporterHook.emit("reporter/uploadEnd",ir.code==="RequestAbortedError"||ir.code==="abort"?Ie.kCanceled:Ie.kFailed):cr.reporterHook.emit("reporter/uploadEnd",Ie.kSucceed);try{nr(ir,tr,null,Et)}catch(ur){cr.logger.error("Upload::options.uploaddone execute error",ur)}}}}function jt(Fe,Et,cr){var er=this;er.options=re.copy(Fe),Fe=er.options,re.verifyOptions(Fe,"url fileName"),re.verifyParamPresentJustOne(Fe,"blob fileInput"),re.verifyCallback(Fe,"beginupload uploadprogress uploaddone"),er.reporterHook=Et.reporterHook,er.logger=Et.logger,er.protocol=Et,er.message=cr;var nr=qe.call(this,Fe,cr),dr=nr.beginupload,ir=nr.uploadprogress,tr=nr.uploaddone;er.options.beginupload=dr,er.options.uploadprogress=ir,er.options.uploaddone=tr,Fe.fileInput&&(Fe.fileInput=re.verifyFileInput(Fe.fileInput)),Fe.type&&re.verifyFileType(Fe.type),Fe.timeout?re.verifyParamType("timeout",Fe.timeout,"number"):Fe.timeout=6e5,re.verifyFileUploadCallback(Fe),Fe.data={},Fe.params&&re.merge(Fe.data,Fe.params);var ur,or,fr=Fe.fileName,lr=Fe.fileInput;if(Ue){if(lr){if(!(or=Fe.type?re.filterFiles(lr.files,Fe.type):g([]).call(lr.files,0))||!or.length)return void Fe.uploaddone(oe.newWrongFileTypeError("未读取到"+Fe.type+"类型的文件, 请确保文件选择节点的文件不为空, 并且请确保选择了"+Fe.type+"类型的文件"));Fe.data[fr]=or[0],ur=lr.files[0].size}else if(Fe.blob){var gr;if(Fe.data[fr]=Fe.blob,Fe.type!=="file"&&Fe.blob.type&&y(gr=Fe.blob.type).call(gr,Fe.type)===-1)return void Fe.uploaddone(oe.newWrongFileTypeError("未读取到"+Fe.type+"类型的文件, 请确保选择了"+Fe.type+"类型的文件"));ur=Fe.blob.size}if(er.reporterHook.emit("reporter/uploadUpdate",{full_size:ur}),Fe.maxSize&&ur>Fe.maxSize)return void Fe.uploaddone(oe.newFileTooLargeError("上传文件大小超过".concat(Fe.maxSize,"限制")))}function Sr(){if(Ce+=1,er.logger.info("Upload:enter aws upload"),ur){if(ur>z.chunkMaxSize)Fe.uploaddone(oe.newFileTooLargeError("直传文件大小超过".concat(z.commonMaxSize,"限制")));else if(Fe.s3Policy&&Fe.s3Policy.uploadConfig&&Fe.s3Policy.uploadConfig.retryPolicy){var mr=Fe.s3Policy.uploadConfig.retryPolicy,Ir={accessKeyId:Fe.mixStoreToken.accessKeyId,secretAccessKey:Fe.mixStoreToken.secretAccessKey,sessionToken:Fe.mixStoreToken.sessionToken,region:Fe.mixStoreToken.region,maxRetries:mr.retry},Nr=Fe.s3,Er={};if(Fe.s3Policy&&Fe.s3Policy.uploadConfig&&i(Fe.s3Policy.uploadConfig.uploadUrl)&&Fe.s3Policy.uploadConfig.uploadUrl.length>0){var sr=Fe.s3Policy.uploadConfig.uploadUrl.length;Ce%=sr,Er.endpoint=Fe.s3Policy.uploadConfig.uploadUrl[Ce],Er.s3ForcePathStyle=!0}var xr=new Nr(Er);xr.config.update(Ir);var Or=er.reporterHook.getNTPTime();xr.config.systemClockOffset=Or-k();var Mr=decodeURIComponent(Fe.mixStoreToken.bucket),br=decodeURIComponent(Fe.mixStoreToken.objectName),hr=Fe.data[fr],Tr=xr.upload({Bucket:Mr,Key:br,Body:hr,Metadata:{token:Fe.mixStoreToken.token},ContentType:hr.type||"application/octet-stream"});Tr.on("httpUploadProgress",function(Br){var Fr=Math.floor(1e4*Br.loaded/Br.total)/100,Lr={docId:Fe.docId,total:Br.total,loaded:Br.loaded,percentage:Fr,percentageText:Fr+"%"};Fe.fileInput&&(Lr.fileInput=Fe.fileInput),Fe.blob&&(Lr.blob=Fe.blob),Fe.uploadprogress(Lr)}),Tr.send(function(Br,Fr){if(Fe.errorHook({bucket:Mr,object:br},{provider:"s3"}),Fe.docId&&(Fr.docId=Fe.docId),Br&&Br.code==="RequestAbortedError")er.logger.error("uploadFile:","api::s3:upload file abort",Br),er.onError(Br);else if(Br){var Lr;Fe.logger.error("error:","api::s3:upload file failed",Br);var qr=Fe.providers[(y(Lr=Fe.providers).call(Lr,Fe.curProvider)+1)%Fe.providers.length];mr.retryNext&&qr?(er.addCircuitTimer(Fe,qr),qr===1&&wr()):er.onError(Fr),Fe.errorHook(Br,{provider:"s3"})}else{var Ur=er.options.s3Policy.cdnSchema;Ur=(Ur=Ur.replace("{cdnDomain}",er.options.s3Policy.dlcdn)).replace("{objectName}",Fr.Key),Fe.uploaddone(null,{size:hr.size,name:hr.name,url:Ur,ext:hr.name&&hr.name.split(".")[1]||"unknown",_url_safe:Fe.mixStoreToken.shortUrl,isS3:!0}),Fe.logger.info("s3 Upload done: fileObj is",{size:hr.size,name:hr.name,url:Ur,ext:hr.name&&hr.name.split(".")[1]||"unknown",_url_safe:Fe.mixStoreToken.shortUrl,isS3:!0})}}),typeof Fe.beginupload=="function"&&Fe.beginupload(Tr)}}else Fe.uploaddone(oe.newFileTooLargeError("Browser version is too low"))}function wr(){if(er.logger.info("Upload:enter nos upload"),ur&&!Fe.commonUpload)return er.logger.info("Upload:use chunk upload, url ".concat(Fe.url)),ur>z.chunkMaxSize?void Fe.uploaddone(oe.newFileTooLargeError("直传文件大小超过".concat(z.chunkMaxSize,"限制"))):void(er.sn=ue(Fe,fr,er,-1));if(er.logger.info("Upload:use common upload, url ".concat(Fe.url)),ur&&ur>z.commonMaxSize)Fe.uploaddone(oe.newFileTooLargeError("普通上传文件大小超过".concat(z.commonMaxSize,"限制")));else{ur||(re.dataset(lr,"name",fr),Fe.data.input=lr);var mr=0,Ir={data:Fe.data,onaftersend:function(){Fe.beginupload(er,er.message)},onuploading:function(Nr){if(mr!==100){var Er=Math.floor(1e4*Nr.loaded/Nr.total)/100;L(Er)>=100&&(mr=Er=100);var sr={docId:Fe.docId,total:Nr.total,loaded:Nr.loaded,percentage:Er,percentageText:Er+"%"};Fe.fileInput&&(sr.fileInput=Fe.fileInput),Fe.blob&&(sr.blob=Fe.blob),Fe.uploadprogress(sr)}},onload:function(Nr){var Er;if(Fe.docId&&(Nr.docId=Fe.docId),!Nr.Error)return Fe.uploaddone(null,Nr),void Fe.logger.info("nos Upload done: fileObj is",Nr);if(Fe.mixEnable&&Fe.curProvider===1){var sr=Fe.nosPolicy.uploadConfig.retryPolicy,xr=Fe.providers[(y(Er=Fe.providers).call(Er,Fe.curProvider)+1)%Fe.providers.length];sr.retryNext&&xr?(er.addCircuitTimer(Fe,xr),xr===2&&Fe.getMixStoreToken(2,function(Or){Fe.mixStoreToken=Or,Sr()})):er.onError(Nr)}else er.onError(Nr)},onerror:function(Nr){var Er;if(Fe.mixEnable&&Fe.curProvider===1){var sr,xr=Fe.nosPolicy.uploadConfig.retryPolicy,Or=Fe.providers[(y(sr=Fe.providers).call(sr,Fe.curProvider)+1)%Fe.providers.length];if(xr.retryNext&&Or)er.addCircuitTimer(Fe,Or),Or===2&&Fe.getMixStoreToken(2,function(Mr){Fe.mixStoreToken=Mr,Sr()});else try{Er=Nr.result?JSON.parse(Nr.result):Nr,er.onError(Er)}catch{Fe.uploaddone(new oe(Nr.message,Nr.code),er.options)}}else try{Er=Nr.result?JSON.parse(Nr.result):Nr,er.onError(Er)}catch{Fe.uploaddone(new oe(Nr.message,Nr.code),er.options)}Fe.errorHook(Nr,{provider:"nos"})}};Ue||(Ir.mode="iframe"),Ir.putFileAtEnd=!0,er.sn=le(Fe.url,Ir)}}if(Fe.mixEnable&&Fe.curProvider===2){var kr=er.options.s3Policy.cdnSchema;kr=kr.replace("{cdnDomain}",er.options.s3Policy.dlcdn),er.reporterHook.emit("reporter/uploadUpdate",{remote_addr:kr,operation_type:ae.kResourceUploadWayAWSPlugin}),Sr()}else Fe.mixEnable&&Fe.curProvider===1?(er.reporterHook.emit("reporter/uploadUpdate",{remote_addr:Fe.url,operation_type:ae.kResourceUploadWayNOSPlugin}),wr()):(er.reporterHook.emit("reporter/uploadUpdate",{remote_addr:Fe.url,operation_type:ae.kResourceUploadWayNOS}),wr())}jt.prototype.addCircuitTimer=function(Fe,Et){var cr=this;if(Fe.curProvider=Et,Fe.s3Policy&&Fe.nosPolicy){var er=Fe[Fe.curProvider===1?"nosPolicy":"s3Policy"].uploadConfig.retryPolicy.circuit;if(!er||er===0)return;cr.circuitTimer&&clearTimeout(cr.circuitTimer),cr.circuitTimer=$(function(){Fe.curProvider=Fe.providers[0],cr.circuitTimer=void 0},1e3*er)}},jt.prototype.onError=function(){var Fe=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},Et=this,cr=Et.options,er=Fe.Error||Fe||{},nr=er.Code,dr=er.code,ir=er.Message,tr=er.message,ur=n(er,V),or=nr||dr||"unknown",fr=ir||tr||"未知错误";cr.uploaddone(new oe(fr,or,ur))},jt.prototype.abort=function(){de(this.sn)},t.exports=jt},function(t,r,e){var n=e(626);t.exports=n},function(t,r,e){t.exports=e(641)},function(t,r,e){var n=e(644);t.exports=n},function(t,r,e){var n=e(8),g=e(0),y={fromDataURL:function(i){var k,L,$=g.getGlobal();L=n(k=i.split(",")[0]).call(k,"base64")>=0?$.atob(i.split(",")[1]):$.decodeURIComponent(i.split(",")[1]);for(var V=i.split(",")[0].split(":")[1].split(";")[0],z=new Uint8Array(L.length),re=0;re<L.length;re++)z[re]=L.charCodeAt(re);return new $.Blob([z],{type:V})}};t.exports=y},function(t,r,e){var n=e(5),g=e(11),y=e(10),i=e(0),k={stripmeta:0,blur:2,quality:3,crop:4,rotate:5,thumbnail:7,interlace:9},L={0:"stripmeta",1:"type",2:"blur",3:"quality",4:"crop",5:"rotate",6:"pixel",7:"thumbnail",8:"watermark",9:"interlace",10:"tmp"};function $(V){i.verifyOptions(V,"type","image::ImageOp"),i.verifyParamValid("type",V.type,$.validTypes,"image::ImageOp"),i.merge(this,V),this.type=k[V.type]}$.validTypes=n(k),$.reverse=function(V){var z=i.copy(V);return z.type=L[z.type],z},$.reverseImageOps=function(V){return g(V).call(V,function(z){return y($).call($,z)})},t.exports=$},function(t,r,e){var n=e(2),g=e(5),y={1:"ROOM_CLOSE",2:"ROOM_JOIN",3:"INVITE",4:"CANCEL_INVITE",5:"REJECT",6:"ACCEPT",7:"LEAVE",8:"CONTROL"},i={1:"accid",2:"uid",3:"createTime",4:"expireTime",5:"web_uid"},k={10404:"ROOM_NOT_EXISTS",10405:"ROOM_HAS_EXISTS",10406:"ROOM_MEMBER_NOT_EXISTS",10407:"ROOM_MEMBER_HAS_EXISTS",10408:"INVITE_NOT_EXISTS",10409:"INVITE_HAS_REJECT",10410:"INVITE_HAS_ACCEPT",10201:"PEER_NIM_OFFLINE",10202:"PEER_PUSH_OFFLINE",10419:"ROOM_MEMBER_EXCEED",10420:"ROOM_MEMBER_HAS_EXISTS_OTHER_CLIENT",10417:"UID_CONFLICT"};t.exports={parseAvSignalType:function(L){return y[L]||L},parseAvSignalMember:function(L){var $,V={};return n($=g(L)).call($,function(z){V[i[z]]=L[z]}),V},parseAvSignalError:function(L){return L.message=k[L.code]||L.message||L,L}}},function(t,r,e){t.exports=e(662)},function(t,r,e){t.exports=e(673)},function(module,exports,__webpack_require__){(function(global,module){var __WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;/*! Socket.IO.js build:0.9.11, development. Copyright(c) 2011 LearnBoost <dev@learnboost.com> MIT Licensed */function getGlobal(){return typeof window<"u"?window:typeof self<"u"?self:global!==void 0?global:{}}var root=getGlobal(),io=module.exports;root.location===void 0&&(root.location=null),root.io?module&&(module.exports=io=root.io):root.io=io,function(){(function(t,r){var e=t;e.version="0.9.11",e.protocol=1,e.transports=[],e.j=[],e.sockets={},e.connect=function(n,g){var y,i,k=e.util.parseUri(n);r&&r.location&&(k.protocol=k.protocol||r.location.protocol.slice(0,-1),k.host=k.host||(r.document?r.document.domain:r.location.hostname),k.port=k.port||r.location.port),y=e.util.uniqueUri(k);var L={host:k.ipv6uri?"["+k.host+"]":k.host,secure:k.protocol==="https",port:k.port||(k.protocol==="https"?443:80),query:k.query||""};return e.util.merge(L,g),!L["force new connection"]&&e.sockets[y]||(i=new e.Socket(L)),!L["force new connection"]&&i&&(e.sockets[y]=i),(i=i||e.sockets[y]).of(k.path.length>1?k.path:"")}})(module.exports,root),function(t,r){var e=t.util={},n=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,g=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];e.parseUri=function(i){var k=i,L=i.indexOf("["),$=i.indexOf("]");L!=-1&&$!=-1&&(i=i.substring(0,L)+i.substring(L,$).replace(/:/g,";")+i.substring($,i.length));for(var V=n.exec(i||""),z={},re=14;re--;)z[g[re]]=V[re]||"";return L!=-1&&$!=-1&&(z.source=k,z.host=z.host.substring(1,z.host.length-1).replace(/;/g,":"),z.authority=z.authority.replace("[","").replace("]","").replace(/;/g,":"),z.ipv6uri=!0),z},e.uniqueUri=function(i){var k=i.protocol,L=i.host,$=i.port;return"document"in r&&r.document?(L=L||document.domain,$=$||(k=="https"&&document.location.protocol!=="https:"?443:document.location.port)):(L=L||"localhost",$||k!="https"||($=443)),(k||"http")+"://"+L+":"+($||80)},e.query=function(i,k){var L=e.chunkQuery(i||""),$=[];for(var V in e.merge(L,e.chunkQuery(k||"")),L)L.hasOwnProperty(V)&&$.push(V+"="+L[V]);return $.length?"?"+$.join("&"):""},e.chunkQuery=function(i){for(var k,L={},$=i.split("&"),V=0,z=$.length;V<z;++V)(k=$[V].split("="))[0]&&(L[k[0]]=k[1]);return L};var y=!1;e.load=function(i){if(typeof document<"u"&&document&&document.readyState==="complete"||y)return i();e.on(r,"load",i,!1)},e.on=function(i,k,L,$){i.attachEvent?i.attachEvent("on"+k,L):i.addEventListener&&i.addEventListener(k,L,$)},e.request=function(i){if(i&&typeof XDomainRequest<"u"&&!e.ua.hasCORS)return new XDomainRequest;if(typeof XMLHttpRequest<"u"&&(!i||e.ua.hasCORS))return new XMLHttpRequest;if(!i)try{return new root[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch{}return null},root!==void 0&&e.load(function(){y=!0}),e.defer=function(i){if(!e.ua.webkit||typeof importScripts<"u")return i();e.load(function(){setTimeout(i,100)})},e.merge=function(i,k,L,$){var V,z=$||[],re=L===void 0?2:L;for(V in k)k.hasOwnProperty(V)&&e.indexOf(z,V)<0&&(typeof i[V]=="object"&&re?e.merge(i[V],k[V],re-1,z):(i[V]=k[V],z.push(k[V])));return i},e.mixin=function(i,k){e.merge(i.prototype,k.prototype)},e.inherit=function(i,k){function L(){}L.prototype=k.prototype,i.prototype=new L},e.isArray=Array.isArray||function(i){return Object.prototype.toString.call(i)==="[object Array]"},e.intersect=function(i,k){for(var L=[],$=i.length>k.length?i:k,V=i.length>k.length?k:i,z=0,re=V.length;z<re;z++)~e.indexOf($,V[z])&&L.push(V[z]);return L},e.indexOf=function(i,k,L){var $=i.length;for(L=L<0?L+$<0?0:L+$:L||0;L<$&&i[L]!==k;L++);return $<=L?-1:L},e.toArray=function(i){for(var k=[],L=0,$=i.length;L<$;L++)k.push(i[L]);return k},e.ua={},e.ua.hasCORS=typeof XMLHttpRequest<"u"&&function(){try{var i=new XMLHttpRequest}catch{return!1}return i.withCredentials!=null}(),e.ua.webkit=typeof navigator<"u"&&/webkit/i.test(navigator.userAgent),e.ua.iDevice=typeof navigator<"u"&&/iPad|iPhone|iPod/i.test(navigator.userAgent)}(io!==void 0?io:module.exports,root),function(t,r){function e(){}t.EventEmitter=e,e.prototype.on=function(n,g){return this.$events||(this.$events={}),this.$events[n]?r.util.isArray(this.$events[n])?this.$events[n].push(g):this.$events[n]=[this.$events[n],g]:this.$events[n]=g,this},e.prototype.addListener=e.prototype.on,e.prototype.once=function(n,g){var y=this;function i(){y.removeListener(n,i),g.apply(this,arguments)}return i.listener=g,this.on(n,i),this},e.prototype.removeListener=function(n,g){if(this.$events&&this.$events[n]){var y=this.$events[n];if(r.util.isArray(y)){for(var i=-1,k=0,L=y.length;k<L;k++)if(y[k]===g||y[k].listener&&y[k].listener===g){i=k;break}if(i<0)return this;y.splice(i,1),y.length||delete this.$events[n]}else(y===g||y.listener&&y.listener===g)&&delete this.$events[n]}return this},e.prototype.removeAllListeners=function(n){return n===void 0?(this.$events={},this):(this.$events&&this.$events[n]&&(this.$events[n]=null),this)},e.prototype.removeAllListenersX=function(n){if(n===void 0)return this.$events={},this;for(let g in this.$events)g!==n&&(this.$events[g]=null);return this},e.prototype.listeners=function(n){return this.$events||(this.$events={}),this.$events[n]||(this.$events[n]=[]),r.util.isArray(this.$events[n])||(this.$events[n]=[this.$events[n]]),this.$events[n]},e.prototype.emit=function(n){if(!this.$events)return!1;var g=this.$events[n];if(!g)return!1;var y=Array.prototype.slice.call(arguments,1);if(typeof g=="function")g.apply(this,y);else{if(!r.util.isArray(g))return!1;for(var i=g.slice(),k=0,L=i.length;k<L;k++)i[k].apply(this,y)}return!0}}(io!==void 0?io:module.exports,io!==void 0?io:module.parent.exports),function(exports,nativeJSON){if(nativeJSON&&nativeJSON.parse)return exports.JSON={parse:nativeJSON.parse,stringify:nativeJSON.stringify};var JSON=exports.JSON={};function f(t){return t<10?"0"+t:t}function date(t,r){return isFinite(t.valueOf())?t.getUTCFullYear()+"-"+f(t.getUTCMonth()+1)+"-"+f(t.getUTCDate())+"T"+f(t.getUTCHours())+":"+f(t.getUTCMinutes())+":"+f(t.getUTCSeconds())+"Z":null}var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;function quote(t){return escapable.lastIndex=0,escapable.test(t)?'"'+t.replace(escapable,function(r){var e=meta[r];return typeof e=="string"?e:"\\u"+("0000"+r.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+t+'"'}function str(t,r){var e,n,g,y,i,k=gap,L=r[t];switch(L instanceof Date&&(L=date(t)),typeof rep=="function"&&(L=rep.call(r,t,L)),typeof L){case"string":return quote(L);case"number":return isFinite(L)?String(L):"null";case"boolean":case"null":return String(L);case"object":if(!L)return"null";if(gap+=indent,i=[],Object.prototype.toString.apply(L)==="[object Array]"){for(y=L.length,e=0;e<y;e+=1)i[e]=str(e,L)||"null";return g=i.length===0?"[]":gap?`[
`+gap+i.join(`,
`+gap)+`
`+k+"]":"["+i.join(",")+"]",gap=k,g}if(rep&&typeof rep=="object")for(y=rep.length,e=0;e<y;e+=1)typeof rep[e]=="string"&&(g=str(n=rep[e],L))&&i.push(quote(n)+(gap?": ":":")+g);else for(n in L)Object.prototype.hasOwnProperty.call(L,n)&&(g=str(n,L))&&i.push(quote(n)+(gap?": ":":")+g);return g=i.length===0?"{}":gap?`{
`+gap+i.join(`,
`+gap)+`
`+k+"}":"{"+i.join(",")+"}",gap=k,g}}JSON.stringify=function(t,r,e){var n;if(gap="",indent="",typeof e=="number")for(n=0;n<e;n+=1)indent+=" ";else typeof e=="string"&&(indent=e);if(rep=r,r&&typeof r!="function"&&(typeof r!="object"||typeof r.length!="number"))throw new Error("socket.io:: replacer cannot JSON.stringify");return str("",{"":t})},JSON.parse=function(text,reviver){var j;function walk(t,r){var e,n,g=t[r];if(g&&typeof g=="object")for(e in g)Object.prototype.hasOwnProperty.call(g,e)&&((n=walk(g,e))!==void 0?g[e]=n:delete g[e]);return reviver.call(t,r,g)}if(text=String(text),cx.lastIndex=0,cx.test(text)&&(text=text.replace(cx,function(t){return"\\u"+("0000"+t.charCodeAt(0).toString(16)).slice(-4)})),/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return j=eval("("+text+")"),typeof reviver=="function"?walk({"":j},""):j;throw new SyntaxError("socket.io:: reviver cannot JSON.parse")}}(io!==void 0?io:module.exports,typeof JSON<"u"?JSON:void 0),function(t,r){var e=t.parser={},n=e.packets=["disconnect","connect","heartbeat","message","json","event","ack","error","noop"],g=e.reasons=["transport not supported","client not handshaken","unauthorized"],y=e.advice=["reconnect"],i=r.JSON,k=r.util.indexOf;e.encodePacket=function($){var V=k(n,$.type),z=$.id||"",re=$.endpoint||"",oe=$.ack,le=null;switch($.type){case"error":var ue=$.reason?k(g,$.reason):"",ie=$.advice?k(y,$.advice):"";ue===""&&ie===""||(le=ue+(ie!==""?"+"+ie:""));break;case"message":$.data!==""&&(le=$.data);break;case"event":var ae={name:$.name};$.args&&$.args.length&&(ae.args=$.args),le=i.stringify(ae);break;case"json":le=i.stringify($.data);break;case"connect":$.qs&&(le=$.qs);break;case"ack":le=$.ackId+($.args&&$.args.length?"+"+i.stringify($.args):"")}var Ie=[V,z+(oe=="data"?"+":""),re];return le!=null&&Ie.push(le),Ie.join(":")},e.encodePayload=function($){var V="";if($.length==1)return $[0];for(var z=0,re=$.length;z<re;z++)V+="�"+$[z].length+"�"+$[z];return V};var L=/([^:]+):([0-9]+)?(\+)?:([^:]+)?:?([\s\S]*)?/;e.decodePacket=function($){if(!(re=$.match(L)))return{};var V=re[2]||"",z=($=re[5]||"",{type:n[re[1]],endpoint:re[4]||""});switch(V&&(z.id=V,re[3]?z.ack="data":z.ack=!0),z.type){case"error":var re=$.split("+");z.reason=g[re[0]]||"",z.advice=y[re[1]]||"";break;case"message":z.data=$||"";break;case"event":try{var oe=i.parse($);z.name=oe.name,z.args=oe.args}catch{}z.args=z.args||[];break;case"json":try{z.data=i.parse($)}catch{}break;case"connect":z.qs=$||"";break;case"ack":if((re=$.match(/^([0-9]+)(\+)?(.*)/))&&(z.ackId=re[1],z.args=[],re[3]))try{z.args=re[3]?i.parse(re[3]):[]}catch{}}return z},e.decodePayload=function($){var V=function(ie,ae){for(var Ie=0,de=ie;de<ae.length;de++){if(ae.charAt(de)=="�")return Ie;Ie++}return Ie};if($.charAt(0)=="�"){for(var z=[],re=1,oe="";re<$.length;re++)if($.charAt(re)=="�"){var le=$.substr(re+1).substr(0,oe);if($.charAt(re+1+Number(oe))!="�"&&re+1+Number(oe)!=$.length){var ue=Number(oe);l=V(re+ue+1,$),le=$.substr(re+1).substr(0,ue+l),re+=l}z.push(e.decodePacket(le)),re+=Number(oe)+1,oe=""}else oe+=$.charAt(re);return z}return[e.decodePacket($)]}}(io!==void 0?io:module.exports,io!==void 0?io:module.parent.exports),function(t,r){function e(n,g){this.socket=n,this.sessid=g}t.Transport=e,r.util.mixin(e,r.EventEmitter),e.prototype.heartbeats=function(){return!0},e.prototype.onData=function(n){if(this!==this.socket.transport)return this;if(this.clearCloseTimeout(),(this.socket.connected||this.socket.connecting||this.socket.reconnecting)&&this.setCloseTimeout(),n!==""){var g=r.parser.decodePayload(n);if(g&&g.length)for(var y=0,i=g.length;y<i;y++)this.onPacket(g[y])}return this},e.prototype.onPacket=function(n){return this.socket.setHeartbeatTimeout(),n.type=="heartbeat"?this.onHeartbeat():(n.type=="connect"&&n.endpoint==""&&this.onConnect(),n.type=="error"&&n.advice=="reconnect"&&(this.isOpen=!1),this.socket.onPacket(n),this)},e.prototype.setCloseTimeout=function(){if(!this.closeTimeout){var n=this;this.closeTimeout=setTimeout(function(){n.socket&&n.socket.publish("info","socket disconnected by setCloseTimeout"),n.onDisconnect("disconnected by setCloseTimeout of Transport")},this.socket.closeTimeout)}},e.prototype.onDisconnect=function(n){return this.isOpen&&this.close(),this.clearTimeouts(),this.socket?(this.socket.transport===this?this.socket.onDisconnect(n):this.socket.setBuffer(!1),this):this},e.prototype.onConnect=function(){return this.socket.onConnect(),this},e.prototype.clearCloseTimeout=function(){this.closeTimeout&&(clearTimeout(this.closeTimeout),this.closeTimeout=null)},e.prototype.clearTimeouts=function(){this.clearCloseTimeout(),this.reopenTimeout&&clearTimeout(this.reopenTimeout)},e.prototype.packet=function(n){this.send(r.parser.encodePacket(n))},e.prototype.onHeartbeat=function(n){this.packet({type:"heartbeat"})},e.prototype.onOpen=function(){this.isOpen=!0,this.clearCloseTimeout(),this.socket.onOpen()},e.prototype.onClose=function(){this.socket.publish("info","transport onClose"),this.isOpen=!1,this.socket.transport===this?this.socket.onClose():this.socket.setBuffer(!1),this.onDisconnect("disconnected by onClose of Transport"),this.onDisconnectDone instanceof Function&&this.onDisconnectDone(null),this.onConnectionOver instanceof Function&&this.onConnectionOver(null)},e.prototype.onDisconnectDone=function(){},e.prototype.onConnectionOver=function(){},e.prototype.prepareUrl=function(){var n=this.socket.options;return this.scheme()+"://"+n.host+":"+n.port+"/"+n.resource+"/"+r.protocol+"/"+this.name+"/"+this.sessid},e.prototype.ready=function(n,g){g.call(this)}}(io!==void 0?io:module.exports,io!==void 0?io:module.parent.exports),function(t,r,e){function n(y){if(this.options={port:80,secure:!1,document:"document"in e&&document,resource:"socket.io",transports:y.transports||r.transports,"connect timeout":1e4,"try multiple transports":!0,reconnect:!0,"reconnection delay":500,"reconnection limit":1/0,"reopen delay":3e3,"max reconnection attempts":10,"sync disconnect on unload":!1,"auto connect":!0,"flash policy port":10843,needToXHR:!0,manualFlush:!1},r.util.merge(this.options,y),this.connected=!1,this.open=!1,this.connecting=!1,this.reconnecting=!1,this.namespaces={},this.buffer=[],this.doBuffer=!1,this.options["sync disconnect on unload"]&&(!this.isXDomain()||r.util.ua.hasCORS)){var i=this;r.util.on(e,"beforeunload",function(){i.disconnectSync()},!1)}this.options["auto connect"]&&this.connect()}function g(){}t.Socket=n,r.util.mixin(n,r.EventEmitter),n.prototype.of=function(y){return this.namespaces[y]||(this.namespaces[y]=new r.SocketNamespace(this,y),y!==""&&this.namespaces[y].packet({type:"connect"})),this.namespaces[y]},n.prototype.publish=function(){var y;for(var i in this.emit.apply(this,arguments),this.namespaces)this.namespaces.hasOwnProperty(i)&&(y=this.of(i)).$emit.apply(y,arguments)},n.prototype.guid=function(){var y=root.crypto||root.msCrypto;if(y){var i=new Uint8Array(16);y.getRandomValues(i),i[6]&=15,i[6]|=64,i[8]&=63,i[8]|=128;for(var k="",L=0;L<i.length;L++){var $=i[L].toString(16);$.length===1&&($="0"+$),k+=$}return k.substring(0,8)+"-"+k.substring(8,12)+"-"+k.substring(12,16)+"-"+k.substring(16,20)+"-"+k.substring(20)}},n.prototype.handshake=function(y){var i=this,k=this.options;if(!this.options.needToXHR&&this.options.transports.length===1&&this.options.transports[0]==="websocket"){var L=this.guid();if(L)return void setTimeout(function(){i.publish("info","xhr, skip and get:"+L),y.apply(null,[L,"90","60","websocket"])},0)}function $(le){le instanceof Error?(i.connecting=!1,i.publish("info","xhr, status:200, but got error:",le),i.onError("xhr, status:200, but got error:"+le.message,le)):y.apply(null,le.split(":"))}var V=["http"+(k.secure?"s":"")+":/",k.host+":"+k.port,k.resource,r.protocol,r.util.query(this.options.query,"t="+ +new Date)].join("/");if(this.isXDomain()&&!r.util.ua.hasCORS&&typeof document<"u"&&document){var z=document.getElementsByTagName("script")[0],re=document.createElement("script");re.src=V+"&jsonp="+r.j.length,re.onreadystatechange=function(){this.readyState=="loaded"&&re.parentNode&&(re.parentNode.removeChild(re),i.connecting=!1,i.publish("info","xhr, jsonp:Server down or port not open"),!i.reconnecting&&i.onError("Server down or port not open",new Error("xhr, jsonp:server down or port not open")),i.publish("handshake_failed"))},z.parentNode.insertBefore(re,z),r.j.push(function(le){$(le),re.parentNode.removeChild(re)})}else{var oe=r.util.request();oe.open("GET",V,!0),oe.timeout=8e3,this.isXDomain()&&(oe.withCredentials=!0),oe.onreadystatechange=function(){i.publish("info","xhr, readyState:"+oe.readyState+" status:"+oe.status),oe.readyState==4&&(i.publish("info","xhr, responseText:"+oe.responseText),oe.onreadystatechange=g,oe.status==200?$(oe.responseText):oe.status==403?(i.connecting=!1,i.onError(oe.responseText,new Error("xhr, status:403"+oe.responseText)),i.publish("handshake_failed")):(i.connecting=!1,!i.reconnecting&&i.onError(oe.responseText,new Error("xhr, status:"+oe.status+" "+oe.responseText)),i.publish("handshake_failed")))},oe.ontimeout=function(le){i.publish("info","xhr, timeout"),i.connecting=!1,!i.reconnecting&&i.onError(oe.responseText,new Error("xhr, timeout")),i.publish("handshake_failed")},oe.send(null)}},n.prototype.connect=function(y){if(this.connecting)return this;var i=this;return i.connecting=!0,this.handshake(function(k,L,$,V){i.publish("info","SocketIO handshake parameter: sid: "+k+", transports: "+V+", close: "+$+", heartbeat: "+L),i.sessionid=k,i.closeTimeout=1e3*$,i.heartbeatTimeout=1e3*L,i.transports||(i.transports=i.origTransports=V?r.util.intersect(V.split(","),i.options.transports):i.options.transports),i.setHeartbeatTimeout(),i.once("connect",function(){i.publish("info","tcp, clear connect timeout due to recv connect event"),clearTimeout(i.connectTimeoutTimer),i.connectTimeoutTimer=null,y&&typeof y=="function"&&y()}),i.doConnect()}),this},n.prototype.doConnect=function(){var y=this;if(y.transport&&y.transport.clearTimeouts(),y.transport=y.getTransport(y.transports),!y.transport)return y.publish("connect_failed");y.transport.ready(y,function(){y.connecting=!0,y.publish("info","tcp, connecting, transport ready in "+y.transport.name),y.publish("connecting",y.transport.name),y.transport.open(),y.options["connect timeout"]&&(y.connectTimeoutTimer&&clearTimeout(y.connectTimeoutTimer),y.publish("info","set new connect timeout"),y.connectTimeoutTimer=setTimeout(function(){y.publish("info","trigger connect timeout due to setTimeout"),y.transport.close(),y.tryNextTransport()},y.options["connect timeout"]))})},n.prototype.getTransport=function(y){const i=this;for(var k,L=y||this.transports,$=0;k=L[$];$++)if(i.publish("info","check transport: "+k),r.Transport[k]&&r.Transport[k].check(this)&&(!this.isXDomain()||r.Transport[k].xdomainCheck(this)))return i.publish("info","use transport: "+k),new r.Transport[k](this,this.sessionid);return null},n.prototype.tryNextTransport=function(){if(!this.connected&&(this.connecting=!1,this.options["try multiple transports"])){for(var y=this.transports;y.length>0&&y.splice(0,1)[0]!=this.transport.name;);y.length?this.doConnect():this.publish("connect_failed")}},n.prototype.setHeartbeatTimeout=function(){if(clearTimeout(this.heartbeatTimeoutTimer),!this.transport||this.transport.heartbeats()){var y=this;this.heartbeatTimeoutTimer=setTimeout(function(){y.transport&&(y.publish("info","transport closed by setHeartbeatTimeout"),y.transport.onClose())},this.heartbeatTimeout)}},n.prototype.packet=function(y){return this.connected&&!this.doBuffer?this.transport.packet(y):this.buffer.push(y),this},n.prototype.setBuffer=function(y){this.doBuffer=y,!y&&this.connected&&this.buffer.length&&(this.options.manualFlush||this.flushBuffer())},n.prototype.flushBuffer=function(){this.transport.payload(this.buffer),this.buffer=[]},n.prototype.disconnect=function(){return(this.connected||this.connecting)&&(this.open&&this.of("").packet({type:"disconnect"}),this.publish("info","socket disconnected by IM SDK"),this.onDisconnect("booted")),this},n.prototype.disconnectSync=function(){var y=r.util.request(),i=["http"+(this.options.secure?"s":"")+":/",this.options.host+":"+this.options.port,this.options.resource,r.protocol,"",this.sessionid].join("/")+"/?disconnect=1";y.open("GET",i,!1),y.send(null),this.publish("info","socket disconnected by disconnectSync before page unload"),this.onDisconnect("booted")},n.prototype.isXDomain=function(){var y=e&&e.location||{},i=y.port||(y.protocol=="https:"?443:80);return this.options.host!==y.hostname||this.options.port!=i},n.prototype.onConnect=function(){this.connected||(this.connected=!0,this.connecting=!1,this.doBuffer||this.setBuffer(!1),this.emit("connect"))},n.prototype.onOpen=function(){this.publish("info","tcp, websocket onOpen"),this.open=!0},n.prototype.onClose=function(){this.publish("info","tcp, websocket onClose"),this.open=!1,clearTimeout(this.heartbeatTimeoutTimer)},n.prototype.onPacket=function(y){this.of(y.endpoint).onPacket(y)},n.prototype.onError=function(y,i){y&&y.advice&&y.advice==="reconnect"&&(this.connected||this.connecting)&&(this.disconnect(),this.options.reconnect&&this.reconnect()),this.publish("error",y&&y.reason?y.reason:y,i)},n.prototype.onDisconnect=function(y){var i=this.connected,k=this.connecting;this.publish("info",y?"tcp, onDisconnect reason:"+y:"tcp, onDisconnect"),this.connected=!1,this.connecting=!1,this.open=!1,(i||k)&&this.transport&&(this.transport.close(),this.transport.clearTimeouts(),i&&(this.publish("disconnect",y),y!="booted"&&this.options.reconnect&&!this.reconnecting&&this.reconnect()),k&&(this.connectTimeoutTimer&&(this.publish("info","clear connect timeout due to onDisconnect"),clearTimeout(this.connectTimeoutTimer)),this.tryNextTransport()))},n.prototype.reconnect=function(){this.reconnecting=!0,this.reconnectionAttempts=0,this.reconnectionDelay=this.options["reconnection delay"];var y=this,i=this.options["max reconnection attempts"],k=this.options["try multiple transports"],L=this.options["reconnection limit"];function $(){if(y.connected){for(var z in y.namespaces)y.namespaces.hasOwnProperty(z)&&z!==""&&y.namespaces[z].packet({type:"connect"});y.publish("reconnect",y.transport.name,y.reconnectionAttempts)}clearTimeout(y.reconnectionTimer),y.removeListener("connect_failed",V),y.removeListener("connect",V),y.reconnecting=!1,delete y.reconnectionAttempts,delete y.reconnectionDelay,delete y.reconnectionTimer,delete y.redoTransports,y.options["try multiple transports"]=k}function V(){if(y.reconnecting)return y.connected?$():y.connecting&&y.reconnecting?y.reconnectionTimer=setTimeout(V,1e3):void(y.reconnectionAttempts++>=i?y.redoTransports?(y.publish("reconnect_failed"),$()):(y.on("connect_failed",V),y.options["try multiple transports"]=!0,y.transports=y.origTransports,y.transport=y.getTransport(),y.redoTransports=!0,y.connect()):(y.reconnectionDelay<L&&(y.reconnectionDelay*=2),y.connect(),y.publish("reconnecting",y.reconnectionDelay,y.reconnectionAttempts),y.reconnectionTimer=setTimeout(V,y.reconnectionDelay)))}this.options["try multiple transports"]=!1,this.reconnectionTimer=setTimeout(V,this.reconnectionDelay),this.on("connect",V)}}(io!==void 0?io:module.exports,io!==void 0?io:module.parent.exports,root),function(t,r){function e(g,y){this.socket=g,this.name=y||"",this.flags={},this.json=new n(this,"json"),this.ackPackets=0,this.acks={}}function n(g,y){this.namespace=g,this.name=y}t.SocketNamespace=e,r.util.mixin(e,r.EventEmitter),e.prototype.$emit=r.EventEmitter.prototype.emit,e.prototype.of=function(){return this.socket.of.apply(this.socket,arguments)},e.prototype.packet=function(g){return g.endpoint=this.name,this.socket.packet(g),this.flags={},this},e.prototype.send=function(g,y){var i={type:this.flags.json?"json":"message",data:g};return typeof y=="function"&&(i.id=++this.ackPackets,i.ack=!0,this.acks[i.id]=y),this.packet(i)},e.prototype.emit=function(g){var y=Array.prototype.slice.call(arguments,1),i=y[y.length-1],k={type:"event",name:g};return typeof i=="function"&&(k.id=++this.ackPackets,k.ack="data",this.acks[k.id]=i,y=y.slice(0,y.length-1)),k.args=y,this.packet(k)},e.prototype.disconnect=function(){return this.name===""?this.socket.disconnect():(this.packet({type:"disconnect"}),this.$emit("disconnect")),this},e.prototype.onPacket=function(g){var y=this;function i(){y.packet({type:"ack",args:r.util.toArray(arguments),ackId:g.id})}switch(g.type){case"connect":this.$emit("connect");break;case"disconnect":this.name===""?(this.socket.publish("info","socket disconnected by SocketNameSpace.onPacket"),this.socket.onDisconnect(g.reason||"booted")):this.$emit("disconnect",g.reason);break;case"message":case"json":var k=["message",g.data];g.ack=="data"?k.push(i):g.ack&&this.packet({type:"ack",ackId:g.id}),this.$emit.apply(this,k);break;case"event":k=[g.name].concat(g.args),g.ack=="data"&&k.push(i),this.$emit.apply(this,k);break;case"ack":this.acks[g.ackId]&&(this.acks[g.ackId].apply(this,g.args),delete this.acks[g.ackId]);break;case"error":this.socket.publish("info","packet, type:error",g),g.advice?this.socket.onError(g,new Error("packet, type:error and advice is "+g.advice)):g.reason==="unauthorized"?this.$emit("connect_failed",g.reason):this.$emit("error",g.reason,new Error("packet, type:error and reason is "+g.reason))}},n.prototype.send=function(){this.namespace.flags[this.name]=!0,this.namespace.send.apply(this.namespace,arguments)},n.prototype.emit=function(){this.namespace.flags[this.name]=!0,this.namespace.emit.apply(this.namespace,arguments)}}(io!==void 0?io:module.exports,io!==void 0?io:module.parent.exports),function(t,r,e){function n(g){r.Transport.apply(this,arguments)}t.websocket=n,r.util.inherit(n,r.Transport),n.prototype.name="websocket",n.prototype.open=function(){var g,y=r.util.query(this.socket.options.query),i=this;return g||(g=e.MozWebSocket||e.WebSocket),this.websocket=new g(this.prepareUrl()+y),this.websocket.onopen=function(){i.onOpen(),i.socket.setBuffer(!1)},this.websocket.onmessage=function(k){i.onData(k.data)},this.websocket.onclose=function(k){i.socket.setBuffer(!0),i.socket.publish("websocketOnclose",k),i.onClose()},this.websocket.onerror=function(k){var L="";k&&k.message?L=k.message:k.target&&(L=k.target.readyState?"websocket, readyState:"+k.target.readyState:"websocket event"),i.onError(L,k)},this},r.util.ua.iDevice?n.prototype.send=function(g){var y=this;return setTimeout(function(){y.websocket.send(g)},0),this}:n.prototype.send=function(g){return this.websocket.send(g),this},n.prototype.payload=function(g){for(var y=0,i=g.length;y<i;y++)this.packet(g[y]);return this},n.prototype.close=function(){return this.websocket.close(),this},n.prototype.onError=function(g,y){this.socket.publish("info","tcp, onError",g,y),this.socket.onError(g,y)},n.prototype.scheme=function(){return this.socket.options.secure?"wss":"ws"},n.check=function(){return"WebSocket"in e&&!("__addTask"in WebSocket)||"MozWebSocket"in e},n.xdomainCheck=function(){return!0},r.transports.push("websocket")}(io!==void 0?io.Transport:module.exports,io!==void 0?io:module.parent.exports,root),function(t,r,e){function n(y){y&&(r.Transport.apply(this,arguments),this.sendBuffer=[])}function g(){}t.XHR=n,r.util.inherit(n,r.Transport),n.prototype.open=function(){return this.socket.setBuffer(!1),this.onOpen(),this.get(),this.setCloseTimeout(),this},n.prototype.payload=function(y){for(var i=[],k=0,L=y.length;k<L;k++)i.push(r.parser.encodePacket(y[k]));this.send(r.parser.encodePayload(i))},n.prototype.send=function(y){return this.post(y),this},n.prototype.post=function(y){var i=this;this.socket.setBuffer(!0),this.sendXHR=this.request("POST"),e.XDomainRequest&&this.sendXHR instanceof XDomainRequest?this.sendXHR.onload=this.sendXHR.onerror=function(){this.onload=g,i.socket.setBuffer(!1)}:this.sendXHR.onreadystatechange=function(){this.readyState==4&&(this.onreadystatechange=g,i.posting=!1,this.status==200?i.socket.setBuffer(!1):i.onClose())},this.sendXHR.send(y)},n.prototype.close=function(){return this.onClose(),this},n.prototype.request=function(y){var i=r.util.request(this.socket.isXDomain()),k=r.util.query(this.socket.options.query,"t="+ +new Date);if(i.open(y||"GET",this.prepareUrl()+k,!0),y=="POST")try{i.setRequestHeader?i.setRequestHeader("Content-type","text/plain;charset=UTF-8"):i.contentType="text/plain"}catch{}return i},n.prototype.scheme=function(){return this.socket.options.secure?"https":"http"},n.check=function(y,i){try{var k=r.util.request(i),L=e.XDomainRequest&&k instanceof XDomainRequest,$=y&&y.options&&y.options.secure?"https:":"http:",V=e.location&&$!=e.location.protocol;if(k&&(!L||!V))return!0}catch{}return!1},n.xdomainCheck=function(y){return n.check(y,!0)}}(io!==void 0?io.Transport:module.exports,io!==void 0?io:module.parent.exports,root),function(t,r,e){function n(){r.Transport.XHR.apply(this,arguments)}function g(){}t["xhr-polling"]=n,r.util.inherit(n,r.Transport.XHR),r.util.merge(n,r.Transport.XHR),n.prototype.name="xhr-polling",n.prototype.heartbeats=function(){return!1},n.prototype.open=function(){return r.Transport.XHR.prototype.open.call(this),!1},n.prototype.get=function(){if(this.isOpen){var y=this;this.xhr=this.request(),e.XDomainRequest&&this.xhr instanceof XDomainRequest?(this.xhr.onload=function(){this.onload=g,this.onerror=g,y.retryCounter=1,y.onData(this.responseText),y.get()},this.xhr.onerror=function(){y.retryCounter++,!y.retryCounter||y.retryCounter>3?y.onClose():y.get()}):this.xhr.onreadystatechange=function(){this.readyState==4&&(this.onreadystatechange=g,this.status==200?(y.onData(this.responseText),y.get()):y.onClose())},this.xhr.send(null)}},n.prototype.onClose=function(){if(r.Transport.XHR.prototype.onClose.call(this),this.xhr){this.xhr.onreadystatechange=this.xhr.onload=this.xhr.onerror=g;try{this.xhr.abort()}catch{}this.xhr=null}},n.prototype.ready=function(y,i){var k=this;r.util.defer(function(){i.call(k)})},r.transports.push("xhr-polling")}(io!==void 0?io.Transport:module.exports,io!==void 0?io:module.parent.exports,root),__WEBPACK_AMD_DEFINE_ARRAY__=[],__WEBPACK_AMD_DEFINE_RESULT__=(function(){return io}).apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__),__WEBPACK_AMD_DEFINE_RESULT__===void 0||(module.exports=__WEBPACK_AMD_DEFINE_RESULT__)}()}).call(this,__webpack_require__(77),__webpack_require__(150)(module))},function(t,r,e){var n=e(10),g=e(9),y=e(679),i=e(684),k=e(207),L=e(697),$=Math.pow(2,32);function V(re){for(var oe=[],le=re.length,ue=0;ue<le;){var ie=y(re).call(re,ue),ae=0,Ie=0;for(ie<=127?(ae=0,Ie=0):ie<=2047?(ae=6,Ie=192):ie<=65535?(ae=12,Ie=224):ie<=2097151&&(ae=18,Ie=240),oe.push(Ie|ie>>ae),ae-=6;ae>=0;)oe.push(128|ie>>ae&63),ae-=6;ue+=ie>=65536?2:1}return oe}function z(re){for(var oe="",le=0;le<re.length;){var ue=re[le],ie=0,ae=0;if(ue<=127?(ie=0,ae=255&ue):ue<=223?(ie=1,ae=31&ue):ue<=239?(ie=2,ae=15&ue):ue<=244&&(ie=3,ae=7&ue),re.length-le-ie>0)for(var Ie=0;Ie<ie;)ae=ae<<6|63&(ue=re[le+Ie+1]),Ie+=1;else ae=65533,ie=re.length-le;oe+=i(ae),le+=ie+1}return oe}t.exports={setBigUint64:function(re){var oe=arguments.length>1&&arguments[1]!==void 0&&arguments[1],le=new Uint8Array(8),ue=new DataView(le.buffer),ie=Number(re>$-1?re/$:0),ae=Number(4294967295&re),Ie=oe?[4,0]:[0,4],de=k(Ie,2),Ce=de[0],Ue=de[1];return ue.setUint32(Ce,ie,oe),ue.setUint32(Ue,ae,oe),le},getBigUint64:function(re){var oe=arguments.length>1&&arguments[1]!==void 0&&arguments[1],le=new DataView(re.buffer),ue=oe?[4,0]:[0,4],ie=k(ue,2),ae=ie[0],Ie=ie[1],de=le.getUint32(ae,oe),Ce=le.getUint32(Ie,oe);return de>0?de*$+Ce:Ce},varintToBytes:function(re){var oe=new Uint8Array(4),le=new DataView(oe.buffer),ue=0;do{var ie=127&re;(re>>=7)>0&&(ie|=128),le.setUint8(ue++,ie)}while(re>0);return g(oe).call(oe,0,ue)},setBigUint64ForNumberOverflow:function(re){var oe,le,ue=arguments.length>1&&arguments[1]!==void 0&&arguments[1],ie=new Uint8Array(8),ae=new DataView(ie.buffer),Ie=n(oe=L(re).divide($).number).call(oe).join(""),de=n(le=L(re).mod($).number).call(le).join(""),Ce=Number(Ie),Ue=Number(de),qe=ue?[4,0]:[0,4],jt=k(qe,2),Fe=jt[0],Et=jt[1];return ae.setUint32(Fe,Ce,ue),ae.setUint32(Et,Ue,ue),ie},textDecoder:z,textEncoder:V,encodeText:function(re){if(typeof TextEncoder=="function")return new TextEncoder().encode(re);var oe=V(re);return new Uint8Array(oe)},decodeText:function(re){return typeof TextDecoder=="function"?new TextDecoder("utf-8").decode(re):z(re)}}},function(t,r){t.exports=function(e){var n=-1,g=Array(e.size);return e.forEach(function(y){g[++n]=y}),g}},function(t,r,e){var n,g=e(23),y=e(48),i=e(12),k=e(70),L=e(721),$=e(728),V=e(200),z=V.getLibEnv,re=V.getHostEnv,oe=V.getHostEnvVer,le={initReporter:function(){var ue=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},ie={app_key:ue.appKey,platform:"Web",dev_id:y.deviceId,sdk_ver:i.info.version,env:"online",os_name:k.os?k.os.family:"",os_ver:k.os?k.os.version:"",lib_env:z(),host_env:re(),host_env_ver:oe(),manufactor:k.name,model:oe()};i.isBrowser||(ue.isDataReportEnable=!1);var ae=new L({isDataReportEnable:ue.isDataReportEnable,reportConfigUrl:ue.reportConfigUrl,reportUrl:ue.reportUrl,common:ie,request:$,logger:ue.logger,autoStart:i.isBrowser});return ae}};le.sendBeacon=navigator&&navigator.sendBeacon&&g(n=navigator.sendBeacon).call(n,navigator)||function(ue,ie){var ae=new XMLHttpRequest;ae.open("POST",ue,!0),ae.send(ie)},t.exports=le},function(t,r,e){t.exports=e(722)},function(t,r,e){var n=e(1),g=e(16);n({global:!0,forced:g.globalThis!==g},{globalThis:g})},function(t,r,e){var n=e(1),g=e(13),y=e(117),i=e(30),k=e(31),L=e(40).f,$=e(135),V=e(175),z=e(739),re=e(132),oe=e(741),le=!1,ue=re("meta"),ie=0,ae=function(de){L(de,ue,{value:{objectID:"O"+ie++,weakData:{}}})},Ie=t.exports={enable:function(){Ie.enable=function(){},le=!0;var de=$.f,Ce=g([].splice),Ue={};Ue[ue]=1,de(Ue).length&&($.f=function(qe){for(var jt=de(qe),Fe=0,Et=jt.length;Fe<Et;Fe++)if(jt[Fe]===ue){Ce(jt,Fe,1);break}return jt},n({target:"Object",stat:!0,forced:!0},{getOwnPropertyNames:V.f}))},fastKey:function(de,Ce){if(!i(de))return typeof de=="symbol"?de:(typeof de=="string"?"S":"P")+de;if(!k(de,ue)){if(!z(de))return"F";if(!Ce)return"E";ae(de)}return de[ue].objectID},getWeakData:function(de,Ce){if(!k(de,ue)){if(!z(de))return!0;if(!Ce)return!1;ae(de)}return de[ue].weakData},onFreeze:function(de){return oe&&le&&z(de)&&!k(de,ue)&&ae(de),de}};y[ue]=!0},function(t,r,e){var n=e(20),g=e(32),y=e(17),i=e(38),k=TypeError;t.exports=function(L,$){var V,z=i(this),re=g(z.get),oe=g(z.has),le=g(z.set),ue=arguments.length>2?arguments[2]:void 0;if(!y($)&&!y(ue))throw k("At least one callback required");return n(oe,z,L)?(V=n(re,z,L),y($)&&(V=$(V),n(le,z,L,V))):y(ue)&&(V=ue(),n(le,z,L,V)),V}},function(t,r,e){t.exports=e(771)},function(t,r,e){var n=e(5);e(48);function g(){}g.typeMap={text:0,image:1,audio:2,video:3,geo:4,notification:5,file:6,tip:10,robot:11,g2:12,custom:100};var y=g.typeReverseMap={0:"text",1:"image",2:"audio",3:"video",4:"geo",5:"notification",6:"file",10:"tip",11:"robot",12:"g2",100:"custom"};g.validTypes=n(g.typeMap),g.setFlow=function(i,k){i.flow=i.from===k?i.to===k?"in":"out":"in",i.type==="robot"&&i.content&&i.content.msgOut&&(i.flow="in")},g.getType=function(i){var k=i.type;return y[k]||k},t.exports=g},function(t,r,e){t.exports=function(n,g,y,i){var k=self||window;try{try{var L;try{L=new k.Blob([n])}catch{(L=new(k.BlobBuilder||k.WebKitBlobBuilder||k.MozBlobBuilder||k.MSBlobBuilder)).append(n),L=L.getBlob()}var $=k.URL||k.webkitURL,V=$.createObjectURL(L),z=new k[g](V,y);return $.revokeObjectURL(V),z}catch{return new k[g]("data:application/javascript,".concat(encodeURIComponent(n)),y)}}catch{if(!i)throw Error("Inline worker is not supported");return new k[g](i,y)}}},function(t,r,e){e(12).isBrowser=!0},function(t,r){var e=/^(?:0|[1-9]\d*)$/;t.exports=function(n,g){var y=typeof n;return!!(g=g??9007199254740991)&&(y=="number"||y!="symbol"&&e.test(n))&&n>-1&&n%1==0&&n<g}},function(t,r,e){t.exports=e(565)},function(t,r,e){(function(n){var g,y=e(24),i=e(3),k=e(128),L=e(9),$=e(28),V=e(2),z=e(42),re=e(4),oe=e(5),le=e(15);(function(ue,ie){var ae,Ie=(ue=ue!==void 0?ue:typeof self<"u"?self:n!==void 0?n:{}).IDBKeyRange||ue.webkitIDBKeyRange,de="readonly",Ce="readwrite",Ue=Object.prototype.hasOwnProperty,qe=function(){if(!ae&&!(ae=ue.indexedDB||ue.webkitIndexedDB||ue.mozIndexedDB||ue.oIndexedDB||ue.msIndexedDB||(ue.indexedDB===null&&ue.shimIndexedDB?ue.shimIndexedDB:void 0)))throw"IndexedDB required";return ae},jt=!1,Fe=navigator&&!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent),Et=function(gr){return gr},cr=function(gr){var Sr;return L(Sr=Object.prototype.toString.call(gr)).call(Sr,8,-1).toLowerCase()},er=function(gr){return typeof gr=="function"},nr=function(gr){return cr(gr)==="number"},dr=function(gr){return cr(gr)==="array"},ir=function(gr){return gr===void 0},tr=function(gr,Sr){var wr=this,kr=!1;this.name=Sr,this.getIndexedDB=function(){return gr},this.add=function(Nr){if(kr)throw"Database has been closed";for(var Er=[],sr=0,xr=0;xr<arguments.length-1;xr++)if($(arguments[xr+1]))for(var Or=0;Or<arguments[xr+1].length;Or++)Er[sr]=arguments[xr+1][Or],sr++;else Er[sr]=arguments[xr+1],sr++;var Mr=gr.transaction(Nr,Ce),br=Mr.objectStore(Nr);return new i(function(hr,Tr){V(Er).call(Er,function(Br){var Fr;if(Br.item&&Br.key){var Lr=Br.key;Br=Br.item,Fr=br.add(Br,Lr)}else Fr=br.add(Br);Fr.onsuccess=function(qr){try{var Ur=qr.target,Qr=Ur.source.keyPath;Qr===null&&(Qr="__id__"),z(Br,Qr,{value:Ur.result,enumerable:!0})}catch(vn){Tr(vn)}}}),Mr.oncomplete=function(){hr(Er,wr)},Mr.onerror=function(Br){Br.preventDefault(),Tr(Br)},Mr.onabort=function(Br){Tr(Br)}})},this.updateAndDelete=function(Nr,Er,sr){if(kr)throw"Database has been closed";var xr=gr.transaction(Nr,Ce),Or=xr.objectStore(Nr),Mr=Or.keyPath;return new i(function(br,hr){V(Er).call(Er,function(Tr){if(Tr.item&&Tr.key){var Br=Tr.key;Tr=Tr.item,Or.put(Tr,Br)}else Or.put(Tr)}),V(sr).call(sr,function(Tr){Or.delete(Tr[Mr])}),xr.oncomplete=function(){br([Er,sr])},xr.onerror=function(Tr){hr(Tr)}})},this.update=function(Nr){if(kr)throw"Database has been closed";for(var Er,sr=[],xr=1;xr<arguments.length;xr++)$(Er=arguments[xr])?sr=re(sr).call(sr,Er):sr.push(Er);var Or=gr.transaction(Nr,Ce),Mr=Or.objectStore(Nr);return Mr.keyPath,new i(function(br,hr){V(sr).call(sr,function(Tr){var Br;if(Tr.item&&Tr.key){var Fr=Tr.key;Tr=Tr.item,Br=Mr.put(Tr,Fr)}else Br=Mr.put(Tr);Br.onsuccess=function(Lr){},Br.onerror=function(Lr){}}),Or.oncomplete=function(){br(sr,wr)},Or.onerror=function(Tr){hr(Tr)},Or.onabort=function(Tr){hr(Tr)}})},this.remove=function(Nr,Er,sr,xr,Or,Mr,br){if(kr)throw"Database has been closed";var hr=gr.transaction(Nr,Ce),Tr=hr.objectStore(Nr);return new i(function(Br,Fr){function Lr(Ur){return Ur==null}var qr;Lr(xr)&&(xr=-1/0),Lr(Or)&&(Or=1/0),Er===null||$(Er)||(Er=[Er]),Lr(sr)?Er!==null?V(Er).call(Er,function(Ur){Tr.delete(Ur)}):Tr.delete(range=Ie.bound(xr,Or,Mr,br)):(qr=Er!==null?Ie.only(Er[0]):Ie.bound(xr,Or,Mr,br),Tr.index(sr).openCursor(qr).onsuccess=function(Ur){try{var Qr=Ur.target.result;if(!Qr)return;Qr.delete(),Qr.continue()}catch(vn){Fr(vn)}}),hr.oncomplete=function(){Br()},hr.onerror=function(Ur){Fr(Ur)},hr.onabort=function(Ur){Fr(Ur)}})},this.clear=function(Nr){if(kr)throw"Database has been closed";var Er=gr.transaction(Nr,Ce);return Er.objectStore(Nr).clear(),new i(function(sr,xr){Er.oncomplete=function(){sr()},Er.onerror=function(Or){xr(Or)}})},this.close=function(){kr||(gr.close(),kr=!0,delete fr[Sr])},this.get=function(Nr,Er){if(kr)throw"Database has been closed";var sr=gr.transaction(Nr),xr=sr.objectStore(Nr).get(Er);return new i(function(Or,Mr){xr.onsuccess=function(br){Or(br.target.result)},sr.onerror=function(br){Mr(br)}})},this.query=function(Nr,Er){if(kr)throw"Database has been closed";return new ur(Nr,gr,Er)},this.count=function(Nr,Er){if(kr)throw"Database has been closed";gr.transaction(Nr).objectStore(Nr)};for(var mr=0,Ir=gr.objectStoreNames.length;mr<Ir;mr++)(function(Nr){for(var Er in wr[Nr]={},wr)Ue.call(wr,Er)&&Er!=="close"&&(wr[Nr][Er]=function(sr){return function(){var xr,Or=re(xr=[Nr]).call(xr,L([]).call(arguments,0));return wr[sr].apply(wr,Or)}}(Er))})(gr.objectStoreNames[mr])},ur=function(gr,Sr,wr){var kr,mr=this,Ir=!1,Nr=!1,Er=function(xr,Or,Mr,br,hr,Tr,Br){return new i(function(Fr,Lr){var qr=Ir||Nr?Ce:de,Ur=Sr.transaction(gr,qr),Qr=Ur.objectStore(gr),vn=wr?Qr.index(wr):Qr,_n=xr?Ie[xr].apply(null,Or):null,Yr=[],jn=[_n],Zr=0;hr=hr||null,Tr=Tr||[],Mr!=="count"&&jn.push(br||"next");var An=!!Ir&&oe(Ir);vn[Mr].apply(vn,jn).onsuccess=function(Jr){try{var Mn=Jr.target.result;if(y(Mn)===y(0))Yr=Mn;else if(Mn){if(hr!==null&&hr[0]>Zr)Zr=hr[0],Mn.advance(hr[0]);else if(!(hr!==null&&Zr>=hr[0]+hr[1])){var Bn=!0,wn="value"in Mn?Mn.value:Mn.key;V(Tr).call(Tr,function(In){In&&In.length&&(In.length===2?Bn=Bn&&wn[In[0]]===In[1]:er(In[0])&&(Bn=Bn&&In[0].apply(void 0,[wn])))}),Bn&&(Zr++,Yr.push(Br(wn)),Nr?Mn.delete():Ir&&(wn=function(In){for(var bn=0;bn<An.length;bn++){var hn=An[bn],Zn=Ir[hn];Zn instanceof Function&&(Zn=Zn(In)),In[hn]=Zn}return In}(wn),Mn.update(wn))),Mn.continue()}}}catch(In){Lr(In)}},Ur.oncomplete=function(){Fr(Yr)},Ur.onerror=function(Jr){Lr(Jr)},Ur.onabort=function(Jr){Lr(Jr)}})},sr=function(xr,Or){var Mr="next",br="openCursor",hr=[],Tr=null,Br=Et,Fr=!1,Lr=function(){return Er(xr,Or,br,Fr?Mr+"unique":Mr,Tr,hr,Br)},qr=function(){return Mr=null,br="count",{execute:Lr}},Ur=function Mn(){return(Tr=dr(arguments[0])?arguments[0]:L(Array.prototype).call(arguments,0,2)).length==1&&Tr.unshift(0),nr(Tr[1])||(Tr=null),{execute:Lr,count:qr,keys:Qr,filter:vn,asc:_n,desc:Yr,distinct:jn,modify:Zr,limit:Mn,map:An,remove:Jr}},Qr=function Mn(Bn){return(Bn=!!ir(Bn)||!!Bn)&&(br="openKeyCursor"),{execute:Lr,keys:Mn,filter:vn,asc:_n,desc:Yr,distinct:jn,modify:Zr,limit:Ur,map:An,remove:Jr}},vn=function Mn(){return hr.push(L(Array.prototype).call(arguments,0,2)),{execute:Lr,count:qr,keys:Qr,filter:Mn,asc:_n,desc:Yr,distinct:jn,modify:Zr,limit:Ur,map:An,remove:Jr}},_n=function Mn(Bn){return Bn=!!ir(Bn)||!!Bn,Mr=Bn?"next":"prev",{execute:Lr,count:qr,keys:Qr,filter:vn,asc:Mn,desc:Yr,distinct:jn,modify:Zr,limit:Ur,map:An,remove:Jr}},Yr=function Mn(Bn){return Bn=!!ir(Bn)||!!Bn,Mr=Bn?"prev":"next",{execute:Lr,count:qr,keys:Qr,filter:vn,asc:_n,desc:Mn,distinct:jn,modify:Zr,limit:Ur,map:An,remove:Jr}},jn=function Mn(Bn){return Bn=!!ir(Bn)||!!Bn,Fr=Bn,{execute:Lr,count:qr,keys:Qr,filter:vn,asc:_n,desc:Yr,distinct:Mn,modify:Zr,limit:Ur,map:An,remove:Jr}},Zr=function Mn(Bn){return Ir=Bn,{execute:Lr,count:qr,keys:Qr,filter:vn,asc:_n,desc:Yr,distinct:jn,modify:Mn,limit:Ur,map:An,remove:Jr}},An=function Mn(Bn){return er(Bn)&&(Br=Bn),{execute:Lr,count:qr,keys:Qr,filter:vn,asc:_n,desc:Yr,distinct:jn,modify:Zr,limit:Ur,map:Mn,remove:Jr}},Jr=function Mn(Bn){return Bn=!!ir(Bn)||!!Bn,Nr=Bn,{execute:Lr,count:qr,keys:Qr,filter:vn,asc:_n,desc:Yr,distinct:jn,modify:Zr,limit:Ur,map:An,remove:Mn}};return{execute:Lr,count:qr,keys:Qr,filter:vn,asc:_n,desc:Yr,distinct:jn,modify:Zr,limit:Ur,map:An,remove:Jr}};V(kr="only bound upperBound lowerBound".split(" ")).call(kr,function(xr){mr[xr]=function(){return new sr(xr,arguments)}}),this.filter=function(){var xr=new sr(null,null);return le(xr).apply(xr,arguments)},this.all=function(){var xr;return le(xr=this).call(xr)}},or=function(gr,Sr,wr,kr){var mr=gr.target.result,Ir=new tr(mr,Sr);return fr[Sr]=mr,i.resolve(Ir)},fr={},lr={version:"0.10.2",open:function(gr){var Sr;return new i(function(wr,kr){var mr;fr[gr.server]?or({target:{result:fr[gr.server]}},gr.server,gr.version,gr.schema).then(wr,kr):(jt?i.resolve():Fe&&qe().databases?new i(function(Ir){var Nr=function(){return qe().databases().finally(Ir)};mr=k(Nr,100),Nr()}).finally(function(){jt=!0,clearInterval(mr)}):(jt=!0,i.resolve())).then(function(){try{Sr=qe().open(gr.server,gr.version)}catch(Ir){kr(Ir)}Sr.onsuccess=function(Ir){or(Ir,gr.server,gr.version,gr.schema).then(wr,kr)},Sr.onupgradeneeded=function(Ir){(function(Nr,Er,sr){for(var xr in typeof Er=="function"&&(Er=Er()),Er){var Or,Mr=Er[xr];for(var br in Or=!Ue.call(Er,xr)||sr.objectStoreNames.contains(xr)?Nr.currentTarget.transaction.objectStore(xr):sr.createObjectStore(xr,Mr.key),Mr.indexes){var hr=Mr.indexes[br];try{Or.index(br)}catch{Or.createIndex(br,hr.key||br,oe(hr).length?hr:{unique:!1})}}}})(Ir,gr.schema,Ir.target.result)},Sr.onerror=function(Ir){kr(Ir)}})})},remove:function(gr){return new i(function(Sr,wr){if(!gr)return Sr();var kr,mr;y(gr)===tr&&(gr=gr.name),typeof gr=="string"&&(kr=fr[gr]),kr&&typeof kr.close=="function"&&kr.close();try{mr=qe().deleteDatabase(gr)}catch(Ir){wr(Ir)}mr.onsuccess=function(Ir){delete fr[gr],Sr(gr)},mr.onerror=function(Ir){wr(Ir)},mr.onblocked=function(Ir){wr(Ir)}})}};t.exports!==void 0?t.exports=lr:(g=(function(){return lr}).call(r,e,r,t))===void 0||(t.exports=g)})(void 0)}).call(this,e(77))},function(t,r,e){var n=e(596);t.exports=n},function(t,r,e){t.exports=e(650)},function(t,r){var e={set:function(n,g,y){e[n]=g,y&&(y.support=g)}};t.exports=e},function(t,r,e){var n=e(5),g=e(2),y=e(23),i=e(0),k=i.notundef,L=i.fillPropertyWithDefault,$=n,V={},z={},re={},oe=[],le={normal:2,advanced:1},ue={manager:0,all:1};V.inviteMode=V.updateCustomMode=V.updateTeamMode=ue;var ie={2:"normal",1:"advanced"},ae=V.joinMode={noVerify:0,needVerify:1,rejectAll:2};z.joinMode={0:"noVerify",1:"needVerify",2:"rejectAll"},re.joinMode=$(ae),oe.push("join");var Ie=V.beInviteMode={needVerify:0,noVerify:1};function de(Ue){var qe;i.verifyOptions(Ue,"action","superTeam::SuperTeam"),i.verifyOptions(Ue,"teamId","superTeam::SuperTeam"),k(Ue.teamId)&&(this.teamId=Ue.teamId),k(Ue.type)&&(this.type=le[Ue.type]),k(Ue.avatar)&&(this.avatar=""+Ue.avatar),k(Ue.name)&&(this.name=""+Ue.name),k(Ue.intro)&&(this.intro=""+Ue.intro),k(Ue.announcement)&&(this.announcement=""+Ue.announcement),k(Ue.custom)&&(this.custom=""+Ue.custom),k(Ue.inviteMode)&&(this.inviteMode=ue[Ue.inviteMode]),k(Ue.updateCustomMode)&&(this.updateCustomMode=ue[Ue.updateCustomMode]),k(Ue.updateTeamMode)&&(this.updateTeamMode=ue[Ue.updateTeamMode]),g(oe).call(oe,y(qe=this.setMode).call(qe,this,Ue))}function Ce(Ue,qe){k(Ue[qe+="Mode"])&&(Ue[qe]=z[qe][Ue[qe]])}z.beInviteMode={0:"needVerify",1:"noVerify"},oe.push("beInvite"),z.inviteMode=z.updateCustomMode=z.updateTeamMode={0:"manager",1:"all"},oe.push("invite"),oe.push("updateCustom"),oe.push("updateTeam"),re.inviteMode=re.updateCustomMode=re.updateTeamMode=$(ue),re.beInviteMode=$(Ie),de.prototype.setMode=function(Ue,qe){k(Ue[qe+="Mode"])&&(i.verifyParamValid(qe,Ue[qe],re[qe],"Superteam::Team"),this[qe]=V[qe][Ue[qe]])},de.reverse=function(Ue,qe){var jt=i.copy(Ue);if(k(jt.teamId)&&(jt.teamId=""+jt.teamId),k(jt.type)&&(jt.type=ie[jt.type]),k(jt.level)&&(jt.level=+jt.level),k(jt.valid)&&(jt.valid=+jt.valid==1),k(jt.memberNum)&&(jt.memberNum=+jt.memberNum),k(jt.memberUpdateTime)&&(jt.memberUpdateTime=+jt.memberUpdateTime),k(jt.createTime)&&(jt.createTime=+jt.createTime),k(jt.updateTime)&&(jt.updateTime=+jt.updateTime),k(jt.validToCurrentUser)&&(jt.validToCurrentUser=jt.validToCurrentUser==="1"),k(jt.mute)&&(jt.mute=jt.mute==="1"),k(jt.muteType))switch(jt.muteType){case"0":jt.mute=!1,jt.muteType="none";break;case"1":jt.mute=!0,jt.muteType="normal";break;case"3":jt.mute=!0,jt.muteType="all"}else k(jt.mute)&&(jt.mute===1?(jt.mute=!0,jt.muteType="normal"):(jt.mute=!1,jt.muteType="none"));return g(oe).call(oe,y(Ce).call(Ce,null,jt)),delete jt.bits,qe||de.fillProperties(jt),jt},de.fillProperties=function(Ue){return L(Ue,"avatar","")},t.exports=de},function(t,r,e){t.exports=e(689)},function(t,r,e){var n=e(293),g=e(315),y=e(316);t.exports=function(i,k){var L;if(i){if(typeof i=="string")return y(i,k);var $=n(L=Object.prototype.toString.call(i)).call(L,8,-1);return $==="Object"&&i.constructor&&($=i.constructor.name),$==="Map"||$==="Set"?g(i):$==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test($)?y(i,k):void 0}},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,r,e){t.exports=e(693)},function(t,r){t.exports=function(e,n){(n==null||n>e.length)&&(n=e.length);for(var g=0,y=new Array(n);g<n;g++)y[g]=e[g];return y},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,r,e){var n=e(0).notundef;function g(y){n(y.shouldPushNotificationWhenPCOnline)&&(this.open=y.shouldPushNotificationWhenPCOnline?2:1)}g.getDefaultConfig=function(){return{shouldPushNotificationWhenPCOnline:!0}},g.reverse=function(y){return{shouldPushNotificationWhenPCOnline:+y.open!=1}},t.exports=g},function(t,r,e){var n=e(70),g=e(787),y=e(294),i=e(263),k=e(203),L=e(0),$=e(311),V=e(289),z=e(192),re=e(792),oe=e(793);t.exports=function(le){L.merge(le,{platform:n,xhr:g,io:y,naturalSort:i,deepAccess:k,util:L,support:$,blob:V,ajax:z,LoggerPlugin:re,usePlugin:oe})}},function(t,r,e){var n=e(11),g=e(10),y=e(5),i=e(110).genPrivateUrl,k=e(0),L=k.notundef,$={"-2":"unset","-1":"restricted",0:"common",1:"owner",2:"manager",3:"guest",4:"anonymous"};function V(z){L(z.nick)&&(this.nick=""+z.nick),L(z.avatar)&&(this.avatar=""+z.avatar),L(z.custom)&&(this.custom=""+z.custom)}V.reverse=function(z){var re=k.copy(z);return L(re.chatroomId)&&(re.chatroomId=""+re.chatroomId),L(re.avatar)&&(re.avatar=i(re.avatar)),L(re.type)&&(re.type=$[re.type]),L(re.level)&&(re.level=+re.level),L(re.online)&&(re.online=+re.online==1),L(re.enterTime)&&(re.enterTime=+re.enterTime),L(re.guest)&&(re.guest=+re.guest==1),L(re.blacked)&&(re.blacked=+re.blacked==1),L(re.gaged)&&(re.gaged=+re.gaged==1),L(re.valid)&&(re.valid=+re.valid==1),L(re.updateTime)&&(re.updateTime=+re.updateTime),L(re.tempMuted)?re.tempMuted=+re.tempMuted==1:re.tempMuted=!1,L(re.tempMuteDuration)?re.tempMuteDuration=+re.tempMuteDuration:re.tempMuteDuration=0,re.online||delete re.enterTime,re.guest&&(re.type="guest",delete re.valid),re.type!=="common"&&delete re.level,delete re.guest,re},V.reverseMembers=function(z){return n(z).call(z,function(re){return g(V).call(V,re)})},V.validTypes=y($),V.typeReverseMap=$,t.exports=V},function(t,r,e){var n,g,y,i,k,L,$,V,z,re,oe,le,ue,ie,ae,Ie,de,Ce,Ue;t.exports=(n=e(96),e(796),void(n.lib.Cipher||(g=n,y=g.lib,i=y.Base,k=y.WordArray,L=y.BufferedBlockAlgorithm,$=g.enc,$.Utf8,V=$.Base64,z=g.algo.EvpKDF,re=y.Cipher=L.extend({cfg:i.extend(),createEncryptor:function(qe,jt){return this.create(this._ENC_XFORM_MODE,qe,jt)},createDecryptor:function(qe,jt){return this.create(this._DEC_XFORM_MODE,qe,jt)},init:function(qe,jt,Fe){this.cfg=this.cfg.extend(Fe),this._xformMode=qe,this._key=jt,this.reset()},reset:function(){L.reset.call(this),this._doReset()},process:function(qe){return this._append(qe),this._process()},finalize:function(qe){return qe&&this._append(qe),this._doFinalize()},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(){function qe(jt){return typeof jt=="string"?Ue:de}return function(jt){return{encrypt:function(Fe,Et,cr){return qe(Et).encrypt(jt,Fe,Et,cr)},decrypt:function(Fe,Et,cr){return qe(Et).decrypt(jt,Fe,Et,cr)}}}}()}),y.StreamCipher=re.extend({_doFinalize:function(){return this._process(!0)},blockSize:1}),oe=g.mode={},le=y.BlockCipherMode=i.extend({createEncryptor:function(qe,jt){return this.Encryptor.create(qe,jt)},createDecryptor:function(qe,jt){return this.Decryptor.create(qe,jt)},init:function(qe,jt){this._cipher=qe,this._iv=jt}}),ue=oe.CBC=function(){var qe=le.extend();function jt(Fe,Et,cr){var er,nr=this._iv;nr?(er=nr,this._iv=void 0):er=this._prevBlock;for(var dr=0;dr<cr;dr++)Fe[Et+dr]^=er[dr]}return qe.Encryptor=qe.extend({processBlock:function(Fe,Et){var cr=this._cipher,er=cr.blockSize;jt.call(this,Fe,Et,er),cr.encryptBlock(Fe,Et),this._prevBlock=Fe.slice(Et,Et+er)}}),qe.Decryptor=qe.extend({processBlock:function(Fe,Et){var cr=this._cipher,er=cr.blockSize,nr=Fe.slice(Et,Et+er);cr.decryptBlock(Fe,Et),jt.call(this,Fe,Et,er),this._prevBlock=nr}}),qe}(),ie=(g.pad={}).Pkcs7={pad:function(qe,jt){for(var Fe=4*jt,Et=Fe-qe.sigBytes%Fe,cr=Et<<24|Et<<16|Et<<8|Et,er=[],nr=0;nr<Et;nr+=4)er.push(cr);var dr=k.create(er,Et);qe.concat(dr)},unpad:function(qe){var jt=255&qe.words[qe.sigBytes-1>>>2];qe.sigBytes-=jt}},y.BlockCipher=re.extend({cfg:re.cfg.extend({mode:ue,padding:ie}),reset:function(){var qe;re.reset.call(this);var jt=this.cfg,Fe=jt.iv,Et=jt.mode;this._xformMode==this._ENC_XFORM_MODE?qe=Et.createEncryptor:(qe=Et.createDecryptor,this._minBufferSize=1),this._mode&&this._mode.__creator==qe?this._mode.init(this,Fe&&Fe.words):(this._mode=qe.call(Et,this,Fe&&Fe.words),this._mode.__creator=qe)},_doProcessBlock:function(qe,jt){this._mode.processBlock(qe,jt)},_doFinalize:function(){var qe,jt=this.cfg.padding;return this._xformMode==this._ENC_XFORM_MODE?(jt.pad(this._data,this.blockSize),qe=this._process(!0)):(qe=this._process(!0),jt.unpad(qe)),qe},blockSize:4}),ae=y.CipherParams=i.extend({init:function(qe){this.mixIn(qe)},toString:function(qe){return(qe||this.formatter).stringify(this)}}),Ie=(g.format={}).OpenSSL={stringify:function(qe){var jt=qe.ciphertext,Fe=qe.salt;return(Fe?k.create([1398893684,1701076831]).concat(Fe).concat(jt):jt).toString(V)},parse:function(qe){var jt,Fe=V.parse(qe),Et=Fe.words;return Et[0]==1398893684&&Et[1]==1701076831&&(jt=k.create(Et.slice(2,4)),Et.splice(0,4),Fe.sigBytes-=16),ae.create({ciphertext:Fe,salt:jt})}},de=y.SerializableCipher=i.extend({cfg:i.extend({format:Ie}),encrypt:function(qe,jt,Fe,Et){Et=this.cfg.extend(Et);var cr=qe.createEncryptor(Fe,Et),er=cr.finalize(jt),nr=cr.cfg;return ae.create({ciphertext:er,key:Fe,iv:nr.iv,algorithm:qe,mode:nr.mode,padding:nr.padding,blockSize:qe.blockSize,formatter:Et.format})},decrypt:function(qe,jt,Fe,Et){return Et=this.cfg.extend(Et),jt=this._parse(jt,Et.format),qe.createDecryptor(Fe,Et).finalize(jt.ciphertext)},_parse:function(qe,jt){return typeof qe=="string"?jt.parse(qe,this):qe}}),Ce=(g.kdf={}).OpenSSL={execute:function(qe,jt,Fe,Et){Et||(Et=k.random(8));var cr=z.create({keySize:jt+Fe}).compute(qe,Et),er=k.create(cr.words.slice(jt),4*Fe);return cr.sigBytes=4*jt,ae.create({key:cr,iv:er,salt:Et})}},Ue=y.PasswordBasedCipher=de.extend({cfg:de.cfg.extend({kdf:Ce}),encrypt:function(qe,jt,Fe,Et){var cr=(Et=this.cfg.extend(Et)).kdf.execute(Fe,qe.keySize,qe.ivSize);Et.iv=cr.iv;var er=de.encrypt.call(this,qe,jt,cr.key,Et);return er.mixIn(cr),er},decrypt:function(qe,jt,Fe,Et){Et=this.cfg.extend(Et),jt=this._parse(jt,Et.format);var cr=Et.kdf.execute(Fe,qe.keySize,qe.ivSize,jt.salt);return Et.iv=cr.iv,de.decrypt.call(this,qe,jt,cr.key,Et)}}))))},function(t,r,e){t.exports=e(288)},function(t,r,e){var n=e(18),g=e(323),y=Array.prototype;t.exports=function(i){var k=i.indexOf;return i===y||n(y,i)&&k===y.indexOf?g:k}},function(t,r,e){e(324);var n=e(27);t.exports=n("Array").indexOf},function(t,r,e){var n=e(1),g=e(166),y=e(170).indexOf,i=e(86),k=g([].indexOf),L=!!k&&1/k([1],1,-0)<0,$=i("indexOf");n({target:"Array",proto:!0,forced:L||!$},{indexOf:function(V){var z=arguments.length>1?arguments[1]:void 0;return L?k(this,V,z)||0:y(this,V,z)}})},function(t,r,e){var n=e(20),g=e(30),y=e(131),i=e(167),k=e(326),L=e(21),$=TypeError,V=L("toPrimitive");t.exports=function(z,re){if(!g(z)||y(z))return z;var oe,le=i(z,V);if(le){if(re===void 0&&(re="default"),oe=n(le,z,re),!g(oe)||y(oe))return oe;throw $("Can't convert object to primitive value")}return re===void 0&&(re="number"),k(z,re)}},function(t,r,e){var n=e(20),g=e(17),y=e(30),i=TypeError;t.exports=function(k,L){var $,V;if(L==="string"&&g($=k.toString)&&!y(V=n($,k))||g($=k.valueOf)&&!y(V=n($,k))||L!=="string"&&g($=k.toString)&&!y(V=n($,k)))return V;throw i("Can't convert object to primitive value")}},function(t,r,e){var n=e(16),g=Object.defineProperty;t.exports=function(y,i){try{g(n,y,{value:i,configurable:!0,writable:!0})}catch{n[y]=i}return i}},function(t,r){var e=Math.ceil,n=Math.floor;t.exports=Math.trunc||function(g){var y=+g;return(y>0?n:e)(y)}},function(t,r,e){var n=e(115),g=Math.min;t.exports=function(y){return y>0?g(n(y),9007199254740991):0}},function(t,r,e){var n=e(331);t.exports=n},function(t,r,e){var n=e(18),g=e(332),y=Array.prototype;t.exports=function(i){var k=i.concat;return i===y||n(y,i)&&k===y.concat?g:k}},function(t,r,e){e(217);var n=e(27);t.exports=n("Array").concat},function(t,r,e){var n=e(87),g=e(133),y=e(30),i=e(21)("species"),k=Array;t.exports=function(L){var $;return n(L)&&($=L.constructor,(g($)&&($===k||n($.prototype))||y($)&&($=$[i])===null)&&($=void 0)),$===void 0?k:$}},function(t,r,e){e(335);var n=e(14).Object;t.exports=function(g,y){return n.create(g,y)}},function(t,r,e){e(1)({target:"Object",stat:!0,sham:!e(29)},{create:e(88)})},function(t,r,e){t.exports=e(337)},function(t,r,e){var n=e(338);e(365),e(366),e(367),e(368),e(369),e(370),e(371),t.exports=n},function(t,r,e){var n=e(223);e(364),t.exports=n},function(t,r,e){e(217),e(102),e(224),e(346),e(347),e(348),e(349),e(229),e(350),e(351),e(352),e(353),e(354),e(355),e(230),e(356),e(357),e(358),e(359),e(360);var n=e(14);t.exports=n.Symbol},function(t,r,e){var n=e(1),g=e(16),y=e(20),i=e(13),k=e(57),L=e(29),$=e(99),V=e(7),z=e(31),re=e(18),oe=e(38),le=e(47),ue=e(130),ie=e(58),ae=e(84),Ie=e(88),de=e(124),Ce=e(135),Ue=e(175),qe=e(136),jt=e(97),Fe=e(40),Et=e(173),cr=e(157),er=e(74),nr=e(113),dr=e(134),ir=e(117),tr=e(132),ur=e(21),or=e(137),fr=e(25),lr=e(226),gr=e(89),Sr=e(103),wr=e(69).forEach,kr=dr("hidden"),mr=Sr.set,Ir=Sr.getterFor("Symbol"),Nr=Object.prototype,Er=g.Symbol,sr=Er&&Er.prototype,xr=g.TypeError,Or=g.QObject,Mr=jt.f,br=Fe.f,hr=Ue.f,Tr=cr.f,Br=i([].push),Fr=nr("symbols"),Lr=nr("op-symbols"),qr=nr("wks"),Ur=!Or||!Or.prototype||!Or.prototype.findChild,Qr=L&&V(function(){return Ie(br({},"a",{get:function(){return br(this,"a",{value:7}).a}})).a!=7})?function(Mn,Bn,wn){var In=Mr(Nr,Bn);In&&delete Nr[Bn],br(Mn,Bn,wn),In&&Mn!==Nr&&br(Nr,Bn,In)}:br,vn=function(Mn,Bn){var wn=Fr[Mn]=Ie(sr);return mr(wn,{type:"Symbol",tag:Mn,description:Bn}),L||(wn.description=Bn),wn},_n=function(Mn,Bn,wn){Mn===Nr&&_n(Lr,Bn,wn),oe(Mn);var In=ue(Bn);return oe(wn),z(Fr,In)?(wn.enumerable?(z(Mn,kr)&&Mn[kr][In]&&(Mn[kr][In]=!1),wn=Ie(wn,{enumerable:ae(0,!1)})):(z(Mn,kr)||br(Mn,kr,ae(1,{})),Mn[kr][In]=!0),Qr(Mn,In,wn)):br(Mn,In,wn)},Yr=function(Mn,Bn){oe(Mn);var wn=le(Bn),In=de(wn).concat(Jr(wn));return wr(In,function(bn){L&&!y(jn,wn,bn)||_n(Mn,bn,wn[bn])}),Mn},jn=function(Mn){var Bn=ue(Mn),wn=y(Tr,this,Bn);return!(this===Nr&&z(Fr,Bn)&&!z(Lr,Bn))&&(!(wn||!z(this,Bn)||!z(Fr,Bn)||z(this,kr)&&this[kr][Bn])||wn)},Zr=function(Mn,Bn){var wn=le(Mn),In=ue(Bn);if(wn!==Nr||!z(Fr,In)||z(Lr,In)){var bn=Mr(wn,In);return!bn||!z(Fr,In)||z(wn,kr)&&wn[kr][In]||(bn.enumerable=!0),bn}},An=function(Mn){var Bn=hr(le(Mn)),wn=[];return wr(Bn,function(In){z(Fr,In)||z(ir,In)||Br(wn,In)}),wn},Jr=function(Mn){var Bn=Mn===Nr,wn=hr(Bn?Lr:le(Mn)),In=[];return wr(wn,function(bn){!z(Fr,bn)||Bn&&!z(Nr,bn)||Br(In,Fr[bn])}),In};$||(er(sr=(Er=function(){if(re(sr,this))throw xr("Symbol is not a constructor");var Mn=arguments.length&&arguments[0]!==void 0?ie(arguments[0]):void 0,Bn=tr(Mn),wn=function(In){this===Nr&&y(wn,Lr,In),z(this,kr)&&z(this[kr],Bn)&&(this[kr][Bn]=!1),Qr(this,Bn,ae(1,In))};return L&&Ur&&Qr(Nr,Bn,{configurable:!0,set:wn}),vn(Bn,Mn)}).prototype,"toString",function(){return Ir(this).tag}),er(Er,"withoutSetter",function(Mn){return vn(tr(Mn),Mn)}),cr.f=jn,Fe.f=_n,Et.f=Yr,jt.f=Zr,Ce.f=Ue.f=An,qe.f=Jr,or.f=function(Mn){return vn(ur(Mn),Mn)},L&&(br(sr,"description",{configurable:!0,get:function(){return Ir(this).description}}),k||er(Nr,"propertyIsEnumerable",jn,{unsafe:!0}))),n({global:!0,constructor:!0,wrap:!0,forced:!$,sham:!$},{Symbol:Er}),wr(de(qr),function(Mn){fr(Mn)}),n({target:"Symbol",stat:!0,forced:!$},{useSetter:function(){Ur=!0},useSimple:function(){Ur=!1}}),n({target:"Object",stat:!0,forced:!$,sham:!L},{create:function(Mn,Bn){return Bn===void 0?Ie(Mn):Yr(Ie(Mn),Bn)},defineProperty:_n,defineProperties:Yr,getOwnPropertyDescriptor:Zr}),n({target:"Object",stat:!0,forced:!$},{getOwnPropertyNames:An}),lr(),gr(Er,"Symbol"),ir[kr]=!0},function(t,r,e){var n=e(172),g=e(73);t.exports=n?{}.toString:function(){return"[object "+g(this)+"]"}},function(t,r,e){var n=e(16),g=e(17),y=n.WeakMap;t.exports=g(y)&&/native code/.test(String(y))},function(t,r,e){var n=e(1),g=e(33),y=e(31),i=e(58),k=e(113),L=e(227),$=k("string-to-symbol-registry"),V=k("symbol-to-string-registry");n({target:"Symbol",stat:!0,forced:!L},{for:function(z){var re=i(z);if(y($,re))return $[re];var oe=g("Symbol")(re);return $[re]=oe,V[oe]=re,oe}})},function(t,r,e){var n=e(1),g=e(31),y=e(131),i=e(85),k=e(113),L=e(227),$=k("symbol-to-string-registry");n({target:"Symbol",stat:!0,forced:!L},{keyFor:function(V){if(!y(V))throw TypeError(i(V)+" is not a symbol");if(g($,V))return $[V]}})},function(t,r,e){var n=e(1),g=e(99),y=e(7),i=e(136),k=e(46);n({target:"Object",stat:!0,forced:!g||y(function(){i.f(1)})},{getOwnPropertySymbols:function(L){var $=i.f;return $?$(k(L)):[]}})},function(t,r,e){e(25)("asyncIterator")},function(t,r){},function(t,r,e){e(25)("hasInstance")},function(t,r,e){e(25)("isConcatSpreadable")},function(t,r,e){e(25)("match")},function(t,r,e){e(25)("matchAll")},function(t,r,e){e(25)("replace")},function(t,r,e){e(25)("search")},function(t,r,e){e(25)("species")},function(t,r,e){e(25)("split")},function(t,r,e){var n=e(33),g=e(25),y=e(89);g("toStringTag"),y(n("Symbol"),"Symbol")},function(t,r,e){e(25)("unscopables")},function(t,r,e){var n=e(16);e(89)(n.JSON,"JSON",!0)},function(t,r){},function(t,r){},function(t,r,e){var n=e(232).IteratorPrototype,g=e(88),y=e(84),i=e(89),k=e(105),L=function(){return this};t.exports=function($,V,z,re){var oe=V+" Iterator";return $.prototype=g(n,{next:y(+!re,z)}),i($,oe,!1,!0),k[oe]=L,$}},function(t,r,e){var n=e(17),g=String,y=TypeError;t.exports=function(i){if(typeof i=="object"||n(i))return i;throw y("Can't set "+g(i)+" as a prototype")}},function(t,r){t.exports={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}},function(t,r,e){e(25)("dispose")},function(t,r,e){e(25)("asyncDispose")},function(t,r,e){e(25)("matcher")},function(t,r,e){e(25)("metadataKey")},function(t,r,e){e(25)("observable")},function(t,r,e){e(25)("metadata")},function(t,r,e){e(25)("patternMatch")},function(t,r,e){e(25)("replaceAll")},function(t,r,e){t.exports=e(373)},function(t,r,e){t.exports=e(374)},function(t,r,e){var n=e(375);t.exports=n},function(t,r,e){var n=e(376);t.exports=n},function(t,r,e){var n=e(377);e(75),t.exports=n},function(t,r,e){e(90),e(102),e(118),e(229);var n=e(137);t.exports=n.f("iterator")},function(t,r,e){e(379);var n=e(14);t.exports=n.Array.isArray},function(t,r,e){e(1)({target:"Array",stat:!0},{isArray:e(87)})},function(t,r,e){var n=e(381);t.exports=n},function(t,r,e){e(382);var n=e(27);t.exports=n("Array").forEach},function(t,r,e){var n=e(1),g=e(383);n({target:"Array",proto:!0,forced:[].forEach!=g},{forEach:g})},function(t,r,e){var n=e(69).forEach,g=e(86)("forEach");t.exports=g?[].forEach:function(y){return n(this,y,arguments.length>1?arguments[1]:void 0)}},function(t,r,e){t.exports=e(385)},function(t,r,e){var n=e(386);t.exports=n},function(t,r,e){e(387);var n=e(14).Object;t.exports=function(g){return n.getOwnPropertyNames(g)}},function(t,r,e){var n=e(1),g=e(7),y=e(175).f;n({target:"Object",stat:!0,forced:g(function(){return!Object.getOwnPropertyNames(1)})},{getOwnPropertyNames:y})},function(t,r,e){e(389);var n=e(14);t.exports=n.Object.keys},function(t,r,e){var n=e(1),g=e(46),y=e(124);n({target:"Object",stat:!0,forced:e(7)(function(){y(1)})},{keys:function(i){return y(g(i))}})},function(t,r,e){var n=e(391);t.exports=n},function(t,r,e){e(228);var n=e(14),g=e(83);n.JSON||(n.JSON={stringify:JSON.stringify}),t.exports=function(y,i,k){return g(n.JSON.stringify,null,arguments)}},function(t,r,e){e(239),e(90),e(102),e(399),e(253),e(254),e(412),e(118);var n=e(14);t.exports=n.Promise},function(t,r,e){var n=e(1),g=e(18),y=e(138),i=e(139),k=e(394),L=e(88),$=e(65),V=e(84),z=e(395),re=e(396),oe=e(50),le=e(397),ue=e(21),ie=e(398),ae=ue("toStringTag"),Ie=Error,de=[].push,Ce=function(qe,jt){var Fe,Et=arguments.length>2?arguments[2]:void 0,cr=g(Ue,this);i?Fe=i(Ie(),cr?y(this):Ue):(Fe=cr?this:L(Ue),$(Fe,ae,"Error")),jt!==void 0&&$(Fe,"message",le(jt)),ie&&$(Fe,"stack",z(Fe.stack,1)),re(Fe,Et);var er=[];return oe(qe,de,{that:er}),$(Fe,"errors",er),Fe};i?i(Ce,Ie):k(Ce,Ie,{name:!0});var Ue=Ce.prototype=L(Ie.prototype,{constructor:V(1,Ce),message:V(1,""),name:V(1,"AggregateError")});n({global:!0,constructor:!0,arity:2},{AggregateError:Ce})},function(t,r,e){var n=e(31),g=e(240),y=e(97),i=e(40);t.exports=function(k,L,$){for(var V=g(L),z=i.f,re=y.f,oe=0;oe<V.length;oe++){var le=V[oe];n(k,le)||$&&n($,le)||z(k,le,re(L,le))}}},function(t,r,e){var n=e(13),g=Error,y=n("".replace),i=String(g("zxcasd").stack),k=/\n\s*at [^:]*:[^\n]*/,L=k.test(i);t.exports=function($,V){if(L&&typeof $=="string"&&!g.prepareStackTrace)for(;V--;)$=y($,k,"");return $}},function(t,r,e){var n=e(30),g=e(65);t.exports=function(y,i){n(i)&&"cause"in i&&g(y,"cause",i.cause)}},function(t,r,e){var n=e(58);t.exports=function(g,y){return g===void 0?arguments.length<2?"":y:n(g)}},function(t,r,e){var n=e(7),g=e(84);t.exports=!n(function(){var y=Error("a");return!("stack"in y)||(Object.defineProperty(y,"stack",g(1,7)),y.stack!==7)})},function(t,r,e){e(400),e(407),e(408),e(409),e(410),e(411)},function(t,r,e){var n,g,y,i=e(1),k=e(57),L=e(119),$=e(16),V=e(20),z=e(74),re=e(139),oe=e(89),le=e(244),ue=e(32),ie=e(17),ae=e(30),Ie=e(178),de=e(245),Ce=e(246).set,Ue=e(401),qe=e(404),jt=e(106),Fe=e(405),Et=e(103),cr=e(107),er=e(120),nr=e(76),dr=er.CONSTRUCTOR,ir=er.REJECTION_EVENT,tr=er.SUBCLASSING,ur=Et.getterFor("Promise"),or=Et.set,fr=cr&&cr.prototype,lr=cr,gr=fr,Sr=$.TypeError,wr=$.document,kr=$.process,mr=nr.f,Ir=mr,Nr=!!(wr&&wr.createEvent&&$.dispatchEvent),Er=function(Lr){var qr;return!(!ae(Lr)||!ie(qr=Lr.then))&&qr},sr=function(Lr,qr){var Ur,Qr,vn,_n=qr.value,Yr=qr.state==1,jn=Yr?Lr.ok:Lr.fail,Zr=Lr.resolve,An=Lr.reject,Jr=Lr.domain;try{jn?(Yr||(qr.rejection===2&&hr(qr),qr.rejection=1),jn===!0?Ur=_n:(Jr&&Jr.enter(),Ur=jn(_n),Jr&&(Jr.exit(),vn=!0)),Ur===Lr.promise?An(Sr("Promise-chain cycle")):(Qr=Er(Ur))?V(Qr,Ur,Zr,An):Zr(Ur)):An(_n)}catch(Mn){Jr&&!vn&&Jr.exit(),An(Mn)}},xr=function(Lr,qr){Lr.notified||(Lr.notified=!0,Ue(function(){for(var Ur,Qr=Lr.reactions;Ur=Qr.get();)sr(Ur,Lr);Lr.notified=!1,qr&&!Lr.rejection&&Mr(Lr)}))},Or=function(Lr,qr,Ur){var Qr,vn;Nr?((Qr=wr.createEvent("Event")).promise=qr,Qr.reason=Ur,Qr.initEvent(Lr,!1,!0),$.dispatchEvent(Qr)):Qr={promise:qr,reason:Ur},!ir&&(vn=$["on"+Lr])?vn(Qr):Lr==="unhandledrejection"&&qe("Unhandled promise rejection",Ur)},Mr=function(Lr){V(Ce,$,function(){var qr,Ur=Lr.facade,Qr=Lr.value;if(br(Lr)&&(qr=jt(function(){L?kr.emit("unhandledRejection",Qr,Ur):Or("unhandledrejection",Ur,Qr)}),Lr.rejection=L||br(Lr)?2:1,qr.error))throw qr.value})},br=function(Lr){return Lr.rejection!==1&&!Lr.parent},hr=function(Lr){V(Ce,$,function(){var qr=Lr.facade;L?kr.emit("rejectionHandled",qr):Or("rejectionhandled",qr,Lr.value)})},Tr=function(Lr,qr,Ur){return function(Qr){Lr(qr,Qr,Ur)}},Br=function(Lr,qr,Ur){Lr.done||(Lr.done=!0,Ur&&(Lr=Ur),Lr.value=qr,Lr.state=2,xr(Lr,!0))},Fr=function(Lr,qr,Ur){if(!Lr.done){Lr.done=!0,Ur&&(Lr=Ur);try{if(Lr.facade===qr)throw Sr("Promise can't be resolved itself");var Qr=Er(qr);Qr?Ue(function(){var vn={done:!1};try{V(Qr,qr,Tr(Fr,vn,Lr),Tr(Br,vn,Lr))}catch(_n){Br(vn,_n,Lr)}}):(Lr.value=qr,Lr.state=1,xr(Lr,!1))}catch(vn){Br({done:!1},vn,Lr)}}};if(dr&&(gr=(lr=function(Lr){Ie(this,gr),ue(Lr),V(n,this);var qr=ur(this);try{Lr(Tr(Fr,qr),Tr(Br,qr))}catch(Ur){Br(qr,Ur)}}).prototype,(n=function(Lr){or(this,{type:"Promise",done:!1,notified:!1,parent:!1,reactions:new Fe,rejection:!1,state:0,value:void 0})}).prototype=z(gr,"then",function(Lr,qr){var Ur=ur(this),Qr=mr(de(this,lr));return Ur.parent=!0,Qr.ok=!ie(Lr)||Lr,Qr.fail=ie(qr)&&qr,Qr.domain=L?kr.domain:void 0,Ur.state==0?Ur.reactions.add(Qr):Ue(function(){sr(Qr,Ur)}),Qr.promise}),g=function(){var Lr=new n,qr=ur(Lr);this.promise=Lr,this.resolve=Tr(Fr,qr),this.reject=Tr(Br,qr)},nr.f=mr=function(Lr){return Lr===lr||Lr===void 0?new g(Lr):Ir(Lr)},!k&&ie(cr)&&fr!==Object.prototype)){y=fr.then,tr||z(fr,"then",function(Lr,qr){var Ur=this;return new lr(function(Qr,vn){V(y,Ur,Qr,vn)}).then(Lr,qr)},{unsafe:!0});try{delete fr.constructor}catch{}re&&re(fr,gr)}i({global:!0,constructor:!0,wrap:!0,forced:dr},{Promise:lr}),oe(lr,"Promise",!1,!0),le("Promise")},function(t,r,e){var n,g,y,i,k,L,$,V,z=e(16),re=e(36),oe=e(97).f,le=e(246).set,ue=e(248),ie=e(402),ae=e(403),Ie=e(119),de=z.MutationObserver||z.WebKitMutationObserver,Ce=z.document,Ue=z.process,qe=z.Promise,jt=oe(z,"queueMicrotask"),Fe=jt&&jt.value;Fe||(n=function(){var Et,cr;for(Ie&&(Et=Ue.domain)&&Et.exit();g;){cr=g.fn,g=g.next;try{cr()}catch(er){throw g?i():y=void 0,er}}y=void 0,Et&&Et.enter()},ue||Ie||ae||!de||!Ce?!ie&&qe&&qe.resolve?(($=qe.resolve(void 0)).constructor=qe,V=re($.then,$),i=function(){V(n)}):Ie?i=function(){Ue.nextTick(n)}:(le=re(le,z),i=function(){le(n)}):(k=!0,L=Ce.createTextNode(""),new de(n).observe(L,{characterData:!0}),i=function(){L.data=k=!k})),t.exports=Fe||function(Et){var cr={fn:Et,next:void 0};y&&(y.next=cr),g||(g=cr,i()),y=cr}},function(t,r,e){var n=e(72),g=e(16);t.exports=/ipad|iphone|ipod/i.test(n)&&g.Pebble!==void 0},function(t,r,e){var n=e(72);t.exports=/web0s(?!.*chrome)/i.test(n)},function(t,r,e){var n=e(16);t.exports=function(g,y){var i=n.console;i&&i.error&&(arguments.length==1?i.error(g):i.error(g,y))}},function(t,r){var e=function(){this.head=null,this.tail=null};e.prototype={add:function(n){var g={item:n,next:null};this.head?this.tail.next=g:this.head=g,this.tail=g},get:function(){var n=this.head;if(n)return this.head=n.next,this.tail===n&&(this.tail=null),n.item}},t.exports=e},function(t,r,e){var n=e(249),g=e(119);t.exports=!n&&!g&&typeof window=="object"&&typeof document=="object"},function(t,r,e){var n=e(1),g=e(20),y=e(32),i=e(76),k=e(106),L=e(50);n({target:"Promise",stat:!0,forced:e(250)},{all:function($){var V=this,z=i.f(V),re=z.resolve,oe=z.reject,le=k(function(){var ue=y(V.resolve),ie=[],ae=0,Ie=1;L($,function(de){var Ce=ae++,Ue=!1;Ie++,g(ue,V,de).then(function(qe){Ue||(Ue=!0,ie[Ce]=qe,--Ie||re(ie))},oe)}),--Ie||re(ie)});return le.error&&oe(le.value),z.promise}})},function(t,r,e){var n=e(1),g=e(57),y=e(120).CONSTRUCTOR,i=e(107),k=e(33),L=e(17),$=e(74),V=i&&i.prototype;if(n({target:"Promise",proto:!0,forced:y,real:!0},{catch:function(re){return this.then(void 0,re)}}),!g&&L(i)){var z=k("Promise").prototype.catch;V.catch!==z&&$(V,"catch",z,{unsafe:!0})}},function(t,r,e){var n=e(1),g=e(20),y=e(32),i=e(76),k=e(106),L=e(50);n({target:"Promise",stat:!0,forced:e(250)},{race:function($){var V=this,z=i.f(V),re=z.reject,oe=k(function(){var le=y(V.resolve);L($,function(ue){g(le,V,ue).then(z.resolve,re)})});return oe.error&&re(oe.value),z.promise}})},function(t,r,e){var n=e(1),g=e(20),y=e(76);n({target:"Promise",stat:!0,forced:e(120).CONSTRUCTOR},{reject:function(i){var k=y.f(this);return g(k.reject,void 0,i),k.promise}})},function(t,r,e){var n=e(1),g=e(33),y=e(57),i=e(107),k=e(120).CONSTRUCTOR,L=e(252),$=g("Promise"),V=y&&!k;n({target:"Promise",stat:!0,forced:y||k},{resolve:function(z){return L(V&&this===$?i:this,z)}})},function(t,r,e){var n=e(1),g=e(57),y=e(107),i=e(7),k=e(33),L=e(17),$=e(245),V=e(252),z=e(74),re=y&&y.prototype;if(n({target:"Promise",proto:!0,real:!0,forced:!!y&&i(function(){re.finally.call({then:function(){}},function(){})})},{finally:function(le){var ue=$(this,k("Promise")),ie=L(le);return this.then(ie?function(ae){return V(ue,le()).then(function(){return ae})}:le,ie?function(ae){return V(ue,le()).then(function(){throw ae})}:le)}}),!g&&L(y)){var oe=k("Promise").prototype.finally;re.finally!==oe&&z(re,"finally",oe,{unsafe:!0})}},function(t,r,e){t.exports=e(414)},function(t,r,e){var n=e(415);t.exports=n},function(t,r,e){var n=e(255);t.exports=n},function(t,r,e){e(417);var n=e(14).Object,g=t.exports=function(y,i,k){return n.defineProperty(y,i,k)};n.defineProperty.sham&&(g.sham=!0)},function(t,r,e){var n=e(1),g=e(29),y=e(40).f;n({target:"Object",stat:!0,forced:Object.defineProperty!==y,sham:!g},{defineProperty:y})},function(t,r,e){var n=e(419),g=e(24).default;t.exports=function(y,i){if(g(y)!=="object"||y===null)return y;var k=y[n];if(k!==void 0){var L=k.call(y,i||"default");if(g(L)!=="object")return L;throw new TypeError("@@toPrimitive must return a primitive value.")}return(i==="string"?String:Number)(y)},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,r,e){t.exports=e(420)},function(t,r,e){t.exports=e(421)},function(t,r,e){var n=e(422);t.exports=n},function(t,r,e){var n=e(423);t.exports=n},function(t,r,e){var n=e(424);t.exports=n},function(t,r,e){e(425),e(230);var n=e(137);t.exports=n.f("toPrimitive")},function(t,r){},function(t,r,e){var n=e(18),g=e(427),y=Array.prototype;t.exports=function(i){var k=i.slice;return i===y||n(y,i)&&k===y.slice?g:k}},function(t,r,e){e(428);var n=e(27);t.exports=n("Array").slice},function(t,r,e){var n=e(1),g=e(87),y=e(133),i=e(30),k=e(114),L=e(49),$=e(47),V=e(101),z=e(21),re=e(116),oe=e(104),le=re("slice"),ue=z("species"),ie=Array,ae=Math.max;n({target:"Array",proto:!0,forced:!le},{slice:function(Ie,de){var Ce,Ue,qe,jt=$(this),Fe=L(jt),Et=k(Ie,Fe),cr=k(de===void 0?Fe:de,Fe);if(g(jt)&&(Ce=jt.constructor,(y(Ce)&&(Ce===ie||g(Ce.prototype))||i(Ce)&&(Ce=Ce[ue])===null)&&(Ce=void 0),Ce===ie||Ce===void 0))return oe(jt,Et,cr);for(Ue=new(Ce===void 0?ie:Ce)(ae(cr-Et,0)),qe=0;Et<cr;Et++,qe++)Et in jt&&V(Ue,qe,jt[Et]);return Ue.length=qe,Ue}})},function(t,r,e){var n=e(430);t.exports=n},function(t,r,e){var n=e(18),g=e(431),y=Array.prototype;t.exports=function(i){var k=i.some;return i===y||n(y,i)&&k===y.some?g:k}},function(t,r,e){e(432);var n=e(27);t.exports=n("Array").some},function(t,r,e){var n=e(1),g=e(69).some;n({target:"Array",proto:!0,forced:!e(86)("some")},{some:function(y){return g(this,y,arguments.length>1?arguments[1]:void 0)}})},function(t,r,e){var n=e(434);t.exports=n},function(t,r,e){var n=e(18),g=e(435),y=Array.prototype;t.exports=function(i){var k=i.splice;return i===y||n(y,i)&&k===y.splice?g:k}},function(t,r,e){e(436);var n=e(27);t.exports=n("Array").splice},function(t,r,e){var n=e(1),g=e(46),y=e(114),i=e(115),k=e(49),L=e(437),$=e(218),V=e(171),z=e(101),re=e(258),oe=e(116)("splice"),le=Math.max,ue=Math.min;n({target:"Array",proto:!0,forced:!oe},{splice:function(ie,ae){var Ie,de,Ce,Ue,qe,jt,Fe=g(this),Et=k(Fe),cr=y(ie,Et),er=arguments.length;for(er===0?Ie=de=0:er===1?(Ie=0,de=Et-cr):(Ie=er-2,de=ue(le(i(ae),0),Et-cr)),$(Et+Ie-de),Ce=V(Fe,de),Ue=0;Ue<de;Ue++)(qe=cr+Ue)in Fe&&z(Ce,Ue,Fe[qe]);if(Ce.length=de,Ie<de){for(Ue=cr;Ue<Et-de;Ue++)jt=Ue+Ie,(qe=Ue+de)in Fe?Fe[jt]=Fe[qe]:re(Fe,jt);for(Ue=Et;Ue>Et-de+Ie;Ue--)re(Fe,Ue-1)}else if(Ie>de)for(Ue=Et-de;Ue>cr;Ue--)jt=Ue+Ie-1,(qe=Ue+de-1)in Fe?Fe[jt]=Fe[qe]:re(Fe,jt);for(Ue=0;Ue<Ie;Ue++)Fe[Ue+cr]=arguments[Ue+2];return L(Fe,Et-de+Ie),Ce}})},function(t,r,e){var n=e(29),g=e(87),y=TypeError,i=Object.getOwnPropertyDescriptor,k=n&&!function(){if(this!==void 0)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(L){return L instanceof TypeError}}();t.exports=k?function(L,$){if(g(L)&&!i(L,"length").writable)throw y("Cannot set read only .length");return L.length=$}:function(L,$){return L.length=$}},function(t,r,e){var n=e(439);t.exports=n},function(t,r,e){var n=e(18),g=e(440),y=Array.prototype;t.exports=function(i){var k=i.sort;return i===y||n(y,i)&&k===y.sort?g:k}},function(t,r,e){e(441);var n=e(27);t.exports=n("Array").sort},function(t,r,e){var n=e(1),g=e(13),y=e(32),i=e(46),k=e(49),L=e(258),$=e(58),V=e(7),z=e(442),re=e(86),oe=e(443),le=e(444),ue=e(100),ie=e(445),ae=[],Ie=g(ae.sort),de=g(ae.push),Ce=V(function(){ae.sort(void 0)}),Ue=V(function(){ae.sort(null)}),qe=re("sort"),jt=!V(function(){if(ue)return ue<70;if(!(oe&&oe>3)){if(le)return!0;if(ie)return ie<603;var Fe,Et,cr,er,nr="";for(Fe=65;Fe<76;Fe++){switch(Et=String.fromCharCode(Fe),Fe){case 66:case 69:case 70:case 72:cr=3;break;case 68:case 71:cr=4;break;default:cr=2}for(er=0;er<47;er++)ae.push({k:Et+er,v:cr})}for(ae.sort(function(dr,ir){return ir.v-dr.v}),er=0;er<ae.length;er++)Et=ae[er].k.charAt(0),nr.charAt(nr.length-1)!==Et&&(nr+=Et);return nr!=="DGBEFHACIJK"}});n({target:"Array",proto:!0,forced:Ce||!Ue||!qe||!jt},{sort:function(Fe){Fe!==void 0&&y(Fe);var Et=i(this);if(jt)return Fe===void 0?Ie(Et):Ie(Et,Fe);var cr,er,nr=[],dr=k(Et);for(er=0;er<dr;er++)er in Et&&de(nr,Et[er]);for(z(nr,function(ir){return function(tr,ur){return ur===void 0?-1:tr===void 0?1:ir!==void 0?+ir(tr,ur)||0:$(tr)>$(ur)?1:-1}}(Fe)),cr=k(nr),er=0;er<cr;)Et[er]=nr[er++];for(;er<dr;)L(Et,er++);return Et}})},function(t,r,e){var n=e(225),g=Math.floor,y=function(L,$){var V=L.length,z=g(V/2);return V<8?i(L,$):k(L,y(n(L,0,z),$),y(n(L,z),$),$)},i=function(L,$){for(var V,z,re=L.length,oe=1;oe<re;){for(z=oe,V=L[oe];z&&$(L[z-1],V)>0;)L[z]=L[--z];z!==oe++&&(L[z]=V)}return L},k=function(L,$,V,z){for(var re=$.length,oe=V.length,le=0,ue=0;le<re||ue<oe;)L[le+ue]=le<re&&ue<oe?z($[le],V[ue])<=0?$[le++]:V[ue++]:le<re?$[le++]:V[ue++];return L};t.exports=y},function(t,r,e){var n=e(72).match(/firefox\/(\d+)/i);t.exports=!!n&&+n[1]},function(t,r,e){var n=e(72);t.exports=/MSIE|Trident/.test(n)},function(t,r,e){var n=e(72).match(/AppleWebKit\/(\d+)\./);t.exports=!!n&&+n[1]},function(t,r,e){var n=e(447);t.exports=n},function(t,r,e){var n=e(18),g=e(448),y=Array.prototype;t.exports=function(i){var k=i.map;return i===y||n(y,i)&&k===y.map?g:k}},function(t,r,e){e(449);var n=e(27);t.exports=n("Array").map},function(t,r,e){var n=e(1),g=e(69).map;n({target:"Array",proto:!0,forced:!e(116)("map")},{map:function(y){return g(this,y,arguments.length>1?arguments[1]:void 0)}})},function(t,r,e){var n=e(451);t.exports=n},function(t,r,e){var n=e(18),g=e(452),y=Array.prototype;t.exports=function(i){var k=i.reduce;return i===y||n(y,i)&&k===y.reduce?g:k}},function(t,r,e){e(453);var n=e(27);t.exports=n("Array").reduce},function(t,r,e){var n=e(1),g=e(454).left,y=e(86),i=e(100),k=e(119);n({target:"Array",proto:!0,forced:!y("reduce")||!k&&i>79&&i<83},{reduce:function(L){var $=arguments.length;return g(this,L,$,$>1?arguments[1]:void 0)}})},function(t,r,e){var n=e(32),g=e(46),y=e(129),i=e(49),k=TypeError,L=function($){return function(V,z,re,oe){n(z);var le=g(V),ue=y(le),ie=i(le),ae=$?ie-1:0,Ie=$?-1:1;if(re<2)for(;;){if(ae in ue){oe=ue[ae],ae+=Ie;break}if(ae+=Ie,$?ae<0:ie<=ae)throw k("Reduce of empty array with no initial value")}for(;$?ae>=0:ie>ae;ae+=Ie)ae in ue&&(oe=z(oe,ue[ae],ae,le));return oe}};t.exports={left:L(!1),right:L(!0)}},function(t,r,e){var n=e(456);t.exports=n},function(t,r,e){var n=e(18),g=e(457),y=Array.prototype;t.exports=function(i){var k=i.lastIndexOf;return i===y||n(y,i)&&k===y.lastIndexOf?g:k}},function(t,r,e){e(458);var n=e(27);t.exports=n("Array").lastIndexOf},function(t,r,e){var n=e(1),g=e(459);n({target:"Array",proto:!0,forced:g!==[].lastIndexOf},{lastIndexOf:g})},function(t,r,e){var n=e(83),g=e(47),y=e(115),i=e(49),k=e(86),L=Math.min,$=[].lastIndexOf,V=!!$&&1/[1].lastIndexOf(1,-0)<0,z=k("lastIndexOf"),re=V||!z;t.exports=re?function(oe){if(V)return n($,this,arguments)||0;var le=g(this),ue=i(le),ie=ue-1;for(arguments.length>1&&(ie=L(ie,y(arguments[1]))),ie<0&&(ie=ue+ie);ie>=0;ie--)if(ie in le&&le[ie]===oe)return ie||0;return-1}:$},function(t,r,e){e(259);var n=e(14);t.exports=n.setTimeout},function(t,r,e){var n=e(1),g=e(16),y=e(260)(g.setInterval,!0);n({global:!0,bind:!0,forced:g.setInterval!==y},{setInterval:y})},function(t,r){t.exports=typeof Bun=="function"&&Bun&&typeof Bun.version=="string"},function(t,r,e){var n=e(1),g=e(16),y=e(260)(g.setTimeout,!0);n({global:!0,bind:!0,forced:g.setTimeout!==y},{setTimeout:y})},function(t,r,e){var n=e(465);t.exports=n},function(t,r,e){var n=e(18),g=e(466),y=Array.prototype;t.exports=function(i){var k=i.filter;return i===y||n(y,i)&&k===y.filter?g:k}},function(t,r,e){e(467);var n=e(27);t.exports=n("Array").filter},function(t,r,e){var n=e(1),g=e(69).filter;n({target:"Array",proto:!0,forced:!e(116)("filter")},{filter:function(y){return g(this,y,arguments.length>1?arguments[1]:void 0)}})},function(t,r,e){t.exports=e(469)},function(t,r,e){e(75);var n=e(73),g=e(31),y=e(18),i=e(470),k=Array.prototype,L={DOMTokenList:!0,NodeList:!0};t.exports=function($){var V=$.values;return $===k||y(k,$)&&V===k.values||g(L,n($))?i:V}},function(t,r,e){var n=e(471);t.exports=n},function(t,r,e){e(90),e(102);var n=e(27);t.exports=n("Array").values},function(t,r,e){t.exports=e(473)},function(t,r,e){var n=e(474);t.exports=n},function(t,r,e){var n=e(18),g=e(475),y=Array.prototype;t.exports=function(i){var k=i.every;return i===y||n(y,i)&&k===y.every?g:k}},function(t,r,e){e(476);var n=e(27);t.exports=n("Array").every},function(t,r,e){var n=e(1),g=e(69).every;n({target:"Array",proto:!0,forced:!e(86)("every")},{every:function(y){return g(this,y,arguments.length>1?arguments[1]:void 0)}})},function(t,r,e){e(118),e(478);var n=e(14);t.exports=n.Array.from},function(t,r,e){var n=e(1),g=e(479);n({target:"Array",stat:!0,forced:!e(251)(function(y){Array.from(y)})},{from:g})},function(t,r,e){var n=e(36),g=e(20),y=e(46),i=e(480),k=e(241),L=e(133),$=e(49),V=e(101),z=e(242),re=e(140),oe=Array;t.exports=function(le){var ue=y(le),ie=L(this),ae=arguments.length,Ie=ae>1?arguments[1]:void 0,de=Ie!==void 0;de&&(Ie=n(Ie,ae>2?arguments[2]:void 0));var Ce,Ue,qe,jt,Fe,Et,cr=re(ue),er=0;if(!cr||this===oe&&k(cr))for(Ce=$(ue),Ue=ie?new this(Ce):oe(Ce);Ce>er;er++)Et=de?Ie(ue[er],er):ue[er],V(Ue,er,Et);else for(Fe=(jt=z(ue,cr)).next,Ue=ie?new this:[];!(qe=g(Fe,jt)).done;er++)Et=de?i(jt,Ie,[qe.value,er],!0):qe.value,V(Ue,er,Et);return Ue.length=er,Ue}},function(t,r,e){var n=e(38),g=e(243);t.exports=function(y,i,k,L){try{return L?i(n(k)[0],k[1]):i(k)}catch($){g(y,"throw",$)}}},function(t,r,e){t.exports=e(482)},function(t,r,e){var n=e(483);t.exports=n},function(t,r,e){var n=e(484);t.exports=n},function(t,r,e){var n=e(485);e(75),t.exports=n},function(t,r,e){e(90),e(118);var n=e(140);t.exports=n},function(t,r,e){e(224);var n=e(14);t.exports=n.Object.getOwnPropertySymbols},function(t,r,e){var n=e(488);t.exports=n},function(t,r,e){e(489);var n=e(14).Object,g=t.exports=function(y,i){return n.getOwnPropertyDescriptor(y,i)};n.getOwnPropertyDescriptor.sham&&(g.sham=!0)},function(t,r,e){var n=e(1),g=e(7),y=e(47),i=e(97).f,k=e(29),L=g(function(){i(1)});n({target:"Object",stat:!0,forced:!k||L,sham:!k},{getOwnPropertyDescriptor:function($,V){return i(y($),V)}})},function(t,r,e){var n=e(491);t.exports=n},function(t,r,e){e(492);var n=e(14);t.exports=n.Object.getOwnPropertyDescriptors},function(t,r,e){var n=e(1),g=e(29),y=e(240),i=e(47),k=e(97),L=e(101);n({target:"Object",stat:!0,sham:!g},{getOwnPropertyDescriptors:function($){for(var V,z,re=i($),oe=k.f,le=y(re),ue={},ie=0;le.length>ie;)(z=oe(re,V=le[ie++]))!==void 0&&L(ue,V,z);return ue}})},function(t,r,e){var n=e(494);t.exports=n},function(t,r,e){e(495);var n=e(14).Object,g=t.exports=function(y,i){return n.defineProperties(y,i)};n.defineProperties.sham&&(g.sham=!0)},function(t,r,e){var n=e(1),g=e(29),y=e(173).f;n({target:"Object",stat:!0,forced:Object.defineProperties!==y,sham:!g},{defineProperties:y})},function(t,r,e){var n=e(12);typeof window<"u"&&(window.console||n.isWeixinApp||(window.console={log:function(){},info:function(){},warn:function(){},error:function(){}}))},function(t,r,e){var n=e(498),g=e(527),y=e(268),i=e(529),k=e(538),L=e(541),$=e(542),V=e(543),z=e(545),re=e(546),oe=e(547),le=e(189),ue=e(551),ie=e(552),ae=e(558),Ie=e(183),de=e(271),Ce=e(560),Ue=e(94),qe=e(562),jt=e(182),Fe=e(187),Et={};Et["[object Arguments]"]=Et["[object Array]"]=Et["[object ArrayBuffer]"]=Et["[object DataView]"]=Et["[object Boolean]"]=Et["[object Date]"]=Et["[object Float32Array]"]=Et["[object Float64Array]"]=Et["[object Int8Array]"]=Et["[object Int16Array]"]=Et["[object Int32Array]"]=Et["[object Map]"]=Et["[object Number]"]=Et["[object Object]"]=Et["[object RegExp]"]=Et["[object Set]"]=Et["[object String]"]=Et["[object Symbol]"]=Et["[object Uint8Array]"]=Et["[object Uint8ClampedArray]"]=Et["[object Uint16Array]"]=Et["[object Uint32Array]"]=!0,Et["[object Error]"]=Et["[object Function]"]=Et["[object WeakMap]"]=!1,t.exports=function cr(er,nr,dr,ir,tr,ur){var or,fr=1&nr,lr=2&nr,gr=4&nr;if(dr&&(or=tr?dr(er,ir,tr,ur):dr(er)),or!==void 0)return or;if(!Ue(er))return er;var Sr=Ie(er);if(Sr){if(or=ue(er),!fr)return $(er,or)}else{var wr=le(er),kr=wr=="[object Function]"||wr=="[object GeneratorFunction]";if(de(er))return L(er,fr);if(wr=="[object Object]"||wr=="[object Arguments]"||kr&&!tr){if(or=lr||kr?{}:ae(er),!fr)return lr?z(er,k(or,er)):V(er,i(or,er))}else{if(!Et[wr])return tr?er:{};or=ie(er,wr,fr)}}ur||(ur=new n);var mr=ur.get(er);if(mr)return mr;ur.set(er,or),qe(er)?er.forEach(function(Nr){or.add(cr(Nr,nr,dr,Nr,er,ur))}):Ce(er)&&er.forEach(function(Nr,Er){or.set(Er,cr(Nr,nr,dr,Er,er,ur))});var Ir=Sr?void 0:(gr?lr?oe:re:lr?Fe:jt)(er);return g(Ir||er,function(Nr,Er){Ir&&(Nr=er[Er=Nr]),y(or,Er,cr(Nr,nr,dr,Er,er,ur))}),or}},function(t,r,e){var n=e(145),g=e(504),y=e(505),i=e(506),k=e(507),L=e(508);function $(V){var z=this.__data__=new n(V);this.size=z.size}$.prototype.clear=g,$.prototype.delete=y,$.prototype.get=i,$.prototype.has=k,$.prototype.set=L,t.exports=$},function(t,r){t.exports=function(){this.__data__=[],this.size=0}},function(t,r,e){var n=e(146),g=Array.prototype.splice;t.exports=function(y){var i=this.__data__,k=n(i,y);return!(k<0)&&(k==i.length-1?i.pop():g.call(i,k,1),--this.size,!0)}},function(t,r,e){var n=e(146);t.exports=function(g){var y=this.__data__,i=n(y,g);return i<0?void 0:y[i][1]}},function(t,r,e){var n=e(146);t.exports=function(g){return n(this.__data__,g)>-1}},function(t,r,e){var n=e(146);t.exports=function(g,y){var i=this.__data__,k=n(i,g);return k<0?(++this.size,i.push([g,y])):i[k][1]=y,this}},function(t,r,e){var n=e(145);t.exports=function(){this.__data__=new n,this.size=0}},function(t,r){t.exports=function(e){var n=this.__data__,g=n.delete(e);return this.size=n.size,g}},function(t,r){t.exports=function(e){return this.__data__.get(e)}},function(t,r){t.exports=function(e){return this.__data__.has(e)}},function(t,r,e){var n=e(145),g=e(180),y=e(267);t.exports=function(i,k){var L=this.__data__;if(L instanceof n){var $=L.__data__;if(!g||$.length<199)return $.push([i,k]),this.size=++L.size,this;L=this.__data__=new y($)}return L.set(i,k),this.size=L.size,this}},function(t,r,e){var n=e(264),g=e(512),y=e(94),i=e(266),k=/^\[object .+?Constructor\]$/,L=Function.prototype,$=Object.prototype,V=L.toString,z=$.hasOwnProperty,re=RegExp("^"+V.call(z).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");t.exports=function(oe){return!(!y(oe)||g(oe))&&(n(oe)?re:k).test(i(oe))}},function(t,r,e){var n=e(181),g=Object.prototype,y=g.hasOwnProperty,i=g.toString,k=n?n.toStringTag:void 0;t.exports=function(L){var $=y.call(L,k),V=L[k];try{L[k]=void 0;var z=!0}catch{}var re=i.call(L);return z&&($?L[k]=V:delete L[k]),re}},function(t,r){var e=Object.prototype.toString;t.exports=function(n){return e.call(n)}},function(t,r,e){var n,g=e(513),y=(n=/[^.]+$/.exec(g&&g.keys&&g.keys.IE_PROTO||""))?"Symbol(src)_1."+n:"";t.exports=function(i){return!!y&&y in i}},function(t,r,e){var n=e(59)["__core-js_shared__"];t.exports=n},function(t,r){t.exports=function(e,n){return e==null?void 0:e[n]}},function(t,r,e){var n=e(516),g=e(145),y=e(180);t.exports=function(){this.size=0,this.__data__={hash:new n,map:new(y||g),string:new n}}},function(t,r,e){var n=e(517),g=e(518),y=e(519),i=e(520),k=e(521);function L($){var V=-1,z=$==null?0:$.length;for(this.clear();++V<z;){var re=$[V];this.set(re[0],re[1])}}L.prototype.clear=n,L.prototype.delete=g,L.prototype.get=y,L.prototype.has=i,L.prototype.set=k,t.exports=L},function(t,r,e){var n=e(147);t.exports=function(){this.__data__=n?n(null):{},this.size=0}},function(t,r){t.exports=function(e){var n=this.has(e)&&delete this.__data__[e];return this.size-=n?1:0,n}},function(t,r,e){var n=e(147),g=Object.prototype.hasOwnProperty;t.exports=function(y){var i=this.__data__;if(n){var k=i[y];return k==="__lodash_hash_undefined__"?void 0:k}return g.call(i,y)?i[y]:void 0}},function(t,r,e){var n=e(147),g=Object.prototype.hasOwnProperty;t.exports=function(y){var i=this.__data__;return n?i[y]!==void 0:g.call(i,y)}},function(t,r,e){var n=e(147);t.exports=function(g,y){var i=this.__data__;return this.size+=this.has(g)?0:1,i[g]=n&&y===void 0?"__lodash_hash_undefined__":y,this}},function(t,r,e){var n=e(148);t.exports=function(g){var y=n(this,g).delete(g);return this.size-=y?1:0,y}},function(t,r){t.exports=function(e){var n=typeof e;return n=="string"||n=="number"||n=="symbol"||n=="boolean"?e!=="__proto__":e===null}},function(t,r,e){var n=e(148);t.exports=function(g){return n(this,g).get(g)}},function(t,r,e){var n=e(148);t.exports=function(g){return n(this,g).has(g)}},function(t,r,e){var n=e(148);t.exports=function(g,y){var i=n(this,g),k=i.size;return i.set(g,y),this.size+=i.size==k?0:1,this}},function(t,r){t.exports=function(e,n){for(var g=-1,y=e==null?0:e.length;++g<y&&n(e[g],g,e)!==!1;);return e}},function(t,r,e){var n=e(91),g=function(){try{var y=n(Object,"defineProperty");return y({},"",{}),y}catch{}}();t.exports=g},function(t,r,e){var n=e(149),g=e(182);t.exports=function(y,i){return y&&n(i,g(i),y)}},function(t,r){t.exports=function(e,n){for(var g=-1,y=Array(e);++g<e;)y[g]=n(g);return y}},function(t,r,e){var n=e(532),g=e(108),y=Object.prototype,i=y.hasOwnProperty,k=y.propertyIsEnumerable,L=n(function(){return arguments}())?n:function($){return g($)&&i.call($,"callee")&&!k.call($,"callee")};t.exports=L},function(t,r,e){var n=e(126),g=e(108);t.exports=function(y){return g(y)&&n(y)=="[object Arguments]"}},function(t,r){t.exports=function(){return!1}},function(t,r,e){var n=e(535),g=e(184),y=e(185),i=y&&y.isTypedArray,k=i?g(i):n;t.exports=k},function(t,r,e){var n=e(126),g=e(272),y=e(108),i={};i["[object Float32Array]"]=i["[object Float64Array]"]=i["[object Int8Array]"]=i["[object Int16Array]"]=i["[object Int32Array]"]=i["[object Uint8Array]"]=i["[object Uint8ClampedArray]"]=i["[object Uint16Array]"]=i["[object Uint32Array]"]=!0,i["[object Arguments]"]=i["[object Array]"]=i["[object ArrayBuffer]"]=i["[object Boolean]"]=i["[object DataView]"]=i["[object Date]"]=i["[object Error]"]=i["[object Function]"]=i["[object Map]"]=i["[object Number]"]=i["[object Object]"]=i["[object RegExp]"]=i["[object Set]"]=i["[object String]"]=i["[object WeakMap]"]=!1,t.exports=function(k){return y(k)&&g(k.length)&&!!i[n(k)]}},function(t,r,e){var n=e(186),g=e(537),y=Object.prototype.hasOwnProperty;t.exports=function(i){if(!n(i))return g(i);var k=[];for(var L in Object(i))y.call(i,L)&&L!="constructor"&&k.push(L);return k}},function(t,r,e){var n=e(273)(Object.keys,Object);t.exports=n},function(t,r,e){var n=e(149),g=e(187);t.exports=function(y,i){return y&&n(i,g(i),y)}},function(t,r,e){var n=e(94),g=e(186),y=e(540),i=Object.prototype.hasOwnProperty;t.exports=function(k){if(!n(k))return y(k);var L=g(k),$=[];for(var V in k)(V!="constructor"||!L&&i.call(k,V))&&$.push(V);return $}},function(t,r){t.exports=function(e){var n=[];if(e!=null)for(var g in Object(e))n.push(g);return n}},function(t,r,e){(function(n){var g=e(59),y=r&&!r.nodeType&&r,i=y&&typeof n=="object"&&n&&!n.nodeType&&n,k=i&&i.exports===y?g.Buffer:void 0,L=k?k.allocUnsafe:void 0;n.exports=function($,V){if(V)return $.slice();var z=$.length,re=L?L(z):new $.constructor(z);return $.copy(re),re}}).call(this,e(150)(t))},function(t,r){t.exports=function(e,n){var g=-1,y=e.length;for(n||(n=Array(y));++g<y;)n[g]=e[g];return n}},function(t,r,e){var n=e(149),g=e(188);t.exports=function(y,i){return n(y,g(y),i)}},function(t,r){t.exports=function(e,n){for(var g=-1,y=e==null?0:e.length,i=0,k=[];++g<y;){var L=e[g];n(L,g,e)&&(k[i++]=L)}return k}},function(t,r,e){var n=e(149),g=e(275);t.exports=function(y,i){return n(y,g(y),i)}},function(t,r,e){var n=e(278),g=e(188),y=e(182);t.exports=function(i){return n(i,y,g)}},function(t,r,e){var n=e(278),g=e(275),y=e(187);t.exports=function(i){return n(i,y,g)}},function(t,r,e){var n=e(91)(e(59),"DataView");t.exports=n},function(t,r,e){var n=e(91)(e(59),"Promise");t.exports=n},function(t,r,e){var n=e(91)(e(59),"WeakMap");t.exports=n},function(t,r){var e=Object.prototype.hasOwnProperty;t.exports=function(n){var g=n.length,y=new n.constructor(g);return g&&typeof n[0]=="string"&&e.call(n,"index")&&(y.index=n.index,y.input=n.input),y}},function(t,r,e){var n=e(190),g=e(554),y=e(555),i=e(556),k=e(557);t.exports=function(L,$,V){var z=L.constructor;switch($){case"[object ArrayBuffer]":return n(L);case"[object Boolean]":case"[object Date]":return new z(+L);case"[object DataView]":return g(L,V);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return k(L,V);case"[object Map]":return new z;case"[object Number]":case"[object String]":return new z(L);case"[object RegExp]":return y(L);case"[object Set]":return new z;case"[object Symbol]":return i(L)}}},function(t,r,e){var n=e(59).Uint8Array;t.exports=n},function(t,r,e){var n=e(190);t.exports=function(g,y){var i=y?n(g.buffer):g.buffer;return new g.constructor(i,g.byteOffset,g.byteLength)}},function(t,r){var e=/\w*$/;t.exports=function(n){var g=new n.constructor(n.source,e.exec(n));return g.lastIndex=n.lastIndex,g}},function(t,r,e){var n=e(181),g=n?n.prototype:void 0,y=g?g.valueOf:void 0;t.exports=function(i){return y?Object(y.call(i)):{}}},function(t,r,e){var n=e(190);t.exports=function(g,y){var i=y?n(g.buffer):g.buffer;return new g.constructor(i,g.byteOffset,g.length)}},function(t,r,e){var n=e(559),g=e(277),y=e(186);t.exports=function(i){return typeof i.constructor!="function"||y(i)?{}:n(g(i))}},function(t,r,e){var n=e(94),g=Object.create,y=function(){function i(){}return function(k){if(!n(k))return{};if(g)return g(k);i.prototype=k;var L=new i;return i.prototype=void 0,L}}();t.exports=y},function(t,r,e){var n=e(561),g=e(184),y=e(185),i=y&&y.isMap,k=i?g(i):n;t.exports=k},function(t,r,e){var n=e(189),g=e(108);t.exports=function(y){return g(y)&&n(y)=="[object Map]"}},function(t,r,e){var n=e(563),g=e(184),y=e(185),i=y&&y.isSet,k=i?g(i):n;t.exports=k},function(t,r,e){var n=e(189),g=e(108);t.exports=function(y){return g(y)&&n(y)=="[object Set]"}},function(t,r,e){var n=e(2),g=e(5),y=e(8),i=e(63),k=e(6),L=e(9),$=e(4),V=e(3),z=e(70),re=e(0),oe=e(12),le=e(48),ue={};function ie(){var qe=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};!qe.logLevel&&qe.debug&&(qe.logLevel="debug"),re.merge(this,{options:qe,debugEnable:!1,api:"log",style:"color:blue;",logLevel:qe.logLevel&&qe.logLevel.toLowerCase()||"off",debug:re.emptyFunc,log:re.emptyFunc,info:re.emptyFunc,warn:re.emptyFunc,error:re.emptyFunc}),this.prefix=qe.prefix||"",this.localEnable=ue.enable&&qe.dbLog&&qe.account,this.setDebug(qe.debug),this.localEnable&&(this._local=new ue(qe.account,qe.expire),this._local.logError=this.error)}ue=e(573);var ae=ie.prototype,Ie=["Chrome","Safari","Firefox"],de={debug:1e3,log:2e3,info:3e3,warn:4e3,error:5e3,off:6e3};function Ce(qe){var jt,Fe=[];return n(jt=g(de)).call(jt,function(Et){de[Et]>=de[qe]&&Fe.push(Et)}),Fe}ae.setDebug=function(){var qe=arguments.length>0&&arguments[0]!==void 0&&arguments[0],jt=this;if(jt.debugEnable=qe||jt.logLevel==="debug",qe.style&&(jt.style=qe.style),re.exist(console)){if(jt.logLevel!=="off"){var Fe=console,Et=Ce(jt.logLevel);n(Et).call(Et,function(er){jt[er]=function(){var nr=jt.formatArgsAndSave(arguments,er);y(Ie).call(Ie,z.name)!==-1&&re.isString(nr[0])&&(nr[0]="%c"+nr[0],i(nr).call(nr,1,0,jt.style)),jt._log(er,nr)}}),jt.options.logFunc?jt._log=function(){}:jt._log=function(er,nr){if(er==="debug"&&(er="log"),Fe[er])try{Fe[er].apply?jt.chrome(er,nr):jt.ie(er,nr)}catch{}},jt.chrome=function(er,nr){y(Ie).call(Ie,z.name)!==-1?Fe[er].apply(Fe,nr):jt.ie(er,nr)},jt.ie=function(er,nr){n(nr).call(nr,function(dr){Fe[er](k(dr,null,4))})}}else if(oe.isRN||this.localEnable||this.options.logFunc){var cr=!oe.isRN&&!this.localEnable;jt.log=function(){jt.formatArgsAndSave(arguments,"log",cr)},jt.info=function(){jt.formatArgsAndSave(arguments,"info",cr)},jt.warn=function(){jt.formatArgsAndSave(arguments,"warn",cr)},jt.error=function(){jt.formatArgsAndSave(arguments,"error",cr)},jt.debug=function(){jt.formatArgsAndSave(arguments,"log",cr)}}}},ae.destroy=function(){this.localEnable=!1,this.log=function(){},this.info=function(){},this.warn=function(){},this.error=function(){},this.debug=function(){},this._local&&this._local.destroy()},ae.formatArgsAndSave=function(qe,jt,Fe){var Et,cr;qe=L([]).call(qe,0);var er=new Date,nr=Ue(er.getMonth()+1)+"-"+Ue(er.getDate())+" "+Ue(er.getHours())+":"+Ue(er.getMinutes())+":"+Ue(er.getSeconds())+":"+Ue(er.getMilliseconds(),3),dr=$(Et=$(cr="[NIM ".concat(jt.toUpperCase()," ")).call(cr,nr," ")).call(Et,this.prefix.toUpperCase(),"]  "),ir="";re.isString(qe[0])?qe[0]=dr+qe[0]:i(qe).call(qe,0,0,dr),n(qe).call(qe,function(ur,or){re.isArray(ur)||re.isObject(ur)?(qe[or]=re.simpleClone(ur),ir+=k(qe[or])+" "):ir+=ur+" "});var tr=this.options.logFunc;return tr&&re.isFunction(tr[jt])&&tr[jt].apply(tr,qe),!Fe&&this.writeLocalLog(ir,jt,+er),qe},ae.writeLocalLog=function(qe,jt,Fe){return oe.isRN?this.writeLocalLogRN(qe,jt,Fe):oe.isBrowser?this.writeLocalLogBrowser(qe,jt,Fe):void 0};var Ue=function(qe,jt){jt=jt||2;for(var Fe=""+qe;Fe.length<jt;)Fe="0"+Fe;return Fe};ae.writeLocalLogBrowser=function(qe,jt,Fe){this._local&&this._local.saveLog({log:qe,level:jt,time:Fe})},ae.writeLocalLogRN=function(qe,jt){if(le.rnfs&&le.rnfs.writeFile&&le.rnfs.appendFile&&le.rnfs.DocumentDirectoryPath&&/error|warn|info/.test(jt)){var Fe,Et=le.rnfs,cr=Et.size/2-256;qe+=`\r
`,Et.nimPromise=Et.nimPromise.then(function(){return Fe=er(Et.nimIndex),Et.exists(Fe)}).then(function(nr){return nr?Et.appendFile(Fe,qe):Et.writeFile(Fe,qe)}).then(function(){return Et.stat(Fe)}).then(function(nr){if(nr.size>cr)return Et.nimIndex++,Et.nimIndex>1&&(Et.nimIndex=Et.nimIndex%2),Et.unlink(er(Et.nimIndex)).catch(function(){return V.resolve()})}).catch(function(){})}function er(nr){return le.rnfs.DocumentDirectoryPath+"/nimlog_"+nr+".log"}},t.exports=ie},function(t,r,e){var n=e(566);t.exports=n},function(t,r,e){e(567);var n=e(14);t.exports=n.parseFloat},function(t,r,e){var n=e(1),g=e(568);n({global:!0,forced:parseFloat!=g},{parseFloat:g})},function(t,r,e){var n=e(16),g=e(7),y=e(13),i=e(58),k=e(191).trim,L=e(151),$=y("".charAt),V=n.parseFloat,z=n.Symbol,re=z&&z.iterator,oe=1/V(L+"-0")!=-1/0||re&&!g(function(){V(Object(re))});t.exports=oe?function(le){var ue=k(i(le)),ie=V(ue);return ie===0&&$(ue,0)=="-"?-0:ie}:V},function(t,r,e){var n=e(570);t.exports=n},function(t,r,e){e(571);var n=e(14);t.exports=n.parseInt},function(t,r,e){var n=e(1),g=e(572);n({global:!0,forced:parseInt!=g},{parseInt:g})},function(t,r,e){var n=e(16),g=e(7),y=e(13),i=e(58),k=e(191).trim,L=e(151),$=n.parseInt,V=n.Symbol,z=V&&V.iterator,re=/^[+-]?0x/i,oe=y(re.exec),le=$(L+"08")!==8||$(L+"0x16")!==22||z&&!g(function(){$(Object(z))});t.exports=le?function(ue,ie){var ae=k(i(ue));return $(ae,ie>>>0||(oe(re,ae)?16:10))}:$},function(t,r,e){var n=e(9),g=e(22),y=e(3),i=e(574),k=e(575),L=e(0).getGlobal(),$=e(70).name,V=typeof i=="function",z=L.indexedDB&&!/^(IE)$/.test($);function re(le,ue){this.logWorker=null,this.db=null,this.tabId=(65536*(1+Math.random())|0).toString(16).substring(1),this.logQueue=[],this.callbackList=[],this.preTime=null,this.lastTime=+new Date,this.saveLogTimer=void 0,this.initLogLocal({name:le,expire:ue})}var oe=re.prototype;re.enable=!0,oe.saveLog=function(le){var ue=this;le.tabId=this.tabId;try{if(!re.enable)return;var ie,ae=this.logQueue.length,Ie=this.logQueue[ae-1];if(le.time===this.preTime&&Ie)return void(Ie.log+=`\r
`+this.tabId+" "+le.log);this.logQueue.length>50||le.time-this.lastTime>3e3&&this.logQueue.length>0?(this.doSaveLog(n(ie=this.logQueue).call(ie,0)),this.lastTime=Ie.time,this.logQueue=[],clearTimeout(this.saveLogTimer)):(clearTimeout(this.saveLogTimer),this.saveLogTimer=g(function(){var de;ue.logQueue.length>0&&(Ie=ue.logQueue[ue.logQueue.length-1],ue.doSaveLog(n(de=ue.logQueue).call(de,0)),ue.lastTime=Ie.time,ue.logQueue=[])},3e3-(le.time-this.lastTime))),this.logQueue.push(le),this.preTime=le.time}catch(de){console.error("saveLog Error",de)}},oe.destroy=function(){if(this.logQueue.length>0){var le,ue=this.logQueue[this.logQueue.length-1];this.doSaveLog(n(le=this.logQueue).call(le,0)),this.lastTime=ue.time,this.logQueue=[]}clearTimeout(this.saveLogTimer)},oe.doSaveLog=function(){},oe.initLogLocal=function(){},oe.fetchLog=function(){},oe.deleteLogs=function(){},oe.logError=function(){},z?V?(oe.doSaveLog=function(le){this.logWorker.postMessage(le)},oe.initLogLocal=function(le){var ue=this;this.logWorker=new i({}),this.logWorker.onmessage=function(ie){var ae=ie.data||{};switch(ae.type){case"fetchDone":ue.fetchLogDone(ae.code,ae.msg);break;case"error":ue.logError(ae.msg)}},this.logWorker.postMessage({type:"init",msg:le})},oe.fetchLog=function(){var le=this;return new y(function(ue,ie){le.callbackList.length===0&&le.logWorker.postMessage({type:"fetch"}),le.callbackList.push(ue),le.callbackList.push(ie)})},oe.fetchLogDone=function(le,ue){for(var ie=le===200?0:1,ae=0;ae<this.callbackList.length/2;ae++)this.callbackList[2*ae+ie](ue);this.callbackList=[]},oe.deleteLogs=function(le){return this.logWorker.postMessage({type:"delete",msg:le}),y.resolve()}):(oe.doSaveLog=function(le){var ue=this;this.db.putLog(le).catch(function(ie){ue.logError({msg:"putLog error",error:ie})})},oe.initLogLocal=function(le){var ue=this;this.db=new k(le),this.db.init().catch(function(ie){ue.logError({msg:"dbLog init error",error:ie})})},oe.fetchLog=function(){return this.db.getAllLogs()},oe.deleteLogs=function(le){return this.db.deleteLogs(le)}):re.enable=!1,t.exports=re},function(t,r,e){e.r(r),e.d(r,"default",function(){return y});var n=e(304),g=e.n(n);function y(){return g()(`/*!
 * 
 * VERSION: 9.16.2
 * Git Hash: 1ddefb74af2685d8546990b4a578f520ed738e86
 * 
 * Create At: 2024/5/22 下午2:28:56
 * 
 * Target: NIM_Web_log.worker
 */!function(t){var n={};function r(e){if(n[e])return n[e].exports;var o=n[e]={i:e,l:!1,exports:{}};return t[e].call(o.exports,o,o.exports,r),o.l=!0,o.exports}r.m=t,r.c=n,r.d=function(t,n,e){r.o(t,n)||Object.defineProperty(t,n,{enumerable:!0,get:e})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,n){if(1&n&&(t=r(t)),8&n)return t;if(4&n&&"object"==typeof t&&t&&t.__esModule)return t;var e=Object.create(null);if(r.r(e),Object.defineProperty(e,"default",{enumerable:!0,value:t}),2&n&&"string"!=typeof t)for(var o in t)r.d(e,o,function(n){return t[n]}.bind(null,o));return e},r.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(n,"a",n),n},r.o=function(t,n){return Object.prototype.hasOwnProperty.call(t,n)},r.p="",r(r.s=109)}([function(t,n,r){"use strict";var e=r(1),o=r(41),i=r(78),c=r(2),u=r(43).f,a=r(84),f=r(13),s=r(34),p=r(19),l=r(8),v=function(t){var n=function(r,e,i){if(this instanceof n){switch(arguments.length){case 0:return new t;case 1:return new t(r);case 2:return new t(r,e)}return new t(r,e,i)}return o(t,this,arguments)};return n.prototype=t.prototype,n};t.exports=function(t,n){var r,o,d,y,h,m,g,x,b,w=t.target,S=t.global,j=t.stat,O=t.proto,P=S?e:j?e[w]:(e[w]||{}).prototype,T=S?f:f[w]||p(f,w,{})[w],A=T.prototype;for(y in n)o=!(r=a(S?y:w+(j?".":"#")+y,t.forced))&&P&&l(P,y),m=T[y],o&&(g=t.dontCallGetSet?(b=u(P,y))&&b.value:P[y]),h=o&&g?g:n[y],o&&typeof m==typeof h||(x=t.bind&&o?s(h,e):t.wrap&&o?v(h):O&&c(h)?i(h):h,(t.sham||h&&h.sham||m&&m.sham)&&p(x,"sham",!0),p(T,y,x),O&&(l(f,d=w+"Prototype")||p(f,d,{}),p(f[d],y,h),t.real&&A&&(r||!A[y])&&p(A,y,h)))}},function(t,n,r){(function(n){var r=function(t){return t&&t.Math==Math&&t};t.exports=r("object"==typeof globalThis&&globalThis)||r("object"==typeof window&&window)||r("object"==typeof self&&self)||r("object"==typeof n&&n)||function(){return this}()||Function("return this")()}).call(this,r(77))},function(t,n,r){var e=r(79),o=e.all;t.exports=e.IS_HTMLDDA?function(t){return"function"==typeof t||t===o}:function(t){return"function"==typeof t}},function(t,n,r){var e=r(13),o=r(8),i=r(75),c=r(16).f;t.exports=function(t){var n=e.Symbol||(e.Symbol={});o(n,t)||c(n,t,{value:i.f(t)})}},function(t,n,r){var e=r(1),o=r(33),i=r(8),c=r(60),u=r(24),a=r(82),f=o("wks"),s=e.Symbol,p=s&&s.for,l=a?s:s&&s.withoutSetter||c;t.exports=function(t){if(!i(f,t)||!u&&"string"!=typeof f[t]){var n="Symbol."+t;u&&i(s,t)?f[t]=s[t]:f[t]=a&&p?p(n):l(n)}return f[t]}},function(t,n){t.exports=function(t){try{return!!t()}catch(t){return!0}}},function(t,n,r){var e=r(42),o=Function.prototype,i=o.call,c=e&&o.bind.bind(i,i);t.exports=e?c:function(t){return function(){return i.apply(t,arguments)}}},function(t,n,r){var e=r(42),o=Function.prototype.call;t.exports=e?o.bind(o):function(){return o.apply(o,arguments)}},function(t,n,r){var e=r(6),o=r(25),i=e({}.hasOwnProperty);t.exports=Object.hasOwn||function(t,n){return i(o(t),n)}},function(t,n,r){var e=r(13),o=r(1),i=r(2),c=function(t){return i(t)?t:void 0};t.exports=function(t,n){return arguments.length<2?c(e[t])||c(o[t]):e[t]&&e[t][n]||o[t]&&o[t][n]}},function(t,n,r){var e=r(2),o=r(79),i=o.all;t.exports=o.IS_HTMLDDA?function(t){return"object"==typeof t?null!==t:e(t)||t===i}:function(t){return"object"==typeof t?null!==t:e(t)}},function(t,n,r){var e=r(5);t.exports=!e((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]}))},function(t,n,r){var e=r(10),o=String,i=TypeError;t.exports=function(t){if(e(t))return t;throw i(o(t)+" is not an object")}},function(t,n){t.exports={}},function(t,n,r){var e=r(6);t.exports=e({}.isPrototypeOf)},function(t,n){t.exports=!0},function(t,n,r){var e=r(11),o=r(83),i=r(85),c=r(12),u=r(45),a=TypeError,f=Object.defineProperty,s=Object.getOwnPropertyDescriptor;n.f=e?i?function(t,n,r){if(c(t),n=u(n),c(r),"function"==typeof t&&"prototype"===n&&"value"in r&&"writable"in r&&!r.writable){var e=s(t,n);e&&e.writable&&(t[n]=r.value,r={configurable:"configurable"in r?r.configurable:e.configurable,enumerable:"enumerable"in r?r.enumerable:e.enumerable,writable:!1})}return f(t,n,r)}:f:function(t,n,r){if(c(t),n=u(n),c(r),o)try{return f(t,n,r)}catch(t){}if("get"in r||"set"in r)throw a("Accessors not supported");return"value"in r&&(t[n]=r.value),t}},function(t,n,r){var e=r(2),o=r(32),i=TypeError;t.exports=function(t){if(e(t))return t;throw i(o(t)+" is not a function")}},function(t,n,r){var e=r(81),o=r(57);t.exports=function(t){return e(o(t))}},function(t,n,r){var e=r(11),o=r(16),i=r(20);t.exports=e?function(t,n,r){return o.f(t,n,i(1,r))}:function(t,n,r){return t[n]=r,t}},function(t,n){t.exports=function(t,n){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:n}}},function(t,n,r){var e=r(19);t.exports=function(t,n,r,o){return o&&o.enumerable?t[n]=r:e(t,n,r),t}},function(t,n,r){"use strict";var e=r(17),o=TypeError,i=function(t){var n,r;this.promise=new t((function(t,e){if(void 0!==n||void 0!==r)throw o("Bad Promise constructor");n=t,r=e})),this.resolve=e(n),this.reject=e(r)};t.exports.f=function(t){return new i(t)}},function(t,n,r){var e=r(6),o=e({}.toString),i=e("".slice);t.exports=function(t){return i(o(t),8,-1)}},function(t,n,r){var e=r(47),o=r(5);t.exports=!!Object.getOwnPropertySymbols&&!o((function(){var t=Symbol();return!String(t)||!(Object(t)instanceof Symbol)||!Symbol.sham&&e&&e<41}))},function(t,n,r){var e=r(57),o=Object;t.exports=function(t){return o(e(t))}},function(t,n,r){var e=r(124);t.exports=function(t){return e(t.length)}},function(t,n){t.exports={}},function(t,n,r){var e=r(70),o=r(2),i=r(23),c=r(4)("toStringTag"),u=Object,a="Arguments"==i(function(){return arguments}());t.exports=e?i:function(t){var n,r,e;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(r=function(t,n){try{return t[n]}catch(t){}}(n=u(t),c))?r:a?i(n):"Object"==(e=i(n))&&o(n.callee)?"Arguments":e}},function(t,n,r){var e=r(70),o=r(16).f,i=r(19),c=r(8),u=r(136),a=r(4)("toStringTag");t.exports=function(t,n,r,f){if(t){var s=r?t:t.prototype;c(s,a)||o(s,a,{configurable:!0,value:n}),f&&!e&&i(s,"toString",u)}}},function(t,n,r){var e=r(1);t.exports=e.Promise},function(t,n,r){var e=r(9);t.exports=e("navigator","userAgent")||""},function(t,n){var r=String;t.exports=function(t){try{return r(t)}catch(t){return"Object"}}},function(t,n,r){var e=r(15),o=r(59);(t.exports=function(t,n){return o[t]||(o[t]=void 0!==n?n:{})})("versions",[]).push({version:"3.27.1",mode:e?"pure":"global",copyright:"© 2014-2022 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.27.1/LICENSE",source:"https://github.com/zloirock/core-js"})},function(t,n,r){var e=r(78),o=r(17),i=r(42),c=e(e.bind);t.exports=function(t,n){return o(t),void 0===n?t:i?c(t,n):function(){return t.apply(n,arguments)}}},function(t,n,r){var e=r(34),o=r(7),i=r(12),c=r(32),u=r(127),a=r(26),f=r(14),s=r(128),p=r(89),l=r(129),v=TypeError,d=function(t,n){this.stopped=t,this.result=n},y=d.prototype;t.exports=function(t,n,r){var h,m,g,x,b,w,S,j=r&&r.that,O=!(!r||!r.AS_ENTRIES),P=!(!r||!r.IS_RECORD),T=!(!r||!r.IS_ITERATOR),A=!(!r||!r.INTERRUPTED),E=e(n,j),k=function(t){return h&&l(h,"normal",t),new d(!0,t)},I=function(t){return O?(i(t),A?E(t[0],t[1],k):E(t[0],t[1])):A?E(t,k):E(t)};if(P)h=t.iterator;else if(T)h=t;else{if(!(m=p(t)))throw v(c(t)+" is not iterable");if(u(m)){for(g=0,x=a(t);x>g;g++)if((b=I(t[g]))&&f(y,b))return b;return new d(!1)}h=s(t,m)}for(w=P?t.next:h.next;!(S=o(w,h)).done;){try{b=I(S.value)}catch(t){l(h,"throw",t)}if("object"==typeof b&&b&&f(y,b))return b}return new d(!1)}},function(t,n,r){var e=r(28),o=String;t.exports=function(t){if("Symbol"===e(t))throw TypeError("Cannot convert a Symbol value to a string");return o(t)}},function(t,n){t.exports=function(t){try{return{error:!1,value:t()}}catch(t){return{error:!0,value:t}}}},function(t,n,r){var e=r(1),o=r(30),i=r(2),c=r(84),u=r(94),a=r(4),f=r(147),s=r(98),p=r(15),l=r(47),v=o&&o.prototype,d=a("species"),y=!1,h=i(e.PromiseRejectionEvent),m=c("Promise",(function(){var t=u(o),n=t!==String(o);if(!n&&66===l)return!0;if(p&&(!v.catch||!v.finally))return!0;if(!l||l<51||!/native code/.test(t)){var r=new o((function(t){t(1)})),e=function(t){t((function(){}),(function(){}))};if((r.constructor={})[d]=e,!(y=r.then((function(){}))instanceof e))return!0}return!n&&(f||s)&&!h}));t.exports={CONSTRUCTOR:m,REJECTION_EVENT:h,SUBCLASSING:y}},function(t,n,r){var e=r(23);t.exports=Array.isArray||function(t){return"Array"==e(t)}},function(t,n,r){var e=r(13);t.exports=function(t){return e[t+"Prototype"]}},function(t,n,r){var e=r(42),o=Function.prototype,i=o.apply,c=o.call;t.exports="object"==typeof Reflect&&Reflect.apply||(e?c.bind(i):function(){return c.apply(i,arguments)})},function(t,n,r){var e=r(5);t.exports=!e((function(){var t=function(){}.bind();return"function"!=typeof t||t.hasOwnProperty("prototype")}))},function(t,n,r){var e=r(11),o=r(7),i=r(80),c=r(20),u=r(18),a=r(45),f=r(8),s=r(83),p=Object.getOwnPropertyDescriptor;n.f=e?p:function(t,n){if(t=u(t),n=a(n),s)try{return p(t,n)}catch(t){}if(f(t,n))return c(!o(i.f,t,n),t[n])}},function(t,n){t.exports=function(t){return null==t}},function(t,n,r){var e=r(115),o=r(46);t.exports=function(t){var n=e(t,"string");return o(n)?n:n+""}},function(t,n,r){var e=r(9),o=r(2),i=r(14),c=r(82),u=Object;t.exports=c?function(t){return"symbol"==typeof t}:function(t){var n=e("Symbol");return o(n)&&i(n.prototype,u(t))}},function(t,n,r){var e,o,i=r(1),c=r(31),u=i.process,a=i.Deno,f=u&&u.versions||a&&a.version,s=f&&f.v8;s&&(o=(e=s.split("."))[0]>0&&e[0]<4?1:+(e[0]+e[1])),!o&&c&&(!(e=c.match(/Edge\\/(\\d+)/))||e[1]>=74)&&(e=c.match(/Chrome\\/(\\d+)/))&&(o=+e[1]),t.exports=o},function(t,n,r){var e=r(33),o=r(60),i=e("keys");t.exports=function(t){return i[t]||(i[t]=o(t))}},function(t,n){t.exports={}},function(t,n,r){var e,o=r(12),i=r(87),c=r(67),u=r(49),a=r(88),f=r(61),s=r(48),p=s("IE_PROTO"),l=function(){},v=function(t){return"<script>"+t+"<\\/script>"},d=function(t){t.write(v("")),t.close();var n=t.parentWindow.Object;return t=null,n},y=function(){try{e=new ActiveXObject("htmlfile")}catch(t){}var t,n;y="undefined"!=typeof document?document.domain&&e?d(e):((n=f("iframe")).style.display="none",a.appendChild(n),n.src=String("javascript:"),(t=n.contentWindow.document).open(),t.write(v("document.F=Object")),t.close(),t.F):d(e);for(var r=c.length;r--;)delete y.prototype[c[r]];return y()};u[p]=!0,t.exports=Object.create||function(t,n){var r;return null!==t?(l.prototype=o(t),r=new l,l.prototype=null,r[p]=t):r=y(),void 0===n?r:i.f(r,n)}},function(t,n,r){var e,o,i,c=r(133),u=r(1),a=r(10),f=r(19),s=r(8),p=r(59),l=r(48),v=r(49),d=u.TypeError,y=u.WeakMap;if(c||p.state){var h=p.state||(p.state=new y);h.get=h.get,h.has=h.has,h.set=h.set,e=function(t,n){if(h.has(t))throw d("Object already initialized");return n.facade=t,h.set(t,n),n},o=function(t){return h.get(t)||{}},i=function(t){return h.has(t)}}else{var m=l("state");v[m]=!0,e=function(t,n){if(s(t,m))throw d("Object already initialized");return n.facade=t,f(t,m,n),n},o=function(t){return s(t,m)?t[m]:{}},i=function(t){return s(t,m)}}t.exports={set:e,get:o,has:i,enforce:function(t){return i(t)?o(t):e(t,{})},getterFor:function(t){return function(n){var r;if(!a(n)||(r=o(n)).type!==t)throw d("Incompatible receiver, "+t+" required");return r}}}},function(t,n,r){var e=r(23),o=r(1);t.exports="process"==e(o.process)},function(t,n,r){var e=r(6);t.exports=e([].slice)},function(t,n,r){r(71);var e=r(158),o=r(1),i=r(28),c=r(19),u=r(27),a=r(4)("toStringTag");for(var f in e){var s=o[f],p=s&&s.prototype;p&&i(p)!==a&&c(p,a,f),u[f]=u.Array}},function(t,n,r){var e=r(5),o=r(4),i=r(47),c=o("species");t.exports=function(t){return i>=51||!e((function(){var n=[];return(n.constructor={})[c]=function(){return{foo:1}},1!==n[t](Boolean).foo}))}},function(t,n,r){var e=r(34),o=r(6),i=r(81),c=r(25),u=r(26),a=r(103),f=o([].push),s=function(t){var n=1==t,r=2==t,o=3==t,s=4==t,p=6==t,l=7==t,v=5==t||p;return function(d,y,h,m){for(var g,x,b=c(d),w=i(b),S=e(y,h),j=u(w),O=0,P=m||a,T=n?P(d,j):r||l?P(d,0):void 0;j>O;O++)if((v||O in w)&&(x=S(g=w[O],O,b),t))if(n)T[O]=x;else if(x)switch(t){case 3:return!0;case 5:return g;case 6:return O;case 2:f(T,g)}else switch(t){case 4:return!1;case 7:f(T,g)}return p?-1:o||s?s:T}};t.exports={forEach:s(0),map:s(1),filter:s(2),some:s(3),every:s(4),find:s(5),findIndex:s(6),filterReject:s(7)}},function(t,n,r){var e=r(44),o=TypeError;t.exports=function(t){if(e(t))throw o("Can't call method on "+t);return t}},function(t,n,r){var e=r(17),o=r(44);t.exports=function(t,n){var r=t[n];return o(r)?void 0:e(r)}},function(t,n,r){var e=r(1),o=r(117),i=e["__core-js_shared__"]||o("__core-js_shared__",{});t.exports=i},function(t,n,r){var e=r(6),o=0,i=Math.random(),c=e(1..toString);t.exports=function(t){return"Symbol("+(void 0===t?"":t)+")_"+c(++o+i,36)}},function(t,n,r){var e=r(1),o=r(10),i=e.document,c=o(i)&&o(i.createElement);t.exports=function(t){return c?i.createElement(t):{}}},function(t,n,r){var e=r(8),o=r(2),i=r(25),c=r(48),u=r(118),a=c("IE_PROTO"),f=Object,s=f.prototype;t.exports=u?f.getPrototypeOf:function(t){var n=i(t);if(e(n,a))return n[a];var r=n.constructor;return o(r)&&n instanceof r?r.prototype:n instanceof f?s:null}},function(t,n,r){var e=r(6),o=r(12),i=r(119);t.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var t,n=!1,r={};try{(t=e(Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set))(r,[]),n=r instanceof Array}catch(t){}return function(r,e){return o(r),i(e),n?t(r,e):r.__proto__=e,r}}():void 0)},function(t,n,r){var e=r(86),o=r(67).concat("length","prototype");n.f=Object.getOwnPropertyNames||function(t){return e(t,o)}},function(t,n,r){var e=r(66),o=Math.max,i=Math.min;t.exports=function(t,n){var r=e(t);return r<0?o(r+n,0):i(r,n)}},function(t,n,r){var e=r(123);t.exports=function(t){var n=+t;return n!=n||0===n?0:e(n)}},function(t,n){t.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},function(t,n){n.f=Object.getOwnPropertySymbols},function(t,n,r){var e=r(86),o=r(67);t.exports=Object.keys||function(t){return e(t,o)}},function(t,n,r){var e={};e[r(4)("toStringTag")]="z",t.exports="[object z]"===String(e)},function(t,n,r){"use strict";var e=r(18),o=r(132),i=r(27),c=r(51),u=r(16).f,a=r(90),f=r(92),s=r(15),p=r(11),l=c.set,v=c.getterFor("Array Iterator");t.exports=a(Array,"Array",(function(t,n){l(this,{type:"Array Iterator",target:e(t),index:0,kind:n})}),(function(){var t=v(this),n=t.target,r=t.kind,e=t.index++;return!n||e>=n.length?(t.target=void 0,f(void 0,!0)):f("keys"==r?e:"values"==r?n[e]:[e,n[e]],!1)}),"values");var d=i.Arguments=i.Array;if(o("keys"),o("values"),o("entries"),!s&&p&&"values"!==d.name)try{u(d,"name",{value:"values"})}catch(t){}},function(t,n){},function(t,n,r){var e=r(6),o=r(5),i=r(2),c=r(28),u=r(9),a=r(94),f=function(){},s=[],p=u("Reflect","construct"),l=/^\\s*(?:class|function)\\b/,v=e(l.exec),d=!l.exec(f),y=function(t){if(!i(t))return!1;try{return p(f,s,t),!0}catch(t){return!1}},h=function(t){if(!i(t))return!1;switch(c(t)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return d||!!v(l,a(t))}catch(t){return!0}};h.sham=!0,t.exports=!p||o((function(){var t;return y(y.call)||!y(Object)||!y((function(){t=!0}))||t}))?h:y},function(t,n,r){"use strict";var e=r(45),o=r(16),i=r(20);t.exports=function(t,n,r){var c=e(n);c in t?o.f(t,c,i(0,r)):t[c]=r}},function(t,n,r){var e=r(4);n.f=e},function(t,n,r){t.exports=r(111)},function(t,n){var r;r=function(){return this}();try{r=r||new Function("return this")()}catch(t){"object"==typeof window&&(r=window)}t.exports=r},function(t,n,r){var e=r(23),o=r(6);t.exports=function(t){if("Function"===e(t))return o(t)}},function(t,n){var r="object"==typeof document&&document.all,e=void 0===r&&void 0!==r;t.exports={all:r,IS_HTMLDDA:e}},function(t,n,r){"use strict";var e={}.propertyIsEnumerable,o=Object.getOwnPropertyDescriptor,i=o&&!e.call({1:2},1);n.f=i?function(t){var n=o(this,t);return!!n&&n.enumerable}:e},function(t,n,r){var e=r(6),o=r(5),i=r(23),c=Object,u=e("".split);t.exports=o((function(){return!c("z").propertyIsEnumerable(0)}))?function(t){return"String"==i(t)?u(t,""):c(t)}:c},function(t,n,r){var e=r(24);t.exports=e&&!Symbol.sham&&"symbol"==typeof Symbol.iterator},function(t,n,r){var e=r(11),o=r(5),i=r(61);t.exports=!e&&!o((function(){return 7!=Object.defineProperty(i("div"),"a",{get:function(){return 7}}).a}))},function(t,n,r){var e=r(5),o=r(2),i=/#|\\.prototype\\./,c=function(t,n){var r=a[u(t)];return r==s||r!=f&&(o(n)?e(n):!!n)},u=c.normalize=function(t){return String(t).replace(i,".").toLowerCase()},a=c.data={},f=c.NATIVE="N",s=c.POLYFILL="P";t.exports=c},function(t,n,r){var e=r(11),o=r(5);t.exports=e&&o((function(){return 42!=Object.defineProperty((function(){}),"prototype",{value:42,writable:!1}).prototype}))},function(t,n,r){var e=r(6),o=r(8),i=r(18),c=r(122).indexOf,u=r(49),a=e([].push);t.exports=function(t,n){var r,e=i(t),f=0,s=[];for(r in e)!o(u,r)&&o(e,r)&&a(s,r);for(;n.length>f;)o(e,r=n[f++])&&(~c(s,r)||a(s,r));return s}},function(t,n,r){var e=r(11),o=r(85),i=r(16),c=r(12),u=r(18),a=r(69);n.f=e&&!o?Object.defineProperties:function(t,n){c(t);for(var r,e=u(n),o=a(n),f=o.length,s=0;f>s;)i.f(t,r=o[s++],e[r]);return t}},function(t,n,r){var e=r(9);t.exports=e("document","documentElement")},function(t,n,r){var e=r(28),o=r(58),i=r(44),c=r(27),u=r(4)("iterator");t.exports=function(t){if(!i(t))return o(t,u)||o(t,"@@iterator")||c[e(t)]}},function(t,n,r){"use strict";var e=r(0),o=r(7),i=r(15),c=r(134),u=r(2),a=r(135),f=r(62),s=r(63),p=r(29),l=r(19),v=r(21),d=r(4),y=r(27),h=r(91),m=c.PROPER,g=c.CONFIGURABLE,x=h.IteratorPrototype,b=h.BUGGY_SAFARI_ITERATORS,w=d("iterator"),S=function(){return this};t.exports=function(t,n,r,c,d,h,j){a(r,n,c);var O,P,T,A=function(t){if(t===d&&L)return L;if(!b&&t in I)return I[t];switch(t){case"keys":case"values":case"entries":return function(){return new r(this,t)}}return function(){return new r(this)}},E=n+" Iterator",k=!1,I=t.prototype,D=I[w]||I["@@iterator"]||d&&I[d],L=!b&&D||A(d),_="Array"==n&&I.entries||D;if(_&&(O=f(_.call(new t)))!==Object.prototype&&O.next&&(i||f(O)===x||(s?s(O,x):u(O[w])||v(O,w,S)),p(O,E,!0,!0),i&&(y[E]=S)),m&&"values"==d&&D&&"values"!==D.name&&(!i&&g?l(I,"name","values"):(k=!0,L=function(){return o(D,this)})),d)if(P={values:A("values"),keys:h?L:A("keys"),entries:A("entries")},j)for(T in P)(b||k||!(T in I))&&v(I,T,P[T]);else e({target:n,proto:!0,forced:b||k},P);return i&&!j||I[w]===L||v(I,w,L,{name:d}),y[n]=L,P}},function(t,n,r){"use strict";var e,o,i,c=r(5),u=r(2),a=r(10),f=r(50),s=r(62),p=r(21),l=r(4),v=r(15),d=l("iterator"),y=!1;[].keys&&("next"in(i=[].keys())?(o=s(s(i)))!==Object.prototype&&(e=o):y=!0),!a(e)||c((function(){var t={};return e[d].call(t)!==t}))?e={}:v&&(e=f(e)),u(e[d])||p(e,d,(function(){return this})),t.exports={IteratorPrototype:e,BUGGY_SAFARI_ITERATORS:y}},function(t,n){t.exports=function(t,n){return{value:t,done:n}}},function(t,n,r){var e=r(12),o=r(141),i=r(44),c=r(4)("species");t.exports=function(t,n){var r,u=e(t).constructor;return void 0===u||i(r=e(u)[c])?n:o(r)}},function(t,n,r){var e=r(6),o=r(2),i=r(59),c=e(Function.toString);o(i.inspectSource)||(i.inspectSource=function(t){return c(t)}),t.exports=i.inspectSource},function(t,n,r){var e,o,i,c,u=r(1),a=r(41),f=r(34),s=r(2),p=r(8),l=r(5),v=r(88),d=r(53),y=r(61),h=r(96),m=r(97),g=r(52),x=u.setImmediate,b=u.clearImmediate,w=u.process,S=u.Dispatch,j=u.Function,O=u.MessageChannel,P=u.String,T=0,A={};try{e=u.location}catch(t){}var E=function(t){if(p(A,t)){var n=A[t];delete A[t],n()}},k=function(t){return function(){E(t)}},I=function(t){E(t.data)},D=function(t){u.postMessage(P(t),e.protocol+"//"+e.host)};x&&b||(x=function(t){h(arguments.length,1);var n=s(t)?t:j(t),r=d(arguments,1);return A[++T]=function(){a(n,void 0,r)},o(T),T},b=function(t){delete A[t]},g?o=function(t){w.nextTick(k(t))}:S&&S.now?o=function(t){S.now(k(t))}:O&&!m?(c=(i=new O).port2,i.port1.onmessage=I,o=f(c.postMessage,c)):u.addEventListener&&s(u.postMessage)&&!u.importScripts&&e&&"file:"!==e.protocol&&!l(D)?(o=D,u.addEventListener("message",I,!1)):o="onreadystatechange"in y("script")?function(t){v.appendChild(y("script")).onreadystatechange=function(){v.removeChild(this),E(t)}}:function(t){setTimeout(k(t),0)}),t.exports={set:x,clear:b}},function(t,n){var r=TypeError;t.exports=function(t,n){if(t<n)throw r("Not enough arguments");return t}},function(t,n,r){var e=r(31);t.exports=/(?:ipad|iphone|ipod).*applewebkit/i.test(e)},function(t,n){t.exports="object"==typeof Deno&&Deno&&"object"==typeof Deno.version},function(t,n,r){var e=r(30),o=r(149),i=r(38).CONSTRUCTOR;t.exports=i||!o((function(t){e.all(t).then(void 0,(function(){}))}))},function(t,n,r){var e=r(12),o=r(10),i=r(22);t.exports=function(t,n){if(e(t),o(n)&&n.constructor===t)return n;var r=i.f(t);return(0,r.resolve)(n),r.promise}},function(t,n,r){"use strict";var e=r(157).charAt,o=r(36),i=r(51),c=r(90),u=r(92),a=i.set,f=i.getterFor("String Iterator");c(String,"String",(function(t){a(this,{type:"String Iterator",string:o(t),index:0})}),(function(){var t,n=f(this),r=n.string,o=n.index;return o>=r.length?u(void 0,!0):(t=e(r,o),n.index+=t.length,u(t,!1))}))},function(t,n,r){t.exports=r(159)},function(t,n,r){var e=r(168);t.exports=function(t,n){return new(e(t))(0===n?0:n)}},function(t,n,r){"use strict";var e=r(0),o=r(5),i=r(39),c=r(10),u=r(25),a=r(26),f=r(177),s=r(74),p=r(103),l=r(55),v=r(4),d=r(47),y=v("isConcatSpreadable"),h=d>=51||!o((function(){var t=[];return t[y]=!1,t.concat()[0]!==t})),m=l("concat"),g=function(t){if(!c(t))return!1;var n=t[y];return void 0!==n?!!n:i(t)};e({target:"Array",proto:!0,arity:1,forced:!h||!m},{concat:function(t){var n,r,e,o,i,c=u(this),l=p(c,0),v=0;for(n=-1,e=arguments.length;n<e;n++)if(g(i=-1===n?c:arguments[n]))for(o=a(i),f(v+o),r=0;r<o;r++,v++)r in i&&s(l,v,i[r]);else f(v+1),s(l,v++,i);return l.length=v,l}})},function(t,n,r){var e=r(7),o=r(9),i=r(4),c=r(21);t.exports=function(){var t=o("Symbol"),n=t&&t.prototype,r=n&&n.valueOf,u=i("toPrimitive");n&&!n[u]&&c(n,u,(function(t){return e(r,this)}),{arity:1})}},function(t,n,r){var e=r(24);t.exports=e&&!!Symbol.for&&!!Symbol.keyFor},function(t,n,r){r(3)("iterator")},function(t,n,r){"use strict";var e,o=r(1),i=r(41),c=r(2),u=r(220),a=r(31),f=r(53),s=r(96),p=o.Function,l=/MSIE .\\./.test(a)||u&&((e=o.Bun.version.split(".")).length<3||0==e[0]&&(e[1]<3||3==e[1]&&0==e[2]));t.exports=function(t,n){var r=n?2:1;return l?function(e,o){var u=s(arguments.length,1)>r,a=c(e)?e:p(e),l=u?f(arguments,r):[],v=u?function(){i(a,this,l)}:a;return n?t(v,o):t(v)}:t}},function(t,n,r){var e=r(110),o=null;function i(t){return t&&"string"!=typeof t?t.message?t.message:t.target&&t.target.error?t.target.error.message:"unknown error":t}self.onmessage=function(t){switch(t.data.type){case"init":r=t.data.msg,(o=new e(r)).init().catch((function(t){postMessage({type:"error",msg:{msg:"dbLog init error",error:i(t)}})}));break;case"fetch":o.getAllLogs().then((function(t){postMessage({type:"fetchDone",code:200,msg:t})})).catch((function(t){postMessage({type:"fetchDone",code:500,msg:i(t)})}));break;case"delete":o.deleteLogs(n).catch((function(t){postMessage({type:"deleteLogs",code:500,msg:i(t)})}));break;default:!function(t){if(!o)return;o.putLog(t).then((function(){postMessage(200)})).catch((function(t){postMessage({type:"error",msg:{msg:"putLog error",error:i(t)}})}))}(t.data)}var n,r}},function(t,n,r){var e=r(76),o=r(102),i=r(163),c=r(169);function u(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.server=null,this.expire=t.expire||72,this.name=t.name}var a=u.prototype;a.init=function(){var t=this;if(!this.server)return c.open({server:"nim-logs-"+this.name,version:1,schema:{log:{key:{keyPath:"id",autoIncrement:!0},indexes:{time:{}}}}}).then((function(n){t.server=n}))},a.putLog=function(t){var n=this;if(!this.server)return e.reject("no db server");var r=o(t).call(t,-1)[0].time-36e5*this.expire;return this.deleteLogs(r).then((function(){return n.server.add("log",t)}))},a.getAllLogs=function(){return this.server?this.server.query("log","time").all().execute().then((function(t){var n={},r=o(t).call(t,-1)[0];return n.logs=i(t).call(t,(function(t){return t.tabId+" "+t.log})).join("\\r\\n"),n.time=r&&r.time,n})):e.reject("no db server")},a.deleteLogs=function(t){return this.server?this.server.remove("log",null,"time",0,t):e.reject("no db server")},t.exports=u},function(t,n,r){var e=r(112);r(54),t.exports=e},function(t,n,r){r(113),r(71),r(72),r(137),r(154),r(155),r(156),r(101);var e=r(13);t.exports=e.Promise},function(t,n,r){r(114)},function(t,n,r){"use strict";var e=r(0),o=r(14),i=r(62),c=r(63),u=r(120),a=r(50),f=r(19),s=r(20),p=r(125),l=r(126),v=r(35),d=r(130),y=r(4),h=r(131),m=y("toStringTag"),g=Error,x=[].push,b=function(t,n){var r,e=arguments.length>2?arguments[2]:void 0,u=o(w,this);c?r=c(g(),u?i(this):w):(r=u?this:a(w),f(r,m,"Error")),void 0!==n&&f(r,"message",d(n)),h&&f(r,"stack",p(r.stack,1)),l(r,e);var s=[];return v(t,x,{that:s}),f(r,"errors",s),r};c?c(b,g):u(b,g,{name:!0});var w=b.prototype=a(g.prototype,{constructor:s(1,b),message:s(1,""),name:s(1,"AggregateError")});e({global:!0,constructor:!0,arity:2},{AggregateError:b})},function(t,n,r){var e=r(7),o=r(10),i=r(46),c=r(58),u=r(116),a=r(4),f=TypeError,s=a("toPrimitive");t.exports=function(t,n){if(!o(t)||i(t))return t;var r,a=c(t,s);if(a){if(void 0===n&&(n="default"),r=e(a,t,n),!o(r)||i(r))return r;throw f("Can't convert object to primitive value")}return void 0===n&&(n="number"),u(t,n)}},function(t,n,r){var e=r(7),o=r(2),i=r(10),c=TypeError;t.exports=function(t,n){var r,u;if("string"===n&&o(r=t.toString)&&!i(u=e(r,t)))return u;if(o(r=t.valueOf)&&!i(u=e(r,t)))return u;if("string"!==n&&o(r=t.toString)&&!i(u=e(r,t)))return u;throw c("Can't convert object to primitive value")}},function(t,n,r){var e=r(1),o=Object.defineProperty;t.exports=function(t,n){try{o(e,t,{value:n,configurable:!0,writable:!0})}catch(r){e[t]=n}return n}},function(t,n,r){var e=r(5);t.exports=!e((function(){function t(){}return t.prototype.constructor=null,Object.getPrototypeOf(new t)!==t.prototype}))},function(t,n,r){var e=r(2),o=String,i=TypeError;t.exports=function(t){if("object"==typeof t||e(t))return t;throw i("Can't set "+o(t)+" as a prototype")}},function(t,n,r){var e=r(8),o=r(121),i=r(43),c=r(16);t.exports=function(t,n,r){for(var u=o(n),a=c.f,f=i.f,s=0;s<u.length;s++){var p=u[s];e(t,p)||r&&e(r,p)||a(t,p,f(n,p))}}},function(t,n,r){var e=r(9),o=r(6),i=r(64),c=r(68),u=r(12),a=o([].concat);t.exports=e("Reflect","ownKeys")||function(t){var n=i.f(u(t)),r=c.f;return r?a(n,r(t)):n}},function(t,n,r){var e=r(18),o=r(65),i=r(26),c=function(t){return function(n,r,c){var u,a=e(n),f=i(a),s=o(c,f);if(t&&r!=r){for(;f>s;)if((u=a[s++])!=u)return!0}else for(;f>s;s++)if((t||s in a)&&a[s]===r)return t||s||0;return!t&&-1}};t.exports={includes:c(!0),indexOf:c(!1)}},function(t,n){var r=Math.ceil,e=Math.floor;t.exports=Math.trunc||function(t){var n=+t;return(n>0?e:r)(n)}},function(t,n,r){var e=r(66),o=Math.min;t.exports=function(t){return t>0?o(e(t),9007199254740991):0}},function(t,n,r){var e=r(6),o=Error,i=e("".replace),c=String(o("zxcasd").stack),u=/\\n\\s*at [^:]*:[^\\n]*/,a=u.test(c);t.exports=function(t,n){if(a&&"string"==typeof t&&!o.prepareStackTrace)for(;n--;)t=i(t,u,"");return t}},function(t,n,r){var e=r(10),o=r(19);t.exports=function(t,n){e(n)&&"cause"in n&&o(t,"cause",n.cause)}},function(t,n,r){var e=r(4),o=r(27),i=e("iterator"),c=Array.prototype;t.exports=function(t){return void 0!==t&&(o.Array===t||c[i]===t)}},function(t,n,r){var e=r(7),o=r(17),i=r(12),c=r(32),u=r(89),a=TypeError;t.exports=function(t,n){var r=arguments.length<2?u(t):n;if(o(r))return i(e(r,t));throw a(c(t)+" is not iterable")}},function(t,n,r){var e=r(7),o=r(12),i=r(58);t.exports=function(t,n,r){var c,u;o(t);try{if(!(c=i(t,"return"))){if("throw"===n)throw r;return r}c=e(c,t)}catch(t){u=!0,c=t}if("throw"===n)throw r;if(u)throw c;return o(c),r}},function(t,n,r){var e=r(36);t.exports=function(t,n){return void 0===t?arguments.length<2?"":n:e(t)}},function(t,n,r){var e=r(5),o=r(20);t.exports=!e((function(){var t=Error("a");return!("stack"in t)||(Object.defineProperty(t,"stack",o(1,7)),7!==t.stack)}))},function(t,n){t.exports=function(){}},function(t,n,r){var e=r(1),o=r(2),i=e.WeakMap;t.exports=o(i)&&/native code/.test(String(i))},function(t,n,r){var e=r(11),o=r(8),i=Function.prototype,c=e&&Object.getOwnPropertyDescriptor,u=o(i,"name"),a=u&&"something"===function(){}.name,f=u&&(!e||e&&c(i,"name").configurable);t.exports={EXISTS:u,PROPER:a,CONFIGURABLE:f}},function(t,n,r){"use strict";var e=r(91).IteratorPrototype,o=r(50),i=r(20),c=r(29),u=r(27),a=function(){return this};t.exports=function(t,n,r,f){var s=n+" Iterator";return t.prototype=o(e,{next:i(+!f,r)}),c(t,s,!1,!0),u[s]=a,t}},function(t,n,r){"use strict";var e=r(70),o=r(28);t.exports=e?{}.toString:function(){return"[object "+o(this)+"]"}},function(t,n,r){r(138),r(148),r(150),r(151),r(152),r(153)},function(t,n,r){"use strict";var e,o,i,c=r(0),u=r(15),a=r(52),f=r(1),s=r(7),p=r(21),l=r(63),v=r(29),d=r(139),y=r(17),h=r(2),m=r(10),g=r(140),x=r(93),b=r(95).set,w=r(142),S=r(145),j=r(37),O=r(146),P=r(51),T=r(30),A=r(38),E=r(22),k=A.CONSTRUCTOR,I=A.REJECTION_EVENT,D=A.SUBCLASSING,L=P.getterFor("Promise"),_=P.set,C=T&&T.prototype,M=T,R=C,N=f.TypeError,F=f.document,B=f.process,G=E.f,U=G,z=!!(F&&F.createEvent&&f.dispatchEvent),V=function(t){var n;return!(!m(t)||!h(n=t.then))&&n},q=function(t,n){var r,e,o,i=n.value,c=1==n.state,u=c?t.ok:t.fail,a=t.resolve,f=t.reject,p=t.domain;try{u?(c||(2===n.rejection&&Y(n),n.rejection=1),!0===u?r=i:(p&&p.enter(),r=u(i),p&&(p.exit(),o=!0)),r===t.promise?f(N("Promise-chain cycle")):(e=V(r))?s(e,r,a,f):a(r)):f(i)}catch(t){p&&!o&&p.exit(),f(t)}},H=function(t,n){t.notified||(t.notified=!0,w((function(){for(var r,e=t.reactions;r=e.get();)q(r,t);t.notified=!1,n&&!t.rejection&&K(t)})))},J=function(t,n,r){var e,o;z?((e=F.createEvent("Event")).promise=n,e.reason=r,e.initEvent(t,!1,!0),f.dispatchEvent(e)):e={promise:n,reason:r},!I&&(o=f["on"+t])?o(e):"unhandledrejection"===t&&S("Unhandled promise rejection",r)},K=function(t){s(b,f,(function(){var n,r=t.facade,e=t.value;if(W(t)&&(n=j((function(){a?B.emit("unhandledRejection",e,r):J("unhandledrejection",r,e)})),t.rejection=a||W(t)?2:1,n.error))throw n.value}))},W=function(t){return 1!==t.rejection&&!t.parent},Y=function(t){s(b,f,(function(){var n=t.facade;a?B.emit("rejectionHandled",n):J("rejectionhandled",n,t.value)}))},X=function(t,n,r){return function(e){t(n,e,r)}},$=function(t,n,r){t.done||(t.done=!0,r&&(t=r),t.value=n,t.state=2,H(t,!0))},Q=function(t,n,r){if(!t.done){t.done=!0,r&&(t=r);try{if(t.facade===n)throw N("Promise can't be resolved itself");var e=V(n);e?w((function(){var r={done:!1};try{s(e,n,X(Q,r,t),X($,r,t))}catch(n){$(r,n,t)}})):(t.value=n,t.state=1,H(t,!1))}catch(n){$({done:!1},n,t)}}};if(k&&(R=(M=function(t){g(this,R),y(t),s(e,this);var n=L(this);try{t(X(Q,n),X($,n))}catch(t){$(n,t)}}).prototype,(e=function(t){_(this,{type:"Promise",done:!1,notified:!1,parent:!1,reactions:new O,rejection:!1,state:0,value:void 0})}).prototype=p(R,"then",(function(t,n){var r=L(this),e=G(x(this,M));return r.parent=!0,e.ok=!h(t)||t,e.fail=h(n)&&n,e.domain=a?B.domain:void 0,0==r.state?r.reactions.add(e):w((function(){q(e,r)})),e.promise})),o=function(){var t=new e,n=L(t);this.promise=t,this.resolve=X(Q,n),this.reject=X($,n)},E.f=G=function(t){return t===M||void 0===t?new o(t):U(t)},!u&&h(T)&&C!==Object.prototype)){i=C.then,D||p(C,"then",(function(t,n){var r=this;return new M((function(t,n){s(i,r,t,n)})).then(t,n)}),{unsafe:!0});try{delete C.constructor}catch(t){}l&&l(C,R)}c({global:!0,constructor:!0,wrap:!0,forced:k},{Promise:M}),v(M,"Promise",!1,!0),d("Promise")},function(t,n,r){"use strict";var e=r(9),o=r(16),i=r(4),c=r(11),u=i("species");t.exports=function(t){var n=e(t),r=o.f;c&&n&&!n[u]&&r(n,u,{configurable:!0,get:function(){return this}})}},function(t,n,r){var e=r(14),o=TypeError;t.exports=function(t,n){if(e(n,t))return t;throw o("Incorrect invocation")}},function(t,n,r){var e=r(73),o=r(32),i=TypeError;t.exports=function(t){if(e(t))return t;throw i(o(t)+" is not a constructor")}},function(t,n,r){var e,o,i,c,u,a,f,s,p=r(1),l=r(34),v=r(43).f,d=r(95).set,y=r(97),h=r(143),m=r(144),g=r(52),x=p.MutationObserver||p.WebKitMutationObserver,b=p.document,w=p.process,S=p.Promise,j=v(p,"queueMicrotask"),O=j&&j.value;O||(e=function(){var t,n;for(g&&(t=w.domain)&&t.exit();o;){n=o.fn,o=o.next;try{n()}catch(t){throw o?c():i=void 0,t}}i=void 0,t&&t.enter()},y||g||m||!x||!b?!h&&S&&S.resolve?((f=S.resolve(void 0)).constructor=S,s=l(f.then,f),c=function(){s(e)}):g?c=function(){w.nextTick(e)}:(d=l(d,p),c=function(){d(e)}):(u=!0,a=b.createTextNode(""),new x(e).observe(a,{characterData:!0}),c=function(){a.data=u=!u})),t.exports=O||function(t){var n={fn:t,next:void 0};i&&(i.next=n),o||(o=n,c()),i=n}},function(t,n,r){var e=r(31),o=r(1);t.exports=/ipad|iphone|ipod/i.test(e)&&void 0!==o.Pebble},function(t,n,r){var e=r(31);t.exports=/web0s(?!.*chrome)/i.test(e)},function(t,n,r){var e=r(1);t.exports=function(t,n){var r=e.console;r&&r.error&&(1==arguments.length?r.error(t):r.error(t,n))}},function(t,n){var r=function(){this.head=null,this.tail=null};r.prototype={add:function(t){var n={item:t,next:null};this.head?this.tail.next=n:this.head=n,this.tail=n},get:function(){var t=this.head;if(t)return this.head=t.next,this.tail===t&&(this.tail=null),t.item}},t.exports=r},function(t,n,r){var e=r(98),o=r(52);t.exports=!e&&!o&&"object"==typeof window&&"object"==typeof document},function(t,n,r){"use strict";var e=r(0),o=r(7),i=r(17),c=r(22),u=r(37),a=r(35);e({target:"Promise",stat:!0,forced:r(99)},{all:function(t){var n=this,r=c.f(n),e=r.resolve,f=r.reject,s=u((function(){var r=i(n.resolve),c=[],u=0,s=1;a(t,(function(t){var i=u++,a=!1;s++,o(r,n,t).then((function(t){a||(a=!0,c[i]=t,--s||e(c))}),f)})),--s||e(c)}));return s.error&&f(s.value),r.promise}})},function(t,n,r){var e=r(4)("iterator"),o=!1;try{var i=0,c={next:function(){return{done:!!i++}},return:function(){o=!0}};c[e]=function(){return this},Array.from(c,(function(){throw 2}))}catch(t){}t.exports=function(t,n){if(!n&&!o)return!1;var r=!1;try{var i={};i[e]=function(){return{next:function(){return{done:r=!0}}}},t(i)}catch(t){}return r}},function(t,n,r){"use strict";var e=r(0),o=r(15),i=r(38).CONSTRUCTOR,c=r(30),u=r(9),a=r(2),f=r(21),s=c&&c.prototype;if(e({target:"Promise",proto:!0,forced:i,real:!0},{catch:function(t){return this.then(void 0,t)}}),!o&&a(c)){var p=u("Promise").prototype.catch;s.catch!==p&&f(s,"catch",p,{unsafe:!0})}},function(t,n,r){"use strict";var e=r(0),o=r(7),i=r(17),c=r(22),u=r(37),a=r(35);e({target:"Promise",stat:!0,forced:r(99)},{race:function(t){var n=this,r=c.f(n),e=r.reject,f=u((function(){var c=i(n.resolve);a(t,(function(t){o(c,n,t).then(r.resolve,e)}))}));return f.error&&e(f.value),r.promise}})},function(t,n,r){"use strict";var e=r(0),o=r(7),i=r(22);e({target:"Promise",stat:!0,forced:r(38).CONSTRUCTOR},{reject:function(t){var n=i.f(this);return o(n.reject,void 0,t),n.promise}})},function(t,n,r){"use strict";var e=r(0),o=r(9),i=r(15),c=r(30),u=r(38).CONSTRUCTOR,a=r(100),f=o("Promise"),s=i&&!u;e({target:"Promise",stat:!0,forced:i||u},{resolve:function(t){return a(s&&this===f?c:this,t)}})},function(t,n,r){"use strict";var e=r(0),o=r(7),i=r(17),c=r(22),u=r(37),a=r(35);e({target:"Promise",stat:!0},{allSettled:function(t){var n=this,r=c.f(n),e=r.resolve,f=r.reject,s=u((function(){var r=i(n.resolve),c=[],u=0,f=1;a(t,(function(t){var i=u++,a=!1;f++,o(r,n,t).then((function(t){a||(a=!0,c[i]={status:"fulfilled",value:t},--f||e(c))}),(function(t){a||(a=!0,c[i]={status:"rejected",reason:t},--f||e(c))}))})),--f||e(c)}));return s.error&&f(s.value),r.promise}})},function(t,n,r){"use strict";var e=r(0),o=r(7),i=r(17),c=r(9),u=r(22),a=r(37),f=r(35);e({target:"Promise",stat:!0},{any:function(t){var n=this,r=c("AggregateError"),e=u.f(n),s=e.resolve,p=e.reject,l=a((function(){var e=i(n.resolve),c=[],u=0,a=1,l=!1;f(t,(function(t){var i=u++,f=!1;a++,o(e,n,t).then((function(t){f||l||(l=!0,s(t))}),(function(t){f||l||(f=!0,c[i]=t,--a||p(new r(c,"No one promise resolved")))}))})),--a||p(new r(c,"No one promise resolved"))}));return l.error&&p(l.value),e.promise}})},function(t,n,r){"use strict";var e=r(0),o=r(15),i=r(30),c=r(5),u=r(9),a=r(2),f=r(93),s=r(100),p=r(21),l=i&&i.prototype;if(e({target:"Promise",proto:!0,real:!0,forced:!!i&&c((function(){l.finally.call({then:function(){}},(function(){}))}))},{finally:function(t){var n=f(this,u("Promise")),r=a(t);return this.then(r?function(r){return s(n,t()).then((function(){return r}))}:t,r?function(r){return s(n,t()).then((function(){throw r}))}:t)}}),!o&&a(i)){var v=u("Promise").prototype.finally;l.finally!==v&&p(l,"finally",v,{unsafe:!0})}},function(t,n,r){var e=r(6),o=r(66),i=r(36),c=r(57),u=e("".charAt),a=e("".charCodeAt),f=e("".slice),s=function(t){return function(n,r){var e,s,p=i(c(n)),l=o(r),v=p.length;return l<0||l>=v?t?"":void 0:(e=a(p,l))<55296||e>56319||l+1===v||(s=a(p,l+1))<56320||s>57343?t?u(p,l):e:t?f(p,l,l+2):s-56320+(e-55296<<10)+65536}};t.exports={codeAt:s(!1),charAt:s(!0)}},function(t,n){t.exports={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}},function(t,n,r){var e=r(160);t.exports=e},function(t,n,r){var e=r(14),o=r(161),i=Array.prototype;t.exports=function(t){var n=t.slice;return t===i||e(i,t)&&n===i.slice?o:n}},function(t,n,r){r(162);var e=r(40);t.exports=e("Array").slice},function(t,n,r){"use strict";var e=r(0),o=r(39),i=r(73),c=r(10),u=r(65),a=r(26),f=r(18),s=r(74),p=r(4),l=r(55),v=r(53),d=l("slice"),y=p("species"),h=Array,m=Math.max;e({target:"Array",proto:!0,forced:!d},{slice:function(t,n){var r,e,p,l=f(this),d=a(l),g=u(t,d),x=u(void 0===n?d:n,d);if(o(l)&&(r=l.constructor,(i(r)&&(r===h||o(r.prototype))||c(r)&&null===(r=r[y]))&&(r=void 0),r===h||void 0===r))return v(l,g,x);for(e=new(void 0===r?h:r)(m(x-g,0)),p=0;g<x;g++,p++)g in l&&s(e,p,l[g]);return e.length=p,e}})},function(t,n,r){t.exports=r(164)},function(t,n,r){var e=r(165);t.exports=e},function(t,n,r){var e=r(14),o=r(166),i=Array.prototype;t.exports=function(t){var n=t.map;return t===i||e(i,t)&&n===i.map?o:n}},function(t,n,r){r(167);var e=r(40);t.exports=e("Array").map},function(t,n,r){"use strict";var e=r(0),o=r(56).map;e({target:"Array",proto:!0,forced:!r(55)("map")},{map:function(t){return o(this,t,arguments.length>1?arguments[1]:void 0)}})},function(t,n,r){var e=r(39),o=r(73),i=r(10),c=r(4)("species"),u=Array;t.exports=function(t){var n;return e(t)&&(n=t.constructor,(o(n)&&(n===u||e(n.prototype))||i(n)&&null===(n=n[c]))&&(n=void 0)),void 0===n?u:n}},function(t,n,r){(function(e){var o,i=r(170),c=r(76),u=r(216),a=r(102),f=r(222),s=r(226),p=r(233),l=r(237),v=r(241),d=r(245);!function(y,h){"use strict";var m,g=(y=void 0!==y?y:"undefined"!=typeof self?self:void 0!==e?e:{}).IDBKeyRange||y.webkitIDBKeyRange,x="readonly",b="readwrite",w=Object.prototype.hasOwnProperty,S=function(){if(!m&&!(m=y.indexedDB||y.webkitIndexedDB||y.mozIndexedDB||y.oIndexedDB||y.msIndexedDB||(null===y.indexedDB&&y.shimIndexedDB?y.shimIndexedDB:void 0)))throw"IndexedDB required";return m},j=!1,O=navigator&&!navigator.userAgentData&&/Safari\\//.test(navigator.userAgent)&&!/Chrom(e|ium)\\//.test(navigator.userAgent),P=function(t){return t},T=function(t){var n;return a(n=Object.prototype.toString.call(t)).call(n,8,-1).toLowerCase()},A=function(t){return"function"==typeof t},E=function(t){return"number"===T(t)},k=function(t){return"array"===T(t)},I=function(t){return void 0===t},D=function(t,n){var r=this,e=!1;this.name=n,this.getIndexedDB=function(){return t},this.add=function(n){if(e)throw"Database has been closed";for(var o=[],i=0,u=0;u<arguments.length-1;u++)if(f(arguments[u+1]))for(var a=0;a<arguments[u+1].length;a++)o[i]=arguments[u+1][a],i++;else o[i]=arguments[u+1],i++;var l=t.transaction(n,b),v=l.objectStore(n);return new c((function(t,n){s(o).call(o,(function(t){var r;if(t.item&&t.key){var e=t.key;t=t.item,r=v.add(t,e)}else r=v.add(t);r.onsuccess=function(r){try{var e=r.target,o=e.source.keyPath;null===o&&(o="__id__"),p(t,o,{value:e.result,enumerable:!0})}catch(t){n(t)}}})),l.oncomplete=function(){t(o,r)},l.onerror=function(t){t.preventDefault(),n(t)},l.onabort=function(t){n(t)}}))},this.updateAndDelete=function(n,r,o){if(e)throw"Database has been closed";var i=t.transaction(n,b),u=i.objectStore(n),a=u.keyPath;return new c((function(t,n){s(r).call(r,(function(t){if(t.item&&t.key){var n=t.key;t=t.item,u.put(t,n)}else u.put(t)})),s(o).call(o,(function(t){u.delete(t[a])})),i.oncomplete=function(){t([r,o])},i.onerror=function(t){n(t)}}))},this.update=function(n){if(e)throw"Database has been closed";for(var o,i=[],u=1;u<arguments.length;u++)f(o=arguments[u])?i=l(i).call(i,o):i.push(o);var a=t.transaction(n,b),p=a.objectStore(n);p.keyPath;return new c((function(t,n){s(i).call(i,(function(t){var n;if(t.item&&t.key){var r=t.key;t=t.item,n=p.put(t,r)}else n=p.put(t);n.onsuccess=function(t){},n.onerror=function(t){}})),a.oncomplete=function(){t(i,r)},a.onerror=function(t){n(t)},a.onabort=function(t){n(t)}}))},this.remove=function(n,r,o,i,u,a,p){if(e)throw"Database has been closed";var l=t.transaction(n,b),v=l.objectStore(n);return new c((function(t,n){function e(t){return null==t}var c;(e(i)&&(i=-1/0),e(u)&&(u=1/0),null===r||f(r)||(r=[r]),e(o))?null!==r?s(r).call(r,(function(t){v.delete(t)})):v.delete(range=g.bound(i,u,a,p)):(c=null!==r?g.only(r[0]):g.bound(i,u,a,p),v.index(o).openCursor(c).onsuccess=function(t){try{var r=t.target.result;if(!r)return;r.delete(),r.continue()}catch(t){n(t)}});l.oncomplete=function(){t()},l.onerror=function(t){n(t)},l.onabort=function(t){n(t)}}))},this.clear=function(n){if(e)throw"Database has been closed";var r=t.transaction(n,b);r.objectStore(n).clear();return new c((function(t,n){r.oncomplete=function(){t()},r.onerror=function(t){n(t)}}))},this.close=function(){e||(t.close(),e=!0,delete C[n])},this.get=function(n,r){if(e)throw"Database has been closed";var o=t.transaction(n),i=o.objectStore(n).get(r);return new c((function(t,n){i.onsuccess=function(n){t(n.target.result)},o.onerror=function(t){n(t)}}))},this.query=function(n,r){if(e)throw"Database has been closed";return new L(n,t,r)},this.count=function(n,r){if(e)throw"Database has been closed";t.transaction(n).objectStore(n)};for(var o=0,i=t.objectStoreNames.length;o<i;o++)!function(t){for(var n in r[t]={},r)w.call(r,n)&&"close"!==n&&(r[t][n]=function(n){return function(){var e,o=l(e=[t]).call(e,a([]).call(arguments,0));return r[n].apply(r,o)}}(n))}(t.objectStoreNames[o])},L=function(t,n,r){var e,o=this,u=!1,f=!1,p=function(e,o,a,p,l,d,y){return new c((function(c,h){var m=u||f?b:x,w=n.transaction(t,m),S=w.objectStore(t),j=r?S.index(r):S,O=e?g[e].apply(null,o):null,P=[],T=[O],E=0;l=l||null,d=d||[],"count"!==a&&T.push(p||"next");var k=!!u&&v(u);j[a].apply(j,T).onsuccess=function(t){try{var n=t.target.result;if(i(n)===i(0))P=n;else if(n)if(null!==l&&l[0]>E)E=l[0],n.advance(l[0]);else if(null!==l&&E>=l[0]+l[1]);else{var r=!0,e="value"in n?n.value:n.key;s(d).call(d,(function(t){t&&t.length&&(2===t.length?r=r&&e[t[0]]===t[1]:A(t[0])&&(r=r&&t[0].apply(void 0,[e])))})),r&&(E++,P.push(y(e)),f?n.delete():u&&(e=function(t){for(var n=0;n<k.length;n++){var r=k[n],e=u[r];e instanceof Function&&(e=e(t)),t[r]=e}return t}(e),n.update(e))),n.continue()}}catch(t){h(t)}},w.oncomplete=function(){c(P)},w.onerror=function(t){h(t)},w.onabort=function(t){h(t)}}))},l=function(t,n){var r="next",e="openCursor",o=[],i=null,c=P,s=!1,l=function(){return p(t,n,e,s?r+"unique":r,i,o,c)},v=function(){return r=null,e="count",{execute:l}},d=function t(){return 1==(i=k(arguments[0])?arguments[0]:a(Array.prototype).call(arguments,0,2)).length&&i.unshift(0),E(i[1])||(i=null),{execute:l,count:v,keys:y,filter:h,asc:m,desc:g,distinct:x,modify:b,limit:t,map:w,remove:S}},y=function t(n){return(n=!!I(n)||!!n)&&(e="openKeyCursor"),{execute:l,keys:t,filter:h,asc:m,desc:g,distinct:x,modify:b,limit:d,map:w,remove:S}},h=function t(){return o.push(a(Array.prototype).call(arguments,0,2)),{execute:l,count:v,keys:y,filter:t,asc:m,desc:g,distinct:x,modify:b,limit:d,map:w,remove:S}},m=function t(n){return n=!!I(n)||!!n,r=n?"next":"prev",{execute:l,count:v,keys:y,filter:h,asc:t,desc:g,distinct:x,modify:b,limit:d,map:w,remove:S}},g=function t(n){return n=!!I(n)||!!n,r=n?"prev":"next",{execute:l,count:v,keys:y,filter:h,asc:m,desc:t,distinct:x,modify:b,limit:d,map:w,remove:S}},x=function t(n){return n=!!I(n)||!!n,s=n,{execute:l,count:v,keys:y,filter:h,asc:m,desc:g,distinct:t,modify:b,limit:d,map:w,remove:S}},b=function t(n){return u=n,{execute:l,count:v,keys:y,filter:h,asc:m,desc:g,distinct:x,modify:t,limit:d,map:w,remove:S}},w=function t(n){return A(n)&&(c=n),{execute:l,count:v,keys:y,filter:h,asc:m,desc:g,distinct:x,modify:b,limit:d,map:t,remove:S}},S=function t(n){return n=!!I(n)||!!n,f=n,{execute:l,count:v,keys:y,filter:h,asc:m,desc:g,distinct:x,modify:b,limit:d,map:w,remove:t}};return{execute:l,count:v,keys:y,filter:h,asc:m,desc:g,distinct:x,modify:b,limit:d,map:w,remove:S}};s(e="only bound upperBound lowerBound".split(" ")).call(e,(function(t){o[t]=function(){return new l(t,arguments)}})),this.filter=function(){var t=new l(null,null);return d(t).apply(t,arguments)},this.all=function(){var t;return d(t=this).call(t)}},_=function(t,n,r,e){var o=t.target.result,i=new D(o,n);return C[n]=o,c.resolve(i)},C={},M={version:"0.10.2",open:function(t){var n;return new c((function(r,e){var o;C[t.server]?_({target:{result:C[t.server]}},t.server,t.version,t.schema).then(r,e):(j?c.resolve():O&&S().databases?new c((function(t){var n=function(){return S().databases().finally(t)};o=u(n,100),n()})).finally((function(){j=!0,clearInterval(o)})):(j=!0,c.resolve())).then((function(){try{n=S().open(t.server,t.version)}catch(t){e(t)}n.onsuccess=function(n){_(n,t.server,t.version,t.schema).then(r,e)},n.onupgradeneeded=function(n){!function(t,n,r){for(var e in"function"==typeof n&&(n=n()),n){var o,i=n[e];for(var c in o=!w.call(n,e)||r.objectStoreNames.contains(e)?t.currentTarget.transaction.objectStore(e):r.createObjectStore(e,i.key),i.indexes){var u=i.indexes[c];try{o.index(c)}catch(t){o.createIndex(c,u.key||c,v(u).length?u:{unique:!1})}}}}(n,t.schema,n.target.result)},n.onerror=function(t){e(t)}}))}))},remove:function(t){return new c((function(n,r){if(!t)return n();var e,o;i(t)===D&&(t=t.name),"string"==typeof t&&(e=C[t]),e&&"function"==typeof e.close&&e.close();try{o=S().deleteDatabase(t)}catch(t){r(t)}o.onsuccess=function(r){delete C[t],n(t)},o.onerror=function(t){r(t)},o.onblocked=function(t){r(t)}}))}};void 0!==t.exports?t.exports=M:void 0===(o=function(){return M}.call(n,r,n,t))||(t.exports=o)}(void 0)}).call(this,r(77))},function(t,n,r){var e=r(171),o=r(210);function i(n){return t.exports=i="function"==typeof e&&"symbol"==typeof o?function(t){return typeof t}:function(t){return t&&"function"==typeof e&&t.constructor===e&&t!==e.prototype?"symbol":typeof t},t.exports.__esModule=!0,t.exports.default=t.exports,i(n)}t.exports=i,t.exports.__esModule=!0,t.exports.default=t.exports},function(t,n,r){t.exports=r(172)},function(t,n,r){t.exports=r(173)},function(t,n,r){var e=r(174);r(203),r(204),r(205),r(206),r(207),r(208),r(209),t.exports=e},function(t,n,r){var e=r(175);r(202),t.exports=e},function(t,n,r){var e=r(176);r(54),t.exports=e},function(t,n,r){r(104),r(72),r(178),r(186),r(187),r(188),r(189),r(107),r(190),r(191),r(192),r(193),r(194),r(195),r(196),r(197),r(198),r(199),r(200),r(201);var e=r(13);t.exports=e.Symbol},function(t,n){var r=TypeError;t.exports=function(t){if(t>9007199254740991)throw r("Maximum allowed index exceeded");return t}},function(t,n,r){r(179),r(182),r(183),r(184),r(185)},function(t,n,r){"use strict";var e=r(0),o=r(1),i=r(7),c=r(6),u=r(15),a=r(11),f=r(24),s=r(5),p=r(8),l=r(14),v=r(12),d=r(18),y=r(45),h=r(36),m=r(20),g=r(50),x=r(69),b=r(64),w=r(180),S=r(68),j=r(43),O=r(16),P=r(87),T=r(80),A=r(21),E=r(33),k=r(48),I=r(49),D=r(60),L=r(4),_=r(75),C=r(3),M=r(105),R=r(29),N=r(51),F=r(56).forEach,B=k("hidden"),G=N.set,U=N.getterFor("Symbol"),z=Object.prototype,V=o.Symbol,q=V&&V.prototype,H=o.TypeError,J=o.QObject,K=j.f,W=O.f,Y=w.f,X=T.f,$=c([].push),Q=E("symbols"),Z=E("op-symbols"),tt=E("wks"),nt=!J||!J.prototype||!J.prototype.findChild,rt=a&&s((function(){return 7!=g(W({},"a",{get:function(){return W(this,"a",{value:7}).a}})).a}))?function(t,n,r){var e=K(z,n);e&&delete z[n],W(t,n,r),e&&t!==z&&W(z,n,e)}:W,et=function(t,n){var r=Q[t]=g(q);return G(r,{type:"Symbol",tag:t,description:n}),a||(r.description=n),r},ot=function(t,n,r){t===z&&ot(Z,n,r),v(t);var e=y(n);return v(r),p(Q,e)?(r.enumerable?(p(t,B)&&t[B][e]&&(t[B][e]=!1),r=g(r,{enumerable:m(0,!1)})):(p(t,B)||W(t,B,m(1,{})),t[B][e]=!0),rt(t,e,r)):W(t,e,r)},it=function(t,n){v(t);var r=d(n),e=x(r).concat(ft(r));return F(e,(function(n){a&&!i(ct,r,n)||ot(t,n,r[n])})),t},ct=function(t){var n=y(t),r=i(X,this,n);return!(this===z&&p(Q,n)&&!p(Z,n))&&(!(r||!p(this,n)||!p(Q,n)||p(this,B)&&this[B][n])||r)},ut=function(t,n){var r=d(t),e=y(n);if(r!==z||!p(Q,e)||p(Z,e)){var o=K(r,e);return!o||!p(Q,e)||p(r,B)&&r[B][e]||(o.enumerable=!0),o}},at=function(t){var n=Y(d(t)),r=[];return F(n,(function(t){p(Q,t)||p(I,t)||$(r,t)})),r},ft=function(t){var n=t===z,r=Y(n?Z:d(t)),e=[];return F(r,(function(t){!p(Q,t)||n&&!p(z,t)||$(e,Q[t])})),e};f||(A(q=(V=function(){if(l(q,this))throw H("Symbol is not a constructor");var t=arguments.length&&void 0!==arguments[0]?h(arguments[0]):void 0,n=D(t),r=function(t){this===z&&i(r,Z,t),p(this,B)&&p(this[B],n)&&(this[B][n]=!1),rt(this,n,m(1,t))};return a&&nt&&rt(z,n,{configurable:!0,set:r}),et(n,t)}).prototype,"toString",(function(){return U(this).tag})),A(V,"withoutSetter",(function(t){return et(D(t),t)})),T.f=ct,O.f=ot,P.f=it,j.f=ut,b.f=w.f=at,S.f=ft,_.f=function(t){return et(L(t),t)},a&&(W(q,"description",{configurable:!0,get:function(){return U(this).description}}),u||A(z,"propertyIsEnumerable",ct,{unsafe:!0}))),e({global:!0,constructor:!0,wrap:!0,forced:!f,sham:!f},{Symbol:V}),F(x(tt),(function(t){C(t)})),e({target:"Symbol",stat:!0,forced:!f},{useSetter:function(){nt=!0},useSimple:function(){nt=!1}}),e({target:"Object",stat:!0,forced:!f,sham:!a},{create:function(t,n){return void 0===n?g(t):it(g(t),n)},defineProperty:ot,defineProperties:it,getOwnPropertyDescriptor:ut}),e({target:"Object",stat:!0,forced:!f},{getOwnPropertyNames:at}),M(),R(V,"Symbol"),I[B]=!0},function(t,n,r){var e=r(23),o=r(18),i=r(64).f,c=r(181),u="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];t.exports.f=function(t){return u&&"Window"==e(t)?function(t){try{return i(t)}catch(t){return c(u)}}(t):i(o(t))}},function(t,n,r){var e=r(65),o=r(26),i=r(74),c=Array,u=Math.max;t.exports=function(t,n,r){for(var a=o(t),f=e(n,a),s=e(void 0===r?a:r,a),p=c(u(s-f,0)),l=0;f<s;f++,l++)i(p,l,t[f]);return p.length=l,p}},function(t,n,r){var e=r(0),o=r(9),i=r(8),c=r(36),u=r(33),a=r(106),f=u("string-to-symbol-registry"),s=u("symbol-to-string-registry");e({target:"Symbol",stat:!0,forced:!a},{for:function(t){var n=c(t);if(i(f,n))return f[n];var r=o("Symbol")(n);return f[n]=r,s[r]=n,r}})},function(t,n,r){var e=r(0),o=r(8),i=r(46),c=r(32),u=r(33),a=r(106),f=u("symbol-to-string-registry");e({target:"Symbol",stat:!0,forced:!a},{keyFor:function(t){if(!i(t))throw TypeError(c(t)+" is not a symbol");if(o(f,t))return f[t]}})},function(t,n,r){var e=r(0),o=r(9),i=r(41),c=r(7),u=r(6),a=r(5),f=r(39),s=r(2),p=r(10),l=r(46),v=r(53),d=r(24),y=o("JSON","stringify"),h=u(/./.exec),m=u("".charAt),g=u("".charCodeAt),x=u("".replace),b=u(1..toString),w=/[\\uD800-\\uDFFF]/g,S=/^[\\uD800-\\uDBFF]$/,j=/^[\\uDC00-\\uDFFF]$/,O=!d||a((function(){var t=o("Symbol")();return"[null]"!=y([t])||"{}"!=y({a:t})||"{}"!=y(Object(t))})),P=a((function(){return'"\\\\udf06\\\\ud834"'!==y("\\udf06\\ud834")||'"\\\\udead"'!==y("\\udead")})),T=function(t,n){var r=v(arguments),e=n;if((p(n)||void 0!==t)&&!l(t))return f(n)||(n=function(t,n){if(s(e)&&(n=c(e,this,t,n)),!l(n))return n}),r[1]=n,i(y,null,r)},A=function(t,n,r){var e=m(r,n-1),o=m(r,n+1);return h(S,t)&&!h(j,o)||h(j,t)&&!h(S,e)?"\\\\u"+b(g(t,0),16):t};y&&e({target:"JSON",stat:!0,arity:3,forced:O||P},{stringify:function(t,n,r){var e=v(arguments),o=i(O?T:y,null,e);return P&&"string"==typeof o?x(o,w,A):o}})},function(t,n,r){var e=r(0),o=r(24),i=r(5),c=r(68),u=r(25);e({target:"Object",stat:!0,forced:!o||i((function(){c.f(1)}))},{getOwnPropertySymbols:function(t){var n=c.f;return n?n(u(t)):[]}})},function(t,n,r){r(3)("asyncIterator")},function(t,n){},function(t,n,r){r(3)("hasInstance")},function(t,n,r){r(3)("isConcatSpreadable")},function(t,n,r){r(3)("match")},function(t,n,r){r(3)("matchAll")},function(t,n,r){r(3)("replace")},function(t,n,r){r(3)("search")},function(t,n,r){r(3)("species")},function(t,n,r){r(3)("split")},function(t,n,r){var e=r(3),o=r(105);e("toPrimitive"),o()},function(t,n,r){var e=r(9),o=r(3),i=r(29);o("toStringTag"),i(e("Symbol"),"Symbol")},function(t,n,r){r(3)("unscopables")},function(t,n,r){var e=r(1);r(29)(e.JSON,"JSON",!0)},function(t,n){},function(t,n){},function(t,n,r){r(3)("dispose")},function(t,n,r){r(3)("asyncDispose")},function(t,n,r){r(3)("matcher")},function(t,n,r){r(3)("metadataKey")},function(t,n,r){r(3)("observable")},function(t,n,r){r(3)("metadata")},function(t,n,r){r(3)("patternMatch")},function(t,n,r){r(3)("replaceAll")},function(t,n,r){t.exports=r(211)},function(t,n,r){t.exports=r(212)},function(t,n,r){var e=r(213);t.exports=e},function(t,n,r){var e=r(214);t.exports=e},function(t,n,r){var e=r(215);r(54),t.exports=e},function(t,n,r){r(71),r(72),r(101),r(107);var e=r(75);t.exports=e.f("iterator")},function(t,n,r){t.exports=r(217)},function(t,n,r){r(218);var e=r(13);t.exports=e.setInterval},function(t,n,r){r(219),r(221)},function(t,n,r){var e=r(0),o=r(1),i=r(108)(o.setInterval,!0);e({global:!0,bind:!0,forced:o.setInterval!==i},{setInterval:i})},function(t,n){t.exports="function"==typeof Bun&&Bun&&"string"==typeof Bun.version},function(t,n,r){var e=r(0),o=r(1),i=r(108)(o.setTimeout,!0);e({global:!0,bind:!0,forced:o.setTimeout!==i},{setTimeout:i})},function(t,n,r){t.exports=r(223)},function(t,n,r){var e=r(224);t.exports=e},function(t,n,r){r(225);var e=r(13);t.exports=e.Array.isArray},function(t,n,r){r(0)({target:"Array",stat:!0},{isArray:r(39)})},function(t,n,r){t.exports=r(227)},function(t,n,r){r(54);var e=r(28),o=r(8),i=r(14),c=r(228),u=Array.prototype,a={DOMTokenList:!0,NodeList:!0};t.exports=function(t){var n=t.forEach;return t===u||i(u,t)&&n===u.forEach||o(a,e(t))?c:n}},function(t,n,r){var e=r(229);t.exports=e},function(t,n,r){r(230);var e=r(40);t.exports=e("Array").forEach},function(t,n,r){"use strict";var e=r(0),o=r(231);e({target:"Array",proto:!0,forced:[].forEach!=o},{forEach:o})},function(t,n,r){"use strict";var e=r(56).forEach,o=r(232)("forEach");t.exports=o?[].forEach:function(t){return e(this,t,arguments.length>1?arguments[1]:void 0)}},function(t,n,r){"use strict";var e=r(5);t.exports=function(t,n){var r=[][t];return!!r&&e((function(){r.call(null,n||function(){return 1},1)}))}},function(t,n,r){t.exports=r(234)},function(t,n,r){var e=r(235);t.exports=e},function(t,n,r){r(236);var e=r(13).Object,o=t.exports=function(t,n,r){return e.defineProperty(t,n,r)};e.defineProperty.sham&&(o.sham=!0)},function(t,n,r){var e=r(0),o=r(11),i=r(16).f;e({target:"Object",stat:!0,forced:Object.defineProperty!==i,sham:!o},{defineProperty:i})},function(t,n,r){t.exports=r(238)},function(t,n,r){var e=r(239);t.exports=e},function(t,n,r){var e=r(14),o=r(240),i=Array.prototype;t.exports=function(t){var n=t.concat;return t===i||e(i,t)&&n===i.concat?o:n}},function(t,n,r){r(104);var e=r(40);t.exports=e("Array").concat},function(t,n,r){t.exports=r(242)},function(t,n,r){var e=r(243);t.exports=e},function(t,n,r){r(244);var e=r(13);t.exports=e.Object.keys},function(t,n,r){var e=r(0),o=r(25),i=r(69);e({target:"Object",stat:!0,forced:r(5)((function(){i(1)}))},{keys:function(t){return i(o(t))}})},function(t,n,r){t.exports=r(246)},function(t,n,r){var e=r(247);t.exports=e},function(t,n,r){var e=r(14),o=r(248),i=Array.prototype;t.exports=function(t){var n=t.filter;return t===i||e(i,t)&&n===i.filter?o:n}},function(t,n,r){r(249);var e=r(40);t.exports=e("Array").filter},function(t,n,r){"use strict";var e=r(0),o=r(56).filter;e({target:"Array",proto:!0,forced:!r(55)("filter")},{filter:function(t){return o(this,t,arguments.length>1?arguments[1]:void 0)}})}]);`,"Worker",void 0,void 0)}},function(t,r,e){var n=e(3),g=e(9),y=e(11),i=e(308);function k(){var $=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.server=null,this.expire=$.expire||72,this.name=$.name}var L=k.prototype;L.init=function(){var $=this;if(!this.server)return i.open({server:"nim-logs-"+this.name,version:1,schema:{log:{key:{keyPath:"id",autoIncrement:!0},indexes:{time:{}}}}}).then(function(V){$.server=V})},L.putLog=function($){var V=this;if(!this.server)return n.reject("no db server");var z=g($).call($,-1)[0].time-36e5*this.expire;return this.deleteLogs(z).then(function(){return V.server.add("log",$)})},L.getAllLogs=function(){return this.server?this.server.query("log","time").all().execute().then(function($){var V={},z=g($).call($,-1)[0];return V.logs=y($).call($,function(re){return re.tabId+" "+re.log}).join(`\r
`),V.time=z&&z.time,V}):n.reject("no db server")},L.deleteLogs=function($){return this.server?this.server.remove("log",null,"time",0,$):n.reject("no db server")},t.exports=k},function(t,r,e){e(259);var n=e(14);t.exports=n.setInterval},function(t,r,e){var n=e(18),g=e(578),y=Function.prototype;t.exports=function(i){var k=i.bind;return i===y||n(y,i)&&k===y.bind?g:k}},function(t,r,e){e(579);var n=e(27);t.exports=n("Function").bind},function(t,r,e){var n=e(1),g=e(281);n({target:"Function",proto:!0,forced:Function.bind!==g},{bind:g})},function(t,r,e){var n=e(19),g=e(23),y=e(2),i=e(22),k=e(5),L=e(66),$=e(193);function V(oe){oe.onuploading&&this.on("uploading",oe.onuploading),$.call(this,oe)}var z=$.prototype,re=V.prototype=n(z);re.doSend=function(){var oe,le,ue,ie=this.options,ae=ie.headers,Ie=this.xhr=new XMLHttpRequest;if(ae["Content-Type"]==="multipart/form-data"){var de,Ce;delete ae["Content-Type"],Ie.upload.onprogress=g(de=this.onProgress).call(de,this),Ie.upload.onload=g(Ce=this.onProgress).call(Ce,this);var Ue,qe=ie.data;ie.data=new window.FormData,qe&&y(Ue=L.getKeys(qe,ie.putFileAtEnd)).call(Ue,function(Et){var cr=qe[Et];cr.tagName&&cr.tagName.toUpperCase()==="INPUT"?cr.type==="file"&&y([]).call(cr.files,function(er){ie.data.append(L.dataset(cr,"name")||cr.name||er.name||"file-"+L.uniqueID(),er)}):ie.data.append(Et,cr)})}else if(ae["x-nos-token"]){var jt,Fe;Ie.upload.onprogress=g(jt=this.onProgress).call(jt,this),Ie.upload.onload=g(Fe=this.onProgress).call(Fe,this)}Ie.onreadystatechange=g(oe=this.onStateChange).call(oe,this),ie.timeout!==0&&(this.timer=i(g(ue=this.onTimeout).call(ue,this),ie.timeout)),Ie.open(ie.method,ie.url,!ie.sync),y(le=k(ae)).call(le,function(Et){Ie.setRequestHeader(Et,ae[Et])}),ie.cookie&&"withCredentials"in Ie&&(Ie.withCredentials=!0),Ie.send(ie.data),this.afterSend()},re.onProgress=function(oe){oe.lengthComputable&&oe.loaded<=oe.total&&this.emit("uploading",oe)},re.onStateChange=function(){var oe,le=this.xhr;le.readyState===4&&(oe={status:le.status,result:le.responseText||""},this.onLoad(oe))},re.getResponseHeader=function(oe){var le=this.xhr;return le?le.getResponseHeader(oe):""},re.destroy=function(){clearTimeout(this.timer);try{this.xhr.onreadystatechange=L.f,this.xhr.abort()}catch{}z.destroy.call(this)},t.exports=V},function(t,r,e){var n;/*!
 * EventEmitter v5.2.9 - git.io/ee
 * Unlicense - http://unlicense.org/
 * Oliver Caldwell - https://oli.me.uk/
 * @preserve
 */(function(g){function y(){}var i=y.prototype,k=g.EventEmitter;function L(V,z){for(var re=V.length;re--;)if(V[re].listener===z)return re;return-1}function $(V){return function(){return this[V].apply(this,arguments)}}i.getListeners=function(V){var z,re,oe=this._getEvents();if(V instanceof RegExp)for(re in z={},oe)oe.hasOwnProperty(re)&&V.test(re)&&(z[re]=oe[re]);else z=oe[V]||(oe[V]=[]);return z},i.flattenListeners=function(V){var z,re=[];for(z=0;z<V.length;z+=1)re.push(V[z].listener);return re},i.getListenersAsObject=function(V){var z,re=this.getListeners(V);return re instanceof Array&&((z={})[V]=re),z||re},i.addListener=function(V,z){if(!function ue(ie){return typeof ie=="function"||ie instanceof RegExp||!(!ie||typeof ie!="object")&&ue(ie.listener)}(z))throw new TypeError("listener must be a function");var re,oe=this.getListenersAsObject(V),le=typeof z=="object";for(re in oe)oe.hasOwnProperty(re)&&L(oe[re],z)===-1&&oe[re].push(le?z:{listener:z,once:!1});return this},i.on=$("addListener"),i.addOnceListener=function(V,z){return this.addListener(V,{listener:z,once:!0})},i.once=$("addOnceListener"),i.defineEvent=function(V){return this.getListeners(V),this},i.defineEvents=function(V){for(var z=0;z<V.length;z+=1)this.defineEvent(V[z]);return this},i.removeListener=function(V,z){var re,oe,le=this.getListenersAsObject(V);for(oe in le)le.hasOwnProperty(oe)&&(re=L(le[oe],z))!==-1&&le[oe].splice(re,1);return this},i.off=$("removeListener"),i.addListeners=function(V,z){return this.manipulateListeners(!1,V,z)},i.removeListeners=function(V,z){return this.manipulateListeners(!0,V,z)},i.manipulateListeners=function(V,z,re){var oe,le,ue=V?this.removeListener:this.addListener,ie=V?this.removeListeners:this.addListeners;if(typeof z!="object"||z instanceof RegExp)for(oe=re.length;oe--;)ue.call(this,z,re[oe]);else for(oe in z)z.hasOwnProperty(oe)&&(le=z[oe])&&(typeof le=="function"?ue.call(this,oe,le):ie.call(this,oe,le));return this},i.removeEvent=function(V){var z,re=typeof V,oe=this._getEvents();if(re==="string")delete oe[V];else if(V instanceof RegExp)for(z in oe)oe.hasOwnProperty(z)&&V.test(z)&&delete oe[z];else delete this._events;return this},i.removeAllListeners=$("removeEvent"),i.emitEvent=function(V,z){var re,oe,le,ue,ie=this.getListenersAsObject(V);for(ue in ie)if(ie.hasOwnProperty(ue))for(re=ie[ue].slice(0),le=0;le<re.length;le++)(oe=re[le]).once===!0&&this.removeListener(V,oe.listener),oe.listener.apply(this,z||[])===this._getOnceReturnValue()&&this.removeListener(V,oe.listener);return this},i.trigger=$("emitEvent"),i.emit=function(V){var z=Array.prototype.slice.call(arguments,1);return this.emitEvent(V,z)},i.setOnceReturnValue=function(V){return this._onceReturnValue=V,this},i._getOnceReturnValue=function(){return!this.hasOwnProperty("_onceReturnValue")||this._onceReturnValue},i._getEvents=function(){return this._events||(this._events={})},y.noConflict=function(){return g.EventEmitter=k,y},(n=(function(){return y}).call(g,e,g,t))===void 0||(t.exports=n)})(typeof window<"u"?window:this||{})},function(t,r,e){var n=e(19),g=e(8),y=e(2),i=e(23),k=e(93),L=e(66),$=e(193),V=e(282),z="NEJ-UPLOAD-RESULT:",re={};function oe(ie){this.init(),$.call(this,ie)}var le=$.prototype,ue=oe.prototype=n(le);ue.init=function(){var ie=!1;function ae(Ie){var de=Ie.data;if(g(de).call(de,z)===0){var Ce=(de=JSON.parse(de.replace(z,""))).key,Ue=re[Ce];Ue&&(delete re[Ce],de.result=decodeURIComponent(de.result||""),Ue.onLoad(de.result))}}return function(){(function(){if(!ie){ie=!0;var Ie=L.getGlobal();Ie.postMessage?L.on(Ie,"message",ae):(V.addMsgListener(ae),V.startTimer())}})()}}(),ue.doSend=function(){var ie=this,ae=ie.options,Ie=ie.key="zoro-ajax-upload-iframe-"+L.uniqueID();re[Ie]=ie;var de=ie.form=L.html2node('<form style="display:none;"></form>');typeof document>"u"||document.body.appendChild(de),de.target=Ie,de.method="POST",de.enctype="multipart/form-data",de.encoding="multipart/form-data";var Ce=ae.url,Ue=L.genUrlSep(Ce);de.action=Ce+Ue+"_proxy_=form";var qe,jt=ae.data,Fe=[],Et=[];jt&&y(qe=L.getKeys(jt,ae.putFileAtEnd)).call(qe,function(nr){var dr=jt[nr];if(dr.tagName&&dr.tagName.toUpperCase()==="INPUT"){if(dr.type==="file"){var ir=dr,tr=ir.cloneNode(!0);ir.parentNode.insertBefore(tr,ir);var ur=L.dataset(ir,"name");ur&&(ir.name=ur),de.appendChild(ir),L.isFunction(ir.setAttribute)&&(ir.setAttribute("form",""),ir.removeAttribute("form")),Fe.push(dr),Et.push(tr)}}else{var or=L.html2node('<input type="hidden"/>');or.name=nr,or.value=dr,de.appendChild(or)}});function cr(){y(Fe).call(Fe,function(nr,dr){var ir=Et[dr];ir.parentNode&&(nr.name=ir.name,L.isFunction(nr.setAttribute)&&nr.setAttribute("form",ir.getAttribute("form")),ir.parentNode.replaceChild(nr,ir))})}var er=ie.iframe=L.createIframe({name:Ie,onload:function(){var nr;ie.aborted?cr():(L.on(er,"load",i(nr=ie.checkResult).call(nr,ie)),de.submit(),cr(),ie.afterSend())}})},ue.checkResult=function(){var ie,ae;try{var Ie,de;if(ie=this.iframe.contentWindow.document.body,ae=k(Ie=ie.innerText||ie.textContent||"").call(Ie),g(ae).call(ae,z)>=0||g(de=ie.innerHTML).call(de,z)>=0)return}catch{return}this.onLoad(ae)},ue.onLoad=function(ie){le.onLoad.call(this,{status:200,result:ie}),L.remove(this.form),L.remove(this.iframe),le.destroy.call(this)},ue.destroy=function(){L.remove(this.iframe),L.remove(this.form)},ue.abort=function(){this.aborted=!0,delete re[this.key],le.abort.call(this)},t.exports=oe},function(t,r,e){var n=e(584);t.exports=n},function(t,r,e){var n=e(18),g=e(585),y=String.prototype;t.exports=function(i){var k=i.trim;return typeof i=="string"||i===y||n(y,i)&&k===y.trim?g:k}},function(t,r,e){e(586);var n=e(27);t.exports=n("String").trim},function(t,r,e){var n=e(1),g=e(191).trim;n({target:"String",proto:!0,forced:e(587)("trim")},{trim:function(){return g(this)}})},function(t,r,e){var n=e(231).PROPER,g=e(7),y=e(151);t.exports=function(i){return g(function(){return!!y[i]()||"​᠎"[i]()!=="​᠎"||n&&y[i].name!==i})}},function(t,r,e){var n=e(19),g=e(8),y=e(23),i=e(2),k=e(66),L=e(282),$=e(193),V={};function z(le){this.init(),$.call(this,le)}var re=$.prototype,oe=z.prototype=n(re);oe.init=function(){var le="NEJ-AJAX-DATA:",ue=!1;function ie(ae){var Ie=ae.data;if(g(Ie).call(Ie,le)===0){var de=(Ie=JSON.parse(Ie.replace(le,""))).key,Ce=V[de];Ce&&(delete V[de],Ie.result=decodeURIComponent(Ie.result||""),Ce.onLoad(Ie))}}return function(){(function(){if(!ue){ue=!0;var ae=k.getGlobal();ae.postMessage?k.on(ae,"message",ie):L.addMsgListener(ie)}})()}}(),oe.doSend=function(){var le=this.options,ue=k.url2origin(le.url),ie=le.proxyUrl||ue+"/res/nej_proxy_frame.html",ae=V[ie];if(k.isArray(ae)){var Ie;ae.push(y(Ie=this.doSend).call(Ie,this,le))}else{var de;if(!ae)return V[ie]=[y(de=this.doSend).call(de,this,le)],void k.createIframe({src:ie,onload:function(qe){var jt=V[ie];V[ie]=k.target(qe).contentWindow,i(jt).call(jt,function(Fe){try{Fe()}catch{}})}});if(!this.aborted){var Ce=this.key=k.uniqueID();V[Ce]=this;var Ue=k.fetch({method:"GET",url:"",data:null,headers:{},timeout:0},le);Ue.key=Ce,L.postMessage(ae,{data:Ue}),this.afterSend()}}},oe.abort=function(){this.aborted=!0,delete V[this.key],re.abort.call(this)},t.exports=z},function(t,r,e){var n,g,y=e(6),i=e(66),k=e(92),L=(n=/json/i,g=/post/i,function($,V){var z=(V=V||{}).data=V.data||{},re=V.headers=V.headers||{},oe=i.checkWithDefault(re,"Accept","application/json"),le=i.checkWithDefault(re,"Content-Type","application/json");return n.test(oe)&&(V.type="json"),g.test(V.method)&&n.test(le)&&(V.data=y(z)),k($,V)});t.exports=L},function(t,r,e){var n=e(5),g=e(15),y=e(8),i=e(2),k=e(4),L=e(9),$=e(22);t.exports={wrapSafeCallback:function(V,z){if(V.__wrapSafeCallback__)return V;V.__wrapSafeCallback__=!0;var re=n(V);return re=g(re).call(re,function(oe){return y(oe).call(oe,"on")===0&&Object.prototype.toString.call(V[oe])==="[object Function]"}),i(re).call(re,function(oe){var le=V[oe];V[oe]=function(){var ue=this;try{var ie;return le.call.apply(le,k(ie=[this]).call(ie,L(Array.prototype).call(arguments)))}catch(Ie){var ae;this.logger.error(k(ae="wrapSafeCallback. CallbackName: ".concat(oe,". Error: ")).call(ae,Ie)),$(function(){var de;throw ue.logger.error(k(de="wrapSafeCallback. throw error in setTimeout. CallbackName: ".concat(oe,". Error: ")).call(de,Ie)),Ie},0),z.logger&&z.logger.error("userOption:".concat(oe," function error"),Ie)}}}),V}}},function(t,r,e){var n=e(592);t.exports=n},function(t,r,e){e(593);var n=e(14);t.exports=n.Date.now},function(t,r,e){var n=e(1),g=e(13),y=Date,i=g(y.prototype.getTime);n({target:"Date",stat:!0},{now:function(){return i(new y)}})},function(t,r,e){var n=e(81).fn,g=e(0),y=e(26).reportAPI;n.isConnected=function(){return y({instance:this,className:"ApiBaseFn",funcName:"isConnected",hasCallback:!1}),!!this.protocol&&this.protocol.isConnected()},n.getLoginStatus=function(){return this.protocol.getLoginStatus()},n.connect=function(){y({instance:this,className:"ApiBaseFn",funcName:"connect",hasCallback:!1}),this.protocol.processId=g.guid(),this.protocol.connect()},n.detectHeartbeat=function(){this.protocol.detectHeartbeat()},n.disconnect=function(){}},function(t,r,e){var n=e(24),g=e(4),y=e(9),i=e(144),k=e(6),L=e(23),$=e(11),V=e(34),z=e(93),re=e(8),oe=e(43),le=e(22),ue=e(10),ie=e(28),ae=e(2),Ie=e(5),de=e(52),Ce=e(15),Ue=e(53),qe=e(54),jt=e(55),Fe=e(42),Et=e(51),cr=e(127),er=["loc_x","loc_y","loc_z"];function nr(sr,xr){var Or=Ie(sr);if(de){var Mr=de(sr);xr&&(Mr=Ce(Mr).call(Mr,function(br){return Ue(sr,br).enumerable})),Or.push.apply(Or,Mr)}return Or}function dr(sr){for(var xr=1;xr<arguments.length;xr++){var Or,Mr,br=arguments[xr]!=null?arguments[xr]:{};xr%2?ae(Or=nr(Object(br),!0)).call(Or,function(hr){Et(sr,hr,br[hr])}):qe?jt(sr,qe(br)):ae(Mr=nr(Object(br))).call(Mr,function(hr){Fe(sr,hr,Ue(br,hr))})}return sr}var ir=e(81).fn,tr=e(0),ur=e(614),or=e(35),fr=e(12),lr=e(284),gr=e(285),Sr=e(289),wr=e(109),kr=wr.EMExceptionState,mr=wr.EMResourceUploadWay,Ir=e(26).reportAPI,Nr=e(646);function Er(sr,xr,Or,Mr){sr.protocol.reporterHook.emit("reporter/uploadEnd",xr.code==="RequestAbortedError"||xr.code==="abort"?kr.kCanceled:kr.kFailed),sr.reporter.reportTraceStart("exceptions",{user_id:sr.account,trace_id:tr.get(sr,"socket.socket.sessionid"),start_time:Or,action:1,exception_service:3}),sr.reporter.reportTraceUpdateV2("exceptions",{code:typeof xr.status=="number"?xr.status:typeof xr.code=="number"?xr.code:0,description:xr.message||"".concat(xr.code),operation_type:1,target:Mr,net_connect:sr.protocol.checkNetworkAvailable()}),sr.reporter.reportTraceEnd("exceptions",1)}ir.sendText=function(sr){(sr=sr||{}).done=Ir({instance:this,className:"ApiBaseFn",funcName:"sendText",async:!0,done:sr.done});var xr=sr,Or=xr.loc_x,Mr=xr.loc_y,br=xr.loc_z,hr=cr(xr,er);return Or===void 0||Mr===void 0||br===void 0?sr=dr({},hr):(typeof sr.loc_x!="number"&&(sr.loc_x=0),typeof sr.loc_y!="number"&&(sr.loc_y=0),typeof sr.loc_z!="number"&&(sr.loc_z=0)),this.processCallback(sr),sr.msg=new this.message.TextMessage(sr),this.sendMsg(sr)},ir.previewFile=function(sr,xr){var Or=this;(sr=sr||{}).done=Ir({instance:this,className:"ApiBaseFn",funcName:"previewFile",done:sr.done}),sr.fileInput&&(sr.fileInput=tr.verifyFileInput(sr.fileInput,"msg::previewFile"));var Mr=void 0,br=void 0;if(sr.fileInput&&sr.fileInput.files&&sr.fileInput.files.length>0?Mr=sr.fileInput.files[0]:sr.blob&&sr.blob.name&&(Mr=sr.blob),Mr&&(br=Mr.name+"_"+Mr.lastModified+"_"+Mr.size),!sr.transcode&&br&&this.protocol.cloudStorage&&this.protocol.cloudStorage.uploadCache&&this.protocol.cloudStorage.uploadCache[br]){var hr=tr.copy(sr),Tr=new Date().getTime();sr=tr.merge(sr,this.protocol.cloudStorage.uploadCache[br],{onError:function(Br){var Fr;Or.logger.error(g(Fr="chunkUploadResume::onError: ".concat(Br&&Br.code," ")).call(Fr,Br&&Br.message)),Er(Or,Br,Tr,sr.chunkUrl),Br.code==="RequestAbortedError"||Br.code==="abort"||nim.protocol.__destroyed||nim._previewFileNonResume(hr,xr)},uploaddone:function(Br,Fr){if(Br){var Lr;Or.logger.error(g(Lr="chunkUploadResume::uploaddone error: ".concat(Br&&Br.code," ")).call(Lr,Br&&Br.message)),Er(Or,Br,Tr,sr.chunkUrl),Br.code==="RequestAbortedError"||Br.code==="abort"||nim.protocol.__destroyed||nim._previewFileNonResume(hr,xr)}else{Or.protocol.reporterHook.emit("reporter/uploadEnd",kr.kSucceed),Or.logger.log("chunkUploadResume::uploaddone:",Br),(Fr=lr.parseResponse(Fr,Or.options.exifOrientation)).url=fr.genDownloadUrl(sr.nosToken,decodeURIComponent(sr.nosToken.objectName),fr.serverNosConfig.cdnDomain);var qr=Mr.type||"",Ur=Mr.name||"";if(Fr.ext=y(qr).call(qr,i(qr).call(qr,"/")+1),!Fr.ext){var Qr=i(Ur).call(Ur,".");Fr.ext=Qr===-1?"unknown":y(Ur).call(Ur,Qr+1)}sr.nosToken.shortUrl&&(Fr._url_safe=sr.nosToken.shortUrl),sr.done(null,Fr)}},uploadprogress:function(Br){Or.reporterHook.emit("reporter/uploadUpdate",{transferred_size:Br.loaded}),hr.uploadprogress&&hr.uploadprogress(Br)}}),Or.protocol.reporterHook.emit("reporter/uploadStart"),Or.reporterHook.emit("reporter/uploadUpdate",{full_size:Mr.size,remote_addr:fr.chunkUploadUrl,operation_type:mr.kResourceUploadWayNOSPlugin}),Nr(sr,Mr,this.protocol.cloudStorage.uploadCache[br])}else this._previewFileNonResume(sr,xr)},ir._previewFileNonResume=function(sr,xr){var Or,Mr=this,br=Mr.protocol.appGrayConfig;if(br&&br.grayConfig&&br.grayConfig.mixStoreEnable&&(sr.mixEnable=!0),tr.verifyOptions(sr,"done","msg::previewFile"),sr.type||(sr.type="file"),tr.verifyParamPresentJustOne(sr,"dataURL blob fileInput filePath wxFilePath fileObject","msg::previewFile"),tr.exist(sr.maxSize)&&tr.verifyParamType("maxSize",sr.maxSize,"number","api::previewFile"),tr.exist(sr.commonUpload)&&tr.verifyParamType("commonUpload",sr.commonUpload,"boolean","api::previewFile"),sr.nosSurvivalTime?(tr.verifyParamType("nosSurvivalTime",sr.nosSurvivalTime,"number","api::Base.getInstance"),tr.verifyParamMin("nosSurvivalTime",sr.nosSurvivalTime,86400,"api::Base.getInstance")):sr.nosSurvivalTime=this.nosSurvivalTime,sr.filePath=sr.filePath||sr.wxFilePath,delete sr.wxFilePath,sr.dataURL)sr.blob=Sr.fromDataURL(sr.dataURL);else if(!sr.blob){if(sr.fileInput){if(sr.fileInput.files){if(!sr.fileInput.files.length)return void sr.done(or.newNoFileError("请选择"+sr.type+"文件",{callFunc:"msg::previewFile",fileInput:sr.fileInput}),sr);sr.fileSize=sr.fileInput.files[0].size}sr.fileInputName=tr.getFileName(sr.fileInput)}}this.processCallback(sr);var hr=k(lr.genResponseBody(sr.type)||{}).replace(/"/gi,'\\"'),Tr=null,Br=sr.transcode?"getNosTokenTrans":"getNosToken";if(sr.transcode){tr.verifyOptions(sr,"fileInput","msg::previewFile");var Fr=tr.getFileInfo(sr.fileInput);Tr={transToken:{name:Fr.name,type:Fr.transcodeType,transType:sr.transcode==="png"?11:10,size:Fr.size,body:hr}}}else Tr=hr;this[Br]({responseBody:Tr,nosToken:{nosScene:sr.nosScene||this.nosScene,nosSurvivalTime:sr.nosSurvivalTime},callback:L(Or=function(Lr,qr){if(Lr)sr.done(Lr);else if(sr.transcode?(sr.nosToken=qr.nosToken,sr.docId=qr.docId):sr.nosToken=qr,sr.logger=Mr.logger,sr.mixEnable){var Ur,Qr;if(!this.protocol.mixStorePolicy)try{this.protocol.mixStorePolicy=JSON.parse(localStorage.getItem("NIM-AllMixStorePolicy"))[this.options.appKey]}catch(vn){Mr.logger.error("error:","get last mixStorePolicy failed",vn)}if(!this.protocol.mixStorePolicy)return void Mr.logger.error("error:","get mixStorePolicy failed");sr.providers=$(Ur=this.protocol.mixStorePolicy.providers||[]).call(Ur,function(vn){return Number(vn)}),sr.curProvider=sr.providers[0]?Number(sr.providers[0]):1,sr.nosPolicy=this.protocol.mixStorePolicy.nosPolicy,sr.s3Policy=this.protocol.mixStorePolicy.s3Policy,sr.policyVersion=this.protocol.mixStorePolicy.policyVersion,Mr.getMixStoreToken({curProvider:sr.curProvider,policyVersion:sr.policyVersion,responseBody:Tr,callback:L(Qr=function(vn,_n){vn?sr.done(vn):(sr.mixStoreToken=_n,sr.getMixStoreToken=function(Yr,jn){Mr.getMixStoreToken({curProvider:Yr,policyVersion:sr.policyVersion,responseBody:Tr,callback:function(Zr,An){Zr?sr.done(Zr):jn(An)}})},sr.curProvider===1&&(sr.nosToken=_n),Mr._doPreviewFile(sr,xr))}).call(Qr,Mr)})}else this._doPreviewFile(sr,xr)}).call(Or,this)})},ir._doPreviewFile=function(sr,xr){var Or=this;sr=tr.merge(sr,Or.options.providers);var Mr=fr.genUploadUrl(sr.nosToken.bucket);sr.mixEnable&&sr.curProvider===1&&(Mr=fr.genUploadUrl(sr.mixStoreToken.bucket));var br,hr=fr.chunkUploadUrl;Or.logger.info("_doPreviewFile: start upload"),sr.commonUpload||!hr||fr.isWeixinApp||fr.isNodejs||fr.isRN?(sr.commonUpload=!0,br=Mr):(br=hr,sr.nosLbsUrls=fr.nosLbsUrls,Or.options.edgeList?sr.edgeList=Or.options.edgeList:sr.updateNosEdgeList=function(qr){Or.options.edgeList=qr}),Or.protocol.reporterHook.emit("reporter/uploadStart");var Tr=this.assembleUploadParams(sr.nosToken);sr.mixEnable&&sr.curProvider===1&&(Tr=this.assembleUploadParams(sr.mixStoreToken));function Br(qr,Ur,Qr,vn){if(qr){var _n=tr.get(qr,"msg.message")||tr.get(qr,"message")||"Unknown error message",Yr=tr.get(qr,"msg.code")||tr.get(qr,"code")||"Unknown error code";Or.logger.error("_doPreviewFile: upload done, failed ",Yr,_n),Or.protocol.reporterHook.emit("reporter/uploadEnd",qr.code==="RequestAbortedError"||qr.code==="abort"?kr.kCanceled:kr.kFailed);var jn=V({},vn||xr,{status:"fail"}),Zr=dr(dr({},sr.callback.options),{},{msg:jn});return sr.uploaddone&&sr.uploaddone(qr,Zr,jn),void sr.done(qr,sr.callback.options)}if(Or.logger.info("_doPreviewFile: upload done, success"),Or.protocol.reporterHook.emit("reporter/uploadEnd",kr.kSucceed),sr.uploaddone&&sr.uploaddone(null,tr.copy(Ur),vn||xr),Ur=lr.parseResponse(Ur,Or.options.exifOrientation),Qr||Ur.isS3||(Ur.url=fr.genDownloadUrl(sr.nosToken,Tr.Object,fr.serverNosConfig.cdnDomain),sr.nosToken.shortUrl&&(Ur._url_safe=sr.nosToken.shortUrl)),tr.exist(sr.fileInputName))Ur.name=sr.fileInputName;else if(sr.blob){var An=sr.blob.name;if(Ur.name=An||"blob-"+Ur.md5,!An){var Jr=sr.blob.type;Ur.ext=y(Jr).call(Jr,i(Jr).call(Jr,"/")+1)}}else sr.filePath?Ur.name=sr.filePath:sr.fileObject&&(Ur.name=sr.fileObject.fileName);if(!Ur.ext){var Mn,Bn,wn=i(Mn=Ur.name).call(Mn,".");wn===-1?Ur.ext="unknown":Ur.ext=y(Bn=Ur.name).call(Bn,wn+1)}Ur.size=Ur.size||0,Ur.isS3&&Ur._url_safe?Or.getNosOriginUrl({safeShortUrl:Ur._url_safe,done:function(In,bn){In?Or.logger.error("error:","getNosOriginUrl failed",In):(Ur.url=bn,sr.done(null,tr.copy(Ur)))}}):sr.done(null,tr.copy(Ur))}if(fr.isWeixinApp)tr.verifyOptions(sr,"filePath","msg::_doPreviewFile"),Or.fileQuickTransfer(sr,Br,function(){var qr=wx.uploadFile({url:br,filePath:sr.filePath,name:"file",formData:Tr,fail:function(Ur){Br({code:"FAILED",msg:Ur}),Or.logger.error("error:","api::msg:upload file failed",Ur)},success:function(Ur){if(Ur.statusCode===200)try{Br(null,JSON.parse(Ur.data))}catch(Qr){Or.logger.error("error:","parse wx upload file res error",Qr),Br({code:"PARSE_WX_UPLOAD_FILE_RES_ERROR",str:Ur.data,msg:Ur.errMsg})}else Br({code:Ur.statusCode,msg:Ur.errMsg})}});typeof sr.uploadprogress=="function"&&qr&&(sr.beginupload(qr,xr),Or.logger.info("_doPreviewFile::mini uploadprogress"),qr.onProgressUpdate(function(Ur){sr.uploadprogress({total:Ur.totalBytesExpectedToSend,loaded:Ur.totalBytesSent,percentage:Ur.progress,percentageText:Ur.progress+"%"},xr)}))});else if(fr.isNodejs){var Fr={url:br,name:"file",formData:Tr,success:function(qr){if(qr.statusCode===200)try{Br(null,JSON.parse(qr.data))}catch(Ur){Or.protocol.logger.error("error:","parse nodejs upload file res error",Ur),Br({code:"PARSE_NODEJS_UPLOAD_FILE_RES_ERROR",str:qr.data,msg:qr.errMsg})}else Br({code:qr.statusCode,msg:qr.errMsg})},fail:function(qr){Br({code:"FAILED",msg:qr}),Or.protocol.logger.error("error:","api::msg:upload file failed",qr)}};if(sr.filePath)Fr.filePath=sr.filePath;else{if(n(sr.fileObject)!=="object")throw new or("Nodejs上传fileObject参数类型应如 {fileName:..,fileData:..} ");Fr.fileData=sr.fileObject.fileData}Or.fileQuickTransfer(sr,Br,function(){gr.uploadFile(Fr)})}else if(fr.isRN){var Lr={url:br,name:"file",formData:Tr,filePath:sr.filePath,success:function(qr){if(qr.ok&&qr.status===200)try{var Ur=$(qr.headers)&&$(qr.headers).etag;qr.md5=Ur?typeof Ur=="string"?Ur:Ur[0]:"UNKNOWN",Br(null,qr)}catch(Qr){Or.protocol.logger.error("error:","parse React Native upload file res error",Qr),Br({code:"PARSE_React_Native_UPLOAD_FILE_RES_ERROR",res:qr})}else Br({code:qr.status,msg:qr.statusText})},fail:function(qr){Br({code:"FAILED",msg:qr}),Or.protocol.logger.error("error:","api::msg:upload file failed",qr)}};Or.fileQuickTransfer(sr,Br,function(){gr.uploadFile(Lr)})}else sr.url=br,sr.params=Tr,sr.fileName="file",Or.fileQuickTransfer(sr,Br,function(){return Or.protocol.adaptersUploadFile(V({},sr,{uploaddone:Br}),xr)})},ir.fileQuickTransfer=function(sr,xr,Or){var Mr,br=this;sr=sr||{},xr instanceof Function||(xr=function(){}),Or instanceof Function||(Or=function(){});var hr=sr.fastPass;if(hr)try{hr=JSON.parse(hr),sr.fastPass=hr}catch{br.protocol.logger.error("快传参数解析失败")}var Tr=sr.fileInputName||sr.name||sr.blob&&sr.blob.name||"",Br=sr.fileSize||sr.size||sr.blob&&sr.blob.size||0,Fr=hr?z(Mr=(hr.md5||sr.digest||"")+"").call(Mr):"",Lr=sr.type||sr.blob&&sr.blob.type;if(Fr&&Br>=fr.threshold){var qr=!0,Ur={name:Tr,md5:Fr,ext:y(Tr).call(Tr,i(Tr).call(Tr,".")+1),type:Lr};switch(Lr){case"image":hr&&hr.w&&hr.h?(Ur.w=hr.w,Ur.h=hr.h):(qr=!1,br.protocol.logger.error("快传 image 文件缺少参数 w 或 h"));break;case"video":hr&&hr.w&&hr.h&&hr.dur?(Ur.w=hr.w,Ur.h=hr.h,Ur.dur=hr.dur):(qr=!1,br.protocol.logger.error("快传 video 文件缺少参数 w 或 h 或 dur"));break;case"audio":hr&&hr.dur?Ur.dur=hr.dur:(qr=!1,br.protocol.logger.error("快传 audio 文件缺少参数 dur"))}if(!qr)return void Or();var Qr={fileQuickTransfer:{md5:Fr}};return Br&&(Qr.fileQuickTransfer.size=Br),this.protocol.sendCmd("fileQuickTransfer",Qr,function(vn,_n,Yr){!vn&&Yr&&Yr.fileQuickTransfer&&Yr.fileQuickTransfer.url||(br.protocol.logger.error("misc::fileQuickTransfer: not found",vn,_n),Or()),Yr&&Yr.fileQuickTransfer&&Yr.fileQuickTransfer.threshold&&(fr.threshold=Yr.fileQuickTransfer.threshold||0),Yr&&Yr.fileQuickTransfer&&Yr.fileQuickTransfer.url&&(Ur.size=Br||Yr.fileQuickTransfer.size,Ur.url=Yr.fileQuickTransfer.url,Yr.fileQuickTransfer._url_safe&&(Ur._url_safe=Yr.fileQuickTransfer._url_safe),xr(vn,Ur,!0))})}Or()},ir.sendFile=function(sr){if((sr=sr||{}).done=Ir({instance:this,className:"ApiBaseFn",funcName:"sendFile",done:sr.done}),sr.type||(sr.type="file"),sr=tr.merge(sr,this.options.providers),tr.verifyParamPresentJustOne(sr,"dataURL blob fileInput file filePath wxFilePath fileObject","msg::sendFile"),tr.exist(sr.maxSize)&&tr.verifyParamType("maxSize",sr.maxSize,"number","api::previewFile"),tr.exist(sr.commonUpload)&&tr.verifyParamType("commonUpload",sr.commonUpload,"boolean","api::previewFile"),this.processCallback(sr),sr.filePath=sr.filePath||sr.wxFilePath,delete sr.wxFilePath,sr.dataURL)return this._previewAndSendFile(sr);if(sr.blob)return this._previewAndSendFile(sr);if(sr.fileInput)return sr.fileInput=tr.verifyFileInput(sr.fileInput,"msg::sendFile"),sr.fileInput.files&&!sr.fileInput.files.length?void sr.done(or.newNoFileError("请选择"+sr.type+"文件",{callFunc:"msg::sendFile",fileInput:sr.fileInput}),sr.callback.options):this._previewAndSendFile(sr);if(sr.filePath||sr.fileObject)return this._previewAndSendFile(sr);if(sr.file){var xr,Or=sr.file._url_safe;return Or&&(xr=sr.file.url,sr.file.url=Or,delete sr.file._url_safe),sr.msg=new this.message.FileMessage(sr),this.sendMsg(sr,xr)}},ir._previewAndSendFile=function(sr){var xr=this;tr.verifyCallback(sr,"uploaddone beforesend","msg::_previewAndSendFile");var Or=dr({},sr),Mr=new xr.message.Message(Or);Mr.type=sr.type;var br=xr.formatReturnMsg(Mr),hr=xr.protocol.reporterHook.getSafeClock(),Tr={apiCallingTime:xr.protocol.reporterHook.getNTPTime(hr),attachUploadDuration:0},Br=sr.done;return sr.done=function(Fr,Lr){if(sr.done=Br,Fr){var qr=V({},br,{status:"fail"}),Ur=dr(dr({},sr.callback.options),{},{msg:qr});sr.done(Fr,Ur)}else{if(Tr.attachUploadDuration=xr.protocol.reporterHook.getSafeClock()-hr,/chatroom/.test(sr.scene))return;var Qr,vn=Lr._url_safe;vn&&!Lr.isS3&&(Qr=Lr.url,Lr.url=vn,delete Lr._url_safe),sr.file=Lr,sr.msg=new xr.message.FileMessage(sr,Mr.idClient),sr.beforesend(xr.sendMsg(sr,Qr,Tr))}},xr.previewFile(sr,br),br},ir.assembleUploadParams=function(sr){return sr?{Object:decodeURIComponent(sr.objectName),"x-nos-token":sr.token,"x-nos-entity-type":"json"}:null},ir.deleteFile=function(sr){Ir({instance:this,className:"ApiBaseFn",funcName:"deleteFile",hasCallback:!1}),tr.verifyParamPresentJustOne(sr,"docId","msg::deleteFile"),this.removeFile({docId:sr.docId,callback:function(xr,Or){xr?sr.error&&sr.error(xr,Or):sr.success&&sr.success(Or)}})},ir.getFile=function(sr){Ir({instance:this,className:"ApiBaseFn",funcName:"getFile",hasCallback:!1}),tr.verifyParamPresentJustOne(sr,"docId","msg::getFile"),this.fetchFile({docId:sr.docId,callback:function(xr,Or){xr?sr.error&&sr.error(xr,Or):sr.success&&sr.success(Or.info)}})},ir.getFileList=function(sr){Ir({instance:this,className:"ApiBaseFn",funcName:"getFileList",hasCallback:!1});var xr=sr.fromDocId,Or=xr===void 0?"":xr,Mr=sr.limit,br=Mr===void 0?10:Mr,hr={limit:br};Or&&(hr.fromDocId=Or),this.fetchFileList({fileListParam:hr,callback:function(Tr,Br){Tr?(br>30&&(Tr.message=Tr.message+"::文档条数超过限制:30"),sr.error&&sr.error(Tr,Br)):sr.success&&sr.success(Br)}})},ir.sendGeo=function(sr){return(sr=sr||{}).done=Ir({instance:this,className:"ApiBaseFn",funcName:"sendGeo",done:sr.done}),this.processCallback(sr),sr.msg=new this.message.GeoMessage(sr),this.sendMsg(sr)},ir.sendTipMsg=function(sr){return(sr=sr||{}).done=Ir({instance:this,className:"ApiBaseFn",funcName:"sendTipMsg",done:sr.done}),this.processCallback(sr),sr.msg=new this.message.TipMessage(sr),this.sendMsg(sr)},ir.sendCustomMsg=function(sr){return(sr=sr||{}).done=Ir({instance:this,className:"ApiBaseFn",funcName:"sendCustomMsg",done:sr.done}),this.processCallback(sr),sr.msg=new this.message.CustomMessage(sr),this.sendMsg(sr)},ir.sendRobotMsg=function(sr){return(sr=sr||{}).done=Ir({instance:this,className:"ApiBaseFn",funcName:"sendRobotMsg",done:sr.done}),this.logger.warn("this api will be abandon"),this.processCallback(sr),sr.msg=new this.message.RobotMessage(sr),this.sendMsg(sr)},ir.sendMsg=function(sr,xr,Or){var Mr=this,br=Mr.protocol,hr=sr.msg,Tr={};Or=Or||{apiCallingTime:br.reporterHook.getNTPTime(),attachUploadDuration:0};var Br,Fr=!!sr.isLocal;if(this.logger.warn("sendMsg::start: "+hr.idClient),Fr&&(sr.time&&(hr.time=sr.time),sr.idClient&&(hr.idClient=sr.idClient),sr.localFrom&&(Br=sr.localFrom+"")),sr.resend&&(sr.flow!=="out"||sr.status!=="fail"))return tr.onError("只能重发发送失败的消息");sr.callback.options.idClient=hr.idClient,Mr.beforeSendMsg(sr,Tr);var Lr=sr.rtnMsg=Mr.formatReturnMsg(hr,Br);if(xr&&!Mr.options.keepNosSafeUrl&&Lr.file&&(Lr.file._url_safe=Lr.file.url,Lr.file.url=xr,Lr.type==="audio"&&(Lr.file.mp3Url=xr+(~re(xr).call(xr,"?")?"&":"?")+"audioTrans&type=mp3")),Lr.hasOwnProperty("chatroomId")&&!Lr.chatroomId)return tr.onError("聊天室未连接");if(Fr&&(Lr.status="success",Lr.isLocal=!0),br.storeSendMsg&&(Tr.promise=br.storeSendMsg(Lr)),sr.cbaop=function(Ur,Qr){if(Ur)return Ur.code===7101&&(Lr.isInBlackList=!0,Lr.idServer=Qr.idServer,Lr.time=Qr.time),Ur.from!=="server"?(Lr.status="fail",br.updateSendMsgError&&br.updateSendMsgError(Lr),Lr):void 0},!Fr){xr&&!Mr.options.keepNosSafeUrl&&sr.callback&&(sr.callback.originUrl=xr),sr.toAccids&&sr.toAccids.length&&(hr.toAccids=k(sr.toAccids)),Tr.msg=hr,Or.sendTime=br.reporterHook.getNTPTime(),br.reporterHook.hasOriginTimetick()&&(Tr.msg.__clientExt=k({statistics:Or}));var qr=hr;Mr.sendCmd(sr.cmd,Tr,function(){if(fr.isBrowser){var Ur=arguments[0],Qr=arguments[1]||{},vn=Mr.subType==="chatroom",_n=qr.scene===0,Yr=br.reporterHook.getNTPTime(),jn={msgId:Qr.idServer,clientId:qr.idClient,msgTime:Qr.time||0,fromAccid:Mr.account,toAccid:_n?qr.to:"",type:vn?4:qr.scene,roomId:vn?Mr.options.chatroomId:"",tid:vn||_n?"":qr.to,result:Ur?Ur.code:200,failReason:Ur?Ur.message:"",rt:oe(Yr-Or.apiCallingTime),apiCallingTime:Or.apiCallingTime,sendTime:Or.sendTime,attachUploadDuration:Or.attachUploadDuration,apiCallbackTime:Yr};Mr.reporter&&Mr.reporter.report("msgSend",jn)}sr.callback&&sr.callback.apply(Mr,arguments);var Zr=arguments[0],An=arguments[1];!Zr&&An&&An.from===An.to&&Mr.protocol.markMsgRead(An)})}return Mr.afterSendMsg(sr),Fr&&le(function(){Lr=tr.simpleClone(Lr),sr.done(null,Lr)},0),tr.copy(Lr)},ir.beforeSendMsg=function(){},ir.afterSendMsg=function(){},ir.formatReturnMsg=function(sr,xr){var Or;return sr=tr.copy(sr),this.protocol.completeMsg(sr),sr.status="sending",xr&&(sr.from=xr),sr=ue(Or=this.message).call(Or,sr),sr=this.protocol.amendMsg(sr)},ir.resendMsg=function(sr){return(sr=sr||{}).done=Ir({instance:this,className:"ApiBaseFn",funcName:"resendMsg",done:sr.done}),tr.verifyOptions(sr,"msg","msg::resendMsg"),this.trimMsgFlag(sr),sr.resend=!0,this._sendMsgByType(sr)},ir.forwardMsg=function(sr){return(sr=sr||{}).done=Ir({instance:this,className:"ApiBaseFn",funcName:"forwardMsg",done:sr.done}),tr.verifyOptions(sr,"msg","msg::forwardMsg"),this.trimMsgFlag(sr),this.beforeForwardMsg(sr),sr.forward=!0,sr.msg.idClient=tr.guid(),this._sendMsgByType(sr)},ir.trimMsgFlag=function(sr){sr&&sr.msg&&(sr.msg=tr.copy(sr.msg),delete sr.msg.resend,delete sr.msg.forward)},ir.beforeForwardMsg=function(){},ir._sendMsgByType=function(sr){switch(tr.verifyOptions(sr,"msg","msg::_sendMsgByType"),tr.verifyParamValid("msg.type",sr.msg.type,this.message.validTypes,"msg::_sendMsgByType"),tr.merge(sr,sr.msg),sr.type){case"text":return this.sendText(sr);case"image":case"audio":case"video":case"file":return this.sendFile(sr);case"geo":return this.sendGeo(sr);case"custom":return this.sendCustomMsg(sr);case"tip":return this.sendTipMsg(sr);default:throw new or("不能发送类型为 "+sr.type+" 的消息")}},ir.parseRobotTemplate=function(sr){if(this.logger.warn("this api will be abandon"),/<template[^>/]+\/>/.test(sr))return{raw:sr,json:[{type:"text",name:"",text:""}]};if(!/<template[^>/]+>/.test(sr))return{raw:sr,json:[{type:"text",name:"",text:sr}]};var xr=new ur({escapeMode:!1});sr=sr.replace(/<template [^>]+>/,"<template>");var Or=xr.xml2js(sr);Or=Or.template.LinearLayout,ie(Or)||(Or=[Or]);var Mr=[];return Or=ae(Or).call(Or,function(Tr){Tr.image&&(Mr=g(Mr).call(Mr,hr(Tr))),Tr.text&&(Mr=g(Mr).call(Mr,br(Tr))),Tr.link&&(Mr=g(Mr).call(Mr,function(Br){if(Br.link){var Fr=Br.link;ie(Fr)||(Fr=[Fr]),Fr=$(Fr).call(Fr,function(Lr){return Lr.image&&(Lr.image=hr(Lr)),Lr.text&&(Lr.text=br(Lr)),Lr._type==="url"?(Lr.type="url",Lr.style=Lr._style||"",Lr.target=Lr._target,delete Lr._target,delete Lr._style):Lr._type==="block"&&(Lr.type="block",Lr.style=Lr._style||"",Lr.params=Lr._params||"",Lr.target=Lr._target,delete Lr._params,delete Lr._target,delete Lr._style),delete Lr._type,Lr}),Br.link=Fr}return Br.link}(Tr)))}),{raw:sr,json:Mr};function br(Tr){var Br;return ie(Tr.text)||(Tr.text=[Tr.text]),Tr.text=$(Br=Tr.text).call(Br,function(Fr){return{type:"text",name:Fr._name,text:Fr.__text}}),Tr.text}function hr(Tr){var Br;return ie(Tr.image)||(Tr.image=[Tr.image]),Tr.image=$(Br=Tr.image).call(Br,function(Fr){return{type:"image",name:Fr._name,url:Fr._url}}),Tr.image}}},function(t,r,e){e(597);var n=e(14);t.exports=n.Object.assign},function(t,r,e){var n=e(1),g=e(598);n({target:"Object",stat:!0,arity:2,forced:Object.assign!==g},{assign:g})},function(t,r,e){var n=e(29),g=e(13),y=e(20),i=e(7),k=e(124),L=e(136),$=e(157),V=e(46),z=e(129),re=Object.assign,oe=Object.defineProperty,le=g([].concat);t.exports=!re||i(function(){if(n&&re({b:1},re(oe({},"a",{enumerable:!0,get:function(){oe(this,"b",{value:3,enumerable:!1})}}),{b:2})).b!==1)return!0;var ue={},ie={},ae=Symbol();return ue[ae]=7,"abcdefghijklmnopqrst".split("").forEach(function(Ie){ie[Ie]=Ie}),re({},ue)[ae]!=7||k(re({},ie)).join("")!="abcdefghijklmnopqrst"})?function(ue,ie){for(var ae=V(ue),Ie=arguments.length,de=1,Ce=L.f,Ue=$.f;Ie>de;)for(var qe,jt=z(arguments[de++]),Fe=Ce?le(k(jt),Ce(jt)):k(jt),Et=Fe.length,cr=0;Et>cr;)qe=Fe[cr++],n&&!y(Ue,jt,qe)||(ae[qe]=jt[qe]);return ae}:re},function(t,r,e){var n=e(18),g=e(600),y=Array.prototype;t.exports=function(i){var k=i.reverse;return i===y||n(y,i)&&k===y.reverse?g:k}},function(t,r,e){e(601);var n=e(27);t.exports=n("Array").reverse},function(t,r,e){var n=e(1),g=e(13),y=e(87),i=g([].reverse),k=[1,2];n({target:"Array",proto:!0,forced:String(k)===String(k.reverse())},{reverse:function(){return y(this)&&(this.length=this.length),i(this)}})},function(t,r,e){t.exports=e(603)},function(t,r,e){t.exports=e(604)},function(t,r,e){var n=e(605);t.exports=n},function(t,r,e){var n=e(262);t.exports=n},function(t,r,e){t.exports=e(607)},function(t,r,e){var n=e(608);t.exports=n},function(t,r,e){var n=e(211);t.exports=n},function(t,r,e){var n=e(610),g=e(194);t.exports=function(y,i){if(y==null)return{};var k,L,$={},V=n(y);for(L=0;L<V.length;L++)k=V[L],g(i).call(i,k)>=0||($[k]=y[k]);return $},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,r,e){t.exports=e(611)},function(t,r,e){t.exports=e(612)},function(t,r,e){var n=e(613);t.exports=n},function(t,r,e){var n=e(237);t.exports=n},function(t,r,e){var n,g,y;(function(i,k){g=[],(y=typeof(n=function(L){return function($){($=$||{}).arrayAccessForm=$.arrayAccessForm||"none",$.emptyNodeForm=$.emptyNodeForm||"text",$.jsAttributeFilter=$.jsAttributeFilter,$.jsAttributeConverter=$.jsAttributeConverter,$.attributeConverters=$.attributeConverters||[],$.datetimeAccessFormPaths=$.datetimeAccessFormPaths||[],$.arrayAccessFormPaths=$.arrayAccessFormPaths||[],$.xmldomOptions=$.xmldomOptions||{},$.enableToStringFunc===void 0&&($.enableToStringFunc=!0),$.skipEmptyTextNodesForObj===void 0&&($.skipEmptyTextNodesForObj=!0),$.stripWhitespaces===void 0&&($.stripWhitespaces=!0),$.useDoubleQuotes===void 0&&($.useDoubleQuotes=!0),$.ignoreRoot===void 0&&($.ignoreRoot=!1),$.escapeMode===void 0&&($.escapeMode=!0),$.attributePrefix===void 0&&($.attributePrefix="_"),$.selfClosingElements===void 0&&($.selfClosingElements=!0),$.keepCData===void 0&&($.keepCData=!1),$.keepText===void 0&&($.keepText=!1),$.jsDateUTC===void 0&&($.jsDateUTC=!1),function(){function ir(tr){var ur=String(tr);return ur.length===1&&(ur="0"+ur),ur}typeof String.prototype.trim!="function"&&(String.prototype.trim=function(){return this.replace(/^\s+|^\n+|(\s|\n)+$/g,"")}),typeof Date.prototype.toISOString!="function"&&(Date.prototype.toISOString=function(){return this.getUTCFullYear()+"-"+ir(this.getUTCMonth()+1)+"-"+ir(this.getUTCDate())+"T"+ir(this.getUTCHours())+":"+ir(this.getUTCMinutes())+":"+ir(this.getUTCSeconds())+"."+String((this.getUTCMilliseconds()/1e3).toFixed(3)).slice(2,5)+"Z"})}();var V=1,z=3,re=4,oe=8,le=9;function ue(ir){var tr=ir.localName;return tr==null&&(tr=ir.baseName),tr!=null&&tr!==""||(tr=ir.nodeName),tr}function ie(ir){return typeof ir=="string"?ir.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;"):ir}function ae(ir,tr,ur){switch($.arrayAccessForm){case"property":ir[tr]instanceof Array?ir[tr+"_asArray"]=ir[tr]:ir[tr+"_asArray"]=[ir[tr]]}if(!(ir[tr]instanceof Array)&&$.arrayAccessFormPaths.length>0){for(var or=!1,fr=0;fr<$.arrayAccessFormPaths.length;fr++){var lr=$.arrayAccessFormPaths[fr];if(typeof lr=="string"){if(lr===ur){or=!0;break}}else if(lr instanceof RegExp){if(lr.test(ur)){or=!0;break}}else if(typeof lr=="function"&&lr(tr,ur)){or=!0;break}}or&&(ir[tr]=[ir[tr]])}}function Ie(ir){var tr=ir.split(/[-T:+Z]/g),ur=new Date(tr[0],tr[1]-1,tr[2]),or=tr[5].split(".");if(ur.setHours(tr[3],tr[4],or[0]),or.length>1&&ur.setMilliseconds(or[1]),tr[6]&&tr[7]){var fr=60*tr[6]+Number(tr[7]);fr=0+((/\d\d-\d\d:\d\d$/.test(ir)?"-":"+")=="-"?-1*fr:fr),ur.setMinutes(ur.getMinutes()-fr-ur.getTimezoneOffset())}else ir.indexOf("Z",ir.length-1)!==-1&&(ur=new Date(Date.UTC(ur.getFullYear(),ur.getMonth(),ur.getDate(),ur.getHours(),ur.getMinutes(),ur.getSeconds(),ur.getMilliseconds())));return ur}function de(ir,tr){for(var ur={__cnt:0},or=ir.childNodes,fr=0;fr<or.length;fr++){var lr=or.item(fr),gr=ue(lr);lr.nodeType!==oe&&(ur.__cnt++,ur[gr]==null?(ur[gr]=Ce(lr,tr+"."+gr),ae(ur,gr,tr+"."+gr)):(ur[gr]instanceof Array||(ur[gr]=[ur[gr]],ae(ur,gr,tr+"."+gr)),ur[gr][ur[gr].length]=Ce(lr,tr+"."+gr)))}for(var Sr=0;Sr<ir.attributes.length;Sr++){var wr=ir.attributes.item(Sr);ur.__cnt++;for(var kr=wr.value,mr=0;mr<$.attributeConverters.length;mr++){var Ir=$.attributeConverters[mr];Ir.test.call(null,wr.name,wr.value)&&(kr=Ir.convert.call(null,wr.name,wr.value))}ur[$.attributePrefix+wr.name]=kr}var Nr=ir.prefix;return Nr&&(ur.__cnt++,ur.__prefix=Nr),ur["#text"]&&(ur.__text=ur["#text"],ur.__text instanceof Array&&(ur.__text=ur.__text.join(`
`)),$.escapeMode&&(ur.__text=ur.__text.replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&#x27;/g,"'").replace(/&amp;/g,"&")),$.stripWhitespaces&&(ur.__text=ur.__text.trim()),delete ur["#text"],$.arrayAccessForm==="property"&&delete ur["#text_asArray"],ur.__text=function(Er,sr,xr){if($.datetimeAccessFormPaths.length>0)for(var Or=xr.split(".#")[0],Mr=0;Mr<$.datetimeAccessFormPaths.length;Mr++){var br=$.datetimeAccessFormPaths[Mr];if(typeof br=="string"){if(br===Or)return Ie(Er)}else if(br instanceof RegExp){if(br.test(Or))return Ie(Er)}else if(typeof br=="function"&&br(Or))return Ie(Er)}return Er}(ur.__text,0,tr+".#text")),ur.hasOwnProperty("#cdata-section")&&(ur.__cdata=ur["#cdata-section"],delete ur["#cdata-section"],$.arrayAccessForm==="property"&&delete ur["#cdata-section_asArray"]),ur.__cnt===1&&ur.__text&&!$.keepText?ur=ur.__text:ur.__cnt===0&&$.emptyNodeForm==="text"?ur="":ur.__cnt>1&&ur.__text!==void 0&&$.skipEmptyTextNodesForObj&&($.stripWhitespaces&&ur.__text===""||ur.__text.trim()==="")&&delete ur.__text,delete ur.__cnt,$.keepCData||ur.hasOwnProperty("__text")||!ur.hasOwnProperty("__cdata")||Object.keys(ur).length!==1?($.enableToStringFunc&&(ur.__text||ur.__cdata)&&(ur.toString=function(){return(this.__text?this.__text:"")+(this.__cdata?this.__cdata:"")}),ur):ur.__cdata?ur.__cdata:""}function Ce(ir,tr){return ir.nodeType===le?function(ur){for(var or={},fr=ur.childNodes,lr=0;lr<fr.length;lr++){var gr=fr.item(lr);if(gr.nodeType===V){var Sr=ue(gr);$.ignoreRoot?or=Ce(gr,Sr):or[Sr]=Ce(gr,Sr)}}return or}(ir):ir.nodeType===V?de(ir,tr):ir.nodeType===z||ir.nodeType===re?ir.nodeValue:null}function Ue(ir,tr,ur,or){var fr="<"+(ir&&ir.__prefix?ir.__prefix+":":"")+tr;if(ur)for(var lr=0;lr<ur.length;lr++){var gr=ur[lr],Sr=ir[gr];$.escapeMode&&(Sr=ie(Sr)),fr+=" "+gr.substr($.attributePrefix.length)+"=",$.useDoubleQuotes?fr+='"'+Sr+'"':fr+="'"+Sr+"'"}return fr+=or?" />":">"}function qe(ir,tr){return"</"+(ir&&ir.__prefix?ir.__prefix+":":"")+tr+">"}function jt(ir,tr){return $.arrayAccessForm==="property"&&(ur=tr.toString(),or="_asArray",ur.indexOf(or,ur.length-or.length)!==-1)||tr.toString().indexOf($.attributePrefix)===0||tr.toString().indexOf("__")===0||ir[tr]instanceof Function;var ur,or}function Fe(ir){var tr=0;if(ir instanceof Object)for(var ur in ir)jt(ir,ur)||tr++;return tr}function Et(ir){var tr=[];if(ir instanceof Object)for(var ur in ir)ur.toString().indexOf("__")===-1&&ur.toString().indexOf($.attributePrefix)===0&&tr.push(ur);return tr}function cr(ir){var tr="";return ir instanceof Object?tr+=function(ur){var or="";return ur.__cdata&&(or+="<![CDATA["+ur.__cdata+"]]>"),(ur.__text||typeof ur.__text=="number"||typeof ur.__text=="boolean")&&($.escapeMode?or+=ie(ur.__text):or+=ur.__text),or}(ir):ir!==null&&($.escapeMode?tr+=ie(ir):tr+=ir),tr}function er(ir,tr,ur){var or="";return $.jsAttributeFilter&&$.jsAttributeFilter.call(null,tr,ir)||($.jsAttributeConverter&&(ir=$.jsAttributeConverter.call(null,tr,ir)),ir!=null&&ir!==""||!$.selfClosingElements?typeof ir=="object"?Object.prototype.toString.call(ir)==="[object Array]"?or+=function(fr,lr,gr){var Sr="";if(fr.length===0)Sr+=Ue(fr,lr,gr,!0);else for(var wr=0;wr<fr.length;wr++)Sr+=er(fr[wr],lr,Et(fr[wr]));return Sr}(ir,tr,ur):ir instanceof Date?(or+=Ue(ir,tr,ur,!1),or+=$.jsDateUTC?ir.toUTCString():ir.toISOString(),or+=qe(ir,tr)):Fe(ir)>0||typeof ir.__text=="number"||typeof ir.__text=="boolean"||ir.__text||ir.__cdata?(or+=Ue(ir,tr,ur,!1),or+=nr(ir),or+=qe(ir,tr)):$.selfClosingElements?or+=Ue(ir,tr,ur,!0):(or+=Ue(ir,tr,ur,!1),or+=qe(ir,tr)):(or+=Ue(ir,tr,ur,!1),or+=cr(ir),or+=qe(ir,tr)):or+=Ue(ir,tr,ur,!0)),or}function nr(ir){var tr="";if(Fe(ir)>0){for(var ur in ir)if(!jt(ir,ur)){var or=ir[ur];tr+=er(or,ur,Et(or))}}return tr+=cr(ir)}function dr(ir){if(ir===void 0||typeof ir!="string")return null;var tr=null,ur=null;if(L)ur=(tr=new L($.xmldomOptions)).parseFromString(ir,"text/xml");else if(window&&window.DOMParser){tr=new window.DOMParser;var or=null;if(!(window.ActiveXObject||"ActiveXObject"in window)&&document.all&&!document.addEventListener)try{or=tr.parseFromString("INVALID","text/xml").childNodes[0].namespaceURI}catch{or=null}try{ur=tr.parseFromString(ir,"text/xml"),or!==null&&ur.getElementsByTagNameNS(or,"parsererror").length>0&&(ur=null)}catch{ur=null}}else ir.indexOf("<?")===0&&(ir=ir.substr(ir.indexOf("?>")+2)),(ur=new ActiveXObject("Microsoft.XMLDOM")).async="false",ur.loadXML(ir);return ur}this.asArray=function(ir){return ir==null?[]:ir instanceof Array?ir:[ir]},this.toXmlDateTime=function(ir){return ir instanceof Date?ir.toISOString():typeof ir=="number"?new Date(ir).toISOString():null},this.asDateTime=function(ir){return typeof ir=="string"?Ie(ir):ir},this.xml2dom=function(ir){return dr(ir)},this.dom2js=function(ir){return Ce(ir,null)},this.js2dom=function(ir){return dr(this.js2xml(ir))},this.xml2js=function(ir){var tr=dr(ir);return tr!=null?this.dom2js(tr):null},this.js2xml=function(ir){return nr(ir)},this.getVersion=function(){return"3.4.4"}}})=="function"?n.apply(r,g):n)===void 0||(t.exports=y)})()},function(t,r,e){var n=e(616);t.exports=n},function(t,r,e){var n=e(18),g=e(617),y=e(619),i=Array.prototype,k=String.prototype;t.exports=function(L){var $=L.includes;return L===i||n(i,L)&&$===i.includes?g:typeof L=="string"||L===k||n(k,L)&&$===k.includes?y:$}},function(t,r,e){e(618);var n=e(27);t.exports=n("Array").includes},function(t,r,e){var n=e(1),g=e(170).includes,y=e(7),i=e(163);n({target:"Array",proto:!0,forced:y(function(){return!Array(1).includes()})},{includes:function(k){return g(this,k,arguments.length>1?arguments[1]:void 0)}}),i("includes")},function(t,r,e){e(620);var n=e(27);t.exports=n("String").includes},function(t,r,e){var n=e(1),g=e(13),y=e(621),i=e(112),k=e(58),L=e(623),$=g("".indexOf);n({target:"String",proto:!0,forced:!L("includes")},{includes:function(V){return!!~$(k(i(this)),k(y(V)),arguments.length>1?arguments[1]:void 0)}})},function(t,r,e){var n=e(622),g=TypeError;t.exports=function(y){if(n(y))throw g("The method doesn't accept regular expressions");return y}},function(t,r,e){var n=e(30),g=e(71),y=e(21)("match");t.exports=function(i){var k;return n(i)&&((k=i[y])!==void 0?!!k:g(i)=="RegExp")}},function(t,r,e){var n=e(21)("match");t.exports=function(g){var y=/./;try{"/./"[g](y)}catch{try{return y[n]=!1,"/./"[g](y)}catch{}}return!1}},function(t,r,e){var n=e(92);t.exports=function(g,y){return y.method="POST",y.headers=y.headers||{},y.headers["Content-Type"]="multipart/form-data",y.timeout=0,y.type=y.type||"json",n(g,y)}},function(t,r,e){var n=e(9),g=e(43),y=e(4),i=e(8),k=e(3),L=e(12),$=L.chunkSize,V=e(92),z=e(35).formatError,re={mp4:"video/mp4",avi:"video/x-msvideo",wmv:"video/x-ms-wmv",mpeg:"video/mpeg",mov:"video/quicktime",aac:"audio/x-aac",wma:"audio/x-ms-wma",wav:"audio/x-wav",mp3:"audio/mp3"};t.exports=function oe(le,ue,ie,ae){ie&&ie.protocol&&(ie.protocol.cloudStorage=ie.protocol.cloudStorage||{},ie.protocol.cloudStorage.uploadCache=ie.protocol.cloudStorage.uploadCache||{});var Ie={file:le.data[ue],fileSize:le.data[ue].size,fileUploadedSize:0,percentage:0},de=Ie.file,Ce="";de&&de.name&&de.lastModified&&de.size&&(Ce=de.name+"_"+de.lastModified+"_"+de.size);var Ue=le.url;function qe(tr){var ur=Ie.fileUploadedSize+tr.loaded,or=Math.floor(1e4*ur/Ie.fileSize)/100;if(g(or)>=100&&(or=100,qe=function(){}),Ie.percentage!==or){Ie.percentage=or;var fr={docId:le.docId,total:Ie.fileSize,loaded:ur,percentage:or,percentageText:or+"%"};le.fileInput&&(fr.fileInput=le.fileInput),le.blob&&(fr.blob=le.blob),le.uploadprogress(fr)}}function jt(tr){try{tr=JSON.parse(tr)}catch{var ur;return void ie.onError({code:"JSON_PARSE_ERROR",message:y(ur="parse chunk upload result error. url: ".concat(Ue,". body: ")).call(ur,tr)})}if(tr&&(tr.errMsg||tr.errCode))ie.onError(z(tr,{fallbackCode:"CHUNK_UPLOAD_FAIL",fallbackMessage:"chunk upload failed.",suffix:"chunk upload onload error. url: ".concat(Ue)}));else if(tr.offset<Ie.fileSize)delete er.onaftersend,Ie.fileUploadedSize=tr.offset,function(lr,gr,Sr,wr){var kr=lr.offset,mr=lr.offset+$;if(typeof FileReader<"u"){var Ir,Nr=new FileReader;Nr.readAsArrayBuffer(n(Ir=wr.file).call(Ir,kr,mr)),Nr.addEventListener("load",function(sr){gr.data=sr.target.result,gr.query.offset=lr.offset,gr.query.complete=mr>=wr.fileSize,gr.query.context=lr.context,gr.onuploading=qe,gr.onload=jt,gr.onerror=Fe,ie.sn=V(Ue,gr),ie.protocol.cloudStorage.uploadCache[Ce]={chunkUrl:Ue,edgeList:le.edgeList,nosToken:le.nosToken,offset:lr.offset,complete:!1,context:lr.context}}),Nr.addEventListener("error",function(sr){gr.onerror(sr.target.error)})}else{var Er;gr.data=n(Er=wr.file).call(Er,kr,mr),gr.query.offset=lr.offset,gr.query.complete=mr>=wr.fileSize,gr.query.context=lr.context,gr.onuploading=qe,gr.onload=jt,gr.onerror=Fe,ie.sn=V(Ue,gr)}}(tr,er,0,Ie);else{ie.protocol.cloudStorage.uploadCache[Ce]={chunkUrl:Ue,edgeList:le.edgeList,nosToken:le.nosToken,offset:tr.offset,complete:!0,context:tr.context};var or=L.genFileUrl(le.nosToken);le.type==="image"?V(or+"?imageInfo",{onload:function(lr){try{lr=JSON.parse(lr),le.uploaddone(null,{docId:tr.docId,w:lr.Width,h:lr.Height,orientation:lr.Orientation||"",type:lr.Type,size:lr.Size||Ie.fileSize})}catch{var gr;fr({code:"JSON_PARSE_ERROR",message:y(gr="parse image meta failed. url: ".concat(or+"?imageInfo",". body: ")).call(gr,lr)})}},onerror:function(lr){if(typeof Image<"u"){var gr=new Image;gr.src=or,gr.onload=function(){le.uploaddone(null,{docId:tr.docId,w:gr.width,h:gr.height,size:Ie.fileSize})},gr.onerror=function(Sr){fr(z(Sr,{fallbackCode:"GET_MEDIA_META_ERROR",fallbackMessage:"get Image meta failed.",suffix:"url: ".concat(or)}))}}else fr(z(lr,{fallbackCode:"GET_MEDIA_META_ERROR",fallbackMessage:"get imageInfo meta failed.",suffix:"url: ".concat(or+"?imageInfo")}))}}):le.type==="video"||le.type==="audio"?V(or+"?vinfo",{onload:function(lr){try{(lr=JSON.parse(lr)).GetVideoInfo&&lr.GetVideoInfo.VideoInfo&&(lr=lr.GetVideoInfo.VideoInfo),le.uploaddone(null,{docId:tr.docId,w:lr.Width,h:lr.Height,dur:lr.Duration,orientation:lr.Rotate,audioCodec:lr.AudioCodec,videoCodec:lr.VideoCodec,container:lr.Container,size:lr.Size||Ie.fileSize})}catch{var gr;fr({code:"JSON_PARSE_ERROR",message:y(gr="parse media meta failed. url: ".concat(or+"?vinfo",". body: ")).call(gr,lr)})}},onerror:function(lr){fr(z(lr,{fallbackCode:"GET_MEDIA_META_ERROR",fallbackMessage:"get vinfo meta failed.",suffix:"url: ".concat(or+"?vinfo")}))}}):le.uploaddone(null,{docId:tr.docId,size:Ie.fileSize})}function fr(lr){ie.onError(lr)}}function Fe(tr){le.errorHook(tr,{url:Ue,provider:"nos"});var ur=tr&&tr.code;function or(){try{if(tr.result)var fr=JSON.parse(tr.result);else fr=tr;ie.onError(z(fr,{fallbackCode:"CHUNK_UPLOAD_FAIL",fallbackMessage:"chunk upload failed.",suffix:"url: ".concat(Ue)}))}catch{var lr;ie.onError({code:"JSON_PARSE_ERROR",message:y(lr="parse chunk upload result error. url: ".concat(Ue,". body: ")).call(lr,tr.result)})}}Ie.fileUploadedSize===0&&ur!=="abort"?le.edgeList?ae<le.edgeList.length-1?oe(le,ue,ie,ae+1):or():le.nosLbsUrls&&le.nosLbsUrls.length>0?function(fr,lr,gr,Sr,wr){return new k(function(kr){function mr(){wr.adaptersRequest(gr[fr],{query:{version:"1.0",bucketname:lr},method:"GET",onerror:Ir,onload:function(Nr){try{(Nr=JSON.parse(Nr))&&Nr.upload&&Nr.upload.length?kr(Nr.upload):Ir()}catch{Ir()}}},{exception_service:3})}function Ir(){Sr.onLbsUrlFail(gr[fr]),fr<gr.length-1?(fr++,mr()):kr([])}mr()})}(0,le.nosToken.bucket,le.nosLbsUrls,ie,le).then(function(fr){fr.length>0?(le.edgeList=fr,le.updateNosEdgeList&&le.updateNosEdgeList(fr),oe(le,ue,ie,ae+1)):or()}):(le.edgeList=L.edgeList,oe(le,ue,ie,ae+1)):or()}typeof ae!="number"&&(ae=-1),le.edgeList&&le.edgeList.length&&(ae=ae>0?ae:0,Ue=le.edgeList[ae]),Ue+="/"+le.nosToken.bucket+"/"+le.nosToken.objectName;var Et=le.data.file&&le.data.file.type;if(!Et||i(Et).call(Et,"/")<0){var cr=(le.fileInputName||"").split(".").pop();le.type==="image"?Et="image/"+(cr==="jpg"?"jpeg":cr):le.type!=="audio"&&le.type!=="video"||(Et=re[cr])}var er={query:{offset:0,complete:$>=Ie.fileSize,version:"1.0"},headers:{"Content-Type":Et||"application/octet-stream","x-nos-token":le.nosToken.token},method:"POST",timeout:0,onaftersend:function(){le.beginupload(ie)},onuploading:qe,onload:jt,onerror:Fe};if(typeof FileReader<"u"){var nr,dr=new FileReader;dr.addEventListener("load",function(tr){er.data=tr.target.result,ie.sn=V(Ue,er)}),dr.addEventListener("error",function(tr){er.onerror(tr.target.error)}),dr.readAsArrayBuffer(n(nr=Ie.file).call(nr,0,$))}else{var ir;er.data=n(ir=Ie.file).call(ir,0,$),ie.sn=V(Ue,er)}}},function(t,r,e){e(627);var n=e(14);t.exports=n.Reflect.construct},function(t,r,e){var n=e(1),g=e(33),y=e(83),i=e(281),k=e(179),L=e(38),$=e(30),V=e(88),z=e(7),re=g("Reflect","construct"),oe=Object.prototype,le=[].push,ue=z(function(){function Ie(){}return!(re(function(){},[],Ie)instanceof Ie)}),ie=!z(function(){re(function(){})}),ae=ue||ie;n({target:"Reflect",stat:!0,forced:ae,sham:ae},{construct:function(Ie,de){k(Ie),L(de);var Ce=arguments.length<3?Ie:k(arguments[2]);if(ie&&!ue)return re(Ie,de,Ce);if(Ie==Ce){switch(de.length){case 0:return new Ie;case 1:return new Ie(de[0]);case 2:return new Ie(de[0],de[1]);case 3:return new Ie(de[0],de[1],de[2]);case 4:return new Ie(de[0],de[1],de[2],de[3])}var Ue=[null];return y(le,Ue,de),new(y(i,Ie,Ue))}var qe=Ce.prototype,jt=V($(qe)?qe:oe),Fe=y(Ie,jt,de);return $(Fe)?Fe:jt}})},function(t,r,e){t.exports=e(629)},function(t,r,e){var n=e(630);t.exports=n},function(t,r,e){var n=e(220);t.exports=n},function(t,r,e){t.exports=e(632)},function(t,r,e){var n=e(633);t.exports=n},function(t,r,e){var n=e(634);t.exports=n},function(t,r,e){var n=e(635);t.exports=n},function(t,r,e){e(636);var n=e(14);t.exports=n.Object.setPrototypeOf},function(t,r,e){e(1)({target:"Object",stat:!0},{setPrototypeOf:e(139)})},function(t,r,e){t.exports=e(638)},function(t,r,e){var n=e(639);t.exports=n},function(t,r,e){var n=e(280);t.exports=n},function(t,r){t.exports=function(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,r,e){t.exports=e(642)},function(t,r,e){var n=e(643);t.exports=n},function(t,r,e){var n=e(288);t.exports=n},function(t,r,e){e(645);var n=e(14);t.exports=n.Object.getPrototypeOf},function(t,r,e){var n=e(1),g=e(7),y=e(46),i=e(138),k=e(233);n({target:"Object",stat:!0,forced:g(function(){i(1)}),sham:!k},{getPrototypeOf:function(L){return i(y(L))}})},function(t,r,e){var n=e(8),g=e(9),y=e(43),i=e(4),k=e(12),L=k.chunkSize,$=e(92),V=e(35).formatError,z=e(92).abort,re={mp4:"video/mp4",avi:"video/x-msvideo",wmv:"video/x-ms-wmv",mpeg:"video/mpeg",mov:"video/quicktime",aac:"audio/x-aac",wma:"audio/x-ms-wma",wav:"audio/x-wav",mp3:"audio/mp3"};function oe(ae,Ie,de,Ce){var Ue=de.offset,qe=de.offset+L;if(typeof FileReader<"u"){var jt=new FileReader;jt.readAsArrayBuffer(g(Ie).call(Ie,Ue,qe)),jt.addEventListener("load",function(Fe){ae.data=Fe.target.result,ae.query.offset=de.offset,ae.query.complete=qe>=Ie.size,ae.query.context=de.context,ae.onload=function(Et){return ue(Et,Ie,ae,de,Ce)},ae.onerror=function(Et){return le(Et,de)},de.sn=$(de.chunkUrl,ae)}),jt.addEventListener("error",function(Fe){ae.onerror(Fe.target.error)})}else ae.data=g(Ie).call(Ie,Ue,qe),ae.query.offset=de.offset,ae.query.complete=qe>=Ie.size,ae.query.context=de.context,ae.onload=function(Fe){return ue(Fe,Ie,ae,de,Ce)},ae.onerror=function(Fe){return le(Fe,de)},de.sn=$(de.chunkUrl,ae)}function le(ae,Ie){try{if(ae.result)var de=JSON.parse(ae.result);else de=ae;Ie.onError&&Ie.onError(V(de,{fallbackCode:"CHUNK_UPLOAD_FAIL",fallbackMessage:"chunk upload failed.",suffix:"url: ".concat(Ie&&Ie.chunkUrl)}))}catch{var Ce;Ie.onError&&Ie.onError({code:"JSON_PARSE_ERROR",message:i(Ce="parse chunk upload result error. url: ".concat(Ie&&Ie.chunkUrl,". body: ")).call(Ce,ae.result)})}}function ue(ae,Ie,de,Ce,Ue){try{ae=JSON.parse(ae)}catch{var qe;return void Ce.onError({code:"JSON_PARSE_ERROR",message:i(qe="parse chunk upload result error. url: ".concat(Ce&&Ce.chunkUrl,". body: ")).call(qe,ae)})}ae&&(ae.errMsg||ae.errCode)?Ce.onError(V(ae,{fallbackCode:"UPLOAD_CHUNK_ERROR",fallbackMessage:"upload chunk failed.",suffix:"chunk uploadResume onload error. url: ".concat(Ce&&Ce.chunkUrl)})):ae.offset<Ie.size?(delete de.onaftersend,Ce.fileUploadedSize=ae.offset,Ce.offset=ae.offset,Ce.context=ae.context,Ue.offset=ae.offset,Ue.context=ae.context,oe(de,Ie,Ce,Ue)):(Ue.offset=ae.offset,Ue.complete=!0,ie(Ce,Ie))}function ie(ae,Ie){var de=k.genFileUrl(ae.nosToken);ae.type==="image"?$(de+"?imageInfo",{onload:function(Ce){try{Ce=JSON.parse(Ce),ae.uploaddone(null,{w:Ce.Width,h:Ce.Height,orientation:Ce.Orientation||"",type:Ce.Type,size:Ce.Size||Ie.size})}catch{var Ue;ae.onError({code:"JSON_PARSE_ERROR",message:i(Ue="parse image meta failed. url: ".concat(de+"?imageInfo",". body: ")).call(Ue,Ce)})}},onerror:function(Ce){if(typeof Image<"u"){var Ue=new Image;Ue.src=de,Ue.onload=function(){ae.uploaddone(null,{w:Ue.width,h:Ue.height,size:Ie.size})},Ue.onerror=function(qe){ae.onError(V(qe,{fallbackCode:"GET_MEDIA_META_ERROR",fallbackMessage:"get Image meta failed.",suffix:"url: ".concat(de)}))}}else ae.onError(V(Ce,{fallbackCode:"GET_MEDIA_META_ERROR",fallbackMessage:"get imageInfo meta failed.",suffix:"url: ".concat(de+"?imageInfo")}))}}):ae.type==="video"||ae.type==="audio"?$(de+"?vinfo",{onload:function(Ce){try{(Ce=JSON.parse(Ce)).GetVideoInfo&&Ce.GetVideoInfo.VideoInfo&&(Ce=Ce.GetVideoInfo.VideoInfo),ae.uploaddone(null,{w:Ce.Width,h:Ce.Height,dur:Ce.Duration,orientation:Ce.Rotate,audioCodec:Ce.AudioCodec,videoCodec:Ce.VideoCodec,container:Ce.Container,size:Ce.Size||Ie.size})}catch{var Ue;ae.onError({code:"JSON_PARSE_ERROR",message:i(Ue="parse media meta failed. url: ".concat(de+"?vinfo",". body: ")).call(Ue,Ce)})}},onerror:function(Ce){ae.onError(V(Ce,{fallbackCode:"GET_MEDIA_META_ERROR",fallbackMessage:"get vinfo meta failed.",suffix:"url: ".concat(de+"?vinfo")}))}}):ae.uploaddone(null,{size:Ie.size})}t.exports=function(ae,Ie,de){var Ce=ae.chunkUrl,Ue={offset:ae.offset,context:ae.context,chunkUrl:Ce,nosToken:ae.nosToken,type:ae.type,sn:void 0,fileUploadedSize:ae.offset||0,lastPercentage:0,beginupload:ae.beginupload,uploadprogress:ae.uploadprogress,uploaddone:ae.uploaddone,onError:ae.onError};if(ae.complete)return ie(Ue,Ie);var qe={abort:function(){z(Ue.sn)}},jt=Ie.type;if(!jt||n(jt).call(jt,"/")<0){var Fe=(ae.fileInputName||"").split(".").pop();Ue.type==="image"?jt="image/"+(Fe==="jpg"?"jpeg":Fe):Ue.type!=="audio"&&Ue.type!=="video"||(jt=re[Fe])}oe({query:{version:"1.0"},headers:{"Content-Type":jt||"application/octet-stream","x-nos-token":Ue.nosToken.token},method:"POST",timeout:0,onaftersend:function(){Ue.beginupload&&Ue.beginupload(qe)},onuploading:function(Et){return function(cr,er,nr){var dr=nr.fileUploadedSize+cr.loaded,ir=Math.floor(1e4*dr/er.size)/100;if(y(ir)>=100&&(ir=100),nr.lastPercentage!==ir){nr.lastPercentage=ir;var tr={total:er.size,loaded:dr,percentage:ir,percentageText:ir+"%"};nr.uploadprogress&&nr.uploadprogress(tr)}}(Et,Ie,Ue)}},Ie,Ue,de)}},function(t,r,e){var n,g=e(144),y=e(8),i=e(6),k=e(23),L=e(11),$=e(9),V=e(5),z=e(0),re=e(81).fn,oe=e(290),le=e(284),ue=e(35),ie=e(26).reportAPI;re.transDoc=function(ae){var Ie;z.verifyOptions(ae,"fileInput done","nos::transDoc");try{var de=ae.fileInput.files[0],Ce=["ppt","pdf","pptx","doc","docx"],Ue=ae.fileInputName=de.name,qe={ppt:1,pptx:2,pdf:3,doc:6,docx:7},jt=Ue.substring(g(Ue).call(Ue,".")+1);if(y(Ce).call(Ce,jt)<0)return void ae.done(ue.newNoFileError("请上传正确格式的文件【ppt, pptx, pdf, doc, docx】",{callFunc:"nos: transDoc",fileInput:ae.fileInput}),ae)}catch{return void ae.done(ue.newNoFileError("请上传正确的文件节点",{callFunc:"msg::previewFile",fileInput:ae.fileInput}),ae)}var Fe=i(le.genResponseBody("file")||{}).replace(/"/gi,'\\"'),Et={transToken:{name:Ue,type:qe[jt],transType:ae.transcode==="png"?11:10,size:de.size,body:Fe}};this.getNosTokenTrans({responseBody:Et,nosToken:{nosScene:ae.nosScene||this.nosScene,nosSurvivalTime:ae.nosSurvivalTime},callback:k(Ie=function(cr,er){cr?ae.done(cr):(ae.nosToken=er.nosToken,ae.docId=er.docId,this._doPreviewFile(ae))}).call(Ie,this)})},re.getSimpleNosToken=function(){var ae=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return ae.num=1,z.verifyOptions(ae),this.cbAndSendCmd("getSimpleNosToken",ae)},re.getNosToken=function(ae){var Ie=ae.callback,de=ae.nosToken,Ce=ae.responseBody,Ue={tag:de.nosScene};de.nosSurvivalTime&&de.nosSurvivalTime!==1/0&&(Ue.expireSec=de.nosSurvivalTime),this.sendCmd("getNosToken",{responseBody:Ce,nosToken:Ue},Ie)},re.getNosTokenTrans=function(ae){this.sendCmd("getNosTokenTrans",ae.responseBody,ae.callback)},re.getMixStoreToken=function(ae){this.sendCmd("getMixStoreToken",{mixTokenReq:{provider:ae.curProvider,tokenCount:ae.tokenCount||1,tag:"im",returnBody:ae.responseBody,policyVersion:ae.policyVersion}},ae.callback)},re.packFileDownloadName=function(ae){ie({instance:this,className:"ApiBaseFn",funcName:"packFileDownloadName",hasCallback:!1}),z.verifyOptions(ae,"url name",!0,"","nos::packFileDownloadName");var Ie=ae.url;return Ie+z.genUrlSep(Ie)+"download="+encodeURIComponent(ae.name)},re.audioToMp3=function(ae){ie({instance:this,className:"ApiBaseFn",funcName:"audioToMp3",hasCallback:!1}),z.verifyOptions(ae,"url","nos::audioToMp3");var Ie=ae.url;return Ie+z.genUrlSep(Ie)+"audioTrans&type=mp3"},re.removeFile=function(ae){this.sendCmd("removeFile",ae,ae.callback)},re.fetchFile=function(ae){this.sendCmd("fetchFile",ae,ae.callback)},re.fetchFileList=function(ae){this.sendCmd("fetchFileList",ae,ae.callback)},re.stripImageMeta=function(ae){return ie({instance:this,className:"ApiBaseFn",funcName:"stripImageMeta",hasCallback:!1}),this.beforeProcessImage(ae,"stripmeta")},re.qualityImage=function(ae){return ie({instance:this,className:"ApiBaseFn",funcName:"qualityImage",hasCallback:!1}),this.beforeProcessImage(ae,"quality")},re.interlaceImage=function(ae){return ie({instance:this,className:"ApiBaseFn",funcName:"interlaceImage",hasCallback:!1}),this.beforeProcessImage(ae,"interlace")},re.rotateImage=function(ae){return ie({instance:this,className:"ApiBaseFn",funcName:"rotateImage",hasCallback:!1}),this.beforeProcessImage(ae,"rotate")},re.blurImage=function(ae){return ie({instance:this,className:"ApiBaseFn",funcName:"blurImage",hasCallback:!1}),this.beforeProcessImage(ae,"blur")},re.cropImage=function(ae){return ie({instance:this,className:"ApiBaseFn",funcName:"cropImage",hasCallback:!1}),this.beforeProcessImage(ae,"crop")},re.thumbnailImage=function(ae){return ie({instance:this,className:"ApiBaseFn",funcName:"thumbnailImage",hasCallback:!1}),this.beforeProcessImage(ae,"thumbnail")},re.beforeProcessImage=function(ae,Ie){var de=z.copy(ae);return de.type=Ie,ae.ops=[de],this.processImage(ae)},re.processImage=function(ae){var Ie;ae.callback=ie({instance:this,className:"ApiBaseFn",funcName:"processImage",done:ae.callback});var de=this;z.verifyOptions(ae,"url ops",!0,"","nos::processImage"),z.verifyParamType("ops",ae.ops,"array","nos::processImage");var Ce=L(Ie=ae.ops).call(Ie,function(Ue){var qe,jt;return z.verifyOptions(Ue,"type",!0,"","nos::processImage"),z.verifyParamValid("type",Ue.type,oe.validTypes,"nos::processImage"),de["gen"+$(qe=Ue.type).call(qe,0,1).toUpperCase()+$(jt=Ue.type).call(jt,1)+"Op"](Ue)});de.processCallback(ae),de.sendCmd("processImage",{url:ae.url,imageOps:Ce},ae.callback)},re.genStripmetaOp=function(ae){return new oe({type:ae.type,stripmeta:ae.strip?1:0})},re.genQualityOp=function(ae){z.verifyOptions(ae,"quality",!0,"","nos::genQualityOp"),z.verifyParamType("quality",ae.quality,"number","nos::genQualityOp"),z.verifyParamMin("quality",ae.quality,0,"nos::genQualityOp"),z.verifyParamMax("quality",ae.quality,100,"nos::genQualityOp");var Ie=Math.round(ae.quality);return new oe({type:ae.type,qualityQuality:Ie})},re.genInterlaceOp=function(ae){return new oe({type:ae.type})},re.genRotateOp=function(ae){for(z.verifyOptions(ae,"angle",!0,"","nos::genRotateOp"),z.verifyParamType("angle",ae.angle,"number","nos::genRotateOp");ae.angle<0;)ae.angle=ae.angle+360;ae.angle=ae.angle%360;var Ie=Math.round(ae.angle);return new oe({type:ae.type,rotateAngle:Ie})},re.genBlurOp=function(ae){z.verifyOptions(ae,"radius sigma","nos::genBlurOp"),z.verifyParamType("radius",ae.radius,"number","nos::genBlurOp"),z.verifyParamMin("radius",ae.radius,1,"nos::genBlurOp"),z.verifyParamMax("radius",ae.radius,50,"nos::genBlurOp"),z.verifyParamType("sigma",ae.sigma,"number","nos::genBlurOp"),z.verifyParamMin("sigma",ae.sigma,0,"nos::genBlurOp");var Ie=Math.round(ae.radius),de=Math.round(ae.sigma);return new oe({type:ae.type,blurRadius:Ie,blurSigma:de})},re.genCropOp=function(ae){z.verifyOptions(ae,"x y width height","nos::genCropOp"),z.verifyParamType("x",ae.x,"number","nos::genCropOp"),z.verifyParamMin("x",ae.x,0,"nos::genCropOp"),z.verifyParamType("y",ae.y,"number","nos::genCropOp"),z.verifyParamMin("y",ae.y,0,"nos::genCropOp"),z.verifyParamType("width",ae.width,"number","nos::genCropOp"),z.verifyParamMin("width",ae.width,0,"nos::genCropOp"),z.verifyParamType("height",ae.height,"number","nos::genCropOp"),z.verifyParamMin("height",ae.height,0,"nos::genCropOp");var Ie=Math.round(ae.x),de=Math.round(ae.y),Ce=Math.round(ae.width),Ue=Math.round(ae.height);return new oe({type:ae.type,cropX:Ie,cropY:de,cropWidth:Ce,cropHeight:Ue})},re.genThumbnailOp=(n={cover:"z",contain:"x",crop:"y"},function(ae){z.verifyOptions(ae,"mode","nos::genThumbnailOp"),z.verifyParamValid("mode",ae.mode,V(n),"nos::genThumbnailOp"),ae.mode==="contain"?z.verifyParamAtLeastPresentOne(ae,"width height","nos::genThumbnailOp"):z.verifyOptions(ae,"width height","nos::genThumbnailOp"),z.undef(ae.width)&&(ae.width=0),z.undef(ae.height)&&(ae.height=0),z.verifyParamType("width",ae.width,"number","nos::genThumbnailOp"),z.verifyParamMin("width",ae.width,0,"nos::genThumbnailOp"),z.verifyParamType("height",ae.height,"number","nos::genThumbnailOp"),z.verifyParamMin("height",ae.height,0,"nos::genThumbnailOp");var Ie=Math.round(ae.width),de=Math.round(ae.height),Ce=new oe({type:ae.type,thumbnailMode:n[ae.mode],thumbnailWidth:Ie,thumbnailHeight:de});if(ae.mode==="crop"&&z.notundef(ae.axis)){z.undef(ae.axis.x)&&(ae.axis.x=5),z.undef(ae.axis.y)&&(ae.axis.y=5),z.verifyParamMin("axis.x",ae.axis.x,0,"nos::genThumbnailOp"),z.verifyParamMax("axis.x",ae.axis.x,10,"nos::genThumbnailOp"),z.verifyParamMin("axis.y",ae.axis.y,0,"nos::genThumbnailOp"),z.verifyParamMax("axis.y",ae.axis.y,10,"nos::genThumbnailOp");var Ue=Math.round(ae.axis.x),qe=Math.round(ae.axis.y);Ce.thumbnailAxisX=Ue,Ce.thumbnailAxisY=qe}return z.notundef(ae.enlarge)&&(z.verifyParamType("enlarge",ae.enlarge,"boolean","nos::genThumbnailOp"),ae.enlarge&&(Ce.thumbnailEnlarge=1)),Ce.thumbnailToStatic=this.options.thumbnailToStatic?1:0,Ce}),re.getNosOriginUrl=function(ae){var Ie;(ae=ae||{}).done=ie({instance:this,className:"ApiBaseFn",funcName:"getNosOriginUrl",done:ae.done}),z.verifyOptions(ae,"safeShortUrl",!0,"","nos::getNosOriginUrl"),z.verifyParamType("safeShortUrl",ae.safeShortUrl,"string","nos::getNosOriginUrl"),/^http(s)?:/.test(ae.safeShortUrl)&&~y(Ie=ae.safeShortUrl).call(Ie,"im_url=1")?(this.processCallback(ae),this.sendCmd("getNosOriginUrl",{nosFileUrlTag:{safeUrl:ae.safeShortUrl}},ae.callback)):ae.done(new ue("参数 “safeShortUrl” 内容非文件安全短链",{callFunc:"nos: getNosOriginUrl"}),ae)}},function(t,r,e){var n,g=e(4),y=e(8),i=e(5),k=e(24),L=e(110),$=L.genUrlSep,V=L.url2object,z=L.object2url,re=e(0),oe=e(81).fn,le=e(26).reportAPI;oe.viewImageSync=function(ue){le({instance:this,className:"ApiBaseFn",funcName:"viewImageSync",hasCallback:!1});var ie=this.options;re.verifyOptions(ue,"url","nos::viewImageSync");var ae=ue.url,Ie=V(ae),de=Ie.protocol,Ce=Ie.hostname,Ue=Ie.path,qe=Ie.query;if(typeof ue.strip=="boolean"&&(qe.stripmeta=ue.strip?1:0),typeof ue.quality=="number"&&(re.verifyParamMin("quality",ue.quality,0,"nos::viewImageSync"),re.verifyParamMax("quality",ue.quality,100,"nos::viewImageSync"),qe.quality=Math.round(ue.quality)),typeof ue.interlace=="boolean"&&(qe.interlace=ue.interlace?1:0),typeof ue.rotate=="number"&&(qe.rotate=Math.round(ue.rotate)),k(ue.thumbnail)==="object"){var jt=ue.thumbnail.mode||"crop",Fe=ue.thumbnail.width,Et=ue.thumbnail.height;if(Fe>=0&&Et>=0&&Fe<4096&&Et<4096&&(Fe>0||Et>0)){var cr,er;switch(jt){case"crop":jt="y";break;case"contain":jt="x";break;case"cover":jt="z";break;default:jt="x"}qe.thumbnail=g(cr=g(er="".concat(Fe)).call(er,jt)).call(cr,Et)}}if(ie.downloadUrl){var nr=V(ue.url),dr=ie.downloadUrl,ir=nr.path,tr=y(ir).call(ir,"/");if(tr!==-1){var ur=ir.substring(0,tr),or=ir.substring(tr+1);dr=dr.replace("{bucket}",ur).replace("{object}",or)}var fr=V(dr);return z({protocol:fr.protocol,hostname:fr.hostname,path:fr.path,query:re.merge(fr.query,qe)})}return z({protocol:de,hostname:Ce,path:Ue,query:qe})},oe.viewImageStripMeta=function(ue){le({instance:this,className:"ApiBaseFn",funcName:"viewImageStripMeta",hasCallback:!1}),re.verifyOptions(ue,"url strip","nos::viewImageStripMeta"),re.verifyParamType("strip",ue.strip,"boolean","nos::viewImageStripMeta");var ie="stripmeta="+(ue.strip?1:0),ae=$(ue.url);return ue.url+ae+ie},oe.viewImageQuality=function(ue){le({instance:this,className:"ApiBaseFn",funcName:"viewImageQuality",hasCallback:!1}),re.verifyOptions(ue,"url quality","nos::viewImageQuality"),re.verifyParamType("quality",ue.quality,"number","nos::viewImageQuality"),re.verifyParamMin("quality",ue.quality,0,"nos::viewImageQuality"),re.verifyParamMax("quality",ue.quality,100,"nos::viewImageQuality");var ie="quality="+Math.round(ue.quality),ae=$(ue.url);return ue.url+ae+ie},oe.viewImageInterlace=function(ue){le({instance:this,className:"ApiBaseFn",funcName:"viewImageInterlace",hasCallback:!1}),re.verifyOptions(ue,"url","nos::viewImageInterlace");var ie=$(ue.url);return ue.url+ie+"interlace=1"},oe.viewImageRotate=function(ue){for(le({instance:this,className:"ApiBaseFn",funcName:"viewImageRotate",hasCallback:!1}),re.verifyOptions(ue,"url angle","nos::viewImageRotate"),re.verifyParamType("angle",ue.angle,"number","nos::viewImageRotate");ue.angle<0;)ue.angle=ue.angle+360;ue.angle=ue.angle%360;var ie="rotate="+Math.round(ue.angle),ae=$(ue.url);return ue.url+ae+ie},oe.viewImageBlur=function(ue){le({instance:this,className:"ApiBaseFn",funcName:"viewImageBlur",hasCallback:!1}),re.verifyOptions(ue,"url radius sigma","nos::viewImageBlur"),re.verifyParamType("radius",ue.radius,"number","nos::viewImageBlur"),re.verifyParamMin("radius",ue.radius,1,"nos::viewImageBlur"),re.verifyParamMax("radius",ue.radius,50,"nos::viewImageBlur"),re.verifyParamType("sigma",ue.sigma,"number","nos::viewImageBlur"),re.verifyParamMin("sigma",ue.sigma,0,"nos::viewImageBlur");var ie="blur="+Math.round(ue.radius)+"x"+Math.round(ue.sigma),ae=$(ue.url);return ue.url+ae+ie},oe.viewImageCrop=function(ue){le({instance:this,className:"ApiBaseFn",funcName:"viewImageCrop",hasCallback:!1}),re.verifyOptions(ue,"url x y width height","nos::viewImageCrop"),re.verifyParamType("x",ue.x,"number","nos::viewImageCrop"),re.verifyParamMin("x",ue.x,0,"nos::viewImageCrop"),re.verifyParamType("y",ue.y,"number","nos::viewImageCrop"),re.verifyParamMin("y",ue.y,0,"nos::viewImageCrop"),re.verifyParamType("width",ue.width,"number","nos::viewImageCrop"),re.verifyParamMin("width",ue.width,0,"nos::viewImageCrop"),re.verifyParamType("height",ue.height,"number","nos::viewImageCrop"),re.verifyParamMin("height",ue.height,0,"nos::viewImageCrop");var ie="crop="+Math.round(ue.x)+"_"+Math.round(ue.y)+"_"+Math.round(ue.width)+"_"+Math.round(ue.height),ae=$(ue.url);return ue.url+ae+ie},oe.viewImageThumbnail=(n={cover:"z",contain:"x",crop:"y"},function(ue){re.verifyOptions(ue,"url mode","nos::viewImageThumbnail"),re.verifyParamValid("mode",ue.mode,i(n),"nos::viewImageThumbnail"),ue.mode==="contain"?re.verifyParamAtLeastPresentOne(ue,"width height","nos::viewImageThumbnail"):re.verifyOptions(ue,"width height","nos::viewImageThumbnail"),re.undef(ue.width)&&(ue.width=0),re.undef(ue.height)&&(ue.height=0),re.verifyParamType("width",ue.width,"number","nos::viewImageThumbnail"),re.verifyParamMin("width",ue.width,0,"nos::viewImageThumbnail"),re.verifyParamType("height",ue.height,"number","nos::viewImageThumbnail"),re.verifyParamMin("height",ue.height,0,"nos::viewImageThumbnail");var ie=Math.round(ue.width),ae=Math.round(ue.height),Ie="thumbnail="+ie+n[ue.mode]+ae;ue.mode==="crop"&&re.notundef(ue.axis)&&(re.undef(ue.axis.x)&&(ue.axis.x=5),re.undef(ue.axis.y)&&(ue.axis.y=5),re.verifyParamMin("axis.x",ue.axis.x,0,"nos::viewImageThumbnail"),re.verifyParamMax("axis.x",ue.axis.x,10,"nos::viewImageThumbnail"),re.verifyParamMin("axis.y",ue.axis.y,0,"nos::viewImageThumbnail"),re.verifyParamMax("axis.y",ue.axis.y,10,"nos::viewImageThumbnail"),Ie=Ie+"&axis="+Math.round(ue.axis.x)+"_"+Math.round(ue.axis.y)),re.notundef(ue.enlarge)&&(re.verifyParamType("enlarge",ue.enlarge,"boolean","nos::viewImageThumbnail"),ue.enlarge&&(Ie+="&enlarge=1"));var de=$(ue.url);return ue.url+de+Ie})},function(t,r,e){var n=e(24),g=e(6),y=e(8),i=e(310),k=e(0),L=e(81).fn,$=e(12),V=e(26).reportAPI;function z(oe,le,ue,ie){var ae=!1,Ie="";if(ue===1?y(oe).call(oe,le)>=0&&(ae=!0,Ie=le):ue===2&&(Ie=new RegExp(le,"g")).test(oe)&&(ae=!0),ae&&Ie!=="")switch(ie){case 1:return oe.replace(Ie,"**");case 2:return{code:2};case 3:return{code:3}}return oe}function re(oe,le){for(var ue=le.match,ie=le.operate,ae=oe,Ie=0;Ie<i(le).length;Ie++){var de=i(le)[Ie],Ce=de.match||ue,Ue=de.operate||ie;try{if(ae=z(ae,de.key,Ce,Ue),n(ae)==="object")return ae}catch(qe){this.logger.warn("misc::filterContent: js cannot parse this regexp ",qe)}}return ae}L.uploadSdkLogUrl=function(oe){return k.verifyOptions(oe,"url","misc::uploadSdkLogUrl"),this.cbAndSendCmd("uploadSdkLogUrl",oe)},L.getClientAntispamLexicon=function(oe){var le=this;(oe=oe||{}).done=V({instance:this,className:"ApiBaseFn",funcName:"getClientAntispamLexicon",done:oe.done});var ue=(oe=oe||{}).done;ue instanceof Function||(ue=function(){}),oe={clientAntispam:{version:0}};var ie=this;if($.hasLocalStorage&&localStorage.getItem("antispamLexicon")&&localStorage.getItem("antispamLexicon")!=="{}")try{ie.antispamLexicon=JSON.parse(localStorage.getItem("antispamLexicon"))}catch(ae){this.logger.error("JSON parse antispamLexicon error",ae)}ie.antispamLexicon&&ue.call(this,null,{clientAntispam:ie.antispamLexicon}),this.protocol.sendCmd("getClientAntispam",oe,function(ae,Ie,de){ae?(ie.protocol.logger.error("misc::getClientAntispamLexicon:",ae),ue.call(le,ae,{})):($.hasLocalStorage&&localStorage.setItem("antispamLexicon",g(de.clientAntispam)),ie.antispamLexicon||ue.call(le,null,de),ie.antispamLexicon=de.clientAntispam||{})})},L.filterClientAntispam=function(oe){V({instance:this,className:"ApiBaseFn",funcName:"filterClientAntispam",hasCallback:!1});var le=oe.content;if(!le)return{code:404,errmsg:"待反垃圾文本content不存在"};var ue=this.antispamLexicon&&this.antispamLexicon.thesaurus;if(!ue)return{code:404,errmsg:"没有反垃圾词库或者词库格式不合法"};try{ue=JSON.parse(ue).thesaurus}catch{return this.protocol.logger.error("misc::filterClientAntispam: parse thesaurus error"),{code:500,errmsg:"反垃圾词库格式不合法"}}for(var ie=le,ae=0;ae<ue.length;ae++)if(ie=re.call(this,ie,ue[ae]),n(ie)==="object"){if(ie.code===2)return{code:200,type:2,errmsg:"建议拒绝发送",content:le,result:""};if(ie.code===3)return{code:200,type:3,errmsg:"建议服务器处理反垃圾，发消息带上字段clientAntiSpam",content:le,result:le}}return ie===le?{code:200,type:0,errmsg:"",content:le,result:ie}:{code:200,type:1,errmsg:"已对特殊字符做了过滤",content:le,result:ie}},L.getServerTime=function(oe){(oe=oe||{}).done=V({instance:this,className:"ApiBaseFn",funcName:"getServerTime",done:oe.done}),this.processCallback(oe),this.sendCmd("getServerTime",{},oe.callback)},L.getNosAccessToken=function(oe){(oe=oe||{}).done=V({instance:this,className:"ApiBaseFn",funcName:"getNosAccessToken",done:oe.done}),k.verifyOptions(oe,"url","misc::getNosAccessToken"),this.processCallback(oe);var le={url:oe.url};oe.userAgent&&(le.userAgent=oe.userAgent),oe.ext&&(le.ext=oe.ext),this.sendCmd("getNosAccessToken",{nosAccessTokenTag:le},function(ue,ie,ae){var Ie=ae&&ae.nosAccessTokenTag&&ae.nosAccessTokenTag.token,de=oe.url,Ce=Ie?{token:Ie,resUrl:y(de).call(de,"?")!==-1?de+"&token="+Ie:de+"?token="+Ie}:{};oe.done(ue,Ce)})},L.deleteNosAccessToken=function(oe){(oe=oe||{}).done=V({instance:this,className:"ApiBaseFn",funcName:"deleteNosAccessToken",done:oe.done}),k.verifyOptions(oe,"token","misc::deleteNosAccessToken"),this.processCallback(oe),this.sendCmd("deleteNosAccessToken",{nosAccessTokenTag:{token:oe.token}},oe.callback)}},function(t,r,e){e(75);var n=e(73),g=e(31),y=e(18),i=e(651),k=Array.prototype,L={DOMTokenList:!0,NodeList:!0};t.exports=function($){var V=$.keys;return $===k||y(k,$)&&V===k.keys||g(L,n($))?i:V}},function(t,r,e){var n=e(652);t.exports=n},function(t,r,e){e(90),e(102);var n=e(27);t.exports=n("Array").keys},function(t,r,e){var n=e(24),g=e(3),y=e(11),i=e(6),k=e(81).fn,L=e(0),$=e(155),V=e(291),z=e(26).reportAPI;k.signalingCreate=function(){var re=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},oe=re.type,le=re.channelName,ue=re.ext;return L.verifyOptions(re,"type","api::signalling"),this.sendCmdUsePromise("signalingCreate",{avSignalTag:{type:oe,channelName:le,ext:ue}}).then(function(ie){var ae=ie.avSignalTag;return g.resolve(ae)}).catch(function(ie){return g.reject(V.parseAvSignalError(ie))})},k.signalingDelay=function(){var re=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return L.verifyOptions(re,"channelId","api::signalling"),this.sendCmdUsePromise("signalingDelay",{avSignalTag:re}).then(function(oe){var le=oe.avSignalTag;return g.resolve(le)}).catch(function(oe){return g.reject(V.parseAvSignalError(oe))})},k.signalingClose=function(){var re=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},oe=re.offlineEnabled;return L.verifyOptions(re,"channelId","api::signalling"),this.sendCmdUsePromise("signalingClose",{avSignalTag:L.merge(re,{isSave:oe===!0?1:0})}).then(function(le){var ue=le.avSignalTag;return ue.offlineEnabled=ue.isSave===1,delete ue.isSave,g.resolve(ue)}).catch(function(le){return g.reject(V.parseAvSignalError(le))})},k.signalingJoin=function(){var re=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},oe=re.offlineEnabled;return L.verifyOptions(re,"channelId","api::signalling"),this.sendCmdUsePromise("signalingJoin",{avSignalTag:L.merge(re,{isSave:oe===!0?1:0})}).then(function(le){var ue,ie=le.avSignalTag,ae=ie.members;return typeof ie.members=="string"&&(ae=y(ue=JSON.parse(ie.members)).call(ue,function(Ie){return V.parseAvSignalMember(Ie)})),ie.members=ae,g.resolve(ie)}).catch(function(le){return g.reject(V.parseAvSignalError(le))})},k.signalingLeave=function(){var re=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},oe=re.offlineEnabled;return L.verifyOptions(re,"channelId","api::signalling"),this.sendCmdUsePromise("signalingLeave",{avSignalTag:L.merge(re,{isSave:oe===!0?1:0})}).then(function(le){var ue=le.avSignalTag;return ue.offlineEnabled=ue.isSave===1,delete ue.isSave,g.resolve(ue)}).catch(function(le){return g.reject(V.parseAvSignalError(le))})},k.signalingGetChannelInfo=function(){var re=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},oe=re.channelName;return L.verifyOptions(re,"channelName","api::signalling"),this.sendCmdUsePromise("signalingGetChannelInfo",{avSignalTag:{channelName:oe}}).then(function(le){var ue,ie=le.avSignalTag,ae=ie.members;return typeof ie.members=="string"&&(ae=y(ue=JSON.parse(ie.members)).call(ue,function(Ie){return V.parseAvSignalMember(Ie)})),ie.members=ae,g.resolve(ie)}).catch(function(le){return g.reject(V.parseAvSignalError(le))})},k.signalingInvite=function(){var re=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},oe=re.account,le=re.offlineEnabled,ue=re.pushInfo,ie=ue===void 0?{}:ue;L.verifyOptions(re,"channelId requestId account","api::signalling"),n(ie.pushPayload)==="object"&&(ie.pushPayload=i(ie.pushPayload));var ae=L.merge(re,ie,{to:oe,isSave:le===!0?1:0,needPush:ie.needPush===!0?1:0,needBadge:ie.needBadge===!1?0:1});return this.sendCmdUsePromise("signalingInvite",{avSignalTag:ae}).then(function(Ie){var de=Ie.avSignalTag;return de.offlineEnabled=de.isSave===1,de.needBadge=de.needBadge===1,de.needPush=de.needPush===1,delete de.isSave,g.resolve(de)}).catch(function(Ie){return g.reject(V.parseAvSignalError(Ie))})},k.signalingCancel=function(re){var oe=re.account,le=re.offlineEnabled;return L.verifyOptions(re,"channelId requestId account","api::signalling"),this.sendCmdUsePromise("signalingCancel",{avSignalTag:L.merge(re,{to:oe,isSave:le===!0?1:0})}).then(function(ue){var ie=ue.avSignalTag;return ie.offlineEnabled=ie.isSave===1,delete ie.isSave,g.resolve(ie)}).catch(function(ue){return g.reject(V.parseAvSignalError(ue))})},k.signalingCreateAndJoin=function(re){var oe=this,le=z({instance:this,className:"ApiBaseFn",funcName:"signalingCreateAndJoin",hasCallback:!0}),ue=re.channelName,ie=re.uid,ae=ie===void 0?0:ie,Ie=re.offlineEnabled,de=Ie===void 0||Ie,Ce=re.attachExt,Ue=Ce===void 0?"":Ce;return this.signalingCreate(re).catch(function(qe){return qe.code===10405?(oe.logger.warn("api::avSignal:signalingCall room already exists:",qe),oe.signalingGetChannelInfo({channelName:ue})):g.reject(qe)}).then(function(qe){var jt={channelId:qe.channelId,offlineEnabled:de,attachExt:Ue,nertcChannelName:re.nertcChannelName,nertcTokenTtl:re.nertcTokenTtl,nertcJoinRoomQueryParamMap:re.nertcJoinRoomQueryParamMap};return ae&&L.merge(jt,{uid:ae}),oe.signalingJoin(jt)}).then(function(qe){return typeof le=="function"&&le(void 0),qe}).catch(function(qe){throw typeof le=="function"&&le(qe),qe})},k.signalingCall=function(re){var oe=this,le=z({instance:this,className:"ApiBaseFn",funcName:"signalingCall",hasCallback:!0}),ue=re.account,ie=re.offlineEnabled,ae=re.requestId;L.verifyOptions(re,"type requestId account","api::signalling");var Ie="";return this.signalingCreateAndJoin(re).then(function(de){Ie=de.channelId||Ie,oe.logger.info("api::avSignal:signalingCall join:",Ie);var Ce={channelId:Ie,account:ue,requestId:ae,offlineEnabled:ie,attachExt:re.attachExt||"",pushInfo:re.pushInfo||{},nertcTokenTtl:de.nertcTokenTtl,nertcToken:de.nertcToken};return oe.signalingInvite(Ce)}).then(function(de){return typeof le=="function"&&le(void 0),de}).catch(function(de){throw typeof le=="function"&&le(de),de})},k.signalingReject=function(re){var oe=re.account,le=re.offlineEnabled;return L.verifyOptions(re,"channelId requestId account","api::signalling"),this.sendCmdUsePromise("signalingReject",{avSignalTag:L.merge(re,{to:oe,isSave:le===!0?1:0})}).then(function(ue){var ie=ue.avSignalTag;return ie.offlineEnabled=ie.isSave===1,delete ie.isSave,g.resolve(ie)}).catch(function(ue){return g.reject(V.parseAvSignalError(ue))})},k.signalingAccept=function(re){var oe=this,le=re.account,ue=re.offlineEnabled;return L.verifyOptions(re,"channelId requestId account","api::signalling"),this.sendCmdUsePromise("signalingAccept",{avSignalTag:L.merge(re,{to:le,isSave:ue===!0?1:0})}).then(function(ie){var ae=ie.avSignalTag;return ae.offlineEnabled=ae.isSave===1,delete ae.isSave,g.resolve(ae)}).catch(function(ie){return g.reject(V.parseAvSignalError(ie))}).then(function(ie){if(re.autoJoin){var ae={channelId:re.channelId,offlineEnabled:re.offlineEnabled,attachExt:re.joinAttachExt,uid:re.uid,nertcChannelName:re.nertcChannelName,nertcTokenTtl:re.nertcTokenTtl,nertcJoinRoomQueryParamMap:re.nertcJoinRoomQueryParamMap};return oe.signalingJoin(ae)}return ie})},k.signalingControl=function(re){var oe=re.account;return L.verifyOptions(re,"channelId","api::signalling"),this.sendCmdUsePromise("signalingControl",{avSignalTag:L.merge(re,oe?{to:oe}:{})}).then(function(le){var ue=le.avSignalTag;return g.resolve(ue)}).catch(function(le){return g.reject(V.parseAvSignalError(le))})},k.signalingSync=function(){return this.sendCmdUsePromise("sync",{sync:{avSignal:0}}).then(function(re){var oe=re.avSignalTag;return g.resolve(oe)}).catch(function(re){return g.reject(V.parseAvSignalError(re))})},k.signalingMarkMsgRead=function(){var re=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};z({instance:this,className:"ApiBaseFn",funcName:"signalingMarkMsgRead",hasCallback:!1}),L.verifyOptions(re,"msgid","api::signalling");var oe,le=$.idMap.avSignal;return oe=typeof re.msgid=="string"?[re.msgid]:re.msgid,this.sendCmd("batchMarkRead",{sid:le.id,cid:le.signalingNotify,ids:oe})},k.signalingCallEx=function(){var re=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},oe=re.account,le=re.offlineEnabled,ue=re.pushInfo,ie=ue===void 0?{}:ue;n(ie.pushPayload)==="object"&&(ie.pushPayload=i(ie.pushPayload)),L.verifyOptions(re,"type","api::signalling"),L.verifyOptions(re,"account","api::signalling");var ae=L.merge(re,ie,{to:oe,isSave:le===!0?1:0,needPush:ie.needPush===!0?1:0,needBadge:ie.needBadge===!1?0:1});return this.sendCmdUsePromise("signalingCallEx",{avSignalTag:ae}).then(function(Ie){var de,Ce=Ie.avSignalTag,Ue=Ce.members;return typeof Ce.members=="string"&&(Ue=y(de=JSON.parse(Ce.members)).call(de,function(qe){return V.parseAvSignalMember(qe)})),Ce.members=Ue,g.resolve(Ce)}).catch(function(Ie){return g.reject(V.parseAvSignalError(Ie))})},k.signalingJoinAndAccept=function(){var re=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},oe=re.channelId,le=re.attachExt,ue=re.offlineEnabled,ie=re.uid,ae=re.account,Ie=re.requestId,de=re.nertcChannelName,Ce=re.nertcTokenTtl,Ue=re.nertcJoinRoomQueryParamMap;return L.verifyOptions(re,"channelId","api::signalling"),L.verifyOptions(re,"account","api::signalling"),L.verifyOptions(re,"requestId","api::signalling"),this.sendCmdUsePromise("signalingJoinAndAccept",{avSignalTag:{channelId:oe,attachExt:le,isSave:ue===!0?1:0,uid:ie,to:ae,requestId:Ie,nertcChannelName:de,nertcTokenTtl:Ce,nertcJoinRoomQueryParamMap:Ue}}).then(function(qe){var jt,Fe=qe.avSignalTag,Et=Fe.members;return typeof Fe.members=="string"&&(Et=y(jt=JSON.parse(Fe.members)).call(jt,function(cr){return V.parseAvSignalMember(cr)})),Fe.members=Et,g.resolve(Fe)}).catch(function(qe){return g.reject(V.parseAvSignalError(qe))})}},function(t,r,e){var n=e(51),g=e(34),y=e(5),i=e(52),k=e(15),L=e(53),$=e(2),V=e(54),z=e(55),re=e(42),oe=e(44),le=e(45);function ue(ae,Ie){var de=y(ae);if(i){var Ce=i(ae);Ie&&(Ce=k(Ce).call(Ce,function(Ue){return L(ae,Ue).enumerable})),de.push.apply(de,Ce)}return de}e(0);var ie={user_id:"",trace_id:"",action:7,exception_service:6,duration:0,start_time:0,state:1,extension:[]};t.exports=function(){function ae(Ie){oe(this,ae),this.clientProto=Ie,this.reset()}return le(ae,[{key:"reset",value:function(){this.traceData=g({},ie),this.traceData.extension=[]}},{key:"start",value:function(Ie){this.reset(),g(this.traceData,Ie),this.traceData.user_id=this.clientProto.account,this.traceData.start_time=new Date().getTime()}},{key:"update",value:function(Ie){var de=this.clientProto.checkNetworkAvailable();this.traceData.extension.push(function(Ce){for(var Ue=1;Ue<arguments.length;Ue++){var qe,jt,Fe=arguments[Ue]!=null?arguments[Ue]:{};Ue%2?$(qe=ue(Object(Fe),!0)).call(qe,function(Et){n(Ce,Et,Fe[Et])}):V?z(Ce,V(Fe)):$(jt=ue(Object(Fe))).call(jt,function(Et){re(Ce,Et,L(Fe,Et))})}return Ce}({code:0,description:"",foreground:!0,foreg_backg_switch:!1,net_type:0,net_connect:de},Ie))}},{key:"end",value:function(Ie){var de=this.traceData.extension[0],Ce=this.traceData.extension[1];if(de&&de.operation_type===0&&Ce&&Ce.operation_type===1){var Ue=de.net_type!==Ce.net_type||de.net_connect!==Ce.net_connect;if(Ie||!Ue)return this.traceData.duration=new Date().getTime()-this.traceData.start_time,this.clientProto.reporter.report("exceptions",this.traceData),void this.reset();this.reset()}else this.reset()}}]),ae}()},function(t,r,e){var n=e(2),g=e(44),y=e(45),i=e(66).getPromiseWithAbort,k=function(){function L(){g(this,L),this.abortFns=[]}return y(L,[{key:"add",value:function($){var V=i($);return this.abortFns.push(V.abort),V.promise}},{key:"clear",value:function(){var $;n($=this.abortFns).call($,function(V){return V(new Error("Request aborted"))}),this.abortFns=[]}},{key:"destroy",value:function(){this.clear()}}]),L}();t.exports=k},function(t,r,e){var n=e(60),g=e(61),y=e(34),i=e(2),k=e(63),L=e(3),$=e(11),V=e(56),z=e(9),re=e(4),oe=e(6),le=e(23),ue=e(44),ie=e(45),ae=e(0),Ie=e(12),de=e(70),Ce=e(294),Ue=e(676),qe=e(35);t.exports=function(){function jt(Et,cr){ue(this,jt),this.clientProto=Et,this.logger=Et.logger,this.urls=[],this.sockets=[],this.config=cr}var Fe;return ie(jt,[{key:"setConfig",value:function(Et){y(this.config,Et)}},{key:"setUrls",value:function(Et){this.urls=Et}},{key:"resetSockets",value:function(){var Et;i(Et=this.sockets).call(Et,function(cr){cr&&(cr.removeAllListenersX("info"),cr.disconnect())}),this.sockets=[]}},{key:"connect",value:(Fe=g(n.mark(function Et(){var cr,er,nr,dr=this;return n.wrap(function(ir){for(;;)switch(ir.prev=ir.next){case 0:if(this.clientProto.statusProtector.processEvent("auth/loginLifeCycleConnect"),(er=k(cr=this.urls).call(cr,0,this.config.socketConcurrent)).length!==0){ir.next=4;break}throw new qe("no_socket_url",408,{});case 4:return ir.prev=4,ir.next=7,L.any($(er).call(er,function(tr,ur){return dr.doConnect(tr,ur)}));case 7:return ir.abrupt("return",ir.sent);case 10:throw ir.prev=10,ir.t0=ir.catch(4),i(nr=ir.t0.errors).call(nr,function(tr,ur){dr.logger.warn("imsocket::connect failed ".concat(ur),tr)}),ir.t0;case 14:case"end":return ir.stop()}},Et,this,[[4,10]])})),function(){return Fe.apply(this,arguments)})},{key:"success",value:function(Et){var cr;return i(cr=this.sockets).call(cr,function(er,nr){Et!==nr&&er&&(er.removeAllListenersX("info"),er.disconnect())}),this.sockets[Et]}},{key:"failed",value:function(Et){var cr=this.sockets[Et];cr&&(cr.removeAllListenersX("info"),cr.disconnect())}},{key:"getTransport",value:function(Et){var cr=ae.getGlobal();if(typeof window>"u"){var er=Et.split(":");return cr&&!cr.location&&er.length>1&&(cr.location={protocol:er.shift(),port:er.pop(),hostname:er.join("")}),["websocket"]}return this.clientProto.options.transports?this.clientProto.options.transports:de.name!=="IE"||cr.WebSocket?["websocket"]:["xhr-polling"]}},{key:"doConnect",value:function(Et,cr){var er=this;if(this.clientProto&&this.clientProto.__destroyed===!0)return L.reject("instance has been destroyed");var nr=this.getTransport(Et),dr=V();return new L(function(ir,tr){var ur,or,fr,lr;try{er.config.binaryWebsocket?(lr=new Ue(er.clientProto)).connect(Et,{connectTimeout:Ie.connectTimeout}):lr=Ce.connect(Et,{transports:z(nr).call(nr),reconnect:!1,"force new connection":!0,"connect timeout":Ie.connectTimeout,needToXHR:typeof er.clientProto.options.needToXHR=="boolean"?er.clientProto.options.needToXHR:Ie.needToXHR}),er.sockets[cr]=lr}catch(Sr){var gr;return er.logger.warn(re(gr="link::connectToUrl ".concat(cr,":io.connect caught exception: ")).call(gr,Sr&&Sr.message),Sr),void tr(new qe("socket_error",408,{startTime:dr,url:Et,reason:Sr.message,rawError:Sr}))}er.logger.info(re(ur=re(or="link::connectToUrl ".concat(cr,": socket url: ")).call(or,Et,", transports: ")).call(ur,oe(nr))),lr.on("connect",function(){er.logger.info("link::connectToUrl ".concat(cr," success")),er.success(cr),er.clientProto.reporterHookLinkKeep.start({trace_id:lr.socket.sessionid}),er.clientProto.reporterHookLinkKeep.update({code:0,description:"",operation_type:0,target:Et}),er.clientProto.url=Et,ir(lr)}),lr.on("handshake_failed",function(){er.failed(cr),tr(new qe("handshake_failed",408,{startTime:dr,url:Et}))}),lr.on("connect_failed",function(Sr){er.failed(cr),tr(new qe("connect_failed",408,{startTime:dr,url:Et,reason:Sr}))}),lr.on("error",function(){var Sr,wr=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",kr=arguments.length>1?arguments[1]:void 0,mr=kr&&kr.message||wr;er.logger.warn(re(Sr="link::onSocketError ".concat(cr,": reason is ")).call(Sr,mr,", error is "),kr),tr(new qe("socket_error",408,{startTime:dr,url:Et,reason:mr,rawError:kr}))}),lr.on("info",function(Sr,wr){var kr,mr;wr?er.logger.info(re(kr="link::onSocketInfo ".concat(cr,": ")).call(kr,Sr,", extraInfo:"),wr):er.logger.info(re(mr="link::onSocketInfo ".concat(cr,": ")).call(mr,Sr,"."))}),lr.on("message",le(fr=er.clientProto.onMessage).call(fr,er.clientProto)),lr.on("disconnect",function(Sr){er.logger.warn("imsocket::onSocketDisconnect: socket url: ".concat(Et,", disconnected"),Sr),er.clientProto.hasLogin=!1,er.clientProto.statusProtector.processEvent("auth/loginLifeCycleConnectionBroken",new Error("disconnect due to socket ondisconnect")),er.clientProto.doLogout?er.clientProto.logout():er.clientProto.onDisconnect("link::socketDisconnect",Sr)}),lr.on("websocketOnclose",function(Sr){er.clientProto.reporterHookLinkKeep.update({code:Sr&&Sr.code||0,description:Sr&&Sr.reason||"",operation_type:1,target:Et}),er.clientProto.reporterHookLinkKeep.end(!1)})})}},{key:"destroy",value:function(){this.urls=[],this.resetSockets()}}]),jt}()},function(t,r,e){var n=e(24).default,g=e(142),y=e(158),i=e(195),k=e(287),L=e(658),$=e(197),V=e(292),z=e(669),re=e(293);function oe(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */t.exports=oe=function(){return le},t.exports.__esModule=!0,t.exports.default=t.exports;var le={},ue=Object.prototype,ie=ue.hasOwnProperty,ae=g||function(Ir,Nr,Er){Ir[Nr]=Er.value},Ie=typeof y=="function"?y:{},de=Ie.iterator||"@@iterator",Ce=Ie.asyncIterator||"@@asyncIterator",Ue=Ie.toStringTag||"@@toStringTag";function qe(Ir,Nr,Er){return g(Ir,Nr,{value:Er,enumerable:!0,configurable:!0,writable:!0}),Ir[Nr]}try{qe({},"")}catch{qe=function(Nr,Er,sr){return Nr[Er]=sr}}function jt(Ir,Nr,Er,sr){var xr=Nr&&Nr.prototype instanceof cr?Nr:cr,Or=i(xr.prototype),Mr=new wr(sr||[]);return ae(Or,"_invoke",{value:fr(Ir,Er,Mr)}),Or}function Fe(Ir,Nr,Er){try{return{type:"normal",arg:Ir.call(Nr,Er)}}catch(sr){return{type:"throw",arg:sr}}}le.wrap=jt;var Et={};function cr(){}function er(){}function nr(){}var dr={};qe(dr,de,function(){return this});var ir=k&&k(k(kr([])));ir&&ir!==ue&&ie.call(ir,de)&&(dr=ir);var tr=nr.prototype=cr.prototype=i(dr);function ur(Ir){var Nr;L(Nr=["next","throw","return"]).call(Nr,function(Er){qe(Ir,Er,function(sr){return this._invoke(Er,sr)})})}function or(Ir,Nr){var Er;ae(this,"_invoke",{value:function(sr,xr){function Or(){return new Nr(function(Mr,br){(function hr(Tr,Br,Fr,Lr){var qr=Fe(Ir[Tr],Ir,Br);if(qr.type!=="throw"){var Ur=qr.arg,Qr=Ur.value;return Qr&&n(Qr)=="object"&&ie.call(Qr,"__await")?Nr.resolve(Qr.__await).then(function(vn){hr("next",vn,Fr,Lr)},function(vn){hr("throw",vn,Fr,Lr)}):Nr.resolve(Qr).then(function(vn){Ur.value=vn,Fr(Ur)},function(vn){return hr("throw",vn,Fr,Lr)})}Lr(qr.arg)})(sr,xr,Mr,br)})}return Er=Er?Er.then(Or,Or):Or()}})}function fr(Ir,Nr,Er){var sr="suspendedStart";return function(xr,Or){if(sr==="executing")throw new Error("Generator is already running");if(sr==="completed"){if(xr==="throw")throw Or;return mr()}for(Er.method=xr,Er.arg=Or;;){var Mr=Er.delegate;if(Mr){var br=lr(Mr,Er);if(br){if(br===Et)continue;return br}}if(Er.method==="next")Er.sent=Er._sent=Er.arg;else if(Er.method==="throw"){if(sr==="suspendedStart")throw sr="completed",Er.arg;Er.dispatchException(Er.arg)}else Er.method==="return"&&Er.abrupt("return",Er.arg);sr="executing";var hr=Fe(Ir,Nr,Er);if(hr.type==="normal"){if(sr=Er.done?"completed":"suspendedYield",hr.arg===Et)continue;return{value:hr.arg,done:Er.done}}hr.type==="throw"&&(sr="completed",Er.method="throw",Er.arg=hr.arg)}}}function lr(Ir,Nr){var Er=Nr.method,sr=Ir.iterator[Er];if(sr===void 0)return Nr.delegate=null,Er==="throw"&&Ir.iterator.return&&(Nr.method="return",Nr.arg=void 0,lr(Ir,Nr),Nr.method==="throw")||Er!=="return"&&(Nr.method="throw",Nr.arg=new TypeError("The iterator does not provide a '"+Er+"' method")),Et;var xr=Fe(sr,Ir.iterator,Nr.arg);if(xr.type==="throw")return Nr.method="throw",Nr.arg=xr.arg,Nr.delegate=null,Et;var Or=xr.arg;return Or?Or.done?(Nr[Ir.resultName]=Or.value,Nr.next=Ir.nextLoc,Nr.method!=="return"&&(Nr.method="next",Nr.arg=void 0),Nr.delegate=null,Et):Or:(Nr.method="throw",Nr.arg=new TypeError("iterator result is not an object"),Nr.delegate=null,Et)}function gr(Ir){var Nr={tryLoc:Ir[0]};1 in Ir&&(Nr.catchLoc=Ir[1]),2 in Ir&&(Nr.finallyLoc=Ir[2],Nr.afterLoc=Ir[3]),this.tryEntries.push(Nr)}function Sr(Ir){var Nr=Ir.completion||{};Nr.type="normal",delete Nr.arg,Ir.completion=Nr}function wr(Ir){this.tryEntries=[{tryLoc:"root"}],L(Ir).call(Ir,gr,this),this.reset(!0)}function kr(Ir){if(Ir){var Nr=Ir[de];if(Nr)return Nr.call(Ir);if(typeof Ir.next=="function")return Ir;if(!isNaN(Ir.length)){var Er=-1,sr=function xr(){for(;++Er<Ir.length;)if(ie.call(Ir,Er))return xr.value=Ir[Er],xr.done=!1,xr;return xr.value=void 0,xr.done=!0,xr};return sr.next=sr}}return{next:mr}}function mr(){return{value:void 0,done:!0}}return er.prototype=nr,ae(tr,"constructor",{value:nr,configurable:!0}),ae(nr,"constructor",{value:er,configurable:!0}),er.displayName=qe(nr,Ue,"GeneratorFunction"),le.isGeneratorFunction=function(Ir){var Nr=typeof Ir=="function"&&Ir.constructor;return!!Nr&&(Nr===er||(Nr.displayName||Nr.name)==="GeneratorFunction")},le.mark=function(Ir){return $?$(Ir,nr):(Ir.__proto__=nr,qe(Ir,Ue,"GeneratorFunction")),Ir.prototype=i(tr),Ir},le.awrap=function(Ir){return{__await:Ir}},ur(or.prototype),qe(or.prototype,Ce,function(){return this}),le.AsyncIterator=or,le.async=function(Ir,Nr,Er,sr,xr){xr===void 0&&(xr=V);var Or=new or(jt(Ir,Nr,Er,sr),xr);return le.isGeneratorFunction(Nr)?Or:Or.next().then(function(Mr){return Mr.done?Mr.value:Or.next()})},ur(tr),qe(tr,Ue,"Generator"),qe(tr,de,function(){return this}),qe(tr,"toString",function(){return"[object Generator]"}),le.keys=function(Ir){var Nr=Object(Ir),Er=[];for(var sr in Nr)Er.push(sr);return z(Er).call(Er),function xr(){for(;Er.length;){var Or=Er.pop();if(Or in Nr)return xr.value=Or,xr.done=!1,xr}return xr.done=!0,xr}},le.values=kr,wr.prototype={constructor:wr,reset:function(Ir){var Nr;if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,L(Nr=this.tryEntries).call(Nr,Sr),!Ir)for(var Er in this)Er.charAt(0)==="t"&&ie.call(this,Er)&&!isNaN(+re(Er).call(Er,1))&&(this[Er]=void 0)},stop:function(){this.done=!0;var Ir=this.tryEntries[0].completion;if(Ir.type==="throw")throw Ir.arg;return this.rval},dispatchException:function(Ir){if(this.done)throw Ir;var Nr=this;function Er(hr,Tr){return Or.type="throw",Or.arg=Ir,Nr.next=hr,Tr&&(Nr.method="next",Nr.arg=void 0),!!Tr}for(var sr=this.tryEntries.length-1;sr>=0;--sr){var xr=this.tryEntries[sr],Or=xr.completion;if(xr.tryLoc==="root")return Er("end");if(xr.tryLoc<=this.prev){var Mr=ie.call(xr,"catchLoc"),br=ie.call(xr,"finallyLoc");if(Mr&&br){if(this.prev<xr.catchLoc)return Er(xr.catchLoc,!0);if(this.prev<xr.finallyLoc)return Er(xr.finallyLoc)}else if(Mr){if(this.prev<xr.catchLoc)return Er(xr.catchLoc,!0)}else{if(!br)throw new Error("try statement without catch or finally");if(this.prev<xr.finallyLoc)return Er(xr.finallyLoc)}}}},abrupt:function(Ir,Nr){for(var Er=this.tryEntries.length-1;Er>=0;--Er){var sr=this.tryEntries[Er];if(sr.tryLoc<=this.prev&&ie.call(sr,"finallyLoc")&&this.prev<sr.finallyLoc){var xr=sr;break}}xr&&(Ir==="break"||Ir==="continue")&&xr.tryLoc<=Nr&&Nr<=xr.finallyLoc&&(xr=null);var Or=xr?xr.completion:{};return Or.type=Ir,Or.arg=Nr,xr?(this.method="next",this.next=xr.finallyLoc,Et):this.complete(Or)},complete:function(Ir,Nr){if(Ir.type==="throw")throw Ir.arg;return Ir.type==="break"||Ir.type==="continue"?this.next=Ir.arg:Ir.type==="return"?(this.rval=this.arg=Ir.arg,this.method="return",this.next="end"):Ir.type==="normal"&&Nr&&(this.next=Nr),Et},finish:function(Ir){for(var Nr=this.tryEntries.length-1;Nr>=0;--Nr){var Er=this.tryEntries[Nr];if(Er.finallyLoc===Ir)return this.complete(Er.completion,Er.afterLoc),Sr(Er),Et}},catch:function(Ir){for(var Nr=this.tryEntries.length-1;Nr>=0;--Nr){var Er=this.tryEntries[Nr];if(Er.tryLoc===Ir){var sr=Er.completion;if(sr.type==="throw"){var xr=sr.arg;Sr(Er)}return xr}}throw new Error("illegal catch attempt")},delegateYield:function(Ir,Nr,Er){return this.delegate={iterator:kr(Ir),resultName:Nr,nextLoc:Er},this.method==="next"&&(this.arg=void 0),Et}},le}t.exports=oe,t.exports.__esModule=!0,t.exports.default=t.exports},function(t,r,e){t.exports=e(659)},function(t,r,e){t.exports=e(660)},function(t,r,e){var n=e(661);t.exports=n},function(t,r,e){var n=e(236);t.exports=n},function(t,r,e){t.exports=e(663)},function(t,r,e){var n=e(664);e(665),e(666),e(667),e(668),t.exports=n},function(t,r,e){var n=e(238);t.exports=n},function(t,r,e){e(239)},function(t,r,e){e(253)},function(t,r,e){var n=e(1),g=e(76),y=e(106);n({target:"Promise",stat:!0,forced:!0},{try:function(i){var k=g.f(this),L=y(i);return(L.error?k.reject:k.resolve)(L.value),k.promise}})},function(t,r,e){e(254)},function(t,r,e){t.exports=e(670)},function(t,r,e){t.exports=e(671)},function(t,r,e){var n=e(672);t.exports=n},function(t,r,e){var n=e(283);t.exports=n},function(t,r,e){t.exports=e(674)},function(t,r,e){var n=e(675);t.exports=n},function(t,r,e){var n=e(257);t.exports=n},function(t,r,e){var n=e(152),g=e(22),y=e(23),i=e(4),k=e(6),L=e(56),$=e(44),V=e(45),z=e(153),re=e(154),oe=e(122);function le(Ue){var qe=function(){if(typeof Reflect>"u"||!n||n.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(n(Boolean,[],function(){})),!0}catch{return!1}}();return function(){var jt,Fe=oe(Ue);if(qe){var Et=oe(this).constructor;jt=n(Fe,arguments,Et)}else jt=Fe.apply(this,arguments);return re(this,jt)}}var ue=e(141),ie=e(677),ae=e(698),Ie=e(35),de=e(0).get,Ce=e(0);t.exports=function(Ue){z(jt,Ue);var qe=le(jt);function jt(Fe){var Et,cr=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return $(this,jt),(Et=qe.call(this)).binaryType="arraybuffer",Et.clientProto=Fe,Et.logger=Fe.logger,Et.config=cr,Et.websocket=null,Et.socketUrl="",Et.socketConnectTimer=0,Et.status="disconnected",Et.socket={sessionid:"",connected:!1},Et}return V(jt,[{key:"setSessionId",value:function(Fe){this.socket.sessionid=Fe}},{key:"connect",value:function(Fe){this.status="connecting",Fe=Fe.replace(/http(s)?:\/\//,"");var Et=this.clientProto.options.secure?"wss":"ws";this._createWebsocket(Et+"://"+Fe+"/websocket")}},{key:"disconnect",value:function(){if(this.status="disconnected",this.socket.connected=!1,this.websocket){this.logger.log("imwebsocket:: close websocket");try{this.websocket.close()}catch(Fe){this.logger.warn("imwebsocket::attempt to close websocket error",Fe)}this._clean()}}},{key:"removeAllListenersX",value:function(Fe){this.removeListener(Fe)}},{key:"_clean",value:function(){this.status="disconnected",this.socket.connected=!1,this.socketConnectTimer&&clearTimeout(this.socketConnectTimer),this.websocket&&(this.socketUrl=void 0,this.websocket.onmessage=null,this.websocket.onopen=null,this.websocket.onerror=null,this.websocket.onclose=null,this.websocket=null)}},{key:"_onConnect",value:function(){this.status="connected",this.socket.connected=!0,this.emit("connect"),this.socketConnectTimer&&clearTimeout(this.socketConnectTimer)}},{key:"_createWebsocket",value:function(Fe){var Et,cr=this,er=this;this.socketConnectTimer=g(function(){cr.logger.error("imwebsocket::Websocket connect timeout. url: ",cr.socketUrl),cr.emit("connect_failed","imwebsocket::Websocket connect timeout")},this.config.connectTimeout||8e3),this.socketUrl=Fe,this.websocket=new WebSocket(Fe),this.websocket.binaryType=this.binaryType,this.websocket.onmessage=y(Et=this._onMessage).call(Et,this),this.websocket.onclose=function(){er.logger.log("imwebsocket::Websocket onclose done"),er.status==="connected"?(er._clean(),cr.emit("websocketOnclose"),cr.emit("disconnect")):(er._clean(),cr.emit("connect_failed","imwebsocket::Websocket onclose"))},this.websocket.onerror=function(nr){er.logger.error("imwebsocket::Websocket onerror",nr),er.status==="connected"?(er._clean(),cr.emit("websocketOnclose"),cr.emit("disconnect")):(er._clean(),cr.emit("connect_failed","imwebsocket::Websocket onerror"))},this.websocket.onopen=function(){er._onConnect()}}},{key:"_onMessage",value:function(Fe){if(Fe.data){var Et,cr=new ae(Fe.data),er={sid:-1,cid:-1,ser:-1,packetLength:-1},nr=null;try{cr.unmarshalHeader(),er=cr.getHeader(),nr=cr.getInnerHeader()}catch(Sr){er=cr.getHeader(),nr=cr.getInnerHeader(),this.reportBinaryError({err:Sr,sid:nr?nr.sid:er.sid,cid:nr?nr.cid:er.cid,type:"decode"})}var dr=nr?nr.sid:er.sid,ir=nr?nr.cid:er.cid,tr=i(Et="".concat(dr,"_")).call(Et,ir),ur=de(this.clientProto,"parser.configMap.packetConfig.".concat(tr));if(ur){var or;try{or=cr.unmarshal(ur.response)}catch(Sr){var fr,lr,gr;return this.reportBinaryError({err:Sr,sid:dr,cid:ir,type:"decode"}),cr.reset(),er.code=998,er.sid=dr,er.cid=ir,this.clientProto.logger.error(i(fr=i(lr=i(gr='imwebsocket::onMessage "'.concat(dr,"_")).call(gr,ir,'", ser ')).call(lr,er.ser,", packetLength ")).call(fr,er.packetLength," unmarshal error"),Sr),void this.emit("message",k(er))}this.emit("message",or)}else this.clientProto.logger.warn("imwebsocket::onMessage cmd not found",tr);cr.reset()}}},{key:"send",value:function(Fe,Et){var cr=new ie(Fe.SID,Fe.CID,Fe.SER),er=de(this.clientProto,"parser.configMap.cmdConfig.".concat(Et));if(!er)throw new Ie('imwebsocket::send "'.concat(Et,'" cmdConfig not found'),999);var nr,dr=er.params,ir="";try{ir=k(Fe.Q),nr=cr.marshal(Fe.Q,dr)}catch(tr){throw this.reportBinaryError({err:tr,sid:Fe.SID,cid:Fe.CID,rawStr:ir,type:"encode"}),cr.pack.reset(),new Ie('imwebsocket::send "'.concat(Et,'" marshal error'),999,{rawError:tr})}this.websocket.send(nr),cr.pack.reset()}},{key:"reportBinaryError",value:function(Fe){var Et,cr=this.clientProto,er=Fe.err,nr=Fe.rawStr,dr=Fe.sid,ir=Fe.cid,tr=Fe.type;cr.reporter.reportTraceStart("exceptions",{user_id:cr.account,trace_id:Ce.get(cr,"socket.socket.sessionid"),start_time:L(),action:2,exception_service:9}),cr.reporter.reportTraceUpdateV2("exceptions",{code:tr==="encode"?999:998,description:er&&(er.message||"".concat(er.code))+" rawObj: ".concat(nr),operation_type:tr==="encode"?3:4,target:i(Et="".concat(dr,"-")).call(Et,ir)}),cr.reporter.reportTraceEnd("exceptions",1)}}]),jt}(ue)},function(t,r,e){var n=e(5),g=e(15),y=e(2),i=e(28),k=e(6),L=e(44),$=e(45),V=e(678);function z(oe){if(typeof oe!="number"){if(oe==null)return!1;oe=Number(oe)}if(isNaN(oe))throw new Error("Number type conversion error");return!0}function re(oe){return oe==null}t.exports=function(){function oe(le,ue,ie){L(this,oe),this.pack=new V,this.packetLength=0,this.serviceId=le,this.commandId=ue,this.serialId=ie,this.tag=0}return $(oe,[{key:"marshalHeader",value:function(){this.pack.putVarInt(this.packetLength),this.pack.putByte(this.serviceId),this.pack.putByte(this.commandId),this.pack.putShort(this.serialId),this.pack.putByte(this.tag)}},{key:"marshalProperty",value:function(le){var ue=this,ie=n(le),ae=g(ie).call(ie,function(Ie){return!re(Ie)});this.pack.putVarInt(ae.length),y(ae).call(ae,function(Ie){ue.pack.putVarInt(Number(Ie)),i(le[Ie])||Object.prototype.toString.call(le[Ie])==="[object Object]"?ue.pack.putString(k(le[Ie])):ue.pack.putString(String(le[Ie]))})}},{key:"marshalPropertyArray",value:function(le){var ue=this,ie=le.length;this.pack.putVarInt(ie),y(le).call(le,function(ae){ue.marshalProperty(ae&&ae.v)})}},{key:"marshalStrArray",value:function(le){var ue=this,ie=g(le).call(le,function(Ie){return!re(Ie)}),ae=ie.length;this.pack.putVarInt(ae),y(ie).call(ie,function(Ie){ue.pack.putString(String(Ie))})}},{key:"marshalLongArray",value:function(le){var ue=this,ie=g(le).call(le,function(Ie){return z(Ie)}),ae=ie.length;this.pack.putVarInt(ae),y(ie).call(ie,function(Ie){ue.putLong(Ie)})}},{key:"marshalStrStrMap",value:function(le){var ue=this,ie=n(le),ae=g(ie).call(ie,function(Ie){return!re(le[Ie])&&!re(Ie)});this.pack.putVarInt(ae.length),y(ae).call(ae,function(Ie){ue.pack.putString(String(Ie)),ue.pack.putString(String(le[Ie]))})}},{key:"marshalStrLongMap",value:function(le){var ue=this,ie=n(le),ae=g(ie).call(ie,function(Ie){return z(le[Ie])&&!re(Ie)});this.pack.putVarInt(ae.length),y(ae).call(ae,function(Ie){ue.pack.putString(String(Ie)),ue.putLong(le[Ie])})}},{key:"marshalLongLongMap",value:function(le){var ue=this,ie=n(le),ae=g(ie).call(ie,function(Ie){var de=Number(Ie);return z(de)&&z(le[de])});this.pack.putVarInt(ae.length),y(ae).call(ae,function(Ie){var de=Number(Ie);ue.putLong(de),ue.putLong(le[de])})}},{key:"marshalKVArray",value:function(le){var ue=this,ie=le.length;this.pack.putVarInt(ie),y(le).call(le,function(ae){ue.marshalStrStrMap(ae)})}},{key:"putLong",value:function(le){typeof le=="string"&&le.length>15?this.pack.putStringAsLong(le):this.pack.putLong(Number(le))}},{key:"marshal",value:function(le,ue){var ie=this;return this.marshalHeader(),ue&&y(ue).call(ue,function(ae,Ie){var de=ae.type,Ce=le[Ie]&&le[Ie].v;if(!re(Ce))switch(de){case"PropertyArray":ie.marshalPropertyArray(Ce);break;case"Property":ie.marshalProperty(Ce);break;case"Byte":if(!z(Ce))return;ie.pack.putByte(Number(Ce));break;case"Int":if(!z(Ce))return;ie.pack.putInt(Number(Ce));break;case"Bool":Ce==="false"?Ce=!1:Ce==="true"&&(Ce=!0),ie.pack.putBoolean(Ce);break;case"Long":if(!z(Ce))return;ie.putLong(Ce);break;case"LongArray":ie.marshalLongArray(Ce);break;case"String":ie.pack.putString(String(Ce));break;case"StrArray":ie.marshalStrArray(Ce);break;case"StrStrMap":ie.marshalStrStrMap(Ce);break;case"StrLongMap":ie.marshalStrLongMap(Ce);break;case"LongLongMap":ie.marshalLongLongMap(Ce);break;case"KVArray":ie.marshalKVArray(Ce)}}),this.pack.getBuffer()}}]),oe}()},function(t,r,e){var n=e(9),g=e(44),y=e(45),i=e(295),k=i.encodeText,L=i.setBigUint64,$=i.setBigUint64ForNumberOverflow,V=i.varintToBytes;t.exports=function(){function z(){g(this,z),this.buffer=new Uint8Array(this.pageSize),this.view=new DataView(this.buffer.buffer),this.offset=0,this.pageSize=1024,this.capacity=1048576}return y(z,[{key:"reset",value:function(){this.offset=0,this.buffer=null,this.view=null}},{key:"size",value:function(){return this.offset}},{key:"getBuffer",value:function(){var re;return n(re=this.buffer).call(re,0,this.offset).buffer}},{key:"ensureCapacity",value:function(re){var oe=this.offset+re;if(oe>this.capacity)throw new Error("PackException over limit");if(oe>this.buffer.byteLength){var le=Math.ceil(oe/this.pageSize)*this.pageSize,ue=new Uint8Array(le);ue.set(this.buffer),this.buffer=ue,this.view=new DataView(this.buffer.buffer)}}},{key:"putRaw",value:function(re){this.ensureCapacity(re.length);try{this.buffer.set(re,this.offset),this.offset+=re.length}catch{throw new Error("PackException raw")}}},{key:"putByte",value:function(re){this.ensureCapacity(1);try{this.view.setUint8(this.offset++,re)}catch{throw new Error("PackException byte")}}},{key:"putString",value:function(re){try{var oe=k(re);this.putVarbin(oe)}catch{throw new Error("PackException string")}}},{key:"putInt",value:function(re){this.ensureCapacity(4);try{this.view.setInt32(this.offset,re,!0),this.offset+=4}catch{throw new Error("PackException int")}}},{key:"putVarInt",value:function(re){var oe=V(re);this.putRaw(oe)}},{key:"putBoolean",value:function(re){this.ensureCapacity(1);try{this.view.setUint8(this.offset++,re?1:0)}catch{throw new Error("PackException boolean")}}},{key:"putLong",value:function(re){this.ensureCapacity(8);try{var oe=L(re,!0);this.buffer.set(oe,this.offset),this.offset+=8}catch{throw new Error("PackException long")}}},{key:"putStringAsLong",value:function(re){this.ensureCapacity(8);try{var oe=$(re,!0);this.buffer.set(oe,this.offset),this.offset+=8}catch{throw new Error("PackException stringAsLong")}}},{key:"putShort",value:function(re){this.ensureCapacity(2);try{this.view.setInt16(this.offset,re,!0),this.offset+=2}catch{throw new Error("PackException short")}}},{key:"putVarbin",value:function(re){if(!re)return this.ensureCapacity(1),this.putVarInt(0);if(re.byteLength>Math.pow(2,31)-2)throw new Error("PackException varbin");var oe=V(re.length);this.ensureCapacity(oe.length+re.length);try{this.buffer.set(oe,this.offset),this.offset+=oe.length,this.buffer.set(re,this.offset),this.offset+=re.length}catch{throw new Error("PackException varbin")}}}]),z}()},function(t,r,e){t.exports=e(680)},function(t,r,e){var n=e(681);t.exports=n},function(t,r,e){var n=e(18),g=e(682),y=String.prototype;t.exports=function(i){var k=i.codePointAt;return typeof i=="string"||i===y||n(y,i)&&k===y.codePointAt?g:k}},function(t,r,e){e(683);var n=e(27);t.exports=n("String").codePointAt},function(t,r,e){var n=e(1),g=e(234).codeAt;n({target:"String",proto:!0},{codePointAt:function(y){return g(this,y)}})},function(t,r,e){t.exports=e(685)},function(t,r,e){var n=e(686);t.exports=n},function(t,r,e){e(687);var n=e(14);t.exports=n.String.fromCodePoint},function(t,r,e){var n=e(1),g=e(13),y=e(114),i=RangeError,k=String.fromCharCode,L=String.fromCodePoint,$=g([].join);n({target:"String",stat:!0,arity:1,forced:!!L&&L.length!=1},{fromCodePoint:function(V){for(var z,re=[],oe=arguments.length,le=0;oe>le;){if(z=+arguments[le++],y(z,1114111)!==z)throw i(z+" is not a valid code point");re[le]=z<65536?k(z):k(55296+((z-=65536)>>10),z%1024+56320)}return $(re,"")}})},function(t,r,e){var n=e(313);t.exports=function(g){if(n(g))return g},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,r,e){t.exports=e(690)},function(t,r,e){var n=e(691);t.exports=n},function(t,r,e){var n=e(235);t.exports=n},function(t,r,e){var n=e(158),g=e(64);t.exports=function(y,i){var k=y==null?null:n!==void 0&&g(y)||y["@@iterator"];if(k!=null){var L,$,V,z,re=[],oe=!0,le=!1;try{if(V=(k=k.call(y)).next,i===0){if(Object(k)!==k)return;oe=!1}else for(;!(oe=(L=V.call(k)).done)&&(re.push(L.value),re.length!==i);oe=!0);}catch(ue){le=!0,$=ue}finally{try{if(!oe&&k.return!=null&&(z=k.return(),Object(z)!==z))return}finally{if(le)throw $}}return re}},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,r,e){t.exports=e(694)},function(t,r,e){var n=e(695);t.exports=n},function(t,r,e){var n=e(261);t.exports=n},function(t,r){t.exports=function(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,r,e){var n=e(121),g=e(43),y=e(63),i=function(re){var oe;if(re!==void 0)return(oe=z(re)).sign=1,oe},k=function(re){return Object.prototype.toString.call(re)==="[object Array]"},L=function(re){var oe;return n(oe=[typeof re=="number",typeof re=="string"&&re.length>0,k(re)&&re.length>0,re instanceof z]).call(oe,function(le){return le===!0})},$="Invalid Number",V="Invalid Number - Division By Zero";function z(re){var oe;if(!(this instanceof z))return new z(re);if(this.number=[],this.sign=1,this.rest=0,L(re)){if(k(re)){for((re.length&&re[0]==="-"||re[0]==="+")&&(this.sign=re[0]==="+"?1:-1,re.shift(0)),oe=re.length-1;oe>=0;oe--)if(!this.addDigit(re[oe]))return}else for((re=re.toString()).charAt(0)!=="-"&&re.charAt(0)!=="+"||(this.sign=re.charAt(0)==="+"?1:-1,re=re.substring(1)),oe=re.length-1;oe>=0;oe--)if(!this.addDigit(g(re.charAt(oe),10)))return}else this.number=$}z.prototype.addDigit=function(re){return function(oe){return/^\d$/.test(oe)}(re)?(this.number.push(re),this):(this.number=$,!1)},z.prototype._compare=function(re){var oe,le;if(!L(re))return null;if(oe=z(re),this.sign!==oe.sign)return this.sign;if(this.number.length>oe.number.length)return this.sign;if(this.number.length<oe.number.length)return-1*this.sign;for(le=this.number.length-1;le>=0;le--){if(this.number[le]>oe.number[le])return this.sign;if(this.number[le]<oe.number[le])return-1*this.sign}return 0},z.prototype.gt=function(re){return this._compare(re)>0},z.prototype.gte=function(re){return this._compare(re)>=0},z.prototype.equals=function(re){return this._compare(re)===0},z.prototype.lte=function(re){return this._compare(re)<=0},z.prototype.lt=function(re){return this._compare(re)<0},z.prototype.subtract=function(re){var oe;return re===void 0?this:(oe=z(re),this.sign!==oe.sign?(this.number=z._add(this,oe),this):(this.sign=this.lt(oe)?-1:1,this.number=i(this).lt(i(oe))?z._subtract(oe,this):z._subtract(this,oe),this))},z._add=function(re,oe){var le,ue=0,ie=Math.max(re.number.length,oe.number.length);for(le=0;le<ie||ue>0;le++)re.number[le]=(ue+=(re.number[le]||0)+(oe.number[le]||0))%10,ue=Math.floor(ue/10);return re.number},z._subtract=function(re,oe){var le,ue,ie=0,ae=re.number.length;for(le=0;le<ae;le++)re.number[le]-=(oe.number[le]||0)+ie,re.number[le]+=10*(ie=re.number[le]<0?1:0);for(le=0,ae=re.number.length-1;re.number[ae-le]===0&&ae-le>0;)le++;return le>0&&y(ue=re.number).call(ue,-le),re.number},z.prototype.multiply=function(re){if(re===void 0)return this;var oe,le,ue=z(re),ie=0,ae=[];if(this.isZero()||ue.isZero())return z(0);for(this.sign*=ue.sign,oe=0;oe<this.number.length;oe++)for(ie=0,le=0;le<ue.number.length||ie>0;le++)ae[oe+le]=(ie+=(ae[oe+le]||0)+this.number[oe]*(ue.number[le]||0))%10,ie=Math.floor(ie/10);return this.number=ae,this},z.prototype.divide=function(re){if(re===void 0)return this;var oe,le,ue=z(re),ie=[],ae=z(0);if(ue.isZero())return this.number=V,this;if(this.isZero())return this.rest=z(0),this;if(this.sign*=ue.sign,ue.sign=1,ue.number.length===1&&ue.number[0]===1)return this.rest=z(0),this;for(oe=this.number.length-1;oe>=0;oe--)for(ae.multiply(10),ae.number[0]=this.number[oe],ie[oe]=0;ue.lte(ae);)ie[oe]++,ae.subtract(ue);for(oe=0,le=ie.length-1;ie[le-oe]===0&&le-oe>0;)oe++;return oe>0&&y(ie).call(ie,-oe),this.rest=ae,this.number=ie,this},z.prototype.mod=function(re){return this.divide(re).rest},z.prototype.isZero=function(){var re;for(re=0;re<this.number.length;re++)if(this.number[re]!==0)return!1;return!0},z.prototype.toString=function(){var re,oe="";if(typeof this.number=="string")return this.number;for(re=this.number.length-1;re>=0;re--)oe+=this.number[re];return this.sign>0?oe:"-"+oe},t.exports=z},function(t,r,e){var n=e(51),g=e(95),y=e(6),i=e(2),k=e(5),L=e(52),$=e(15),V=e(53),z=e(54),re=e(55),oe=e(42),le=e(44),ue=e(45);function ie(de,Ce){var Ue=k(de);if(L){var qe=L(de);Ce&&(qe=$(qe).call(qe,function(jt){return V(de,jt).enumerable})),Ue.push.apply(Ue,qe)}return Ue}function ae(de){for(var Ce=1;Ce<arguments.length;Ce++){var Ue,qe,jt=arguments[Ce]!=null?arguments[Ce]:{};Ce%2?i(Ue=ie(Object(jt),!0)).call(Ue,function(Fe){n(de,Fe,jt[Fe])}):z?re(de,z(jt)):i(qe=ie(Object(jt))).call(qe,function(Fe){oe(de,Fe,V(jt,Fe))})}return de}var Ie=e(699);t.exports=function(){function de(Ce){le(this,de),this.unpack=new Ie(Ce),this.packetLength=0,this.serviceId=0,this.commandId=0,this.serialId=0,this.tag=0,this.resCode=200,this.innerHeader=null,this.msgId=0}return ue(de,[{key:"reset",value:function(){this.innerHeader=null,this.unpack.reset()}},{key:"unmarshalHeader",value:function(){var Ce,Ue=this._unmarshalHeader();this.packetLength=Ue.packetLength,this.serviceId=Ue.serviceId,this.commandId=Ue.commandId,this.serialId=Ue.serialId,this.tag=Ue.tag,this.resCode=Ue.resCode,Ue.serviceId===4&&g(Ce=[1,2,10,11]).call(Ce,Ue.commandId)&&(this.msgId=this.unmarshalLong(),this.innerHeader=this._unmarshalHeader())}},{key:"_unmarshalHeader",value:function(){var Ce=this.unpack.popVarInt(),Ue=this.unpack.popByte(),qe=this.unpack.popByte(),jt=this.unpack.popShort(),Fe=this.unpack.popByte(),Et=200;return this.hasRescode(Fe)&&(Et=this.unpack.popShort()),{packetLength:Ce,serviceId:Ue,commandId:qe,serialId:jt,tag:Fe,resCode:Et}}},{key:"hasRescode",value:function(Ce){return(2&(Ce=Ce||this.tag))!=0}},{key:"getHeader",value:function(){return{packetLength:this.packetLength,sid:this.serviceId,cid:this.commandId,ser:this.serialId,code:this.resCode}}},{key:"getInnerHeader",value:function(){return this.innerHeader?{sid:this.innerHeader.serviceId,cid:this.innerHeader.commandId}:null}},{key:"unmarshalProperty",value:function(){for(var Ce=this.unpack.popVarInt(),Ue={},qe=0;qe<Ce;qe++){var jt=this.unpack.popVarInt(),Fe=this.unpack.popString();Ue[jt]=Fe}return Ue}},{key:"unmarshalPropertyArray",value:function(){for(var Ce=this.unpack.popVarInt(),Ue=[],qe=0;qe<Ce;qe++)Ue.push(this.unmarshalProperty());return Ue}},{key:"unmarshalLong",value:function(){return this.unpack.popLong()}},{key:"unmarshalLongArray",value:function(){for(var Ce=this.unpack.popVarInt(),Ue=[],qe=0;qe<Ce;qe++)Ue.push(this.unpack.popLong());return Ue}},{key:"unmarshalStrArray",value:function(){for(var Ce=this.unpack.popVarInt(),Ue=[],qe=0;qe<Ce;qe++)Ue.push(this.unpack.popString());return Ue}},{key:"unmarshalStrLongMap",value:function(){for(var Ce=this.unpack.popVarInt(),Ue={},qe=0;qe<Ce;qe++){var jt=this.unpack.popString(),Fe=this.unpack.popLong();Ue[jt]=Fe}return Ue}},{key:"unmarshalStrStrMap",value:function(){for(var Ce=this.unpack.popVarInt(),Ue={},qe=0;qe<Ce;qe++){var jt=this.unpack.popString(),Fe=this.unpack.popString();Ue[jt]=Fe}return Ue}},{key:"unmarshalLongLongMap",value:function(){for(var Ce=this.unpack.popVarInt(),Ue={},qe=0;qe<Ce;qe++){var jt=this.unpack.popLong(),Fe=this.unpack.popLong();Ue[jt]=Fe}return{m_map:Ue}}},{key:"unmarshalKVArray",value:function(){for(var Ce=this.unpack.popVarInt(),Ue=[],qe=0;qe<Ce;qe++)Ue.push(this.unmarshalStrStrMap());return Ue}},{key:"unmarshal",value:function(Ce){var Ue,qe=this,jt=ae(ae({},this.getHeader()),{},{r:[]});if(this.innerHeader&&(jt.r[0]=this.msgId,jt.r[1]={body:[],headerPacket:this.getInnerHeader()}),!g(Ue=[200,406,808,810,7101]).call(Ue,jt.code))return y(jt);var Fe=[];return Ce&&i(Ce).call(Ce,function(Et){if(!qe.unpack.checkBufferBoundaryAccess())switch(Et.type){case"PropertyArray":Fe.push(qe.unmarshalPropertyArray());break;case"Property":Fe.push(qe.unmarshalProperty());break;case"Byte":Fe.push(qe.unpack.popByte());break;case"Int":Fe.push(qe.unpack.popInt());break;case"Bool":Fe.push(qe.unpack.popBoolean());break;case"Long":Fe.push(qe.unmarshalLong());break;case"LongArray":Fe.push(qe.unmarshalLongArray());break;case"String":Fe.push(qe.unpack.popString());break;case"StrArray":Fe.push(qe.unmarshalStrArray());break;case"StrStrMap":Fe.push(qe.unmarshalStrStrMap());break;case"StrLongMap":Fe.push(qe.unmarshalStrLongMap());break;case"LongLongMap":Fe.push(qe.unmarshalLongLongMap());break;case"KVArray":Fe.push(qe.unmarshalKVArray())}}),this.innerHeader?jt.r[1].body=Fe:jt.r=Fe,y(jt)}}]),de}()},function(t,r,e){var n=e(9),g=e(68),y=e(44),i=e(45),k=e(295),L=k.decodeText,$=k.getBigUint64;t.exports=function(){function V(z){y(this,V),this.buffer=new Uint8Array(z),this.view=new DataView(z),this.offset=0}return i(V,[{key:"checkBufferBoundaryAccess",value:function(){return this.offset>=this.buffer.byteLength}},{key:"length",value:function(){return this.view&&this.view.byteLength||0}},{key:"getBuffer",value:function(){return this.view.buffer}},{key:"popRaw",value:function(z){try{var re,oe=n(re=this.buffer).call(re,this.offset,this.offset+z);return this.offset+=z,oe}catch{throw new Error("UnpackException raw")}}},{key:"popByte",value:function(){try{var z=this.view.getUint8(this.offset);return this.offset+=1,z}catch{throw new Error("UnpackException byte ")}}},{key:"popVarbin",value:function(){return this.popRaw(this.popVarInt())}},{key:"popString",value:function(){try{var z=this.popVarbin();return L(z)}catch{throw new Error("UnpackException string")}}},{key:"popInt",value:function(){try{var z=this.view.getUint32(this.offset,!0);return this.offset+=4,z}catch{throw new Error("UnpackException int")}}},{key:"popVarInt",value:function(){var z=1,re=0,oe=0;do re+=(127&(oe=this.popByte()))*z,z*=128;while(128&oe);return re}},{key:"popLong",value:function(){try{var z,re=$(n(z=this.buffer).call(z,this.offset,this.offset+8),!0);return this.offset+=8,Number(re)}catch{throw new Error("UnpackException long")}}},{key:"popShort",value:function(){try{var z=this.view.getUint16(this.offset,!0);return this.offset+=2,z}catch{throw new Error("UnpackException short")}}},{key:"popBoolean",value:function(){return this.popByte()>0}},{key:"toString",value:function(){return g(new Uint8Array(this.buffer)).toString()}},{key:"reset",value:function(){this.offset=0,this.buffer=null,this.view=null}}]),V}()},function(t,r,e){var n=e(60),g=e(61),y=e(2),i=e(4),k=e(9),L=e(63),$=e(22),V=e(95),z=e(3),re=e(23),oe=e(82).fn,le=e(35),ue=e(701),ie=e(12),ae=e(0),Ie=e(702);function de(){this.logger.log("offlineListener enter"),this.forceDisconnect(),this.statusProtector.processEvent("auth/loginLifeCycleConnectionBroken",new Error("disconnect due to network offline")),this.options.ondisconnect&&this.options.ondisconnect({code:"offlineListener",callFunc:"link::offlineListener",message:"offlineListener disconnect"}),this.onDisconnect("link::offlineListener","broken")}function Ce(){var Ue=this;this.logger.log("onlineListener start"),this&&this.isConnected()&&!this.connecting?(this.stopHeartbeat(),this.sendCmd("heartbeat",null,function(qe){if(qe){Ue.logger.info("onlineListener heartbeat detect error",qe);try{Ue.forceDisconnect(),Ue.statusProtector.processEvent("auth/loginLifeCycleConnectionBroken",new Error("disconnect due to heartbeat error")),Ue.onDisconnect("link::onHeartbeat","broken")}catch(jt){Ue.logger.info("onlineListener heartbeat websocket.onclose",jt)}}else Ue.logger.log("onlineListener heartbeat detect success")})):this.logger.log("onlineListener disconnected or connecting",this&&this.isConnected(),this.connecting)}oe.initConnect=function(){this.socket=null,this.retryCount=0,this.connecting=!1,this.shouldReconnect=!0,this.hasNotifyDisconnected=!1,this.doLogout=!1},oe.resetConnect=function(){var Ue=this.options;ae.notundef(Ue.needReconnect)?(ae.verifyParamType("needReconnect",Ue.needReconnect,"boolean","link::resetConnect"),this.needReconnect=Ue.needReconnect):this.needReconnect=!0,this.logger.info("link::resetConnect: needReconnect ".concat(this.needReconnect)),ae.notundef(Ue.reconnectionAttempts)&&ae.verifyParamType("reconnectionAttempts",Ue.reconnectionAttempts,"number","link::resetConnect"),ae.notundef(Ue.noCacheLinkUrl)&&ae.verifyParamType("noCacheLinkUrl",Ue.noCacheLinkUrl,"boolean","link::resetConnect"),this.reconnectionAttempts=typeof Ue.reconnectionAttempts=="number"?Ue.reconnectionAttempts:1/0,this.backoff=new ue({min:ie.reconnectionDelay,max:ie.reconnectionDelayMax,jitter:ie.reconnectionJitter})},oe.reportTCPException=function(Ue){var qe=this;y(Ue).call(Ue,function(jt,Fe){var Et,cr=jt.event,er=cr===void 0?{}:cr,nr=jt.message,dr=er.startTime,ir=er.code,tr=er.reason,ur=er.url,or="";nr==="handshake_failed"?or="handshake_failed":nr==="connect_failed"?or=tr?"connect_failed:".concat(tr):"connect_failed":nr==="socket_error"&&(or=tr?"socket.io error:".concat(tr):"socket.io error"),qe.logger.warn(i(Et="connect::failed ".concat(Fe,", ")).call(Et,or),jt),qe.reporter.reportTraceStart("exceptions",{user_id:qe.options.account,trace_id:ae.get(self,"socket.socket.sessionid"),start_time:dr,action:0,exception_service:6}),qe.reporter.reportTraceUpdateV2("exceptions",{code:ir,description:nr,operation_type:0,target:ur,net_connect:qe.checkNetworkAvailable()}),qe.reporter.reportTraceEnd("exceptions",1)})},oe.connect=g(n.mark(function Ue(){var qe,jt,Fe,Et,cr;return n.wrap(function(er){for(;;)switch(er.prev=er.next){case 0:if(Fe=this,clearTimeout(Fe.connectTimer),!Fe.isConnected()){er.next=5;break}return Fe.logger.warn("link::connect: already connected"),er.abrupt("return");case 5:if(!Fe.connecting){er.next=8;break}return Fe.logger.warn("link::connect: already connecting"),er.abrupt("return");case 8:if(Fe.connecting=!0,Fe.hasNotifyDisconnected=!1,Fe.shouldReconnect=!0,Fe.socket&&Fe.forceDisconnect(),Fe.logger.info("link::connect: connect to new socket, autoconnect is "+Fe.autoconnect),typeof Fe.options.socketUrl=="string"&&(Fe.logger.info("link::connect: try to options.socketUrl ",Fe.options.socketUrl),Fe.socketUrls=[Fe.options.socketUrl]),er.prev=14,Fe.socketUrls&&Fe.socketUrls.length>0){er.next=20;break}return er.next=18,Fe.refreshSocketUrl();case 18:Fe.socketUrls=Ie(Fe.socketUrls),Fe.logger.info("link::connect: refreshSocketUrl success, socketConcurrent ".concat(Fe.imsocket.config.socketConcurrent),Fe.socketUrls);case 20:er.next=28;break;case 22:return er.prev=22,er.t0=er.catch(14),Fe.logger.warn("connect::refreshSocketUrl: catch exception,",er.t0&&er.t0.message),Fe.connecting=!1,this.options.ondisconnect({code:"initConnectFail",callFunc:"ProtocolFn.connect",message:"refresh socket url fail"}),er.abrupt("return");case 28:return Fe.imsocket.resetSockets(),Fe.imsocket.setUrls(k(qe=Fe.socketUrls).call(qe,0)),L(jt=Fe.socketUrls).call(jt,0,Fe.imsocket.config.socketConcurrent),er.prev=31,er.next=34,Fe.promiseAbortManager.add(Fe.imsocket.connect());case 34:Fe.socket=er.sent,Fe.onConnect(),er.next=47;break;case 38:er.prev=38,er.t1=er.catch(31),Et=er.t1,cr="",er.t1.errors&&(Fe.reportTCPException(er.t1.errors),Et=er.t1.errors[0]),Et.message==="handshake_failed"?(Fe.onHandshakeFailed(Et.event.startTime,Et.event.url),cr="link::onHandshakeFailed"):Et.message==="connect_failed"?(Fe.onConnectFailed(Et.event.reason,Et.event.startTime,Et.event.url),cr="link::onConnectFailed"):Et.message==="socket_error"?(Fe.onSocketError(Et.event.reason,Et.event.startTime,Et.event.url),cr="link::onSocketError"):Et.message==="Request aborted"?(Fe.imsocket.resetSockets(),cr="link:RequestAborted"):(cr="link::otherFailed",Fe.logger.warn("link::otherFailed",Et)),this.statusProtector.processEvent("auth/loginLifeCycleConnectFail",Et),Fe.connecting=!1,Fe.willReconnect()?Fe.onDisconnect(cr,"broken"):this.options.ondisconnect({code:"initConnectFail",callFunc:"ProtocolFn.connect",message:"init connect fail"});case 47:case"end":return er.stop()}},Ue,this,[[14,22],[31,38]])})),oe.isConnected=function(){return!!this.socket&&!!this.socket.socket&&this.socket.socket.connected},oe.getLoginStatus=function(){return this.statusProtector.getLoginStatus()},oe.disconnect=function(){var Ue=arguments.length>0&&arguments[0]!==void 0?arguments[0]:function(){},qe=this;function jt(Fe){clearTimeout(qe.disconnectCallbackTimer),qe.msgAckBufferManager&&qe.msgAckBufferManager.clear(),qe.roamingMsgSyncDoneBufferManager&&qe.roamingMsgSyncDoneBufferManager.clear(),$(function(){Ue(Fe)},0)}clearTimeout(qe.connectTimer),qe.disconnectCallbackTimer=$(function(){Ue.call(qe,"mark disconnected due to timeout")},1e4),qe.mixStorePolicy=null,qe.appGrayConfig=null,qe.resetReconnectStatus(),clearTimeout(qe.mixStorePolicyClock),this.onlineListener&&typeof window<"u"&&ae.isFunction(window.removeEventListener)&&(window.removeEventListener("online",this.onlineListener),window.removeEventListener("offline",this.offlineListener),this.onlineListener=null,this.offlineListener=null),qe.statusProtector.processEvent("auth/loginLifeCycleLogout"),qe.isConnected()?(qe.logger.warn("link::disconnect: start disconnecting"),qe.logout()):qe.connecting?(qe.logger.warn("link::disconnect: abort connecting"),qe.disconnectSocket()):(qe.logger.warn("link::disconnect: already disconnected"),qe.connecting=!1,qe.shouldReconnect=!1,qe.socket=null,qe.autoconnect=!1,qe.options.ondisconnect({code:"alreadyDisconnected",callFunc:"link::disconnect",message:"manually disconnect status"})),qe.socket&&qe.socket.socket&&qe.socket.socket.transport?qe.socket.socket.transport.onDisconnectDone=function(Fe){qe.logger.warn("link::disconnect: invoke [done] when socket closed",Fe),jt(Fe)}:(qe.logger.warn("link::disconnect: invoke [done]"),jt(null))},oe.resetReconnectStatus=function(){this.backoff&&(this.backoff.setMin(ie.reconnectionDelay),this.backoff.setMax(ie.reconnectionDelayMax),this.backoff.reset()),this.retryCount=0,this.logger.info("link::resetReconnectStatus: reset retryCount and backoff")},oe.onConnect=function(){this.connecting=!1,this.shouldReconnect=!0,this.hasNotifyDisconnected=!1,this.logger.info("link::onConnect success"),this.statusProtector.processEvent("auth/loginLifeCycleConnectSucc"),this.login()},oe.onDisconnect=function(){var Ue=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,qe=arguments.length>1?arguments[1]:void 0,jt=this;this.logger.warn("socket::onDisconnect: "+Ue),jt.connecting=!1,jt.markAllCallbackInvalid(le.newNetworkError({callFunc:Ue,uploadCode:415,disconnectReason:qe})),jt.msgAckBufferManager&&jt.msgAckBufferManager.clear(),jt.roamingMsgSyncDoneBufferManager&&jt.roamingMsgSyncDoneBufferManager.clear(),jt.stopHeartbeat(),jt.reconnect()},oe.willReconnect=function(){var Ue=this.statusProtector.getLastErrorFromLoginCmd(),qe=function(jt){if(jt===void 0)return!1;var Fe=[201,302,317,403,404,417,422];return V(Fe).call(Fe,jt)}(Ue&&Ue.code);return this.shouldReconnect&&this.needReconnect&&this.retryCount<this.reconnectionAttempts&&!qe},oe.reconnect=function(){var Ue=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!this.__destroyed)if(this.willReconnect()){if(this.socket&&(this.logger.info("link::reconnect: try to force disconnect"),this.forceDisconnect()),this.socketUrls.length===0&&!this.options.socketUrl&&typeof Ue.allFailedCB=="function")return this.logger.log("reconnect: All socket links have been polled, trigger hooks"),void Ue.allFailedCB();this.doReconnect()}else this.notifyDisconnect({code:"allAttemptsFailed",message:"All attempts failed"})},oe.doReconnect=function(){var Ue,qe=this;qe.socket=null,qe.retryCount++,qe.hasLogin=!1;var jt,Fe=qe.backoff.duration();if(typeof qe.options.reconnectDelayProvider=="function")try{var Et=qe.options.reconnectDelayProvider(Fe);typeof Et=="number"&&(Fe=Et>=1e3?Et:1e3)}catch(cr){qe.logger.error("link::reconnect:reconnectDelayProvider excute failed,",cr&&cr.message?cr.message:cr)}qe.logger.info(i(Ue="link::reconnect: will retry after ".concat(Fe,"ms, retryCount ")).call(Ue,qe.retryCount)),qe.statusProtector.processEvent("auth/loginLifeCycleWaiting"),jt=qe.options.onwillreconnect({retryCount:qe.retryCount,duration:Fe}),clearTimeout(qe.connectTimer),qe.connectTimer=$(function(){+qe.options.authType==1&&jt instanceof z?(qe.logger.info("link::reconnect: wait onwillreconnect promise"),jt.finally(function(){return qe.connect()})):qe.connect()},Fe)},oe.notifyConnectError=function(Ue){var qe=le.newConnectError({message:Ue,callFunc:"link::notifyConnectError"});this.logger.error("link::notifyConnectError:",qe),this.options.onerror(qe)},oe.notifyDisconnect=function(Ue){this.hasNotifyDisconnected?this.logger.warn("notifyDisconnect:: already notified"):(this.hasNotifyDisconnected=!0,this.disconnectSocket(),this.forceDisconnect(),(Ue=Ue||new le).retryCount=this.retryCount,Ue.willReconnect=this.willReconnect(),this.backoff&&this.backoff.reset(),this.retryCount=0,this.autoconnect=!1,this.logger.info("link::notifyDisconnect: ondisconnected",Ue),this.options.ondisconnect(Ue),this.onWbNotifyHangup instanceof Function&&this.onWbNotifyHangup({content:{account:this.account,channelId:null,timetag:+Date()}}))},oe.disconnectSocket=function(){if(this.isConnected()||this.connecting){this.connecting=!1,this.shouldReconnect=!1;try{this.socket&&this.socket.disconnect()}catch(Ue){this.socket&&typeof this.socket.removeAllListenersX=="function"&&this.socket.removeAllListenersX("info"),this.logger.info("link::disconnectSocket: disconnect failed, error ",Ue&&Ue.message)}}},oe.initOnlineListener=function(){this.needReconnect&&this.options&&this.options.quickReconnect?typeof window<"u"&&ae.isFunction(window.addEventListener)?this.onlineListener||(this.onlineListener=re(Ce).call(Ce,this),this.offlineListener=re(de).call(de,this),this.logger.info("initOnlineListener success"),window.addEventListener("online",this.onlineListener),window.addEventListener("offline",this.offlineListener)):this.logger.warn("initOnlineListener no window.addEventListener"):this.logger.warn("initOnlineListener no quickReconnect")},oe.forceDisconnect=function(){var Ue=this.socket||{};this.socket=null;try{typeof Ue.removeAllListenersX=="function"&&Ue.removeAllListenersX("info"),typeof Ue.disconnect=="function"&&Ue.disconnect()}catch(qe){this.logger.error("forceDisconnect:: oldSocket error",qe||qe.message)}this.hasLogin=!1}},function(t,r){function e(n){n=n||{},this.ms=n.min||100,this.max=n.max||1e4,this.factor=n.factor||2,this.jitter=n.jitter>0&&n.jitter<=1?n.jitter:0,this.attempts=0}t.exports=e,e.prototype.duration=function(){var n=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var g=Math.random(),y=Math.floor(g*this.jitter*n);n=1&Math.floor(10*g)?n+y:n-y}return 0|Math.min(n,this.max)},e.prototype.reset=function(){this.attempts=0},e.prototype.setMin=function(n){this.ms=n},e.prototype.setMax=function(n){this.max=n},e.prototype.setJitter=function(n){this.jitter=n}},function(t,r,e){var n=e(703);t.exports=function(g){return g&&g.length?n(g):[]}},function(t,r,e){var n=e(704),g=e(707),y=e(712),i=e(713),k=e(714),L=e(296);t.exports=function($,V,z){var re=-1,oe=g,le=$.length,ue=!0,ie=[],ae=ie;if(z)ue=!1,oe=y;else if(le>=200){var Ie=V?null:k($);if(Ie)return L(Ie);ue=!1,oe=i,ae=new n}else ae=V?[]:ie;e:for(;++re<le;){var de=$[re],Ce=V?V(de):de;if(de=z||de!==0?de:0,ue&&Ce==Ce){for(var Ue=ae.length;Ue--;)if(ae[Ue]===Ce)continue e;V&&ae.push(Ce),ie.push(de)}else oe(ae,Ce,z)||(ae!==ie&&ae.push(Ce),ie.push(de))}return ie}},function(t,r,e){var n=e(267),g=e(705),y=e(706);function i(k){var L=-1,$=k==null?0:k.length;for(this.__data__=new n;++L<$;)this.add(k[L])}i.prototype.add=i.prototype.push=g,i.prototype.has=y,t.exports=i},function(t,r){t.exports=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this}},function(t,r){t.exports=function(e){return this.__data__.has(e)}},function(t,r,e){var n=e(708);t.exports=function(g,y){return!!(g!=null&&g.length)&&n(g,y,0)>-1}},function(t,r,e){var n=e(709),g=e(710),y=e(711);t.exports=function(i,k,L){return k==k?y(i,k,L):n(i,g,L)}},function(t,r){t.exports=function(e,n,g,y){for(var i=e.length,k=g+(y?1:-1);y?k--:++k<i;)if(n(e[k],k,e))return k;return-1}},function(t,r){t.exports=function(e){return e!=e}},function(t,r){t.exports=function(e,n,g){for(var y=g-1,i=e.length;++y<i;)if(e[y]===n)return y;return-1}},function(t,r){t.exports=function(e,n,g){for(var y=-1,i=e==null?0:e.length;++y<i;)if(g(n,e[y]))return!0;return!1}},function(t,r){t.exports=function(e,n){return e.has(n)}},function(t,r,e){var n=e(279),g=e(715),y=e(296),i=n&&1/y(new n([,-0]))[1]==1/0?function(k){return new n(k)}:g;t.exports=i},function(t,r){t.exports=function(){}},function(t,r,e){var n,g=e(9),y=e(82).fn,i=e(35),k=e(199),L=e(0),$=e(12),V=e(48),z=e(200).getLibEnv,re=e(70),oe=e(200).getHostEnvEnum,le=L.notundef;y.genSessionKey=(n={},function(){var ue=this.name;return n[ue]=n[ue]||L.guid()}),y.afterLogin=L.emptyFunc,y.assembleIMLogin=function(){var ue,ie=this.options,ae=ie.account;this.sdkSession=this.genSessionKey();var Ie={appLogin:this.autoconnect?0:1,appKey:ie.appKey,account:ae,token:ie.token,sdkVersion:$.info.sdkVersion,sdkHumanVersion:$.info.sdkHumanVersion,protocolVersion:$.info.protocolVersion,os:re.os.toString()==="[object Object]"?re.os.family:re.os.toString(),browser:re.name+" "+re.version,clientType:$.CLIENTTYPE||16,session:this.sdkSession,deviceId:V.deviceId,isReactNative:$.isRN?1:0,customTag:ie.customTag||""};Ie.userAgent=($.isBrowser?navigator&&navigator.userAgent:"")||"";var de=!1;return de=!(!ie||!ie.privateConf||typeof ie.privateConf.loginSDKTypeParamCompat!="boolean")&&ie.privateConf.loginSDKTypeParamCompat,Ie.userAgent=de?"Native/"+$.info.sdkHumanVersion:g(ue=Ie.userAgent).call(ue,0,299),Ie.libEnv=de?void 0:z(),Ie.sdkType=de?0:oe(),ie.customClientType&&(Ie.customClientType=+ie.customClientType),ie.authType&&(Ie.authType=+ie.authType),ie.loginExt&&(Ie.loginExt=ie.loginExt),Ie},y.notifyLogin=function(ue){this.logger.info("link::notifyLogin: on connect",ue),this.options.onconnect(ue)},y.logout=function(){if(this.doLogout)return this.doLogout=!1,void this.onAuthError(new i("done logout","logout",{disconnectReason:"close",uploadCode:415}),"link::logout");this.isConnected()&&this.onAuthError(new i("done disconnect","logout",{disconnectReason:"close",uploadCode:415}),"link::logout")},y.onKicked=function(ue){var ie=ue.content,ae=ie.from,Ie=ie.reason,de=ie.custom,Ce=ie.customClientType,Ue={reason:this.kickedReasons[Ie]||"unknown",message:this.kickedMessages[Ie]||"未知原因"};le(ae)&&(Ue.from=k.reverseType(ae)),le(de)&&(Ue.custom=de),+Ce>0&&(Ue.customClientType=Ce),this.logger.warn("link::onKicked:",Ue);var qe=new i("被踢了","kicked",{disconnectReason:"kicked",uploadCode:415});L.merge(qe,Ue),this.statusProtector.processEvent("auth/loginLifeCycleKicked",null,Ue),this.onAuthError(qe,"link::onKicked")},y.onAuthError=function(ue,ie){var ae=ue&&ue.code;if(this.logger.error("onAuthError ",ie,ae),/^(Error_Internet_Disconnected|Error_Timeout|Error_Connection_Socket_State_not_Match)$/.test(ae))return this.forceDisconnect(),void this.onDisconnect("link::onAuthError::"+ae,"broken");(ue=ue||i.newConnectionError({callFunc:ie,uploadCode:415,disconnectReason:"close"})).callFunc=ue.callFunc||ie||null,this.shouldReconnect=!1,this.markAllCallbackInvalid(ue),this.notifyDisconnect(ue)}},function(t,r,e){var n=e(22),g=e(23),y=e(24),i=e(82).fn,k=e(12),L=e(0);i.processLink=function($){switch($.cmd){case"heartbeat":this.startHeartbeat();break;case"notifyDetect":y(L._get($,"content.notifyDetectTag"))==="object"&&($.content.notifyDetectTag.t3=new Date().getTime(),this.startDetect($))}},i.startHeartbeat=function(){var $=this;$.stopHeartbeat(),$.heartbeatTimer=n(function(){var V;$.sendCmd("heartbeat",null,g(V=$.onHeartbeat).call(V,$))},k.heartbeatInterval)},i.detectHeartbeat=function(){var $;this.stopHeartbeat(),this.sendCmd("heartbeat",null,g($=this.onHeartbeat).call($,this))},i.startDetect=function($){var V=$.content.notifyDetectTag;V.t4=new Date().getTime(),this.sendCmd("uploadDetect",{notifyDetectTag:V})},i.stopHeartbeat=function(){this.heartbeatTimer&&(clearTimeout(this.heartbeatTimer),this.heartbeatTimer=null)},i.onHeartbeat=function($){if($){if(this.syncing)return this.logger.warn("onHeartbeat::ignore error in connecting"),void this.startHeartbeat();var V;$.callFunc="link::onHeartbeat",this.onCustomError("heartbeat error",$),this.heartbeatFail++,this.logger.warn("onHeartbeat::error ",$.code,$),$.code==="Error_Timeout"&&(this.heartbeatFail>1?(this.reporterHookLinkKeep.update({code:0,description:"Heartbeat-discovered link failure",operation_type:1,target:this.url}),this.reporterHookLinkKeep.end(!0),this.forceDisconnect(),this.statusProtector.processEvent("auth/loginLifeCycleConnectionBroken",new Error("disconnect due to heartbeat error")),this.onDisconnect("link::onHeartbeat","broken")):this.sendCmd("heartbeat",null,g(V=this.onHeartbeat).call(V,this)))}else this.heartbeatFail=0},i.checkNetworkAvailable=typeof navigator<"u"&&typeof navigator.onLine=="boolean"?function(){return navigator.onLine}:function(){},i.heartbeat=function(){}},function(t,r,e){var n=e(3),g=e(8),y=e(28),i=e(22),k=e(43),L=e(82).fn,$=e(290),V=e(12),z=e(48);L.processMisc=function(re){switch(re.cmd){case"getSimpleNosToken":re.error||(re.obj=re.content.nosTokens[0]);break;case"getNosToken":re.error||(re.obj=re.content.nosToken);break;case"getGrayscaleConfig":re.error||(re.obj=re.content.appGrayConfigTag);break;case"getMixStorePolicy":re.error||(re.obj=re.content.mixStorePolicyTag);break;case"getMixStoreToken":re.error||(re.obj=re.content.mixStoreTokenTag);break;case"getBackSourceToken":re.error||(re.obj=re.content.backSourceTokenTag);break;case"uploadSdkLogUrl":re.error?this.logger.error("uploadSdkLogUrl::error",re.error):this.logger.info("uploadSdkLogUrl::success",re.obj&&re.obj.url);break;case"notifyUploadLog":re.error||(V.isRN?this.uploadLocalLogRN():V.isBrowser&&this.uploadLocalLogWeb(),this.emitAPI({type:"notifyUploadLog"}));break;case"audioToText":re.error||(re.obj.text=re.content.text);break;case"processImage":re.obj.imageOps=$.reverseImageOps(re.obj.imageOps),re.error||(re.obj={url:re.content.url});break;case"getNosTokenTrans":re.error||(re.obj={nosToken:re.content.nosToken,docId:re.content.docId});break;case"getNosOriginUrl":re.error||(re.obj=re.content.nosFileUrlTag.originUrl);break;case"notifyTransLog":re.error||this.emitAPI({type:"notifyTransLog",obj:re.content.transInfo});break;case"fetchFile":case"fetchFileList":case"removeFile":re.error||(re.obj=re.content);break;case"getServerTime":re.obj=re.content&&re.content.time;break;case"getNosCdnHost":this.getNosCdnHost(re)}},L.uploadLocalLogRN=function(){if(V.isRN&&z.rnfs){var re=z.rnfs,oe=this,le=re.nimIndex,ue=(re.nimIndex+1)%2;re.nimPromise=re.nimPromise.then(function(){return n.all([re.exists(ie(le)),re.exists(ie(ue))])}).then(function(ae){return ae&&(ae[0]||ae[1])?ae[0]&&ae[1]?re.copyFile(ie(ue),ie(2)).then(function(){return re.readFile(ie(le))}).then(function(Ie){return re.appendFile(ie(2),Ie)}):ae[0]?re.copyFile(ie(le),ie(2)):void(ae[1]&&re.copyFile(ie(ue),ie(2))):n.reject()}).then(function(){return new n(function(ae){oe.api.previewFile({filePath:ie(2),done:function(Ie,de){if(n.all([re.unlink(ie(2)),re.unlink(ie(1)),re.unlink(ie(0))]).finally(function(){ae()}),Ie)oe.logger.error("nim::uploadLocalLogRN:previewFile:error",Ie);else{var Ce=de.url;g(Ce).call(Ce,"?")>0?Ce+="&":Ce+="?",Ce+="download="+new Date().getTime()+"_rn.log",oe.api.uploadSdkLogUrl({url:Ce})}}})})}).catch(function(ae){re.unlink(ie(2)).catch(function(){}),oe.logger.error("nim::protocol::uploadLocalLogRN",ae)})}function ie(ae){return re.DocumentDirectoryPath+"/nimlog_"+ae+".log"}},L.uploadLocalLogWeb=function(){var re=this;this.options.dbLog!==!1&&this.logger._local?this.logger._local.fetchLog().then(function(oe){!oe||!oe.logs||y(oe.logs)&&oe.logs.length===0?re.logger.warn("uploadLocalLogWeb::no logs"):re.api.previewFile({blob:new Blob([oe.logs],{type:"text/plain"}),done:function(le,ue){if(le)re.logger.error("uploadLocalLogWeb::previewFile:error",le);else{re.logger.log("uploadLocalLogWeb::previewFile:success",ue);var ie=ue.url;ie+=(g(ie).call(ie,"?")>0?"&":"?")+"download="+new Date().getTime()+"_web.log",re.api.uploadSdkLogUrl({url:ie}),re.logger._local.deleteLogs(oe.time).then(function(){re.logger.log("uploadLocalLogWeb::deleteLogs success")}).catch(function(ae){return re.logger.error("uploadLocalLogWeb::deleteLogs:error ,",ae)})}}})}).catch(function(oe){re.logger.error("uploadLocalLogWeb::fetchLog:error",oe)}):this.logger.warn("uploadLocalLogWeb::no dbLog")},L.getNosCdnHost=function(re){var oe=this,le=re.error;if(le&&(le.callFunc="events::getNosCdnHost",oe.onCustomError("getNosCdnHost","EVENT_GET_NOS_CDN_HOST_ERROR",le)),re.content&&re.content.nosConfigTag){var ue=re.content.nosConfigTag,ie="",ae="";ue.expire!==0&&ue.cdnDomain?ue.expire===-1?(ie=ue.cdnDomain,ae=ue.objectNamePrefix):(ie=ue.cdnDomain,ae=ue.objectNamePrefix,oe.nosCdnHostTimer&&clearTimeout(oe.nosCdnHostTimer),oe.nosCdnHostTimer=i(function(){oe.sendCmd("getNosCdnHost",{})},800*k(ue.expire))):(ie="",ae=""),V.serverNosConfig.cdnDomain=ie,V.serverNosConfig.objectPrefix=ae,V.hasLocalStorage&&(localStorage.setItem("nim_cdn_domain",ie),localStorage.setItem("nim_object_prefix",ae))}}},function(t,r,e){var n=e(11),g=e(28),y=e(82).fn,i=e(0),k=e(291),L=e(109).EMSyncType;y.processAvSignal=function(V){switch(V.cmd){case"signalingCreate":case"signalingDelay":case"signalingClose":case"signalingJoin":case"signalingLeave":case"signalingInvite":case"signalingCancel":case"signalingReject":case"signalingAccept":case"signalingControl":case"signalingSyncMsgRead":case"signalingGetChannelInfo":case"signalingCallEx":break;case"signalingNotify":this.onSignalingNotify(V);break;case"signalingMutilClientSyncNotify":this.onSignalingMutilClientSyncNotify(V);break;case"signalingUnreadMessageSyncNotify":this.onSignalingUnreadMessageSyncNotify(V);break;case"signalingChannelsSyncNotify":this.onSignalingMembersSyncNotify(V);break;default:this.logger.warn("avSignal::unhandled cmd:",V.cmd)}};var $=function(){var V=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(V.needPush&&(V.needPush=V.needPush==="1"),V.needBadge&&(V.needBadge=V.needBadge==="1"),V.channelInValid&&(V.channelInValid=V.channelInValid==="1"),V.attach){var z=JSON.parse(V.attach);V.eventType=k.parseAvSignalType(z.type)}if(V.members){var re=JSON.parse(V.members);V.members=n(re).call(re,function(oe){return k.parseAvSignalMember(oe)})}return V};y.onSignalingNotify=function(V){if(V.error){var z=V.error;this.logger.error("protocal::avSignal:onSignalingNotify error",z),this.emitAPI({type:"error",error:z}),this.options.onerror(z)}else{V.raw&&V.raw.r&&V.raw.r.length&&V.content&&V.content.avSignalTag&&(V.content.avSignalTag.msgid="0");var re=V.content.avSignalTag;re=g(re)?n(re).call(re,function(oe){return $(oe)}):$(re),this.emitAPI({type:"signalingNotify",obj:re}),i.isFunction(this.options.onSignalingNotify)&&this.options.onSignalingNotify(re)}},y.onSignalingMutilClientSyncNotify=function(V){if(V.error){var z=V.error;this.logger.error("protocal::avSignal:onSignalingMutilClientSyncNotify error",z),this.emitAPI({type:"error",error:z}),this.options.onerror(z)}else{var re=V.content.avSignalTag;re=g(re)?n(re).call(re,function(oe){return $(oe)}):$(re),this.emitAPI({type:"signalingMutilClientSyncNotify",obj:re}),i.isFunction(this.options.onSignalingMutilClientSyncNotify)&&this.options.onSignalingMutilClientSyncNotify(re)}},y.onSignalingUnreadMessageSyncNotify=function(V){if(V.error){var z=V.error;this.logger.error("protocal::avSignal:onSignalingUnreadMessageSyncNotify error",z),this.emitAPI({type:"error",error:z}),this.options.onerror(z)}else{var re=V.content.avSignalTag;g(re)&&(re=n(re).call(re,function(oe){return $(oe)})),this.emitAPI({type:"signalingUnreadMessageSyncNotify",obj:re}),this.reporterHook.emit("reporter/syncItemComplete",L.kSyncType15_13),i.isFunction(this.options.onSignalingUnreadMessageSyncNotify)&&this.options.onSignalingUnreadMessageSyncNotify(re)}},y.onSignalingMembersSyncNotify=function(V){if(V.error){var z=V.error;this.logger.error("protocal::avSignal:onSignalingMembersSyncNotify error",z),this.emitAPI({type:"error",error:z}),this.options.onerror(z)}else{var re=V.content.avSignalTag;g(re)||(re=[re]),re=n(re).call(re,function(oe){return $(oe)}),this.emitAPI({type:"signalingChannelsSyncNotify",obj:re}),i.isFunction(this.options.onSignalingMembersSyncNotify)&&this.options.onSignalingMembersSyncNotify(re)}}},function(t,r,e){var n=e(6),g=e(23),y=e(0),i=e(82).fn,k=e(92),L=e(285);i.adaptersRequest=function($){var V=this,z=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},re=arguments.length>2?arguments[2]:void 0,oe=z.onerror||function(){},le=new Date().getTime(),ue=y.get(re,"exception_service")||0;return z.onerror=function(){oe.apply(void 0,arguments);var ie=arguments.length<=0?void 0:arguments[0];V.reporter.reportTraceStart("exceptions",{user_id:V.account,trace_id:y.get(self,"socket.socket.sessionid"),start_time:le,action:1,exception_service:ue}),V.reporter.reportTraceUpdateV2("exceptions",{code:typeof ie.status=="number"?ie.status:typeof ie.code=="number"?ie.code:0,description:ie.message||"".concat(ie.code),operation_type:0,target:$,context:z?n(z):"",net_connect:V.checkNetworkAvailable()}),V.reporter.reportTraceEnd("exceptions",1)},k($,z)},i.adaptersUploadFile=function($,V){var z,re=this;$.adaptersRequest=g(z=i.adaptersRequest).call(z,this);var oe=new Date().getTime();return $.errorHook=function(le){var ue=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(le){re.reporter.reportTraceStart("exceptions",{user_id:re.account,trace_id:y.get(self,"socket.socket.sessionid"),start_time:oe,action:1,exception_service:ue.provider==="s3"?4:3});var ie=ue.url||$.url;le.bucket&&(ie=n(le)),re.reporter.reportTraceUpdateV2("exceptions",{code:typeof le.status=="number"?le.status:typeof le.code=="number"?le.code:0,description:le.message||"".concat(le.code),operation_type:1,target:ie,net_connect:re.checkNetworkAvailable()}),re.reporter.reportTraceEnd("exceptions",1)}},new L($,this,V)}},function(t,r,e){e(298);var n,g,y,i=e(42),k=e(56),L=e(34),$=e(2),V=e(3),z=e(5),re=e(22),oe=e(15),le=e(9),ue=e(4),ie=e(24);y=function(){function ae(Ce,Ue){for(var qe=0;qe<Ue.length;qe++){var jt=Ue[qe];jt.enumerable=jt.enumerable||!1,jt.configurable=!0,"value"in jt&&(jt.writable=!0),i(Ce,jt.key,jt)}}var Ie={isDataReportEnable:!0,maxSize:100,msgListMaxSize:1e3,cacheMaxSize:1e3,maxDelay:3e5,maxInterval:3e4,minInterval:1e4,timeout:5e3,autoStart:!0},de=function(){};return function(){function Ce(jt){(function(Fe,Et){if(!(Fe instanceof Et))throw new TypeError("Cannot call a class as a function")})(this,Ce),this.isUploadEnable=!1,this.initConfigLoaded=!1,this.loading=!1,this.isDestroyed=!1,this.reportConfig=Ie,this.traceMsgCache={},this.highPriorityMsgList=[],this.msgList=[],this.lowPriorityMsgList=[],this.cacheMsgList=[],this.lastReportTime=k(),this.timer=null,this.setConfig(jt),this.reportConfig.isDataReportEnable&&this.reportConfig.autoStart&&this.initUploadConfig()}var Ue,qe;return Ue=Ce,(qe=[{key:"setConfig",value:function(jt){var Fe=L({},this.reportConfig.common,jt.common);this.reportConfig=L({},this.reportConfig,jt),this.reportConfig.common=Fe,this.reportConfig.common.sdk_type||(this.reportConfig.common.sdk_type="im")}},{key:"reportImmediately",value:function(jt,Fe){var Et=this;this.reportConfig.isDataReportEnable&&this.reportConfig.request(jt,L({dataType:"json",method:"POST",timeout:this.reportConfig.timeout},Fe)).catch(function(cr){var er,nr;(nr=(er=Et.reportConfig)===null||er===void 0?void 0:er.logger)===null||nr===void 0||nr.warn("Reporter immediately upload failed",cr)})}},{key:"report",value:function(jt,Fe){var Et=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(Et.priority||(Et.priority=this.getEventPriority(jt,Fe)),this.reportConfig.isDataReportEnable&&jt){var cr=k();Et.priority==="HIGH"?this.highPriorityMsgList.push({module:jt,msg:Fe,createTime:cr}):Et.priority==="NORMAL"?this.msgList.push({module:jt,msg:Fe,createTime:cr}):Et.priority==="LOW"&&this.lowPriorityMsgList.push({module:jt,msg:Fe,createTime:cr}),this.highPriorityMsgList.length>this.reportConfig.msgListMaxSize&&this.highPriorityMsgList.shift(),this.msgList.length>this.reportConfig.msgListMaxSize&&this.msgList.shift(),this.lowPriorityMsgList.length>this.reportConfig.msgListMaxSize&&this.lowPriorityMsgList.shift(),this.doReport()}}},{key:"reportTraceStart",value:function(jt,Fe){if(this.reportConfig.isDataReportEnable&&jt&&!this.traceMsgCache[jt]){var Et=L(L({start_time:k()},Fe),{extension:[]});this.traceMsgCache[jt]=Et}}},{key:"reportTraceUpdate",value:function(jt){}},{key:"reportTraceUpdateV2",value:function(jt,Fe,Et){var cr,er=this;if(this.reportConfig.isDataReportEnable&&this.traceMsgCache[jt]){var nr=this.traceMsgCache[jt].extension,dr=nr.length,ir=new Date().getTime();dr===0?Fe.duration=ir-this.traceMsgCache[jt].start_time:nr[dr-1].end_time?Fe.duration=ir-nr[dr-1].end_time:Fe.duration=ir-this.traceMsgCache[jt].start_time,nr.push(L({end_time:ir},Fe));var tr=nr.length-1;Et!=null&&Et.asyncParams&&((cr=this.traceMsgCache[jt]).asyncPromiseArray||(cr.asyncPromiseArray=[]),this.traceMsgCache[jt].asyncPromiseArray.push(Et.asyncParams.then(function(ur){er.traceMsgCache[jt]&&er.traceMsgCache[jt].extension[tr]&&L(er.traceMsgCache[jt].extension[tr],ur)})))}}},{key:"reportTraceEnd",value:function(jt){var Fe,Et=this,cr=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];if(this.reportConfig.isDataReportEnable&&this.traceMsgCache[jt])if(jt!=="nos"||cr===!1)if(typeof cr=="boolean"?this.traceMsgCache[jt].succeed=!!cr:this.traceMsgCache[jt].state=cr,this.traceMsgCache[jt].duration=k()-this.traceMsgCache[jt].start_time,$(Fe=this.traceMsgCache[jt].extension).call(Fe,function(dr){delete dr.end_time}),this.traceMsgCache[jt].asyncPromiseArray){var er=this.traceMsgCache[jt],nr=function(){er===Et.traceMsgCache[jt]&&(delete Et.traceMsgCache[jt].asyncPromiseArray,Et.report(jt,Et.traceMsgCache[jt],{priority:Et.getEventPriority(jt,Et.traceMsgCache[jt])}),Et.traceMsgCache[jt]=null)};V.all(this.traceMsgCache[jt].asyncPromiseArray).then(nr).catch(nr)}else this.report(jt,this.traceMsgCache[jt],{priority:this.getEventPriority(jt,this.traceMsgCache[jt])}),this.traceMsgCache[jt]=null;else this.traceMsgCache[jt]=null}},{key:"getEventPriority",value:function(jt,Fe){if(jt==="exceptions"){if(Fe.action===0||Fe.action===2||Fe.action===1&&Fe.exception_service!==0)return"HIGH"}else if(jt==="msgReceive"||jt==="nim_api_trace")return"LOW";return"NORMAL"}},{key:"reportTraceCancel",value:function(jt){this.reportConfig.isDataReportEnable&&(this.traceMsgCache[jt]=null)}},{key:"pause",value:function(){this.reportConfig.isDataReportEnable&&(this.isUploadEnable=!1)}},{key:"restore",value:function(){this.reportConfig.isDataReportEnable&&(this.isUploadEnable=!0,this.initConfigLoaded||this.initUploadConfig())}},{key:"destroy",value:function(){var jt,Fe=this;this.reportConfig.isDataReportEnable&&($(jt=z(this.traceMsgCache)).call(jt,function(Et){Fe.reportTraceEnd(Et,1)}),this.timer!==null&&clearTimeout(this.timer),this.setConfig=de,this.report=de,this.reportTraceStart=de,this.reportTraceUpdate=de,this.reportTraceEnd=de,this.pause=de,this.restore=de,this.destroy=de,this.cacheMsgList=[],this.traceMsgCache={},this.lowPriorityMsgList=[],this.msgList=[],this.highPriorityMsgList=[],this.reportConfig={},this.isDestroyed=!0)}},{key:"initUploadConfig",value:function(){var jt,Fe,Et=this;if(!this.loading){this.loading=!0;var cr=this.reportConfig.common||{};try{this.reportConfig.request(this.reportConfig.reportConfigUrl,{method:"GET",dataType:"json",params:{deviceId:cr.dev_id,sdkVer:cr.sdk_ver,platform:cr.platform,appkey:cr.app_key},timeout:this.reportConfig.timeout}).then(function(er){var nr,dr;if(!Et.isDestroyed){if(er.status===200&&er.data&&er.data.code===200){var ir=er.data.data||{};Et.reportConfig.maxSize=ir.maxSize>1e3?1e3:ir.maxSize,Et.reportConfig.maxInterval=ir.maxInterval>1e4?1e4:ir.maxInterval,Et.reportConfig.maxInterval=ir.maxInterval<10?10:ir.maxInterval,Et.reportConfig.minInterval=ir.minInterval<2?2:ir.minInterval,Et.reportConfig.maxDelay=ir.maxDelay||300,Et.reportConfig.maxInterval=1e3*Et.reportConfig.maxInterval,Et.reportConfig.minInterval=1e3*Et.reportConfig.minInterval,Et.reportConfig.maxDelay=1e3*Et.reportConfig.maxDelay,Et.isUploadEnable=!0,Et.initConfigLoaded=!0,Et.loading=!1,Et.reportHeartBeat()}(dr=(nr=Et.reportConfig)===null||nr===void 0?void 0:nr.logger)===null||dr===void 0||dr.log("Get reporter upload config success")}}).catch(function(er){var nr,dr;Et.loading=!1,(dr=(nr=Et.reportConfig)===null||nr===void 0?void 0:nr.logger)===null||dr===void 0||dr.error("Get reporter upload config failed",er)})}catch(er){this.loading=!1,(Fe=(jt=this.reportConfig)===null||jt===void 0?void 0:jt.logger)===null||Fe===void 0||Fe.error("Exec reporter request failed",er)}}}},{key:"reportHeartBeat",value:function(){var jt=this;this.isDestroyed||(this.timer=re(function(){jt.reportHeartBeat()},this.reportConfig.minInterval),this.doReport())}},{key:"doReport",value:function(){if(!this.isDestroyed){var jt=this.highPriorityMsgList.length+this.msgList.length+this.lowPriorityMsgList.length+this.cacheMsgList.length>2*this.reportConfig.maxSize?this.reportConfig.minInterval:this.reportConfig.maxInterval;k()-this.lastReportTime>=jt&&this.upload()}}},{key:"getUploadMsg",value:function(){var jt,Fe,Et,cr,er,nr,dr=this,ir={},tr=k();this.highPriorityMsgList=oe(jt=this.highPriorityMsgList).call(jt,function(Nr){return tr-Nr.createTime<dr.reportConfig.maxDelay}),this.msgList=oe(Fe=this.msgList).call(Fe,function(Nr){return tr-Nr.createTime<dr.reportConfig.maxDelay}),this.lowPriorityMsgList=oe(Et=this.lowPriorityMsgList).call(Et,function(Nr){return tr-Nr.createTime<dr.reportConfig.maxDelay}),this.cacheMsgList=oe(cr=this.cacheMsgList).call(cr,function(Nr){return tr-Nr.createTime<dr.reportConfig.maxDelay});var ur=le(er=this.highPriorityMsgList).call(er,0,this.reportConfig.maxSize);if(this.highPriorityMsgList=le(nr=this.highPriorityMsgList).call(nr,ur.length),ur.length<this.reportConfig.maxSize){var or,fr,lr=this.reportConfig.maxSize-ur.length;ur=ue(ur).call(ur,le(or=this.msgList).call(or,0,lr)),this.msgList=le(fr=this.msgList).call(fr,lr)}if(ur.length<this.reportConfig.maxSize){var gr,Sr,wr=this.reportConfig.maxSize-ur.length;ur=ue(ur).call(ur,le(gr=this.lowPriorityMsgList).call(gr,0,wr)),this.lowPriorityMsgList=le(Sr=this.lowPriorityMsgList).call(Sr,wr)}if(ur.length<this.reportConfig.maxSize){var kr,mr,Ir=this.reportConfig.maxSize-ur.length;ur=ue(ur).call(ur,le(kr=this.cacheMsgList).call(kr,0,Ir)),this.cacheMsgList=le(mr=this.cacheMsgList).call(mr,Ir)}return $(ur).call(ur,function(Nr){ir[Nr.module]?ir[Nr.module].push(Nr.msg):ir[Nr.module]=[Nr.msg]}),{uploadMsgArr:ur,uploadMsg:ir}}},{key:"upload",value:function(){var jt,Fe,Et=this;if(this.isUploadEnable&&!(this.lastReportTime&&k()-this.lastReportTime<this.reportConfig.minInterval)){var cr=this.getUploadMsg(),er=cr.uploadMsgArr,nr=cr.uploadMsg;if(er.length){this.lastReportTime=k();try{this.reportConfig.request(this.reportConfig.reportUrl,{dataType:"json",method:"POST",data:{common:this.reportConfig.common,event:nr},headers:{sdktype:"im"},timeout:this.reportConfig.timeout}).catch(function(dr){var ir,tr,ur,or;Et.cacheMsgList=le(ir=ue(tr=Et.cacheMsgList).call(tr,er)).call(ir,0,Et.reportConfig.cacheMaxSize),(or=(ur=Et.reportConfig)===null||ur===void 0?void 0:ur.logger)===null||or===void 0||or.warn("Reporter upload failed",dr)})}catch(dr){(Fe=(jt=this.reportConfig)===null||jt===void 0?void 0:jt.logger)===null||Fe===void 0||Fe.warn("Exec reporter request failed",dr)}clearTimeout(this.timer),this.reportHeartBeat()}}}}])&&ae(Ue.prototype,qe),i(Ue,"prototype",{writable:!1}),Ce}()},ie(r)==="object"&&t!==void 0?t.exports=y():(g=typeof(n=y)=="function"?n.call(r,e,r,t):n)===void 0||(t.exports=g)},function(t,r,e){t.exports=e(723)},function(t,r,e){e(724);var n=e(725);t.exports=n},function(t,r,e){e(299)},function(t,r,e){var n=e(726);t.exports=n},function(t,r,e){var n=e(727);t.exports=n},function(t,r,e){e(299),t.exports=e(16)},function(t,r,e){var n,g,y,i=e(45),k=e(44),L=e(153),$=e(154),V=e(122),z=e(729),re=(e(298),e(2)),oe=e(5),le=e(4),ue=e(3),ie=e(22),ae=e(6),Ie=e(152),de=e(24);function Ce(Ue){var qe=function(){if(typeof Reflect>"u"||!Ie||Ie.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Ie(Boolean,[],function(){})),!0}catch{return!1}}();return function(){var jt,Fe=V(Ue);if(qe){var Et=V(this).constructor;jt=Ie(Fe,arguments,Et)}else jt=Fe.apply(this,arguments);return $(this,jt)}}y=function(){function Ue(jt){if(jt){var Fe,Et="";return re(Fe=oe(jt)).call(Fe,function(cr,er){var nr;Et+=er===0?"?":"&",Et+=le(nr="".concat(cr,"=")).call(nr,jt[cr])}),Et}return""}var qe=function(jt){L(Et,jt);var Fe=Ce(Et);function Et(cr,er,nr,dr){var ir;return k(this,Et),(ir=Fe.call(this,nr)).source=cr,ir.code=er,ir.desc=nr,ir.detail=dr||{},ir}return i(Et)}(z(Error));return function(jt){var Fe=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{dataType:"json",method:"GET",timeout:5e3},Et=Fe.dataType==="text"?"text/plain; charset=UTF-8":"application/json; charset=UTF-8",cr=Fe.method==="GET"?Ue(Fe.params):"";return new ue(function(er,nr){if(window.XMLHttpRequest){var dr,ir,tr=new XMLHttpRequest;if(tr.onreadystatechange=function(){if(tr.readyState===4)if(tr.status===200){try{ir=JSON.parse(tr.response||"{}")}catch{ir=tr.response}er({status:tr.status,data:ir})}else ie(function(){var or;nr(new qe(1,tr.status,le(or="readyState: ".concat(tr.readyState,"; statusText: ")).call(or,tr.statusText)))},0)},tr.open(Fe.method,le(dr="".concat(jt)).call(dr,cr)),tr.timeout=Fe.timeout||5e3,tr.setRequestHeader("Content-Type",Et),Fe.headers)for(var ur in Fe.headers)tr.setRequestHeader(ur,Fe.headers[ur]);tr.ontimeout=function(or){nr(new qe(1,408,or&&or.message?or.message:"request timeout"))},tr.send(ae(Fe.data))}else nr(new qe(2,10400,"request no suppout"))})}},de(r)==="object"&&t!==void 0?t.exports=y():(g=typeof(n=y)=="function"?n.call(r,e,r,t):n)===void 0||(t.exports=g)},function(t,r,e){var n=e(730),g=e(195),y=e(122),i=e(196),k=e(769),L=e(770);function $(V){var z=typeof n=="function"?new n:void 0;return t.exports=$=function(re){if(re===null||!k(re))return re;if(typeof re!="function")throw new TypeError("Super expression must either be null or a function");if(z!==void 0){if(z.has(re))return z.get(re);z.set(re,oe)}function oe(){return L(re,arguments,y(this).constructor)}return oe.prototype=g(re.prototype,{constructor:{value:oe,enumerable:!1,writable:!0,configurable:!0}}),i(oe,re)},t.exports.__esModule=!0,t.exports.default=t.exports,$(V)}t.exports=$,t.exports.__esModule=!0,t.exports.default=t.exports},function(t,r,e){t.exports=e(731)},function(t,r,e){t.exports=e(732)},function(t,r,e){var n=e(733);e(744),e(746),e(748),e(750),e(751),e(753),e(754),e(755),e(756),e(757),e(759),e(760),e(761),e(762),e(763),e(764),e(765),e(766),e(767),e(768),t.exports=n},function(t,r,e){var n=e(734);t.exports=n},function(t,r,e){var n=e(735);e(75),t.exports=n},function(t,r,e){e(90),e(736),e(102),e(118);var n=e(14);t.exports=n.Map},function(t,r,e){e(737)},function(t,r,e){e(738)("Map",function(n){return function(){return n(this,arguments.length?arguments[0]:void 0)}},e(742))},function(t,r,e){var n=e(1),g=e(16),y=e(300),i=e(7),k=e(65),L=e(50),$=e(178),V=e(17),z=e(30),re=e(89),oe=e(40).f,le=e(69).forEach,ue=e(29),ie=e(103),ae=ie.set,Ie=ie.getterFor;t.exports=function(de,Ce,Ue){var qe,jt=de.indexOf("Map")!==-1,Fe=de.indexOf("Weak")!==-1,Et=jt?"set":"add",cr=g[de],er=cr&&cr.prototype,nr={};if(ue&&V(cr)&&(Fe||er.forEach&&!i(function(){new cr().entries().next()}))){var dr=(qe=Ce(function(tr,ur){ae($(tr,dr),{type:de,collection:new cr}),ur!=null&&L(ur,tr[Et],{that:tr,AS_ENTRIES:jt})})).prototype,ir=Ie(de);le(["add","clear","delete","forEach","get","has","set","keys","values","entries"],function(tr){var ur=tr=="add"||tr=="set";!(tr in er)||Fe&&tr=="clear"||k(dr,tr,function(or,fr){var lr=ir(this).collection;if(!ur&&Fe&&!z(or))return tr=="get"&&void 0;var gr=lr[tr](or===0?0:or,fr);return ur?this:gr})}),Fe||oe(dr,"size",{configurable:!0,get:function(){return ir(this).collection.size}})}else qe=Ue.getConstructor(Ce,de,jt,Et),y.enable();return re(qe,de,!1,!0),nr[de]=qe,n({global:!0,forced:!0},nr),Fe||Ue.setStrong(qe,de,jt),qe}},function(t,r,e){var n=e(7),g=e(30),y=e(71),i=e(740),k=Object.isExtensible,L=n(function(){});t.exports=L||i?function($){return!!g($)&&(!i||y($)!="ArrayBuffer")&&(!k||k($))}:k},function(t,r,e){var n=e(7);t.exports=n(function(){if(typeof ArrayBuffer=="function"){var g=new ArrayBuffer(8);Object.isExtensible(g)&&Object.defineProperty(g,"a",{value:8})}})},function(t,r,e){var n=e(7);t.exports=!n(function(){return Object.isExtensible(Object.preventExtensions({}))})},function(t,r,e){var n=e(40).f,g=e(88),y=e(743),i=e(36),k=e(178),L=e(98),$=e(50),V=e(176),z=e(177),re=e(244),oe=e(29),le=e(300).fastKey,ue=e(103),ie=ue.set,ae=ue.getterFor;t.exports={getConstructor:function(Ie,de,Ce,Ue){var qe=Ie(function(er,nr){k(er,jt),ie(er,{type:de,index:g(null),first:void 0,last:void 0,size:0}),oe||(er.size=0),L(nr)||$(nr,er[Ue],{that:er,AS_ENTRIES:Ce})}),jt=qe.prototype,Fe=ae(de),Et=function(er,nr,dr){var ir,tr,ur=Fe(er),or=cr(er,nr);return or?or.value=dr:(ur.last=or={index:tr=le(nr,!0),key:nr,value:dr,previous:ir=ur.last,next:void 0,removed:!1},ur.first||(ur.first=or),ir&&(ir.next=or),oe?ur.size++:er.size++,tr!=="F"&&(ur.index[tr]=or)),er},cr=function(er,nr){var dr,ir=Fe(er),tr=le(nr);if(tr!=="F")return ir.index[tr];for(dr=ir.first;dr;dr=dr.next)if(dr.key==nr)return dr};return y(jt,{clear:function(){for(var er=Fe(this),nr=er.index,dr=er.first;dr;)dr.removed=!0,dr.previous&&(dr.previous=dr.previous.next=void 0),delete nr[dr.index],dr=dr.next;er.first=er.last=void 0,oe?er.size=0:this.size=0},delete:function(er){var nr=Fe(this),dr=cr(this,er);if(dr){var ir=dr.next,tr=dr.previous;delete nr.index[dr.index],dr.removed=!0,tr&&(tr.next=ir),ir&&(ir.previous=tr),nr.first==dr&&(nr.first=ir),nr.last==dr&&(nr.last=tr),oe?nr.size--:this.size--}return!!dr},forEach:function(er){for(var nr,dr=Fe(this),ir=i(er,arguments.length>1?arguments[1]:void 0);nr=nr?nr.next:dr.first;)for(ir(nr.value,nr.key,this);nr&&nr.removed;)nr=nr.previous},has:function(er){return!!cr(this,er)}}),y(jt,Ce?{get:function(er){var nr=cr(this,er);return nr&&nr.value},set:function(er,nr){return Et(this,er===0?0:er,nr)}}:{add:function(er){return Et(this,er=er===0?0:er,er)}}),oe&&n(jt,"size",{get:function(){return Fe(this).size}}),qe},setStrong:function(Ie,de,Ce){var Ue=de+" Iterator",qe=ae(de),jt=ae(Ue);V(Ie,de,function(Fe,Et){ie(this,{type:Ue,target:Fe,state:qe(Fe),kind:Et,last:void 0})},function(){for(var Fe=jt(this),Et=Fe.kind,cr=Fe.last;cr&&cr.removed;)cr=cr.previous;return Fe.target&&(Fe.last=cr=cr?cr.next:Fe.state.first)?z(Et=="keys"?cr.key:Et=="values"?cr.value:[cr.key,cr.value],!1):(Fe.target=void 0,z(void 0,!0))},Ce?"entries":"values",!Ce,!0),re(de)}}},function(t,r,e){var n=e(74);t.exports=function(g,y,i){for(var k in y)i&&i.unsafe&&g[k]?g[k]=y[k]:n(g,k,y[k],i);return g}},function(t,r,e){e(1)({target:"Map",stat:!0,forced:!0},{from:e(745)})},function(t,r,e){var n=e(36),g=e(20),y=e(32),i=e(179),k=e(98),L=e(50),$=[].push;t.exports=function(V){var z,re,oe,le,ue=arguments.length,ie=ue>1?arguments[1]:void 0;return i(this),(z=ie!==void 0)&&y(ie),k(V)?new this:(re=[],z?(oe=0,le=n(ie,ue>2?arguments[2]:void 0),L(V,function(ae){g($,re,le(ae,oe++))})):L(V,$,{that:re}),new this(re))}},function(t,r,e){e(1)({target:"Map",stat:!0,forced:!0},{of:e(747)})},function(t,r,e){var n=e(104);t.exports=function(){return new this(n(arguments))}},function(t,r,e){var n=e(1),g=e(39),y=e(67).remove;n({target:"Map",proto:!0,real:!0,forced:!0},{deleteAll:function(){for(var i,k=g(this),L=!0,$=0,V=arguments.length;$<V;$++)i=y(k,arguments[$]),L=L&&i;return!!L}})},function(t,r){t.exports=function(e,n){return n==1?function(g,y){return g[e](y)}:function(g,y,i){return g[e](y,i)}}},function(t,r,e){var n=e(1),g=e(39),y=e(67),i=y.get,k=y.has,L=y.set;n({target:"Map",proto:!0,real:!0,forced:!0},{emplace:function($,V){var z,re,oe=g(this);return k(oe,$)?(z=i(oe,$),"update"in V&&(z=V.update(z,$,oe),L(oe,$,z)),z):(re=V.insert($,oe),L(oe,$,re),re)}})},function(t,r,e){var n=e(1),g=e(36),y=e(39),i=e(62);n({target:"Map",proto:!0,real:!0,forced:!0},{every:function(k){var L=y(this),$=g(k,arguments.length>1?arguments[1]:void 0);return i(L,function(V,z){if(!$(V,z,L))return!1},!0)!==!1}})},function(t,r,e){var n=e(20);t.exports=function(g,y,i){for(var k,L,$=i||g.next;!(k=n($,g)).done;)if((L=y(k.value))!==void 0)return L}},function(t,r,e){var n=e(1),g=e(36),y=e(39),i=e(67),k=e(62),L=i.Map,$=i.set;n({target:"Map",proto:!0,real:!0,forced:!0},{filter:function(V){var z=y(this),re=g(V,arguments.length>1?arguments[1]:void 0),oe=new L;return k(z,function(le,ue){re(le,ue,z)&&$(oe,ue,le)}),oe}})},function(t,r,e){var n=e(1),g=e(36),y=e(39),i=e(62);n({target:"Map",proto:!0,real:!0,forced:!0},{find:function(k){var L=y(this),$=g(k,arguments.length>1?arguments[1]:void 0),V=i(L,function(z,re){if($(z,re,L))return{value:z}},!0);return V&&V.value}})},function(t,r,e){var n=e(1),g=e(36),y=e(39),i=e(62);n({target:"Map",proto:!0,real:!0,forced:!0},{findKey:function(k){var L=y(this),$=g(k,arguments.length>1?arguments[1]:void 0),V=i(L,function(z,re){if($(z,re,L))return{key:re}},!0);return V&&V.key}})},function(t,r,e){var n=e(1),g=e(20),y=e(13),i=e(17),k=e(32),L=e(50),$=e(67).Map,V=y([].push);n({target:"Map",stat:!0,forced:!0},{groupBy:function(z,re){var oe=new(i(this)?this:$);k(re);var le=k(oe.has),ue=k(oe.get),ie=k(oe.set);return L(z,function(ae){var Ie=re(ae);g(le,oe,Ie)?V(g(ue,oe,Ie),ae):g(ie,oe,Ie,[ae])}),oe}})},function(t,r,e){var n=e(1),g=e(758),y=e(39),i=e(62);n({target:"Map",proto:!0,real:!0,forced:!0},{includes:function(k){return i(y(this),function(L){if(g(L,k))return!0},!0)===!0}})},function(t,r){t.exports=function(e,n){return e===n||e!=e&&n!=n}},function(t,r,e){var n=e(1),g=e(20),y=e(50),i=e(17),k=e(32),L=e(67).Map;n({target:"Map",stat:!0,forced:!0},{keyBy:function($,V){var z=new(i(this)?this:L);k(V);var re=k(z.set);return y($,function(oe){g(re,z,V(oe),oe)}),z}})},function(t,r,e){var n=e(1),g=e(39),y=e(62);n({target:"Map",proto:!0,real:!0,forced:!0},{keyOf:function(i){var k=y(g(this),function(L,$){if(L===i)return{key:$}},!0);return k&&k.key}})},function(t,r,e){var n=e(1),g=e(36),y=e(39),i=e(67),k=e(62),L=i.Map,$=i.set;n({target:"Map",proto:!0,real:!0,forced:!0},{mapKeys:function(V){var z=y(this),re=g(V,arguments.length>1?arguments[1]:void 0),oe=new L;return k(z,function(le,ue){$(oe,re(le,ue,z),le)}),oe}})},function(t,r,e){var n=e(1),g=e(36),y=e(39),i=e(67),k=e(62),L=i.Map,$=i.set;n({target:"Map",proto:!0,real:!0,forced:!0},{mapValues:function(V){var z=y(this),re=g(V,arguments.length>1?arguments[1]:void 0),oe=new L;return k(z,function(le,ue){$(oe,ue,re(le,ue,z))}),oe}})},function(t,r,e){var n=e(1),g=e(39),y=e(50),i=e(67).set;n({target:"Map",proto:!0,real:!0,arity:1,forced:!0},{merge:function(k){for(var L=g(this),$=arguments.length,V=0;V<$;)y(arguments[V++],function(z,re){i(L,z,re)},{AS_ENTRIES:!0});return L}})},function(t,r,e){var n=e(1),g=e(32),y=e(39),i=e(62),k=TypeError;n({target:"Map",proto:!0,real:!0,forced:!0},{reduce:function(L){var $=y(this),V=arguments.length<2,z=V?void 0:arguments[1];if(g(L),i($,function(re,oe){V?(V=!1,z=re):z=L(z,re,oe,$)}),V)throw k("Reduce of empty map with no initial value");return z}})},function(t,r,e){var n=e(1),g=e(36),y=e(39),i=e(62);n({target:"Map",proto:!0,real:!0,forced:!0},{some:function(k){var L=y(this),$=g(k,arguments.length>1?arguments[1]:void 0);return i(L,function(V,z){if($(V,z,L))return!0},!0)===!0}})},function(t,r,e){var n=e(1),g=e(32),y=e(39),i=e(67),k=TypeError,L=i.get,$=i.has,V=i.set;n({target:"Map",proto:!0,real:!0,forced:!0},{update:function(z,re){var oe=y(this),le=arguments.length;g(re);var ue=$(oe,z);if(!ue&&le<3)throw k("Updating absent value");var ie=ue?L(oe,z):g(le>2?arguments[2]:void 0)(z,oe);return V(oe,z,re(ie,z,oe)),oe}})},function(t,r,e){e(1)({target:"Map",proto:!0,real:!0,forced:!0},{upsert:e(301)})},function(t,r,e){e(1)({target:"Map",proto:!0,real:!0,name:"upsert",forced:!0},{updateOrInsert:e(301)})},function(t,r,e){var n=e(194);t.exports=function(g){var y;return n(y=Function.toString.call(g)).call(y,"[native code]")!==-1},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,r,e){var n=e(159),g=e(302),y=e(196),i=e(774);function k(L,$,V){var z;return i()?(t.exports=k=n(z=g).call(z),t.exports.__esModule=!0,t.exports.default=t.exports):(t.exports=k=function(re,oe,le){var ue=[null];ue.push.apply(ue,oe);var ie=new(n(Function).apply(re,ue));return le&&y(ie,le.prototype),ie},t.exports.__esModule=!0,t.exports.default=t.exports),k.apply(null,arguments)}t.exports=k,t.exports.__esModule=!0,t.exports.default=t.exports},function(t,r,e){t.exports=e(772)},function(t,r,e){var n=e(773);t.exports=n},function(t,r,e){var n=e(286);t.exports=n},function(t,r,e){var n=e(302);t.exports=function(){if(typeof Reflect>"u"||!n||n.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(n(Boolean,[],function(){})),!0}catch{return!1}},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,r,e){var n=e(15),g=e(0),y=e(155),i=g.merge({},y.idMap,{auth:{id:2,login:3,kicked:5,logout:6,multiPortLogin:7,kick:8},user:{id:3,updatePushToken:1,appBackground:2,markInBlacklist:3,getBlacklist:4,markInMutelist:5,getMutelist:6,getRelations:8,getUsers:7,updateMyInfo:10,updateDonnop:15,syncMyInfo:109,syncUpdateMyInfo:110},notify:{id:4,markRead:3,syncOfflineMsgs:4,batchMarkRead:5,syncOfflineSysMsgs:6,syncOfflineNetcallMsgs:8,syncRoamingMsgs:9,syncMsgReceipts:12,syncRobots:15,syncBroadcastMsgs:16,syncSuperTeamRoamingMsgs:17,syncOfflineSuperTeamSysMsgs:18,syncDeleteSuperTeamMsgOfflineRoaming:19,syncDeleteMsgSelf:21,syncSessionsWithMoreRoaming:22,syncStickTopSessions:23,syncSessionHistoryMsgsDelete:24,syncSessionReliableInfo:25},sync:{id:5,sync:1,syncTeamMembers:2,syncSuperTeamMembers:3},msg:{id:7,sendMsg:1,msg:2,sysMsg:3,getHistoryMsgs:6,sendCustomSysMsg:7,searchHistoryMsgs:8,deleteSessions:9,getSessions:10,syncSendMsg:101,sendMsgReceipt:11,msgReceipt:12,deleteMsg:13,msgDeleted:14,markSessionAck:16,markSessionAckBatch:25,broadcastMsg:17,clearServerHistoryMsgs:18,getServerSessions:19,getServerSession:20,updateServerSession:21,deleteServerSessions:22,deleteMsgSelf:23,deleteMsgSelfBatch:24,msgFtsInServer:26,msgFtsInServerByTiming:27,onClearServerHistoryMsgs:118,syncUpdateServerSession:121,onDeleteMsgSelf:123,onDeleteMsgSelfBatch:124},msgExtend:{id:23,getThreadMsgs:1,getMsgsByIdServer:2,addQuickComment:3,deleteQuickComment:4,onQuickComment:5,onDeleteQuickComment:6,getQuickComments:7,addCollect:8,deleteCollects:9,updateCollect:10,getCollects:11,addStickTopSession:12,deleteStickTopSession:13,updateStickTopSession:14,addMsgPin:15,updateMsgPin:16,deleteMsgPin:17,onAddMsgPin:18,onUpdateMsgPin:19,onDeleteMsgPin:20,getMsgPins:21,syncAddQuickComment:103,syncDeleteQuickComment:104,syncAddStickTopSession:112,syncDeleteStickTopSession:113,syncUpdateStickTopSession:114,syncAddMsgPin:115,syncUpdateMsgPin:116,syncDeleteMsgPin:117},team:{id:8,createTeam:1,sendTeamMsg:2,teamMsg:3,teamMsgs:4,addTeamMembers:5,removeTeamMembers:6,updateTeam:7,leaveTeam:8,getTeam:9,getTeams:10,getTeamMembers:11,dismissTeam:12,applyTeam:13,passTeamApply:14,rejectTeamApply:15,addTeamManagers:16,removeTeamManagers:17,transferTeam:18,updateInfoInTeam:19,updateNickInTeam:20,acceptTeamInvite:21,rejectTeamInvite:22,getTeamHistoryMsgs:23,searchTeamHistoryMsgs:24,updateMuteStateInTeam:25,getMyTeamMembers:26,getMutedTeamMembers:27,sendTeamMsgReceipt:28,getTeamMsgReads:29,getTeamMsgReadAccounts:30,notifyTeamMsgReads:31,muteTeamAll:32,getTeamMemberInvitorAccid:33,getTeamsById:34,syncMyTeamMembers:126,syncTeams:109,syncTeamMembers:111,syncCreateTeam:101,syncSendTeamMsg:102,syncUpdateTeamMember:119},superTeam:{id:21,sendSuperTeamMsg:2,superTeamMsg:3,addSuperTeamMembers:5,removeSuperTeamMembers:6,leaveSuperTeam:7,updateSuperTeam:8,getSuperTeam:9,getSuperTeams:12,updateInfoInSuperTeam:10,getMySuperTeamMembers:11,getSuperTeamMembers:13,getSuperTeamHistoryMsgs:14,getSuperTeamMembersByJoinTime:15,sendSuperTeamCustomSysMsg:16,deleteSuperTeamMsg:17,superTeamMsgDelete:18,superTeamCustomSysMsg:19,applySuperTeam:20,passSuperTeamApply:21,rejectSuperTeamApply:22,acceptSuperTeamInvite:23,rejectSuperTeamInvite:24,markSuperTeamSessionAck:25,addSuperTeamManagers:26,removeSuperTeamManagers:27,updateSuperTeamMute:28,updateSuperTeamMembersMute:29,updateNickInSuperTeam:30,transferSuperTeam:31,markSuperTeamSessionsAck:32,getSuperTeamMembersByAccounts:33,getMutedSuperTeamMembers:34,syncMySuperTeamMembers:111,syncSuperTeams:109,syncSuperTeamMembers:113,syncCreateSuperTeam:101,syncSendSuperTeamMsg:102,syncUpdateSuperTeamMember:110,syncDeleteSuperTeamMsg:117},friend:{id:12,friendRequest:1,syncFriendRequest:101,deleteFriend:2,syncDeleteFriend:102,updateFriend:3,syncUpdateFriend:103,getFriends:4},chatroom:{id:13,getChatroomAddress:1},filter:{id:101,sendFilterMsg:1,filterMsg:2,filterSysMsg:3,sendFilterCustomSysMsg:7},eventService:{id:14,publishEvent:1,pushEvent:2,subscribeEvent:3,unSubscribeEventsByAccounts:4,unSubscribeEventsByType:5,querySubscribeEventsByAccounts:6,querySubscribeEventsByType:7,pushEvents:9},proxyService:{id:22,httpProxy:1,onProxyMsg:2},qchat:{id:24,getQChatAddress:1}}),k=g.merge({},y.cmdConfig,{login:{sid:i.auth.id,cid:i.auth.login,params:[{type:"Property",name:"login"}]},logout:{sid:i.auth.id,cid:i.auth.logout},kick:{sid:i.auth.id,cid:i.auth.kick,params:[{type:"StrArray",name:"deviceIds"}]},updatePushToken:{sid:i.user.id,cid:i.user.updatePushToken,params:[{type:"String",name:"tokenName"},{type:"String",name:"token"},{type:"Int",name:"pushkit"}]},appBackground:{sid:i.user.id,cid:i.user.appBackground,params:[{type:"Bool",name:"isBackground"},{type:"Int",name:"badge"}]},markInBlacklist:{sid:i.user.id,cid:i.user.markInBlacklist,params:[{type:"String",name:"account"},{type:"Bool",name:"isAdd"}]},getBlacklist:{sid:i.user.id,cid:i.user.getBlacklist,params:[]},markInMutelist:{sid:i.user.id,cid:i.user.markInMutelist,params:[{type:"String",name:"account"},{type:"Bool",name:"isAdd"}]},getMutelist:{sid:i.user.id,cid:i.user.getMutelist,params:[]},getRelations:{sid:i.user.id,cid:i.user.getRelations,params:[{type:"Long",name:"timetag"}]},getUsers:{sid:i.user.id,cid:i.user.getUsers,params:[{type:"StrArray",name:"accounts"}]},updateMyInfo:{sid:i.user.id,cid:i.user.updateMyInfo,params:[{type:"Property",name:"user"},{type:"Property",name:"antispamTag"}]},updateDonnop:{sid:i.user.id,cid:i.user.updateDonnop,params:[{type:"Property",name:"donnop"}]},markRead:{sid:i.notify.id,cid:i.notify.markRead,params:[{type:"Long",name:"id"},{type:"ph",name:"ph"}]},batchMarkRead:{sid:i.notify.id,cid:i.notify.batchMarkRead,params:[{type:"Byte",name:"sid"},{type:"Byte",name:"cid"},{type:"LongArray",name:"ids"}]},sync:{sid:i.sync.id,cid:i.sync.sync,isAwaitable:!1,params:[{type:"Property",name:"sync"}]},syncTeamMembers:{sid:i.sync.id,cid:i.sync.syncTeamMembers,params:[]},syncSuperTeamMembers:{sid:i.sync.id,cid:i.sync.syncSuperTeamMembers,params:[{type:"LongLongMap",name:"sync"}]},sendMsg:{sid:i.msg.id,cid:i.msg.sendMsg,params:[{type:"Property",name:"msg"}]},getHistoryMsgs:{sid:i.msg.id,cid:i.msg.getHistoryMsgs,params:[{type:"String",name:"to"},{type:"Long",name:"beginTime"},{type:"Long",name:"endTime"},{type:"Long",name:"lastMsgId"},{type:"Int",name:"limit"},{type:"Bool",name:"reverse"},{type:"LongArray",name:"msgTypes"}]},sendCustomSysMsg:{sid:i.msg.id,cid:i.msg.sendCustomSysMsg,params:[{type:"Property",name:"sysMsg"}]},searchHistoryMsgs:{sid:i.msg.id,cid:i.msg.searchHistoryMsgs,params:[{type:"String",name:"to"},{type:"Long",name:"beginTime"},{type:"Long",name:"endTime"},{type:"String",name:"keyword"},{type:"Int",name:"limit"},{type:"Bool",name:"reverse"}]},getSessions:{sid:i.msg.id,cid:i.msg.getSessions,params:[{type:"Long",name:"time"}]},deleteSessions:{sid:i.msg.id,cid:i.msg.deleteSessions,params:[{type:"StrArray",name:"sessions"}]},sendMsgReceipt:{sid:i.msg.id,cid:i.msg.sendMsgReceipt,params:[{type:"Property",name:"msgReceipt"}]},deleteMsg:{sid:i.msg.id,cid:i.msg.deleteMsg,params:[{type:"Property",name:"sysMsg"}]},markSessionAck:{sid:i.msg.id,cid:i.msg.markSessionAck,params:[{type:"Byte",name:"scene"},{type:"String",name:"to"},{type:"Long",name:"timetag"}]},markSessionAckBatch:{sid:i.msg.id,cid:i.msg.markSessionAckBatch,params:[{type:"PropertyArray",name:"sessionAckTags",entity:"sessionAckTag"}]},clearServerHistoryMsgs:{sid:i.msg.id,cid:i.msg.clearServerHistoryMsgs,params:[{type:"Property",name:"clearMsgsParams"}]},clearServerHistoryMsgsWithSync:{sid:i.msg.id,cid:i.msg.clearServerHistoryMsgs,params:[{type:"Property",name:"clearMsgsParamsWithSync"}]},msgFtsInServer:{sid:i.msg.id,cid:i.msg.msgFtsInServer,params:[{type:"Property",name:"msgFullSearchRequestTag"}]},msgFtsInServerByTiming:{sid:i.msg.id,cid:i.msg.msgFtsInServerByTiming,params:[{type:"Property",name:"msgTimingFullSearchRequestTag"}]},onClearServerHistoryMsgs:{sid:i.msg.id,cid:i.msg.clearServerHistoryMsgs},getServerSessions:{sid:i.msg.id,cid:i.msg.getServerSessions,params:[{type:"Property",name:"sessionReqTag"}]},getServerSession:{sid:i.msg.id,cid:i.msg.getServerSession,params:[{type:"Property",name:"session"}]},updateServerSession:{sid:i.msg.id,cid:i.msg.updateServerSession,params:[{type:"Property",name:"session"}]},deleteServerSessions:{sid:i.msg.id,cid:i.msg.deleteServerSessions,params:[{type:"PropertyArray",name:"sessions",entity:"session"}]},deleteMsgSelf:{sid:i.msg.id,cid:i.msg.deleteMsgSelf,params:[{type:"Property",name:"deleteMsgSelfTag"}]},deleteMsgSelfBatch:{sid:i.msg.id,cid:i.msg.deleteMsgSelfBatch,params:[{type:"PropertyArray",name:"deleteMsgSelfTags",entity:"deleteMsgSelfTag"}]},onDeleteMsgSelf:{sid:i.msg.id,cid:i.msg.onDeleteMsgSelf},onDeleteMsgSelfBatch:{sid:i.msg.id,cid:i.msg.onDeleteMsgSelfBatch},sendSuperTeamMsg:{sid:i.superTeam.id,cid:i.superTeam.sendSuperTeamMsg,params:[{type:"Property",name:"msg"}]},addSuperTeamMembers:{sid:i.superTeam.id,cid:i.superTeam.addSuperTeamMembers,params:[{type:"Long",name:"teamId"},{type:"StrArray",name:"accounts"},{type:"String",name:"ps"}]},removeSuperTeamMembers:{sid:i.superTeam.id,cid:i.superTeam.removeSuperTeamMembers,params:[{type:"Long",name:"teamId"},{type:"StrArray",name:"accounts"}]},leaveSuperTeam:{sid:i.superTeam.id,cid:i.superTeam.leaveSuperTeam,params:[{type:"Long",name:"teamId"}]},updateSuperTeam:{sid:i.superTeam.id,cid:i.superTeam.updateSuperTeam,params:[{type:"Property",name:"team"},{type:"Property",name:"antispamTag"}]},getSuperTeam:{sid:i.superTeam.id,cid:i.superTeam.getSuperTeam,params:[{type:"Long",name:"teamId"}]},getSuperTeams:{sid:i.superTeam.id,cid:i.superTeam.getSuperTeams,params:[{type:"Long",name:"timetag"}]},getSuperTeamMembers:{sid:i.superTeam.id,cid:i.superTeam.getSuperTeamMembers,params:[{type:"Long",name:"teamId"},{type:"Long",name:"timetag"}]},updateInfoInSuperTeam:{sid:i.superTeam.id,cid:i.superTeam.updateInfoInSuperTeam,params:[{type:"Property",name:"superTeamMember"},{type:"Property",name:"teamSpecialFollowUpdateTag"}]},getSuperTeamHistoryMsgs:{sid:i.superTeam.id,cid:i.superTeam.getSuperTeamHistoryMsgs,params:[{type:"Long",name:"to"},{type:"Long",name:"beginTime"},{type:"Long",name:"endTime"},{type:"Long",name:"lastMsgId"},{type:"Int",name:"limit"},{type:"Bool",name:"reverse"},{type:"LongArray",name:"msgTypes"}]},applySuperTeam:{sid:i.superTeam.id,cid:i.superTeam.applySuperTeam,params:[{type:"Long",name:"teamId"},{type:"String",name:"ps"}]},passSuperTeamApply:{sid:i.superTeam.id,cid:i.superTeam.passSuperTeamApply,params:[{type:"Long",name:"teamId"},{type:"String",name:"from"}]},rejectSuperTeamApply:{sid:i.superTeam.id,cid:i.superTeam.rejectSuperTeamApply,params:[{type:"Long",name:"teamId"},{type:"String",name:"from"},{type:"String",name:"ps"}]},acceptSuperTeamInvite:{sid:i.superTeam.id,cid:i.superTeam.acceptSuperTeamInvite,params:[{type:"Long",name:"teamId"},{type:"String",name:"from"}]},rejectSuperTeamInvite:{sid:i.superTeam.id,cid:i.superTeam.rejectSuperTeamInvite,params:[{type:"Long",name:"teamId"},{type:"String",name:"from"},{type:"String",name:"ps"}]},markSuperTeamSessionAck:{sid:i.superTeam.id,cid:i.superTeam.markSuperTeamSessionAck,params:[{type:"Long",name:"to"},{type:"Long",name:"timetag"}]},addSuperTeamManagers:{sid:i.superTeam.id,cid:i.superTeam.addSuperTeamManagers,params:[{type:"Long",name:"teamId"},{type:"StrArray",name:"accounts"}]},removeSuperTeamManagers:{sid:i.superTeam.id,cid:i.superTeam.removeSuperTeamManagers,params:[{type:"Long",name:"teamId"},{type:"StrArray",name:"accounts"}]},updateSuperTeamMute:{sid:i.superTeam.id,cid:i.superTeam.updateSuperTeamMute,params:[{type:"Long",name:"teamId"},{type:"Int",name:"mute"}]},updateSuperTeamMembersMute:{sid:i.superTeam.id,cid:i.superTeam.updateSuperTeamMembersMute,params:[{type:"Long",name:"teamId"},{type:"StrArray",name:"accounts"},{type:"Int",name:"mute"}]},updateNickInSuperTeam:{sid:i.superTeam.id,cid:i.superTeam.updateNickInSuperTeam,params:[{type:"Property",name:"superTeamMember"}]},transferSuperTeam:{sid:i.superTeam.id,cid:i.superTeam.transferSuperTeam,params:[{type:"Long",name:"teamId"},{type:"String",name:"account"},{type:"Bool",name:"leave"}]},markSuperTeamSessionsAck:{sid:i.superTeam.id,cid:i.superTeam.markSuperTeamSessionsAck,params:[{type:"PropertyArray",name:"sessionAckTags",entity:"sessionAckTag"}]},getSuperTeamMembersByJoinTime:{sid:i.superTeam.id,cid:i.superTeam.getSuperTeamMembersByJoinTime,params:[{type:"Long",name:"teamId"},{type:"Long",name:"joinTime"},{type:"Int",name:"limit"},{type:"Bool",name:"reverse"}]},getSuperTeamMembersByAccounts:{sid:i.superTeam.id,cid:i.superTeam.getSuperTeamMembersByAccounts,params:[{type:"StrArray",name:"memberIds"}]},getMutedSuperTeamMembers:{sid:i.superTeam.id,cid:i.superTeam.getMutedSuperTeamMembers,params:[{type:"Long",name:"teamId"},{type:"Long",name:"joinTime"},{type:"Int",name:"limit"},{type:"Bool",name:"reverse"}]},sendSuperTeamCustomSysMsg:{sid:i.superTeam.id,cid:i.superTeam.sendSuperTeamCustomSysMsg,params:[{type:"Property",name:"sysMsg"}]},deleteSuperTeamMsg:{sid:i.superTeam.id,cid:i.superTeam.deleteSuperTeamMsg,params:[{type:"Property",name:"sysMsg"}]},getMySuperTeamMembers:{sid:i.superTeam.id,cid:i.superTeam.getMySuperTeamMembers,params:[{type:"LongArray",name:"teamIds"}]},createTeam:{sid:i.team.id,cid:i.team.createTeam,params:[{type:"Property",name:"team"},{type:"StrArray",name:"accounts"},{type:"String",name:"ps"},{type:"Property",name:"antispamTag"}]},sendTeamMsg:{sid:i.team.id,cid:i.team.sendTeamMsg,params:[{type:"Property",name:"msg"}]},addTeamMembers:{sid:i.team.id,cid:i.team.addTeamMembers,params:[{type:"Long",name:"teamId"},{type:"StrArray",name:"accounts"},{type:"String",name:"ps"},{type:"String",name:"attach"}]},removeTeamMembers:{sid:i.team.id,cid:i.team.removeTeamMembers,params:[{type:"Long",name:"teamId"},{type:"StrArray",name:"accounts"}]},updateTeam:{sid:i.team.id,cid:i.team.updateTeam,params:[{type:"Property",name:"team"},{type:"Property",name:"antispamTag"}]},leaveTeam:{sid:i.team.id,cid:i.team.leaveTeam,params:[{type:"Long",name:"teamId"}]},getTeam:{sid:i.team.id,cid:i.team.getTeam,params:[{type:"Long",name:"teamId"}]},getTeams:{sid:i.team.id,cid:i.team.getTeams,params:[{type:"Long",name:"timetag"}]},getTeamsById:{sid:i.team.id,cid:i.team.getTeamsById,params:[{type:"LongArray",name:"teamIds"}]},getTeamMembers:{sid:i.team.id,cid:i.team.getTeamMembers,params:[{type:"Long",name:"teamId"},{type:"Long",name:"timetag"}]},dismissTeam:{sid:i.team.id,cid:i.team.dismissTeam,params:[{type:"Long",name:"teamId"}]},applyTeam:{sid:i.team.id,cid:i.team.applyTeam,params:[{type:"Long",name:"teamId"},{type:"String",name:"ps"}]},passTeamApply:{sid:i.team.id,cid:i.team.passTeamApply,params:[{type:"Long",name:"teamId"},{type:"String",name:"from"}]},rejectTeamApply:{sid:i.team.id,cid:i.team.rejectTeamApply,params:[{type:"Long",name:"teamId"},{type:"String",name:"from"},{type:"String",name:"ps"}]},addTeamManagers:{sid:i.team.id,cid:i.team.addTeamManagers,params:[{type:"Long",name:"teamId"},{type:"StrArray",name:"accounts"}]},removeTeamManagers:{sid:i.team.id,cid:i.team.removeTeamManagers,params:[{type:"Long",name:"teamId"},{type:"StrArray",name:"accounts"}]},transferTeam:{sid:i.team.id,cid:i.team.transferTeam,params:[{type:"Long",name:"teamId"},{type:"String",name:"account"},{type:"Bool",name:"leave"}]},updateInfoInTeam:{sid:i.team.id,cid:i.team.updateInfoInTeam,params:[{type:"Property",name:"teamMember"},{type:"Property",name:"teamSpecialFollowUpdateTag"}]},updateNickInTeam:{sid:i.team.id,cid:i.team.updateNickInTeam,params:[{type:"Property",name:"teamMember"}]},acceptTeamInvite:{sid:i.team.id,cid:i.team.acceptTeamInvite,params:[{type:"Long",name:"teamId"},{type:"String",name:"from"}]},rejectTeamInvite:{sid:i.team.id,cid:i.team.rejectTeamInvite,params:[{type:"Long",name:"teamId"},{type:"String",name:"from"},{type:"String",name:"ps"}]},getTeamHistoryMsgs:{sid:i.team.id,cid:i.team.getTeamHistoryMsgs,params:[{type:"Long",name:"to"},{type:"Long",name:"beginTime"},{type:"Long",name:"endTime"},{type:"Long",name:"lastMsgId"},{type:"Int",name:"limit"},{type:"Bool",name:"reverse"},{type:"LongArray",name:"msgTypes"}]},searchTeamHistoryMsgs:{sid:i.team.id,cid:i.team.searchTeamHistoryMsgs,params:[{type:"Long",name:"to"},{type:"Long",name:"beginTime"},{type:"Long",name:"endTime"},{type:"String",name:"keyword"},{type:"Int",name:"limit"},{type:"Bool",name:"reverse"}]},updateMuteStateInTeam:{sid:i.team.id,cid:i.team.updateMuteStateInTeam,params:[{type:"Long",name:"teamId"},{type:"String",name:"account"},{type:"Int",name:"mute"}]},getMyTeamMembers:{sid:i.team.id,cid:i.team.getMyTeamMembers,params:[{type:"LongArray",name:"teamIds"}]},getMutedTeamMembers:{sid:i.team.id,cid:i.team.getMutedTeamMembers,params:[{type:"Long",name:"teamId"}]},sendTeamMsgReceipt:{sid:i.team.id,cid:i.team.sendTeamMsgReceipt,params:[{type:"PropertyArray",name:"teamMsgReceipts",entity:"teamMsgReceipt"}]},getTeamMsgReads:{sid:i.team.id,cid:i.team.getTeamMsgReads,params:[{type:"PropertyArray",name:"teamMsgReceipts",entity:"teamMsgReceipt"}]},getTeamMsgReadAccounts:{sid:i.team.id,cid:i.team.getTeamMsgReadAccounts,params:[{type:"Property",name:"teamMsgReceipt"}]},muteTeamAll:{sid:i.team.id,cid:i.team.muteTeamAll,params:[{type:"Long",name:"teamId"},{type:"Int",name:"mute"}]},getTeamMemberInvitorAccid:{sid:i.team.id,cid:i.team.getTeamMemberInvitorAccid,params:[{type:"Long",name:"teamId"},{type:"StrArray",name:"accounts"}]},friendRequest:{sid:i.friend.id,cid:i.friend.friendRequest,params:[{type:"String",name:"account"},{type:"Byte",name:"type"},{type:"String",name:"ps"}]},deleteFriend:{sid:i.friend.id,cid:i.friend.deleteFriend,params:[{type:"String",name:"account"},{type:"Property",name:"delFriendParams"}]},updateFriend:{sid:i.friend.id,cid:i.friend.updateFriend,params:[{type:"Property",name:"friend"}]},getFriends:{sid:i.friend.id,cid:i.friend.getFriends,params:[{type:"Long",name:"timetag"}]},getChatroomAddress:{sid:i.chatroom.id,cid:i.chatroom.getChatroomAddress,params:[{type:"Long",name:"chatroomId"},{type:"Bool",name:"isWeixinApp"},{type:"Int",name:"type"}]},sendFilterMsg:{sid:n(i).id,cid:n(i).sendFilterMsg,params:[{type:"Property",name:"msg"}]},sendFilterCustomSysMsg:{sid:n(i).id,cid:n(i).sendFilterCustomSysMsg,params:[{type:"Property",name:"sysMsg"}]},publishEvent:{sid:i.eventService.id,cid:i.eventService.publishEvent,params:[{type:"Property",name:"msgEvent"}]},pushEvent:{sid:i.eventService.id,cid:i.eventService.pushEvent},subscribeEvent:{sid:i.eventService.id,cid:i.eventService.subscribeEvent,params:[{type:"Property",name:"msgEventSubscribe"},{type:"StrArray",name:"accounts"}]},unSubscribeEventsByAccounts:{sid:i.eventService.id,cid:i.eventService.unSubscribeEventsByAccounts,params:[{type:"Property",name:"msgEventSubscribe"},{type:"StrArray",name:"accounts"}]},unSubscribeEventsByType:{sid:i.eventService.id,cid:i.eventService.unSubscribeEventsByType,params:[{type:"Property",name:"msgEventSubscribe"}]},querySubscribeEventsByAccounts:{sid:i.eventService.id,cid:i.eventService.querySubscribeEventsByAccounts,params:[{type:"Property",name:"msgEventSubscribe"},{type:"StrArray",name:"accounts"}]},querySubscribeEventsByType:{sid:i.eventService.id,cid:i.eventService.querySubscribeEventsByType,params:[{type:"Property",name:"msgEventSubscribe"}]},pushEvents:{sid:i.eventService.id,cid:i.eventService.pushEvents},getThreadMsgs:{sid:i.msgExtend.id,cid:i.msgExtend.getThreadMsgs,params:[{type:"Property",name:"msg"},{type:"Property",name:"threadMsgReq"}]},getMsgsByIdServer:{sid:i.msgExtend.id,cid:i.msgExtend.getMsgsByIdServer,params:[{type:"PropertyArray",name:"reqMsgs",entity:"msg"}]},addQuickComment:{sid:i.msgExtend.id,cid:i.msgExtend.addQuickComment,params:[{type:"Property",name:"msg"},{type:"Property",name:"comment"}]},deleteQuickComment:{sid:i.msgExtend.id,cid:i.msgExtend.deleteQuickComment,params:[{type:"Property",name:"msg"},{type:"Property",name:"comment"}]},getQuickComments:{sid:i.msgExtend.id,cid:i.msgExtend.getQuickComments,params:[{type:"PropertyArray",name:"commentReq",entity:"commentReq"}]},addCollect:{sid:i.msgExtend.id,cid:i.msgExtend.addCollect,params:[{type:"Property",name:"collect"}]},deleteCollects:{sid:i.msgExtend.id,cid:i.msgExtend.deleteCollects,params:[{type:"PropertyArray",name:"collectList",entity:"collect"}]},updateCollect:{sid:i.msgExtend.id,cid:i.msgExtend.updateCollect,params:[{type:"Property",name:"collect"}]},getCollects:{sid:i.msgExtend.id,cid:i.msgExtend.getCollects,params:[{type:"Property",name:"collectQuery"}]},addStickTopSession:{sid:i.msgExtend.id,cid:i.msgExtend.addStickTopSession,params:[{type:"Property",name:"stickTopSession"}]},updateStickTopSession:{sid:i.msgExtend.id,cid:i.msgExtend.updateStickTopSession,params:[{type:"Property",name:"stickTopSession"}]},deleteStickTopSession:{sid:i.msgExtend.id,cid:i.msgExtend.deleteStickTopSession,params:[{type:"Property",name:"stickTopSession"}]},addMsgPin:{sid:i.msgExtend.id,cid:i.msgExtend.addMsgPin,params:[{type:"Property",name:"msg"},{type:"Property",name:"pinTag"}]},updateMsgPin:{sid:i.msgExtend.id,cid:i.msgExtend.updateMsgPin,params:[{type:"Property",name:"msg"},{type:"Property",name:"pinTag"}]},deleteMsgPin:{sid:i.msgExtend.id,cid:i.msgExtend.deleteMsgPin,params:[{type:"Property",name:"msg"},{type:"Property",name:"pinTag"}]},getMsgPins:{sid:i.msgExtend.id,cid:i.msgExtend.getMsgPins,params:[{type:"Property",name:"msgPinReq"}]},httpProxy:{sid:i.proxyService.id,cid:i.proxyService.httpProxy,params:[{type:"Property",name:"proxyTag"}]},getQChatAddress:{sid:i.qchat.id,cid:i.qchat.getQChatAddress,params:[{type:"Property",name:"getQChatAddressTag"}]}}),L=g.merge({},y.packetConfig,{"2_3":{service:"auth",cmd:"login",response:[{type:"Property",name:"loginRes"},{type:"PropertyArray",name:"loginPorts",entity:"loginPort"},{type:"Property",name:"aosPushInfo"}]},"2_5":{service:"auth",cmd:"kicked",response:[{type:"Int",name:"from"},{type:"Int",name:"reason"},{type:"String",name:"custom"},{type:"Int",name:"customClientType"}]},"2_6":{service:"auth",cmd:"logout"},"2_7":{service:"auth",cmd:"multiPortLogin",response:[{type:"Byte",name:"state"},{type:"PropertyArray",name:"loginPorts",entity:"loginPort"}]},"2_8":{service:"auth",cmd:"kick",response:[{type:"StrArray",name:"deviceIds"}]},"3_1":{service:"user",cmd:"updatePushToken"},"3_2":{service:"user",cmd:"appBackground"},"3_3":{service:"user",cmd:"markInBlacklist"},"3_103":{service:"user",cmd:"syncMarkInBlacklist",response:[{type:"String",name:"account"},{type:"Bool",name:"isAdd"}]},"3_4":{service:"user",cmd:"getBlacklist",response:[{type:"StrArray",name:"blacklist"}]},"3_5":{service:"user",cmd:"markInMutelist"},"3_105":{service:"user",cmd:"syncMarkInMutelist",response:[{type:"String",name:"account"},{type:"Bool",name:"isAdd"}]},"3_6":{service:"user",cmd:"getMutelist",response:[{type:"StrArray",name:"mutelist"}]},"3_8":{service:"user",cmd:"getRelations",response:[{type:"PropertyArray",name:"specialRelations",entity:"specialRelation"},{type:"Long",name:"timetag"}]},"3_7":{service:"user",cmd:"getUsers",response:[{type:"PropertyArray",name:"users",entity:"user"}]},"3_10":{service:"user",cmd:"updateMyInfo",response:[{type:"Long",name:"timetag"}]},"3_15":{service:"user",cmd:"updateDonnop",response:[{type:"Long",name:"timetag"}]},"3_115":{service:"user",cmd:"syncUpdateDonnop",response:[{type:"Property",name:"donnop"},{type:"Long",name:"timetag"}]},"3_109":{service:"user",cmd:"syncMyInfo",response:[{type:"Property",name:"user"},{type:"Long",name:"timetag"}]},"3_110":{service:"user",cmd:"syncUpdateMyInfo",response:[{type:"Property",name:"user"}]},"4_1":{service:"notify"},"4_2":{service:"notify"},"4_3":{service:"notify",cmd:"markRead"},"4_4":{service:"notify",cmd:"syncOfflineMsgs",response:[{type:"PropertyArray",name:"msgs",entity:"msg"}]},"4_5":{service:"notify",cmd:"batchMarkRead"},"4_6":{service:"notify",cmd:"syncOfflineSysMsgs",response:[{type:"PropertyArray",name:"sysMsgs",entity:"sysMsg"}]},"4_8":{service:"notify",cmd:"syncOfflineNetcallMsgs",response:[{type:"PropertyArray",name:"msgs",entity:"msg"}]},"4_9":{service:"notify",cmd:"syncRoamingMsgs",response:[{type:"PropertyArray",name:"msgs",entity:"msg"}]},"4_12":{service:"notify",cmd:"syncMsgReceipts",response:[{type:"PropertyArray",name:"msgReceipts",entity:"msgReceipt"},{type:"Long",name:"timetag"}]},"4_13":{service:"notify",cmd:"syncDonnop",response:[{type:"Property",name:"donnop"},{type:"Long",name:"timetag"}]},"4_14":{service:"notify",cmd:"syncSessionAck",response:[{type:"StrLongMap",name:"p2p"},{type:"LongLongMap",name:"team"},{type:"Long",name:"timetag"}]},"4_15":{service:"notify",cmd:"syncRobots",response:[{type:"PropertyArray",name:"robots",entity:"robot"}]},"4_16":{service:"notify",cmd:"syncBroadcastMsgs",response:[{type:"PropertyArray",name:"broadcastMsgs",entity:"broadcastMsg"}]},"4_17":{service:"notify",cmd:"syncSuperTeamRoamingMsgs",response:[{type:"PropertyArray",name:"msgs",entity:"msg"}]},"4_18":{service:"notify",cmd:"syncOfflineSuperTeamSysMsgs",response:[{type:"PropertyArray",name:"sysMsgs",entity:"sysMsg"}]},"4_19":{service:"notify",cmd:"syncDeleteSuperTeamMsgOfflineRoaming",response:[{type:"PropertyArray",name:"sysMsgs",entity:"sysMsg"},{type:"Long",name:"timetag"},{type:"Byte",name:"type"}]},"4_20":{service:"notify",cmd:"syncSuperTeamSessionAck",response:[{type:"LongLongMap",name:"superTeam"},{type:"Long",name:"timetag"}]},"4_21":{service:"notify",cmd:"syncDeleteMsgSelf",response:[{type:"PropertyArray",name:"deletedMsgs",entity:"deleteMsgSelfTag"}]},"4_22":{service:"notify",cmd:"syncSessionsWithMoreRoaming",response:[{type:"PropertyArray",name:"sessions",entity:"msg"}]},"4_23":{service:"notify",cmd:"syncStickTopSessions",response:[{type:"Long",name:"timetag"},{type:"Bool",name:"modify"},{type:"PropertyArray",name:"sessions",entity:"stickTopSession"}]},"4_24":{service:"notify",cmd:"syncSessionHistoryMsgsDelete",response:[{type:"PropertyArray",name:"sessionHistoryMsgsDeleteTags",entity:"clearMsgsParamsWithSync"}]},"4_25":{service:"notify",cmd:"syncSessionReliableInfo",response:[{type:"Property",name:"context",entity:"sessionReliableSyncContextTag"},{type:"PropertyArray",name:"datas",entity:"sessionReliableSyncTag"}]},"4_100":{service:"notify",cmd:"syncOfflineFilterMsgs",response:[{type:"PropertyArray",name:"msgs",entity:"msg"}]},"4_101":{service:"notify",cmd:"syncOfflineFilterSysMsgs",response:[{type:"PropertyArray",name:"sysMsgs",entity:"sysMsg"}]},"5_1":{service:"sync",cmd:"syncDone",response:[{type:"Long",name:"timetag"}]},"5_2":{service:"sync",cmd:"syncTeamMembersDone",response:[{type:"Long",name:"timetag"}]},"5_3":{service:"sync",cmd:"syncSuperTeamMembersDone",response:[{type:"Long",name:"timetag"}]},"7_1":{service:"msg",cmd:"sendMsg",response:[{type:"Property",name:"msg"}],trivialErrorCodes:[7101]},"7_2":{service:"msg",cmd:"msg",response:[{type:"Property",name:"msg"}]},"7_3":{service:"msg",cmd:"sysMsg",response:[{type:"Property",name:"sysMsg"}]},"7_6":{service:"msg",cmd:"getHistoryMsgs",response:[{type:"PropertyArray",name:"msgs",entity:"msg"}]},"7_7":{service:"msg",cmd:"sendCustomSysMsg",trivialErrorCodes:[7101]},"7_8":{service:"msg",cmd:"searchHistoryMsgs",response:[{type:"PropertyArray",name:"msgs",entity:"msg"}]},"7_9":{service:"msg",cmd:"deleteSessions"},"7_10":{service:"msg",cmd:"getSessions",response:[{type:"StrArray",name:"sessions"}]},"7_101":{service:"msg",cmd:"syncSendMsg",response:[{type:"Property",name:"msg"}]},"7_11":{service:"msg",cmd:"sendMsgReceipt",response:[{type:"Property",name:"msgReceipt"}]},"7_12":{service:"msg",cmd:"msgReceipt",response:[{type:"Property",name:"msgReceipt"}]},"7_13":{service:"msg",cmd:"onDeleteMsg"},"7_14":{service:"msg",cmd:"onMsgDeleted",response:[{type:"Property",name:"sysMsg"}]},"7_15":{service:"msg",cmd:"onDeleteMsgOfflineRoaming",response:[{type:"PropertyArray",name:"sysMsgs",entity:"sysMsg"},{type:"Long",name:"timetag"},{type:"Byte",name:"type"}]},"7_16":{service:"msg",cmd:"onMarkSessionAck"},"7_17":{service:"msg",cmd:"broadcastMsg",response:[{type:"Property",name:"broadcastMsg"}]},"7_18":{service:"msg",cmd:"clearServerHistoryMsgs",response:[{type:"Long",name:"timetag"}]},"7_19":{service:"session",cmd:"getServerSessions",response:[{type:"Property",name:"sessionReqTag"},{type:"PropertyArray",name:"sessionList",entity:"session"}]},"7_20":{service:"session",cmd:"getServerSession",response:[{type:"Property",name:"session"}]},"7_21":{service:"session",cmd:"updateServerSession"},"7_22":{service:"session",cmd:"deleteServerSessions"},"7_23":{service:"msg",cmd:"deleteMsgSelf",response:[{type:"Long",name:"timetag"}]},"7_24":{service:"msg",cmd:"deleteMsgSelfBatch",response:[{type:"Long",name:"timetag"}]},"7_25":{service:"msg",cmd:"onMarkSessionAckBatch"},"7_26":{service:"msg",cmd:"msgFtsInServer",response:[{type:"PropertyArray",name:"msgs",entity:"msg"}]},"7_27":{service:"msg",cmd:"msgFtsInServerByTiming",response:[{type:"PropertyArray",name:"msgs",entity:"msg"}]},"7_118":{service:"msg",cmd:"onClearServerHistoryMsgs",response:[{type:"Property",name:"sessionHistoryMsgsDeleteTag",entity:"clearMsgsParamsWithSync"}]},"7_123":{service:"msg",cmd:"onDeleteMsgSelf",response:[{type:"Property",name:"deleteMsgSelfTag"}]},"7_124":{service:"msg",cmd:"onDeleteMsgSelfBatch",response:[{type:"PropertyArray",name:"deleteMsgSelfTags",entity:"deleteMsgSelfTag"}]},"7_116":{service:"msg",cmd:"syncMarkSessionAck",response:[{type:"Byte",name:"scene"},{type:"String",name:"to"},{type:"Long",name:"timetag"}]},"7_121":{service:"msg",cmd:"syncUpdateServerSession",response:[{type:"Property",name:"session"}]},"23_1":{service:"msgExtend",cmd:"getThreadMsgs",response:[{type:"Property",name:"threadMsg",entity:"msg"},{type:"Property",name:"threadMsgsMeta"},{type:"PropertyArray",name:"msgs",entity:"msg"}]},"23_2":{service:"msgExtend",cmd:"getMsgsByIdServer",response:[{type:"PropertyArray",name:"msgs",entity:"msg"}]},"23_3":{service:"msgExtend",cmd:"addQuickComment",response:[{type:"Long",name:"timetag"}]},"23_4":{service:"msgExtend",cmd:"deleteQuickComment",response:[{type:"Long",name:"timetag"}]},"23_5":{service:"msgExtend",cmd:"onQuickComment",response:[{type:"Property",name:"msg"},{type:"Property",name:"comment"}]},"23_6":{service:"msgExtend",cmd:"onDeleteQuickComment",response:[{type:"Property",name:"msg"},{type:"Property",name:"comment"}]},"23_7":{service:"msgExtend",cmd:"getQuickComments",response:[{type:"PropertyArray",name:"commentRes",entity:"commentRes"}]},"23_8":{service:"msgExtend",cmd:"addCollect",response:[{type:"Property",name:"collect"}]},"23_9":{service:"msgExtend",cmd:"deleteCollects",response:[{type:"Int",name:"deleteNum"}]},"23_10":{service:"msgExtend",cmd:"updateCollect",response:[{type:"Property",name:"collect"}]},"23_11":{service:"msgExtend",cmd:"getCollects",response:[{type:"Long",name:"total"},{type:"PropertyArray",name:"collectList",entity:"collect"}]},"23_12":{service:"msgExtend",cmd:"addStickTopSession",response:[{type:"Property",name:"stickTopSession"}]},"23_13":{service:"msgExtend",cmd:"deleteStickTopSession",response:[{type:"Long",name:"timetag"}]},"23_14":{service:"msgExtend",cmd:"updateStickTopSession",response:[{type:"Property",name:"stickTopSession"}]},"23_15":{service:"msgExtend",cmd:"addMsgPin",response:[{type:"Long",name:"timetag"}]},"23_16":{service:"msgExtend",cmd:"updateMsgPin",response:[{type:"Long",name:"timetag"}]},"23_17":{service:"msgExtend",cmd:"deleteMsgPin",response:[{type:"Long",name:"timetag"}]},"23_18":{service:"msgExtend",cmd:"onAddMsgPin",response:[{type:"Property",name:"msg"},{type:"Property",name:"pinTag"},{type:"Long",name:"timetag"}]},"23_19":{service:"msgExtend",cmd:"onUpdateMsgPin",response:[{type:"Property",name:"msg"},{type:"Property",name:"pinTag"},{type:"Long",name:"timetag"}]},"23_20":{service:"msgExtend",cmd:"onDeleteMsgPin",response:[{type:"Property",name:"msg"},{type:"Property",name:"pinTag"},{type:"Long",name:"timetag"}]},"23_21":{service:"msgExtend",cmd:"getMsgPins",response:[{type:"Long",name:"timetag"},{type:"Bool",name:"modify"},{type:"PropertyArray",name:"pins",entity:"msgPinRes"}]},"23_103":{service:"msgExtend",cmd:"syncAddQuickComment",response:[{type:"Property",name:"msg"},{type:"Property",name:"comment"}]},"23_104":{service:"msgExtend",cmd:"syncDeleteQuickComment",response:[{type:"Property",name:"msg"},{type:"Property",name:"comment"}]},"23_112":{service:"msgExtend",cmd:"syncAddStickTopSession",response:[{type:"Property",name:"stickTopSession"}]},"23_113":{service:"msgExtend",cmd:"syncDeleteStickTopSession",response:[{type:"Long",name:"timetag"},{type:"Property",name:"stickTopSession"}]},"23_114":{service:"msgExtend",cmd:"syncUpdateStickTopSession",response:[{type:"Property",name:"stickTopSession"}]},"23_115":{service:"msgExtend",cmd:"syncAddMsgPin",response:[{type:"Property",name:"msg"},{type:"Property",name:"pinTag"},{type:"Long",name:"timetag"}]},"23_116":{service:"msgExtend",cmd:"syncUpdateMsgPin",response:[{type:"Property",name:"msg"},{type:"Property",name:"pinTag"},{type:"Long",name:"timetag"}]},"23_117":{service:"msgExtend",cmd:"syncDeleteMsgPin",response:[{type:"Property",name:"msg"},{type:"Property",name:"pinTag"},{type:"Long",name:"timetag"}]},"21_2":{service:"superTeam",cmd:"sendSuperTeamMsg",response:[{type:"Property",name:"msg"}]},"21_3":{service:"superTeam",cmd:"superTeamMsg",response:[{type:"Property",name:"msg"}]},"21_5":{service:"superTeam",cmd:"addSuperTeamMembers",response:[{type:"StrArray",name:"abortedAccidList"},{type:"Long",name:"timetag"}]},"21_6":{service:"superTeam",cmd:"removeSuperTeamMembers",response:[{type:"Long",name:"timetag"}]},"21_7":{service:"superTeam",cmd:"leaveSuperTeam",response:[{type:"Long",name:"timetag"}]},"21_8":{service:"superTeam",cmd:"updateSuperTeam",response:[{type:"Long",name:"timetag"}]},"21_9":{service:"superTeam",cmd:"getSuperTeam",response:[{type:"Property",name:"team"}]},"21_12":{service:"superTeam",cmd:"getSuperTeams",response:[{type:"PropertyArray",name:"teams",entity:"superTeam"},{type:"Bool",name:"isAll"},{type:"Long",name:"timetag"}]},"21_10":{service:"superTeam",cmd:"updateInfoInSuperTeam",response:[{type:"Property",name:"superTeamMember"}]},"21_13":{service:"superTeam",cmd:"getSuperTeamMembers",response:[{type:"Long",name:"timetag"}]},"21_11":{service:"superTeam",cmd:"getMySuperTeamMembers",response:[{type:"PropertyArray",name:"members",entity:"superTeamMember"}]},"21_14":{service:"superTeam",cmd:"getSuperTeamHistoryMsgs",response:[{type:"PropertyArray",name:"msgs",entity:"msg"}]},"21_15":{service:"superTeam",cmd:"getSuperTeamMembersByJoinTime",response:[{type:"PropertyArray",name:"members",entity:"superTeamMember"}]},"21_16":{service:"superTeam",cmd:"sendSuperTeamCustomSysMsg",trivialErrorCodes:[7101]},"21_17":{service:"superTeam",cmd:"onDeleteSuperTeamMsg"},"21_18":{service:"superTeam",cmd:"onSuperTeamMsgDelete",response:[{type:"Property",name:"sysMsg"}]},"21_19":{service:"superTeam",cmd:"superTeamCustomSysMsg",response:[{type:"Property",name:"sysMsg"}]},"21_20":{service:"superTeam",cmd:"applySuperTeam",response:[{type:"Property",name:"team"}]},"21_21":{service:"superTeam",cmd:"passSuperTeamApply"},"21_22":{service:"superTeam",cmd:"rejectSuperTeamApply"},"21_23":{service:"superTeam",cmd:"acceptSuperTeamInvite",response:[{type:"Property",name:"team"}]},"21_24":{service:"superTeam",cmd:"rejectSuperTeamInvite"},"21_25":{service:"superTeam",cmd:"onMarkSuperTeamSessionAck"},"21_26":{service:"superTeam",cmd:"addSuperTeamManagers"},"21_27":{service:"superTeam",cmd:"removeSuperTeamManagers"},"21_28":{service:"superTeam",cmd:"updateSuperTeamMute"},"21_29":{service:"superTeam",cmd:"updateSuperTeamMembersMute",response:[{type:"Long",name:"timetag"}]},"21_30":{service:"superTeam",cmd:"updateNickInSuperTeam"},"21_31":{service:"superTeam",cmd:"transferSuperTeam"},"21_32":{service:"superTeam",cmd:"onMarkSuperTeamSessionsAck"},"21_33":{service:"superTeam",cmd:"getSuperTeamMembersByAccounts",response:[{type:"PropertyArray",name:"members",entity:"superTeamMember"}]},"21_34":{service:"superTeam",cmd:"getMutedSuperTeamMembers",response:[{type:"PropertyArray",name:"members",entity:"superTeamMember"}]},"21_113":{service:"superTeam",cmd:"syncSuperTeamMembers",response:[{type:"Long",name:"teamId"},{type:"PropertyArray",name:"members",entity:"superTeamMember"},{type:"Bool",name:"isAll"},{type:"Long",name:"timetag"}]},"21_111":{service:"superTeam",cmd:"syncMySuperTeamMembers",response:[{type:"PropertyArray",name:"teamMembers",entity:"superTeamMember"},{type:"Long",name:"timetag"}]},"21_109":{service:"superTeam",cmd:"syncSuperTeams",response:[{type:"PropertyArray",name:"teams",entity:"superTeam"},{type:"Bool",name:"isAll"},{type:"Long",name:"timetag"}]},"21_101":{service:"superTeam",cmd:"syncCreateSuperTeam",response:[{type:"Property",name:"team"}]},"21_102":{service:"superTeam",cmd:"syncSendSuperTeamMsg",response:[{type:"Property",name:"msg"}]},"21_110":{service:"superTeam",cmd:"syncUpdateSuperTeamMember",response:[{type:"Property",name:"teamMember",entity:"superTeamMember"}]},"21_117":{service:"superTeam",cmd:"syncDeleteSuperTeamMsg",response:[{type:"Property",name:"sysMsg"}]},"21_125":{service:"superTeam",cmd:"syncMarkSuperTeamSessionAck",response:[{type:"Long",name:"to"},{type:"Long",name:"timetag"}]},"8_1":{service:"team",cmd:"createTeam",response:[{type:"Property",name:"team"},{type:"StrArray",name:"abortedAccidList"}]},"8_2":{service:"team",cmd:"sendTeamMsg",response:[{type:"Property",name:"msg"}]},"8_3":{service:"team",cmd:"teamMsg",response:[{type:"Property",name:"msg"}]},"8_4":{service:"team",cmd:"teamMsgs",response:[{type:"PropertyArray",name:"msgs",entity:"msg"}]},"8_5":{service:"team",cmd:"addTeamMembers",response:[{type:"Long",name:"time"},{type:"StrArray",name:"abortedAccidList"}]},"8_6":{service:"team",cmd:"removeTeamMembers"},"8_7":{service:"team",cmd:"updateTeam",response:[{type:"Long",name:"id"},{type:"Long",name:"time"}]},"8_8":{service:"team",cmd:"leaveTeam"},"8_9":{service:"team",cmd:"getTeam",response:[{type:"Property",name:"team"}]},"8_10":{service:"team",cmd:"getTeams",response:[{type:"PropertyArray",name:"teams",entity:"team"},{type:"Long",name:"timetag"}]},"8_11":{service:"team",cmd:"getTeamMembers",response:[{type:"Long",name:"teamId"},{type:"PropertyArray",name:"members",entity:"teamMember"},{type:"Long",name:"timetag"}]},"8_12":{service:"team",cmd:"dismissTeam"},"8_13":{service:"team",cmd:"applyTeam",response:[{type:"Property",name:"team"}]},"8_14":{service:"team",cmd:"passTeamApply"},"8_15":{service:"team",cmd:"rejectTeamApply"},"8_16":{service:"team",cmd:"addTeamManagers"},"8_17":{service:"team",cmd:"removeTeamManagers"},"8_18":{service:"team",cmd:"transferTeam"},"8_19":{service:"team",cmd:"updateInfoInTeam",response:[{type:"Property",name:"teamMember"}]},"8_20":{service:"team",cmd:"updateNickInTeam"},"8_21":{service:"team",cmd:"acceptTeamInvite",response:[{type:"Property",name:"team"}]},"8_22":{service:"team",cmd:"rejectTeamInvite"},"8_23":{service:"team",cmd:"getTeamHistoryMsgs",response:[{type:"PropertyArray",name:"msgs",entity:"msg"}]},"8_24":{service:"team",cmd:"searchTeamHistoryMsgs",response:[{type:"PropertyArray",name:"msgs",entity:"msg"}]},"8_25":{service:"team",cmd:"updateMuteStateInTeam"},"8_26":{service:"team",cmd:"getMyTeamMembers",response:[{type:"PropertyArray",name:"teamMembers",entity:"teamMember"}]},"8_27":{service:"team",cmd:"getMutedTeamMembers",response:[{type:"Long",name:"teamId"},{type:"PropertyArray",name:"teamMembers",entity:"teamMember"}]},"8_28":{service:"team",cmd:"sendTeamMsgReceipt",response:[{type:"PropertyArray",name:"teamMsgReceipts",entity:"teamMsgReceipt"}]},"8_29":{service:"team",cmd:"getTeamMsgReads",response:[{type:"PropertyArray",name:"teamMsgReceipts",entity:"teamMsgReceipt"}]},"8_30":{service:"team",cmd:"getTeamMsgReadAccounts",response:[{type:"Property",name:"teamMsgReceipt"},{type:"StrArray",name:"readAccounts"},{type:"StrArray",name:"unreadAccounts"}]},"8_31":{service:"team",cmd:"notifyTeamMsgReads",response:[{type:"PropertyArray",name:"teamMsgReceipts",entity:"teamMsgReceipt"}]},"8_32":{service:"team",cmd:"muteTeamAll",response:[]},"8_33":{service:"team",cmd:"getTeamMemberInvitorAccid",response:[{type:"StrStrMap",name:"accountsMap"}]},"8_34":{service:"team",cmd:"getTeamsById",response:[{type:"PropertyArray",name:"teams",entity:"team"},{type:"LongArray",name:"tids"}],trivialErrorCodes:[816]},"8_126":{service:"team",cmd:"syncMyTeamMembers",response:[{type:"PropertyArray",name:"teamMembers",entity:"teamMember"},{type:"Long",name:"timetag"}]},"8_109":{service:"team",cmd:"syncTeams",response:[{type:"Long",name:"timetag"},{type:"PropertyArray",name:"teams",entity:"team"}]},"8_111":{service:"team",cmd:"syncTeamMembers",response:[{type:"Long",name:"teamId"},{type:"PropertyArray",name:"members",entity:"teamMember"},{type:"Long",name:"timetag"}]},"8_101":{service:"team",cmd:"syncCreateTeam",response:[{type:"Property",name:"team"}]},"8_102":{service:"team",cmd:"syncSendTeamMsg",response:[{type:"Property",name:"msg"}]},"8_119":{service:"team",cmd:"syncUpdateTeamMember",response:[{type:"Property",name:"teamMember"}]},"12_1":{service:"friend",cmd:"friendRequest"},"12_101":{service:"friend",cmd:"syncFriendRequest",response:[{type:"String",name:"account"},{type:"Number",name:"type"},{type:"String",name:"ps"}]},"12_2":{service:"friend",cmd:"deleteFriend"},"12_102":{service:"friend",cmd:"syncDeleteFriend",response:[{type:"String",name:"account"}]},"12_3":{service:"friend",cmd:"updateFriend"},"12_103":{service:"friend",cmd:"syncUpdateFriend",response:[{type:"Property",name:"friend"}]},"12_4":{service:"friend",cmd:"getFriends",response:[{type:"PropertyArray",name:"friends",entity:"friend"},{type:"Long",name:"timetag"}]},"12_5":{service:"friend",cmd:"syncFriends",response:[{type:"PropertyArray",name:"friends",entity:"friend"},{type:"Long",name:"timetag"}]},"12_6":{service:"friend",cmd:"syncFriendUsers",response:[{type:"PropertyArray",name:"users",entity:"user"},{type:"Long",name:"timetag"}]},"13_1":{service:"chatroom",cmd:"getChatroomAddress",response:[{type:"StrArray",name:"address"}]},"14_1":{service:"eventService",cmd:"publishEvent",response:[{type:"Property",name:"msgEvent"}]},"14_2":{service:"eventService",cmd:"pushEvent",response:[{type:"Property",name:"msgEvent"}]},"14_3":{service:"eventService",cmd:"subscribeEvent",response:[{type:"StrArray",name:"accounts"}]},"14_4":{service:"eventService",cmd:"unSubscribeEventsByAccounts",response:[{type:"StrArray",name:"accounts"}]},"14_5":{service:"eventService",cmd:"unSubscribeEventsByType"},"14_6":{service:"eventService",cmd:"querySubscribeEventsByAccounts",response:[{type:"PropertyArray",name:"msgEventSubscribes",entity:"msgEventSubscribe"}]},"14_7":{service:"eventService",cmd:"querySubscribeEventsByType",response:[{type:"PropertyArray",name:"msgEventSubscribes",entity:"msgEventSubscribe"}]},"14_9":{service:"eventService",cmd:"pushEvents",response:[{type:"PropertyArray",name:"msgEvents",entity:"msgEvent"}]},"22_1":{service:"proxyService",cmd:"httpProxy",response:[{type:"Property",name:"proxyTag"}]},"22_2":{service:"proxyService",cmd:"onProxyMsg",response:[{type:"Property",name:"proxyMsg",entity:"proxyMsgTag"}]},"24_1":{service:"qchat",cmd:"getQChatAddress",response:[{type:"StrArray",name:"address"}]},"101_1":{service:"filter",cmd:"sendFilterMsg",response:[{type:"Property",name:"msg"}]},"101_2":{service:"filter",cmd:"filterMsg",response:[{type:"Property",name:"msg"}]},"101_3":{service:"filter",cmd:"filterSysMsg",response:[{type:"Property",name:"sysMsg"}]},"101_7":{service:"filter",cmd:"sendFilterCustomSysMsg"}});t.exports={idMap:i,cmdConfig:k,packetConfig:L}},function(t,r){t.exports={negotiateTransportTag:{version:-1,serializeList:1,serialize:101},initTransportTag:{},nosToken:{objectName:1,token:2,bucket:3,expireTime:4,expireSec:7,tag:8,shortUrl:9},uploadTaskTag:{sdklogUploadType:1,sdkLogUploadMsg:2},audioToText:{url:2},imageOp:{type:0,stripmeta:1,typeType:2,blurRadius:3,blurSigma:4,qualityQuality:5,cropX:6,cropY:7,cropWidth:8,cropHeight:9,rotateAngle:10,pixelPixel:11,thumbnailMode:12,thumbnailWidth:13,thumbnailHeight:14,thumbnailAxisX:15,thumbnailAxisY:16,thumbnailCenterX:17,thumbnailCenterY:18,thumbnailEnlarge:19,thumbnailToStatic:20,watermarkType:21,watermarkGravity:22,watermarkDissolve:23,watermarkDx:24,watermarkDy:25,watermarkImage:26,watermarkText:27,watermarkFont:28,watermarkFontSize:29,watermarkFontColor:30,interlace:31},robot:{account:4,nick:5,avatar:6,intro:7,config:8,valid:9,createTime:10,updateTime:11,custid:12,botid:13,bindTime:14},clientAntispam:{version:1,md5:2,nosurl:3,thesaurus:4},fileQuickTransfer:{md5:1,url:2,size:3,threshold:4},transToken:{name:1,type:2,transType:3,size:4,extra:5,body:6},transInfo:{docId:1,name:2,prefix:3,size:4,type:5,state:6,transType:7,transSize:8,pageCount:9,picInfo:10,extra:11,flag:12},nosFileUrlTag:{safeUrl:0,originUrl:1},nosAccessTokenTag:{token:0,url:1,userAgent:2,ext:3},fileListParam:{fromDocId:1,limit:2},avSignalTag:{type:1,channelName:2,channelId:3,channelCreateTime:4,channelExpireTime:5,creator:6,ext:7,channelInValid:8,from:10,to:11,requestId:12,needPush:13,pushTitle:14,pushContent:15,pushPayload:16,needBadge:17,members:18,attach:19,attachExt:20,isSave:21,msgid:22,uid:23,time:24,nertcChannelName:25,nertcTokenTtl:26,nertcToken:27,nertcJoinRoomQueryParamMap:28,nertcJoinRoomResponse:29,callStatus:30},login:{clientType:3,os:4,sdkVersion:6,appLogin:8,protocolVersion:9,pushTokenName:10,pushToken:11,deviceId:13,appKey:18,account:19,browser:24,session:26,deviceInfo:32,sdkType:41,userAgent:42,libEnv:44,isReactNative:112,token:1e3,customTag:38,customClientType:39,sdkHumanVersion:40,authType:115,loginExt:116},loginRes:{lastLoginDeviceId:17,customTag:38,connectionId:102,ip:103,port:104,country:106,hasXMPush:111},loginPort:{type:3,os:4,mac:5,deviceId:13,account:19,deviceInfo:32,connectionId:102,ip:103,time:109,customTag:38,customClientType:39},aosPushInfo:{pushType:110,hasTokenPreviously:111},sync:{myInfo:1,offlineMsgs:2,teams:3,netcallMsgs:6,roamingMsgs:7,relations:9,friends:11,sessions:12,friendUsers:13,msgReceipts:14,myTeamMembers:15,donnop:16,deleteMsg:17,sessionAck:18,robots:19,broadcastMsgs:20,avSignal:21,superTeams:22,myInfoInSuperTeams:23,superTeamRoamingMsgs:24,deleteSuperTeamMsg:25,superTeamSessionAck:26,deleteMsgSelf:27,stickTopSessions:28,sessionHistoryMsgsDelete:29,filterMsgs:100},donnop:{open:1},sessionReqTag:{minTimestamp:1,maxTimestamp:2,needLastMsg:3,limit:4,hasMore:5},session:{id:1,updateTime:2,ext:3,lastMsg:4},superTeam:{teamId:1,name:3,type:4,owner:5,level:6,selfCustom:7,valid:8,memberNum:9,memberUpdateTime:10,createTime:11,updateTime:12,validToCurrentUser:13,intro:14,announcement:15,joinMode:16,bits:17,custom:18,serverCustom:19,avatar:20,beInviteMode:21,inviteMode:22,updateTeamMode:23,updateCustomMode:24,mute:100,muteType:101},superTeamMember:{teamId:1,account:3,type:4,nickInTeam:5,bits:7,active:8,valid:9,createTime:10,updateTime:11,custom:12,mute:13,invitoraccid:14,joinTime:15,followAccountIds:17},SpecialFollowUpdateInfoTag:{accids:1,type:2},team:{teamId:1,name:3,type:4,owner:5,level:6,selfCustom:7,valid:8,memberNum:9,memberUpdateTime:10,createTime:11,updateTime:12,validToCurrentUser:13,intro:14,announcement:15,joinMode:16,bits:17,custom:18,serverCustom:19,avatar:20,beInviteMode:21,inviteMode:22,updateTeamMode:23,updateCustomMode:24,mute:100,muteType:101},teamMember:{teamId:1,account:3,type:4,nickInTeam:5,bits:7,active:8,valid:9,joinTime:10,updateTime:11,custom:12,mute:13,invitorAccid:14,followAccountIds:16},teamSpecialFollowUpdateTag:{accountIds:1,type:2},msg:{scene:0,to:1,from:2,fromClientType:4,fromDeviceId:5,fromNick:6,time:7,type:8,body:9,attach:10,idClient:11,idServer:12,resend:13,userUpdateTime:14,custom:15,pushPayload:16,pushContent:17,apnsAccounts:18,apnsContent:19,apnsForcePush:20,yidunEnable:21,antiSpamContent:22,antiSpamBusinessId:23,clientAntiSpam:24,antiSpamUsingYidun:25,needMsgReceipt:26,needUpdateSession:28,replyMsgFromAccount:29,replyMsgToAccount:30,replyMsgTime:31,replyMsgIdServer:32,replyMsgIdClient:33,threadMsgFromAccount:34,threadMsgToAccount:35,threadMsgTime:36,threadMsgIdServer:37,threadMsgIdClient:38,delete:39,callbackExt:40,subType:41,yidunAntiCheating:42,env:43,yidunAntiSpamExt:44,yidunAntiSpamRes:45,__clientExt:46,robotInfoFunction:47,robotInfoTopic:48,robotInfoCustomContent:49,robotInfoAccount:50,isHistoryable:100,isRoamingable:101,isSyncable:102,isMuted:104,cc:105,isInBlackList:106,isPushable:107,isOfflinable:108,isUnreadable:109,needPushNick:110,isReplyMsg:111,tempTeamMemberCount:112},threadMsgReq:{beginTime:1,endTime:2,lastMsgId:3,limit:4,reverse:5},threadMsgsMeta:{total:1,lastMsgTime:2},comment:{from:1,body:2,time:3,custom:4,needPush:5,needBadge:6,pushTitle:7,apnsText:8,pushPayload:9},commentReq:{scene:1,from:2,to:3,time:4,idServer:5,idClient:6,timestamp:100},commentRes:{scene:1,from:2,to:3,time:4,idServer:5,idClient:6,detail:7,modify:8,timestamp:100},collect:{id:1,type:2,data:3,custom:4,uniqueId:5,createTime:6,updateTime:7},collectQuery:{beginTime:1,endTime:2,lastMsgId:3,limit:4,reverse:5,type:6},stickTopSession:{id:1,topCustom:2,createTime:3,updateTime:4},pinTag:{pinFrom:1,pinCustom:2,createTime:3,updateTime:4},msgPinReq:{sessionId:1,timetag:2},msgPinRes:{scene:1,from:2,to:3,time:4,idServer:5,idClient:6,pinFrom:7,pinCustom:8},msgReceipt:{to:1,from:2,time:7,idClient:11},teamMsgReceipt:{teamId:0,idServer:1,read:100,unread:101,idClient:102,account:103},deleteMsgSelfTag:{scene:1,from:2,to:3,idServer:4,idClient:5,time:6,deletedTime:7,custom:8},sysMsg:{time:0,type:1,to:2,from:3,ps:4,attach:5,idServer:6,sendToOnlineUsersOnly:7,apnsText:8,pushPayload:9,deletedIdClient:10,deletedIdServer:11,yidunEnable:12,antiSpamContent:13,deletedMsgTime:14,deletedMsgFromNick:15,opeAccount:16,env:21,idClient:23,callbackExt:22,cc:105,isPushable:107,isUnreadable:109,needPushNick:110},broadcastMsg:{broadcastId:1,fromAccid:2,fromUid:3,timestamp:4,body:5},friend:{account:4,flag:5,beflag:6,source:7,alias:8,bits:9,custom:10,createTime:11,updateTime:12,serverex:13},user:{account:1,nick:3,avatar:4,sign:5,gender:6,email:7,birth:8,tel:9,custom:10,createTime:12,updateTime:13},antispamTag:{antiSpamBusinessId:1},specialRelation:{account:0,isMuted:1,isBlacked:2,createTime:3,updateTime:4},msgType:{text:0,picture:1,audio:2,video:3,location:4,notification:5,file:6,netcall_audio:7,netcall_vedio:8,datatunnel_new:9,tips:10,robot:11,custom:100},msgEvent:{type:1,value:2,idClient:3,custom:4,validTime:5,broadcastType:6,sync:7,validTimeType:8,durable:9,time:10,idServer:11,clientType:12,serverConfig:13,serverCustom:14,appid:101,account:103,enableMultiClient:104,consid:106},msgEventSubscribe:{type:1,subscribeTime:2,sync:3,to:102,from:104,time:105},clearMsgsParams:{account:1,delRoam:2},clearMsgsParamsWithSync:{type:0,otherAccid:1,isDeleteRoam:2,toTid:3,isSyncSelf:4,fromAccid:5,time:6,ext:7},msgFullSearchRequestTag:{keyword:1,fromTime:2,toTime:3,sessionLimit:4,msgLimit:5,order:6,p2pList:7,teamList:8,senderList:9,msgTypeList:10,msgSubTypeList:11},msgTimingFullSearchRequestTag:{keyword:1,fromTime:2,toTime:3,msgLimit:5,order:6,p2pList:7,teamList:8,senderList:9,msgTypeList:10,msgSubTypeList:11},delFriendParams:{delAlias:1},proxyTag:{zone:1,path:2,method:3,header:4,body:5},proxyMsgTag:{from:1,body:2,time:3},sessionAckTag:{scene:1,to:2,timetag:3},mixTokenReq:{provider:0,tokenCount:1,fileExpireSec:2,tag:3,returnBody:4,policyVersion:5},mixAuthTokenReq:{type:1,urls:2},notifyDetectTag:{type:1,params:2,result:3,t1:100,t2:101,t3:102,t4:103,t5:104,t6:105},getQChatAddressTag:{ipType:1}}},function(t,r){t.exports={negotiateTransportTag:{"-1":"version",1:"serializeList",101:"serialize"},initTransportTag:{},nosToken:{1:"objectName",2:"token",3:"bucket",4:"expireTime",7:"expireSec",8:"tag",9:"shortUrl"},audioToText:{2:"url"},imageOp:{0:"type",1:"stripmeta",2:"typeType",3:"blurRadius",4:"blurSigma",5:"qualityQuality",6:"cropX",7:"cropY",8:"cropWidth",9:"cropHeight",10:"rotateAngle",11:"pixelPixel",12:"thumbnailMode",13:"thumbnailWidth",14:"thumbnailHeight",15:"thumbnailAxisX",16:"thumbnailAxisY",17:"thumbnailCenterX",18:"thumbnailCenterY",19:"thumbnailEnlarge",20:"thumbnailToStatic",21:"watermarkType",22:"watermarkGravity",23:"watermarkDissolve",24:"watermarkDx",25:"watermarkDy",26:"watermarkImage",27:"watermarkText",28:"watermarkFont",29:"watermarkFontSize",30:"watermarkFontColor",31:"interlace"},robot:{4:"account",5:"nick",6:"avatar",7:"intro",8:"config",9:"valid",10:"createTime",11:"updateTime",12:"custid",13:"botid",14:"bindTime",_6_safe:"_avatar_safe"},clientAntispam:{1:"version",2:"md5",3:"nosurl",4:"thesaurus"},fileQuickTransfer:{1:"md5",2:"url",3:"size",4:"threshold",_2_safe:"_url_safe"},transToken:{1:"name",2:"type",3:"transType",4:"size",5:"extra",6:"body"},transInfo:{1:"docId",2:"name",3:"prefix",4:"size",5:"type",6:"state",7:"transType",8:"transSize",9:"pageCount",10:"picInfo",11:"extra",12:"flag"},nosFileUrlTag:{0:"safeUrl",1:"originUrl"},nosAccessTokenTag:{0:"token",1:"url",2:"userAgent",3:"ext"},nosConfigTag:{1:"bucket",2:"cdnDomain",3:"expire",4:"objectNamePrefix"},appGrayConfigTag:{0:"grayConfig",1:"ttl"},mixStorePolicyTag:{0:"providers",1:"ttl",2:"mixEnable",3:"nosPolicy",4:"s3Policy",5:"policyVersion"},mixStoreTokenTag:{0:"provider",1:"accessKeyId",2:"secretAccessKey",3:"sessionToken",4:"token",5:"expireAt",6:"bucket",7:"objectName",8:"fileExpireSec",9:"tag",10:"shortUrl",11:"region"},notifyDetectTag:{1:"type",2:"params",3:"result",100:"t1",101:"t2",102:"t3",103:"t4",104:"t5",105:"t6"},backSourceTokenTag:{1:"type",2:"tokens",3:"token",4:"ttl"},fileListParam:{1:"fromDocId",2:"limit"},avSignalTag:{1:"type",2:"channelName",3:"channelId",4:"channelCreateTime",5:"channelExpireTime",6:"creator",7:"ext",8:"channelInValid",10:"from",11:"to",12:"requestId",13:"needPush",14:"pushTitle",15:"pushContent",16:"pushPayload",17:"needBadge",18:"members",19:"attach",20:"attachExt",21:"isSave",22:"msgid",23:"uid",24:"time",25:"nertcChannelName",26:"nertcTokenTtl",27:"nertcToken",28:"nertcJoinRoomQueryParamMap",29:"nertcJoinRoomResponse",30:"callStatus"},login:{3:"clientType",4:"os",6:"sdkVersion",8:"appLogin",9:"protocolVersion",10:"pushTokenName",11:"pushToken",13:"deviceId",18:"appKey",19:"account",24:"browser",26:"session",32:"deviceInfo",38:"customTag",39:"customClientType",40:"sdkHumanVersion",112:"isReactNative",115:"authType",116:"loginExt",1e3:"token"},loginRes:{17:"lastLoginDeviceId",38:"customTag",102:"connectionId",103:"ip",104:"port",106:"country",111:"hasXMPush"},loginPort:{3:"type",4:"os",5:"mac",13:"deviceId",19:"account",32:"deviceInfo",38:"customTag",39:"customClientType",102:"connectionId",103:"ip",109:"time"},aosPushInfo:{110:"pushType",111:"hasTokenPreviously"},sync:{1:"myInfo",2:"offlineMsgs",3:"teams",6:"netcallMsgs",7:"roamingMsgs",9:"relations",11:"friends",12:"sessions",13:"friendUsers",14:"msgReceipts",15:"myTeamMembers",16:"donnop",17:"deleteMsg",18:"sessionAck",19:"robots",20:"broadcastMsgs",21:"avSignal",22:"superTeams",23:"myInfoInSuperTeams",24:"superTeamRoamingMsgs",25:"deleteSuperTeamMsg",26:"superTeamSessionAck",27:"deleteMsgSelf",28:"stickTopSessions",29:"sessionHistoryMsgsDelete",100:"filterMsgs"},donnop:{1:"open"},sessionReqTag:{1:"minTimestamp",2:"maxTimestamp",3:"needLastMsg",4:"limit",5:"hasMore"},session:{1:"id",2:"updateTime",3:"ext",4:"lastMsg",5:"lastMsgType"},superTeam:{1:"teamId",3:"name",4:"type",5:"owner",6:"level",7:"selfCustom",8:"valid",9:"memberNum",10:"memberUpdateTime",11:"createTime",12:"updateTime",13:"validToCurrentUser",14:"intro",15:"announcement",16:"joinMode",17:"bits",18:"custom",19:"serverCustom",20:"avatar",21:"beInviteMode",22:"inviteMode",23:"updateTeamMode",24:"updateCustomMode",100:"mute",101:"muteType",_20_safe:"_avatar_safe"},superTeamMember:{1:"teamId",3:"account",4:"type",5:"nickInTeam",7:"bits",8:"active",9:"valid",10:"createTime",11:"updateTime",12:"custom",13:"mute",14:"invitoraccid",15:"joinTime",17:"followAccountIds"},team:{1:"teamId",3:"name",4:"type",5:"owner",6:"level",7:"selfCustom",8:"valid",9:"memberNum",10:"memberUpdateTime",11:"createTime",12:"updateTime",13:"validToCurrentUser",14:"intro",15:"announcement",16:"joinMode",17:"bits",18:"custom",19:"serverCustom",20:"avatar",21:"beInviteMode",22:"inviteMode",23:"updateTeamMode",24:"updateCustomMode",100:"mute",101:"muteType",_20_safe:"_avatar_safe"},teamMember:{1:"teamId",3:"account",4:"type",5:"nickInTeam",7:"bits",8:"active",9:"valid",10:"joinTime",11:"updateTime",12:"custom",13:"mute",14:"invitorAccid",16:"followAccountIds"},msg:{0:"scene",1:"to",2:"from",4:"fromClientType",5:"fromDeviceId",6:"fromNick",7:"time",8:"type",9:"body",10:"attach",11:"idClient",12:"idServer",13:"resend",14:"userUpdateTime",15:"custom",16:"pushPayload",17:"pushContent",18:"apnsAccounts",19:"apnsContent",20:"apnsForcePush",21:"yidunEnable",22:"antiSpamContent",23:"antiSpamBusinessId",24:"clientAntiSpam",25:"antiSpamUsingYidun",26:"needMsgReceipt",28:"needUpdateSession",29:"replyMsgFromAccount",30:"replyMsgToAccount",31:"replyMsgTime",32:"replyMsgIdServer",33:"replyMsgIdClient",34:"threadMsgFromAccount",35:"threadMsgToAccount",36:"threadMsgTime",37:"threadMsgIdServer",38:"threadMsgIdClient",39:"delete",40:"callbackExt",41:"subType",42:"yidunAntiCheating",43:"env",44:"yidunAntiSpamExt",45:"yidunAntiSpamRes",46:"__clientExt",47:"robotInfoFunction",48:"robotInfoTopic",49:"robotInfoCustomContent",50:"robotInfoAccount",100:"isHistoryable",101:"isRoamingable",102:"isSyncable",104:"isMuted",105:"cc",106:"isInBlackList",107:"isPushable",108:"isOfflinable",109:"isUnreadable",110:"needPushNick",111:"isReplyMsg",112:"tempTeamMemberCount"},threadMsgReq:{1:"beginTime",2:"endTime",3:"lastMsgId",4:"limit",5:"reverse"},threadMsgsMeta:{1:"total",2:"lastMsgTime"},comment:{1:"from",2:"body",3:"time",4:"custom",5:"needPush",6:"needBadge",7:"pushTitle",8:"apnsText",9:"pushPayload"},commentReq:{1:"scene",2:"from",3:"to",4:"time",5:"idServer",6:"idClient",100:"timestamp"},commentRes:{1:"scene",2:"from",3:"to",4:"time",5:"idServer",6:"idClient",7:"detail",8:"modify",100:"timestamp"},collect:{1:"id",2:"type",3:"data",4:"custom",5:"uniqueId",6:"createTime",7:"updateTime"},collectQuery:{1:"beginTime",2:"endTime",3:"lastMsgId",4:"limit",5:"reverse",6:"type"},stickTopSession:{1:"id",2:"topCustom",3:"createTime",4:"updateTime"},pinTag:{1:"pinFrom",2:"pinCustom",3:"createTime",4:"updateTime"},msgPinReq:{1:"sessionId",2:"timetag"},msgPinRes:{1:"scene",2:"from",3:"to",4:"time",5:"idServer",6:"idClient",7:"pinFrom",8:"pinCustom"},msgReceipt:{1:"to",2:"from",7:"time",11:"idClient"},teamMsgReceipt:{0:"teamId",1:"idServer",100:"read",101:"unread",102:"idClient",103:"account"},deleteMsgSelfTag:{1:"scene",2:"from",3:"to",4:"idServer",5:"idClient",6:"time",7:"deletedTime",8:"custom"},sysMsg:{0:"time",1:"type",2:"to",3:"from",4:"ps",5:"attach",6:"idServer",7:"sendToOnlineUsersOnly",8:"apnsText",9:"pushPayload",10:"deletedIdClient",11:"deletedIdServer",12:"yidunEnable",13:"antiSpamContent",14:"deletedMsgTime",15:"deletedMsgFromNick",16:"opeAccount",21:"env",22:"callbackExt",23:"idClient",105:"cc",107:"isPushable",109:"isUnreadable",110:"needPushNick"},broadcastMsg:{1:"broadcastId",2:"fromAccid",3:"fromUid",4:"timestamp",5:"body"},friend:{4:"account",5:"flag",6:"beflag",7:"source",8:"alias",9:"bits",10:"custom",11:"createTime",12:"updateTime",13:"serverex"},user:{1:"account",3:"nick",4:"avatar",5:"sign",6:"gender",7:"email",8:"birth",9:"tel",10:"custom",12:"createTime",13:"updateTime",_4_safe:"_avatar_safe"},antispamTag:{antiSpamBusinessId:1},specialRelation:{0:"account",1:"isMuted",2:"isBlacked",3:"createTime",4:"updateTime"},msgType:{0:"text",1:"picture",2:"audio",3:"video",4:"location",5:"notification",6:"file",7:"netcall_audio",8:"netcall_vedio",9:"datatunnel_new",10:"tips",11:"robot",100:"custom"},msgEvent:{1:"type",2:"value",3:"idClient",4:"custom",5:"validTime",6:"broadcastType",7:"sync",8:"validTimeType",9:"durable",10:"time",11:"idServer",12:"clientType",13:"serverConfig",14:"serverCustom",101:"appid",103:"account",104:"enableMultiClient",106:"consid"},msgEventSubscribe:{1:"type",2:"subscribeTime",3:"sync",102:"to",104:"from",105:"time"},clearMsgsParams:{1:"account",2:"delRoam"},clearMsgsParamsWithSync:{0:"type",1:"otherAccid",2:"delRoam",3:"toTid",4:"isSyncSelf",5:"fromAccid",6:"time",7:"ext"},msgFullSearchRequestTag:{1:"keyword",2:"fromTime",3:"toTime",4:"sessionLimit",5:"msgLimit",6:"order",7:"p2pList",8:"teamList",9:"senderList",10:"msgTypeList",11:"msgSubTypeList"},delFriendParams:{1:"delAlias"},proxyTag:{1:"zone",2:"path",3:"method",4:"header",5:"body"},proxyMsgTag:{1:"from",2:"body",3:"time"},sessionReliableSyncTag:{1:"scene",2:"sessionId",3:"syncStatus",4:"syncEndMsgId",5:"syncEndMsgidClient",6:"syncEndMsgTime",7:"syncStartMsgid",8:"syncStartMsgidClient",9:"syncStartMsgTime",10:"nextMsgid",11:"nextMsgidClient",12:"nextMsgTime",13:"roamMsgSync",14:"offlineMsgSync",15:"netCallOfflineMsgSync"},sessionReliableSyncContextTag:{1:"timetag",2:"type"}}},function(t,r,e){var n=e(34),g=e(0),y=e(155),i=e(155),k=i.CMD_TYPE_PROPERTY,L=i.CMD_TYPE_BYTE,$=i.CMD_TYPE_INT,V=i.CMD_TYPE_BOOL,z=i.CMD_TYPE_LONG,re=i.CMD_TYPE_STRING,oe=i.CMD_TYPE_STR_STR_MAP,le=i.CMD_TYPE_STR_ARRAY,ue=i.CMD_TYPE_LONG_ARRAY,ie=i.CMD_TYPE_PROPERTY_ARRAY,ae=i.CMD_TYPE_KV_ARRAY,Ie=n({},y.idMap,{chatroom:{id:13,login:2,kicked:3,logout:4,sendMsg:6,msg:7,getChatroomMembers:8,getHistoryMsgs:9,markChatroomMember:11,closeChatroom:12,getChatroom:13,updateChatroom:14,updateMyChatroomMemberInfo:15,getChatroomMembersInfo:16,kickChatroomMember:17,updateChatroomMemberTempMute:19,queueOffer:20,queuePoll:21,queueList:22,peak:23,queueDrop:24,queueInit:25,queueChange:26,updateTagMembersTempMute:30,getChatroomMembersByTag:31,getChatroomMemberCountByTag:32,updateCoordinate:33,updateChatroomTags:34,sendChatroomMsgAck:35,getHistoryMsgsByTags:36,notifyCdnInfo:99},user:{id:3,syncRobot:16}}),de=g.merge({},y.cmdConfig,{login:{sid:Ie.chatroom.id,cid:Ie.chatroom.login,params:[{type:L,name:"type"},{type:k,name:"login"},{type:k,name:"imLogin"}]},logout:{sid:Ie.chatroom.id,cid:Ie.chatroom.logout},sendMsg:{sid:Ie.chatroom.id,cid:Ie.chatroom.sendMsg,params:[{type:k,name:"msg"}]},getChatroomMembers:{sid:Ie.chatroom.id,cid:Ie.chatroom.getChatroomMembers,params:[{type:L,name:"type"},{type:z,name:"time"},{type:$,name:"limit"}]},getHistoryMsgs:{sid:Ie.chatroom.id,cid:Ie.chatroom.getHistoryMsgs,params:[{type:z,name:"timetag"},{type:$,name:"limit"},{type:V,name:"reverse"},{type:ue,name:"msgTypes"}]},markChatroomMember:{sid:Ie.chatroom.id,cid:Ie.chatroom.markChatroomMember,params:[{type:re,name:"account"},{type:$,name:"type"},{type:V,name:"isAdd"},{type:$,name:"level"},{type:re,name:"custom"}]},closeChatroom:{sid:Ie.chatroom.id,cid:Ie.chatroom.closeChatroom,params:[{type:re,name:"custom"}]},getChatroom:{sid:Ie.chatroom.id,cid:Ie.chatroom.getChatroom},updateChatroom:{sid:Ie.chatroom.id,cid:Ie.chatroom.updateChatroom,params:[{type:k,name:"chatroom"},{type:V,name:"needNotify"},{type:re,name:"custom"},{type:k,name:"antispamTag"}]},updateMyChatroomMemberInfo:{sid:Ie.chatroom.id,cid:Ie.chatroom.updateMyChatroomMemberInfo,params:[{type:k,name:"chatroomMember"},{type:V,name:"needNotify"},{type:re,name:"custom"},{type:V,name:"needSave"},{type:k,name:"antispamTag"}]},getChatroomMembersInfo:{sid:Ie.chatroom.id,cid:Ie.chatroom.getChatroomMembersInfo,params:[{type:le,name:"accounts"}]},kickChatroomMember:{sid:Ie.chatroom.id,cid:Ie.chatroom.kickChatroomMember,params:[{type:re,name:"account"},{type:re,name:"custom"}]},updateChatroomMemberTempMute:{sid:Ie.chatroom.id,cid:Ie.chatroom.updateChatroomMemberTempMute,params:[{type:re,name:"account"},{type:z,name:"duration"},{type:V,name:"needNotify"},{type:re,name:"custom"}]},queueOffer:{sid:Ie.chatroom.id,cid:Ie.chatroom.queueOffer,params:[{type:re,name:"elementKey"},{type:re,name:"elementValue"},{type:V,name:"transient"},{type:re,name:"elementAccount"}]},queuePoll:{sid:Ie.chatroom.id,cid:Ie.chatroom.queuePoll,params:[{type:re,name:"elementKey"}]},queueList:{sid:Ie.chatroom.id,cid:Ie.chatroom.queueList},peak:{sid:Ie.chatroom.id,cid:Ie.chatroom.peak},queueDrop:{sid:Ie.chatroom.id,cid:Ie.chatroom.queueDrop},queueInit:{sid:Ie.chatroom.id,cid:Ie.chatroom.queueInit,params:[{type:$,name:"limit"}]},queueChange:{sid:Ie.chatroom.id,cid:Ie.chatroom.queueChange,params:[{type:oe,name:"elementMap"},{type:V,name:"needNotify"},{type:re,name:"notifyExt"}]},updateTagMembersTempMute:{sid:Ie.chatroom.id,cid:Ie.chatroom.updateTagMembersTempMute,params:[{type:k,name:"tagMuteReq"}]},updateCoordinate:{sid:Ie.chatroom.id,cid:Ie.chatroom.updateCoordinate,params:[{type:k,name:"coordinateReq"}]},getChatroomMemberCountByTag:{sid:Ie.chatroom.id,cid:Ie.chatroom.getChatroomMemberCountByTag,params:[{type:re,name:"tag"}]},getChatroomMembersByTag:{sid:Ie.chatroom.id,cid:Ie.chatroom.getChatroomMembersByTag,params:[{type:k,name:"tagMemberReq"}]},updateChatroomTags:{sid:Ie.chatroom.id,cid:Ie.chatroom.updateChatroomTags,params:[{type:k,name:"chatRoomTagsUpdateTag"}]},sendChatroomMsgAck:{sid:Ie.chatroom.id,cid:Ie.chatroom.sendChatroomMsgAck,params:[{type:k,name:"chatRoomMsgAckTag"}]},getHistoryMsgsByTags:{sid:Ie.chatroom.id,cid:Ie.chatroom.getHistoryMsgsByTags,params:[{type:k,name:"chatRoomTagHistoryMsgRequestTag"}]},notifyCdnInfo:{sid:Ie.chatroom.id,cid:Ie.chatroom.notifyCdnInfo},syncRobot:{sid:Ie.user.id,cid:Ie.user.syncRobot,params:[{type:z,name:"timetag"}]}}),Ce=g.merge({},y.packetConfig,{"4_10":{service:"notify"},"4_11":{service:"notify"},"3_16":{service:"chatroom",cmd:"syncRobot",response:[{type:ie,name:"robots",entity:"robot"}]},"13_2":{service:"chatroom",cmd:"login",response:[{type:k,name:"chatroom"},{type:k,name:"chatroomMember"},{type:k,name:"chatroomCdnInfo"}]},"13_3":{service:"chatroom",cmd:"kicked",response:[{type:$,name:"reason"},{type:re,name:"custom"}]},"13_4":{service:"chatroom",cmd:"logout"},"13_6":{service:"chatroom",cmd:"sendMsg",response:[{type:k,name:"msg"}]},"13_7":{service:"chatroom",cmd:"msg",response:[{type:k,name:"msg"}]},"13_8":{service:"chatroom",cmd:"getChatroomMembers",response:[{type:ie,name:"members",entity:"chatroomMember"}]},"13_9":{service:"chatroom",cmd:"getHistoryMsgs",response:[{type:ie,name:"msgs",entity:"msg"}]},"13_11":{service:"chatroom",cmd:"markChatroomMember",response:[{type:k,name:"chatroomMember"}]},"13_12":{service:"chatroom",cmd:"closeChatroom"},"13_13":{service:"chatroom",cmd:"getChatroom",response:[{type:k,name:"chatroom"}]},"13_14":{service:"chatroom",cmd:"updateChatroom"},"13_15":{service:"chatroom",cmd:"updateMyChatroomMemberInfo"},"13_16":{service:"chatroom",cmd:"getChatroomMembersInfo",response:[{type:ie,name:"members",entity:"chatroomMember"}]},"13_17":{service:"chatroom",cmd:"kickChatroomMember"},"13_19":{service:"chatroom",cmd:"updateChatroomMemberTempMute",response:[{type:z,name:"time"}]},"13_20":{service:"chatroom",cmd:"queueOffer"},"13_21":{service:"chatroom",cmd:"queuePoll",response:[{type:re,name:"elementKey"},{type:re,name:"elementValue"}]},"13_22":{service:"chatroom",cmd:"queueList",response:[{type:ae,name:"queueList"}]},"13_23":{service:"chatroom",cmd:"peak",response:[{type:re,name:"elementKey"},{type:re,name:"elementValue"}]},"13_24":{service:"chatroom",cmd:"queueDrop"},"13_25":{service:"chatroom",cmd:"queueInit"},"13_26":{service:"chatroom",cmd:"queueChange",response:[{type:le,name:"elementKeyArray"}]},"13_30":{service:"chatroom",cmd:"updateTagMembersTempMute",response:[{type:z,name:"time"}]},"13_33":{service:"chatroom",cmd:"updateCoordinate"},"13_31":{service:"chatroom",cmd:"getChatroomMembersByTag",response:[{type:ie,name:"members",entity:"chatroomMember"}]},"13_32":{service:"chatroom",cmd:"getChatroomMemberCountByTag",response:[{type:z,name:"count"}]},"13_34":{service:"chatroom",cmd:"updateChatroomTags"},"13_36":{service:"chatroom",cmd:"getHistoryMsgsByTags",response:[{type:ie,name:"msgs",entity:"msg"}]},"13_99":{service:"chatroom",cmd:"notifyCdnInfo",response:[{type:k,name:"chatroomCdnInfo"}]},"13_101":{service:"chatroom",cmd:"updateChatroomTag",response:[{type:k,name:"updateTags"}]}});t.exports={idMap:Ie,cmdConfig:de,packetConfig:Ce}},function(t,r){t.exports={imLogin:{clientType:3,os:4,sdkVersion:6,appLogin:8,protocolVersion:9,pushTokenName:10,pushToken:11,deviceId:13,appKey:18,account:19,browser:24,session:26,deviceInfo:32,sdkType:41,userAgent:42,libEnv:44,isReactNative:112,authType:115,loginExt:116,token:1e3,customTag:38},nosToken:{objectName:1,token:2,bucket:3,expireTime:4,expireSec:7,tag:8,shortUrl:9},audioToText:{url:2},imageOp:{type:0,stripmeta:1,typeType:2,blurRadius:3,blurSigma:4,qualityQuality:5,cropX:6,cropY:7,cropWidth:8,cropHeight:9,rotateAngle:10,pixelPixel:11,thumbnailMode:12,thumbnailWidth:13,thumbnailHeight:14,thumbnailAxisX:15,thumbnailAxisY:16,thumbnailCenterX:17,thumbnailCenterY:18,thumbnailEnlarge:19,thumbnailToStatic:20,watermarkType:21,watermarkGravity:22,watermarkDissolve:23,watermarkDx:24,watermarkDy:25,watermarkImage:26,watermarkText:27,watermarkFont:28,watermarkFontSize:29,watermarkFontColor:30,interlace:31},robot:{account:4,nick:5,avatar:6,intro:7,config:8,valid:9,createTime:10,updateTime:11,custid:12,botid:13,bindTime:14},clientAntispam:{version:1,md5:2,nosurl:3,thesaurus:4},fileQuickTransfer:{md5:1,url:2,size:3,threshold:4},transToken:{name:1,type:2,transType:3,size:4,extra:5,body:6},transInfo:{docId:1,name:2,prefix:3,size:4,type:5,state:6,transType:7,transSize:8,pageCount:9,picInfo:10,extra:11,flag:12},nosFileUrlTag:{safeUrl:0,originUrl:1},nosAccessTokenTag:{token:0,url:1,userAgent:2,ext:3},fileListParam:{fromDocId:1,limit:2},avSignalTag:{type:1,channelName:2,channelId:3,channelCreateTime:4,channelExpireTime:5,creator:6,ext:7,channelInValid:8,from:10,to:11,requestId:12,needPush:13,pushTitle:14,pushContent:15,pushPayload:16,needBadge:17,members:18,attach:19,attachExt:20,isSave:21,msgid:22,uid:23,time:24,nertcChannelName:25,nertcTokenTtl:26,nertcToken:27,nertcJoinRoomQueryParamMap:28,nertcJoinRoomResponse:29,callStatus:30},login:{appKey:1,account:2,deviceId:3,chatroomId:5,appLogin:8,chatroomNick:20,chatroomAvatar:21,chatroomCustom:22,chatroomEnterCustom:23,session:26,isAnonymous:38,tags:39,notifyTargetTags:40,loginAuthType:41,loginExt:42,loc_x:43,loc_y:44,loc_z:45,distance:46,antiSpamBusinessId:47},chatroom:{id:1,name:3,announcement:4,broadcastUrl:5,custom:12,createTime:14,updateTime:15,queuelevel:16,creator:100,onlineMemberNum:101,mute:102},msg:{idClient:1,type:2,attach:3,custom:4,resend:5,userUpdateTime:6,fromNick:7,fromAvatar:8,fromCustom:9,yidunEnable:10,antiSpamContent:11,skipHistory:12,body:13,antiSpamBusinessId:14,clientAntiSpam:15,antiSpamUsingYidun:16,time:20,from:21,chatroomId:22,fromClientType:23,highPriority:25,callbackExt:27,subType:28,yidunAntiCheating:29,env:30,notifyTargetTags:31,yidunAntiSpamExt:32,yidunAntiSpamRes:33,loc_x:34,loc_y:35,loc_z:36,toAccids:37,needHighPriorityMsgAck:38,__clientExt:39},chatroomMember:{chatroomId:1,account:2,type:3,level:4,nick:5,avatar:6,custom:7,online:8,guest:9,enterTime:10,blacked:12,gaged:13,valid:14,updateTime:15,tempMuted:16,tempMuteDuration:17},antispamTag:{antiSpamBusinessId:1},chatroomCdnInfo:{enable:1,cdnUrls:2,timestamp:3,interval:4,decryptType:5,decryptKey:6,timeout:7},tagMemberReq:{tag:1,time:2,limit:3},tagMuteReq:{tag:1,duration:2,needNotify:3,custom:4,notifyTargetTags:5},coordinateReq:{x:1,y:2,z:3,distance:4},chatRoomTagsUpdateTag:{tags:1,notifyTargetTags:2,needNotify:3,ext:4},chatRoomMsgAckTag:{idClient:1,chatroomId:2},chatRoomTagHistoryMsgRequestTag:{tags:1,types:2,fromTime:3,toTime:4,limit:5,reverse:6}}},function(t,r){t.exports={imLogin:{3:"clientType",4:"os",6:"sdkVersion",8:"appLogin",9:"protocolVersion",10:"pushTokenName",11:"pushToken",13:"deviceId",18:"appKey",19:"account",24:"browser",26:"session",32:"deviceInfo",38:"customTag",41:"sdkType",42:"userAgent",44:"libEnv",112:"isReactNative",1e3:"token"},nosToken:{1:"objectName",2:"token",3:"bucket",4:"expireTime",7:"expireSec",8:"tag",9:"shortUrl"},audioToText:{2:"url"},imageOp:{0:"type",1:"stripmeta",2:"typeType",3:"blurRadius",4:"blurSigma",5:"qualityQuality",6:"cropX",7:"cropY",8:"cropWidth",9:"cropHeight",10:"rotateAngle",11:"pixelPixel",12:"thumbnailMode",13:"thumbnailWidth",14:"thumbnailHeight",15:"thumbnailAxisX",16:"thumbnailAxisY",17:"thumbnailCenterX",18:"thumbnailCenterY",19:"thumbnailEnlarge",20:"thumbnailToStatic",21:"watermarkType",22:"watermarkGravity",23:"watermarkDissolve",24:"watermarkDx",25:"watermarkDy",26:"watermarkImage",27:"watermarkText",28:"watermarkFont",29:"watermarkFontSize",30:"watermarkFontColor",31:"interlace"},robot:{4:"account",5:"nick",6:"avatar",7:"intro",8:"config",9:"valid",10:"createTime",11:"updateTime",12:"custid",13:"botid",14:"bindTime",_6_safe:"_avatar_safe"},clientAntispam:{1:"version",2:"md5",3:"nosurl",4:"thesaurus"},fileQuickTransfer:{1:"md5",2:"url",3:"size",4:"threshold",_2_safe:"_url_safe"},transToken:{1:"name",2:"type",3:"transType",4:"size",5:"extra",6:"body"},transInfo:{1:"docId",2:"name",3:"prefix",4:"size",5:"type",6:"state",7:"transType",8:"transSize",9:"pageCount",10:"picInfo",11:"extra",12:"flag"},nosFileUrlTag:{0:"safeUrl",1:"originUrl"},nosAccessTokenTag:{0:"token",1:"url",2:"userAgent",3:"ext"},fileListParam:{1:"fromDocId",2:"limit"},avSignalTag:{1:"type",2:"channelName",3:"channelId",4:"channelCreateTime",5:"channelExpireTime",6:"creator",7:"ext",8:"channelInValid",10:"from",11:"to",12:"requestId",13:"needPush",14:"pushTitle",15:"pushContent",16:"pushPayload",17:"needBadge",18:"members",19:"attach",20:"attachExt",21:"isSave",22:"msgid",23:"uid",24:"time",25:"nertcChannelName",26:"nertcTokenTtl",27:"nertcToken",28:"nertcJoinRoomQueryParamMap",29:"nertcJoinRoomResponse",30:"callStatus"},login:{1:"appKey",2:"account",3:"deviceId",5:"chatroomId",8:"appLogin",20:"chatroomNick",21:"chatroomAvatar",22:"chatroomCustom",23:"chatroomEnterCustom",26:"session",38:"isAnonymous",39:"tags",40:"notifyTargetTags",41:"loginAuthType",42:"loginExt",43:"loc_x",44:"loc_y",45:"loc_z",46:"distance",47:"antiSpamBusinessId",_21_safe:"_chatroomAvatar_safe"},chatroom:{1:"id",3:"name",4:"announcement",5:"broadcastUrl",12:"custom",14:"createTime",15:"updateTime",16:"queuelevel",100:"creator",101:"onlineMemberNum",102:"mute"},msg:{1:"idClient",2:"type",3:"attach",4:"custom",5:"resend",6:"userUpdateTime",7:"fromNick",8:"fromAvatar",9:"fromCustom",10:"yidunEnable",11:"antiSpamContent",12:"skipHistory",13:"body",14:"antiSpamBusinessId",15:"clientAntiSpam",16:"antiSpamUsingYidun",20:"time",21:"from",22:"chatroomId",23:"fromClientType",25:"highPriority",27:"callbackExt",28:"subType",29:"yidunAntiCheating",30:"env",31:"notifyTargetTags",32:"yidunAntiSpamExt",33:"yidunAntiSpamRes",34:"loc_x",35:"loc_y",36:"loc_z",37:"toAccids",38:"needHighPriorityMsgAck",39:"__clientExt",_8_safe:"_fromAvatar_safe"},chatroomMember:{1:"chatroomId",2:"account",3:"type",4:"level",5:"nick",6:"avatar",7:"custom",8:"online",9:"guest",10:"enterTime",11:"connectionId",12:"blacked",13:"gaged",14:"valid",15:"updateTime",16:"tempMuted",17:"tempMuteDuration",_6_safe:"_avatar_safe"},antispamTag:{antiSpamBusinessId:1},chatroomCdnInfo:{1:"enable",2:"cdnUrls",3:"timestamp",4:"interval",5:"decryptType",6:"decryptKey",7:"timeout"},nosConfigTag:{1:"bucket",2:"cdnDomain",3:"expire",4:"objectNamePrefix"},updateTags:{1:"currentTags"}}},function(t,r,e){t.exports=e(820)},function(t,r,e){t.exports=e(829)},function(t,r,e){var n=e(5),g=e(34),y=e(0),i=y.notundef,k={addFriend:1,applyFriend:2,passFriendApply:3,rejectFriendApply:4},L={1:"addFriend",2:"applyFriend",3:"passFriendApply",4:"rejectFriendApply"};function $(V){y.verifyOptions(V,"account","friend::Friend"),y.verifyParamAtLeastPresentOne(V,"alias custom","friend::Friend"),this.account=V.account,i(V.alias)&&(this.alias=V.alias),i(V.custom)&&(this.custom=V.custom)}$.reverse=function(V){var z=y.filterObj(V,"account alias custom createTime updateTime serverex");return i(V.flag)&&(z.valid=V.flag==="1"),i(z.createTime)&&(z.createTime=+z.createTime),i(z.updateTime)&&(z.updateTime=+z.updateTime),z},$.validTypes=function(){return n(k)},$.getByteFromType=function(V){return k[V]},$.getTypeFromByte=function(V){return L[V]},$.assembleFriend=function(V){var z=+new Date;return g({},V,{alias:"",createTime:z,custom:"",updateTime:z,valid:!0})},t.exports=$},function(t,r,e){var n=e(785),g=e(34),y=e(0),i=y.notundef;function k(L,$){n(L.body)||y.onParamError("body只能是整数",$),this.body=L.body,this.from=L.from||"",this.custom=L.custom||"",i(L.pushTitle)&&(this.pushTitle=L.pushTitle),i(L.apnsText)&&(this.apnsText=L.apnsText),i(L.pushPayload)&&(this.pushPayload=L.pushPayload),i(L.needPush)&&(this.needPush=L.needPush===!0?1:0),i(L.needBadge)&&(this.needBadge=L.needBadge===!0?1:0)}k.reverse=function(L){var $=g({},L);return i(L.needBadge)&&($.needBadge=+L.needBadge==1),i(L.needPush)&&($.needPush=+L.needPush==1),$.body=+L.body,$.time=+L.time,$},t.exports=k},function(t,r,e){t.exports=e(842)},function(t,r,e){var n=e(785),g=e(34),y=e(0);function i(k,L){n(k.type)||y.onParamError("Collect.type只能是整数",L),y.notundef(k.uniqueId)&&(this.uniqueId=k.uniqueId),this.type=k.type,this.data=k.data||"",this.custom=k.custom||""}i.reverse=function(k){var L=g({},k);return L.type=+L.type,L.createTime=+L.createTime,L.updateTime=+L.updateTime,L},t.exports=i},function(t,r,e){var n=e(788),g=e(789),y=e(790),i=e(791);function k(V,z,re){var oe=V;return g(z)?(re=z,typeof V=="string"&&(oe={uri:V})):oe=i(z,{uri:V}),oe.callback=re,oe}function L(V,z,re){return $(z=k(V,z,re))}function $(V){if(V.callback===void 0)throw new Error("callback argument missing");var z=!1,re=function(er,nr,dr){z||(z=!0,V.callback(er,nr,dr))};function oe(){var er=void 0;if(er=Ie.response?Ie.response:Ie.responseText||function(nr){try{if(nr.responseType==="document")return nr.responseXML;var dr=nr.responseXML&&nr.responseXML.documentElement.nodeName==="parsererror";if(nr.responseType===""&&!dr)return nr.responseXML}catch{}return null}(Ie),Et)try{er=JSON.parse(er)}catch{}return er}function le(er){return clearTimeout(de),er instanceof Error||(er=new Error(""+(er||"Unknown XMLHttpRequest Error"))),er.statusCode=0,re(er,cr)}function ue(){if(!ae){var er;clearTimeout(de),er=V.useXDR&&Ie.status===void 0?200:Ie.status===1223?204:Ie.status;var nr=cr,dr=null;return er!==0?(nr={body:oe(),statusCode:er,method:Ue,headers:{},url:Ce,rawRequest:Ie},Ie.getAllResponseHeaders&&(nr.headers=y(Ie.getAllResponseHeaders()))):dr=new Error("Internal XMLHttpRequest Error"),re(dr,nr,nr.body)}}var ie,ae,Ie=V.xhr||null;Ie||(Ie=V.cors||V.useXDR?new L.XDomainRequest:new L.XMLHttpRequest);var de,Ce=Ie.url=V.uri||V.url,Ue=Ie.method=V.method||"GET",qe=V.body||V.data,jt=Ie.headers=V.headers||{},Fe=!!V.sync,Et=!1,cr={body:void 0,headers:{},statusCode:0,method:Ue,url:Ce,rawRequest:Ie};if("json"in V&&V.json!==!1&&(Et=!0,jt.accept||jt.Accept||(jt.Accept="application/json"),Ue!=="GET"&&Ue!=="HEAD"&&(jt["content-type"]||jt["Content-Type"]||(jt["Content-Type"]="application/json"),qe=JSON.stringify(V.json===!0?qe:V.json))),Ie.onreadystatechange=function(){Ie.readyState===4&&setTimeout(ue,0)},Ie.onload=ue,Ie.onerror=le,Ie.onprogress=function(){},Ie.onabort=function(){ae=!0},Ie.ontimeout=le,Ie.open(Ue,Ce,!Fe,V.username,V.password),Fe||(Ie.withCredentials=!!V.withCredentials),!Fe&&V.timeout>0&&(de=setTimeout(function(){if(!ae){ae=!0,Ie.abort("timeout");var er=new Error("XMLHttpRequest timeout");er.code="ETIMEDOUT",le(er)}},V.timeout)),Ie.setRequestHeader)for(ie in jt)jt.hasOwnProperty(ie)&&Ie.setRequestHeader(ie,jt[ie]);else if(V.headers&&!function(er){for(var nr in er)if(er.hasOwnProperty(nr))return!1;return!0}(V.headers))throw new Error("Headers cannot be set on an XDomainRequest object");return"responseType"in V&&(Ie.responseType=V.responseType),"beforeSend"in V&&typeof V.beforeSend=="function"&&V.beforeSend(Ie),Ie.send(qe||null),Ie}t.exports=L,t.exports.default=L,L.XMLHttpRequest=n.XMLHttpRequest||function(){},L.XDomainRequest="withCredentials"in new L.XMLHttpRequest?L.XMLHttpRequest:n.XDomainRequest,function(V,z){for(var re=0;re<V.length;re++)z(V[re])}(["get","put","post","patch","head","delete"],function(V){L[V==="delete"?"del":V]=function(z,re,oe){return(re=k(z,re,oe)).method=V.toUpperCase(),$(re)}})},function(t,r,e){(function(n){var g;g=typeof window<"u"?window:n!==void 0?n:typeof self<"u"?self:{},t.exports=g}).call(this,e(77))},function(t,r){t.exports=function(n){if(!n)return!1;var g=e.call(n);return g==="[object Function]"||typeof n=="function"&&g!=="[object RegExp]"||typeof window<"u"&&(n===window.setTimeout||n===window.alert||n===window.confirm||n===window.prompt)};var e=Object.prototype.toString},function(t,r){var e=function(n){return n.replace(/^\s+|\s+$/g,"")};t.exports=function(n){if(!n)return{};for(var g,y={},i=e(n).split(`
`),k=0;k<i.length;k++){var L=i[k],$=L.indexOf(":"),V=e(L.slice(0,$)).toLowerCase(),z=e(L.slice($+1));y[V]===void 0?y[V]=z:(g=y[V],Object.prototype.toString.call(g)==="[object Array]"?y[V].push(z):y[V]=[y[V],z])}return y}},function(t,r){t.exports=function(){for(var n={},g=0;g<arguments.length;g++){var y=arguments[g];for(var i in y)e.call(y,i)&&(n[i]=y[i])}return n};var e=Object.prototype.hasOwnProperty},function(t,r,e){var n=e(24),g=e(128),y=e(4),i=e(6);function k(L){var $=this,V=L.url||null;$.level={debug:0,log:1,info:2,warn:3,error:4}[L.level]||0,$.logCache=[],$.logNum=1,$.timeInterval=5e3,window.onerror=function(z,re,oe,le,ue){$.error(ue)},g(function(){$.logCache.length>0&&V&&$.postLogs(V,$.logCache)},$.timeInterval)}k.prototype.debug=function(){var L;this.level>0||(console.debug.apply(this,arguments),this.cacheLogs.apply(this,y(L=["[degbug]"]).call(L,arguments)))},k.prototype.log=function(){var L;this.level>1||(console.log.apply(this,arguments),this.cacheLogs.apply(this,y(L=["[log]"]).call(L,arguments)))},k.prototype.info=function(){var L;this.level>2||(console.info.apply(this,arguments),this.cacheLogs.apply(this,y(L=["[info]"]).call(L,arguments)))},k.prototype.warn=function(){var L;this.level>3||(console.warn.apply(this,arguments),this.cacheLogs.apply(this,y(L=["[warn]"]).call(L,arguments)))},k.prototype.error=function(){var L;this.level>4||(console.error.apply(this,arguments),this.cacheLogs.apply(this,y(L=["[error]"]).call(L,arguments)))},k.prototype.cacheLogs=function(L,$){for(var V=[],z=0;z<$.length;z++){var re=$[z];n(re)==="object"?V.push(i(re)):V.push(re)}var oe=this.logNum+++" "+L+" "+V.join("; ");this.logCache.push(oe.replace("%c",""))},k.prototype.postLogs=function(L,$){var V=this,z=new XMLHttpRequest;z.onreadystatechange=function(){z.readyState===4&&(z.status===200?(console.info("LoggerPlugin::日志上报完成"),V.logCache=[],V.timeInterval=5e3):V.timeInterval+=5e3)},z.open("POST",L),z.setRequestHeader("Content-Type","plain/text;charset=utf-8"),z.timeout=360,z.send($.join(`
`))},t.exports=k},function(t,r,e){var n=e(3),g=e(48);t.exports=function(y){var i,k,L,$;y.db&&(g.db=y.db),y.rnfs&&(g.rnfs=y.rnfs,g.rnfs.size||(g.rnfs.size=1048576),g.rnfs.nimPromise=(i=g.rnfs,k=i.size/2-256,$=0,L=g.rnfs.DocumentDirectoryPath+"/nimlog_"+$+".log",i.exists(L).then(function(V){return V?i.stat(L):n.reject(0)}).then(function(V){return V&&V.size>k?n.reject(1):n.reject(0)}).catch(function(V){return typeof V=="number"&&(i.nimIndex=V),n.resolve()})))}},function(t,r,e){var n=e(43),g=e(0),y=g.notundef,i=g.undef;function k(L){y(L.name)&&(this.name=""+L.name),y(L.announcement)&&(this.announcement=""+L.announcement),y(L.broadcastUrl)&&(this.broadcastUrl=""+L.broadcastUrl),y(L.custom)&&(this.custom=""+L.custom),y(L.queuelevel)&&(this.queuelevel=n(L.queuelevel))}k.reverse=function(L){var $=g.copy(L);return i($.announcement)&&($.announcement=""),i($.broadcastUrl)&&($.broadcastUrl=""),i($.custom)&&($.custom=""),y($.createTime)&&($.createTime=+$.createTime),y($.updateTime)&&($.updateTime=+$.updateTime),y($.onlineMemberNum)&&($.onlineMemberNum=+$.onlineMemberNum),y($.mute)&&($.mute=$.mute==="1"),$},t.exports=k},function(t,r,e){var n,g,y;t.exports=(y=e(96),g=(n=y).lib.WordArray,n.enc.Base64={stringify:function(i){var k=i.words,L=i.sigBytes,$=this._map;i.clamp();for(var V=[],z=0;z<L;z+=3)for(var re=(k[z>>>2]>>>24-z%4*8&255)<<16|(k[z+1>>>2]>>>24-(z+1)%4*8&255)<<8|k[z+2>>>2]>>>24-(z+2)%4*8&255,oe=0;oe<4&&z+.75*oe<L;oe++)V.push($.charAt(re>>>6*(3-oe)&63));var le=$.charAt(64);if(le)for(;V.length%4;)V.push(le);return V.join("")},parse:function(i){var k=i.length,L=this._map,$=this._reverseMap;if(!$){$=this._reverseMap=[];for(var V=0;V<L.length;V++)$[L.charCodeAt(V)]=V}var z=L.charAt(64);if(z){var re=i.indexOf(z);re!==-1&&(k=re)}return function(oe,le,ue){for(var ie=[],ae=0,Ie=0;Ie<le;Ie++)if(Ie%4){var de=ue[oe.charCodeAt(Ie-1)]<<Ie%4*2,Ce=ue[oe.charCodeAt(Ie)]>>>6-Ie%4*2,Ue=de|Ce;ie[ae>>>2]|=Ue<<24-ae%4*8,ae++}return g.create(ie,ae)}(i,k,$)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="},y.enc.Base64)},function(t,r,e){var n,g,y,i,k,L,$,V;t.exports=(V=e(96),e(916),e(917),g=(n=V).lib,y=g.Base,i=g.WordArray,k=n.algo,L=k.MD5,$=k.EvpKDF=y.extend({cfg:y.extend({keySize:4,hasher:L,iterations:1}),init:function(z){this.cfg=this.cfg.extend(z)},compute:function(z,re){for(var oe,le=this.cfg,ue=le.hasher.create(),ie=i.create(),ae=ie.words,Ie=le.keySize,de=le.iterations;ae.length<Ie;){oe&&ue.update(oe),oe=ue.update(z).finalize(re),ue.reset();for(var Ce=1;Ce<de;Ce++)oe=ue.finalize(oe),ue.reset();ie.concat(oe)}return ie.sigBytes=4*Ie,ie}}),n.EvpKDF=function(z,re,oe){return $.create(oe).compute(z,re)},V.EvpKDF)},function(t,r,e){e(305);var n=e(41);e(318)(n),t.exports=n},function(t,r,e){var n=e(43),g=e(3),y=e(9),i=e(6),k=e(2),L=e(4),$=e(310),V=e(11),z=e(15),re=e(70),oe=e(203),le=e(308),ue=e(799),ie=e(0),ae=e(311),Ie=e(35),de=Ie.newSupportDBError,Ce=Ie.noDBError,Ue=!1;function qe(Et){Ue=Et,ae.set("db",Et,le)}if(qe(!!ie.getGlobal().indexedDB),re.name==="IE"&&qe(!1),re.name==="Microsoft Edge"&&qe(!1),re.name==="Safari")try{n(re.version.split(".")[0],10)<10&&qe(!1)}catch{}function jt(Et){this.concurrency=0,this.pendingTasks=[],this.queue=g.resolve(),this.logger=Et.logger,this.reporter=Et.reporter,this.core=Et.core,this.account=Et.account,this.notifyError=Et.notifyError}var Fe=jt.prototype;Fe.reset=ie.emptyFunc,Ue&&(Fe.reset=function(Et){this.enable=Et!==!1}),Fe.addTask=function(Et){var cr=this;return new g(function(er,nr){function dr(ir){cr.concurrency--;var tr=cr.pendingTasks.shift();tr&&cr.addTask(tr),ir()}if(cr.concurrency<100)return cr.concurrency++,Et().then(function(ir){dr(function(){er(ir),Et.resolve&&Et.resolve(ir)})},function(ir){dr(function(){var tr=(ir=ir||{}).event||ir,ur={event:tr,callFunc:ir.callFunc||"db::addTask"};cr.logger.error("db::error event is",tr,ie.get(tr,"target.error")),nr(ur),Et.reject&&Et.reject(ur)})});Et.resolve||(Et.resolve=er,Et.reject=nr),cr.pendingTasks.push(Et)})},Fe.reportError=function(Et){var cr=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},er=arguments.length>2?arguments[2]:void 0;this.reporter.reportTraceStart("exceptions",{user_id:this.account,trace_id:ie.get(this.core,"socket.socket.sessionid"),action:4,exception_service:0});var nr,dr=cr.context||"";if(er)try{var ir;nr=y(ir=i(er)).call(ir,0,2e4),dr+=". ".concat(nr)}catch{nr=""}var tr=ie.get(Et,"code")||ie.get(Et,"target.error.code")||0,ur=ie.get(Et,"message")||ie.get(Et,"target.error.message")||"unknown";ur=ur+" stack: "+ie.get(Et,"stack")||ie.get(Et,"target.error.stack")||"unknown",this.reporter.reportTraceUpdateV2("exceptions",{code:tr,description:ur,operation_type:cr.operation_type,target:cr.target||this.name,context:dr}),this.reporter.reportTraceEnd("exceptions",1)},Fe.init=function(Et){var cr=this;return cr.addTask(function(){return cr.enable?cr.server?g.resolve():(cr.name="nim-"+Et,le.open({server:cr.name,version:ue.version,schema:ue.schema}).then(function(er){cr.logger.info("db::init: ".concat(cr.name)),cr.server=er},function(er){throw qe(!1),cr.server=null,cr.name=null,er}).catch(function(er){throw cr.reportError(er,{operation_type:0,context:"version ".concat(ue.version),target:"nim-"+Et}),er})):g.reject(de({callFunc:"db::init"}))})},Fe.destroy=function(){var Et=this;return Et.addTask(function(){if(!Et.enable)return g.reject(de({callFunc:"db::destroy"}));if(!Et.server)return g.resolve();try{return le.remove(Et.name).then(function(){Et.logger.info("db::destroy: ".concat(Et.name)),Et.server=null,Et.name=null}).catch(function(cr){throw Et.reportError(cr,{operation_type:1,context:"remove database failed"}),cr})}catch(cr){throw Et.reportError(cr,{operation_type:1,context:"remove database failed"}),cr}})},Fe.clear=function(){var Et=this;return Et.addTask(function(){return Et.enable?Et.server?Et.server.clear("timetag").then(function(){var cr=y([]).call(Et.server.getIndexedDB().objectStoreNames),er=[];if(k(cr).call(cr,function(nr){er.push(Et.server.clear(nr).catch(function(dr){throw Et.reportError(dr,{operation_type:3,context:"tableName: ".concat(nr,". clear table failed")}),dr}))}),er.length)return g.all(er).then(function(){Et.logger.info("db::clear: ".concat(Et.name))}).catch(function(nr){return Et.logger.error("db::clear: ",nr),g.reject(nr)})}):g.resolve():g.reject(de({callFunc:"db::clear"}))})},Fe.close=function(){this.server&&(this.server.close(),this.server=null,this.name=null)},Fe.remove=function(Et,cr,er,nr,dr,ir,tr){var ur=this;return ur.addTask(function(){ur.checkDB();try{return ur.server.remove(Et,cr,er,nr,dr,ir,tr).then(function(){var or;ur.logger.info(L(or="db::delete: ".concat(Et," ")).call(or,cr||er))}).catch(function(or){throw ur.reportError(or,{operation_type:3,context:"tableName: ".concat(Et,", remove failed")},{name:Et,keys:cr,keyName:er,lowerBound:nr,upperBound:dr,lowerOpen:ir,upperOpen:tr}),ur.logger.error("db::remove::server.remove error",or),or})}catch(or){throw ur.reportError(or,{operation_type:3,context:"tableName: ".concat(Et,", remove failed")},{name:Et,keys:cr,keyName:er,lowerBound:nr,upperBound:dr,lowerOpen:ir,upperOpen:tr}),ur.logger.error("db::remove::server.remove error",or),or}})},Fe.put=function(Et,cr){var er=this;return er.addTask(function(){er.checkDB(),ie.isArray(cr)||(cr=[cr]);try{return er.server.update(Et,cr).then(function(nr){var dr=[Et],ir=ue.keyPath(Et),tr=[];return ir&&(k(nr).call(nr,function(ur){tr.push(oe(ur,ir))}),dr.push(tr.length===1?tr[0]:tr)),dr.unshift("db::put:"),Et==="timetag"&&dr.push(nr[0]),er.logger.log.apply(er.logger.log,dr),nr}).catch(function(nr){throw er.reportError(nr,{operation_type:3,context:"tableName: ".concat(Et,". put failed")},cr),nr})}catch(nr){throw er.reportError(nr,{operation_type:3,context:"tableName: ".concat(Et,". put failed")},cr),nr}})},Fe.get=function(Et,cr){var er=this;return er.addTask(function(){er.checkDB();try{return er.server.get(Et,cr).catch(function(dr){var ir;throw er.reportError(dr,{operation_type:3,context:L(ir="tableName: ".concat(Et,". get failed with key ")).call(ir,cr)}),dr})}catch(dr){var nr;throw er.reportError(dr,{operation_type:3,context:L(nr="tableName: ".concat(Et,". get failed with key ")).call(nr,cr)}),dr}})},Fe.modifyOrPut=function(Et){var cr=this,er=Et.table,nr=ie.copy(Et.obj),dr=Et.key,ir=Et.modifyObjWhenPut,tr=ie.copy(nr);return delete tr[dr],cr.getOne(er,null,nr[dr],{modifyObj:tr}).then(function(ur){return ur?(tr.idClient?tr={idClient:tr.idClient,server:tr.server,pinFrom:tr.pinFrom}:(tr.lastMsg=tr.lastMsg&&tr.lastMsg.idServer+"_"+tr.lastMsg.idClient,tr.localCustom=tr.localCustom&&"***",tr.topCustom=tr.topCustom&&"***"),cr.logger.log("db::modifyOrPut: update table ".concat(er),tr),ur):(nr=ie.merge(nr,ir),cr.put(er,nr).then(function(or){return or[0]}))})},Fe.updateAndDelete=function(Et,cr,er){var nr=this;return nr.addTask(function(){nr.checkDB();try{return nr.server.updateAndDelete(Et,cr,er).catch(function(dr){throw nr.reportError(dr,{operation_type:3,context:"tableName: ".concat(Et,". updateAndDelete failed")},{updates:cr,deletes:er}),dr})}catch(dr){throw nr.reportError(dr,{operation_type:3,context:"tableName: ".concat(Et,". updateAndDelete failed")},{updates:cr,deletes:er}),dr}})},Fe.getAll=function(Et,cr){var er=this;return er.addTask(function(){er.checkDB(),(cr=cr||{}).keys=$(cr)===!0,cr.desc=cr.desc===!0,cr.distinct=cr.distinct===!0;try{var nr,dr,ir;return V(nr=$(dr=z(ir=er.server.query(Et,cr.index)).call(ir,z(cr))).call(dr,$(cr)).desc(cr.desc).limit(cr.limit).distinct(cr.distinct)).call(nr,cr.mapper).modify(cr.modifyObj).execute().catch(function(tr){throw er.reportError(tr,{operation_type:3,context:"tableName: ".concat(Et,". getAll failed")},cr),tr})}catch(tr){throw er.reportError(tr,{operation_type:3,context:"tableName: ".concat(Et,". getAll failed")},cr),tr}})},Fe.getOnly=function(Et,cr,er,nr){var dr=this;return dr.addTask(function(){dr.checkDB(),(nr=nr||{}).keys=$(nr)===!0,nr.desc=nr.desc===!0,nr.distinct=nr.distinct===!0,nr.remove=nr.remove===!0;try{var ir,tr,ur;return V(ir=$(tr=z(ur=dr.server.query(Et,cr).only(er)).call(ur,z(nr))).call(tr,$(nr)).desc(nr.desc).limit(nr.limit).distinct(nr.distinct)).call(ir,nr.mapper).modify(nr.modifyObj).remove(nr.remove).execute().catch(function(lr){var gr,Sr;throw dr.reportError(lr,{operation_type:3,context:L(gr=L(Sr="tableName: ".concat(Et,". getOnly failed with index: ")).call(Sr,cr,", matchValue: ")).call(gr,er)},nr),lr})}catch(lr){var or,fr;throw dr.reportError(lr,{operation_type:3,context:L(or=L(fr="tableName: ".concat(Et,". getOnly failed with index: ")).call(fr,cr,", matchValue: ")).call(or,er)},nr),lr}})},Fe.getOne=function(){var Et=this;return Et.getOnly.apply(Et,arguments).then(function(cr){return cr[0]})},Fe.clearTable=function(Et){var cr=this;return cr.addTask(function(){cr.checkDB();try{return cr.server.clear(Et).catch(function(er){throw cr.reportError(er,{operation_type:3,context:"tableName: ".concat(Et,". clearTable failed")},options),er})}catch(er){throw cr.reportError(er,{operation_type:3,context:"tableName: ".concat(Et,". clearTable failed")},options),er}})},Fe.checkDB=function(){if(!this.enable)throw de({callFunc:"db::checkDB"});if(!this.server)throw Ce({callFunc:"db::checkDB"})},t.exports=jt},function(t,r){var e={version:14},n={kv:{key:{keyPath:"key"}},timetag:{key:{keyPath:"name"}},sessionsWithMoreRoaming:{key:{keyPath:"id"}},msgReadDetail:{key:{keyPath:"idClient"}},blacklist:{key:{keyPath:"account"}},mutelist:{key:{keyPath:"account"}},friend:{key:{keyPath:"account"}},user:{key:{keyPath:"account"}},team:{key:{keyPath:"teamId"}},teamMember:{key:{keyPath:"id"},indexes:{teamId:{unique:!1},account:{unique:!1}}},superTeam:{key:{keyPath:"teamId"}},superTeamMember:{key:{keyPath:"id"},indexes:{teamId:{unique:!1},account:{unique:!1},id:{unique:!1}}},msg:{key:{autoIncrement:!0},indexes:{idClient:{unique:!0},sessionId:{unique:!1},time:{unique:!1},type:{unique:!1},sessionType:{unique:!1},status:{unique:!1},sessionTime:{key:["sessionId","time"],unique:!1}}},msg1:{key:{keyPath:"idClient"},indexes:{sessionId:{unique:!1},time:{unique:!1},status:{unique:!1},sessionTime:{key:["sessionId","time"],unique:!1}}},msgPin:{key:{keyPath:"idClient"},indexes:{sessionId:{unique:!1}}},broadcastMsg:{key:{keyPath:"broadcastId"},indexes:{time:{unique:!1}}},sysMsg:{key:{autoIncrement:!0},indexes:{idServer:{unique:!0},category:{unique:!1},type:{unique:!1}}},sysMsgUnread:{key:{keyPath:"type"}},session:{key:{keyPath:"id"},indexes:{updateTime:{unique:!1}}}};e.keyPath=function(g){return n[g].key.keyPath},e.schema=function(){return window._nimForceSyncIM=!0,n},t.exports=e},function(t,r,e){var n=e(79).fn;n.setKey=function(g,y){return this.put("kv",{key:g,value:y})},n.getKey=function(g){return this.get("kv",g).then(function(y){return y&&y.value})},n.setDonnop=function(g){return this.setKey("donnop",g)},n.getDonnop=function(){return this.getKey("donnop")}},function(t,r,e){var n=e(8),g=e(43),y=e(79).fn;y.getTimetags=function(i){var k={};return this.getAll("timetag",{filter:i,mapper:function(L){return k[L.name]=L.value,L}}).then(function(){return k})},y.getTeamMemberTimetags=function(){return this.getTimetags(function(i){var k;return n(k=i.name).call(k,"team-")!==-1})},y.getSuperTeamMemberTimetags=function(){return this.getTimetags(function(i){var k;return n(k=i.name).call(k,"superTeam-")!==-1})},y.getTimetag=function(i){return this.getOne("timetag",null,i).then(function(k){return(k=k||{value:0}).value})},y.getTeamMemberTimetag=function(){return 0},y.updateTimetag=function(i,k){var L=this,$={name:i,value:k};return this.put("timetag",$).catch(function(V){L.notifyError&&L.notifyError(V)})},y.updateMyInfoTimetag=function(i){return this.updateTimetag("myInfo",i)},y.updateRelationTimetag=function(i){return this.updateTimetag("relations",i)},y.getRelationsTimetag=function(){return this.getTimetag("relations")},y.updateFriendTimetag=function(i){return this.updateTimetag("friends",i)},y.getFriendsTimetag=function(){return this.getTimetag("friends")},y.updateFriendUserTimetag=function(i){return this.updateTimetag("friendUsers",i)},y.updateTeamTimetag=function(i){return this.updateTimetag("teams",i)},y.getTeamsTimetag=function(){return this.getTimetag("teams")},y.updateSuperTeamTimetag=function(i){return this.updateTimetag("superTeams",i)},y.getSuperTeamsTimetag=function(){return this.getTimetag("superTeams")},y.updateTeamMemberTimetag=function(i,k){return this.updateTimetag("team-"+i,k)},y.getTeamMembersTimetag=function(i){return this.getTimetag("team-"+i)},y.updateSuperTeamMemberTimetag=function(i,k){return this.updateTimetag("superTeam-"+i,k)},y.getSuperTeamMembersTimetag=function(i){return this.getTimetag("superTeam-"+i)},y.updateMyTeamMembersTimetag=function(i){return this.updateTimetag("myTeamMembers",i)},y.updateMySuperTeamMembersTimetag=function(i){return this.updateTimetag("myInfoInSuperTeams",i)},y.getBroadcastMsgTimetag=function(){return this.getTimetag("broadcastMsg")},y.updateBroadcastMsgTimetag=function(i){return this.updateTimetag("broadcastMsg",g(i))},y.updateRoamingMsgTimetag=function(i){return this.updateTimetag("roamingMsgs",i)},y.updateSuperTeamRoamingMsgTimetag=function(i){return this.updateTimetag("superTeamRoamingMsgs",i)},y.updateMsgReceiptsTimetag=function(i){return this.updateTimetag("msgReceipts",i)},y.updateDonnopTimetag=function(i){return this.updateTimetag("donnop",i)},y.updateSessionAck=function(i){return this.updateTimetag("sessionAck",i)},y.updateDeleteMsgSelf=function(i){return this.updateTimetag("deleteMsgSelf",i)},y.updateSuperTeamSessionAck=function(i){return this.updateTimetag("superTeamSessionAck",i)},y.deleteTimetag=function(i){return this.remove("timetag",i)},y.deleteTeamMemberTimetag=function(i){return this.deleteTimetag("team-"+i)},y.deleteSuperTeamMemberTimetag=function(i){return this.deleteTimetag("superTeam-"+i)}},function(t,r,e){var n=e(3),g=e(79).fn,y=e(0);g.mergeRelations=function(i,k,L,$,V){var z=this,re=z.updateAndDelete("blacklist",i,k),oe=z.updateAndDelete("mutelist",L,$);return n.all([re,oe]).then(function(){return z.logger.info("db::mergeRelations: timetag ".concat(V)),z.updateRelationTimetag(V),[i,k,L,$,V]})},g.getRelations=function(){var i=this.getAll("blacklist"),k=this.getAll("mutelist");return n.all([i,k])},g.markInBlacklist=function(i){if((i=y.copy(i)).isAdd){var k=i.record;return this.put("blacklist",k)}var L=i.account;return this.remove("blacklist",L)},g.markInMutelist=function(i){if((i=y.copy(i)).isAdd){var k=i.record;return this.put("mutelist",k)}var L=i.account;return this.remove("mutelist",L)}},function(t,r,e){var n=e(11),g=e(3),y=e(125),i=e(79).fn,k=e(0);i.mergeFriends=function(L,$,V){var z=this;return z.updateAndDelete("friend",L,$).then(function(){return z.logger.log("db::mergeFriends: updateAndDelete done",L&&n(L).call(L,function(re){return re.account}).join(",")),V&&z.updateFriendTimetag(V),[L,$,V]})},i.putFriend=function(L){return this.put("friend",L)},i.updateFriend=function(L){var $=this,V=(L=k.copy(L)).account;return this.getOne("friend",null,V,{modifyObj:L}).then(function(z){return z?$.logger.log("db::updateFriend: ".concat(V)):$.logger.warn("db::updateFriend: no record ".concat(V)),z})},i.deleteFriend=function(L){var $=this.remove("friend",L),V=this.deleteUser(L);return g.all([$,V])},i.getFriends=function(){var L,$=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},V={};$.accountIds!==void 0&&(V=y(L=$.accountIds).call(L,function(re,oe){return re[oe]=!0,re},{}));var z=function(re){return!!re.valid&&!($.updateTime!==void 0&&re.updateTime<=$.updateTime)&&!($.accountIds!==void 0&&!V[re.account])};return this.getAll("friend",{filter:z})},i.getFriend=function(L){return this.getOne("friend",null,L)},i.getUserFromBlackList=function(L){return this.getOne("blacklist",null,L)}},function(t,r,e){var n=e(3),g=e(2),y=e(4),i=e(125),k=e(11),L=e(79).fn,$=e(0),V=e(35),z=e(198),re=e(160);function oe(ie){return ie.valid&&ie.validToCurrentUser}function le(ie){return ie&&ie.valid}function ue(ie){return ie&&$.fillUndef(ie,{mute:!1,custom:""}),ie}L.mergeTeams=function(ie,ae,Ie){var de=this,Ce=de.put("team",ie),Ue=de.leaveTeams(ae,Ie);return n.all([Ce,Ue]).then(function(){return de.logger.log("db::mergeTeams:"),de.updateTeamTimetag(Ie),[ie,ae,Ie]})},L.putTeam=function(ie){if(ie)return $.isArray(ie)||(ie=[ie]),g(ie).call(ie,function(ae){ae.validToCurrentUser=!0}),this.put("team",ie)},L.updateTeam=function(ie){var ae=this,Ie=(ie=$.copy(ie)).teamId;return ae.getOne("team",null,Ie,{modifyObj:ie}).then(function(de){if(de)ae.logger.log("db::updateTeam: ".concat(Ie));else if(ae.logger.warn("db::updateTeam: no record ".concat(Ie)),ie.validToCurrentUser)return ae.putTeam(ie);return de})},L.transferTeam=function(ie,ae,Ie){var de=this,Ce=ie.teamId,Ue=ie.memberUpdateTime,qe={teamId:Ce,account:ae,type:"normal",updateTime:Ue},jt={teamId:Ce,account:Ie,type:"owner",updateTime:Ue};return de.updateTeamMembers([qe,jt]).then(function(){return de.putTeam(ie).then(function(){var Fe,Et;return de.logger.info(y(Fe=y(Et="db::transferTeam: ".concat(ie.teamId," ")).call(Et,ae," -> ")).call(Fe,Ie)),[ie,ae,Ie]})})},L.leaveTeam=function(ie){var ae=this;return ae.updateTeam({teamId:ie,validToCurrentUser:!1}).then(function(){return ae.removeAllTeamMembers(ie)})},L.dismissTeam=function(ie,ae){var Ie=this,de={teamId:ie,valid:!1,validToCurrentUser:!1,updateTime:ae};return Ie.updateTeam(de).then(function(){return Ie.removeAllTeamMembers(ie)})},L.leaveTeams=function(ie,ae){var Ie,de=this,Ce=[];return g(ie).call(ie,function(Ue){Ie=de.leaveTeam(Ue.teamId,ae),Ce.push(Ie)}),n.all(Ce)},L.getTeamsByTeamIds=function(ie){var ae,Ie=this,de=[];return g(ie).call(ie,function(Ce){ae=Ie.getTeam(Ce),de.push(ae)}),n.all(de)},L.getTeam=function(ie){ie=""+ie;var ae=this;return ae.getOne("team",null,ie).then(function(Ie){return Ie?(ae.updateTeamProperties([Ie]),Ie):null})},L.getTeams=function(){var ie,ae=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},Ie={};ae.teamIds!==void 0&&(Ie=i(ie=ae.teamIds).call(ie,function(Ce,Ue){return Ce[Ue]=!0,Ce},{}));var de=function(Ce){return!!oe(Ce)&&!(ae.teamIds!==void 0&&!Ie[Ce.teamId])};return this.getAll("team",{filter:de})},L.updateTeamProperties=function(ie){g(ie).call(ie,function(ae){ae&&z.fillProperties(ae)})},L.mergeTeamMembers=function(ie,ae,Ie,de){var Ce=this,Ue=Ce.putTeamMembers(ae),qe=Ce.updateTeamMembers(Ie);return n.all([Ue,qe]).then(function(){return Ce.logger.log("db::mergeTeamMembers: ".concat(ie)),Ce.updateTeamMemberTimetag(ie,de)})},L.putTeamMembers=function(ie){return this.put("teamMember",ie)},L.getTeamMembersByAccount=function(ie){return this.getOnly("teamMember","account",ie,{filter:le,mapper:ue}).then()},L.getTeamMembers=function(){var ie,ae=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},Ie={};ae.accountIds!==void 0&&(Ie=i(ie=ae.accountIds).call(ie,function(qe,jt){return qe[jt]=!0,qe},{}));var de,Ce={};ae.teamIds!==void 0&&(Ce=i(de=ae.teamIds).call(de,function(qe,jt){return qe[jt]=!0,qe},{}));var Ue=function(qe){return!!qe.valid&&!(ae.teamIds!==void 0&&!Ce[qe.teamId])&&!(ae.accountIds!==void 0&&!Ie[qe.account])};return this.getAll("teamMember",{filter:Ue})},L.getTeamMembersByTeamId=function(ie){return this.getOnly("teamMember","teamId",ie,{filter:le,mapper:ue})},L.getTeamMembersById=function(ie){return this.getOnly("teamMember",null,ie,{filter:le,mapper:ue})},L.updateTeamMemberProperties=function(ie){var ae,Ie=this,de=[];return g(ie).call(ie,function(Ce){re.fillProperties(Ce)&&(ae=Ie.updateTeamMember(Ce),de.push(ae))}),n.all(de)},L.getInvalidTeamMembers=function(ie,ae){var Ie=this;ie=""+ie;var de,Ce=[];return g(ae).call(ae,function(Ue){de=Ie.getOne("teamMember",null,re.genId(ie,Ue)).then(function(qe){return ue(qe)}),Ce.push(de)}),n.all(Ce)},L.updateTeamMember=function(ie){var ae=this,Ie=ie.teamId,de=ie.account,Ce=re.genId(Ie,de),Ue=$.filterObj(ie,"nickInTeam muteTeam mute custom updateTime type valid followAccountIds muteNotiType");return this.getOne("teamMember",null,Ce,{modifyObj:Ue,mapper:ue}).then(function(qe){var jt,Fe;return qe?ae.logger.log(y(jt="db::updateTeamMember: ".concat(Ie," ")).call(jt,de),$.pickAsString(Ue,["nickInTeam","muteTeam","mute","custom","updateTime","type","valid","followAccountIds","muteNotiType"])):ae.logger.warn(y(Fe="db::updateTeam: no record ".concat(Ie," ")).call(Fe,de)),qe})},L.updateTeamMembers=function(ie){var ae=this;if(!ie.length)return n.resolve();var Ie,de=[];return g(ie).call(ie,function(Ce){Ie=ae.updateTeamMember(Ce),de.push(Ie)}),n.all(de)},L.updateTeamManagers=function(ie,ae,Ie,de){var Ce=k(ae).call(ae,function(Ue){return{teamId:ie,account:Ue,type:Ie?"manager":"normal",updateTime:de}});return this.updateTeamMembers(Ce)},L.removeTeamMembersByAccounts=function(ie,ae){var Ie=k(ae).call(ae,function(de){return{teamId:ie,account:de,valid:!1}});return this.updateTeamMembers(Ie)},L.removeAllTeamMembers=function(ie){var ae=this;return ae.getOnly("teamMember","teamId",ie,{modifyObj:{valid:!1}}).then(function(){return ae.logger.warn("db::removeAllTeamMembers: ".concat(ie)),ae.deleteTeamMemberTimetag(ie)})},L.deleteTeamMembers=function(ie){var ae=this;return ae.getOnly("teamMember","teamId",ie,{remove:!0}).then(function(){ae.logger.warn("db::deleteTeamMembers: ".concat(ie)),ae.deleteTeamMemberTimetag(ie)})},L.deleteTeam=function(ie){var ae,Ie=this,de=[];return $.isArray(ie)||(ie=[ie]),g(ie).call(ie,function(Ce){Ce=""+Ce,ae=Ie.get("team",Ce).then(function(Ue){if(Ue&&oe(Ue))throw V.stillInTeamError({callFunc:"team::deleteTeam",team:Ue});var qe=Ie.remove("team",Ce),jt=Ie.deleteTeamMembers(Ce);return n.all([qe,jt])}),de.push(ae)}),de.length===1?de[0]:n.all(de)}},function(t,r,e){var n=e(3),g=e(2),y=e(10),i=e(4),k=e(11),L=e(79).fn,$=e(0),V=e(35),z=e(312),re=e(206);function oe(ie){return ie.valid&&ie.validToCurrentUser}function le(ie){return ie&&ie.valid}function ue(ie){return ie&&$.fillUndef(ie,{mute:!1,custom:""}),ie}L.mergeSuperTeams=function(ie,ae,Ie){var de=this,Ce=de.put("superTeam",ie),Ue=de.leaveTeams(ae,Ie);return n.all([Ce,Ue]).then(function(){return de.logger.log("db::mergeSuperTeams:"),de.updateSuperTeamTimetag(Ie),[ie,ae,Ie]})},L.putSuperTeam=function(ie){if(ie)return $.isArray(ie)||(ie=[ie]),g(ie).call(ie,function(ae){ae.validToCurrentUser=!0}),this.put("superTeam",ie)},L.updateSuperTeam=function(ie){var ae=this,Ie=(ie=$.copy(ie)).teamId;return ae.getOne("superTeam",null,Ie,{modifyObj:ie}).then(function(de){return de?(ae.logger.info("db::updateSuperTeam: ".concat(Ie)),de):(ae.logger.warn("db::updateSuperTeam: no record ".concat(Ie)),ae.putSuperTeam(ie))})},L.leaveSuperTeam=function(ie){var ae=this;return ae.updateSuperTeam({teamId:ie,validToCurrentUser:!1}).then(function(){return ae.removeAllSuperTeamMembers(ie)})},L.dismissSuperTeam=function(ie,ae){var Ie=this,de={teamId:ie,valid:!1,validToCurrentUser:!1,updateTime:ae};return Ie.updateSuperTeam(de).then(function(){return Ie.removeAllSuperTeamMembers(ie)})},L.leaveSuperTeams=function(ie,ae){var Ie,de=this,Ce=[];return g(ie).call(ie,function(Ue){Ie=de.leaveSuperTeam(Ue.teamId,ae),Ce.push(Ie)}),n.all(Ce)},L.getSuperTeamsByTeamIds=function(ie){var ae,Ie=this,de=[];return g(ie).call(ie,function(Ce){ae=Ie.getSuperTeam(Ce),de.push(ae)}),n.all(de)},L.getSuperTeam=function(ie){ie=""+ie;var ae=this;return ae.getOne("superTeam",null,ie).then(function(Ie){return Ie?(ae.updateSuperTeamProperties([Ie]),Ie):null})},L.getSuperTeams=function(){var ie=this;return ie.getAll("superTeam",{filter:oe}).then(function(ae){return ie.updateSuperTeamProperties(ae),ae})},L.updateSuperTeamProperties=function(ie){g(ie).call(ie,function(ae){ae&&z.fillProperties(ae)})},L.mergeSuperTeamMembers=function(ie,ae,Ie,de){var Ce=this,Ue=Ce.putSuperTeamMembers(ae),qe=Ce.updateSuperTeamMembers(Ie);return n.all([Ue,qe]).then(function(){return Ce.logger.log("db::mergeSuperTeamMembers: ".concat(ie)),de!=null?Ce.updateSuperTeamMemberTimetag(ie,de):n.resolve()})},L.getSuperTeamMembersByTeamId=function(ie){return this.getOnly("superTeamMember","teamId",ie,{filter:le,mapper:ue}).then()},L.getSuperTeamMembersById=function(ie){return this.getOnly("superTeamMember",null,ie,{filter:le,mapper:ue}).then()},L.putSuperTeamMembers=function(ie){return this.put("superTeamMember",ie)},L.getSuperTeamMemberById=function(ie){return this.get("superTeamMember",ie)},L.getSuperTeamMembers=function(ie,ae){var Ie=this;ie=""+ie;var de={filter:function(Ce){return Ce.valid},mapper:ue};if(ae){if(typeof ae.joinTime!="number")return void Ie.logger.error("db::getSuperTeamMembers::params.joinTime should be number, not ",ae.joinTime);ae.limit&&(de.limit=ae.limit),y(ae)?de.filter=function(Ce){return Ce.valid&&Ce.joinTime<=ae.joinTime}:de.filter=function(Ce){return Ce.valid&&Ce.joinTime>=ae.joinTime}}return Ie.getOnly("superTeamMember","teamId",ie,de).then(function(Ce){return Ie.updateSuperTeamMemberProperties(Ce).then(function(){return Ce})})},L.getSuperTeamMembersByAccount=function(ie){return this.getOnly("superTeamMember","account",ie,{filter:le,mapper:ue}).then()},L.updateSuperTeamMemberProperties=function(ie){var ae,Ie=this,de=[];return g(ie).call(ie,function(Ce){re.fillProperties(Ce)&&(ae=Ie.updateSuperTeamMember(Ce),de.push(ae))}),n.all(de)},L.getInvalidSuperTeamMembers=function(ie,ae){var Ie=this;ie=""+ie;var de,Ce=[];return g(ae).call(ae,function(Ue){de=Ie.getOne("superTeamMember","id",re.genId(ie,Ue)).then(function(qe){return ue(qe)}),Ce.push(de)}),n.all(Ce)},L.updateSuperTeamMember=function(ie){var ae=this,Ie=ie.teamId,de=ie.account,Ce=re.genId(Ie,de),Ue=$.filterObj(ie,"nickInTeam muteTeam mute custom updateTime type valid followAccountIds muteNotiType");return this.getOne("superTeamMember","id",Ce,{modifyObj:Ue,mapper:ue}).then(function(qe){var jt,Fe;return qe?ae.logger.log(i(jt="db::updateSuperTeamMember: ".concat(Ie," ")).call(jt,de),$.pickAsString(Ue,["nickInTeam","muteTeam","mute","custom","updateTime","type","valid","followAccountIds","muteNotiType"])):ae.logger.warn(i(Fe="db::updateSuperTeam: no record ".concat(Ie," ")).call(Fe,de)),qe})},L.updateSuperTeamMembers=function(ie){var ae=this;if(!ie.length)return n.resolve();var Ie,de=[];return g(ie).call(ie,function(Ce){Ie=ae.updateSuperTeamMember(Ce),de.push(Ie)}),n.all(de)},L.removeSuperTeamMembersByAccounts=function(ie,ae){var Ie=k(ae).call(ae,function(de){return{teamId:ie,account:de,valid:!1}});return this.updateSuperTeamMembers(Ie)},L.removeAllSuperTeamMembers=function(ie){var ae=this;return ae.getOnly("superTeamMember","teamId",ie,{modifyObj:{valid:!1}}).then(function(){return ae.logger.warn("db::removeAllSuperTeamMembers: ".concat(ie)),ae.deleteSuperTeamMemberTimetag(ie)})},L.deleteSuperTeamMembers=function(ie){var ae=this;return ae.getOnly("superTeamMember","teamId",ie,{remove:!0}).then(function(){ae.logger.warn("db::deleteSuperTeamMembers: ".concat(ie)),ae.deleteSuperTeamMemberTimetag(ie)})},L.deleteSuperTeam=function(ie){var ae,Ie=this,de=[];return $.isArray(ie)||(ie=[ie]),g(ie).call(ie,function(Ce){Ce=""+Ce,ae=Ie.get("superTeam",Ce).then(function(Ue){if(Ue&&oe(Ue))throw V.stillInTeamError({callFunc:"team::deleteTeam",team:Ue});var qe=Ie.remove("superTeam",Ce),jt=Ie.deleteSuperTeamMembers(Ce);return n.all([qe,jt])}),de.push(ae)}),de.length===1?de[0]:n.all(de)},L.transferSuperTeam=function(ie,ae,Ie){var de=this;return de.updateSuperTeamMembers([ae,Ie]).then(function(){return de.putSuperTeam(ie).then(function(){var Ce,Ue;return de.logger.info(i(Ce=i(Ue="db::transferSuperTeam: ".concat(ie.teamId," ")).call(Ue,ae.account," -> ")).call(Ce,Ie.account)),[ie,ae,Ie]})})}},function(t,r,e){var n=e(2),g=e(3),y=e(125),i=e(79).fn,k=e(0);i.mergeMyInfo=function(L,$){var V=this;return V.put("user",L).then(function(){return $?V.updateMyInfoTimetag(L.updateTime):L})},i.mergeFriendUsers=function(L,$){var V=this;return V.putUsers(L).then(function(){V.updateFriendUserTimetag($)})},i.putUsers=function(L){return this.put("user",L)},i.putUser=function(L){return this.put("user",L)},i.updateUser=function(L){var $=this,V=(L=k.copy(L)).account;return this.getOne("user",null,V,{modifyObj:L}).then(function(z){return z?$.logger.log("db::updateUser: ".concat(V)):$.logger.warn("db::updateUser: no record ".concat(V)),z})},i.putUsersIfIsFriend=function(L){var $,V=this,z=[],re=[];return n(L).call(L,function(oe){$=V.getFriend(oe.account).then(function(le){return le&&($=V.putUser(oe),re.push($)),le}),z.push($)}),g.all(z).then(function(){return g.all(re).then(function(oe){return oe})})},i.deleteUser=function(L){return this.remove("user",L)},i.getUser=function(L){return this.getOne("user",null,L)},i.getUsers=function(){var L,$=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},V={};$.accountIds!==void 0&&(V=y(L=$.accountIds).call(L,function(re,oe){return re[oe]=!0,re},{}));var z=function(re){return!($.accountIds!==void 0&&!V[re.account])};return this.getAll("user",{filter:z})},i.getAllUsers=function(){return this.getAll("user")}},function(t,r,e){var n=e(15),g=e(3),y=e(4),i=e(2),k=e(34),L=e(28),$=e(8),V=e(11),z=e(79).fn,re=e(0),oe=e(12);z.putMsg=function(le){var ue=this;return re.isArray(le)||(le=[le]),!le.length||n(le[0])?g.resolve():(le=n(le).call(le,function(ie){return!ie.ignore}),ue.put("msg1",le).catch(function(ie){return ue.notifyError&&ue.notifyError(ie),g.resolve(le,ie)}))},z.putMsgReadDetail=function(le){var ue=this;if(le.idClient)return this.put("msgReadDetail",le).catch(function(ie){ue.logger.error("putMsgReadDetail error",ie)})},z.getMsgReadDetail=function(le){return this.getOne("msgReadDetail",null,le)},z.updateMsg=function(le){var ue=this;if(!n(le)){var ie=le.idClient,ae=re.filterObj(le,"resend status idServer time localCustom commentTimetag comments hasSendAck callbackExt");return ue.getOne("msg1",null,ie,{modifyObj:ae}).then(function(Ie){var de,Ce,Ue;return Ie?ue.logger.info(y(de=y(Ce=y(Ue="db::updateMsg: ".concat(ie,"，idServer: ")).call(Ue,ae.idServer,"，status: ")).call(Ce,ae.status,"，time: ")).call(de,ae.time)):ue.logger.warn("db::updateMsg: no record ".concat(ie)),Ie}).catch(function(Ie){return ue.notifyError&&ue.notifyError(Ie),g.resolve(le)})}},z.updateMsgBatch=function(le){var ue=this;if(oe.isRN)this.logger.warn("react native can not support updateMsgBatch");else{this.checkDB();var ie=this.server.getIndexedDB().transaction(["msg1"],"readwrite").objectStore("msg1");i(le).call(le,function(ae){if(ae.idClient){var Ie=ie.get(ae.idClient);Ie.onerror=function(de){ue.logger.error("updateMsgBatch::store.get:error",de)},Ie.onsuccess=function(){var de=Ie.result||ae;ie.put(k({},de,ae)).onerror=function(Ce){ue.logger.error("updateMsgBatch::store.put:error",Ce)}}}})}},z.getMsgs=function(le){return oe.isBrowser?this.getMsgsIndexedDB(le):oe.isRN?this.getMsgsRN(le):g.resolve()},z.getMsgsRN=function(le){var ue={};return typeof le.start=="number"&&(ue.lowerBound=["time",le.start]),typeof le.end=="number"&&le.end!==1/0&&(ue.upperBound=["time",le.end]),ue.desc=!1,ue.index="time",typeof le.desc=="boolean"&&(ue.desc=le.desc),typeof le.limit=="number"&&(ue.limit=le.limit),ue.searchIndex=[],le.sessionId&&ue.searchIndex.push(["sessionId",le.sessionId]),typeof le.type=="string"&&ue.searchIndex.push(["type",le.type]),this.getAll("msg1",ue)},z.getMsgsIndexedDB=function(le){var ue,ie=this;ie.checkDB();var ae="time",Ie=!1,de=!1,Ce=(le=le||{}).sessionId||[],Ue=le.sessionIds||[];re.isString(Ce)?Ce=[Ce]:L(Ce)||(Ce=[]),re.isString(Ue)?Ue=[Ue]:L(Ue)||(Ue=[]);var qe=y(Ce).call(Ce,Ue);qe.length===1?(Ie=!0,ae="sessionTime",Ce=qe[0]):qe.length>1&&(Ie=!0,de=!0,Ue=qe);var jt=le.start||0,Fe=le.end||1/0,Et=jt,cr=Fe;Ie&&!de&&(Et=[Ce,jt],cr=[Ce,Fe]);var er=le.desc!==!1,nr=le.limit||100,dr=!1,ir=!1,tr=le.type||[],ur=le.types||[];re.isString(tr)?tr=[tr]:L(tr)||(tr=[]),re.isString(ur)?ur=[ur]:L(ur)||(ur=[]);var or=y(tr).call(tr,ur);or.length===1?(dr=!0,tr=or[0]):or.length>1&&(dr=!0,ir=!0,ur=or);var fr,lr=le.subTypes&&le.subTypes.length,gr=le.keyword||"",Sr=le.filterFunc;return(de||dr||gr||lr||re.isFunction(Sr))&&(fr=function(wr){var kr;if(de&&$(Ue).call(Ue,wr.sessionId)===-1)return!1;if(dr){if(ir){if($(ur).call(ur,wr.type)===-1)return!1}else if(tr!==wr.type)return!1}if(lr&&$(kr=le.subTypes).call(kr,wr.subType)===-1)return!1;if(gr){var mr=wr.text||wr.tip||"";if($(mr).call(mr,gr)===-1)return!1}return!Sr||Sr(wr)}),n(ue=ie.server.query("msg1",ae).bound(Et,cr,!0,!0).desc(er).limit(nr)).call(ue,fr).execute().catch(function(wr){throw ie.reportError(wr,{operation_type:3,context:"tableName: ".concat("msg1",", index ").concat(ae,", getMsgsIndexedDB error")},le),wr})},z.getMsgCountAfterAck=function(le){return oe.isBrowser?this.getMsgCountAfterAckIndexedDB(le):oe.isRN?this.getMsgCountAfterAckRN(le):g.resolve()},z.getMsgCountAfterAckRN=function(le){var ue=this,ie=le=le||{},ae=ie.sessionId,Ie=ie.ack;return ue.checkDB(),ue.getAll("msg1",{searchIndex:["sessionId",ae],lowerBound:["time",Ie]}).then(function(de){var Ce=n(de).call(de,function(Ue){if(Ue.flow==="out"||Ue.isUnreadable===!1)return!1;if(Ue.type==="notification")try{return le.shouldCountNotifyUnread(Ue)}catch(qe){throw ue.logger.error("userOption:shouldCountNotifyUnread function error",qe),qe}return!0});return g.resolve(Ce.length)})},z.getMsgCountAfterAckIndexedDB=function(le){var ue=this,ie=(le=le||{}).sessionId;return ue.checkDB(),ue.server.query("msg1","sessionTime").bound([ie,le.ack],[ie,1/0],!0,!0).execute().then(function(ae){var Ie=n(ae).call(ae,function(de){if(de.flow==="out"||de.isUnreadable===!1)return!1;if(de.type==="notification")try{return le.shouldCountNotifyUnread(de)}catch(Ce){throw ue.logger.error("userOption:shouldCountNotifyUnread function error",Ce),Ce}return!0});return g.resolve(Ie.length)}).catch(function(ae){throw ue.reportError(ae,{operation_type:3,context:"tableName: ".concat("msg1",", IndexSessionTime ").concat("sessionTime",", getMsgCountAfterAckIndexedDB error")},le),ae})},z.amendMsg=function(le){return le?(re.notexist(le.text)&&(le.text=""),le):null},z.getMsgByIdClient=function(le){var ue=this;return ue.getOne("msg1",null,le).then(function(ie){return ue.amendMsg(ie)})},z.getMsgsByIdClients=function(le){var ue,ie=this,ae=[];return i(le).call(le,function(Ie){ue=ie.getMsgByIdClient(Ie),ae.push(ue)}),g.all(ae)},z.clearSendingMsgs=function(){var le=this;return le.getOnly("msg1","status","sending",{modifyObj:{status:"fail"}}).then(function(ue){le.logger.info("db::clearSendingMsgs: msgs send failed",ue&&V(ue).call(ue,function(ie){return ie.idClient}).join(","))})},z.deleteMsg=function(le){var ue,ie=this,ae=[];return re.isArray(le)||(le=[le]),i(le).call(le,function(Ie){ue=ie.getOne("msg1",null,Ie,{remove:!0}).then(function(de){return ie.logger.info("db::deleteMsg done",Ie,de&&de.idClient),de}).catch(function(de){throw ie.logger.error("db::deleteMsg failed",Ie,de),de}),ae.push(ue)}),ae.length===1?ae[0]:g.all(ae)},z.deleteMsgsBySessionId=function(le){var ue=this,ie=null,ae=le.start,Ie=le.end;return ae!==void 0&&Ie!==void 0?ie=function(de){return de>ae&&de<Ie}:ae!==void 0?ie=function(de){return de>ae}:Ie!==void 0&&(ie=function(de){return de<Ie}),ie?ue.getOnly("msg1","sessionId",le.sessionId).then(function(de){var Ce=[];return V(de=de||[]).call(de,function(Ue){ie(Ue.time)&&Ce.push(Ue.idClient)}),ue.logger.info("db::deleteMsgsBySessionId: session results",Ce),ue.deleteMsg(Ce)}):ue.getOnly("msg1","sessionId",le.sessionId,{remove:!0})},z.deleteMsgsByTime=function(le){return this.remove("msg1",null,"time",le.start,le.end,!0,!0)},z.getDeletedMsgsCountByTime=function(le){this.checkDB();var ue=this.server.getIndexedDB().transaction(["msg1"],"readonly").objectStore("msg1").index("time"),ie=IDBKeyRange.bound(le.start,le.end,!0,!0),ae=ue.count(ie);return new g(function(Ie,de){ae.onsuccess=function(Ce){Ie(Ce.target.result)},ae.onerror=function(Ce){this.logger.error("countDeletedMsgsByTime::index.count:error",Ce),de(Ce)}})},z.deleteAllMsgs=function(){var le=this.clearTable("msg1"),ue=this.clearTable("session");return g.all([le,ue])},z.getMsgPins=function(le){return this.getOnly("msgPin","sessionId",le)},z.deleteMsgPins=function(le){return this.getOnly("msgPin","sessionId",le,{remove:!0})},z.putMsgPin=function(le){var ue=this;return this.modifyOrPut({table:"msgPin",obj:le,key:"idClient"}).catch(function(ie){ue.notifyError&&ue.notifyError(ie)})},z.putMsgPins=function(le){return this.put("msgPin",le)},z.deleteMsgPin=function(le){var ue=this;return this.getOne("msgPin",null,le.idClient,{remove:!0}).then(function(ie){return ue.logger.info("db::deleteMsgPin:",ie.idClient),ie})}},function(t,r,e){var n=e(3),g=e(15),y=e(2),i=e(10),k=e(5),L=e(79).fn,$=e(0),V=$.notundef;L.putSysMsg=function(z){var re=this;return new n(function(oe){if($.isArray(z)||(z=[z]),!g(z[0])){var le=[],ue=z.length;y(z).call(z,function(ae){ae=$.copy(ae),re.put("sysMsg",ae).then(function(Ie){le.push(Ie[0]),ie()},ie)})}function ie(){--ue===0&&oe(le)}})},L.getSysMsgs=function(z){var re=!i(z=z||{}),oe=z.limit||100,le=null,ue=null;z.category&&(le="category",ue=z.category),z.type&&(le="type",ue=z.type);var ie,ae=z.lastIdServer,Ie=!1,de=z.read;return(V(ae)||V(de))&&(ie=function(Ce){return V(ae)?(ae=""+ae,Ie?Ue():(Ce.idServer===ae&&(Ie=!0),!1)):Ue();function Ue(){return!V(de)||Ce.read===de}}),z={filter:ie,desc:re,limit:oe},le?this.getOnly("sysMsg",le,ue,z):this.getAll("sysMsg",z)},L.getSysMsgByIdServer=function(z){return this.getOne("sysMsg","idServer",z)},L.updateSysMsg=function(z){var re=this;if(!g(z)){var oe=""+z.idServer,le=$.filterObj(z,"read state error localCustom");return this.getOne("sysMsg","idServer",oe,{modifyObj:le}).then(function(ue){return ue?re.logger.log("db::updateSysMsg: ".concat(oe),$.pickAsString(le,["read","state","error"])):re.logger.warn("db::updateSession: ".concat(oe)),ue})}},L.markSysMsgRead=function(z){var re=this;return new n(function(oe,le){$.isArray(z)||(z=[z]);var ue,ie,ae=[],Ie=[];y(z).call(z,function(de){ue=re.getSysMsgByIdServer(de.idServer).then(function(Ce){Ce&&!Ce.read&&(ie=re.updateSysMsg({idServer:Ce.idServer,read:!0}),Ie.push(ie))},le),ae.push(ue)}),n.all(ae).then(function(){n.all(Ie).then(function(de){oe(de)},le)},le)})},L.deleteSysMsg=function(z){var re,oe=this,le=[];return $.isArray(z)||(z=[z]),y(z).call(z,function(ue){ue=""+ue,re=oe.getOne("sysMsg","idServer",ue,{remove:!0}),le.push(re)}),le.length===1?le[0]:n.all(le)},L.deleteAllSysMsgs=function(){var z=this.clearTable("sysMsg"),re=this.clearTable("sysMsgUnread");return n.all([z,re])},L.getSysMsgUnread=function(){return this.getAll("sysMsgUnread").then(function(z){var re={};return y(z).call(z,function(oe){re[oe.type]=oe.num}),re})},L.updateSysMsgUnread=function(z){var re,oe=this;z=$.copy(z);var le=[];return y(re=k(z)).call(re,function(ue){le.push({type:ue,num:z[ue]})}),this.put("sysMsgUnread",le).then(function(){return oe.logger.info("db::updateSysMsgUnread: ",z),z})}},function(t,r,e){var n=e(3),g=e(2),y=e(79).fn,i=e(0);y.putBroadcastMsg=function(k){var L=this;return new n(function($){i.isArray(k)||(k=[k]);var V=[],z=k.length;function re(){--z===0&&$(V)}g(k).call(k,function(oe){oe=i.copy(oe),L.put("broadcastMsg",oe).then(function(le){V.push(le[0]),re()},re)})})},y.getBroadcastMsgs=function(k){return k=k||{},this.getAll("broadcastMsg",k)}},function(t,r,e){var n=e(3),g=e(10),y=e(4),i=e(28),k=e(2),L=e(79).fn,$=e(0),V=$.notundef;L.putSession=function(z){var re=this,oe=z.unread;return(z=$.merge({},z)).updateTime===void 0&&z.lastMsg&&z.lastMsg.time&&(z.updateTime=z.lastMsg.time),(z.lastMsg||!z.ack&&!z.msgReceiptTime)&&(z.isDeleted=!1),delete z.unread,this.modifyOrPut({table:"session",obj:z,key:"id",modifyObjWhenPut:{unread:0}}).catch(function(le){return re.notifyError&&re.notifyError(le),z.unread=oe,n.resolve(z)})},L.getAllSessions=function(){return this.getAll("session",{index:"updateTime",desc:!0}).catch(function(z){self.notifyError&&self.notifyError(z)})},L.getSessions=function(z){var re=!g(z=z||{}),oe=z.limit||100,le=z.lastSessionId,ue=z.sessionId,ie=!1,ae=this,Ie=function(){return!0},de=function(){return!0};return V(ue)?this.getSession(ue,z.isDeleted):(V(le)&&(Ie=function(Ce){return Ce.id===le&&(ie=!0),ie}),z.includeDeleted||(de=function(Ce){return!Ce.isDeleted}),this.getAll("session",{index:"updateTime",desc:re,limit:oe,filter:function(Ce){return Ie(Ce)&&de(Ce)}}).catch(function(Ce){ae.notifyError&&ae.notifyError(Ce)}))},L.getSession=function(z,re){var oe=this;return this.get("session",z).then(function(le){return n.resolve(!re&&le&&le.isDeleted?void 0:le)}).catch(function(le){throw oe.notifyError&&oe.notifyError(le),le})},L.updateSession=function(z){var re=this,oe=z.id,le=$.filterObj(z,"ack unread lastMsg localCustom msgReceiptTime msgReceiptServerTime isTop topCustom isDeleted");return z.lastMsg&&(le.lastMsg=z.lastMsg),this.getOne("session",null,oe,{modifyObj:le}).then(function(ue){if(ue){var ie,ae=y(ie="db::updateSession: ".concat(oe," ")).call(ie,$.pickAsString(le,["ack","unread","msgReceiptTime","msgReceiptServerTime","isTop","isDeleted"]));ae+=le.lastMsg?" lastMsg.idClient:".concat($.get(le,"lastMsg.idClient")):"",re.logger.info(ae)}else re.logger.warn("db::updateSession: no record ".concat(oe));return ue}).catch(function(ue){re.notifyError&&re.notifyError(ue)})},L.getStickTopSessions=function(){var z=this;return this.getAll("session",{filter:function(re){return re&&re.isTop}}).catch(function(re){z.notifyError&&z.notifyError(re)})},L.deleteSession=function(z,re){var oe=re&&re.scene||"";return oe==="superTeam"?this.updateSuperTeamSessionAck(0):(oe==="p2p"||oe==="team"||this.updateSuperTeamSessionAck(0),this.updateSessionAck(0)),this.updateMsgReceiptsTimetag(0),this.remove("session",z)},L.deleteSessionLogic=function(z){var re=this;if(!i(z))return this.getOne("session",null,z,{modifyObj:{isDeleted:!0}});var oe=[];return k(z).call(z,function(le){oe.push(re.getOne("session",null,le,{modifyObj:{isDeleted:!0}}))}),n.all(oe)},L.putSessionsWithMoreRoaming=function(z){return this.put("sessionsWithMoreRoaming",z)},L.updateSessionsWithMoreRoaming=function(z){var re=z.id;return delete z.id,this.getOne("sessionsWithMoreRoaming",null,re,{modifyObj:z})},L.deleteSessionsWithMoreRoaming=function(z){return this.remove("sessionsWithMoreRoaming",z)},L.getSessionsWithMoreRoaming=function(z){return z?this.get("sessionsWithMoreRoaming",z):this.getAll("sessionsWithMoreRoaming")}},function(t,r,e){var n=e(4),g=e(44),y=e(45),i=e(0).throttle,k=function(){function L($){g(this,L),this.arr=[],this.timer=null,this.maxLength=$.maxLength||100,this.throttleTime=$.throttleTime||5e3,this.processFn=$.processFn||function(){},this.throttleFn=$.processFn||function(){},$.processFn&&(this.throttleFn=i(function(V){$.processFn(V),V.length=0},this.throttleTime,{leading:!1}))}return y(L,[{key:"add",value:function($){var V;Object.prototype.toString.call($)==="[object Array]"?this.arr=n(V=this.arr).call(V,$):this.arr.push($),this.arr.length>=this.maxLength&&(this.processFn(this.arr),this.arr=[]),this.timer=this.throttleFn(this.arr)}},{key:"destroy",value:function(){this.arr=[],this.timer&&clearTimeout(this.timer),this.processFn=function(){},this.throttleFn=function(){}}},{key:"clear",value:function(){this.arr=[],this.timer&&clearTimeout(this.timer)}}]),L}();t.exports=k},function(t,r,e){var n=e(51),g=e(34),y=e(56),i=e(2),k=e(15),L=e(5),$=e(52),V=e(53),z=e(54),re=e(55),oe=e(42),le=e(44),ue=e(45);function ie(Ie,de){var Ce=L(Ie);if($){var Ue=$(Ie);de&&(Ue=k(Ue).call(Ue,function(qe){return V(Ie,qe).enumerable})),Ce.push.apply(Ce,Ue)}return Ce}var ae={user_id:"",trace_id:"",duration:0,start_time:0,history:[]};t.exports=function(){function Ie(de){le(this,Ie),this.clientProto=de,this.reset()}return ue(Ie,[{key:"reset",value:function(){this.traceData=g({},ae),this.traceData.history=[]}},{key:"start",value:function(){this.reset(),this.traceData.start_time=y()}},{key:"updateBegin",value:function(de){this.traceData.history.push(function(Ce){for(var Ue=1;Ue<arguments.length;Ue++){var qe,jt,Fe=arguments[Ue]!=null?arguments[Ue]:{};Ue%2?i(qe=ie(Object(Fe),!0)).call(qe,function(Et){n(Ce,Et,Fe[Et])}):z?re(Ce,z(Fe)):i(jt=ie(Object(Fe))).call(jt,function(Et){oe(Ce,Et,V(Fe,Et))})}return Ce}({head:"",body:"",start_time:y(),httpdns:!1,index:0},de))}},{key:"updateComplete",value:function(de){var Ce;i(Ce=this.traceData.history).call(Ce,function(Ue){Ue.target===de.target&&(g(Ue,de),Ue.duration=y()-Ue.start_time)})}},{key:"end",value:function(de){var Ce;if(this.traceData.succeed=de,this.traceData.history=k(Ce=this.traceData.history).call(Ce,function(qe){return qe.code!==void 0}),this.traceData.history.length!==0){this.traceData.duration=y()-this.traceData.start_time;var Ue=this.clientProto.checkNetworkAvailable();this.traceData.net_type=0,this.traceData.net_connect=Ue,this.clientProto.reporter.report("nim_sdk_lbs_records",this.traceData),this.reset()}else this.reset()}}]),Ie}()},function(t,r,e){var n=e(24),g=e(51),y=e(56),i=e(6),k=e(321),L=e(4),$=e(3),V=e(22),z=e(15),re=e(8),oe=e(9),le=e(23),ue=e(2),ie=e(128),ae=e(5),Ie=e(52),de=e(53),Ce=e(54),Ue=e(55),qe=e(42);function jt(or,fr){var lr=ae(or);if(Ie){var gr=Ie(or);fr&&(gr=z(gr).call(gr,function(Sr){return de(or,Sr).enumerable})),lr.push.apply(lr,gr)}return lr}function Fe(or){for(var fr=1;fr<arguments.length;fr++){var lr,gr,Sr=arguments[fr]!=null?arguments[fr]:{};fr%2?ue(lr=jt(Object(Sr),!0)).call(lr,function(wr){g(or,wr,Sr[wr])}):Ce?Ue(or,Ce(Sr)):ue(gr=jt(Object(Sr))).call(gr,function(wr){qe(or,wr,de(Sr,wr))})}return or}var Et=e(37).fn,cr=e(0),er=e(12),nr=e(165).V2NIMConnectStatus;function dr(or,fr){var lr,gr,Sr,wr,kr=this,mr=er.getDefaultLinkUrl(kr.options.secure);kr.socketUrls=[mr],kr.reporterHookLBS.updateComplete({target:fr,code:200,body:or}),kr.reporterHookLBS.end(!0),kr.reporter.reportTraceUpdateV2("login",{operation_type:"HTTP",target:fr,code:200,net_connect:kr.checkNetworkAvailable(),succeed:!0}),kr.msgStatEnable=!!or.common["msg.stat.enable"],kr.msgStatEnable&&(kr.msgDelayTimer=V(le(gr=kr.doReportMsgDelay).call(gr,kr),1e4)),or.common&&or.common.link&&ue(Sr=or.common.link).call(Sr,function(Er){kr.socketUrls.unshift(er.formatSocketUrl({url:Er,secure:kr.options.secure}))}),or.common&&or.common["link.default"]&&ue(wr=or.common["link.default"]).call(wr,function(Er){var sr,xr;Er=er.formatSocketUrl({url:Er,secure:kr.options.secure}),re(sr=kr.socketUrls).call(sr,Er)===-1&&(kr.socketUrls=L(xr=kr.socketUrls).call(xr,Er))}),kr.socketUrls=z(lr=kr.socketUrls).call(lr,function(Er,sr,xr){return re(xr).call(xr,Er)===sr});try{er.uploadUrl=or.nosup[0]}catch{}if(er.chunkUploadUrl=or["nos-chunk"]||er.chunkUploadUrl||"",kr.logger.info("link::refreshSocketUrl: ".concat(fr," ajax load , got socket urls "),kr.socketUrls),er.hasLocalStorage){or.common["lbs.backup"]&&kr.options.lbsBackup&&localStorage.setItem("nim_lbs_backup",i(or.common["lbs.backup"]));var Ir=cr.get(or,"common.report.apierror.on");or.common.report&&localStorage.setItem("nim_lbs_fail_report_on",Ir===!1?"0":"1")}if(or.common.socketConcurrent){var Nr=or.common.socketConcurrent;typeof Nr=="number"&&Nr>=1&&Nr<=3&&(kr.options.socketConcurrent=Nr,kr.imsocket.setConfig({socketConcurrent:Nr}))}}function ir(or,fr){if(this.statusProtector.getConnectStatus()===nr.V2NIM_CONNECT_STATUS_DISCONNECTED)return $.reject(new Error("already disconnected"));if(or>=fr){this.logger.warn("doRequestBackupLbsUrls backup lbs all tried");var lr=er.getDefaultLinkUrl(this.options.secure);return this.logger.warn("doRequestBackupLbsUrls: use default socket link",lr),this.socketUrls=[lr],this.reporterHookLBS.end(!1),$.resolve()}return this.logger.warn("doRequestBackupLbsUrls: wait for next lbs request"),$.reject(new Error("lbs request failed"))}function tr(or,fr){var lr=fr.status||10001,gr=typeof fr=="string"?fr:fr&&fr.message?fr.message:"Unknown error";this.reporterHookLBS.updateComplete({target:or,code:fr.status||fr.code||0,body:fr&&fr.message||""}),this.reporter.reportTraceUpdateV2("login",{operation_type:"HTTP",target:or,code:lr,description:gr,net_connect:this.checkNetworkAvailable(),succeed:!1})}function ur(or){var fr=this;if(!(or&&or.length>0))throw new Error("No  lbs url to try");var lr=0,gr=0,Sr=!1,wr=null;fr.logger.log("doRequestBackupLbsUrls: use lbs url in index ",lr,or),fr.reporterHookLBS.start();var kr=function(mr){var Ir=or[mr],Nr=new Date().getTime();return fr.reporterHookLBS.updateBegin({target:Ir,index:mr}),fr.promiseAbortManager.add(fr.doRequestLbs(Ir)).then(function(Er){if(wr&&clearInterval(wr),Sr===!1)return dr.call(fr,Er,Ir),Sr=!0,$.resolve()}).catch(function(Er){return gr+=1,fr.logger.warn("doRequestBackupLbsUrls: ".concat(Ir," ajax lbs error"),Er),tr.call(fr,Ir,Er,Nr),ir.call(fr,gr,or.length)})};return new $(function(mr,Ir){wr=ie(function(){if(!(lr>=or.length))return fr.statusProtector.getConnectStatus()===nr.V2NIM_CONNECT_STATUS_DISCONNECTED?(wr&&clearInterval(wr),void Ir(new Error("already disconnected"))):void kr(lr++).then(function(){wr&&clearInterval(wr),mr()}).catch(function(){});wr&&clearInterval(wr)},2e3),kr(lr++).then(function(){wr&&clearInterval(wr),mr()}).catch(function(){})})}Et.connect=function(){er.isBrowser&&this.reporter.restore(),this.createConnectTime=y(),this.reporter.reportTraceCancel("login"),this.autoconnect?this.reporter.reportTraceStart("login",{user_id:this.options.account,action:"auto_login",binary_websocket:this.useBinaryWebSocket()}):this.reporter.reportTraceStart("login",{user_id:this.options.account,action:"manual_login",process_id:this.processId,binary_websocket:this.useBinaryWebSocket()}),this.reporter.reportTraceUpdateV2("login",{code:0,description:i(Fe(Fe({},this.options),{},{account:"***",token:"***"}),function(or,fr){return or===""||typeof fr!="function"&&n(fr)!=="object"?fr:void 0}),operation_type:"conf_init",net_connect:this.checkNetworkAvailable(),succeed:!0,target:""}),k(Et).connect.call(this)},Et.onConnect=function(){this.reporter.reportTraceUpdateV2("login",{operation_type:"TCP",target:this.url,code:200,net_connect:this.checkNetworkAvailable(),succeed:!0}),k(Et).onConnect.call(this)},Et.onHandshakeFailed=function(or,fr){var lr;this.reporter.reportTraceUpdateV2("login",{operation_type:"TCP",target:fr,code:408,succeed:!1,net_connect:this.checkNetworkAvailable(),description:"ws_handshake_failed"}),this.reporter.reportTraceEnd("login",!1),this.logger.warn(L(lr="link::onHandshakeFailed: shandshake failed, startTime: ".concat(or,", targetUrl: ")).call(lr,fr))},Et.onConnectFailed=function(or,fr,lr){var gr,Sr;this.reporter.reportTraceUpdateV2("login",{operation_type:"TCP",target:lr,code:408,succeed:!1,net_connect:this.checkNetworkAvailable(),description:"ws_connect_failed"}),this.reporter.reportTraceEnd("login",!1),this.logger.warn(L(gr=L(Sr="link::onConnectFailed: connect failed due to ".concat(or,", startTime: ")).call(Sr,fr,", targetUrl: ")).call(gr,lr))},Et.onSocketError=function(or,fr,lr){var gr,Sr;this.reporter.reportTraceUpdateV2("login",{operation_type:"TCP",target:lr,description:"ws_onerror:"+or,code:0,net_connect:this.checkNetworkAvailable(),succeed:!1}),this.reporter.reportTraceEnd("login",!1),this.logger.warn(L(gr=L(Sr="link::onSocketError: due to ".concat(or,", startTime: ")).call(Sr,fr,", targetUrl: ")).call(gr,lr))},Et.probeIp=function(){var or=this,fr=er.ipProbeAddr;return new $(function(lr){var gr=0,Sr=-1;function wr(){++gr===2&&(gr=-1,lr(Sr))}or.adaptersRequest(fr.ipv4,{timeout:2e3,onerror:wr,onload:function(kr){Sr++,wr()}}),or.adaptersRequest(fr.ipv6,{timeout:2e3,onerror:wr,onload:function(kr){Sr+=2,wr()}}),V(function(){gr||Sr===-1||(gr=-1,lr(Sr))},100)})},Et.refreshSocketUrl=function(){var or=this;return this.statusProtector.processEvent("auth/loginLifeCycleAddressing"),er.isWeixinApp?this.doRefreshSocketUrl(2):this.options.ipVersion===2?this.probeIp().then(function(fr){return or.doRefreshSocketUrl(fr)}):this.doRefreshSocketUrl(this.options.ipVersion)},Et.doRefreshSocketUrl=function(or){var fr,lr,gr=this.options.lbsUrl||er.lbsUrl;or!==1&&or!==2&&(or=0),er.ipVersion=or;var Sr=this.options.lbsBackupUrlsCustomer||[],wr=[];this.options.lbsBackup&&er.hasLocalStorage&&(wr=(wr=localStorage.getItem("nim_lbs_backup"))?JSON.parse(wr):[]);var kr=L(fr=L(lr=[gr]).call(lr,wr)).call(fr,Sr);return kr=z(kr).call(kr,function(mr,Ir,Nr){return re(Nr).call(Nr,mr)===Ir}),ur.call(this,kr)},Et.doRequestLbs=function(or){var fr=this,lr=this.options,gr=er.info;or=or+cr.genUrlSep(or)+"id="+lr.account+"&sv="+gr.sdkVersion+"&pv="+gr.protocolVersion+"&networkType="+er.ipVersion+"&hostEnv="+er.hostEnv+"&k="+lr.appKey,this.logger.info("doRequestLbs ".concat(oe(or).call(or,0,-32)));var Sr=this;return new $(function(wr,kr){er.isWeixinApp?wx.request({url:or,success:function(mr){var Ir=mr&&mr.statusCode,Nr=mr&&mr.data;Ir===200?wr(Nr):kr(Nr)},fail:function(mr){kr(mr)}}):fr.adaptersRequest(or,{proxyUrl:cr.url2origin(or)+"/lbs/res/cors/nej_proxy_frame.html",timeout:er.xhrTimeout,onload:function(mr){try{var Ir=JSON.parse(mr);wr(Ir)}catch(Nr){Sr.logger.warn("doRequestLbs parse JSON Error. request lbs failed"),kr(Nr)}},onerror:function(mr){kr(mr)}},{exception_service:1})})},Et.disconnect=function(){var or=this,fr=arguments.length>0&&arguments[0]!==void 0?arguments[0]:function(){};if(this.isConnected())return this.sendCmd("logout"),void V(function(){k(Et).disconnect.call(or,fr)},0);this.connecting?this.logger.warn("IMProtocolFn api disconnect:: connecting but exiting"):this.statusProtector.getConnectStatus()!==nr.V2NIM_CONNECT_STATUS_DISCONNECTED?this.logger.warn("IMProtocolFn api disconnect:: has tried to disconnect"):this.logger.warn("IMProtocolFn api disconnect:: other logic entered");var lr=k(Et);lr.disconnect.call(this,fr)},Et.notifyDisconnect=function(or){k(Et).notifyDisconnect.call(this,or)}},function(t,r,e){var n=e(60),g=e(51),y=e(61),i=e(3),k=e(6),L=e(22),$=e(23),V=e(8),z=e(2),re=e(15),oe=e(5),le=e(52),ue=e(53),ie=e(54),ae=e(55),Ie=e(42);function de(ir,tr){var ur=oe(ir);if(le){var or=le(ir);tr&&(or=re(or).call(or,function(fr){return ue(ir,fr).enumerable})),ur.push.apply(ur,or)}return ur}function Ce(ir){for(var tr=1;tr<arguments.length;tr++){var ur,or,fr=arguments[tr]!=null?arguments[tr]:{};tr%2?z(ur=de(Object(fr),!0)).call(ur,function(lr){g(ir,lr,fr[lr])}):ie?ae(ir,ie(fr)):z(or=de(Object(fr))).call(or,function(lr){Ie(ir,lr,ue(fr,lr))})}return ir}var Ue=e(37).fn,qe=e(199),jt=e(12),Fe="NIM-AllGrayscaleConfig",Et="NIM-AllMixStorePolicy",cr=e(0);function er(){var ir=this;if(jt.hasLocalStorage&&localStorage.getItem(Fe)){var tr=null;try{tr=JSON.parse(localStorage.getItem(Fe))[ir.options.appKey]}catch(ur){ir.logger.error("appGrayConfig error",ur)}tr&&(ir.appGrayConfig=tr.timeStamp+1e3*tr.ttl>new Date().getTime()?tr:null,ir.appGrayConfig&&nr.apply(ir))}ir.appGrayConfig||ir.sendCmd("getGrayscaleConfig",{providers:""},function(ur,or){if(ur)ir.logger.error("Calculate Delay time, getGrayscaleConfig error",ur);else if(or){var fr=or;if(fr.grayConfig=JSON.parse(fr.grayConfig),fr.ttl=Number(fr.ttl),fr.timeStamp=new Date().getTime(),ir.appGrayConfig=fr,jt.hasLocalStorage){var lr=localStorage.getItem(Fe)?JSON.parse(localStorage.getItem(Fe)):{};lr[ir.options.appKey]=fr,localStorage.setItem(Fe,k(lr))}nr.apply(ir)}else ir.logger.error("Calculate Delay time, getGrayscaleConfig error",or)})}function nr(){var ir=this;if(jt.hasLocalStorage&&localStorage.getItem(Et)){var tr=null;try{tr=JSON.parse(localStorage.getItem(Et))[ir.options.appKey]}catch(ur){ir.logger.error("mixStorePolicy error",ur)}tr&&(ir.mixStorePolicy=tr.timeStamp+1e3*tr.ttl>new Date().getTime()?tr:null,ir.mixStorePolicy&&tr.ttl&&tr.ttl!==0&&(ir.mixStorePolicyClock=L($(nr).call(nr,ir),1e3*tr.ttl)))}ir.mixStorePolicy||ir.sendCmd("getMixStorePolicy",{providers:ir.options.providers&&ir.options.providers.s3?[1,2]:[1]},function(ur,or){if(ur){ir.logger.error("Calculate Delay time, getMixStorePolicy error",ur);try{or=JSON.parse(localStorage.getItem("NIM-AllMixStorePolicy"))[ir.options.appKey]}catch(gr){ir.logger.error("error:","get last mixStorePolicy failed",gr)}}else if(or){var fr=or;if(fr.ttl=Number(fr.ttl),fr.providers=fr.providers.split(","),fr.nosPolicy=fr.nosPolicy?JSON.parse(fr.nosPolicy):null,fr.s3Policy=fr.s3Policy?JSON.parse(fr.s3Policy):null,fr.timeStamp=new Date().getTime(),ir.mixStorePolicy=fr,fr.ttl&&fr.ttl!==0&&(ir.mixStorePolicyClock=L($(nr).call(nr,ir),1e3*fr.ttl)),jt.hasLocalStorage){var lr=localStorage.getItem(Et)?JSON.parse(localStorage.getItem(Et)):{};lr[ir.options.appKey]=fr,localStorage.setItem(Et,k(lr))}}else ir.logger.error("Calculate Delay time, mixStorePolicy error",or)})}function dr(ir){var tr=this,ur=this;ir.code===399?(this.logger.warn("pendingLoginFailed:399, refresh LBS url and reconnecting"),ur.forceDisconnect(),ur.doRefreshSocketUrl(jt.ipVersion).then(function(){ur.reconnect()}).catch(function(){tr.logger.warn("pendingLoginFailed:399, refresh LBS url failed")})):ir.code===398?(this.logger.warn("pendingLoginFailed:398 try to reconnect socket link，backoff set min 5s"),ur.backoff.setMin(5e3),ur.reconnect()):(this.logger.error("pendingLoginFailed: ",ir.code,ir),ur.onAuthError(ir,"link::onLogin"))}Ue.assembleLogin=function(){var ir=this.assembleIMLogin();return this.addPushInfo instanceof Function?this.addPushInfo(ir):i.resolve({login:ir})},Ue.login=y(n.mark(function ir(){var tr,ur,or,fr=this;return n.wrap(function(lr){for(;;)switch(lr.prev=lr.next){case 0:return tr=this,lr.next=3,tr.assembleLogin();case 3:if(ur=lr.sent,!tr.socket||tr.socket.binaryType!=="arraybuffer"){lr.next=8;break}this.logger.log("link::doLogin: appLogin is "+ur.login.appLogin),lr.next=19;break;case 8:if(!(or=this.socket&&this.socket.socket&&this.socket.socket.sessionid)){lr.next=17;break}if(this.socketIds||(this.socketIds={}),!this.socketIds[or]){lr.next=14;break}return this.logger.warn("onConnect::repeat login",or),lr.abrupt("return");case 14:this.socketIds[or]=!0,lr.next=18;break;case 17:this.logger.warn("onConnect:: no socketId ",this.socket&&this.socket.socket);case 18:this.logger.warn("link::doLogin: "+or+" appLogin is "+ur.login.appLogin);case 19:tr.sendCmd("login",Ce({},ur),function(gr,Sr){if(gr){var wr=cr.get(gr,"event.uploadCode")||gr&&gr.code;wr=typeof wr!="number"?408:wr;var kr=cr.get(gr,"event.disconnectReason"),mr=kr?k({disconnect_reason:kr}):gr&&gr.message||"login failed";tr.reporter.reportTraceUpdateV2("login",{operation_type:"protocol",target:"2-3",code:wr,description:mr,net_connect:tr.checkNetworkAvailable(),succeed:!1}),tr.reporter.reportTraceEnd("login",!1),dr.call(tr,gr),tr.statusProtector.processEvent("auth/loginLifeCycleLoginFail",gr)}else tr.reporter.reportTraceUpdateV2("login",{operation_type:"protocol",target:"2-3",succeed:!0,net_connect:tr.checkNetworkAvailable(),code:200}),tr.reporter.reportTraceEnd("login",!0),tr.resetReconnectStatus(),fr.heartbeatFail=0,fr.hasLogin=!0,fr.autoconnect=!0,tr.startHeartbeat(),tr.initOnlineListener(),tr.statusProtector.processEvent("auth/loginLifeCycleLoginSucc"),tr.afterLogin(Sr)});case 20:case"end":return lr.stop()}},ir,this)})),Ue.afterLogin=function(ir){var tr=this,ur=this;ur.socket.setSessionId&&ur.socket.setSessionId(ir.connectionId),ur.sendCmd("getNosCdnHost",{}),(typeof cr.get(ur.options,"privateConf.isMixStoreEnable")=="boolean"?ur.options.privateConf.isMixStoreEnable:jt.privateConf.isMixStoreEnable)&&er.apply(this),this.initPush instanceof Function&&this.initPush();var or=this.db;if(or.enable){var fr=this.account;this.options.appendAppKeyForDBName&&(fr+="-"+this.options.appKey),this.db.init(fr).then(function(){tr.notifyLogin(ir),tr.syncData()},function(lr){or.reset(!1);var gr=cr.get(lr,"event.target.error");tr.logger.warn("link::afterLogin: no db",gr||lr),ur.options&&ur.options.onerror&&ur.options.onerror(gr||lr),tr.notifyLogin(ir),tr.syncData()})}else this.logger.info("link::afterLogin: no db"),this.notifyLogin(ir),this.syncData()},Ue.getFileAuthToken=function(ir){var tr=this,ur=tr.mixStorePolicy.nosPolicy.authPolicy.policyType;ur!==-1?V(ur).call(ur,ir.type)<0?tr.logger.error("this type Token error not support"):ir.type!=3||ir.urls&&ir.urls.length?tr.sendCmd("getBackSourceToken",{mixAuthTokenReq:ir},function(or,fr){if(or)return tr.logger.error("getBackSourceToken error",or),or;ir.done&&ir.done(fr)}):tr.logger.error("urls is Required when type 3"):tr.logger.error("don't need token")},Ue.processAuth=function(ir){switch(ir.cmd){case"login":ir.error||(ir.content=ir.content||{},this.loginAndroidPush&&this.loginAndroidPush(ir.content.aosPushInfo||{}),ir.obj=ir.content.loginRes,this.connectionId=ir.content.loginRes.connectionId,this.onLoginPortsChange(ir,2));break;case"kicked":return void this.onKicked(ir);case"multiPortLogin":this.onLoginPortsChange(ir,ir.content.state);break;case"kick":ir.error||(ir.obj.deviceIds=ir.content.deviceIds)}},Ue.onLoginPortsChange=function(ir,tr){var ur=this,or=ir.content.loginPorts;if(or&&or.length){var fr=!0;switch(tr){case 2:fr=!0;break;case 3:fr=!1}z(or).call(or,function(lr){lr.type=qe.reverseType(lr.type),lr.customClientType&&(lr.customClientType=+lr.customClientType),lr.time=+lr.time,lr.online=fr}),(or=re(or).call(or,function(lr){return lr.connectionId!==ur.connectionId})).length&&(ur.logger.info("link::onLoginPortsChange:",or),ur.options.onloginportschange(or))}},Ue.kickedReasons=["","samePlatformKick","serverKick","otherPlatformKick","silentlyKick"],Ue.kickedMessages=["","不允许同一个帐号在多个地方同时登录","被服务器踢了","被其它端踢了","悄悄被踢"]},function(t,r,e){var n=e(60),g=e(61),y=e(816),i=e(3),k=e(23),L=e(4),$=e(781),V=e(34),z=e(2),re=e(5),oe=e(143),le=e(8),ue=e(63),ie=e(15),ae=e(11),Ie=e(824),de=e(782),Ce=e(22),Ue=e(28),qe=e(93),jt=e(37).fn,Fe=e(0),Et=e(35),cr=Fe.undef,er=Fe.objs2ids,nr=Fe.objs2accounts,dr=Fe.teams2ids,ir=e(162),tr=Fe.getGlobal(),ur=e(109).EMSyncType;jt.beforeSync=function(){var or=this.db;return or.enable?or.clearSendingMsgs():i.resolve()},jt.syncData=function(){var or=this,fr=or.db,lr=or.options,gr=fr.enable;function Sr(wr){var kr;or.syncPromiseArray=[],or.syncResult={},or.syncTeamMembersPromiseArray=[],or.syncSuperTeamMembersPromiseArray=[],or.syncTeamMembersResult={},or.checkNosReqNum=0,or.getNosOriginUrlReqNum=0,Fe.verifyBooleanWithDefault(lr,"syncRelations syncFriends syncFriendUsers syncTeams syncSuperTeams syncRoamingMsgs syncSuperTeamRoamingMsgs syncMsgReceipts syncExtraTeamInfo syncExtraSuperTeamInfo syncAvSignal",!0,"","sync::syncData"),Fe.verifyBooleanWithDefault(lr,"syncFilter syncTeamMembers syncSuperTeamMembers",!1,"","sync::syncData");var mr={};wr=wr||{},tr._nimForceSyncIM&&(or.logger.warn("sync::syncData: nimForceSyncIM"),delete wr.teams,tr._nimForceSyncIM=!1),mr.myInfo=wr.myInfo||0,mr.deleteMsgSelf=wr.deleteMsgSelf||0,mr.offlineMsgs=0,lr.syncRelations&&(mr.relations=wr.relations||0),lr.syncFriends&&(mr.friends=wr.friends||0),lr.syncFriendUsers&&(mr.friendUsers=wr.friendUsers||0),lr.syncRobots&&(mr.robots=wr.robots||0),lr.syncTeams&&(mr.teams=wr.teams||0),lr.syncSuperTeams&&(mr.superTeams=wr.superTeams||0),lr.syncStickTopSessions&&(mr.stickTopSessions=wr.stickTopSessions||0),lr.syncSessionUnread&&(mr.sessionAck=gr&&wr.sessionAck||0,mr.superTeamSessionAck=gr&&wr.superTeamSessionAck||0),lr.syncRoamingMsgs&&(mr.roamingMsgs=gr&&wr.roamingMsgs||wr.roamingMsgs||0),lr.syncSuperTeamRoamingMsgs&&(mr.superTeamRoamingMsgs=gr&&wr.superTeamRoamingMsgs||0),lr.syncMsgReceipts&&(mr.msgReceipts=wr.msgReceipts||0),lr.syncExtraTeamInfo&&(mr.myTeamMembers=wr.myTeamMembers||0),lr.syncExtraSuperTeamInfo&&(mr.myInfoInSuperTeams=wr.myInfoInSuperTeams||0),lr.syncBroadcastMsgs&&(mr.broadcastMsgs=wr.broadcastMsg||0),mr.donnop=wr.donnop||0,mr.deleteMsg=wr.deleteMsg||0,mr.deleteSuperTeamMsg=wr.deleteSuperTeamMsg||0,mr.sessionHistoryMsgsDelete=wr.sessionHistoryMsgsDelete||0,mr.netcallMsgs=0,lr.syncFilter&&(mr.filterMsgs=0),lr.syncAvSignal&&(mr.avSignal=0);var Ir=k(kr=or.onSyncData).call(kr,or);Ir.isImSyncDataCb=!0,or.logger.info("syncData:: start sync",mr),or.reporterHook.emit("reporter/syncStart"),or.sendCmd("sync",{sync:mr,isImSyncDataObj:!0},Ir)}or.syncing=!0,or.logger.log("sync::syncData: syncing = true"),gr?or.beforeSync().then(function(){return or.db.getTimetags()}).then(function(wr){Sr(wr)},function(){Sr()}):Sr(or.timetags)},jt.onSyncData=function(or){or&&(or.callFunc="sync::onSyncData",this.onCustomError("SYNC_DATA_ERROR",or))},jt.processSync=function(or){switch(this.logger.log("sync::processSync cmd: ".concat(or.cmd)),or.cmd){case"syncDone":if(or.error){var fr,lr=Fe.get(or.error,"message"),gr=Fe.get(or.error,"code");this.logger.error(L(fr="sync::processSync syncDoneError errMsg: ".concat(lr,", errCode: ")).call(fr,gr)),this.logger.error("sync::processSync disconnect because syncDone failed");var Sr=Et.syncError({errMsg:lr,errCode:gr});this.shouldReconnect=!1,this.markAllCallbackInvalid(Sr),this.notifyDisconnect(Sr)}else this.timetags.sync=or.content.timetag,this.reporterHook.emit("reporter/syncRecv"),this.onSyncDone();break;case"syncTeamMembersDone":this.onSyncTeamMembersDone();break;case"syncSuperTeamMembersDone":this.onSyncSuperTeamMembersDone()}},jt.onSyncDone=function(){var or,fr,lr,gr,Sr,wr,kr,mr,Ir,Nr,Er,sr,xr,Or,Mr,br,hr,Tr,Br,Fr,Lr,qr,Ur,Qr,vn,_n,Yr,jn,Zr,An,Jr=this,Mn=Jr.db,Bn=Mn.enable,wn=Jr.options,In=Jr.syncPromiseArray,bn=Jr.syncResult;function hn(){if(In){Jr.logger.info("sync::onSyncDone: after sync",Fe.promises2cmds(In)),In=[],fr=bn.blacklist||[],lr=bn.invalidBlacklist||[],gr=bn.mutelist||[],Sr=bn.invalidMutelist||[],wr=bn.friends,Ir=bn.myTeamMembers,Nr=bn.mySuperTeamMembers,kr=bn.invalidFriends||[],mr=bn.myInfo,Er=bn.users,xr=bn.superTeams,Mr=bn.invalidSuperTeams,sr=bn.teams,Or=bn.invalidTeams||[],br=bn.sessions||{},hr=$(V({},Jr.sessionSet)),Tr=bn.ackMap,bn.msgReceipts,Br=bn.roamingMsgs,Fr=bn.offlineMsgs,Lr=bn.offlineFilterMsgs,Ur=bn.offlineSysMsgs,Qr=bn.offlineCustomSysMsgs,vn=bn.offlineFilterSysMsgs,_n=bn.offlineFilterCustomSysMsgs,Yr=bn.sysMsgUnread,jn=bn.sessionsWithMoreRoaming,An=bn.clearServerHistoryMsgs||[];var Eo=i.resolve();(function(){if(Bn){var Ko,Wa=[Zn()];br&&z(Ko=re(br)).call(Ko,function(to){Wa.push(Mn.putSession(br[to]))}),Eo=i.all(Wa).then(function(){var to,ha=L(to=[]).call(to,y(re(Tr||{})),y(re(br||{})));ha=ie(ha).call(ha,function($a,Qa,Xo){return le(Xo).call(Xo,$a)===Qa});var ca=[];return z(ha).call(ha,function($a){var Qa,Xo=br[$a];(Xo.lastMsg||Xo.ack)&&(Qa=(Qa=Xo.ack?i.resolve(Xo):Mn.getSession(Xo.id)).then(function(ko){var ja=ko.ack||0;return Mn.getMsgCountAfterAck({shouldCountNotifyUnread:Jr.options.shouldCountNotifyUnread,sessionId:$a,ack:ja}).then(function(Da){return ko.unread=Da||0,br[$a]=Jr.mergeSession(ko),Mn.updateSession(ko)})}),ca.push(Qa))}),i.all(ca)}).then(function(){var to=[];return Jr.saveAck.p2pTeam&&to.push(Mn.updateSessionAck(Jr.saveAck.p2pTeam).catch(function(ha){return Jr.logger.error("sessionAck::syncSessionAck::updatetimetag db",ha),i.reject(ha)})),Jr.saveAck.superTeam&&to.push(Mn.updateSuperTeamSessionAck(Jr.saveAck.superTeam).catch(function(ha){return Jr.logger.error("sessionAck::syncSuperTeamSessionAck::updatetimetag db",ha),i.reject(ha)})),i.all(to)})}else if(br){var Ts,To,Os;z(Ts=[Br,Fr]).call(Ts,function(to){to&&z(to).call(to,function(ha){var ca;(To=br[ha.sessionId]).unread=To.unread||0,To.unreadMsgs=To.unreadMsgs||[],Os=To.ack||0,z(ca=ha.msgs).call(ca,function($a){if(!(Os>=$a.time))if($a.type==="notification"){var Qa;try{Qa=Jr.options.shouldCountNotifyUnread($a)}catch(Xo){throw Jr.logger.error("userOption:shouldCountNotifyUnread function error",Xo),Xo}Qa&&To.unread++}else $a.flow==="in"&&$a.isUnreadable!==!1&&(To.unread++,To.unreadMsgs.push($a))}),Jr.mergeSession(To)})})}})(),Jr.syncDonePromiseArray=Jr.syncDonePromiseArray||[],Eo.then(function(){if(Bn&&!Jr.hasSynced)(function(){wn.syncRelations&&(or=Mn.getRelations().then(function(to){fr=to[0],gr=to[1],fr.invalid=lr,gr.invalid=Sr}).catch(function(to){return to._msg="on relations error",Jr.logger.error("sync::syncRelation: ",to),i.reject(to)}),In.push(or)),wn.syncFriends&&(or=Mn.getFriends().then(function(to){(wr=to).invalid=kr}).catch(function(to){return to._msg="on friends error",Jr.logger.error("sync::syncFriends: ",to),i.reject(to)}),In.push(or)),cr(mr)&&(or=Mn.getUser(Jr.account).then(function(to){mr=to}).catch(function(to){return to._msg="on myInfo error",Jr.logger.error("sync::syncMyInfo: ",to),i.reject(to)}),In.push(or)),wn.syncFriendUsers&&(or=Mn.getFriends().then(function(to){return ae(to).call(to,function(ha){return ha.account})}).then(function(to){return Mn.getUsers({accountIds:to})}).then(function(to){Er=to}).catch(function(to){return to._msg="on users error",Jr.logger.error("sync::syncFriendUser: ",to),i.reject(to)}),In.push(or)),wn.syncTeams&&(or=Mn.getTeams().then(function(to){(sr=to).invalid=Or}).catch(function(to){return to._msg="on teams error",Jr.logger.error("sync::syncTeams: ",to),i.reject(to)}),In.push(or)),wn.syncSuperTeams&&(or=Mn.getSuperTeams().then(function(to){(xr=to).invalid=Mr}).catch(function(to){return to._msg="on superteams error",Jr.logger.error("sync::syncSuperTeams: ",to),i.reject(to)}),In.push(or)),or=Mn.getTeamMembersByAccount(Jr.account).then(function(to){Ir=to,Jr.mergeMyTeamMembers(to)}).catch(function(to){return Jr.logger.error("sync::getTeamMembersByAccount: ",to),i.reject(to)}),In.push(or),or=Mn.getSuperTeamMembersByAccount(Jr.account).then(function(to){Nr=to,Jr.mergeMySuperTeamMembers(to)}).catch(function(to){return Jr.logger.error("sync::getSuperTeamMembersByAccount: ",to),i.reject(to)}),In.push(or),or=Mn.getDonnop().then(function(to){Jr.mergeDonnop(to)}).catch(function(to){return Jr.logger.error("sync::donnop: ",to),i.reject(to)}),In.push(or),or=Mn.getAllSessions().then(function(to){br=to}).catch(function(to){return Jr.logger.error("sync::getSession: ",to),i.reject(to)}),In.push(or),or=Mn.getSysMsgUnread().then(function(to){Yr=to}).catch(function(to){return to._msg="on sysMsgUnread error",Jr.logger.error("sync::getSysMsgUnread: ",to),i.reject(to)}),In.push(or),In.push(Mn.getSessionsWithMoreRoaming().then(function(to){jn=to}))})();else{var Ko,Wa,Ts=[];z(Ko=re(br)).call(Ko,function(to){(Wa=br[to]).lastMsg&&Ts.push(Wa)}),br=oe(Ts).call(Ts,function(to,ha){return ha.updateTime-to.updateTime})}Jr.hasSynced=!0;var To=i.all(In);function Os(to){var ha;to||(Jr.syncDonePromiseSuccessCount+=1);var ca,$a=le(ha=Jr.syncDonePromiseArray).call(ha,To);$a>-1&&ue(ca=Jr.syncDonePromiseArray).call(ca,$a,1),Jr.logger.log("afterSync::syncDonePromiseHandler syncPromiseArray length: ",Jr.syncDonePromiseArray.length,"success count: ",Jr.syncDonePromiseSuccessCount),Jr.syncDonePromiseArray.length===0&&Jr.syncDonePromiseSuccessCount>0?(Jr.logger.log("onSyncDone afterSync last syncDonePromsie. Execute taskAfterSync and notifyData"),function(){Jr.logger.info("sync::onSyncDone: taskAfterSync"),function(){if(bn.deleteMsgSysMsgs){var Xo,ko={};Br&&z(Br).call(Br,function(Xn){ko[Xn.sessionId]=Xn});var ja={};Fr&&z(Fr).call(Fr,function(Xn){ja[Xn.sessionId]=Xn});var Da=Jr.api;if(z(Xo=bn.deleteMsgSysMsgs).call(Xo,function(Xn){var zo;z(zo=Xn.sysMsgs).call(zo,function(Na){var vs=Na.msg,Us=vs.sessionId;Xn.type==="roaming"&&ko[Us]?ko[Us].msgs=Da.cutMsgs(ko[Us].msgs,vs):ja[Us]&&(ja[Us].msgs=Da.cutMsgs(ja[Us].msgs,vs))})}),!Mn.enable){var Hc,Rs=L(Hc=[]).call(Hc,y(Br||[]),y(Fr||[]));z(Rs).call(Rs,function(Xn){if(Xn.msgs.length){var zo=Jr.genSessionByMsgs(Xn.msgs);Jr.cacheSyncedSession(zo),br.unshift(zo)}else{var Na=de(br).call(br,function(vs){return vs.id===Xn.sessionId});ue(br).call(br,Na,1)}});var Rn={};z(br).call(br,function(Xn){if(Rn[Xn.id]){var zo=Xn.lastMsg.time>Rn[Xn.id].lastMsg.time?Xn.lastMsg:Rn[Xn.id].lastMsg;Rn[Xn.id]=Xn,Rn[Xn.id].lastMsg=zo}else Rn[Xn.id]=Xn}),br=$(Rn),br=oe(br).call(br,function(Xn,zo){return zo.updateTime-Xn.updateTime})}}}(),Zr=Jr.syncResult.stickTopSessions||[],z(Zr).call(Zr,function(Xo){Xo.isTop===void 0&&(Xo.isTop=!0)}),z(br).call(br,function(Xo){var ko=Jr.sessionSet[Xo.id];ko&&ko.isTop&&(Xo.isTop=!0);var ja=Ie(Zr).call(Zr,function(Da){return Da.id===Xo.id});ja&&(Xo.isTop=ja.isTop)});var Qa=[Jr.deleteMsgOfflineRoaming(bn.deleteMsgSysMsgs,br)];return An&&z(An).call(An,function(Xo){Qa.push(function(ko,ja){var Da;Jr.logger.info("sync::taskAfterSync:sessionHistoryMsgsDelete ".concat(ko)),ja=ja||new Date().getTime();var Hc=ie(br).call(br,function(zo){return zo.id===ko}),Rs=Jr.getSessionInCache(ko);Da=Rs||Hc[0];var Rn=wn.rollbackClearMsgsUnread!==!1,Xn=[];return Mn.enable&&Xn.push(Mn.deleteMsgsBySessionId({sessionId:ko,end:ja})),Rn&&Da&&(Da.lastMsg=null,Da.unread=0,Da=Jr.mergeSession(Da),Mn.enable&&Xn.push(Mn.updateSession(Da))),i.all(Xn)}(Xo.sessionId,Xo.time))}),i.all(Qa)}().then(Oo,function(Qa){Jr.logger.error("taskAfterSync syncDBDataPromise error:",Qa),Qa.callFunc="sync::onSyncDone",Qa.message="taskAfterSync+notifyData 出错",Jr.onCustomError("SYNC_SESSION_ACK_ERROR",Qa)})):to?(Jr.logger.error("onSyncDone afterSync syncDonePromise Error:",to),to.callFunc="sync::onSyncDone",to.message="pullFullData 出错",Jr.onCustomError("SYNC_SESSION_ACK_ERROR",to)):Jr.logger.log("onSyncDone afterSync syncDonePromise success, wait for next syncDonePromise")}Jr.syncDonePromiseArray.length===0&&(Jr.syncDonePromiseSuccessCount=0),Jr.syncDonePromiseArray.push(To),To.then(function(){return Os()}).catch(function(to){return Os(to)})})}else Jr.logger.warn("sync::onSyncDone: after sync --no promiseArray")}function Zn(){var Eo=[];return Br&&z(Br).call(Br,function(Ko){var Wa;Eo=L(Wa=[]).call(Wa,y(Eo),y(Ko.msgs))}),Fr&&z(Fr).call(Fr,function(Ko){var Wa;Eo=L(Wa=[]).call(Wa,y(Eo),y(Ko.msgs))}),Eo.length?Mn.putMsg(Eo).then(function(){return Eo}):i.resolve(Eo)}function Oo(){Ce(Ho,0)}function Ho(){var Eo,Ko,Wa=[],Ts=[];if(fr&&fr.length&&(Jr.logger.info("sync::notifyDataAsync: on blacklist",nr(fr)),Jr.reporterHook.emit("reporter/syncItemComplete",ur.kSyncType3_8),wn.onblacklist(fr)),gr&&gr.length&&(Jr.logger.info("sync::notifyDataAsync: on mutelist",nr(gr)),wn.onmutelist(gr)),wr&&(Jr.logger.info("sync::notifyDataAsync: on friends",nr(wr)),Jr.reporterHook.emit("reporter/syncItemComplete",ur.kSyncType12_5),wn.onfriends(wr)),mr&&(Jr.logger.info("sync::notifyDataAsync: on myInfo"),Jr.myInfo=mr,Jr.reporterHook.emit("reporter/syncItemComplete",ur.kSyncType3_109),wn.onmyinfo(Fe.copy(mr))),Ir){Jr.logger.info("sync::notifyDataAsync: on myTeamMembers",Ir),Jr.reporterHook.emit("reporter/syncItemComplete",ur.kSyncType8_126);var To=Fe.simpleClone(Ir);Ue(To)||(To=[To]),wn.onMyTeamMembers(To)}if(Nr){Jr.logger.info("sync::notifyDataAsync: on mySuperTeamMembers",Nr),Jr.reporterHook.emit("reporter/syncItemComplete",ur.kSyncType21_111);var Os=Fe.simpleClone(Nr);Ue(Os)||(Os=[Os]),wn.onMySuperTeamMembers(Os)}Er&&(z(Er).call(Er,function(ko){Jr.mergeUser(ko)}),Jr.logger.info("sync::notifyDataAsync: on users",nr(Er)),Jr.reporterHook.emit("reporter/syncItemComplete",ur.kSyncType12_6),wn.onusers(Er)),sr&&(Jr.logger.info("sync::notifyDataAsync: on teams",dr(sr)),wn.onteams(sr),Jr.reporterHook.emit("reporter/syncItemComplete",ur.kSyncType8_109)),xr&&(Jr.logger.info("sync::notifyDataAsync: onSuperTeams",dr(xr)),wn.onSuperTeams(xr),Jr.reporterHook.emit("reporter/syncItemComplete",ur.kSyncType21_109)),Jr.reporterHook.emit("reporter/syncItemComplete",ur.kSyncType4_12),Jr.reporterHook.emit("reporter/syncItemComplete",ur.kSyncType4_14),Jr.reporterHook.emit("reporter/syncItemComplete",ur.kSyncType4_20),Jr.reporterHook.emit("reporter/syncItemComplete",ur.kSyncType4_21),Jr.reporterHook.emit("reporter/syncItemComplete",ur.kSyncType7_15),br&&br.length?(br=ae(br).call(br,function(ko){return Jr.mergeSession(ko),qe(ir).call(ir,ko)}),br=ie(br).call(br,function(ko){return!ko.isDeleted}),Jr.logger.info("sync::notifyDataAsync: on sessions",er(br),Fe.secureOutput("session",br)),!Bn&&Jr.timetags&&Jr.timetags.roamingMsgs?wn.onsessions(ie(hr).call(hr,function(ko){return ir.isComplete(ko)})):wn.onsessions(br)):!Bn&&hr.length&&(Jr.logger.info("sync::notifyDataAsync: on sessions",er(br),Fe.secureOutput("session",br)),wn.onsessions(ie(hr).call(hr,function(ko){return ir.isComplete(ko)}))),Zr&&Zr.length&&(Zr=ae(Zr).call(Zr,function(ko){var ja=Jr.getSessionInCache(ko.id);return ja?(ja.isTop=ko.isTop,ko=Jr.mergeSession(ja),qe(ir).call(ir,ja)):(ko=Jr.mergeSession(ko),qe(ir).call(ir,ko))}),Jr.logger.info("sync::notifyDataAsync: onStickTopSessions",er(Zr),Fe.secureOutput("session",Zr)),Jr.reporterHook.emit("reporter/syncItemComplete",ur.kSyncType4_23),wn.onStickTopSessions(Zr)),Br&&z(Br).call(Br,function(ko){ko.scene==="superTeam"?Ts.push(ko.timetag):Wa.push(ko.timetag),(Ko=ko.msgs).length&&(Jr.logger.info("sync::notifyDataAsync: on roaming msgs",ko.sessionId,Ko.length),Jr.reporterHook.emit("reporter/syncItemComplete",ur.kSyncType4_9),wn.onroamingmsgs(ko))}),Fr&&(Jr.reporterHook.emit("reporter/syncItemComplete",ur.kSyncType4_4),Jr.reporterHook.emit("reporter/syncItemComplete",ur.kSyncType4_17),z(Fr).call(Fr,function(ko){ko.scene==="superTeam"?Ts.push(ko.timetag):Wa.push(ko.timetag),(Ko=ko.msgs).length&&(Jr.logger.info("sync::notifyDataAsync: on offline msgs",ko.sessionId,Ko.length,ae(Ko).call(Ko,function(ja){return ja.idServer})),wn.onofflinemsgs(ko))})),Lr&&(Jr.reporterHook.emit("reporter/syncItemComplete",ur.kSyncType4_100),z(Lr).call(Lr,function(ko){Wa.push(ko.timetag),(Ko=ko.msgs).length&&(Jr.logger.info("sync::notifyDataAsync: on offline filter msgs",ko.sessionId,Ko.length),wn.onofflinefiltermsgs(Ko))})),jn&&(Jr.logger.info("sync::notifyDataAsync: on sessionsWithMoreRoaming",er(jn),jn),Jr.reporterHook.emit("reporter/syncItemComplete",ur.kSyncType4_22),wn.onSessionsWithMoreRoaming(jn));var to,ha=[],ca=[];bn.deleteMsgSysMsgs&&z(to=bn.deleteMsgSysMsgs).call(to,function(ko){ko.type==="roaming"?ha=L(ha).call(ha,ko.sysMsgs):ca=L(ca).call(ca,ko.sysMsgs)}),ha.length&&(qr=L(qr=qr||[]).call(qr,ha)),ca.length&&(Ur=L(Ur=Ur||[]).call(Ur,ca)),qr&&(Jr.logger.info("sync::notifyDataAsync: on roaming sys msgs",qr.length),Jr.reporterHook.emit("reporter/syncItemComplete",ur.kSyncType4_19),Jr.reporterHook.emit("reporter/syncItemComplete",ur.kSyncType4_15),wn.onroamingsysmsgs(qr)),Ur&&(Jr.logger.info("sync::notifyDataAsync: on offline sys msgs",Ur.length),wn.onofflinesysmsgs(Ur)),vn&&(Jr.logger.info("sync::notifyDataAsync: on offline filter sys msgs",vn.length),wn.onofflinefiltersysmsgs(vn)),Qr&&(Jr.logger.info("sync::notifyDataAsync: on offline custom sys msgs",Qr.length),Jr.reporterHook.emit("reporter/syncItemComplete",ur.kSyncType4_6),Jr.reporterHook.emit("reporter/syncItemComplete",ur.kSyncType4_18),wn.onofflinecustomsysmsgs(Qr)),_n&&(Jr.logger.info("sync::notifyDataAsync: on offline filter custom sys msgs",_n.length),Jr.reporterHook.emit("reporter/syncItemComplete",ur.kSyncType4_101),wn.onofflinefiltercustomsysmsgs(_n)),Yr&&(Yr=Fe.merge({},Jr.sysMsgUnread,Yr),Jr.sysMsgUnread=Fe.merge({},Yr),Jr.logger.info("sync::notifyDataAsync: on sysMsgUnread",Yr),Jr.reporterHook.emit("reporter/syncItemComplete",ur.kSyncType4_6),wn.onsysmsgunread(Yr));var $a=Jr.getPushNotificationMultiportConfig();Jr.logger.info("sync::notifyDataAsync: on pushNotificationMultiportConfig",$a),Jr.reporterHook.emit("reporter/syncItemComplete",ur.kSyncType4_13),wn.onPushNotificationMultiportConfig($a);var Qa=Ts.length&&Math.max.apply(Math,Ts);if(Eo=Wa.length&&Math.max.apply(Math,Wa),Mn.enable){var Xo=[];Qa&&Xo.push(Jr.db.updateSuperTeamRoamingMsgTimetag(Qa)),Eo&&Xo.push(Jr.db.updateRoamingMsgTimetag(Eo)),i.all(Xo).then(Do).catch(Do)}else Jr.timetags.superTeamRoamingMsgs=Qa,Jr.timetags.roamingMsgs=Eo||Jr.timetags.roamingMsgs,Do();Jr.syncPromiseArray=[],Jr.syncResult={}}function Do(){Jr.processUnsettledMsgs(),Jr.msgPromise.then(function(){Jr.canHandleDeletedMsgInSyncing=!0,Ce(function(){Jr.processUnsettledSysMsgs()},0)}),Jr.syncing&&wn.onsyncdone(),Jr.syncing=!1,Jr.logger.log("sync::onsyncdone: syncing = false"),Jr.reporterHook.emit("reporter/syncComplete"),Mn.enable&&wn.syncTeamMembers&&Jr.syncTeamMembers(sr),Mn.enable&&wn.syncSuperTeamMembers&&Jr.syncSuperTeamMembers(xr)}In&&In.length?i.all(In).then(hn).catch(function(Eo){hn(),Jr.logger.error(Eo),Eo.callFunc="sync::onSyncDone",Eo.message="afterSync syncNormalPromise 出错",Jr.onCustomError("SYNC_promiseArray_ERROR",Eo)}):hn()},jt.syncTeamMembers=function(){var or=g(n.mark(function fr(lr){var gr,Sr,wr,kr,mr,Ir,Nr,Er;return n.wrap(function(sr){for(;;)switch(sr.prev=sr.next){case 0:if(Sr=(gr=this).db,wr={},!Sr.enable){sr.next=33;break}return sr.prev=4,sr.next=7,Sr.getTeamMemberTimetags();case 7:Ir=sr.sent,sr.next=14;break;case 10:sr.prev=10,sr.t0=sr.catch(4),gr.logger.error("sync::syncTeamMembers: getTeamMemberTimetags error",sr.t0),Ir={};case 14:if(Ue(lr)){sr.next=25;break}return sr.prev=15,sr.next=18,Sr.getTeams();case 18:lr=sr.sent,sr.next=25;break;case 21:sr.prev=21,sr.t1=sr.catch(15),gr.logger.error("sync::syncTeamMembers: getTeams error",sr.t1),lr=[];case 25:z(lr).call(lr,function(xr){wr[xr.teamId]=0}),Nr={},z(kr=re(Ir)).call(kr,function(xr){var Or=xr.split("-")[1];Nr[Or]=Ir[xr]}),re(Nr).length&&(wr=V(wr,Nr)),gr.logger.log("sync::syncTeamMembers: getTeamMemberTimetags",wr),(Er=k(mr=gr.onSyncTeamMembers).call(mr,gr)).isImSyncDataCb=!0,gr.sendCmd("syncTeamMembers",{sync:wr,isImSyncDataObj:!0},Er);case 33:case"end":return sr.stop()}},fr,this,[[4,10],[15,21]])}));return function(fr){return or.apply(this,arguments)}}(),jt.syncSuperTeamMembers=function(){var or=g(n.mark(function fr(lr){var gr,Sr,wr,kr,mr,Ir,Nr,Er;return n.wrap(function(sr){for(;;)switch(sr.prev=sr.next){case 0:if(Sr=(gr=this).db,wr={},!Sr.enable){sr.next=33;break}return sr.prev=4,sr.next=7,Sr.getSuperTeamMemberTimetags();case 7:Ir=sr.sent,sr.next=14;break;case 10:sr.prev=10,sr.t0=sr.catch(4),gr.logger.error("sync::syncSuperTeamMembers: getSuperTeamMemberTimetags error",sr.t0),Ir={};case 14:if(Ue(lr)){sr.next=25;break}return sr.prev=15,sr.next=18,Sr.getSuperTeams();case 18:lr=sr.sent,sr.next=25;break;case 21:sr.prev=21,sr.t1=sr.catch(15),gr.logger.error("sync::syncSuperTeamMembers: getSuperTeams error",sr.t1),lr=[];case 25:z(lr).call(lr,function(xr){wr[xr.teamId]=0}),Nr={},z(kr=re(Ir)).call(kr,function(xr){var Or=xr.split("-")[1];Nr[Or]=Ir[xr]}),re(Nr).length&&(wr=V(wr,Nr)),gr.logger.log("sync::syncSuperTeamMembers: getSuperTeamMemberTimetags",wr),(Er=k(mr=gr.syncSuperTeamMembersCallBack).call(mr,gr)).isImSyncDataCb=!0,gr.sendCmd("syncSuperTeamMembers",{sync:wr,isImSyncDataObj:!0},Er);case 33:case"end":return sr.stop()}},fr,this,[[4,10],[15,21]])}));return function(fr){return or.apply(this,arguments)}}(),jt.onSyncTeamMembers=function(or){or&&(or.callFunc="sync::onSyncTeamMembers",or.message="同步群成员错误",this.onCustomError("SYNC_TEAM_MEMBERS_ERROR",or))},jt.syncSuperTeamMembersCallBack=function(or){or&&(or.callFunc="sync::SyncSuperTeamMembersCallBack",or.message="同步超级群成员错误",this.onCustomError("SYNC_SUPERTEAM_MEMBERS_ERROR",or))},jt.onSyncTeamMembersDone=function(){var or=this,fr=or.options,lr=or.syncTeamMembersResult,gr=or.syncTeamMembersPromiseArray;i.all(gr).then(function(){var Sr;gr=[];var wr={};z(Sr=re(lr)).call(Sr,function(kr){var mr,Ir,Nr,Er;le(kr).call(kr,"invalid")===-1&&(kr in wr?(L(mr=wr[kr].members).call(mr,lr[kr]),L(Ir=wr[kr].invalid).call(Ir,lr[kr+"-invalid"])):wr[kr]={members:L(Nr=[]).call(Nr,lr[kr]||[]),invalid:L(Er=[]).call(Er,lr[kr+"-invalid"]||[])})}),fr.onsyncteammembersdone(wr),or.syncTeamMembersResult=[],or.syncTeamMembersPromiseArray=[]})},jt.onSyncSuperTeamMembersDone=function(){var or=this,fr=or.options,lr=or.syncSuperTeamMembersResult,gr=or.syncSuperTeamMembersPromiseArray;i.all(gr).then(function(){var Sr;gr=[];var wr={};z(Sr=re(lr)).call(Sr,function(kr){var mr,Ir,Nr,Er;le(kr).call(kr,"invalid")===-1&&(kr in wr?(L(mr=wr[kr].members).call(mr,lr[kr]),L(Ir=wr[kr].invalid).call(Ir,lr[kr+"-invalid"])):wr[kr]={members:L(Nr=[]).call(Nr,lr[kr]||[]),invalid:L(Er=[]).call(Er,lr[kr+"-invalid"]||[])})}),fr.onsyncsuperteammembersdone(wr),or.syncSuperTeamMembersResult=[],or.syncSuperTeamMembersPromiseArray=[]})}},function(t,r,e){var n=e(817),g=e(818),y=e(314),i=e(819);t.exports=function(k){return n(k)||g(k)||y(k)||i()},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,r,e){var n=e(313),g=e(316);t.exports=function(y){if(n(y))return g(y)},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,r,e){var n=e(158),g=e(64),y=e(315);t.exports=function(i){if(n!==void 0&&g(i)!=null||i["@@iterator"]!=null)return y(i)},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,r){t.exports=function(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,r,e){var n=e(821);t.exports=n},function(t,r,e){e(822);var n=e(14);t.exports=n.Object.values},function(t,r,e){var n=e(1),g=e(823).values;n({target:"Object",stat:!0},{values:function(y){return g(y)}})},function(t,r,e){var n=e(29),g=e(13),y=e(124),i=e(47),k=g(e(157).f),L=g([].push),$=function(V){return function(z){for(var re,oe=i(z),le=y(oe),ue=le.length,ie=0,ae=[];ue>ie;)re=le[ie++],n&&!k(oe,re)||L(ae,V?[re,oe[re]]:oe[re]);return ae}};t.exports={entries:$(!0),values:$(!1)}},function(t,r,e){t.exports=e(825)},function(t,r,e){var n=e(826);t.exports=n},function(t,r,e){var n=e(18),g=e(827),y=Array.prototype;t.exports=function(i){var k=i.find;return i===y||n(y,i)&&k===y.find?g:k}},function(t,r,e){e(828);var n=e(27);t.exports=n("Array").find},function(t,r,e){var n=e(1),g=e(69).find,y=e(163),i=!0;"find"in[]&&Array(1).find(function(){i=!1}),n({target:"Array",proto:!0,forced:i},{find:function(k){return g(this,k,arguments.length>1?arguments[1]:void 0)}}),y("find")},function(t,r,e){var n=e(830);t.exports=n},function(t,r,e){var n=e(18),g=e(831),y=Array.prototype;t.exports=function(i){var k=i.findIndex;return i===y||n(y,i)&&k===y.findIndex?g:k}},function(t,r,e){e(832);var n=e(27);t.exports=n("Array").findIndex},function(t,r,e){var n=e(1),g=e(69).findIndex,y=e(163),i=!0;"findIndex"in[]&&Array(1).findIndex(function(){i=!1}),n({target:"Array",proto:!0,forced:i},{findIndex:function(k){return g(this,k,arguments.length>1?arguments[1]:void 0)}}),y("findIndex")},function(t,r,e){var n=e(11),g=e(10),y=e(3),i=e(2),k=e(37).fn,L=e(0),$=L.objs2accounts,V=e(834),z=e(208);k.processUser=function(re){var oe,le=this,ue=le.db,ie=re.obj,ae=re.error,Ie=re.content;switch(re.cmd){case"markInBlacklist":ae||le.markInBlacklist(ie);break;case"syncMarkInBlacklist":le.markInBlacklist(Ie,!0);break;case"markInMutelist":ae||le.markInMutelist(ie);break;case"syncMarkInMutelist":le.markInMutelist(Ie,!0);break;case"getRelations":ae||le.onRelations(re);break;case"syncMyInfo":le.onMyInfo(re,!0);break;case"updateMyInfo":ae||(ie.user.updateTime=Ie.timetag,le.onUpdateMyInfo(re,ie.user));break;case"syncUpdateMyInfo":le.onUpdateMyInfo(re,Ie.user,!0);break;case"getUsers":var de;ae||(oe=n(de=Ie.users).call(de,function(Ce){return Ce=g(z).call(z,Ce,le.mixStorePolicy&&le.mixStorePolicy.s3Policy?le.mixStorePolicy.s3Policy.dlcdns:[],le.mixStorePolicy&&le.mixStorePolicy.s3Policy?le.mixStorePolicy.s3Policy.dlcdn:""),le.mergeUser(Ce),Ce}),re.obj=oe,ue.enable&&ue.putUsers(oe));break;case"updateDonnop":le.onUpdateDonnop(re);break;case"syncUpdateDonnop":le.onDonnop(re,!1)}},k.onMyInfo=function(re){var oe,le=this,ue=le.db,ie=re.error,ae=re.content,Ie=new y(function(Ce,Ue){var qe,jt;ie?(ie&&(ie.callFunc="user::onMyInfo"),Ce(ie),le.syncData()):(oe=g(z).call(z,ae.user),ue.enable?(qe=Ce,jt=Ue,ue.mergeMyInfo(oe,!0).then(function(){de(),qe()}).then(void 0,function(Fe){Fe.message="db.mergeMyInfo error",Fe.callFunc="user::onMyInfo",jt(Fe)})):(de(),Ce()))}).catch(function(Ce){return le.logger.error("user::onMyInfo: ",Ce),y.reject(Ce)});function de(){le.timetags.myInfo=oe.updateTime,le.syncResult.myInfo=oe}Ie.cmd="myInfo",le.syncPromiseArray.push(Ie)},k.onUpdateMyInfo=function(re,oe,le){var ue=this.db,ie=g(z).call(z,oe),ae=L.merge(this.myInfo,ie);this.myInfo=ae,le?(this.logger.info("user::onUpdateMyInfo:",ae&&ae.account),this.options.onupdatemyinfo(ae)):re.obj=ae,ue.enable&&(ie.account=this.account,ue.updateUser(ie))},k.onRelations=function(re){var oe,le=this,ue=le.db,ie=re.error,ae=le.packetFromSync(re),Ie=re.content.specialRelations,de=!0,Ce=[],Ue=[],qe=[],jt=[],Fe=new y(function(cr,er){var nr,dr;ie?ae&&(cr(ie),le.syncData()):(i(Ie).call(Ie,function(ir){var tr={account:(ir=V.parse(ir)).account,createTime:ir.createTime,updateTime:ir.updateTime};ir.isBlacked?Ce.push(tr):Ue.push(tr),ir.isMuted?qe.push(tr):jt.push(tr)}),le.logger.info("user::onRelations: parse blacklist",$(Ce),Ce,"delete",$(Ue),Ue),le.logger.info("user::onRelations: parse mutelist",$(qe),qe,"delete",$(jt),jt),Ie.length?(de=!0,oe=re.content.timetag):de=!1,ue.enable?(nr=cr,dr=er,re.promise=new y(function(ir,tr){function ur(){ae?(Et(),ir(),nr()):ue.getRelations().then(function(or){Ce=or[0],qe=or[1],Et(),ir(),nr()}).then(void 0,function(or){or.message="db.getRelations error",or.callFunc="user::onRelations",tr(or),dr(or)})}de?ue.mergeRelations(Ce,Ue,qe,jt,oe).then(function(){ur()}).then(void 0,function(or){or.message="db.mergeRelations error",or.callFunc="user::onRelations",tr(or),dr(or)}):(le.logger.warn("user::onRelations: no relations need merge"),ur())}).then(void 0,function(ir){throw ir.message="merge relations data error",ir.callFunc="user::onRelations",dr(ir),ir})):(Et(),cr()))}).catch(function(cr){return le.logger.error("user::onRelations: ",cr),y.reject(cr)});function Et(){le.timetags.relations=oe,Ce.invalid=Ue,qe.invalid=jt,ae?(le.syncResult.blacklist=Ce,le.syncResult.mutelist=qe,le.syncResult.invalidBlacklist=Ue,le.syncResult.invalidMutelist=jt):(le.logger.info("user::onRelations: get relations",Ce,qe),re.obj.blacklist=Ce,re.obj.mutelist=qe)}ae&&(Fe.cmd="relations",le.syncPromiseArray.push(Fe))},k.markInBlacklist=function(re,oe){var le=this.db;re.record={account:re.account,updateTime:+new Date},le.enable&&le.markInBlacklist(re),oe&&(this.logger.info("user::markInBlacklist:",re),this.options.onsyncmarkinblacklist(re))},k.markInMutelist=function(re,oe){var le=this.db;re.record={account:re.account,updateTime:+new Date},le.enable&&le.markInMutelist(re),oe&&(this.logger.info("user::markInMutelist:",re),this.options.onsyncmarkinmutelist(re))},k.mergeUser=function(re){this.userSet[re.account]=re}},function(t,r,e){var n=e(0);function g(){}g.parse=function(y){var i=n.copy(y);return i.isBlacked=i.isBlacked==="1",i.isMuted=i.isMuted==="1",i.createTime=+i.createTime,i.updateTime=+i.updateTime,i},t.exports=g},function(t,r,e){var n=e(127),g=e(2),y=e(10),i=e(3),k=e(4),L=e(11),$=["type"],V=e(37).fn,z=e(0),re=z.objs2accounts,oe=e(783),le=e(208);V.processFriend=function(ue){var ie=ue.obj,ae=ue.content,Ie=ue.error;switch(ue.cmd){case"friendRequest":this.updateFriendSysMsg(ue),Ie||this.onFriendRequest(ie);break;case"syncFriendRequest":this.onFriendRequest(ae,!0);break;case"deleteFriend":Ie||this.onDeleteFriend(ie);break;case"syncDeleteFriend":this.onDeleteFriend(ae,!0);break;case"updateFriend":Ie||this.onUpdateFriend(ie);break;case"syncUpdateFriend":this.onUpdateFriend(ae.friend,!0);break;case"getFriends":this.getFriends(ue);break;case"syncFriends":this.onFriends(ue);break;case"syncFriendUsers":this.onFriendUsers(ue)}},V.getFriends=function(ue){var ie=ue.content.friends,ae=[],Ie=[];g(ie).call(ie,function(de){(de=y(oe).call(oe,de)).valid?ae.push(de):Ie.push(de)}),ae.invalid=Ie,ue.obj=ae},V.onFriends=function(ue){var ie,ae=this,Ie=ae.db,de=ue.error,Ce=ue.content.friends,Ue=!0,qe=[],jt=[],Fe=new i(function(cr,er){var nr,dr;de?er(de):(function(){Ue&&g(Ce).call(Ce,function(ir){(ir=y(oe).call(oe,ir)).valid?qe.push(ir):jt.push(ir)}),ae.logger.info("friend::onFriends: parse friends",re(qe),"delete",re(jt)),Ce.length?(Ue=!0,ie=ue.content.timetag):Ue=!1}(),Ie.enable?(nr=cr,dr=er,ue.promise=new i(function(ir,tr){function ur(){Et(),ir(),nr()}Ue?Ie.mergeFriends(qe,jt,ie).then(function(){ur()}).then(void 0,function(or){or._msg="merge friends error",tr(or),dr(or)}):(ae.logger.info("friend::onFriends: no merge friends"),ur())}).then(void 0,function(ir){throw ir._msg="merge friends data error",dr(ir),ir})):(Et(),cr()))}).catch(function(cr){return ae.logger.error("friend::onFriends: ",cr),i.reject(cr)});function Et(){var cr,er;ae.timetags.friends=ie,qe.invalid=jt,ae.syncResult.friends=k(cr=ae.syncResult.friends||[]).call(cr,qe||[]),ae.syncResult.invalidFriends=k(er=ae.syncResult.invalidFriends||[]).call(er,jt||[])}Fe.cmd="friends",ae.syncPromiseArray.push(Fe)},V.onFriendRequest=function(ue,ie){var ae=i.resolve(),Ie=this.db,de=ue.type,Ce=n(ue,$);if((de=ue.type=oe.getTypeFromByte(de)||de)==="addFriend"||de==="passFriendApply"){var Ue=ue.friend=oe.assembleFriend(Ce);Ie.enable&&(ae=Ie.putFriend(Ue))}return ie&&this.onSyncFriendAction(ue),ae},V.onSyncFriendAction=function(ue){this.logger.info("friend::onSyncFriendActionon: ".concat(ue.type,", "),ue.account),this.options.onsyncfriendaction(ue)},V.onDeleteFriend=function(ue,ie){var ae=i.resolve(),Ie=this.db;return Ie.enable&&(ae=Ie.deleteFriend(ue.account)),ie&&(ue.type="deleteFriend",this.onSyncFriendAction(ue)),ae},V.onUpdateFriend=function(ue,ie){var ae=this.db,Ie=y(oe).call(oe,ue);ae.enable&&ae.updateFriend(Ie),ie&&this.onSyncFriendAction({type:"updateFriend",friend:Ie})},V.onFriendUsers=function(ue){var ie,ae,Ie=this.db,de=ue.content,Ce=L(ie=de.users).call(ie,function(jt){return y(le).call(le,jt)});this.logger.info("friend::onFriendUsers: parse users",re(Ce));var Ue=de.timetag,qe=i.resolve();Ie.enable&&(qe=Ie.mergeFriendUsers(Ce,Ue)),this.timetags.friendUsers=Ue,qe.cmd="friendUsers",this.syncPromiseArray.push(qe),this.syncResult.users=k(ae=this.syncResult.users||[]).call(ae,Ce||[]),this.syncing||this.onSyncDone()},V.updateFriendSysMsg=function(ue){var ie,ae,Ie=ue.obj,de=ue.error;if(ue.obj.idServer){if(de)ie="error",de=z.filterObj(de,"code message");else{var Ce=Ie.type;switch(Ce=oe.getTypeFromByte(Ce)||Ce){case"passFriendApply":ie="passed";break;case"rejectFriendApply":ie="rejected"}}ae={idServer:Ie.idServer,state:ie,from:Ie.account,type:"applyFriend"},de&&(ae.error=de),this.updateSysMsg(ae)}}},function(t,r,e){var n=e(28),g=e(15),y=e(37).fn,i=e(0);y.onRobots=function(k){var L=k.content;if(i.isFunction(this.options.onrobots)&&n(L.robots)){var $,V=g($=L.robots).call($,function(z){return!!z.botid});V.length>0&&this.options.onrobots(V||[])}}},function(t,r,e){var n=e(60),g=e(61),y=e(10),i=e(2),k=e(22),L=e(121),$=e(3),V=e(11),z=e(4),re=e(15),oe=e(5),le=e(37).fn,ue=e(0),ie=ue.objs2accounts,ae=ue.teams2ids,Ie=e(198),de=e(160);le.processTeam=function(Ce){var Ue,qe,jt,Fe=Ce.error;switch(Ce.obj===void 0&&(Ce.obj={}),Ce.cmd){case"createTeam":Ue=Ce.obj.team,Fe||(Ue=Ce.content.team),Ue=y(Ie).call(Ie,Ue),Ce.obj.team=Ue,jt=de.assembleOwner(Ue),Ce.obj.owner=jt,Fe||(this.logger.info("team::processTeam: create team ",Ue&&Ue.teamId,jt&&jt.account),this.onCreateTeam(Ue,jt));break;case"syncCreateTeam":Ue=y(Ie).call(Ie,Ce.content.team),jt=de.assembleOwner(Ue),this.logger.info("team::processTeam: sync createTeam",Ue&&Ue.teamId,jt&&jt.account),this.options.onsynccreateteam(Ue,jt),this.onCreateTeam(Ue,jt);break;case"sendSuperTeamMsg":case"sendTeamMsg":this.onSendMsg(Ce);break;case"teamMsg":this.onMsg(Ce);break;case"teamMsgs":this.onMsgs(Ce);break;case"addTeamMembers":case"removeTeamMembers":case"leaveTeam":case"dismissTeam":case"addTeamManagers":case"removeTeamManagers":case"transferTeam":break;case"updateInfoInTeam":Fe||(Ce.promise=this.onUpdateInfoInTeam(Ce));break;case"updateNickInTeam":Ce.obj=y(de).call(de,Ce.obj);break;case"updateTeam":Ce.obj=y(Ie).call(Ie,Ce.obj,!0);break;case"applyTeam":Ce.error||(Ce.obj=y(Ie).call(Ie,Ce.content.team));break;case"passTeamApply":this.updateTeamSysMsgState(Ce,"passed");break;case"rejectTeamApply":this.updateTeamSysMsgState(Ce,"rejected");break;case"acceptTeamInvite":this.updateTeamSysMsgState(Ce,"passed"),Ce.error||(Ce.obj=y(Ie).call(Ie,Ce.content.team));break;case"rejectTeamInvite":this.updateTeamSysMsgState(Ce,"rejected");break;case"getTeam":Ce.error||(Ce.obj=y(Ie).call(Ie,Ce.content.team));break;case"getTeams":this.onTeams(Ce);break;case"getTeamMembers":this.onTeamMembers(Ce);break;case"syncTeams":this.onTeams(Ce);break;case"syncTeamMembers":this.onTeamMembers(Ce);break;case"getTeamHistoryMsgs":case"searchTeamHistoryMsgs":this.onHistoryMsgs(Ce);break;case"syncSendTeamMsg":this.onMsg(Ce);break;case"notifyTeamMsgReads":this.onTeamMsgReceipt(Ce);break;case"syncUpdateTeamMember":(qe=y(de).call(de,Ce.content.teamMember)).account===this.account&&this.mergeMyTeamMembers(qe),this.onUpdateTeamMember(qe);break;case"updateMuteStateInTeam":break;case"getMyTeamMembers":Ce.error||(Ce.obj=de.reverseMembers(Ce.content.teamMembers));break;case"getMutedTeamMembers":Ce.error||(Ce.obj={teamId:Ce.obj.teamId,members:de.reverseMembers(Ce.content.teamMembers)});break;case"syncMyTeamMembers":this.onSyncMyTeamMembers(Ce);break;case"sendTeamMsgReceipt":this.sendTeamMsgReceipt(Ce);break;case"getTeamMsgReads":this.getTeamMsgReads(Ce);break;case"getTeamMsgReadAccounts":this.getTeamMsgReadAccounts(Ce);break;case"getTeamsById":this.getTeamsById(Ce)}},le.onUpdateInfoInTeam=function(){var Ce=g(n.mark(function Ue(qe){var jt,Fe,Et;return n.wrap(function(cr){for(;;)switch(cr.prev=cr.next){case 0:if(jt=this,!(qe.content&&qe.content.teamMember&&qe.content.teamMember.teamId)){cr.next=11;break}if(Fe=y(de).call(de,qe.content.teamMember),!jt.db.enable){cr.next=7;break}return cr.next=6,jt.db.updateTeamMember(Fe);case 6:Fe=cr.sent;case 7:return jt.mergeMyTeamMembers(Fe),jt.onUpdateTeamMember(Fe),qe.obj=Fe,cr.abrupt("return");case 11:if((Et=qe.obj.teamMember?qe.obj.teamMember:qe.obj).account=jt.account,Et.account){cr.next=15;break}return cr.abrupt("return");case 15:Et.id=de.genId(Et.teamId,Et.account),Et=y(de).call(de,Et),jt.mergeMyTeamMembers(Et),qe.obj=jt.myTeamMembersMap&&jt.myTeamMembersMap[Et.teamId]||Et,jt.onUpdateTeamMember(Et);case 20:case"end":return cr.stop()}},Ue,this)}));return function(Ue){return Ce.apply(this,arguments)}}(),le.getTeamMsgReads=function(Ce){var Ue=this;if(Ce.error)this.logger.error("team::sendTeamMsgReceipt: ",Ce.error);else{var qe=ue._get(Ce,"content.teamMsgReceipts")||[];if(this.db.enable){var jt=[];i(qe).call(qe,function(Fe){Fe.idClient&&jt.push({idClient:Fe.idClient,unread:+Fe.unread,read:+Fe.read})}),jt.length>0&&k(function(){return Ue.db.updateMsgBatch(jt)},0)}}},le.getTeamMsgReadAccounts=function(Ce){if(Ce.error)this.logger.error("team::getTeamMsgReadAccounts: ",Ce.error);else{var Ue=ue._get(Ce,"content.readAccounts")||[],qe=ue._get(Ce,"content.unreadAccounts")||[],jt=ue._get(Ce,"content.teamMsgReceipt.idClient")||[];this.db.enable&&this.db.putMsgReadDetail({idClient:jt,readAccounts:Ue,unreadAccounts:qe})}},le.sendTeamMsgReceipt=function(Ce){var Ue=this;if(Ce.error)this.logger.error("team::sendTeamMsgReceipt: ",Ce.error);else{var qe=ue._get(Ce,"obj.teamMsgReceipts")||[],jt=ue._get(Ce,"content.teamMsgReceipts")||[];if(this.db.enable){var Fe=[];i(qe).call(qe,function(Et){L(jt).call(jt,function(cr){return Et.idServer===cr.idServer})||Fe.push({idClient:Et.idClient,hasRead:!0})}),Fe.length>0&&(this.logger.log("sendTeamMsgReceipt::updateMsgBatch"),k(function(){return Ue.db.updateMsgBatch(Fe)},0))}}},le.onCreateTeam=function(Ce,Ue){var qe=this.db;qe.enable&&(qe.putTeam(Ce),qe.putTeamMembers(Ue)),this.options.onCreateTeam(Ce,Ue)},le.onTeams=function(Ce){Ce.content=Ce.content||{};var Ue,qe=this,jt=qe.db,Fe=qe.packetFromSync(Ce),Et=Ce.content.teams||[],cr=!0,er=[],nr=[];if(Ce.error)switch(Ce.error.code){case 803:Ce.error=null,cr=!1}var dr=new $(function(tr,ur){var or,fr;Ce.error?Fe&&ur(Ce.error):(function(){cr&&i(Et).call(Et,function(lr){(lr=y(Ie).call(Ie,lr)).validToCurrentUser?er.push(lr):nr.push(lr)}),Et.length?(cr=!0,Ue=Ce.content.timetag):cr=!1}(),jt.enable?(or=tr,fr=ur,Ce.promise=new $(function(lr,gr){function Sr(){Fe?(ir(),lr(),or()):jt.getTeams().then(function(wr){er=wr,ir(),lr(),or()}).catch(function(wr){wr.message="db.getTeams error",wr.callFunc="team::afterMergeData",gr(wr),fr(wr)})}cr?jt.mergeTeams(er,nr,Ue).then(function(){Sr()}).catch(function(wr){var kr={callFunc:"team::onTeams:mergeData",message:"db.mergeTeams error",event:wr};gr(kr),fr(kr)}):(qe.logger.warn("team::onTeams:mergeData: no teams need merge"),Sr())}).then(void 0,function(lr){throw lr.message="merge teams data error",lr.callFunc="team::mergeData",fr(lr),lr})):(ir(),tr()))}).catch(function(tr){return qe.logger.error("team::onTeams: ",tr),$.reject(tr)});function ir(){qe.timetags.teams=Ue,er.invalid=nr,Fe?(qe.syncResult.teams=er,qe.syncResult.invalidTeams=nr,qe.syncing||qe.onSyncDone()):(qe.logger.info("team::onTeams: not in syncing, get teams",ae(er)),Ce.obj=er)}Fe&&(dr.cmd="teams",qe.syncPromiseArray.push(dr))},le.getTeamsById=function(Ce){var Ue;if(Ce.error){if(Ce.error.code!==816)return;this.logger.error("team::getTeamsById: ",Ce.error),Ce.error=null}Ce.content.teams=V(Ue=Ce.content.teams).call(Ue,function(qe){return y(Ie).call(Ie,qe)}),Ce.obj=Ce.content},le.onTeamMembers=function(Ce){Ce.content=Ce.content||{};var Ue,qe=this,jt=qe.db,Fe=qe.packetFromSync(Ce),Et=Ce.content.members||[],cr=!0,er=[],nr=[];if(Ce.obj&&(Ue=Ce.obj.teamId),Ue||(Ue=Ce.content.teamId),Ue=""+Ue,Ce.error)switch(Ce.error.code){case 406:Ce.error=null,cr=!1}var dr=new $(function(ir,tr){Ce.error?(qe.logger.error("team::onTeamMember: team error:",Ue,Ce.error),ir()):(function(){cr&&i(Et).call(Et,function(ur){(ur=y(de).call(de,ur)).valid?er.push(ur):nr.push(ur)}),Et.length?(cr=!0,Ce.content.timetag):cr=!1}(),function(ur,or){if(Fe){qe.syncTeamMembersResult[Ue]=er,qe.syncTeamMembersResult[Ue+"-invalid"]=nr;var fr=z(er).call(er,nr);jt.putTeamMembers(fr).catch(function(lr){throw qe.logger.error("team::onTeamMembers: putTeamMembers error: ",lr),lr}).then(function(){return jt.updateTeamMemberTimetag(Ue,Ce.content.timetag)}).catch(function(lr){qe.logger.error("team::onTeamMembers error: ",lr,Ue,Ce.content.timetag)}).then(ur)}else qe.logger.info("team::onTeamMembers: not syncing, get members",Ue,ie(er)),Ce.obj={teamId:Ue,members:er},ur()}(ir))});Fe&&(dr.cmd=Ue,qe.syncTeamMembersPromiseArray.push(dr))},le.onUpdateTeamMember=function(Ce){if(Ce.updateTime||(Ce.updateTime=+new Date),this.account===Ce.account){var Ue=this.myTeamMembersMap[Ce.teamId];this.logger.info("team::onMyTeamMembers: ",[Ue]),Ce=Ue||Ce,this.options.onMyTeamMembers(ue.simpleClone([Ue]))}this.logger.info("team::onUpdateTeamMember: ",Ce&&Ce.account),this.options.onupdateteammember(ue.simpleClone(Ce));var qe={teamId:Ce.teamId,memberUpdateTime:Ce.updateTime};this.onUpdateTeam(qe);var jt=this.db;jt.enable&&jt.updateTeamMember(Ce)},le.onUpdateTeam=function(Ce){this.logger.info("team::onUpdateTeam:",Ce&&Ce.teamId),this.options.onUpdateTeam(ue.simpleClone(Ce));var Ue=this.db;Ue.enable&&Ue.updateTeam(Ce)},le.onSyncMyTeamMembers=function(Ce){var Ue=this,qe=Ue.db,jt=de.reverseMembers(Ce.content.teamMembers);if(qe.enable){var Fe=qe.putTeamMembers(jt).then(function(){return qe.updateMyTeamMembersTimetag(Ce.content.timetag)}).catch(function(Et){return Ue.logger.error("team::syncMyTeamMember: ",Et),$.reject(Et)});Fe.cmd="myTeamMembers",Ue.syncTeamMembersPromiseArray.push(Fe),Ue.syncPromiseArray.push(Fe)}else Ue.syncResult.myTeamMembers=jt;Ue.mergeMyTeamMembers(jt)},le.mergeMyTeamMembers=function(Ce){ue.isArray(Ce)||(Ce=[Ce]);var Ue=this.myTeamMembersMap=this.myTeamMembersMap||{};i(Ce).call(Ce,function(qe){var jt=qe.teamId;Ue[jt]=ue.merge(Ue[jt],qe)})},le.notifyForNewTeamMsg=function(Ce){ue.isArray(Ce)||(Ce=[Ce]);var Ue=this,qe=this.myTeamMembersMap||{},jt={},Fe=[];i(Ce).call(Ce,function(cr){ue.exist(qe[cr])?jt[cr]=qe[cr].muteNotiType:Fe.push(cr)});var Et=$.resolve({map:jt});return Fe.length&&(Et=Ue.api.getMyTeamMembers({teamIds:Fe,promise:!0}).then(function(cr){Ue.mergeMyTeamMembers(cr),i(cr).call(cr,function(nr){jt[nr.teamId]=nr.muteNotiType});var er=re(Ce).call(Ce,function(nr){return!jt[nr]});return $.resolve({map:jt,miss:er})}).catch(function(cr){return oe(jt).length>0?$.resolve({map:jt,miss:Fe,error:cr}):$.reject(cr)})),Et},le.updateTeamSysMsgState=function(Ce,Ue){var qe,jt=Ce.error;jt&&(Ue="error",jt=ue.filterObj(jt,"code message")),qe={idServer:Ce.obj.idServer,state:Ue,from:Ce.obj.from,type:Ce.obj.type},jt&&(qe.error=jt),this.updateSysMsg(qe)},le.onTeamMsgReceipt=function(Ce){var Ue=Ce.content,qe=Ce.error;qe&&this.logger.error("team::onTeamMsgReceipt:",qe),Ue&&Ue.teamMsgReceipts&&(this.options.onTeamMsgReceipt(Ue),this.options.onMsgReceipts(Ue.teamMsgReceipts))}},function(t,r,e){var n=e(60),g=e(61),y=e(10),i=e(3),k=e(2),L=e(4),$=e(37).fn,V=e(0),z=V.teams2ids,re=e(312),oe=e(206);$.processSuperTeam=function(le){var ue,ie,ae,Ie=le.error;switch(le.obj===void 0&&(le.obj={}),le.cmd){case"sendSuperTeamMsg":this.onSendMsg(le);break;case"superTeamMsg":this.onMsg(le);break;case"sendSuperTeamCustomSysMsg":this.onSendSysMsg(le);break;case"superTeamCustomSysMsg":this.onSysMsg(le);break;case"syncSuperTeams":this.onSuperTeams(le);break;case"syncCreateSuperTeam":ue=y(re).call(re,le.content.team),ae=oe.assembleOwner(ue),this.logger.info("team::processTeam: sync createTeam",ue&&ue.teamId,ae&&ae.account),this.options.onSyncCreateSuperTeam(ue,ae),this.onCreateSuperTeam(ue,ae);break;case"getSuperTeamHistoryMsgs":case"searchSuperTeamHistoryMsgs":this.onHistoryMsgs(le);break;case"syncSendSuperTeamMsg":this.onMsg(le);break;case"addSuperTeamMembers":case"removeSuperTeamMembers":case"leaveSuperTeam":case"addSuperTeamManagers":case"removeSuperTeamManagers":case"transferSuperTeam":break;case"updateInfoInSuperTeam":Ie||(le.promise=this.onUpdateInfoInSuperTeam(le));break;case"updateNickInTeam":le.obj=y(oe).call(oe,le.obj);break;case"syncUpdateSuperTeamMember":(ie=y(oe).call(oe,le.content.teamMember)).account===this.account&&this.mergeMySuperTeamMembers(ie),this.onUpdateSuperTeamMember(ie);break;case"updateSuperTeam":le.obj=y(re).call(re,le.obj,!0);break;case"getSuperTeam":le.error||(le.obj=y(re).call(re,le.content.team));break;case"getSuperTeams":this.onSuperTeams(le);break;case"syncSuperTeamMembers":this.onSyncSuperTeamMembers(le);break;case"syncMySuperTeamMembers":this.onSyncMySuperTeamMembers(le);break;case"getSuperTeamMembers":le.error||this.onGetAllSuperTeamMembers(le);break;case"getSuperTeamMembersByJoinTime":case"getSuperTeamMembersByAccounts":case"getMutedSuperTeamMembers":le.error||this.onSuperTeamMembers(le);break;case"onDeleteSuperTeamMsg":this.onDeleteMsg(le);break;case"onSuperTeamMsgDelete":case"syncDeleteSuperTeamMsg":this.onMsgDeleted(le,!0);break;case"onMarkSuperTeamSessionAck":this.onMarkSessionAck(le);break;case"syncMarkSuperTeamSessionAck":this.syncMarkSessionAck(le);break;case"passSuperTeamApply":this.updateSuperTeamSysMsgState(le,"passed");break;case"rejectSuperTeamApply":this.updateTeamSysMsgState(le,"rejected");break;case"acceptSuperTeamInvite":this.updateTeamSysMsgState(le,"passed");break;case"rejectSuperTeamInvite":this.updateSuperTeamSysMsgState(le,"rejected");break;case"getMySuperTeamMembers":le.error||(le.obj=oe.reverseMembers(le.content.members))}},$.onUpdateInfoInSuperTeam=function(){var le=g(n.mark(function ue(ie){var ae,Ie,de;return n.wrap(function(Ce){for(;;)switch(Ce.prev=Ce.next){case 0:if(ae=this,!(ie.content&&ie.content.superTeamMember&&ie.content.superTeamMember.teamId)){Ce.next=11;break}if(Ie=y(oe).call(oe,ie.content.superTeamMember),!ae.db.enable){Ce.next=7;break}return Ce.next=6,ae.db.updateSuperTeamMember(Ie);case 6:Ie=Ce.sent;case 7:return ae.mergeMySuperTeamMembers(Ie),ae.onUpdateSuperTeamMember(Ie),ie.obj=Ie,Ce.abrupt("return");case 11:(de=ie.obj.superTeamMember?ie.obj.superTeamMember:ie.obj).account=ae.account,de.id=oe.genId(de.teamId,de.account),de=y(oe).call(oe,de),ae.mergeMySuperTeamMembers(de),ie.obj=ae.mySuperTeamMembersMap&&ae.mySuperTeamMembersMap[de.teamId]||de,ae.onUpdateSuperTeamMember(de);case 18:case"end":return Ce.stop()}},ue,this)}));return function(ue){return le.apply(this,arguments)}}(),$.onSuperTeams=function(le){le.content=le.content||{};var ue,ie=this,ae=ie.db,Ie=ie.packetFromSync(le),de=le.content.teams||[],Ce=!0,Ue=[],qe=[];if(le.error)switch(le.error.code){case 803:le.error=null,Ce=!1}var jt=new i(function(Et,cr){var er,nr;le.error?Ie&&cr(le.error):(function(){Ce&&k(de).call(de,function(dr){(dr=y(re).call(re,dr)).validToCurrentUser?Ue.push(dr):qe.push(dr)}),de.length?(Ce=!0,ue=le.content.timetag):Ce=!1}(),ae.enable?(er=Et,nr=cr,le.promise=new i(function(dr,ir){function tr(){Ie?(Fe(),dr(),er()):ae.getSuperTeams().then(function(ur){Ue=ur,Fe(),dr(),er()}).then(void 0,function(ur){ur.message="db.getSuperTeams error",ur.callFunc="superTeam::afterMergeData",ir(ur),nr(ur)})}Ce?ae.mergeSuperTeams(Ue,qe,ue).then(function(){tr()}).then(void 0,function(ur){var or={callFunc:"superTeam::onSuperTeams:mergeData",message:"db.mergeSuperTeams error",event:ur};ir(or),nr(or)}):(ie.logger.warn("superTeam::onSuperTeams:mergeData: no teams need merge"),tr())}).then(void 0,function(dr){throw dr.message="merge teams data error",dr.callFunc="superTeam::mergeData",nr(dr),dr})):(Fe(),Et()))}).catch(function(Et){return ie.logger.error("superTeam::onSuperTeams: ",Et),i.reject(Et)});function Fe(){ie.timetags.superTeams=ue,Ue.invalid=qe,Ie?(ie.syncResult.superTeams=Ue,ie.syncResult.invalidSuperTeams=qe):(ie.logger.info("superTeam::onSuperTeams: not in syncing, get teams",z(Ue)),le.obj=Ue)}Ie&&(jt.cmd="superteams",ie.syncPromiseArray.push(jt))},$.onCreateSuperTeam=function(le,ue){var ie=this.db;ie.enable&&(ie.putSuperTeam(le),ie.putSuperTeamMembers(ue))},$.onGetAllSuperTeamMembers=function(le){var ue=this,ie=this.db,ae=le.raw.ser,Ie=this.superTeamMembersData[ae]||{},de=Ie.teamId||le.obj&&le.obj.teamId;if(ie.enable){var Ce=le.content&&le.content.timetag,Ue=le.raw.code===200?i.all(Ie.pArr):i.resolve();le.promise=Ue.then(function(){return ie.getSuperTeamMembers(de).then(function(qe){Ce&&ie.updateSuperTeamMemberTimetag(de,Ce),le.obj={members:qe,invalid:[],teamId:de}})}).catch(function(qe){return ue.logger.error(qe)})}else le.obj={members:Ie.members,invalid:Ie.invalid,teamId:de};this.superTeamMembersData[ae]=void 0},$.onSyncSuperTeamMembers=function(le){var ue,ie=this,ae=this.db,Ie=[],de=[],Ce=le.content.members||[],Ue=le.raw.ser,qe=ie.packetFromSync(le);if(le.obj&&(ue=le.obj.teamId),ue||(ue=le.content.teamId),k(Ce).call(Ce,function(cr){(cr=y(oe).call(oe,cr)).valid?de.push(cr):Ie.push(cr)}),qe){var jt=new i(function(cr,er){if(le.error)ie.logger.error("team::onSuperTeamMember: team error:",ue,le.error),cr();else{ie.syncSuperTeamMembersResult[ue]=de,ie.syncSuperTeamMembersResult[ue+"-invalid"]=Ie;var nr=L(de).call(de,Ie);ae.putSuperTeamMembers(nr).catch(function(dr){throw ie.logger.error("team::onSuperTeamMembers: putSuperTeamMembers error: ",dr),dr}).then(function(){return ae.updateSuperTeamMemberTimetag(ue,le.content.timetag)}).catch(function(dr){ie.logger.error("team::onSuperTeamMembers error: ",dr,ue,le.content.timetag)}).then(cr)}});ie.syncSuperTeamMembersPromiseArray.push(jt)}else{if(ae.enable){ie.superTeamMembersData[Ue]=ie.superTeamMembersData[Ue]||{teamId:ue,pArr:[]};var Fe=i.resolve();le.content&&le.content.isAll&&(Fe=ae.deleteSuperTeamMembers(ue));var Et=Fe.then(function(){return ae.mergeSuperTeamMembers(ue,de,Ie)}).then(function(){return i.resolve()});ie.superTeamMembersData[Ue].pArr.push(Et)}else ie.superTeamMembersData[Ue]=ie.superTeamMembersData[Ue]||{teamId:ue,members:[],invalid:[]},de.length&&(ie.superTeamMembersData[Ue].members=ie.api.mergeTeamMembers(ie.superTeamMembersData[Ue].members,de)),Ie.length&&(ie.superTeamMembersData[Ue].invalid=ie.api.mergeTeamMembers(ie.superTeamMembersData[Ue].invalid,Ie));le.raw=void 0}},$.onSyncMySuperTeamMembers=function(le){var ue=this,ie=ue.db,ae=oe.reverseMembers(le.content.teamMembers);if(ie.enable){var Ie=ie.putSuperTeamMembers(ae).then(function(){return ie.updateMySuperTeamMembersTimetag(le.content.timetag)}).catch(function(de){return ue.logger.error("superTeam::syncMySuperTeamMember: ",de),i.reject(de)});ue.syncPromiseArray.push(Ie)}else ue.syncResult.mySuperTeamMembers=ae;ue.mergeMySuperTeamMembers(ae)},$.onSuperTeamMembers=function(le,ue){var ie,ae=this.db,Ie=[],de=[],Ce=le.content.members||[];k(Ce).call(Ce,function(Ue){(Ue=y(oe).call(oe,Ue)).valid?de.push(Ue):Ie.push(Ue)}),le.obj&&(ie=le.obj.teamId),ie||(ie=le.content.teamId||de[0]&&de[0].teamId),ae.enable&&!ue&&ae.mergeSuperTeamMembers(ie,de,Ie),le.obj={members:de,invalid:Ie,teamId:ie}},$.onUpdateSuperTeamMember=function(le){if(le.updateTime||(le.updateTime=+new Date),this.account===le.account){var ue=this.mySuperTeamMembersMap[le.teamId];this.logger.info("superTeam::onMySuperTeamMembers: ",[ue]),le=ue||le,this.options.onMySuperTeamMembers(V.simpleClone([ue]))}this.logger.info("superTeam::onUpdateSuperTeamMember: ",le&&le.account),this.options.onUpdateSuperTeamMember(V.simpleClone(le));var ie={teamId:le.teamId,memberUpdateTime:le.updateTime};this.onUpdateSuperTeam(ie);var ae=this.db;ae.enable&&ae.updateSuperTeamMember(le)},$.onUpdateSuperTeam=function(le){this.logger.info("superteam::onUpdateSuperTeam:",le&&le.teamId),this.options.onUpdateSuperTeam(V.simpleClone(le));var ue=this.db;ue.enable&&ue.updateSuperTeam(le)},$.mergeMySuperTeamMembers=function(le){V.isArray(le)||(le=[le]);var ue=this.mySuperTeamMembersMap=this.mySuperTeamMembersMap||{};k(le).call(le,function(ie){var ae=ie.teamId;ue[ae]=V.merge(ue[ae],ie)})},$.updateSuperTeamSysMsgState=function(le,ue){var ie,ae=le.error;ae&&(ue="error",ae=V.filterObj(ae,"code message")),ie={idServer:le.obj.idServer,state:ue,from:le.obj.from,type:le.obj.type},ae&&(ie.error=ae),this.updateSysMsg(ie)}},function(t,r,e){var n=e(10),g=e(3),y=e(22),i=e(37).fn,k=e(0),L=e(317);i.processNotify=function($){switch($.cmd){case"syncOfflineNetcallMsgs":case"syncOfflineMsgs":this.onOfflineMsgs($);break;case"batchMarkRead":break;case"syncOfflineSysMsgs":case"syncOfflineSuperTeamSysMsgs":this.onOfflineSysMsgs($);break;case"syncRoamingMsgs":case"syncSuperTeamRoamingMsgs":this.onRoamingMsgs($);break;case"syncOfflineFilterMsgs":this.onOfflineMsgs($,!0);break;case"syncOfflineFilterSysMsgs":this.onOfflineSysMsgs($,!0);break;case"syncMsgReceipts":this.onOfflineMsgReceipts($);break;case"syncDonnop":this.onDonnop($,!0);break;case"syncSessionAck":this.syncSessionAck($);break;case"syncSuperTeamSessionAck":this.syncSuperTeamSessionAck($);break;case"syncRobots":this.onRobots($);break;case"syncBroadcastMsgs":this.onBroadcastMsgs($);break;case"syncDeleteSuperTeamMsgOfflineRoaming":this.onDeleteMsgOfflineRoaming($);break;case"syncDeleteMsgSelf":this.syncDeleteMsgSelf($);break;case"syncSessionsWithMoreRoaming":this.syncSessionsWithMoreRoaming($);break;case"syncStickTopSessions":this.syncStickTopSessions($);break;case"syncSessionHistoryMsgsDelete":this.syncSessionHistoryMsgsDelete($)}},i.onDonnop=function($,V){if(!$.error){var z=this,re=z.db,oe=n(L).call(L,$.content.donnop);z.mergeDonnop(oe);var le=z.dbDonnop();if(V){var ue=$.content.timetag;z.timetags.donnop=ue,re.enable&&(le=le.then(function(){return z.db.updateDonnopTimetag(ue)}).catch(function(ie){return z.logger.error("notify::onDonnop: ",ie),g.reject(ie)})),le.cmd="donnop",z.syncPromiseArray.push(le)}else z.onPushNotificationMultiportConfigUpdate()}},i.onUpdateDonnop=function($){if(!$.error){var V=$.obj;V&&(this.mergeDonnop(k.filterObj(V,["shouldPushNotificationWhenPCOnline"])),this.dbDonnop(),this.onPushNotificationMultiportConfigUpdate())}},i.getPushNotificationMultiportConfig=function(){return k.merge({},this.pushNotificationMultiportConfig)},i.mergeDonnop=function($){this.pushNotificationMultiportConfig=k.merge({},this.pushNotificationMultiportConfig,$)},i.dbDonnop=function(){return this.db.enable?this.db.setDonnop(this.pushNotificationMultiportConfig):g.resolve()},i.onPushNotificationMultiportConfigUpdate=function(){var $=this;y(function(){var V=$.getPushNotificationMultiportConfig();$.logger.info("link::onPushNotificationMultiportConfigUpdate:",V),$.options.onPushNotificationMultiportConfigUpdate(V)})}},function(t,r,e){var n=e(51),g=e(2),y=e(15),i=e(11),k=e(3),L=e(5),$=e(8),V=e(6),z=e(10),re=e(143),oe=e(4),le=e(22),ue=e(23),ie=e(43),ae=e(34),Ie=e(95),de=e(52),Ce=e(53),Ue=e(54),qe=e(55),jt=e(42),Fe=e(9),Et=e(68),cr=e(78),er=e(64),nr=e(28);function dr(sr,xr){var Or=cr!==void 0&&er(sr)||sr["@@iterator"];if(!Or){if(nr(sr)||(Or=function(Fr,Lr){var qr;if(Fr){if(typeof Fr=="string")return ir(Fr,Lr);var Ur=Fe(qr=Object.prototype.toString.call(Fr)).call(qr,8,-1);if(Ur==="Object"&&Fr.constructor&&(Ur=Fr.constructor.name),Ur==="Map"||Ur==="Set")return Et(Fr);if(Ur==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(Ur))return ir(Fr,Lr)}}(sr))||xr&&sr&&typeof sr.length=="number"){Or&&(sr=Or);var Mr=0,br=function(){};return{s:br,n:function(){return Mr>=sr.length?{done:!0}:{done:!1,value:sr[Mr++]}},e:function(Fr){throw Fr},f:br}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var hr,Tr=!0,Br=!1;return{s:function(){Or=Or.call(sr)},n:function(){var Fr=Or.next();return Tr=Fr.done,Fr},e:function(Fr){Br=!0,hr=Fr},f:function(){try{Tr||Or.return==null||Or.return()}finally{if(Br)throw hr}}}}function ir(sr,xr){(xr==null||xr>sr.length)&&(xr=sr.length);for(var Or=0,Mr=new Array(xr);Or<xr;Or++)Mr[Or]=sr[Or];return Mr}function tr(sr,xr){var Or=L(sr);if(de){var Mr=de(sr);xr&&(Mr=y(Mr).call(Mr,function(br){return Ce(sr,br).enumerable})),Or.push.apply(Or,Mr)}return Or}var ur=e(37).fn,or=e(0),fr=or.undef,lr=e(48),gr=e(160),Sr=e(206),wr=e(162),kr=e(297),mr=e(12),Ir=e(70),Nr=e(80);function Er(sr,xr,Or){var Mr=this,br=Mr.message.Message,hr=Or?"offlineFilterMsgs":"offlineMsgs";if(!(xr&&xr.length>0))return k.resolve();var Tr=br.getMaxTimetag(xr),Br=xr[0].scene,Fr=xr[0].target;Mr.markMsgRead(xr),xr=br.deduplication(xr),xr=br.sortMsgs(xr);var Lr=Mr.genSessionByMsgs(xr);Mr.cacheSyncedSession(Lr);var qr=Mr.putMsg(xr,"offlineMsgs").then(function(Ur){var Qr=Ur;(Qr=Mr.filterIgnore(Qr)).length&&(Mr.logger.info("msg::onOfflineMsgs： toreLastSession",hr,sr,Qr.length),Mr.syncResult[hr]=Mr.syncResult[hr]||[],Mr.syncResult[hr].push({sessionId:sr,scene:Br,to:Fr,msgs:Qr,timetag:Tr}))}).catch(function(Ur){return Mr.logger.error("msg::onOfflineMsgs: ",Ur),k.reject(Ur)});return qr.cmd="offlineMsgs-"+sr,qr}ur.processMsg=function(sr){switch(sr.cmd){case"sendMsg":this.onSendMsg(sr);break;case"msg":this.onMsg(sr);break;case"sysMsg":this.onSysMsg(sr);break;case"broadcastMsg":this.onBroadcastMsg(sr);break;case"sendCustomSysMsg":this.onSendSysMsg(sr);break;case"getHistoryMsgs":case"searchHistoryMsgs":this.onHistoryMsgs(sr);break;case"msgFtsInServer":case"msgFtsInServerByTiming":this.onmsgFtsInServer(sr);break;case"syncSendMsg":this.onMsg(sr);break;case"deleteSessions":this.onDeleteSessions(sr);break;case"sendMsgReceipt":this.onSendMsgReceipt(sr);break;case"msgReceipt":this.onMsgReceipt(sr);break;case"onDeleteMsg":this.onDeleteMsg(sr);break;case"onMsgDeleted":this.onMsgDeleted(sr);break;case"onDeleteMsgOfflineRoaming":this.onDeleteMsgOfflineRoaming(sr);break;case"onMarkSessionAck":this.onMarkSessionAck(sr);break;case"syncMarkSessionAck":this.syncMarkSessionAck(sr);break;case"syncUpdateServerSession":this.onSyncUpdateServerSession(sr);break;case"deleteMsgSelf":this.deleteMsgSelf(sr);break;case"deleteMsgSelfBatch":this.deleteMsgSelfBatch(sr);break;case"onDeleteMsgSelf":this.onDeleteMsgSelf(sr);break;case"onDeleteMsgSelfBatch":this.onDeleteMsgSelfBatch(sr);break;case"clearServerHistoryMsgs":this.clearServerHistoryMsgs(sr);break;case"onClearServerHistoryMsgs":this.onClearServerHistoryMsgs(sr)}},ur.checkIgnore=function(sr){var xr=this;g(sr).call(sr,function(Or){if(!Or.ignore){try{xr.options.shouldIgnoreMsg(Or)&&(Or.ignore=!0)}catch(br){throw xr.logger.error("userOption:shouldIgnoreMsg function error",br),br}var Mr;try{Mr=xr.options.shouldIgnoreNotification(Or)}catch(br){throw xr.logger.error("userOption:shouldIgnoreNotification function error",br),br}Or.type==="notification"&&Mr&&(Or.ignore=!0)}})},ur.filterIgnore=function(sr){return y(sr).call(sr,function(xr){return!xr.ignore})},ur.genSessionByMsgs=function(sr){return this.checkIgnore(sr),wr.genSessionByMsgs(this.message.Message,sr)},ur.onRoamingMsgs=function(sr){var xr=this,Or=xr.message,Mr=Or.Message,br=Mr.getMaxTimetag,hr=Or.reverseMsgs(sr.content.msgs),Tr=br(hr);hr=Mr.deduplication(hr);var Br=(hr=Mr.sortMsgs(hr))[0],Fr=Br.sessionId,Lr=xr.genSessionByMsgs(hr);xr.cacheSyncedSession(Lr);var qr=xr.putMsg(hr,"roamingMsgs").then(function(Ur){var Qr,vn=(hr=Ur).length,_n=(hr=xr.filterIgnore(hr)).length;vn!==_n&&xr.logger.info("msg::onRoamingMsgs msg length before filter: "+vn+" after filter: "+_n),hr.length&&(xr.logger.info("msg::onRoamingMsgs: putRoamingMsgs",Fr,hr.length,i(Qr=hr||[]).call(Qr,function(Yr){return"idServer: "+Yr.idServer+" idClient: "+Yr.idClient+" time:"+Yr.time+" type: "+Yr.type}).join(`
`)),xr.syncResult.roamingMsgs=xr.syncResult.roamingMsgs||[],xr.syncResult.roamingMsgs.push({sessionId:Fr,scene:Br.scene,to:Br.target,msgs:hr,timetag:Tr}),xr.syncing||xr.roamingMsgSyncDoneBufferManager.add())}).catch(function(Ur){return xr.logger.error("msg::onRoamingMsgs: ",Ur),k.reject(Ur)});qr.cmd="roamingMsgs-"+Fr,xr.syncPromiseArray.push(qr)},ur.onOfflineMsgs=function(sr,xr){var Or,Mr=this,br=this.message,hr=null;xr&&(hr={filter:!0});var Tr=br.reverseMsgs(sr.content.msgs,{modifyObj:hr});Tr=Nr.deduplication(Tr);var Br={};g(Tr).call(Tr,function(qr){Br[qr.sessionId]=Br[qr.sessionId]||[],Br[qr.sessionId].push(qr)});var Fr=i(Or=L(Br)).call(Or,function(qr){return{sessionId:qr,msgs:Br[qr]}}),Lr=or.asyncPool(50,Fr,function(qr){return Er.call(Mr,qr.sessionId,qr.msgs,xr)});this.syncPromiseArray.push(Lr)},ur.completeMsg=function(sr){return sr.from=this.account,sr.fromNick=this.myInfo&&this.myInfo.nick,sr.fromClientType="Web",sr.fromDeviceId=lr.deviceId,sr.time||(sr.time=+new Date),sr},ur.amendMsg=function(sr){if(sr.scene==="team"){var xr=or.get(this.myTeamMembersMap,sr.to+".nickInTeam");xr&&(sr.fromNick=xr)}else if(sr.scene==="superTeam"){var Or=or.get(this.mySuperTeamMembersMap,sr.to+".nickInTeam");Or&&(sr.fromNick=Or)}return sr},ur.onMsgs=function(sr){var xr=this,Or=xr.reporterHook.getSafeClock(),Mr=xr.message.reverseMsgs(sr.content.msgs,{mapper:function(br){var hr=function(Tr){for(var Br=1;Br<arguments.length;Br++){var Fr,Lr,qr=arguments[Br]!=null?arguments[Br]:{};Br%2?g(Fr=tr(Object(qr),!0)).call(Fr,function(Ur){n(Tr,Ur,qr[Ur])}):Ue?qe(Tr,Ue(qr)):g(Lr=tr(Object(qr))).call(Lr,function(Ur){jt(Tr,Ur,Ce(qr,Ur))})}return Tr}({},br);if(hr.__receiveTime=sr.__receiveTime,hr.__handleTime=Or,hr.__clientExt)try{hr.__clientExt=JSON.parse(hr.__clientExt)}catch{xr.logger.warn("IMProtocolFn:onMsg __clientExt parse failed ".concat(hr.__clientExt))}return xr.handleMsg(hr),hr}});xr.pushMsgDelay(Mr)},ur.onMsg=function(sr,xr){var Or;if(sr.content.msg.attach){var Mr=null;try{Mr=JSON.parse(sr.content.msg.attach)}catch{}if(Mr&&Mr.url&&or.get(this.mixStorePolicy,"s3Policy.dlcdns")){var br,hr=dr(this.mixStorePolicy.s3Policy.dlcdns);try{for(hr.s();!(br=hr.n()).done;){var Tr,Br=br.value;$(Tr=Mr.url).call(Tr,Br)>=0&&(Mr.isS3=!0,Br!==this.mixStorePolicy.s3Policy.dlcdn&&(Mr.url=Mr.url.replace(Br,this.mixStorePolicy.s3Policy.dlcdn)))}}catch(Lr){hr.e(Lr)}finally{hr.f()}}sr.content.msg.attach=V(Mr)}var Fr=z(Or=this.message).call(Or,sr.content.msg);if(Fr.__receiveTime=sr.__receiveTime,Fr.__handleTime=this.reporterHook.getSafeClock(),or.get(sr,"content.msg.__clientExt"))try{Fr.__clientExt=JSON.parse(sr.content.msg.__clientExt)}catch{this.logger.warn("IMProtocolFn:onMsg __clientExt parse failed ".concat(sr.content.msg.__clientExt))}xr&&(Fr.filter=!0),sr.cmd!=="syncSendMsg"||Fr.from!==Fr.to?(this.pushMsgDelay([Fr]),this.syncing?(this.logger.info("msg::onMsg:is in syncing ..."),this.unhandledMsgs.push({type:"onMsg",msg:Fr})):this.handleMsg(Fr)):this.logger.warn("onMsg::syncSendMsg to self, so ignore",Fr.idClient,Fr.idServer)},ur.onBroadcastMsgs=function(sr){var xr=sr.content.broadcastMsgs;xr=re(xr).call(xr,function(Or,Mr){return Or.broadcastId-Mr.broadcastId}),this.putBroadcastMsgs(xr)},ur.onBroadcastMsg=function(sr){var xr=sr.content.broadcastMsg;xr.time=xr.timestamp,this.syncing?this.unhandledMsgs.push({type:"onBroadcastMsg",msg:xr}):xr&&this.putBroadcastMsg(xr)},ur.pushMsgTask=function(sr){this.msgPromise=this.msgPromise.then(function(){return sr()})},ur.pushMsgDelay=function(sr){if(sr&&sr.length>0){var xr=this;if(xr.msgStatEnable&&!mr.isWeixinApp){var Or,Mr=i(sr).call(sr,function(br){return{appkey:xr.options.appKey,accid:br.to,fromAccid:br.from,msgId:br.idServer,serverTime:br.time,receiveTime:xr.reporterHook.getNTPTime(),sessionId:xr.sdkSession,platform:"web",sdk_ver:mr.info.version,manufactor:Ir.name+" "+Ir.version}});xr.msgDelayArr=oe(Or=xr.msgDelayArr).call(Or,Mr),xr.msgDelayArr.length>5&&xr.doReportMsgDelay()}}},ur.doReportMsgDelay=function(){var sr,xr=V(this.msgDelayArr);this.msgDelayArr&&this.msgDelayArr.length>0&&(kr.sendBeacon("https://statistic.live.126.net/statics/report/im/sdk/msgreceived",xr),this.msgDelayArr=[]),this.msgDelayTimer&&clearTimeout(this.msgDelayTimer),this.socket&&(this.msgDelayTimer=le(ue(sr=this.doReportMsgDelay).call(sr,this),1e4))},ur.handleMsg=function(sr){var xr,Or=this,Mr=Or.db,br=sr.time;Or.markMsgRead(sr),Or.logger.info(oe(xr="msg::handleMsg:msgPromise start ".concat(sr.idServer," ")).call(xr,sr.idClient)),Or.msgPromise=Or.msgPromise.then(function(){var hr;return Or.logger.info(oe(hr="msg::handleMsg:msgPromise, putMsg start ".concat(sr.idServer," ")).call(hr,sr.idClient)),Or.putMsg(sr,"onMsg")}).then(function(){var hr;return Or.logger.info(oe(hr="msg::handleMsg:msgPromise, putMsg done and update timetag ".concat(sr.idServer," ")).call(hr,sr.idClient)),Mr.enable?sr.scene==="superTeam"?Mr.updateSuperTeamRoamingMsgTimetag(br):Mr.updateRoamingMsgTimetag(br):(Or.timetags[sr.scene==="superTeam"?"superTeamRoamingMsgs":"roamingMsgs"]=br,k.resolve())}).then(function(){if(sr)return Or.checkUserUpdate(sr)}).then(function(){if(sr){var hr=sr.type;switch(Or.logger.info("msg::handleMsg:msgPromise, checkUserUpdate "+sr.scene+" "+hr+" msg"+(hr==="notification"?" "+sr.attach.type:"")),hr){case"notification":return Or.onTeamNotificationMsg(sr)}}}).then(function(){var hr,Tr;Or.logger.info(oe(hr=oe(Tr="msg::handleMsg:msgPromise, onmsg ready: ".concat(sr.idServer," ")).call(Tr,sr.idClient,", ")).call(hr,!!sr.ignore)),sr&&!sr.ignore&&le(function(){var Br,Fr=sr.scene==="p2p";if(mr.isBrowser&&sr.flow!=="out"){var Lr={msgId:sr.idServer,clientId:sr.idClient,receiveTime:Or.reporterHook.getNTPTime(sr.__receiveTime),serverTime:sr.time,callbackTime:Or.reporterHook.getNTPTime(),preHandleTime:Or.reporterHook.getNTPTime(sr.__handleTime),fromAccid:sr.from,toAccid:Or.options.account,type:Or.message.sceneMap[sr.scene],tid:Fr?"":sr.to,result:200,failReason:"",rt:ie(Or.reporterHook.getSafeClock()-sr.__receiveTime)},qr=or.get(sr,"__clientExt.statistics.apiCallingTime"),Ur=or.get(sr,"__clientExt.statistics.sendTime");qr&&Ur&&(Lr.apiCallingTime=qr,Lr.sendTime=Ur,Lr.attachUploadDuration=or.get(sr,"__clientExt.statistics.attachUploadDuration")||0),Or.reporter&&Or.reporter.report("msgReceive",Lr)}delete sr.__receiveTime,delete sr.__handleTime,delete sr.__clientExt,Or.logger.info(oe(Br="msg::handleMsg:msgPromise, tigger onmsg: ".concat(sr.idServer," ")).call(Br,sr.idClient)),Or.options.onmsg(or.copy(sr))},0)}).catch(function(hr){var Tr;Or.logger.error(oe(Tr="msg::handleMsg:msgPromise, catch err ".concat(sr.idServer," ")).call(Tr,sr.idClient),hr),hr.callFunc="msg::handleMsg",Or.onCustomError("消息处理错误",hr)})},ur.putMsg=function(sr,xr){if(or.isArray(sr)||(sr=[sr]),y(sr[0]))return k.resolve(sr);var Or,Mr=this,br=Mr.db,hr=br.enable,Tr=k.resolve(),Br=Mr.message.Message.getLastMsg(sr),Fr=Br.flow,Lr=Mr.genSessionByMsgs(sr);Ur(Lr);var qr=[];function Ur(Qr){xr!=="roamingMsgs"&&xr!=="offlineMsgs"||Mr.cacheSyncedSession(Qr)}return Tr=(Tr=(Tr=Tr.then(function(){var Qr;return hr||Mr.options.autoMarkRead||xr==="roamingMsgs"||!Lr||(Mr.sessionUnreadMsgs=Mr.sessionUnreadMsgs||{},Mr.sessionUnreadMsgs[Lr.id]=Mr.sessionUnreadMsgs[Lr.id]||[],Mr.sessionUnreadMsgs[Lr.id]=oe(Qr=Mr.sessionUnreadMsgs[Lr.id]).call(Qr,y(sr).call(sr,function(vn){try{return Mr.options.shouldCountNotifyUnread(vn)}catch(_n){throw Mr.logger.error("userOption:shouldCountNotifyUnread function error",_n),_n}}))),xr==="offlineMsgs"||xr==="roamingMsgs"?k.reject(sr):hr?br.putMsg(sr):sr}).then(function(Qr){return g(sr).call(sr,function(vn){Mr.checkMsgUnique(vn)&&Mr.logger.warn("msg::putMsg: msg is not unique",vn.idClient,vn.idServer,vn.time)}),qr=hr?Qr:sr,k.resolve(sr)})).then(function(Qr){return Qr.length&&hr&&Lr?new k(function(vn){br.getSessions({sessionId:Lr.id}).then(function(_n){if(_n&&_n.lastMsg){var Yr=_n.lastMsg;Lr.lastMsg&&Lr.lastMsg.time<Yr.time&&(Lr.lastMsg=Yr)}qr&&qr.length?Lr?br.putSession(Lr).then(function(jn){vn(jn)}):vn(_n):(qr=Qr,vn(_n))})}):k.resolve(Lr)})).then(function(Qr){if(Lr&&qr.length){Or=Br.sessionId!==Mr.currSessionId;var vn=xr==="roamingMsgs",_n=Mr.options.syncSessionUnread,Yr=Lr.id,jn=Mr.getSessionInCache(Yr,!0)||{},Zr=jn.ack||0;if(xr==="offlineMsgs"||vn&&_n||xr==="onMsg"&&Fr==="in"&&Or){var An;if(hr&&Qr){var Jr=jn.unread||0;(Lr=Qr).unread=Jr,Zr=Zr||Lr.ack||0}else(Qr=jn)&&(Lr.unread=Qr.unread||0);Ur(Lr),Lr.unread=Lr.unread||0;var Mn=0;g(qr).call(qr,function(wn){var In;try{In=Mr.options.shouldCountNotifyUnread(wn)}catch(Zn){throw Mr.logger.error("userOption:shouldCountNotifyUnread function error",Zn),Zn}var bn=(wn.type!=="notification"||wn.type==="notification"&&In)&&(fr(wn.isUnreadable)||wn.isUnreadable);if(bn&&_n&&(bn=wn.time>Zr&&wn.flow!=="out"),bn&&(Mn++,_n&&!hr)){var hn=jn.unreadMsgs||[];hn.push(wn),Lr.unreadMsgs=hn}}),Lr.unread+=Mn;var Bn=or.secureOutput("session",Lr);if(Bn.unreadMsgs&&(Bn.unreadMsgs=i(An=Bn.unreadMsgs).call(An,function(wn){return wn&&wn.idServer})),Mr.logger.info("msg::putMsg:updateSession: ",Bn),Ur(Lr),hr)return br.updateSession({id:Lr.id,unread:Lr.unread})}}}),xr==="onMsg"&&(Tr=Tr.then(function(){sr.length&&Lr&&(Mr.onUpdateSession(Lr),Mr.options.syncSessionUnread&&!Or&&Mr.api.resetSessionUnread(Mr.currSessionId))})),Tr.then(function(){return k.resolve(sr)}).catch(function(Qr){return Qr&&Qr.length?k.resolve(Qr):k.reject(Qr)})},ur.putBroadcastMsgs=function(sr){var xr=this,Or=xr.db,Mr=sr.length;if(Mr>0){if(xr.doMarkBroadcastMsgsRead(sr),Or.enable){var br=sr[Mr-1].broadcastId;return Or.updateBroadcastMsgTimetag(br),Or.putBroadcastMsg(sr).then(function(){return le(function(){xr.doMarkMsgsRead(),xr.options.onbroadcastmsgs(or.copy(sr))},0),k.resolve(sr)})}le(function(){xr.options.onbroadcastmsgs(or.copy(sr))},0)}return sr},ur.putBroadcastMsg=function(sr){var xr=this,Or=xr.db;return xr.doMarkBroadcastMsgsRead([sr]),Or.enable?(sr.broadcastId&&Or.updateBroadcastMsgTimetag(sr.broadcastId),Or.putBroadcastMsg(sr).then(function(){return le(function(){xr.options.onbroadcastmsg(or.copy(sr))},0),k.resolve(sr)})):(le(function(){xr.options.onbroadcastmsg(or.copy(sr))},0),sr)},ur.doMarkBroadcastMsgsRead=function(sr){sr=i(sr).call(sr,function(xr){return xr.broadcastId}),this.sendCmd("batchMarkRead",{sid:7,cid:17,ids:sr})},ur.cacheSyncedSession=function(sr){if(sr&&this.syncResult){sr=ae({},sr),this.syncResult.sessions=this.syncResult.sessions||{};var xr=sr.id,Or=this.syncResult.sessions[xr]||{};Or&&Or.ack>sr.ack&&delete sr.ack,Or&&Or.msgReceiptTime>sr.msgReceiptTime&&delete sr.msgReceiptTime;var Mr=or.get(Or,"lastMsg.time"),br=or.get(sr,"lastMsg.time");Mr&&br&&Mr>br&&(sr.lastMsg=Or.lastMsg),this.syncResult.sessions[xr]=ae(Or,sr),this.syncResult.sessions[xr]=ae({},this.mergeSession(this.syncResult.sessions[xr]))}},ur.checkMsgUnique=or.genCheckUniqueFunc("idClient"),ur.revokeMsgUniqueCheck=function(sr){this.uniqueSet&&this.uniqueSet.idClient&&(this.uniqueSet.idClient[sr]=!1)},ur.storeSendMsg=function(sr){if(!this.syncing){var xr=this.putMsg(sr,"sendMsg");return this.msgPromise=this.msgPromise.then(function(){return xr}),xr}this.unhandledMsgs.push({type:"sendMsg",msg:sr})},ur.updateSendMsgError=function(sr){if(!this.syncing){var xr=this.updateMsg(sr);return this.msgPromise=this.msgPromise.then(function(){return xr}),xr}this.unupdatedMsgs.push(sr)},ur.onSendMsg=function(sr,xr){var Or,Mr,br=this,hr=sr.content&&sr.content.msg,Tr=sr.obj&&sr.obj.msg||hr;if(Tr)if(this.logger.warn(oe(Or=oe(Mr="sendMsg::end: ".concat(hr&&hr.idServer," ")).call(Mr,Tr.idClient," ")).call(Or,sr&&sr.raw&&sr.raw.ser)),sr.obj)Fr();else{var Br=br.db;Br&&Br.enable&&Br.getMsgByIdClient(Tr.idClient).then(function(Lr){Lr&&(Tr=Lr,Fr(!1))}).catch(function(){return Fr()})}else this.logger.error("sendMsg::error::get msg failed, msg empty");function Fr(){var Lr,qr=!(arguments.length>0&&arguments[0]!==void 0)||arguments[0];br.completeMsg(Tr);var Ur=sr.error&&sr.error.code===7101;sr.error&&!Ur||(Tr.idServer=hr.idServer,Tr.time=+hr.time,hr.yidunAntiSpamRes&&(Tr.yidunAntiSpamRes=hr.yidunAntiSpamRes),hr.callbackExt&&(Tr.callbackExt=hr.callbackExt)),Ur&&(Tr.isInBlackList=!0),sr.error?Tr.status="fail":Tr.status="success",Tr=qr?z(Lr=br.message).call(Lr,Tr):Tr,Tr=br.amendMsg(Tr),xr&&(Tr.filter=!0),sr.obj=Tr,br.syncing?br.unupdatedMsgs.push(Tr):br.msgPromise=k.all([br.msgPromise,sr.obj.promise]).then(function(Qr){return Qr.length||(Tr.resend=!0),br.updateMsg(Tr).then(function(){return br.options.syncSessionUnread&&br.currSessionId===Tr.sessionId&&br.api.resetSessionUnread(br.currSessionId),br.resolveMsgReceiptTask(Tr),Tr})}).catch(function(Qr){br.logger.error("onSendMsg::dealMsg error",Qr)})}},ur.updateLocalMsg=function(sr){var xr=this.updateMsg(sr);return this.msgPromise=this.msgPromise.then(function(){return xr}),xr},ur.updateMsg=function(sr){if(y(sr)||this.options.shouldIgnoreMsg(sr))return k.resolve(sr);var xr=this,Or=xr.db,Mr=sr.status==="success",br=wr.genSessionByMsg(sr),hr=!!sr.isLocal;return xr.onUpdateSession(br),Or.enable?Or.updateMsg(sr).then(function(Tr){var Br=Or.updateSession(br),Fr=k.resolve();return Mr&&Tr&&!hr&&(Fr=sr.scene==="superTeam"?Or.updateSuperTeamRoamingMsgTimetag(Tr.time):Or.updateRoamingMsgTimetag(Tr.time)),k.all([Br,Fr])}).catch(function(Tr){xr.logger.error("updateMsg error",Tr)}):(Mr&&!hr&&(xr.timetags.roamingMsgs=sr.time),k.resolve(sr))},ur.updateRoamingMsgTimetag=function(sr){var xr=this.db;return xr.enable?xr.updateRoamingMsgTimetag(sr):(this.timetags.roamingMsgs=sr,k.resolve(sr))},ur.checkUserUpdate=function(sr){var xr=this,Or=sr.from;return xr.logger.info("handleMsg::checkUserUpdate: ",Or,xr.account),Or===xr.account?k.resolve():new k(function(Mr){var br=xr.userSet[Or];if(br){var hr=+br.updateTime,Tr=+sr.userUpdateTime;!isNaN(hr)&&!isNaN(Tr)&&or.isNumber(hr)&&or.isNumber(Tr)&&hr<Tr?Br():Mr()}else Br();function Br(){xr.api.getUser({account:Or,sync:!0,done:function(Fr,Lr){Fr||le(function(){xr.logger.log("user::checkUserUpdate: onupdateuser",Lr&&Lr.account),xr.options.onupdateuser(Lr)},0),Mr()}})}})},ur.processUnsettledMsgs=function(){var sr,xr,Or=this;g(sr=Or.unhandledMsgs).call(sr,function(Mr){var br=Mr.msg;switch(Mr.type){case"onMsg":Or.handleMsg(br);break;case"sendMsg":Or.msgPromise=Or.msgPromise.then(function(){return Or.putMsg(br)});break;case"onBroadcastMsg":Or.msgPromise=Or.msgPromise.then(function(){return Or.putBroadcastMsg(br)})}}),g(xr=Or.unupdatedMsgs).call(xr,function(Mr){Or.msgPromise=Or.msgPromise.then(function(){return Or.updateMsg(Mr)})}),Or.resetUnsettledMsgs()},ur.onTeamNotificationMsg=function(sr){var xr=sr.attach,Or=xr.type,Mr=sr.from,br=sr.to,hr=sr.time,Tr=xr.team,Br=xr.account,Fr=xr.accounts;switch(Or){case"updateTeam":return Tr.updateTime=hr,this.onUpdateTeam(Tr);case"addTeamMembers":return this.onAddTeamMembers(sr,Tr,Fr);case"removeTeamMembers":return this.onRemoveTeamMembers(Tr,br,Fr);case"acceptTeamInvite":return this.onAddTeamMembers(sr,Tr,[Mr]);case"passTeamApply":return this.onAddTeamMembers(sr,Tr,[Br]);case"addTeamManagers":return this.updateTeamManagers(sr,br,Fr,!0,hr);case"removeTeamManagers":return this.updateTeamManagers(sr,br,Fr,!1,hr);case"leaveTeam":return this.onRemoveTeamMembers(Tr,br,[Mr]);case"dismissTeam":return this.onDismissTeam(br,hr);case"transferTeam":return this.transferTeam(sr,Tr,Mr,Br);case"updateTeamMute":return this.onUpdateTeamMembersMute(sr,Tr,[Br],xr.mute);case"updateSuperTeam":return Tr.updateTime=hr,this.onUpdateSuperTeam(Tr);case"acceptSuperTeamInvite":return this.onAddSuperTeamMembers(sr,Tr,[sr.from]);case"addSuperTeamMembers":return this.onAddSuperTeamMembers(sr,Tr,Fr);case"passSuperTeamApply":return this.onAddSuperTeamMembers(sr,Tr,[Br]);case"removeSuperTeamMembers":return this.onRemoveSuperTeamMembers(Tr,br,Fr);case"leaveSuperTeam":return this.onRemoveSuperTeamMembers(Tr,br,[Mr]);case"dismissSuperTeam":return this.onDismissSuperTeam(br,hr);case"transferSuperTeam":return this.transferSuperTeam(sr,Tr,Mr,Br);case"addSuperTeamManagers":return this.updateSuperTeamManagers(sr,br,Fr,!0,hr);case"removeSuperTeamManagers":return this.updateSuperTeamManagers(sr,br,Fr,!1,hr);case"updateSuperTeamMembersMute":return this.onUpdateSuperTeamMembersMute(sr,Tr,Fr,xr.mute)}},ur.onAddSuperTeamMembers=function(sr,xr,Or){var Mr=this.db,br=Sr.assembleMembers(xr,Or);sr.attach.members=br;var hr={team:xr,accounts:Or,members:br};if(this.logger.info("team::onAddSuperTeamMembers: ".concat(hr.team.teamId,", "),hr.accounts),this.options.onAddSuperTeamMembers(or.simpleClone(hr)),Mr.enable){var Tr=Mr.putSuperTeamMembers(br),Br=Mr.putSuperTeam(xr);return k.all([Tr,Br])}},ur.onRemoveSuperTeamMembers=function(sr,xr,Or){var Mr=this.db,br={team:sr,teamId:xr,accounts:Or};if(this.logger.info("team::onRemoveSuperTeamMembers: ".concat(xr,", "),br.accounts),this.options.onRemoveSuperTeamMembers&&this.options.onRemoveSuperTeamMembers(or.simpleClone(br)),this.mySuperTeamMembersMap&&this.mySuperTeamMembersMap[xr]&&this.mySuperTeamMembersMap[xr].followAccountIds){var hr=this.mySuperTeamMembersMap[xr].followAccountIds;if(y(hr).call(hr,function(Lr){return Ie(Or).call(Or,Lr)}).length>0){this.mySuperTeamMembersMap[xr].followAccountIds=y(hr).call(hr,function(Lr){return!Ie(Or).call(Or,Lr)});var Tr=this.mySuperTeamMembersMap[xr];this.db.enable&&this.db.updateSuperTeamMember(Tr),this.mergeMySuperTeamMembers(Tr),this.onUpdateSuperTeamMember(Tr)}}if(sr&&Mr.enable){if($(Or).call(Or,this.account)===-1){var Br=Mr.removeSuperTeamMembersByAccounts(xr,Or),Fr=k.resolve();return sr&&(Fr=Mr.putSuperTeam(sr)),k.all([Br,Fr])}return Mr.leaveSuperTeam(xr)}},ur.onDismissSuperTeam=function(sr,xr){var Or=this.db,Mr={teamId:sr};if(this.logger.info("team::onDismissSuperTeam:",sr),this.options.onDismissSuperTeam(Mr),Or.enable)return Or.dismissSuperTeam(sr,xr)},ur.onAddTeamMembers=function(sr,xr,Or){var Mr=this,br=Mr.db,hr=xr.teamId,Tr=gr.assembleMembers(xr,Or);sr.attach.members=Tr;var Br={team:xr,accounts:Or,members:Tr};if(Mr.logger.info("team::onAddTeamMembers: ",hr,Or),$(Or).call(Or,Mr.account)>-1&&Mr.mergeMyTeamMembers(y(Tr).call(Tr,function(qr){return qr.account===Mr.account})),Mr.options.onAddTeamMembers(or.simpleClone(Br)),br.enable){var Fr,Lr=br.putTeam(xr);return $(Or).call(Or,Mr.account)>-1?Fr=br.putTeamMembers(Tr):Mr.logger.log("team::onAddTeamMembers: user join team",hr),k.all([Fr,Lr])}},ur.onRemoveTeamMembers=function(sr,xr,Or){var Mr=this.db,br={team:sr,teamId:xr,accounts:Or};if(this.logger.info("team::onRemoveTeamMembers: ".concat(xr),Or),this.options.onRemoveTeamMembers&&this.options.onRemoveTeamMembers(or.simpleClone(br)),this.myTeamMembersMap&&this.myTeamMembersMap[xr]&&this.myTeamMembersMap[xr].followAccountIds){var hr=this.myTeamMembersMap[xr].followAccountIds;if(y(hr).call(hr,function(Lr){return Ie(Or).call(Or,Lr)}).length>0){this.myTeamMembersMap[xr].followAccountIds=y(hr).call(hr,function(Lr){return!Ie(Or).call(Or,Lr)});var Tr=this.myTeamMembersMap[xr];this.db.enable&&this.db.updateTeamMember(Tr),this.mergeMyTeamMembers(Tr),this.onUpdateTeamMember(Tr)}}if(sr&&Mr.enable){if($(Or).call(Or,this.account)===-1){var Br=Mr.removeTeamMembersByAccounts(xr,Or),Fr=k.resolve();return sr&&(Fr=Mr.putTeam(sr)),k.all([Br,Fr])}return Mr.leaveTeam(xr)}},ur.updateTeamManagers=function(sr,xr,Or,Mr,br){var hr=this.db,Tr=sr.attach.members=i(Or).call(Or,function(Ur){return{id:gr.genId(xr,Ur),type:Mr?"manager":"normal",updateTime:br,account:Ur}}),Br={teamId:""+xr,memberUpdateTime:br};sr.attach.team=Br;var Fr={team:Br,accounts:Or,isManager:Mr,members:Tr};if(this.logger.info("team::updateTeamManagers:",xr,Or,Mr),this.options.onUpdateTeamManagers(or.simpleClone(Fr)),hr.enable){var Lr=hr.updateTeam(Br),qr=hr.updateTeamManagers(xr,Or,Mr,br);return k.all([Lr,qr])}},ur.updateSuperTeamManagers=function(sr,xr,Or,Mr,br){var hr=this.db,Tr=sr.attach.members=i(Or).call(Or,function(Ur){return{id:gr.genId(xr,Ur),teamId:xr,account:Ur,type:Mr?"manager":"normal",updateTime:br}}),Br={teamId:""+xr,memberUpdateTime:br};sr.attach.team=Br;var Fr={team:Br,accounts:Or,isManager:Mr,members:Tr};if(this.logger.info("team::updateSuperTeamManagers:",xr,Or,Mr),this.options.onUpdateSuperTeamManagers(or.simpleClone(Fr)),hr.enable){var Lr=hr.updateSuperTeam(Br),qr=hr.updateSuperTeamMembers(Tr);return k.all([Lr,qr])}},ur.onDismissTeam=function(sr,xr){var Or=this.db,Mr={teamId:sr};if(this.logger.info("team::onDismissTeam:",sr),this.options.onDismissTeam(Mr),Or.enable)return Or.dismissTeam(sr,xr)},ur.transferTeam=function(sr,xr,Or,Mr){var br=this.db,hr=xr.teamId,Tr=xr.memberUpdateTime,Br={id:gr.genId(hr,Or),type:"normal",updateTime:Tr},Fr={id:gr.genId(hr,Mr),type:"owner",updateTime:Tr};sr.attach.members=[Br,Fr];var Lr={team:xr,from:Br,to:Fr};if(this.logger.info("team::transferTeam: from to",hr,Or,Mr),this.options.onTransferTeam(or.simpleClone(Lr)),br.enable)return br.transferTeam(xr,Or,Mr)},ur.transferSuperTeam=function(sr,xr,Or,Mr){var br=this.db,hr=xr.teamId,Tr=xr.memberUpdateTime,Br={teamId:hr,type:"normal",account:Or,updateTime:Tr},Fr={teamId:hr,type:"owner",account:Mr,updateTime:Tr};sr.attach.members=[Br,Fr];var Lr={team:xr,from:Br,to:Fr};if(this.logger.info("team::transferSuperTeam: from to ",hr,Or,Mr),this.options.onTransferSuperTeam(or.simpleClone(Lr)),br.enable)return br.transferSuperTeam(xr,Br,Fr)},ur.onUpdateTeamMembersMute=function(sr,xr,Or,Mr){var br=this.db,hr=i(Or).call(Or,function(Lr){return{id:gr.genId(xr.teamId,Lr),account:Lr,teamId:xr.teamId,mute:Mr,updateTime:xr.memberUpdateTime}});sr.attach.members=hr;var Tr={team:xr,accounts:Or,members:hr,mute:Mr};if(this.logger.info("team::onUpdateTeamMembersMute:",xr.teamId,Or,Mr),this.options.onUpdateTeamMembersMute(or.simpleClone(Tr)),br.enable){var Br=br.updateTeamMembers(hr),Fr=br.putTeam(xr);return k.all([Br,Fr])}},ur.onUpdateSuperTeamMembersMute=function(sr,xr,Or,Mr){var br=this.db,hr=i(Or).call(Or,function(Lr){return{id:Sr.genId(xr.teamId,Lr),account:Lr,teamId:xr.teamId,mute:Mr,updateTime:xr.memberUpdateTime}});sr.attach.members=hr;var Tr={team:xr,accounts:Or,members:hr,mute:Mr};if(this.logger.info("team::onUpdateSuperTeamMembersMute:",xr.teamId,Or,Mr),this.options.onUpdateSuperTeamMembersMute(or.simpleClone(Tr)),br.enable){var Br=br.updateSuperTeamMembers(hr),Fr=br.putSuperTeam(xr);return k.all([Br,Fr])}},ur.onHistoryMsgs=function(sr){sr.error||(sr.obj.msgs=this.message.reverseMsgs(sr.content.msgs))},ur.onmsgFtsInServer=function(sr){if(!sr.error){var xr=this.message.reverseMsgs(sr.content.msgs);sr.obj.msgs=xr,sr.content.msgs=xr}},ur.isFilterMsgs=function(sr){return!!y(sr[0])},ur.splitMsgs=function(sr,xr,Or,Mr){g(sr).call(sr,function(br){if(y(br))Mr.push(br);else switch(br.scene){case"p2p":xr.push(br);break;case"team":Or.push(br)}})},ur.markMsgRead=function(sr,xr){if(or.isArray(sr)||(sr=[sr]),this.db.enable||this.options.autoMarkRead||xr){var Or=i(sr).call(sr,function(Mr){return{flag:"msg",idServer:Mr.idServer,scene:Mr.scene,filter:y(Mr),type:Mr.type,attachType:Mr.attach&&Mr.attach.type}});this.msgAckBufferManager.add(Or)}},ur.markSysMsgRead=function(sr,xr){if(or.isArray(sr)||(sr=[sr]),this.db.enable||this.options.autoMarkRead||xr){var Or=i(sr).call(sr,function(Mr){return{flag:"systemMsg",idServer:Mr.idServer,scene:Mr.scene,filter:y(Mr),type:Mr.type}});this.msgAckBufferManager.add(Or)}},ur.handleMsgsAck=function(sr){var xr,Or=this,Mr={p2pSysMsgs:{sid:7,cid:3,msgs:[]},p2pMsgs:{sid:7,cid:2,msgs:[]},superTeamSysMsgs:{sid:21,cid:19,msgs:[]},teamMsgs:{sid:8,cid:3,msgs:[]},filterSysMsgs:{sid:101,cid:3,msgs:[]},filterMsgs:{sid:101,cid:2,msgs:[]},netcallMsgs:{sid:9,cid:11,msgs:[]}};g(sr).call(sr,function(br){/^(netcallBill|netcallMiss|netcallReject)$/.test(br.attachType)?Mr.netcallMsgs.msgs.push(br):y(br)?br.flag==="systemMsg"?Mr.filterSysMsgs.msgs.push(br):Mr.filterMsgs.msgs.push(br):br.flag!=="systemMsg"?br.scene==="p2p"?Mr.p2pMsgs.msgs.push(br):br.scene==="team"&&Mr.teamMsgs.msgs.push(br):br.scene==="superTeam"?Mr.superTeamSysMsgs.msgs.push(br):Mr.p2pSysMsgs.msgs.push(br)}),g(xr=L(Mr)).call(xr,function(br){return Or.doMarkMsgsRead(Mr[br].sid,Mr[br].cid,Mr[br].msgs)})},ur.doMarkMsgsRead=function(sr,xr,Or){var Mr;Or&&Or.length&&(this.logger.log("markMsgRead::batchMarkRead",sr,xr,Or),y(Mr=i(Or).call(Or,function(br){return br.idServer})).call(Mr,function(br){var hr=ie(br);return!isNaN(hr)}).length>0?this.sendCmd("batchMarkRead",{sid:sr,cid:xr,ids:i(Or).call(Or,function(br){return br.idServer})}):this.logger.log("markMsgRead::batchMarkRead","idServer is not number. ignore"))}},function(t,r,e){var n=e(51),g=e(10),y=e(2),i=e(5),k=e(15),L=e(3),$=e(34),V=e(52),z=e(53),re=e(54),oe=e(55),le=e(42);function ue(qe,jt){var Fe=i(qe);if(V){var Et=V(qe);jt&&(Et=k(Et).call(Et,function(cr){return z(qe,cr).enumerable})),Fe.push.apply(Fe,Et)}return Fe}function ie(qe){for(var jt=1;jt<arguments.length;jt++){var Fe,Et,cr=arguments[jt]!=null?arguments[jt]:{};jt%2?y(Fe=ue(Object(cr),!0)).call(Fe,function(er){n(qe,er,cr[er])}):re?oe(qe,re(cr)):y(Et=ue(Object(cr))).call(Et,function(er){le(qe,er,z(cr,er))})}return qe}var ae=e(37).fn,Ie=e(784),de=e(786);function Ce(qe,jt,Fe){var Et=this,cr=this.timetags&&this.timetags.sync;this.db.enable&&cr&&jt&&this.db.getMsgByIdClient(qe).then(function(er){if(er&&!(er.commentTimetag&&er.commentTimetag<=cr&&er.time<=cr)){if(er.commentTimetag=jt.time,er.comments=er.comments||[],Fe){var nr;er.comments=k(nr=er.comments).call(nr,function(ur){return ur.body!==jt.body||ur.from!==jt.from})}else{for(var dr,ir=0;ir<er.comments.length;ir++)if(er.comments[ir].from===jt.from&&er.comments[ir].body===jt.body){er.comments[ir]=jt,dr=!0;break}dr||er.comments.push(jt)}var tr={idClient:er.idClient,comments:er.comments,commentTimetag:er.commentTimetag};Et.db.updateMsg(tr)}})}function Ue(qe){qe.scene=this.message.sceneReverseMap[+qe.scene]||qe.scene,qe.time=+qe.time}ae.processMsgExtend=function(qe){switch(qe.cmd){case"getThreadMsgs":this.onGetThreadMsgs(qe);break;case"getMsgsByIdServer":this.onGetMsgsByIdServer(qe);break;case"addQuickComment":this.changeQuickComment(qe);break;case"deleteQuickComment":this.changeQuickComment(qe,!0);break;case"onQuickComment":case"syncAddQuickComment":this.onQuickComment(qe);break;case"onDeleteQuickComment":case"syncDeleteQuickComment":this.onQuickComment(qe,!0);break;case"getQuickComments":this.getQuickComments(qe);break;case"addCollect":case"updateCollect":this.addCollect(qe);break;case"deleteCollects":this.deleteCollects(qe);break;case"getCollects":this.getCollects(qe);break;case"addStickTopSession":case"syncAddStickTopSession":this.onChangeStickTopSession(qe,"add");break;case"updateStickTopSession":case"syncUpdateStickTopSession":this.onChangeStickTopSession(qe,"update");break;case"deleteStickTopSession":case"syncDeleteStickTopSession":this.onChangeStickTopSession(qe,"delete");break;case"addMsgPin":case"onAddMsgPin":case"syncAddMsgPin":this.pinMsgChange(qe,"add");break;case"updateMsgPin":case"onUpdateMsgPin":case"syncUpdateMsgPin":this.pinMsgChange(qe,"update");break;case"deleteMsgPin":case"onDeleteMsgPin":case"syncDeleteMsgPin":this.pinMsgChange(qe,"delete");break;case"getMsgPins":this.getMsgPins(qe)}},ae.onGetThreadMsgs=function(qe){if(!qe.error){var jt;qe.obj.msgs=this.message.reverseMsgs(qe.content.msgs),qe.obj.threadMsg=g(jt=this.message).call(jt,qe.content.threadMsg);var Fe=qe.content.threadMsgsMeta||{};qe.obj.total=Fe.total,qe.obj.timetag=Fe.lastMsgTime}},ae.onGetMsgsByIdServer=function(qe){qe.error||(qe.obj.msgs=this.message.reverseMsgs(qe.content.msgs))},ae.changeQuickComment=function(qe,jt){qe.error||(qe.obj.comment.time=qe.content.timetag,qe.obj.comment=g(Ie).call(Ie,qe.obj.comment),Ue.call(this,qe.obj.msg),Ce.call(this,qe.obj.msg.idClient,qe.obj.comment,jt))},ae.onQuickComment=function(qe,jt){if(qe.content){var Fe=qe.content,Et=Fe.comment,cr=Fe.msg;Et&&cr&&(Ue.call(this,cr),Et=g(Ie).call(Ie,Et),jt?this.options.onDeleteQuickComment(qe.content.msg,Et):this.options.onQuickComment(qe.content.msg,Et),Ce.call(this,cr.idClient,Et,jt))}},ae.getQuickComments=function(qe){var jt,Fe=this;if(!qe.error){var Et=qe.obj.idMap,cr=qe.obj.indexMap,er=qe.content&&qe.content.commentRes||[];y(er).call(er,function(nr){var dr=[],ir=Fe.parser.unserializeMap.comment;if(+nr.modify==1)try{dr=JSON.parse(nr.detail)}catch(ur){Fe.logger.warn("getQuickComments parse detail error",ur)}if(y(dr).call(dr,function(ur,or){var fr,lr={};y(fr=i(ur)).call(fr,function(gr){lr[ir[gr]]=ur[gr]}),lr=g(Ie).call(Ie,lr),dr[or]=lr}),nr.timestamp=+nr.timestamp,Et[nr.idClient]){var tr={idClient:nr.idClient,commentTimetag:nr.timestamp};Et[nr.idClient].commentTimetag=nr.timestamp,+nr.modify==1&&(Et[nr.idClient].comments=dr,tr.comments=dr),Fe.db.enable&&Fe.db.updateMsg(tr)}else Et[nr.idClient]={idServer:nr.idServer,idClient:nr.idClient,comments:dr,commentTimetag:nr.timestamp,scene:Fe.message.sceneReverseMap[nr.scene]||nr.scene}}),qe.obj=[],y(jt=i(cr)).call(jt,function(nr){qe.obj[cr[nr]]=Et[nr]})}},ae.addCollect=function(qe){qe.error||(qe.obj.collect=g(de).call(de,qe.content.collect))},ae.deleteCollects=function(qe){qe.error||(qe.obj.deleteNum=qe.content.deleteNum)},ae.getCollects=function(qe){if(!qe.error){var jt=[],Fe=qe.content.collectList||[];y(Fe).call(Fe,function(Et){jt.push(g(de).call(de,Et))}),qe.obj.collectList=jt,qe.obj.total=qe.content.total}},ae.onChangeStickTopSession=function(qe,jt){var Fe=this;if(!qe.error){var Et=qe.content.stickTopSession||qe.obj.stickTopSession||{},cr=qe.content.timetag||+Et.updateTime,er=Et.id.split("|");er[0]==="super_team"&&(er[0]="superTeam"),Et={id:er.join("-"),scene:er[0],to:er[1],topCustom:Et.topCustom||""},jt==="delete"?Et.isTop=!1:jt==="add"&&(Et.isTop=!0),Et=this.onUpdateSession(Et),qe.obj&&(qe.obj.stickTopSession=Et),this.db.enable&&(this.db.updateSession(Et).then(function(nr){nr||Fe.db.putSession(Et)}),this.db.updateTimetag("stickTopSessions",cr))}},ae.pinMsgChange=function(qe,jt){var Fe=this;if(!qe.error){qe.content=qe.content||{};var Et=this,cr=this.db,er=qe.obj&&qe.obj.msg,nr=qe.content.msg||er||{},dr=qe.content.pinTag||qe.obj.pinTag,ir=qe.content.timetag||+dr.updateTime,tr=L.resolve();Ue.call(this,nr),cr.enable&&(tr=cr.getMsgByIdClient(nr.idClient)),dr.createTime&&(dr.createTime=+dr.createTime),dr.updateTime&&(dr.updateTime=+dr.updateTime),tr.then(function(ur){return nr=ur||nr,ur?nr=ur:nr.sessionId=nr.scene+"-"+Fe.message.Message.getMsgTarget(nr,Fe.account),er?(qe.obj.msg=nr,qe.obj.pinTag=dr):Fe.options.onPinMsgChange({msg:nr,pinTag:dr},jt),function(){cr.enable&&cr[jt==="delete"?"deleteMsgPin":"putMsgPin"](ie(ie({},nr),{},{pinFrom:dr.pinFrom,pinCustom:dr.pinCustom})).then(function(){var or="pin-"+nr.sessionId,fr=Et.timetags.sync;return cr.getTimetag(or).then(function(lr){return lr>fr?cr.updateTimetag(or,ir):L.resolve()})}).catch(function(or){Et.logger.error("msgExtend::pinMsgChange:error",or)})}(),L.resolve}).then(function(){}),qe.promise=tr}},ae.getMsgPins=function(qe){var jt=this;if(!qe.error){var Fe=this.db,Et=qe.content||{};if(Et.pins=Et.pins||[],Et.modify){var cr,er=[];Fe.enable&&(Fe.updateTimetag("pin-"+qe.obj.id,Et.timetag),y(cr=Et.pins).call(cr,function(nr){nr.sessionId=qe.obj.id,er.push(Fe.getMsgByIdClient(nr.idClient))})),qe.promise=L.all(er).then(function(nr){var dr;y(dr=Et.pins).call(dr,function(ir,tr){nr[tr]?$(ir,nr[tr]):(ir.sessionId=qe.obj.id,Ue.call(jt,ir))}),qe.obj.pins=Et.pins,Fe.enable&&Fe.deleteMsgPins(qe.obj.id).then(function(){return Fe.putMsgPins(Et.pins)}).catch(function(ir){jt.logger.error("msgExtend::getMsgPins:change db error",ir)})})}else Fe.enable?(Fe.updateTimetag("pin-"+qe.obj.id,Et.timetag),qe.promise=Fe.getMsgPins(qe.obj.id).then(function(nr){qe.obj.pins=nr||[]})):qe.obj.pins=[]}}},function(t,r,e){var n=e(843);t.exports=n},function(t,r,e){e(844);var n=e(14);t.exports=n.Number.isInteger},function(t,r,e){e(1)({target:"Number",stat:!0},{isInteger:e(845)})},function(t,r,e){var n=e(30),g=Math.floor;t.exports=Number.isInteger||function(y){return!n(y)&&isFinite(y)&&g(y)===y}},function(t,r,e){var n=e(127),g=e(3),y=e(2),i=e(4),k=["time","from"],L=e(37).fn,$=e(0);L.onOfflineMsgReceipts=function(V){var z,re=this,oe=re.db,le=V.content.msgReceipts,ue=[],ie=g.resolve();this.logger.info("onOfflineMsgReceipts",le),y(le).call(le,function(ae){z={id:"p2p-"+ae.from,msgReceiptTime:+ae.time},re.cacheSyncedSession(z)}),re.syncResult.msgReceipts=ue,oe.enable&&(ie=oe.updateMsgReceiptsTimetag(V.content.timetag)),ie.cmd=ue,re.syncPromiseArray.push(ie)},L.shouldUpdateSessionFromMsgReceipt=function(V,z){return!V||!V.msgReceiptServerTime||z.time>V.msgReceiptServerTime},L.genSessionFromMsgReceipt=function(V,z){var re=z.time,oe={id:z.sessionId,msgReceiptTime:re,msgReceiptServerTime:re};return V&&V.id===z.sessionId&&(oe=$.merge({},V,oe)),V&&V.updateTime||(oe.updateTime=re),oe},L.onMsgReceipt=function(V){var z=this,re=z.db,oe=V.content.msgReceipt;oe.time=+oe.time;var le=oe.idClient,ue=g.resolve();re.enable&&le&&(ue=re.getMsgByIdClient(le)),this.logger.info("onMsgReceipt::",oe),ue.then(function(ie){if(ie){if(!ie.idServer)return void(z.msgReceiptTasks[le]=oe);ie.time}else oe.time;oe.msgReceiptTime=oe.time,oe.sessionId="p2p-".concat(oe.from),z.updateSessionMsgReceiptTime(oe),oe.time,oe.from;var ae=n(oe,k);z.options.onMsgReceipts([ae])})},L.resolveMsgReceiptTask=function(V){var z=this.msgReceiptTasks[V.idClient];z&&(z.msgReceiptTime=V.time,this.updateSessionMsgReceiptTime(z))},L.updateSessionMsgReceiptTime=function(V){var z=this.db,re={id:"p2p-"+V.from,msgReceiptTime:V.msgReceiptTime,msgReceiptServerTime:V.time};(this.getSessionInCache(re.id)||{}).msgReceiptTime>=re.msgReceiptTime?this.logger.warn("receive old msgReceiptTime",V):(z.enable&&z.putSession(re),this.onUpdateSession(re))},L.onSendMsgReceipt=function(V){var z;if(!V.error)if(V.obj&&V.obj.msgReceipt){var re=V.obj.msgReceipt,oe=+re.time,le=+V.content.msgReceipt.time,ue=this.getSessionInCache("p2p-"+re.to);ue?(this.logger.info(i(z="sendMsgReceipt on:: param time ".concat(oe,", res time ")).call(z,le)),ue.msgReceiptSendTime=Math.min(oe,le)):this.logger.info("sendMsgReceipt on:: session is undefined or logically deleted, failed to send read receipt")}else this.logger.info("sendMsgReceipt on:: origin msg is missing, it maybe timeout")},L.shouldSendMsgReceipt=function(V){if(V&&V.scene==="p2p"&&V.status==="success"){var z=this.getSessionInCache(V.sessionId);if(z){var re=z.msgReceiptSendTime;return!re||re<V.time}}return!1},L.isMsgRemoteRead=function(V){if(V&&V.scene==="p2p"&&V.flow==="out"&&V.status==="success"){var z=this.getSessionInCache(V.sessionId);if(z&&z.msgReceiptTime)return V.time<=z.msgReceiptTime}return!1}},function(t,r,e){var n=e(60),g=e(61),y=e(56),i=e(10),k=e(2),L=e(4),$=e(11),V=e(3),z=e(93),re=e(125),oe=e(5),le=e(15),ue=e(43),ie=e(9),ae=e(23),Ie=e(95),de=e(68),Ce=e(78),Ue=e(64),qe=e(28);function jt(or,fr){var lr=Ce!==void 0&&Ue(or)||or["@@iterator"];if(!lr){if(qe(or)||(lr=function(Ir,Nr){var Er;if(Ir){if(typeof Ir=="string")return Fe(Ir,Nr);var sr=ie(Er=Object.prototype.toString.call(Ir)).call(Er,8,-1);if(sr==="Object"&&Ir.constructor&&(sr=Ir.constructor.name),sr==="Map"||sr==="Set")return de(Ir);if(sr==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(sr))return Fe(Ir,Nr)}}(or))||fr&&or&&typeof or.length=="number"){lr&&(or=lr);var gr=0,Sr=function(){};return{s:Sr,n:function(){return gr>=or.length?{done:!0}:{done:!1,value:or[gr++]}},e:function(Ir){throw Ir},f:Sr}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var wr,kr=!0,mr=!1;return{s:function(){lr=lr.call(or)},n:function(){var Ir=lr.next();return kr=Ir.done,Ir},e:function(Ir){mr=!0,wr=Ir},f:function(){try{kr||lr.return==null||lr.return()}finally{if(mr)throw wr}}}}function Fe(or,fr){(fr==null||fr>or.length)&&(fr=or.length);for(var lr=0,gr=new Array(fr);lr<fr;lr++)gr[lr]=or[lr];return gr}var Et=e(37).fn,cr=e(161),er=e(162),nr=e(0),dr=e(109).EMSyncType;function ir(or,fr){return tr.apply(this,arguments)}function tr(){return(tr=g(n.mark(function or(fr,lr){var gr,Sr,wr,kr,mr,Ir,Nr,Er,sr,xr,Or,Mr,br,hr=this;return n.wrap(function(Tr){for(;;)switch(Tr.prev=Tr.next){case 0:if(wr=(Sr=this).db,kr=[],k(fr).call(fr,function(Br){hr.revokeMsgUniqueCheck(Br.idClient),kr.push(Br.idClient)}),Sr.options.rollbackDelMsgUnread){Tr.next=14;break}return Tr.next=7,wr.deleteMsg(kr);case 7:if(Tr.t0=Tr.sent,Tr.t0){Tr.next=10;break}Tr.t0=[];case 10:return mr=Tr.t0,mr=Object.prototype.toString.call(mr)==="[object Array]"?mr:[mr],Sr.logger.info("msg::_deleteMsgSelfBatchInDb, rollback false, affect: ".concat(mr.length," rows")),Tr.abrupt("return");case 14:return Ir=!1,Nr=Sr.options.cbUpdateSession||ae(gr=Sr.updateSessionInDbWithNotify).call(gr,Sr),Er=Sr.getSessionInCache(lr)||{id:lr},sr=Er.lastMsg||{},Ie(kr).call(kr,sr.idClient)&&(Ir=!0),Sr.logger.info("msg::_deleteMsgSelfBatchInDb session change before:",lr,Ir,Er.unread),Tr.next=22,wr.deleteMsg(kr);case 22:if(Tr.t1=Tr.sent,Tr.t1){Tr.next=25;break}Tr.t1=[];case 25:if(xr=Tr.t1,xr=Object.prototype.toString.call(xr)==="[object Array]"?xr:[xr],Sr.logger.info("msg::_deleteMsgSelfBatchInDb affect:",xr.length," rows"),!Ir){Tr.next=34;break}return Tr.next=31,wr.getMsgs({sessionId:lr,limit:1});case 31:Or=Tr.sent,sr=Or&&Or[0]?Or[0]:null,Er.lastMsg=sr;case 34:if(Mr=!1,Er&&Er.unread&&(br=Er&&Er.ack||0,k(xr).call(xr,function(Br){var Fr=!0;if(Br.type==="notification")try{Fr=Sr.options.shouldCountNotifyUnread(Br)}catch(Lr){throw Sr.logger.error("userOption:shouldCountNotifyUnread function error",Lr),Lr}Fr&&br<Br.time&&Br.flow==="in"&&(Er.unread=Er.unread>0?Er.unread-1:0,Mr=!0)})),!Ir&&!Mr){Tr.next=39;break}return Sr.logger.info("msg::_deleteMsgSelfBatchInDb session change after:",lr,Er.unread),Tr.abrupt("return",Nr(Er));case 39:case"end":return Tr.stop()}},or,this)}))).apply(this,arguments)}function ur(or,fr){fr=fr||new Date().getTime();var lr=this.db,gr=this.getSessionInCache(or),Sr=this.options.rollbackClearMsgsUnread!==!1,wr=[];return lr.enable&&wr.push(lr.deleteMsgsBySessionId({sessionId:or,end:fr})),Sr&&gr&&(gr=this.mergeSession({id:gr.id,unread:0,lastMsg:null,unreadMsgs:[]}),gr=this.onUpdateSession(gr)),lr.enable&&Sr&&gr&&wr.push(lr.updateSession(gr)),V.all(wr)}Et.onDeleteMsg=function(or){var fr=this.db;if(delete or.obj.sysMsg,!or.error){var lr=or.obj.msg;or.promise=this.deleteLocalMsg(lr).then(function(){if(fr.enable){var gr=lr.scene==="superTeam"?"deleteSuperTeamMsg":"deleteMsg";fr.getTimetag(gr).then(function(Sr){Sr=Sr||0,y()+1>=Sr&&fr.updateTimetag(gr,y()+1)})}})}},Et.onMsgDeleted=function(or,fr){var lr=this;if(!lr.canHandleDeletedMsgInSyncing)return lr.logger.info("msg::onMsgDeleted:is in syncing ..."),void lr.unhandledSysMsgsForDeletedMsgs.push({packet:or,isSuperTeam:fr});if(!or.error){var gr=lr.db,Sr=i(cr).call(cr,or.content.sysMsg);Sr=lr.processDeleteMsgSysMsg(Sr),fr||lr.markSysMsgRead(Sr),lr.deleteLocalMsg(Sr.msg).then(function(){if(gr.enable){var wr=fr?"deleteSuperTeamMsg":"deleteMsg";gr.updateTimetag(wr,Sr.time+1)}lr.handleSysMsg(Sr)})}},Et.processDeleteMsgSysMsg=function(or){var fr;return or.msg={},k(fr=["scene","from","to"]).call(fr,function(lr){or.msg[lr]=or[lr]}),or.msg.idClient=or.deletedIdClient,or.msg.idServer=or.deletedIdServer,or.msg.time=or.deletedMsgTime,or.msg.fromNick=or.deletedMsgFromNick,or.opeAccount=or.opeAccount||or.from,or.msg.opeAccount=or.opeAccount,this.message.Message.setExtra(or.msg,this.account),or},Et.onDeleteMsgOfflineRoaming=function(or){if(!or.error){var fr,lr=this,gr=+or.content.type==1?"offline":"roaming",Sr=cr.reverseSysMsgs(or.content.sysMsgs,{mapper:function(Ir){return lr.processDeleteMsgSysMsg(Ir)}}),wr=Sr&&Sr[0]&&Sr[0].scene==="superTeam";lr.logger.info(L(fr="msg::onDeleteMsgOfflineRoaming: on delete ".concat(gr," ")).call(fr,wr?"superTeam":""," idServer deletedIdClient deletedIdClient="),$(Sr).call(Sr,function(Ir){var Nr,Er;return L(Nr=L(Er="".concat(Ir.idServer,"-")).call(Er,Ir.deletedIdServer,"-")).call(Nr,Ir.deletedIdClient)})),gr==="offline"&&lr.markSysMsgRead(Sr);var kr=or.content.timetag;wr?(lr.timetags.deleteSuperTeamMsg=kr,lr.syncResult.deleteSuperTeamMsgTimetag=kr):(lr.timetags.deleteMsg=kr,lr.syncResult.deleteMsgTimetag=kr);var mr=lr.putSysMsg(Sr,"offlineSysMsgs").catch(function(Ir){return lr.logger.error("msgDelete::onDeleteMsgOfflineRoaming: ",Ir),V.reject(Ir)});mr.cmd="deleteMsgSysMsgs "+gr,lr.syncPromiseArray.push(mr),lr.syncResult.deleteMsgSysMsgs=lr.syncResult.deleteMsgSysMsgs||[],lr.syncResult.deleteMsgSysMsgs.push({type:gr,sysMsgs:Sr})}},Et.deleteMsgOfflineRoaming=function(or,fr){if(!or)return V.resolve();var lr=this;lr.logger.info("msg::deleteMsgOfflineRoaming: ",$(or).call(or,function(wr){var kr;return wr.type+" "+$(kr=wr.sysMsgs).call(kr,function(mr){var Ir,Nr;return L(Ir=L(Nr="".concat(mr.idServer,"-")).call(Nr,mr.deletedIdServer,"-")).call(Ir,mr.deletedIdClient)})}),nr.secureOutput("session",fr));var gr=lr.db,Sr=[];return k(or).call(or,function(wr){var kr;k(kr=wr.sysMsgs).call(kr,function(mr){var Ir=lr.deleteLocalMsg(mr.msg,{cbUpdateSession:function(Nr){Nr=lr.mergeSession(Nr),Nr=z(er).call(er,Nr);var Er=nr.findObjIndexInArray(fr,{value:Nr.id});if(Er!==-1&&(fr[Er]=nr.merge({},fr[Er],Nr)),gr.enable)return gr.updateSession(Nr)}});Sr.push(Ir)})}),V.all(Sr).then(function(){gr.enable&&(lr.syncResult.deleteMsgTimetag&&gr.updateTimetag("deleteMsg",lr.syncResult.deleteMsgTimetag),lr.syncResult.deleteSuperTeamMsgTimetag&&gr.updateTimetag("deleteSuperTeamMsg",lr.syncResult.deleteSuperTeamMsgTimetag))})},Et.deleteMsgSelf=function(or){if(!or.error){var fr=this.db,lr=or.obj&&or.obj.deleteMsgSelfTag;if(lr){var gr=or.content&&or.content.timetag;lr.scene=lr.scene+""=="1"?"p2p":"team";var Sr=[this.deleteLocalMsg(lr)];gr<=this.timetags.deleteMsgSelf||(this.timetags.deleteMsgSelf=gr,fr.enable&&Sr.push(fr.updateDeleteMsgSelf(gr))),or.promise=V.all(Sr)}}},Et.deleteMsgSelfBatch=function(){var or=g(n.mark(function fr(lr){var gr,Sr,wr,kr,mr,Ir,Nr,Er;return n.wrap(function(sr){for(;;)switch(sr.prev=sr.next){case 0:if(!lr.error){sr.next=2;break}return sr.abrupt("return");case 2:if(Sr=this,wr=this.db,(kr=lr.obj&&lr.obj.deleteMsgSelfTags)&&kr.length>0){sr.next=7;break}return sr.abrupt("return");case 7:if(mr=re(kr).call(kr,function(xr,Or){var Mr=Or.sessionId;if(xr[Mr]=xr[Mr]||[],xr[Mr].push(Or),!wr.enable){var br=Sr.getSessionInCache(Mr);br&&br.lastMsg&&Or&&br.lastMsg.idClient===Or.idClient&&(br.lastMsg=null,Sr.onUpdateSession(br))}return xr},{}),wr.enable){sr.next=11;break}return k(Ir=oe(mr)).call(Ir,function(xr){var Or=mr[xr],Mr=Sr.getSessionInCache(xr);if(Sr.options.rollbackDelMsgUnread&&Mr){var br=Mr.ack||0,hr=le(Or).call(Or,function(Tr){var Br=!0;if(Tr.type==="notification")try{Br=Sr.options.shouldCountNotifyUnread(Tr)}catch(Fr){throw Sr.logger.error("userOption:shouldCountNotifyUnread function error",Fr),Fr}return Sr.message.Message.setFlow(Tr,Sr.account),Br&&br<Tr.time&&Tr.flow==="in"});hr.length>0&&Mr.unread&&(Mr.unread=Mr.unread-hr.length>=0?Mr.unread-hr.length:0,Sr.onUpdateSession(Mr))}}),sr.abrupt("return",V.resolve());case 11:Nr=$(gr=oe(mr)).call(gr,function(xr){var Or=mr[xr];return ir.call(Sr,Or,xr)}),(Er=lr.content&&lr.content.timetag)<=Sr.timetags.deleteMsgSelf||(Sr.timetags.deleteMsgSelf=Er,Nr.push(wr.updateDeleteMsgSelf(Er))),lr.promise=V.all(Nr);case 15:case"end":return sr.stop()}},fr,this)}));return function(fr){return or.apply(this,arguments)}}(),Et.onDeleteMsgSelf=function(or){var fr=this,lr=this.db,gr=or.content.deleteMsgSelfTag;gr.scene=gr.scene+""=="1"?"p2p":"team",fr.options.onDeleteMsgSelf([gr]),fr.deleteLocalMsg(gr).then(function(){var Sr=gr.deletedTime;return Sr<=fr.timetags.deleteMsgSelf||!lr.enable?V.resolve():(fr.timetags.deleteMsgSelf=Sr,lr.updateDeleteMsgSelf(Sr))}).catch(function(Sr){fr.logger.error("onDeleteMsgSelf error",Sr)})},Et.onDeleteMsgSelfBatch=function(or){var fr=this;if(!or.error){var lr={1:"p2p",2:"team"},gr=nr.get(or,"content.deleteMsgSelfTags")||[];k(gr).call(gr,function(wr){var kr;wr.scene=lr[wr.scene],wr.sessionId=L(kr="".concat(wr.scene,"-")).call(kr,fr.message.Message.getMsgTarget(wr,fr.account)),wr.deletedTime=ue(wr.deletedTime),wr.time=ue(wr.time)});var Sr=nr.get(or,"content.deleteMsgSelfTags[0].deletedTime");Sr=ue(Sr)||0,this.options.onDeleteMsgSelf(gr),this.deleteMsgSelfBatch({obj:{deleteMsgSelfTags:gr},content:{timetag:Sr}})}},Et.clearServerHistoryMsgs=function(or){if(!or.error){var fr=this.db,lr=or.obj&&or.obj.clearMsgsParamsWithSync;if(lr){var gr=(lr.type&&lr.type.toString()==="2"?"team":"p2p")=="p2p"?"p2p-".concat(lr.otherAccid):"team-".concat(lr.toTid),Sr=or.content&&ue(or.content.timetag);Sr&&Sr>this.timetags.sessionHistoryMsgsDelete&&(this.timetags.sessionHistoryMsgsDelete=Sr,fr.enable&&fr.updateTimetag("sessionHistoryMsgsDelete",this.timetags.sessionHistoryMsgsDelete)),ur.call(this,gr,Sr)}}},Et.onClearServerHistoryMsgs=function(or){if(!or.error){var fr=this.db,lr=or.content&&or.content.sessionHistoryMsgsDeleteTag;if(lr){var gr=(lr.type&&lr.type.toString()==="2"?"team":"p2p")=="p2p"?"p2p-".concat(lr.otherAccid):"team-".concat(lr.toTid),Sr=lr.ext,wr=ue(lr.time);this.options.onClearServerHistoryMsgs&&this.options.onClearServerHistoryMsgs([{sessionId:gr,time:wr,ext:Sr}]),wr<=this.timetags.sessionHistoryMsgsDelete||(this.timetags.sessionHistoryMsgsDelete=wr,fr.enable&&fr.updateTimetag("sessionHistoryMsgsDelete",this.timetags.sessionHistoryMsgsDelete)),ur.call(this,gr,wr)}}},Et.syncSessionHistoryMsgsDelete=function(or){if(!or.error){var fr=this.db,lr=or.content&&or.content.sessionHistoryMsgsDeleteTags;if(lr&&lr.length>0){var gr=$(lr).call(lr,function(wr){return{sessionId:(wr.type&&wr.type.toString()==="2"?"team":"p2p")=="p2p"?"p2p-".concat(wr.otherAccid):"team-".concat(wr.toTid),time:ue(wr.time)}});this.reporterHook.emit("reporter/syncItemComplete",dr.kSyncType4_24),this.options.onClearServerHistoryMsgs&&this.options.onClearServerHistoryMsgs(gr),this.syncResult.clearServerHistoryMsgs=gr;var Sr=0;k(gr).call(gr,function(wr){wr.time>Sr&&(Sr=wr.time)}),fr.enable&&fr.updateTimetag("sessionHistoryMsgsDelete",Sr)}}},Et.syncDeleteMsgSelf=function(or){var fr=this,lr=this.db,gr=or.content.deletedMsgs;if(gr&&gr.length!==0){var Sr=[];k(gr).call(gr,function(wr){wr.scene=wr.scene==="1"?"p2p":"team",wr.deletedTime=+wr.deletedTime,wr.time=+wr.time,Sr.push(fr.deleteLocalMsg(wr))}),fr.options.onDeleteMsgSelf(gr),V.all(Sr).then(function(){var wr=ie(gr).call(gr,-1)[0].deletedTime;if(!(fr.timetags.deleteMsgSelf>=wr))return fr.timetags.deleteMsgSelf=wr,lr.enable?lr.updateDeleteMsgSelf(wr):void 0}).catch(function(wr){fr.logger.error("syncDeleteMsgSelf error",wr)})}},Et.deleteLocalMsg=function(){var or=g(n.mark(function fr(lr,gr){var Sr,wr,kr,mr,Ir,Nr,Er,sr,xr,Or,Mr,br;return n.wrap(function(hr){for(;;)switch(hr.prev=hr.next){case 0:if(lr){hr.next=2;break}return hr.abrupt("return");case 2:if(kr=(wr=this).db,mr=(gr=gr||{}).cbUpdateSession||ae(Sr=wr.updateSessionInDbWithNotify).call(Sr,wr),this.revokeMsgUniqueCheck(lr&&lr.idClient),Ir=lr.sessionId||lr.scene+"-"+this.message.Message.getMsgTarget(lr,this.account),Nr=!1,Er=wr.getSessionInCache(Ir),sr=!0,lr.type!=="notification"){hr.next=20;break}hr.prev=12,sr=wr.options.shouldCountNotifyUnread(lr),hr.next=20;break;case 16:throw hr.prev=16,hr.t0=hr.catch(12),wr.logger.error("userOption:shouldCountNotifyUnread function error",hr.t0),hr.t0;case 20:if(wr.options.rollbackDelMsgUnread&&Er&&(xr=Er.ack||0,sr&&Er&&xr<lr.time&&lr.from!==wr.account&&Er.unread&&(wr.logger.info("msgDelete::deleteLocalMsg:cache.getSessions: unread",Er.id,Er.unread),Er.unread=Er.unread-1,Nr=!0)),Er&&Er.lastMsg&&Er.lastMsg.idClient==lr.idClient&&(wr.logger.info("msgDelete::deleteLocalMsg:cache.getSessions: lastMsg",Er.id,Er.unread),Er.lastMsg=null,Nr=!0),!kr.enable){hr.next=49;break}return Or=null,hr.next=26,kr.getMsgByIdClient(lr.idClient);case 26:return hr.sent||wr.logger.info("msgDelete::deleteLocalMsg::db.deleteMsg no find in DB",lr),wr.logger.info("msgDelete::deleteLocalMsg::db.deleteMsg ",lr.idClient),hr.next=31,kr.deleteMsg(lr.idClient);case 31:if(!Er||Er.lastMsg!==null){hr.next=36;break}return hr.next=34,kr.getMsgs({sessionId:Ir,limit:1});case 34:(Mr=hr.sent)&&Mr[0]&&(Or=Mr[0]);case 36:if(Er||!wr.options.rollbackDelMsgUnread){hr.next=46;break}return wr.logger.info("msgDelete::deleteLocalMsg::Can not find session in cache,will find in DB",Ir),hr.next=40,kr.getSession(Ir);case 40:if(br=hr.sent){hr.next=43;break}return hr.abrupt("return");case 43:xr=(Er=br).ack||0,sr&&Er&&xr<lr.time&&lr.flow==="in"&&Er.unread&&(wr.logger.info("msgDelete::deleteLocalMsg:db.getSessions: unread",br.id,br.unread),Er.unread=Er.unread-1,Nr=!0);case 46:if(Er&&Er.lastMsg===null&&Or&&(wr.logger.info("msgDelete::deleteLocalMsg:db.getSessions: lastMsg",Ir,Or),Er.lastMsg=Or||null,Nr=!0),!Nr){hr.next=49;break}return hr.abrupt("return",mr(Er));case 49:if(kr.enable||!Nr){hr.next=52;break}return wr.onUpdateSession(Er),hr.abrupt("return");case 52:case"end":return hr.stop()}},fr,this,[[12,16]])}));return function(fr,lr){return or.apply(this,arguments)}}(),Et.deleteLocalMsgs=function(or){var fr=this,lr=fr.db;return new V(function(gr,Sr){if(function(wr){var kr=fr.getSessionInCache(or.sessionId);if(kr&&or.updateSession){var mr=kr.lastMsg;mr&&(!or.start&&!or.end||mr.time>or.start&&mr.time<or.end)&&(kr.lastMsg=null,fr.logger.log("deleteLocalMsgs::delete cacheSession lastMsg done, options is",or),lr.enable||(fr.onUpdateSession(kr),wr()))}}(gr),lr.enable)return lr.deleteMsgsBySessionId(or).then(function(){or.updateSession&&fr.checkAndUpdateLocalSessionByMsg(or.sessionId),gr()},function(wr){return Sr(wr)})})},Et.deleteLocalMsgsByTime=function(){var or=g(n.mark(function fr(lr){var gr,Sr,wr,kr,mr,Ir,Nr,Er,sr,xr,Or,Mr,br,hr;return n.wrap(function(Tr){for(;;)switch(Tr.prev=Tr.next){case 0:return Sr=(gr=this).db,Tr.next=4,Sr.getDeletedMsgsCountByTime(lr);case 4:return wr=Tr.sent,kr=0,mr=[],Tr.next=9,Sr.deleteMsgsByTime(lr);case 9:return lr.deletedone&&lr.deletedone({deletedMsgCount:wr}),Tr.next=12,Sr.getAllSessions();case 12:Ir=Tr.sent,Nr=jt(Ir),Tr.prev=14,Nr.s();case 16:if((Er=Nr.n()).done){Tr.next=47;break}return sr=Er.value,xr=sr.id,Or=!1,Tr.next=22,Sr.getSession(xr);case 22:if(Mr=Tr.sent){Tr.next=25;break}return Tr.abrupt("continue",45);case 25:return Tr.next=27,Sr.getMsgCountAfterAck({shouldCountNotifyUnread:gr.options.shouldCountNotifyUnread,sessionId:xr,ack:Mr.ack||0});case 27:if(br=Tr.sent,Mr.unread!==br&&(Mr.unread=br,Or=!0),!(Mr.lastMsg&&Mr.lastMsg.time>lr.start&&Mr.lastMsg.time<lr.end)){Tr.next=39;break}if(lr.start!==0){Tr.next=34;break}Mr.lastMsg=null,Tr.next=38;break;case 34:return Tr.next=36,Sr.getMsgs({sessionId:xr,limit:1});case 36:hr=Tr.sent,Mr.lastMsg=hr&&hr[0]?hr[0]:null;case 38:Or=!0;case 39:if(!Or){Tr.next=45;break}return Tr.next=42,Sr.updateSession(Mr);case 42:gr.sessionSet[xr]&&mr.push(Mr),kr++;case 45:Tr.next=16;break;case 47:Tr.next=52;break;case 49:Tr.prev=49,Tr.t0=Tr.catch(14),Nr.e(Tr.t0);case 52:return Tr.prev=52,Nr.f(),Tr.finish(52);case 55:return gr.onUpdateSessions(mr),Tr.abrupt("return",V.resolve({deletedMsgCount:wr,sessionUpdateCount:kr}));case 57:case"end":return Tr.stop()}},fr,this,[[14,49,52,55]])}));return function(fr){return or.apply(this,arguments)}}()},function(t,r,e){var n=e(63),g=e(11),y=e(10),i=e(4),k=e(3),L=e(22),$=e(15),V=e(2),z=e(37).fn,re=e(0),oe=e(161);z.splitSysMsgs=function(le,ue){for(var ie,ae=le.length-1;ae>=0;ae--)ie=le[ae],oe.isCustom(ie)&&(n(le).call(le,ae,1),ue.push(ie))},z.onOfflineSysMsgs=function(le,ue){var ie,ae=this,Ie=g(ie=le.content.sysMsgs).call(ie,function(Fe){return Fe=y(oe).call(oe,Fe),ue&&(Fe.filter=!0),Fe});Ie=y(Ie).call(Ie),ae.markSysMsgRead(Ie);var de=[];ae.splitSysMsgs(Ie,de);var Ce,Ue=ue?"offlineFilterSysMsgs":"offlineSysMsgs",qe=ue?"offlineFilterCustomSysMsgs":"offlineCustomSysMsgs";if(Ie.length){var jt=ae.putSysMsg(Ie,"offlineSysMsgs").then(function(Fe){var Et;(Ie=Fe).length&&(ae.logger.info("sysmsg::onOfflineSysMsgs: ",Ue,Ie.length,Ie&&g(Ie).call(Ie,function(cr){return cr.idServer})),ae.syncResult[Ue]=ae.syncResult[Ue]||[],ae.syncResult[Ue]=i(Et=ae.syncResult[Ue]).call(Et,Ie))}).catch(function(Fe){return ae.logger.error("sysMsg::onOfflineSysMsgs: ",Fe),k.reject(Fe)});jt.cmd="sysMsgs",ae.syncPromiseArray.push(jt)}de.length&&(ae.logger.info("sysmsg::onOfflineSysMsgs: ",qe,g(de).call(de,function(Fe){return Fe.idServer})),ae.syncResult[qe]=ae.syncResult[qe]||[],ae.syncResult[qe]=i(Ce=ae.syncResult[qe]).call(Ce,de))},z.onSendSysMsg=function(le,ue){var ie=le.obj||{};ie?(this.completeSysMsg(ie),le.error?ie.status="fail":ie.status="success",ie=y(oe).call(oe,ie),ue&&(le.obj.filter=!0),le.obj=ie):this.logger.warn("onSendSysMsg::no obj")},z.completeSysMsg=function(le){return le.from=this.account,le},z.onSysMsg=function(le,ue){var ie=y(oe).call(oe,le.content.sysMsg);ue&&(ie.filter=!0),this.markSysMsgRead(ie),oe.isCustom(ie)?(this.logger.info("sysmsg::onSysMsg: on customSysMsg"),this.options.oncustomsysmsg(ie)):this.syncing?(this.logger.info("sysmsg::onSysMsg:is in syncing ..."),this.unhandledSysMsgs.push(ie)):this.handleSysMsg(ie)},z.handleSysMsg=function(le){var ue=this,ie=le.type,ae=le.from,Ie=le.serverex;ue.sysMsgPromise=ue.sysMsgPromise.then(function(){return ue.putSysMsg(le,"onSysMsg")}).then(function(de){le=de[0]}).then(function(){if(le){var de,Ce=k.resolve();switch(ie){case"addFriend":de={type:"addFriend",account:ae},Ie&&(de.serverex=Ie),Ce=ue.onFriendRequest(de);break;case"passFriendApply":de={type:"passFriendApply",account:ae},Ce=ue.onFriendRequest(de);break;case"deleteFriend":Ce=ue.onDeleteFriend({account:ae})}return de&&de.friend&&(le.friend=de.friend),Ce}}).then(function(){le&&(ue.logger.info("sysmsg::handleSysMsg: ",ie,re.pickAsString(le,["idServer","deletedIdClient","deletedIdServer"])),L(function(){ue.options.onsysmsg(le)},0))})},z.putSysMsg=function(le,ue){if(re.isArray(le)||(le=[le]),$(le[0]))return k.resolve(le);var ie=this,ae=ie.db,Ie=ae.enable,de=k.resolve(),Ce=[];return(de=(de=de.then(function(){return Ie?ae.putSysMsg(le):le}).then(function(Ue){var qe=[];V(le).call(le,function(jt){ie.checkSysMsgUnique(jt)&&qe.push(jt)}),le=qe,Ce=Ie?Ue:le})).then(function(){return ie.getSysMsgUnread().then(function(Ue){return Ce.length||((Ce=le).backward=!0),ie.updateSysMsgUnread(Ce,Ue,1).then(function(qe){ue==="offlineSysMsgs"&&(ie.syncResult.sysMsgUnread=qe),ue==="onSysMsg"&&ie.onUpdateSysMsgUnread(qe)})})})).then(function(){return le})},z.checkSysMsgUnique=re.genCheckUniqueFunc("idServer"),z.getSysMsgUnread=function(){var le=this,ue=le.db;return new k(function(ie){ue.enable?ue.getSysMsgUnread().then(function(ae){ie(ae)},function(){ie(le.sysMsgUnread)}):ie(le.sysMsgUnread)})},z.updateSysMsgUnread=function(le,ue,ie){if(re.isArray(le)||(le=[le]),!le.length)return k.resolve(ue);ue=ue||{};var ae,Ie=this.db;return V(le).call(le,function(de){(ie>0&&!de.read||ie<0&&de.read)&&(ae=de.type,ue[ae]=(ue[ae]||0)+ie)}),ue=oe.completeUnread(ue),this.sysMsgUnread=ue,Ie.enable&&!le.backward?Ie.updateSysMsgUnread(ue):k.resolve(ue)},z.reduceSysMsgUnread=function(le){var ue=this;return ue.getSysMsgUnread().then(function(ie){return ue.updateSysMsgUnread(le,ie,-1)}).then(function(ie){ue.onUpdateSysMsgUnread(ie)})},z.onUpdateSysMsgUnread=function(le){var ue=this;L(function(){ue.logger.info("sysmsg::onUpdateSysMsgUnread:",le),ue.options.onupdatesysmsgunread(le)},0)},z.updateSysMsg=function(le){var ue=this,ie=ue.db;(ie.enable?ie.updateSysMsg(le):k.resolve(le)).then(function(ae){ue.onUpdateSysMsg(ae)})},z.onUpdateSysMsg=function(le){var ue=this;L(function(){re.isArray(le)||(le=[le]),V(le).call(le,function(ie){ue.logger.info("sysmsg::onUpdateSysMsg:",ie.idServer),ue.options.onupdatesysmsg(ie)})},0)},z.processUnsettledSysMsgs=function(){var le,ue,ie=this;V(le=ie.unhandledSysMsgs).call(le,function(ae){ie.handleSysMsg(ae)}),V(ue=ie.unhandledSysMsgsForDeletedMsgs).call(ue,function(ae){ie.onMsgDeleted(ae.packet,ae.isSuperTeam)}),ie.resetUnsettledSysMsgs()}},function(t,r,e){var n=e(207),g=e(51),y=e(2),i=e(8),k=e(9),L=e(10),$=e(3),V=e(11),z=e(93),re=e(15),oe=e(34),le=e(5),ue=e(4),ie=e(782),ae=e(63),Ie=e(52),de=e(53),Ce=e(54),Ue=e(55),qe=e(42);function jt(ir,tr){var ur=le(ir);if(Ie){var or=Ie(ir);tr&&(or=re(or).call(or,function(fr){return de(ir,fr).enumerable})),ur.push.apply(ur,or)}return ur}function Fe(ir){for(var tr=1;tr<arguments.length;tr++){var ur,or,fr=arguments[tr]!=null?arguments[tr]:{};tr%2?y(ur=jt(Object(fr),!0)).call(ur,function(lr){g(ir,lr,fr[lr])}):Ce?Ue(ir,Ce(fr)):y(or=jt(Object(fr))).call(or,function(lr){qe(ir,lr,de(fr,lr))})}return ir}var Et=e(37).fn,cr=e(0),er=e(162),nr=e(35),dr=e(161);Et.processSession=function(ir){if(!ir.error)switch(ir.cmd){case"getServerSessions":this.onGetServerSessions(ir);break;case"getServerSession":this.onGetServerSession(ir);break;case"updateServerSession":this.onUpdateServerSession(ir)}},Et.onGetServerSessions=function(ir){var tr=this,ur=ir.content&&ir.content.sessionReqTag,or=ir.content&&ir.content.sessionList,fr=[];y(or).call(or,function(lr){var gr,Sr;if(lr.id=lr.id.split("|").join("-"),i(gr=lr.id).call(gr,"super_team")===0&&(lr.id="superTeam"+k(Sr=lr.id).call(Sr,10)),lr.updateTime=+lr.updateTime,lr.lastMsg){var wr=lr.lastMsgType==="1"?"sysMsg":"msg";fr.push(tr.parser.unserialize(JSON.parse(lr.lastMsg),wr).then(function(kr){var mr;lr.lastMsg=wr==="msg"?L(mr=tr.message).call(mr,kr):L(dr).call(dr,kr)}))}}),ir.promise=$.all(fr).then(function(){ir.obj={sessionList:or,hasMore:ur.hasMore==="1"},ur.minTimestamp&&(ir.obj.minTimestamp=+ur.minTimestamp)})},Et.onGetServerSession=function(ir){var tr,ur=this,or=ir.content&&ir.content.session;if(or){var fr;if(or.id=or.id.split("|").join("-"),i(tr=or.id).call(tr,"super_team")===0&&(or.id="superTeam"+k(fr=or.id).call(fr,10)),or.updateTime=+or.updateTime,or.lastMsg){var lr=ir.content.session&&ir.content.session.lastMsgType==="1"?"sysMsg":"msg";ir.promise=ur.parser.unserialize(JSON.parse(or.lastMsg),lr).then(function(gr){var Sr;or.lastMsg=lr==="msg"?L(Sr=ur.message).call(Sr,gr):L(dr).call(dr,gr),ir.obj=or})}else ir.obj=or}},Et.onUpdateServerSession=function(ir){ir.obj={}},Et.onSyncUpdateServerSession=function(ir){var tr,ur=this,or=this,fr=ir.content&&ir.content.session;if(fr){var lr;fr.id=fr.id.split("|").join("-"),i(tr=fr.id).call(tr,"super_team")===0&&(fr.id="superTeam"+k(lr=fr.id).call(lr,10)),fr.updateTime=+fr.updateTime,fr.lastMsg?or.parser.unserialize(JSON.parse(fr.lastMsg),"msg").then(function(gr){var Sr;fr.lastMsg=L(Sr=or.message).call(Sr,gr),ur.options.onSyncUpdateServerSession(cr.simpleClone(fr))}):this.options.onSyncUpdateServerSession(cr.simpleClone(fr))}},Et.mergeSession=function(ir){ir=cr.copyWithNull(ir);var tr=this.sessionSet,ur=ir.id,or=tr[ur]||{},fr=!1;return er.isComplete(ir)?delete or.isDeleted:or.isDeleted&&(fr=!0),tr[ur]=cr.merge(or,ir),ir=fr?ir:tr[ur],cr.undef(ir.unread)&&(ir.unread=0),ir},Et.mergeSessions=function(ir){var tr=this;return V(ir=ir||[]).call(ir,function(ur){return tr.mergeSession(ur)})},Et.onDeleteSessions=function(ir){var tr;ir.obj=V(tr=ir.obj.sessions).call(tr,function(ur){return er.parse(ur)})},Et.onUpdateSession=function(ir){if(ir){if(ir=this.mergeSession(ir),ir=z(er).call(er,ir),er.isComplete(ir))return this.logger.info("session::onUpdateSession: ".concat(ir.id),ir.id,cr.secureOutput("session",ir)),this.options.onupdatesessions?this.options.onupdatesessions([ir]):this.options.onupdatesession(ir),ir;this.logger.warn("session::onUpdateSession::session is not complete",cr.secureOutput("session",ir))}},Et.onUpdateSessions=function(ir){var tr=this;if(ir){ir=tr.mergeSessions(ir),ir=V(ir).call(ir,function(fr){return z(er).call(er,fr)});var ur=re(ir).call(ir,function(fr){return er.isComplete(fr)}),or=re(ir).call(ir,function(fr){return!er.isComplete(fr)});if(or&&or.length>0&&tr.logger.warn("session::onUpdateSessions::sessions is not complete",V(or).call(or,function(fr){return fr.id}),cr.secureOutput("session",or)),ur.length!==0)return tr.logger.info("session::onUpdateSessions:",cr.secureOutput("session",ur)),tr.options.onupdatesessions?tr.options.onupdatesessions(ur):y(ur).call(ur,function(fr){tr.options.onupdatesession(fr)}),ur;tr.logger.warn("session::onUpdateSessions::completeSessions is empty")}},Et.setCurrSession=function(ir){ir=""+ir,this.currSessionId=ir,this.logger.info("session::setCurrSession:",ir)},Et.resetSessionUnread=function(ir){var tr=ir.id;this.db.enable&&this.db.updateSession({id:tr,unread:0}),!this.options.autoMarkRead&&this.sessionUnreadMsgs&&this.sessionUnreadMsgs[tr]&&(this.markMsgRead(this.sessionUnreadMsgs[tr],!0),this.sessionUnreadMsgs[tr]=[]),this.getSessionInCache(tr)?this.onUpdateSession({id:tr,unread:0}):this.onUpdateSession(Fe(Fe({},ir),{},{unread:0}))},Et.resetSessionsUnread=function(ir){var tr=this,ur=this.db;ur.enable&&V(ir).call(ir,function(fr){ur.updateSession({id:fr.id,unread:0})});var or=!this.options.autoMarkRead&&this.sessionUnreadMsgs;ir=V(ir).call(ir,function(fr){return or&&tr.sessionUnreadMsgs[fr.id]&&(tr.markMsgRead(tr.sessionUnreadMsgs[fr.id],!0),tr.sessionUnreadMsgs[fr.id]=[]),tr.getSessionInCache(fr.id)?{id:fr.id,unread:0}:Fe(Fe({},fr),{},{unread:0})}),this.onUpdateSessions(ir)},Et.insertLocalSession=function(ir){var tr=this,ur=tr.db,or=ir.scene+"-"+ir.to,fr=tr.getSessionInCache(or);return fr&&er.isComplete(fr)?$.reject(nr.sessionExist({callFunc:"session::insertLocalSession",session:fr})):(ur.enable?ur.getMsgs({sessionId:or,limit:1}):$.resolve()).then(function(lr){if(cr.isArray(lr)&&lr.length===1){var gr=lr[0];(fr=er.genSessionByMsg(gr)).updateTime=gr.time}else fr={id:or,scene:ir.scene,to:ir.to,updateTime:+ir.updateTime||+new Date,lastMsg:null};return tr.onUpdateSession(fr),ur.enable?ur.putSession(fr):$.resolve(fr)})},Et.checkAndUpdateLocalSessionByMsg=function(ir){var tr,ur=this.db,or=this,fr=this.options.syncSessionUnread&&ir!==this.currSessionId,lr=ur.getMsgs({sessionId:ir,limit:1}),gr=ur.getSession(ir).then(function(Sr){if(Sr)return tr=oe({},Sr),Sr.ack=Sr.ack||0,fr?ur.getMsgs({sessionId:ir,start:Sr.ack}):$.resolve();or.logger.error("can't find session that sessionId = ".concat(ir))});return $.all([lr,gr]).then(function(Sr){var wr,kr,mr=n(Sr,2),Ir=mr[0],Nr=mr[1],Er={id:ir};if(!tr)return or.logger.error("checkAndUpdateLocalSessionByMsg:can not find session",ir),$.resolve(200);if(wr=tr&&!tr.lastMsg?null:tr.lastMsg.idClient,Ir&&Ir[0]?kr=(Ir=Ir[0]).idClient:(kr=null,Ir=null),wr!==kr&&(Er.lastMsg=Ir),Nr!==void 0){var sr=0;y(Nr=Nr||[]).call(Nr,function(xr){var Or;try{Or=or.options.shouldCountNotifyUnread(xr)}catch(Mr){throw or.logger.error("userOption:shouldCountNotifyUnread function error",Mr),Mr}xr.isUnreadable&&xr.flow==="in"&&(xr.type!=="notification"||Or)&&sr++}),sr!==tr.unread&&(Er.unread=sr)}return le(Er).length>1?(or.logger.info("session::checkAndUpdateLocalSessionByMsg::needUpdate newSession:",cr.secureOutput("session",Er)),ur.updateSession(Er).then(function(){return or.onUpdateSession(Er)})):$.resolve(200)})},Et.syncSessionsWithMoreRoaming=function(ir){var tr=this,ur=ir&&ir.content&&ir.content.sessions;if(ur&&ur.length){var or={0:"p2p",1:"team",5:"superTeam"};if(y(ur).call(ur,function(lr){var gr,Sr=lr.to===tr.options.account?lr.from:lr.to;lr.scene=or[lr.scene],lr.id=ue(gr="".concat(lr.scene,"-")).call(gr,Sr),lr.time=+lr.time}),this.db.enable){var fr=this.db.putSessionsWithMoreRoaming(ur);fr.cmd="syncSessionsWithMoreRoaming",this.syncPromiseArray.push(fr)}this.syncing&&this.syncResult?this.syncResult.sessionsWithMoreRoaming=ur:this.logger.warn("syncSessionsWithMoreRoaming::not in syncing or no syncResult")}},Et.syncStickTopSessions=function(ir){var tr=this,ur=this.db,or=[],fr=$.resolve(),lr=ir.content.sessions||[],gr=this;if(this.syncing&&this.syncResult){y(lr).call(lr,function(kr){var mr=kr.id.split("|");mr[0]==="super_team"&&(mr[0]="superTeam"),kr.id=mr.join("-"),kr.scene=mr[0],kr.to=mr[1],kr.isTop=!0,or.push(mr.join("-")),delete kr.createTime,delete kr.updateTime});var Sr,wr=[];this.hasSynced&&ir.content.modify&&(y(Sr=le(this.sessionSet)).call(Sr,function(kr){tr.sessionSet[kr].isTop&&wr.push(tr.sessionSet[kr])}),y(wr).call(wr,function(kr){if(i(or).call(or,kr.id)>-1){var mr=ie(lr).call(lr,function(Nr){return Nr.id===kr.id&&Nr.topCustom===kr.topCustom});mr>-1&&ae(lr).call(lr,mr,1)}else{var Ir={};Ir.id=kr.id,Ir.isTop=!1,Ir.topCustom="",Ir.to=kr.to,Ir.scene=kr.scene,lr.push(Ir)}})),ur.enable&&(fr=ur.updateTimetag("stickTopSessions",ir.content.timetag)),fr=fr.then(function(){return ur.enable?ur.getStickTopSessions():[]}).then(function(kr){ur.enable&&!tr.hasSynced&&ir.content.modify?y(kr).call(kr,function(mr){if(i(or).call(or,mr.id)>-1){var Ir=ie(lr).call(lr,function(Er){return Er.id===mr.id&&Er.topCustom===mr.topCustom});Ir>-1&&ae(lr).call(lr,Ir,1)}else{var Nr={};Nr.id=mr.id,Nr.isTop=!1,Nr.topCustom="",Nr.to=mr.to,Nr.scene=mr.scene,lr.push(Nr)}}):!ur.enable||tr.hasSynced||ir.content.modify||y(kr).call(kr,function(mr){gr.cacheSyncedSession(mr)}),y(lr).call(lr,function(mr){gr.cacheSyncedSession(mr)})}),this.syncResult.stickTopSessions=lr,fr.cmd="syncStickTopSessions",this.syncPromiseArray.push(fr)}else this.logger.warn("syncSessionsWithMoreRoaming::not in syncing or no syncResult")},Et.getSessionInCache=function(ir,tr){var ur=this.sessionSet[ir];return!ur||ur.isDeleted&&!tr?void 0:ur},Et.deleteSessionInCache=function(ir,tr){var ur=this;cr.isArray(ir)||(ir=[ir]),tr?y(ir).call(ir,function(or){ur.sessionSet[or]&&(ur.sessionSet[or].isDeleted=!0)}):y(ir).call(ir,function(or){return delete ur.sessionSet[or]}),this.logger.info("sessions::deleteSessionInCache::delete session done",ir,tr)},Et.updateSessionInCache=function(ir){return this.logger.info("session::updateSessionInCache: ".concat(ir.id),ir.id,ir),this.getSessionInCache(ir.id)?ir=this.mergeSession(ir):(this.logger.info("session::updateSessionInCache: can not find session in cache ".concat(ir.id)),null)},Et.updateSessionInDbWithNotify=function(ir,tr){var ur=this;return new $(function(or,fr){var lr=ur.db;if(ur.getSessionInCache(ir.id)){var gr=$.resolve(),Sr=cr.filterObj(ir,"id lastMsg localCustom unread");lr.enable&&(gr=lr.updateSession(Sr)),gr.then(function(wr){return ur.onUpdateSession(wr,tr)}).then(or,function(wr){fr({callFunc:"session::updateLocalSession",event:wr})})}else fr(nr.sessionNotExist({sessionId:ir.id,callFunc:"session::updateLocalSession"}))})}},function(t,r,e){var n=e(2),g=e(5),y=e(4),i=e(34),k=e(37).fn,L=e(0);k.syncSessionAck=function($){var V,z=this;if(this.logger.info("syncSessionAck::",$.content),z.syncing&&z.syncResult){z.saveAck.p2pTeam=$.content.timetag;var re={};n(V=[[$.content.p2p,"p2p"],[$.content.team.m_map,"team"]]).call(V,function(oe){var le,ue=oe[0],ie=oe[1];n(le=g(ue)).call(le,function(ae){var Ie,de;re[y(Ie="".concat(ie,"-")).call(Ie,ae)]=ue[ae];var Ce={id:y(de="".concat(ie,"-")).call(de,ae),ack:ue[ae]};z.cacheSyncedSession(Ce)})}),z.syncResult.ackMap?z.syncResult.ackMap=i(z.syncResult.ackMap,re):z.syncResult.ackMap=re}else z.logger.warn("syncSessionAck: not in syncing or no syncResult",z.syncing,!!z.syncResult)},k.syncSuperTeamSessionAck=function($){var V,z=this;if(z.syncResult){z.saveAck.superTeam=$.content.timetag;var re={},oe=$.content.superTeam.m_map;n(V=g(oe)).call(V,function(le){re["superTeam-".concat(le)]=oe[le];var ue={id:"superTeam-".concat(le),ack:oe[le]};z.cacheSyncedSession(ue)}),z.syncResult.ackMap?z.syncResult.ackMap=i(z.syncResult.ackMap,re):z.syncResult.ackMap=re}},k.onMarkSessionAck=function($){$.error||this.storeSessionAck($.obj)},k.syncMarkSessionAck=function($){this.storeSessionAck($.content,!0)},k.storeSessionAck=function($,V){var z;if(this.options.syncSessionUnread&&$){var re;switch($.scene){case 0:re="p2p";break;case 1:re="team";break;case void 0:default:re="superTeam"}var oe=y(z="".concat(re,"-")).call(z,$.to),le=$.timetag;if(le<=((this.getSessionInCache(oe)||{}).ack||0))this.logger.warn("session::storeSessionAck: ack <= ackInMemory",le);else{var ue={id:oe,ack:le};this.mergeSession(ue),this.logger.info("session::storeSessionAck:",L.secureOutput("session",ue)),this.markUnreadBySessionAck({sessionId:oe,ack:ue.ack},V)}}},k.markUnreadBySessionAck=function($,V){var z=$.sessionId,re=$.ack,oe=this,le=oe.db;if(le.enable)oe.pushMsgTask(function(){return le.getMsgCountAfterAck({shouldCountNotifyUnread:oe.options.shouldCountNotifyUnread,sessionId:z,ack:re}).then(function(Ue){var qe={id:z,unread:Ue,ack:re};return oe.logger.info("session::markUnreadBySessionAck: db.getMsgCountAfterAck done",qe),oe.syncing?oe.cacheSyncedSession(qe):V&&oe.onUpdateSession(qe),le.updateSession(qe)}).catch(function(Ue){oe.logger.error("markUnreadBySessionAck::error",Ue)})});else{var ue=oe.getSessionInCache(z);if(ue){var ie=ue.unreadMsgs;if(ie&&ie.length){for(var ae=0,Ie=[],de=ie.length-1;de>=0;de--){var Ce=ie[de];if(!(Ce.time>re))break;ae++,Ie.push(Ce)}ue.unreadMsgs=Ie,ue.unread=ae,oe.logger.info("session::markUnreadBySessionAck: unread ".concat(ae)),oe.syncing?oe.cacheSyncedSession(ue):V&&oe.onUpdateSession(ue)}}}}},function(t,r,e){var n=e(37).fn;n.processChatroom=function(g){switch(g.cmd){case"getChatroomAddress":this.onChatroomAddress(g)}},n.onChatroomAddress=function(g){g.error||(g.obj.address=g.content.address)}},function(t,r,e){var n=e(37).fn;n.processQchat=function(g){switch(g.cmd){case"getQChatAddress":this.onQChatAddress(g)}},n.onQChatAddress=function(g){g.error||(g.obj.address=g.content.address)}},function(t,r,e){e(37).fn.processFilter=function(n){switch(n.cmd){case"sendFilterMsg":this.onSendMsg(n,!0);break;case"filterMsg":this.onMsg(n,!0);break;case"filterSysMsg":this.onSysMsg(n,!0);break;case"sendFilterCustomSysMsg":this.onSendSysMsg(n,!0)}}},function(t,r,e){var n=e(11),g=e(48),y=e(37).fn,i=e(0),k=g.clientTypeMap;function L($){$=$||{};var V=i.copy($);return V.clientType&&(V.clientType=k[V.clientType]||""),V.serverCustom&&(V.custom=JSON.parse(V.serverCustom),typeof V.custom[0]=="string"&&(V.custom=V.custom[0]),delete V.serverCustom),V}y.processEventService=function($){var V=$.content,z=$.error,re=this.options||{};switch(z&&(z.callFunc="events::processsEventService",this.onCustomError("事件服务解包失败","EVENT_SERVICE_ERROR",z)),$.cmd){case"pushEvent":if(i.isFunction(re.onpushevents)){var oe={msgEvents:[L(V.msgEvent)]};re.onpushevents(oe)}break;case"pushEvents":if(i.isFunction(re.onpushevents)){var le=V.msgEvents;le={msgEvents:n(le).call(le,function(ue){return L(ue)})},re.onpushevents(le)}}}},function(t,r,e){var n=e(37).fn,g=e(0);n.processProxyService=function(y){var i=y.error;switch(i&&(i.callFunc="events::processProxyService",this.onCustomError("proxyService","EVENT_PROXY_SERVICE_ERROR",i)),y.cmd){case"onProxyMsg":if(g.isFunction(this.options.onProxyMsg)){var k=y.content.proxyMsg||{};k.time&&(k.time=+k.time),this.options.onProxyMsg(k)}break;case"httpProxy":y.obj=y.content&&y.content.proxyTag}}},function(t,r,e){var n=e(10),g=e(11),y=e(0),i=function(ae){this.account=ae.account},k=i.prototype,L=k.Message=e(80),$=k.TextMessage=e(857),V=k.FileMessage=e(209),z=k.GeoMessage=e(861),re=k.NotificationMessage=e(862),oe=k.CustomMessage=e(863),le=k.TipMessage=e(864),ue=k.RobotMessage=e(865),ie=k.G2Message=e(866);k.validScenes=L.validScenes,k.validTypes=L.validTypes,k.sceneMap=L.sceneMap,k.sceneReverseMap=L.sceneReverseMap,k.reverse=function(ae){var Ie;switch(L.getType(ae)){case"text":Ie=n($).call($,ae);break;case"image":case"audio":case"video":case"file":Ie=n(V).call(V,ae);break;case"geo":Ie=n(z).call(z,ae);break;case"notification":Ie=n(re).call(re,ae);break;case"custom":Ie=n(oe).call(oe,ae);break;case"tip":Ie=n(le).call(le,ae);break;case"g2":Ie=n(ie).call(ie,ae);break;case"robot":Ie=n(ue).call(ue,ae);break;default:Ie=n(L).call(L,ae)}return L.setExtra(Ie,this.account),Ie},k.reverseMsgs=function(ae,Ie){var de,Ce,Ue=this;return g(ae).call(ae,function(qe){return qe=n(Ue).call(Ue,qe),Ie&&((de=Ie.modifyObj)&&(qe=y.merge(qe,de)),Ce=Ie.mapper,y.isFunction(Ce)&&(qe=Ce(qe))),qe})},t.exports=i},function(t,r,e){var n=e(19),g=e(10),y=e(80),i=e(0);function k(L){i.verifyOptions(L,"text","msg::TextMessage"),L.type="text",y.call(this,L)}k.prototype=n(y.prototype),k.reverse=function(L){return g(y).call(y,L)},t.exports=k},function(t,r,e){var n=e(19),g=e(209);function y(){}y.prototype=n(g.prototype),y.verifyFile=function(i,k){return!0},t.exports=y},function(t,r,e){var n=e(19),g=e(209);function y(){}y.prototype=n(g.prototype),y.verifyFile=function(){},t.exports=y},function(t,r,e){var n=e(19),g=e(209);function y(){}y.prototype=n(g.prototype),y.verifyFile=function(){},t.exports=y},function(t,r,e){var n=e(6),g=e(19),y=e(10),i=e(80),k=e(0);function L($){$.type="geo",k.verifyOptions($,"geo","msg::GeoMessage"),k.verifyOptions($.geo,"lng lat title",!0,"geo.","msg::GeoMessage"),k.verifyParamType("geo.lng",$.geo.lng,"number","msg::GeoMessage"),k.verifyParamType("geo.lat",$.geo.lat,"number","msg::GeoMessage"),k.verifyParamType("geo.title",$.geo.title,"string","msg::GeoMessage"),i.call(this,$),this.attach=n($.geo)}L.prototype=g(i.prototype),L.reverse=function($){var V=y(i).call(i,$);return $.attach=$.attach?""+$.attach:"",V.geo=$.attach?JSON.parse($.attach):{},V},t.exports=L},function(t,r,e){var n=e(19),g=e(10),y=e(11),i=e(121),k=e(0).notundef,L=e(80),$=e(156).IM,V=e(198),z=e(208),re={0:"addTeamMembers",1:"removeTeamMembers",2:"leaveTeam",3:"updateTeam",4:"dismissTeam",5:"passTeamApply",6:"transferTeam",7:"addTeamManagers",8:"removeTeamManagers",9:"acceptTeamInvite",10:"updateTeamMute",101:"netcallMiss",102:"netcallBill",103:"netcallReject",401:"addSuperTeamMembers",402:"removeSuperTeamMembers",403:"leaveSuperTeam",404:"updateSuperTeam",405:"dismissSuperTeam",406:"transferSuperTeam",407:"addSuperTeamManagers",408:"removeSuperTeamManagers",409:"updateSuperTeamMembersMute",410:"passSuperTeamApply",411:"acceptSuperTeamInvite"};function oe(){}oe.prototype=n(L.prototype),oe.reverse=function(le){var ue=g(L).call(L,le);if(le.attach=le.attach?""+le.attach:"",le.attach){var ie=JSON.parse(le.attach);if(ue.attach={type:re[ie.id]||ie.id},k(ie.data)){var ae,Ie,de=ie.data;k(de.tinfo)&&(ue.attach.team=g(V).call(V,$.syncUnserialize(de.tinfo,"team"),!0)),k(de.ids)&&(ue.attach.accounts=de.ids),k(de.id)&&(ue.attach.account=de.id),k(de.uinfos)&&(ue.attach.users=y(ae=de.uinfos).call(ae,function(Ce){return g(z).call(z,$.syncUnserialize(Ce,"user"))})),k(de.mute)&&(ue.attach.mute=+de.mute==1),k(de.attach)&&(ue.attach.custom=de.attach),k(de.channel)&&(ue.attach.channelId=de.channel),k(de.calltype)&&(ue.attach.netcallType=de.calltype),k(de.duration)&&(ue.attach.duration=de.duration),k(de.time)&&(ue.attach.time=de.time),k(de.from)&&(ue.attach.from=de.from),k(de.ext)&&(ue.attach.ext=de.ext),ue.attach.accounts&&ue.attach.accounts.length<=2&&ue.from===ue.to&&i(Ie=ue.attach.accounts).call(Ie,function(Ce){if(Ce!==ue.to)return ue.to=Ce,!0})}}else ue.attach={};return ue},t.exports=oe},function(t,r,e){var n=e(19),g=e(10),y=e(80),i=e(0);function k(L){i.verifyOptions(L,"content","msg::CustomMessage"),L.type="custom",y.call(this,L),this.attach=L.content}k.prototype=n(y.prototype),k.reverse=function(L){var $=g(y).call(y,L);return $.content=L.attach,$},t.exports=k},function(t,r,e){var n=e(19),g=e(10),y=e(80),i=e(0);function k(L){i.verifyOptions(L,"tip","msg::TipMessage"),L.type="tip",y.call(this,L),this.body=L.tip}k.prototype=n(y.prototype),k.reverse=function(L){var $=g(y).call(y,L);return $.text="",$.tip=L.body,L.attach&&($.attach=L.attach),$},t.exports=k},function(t,r,e){var n=e(6),g=e(19),y=e(10),i=e(11),k=e(80),L=e(0),$={welcome:"00",text:"01",link:"03"},V={"01":"text","02":"image","03":"answer",11:"template"};function z(re){L.verifyOptions(re,"content","msg::RobotMessage"),L.undef(re.robotAccid)&&(re.robotAccid=re.to);var oe=re.content;switch(oe.type){case"welcome":L.undef(re.body)&&(this.body="欢迎消息");break;case"text":L.verifyOptions(oe,"content","msg::RobotMessage"),L.undef(re.body)&&(this.body=oe.content);break;case"link":L.verifyOptions(oe,"target","msg::RobotMessage")}oe.type&&(oe.type=$[oe.type]),oe={param:oe,robotAccid:re.robotAccid},this.attach=n(oe),re.type="robot",k.call(this,re)}z.prototype=g(k.prototype),z.reverse=function(re){var oe=y(k).call(k,re);if(oe.type==="robot"){var le=JSON.parse(re.attach);if(le.param&&(le.param.type=V[le.param.type]||"unknown"),le.robotMsg){var ue=(le=L.merge(le,le.robotMsg)).message;le.flag==="bot"?le.message=i(ue).call(ue,function(ie){return ie.type=V[ie.type]||"unknown",ie}):le.flag,delete le.robotMsg}oe.content=le}return oe},t.exports=z},function(t,r,e){var n=e(6),g=e(19),y=e(10),i=e(80),k=e(0);function L($){k.verifyOptions($,"attach","msg::G2Message"),$.type="g2",i.call(this,$),this.attach=n($.attach)}L.prototype=g(i.prototype),L.reverse=function($){var V=y(i).call(i,$);return $.attach&&(V.attach=JSON.parse($.attach)),V},t.exports=L},function(t,r,e){var n=e(51),g=e(60),y=e(24),i=e(61),k=e(11),L=e(15),$=e(8),V=e(3),z=e(2),re=e(34),oe=e(5),le=e(52),ue=e(53),ie=e(54),ae=e(55),Ie=e(42);function de(Et,cr){var er=oe(Et);if(le){var nr=le(Et);cr&&(nr=L(nr).call(nr,function(dr){return ue(Et,dr).enumerable})),er.push.apply(er,nr)}return er}function Ce(Et){for(var cr=1;cr<arguments.length;cr++){var er,nr,dr=arguments[cr]!=null?arguments[cr]:{};cr%2?z(er=de(Object(dr),!0)).call(er,function(ir){n(Et,ir,dr[ir])}):ie?ae(Et,ie(dr)):z(nr=de(Object(dr))).call(nr,function(ir){Ie(Et,ir,ue(dr,ir))})}return Et}var Ue=e(41).fn,qe=e(0),jt=qe.isArray,Fe=e(160);Ue.mergeObjArray=function(Et,cr,er){return Et||(Et=[]),cr?(jt(cr)||(cr=[cr]),cr.length?(er=er||{},qe.mergeObjArray(Et,cr,er)):Et):Et},Ue.cutObjArray=function(Et,cr,er){return Et&&cr?(jt(cr)||(cr=[cr]),cr.length?(er=er||{},qe.cutObjArray(Et,cr,er)):Et):Et},Ue.mergeLoginPorts=function(Et,cr){return this.mergeObjArray(Et,cr,{keyPath:"deviceId"})},Ue.cutLoginPorts=function(Et,cr){return this.cutObjArray(Et,cr,{keyPath:"deviceId",sortPath:"type"})},Ue.mergeRelations=function(Et,cr){return this.mergeObjArray(Et,cr,{keyPath:"account"})},Ue.cutRelations=function(Et,cr){return this.cutObjArray(Et,cr,{keyPath:"account"})},Ue.findRelation=function(Et,cr){return qe.findObjInArray(Et,{keyPath:"account",value:cr})},Ue.mergeFriends=function(Et,cr){return this.mergeObjArray(Et,cr,{keyPath:"account"})},Ue.cutFriends=function(Et,cr){return this.cutObjArray(Et,cr,{keyPath:"account"})},Ue.cutFriendsByAccounts=function(Et,cr){jt(cr)||(cr=[cr]);var er=k(cr).call(cr,function(nr){return{account:nr}});return this.cutFriends(Et,er)},Ue.findFriend=function(Et,cr){return qe.findObjInArray(Et,{keyPath:"account",value:cr})},Ue.mergeUsers=function(Et,cr){return this.mergeObjArray(Et,cr,{keyPath:"account"})},Ue.findUser=function(Et,cr){return qe.findObjInArray(Et,{keyPath:"account",value:cr})},Ue.mergeTeams=function(Et,cr){return this.mergeObjArray(Et,cr,{keyPath:"teamId"})},Ue.cutTeams=function(Et,cr){return this.cutObjArray(Et,cr,{keyPath:"teamId"})},Ue.findTeam=function(Et,cr){return qe.findObjInArray(Et,{keyPath:"teamId",value:cr})},Ue.assembleTeamOwner=Fe.assembleOwner,Ue.assembleTeamMembers=Fe.assembleMembers,Ue.genTeamMemberId=Fe.genId,Ue.mergeTeamMembers=function(Et,cr){return this.mergeObjArray(Et,cr)},Ue.cutTeamMembers=function(Et,cr){return this.cutObjArray(Et,cr)},Ue.cutTeamMembersByAccounts=function(Et,cr,er){jt(er)||(er=[er]);var nr=Fe.assembleMembers({teamId:cr},er);return this.cutTeamMembers(Et,nr)},Ue.findTeamMember=function(Et,cr){return qe.findObjInArray(Et,{keyPath:"id",value:cr})},Ue.mergeSessions=function(Et,cr){return this.mergeObjArray(Et,cr,{sortPath:"updateTime",desc:!0})},Ue.cutSessions=function(Et,cr){return this.cutObjArray(Et,cr)},Ue.cutSessionsByIds=function(Et,cr){jt(cr)||(cr=[cr]);var er=k(cr).call(cr,function(nr){return{id:nr}});return this.cutSessions(Et,er)},Ue.findSession=function(Et,cr){return qe.findObjInArray(Et,{keyPath:"id",value:cr})},Ue.mergeMsgs=function(Et,cr){return this.mergeObjArray(Et,cr,{keyPath:"idClient",sortPath:"time"})},Ue.cutMsgs=function(Et,cr){return this.cutObjArray(Et,cr,{keyPath:"idClient"})},Ue.cutMsgsByIdClients=function(Et,cr){jt(cr)||(cr=[cr]);var er=k(cr).call(cr,function(nr){return{idClient:nr}});return this.cutMsgs(Et,er)},Ue.findMsg=function(Et,cr){return qe.findObjInArray(Et,{keyPath:"idClient",value:cr})},Ue.mergeSysMsgs=function(Et,cr){return this.mergeObjArray(Et,cr,{keyPath:"idServer",desc:!0})},Ue.cutSysMsgs=function(Et,cr){return this.cutObjArray(Et,cr,{keyPath:"idServer"})},Ue.cutSysMsgsByIdServers=function(Et,cr){jt(cr)||(cr=[cr]);var er=k(cr).call(cr,function(nr){return{idServer:nr}});return this.cutSysMsgs(Et,er)},Ue.findSysMsg=function(Et,cr){return qe.findObjInArray(Et,{keyPath:"idServer",value:cr})},Ue.searchLocal=function(Et){if(qe.verifyOptions(Et,"keyword","searchLocal"),this.db.enable){var cr,er=this,nr=this.db,dr=Et.keyword+"",ir=["account","nick","alias"],tr=["id","scene","lastMsg.type","lastMsg.text","localCustom","target.account","target.nick","target.alias","target.name"],ur="",or=Et.keyPath;switch(or?(ur=(or=(or+"").split(".")).shift(),or=or.join(".")):ur="all",ur){case"user":or&&(ir=L(ir).call(ir,function(Nr){return Nr===or||$(Nr).call(Nr,or+".")===0})),gr(ir).then(function(Nr){Et.done(null,{sessions:[],users:Nr})});break;case"session":or&&(tr=L(tr).call(tr,function(Nr){return Nr===or||$(Nr).call(Nr,or+".")===0})),fr(tr,!or||$(or).call(or,"target")>-1).then(function(Nr){Et.done(null,{sessions:Nr,users:[]})});break;case"all":wr().then(function(){V.all([fr(tr,!0),gr(ir)]).then(function(Nr){Et.done(null,{sessions:Nr[0],users:Nr[1]})})});break;default:Et.done(null,{sessions:[],users:[],msg:'keyPath must start with "user" or "session"'})}}else Et.done(null,{sessions:[],users:[],msg:"no db"});function fr(Nr,Er){return lr.apply(this,arguments)}function lr(){return(lr=i(g.mark(function Nr(Er,sr){var xr;return g.wrap(function(Or){for(;;)switch(Or.prev=Or.next){case 0:return xr=sr?[nr.getSessions(),wr(),nr.getTeams(),nr.getSuperTeams()]:[nr.getSessions()],Or.abrupt("return",V.all(xr).then(function(Mr){var br,hr=Mr[0]||[],Tr={p2p:Mr[1]||[],team:Mr[2]||[],superTeam:Mr[3]||[]},Br={};return sr&&(z(br=oe(Tr)).call(br,function(Fr){var Lr;z(Lr=Tr[Fr]).call(Lr,function(qr){var Ur=qr.teamId||qr.account;Br[Fr+"-"+Ur]=qr})}),z(hr).call(hr,function(Fr){Fr.target=Br[Fr.id]})),mr(Er,hr)}));case 2:case"end":return Or.stop()}},Nr)}))).apply(this,arguments)}function gr(Nr){return Sr.apply(this,arguments)}function Sr(){return(Sr=i(g.mark(function Nr(Er){var sr;return g.wrap(function(xr){for(;;)switch(xr.prev=xr.next){case 0:return xr.next=2,wr();case 2:return sr=xr.sent,xr.abrupt("return",mr(Er,sr));case 4:case"end":return xr.stop()}},Nr)}))).apply(this,arguments)}function wr(){return kr.apply(this,arguments)}function kr(){return(kr=i(g.mark(function Nr(){var Er,sr;return g.wrap(function(xr){for(;;)switch(xr.prev=xr.next){case 0:if(!cr){xr.next=2;break}return xr.abrupt("return",cr);case 2:return xr.next=4,er.db.getFriends();case 4:if(xr.t0=xr.sent,xr.t0){xr.next=7;break}xr.t0=[];case 7:return Er=xr.t0,sr=er.protocol.userSet||{},cr=k(Er).call(Er,function(Or){return Ce(Ce({},Or),sr[Or.account])}),xr.abrupt("return",cr);case 11:case"end":return xr.stop()}},Nr)}))).apply(this,arguments)}function mr(Nr,Er){var sr=[];return z(Er).call(Er,function(xr){for(var Or=0;Or<Nr.length;Or++){var Mr=Ir(xr,Nr[Or].split("."));if(Mr&&$(Mr).call(Mr,dr)>-1){sr.push(re({},xr));break}}}),sr}function Ir(Nr,Er){if(y(Nr)==="object"&&Nr)return Er.length===1?Nr[Er[0]]:Ir(Nr[Er.shift()],Er)}}},function(t,r,e){var n=e(9),g=e(41).fn,y=e(0),i=e(26).reportAPI;g.kick=function(k){var L;(k=k||{}).done=i({instance:this,className:"NIMFn",funcName:"kick",done:k.done}),y.verifyOptions(k,"deviceIds","link::kick"),this.processCallback(k),this.sendCmd("kick",{deviceIds:n(L=k.deviceIds).call(L,0)},k.callback)},g.disconnect=function(k){(k=k||{}).done=i({instance:this,className:"NIMFn",funcName:"disconnect",done:k.done}),k=k||{},this.protocol.disconnect(k.done)}},function(t,r,e){var n=e(41).fn,g=e(0),y=e(26).reportAPI;n.markInBlacklist=function(i){(i=i||{}).done=y({instance:this,className:"NIMFn",funcName:"markInBlacklist",done:i.done}),g.verifyOptions(i,"account isAdd","relation::markInBlacklist"),g.verifyParamType("isAdd",i.isAdd,"boolean","relation::markInBlacklist"),this.processCallback(i),this.sendCmd("markInBlacklist",{account:i.account,isAdd:i.isAdd},i.callback)},n.addToBlacklist=function(i){return(i=i||{}).done=y({instance:this,className:"NIMFn",funcName:"addToBlacklist",done:i.done}),i.isAdd=!0,this.markInBlacklist(i)},n.removeFromBlacklist=function(i){return(i=i||{}).done=y({instance:this,className:"NIMFn",funcName:"removeFromBlacklist",done:i.done}),i.isAdd=!1,this.markInBlacklist(i)},n.markInMutelist=function(i){(i=i||{}).done=y({instance:this,className:"NIMFn",funcName:"markInMutelist",done:i.done}),g.verifyOptions(i,"account","relation::markInMutelist"),g.verifyParamType("isAdd",i.isAdd,"boolean","relation::markInMutelist"),this.processCallback(i),this.sendCmd("markInMutelist",{account:i.account,isAdd:i.isAdd},i.callback)},n.addToMutelist=function(i){return(i=i||{}).done=y({instance:this,className:"NIMFn",funcName:"addToMutelist",done:i.done}),i.isAdd=!0,this.markInMutelist(i)},n.removeFromMutelist=function(i){return(i=i||{}).done=y({instance:this,className:"NIMFn",funcName:"removeFromMutelist",done:i.done}),i.isAdd=!1,this.markInMutelist(i)},n.getRelations=function(i){(i=i||{}).done=y({instance:this,className:"NIMFn",funcName:"getRelations",done:i.done});var k=this,L=k.db,$=0;function V(){k.sendCmd("getRelations",{timetag:$,NOTSTORE:"timetag"},i.callback)}i=g.verifyOptions(i),k.processCallback(i),L.enable?L.getRelationsTimetag().then(function(z){$=z,V()},V):V()}},function(t,r,e){var n=e(60),g=e(61),y=e(4),i=e(2),k=e(8),L=e(41).fn,$=e(0),V=$.objs2accounts,z=e(208),re=e(26).reportAPI;L.updateMyInfo=function(oe){(oe=oe||{}).done=re({instance:this,className:"NIMFn",funcName:"updateMyInfo",done:oe.done}),$.verifyOptions(oe),this.processCallback(oe),oe.user=new z(oe),delete oe.user.account,this.sendCmd("updateMyInfo",{user:oe.user,antispamTag:{antiSpamBusinessId:oe.antiSpamBusinessId},single:!0},oe.callback)},L.getMyInfo=function(oe){return(oe=oe||{}).done=re({instance:this,className:"NIMFn",funcName:"getMyInfo",done:oe.done}),(oe=oe||{}).account=this.account,this.getUser(oe)},L.getUser=function(oe){(oe=oe||{}).done=re({instance:this,className:"NIMFn",funcName:"getUser",done:oe.done});var le,ue=this,ie=ue.db;function ae(){ue.sendCmd("getUsers",{accounts:[le],single:!0},oe.callback)}$.verifyOptions(oe,"account","user::getUser"),ue.processCallback(oe),oe.cbaop=function(Ie,de){if(!Ie)return de=de[0]||null,ue.logger.info("api::getUser: cbaop ".concat(le)),de},le=oe.account,oe.sync?ae():ie.enable?ie.getUser(le).then(function(Ie){Ie?oe.done(null,Ie):ae()},ae):ae()},L.getUsers=function(oe){(oe=oe||{}).done=re({instance:this,className:"NIMFn",funcName:"getUsers",done:oe.done});var le,ue=this,ie=ue.db,ae=[];function Ie(){ue.sendCmd("getUsers",{accounts:le,single:!0},oe.callback)}$.verifyOptions(oe,"accounts","user::getUsers"),$.verifyParamType("accounts",oe.accounts,"array","user::getUsers"),ue.processCallback(oe),oe.cbaop=function(de,Ce){if(!de)return Ce=y(Ce).call(Ce,ae),ue.logger.info("api::getUsers: cbaop ".concat(le)),Ce},le=$.deduplicate(oe.accounts),$.verifyArrayMax("accounts",oe.accounts,150,"user::getUsers"),oe.sync?Ie():ie.enable?ie.getUsers({accountIds:le}).then(function(de){if(de&&de.length===le.length)oe.done(null,de);else{ae=de;var Ce=V(de),Ue=[];i(le).call(le,function(qe){k(Ce).call(Ce,qe)===-1&&Ue.push(qe)}),le=Ue,Ie()}},Ie):Ie()},L.getUsersFromDB=function(){var oe=g(n.mark(function le(ue){var ie,ae,Ie;return n.wrap(function(de){for(;;)switch(de.prev=de.next){case 0:return ae=(ie=this).db,(ue=ue||{}).done=re({instance:this,className:"NIMFn",funcName:"getUsersFromDB",done:ue.done}),$.validate({accountIds:{type:"array",required:!1}},ue,"user::getUsersFromDB"),ie.processCallback(ue),de.next=8,ae.getUsers(ue);case 8:return Ie=de.sent,ue.callback(null,Ie),de.abrupt("return",Ie);case 11:case"end":return de.stop()}},le,this)}));return function(le){return oe.apply(this,arguments)}}()},function(t,r,e){var n=e(60),g=e(61),y=e(143),i=e(41).fn,k=e(0),L=k.notundef,$=e(783),V=e(26).reportAPI;i.friendRequest=function(z){(z=z||{}).done=V({instance:this,className:"NIMFn",funcName:"friendRequest",done:z.done}),k.verifyOptions(z,"type account","friend::friendRequest"),k.verifyParamValid("type",z.type,$.validTypes(),"friend::friendRequest"),this.processPs(z),this.processCallback(z);var re={account:z.account,type:$.getByteFromType(z.type),ps:z.ps};L(z.idServer)&&(re.idServer=z.idServer),this.sendCmd("friendRequest",re,z.callback)},i.addFriend=function(z){(z=z||{}).done=V({instance:this,className:"NIMFn",funcName:"addFriend",done:z.done}),z.type="addFriend",this.friendRequest(z)},i.applyFriend=function(z){(z=z||{}).done=V({instance:this,className:"NIMFn",funcName:"applyFriend",done:z.done}),z.type="applyFriend",this.friendRequest(z)},i.passFriendApply=function(z){(z=z||{}).done=V({instance:this,className:"NIMFn",funcName:"passFriendApply",done:z.done}),z.type="passFriendApply",this.friendRequest(z)},i.rejectFriendApply=function(z){(z=z||{}).done=V({instance:this,className:"NIMFn",funcName:"rejectFriendApply",done:z.done}),z.type="rejectFriendApply",this.friendRequest(z)},i.deleteFriend=function(z){(z=z||{}).done=V({instance:this,className:"NIMFn",funcName:"deleteFriend",done:z.done}),k.verifyOptions(z,"account","friend::deleteFriend");var re=z.delAlias===!0;this.processCallback(z),this.sendCmd("deleteFriend",{account:z.account,delFriendParams:{delAlias:re?1:0}},z.callback)},i.updateFriend=function(z){(z=z||{}).done=V({instance:this,className:"NIMFn",funcName:"updateFriend",done:z.done}),this.processCallback(z);var re=new $(z);this.sendCmd("updateFriend",{friend:re,single:!0},z.callback)},i.getFriends=function(z){(z=z||{}).done=V({instance:this,className:"NIMFn",funcName:"getFriends",done:z.done});var re=this.db;k.validate({timetag:{type:"number",required:!1}},z,"friend::getFriends"),this.processCallback(z),re.enable?re.getFriends({updateTime:z.updateTime||0}).then(function(oe){(oe=y(oe).call(oe,function(le,ue){return le.updateTime-ue.updateTime})).invalid=[],z.done(null,oe)}):this.sendCmd("getFriends",{timetag:z.updateTime||0,NOTSTORE:"timetag"},z.callback)},i.getFriendsFromDB=function(){var z=g(n.mark(function re(oe){var le,ue,ie;return n.wrap(function(ae){for(;;)switch(ae.prev=ae.next){case 0:return ue=(le=this).db,(oe=oe||{}).done=V({instance:this,className:"NIMFn",funcName:"getFriendsFromDB",done:oe.done}),k.validate({accountIds:{type:"array",required:!1}},oe,"friend::getFriendsFromDB"),le.processCallback(oe),ae.next=8,ue.getFriends(oe);case 8:return ie=ae.sent,oe.callback(null,ie),ae.abrupt("return",ie);case 11:case"end":return ae.stop()}},re,this)}));return function(re){return z.apply(this,arguments)}}(),i.isMyFriend=function(z){(z=z||{}).done=V({instance:this,className:"NIMFn",funcName:"isMyFriend",done:z.done});var re=this.db;k.validate({account:{type:"string",allowEmpty:!1,require:!0}},z),this.processCallback(z),re.enable||z.done(null,!1),re.getFriend(z.account).then(function(oe){oe&&oe.valid===!0?z.done(null,!0):z.done(null,!1)})},i.isUserInBlackList=function(z){(z=z||{}).done=V({instance:this,className:"NIMFn",funcName:"isUserInBlackList",done:z.done});var re=this.db;k.validate({account:{type:"string",allowEmpty:!1,require:!0}},z),this.processCallback(z),re.enable||z.done(null,!1),re.getUserFromBlackList(z.account).then(function(oe){oe&&oe.account?z.done(null,!0):z.done(null,!1)})}},function(t,r,e){var n=e(41).fn,g=e(26).reportAPI;n.getRobots=function(y){(y=y||{}).done=g({instance:this,className:"NIMFn",funcName:"getRobots",done:y.done}),this.logger.warn("this api will be abandon"),(y=y||{}).type="getRobots",this.processCallback(y),this.sendCmd("sync",{sync:{robots:0}},y.callback)}},function(t,r,e){var n=e(60),g=e(61),y=e(9),i=e(11),k=e(15),L=e(3),$=e(6),V=e(41).fn,z=e(0),re=z.undef,oe=e(198),le=e(160),ue=e(26).reportAPI;V.createTeam=function(ie){var ae;(ie=ie||{}).done=ue({instance:this,className:"NIMFn",funcName:"createTeam",done:ie.done}),z.verifyOptions(ie,"type name","team::createTeam"),re(ie.accounts)?ie.accounts=[]:z.verifyParamType("accounts",ie.accounts,"array","team::createTeam"),ie.action="create",this.processPs(ie),this.processCallback(ie),ie.team=new oe(ie);var Ie={team:ie.team,accounts:y(ae=ie.accounts).call(ae,0),ps:ie.ps,antispamTag:{antiSpamBusinessId:ie.antiSpamBusinessId}};this.sendCmd("createTeam",Ie,ie.callback)},V.updateTeam=function(ie){(ie=ie||{}).done=ue({instance:this,className:"NIMFn",funcName:"updateTeam",done:ie.done}),z.verifyOptions(ie,"teamId","team::updateTeam"),ie.action="update",this.processCallback(ie),ie.team=new oe(ie),this.sendCmd("updateTeam",{team:ie.team,antispamTag:{antiSpamBusinessId:ie.antiSpamBusinessId},single:!0},ie.callback)},V.addTeamMembers=function(ie){var ae;(ie=ie||{}).done=ue({instance:this,className:"NIMFn",funcName:"addTeamMembers",done:ie.done}),z.verifyOptions(ie,"teamId accounts","team::addTeamMembers"),z.verifyParamType("accounts",ie.accounts,"array","team::addTeamMembers"),this.processPs(ie),z.notexist(ie.custom)&&(ie.custom=""),this.processCallback(ie);var Ie={teamId:ie.teamId,accounts:y(ae=ie.accounts).call(ae,0),ps:ie.ps,attach:ie.custom};this.sendCmd("addTeamMembers",Ie,ie.callback)},V.removeTeamMembers=function(ie){var ae;(ie=ie||{}).done=ue({instance:this,className:"NIMFn",funcName:"removeTeamMembers",done:ie.done}),z.verifyOptions(ie,"teamId accounts","team::removeTeamMembers"),z.verifyParamType("accounts",ie.accounts,"array","team::removeTeamMembers"),this.processCallback(ie);var Ie={teamId:ie.teamId,accounts:y(ae=ie.accounts).call(ae,0)};this.sendCmd("removeTeamMembers",Ie,ie.callback)},V.acceptTeamInvite=function(ie){(ie=ie||{}).done=ue({instance:this,className:"NIMFn",funcName:"acceptTeamInvite",done:ie.done}),z.verifyOptions(ie,"idServer teamId from","team::acceptTeamInvite"),this.processCallback(ie);var ae={idServer:ie.idServer,teamId:ie.teamId,from:ie.from,type:"teamInvite"};this.sendCmd("acceptTeamInvite",ae,ie.callback)},V.rejectTeamInvite=function(ie){(ie=ie||{}).done=ue({instance:this,className:"NIMFn",funcName:"rejectTeamInvite",done:ie.done}),z.verifyOptions(ie,"idServer teamId from","team::rejectTeamInvite"),this.processPs(ie),this.processCallback(ie);var ae={idServer:ie.idServer,teamId:ie.teamId,from:ie.from,ps:ie.ps,type:"teamInvite"};this.sendCmd("rejectTeamInvite",ae,ie.callback)},V.applyTeam=function(ie){(ie=ie||{}).done=ue({instance:this,className:"NIMFn",funcName:"applyTeam",done:ie.done}),z.verifyOptions(ie,"teamId","team::applyTeam"),this.processPs(ie),this.processCallback(ie);var ae={teamId:ie.teamId,ps:ie.ps};this.sendCmd("applyTeam",ae,ie.callback)},V.passTeamApply=function(ie){(ie=ie||{}).done=ue({instance:this,className:"NIMFn",funcName:"passTeamApply",done:ie.done}),z.verifyOptions(ie,"idServer teamId from","team::passTeamApply"),this.processCallback(ie);var ae={idServer:ie.idServer,teamId:ie.teamId,from:ie.from,type:"applyTeam"};this.sendCmd("passTeamApply",ae,ie.callback)},V.rejectTeamApply=function(ie){(ie=ie||{}).done=ue({instance:this,className:"NIMFn",funcName:"rejectTeamApply",done:ie.done}),z.verifyOptions(ie,"idServer teamId from","team::rejectTeamApply"),this.processPs(ie),this.processCallback(ie);var ae={idServer:ie.idServer,teamId:ie.teamId,from:ie.from,ps:ie.ps,type:"applyTeam"};this.sendCmd("rejectTeamApply",ae,ie.callback)},V.addTeamManagers=function(ie){var ae;(ie=ie||{}).done=ue({instance:this,className:"NIMFn",funcName:"addTeamManagers",done:ie.done}),z.verifyOptions(ie,"teamId accounts","team::addTeamManagers"),z.verifyParamType("accounts",ie.accounts,"array","team::addTeamManagers"),this.processCallback(ie);var Ie={teamId:ie.teamId,accounts:y(ae=ie.accounts).call(ae,0)};this.sendCmd("addTeamManagers",Ie,ie.callback)},V.removeTeamManagers=function(ie){var ae;(ie=ie||{}).done=ue({instance:this,className:"NIMFn",funcName:"removeTeamManagers",done:ie.done}),z.verifyOptions(ie,"teamId accounts","team::removeTeamManagers"),z.verifyParamType("accounts",ie.accounts,"array","team::removeTeamManagers"),this.processCallback(ie);var Ie={teamId:ie.teamId,accounts:y(ae=ie.accounts).call(ae,0)};this.sendCmd("removeTeamManagers",Ie,ie.callback)},V.updateInfoInTeam=function(ie){(ie=ie||{}).done=ue({instance:this,className:"NIMFn",funcName:"updateInfoInTeam",done:ie.done}),z.verifyOptions(ie,"teamId","team::updateInfoInTeam"),this.processCallback(ie),this.sendCmd("updateInfoInTeam",{teamMember:new le(ie),single:!0},ie.callback)},V.updateNickInTeam=function(ie){(ie=ie||{}).done=ue({instance:this,className:"NIMFn",funcName:"updateNickInTeam",done:ie.done}),z.verifyOptions(ie,"teamId account","team::updateNickInTeam"),this.processCallback(ie),this.sendCmd("updateNickInTeam",{teamMember:new le(ie),single:!0},ie.callback)},V.updateMuteStateInTeam=function(ie){(ie=ie||{}).done=ue({instance:this,className:"NIMFn",funcName:"updateMuteStateInTeam",done:ie.done}),z.verifyOptions(ie,"teamId account mute","team::updateMuteStateInTeam"),this.processCallback(ie),ie.mute=ie.mute?1:0,this.sendCmd("updateMuteStateInTeam",ie)},V.getMutedTeamMembers=function(ie){(ie=ie||{}).done=ue({instance:this,className:"NIMFn",funcName:"getMutedTeamMembers",done:ie.done}),z.verifyOptions(ie,"teamId","team::getMutedTeamMembers"),this.processCallback(ie),this.sendCmd("getMutedTeamMembers",ie)},V.leaveTeam=function(ie){(ie=ie||{}).done=ue({instance:this,className:"NIMFn",funcName:"leaveTeam",done:ie.done}),z.verifyOptions(ie,"teamId","team::leaveTeam"),this.processCallback(ie);var ae={teamId:ie.teamId};this.sendCmd("leaveTeam",ae,ie.callback)},V.transferTeam=function(ie){(ie=ie||{}).done=ue({instance:this,className:"NIMFn",funcName:"transferTeam",done:ie.done}),z.verifyOptions(ie,"teamId account leave","team::transferTeam"),z.verifyParamType("leave",ie.leave,"boolean","team::transferTeam"),this.processCallback(ie);var ae={teamId:ie.teamId,account:ie.account,leave:ie.leave};this.sendCmd("transferTeam",ae,ie.callback)},V.dismissTeam=function(ie){(ie=ie||{}).done=ue({instance:this,className:"NIMFn",funcName:"dismissTeam",done:ie.done}),z.verifyOptions(ie,"teamId","team::dismissTeam"),this.processCallback(ie);var ae={teamId:ie.teamId};this.sendCmd("dismissTeam",ae,ie.callback)},V.getTeam=function(ie){(ie=ie||{}).done=ue({instance:this,className:"NIMFn",funcName:"getTeam",done:ie.done});var ae,Ie=this,de=Ie.db;function Ce(){Ie.sendCmd("getTeam",{teamId:ie.teamId},ie.callback)}z.verifyOptions(ie,"teamId","team::getTeam"),Ie.processCallback(ie),ie.cbaop=function(Ue){Ue||Ie.logger.info("api::getTeam: cbaop ".concat(ae))},ae=ie.teamId,de.enable&&!ie.sync?de.getTeam(ae).then(function(Ue){Ue&&Ue.validToCurrentUser?(Ie.logger.log("api::getTeam: db.getTeam ".concat(ae)),ie.done(null,Ue)):Ce()},Ce):Ce()},V.getTeams=function(ie){(ie=ie||{}).done=ue({instance:this,className:"NIMFn",funcName:"getTeams",done:ie.done});var ae=this,Ie=ae.db,de=0;function Ce(){ae.sendCmd("getTeams",{timetag:de,NOTSTORE:"timetag"},ie.callback)}z.verifyOptions(ie),ae.processCallback(ie),Ie.enable?Ie.getTeamsTimetag().then(function(Ue){de=Ue,Ce()},Ce):Ce()},V.getTeamsById=function(ie){(ie=ie||{}).done=ue({instance:this,className:"NIMFn",funcName:"getTeamsById",done:ie.done}),z.verifyOptions(ie,"teamIds","teams::getTeamsById"),this.processCallback(ie),this.sendCmd("getTeamsById",{teamIds:ie.teamIds},ie.callback)},V.getTeamMembers=function(ie){(ie=ie||{}).done=ue({instance:this,className:"NIMFn",funcName:"getTeamMembers",done:ie.done});var ae=this;z.verifyOptions(ie,"teamId","team::getTeamMembers"),ae.processCallback(ie),ae.sendCmd("getTeamMembers",{teamId:ie.teamId,timetag:0,NOTSTORE:"timetag"},ie.callback)},V.getTeamMemberByTeamIdAndAccount=function(ie){(ie=ie||{}).done=ue({instance:this,className:"NIMFn",funcName:"getTeamMemberByTeamIdAndAccount",done:ie.done});var ae=this;z.verifyParamType("teamId",ie.teamId,"numeric or numeric string","team::getTeamMemberByTeamIdAndAccount"),z.verifyOptions(ie,"account","team::getTeamMemberByTeamIdAndAccount"),ae.processCallback(ie),ae.sendCmd("getTeamMembers",{teamId:ie.teamId,timetag:0,NOTSTORE:"timetag"},function(Ie,de,Ce){var Ue={};if(de&&de.members&&de.members.length){for(var qe=0;qe<de.members.length;qe++)if(de.members[qe].account===ie.account){Ue[ie.account]=de.members[qe];break}}ie.callback(Ie,Ue,Ce)})},V.getTeamMemberInvitorAccid=function(ie){(ie=ie||{}).done=ue({instance:this,className:"NIMFn",funcName:"getTeamMemberInvitorAccid",done:ie.done}),z.verifyParamType("teamId",ie.teamId,"numeric or numeric string","team::getTeamMemberInvitorAccid"),re(ie.accounts)||(z.verifyParamType("accounts",ie.accounts,"array","team::getTeamMemberInvitorAccid"),ie.accounts.length>200&&z.onParamError("accounts 参数数组长度不能超过200","team::getTeamMemberInvitorAccid"));var ae,Ie={teamId:ie.teamId};ie.accounts.length&&(Ie.accounts=y(ae=ie.accounts).call(ae,0)),this.processCallback(ie),this.sendCmd("getTeamMemberInvitorAccid",Ie,function(de,Ce,Ue){ie.callback(de,Ue&&Ue.accountsMap||{})})},V.notifyForNewTeamMsg=function(ie){(ie=ie||{}).done=ue({instance:this,className:"NIMFn",funcName:"notifyForNewTeamMsg",done:ie.done}),z.verifyOptions(ie,"teamIds","team::notifyForNewTeamMsg"),this.protocol.notifyForNewTeamMsg(ie.teamIds).then(function(ae){ie.done(ae.error||null,i(ae),ae.miss)},function(ae){ie.done(ae)})},V.getMyTeamMembers=function(ie){ue({instance:this,className:"NIMFn",funcName:"getMyTeamMembers",done:ie.done,hasCallback:!1});var ae=ie.done;z.verifyOptions(ie,"teamIds","team::getMyTeamMembers");var Ie=this.processCallbackPromise(ie);return this.sendCmd("getMyTeamMembers",ie),Ie.then(function(de){return typeof ae=="function"?ae(null,de):de}).catch(function(de){if(typeof ae=="function")return ae(de);throw de})},V.getLocalTeams=function(ie){(ie=ie||{}).done=ue({instance:this,className:"NIMFn",funcName:"getLocalTeams",done:ie.done});var ae,Ie=this.db,de=[];function Ce(){ie.teams=de,ie.done(ae,ie)}z.verifyOptions(ie,"teamIds","team::getLocalTeams"),z.verifyParamType("teamIds",ie.teamIds,"array","team::getLocalTeams"),this.processCallback(ie),Ie.enable?Ie.getTeamsByTeamIds(ie.teamIds).then(function(Ue){de=k(Ue).call(Ue,function(qe){return!!qe}),Ce()},function(Ue){ae=Ue,Ce()}):Ce()},V.getTeamsFromDB=function(){var ie=g(n.mark(function ae(Ie){var de,Ce,Ue;return n.wrap(function(qe){for(;;)switch(qe.prev=qe.next){case 0:return Ce=(de=this).db,(Ie=Ie||{}).done=ue({instance:this,className:"NIMFn",funcName:"getTeamsFromDB",done:Ie.done}),z.validate({teamIds:{type:"array",required:!1}},Ie,"team::getTeamsFromDB"),de.processCallback(Ie),qe.next=8,Ce.getTeams(Ie);case 8:return Ue=qe.sent,Ie.callback(null,Ue),qe.abrupt("return",Ue);case 11:case"end":return qe.stop()}},ae,this)}));return function(ae){return ie.apply(this,arguments)}}(),V.getLocalTeamMembers=function(ie){(ie=ie||{}).done=ue({instance:this,className:"NIMFn",funcName:"getLocalTeamMembers",done:ie.done});var ae,Ie=this.db,de=[];function Ce(){ie.members=de,ie.done(ae,ie)}z.verifyOptions(ie,"teamId accounts","team::getLocalTeamMembers"),z.verifyParamType("accounts",ie.accounts,"array","team::getLocalTeamMembers"),this.processCallback(ie),Ie.enable?Ie.getInvalidTeamMembers(ie.teamId,ie.accounts).then(function(Ue){de=k(Ue).call(Ue,function(qe){return!!qe}),Ce()},function(Ue){ae=Ue,Ce()}):Ce()},V.getTeamMembersFromDB=function(){var ie=g(n.mark(function ae(Ie){var de,Ce,Ue;return n.wrap(function(qe){for(;;)switch(qe.prev=qe.next){case 0:return Ce=(de=this).db,(Ie=Ie||{}).done=ue({instance:this,className:"NIMFn",funcName:"getTeamMembersFromDB",done:Ie.done}),z.validate({teamIds:{type:"array",required:!1},accountIds:{type:"array",required:!1}},Ie,"team::getTeamMembersFromDB"),de.processCallback(Ie),qe.next=8,Ce.getTeamMembers(Ie);case 8:return Ue=qe.sent,Ie.callback(null,Ue),qe.abrupt("return",Ue);case 11:case"end":return qe.stop()}},ae,this)}));return function(ae){return ie.apply(this,arguments)}}(),V.deleteLocalTeam=function(ie){(ie=ie||{}).done=ue({instance:this,className:"NIMFn",funcName:"deleteLocalTeam",done:ie.done});var ae,Ie=this.db;function de(){ie.done(ae,ie)}z.verifyOptions(ie,"teamId","team::deleteLocalTeam"),this.processCallback(ie),Ie.enable?Ie.deleteTeam(ie.teamId).then(function(){de()},function(Ce){ae=Ce,de()}):de()},V.muteTeamAll=function(ie){(ie=ie||{}).done=ue({instance:this,className:"NIMFn",funcName:"muteTeamAll",done:ie.done}),z.verifyOptions(ie,"teamId mute","team::muteTeamAll"),ie.mute=ie.mute?1:0,this.processCallback(ie),this.sendCmd("muteTeamAll",ie)},V.sendTeamMsgReceipt=function(ie){(ie=ie||{}).done=ue({instance:this,className:"NIMFn",funcName:"sendTeamMsgReceipt",done:ie.done}),z.verifyOptions(ie,"teamMsgReceipts","team::sendTeamMsgReceipt"),ie.teamMsgReceipts.length>50?this.logger.error("team::sendTeamMsgReceipt：teamMsgReceipts length over 50"):(this.processCallback(ie),this.sendCmd("sendTeamMsgReceipt",ie))},V.getTeamMsgReads=function(ie){(ie=ie||{}).done=ue({instance:this,className:"NIMFn",funcName:"getTeamMsgReads",done:ie.done}),z.verifyOptions(ie,"teamMsgReceipts","team::getTeamMsgReads"),this.processCallback(ie),this.sendCmd("getTeamMsgReads",ie)},V.getTeamMsgReadAccounts=function(ie){var ae=this;(ie=ie||{}).done=ue({instance:this,className:"NIMFn",funcName:"getTeamMsgReadAccounts",done:ie.done});var Ie,de=this;z.verifyOptions(ie,"teamMsgReceipt","team::getTeamMsgReadAccounts"),ie.callback=function(Ce,Ue,qe){Ce&&Ie?(Ue=Ue||{teamMsgReceipt:ie.teamMsgReceipt},ie.done(Ce,Ue,{teamMsgReceipt:ie.teamMsgReceipt,unreadAccounts:Ie.unreadAccounts,readAccounts:Ie.readAccounts})):ie.done(Ce,Ue,qe)},this.db.enable&&ie.teamMsgReceipt.idClient?this.db.getMsgReadDetail(ie.teamMsgReceipt.idClient).then(function(Ce){if(Ie=Ce,!Ce)return L.reject("no record");if(Ce.unreadAccounts&&Ce.unreadAccounts.length>0)return L.reject("unreadAccounts.length > 0");var Ue={teamMsgReceipt:ie.teamMsgReceipt,unreadAccounts:Ce.unreadAccounts,readAccounts:Ce.readAccounts};de.logger.info("getTeamMsgReadAccounts from db"),ie.done(null,{teamMsgReceipt:ie.teamMsgReceipt},Ue)}).catch(function(Ce){ae.logger.warn("db.getMsgReadDetail invalid",Ce),de.sendCmd("getTeamMsgReadAccounts",ie)}):de.sendCmd("getTeamMsgReadAccounts",ie)},V.addTeamMembersFollow=function(){var ie=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};z.validate({teamId:{type:"string",allowEmpty:!1,required:!0},accountIds:{type:"array",min:1,itemType:"string",required:!0}},ie),ie.done=ue({instance:this,className:"NIMFn",funcName:"addTeamMembersFollow",done:ie.done}),this.processCallback(ie),this.sendCmd("updateInfoInTeam",{teamMember:{teamId:ie.teamId},teamSpecialFollowUpdateTag:{accountIds:$(ie.accountIds),type:1},single:!0},ie.callback)},V.removeTeamMembersFollow=function(ie){z.validate({teamId:{type:"string",allowEmpty:!1,required:!0},accountIds:{type:"array",min:1,itemType:"string",required:!0}},ie),ie.done=ue({instance:this,className:"NIMFn",funcName:"removeTeamMembersFollow",done:ie.done}),this.processCallback(ie),this.sendCmd("updateInfoInTeam",{teamMember:{teamId:ie.teamId},teamSpecialFollowUpdateTag:{accountIds:$(ie.accountIds),type:0},single:!0},ie.callback)}},function(t,r,e){var n=e(207),g=e(3),y=e(10),i=e(23),k=e(9),L=e(11),$=e(2),V=e(4),z=e(6),re=e(41).fn,oe=e(0),le=oe.undef,ue=e(312),ie=e(206),ae=e(26).reportAPI;function Ie(de){var Ce=this.db;if(!Ce.enable)return g.resolve({valid:!1});var Ue=Ce.getSuperTeam(de),qe=Ce.getSuperTeamMembersTimetag(de);return g.all([Ue,qe]).then(function(jt){var Fe=n(jt,2),Et=Fe[0],cr=Fe[1],er=Et&&Et.memberUpdateTime,nr={timetag:cr=cr||0};return er&&cr>=er&&(nr.valid=!0),g.resolve(nr)}).catch(function(){return g.resolve({timetag:0})})}re.addSuperTeamMembers=function(de){(de=de||{}).done=ae({instance:this,className:"NIMFn",funcName:"addSuperTeamMembers",done:de.done}),oe.verifyOptions(de,"teamId accounts","superTeam::addSuperTeamMembers"),oe.verifyParamType("accounts",de.accounts,"array","superTeam::addSuperTeamMembers");var Ce=oe.deduplicate(de.accounts);this.processPs(de),this.processCallback(de);var Ue={teamId:de.teamId,accounts:Ce,ps:de.ps};this.sendCmd("addSuperTeamMembers",Ue,de.callback)},re.removeSuperTeamMembers=function(de){(de=de||{}).done=ae({instance:this,className:"NIMFn",funcName:"removeSuperTeamMembers",done:de.done}),oe.verifyOptions(de,"teamId accounts","team::removeSuperTeamMembers"),oe.verifyParamType("accounts",de.accounts,"array","team::removeSuperTeamMembers");var Ce=oe.deduplicate(de.accounts);this.processCallback(de);var Ue={teamId:de.teamId,accounts:Ce};this.sendCmd("removeSuperTeamMembers",Ue,de.callback)},re.leaveSuperTeam=function(de){(de=de||{}).done=ae({instance:this,className:"NIMFn",funcName:"leaveSuperTeam",done:de.done}),oe.verifyOptions(de,"teamId","superTeam::leaveSuperTeam"),this.processCallback(de);var Ce={teamId:de.teamId};this.sendCmd("leaveSuperTeam",Ce,de.callback)},re.getSuperTeam=function(de){(de=de||{}).done=ae({instance:this,className:"NIMFn",funcName:"getSuperTeam",done:de.done});var Ce,Ue=this,qe=Ue.db;function jt(){Ue.sendCmd("getSuperTeam",{teamId:de.teamId},de.callback)}oe.verifyOptions(de,"teamId","team::getSuperTeam"),Ue.processCallback(de),de.cbaop=function(Fe){Fe||Ue.logger.info("api::getSuperTeam: cbaop ".concat(Ce))},Ce=de.teamId,qe.enable&&!de.sync?qe.getSuperTeam(Ce).then(function(Fe){Fe&&Fe.validToCurrentUser?(Ue.logger.log("api::getSuperTeam: db.getSuperTeam ".concat(Ce)),de.done(null,Fe)):jt()}).catch(function(){jt()}):jt()},re.getSuperTeams=function(de){(de=de||{}).done=ae({instance:this,className:"NIMFn",funcName:"getSuperTeams",done:de.done});var Ce=this,Ue=Ce.db,qe=0;function jt(){Ce.sendCmd("getSuperTeams",{timetag:qe,NOTSTORE:"timetag"},de.callback)}oe.verifyOptions(de),Ce.processCallback(de),Ue.enable?Ue.getSuperTeamsTimetag().then(function(Fe){qe=Fe,jt()},jt):jt()},re.updateSuperTeam=function(de){(de=de||{}).done=ae({instance:this,className:"NIMFn",funcName:"updateSuperTeam",done:de.done}),oe.verifyOptions(de,"teamId","superTeam::updateSuperTeam"),de.action="update",this.processCallback(de),de.team=new ue(de),this.sendCmd("updateSuperTeam",{team:de.team,antispamTag:{antiSpamBusinessId:de.antiSpamBusinessId},single:!0},de.callback)},re.updateInfoInSuperTeam=function(de){(de=de||{}).done=ae({instance:this,className:"NIMFn",funcName:"updateInfoInSuperTeam",done:de.done}),oe.verifyOptions(de,"teamId","superTeam::updateInfoInSuperTeam"),this.processCallback(de),this.sendCmd("updateInfoInSuperTeam",{superTeamMember:new ie(de),single:!0},de.callback)},re.getSuperTeamMembersByJoinTime=function(de){(de=de||{}).done=ae({instance:this,className:"NIMFn",funcName:"getSuperTeamMembersByJoinTime",done:de.done});var Ce=this,Ue=de,qe=Ue.joinTime,jt=y(Ue),Fe=Ue.limit,Et=Ue.teamId;jt=!!jt,le(qe)&&(qe=0),le(Fe)&&(Fe=100),oe.verifyOptions(de,"teamId","superTeam::getSuperTeamMembersByJoinTime"),oe.verifyParamType("joinTime",qe,"number","api::superTeam::getSuperTeamMembersByJoinTime"),oe.verifyParamType("limit",Fe,"number","api::superTeam::getSuperTeamMembersByJoinTime"),Ce.processCallback(de),Ce.sendCmd("getSuperTeamMembersByJoinTime",{teamId:Et,limit:Fe,joinTime:qe,reverse:jt,timetag:0,NOTSTORE:"timetag"},de.callback)},re.getAllSuperTeamMembers=function(de){(de=de||{}).done=ae({instance:this,className:"NIMFn",funcName:"getAllSuperTeamMembers",done:de.done});var Ce=this,Ue=this.db;function qe(jt){jt=jt||0,Ce.sendCmd("getSuperTeamMembers",{teamId:de.teamId,timetag:jt,NOTSTORE:"timetag"},de.callback)}oe.verifyOptions(de,"teamId","superTeam::getAllSuperTeamMembers"),Ce.processCallback(de),i(Ie).call(Ie,this)(de.teamId).then(function(jt){var Fe=jt.valid,Et=jt.timetag;Fe?(Ce.logger.info("getAllSuperTeamMembers from local db"),Ue.getSuperTeamMembers(de.teamId).then(function(cr){var er={teamId:de.teamId,members:cr};de.done(null,er)},function(){return qe()})):qe(Et)})},re.applySuperTeam=function(de){(de=de||{}).done=ae({instance:this,className:"NIMFn",funcName:"applySuperTeam",done:de.done}),oe.verifyOptions(de,"teamId","team::applySuperTeam"),oe.verifyOptions(de,"teamId","team::applySuperTeam"),this.processPs(de),this.processCallback(de);var Ce={teamId:de.teamId,ps:de.ps};this.sendCmd("applySuperTeam",Ce,de.callback)},re.passSuperTeamApply=function(de){(de=de||{}).done=ae({instance:this,className:"NIMFn",funcName:"passSuperTeamApply",done:de.done}),oe.verifyOptions(de,"idServer teamId from","team::passSuperTeamApply"),this.processCallback(de);var Ce={idServer:de.idServer,teamId:de.teamId,from:de.from};this.sendCmd("passSuperTeamApply",Ce,de.callback)},re.rejectSuperTeamApply=function(de){(de=de||{}).done=ae({instance:this,className:"NIMFn",funcName:"rejectSuperTeamApply",done:de.done}),oe.verifyOptions(de,"idServer teamId from","team::rejectSuperTeamApply"),this.processPs(de),this.processCallback(de);var Ce={idServer:de.idServer,teamId:de.teamId,from:de.from,ps:de.ps};this.sendCmd("rejectSuperTeamApply",Ce,de.callback)},re.acceptSuperTeamInvite=function(de){(de=de||{}).done=ae({instance:this,className:"NIMFn",funcName:"acceptSuperTeamInvite",done:de.done}),oe.verifyOptions(de,"idServer teamId from","team::acceptSuperTeamInvite"),this.processCallback(de);var Ce={idServer:de.idServer,teamId:de.teamId,from:de.from};this.sendCmd("acceptSuperTeamInvite",Ce,de.callback)},re.rejectSuperTeamInvite=function(de){(de=de||{}).done=ae({instance:this,className:"NIMFn",funcName:"rejectSuperTeamInvite",done:de.done}),oe.verifyOptions(de,"idServer teamId from","team::rejectSuperTeamInvite"),this.processPs(de),this.processCallback(de);var Ce={idServer:de.idServer,teamId:de.teamId,from:de.from,ps:de.ps};this.sendCmd("rejectSuperTeamInvite",Ce,de.callback)},re.addSuperTeamManagers=function(de){var Ce;(de=de||{}).done=ae({instance:this,className:"NIMFn",funcName:"addSuperTeamManagers",done:de.done}),oe.verifyOptions(de,"teamId accounts","team::addSuperTeamManagers"),oe.verifyParamType("accounts",de.accounts,"array","team::addSuperTeamManagers"),this.processCallback(de);var Ue={teamId:de.teamId,accounts:k(Ce=de.accounts).call(Ce,0)};this.sendCmd("addSuperTeamManagers",Ue,de.callback)},re.removeSuperTeamManagers=function(de){var Ce;(de=de||{}).done=ae({instance:this,className:"NIMFn",funcName:"removeSuperTeamManagers",done:de.done}),oe.verifyOptions(de,"teamId accounts","team::removeSuperTeamManagers"),oe.verifyParamType("accounts",de.accounts,"array","team::removeSuperTeamManagers"),this.processCallback(de);var Ue={teamId:de.teamId,accounts:k(Ce=de.accounts).call(Ce,0)};this.sendCmd("removeSuperTeamManagers",Ue,de.callback)},re.updateSuperTeamMembersMute=function(de){(de=de||{}).done=ae({instance:this,className:"NIMFn",funcName:"updateSuperTeamMembersMute",done:de.done}),oe.verifyOptions(de,"teamId accounts mute","team::updateSuperTeamMembersMute"),oe.verifyParamType("accounts",de.accounts,"array","team::updateSuperTeamMembersMute"),oe.verifyArrayMax("accounts",de.accounts,10),this.processCallback(de),de.mute=de.mute?1:0,this.sendCmd("updateSuperTeamMembersMute",de)},re.updateSuperTeamMute=function(de){(de=de||{}).done=ae({instance:this,className:"NIMFn",funcName:"updateSuperTeamMute",done:de.done}),oe.verifyOptions(de,"teamId mute","team::updateSuperTeamMute"),de.mute=de.mute?1:0,this.processCallback(de),this.sendCmd("updateSuperTeamMute",de)},re.updateNickInSuperTeam=function(de){(de=de||{}).done=ae({instance:this,className:"NIMFn",funcName:"updateNickInSuperTeam",done:de.done}),oe.verifyOptions(de,"teamId account","team::updateNickInSuperTeam"),this.processCallback(de),this.sendCmd("updateNickInSuperTeam",{superTeamMember:new ie(de),single:!0},de.callback)},re.transferSuperTeam=function(de){(de=de||{}).done=ae({instance:this,className:"NIMFn",funcName:"transferSuperTeam",done:de.done}),oe.verifyOptions(de,"teamId account leave","team::transferSuperTeam"),oe.verifyParamType("leave",de.leave,"boolean","team::transferSuperTeam"),this.processCallback(de);var Ce={teamId:de.teamId,account:de.account,leave:de.leave};this.sendCmd("transferSuperTeam",Ce,de.callback)},re.getSuperTeamMembersByAccounts=function(de){(de=de||{}).done=ae({instance:this,className:"NIMFn",funcName:"getSuperTeamMembersByAccounts",done:de.done});var Ce=this,Ue=this.db,qe=de,jt=qe.teamId,Fe=qe.accounts;if(oe.verifyOptions(de,"teamId accounts","superTeam::getSuperTeamMembersByAccounts"),oe.verifyParamType("accounts",Fe,"array","superTeam::getSuperTeamMembersByAccounts"),oe.verifyArrayMax("accounts",Fe,20),Fe.length<=0)return oe.onParamError("参数accounts不能为空数组","superTeam::getSuperTeamMembersByAccounts");function Et(){var cr=L(Fe).call(Fe,function(er){return jt+"|"+er});Ce.processCallback(de),Ce.sendCmd("getSuperTeamMembersByAccounts",{memberIds:cr},function(er,nr){de.done(null,{accounts:Fe,members:nr.members,invaldAccounts:nr.invalid})})}Ie.call(this,jt).then(function(cr){var er,nr,dr;return cr.valid?(er=[],nr=[],dr=[],$(Fe).call(Fe,function(ir){var tr,ur=Ue.getSuperTeamMemberById(V(tr="".concat(jt,"-")).call(tr,ir)).then(function(or){nr.push(or)}).catch(function(){dr.push(ir)});er.push(ur)}),void g.all(er).then(function(){de.done(null,{accounts:Fe,members:nr,invaldAccounts:dr})})):Et()}).catch(function(){return Et()})},re.getMutedSuperTeamMembers=function(de){(de=de||{}).done=ae({instance:this,className:"NIMFn",funcName:"getMutedSuperTeamMembers",done:de.done});var Ce=this,Ue=de,qe=Ue.joinTime,jt=y(Ue),Fe=Ue.limit,Et=Ue.teamId;jt=!!jt,le(qe)&&(qe=0),le(Fe)&&(Fe=100),oe.verifyOptions(de,"teamId","superTeam::getSuperTeamMembersByJoinTime"),oe.verifyParamType("joinTime",qe,"number","api::superTeam::getSuperTeamMembersByJoinTime"),oe.verifyParamType("limit",Fe,"number","api::superTeam::getSuperTeamMembersByJoinTime"),this.processCallback(de),Ce.sendCmd("getMutedSuperTeamMembers",{teamId:Et,limit:Fe,joinTime:qe,reverse:jt},de.callback)},re.addSuperTeamMembersFollow=function(){var de=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};oe.validate({teamId:{type:"string",allowEmpty:!1,required:!0},accountIds:{type:"array",min:1,itemType:"string",required:!0}},de),de.done=ae({instance:this,className:"NIMFn",funcName:"addSuperTeamMembersFollow",done:de.done}),this.processCallback(de),this.sendCmd("updateInfoInSuperTeam",{superTeamMember:{teamId:de.teamId},teamSpecialFollowUpdateTag:{accountIds:z(de.accountIds),type:1},single:!0},de.callback)},re.removeSuperTeamMembersFollow=function(de){oe.validate({teamId:{type:"string",allowEmpty:!1,required:!0},accountIds:{type:"array",min:1,itemType:"string",required:!0}},de),de.done=ae({instance:this,className:"NIMFn",funcName:"removeSuperTeamMembersFollow",done:de.done}),this.processCallback(de),this.sendCmd("updateInfoInSuperTeam",{superTeamMember:{teamId:de.teamId},teamSpecialFollowUpdateTag:{accountIds:z(de.accountIds),type:0},single:!0},de.callback)},re.getMySuperTeamMembers=function(de){ae({instance:this,className:"NIMFn",funcName:"getMySuperTeamMembers",done:de.done,hasCallback:!1}),this.processCallback(de),oe.verifyOptions(de,"teamIds","team::getMySuperTeamMembers"),this.sendCmd("getMySuperTeamMembers",de)}},function(t,r,e){var n=e(60),g=e(11),y=e(3),i=e(2),k=e(4),L=e(10),$=e(781),V=e(34),z=e(9),re=e(93),oe=e(28),le=e(15),ue=e(8),ie=e(68),ae=e(78),Ie=e(64),de=e(61);function Ce(tr,ur){var or=ae!==void 0&&Ie(tr)||tr["@@iterator"];if(!or){if(oe(tr)||(or=function(kr,mr){var Ir;if(kr){if(typeof kr=="string")return Ue(kr,mr);var Nr=z(Ir=Object.prototype.toString.call(kr)).call(Ir,8,-1);if(Nr==="Object"&&kr.constructor&&(Nr=kr.constructor.name),Nr==="Map"||Nr==="Set")return ie(kr);if(Nr==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(Nr))return Ue(kr,mr)}}(tr))||ur&&tr&&typeof tr.length=="number"){or&&(tr=or);var fr=0,lr=function(){};return{s:lr,n:function(){return fr>=tr.length?{done:!0}:{done:!1,value:tr[fr++]}},e:function(kr){throw kr},f:lr}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var gr,Sr=!0,wr=!1;return{s:function(){or=or.call(tr)},n:function(){var kr=or.next();return Sr=kr.done,kr},e:function(kr){wr=!0,gr=kr},f:function(){try{Sr||or.return==null||or.return()}finally{if(wr)throw gr}}}}function Ue(tr,ur){(ur==null||ur>tr.length)&&(ur=tr.length);for(var or=0,fr=new Array(ur);or<ur;or++)fr[or]=tr[or];return fr}var qe=e(41).fn,jt=e(0),Fe=jt.undef,Et=jt.notundef,cr=e(303),er=e(162),nr=e(26).reportAPI,dr=e(876);function ir(tr,ur){var or=this,fr=[],lr=[],gr=this.db,Sr=this;return gr.enable?(i(tr).call(tr,function(kr){var mr=or.protocol.getSessionInCache(kr);mr?wr(mr,kr):lr.push(gr.getSession(kr).then(function(Ir){return wr(Ir,kr)}))}),y.all(lr).then(function(){return fr})):(i(tr).call(tr,function(kr){return wr(or.protocol.getSessionInCache(kr),kr)}),y.resolve(fr));function wr(kr,mr){var Ir,Nr,Er,sr;kr?kr.lastMsg?kr.scene&&kr.to?kr.ack>=kr.lastMsg.time?Sr.logger.warn(k(Ir="".concat(ur," not need ack ")).call(Ir,kr.id)):fr.push(kr):Sr.logger.warn(k(Nr="".concat(ur," session.scene|to undefined ")).call(Nr,kr.id)):Sr.logger.warn(k(Er="".concat(ur," session.lastMsg undefined ")).call(Er,kr.id)):Sr.logger.warn(k(sr="".concat(ur," session undefined ")).call(sr,mr))}}qe.setCurrSession=function(tr){nr({instance:this,className:"NIMFn",funcName:"setCurrSession",hasCallback:!1}),this.resetSessionUnread(tr),this.protocol.setCurrSession(tr)},qe.resetAllSessionUnread=function(){nr({instance:this,className:"NIMFn",funcName:"resetAllSessionUnread",hasCallback:!1});for(var tr in this.protocol.sessionSet)this.protocol.sessionSet[tr].unread>0&&this.resetSessionUnread(tr)},qe.resetSessionsUnread=function(){var tr=de(n.mark(function ur(or){var fr,lr,gr,Sr,wr,kr,mr,Ir,Nr=arguments;return n.wrap(function(Er){for(;;)switch(Er.prev=Er.next){case 0:return fr=Nr.length>1&&Nr[1]!==void 0?Nr[1]:function(){},fr=nr({instance:this,className:"NIMFn",funcName:"resetSessionsUnread",done:fr}),(lr=this).logger.info("resetSessionsUnread::",or),Er.next=6,ir.call(this,or,"api::resetSessionsUnread");case 6:if(gr=Er.sent,lr.protocol.resetSessionsUnread(gr),lr.options.syncSessionUnread&&gr.length!==0){Er.next=11;break}return fr(),Er.abrupt("return");case 11:Sr=g(gr).call(gr,function(sr){return{scene:sr.scene==="p2p"?0:1,to:sr.to,timetag:sr.lastMsg.time}}),wr=dr(Sr,50),kr=Ce(wr),Er.prev=14,Ir=n.mark(function sr(){var xr;return n.wrap(function(Or){for(;;)switch(Or.prev=Or.next){case 0:return xr=mr.value,Or.next=3,new y(function(Mr,br){lr.sendCmd("markSessionAckBatch",{sessionAckTags:xr},function(hr){hr?(fr(hr),br(hr)):Mr()})});case 3:case"end":return Or.stop()}},sr)}),kr.s();case 17:if((mr=kr.n()).done){Er.next=21;break}return Er.delegateYield(Ir(),"t0",19);case 19:Er.next=17;break;case 21:Er.next=26;break;case 23:Er.prev=23,Er.t1=Er.catch(14),kr.e(Er.t1);case 26:return Er.prev=26,kr.f(),Er.finish(26);case 29:fr(null);case 30:case"end":return Er.stop()}},ur,this,[[14,23,26,29]])}));return function(ur){return tr.apply(this,arguments)}}(),qe.resetSuperTeamSessionsUnread=function(){var tr=de(n.mark(function ur(or){var fr,lr,gr,Sr,wr,kr,mr,Ir,Nr=arguments;return n.wrap(function(Er){for(;;)switch(Er.prev=Er.next){case 0:return fr=Nr.length>1&&Nr[1]!==void 0?Nr[1]:function(){},fr=nr({instance:this,className:"NIMFn",funcName:"resetSuperTeamSessionsUnread",done:fr}),(lr=this).logger.info("resetSuperTeamSessionsUnread::",or),Er.next=6,ir.call(this,or,"api::resetSuperTeamSessionsUnread");case 6:if(gr=Er.sent,lr.protocol.resetSessionsUnread(gr),lr.options.syncSessionUnread&&gr.length!==0){Er.next=11;break}return fr(),Er.abrupt("return");case 11:Sr=g(gr).call(gr,function(sr){return{to:sr.to,timetag:sr.lastMsg.time}}),wr=dr(Sr,50),kr=Ce(wr),Er.prev=14,Ir=n.mark(function sr(){var xr;return n.wrap(function(Or){for(;;)switch(Or.prev=Or.next){case 0:return xr=mr.value,Or.next=3,new y(function(Mr,br){lr.sendCmd("markSuperTeamSessionsAck",{sessionAckTags:xr},function(hr){hr?(fr(hr),br(hr)):Mr()})});case 3:case"end":return Or.stop()}},sr)}),kr.s();case 17:if((mr=kr.n()).done){Er.next=21;break}return Er.delegateYield(Ir(),"t0",19);case 19:Er.next=17;break;case 21:Er.next=26;break;case 23:Er.prev=23,Er.t1=Er.catch(14),kr.e(Er.t1);case 26:return Er.prev=26,kr.f(),Er.finish(26);case 29:fr(null);case 30:case"end":return Er.stop()}},ur,this,[[14,23,26,29]])}));return function(ur){return tr.apply(this,arguments)}}(),qe.resetSessionUnread=function(tr){var ur=arguments.length>1&&arguments[1]!==void 0?arguments[1]:function(){};ur=nr({instance:this,className:"NIMFn",funcName:"resetSessionUnread",done:ur});var or=this,fr=or.options.resetUnreadMode!==!1,lr=function(){var kr=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;kr?ur(kr,tr):ur(null)};or.logger.info("resetSessionUnread::use reset mode",fr);var gr=or.protocol.getSessionInCache(tr),Sr=!gr&&this.db.enable?or.db.getSession(tr):y.resolve(gr);function wr(kr){if(!kr.lastMsg&&!kr.updateTime)return or.logger.warn("api::resetSessionUnread: session.lastMsg undefined ".concat(tr)),lr();if(!kr.scene||!kr.to)return or.logger.warn("api::resetSessionUnread: session.scene|to undefined ".concat(tr)),lr();var mr;if(mr=kr.lastMsg?kr.lastMsg.time:kr.updateTime,kr&&kr.ack&&kr.ack>=mr)return or.logger.warn("api::resetSessionUnread: session ack not needs ".concat(tr)),lr();var Ir={done:function(Er){Er?(or.logger.error({message:Er||"mark ack failed",callFunc:"resetSessionUnread"}),lr(Er||"mark ack failed")):(fr||or.protocol.resetSessionUnread(kr),lr())}};if(or.processCallback(Ir),kr.scene==="superTeam")or.sendCmd("markSuperTeamSessionAck",{to:kr.to,timetag:mr},Ir.callback);else{var Nr={scene:kr.scene==="p2p"?0:1,to:kr.to,timetag:mr};or.sendCmd("markSessionAck",Nr,Ir.callback)}}Sr.then(function(kr){return kr?or.options.syncSessionUnread?(fr&&or.protocol.resetSessionUnread(kr),void wr(kr)):(or.protocol.resetSessionUnread(kr),lr()):(or.logger.warn("api::resetSessionUnread: session undefined ".concat(tr)),lr())})},qe.resetCurrSession=function(){nr({instance:this,className:"NIMFn",funcName:"resetCurrSession",hasCallback:!1}),this.protocol.setCurrSession("")},qe.insertLocalSession=function(tr){(tr=tr||{}).done=nr({instance:this,className:"NIMFn",funcName:"insertLocalSession",done:tr.done});var ur,or;function fr(){tr.session=or,tr.done(ur,tr)}jt.verifyOptions(tr,"scene to","scene::insertLocalSession"),jt.verifyParamValid("scene",tr.scene,this.message.validScenes,"scene::insertLocalSession"),this.protocol.insertLocalSession(tr).then(function(lr){or=lr,fr()},function(lr){ur=lr,fr()})},qe.getLocalSessions=function(tr){(tr=tr||{}).done=nr({instance:this,className:"NIMFn",funcName:"getLocalSessions",done:tr.done});var ur=[];jt.verifyOptions(tr),Fe(tr.limit)&&(tr.limit=100),jt.verifyParamType("limit",tr.limit,"number","scene::getLocalSessions"),Et(L(tr))?jt.verifyParamType("reverse",L(tr),"boolean","scene::getLocalSessions"):tr.reverse=!1,this.processCallback(tr);var or=$(this.protocol.sessionSet),fr=0,lr=tr.lastSessionId;if(L(tr)){var gr,Sr=Ce(or);try{for(Sr.s();!(gr=Sr.n()).done;){var wr=gr.value,kr=wr.id;if(lr)kr===lr&&(lr=void 0);else if(wr.lastMsg!==void 0&&!wr.isDeleted){if(++fr>tr.limit)break;ur.push(V({},wr))}}}catch(sr){Sr.e(sr)}finally{Sr.f()}}else{var mr,Ir,Nr=Ce(or);try{for(Nr.s();!(Ir=Nr.n()).done;){var Er=Ir.value;if(lr===Er.id)break;Er.lastMsg===void 0||Er.isDeleted||ur.push(Er)}}catch(sr){Nr.e(sr)}finally{Nr.f()}ur=L(mr=z(ur).call(ur,-tr.limit)).call(mr)}this.logger.debug("getLocalSessions::sessions is",ur),ur=g(ur).call(ur,function(sr){return re(er).call(er,sr)}),tr.sessions=ur,delete tr.callback,tr.done(void 0,tr)},qe.getLocalSession=function(tr){(tr=tr||{}).done=nr({instance:this,className:"NIMFn",funcName:"getLocalSession",done:tr.done});var ur=this,or=ur.db,fr=null;if(jt.verifyOptions(tr,"sessionId","scene::getLocalSession"),jt.verifyParamType("sessionId",tr.sessionId,"string","scene::getLocalSession"),fr=ur.protocol.getSessionInCache(tr.sessionId),ur.logger.debug("getLocalSession::cache session is",fr),!fr&&or.enable)return ur.processCallback(tr),void or.getSession(tr.sessionId).then(function(lr){lr&&(fr=lr,ur.logger.debug("getLocalSession::db session is",fr)),tr.done(null,fr)}).catch(function(lr){tr.done(lr)});tr.done(null,re(er).call(er,fr))},qe.getLocalSessionsByMsgType=function(tr){var ur;(tr=tr||{}).done=nr({instance:this,className:"NIMFn",funcName:"getLocalSessionsByMsgType",done:tr.done});var or=this.db,fr=tr.exclude,lr=[],gr=z(ur=cr.validTypes).call(ur,0);if(Et(fr)){if(typeof fr=="string")fr=[fr];else if(!oe(fr))return void jt.onParamInvalidType("exclude",["string","string array"],"","exclude::getLocalSessionsByMsgType");fr=le(fr).call(fr,function(Sr){return ue(gr).call(gr,Sr)>-1}),gr=le(gr).call(gr,function(Sr){return ue(fr).call(fr,Sr)===-1})}this.processCallback(tr),or.enable?or.getSessions().then(function(Sr){fr&&fr.length!==0?gr&&gr.length!==0?(i(Sr).call(Sr,function(wr,kr){var mr,Ir,Nr;wr.lastMsg&&ue(fr).call(fr,wr.lastMsg.type)>-1&&(mr=kr,Ir=wr.id,Nr=or.getMsgs({sessionId:Ir,limit:1,types:gr}).then(function(Er){return Er&&Er[0]?Sr[mr].lastMsg=Er[0]:Sr[mr].lastMsg=null,y.resolve()}),lr.push(Nr))}),y.all(lr).then(function(){tr.done(null,{exclude:fr,sessions:Sr})})):tr.done(null,{exclude:fr,sessions:g(Sr).call(Sr,function(wr){wr.lastMsg=null})}):tr.done(null,{exclude:fr,sessions:Sr})}):tr.done(null,{exclude:fr,sessions:[]})},qe.updateLocalSession=function(tr){(tr=tr||{}).done=nr({instance:this,className:"NIMFn",funcName:"updateLocalSession",done:tr.done});var ur,or=this,fr=or.db;jt.verifyOptions(tr,"id","scene::updateLocalSession"),or.processCallback(tr);var lr=jt.filterObj(tr,"id localCustom");function gr(){tr.needNotify!==!1&&or.protocol.onUpdateSession(lr),tr.session=lr,tr.done(ur,tr)}lr=or.protocol.updateSessionInCache(tr),fr.enable&&lr?fr.updateSession(lr).then(function(Sr){lr=Sr,gr()},function(Sr){ur=Sr,gr()}):gr()},qe.deleteLocalSession=function(tr){(tr=tr||{}).done=nr({instance:this,className:"NIMFn",funcName:"deleteLocalSession",done:tr.done});var ur,or=this,fr=or.db;jt.verifyOptions(tr,"id","session::deleteLocalSession"),or.processCallback(tr);var lr=or.protocol.getSessionInCache(tr.id);if(or.protocol.deleteSessionInCache(tr.id,tr.isLogic),fr.enable?(tr.isLogic?fr.deleteSessionLogic(tr.id):fr.deleteSession(tr.id,lr)).then(function(){or.logger.info("sessions::deleteSessionInDb::delete session done",tr.id),Sr()},function(wr){ur=wr,Sr()}):Sr(),tr.isDeleteRoaming){var gr=typeof tr.id=="string"?[tr.id]:tr.id;gr=g(gr).call(gr,function(wr){return wr.replace("-","|")}),this.sendCmd("deleteSessions",{sessions:gr},function(){})}function Sr(){tr.done(ur,tr)}},qe.deleteSession=function(tr,ur){(tr=tr||{}).done=nr({instance:this,className:"NIMFn",funcName:"deleteSession",done:tr.done}),ur||this.logger.warn('this api will be abandon,please use "deleteLocalSession"'),jt.verifyOptions(tr,"scene to","session::deleteSession"),this.processCallback(tr),tr.sessions=[{scene:tr.scene,to:tr.to}],this.deleteSessions(tr)},qe.deleteRoamingMsgBySession=function(tr){(tr=tr||{}).done=nr({instance:this,className:"NIMFn",funcName:"deleteRoamingMsgBySession",done:tr.done}),this.deleteSession(tr,!0)},qe.deleteSessions=function(tr){var ur,or;(tr=tr||{}).done=nr({instance:this,className:"NIMFn",funcName:"deleteSessions",done:tr.done}),jt.verifyOptions(tr,"sessions","session::deleteSessions"),jt.verifyParamType("sessions",tr.sessions,"array","session::deleteSessions"),i(ur=tr.sessions).call(ur,function(fr,lr){jt.verifyOptions(fr,"scene to",!0,"sessions["+lr+"].","session::deleteSessions")}),this.processCallback(tr),this.sendCmd("deleteSessions",{sessions:g(or=tr.sessions).call(or,function(fr){return fr.scene+"|"+fr.to})},tr.callback)},qe.getServerSessions=function(tr){(tr=tr||{}).done=nr({instance:this,className:"NIMFn",funcName:"getServerSessions",done:tr.done}),Et(tr.minTimestamp)&&jt.verifyParamType("minTimestamp",tr.minTimestamp,"number","session::deleteSessions"),Et(tr.maxTimestamp)&&jt.verifyParamType("maxTimestamp",tr.maxTimestamp,"number","session::deleteSessions"),Et(tr.needLastMsg)&&(tr.needLastMsg=tr.needLastMsg===!1?0:1),Et(tr.limit)&&(jt.verifyParamType("limit",tr.limit,"number","session::deleteSessions"),jt.verifyParamMax("limit",tr.limit,100,"scene::getLocalSessions")),this.processCallback(tr),this.sendCmd("getServerSessions",{sessionReqTag:tr},tr.callback)},qe.getServerSession=function(tr){(tr=tr||{}).done=nr({instance:this,className:"NIMFn",funcName:"getServerSession",done:tr.done}),jt.verifyOptions(tr,"scene to","scene::getServerSession"),jt.verifyParamValid("scene",tr.scene,this.message.validScenes,"scene::getServerSession"),jt.verifyParamType("to",tr.to,"string","to::getServerSession");var ur=tr.scene+"|"+tr.to;tr.scene==="superTeam"&&(ur="super_team|"+tr.to),this.processCallback(tr),this.sendCmd("getServerSession",{session:{id:ur}},tr.callback)},qe.updateServerSession=function(tr){(tr=tr||{}).done=nr({instance:this,className:"NIMFn",funcName:"updateServerSession",done:tr.done}),jt.verifyOptions(tr,"scene to","scene::updateServerSession"),jt.verifyParamValid("scene",tr.scene,this.message.validScenes,"scene::updateServerSession"),jt.verifyParamType("to",tr.to,"string","to::updateServerSession"),Et(tr.extra)&&jt.verifyParamType("extra",tr.extra,"string","extra::updateServerSession");var ur=tr.scene+"|"+tr.to;tr.scene==="superTeam"&&(ur="super_team|"+tr.to),this.processCallback(tr),this.sendCmd("updateServerSession",{session:{id:ur,ext:tr.extra||""}},tr.callback)},qe.deleteServerSessions=function(tr){var ur,or=this;(tr=tr||{}).done=nr({instance:this,className:"NIMFn",funcName:"deleteServerSessions",done:tr.done}),jt.verifyOptions(tr,"sessions","scene::deleteServerSessions"),jt.verifyParamType("sessions",tr.sessions,"array","sessions::deleteServerSessions");var fr=[];i(ur=tr.sessions).call(ur,function(lr){jt.verifyParamValid("scene",lr.scene,or.message.validScenes,"scene::deleteServerSessions"),jt.verifyParamType("to",lr.to,"string","to::deleteServerSessions");var gr=lr.scene+"|"+lr.to;lr.scene==="superTeam"&&(gr="super_team|"+lr.to),fr.push({id:gr})}),this.processCallback(tr),this.sendCmd("deleteServerSessions",{sessions:fr},tr.callback)},qe.updateSessionsWithMoreRoaming=function(tr){var ur;if((tr=tr||{}).done=nr({instance:this,className:"NIMFn",funcName:"updateSessionsWithMoreRoaming",done:tr.done}),jt.verifyOptions(tr,"msg","session::updateSessionsWithMoreRoaming"),jt.verifyCallback(tr,"done","session::updateSessionsWithMoreRoaming"),!this.db.enable)return tr.done(null,"db is disable");var or={time:tr.msg.time,idServer:tr.msg.idServer,to:tr.msg.to,from:tr.msg.from};jt.verifyParamType("msg.time",tr.msg.time,"number","time::updateSessionsWithMoreRoaming"),jt.verifyParamType("msg.idServer",tr.msg.idServer,"string","idServer::updateSessionsWithMoreRoaming"),jt.verifyParamType("msg.from",tr.msg.from,"string","from::updateSessionsWithMoreRoaming"),jt.verifyParamType("msg.to",tr.msg.to,"string","to::updateSessionsWithMoreRoaming"),jt.verifyParamValid("scene",tr.msg.scene,this.message.validScenes,"scene::updateSessionsWithMoreRoaming");var fr=or.to===this.account?or.from:or.to;or.id=k(ur="".concat(tr.msg.scene,"-")).call(ur,fr),this.db.updateSessionsWithMoreRoaming(or).then(function(lr){tr.done(null,lr)}).catch(function(lr){tr.done(lr)})},qe.deleteSessionsWithMoreRoaming=function(tr){if((tr=tr||{}).done=nr({instance:this,className:"NIMFn",funcName:"deleteSessionsWithMoreRoaming",done:tr.done}),jt.verifyOptions(tr,"id","session::deleteSessionsWithMoreRoaming"),jt.verifyCallback(tr,"done","session::deleteSessionsWithMoreRoaming"),!this.db.enable)return tr.done(null,"db is disable");this.db.deleteSessionsWithMoreRoaming(tr.id).then(function(ur){tr.done(null,ur)}).catch(function(ur){tr.done(ur)})},qe.getSessionsWithMoreRoaming=function(tr){if((tr=tr||{}).done=nr({instance:this,className:"NIMFn",funcName:"getSessionsWithMoreRoaming",done:tr.done}),jt.verifyCallback(tr,"done","session::getSessionsWithMoreRoaming"),!this.db.enable)return tr.done(null,"db is disable");this.db.getSessionsWithMoreRoaming(tr.id).then(function(ur){tr.done(null,ur)}).catch(function(ur){tr.done(ur)})}},function(t,r,e){var n=e(877),g=e(878),y=e(879),i=Math.ceil,k=Math.max;t.exports=function(L,$,V){$=(V?g(L,$,V):$===void 0)?1:k(y($),0);var z=L==null?0:L.length;if(!z||$<1)return[];for(var re=0,oe=0,le=Array(i(z/$));re<z;)le[oe++]=n(L,re,re+=$);return le}},function(t,r){t.exports=function(e,n,g){var y=-1,i=e.length;n<0&&(n=-n>i?0:i+n),(g=g>i?i:g)<0&&(g+=i),i=n>g?0:g-n>>>0,n>>>=0;for(var k=Array(i);++y<i;)k[y]=e[y+n];return k}},function(t,r,e){var n=e(204),g=e(205),y=e(306),i=e(94);t.exports=function(k,L,$){if(!i($))return!1;var V=typeof L;return!!(V=="number"?g($)&&y(L,$.length):V=="string"&&L in $)&&n($[L],k)}},function(t,r,e){var n=e(880);t.exports=function(g){var y=n(g),i=y%1;return y==y?i?y-i:y:0}},function(t,r,e){var n=e(881);t.exports=function(g){return g?(g=n(g))===1/0||g===-1/0?17976931348623157e292*(g<0?-1:1):g==g?g:0:g===0?g:0}},function(t,r,e){var n=e(882),g=e(94),y=e(884),i=/^[-+]0x[0-9a-f]+$/i,k=/^0b[01]+$/i,L=/^0o[0-7]+$/i,$=parseInt;t.exports=function(V){if(typeof V=="number")return V;if(y(V))return NaN;if(g(V)){var z=typeof V.valueOf=="function"?V.valueOf():V;V=g(z)?z+"":z}if(typeof V!="string")return V===0?V:+V;V=n(V);var re=k.test(V);return re||L.test(V)?$(V.slice(2),re?2:8):i.test(V)?NaN:+V}},function(t,r,e){var n=e(883),g=/^\s+/;t.exports=function(y){return y&&y.slice(0,n(y)+1).replace(g,"")}},function(t,r){var e=/\s/;t.exports=function(n){for(var g=n.length;g--&&e.test(n.charAt(g)););return g}},function(t,r,e){var n=e(126),g=e(108);t.exports=function(y){return typeof y=="symbol"||g(y)&&n(y)=="[object Symbol]"}},function(t,r,e){var n=e(127),g=e(886),y=e(887),i=e(60),k=e(61),L=e(51),$=e(15),V=e(9),z=e(2),re=e(28),oe=e(121),le=e(11),ue=e(4),ie=e(6),ae=e(10),Ie=e(892),de=e(5),Ce=e(52),Ue=e(53),qe=e(54),jt=e(55),Fe=e(42),Et=["callback","done"];function cr(mr,Ir){var Nr=de(mr);if(Ce){var Er=Ce(mr);Ir&&(Er=$(Er).call(Er,function(sr){return Ue(mr,sr).enumerable})),Nr.push.apply(Nr,Er)}return Nr}function er(mr){for(var Ir=1;Ir<arguments.length;Ir++){var Nr,Er,sr=arguments[Ir]!=null?arguments[Ir]:{};Ir%2?z(Nr=cr(Object(sr),!0)).call(Nr,function(xr){L(mr,xr,sr[xr])}):qe?jt(mr,qe(sr)):z(Er=cr(Object(sr))).call(Er,function(xr){Fe(mr,xr,Ue(sr,xr))})}return mr}var nr=e(41).fn,dr=e(0),ir=dr.undef,tr=dr.notundef,ur=e(48),or=e(162),fr=e(161),lr=e(35),gr=e(80),Sr=e(26).reportAPI,wr=e(12);nr.sendG2Msg=function(mr){return(mr=mr||{}).done=Sr({instance:this,className:"NIMFn",funcName:"sendG2Msg",done:mr.done}),this.processCallback(mr),mr.msg=new this.message.G2Message(mr),this.sendMsg(mr)},nr.beforeSendMsg=function(mr){var Ir,Nr=this.protocol,Er=mr.msg;switch(Er.to===this.account&&(Er.fromDeviceId=ur.deviceId),Er.userUpdateTime=Nr.myInfo&&Nr.myInfo.updateTime,Er.getScene()){case"p2p":Ir="sendMsg";break;case"team":Ir="sendTeamMsg";break;case"superTeam":Ir="sendSuperTeamMsg"}$(mr)&&(Ir="sendFilterMsg",Er.filter=!0),mr.cmd=Ir},nr.afterSendMsg=function(mr){var Ir=mr.rtnMsg;if(!Ir||!Ir.ignore){var Nr=this.protocol.getSessionInCache(Ir.sessionId);mr.isLocal&&Nr&&Nr.lastMsg&&Ir.time<Nr.lastMsg.time||this.protocol.onUpdateSession(or.genSessionByMsg(Ir))}},nr.beforeForwardMsg=function(mr){dr.verifyOptions(mr,"msg scene to","msg::beforeForwardMsg"),mr.msg.scene=mr.scene,mr.msg.to=mr.to},nr.markMsgRead=function(mr){var Ir=this.protocol;!mr||this.db.enable||Ir.options.autoMarkRead?this.logger.warn("api::markMsgRead: 不需要标记消息为已收到 (没有消息, 或者启用了数据库, 或者启用了自动标记已收到)"):Ir.markMsgRead(mr,!0)},nr.sendMsgReceipt=function(mr){if((mr=mr||{}).done=Sr({instance:this,className:"NIMFn",funcName:"sendMsgReceipt",done:mr.done}),dr.verifyOptions(mr),this.processCallback(mr),mr.msg){dr.verifyOptions(mr,"msg","msg::sendMsgReceipt");var Ir=mr.msg;dr.verifyOptions(Ir,"target idClient time",!0,"msg.","msg::sendMsgReceipt"),this.protocol.shouldSendMsgReceipt(Ir)?this.sendCmd("sendMsgReceipt",{msgReceipt:{to:Ir.target,idClient:Ir.idClient,time:Ir.time}},mr.callback):mr.done()}else mr.done()},nr.isMsgRemoteRead=function(mr){return Sr({instance:this,className:"NIMFn",funcName:"isMsgRemoteRead",hasCallback:!1}),this.protocol.isMsgRemoteRead(mr)},nr.recallMsg=function(mr){(mr=mr||{}).done=Sr({instance:this,className:"NIMFn",funcName:"recallMsg",done:mr.done}),this.deleteMsg(mr,!0)},nr.deleteMsg=function(mr,Ir){var Nr;(mr=mr||{}).done=Sr({instance:this,className:"NIMFn",funcName:"deleteMsg",done:mr.done}),Ir||this.logger.warn("this api will be abandon,please use “recallMsg”"),dr.verifyOptions(mr,"msg","msg::deleteMsg");var Er=mr.msg;if(Er.scene!=="team"&&Er.from!==this.account||Er.status!=="success"||Er.isLocal)return mr.done(lr.newParamError("只能删除自己发的, 并且发送成功的消息，且不能是本地消息",{callFunc:"msg::deleteMsg"}),mr);dr.verifyOptions(Er,["scene","to","from","time","idClient","idServer"],!0,"msg.","msg::deleteMsg"),dr.verifyParamValid("msg.scene",Er.scene,this.message.validScenes,"msg::deleteMsg"),this.processPs(mr),this.processCallback(mr);var sr={deletedIdClient:Er.idClient,deletedIdServer:Er.idServer,time:Er.time,from:Er.from,to:Er.to,opeAccount:Er.from},xr=Er.scene==="superTeam"?"deleteSuperTeamMsg":"deleteMsg";sr.type="deleteMsg"+Er.scene[0].toUpperCase()+V(Nr=Er.scene).call(Nr,1);var Or=["ps","apnsText","pushPayload","env","opeAccount","attach"];z(Or).call(Or,function(Mr){mr[Mr]&&(sr[Mr]=mr[Mr])}),sr=new fr(sr),this.sendCmd(xr,{sysMsg:sr,msg:Er},mr.callback)},nr.deleteMsgSelf=function(mr){(mr=mr||{}).done=Sr({instance:this,className:"NIMFn",funcName:"deleteMsgSelf",done:mr.done}),dr.verifyOptions(mr,"msg","msg::deleteMsgSelf");var Ir=mr.msg;if(Ir.scene==="superTeam")return mr.done(lr.newParamError("单向删除暂不支持超大群场景",{callFunc:"msg::deleteMsgSelf"}),mr);dr.verifyOptions(Ir,["scene","to","from","time","idClient","idServer"],!0,"msg.","msg::deleteMsgSelf"),dr.verifyParamValid("msg.scene",Ir.scene,this.message.validScenes,"msg::deleteMsgSelf"),this.processCallback(mr);var Nr={scene:Ir.scene==="p2p"?1:2,from:Ir.from,to:Ir.to,time:Ir.time,idClient:Ir.idClient,idServer:Ir.idServer,custom:mr.custom,type:Ir.type};this.sendCmd("deleteMsgSelf",{deleteMsgSelfTag:Nr},mr.callback)},nr.deleteMsgSelfBatch=function(mr){var Ir,Nr,Er,sr=this;if((mr=mr||{}).done=Sr({instance:this,className:"NIMFn",funcName:"deleteMsgSelfBatch",done:mr.done}),dr.verifyOptions(mr,"msgs","msg::deleteMsgSelfBatch"),(!re(mr.msgs)||mr.msgs.length===0||mr.msgs.length>100)&&dr.onParamError("msgs应该是数组且数据长度应大于0小于等于100","msg::deleteMsgSelfBatch"),oe(Ir=mr.msgs).call(Ir,function(Or){return Or.scene==="superTeam"}))return mr.done(lr.newParamError("消息列表中存在超大群消息，单向删除暂不支持超大群场景",{callFunc:"msg::deleteMsgSelfBatch"}),mr);z(Nr=mr.msgs).call(Nr,function(Or){dr.verifyOptions(Or,["scene","to","from","time","idClient","idServer"],!0,"msg.","msg::deleteMsgSelfBatch"),dr.verifyParamValid("msg.scene",Or.scene,sr.message.validScenes,"msg::deleteMsgSelfBatch")}),this.processCallback(mr);var xr=le(Er=mr.msgs).call(Er,function(Or){var Mr;return{scene:Or.scene==="p2p"?1:2,from:Or.from,to:Or.to,time:Or.time,idClient:Or.idClient,idServer:Or.idServer,sessionId:Or.sessionId||ue(Mr="".concat(Or.scene,"-")).call(Mr,Or.to),custom:mr.custom?typeof mr.custom=="string"?mr.custom:ie(mr.custom):void 0,type:Or.type}});this.sendCmd("deleteMsgSelfBatch",{deleteMsgSelfTags:xr},mr.callback)};var kr={text:0,image:1,audio:2,video:3,geo:4,notification:5,file:6,tip:10,robot:11,custom:100};nr.getHistoryMsgs=function(mr){(mr=mr||{}).done=Sr({instance:this,className:"NIMFn",funcName:"getHistoryMsgs",done:mr.done}),this.protocol.syncing&&this.logger.warn("Please call getHistoryMsgs after onsyncdone callback"),dr.verifyOptions(mr,"scene to","msg::getHistoryMsgs"),dr.verifyParamValid("scene",mr.scene,this.message.validScenes,"msg::getHistoryMsgs"),mr.beginTime===void 0&&(mr.beginTime=0);var Ir,Nr=this.protocol.getSessionInCache(mr.scene+"-"+mr.to),Er=Nr&&Nr.lastEmptyTime;if(Er>mr.beginTime&&(mr.beginTime=Er),dr.verifyParamType("beginTime",mr.beginTime,"number","msg::getHistoryMsgs"),mr.endTime===void 0&&(mr.endTime=0),dr.verifyParamType("endTime",mr.endTime,"number","msg::getHistoryMsgs"),mr.lastMsgId=mr.lastMsgId&&+mr.lastMsgId?mr.lastMsgId:"0",mr.limit===void 0&&(mr.limit=100),dr.verifyParamType("limit",mr.limit,"number","msg::getHistoryMsgs"),dr.verifyParamMax("limit",mr.limit,100,"msg::getHistoryMsgs"),tr(ae(mr))?dr.verifyParamType("reverse",ae(mr),"boolean","msg::getHistoryMsgs"):mr.reverse=!1,tr(mr.asc)?dr.verifyParamType("asc",mr.asc,"boolean","msg::getHistoryMsgs"):mr.asc=!1,ir(mr.msgTypes))mr.msgTypes=[];else if(re(mr.msgTypes)){var sr,xr;mr.msgTypes=le(sr=mr.msgTypes).call(sr,function(Mr){return kr[Mr]}),mr.msgTypes=$(xr=mr.msgTypes).call(xr,function(Mr){return typeof Mr=="number"})}else typeof kr[mr.msgTypes]=="number"?mr.msgTypes=[kr[mr.msgTypes]]:mr.msgTypes=[];switch(this.processCallback(mr),mr.cbaop=function(Mr,br){if(!Mr){var hr;mr.asc&&(br.msgs=ae(hr=br.msgs).call(hr)),br.msgs=gr.deduplication(br.msgs)}},mr.scene){case"p2p":Ir="getHistoryMsgs";break;case"team":Ir="getTeamHistoryMsgs";break;case"superTeam":Ir="getSuperTeamHistoryMsgs"}var Or={scene:mr.scene,to:mr.to,beginTime:mr.beginTime,endTime:mr.endTime,lastMsgId:mr.lastMsgId,limit:mr.limit,reverse:ae(mr),msgTypes:mr.msgTypes};this.sendCmd(Ir,Or,mr.callback)},nr.searchHistoryMsgs=function(mr){(mr=mr||{}).done=Sr({instance:this,className:"NIMFn",funcName:"searchHistoryMsgs",done:mr.done}),dr.verifyOptions(mr,"scene to keyword","msg::searchHistoryMsgs"),dr.verifyParamValid("scene",mr.scene,this.message.validScenes,"msg::searchHistoryMsgs"),mr.beginTime===void 0&&(mr.beginTime=0);var Ir,Nr=this.protocol.getSessionInCache(mr.scene+"-"+mr.to),Er=Nr&&Nr.lastEmptyTime;switch(Er>mr.beginTime&&(mr.beginTime=Er),dr.verifyParamType("beginTime",mr.beginTime,"number","msg::searchHistoryMsgs"),mr.endTime===void 0&&(mr.endTime=0),dr.verifyParamType("endTime",mr.endTime,"number","msg::searchHistoryMsgs"),mr.limit===void 0&&(mr.limit=100),dr.verifyParamType("limit",mr.limit,"number","msg::searchHistoryMsgs"),dr.verifyParamMax("limit",mr.limit,100,"msg::searchHistoryMsgs"),tr(ae(mr))?dr.verifyParamType("reverse",ae(mr),"boolean","msg::searchHistoryMsgs"):mr.reverse=!1,tr(mr.asc)?dr.verifyParamType("asc",mr.asc,"boolean","msg::searchHistoryMsgs"):mr.asc=!1,this.processCallback(mr),mr.asc&&(mr.cbaop=function(xr,Or){var Mr;xr||(Or.msgs=ae(Mr=Or.msgs).call(Mr))}),mr.scene){case"p2p":Ir="searchHistoryMsgs";break;case"team":Ir="searchTeamHistoryMsgs"}var sr=dr.filterObj(mr,"scene to beginTime endTime keyword limit reverse");this.sendCmd(Ir,sr,mr.callback)},nr.getLocalMsgs=function(mr){(mr=mr||{}).done=Sr({instance:this,className:"NIMFn",funcName:"getLocalMsgs",done:mr.done});var Ir=this,Nr=Ir.db,Er=[];dr.verifyOptions(mr);var sr=!1;tr(mr.start)&&(sr=!0,dr.verifyParamType("start",mr.start,"number","msg::getLocalMsgs"));var xr=!1;if(tr(mr.end)&&(xr=!0,dr.verifyParamType("end",mr.end,"number","msg::getLocalMsgs")),sr&&xr&&mr.end<=mr.start&&dr.onParamError("参数 end 必须晚于 start"),tr(mr.subTypes)&&dr.verifyParamType("subTypes",mr.subTypes,"array","msg::getLocalMsgs"),ir(mr.limit)&&(mr.limit=100),dr.verifyParamType("limit",mr.limit,"number","msg::getLocalMsgs"),dr.verifyParamMin("limit",mr.limit,1,"msg::getLocalMsgs"),Ir.processCallback(mr),Nr.enable){var Or=new Date().getTime();Nr.getMsgs(mr).then(function(br){var hr;Er=br,Ir.logger.info(ue(hr="api::getLocalMsgs: query db cost ".concat(new Date().getTime()-Or," ms and the conditions is ")).call(hr,ie(mr))),Mr()},function(br){(br=br||{}).message=br.message||"msg::getLocalMsgs:db error",Mr()})}else Mr();function Mr(){var br=dr.simpleClone(mr);br.msgs=Er,delete br.callback,delete br.done,mr.done(null,br)}},nr.getLocalMsgsInUnread=function(mr){(mr=mr||{}).done=Sr({instance:this,className:"NIMFn",funcName:"getLocalMsgsInUnread",done:mr.done});var Ir=this;dr.validate({sessionId:{type:"string",allowEmpty:!1}},mr),this.getLocalSession({sessionId:mr.sessionId,done:function(Nr,Er){Nr?mr.done&&mr.done(Nr):Er?(Er.ack=Er.ack||0,Ir.getLocalMsgs(er({sessionId:mr.sessionId,start:Er.ack,limit:Ie,filterFunc:function(sr){return sr.flow==="in"&&sr.isUnreadable===!0},done:function(){}},mr))):mr.done&&mr.done(new Error("session ".concat(mr.sessionId," not exist")))}})},nr.getLocalMsgByIdClient=function(mr){(mr=mr||{}).done=Sr({instance:this,className:"NIMFn",funcName:"getLocalMsgByIdClient",done:mr.done});var Ir=this.db,Nr=null,Er=null;function sr(){mr.msg=Er,mr.done(Nr,mr)}dr.verifyOptions(mr,"idClient","msg::getLocalMsgByIdClient"),this.processCallback(mr),Ir.enable?Ir.getMsgByIdClient(mr.idClient).then(function(xr){xr&&(Er=xr),sr()},function(xr){Nr=xr,sr()}):(this.logger.warn("because db is false,error is null"),sr())},nr.getLocalMsgsByIdClients=function(mr){(mr=mr||{}).done=Sr({instance:this,className:"NIMFn",funcName:"getLocalMsgsByIdClients",done:mr.done});var Ir,Nr=this.db,Er=[];function sr(){mr.msgs=Er,mr.done(Ir,mr)}dr.verifyOptions(mr,"idClients","msg::getLocalMsgByIdClients"),dr.verifyParamType("idClients",mr.idClients,"array","msg::getLocalMsgByIdClients"),this.processCallback(mr),Nr.enable?Nr.getMsgsByIdClients(mr.idClients).then(function(xr){Er=$(xr).call(xr,function(Or){return!!Or}),sr()},function(xr){Ir=xr,sr()}):sr()},nr.updateLocalMsg=function(mr){(mr=mr||{}).done=Sr({instance:this,className:"NIMFn",funcName:"updateLocalMsg",done:mr.done});var Ir,Nr=this.db,Er=null;if(dr.verifyOptions(mr,"idClient","msg::updateLocalMsg"),this.processCallback(mr),Nr.enable){var sr=dr.filterObj(mr,"idClient localCustom");Nr.updateMsg(sr).then(function(Or){Er=Or,xr()},function(Or){Ir=Or,xr()})}else xr();function xr(){mr.msg=Er,mr.done(Ir,mr)}},nr.deleteLocalMsg=function(){var mr=k(i.mark(function Ir(Nr){var Er,sr,xr,Or;return i.wrap(function(Mr){for(;;)switch(Mr.prev=Mr.next){case 0:return Or=function(){Nr.done(sr,Nr)},(Nr=Nr||{}).done=Sr({instance:this,className:"NIMFn",funcName:"deleteLocalMsg",done:Nr.done}),Er=this,dr.verifyOptions(Nr,"msg","msg::deleteLocalMsg"),xr=Nr.msg,dr.verifyOptions(xr,"idClient sessionId",!0,"msg.","msg::deleteLocalMsg"),Er.processCallback(Nr),Mr.prev=8,Mr.next=11,Er.protocol.deleteLocalMsg(xr);case 11:Or(),Mr.next=18;break;case 14:Mr.prev=14,Mr.t0=Mr.catch(8),sr=Mr.t0,Or();case 18:case"end":return Mr.stop()}},Ir,this,[[8,14]])}));return function(Ir){return mr.apply(this,arguments)}}(),nr.deleteLocalMsgsBySession=function(mr){(mr=mr||{}).done=Sr({instance:this,className:"NIMFn",funcName:"deleteLocalMsgsBySession",done:mr.done});var Ir,Nr=this,Er=Nr.db;dr.verifyOptions(mr,"scene to","msg::deleteLocalMsgsBySession"),dr.verifyParamValid("scene",mr.scene,Nr.message.validScenes,"msg::deleteLocalMsgsBySession"),mr.sessionId=mr.scene+"-"+mr.to,mr.delLastMsg=mr.delLastMsg===!0,mr.isTag=mr.isTag===!0;var sr=new Date().getTime();function xr(){mr.done(Ir,mr)}Nr.processCallback(mr);var Or={id:mr.sessionId};mr.delLastMsg&&(Or.lastMsg=null),mr.isTag&&(Or.lastEmptyTime=sr),Er.enable?Er.deleteMsgsBySessionId(mr).then(function(){mr.delLastMsg||mr.isTag?Er.updateSession(Or).then(function(Mr){Nr.protocol.onUpdateSession(Mr),mr.session=Mr,xr()}):xr()}).catch(function(Mr){Ir=Mr,xr()}):(this.logger.warn("because db is false,error is null"),xr(),(mr.delLastMsg||mr.isTag)&&Nr.protocol.onUpdateSession(Or))},nr.deleteLocalMsgsByTime=function(mr){var Ir=this.db;wr.isBrowser&&Ir.enable&&(tr((mr=mr||{}).start)?dr.verifyParamType("start",mr.start,"number","msg::deleteLocalMsgsByTime"):mr.start=0,tr(mr.end)?dr.verifyParamType("end",mr.end,"number","msg::deleteLocalMsgsByTime"):mr.end=1/0,tr(mr.end)&&tr(mr.start)&&mr.end<=mr.start&&dr.onParamError("参数 end 必须大于 start"),this.processCallback(mr),this.protocol.deleteLocalMsgsByTime(mr).then(function(Nr){mr.done(null,Nr)},function(Nr){mr.done(Nr,null)}))},nr.deleteLocalMsgs=function(mr){(mr=mr||{}).done=Sr({instance:this,className:"NIMFn",funcName:"deleteLocalMsgs",done:mr.done});var Ir;function Nr(){mr.done(Ir,mr)}mr.updateSession=mr.updateSession!==!1,dr.verifyOptions(mr,"sessionId","msg::deleteLocalMsgsBySession"),tr(mr.start)&&dr.verifyParamType("start",mr.start,"number","msg::deleteLocalMsgs"),tr(mr.end)&&dr.verifyParamType("end",mr.end,"number","msg::deleteLocalMsgs"),tr(mr.end)&&tr(mr.start)&&mr.end<=mr.start&&dr.onParamError("参数 end 必须大于 start"),this.processCallback(mr),this.protocol.deleteLocalMsgs(mr).then(function(){Nr()},function(Er){Ir=Er,Nr()})},nr.deleteAllLocalMsgs=function(mr){(mr=mr||{}).done=Sr({instance:this,className:"NIMFn",funcName:"deleteAllLocalMsgs",done:mr.done});var Ir,Nr=this.db;function Er(){mr.done(Ir,mr)}this.processCallback(mr),this.protocol.sessionSet={},Nr.enable?Nr.deleteAllMsgs().then(function(){Er()},function(sr){Ir=sr,Er()}):(this.logger.warn("because db is false,error is null"),Er())},nr.saveMsgsToLocal=function(mr){var Ir;(mr=mr||{}).done=Sr({instance:this,className:"NIMFn",funcName:"saveMsgsToLocal",done:mr.done}),this.db.enable||(this.logger.warn("because db is false,error is null"),mr.done(null,[])),dr.verifyOptions(mr,"msgs done","msg::saveMsgsToLocal"),dr.verifyParamType("msgs",mr.msgs,"Array","msg::saveMsgsToLocal");var Nr=le(Ir=mr.msgs).call(Ir,function(Er){var sr=er({},Er);return sr.hasOwnProperty("needUpdateSession")||(sr.needUpdateSession=!0),sr});this.db.putMsg(Nr).then(function(Er,sr){sr?mr.done(sr):mr.done(null,Er)})},nr.clearServerHistoryMsgs=function(mr){(mr=mr||{}).done=Sr({instance:this,className:"NIMFn",funcName:"clearServerHistoryMsgs",done:mr.done}),dr.verifyOptions(mr,"account","msg::clearServerHistoryMsgs");var Ir=mr.delRoam!==!1;this.processCallback(mr),this.sendCmd("clearServerHistoryMsgs",{clearMsgsParams:{account:mr.account,delRoam:Ir?1:0}},mr.callback)},nr.clearServerHistoryMsgsWithSync=function(mr){(mr=mr||{}).done=Sr({instance:this,className:"NIMFn",funcName:"clearServerHistoryMsgsWithSync",done:mr.done}),dr.verifyOptions(mr,"scene to","msg::clearServerHistoryMsgsWithSync");var Ir=mr.isDeleteRoam===void 0||mr.isDeleteRoam===!0,Nr={type:mr.scene==="team"?2:1,isDeleteRoam:Ir?1:0,isSyncSelf:mr.isSyncSelf===!0?1:0};Nr[Nr.type===2?"toTid":"otherAccid"]=mr.to,mr.ext!==void 0&&(Nr.ext=mr.ext),this.processCallback(mr),this.sendCmd("clearServerHistoryMsgsWithSync",{clearMsgsParamsWithSync:Nr},mr.callback)},nr.msgFtsInServer=function(mr){(mr=mr||{}).done=Sr({instance:this,className:"NIMFn",funcName:"msgFtsInServer",done:mr.done}),this.processCallback(mr);var Ir=mr,Nr=y({},(g(Ir),Ir));dr.validate({keyword:{type:"string"},fromTime:{type:"number",required:!1},toTime:{type:"number",required:!1},sessionLimit:{type:"number",min:0,required:!1},msgLimit:{type:"number",min:0,required:!1},order:{type:"enum",values:["ASC","DESC"],required:!1},p2pList:{type:"array",required:!1},teamList:{type:"array",required:!1},senderList:{type:"array",required:!1},msgTypeList:{type:"array",required:!1},msgSubTypeList:{type:"array",required:!1}},Nr,"msg::msgFtsInServer"),tr(Nr.toTime)&&tr(Nr.fromTime)&&Nr.toTime<Nr.fromTime&&dr.onParamError("Options error: toTime should be greater than fromTime");var Er,sr={ASC:1,DESC:2};Nr.order&&sr[Nr.order]&&(Nr.order=sr[Nr.order]),Nr.msgTypeList&&(Nr.msgTypeList=le(Er=Nr.msgTypeList).call(Er,function(Or){return kr[Or]}));var xr=["p2pList","teamList","senderList","msgTypeList","msgSubTypeList"];z(xr).call(xr,function(Or){re(Nr[Or])&&(Nr[Or]=Nr[Or].join(","))}),this.sendCmd("msgFtsInServer",{msgFullSearchRequestTag:Nr},mr.callback)},nr.msgFtsInServerByTiming=function(mr){(mr=mr||{}).done=Sr({instance:this,className:"NIMFn",funcName:"msgFtsInServerByTiming",done:mr.done}),this.processCallback(mr);var Ir=mr,Nr=(Ir.callback,Ir.done,n(Ir,Et));dr.validate({keyword:{type:"string"},fromTime:{type:"number",required:!1},toTime:{type:"number",required:!1},msgLimit:{type:"number",min:0,required:!1},order:{type:"enum",values:["ASC","DESC"],required:!1},p2pList:{type:"array",required:!1},teamList:{type:"array",required:!1},senderList:{type:"array",required:!1},msgTypeList:{type:"array",required:!1},msgSubTypeList:{type:"array",required:!1}},Nr,"msg::msgFtsInServerByTimeSort"),tr(Nr.toTime)&&tr(Nr.fromTime)&&Nr.toTime<Nr.fromTime&&dr.onParamError("Options error: toTime should be greater than fromTime");var Er,sr={ASC:1,DESC:2};Nr.msgLimit===void 0&&(Nr.msgLimit=20),Nr.order&&sr[Nr.order]&&(Nr.order=sr[Nr.order]),Nr.msgTypeList&&(Nr.msgTypeList=le(Er=Nr.msgTypeList).call(Er,function(Or){return kr[Or]}));var xr=["p2pList","teamList","senderList","msgTypeList","msgSubTypeList"];z(xr).call(xr,function(Or){re(Nr[Or])&&(Nr[Or]=Nr[Or].join(","))}),this.sendCmd("msgFtsInServerByTiming",{msgTimingFullSearchRequestTag:Nr},mr.callback)}},function(t,r){t.exports=function(e){if(e==null)throw new TypeError("Cannot destructure "+e)},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,r,e){var n=e(888),g=e(159);function y(){var i;return t.exports=y=n?g(i=n).call(i):function(k){for(var L=1;L<arguments.length;L++){var $=arguments[L];for(var V in $)Object.prototype.hasOwnProperty.call($,V)&&(k[V]=$[V])}return k},t.exports.__esModule=!0,t.exports.default=t.exports,y.apply(this,arguments)}t.exports=y,t.exports.__esModule=!0,t.exports.default=t.exports},function(t,r,e){t.exports=e(889)},function(t,r,e){t.exports=e(890)},function(t,r,e){var n=e(891);t.exports=n},function(t,r,e){var n=e(309);t.exports=n},function(t,r,e){t.exports=e(893)},function(t,r,e){var n=e(894);t.exports=n},function(t,r,e){e(895),t.exports=9007199254740991},function(t,r,e){e(1)({target:"Number",stat:!0,nonConfigurable:!0,nonWritable:!0},{MAX_SAFE_INTEGER:9007199254740991})},function(t,r,e){var n=e(10),g=e(28),y=e(9),i=e(2),k=e(6),L=e(5),$=e(15),V=e(41).fn,z=e(0),re=e(784),oe=e(786),le=(e(80),z.notundef),ue=e(26).reportAPI;function ie(ae,Ie,de,Ce){de=de||"",z.verifyParamType(de+"from",ae.from,"string",Ie),z.verifyParamType(de+"to",ae.to,"string",Ie),z.verifyParamType(de+"idServer",ae.idServer,"string",Ie),z.verifyParamType(de+"time",ae.time,"number",Ie),z.verifyParamValid(de+"scene",ae.scene,this.message.validScenes,Ie),Ce||z.verifyParamType(de+"idClient",ae.idClient,"string",Ie)}V.getThreadMsgs=function(ae){(ae=ae||{}).done=ue({instance:this,className:"NIMFn",funcName:"getThreadMsgs",done:ae.done}),z.verifyCallback(ae,"done","msg::getThreadMsgs"),z.verifyOptions(ae,"scene threadMsgFromAccount threadMsgToAccount threadMsgIdServer threadMsgTime","msg::getThreadMsgs"),z.verifyParamType("threadMsgFromAccount",ae.threadMsgFromAccount,"string","msg::getThreadMsgs"),z.verifyParamType("threadMsgToAccount",ae.threadMsgToAccount,"string","msg::getThreadMsgs"),z.verifyParamType("threadMsgIdServer",ae.threadMsgIdServer,"string","msg::getThreadMsgs"),z.verifyParamType("threadMsgTime",ae.threadMsgTime,"number","msg::getThreadMsgs"),z.verifyParamValid("scene",ae.scene,this.message.validScenes,"msg::getThreadMsgs"),this.processCallback(ae);var Ie={scene:this.message.sceneMap[ae.scene],from:ae.threadMsgFromAccount,to:ae.threadMsgToAccount,time:ae.threadMsgTime,idServer:ae.threadMsgIdServer},de={limit:ae.limit<100?ae.limit:100,beginTime:typeof ae.beginTime=="number"?ae.beginTime:0,reverse:n(ae)===!0?1:0};typeof ae.endTime=="number"&&(de.endTime=ae.endTime,de.endTime<=de.beginTime&&z.onParamError("endTime应该大于beginTime","msg::getThreadMsgs")),ae.lastMsgId&&(de.lastMsgId=ae.lastMsgId),this.sendCmd("getThreadMsgs",{msg:Ie,threadMsgReq:de,NOTSTORE:"msg threadMsgReq"},ae.callback)},V.getMsgsByIdServer=function(ae){var Ie,de,Ce=this;(ae=ae||{}).done=ue({instance:this,className:"NIMFn",funcName:"getMsgsByIdServer",done:ae.done});var Ue=this,qe="msg::getMsgsByIdServer";z.verifyCallback(ae,"done",qe),(!g(ae.reqMsgs)||ae.reqMsgs.length===0||ae.reqMsgs.length>100)&&z.onParamError("reqMsgs应该是数组且数据长度应大于0小于等于100",qe),ae.reqMsgs=y(Ie=ae.reqMsgs).call(Ie,0),i(de=ae.reqMsgs).call(de,function(jt,Fe){ie.call(Ue,jt,qe,"reqMsgs[".concat(Fe,"]."),!0),jt.scene=Ce.message.sceneMap[jt.scene]}),this.processCallback(ae),this.sendCmd("getMsgsByIdServer",{reqMsgs:ae.reqMsgs},ae.callback)},V.addQuickComment=function(ae){(ae=ae||{}).done=ue({instance:this,className:"NIMFn",funcName:"addQuickComment",done:ae.done}),z.verifyOptions(ae,"msg body","msg::addQuickComment"),ie.call(this,ae.msg,"msg::addQuickComment");var Ie=new re(ae,"msg::addQuickComment");Ie.from=this.account;var de={scene:this.message.sceneMap[ae.msg.scene],from:ae.msg.from,to:ae.msg.to,time:ae.msg.time,idServer:ae.msg.idServer,idClient:ae.msg.idClient};this.processCallback(ae),this.sendCmd("addQuickComment",{msg:de,comment:Ie},ae.callback)},V.deleteQuickComment=function(ae){(ae=ae||{}).done=ue({instance:this,className:"NIMFn",funcName:"deleteQuickComment",done:ae.done}),z.verifyOptions(ae,"msg body","msg::deleteQuickComment"),ie.call(this,ae.msg,"msg::deleteQuickComment");var Ie=new re(ae,"msg::addQuickComment");Ie.from=this.account;var de={scene:this.message.sceneMap[ae.msg.scene],from:ae.msg.from,to:ae.msg.to,time:ae.msg.time,idServer:ae.msg.idServer,idClient:ae.msg.idClient};this.processCallback(ae),this.sendCmd("deleteQuickComment",{msg:de,comment:Ie},ae.callback)},V.getQuickComments=function(ae){var Ie=this;(ae=ae||{}).done=ue({instance:this,className:"NIMFn",funcName:"getQuickComments",done:ae.done});var de="msg::getQuickComments",Ce=this,Ue={},qe={};z.verifyOptions(ae,"msgs","msg::getQuickComments"),(!g(ae.msgs)||ae.msgs.length===0||ae.msgs.length>20)&&z.onParamError("msgs应该是数组且数据长度应大于0小于等于20",de);var jt=[];try{jt=JSON.parse(k(ae.msgs))}catch{z.onParamError("msgs 不是合法的对象",de)}i(jt).call(jt,function(Fe,Et){ie.call(Ce,Fe,de,"msgs[".concat(Et,"]."),!0),Fe.scene=Ie.message.sceneMap[Fe.scene],Ue[Fe.idClient]=null,qe[Fe.idClient]=Et}),this.processCallback(ae),this.getLocalMsgsByIdClients({idClients:L(Ue),done:function(Fe,Et){var cr,er=Ce.protocol.timetags.sync;!Fe&&Et.msgs&&Et.msgs.length&&er&&(i(cr=Et.msgs).call(cr,function(nr){Ue[nr.idClient]=nr}),jt=$(jt).call(jt,function(nr){var dr=Ue[nr.idClient];return!dr||(dr.commentTimetag&&(nr.timestamp=dr.commentTimetag),!(dr.commentTimetag>er))})),Ce.sendCmd("getQuickComments",{commentReq:jt,idMap:Ue,indexMap:qe},ae.callback)}})},V.addCollect=function(ae){(ae=ae||{}).done=ue({instance:this,className:"NIMFn",funcName:"addCollect",done:ae.done}),z.verifyOptions(ae,"type data","msg::addCollect");var Ie=new oe(ae,"msg::addCollect");this.processCallback(ae),this.sendCmd("addCollect",{collect:Ie},ae.callback)},V.deleteCollects=function(ae){var Ie;(ae=ae||{}).done=ue({instance:this,className:"NIMFn",funcName:"deleteCollects",done:ae.done}),z.verifyOptions(ae,"collectList","msg::deleteCollects"),(!g(ae.collectList)||ae.collectList.length===0||ae.collectList.length>100)&&z.onParamError("collectList应该是数组且数据长度应大于0小于等于100","msg::deleteCollects"),i(Ie=ae.collectList).call(Ie,function(de,Ce){z.verifyParamType("collectList[".concat(Ce,"].id"),de.id,"string","msg::deleteCollects"),z.verifyParamType("collectList[".concat(Ce,"].createTime"),de.createTime,"number","msg::deleteCollects")}),this.processCallback(ae),this.sendCmd("deleteCollects",{collectList:ae.collectList},ae.callback)},V.updateCollect=function(ae){(ae=ae||{}).done=ue({instance:this,className:"NIMFn",funcName:"updateCollect",done:ae.done}),z.verifyOptions(ae,"collect","msg::updateCollect"),z.verifyParamType("collect.id",ae.collect.id,"string","msg::updateCollect"),z.verifyParamType("collect.createTime",ae.collect.createTime,"number","msg::updateCollect"),this.processCallback(ae),this.sendCmd("updateCollect",{collect:ae.collect},ae.callback)},V.getCollects=function(ae){(ae=ae||{}).done=ue({instance:this,className:"NIMFn",funcName:"getCollects",done:ae.done}),z.verifyCallback(ae,"done","msg::getCollects");var Ie={},de=["type","beginTime","endTime","limit"];i(de).call(de,function(Ce){le(ae[Ce])&&(z.verifyParamType(Ce,ae[Ce],"number","msg::getCollects"),Ie[Ce]=ae[Ce])}),ae.limit>100&&z.onParamError("limit不能大于100","msg::getCollects"),ae.beginTime>ae.endTime&&z.onParamError("beginTime不能大于endTime","msg::getCollects"),le(ae.lastId)&&(z.verifyParamType("lastId",ae.lastId,"string","msg::getCollects"),Ie.lastMsgId=ae.lastId),le(n(ae))&&(Ie.reverse=n(ae)===!0?1:0),this.processCallback(ae),this.sendCmd("getCollects",{collectQuery:Ie,NOTSTORE:"collectQuery"},ae.callback)},V.addStickTopSession=function(ae){(ae=ae||{}).done=ue({instance:this,className:"NIMFn",funcName:"addStickTopSession",done:ae.done}),z.verifyOptions(ae,"id","msg::addStickTopSession");var Ie=z.getIdArray(ae.id);z.verifyParamValid("id的前半部分",Ie[0],this.message.validScenes,"msg::addStickTopSession"),z.verifyParamType("id的后半部分",Ie[1],"string","msg::addStickTopSession"),Ie[0]==="superTeam"&&(Ie[0]="super_team");var de={id:Ie=Ie.join("|")};ae.topCustom?(z.verifyParamType("topCustom",ae.topCustom,"string","msg::addStickTopSession"),de.topCustom=ae.topCustom):de.topCustom="",this.processCallback(ae),this.sendCmd("addStickTopSession",{stickTopSession:de},ae.callback)},V.deleteStickTopSession=function(ae){(ae=ae||{}).done=ue({instance:this,className:"NIMFn",funcName:"deleteStickTopSession",done:ae.done}),z.verifyOptions(ae,"id","msg::deleteStickTopSession");var Ie=z.getIdArray(ae.id);z.verifyParamValid("id的前半部分",Ie[0],this.message.validScenes,"msg::deleteStickTopSession"),z.verifyParamType("id的后半部分",Ie[1],"string","msg::deleteStickTopSession"),Ie[0]==="superTeam"&&(Ie[0]="super_team"),Ie=Ie.join("|"),this.processCallback(ae),this.sendCmd("deleteStickTopSession",{stickTopSession:{id:Ie}},ae.callback)},V.updateStickTopSession=function(ae){(ae=ae||{}).done=ue({instance:this,className:"NIMFn",funcName:"updateStickTopSession",done:ae.done}),z.verifyOptions(ae,"id","msg::updateStickTopSession");var Ie=z.getIdArray(ae.id);z.verifyParamValid("id的前半部分",Ie[0],this.message.validScenes,"msg::updateStickTopSession"),z.verifyParamType("id的后半部分",Ie[1],"string","msg::updateStickTopSession"),Ie[0]==="superTeam"&&(Ie[0]="super_team");var de={id:Ie=Ie.join("|")};ae.topCustom?(z.verifyParamType("topCustom",ae.topCustom,"string","msg::updateStickTopSession"),de.topCustom=ae.topCustom):de.topCustom="",this.processCallback(ae),this.sendCmd("updateStickTopSession",{stickTopSession:de},ae.callback)},V.getStickTopSessions=function(ae){(ae=ae||{}).done=ue({instance:this,className:"NIMFn",funcName:"getStickTopSessions",done:ae.done}),z.verifyOptions(ae,"done","msg::getStickTopSessions"),this.processCallback(ae);var Ie,de=this.protocol.sessionSet,Ce=[];for(var Ue in de)(Ie=this.protocol.getSessionInCache(Ue,ae.findDelete))&&Ie.isTop&&Ce.push(de[Ue]);ae.callback(null,Ce)},V.addMsgPin=function(ae){(ae=ae||{}).done=ue({instance:this,className:"NIMFn",funcName:"addMsgPin",done:ae.done}),z.verifyOptions(ae,"msg","msg::addMsgPin"),ie.call(this,ae.msg,"msg::addMsgPin");var Ie={pinFrom:this.account};le(ae.pinCustom)&&(z.verifyParamType("pinCustom",ae.pinCustom,"string","msg::addMsgPin"),Ie.pinCustom=ae.pinCustom);var de={scene:this.message.sceneMap[ae.msg.scene],from:ae.msg.from,to:ae.msg.to,time:ae.msg.time,idServer:ae.msg.idServer,idClient:ae.msg.idClient};this.processCallback(ae),this.sendCmd("addMsgPin",{msg:de,pinTag:Ie},ae.callback)},V.updateMsgPin=function(ae){(ae=ae||{}).done=ue({instance:this,className:"NIMFn",funcName:"updateMsgPin",done:ae.done}),z.verifyOptions(ae,"msg","msg::updateMsgPin"),ie.call(this,ae.msg,"msg::updateMsgPin");var Ie={pinFrom:this.account};le(ae.pinCustom)&&(z.verifyParamType("pinCustom",ae.pinCustom,"string","msg::updateMsgPin"),Ie.pinCustom=ae.pinCustom);var de={scene:this.message.sceneMap[ae.msg.scene],from:ae.msg.from,to:ae.msg.to,time:ae.msg.time,idServer:ae.msg.idServer,idClient:ae.msg.idClient};this.processCallback(ae),this.sendCmd("updateMsgPin",{msg:de,pinTag:Ie},ae.callback)},V.deleteMsgPin=function(ae){(ae=ae||{}).done=ue({instance:this,className:"NIMFn",funcName:"deleteMsgPin",done:ae.done}),z.verifyOptions(ae,"msg","msg::deleteMsgPin"),ie.call(this,ae.msg,"msg::deleteMsgPin");var Ie={pinFrom:this.account},de={scene:this.message.sceneMap[ae.msg.scene],from:ae.msg.from,to:ae.msg.to,time:ae.msg.time,idServer:ae.msg.idServer,idClient:ae.msg.idClient};this.processCallback(ae),this.sendCmd("deleteMsgPin",{msg:de,pinTag:Ie},ae.callback)},V.getMsgPins=function(ae){var Ie=this;(ae=ae||{}).done=ue({instance:this,className:"NIMFn",funcName:"getMsgPins",done:ae.done}),z.verifyOptions(ae,"id","msg::getMsgPins");var de=this.db,Ce=z.getIdArray(ae.id);z.verifyParamValid("id的前半部分",Ce[0],this.message.validScenes,"msg::getMsgPins"),z.verifyParamType("id的后半部分",Ce[1],"string","msg::getMsgPins"),Ce[0]==="superTeam"&&(Ce[0]="super_team");var Ue={sessionId:Ce=Ce.join("|"),timetag:0};if(this.processCallback(ae),de.enable){var qe=this.protocol.timetags.sync;de.getTimetag("pin-"+ae.id).then(function(Fe){Fe>qe?de.getMsgPins(ae.id).then(function(Et){return ae.callback(null,{pins:Et||[]})}).catch(function(Et){return ae.callback(Et)}):(Ue.timetag=Fe,jt.call(Ie))})}else jt.call(this);function jt(){this.sendCmd("getMsgPins",{msgPinReq:Ue,id:ae.id,NOTSTORE:"msgPinReq"},ae.callback)}}},function(t,r,e){var n=e(3),g=e(15),y=e(2),i=e(10),k=e(41).fn,L=e(0),$=L.undef,V=L.notundef,z=e(161),re=e(26).reportAPI;k.markSysMsgRead=function(oe){(oe=oe||{}).done=re({instance:this,className:"NIMFn",funcName:"markSysMsgRead",done:oe.done});var le,ue=this.db,ie=n.resolve(),ae=this.protocol;L.verifyOptions(oe,"sysMsgs","sysmsg::markSysMsgRead");var Ie=oe.sysMsgs;function de(){oe.done(le,oe)}L.isArray(Ie)||(Ie=[Ie]),ue.enable?ie=ue.markSysMsgRead(Ie).then(function(Ce){Ie=Ce,ae.onUpdateSysMsg(Ce)}):(Ie=g(Ie).call(Ie,function(Ce){return!Ce.read})).length&&(ae.options.autoMarkRead||ae.markSysMsgRead(Ie,!0),y(Ie).call(Ie,function(Ce){Ce.read=!0}),ae.onUpdateSysMsg(Ie)),ie.then(function(){return ae.reduceSysMsgUnread(Ie)}).then(de,function(Ce){le=Ce,de()})},k.sendCustomSysMsg=function(oe){(oe=oe||{}).done=re({instance:this,className:"NIMFn",funcName:"sendCustomSysMsg",done:oe.done}),L.verifyOptions(oe,"scene to content","sysmsg::sendCustomSysMsg"),L.verifyParamValid("scene",oe.scene,this.message.validScenes,"sysmsg::sendCustomSysMsg"),this.processCallback(oe);var le="sendCustomSysMsg";return oe.scene==="p2p"?oe.type="customP2p":oe.scene==="superTeam"?(oe.type="customSuperTeam",le="sendSuperTeamCustomSysMsg"):oe.type="customTeam",oe.sysMsg=new z(oe),g(oe)&&(le="sendFilterCustomSysMsg"),this.sendCmd(le,{sysMsg:oe.sysMsg,single:!0},oe.callback),this.formatReturnSysMsg(oe.sysMsg)},k.formatReturnSysMsg=function(oe){return oe=L.copy(oe),this.protocol.completeSysMsg(oe),oe.status="sending",oe=i(z).call(z,oe)},k.getLocalSysMsgs=function(oe){(oe=oe||{}).done=re({instance:this,className:"NIMFn",funcName:"getLocalSysMsgs",done:oe.done});var le,ue=this.db,ie=[];function ae(){oe.sysMsgs=ie,oe.done(le,oe)}L.verifyOptions(oe),oe.category&&L.verifyParamValid("category",oe.category,z.validCategories,"sysmsg::getLocalSysMsgs"),oe.type&&L.verifyParamValid("type",oe.type,z.validTypes,"sysmsg::getLocalSysMsgs"),$(oe.limit)&&(oe.limit=100),L.verifyParamType("limit",oe.limit,"number","sysmsg::getLocalSysMsgs"),L.verifyParamMax("limit",oe.limit,100,"sysmsg::getLocalSysMsgs"),V(i(oe))?L.verifyParamType("reverse",i(oe),"boolean","sysmsg::getLocalSysMsgs"):oe.reverse=!1,this.processCallback(oe),ue.enable?ue.getSysMsgs(oe).then(function(Ie){ie=Ie,ae()},function(Ie){le=Ie,ae()}):ae()},k.updateLocalSysMsg=function(oe){(oe=oe||{}).done=re({instance:this,className:"NIMFn",funcName:"updateLocalSysMsg",done:oe.done});var le,ue=this.db,ie=null;if(L.verifyOptions(oe,"idServer","sysmsg::updateLocalSysMsg"),this.processCallback(oe),ue.enable){var ae=L.filterObj(oe,"idServer state localCustom");ue.updateSysMsg(ae).then(function(de){ie=de,Ie()},function(de){le=de,Ie()})}else Ie();function Ie(){oe.sysMsg=ie,oe.done(le,oe)}},k.deleteLocalSysMsg=function(oe){(oe=oe||{}).done=re({instance:this,className:"NIMFn",funcName:"deleteLocalSysMsg",done:oe.done});var le,ue=this.db;function ie(){oe.done(le,oe)}L.verifyOptions(oe,"idServer","sysmsg::deleteLocalSysMsg"),this.processCallback(oe),ue.enable?ue.deleteSysMsg(oe.idServer).then(function(){ie()},function(ae){le=ae,ie()}):ie()},k.deleteAllLocalSysMsgs=function(oe){var le;(oe=oe||{}).done=re({instance:this,className:"NIMFn",funcName:"deleteAllLocalSysMsgs",done:oe.done});var ue=this,ie=ue.db;function ae(){ue.protocol.onUpdateSysMsgUnread({}),oe.done(le,oe)}ue.processCallback(oe),ie.enable?ie.deleteAllSysMsgs().then(function(){ae()},function(Ie){le=Ie,ae()}):ae()}},function(t,r,e){var n=e(41).fn,g=e(0),y=e(12),i=e(26).reportAPI;n.getChatroomAddress=function(k){(k=k||{}).done=i({instance:this,className:"NIMFn",funcName:"getChatroomAddress",done:k.done}),g.verifyOptions(k,"chatroomId","chatroom::getChatroomAddress"),k.isWeixinApp=y.isWeixinApp,k.type=y.ipVersion,this.processCallback(k),this.sendCmd("getChatroomAddress",k)}},function(t,r){},function(t,r){},function(t,r,e){var n=e(41).fn,g=e(0),y=e(26).reportAPI;n.audioToText=function(i){(i=i||{}).done=y({instance:this,className:"NIMFn",funcName:"audioToText",done:i.done}),g.verifyOptions(i,"url","audio::audioToText"),i.audioToText=g.filterObj(i,"url"),this.processCallback(i),this.sendCmd("audioToText",i)}},function(t,r,e){var n=e(41).fn;n.clearDB=function(g){var y=this.db;this.processCallback(g);var i=g.done;y.enable?y.clear().then(i,i):i()},n.removeDB=function(g){var y=this.db;this.processCallback(g);var i=g.done;y.enable?y.destroy().then(i,i):i()},n.closeDB=function(g){var y=this.db;this.processCallback(g);var i=g.done;y.enable?y.close().then(i,i):i()}},function(t,r,e){var n=e(41).fn,g=e(317),y=e(0),i=y.undef,k=e(26).reportAPI;n.getPushNotificationMultiportConfig=function(){return k({instance:this,className:"NIMFn",funcName:"getPushNotificationMultiportConfig",hasCallback:!1}),this.protocol.getPushNotificationMultiportConfig()},n.updatePushNotificationMultiportConfig=function(L){(L=L||{}).done=k({instance:this,className:"NIMFn",funcName:"updatePushNotificationMultiportConfig",done:L.done}),y.verifyOptions(L),i(L.shouldPushNotificationWhenPCOnline)&&(L.shouldPushNotificationWhenPCOnline=!0),L.donnop=new g(L),this.processCallback(L),this.sendCmd("updateDonnop",L)}},function(t,r,e){var n=e(2),g=e(3),y=e(4),i=e(24),k=e(41).fn,L=e(0),$=e(905),V=e(906),z=e(26).reportAPI;function re(oe){return i(oe)==="object"&&(oe.msgEventSubscribes?oe=oe.msgEventSubscribes:oe.msgEventSubscribe?oe=oe.msgEventSubscribe:oe.accounts?oe=oe.accounts:oe.msgEvent&&(oe=oe.msgEvent).time&&(oe.time=+oe.time),oe.sync===1?oe.sync=!0:oe.sync===0&&(oe.sync=!1)),oe}k.batchSendEventsCmds=function(oe,le,ue){var ie=this,ae=L.dropArrayDuplicates(le.accounts);ae=L.reshape2d(ae,100);var Ie=[];n(ae).call(ae,function(de){Ie.push(new g(function(Ce,Ue){var qe=L.simpleClone(le);qe.accounts=de,ie.sendCmdWithResp(oe,qe,function(jt,Fe){jt?Ue(jt):Ce(re(Fe))})}))}),g.all(Ie).then(function(de){var Ce=null;if(de.length>0)if(de[0].msgEventSubscribe){var Ue=de[0].msgEventSubscribe;Ue=re(Ue);var qe=[];n(de).call(de,function(jt){qe=y(qe).call(qe,jt.accounts)}),Ce={accounts:qe,msgEventSubscribe:Ue}}else Ce=[],n(de).call(de,function(jt){Ce=y(Ce).call(Ce,jt)});ue(null,Ce)},function(de){ue(de,null)})},k.publishEvent=function(oe){(oe=oe||{}).done=z({instance:this,className:"NIMFn",funcName:"publishEvent",done:oe.done});var le=new $(oe);le=le.assembleEvent(),this.processCallback(oe),this.sendCmdWithResp("publishEvent",{msgEvent:le},function(ue,ie){ue||(ie=re(ie)),oe.callback(ue,ie)})},k.subscribeEvent=function(oe){(oe=oe||{}).done=z({instance:this,className:"NIMFn",funcName:"subscribeEvent",done:oe.done}),L.verifyOptions(oe,"accounts","event::subscribeEvent");var le=new V(oe);L.verifyParamType("accounts",oe.accounts,"array","event::subscribeEvent"),this.processCallback(oe),le=le.assembleEvent(),this.batchSendEventsCmds("subscribeEvent",{msgEventSubscribe:le,accounts:oe.accounts},function(ue,ie){!ue&&ie&&(ie={failedAccounts:ie}),oe.callback(ue,ie)})},k.unSubscribeEventsByAccounts=function(oe){(oe=oe||{}).done=z({instance:this,className:"NIMFn",funcName:"unSubscribeEventsByAccounts",done:oe.done}),L.verifyOptions(oe,"accounts","event::unSubscribeEventsByAccounts"),L.verifyParamType("accounts",oe.accounts,"array","event::unSubscribeEventsByAccounts");var le=new V(oe);le=le.assembleEvent(),this.processCallback(oe),this.batchSendEventsCmds("unSubscribeEventsByAccounts",{msgEventSubscribe:le,accounts:oe.accounts},function(ue,ie){!ue&&ie&&(ie={failedAccounts:ie}),oe.callback(ue,ie)})},k.unSubscribeEventsByType=function(oe){(oe=oe||{}).done=z({instance:this,className:"NIMFn",funcName:"unSubscribeEventsByType",done:oe.done});var le=new V(oe);le=le.assembleEvent(),this.processCallback(oe),this.sendCmdWithResp("unSubscribeEventsByType",{msgEventSubscribe:le},function(ue,ie){oe.callback(ue,ie)})},k.querySubscribeEventsByAccounts=function(oe){(oe=oe||{}).done=z({instance:this,className:"NIMFn",funcName:"querySubscribeEventsByAccounts",done:oe.done}),L.verifyOptions(oe,"accounts","event::querySubscribeEventsByAccounts"),L.verifyParamType("accounts",oe.accounts,"array","event::querySubscribeEventsByAccounts");var le=new V(oe);le=le.assembleEvent(),this.processCallback(oe),this.batchSendEventsCmds("querySubscribeEventsByAccounts",{msgEventSubscribe:le,accounts:oe.accounts},function(ue,ie){!ue&&ie&&(ie={msgEventSubscribes:ie}),oe.callback(ue,ie)})},k.querySubscribeEventsByType=function(oe){(oe=oe||{}).done=z({instance:this,className:"NIMFn",funcName:"querySubscribeEventsByType",done:oe.done});var le=new V(oe);le=le.assembleEvent(),this.processCallback(oe),this.sendCmdWithResp("querySubscribeEventsByType",{msgEventSubscribe:le},function(ue,ie){ue||(ie={msgEventSubscribes:re(ie)}),oe.callback(ue,ie)})}},function(t,r,e){var n=e(8),g=e(0),y=g.notundef,i=e(35);function k(L){if(g.verifyOptions(L,"type value","event::MsgEvent"),g.verifyParamType("type",L.type,"number","event::MsgEvent"),g.verifyParamType("value",L.value,"number","event::MsgEvent"),this.type=L.type,this.value=L.value,this.idClient=g.guid(),y(L.custom)&&(this.custom=""+L.custom),this.validTime=L.validTime||604800,g.verifyParamType("validTime",this.validTime,"number","event::MsgEvent"),g.verifyParamMin("validTime",this.validTime,60,"event::MsgEvent"),g.verifyParamMax("validTime",this.validTime,604800,"event::MsgEvent"),y(L.broadcastType)){var $;if(g.verifyParamType("broadcastType",L.broadcastType,"number","event::MsgEvent"),n($=[1,2]).call($,L.broadcastType)<0)throw new i('参数错误"broadcastType":只能为1或2');this.broadcastType=L.broadcastType}else this.broadcastType=2;y(L.sync)?(g.verifyParamType("sync",L.sync,"boolean","event::MsgEvent"),this.sync=L.sync):this.sync=!1}k.prototype.assembleEvent=function(){return{type:this.type,value:this.value,idClient:this.idClient,custom:this.custom||"",validTime:this.validTime,broadcastType:this.broadcastType,sync:this.sync===!0?1:0}},t.exports=k},function(t,r,e){var n=e(0),g=n.notundef;function y(i){n.verifyOptions(i,"type","event::MsgEventSubscribe"),n.verifyParamType("type",i.type,"number","event::MsgEventSubscribe"),n.findObjIndexInArray([1,2,3],i.type)<0&&n.verifyParamMin("type",i.type,1e5,"event::MsgEventSubscribe"),this.type=i.type,g(i.subscribeTime)?(n.verifyParamType("subscribeTime",i.subscribeTime,"number","event::MsgEventSubscribe"),n.verifyParamMin("subscribeTime",i.subscribeTime,60,"event::MsgEventSubscribe"),n.verifyParamMax("subscribeTime",i.subscribeTime,2592e3,"event::MsgEventSubscribe"),this.subscribeTime=i.subscribeTime):this.subscribeTime=2592e3,g(i.sync)?(n.verifyParamType("sync",i.sync,"boolean","event::MsgEventSubscribe"),this.sync=i.sync):this.sync=!0}y.prototype.assembleEvent=function(){return{type:this.type,subscribeTime:this.subscribeTime,sync:this.sync===!0?1:0}},t.exports=y},function(t,r,e){var n=e(34),g=e(41).fn,y=e(0),i=e(26).reportAPI;g.httpRequestProxy=function(k){(k=k||{}).done=i({instance:this,className:"NIMFn",funcName:"httpRequestProxy",done:k.done}),y.verifyOptions(k,"path","misc::httpRequestProxy");var L=n({},k);delete L.done,this.processCallback(k),this.sendCmd("httpProxy",{proxyTag:L},k.callback)}},function(t,r,e){var n=e(41).fn,g=e(12),y=e(26).reportAPI;n.getQChatAddress=function(i){(i=i||{}).done=y({instance:this,className:"NIMFn",funcName:"getQChatAddress",done:i.done}),this.processCallback(i),this.sendCmd("getQChatAddress",{getQChatAddressTag:{ipType:g.ipVersion}},i.done)}},function(t,r,e){e(305);var n=e(201);e(318)(n),t.exports=n},function(t,r,e){var n=e(321),g=e(9),y=e(3),i=e(56),k=e(4),L=e(22),$=e(202).fn,V=e(12),z=e(165).V2NIMConnectStatus;$.connect=function(){V.isBrowser&&this.reporter.restore(),n($).connect.call(this)},$.refreshSocketUrl=function(){var re;return this.socketUrlsBackup=this.socketUrlsBackup||[],this.socketUrls=g(re=this.socketUrlsBackup).call(re,0),this.logger.info("link::refreshSocketUrl"),this.statusProtector.processEvent("auth/loginLifeCycleAddressing"),y.resolve(this.socketUrls)},$.onHandshakeFailed=function(re,oe){var le;this.reporter.report("chatroomLogin",{binary_websocket:this.useBinaryWebSocket(),accid:this.account,roomId:this.options&&this.options.chatroomId,serverIps:this.options&&this.options.chatroomAddresses&&this.options.chatroomAddresses.join(","),currentServerIp:oe,rt:i()-re,result:408,failReason:"ws_handshake_failed",time:i(),net_connect:this.checkNetworkAvailable()}),this.logger.warn(k(le="link::onHandshakeFailed: shandshake failed, startTime: ".concat(re,", targetUrl: ")).call(le,oe))},$.onConnectFailed=function(re,oe,le){var ue,ie,ae=typeof re=="string"?"connect_failed:".concat(re):"connect_failed";this.reporter.report("chatroomLogin",{binary_websocket:this.useBinaryWebSocket(),accid:this.account,roomId:this.options&&this.options.chatroomId,serverIps:this.options&&this.options.chatroomAddresses&&this.options.chatroomAddresses.join(","),currentServerIp:le,rt:i()-oe,result:408,failReason:"ws_".concat(ae),time:i(),net_connect:this.checkNetworkAvailable()}),this.logger.warn(k(ue=k(ie="link::onConnectFailed: connect failed due to ".concat(re,", startTime: ")).call(ie,oe,", targetUrl: ")).call(ue,le))},$.onSocketError=function(re,oe,le){var ue,ie,ae=typeof re=="string"?"socket.io error:".concat(re):"socket.io error";this.reporter.report("chatroomLogin",{binary_websocket:this.useBinaryWebSocket(),accid:this.account,roomId:this.options&&this.options.chatroomId,serverIps:this.options&&this.options.chatroomAddresses&&this.options.chatroomAddresses.join(","),currentServerIp:le,rt:i()-oe,result:408,failReason:"ws_".concat(ae),time:i(),net_connect:this.checkNetworkAvailable()}),this.logger.warn(k(ue=k(ie="link::onSocketError: due to ".concat(re,", startTime: ")).call(ie,oe,", targetUrl: ")).call(ue,le))},$.notifyDisconnect=function(re){n($).notifyDisconnect.call(this,re)},$.disconnect=function(){var re=this,oe=arguments.length>0&&arguments[0]!==void 0?arguments[0]:function(){};if(this.isConnected())return this.sendCmd("logout"),void L(function(){n($).disconnect.call(re,oe)},0);this.connecting?this.logger.warn("ChatroomProtocolFn api disconnect:: connecting but exiting"):this.statusProtector.getConnectStatus()!==z.V2NIM_CONNECT_STATUS_DISCONNECTED?this.logger.warn("ChatroomProtocolFn api disconnect:: has tried to disconnect actively"):this.logger.warn("ChatroomProtocolFn api disconnect:: other logic entered");var le=n($);le.disconnect.call(this,oe)}},function(t,r,e){var n=e(60),g=e(51),y=e(61),i=e(6),k=e(56),L=e(3),$=e(23),V=e(5),z=e(52),re=e(15),oe=e(53),le=e(2),ue=e(54),ie=e(55),ae=e(42);function Ie(Fe,Et){var cr=V(Fe);if(z){var er=z(Fe);Et&&(er=re(er).call(er,function(nr){return oe(Fe,nr).enumerable})),cr.push.apply(cr,er)}return cr}function de(Fe){for(var Et=1;Et<arguments.length;Et++){var cr,er,nr=arguments[Et]!=null?arguments[Et]:{};Et%2?le(cr=Ie(Object(nr),!0)).call(cr,function(dr){g(Fe,dr,nr[dr])}):ue?ie(Fe,ue(nr)):le(er=Ie(Object(nr))).call(er,function(dr){ae(Fe,dr,oe(nr,dr))})}return Fe}var Ce=e(202).fn,Ue=e(48),qe=e(0);function jt(Fe){var Et=this;if(Fe.code===398)return this.logger.warn("pendingLoginFailed:398 try to reconnect socket link，backoff set min 5s"),Et.forceDisconnect(),Et.backoff.setMin(5e3),void(Et.retryCount===0?Et.refreshSocketUrl():L.resolve()).then(function(){var cr;Et.reconnect({allFailedCB:$(cr=function(er){this.logger.error("pendingLoginFailed: ",er.code,er),this.onAuthError(er,"link::onLoginReconnectFailed")}).call(cr,Et,Fe)})});this.logger.error("pendingLoginFailed: ",Fe.code,Fe),Et.onAuthError(Fe,"link::onLogin")}Ce.assembleLogin=function(){var Fe=this.options;this.sdkSession=this.genSessionKey();var Et={appKey:Fe.appKey,account:Fe.account,deviceId:Ue.deviceId,chatroomId:Fe.chatroomId,session:this.sdkSession,appLogin:this.autoconnect?1:0},cr=!0;if(Fe.loc_x===void 0||Fe.loc_y===void 0||Fe.loc_z===void 0?cr=!1:(typeof Fe.loc_x!="number"&&(Fe.loc_x=0),typeof Fe.loc_y!="number"&&(Fe.loc_y=0),typeof Fe.loc_z!="number"&&(Fe.loc_z=0)),Fe.authType=Fe.loginAuthType,Et=qe.merge(Et,qe.filterObj(Fe,cr?"chatroomNick chatroomAvatar chatroomCustom chatroomEnterCustom isAnonymous notifyTargetTags loginAuthType loginExt loc_x loc_y loc_z distance antiSpamBusinessId":"chatroomNick chatroomAvatar chatroomCustom chatroomEnterCustom isAnonymous notifyTargetTags loginAuthType loginExt distance antiSpamBusinessId")),Fe.tags&&Fe.tags.length>0)try{Et.tags=i(Fe.tags)}catch(er){this.logger.error("assembleLogin::format tags error",Fe.tags,er)}return{type:1,login:Et,imLogin:this.assembleIMLogin()}},Ce.login=y(n.mark(function Fe(){var Et,cr,er,nr=this;return n.wrap(function(dr){for(;;)switch(dr.prev=dr.next){case 0:return Et=this,dr.next=3,Et.assembleLogin();case 3:if(cr=dr.sent,!Et.socket||Et.socket.binaryType!=="arraybuffer"){dr.next=8;break}this.logger.log("link::doLogin: appLogin is "+cr.login.appLogin),dr.next=19;break;case 8:if(!(er=this.socket&&this.socket.socket&&this.socket.socket.sessionid)){dr.next=17;break}if(this.socketIds||(this.socketIds={}),!this.socketIds[er]){dr.next=14;break}return this.logger.warn("onConnect::repeat login",er),dr.abrupt("return");case 14:this.socketIds[er]=!0,dr.next=18;break;case 17:this.logger.warn("onConnect:: no socketId ",this.socket&&this.socket.socket);case 18:this.logger.warn("link::doLogin: "+er+" appLogin is "+cr.login.appLogin);case 19:Et.createLoginTime=k(),Et.sendCmd("login",de({},cr),function(ir,tr){if(ir)Et.reporter.report("chatroomLogin",{binary_websocket:Et.useBinaryWebSocket(),accid:Et.account,roomId:Et.options&&Et.options.chatroomId,serverIps:Et.options&&Et.options.chatroomAddresses&&Et.options.chatroomAddresses.join(","),currentServerIp:Et.url,rt:k()-Et.createLoginTime,result:ir?ir.code:408,failReason:ir?ir.message:"",time:k(),net_connect:Et.checkNetworkAvailable()}),jt.call(Et,ir),Et.statusProtector.processEvent("auth/loginLifeCycleLoginFail",ir);else if(Et.reporter.report("chatroomLogin",{binary_websocket:Et.useBinaryWebSocket(),accid:Et.account,roomId:Et.options&&Et.options.chatroomId,serverIps:Et.options&&Et.options.chatroomAddresses&&Et.options.chatroomAddresses.join(","),currentServerIp:Et.url,rt:k()-Et.createLoginTime,result:200,failReason:"",time:k(),net_connect:Et.checkNetworkAvailable()}),Et.resetReconnectStatus(),nr.heartbeatFail=0,nr.hasLogin=!0,nr.autoconnect=!0,Et.startHeartbeat(),Et.initOnlineListener(),Et.statusProtector.processEvent("auth/loginLifeCycleLoginSucc"),Et.keepNosSafeUrl)Et.afterLogin(tr);else{var ur=[];Et.parser.checkObjSafeUrl(tr,ur,[]),L.all(ur).then(function(){Et.afterLogin(tr)}).catch(function(){Et.afterLogin(tr)})}});case 21:case"end":return dr.stop()}},Fe,this)})),Ce.afterLogin=function(Fe){var Et=Fe.chatroom;this.sendCmd("getNosCdnHost",{}),this.chatroom=Et,this.notifyLogin(Fe)},Ce.kickedReasons=["","chatroomClosed","managerKick","samePlatformKick","silentlyKick","blacked"],Ce.kickedMessages=["","聊天室关闭了","被房主或者管理员踢出","不允许同一个帐号在多个地方同时登录","悄悄被踢","被拉黑了"]},function(t,r,e){var n=e(10),g=e(22),y=e(63),i=e(2),k=e(43),L=e(34),$=e(9),V=e(28),z=e(128),re=e(5),oe=e(202).fn,le=e(0),ue=e(12),ie=e(913),ae=e(795),Ie=e(918),de=e(919),Ce=e(920);oe.completeMsg=function(Ue){Ue.chatroomId=this.chatroom&&this.chatroom.id,Ue.from=this.options.account,Ue.fromClientType="Web",Ue.time||(Ue.time=+new Date)},oe.amendMsg=function(Ue){return Ue},oe.onMsg=function(Ue){var qe,jt=n(qe=this.message).call(qe,Ue.content.msg);if(this.checkMsgUnique(jt)){if(jt.__handleTime=this.reporterHook.getSafeClock(),jt.__receiveTime=Ue.__receiveTime,le.get(Ue,"content.msg.__clientExt"))try{jt.__clientExt=JSON.parse(Ue.content.msg.__clientExt)}catch{this.logger.warn("ChatroomProtocolFn:onMsg __clientExt parse failed ".concat(Ue.content.msg.__clientExt))}this.msgBuffer.push(jt),this.msgFlushTimer||this.startMsgFlushTimer(),Ue&&Ue.content&&Ue.content.msg&&Ue.content.msg.needHighPriorityMsgAck==="1"&&this.sendCmd("sendChatroomMsgAck",{chatRoomMsgAckTag:{idClient:jt.idClient,chatroomId:jt.chatroomId}})}else this.logger.warn("onMsg::msg::repeat",jt.idClient)},oe.startMsgFlushTimer=function(){var Ue=this,qe=Ue.options;Ue.msgFlushTimer=g(function(){var jt,Fe=y(jt=Ue.msgBuffer).call(jt,0,qe.msgBufferSize);if(ue.isBrowser){var Et=Ue.reporterHook.getSafeClock();i(Fe).call(Fe,function(cr){if(cr.flow!=="out"){var er={msgId:cr.idServer,clientId:cr.idClient,receiveTime:Ue.reporterHook.getNTPTime(cr.__receiveTime),serverTime:cr.time,callbackTime:Ue.reporterHook.getNTPTime(Et),preHandleTime:Ue.reporterHook.getNTPTime(cr.__handleTime),fromAccid:cr.from,toAccid:Ue.options.account,type:4,tid:"",roomId:cr.chatroomId,result:200,failReason:"",rt:k(Et-cr.__receiveTime)},nr=le.get(cr,"__clientExt.statistics.apiCallingTime"),dr=le.get(cr,"__clientExt.statistics.sendTime");nr&&dr&&(er.apiCallingTime=nr,er.sendTime=dr,er.attachUploadDuration=le.get(cr,"__clientExt.statistics.attachUploadDuration")||0),Ue.reporter&&Ue.reporter.report("msgReceive",er)}delete cr.__handleTime,delete cr.__receiveTime,delete cr.__clientExt})}Ue.options.onmsgs(Fe),Ue.msgBuffer.length?Ue.startMsgFlushTimer():delete Ue.msgFlushTimer},qe.msgBufferInterval)},oe.checkMsgUnique=le.genCheckUniqueFunc("idClient"),oe.onSendMsg=function(Ue){var qe,jt=Ue.obj.msg;Ue.error?jt.status="fail":(jt=Ue.content.msg).status="success",L(jt,Ue.obj.msg),jt=n(qe=this.message).call(qe,jt),this.checkMsgUnique(jt),Ue.obj=jt},oe.onHistoryMsgs=function(Ue){Ue.error||(Ue.obj||(Ue.obj={}),Ue.obj.msgs=this.message.reverseMsgs(Ue.content.msgs))},oe.onCdnMsgInfo=function(Ue){if(Ue){Ue.cdnUrls&&(Ue.cdnUrls=Ue.cdnUrls.split("|")),Ue.interval&&(Ue.interval=1e3*k(Ue.interval)),Ue.timeout&&(Ue.timeout=+Ue.timeout),Ue.enable&&(Ue.enable=+Ue.enable),Ue.timestamp&&(Ue.timestamp=+Ue.timestamp,this.correctCdnTime(Ue.timestamp));var qe=!this.cdnInfo.enable&&Ue.enable;L(this.cdnInfo,Ue),qe&&this.queryCdnMsgs()}},oe.correctCdnTime=function(Ue){Ue&&typeof Ue=="number"&&(this.cdnInfo||(this.cdnInfo={}),this.cdnInfo.timestamp=Ue,this.cdnInfo.localTime=+new Date,this.cdnInfo.lastNow=null,this.logger.info("correctCdnTime: timestamp, localTime",Ue,this.cdnInfo.localTime,new Date(Ue),new Date(this.cdnInfo.localTime)))},oe.queryCdnMsgs=function(Ue){var qe,jt=this;if(this.cdnInfo&&this.cdnInfo.enable&&this.isConnected()){this.queryCdnTimer=g(function(){return jt.queryCdnMsgs()},this.cdnInfo.interval);var Fe=+new Date;if(Fe=Fe-this.cdnInfo.localTime+this.cdnInfo.timestamp,Fe-=Fe%this.cdnInfo.interval,this.cdnInfo.lastNow!==Fe&&this.cdnInfo.cdnUrls&&this.cdnInfo.cdnUrls.length){this.cdnInfo.cdnUrls.push(this.cdnInfo.cdnUrls.shift());var Et=this,cr=this.cdnInfo.decryptKey,er=this.cdnInfo.timeout||Math.ceil(this.cdnInfo.interval/2),nr=$(qe=this.cdnInfo.cdnUrls).call(qe,0);Ue=Ue||0,function dr(){if(Ue>=3)return void Et.finalFail++;if(nr.length){var ir=nr.shift().replace("#time",Fe),tr=ir.split("/")[2],ur=+new Date;Et.adaptersRequest(ir,{timeout:er,onload:function(or){if(Et.cdnInfo.lastNow>Fe)Et.logger.warn("queryCdnMsgs::doQuery cdnInfo.lastNow > now, will throw data ",Et.cdnInfo.lastNow,Fe,or);else{Et.cdnInfo.lastNow=Fe,Et.afterQueryCdn(tr,+new Date-ur,!0);try{or=JSON.parse(or)}catch(Sr){Et.logger.warn("queryCdnMsgs::doQuery::onload parse res error: ",Sr)}if(or&&or.data){or.ptm&&(Et.cdnInfo.timeout=or.ptm),or.pis&&(Et.cdnInfo.interval=1e3*or.pis);var fr,lr,gr=or.e===!0?(fr=or.data,lr=cr,ie.decrypt(fr,ae.parse(lr),{mode:Ie,padding:de}).toString(Ce)):or.data;Et.onCdnMsgsSmoothly(gr,Fe,1e3*or.c)}}},onerror:function(or){if(Ue++,Et.afterQueryCdn(tr,+new Date-ur,!1),or.status===404){var fr;try{var lr=JSON.parse(or.result);lr.code===404&&lr.timestamp&&(fr=lr.timestamp)}catch(gr){Et.logger.warn("queryCdnMsgs::doQuery::parse 404 result error",gr,or)}!fr&&or.date&&(fr=+new Date(or.date)),fr&&(Et.correctCdnTime(fr),clearTimeout(Et.queryCdnTimer),Et.queryCdnMsgs(Ue))}else dr()}},{exception_service:8})}}()}}},oe.onCdnMsgsSmoothly=function(Ue,qe,jt){try{Ue=JSON.parse(Ue)}catch(nr){this.logger.warn("onCdnMsgsSmoothly::JSON.parse error",nr)}if(this.logger.info("receive cdn msgs "+Ue.length+" and request time is "+new Date(qe)),V(Ue)&&Ue.length){var Fe=this,Et=this.options.msgBufferInterval,cr=Math.ceil(Ue.length*Et/jt);er(),clearInterval(Fe.cdnSmoothTimer),Fe.cdnSmoothTimer=z(function(){return er()},Et)}function er(){if(Fe.isConnected()){var nr=y(Ue).call(Ue,0,cr);i(nr).call(nr,function(dr){var ir=Fe.parser.syncUnserialize(dr,"msg");Fe.onMsg({content:{msg:ir}})}),Ue.length||clearInterval(Fe.cdnSmoothTimer)}}},oe.resetCdnData=function(){this.cdnData={},this.finalFail=0,this.cdnDataTime=+new Date},oe.initCdnData=function(){this.resetCdnData(),le.isFunction(this.options.onCdnRequestData)?(this.options.cdnRequestDataInterval=this.options.cdnRequestDataInterval||3e4,this.afterQueryCdn=function(Ue,qe,jt){var Fe,Et=this;this.cdnData[Ue]||(this.cdnData[Ue]={success:0,fail:0,sr:0,fr:0,smr:0,fmr:0}),jt?(this.cdnData[Ue].success++,this.cdnData[Ue].sr+=qe,qe>this.cdnData[Ue].smr&&(this.cdnData[Ue].smr=qe)):(this.cdnData[Ue].fail++,this.cdnData[Ue].fr+=qe,qe>this.cdnData[Ue].fmr&&(this.cdnData[Ue].fmr=qe)),+new Date-this.cdnDataTime<this.options.cdnRequestDataInterval||(i(Fe=re(this.cdnData)).call(Fe,function(cr){Et.cdnData[cr].sr=Et.cdnData[cr].sr/Et.cdnData[cr].success||0,Et.cdnData[cr].fr=Et.cdnData[cr].fr/Et.cdnData[cr].fail||0}),this.options.onCdnRequestData(L({},this.cdnData),this.finalFail),this.resetCdnData())}):this.afterQueryCdn=function(){}}},function(t,r,e){var n;t.exports=(n=e(96),e(795),e(915),e(796),e(320),function(){var g=n,y=g.lib.BlockCipher,i=g.algo,k=[],L=[],$=[],V=[],z=[],re=[],oe=[],le=[],ue=[],ie=[];(function(){for(var de=[],Ce=0;Ce<256;Ce++)de[Ce]=Ce<128?Ce<<1:Ce<<1^283;var Ue=0,qe=0;for(Ce=0;Ce<256;Ce++){var jt=qe^qe<<1^qe<<2^qe<<3^qe<<4;jt=jt>>>8^255&jt^99,k[Ue]=jt,L[jt]=Ue;var Fe=de[Ue],Et=de[Fe],cr=de[Et],er=257*de[jt]^16843008*jt;$[Ue]=er<<24|er>>>8,V[Ue]=er<<16|er>>>16,z[Ue]=er<<8|er>>>24,re[Ue]=er,er=16843009*cr^65537*Et^257*Fe^16843008*Ue,oe[jt]=er<<24|er>>>8,le[jt]=er<<16|er>>>16,ue[jt]=er<<8|er>>>24,ie[jt]=er,Ue?(Ue=Fe^de[de[de[cr^Fe]]],qe^=de[de[qe]]):Ue=qe=1}})();var ae=[0,1,2,4,8,16,32,64,128,27,54],Ie=i.AES=y.extend({_doReset:function(){if(!this._nRounds||this._keyPriorReset!==this._key){for(var de=this._keyPriorReset=this._key,Ce=de.words,Ue=de.sigBytes/4,qe=4*((this._nRounds=Ue+6)+1),jt=this._keySchedule=[],Fe=0;Fe<qe;Fe++)Fe<Ue?jt[Fe]=Ce[Fe]:(er=jt[Fe-1],Fe%Ue?Ue>6&&Fe%Ue==4&&(er=k[er>>>24]<<24|k[er>>>16&255]<<16|k[er>>>8&255]<<8|k[255&er]):(er=k[(er=er<<8|er>>>24)>>>24]<<24|k[er>>>16&255]<<16|k[er>>>8&255]<<8|k[255&er],er^=ae[Fe/Ue|0]<<24),jt[Fe]=jt[Fe-Ue]^er);for(var Et=this._invKeySchedule=[],cr=0;cr<qe;cr++){if(Fe=qe-cr,cr%4)var er=jt[Fe];else er=jt[Fe-4];Et[cr]=cr<4||Fe<=4?er:oe[k[er>>>24]]^le[k[er>>>16&255]]^ue[k[er>>>8&255]]^ie[k[255&er]]}}},encryptBlock:function(de,Ce){this._doCryptBlock(de,Ce,this._keySchedule,$,V,z,re,k)},decryptBlock:function(de,Ce){var Ue=de[Ce+1];de[Ce+1]=de[Ce+3],de[Ce+3]=Ue,this._doCryptBlock(de,Ce,this._invKeySchedule,oe,le,ue,ie,L),Ue=de[Ce+1],de[Ce+1]=de[Ce+3],de[Ce+3]=Ue},_doCryptBlock:function(de,Ce,Ue,qe,jt,Fe,Et,cr){for(var er=this._nRounds,nr=de[Ce]^Ue[0],dr=de[Ce+1]^Ue[1],ir=de[Ce+2]^Ue[2],tr=de[Ce+3]^Ue[3],ur=4,or=1;or<er;or++){var fr=qe[nr>>>24]^jt[dr>>>16&255]^Fe[ir>>>8&255]^Et[255&tr]^Ue[ur++],lr=qe[dr>>>24]^jt[ir>>>16&255]^Fe[tr>>>8&255]^Et[255&nr]^Ue[ur++],gr=qe[ir>>>24]^jt[tr>>>16&255]^Fe[nr>>>8&255]^Et[255&dr]^Ue[ur++],Sr=qe[tr>>>24]^jt[nr>>>16&255]^Fe[dr>>>8&255]^Et[255&ir]^Ue[ur++];nr=fr,dr=lr,ir=gr,tr=Sr}fr=(cr[nr>>>24]<<24|cr[dr>>>16&255]<<16|cr[ir>>>8&255]<<8|cr[255&tr])^Ue[ur++],lr=(cr[dr>>>24]<<24|cr[ir>>>16&255]<<16|cr[tr>>>8&255]<<8|cr[255&nr])^Ue[ur++],gr=(cr[ir>>>24]<<24|cr[tr>>>16&255]<<16|cr[nr>>>8&255]<<8|cr[255&dr])^Ue[ur++],Sr=(cr[tr>>>24]<<24|cr[nr>>>16&255]<<16|cr[dr>>>8&255]<<8|cr[255&ir])^Ue[ur++],de[Ce]=fr,de[Ce+1]=lr,de[Ce+2]=gr,de[Ce+3]=Sr},keySize:8});g.AES=y._createHelper(Ie)}(),n.AES)},function(t,r){},function(t,r,e){var n;t.exports=(n=e(96),function(g){var y=n,i=y.lib,k=i.WordArray,L=i.Hasher,$=y.algo,V=[];(function(){for(var ie=0;ie<64;ie++)V[ie]=4294967296*g.abs(g.sin(ie+1))|0})();var z=$.MD5=L.extend({_doReset:function(){this._hash=new k.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(ie,ae){for(var Ie=0;Ie<16;Ie++){var de=ae+Ie,Ce=ie[de];ie[de]=16711935&(Ce<<8|Ce>>>24)|4278255360&(Ce<<24|Ce>>>8)}var Ue=this._hash.words,qe=ie[ae+0],jt=ie[ae+1],Fe=ie[ae+2],Et=ie[ae+3],cr=ie[ae+4],er=ie[ae+5],nr=ie[ae+6],dr=ie[ae+7],ir=ie[ae+8],tr=ie[ae+9],ur=ie[ae+10],or=ie[ae+11],fr=ie[ae+12],lr=ie[ae+13],gr=ie[ae+14],Sr=ie[ae+15],wr=Ue[0],kr=Ue[1],mr=Ue[2],Ir=Ue[3];wr=re(wr,kr,mr,Ir,qe,7,V[0]),Ir=re(Ir,wr,kr,mr,jt,12,V[1]),mr=re(mr,Ir,wr,kr,Fe,17,V[2]),kr=re(kr,mr,Ir,wr,Et,22,V[3]),wr=re(wr,kr,mr,Ir,cr,7,V[4]),Ir=re(Ir,wr,kr,mr,er,12,V[5]),mr=re(mr,Ir,wr,kr,nr,17,V[6]),kr=re(kr,mr,Ir,wr,dr,22,V[7]),wr=re(wr,kr,mr,Ir,ir,7,V[8]),Ir=re(Ir,wr,kr,mr,tr,12,V[9]),mr=re(mr,Ir,wr,kr,ur,17,V[10]),kr=re(kr,mr,Ir,wr,or,22,V[11]),wr=re(wr,kr,mr,Ir,fr,7,V[12]),Ir=re(Ir,wr,kr,mr,lr,12,V[13]),mr=re(mr,Ir,wr,kr,gr,17,V[14]),wr=oe(wr,kr=re(kr,mr,Ir,wr,Sr,22,V[15]),mr,Ir,jt,5,V[16]),Ir=oe(Ir,wr,kr,mr,nr,9,V[17]),mr=oe(mr,Ir,wr,kr,or,14,V[18]),kr=oe(kr,mr,Ir,wr,qe,20,V[19]),wr=oe(wr,kr,mr,Ir,er,5,V[20]),Ir=oe(Ir,wr,kr,mr,ur,9,V[21]),mr=oe(mr,Ir,wr,kr,Sr,14,V[22]),kr=oe(kr,mr,Ir,wr,cr,20,V[23]),wr=oe(wr,kr,mr,Ir,tr,5,V[24]),Ir=oe(Ir,wr,kr,mr,gr,9,V[25]),mr=oe(mr,Ir,wr,kr,Et,14,V[26]),kr=oe(kr,mr,Ir,wr,ir,20,V[27]),wr=oe(wr,kr,mr,Ir,lr,5,V[28]),Ir=oe(Ir,wr,kr,mr,Fe,9,V[29]),mr=oe(mr,Ir,wr,kr,dr,14,V[30]),wr=le(wr,kr=oe(kr,mr,Ir,wr,fr,20,V[31]),mr,Ir,er,4,V[32]),Ir=le(Ir,wr,kr,mr,ir,11,V[33]),mr=le(mr,Ir,wr,kr,or,16,V[34]),kr=le(kr,mr,Ir,wr,gr,23,V[35]),wr=le(wr,kr,mr,Ir,jt,4,V[36]),Ir=le(Ir,wr,kr,mr,cr,11,V[37]),mr=le(mr,Ir,wr,kr,dr,16,V[38]),kr=le(kr,mr,Ir,wr,ur,23,V[39]),wr=le(wr,kr,mr,Ir,lr,4,V[40]),Ir=le(Ir,wr,kr,mr,qe,11,V[41]),mr=le(mr,Ir,wr,kr,Et,16,V[42]),kr=le(kr,mr,Ir,wr,nr,23,V[43]),wr=le(wr,kr,mr,Ir,tr,4,V[44]),Ir=le(Ir,wr,kr,mr,fr,11,V[45]),mr=le(mr,Ir,wr,kr,Sr,16,V[46]),wr=ue(wr,kr=le(kr,mr,Ir,wr,Fe,23,V[47]),mr,Ir,qe,6,V[48]),Ir=ue(Ir,wr,kr,mr,dr,10,V[49]),mr=ue(mr,Ir,wr,kr,gr,15,V[50]),kr=ue(kr,mr,Ir,wr,er,21,V[51]),wr=ue(wr,kr,mr,Ir,fr,6,V[52]),Ir=ue(Ir,wr,kr,mr,Et,10,V[53]),mr=ue(mr,Ir,wr,kr,ur,15,V[54]),kr=ue(kr,mr,Ir,wr,jt,21,V[55]),wr=ue(wr,kr,mr,Ir,ir,6,V[56]),Ir=ue(Ir,wr,kr,mr,Sr,10,V[57]),mr=ue(mr,Ir,wr,kr,nr,15,V[58]),kr=ue(kr,mr,Ir,wr,lr,21,V[59]),wr=ue(wr,kr,mr,Ir,cr,6,V[60]),Ir=ue(Ir,wr,kr,mr,or,10,V[61]),mr=ue(mr,Ir,wr,kr,Fe,15,V[62]),kr=ue(kr,mr,Ir,wr,tr,21,V[63]),Ue[0]=Ue[0]+wr|0,Ue[1]=Ue[1]+kr|0,Ue[2]=Ue[2]+mr|0,Ue[3]=Ue[3]+Ir|0},_doFinalize:function(){var ie=this._data,ae=ie.words,Ie=8*this._nDataBytes,de=8*ie.sigBytes;ae[de>>>5]|=128<<24-de%32;var Ce=g.floor(Ie/4294967296),Ue=Ie;ae[15+(de+64>>>9<<4)]=16711935&(Ce<<8|Ce>>>24)|4278255360&(Ce<<24|Ce>>>8),ae[14+(de+64>>>9<<4)]=16711935&(Ue<<8|Ue>>>24)|4278255360&(Ue<<24|Ue>>>8),ie.sigBytes=4*(ae.length+1),this._process();for(var qe=this._hash,jt=qe.words,Fe=0;Fe<4;Fe++){var Et=jt[Fe];jt[Fe]=16711935&(Et<<8|Et>>>24)|4278255360&(Et<<24|Et>>>8)}return qe},clone:function(){var ie=L.clone.call(this);return ie._hash=this._hash.clone(),ie}});function re(ie,ae,Ie,de,Ce,Ue,qe){var jt=ie+(ae&Ie|~ae&de)+Ce+qe;return(jt<<Ue|jt>>>32-Ue)+ae}function oe(ie,ae,Ie,de,Ce,Ue,qe){var jt=ie+(ae&de|Ie&~de)+Ce+qe;return(jt<<Ue|jt>>>32-Ue)+ae}function le(ie,ae,Ie,de,Ce,Ue,qe){var jt=ie+(ae^Ie^de)+Ce+qe;return(jt<<Ue|jt>>>32-Ue)+ae}function ue(ie,ae,Ie,de,Ce,Ue,qe){var jt=ie+(Ie^(ae|~de))+Ce+qe;return(jt<<Ue|jt>>>32-Ue)+ae}y.MD5=L._createHelper(z),y.HmacMD5=L._createHmacHelper(z)}(Math),n.MD5)},function(t,r,e){var n,g,y,i,k,L,$,V;t.exports=(V=e(96),g=(n=V).lib,y=g.WordArray,i=g.Hasher,k=n.algo,L=[],$=k.SHA1=i.extend({_doReset:function(){this._hash=new y.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(z,re){for(var oe=this._hash.words,le=oe[0],ue=oe[1],ie=oe[2],ae=oe[3],Ie=oe[4],de=0;de<80;de++){if(de<16)L[de]=0|z[re+de];else{var Ce=L[de-3]^L[de-8]^L[de-14]^L[de-16];L[de]=Ce<<1|Ce>>>31}var Ue=(le<<5|le>>>27)+Ie+L[de];Ue+=de<20?1518500249+(ue&ie|~ue&ae):de<40?1859775393+(ue^ie^ae):de<60?(ue&ie|ue&ae|ie&ae)-1894007588:(ue^ie^ae)-899497514,Ie=ae,ae=ie,ie=ue<<30|ue>>>2,ue=le,le=Ue}oe[0]=oe[0]+le|0,oe[1]=oe[1]+ue|0,oe[2]=oe[2]+ie|0,oe[3]=oe[3]+ae|0,oe[4]=oe[4]+Ie|0},_doFinalize:function(){var z=this._data,re=z.words,oe=8*this._nDataBytes,le=8*z.sigBytes;return re[le>>>5]|=128<<24-le%32,re[14+(le+64>>>9<<4)]=Math.floor(oe/4294967296),re[15+(le+64>>>9<<4)]=oe,z.sigBytes=4*re.length,this._process(),this._hash},clone:function(){var z=i.clone.call(this);return z._hash=this._hash.clone(),z}}),n.SHA1=i._createHelper($),n.HmacSHA1=i._createHmacHelper($),V.SHA1)},function(t,r,e){var n,g,y,i;t.exports=(n=e(96),y=(g=n).lib.Base,i=g.enc.Utf8,void(g.algo.HMAC=y.extend({init:function(k,L){k=this._hasher=new k.init,typeof L=="string"&&(L=i.parse(L));var $=k.blockSize,V=4*$;L.sigBytes>V&&(L=k.finalize(L)),L.clamp();for(var z=this._oKey=L.clone(),re=this._iKey=L.clone(),oe=z.words,le=re.words,ue=0;ue<$;ue++)oe[ue]^=1549556828,le[ue]^=909522486;z.sigBytes=re.sigBytes=V,this.reset()},reset:function(){var k=this._hasher;k.reset(),k.update(this._iKey)},update:function(k){return this._hasher.update(k),this},finalize:function(k){var L=this._hasher,$=L.finalize(k);return L.reset(),L.finalize(this._oKey.clone().concat($))}})))},function(t,r,e){var n,g;t.exports=(g=e(96),e(320),g.mode.ECB=((n=g.lib.BlockCipherMode.extend()).Encryptor=n.extend({processBlock:function(y,i){this._cipher.encryptBlock(y,i)}}),n.Decryptor=n.extend({processBlock:function(y,i){this._cipher.decryptBlock(y,i)}}),n),g.mode.ECB)},function(t,r,e){var n;t.exports=(n=e(96),e(320),n.pad.Pkcs7)},function(t,r,e){var n;t.exports=(n=e(96),n.enc.Utf8)},function(t,r,e){var n=e(10),g=e(202).fn,y=e(319);g.onChatroomMembersInfo=g.onChatroomMembers=function(i){i.error||(i.obj.members=y.reverseMembers(i.content.members))},g.onGetChatroomMemberCountByTag=function(i){i.error||(i.obj=i.content)},g.onMarkChatroomMember=function(i){i.error||(i.obj.member=n(y).call(y,i.content.chatroomMember))},g.onSyncRobot=function(i){!i.error&&this.options.onrobots?this.options.onrobots(null,i.content):this.ontions.onrobots(i.error,{})}},function(t,r,e){var n=e(10),g=e(11),y=e(0),i=function(ie){this.account=ie.account},k=i.prototype,L=k.Message=e(123),$=k.TextMessage=e(923),V=k.FileMessage=e(210),z=k.GeoMessage=e(927),re=k.NotificationMessage=e(928),oe=k.CustomMessage=e(929),le=k.TipMessage=e(930),ue=k.RobotMessage=e(931);k.validTypes=L.validTypes,k.reverse=function(ie){var ae;switch(L.getType(ie)){case"text":ae=n($).call($,ie);break;case"image":case"audio":case"video":case"file":ae=n(V).call(V,ie);break;case"geo":ae=n(z).call(z,ie);break;case"notification":ae=n(re).call(re,ie);break;case"custom":ae=n(oe).call(oe,ie);break;case"tip":ae=n(le).call(le,ie);break;case"robot":ae=n(ue).call(ue,ie);break;default:ae=n(L).call(L,ie)}return L.setExtra(ae,this.account),ae},k.reverseMsgs=function(ie,ae){var Ie,de,Ce=this;return g(ie).call(ie,function(Ue){return Ue=n(Ce).call(Ce,Ue),ae&&((Ie=ae.modifyObj)&&(Ue=y.merge(Ue,Ie)),de=ae.mapper,y.isFunction(de)&&(Ue=de(Ue))),Ue})},t.exports=i},function(t,r,e){var n=e(19),g=e(10),y=e(123),i=e(0);function k(L){i.verifyOptions(L,"text","msg::TextMessage"),L.type="text",y.call(this,L),this.attach=L.text,this.body=""}k.prototype=n(y.prototype),k.reverse=function(L){var $=g(y).call(y,L);return $.text=L.attach,$},t.exports=k},function(t,r,e){var n=e(19),g=e(0),y=e(210);function i(){}i.prototype=n(y.prototype),i.verifyFile=function(k,L){g.verifyOptions(k,"w h",!0,"file.",L)},t.exports=i},function(t,r,e){var n=e(19),g=e(210),y=e(0);function i(){}i.prototype=n(g.prototype),i.verifyFile=function(k,L){y.verifyOptions(k,"dur",!0,"file.",L)},t.exports=i},function(t,r,e){var n=e(19),g=e(210),y=e(0);function i(){}i.prototype=n(g.prototype),i.verifyFile=function(k,L){y.verifyOptions(k,"dur w h",!0,"file.",L)},t.exports=i},function(t,r,e){var n=e(6),g=e(19),y=e(10),i=e(123),k=e(0);function L($){$.type="geo",k.verifyOptions($,"geo","msg::GeoMessage"),k.verifyOptions($.geo,"lng lat title",!0,"geo.","msg::GeoMessage"),k.verifyParamType("geo.lng",$.geo.lng,"number","msg::GeoMessage"),k.verifyParamType("geo.lat",$.geo.lat,"number","msg::GeoMessage"),k.verifyParamType("geo.title",$.geo.title,"string","msg::GeoMessage"),i.call(this,$),this.attach=n($.geo)}L.prototype=g(i.prototype),L.reverse=function($){var V=y(i).call(i,$);return $.attach=$.attach?""+$.attach:"",V.geo=$.attach?JSON.parse($.attach):{},V},t.exports=L},function(t,r,e){var n=e(19),g=e(10),y=e(43),i=e(0).notundef,k=e(123),L={301:"memberEnter",302:"memberExit",303:"blackMember",304:"unblackMember",305:"gagMember",306:"ungagMember",307:"addManager",308:"removeManager",309:"addCommon",310:"removeCommon",311:"closeChatroom",312:"updateChatroom",313:"kickMember",314:"addTempMute",315:"removeTempMute",316:"updateMemberInfo",317:"updateQueue",318:"muteRoom",319:"unmuteRoom",320:"batchUpdateQueue",321:"addTempMuteTag",322:"removeTempMuteTag",324:"batchQueueOffer",323:"deleteChatroomMsg",325:"updateChatroomTags"};function $(){}$.prototype=n(k.prototype),$.reverse=function(V){var z=g(k).call(k,V);if(V.attach=V.attach?""+V.attach:"",V.attach){var re=JSON.parse(V.attach);if(z.attach={type:L[re.id]},i(re.data)){var oe=re.data;if(i(oe.operator)&&(z.attach.from=oe.operator),i(oe.opeNick)&&(z.attach.fromNick=oe.opeNick),i(oe.target)&&(z.attach.to=oe.target),i(oe.tarNick)&&(z.attach.toNick=oe.tarNick),i(oe.muteDuration)&&(z.attach.duration=y(oe.muteDuration,10)),i(oe.tags)&&(z.attach.tags=oe.tags),z.attach.type==="memberEnter"&&(i(oe.muted)?z.attach.gaged=+oe.muted==1:z.attach.gaged=!1,i(oe.tempMuted)?z.attach.tempMuted=+oe.tempMuted==1:z.attach.tempMuted=!1,i(oe.muteTtl)?z.attach.tempMuteDuration=+oe.muteTtl:z.attach.tempMuteDuration=0),z.attach.type==="deleteChatroomMsg"&&(z.attach.msgId=oe.msgId,z.attach.msgTime=oe.msgTime),i(oe.ext)&&(z.attach.custom=oe.ext),i(oe.queueChange)){var le=JSON.parse(oe.queueChange);switch(le._e){case"OFFER":z.attach.queueChange={type:"OFFER",elementKey:le.key,elementValue:le.content};break;case"POLL":z.attach.queueChange={type:"POLL",elementKey:le.key,elementValue:le.content};break;case"DROP":z.attach.queueChange={type:"DROP"};break;case"PARTCLEAR":case"BATCH_UPDATE":z.attach.queueChange={type:le._e,elementKv:le.kvObject};break;case"BATCH_OFFER":z.attach.queueChange={type:le._e,elements:le.elements}}}}}else z.attach={};return z},t.exports=$},function(t,r,e){var n=e(6),g=e(19),y=e(10),i=e(123),k=e(0);function L($){k.verifyOptions($,"content","msg::CustomMessage"),$.type="custom",i.call(this,$),typeof $.content!="string"&&($.content=n($.content)),this.attach=$.content}L.prototype=g(i.prototype),L.reverse=function($){var V=y(i).call(i,$);return V.content=$.attach,V},t.exports=L},function(t,r,e){var n=e(19),g=e(10),y=e(123),i=e(0);function k(L){i.verifyOptions(L,"tip","msg::TipMessage"),L.type="tip",y.call(this,L),this.attach=L.tip}k.prototype=n(y.prototype),k.reverse=function(L){var $=g(y).call(y,L);return $.tip=L.attach,$},t.exports=k},function(t,r,e){var n=e(6),g=e(19),y=e(10),i=e(11),k=e(123),L=e(0),$={welcome:"00",text:"01",link:"03"},V={"01":"text","02":"image","03":"answer",11:"template"};function z(re){L.verifyOptions(re,"content","msg::RobotMessage");var oe=re.content;switch(oe.type){case"welcome":L.undef(re.body)&&(this.body="欢迎消息");break;case"text":L.verifyOptions(oe,"content","msg::RobotMessage"),L.undef(re.body)&&(this.body=oe.content);break;case"link":L.verifyOptions(oe,"target","msg::RobotMessage")}oe.type&&(oe.type=$[oe.type]),oe={param:oe,robotAccid:re.robotAccid},this.attach=n(oe),re.type="robot",k.call(this,re)}z.prototype=g(k.prototype),z.reverse=function(re){var oe=y(k).call(k,re);if(oe.type==="robot"){var le=JSON.parse(re.attach);if(le.param&&(le.param.type=V[le.param.type]||"unknown"),le.robotMsg){var ue=(le=L.merge(le,le.robotMsg)).message;le.flag==="bot"?le.message=i(ue).call(ue,function(ie){return ie.type=V[ie.type]||"unknown",ie}):le.flag,delete le.robotMsg}oe.content=le}return oe},t.exports=z},function(t,r,e){var n=e(10),g=e(28),y=e(11),i=e(15),k=e(6),L=e(0),$=L.undef,V=e(201).fn,z=e(26).reportAPI;V.beforeSendMsg=function(oe){oe.cmd="sendMsg"};var re={text:0,image:1,audio:2,video:3,geo:4,notification:5,file:6,tip:10,robot:11,custom:100};V.getHistoryMsgs=function(oe){if((oe=oe||{}).done=z({instance:this,className:"ChatroomFn",funcName:"getHistoryMsgs",done:oe.done}),L.verifyOptions(oe),$(oe.timetag)?oe.timetag=0:L.verifyParamType("timetag",oe.timetag,"number","msg::getHistoryMsgs"),$(oe.limit)?oe.limit=100:L.verifyParamType("limit",oe.limit,"number","msg::getHistoryMsgs"),$(n(oe))?oe.reverse=!1:L.verifyParamType("reverse",n(oe),"boolean","msg::getHistoryMsgs"),$(oe.msgTypes))oe.msgTypes=[];else if(g(oe.msgTypes)){var le,ue;oe.msgTypes=y(le=oe.msgTypes).call(le,function(ie){return re[ie]}),oe.msgTypes=i(ue=oe.msgTypes).call(ue,function(ie){return typeof ie=="number"})}else typeof re[oe.msgTypes]=="number"?oe.msgTypes=[re[oe.msgTypes]]:oe.msgTypes=[];this.processCallback(oe),this.sendCmd("getHistoryMsgs",oe,function(ie,ae,Ie){g(Ie)&&(Ie=y(Ie).call(Ie,function(de){return re[de.type]&&(de.type=re[de.type]),de})),oe.callback(ie,ae,Ie)})},V.getHistoryMsgsByTags=function(oe){if((oe=oe||{}).done=z({instance:this,className:"ChatroomFn",funcName:"getHistoryMsgsByTags",done:oe.done}),L.verifyOptions(oe,"tags","api::msg::getHistoryMsgsByTags"),L.verifyParamType("tags",oe.tags,"array","api::msg::getHistoryMsgsByTags"),$(oe.fromTime)?oe.fromTime=0:L.verifyParamType("fromTime",oe.fromTime,"number","api::msg::getHistoryMsgsByTags"),$(oe.toTime)?oe.toTime=0:L.verifyParamType("toTime",oe.toTime,"number","api::msg::getHistoryMsgsByTags"),$(oe.limit)?oe.limit=100:L.verifyParamType("limit",oe.limit,"number","msg::getHistoryMsgs"),$(n(oe))?oe.reverse=0:L.verifyParamType("reverse",n(oe),"number","msg::getHistoryMsgs"),$(oe.types))oe.types=[];else if(g(oe.types)){var le,ue;oe.types=y(le=oe.types).call(le,function(ie){return re[ie]}),oe.types=i(ue=oe.types).call(ue,function(ie){return typeof ie=="number"})}else typeof re[oe.types]=="number"?oe.types=[re[oe.types]]:oe.types=[];this.processCallback(oe),oe.types=k(oe.types),oe.tags=k(oe.tags),this.sendCmd("getHistoryMsgsByTags",{chatRoomTagHistoryMsgRequestTag:oe},oe.callback)}},function(t,r,e){var n=e(201).fn,g=e(26).reportAPI;n.disconnect=function(y){(y=y||{}).done=g({instance:this,className:"ChatroomFn",funcName:"disconnect",done:y.done}),this.protocol.disconnect(y.done)}},function(t,r,e){var n=e(0),g=n.undef,y=n.verifyOptions,i=n.verifyParamType,k=e(319),L=e(201).fn,$=e(26).reportAPI;L.updateMyChatroomMemberInfo=function(V){(V=V||{}).done=$({instance:this,className:"ChatroomFn",funcName:"updateMyChatroomMemberInfo",done:V.done}),y(V,"member needNotify","member::updateMyChatroomMemberInfo"),i("needNotify",V.needNotify,"boolean","member::updateMyChatroomMemberInfo"),V.needSave=V.needSave||!1,i("needSave",V.needSave,"boolean","member::updateMyChatroomMemberInfo"),this.processCustom(V),this.processCallback(V),V.chatroomMember=new k(V.member),V.antispamTag={antiSpamBusinessId:V.antiSpamBusinessId},this.sendCmd("updateMyChatroomMemberInfo",V)},L.getChatroomMembers=function(V){(V=V||{}).done=$({instance:this,className:"ChatroomFn",funcName:"getChatroomMembers",done:V.done}),y(V,"guest","member::getChatroomMembers"),i("guest",V.guest,"boolean","member::getChatroomMembers"),g(V.time)?V.time=0:i("time",V.time,"number","member::getChatroomMembers"),g(V.limit)?V.limit=100:i("limit",V.limit,"number","member::getChatroomMembers"),this.processCallback(V),V.guest?V.type=V.desc===!1?3:1:V.type=V.onlyOnline?2:0,this.sendCmd("getChatroomMembers",V)},L.getChatroomMembersByTag=function(V){(V=V||{}).done=$({instance:this,className:"ChatroomFn",funcName:"getChatroomMembersByTag",done:V.done}),y(V,"tag","getChatroomMembersByTag::rag"),g(V.time)?V.time=0:i("time",V.time,"number","getChatroomMembersByTag::time"),g(V.limit)?V.limit=100:i("limit",V.limit,"number","getChatroomMembersByTag::limit"),this.processCallback(V),this.sendCmd("getChatroomMembersByTag",{tagMemberReq:n.filterObj(V,"tag limit time"),callback:V.callback})},L.getChatroomMemberCountByTag=function(V){(V=V||{}).done=$({instance:this,className:"ChatroomFn",funcName:"getChatroomMemberCountByTag",done:V.done}),y(V,"tag","getChatroomMemberCountByTag::rag"),this.processCallback(V),this.sendCmd("getChatroomMemberCountByTag",V)},L.getChatroomMembersInfo=function(V){(V=V||{}).done=$({instance:this,className:"ChatroomFn",funcName:"getChatroomMembersInfo",done:V.done}),y(V,"accounts","member::getChatroomMembersInfo"),i("accounts",V.accounts,"array","member::getChatroomMembersInfo"),this.processCallback(V),this.sendCmd("getChatroomMembersInfo",V)},L.markChatroomIdentity=function(V){(V=V||{}).done=$({instance:this,className:"ChatroomFn",funcName:"markChatroomIdentity",done:V.done}),y(V,"identity","member::markChatroomIdentity"),V.type={manager:1,common:2,black:-1,mute:-2}[V.identity],delete V.identity,isNaN(V.type)?y(V,"identity",'member::markChatroomIdentity. The valid value of the identity is "manager" or "common" or "black" or "mute".'):this.markChatroomMember(V)},L.markChatroomManager=function(V){(V=V||{}).done=$({instance:this,className:"ChatroomFn",funcName:"markChatroomManager",done:V.done}),V.type=1,this.markChatroomMember(V)},L.markChatroomCommonMember=function(V){(V=V||{}).done=$({instance:this,className:"ChatroomFn",funcName:"markChatroomCommonMember",done:V.done}),V.type=2,this.markChatroomMember(V)},L.markChatroomBlacklist=function(V){(V=V||{}).done=$({instance:this,className:"ChatroomFn",funcName:"markChatroomBlacklist",done:V.done}),V.type=-1,this.markChatroomMember(V)},L.markChatroomGaglist=function(V){(V=V||{}).done=$({instance:this,className:"ChatroomFn",funcName:"markChatroomGaglist",done:V.done}),V.type=-2,this.markChatroomMember(V)},L.markChatroomMember=function(V){(V=V||{}).done=$({instance:this,className:"ChatroomFn",funcName:"markChatroomMember",done:V.done}),y(V,"account type isAdd","member::markChatroomMember"),i("isAdd",V.isAdd,"boolean","member::markChatroomMember"),g(V.level)?V.level=0:i("level",V.level,"number","member::markChatroomMember"),this.processCustom(V),this.processCallback(V),this.sendCmd("markChatroomMember",V)},L.kickChatroomMember=function(V){(V=V||{}).done=$({instance:this,className:"ChatroomFn",funcName:"kickChatroomMember",done:V.done}),y(V,"account","member::kickChatroomMember"),this.processCustom(V),this.processCallback(V),this.sendCmd("kickChatroomMember",V)},L.updateChatroomMemberTempMute=function(V){(V=V||{}).done=$({instance:this,className:"ChatroomFn",funcName:"updateChatroomMemberTempMute",done:V.done}),y(V,"account duration needNotify","member::updateChatroomMemberTempMute"),i("duration",V.duration,"number","member::updateChatroomMemberTempMute"),i("needNotify",V.needNotify,"boolean","member::updateChatroomMemberTempMute"),this.processCustom(V),this.processCallback(V),this.sendCmd("updateChatroomMemberTempMute",V)},L.updateTagMembersTempMute=function(V){(V=V||{}).done=$({instance:this,className:"ChatroomFn",funcName:"updateTagMembersTempMute",done:V.done}),y(V,"tag duration needNotify","member::updateTagMembersTempMute"),i("duration",V.duration,"number","member::updateTagMembersTempMute"),i("needNotify",V.needNotify,"boolean","member::updateTagMembersTempMute"),this.processCustom(V),this.processCallback(V);var z=n.filterObj(V,"tag duration custom notifyTargetTags");z.needNotify=V.needNotify?1:0,this.sendCmd("updateTagMembersTempMute",{tagMuteReq:z,callback:V.callback})},L.updateCoordinate=n.throttle(function(V){(V=V||{}).done=$({instance:this,className:"ChatroomFn",funcName:"updateCoordinate",done:V.done});var z=!0;V.x===void 0||V.y===void 0||V.z===void 0?z=!1:(typeof V.x!="number"&&(V.x=0),typeof V.y!="number"&&(V.y=0),typeof V.z!="number"&&(V.z=0)),this.processCallback(V);var re=n.filterObj(V,z?"x y z distance":"distance");this.sendCmd("updateCoordinate",{coordinateReq:re,callback:V.callback})},300,{},function(V){V&&V.done&&V.done({code:416,chatroomId:this.options.chatroomId})}),L.getRobotList=function(V){(V=V||{}).done=$({instance:this,className:"ChatroomFn",funcName:"getRobotList",done:V.done}),this.logger.warn("this api will be abandon"),g(V.timetag)&&(V.timetag=0),this.processCallback(V),this.sendCmd("syncRobot",V)}},function(t,r,e){var n=e(201).fn,g=e(0),y=e(26).reportAPI;n.queueOffer=function(i){(i=i||{}).done=y({instance:this,className:"ChatroomFn",funcName:"queueOffer",done:i.done}),g.verifyOptions(i,"elementKey elementValue","msg::queueOffer");var k={elementKey:i.elementKey,elementValue:i.elementValue,transient:!!i.transient};i.elementAccount&&(k.elementAccount=i.elementAccount),this.processCallback(i),this.sendCmd("queueOffer",k,i.callback)},n.queuePoll=function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};(i=i||{}).done=y({instance:this,className:"ChatroomFn",funcName:"queuePoll",done:i.done}),i.elementKey=i.elementKey||"",this.processCallback(i),this.sendCmd("queuePoll",i,i.callback)},n.queueList=function(i){(i=i||{}).done=y({instance:this,className:"ChatroomFn",funcName:"queueList",done:i.done}),this.processCallback(i),this.sendCmd("queueList",i,i.callback)},n.peak=function(i){(i=i||{}).done=y({instance:this,className:"ChatroomFn",funcName:"peak",done:i.done}),this.processCallback(i),this.sendCmd("peak",i,i.callback)},n.queueDrop=function(i){(i=i||{}).done=y({instance:this,className:"ChatroomFn",funcName:"queueDrop",done:i.done}),this.processCallback(i),this.sendCmd("queueDrop",i,i.callback)},n.queueChange=function(i){(i=i||{}).done=y({instance:this,className:"ChatroomFn",funcName:"queueChange",done:i.done}),g.verifyOptions(i,"elementMap","msg::queueOffer"),i.needNotify?(i.needNotify=!0,g.verifyOptions(i,"notifyExt","msg::queueOffer")):i.needNotify=!1,this.processCallback(i),this.sendCmd("queueChange",i,i.callback)}},,,function(t,r,e){t.exports=e(939)},function(t,r,e){e(305);var n={NIM:e(797),Chatroom:e(909)};e(318)(n),t.exports=n}])})})(NIM_Web_SDK);class NimChatroomSocket{constructor(r){Eu(this,"liveId");Eu(this,"nimChatroomSocket");Eu(this,"onMessage");Eu(this,"handleRoomSocketMessage",r=>{this.onMessage(this,r)});Eu(this,"onConnet",r=>{let e="进入小偶像的直播间成功。";console.log(e),logApi().addSystem(e)});Eu(this,"handleRoomSocketError",(r,e)=>{console.log("发生错误",r,e),logApi().addSystem("发生错误"+r)});Eu(this,"handleRoomSocketDisconnect",r=>{console.log("连接断开",r),logApi().addSystem("直播间连接断开")});this.liveId=r.liveId,this.onMessage=r.onMessage}init(r){logApi().add({content:"由于官方更新过协议，虽然房间功能修复，但是直播间监听功能仍未修复，暂时关闭！",type:"system",color:"red",time:new Date().toLocaleString()})}disconnect(){var r,e;(e=(r=this.nimChatroomSocket)==null?void 0:r.disconnect)==null||e.call(r,{done(){}}),this.nimChatroomSocket=void 0}uuid(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(r){var e=Math.random()*16|0,n=r==="x"?e:e&3|8;return n.toString(16)})}}var QCHAT_BROWSER_SDK={exports:{}};(function(t,r){(function(e,n){t.exports=n()})(commonjsGlobal,function(){var e=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof commonjsGlobal<"u"?commonjsGlobal:typeof self<"u"?self:{};function n(pe){return pe&&pe.__esModule&&Object.prototype.hasOwnProperty.call(pe,"default")?pe.default:pe}function g(pe){var Ne={exports:{}};return pe(Ne,Ne.exports),Ne.exports}var y,i,k=n(g(function(pe){pe.exports=function(kt){if(kt===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return kt},pe.exports.__esModule=!0,pe.exports.default=pe.exports})),L=function(pe){return pe&&pe.Math==Math&&pe},$=L(typeof globalThis=="object"&&globalThis)||L(typeof window=="object"&&window)||L(typeof self=="object"&&self)||L(typeof e=="object"&&e)||function(){return this}()||Function("return this")(),V=function(pe){try{return!!pe()}catch{return!0}},z=!V(function(){var pe=(function(){}).bind();return typeof pe!="function"||pe.hasOwnProperty("prototype")}),re=Function.prototype,oe=re.apply,le=re.call,ue=typeof Reflect=="object"&&Reflect.apply||(z?le.bind(oe):function(){return le.apply(oe,arguments)}),ie=Function.prototype,ae=ie.bind,Ie=ie.call,de=z&&ae.bind(Ie,Ie),Ce=z?function(pe){return pe&&de(pe)}:function(pe){return pe&&function(){return Ie.apply(pe,arguments)}},Ue=function(pe){return typeof pe=="function"},qe=!V(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!=7}),jt=Function.prototype.call,Fe=z?jt.bind(jt):function(){return jt.apply(jt,arguments)},Et={}.propertyIsEnumerable,cr=Object.getOwnPropertyDescriptor,er={f:cr&&!Et.call({1:2},1)?function(Ne){var kt=cr(this,Ne);return!!kt&&kt.enumerable}:Et},nr=function(pe,Ne){return{enumerable:!(1&pe),configurable:!(2&pe),writable:!(4&pe),value:Ne}},dr=Ce({}.toString),ir=Ce("".slice),tr=function(pe){return ir(dr(pe),8,-1)},ur=Object,or=Ce("".split),fr=V(function(){return!ur("z").propertyIsEnumerable(0)})?function(pe){return tr(pe)=="String"?or(pe,""):ur(pe)}:ur,lr=function(pe){return pe==null},gr=TypeError,Sr=function(pe){if(lr(pe))throw gr("Can't call method on "+pe);return pe},wr=function(pe){return fr(Sr(pe))},kr=typeof document=="object"&&document.all,mr=kr===void 0&&kr!==void 0?function(pe){return typeof pe=="object"?pe!==null:Ue(pe)||pe===kr}:function(pe){return typeof pe=="object"?pe!==null:Ue(pe)},Ir={},Nr=function(pe){return Ue(pe)?pe:void 0},Er=function(pe,Ne){return arguments.length<2?Nr(Ir[pe])||Nr($[pe]):Ir[pe]&&Ir[pe][Ne]||$[pe]&&$[pe][Ne]},sr=Ce({}.isPrototypeOf),xr=Er("navigator","userAgent")||"",Or=$.process,Mr=$.Deno,br=Or&&Or.versions||Mr&&Mr.version,hr=br&&br.v8;hr&&(i=(y=hr.split("."))[0]>0&&y[0]<4?1:+(y[0]+y[1])),!i&&xr&&(!(y=xr.match(/Edge\/(\d+)/))||y[1]>=74)&&(y=xr.match(/Chrome\/(\d+)/))&&(i=+y[1]);var Tr,Br=i,Fr=!!Object.getOwnPropertySymbols&&!V(function(){var pe=Symbol();return!String(pe)||!(Object(pe)instanceof Symbol)||!Symbol.sham&&Br&&Br<41}),Lr=Fr&&!Symbol.sham&&typeof Symbol.iterator=="symbol",qr=Object,Ur=Lr?function(pe){return typeof pe=="symbol"}:function(pe){var Ne=Er("Symbol");return Ue(Ne)&&sr(Ne.prototype,qr(pe))},Qr=String,vn=function(pe){try{return Qr(pe)}catch{return"Object"}},_n=TypeError,Yr=function(pe){if(Ue(pe))return pe;throw _n(vn(pe)+" is not a function")},jn=function(pe,Ne){var kt=pe[Ne];return lr(kt)?void 0:Yr(kt)},Zr=TypeError,An=Object.defineProperty,Jr="__core-js_shared__",Mn=$[Jr]||function(pe,Ne){try{An($,pe,{value:Ne,configurable:!0,writable:!0})}catch{$[pe]=Ne}return Ne}(Jr,{}),Bn=g(function(pe){(pe.exports=function(Ne,kt){return Mn[Ne]||(Mn[Ne]=kt!==void 0?kt:{})})("versions",[]).push({version:"3.25.0",mode:"pure",copyright:"© 2014-2022 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.25.0/LICENSE",source:"https://github.com/zloirock/core-js"})}),wn=Object,In=function(pe){return wn(Sr(pe))},bn=Ce({}.hasOwnProperty),hn=Object.hasOwn||function(Ne,kt){return bn(In(Ne),kt)},Zn=0,Oo=Math.random(),Ho=Ce(1 .toString),Do=function(pe){return"Symbol("+(pe===void 0?"":pe)+")_"+Ho(++Zn+Oo,36)},Eo=Bn("wks"),Ko=$.Symbol,Wa=Ko&&Ko.for,Ts=Lr?Ko:Ko&&Ko.withoutSetter||Do,To=function(pe){if(!hn(Eo,pe)||!Fr&&typeof Eo[pe]!="string"){var Ne="Symbol."+pe;Fr&&hn(Ko,pe)?Eo[pe]=Ko[pe]:Eo[pe]=Lr&&Wa?Wa(Ne):Ts(Ne)}return Eo[pe]},Os=TypeError,to=To("toPrimitive"),ha=function(pe,Ne){if(!mr(pe)||Ur(pe))return pe;var kt,$e=jn(pe,to);if($e){if(Ne===void 0&&(Ne="default"),kt=Fe($e,pe,Ne),!mr(kt)||Ur(kt))return kt;throw Os("Can't convert object to primitive value")}return Ne===void 0&&(Ne="number"),function(Oe,Lt){var rr,Pt;if(Lt==="string"&&Ue(rr=Oe.toString)&&!mr(Pt=Fe(rr,Oe))||Ue(rr=Oe.valueOf)&&!mr(Pt=Fe(rr,Oe))||Lt!=="string"&&Ue(rr=Oe.toString)&&!mr(Pt=Fe(rr,Oe)))return Pt;throw Zr("Can't convert object to primitive value")}(pe,Ne)},ca=function(pe){var Ne=ha(pe,"string");return Ur(Ne)?Ne:Ne+""},$a=$.document,Qa=mr($a)&&mr($a.createElement),Xo=function(pe){return Qa?$a.createElement(pe):{}},ko=!qe&&!V(function(){return Object.defineProperty(Xo("div"),"a",{get:function(){return 7}}).a!=7}),ja=Object.getOwnPropertyDescriptor,Da={f:qe?ja:function(Ne,kt){if(Ne=wr(Ne),kt=ca(kt),ko)try{return ja(Ne,kt)}catch{}if(hn(Ne,kt))return nr(!Fe(er.f,Ne,kt),Ne[kt])}},Hc=/#|\.prototype\./,Rs=function(pe,Ne){var kt=Xn[Rn(pe)];return kt==Na||kt!=zo&&(Ue(Ne)?V(Ne):!!Ne)},Rn=Rs.normalize=function(pe){return String(pe).replace(Hc,".").toLowerCase()},Xn=Rs.data={},zo=Rs.NATIVE="N",Na=Rs.POLYFILL="P",vs=Rs,Us=Ce(Ce.bind),Go=function(pe,Ne){return Yr(pe),Ne===void 0?pe:z?Us(pe,Ne):function(){return pe.apply(Ne,arguments)}},Pi=qe&&V(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!=42}),Ti=String,Mp=TypeError,po=function(pe){if(mr(pe))return pe;throw Mp(Ti(pe)+" is not an object")},wb=TypeError,Pu=Object.defineProperty,_b=Object.getOwnPropertyDescriptor,xb="enumerable",Ib="configurable",Eb="writable",Oa={f:qe?Pi?function(Ne,kt,$e){if(po(Ne),kt=ca(kt),po($e),typeof Ne=="function"&&kt==="prototype"&&"value"in $e&&Eb in $e&&!$e.writable){var Oe=_b(Ne,kt);Oe&&Oe.writable&&(Ne[kt]=$e.value,$e={configurable:Ib in $e?$e.configurable:Oe.configurable,enumerable:xb in $e?$e.enumerable:Oe.enumerable,writable:!1})}return Pu(Ne,kt,$e)}:Pu:function(Ne,kt,$e){if(po(Ne),kt=ca(kt),po($e),ko)try{return Pu(Ne,kt,$e)}catch{}if("get"in $e||"set"in $e)throw wb("Accessors not supported");return"value"in $e&&(Ne[kt]=$e.value),Ne}},va=qe?function(pe,Ne,kt){return Oa.f(pe,Ne,nr(1,kt))}:function(pe,Ne,kt){return pe[Ne]=kt,pe},Pb=Da.f,Ab=function(pe){var Ne=function(kt,$e,Oe){if(this instanceof Ne){switch(arguments.length){case 0:return new pe;case 1:return new pe(kt);case 2:return new pe(kt,$e)}return new pe(kt,$e,Oe)}return ue(pe,this,arguments)};return Ne.prototype=pe.prototype,Ne},xn=function(pe,Ne){var kt,$e,Oe,Lt,rr,Pt,pr,yr,Pr=pe.target,Rr=pe.global,Vr=pe.stat,Dr=pe.proto,Xr=Rr?$:Vr?$[Pr]:($[Pr]||{}).prototype,kn=Rr?Ir:Ir[Pr]||va(Ir,Pr,{})[Pr],Tn=kn.prototype;for(Oe in Ne)kt=!vs(Rr?Oe:Pr+(Vr?".":"#")+Oe,pe.forced)&&Xr&&hn(Xr,Oe),rr=kn[Oe],kt&&(Pt=pe.dontCallGetSet?(yr=Pb(Xr,Oe))&&yr.value:Xr[Oe]),Lt=kt&&Pt?Pt:Ne[Oe],kt&&typeof rr==typeof Lt||(pr=pe.bind&&kt?Go(Lt,$):pe.wrap&&kt?Ab(Lt):Dr&&Ue(Lt)?Ce(Lt):Lt,(pe.sham||Lt&&Lt.sham||rr&&rr.sham)&&va(pr,"sham",!0),va(kn,Oe,pr),Dr&&(hn(Ir,$e=Pr+"Prototype")||va(Ir,$e,{}),va(Ir[$e],Oe,Lt),pe.real&&Tn&&!Tn[Oe]&&va(Tn,Oe,Lt)))},Nb=Math.ceil,Ob=Math.floor,Rb=Math.trunc||function(Ne){var kt=+Ne;return(kt>0?Ob:Nb)(kt)},uc=function(pe){var Ne=+pe;return Ne!=Ne||Ne===0?0:Rb(Ne)},Bb=Math.max,Fb=Math.min,Ai=function(pe,Ne){var kt=uc(pe);return kt<0?Bb(kt+Ne,0):Fb(kt,Ne)},Lb=Math.min,Za=function(pe){return(Ne=pe.length)>0?Lb(uc(Ne),9007199254740991):0;var Ne},Bf=function(pe){return function(Ne,kt,$e){var Oe,Lt=wr(Ne),rr=Za(Lt),Pt=Ai($e,rr);if(pe&&kt!=kt){for(;rr>Pt;)if((Oe=Lt[Pt++])!=Oe)return!0}else for(;rr>Pt;Pt++)if((pe||Pt in Lt)&&Lt[Pt]===kt)return pe||Pt||0;return!pe&&-1}},Au={includes:Bf(!0),indexOf:Bf(!1)},Ni={},$b=Au.indexOf,Ff=Ce([].push),Lf=function(pe,Ne){var kt,$e=wr(pe),Oe=0,Lt=[];for(kt in $e)!hn(Ni,kt)&&hn($e,kt)&&Ff(Lt,kt);for(;Ne.length>Oe;)hn($e,kt=Ne[Oe++])&&(~$b(Lt,kt)||Ff(Lt,kt));return Lt},dl=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],Vs=Object.keys||function(Ne){return Lf(Ne,dl)},jb=qe&&!Pi?Object.defineProperties:function(Ne,kt){po(Ne);for(var $e,Oe=wr(kt),Lt=Vs(kt),rr=Lt.length,Pt=0;rr>Pt;)Oa.f(Ne,$e=Lt[Pt++],Oe[$e]);return Ne},$f={f:jb},Nu=Er("document","documentElement"),jf=Bn("keys"),pl=function(pe){return jf[pe]||(jf[pe]=Do(pe))},Df=pl("IE_PROTO"),Ou=function(){},Uf=function(pe){return"<script>"+pe+"<\/script>"},Vf=function(pe){pe.write(Uf("")),pe.close();var Ne=pe.parentWindow.Object;return pe=null,Ne},fl=function(){try{Tr=new ActiveXObject("htmlfile")}catch{}var pe,Ne;fl=typeof document<"u"?document.domain&&Tr?Vf(Tr):((Ne=Xo("iframe")).style.display="none",Nu.appendChild(Ne),Ne.src="javascript:",(pe=Ne.contentWindow.document).open(),pe.write(Uf("document.F=Object")),pe.close(),pe.F):Vf(Tr);for(var kt=dl.length;kt--;)delete fl.prototype[dl[kt]];return fl()};Ni[Df]=!0;var es=Object.create||function(Ne,kt){var $e;return Ne!==null?(Ou.prototype=po(Ne),$e=new Ou,Ou.prototype=null,$e[Df]=Ne):$e=fl(),kt===void 0?$e:$f.f($e,kt)};xn({target:"Object",stat:!0,sham:!qe},{create:es});var Db=Ir.Object,Cs=function(Ne,kt){return Db.create(Ne,kt)},Ub=String,Vb=TypeError,dc=Object.setPrototypeOf||("__proto__"in{}?function(){var pe,Ne=!1,kt={};try{(pe=Ce(Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set))(kt,[]),Ne=kt instanceof Array}catch{}return function(Oe,Lt){return po(Oe),function(rr){if(typeof rr=="object"||Ue(rr))return rr;throw Vb("Can't set "+Ub(rr)+" as a prototype")}(Lt),Ne?pe(Oe,Lt):Oe.__proto__=Lt,Oe}}():void 0);xn({target:"Object",stat:!0},{setPrototypeOf:dc});var si=Ir.Object.setPrototypeOf,qs=Ce([].slice),qf=Function,qb=Ce([].concat),Hb=Ce([].join),Ru={},zb=function(pe,Ne,kt){if(!hn(Ru,Ne)){for(var $e=[],Oe=0;Oe<Ne;Oe++)$e[Oe]="a["+Oe+"]";Ru[Ne]=qf("C,a","return new C("+Hb($e,",")+")")}return Ru[Ne](pe,kt)},Bu=z?qf.bind:function(Ne){var kt=Yr(this),$e=kt.prototype,Oe=qs(arguments,1),Lt=function(){var Pt=qb(Oe,qs(arguments));return this instanceof Lt?zb(kt,Pt.length,Pt):kt.apply(Ne,Pt)};return mr($e)&&(Lt.prototype=$e),Lt};xn({target:"Function",proto:!0,forced:Function.bind!==Bu},{bind:Bu});var sa=function(pe){return Ir[pe+"Prototype"]},Wb=sa("Function").bind,Fu=Function.prototype,Zo=function(pe){var Ne=pe.bind;return pe===Fu||sr(Fu,pe)&&Ne===Fu.bind?Wb:Ne},Lu=g(function(pe){function Ne(kt,$e){var Oe;return pe.exports=Ne=si?Zo(Oe=si).call(Oe):function(rr,Pt){return rr.__proto__=Pt,rr},pe.exports.__esModule=!0,pe.exports.default=pe.exports,Ne(kt,$e)}pe.exports=Ne,pe.exports.__esModule=!0,pe.exports.default=pe.exports}),ea=n(g(function(pe){pe.exports=function(kt,$e){kt.prototype=Cs($e.prototype),kt.prototype.constructor=kt,Lu(kt,$e)},pe.exports.__esModule=!0,pe.exports.default=pe.exports})),Ms=Array.isArray||function(Ne){return tr(Ne)=="Array"},Gb=TypeError,$u=function(pe){if(pe>9007199254740991)throw Gb("Maximum allowed index exceeded");return pe},ii=function(pe,Ne,kt){var $e=ca(Ne);$e in pe?Oa.f(pe,$e,nr(0,kt)):pe[$e]=kt},Hf={};Hf[To("toStringTag")]="z";var ju=String(Hf)==="[object z]",Kb=To("toStringTag"),Qb=Object,Jb=tr(function(){return arguments}())=="Arguments",ci=ju?tr:function(pe){var Ne,kt,$e;return pe===void 0?"Undefined":pe===null?"Null":typeof(kt=function(Oe,Lt){try{return Oe[Lt]}catch{}}(Ne=Qb(pe),Kb))=="string"?kt:Jb?tr(Ne):($e=tr(Ne))=="Object"&&Ue(Ne.callee)?"Arguments":$e},Yb=Ce(Function.toString);Ue(Mn.inspectSource)||(Mn.inspectSource=function(pe){return Yb(pe)});var zf=Mn.inspectSource,Wf=function(){},Xb=[],Gf=Er("Reflect","construct"),Du=/^\s*(?:class|function)\b/,Zb=Ce(Du.exec),e0=!Du.exec(Wf),pc=function(Ne){if(!Ue(Ne))return!1;try{return Gf(Wf,Xb,Ne),!0}catch{return!1}},Kf=function(Ne){if(!Ue(Ne))return!1;switch(ci(Ne)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return e0||!!Zb(Du,zf(Ne))}catch{return!0}};Kf.sham=!0;var ml=!Gf||V(function(){var pe;return pc(pc.call)||!pc(Object)||!pc(function(){pe=!0})||pe})?Kf:pc,t0=To("species"),Qf=Array,Uu=function(pe,Ne){return new(function(kt){var $e;return Ms(kt)&&($e=kt.constructor,(ml($e)&&($e===Qf||Ms($e.prototype))||mr($e)&&($e=$e[t0])===null)&&($e=void 0)),$e===void 0?Qf:$e}(pe))(Ne===0?0:Ne)},r0=To("species"),fc=function(pe){return Br>=51||!V(function(){var Ne=[];return(Ne.constructor={})[r0]=function(){return{foo:1}},Ne[pe](Boolean).foo!==1})},Jf=To("isConcatSpreadable"),n0=Br>=51||!V(function(){var pe=[];return pe[Jf]=!1,pe.concat()[0]!==pe}),o0=fc("concat"),a0=function(pe){if(!mr(pe))return!1;var Ne=pe[Jf];return Ne!==void 0?!!Ne:Ms(pe)};xn({target:"Array",proto:!0,arity:1,forced:!n0||!o0},{concat:function(Ne){var kt,$e,Oe,Lt,rr,Pt=In(this),pr=Uu(Pt,0),yr=0;for(kt=-1,Oe=arguments.length;kt<Oe;kt++)if(a0(rr=kt===-1?Pt:arguments[kt]))for(Lt=Za(rr),$u(yr+Lt),$e=0;$e<Lt;$e++,yr++)$e in rr&&ii(pr,yr,rr[$e]);else $u(yr+1),ii(pr,yr++,rr);return pr.length=yr,pr}});var gl,mc,hl,s0=String,rs=function(pe){if(ci(pe)==="Symbol")throw TypeError("Cannot convert a Symbol value to a string");return s0(pe)},i0=dl.concat("length","prototype"),gc={f:Object.getOwnPropertyNames||function(Ne){return Lf(Ne,i0)}},c0=Array,l0=Math.max,Vu=function(pe,Ne,kt){for(var $e=Za(pe),Oe=Ai(Ne,$e),Lt=Ai(kt===void 0?$e:kt,$e),rr=c0(l0(Lt-Oe,0)),Pt=0;Oe<Lt;Oe++,Pt++)ii(rr,Pt,pe[Oe]);return rr.length=Pt,rr},Yf=gc.f,Xf=typeof window=="object"&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],qu={f:function(Ne){return Xf&&tr(Ne)=="Window"?function(kt){try{return Yf(kt)}catch{return Vu(Xf)}}(Ne):Yf(wr(Ne))}},hc={f:Object.getOwnPropertySymbols},Hs=function(pe,Ne,kt,$e){return $e&&$e.enumerable?pe[Ne]=kt:va(pe,Ne,kt),pe},Hu={f:To},u0=Oa.f,Vo=function(pe){var Ne=Ir.Symbol||(Ir.Symbol={});hn(Ne,pe)||u0(Ne,pe,{value:Hu.f(pe)})},Zf=function(){var pe=Er("Symbol"),Ne=pe&&pe.prototype,kt=Ne&&Ne.valueOf,$e=To("toPrimitive");Ne&&!Ne[$e]&&Hs(Ne,$e,function(Oe){return Fe(kt,this)},{arity:1})},d0=ju?{}.toString:function(){return"[object "+ci(this)+"]"},p0=Oa.f,em=To("toStringTag"),li=function(pe,Ne,kt,$e){if(pe){var Oe=kt?pe:pe.prototype;hn(Oe,em)||p0(Oe,em,{configurable:!0,value:Ne}),$e&&!ju&&va(Oe,"toString",d0)}},tm=$.WeakMap,f0=Ue(tm)&&/native code/.test(String(tm)),rm="Object already initialized",zu=$.TypeError,m0=$.WeakMap;if(f0||Mn.state){var ui=Mn.state||(Mn.state=new m0),g0=Ce(ui.get),nm=Ce(ui.has),h0=Ce(ui.set);gl=function(pe,Ne){if(nm(ui,pe))throw zu(rm);return Ne.facade=pe,h0(ui,pe,Ne),Ne},mc=function(pe){return g0(ui,pe)||{}},hl=function(pe){return nm(ui,pe)}}else{var Oi=pl("state");Ni[Oi]=!0,gl=function(pe,Ne){if(hn(pe,Oi))throw zu(rm);return Ne.facade=pe,va(pe,Oi,Ne),Ne},mc=function(pe){return hn(pe,Oi)?pe[Oi]:{}},hl=function(pe){return hn(pe,Oi)}}var ts={set:gl,get:mc,has:hl,enforce:function(pe){return hl(pe)?mc(pe):gl(pe,{})},getterFor:function(pe){return function(Ne){var kt;if(!mr(Ne)||(kt=mc(Ne)).type!==pe)throw zu("Incompatible receiver, "+pe+" required");return kt}}},om=Ce([].push),zs=function(pe){var Ne=pe==1,kt=pe==2,$e=pe==3,Oe=pe==4,Lt=pe==6,rr=pe==7,Pt=pe==5||Lt;return function(pr,yr,Pr,Rr){for(var Vr,Dr,Xr=In(pr),kn=fr(Xr),Tn=Go(yr,Pr),Dn=Za(kn),Fn=0,Gn=Rr||Uu,$n=Ne?Gn(pr,Dn):kt||rr?Gn(pr,0):void 0;Dn>Fn;Fn++)if((Pt||Fn in kn)&&(Dr=Tn(Vr=kn[Fn],Fn,Xr),pe))if(Ne)$n[Fn]=Dr;else if(Dr)switch(pe){case 3:return!0;case 5:return Vr;case 6:return Fn;case 2:om($n,Vr)}else switch(pe){case 4:return!1;case 7:om($n,Vr)}return Lt?-1:$e||Oe?Oe:$n}},Ws={forEach:zs(0),map:zs(1),filter:zs(2),some:zs(3),every:zs(4),find:zs(5),findIndex:zs(6),filterReject:zs(7)},vl=Ws.forEach,Ra=pl("hidden"),yl="Symbol",v0=ts.set,am=ts.getterFor(yl),as=Object.prototype,di=$.Symbol,vc=di&&di.prototype,y0=$.TypeError,Wu=$.QObject,sm=Da.f,Gs=Oa.f,im=qu.f,b0=er.f,cm=Ce([].push),ks=Bn("symbols"),yc=Bn("op-symbols"),S0=Bn("wks"),Gu=!Wu||!Wu.prototype||!Wu.prototype.findChild,Ku=qe&&V(function(){return es(Gs({},"a",{get:function(){return Gs(this,"a",{value:7}).a}})).a!=7})?function(pe,Ne,kt){var $e=sm(as,Ne);$e&&delete as[Ne],Gs(pe,Ne,kt),$e&&pe!==as&&Gs(as,Ne,$e)}:Gs,Qu=function(pe,Ne){var kt=ks[pe]=es(vc);return v0(kt,{type:yl,tag:pe,description:Ne}),qe||(kt.description=Ne),kt},bl=function(Ne,kt,$e){Ne===as&&bl(yc,kt,$e),po(Ne);var Oe=ca(kt);return po($e),hn(ks,Oe)?($e.enumerable?(hn(Ne,Ra)&&Ne[Ra][Oe]&&(Ne[Ra][Oe]=!1),$e=es($e,{enumerable:nr(0,!1)})):(hn(Ne,Ra)||Gs(Ne,Ra,nr(1,{})),Ne[Ra][Oe]=!0),Ku(Ne,Oe,$e)):Gs(Ne,Oe,$e)},Ju=function(Ne,kt){po(Ne);var $e=wr(kt),Oe=Vs($e).concat(pm($e));return vl(Oe,function(Lt){qe&&!Fe(lm,$e,Lt)||bl(Ne,Lt,$e[Lt])}),Ne},lm=function(Ne){var kt=ca(Ne),$e=Fe(b0,this,kt);return!(this===as&&hn(ks,kt)&&!hn(yc,kt))&&(!($e||!hn(this,kt)||!hn(ks,kt)||hn(this,Ra)&&this[Ra][kt])||$e)},um=function(Ne,kt){var $e=wr(Ne),Oe=ca(kt);if($e!==as||!hn(ks,Oe)||hn(yc,Oe)){var Lt=sm($e,Oe);return!Lt||!hn(ks,Oe)||hn($e,Ra)&&$e[Ra][Oe]||(Lt.enumerable=!0),Lt}},dm=function(Ne){var kt=im(wr(Ne)),$e=[];return vl(kt,function(Oe){hn(ks,Oe)||hn(Ni,Oe)||cm($e,Oe)}),$e},pm=function(pe){var Ne=pe===as,kt=im(Ne?yc:wr(pe)),$e=[];return vl(kt,function(Oe){!hn(ks,Oe)||Ne&&!hn(as,Oe)||cm($e,ks[Oe])}),$e};Fr||(di=function(){if(sr(vc,this))throw y0("Symbol is not a constructor");var Ne=arguments.length&&arguments[0]!==void 0?rs(arguments[0]):void 0,kt=Do(Ne),$e=function(Oe){this===as&&Fe($e,yc,Oe),hn(this,Ra)&&hn(this[Ra],kt)&&(this[Ra][kt]=!1),Ku(this,kt,nr(1,Oe))};return qe&&Gu&&Ku(as,kt,{configurable:!0,set:$e}),Qu(kt,Ne)},vc=di.prototype,Hs(vc,"toString",function(){return am(this).tag}),Hs(di,"withoutSetter",function(pe){return Qu(Do(pe),pe)}),er.f=lm,Oa.f=bl,$f.f=Ju,Da.f=um,gc.f=qu.f=dm,hc.f=pm,Hu.f=function(pe){return Qu(To(pe),pe)},qe&&Gs(vc,"description",{configurable:!0,get:function(){return am(this).description}})),xn({global:!0,constructor:!0,wrap:!0,forced:!Fr,sham:!Fr},{Symbol:di}),vl(Vs(S0),function(pe){Vo(pe)}),xn({target:yl,stat:!0,forced:!Fr},{useSetter:function(){Gu=!0},useSimple:function(){Gu=!1}}),xn({target:"Object",stat:!0,forced:!Fr,sham:!qe},{create:function(Ne,kt){return kt===void 0?es(Ne):Ju(es(Ne),kt)},defineProperty:bl,defineProperties:Ju,getOwnPropertyDescriptor:um}),xn({target:"Object",stat:!0,forced:!Fr},{getOwnPropertyNames:dm}),Zf(),li(di,yl),Ni[Ra]=!0;var fm=Fr&&!!Symbol.for&&!!Symbol.keyFor,Yu=Bn("string-to-symbol-registry"),T0=Bn("symbol-to-string-registry");xn({target:"Symbol",stat:!0,forced:!fm},{for:function(pe){var Ne=rs(pe);if(hn(Yu,Ne))return Yu[Ne];var kt=Er("Symbol")(Ne);return Yu[Ne]=kt,T0[kt]=Ne,kt}});var mm=Bn("symbol-to-string-registry");xn({target:"Symbol",stat:!0,forced:!fm},{keyFor:function(Ne){if(!Ur(Ne))throw TypeError(vn(Ne)+" is not a symbol");if(hn(mm,Ne))return mm[Ne]}});var Ks=Er("JSON","stringify"),Sl=Ce(/./.exec),gm=Ce("".charAt),C0=Ce("".charCodeAt),M0=Ce("".replace),k0=Ce(1 .toString),w0=/[\uD800-\uDFFF]/g,hm=/^[\uD800-\uDBFF]$/,vm=/^[\uDC00-\uDFFF]$/,ym=!Fr||V(function(){var pe=Er("Symbol")();return Ks([pe])!="[null]"||Ks({a:pe})!="{}"||Ks(Object(pe))!="{}"}),bm=V(function(){return Ks("\uDF06\uD834")!=='"\\udf06\\ud834"'||Ks("\uDEAD")!=='"\\udead"'}),_0=function(pe,Ne){var kt=qs(arguments),$e=Ne;if((mr(Ne)||pe!==void 0)&&!Ur(pe))return Ms(Ne)||(Ne=function(Oe,Lt){if(Ue($e)&&(Lt=Fe($e,this,Oe,Lt)),!Ur(Lt))return Lt}),kt[1]=Ne,ue(Ks,null,kt)},x0=function(pe,Ne,kt){var $e=gm(kt,Ne-1),Oe=gm(kt,Ne+1);return Sl(hm,pe)&&!Sl(vm,Oe)||Sl(vm,pe)&&!Sl(hm,$e)?"\\u"+k0(C0(pe,0),16):pe};Ks&&xn({target:"JSON",stat:!0,arity:3,forced:ym||bm},{stringify:function(Ne,kt,$e){var Oe=qs(arguments),Lt=ue(ym?_0:Ks,null,Oe);return bm&&typeof Lt=="string"?M0(Lt,w0,x0):Lt}});var I0=!Fr||V(function(){hc.f(1)});xn({target:"Object",stat:!0,forced:I0},{getOwnPropertySymbols:function(Ne){var kt=hc.f;return kt?kt(In(Ne)):[]}}),Vo("asyncIterator"),Vo("hasInstance"),Vo("isConcatSpreadable"),Vo("iterator"),Vo("match"),Vo("matchAll"),Vo("replace"),Vo("search"),Vo("species"),Vo("split"),Vo("toPrimitive"),Zf(),Vo("toStringTag"),li(Er("Symbol"),"Symbol"),Vo("unscopables"),li($.JSON,"JSON",!0);var Qs,Sm,Tm,E0=Ir.Symbol,ws={},Cm=Function.prototype,P0=qe&&Object.getOwnPropertyDescriptor,Xu=hn(Cm,"name"),A0={EXISTS:Xu,PROPER:Xu&&(function(){}).name==="something",CONFIGURABLE:Xu&&(!qe||qe&&P0(Cm,"name").configurable)},Mm=!V(function(){function pe(){}return pe.prototype.constructor=null,Object.getPrototypeOf(new pe)!==pe.prototype}),km=pl("IE_PROTO"),Zu=Object,N0=Zu.prototype,Ri=Mm?Zu.getPrototypeOf:function(pe){var Ne=In(pe);if(hn(Ne,km))return Ne[km];var kt=Ne.constructor;return Ue(kt)&&Ne instanceof kt?kt.prototype:Ne instanceof Zu?N0:null},ed=To("iterator"),wm=!1;[].keys&&("next"in(Tm=[].keys())?(Sm=Ri(Ri(Tm)))!==Object.prototype&&(Qs=Sm):wm=!0);var O0=!mr(Qs)||V(function(){var pe={};return Qs[ed].call(pe)!==pe});Qs=O0?{}:es(Qs),Ue(Qs[ed])||Hs(Qs,ed,function(){return this});var _m={IteratorPrototype:Qs,BUGGY_SAFARI_ITERATORS:wm},R0=_m.IteratorPrototype,B0=function(){return this},F0=A0.PROPER,Tl=_m.BUGGY_SAFARI_ITERATORS,td=To("iterator"),xm="keys",Cl="values",Im="entries",L0=function(){return this},rd=function(pe,Ne,kt,$e,Oe,Lt,rr){(function(Dn,Fn,Gn,$n){var ho=Fn+" Iterator";Dn.prototype=es(R0,{next:nr(+!$n,Gn)}),li(Dn,ho,!1,!0),ws[ho]=B0})(kt,Ne,$e);var Pt,pr,yr,Pr=function(Dn){if(Dn===Oe&&kn)return kn;if(!Tl&&Dn in Dr)return Dr[Dn];switch(Dn){case xm:return function(){return new kt(this,Dn)};case Cl:return function(){return new kt(this,Dn)};case Im:return function(){return new kt(this,Dn)}}return function(){return new kt(this)}},Rr=Ne+" Iterator",Vr=!1,Dr=pe.prototype,Xr=Dr[td]||Dr["@@iterator"]||Oe&&Dr[Oe],kn=!Tl&&Xr||Pr(Oe),Tn=Ne=="Array"&&Dr.entries||Xr;if(Tn&&(Pt=Ri(Tn.call(new pe)))!==Object.prototype&&Pt.next&&(li(Pt,Rr,!0,!0),ws[Rr]=L0),F0&&Oe==Cl&&Xr&&Xr.name!==Cl&&(Vr=!0,kn=function(){return Fe(Xr,this)}),Oe)if(pr={values:Pr(Cl),keys:Lt?kn:Pr(xm),entries:Pr(Im)},rr)for(yr in pr)(Tl||Vr||!(yr in Dr))&&Hs(Dr,yr,pr[yr]);else xn({target:Ne,proto:!0,forced:Tl||Vr},pr);return rr&&Dr[td]!==kn&&Hs(Dr,td,kn,{name:Oe}),ws[Ne]=kn,pr};Oa.f;var Em="Array Iterator",$0=ts.set,j0=ts.getterFor(Em);rd(Array,"Array",function(pe,Ne){$0(this,{type:Em,target:wr(pe),index:0,kind:Ne})},function(){var pe=j0(this),Ne=pe.target,kt=pe.kind,$e=pe.index++;return!Ne||$e>=Ne.length?(pe.target=void 0,{value:void 0,done:!0}):kt=="keys"?{value:$e,done:!1}:kt=="values"?{value:Ne[$e],done:!1}:{value:[$e,Ne[$e]],done:!1}},"values"),ws.Arguments=ws.Array;var Pm=To("toStringTag");for(var nd in{CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}){var Am=$[nd],od=Am&&Am.prototype;od&&ci(od)!==Pm&&va(od,Pm,nd),ws[nd]=ws.Array}var D0=E0;Vo("asyncDispose"),Vo("dispose"),Vo("matcher"),Vo("metadataKey"),Vo("observable"),Vo("metadata"),Vo("patternMatch"),Vo("replaceAll");var Ua=D0,U0=Ce("".charAt),Nm=Ce("".charCodeAt),V0=Ce("".slice),Om=function(pe){return function(Ne,kt){var $e,Oe,Lt=rs(Sr(Ne)),rr=uc(kt),Pt=Lt.length;return rr<0||rr>=Pt?pe?"":void 0:($e=Nm(Lt,rr))<55296||$e>56319||rr+1===Pt||(Oe=Nm(Lt,rr+1))<56320||Oe>57343?pe?U0(Lt,rr):$e:pe?V0(Lt,rr,rr+2):Oe-56320+($e-55296<<10)+65536}},q0={codeAt:Om(!1),charAt:Om(!0)}.charAt,Rm="String Iterator",H0=ts.set,z0=ts.getterFor(Rm);rd(String,"String",function(pe){H0(this,{type:Rm,string:rs(pe),index:0})},function(){var Ne,kt=z0(this),$e=kt.string,Oe=kt.index;return Oe>=$e.length?{value:void 0,done:!0}:(Ne=q0($e,Oe),kt.index+=Ne.length,{value:Ne,done:!1})});var Bm=Hu.f("iterator"),W0=g(function(pe){function Ne(kt){return pe.exports=Ne=typeof Ua=="function"&&typeof Bm=="symbol"?function($e){return typeof $e}:function($e){return $e&&typeof Ua=="function"&&$e.constructor===Ua&&$e!==Ua.prototype?"symbol":typeof $e},pe.exports.__esModule=!0,pe.exports.default=pe.exports,Ne(kt)}pe.exports=Ne,pe.exports.__esModule=!0,pe.exports.default=pe.exports}),Fm=Oa.f;xn({target:"Object",stat:!0,forced:Object.defineProperty!==Fm,sham:!qe},{defineProperty:Fm});var G0=g(function(pe){var Ne=Ir.Object,kt=pe.exports=function(Oe,Lt,rr){return Ne.defineProperty(Oe,Lt,rr)};Ne.defineProperty.sham&&(kt.sham=!0)}),bc=G0,K0=V(function(){Ri(1)});xn({target:"Object",stat:!0,forced:K0,sham:!Mm},{getPrototypeOf:function(Ne){return Ri(In(Ne))}});var pi=Ir.Object.getPrototypeOf,fi=function(pe,Ne){var kt=[][pe];return!!kt&&V(function(){kt.call(null,Ne||function(){return 1},1)})},Q0=Ws.forEach,Lm=fi("forEach")?[].forEach:function(Ne){return Q0(this,Ne,arguments.length>1?arguments[1]:void 0)};xn({target:"Array",proto:!0,forced:[].forEach!=Lm},{forEach:Lm});var J0=sa("Array").forEach,ad=Array.prototype,Y0={DOMTokenList:!0,NodeList:!0},Qn=function(pe){var Ne=pe.forEach;return pe===ad||sr(ad,pe)&&Ne===ad.forEach||hn(Y0,ci(pe))?J0:Ne},X0=Ce([].concat),Z0=Er("Reflect","ownKeys")||function(Ne){var kt=gc.f(po(Ne)),$e=hc.f;return $e?X0(kt,$e(Ne)):kt},$m=Error,e1=Ce("".replace),t1=String($m("zxcasd").stack),jm=/\n\s*at [^:]*:[^\n]*/,r1=jm.test(t1),n1=function(pe,Ne){if(r1&&typeof pe=="string"&&!$m.prepareStackTrace)for(;Ne--;)pe=e1(pe,jm,"");return pe},o1=function(pe,Ne){mr(Ne)&&"cause"in Ne&&va(pe,"cause",Ne.cause)},a1=To("iterator"),s1=Array.prototype,Dm=function(pe){return pe!==void 0&&(ws.Array===pe||s1[a1]===pe)},i1=To("iterator"),Ml=function(pe){if(!lr(pe))return jn(pe,i1)||jn(pe,"@@iterator")||ws[ci(pe)]},c1=TypeError,Sc=function(pe,Ne){var kt=arguments.length<2?Ml(pe):Ne;if(Yr(kt))return po(Fe(kt,pe));throw c1(vn(pe)+" is not iterable")},sd=function(pe,Ne,kt){var $e,Oe;po(pe);try{if(!($e=jn(pe,"return"))){if(Ne==="throw")throw kt;return kt}$e=Fe($e,pe)}catch(Lt){Oe=!0,$e=Lt}if(Ne==="throw")throw kt;if(Oe)throw $e;return po($e),kt},l1=TypeError,kl=function(pe,Ne){this.stopped=pe,this.result=Ne},Um=kl.prototype,_o=function(pe,Ne,kt){var $e,Oe,Lt,rr,Pt,pr,yr,Pr=kt&&kt.that,Rr=!(!kt||!kt.AS_ENTRIES),Vr=!(!kt||!kt.IS_RECORD),Dr=!(!kt||!kt.IS_ITERATOR),Xr=!(!kt||!kt.INTERRUPTED),kn=Go(Ne,Pr),Tn=function(Fn){return $e&&sd($e,"normal",Fn),new kl(!0,Fn)},Dn=function(Fn){return Rr?(po(Fn),Xr?kn(Fn[0],Fn[1],Tn):kn(Fn[0],Fn[1])):Xr?kn(Fn,Tn):kn(Fn)};if(Vr)$e=pe.iterator;else if(Dr)$e=pe;else{if(!(Oe=Ml(pe)))throw l1(vn(pe)+" is not iterable");if(Dm(Oe)){for(Lt=0,rr=Za(pe);rr>Lt;Lt++)if((Pt=Dn(pe[Lt]))&&sr(Um,Pt))return Pt;return new kl(!1)}$e=Sc(pe,Oe)}for(pr=Vr?pe.next:$e.next;!(yr=Fe(pr,$e)).done;){try{Pt=Dn(yr.value)}catch(Fn){sd($e,"throw",Fn)}if(typeof Pt=="object"&&Pt&&sr(Um,Pt))return Pt}return new kl(!1)},u1=function(pe,Ne){return pe===void 0?arguments.length<2?"":Ne:rs(pe)},d1=!V(function(){var pe=Error("a");return!("stack"in pe)||(Object.defineProperty(pe,"stack",nr(1,7)),pe.stack!==7)}),p1=To("toStringTag"),wl=Error,f1=[].push,Tc=function(Ne,kt){var $e,Oe=arguments.length>2?arguments[2]:void 0,Lt=sr(id,this);dc?$e=dc(wl(),Lt?Ri(this):id):($e=Lt?this:es(id),va($e,p1,"Error")),kt!==void 0&&va($e,"message",u1(kt)),d1&&va($e,"stack",n1($e.stack,1)),o1($e,Oe);var rr=[];return _o(Ne,f1,{that:rr}),va($e,"errors",rr),$e};dc?dc(Tc,wl):function(pe,Ne,kt){for(var $e=Z0(Ne),Oe=Oa.f,Lt=Da.f,rr=0;rr<$e.length;rr++){var Pt=$e[rr];hn(pe,Pt)||kt&&hn(kt,Pt)||Oe(pe,Pt,Lt(Ne,Pt))}}(Tc,wl,{name:!0});var id=Tc.prototype=es(wl.prototype,{constructor:nr(1,Tc),message:nr(1,""),name:nr(1,"AggregateError")});xn({global:!0,constructor:!0,arity:2},{AggregateError:Tc});var Cc,Bi,Vm,cd,ds=tr($.process)=="process",qm=To("species"),Hm=function(pe){var Ne=Er(pe),kt=Oa.f;qe&&Ne&&!Ne[qm]&&kt(Ne,qm,{configurable:!0,get:function(){return this}})},m1=TypeError,ld=function(pe,Ne){if(sr(Ne,pe))return pe;throw m1("Incorrect invocation")},g1=TypeError,_l=function(pe){if(ml(pe))return pe;throw g1(vn(pe)+" is not a constructor")},h1=To("species"),Js=function(pe,Ne){var kt,$e=po(pe).constructor;return $e===void 0||lr(kt=po($e)[h1])?Ne:_l(kt)},v1=TypeError,zm=function(pe,Ne){if(pe<Ne)throw v1("Not enough arguments");return pe},Wm=/(?:ipad|iphone|ipod).*applewebkit/i.test(xr),ud=$.setImmediate,dd=$.clearImmediate,y1=$.process,pd=$.Dispatch,b1=$.Function,Gm=$.MessageChannel,S1=$.String,fd=0,Mc={},T1="onreadystatechange";try{Cc=$.location}catch{}var md=function(pe){if(hn(Mc,pe)){var Ne=Mc[pe];delete Mc[pe],Ne()}},gd=function(pe){return function(){md(pe)}},Km=function(pe){md(pe.data)},Qm=function(pe){$.postMessage(S1(pe),Cc.protocol+"//"+Cc.host)};ud&&dd||(ud=function(Ne){zm(arguments.length,1);var kt=Ue(Ne)?Ne:b1(Ne),$e=qs(arguments,1);return Mc[++fd]=function(){ue(kt,void 0,$e)},Bi(fd),fd},dd=function(Ne){delete Mc[Ne]},ds?Bi=function(pe){y1.nextTick(gd(pe))}:pd&&pd.now?Bi=function(pe){pd.now(gd(pe))}:Gm&&!Wm?(cd=(Vm=new Gm).port2,Vm.port1.onmessage=Km,Bi=Go(cd.postMessage,cd)):$.addEventListener&&Ue($.postMessage)&&!$.importScripts&&Cc&&Cc.protocol!=="file:"&&!V(Qm)?(Bi=Qm,$.addEventListener("message",Km,!1)):Bi=T1 in Xo("script")?function(pe){Nu.appendChild(Xo("script")).onreadystatechange=function(){Nu.removeChild(this),md(pe)}}:function(pe){setTimeout(gd(pe),0)});var kc,mi,wc,Fi,hd,vd,yd,Jm,Ym={set:ud,clear:dd},C1=/ipad|iphone|ipod/i.test(xr)&&$.Pebble!==void 0,M1=/web0s(?!.*chrome)/i.test(xr),k1=Da.f,bd=Ym.set,Xm=$.MutationObserver||$.WebKitMutationObserver,Zm=$.document,eg=$.process,xl=$.Promise,tg=k1($,"queueMicrotask"),rg=tg&&tg.value;rg||(kc=function(){var pe,Ne;for(ds&&(pe=eg.domain)&&pe.exit();mi;){Ne=mi.fn,mi=mi.next;try{Ne()}catch(kt){throw mi?Fi():wc=void 0,kt}}wc=void 0,pe&&pe.enter()},Wm||ds||M1||!Xm||!Zm?!C1&&xl&&xl.resolve?((yd=xl.resolve(void 0)).constructor=xl,Jm=Go(yd.then,yd),Fi=function(){Jm(kc)}):ds?Fi=function(){eg.nextTick(kc)}:(bd=Go(bd,$),Fi=function(){bd(kc)}):(hd=!0,vd=Zm.createTextNode(""),new Xm(kc).observe(vd,{characterData:!0}),Fi=function(){vd.data=hd=!hd}));var Sd=rg||function(pe){var Ne={fn:pe,next:void 0};wc&&(wc.next=Ne),mi||(mi=Ne,Fi()),wc=Ne},Li=function(pe){try{return{error:!1,value:pe()}}catch(Ne){return{error:!0,value:Ne}}},ng=function(){this.head=null,this.tail=null};ng.prototype={add:function(pe){var Ne={item:pe,next:null};this.head?this.tail.next=Ne:this.head=Ne,this.tail=Ne},get:function(){var pe=this.head;if(pe)return this.head=pe.next,this.tail===pe&&(this.tail=null),pe.item}};var Td,og,w1=ng,Ma=$.Promise,ag=typeof Deno=="object"&&Deno&&typeof Deno.version=="object",_1=!ag&&!ds&&typeof window=="object"&&typeof document=="object",sg=Ma&&Ma.prototype,x1=To("species"),ig=!1,cg=Ue($.PromiseRejectionEvent),I1=vs("Promise",function(){var pe=zf(Ma),Ne=pe!==String(Ma);if(!Ne&&Br===66||!sg.catch||!sg.finally)return!0;if(!Br||Br<51||!/native code/.test(pe)){var kt=new Ma(function(Oe){Oe(1)}),$e=function(Oe){Oe(function(){},function(){})};if((kt.constructor={})[x1]=$e,!(ig=kt.then(function(){})instanceof $e))return!0}return!Ne&&(_1||ag)&&!cg}),$i={CONSTRUCTOR:I1,REJECTION_EVENT:cg,SUBCLASSING:ig},E1=TypeError,P1=function(pe){var Ne,kt;this.promise=new pe(function($e,Oe){if(Ne!==void 0||kt!==void 0)throw E1("Bad Promise constructor");Ne=$e,kt=Oe}),this.resolve=Yr(Ne),this.reject=Yr(kt)},_s={f:function(pe){return new P1(pe)}},lg=Ym.set,Il="Promise",ug=$i.CONSTRUCTOR,A1=$i.REJECTION_EVENT,Cd=ts.getterFor(Il),N1=ts.set,O1=Ma&&Ma.prototype,_c=Ma,Md=O1,dg=$.TypeError,kd=$.document,wd=$.process,_d=_s.f,R1=_d,B1=!!(kd&&kd.createEvent&&$.dispatchEvent),pg="unhandledrejection",fg=function(pe){var Ne;return!(!mr(pe)||!Ue(Ne=pe.then))&&Ne},mg=function(pe,Ne){var kt,$e,Oe,Lt=Ne.value,rr=Ne.state==1,Pt=rr?pe.ok:pe.fail,pr=pe.resolve,yr=pe.reject,Pr=pe.domain;try{Pt?(rr||(Ne.rejection===2&&L1(Ne),Ne.rejection=1),Pt===!0?kt=Lt:(Pr&&Pr.enter(),kt=Pt(Lt),Pr&&(Pr.exit(),Oe=!0)),kt===pe.promise?yr(dg("Promise-chain cycle")):($e=fg(kt))?Fe($e,kt,pr,yr):pr(kt)):yr(Lt)}catch(Rr){Pr&&!Oe&&Pr.exit(),yr(Rr)}},gg=function(pe,Ne){pe.notified||(pe.notified=!0,Sd(function(){for(var kt,$e=pe.reactions;kt=$e.get();)mg(kt,pe);pe.notified=!1,Ne&&!pe.rejection&&F1(pe)}))},hg=function(pe,Ne,kt){var $e,Oe;B1?(($e=kd.createEvent("Event")).promise=Ne,$e.reason=kt,$e.initEvent(pe,!1,!0),$.dispatchEvent($e)):$e={promise:Ne,reason:kt},!A1&&(Oe=$["on"+pe])?Oe($e):pe===pg&&function(Lt,rr){var Pt=$.console;Pt&&Pt.error&&(arguments.length==1?Pt.error(Lt):Pt.error(Lt,rr))}("Unhandled promise rejection",kt)},F1=function(pe){Fe(lg,$,function(){var Ne,kt=pe.facade,$e=pe.value;if(vg(pe)&&(Ne=Li(function(){ds?wd.emit("unhandledRejection",$e,kt):hg(pg,kt,$e)}),pe.rejection=ds||vg(pe)?2:1,Ne.error))throw Ne.value})},vg=function(pe){return pe.rejection!==1&&!pe.parent},L1=function(pe){Fe(lg,$,function(){var Ne=pe.facade;ds?wd.emit("rejectionHandled",Ne):hg("rejectionhandled",Ne,pe.value)})},ji=function(pe,Ne,kt){return function($e){pe(Ne,$e,kt)}},Di=function(pe,Ne,kt){pe.done||(pe.done=!0,kt&&(pe=kt),pe.value=Ne,pe.state=2,gg(pe,!0))},xd=function(pe,Ne,kt){if(!pe.done){pe.done=!0,kt&&(pe=kt);try{if(pe.facade===Ne)throw dg("Promise can't be resolved itself");var $e=fg(Ne);$e?Sd(function(){var Oe={done:!1};try{Fe($e,Ne,ji(xd,Oe,pe),ji(Di,Oe,pe))}catch(Lt){Di(Oe,Lt,pe)}}):(pe.value=Ne,pe.state=1,gg(pe,!1))}catch(Oe){Di({done:!1},Oe,pe)}}};ug&&(Md=(_c=function(Ne){ld(this,Md),Yr(Ne),Fe(Td,this);var kt=Cd(this);try{Ne(ji(xd,kt),ji(Di,kt))}catch($e){Di(kt,$e)}}).prototype,(Td=function(Ne){N1(this,{type:Il,done:!1,notified:!1,parent:!1,reactions:new w1,rejection:!1,state:0,value:void 0})}).prototype=Hs(Md,"then",function(Ne,kt){var $e=Cd(this),Oe=_d(Js(this,_c));return $e.parent=!0,Oe.ok=!Ue(Ne)||Ne,Oe.fail=Ue(kt)&&kt,Oe.domain=ds?wd.domain:void 0,$e.state==0?$e.reactions.add(Oe):Sd(function(){mg(Oe,$e)}),Oe.promise}),og=function(){var pe=new Td,Ne=Cd(pe);this.promise=pe,this.resolve=ji(xd,Ne),this.reject=ji(Di,Ne)},_s.f=_d=function(pe){return pe===_c||pe===void 0?new og(pe):R1(pe)}),xn({global:!0,constructor:!0,wrap:!0,forced:ug},{Promise:_c}),li(_c,Il,!1,!0),Hm(Il);var yg=To("iterator"),bg=!1;try{var $1=0,Sg={next:function(){return{done:!!$1++}},return:function(){bg=!0}};Sg[yg]=function(){return this},Array.from(Sg,function(){throw 2})}catch{}var Tg=function(pe,Ne){if(!Ne&&!bg)return!1;var kt=!1;try{var $e={};$e[yg]=function(){return{next:function(){return{done:kt=!0}}}},pe($e)}catch{}return kt},Cg=$i.CONSTRUCTOR||!Tg(function(pe){Ma.all(pe).then(void 0,function(){})});xn({target:"Promise",stat:!0,forced:Cg},{all:function(Ne){var kt=this,$e=_s.f(kt),Oe=$e.resolve,Lt=$e.reject,rr=Li(function(){var Pt=Yr(kt.resolve),pr=[],yr=0,Pr=1;_o(Ne,function(Rr){var Vr=yr++,Dr=!1;Pr++,Fe(Pt,kt,Rr).then(function(Xr){Dr||(Dr=!0,pr[Vr]=Xr,--Pr||Oe(pr))},Lt)}),--Pr||Oe(pr)});return rr.error&&Lt(rr.value),$e.promise}});var j1=$i.CONSTRUCTOR;Ma&&Ma.prototype,xn({target:"Promise",proto:!0,forced:j1,real:!0},{catch:function(pe){return this.then(void 0,pe)}}),xn({target:"Promise",stat:!0,forced:Cg},{race:function(Ne){var kt=this,$e=_s.f(kt),Oe=$e.reject,Lt=Li(function(){var rr=Yr(kt.resolve);_o(Ne,function(Pt){Fe(rr,kt,Pt).then($e.resolve,Oe)})});return Lt.error&&Oe(Lt.value),$e.promise}}),xn({target:"Promise",stat:!0,forced:$i.CONSTRUCTOR},{reject:function(Ne){var kt=_s.f(this);return Fe(kt.reject,void 0,Ne),kt.promise}});var Id=function(pe,Ne){if(po(pe),mr(Ne)&&Ne.constructor===pe)return Ne;var kt=_s.f(pe);return(0,kt.resolve)(Ne),kt.promise},D1=$i.CONSTRUCTOR,U1=Er("Promise"),V1=!D1;xn({target:"Promise",stat:!0,forced:!0},{resolve:function(Ne){return Id(V1&&this===U1?Ma:this,Ne)}}),xn({target:"Promise",stat:!0},{allSettled:function(Ne){var kt=this,$e=_s.f(kt),Oe=$e.resolve,Lt=$e.reject,rr=Li(function(){var Pt=Yr(kt.resolve),pr=[],yr=0,Pr=1;_o(Ne,function(Rr){var Vr=yr++,Dr=!1;Pr++,Fe(Pt,kt,Rr).then(function(Xr){Dr||(Dr=!0,pr[Vr]={status:"fulfilled",value:Xr},--Pr||Oe(pr))},function(Xr){Dr||(Dr=!0,pr[Vr]={status:"rejected",reason:Xr},--Pr||Oe(pr))})}),--Pr||Oe(pr)});return rr.error&&Lt(rr.value),$e.promise}});var Mg="No one promise resolved";xn({target:"Promise",stat:!0},{any:function(Ne){var kt=this,$e=Er("AggregateError"),Oe=_s.f(kt),Lt=Oe.resolve,rr=Oe.reject,Pt=Li(function(){var pr=Yr(kt.resolve),yr=[],Pr=0,Rr=1,Vr=!1;_o(Ne,function(Dr){var Xr=Pr++,kn=!1;Rr++,Fe(pr,kt,Dr).then(function(Tn){kn||Vr||(Vr=!0,Lt(Tn))},function(Tn){kn||Vr||(kn=!0,yr[Xr]=Tn,--Rr||rr(new $e(yr,Mg)))})}),--Rr||rr(new $e(yr,Mg))});return Pt.error&&rr(Pt.value),Oe.promise}});var q1=Ma&&Ma.prototype,H1=!!Ma&&V(function(){q1.finally.call({then:function(){}},function(){})});xn({target:"Promise",proto:!0,real:!0,forced:H1},{finally:function(pe){var Ne=Js(this,Er("Promise")),kt=Ue(pe);return this.then(kt?function($e){return Id(Ne,pe()).then(function(){return $e})}:pe,kt?function($e){return Id(Ne,pe()).then(function(){throw $e})}:pe)}});var z1=Ir.Promise;xn({target:"Promise",stat:!0,forced:!0},{try:function(pe){var Ne=_s.f(this),kt=Li(pe);return(kt.error?Ne.reject:Ne.resolve)(kt.value),Ne.promise}});var xo=z1,W1=Ce([].reverse),kg=[1,2];xn({target:"Array",proto:!0,forced:String(kg)===String(kg.reverse())},{reverse:function(){return Ms(this)&&(this.length=this.length),W1(this)}});var G1=sa("Array").reverse,Ed=Array.prototype,Yl=function(pe){var Ne=pe.reverse;return pe===Ed||sr(Ed,pe)&&Ne===Ed.reverse?G1:Ne},K1=fc("slice"),Q1=To("species"),Pd=Array,J1=Math.max;xn({target:"Array",proto:!0,forced:!K1},{slice:function(Ne,kt){var $e,Oe,Lt,rr=wr(this),Pt=Za(rr),pr=Ai(Ne,Pt),yr=Ai(kt===void 0?Pt:kt,Pt);if(Ms(rr)&&($e=rr.constructor,(ml($e)&&($e===Pd||Ms($e.prototype))||mr($e)&&($e=$e[Q1])===null)&&($e=void 0),$e===Pd||$e===void 0))return qs(rr,pr,yr);for(Oe=new($e===void 0?Pd:$e)(J1(yr-pr,0)),Lt=0;pr<yr;pr++,Lt++)pr in rr&&ii(Oe,Lt,rr[pr]);return Oe.length=Lt,Oe}});var Y1=sa("Array").slice,Ad=Array.prototype,$o=function(pe){var Ne=pe.slice;return pe===Ad||sr(Ad,pe)&&Ne===Ad.slice?Y1:Ne},X1=g(function(pe){var Ne=W0.default;function kt(){pe.exports=kt=function(){return $e},pe.exports.__esModule=!0,pe.exports.default=pe.exports;var $e={},Oe=Object.prototype,Lt=Oe.hasOwnProperty,rr=typeof Ua=="function"?Ua:{},Pt=rr.iterator||"@@iterator",pr=rr.asyncIterator||"@@asyncIterator",yr=rr.toStringTag||"@@toStringTag";function Pr(Hn,Ln,eo){return bc(Hn,Ln,{value:eo,enumerable:!0,configurable:!0,writable:!0}),Hn[Ln]}try{Pr({},"")}catch{Pr=function(eo,lo,So){return eo[lo]=So}}function Rr(Hn,Ln,eo,lo){var So=Ln&&Ln.prototype instanceof Xr?Ln:Xr,Co=Cs(So.prototype),aa=new Gr(lo||[]);return Co._invoke=function(No,Sa,Lo){var Wo="suspendedStart";return function(Ta,Yi){if(Wo==="executing")throw new Error("Generator is already running");if(Wo==="completed"){if(Ta==="throw")throw Yi;return ro()}for(Lo.method=Ta,Lo.arg=Yi;;){var Qo=Lo.delegate;if(Qo){var Xi=co(Qo,Lo);if(Xi){if(Xi===Dr)continue;return Xi}}if(Lo.method==="next")Lo.sent=Lo._sent=Lo.arg;else if(Lo.method==="throw"){if(Wo==="suspendedStart")throw Wo="completed",Lo.arg;Lo.dispatchException(Lo.arg)}else Lo.method==="return"&&Lo.abrupt("return",Lo.arg);Wo="executing";var cs=Vr(No,Sa,Lo);if(cs.type==="normal"){if(Wo=Lo.done?"completed":"suspendedYield",cs.arg===Dr)continue;return{value:cs.arg,done:Lo.done}}cs.type==="throw"&&(Wo="completed",Lo.method="throw",Lo.arg=cs.arg)}}}(Hn,eo,aa),Co}function Vr(Hn,Ln,eo){try{return{type:"normal",arg:Hn.call(Ln,eo)}}catch(lo){return{type:"throw",arg:lo}}}$e.wrap=Rr;var Dr={};function Xr(){}function kn(){}function Tn(){}var Dn={};Pr(Dn,Pt,function(){return this});var Fn=pi&&pi(pi(Kn([])));Fn&&Fn!==Oe&&Lt.call(Fn,Pt)&&(Dn=Fn);var Gn=Tn.prototype=Xr.prototype=Cs(Dn);function $n(Hn){var Ln;Qn(Ln=["next","throw","return"]).call(Ln,function(eo){Pr(Hn,eo,function(lo){return this._invoke(eo,lo)})})}function ho(Hn,Ln){function eo(So,Co,aa,No){var Sa=Vr(Hn[So],Hn,Co);if(Sa.type!=="throw"){var Lo=Sa.arg,Wo=Lo.value;return Wo&&Ne(Wo)=="object"&&Lt.call(Wo,"__await")?Ln.resolve(Wo.__await).then(function(Ta){eo("next",Ta,aa,No)},function(Ta){eo("throw",Ta,aa,No)}):Ln.resolve(Wo).then(function(Ta){Lo.value=Ta,aa(Lo)},function(Ta){return eo("throw",Ta,aa,No)})}No(Sa.arg)}var lo;this._invoke=function(So,Co){function aa(){return new Ln(function(No,Sa){eo(So,Co,No,Sa)})}return lo=lo?lo.then(aa,aa):aa()}}function co(Hn,Ln){var eo=Hn.iterator[Ln.method];if(eo===void 0){if(Ln.delegate=null,Ln.method==="throw"){if(Hn.iterator.return&&(Ln.method="return",Ln.arg=void 0,co(Hn,Ln),Ln.method==="throw"))return Dr;Ln.method="throw",Ln.arg=new TypeError("The iterator does not provide a 'throw' method")}return Dr}var lo=Vr(eo,Hn.iterator,Ln.arg);if(lo.type==="throw")return Ln.method="throw",Ln.arg=lo.arg,Ln.delegate=null,Dr;var So=lo.arg;return So?So.done?(Ln[Hn.resultName]=So.value,Ln.next=Hn.nextLoc,Ln.method!=="return"&&(Ln.method="next",Ln.arg=void 0),Ln.delegate=null,Dr):So:(Ln.method="throw",Ln.arg=new TypeError("iterator result is not an object"),Ln.delegate=null,Dr)}function oa(Hn){var Ln={tryLoc:Hn[0]};1 in Hn&&(Ln.catchLoc=Hn[1]),2 in Hn&&(Ln.finallyLoc=Hn[2],Ln.afterLoc=Hn[3]),this.tryEntries.push(Ln)}function so(Hn){var Ln=Hn.completion||{};Ln.type="normal",delete Ln.arg,Hn.completion=Ln}function Gr(Hn){this.tryEntries=[{tryLoc:"root"}],Qn(Hn).call(Hn,oa,this),this.reset(!0)}function Kn(Hn){if(Hn){var Ln=Hn[Pt];if(Ln)return Ln.call(Hn);if(typeof Hn.next=="function")return Hn;if(!isNaN(Hn.length)){var eo=-1,lo=function So(){for(;++eo<Hn.length;)if(Lt.call(Hn,eo))return So.value=Hn[eo],So.done=!1,So;return So.value=void 0,So.done=!0,So};return lo.next=lo}}return{next:ro}}function ro(){return{value:void 0,done:!0}}return kn.prototype=Tn,Pr(Gn,"constructor",Tn),Pr(Tn,"constructor",kn),kn.displayName=Pr(Tn,yr,"GeneratorFunction"),$e.isGeneratorFunction=function(Hn){var Ln=typeof Hn=="function"&&Hn.constructor;return!!Ln&&(Ln===kn||(Ln.displayName||Ln.name)==="GeneratorFunction")},$e.mark=function(Hn){return si?si(Hn,Tn):(Hn.__proto__=Tn,Pr(Hn,yr,"GeneratorFunction")),Hn.prototype=Cs(Gn),Hn},$e.awrap=function(Hn){return{__await:Hn}},$n(ho.prototype),Pr(ho.prototype,pr,function(){return this}),$e.AsyncIterator=ho,$e.async=function(Hn,Ln,eo,lo,So){So===void 0&&(So=xo);var Co=new ho(Rr(Hn,Ln,eo,lo),So);return $e.isGeneratorFunction(Ln)?Co:Co.next().then(function(aa){return aa.done?aa.value:Co.next()})},$n(Gn),Pr(Gn,yr,"Generator"),Pr(Gn,Pt,function(){return this}),Pr(Gn,"toString",function(){return"[object Generator]"}),$e.keys=function(Hn){var Ln=[];for(var eo in Hn)Ln.push(eo);return Yl(Ln).call(Ln),function lo(){for(;Ln.length;){var So=Ln.pop();if(So in Hn)return lo.value=So,lo.done=!1,lo}return lo.done=!0,lo}},$e.values=Kn,Gr.prototype={constructor:Gr,reset:function(Ln){var eo;if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,Qn(eo=this.tryEntries).call(eo,so),!Ln)for(var lo in this)lo.charAt(0)==="t"&&Lt.call(this,lo)&&!isNaN(+$o(lo).call(lo,1))&&(this[lo]=void 0)},stop:function(){this.done=!0;var Ln=this.tryEntries[0].completion;if(Ln.type==="throw")throw Ln.arg;return this.rval},dispatchException:function(Ln){if(this.done)throw Ln;var eo=this;function lo(Lo,Wo){return aa.type="throw",aa.arg=Ln,eo.next=Lo,Wo&&(eo.method="next",eo.arg=void 0),!!Wo}for(var So=this.tryEntries.length-1;So>=0;--So){var Co=this.tryEntries[So],aa=Co.completion;if(Co.tryLoc==="root")return lo("end");if(Co.tryLoc<=this.prev){var No=Lt.call(Co,"catchLoc"),Sa=Lt.call(Co,"finallyLoc");if(No&&Sa){if(this.prev<Co.catchLoc)return lo(Co.catchLoc,!0);if(this.prev<Co.finallyLoc)return lo(Co.finallyLoc)}else if(No){if(this.prev<Co.catchLoc)return lo(Co.catchLoc,!0)}else{if(!Sa)throw new Error("try statement without catch or finally");if(this.prev<Co.finallyLoc)return lo(Co.finallyLoc)}}}},abrupt:function(Ln,eo){for(var lo=this.tryEntries.length-1;lo>=0;--lo){var So=this.tryEntries[lo];if(So.tryLoc<=this.prev&&Lt.call(So,"finallyLoc")&&this.prev<So.finallyLoc){var Co=So;break}}Co&&(Ln==="break"||Ln==="continue")&&Co.tryLoc<=eo&&eo<=Co.finallyLoc&&(Co=null);var aa=Co?Co.completion:{};return aa.type=Ln,aa.arg=eo,Co?(this.method="next",this.next=Co.finallyLoc,Dr):this.complete(aa)},complete:function(Ln,eo){if(Ln.type==="throw")throw Ln.arg;return Ln.type==="break"||Ln.type==="continue"?this.next=Ln.arg:Ln.type==="return"?(this.rval=this.arg=Ln.arg,this.method="return",this.next="end"):Ln.type==="normal"&&eo&&(this.next=eo),Dr},finish:function(Ln){for(var eo=this.tryEntries.length-1;eo>=0;--eo){var lo=this.tryEntries[eo];if(lo.finallyLoc===Ln)return this.complete(lo.completion,lo.afterLoc),so(lo),Dr}},catch:function(Ln){for(var eo=this.tryEntries.length-1;eo>=0;--eo){var lo=this.tryEntries[eo];if(lo.tryLoc===Ln){var So=lo.completion;if(So.type==="throw"){var Co=So.arg;so(lo)}return Co}}throw new Error("illegal catch attempt")},delegateYield:function(Ln,eo,lo){return this.delegate={iterator:Kn(Ln),resultName:eo,nextLoc:lo},this.method==="next"&&(this.arg=void 0),Dr}},$e}pe.exports=kt,pe.exports.__esModule=!0,pe.exports.default=pe.exports}),El=X1(),_r=El;try{regeneratorRuntime=El}catch{typeof globalThis=="object"?globalThis.regeneratorRuntime=El:Function("r","regeneratorRuntime = r")(El)}xn({target:"Number",stat:!0,nonConfigurable:!0,nonWritable:!0},{MAX_SAFE_INTEGER:9007199254740991});var wg=9007199254740991,Xl=Object.assign,la=Object.defineProperty,Zl=Ce([].concat),_g=!Xl||V(function(){if(qe&&Xl({b:1},Xl(la({},"a",{enumerable:!0,get:function(){la(this,"b",{value:3,enumerable:!1})}}),{b:2})).b!==1)return!0;var pe={},Ne={},kt=Symbol(),$e="abcdefghijklmnopqrst";return pe[kt]=7,$e.split("").forEach(function(Oe){Ne[Oe]=Oe}),Xl({},pe)[kt]!=7||Vs(Xl({},Ne)).join("")!=$e})?function(Ne,kt){for(var $e=In(Ne),Oe=arguments.length,Lt=1,rr=hc.f,Pt=er.f;Oe>Lt;)for(var pr,yr=fr(arguments[Lt++]),Pr=rr?Zl(Vs(yr),rr(yr)):Vs(yr),Rr=Pr.length,Vr=0;Rr>Vr;)pr=Pr[Vr++],qe&&!Fe(Pt,yr,pr)||($e[pr]=yr[pr]);return $e}:Xl;xn({target:"Object",stat:!0,arity:2,forced:Object.assign!==_g},{assign:_g});var Vn=Ir.Object.assign;function eu(pe,Ne){var kt={};for(var $e in pe)Object.prototype.hasOwnProperty.call(pe,$e)&&Ne.indexOf($e)<0&&(kt[$e]=pe[$e]);if(pe!=null&&typeof Object.getOwnPropertySymbols=="function"){var Oe=0;for($e=Object.getOwnPropertySymbols(pe);Oe<$e.length;Oe++)Ne.indexOf($e[Oe])<0&&Object.prototype.propertyIsEnumerable.call(pe,$e[Oe])&&(kt[$e[Oe]]=pe[$e[Oe]])}return kt}function zr(pe,Ne,kt,$e){return new(kt||(kt=Promise))(function(Oe,Lt){function rr(yr){try{pr($e.next(yr))}catch(Pr){Lt(Pr)}}function Pt(yr){try{pr($e.throw(yr))}catch(Pr){Lt(Pr)}}function pr(yr){yr.done?Oe(yr.value):function(Rr){return Rr instanceof kt?Rr:new kt(function(Vr){Vr(Rr)})}(yr.value).then(rr,Pt)}pr(($e=$e.apply(pe,Ne||[])).next())})}var Sv=V(function(){if(typeof ArrayBuffer=="function"){var pe=new ArrayBuffer(8);Object.isExtensible(pe)&&Object.defineProperty(pe,"a",{value:8})}}),fa=Object.isExtensible,xg=V(function(){fa(1)})||Sv?function(Ne){return!!mr(Ne)&&(!Sv||tr(Ne)!="ArrayBuffer")&&(!fa||fa(Ne))}:fa,Ig=!V(function(){return Object.isExtensible(Object.preventExtensions({}))}),Eg=g(function(pe){var Ne=Oa.f,kt=!1,$e=Do("meta"),Oe=0,Lt=function(Pt){Ne(Pt,$e,{value:{objectID:"O"+Oe++,weakData:{}}})},rr=pe.exports={enable:function(){rr.enable=function(){},kt=!0;var Pt=gc.f,pr=Ce([].splice),yr={};yr[$e]=1,Pt(yr).length&&(gc.f=function(Pr){for(var Rr=Pt(Pr),Vr=0,Dr=Rr.length;Vr<Dr;Vr++)if(Rr[Vr]===$e){pr(Rr,Vr,1);break}return Rr},xn({target:"Object",stat:!0,forced:!0},{getOwnPropertyNames:qu.f}))},fastKey:function(Pt,pr){if(!mr(Pt))return typeof Pt=="symbol"?Pt:(typeof Pt=="string"?"S":"P")+Pt;if(!hn(Pt,$e)){if(!xg(Pt))return"F";if(!pr)return"E";Lt(Pt)}return Pt[$e].objectID},getWeakData:function(Pt,pr){if(!hn(Pt,$e)){if(!xg(Pt))return!0;if(!pr)return!1;Lt(Pt)}return Pt[$e].weakData},onFreeze:function(Pt){return Ig&&kt&&xg(Pt)&&!hn(Pt,$e)&&Lt(Pt),Pt}};Ni[$e]=!0}),Z1=Oa.f,eS=Ws.forEach,Pg=ts.set,Ja=ts.getterFor,Tv=function(pe,Ne,kt){var $e,Oe=pe.indexOf("Map")!==-1,Lt=pe.indexOf("Weak")!==-1,rr=Oe?"set":"add",Pt=$[pe],pr=Pt&&Pt.prototype,yr={};if(qe&&Ue(Pt)&&(Lt||pr.forEach&&!V(function(){new Pt().entries().next()}))){var Pr=($e=Ne(function(Vr,Dr){Pg(ld(Vr,Pr),{type:pe,collection:new Pt}),Dr!=null&&_o(Dr,Vr[rr],{that:Vr,AS_ENTRIES:Oe})})).prototype,Rr=Ja(pe);eS(["add","clear","delete","forEach","get","has","set","keys","values","entries"],function(Vr){var Dr=Vr=="add"||Vr=="set";!(Vr in pr)||Lt&&Vr=="clear"||va(Pr,Vr,function(Xr,kn){var Tn=Rr(this).collection;if(!Dr&&Lt&&!mr(Xr))return Vr=="get"&&void 0;var Dn=Tn[Vr](Xr===0?0:Xr,kn);return Dr?this:Dn})}),Lt||Z1(Pr,"size",{configurable:!0,get:function(){return Rr(this).collection.size}})}else $e=kt.getConstructor(Ne,pe,Oe,rr),Eg.enable();return li($e,pe,!1,!0),yr[pe]=$e,xn({global:!0,forced:!0},yr),Lt||kt.setStrong($e,pe,Oe),$e},kp=function(pe,Ne,kt){for(var $e in Ne)kt&&kt.unsafe&&pe[$e]?pe[$e]=Ne[$e]:Hs(pe,$e,Ne[$e],kt);return pe},Ys=Oa.f,ri=Eg.fastKey,qn=ts.set,wp=ts.getterFor,Nd={getConstructor:function(pe,Ne,kt,$e){var Oe=pe(function(yr,Pr){ld(yr,Lt),qn(yr,{type:Ne,index:es(null),first:void 0,last:void 0,size:0}),qe||(yr.size=0),lr(Pr)||_o(Pr,yr[$e],{that:yr,AS_ENTRIES:kt})}),Lt=Oe.prototype,rr=wp(Ne),Pt=function(yr,Pr,Rr){var Vr,Dr,Xr=rr(yr),kn=pr(yr,Pr);return kn?kn.value=Rr:(Xr.last=kn={index:Dr=ri(Pr,!0),key:Pr,value:Rr,previous:Vr=Xr.last,next:void 0,removed:!1},Xr.first||(Xr.first=kn),Vr&&(Vr.next=kn),qe?Xr.size++:yr.size++,Dr!=="F"&&(Xr.index[Dr]=kn)),yr},pr=function(yr,Pr){var Rr,Vr=rr(yr),Dr=ri(Pr);if(Dr!=="F")return Vr.index[Dr];for(Rr=Vr.first;Rr;Rr=Rr.next)if(Rr.key==Pr)return Rr};return kp(Lt,{clear:function(){for(var Pr=rr(this),Rr=Pr.index,Vr=Pr.first;Vr;)Vr.removed=!0,Vr.previous&&(Vr.previous=Vr.previous.next=void 0),delete Rr[Vr.index],Vr=Vr.next;Pr.first=Pr.last=void 0,qe?Pr.size=0:this.size=0},delete:function(yr){var Pr=this,Rr=rr(Pr),Vr=pr(Pr,yr);if(Vr){var Dr=Vr.next,Xr=Vr.previous;delete Rr.index[Vr.index],Vr.removed=!0,Xr&&(Xr.next=Dr),Dr&&(Dr.previous=Xr),Rr.first==Vr&&(Rr.first=Dr),Rr.last==Vr&&(Rr.last=Xr),qe?Rr.size--:Pr.size--}return!!Vr},forEach:function(Pr){for(var Rr,Vr=rr(this),Dr=Go(Pr,arguments.length>1?arguments[1]:void 0);Rr=Rr?Rr.next:Vr.first;)for(Dr(Rr.value,Rr.key,this);Rr&&Rr.removed;)Rr=Rr.previous},has:function(Pr){return!!pr(this,Pr)}}),kp(Lt,kt?{get:function(Pr){var Rr=pr(this,Pr);return Rr&&Rr.value},set:function(Pr,Rr){return Pt(this,Pr===0?0:Pr,Rr)}}:{add:function(Pr){return Pt(this,Pr=Pr===0?0:Pr,Pr)}}),qe&&Ys(Lt,"size",{get:function(){return rr(this).size}}),Oe},setStrong:function(pe,Ne,kt){var $e=Ne+" Iterator",Oe=wp(Ne),Lt=wp($e);rd(pe,Ne,function(rr,Pt){qn(this,{type:$e,target:rr,state:Oe(rr),kind:Pt,last:void 0})},function(){for(var rr=Lt(this),Pt=rr.kind,pr=rr.last;pr&&pr.removed;)pr=pr.previous;return rr.target&&(rr.last=pr=pr?pr.next:rr.state.first)?Pt=="keys"?{value:pr.key,done:!1}:Pt=="values"?{value:pr.value,done:!1}:{value:[pr.key,pr.value],done:!1}:(rr.target=void 0,{value:void 0,done:!0})},kt?"entries":"values",!kt,!0),Hm(Ne)}};Tv("Map",function(pe){return function(){return pe(this,arguments.length?arguments[0]:void 0)}},Nd);var Ag=Ir.Map,Cv=[].push,Ng=function(Ne){var kt,$e,Oe,Lt,rr=arguments.length,Pt=rr>1?arguments[1]:void 0;return _l(this),(kt=Pt!==void 0)&&Yr(Pt),lr(Ne)?new this:($e=[],kt?(Oe=0,Lt=Go(Pt,rr>2?arguments[2]:void 0),_o(Ne,function(pr){Fe(Cv,$e,Lt(pr,Oe++))})):_o(Ne,Cv,{that:$e}),new this($e))};xn({target:"Map",stat:!0,forced:!0},{from:Ng});var Mv=function(){return new this(qs(arguments))};xn({target:"Map",stat:!0,forced:!0},{of:Mv});var kv=function(){for(var Ne,kt=po(this),$e=Yr(kt.delete),Oe=!0,Lt=0,rr=arguments.length;Lt<rr;Lt++)Ne=Fe($e,kt,arguments[Lt]),Oe=Oe&&Ne;return!!Oe};xn({target:"Map",proto:!0,real:!0,forced:!0},{deleteAll:kv}),xn({target:"Map",proto:!0,real:!0,forced:!0},{emplace:function(Ne,kt){var $e,Oe,Lt=po(this),rr=Yr(Lt.get),Pt=Yr(Lt.has),pr=Yr(Lt.set);return Fe(Pt,Lt,Ne)?($e=Fe(rr,Lt,Ne),"update"in kt&&($e=kt.update($e,Ne,Lt),Fe(pr,Lt,Ne,$e)),$e):(Oe=kt.insert(Ne,Lt),Fe(pr,Lt,Ne,Oe),Oe)}});var Zi=Sc;xn({target:"Map",proto:!0,real:!0,forced:!0},{every:function(Ne){var kt=po(this),$e=Zi(kt),Oe=Go(Ne,arguments.length>1?arguments[1]:void 0);return!_o($e,function(Lt,rr,Pt){if(!Oe(rr,Lt,kt))return Pt()},{AS_ENTRIES:!0,IS_ITERATOR:!0,INTERRUPTED:!0}).stopped}}),xn({target:"Map",proto:!0,real:!0,forced:!0},{filter:function(Ne){var kt=po(this),$e=Zi(kt),Oe=Go(Ne,arguments.length>1?arguments[1]:void 0),Lt=new(Js(kt,Er("Map"))),rr=Yr(Lt.set);return _o($e,function(Pt,pr){Oe(pr,Pt,kt)&&Fe(rr,Lt,Pt,pr)},{AS_ENTRIES:!0,IS_ITERATOR:!0}),Lt}}),xn({target:"Map",proto:!0,real:!0,forced:!0},{find:function(Ne){var kt=po(this),$e=Zi(kt),Oe=Go(Ne,arguments.length>1?arguments[1]:void 0);return _o($e,function(Lt,rr,Pt){if(Oe(rr,Lt,kt))return Pt(rr)},{AS_ENTRIES:!0,IS_ITERATOR:!0,INTERRUPTED:!0}).result}}),xn({target:"Map",proto:!0,real:!0,forced:!0},{findKey:function(Ne){var kt=po(this),$e=Zi(kt),Oe=Go(Ne,arguments.length>1?arguments[1]:void 0);return _o($e,function(Lt,rr,Pt){if(Oe(rr,Lt,kt))return Pt(Lt)},{AS_ENTRIES:!0,IS_ITERATOR:!0,INTERRUPTED:!0}).result}});var tS=Ce([].push);xn({target:"Map",stat:!0,forced:!0},{groupBy:function(Ne,kt){Yr(kt);var $e=Sc(Ne),Oe=new this,Lt=Yr(Oe.has),rr=Yr(Oe.get),Pt=Yr(Oe.set);return _o($e,function(pr){var yr=kt(pr);Fe(Lt,Oe,yr)?tS(Fe(rr,Oe,yr),pr):Fe(Pt,Oe,yr,[pr])},{IS_ITERATOR:!0}),Oe}}),xn({target:"Map",proto:!0,real:!0,forced:!0},{includes:function(Ne){return _o(Zi(po(this)),function(kt,$e,Oe){if((Lt=$e)===(rr=Ne)||Lt!=Lt&&rr!=rr)return Oe();var Lt,rr},{AS_ENTRIES:!0,IS_ITERATOR:!0,INTERRUPTED:!0}).stopped}}),xn({target:"Map",stat:!0,forced:!0},{keyBy:function(Ne,kt){var $e=new this;Yr(kt);var Oe=Yr($e.set);return _o(Ne,function(Lt){Fe(Oe,$e,kt(Lt),Lt)}),$e}}),xn({target:"Map",proto:!0,real:!0,forced:!0},{keyOf:function(Ne){return _o(Zi(po(this)),function(kt,$e,Oe){if($e===Ne)return Oe(kt)},{AS_ENTRIES:!0,IS_ITERATOR:!0,INTERRUPTED:!0}).result}}),xn({target:"Map",proto:!0,real:!0,forced:!0},{mapKeys:function(Ne){var kt=po(this),$e=Zi(kt),Oe=Go(Ne,arguments.length>1?arguments[1]:void 0),Lt=new(Js(kt,Er("Map"))),rr=Yr(Lt.set);return _o($e,function(Pt,pr){Fe(rr,Lt,Oe(pr,Pt,kt),pr)},{AS_ENTRIES:!0,IS_ITERATOR:!0}),Lt}}),xn({target:"Map",proto:!0,real:!0,forced:!0},{mapValues:function(Ne){var kt=po(this),$e=Zi(kt),Oe=Go(Ne,arguments.length>1?arguments[1]:void 0),Lt=new(Js(kt,Er("Map"))),rr=Yr(Lt.set);return _o($e,function(Pt,pr){Fe(rr,Lt,Pt,Oe(pr,Pt,kt))},{AS_ENTRIES:!0,IS_ITERATOR:!0}),Lt}}),xn({target:"Map",proto:!0,real:!0,arity:1,forced:!0},{merge:function(Ne){for(var kt=po(this),$e=Yr(kt.set),Oe=arguments.length,Lt=0;Lt<Oe;)_o(arguments[Lt++],$e,{that:kt,AS_ENTRIES:!0});return kt}});var wv=TypeError;xn({target:"Map",proto:!0,real:!0,forced:!0},{reduce:function(Ne){var kt=po(this),$e=Zi(kt),Oe=arguments.length<2,Lt=Oe?void 0:arguments[1];if(Yr(Ne),_o($e,function(rr,Pt){Oe?(Oe=!1,Lt=Pt):Lt=Ne(Lt,Pt,rr,kt)},{AS_ENTRIES:!0,IS_ITERATOR:!0}),Oe)throw wv("Reduce of empty map with no initial value");return Lt}}),xn({target:"Map",proto:!0,real:!0,forced:!0},{some:function(Ne){var kt=po(this),$e=Zi(kt),Oe=Go(Ne,arguments.length>1?arguments[1]:void 0);return _o($e,function(Lt,rr,Pt){if(Oe(rr,Lt,kt))return Pt()},{AS_ENTRIES:!0,IS_ITERATOR:!0,INTERRUPTED:!0}).stopped}});var rS=TypeError;xn({target:"Map",proto:!0,real:!0,forced:!0},{update:function(Ne,kt){var $e=po(this),Oe=Yr($e.get),Lt=Yr($e.has),rr=Yr($e.set),Pt=arguments.length;Yr(kt);var pr=Fe(Lt,$e,Ne);if(!pr&&Pt<3)throw rS("Updating absent value");var yr=pr?Fe(Oe,$e,Ne):Yr(Pt>2?arguments[2]:void 0)(Ne,$e);return Fe(rr,$e,Ne,kt(yr,Ne,$e)),$e}});var _v=TypeError,Og=function(Ne,kt){var $e,Oe=po(this),Lt=Yr(Oe.get),rr=Yr(Oe.has),Pt=Yr(Oe.set),pr=arguments.length>2?arguments[2]:void 0;if(!Ue(kt)&&!Ue(pr))throw _v("At least one callback required");return Fe(rr,Oe,Ne)?($e=Fe(Lt,Oe,Ne),Ue(kt)&&($e=kt($e),Fe(Pt,Oe,Ne,$e))):Ue(pr)&&($e=pr(),Fe(Pt,Oe,Ne,$e)),$e};xn({target:"Map",proto:!0,real:!0,forced:!0},{upsert:Og}),xn({target:"Map",proto:!0,real:!0,name:"upsert",forced:!0},{updateOrInsert:Og});var Pl=Ag,xv=Date,nS=Ce(xv.prototype.getTime);xn({target:"Date",stat:!0},{now:function(){return nS(new xv)}});var xs=Ir.Date.now,ec=sa("Array").concat,Rg=Array.prototype,gi=function(pe){var Ne=pe.concat;return pe===Rg||sr(Rg,pe)&&Ne===Rg.concat?ec:Ne},oS=/MSIE .\./.test(xr),aS=$.Function,Bg=function(pe){return oS?function(Ne,kt){var $e=zm(arguments.length,1)>2,Oe=Ue(Ne)?Ne:aS(Ne),Lt=$e?qs(arguments,2):void 0;return pe($e?function(){ue(Oe,this,Lt)}:Oe,kt)}:pe},xc={setTimeout:Bg($.setTimeout),setInterval:Bg($.setInterval)},Fg=xc.setInterval;xn({global:!0,bind:!0,forced:$.setInterval!==Fg},{setInterval:Fg});var Iv=xc.setTimeout;xn({global:!0,bind:!0,forced:$.setTimeout!==Iv},{setTimeout:Iv});var Ia=Ir.setTimeout;Ir.JSON||(Ir.JSON={stringify:JSON.stringify});var sS=function(Ne,kt,$e){return ue(Ir.JSON.stringify,null,arguments)},Ao=sS,Ev=Ws.map,Pv=fc("map");xn({target:"Array",proto:!0,forced:!Pv},{map:function(Ne){return Ev(this,Ne,arguments.length>1?arguments[1]:void 0)}});var Av=sa("Array").map,_p=Array.prototype,Ro=function(pe){var Ne=pe.map;return pe===_p||sr(_p,pe)&&Ne===_p.map?Av:Ne},Lg=g(function(pe){var Ne=Object.prototype.hasOwnProperty,kt="~";function $e(){}function Oe(pr,yr,Pr){this.fn=pr,this.context=yr,this.once=Pr||!1}function Lt(pr,yr,Pr,Rr,Vr){if(typeof Pr!="function")throw new TypeError("The listener must be a function");var Dr=new Oe(Pr,Rr||pr,Vr),Xr=kt?kt+yr:yr;return pr._events[Xr]?pr._events[Xr].fn?pr._events[Xr]=[pr._events[Xr],Dr]:pr._events[Xr].push(Dr):(pr._events[Xr]=Dr,pr._eventsCount++),pr}function rr(pr,yr){--pr._eventsCount==0?pr._events=new $e:delete pr._events[yr]}function Pt(){this._events=new $e,this._eventsCount=0}Object.create&&($e.prototype=Object.create(null),new $e().__proto__||(kt=!1)),Pt.prototype.eventNames=function(){var yr,Pr,Rr=[];if(this._eventsCount===0)return Rr;for(Pr in yr=this._events)Ne.call(yr,Pr)&&Rr.push(kt?Pr.slice(1):Pr);return Object.getOwnPropertySymbols?Rr.concat(Object.getOwnPropertySymbols(yr)):Rr},Pt.prototype.listeners=function(yr){var Pr=kt?kt+yr:yr,Rr=this._events[Pr];if(!Rr)return[];if(Rr.fn)return[Rr.fn];for(var Vr=0,Dr=Rr.length,Xr=new Array(Dr);Vr<Dr;Vr++)Xr[Vr]=Rr[Vr].fn;return Xr},Pt.prototype.listenerCount=function(yr){var Pr=kt?kt+yr:yr,Rr=this._events[Pr];return Rr?Rr.fn?1:Rr.length:0},Pt.prototype.emit=function(yr,Pr,Rr,Vr,Dr,Xr){var kn=kt?kt+yr:yr;if(!this._events[kn])return!1;var Tn,Dn,Fn=this._events[kn],Gn=arguments.length;if(Fn.fn){switch(Fn.once&&this.removeListener(yr,Fn.fn,void 0,!0),Gn){case 1:return Fn.fn.call(Fn.context),!0;case 2:return Fn.fn.call(Fn.context,Pr),!0;case 3:return Fn.fn.call(Fn.context,Pr,Rr),!0;case 4:return Fn.fn.call(Fn.context,Pr,Rr,Vr),!0;case 5:return Fn.fn.call(Fn.context,Pr,Rr,Vr,Dr),!0;case 6:return Fn.fn.call(Fn.context,Pr,Rr,Vr,Dr,Xr),!0}for(Dn=1,Tn=new Array(Gn-1);Dn<Gn;Dn++)Tn[Dn-1]=arguments[Dn];Fn.fn.apply(Fn.context,Tn)}else{var $n,ho=Fn.length;for(Dn=0;Dn<ho;Dn++)switch(Fn[Dn].once&&this.removeListener(yr,Fn[Dn].fn,void 0,!0),Gn){case 1:Fn[Dn].fn.call(Fn[Dn].context);break;case 2:Fn[Dn].fn.call(Fn[Dn].context,Pr);break;case 3:Fn[Dn].fn.call(Fn[Dn].context,Pr,Rr);break;case 4:Fn[Dn].fn.call(Fn[Dn].context,Pr,Rr,Vr);break;default:if(!Tn)for($n=1,Tn=new Array(Gn-1);$n<Gn;$n++)Tn[$n-1]=arguments[$n];Fn[Dn].fn.apply(Fn[Dn].context,Tn)}}return!0},Pt.prototype.on=function(yr,Pr,Rr){return Lt(this,yr,Pr,Rr,!1)},Pt.prototype.once=function(yr,Pr,Rr){return Lt(this,yr,Pr,Rr,!0)},Pt.prototype.removeListener=function(yr,Pr,Rr,Vr){var Dr=kt?kt+yr:yr;if(!this._events[Dr])return this;if(!Pr)return rr(this,Dr),this;var Xr=this._events[Dr];if(Xr.fn)Xr.fn!==Pr||Vr&&!Xr.once||Rr&&Xr.context!==Rr||rr(this,Dr);else{for(var kn=0,Tn=[],Dn=Xr.length;kn<Dn;kn++)(Xr[kn].fn!==Pr||Vr&&!Xr[kn].once||Rr&&Xr[kn].context!==Rr)&&Tn.push(Xr[kn]);Tn.length?this._events[Dr]=Tn.length===1?Tn[0]:Tn:rr(this,Dr)}return this},Pt.prototype.removeAllListeners=function(yr){var Pr;return yr?(Pr=kt?kt+yr:yr,this._events[Pr]&&rr(this,Pr)):(this._events=new $e,this._eventsCount=0),this},Pt.prototype.off=Pt.prototype.removeListener,Pt.prototype.addListener=Pt.prototype.on,Pt.prefixed=kt,Pt.EventEmitter=Pt,pe.exports=Pt}),iS=tu;function tu(pe){pe=pe||{},this.ms=pe.min||100,this.max=pe.max||1e4,this.factor=pe.factor||2,this.jitter=pe.jitter>0&&pe.jitter<=1?pe.jitter:0,this.attempts=0}tu.prototype.duration=function(){var pe=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var Ne=Math.random(),kt=Math.floor(Ne*this.jitter*pe);pe=1&Math.floor(10*Ne)?pe+kt:pe-kt}return 0|Math.min(pe,this.max)},tu.prototype.reset=function(){this.attempts=0},tu.prototype.setMin=function(pe){this.ms=pe},tu.prototype.setMax=function(pe){this.max=pe},tu.prototype.setJitter=function(pe){this.jitter=pe};var xp=typeof e=="object"&&e&&e.Object===Object&&e,Fo=typeof self=="object"&&self&&self.Object===Object&&self,hi=xp||Fo||Function("return this")(),tc=hi.Symbol,Al=Object.prototype,Nv=Al.hasOwnProperty,cS=Al.toString,ni=tc?tc.toStringTag:void 0,Ci=function(Ne){var kt=Nv.call(Ne,ni),$e=Ne[ni];try{Ne[ni]=void 0;var Oe=!0}catch{}var Lt=cS.call(Ne);return Oe&&(kt?Ne[ni]=$e:delete Ne[ni]),Lt},Ov=Object.prototype.toString,lS=function(Ne){return Ov.call(Ne)},Rv=tc?tc.toStringTag:void 0,Mi=function(Ne){return Ne==null?Ne===void 0?"[object Undefined]":"[object Null]":Rv&&Rv in Object(Ne)?Ci(Ne):lS(Ne)},Ui=function(Ne){var kt=typeof Ne;return Ne!=null&&(kt=="object"||kt=="function")},Ip=function(Ne){if(!Ui(Ne))return!1;var kt=Mi(Ne);return kt=="[object Function]"||kt=="[object GeneratorFunction]"||kt=="[object AsyncFunction]"||kt=="[object Proxy]"},Bv={deviceId:"",timeout:8e3},Fv={account:"",appkey:"",token:"",debugLevel:"off",needReconnect:!0,reconnectionAttempts:wg,isAbtestEnable:!0,abtestUrl:"https://abt-online.netease.im/v1/api/abt/client/getExperimentInfo",abtestProjectKey:"imElite_sdk_abtest_web"},zc=Au.includes,Vi=V(function(){return!Array(1).includes()});xn({target:"Array",proto:!0,forced:Vi},{includes:function(Ne){return zc(this,Ne,arguments.length>1?arguments[1]:void 0)}});var Ep=sa("Array").includes,Lv=To("match"),uS=TypeError,$v=function(pe){if(function(Ne){var kt;return mr(Ne)&&((kt=Ne[Lv])!==void 0?!!kt:tr(Ne)=="RegExp")}(pe))throw uS("The method doesn't accept regular expressions");return pe},dS=To("match"),pS=Ce("".indexOf);xn({target:"String",proto:!0,forced:!function(pe){var Ne=/./;try{"/./"[pe](Ne)}catch{try{return Ne[dS]=!1,"/./"[pe](Ne)}catch{}}return!1}("includes")},{includes:function(Ne){return!!~pS(rs(Sr(this)),rs($v(Ne)),arguments.length>1?arguments[1]:void 0)}});var fS=sa("String").includes,$g=Array.prototype,jg=String.prototype,qi=function(pe){var Ne=pe.includes;return pe===$g||sr($g,pe)&&Ne===$g.includes?Ep:typeof pe=="string"||pe===jg||sr(jg,pe)&&Ne===jg.includes?fS:Ne},mS=Ws.findIndex,gS="findIndex",jv=!0;gS in[]&&Array(1).findIndex(function(){jv=!1}),xn({target:"Array",proto:!0,forced:jv},{findIndex:function(Ne){return mS(this,Ne,arguments.length>1?arguments[1]:void 0)}});var Dg=sa("Array").findIndex,Od=Array.prototype,Wc=function(pe){var Ne=pe.findIndex;return pe===Od||sr(Od,pe)&&Ne===Od.findIndex?Dg:Ne},hS=g(function(pe){function Ne(kt){var $e;return pe.exports=Ne=si?Zo($e=pi).call($e):function(Lt){return Lt.__proto__||pi(Lt)},pe.exports.__esModule=!0,pe.exports.default=pe.exports,Ne(kt)}pe.exports=Ne,pe.exports.__esModule=!0,pe.exports.default=pe.exports}),vS=Au.indexOf,Pp=Ce([].indexOf),Dv=!!Pp&&1/Pp([1],1,-0)<0,Ug=fi("indexOf");xn({target:"Array",proto:!0,forced:Dv||!Ug},{indexOf:function(Ne){var kt=arguments.length>1?arguments[1]:void 0;return Dv?Pp(this,Ne,kt)||0:vS(this,Ne,kt)}});var yS=sa("Array").indexOf,Vg=Array.prototype,Ba=function(pe){var Ne=pe.indexOf;return pe===Vg||sr(Vg,pe)&&Ne===Vg.indexOf?yS:Ne},qg=g(function(pe){pe.exports=function(kt){var $e;return Ba($e=Function.toString.call(kt)).call($e,"[native code]")!==-1},pe.exports.__esModule=!0,pe.exports.default=pe.exports}),Hg=Er("Reflect","construct"),bS=Object.prototype,Uv=[].push,zg=V(function(){function pe(){}return!(Hg(function(){},[],pe)instanceof pe)}),Wg=!V(function(){Hg(function(){})}),rc=zg||Wg;xn({target:"Reflect",stat:!0,forced:rc,sham:rc},{construct:function(Ne,kt){_l(Ne),po(kt);var $e=arguments.length<3?Ne:_l(arguments[2]);if(Wg&&!zg)return Hg(Ne,kt,$e);if(Ne==$e){switch(kt.length){case 0:return new Ne;case 1:return new Ne(kt[0]);case 2:return new Ne(kt[0],kt[1]);case 3:return new Ne(kt[0],kt[1],kt[2]);case 4:return new Ne(kt[0],kt[1],kt[2],kt[3])}var Oe=[null];return ue(Uv,Oe,kt),new(ue(Bu,Ne,Oe))}var Lt=$e.prototype,rr=es(mr(Lt)?Lt:bS),Pt=ue(Ne,rr,kt);return mr(Pt)?Pt:rr}});var Ic=Ir.Reflect.construct,SS=g(function(pe){pe.exports=function(){if(typeof Reflect>"u"||!Ic||Ic.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Ic(Boolean,[],function(){})),!0}catch{return!1}},pe.exports.__esModule=!0,pe.exports.default=pe.exports}),TS=g(function(pe){function Ne(kt,$e,Oe){var Lt;return SS()?(pe.exports=Ne=Zo(Lt=Ic).call(Lt),pe.exports.__esModule=!0,pe.exports.default=pe.exports):(pe.exports=Ne=function(Pt,pr,yr){var Pr=[null];Pr.push.apply(Pr,pr);var Rr=new(Zo(Function).apply(Pt,Pr));return yr&&Lu(Rr,yr.prototype),Rr},pe.exports.__esModule=!0,pe.exports.default=pe.exports),Ne.apply(null,arguments)}pe.exports=Ne,pe.exports.__esModule=!0,pe.exports.default=pe.exports}),Ec=g(function(pe){function Ne(kt){var $e=typeof Pl=="function"?new Pl:void 0;return pe.exports=Ne=function(Lt){if(Lt===null||!qg(Lt))return Lt;if(typeof Lt!="function")throw new TypeError("Super expression must either be null or a function");if($e!==void 0){if($e.has(Lt))return $e.get(Lt);$e.set(Lt,rr)}function rr(){return TS(Lt,arguments,hS(this).constructor)}return rr.prototype=Cs(Lt.prototype,{constructor:{value:rr,enumerable:!1,writable:!0,configurable:!0}}),Lu(rr,Lt)},pe.exports.__esModule=!0,pe.exports.default=pe.exports,Ne(kt)}pe.exports=Ne,pe.exports.__esModule=!0,pe.exports.default=pe.exports}),Bo=function(pe){function Ne(kt,$e,Oe){var Lt;return $e===void 0&&($e={}),Oe===void 0&&(Oe=400),(Lt=pe.call(this,kt)||this).data=$e,Lt.code=Oe,Lt.name="customError",Lt}return ea(Ne,pe),Ne}(n(Ec)(Error)),Nl=function(pe){function Ne(kt,$e,Oe){var Lt;return $e===void 0&&($e={}),(Lt=pe.call(this,kt,$e,414)||this).code=414,Lt.name="validateError",Lt.rules=Oe,Lt}return ea(Ne,pe),Ne}(Bo),Ap={200:null,406:null,808:null,810:null,201:"The client version is incorrect. You need to upgrade the SDK",302:"The user name or password is incorrect. Please check whether the appkey and token are valid and whether the account and token match",403:"Illegal operation or no permission",404:"Target object does not exist",405:"Parameter length too long",408:"Client request timed out",414:"Request parameter error",415:"Service unavailable",416:"Frequency control",417:"Repeat operation",422:"Account disabled",500:"Server internal error",503:"Server busy",508:"Expiration date",509:"Invalid",7101:"Be pulled black",700:"Partial failure of batch operation",801:"The number of people in the team has reached the upper limit",802:"No permission",803:"The team does not exist or has not changed",804:"The user is not in the team",805:"Team type mismatch",806:"The number of teams created has reached the limit",807:"Team member not valid",809:"Already in the team",811:"The number of accounts in the forced push list exceeds the limit",812:"The team is muted",813:"Due to the limited number of team, some pull people successfully",814:"Disable team message read service",815:"Maximum number of team administrators",816:"Batch operation partial failure",997:"The packet has expired",998:"Deserialize packet error",999:"Serialize packet error",9102:"Channel failure",9103:"This call has been answered / rejected at another end",10201:"Signaling: target NIM client is offline",10202:"Signaling: push is unreachable",10404:"Signaling: channel not exists",10405:"Signaling: channel already exists",10406:"Signaling: member of channel not exists",10407:"Signaling: member of channel already exists",10408:"Signaling: the invitation request does not exist or has expired",10409:"Signaling: the invitation request has been rejected",10410:"Signaling: the invitation request has been accepted",10414:"Signaling: request parameter error",10417:"Signaling: uid conflict",10419:"Signaling: the number of members of channel exceed the limit",10420:"Signaling: member is already in the channel on other client",10700:"Signaling: phased success",13002:"Abnormal chatroom status",13003:"In the blacklist",13004:"In the mute list",13006:"All members are muted, and only the administrator can speak"},Gg=function(pe){function Ne(kt,$e,Oe,Lt,rr){var Pt;return Oe===void 0&&(Oe=""),Lt===void 0&&(Lt=new Date().getTime()),rr===void 0&&(rr={}),Oe=Oe||Ap[kt],(Pt=pe.call(this,Oe,rr,kt)||this).name="cmdError",Pt.cmd=$e,Pt.timetag=Lt,Pt}return ea(Ne,pe),Ne}(Bo),ru=function(pe){function Ne(kt,$e,Oe){var Lt;return(Lt=pe.call(this,kt,{},412)||this).code=412,Lt.name="formatError",Lt.key=$e,Lt.reason=Oe,Lt}return ea(Ne,pe),Ne}(Bo),Gc=function(pe){function Ne(kt,$e,Oe,Lt,rr){var Pt;return(Pt=pe.call(this,kt,{file:rr},400)||this).name="uploadError",Pt.rawError=$e,Pt.curProvider=Oe||1,Pt.mixStorePolicy=Lt,Pt}return ea(Ne,pe),Ne}(Bo),Ol=["error","warn","log","debug"],Rd=function(){},Np=["off","error","warn","log","debug"],Vv=function(){function pe(kt,$e){this.name=$e,this.strategies={debug:console.log,log:console.log,warn:console.warn,error:console.error},this.debug=Rd,this.log=Rd,this.warn=Rd,this.error=Rd,this.name=$e,pe.instancesName.push($e),qi(Np).call(Np,kt)||(kt="off"),this.setLogFunc(kt)}var Ne=pe.prototype;return Ne.setLogFunc=function($e){var Oe=this,Lt=Wc(Ol).call(Ol,function(rr){return rr===$e});Qn(Ol).call(Ol,function(rr,Pt){Pt<=Lt&&(Oe[rr]=function(){var pr=$o(Array.prototype).call(arguments),yr=this.formatArgs(pr,rr);this.strategies[rr](yr)})})},Ne.formatArgs=function($e,Oe){var Lt=new Date,rr=Lt.getMonth()+1+"-"+Lt.getDate()+" "+Lt.getHours()+":"+Lt.getMinutes()+":"+Lt.getSeconds()+":"+Lt.getMilliseconds();return"[NIM "+Oe+" "+this.name+" "+rr+"] "+Ro($e).call($e,function(Pt){return Pt instanceof Bo?Pt.name+", "+Pt.code+", "+Pt.message:Pt instanceof Error?Pt&&Pt.message?Pt.message:Pt:typeof Pt=="object"?Ao(Pt):Pt}).join(" ")},pe}();Vv.instancesName=[],xn({global:!0},{globalThis:$});var CS=V(function(){Vs(1)});xn({target:"Object",stat:!0,forced:CS},{keys:function(Ne){return Vs(In(Ne))}});var ka=Ir.Object.keys,Kg=Ws.filter,Bs=fc("filter");xn({target:"Array",proto:!0,forced:!Bs},{filter:function(Ne){return Kg(this,Ne,arguments.length>1?arguments[1]:void 0)}});var MS=sa("Array").filter,ua=Array.prototype,ki=function(pe){var Ne=pe.filter;return pe===ua||sr(ua,pe)&&Ne===ua.filter?MS:Ne},qv=g(function(pe,Ne){pe.exports=function(){function kt(yr,Pr){if(!(yr instanceof Pr))throw new TypeError("Cannot call a class as a function")}function $e(yr,Pr){for(var Rr=0;Rr<Pr.length;Rr++){var Vr=Pr[Rr];Vr.enumerable=Vr.enumerable||!1,Vr.configurable=!0,"value"in Vr&&(Vr.writable=!0),bc(yr,Vr.key,Vr)}}function Oe(yr,Pr,Rr){return Pr&&$e(yr.prototype,Pr),Rr&&$e(yr,Rr),bc(yr,"prototype",{writable:!1}),yr}var Lt={reportUrl:"https://statistic.live.126.net/statics/report/common/form",maxSize:100,msgListMaxSize:1e3,cacheMaxSize:1e3,maxDelay:3e5,maxInterval:3e4,minInterval:1e4,timeout:5e3,autoStart:!0},rr="https://statistic.live.126.net/dispatcher/req",Pt=function(){},pr=function(){function yr(Pr){kt(this,yr),this.enable=!1,this.initConfigLoaded=!1,this.loading=!1,this.isDestroyed=!1,this.reportConfig=Lt,this.msgList=[],this.traceMsgCache={},this.lowPriorityMsgList=[],this.cacheMsgList=[],this.lastReportTime=xs(),this.timer=null,this.setConfig(Pr),this.reportConfig.autoStart&&this.initUploadConfig()}return Oe(yr,[{key:"setConfig",value:function(Rr){this.reportConfig=Vn({},this.reportConfig,Rr)}},{key:"reportImmediately",value:function(Rr,Vr){var Dr=this;this.reportConfig.request(Rr,Vn({dataType:"json",method:"POST",timeout:this.reportConfig.timeout},Vr)).catch(function(Xr){var kn,Tn;(Tn=(kn=Dr.reportConfig)===null||kn===void 0?void 0:kn.logger)===null||Tn===void 0||Tn.warn("Reporter immediately upload failed",Xr)})}},{key:"report",value:function(Rr,Vr){var Dr=arguments.length>2&&arguments[2]!==void 0&&arguments[2];if(Rr){var Xr=xs();Dr?this.lowPriorityMsgList.push({module:Rr,msg:Vr,createTime:Xr}):this.msgList.push({module:Rr,msg:Vr,createTime:Xr}),this.msgList.length>this.reportConfig.msgListMaxSize&&this.msgList.shift(),this.lowPriorityMsgList.length>this.reportConfig.msgListMaxSize&&this.lowPriorityMsgList.shift(),this.doReport()}}},{key:"reportTraceStart",value:function(Rr,Vr){if(Rr&&!this.traceMsgCache[Rr]){var Dr=Vn(Vn({start_time:xs()},Vr),{extension:[]});this.traceMsgCache[Rr]=Dr}}},{key:"reportTraceUpdate",value:function(Rr){}},{key:"reportTraceUpdateV2",value:function(Rr,Vr){if(this.traceMsgCache[Rr]){var Dr=this.traceMsgCache[Rr].extension.length,Xr=new Date().getTime();Vr.duration=Dr===0?Xr-this.traceMsgCache[Rr].start_time:Xr-this.traceMsgCache[Rr].extension[Dr-1].end_time,this.traceMsgCache[Rr].extension.push(Vn({end_time:Xr},Vr))}}},{key:"reportTraceEnd",value:function(Rr){var Vr,Dr=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];this.traceMsgCache[Rr]&&(Rr!=="nos"||Dr===!1?(typeof Dr=="boolean"?this.traceMsgCache[Rr].succeed=!!Dr:this.traceMsgCache[Rr].state=Dr,this.traceMsgCache[Rr].duration=xs()-this.traceMsgCache[Rr].start_time,Qn(Vr=this.traceMsgCache[Rr].extension).call(Vr,function(Xr){delete Xr.end_time}),this.report(Rr,this.traceMsgCache[Rr]),this.traceMsgCache[Rr]=null):this.traceMsgCache[Rr]=null)}},{key:"reportTraceCancel",value:function(Rr){this.traceMsgCache[Rr]=null}},{key:"pause",value:function(){this.enable=!1}},{key:"restore",value:function(){this.enable=!0,this.initConfigLoaded||this.initUploadConfig()}},{key:"destroy",value:function(){var Rr,Vr=this;Qn(Rr=ka(this.traceMsgCache)).call(Rr,function(Dr){Vr.reportTraceEnd(Dr,1)}),this.timer!==null&&clearTimeout(this.timer),this.setConfig=Pt,this.report=Pt,this.reportTraceStart=Pt,this.reportTraceUpdate=Pt,this.reportTraceEnd=Pt,this.pause=Pt,this.restore=Pt,this.destroy=Pt,this.cacheMsgList=[],this.traceMsgCache={},this.lowPriorityMsgList=[],this.msgList=[],this.reportConfig={},this.isDestroyed=!0}},{key:"initUploadConfig",value:function(){var Rr,Vr,Dr=this;if(!this.loading){this.loading=!0;var Xr=this.reportConfig.common||{};try{this.reportConfig.request(rr,{method:"GET",dataType:"json",params:{deviceId:Xr.dev_id,sdkVer:Xr.sdk_ver,platform:Xr.platform,appkey:Xr.app_key},timeout:this.reportConfig.timeout}).then(function(kn){var Tn,Dn;if(!Dr.isDestroyed){if(kn.status===200&&kn.data&&kn.data.code===200){var Fn=kn.data.data||{};Dr.reportConfig.maxSize=Fn.maxSize>1e3?1e3:Fn.maxSize,Dr.reportConfig.maxInterval=Fn.maxInterval>1e4?1e4:Fn.maxInterval,Dr.reportConfig.maxInterval=Fn.maxInterval<10?10:Fn.maxInterval,Dr.reportConfig.minInterval=Fn.minInterval<2?2:Fn.minInterval,Dr.reportConfig.maxDelay=Fn.maxDelay||300,Dr.reportConfig.maxInterval=1e3*Dr.reportConfig.maxInterval,Dr.reportConfig.minInterval=1e3*Dr.reportConfig.minInterval,Dr.reportConfig.maxDelay=1e3*Dr.reportConfig.maxDelay,Dr.enable=!0,Dr.initConfigLoaded=!0,Dr.loading=!1,Dr.reportHeartBeat()}(Dn=(Tn=Dr.reportConfig)===null||Tn===void 0?void 0:Tn.logger)===null||Dn===void 0||Dn.log("Get reporter upload config success")}}).catch(function(kn){var Tn,Dn;Dr.loading=!1,(Dn=(Tn=Dr.reportConfig)===null||Tn===void 0?void 0:Tn.logger)===null||Dn===void 0||Dn.error("Get reporter upload config failed",kn)})}catch(kn){this.loading=!1,(Vr=(Rr=this.reportConfig)===null||Rr===void 0?void 0:Rr.logger)===null||Vr===void 0||Vr.error("Exec reporter request failed",kn)}}}},{key:"reportHeartBeat",value:function(){var Rr=this;this.isDestroyed||(this.timer=Ia(function(){Rr.reportHeartBeat()},this.reportConfig.minInterval),this.doReport())}},{key:"doReport",value:function(){if(!this.isDestroyed){var Rr=this.msgList.length+this.lowPriorityMsgList.length+this.cacheMsgList.length>2*this.reportConfig.maxSize?this.reportConfig.minInterval:this.reportConfig.maxInterval;xs()-this.lastReportTime>=Rr&&this.upload()}}},{key:"getUploadMsg",value:function(){var Rr,Vr,Dr,Xr,kn,Tn=this,Dn={},Fn=xs();this.msgList=ki(Rr=this.msgList).call(Rr,function(Kn){return Fn-Kn.createTime<Tn.reportConfig.maxDelay}),this.lowPriorityMsgList=ki(Vr=this.lowPriorityMsgList).call(Vr,function(Kn){return Fn-Kn.createTime<Tn.reportConfig.maxDelay}),this.cacheMsgList=ki(Dr=this.cacheMsgList).call(Dr,function(Kn){return Fn-Kn.createTime<Tn.reportConfig.maxDelay});var Gn=$o(Xr=this.msgList).call(Xr,0,this.reportConfig.maxSize);if(this.msgList=$o(kn=this.msgList).call(kn,Gn.length),Gn.length<this.reportConfig.maxSize){var $n,ho,co=this.reportConfig.maxSize-Gn.length;Gn=gi(Gn).call(Gn,$o($n=this.lowPriorityMsgList).call($n,0,co)),this.lowPriorityMsgList=$o(ho=this.lowPriorityMsgList).call(ho,co)}if(Gn.length<this.reportConfig.maxSize){var oa,so,Gr=this.reportConfig.maxSize-Gn.length;Gn=gi(Gn).call(Gn,$o(oa=this.cacheMsgList).call(oa,0,Gr)),this.cacheMsgList=$o(so=this.cacheMsgList).call(so,Gr)}return Qn(Gn).call(Gn,function(Kn){Dn[Kn.module]?Dn[Kn.module].push(Kn.msg):Dn[Kn.module]=[Kn.msg]}),{uploadMsgArr:Gn,uploadMsg:Dn}}},{key:"upload",value:function(){var Rr,Vr,Dr=this;if(this.enable&&!(this.lastReportTime&&xs()-this.lastReportTime<this.reportConfig.minInterval)){var Xr=this.getUploadMsg(),kn=Xr.uploadMsgArr,Tn=Xr.uploadMsg;if(kn.length){this.lastReportTime=xs();try{this.reportConfig.request(this.reportConfig.reportUrl,{dataType:"json",method:"POST",data:{common:this.reportConfig.common,event:Tn},headers:{sdktype:"im"},timeout:this.reportConfig.timeout}).catch(function(Dn){var Fn,Gn,$n,ho;Dr.cacheMsgList=$o(Fn=gi(Gn=Dr.cacheMsgList).call(Gn,kn)).call(Fn,0,Dr.reportConfig.cacheMaxSize),(ho=($n=Dr.reportConfig)===null||$n===void 0?void 0:$n.logger)===null||ho===void 0||ho.warn("Reporter upload failed",Dn)})}catch(Dn){(Vr=(Rr=this.reportConfig)===null||Rr===void 0?void 0:Rr.logger)===null||Vr===void 0||Vr.warn("Exec reporter request failed",Dn)}clearTimeout(this.timer),this.reportHeartBeat()}}}}]),yr}();return pr}()}),Ca={setLogger:function(Ne){throw new Error("Function not implemented.")},platform:"",WebSocket:function(){function pe(kt,$e){throw this.CONNECTING=0,this.OPEN=1,this.CLOSING=2,this.CLOSED=3,new Error("Method not implemented.")}var Ne=pe.prototype;return Ne.close=function($e,Oe){throw new Error("Method not implemented.")},Ne.send=function($e){throw new Error("Method not implemented.")},Ne.onclose=function($e){throw new Error("Method not implemented.")},Ne.onerror=function($e){throw new Error("Method not implemented.")},Ne.onmessage=function($e){throw new Error("Method not implemented.")},Ne.onopen=function($e){throw new Error("Method not implemented.")},pe}(),localStorage:{},request:function(Ne,kt){throw new Error("Function not implemented.")},uploadFile:function(Ne){throw new Error("Function not implemented.")},getSystemInfo:function(){throw new Error("Function not implemented.")}},kS=TypeError,Hv=function(pe){return function(Ne,kt,$e,Oe){Yr(kt);var Lt=In(Ne),rr=fr(Lt),Pt=Za(Lt),pr=pe?Pt-1:0,yr=pe?-1:1;if($e<2)for(;;){if(pr in rr){Oe=rr[pr],pr+=yr;break}if(pr+=yr,pe?pr<0:Pt<=pr)throw kS("Reduce of empty array with no initial value")}for(;pe?pr>=0:Pt>pr;pr+=yr)pr in rr&&(Oe=kt(Oe,rr[pr],pr,Lt));return Oe}},Qg={left:Hv(!1),right:Hv(!0)}.left,Op=fi("reduce");xn({target:"Array",proto:!0,forced:!Op||!ds&&Br>79&&Br<83},{reduce:function(Ne){var kt=arguments.length;return Qg(this,Ne,kt,kt>1?arguments[1]:void 0)}});var zv=sa("Array").reduce,nu=Array.prototype,Kc=function(pe){var Ne=pe.reduce;return pe===nu||sr(nu,pe)&&Ne===nu.reduce?zv:Ne},Wv=function(Ne){return Ne===void 0},Bd={},nc={};function ps(pe,Ne){var kt,$e,Oe;try{Oe=JSON.parse(pe)}catch(Dr){throw Ne.error("Parse command error: ",pe),Dr}var Lt=Oe.sid+"_"+Oe.cid,rr=Oe.r;if(qi(kt=["4_1","4_2","4_10","4_11"]).call(kt,Lt)){var Pt=Oe.r[1].headerPacket;Lt=Pt.sid+"_"+Pt.cid,rr=Oe.r[1].body}var pr,yr=nc[Lt],Pr=Bd[yr],Rr=function(Xr,kn){var Tn=Ap[Xr];return Tn===null?null:new Gg(Xr,kn,Tn,new Date().getTime())}(Oe.code,yr),Vr={cmd:yr,raw:Oe,error:Rr,service:Pr==null?void 0:Pr.service,content:{}};if(Vr.error){if(Vr.error.cmd=yr,Vr.error.callFunc="parseCmd",!(!(($e=Pr==null?void 0:Pr.ignoreErrCodes)===null||$e===void 0)&&qi($e).call($e,Oe.code)))return Vr;Ne.warn("parseCmd:: ignore error ",Vr.error),Vr.error.ignore=!0}return!yr||!Pr?(Vr.notFound=!0,Vr):(Pr.response&&Qn(pr=Pr.response).call(pr,function(Dr,Xr){var kn=rr[Xr],Tn=Dr.type,Dn=Dr.name,Fn=Dr.reflectMapper;if(!Wv(kn))switch(Tn){case"Property":Vr.content[Dn]=Fn?ns(kn,Fn):kn;break;case"PropertyArray":Vr.content[Dn]=Ro(kn).call(kn,function(Gn){return Fn?ns(Gn,Fn):Gn});break;case"long":case"Long":case"byte":case"Byte":case"Number":Vr.content[Dn]=+kn;break;default:Vr.content[Dn]=kn}}),Vr)}function Is(pe,Ne){var kt={};for(var $e in pe)Ne[$e]!==void 0&&(kt[Ne[$e]]=pe[$e]);return kt}function ns(pe,Ne){var kt={};for(var $e in pe)Ne[$e]!==void 0&&(kt[Ne[$e]]=pe[$e]);return kt}function oc(pe){Bd=Vn(Bd,pe.cmdConfig),nc=Vn(nc,pe.cmdMap)}function Qc(pe){var Ne;return Kc(Ne=ka(pe)).call(Ne,function(kt,$e){var Oe,Lt=pe[$e];return kt[$e]=Kc(Oe=ka(Lt)).call(Oe,function(rr,Pt){return rr[Lt[Pt]]=Pt,rr},{}),kt},{})}var Jg=["disconnect","connect","heartbeat","message","json","event","ack","error","noop"],Yg=["transport not supported","client not handshaken","unauthorized"],Rp=["reconnect"],wS=function(pe){function Ne($e,Oe,Lt){var rr;return(rr=pe.call(this)||this).url=Oe,rr.logger=Lt,rr.websocket=null,rr.core=$e,rr.url=Oe,rr.status="disconnected",rr.logger=Lt,rr.connect(),rr}ea(Ne,pe);var kt=Ne.prototype;return kt.connect=function(){var Oe=this;this.status!=="connecting"&&this.status!=="connected"?(this.status="connecting",this.core.adapters.request("https://"+this.url+"/socket.io/1/?t="+xs(),{method:"GET",dataType:"text",timeout:8e3}).then(function(Lt){var rr=Lt.data.split(":"),Pt=rr[0],pr=rr[1];return Oe.sessionId=Pt,Oe.closeTimeout=1e3*pr,Oe._createWebsocket("wss://"+Oe.url+"/socket.io/1/websocket/"+Pt)}).catch(function(Lt){Oe.logger.error("imsocket::handshake fail. ",Lt&&Lt.message),Oe.status="disconnected",Oe.emit("handshakeFailed")})):this.logger.warn("imsocket::socket is connecting or connected",this.status)},kt.close=function(){if(this.websocket){this.logger.log("imsocket:: close websocket");try{this.websocket.send(this.encodePacket({type:"disconnect"})),this.websocket.close()}catch(Oe){this.logger.warn("attempt to close websocket error",Oe)}this.clean()}},kt.clean=function(){this.status="disconnected",this.websocket&&(this.websocket.onmessage=null,this.websocket.onopen=null,this.websocket.onerror=null,this.websocket.onclose=null,this.websocket=null,this.emit("disconnect"))},kt.onConnect=function(){this.status="connected",this.resetCloseTimer(),this.emit("connect")},kt._createWebsocket=function(Oe){var Lt,rr=this;this.websocket=new Ca.WebSocket(Oe),this.websocket.onmessage=Zo(Lt=this.onMessage).call(Lt,this),this.websocket.onclose=function(){rr.logger.log("imsocket:: receive websocket onclose event, current status",rr.status),rr.clean()},this.websocket.onerror=function(Pt){rr.logger.error("imsocket:: onerror",Pt)}},kt.onMessage=function(Oe){var Lt;this.resetCloseTimer();var rr=this.decodePacket(Oe.data);if(rr)switch(rr.type){case"connect":this.onConnect();break;case"disconnect":this.close();break;case"message":case"json":this.emit("message",rr.data);break;case"event":rr.name&&this.emit(rr.name,rr.args);break;case"error":rr.reason==="unauthorized"?this.emit("connect_failed",rr.reason):this.emit("error",rr.reason);break;case"heartbeat":(Lt=this.websocket)===null||Lt===void 0||Lt.send(this.encodePacket({type:"heartbeat"}));break;default:this.logger.warn("imsocket::no handler type",rr.type)}},kt.encodePacket=function(Oe){var Lt,rr,Pt=Oe.type,pr=Oe.id,yr=pr===void 0?"":pr,Pr=Oe.endpoint,Rr=Pr===void 0?"":Pr,Vr=Oe.ack,Dr=null;if(!Pt)return"";switch(Pt){case"error":Lt=Oe.reason?Ba(Yg).call(Yg,Oe.reason):"",rr=Oe.advice?Ba(Rp).call(Rp,Oe.advice):"",Lt===""&&rr===""||(Dr=Lt+(rr!==""?"+"+rr:""));break;case"message":Oe.data!==""&&(Dr=Oe.data);break;case"event":Lt={name:Oe.name},Lt=Oe.args&&Oe.args.length?{name:Oe.name,args:Oe.args}:{name:Oe.name},Dr=Ao(Lt);break;case"json":Dr=Ao(Oe.data);break;case"connect":Oe.qs&&(Dr=Oe.qs);break;case"ack":Dr=Oe.ackId+(Oe.args&&Oe.args.length?"+"+Ao(Oe.args):"")}var Xr=[Ba(Jg).call(Jg,Pt),yr+(Vr==="data"?"+":""),Rr];return Dr!=null&&Xr.push(Dr),Xr.join(":")},kt.decodePacket=function(Oe){if(Oe)if(Oe.charAt(0)!="�"){var Lt=Oe.match(/([^:]+):([0-9]+)?(\+)?:([^:]+)?:?([\s\S]*)?/);if(Lt){var rr,Pt=Lt[1],pr=Lt[2],yr=Lt[3],Pr=Lt[4],Rr=Lt[5],Vr={type:Jg[+Pt],endpoint:Pr};switch(pr&&(Vr.id=pr,Vr.ack=!yr||"data"),Vr.type){case"error":rr=Rr.split("+"),Vr.reason=Yg[+rr[0]]||"";break;case"message":Vr.data=Rr||"";break;case"connect":Vr.qs=Rr||"";break;case"event":try{var Dr=JSON.parse(Rr);Vr.name=Dr.name,Vr.args=Dr.args}catch(Xr){this.logger.error("imsocket::parseData::type::event error",Xr)}Vr.args=Vr.args||[];break;case"json":try{Vr.data=JSON.parse(Rr)}catch(Xr){this.logger.error("imsocket::parseData::type::json error",Xr)}break;case"ack":if((rr=Rr.match(/^([0-9]+)(\+)?(.*)/))&&(Vr.ackId=rr[1],Vr.args=[],rr[3]))try{Vr.args=rr[3]?JSON.parse(rr[3]):[]}catch(Xr){this.logger.error("imsocket::parseData::type::ack error",Xr)}}return Vr}}else this.logger.error("imsocket::unrecognize dataStr",$o(Oe).call(Oe,0,20))},kt.send=function(Oe){var Lt,rr={data:Oe,type:"message",endpoint:""};(Lt=this.websocket)===null||Lt===void 0||Lt.send(this.encodePacket(rr))},kt.resetCloseTimer=function(){var Oe=this;this.closeTimeout&&(clearTimeout(this.closeTimer),this.closeTimer=Ia(function(){Oe.close()},this.closeTimeout))},Ne}(Lg),Bp=sa("Array").values,Hi=Array.prototype,_S={DOMTokenList:!0,NodeList:!0},Fp=function(pe){var Ne=pe.values;return pe===Hi||sr(Hi,pe)&&Ne===Hi.values||hn(_S,ci(pe))?Bp:Ne};xn({target:"Array",stat:!0},{isArray:Ms});var Es=Ir.Array.isArray,Xg=Ws.every,xS=fi("every");xn({target:"Array",proto:!0,forced:!xS},{every:function(Ne){return Xg(this,Ne,arguments.length>1?arguments[1]:void 0)}});var zi=sa("Array").every,Zg=Array.prototype,ou=function(pe){var Ne=pe.every;return pe===Zg||sr(Zg,pe)&&Ne===Zg.every?zi:Ne},Fs=function(Ne){return Ne!=null&&typeof Ne=="object"},Gv=function(Ne){return Fs(Ne)&&Mi(Ne)=="[object RegExp]"},eh=function(Ne){return function(kt){return Ne(kt)}},au=g(function(pe,Ne){var kt=Ne&&!Ne.nodeType&&Ne,$e=kt&&pe&&!pe.nodeType&&pe,Oe=$e&&$e.exports===kt&&xp.process,Lt=function(){try{var rr=$e&&$e.require&&$e.require("util").types;return rr||Oe&&Oe.binding&&Oe.binding("util")}catch{}}();pe.exports=Lt}),th=au&&au.isRegExp,IS=th?eh(th):Gv,rh=hi["__core-js_shared__"],Jc=function(){var pe=/[^.]+$/.exec(rh&&rh.keys&&rh.keys.IE_PROTO||"");return pe?"Symbol(src)_1."+pe:""}(),ES=function(Ne){return!!Jc&&Jc in Ne},PS=Function.prototype.toString,Rl=function(Ne){if(Ne!=null){try{return PS.call(Ne)}catch{}try{return Ne+""}catch{}}return""},AS=/^\[object .+?Constructor\]$/,NS=Function.prototype,OS=Object.prototype,RS=NS.toString,BS=OS.hasOwnProperty,Bl=RegExp("^"+RS.call(BS).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Fd=function(Ne){return!(!Ui(Ne)||ES(Ne))&&(Ip(Ne)?Bl:AS).test(Rl(Ne))},FS=function(Ne,kt){return Ne==null?void 0:Ne[kt]},Fl=function(Ne,kt){var $e=FS(Ne,kt);return Fd($e)?$e:void 0},Ld=Fl(Object,"create"),LS=function(){this.__data__=Ld?Ld(null):{},this.size=0},$S=function(Ne){var kt=this.has(Ne)&&delete this.__data__[Ne];return this.size-=kt?1:0,kt},jS=Object.prototype.hasOwnProperty,DS=function(Ne){var kt=this.__data__;if(Ld){var $e=kt[Ne];return $e==="__lodash_hash_undefined__"?void 0:$e}return jS.call(kt,Ne)?kt[Ne]:void 0},su=Object.prototype.hasOwnProperty,Kv=function(Ne){var kt=this.__data__;return Ld?kt[Ne]!==void 0:su.call(kt,Ne)},US=function(Ne,kt){var $e=this.__data__;return this.size+=this.has(Ne)?0:1,$e[Ne]=Ld&&kt===void 0?"__lodash_hash_undefined__":kt,this};function Pc(pe){var Ne=-1,kt=pe==null?0:pe.length;for(this.clear();++Ne<kt;){var $e=pe[Ne];this.set($e[0],$e[1])}}Pc.prototype.clear=LS,Pc.prototype.delete=$S,Pc.prototype.get=DS,Pc.prototype.has=Kv,Pc.prototype.set=US;var $d=Pc,VS=function(){this.__data__=[],this.size=0},Lp=function(Ne,kt){return Ne===kt||Ne!=Ne&&kt!=kt},$p=function(Ne,kt){for(var $e=Ne.length;$e--;)if(Lp(Ne[$e][0],kt))return $e;return-1},qS=Array.prototype.splice,HS=function(Ne){var kt=this.__data__,$e=$p(kt,Ne);return!($e<0)&&($e==kt.length-1?kt.pop():qS.call(kt,$e,1),--this.size,!0)},iu=function(Ne){var kt=this.__data__,$e=$p(kt,Ne);return $e<0?void 0:kt[$e][1]},jp=function(Ne){return $p(this.__data__,Ne)>-1},jd=function(Ne,kt){var $e=this.__data__,Oe=$p($e,Ne);return Oe<0?(++this.size,$e.push([Ne,kt])):$e[Oe][1]=kt,this};function cu(pe){var Ne=-1,kt=pe==null?0:pe.length;for(this.clear();++Ne<kt;){var $e=pe[Ne];this.set($e[0],$e[1])}}cu.prototype.clear=VS,cu.prototype.delete=HS,cu.prototype.get=iu,cu.prototype.has=jp,cu.prototype.set=jd;var Dp=cu,Yc=Fl(hi,"Map"),zS=function(){this.size=0,this.__data__={hash:new $d,map:new(Yc||Dp),string:new $d}},WS=function(Ne){var kt=typeof Ne;return kt=="string"||kt=="number"||kt=="symbol"||kt=="boolean"?Ne!=="__proto__":Ne===null},Up=function(Ne,kt){var $e=Ne.__data__;return WS(kt)?$e[typeof kt=="string"?"string":"hash"]:$e.map},GS=function(Ne){var kt=Up(this,Ne).delete(Ne);return this.size-=kt?1:0,kt},lu=function(Ne){return Up(this,Ne).get(Ne)},Vp=function(Ne){return Up(this,Ne).has(Ne)},KS=function(Ne,kt){var $e=Up(this,Ne),Oe=$e.size;return $e.set(Ne,kt),this.size+=$e.size==Oe?0:1,this};function uu(pe){var Ne=-1,kt=pe==null?0:pe.length;for(this.clear();++Ne<kt;){var $e=pe[Ne];this.set($e[0],$e[1])}}uu.prototype.clear=zS,uu.prototype.delete=GS,uu.prototype.get=lu,uu.prototype.has=Vp,uu.prototype.set=KS;var Ll=uu,nh=function(Ne){return this.__data__.set(Ne,"__lodash_hash_undefined__"),this},Qv=function(Ne){return this.__data__.has(Ne)};function qp(pe){var Ne=-1,kt=pe==null?0:pe.length;for(this.__data__=new Ll;++Ne<kt;)this.add(pe[Ne])}qp.prototype.add=qp.prototype.push=nh,qp.prototype.has=Qv;var oh=qp,QS=function(Ne,kt,$e,Oe){for(var Lt=Ne.length,rr=$e+(Oe?1:-1);Oe?rr--:++rr<Lt;)if(kt(Ne[rr],rr,Ne))return rr;return-1},Jv=function(Ne){return Ne!=Ne},Yv=function(Ne,kt,$e){for(var Oe=$e-1,Lt=Ne.length;++Oe<Lt;)if(Ne[Oe]===kt)return Oe;return-1},ah=function(Ne,kt,$e){return kt==kt?Yv(Ne,kt,$e):QS(Ne,Jv,$e)},Hp=function(Ne,kt){return!!(Ne!=null&&Ne.length)&&ah(Ne,kt,0)>-1},Xv=function(Ne,kt,$e){for(var Oe=-1,Lt=Ne==null?0:Ne.length;++Oe<Lt;)if($e(kt,Ne[Oe]))return!0;return!1},du=function(Ne,kt){for(var $e=-1,Oe=Ne==null?0:Ne.length,Lt=Array(Oe);++$e<Oe;)Lt[$e]=kt(Ne[$e],$e,Ne);return Lt},sh=function(Ne,kt){return Ne.has(kt)},ih=function(Ne,kt,$e,Oe){var Lt=-1,rr=Hp,Pt=!0,pr=Ne.length,yr=[],Pr=kt.length;if(!pr)return yr;$e&&(kt=du(kt,eh($e))),Oe?(rr=Xv,Pt=!1):kt.length>=200&&(rr=sh,Pt=!1,kt=new oh(kt));e:for(;++Lt<pr;){var Rr=Ne[Lt],Vr=$e==null?Rr:$e(Rr);if(Rr=Oe||Rr!==0?Rr:0,Pt&&Vr==Vr){for(var Dr=Pr;Dr--;)if(kt[Dr]===Vr)continue e;yr.push(Rr)}else rr(kt,Vr,Oe)||yr.push(Rr)}return yr},zp=function(Ne){return Ne},Zv=function(Ne,kt,$e){switch($e.length){case 0:return Ne.call(kt);case 1:return Ne.call(kt,$e[0]);case 2:return Ne.call(kt,$e[0],$e[1]);case 3:return Ne.call(kt,$e[0],$e[1],$e[2])}return Ne.apply(kt,$e)},Dd=Math.max,ey=function(Ne,kt,$e){return kt=Dd(kt===void 0?Ne.length-1:kt,0),function(){for(var Oe=arguments,Lt=-1,rr=Dd(Oe.length-kt,0),Pt=Array(rr);++Lt<rr;)Pt[Lt]=Oe[kt+Lt];Lt=-1;for(var pr=Array(kt+1);++Lt<kt;)pr[Lt]=Oe[Lt];return pr[kt]=$e(Pt),Zv(Ne,this,pr)}},JS=function(Ne){return function(){return Ne}},Wp=function(){try{var pe=Fl(Object,"defineProperty");return pe({},"",{}),pe}catch{}}(),ty=Wp?function(pe,Ne){return Wp(pe,"toString",{configurable:!0,enumerable:!1,value:JS(Ne),writable:!0})}:zp,ch=Date.now,Gp=function(Ne){var kt=0,$e=0;return function(){var Oe=ch(),Lt=16-(Oe-$e);if($e=Oe,Lt>0){if(++kt>=800)return arguments[0]}else kt=0;return Ne.apply(void 0,arguments)}},ry=Gp(ty),ny=function(Ne,kt){return ry(ey(Ne,kt,zp),Ne+"")},lh=function(Ne){return typeof Ne=="number"&&Ne>-1&&Ne%1==0&&Ne<=9007199254740991},Kp=function(Ne){return Ne!=null&&lh(Ne.length)&&!Ip(Ne)},Jn=function(Ne){return Fs(Ne)&&Kp(Ne)},YS=ny(function(pe,Ne){return Jn(pe)?ih(pe,Ne):[]}),pu=YS;function XS(pe,Ne){return Ne instanceof RegExp?"__REGEXP "+Ne.toString():Ne}function On(pe,Ne,kt){var $e;Ne===void 0&&(Ne={});var Oe={};return Qn($e=ka(pe)).call($e,function(Lt){var rr=pe[Lt].type,Pt=kt?"In "+kt+", ":"";if(Ne[Lt]===void 0){if(pe[Lt].required===!1)return void(Oe[Lt]=Ne[Lt]);throw new Nl(Pt+'param "'+Lt+'" is required',{key:Lt},"required")}var pr=ZS[rr];if(pr&&!pr(Ne,Lt,pe[Lt]))throw new Nl(Pt+'param "'+Lt+'" expects '+Ao(pe[Lt],XS),{key:Lt,value:Ne[Lt]},Ao(pe[Lt]));Oe[Lt]=Ne[Lt]}),Oe}var ZS={string:function(Ne,kt,$e){var Oe=$e.allowEmpty,Lt=$e.max,rr=$e.min,Pt=$e.regExp,pr=Ne[kt];return typeof pr=="string"&&(Oe!==!1||pr!=="")&&!(typeof Lt=="number"&&pr.length>Lt)&&!(typeof rr=="number"&&pr.length<rr)&&!(IS(Pt)&&!Pt.test(pr))},number:function(Ne,kt,$e){var Oe=$e.min,Lt=$e.max,rr=Ne[kt];return typeof rr=="number"&&!(typeof Oe=="number"&&rr<Oe)&&!(typeof Lt=="number"&&rr>Lt)},boolean:function(Ne,kt){return typeof Ne[kt]=="boolean"},enum:function(Ne,kt,$e){var Oe=Fp($e),Lt=Ne[kt];return!Oe||Ba(Oe).call(Oe,Lt)>-1},array:function(Ne,kt,$e){var Oe,Lt=$e.itemType,rr=$e.rules,Pt=$e.min,pr=$e.max,yr=Fp($e),Pr=Ne[kt];return!!Es(Pr)&&!(typeof pr=="number"&&Pr.length>pr)&&!(typeof Pt=="number"&&Pr.length<Pt)&&!(Lt&&Lt!=="enum"&&!ou(Pr).call(Pr,function(Rr){return typeof Rr===Lt}))&&(Lt!=="enum"||!yr||!pu.apply(void 0,gi(Oe=[Pr]).call(Oe,yr)).length)&&(rr&&Qn(Pr).call(Pr,function(Rr,Vr){return On(rr,Rr,kt+"["+Vr+"]")}),!0)},object:function(Ne,kt,$e){var Oe=$e.rules,Lt=Ne[kt];return Oe&&On(Oe,Lt,kt),!0}},fu=Fl(hi,"Set"),eT=function(){},Qp=function(Ne){var kt=-1,$e=Array(Ne.size);return Ne.forEach(function(Oe){$e[++kt]=Oe}),$e},uh=fu&&1/Qp(new fu([,-0]))[1]==1/0?function(pe){return new fu(pe)}:eT,oy=uh,Jp=function(Ne,kt,$e){var Oe=-1,Lt=Hp,rr=Ne.length,Pt=!0,pr=[],yr=pr;if($e)Pt=!1,Lt=Xv;else if(rr>=200){var Pr=kt?null:oy(Ne);if(Pr)return Qp(Pr);Pt=!1,Lt=sh,yr=new oh}else yr=kt?[]:pr;e:for(;++Oe<rr;){var Rr=Ne[Oe],Vr=kt?kt(Rr):Rr;if(Rr=$e||Rr!==0?Rr:0,Pt&&Vr==Vr){for(var Dr=yr.length;Dr--;)if(yr[Dr]===Vr)continue e;kt&&yr.push(Vr),pr.push(Rr)}else Lt(yr,Vr,$e)||(yr!==pr&&yr.push(Vr),pr.push(Rr))}return pr},tT=function(Ne){return Ne&&Ne.length?Jp(Ne):[]},dh=`	
\v\f\r                　\u2028\u2029\uFEFF`,Yp=Ce("".replace),Xp="["+dh+"]",Ud=RegExp("^"+Xp+Xp+"*"),ay=RegExp(Xp+Xp+"*$"),Zp=function(pe){return function(Ne){var kt=rs(Sr(Ne));return 1&pe&&(kt=Yp(kt,Ud,"")),2&pe&&(kt=Yp(kt,ay,"")),kt}},sy={start:Zp(1),end:Zp(2),trim:Zp(3)}.trim,Vd=$.parseInt,ph=$.Symbol,ac=ph&&ph.iterator,Uo=/^[+-]?0x/i,ef=Ce(Uo.exec),Wi=Vd(dh+"08")!==8||Vd(dh+"0x16")!==22||ac&&!V(function(){Vd(Object(ac))})?function(Ne,kt){var $e=sy(rs(Ne));return Vd($e,kt>>>0||(ef(Uo,$e)?16:10))}:Vd;xn({global:!0,forced:parseInt!=Wi},{parseInt:Wi});var sc,na=Ir.parseInt,fh=(sc=function(){return(65536*(1+Math.random())|0).toString(16).substring(1)},function(){return sc()+sc()+sc()+sc()+sc()+sc()+sc()+sc()});function Ea(pe){var Ne;return ki(Ne=ka(pe)).call(Ne,function(kt){return!(+kt>=0)})}function iy(pe,Ne){var kt,$e=ki(kt=ka(pe)).call(kt,function(Oe){return pe[Oe]==Ne});return $e.length>0?$e[0]:void 0}var rT=TypeError,tf=Object.getOwnPropertyDescriptor,nT=qe&&!function(){if(this!==void 0)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(pe){return pe instanceof TypeError}}()?function(pe,Ne){if(Ms(pe)&&!tf(pe,"length").writable)throw rT("Cannot set read only .length");return pe.length=Ne}:function(pe,Ne){return pe.length=Ne},oT=TypeError,rf=function(pe,Ne){if(!delete pe[Ne])throw oT("Cannot delete property "+vn(Ne)+" of "+vn(pe))},aT=fc("splice"),mh=Math.max,gh=Math.min;xn({target:"Array",proto:!0,forced:!aT},{splice:function(Ne,kt){var $e,Oe,Lt,rr,Pt,pr,yr=In(this),Pr=Za(yr),Rr=Ai(Ne,Pr),Vr=arguments.length;for(Vr===0?$e=Oe=0:Vr===1?($e=0,Oe=Pr-Rr):($e=Vr-2,Oe=gh(mh(uc(kt),0),Pr-Rr)),$u(Pr+$e-Oe),Lt=Uu(yr,Oe),rr=0;rr<Oe;rr++)(Pt=Rr+rr)in yr&&ii(Lt,rr,yr[Pt]);if(Lt.length=Oe,$e<Oe){for(rr=Rr;rr<Pr-Oe;rr++)pr=rr+$e,(Pt=rr+Oe)in yr?yr[pr]=yr[Pt]:rf(yr,pr);for(rr=Pr;rr>Pr-Oe+$e;rr--)rf(yr,rr-1)}else if($e>Oe)for(rr=Pr-Oe;rr>Rr;rr--)pr=rr+$e-1,(Pt=rr+Oe-1)in yr?yr[pr]=yr[Pt]:rf(yr,pr);for(rr=0;rr<$e;rr++)yr[rr+Rr]=arguments[rr+2];return nT(yr,Pr-Oe+$e),Lt}});var sT=sa("Array").splice,nf=Array.prototype,cy=function(pe){var Ne=pe.splice;return pe===nf||sr(nf,pe)&&Ne===nf.splice?sT:Ne},of=function(pe,Ne,kt,$e){try{return $e?Ne(po(kt)[0],kt[1]):Ne(kt)}catch(Oe){sd(pe,"throw",Oe)}},qd=Array,ly=!Tg(function(pe){Array.from(pe)});xn({target:"Array",stat:!0,forced:ly},{from:function(Ne){var kt=In(Ne),$e=ml(this),Oe=arguments.length,Lt=Oe>1?arguments[1]:void 0,rr=Lt!==void 0;rr&&(Lt=Go(Lt,Oe>2?arguments[2]:void 0));var Pt,pr,yr,Pr,Rr,Vr,Dr=Ml(kt),Xr=0;if(!Dr||this===qd&&Dm(Dr))for(Pt=Za(kt),pr=$e?new this(Pt):qd(Pt);Pt>Xr;Xr++)Vr=rr?Lt(kt[Xr],Xr):kt[Xr],ii(pr,Xr,Vr);else for(Rr=(Pr=Sc(kt,Dr)).next,pr=$e?new this:[];!(yr=Fe(Rr,Pr)).done;Xr++)Vr=rr?of(Pr,Lt,[yr.value,Xr],!0):yr.value,ii(pr,Xr,Vr);return pr.length=Xr,pr}});var Xc=Ir.Array.from,fs=Ml;function uy(pe,Ne){var kt,$e=Ua!==void 0&&fs(pe)||pe["@@iterator"];if($e)return Zo(kt=($e=$e.call(pe)).next).call(kt,$e);if(Es(pe)||($e=function(rr,Pt){var pr;if(rr){if(typeof rr=="string")return dy(rr,Pt);var yr=$o(pr=Object.prototype.toString.call(rr)).call(pr,8,-1);if(yr==="Object"&&rr.constructor&&(yr=rr.constructor.name),yr==="Map"||yr==="Set")return Xc(rr);if(yr==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(yr))return dy(rr,Pt)}}(pe))||Ne&&pe&&typeof pe.length=="number"){$e&&(pe=$e);var Oe=0;return function(){return Oe>=pe.length?{done:!0}:{done:!1,value:pe[Oe++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function dy(pe,Ne){(Ne==null||Ne>pe.length)&&(Ne=pe.length);for(var kt=0,$e=new Array(Ne);kt<Ne;kt++)$e[kt]=pe[kt];return $e}var Ls,py=function(){function pe(){this.timerList=[],this.id=0,this.timer=null,this.timeout=0}var Ne=pe.prototype;return Ne.addTimer=function($e,Oe,Lt){Oe===void 0&&(Oe=0),Lt===void 0&&(Lt=1);var rr=new Date().getTime(),Pt=this.id;return this.timerList.push({id:Pt,loop:Lt,count:0,timeout:rr+Oe,interval:Oe,callback:$e}),this.id++,this.checkTimer(rr),Pt},Ne.checkTimer=function($e){if($e===void 0&&($e=new Date().getTime()),this.removeFinished(),this.timerList.length!==0||this.timer==null){for(var Oe,Lt,rr=0,Pt=uy(this.timerList);!(Oe=Pt()).done;){var pr=Oe.value;(rr===0||rr>pr.timeout)&&(rr=pr.timeout)}this.timerList.length!==0&&(this.timer===null||rr<this.timeout||this.timeout<$e)&&(this.timer=Ia(Zo(Lt=this.nowTime).call(Lt,this),rr-$e),this.timeout=rr)}},Ne.nowTime=function(){for(var $e,Oe=new Date().getTime(),Lt=uy(this.timerList);!($e=Lt()).done;){var rr=$e.value;Oe>=rr.timeout&&(rr.callback(),rr.count++,rr.timeout=Oe+rr.interval)}this.clerTime(),this.checkTimer(Oe)},Ne.clerTime=function(){this.timer!==null&&(clearTimeout(this.timer),this.timer=null)},Ne.deleteTimer=function($e){for(var Oe=this.timerList.length-1;Oe>=0;Oe--){var Lt;this.timerList[Oe].id===$e&&cy(Lt=this.timerList).call(Lt,Oe,1)}},Ne.removeFinished=function(){for(var $e=this.timerList.length-1;$e>=0;$e--){var Oe,Lt=this.timerList[$e];Lt.loop>=0&&Lt.count>=Lt.loop&&cy(Oe=this.timerList).call(Oe,$e,1)}},Ne.destroy=function(){this.clerTime(),this.timerList=[],this.id=0,this.timer=null},pe}(),fy=function(){function pe(kt){this.core=kt}var Ne=pe.prototype;return Ne.request=function($e,Oe){var Lt=this,rr=new Date().getTime();return Ca.request($e,Oe).catch(function(Pt){var pr,yr,Pr=Pt;throw Lt.core.reporter.reportTraceStart("exceptions",{user_id:Lt.core.options.account,trace_id:(yr=(pr=Lt.core)===null||pr===void 0?void 0:pr.socket)===null||yr===void 0?void 0:yr.sessionId,start_time:rr,action:1}),Lt.core.reporter.reportTraceUpdateV2("exceptions",{code:typeof Pr.code=="number"?Pr.code:0,description:Pr.message||""+Pr.code,operation_type:0,target:$e,context:Oe?Ao(Oe):""}),Lt.core.reporter.reportTraceEnd("exceptions",1),Pt})},Ne.uploadFile=function($e){var Oe=this,Lt=new Date().getTime();return Ca.uploadFile($e).catch(function(rr){var Pt,pr,yr=rr;Oe.core.reporter.reportTraceStart("exceptions",{user_id:Oe.core.options.account,trace_id:(pr=(Pt=Oe.core)===null||Pt===void 0?void 0:Pt.socket)===null||pr===void 0?void 0:pr.sessionId,start_time:Lt,action:1});var Pr=Ca.platform==="BROWSER"?$e.chunkUploadHost:$e.commonUploadHost?$e.commonUploadHost+"/"+($e.nosToken&&$e.nosToken.bucket):"https://nos.netease.com/nim";throw Oe.core.reporter.reportTraceUpdateV2("exceptions",{code:typeof yr.code=="number"?yr.code:0,description:yr.message||""+yr.code,operation_type:1,target:Pr}),Oe.core.reporter.reportTraceEnd("exceptions",1),rr})},pe}();(function(pe){pe[pe.ACTIVE=1]="ACTIVE",pe[pe.KICKED=2]="KICKED",pe[pe.OFFLINE=3]="OFFLINE"})(Ls||(Ls={}));var gy=window&&Ip(window.addEventListener)&&Ip(window.removeEventListener),Hd=function(pe){function Ne($e,Oe){var Lt;(Lt=pe.call(this)||this).status="unconnected",Lt.linkUrls=[],Lt.eventBus=new Lg,Lt.packetSer=1,Lt.retryCount=0,Lt.reconnectTimer=0,Lt.backoff=new iS({max:8e3,min:1600,jitter:.01}),Lt.sendingCmdMap=new Pl,Lt.pingTimer=0,Lt.config=Bv,Lt.abtInfo={},On({linkUrls:{type:"array",itemType:"string",required:!1}},$e),Lt.options=Vn(Vn({},Fv),$e),Lt.adapters=new fy(k(Lt));var rr=Ca.localStorage.getItem("__NIM_DEVC_ID__");Lt.options.isFixedDeviceId?(rr=Ca.localStorage.getItem("__NIM_DEVC_ID__")||fh(),Ca.localStorage.setItem("__NIM_DEVC_ID__",rr)):rr=fh(),Lt.config=Vn(Vn(Vn({},Bv),Oe),{deviceId:rr}),Lt.timerManager=new py,Lt.logger=new Vv(Lt.options.debugLevel,Lt.options.account);var Pt=Ca.getSystemInfo();return Lt.reporter=new qv({common:{app_key:$e.appkey,dev_id:rr,platform:"Web",sdk_ver:"0.13.1",env:"online",os_name:Pt.os,os_ver:Pt.osVer,model:Pt.hostEnvVer,manufactor:Pt.hostEnv,host_env:Pt.hostEnv,host_info:Pt.hostInfo,host_env_ver:Pt.hostEnvVer},request:Ca.request,logger:Lt.logger,autoStart:Ca.platform==="BROWSER"}),Ca.setLogger(Lt.logger),Lt.logger.log("Core init, version ","0.13.1"," sdk version ",91001," appkey ",$e.appkey),Lt}ea(Ne,pe);var kt=Ne.prototype;return kt.emit=function(Oe){try{for(var Lt,rr,Pt=xs(),pr=arguments.length,yr=new Array(pr>1?pr-1:0),Pr=1;Pr<pr;Pr++)yr[Pr-1]=arguments[Pr];var Rr=(Lt=pe.prototype.emit).call.apply(Lt,gi(rr=[this,Oe]).call(rr,yr)),Vr=xs()-Pt;return Vr>=10&&this.logger.warn("Core::emit event: "+Oe+" process takes: "+Vr+"ms"),Rr}catch(Dr){return this.logger.error("Core::emit event: "+Oe+". Error: "+Dr),!1}},kt.connect=function(Oe,Lt){return Oe===void 0&&(Oe={}),zr(this,void 0,void 0,_r.mark(function rr(){var Pt,pr,yr,Pr,Rr,Vr;return _r.wrap(function(Xr){for(;;)switch(Xr.prev=Xr.next){case 0:if(On({linkUrls:{type:"array",itemType:"string",required:!1}},Oe),/^(unconnected|waitReconnect)$/.test(this.status)){Xr.next=5;break}return Pt="Core socket status is "+this.status+", and would not connect",this.logger.warn(Pt),Xr.abrupt("return",xo.reject(Pt));case 5:this.status="connecting",Oe.linkUrls&&Oe.linkUrls.length>0&&(this.linkUrls=gi(pr=Oe.linkUrls).call(pr,this.linkUrls),this.linkUrls=tT(this.linkUrls)),this.linkUrls.length===0&&this.linkUrls.push("weblink.netease.im:443"),yr=0;case 9:if(!(yr<this.linkUrls.length)){Xr.next=32;break}return Pr=this.linkUrls[yr],Rr=new Date().getTime(),Xr.prev=12,Xr.next=15,this.doConnect(Pr);case 15:return this.status="connected",this.logger.log("core:: connect success with url: "+Pr),this.abtRequest(),Xr.abrupt("return",Pr);case 21:Xr.prev=21,Xr.t0=Xr.catch(12),Vr=Xr.t0,Lt&&Lt(Vr,Pr),this.reporter.reportTraceStart("exceptions",{user_id:this.options.account,start_time:Rr,action:0}),this.reporter.reportTraceUpdateV2("exceptions",{code:typeof Vr.code=="number"?Vr.code:0,description:Vr.message||""+Vr.code,operation_type:0,target:Pr}),this.reporter.reportTraceEnd("exceptions",1),this.logger.warn("core:: connect failed with url: "+Pr,Xr.t0);case 29:yr++,Xr.next=9;break;case 32:throw this.retryCount===0?this.doDisconnect(Ls.ACTIVE,"SocketHandshakeFailed"):this.doDisconnect(Ls.OFFLINE,"ReconnectHadRetryAllLinks"),new Error("core: socket handshake failed");case 34:case"end":return Xr.stop()}},rr,this,[[12,21]])}))},kt.doConnect=function(Oe){var Lt=this;return new xo(function(rr,Pt){var pr;Lt.socket=new wS(Lt,Oe,Lt.logger),Lt.socket.on("connect",function(){Lt.logger.log("socket on connect",Oe),rr()}),Lt.socket.on("message",Zo(pr=Lt.onMessage).call(pr,Lt)),Lt.socket.on("disconnect",function(yr){Lt.logger.log("core:: socket on disconnect",yr),Lt.doDisconnect(Ls.OFFLINE,"SocketOnDisconnect")}),Lt.socket.on("handshakeFailed",function(){Lt.logger.warn("core:: socket handshake failed"),Pt(new Bo("handshake failed",{},408))})})},kt.resetConnectStatus=function(){clearTimeout(this.reconnectTimer),this.backoff.reset(),this.retryCount=0,this.initOnlineListener()},kt.doDisconnect=function(Oe,Lt){if(this.logger.log("doDisconnect: type "+Oe+", description "+Lt),this.status!=="unconnected"){this.markAllCmdInvaild(new Bo("Packet timeout due to instance disconnect",{},408)),this.timerManager.destroy(),clearTimeout(this.pingTimer),this.socket&&(typeof this.socket.removeAllListeners=="function"&&this.socket.removeAllListeners(),typeof this.socket.close=="function"&&this.socket.close(),this.socket=void 0);var rr=!this.options.needReconnect||this.retryCount>=this.options.reconnectionAttempts;if(Oe===Ls.ACTIVE||rr)this.logger.log("doDisconnect: emit disconnect, type "+Oe,rr),this.status="unconnected",this.reconnectTimer&&clearTimeout(this.reconnectTimer),this.eventBus.emit("disconnect"),this.emit("disconnect"),this.destroyOnlineListener();else if(Oe===Ls.KICKED){this.logger.log("doDisconnect: kicked"),this.status="unconnected",this.reconnectTimer&&clearTimeout(this.reconnectTimer);var Pt=typeof Lt=="string"?{reason:"unknow",message:Lt}:Lt;this.eventBus.emit("kicked",Pt),this.emit("kicked",Pt),this.destroyOnlineListener()}else Oe===Ls.OFFLINE?(this.logger.log("doDisconnect: start to reconnect"),this.attempToReconnect()):this.logger.log("doDisconnect: nothing to do")}else this.logger.warn("doDisconnect: already unconnected")},kt.attempToReconnect=function(){var Oe=this;if(this.status!=="waitReconnect"){var Lt=this.backoff.duration();this.retryCount++,this.logger.log("willReconnect "+this.retryCount+" "+Lt),this.eventBus.emit("willReconnect",{retryCount:this.retryCount,duration:Lt}),this.emit("willReconnect",{retryCount:this.retryCount,duration:Lt}),this.status="waitReconnect",this.reconnectTimer&&clearTimeout(this.reconnectTimer),this.reconnectTimer=Ia(function(){Oe.status==="waitReconnect"?Oe.connect({isAutoReconnect:!0}).catch(function(){Oe.logger.error("core::attempToReconnect failed "+Oe.retryCount)}):Oe.logger.warn("doDisconnect: reconnectTimer status is "+Oe.status+", would not go on reconnecting")},Lt)}else this.logger.warn("doDisconnect: already is waiting reconnect")},kt.sendCmd=function(Oe,Lt,rr){var Pt=this;if(this.status!=="logined"&&Oe!=="login"&&Oe!=="chatroomLogin"&&Oe!=="qchatLogin")return this.logger.warn("nim status is "+this.status+", so can not sendCmd "+Oe),xo.reject({cmd:Oe,error:{code:"No_connected",message:"Connection not established",timetag:new Date().getTime()}});if(!this.socket||!this.socket.send)return xo.reject("No_socket");var pr=Oe!=="heartbeat",yr=pr?this.packetSer++:0,Pr=function(Dn,Fn,Gn,$n){var ho=Bd[Dn];if(!ho)return Gn.error("createCmd:: can not find cmd config: ",Dn),null;var co,oa={SER:Fn,SID:ho.sid,CID:ho.cid,Q:[]};return ho.params&&$n&&Qn(co=ho.params).call(co,function(so){var Gr=$n[so.name];if(!Wv(Gr)){var Kn=so.type,ro=so.reflectMapper;switch(so.type){case"PropertyArray":Kn="ArrayMable",Gr=Ro(Gr).call(Gr,function(Hn){return{t:"Property",v:ro?Is(Hn,ro):Hn}});break;case"Property":Gr=ro?Is(Gr,ro):Gr;break;case"Bool":case"bool":Gr=Gr?"true":"false"}oa.Q.push({t:Kn,v:Gr})}}),{packet:oa,isNoResponse:ho.isNoResponse||!1}}(Oe,yr,this.logger,Lt);if(!Pr){var Rr="SendCmd "+yr+" "+Oe+" error";return this.logger.error(Rr),xo.reject(Rr)}var Vr=Pr.packet,Dr=Pr.isNoResponse,Xr=Ao(Vr);pr&&(this.options.debugLevel==="debug"?this.logger.debug("core::sendCmd",Oe,"ser:"+yr,Xr):this.logger.log("core::sendCmd",Oe,"ser:"+yr));var kn=new Date().getTime();return new xo(function(Tn,Dn){Pt.sendingCmdMap.set(yr,{cmd:Oe,params:Lt,callback:[Tn,Dn],timer:Dr?null:Ia(function(){var Gn,$n=new Gg(504,Oe,"Packet Timeout",new Date().getTime(),{message:"ser "+yr+" cmd "+Oe+" timeout"});$n.callFunc="sendCmd",Pt.markCmdInvalid(yr,$n,Oe),Pt.reporter.reportTraceStart("exceptions",{user_id:Pt.options.account,trace_id:(Gn=Pt.socket)===null||Gn===void 0?void 0:Gn.sessionId,start_time:kn,action:2}),Pt.reporter.reportTraceUpdateV2("exceptions",{code:408,description:"Packet timeout",operation_type:1,target:Vr.SID+"-"+Vr.CID,context:""+Vr.SER}),Pt.reporter.reportTraceEnd("exceptions",1)},rr&&rr.timeout?rr.timeout:Pt.config.timeout)});try{Pt.socket.send(Xr)}catch(Gn){var Fn=new Gg(415,Oe,Gn&&Gn.message||"Unable to send packet",new Date().getTime(),{message:"send json error",rawError:Gn});Fn.callFunc="sendCmd",Pt.markCmdInvalid(yr,Fn,Oe),Dn(Gn)}})},kt.onMessage=function(Oe){var Lt=ps(Oe,this.logger);if(Lt){var rr=Lt.raw.ser;if(Lt.error&&this.logger.error("core:onMessage packet error",Lt.raw.sid+"_"+Lt.raw.cid+", ser:"+rr+",",Lt.error),!Lt.notFound)return Lt.cmd!=="heartbeat"&&(this.options.debugLevel==="debug"?this.logger.debug("imsocket::recvCmd ser:"+rr,Lt.cmd,Lt.content):this.logger.log("imsocket::recvCmd ser:"+rr,Lt.cmd)),Lt.__receiveTime=xs(),Lt;this.logger.warn("core::onMessage packet not found",Lt.raw.sid+"_"+Lt.raw.cid+", ser:"+rr)}},kt.markCmdInvalid=function(Oe,Lt,rr){var Pt=this.sendingCmdMap.get(Oe);if(Pt){var pr=Pt.callback,yr=Pt.timer;yr&&clearTimeout(yr),this.sendingCmdMap.delete(Oe),this.logger.warn("packet "+Oe+", "+rr+" is invalid:",Lt),pr[1](Lt)}},kt.markAllCmdInvaild=function(Oe){var Lt;this.logger.log("markAllCmdInvaild"),Qn(Lt=this.sendingCmdMap).call(Lt,function(rr){var Pt=rr.callback,pr=rr.timer;pr&&clearTimeout(pr),Pt[1](Oe)}),this.sendingCmdMap.clear()},kt.ping=function(){return zr(this,void 0,void 0,_r.mark(function Oe(){var Lt=this;return _r.wrap(function(Pt){for(;;)switch(Pt.prev=Pt.next){case 0:return clearTimeout(this.pingTimer),Pt.prev=1,Pt.next=4,this.sendCmd("heartbeat");case 4:Pt.next=14;break;case 6:return Pt.prev=6,Pt.t0=Pt.catch(1),Pt.next=10,this.testHeartBeat5Timeout();case 10:if(!Pt.sent){Pt.next=14;break}return this.doDisconnect(Ls.OFFLINE,"PingError"),Pt.abrupt("return");case 14:this.pingTimer=Ia(function(){Lt.ping()},3e4);case 15:case"end":return Pt.stop()}},Oe,this,[[1,6]])}))},kt.testHeartBeat5Timeout=function(){return zr(this,void 0,void 0,_r.mark(function Oe(){var Lt;return _r.wrap(function(Pt){for(;;)switch(Pt.prev=Pt.next){case 0:clearTimeout(this.pingTimer),Lt=0;case 2:if(!(Lt<5)){Pt.next=15;break}return Pt.prev=3,Pt.next=6,this.sendCmd("heartbeat",{},{timeout:3e3});case 6:return Pt.abrupt("return",!1);case 9:Pt.prev=9,Pt.t0=Pt.catch(3),this.logger.debug("core:: test heartbeat "+Lt+" Timeout");case 12:Lt++,Pt.next=2;break;case 15:return Pt.abrupt("return",!0);case 16:case"end":return Pt.stop()}},Oe,this,[[3,9]])}))},kt.initOnlineListener=function(){var Oe,Lt;this.onlineListener||(gy?(this.onlineListener=Zo(Oe=function(){this.status==="logined"&&this.ping()}).call(Oe,this),this.offlineListener=Zo(Lt=function(){this.logger.log("offline"),this.doDisconnect(Ls.OFFLINE,"OfflineListener")}).call(Lt,this),window.addEventListener("online",this.onlineListener),window.addEventListener("offline",this.offlineListener)):this.logger.warn("initOnlineListener not support add listener"))},kt.destroyOnlineListener=function(){this.onlineListener&&(window.removeEventListener("online",this.onlineListener),this.onlineListener=void 0),this.offlineListener&&(window.removeEventListener("offline",this.offlineListener),this.offlineListener=void 0)},kt.disconnect=function(){switch(this.status){case"connected":case"logined":case"connecting":case"waitReconnect":return this.doDisconnect(Ls.ACTIVE,"UserActiveDisconnect"),xo.resolve();case"unconnected":case"destroyed":return xo.resolve()}},kt.destroy=function(){var Oe=this;return this.disconnect().then(function(){Oe.status="destroyed",Oe.removeAllListeners(),Oe.eventBus.removeAllListeners(),Oe.reporter.destroy(),Oe.connect=function(){return xo.resolve()},Oe.disconnect=function(){return xo.resolve()},Oe.destroy=function(){return xo.resolve()}})},kt.abtRequest=function(){var Oe,Lt;return zr(this,void 0,void 0,_r.mark(function rr(){var Pt,pr;return _r.wrap(function(Pr){for(;;)switch(Pr.prev=Pr.next){case 0:if(this.options.isAbtestEnable){Pr.next=2;break}return Pr.abrupt("return");case 2:if(!this.abtInfo.experiments){Pr.next=4;break}return Pr.abrupt("return");case 4:if(this.options.abtestUrl){Pr.next=6;break}return Pr.abrupt("return");case 6:return Pr.prev=6,Pr.next=9,this.adapters.request(this.options.abtestUrl,{method:"POST",dataType:"json",headers:{sdktype:"ABTest"},data:{clientInfo:{projectKey:this.options.abtestProjectKey,appKey:this.options.appkey,osType:"Web",sdkVersion:"0.13.1",deviceId:this.config.deviceId},useLocalCache:!0}});case 9:Pt=Pr.sent,Pr.next=15;break;case 12:Pr.prev=12,Pr.t0=Pr.catch(6),this.logger.warn("ABTest request failed");case 15:this.abtInfo=((Lt=(Oe=Pt==null?void 0:Pt.data)===null||Oe===void 0?void 0:Oe.data)===null||Lt===void 0?void 0:Lt.abtInfo)||{},this.abtInfo.experiments&&this.abtInfo.experiments.length>0&&this.reporter.reportImmediately("https://statistic.live.126.net/statics/report/abtest/result",{params:{app_key:this.options.appkey,biz_sdk_type:"IM",sdk_ver:"0.13.1",device_id:this.config.deviceId,platform:"Web",projectKey:this.options.abtestProjectKey,experiments:Ro(pr=this.abtInfo.experiments).call(pr,function(Rr){return{experimentKey:Rr.experimentKey,schemeKey:Rr.schemeKey}})},headers:{sdktype:"ABTest"},method:"POST",dataType:"json"});case 17:case"end":return Pr.stop()}},rr,this,[[6,12]])}))},Ne}(Lg);Hd.setAdapters=function(Ne){Vn(Ca,Ne)};var hy=Ws.some,Gi=fi("some");xn({target:"Array",proto:!0,forced:!Gi},{some:function(Ne){return hy(this,Ne,arguments.length>1?arguments[1]:void 0)}});var af=sa("Array").some,hh=Array.prototype,sf=function(pe){var Ne=pe.some;return pe===hh||sr(hh,pe)&&Ne===hh.some?af:Ne},vh=function(){this.__data__=new Dp,this.size=0},yh=function(Ne){var kt=this.__data__,$e=kt.delete(Ne);return this.size=kt.size,$e},iT=function(Ne){return this.__data__.get(Ne)},cT=function(Ne){return this.__data__.has(Ne)},lT=function(Ne,kt){var $e=this.__data__;if($e instanceof Dp){var Oe=$e.__data__;if(!Yc||Oe.length<199)return Oe.push([Ne,kt]),this.size=++$e.size,this;$e=this.__data__=new Ll(Oe)}return $e.set(Ne,kt),this.size=$e.size,this};function mu(pe){var Ne=this.__data__=new Dp(pe);this.size=Ne.size}mu.prototype.clear=vh,mu.prototype.delete=yh,mu.prototype.get=iT,mu.prototype.has=cT,mu.prototype.set=lT;var cf=mu,vy=function(Ne,kt){for(var $e=-1,Oe=Ne==null?0:Ne.length;++$e<Oe;)if(kt(Ne[$e],$e,Ne))return!0;return!1},bh=function(Ne,kt,$e,Oe,Lt,rr){var Pt=1&$e,pr=Ne.length,yr=kt.length;if(pr!=yr&&!(Pt&&yr>pr))return!1;var Pr=rr.get(Ne),Rr=rr.get(kt);if(Pr&&Rr)return Pr==kt&&Rr==Ne;var Vr=-1,Dr=!0,Xr=2&$e?new oh:void 0;for(rr.set(Ne,kt),rr.set(kt,Ne);++Vr<pr;){var kn=Ne[Vr],Tn=kt[Vr];if(Oe)var Dn=Pt?Oe(Tn,kn,Vr,kt,Ne,rr):Oe(kn,Tn,Vr,Ne,kt,rr);if(Dn!==void 0){if(Dn)continue;Dr=!1;break}if(Xr){if(!vy(kt,function(Fn,Gn){if(!sh(Xr,Gn)&&(kn===Fn||Lt(kn,Fn,$e,Oe,rr)))return Xr.push(Gn)})){Dr=!1;break}}else if(kn!==Tn&&!Lt(kn,Tn,$e,Oe,rr)){Dr=!1;break}}return rr.delete(Ne),rr.delete(kt),Dr},yy=hi.Uint8Array,uT=function(Ne){var kt=-1,$e=Array(Ne.size);return Ne.forEach(function(Oe,Lt){$e[++kt]=[Lt,Oe]}),$e},zd=tc?tc.prototype:void 0,$l=zd?zd.valueOf:void 0,Sh=function(Ne,kt,$e,Oe,Lt,rr,Pt){switch($e){case"[object DataView]":if(Ne.byteLength!=kt.byteLength||Ne.byteOffset!=kt.byteOffset)return!1;Ne=Ne.buffer,kt=kt.buffer;case"[object ArrayBuffer]":return!(Ne.byteLength!=kt.byteLength||!rr(new yy(Ne),new yy(kt)));case"[object Boolean]":case"[object Date]":case"[object Number]":return Lp(+Ne,+kt);case"[object Error]":return Ne.name==kt.name&&Ne.message==kt.message;case"[object RegExp]":case"[object String]":return Ne==kt+"";case"[object Map]":var pr=uT;case"[object Set]":var yr=1&Oe;if(pr||(pr=Qp),Ne.size!=kt.size&&!yr)return!1;var Pr=Pt.get(Ne);if(Pr)return Pr==kt;Oe|=2,Pt.set(Ne,kt);var Rr=bh(pr(Ne),pr(kt),Oe,Lt,rr,Pt);return Pt.delete(Ne),Rr;case"[object Symbol]":if($l)return $l.call(Ne)==$l.call(kt)}return!1},oi=function(Ne,kt){for(var $e=-1,Oe=kt.length,Lt=Ne.length;++$e<Oe;)Ne[Lt+$e]=kt[$e];return Ne},ic=Array.isArray,lf=function(Ne,kt,$e){var Oe=kt(Ne);return ic(Ne)?Oe:oi(Oe,$e(Ne))},ss=function(Ne,kt){for(var $e=-1,Oe=Ne==null?0:Ne.length,Lt=0,rr=[];++$e<Oe;){var Pt=Ne[$e];kt(Pt,$e,Ne)&&(rr[Lt++]=Pt)}return rr},by=function(){return[]},Th=Object.prototype.propertyIsEnumerable,Ch=Object.getOwnPropertySymbols,dT=Ch?function(pe){return pe==null?[]:(pe=Object(pe),ss(Ch(pe),function(Ne){return Th.call(pe,Ne)}))}:by,Mh=dT,pT=function(Ne,kt){for(var $e=-1,Oe=Array(Ne);++$e<Ne;)Oe[$e]=kt($e);return Oe},uf=function(Ne){return Fs(Ne)&&Mi(Ne)=="[object Arguments]"},kh=Object.prototype,gu=kh.hasOwnProperty,fT=kh.propertyIsEnumerable,wh=uf(function(){return arguments}())?uf:function(pe){return Fs(pe)&&gu.call(pe,"callee")&&!fT.call(pe,"callee")},_h=wh,mT=function(){return!1},xh=g(function(pe,Ne){var kt=Ne&&!Ne.nodeType&&Ne,$e=kt&&pe&&!pe.nodeType&&pe,Oe=$e&&$e.exports===kt?hi.Buffer:void 0,Lt=(Oe?Oe.isBuffer:void 0)||mT;pe.exports=Lt}),Sy=/^(?:0|[1-9]\d*)$/,Wd=function(Ne,kt){var $e=typeof Ne;return!!(kt=kt??9007199254740991)&&($e=="number"||$e!="symbol"&&Sy.test(Ne))&&Ne>-1&&Ne%1==0&&Ne<kt},Ga={};Ga["[object Float32Array]"]=Ga["[object Float64Array]"]=Ga["[object Int8Array]"]=Ga["[object Int16Array]"]=Ga["[object Int32Array]"]=Ga["[object Uint8Array]"]=Ga["[object Uint8ClampedArray]"]=Ga["[object Uint16Array]"]=Ga["[object Uint32Array]"]=!0,Ga["[object Arguments]"]=Ga["[object Array]"]=Ga["[object ArrayBuffer]"]=Ga["[object Boolean]"]=Ga["[object DataView]"]=Ga["[object Date]"]=Ga["[object Error]"]=Ga["[object Function]"]=Ga["[object Map]"]=Ga["[object Number]"]=Ga["[object Object]"]=Ga["[object RegExp]"]=Ga["[object Set]"]=Ga["[object String]"]=Ga["[object WeakMap]"]=!1;var Ty=function(Ne){return Fs(Ne)&&lh(Ne.length)&&!!Ga[Mi(Ne)]},Ih=au&&au.isTypedArray,Ac=Ih?eh(Ih):Ty,Cy=Object.prototype.hasOwnProperty,My=function(Ne,kt){var $e=ic(Ne),Oe=!$e&&_h(Ne),Lt=!$e&&!Oe&&xh(Ne),rr=!$e&&!Oe&&!Lt&&Ac(Ne),Pt=$e||Oe||Lt||rr,pr=Pt?pT(Ne.length,String):[],yr=pr.length;for(var Pr in Ne)!kt&&!Cy.call(Ne,Pr)||Pt&&(Pr=="length"||Lt&&(Pr=="offset"||Pr=="parent")||rr&&(Pr=="buffer"||Pr=="byteLength"||Pr=="byteOffset")||Wd(Pr,yr))||pr.push(Pr);return pr},gT=Object.prototype,ky=function(Ne){var kt=Ne&&Ne.constructor;return Ne===(typeof kt=="function"&&kt.prototype||gT)},wy=function(Ne,kt){return function($e){return Ne(kt($e))}},_y=wy(Object.keys,Object),hT=Object.prototype.hasOwnProperty,Eh=function(Ne){if(!ky(Ne))return _y(Ne);var kt=[];for(var $e in Object(Ne))hT.call(Ne,$e)&&$e!="constructor"&&kt.push($e);return kt},Zc=function(Ne){return Kp(Ne)?My(Ne):Eh(Ne)},Ph=function(Ne){return lf(Ne,Zc,Mh)},vT=Object.prototype.hasOwnProperty,xy=function(Ne,kt,$e,Oe,Lt,rr){var Pt=1&$e,pr=Ph(Ne),yr=pr.length;if(yr!=Ph(kt).length&&!Pt)return!1;for(var Pr=yr;Pr--;){var Rr=pr[Pr];if(!(Pt?Rr in kt:vT.call(kt,Rr)))return!1}var Vr=rr.get(Ne),Dr=rr.get(kt);if(Vr&&Dr)return Vr==kt&&Dr==Ne;var Xr=!0;rr.set(Ne,kt),rr.set(kt,Ne);for(var kn=Pt;++Pr<yr;){var Tn=Ne[Rr=pr[Pr]],Dn=kt[Rr];if(Oe)var Fn=Pt?Oe(Dn,Tn,Rr,kt,Ne,rr):Oe(Tn,Dn,Rr,Ne,kt,rr);if(!(Fn===void 0?Tn===Dn||Lt(Tn,Dn,$e,Oe,rr):Fn)){Xr=!1;break}kn||(kn=Rr=="constructor")}if(Xr&&!kn){var Gn=Ne.constructor,$n=kt.constructor;Gn==$n||!("constructor"in Ne)||!("constructor"in kt)||typeof Gn=="function"&&Gn instanceof Gn&&typeof $n=="function"&&$n instanceof $n||(Xr=!1)}return rr.delete(Ne),rr.delete(kt),Xr},Nc=Fl(hi,"DataView"),us=Fl(hi,"Promise"),hu=Fl(hi,"WeakMap"),Va="[object Map]",wi="[object Promise]",Iy="[object Set]",Ps="[object WeakMap]",Ah="[object DataView]",Nh=Rl(Nc),yT=Rl(Yc),bT=Rl(us),Ey=Rl(fu),ST=Rl(hu),jl=Mi;(Nc&&jl(new Nc(new ArrayBuffer(1)))!=Ah||Yc&&jl(new Yc)!=Va||us&&jl(us.resolve())!=wi||fu&&jl(new fu)!=Iy||hu&&jl(new hu)!=Ps)&&(jl=function(pe){var Ne=Mi(pe),kt=Ne=="[object Object]"?pe.constructor:void 0,$e=kt?Rl(kt):"";if($e)switch($e){case Nh:return Ah;case yT:return Va;case bT:return wi;case Ey:return Iy;case ST:return Ps}return Ne});var Gd=jl,_i="[object Arguments]",Oh="[object Array]",df="[object Object]",Kd=Object.prototype.hasOwnProperty,Py=function(Ne,kt,$e,Oe,Lt,rr){var Pt=ic(Ne),pr=ic(kt),yr=Pt?Oh:Gd(Ne),Pr=pr?Oh:Gd(kt),Rr=(yr=yr==_i?df:yr)==df,Vr=(Pr=Pr==_i?df:Pr)==df,Dr=yr==Pr;if(Dr&&xh(Ne)){if(!xh(kt))return!1;Pt=!0,Rr=!1}if(Dr&&!Rr)return rr||(rr=new cf),Pt||Ac(Ne)?bh(Ne,kt,$e,Oe,Lt,rr):Sh(Ne,kt,yr,$e,Oe,Lt,rr);if(!(1&$e)){var Xr=Rr&&Kd.call(Ne,"__wrapped__"),kn=Vr&&Kd.call(kt,"__wrapped__");if(Xr||kn){var Tn=Xr?Ne.value():Ne,Dn=kn?kt.value():kt;return rr||(rr=new cf),Lt(Tn,Dn,$e,Oe,rr)}}return!!Dr&&(rr||(rr=new cf),xy(Ne,kt,$e,Oe,Lt,rr))},Rh=function pe(Ne,kt,$e,Oe,Lt){return Ne===kt||(Ne==null||kt==null||!Fs(Ne)&&!Fs(kt)?Ne!=Ne&&kt!=kt:Py(Ne,kt,$e,Oe,pe,Lt))},TT=function(Ne,kt,$e,Oe){var Lt=$e.length,rr=Lt,Pt=!Oe;if(Ne==null)return!rr;for(Ne=Object(Ne);Lt--;){var pr=$e[Lt];if(Pt&&pr[2]?pr[1]!==Ne[pr[0]]:!(pr[0]in Ne))return!1}for(;++Lt<rr;){var yr=(pr=$e[Lt])[0],Pr=Ne[yr],Rr=pr[1];if(Pt&&pr[2]){if(Pr===void 0&&!(yr in Ne))return!1}else{var Vr=new cf;if(Oe)var Dr=Oe(Pr,Rr,yr,Ne,kt,Vr);if(!(Dr===void 0?Rh(Rr,Pr,3,Oe,Vr):Dr))return!1}}return!0},Ay=function(Ne){return Ne==Ne&&!Ui(Ne)},CT=function(Ne){for(var kt=Zc(Ne),$e=kt.length;$e--;){var Oe=kt[$e],Lt=Ne[Oe];kt[$e]=[Oe,Lt,Ay(Lt)]}return kt},Bh=function(Ne,kt){return function($e){return $e!=null&&$e[Ne]===kt&&(kt!==void 0||Ne in Object($e))}},Ny=function(Ne){var kt=CT(Ne);return kt.length==1&&kt[0][2]?Bh(kt[0][0],kt[0][1]):function($e){return $e===Ne||TT($e,Ne,kt)}},pf=function(Ne){return typeof Ne=="symbol"||Fs(Ne)&&Mi(Ne)=="[object Symbol]"},MT=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,kT=/^\w*$/,Qd=function(Ne,kt){if(ic(Ne))return!1;var $e=typeof Ne;return!($e!="number"&&$e!="symbol"&&$e!="boolean"&&Ne!=null&&!pf(Ne))||kT.test(Ne)||!MT.test(Ne)||kt!=null&&Ne in Object(kt)};function Fh(pe,Ne){if(typeof pe!="function"||Ne!=null&&typeof Ne!="function")throw new TypeError("Expected a function");var kt=function(){var $e=arguments,Oe=Ne?Ne.apply(this,$e):$e[0],Lt=kt.cache;if(Lt.has(Oe))return Lt.get(Oe);var rr=pe.apply(this,$e);return kt.cache=Lt.set(Oe,rr)||Lt,rr};return kt.cache=new(Fh.Cache||Ll),kt}Fh.Cache=Ll;var ff=Fh,wT=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,mf=/\\(\\)?/g,Ka=function(Ne){var kt=ff(Ne,function(Oe){return $e.size===500&&$e.clear(),Oe}),$e=kt.cache;return kt}(function(pe){var Ne=[];return pe.charCodeAt(0)===46&&Ne.push(""),pe.replace(wT,function(kt,$e,Oe,Lt){Ne.push(Oe?Lt.replace(mf,"$1"):$e||kt)}),Ne}),_T=Ka,Lh=tc?tc.prototype:void 0,$h=Lh?Lh.toString:void 0,xT=function pe(Ne){if(typeof Ne=="string")return Ne;if(ic(Ne))return du(Ne,pe)+"";if(pf(Ne))return $h?$h.call(Ne):"";var kt=Ne+"";return kt=="0"&&1/Ne==-1/0?"-0":kt},Oy=function(Ne){return Ne==null?"":xT(Ne)},gf=function(Ne,kt){return ic(Ne)?Ne:Qd(Ne,kt)?[Ne]:_T(Oy(Ne))},Dl=function(Ne){if(typeof Ne=="string"||pf(Ne))return Ne;var kt=Ne+"";return kt=="0"&&1/Ne==-1/0?"-0":kt},jh=function(Ne,kt){for(var $e=0,Oe=(kt=gf(kt,Ne)).length;Ne!=null&&$e<Oe;)Ne=Ne[Dl(kt[$e++])];return $e&&$e==Oe?Ne:void 0},ys=function(Ne,kt,$e){var Oe=Ne==null?void 0:jh(Ne,kt);return Oe===void 0?$e:Oe},IT=function(Ne,kt){return Ne!=null&&kt in Object(Ne)},Jd=function(Ne,kt,$e){for(var Oe=-1,Lt=(kt=gf(kt,Ne)).length,rr=!1;++Oe<Lt;){var Pt=Dl(kt[Oe]);if(!(rr=Ne!=null&&$e(Ne,Pt)))break;Ne=Ne[Pt]}return rr||++Oe!=Lt?rr:!!(Lt=Ne==null?0:Ne.length)&&lh(Lt)&&Wd(Pt,Lt)&&(ic(Ne)||_h(Ne))},Ry=function(Ne,kt){return Ne!=null&&Jd(Ne,kt,IT)},ET=function(Ne,kt){return Qd(Ne)&&Ay(kt)?Bh(Dl(Ne),kt):function($e){var Oe=ys($e,Ne);return Oe===void 0&&Oe===kt?Ry($e,Ne):Rh(kt,Oe,3)}},Dh=function(Ne){return function(kt){return kt==null?void 0:kt[Ne]}},PT=function(Ne){return function(kt){return jh(kt,Ne)}},AT=function(Ne){return Qd(Ne)?Dh(Dl(Ne)):PT(Ne)},bs=function(Ne){return typeof Ne=="function"?Ne:Ne==null?zp:typeof Ne=="object"?ic(Ne)?ET(Ne[0],Ne[1]):Ny(Ne):AT(Ne)},NT=function(Ne,kt,$e){kt=="__proto__"&&Wp?Wp(Ne,kt,{configurable:!0,enumerable:!0,value:$e,writable:!0}):Ne[kt]=$e},Uh=Object.prototype.hasOwnProperty,By=function(Ne,kt,$e){var Oe=Ne[kt];Uh.call(Ne,kt)&&Lp(Oe,$e)&&($e!==void 0||kt in Ne)||NT(Ne,kt,$e)},OT=function(Ne,kt,$e,Oe){if(!Ui(Ne))return Ne;for(var Lt=-1,rr=(kt=gf(kt,Ne)).length,Pt=rr-1,pr=Ne;pr!=null&&++Lt<rr;){var yr=Dl(kt[Lt]),Pr=$e;if(yr==="__proto__"||yr==="constructor"||yr==="prototype")return Ne;if(Lt!=Pt){var Rr=pr[yr];(Pr=Oe?Oe(Rr,yr,pr):void 0)===void 0&&(Pr=Ui(Rr)?Rr:Wd(kt[Lt+1])?[]:{})}By(pr,yr,Pr),pr=pr[yr]}return Ne},Fy=function(Ne,kt,$e){for(var Oe=-1,Lt=kt.length,rr={};++Oe<Lt;){var Pt=kt[Oe],pr=jh(Ne,Pt);$e(pr,Pt)&&OT(rr,gf(Pt,Ne),pr)}return rr},Ly=wy(Object.getPrototypeOf,Object),Yd=Object.getOwnPropertySymbols?function(pe){for(var Ne=[];pe;)oi(Ne,Mh(pe)),pe=Ly(pe);return Ne}:by,RT=function(Ne){var kt=[];if(Ne!=null)for(var $e in Object(Ne))kt.push($e);return kt},BT=Object.prototype.hasOwnProperty,$y=function(Ne){if(!Ui(Ne))return RT(Ne);var kt=ky(Ne),$e=[];for(var Oe in Ne)(Oe!="constructor"||!kt&&BT.call(Ne,Oe))&&$e.push(Oe);return $e},FT=function(Ne){return Kp(Ne)?My(Ne,!0):$y(Ne)},LT=function(Ne){return lf(Ne,FT,Yd)},Vh,jy,Dy=function(Ne,kt){if(Ne==null)return{};var $e=du(LT(Ne),function(Oe){return[Oe]});return kt=bs(kt),Fy(Ne,$e,function(Oe,Lt){return kt(Oe,Lt[0])})},Uy={"6_2":"getNosToken","6_22":"getOriginUrl","6_26":"getNosCdnHost","6_27":"getGrayscaleConfig","6_28":"getMixStorePolicy","6_29":"getMixStoreToken","6_30":"getFileAuthToken"},vu={nosToken:{objectName:1,token:2,bucket:3,expireTime:4,expireSec:7,tag:8,shortUrl:9},mixStoreTokenReqTag:{provider:0,tokenCount:1,fileExpireSec:2,tag:3,returnBody:4},nosConfigTag:{bucket:1,cdnDomain:2,expire:3,objectNamePrefix:4},grayConfigTag:{config:0,ttl:1},mixStorePolicyTag:{providers:0,ttl:1,mixEnable:2,nosPolicy:3,s3Policy:4},mixStoreTokenResTag:{provider:0,accessKeyId:1,secretAccessKey:2,sessionToken:3,token:4,expireTime:5,bucket:6,objectName:7,fileExpireSec:8,tag:9,shortUrl:10,region:11},nosSafeUrlTag:{safeUrl:0,originUrl:1},mixStoreAuthTokenReqTag:{type:1,urls:2},mixStoreAuthTokenResTag:{type:1,tokens:2,token:3,ttl:4}},Ul=Qc(vu),qh={getNosToken:{sid:6,cid:2,service:"cloudStorage",response:[{type:"Property",name:"nosToken",reflectMapper:Ul.nosToken}],params:[{type:"String",name:"responseBody"},{type:"Property",name:"nosToken",entity:"nosToken",reflectMapper:vu.nosToken}]},getOriginUrl:{sid:6,cid:22,service:"cloudStorage",response:[{type:"Property",name:"nosSafeUrlTag",reflectMapper:Ul.nosSafeUrlTag}],params:[{type:"Property",name:"nosSafeUrlTag",reflectMapper:vu.nosSafeUrlTag}]},getNosCdnHost:{sid:6,cid:26,service:"misc",response:[{type:"Property",name:"nosConfigTag",reflectMapper:Ul.nosConfigTag}]},getGrayscaleConfig:{sid:6,cid:27,service:"cloudStorage",response:[{type:"Property",name:"grayConfigTag",reflectMapper:Ul.grayConfigTag}],params:[{type:"Property",name:"config"}]},getMixStorePolicy:{sid:6,cid:28,service:"cloudStorage",params:[{type:"LongArray",name:"supportType"}],response:[{type:"Property",name:"mixStorePolicyTag",reflectMapper:Ul.mixStorePolicyTag}]},getMixStoreToken:{sid:6,cid:29,service:"cloudStorage",params:[{type:"Property",name:"mixStoreTokenReqTag",reflectMapper:vu.mixStoreTokenReqTag}],response:[{type:"Property",name:"mixStoreTokenResTag",reflectMapper:Ul.mixStoreTokenResTag}]},getFileAuthToken:{sid:6,cid:30,service:"cloudStorage",params:[{type:"Property",name:"mixStoreAuthTokenReqTag",reflectMapper:vu.mixStoreAuthTokenReqTag}],response:[{type:"Property",name:"mixStoreAuthTokenResTag",reflectMapper:Ul.mixStoreAuthTokenResTag}]}};(function(pe){pe[pe.nos=1]="nos",pe[pe.s3=2]="s3"})(Vh||(Vh={})),function(pe){pe[pe.dontNeed=-1]="dontNeed",pe[pe.time=2]="time",pe[pe.urls=3]="urls"}(jy||(jy={}));var vi,cc,$T={chunkUploadHost:"https://wanproxy-web.127.net",commonUploadHost:"https://nos.netease.com",chunkMaxSize:4194304e4,commonMaxSize:104857600,uploadReplaceFormat:"https://{host}/{object}",cdn:{defaultCdnDomain:"nim.nosdn.127.net",cdnDomain:"",bucket:"",objectNamePrefix:""},downloadUrl:"https://{bucket}-nosdn.netease.im/{object}",downloadHostList:["nos.netease.com"],nosCdnEnable:!0,isNeedToGetUploadPolicyFromServer:!0},el={file:{md5:"$(Etag)",size:"$(ObjectSize)"},image:{md5:"$(Etag)",size:"$(ObjectSize)",w:"$(ImageInfo.Width)",h:"$(ImageInfo.Height)",orientation:"$(ImageInfo.Orientation)"},audio:{md5:"$(Etag)",size:"$(ObjectSize)",dur:"$(AVinfo.Audio.Duration)"},video:{md5:"$(Etag)",size:"$(ObjectSize)",dur:"$(AVinfo.Video.Duration)",w:"$(AVinfo.Video.Width)",h:"$(AVinfo.Video.Height)"}},Hh={accessKeyId:"",secretAccessKey:"",sessionToken:"",region:"",maxRetries:0,bucket:"",objectName:"",token:"",shortUrl:""};function zh(pe){return pe===void 0&&(pe="file"),Ao(el[pe]||{}).replace(/"/gi,'\\"')}(function(pe){pe[pe.nos=1]="nos",pe[pe.s3=2]="s3"})(vi||(vi={})),function(pe){pe[pe.dontNeed=-1]="dontNeed",pe[pe.time=2]="time",pe[pe.urls=3]="urls"}(cc||(cc={}));var Vy=function(){function pe(kt,$e){$e===void 0&&($e={}),this.GRAYKEY="AllGrayscaleConfig",this.MIXSTOREKEY="AllMixStorePolicy",this.config={},this.nosCdnHostTimer=0,this.grayConfig={mixStoreEnable:!1,timeStamp:0,ttl:0},this.mixStorePolicy={providers:[],timeStamp:0,ttl:0,s3Policy:null,nosPolicy:null},this.curProvider=vi.nos,this.s3=null,this.mixStoreErrorCount=10,this.nosErrorCount=0,this.circuitTimer=0,this.name="cloudStorage",this.logger=kt.logger,this.core=kt,oc({cmdMap:Uy,cmdConfig:qh}),this.setOptions($e)}var Ne=pe.prototype;return Ne.setOptions=function($e){$e===void 0&&($e={});var Oe=$e.storageKeyPrefix||"NIMClient";this.GRAYKEY=Oe+"-AllGrayscaleConfig",this.MIXSTOREKEY=Oe+"-AllMixStorePolicy";var Lt=$e.s3,rr=eu($e,["s3"]),Pt=Vn({},$T,this.config);if(rr&&Object.prototype.hasOwnProperty.call(rr,"cdn")){var pr={cdn:Vn(Vn({},Pt.cdn),rr.cdn)};this.config=Vn({},Pt,rr,pr)}else this.config=Vn({},Pt,rr);Lt&&(this.s3=Lt)},Ne.init=function(){return zr(this,void 0,void 0,_r.mark(function $e(){return _r.wrap(function(Lt){for(;;)switch(Lt.prev=Lt.next){case 0:if(this.grayConfig=null,this.mixStorePolicy={providers:[],timeStamp:0,ttl:0,s3Policy:null,nosPolicy:null},this.curProvider=vi.nos,this.mixStoreErrorCount=10,!this.config.isNeedToGetUploadPolicyFromServer){Lt.next=9;break}return Lt.next=7,this.getGrayscaleConfig(this.core.options.appkey);case 7:return Lt.next=9,this.getNosCdnHost();case 9:case"end":return Lt.stop()}},$e,this)}))},Ne.uploadFile=function($e){return zr(this,void 0,void 0,_r.mark(function Oe(){var Lt,rr,Pt;return _r.wrap(function(yr){for(;;)switch(yr.prev=yr.next){case 0:if(On({maxSize:{type:"number",required:!1},type:{type:"enum",values:["file","image","audio","video"]}},$e),$e.fileInput||$e.file||$e.filePath){yr.next=3;break}throw new Error("uploadFile needs target file object or a filePath");case 3:if(!$e.type||$e.type==="file"){yr.next=7;break}if(typeof(Lt=ys($e,"file.type"))!="string"||Ba(Lt).call(Lt,$e.type)!==-1){yr.next=7;break}throw new Error('The meta type "'+Lt+'" does not match "'+$e.type+'"');case 7:if(this.grayConfig&&this.grayConfig.mixStoreEnable&&this.mixStorePolicy.providers.length){yr.next=10;break}return this.logger.log("uploadFile:: uploadFile begin, use old nos"),yr.abrupt("return",this.nosUpload($e));case 10:return this.logger.log("uploadFile:: uploadFile begin,Current settings grayConfig mixStoreEnable:"+this.grayConfig.mixStoreEnable+" curProvider:"+this.curProvider),this.s3||(this.curProvider=vi.nos),rr=Hh,yr.prev=13,yr.next=16,this.core.sendCmd("getMixStoreToken",{mixStoreTokenReqTag:{provider:this.curProvider,tokenCount:1,tag:"qchat",returnBody:zh($e.type)}});case 16:Pt=yr.sent,rr=Pt.content.mixStoreTokenResTag,yr.next=24;break;case 20:throw yr.prev=20,yr.t0=yr.catch(13),this.core.logger.error("uploadFile:: getMixStoreToken error",yr.t0),new Gc("getMixStoreToken error",yr.t0,this.curProvider,this.mixStorePolicy);case 24:return yr.abrupt("return",this.curProvider===vi.s3?this.s3Upload($e,rr):this.nosUpload($e,rr));case 25:case"end":return yr.stop()}},Oe,this,[[13,20]])}))},Ne.nosUpload=function($e,Oe){var Lt,rr;return zr(this,void 0,void 0,_r.mark(function Pt(){var pr,yr,Pr,Rr,Vr,Dr,Xr,kn,Tn,Dn,Fn,Gn,$n;return _r.wrap(function(co){for(;;)switch(co.prev=co.next){case 0:if(pr=ys(this.core,"config.cdn.bucket"),yr={tag:$e.nosScenes||pr||"nim",expireSec:$e.nosSurvivalTime},Oe){co.next=13;break}return co.prev=3,co.next=6,this.core.sendCmd("getNosToken",{responseBody:zh($e.type),nosToken:yr});case 6:Pr=co.sent,co.next=13;break;case 9:throw co.prev=9,co.t0=co.catch(3),this.core.logger.error("uploadFile:: getNosToken error",co.t0),new Gc("getNosToken error",co.t0,1);case 13:return co.prev=13,Vr=Pr?Pr.content.nosToken:Oe,this.core.logger.debug("uploadFile:: uploadFile params",{nosToken:Vr,chunkUploadHost:this.config.chunkUploadHost,commonUploadHost:this.config.commonUploadHost,platform:Ca.platform}),co.next=18,this.core.adapters.uploadFile(Vn(Vn({},$e),{nosToken:Vr,chunkUploadHost:this.config.chunkUploadHost,commonUploadHost:this.config.commonUploadHost,maxSize:$e.maxSize||this.config.chunkMaxSize}));case 18:Rr=co.sent,co.next=42;break;case 21:if(co.prev=21,co.t1=co.catch(13),this.core.logger.error("uploadFile::nos uploadFile error",co.t1),!Oe){co.next=41;break}if(this.nosErrorCount!==0){co.next=37;break}co.prev=26,this._addCircuitTimer(),co.next=33;break;case 30:throw co.prev=30,co.t2=co.catch(26),new Gc("upload file error",co.t2,this.curProvider,this.mixStorePolicy,$e.file||$e.filePath);case 33:return this.nosErrorCount=(Lt=this.mixStorePolicy.nosPolicy)===null||Lt===void 0?void 0:Lt.uploadConfig.retryPolicy.retry,co.abrupt("return",this.uploadFile($e));case 37:return this.nosErrorCount--,co.abrupt("return",this.nosUpload($e,Oe));case 39:co.next=42;break;case 41:throw new Gc("nos uploadFile error",co.t1,1);case 42:if(Dr=Rr==null?void 0:Rr.type,Xr=Dr&&Ba(Dr).call(Dr,"/")>-1?$o(Dr).call(Dr,0,Ba(Dr).call(Dr,"/")):"",kn={image:"imageInfo",video:"vinfo",audio:"vinfo"},Tn=this.config.uploadReplaceFormat.replace("{host}",this.config.cdn.cdnDomain||this.config.cdn.defaultCdnDomain).replace("{object}",Pr?Pr.content.nosToken.objectName:Oe==null?void 0:Oe.objectName),Oe&&Oe.shortUrl&&(Tn=Oe.shortUrl),kn[Xr]){co.next=49;break}return co.abrupt("return",Vn({url:Tn},Rr));case 49:if(co.prev=49,!(Ba(Tn).call(Tn,"_im_url=1")<0)){co.next=54;break}return co.next=53,this.core.adapters.request(Tn+"?"+kn[Xr],{method:"GET",dataType:"json",timeout:5e3});case 53:Dn=co.sent;case 54:co.next=60;break;case 56:return co.prev=56,co.t3=co.catch(49),this.core.logger.error("uploadFile:: fetch file info error",co.t3),co.abrupt("return",Vn({url:Tn},Rr));case 60:if(!Dn){co.next=67;break}return Fn=Dn.data,Gn=kn[Xr]==="imageInfo"?Fn:(rr=Fn==null?void 0:Fn.GetVideoInfo)===null||rr===void 0?void 0:rr.VideoInfo,$n={url:Tn,name:Rr.name,size:Rr.size,ext:Rr.ext,w:Gn.Width,h:Gn.Height,orientation:Gn.Orientation,dur:Gn.Duration,audioCodec:Gn.AudioCodec,videoCodec:Gn.VideoCodec,container:Gn.Container},co.abrupt("return",Dy($n,function(oa,so){return so!==void 0}));case 67:return co.abrupt("return",Vn({url:Tn},Rr));case 68:case"end":return co.stop()}},Pt,this,[[3,9],[13,21],[26,30],[49,56]])}))},Ne.getNosCdnHost=function(){var $e;return zr(this,void 0,void 0,_r.mark(function Oe(){var Lt,rr,Pt,pr=this;return _r.wrap(function(Pr){for(;;)switch(Pr.prev=Pr.next){case 0:return Pr.prev=0,Pr.next=3,this.core.sendCmd("getNosCdnHost");case 3:Lt=Pr.sent,Pr.next=10;break;case 6:return Pr.prev=6,Pr.t0=Pr.catch(0),this.logger.error("getNosCdnHost::error",Pr.t0),Pr.abrupt("return");case 10:if(Lt){Pr.next=12;break}return Pr.abrupt("return");case 12:rr=($e=Lt==null?void 0:Lt.content)===null||$e===void 0?void 0:$e.nosConfigTag,(Pt=na(rr==null?void 0:rr.expire))!==0&&rr.cdnDomain?Pt===-1?(this.config.cdn.bucket=rr.bucket,this.config.cdn.cdnDomain=rr.cdnDomain,this.config.cdn.objectNamePrefix=rr.objectNamePrefix):(this.config.cdn.bucket=rr.bucket,this.config.cdn.cdnDomain=rr.cdnDomain,this.config.cdn.objectNamePrefix=rr.objectNamePrefix,this.nosCdnHostTimer=this.core.timerManager.addTimer(function(){pr.getNosCdnHost()},1e3*Pt)):(this.config.cdn.bucket="",this.config.cdn.cdnDomain="",this.config.cdn.objectNamePrefix="");case 15:case"end":return Pr.stop()}},Oe,this,[[0,6]])}))},Ne.getGrayscaleConfig=function($e){var Oe;return zr(this,void 0,void 0,_r.mark(function Lt(){var rr,Pt;return _r.wrap(function(yr){for(;;)switch(yr.prev=yr.next){case 0:if(Ca.localStorage)try{Ca.localStorage.getItem&&Ca.localStorage.getItem(this.GRAYKEY)&&(this.grayConfig=JSON.parse(Ca.localStorage.getItem(this.GRAYKEY))[$e])}catch(Pr){Ca.localStorage.getItem(this.GRAYKEY)&&this.core.logger.error("uploadFile:: JSON.parse grayscaleConfig error ",Pr)}if(this.grayConfig&&!(this.grayConfig.timeStamp+1e3*this.grayConfig.ttl<new Date().getTime())){yr.next=17;break}return yr.next=4,this.core.sendCmd("getGrayscaleConfig",{config:{}});case 4:if(!(rr=yr.sent).content||!rr.content.grayConfigTag){yr.next=16;break}this.logger.log("uploadFile::getAppGrayConfigRequest success ");try{this.grayConfig=JSON.parse(rr.content.grayConfigTag.config),this.grayConfig.ttl=JSON.parse(rr.content.grayConfigTag.ttl)}catch(Pr){this.logger.error("getGrayscaleConfig error",Pr)}if(this.grayConfig){yr.next=10;break}return yr.abrupt("return");case 10:Pt=Ca.localStorage.getItem(this.GRAYKEY)?JSON.parse(Ca.localStorage.getItem(this.GRAYKEY)):{},this.grayConfig.timeStamp=new Date().getTime(),Pt[$e]=this.grayConfig,Ca.localStorage.setItem(this.GRAYKEY,Ao(Pt)),yr.next=17;break;case 16:this.logger.debug("uploadFile:: result grayConfig:",rr.content);case 17:if(!(!((Oe=this.grayConfig)===null||Oe===void 0)&&Oe.mixStoreEnable)){yr.next=20;break}return yr.next=20,this._getMixStorePolicy($e);case 20:case"end":return yr.stop()}},Lt,this)}))},Ne._getMixStorePolicy=function($e){return zr(this,void 0,void 0,_r.mark(function Oe(){var Lt,rr,Pt,pr,yr,Pr,Rr;return _r.wrap(function(Dr){for(;;)switch(Dr.prev=Dr.next){case 0:if(Lt=new Date().getTime(),Ca.localStorage)try{this.mixStorePolicy=JSON.parse(Ca.localStorage.getItem(this.MIXSTOREKEY))[$e],this.curProvider=na(this.mixStorePolicy.providers[0]),this.mixStorePolicy.timeStamp&&this.mixStorePolicy.timeStamp+1e3*this.mixStorePolicy.ttl>Lt&&(Pt=this.mixStorePolicy.timeStamp+1e3*this.mixStorePolicy.ttl-Lt,this.core.timerManager.addTimer(Zo(rr=this._getMixStorePolicy).call(rr,this,$e),Pt))}catch(Xr){Ca.localStorage.getItem(this.MIXSTOREKEY)&&JSON.parse(Ca.localStorage.getItem(this.MIXSTOREKEY))[$e]&&this.core.logger.error("uploadFile:: JSON.parse mixStorePolicy error ",Xr)}if(this.mixStorePolicy&&!(this.mixStorePolicy.timeStamp+1e3*this.mixStorePolicy.ttl<=Lt)){Dr.next=30;break}return Dr.prev=3,Dr.next=6,this.core.sendCmd("getMixStorePolicy",{supportType:this.s3?[1,2]:[1]});case 6:yr=Dr.sent,Pr=yr.content.mixStorePolicyTag,this.mixStorePolicy={providers:[],timeStamp:0,ttl:0,s3Policy:null,nosPolicy:null},this.mixStorePolicy.ttl=Number(Pr.ttl),this.mixStorePolicy.providers=Pr.providers.split(","),this.circuitTimer&&this.core.timerManager.deleteTimer(this.circuitTimer),this.curProvider=na(this.mixStorePolicy.providers[0]),this.mixStorePolicy.nosPolicy=Pr.nosPolicy?JSON.parse(Pr.nosPolicy):null,this.mixStorePolicy.s3Policy=Pr.s3Policy?JSON.parse(Pr.s3Policy):null,this.mixStorePolicy.s3Policy===null?this.mixStorePolicy.providers=["1"]:this.mixStorePolicy.nosPolicy===null?this.mixStorePolicy.providers=["2"]:this.mixStorePolicy.providers=this.mixStorePolicy.s3Policy.priority<this.mixStorePolicy.nosPolicy.priority?["2","1"]:["1","2"],this.core.timerManager.addTimer(Zo(pr=this._getMixStorePolicy).call(pr,this,$e),1e3*this.mixStorePolicy.ttl),Rr=Ca.localStorage.getItem(this.MIXSTOREKEY)?JSON.parse(Ca.localStorage.getItem(this.MIXSTOREKEY)):{},this.mixStorePolicy.timeStamp=new Date().getTime(),Rr[$e]=this.mixStorePolicy,Ca.localStorage.setItem(this.MIXSTOREKEY,Ao(Rr)),Dr.next=30;break;case 23:if(Dr.prev=23,Dr.t0=Dr.catch(3),this.logger.error("getMixStorePolicy error",Dr.t0),this.mixStoreErrorCount!==0){Dr.next=28;break}throw new Error("getMixStorePolicy all count error");case 28:this._getMixStorePolicy($e),this.mixStoreErrorCount--;case 30:this.mixStorePolicy.nosPolicy&&(this.nosErrorCount=this.mixStorePolicy.nosPolicy.uploadConfig.retryPolicy.retry);case 31:case"end":return Dr.stop()}},Oe,this,[[3,23]])}))},Ne.s3Upload=function($e,Oe){return zr(this,void 0,void 0,_r.mark(function Lt(){var rr,Pt,pr,yr,Pr,Rr,Vr,Dr,Xr,kn,Tn=this;return _r.wrap(function(Fn){for(;;)switch(Fn.prev=Fn.next){case 0:if(!$e.file){Fn.next=4;break}rr=$e.file,Fn.next=19;break;case 4:if(typeof $e.fileInput!="string"){Fn.next=14;break}if(this.logger.warn("fileInput will abandon,Please use file or filepath"),!((Pt=document.getElementById($e.fileInput))&&Pt.files&&Pt.files[0])){Fn.next=11;break}rr=Pt.files[0],Fn.next=12;break;case 11:throw new Error("Can not get file from fileInput");case 12:Fn.next=19;break;case 14:if(!($e.fileInput&&$e.fileInput.files&&$e.fileInput.files[0])){Fn.next=18;break}rr=$e.fileInput.files[0],Fn.next=19;break;case 18:throw new Error("Can not get file from fileInput "+$e.fileInput);case 19:if(this.mixStorePolicy.s3Policy){Fn.next=21;break}throw new Error("dont get s3 policy");case 21:return pr={accessKeyId:Oe.accessKeyId,secretAccessKey:Oe.secretAccessKey,sessionToken:Oe.sessionToken,region:Oe.region,maxRetries:this.mixStorePolicy.s3Policy.uploadConfig.retryPolicy.retry},yr=this.s3,(Pr=new yr).config.update(pr),Rr=decodeURIComponent(Oe.bucket),Vr=decodeURIComponent(Oe.objectName),Xr={Bucket:Rr,Key:Vr,Body:Dr=rr,Metadata:{token:Oe.token},ContentType:Dr.type||"application/octet-stream"},this.core.logger.debug("uploadFile:: s3 upload params:",Xr),kn=Pr.upload(Xr),Fn.abrupt("return",new xo(function(Gn){var $n=new Date().getTime();kn.send(function(ho,co){var oa,so;if(ho){Tn.logger.error("uploadFile:","api::s3:upload file failed",ho),Tn.core.reporter.reportTraceStart("exceptions",{user_id:Tn.core.options.account,trace_id:(so=(oa=Tn.core)===null||oa===void 0?void 0:oa.socket)===null||so===void 0?void 0:so.sessionId,start_time:$n,action:1}),Tn.core.reporter.reportTraceUpdateV2("exceptions",{code:typeof ho.status=="number"?ho.status:typeof ho.code=="number"?ho.code:0,description:ho.message||""+ho.code,operation_type:1,target:ho.hostname}),Tn.core.reporter.reportTraceEnd("exceptions",1);try{Tn._addCircuitTimer()}catch(Kn){throw new Gc("upload file error",Kn,Tn.curProvider,Tn.mixStorePolicy,$e.file||$e.filePath)}Gn(Tn.uploadFile($e))}else{var Gr=Tn.mixStorePolicy.s3Policy.cdnSchema;Gr=(Gr=Gr.replace("{cdnDomain}",Tn.mixStorePolicy.s3Policy.dlcdn)).replace("{objectName}",co.Key),Gn({size:Dr.size,name:Dr.name,url:Oe.shortUrl?Oe.shortUrl:Gr,ext:Dr.name.split(".")[1]||"unknown"})}})}));case 32:case"end":return Fn.stop()}},Lt,this)}))},Ne.getPrivateUrl=function($e){var Oe;if(!new RegExp(/http(s)?:\/\/([\w-]+\.)+[\w-]+(\/[\w- ./?%&=]*)?/).test($e))return this.logger.error("illegal file url:"+$e),"";var Lt=/^(?:([A-Za-z]+):)?(\/{0,3})([0-9.\-A-Za-z]+)(?::(\d+))?(?:\/([^?#]*))?(?:\?([^#]*))?(?:#(.*))?$/.exec($e);Lt[0];var rr=Lt[1];Lt[2];var Pt=Lt[3];Lt[4];var pr=Lt[5];if(Lt[6],Lt[7],(Oe=this.grayConfig)===null||Oe===void 0?void 0:Oe.mixStoreEnable){var yr=this._getUrlType($e);return yr===vi.s3&&this.mixStorePolicy.s3Policy&&($e=this.mixStorePolicy.s3Policy.cdnSchema.replace("{cdnDomain}",this.mixStorePolicy.s3Policy.dlcdn).replace("{objectName}",pr)),yr===vi.nos&&this.mixStorePolicy.nosPolicy&&($e=this.mixStorePolicy.nosPolicy.cdnSchema.replace("{cdnDomain}",this.mixStorePolicy.nosPolicy.dlcdn).replace("{objectName}",pr)),$e}var Pr=this.config,Rr=Pr.downloadUrl,Vr=Pr.downloadHostList,Dr=Pr.nosCdnEnable,Xr=this.config.cdn.cdnDomain,kn=this.config.cdn.objectNamePrefix?decodeURIComponent(this.config.cdn.objectNamePrefix):"",Tn=decodeURIComponent(pr),Dn=Ba(Tn).call(Tn,kn);if(Xr&&Dn>-1&&Dr)return""+rr+Xr+"/"+$o(Tn).call(Tn,Dn);if(qi(Vr).call(Vr,Pt)&&qi(pr).call(pr,"/")){var Fn=Ba(pr).call(pr,"/"),Gn=pr.substring(0,Fn),$n=pr.substring(Fn+1);return Rr.replace("{bucket}",Gn).replace("{object}",$n)}var ho=ki(Vr).call(Vr,function(oa){return typeof Pt=="string"&&qi(Pt).call(Pt,oa)})[0],co=ho?Pt.replace(ho,"").replace(/\W/g,""):null;return co?Rr.replace("{bucket}",co).replace("{object}",pr):$e},Ne.getOriginUrl=function($e){return zr(this,void 0,void 0,_r.mark(function Oe(){var Lt;return _r.wrap(function(Pt){for(;;)switch(Pt.prev=Pt.next){case 0:return Pt.next=2,this.core.sendCmd("getOriginUrl",{nosSafeUrlTag:{safeUrl:$e}});case 2:return Lt=Pt.sent,Pt.abrupt("return",Lt.content.nosSafeUrlTag.originUrl);case 4:case"end":return Pt.stop()}},Oe,this)}))},Ne.getFileToken=function($e){return zr(this,void 0,void 0,_r.mark(function Oe(){var Lt,rr,Pt,pr,yr,Pr=this;return _r.wrap(function(Vr){for(;;)switch(Vr.prev=Vr.next){case 0:if(On({type:{type:"number",min:2,max:3},urls:{type:"array",required:!1,itemType:"string"}},$e),Lt=this.mixStorePolicy.nosPolicy?this.mixStorePolicy.nosPolicy.authPolicy.policyType:null,rr=this.mixStorePolicy.s3Policy?this.mixStorePolicy.s3Policy.authPolicy.policyType:null,Lt!==String(cc.dontNeed)||rr!==String(cc.dontNeed)){Vr.next=8;break}throw this.logger.error("don't need token"),new Error("don't need token");case 8:if($e.type!==cc.time){Vr.next=17;break}if(!(Lt&&Ba(Lt).call(Lt,String(cc.time))>=0||rr&&Ba(rr).call(rr,String(cc.time))>0)){Vr.next=13;break}return Vr.abrupt("return",this.getFileAuthToken($e));case 13:throw this.logger.error("don't support time token "),new Error("don't support type time token ");case 15:Vr.next=33;break;case 17:if($e.urls&&$e.urls.length){Vr.next=20;break}throw this.logger.error("urls is required when urls token"),new Error("urls is required when urls token");case 20:if(pr=[],yr=[],Qn(Pt=$e.urls).call(Pt,function(Dr){var Xr=Pr._getUrlType(Dr);Xr===vi.nos&&yr.push(Dr),Xr===vi.s3&&pr.push(Dr)}),(!rr||pr.length!==0&&Ba(rr).call(rr,String(cc.urls))<0)&&(this.logger.warn("s3 url don't support url token"),pr=[]),(!Lt||yr.length!==0&&Ba(Lt).call(Lt,String(cc.urls))<0)&&(this.logger.warn("nos url don't support url token"),yr=[]),pr.length!==0||yr.length!==0){Vr.next=30;break}throw this.logger.error("not support urls"),new Error("not support urls");case 30:if(pr.length!==0&&yr.length!==0){Vr.next=33;break}return $e.urls=Ao($e.urls),Vr.abrupt("return",this.getFileAuthToken($e));case 33:case"end":return Vr.stop()}},Oe,this)}))},Ne.getFileAuthToken=function($e){return zr(this,void 0,void 0,_r.mark(function Oe(){var Lt;return _r.wrap(function(Pt){for(;;)switch(Pt.prev=Pt.next){case 0:return Pt.next=2,this.core.sendCmd("getFileAuthToken",{mixStoreAuthTokenReqTag:$e});case 2:return Lt=Pt.sent,Pt.abrupt("return",Lt.content.mixStoreAuthTokenResTag);case 4:case"end":return Pt.stop()}},Oe,this)}))},Ne._getUrlType=function($e){var Oe,Lt;return this.mixStorePolicy.nosPolicy&&sf(Oe=this.mixStorePolicy.nosPolicy.dlcdns).call(Oe,function(rr){return Ba($e).call($e,rr)>=0})?vi.nos:this.mixStorePolicy.s3Policy&&sf(Lt=this.mixStorePolicy.s3Policy.dlcdns).call(Lt,function(rr){return Ba($e).call($e,rr)>=0})?vi.s3:null},Ne._addCircuitTimer=function(){var $e=this,Oe=this.mixStorePolicy.providers,Lt=Oe[(Ba(Oe).call(Oe,String(this.curProvider))+1)%Oe.length];if(Lt===Oe[0])throw new Error("uploadFile all policy fail");var rr=ys(this.mixStorePolicy,"s3Policy.uploadConfig.retryPolicy");if(rr&&rr.retryNext&&Lt&&(this.logger.log("uploadFile:: upload policy will change,now policy:"+this.curProvider+" nextProvider:"+Lt),this.curProvider=na(Lt),this.mixStorePolicy.nosPolicy&&this.mixStorePolicy.s3Policy)){var Pt=this.mixStorePolicy[this.curProvider===vi.nos?"nosPolicy":"s3Policy"].uploadConfig.retryPolicy.circuit;if(!Pt||Pt===0)return;this.circuitTimer=this.core.timerManager.addTimer(function(){$e.logger.log("uploadFile:: upload policy will change,now policy:"+$e.curProvider+" nextProvider:"+na($e.mixStorePolicy.providers[0])),$e.curProvider=na($e.mixStorePolicy.providers[0]),$e.core.timerManager.deleteTimer($e.circuitTimer)},1e3*Pt)}},Ne.process=function($e){var Oe=this[$e.cmd+"Handler"];return typeof Oe=="function"?Oe.call(this,$e):$e.error&&!$e.error.ignore?xo.reject($e.error):xo.resolve($e)},pe}(),Xd=Math.floor,hf=function(pe,Ne){var kt=pe.length,$e=Xd(kt/2);return kt<8?qy(pe,Ne):jT(pe,hf(Vu(pe,0,$e),Ne),hf(Vu(pe,$e),Ne),Ne)},qy=function(pe,Ne){for(var kt,$e,Oe=pe.length,Lt=1;Lt<Oe;){for($e=Lt,kt=pe[Lt];$e&&Ne(pe[$e-1],kt)>0;)pe[$e]=pe[--$e];$e!==Lt++&&(pe[$e]=kt)}return pe},jT=function(pe,Ne,kt,$e){for(var Oe=Ne.length,Lt=kt.length,rr=0,Pt=0;rr<Oe||Pt<Lt;)pe[rr+Pt]=rr<Oe&&Pt<Lt?$e(Ne[rr],kt[Pt])<=0?Ne[rr++]:kt[Pt++]:rr<Oe?Ne[rr++]:kt[Pt++];return pe},yu=hf,Hy=xr.match(/firefox\/(\d+)/i),Oc=!!Hy&&+Hy[1],As=/MSIE|Trident/.test(xr),zy=xr.match(/AppleWebKit\/(\d+)\./),Wy=!!zy&&+zy[1],Rc=[],bu=Ce(Rc.sort),DT=Ce(Rc.push),Gy=V(function(){Rc.sort(void 0)}),UT=V(function(){Rc.sort(null)}),Ky=fi("sort"),Wh=!V(function(){if(Br)return Br<70;if(!(Oc&&Oc>3)){if(As)return!0;if(Wy)return Wy<603;var pe,Ne,kt,$e,Oe="";for(pe=65;pe<76;pe++){switch(Ne=String.fromCharCode(pe),pe){case 66:case 69:case 70:case 72:kt=3;break;case 68:case 71:kt=4;break;default:kt=2}for($e=0;$e<47;$e++)Rc.push({k:Ne+$e,v:kt})}for(Rc.sort(function(Lt,rr){return rr.v-Lt.v}),$e=0;$e<Rc.length;$e++)Ne=Rc[$e].k.charAt(0),Oe.charAt(Oe.length-1)!==Ne&&(Oe+=Ne);return Oe!=="DGBEFHACIJK"}});xn({target:"Array",proto:!0,forced:Gy||!UT||!Ky||!Wh},{sort:function(Ne){Ne!==void 0&&Yr(Ne);var kt=In(this);if(Wh)return Ne===void 0?bu(kt):bu(kt,Ne);var $e,Oe,Lt=[],rr=Za(kt);for(Oe=0;Oe<rr;Oe++)Oe in kt&&DT(Lt,kt[Oe]);for(yu(Lt,function(Pt){return function(pr,yr){return yr===void 0?-1:pr===void 0?1:Pt!==void 0?+Pt(pr,yr)||0:rs(pr)>rs(yr)?1:-1}}(Ne)),$e=Za(Lt),Oe=0;Oe<$e;)kt[Oe]=Lt[Oe++];for(;Oe<rr;)rf(kt,Oe++);return kt}});var tl,Ki,vf,lc=sa("Array").sort,Zd=Array.prototype,Su=function(pe){var Ne=pe.sort;return pe===Zd||sr(Zd,pe)&&Ne===Zd.sort?lc:Ne};(function(pe){pe[pe.ASC=1]="ASC",pe[pe.DESC=2]="DESC"})(tl||(tl={})),function(pe){pe[pe.reorderWeight=0]="reorderWeight",pe[pe.createTime=1]="createTime",pe[pe.totalMember=2]="totalMember"}(Ki||(Ki={})),function(pe){pe[pe.square=1]="square",pe[pe.person=2]="person"}(vf||(vf={}));var Vl=function(){function pe(Ne,kt){this.name=Ne,this.core=kt,this.name=Ne,this.logger=kt.logger,this.core=kt}return pe.prototype.process=function(kt){var $e=this[kt.cmd+"Handler"];return typeof $e=="function"?$e.call(this,kt):kt.error&&!kt.error.ignore?xo.reject(kt.error):xo.resolve(kt)},pe}(),ep={"24_15":"qchatSubscribe","24_27":"qchatGetUnreadInfo","24_48":"qchatCreateChannel","24_49":"qchatDeleteChannel","24_50":"qchatUpdateChannel","24_51":"qchatGetChannels","24_52":"qchatGetChannelsByPage","24_53":"qchatGetMembersByPage","24_54":"qchatUpdateWhiteBlackRole","24_55":"qchatGetWhiteBlackRolesPage","24_56":"qchatUpdateWhiteBlackMembers","24_57":"qchatGetWhiteBlackMembersPage","24_58":"qchatGetExistingWhiteBlackRoles","24_59":"qchatGetExistingWhiteBlackMembers","24_60":"qchatUpdateCategoryInfoOfChannel","24_109":"qchatCreateChannelCategory","24_110":"qchatRemoveChannelCategory","24_111":"qchatUpdateChannelCategory","24_112":"qchatGetChannelCategoriesByID","24_113":"qchatUpdateChannelCategoryWhiteBlackRole","24_114":"qchatGetChannelCategoryWhiteBlackRolesPage","24_115":"qchatUpdateChannelCategoryWhiteBlackMembers","24_116":"qchatGetChannelCategoryWhiteBlackMembersPage","24_117":"qchatGetChannelCategoryWhiteBlackRoles","24_118":"qchatGetChannelCategoryWhiteBlackMembers","24_119":"qchatGetChannelCategoriesPage","24_120":"qchatGetChannelCategoryChannelsPage","24_93":"qchatGetChannelSearchByPage","24_95":"qchatChannelMemberSearch","25_8":"qchatGetRoleIdsByServerId","25_9":"qchatSubscribeAsVisitor"},Gh={serverId:1,channelId:2,ackTimestamp:3,unreadCount:4,mentionedCount:5,maxCount:6,lastMsgTime:7},ya={channelInfo:{channelId:1,serverId:2,name:4,topic:5,ext:6,type:7,validFlag:8,createTime:9,updateTime:10,owner:11,viewMode:12,categoryId:13,syncMode:14,reorderWeight:15,visitorMode:16},antispamTag:{antiSpamBusinessId:1},memberInfo:{serverId:1,accid:3,nick:4,avatar:5,ext:6,type:7,joinTime:8,inviter:9,validFlag:10,createTime:11,updateTime:12},serverRole:{serverId:1,roleId:2,name:3,icon:4,ext:5,auths:6,type:7,memberCount:8,priority:9,createTime:10,updateTime:11},qchatSubReqTag:{type:1,opeType:2},qchatChannelIdInfoTag:{serverId:1,channelId:2},unreadInfo:Gh,qchatGetChannelListPageTag:{serverId:1,timetag:2,limit:3},qchatGetMembersByPageTag:{serverId:1,channelId:2,timetag:3,limit:4},qchatUpdateWhiteBlackRoleTag:{serverId:1,channelId:2,type:3,opeType:4,roleId:5},qchatGetWhiteBlackRolesPageTag:{serverId:1,channelId:2,type:3,timetag:4,limit:5},qchatUpdateWhiteBlackMembersTag:{serverId:1,channelId:2,type:3,opeType:4,toAccids:5},qchatGetWhiteBlackMembersPageTag:{serverId:1,channelId:2,type:3,timetag:4,limit:5},qchatGetExistingWhiteBlackRolesTag:{serverId:1,channelId:2,type:3,roleIds:4},qchatGetExistingWhiteBlackMembersTag:{serverId:1,channelId:2,type:3,accids:4},QChatChannelCategoryInfo:{categoryId:1,serverId:2,name:4,ext:5,owner:6,viewMode:7,validFlag:8,createTime:9,updateTime:10,channelNumber:11},qchatUpdateChannelCategoryWhiteBlackRoleTag:{serverId:1,categoryId:2,type:3,opeType:4,roleId:5},qchatGetChannelCategoryWhiteBlackRolesPageTag:{serverId:1,categoryId:2,type:3,timetag:4,limit:5},qchatUpdateChannelCategoryWhiteBlackMembersTag:{serverId:1,categoryId:2,type:3,opeType:4,toAccids:5},qchatGetChannelCategoryWhiteBlackMembersPageTag:{serverId:1,categoryId:2,type:3,timetag:4,limit:5},qchatGetChannelCategoryWhiteBlackRolesTag:{serverId:1,categoryId:2,type:3,roleIds:4},qchatGetChannelCategoryWhiteBlackMembersTag:{serverId:1,categoryId:2,type:3,accids:4},qchatGetChannelCategoriesPageTag:{serverId:1,timetag:2,limit:3},qchatGetChannelCategoryChannelsPageTag:{serverId:1,categoryId:2,timetag:3,limit:4},qchatGetChannelSearchByPageTag:{keyword:1,startTime:2,endTime:3,order:4,limit:5,serverId:6,sort:7,cursor:8},qchatUpdateChannelTag:{channelId:1,name:4,topic:5,ext:6,viewMode:12,visitorMode:16},serverRoles:{serverId:1,roleIds:2,timeTag:3},qchatChannelMemberSearchTag:{serverId:1,channelId:2,keyword:3,limit:4},qchatChannelMemberInfo:{serverId:1,channelId:2,avatar:3,accid:4,nick:5,createTime:6,updateTime:7}},da=Qc(ya),Kh={qchatCreateChannel:{sid:24,cid:48,service:"qchatChannel",params:[{type:"Property",name:"channelInfo",reflectMapper:ya.channelInfo},{type:"Property",name:"antispamTag",reflectMapper:ya.antispamTag}],response:[{type:"Property",name:"channelInfo",reflectMapper:da.channelInfo}]},qchatDeleteChannel:{sid:24,cid:49,service:"qchatChannel",params:[{type:"Long",name:"channelId"}]},qchatUpdateChannel:{sid:24,cid:50,service:"qchatChannel",params:[{type:"Property",name:"channelInfo",reflectMapper:ya.qchatUpdateChannelTag},{type:"Property",name:"antispamTag",reflectMapper:ya.antispamTag}],response:[{type:"Property",name:"channelInfo",reflectMapper:da.channelInfo}]},qchatGetChannels:{sid:24,cid:51,service:"qchatChannel",params:[{type:"LongArray",name:"channelIds"}],response:[{type:"PropertyArray",name:"channelList",reflectMapper:da.channelInfo}]},qchatGetChannelsByPage:{sid:24,cid:52,service:"qchatChannel",params:[{type:"Property",name:"qchatGetChannelListPageTag",reflectMapper:ya.qchatGetChannelListPageTag}],response:[{type:"Property",name:"listQueryTag",reflectMapper:{1:"hasMore",2:"nextTimetag"}},{type:"PropertyArray",name:"datas",reflectMapper:da.channelInfo}]},qchatGetMembersByPage:{sid:24,cid:53,service:"qchatChannel",params:[{type:"Property",name:"qchatGetMembersByPageTag",reflectMapper:ya.qchatGetMembersByPageTag}],response:[{type:"Property",name:"listQueryTag",reflectMapper:{1:"hasMore",2:"nextTimetag"}},{type:"PropertyArray",name:"datas",reflectMapper:da.memberInfo}]},qchatUpdateWhiteBlackRole:{sid:24,cid:54,service:"qchatChannel",params:[{type:"Property",name:"qchatUpdateWhiteBlackRoleTag",reflectMapper:ya.qchatUpdateWhiteBlackRoleTag}],response:[{type:"Property",name:"listQueryTag",reflectMapper:{1:"hasMore",2:"nextTimetag"}},{type:"PropertyArray",name:"datas",reflectMapper:da.memberInfo}]},qchatGetWhiteBlackRolesPage:{sid:24,cid:55,service:"qchatChannel",params:[{type:"Property",name:"qchatGetWhiteBlackRolesPageTag",reflectMapper:ya.qchatGetWhiteBlackRolesPageTag}],response:[{type:"Property",name:"listQueryTag",reflectMapper:{1:"hasMore",2:"nextTimetag"}},{type:"PropertyArray",name:"datas",reflectMapper:da.serverRole}]},qchatUpdateWhiteBlackMembers:{sid:24,cid:56,service:"qchatChannel",params:[{type:"Property",name:"qchatUpdateWhiteBlackMembersTag",reflectMapper:ya.qchatUpdateWhiteBlackMembersTag}]},qchatGetWhiteBlackMembersPage:{sid:24,cid:57,service:"qchatChannel",params:[{type:"Property",name:"qchatGetWhiteBlackMembersPageTag",reflectMapper:ya.qchatGetWhiteBlackMembersPageTag}],response:[{type:"Property",name:"listQueryTag",reflectMapper:{1:"hasMore",2:"nextTimetag"}},{type:"PropertyArray",name:"datas",reflectMapper:da.memberInfo}]},qchatGetExistingWhiteBlackRoles:{sid:24,cid:58,service:"qchatChannel",params:[{type:"Property",name:"qchatGetExistingWhiteBlackRolesTag",reflectMapper:ya.qchatGetExistingWhiteBlackRolesTag}],response:[{type:"PropertyArray",name:"datas",reflectMapper:da.serverRole}]},qchatGetExistingWhiteBlackMembers:{sid:24,cid:59,service:"qchatChannel",params:[{type:"Property",name:"qchatGetExistingWhiteBlackMembersTag",reflectMapper:ya.qchatGetExistingWhiteBlackMembersTag}],response:[{type:"PropertyArray",name:"datas",reflectMapper:da.memberInfo}]},qchatUpdateCategoryInfoOfChannel:{sid:24,cid:60,service:"qchatChannel",params:[{type:"Property",name:"qchatUpdateCategoryInfoOfChannelTag",reflectMapper:ya.channelInfo}],response:[{type:"Property",name:"channelInfo",reflectMapper:da.channelInfo}]},qchatCreateChannelCategory:{sid:24,cid:109,service:"qchatChannel",params:[{type:"Property",name:"qchatCreateChannelCategoryTag",reflectMapper:ya.QChatChannelCategoryInfo}],response:[{type:"Property",name:"QChatChannelCategoryInfo",reflectMapper:da.QChatChannelCategoryInfo}]},qchatRemoveChannelCategory:{sid:24,cid:110,service:"qchatChannel",params:[{type:"Long",name:"categoryId"}]},qchatUpdateChannelCategory:{sid:24,cid:111,service:"qchatChannel",params:[{type:"Property",name:"qchatUpdateChannelCategoryTag",reflectMapper:ya.QChatChannelCategoryInfo}],response:[{type:"Property",name:"QChatChannelCategoryInfo",reflectMapper:da.QChatChannelCategoryInfo}]},qchatGetChannelCategoriesByID:{sid:24,cid:112,service:"qchatChannel",params:[{type:"LongArray",name:"categoryIds"}],response:[{type:"PropertyArray",name:"channelCategoryList",reflectMapper:da.QChatChannelCategoryInfo}]},qchatUpdateChannelCategoryWhiteBlackRole:{sid:24,cid:113,service:"qchatChannel",params:[{type:"Property",name:"qchatUpdateChannelCategoryWhiteBlackRoleTag",reflectMapper:ya.qchatUpdateChannelCategoryWhiteBlackRoleTag}]},qchatGetChannelCategoryWhiteBlackRolesPage:{sid:24,cid:114,service:"qchatChannel",params:[{type:"Property",name:"qchatGetChannelCategoryWhiteBlackRolesPageTag",reflectMapper:ya.qchatGetChannelCategoryWhiteBlackRolesPageTag}],response:[{type:"Property",name:"listQueryTag",reflectMapper:{1:"hasMore",2:"nextTimetag"}},{type:"PropertyArray",name:"datas",reflectMapper:da.serverRole}]},qchatUpdateChannelCategoryWhiteBlackMembers:{sid:24,cid:115,service:"qchatChannel",params:[{type:"Property",name:"qchatUpdateChannelCategoryWhiteBlackMembersTag",reflectMapper:ya.qchatUpdateChannelCategoryWhiteBlackMembersTag}]},qchatGetChannelCategoryWhiteBlackMembersPage:{sid:24,cid:116,service:"qchatChannel",params:[{type:"Property",name:"qchatGetChannelCategoryWhiteBlackMembersPageTag",reflectMapper:ya.qchatGetChannelCategoryWhiteBlackMembersPageTag}],response:[{type:"Property",name:"listQueryTag",reflectMapper:{1:"hasMore",2:"nextTimetag"}},{type:"PropertyArray",name:"datas",reflectMapper:da.memberInfo}]},qchatGetChannelCategoryWhiteBlackRoles:{sid:24,cid:117,service:"qchatChannel",params:[{type:"Property",name:"qchatGetChannelCategoryWhiteBlackRolesTag",reflectMapper:ya.qchatGetChannelCategoryWhiteBlackRolesTag}],response:[{type:"PropertyArray",name:"datas",reflectMapper:da.serverRole}]},qchatGetChannelCategoryWhiteBlackMembers:{sid:24,cid:118,service:"qchatChannel",params:[{type:"Property",name:"qchatGetChannelCategoryWhiteBlackMembersTag",reflectMapper:ya.qchatGetChannelCategoryWhiteBlackMembersTag}],response:[{type:"PropertyArray",name:"datas",reflectMapper:da.memberInfo}]},qchatGetChannelCategoriesPage:{sid:24,cid:119,service:"qchatChannel",params:[{type:"Property",name:"qchatGetChannelCategoriesPageTag",reflectMapper:ya.qchatGetChannelCategoriesPageTag}],response:[{type:"Property",name:"listQueryTag",reflectMapper:{1:"hasMore",2:"nextTimetag"}},{type:"PropertyArray",name:"datas",reflectMapper:da.QChatChannelCategoryInfo}]},qchatGetChannelCategoryChannelsPage:{sid:24,cid:120,service:"qchatChannel",params:[{type:"Property",name:"qchatGetChannelCategoryChannelsPageTag",reflectMapper:ya.qchatGetChannelCategoryChannelsPageTag}],response:[{type:"Property",name:"listQueryTag",reflectMapper:{1:"hasMore",2:"nextTimetag"}},{type:"PropertyArray",name:"datas",reflectMapper:da.channelInfo}]},qchatSubscribe:{sid:24,cid:15,service:"qchatChannel",params:[{type:"Property",name:"qchatSubReqTag",reflectMapper:ya.qchatSubReqTag},{type:"PropertyArray",name:"channels",reflectMapper:ya.qchatChannelIdInfoTag}],response:[{type:"PropertyArray",name:"unreadInfos",reflectMapper:da.unreadInfo},{type:"PropertyArray",name:"failedChannels",reflectMapper:da.qchatChannelIdInfoTag}]},qchatGetUnreadInfo:{sid:24,cid:27,service:"qchatChannel",params:[{type:"PropertyArray",name:"channels",reflectMapper:ya.qchatChannelIdInfoTag}],response:[{type:"PropertyArray",name:"unreadInfos",reflectMapper:da.unreadInfo}]},qchatGetChannelSearchByPage:{sid:24,cid:93,service:"qchatChannel",params:[{type:"Property",name:"qchatGetChannelSearchByPageTag",reflectMapper:ya.qchatGetChannelSearchByPageTag}],response:[{type:"Property",name:"listQueryTag",reflectMapper:{1:"hasMore",2:"nextTimetag",3:"cursor"}},{type:"PropertyArray",name:"datas",reflectMapper:da.channelInfo}]},qchatGetRoleIdsByServerId:{sid:25,cid:8,service:"qchatChannel",params:[{type:"Property",name:"qchatGetRoleIdsByServerIdTag",reflectMapper:{serverIdTimeTags:1}}],response:[{type:"PropertyArray",name:"serverRoles",reflectMapper:da.serverRoles},{type:"LongArray",name:"failServerIds"}]},qchatChannelMemberSearch:{sid:24,cid:95,service:"qchatChannel",params:[{type:"Property",name:"qchatChannelMemberSearchTag",reflectMapper:ya.qchatChannelMemberSearchTag}],response:[{type:"PropertyArray",name:"datas",reflectMapper:da.qchatChannelMemberInfo}]},qchatSubscribeAsVisitor:{sid:25,cid:9,service:"qchatChannel",params:[{type:"Property",name:"tag",reflectMapper:ya.qchatSubReqTag},{type:"PropertyArray",name:"datas",reflectMapper:ya.qchatChannelIdInfoTag}],response:[{type:"PropertyArray",name:"failedArr",reflectMapper:da.qchatChannelIdInfoTag}]}},Qy={"24_31":"qchatCreateServer","24_32":"qchatDeleteServer","24_33":"qchatUpdateServer","24_34":"qchatGetServers","24_35":"qchatGetServersByPage","24_36":"qchatInviteServerMembers","24_37":"qchatAcceptServerInvite","24_38":"qchatRejectInviteServer","24_39":"qchatApplyServerJoin","24_40":"qchatAcceptServerApply","24_41":"qchatRejectServerApply","24_42":"qchatKickServerMembers","24_43":"qchatLeaveServer","24_44":"qchatUpdateMyMemberInfo","24_45":"qchatUpdateServerMemberInfo","24_46":"qchatGetServerMembers","24_47":"qchatGetServerMembersByPage","24_104":"qchatUpdateServerMemberBan","24_105":"qchatGetBannedMembersByPage","24_91":"qchatServerSearchByPage","24_92":"qchatServerMemberSearchByPage","24_122":"qchatGenerateInviteCode","24_123":"qchatJoinByInviteCode","24_124":"qchatGetInviteApplyRecordOfServer","24_125":"qchatGetInviteApplyRecordOfSelf","25_5":"qchatClearServersUnread","25_7":"qchatSubscribeChannelsByServers","25_10":"qchatEnterAsVisitor","25_11":"qchatLeaveAsVisitor"},ms={serverInfo:{serverId:1,name:3,icon:4,ext:5,owner:6,memberNumber:7,inviteMode:8,applyMode:9,validFlag:10,createTime:11,updateTime:12,channelNumber:13,categoryNumber:14,searchType:15,searchEnable:16,reorderWeight:17},antispamTag:{antiSpamBusinessId:1},memberInfo:{serverId:1,accid:3,nick:4,avatar:5,ext:6,type:7,joinTime:8,inviter:9,validFlag:10,createTime:11,updateTime:12},otherMemberInfo:{serverId:1,accid:3,nick:4,avatar:5,type:7,joinTime:8,inviter:9,validFlag:10,createTime:11,updateTime:12},getServerListPageTag:{timestamp:1,limit:2},getServerMemberListPageTag:{serverId:1,timetag:2,limit:3},updateServerMemberBanTag:{serverId:1,opeType:2,accid:3,ext:4},getBannedMembersByPageTag:{serverId:1,timetag:2,limit:3},serverMemberBanInfo:{serverId:1,appid:2,accid:3,ext:4,banTime:5,validFlag:6,createTime:7,updateTime:8},serverSearchByPageTag:{keyword:1,startTime:2,endTime:3,order:4,limit:5,serverType:6,searchType:7,sort:8,cursor:9},serverMemberSearchByPageTag:{serverId:1,keyword:3,limit:4},inviteRespParamTag:{requestId:1},applyRespParamTag:{requestId:1,expireTime:2},inviteApplyRecord:{accid:1,type:2,serverId:3,status:4,requestId:5,createTime:6,updateTime:7,expireTime:8,data:9,recordId:10},clearServersUnreadTag:{successServerIds:1,failServerIds:2,ackTimestamp:3},unreadInfo:Gh},is=Qc(ms),rl={qchatCreateServer:{sid:24,cid:31,service:"qchatServer",params:[{type:"Property",name:"serverInfo",reflectMapper:ms.serverInfo},{type:"Property",name:"antispamTag",reflectMapper:ms.antispamTag}],response:[{type:"Property",name:"serverInfo",reflectMapper:is.serverInfo}]},qchatDeleteServer:{sid:24,cid:32,service:"qchatServer",params:[{type:"Long",name:"serverId"}]},qchatUpdateServer:{sid:24,cid:33,service:"qchatServer",params:[{type:"Property",name:"serverInfo",reflectMapper:ms.serverInfo},{type:"Property",name:"antispamTag",reflectMapper:ms.antispamTag}],response:[{type:"Property",name:"serverInfo",reflectMapper:is.serverInfo}]},qchatGetServers:{sid:24,cid:34,service:"qchatServer",params:[{type:"LongArray",name:"serverIds"}],response:[{type:"PropertyArray",name:"serverList",reflectMapper:is.serverInfo}]},qchatGetServersByPage:{sid:24,cid:35,service:"qchatServer",params:[{type:"Property",name:"tag",reflectMapper:ms.getServerListPageTag}],response:[{type:"Property",name:"listQueryTag",reflectMapper:{1:"hasMore",2:"nextTimetag"}},{type:"PropertyArray",name:"datas",reflectMapper:is.serverInfo}]},qchatInviteServerMembers:{sid:24,cid:36,service:"qchatServer",params:[{type:"Long",name:"serverId"},{type:"StrArray",name:"accids"},{type:"String",name:"ps"},{type:"Property",name:"params",reflectMapper:{ttl:1}}],response:[{type:"StrArray",name:"failByOverAccids"},{type:"StrArray",name:"failByBanAccids"},{type:"Property",name:"record",reflectMapper:is.applyRespParamTag}]},qchatAcceptServerInvite:{sid:24,cid:37,service:"qchatServer",params:[{type:"Long",name:"serverId"},{type:"String",name:"accid"},{type:"Property",name:"recordInfo",reflectMapper:ms.inviteRespParamTag}]},qchatRejectInviteServer:{sid:24,cid:38,service:"qchatServer",params:[{type:"Long",name:"serverId"},{type:"String",name:"accid"},{type:"String",name:"ps"},{type:"Property",name:"recordInfo",reflectMapper:ms.inviteRespParamTag}]},qchatApplyServerJoin:{sid:24,cid:39,service:"qchatServer",params:[{type:"Long",name:"serverId"},{type:"String",name:"ps"},{type:"Property",name:"params",reflectMapper:{ttl:1}}],response:[{type:"Property",name:"data",reflectMapper:is.applyRespParamTag}]},qchatAcceptServerApply:{sid:24,cid:40,service:"qchatServer",params:[{type:"Long",name:"serverId"},{type:"String",name:"accid"},{type:"Property",name:"recordInfo",reflectMapper:ms.applyRespParamTag}]},qchatRejectServerApply:{sid:24,cid:41,service:"qchatServer",params:[{type:"Long",name:"serverId"},{type:"String",name:"accid"},{type:"String",name:"ps"},{type:"Property",name:"recordInfo",reflectMapper:ms.applyRespParamTag}]},qchatKickServerMembers:{sid:24,cid:42,service:"qchatServer",params:[{type:"Long",name:"serverId"},{type:"StrArray",name:"accids"}]},qchatLeaveServer:{sid:24,cid:43,service:"qchatServer",params:[{type:"Long",name:"serverId"}]},qchatUpdateMyMemberInfo:{sid:24,cid:44,service:"qchatServer",params:[{type:"Property",name:"memberInfo",reflectMapper:ms.memberInfo},{type:"Property",name:"antispamTag",reflectMapper:ms.antispamTag}],response:[{type:"Property",name:"memberInfo",reflectMapper:is.memberInfo}]},qchatUpdateServerMemberInfo:{sid:24,cid:45,service:"qchatServer",params:[{type:"Property",name:"memberInfo",reflectMapper:ms.otherMemberInfo},{type:"Property",name:"antispamTag",reflectMapper:ms.antispamTag}],response:[{type:"Property",name:"memberInfo",reflectMapper:is.memberInfo}]},qchatGetServerMembers:{sid:24,cid:46,service:"qchatServer",params:[{type:"StrArray",name:"accids"}],response:[{type:"PropertyArray",name:"accidList",reflectMapper:is.memberInfo}]},qchatGetServerMembersByPage:{sid:24,cid:47,service:"qchatServer",params:[{type:"Property",name:"tag",reflectMapper:ms.getServerMemberListPageTag}],response:[{type:"Property",name:"listQueryTag",reflectMapper:{1:"hasMore",2:"nextTimetag"}},{type:"PropertyArray",name:"datas",reflectMapper:is.memberInfo}]},qchatUpdateServerMemberBan:{sid:24,cid:104,service:"qchatServer",params:[{type:"Property",name:"tag",reflectMapper:ms.updateServerMemberBanTag}]},qchatGetBannedMembersByPage:{sid:24,cid:105,service:"qchatServer",params:[{type:"Property",name:"tag",reflectMapper:ms.getBannedMembersByPageTag}],response:[{type:"Property",name:"listQueryTag",reflectMapper:{1:"hasMore",2:"nextTimetag"}},{type:"PropertyArray",name:"datas",reflectMapper:is.serverMemberBanInfo}]},qchatServerSearchByPage:{sid:24,cid:91,service:"qchatServer",params:[{type:"Property",name:"tag",reflectMapper:ms.serverSearchByPageTag}],response:[{type:"Property",name:"listQueryTag",reflectMapper:{1:"hasMore",2:"nextTimetag",3:"cursor"}},{type:"PropertyArray",name:"datas",reflectMapper:is.serverInfo}]},qchatServerMemberSearchByPage:{sid:24,cid:92,service:"qchatServer",params:[{type:"Property",name:"tag",reflectMapper:ms.serverMemberSearchByPageTag}],response:[{type:"PropertyArray",name:"members",reflectMapper:is.serverMemberBanInfo}]},qchatGenerateInviteCode:{sid:24,cid:122,service:"qchatServer",params:[{type:"Property",name:"tag",reflectMapper:{serverId:1,ttl:2}}],response:[{type:"Property",name:"data",reflectMapper:{1:"serverId",2:"requestId",3:"inviteCode",4:"expireTime"}}]},qchatJoinByInviteCode:{sid:24,cid:123,service:"qchatServer",params:[{type:"Property",name:"tag",reflectMapper:{serverId:1,inviteCode:2,ps:3}}]},qchatGetInviteApplyRecordOfServer:{sid:24,cid:124,service:"qchatServer",params:[{type:"Property",name:"tag",reflectMapper:{serverId:1,fromTime:2,toTime:3,reverse:4,limit:5,cursor:6}}],response:[{type:"PropertyArray",name:"data",reflectMapper:is.inviteApplyRecord}]},qchatGetInviteApplyRecordOfSelf:{sid:24,cid:125,service:"qchatServer",params:[{type:"Property",name:"tag",reflectMapper:{fromTime:1,toTime:2,reverse:3,limit:4,cursor:5}}],response:[{type:"PropertyArray",name:"data",reflectMapper:is.inviteApplyRecord}]},qchatClearServersUnread:{sid:25,cid:5,service:"qchatServer",params:[{type:"LongArray",name:"serverIds"}],response:[{type:"Property",name:"clearServersUnreadTag",reflectMapper:is.clearServersUnreadTag}]},qchatSubscribeChannelsByServers:{sid:25,cid:7,service:"qchatServer",params:[{type:"int",name:"type"},{type:"LongArray",name:"serverIds"}],response:[{type:"PropertyArray",name:"unreadInfos",reflectMapper:is.unreadInfo},{type:"LongArray",name:"failServerIds"}]},qchatEnterAsVisitor:{sid:25,cid:10,service:"qchatServer",params:[{type:"Property",name:"tag",reflectMapper:{serverIds:1}}],response:[{type:"LongArray",name:"failServerIds"}]},qchatLeaveAsVisitor:{sid:25,cid:11,service:"qchatServer",params:[{type:"Property",name:"tag",reflectMapper:{serverIds:1}}],response:[{type:"LongArray",name:"failServerIds"}]}},Ns=Function.prototype,VT=Object.prototype,Jy=Ns.toString,qT=VT.hasOwnProperty,HT=Jy.call(Object),yf=function(Ne){if(!Fs(Ne)||Mi(Ne)!="[object Object]")return!1;var kt=Ly(Ne);if(kt===null)return!0;var $e=qT.call(kt,"constructor")&&kt.constructor;return typeof $e=="function"&&$e instanceof $e&&Jy.call($e)==HT};function qa(pe,Ne){if(!yf(Ne))return{};var kt=JSON.parse(Ao(Ne)),$e=Yy(pe,kt);return JSON.parse(Ao(Vn(Vn({},kt),$e)))}function Yy(pe,Ne){if(!yf(Ne))return{};var kt={},$e=ka(pe);return Qn($e).call($e,function(Oe){var Lt=pe[Oe].type;if(typeof Lt!="string"){var rr=Yy(pe[Oe],Ne);ka(rr).length>0&&(kt[Oe]=rr)}else{var Pt=pe[Oe],pr=Pt.rawKey||Oe,yr=zT[Lt](Ne,pr,Pt);yr!==void 0&&(Ne[pr]=void 0,kt[Oe]=yr)}}),kt}var zT={number:function(Ne,kt){if(Ne[kt]!==void 0)return+Ne[kt]},string:function(Ne,kt){if(Ne[kt]!==void 0)return Ne[kt]},boolean:function(Ne,kt){return+Ne[kt]>0||+Ne[kt]!=0&&void 0},enum:function(Ne,kt,$e){return Fp($e)[Ne[kt]]},object:function(Ne,kt){if(Ne[kt]!==void 0)try{return JSON.parse(Ne[kt])}catch{return{}}}};function Tu(pe,Ne){if(!yf(Ne))return{};var kt=JSON.parse(Ao(Ne)),$e=Xy(pe,kt);return JSON.parse(Ao(Vn(Vn({},kt),$e)))}function Xy(pe,Ne){var kt;if(!yf(Ne))return Kc(kt=ka(pe)).call(kt,function(Lt,rr){return Lt[pe[rr].rawKey||rr]=void 0,Lt},{});var $e={},Oe=ka(pe);return Qn(Oe).call(Oe,function(Lt){var rr=pe[Lt].type;if(typeof rr!="string"){var Pt=Xy(pe[Lt],Ne[Lt]);return Vn($e,Pt),void(Ne[Lt]=void 0)}var pr=pe[Lt],yr=pr.rawKey||Lt,Pr=bf[rr](Ne,Lt,pr);Ne[yr]=void 0,$e[yr]=Pr}),$e}var bf={number:function(Ne,kt){return Ne[kt]},string:function(Ne,kt){return Ne[kt]},boolean:function(Ne,kt){return Ne[kt]===!0?1:Ne[kt]===!1?0:void 0},enum:function(Ne,kt,$e){return Fp($e)[Ne[kt]]},object:function(Ne,kt){if(Ne[kt]!==void 0)try{return Ao(Ne[kt])}catch{return""}}},Qh=bf,Zy={serverId:{type:"string"},name:{type:"string"},icon:{type:"string"},ext:{type:"string"},owner:{type:"string"},memberNumber:{type:"number"},inviteMode:{type:"number"},applyMode:{type:"number"},validFlag:{type:"boolean"},createTime:{type:"number"},updateTime:{type:"number"},channelNumber:{type:"number"},categoryNumber:{type:"number"},searchType:{type:"number"},searchEnable:{type:"boolean"},reorderWeight:{type:"string"}},WT={serverId:{type:"string"},uid:{type:"string"},accid:{type:"string"},nick:{type:"string"},avatar:{type:"string"},ext:{type:"string"},type:{type:"number"},joinTime:{type:"number"},inviter:{type:"string"},validFlag:{type:"boolean"},createTime:{type:"number"},updateTime:{type:"number"}},GT={serverId:{type:"string"},appid:{type:"string"},accid:{type:"string"},ext:{type:"string"},banTime:{type:"number"},validFlag:{type:"boolean"},createTime:{type:"number"},updateTime:{type:"number"}};function tp(pe){return qa(Zy,pe)}function Jh(pe){return Es(pe)&&pe.length>0?Ro(pe).call(pe,function(Ne){return tp(Ne)}):[]}function Cu(pe){return qa(WT,pe)}function Bc(pe){return Es(pe)&&pe.length>0?Ro(pe).call(pe,function(Ne){return Cu(Ne)}):[]}function KT(pe){return Es(pe)&&pe.length>0?Ro(pe).call(pe,function(Ne){return function($e){return qa(GT,$e)}(Ne)}):[]}function nl(pe){var Ne,kt,$e;if(!pe.antispamTag)return{};var Oe=Vn({},pe.antispamTag);return!((Ne=pe.antispamTag)===null||Ne===void 0)&&Ne.antiSpamBusinessId&&typeof((kt=pe.antispamTag)===null||kt===void 0?void 0:kt.antiSpamBusinessId)!="string"&&(Oe.antiSpamBusinessId=Ao(($e=pe.antispamTag)===null||$e===void 0?void 0:$e.antiSpamBusinessId)),Oe}var QT={accid:{type:"string"},type:{type:"number"},serverId:{type:"string"},status:{type:"number"},requestId:{type:"string"},createTime:{type:"number"},updateTime:{type:"number"},expireTime:{type:"number"},data:{type:"object"}};function rp(pe){return qa(QT,pe)}function eb(pe){return Es(pe)&&pe.length>0?Ro(pe).call(pe,function(Ne){return rp(Ne)}):[]}var Sf,Pa,xi,ql,JT={successServerIds:{type:"object"},failServerIds:{type:"object"},ackTimestamp:{type:"number"}};function Hl(pe){return qa(JT,pe)}(function(pe){pe[pe.reorderWeight=0]="reorderWeight",pe[pe.createTime=1]="createTime"})(Sf||(Sf={})),function(pe){pe[pe.white=1]="white",pe[pe.black=2]="black"}(Pa||(Pa={})),function(pe){pe[pe.add=1]="add",pe[pe.remove=2]="remove"}(xi||(xi={})),function(pe){pe[pe.message=0]="message",pe[pe.media=1]="media",pe[pe.ext=100]="ext"}(ql||(ql={}));var np={channelId:{type:"string"},serverId:{type:"string"},name:{type:"string"},topic:{type:"string"},ext:{type:"string"},type:{type:"enum",values:ql},validFlag:{type:"boolean"},createTime:{type:"number"},updateTime:{type:"number"},viewMode:{type:"number"},categoryId:{type:"string"},syncMode:{type:"number"},visitorMode:{type:"number"},reorderWeight:{type:"string"}},YT={serverId:{type:"string"},channelId:{type:"string"},ackTimestamp:{type:"number"},unreadCount:{type:"number"},mentionedCount:{type:"number"},maxCount:{type:"number"},lastMsgTime:{type:"number"}},tb={serverId:{type:"string"},channelId:{type:"string"},type:{type:"enum",values:Pa},opeType:{type:"enum",values:xi},toAccids:{type:"object"}},Tf={serverId:{type:"string"},channelId:{type:"string"},type:{type:"enum",values:Pa},opeType:{type:"enum",values:xi},roleId:{type:"string"}},XT={categoryId:{type:"string"},serverId:{type:"string"},name:{type:"string"},ext:{type:"string"},owner:{type:"string"},viewMode:{type:"number"},validFlag:{type:"boolean"},createTime:{type:"number"},updateTime:{type:"number"},channelNumber:{type:"number"}},rb={serverId:{type:"string"},channelId:{type:"string"},accid:{type:"string"},avatar:{type:"string"},nick:{type:"string"},createTime:{type:"number"},updateTime:{type:"number"}};function op(pe){return qa(Tf,pe)}function ap(pe){return qa(np,pe)}function sp(pe){return Es(pe)&&pe.length>0?Ro(pe).call(pe,function(Ne){return ap(Ne)}):[]}function Yh(pe){return qa(YT,pe)}function ip(pe){return Es(pe)&&pe.length>0?Ro(pe).call(pe,function(Ne){return Yh(Ne)}):[]}function cp(pe){return qa(XT,pe)}function Xh(pe){return Es(pe)&&pe.length>0?Ro(pe).call(pe,function(Ne){return cp(Ne)}):[]}function ZT(pe){return Es(pe)&&pe.length>0?Ro(pe).call(pe,function(Ne){return function($e){return qa(rb,$e)}(Ne)}):[]}function lp(pe){try{return JSON.parse(pe)}catch{return[]}}var Cf=tc?tc.isConcatSpreadable:void 0,eC=function(Ne){return ic(Ne)||_h(Ne)||!!(Cf&&Ne&&Ne[Cf])},nb=function pe(Ne,kt,$e,Oe,Lt){var rr=-1,Pt=Ne.length;for($e||($e=eC),Lt||(Lt=[]);++rr<Pt;){var pr=Ne[rr];kt>0&&$e(pr)?kt>1?pe(pr,kt-1,$e,Oe,Lt):oi(Lt,pr):Oe||(Lt[Lt.length]=pr)}return Lt},Zh=ny(function(pe,Ne){return Jn(pe)?ih(pe,nb(Ne,1,Jn,!0)):[]}),Mf=Zh;function ev(pe,Ne){var kt,$e=Ua!==void 0&&fs(pe)||pe["@@iterator"];if($e)return Zo(kt=($e=$e.call(pe)).next).call(kt,$e);if(Es(pe)||($e=function(rr,Pt){var pr;if(rr){if(typeof rr=="string")return tv(rr,Pt);var yr=$o(pr=Object.prototype.toString.call(rr)).call(pr,8,-1);if(yr==="Object"&&rr.constructor&&(yr=rr.constructor.name),yr==="Map"||yr==="Set")return Xc(rr);if(yr==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(yr))return tv(rr,Pt)}}(pe))||Ne&&pe&&typeof pe.length=="number"){$e&&(pe=$e);var Oe=0;return function(){return Oe>=pe.length?{done:!0}:{done:!1,value:pe[Oe++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function tv(pe,Ne){(Ne==null||Ne>pe.length)&&(Ne=pe.length);for(var kt=0,$e=new Array(Ne);kt<Ne;kt++)$e[kt]=pe[kt];return $e}var Mu,up,zl,Wl,tC=function(pe){function Ne($e){var Oe;return(Oe=pe.call(this,"qchatServer",$e)||this).core=$e,oc({cmdMap:Qy,cmdConfig:rl}),Oe}ea(Ne,pe);var kt=Ne.prototype;return kt.createServer=function(Oe){return zr(this,void 0,void 0,_r.mark(function Lt(){var rr;return _r.wrap(function(pr){for(;;)switch(pr.prev=pr.next){case 0:return On({icon:{type:"string",required:!1},name:{type:"string",required:!1},ext:{type:"string",required:!1},searchType:{type:"number",required:!1,min:0},searchEnable:{type:"boolean",required:!1},inviteMode:{type:"number",min:0,max:1,required:!1},applyMode:{type:"number",min:0,max:1,required:!1}},Oe),pr.next=3,this.core.sendCmd("qchatCreateServer",{serverInfo:Vn(Vn({},Oe),{searchEnable:Oe.searchEnable===!1?0:1}),antispamTag:nl(Oe)});case 3:return rr=pr.sent,pr.abrupt("return",tp(rr.content.serverInfo));case 5:case"end":return pr.stop()}},Lt,this)}))},kt.deleteServer=function(Oe){return zr(this,void 0,void 0,_r.mark(function Lt(){return _r.wrap(function(Pt){for(;;)switch(Pt.prev=Pt.next){case 0:return On({serverId:{type:"string",min:1}},Oe),Pt.next=3,this.core.sendCmd("qchatDeleteServer",Oe);case 3:case"end":return Pt.stop()}},Lt,this)}))},kt.updateServer=function(Oe){return zr(this,void 0,void 0,_r.mark(function Lt(){var rr;return _r.wrap(function(pr){for(;;)switch(pr.prev=pr.next){case 0:return On({serverId:{type:"string",min:1},icon:{type:"string",required:!1},name:{type:"string",required:!1},ext:{type:"string",required:!1},searchType:{type:"number",required:!1,min:0},searchEnable:{type:"boolean",required:!1},inviteMode:{type:"number",min:0,max:1,required:!1},applyMode:{type:"number",min:0,max:1,required:!1}},Oe),pr.next=3,this.core.sendCmd("qchatUpdateServer",{serverInfo:Vn(Vn({},Oe),{searchEnable:Oe.searchEnable===!1?0:1}),antispamTag:nl(Oe)});case 3:return rr=pr.sent,pr.abrupt("return",tp(rr.content.serverInfo));case 5:case"end":return pr.stop()}},Lt,this)}))},kt.getServers=function(Oe){return zr(this,void 0,void 0,_r.mark(function Lt(){var rr;return _r.wrap(function(pr){for(;;)switch(pr.prev=pr.next){case 0:return On({serverIds:{type:"array",itemType:"string",min:1}},Oe),pr.next=3,this.core.sendCmd("qchatGetServers",Oe);case 3:return rr=pr.sent,pr.abrupt("return",Jh(rr.content.serverList));case 5:case"end":return pr.stop()}},Lt,this)}))},kt.getServersByPage=function(Oe){return zr(this,void 0,void 0,_r.mark(function Lt(){var rr,Pt,pr,yr;return _r.wrap(function(Rr){for(;;)switch(Rr.prev=Rr.next){case 0:return On({timestamp:{type:"number"},limit:{type:"number",min:1,required:!1}},Oe),Rr.next=3,this.core.sendCmd("qchatGetServersByPage",{tag:Oe});case 3:return rr=Rr.sent,Pt=rr.content,pr=Pt.datas,yr=Pt.listQueryTag,Rr.abrupt("return",{listQueryTag:{hasMore:+yr.hasMore==1,nextTimetag:na(yr.nextTimetag)},datas:Jh(pr)});case 6:case"end":return Rr.stop()}},Lt,this)}))},kt.inviteServerMembers=function(Oe){return zr(this,void 0,void 0,_r.mark(function Lt(){var rr,Pt;return _r.wrap(function(yr){for(;;)switch(yr.prev=yr.next){case 0:return On({serverId:{type:"string",min:1},accids:{type:"array",itemType:"string",min:1},ps:{type:"string"},params:{type:"object",rules:{ttl:{type:"number"}},required:!1}},Oe),yr.next=3,this.core.sendCmd("qchatInviteServerMembers",Oe);case 3:return rr=yr.sent,Pt=rr.content.record||{},yr.abrupt("return",{failByOverAccids:rr.content.failByOverAccids,failByBanAccids:rr.content.failByBanAccids,recordInfo:rp(Pt)});case 6:case"end":return yr.stop()}},Lt,this)}))},kt.acceptServerInvite=function(Oe){return zr(this,void 0,void 0,_r.mark(function Lt(){return _r.wrap(function(Pt){for(;;)switch(Pt.prev=Pt.next){case 0:return On({serverId:{type:"string",allowEmpty:!1},accid:{type:"string",allowEmpty:!1},recordInfo:{type:"object",rules:{requestId:{type:"string",allowEmpty:!1}}}},Oe),Pt.next=3,this.core.sendCmd("qchatAcceptServerInvite",Oe);case 3:case"end":return Pt.stop()}},Lt,this)}))},kt.rejectInviteServer=function(Oe){return zr(this,void 0,void 0,_r.mark(function Lt(){return _r.wrap(function(Pt){for(;;)switch(Pt.prev=Pt.next){case 0:return On({serverId:{type:"string",min:1},accid:{type:"string",min:1},ps:{type:"string"},recordInfo:{type:"object",rules:{requestId:{type:"string",allowEmpty:!1}}}},Oe),Pt.next=3,this.core.sendCmd("qchatRejectInviteServer",Oe);case 3:case"end":return Pt.stop()}},Lt,this)}))},kt.applyServerJoin=function(Oe){return zr(this,void 0,void 0,_r.mark(function Lt(){var rr;return _r.wrap(function(pr){for(;;)switch(pr.prev=pr.next){case 0:return On({serverId:{type:"string",min:1},ps:{type:"string"},params:{type:"object",rules:{ttl:{type:"number"}},required:!1}},Oe),pr.next=3,this.core.sendCmd("qchatApplyServerJoin",Oe);case 3:return rr=pr.sent,pr.abrupt("return",rp(rr.content.data));case 5:case"end":return pr.stop()}},Lt,this)}))},kt.acceptServerApply=function(Oe){return zr(this,void 0,void 0,_r.mark(function Lt(){return _r.wrap(function(Pt){for(;;)switch(Pt.prev=Pt.next){case 0:return On({serverId:{type:"string",min:1},accid:{type:"string",min:1},recordInfo:{type:"object",rules:{requestId:{type:"string",allowEmpty:!1}}}},Oe),Pt.next=3,this.core.sendCmd("qchatAcceptServerApply",Oe);case 3:case"end":return Pt.stop()}},Lt,this)}))},kt.rejectServerApply=function(Oe){return zr(this,void 0,void 0,_r.mark(function Lt(){return _r.wrap(function(Pt){for(;;)switch(Pt.prev=Pt.next){case 0:return On({serverId:{type:"string",min:1},accid:{type:"string",min:1},ps:{type:"string"},recordInfo:{type:"object",rules:{requestId:{type:"string",allowEmpty:!1}}}},Oe),Pt.next=3,this.core.sendCmd("qchatRejectServerApply",Oe);case 3:case"end":return Pt.stop()}},Lt,this)}))},kt.kickServerMembers=function(Oe){return zr(this,void 0,void 0,_r.mark(function Lt(){return _r.wrap(function(Pt){for(;;)switch(Pt.prev=Pt.next){case 0:return On({serverId:{type:"string",min:1},accids:{type:"array",itemType:"string",min:1}},Oe),Pt.next=3,this.core.sendCmd("qchatKickServerMembers",Oe);case 3:case"end":return Pt.stop()}},Lt,this)}))},kt.leaveServer=function(Oe){return zr(this,void 0,void 0,_r.mark(function Lt(){return _r.wrap(function(Pt){for(;;)switch(Pt.prev=Pt.next){case 0:return On({serverId:{type:"string",min:1}},Oe),Pt.next=3,this.core.sendCmd("qchatLeaveServer",Oe);case 3:case"end":return Pt.stop()}},Lt,this)}))},kt.updateMyMemberInfo=function(Oe){return zr(this,void 0,void 0,_r.mark(function Lt(){var rr;return _r.wrap(function(pr){for(;;)switch(pr.prev=pr.next){case 0:return On({serverId:{type:"string",min:1},accid:{type:"string",required:!1},nick:{type:"string",required:!1},avatar:{type:"string",required:!1},ext:{type:"string",required:!1}},Oe),pr.next=3,this.core.sendCmd("qchatUpdateMyMemberInfo",{memberInfo:Oe,antispamTag:nl(Oe)});case 3:return rr=pr.sent,pr.abrupt("return",Cu(rr.content.memberInfo));case 5:case"end":return pr.stop()}},Lt,this)}))},kt.updateServerMemberInfo=function(Oe){return zr(this,void 0,void 0,_r.mark(function Lt(){var rr;return _r.wrap(function(pr){for(;;)switch(pr.prev=pr.next){case 0:return On({serverId:{type:"string",min:1},accid:{type:"string",min:1},nick:{type:"string",required:!1},avatar:{type:"string",required:!1}},Oe),pr.next=3,this.core.sendCmd("qchatUpdateServerMemberInfo",{memberInfo:Oe,antispamTag:nl(Oe)});case 3:return rr=pr.sent,pr.abrupt("return",Cu(rr.content.memberInfo));case 5:case"end":return pr.stop()}},Lt,this)}))},kt.getServerMembers=function(Oe){return zr(this,void 0,void 0,_r.mark(function Lt(){var rr,Pt,pr,yr,Pr;return _r.wrap(function(Vr){for(;;)switch(Vr.prev=Vr.next){case 0:if(On({accids:{type:"array"}},Oe),rr=[],Oe.accids.length)for(Pt=ev(Oe.accids);!(pr=Pt()).done;)yr=pr.value,rr.push(yr.serverId+"|"+yr.accid);return Vr.next=5,this.core.sendCmd("qchatGetServerMembers",{accids:rr});case 5:return Pr=Vr.sent,Vr.abrupt("return",Bc(Pr.content.accidList));case 7:case"end":return Vr.stop()}},Lt,this)}))},kt.getServerMembersByPage=function(Oe){return zr(this,void 0,void 0,_r.mark(function Lt(){var rr,Pt,pr,yr;return _r.wrap(function(Rr){for(;;)switch(Rr.prev=Rr.next){case 0:return On({serverId:{type:"string",min:1},timetag:{type:"number"},limit:{type:"number",min:1,required:!1}},Oe),Rr.next=3,this.core.sendCmd("qchatGetServerMembersByPage",{tag:Oe});case 3:return rr=Rr.sent,Pt=rr.content,pr=Pt.datas,yr=Pt.listQueryTag,Rr.abrupt("return",{listQueryTag:{hasMore:+yr.hasMore==1,nextTimetag:na(yr.nextTimetag)},datas:Bc(pr)});case 6:case"end":return Rr.stop()}},Lt,this)}))},kt.subscribeServer=function(Oe){return zr(this,void 0,void 0,_r.mark(function Lt(){var rr,Pt,pr,yr;return _r.wrap(function(Rr){for(;;)switch(Rr.prev=Rr.next){case 0:if(On({type:{type:"number",min:4,max:4,required:!1},opeType:{type:"number",min:1,max:2}},Oe),Oe.type||(Oe.type=4),!Oe.servers.length){Rr.next=10;break}return Pt=Vn(Vn({},Oe),{channels:Ro(rr=Oe.servers).call(rr,function(Vr){return{serverId:Vr.serverId,channelId:""}})}),Rr.next=6,this.core.qchatChannel.subscribeModuleService.subscribe(Pt);case 6:return pr=Rr.sent,yr=pr.failedChannels,this.core.qchatChannel.subscribeModuleService.cacheSubscribe(Pt),Rr.abrupt("return",{failedServers:yr});case 10:case"end":return Rr.stop()}},Lt,this)}))},kt.banServerMember=function(Oe){return zr(this,void 0,void 0,_r.mark(function Lt(){return _r.wrap(function(Pt){for(;;)switch(Pt.prev=Pt.next){case 0:return On({serverId:{type:"string",allowEmpty:!1},accid:{type:"string",allowEmpty:!1},ext:{type:"string",required:!1}},Oe),Pt.next=3,this.core.sendCmd("qchatUpdateServerMemberBan",{tag:Vn(Vn({},Oe),{opeType:1})});case 3:case"end":return Pt.stop()}},Lt,this)}))},kt.unbanServerMember=function(Oe){return zr(this,void 0,void 0,_r.mark(function Lt(){return _r.wrap(function(Pt){for(;;)switch(Pt.prev=Pt.next){case 0:return On({serverId:{type:"string",allowEmpty:!1},accid:{type:"string",allowEmpty:!1},ext:{type:"string",required:!1}},Oe),Pt.next=3,this.core.sendCmd("qchatUpdateServerMemberBan",{tag:Vn(Vn({},Oe),{opeType:2})});case 3:case"end":return Pt.stop()}},Lt,this)}))},kt.getBannedMembersByPage=function(Oe){return zr(this,void 0,void 0,_r.mark(function Lt(){var rr,Pt,pr,yr;return _r.wrap(function(Rr){for(;;)switch(Rr.prev=Rr.next){case 0:return On({serverId:{type:"string",allowEmpty:!1},timetag:{type:"number",min:0},limit:{type:"number",min:1,required:!1}},Oe),Rr.next=3,this.core.sendCmd("qchatGetBannedMembersByPage",{tag:Oe});case 3:return rr=Rr.sent,Pt=rr.content,pr=Pt.datas,yr=Pt.listQueryTag,Rr.abrupt("return",{listQueryTag:{hasMore:+yr.hasMore==1,nextTimetag:na(yr.nextTimetag)},datas:KT(pr)});case 6:case"end":return Rr.stop()}},Lt,this)}))},kt.serverSearchByPage=function(Oe){return zr(this,void 0,void 0,_r.mark(function Lt(){var rr,Pt,pr,yr;return _r.wrap(function(Rr){for(;;)switch(Rr.prev=Rr.next){case 0:if(On({keyword:{type:"string",allowEmpty:!1},startTime:{type:"number",min:0,required:!1},endTime:{type:"number",min:0,required:!1},limit:{type:"number",min:1,required:!1},serverType:{type:"array",itemType:"number",min:0,required:!1},order:{type:"enum",values:Ea(tl),required:!1},searchType:{type:"enum",values:Ea(vf)},sort:{type:"enum",values:Ea(Ki),required:!1},cursor:{type:"string",allowEmpty:!1,required:!1}},Oe),!(Oe.startTime&&Oe.endTime&&Oe.startTime>=Oe.endTime)){Rr.next=3;break}throw new Nl("startTime more than endTime",Oe,"timeRule");case 3:return Rr.next=5,this.core.sendCmd("qchatServerSearchByPage",{tag:Vn(Vn({},Oe),{order:Oe.order&&tl[Oe.order],searchType:vf[Oe.searchType],sort:Su(Oe)&&Ki[Su(Oe)],serverType:Ao(Oe.serverType)})});case 5:return rr=Rr.sent,Pt=rr.content,pr=Pt.datas,yr=Pt.listQueryTag,Rr.abrupt("return",{listQueryTag:{hasMore:+yr.hasMore==1,nextTimetag:na(yr.nextTimetag),cursor:yr.cursor},datas:Jh(pr)});case 8:case"end":return Rr.stop()}},Lt,this)}))},kt.serverMemberSearchByPage=function(Oe){return zr(this,void 0,void 0,_r.mark(function Lt(){var rr;return _r.wrap(function(pr){for(;;)switch(pr.prev=pr.next){case 0:return On({serverId:{type:"string",allowEmpty:!1},keyword:{type:"string",allowEmpty:!1},limit:{type:"number",min:1,required:!1}},Oe),pr.next=3,this.core.sendCmd("qchatServerMemberSearchByPage",{tag:Oe});case 3:return rr=pr.sent,pr.abrupt("return",Bc(rr.content.members));case 5:case"end":return pr.stop()}},Lt,this)}))},kt.generateInviteCode=function(Oe){return zr(this,void 0,void 0,_r.mark(function Lt(){var rr;return _r.wrap(function(pr){for(;;)switch(pr.prev=pr.next){case 0:return On({serverId:{type:"string",allowEmpty:!1},ttl:{type:"number",min:0,required:!1}},Oe),pr.next=3,this.core.sendCmd("qchatGenerateInviteCode",{tag:Oe});case 3:return rr=pr.sent,pr.abrupt("return",qa({expireTime:{type:"number"}},rr.content.data));case 5:case"end":return pr.stop()}},Lt,this)}))},kt.joinByInviteCode=function(Oe){return zr(this,void 0,void 0,_r.mark(function Lt(){return _r.wrap(function(Pt){for(;;)switch(Pt.prev=Pt.next){case 0:return On({serverId:{type:"string",allowEmpty:!1},inviteCode:{type:"string",allowEmpty:!1},ps:{type:"string",required:!1}},Oe),Pt.next=3,this.core.sendCmd("qchatJoinByInviteCode",{tag:Oe});case 3:case"end":return Pt.stop()}},Lt,this)}))},kt.getInviteApplyRecordOfServer=function(Oe){return zr(this,void 0,void 0,_r.mark(function Lt(){var rr;return _r.wrap(function(pr){for(;;)switch(pr.prev=pr.next){case 0:return On({serverId:{type:"string",allowEmpty:!1},fromTime:{type:"number",min:0},toTime:{type:"number",min:0},reverse:{type:"boolean",required:!1},limit:{type:"number",min:1,required:!1},cursor:{type:"string",allowEmpty:!1,required:!1}},Oe),pr.next=3,this.core.sendCmd("qchatGetInviteApplyRecordOfServer",{tag:Vn(Vn({},Oe),{reverse:Yl(Oe)?1:0})});case 3:return rr=pr.sent,pr.abrupt("return",eb(rr.content.data));case 5:case"end":return pr.stop()}},Lt,this)}))},kt.getInviteApplyRecordOfSelf=function(Oe){return zr(this,void 0,void 0,_r.mark(function Lt(){var rr;return _r.wrap(function(pr){for(;;)switch(pr.prev=pr.next){case 0:return On({fromTime:{type:"number",min:0},toTime:{type:"number",min:0},reverse:{type:"boolean",required:!1},limit:{type:"number",min:1,required:!1},cursor:{type:"string",allowEmpty:!1,required:!1}},Oe),pr.next=3,this.core.sendCmd("qchatGetInviteApplyRecordOfSelf",{tag:Vn(Vn({},Oe),{reverse:Yl(Oe)?1:0})});case 3:return rr=pr.sent,pr.abrupt("return",eb(rr.content.data));case 5:case"end":return pr.stop()}},Lt,this)}))},kt.markRead=function(Oe){return zr(this,void 0,void 0,_r.mark(function Lt(){var rr,Pt,pr,yr;return _r.wrap(function(Rr){for(;;)switch(Rr.prev=Rr.next){case 0:return On({serverIds:{type:"array",itemType:"string",required:!0}},Oe),Rr.next=3,this.core.sendCmd("qchatClearServersUnread",Oe);case 3:return rr=Rr.sent,Pt=Hl(rr.content.clearServersUnreadTag),pr=Pt.successServerIds,yr=Pt.ackTimestamp,this.logger.log("qchatServer::clearServersUnread:: begin auto clear servers unreadInfo"),this.core.eventBus.emit("qchatChannel/clearUnreadCountByServers",pr,yr),Rr.abrupt("return",Pt);case 9:case"end":return Rr.stop()}},Lt,this)}))},kt.subscribeAllChannel=function(Oe){return zr(this,void 0,void 0,_r.mark(function Lt(){var rr,Pt,pr;return _r.wrap(function(Pr){for(;;)switch(Pr.prev=Pr.next){case 0:return On({type:{type:"number",required:!0},serverIds:{type:"array",itemType:"string",required:!0,max:10}},Oe),Pr.next=3,this.core.sendCmd("qchatSubscribeChannelsByServers",Oe,{timeout:3e4});case 3:return(Pt=Pr.sent).content.unreadInfos=ip(Pt.content.unreadInfos),Pt.content.failServerIds=lp(Pt.content.failServerIds),pr={type:Oe.type,opeType:1,channels:Ro(rr=Pt.content.unreadInfos).call(rr,function(Rr){return{serverId:Rr.serverId,channelId:Rr.channelId}})},this.core.eventBus.emit("qchatChannel/cacheSubscribe",pr),this.core.eventBus.emit("qchatChannel/getRoleIdsByServerId",Oe.serverIds),this.core.eventBus.emit("qchatChannel/updateUnreads",Pt.content.unreadInfos),Pr.abrupt("return",Pt.content);case 11:case"end":return Pr.stop()}},Lt,this)}))},kt.enterAsVisitor=function(Oe){return zr(this,void 0,void 0,_r.mark(function Lt(){var rr,Pt,pr;return _r.wrap(function(Pr){for(;;)switch(Pr.prev=Pr.next){case 0:return On({serverIds:{type:"array",itemType:"string",min:1}},Oe),Pr.next=3,this.core.sendCmd("qchatEnterAsVisitor",{tag:{serverIds:Ao(Oe.serverIds)}});case 3:return rr=Pr.sent,Pt=lp(rr.content.failServerIds),pr=Mf(Oe.serverIds,Pt),this.core.qchatChannel.subscribeForVisitorService.cacheServer(pr),Pr.abrupt("return",{failedServers:Pt});case 8:case"end":return Pr.stop()}},Lt,this)}))},kt.leaveAsVisitor=function(Oe){return zr(this,void 0,void 0,_r.mark(function Lt(){var rr,Pt,pr,yr=this;return _r.wrap(function(Rr){for(;;)switch(Rr.prev=Rr.next){case 0:return On({serverIds:{type:"array",itemType:"string",min:1}},Oe),Rr.next=3,this.core.sendCmd("qchatLeaveAsVisitor",{tag:{serverIds:Ao(Oe.serverIds)}});case 3:return rr=Rr.sent,Pt=lp(rr.content.failServerIds),pr=Mf(Oe.serverIds,Pt),Qn(pr).call(pr,function(Vr){yr.core.qchatChannel.subscribeForVisitorService.deleteServer(Vr)}),Rr.abrupt("return",{failedServers:Pt});case 8:case"end":return Rr.stop()}},Lt,this)}))},kt.subscribeAsVisitor=function(Oe){return zr(this,void 0,void 0,_r.mark(function Lt(){return _r.wrap(function(Pt){for(;;)switch(Pt.prev=Pt.next){case 0:if(On({opeType:{type:"number",min:1,max:2},type:{type:"number",required:!1},serverIds:{type:"array",itemType:"string",min:1}},Oe),!Oe.serverIds.length){Pt.next=5;break}return Pt.next=4,this.core.qchatChannel.subscribeForVisitorService.subscribeServerAsVisitor(Oe);case 4:return Pt.abrupt("return",Pt.sent);case 5:return Pt.abrupt("return",{failedServers:[]});case 6:case"end":return Pt.stop()}},Lt,this)}))},Ne}(Vl);(function(pe){pe[pe.everyone=1]="everyone",pe[pe.custom=2]="custom"})(Mu||(Mu={})),function(pe){pe[pe.normal=0]="normal",pe[pe.owner=1]="owner"}(up||(up={})),function(pe){pe[pe.ignore=0]="ignore",pe[pe.deny=-1]="deny",pe[pe.allow=1]="allow"}(zl||(zl={})),function(pe){pe[pe.manageServer=1]="manageServer",pe[pe.manageChannel=2]="manageChannel",pe[pe.manageRole=3]="manageRole",pe[pe.sendMsg=4]="sendMsg",pe[pe.accountInfoSelf=5]="accountInfoSelf",pe[pe.inviteServer=6]="inviteServer",pe[pe.kickServer=7]="kickServer",pe[pe.accountInfoOther=8]="accountInfoOther",pe[pe.recallMsg=9]="recallMsg",pe[pe.deleteMsg=10]="deleteMsg",pe[pe.remindOther=11]="remindOther",pe[pe.remindEveryone=12]="remindEveryone",pe[pe.manageBlackWhiteList=13]="manageBlackWhiteList",pe[pe.banServerMember=14]="banServerMember",pe[pe.RTCChannelConnect=15]="RTCChannelConnect",pe[pe.RTCChannelDisconnectOther=16]="RTCChannelDisconnectOther",pe[pe.RTCChannelOpenMicrophone=17]="RTCChannelOpenMicrophone",pe[pe.RTCChannelOpenCamera=18]="RTCChannelOpenCamera",pe[pe.RTCChannelOpenCloseOtherMicrophone=19]="RTCChannelOpenCloseOtherMicrophone",pe[pe.RTCChannelOpenCloseOtherCamera=20]="RTCChannelOpenCloseOtherCamera",pe[pe.RTCChannelOpenCloseEveryoneMicrophone=21]="RTCChannelOpenCloseEveryoneMicrophone",pe[pe.RTCChannelOpenCloseEveryoneCamera=22]="RTCChannelOpenCloseEveryoneCamera",pe[pe.RTCChannelOpenShareScreen=23]="RTCChannelOpenShareScreen",pe[pe.RTCChannelCloseOtherShareScreen=24]="RTCChannelCloseOtherShareScreen",pe[pe.manageInviteApply=25]="manageInviteApply",pe[pe.manageInviteApplyHistory=26]="manageInviteApplyHistory",pe[pe.mentionedRole=27]="mentionedRole"}(Wl||(Wl={}));var ob={type:{type:"enum",values:Mu},memberType:{type:"enum",values:up},createTime:{type:"number"},updateTime:{type:"number"},priority:{type:"number"},memberCount:{type:"number"},joinTime:{type:"number"}},rC={roleId:{type:"string"},categoryId:{type:"string"},serverId:{type:"string"},type:{type:"enum",values:Mu},validFlag:{type:"boolean"},createTime:{type:"number"},updateTime:{type:"number"},name:{type:"string"},icon:{type:"string"},ext:{type:"string"}},nC={id:{type:"string"},accid:{type:"string"},categoryId:{type:"string"},serverId:{type:"string"},validFlag:{type:"boolean"},createTime:{type:"number"},updateTime:{type:"number"},nick:{type:"string"},avatar:{type:"string"},ext:{type:"string"},memberType:{type:"enum",values:up},joinTime:{type:"number"},inviter:{type:"string"}};function ol(pe){var Ne=Vn({},pe),kt=Tu(ob,Ne);return kt.auths&&(kt.auths=function(Oe){var Lt,rr=Kc(Lt=ka(Oe)).call(Lt,function(Pt,pr){var yr=Wl[pr];return yr?Pt[yr]=zl[Oe[pr]]:Pt[pr]=zl[Oe[pr]],Pt},{});return Ao(rr)}(kt.auths)),kt}function Qi(pe){var Ne;return Kc(Ne=ka(pe)).call(Ne,function(kt,$e){var Oe=iy(Wl,$e);return Oe?kt[Oe]=zl[pe[$e]]:kt[na($e)]=zl[pe[$e]],kt},{})}function $s(pe){var Ne=qa(ob,pe);return pe.auths&&(Ne.auths=Qi(JSON.parse(Ne.auths))),Ne.isMember&&delete Ne.isMember,Ne}function yi(pe){return Es(pe)&&pe.length>0?Ro(pe).call(pe,function(Ne){return $s(Ne)}):[]}function kf(pe){return pe.auths&&(pe.auths=Qi(JSON.parse(pe.auths))),qa(rC,pe)}function ku(pe){return pe.auths&&(pe.auths=Qi(JSON.parse(pe.auths))),qa(nC,pe)}Tv("Set",function(pe){return function(){return pe(this,arguments.length?arguments[0]:void 0)}},Nd);var ab=Ir.Set;xn({target:"Set",stat:!0,forced:!0},{from:Ng}),xn({target:"Set",stat:!0,forced:!0},{of:Mv}),xn({target:"Set",proto:!0,real:!0,forced:!0},{addAll:function(){for(var Ne=po(this),kt=Yr(Ne.add),$e=0,Oe=arguments.length;$e<Oe;$e++)Fe(kt,Ne,arguments[$e]);return Ne}}),xn({target:"Set",proto:!0,real:!0,forced:!0},{deleteAll:kv});var Gl=Sc;xn({target:"Set",proto:!0,real:!0,forced:!0},{every:function(Ne){var kt=po(this),$e=Gl(kt),Oe=Go(Ne,arguments.length>1?arguments[1]:void 0);return!_o($e,function(Lt,rr){if(!Oe(Lt,Lt,kt))return rr()},{IS_ITERATOR:!0,INTERRUPTED:!0}).stopped}}),xn({target:"Set",proto:!0,real:!0,forced:!0},{difference:function(Ne){var kt=po(this),$e=new(Js(kt,Er("Set")))(kt),Oe=Yr($e.delete);return _o(Ne,function(Lt){Fe(Oe,$e,Lt)}),$e}}),xn({target:"Set",proto:!0,real:!0,forced:!0},{filter:function(Ne){var kt=po(this),$e=Gl(kt),Oe=Go(Ne,arguments.length>1?arguments[1]:void 0),Lt=new(Js(kt,Er("Set"))),rr=Yr(Lt.add);return _o($e,function(Pt){Oe(Pt,Pt,kt)&&Fe(rr,Lt,Pt)},{IS_ITERATOR:!0}),Lt}}),xn({target:"Set",proto:!0,real:!0,forced:!0},{find:function(Ne){var kt=po(this),$e=Gl(kt),Oe=Go(Ne,arguments.length>1?arguments[1]:void 0);return _o($e,function(Lt,rr){if(Oe(Lt,Lt,kt))return rr(Lt)},{IS_ITERATOR:!0,INTERRUPTED:!0}).result}}),xn({target:"Set",proto:!0,real:!0,forced:!0},{intersection:function(Ne){var kt=po(this),$e=new(Js(kt,Er("Set"))),Oe=Yr(kt.has),Lt=Yr($e.add);return _o(Ne,function(rr){Fe(Oe,kt,rr)&&Fe(Lt,$e,rr)}),$e}}),xn({target:"Set",proto:!0,real:!0,forced:!0},{isDisjointFrom:function(Ne){var kt=po(this),$e=Yr(kt.has);return!_o(Ne,function(Oe,Lt){if(Fe($e,kt,Oe)===!0)return Lt()},{INTERRUPTED:!0}).stopped}}),xn({target:"Set",proto:!0,real:!0,forced:!0},{isSubsetOf:function(Ne){var kt=Sc(this),$e=po(Ne),Oe=$e.has;return Ue(Oe)||($e=new(Er("Set"))(Ne),Oe=Yr($e.has)),!_o(kt,function(Lt,rr){if(Fe(Oe,$e,Lt)===!1)return rr()},{IS_ITERATOR:!0,INTERRUPTED:!0}).stopped}}),xn({target:"Set",proto:!0,real:!0,forced:!0},{isSupersetOf:function(Ne){var kt=po(this),$e=Yr(kt.has);return!_o(Ne,function(Oe,Lt){if(Fe($e,kt,Oe)===!1)return Lt()},{INTERRUPTED:!0}).stopped}});var sb=Ce([].join),oC=[].push;xn({target:"Set",proto:!0,real:!0,forced:!0},{join:function(Ne){var kt=po(this),$e=Gl(kt),Oe=Ne===void 0?",":rs(Ne),Lt=[];return _o($e,oC,{that:Lt,IS_ITERATOR:!0}),sb(Lt,Oe)}}),xn({target:"Set",proto:!0,real:!0,forced:!0},{map:function(Ne){var kt=po(this),$e=Gl(kt),Oe=Go(Ne,arguments.length>1?arguments[1]:void 0),Lt=new(Js(kt,Er("Set"))),rr=Yr(Lt.add);return _o($e,function(Pt){Fe(rr,Lt,Oe(Pt,Pt,kt))},{IS_ITERATOR:!0}),Lt}});var ib=TypeError;xn({target:"Set",proto:!0,real:!0,forced:!0},{reduce:function(Ne){var kt=po(this),$e=Gl(kt),Oe=arguments.length<2,Lt=Oe?void 0:arguments[1];if(Yr(Ne),_o($e,function(rr){Oe?(Oe=!1,Lt=rr):Lt=Ne(Lt,rr,rr,kt)},{IS_ITERATOR:!0}),Oe)throw ib("Reduce of empty set with no initial value");return Lt}}),xn({target:"Set",proto:!0,real:!0,forced:!0},{some:function(Ne){var kt=po(this),$e=Gl(kt),Oe=Go(Ne,arguments.length>1?arguments[1]:void 0);return _o($e,function(Lt,rr){if(Oe(Lt,Lt,kt))return rr()},{IS_ITERATOR:!0,INTERRUPTED:!0}).stopped}}),xn({target:"Set",proto:!0,real:!0,forced:!0},{symmetricDifference:function(Ne){var kt=po(this),$e=new(Js(kt,Er("Set")))(kt),Oe=Yr($e.delete),Lt=Yr($e.add);return _o(Ne,function(rr){Fe(Oe,$e,rr)||Fe(Lt,$e,rr)}),$e}}),xn({target:"Set",proto:!0,real:!0,forced:!0},{union:function(Ne){var kt=po(this),$e=new(Js(kt,Er("Set")))(kt);return _o(Ne,Yr($e.add),{that:$e}),$e}});var wf,dp,Ji,pp,al,ba,Fc,wu=ab;(function(pe){pe[pe.sendTime=1]="sendTime"})(wf||(wf={})),function(pe){pe[pe.text=0]="text",pe[pe.image=1]="image",pe[pe.audio=2]="audio",pe[pe.video=3]="video",pe[pe.geo=4]="geo",pe[pe.notification=5]="notification",pe[pe.file=6]="file",pe[pe.tip=10]="tip",pe[pe.robot=11]="robot",pe[pe.g2=12]="g2",pe[pe.custom=100]="custom"}(dp||(dp={})),function(pe){pe[pe.sending=1]="sending",pe[pe.success=2]="success",pe[pe.failed=3]="failed"}(Ji||(Ji={})),function(pe){pe[pe.notifyAll=1]="notifyAll",pe[pe.notifySubscribe=2]="notifySubscribe"}(pp||(pp={})),function(pe){pe[pe.unknown=0]="unknown",pe[pe.server=1]="server",pe[pe.channel=2]="channel",pe[pe.serverAccids=3]="serverAccids",pe[pe.channelAccids=4]="channelAccids",pe[pe.accids=5]="accids"}(al||(al={})),function(pe){pe[pe.serverMemberInvite=1]="serverMemberInvite",pe[pe.serverMemberInviteReject=2]="serverMemberInviteReject",pe[pe.serverMemberApply=3]="serverMemberApply",pe[pe.serverMemberApplyReject=4]="serverMemberApplyReject",pe[pe.serverCreate=5]="serverCreate",pe[pe.serverRemove=6]="serverRemove",pe[pe.serverUpdate=7]="serverUpdate",pe[pe.serverMemberInviteDone=8]="serverMemberInviteDone",pe[pe.serverMemberInviteAccept=9]="serverMemberInviteAccept",pe[pe.serverMemberApplyDone=10]="serverMemberApplyDone",pe[pe.serverMemberApplyAccept=11]="serverMemberApplyAccept",pe[pe.serverMemberKick=12]="serverMemberKick",pe[pe.serverMemberLeave=13]="serverMemberLeave",pe[pe.serverMemberUpdate=14]="serverMemberUpdate",pe[pe.channelCreate=15]="channelCreate",pe[pe.channelRemove=16]="channelRemove",pe[pe.channelUpdate=17]="channelUpdate",pe[pe.channelUpdateWhiteBlackIdentify=18]="channelUpdateWhiteBlackIdentify",pe[pe.channelUpdateWhiteBlackIdentifyUser=19]="channelUpdateWhiteBlackIdentifyUser",pe[pe.updateQuickComment=20]="updateQuickComment",pe[pe.channelCategoryCreate=21]="channelCategoryCreate",pe[pe.channelCategoryRemove=22]="channelCategoryRemove",pe[pe.channelCategoryUpdate=23]="channelCategoryUpdate",pe[pe.channelCategoryUpdateWhiteBlackIdentify=24]="channelCategoryUpdateWhiteBlackIdentify",pe[pe.channelCategoryUpdateWhiteBlackIdentifyUser=25]="channelCategoryUpdateWhiteBlackIdentifyUser",pe[pe.serverIdentifyAdd=26]="serverIdentifyAdd",pe[pe.serverIdentifyRemove=27]="serverIdentifyRemove",pe[pe.serverIdentifyUpdate=28]="serverIdentifyUpdate",pe[pe.channelIdentifyUpdate=29]="channelIdentifyUpdate",pe[pe.userIdentifyUpdate=30]="userIdentifyUpdate",pe[pe.channelVisibilityUpdate=31]="channelVisibilityUpdate",pe[pe.serverEnterLeave=32]="serverEnterLeave",pe[pe.serverMemberJoinByInviteCode=33]="serverMemberJoinByInviteCode",pe[pe.channelVisibilityToVisitorUpdate=34]="channelVisibilityToVisitorUpdate",pe[pe.myMemberInfoUpdated=35]="myMemberInfoUpdated",pe[pe.custom=100]="custom",pe[pe.msgTyping=101]="msgTyping"}(ba||(ba={})),function(pe){pe[pe.reply=1]="reply",pe[pe.thread=2]="thread",pe[pe.all=3]="all"}(Fc||(Fc={}));var rv=function(){return hi.Date.now()},aC=/\s/,sC=function(Ne){for(var kt=Ne.length;kt--&&aC.test(Ne.charAt(kt)););return kt},iC=/^\s+/,cC=function(Ne){return Ne&&Ne.slice(0,sC(Ne)+1).replace(iC,"")},lC=/^[-+]0x[0-9a-f]+$/i,uC=/^0b[01]+$/i,dC=/^0o[0-7]+$/i,pC=parseInt,nv=function(Ne){if(typeof Ne=="number")return Ne;if(pf(Ne))return NaN;if(Ui(Ne)){var kt=typeof Ne.valueOf=="function"?Ne.valueOf():Ne;Ne=Ui(kt)?kt+"":kt}if(typeof Ne!="string")return Ne===0?Ne:+Ne;Ne=cC(Ne);var $e=uC.test(Ne);return $e||dC.test(Ne)?pC(Ne.slice(2),$e?2:8):lC.test(Ne)?NaN:+Ne},fC=Math.max,cb=Math.min,mC=function(Ne,kt,$e){var Oe,Lt,rr,Pt,pr,yr,Pr=0,Rr=!1,Vr=!1,Dr=!0;if(typeof Ne!="function")throw new TypeError("Expected a function");function Xr($n){var ho=Oe,co=Lt;return Oe=Lt=void 0,Pr=$n,Pt=Ne.apply(co,ho)}function kn($n){return Pr=$n,pr=setTimeout(Dn,kt),Rr?Xr($n):Pt}function Tn($n){var ho=$n-yr;return yr===void 0||ho>=kt||ho<0||Vr&&$n-Pr>=rr}function Dn(){var $n=rv();if(Tn($n))return Fn($n);pr=setTimeout(Dn,function(co){var oa=kt-(co-yr);return Vr?cb(oa,rr-(co-Pr)):oa}($n))}function Fn($n){return pr=void 0,Dr&&Oe?Xr($n):(Oe=Lt=void 0,Pt)}function Gn(){var $n=rv(),ho=Tn($n);if(Oe=arguments,Lt=this,yr=$n,ho){if(pr===void 0)return kn(yr);if(Vr)return clearTimeout(pr),pr=setTimeout(Dn,kt),Xr(yr)}return pr===void 0&&(pr=setTimeout(Dn,kt)),Pt}return kt=nv(kt)||0,Ui($e)&&(Rr=!!$e.leading,rr=(Vr="maxWait"in $e)?fC(nv($e.maxWait)||0,kt):rr,Dr="trailing"in $e?!!$e.trailing:Dr),Gn.cancel=function(){pr!==void 0&&clearTimeout(pr),Pr=0,Oe=yr=Lt=pr=void 0},Gn.flush=function(){return pr===void 0?Pt:Fn(rv())},Gn},ov=function(Ne,kt,$e){var Oe=!0,Lt=!0;if(typeof Ne!="function")throw new TypeError("Expected a function");return Ui($e)&&(Oe="leading"in $e?!!$e.leading:Oe,Lt="trailing"in $e?!!$e.trailing:Lt),mC(Ne,kt,{leading:Oe,maxWait:kt,trailing:Lt})},gC=function(Ne,kt,$e){var Oe=-1,Lt=Ne.length;kt<0&&(kt=-kt>Lt?0:Lt+kt),($e=$e>Lt?Lt:$e)<0&&($e+=Lt),Lt=kt>$e?0:$e-kt>>>0,kt>>>=0;for(var rr=Array(Lt);++Oe<Lt;)rr[Oe]=Ne[Oe+kt];return rr},_u=function(Ne,kt,$e){if(!Ui($e))return!1;var Oe=typeof kt;return!!(Oe=="number"?Kp($e)&&Wd(kt,$e.length):Oe=="string"&&kt in $e)&&Lp($e[kt],Ne)},Lc=1/0,hC=function(Ne){return Ne?(Ne=nv(Ne))===Lc||Ne===-1/0?17976931348623157e292*(Ne<0?-1:1):Ne==Ne?Ne:0:Ne===0?Ne:0},vC=function(Ne){var kt=hC(Ne),$e=kt%1;return kt==kt?$e?kt-$e:kt:0},_f=Math.ceil,yC=Math.max,fp,xu=function(Ne,kt,$e){kt=($e?_u(Ne,kt,$e):kt===void 0)?1:yC(vC(kt),0);var Oe=Ne==null?0:Ne.length;if(!Oe||kt<1)return[];for(var Lt=0,rr=0,Pt=Array(_f(Oe/kt));Lt<Oe;)Pt[rr++]=gC(Ne,Lt,Lt+=kt);return Pt};(function(pe){pe[pe.sub=1]="sub",pe[pe.unSub=2]="unSub"})(fp||(fp={}));var av,bC=function(){function pe(kt){var $e=this;this.unreadCount={},this.autoSubscribeUnreadMap={},this.autoSubscribeServerMap={},this.autoSubscribeTypingMap={},this.unreadServerCount={},this.serverRoleIdsMap={},this._serverUnreadInfo=ov(function(Oe){$e.core.emit("serverUnreadInfo",$e.getServerUnreadInfo(Oe))},100),this.core=kt}var Ne=pe.prototype;return Ne.changeCacheServerRoleIds=function($e){return zr(this,void 0,void 0,_r.mark(function Oe(){var Lt,rr,Pt,pr,yr,Pr,Rr,Vr=this;return _r.wrap(function(Xr){for(;;)switch(Xr.prev=Xr.next){case 0:if(rr=$e.attach.serverIdentifyInfo,Pt=rr.serverId,pr=rr.roleId,this.serverRoleIdsMap[Pt]){Xr.next=4;break}return Xr.next=4,this.getRoleIdsByServerId([Pt]);case 4:if(yr=this.serverRoleIdsMap[Pt],!($e.time<yr.timeTag)){Xr.next=7;break}return Xr.abrupt("return");case 7:if($e.type===ba[ba.serverIdentifyAdd]?yr.roleIds.add(pr):yr.roleIds.delete(pr),this.core.logger.debug("QChatChannel::qchatChannel/serverIdentifyChange::now "+Pt+" roleIds is",gi(Lt=[]).call(Lt,yr.roleIds)),Pr=this.unreadServerCount[Pt]){Xr.next=12;break}return Xr.abrupt("return");case 12:Rr=xu(ka(Pr),100),Qn(Rr).call(Rr,function(kn){Vr.core.qchatChannel.getChannelUnreadInfos({channels:Ro(kn).call(kn,function(Tn){return{serverId:Pt,channelId:Tn}})})});case 14:case"end":return Xr.stop()}},Oe,this)}))},Ne.getRoleIdsByServerId=function($e){return zr(this,void 0,void 0,_r.mark(function Oe(){var Lt,rr,Pt,pr,yr=this;return _r.wrap(function(Rr){for(;;)switch(Rr.prev=Rr.next){case 0:if((rr=ki($e).call($e,function(Vr){return!yr.serverRoleIdsMap[Vr]})).length){Rr.next=3;break}return Rr.abrupt("return");case 3:return Pt={serverIdTimeTags:rr},Rr.next=6,this.core.sendCmd("qchatGetRoleIdsByServerId",{qchatGetRoleIdsByServerIdTag:Pt});case 6:pr=Rr.sent,this.core.logger.debug("QChatChannel:: getRoleIdsByServerId, params is ",Pt,"result is",pr),Qn(Lt=pr.content.serverRoles).call(Lt,function(Vr){try{Vr.roleIds=JSON.parse(Vr.roleIds)}catch(Dr){yr.core.logger.error("QChatChannel:: getRoleIdsByServerId JSON parse roleIds error",Dr)}yr.serverRoleIdsMap[Vr.serverId]={roleIds:new wu(Vr.roleIds),timeTag:Vr.timeTag}});case 9:case"end":return Rr.stop()}},Oe,this)}))},Ne._unSubscribeChannel=function($e,Oe){return zr(this,void 0,void 0,_r.mark(function Lt(){var rr,Pt;return _r.wrap(function(yr){for(;;)switch(yr.prev=yr.next){case 0:if(rr=$e+"_"+Oe,Pt=this.autoSubscribeUnreadMap[rr]){yr.next=4;break}return yr.abrupt("return");case 4:this.subscribe({opeType:fp.unSub,type:Pt,channels:[{serverId:$e,channelId:Oe}]}),this.autoSubscribeUnreadMap[rr]=void 0;case 6:case"end":return yr.stop()}},Lt,this)}))},Ne.subscribe=function($e){return zr(this,void 0,void 0,_r.mark(function Oe(){var Lt,rr,Pt,pr,yr=this;return _r.wrap(function(Rr){for(;;)switch(Rr.prev=Rr.next){case 0:return On({type:{type:"number",min:1,max:5},opeType:{type:"number",min:1,max:2}},$e),Rr.next=3,this.core.sendCmd("qchatSubscribe",{qchatSubReqTag:{type:$e.type,opeType:$e.opeType},channels:$e.channels});case 3:return rr=Rr.sent,Pt=new wu,Qn(Lt=$e.channels).call(Lt,function(Vr){return zr(yr,void 0,void 0,_r.mark(function Dr(){return _r.wrap(function(kn){for(;;)switch(kn.prev=kn.next){case 0:this.serverRoleIdsMap[Vr.serverId]||Pt.add(Vr.serverId);case 1:case"end":return kn.stop()}},Dr,this)}))}),pr=xu(Xc(Pt),10),Qn(pr).call(pr,function(Vr){yr.getRoleIdsByServerId(Vr)}),Rr.abrupt("return",rr.content);case 9:case"end":return Rr.stop()}},Oe,this)}))},Ne.resumeSubscribe=function($e){return zr(this,void 0,void 0,_r.mark(function Oe(){var Lt,rr,Pt,pr,yr,Pr,Rr,Vr=this;return _r.wrap(function(Xr){for(;;)switch(Xr.prev=Xr.next){case 0:if(this.serverRoleIdsMap={},this.unreadServerCount={},this.unreadCount={},yr=100,$e.isAutoReconnect){Xr.next=6;break}return Xr.abrupt("return");case 6:return Pr={},Qn(Lt=ka(this.autoSubscribeUnreadMap)).call(Lt,function(kn){var Tn=Vr.autoSubscribeUnreadMap[kn];if(Tn){var Dn=kn.split("_"),Fn={serverId:Dn[0],channelId:Dn[1]};Pr[Tn]=Pr[Tn]||[],Pr[Tn].push(Fn)}}),Pr[5]=[],Qn(rr=ka(this.autoSubscribeTypingMap)).call(rr,function(kn){return zr(Vr,void 0,void 0,_r.mark(function Tn(){var Dn,Fn,Gn,$n;return _r.wrap(function(co){for(;;)switch(co.prev=co.next){case 0:this.autoSubscribeTypingMap[kn]&&(Dn=kn.split("_"),Fn=Dn[0],Gn=Dn[1],$n={serverId:Fn,channelId:Gn},Pr[5].push($n));case 2:case"end":return co.stop()}},Tn,this)}))}),Pr[4]=[],Qn(Pt=ka(this.autoSubscribeServerMap)).call(Pt,function(kn){return zr(Vr,void 0,void 0,_r.mark(function Tn(){var Dn;return _r.wrap(function(Gn){for(;;)switch(Gn.prev=Gn.next){case 0:this.autoSubscribeServerMap[kn]&&(Dn={serverId:kn},Pr[4].push(Dn));case 2:case"end":return Gn.stop()}},Tn,this)}))}),Rr=[],Qn(pr=ka(Pr)).call(pr,function(kn){var Tn=Pr[kn];if(Tn&&Tn.length===0)return xo.resolve();if(Tn.length>yr){var Dn=xu(Tn,100);return Qn(Dn).call(Dn,function(Fn){Rr.push(Vr.createSubscribePromise(Fn,kn))})}Rr.push(Vr.createSubscribePromise(Tn,kn))}),Xr.next=16,xo.all(Rr);case 16:case"end":return Xr.stop()}},Oe,this)}))},Ne.createSubscribePromise=function($e,Oe){var Lt=this,rr={type:na(Oe),opeType:1,channels:$e};return this.core.logger.debug("qchatChannel:: autoSubscribeUnread params",rr),this.subscribe(rr).then(function(Pt){var pr=Pt.unreadInfos;pr&&pr.length>0&&(pr=ip(pr),Lt.cacheUnreadCount(pr))}).catch(function(Pt){Lt.core.logger.error("qchatChannel:: autoSubscribeUnread error ",Pt)})},Ne.cacheSubscribe=function($e){var Oe,Lt=this;Qn(Oe=$e.channels).call(Oe,function(rr){var Pt=rr.channelId?rr.serverId+"_"+rr.channelId:""+rr.serverId,pr=$e.type===5?Lt.autoSubscribeTypingMap:$e.type===4?Lt.autoSubscribeServerMap:Lt.autoSubscribeUnreadMap;$e.opeType===fp.sub?pr[Pt]=$e.type:$e.opeType===fp.unSub&&(pr[Pt]=void 0)})},Ne.cacheUnreadCount=function($e){var Oe=this;Qn($e).call($e,function(Lt){var rr=Lt.serverId+"_"+Lt.channelId;Oe.unreadCount[rr]=Vn({},Lt),Oe.unreadServerCount[Lt.serverId]||(Oe.unreadServerCount[Lt.serverId]={}),Oe.unreadServerCount[Lt.serverId][Lt.channelId]=!0})},Ne.getServerUnreadInfo=function($e){var Oe,Lt=this,rr={serverId:$e,unreadCount:0,mentionedCount:0,maxCount:0},Pt=this.unreadServerCount[$e];return Pt&&(Qn(Oe=ka(Pt)).call(Oe,function(pr){var yr=$e+"_"+pr,Pr=Lt.unreadCount[yr];rr.unreadCount+=Pr.unreadCount,rr.mentionedCount+=Pr.mentionedCount,Pr.maxCount!==void 0&&(rr.maxCount=Pr.maxCount)}),rr.unreadCount=rr.unreadCount>rr.maxCount?rr.maxCount:rr.unreadCount,rr.mentionedCount=rr.mentionedCount>rr.maxCount?rr.maxCount:rr.mentionedCount),rr},Ne.getUnreadInfo=function($e){On({serverId:{type:"string"},channelId:{type:"string"}},$e);var Oe=$e.serverId+"_"+$e.channelId;return this.unreadCount[Oe]?this.unreadCount[Oe]:null},Ne.shouldChangeUnread=function($e,Oe){if(!$e.serverId||!$e.channelId||this.core.qchatChannel.subscribeForVisitorService.isInSubscribeChannels($e.serverId,$e.channelId)||$e.historyEnable===!1||$e.needBadge===!1||$e.fromAccount===this.core.account||Oe&&($e==null?void 0:$e.status)!==2)return!1;if($e.notifyReason&&$e.notifyReason===iy(pp,pp.notifySubscribe)){if(!$e.serverId||!$e.channelId)return!1;var Lt=this.getUnreadInfo({serverId:$e.serverId,channelId:$e.channelId}),rr=Oe?"ackTimestamp":"lastMsgTime";if(!Lt||$e.time&&Lt[rr]&&Lt[rr]>$e.time)return!1}return!0},Ne.shouldChangeMentionedUnread=function($e,Oe){return Oe===void 0&&(Oe=!1),zr(this,void 0,void 0,_r.mark(function Lt(){var rr,Pt;return _r.wrap(function(yr){for(;;)switch(yr.prev=yr.next){case 0:if(!$e.accidsOfMentionedRoles||!qi(rr=$e.accidsOfMentionedRoles).call(rr,this.core.account)){yr.next=2;break}return yr.abrupt("return",!0);case 2:if(!$e.mentionRoleIds||!$e.serverId){yr.next=16;break}if(this.serverRoleIdsMap[$e.serverId]){yr.next=9;break}if(Oe){yr.next=7;break}return this.handledRoleMsg($e),yr.abrupt("return",!1);case 7:return yr.next=9,this.getRoleIdsByServerId([$e.serverId]);case 9:Pt=0;case 10:if(!(Pt<$e.mentionRoleIds.length)){yr.next=16;break}if(!this.serverRoleIdsMap[$e.serverId].roleIds.has($e.mentionRoleIds[Pt])){yr.next=13;break}return yr.abrupt("return",!0);case 13:Pt++,yr.next=10;break;case 16:return yr.abrupt("return",!1);case 17:case"end":return yr.stop()}},Lt,this)}))},Ne.handledRoleMsg=function($e){return zr(this,void 0,void 0,_r.mark(function Oe(){var Lt,rr,Pt,pr,yr,Pr=this;return _r.wrap(function(Vr){for(;;)switch(Vr.prev=Vr.next){case 0:if($e.mentionRoleIds){Vr.next=2;break}return Vr.abrupt("return");case 2:if(this.serverRoleIdsMap[$e.serverId]){Vr.next=5;break}return Vr.next=5,this.getRoleIdsByServerId([$e.serverId]);case 5:if(this.serverRoleIdsMap[$e.serverId]){Vr.next=8;break}return this.core.logger.warn("QChatChannel::handledRoleMsg::can not get serverRoleIds,server id",$e.serverId),Vr.abrupt("return");case 8:if(rr=!1,Qn(Lt=$e.mentionRoleIds).call(Lt,function(Dr){Pr.serverRoleIdsMap[$e.serverId].roleIds.has(Dr)&&(rr=!0,Pr.core.logger.debug("QChatChannel::handledRoleMsg::will update message mentionedCount，message is ",$e))}),rr){Vr.next=12;break}return Vr.abrupt("return");case 12:if(Pt=this.unreadCount[$e.serverId+"_"+$e.channelId],pr=($e==null?void 0:$e.status)===2,Pt.mentionedCount=pr?Pt.mentionedCount?Pt.mentionedCount-1:0:Pt.mentionedCount?Pt.mentionedCount+1:1,typeof Pt.maxCount!="number"){Vr.next=24;break}if(!((yr=(yr=Pt.mentionedCount)>Pt.maxCount?Pt.maxCount:yr)>Pt.maxCount)){Vr.next=21;break}return this.core.logger.debug("QChatChannel::handledRoleMsg::tempUnreadCount more than maxCount"),Vr.abrupt("return");case 21:this.core.emit("unreadInfo",Vn(Vn({},Pt),{mentionedCount:yr})),this.core.emit("unreadInfos",[Vn(Vn({},Pt),{mentionedCount:yr})]),this._serverUnreadInfo($e.serverId);case 24:case"end":return Vr.stop()}},Oe,this)}))},Ne.getMentionedFlag=function($e,Oe){return Oe===void 0&&(Oe=!1),zr(this,void 0,void 0,_r.mark(function Lt(){var rr;return _r.wrap(function(pr){for(;;)switch(pr.prev=pr.next){case 0:if(!$e.mentionAll){pr.next=4;break}return pr.abrupt("return",!0);case 4:if(!$e.mentionRoleIds&&!$e.accidsOfMentionedRoles){pr.next=10;break}return pr.next=7,this.shouldChangeMentionedUnread($e,Oe);case 7:return pr.abrupt("return",pr.sent);case 10:if(!$e.mentionAccids||!qi(rr=$e.mentionAccids).call(rr,this.core.account)){pr.next=12;break}return pr.abrupt("return",!0);case 12:return pr.abrupt("return",!1);case 13:case"end":return pr.stop()}},Lt,this)}))},Ne.changeUnread=function($e,Oe){return zr(this,void 0,void 0,_r.mark(function Lt(){var rr,Pt,pr,yr,Pr,Rr,Vr;return _r.wrap(function(Xr){for(;;)switch(Xr.prev=Xr.next){case 0:if(rr=$e.serverId,Pt=$e.channelId,pr=rr+"_"+Pt,this.shouldChangeUnread($e,Oe)){Xr.next=6;break}return this.core.logger.debug("changeUnread: "+pr+" does not need to update unreadInfo"),Xr.abrupt("return");case 6:if(this.unreadCount[pr]){Xr.next=11;break}return Xr.next=9,this.core.qchatChannel.getChannelUnreadInfos({channels:[{serverId:rr,channelId:Pt}]});case 9:return!this.serverRoleIdsMap[rr]&&$e.mentionRoleIds&&this.getRoleIdsByServerId([rr]),Xr.abrupt("return");case 11:return yr=this.unreadCount[pr],Pr=($e==null?void 0:$e.status)===2,Xr.next=15,this.getMentionedFlag($e);case 15:if(Rr=Xr.sent,Pr?(yr.unreadCount=yr.unreadCount?yr.unreadCount-1:0,Rr&&(yr.mentionedCount=yr.mentionedCount?yr.mentionedCount-1:0),delete yr.lastMsgTime,this.core.logger.debug("changeUnread: "+pr+" unread reduce ",yr)):(yr.unreadCount=yr.unreadCount?yr.unreadCount+1:1,Rr&&(yr.mentionedCount=yr.mentionedCount?yr.mentionedCount+1:1),$e.time&&(yr.lastMsgTime=$e.time),this.core.logger.debug("changeUnread: "+pr+" unread add ",yr)),Vr=typeof yr.maxCount=="number"?yr.maxCount:100,!(yr.unreadCount>Vr)){Xr.next=21;break}return this.core.logger.debug("QChatChannel::subscribe::tempUnreadCount more than maxCount"),Xr.abrupt("return");case 21:this.core.logger.warn("unreadInfo event will abandon,please use unreadInfos"),this.core.emit("unreadInfo",Vn(Vn({},yr),{mentionedCount:yr.mentionedCount>Vr?Vr:yr.mentionedCount,unreadCount:yr.unreadCount>Vr?Vr:yr.unreadCount})),this.core.emit("unreadInfos",[Vn(Vn({},yr),{mentionedCount:yr.mentionedCount>Vr?Vr:yr.mentionedCount,unreadCount:yr.unreadCount>Vr?Vr:yr.unreadCount})]),this._serverUnreadInfo(rr);case 25:case"end":return Xr.stop()}},Lt,this)}))},Ne.updateUnreads=function($e){var Oe,Lt=this;if($e&&$e.length>0){var rr=this.getServerUnreadInfo($e[0].serverId),Pt=this.unreadServerCount[$e[0].serverId],pr=Ro(Oe=ki($e).call($e,function(kn){var Tn=kn.serverId+"_"+kn.channelId,Dn=Lt.unreadCount[Tn],Fn=ys(Dn,"ackTimestamp"),Gn=ys(kn,"ackTimestamp");return!(Fn&&Gn&&Gn<Fn)&&(ys(Dn,"unreadCount")!==ys(kn,"unreadCount")||ys(Dn,"mentionedCount")!==ys(kn,"mentionedCount"))})).call(Oe,function(kn){var Tn=kn.serverId,Dn=kn.channelId,Fn=Tn+"_"+Dn;return Lt.core.logger.debug("qchat channel updateUnread: ",kn),Lt.unreadCount[Fn]=Vn({},kn),Lt.unreadServerCount[Tn]||(Lt.unreadServerCount[Tn]={}),Lt.unreadServerCount[Tn][Dn]=!0,kn});if(pr.length>0){this.core.emit("unreadInfos",pr);var yr=this.getServerUnreadInfo($e[0].serverId),Pr=this.unreadServerCount[$e[0].serverId],Rr=rr.unreadCount!==yr.unreadCount,Vr=!Pt||ka(Pt).length===0,Dr=Pr&&ka(Pr).length>0,Xr=rr.mentionedCount!==yr.mentionedCount;(Rr||Xr||Vr&&Dr)&&this._serverUnreadInfo(pr[0].serverId)}Qn(pr).call(pr,function(kn){Lt.core.emit("unreadInfo",kn)})}},Ne.clearUnreadCountByServers=function($e,Oe){var Lt=this,rr=[];Qn($e).call($e,function(pr){var yr;Lt.unreadServerCount[pr]&&Qn(yr=ka(Lt.unreadServerCount[pr])).call(yr,function(Pr){rr.push(pr+"_"+Pr)})});var Pt=[];Qn(rr).call(rr,function(pr){Pt.push(Vn(Vn({},Lt.unreadCount[pr]),{unreadCount:0,mentionedCount:0,ackTimestamp:Oe}))}),this.updateUnreads(Pt)},pe}(),SC=function(){function pe(kt){this.limitForBatchEnter=10,this.limitForBatchSubscribe=100,this.autoServers=new wu,this.autoVisitorSubscribeServer=new wu,this.autoVisitorSubscribeChannel=new wu,this.core=kt}var Ne=pe.prototype;return Ne.subscribeChannelAsVisitor=function($e){return zr(this,void 0,void 0,_r.mark(function Oe(){var Lt,rr,Pt,pr,yr=this;return _r.wrap(function(Rr){for(;;)switch(Rr.prev=Rr.next){case 0:return Rr.next=2,this.core.sendCmd("qchatSubscribeAsVisitor",{tag:{type:$e.type||6,opeType:$e.opeType},datas:$e.channels});case 2:return rr=Rr.sent,Pt=rr.content.failedArr,pr=ki(Lt=$e.channels).call(Lt,function(Vr){return!sf(Pt).call(Pt,function(Dr){return Dr.channelId===Vr.channelId&&Dr.serverId===Vr.serverId})}),Qn(pr).call(pr,function(Vr){$e.opeType===1?yr.autoVisitorSubscribeChannel.add(Vr.serverId+"&"+Vr.channelId):yr.autoVisitorSubscribeChannel.delete(Vr.serverId+"&"+Vr.channelId)}),Rr.abrupt("return",{failedChannels:Pt});case 7:case"end":return Rr.stop()}},Oe,this)}))},Ne.subscribeServerAsVisitor=function($e){return zr(this,void 0,void 0,_r.mark(function Oe(){var Lt,rr,Pt,pr,yr,Pr,Rr=this;return _r.wrap(function(Dr){for(;;)switch(Dr.prev=Dr.next){case 0:return Dr.next=2,this.core.sendCmd("qchatSubscribeAsVisitor",{tag:{type:$e.type||7,opeType:$e.opeType},datas:Ro(Lt=$e.serverIds).call(Lt,function(Xr){return{serverId:Xr}})});case 2:return pr=Dr.sent,yr=pr.content.failedArr,Pr=ki(rr=$e.serverIds).call(rr,function(Xr){return!sf(yr).call(yr,function(kn){return kn.serverId===Xr})}),Qn(Pr).call(Pr,function(Xr){$e.opeType===1?Rr.autoVisitorSubscribeServer.add(Xr):Rr.autoVisitorSubscribeServer.delete(Xr)}),Dr.abrupt("return",{failedServers:Ro(Pt=pr.content.failedArr).call(Pt,function(Xr){return Xr.serverId})});case 7:case"end":return Dr.stop()}},Oe,this)}))},Ne.deleteServer=function($e){var Oe;this.autoServers.delete($e),this.autoVisitorSubscribeServer.has($e)&&this.subscribeServerAsVisitor({opeType:2,serverIds:[$e]});var Lt=[];Qn(Oe=this.autoVisitorSubscribeChannel).call(Oe,function(rr){if(Ba(rr).call(rr,$e)===0){var Pt=rr.replace($e+"&","");Lt.push({serverId:$e,channelId:Pt})}}),Lt.length>0&&this.subscribeChannelAsVisitor({opeType:2,channels:Lt})},Ne.deleteAutoSetInServerId=function($e){var Oe,Lt=this;this.autoServers.delete($e),this.autoVisitorSubscribeServer.delete($e),Qn(Oe=this.autoVisitorSubscribeChannel).call(Oe,function(rr){Ba(rr).call(rr,$e)===0&&Lt.autoVisitorSubscribeChannel.delete(rr)})},Ne.deleteAutoSetInChannel=function($e,Oe){this.autoVisitorSubscribeChannel.delete($e+"&"+Oe)},Ne.unSubscribeChannel=function($e,Oe){this.subscribeChannelAsVisitor({opeType:2,channels:[{serverId:$e,channelId:Oe}]})},Ne.isInSubscribeChannels=function($e,Oe){return this.autoVisitorSubscribeChannel.has($e+"&"+Oe)},Ne.isInAutoServers=function($e){return this.autoServers.has($e)},Ne.doAutoSubscribe=function(){var $e=this,Oe=[],Lt=xu(Xc(this.autoVisitorSubscribeServer),this.limitForBatchSubscribe);Qn(Lt).call(Lt,function(Pt){Oe.push($e.subscribeServerAsVisitor({opeType:1,serverIds:Pt}))});var rr=xu(Xc(this.autoVisitorSubscribeChannel),this.limitForBatchSubscribe);return Qn(rr).call(rr,function(Pt){Oe.push($e.subscribeChannelAsVisitor({opeType:1,channels:Ro(Pt).call(Pt,function(pr){var yr=Ba(pr).call(pr,"&");return{serverId:$o(pr).call(pr,0,yr),channelId:$o(pr).call(pr,yr+1)}})}))}),xo.all(Oe)},Ne.doAutoEnterServer=function(){return zr(this,void 0,void 0,_r.mark(function $e(){var Oe,Lt,rr,Pt=this;return _r.wrap(function(yr){for(;;)switch(yr.prev=yr.next){case 0:return Oe=xu(Xc(this.autoServers),this.limitForBatchEnter),Lt=[],Qn(Oe).call(Oe,function(Pr){Lt.push(Pt.core.qchatServer.enterAsVisitor({serverIds:Pr}))}),yr.next=5,xo.all(Lt);case 5:rr=yr.sent,Qn(rr).call(rr,function(Pr){var Rr;Qn(Rr=Pr.failedServers).call(Rr,function(Vr){Pt.deleteAutoSetInServerId(Vr)})});case 7:case"end":return yr.stop()}},$e,this)}))},Ne.resumeSubscribe=function($e){return zr(this,void 0,void 0,_r.mark(function Oe(){return _r.wrap(function(rr){for(;;)switch(rr.prev=rr.next){case 0:if(!$e.isAutoReconnect){rr.next=7;break}return rr.next=3,this.doAutoEnterServer();case 3:return rr.next=5,this.doAutoSubscribe();case 5:rr.next=10;break;case 7:this.autoServers.clear(),this.autoVisitorSubscribeChannel.clear(),this.autoVisitorSubscribeServer.clear();case 10:case"end":return rr.stop()}},Oe,this)}))},Ne.cacheServer=function($e){var Oe=this;Qn($e).call($e,function(Lt){return Oe.autoServers.add(Lt)})},pe}();(function(pe){pe[pe.sub=1]="sub",pe[pe.unSub=2]="unSub"})(av||(av={}));var TC=function(pe){function Ne($e){var Oe,Lt,rr,Pt,pr,yr;return(yr=pe.call(this,"qchatChannel",$e)||this).core=$e,oc({cmdMap:ep,cmdConfig:Kh}),yr.subscribeModuleService=new bC($e),yr.subscribeForVisitorService=new SC($e),yr.core.eventBus.on("qchatChannel/changeUnread",Zo(Oe=yr.subscribeModuleService.changeUnread).call(Oe,yr.subscribeModuleService)),yr.core.eventBus.on("qchatChannel/updateUnreads",Zo(Lt=yr.subscribeModuleService.updateUnreads).call(Lt,yr.subscribeModuleService)),yr.core.eventBus.on("qchatChannel/cacheSubscribe",Zo(rr=yr.subscribeModuleService.cacheSubscribe).call(rr,yr.subscribeModuleService)),yr.core.eventBus.on("qchatChannel/clearUnreadCountByServers",Zo(Pt=yr.subscribeModuleService.clearUnreadCountByServers).call(Pt,yr.subscribeModuleService)),yr.core.eventBus.on("qchatChannel/getRoleIdsByServerId",Zo(pr=yr.subscribeModuleService.getRoleIdsByServerId).call(pr,yr.subscribeModuleService)),yr.core.eventBus.on("logined",function(Pr){yr.subscribeModuleService.resumeSubscribe(Pr),yr.subscribeForVisitorService.resumeSubscribe(Pr)}),yr.core.eventBus.on("qchatChannel/autoUnSubscribe",function(Pr){if(yr.logger.log("QChatChannel::enter autoUnSubscribe sysMsg is",Pr),Pr.type===ba[ba.channelVisibilityUpdate])yr.logger.log("QChatChannel::begin autoUnSubscribe channel key is",Pr.serverId+"_"+Pr.channelId),yr.subscribeModuleService._unSubscribeChannel(Pr.serverId,Pr.channelId),yr.logger.log("QChatChannel::autoUnSubscribe channel done key is",Pr.serverId+"_"+Pr.channelId);else if(Pr.type===ba[ba.serverEnterLeave]){var Rr;yr.subscribeModuleService.autoSubscribeServerMap[Pr.serverId]&&(yr.logger.log("QChatChannel::begin autoUnSubscribe server key is",Pr.serverId),yr.subscribeModuleService.subscribe({type:4,opeType:av.unSub,channels:[{serverId:Pr.serverId,channelId:""}]}),yr.logger.log("QChatChannel::autoUnSubscribe server done key is",Pr.serverId));var Vr=yr.subscribeModuleService.unreadServerCount[Pr.serverId];if(!Vr)return;yr.logger.log("QChatChannel::begin autoUnSubscribe channels key is",ka(Vr)),Qn(Rr=ka(Vr)).call(Rr,function(Dr){yr.subscribeModuleService._unSubscribeChannel(Pr.serverId,Dr)}),yr.logger.log("QChatChannel::autoUnSubscribe channels done key is",ka(Vr))}}),yr.core.eventBus.on("qchatChannel/serverIdentifyChange",function(Pr){yr.subscribeModuleService.changeCacheServerRoleIds(Pr)}),yr}ea(Ne,pe);var kt=Ne.prototype;return kt.createChannel=function(Oe){return zr(this,void 0,void 0,_r.mark(function Lt(){var rr;return _r.wrap(function(pr){for(;;)switch(pr.prev=pr.next){case 0:return On({serverId:{type:"string",min:1},type:{type:"enum",values:Ea(ql)},name:{type:"string",required:!1},topic:{type:"string",required:!1},ext:{type:"string",required:!1},visitorMode:{type:"number",required:!1}},Oe),pr.next=3,this.core.sendCmd("qchatCreateChannel",{channelInfo:Vn(Vn({},Oe),{type:ql[Oe.type]}),antispamTag:nl(Oe)});case 3:return rr=pr.sent,pr.abrupt("return",ap(rr.content.channelInfo));case 5:case"end":return pr.stop()}},Lt,this)}))},kt.deleteChannel=function(Oe){return zr(this,void 0,void 0,_r.mark(function Lt(){return _r.wrap(function(Pt){for(;;)switch(Pt.prev=Pt.next){case 0:return On({channelId:{type:"string",allowEmpty:!1}},Oe),Pt.next=3,this.core.sendCmd("qchatDeleteChannel",Oe);case 3:case"end":return Pt.stop()}},Lt,this)}))},kt.updateChannel=function(Oe){return zr(this,void 0,void 0,_r.mark(function Lt(){var rr,Pt;return _r.wrap(function(yr){for(;;)switch(yr.prev=yr.next){case 0:return On({channelId:{type:"string",min:1},serverId:{type:"string",required:!1},type:{type:"enum",values:Ea(ql),required:!1},name:{type:"string",required:!1},topic:{type:"string",required:!1},ext:{type:"string",required:!1},visitorMode:{type:"number",required:!1}},Oe),rr=Oe,Oe.type&&(rr.type=ql[Oe.type]),yr.next=5,this.core.sendCmd("qchatUpdateChannel",{channelInfo:rr,antispamTag:nl(Oe)});case 5:return Pt=yr.sent,yr.abrupt("return",ap(Pt.content.channelInfo));case 7:case"end":return yr.stop()}},Lt,this)}))},kt.getChannels=function(Oe){return zr(this,void 0,void 0,_r.mark(function Lt(){var rr;return _r.wrap(function(pr){for(;;)switch(pr.prev=pr.next){case 0:return On({channelIds:{type:"array",itemType:"string",min:1}},Oe),pr.next=3,this.core.sendCmd("qchatGetChannels",Oe);case 3:return rr=pr.sent,pr.abrupt("return",sp(rr.content.channelList));case 5:case"end":return pr.stop()}},Lt,this)}))},kt.getChannelsByPage=function(Oe){return zr(this,void 0,void 0,_r.mark(function Lt(){var rr,Pt,pr,yr;return _r.wrap(function(Rr){for(;;)switch(Rr.prev=Rr.next){case 0:return On({serverId:{type:"string",min:1},timetag:{type:"number"},limit:{type:"number",min:1,required:!1}},Oe),Rr.next=3,this.core.sendCmd("qchatGetChannelsByPage",{qchatGetChannelListPageTag:Vn({limit:100},Oe)});case 3:return rr=Rr.sent,Pt=rr.content,pr=Pt.datas,yr=Pt.listQueryTag,Rr.abrupt("return",{listQueryTag:{hasMore:+yr.hasMore==1,nextTimetag:na(yr.nextTimetag)},datas:sp(pr)});case 6:case"end":return Rr.stop()}},Lt,this)}))},kt.getMembersByPage=function(Oe){return zr(this,void 0,void 0,_r.mark(function Lt(){var rr,Pt,pr,yr;return _r.wrap(function(Rr){for(;;)switch(Rr.prev=Rr.next){case 0:return On({serverId:{type:"string",min:1},channelId:{type:"string",min:1},timetag:{type:"number"},limit:{type:"number",min:1,required:!1}},Oe),Rr.next=3,this.core.sendCmd("qchatGetMembersByPage",{qchatGetMembersByPageTag:Oe});case 3:return rr=Rr.sent,Pt=rr.content,pr=Pt.datas,yr=Pt.listQueryTag,Rr.abrupt("return",{listQueryTag:{hasMore:+yr.hasMore==1,nextTimetag:na(yr.nextTimetag)},datas:Bc(pr)});case 6:case"end":return Rr.stop()}},Lt,this)}))},kt.updateWhiteBlackRole=function(Oe){return zr(this,void 0,void 0,_r.mark(function Lt(){return _r.wrap(function(Pt){for(;;)switch(Pt.prev=Pt.next){case 0:return On({serverId:{type:"string",min:1},channelId:{type:"string",min:1},roleId:{type:"string",min:1},type:{type:"enum",values:Ea(Pa)},opeType:{type:"enum",values:Ea(xi)}},Oe),Pt.next=3,this.core.sendCmd("qchatUpdateWhiteBlackRole",{qchatUpdateWhiteBlackRoleTag:Vn(Vn({},Oe),{type:Pa[Oe.type],opeType:xi[Oe.opeType]})});case 3:case"end":return Pt.stop()}},Lt,this)}))},kt.getWhiteBlackRolesPage=function(Oe){return zr(this,void 0,void 0,_r.mark(function Lt(){var rr,Pt,pr,yr;return _r.wrap(function(Rr){for(;;)switch(Rr.prev=Rr.next){case 0:return On({serverId:{type:"string",min:1},channelId:{type:"string",min:1},type:{type:"enum",values:Ea(Pa)},timetag:{type:"number"},limit:{type:"number",min:1,required:!1}},Oe),Rr.next=3,this.core.sendCmd("qchatGetWhiteBlackRolesPage",{qchatGetWhiteBlackRolesPageTag:Vn(Vn({},Oe),{type:Pa[Oe.type]})});case 3:return rr=Rr.sent,Pt=rr.content,pr=Pt.datas,yr=Pt.listQueryTag,Rr.abrupt("return",{listQueryTag:{hasMore:+yr.hasMore==1,nextTimetag:na(yr.nextTimetag)},datas:yi(pr)});case 6:case"end":return Rr.stop()}},Lt,this)}))},kt.updateWhiteBlackMembers=function(Oe){return zr(this,void 0,void 0,_r.mark(function Lt(){return _r.wrap(function(Pt){for(;;)switch(Pt.prev=Pt.next){case 0:return On({serverId:{type:"string",min:1},channelId:{type:"string",min:1},type:{type:"enum",values:Ea(Pa)},opeType:{type:"enum",values:Ea(xi)},toAccids:{type:"array",itemType:"string",min:1}},Oe),Pt.next=3,this.core.sendCmd("qchatUpdateWhiteBlackMembers",{qchatUpdateWhiteBlackMembersTag:Vn(Vn({},Oe),{type:Pa[Oe.type],opeType:xi[Oe.opeType],toAccids:Ao(Oe.toAccids)})});case 3:case"end":return Pt.stop()}},Lt,this)}))},kt.getWhiteBlackMembersPage=function(Oe){return zr(this,void 0,void 0,_r.mark(function Lt(){var rr,Pt,pr,yr;return _r.wrap(function(Rr){for(;;)switch(Rr.prev=Rr.next){case 0:return On({serverId:{type:"string",min:1},channelId:{type:"string",min:1},type:{type:"enum",values:Ea(Pa)},timetag:{type:"number"},limit:{type:"number",min:1,required:!1}},Oe),Rr.next=3,this.core.sendCmd("qchatGetWhiteBlackMembersPage",{qchatGetWhiteBlackMembersPageTag:Vn(Vn({limit:100},Oe),{type:Pa[Oe.type]})});case 3:return rr=Rr.sent,Pt=rr.content,pr=Pt.datas,yr=Pt.listQueryTag,Rr.abrupt("return",{listQueryTag:{hasMore:+yr.hasMore==1,nextTimetag:na(yr.nextTimetag)},datas:Bc(pr)});case 6:case"end":return Rr.stop()}},Lt,this)}))},kt.getExistingWhiteBlackRoles=function(Oe){return zr(this,void 0,void 0,_r.mark(function Lt(){var rr,Pt;return _r.wrap(function(yr){for(;;)switch(yr.prev=yr.next){case 0:return On({serverId:{type:"string",min:1},channelId:{type:"string",min:1},type:{type:"enum",values:Ea(Pa)},roleIds:{type:"array",itemType:"string",min:1}},Oe),yr.next=3,this.core.sendCmd("qchatGetExistingWhiteBlackRoles",{qchatGetExistingWhiteBlackRolesTag:Vn(Vn({},Oe),{type:Pa[Oe.type],roleIds:Ao(Oe.roleIds)})});case 3:return rr=yr.sent,Pt=rr.content.datas,yr.abrupt("return",{datas:yi(Pt)});case 6:case"end":return yr.stop()}},Lt,this)}))},kt.getExistingWhiteBlackMembers=function(Oe){return zr(this,void 0,void 0,_r.mark(function Lt(){var rr,Pt;return _r.wrap(function(yr){for(;;)switch(yr.prev=yr.next){case 0:return On({serverId:{type:"string",min:1},channelId:{type:"string",min:1},type:{type:"enum",values:Ea(Pa)},accids:{type:"array",itemType:"string",min:1}},Oe),yr.next=3,this.core.sendCmd("qchatGetExistingWhiteBlackMembers",{qchatGetExistingWhiteBlackMembersTag:Vn(Vn({},Oe),{type:Pa[Oe.type],accids:Ao(Oe.accids)})});case 3:return rr=yr.sent,Pt=rr.content.datas,yr.abrupt("return",{datas:Bc(Pt)});case 6:case"end":return yr.stop()}},Lt,this)}))},kt.updateCategoryInfoOfChannel=function(Oe){return zr(this,void 0,void 0,_r.mark(function Lt(){var rr;return _r.wrap(function(pr){for(;;)switch(pr.prev=pr.next){case 0:return On({channelId:{type:"string",min:1},categoryId:{type:"string",allowEmpty:!1,required:!1},syncMode:{type:"number",min:0,max:1,required:!1}},Oe),pr.next=3,this.core.sendCmd("qchatUpdateCategoryInfoOfChannel",{qchatUpdateCategoryInfoOfChannelTag:Oe});case 3:return rr=pr.sent,pr.abrupt("return",ap(rr.content.channelInfo));case 5:case"end":return pr.stop()}},Lt,this)}))},kt.createChannelCategory=function(Oe){return zr(this,void 0,void 0,_r.mark(function Lt(){var rr;return _r.wrap(function(pr){for(;;)switch(pr.prev=pr.next){case 0:return On({serverId:{type:"string",allowEmpty:!1},name:{type:"string",allowEmpty:!1,required:!1},ext:{type:"string",required:!1},viewMode:{type:"number",min:0,max:1,required:!1}},Oe),pr.next=3,this.core.sendCmd("qchatCreateChannelCategory",{qchatCreateChannelCategoryTag:Oe});case 3:return rr=pr.sent,pr.abrupt("return",cp(rr.content.QChatChannelCategoryInfo));case 5:case"end":return pr.stop()}},Lt,this)}))},kt.removeChannelCategory=function(Oe){return zr(this,void 0,void 0,_r.mark(function Lt(){return _r.wrap(function(Pt){for(;;)switch(Pt.prev=Pt.next){case 0:return On({categoryId:{type:"string",allowEmpty:!1}},Oe),Pt.next=3,this.core.sendCmd("qchatRemoveChannelCategory",Oe);case 3:case"end":return Pt.stop()}},Lt,this)}))},kt.updateChannelCategory=function(Oe){return zr(this,void 0,void 0,_r.mark(function Lt(){var rr;return _r.wrap(function(pr){for(;;)switch(pr.prev=pr.next){case 0:return On({categoryId:{type:"string",allowEmpty:!1},name:{type:"string",allowEmpty:!1,required:!1},ext:{type:"string",required:!1},viewMode:{type:"number",min:0,max:1,required:!1}},Oe),pr.next=3,this.core.sendCmd("qchatUpdateChannelCategory",{qchatUpdateChannelCategoryTag:Oe});case 3:return rr=pr.sent,pr.abrupt("return",cp(rr.content.QChatChannelCategoryInfo));case 5:case"end":return pr.stop()}},Lt,this)}))},kt.getChannelCategoriesByID=function(Oe){return zr(this,void 0,void 0,_r.mark(function Lt(){var rr;return _r.wrap(function(pr){for(;;)switch(pr.prev=pr.next){case 0:return On({categoryIds:{type:"array",itemType:"string",min:1}},Oe),pr.next=3,this.core.sendCmd("qchatGetChannelCategoriesByID",Oe);case 3:return rr=pr.sent,pr.abrupt("return",Xh(rr.content.channelCategoryList));case 5:case"end":return pr.stop()}},Lt,this)}))},kt.updateChannelCategoryWhiteBlackRole=function(Oe){return zr(this,void 0,void 0,_r.mark(function Lt(){return _r.wrap(function(Pt){for(;;)switch(Pt.prev=Pt.next){case 0:return On({categoryId:{type:"string",allowEmpty:!1},serverId:{type:"string",allowEmpty:!1},type:{type:"enum",values:Ea(Pa)},opeType:{type:"enum",values:Ea(xi)},roleId:{type:"string",allowEmpty:!1}},Oe),Pt.next=3,this.core.sendCmd("qchatUpdateChannelCategoryWhiteBlackRole",{qchatUpdateChannelCategoryWhiteBlackRoleTag:Vn(Vn({},Oe),{type:Pa[Oe.type],opeType:xi[Oe.opeType]})});case 3:case"end":return Pt.stop()}},Lt,this)}))},kt.getChannelCategoryWhiteBlackRolesPage=function(Oe){return zr(this,void 0,void 0,_r.mark(function Lt(){var rr,Pt,pr,yr;return _r.wrap(function(Rr){for(;;)switch(Rr.prev=Rr.next){case 0:return On({categoryId:{type:"string",allowEmpty:!1},serverId:{type:"string",allowEmpty:!1},type:{type:"enum",values:Ea(Pa)},timetag:{type:"number",min:0},limit:{type:"number",min:1,required:!1}},Oe),Rr.next=3,this.core.sendCmd("qchatGetChannelCategoryWhiteBlackRolesPage",{qchatGetChannelCategoryWhiteBlackRolesPageTag:Vn(Vn({},Oe),{type:Pa[Oe.type]})});case 3:return rr=Rr.sent,Pt=rr.content,pr=Pt.datas,yr=Pt.listQueryTag,Rr.abrupt("return",{listQueryTag:{hasMore:+yr.hasMore==1,nextTimetag:na(yr.nextTimetag)},datas:yi(pr)});case 6:case"end":return Rr.stop()}},Lt,this)}))},kt.updateChannelCategoryWhiteBlackMembers=function(Oe){return zr(this,void 0,void 0,_r.mark(function Lt(){return _r.wrap(function(Pt){for(;;)switch(Pt.prev=Pt.next){case 0:return On({categoryId:{type:"string",allowEmpty:!1},serverId:{type:"string",allowEmpty:!1},type:{type:"enum",values:Ea(Pa)},opeType:{type:"enum",values:Ea(xi)},toAccids:{type:"array",itemType:"string",min:1}},Oe),Pt.next=3,this.core.sendCmd("qchatUpdateChannelCategoryWhiteBlackMembers",{qchatUpdateChannelCategoryWhiteBlackMembersTag:Vn(Vn({},Oe),{type:Pa[Oe.type],opeType:xi[Oe.opeType],toAccids:Ao(Oe.toAccids)})});case 3:case"end":return Pt.stop()}},Lt,this)}))},kt.getChannelCategoryWhiteBlackMembersPage=function(Oe){return zr(this,void 0,void 0,_r.mark(function Lt(){var rr,Pt,pr,yr;return _r.wrap(function(Rr){for(;;)switch(Rr.prev=Rr.next){case 0:return On({categoryId:{type:"string",allowEmpty:!1},serverId:{type:"string",allowEmpty:!1},type:{type:"enum",values:Ea(Pa)},timetag:{type:"number",min:0},limit:{type:"number",min:1,required:!1}},Oe),Rr.next=3,this.core.sendCmd("qchatGetChannelCategoryWhiteBlackMembersPage",{qchatGetChannelCategoryWhiteBlackMembersPageTag:Vn(Vn({},Oe),{type:Pa[Oe.type]})});case 3:return rr=Rr.sent,Pt=rr.content,pr=Pt.datas,yr=Pt.listQueryTag,Rr.abrupt("return",{listQueryTag:{hasMore:+yr.hasMore==1,nextTimetag:na(yr.nextTimetag)},datas:Bc(pr)});case 6:case"end":return Rr.stop()}},Lt,this)}))},kt.getChannelCategoryWhiteBlackRoles=function(Oe){return zr(this,void 0,void 0,_r.mark(function Lt(){var rr,Pt;return _r.wrap(function(yr){for(;;)switch(yr.prev=yr.next){case 0:return On({categoryId:{type:"string",allowEmpty:!1},serverId:{type:"string",allowEmpty:!1},type:{type:"enum",values:Ea(Pa)},roleIds:{type:"array",itemType:"string",min:1}},Oe),yr.next=3,this.core.sendCmd("qchatGetChannelCategoryWhiteBlackRoles",{qchatGetChannelCategoryWhiteBlackRolesTag:Vn(Vn({},Oe),{type:Pa[Oe.type],roleIds:Ao(Oe.roleIds)})});case 3:return rr=yr.sent,Pt=rr.content.datas,yr.abrupt("return",yi(Pt));case 6:case"end":return yr.stop()}},Lt,this)}))},kt.getChannelCategoryWhiteBlackMembers=function(Oe){return zr(this,void 0,void 0,_r.mark(function Lt(){var rr,Pt;return _r.wrap(function(yr){for(;;)switch(yr.prev=yr.next){case 0:return On({categoryId:{type:"string",allowEmpty:!1},serverId:{type:"string",allowEmpty:!1},type:{type:"enum",values:Ea(Pa)},accids:{type:"array",itemType:"string",min:1}},Oe),yr.next=3,this.core.sendCmd("qchatGetChannelCategoryWhiteBlackMembers",{qchatGetChannelCategoryWhiteBlackMembersTag:Vn(Vn({},Oe),{type:Pa[Oe.type],accids:Ao(Oe.accids)})});case 3:return rr=yr.sent,Pt=rr.content.datas,yr.abrupt("return",Bc(Pt));case 6:case"end":return yr.stop()}},Lt,this)}))},kt.getChannelCategoriesPage=function(Oe){return zr(this,void 0,void 0,_r.mark(function Lt(){var rr,Pt,pr,yr;return _r.wrap(function(Rr){for(;;)switch(Rr.prev=Rr.next){case 0:return On({serverId:{type:"string",allowEmpty:!1},timetag:{type:"number",min:0},limit:{type:"number",min:1,required:!1}},Oe),Rr.next=3,this.core.sendCmd("qchatGetChannelCategoriesPage",{qchatGetChannelCategoriesPageTag:Oe});case 3:return rr=Rr.sent,Pt=rr.content,pr=Pt.datas,yr=Pt.listQueryTag,Rr.abrupt("return",{listQueryTag:{hasMore:+yr.hasMore==1,nextTimetag:na(yr.nextTimetag)},datas:Xh(pr)});case 6:case"end":return Rr.stop()}},Lt,this)}))},kt.getChannelCategoryChannelsPage=function(Oe){return zr(this,void 0,void 0,_r.mark(function Lt(){var rr,Pt,pr,yr;return _r.wrap(function(Rr){for(;;)switch(Rr.prev=Rr.next){case 0:return On({serverId:{type:"string",allowEmpty:!1},categoryId:{type:"string",allowEmpty:!1},timetag:{type:"number",min:0},limit:{type:"number",min:1,required:!1}},Oe),Rr.next=3,this.core.sendCmd("qchatGetChannelCategoryChannelsPage",{qchatGetChannelCategoryChannelsPageTag:Oe});case 3:return rr=Rr.sent,Pt=rr.content,pr=Pt.datas,yr=Pt.listQueryTag,Rr.abrupt("return",{listQueryTag:{hasMore:+yr.hasMore==1,nextTimetag:na(yr.nextTimetag)},datas:sp(pr)});case 6:case"end":return Rr.stop()}},Lt,this)}))},kt.subscribeChannel=function(Oe){return zr(this,void 0,void 0,_r.mark(function Lt(){var rr,Pt;return _r.wrap(function(yr){for(;;)switch(yr.prev=yr.next){case 0:return On({type:{type:"number",min:1,max:5},opeType:{type:"number",min:1,max:2}},Oe),yr.next=3,this.subscribeModuleService.subscribe(Oe);case 3:if((rr=yr.sent).unreadInfos=ip(rr.unreadInfos),Oe.opeType===1&&(Oe.channels=Ro(Pt=rr.unreadInfos).call(Pt,function(Pr){return{serverId:Pr.serverId,channelId:Pr.channelId}})),this.logger.debug("QChatChannel::subscribeChannel:: cacheSubscribe ",Oe),this.subscribeModuleService.cacheSubscribe(Oe),Oe.type!==5){yr.next=10;break}return yr.abrupt("return");case 10:return this.subscribeModuleService.updateUnreads(rr.unreadInfos),yr.abrupt("return",rr);case 12:case"end":return yr.stop()}},Lt,this)}))},kt.getChannelUnreadInfos=function(Oe){return zr(this,void 0,void 0,_r.mark(function Lt(){var rr,Pt;return _r.wrap(function(yr){for(;;)switch(yr.prev=yr.next){case 0:return yr.next=2,this.core.sendCmd("qchatGetUnreadInfo",Oe);case 2:return rr=yr.sent,Pt=ip(rr.content.unreadInfos),this.subscribeModuleService.updateUnreads(Pt),yr.abrupt("return",Pt);case 6:case"end":return yr.stop()}},Lt,this)}))},kt.getChannelSearchByPage=function(Oe){return zr(this,void 0,void 0,_r.mark(function Lt(){var rr,Pt,pr,yr;return _r.wrap(function(Rr){for(;;)switch(Rr.prev=Rr.next){case 0:if(On({keyword:{type:"string",allowEmpty:!1},startTime:{type:"number",min:0,required:!1},endTime:{type:"number",min:1,required:!1},order:{type:"enum",values:Ea(tl),required:!1},limit:{type:"number",min:1,required:!1},serverId:{type:"string",required:!1},sort:{type:"enum",values:Ea(Sf),required:!1},cursor:{type:"string",allowEmpty:!1,required:!1}},Oe),!(Oe.startTime&&Oe.endTime&&Oe.startTime>=Oe.endTime)){Rr.next=3;break}throw new Nl("startTime more than endTime",Oe,"timeRule");case 3:return Rr.next=5,this.core.sendCmd("qchatGetChannelSearchByPage",{qchatGetChannelSearchByPageTag:Vn(Vn({},Oe),{order:Oe.order&&tl[Oe.order],sort:Su(Oe)&&Sf[Su(Oe)]})});case 5:return rr=Rr.sent,Pt=rr.content,pr=Pt.datas,yr=Pt.listQueryTag,Rr.abrupt("return",{listQueryTag:{hasMore:+yr.hasMore==1,nextTimetag:na(yr.nextTimetag),cursor:yr.cursor},datas:sp(pr)});case 8:case"end":return Rr.stop()}},Lt,this)}))},kt.channelMemberSearch=function(Oe){return zr(this,void 0,void 0,_r.mark(function Lt(){var rr;return _r.wrap(function(pr){for(;;)switch(pr.prev=pr.next){case 0:return On({serverId:{type:"string",allowEmpty:!1},channelId:{type:"string",allowEmpty:!1},keyword:{type:"string",allowEmpty:!1},limit:{type:"number",min:1,required:!1}},Oe),pr.next=3,this.core.sendCmd("qchatChannelMemberSearch",{qchatChannelMemberSearchTag:Oe});case 3:return rr=pr.sent,pr.abrupt("return",ZT(rr.content.datas));case 5:case"end":return pr.stop()}},Lt,this)}))},kt.subscribeAsVisitor=function(Oe){return zr(this,void 0,void 0,_r.mark(function Lt(){return _r.wrap(function(Pt){for(;;)switch(Pt.prev=Pt.next){case 0:return On({opeType:{type:"number",min:1,max:2},type:{type:"number",required:!1},channels:{type:"array",rules:{serverId:{type:"string",allowEmpty:!1},channelId:{type:"string",allowEmpty:!1}},min:1}},Oe),Pt.next=3,this.subscribeForVisitorService.subscribeChannelAsVisitor(Oe);case 3:return Pt.abrupt("return",Pt.sent);case 4:case"end":return Pt.stop()}},Lt,this)}))},Ne}(Vl),lb={"24_61":"qchatCreateServerRole","24_62":"qchatDeleteServerRole","24_63":"qchatUpdateServerRole","24_64":"qchatGetServerRoles","24_65":"qchatAddChannelRole","24_66":"qchatRemoveChannelRole","24_67":"qchatUpdateChannelRole","24_68":"qchatGetChannelRoles","24_69":"qchatAddMemberRole","24_70":"qchatRemoveMemberRole","24_71":"qchatUpdateMemberRole","24_72":"qchatGetMemberRoles","24_73":"qchatAddMembersToServerRole","24_74":"qchatRemoveMembersFromServerRole","24_75":"qchatGetMembersFromServerRole","24_76":"qchatGetServerRolesByAccid","24_77":"qchatGetExistingServerRolesByAccids","24_78":"qchatGetExistingChannelRolesByServerRoleIds","24_79":"qchatGetExistingAccidsOfMemberRoles","24_80":"qchatUpdateServerRolePriorities","24_81":"qchatGetExistingAccidsInServerRole","24_82":"qchatCheckPermission","24_83":"qchatAddChannelCategoryRole","24_84":"qchatRemoveChannelCategoryRole","24_85":"qchatUpdateChannelCategoryRole","24_86":"qchatGetChannelCategoryRole","24_87":"qchatAddChannelCategoryMemberRole","24_88":"qchatRemoveChannelCategoryMemberRole","24_89":"qchatUpdateChannelCategoryMemberRole","24_90":"qchatGetChannelCategoryMemberRole","24_126":"qchatCheckPermissions"},gs={channelRole:{serverId:1,roleId:2,parentRoleId:3,channelId:4,name:5,icon:6,ext:7,auths:8,type:9,createTime:10,updateTime:11},memberRole:{serverId:1,id:2,accid:3,channelId:4,auths:5,createTime:6,updateTime:7,nick:8,avatar:9,ext:10,memberType:11,joinTime:12,inviter:13},antispamTag:{antiSpamBusinessId:1},serverRole:{serverId:1,roleId:2,name:3,icon:4,ext:5,auths:6,type:7,memberCount:8,priority:9,createTime:10,updateTime:11,isMember:12},getRoleByPagesTag:{serverId:1,channelId:2,time:3,limit:4},checkPermissionTag:{serverId:1,channelId:2,auth:3},member:{serverId:1,roleId:2,accid:3,createTime:4,updateTime:5,nick:6,avatar:7,ext:8,type:9,joinTime:10,inviter:11},qchatAddChannelCategoryRoleTag:{categoryId:3,serverId:4,parentRoleId:5},channelCategoryRole:{roleId:1,categoryId:3,serverId:4,parentRoleId:5,type:6,validFlag:7,createTime:8,updateTime:9,auths:10,name:11,icon:12,ext:13},qchatGetChannelCategoryRoleTag:{serverId:1,categoryId:2,timetag:3,limit:4},channelCategoryMemberRole:{id:1,accid:3,categoryId:4,serverId:5,validFlag:6,createTime:7,updateTime:8,auths:9,nick:10,avatar:11,ext:12,memberType:13,joinTime:14,inviter:15},qchatGetChannelCategoryMemberRoleTag:{serverId:1,categoryId:2,timetag:3,limit:4},checkPermissionsTag:{serverId:1,channelId:2,auths:3}},Aa=Qc(gs),CC={qchatCreateServerRole:{service:"qchatRole",sid:24,cid:61,params:[{type:"Property",name:"serverRole",reflectMapper:gs.serverRole},{type:"Property",name:"antispamTag",reflectMapper:gs.antispamTag}],response:[{type:"Property",name:"serverRole",reflectMapper:Aa.serverRole}]},qchatDeleteServerRole:{service:"qchatRole",sid:24,cid:62,params:[{type:"Long",name:"serverId"},{type:"Long",name:"roleId"}]},qchatUpdateServerRole:{service:"qchatRole",sid:24,cid:63,params:[{type:"Property",name:"updateServerRoleTag",reflectMapper:{serverId:1,roleId:2,name:3,icon:4,ext:5,auths:6,priority:7}},{type:"Property",name:"antispamTag",reflectMapper:gs.antispamTag}],response:[{type:"Property",name:"serverRole",reflectMapper:Aa.serverRole}]},qchatGetServerRoles:{service:"qchatRole",sid:24,cid:64,params:[{type:"Property",name:"getServerRolesTag",reflectMapper:{serverId:1,timetag:2,limit:3,priority:4,channelId:5,categoryId:6}}],response:[{type:"PropertyArray",name:"serverRoles",reflectMapper:Aa.serverRole}]},qchatAddChannelRole:{service:"qchatRole",sid:24,cid:65,params:[{type:"Property",name:"channelRole",reflectMapper:gs.channelRole}],response:[{type:"Property",name:"channelRole",reflectMapper:Aa.channelRole}]},qchatRemoveChannelRole:{service:"qchatRole",sid:24,cid:66,params:[{type:"Long",name:"serverId"},{type:"Long",name:"channelId"},{type:"Long",name:"roleId"}]},qchatUpdateChannelRole:{service:"qchatRole",sid:24,cid:67,params:[{type:"Property",name:"updateChannelRoleTag",reflectMapper:{serverId:1,roleId:2,channelId:3,auths:4}}],response:[{type:"Property",name:"channelRole",reflectMapper:Aa.channelRole}]},qchatGetChannelRoles:{service:"qchatRole",sid:24,cid:68,params:[{type:"Property",name:"getChannelRolesTag",reflectMapper:{serverId:1,channelId:2,timetag:3,limit:4}}],response:[{type:"PropertyArray",name:"channelRoles",reflectMapper:Aa.channelRole}]},qchatAddMemberRole:{service:"qchatRole",sid:24,cid:69,params:[{type:"Property",name:"memberRole",reflectMapper:gs.memberRole}],response:[{type:"Property",name:"memberRole",reflectMapper:Aa.memberRole}]},qchatRemoveMemberRole:{service:"qchatRole",sid:24,cid:70,params:[{type:"Property",name:"memberRole",reflectMapper:gs.memberRole}]},qchatUpdateMemberRole:{service:"qchatRole",sid:24,cid:71,params:[{type:"Property",name:"updateMemberRoleTag",reflectMapper:{serverId:1,accid:2,channelId:3,auths:4}}],response:[{type:"Property",name:"memberRole",reflectMapper:Aa.memberRole}]},qchatGetMemberRoles:{service:"qchatRole",sid:24,cid:72,params:[{type:"Property",name:"getMemberRolesTag",reflectMapper:{serverId:1,channelId:2,timetag:3,limit:4}}],response:[{type:"PropertyArray",name:"memberRoles",reflectMapper:Aa.memberRole}]},qchatAddMembersToServerRole:{service:"qchatRole",sid:24,cid:73,params:[{type:"Long",name:"serverId"},{type:"Long",name:"roleId"},{type:"String",name:"accids"}],response:[{type:"Property",name:"accids",reflectMapper:{1:"successAccids",2:"failedAccids"}}]},qchatRemoveMembersFromServerRole:{service:"qchatRole",sid:24,cid:74,params:[{type:"Long",name:"serverId"},{type:"Long",name:"roleId"},{type:"String",name:"accids"}],response:[{type:"Property",name:"accids",reflectMapper:{1:"successAccids",2:"failedAccids"}}]},qchatGetMembersFromServerRole:{service:"qchatRole",sid:24,cid:75,params:[{type:"Property",name:"getMembersFromServerRoleTag",reflectMapper:{serverId:1,roleId:2,timetag:3,accid:4,limit:5}}],response:[{type:"PropertyArray",name:"members",reflectMapper:Aa.member}]},qchatGetServerRolesByAccid:{service:"qchatRole",sid:24,cid:76,params:[{type:"Property",name:"getServerRolesByAccidTag",reflectMapper:{serverId:1,accid:2,timetag:3,limit:4}}],response:[{type:"PropertyArray",name:"serverRoles",reflectMapper:Aa.serverRole}]},qchatGetExistingServerRolesByAccids:{service:"qchatRole",sid:24,cid:77,params:[{type:"Long",name:"serverId"},{type:"String",name:"accids"}],response:[{type:"String",name:"serverRoles"}]},qchatGetExistingChannelRolesByServerRoleIds:{service:"qchatRole",sid:24,cid:78,params:[{type:"Long",name:"serverId"},{type:"Long",name:"channelId"},{type:"String",name:"roleIds"}],response:[{type:"PropertyArray",name:"channelRoles",reflectMapper:Aa.channelRole}]},qchatGetExistingAccidsOfMemberRoles:{service:"qchatRole",sid:24,cid:79,params:[{type:"Long",name:"serverId"},{type:"Long",name:"channelId"},{type:"String",name:"accids"}],response:[{type:"PropertyArray",name:"memberRoles",reflectMapper:Aa.memberRole}]},qchatUpdateServerRolePriorities:{service:"qchatRole",sid:24,cid:80,params:[{type:"Long",name:"serverId"},{type:"PropertyArray",name:"serverRoles",reflectMapper:{serverId:1,roleId:2,priority:7}}],response:[{type:"PropertyArray",name:"serverRoles",reflectMapper:Aa.serverRole}]},qchatGetExistingAccidsInServerRole:{service:"qchatRole",sid:24,cid:81,params:[{type:"Long",name:"serverId"},{type:"Long",name:"roleId"},{type:"String",name:"accids"}],response:[{type:"PropertyArray",name:"members",reflectMapper:Aa.member}]},qchatCheckPermission:{service:"qchatRole",sid:24,cid:82,params:[{type:"Property",name:"checkPermissionTag",reflectMapper:gs.checkPermissionTag}],response:[{type:"Boolean",name:"checked"}]},qchatAddChannelCategoryRole:{service:"qchatRole",sid:24,cid:83,params:[{type:"Property",name:"qchatAddChannelCategoryRoleTag",reflectMapper:gs.channelCategoryRole}],response:[{type:"Property",name:"channelCategoryRole",reflectMapper:Aa.channelCategoryRole}]},qchatRemoveChannelCategoryRole:{service:"qchatRole",sid:24,cid:84,params:[{type:"Long",name:"serverId"},{type:"Long",name:"categoryId"},{type:"Long",name:"roleId"}]},qchatUpdateChannelCategoryRole:{service:"qchatRole",sid:24,cid:85,params:[{type:"Property",name:"qchatUpdateChannelCategoryRoleTag",reflectMapper:gs.channelCategoryRole}],response:[{type:"Property",name:"channelCategoryRole",reflectMapper:Aa.channelCategoryRole}]},qchatGetChannelCategoryRole:{service:"qchatRole",sid:24,cid:86,params:[{type:"Property",name:"qchatGetChannelCategoryRoleTag",reflectMapper:gs.qchatGetChannelCategoryRoleTag}],response:[{type:"PropertyArray",name:"list",reflectMapper:Aa.channelCategoryRole}]},qchatAddChannelCategoryMemberRole:{service:"qchatRole",sid:24,cid:87,params:[{type:"Property",name:"qchatAddChannelCategoryMemberRoleTag",reflectMapper:gs.channelCategoryMemberRole}],response:[{type:"Property",name:"channelCategoryMemberRole",reflectMapper:Aa.channelCategoryMemberRole}]},qchatRemoveChannelCategoryMemberRole:{service:"qchatRole",sid:24,cid:88,params:[{type:"Long",name:"serverId"},{type:"Long",name:"categoryId"},{type:"String",name:"accid"}]},qchatUpdateChannelCategoryMemberRole:{service:"qchatRole",sid:24,cid:89,params:[{type:"Property",name:"qchatUpdateChannelCategoryMemberRoleTag",reflectMapper:gs.channelCategoryMemberRole}],response:[{type:"Property",name:"channelCategoryMemberRole",reflectMapper:Aa.channelCategoryMemberRole}]},qchatGetChannelCategoryMemberRole:{service:"qchatRole",sid:24,cid:90,params:[{type:"Property",name:"qchatGetChannelCategoryMemberRoleTag",reflectMapper:gs.qchatGetChannelCategoryMemberRoleTag}],response:[{type:"PropertyArray",name:"list",reflectMapper:Aa.channelCategoryMemberRole}]},qchatCheckPermissions:{service:"qchatRole",sid:24,cid:126,params:[{type:"Property",name:"checkPermissionsTag",reflectMapper:gs.checkPermissionsTag}],response:[{type:"PropertyArray",name:"checkPermissionsResult",reflectMapper:{1:"auth",2:"isAllow"}}]}},MC=function(){function pe(kt){this.core=kt}var Ne=pe.prototype;return Ne.addChannelCategoryRole=function($e){return zr(this,void 0,void 0,_r.mark(function Oe(){var Lt;return _r.wrap(function(Pt){for(;;)switch(Pt.prev=Pt.next){case 0:return On({serverId:{type:"string",allowEmpty:!1},categoryId:{type:"string",allowEmpty:!1},parentRoleId:{type:"string",allowEmpty:!1}},$e),Pt.next=3,this.core.sendCmd("qchatAddChannelCategoryRole",{qchatAddChannelCategoryRoleTag:$e});case 3:return Lt=Pt.sent,Pt.abrupt("return",kf(Lt.content.channelCategoryRole));case 5:case"end":return Pt.stop()}},Oe,this)}))},Ne.removeChannelCategoryRole=function($e){return zr(this,void 0,void 0,_r.mark(function Oe(){return _r.wrap(function(rr){for(;;)switch(rr.prev=rr.next){case 0:return On({serverId:{type:"string",allowEmpty:!1},categoryId:{type:"string",allowEmpty:!1},roleId:{type:"string",allowEmpty:!1}},$e),rr.next=3,this.core.sendCmd("qchatRemoveChannelCategoryRole",$e);case 3:case"end":return rr.stop()}},Oe,this)}))},Ne.updateChannelCategoryRole=function($e){return zr(this,void 0,void 0,_r.mark(function Oe(){var Lt;return _r.wrap(function(Pt){for(;;)switch(Pt.prev=Pt.next){case 0:return On({serverId:{type:"string",allowEmpty:!1},categoryId:{type:"string",allowEmpty:!1},roleId:{type:"string",allowEmpty:!1},auths:{type:"object"}},$e),Pt.next=3,this.core.sendCmd("qchatUpdateChannelCategoryRole",{qchatUpdateChannelCategoryRoleTag:ol($e)});case 3:if((Lt=Pt.sent).raw.code!==406){Pt.next=6;break}throw new Bo("No update required",{},406);case 6:return Pt.abrupt("return",kf(Lt.content.channelCategoryRole));case 7:case"end":return Pt.stop()}},Oe,this)}))},Ne.getChannelCategoryRole=function($e){return zr(this,void 0,void 0,_r.mark(function Oe(){var Lt;return _r.wrap(function(Pt){for(;;)switch(Pt.prev=Pt.next){case 0:return On({serverId:{type:"string",allowEmpty:!1},categoryId:{type:"string",allowEmpty:!1},timetag:{type:"number",min:0,required:!1},limit:{type:"number",min:1,required:!1}},$e),Pt.next=3,this.core.sendCmd("qchatGetChannelCategoryRole",{qchatGetChannelCategoryRoleTag:$e});case 3:return Lt=Pt.sent,Pt.abrupt("return",(pr=Lt.content.list,Es(pr)&&pr.length>0?Ro(pr).call(pr,function(yr){return kf(yr)}):[]));case 5:case"end":return Pt.stop()}var pr},Oe,this)}))},Ne.addChannelCategoryMemberRole=function($e){return zr(this,void 0,void 0,_r.mark(function Oe(){var Lt;return _r.wrap(function(Pt){for(;;)switch(Pt.prev=Pt.next){case 0:return On({serverId:{type:"string",allowEmpty:!1},categoryId:{type:"string",allowEmpty:!1},accid:{type:"string",allowEmpty:!1}},$e),Pt.next=3,this.core.sendCmd("qchatAddChannelCategoryMemberRole",{qchatAddChannelCategoryMemberRoleTag:$e});case 3:return Lt=Pt.sent,Pt.abrupt("return",ku(Lt.content.channelCategoryMemberRole));case 5:case"end":return Pt.stop()}},Oe,this)}))},Ne.removeChannelCategoryMemberRole=function($e){return zr(this,void 0,void 0,_r.mark(function Oe(){return _r.wrap(function(rr){for(;;)switch(rr.prev=rr.next){case 0:return On({serverId:{type:"string",allowEmpty:!1},categoryId:{type:"string",allowEmpty:!1},accid:{type:"string",allowEmpty:!1}},$e),rr.next=3,this.core.sendCmd("qchatRemoveChannelCategoryMemberRole",$e);case 3:case"end":return rr.stop()}},Oe,this)}))},Ne.updateChannelCategoryMemberRole=function($e){return zr(this,void 0,void 0,_r.mark(function Oe(){var Lt;return _r.wrap(function(Pt){for(;;)switch(Pt.prev=Pt.next){case 0:return On({serverId:{type:"string",allowEmpty:!1},categoryId:{type:"string",allowEmpty:!1},accid:{type:"string",allowEmpty:!1},auths:{type:"object"}},$e),Pt.next=3,this.core.sendCmd("qchatUpdateChannelCategoryMemberRole",{qchatUpdateChannelCategoryMemberRoleTag:ol($e)});case 3:if((Lt=Pt.sent).raw.code!==406){Pt.next=6;break}throw new Bo("No update required",{},406);case 6:return Pt.abrupt("return",ku(Lt.content.channelCategoryMemberRole));case 7:case"end":return Pt.stop()}},Oe,this)}))},Ne.getChannelCategoryMemberRole=function($e){return zr(this,void 0,void 0,_r.mark(function Oe(){var Lt;return _r.wrap(function(Pt){for(;;)switch(Pt.prev=Pt.next){case 0:return On({serverId:{type:"string",allowEmpty:!1},categoryId:{type:"string",allowEmpty:!1},timetag:{type:"number",min:0,required:!1},limit:{type:"number",min:1,required:!1}},$e),Pt.next=3,this.core.sendCmd("qchatGetChannelCategoryMemberRole",{qchatGetChannelCategoryMemberRoleTag:$e});case 3:return Lt=Pt.sent,Pt.abrupt("return",(pr=Lt.content.list,Es(pr)&&pr.length>0?Ro(pr).call(pr,function(yr){return ku(yr)}):[]));case 5:case"end":return Pt.stop()}var pr},Oe,this)}))},pe}(),kC=function(pe){function Ne($e){var Oe;return(Oe=pe.call(this,"qchatRole",$e)||this).core=$e,oc({cmdMap:lb,cmdConfig:CC}),Oe.category=new MC($e),Oe}ea(Ne,pe);var kt=Ne.prototype;return kt.createServerRole=function(Oe){return zr(this,void 0,void 0,_r.mark(function Lt(){var rr;return _r.wrap(function(pr){for(;;)switch(pr.prev=pr.next){case 0:return On({serverId:{type:"string",allowEmpty:!1},name:{type:"string",allowEmpty:!1},priority:{type:"number",min:1},icon:{type:"string",required:!1},ext:{type:"string",required:!1}},Oe),pr.next=3,this.core.sendCmd("qchatCreateServerRole",{serverRole:Vn(Vn({},ol(Oe)),{type:Mu.custom}),antispamTag:nl(Oe)});case 3:return rr=pr.sent,pr.abrupt("return",$s(rr.content.serverRole));case 5:case"end":return pr.stop()}},Lt,this)}))},kt.updateServerRole=function(Oe){return zr(this,void 0,void 0,_r.mark(function Lt(){var rr;return _r.wrap(function(pr){for(;;)switch(pr.prev=pr.next){case 0:return On({serverId:{type:"string",allowEmpty:!1},roleId:{type:"string",allowEmpty:!1},name:{type:"string",required:!1},icon:{type:"string",required:!1},ext:{type:"string",required:!1},priority:{type:"number",required:!1},auths:{type:"object",required:!1}},Oe),pr.next=3,this.core.sendCmd("qchatUpdateServerRole",{updateServerRoleTag:ol(Oe),antispamTag:nl(Oe)});case 3:return rr=pr.sent,pr.abrupt("return",$s(rr.content.serverRole));case 5:case"end":return pr.stop()}},Lt,this)}))},kt.deleteServerRole=function(Oe){return zr(this,void 0,void 0,_r.mark(function Lt(){return _r.wrap(function(Pt){for(;;)switch(Pt.prev=Pt.next){case 0:return On({serverId:{type:"string",allowEmpty:!1},roleId:{type:"string",allowEmpty:!1}},Oe),Pt.next=3,this.core.sendCmd("qchatDeleteServerRole",Oe);case 3:case"end":return Pt.stop()}},Lt,this)}))},kt.getServerRoles=function(Oe){return zr(this,void 0,void 0,_r.mark(function Lt(){var rr,Pt,pr;return _r.wrap(function(Pr){for(;;)switch(Pr.prev=Pr.next){case 0:return On({serverId:{type:"string",allowEmpty:!1},channelId:{type:"string",allowEmpty:!1,required:!1},categoryId:{type:"string",allowEmpty:!1,required:!1},limit:{type:"number",min:1,required:!1},priority:{type:"number",required:!1}},Oe),Pr.next=3,this.core.sendCmd("qchatGetServerRoles",{getServerRolesTag:ol(Oe)});case 3:return Pt=Pr.sent,pr=ki(rr=Pt.content.serverRoles).call(rr,function(Rr){return na(Rr.isMember)===1}),pr=Ro(pr).call(pr,function(Rr){return Rr.roleId}),Pr.abrupt("return",{roles:yi(Pt.content.serverRoles),isMemberRoles:pr});case 7:case"end":return Pr.stop()}},Lt,this)}))},kt.addChannelRole=function(Oe){return zr(this,void 0,void 0,_r.mark(function Lt(){var rr;return _r.wrap(function(pr){for(;;)switch(pr.prev=pr.next){case 0:return On({serverId:{type:"string",allowEmpty:!1},channelId:{type:"string",allowEmpty:!1},parentRoleId:{type:"string",allowEmpty:!1}},Oe),pr.next=3,this.core.sendCmd("qchatAddChannelRole",{channelRole:ol(Oe)});case 3:return rr=pr.sent,pr.abrupt("return",$s(rr.content.channelRole));case 5:case"end":return pr.stop()}},Lt,this)}))},kt.getChannelRoles=function(Oe){return zr(this,void 0,void 0,_r.mark(function Lt(){var rr;return _r.wrap(function(pr){for(;;)switch(pr.prev=pr.next){case 0:return On({serverId:{type:"string",allowEmpty:!1},channelId:{type:"string",allowEmpty:!1},timetag:{type:"number",required:!1},limit:{type:"number",min:1,required:!1}},Oe),pr.next=3,this.core.sendCmd("qchatGetChannelRoles",{getChannelRolesTag:Oe});case 3:return rr=pr.sent,pr.abrupt("return",yi(rr.content.channelRoles));case 5:case"end":return pr.stop()}},Lt,this)}))},kt.removeChannelRole=function(Oe){return zr(this,void 0,void 0,_r.mark(function Lt(){return _r.wrap(function(Pt){for(;;)switch(Pt.prev=Pt.next){case 0:return On({serverId:{type:"string",allowEmpty:!1},channelId:{type:"string",allowEmpty:!1},roleId:{type:"string",allowEmpty:!1}},Oe),Pt.next=3,this.core.sendCmd("qchatRemoveChannelRole",Oe);case 3:case"end":return Pt.stop()}},Lt,this)}))},kt.updateChannelRole=function(Oe){return zr(this,void 0,void 0,_r.mark(function Lt(){var rr;return _r.wrap(function(pr){for(;;)switch(pr.prev=pr.next){case 0:return On({serverId:{type:"string",allowEmpty:!1},channelId:{type:"string",allowEmpty:!1},roleId:{type:"string",allowEmpty:!1},auths:{type:"object",required:!1}},Oe),pr.next=3,this.core.sendCmd("qchatUpdateChannelRole",{updateChannelRoleTag:ol(Oe)});case 3:if((rr=pr.sent).raw.code!==406){pr.next=6;break}throw new Bo("No update required",{},406);case 6:return pr.abrupt("return",$s(rr.content.channelRole));case 7:case"end":return pr.stop()}},Lt,this)}))},kt.addMemberRole=function(Oe){return zr(this,void 0,void 0,_r.mark(function Lt(){var rr;return _r.wrap(function(pr){for(;;)switch(pr.prev=pr.next){case 0:return On({serverId:{type:"string",allowEmpty:!1},channelId:{type:"string",allowEmpty:!1},accid:{type:"string",allowEmpty:!1}},Oe),pr.next=3,this.core.sendCmd("qchatAddMemberRole",{memberRole:Oe});case 3:return rr=pr.sent,pr.abrupt("return",$s(rr.content.memberRole));case 5:case"end":return pr.stop()}},Lt,this)}))},kt.getMemberRoles=function(Oe){return zr(this,void 0,void 0,_r.mark(function Lt(){var rr;return _r.wrap(function(pr){for(;;)switch(pr.prev=pr.next){case 0:return On({serverId:{type:"string",allowEmpty:!1},channelId:{type:"string",allowEmpty:!1},timetag:{type:"number",required:!1},limit:{type:"number",min:1,required:!1}},Oe),pr.next=3,this.core.sendCmd("qchatGetMemberRoles",{getMemberRolesTag:Oe});case 3:return rr=pr.sent,pr.abrupt("return",yi(rr.content.memberRoles));case 5:case"end":return pr.stop()}},Lt,this)}))},kt.removeMemberRole=function(Oe){return zr(this,void 0,void 0,_r.mark(function Lt(){return _r.wrap(function(Pt){for(;;)switch(Pt.prev=Pt.next){case 0:return On({serverId:{type:"string",allowEmpty:!1},channelId:{type:"string",allowEmpty:!1},accid:{type:"string",allowEmpty:!1}},Oe),Pt.next=3,this.core.sendCmd("qchatRemoveMemberRole",{memberRole:Oe});case 3:case"end":return Pt.stop()}},Lt,this)}))},kt.updateMemberRole=function(Oe){return zr(this,void 0,void 0,_r.mark(function Lt(){var rr;return _r.wrap(function(pr){for(;;)switch(pr.prev=pr.next){case 0:return On({serverId:{type:"string",allowEmpty:!1},channelId:{type:"string",allowEmpty:!1},accid:{type:"string",allowEmpty:!1},auths:{type:"object",required:!1}},Oe),pr.next=3,this.core.sendCmd("qchatUpdateMemberRole",{updateMemberRoleTag:ol(Oe)});case 3:if((rr=pr.sent).raw.code!==406){pr.next=6;break}throw new Bo("No update required",{},406);case 6:return pr.abrupt("return",$s(rr.content.memberRole));case 7:case"end":return pr.stop()}},Lt,this)}))},kt.addMembersToServerRole=function(Oe){return zr(this,void 0,void 0,_r.mark(function Lt(){var rr,Pt,pr;return _r.wrap(function(Pr){for(;;)switch(Pr.prev=Pr.next){case 0:return On({serverId:{type:"string",allowEmpty:!1},roleId:{type:"string",allowEmpty:!1},accids:{type:"array",itemType:"string",min:1}},Oe),Pr.next=3,this.core.sendCmd("qchatAddMembersToServerRole",Vn(Vn({},Oe),{accids:Ao(Oe.accids)}));case 3:return rr=Pr.sent,Pt=ys(rr,"content.accids.successAccids"),pr=ys(rr,"content.accids.failedAccids"),Pr.abrupt("return",{successAccids:Pt?JSON.parse(Pt):[],failedAccids:pr?JSON.parse(pr):[]});case 7:case"end":return Pr.stop()}},Lt,this)}))},kt.removeMembersFromServerRole=function(Oe){return zr(this,void 0,void 0,_r.mark(function Lt(){var rr,Pt,pr;return _r.wrap(function(Pr){for(;;)switch(Pr.prev=Pr.next){case 0:return On({serverId:{type:"string",allowEmpty:!1},roleId:{type:"string",allowEmpty:!1},accids:{type:"array",itemType:"string",min:1}},Oe),Pr.next=3,this.core.sendCmd("qchatRemoveMembersFromServerRole",Vn(Vn({},Oe),{accids:Ao(Oe.accids)}));case 3:return rr=Pr.sent,Pt=ys(rr,"content.accids.successAccids"),pr=ys(rr,"content.accids.failedAccids"),Pr.abrupt("return",{successAccids:Pt?JSON.parse(Pt):[],failedAccids:pr?JSON.parse(pr):[]});case 7:case"end":return Pr.stop()}},Lt,this)}))},kt.getMembersFromServerRole=function(Oe){return zr(this,void 0,void 0,_r.mark(function Lt(){var rr;return _r.wrap(function(pr){for(;;)switch(pr.prev=pr.next){case 0:return On({serverId:{type:"string",allowEmpty:!1},roleId:{type:"string",allowEmpty:!1},timetag:{type:"number",required:!1},accid:{type:"string",allowEmpty:!1,required:!1},limit:{type:"number",min:1,required:!1}},Oe),pr.next=3,this.core.sendCmd("qchatGetMembersFromServerRole",{getMembersFromServerRoleTag:Oe});case 3:return rr=pr.sent,pr.abrupt("return",yi(rr.content.members));case 5:case"end":return pr.stop()}},Lt,this)}))},kt.getServerRolesByAccid=function(Oe){return zr(this,void 0,void 0,_r.mark(function Lt(){var rr;return _r.wrap(function(pr){for(;;)switch(pr.prev=pr.next){case 0:return On({serverId:{type:"string",allowEmpty:!1},accid:{type:"string",allowEmpty:!1},timetag:{type:"number",required:!1},limit:{type:"number",min:1,required:!1}},Oe),pr.next=3,this.core.sendCmd("qchatGetServerRolesByAccid",{getServerRolesByAccidTag:Oe});case 3:return rr=pr.sent,pr.abrupt("return",yi(rr.content.serverRoles));case 5:case"end":return pr.stop()}},Lt,this)}))},kt.getExistingServerRolesByAccids=function(Oe){return zr(this,void 0,void 0,_r.mark(function Lt(){var rr,Pt,pr;return _r.wrap(function(Pr){for(;;)switch(Pr.prev=Pr.next){case 0:return On({serverId:{type:"string",allowEmpty:!1},accids:{type:"array",itemType:"string"}},Oe),Pr.next=3,this.core.sendCmd("qchatGetExistingServerRolesByAccids",{serverId:Oe.serverId,accids:Ao(Oe.accids)});case 3:return rr=Pr.sent,Pr.prev=4,pr=JSON.parse(rr.content.serverRoles),Qn(Pt=ka(pr)).call(Pt,function(Rr){var Vr;Qn(Vr=pr[Rr]).call(Vr,function(Dr,Xr){pr[Rr][Xr]=ns(Dr,Aa.serverRole)}),pr[Rr]=yi(pr[Rr])}),Pr.abrupt("return",pr);case 10:throw Pr.prev=10,Pr.t0=Pr.catch(4),this.logger.error("can not parse serverRolesGroupByAccid from "+Oe.serverId+" and "+Oe.accids,rr.content.serverRoles),Pr.t0;case 14:case"end":return Pr.stop()}},Lt,this,[[4,10]])}))},kt.getExistingChannelRolesByServerRoleIds=function(Oe){return zr(this,void 0,void 0,_r.mark(function Lt(){var rr;return _r.wrap(function(pr){for(;;)switch(pr.prev=pr.next){case 0:return On({serverId:{type:"string",allowEmpty:!1},channelId:{type:"string",allowEmpty:!1},roleIds:{type:"array",itemType:"string"}},Oe),pr.next=3,this.core.sendCmd("qchatGetExistingChannelRolesByServerRoleIds",{serverId:Oe.serverId,channelId:Oe.channelId,roleIds:Ao(Oe.roleIds)});case 3:return rr=pr.sent,pr.abrupt("return",yi(rr.content.channelRoles));case 5:case"end":return pr.stop()}},Lt,this)}))},kt.getExistingAccidsOfMemberRoles=function(Oe){return zr(this,void 0,void 0,_r.mark(function Lt(){var rr,Pt;return _r.wrap(function(yr){for(;;)switch(yr.prev=yr.next){case 0:return On({serverId:{type:"string",allowEmpty:!1},channelId:{type:"string",allowEmpty:!1},accids:{type:"array",itemType:"string"}},Oe),yr.next=3,this.core.sendCmd("qchatGetExistingAccidsOfMemberRoles",{serverId:Oe.serverId,channelId:Oe.channelId,accids:Ao(Oe.accids)});case 3:return rr=yr.sent,Pt=rr.content.memberRoles,yr.abrupt("return",Pt&&Pt.length>0?Ro(Pt).call(Pt,function(Pr){return Pr.accid}):[]);case 6:case"end":return yr.stop()}},Lt,this)}))},kt.getExistingAccidsInServerRole=function(Oe){return zr(this,void 0,void 0,_r.mark(function Lt(){var rr,Pt;return _r.wrap(function(yr){for(;;)switch(yr.prev=yr.next){case 0:return On({serverId:{type:"string",allowEmpty:!1},roleId:{type:"string",allowEmpty:!1},accids:{type:"array",itemType:"string"}},Oe),yr.next=3,this.core.sendCmd("qchatGetExistingAccidsInServerRole",{serverId:Oe.serverId,roleId:Oe.roleId,accids:Ao(Oe.accids)});case 3:return rr=yr.sent,Pt=rr.content.members,yr.abrupt("return",Pt&&Pt.length>0?Ro(Pt).call(Pt,function(Pr){return Pr.accid}):[]);case 6:case"end":return yr.stop()}},Lt,this)}))},kt.updateServerRolePriorities=function(Oe){return zr(this,void 0,void 0,_r.mark(function Lt(){var rr,Pt;return _r.wrap(function(yr){for(;;)switch(yr.prev=yr.next){case 0:return On({serverId:{type:"string",allowEmpty:!1},serverRoles:{type:"array"}},Oe),yr.next=3,this.core.sendCmd("qchatUpdateServerRolePriorities",{serverId:Oe.serverId,serverRoles:Ro(rr=Oe.serverRoles).call(rr,function(Pr){return{serverId:Pr.serverId,roleId:Pr.roleId,priority:Pr.priority}})});case 3:return Pt=yr.sent,yr.abrupt("return",yi(Pt.content.serverRoles));case 5:case"end":return yr.stop()}},Lt,this)}))},kt.checkPermission=function(Oe){return zr(this,void 0,void 0,_r.mark(function Lt(){var rr;return _r.wrap(function(pr){for(;;)switch(pr.prev=pr.next){case 0:return On({serverId:{type:"string",allowEmpty:!1},channelId:{type:"string",allowEmpty:!1,required:!1},auth:{type:"string"}},Oe),pr.next=3,this.core.sendCmd("qchatCheckPermission",{checkPermissionTag:Vn(Vn({},Oe),{auth:Wl[Oe.auth]||Oe.auth})});case 3:return rr=pr.sent,pr.abrupt("return",rr.content.checked);case 5:case"end":return pr.stop()}},Lt,this)}))},kt.addChannelCategoryRole=function(Oe){return zr(this,void 0,void 0,_r.mark(function Lt(){return _r.wrap(function(Pt){for(;;)switch(Pt.prev=Pt.next){case 0:return Pt.next=2,this.category.addChannelCategoryRole(Oe);case 2:return Pt.abrupt("return",Pt.sent);case 3:case"end":return Pt.stop()}},Lt,this)}))},kt.removeChannelCategoryRole=function(Oe){return zr(this,void 0,void 0,_r.mark(function Lt(){return _r.wrap(function(Pt){for(;;)switch(Pt.prev=Pt.next){case 0:return Pt.next=2,this.category.removeChannelCategoryRole(Oe);case 2:return Pt.abrupt("return",Pt.sent);case 3:case"end":return Pt.stop()}},Lt,this)}))},kt.updateChannelCategoryRole=function(Oe){return zr(this,void 0,void 0,_r.mark(function Lt(){return _r.wrap(function(Pt){for(;;)switch(Pt.prev=Pt.next){case 0:return Pt.next=2,this.category.updateChannelCategoryRole(Oe);case 2:return Pt.abrupt("return",Pt.sent);case 3:case"end":return Pt.stop()}},Lt,this)}))},kt.getChannelCategoryRole=function(Oe){return zr(this,void 0,void 0,_r.mark(function Lt(){return _r.wrap(function(Pt){for(;;)switch(Pt.prev=Pt.next){case 0:return Pt.next=2,this.category.getChannelCategoryRole(Oe);case 2:return Pt.abrupt("return",Pt.sent);case 3:case"end":return Pt.stop()}},Lt,this)}))},kt.addChannelCategoryMemberRole=function(Oe){return zr(this,void 0,void 0,_r.mark(function Lt(){return _r.wrap(function(Pt){for(;;)switch(Pt.prev=Pt.next){case 0:return Pt.next=2,this.category.addChannelCategoryMemberRole(Oe);case 2:return Pt.abrupt("return",Pt.sent);case 3:case"end":return Pt.stop()}},Lt,this)}))},kt.removeChannelCategoryMemberRole=function(Oe){return zr(this,void 0,void 0,_r.mark(function Lt(){return _r.wrap(function(Pt){for(;;)switch(Pt.prev=Pt.next){case 0:return Pt.next=2,this.category.removeChannelCategoryMemberRole(Oe);case 2:return Pt.abrupt("return",Pt.sent);case 3:case"end":return Pt.stop()}},Lt,this)}))},kt.updateChannelCategoryMemberRole=function(Oe){return zr(this,void 0,void 0,_r.mark(function Lt(){return _r.wrap(function(Pt){for(;;)switch(Pt.prev=Pt.next){case 0:return Pt.next=2,this.category.updateChannelCategoryMemberRole(Oe);case 2:return Pt.abrupt("return",Pt.sent);case 3:case"end":return Pt.stop()}},Lt,this)}))},kt.getChannelCategoryMemberRole=function(Oe){return zr(this,void 0,void 0,_r.mark(function Lt(){return _r.wrap(function(Pt){for(;;)switch(Pt.prev=Pt.next){case 0:return Pt.next=2,this.category.getChannelCategoryMemberRole(Oe);case 2:return Pt.abrupt("return",Pt.sent);case 3:case"end":return Pt.stop()}},Lt,this)}))},kt.checkPermissions=function(Oe){return zr(this,void 0,void 0,_r.mark(function Lt(){var rr,Pt,pr,yr;return _r.wrap(function(Rr){for(;;)switch(Rr.prev=Rr.next){case 0:return On({serverId:{type:"string",allowEmpty:!1},channelId:{type:"string",allowEmpty:!1,required:!1},auths:{type:"array",itemType:"string"}},Oe),this.core.logger.log("qchatRole::checkPermission options is",Oe),Rr.next=4,this.core.sendCmd("qchatCheckPermissions",{checkPermissionsTag:Vn(Vn({},Oe),{auths:Ao(Ro(rr=Oe.auths).call(rr,function(Vr){return Wl[Vr]||Vr}))})});case 4:return pr=Rr.sent,this.core.logger.log("qchatRole::checkPermission result is",pr.content),yr={},Qn(Pt=pr.content.checkPermissionsResult).call(Pt,function(Vr){yr[Vr.auth]=Vr.isAllow}),this.core.logger.log("qchatRole::checkPermission auths is",yr),Rr.abrupt("return",Qi(yr));case 10:case"end":return Rr.stop()}},Lt,this)}))},Ne}(Vl),xf=function(Ne,kt){return Fy(Ne,kt,function($e,Oe){return Ry(Ne,Oe)})},wC=function(Ne){return Ne!=null&&Ne.length?nb(Ne,1):[]},$c,ai,If=function(Ne){return ry(ey(Ne,void 0,wC),Ne+"")}(function(pe,Ne){return pe==null?{}:xf(pe,Ne)}),sv={"24_10":"qchatSendMsg","24_11":"qchatOnMsg","24_12":"qchatOnRecvUnreadInfo","24_13":"qchatSendCustomSysMsg","24_14":"qchatOnSysMsg","24_16":"qchatGetHistoryMsg","24_17":"qchatMarkMessageRead","24_18":"qchatMultiSyncMessageRead","24_22":"qchatUpdateSystemNotification","24_23":"qchatMultiSyncSystemNotificationUpdate","24_24":"qchatSyncSystemNotification","24_25":"qchatUpdateMessage","24_26":"qchatRecvMessageUpdate","24_28":"qchatMarkSysMsgRead","24_94":"qchatMessageSearchByPage","24_100":"qchatGetMessageHistoryByIds","24_101":"qchatGetThreadMessages","24_102":"qchatUpdateQuickComment","24_103":"qchatGetQuickComments","24_108":"qchatGetThreadRootMessagesMeta","24_121":"qchatGetLastMessageOfChannels","24_127":"qchatGetMentionedMeMessages","25_6":"qchatMultiSyncServersMessageRead"},js={getHistoryMsgTag:{serverId:1,channelId:2,beginTime:3,endTime:4,excludeMsgId:5,limit:6,reverse:7},getThreadHistoryMsgTag:{beginTime:1,endTime:2,excludeMsgId:3,limit:4,reverse:5},qchatMsgTag:{serverId:1,channelId:2,fromAccount:3,fromClientType:4,fromDeviceId:5,fromNick:6,time:7,updateTime:8,type:9,body:10,attach:11,ext:12,msgIdClient:13,msgIdServer:14,resendFlag:15,status:16,pushPayload:17,pushContent:18,mentionAccids:19,mentionAll:20,env:21,callbackExt:22,replyMsgFromAccount:23,replyMsgTime:24,replyMsgIdServer:25,replyMsgIdClient:26,threadMsgFromAccount:27,threadMsgTime:28,threadMsgIdServer:29,threadMsgIdClient:30,useCustomContent:31,antiSpamContent:32,antiSpamBusinessId:33,antiSpamUsingYidun:34,yidunCallback:35,yidunAntiCheating:36,yidunAntiSpamExt:37,yidunAntiSpamRes:38,mentionRoleIds:41,accidsOfMentionedRoles:42,updateContent:39,updateOperatorInfo:40,subType:61,historyEnable:100,pushEnable:101,needBadge:102,needPushNick:103,notifyReason:104,routeEnable:105,isAntispam:106},sysMsg:{toType:1,serverId:2,channelId:3,toAccids:4,fromAccount:5,fromClientType:6,fromDeviceId:7,fromNick:8,time:9,updateTime:10,type:11,msgIdClient:12,msgIdServer:13,body:14,attach:15,ext:16,resendFlag:17,status:18,pushPayload:19,pushContent:20,env:21,callbackExt:22,persistEnable:100,pushEnable:101,needBadge:102,needPushNick:103,routeEnable:104},qchatMsgUpdateTag:{operatorAccount:1,operatorClientType:2,ps:3,ext:4,pushContent:5,pushPayload:6,env:7,routeEnable:100},markMsgReadTag:{serverId:1,channelId:2,time:3},qchatQuickCommentRequestTag:{serverId:1,channelId:2,fromAccount:3,msgIdServer:4,time:5,type:6,opeType:7,opeAccid:8},qchatQuickCommentQueryTag:{serverId:1,channelId:2,msgIdServerList:3},qchatGetLastMessageOfChannelsTag:{serverId:1,channelIdList:2},qchatMultiSyncServersMessageReadTag:{successServerIds:1,failServerIds:2,ackTimestamp:3},qchatMessageSearchByPageTag:{keyword:1,serverId:2,channelId:3,fromAccid:4,fromTime:5,toTime:6,msgTypes:7,subTypes:8,includeSelf:9,order:10,limit:11,sort:12,cursor:13},qchatPageQueryTag:{hasMore:1,nextTimetag:2,cursor:3},unreadInfo:Gh},Fa=Qc(js),_C={qchatSendMsg:{service:"qchatMsg",sid:24,cid:10,params:[{type:"Property",name:"qchatMsg",reflectMapper:js.qchatMsgTag}],response:[{type:"Property",name:"qchatMsg",reflectMapper:Fa.qchatMsgTag}]},qchatOnMsg:{service:"qchatMsg",sid:24,cid:11,response:[{type:"Property",name:"qchatMsg",reflectMapper:Fa.qchatMsgTag}]},qchatOnRecvUnreadInfo:{service:"qchatMsg",sid:24,cid:12,response:[{type:"Property",name:"qchatMsg",reflectMapper:Fa.qchatMsgTag}]},qchatSendCustomSysMsg:{service:"qchatMsg",sid:24,cid:13,params:[{type:"Property",name:"sysMsg",reflectMapper:js.sysMsg}],response:[{type:"Property",name:"sysMsg",reflectMapper:Fa.sysMsg}]},qchatOnSysMsg:{service:"qchatMsg",sid:24,cid:14,response:[{type:"Property",name:"sysMsg",reflectMapper:Fa.sysMsg}]},qchatGetHistoryMsg:{service:"qchatMsg",sid:24,cid:16,params:[{type:"Property",name:"getHistoryMsgTag",reflectMapper:js.getHistoryMsgTag}],response:[{type:"PropertyArray",name:"qchatMsgs",reflectMapper:Fa.qchatMsgTag}]},qchatUpdateMessage:{service:"qchatMsg",sid:24,cid:25,params:[{type:"Property",name:"qchatMsgUpdateTag",reflectMapper:js.qchatMsgUpdateTag},{type:"Property",name:"qchatMsg",reflectMapper:js.qchatMsgTag}],response:[{type:"Property",name:"qchatMsg",reflectMapper:Fa.qchatMsgTag}]},qchatRecvMessageUpdate:{service:"qchatMsg",sid:24,cid:26,response:[{type:"Property",name:"qchatMsgUpdateInfo",reflectMapper:Fa.qchatMsgUpdateTag},{type:"Property",name:"qchatMsg",reflectMapper:Fa.qchatMsgTag}]},qchatMarkMessageRead:{sid:24,cid:17,service:"qchatMsg",params:[{type:"Property",name:"markMsgReadTag",reflectMapper:js.markMsgReadTag}],response:[{type:"Property",name:"unreadInfo",reflectMapper:Fa.unreadInfo}]},qchatMultiSyncMessageRead:{sid:24,cid:18,service:"qchatMsg",response:[{type:"Property",name:"unreadInfo",reflectMapper:Fa.unreadInfo}]},qchatUpdateSystemNotification:{service:"qchatMsg",sid:24,cid:22,params:[{type:"Property",name:"qchatMsgUpdateTag",reflectMapper:js.qchatMsgUpdateTag},{type:"Property",name:"sysMsg",reflectMapper:js.sysMsg}],response:[{type:"Property",name:"sysMsg",reflectMapper:Fa.sysMsg}]},qchatMultiSyncSystemNotificationUpdate:{service:"qchatMsg",sid:24,cid:23,response:[{type:"Property",name:"qchatMsgUpdateTag",reflectMapper:Fa.qchatMsgUpdateTag},{type:"Property",name:"sysMsg",reflectMapper:Fa.sysMsg}]},qchatSyncSystemNotification:{service:"qchatMsg",sid:24,cid:24,response:[{type:"PropertyArray",name:"systemNotifications",reflectMapper:Fa.sysMsg}]},qchatMarkSysMsgRead:{service:"qchatMsg",sid:24,cid:28,params:[{type:"PropertyArray",name:"sysMsgs",reflectMapper:js.sysMsg}]},qchatMessageSearchByPage:{service:"qchatMsg",sid:24,cid:94,params:[{type:"Property",name:"qchatMessageSearchByPageTag",reflectMapper:js.qchatMessageSearchByPageTag}],response:[{type:"Property",name:"listQueryTag",reflectMapper:Fa.qchatPageQueryTag},{type:"PropertyArray",name:"datas",reflectMapper:Fa.qchatMsgTag}]},qchatGetMessageHistoryByIds:{service:"qchatMsg",sid:24,cid:100,params:[{type:"Property",name:"channelInfo",reflectMapper:{serverId:1,channelId:2}},{type:"PropertyArray",name:"messageReferList",reflectMapper:{msgIdServer:1,time:2}}],response:[{type:"PropertyArray",name:"qchatMsgs",reflectMapper:Fa.qchatMsgTag}]},qchatGetThreadMessages:{service:"qchatMsg",sid:24,cid:101,params:[{type:"Property",name:"qchatMsg",reflectMapper:js.qchatMsgTag},{type:"Property",name:"getThreadHistoryMsgTag",reflectMapper:js.getThreadHistoryMsgTag}],response:[{type:"Property",name:"thread",reflectMapper:Fa.qchatMsgTag},{type:"Property",name:"threadInfo",reflectMapper:{1:"messageCount",2:"lastMessageTimestamp"}},{type:"PropertyArray",name:"qchatMsgs",reflectMapper:Fa.qchatMsgTag}]},qchatUpdateQuickComment:{service:"qchatMsg",sid:24,cid:102,params:[{type:"Property",name:"tag",reflectMapper:js.qchatQuickCommentRequestTag}]},qchatGetQuickComments:{service:"qchatMsg",sid:24,cid:103,params:[{type:"Property",name:"tag",reflectMapper:js.qchatQuickCommentQueryTag}],response:[{type:"PropertyArray",name:"quickCommentResponse",reflectMapper:{1:"serverId",2:"channelId",3:"msgIdServer",4:"totalCount",5:"lastUpdateTime",6:"details"}}]},qchatGetThreadRootMessagesMeta:{service:"qchatMsg",sid:24,cid:108,params:[{type:"Property",name:"tag",reflectMapper:{serverId:1,channelId:2}},{type:"PropertyArray",name:"qchatMsgs",reflectMapper:{time:7,msgIdServer:14}}],response:[{type:"PropertyArray",name:"metas",reflectMapper:{1:"total",2:"timestamp",3:"msgIdServer",4:"msgTime"}}]},qchatGetLastMessageOfChannels:{service:"qchatMsg",sid:24,cid:121,params:[{type:"Property",name:"tag",reflectMapper:js.qchatGetLastMessageOfChannelsTag}],response:[{type:"PropertyArray",name:"msgs",reflectMapper:Fa.qchatMsgTag}]},qchatMultiSyncServersMessageRead:{service:"qchatMsg",sid:25,cid:6,response:[{type:"Property",name:"qchatMultiSyncServersMessageReadTag",reflectMapper:Fa.qchatMultiSyncServersMessageReadTag}]},qchatGetMentionedMeMessages:{service:"qchatMsg",sid:24,cid:127,params:[{type:"Property",name:"tag",reflectMapper:{serverId:1,channelId:2,timestamp:3,limit:4}}],response:[{type:"Property",name:"page",reflectMapper:Fa.qchatPageQueryTag},{type:"PropertyArray",name:"datas",reflectMapper:Fa.qchatMsgTag}]}};(function(pe){pe[pe.Android=1]="Android",pe[pe.iOS=2]="iOS",pe[pe.PC=4]="PC",pe[pe.WindowsPhone=8]="WindowsPhone",pe[pe.Web=16]="Web",pe[pe.Server=32]="Server",pe[pe.Mac=64]="Mac"})($c||($c={}));var ub=["image","audio","video","file"],Ef={time:{type:"number"},updateTime:{type:"number"},resendFlag:{type:"boolean"},persistEnable:{type:"boolean"},routeEnable:{type:"boolean"},pushEnable:{type:"boolean"},needBadge:{type:"boolean"},needPushNick:{type:"boolean"},type:{type:"enum",values:ba},fromClientType:{type:"enum",values:$c},status:{type:"number"},toAccids:{type:"object"},toType:{type:"number"},attach:{type:"object"},pushPayload:{type:"object"}};function iv(pe,Ne){var kt=Vn({},pe),$e=Vn({type:Ne||ba.custom},Tu(Ef,kt));return $e.serverId&&$e.channelId&&$e.toAccids?$e.toType=al.channelAccids:$e.serverId&&$e.toAccids?$e.toType=al.serverAccids:$e.serverId&&$e.channelId?$e.toType=al.channel:$e.serverId?$e.toType=al.server:$e.toAccids?$e.toType=al.accids:$e.toType=al.unknown,$e}function db(pe){var Ne=If(pe,["msgIdServer","type"]);return Tu(Ef,Ne)}var pb=((ai={})[ba.channelUpdateWhiteBlackIdentify]=function(pe){return pe.notify=op(ns(pe.notify,da.qchatUpdateWhiteBlackRoleTag)),pe},ai[ba.channelUpdateWhiteBlackIdentifyUser]=function(pe){return pe.notify=function(kt){return qa(tb,kt)}(ns(pe.notify,da.qchatUpdateWhiteBlackMembersTag)),pe},ai[ba.updateQuickComment]=function(pe){return pe.notify=function(kt){return qa(EC,kt)}(ns(pe.notify,Fa.qchatQuickCommentRequestTag)),pe},ai[ba.channelCategoryCreate]=function(pe){return pe.categoryInfo=cp(ns(pe.categoryInfo,da.QChatChannelCategoryInfo)),pe},ai[ba.channelCategoryUpdate]=function(pe){return pe.categoryInfo=cp(ns(pe.categoryInfo,da.QChatChannelCategoryInfo)),pe},ai[ba.channelCategoryUpdateWhiteBlackIdentify]=function(pe){return pe.notify=op(ns(pe.notify,da.qchatUpdateChannelCategoryWhiteBlackRoleTag)),pe},ai[ba.channelCategoryUpdateWhiteBlackIdentifyUser]=function(pe){return pe.notify=op(ns(pe.notify,da.qchatUpdateChannelCategoryWhiteBlackMembersTag)),pe},ai[ba.serverIdentifyAdd]=function(pe){return pe.serverIdentifyInfo=$s(ns(pe.serverIdentifyInfo,Aa.serverRole)),pe},ai[ba.serverIdentifyRemove]=function(pe){return pe.serverIdentifyInfo=$s(ns(pe.serverIdentifyInfo,Aa.serverRole)),pe},ai[ba.serverIdentifyUpdate]=function(pe){return pe.serverIdentifyInfo=$s(ns(pe.serverIdentifyInfo,Aa.serverRole)),pe},ai[ba.channelIdentifyUpdate]=function(pe){return pe.channelIdentifyInfo=$s(ns(pe.channelIdentifyInfo,Aa.channelRole)),pe},ai[ba.userIdentifyUpdate]=function(pe){return pe.userIdentifyInfo=$s(ns(pe.userIdentifyInfo,Aa.memberRole)),pe},ai[ba.myMemberInfoUpdated]=function(pe){var Ne,kt=ys(pe,"userInfo.name"),$e=ys(pe,"userInfo.icon");return pe.updatedInfos=Ro(Ne=pe.reuseServers).call(Ne,function(Oe){var Lt={serverId:Oe.serverId};return(1&Oe.bits)==1&&typeof kt=="string"&&Vn(Lt,{nickChanged:!0,nick:kt}),(2&Oe.bits)==2&&typeof $e=="string"&&Vn(Lt,{avatarChanged:!0,avatar:$e}),Lt}),delete pe.userInfo,delete pe.reuseServers,pe},ai);function mp(pe,Ne){var kt=qa(Ef,pe);if(!kt.attach)return kt;if(kt.attach.serverInfo&&(kt.attach.serverInfo=tp(ns(kt.attach.serverInfo,is.serverInfo))),kt.attach.channelInfo&&(kt.attach.channelInfo=ap(ns(kt.attach.channelInfo,da.channelInfo))),kt.attach.serverMember&&(kt.attach.serverMember=Cu(ns(kt.attach.serverMember,is.memberInfo))),pb[kt.attach.type]&&(kt.attach=pb[kt.attach.type](kt.attach)),kt.attach.updateAuths)try{kt.attach.updateAuths=Qi(JSON.parse(kt.attach.updateAuths))}catch($e){Ne.error("formatSystemNotification:JSON parse updateAuths error: ",$e)}return kt.attach.type&&(kt.attach.rawType=kt.attach.type,kt.attach.type=ba[kt.attach.type]),kt}var Pf={type:{type:"enum",values:dp},fromClientType:{type:"enum",values:$c},status:{type:"number"},resendFlag:{type:"boolean"},mentionAll:{type:"boolean"},notifyReason:{type:"enum",values:pp},pushEnable:{type:"boolean"},historyEnable:{type:"boolean"},needBadge:{type:"boolean"},needPushNick:{type:"boolean"},routeEnable:{type:"boolean"},time:{type:"number"},updateTime:{type:"number"},mentionAccids:{type:"object"},mentionRoleIds:{type:"object"},accidsOfMentionedRoles:{type:"object"},attach:{type:"object"},pushPayload:{type:"object"},isAntispam:{type:"boolean"},antiSpamInfo:{useCustomContent:{type:"boolean"},antiSpamContent:{type:"string"},antiSpamBusinessId:{type:"string"},antiSpamUsingYidun:{type:"boolean"},yidunCallback:{type:"string"},yidunAntiCheating:{type:"object"},yidunAntiSpamExt:{type:"object"},yidunAntiSpamRes:{type:"string"}},replyRefer:{fromAccount:{type:"string",rawKey:"replyMsgFromAccount"},time:{type:"number",rawKey:"replyMsgTime"},msgIdServer:{type:"string",rawKey:"replyMsgIdServer"},msgIdClient:{type:"string",rawKey:"replyMsgIdClient"}},threadRefer:{fromAccount:{type:"string",rawKey:"threadMsgFromAccount"},time:{type:"number",rawKey:"threadMsgTime"},msgIdServer:{type:"string",rawKey:"threadMsgIdServer"},msgIdClient:{type:"string",rawKey:"threadMsgIdClient"}}};function cv(pe){pe.onSendBefore,pe.onUploadStart,pe.onUploadDone,pe.onUploadProgress;var Ne=eu(pe,["onSendBefore","onUploadStart","onUploadDone","onUploadProgress"]),kt=Tu(Pf,Ne);if(kt.msgIdClient=pe.resendFlag?pe.msgIdClient:fh(),!kt.msgIdClient)throw new ru("msgIdClient is required for resend a message","msgIdClient","required");return pe.replyMessage&&pe.replyMessage.msgIdServer&&(kt.replyMsgFromAccount=pe.replyMessage.fromAccount,kt.replyMsgTime=+pe.replyMessage.time,kt.replyMsgIdServer=pe.replyMessage.msgIdServer,kt.replyMsgIdClient=pe.replyMessage.msgIdClient,pe.replyMessage.threadRefer&&pe.replyMessage.threadRefer.msgIdServer?(kt.threadMsgFromAccount=pe.replyMessage.threadRefer.fromAccount,kt.threadMsgTime=+pe.replyMessage.threadRefer.time,kt.threadMsgIdServer=pe.replyMessage.threadRefer.msgIdServer,kt.threadMsgIdClient=pe.replyMessage.threadRefer.msgIdClient):(kt.threadMsgFromAccount=pe.replyMessage.fromAccount,kt.threadMsgTime=+pe.replyMessage.time,kt.threadMsgIdServer=pe.replyMessage.msgIdServer,kt.threadMsgIdClient=pe.replyMessage.msgIdClient),delete kt.replyMessage),kt}function fb(pe){return qa({operatorClientType:{type:"enum",values:$c},pushPayload:{type:"object"}},pe)}function Xs(pe,Ne,kt){var $e,Oe;return Ne===void 0&&(Ne={}),zr(this,void 0,void 0,_r.mark(function Lt(){var rr,Pt,pr;return _r.wrap(function(Pr){for(;;)switch(Pr.prev=Pr.next){case 0:return(rr=qa(Pf,pe)).deliveryStatus=Ne.deliveryStatus?Ji[Ne.deliveryStatus]:Ji[Ji.success],Ne.time&&(rr.time=Ne.time),rr.updateContent&&(Pt=qa({status:{type:"number"}},Pt=ns(Pt=JSON.parse(rr.updateContent),Fa.qchatMsgTag)),rr.updateContent=Pt),rr.updateOperatorInfo&&(pr=fb(ns(pr=JSON.parse(rr.updateOperatorInfo),Fa.qchatMsgUpdateTag)),rr.updateOperatorInfo=pr),(($e=rr==null?void 0:rr.threadRefer)===null||$e===void 0?void 0:$e.fromAccount)===""&&delete rr.threadRefer,((Oe=rr==null?void 0:rr.replyRefer)===null||Oe===void 0?void 0:Oe.fromAccount)===""&&delete rr.replyRefer,rr.attach&&Ne.attachUrl&&(rr.attach.url=Ne.attachUrl),Pr.next=10,mb(rr,kt);case 10:return Pr.abrupt("return",Pr.sent);case 11:case"end":return Pr.stop()}},Lt)}))}function mb(pe,Ne){return zr(this,void 0,void 0,_r.mark(function kt(){var $e;return _r.wrap(function(Lt){for(;;)switch(Lt.prev=Lt.next){case 0:if(qi(ub).call(ub,pe.type)&&pe.attach&&pe.attach.url){Lt.next=2;break}return Lt.abrupt("return",pe);case 2:if(Ne&&Ne.cloudStorage&&typeof Ne.cloudStorage.getPrivateUrl=="function"&&typeof Ne.cloudStorage.getOriginUrl=="function"){Lt.next=4;break}return Lt.abrupt("return",pe);case 4:if(!(Ba($e=pe.attach.url).call($e,"_im_url=1")<0)){Lt.next=7;break}return pe.attach.url=Ne.cloudStorage.getPrivateUrl(pe.attach.url),Lt.abrupt("return",pe);case 7:return Lt.prev=7,Lt.next=10,Ne.cloudStorage.getOriginUrl(pe.attach.url);case 10:pe.attach.url=Lt.sent,Lt.next=16;break;case 13:throw Lt.prev=13,Lt.t0=Lt.catch(7),new ru('url "'+pe.attach.url+'" parse error',"message.attach.url","parse error");case 16:return Lt.abrupt("return",pe);case 17:case"end":return Lt.stop()}},kt,null,[[7,13]])}))}function lv(pe,Ne,kt){return Ne===void 0&&(Ne={}),zr(this,void 0,void 0,_r.mark(function $e(){var Oe;return _r.wrap(function(rr){for(;;)switch(rr.prev=rr.next){case 0:if(Es(pe)&&pe.length>0){rr.next=2;break}return rr.abrupt("return",[]);case 2:return Oe=Ro(pe).call(pe,function(Pt){return Xs(Pt,Ne,kt)}),rr.next=5,xo.all(Oe);case 5:return rr.abrupt("return",rr.sent);case 6:case"end":return rr.stop()}},$e)}))}var xC={totalCount:{type:"number"},lastUpdateTime:{type:"number"},details:{type:"object"}};function IC(pe){var Ne=Ro(pe).call(pe,function($e){var Oe,Lt=qa(xC,$e);return Lt.details=Ro(Oe=Lt.details).call(Oe,function(rr){return{count:rr.count,hasSelf:rr.self,severalAccids:rr.topN,type:rr.type}}),Lt}),kt={};return Qn(Ne).call(Ne,function($e){return kt[$e.msgIdServer]=$e}),kt}var EC={type:{type:"number"},time:{type:"number"},opeType:{type:"number"}},gb={includeSelf:{type:"number"},order:{type:"enum",values:tl},sort:{type:"enum",values:wf},msgTypes:{type:"object"},subTypes:{type:"object"}},PC={hasMore:{type:"boolean"},nextTimetag:{type:"number"},cursor:{type:"string"}},AC={6:function(Ne){return this.core.qchatChannel.subscribeForVisitorService.deleteAutoSetInServerId(Ne.serverId),!0},16:function(Ne){return this.core.qchatChannel.subscribeForVisitorService.deleteAutoSetInChannel(Ne.serverId,Ne.channelId),!0},26:function(Ne){var kt=ys(Ne,"attach.addAccids");return kt&&qi(kt).call(kt,this.core.account)&&this.core.eventBus.emit("qchatChannel/serverIdentifyChange",Ne),!0},27:function(Ne){var kt=ys(Ne,"attach.deleteAccids");return kt&&qi(kt).call(kt,this.core.account)&&this.core.eventBus.emit("qchatChannel/serverIdentifyChange",Ne),!0},31:function(Ne){return Ne.attach.event===2&&(this.core.eventBus.emit("qchatChannel/autoUnSubscribe",Ne),this.core.eventBus.emit("qchatMedia/serverOrChannelLeave",Ne)),!0},32:function(Ne){return Ne.attach.event===2?(this.core.eventBus.emit("qchatChannel/autoUnSubscribe",Ne),this.core.eventBus.emit("qchatMedia/serverOrChannelLeave",Ne)):Ne.attach.event===1&&this.core.qchatChannel.subscribeForVisitorService.deleteServer(Ne.serverId),!0},34:function(Ne){return Ne.attach.event===2&&this.core.qchatChannel.subscribeForVisitorService.unSubscribeChannel(Ne.serverId,Ne.channelId),!0},101:function(Ne){var kt=If(Ne,["serverId","channelId","ext","fromAccount","fromNick","time"]);return this.logger.log("qchat on recvTypingEvent: ",kt),this.core.emit("recvTypingEvent",kt),!1}},NC=function(){function pe(kt){this.core=kt,this.logger=kt.logger}var Ne=pe.prototype;return Ne.sendSystemNotification=function($e){return zr(this,void 0,void 0,_r.mark(function Oe(){var Lt,rr;return _r.wrap(function(pr){for(;;)switch(pr.prev=pr.next){case 0:return pr.next=2,this.core.sendCmd("qchatSendCustomSysMsg",{sysMsg:iv($e)});case 2:return Lt=pr.sent,rr=mp(Lt.content.sysMsg,this.logger),this.core.options.debugLevel==="debug"?this.logger.debug("sendCustomSysMsg success",rr):this.logger.log("sendCustomSysMsg success",rr.serverId,rr.channelId,rr.msgIdServer),pr.abrupt("return",rr);case 6:case"end":return pr.stop()}},Oe,this)}))},Ne.updateSystemNotification=function($e){return zr(this,void 0,void 0,_r.mark(function Oe(){var Lt,rr,Pt,pr,yr;return _r.wrap(function(Rr){for(;;)switch(Rr.prev=Rr.next){case 0:return Lt=$e.systemNotification,rr=eu($e,["systemNotification"]),Pt=If(Lt,["msgIdServer","type","body","ext","status"]),pr=iv(Pt),Rr.next=5,this.core.sendCmd("qchatUpdateSystemNotification",{sysMsg:pr,qchatMsgUpdateTag:Vn(Vn({},rr),{operatorAccount:this.core.account,operatorClientType:$c.Web,pushPayload:Ao($e.pushPayload),routeEnable:Qh.boolean($e,"routeEnable")})});case 5:return yr=Rr.sent,Rr.abrupt("return",mp(yr.content.sysMsg,this.logger));case 7:case"end":return Rr.stop()}},Oe,this)}))},Ne.markSystemNotificationsRead=function($e){return zr(this,void 0,void 0,_r.mark(function Oe(){var Lt;return _r.wrap(function(Pt){for(;;)switch(Pt.prev=Pt.next){case 0:return Pt.next=2,this.core.sendCmd("qchatMarkSysMsgRead",{sysMsgs:Ro(Lt=$e.systemNotifications).call(Lt,function(pr){return db(pr)})});case 2:case"end":return Pt.stop()}},Oe,this)}))},Ne.onSysMsg=function($e){var Oe=$e.content.sysMsg;if(Oe){var Lt=mp(Oe,this.core.logger),rr=AC[ba[Lt.type]];if(rr&&rr.call(this,Lt)===!1)return;var Pt={feature:"default",systemNotifications:[Lt]};this.logger.log("qchat on systemNotification: ",Pt),this.core.emit("systemNotification",Pt)}else this.core.logger.warn("No sysMsg in onSysMsg packet")},Ne.onMultiSysMsg=function($e){var Oe=$e.content.sysMsg;if(Oe){var Lt=mp(Oe,this.logger);this.core.emit("systemNotificationUpdate",Lt)}},Ne.onSyncSysMsg=function($e){var Oe=this,Lt=$e.content.systemNotifications;if(Lt&&Lt.length>0){var rr=Ro(Lt).call(Lt,function(Pt){return mp(Pt,Oe.logger)});this.core.emit("systemNotification",{feature:"sync",systemNotifications:rr})}else this.logger.warn("sync system notification not exist")},pe}(),uv=["image","audio","video","file"],OC=function(){function pe(kt){var $e=this;this.markMessageRead=ov(function(Oe){return zr($e,void 0,void 0,_r.mark(function Lt(){var rr,Pt;return _r.wrap(function(yr){for(;;)switch(yr.prev=yr.next){case 0:return yr.next=2,this.core.sendCmd("qchatMarkMessageRead",{markMsgReadTag:Oe});case 2:rr=yr.sent,Pt=Yh(rr.content.unreadInfo),this.core.eventBus.emit("qchatChannel/updateUnreads",[Pt]);case 5:case"end":return yr.stop()}},Lt,this)}))},200),this.core=kt,this.logger=kt.logger}var Ne=pe.prototype;return Ne.sendMessage=function($e){var Oe,Lt,rr,Pt;return zr(this,void 0,void 0,_r.mark(function pr(){var yr,Pr,Rr,Vr,Dr,Xr;return _r.wrap(function(Tn){for(;;)switch(Tn.prev=Tn.next){case 0:if(!(Ba(uv).call(uv,$e.type)>-1)){Tn.next=4;break}return Tn.next=3,this.doSendFile($e);case 3:$e.attach=Tn.sent;case 4:return yr=cv(Vn({fromAccount:this.core.account},$e)),Tn.next=7,Xs(yr,{time:new Date().getTime(),deliveryStatus:Ji.sending},this.core);case 7:Pr=Tn.sent;try{$e.onSendBefore&&$e.onSendBefore(Pr)}catch(Dn){this.logger.error("sendMsg: options.onSendBefore error",Dn)}return Tn.prev=9,Tn.next=12,this.core.sendCmd("qchatSendMsg",{qchatMsg:yr});case 12:Rr=Tn.sent,Tn.next=22;break;case 15:return Tn.prev=15,Tn.t0=Tn.catch(9),Tn.next=19,Xs(yr,{time:new Date().getTime(),deliveryStatus:Ji.failed,attachUrl:(Oe=Pr.attach)===null||Oe===void 0?void 0:Oe.url},this.core);case 19:throw Vr=Tn.sent,Tn.t0.msg=Vr,Tn.t0;case 22:return Dr=Rr.content,Tn.next=25,Xs(Vn({},Dr.qchatMsg),{deliveryStatus:Ji.success,attachUrl:(Lt=Pr.attach)===null||Lt===void 0?void 0:Lt.url},this.core);case 25:if(!(Xr=Tn.sent).isAntispam){Tn.next=29;break}throw{code:10403,msg:Xr,message:((rr=Xr==null?void 0:Xr.antiSpamInfo)===null||rr===void 0?void 0:rr.yidunAntiSpamRes)||"message has be antispam",isAntispam:!0,yidunAntiSpamRes:((Pt=Xr==null?void 0:Xr.antiSpamInfo)===null||Pt===void 0?void 0:Pt.yidunAntiSpamRes)||""};case 29:return Tn.abrupt("return",Xr);case 30:case"end":return Tn.stop()}},pr,this,[[9,15]])}))},Ne.doSendFile=function($e){return zr(this,void 0,void 0,_r.mark(function Oe(){var Lt;return _r.wrap(function(Pt){for(;;)switch(Pt.prev=Pt.next){case 0:if(On({type:{type:"enum",values:["image","audio","video","file"]},attach:{type:"object",rules:{url:{type:"string",allowEmpty:!1}},required:!1},maxSize:{type:"number",min:1,required:!1}},$e),Lt=$e.attach){Pt.next=23;break}if(this.core.cloudStorage&&this.core.cloudStorage.uploadFile){Pt.next=5;break}throw new Error('Service "cloudStorage" does not exist');case 5:return Pt.prev=5,Pt.next=8,this.core.cloudStorage.uploadFile($e);case 8:Lt=Pt.sent,Pt.next=15;break;case 11:throw Pt.prev=11,Pt.t0=Pt.catch(5),this.logger.error("sendFile:: upload File error or abort",Pt.t0),Pt.t0;case 15:Pt.prev=15,$e.onUploadDone&&$e.onUploadDone(Lt),Pt.next=23;break;case 19:throw Pt.prev=19,Pt.t1=Pt.catch(15),this.logger.error("sendFile options.onUploadDone err",Pt.t1),Pt.t1;case 23:return Pt.abrupt("return",Lt);case 24:case"end":return Pt.stop()}},Oe,this,[[5,11],[15,19]])}))},Ne.resendMessage=function($e){var Oe,Lt;return zr(this,void 0,void 0,_r.mark(function rr(){var Pt,pr,yr,Pr,Rr;return _r.wrap(function(Dr){for(;;)switch(Dr.prev=Dr.next){case 0:return(Pt=cv(Vn(Vn({},$e),{resendFlag:!0}))).deliveryStatus=Ji.sending,Dr.prev=2,Dr.next=5,this.core.sendCmd("qchatSendMsg",{qchatMsg:Pt});case 5:pr=Dr.sent,Dr.next=15;break;case 8:return Dr.prev=8,Dr.t0=Dr.catch(2),Dr.next=12,Xs(Pt,{time:new Date().getTime(),deliveryStatus:Ji.failed},this.core);case 12:throw yr=Dr.sent,Dr.t0.msg=yr,Dr.t0;case 15:return Pr=pr.content,Dr.next=18,Xs(Vn({},Pr.qchatMsg),{deliveryStatus:Ji.success},this.core);case 18:if(!(Rr=Dr.sent).isAntispam){Dr.next=22;break}throw{code:10403,msg:Rr,message:((Oe=Rr==null?void 0:Rr.antiSpamInfo)===null||Oe===void 0?void 0:Oe.yidunAntiSpamRes)||"message has be antispam",isAntispam:!0,yidunAntiSpamRes:((Lt=Rr==null?void 0:Rr.antiSpamInfo)===null||Lt===void 0?void 0:Lt.yidunAntiSpamRes)||""};case 22:return Dr.abrupt("return",Rr);case 23:case"end":return Dr.stop()}},rr,this,[[2,8]])}))},Ne.doUpdateMessage=function($e){var Oe,Lt;return zr(this,void 0,void 0,_r.mark(function rr(){var Pt,pr,yr,Pr,Rr;return _r.wrap(function(Dr){for(;;)switch(Dr.prev=Dr.next){case 0:return Pt=$e.message,pr=eu($e,["message"]),(yr=cv(Pt)).msgIdClient=void 0,yr.time=Pt.time,Dr.next=6,this.core.sendCmd("qchatUpdateMessage",{qchatMsg:yr,qchatMsgUpdateTag:Vn(Vn({},pr),{operatorAccount:this.core.account,operatorClientType:$c.Web,pushPayload:Ao($e.pushPayload),routeEnable:Qh.boolean($e,"routeEnable")})});case 6:return Pr=Dr.sent,Dr.next=9,Xs(Pr.content.qchatMsg,{},this.core);case 9:if(Rr=Dr.sent,this.core.eventBus.emit("qchatChannel/changeUnread",Rr,!0),!Pr.content.qchatMsg.isAntispam){Dr.next=14;break}throw{code:10403,msg:yr,message:((Oe=Pr.content.qchatMsg)===null||Oe===void 0?void 0:Oe.yidunAntiSpamRes)||"message has be antispam",isAntispam:!0,yidunAntiSpamRes:((Lt=Pr.content.qchatMsg)===null||Lt===void 0?void 0:Lt.yidunAntiSpamRes)||""};case 14:return Dr.abrupt("return",Rr);case 15:case"end":return Dr.stop()}},rr,this)}))},Ne.getHistoryMessage=function($e){return zr(this,void 0,void 0,_r.mark(function Oe(){var Lt,rr,Pt,pr=this;return _r.wrap(function(Pr){for(;;)switch(Pr.prev=Pr.next){case 0:return Pr.next=2,this.core.sendCmd("qchatGetHistoryMsg",{getHistoryMsgTag:Vn(Vn({},$e),{reverse:Yl($e)?1:0})});case 2:return rr=Pr.sent,Pt=rr.content,Pr.next=6,xo.all(Ro(Lt=Pt.qchatMsgs).call(Lt,function(Rr){return Xs(Rr,{},pr.core)}));case 6:return Pr.abrupt("return",Pr.sent);case 7:case"end":return Pr.stop()}},Oe,this)}))},Ne.getMentionedMeMessages=function($e){return zr(this,void 0,void 0,_r.mark(function Oe(){var Lt,rr,Pt,pr,yr,Pr=this;return _r.wrap(function(Vr){for(;;)switch(Vr.prev=Vr.next){case 0:return Vr.next=2,this.core.sendCmd("qchatGetMentionedMeMessages",{tag:$e});case 2:return rr=Vr.sent,Pt=rr.content,Dr=Pt.page,pr=qa(PC,Dr),Vr.next=7,xo.all(Ro(Lt=Pt.datas).call(Lt,function(Xr){return Xs(Xr,{},Pr.core)}));case 7:return yr=Vr.sent,Vr.abrupt("return",{pageInfo:pr,messages:yr});case 9:case"end":return Vr.stop()}var Dr},Oe,this)}))},Ne.areMentionedMeMessages=function($e){return zr(this,void 0,void 0,_r.mark(function Oe(){var Lt,rr,Pt;return _r.wrap(function(yr){for(;;)switch(yr.prev=yr.next){case 0:Lt={},rr=0;case 2:if(!(rr<$e.length)){yr.next=13;break}if((Pt=$e[rr]).fromAccount!==this.core.account){yr.next=7;break}return Lt[Pt.msgIdClient]=!1,yr.abrupt("continue",10);case 7:return yr.next=9,this.core.qchatChannel.subscribeModuleService.getMentionedFlag(Pt,!0);case 9:Lt[Pt.msgIdClient]=yr.sent;case 10:rr++,yr.next=2;break;case 13:return yr.abrupt("return",Lt);case 14:case"end":return yr.stop()}},Oe,this)}))},Ne.getLastMessageOfChannels=function($e){return zr(this,void 0,void 0,_r.mark(function Oe(){var Lt,rr,Pt;return _r.wrap(function(yr){for(;;)switch(yr.prev=yr.next){case 0:return yr.next=2,this.core.sendCmd("qchatGetLastMessageOfChannels",{tag:$e});case 2:return Lt=yr.sent,rr=Lt.content.msgs,yr.next=6,lv(rr,{},this.core);case 6:return Pt=yr.sent,yr.abrupt("return",Kc(Pt).call(Pt,function(Pr,Rr){return Pr[Rr.channelId]=Rr,Pr},{}));case 8:case"end":return yr.stop()}},Oe,this)}))},Ne.messageSearchByPage=function($e){return zr(this,void 0,void 0,_r.mark(function Oe(){var Lt,rr,Pt,pr,yr;return _r.wrap(function(Rr){for(;;)switch(Rr.prev=Rr.next){case 0:return Rr.next=2,this.core.sendCmd("qchatMessageSearchByPage",{qchatMessageSearchByPageTag:Vn(Vn({},(Vr=$e,Tu(gb,Vr))),{includeSelf:$e.includeSelf?1:""})});case 2:return Lt=Rr.sent,rr=Lt.content,Pt=rr.datas,pr=rr.listQueryTag,Rr.next=6,lv(Pt,{},this.core);case 6:return yr=Rr.sent,Rr.abrupt("return",{listQueryTag:{hasMore:+pr.hasMore==1,nextTimetag:pr.nextTimetag?na(pr.nextTimetag):0,cursor:pr.cursor},datas:yr});case 8:case"end":return Rr.stop()}var Vr},Oe,this)}))},Ne.onMsg=function($e){return zr(this,void 0,void 0,_r.mark(function Oe(){var Lt,rr;return _r.wrap(function(pr){for(;;)switch(pr.prev=pr.next){case 0:if(Lt=$e.content.qchatMsg){pr.next=4;break}return this.logger.warn("No qchatMsg in qchatMsg packet"),pr.abrupt("return");case 4:return pr.next=6,Xs(Lt,{},this.core);case 6:rr=pr.sent,this.core.eventBus.emit("qchatChannel/changeUnread",rr,!1),this.core.emit("message",rr);case 9:case"end":return pr.stop()}},Oe,this)}))},Ne.onRecvUnreadInfo=function($e){return zr(this,void 0,void 0,_r.mark(function Oe(){var Lt,rr;return _r.wrap(function(pr){for(;;)switch(pr.prev=pr.next){case 0:if(Lt=$e.content.qchatMsg){pr.next=3;break}return pr.abrupt("return");case 3:return pr.next=5,Xs(Lt);case 5:rr=pr.sent,this.core.eventBus.emit("qchatChannel/changeUnread",rr,!1);case 7:case"end":return pr.stop()}},Oe,this)}))},Ne.onMultiSyncRead=function($e){var Oe=$e.content.unreadInfo;if(Oe){var Lt=Yh(Oe);this.core.eventBus.emit("qchatChannel/updateUnreads",[Lt])}},Ne.onMultiSyncServersRead=function($e){var Oe=$e.content.qchatMultiSyncServersMessageReadTag;if(Oe){var Lt=Hl(Oe),rr=Lt.successServerIds,Pt=Lt.ackTimestamp;this.core.eventBus.emit("qchatChannel/clearUnreadCountByServers",rr,Pt)}},Ne.onRecvMsgUpdate=function($e){return zr(this,void 0,void 0,_r.mark(function Oe(){var Lt,rr,Pt,pr;return _r.wrap(function(Pr){for(;;)switch(Pr.prev=Pr.next){case 0:if(Lt=$e.content.qchatMsg,rr=$e.content.qchatMsgUpdateInfo,Lt){Pr.next=4;break}return Pr.abrupt("return");case 4:return Pr.next=6,Xs(Lt,{},this.core);case 6:Pt=Pr.sent,pr=fb(rr),this.core.eventBus.emit("qchatChannel/changeUnread",Pt,!0),this.core.emit("messageUpdate",Pt,pr);case 10:case"end":return Pr.stop()}},Oe,this)}))},pe}(),RC=function(){function pe(kt){var $e=this;this._sendTypingEvent=ov(function(Oe){return zr($e,void 0,void 0,_r.mark(function Lt(){return _r.wrap(function(Pt){for(;;)switch(Pt.prev=Pt.next){case 0:return Pt.next=2,this.core.sendCmd("qchatSendCustomSysMsg",{sysMsg:iv(Vn(Vn({},Oe),{resendFlag:!1,persistEnable:!1,routeEnable:!1,pushEnable:!1,needBadge:!1,needPushNick:!1}),ba.msgTyping)});case 2:case"end":return Pt.stop()}},Lt,this)}))},3e3),this.core=kt,this.logger=kt.logger,this.lastChannelIdInTyping=""}var Ne=pe.prototype;return Ne.getMessageHistoryByIds=function($e){return zr(this,void 0,void 0,_r.mark(function Oe(){var Lt,rr;return _r.wrap(function(pr){for(;;)switch(pr.prev=pr.next){case 0:return pr.next=2,this.core.sendCmd("qchatGetMessageHistoryByIds",{channelInfo:{serverId:$e.serverId,channelId:$e.channelId},messageReferList:$e.messageReferList});case 2:return rr=pr.sent,pr.abrupt("return",xo.all(Ro(Lt=rr.content.qchatMsgs).call(Lt,function(yr){return Xs(yr)})));case 4:case"end":return pr.stop()}},Oe,this)}))},Ne.getReferMessages=function($e){var Oe,Lt;return zr(this,void 0,void 0,_r.mark(function rr(){var Pt;return _r.wrap(function(yr){for(;;)switch(yr.prev=yr.next){case 0:if(!((Oe=$e.message.replyRefer)===null||Oe===void 0)&&Oe.msgIdServer&&(!((Lt=$e.message.threadRefer)===null||Lt===void 0)&&Lt.msgIdServer)){yr.next=2;break}throw new Error("Message has no reply");case 2:return yr.next=4,this.getMessageHistoryByIds({serverId:$e.message.serverId,channelId:$e.message.channelId,messageReferList:[$e.message.replyRefer,$e.message.threadRefer]});case 4:if(Pt=yr.sent,$e.referType!==Fc[Fc.all]){yr.next=9;break}return yr.abrupt("return",{replyMessage:Pt[0],threadMessage:Pt[1]});case 9:if($e.referType!==Fc[Fc.reply]){yr.next=13;break}return yr.abrupt("return",{replyMessage:Pt[0]});case 13:if($e.referType!==Fc[Fc.thread]){yr.next=15;break}return yr.abrupt("return",{threadMessage:Pt[1]});case 15:return yr.abrupt("return",{replyMessage:Pt[0],threadMessage:Pt[1]});case 16:case"end":return yr.stop()}},rr,this)}))},Ne.getThreadMessages=function($e){var Oe;return zr(this,void 0,void 0,_r.mark(function Lt(){var rr,Pt,pr,yr,Pr;return _r.wrap(function(Vr){for(;;)switch(Vr.prev=Vr.next){case 0:return Pt=!((Oe=$e.message.threadRefer)===null||Oe===void 0)&&Oe.msgIdServer?Vn({serverId:$e.message.serverId,channelId:$e.message.channelId},$e.message.threadRefer):$e.message,Vr.next=3,this.core.sendCmd("qchatGetThreadMessages",{qchatMsg:Pt,getThreadHistoryMsgTag:Vn(Vn({},$e.messageQueryOption),{reverse:Qh.boolean($e.messageQueryOption,"reverse")})});case 3:return pr=Vr.sent,Vr.next=6,Xs(pr.content.thread);case 6:return yr=Vr.sent,Vr.next=9,xo.all(Ro(rr=pr.content.qchatMsgs).call(rr,function(Dr){return Xs(Dr)}));case 9:return Pr=Vr.sent,Vr.abrupt("return",{thread:yr,threadInfo:{messageCount:+pr.content.threadInfo.messageCount,lastMessageTimestamp:+pr.content.threadInfo.lastMessageTimestamp},messages:Pr});case 11:case"end":return Vr.stop()}},Lt,this)}))},Ne.getThreadRootMessagesMeta=function($e){return zr(this,void 0,void 0,_r.mark(function Oe(){var Lt,rr,Pt,pr;return _r.wrap(function(Pr){for(;;)switch(Pr.prev=Pr.next){case 0:return Lt=$e.threadRootMessages,rr=eu($e,["threadRootMessages"]),Pr.next=3,this.core.sendCmd("qchatGetThreadRootMessagesMeta",{qchatMsgs:Lt,tag:rr});case 3:if(Pt=Pr.sent,!((pr=Pt.content.metas)&&pr.length>0)){Pr.next=7;break}return Pr.abrupt("return",Ro(pr).call(pr,function(Rr){return Vn(Vn({},Rr),{total:na(Rr.total),timestamp:na(Rr.timestamp),msgTime:na(Rr.msgTime)})}));case 7:return Pr.abrupt("return",[]);case 8:case"end":return Pr.stop()}},Oe,this)}))},Ne.getQuickComments=function($e){return zr(this,void 0,void 0,_r.mark(function Oe(){var Lt,rr,Pt;return _r.wrap(function(yr){for(;;)switch(yr.prev=yr.next){case 0:return yr.next=2,this.core.sendCmd("qchatGetQuickComments",{tag:{serverId:$e.serverId,channelId:$e.channelId,msgIdServerList:Ao(Ro(Lt=$e.msgList).call(Lt,function(Pr){return Pr.msgIdServer}))}});case 2:return rr=yr.sent,Pt=rr.content.quickCommentResponse,yr.abrupt("return",IC(Pt));case 5:case"end":return yr.stop()}},Oe,this)}))},Ne.updateQuickComment=function($e,Oe){return zr(this,void 0,void 0,_r.mark(function Lt(){var rr,Pt,pr,yr,Pr,Rr;return _r.wrap(function(Dr){for(;;)switch(Dr.prev=Dr.next){case 0:return On({type:{type:"number"},commentMessage:{type:"object",rules:{msgIdServer:{type:"string",allowEmpty:!1}}}},$e),rr=$e.commentMessage,Pt=rr.serverId,pr=rr.channelId,yr=rr.fromAccount,Pr=rr.msgIdServer,Rr=rr.time,Dr.next=4,this.core.sendCmd("qchatUpdateQuickComment",{tag:{serverId:Pt,channelId:pr,fromAccount:yr,msgIdServer:Pr,time:Rr,type:$e.type,opeType:Oe,opeAccid:this.core.account}});case 4:case"end":return Dr.stop()}},Lt,this)}))},Ne.sendTypingEvent=function($e){return zr(this,void 0,void 0,_r.mark(function Oe(){return _r.wrap(function(rr){for(;;)switch(rr.prev=rr.next){case 0:if($e.channelId!==this.lastChannelIdInTyping){rr.next=4;break}return this.logger.log("qchatMsg sendTypingEvent throttle"),this._sendTypingEvent($e),rr.abrupt("return");case 4:this.lastChannelIdInTyping=$e.channelId,this._sendTypingEvent.flush(),this._sendTypingEvent($e);case 7:case"end":return rr.stop()}},Oe,this)}))},pe}(),hb=function(pe){function Ne($e){var Oe;return(Oe=pe.call(this,"qchatMsg",$e)||this).core=$e,Oe.lastChannelIdInMark="",oc({cmdMap:sv,cmdConfig:_C}),Oe.notificationModuleService=new NC($e),Oe.messageModuleService=new OC($e),Oe.extendModuleService=new RC($e),Oe}ea(Ne,pe);var kt=Ne.prototype;return kt.sendMessage=function(Oe){return zr(this,void 0,void 0,_r.mark(function Lt(){return _r.wrap(function(Pt){for(;;)switch(Pt.prev=Pt.next){case 0:return On({serverId:{type:"string",allowEmpty:!1},channelId:{type:"string",allowEmpty:!1},type:{type:"enum",values:Ea(dp)},ext:{type:"string",required:!1},mentionAll:{type:"boolean",required:!1},mentionAccids:{type:"array",itemType:"string",required:!1},mentionRoleIds:{type:"array",itemType:"string",required:!1,min:1},historyEnable:{type:"boolean",required:!1},pushEnable:{type:"boolean",required:!1}},Oe),Pt.next=3,this.messageModuleService.sendMessage(Oe);case 3:return Pt.abrupt("return",Pt.sent);case 4:case"end":return Pt.stop()}},Lt,this)}))},kt.updateMessage=function(Oe){return zr(this,void 0,void 0,_r.mark(function Lt(){return _r.wrap(function(Pt){for(;;)switch(Pt.prev=Pt.next){case 0:if(On({message:{type:"object",rules:{serverId:{type:"string",allowEmpty:!1},channelId:{type:"string",allowEmpty:!1},msgIdServer:{type:"string",allowEmpty:!1},time:{type:"number",min:0},body:{type:"string",required:!1},ext:{type:"string",required:!1}}}},Oe),!(typeof Oe.message.status=="number"&&Oe.message.status<1e4)){Pt.next=3;break}throw new Bo("Status should be greater than or equal to 10000");case 3:return Pt.next=5,this.messageModuleService.doUpdateMessage(Oe);case 5:return Pt.abrupt("return",Pt.sent);case 6:case"end":return Pt.stop()}},Lt,this)}))},kt.resendMessage=function(Oe){return zr(this,void 0,void 0,_r.mark(function Lt(){return _r.wrap(function(Pt){for(;;)switch(Pt.prev=Pt.next){case 0:return On({serverId:{type:"string",allowEmpty:!1},channelId:{type:"string",allowEmpty:!1},msgIdClient:{type:"string",allowEmpty:!1}},Oe),Pt.next=3,this.messageModuleService.resendMessage(Oe);case 3:return Pt.abrupt("return",Pt.sent);case 4:case"end":return Pt.stop()}},Lt,this)}))},kt.deleteMessage=function(Oe){return zr(this,void 0,void 0,_r.mark(function Lt(){var rr;return _r.wrap(function(pr){for(;;)switch(pr.prev=pr.next){case 0:return On({message:{type:"object",rules:{serverId:{type:"string",allowEmpty:!1},channelId:{type:"string",allowEmpty:!1},msgIdServer:{type:"string",allowEmpty:!1},time:{type:"number",min:0}}}},Oe),(rr=JSON.parse(Ao(Oe))).message.status=2,pr.next=5,this.messageModuleService.doUpdateMessage(rr);case 5:return pr.abrupt("return",pr.sent);case 6:case"end":return pr.stop()}},Lt,this)}))},kt.revokeMessage=function(Oe){return zr(this,void 0,void 0,_r.mark(function Lt(){var rr;return _r.wrap(function(pr){for(;;)switch(pr.prev=pr.next){case 0:return On({message:{type:"object",rules:{serverId:{type:"string",allowEmpty:!1},channelId:{type:"string",allowEmpty:!1},msgIdServer:{type:"string",allowEmpty:!1},time:{type:"number",min:0}}}},Oe),(rr=JSON.parse(Ao(Oe))).message=If(rr.message,["serverId","channelId","msgIdServer","time"]),rr.message.status=1,pr.next=6,this.messageModuleService.doUpdateMessage(rr);case 6:return pr.abrupt("return",pr.sent);case 7:case"end":return pr.stop()}},Lt,this)}))},kt.markMessageRead=function(Oe){return zr(this,void 0,void 0,_r.mark(function Lt(){return _r.wrap(function(Pt){for(;;)switch(Pt.prev=Pt.next){case 0:On({serverId:{type:"string"},channelId:{type:"string"},time:{type:"number",min:0}},Oe),Oe.channelId!==this.lastChannelIdInMark&&this.messageModuleService.markMessageRead.flush(),this.lastChannelIdInMark=Oe.channelId,this.messageModuleService.markMessageRead(Oe);case 4:case"end":return Pt.stop()}},Lt,this)}))},kt.replyMessage=function(Oe){On({replyMessage:{type:"object",rules:{msgIdServer:{type:"string",allowEmpty:!1}}}},Oe);var Lt=Oe.replyMessage;if(Oe.serverId!==Lt.serverId||Oe.channelId!==Lt.channelId)throw new Bo("Forbid replying to message from other server, channel");return this.sendMessage(Oe)},kt.getMessageHistoryByIds=function(Oe){return zr(this,void 0,void 0,_r.mark(function Lt(){return _r.wrap(function(Pt){for(;;)switch(Pt.prev=Pt.next){case 0:return On({serverId:{type:"string",allowEmpty:!1},channelId:{type:"string",allowEmpty:!1},messageReferList:{type:"array",rules:{msgIdServer:{type:"string",allowEmpty:!1},time:{type:"number"}}}},Oe),Pt.next=3,this.extendModuleService.getMessageHistoryByIds(Oe);case 3:return Pt.abrupt("return",Pt.sent);case 4:case"end":return Pt.stop()}},Lt,this)}))},kt.getReferMessages=function(Oe){return zr(this,void 0,void 0,_r.mark(function Lt(){return _r.wrap(function(Pt){for(;;)switch(Pt.prev=Pt.next){case 0:return On({message:{type:"object",rules:{msgIdServer:{type:"string",allowEmpty:!1},time:{type:"number"}}},referType:{type:"enum",values:Ea(Fc),required:!1}},Oe),Pt.next=3,this.extendModuleService.getReferMessages(Oe);case 3:return Pt.abrupt("return",Pt.sent);case 4:case"end":return Pt.stop()}},Lt,this)}))},kt.getThreadMessages=function(Oe){return zr(this,void 0,void 0,_r.mark(function Lt(){return _r.wrap(function(Pt){for(;;)switch(Pt.prev=Pt.next){case 0:return On({message:{type:"object",rules:{msgIdServer:{type:"string",allowEmpty:!1},time:{type:"number"}}},messageQueryOption:{type:"object",rules:{beginTime:{type:"number",required:!1},endTime:{type:"number",required:!1},excludeMsgId:{type:"string",required:!1},limit:{type:"number",required:!1},reverse:{type:"boolean",required:!1}}}},Oe),Pt.next=3,this.extendModuleService.getThreadMessages(Oe);case 3:return Pt.abrupt("return",Pt.sent);case 4:case"end":return Pt.stop()}},Lt,this)}))},kt.getThreadRootMessagesMeta=function(Oe){return zr(this,void 0,void 0,_r.mark(function Lt(){return _r.wrap(function(Pt){for(;;)switch(Pt.prev=Pt.next){case 0:return On({serverId:{type:"string",allowEmpty:!1},channelId:{type:"string",allowEmpty:!1},threadRootMessages:{type:"array",rules:{msgIdServer:{type:"string",allowEmpty:!1},time:{type:"number"}}}},Oe),Pt.next=3,this.extendModuleService.getThreadRootMessagesMeta(Oe);case 3:return Pt.abrupt("return",Pt.sent);case 4:case"end":return Pt.stop()}},Lt,this)}))},kt.sendSystemNotification=function(Oe){return zr(this,void 0,void 0,_r.mark(function Lt(){return _r.wrap(function(Pt){for(;;)switch(Pt.prev=Pt.next){case 0:return On({serverId:{type:"string",allowEmpty:!1},channelId:{type:"string",allowEmpty:!1,required:!1},attach:{type:"object",required:!1}},Oe),Pt.next=3,this.notificationModuleService.sendSystemNotification(Oe);case 3:return Pt.abrupt("return",Pt.sent);case 4:case"end":return Pt.stop()}},Lt,this)}))},kt.updateSystemNotification=function(Oe){return zr(this,void 0,void 0,_r.mark(function Lt(){return _r.wrap(function(Pt){for(;;)switch(Pt.prev=Pt.next){case 0:return On({systemNotification:{type:"object",rules:{msgIdServer:{type:"string",allowEmpty:!1},type:{type:"enum",values:Ea(ba)},body:{type:"string",required:!1},ext:{type:"string",required:!1},status:{type:"number",required:!1}}}},Oe),Pt.next=3,this.notificationModuleService.updateSystemNotification(Oe);case 3:return Pt.abrupt("return",Pt.sent);case 4:case"end":return Pt.stop()}},Lt,this)}))},kt.markSystemNotificationsRead=function(Oe){return zr(this,void 0,void 0,_r.mark(function Lt(){return _r.wrap(function(Pt){for(;;)switch(Pt.prev=Pt.next){case 0:return On({systemNotifications:{type:"array",rules:{msgIdServer:{type:"string",allowEmpty:!1},type:{type:"string",allowEmpty:!1}},min:1}},Oe),Pt.next=3,this.notificationModuleService.markSystemNotificationsRead(Oe);case 3:case"end":return Pt.stop()}},Lt,this)}))},kt.getHistoryMessage=function(Oe){return zr(this,void 0,void 0,_r.mark(function Lt(){return _r.wrap(function(Pt){for(;;)switch(Pt.prev=Pt.next){case 0:return On({serverId:{type:"string",allowEmpty:!1},channelId:{type:"string",allowEmpty:!1},beginTime:{type:"number",min:0,required:!1},endTime:{type:"number",min:0,required:!1},excludeMsgId:{type:"string",allowEmpty:!1,required:!1},limit:{type:"number",min:1,required:!1},reverse:{type:"boolean",required:!1}},Oe),Pt.next=3,this.messageModuleService.getHistoryMessage(Oe);case 3:return Pt.abrupt("return",Pt.sent);case 4:case"end":return Pt.stop()}},Lt,this)}))},kt.getMentionedMeMessages=function(Oe){return zr(this,void 0,void 0,_r.mark(function Lt(){return _r.wrap(function(Pt){for(;;)switch(Pt.prev=Pt.next){case 0:return On({serverId:{type:"string",allowEmpty:!1},channelId:{type:"string",allowEmpty:!1},timestamp:{type:"number",min:0,required:!1},limit:{type:"number",min:1,required:!1}},Oe),Pt.next=3,this.messageModuleService.getMentionedMeMessages(Oe);case 3:return Pt.abrupt("return",Pt.sent);case 4:case"end":return Pt.stop()}},Lt,this)}))},kt.areMentionedMeMessages=function(Oe){return zr(this,void 0,void 0,_r.mark(function Lt(){var rr;return _r.wrap(function(pr){for(;;)switch(pr.prev=pr.next){case 0:if(On({messages:{type:"array",rules:{serverId:{type:"string",allowEmpty:!1},channelId:{type:"string",allowEmpty:!1},msgIdServer:{type:"string",allowEmpty:!1}},min:1}},Oe),ou(rr=Oe.messages).call(rr,function(yr){return Oe.messages[0].serverId===yr.serverId})){pr.next=4;break}throw new Bo("Different serverId",Oe,10414);case 4:if(!this.core.qchatChannel.subscribeForVisitorService.isInAutoServers(Oe.messages[0].serverId)){pr.next=7;break}throw new Bo("Not allowed for visitor",Oe,10403);case 7:return pr.next=9,this.messageModuleService.areMentionedMeMessages(Oe.messages);case 9:return pr.abrupt("return",pr.sent);case 10:case"end":return pr.stop()}},Lt,this)}))},kt.addQuickComment=function(Oe){return zr(this,void 0,void 0,_r.mark(function Lt(){return _r.wrap(function(Pt){for(;;)switch(Pt.prev=Pt.next){case 0:return Pt.next=2,this.extendModuleService.updateQuickComment(Oe,1);case 2:case"end":return Pt.stop()}},Lt,this)}))},kt.removeQuickComment=function(Oe){return zr(this,void 0,void 0,_r.mark(function Lt(){return _r.wrap(function(Pt){for(;;)switch(Pt.prev=Pt.next){case 0:return Pt.next=2,this.extendModuleService.updateQuickComment(Oe,2);case 2:case"end":return Pt.stop()}},Lt,this)}))},kt.getQuickComments=function(Oe){return zr(this,void 0,void 0,_r.mark(function Lt(){return _r.wrap(function(Pt){for(;;)switch(Pt.prev=Pt.next){case 0:return On({serverId:{type:"string",allowEmpty:!1},channelId:{type:"string",allowEmpty:!1},msgList:{type:"array",rules:{msgIdServer:{type:"string",allowEmpty:!1}},min:1}},Oe),Pt.next=3,this.extendModuleService.getQuickComments(Oe);case 3:return Pt.abrupt("return",Pt.sent);case 4:case"end":return Pt.stop()}},Lt,this)}))},kt.sendTypingEvent=function(Oe){return zr(this,void 0,void 0,_r.mark(function Lt(){return _r.wrap(function(Pt){for(;;)switch(Pt.prev=Pt.next){case 0:return On({serverId:{type:"string",allowEmpty:!1},channelId:{type:"string",allowEmpty:!1},ext:{type:"string",required:!1}},Oe),Pt.next=3,this.extendModuleService.sendTypingEvent(Oe);case 3:return Pt.abrupt("return",Pt.sent);case 4:case"end":return Pt.stop()}},Lt,this)}))},kt.getLastMessageOfChannels=function(Oe){return zr(this,void 0,void 0,_r.mark(function Lt(){return _r.wrap(function(Pt){for(;;)switch(Pt.prev=Pt.next){case 0:return On({serverId:{type:"string",allowEmpty:!1},channelIdList:{type:"array",itemType:"string"}},Oe),Pt.next=3,this.messageModuleService.getLastMessageOfChannels(Oe);case 3:return Pt.abrupt("return",Pt.sent);case 4:case"end":return Pt.stop()}},Lt,this)}))},kt.qchatOnMsgHandler=function(Oe){return zr(this,void 0,void 0,_r.mark(function Lt(){return _r.wrap(function(Pt){for(;;)switch(Pt.prev=Pt.next){case 0:this.messageModuleService.onMsg(Oe);case 1:case"end":return Pt.stop()}},Lt,this)}))},kt.qchatOnRecvUnreadInfoHandler=function(Oe){return zr(this,void 0,void 0,_r.mark(function Lt(){return _r.wrap(function(Pt){for(;;)switch(Pt.prev=Pt.next){case 0:this.messageModuleService.onRecvUnreadInfo(Oe);case 1:case"end":return Pt.stop()}},Lt,this)}))},kt.qchatOnSysMsgHandler=function(Oe){this.notificationModuleService.onSysMsg(Oe)},kt.qchatMultiSyncMessageReadHandler=function(Oe){this.messageModuleService.onMultiSyncRead(Oe)},kt.qchatMultiSyncSystemNotificationUpdateHandler=function(Oe){this.notificationModuleService.onMultiSysMsg(Oe)},kt.qchatSyncSystemNotificationHandler=function(Oe){this.notificationModuleService.onSyncSysMsg(Oe)},kt.qchatRecvMessageUpdateHandler=function(Oe){return zr(this,void 0,void 0,_r.mark(function Lt(){return _r.wrap(function(Pt){for(;;)switch(Pt.prev=Pt.next){case 0:this.messageModuleService.onRecvMsgUpdate(Oe);case 1:case"end":return Pt.stop()}},Lt,this)}))},kt.searchMsgByPage=function(Oe){return zr(this,void 0,void 0,_r.mark(function Lt(){return _r.wrap(function(Pt){for(;;)switch(Pt.prev=Pt.next){case 0:return On({keyword:{type:"string",allowEmpty:!1,required:!1},serverId:{type:"string",allowEmpty:!1,required:!0},channelId:{type:"string",allowEmpty:!1,required:!1},fromAccid:{type:"string",allowEmpty:!1,required:!1},fromTime:{type:"number",allowEmpty:!1,required:!1},toTime:{type:"number",allowEmpty:!1,required:!1},msgTypes:{type:"array",itemType:"string",allowEmpty:!1,required:!0},subTypes:{type:"array",itemType:"string",allowEmpty:!1,required:!1},includeSelf:{type:"boolean",allowEmpty:!1,required:!1},order:{type:"enum",values:Ea(tl),required:!1},limit:{type:"number",min:0,required:!1},sort:{type:"enum",values:Ea(wf),required:!1},cursor:{type:"string",allowEmpty:!1,required:!1}},Oe),Pt.next=3,this.messageModuleService.messageSearchByPage(Oe);case 3:return Pt.abrupt("return",Pt.sent);case 4:case"end":return Pt.stop()}},Lt,this)}))},kt.qchatMultiSyncServersMessageReadHandler=function(Oe){this.messageModuleService.onMultiSyncServersRead(Oe)},Ne}(Vl);function dv(pe,Ne){Ne===void 0&&(Ne=1);var kt=qa({clientPort:{type:"number"},clientType:{type:"enum",values:$c},customClientType:{type:"number"},loginTime:{type:"number"},hasTokenPreviously:{type:"boolean"},pushType:{type:"number"}},pe);return Vn(Vn({},kt),{account:kt.account,connectionId:kt.connectionId,deviceId:kt.deviceId,ip:kt.ip,mac:kt.ip,os:kt.os,clientType:kt.clientType,time:kt.time,online:Ne!==2})}var vb={1:{reason:"samePlatformKick",message:"The same account is not allowed to multiple login at the same time"},2:{reason:"serverKick",message:"Kicked out by IM server"},3:{reason:"otherPlatformKick",message:"Kicked out by other client of your account"},4:{reason:"silentlyKick",message:"Quietly kicked"}},pv,Zs,Ha={BROWSER:0,RN:2,UNIAPP:3,WECHAT:6},BC=function(pe){function Ne($e){var Oe;return(Oe=pe.call(this,"qchatAuth",$e)||this).syncTimeTag=0,Oe}ea(Ne,pe);var kt=Ne.prototype;return kt.doLogin=function(Oe){var Lt;return Oe===void 0&&(Oe=!1),zr(this,void 0,void 0,_r.mark(function rr(){var Pt,pr,yr,Pr,Rr,Vr,Dr;return _r.wrap(function(kn){for(;;)switch(kn.prev=kn.next){case 0:return Pt=this.core.options,pr=Ca.getSystemInfo(),yr=Vn(Vn({},Pt),{appLogin:Oe?0:1,clientType:16,clientSession:(Lt=this.core.socket)===null||Lt===void 0?void 0:Lt.sessionId,deviceId:this.core.config.deviceId,sdkVersion:91001,sdkType:Ha[Ca.platform]||0,userAgent:"Native/0.13.1",sdkHumanVersion:"0.13.1",os:pr.os,browser:pr.browser}),kn.next=5,this.core.sendCmd("qchatLogin",{qchatLoginReqTag:yr});case 5:if(!(Pr=kn.sent).error){kn.next=8;break}throw Pr.error;case 8:return Rr=Pr.content,Vr=Rr.qchatLoginResTag,Dr=Rr.qchatMultiLoginResult,Vr.isAutoReconnect=Oe,kn.abrupt("return",{loginResult:dv(Vr),multiLoginResults:Ro(Dr).call(Dr,function(Tn){return dv(Tn)})});case 11:case"end":return kn.stop()}},rr,this)}))},kt.kick=function(Oe){var Lt;return zr(this,void 0,void 0,_r.mark(function rr(){var Pt;return _r.wrap(function(yr){for(;;)switch(yr.prev=yr.next){case 0:return yr.next=2,this.core.sendCmd("qchatKick",Oe);case 2:return Pt=yr.sent,yr.abrupt("return",(Lt=Pt.content)===null||Lt===void 0?void 0:Lt.deviceIds);case 4:case"end":return yr.stop()}},rr,this)}))},kt.sync=function(){return zr(this,void 0,void 0,_r.mark(function Oe(){return _r.wrap(function(rr){for(;;)switch(rr.prev=rr.next){case 0:return rr.next=2,this.core.sendCmd("qchatSync",{qchatSyncTag:{systemNotification:this.syncTimeTag||0}});case 2:case"end":return rr.stop()}},Oe,this)}))},kt.qchatSyncHandler=function(Oe){var Lt,rr;this.logger.log("sync: emit syncdone",(Lt=Oe.content)===null||Lt===void 0?void 0:Lt.timetag),this.core.emit("syncdone"),this.syncTimeTag=((rr=Oe.content)===null||rr===void 0?void 0:rr.timetag)||0},kt.qchatMultiSpotLoginHandler=function(Oe){if(Oe.error)this.logger.error("qchatMultiPortLoginHandler:: error, ",Oe.error);else{var Lt=Oe.content,rr=dv(Lt.qchatLoginResTag,Lt.state);this.core.emit("multiSpotLogin",[rr])}},kt.qchatBeKickedHandler=function(Oe){if(Oe.error)this.logger.error("qchatBeKickedHandler error, ",Oe.error);else{var Lt=function(Pt){var pr=qa({clientType:{type:"enum",values:$c},customClientType:{type:"number"}},Pt),yr=vb[pr.reason];return Vn(pr,yr=yr||{reason:"unknow",message:"Unknown reason"})}(Oe.content.beKickedTag);this.logger.warn("bekicked::",Lt),this.core.doDisconnect(Ls.KICKED,Lt)}},Ne}(Vl);(function(pe){pe.UNKNOWN="UNKNOWN",pe.LOGIN_STATE_ERROR="LOGIN_STATE_ERROR",pe.CLOSE_BY_BACKEND="CLOSE_BY_BACKEND",pe.ALL_MEMBERS_OUT="ALL_MEMBERS_OUT",pe.END_OF_LIFE="END_OF_LIFE",pe.CLOSE_BY_MEMBER="CLOSE_BY_MEMBER",pe.KICK_OUT="KICK_OUT",pe.SYNC_DATA_ERROR="SYNC_DATA_ERROR",pe.LEAVE_BY_SELF="LEAVE_BY_SELF",pe.kICK_BY_SELF="kICK_BY_SELF"})(pv||(pv={})),function(pe){pe.offNotAllowSelfOn="offNotAllowSelfOn",pe.offAllowSelfOn="offAllowSelfOn",pe.disable="disable"}(Zs||(Zs={}));var sl={serverId:{type:"string"},uid:{type:"string"},accid:{type:"string"},nick:{type:"string"},avatar:{type:"string"},ext:{type:"string"},type:{type:"number"},joinTime:{type:"number"},inviter:{type:"string"},validFlag:{type:"boolean"},createTime:{type:"number"},updateTime:{type:"number"}},jc={limit:{type:"number"}};function Dc(pe){return Es(pe)&&pe.length>0?Ro(pe).call(pe,function(Ne){return function($e){return qa(sl,$e)}(Ne)}):[]}function FC(pe){try{pe.audio&&(pe.audio=JSON.parse(pe.audio))}catch{throw new Nl('result "audio" JSON parse error',{key:"audio"},"JSON parse error")}try{pe.video&&(pe.video=JSON.parse(pe.video))}catch{throw new Nl('result "video" JSON parse error',{key:"video"},"JSON parse error")}return qa(jc,pe)}var gp={"25_1":"qchatGetNeroomToken","25_2":"qchatUpdateRTCChannelConfig","25_3":"qchatGetRTCChannelConfig","25_4":"qchatGetRTCChannelMembers"},hp={QChatRTCChannelConfigTag:{serverId:1,channelId:2,limit:3,audio:4,video:5},QChatRTCChannelConfigResultTag:{limit:1,audio:2,video:3},QChatGetRTCParams:{serverId:1,channelId:2},qchatGetRTCChannelMembersTag:{serverId:1,channelId:2},memberInfo:{serverId:1,accid:3,nick:4,avatar:5,ext:6,type:7,joinTime:8,inviter:9,validFlag:10,createTime:11,updateTime:12},QChatGetNeroomTokenResultTag:{token:1,expire:2},QChatGetNeroomTokenParams:{neroomDeviceId:1}},Af=Qc(hp),vp={qchatGetNeroomToken:{sid:25,cid:1,service:"qchatMedia",params:[{type:"Property",name:"qchatGetNeroomTokenTag",reflectMapper:hp.QChatGetNeroomTokenParams}],response:[{type:"Property",name:"neroomToken",reflectMapper:Af.QChatGetNeroomTokenResultTag}]},qchatUpdateRTCChannelConfig:{sid:25,cid:2,service:"qchatMedia",params:[{type:"Property",name:"RTCChannelConfig",reflectMapper:hp.QChatRTCChannelConfigTag}]},qchatGetRTCChannelConfig:{sid:25,cid:3,service:"qchatMedia",params:[{type:"Property",name:"qchatGetRTCChannelConfigTag",reflectMapper:hp.QChatGetRTCParams}],response:[{type:"Property",name:"RTCChannelConfig",reflectMapper:Af.QChatRTCChannelConfigResultTag}]},qchatGetRTCChannelMembers:{sid:25,cid:4,service:"qchatMedia",params:[{type:"Property",name:"qchatGetRTCChannelMembersTag",reflectMapper:hp.QChatGetRTCParams}],response:[{type:"PropertyArray",name:"memberList",reflectMapper:Af.memberInfo}]}},LC=function(pe){function Ne($e){var Oe;return(Oe=pe.call(this,"qchatMedia",$e)||this).tokenExpireTime=24e4,Oe.getTokenState=!1,Oe.core=$e,oc({cmdMap:gp,cmdConfig:vp}),Oe.core.on("disconnect",function(){return zr(k(Oe),void 0,void 0,_r.mark(function Lt(){return _r.wrap(function(Pt){for(;;)switch(Pt.prev=Pt.next){case 0:if(!this.roomContext){Pt.next=3;break}return Pt.next=3,this.disconnectChannel();case 3:this.tokenTimer&&(this.core.timerManager.deleteTimer(this.tokenTimer),this.tokenTimer=void 0);case 4:case"end":return Pt.stop()}},Lt,this)}))}),Oe.core.on("kicked",function(){return zr(k(Oe),void 0,void 0,_r.mark(function Lt(){return _r.wrap(function(Pt){for(;;)switch(Pt.prev=Pt.next){case 0:if(!this.roomContext){Pt.next=3;break}return Pt.next=3,this.disconnectChannel();case 3:this.tokenTimer&&(this.core.timerManager.deleteTimer(this.tokenTimer),this.tokenTimer=void 0);case 4:case"end":return Pt.stop()}},Lt,this)}))}),Oe.core.eventBus.on("qchatMedia/serverOrChannelLeave",function(Lt){return zr(k(Oe),void 0,void 0,_r.mark(function rr(){return _r.wrap(function(pr){for(;;)switch(pr.prev=pr.next){case 0:if(!(Lt.type===ba[ba.channelVisibilityUpdate]&&Lt.channelId===this.channelId||Lt.type===ba[ba.serverEnterLeave]&&Lt.serverId===this.serverId)){pr.next=4;break}if(!this.roomContext||!this.roomContext.roomUuid){pr.next=4;break}return pr.next=4,this.disconnectChannel();case 4:case"end":return pr.stop()}},rr,this)}))}),Oe.tokenExpireTime=24e4,Oe.channelId="",Oe.serverId="",Oe}ea(Ne,pe);var kt=Ne.prototype;return kt.setNeroom=function(Oe){this.neroom=new Oe},kt._checkPermission=function(Oe){return zr(this,void 0,void 0,_r.mark(function Lt(){var rr;return _r.wrap(function(pr){for(;;)switch(pr.prev=pr.next){case 0:return pr.next=2,this.core.qchatRole.checkPermission(Oe);case 2:return rr=pr.sent,pr.abrupt("return",rr);case 4:case"end":return pr.stop()}},Lt,this)}))},kt._checkConnectState=function(){if(this.state!=="connect")throw new Bo("QChatMedia::you should connect first")},kt.kickMemberOut=function(Oe){var Lt;return zr(this,void 0,void 0,_r.mark(function rr(){return _r.wrap(function(pr){for(;;)switch(pr.prev=pr.next){case 0:return this._checkConnectState(),On({accid:{type:"string",allowEmpty:!1}},Oe),pr.prev=2,pr.next=5,(Lt=this.roomContext)===null||Lt===void 0?void 0:Lt.kickMemberOut(Oe.accid);case 5:pr.next=11;break;case 7:throw pr.prev=7,pr.t0=pr.catch(2),this.logger.error("QChatMedia::kickMemberOut error params is "+Ao(Oe),pr.t0),new Bo("QChatMedia::kickMemberOut error",pr.t0);case 11:case"end":return pr.stop()}},rr,this,[[2,7]])}))},kt.disconnectChannel=function(){var Oe;return zr(this,void 0,void 0,_r.mark(function Lt(){return _r.wrap(function(Pt){for(;;)switch(Pt.prev=Pt.next){case 0:return this._checkConnectState(),this.logger.debug("QChatMedia::disconnect begin disconnect"),Pt.prev=2,Pt.next=5,(Oe=this.roomContext)===null||Oe===void 0?void 0:Oe.leaveRoom();case 5:Pt.next=10;break;case 7:Pt.prev=7,Pt.t0=Pt.catch(2),this.logger.error("QChatMedia::disconnect error",Pt.t0);case 10:if(!this.authService){Pt.next=13;break}return Pt.next=13,this.authService.logout();case 13:this._setStateInit(),this.core.emit("qchatMediaDisconnect");case 15:case"end":return Pt.stop()}},Lt,this,[[2,7]])}))},kt._setStateInit=function(){this.logger.debug("QChatMedia::disconnect end"),this.roomContext=void 0,this.rtcController=void 0,this.state="init",this.tokenTimer&&(this.core.timerManager.deleteTimer(this.tokenTimer),this.tokenTimer=void 0),this.channelId="",this.serverId=""},kt.muteAudio=function(Oe){var Lt,rr,Pt,pr,yr;return zr(this,void 0,void 0,_r.mark(function Pr(){var Rr;return _r.wrap(function(Dr){for(;;)switch(Dr.prev=Dr.next){case 0:if(this._checkConnectState(),On({accid:{type:"string",allowEmpty:!1}},Oe),((Lt=this.roomContext)===null||Lt===void 0?void 0:Lt.localMember.uuid)!==Oe.accid){Dr.next=14;break}return Dr.prev=3,Dr.next=6,(rr=this.rtcController)===null||rr===void 0?void 0:rr.muteMyAudio();case 6:Dr.next=12;break;case 8:throw Dr.prev=8,Dr.t0=Dr.catch(3),this.logger.error("QChatMedia::muteAudio error",Dr.t0),new Bo("QChatMedia::muteAudio error",Dr.t0);case 12:case 25:Dr.next=31;break;case 14:if(Dr.prev=14,!(Rr=(Pt=this.roomContext)===null||Pt===void 0?void 0:Pt.roomProperties.audioOff)||((pr=Rr.value)===null||pr===void 0?void 0:pr.split("_")[0])!==Zs.offNotAllowSelfOn){Dr.next=23;break}return Dr.next=19,this._checkPermission({serverId:this.serverId,channelId:this.channelId,auth:"RTCChannelOpenCloseEveryoneMicrophone"});case 19:if(Dr.sent){Dr.next=23;break}return this.logger.error("QChatMedia::unMuteAudio not allow open auido"),Dr.abrupt("return");case 23:return Dr.next=25,(yr=this.rtcController)===null||yr===void 0?void 0:yr.muteMemberAudio(Oe.accid);case 27:throw Dr.prev=27,Dr.t1=Dr.catch(14),this.logger.error("QChatMedia::muteAudio error params is "+Ao(Oe),Dr.t1),new Bo("QChatMedia::muteAudio error",Dr.t1);case 31:case"end":return Dr.stop()}},Pr,this,[[3,8],[14,27]])}))},kt.unMuteAudio=function(Oe){var Lt,rr,Pt,pr,yr;return zr(this,void 0,void 0,_r.mark(function Pr(){var Rr;return _r.wrap(function(Dr){for(;;)switch(Dr.prev=Dr.next){case 0:if(this._checkConnectState(),On({accid:{type:"string",allowEmpty:!1}},Oe),!(Rr=(Lt=this.roomContext)===null||Lt===void 0?void 0:Lt.roomProperties.audioOff)||((rr=Rr.value)===null||rr===void 0?void 0:rr.split("_")[0])!==Zs.offNotAllowSelfOn){Dr.next=10;break}return Dr.next=6,this._checkPermission({serverId:this.serverId,channelId:this.channelId,auth:"RTCChannelOpenCloseEveryoneMicrophone"});case 6:if(Dr.sent){Dr.next=10;break}return this.logger.error("QChatMedia::unMuteAudio not allow open auido"),Dr.abrupt("return");case 10:if(((Pt=this.roomContext)===null||Pt===void 0?void 0:Pt.localMember.uuid)!==Oe.accid){Dr.next=22;break}return Dr.prev=11,Dr.next=14,(pr=this.rtcController)===null||pr===void 0?void 0:pr.unmuteMyAudio();case 14:Dr.next=20;break;case 16:throw Dr.prev=16,Dr.t0=Dr.catch(11),this.logger.error("QChatMedia::unMuteAudio error",Dr.t0),new Bo("QChatMedia::unMuteAudio error",Dr.t0);case 20:case 25:Dr.next=31;break;case 22:return Dr.prev=22,Dr.next=25,(yr=this.rtcController)===null||yr===void 0?void 0:yr.unmuteMemberAudio(Oe.accid);case 27:throw Dr.prev=27,Dr.t1=Dr.catch(22),this.logger.error("QChatMedia::unMuteAudio error params is "+Ao(Oe),Dr.t1),new Bo("QChatMedia::unMuteAudio error",Dr.t1);case 31:case"end":return Dr.stop()}},Pr,this,[[11,16],[22,27]])}))},kt.muteVideo=function(Oe){var Lt,rr,Pt,pr,yr;return zr(this,void 0,void 0,_r.mark(function Pr(){var Rr;return _r.wrap(function(Dr){for(;;)switch(Dr.prev=Dr.next){case 0:if(this._checkConnectState(),On({accid:{type:"string",allowEmpty:!1}},Oe),((Lt=this.roomContext)===null||Lt===void 0?void 0:Lt.localMember.uuid)!==Oe.accid){Dr.next=14;break}return Dr.prev=3,Dr.next=6,(rr=this.rtcController)===null||rr===void 0?void 0:rr.muteMyVideo();case 6:Dr.next=12;break;case 8:throw Dr.prev=8,Dr.t0=Dr.catch(3),this.logger.error("QChatMedia::muteVideo error",Dr.t0),new Bo("QChatMedia::muteVideo error",Dr.t0);case 12:case 25:Dr.next=31;break;case 14:if(Dr.prev=14,!(Rr=(Pt=this.roomContext)===null||Pt===void 0?void 0:Pt.roomProperties.videoOff)||((pr=Rr.value)===null||pr===void 0?void 0:pr.split("_")[0])!==Zs.offNotAllowSelfOn){Dr.next=23;break}return Dr.next=19,this._checkPermission({serverId:this.serverId,channelId:this.channelId,auth:"RTCChannelOpenCloseEveryoneCamera"});case 19:if(Dr.sent){Dr.next=23;break}return this.logger.error("QChatMedia::unMuteVideo not allow open video"),Dr.abrupt("return");case 23:return Dr.next=25,(yr=this.rtcController)===null||yr===void 0?void 0:yr.muteMemberVideo(Oe.accid);case 27:throw Dr.prev=27,Dr.t1=Dr.catch(14),this.logger.error("QChatMedia::muteVideo error params is "+Ao(Oe),Dr.t1),new Bo("QChatMedia::muteVideo error",Dr.t1);case 31:case"end":return Dr.stop()}},Pr,this,[[3,8],[14,27]])}))},kt.unMuteVideo=function(Oe){var Lt,rr,Pt,pr,yr;return zr(this,void 0,void 0,_r.mark(function Pr(){var Rr;return _r.wrap(function(Dr){for(;;)switch(Dr.prev=Dr.next){case 0:if(this._checkConnectState(),On({accid:{type:"string",allowEmpty:!1}},Oe),!(Rr=(Lt=this.roomContext)===null||Lt===void 0?void 0:Lt.roomProperties.videoOff)||((rr=Rr.value)===null||rr===void 0?void 0:rr.split("_")[0])!==Zs.offNotAllowSelfOn){Dr.next=10;break}return Dr.next=6,this._checkPermission({serverId:this.serverId,channelId:this.channelId,auth:"RTCChannelOpenCloseEveryoneCamera"});case 6:if(Dr.sent){Dr.next=10;break}return this.logger.error("QChatMedia::unMuteVideo not allow open video"),Dr.abrupt("return");case 10:if(((Pt=this.roomContext)===null||Pt===void 0?void 0:Pt.localMember.uuid)!==Oe.accid){Dr.next=22;break}return Dr.prev=11,Dr.next=14,(pr=this.rtcController)===null||pr===void 0?void 0:pr.unmuteMyVideo();case 14:Dr.next=20;break;case 16:throw Dr.prev=16,Dr.t0=Dr.catch(11),this.logger.error("QChatMedia::unMuteVideo error",Dr.t0),new Bo("QChatMedia::unMuteVideo error",Dr.t0);case 20:Dr.next=30;break;case 22:Dr.prev=22,(yr=this.rtcController)===null||yr===void 0||yr.unmuteMemberVideo(Oe.accid),Dr.next=30;break;case 26:throw Dr.prev=26,Dr.t1=Dr.catch(22),this.logger.error("QChatMedia::unMuteVideo error",Dr.t1),new Bo("QChatMedia::unMuteVideo error",Dr.t1);case 30:case"end":return Dr.stop()}},Pr,this,[[11,16],[22,26]])}))},kt.startScreenShare=function(){var Oe;return zr(this,void 0,void 0,_r.mark(function Lt(){return _r.wrap(function(Pt){for(;;)switch(Pt.prev=Pt.next){case 0:this._checkConnectState(),Pt.prev=1,(Oe=this.rtcController)===null||Oe===void 0||Oe.startScreenShare(),Pt.next=9;break;case 5:throw Pt.prev=5,Pt.t0=Pt.catch(1),this.logger.error("QChatMedia::startScreenShare error",Pt.t0),new Bo("QChatMedia::startScreenShare error",Pt.t0);case 9:case"end":return Pt.stop()}},Lt,this,[[1,5]])}))},kt.stopScreenShare=function(){var Oe;return zr(this,void 0,void 0,_r.mark(function Lt(){return _r.wrap(function(Pt){for(;;)switch(Pt.prev=Pt.next){case 0:this._checkConnectState(),Pt.prev=1,(Oe=this.rtcController)===null||Oe===void 0||Oe.stopScreenShare(),Pt.next=9;break;case 5:throw Pt.prev=5,Pt.t0=Pt.catch(1),this.logger.error("QChatMedia::stopScreenShare error",Pt.t0),new Bo("QChatMedia::stopScreenShare error",Pt.t0);case 9:case"end":return Pt.stop()}},Lt,this,[[1,5]])}))},kt.stopMemberScreenShare=function(Oe){var Lt;return zr(this,void 0,void 0,_r.mark(function rr(){return _r.wrap(function(pr){for(;;)switch(pr.prev=pr.next){case 0:this._checkConnectState(),On({accid:{type:"string",allowEmpty:!1}},Oe),pr.prev=2,(Lt=this.rtcController)===null||Lt===void 0||Lt.stopMemberScreenShare(Oe.accid),pr.next=10;break;case 6:throw pr.prev=6,pr.t0=pr.catch(2),this.logger.error("QChatMedia::stopMemberScreenShare error",pr.t0),new Bo("QChatMedia::stopMemberScreenShare error",pr.t0);case 10:case"end":return pr.stop()}},rr,this,[[2,6]])}))},kt.subscribeRemoteVideoStream=function(Oe){var Lt;return zr(this,void 0,void 0,_r.mark(function rr(){return _r.wrap(function(pr){for(;;)switch(pr.prev=pr.next){case 0:this._checkConnectState(),On({accid:{type:"string",allowEmpty:!1},streamType:{type:"number",allowEmpty:!1,min:0,max:1}},Oe),pr.prev=2,(Lt=this.rtcController)===null||Lt===void 0||Lt.subscribeRemoteVideoStream(Oe.accid,Oe.streamType),pr.next=10;break;case 6:throw pr.prev=6,pr.t0=pr.catch(2),this.logger.error("QChatMedia::subscribeRemoteVideoStream error",pr.t0),new Bo("QChatMedia::subscribeRemoteVideoStream error",pr.t0);case 10:case"end":return pr.stop()}},rr,this,[[2,6]])}))},kt.unSubscribeRemoteVideoStream=function(Oe){var Lt;return zr(this,void 0,void 0,_r.mark(function rr(){return _r.wrap(function(pr){for(;;)switch(pr.prev=pr.next){case 0:this._checkConnectState(),On({accid:{type:"string",allowEmpty:!1},streamType:{type:"number",allowEmpty:!1,min:0,max:1}},Oe),pr.prev=2,(Lt=this.rtcController)===null||Lt===void 0||Lt.unsubscribeRemoteVideoStream(Oe.accid,Oe.streamType),pr.next=10;break;case 6:throw pr.prev=6,pr.t0=pr.catch(2),this.logger.error("QChatMedia::unSubscribeRemoteVideoStream error",pr.t0),new Bo("QChatMedia::unSubscribeRemoteVideoStream error",pr.t0);case 10:case"end":return pr.stop()}},rr,this,[[2,6]])}))},kt.setupVideoCanvas=function(Oe){var Lt;if(this._checkConnectState(),((Lt=this.roomContext)===null||Lt===void 0?void 0:Lt.localMember.uuid)===Oe.accid)try{return this.rtcController.setupLocalVideoCanvas(Oe.videoView)}catch(rr){throw this.logger.error("QChatMedia::setupVideoCanvas error",rr),new Bo("QChatMedia::setupVideoCanvas error",rr)}else try{return this.rtcController.setupRemoteVideoCanvas(Oe.videoView,Oe.accid)}catch(rr){throw this.logger.error("QChatMedia::setupVideoCanvas error",rr),new Bo("QChatMedia::setupVideoCanvas error",rr)}},kt.setupRemoteVideoSubStreamCanvas=function(Oe){this._checkConnectState(),On({accid:{type:"string",allowEmpty:!1}},Oe);try{return this.rtcController.setupRemoteVideoSubStreamCanvas(Oe.videoView,Oe.accid)}catch(Lt){throw this.logger.error("QChatMedia::setupRemoteVideoSubStreamCanvas error",Lt),new Bo("QChatMedia::setupRemoteVideoSubStreamCanvas error",Lt)}},kt.getScreenSharingUserUuid=function(){this._checkConnectState();try{return this.rtcController.getScreenSharingUserUuid()}catch(Oe){throw this.logger.error("QChatMedia::getScreenSharingUserUuid error",Oe),new Bo("QChatMedia::getScreenSharingUserUuid error",Oe)}},kt.initQChatMedia=function(Oe){return zr(this,void 0,void 0,_r.mark(function Lt(){return _r.wrap(function(Pt){for(;;)switch(Pt.prev=Pt.next){case 0:if(this.neroom){Pt.next=3;break}return this.logger.warn("QChatMedia::init::you should import neroom SDK"),Pt.abrupt("return");case 3:if(this.state===void 0){Pt.next=6;break}return this.logger.error("QChatMedia::init::you already init QChatMedia"),Pt.abrupt("return");case 6:Pt.prev=6,this.neroom.initialize({appKey:this.core.options.appkey,serverConfig:Oe.serverConfig}),Pt.next=14;break;case 10:throw Pt.prev=10,Pt.t0=Pt.catch(6),this.logger.error("QChatMedia::initQChatMedia error",Pt.t0),new Bo("QChatMedia::initQChatMedia error",Pt.t0);case 14:this.authService=this.neroom.authService,this.roomService=this.neroom.roomService,this.messageChannelService=this.neroom.messageChannelService,this.state="init";case 18:case"end":return Pt.stop()}},Lt,this,[[6,10]])}))},kt.loginByIM=function(){var Oe;return zr(this,void 0,void 0,_r.mark(function Lt(){var rr,Pt;return _r.wrap(function(yr){for(;;)switch(yr.prev=yr.next){case 0:if(this.state==="init"){yr.next=3;break}return this.logger.error("QChatMedia::connect::you should init before login"),yr.abrupt("return");case 3:return rr=this.core.options,yr.next=6,this._getToken();case 6:return Pt=yr.sent,yr.prev=7,yr.next=10,(Oe=this.authService)===null||Oe===void 0?void 0:Oe.loginByIM(rr.account,Pt,rr.token);case 10:yr.next=16;break;case 12:throw yr.prev=12,yr.t0=yr.catch(7),this.logger.error("QChatMedia::loginByIM error",yr.t0),new Bo("QChatMedia::loginByIM error",yr.t0);case 16:this.state="login";case 17:case"end":return yr.stop()}},Lt,this,[[7,12]])}))},kt._getToken=function(){var Oe;return zr(this,void 0,void 0,_r.mark(function Lt(){var rr,Pt,pr,yr,Pr=this;return _r.wrap(function(Vr){for(;;)switch(Vr.prev=Vr.next){case 0:return this.logger.log("QChatMedia::getToken begin getToken"),Vr.next=3,this.core.sendCmd("qchatGetNeroomToken",{qchatGetNeroomTokenTag:{neroomDeviceId:(Oe=this.neroom)===null||Oe===void 0?void 0:Oe.deviceId}});case 3:return rr=Vr.sent,Pt=rr.content.neroomToken,pr=Pt.token,yr=Pt.expire,this.logger.log("QChatMedia::getToken success token is "+pr+",expire is "+yr+" "),this.tokenTimer||(this.logger.debug("QChatMedia::getToken set token timer,expire is "+(1e3*yr-this.tokenExpireTime)+" "),this.tokenTimer=this.core.timerManager.addTimer(function(){return zr(Pr,void 0,void 0,_r.mark(function Dr(){var Xr;return _r.wrap(function(Tn){for(;;)switch(Tn.prev=Tn.next){case 0:return this.tokenTimer&&this.core.timerManager.deleteTimer(this.tokenTimer),this.tokenTimer=void 0,Tn.next=4,this._getToken();case 4:Xr=Tn.sent,this.authService&&this.authService.renewToken(Xr);case 6:case"end":return Tn.stop()}},Dr,this)}))},1e3*yr-this.tokenExpireTime)),Vr.abrupt("return",pr);case 8:case"end":return Vr.stop()}},Lt,this)}))},kt.connectChannel=function(Oe){var Lt,rr;return zr(this,void 0,void 0,_r.mark(function Pt(){var pr;return _r.wrap(function(Pr){for(;;)switch(Pr.prev=Pr.next){case 0:if(this.state!==void 0){Pr.next=3;break}return this.logger.error("QChatMedia::connect::you should init before login"),Pr.abrupt("return");case 3:if(this.state!=="init"){Pr.next=6;break}return Pr.next=6,this.loginByIM();case 6:return this.serverId=Oe.serverId,this.channelId=Oe.channelId,Pr.prev=8,Pr.next=11,(Lt=this.roomService)===null||Lt===void 0?void 0:Lt.joinRoom({roomUuid:Oe.channelId,role:"qchatAudience",userName:this.core.options.account,initialProperties:{}},{});case 11:Pr.next=17;break;case 13:throw Pr.prev=13,Pr.t0=Pr.catch(8),this.logger.error("QChatMedia::connectChannel error",Pr.t0),new Bo("QChatMedia::connectChannel error",Pr.t0);case 17:if(!(pr=(rr=this.roomService)===null||rr===void 0?void 0:rr.getRoomContext(Oe.channelId))){Pr.next=27;break}return this.roomContext=pr,this.rtcController=this.roomContext.rtcController,this.state="connect",Pr.next=24,this.rtcController.joinRtcChannel();case 24:this.core.emit("connectChannel"),Pr.next=28;break;case 27:this.logger.error("QChatMedia::connect room not exited");case 28:case"end":return Pr.stop()}},Pt,this,[[8,13]])}))},kt.updateRTCChannelInfo=function(Oe){return zr(this,void 0,void 0,_r.mark(function Lt(){return _r.wrap(function(Pt){for(;;)switch(Pt.prev=Pt.next){case 0:return On({serverId:{type:"string",allowEmpty:!1},channelId:{type:"string",allowEmpty:!1},limit:{type:"number",allowEmpty:!1}},Oe),Pt.next=3,this.core.sendCmd("qchatUpdateRTCChannelConfig",{RTCChannelConfig:Vn(Vn({},Oe),{audio:Ao(Oe.audio),video:Ao(Oe.video)})});case 3:case"end":return Pt.stop()}},Lt,this)}))},kt.getRTCChannelInfo=function(Oe){return zr(this,void 0,void 0,_r.mark(function Lt(){var rr;return _r.wrap(function(pr){for(;;)switch(pr.prev=pr.next){case 0:return On({serverId:{type:"string",allowEmpty:!1},channelId:{type:"string",allowEmpty:!1}},Oe),pr.next=3,this.core.sendCmd("qchatGetRTCChannelConfig",{qchatGetRTCChannelConfigTag:Oe});case 3:return rr=pr.sent,pr.abrupt("return",FC(rr.content.RTCChannelConfig));case 5:case"end":return pr.stop()}},Lt,this)}))},kt.getRTCChannelOnlineMembers=function(Oe){return zr(this,void 0,void 0,_r.mark(function Lt(){var rr;return _r.wrap(function(pr){for(;;)switch(pr.prev=pr.next){case 0:return On({serverId:{type:"string",allowEmpty:!1},channelId:{type:"string",allowEmpty:!1}},Oe),pr.next=3,this.core.sendCmd("qchatGetRTCChannelMembers",{qchatGetRTCChannelMembersTag:Oe});case 3:return rr=pr.sent,pr.abrupt("return",Dc(rr.content.memberList));case 5:case"end":return pr.stop()}},Lt,this)}))},kt.addRTCChannelListener=function(){var Oe,Lt,rr=this;this._checkConnectState();try{(Oe=this.authService)===null||Oe===void 0||Oe.addAuthListener({onAuthEvent:function(pr){return zr(rr,void 0,void 0,_r.mark(function yr(){var Pr;return _r.wrap(function(Vr){for(;;)switch(Vr.prev=Vr.next){case 0:if(pr!==1026||this.getTokenState){Vr.next=10;break}return this.logger.log("QChatMedia::loginByIM token expire,begin get new token "),this.getTokenState=!0,Vr.next=5,this._getToken();case 5:if(Pr=Vr.sent,!this.authService){Vr.next=9;break}return Vr.next=9,this.authService.renewToken(Pr);case 9:this.getTokenState=!1;case 10:case"end":return Vr.stop()}},yr,this)}))}})}catch(Pt){throw this.getTokenState=!1,this.logger.error("QChatMedia::loginByIM addAuthListener error",Pt),new Bo("QChatMedia::loginByIM addAuthListener error",Pt)}(Lt=this.roomContext)===null||Lt===void 0||Lt.addRoomListener({onRoomPropertiesChanged:function(pr){var yr,Pr,Rr,Vr,Dr,Xr;if(rr.logger.log("QChatMedia::addRTCChannelListener::onRoomPropertiesChanged",pr),pr.audioOff){var kn=(yr=pr.audioOff.value)===null||yr===void 0?void 0:yr.split("_")[0];kn!==Zs.offNotAllowSelfOn&&kn!==Zs.offAllowSelfOn||!((Pr=rr.roomContext)===null||Pr===void 0)&&Pr.localMember.isAudioOn&&((Rr=rr.rtcController)===null||Rr===void 0||Rr.muteMyAudio())}else if(pr.videoOff){var Tn=(Vr=pr.videoOff.value)===null||Vr===void 0?void 0:Vr.split("_")[0];Tn!==Zs.offNotAllowSelfOn&&Tn!==Zs.offAllowSelfOn||!((Dr=rr.roomContext)===null||Dr===void 0)&&Dr.localMember.isVideoOn&&((Xr=rr.rtcController)===null||Xr===void 0||Xr.muteMyVideo())}},onRoomPropertiesDeleted:function(pr){rr.logger.log("QChatMedia::addRTCChannelListener::onRoomPropertiesDeleted",pr)},onMemberJoinRtcChannel:function(pr){rr.logger.log("QChatMedia::addRTCChannelListener::onMemberJoinRTCChannel",pr);var yr=Ro(pr).call(pr,function(Pr){return Pr.uuid});rr.core.emit("memberJoinRTCChannel",yr)},onMemberLeaveRoom:function(pr){rr.logger.log("QChatMedia::addRTCChannelListener::onMemberLeaveRoom",pr);var yr=Ro(pr).call(pr,function(Pr){return Pr.uuid});rr.core.emit("memberLeaveRTCChannel",yr)},onRoomEnded:function(pr){rr.authService&&rr.authService.logout(),rr._setStateInit(),rr.logger.log("QChatMedia::addRTCChannelListener::onRoomEnded",pr),rr.core.emit("RTCChannelEnded",pr)},onRtcChannelError:function(pr){rr.logger.log("QChatMedia::addRTCChannelListener::onRtcChannelError",pr),pr==="SOCKET_ERROR"&&rr.disconnectChannel(),rr.core.emit("RTCChannelError",pr)},onRtcAudioVolumeIndication:function(pr){rr.logger.log("QChatMedia::addRTCChannelListener::onRtcAudioVolumeIndication",pr),rr.core.emit("onRtcAudioVolumeIndication",pr)},onMemberAudioMuteChanged:function(pr,yr,Pr){rr.logger.log("QChatMedia::addRTCChannelListener::onMemberAudioMuteChanged",pr,yr),rr.core.emit("memberAudioMuteChanged",{memberAccId:pr.uuid,mute:yr,operateByAccId:Pr.uuid})},onMemberScreenShareStateChanged:function(pr,yr,Pr){rr.logger.log("QChatMedia::addRTCChannelListener::onMemberScreenShareStateChanged",pr,yr),rr.core.emit("memberScreenShareStateChanged",{memberAccId:pr.uuid,isSharing:yr,operateByAccId:Pr.uuid})},onMemberVideoMuteChanged:function(pr,yr,Pr){rr.logger.log("QChatMedia::addRTCChannelListener::onMemberVideoMuteChanged",pr,yr),rr.core.emit("memberVideoMuteChanged",{memberAccId:pr.uuid,mute:yr,operateByAccId:Pr.uuid})}})},kt.enumCameraDevices=function(){var Oe=this;return this._checkConnectState(),this.rtcController.enumCameraDevices().then(function(Lt){return Lt.data},function(Lt){throw Oe.logger.error("QChatMedia::enumCameraDevices error",Lt),new Bo("QChatMedia::enumCameraDevices error",Lt)})},kt.enumPlayoutDevices=function(){var Oe=this;return this._checkConnectState(),this.rtcController.enumPlayoutDevices().then(function(Lt){return Lt.data},function(Lt){throw Oe.logger.error("QChatMedia::enumPlayoutDevices error",Lt),new Bo("QChatMedia::enumPlayoutDevices error",Lt)})},kt.enumRecordDevices=function(){var Oe=this;return this._checkConnectState(),this.rtcController.enumRecordDevices().then(function(Lt){return Lt.data},function(Lt){throw Oe.logger.error("QChatMedia::enumRecordDevices error",Lt),new Bo("QChatMedia::enumRecordDevices error",Lt)})},kt.removeRTCChannelListener=function(){var Oe,Lt;this._checkConnectState(),(Oe=this.roomContext)===null||Oe===void 0||Oe.removeRoomListener({}),(Lt=this.authService)===null||Lt===void 0||Lt.removeAuthListener({})},kt.setSelectedCameraDevice=function(Oe){var Lt=this;return this._checkConnectState(),On({deviceId:{type:"string",allowEmpty:!1}},Oe),this.rtcController.setSelectedCameraDevice(Oe.deviceId).then(function(rr){return rr.data},function(rr){throw Lt.logger.error("QChatMedia::setSelectedCameraDevice error",rr),new Bo("QChatMedia::setSelectedCameraDevice error",rr)})},kt.setSelectedPlayoutDevice=function(Oe){var Lt=this;return this._checkConnectState(),On({deviceId:{type:"string",allowEmpty:!1}},Oe),this.rtcController.setSelectedPlayoutDevice(Oe.deviceId).then(function(rr){return rr.data},function(rr){throw Lt.logger.error("QChatMedia::setSelectedPlayoutDevice error",rr),new Bo("QChatMedia::setSelectedPlayoutDevice error",rr)})},kt.setSelectedRecordDevice=function(Oe){var Lt=this;return this._checkConnectState(),On({deviceId:{type:"string",allowEmpty:!1}},Oe),this.rtcController.setSelectedRecordDevice(Oe.deviceId).then(function(rr){return rr.data},function(rr){throw Lt.logger.error("QChatMedia::setSelectedRecordDevice error",rr),new Bo("QChatMedia::setSelectedRecordDevice error",rr)})},kt.getRTCMembers=function(){var Oe,Lt;return this._checkConnectState(),Ro(Oe=ki(Lt=this.roomContext.remoteMembers).call(Lt,function(rr){return rr.isInRtcChannel})).call(Oe,function(rr){return{accid:rr.uuid,isAudioOn:!!rr.isAudioOn,isVideoOn:!!rr.isVideoOn,isSharingScreen:!!rr.isSharingScreen,properties:rr.properties}})},kt.subscribeRemoteVideoSubStream=function(Oe){var Lt;return zr(this,void 0,void 0,_r.mark(function rr(){return _r.wrap(function(pr){for(;;)switch(pr.prev=pr.next){case 0:this._checkConnectState(),On({accid:{type:"string",allowEmpty:!1}},Oe),pr.prev=2,(Lt=this.rtcController)===null||Lt===void 0||Lt.subscribeRemoteVideoSubStream(Oe.accid),pr.next=10;break;case 6:throw pr.prev=6,pr.t0=pr.catch(2),this.logger.error("QChatMedia::subscribeRemoteVideoSubStream error",pr.t0),new Bo("QChatMedia::subscribeRemoteVideoSubStream error",pr.t0);case 10:case"end":return pr.stop()}},rr,this,[[2,6]])}))},kt.unsubscribeRemoteVideoSubStream=function(Oe){var Lt;return zr(this,void 0,void 0,_r.mark(function rr(){return _r.wrap(function(pr){for(;;)switch(pr.prev=pr.next){case 0:this._checkConnectState(),On({accid:{type:"string",allowEmpty:!1}},Oe),pr.prev=2,(Lt=this.rtcController)===null||Lt===void 0||Lt.unsubscribeRemoteVideoSubStream(Oe.accid),pr.next=10;break;case 6:throw pr.prev=6,pr.t0=pr.catch(2),this.logger.error("QChatMedia::unsubscribeRemoteVideoSubStream error",pr.t0),new Bo("QChatMedia::unsubscribeRemoteVideoSubStream error",pr.t0);case 10:case"end":return pr.stop()}},rr,this,[[2,6]])}))},kt.muteAllAudio=function(){var Oe;return zr(this,void 0,void 0,_r.mark(function Lt(){return _r.wrap(function(Pt){for(;;)switch(Pt.prev=Pt.next){case 0:return this._checkConnectState(),Pt.next=3,this._checkPermission({serverId:this.serverId,channelId:this.channelId,auth:"RTCChannelOpenCloseEveryoneMicrophone"});case 3:if(Pt.sent){Pt.next=7;break}return this.logger.error("QChatMedia::connect::auth your have not RTCChannelOpenCloseEveryoneMicrophone auth"),Pt.abrupt("return");case 7:Pt.prev=7,(Oe=this.roomContext)===null||Oe===void 0||Oe.updateRoomProperty("audioOff",Ao({value:Zs.offNotAllowSelfOn+"_"+new Date().getTime()})),Pt.next=15;break;case 11:throw Pt.prev=11,Pt.t0=Pt.catch(7),this.logger.error("QChatMedia::muteAllAudio error",Pt.t0),new Bo("QChatMedia::muteAllAudio error",Pt.t0);case 15:case"end":return Pt.stop()}},Lt,this,[[7,11]])}))},kt.muteAllVideo=function(){var Oe;return zr(this,void 0,void 0,_r.mark(function Lt(){return _r.wrap(function(Pt){for(;;)switch(Pt.prev=Pt.next){case 0:return this._checkConnectState(),Pt.next=3,this._checkPermission({serverId:this.serverId,channelId:this.channelId,auth:"RTCChannelOpenCloseEveryoneCamera"});case 3:if(Pt.sent){Pt.next=7;break}return this.logger.error("QChatMedia::connect::auth your have not RTCChannelOpenCloseEveryoneCamera auth"),Pt.abrupt("return");case 7:Pt.prev=7,(Oe=this.roomContext)===null||Oe===void 0||Oe.updateRoomProperty("videoOff",Ao({value:Zs.offNotAllowSelfOn+"_"+new Date().getTime()})),Pt.next=15;break;case 11:throw Pt.prev=11,Pt.t0=Pt.catch(7),this.logger.error("QChatMedia::muteAllVideo error",Pt.t0),new Bo("QChatMedia::muteAllVideo error",Pt.t0);case 15:case"end":return Pt.stop()}},Lt,this,[[7,11]])}))},kt.unMuteAllAudio=function(){var Oe;return zr(this,void 0,void 0,_r.mark(function Lt(){return _r.wrap(function(Pt){for(;;)switch(Pt.prev=Pt.next){case 0:return this._checkConnectState(),Pt.next=3,this._checkPermission({serverId:this.serverId,channelId:this.channelId,auth:"RTCChannelOpenCloseEveryoneMicrophone"});case 3:if(Pt.sent){Pt.next=7;break}return this.logger.error("QChatMedia::connect::auth your have not RTCChannelOpenCloseEveryoneMicrophone auth"),Pt.abrupt("return");case 7:Pt.prev=7,(Oe=this.roomContext)===null||Oe===void 0||Oe.updateRoomProperty("audioOff",Ao({value:Zs.disable+"_"+new Date().getTime()})),Pt.next=15;break;case 11:throw Pt.prev=11,Pt.t0=Pt.catch(7),this.logger.error("QChatMedia::unMuteAllAudio error",Pt.t0),new Bo("QChatMedia::unMuteAllAudio error",Pt.t0);case 15:case"end":return Pt.stop()}},Lt,this,[[7,11]])}))},kt.unMuteAllVideo=function(){var Oe;return zr(this,void 0,void 0,_r.mark(function Lt(){return _r.wrap(function(Pt){for(;;)switch(Pt.prev=Pt.next){case 0:return this._checkConnectState(),Pt.next=3,this._checkPermission({serverId:this.serverId,channelId:this.channelId,auth:"RTCChannelOpenCloseEveryoneCamera"});case 3:if(Pt.sent){Pt.next=7;break}return this.logger.error("QChatMedia::connect::auth your have not RTCChannelOpenCloseEveryoneCamera auth"),Pt.abrupt("return");case 7:Pt.prev=7,(Oe=this.roomContext)===null||Oe===void 0||Oe.updateRoomProperty("videoOff",Ao({value:Zs.disable+"_"+new Date().getTime()})),Pt.next=15;break;case 11:throw Pt.prev=11,Pt.t0=Pt.catch(7),this.logger.error("QChatMedia::unMuteAllVideo error",Pt.t0),new Bo("QChatMedia::unMuteAllVideo error",Pt.t0);case 15:case"end":return Pt.stop()}},Lt,this,[[7,11]])}))},Ne}(Vl),$C={"1_2":"heartbeat","24_2":"qchatLogin","24_4":"qchatExit","24_5":"qchatBeKicked","24_8":"qchatMultiSpotLogin","24_9":"qchatKick","24_19":"qchatSync"},yp={qchatLoginTag:{appkey:1,account:2,authType:3,token:4,loginExt:5,clientType:6,clientSession:7,deviceId:8,sdkVersion:9,sdkType:10,userAgent:11,customTag:12,customClientType:13,sdkHumanVersion:14,pushTokenName:20,pushToken:21,pushkitTokenName:22,pushkitToken:23,deviceInfo:24,customPushContentType:25,os:30,mac:31,bundleId:32,simCarrierCode:33,simCountryCode:34,networkCode:35,browser:36,deviceModel:37,androidid:38,imei:39,idfv:40,openuuid:41,pushType:100,hasTokenPreviously:101,consid:102,clientIP:103,clientPort:104,loginTime:105}},Kl=Qc(yp),jC={heartbeat:{sid:1,cid:2,service:"qchatAuth"},qchatLogin:{sid:24,cid:2,service:"qchatAuth",params:[{type:"Property",name:"qchatLoginReqTag",reflectMapper:yp.qchatLoginTag}],response:[{type:"Property",name:"qchatLoginResTag",reflectMapper:Kl.qchatLoginTag},{type:"PropertyArray",name:"qchatMultiLoginResult",reflectMapper:Kl.qchatLoginTag}]},qchatExit:{sid:24,cid:4,service:"qchatAuth"},qchatBeKicked:{sid:24,cid:5,service:"qchatAuth",response:[{type:"Property",name:"beKickedTag",reflectMapper:{1:"clientType",2:"reason",3:"ext",4:"customClientType"}}]},qchatMultiSpotLogin:{sid:24,cid:8,service:"qchatAuth",response:[{type:"Number",name:"state"},{type:"Property",name:"qchatLoginResTag",reflectMapper:Kl.qchatLoginTag}]},qchatKick:{sid:24,cid:9,service:"qchatAuth",params:[{type:"StrArray",name:"deviceIds"}],response:[{type:"StrArray",name:"deviceIds"}]},qchatSync:{sid:24,cid:19,service:"qchatAuth",isNoResponse:!0,params:[{type:"Property",name:"qchatSyncTag",reflectMapper:{systemNotification:1,pushConfig:2}}],response:[{type:"Number",name:"timetag"}]}},DC={debugLevel:"off",needReconnect:!0,reconnectionAttempts:wg,isAbtestEnable:!0,abtestUrl:"https://abt-online.netease.im/v1/api/abt/client/getExperimentInfo",abtestProjectKey:"imElite_sdk_abtest_web"},bp=function(pe){function Ne($e,Oe){var Lt;return Oe===void 0&&(Oe={cloudStorageConfig:{}}),(Lt=pe.call(this,$e)||this).instanceName="QChat",Lt.account="",Lt.options={},Lt.qchatAuth={},Lt.qchatServer={},Lt.qchatChannel={},Lt.qchatMsg={},Lt.qchatRole={},Lt.qchatMedia={},Lt.cloudStorage={},Lt.setOptions($e),oc({cmdMap:$C,cmdConfig:jC}),oc({cmdMap:Uy,cmdConfig:qh}),Lt.qchatAuth=new BC(k(Lt)),Lt.qchatServer=new tC(k(Lt)),Lt.qchatChannel=new TC(k(Lt)),Lt.qchatMsg=new hb(k(Lt)),Lt.qchatRole=new kC(k(Lt)),Lt.qchatMedia=new LC(k(Lt)),Lt.cloudStorage=new Vy(k(Lt),Vn({storageKeyPrefix:Lt.instanceName},Oe.cloudStorageConfig)),Oe&&Lt.setOtherOptions(Oe),Ne.instance=k(Lt),Lt}ea(Ne,pe),Ne.getInstance=function(Oe,Lt){if(!Ne.instance){if(Oe)return new Ne(Oe,Lt);throw new Error("Instance not exist, please input options")}if(Oe){if(Ne.instance.options.account===Oe.account&&Ne.instance.options.appkey===Oe.appkey)return Ne.instance.setOptions(Oe),Lt&&Ne.instance.setOtherOptions(Lt),Ne.instance;throw new Error("Unexpected login")}return Ne.instance};var kt=Ne.prototype;return kt.connect=function(Oe){Oe===void 0&&(Oe={});var Lt=Cs(null,{connect:{get:function(){return pe.prototype.connect}}});return zr(this,void 0,void 0,_r.mark(function rr(){var Pt,pr,yr;return _r.wrap(function(Rr){for(;;)switch(Rr.prev=Rr.next){case 0:if(/^(unconnected|waitReconnect)$/.test(this.status)){Rr.next=4;break}return Pt="QChat status is "+this.status+", and would not connect",this.logger.warn(Pt),Rr.abrupt("return",xo.reject(Pt));case 4:return pr=Oe.isAutoReconnect||!1,Rr.next=7,Lt.connect.call(this,{linkUrls:this.options.linkAddresses,isAutoReconnect:pr});case 7:return Rr.prev=7,Rr.next=10,this.qchatAuth.doLogin(pr);case 10:yr=Rr.sent,Rr.next=21;break;case 13:if(Rr.prev=13,Rr.t0=Rr.catch(7),this.logger.warn("qchat connect:: login failed",Rr.t0),this.retryCount!==0){Rr.next=19;break}throw this.doDisconnect(Ls.ACTIVE,"FailedToInitializeLogin"),Rr.t0;case 19:return this.doDisconnect(Ls.OFFLINE,"ReconnectLoginFailed"),Rr.abrupt("return");case 21:return this.status="logined",yr.loginResult.appkey=this.options.appkey,this.eventBus.emit("logined",yr.loginResult),this.emit("logined",yr.loginResult),yr.multiLoginResults&&yr.multiLoginResults.length>0&&this.emit("multiSpotLogin",yr.multiLoginResults),this.resetConnectStatus(),this.ping(),Rr.prev=28,Rr.next=31,this.cloudStorage.init();case 31:Rr.next=36;break;case 33:Rr.prev=33,Rr.t1=Rr.catch(28),this.logger.error("NIM:login cloudStorage init failed ",Rr.t1);case 36:return Rr.next=38,this.qchatAuth.sync();case 38:case"end":return Rr.stop()}},rr,this,[[7,13],[28,33]])}))},kt.login=function(Oe){return Oe===void 0&&(Oe={}),this.connect(Oe)},kt.setOptions=function(Oe){On({account:{type:"string"},appkey:{type:"string"},token:{type:"string"},linkAddresses:{type:"array",itemType:"string",min:1},needReconnect:{type:"boolean",required:!1},reconnectionAttempts:{type:"number",required:!1},debugLevel:{type:"enum",values:Np,required:!1}},Oe),this.logger.log("QChat::setOptions options is",Oe),this.account=Oe.account,this.options=Vn(Vn({},DC),Oe)},kt.setOtherOptions=function(Oe){var Lt;!((Lt=Oe==null?void 0:Oe.QChatMedia)===null||Lt===void 0)&&Lt.neroom&&this.qchatMedia.setNeroom(Oe.QChatMedia.neroom)},kt.onMessage=function(Oe){var Lt,rr,Pt=pe.prototype.onMessage.call(this,Oe);if(Pt){var pr=Pt.raw.ser,yr=this.sendingCmdMap.get(pr);if(yr&&yr.cmd===Pt.cmd){var Pr=yr.callback,Rr=yr.timer,Vr=yr.params;if(clearTimeout(Rr),Pt.params=Vr,this.sendingCmdMap.delete(pr),Pt.cmd==="heartbeat")return void Pr[0]();var Dr=(Lt=this[Pt.service])===null||Lt===void 0?void 0:Lt.process(Pt);Dr&&typeof Dr.then=="function"?Dr.then(function(Xr){Pr[0](Xr)}).catch(function(Xr){Pr[1](Xr)}):(this.logger.log("imsocket:: handlerFn without promise",Pt.service,Pt.cmd),Pr[0]())}else(rr=this[Pt.service])===null||rr===void 0||rr.process(Pt)}},kt.disconnect=function(){var Oe=this;switch(this.status){case"logined":return this.sendCmd("qchatExit").then(function(){pe.prototype.doDisconnect.call(Oe,Ls.ACTIVE,"UserActiveDisconnect")});case"connected":case"connecting":case"waitReconnect":return pe.prototype.doDisconnect.call(this,Ls.ACTIVE,"UserActiveDisconnect"),xo.resolve();case"unconnected":case"destroyed":return xo.resolve()}},kt.logout=function(){return this.disconnect()},kt.destroy=function(){return Ne.instance=null,pe.prototype.destroy.call(this)},kt.kickOtherClients=function(Oe){return On({deviceIds:{type:"array",itemType:"string"}},Oe),this.qchatAuth.kick(Oe)},Ne}(Hd);bp.instance=null;var UC=Math.min,fv=[].lastIndexOf,Nf=!!fv&&1/[1].lastIndexOf(1,-0)<0,Of=fi("lastIndexOf"),yb=Nf||!Of?function(Ne){if(Nf)return ue(fv,this,arguments)||0;var kt=wr(this),$e=Za(kt),Oe=$e-1;for(arguments.length>1&&(Oe=UC(Oe,uc(arguments[1]))),Oe<0&&(Oe=$e+Oe);Oe>=0;Oe--)if(Oe in kt&&kt[Oe]===Ne)return Oe||0;return-1}:fv;xn({target:"Array",proto:!0,forced:yb!==[].lastIndexOf},{lastIndexOf:yb});var VC=sa("Array").lastIndexOf,mv=Array.prototype,bb=function(pe){var Ne=pe.lastIndexOf;return pe===mv||sr(mv,pe)&&Ne===mv.lastIndexOf?VC:Ne},il=g(function(pe,Ne){(function(){var kt={function:!0,object:!0}[typeof window]&&window||this,$e=Ne,Oe=pe&&!pe.nodeType&&pe,Lt=$e&&Oe&&typeof e=="object"&&e;!Lt||Lt.global!==Lt&&Lt.window!==Lt&&Lt.self!==Lt||(kt=Lt);var rr=Math.pow(2,53)-1,Pt=/\bOpera/,pr=Object.prototype,yr=pr.hasOwnProperty,Pr=pr.toString;function Rr(Gn){return(Gn=String(Gn)).charAt(0).toUpperCase()+Gn.slice(1)}function Vr(Gn){return Gn=Dn(Gn),/^(?:webOS|i(?:OS|P))/.test(Gn)?Gn:Rr(Gn)}function Dr(Gn,$n){for(var ho in Gn)yr.call(Gn,ho)&&$n(Gn[ho],ho,Gn)}function Xr(Gn){return Gn==null?Rr(Gn):Pr.call(Gn).slice(8,-1)}function kn(Gn){return String(Gn).replace(/([ -])(?!$)/g,"$1?")}function Tn(Gn,$n){var ho=null;return function(oa,so){var Gr=-1,Kn=oa?oa.length:0;if(typeof Kn=="number"&&Kn>-1&&Kn<=rr)for(;++Gr<Kn;)so(oa[Gr],Gr,oa);else Dr(oa,so)}(Gn,function(co,oa){ho=$n(ho,co,oa,Gn)}),ho}function Dn(Gn){return String(Gn).replace(/^ +| +$/g,"")}var Fn=function Gn($n){var ho=kt,co=$n&&typeof $n=="object"&&Xr($n)!="String";co&&(ho=$n,$n=null);var oa=ho.navigator||{},so=oa.userAgent||"";$n||($n=so);var Gr,Kn,ro=co?!!oa.likeChrome:/\bChrome\b/.test($n)&&!/internal|\n/i.test(Pr.toString()),Hn="Object",Ln=co?Hn:"ScriptBridgingProxyObject",eo=co?Hn:"Environment",lo=co&&ho.java?"JavaPackage":Xr(ho.java),So=co?Hn:"RuntimeObject",Co=/\bJava/.test(lo)&&ho.java,aa=Co&&Xr(ho.environment)==eo,No=Co?"a":"α",Sa=Co?"b":"β",Lo=ho.document||{},Wo=ho.operamini||ho.opera,Ta=Pt.test(Ta=co&&Wo?Wo["[[Class]]"]:Xr(Wo))?Ta:Wo=null,Yi=$n,Qo=[],Xi=null,cs=$n==so,Io=cs&&Wo&&typeof Wo.version=="function"&&Wo.version(),ma=function(Ya){return Tn(Ya,function(ga,La){return ga||RegExp("\\b"+(La.pattern||kn(La))+"\\b","i").exec($n)&&(La.label||La)})}([{label:"EdgeHTML",pattern:"Edge"},"Trident",{label:"WebKit",pattern:"AppleWebKit"},"iCab","Presto","NetFront","Tasman","KHTML","Gecko"]),mo=function(Ya){return Tn(Ya,function(ga,La){return ga||RegExp("\\b"+(La.pattern||kn(La))+"\\b","i").exec($n)&&(La.label||La)})}(["Adobe AIR","Arora","Avant Browser","Breach","Camino","Electron","Epiphany","Fennec","Flock","Galeon","GreenBrowser","iCab","Iceweasel","K-Meleon","Konqueror","Lunascape","Maxthon",{label:"Microsoft Edge",pattern:"(?:Edge|Edg|EdgA|EdgiOS)"},"Midori","Nook Browser","PaleMoon","PhantomJS","Raven","Rekonq","RockMelt",{label:"Samsung Internet",pattern:"SamsungBrowser"},"SeaMonkey",{label:"Silk",pattern:"(?:Cloud9|Silk-Accelerated)"},"Sleipnir","SlimBrowser",{label:"SRWare Iron",pattern:"Iron"},"Sunrise","Swiftfox","Vivaldi","Waterfox","WebPositive",{label:"Yandex Browser",pattern:"YaBrowser"},{label:"UC Browser",pattern:"UCBrowser"},"Opera Mini",{label:"Opera Mini",pattern:"OPiOS"},"Opera",{label:"Opera",pattern:"OPR"},"Chromium","Chrome",{label:"Chrome",pattern:"(?:HeadlessChrome)"},{label:"Chrome Mobile",pattern:"(?:CriOS|CrMo)"},{label:"Firefox",pattern:"(?:Firefox|Minefield)"},{label:"Firefox for iOS",pattern:"FxiOS"},{label:"IE",pattern:"IEMobile"},{label:"IE",pattern:"MSIE"},"Safari"]),ta=Tb([{label:"BlackBerry",pattern:"BB10"},"BlackBerry",{label:"Galaxy S",pattern:"GT-I9000"},{label:"Galaxy S2",pattern:"GT-I9100"},{label:"Galaxy S3",pattern:"GT-I9300"},{label:"Galaxy S4",pattern:"GT-I9500"},{label:"Galaxy S5",pattern:"SM-G900"},{label:"Galaxy S6",pattern:"SM-G920"},{label:"Galaxy S6 Edge",pattern:"SM-G925"},{label:"Galaxy S7",pattern:"SM-G930"},{label:"Galaxy S7 Edge",pattern:"SM-G935"},"Google TV","Lumia","iPad","iPod","iPhone","Kindle",{label:"Kindle Fire",pattern:"(?:Cloud9|Silk-Accelerated)"},"Nexus","Nook","PlayBook","PlayStation Vita","PlayStation","TouchPad","Transformer",{label:"Wii U",pattern:"WiiU"},"Wii","Xbox One",{label:"Xbox 360",pattern:"Xbox"},"Xoom"]),Ss=function(Ya){return Tn(Ya,function(ga,La,Sp){return ga||(La[ta]||La[/^[a-z]+(?: +[a-z]+\b)*/i.exec(ta)]||RegExp("\\b"+kn(Sp)+"(?:\\b|\\w*\\d)","i").exec($n))&&Sp})}({Apple:{iPad:1,iPhone:1,iPod:1},Alcatel:{},Archos:{},Amazon:{Kindle:1,"Kindle Fire":1},Asus:{Transformer:1},"Barnes & Noble":{Nook:1},BlackBerry:{PlayBook:1},Google:{"Google TV":1,Nexus:1},HP:{TouchPad:1},HTC:{},Huawei:{},Lenovo:{},LG:{},Microsoft:{Xbox:1,"Xbox One":1},Motorola:{Xoom:1},Nintendo:{"Wii U":1,Wii:1},Nokia:{Lumia:1},Oppo:{},Samsung:{"Galaxy S":1,"Galaxy S2":1,"Galaxy S3":1,"Galaxy S4":1},Sony:{PlayStation:1,"PlayStation Vita":1},Xiaomi:{Mi:1,Redmi:1}}),vo=function(Ya){return Tn(Ya,function(ga,La){var Sp=La.pattern||kn(La);return!ga&&(ga=RegExp("\\b"+Sp+"(?:/[\\d.]+|[ \\w.]*)","i").exec($n))&&(ga=function(bi,Tp,Rf){var hv={"10.0":"10",6.4:"10 Technical Preview",6.3:"8.1",6.2:"8",6.1:"Server 2008 R2 / 7","6.0":"Server 2008 / Vista",5.2:"Server 2003 / XP 64-bit",5.1:"XP",5.01:"2000 SP1","5.0":"2000","4.0":"NT","4.90":"ME"};return Tp&&Rf&&/^Win/i.test(bi)&&!/^Windows Phone /i.test(bi)&&(hv=hv[/[\d.]+$/.exec(bi)])&&(bi="Windows "+hv),bi=String(bi),Tp&&Rf&&(bi=bi.replace(RegExp(Tp,"i"),Rf)),Vr(bi.replace(/ ce$/i," CE").replace(/\bhpw/i,"web").replace(/\bMacintosh\b/,"Mac OS").replace(/_PowerPC\b/i," OS").replace(/\b(OS X) [^ \d]+/i,"$1").replace(/\bMac (OS X)\b/,"$1").replace(/\/(\d)/," $1").replace(/_/g,".").replace(/(?: BePC|[ .]*fc[ \d.]+)$/i,"").replace(/\bx86\.64\b/gi,"x86_64").replace(/\b(Windows Phone) OS\b/,"$1").replace(/\b(Chrome OS \w+) [\d.]+\b/,"$1").split(" on ")[0])}(ga,Sp,La.label||La)),ga})}(["Windows Phone","KaiOS","Android","CentOS",{label:"Chrome OS",pattern:"CrOS"},"Debian",{label:"DragonFly BSD",pattern:"DragonFly"},"Fedora","FreeBSD","Gentoo","Haiku","Kubuntu","Linux Mint","OpenBSD","Red Hat","SuSE","Ubuntu","Xubuntu","Cygwin","Symbian OS","hpwOS","webOS ","webOS","Tablet OS","Tizen","Linux","Mac OS X","Macintosh","Mac","Windows 98;","Windows "]);function Tb(ti){return Tn(ti,function(Ya,ga){var La=ga.pattern||kn(ga);return!Ya&&(Ya=RegExp("\\b"+La+" *\\d+[.\\w_]*","i").exec($n)||RegExp("\\b"+La+" *\\w+-[\\w]*","i").exec($n)||RegExp("\\b"+La+"(?:; *(?:[a-z]+[_-])?[a-z]+\\d+|[^ ();-]*)","i").exec($n))&&((Ya=String(ga.label&&!RegExp(La,"i").test(ga.label)?ga.label:Ya).split("/"))[1]&&!/[\d.]+/.test(Ya[0])&&(Ya[0]+=" "+Ya[1]),ga=ga.label||ga,Ya=Vr(Ya[0].replace(RegExp(La,"i"),ga).replace(RegExp("; *(?:"+ga+"[_-])?","i")," ").replace(RegExp("("+ga+")[-_.]?(\\w)","i"),"$1 $2"))),Ya})}function gv(ti){return Tn(ti,function(Ya,ga){return Ya||(RegExp(ga+"(?:-[\\d.]+/|(?: for [\\w-]+)?[ /-])([\\d.]+[^ ();/_-]*)","i").exec($n)||0)[1]||null})}if(ma&&(ma=[ma]),/\bAndroid\b/.test(vo)&&!ta&&(Gr=/\bAndroid[^;]*;(.*?)(?:Build|\) AppleWebKit)\b/i.exec($n))&&(ta=Dn(Gr[1]).replace(/^[a-z]{2}-[a-z]{2};\s*/i,"")||null),Ss&&!ta?ta=Tb([Ss]):Ss&&ta&&(ta=ta.replace(RegExp("^("+kn(Ss)+")[-_.\\s]","i"),Ss+" ").replace(RegExp("^("+kn(Ss)+")[-_.]?(\\w)","i"),Ss+" $2")),(Gr=/\bGoogle TV\b/.exec(ta))&&(ta=Gr[0]),/\bSimulator\b/i.test($n)&&(ta=(ta?ta+" ":"")+"Simulator"),mo=="Opera Mini"&&/\bOPiOS\b/.test($n)&&Qo.push("running in Turbo/Uncompressed mode"),mo=="IE"&&/\blike iPhone OS\b/.test($n)?(Ss=(Gr=Gn($n.replace(/like iPhone OS/,""))).manufacturer,ta=Gr.product):/^iP/.test(ta)?(mo||(mo="Safari"),vo="iOS"+((Gr=/ OS ([\d_]+)/i.exec($n))?" "+Gr[1].replace(/_/g,"."):"")):mo=="Konqueror"&&/^Linux\b/i.test(vo)?vo="Kubuntu":Ss&&Ss!="Google"&&(/Chrome/.test(mo)&&!/\bMobile Safari\b/i.test($n)||/\bVita\b/.test(ta))||/\bAndroid\b/.test(vo)&&/^Chrome/.test(mo)&&/\bVersion\//i.test($n)?(mo="Android Browser",vo=/\bAndroid\b/.test(vo)?vo:"Android"):mo=="Silk"?(/\bMobi/i.test($n)||(vo="Android",Qo.unshift("desktop mode")),/Accelerated *= *true/i.test($n)&&Qo.unshift("accelerated")):mo=="UC Browser"&&/\bUCWEB\b/.test($n)?Qo.push("speed mode"):mo=="PaleMoon"&&(Gr=/\bFirefox\/([\d.]+)\b/.exec($n))?Qo.push("identifying as Firefox "+Gr[1]):mo=="Firefox"&&(Gr=/\b(Mobile|Tablet|TV)\b/i.exec($n))?(vo||(vo="Firefox OS"),ta||(ta=Gr[1])):!mo||(Gr=!/\bMinefield\b/i.test($n)&&/\b(?:Firefox|Safari)\b/.exec(mo))?(mo&&!ta&&/[\/,]|^[^(]+?\)/.test($n.slice($n.indexOf(Gr+"/")+8))&&(mo=null),(Gr=ta||Ss||vo)&&(ta||Ss||/\b(?:Android|Symbian OS|Tablet OS|webOS)\b/.test(vo))&&(mo=/[a-z]+(?: Hat)?/i.exec(/\bAndroid\b/.test(vo)?vo:Gr)+" Browser")):mo=="Electron"&&(Gr=(/\bChrome\/([\d.]+)\b/.exec($n)||0)[1])&&Qo.push("Chromium "+Gr),Io||(Io=gv(["(?:Cloud9|CriOS|CrMo|Edge|Edg|EdgA|EdgiOS|FxiOS|HeadlessChrome|IEMobile|Iron|Opera ?Mini|OPiOS|OPR|Raven|SamsungBrowser|Silk(?!/[\\d.]+$)|UCBrowser|YaBrowser)","Version",kn(mo),"(?:Firefox|Minefield|NetFront)"])),(Gr=(ma=="iCab"&&parseFloat(Io)>3?"WebKit":/\bOpera\b/.test(mo)&&(/\bOPR\b/.test($n)?"Blink":"Presto"))||/\b(?:Midori|Nook|Safari)\b/i.test($n)&&!/^(?:Trident|EdgeHTML)$/.test(ma)&&"WebKit"||!ma&&/\bMSIE\b/i.test($n)&&(vo=="Mac OS"?"Tasman":"Trident")||ma=="WebKit"&&/\bPlayStation\b(?! Vita\b)/i.test(mo)&&"NetFront")&&(ma=[Gr]),mo=="IE"&&(Gr=(/; *(?:XBLWP|ZuneWP)(\d+)/i.exec($n)||0)[1])?(mo+=" Mobile",vo="Windows Phone "+(/\+$/.test(Gr)?Gr:Gr+".x"),Qo.unshift("desktop mode")):/\bWPDesktop\b/i.test($n)?(mo="IE Mobile",vo="Windows Phone 8.x",Qo.unshift("desktop mode"),Io||(Io=(/\brv:([\d.]+)/.exec($n)||0)[1])):mo!="IE"&&ma=="Trident"&&(Gr=/\brv:([\d.]+)/.exec($n))&&(mo&&Qo.push("identifying as "+mo+(Io?" "+Io:"")),mo="IE",Io=Gr[1]),cs){if(function(Ya,ga){var La=Ya!=null?typeof Ya[ga]:"number";return!(/^(?:boolean|number|string|undefined)$/.test(La)||La=="object"&&!Ya[ga])}(ho,"global"))if(Co&&(Yi=(Gr=Co.lang.System).getProperty("os.arch"),vo=vo||Gr.getProperty("os.name")+" "+Gr.getProperty("os.version")),aa){try{Io=ho.require("ringo/engine").version.join("."),mo="RingoJS"}catch{(Gr=ho.system)&&Gr.global.system==ho.system&&(mo="Narwhal",vo||(vo=Gr[0].os||null))}mo||(mo="Rhino")}else typeof ho.process=="object"&&!ho.process.browser&&(Gr=ho.process)&&(typeof Gr.versions=="object"&&(typeof Gr.versions.electron=="string"?(Qo.push("Node "+Gr.versions.node),mo="Electron",Io=Gr.versions.electron):typeof Gr.versions.nw=="string"&&(Qo.push("Chromium "+Io,"Node "+Gr.versions.node),mo="NW.js",Io=Gr.versions.nw)),mo||(mo="Node.js",Yi=Gr.arch,vo=Gr.platform,Io=(Io=/[\d.]+/.exec(Gr.version))?Io[0]:null));else Xr(Gr=ho.runtime)==Ln?(mo="Adobe AIR",vo=Gr.flash.system.Capabilities.os):Xr(Gr=ho.phantom)==So?(mo="PhantomJS",Io=(Gr=Gr.version||null)&&Gr.major+"."+Gr.minor+"."+Gr.patch):typeof Lo.documentMode=="number"&&(Gr=/\bTrident\/(\d+)/i.exec($n))?(Io=[Io,Lo.documentMode],(Gr=+Gr[1]+4)!=Io[1]&&(Qo.push("IE "+Io[1]+" mode"),ma&&(ma[1]=""),Io[1]=Gr),Io=mo=="IE"?String(Io[1].toFixed(1)):Io[0]):typeof Lo.documentMode=="number"&&/^(?:Chrome|Firefox)\b/.test(mo)&&(Qo.push("masking as "+mo+" "+Io),mo="IE",Io="11.0",ma=["Trident"],vo="Windows");vo=vo&&Vr(vo)}if(Io&&(Gr=/(?:[ab]|dp|pre|[ab]\d+pre)(?:\d+\+?)?$/i.exec(Io)||/(?:alpha|beta)(?: ?\d)?/i.exec($n+";"+(cs&&oa.appMinorVersion))||/\bMinefield\b/i.test($n)&&"a")&&(Xi=/b/i.test(Gr)?"beta":"alpha",Io=Io.replace(RegExp(Gr+"\\+?$"),"")+(Xi=="beta"?Sa:No)+(/\d+\+?/.exec(Gr)||"")),mo=="Fennec"||mo=="Firefox"&&/\b(?:Android|Firefox OS|KaiOS)\b/.test(vo))mo="Firefox Mobile";else if(mo=="Maxthon"&&Io)Io=Io.replace(/\.[\d.]+/,".x");else if(/\bXbox\b/i.test(ta))ta=="Xbox 360"&&(vo=null),ta=="Xbox 360"&&/\bIEMobile\b/.test($n)&&Qo.unshift("mobile mode");else if(!/^(?:Chrome|IE|Opera)$/.test(mo)&&(!mo||ta||/Browser|Mobi/.test(mo))||vo!="Windows CE"&&!/Mobi/i.test($n))if(mo=="IE"&&cs)try{ho.external===null&&Qo.unshift("platform preview")}catch{Qo.unshift("embedded")}else(/\bBlackBerry\b/.test(ta)||/\bBB10\b/.test($n))&&(Gr=(RegExp(ta.replace(/ +/g," *")+"/([.\\d]+)","i").exec($n)||0)[1]||Io)?(vo=((Gr=[Gr,/BB10/.test($n)])[1]?(ta=null,Ss="BlackBerry"):"Device Software")+" "+Gr[0],Io=null):this!=Dr&&ta!="Wii"&&(cs&&Wo||/Opera/.test(mo)&&/\b(?:MSIE|Firefox)\b/i.test($n)||mo=="Firefox"&&/\bOS X (?:\d+\.){2,}/.test(vo)||mo=="IE"&&(vo&&!/^Win/.test(vo)&&Io>5.5||/\bWindows XP\b/.test(vo)&&Io>8||Io==8&&!/\bTrident\b/.test($n)))&&!Pt.test(Gr=Gn.call(Dr,$n.replace(Pt,"")+";"))&&Gr.name&&(Gr="ing as "+Gr.name+((Gr=Gr.version)?" "+Gr:""),Pt.test(mo)?(/\bIE\b/.test(Gr)&&vo=="Mac OS"&&(vo=null),Gr="identify"+Gr):(Gr="mask"+Gr,mo=Ta?Vr(Ta.replace(/([a-z])([A-Z])/g,"$1 $2")):"Opera",/\bIE\b/.test(Gr)&&(vo=null),cs||(Io=null)),ma=["Presto"],Qo.push(Gr));else mo+=" Mobile";(Gr=(/\bAppleWebKit\/([\d.]+\+?)/i.exec($n)||0)[1])&&(Gr=[parseFloat(Gr.replace(/\.(\d)$/,".0$1")),Gr],mo=="Safari"&&Gr[1].slice(-1)=="+"?(mo="WebKit Nightly",Xi="alpha",Io=Gr[1].slice(0,-1)):Io!=Gr[1]&&Io!=(Gr[2]=(/\bSafari\/([\d.]+\+?)/i.exec($n)||0)[1])||(Io=null),Gr[1]=(/\b(?:Headless)?Chrome\/([\d.]+)/i.exec($n)||0)[1],Gr[0]==537.36&&Gr[2]==537.36&&parseFloat(Gr[1])>=28&&ma=="WebKit"&&(ma=["Blink"]),cs&&(ro||Gr[1])?(ma&&(ma[1]="like Chrome"),Gr=Gr[1]||((Gr=Gr[0])<530?1:Gr<532?2:Gr<532.05?3:Gr<533?4:Gr<534.03?5:Gr<534.07?6:Gr<534.1?7:Gr<534.13?8:Gr<534.16?9:Gr<534.24?10:Gr<534.3?11:Gr<535.01?12:Gr<535.02?"13+":Gr<535.07?15:Gr<535.11?16:Gr<535.19?17:Gr<536.05?18:Gr<536.1?19:Gr<537.01?20:Gr<537.11?"21+":Gr<537.13?23:Gr<537.18?24:Gr<537.24?25:Gr<537.36?26:ma!="Blink"?"27":"28")):(ma&&(ma[1]="like Safari"),Gr=(Gr=Gr[0])<400?1:Gr<500?2:Gr<526?3:Gr<533?4:Gr<534?"4+":Gr<535?5:Gr<537?6:Gr<538?7:Gr<601?8:Gr<602?9:Gr<604?10:Gr<606?11:Gr<608?12:"12"),ma&&(ma[1]+=" "+(Gr+=typeof Gr=="number"?".x":/[.+]/.test(Gr)?"":"+")),mo=="Safari"&&(!Io||parseInt(Io)>45)?Io=Gr:mo=="Chrome"&&/\bHeadlessChrome/i.test($n)&&Qo.unshift("headless")),mo=="Opera"&&(Gr=/\bzbov|zvav$/.exec(vo))?(mo+=" ",Qo.unshift("desktop mode"),Gr=="zvav"?(mo+="Mini",Io=null):mo+="Mobile",vo=vo.replace(RegExp(" *"+Gr+"$"),"")):mo=="Safari"&&/\bChrome\b/.exec(ma&&ma[1])?(Qo.unshift("desktop mode"),mo="Chrome Mobile",Io=null,/\bOS X\b/.test(vo)?(Ss="Apple",vo="iOS 4.3+"):vo=null):/\bSRWare Iron\b/.test(mo)&&!Io&&(Io=gv("Chrome")),Io&&Io.indexOf(Gr=/[\d.]+$/.exec(vo))==0&&$n.indexOf("/"+Gr+"-")>-1&&(vo=Dn(vo.replace(Gr,""))),vo&&vo.indexOf(mo)!=-1&&!RegExp(mo+" OS").test(vo)&&(vo=vo.replace(RegExp(" *"+kn(mo)+" *"),"")),ma&&!/\b(?:Avant|Nook)\b/.test(mo)&&(/Browser|Lunascape|Maxthon/.test(mo)||mo!="Safari"&&/^iOS/.test(vo)&&/\bSafari\b/.test(ma[1])||/^(?:Adobe|Arora|Breach|Midori|Opera|Phantom|Rekonq|Rock|Samsung Internet|Sleipnir|SRWare Iron|Vivaldi|Web)/.test(mo)&&ma[1])&&(Gr=ma[ma.length-1])&&Qo.push(Gr),Qo.length&&(Qo=["("+Qo.join("; ")+")"]),Ss&&ta&&ta.indexOf(Ss)<0&&Qo.push("on "+Ss),ta&&Qo.push((/^on /.test(Qo[Qo.length-1])?"":"on ")+ta),vo&&(Gr=/ ([\d.+]+)$/.exec(vo),Kn=Gr&&vo.charAt(vo.length-Gr[0].length-1)=="/",vo={architecture:32,family:Gr&&!Kn?vo.replace(Gr[0],""):vo,version:Gr?Gr[1]:null,toString:function(){var ti=this.version;return this.family+(ti&&!Kn?" "+ti:"")+(this.architecture==64?" 64-bit":"")}}),(Gr=/\b(?:AMD|IA|Win|WOW|x86_|x)64\b/i.exec(Yi))&&!/\bi686\b/i.test(Yi)?(vo&&(vo.architecture=64,vo.family=vo.family.replace(RegExp(" *"+Gr),"")),mo&&(/\bWOW64\b/i.test($n)||cs&&/\w(?:86|32)$/.test(oa.cpuClass||oa.platform)&&!/\bWin64; x64\b/i.test($n))&&Qo.unshift("32-bit")):vo&&/^OS X/.test(vo.family)&&mo=="Chrome"&&parseFloat(Io)>=39&&(vo.architecture=64),$n||($n=null);var ei={};return ei.description=$n,ei.layout=ma&&ma[0],ei.manufacturer=Ss,ei.name=mo,ei.prerelease=Xi,ei.product=ta,ei.ua=$n,ei.version=mo&&Io,ei.os=vo||{architecture:null,family:null,version:null,toString:function(){return"null"}},ei.parse=Gn,ei.toString=function(){return this.description||""},ei.version&&Qo.unshift(Io),ei.name&&Qo.unshift(mo),vo&&mo&&(vo!=String(vo).split(" ")[0]||vo!=mo.split(" ")[0]&&!ta)&&Qo.push(ta?"("+vo+")":"on "+vo),Qo.length&&(ei.description=Qo.join(" ")),ei}();$e&&Oe?Dr(Fn,function(Gn,$n){$e[$n]=Gn}):kt.platform=Fn}).call(e)}),Sb=g(function(pe,Ne){pe.exports=function(){var kt={d:function(Gr,Kn){for(var ro in Kn)kt.o(Kn,ro)&&!kt.o(Gr,ro)&&bc(Gr,ro,{enumerable:!0,get:Kn[ro]})},o:function(Gr,Kn){return Object.prototype.hasOwnProperty.call(Gr,Kn)}},$e={};kt.d($e,{default:function(){return oa}});var Oe=function so(Gr){for(var Kn in function(ro,Hn){if(!(ro instanceof Hn))throw new TypeError("Cannot call a class as a function")}(this,so),this.directUploadAddr="https://wanproxy-web.127.net",this.retryCount=4,this.trunkSize=4194304,this.trunkUploadTimeout=5e4,this.getOffsetTimeout=1e4,this.version="1.0",this.enableCache=!0,this.logger=console,this.onError=function(ro){},this.onProgress=function(ro){},this.onUploadProgress=function(ro){},this.onComplete=function(ro){},Gr)this[Kn]=Gr[Kn]};function Lt(so,Gr){var Kn=Ua!==void 0&&fs(so)||so["@@iterator"];if(!Kn){if(Es(so)||(Kn=function(So,Co){if(So){var aa;if(typeof So=="string")return rr(So,Co);var No=$o(aa=Object.prototype.toString.call(So)).call(aa,8,-1);return No==="Object"&&So.constructor&&(No=So.constructor.name),No==="Map"||No==="Set"?Xc(So):No==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(No)?rr(So,Co):void 0}}(so))||Gr&&so&&typeof so.length=="number"){Kn&&(so=Kn);var ro=0,Hn=function(){};return{s:Hn,n:function(){return ro>=so.length?{done:!0}:{done:!1,value:so[ro++]}},e:function(Co){throw Co},f:Hn}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var Ln,eo=!0,lo=!1;return{s:function(){Kn=Kn.call(so)},n:function(){var Co=Kn.next();return eo=Co.done,Co},e:function(Co){lo=!0,Ln=Co},f:function(){try{eo||Kn.return==null||Kn.return()}finally{if(lo)throw Ln}}}}function rr(so,Gr){(Gr==null||Gr>so.length)&&(Gr=so.length);for(var Kn=0,ro=new Array(Gr);Kn<Gr;Kn++)ro[Kn]=so[Kn];return ro}var Pt=window.localStorage;window.localStorage&&typeof window.localStorage.getItem=="function"&&typeof window.localStorage.setItem=="function"&&typeof window.localStorage.removeItem=="function"||(Pt={privateObj:{},setItem:function(Gr,Kn){Pt.privateObj[Gr]=Kn},getItem:function(Gr){return Pt.privateObj[Gr]},removeItem:function(Gr){delete Pt.privateObj[Gr]},getKeys:function(){return ka(Pt.privateObj)}});var pr={getFileKey:function(Gr){var Kn=Gr.size.toString(),ro=Gr.lastModified.toString();return"_NosUploader_"+Gr.name+$o(Kn).call(Kn,Kn.length-5)+$o(ro).call(ro,ro.length-5)},getFileInfo:function(Gr){var Kn=Pt.getItem(Gr);if(!Kn)return null;try{return JSON.parse(Kn)}catch{return null}},initFile:function(Gr,Kn,ro){pr.clearExpiredInfo();var Hn=this.getFileKey(Kn),Ln={ctx:Gr.ctx!==void 0?Gr.ctx:"",bucket:Gr.bucketName,obj:Gr.objectName,token:Gr.token,modifyAt:xs(),end:!1};return Gr.payload&&(Ln.payload=Gr.payload),ro&&Pt.setItem(Hn,Ao(Ln)),Hn},setUploadContext:function(Gr,Kn,ro){var Hn=this.getFileInfo(Gr);Hn&&(Hn.ctx=Kn,ro&&Pt.setItem(Gr,Ao(Hn)))},setComplete:function(Gr,Kn){var ro=this.getFileInfo(Gr);ro&&(ro.modifyAt=xs(),ro.end=!0,Kn&&Pt.setItem(Gr,Ao(ro)))},getUploadContext:function(Gr){var Kn=this.getFileInfo(Gr);return Kn?Kn.ctx:""},removeFileInfo:function(Gr){Ba(Gr).call(Gr,"_NosUploader_")===0&&Pt.removeItem(Gr)},clearExpiredInfo:function(){var Gr,Kn=typeof Pt.getKeys=="function"?Pt.getKeys():ka(Pt),ro=xs(),Hn=[],Ln=Lt(Kn);try{for(Ln.s();!(Gr=Ln.n()).done;){var eo=Gr.value;if(Ba(eo).call(eo,"_NosUploader_")===0){var lo=pr.getFileInfo(eo);lo===null||ro-lo.modifyAt>oa.expireTime?Pt.removeItem(eo):Hn.push({fileInfo:lo,key:eo})}}}catch(Lo){Ln.e(Lo)}finally{Ln.f()}if(Hn.length>oa.maxFileCache){var So,Co,aa=Lt($o(So=Su(Hn).call(Hn,function(Lo,Wo){return Wo.fileInfo.modifyAt-Lo.fileInfo.modifyAt})).call(So,oa.maxFileCache));try{for(aa.s();!(Co=aa.n()).done;){var No,Sa=Co.value;Ba(No=Sa.key).call(No,"_NosUploader_")===0&&Pt.removeItem(Sa.key)}}catch(Lo){aa.e(Lo)}finally{aa.f()}}}},yr=pr;function Pr(so){return(Pr=typeof Ua=="function"&&typeof Bm=="symbol"?function(Gr){return typeof Gr}:function(Gr){return Gr&&typeof Ua=="function"&&Gr.constructor===Ua&&Gr!==Ua.prototype?"symbol":typeof Gr})(so)}function Rr(so,Gr){return!Gr||Pr(Gr)!=="object"&&typeof Gr!="function"?function(Kn){if(Kn===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return Kn}(so):Gr}function Vr(so){var Gr=typeof Pl=="function"?new Pl:void 0;return(Vr=function(ro){var Hn,Ln;if(ro===null||(Ln=ro,Ba(Hn=Function.toString.call(Ln)).call(Hn,"[native code]")===-1))return ro;if(typeof ro!="function")throw new TypeError("Super expression must either be null or a function");if(Gr!==void 0){if(Gr.has(ro))return Gr.get(ro);Gr.set(ro,eo)}function eo(){return Dr(ro,arguments,Tn(this).constructor)}return eo.prototype=Cs(ro.prototype,{constructor:{value:eo,enumerable:!1,writable:!0,configurable:!0}}),kn(eo,ro)})(so)}function Dr(so,Gr,Kn){return(Dr=Xr()?Ic:function(ro,Hn,Ln){var eo=[null];eo.push.apply(eo,Hn);var lo=new(Zo(Function).apply(ro,eo));return Ln&&kn(lo,Ln.prototype),lo}).apply(null,arguments)}function Xr(){if(typeof Reflect>"u"||!Ic||Ic.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Ic(Boolean,[],function(){})),!0}catch{return!1}}function kn(so,Gr){return(kn=si||function(Kn,ro){return Kn.__proto__=ro,Kn})(so,Gr)}function Tn(so){return(Tn=si?pi:function(Gr){return Gr.__proto__||pi(Gr)})(so)}var Dn=function(so){(function(Ln,eo){if(typeof eo!="function"&&eo!==null)throw new TypeError("Super expression must either be null or a function");Ln.prototype=Cs(eo&&eo.prototype,{constructor:{value:Ln,writable:!0,configurable:!0}}),eo&&kn(Ln,eo)})(Hn,so);var Gr,Kn,ro=(Gr=Hn,Kn=Xr(),function(){var Ln,eo=Tn(Gr);if(Kn){var lo=Tn(this).constructor;Ln=Ic(eo,arguments,lo)}else Ln=eo.apply(this,arguments);return Rr(this,Ln)});function Hn(Ln,eo){var lo;return function(So,Co){if(!(So instanceof Co))throw new TypeError("Cannot call a class as a function")}(this,Hn),(lo=ro.call(this,"NosUploadError:"+Ln)).errCode=eo,lo.errMsg=Ln,lo}return Hn}(Vr(Error)),Fn=function so(Gr,Kn,ro){if(Gr.uploadState==="uploading"){var Hn=Gr.config,Ln=Gr.param,eo=yr.getUploadContext(Gr.fileKey);if(!eo)return ro(0);var lo=new XMLHttpRequest,So=Hn.directUploadAddr+"/".concat(Ln.bucketName)+"/".concat(encodeURIComponent(Ln.objectName))+"?uploadContext"+"&context=".concat(eo)+"&version=".concat(Hn.version);lo.onreadystatechange=function(){var Co;if(Gr.uploadState!=="abort"&&lo.readyState===4){var aa,No,Sa,Lo;try{Lo=JSON.parse(lo.responseText)}catch{Lo={errMsg:"JsonParseError in getOffset",errCode:500}}lo.status===200?Lo.errCode?Gr.config.onError(new Dn(Lo.errMsg,Lo.errCode)):ro(Lo.offset):lo.status.toString().match(/^5/)?so(Gr,Kn-1,ro):Kn>0?(typeof((Co=Hn.logger)===null||Co===void 0?void 0:Co.error)=="function"&&Hn.logger.error(gi(aa="getOffset(".concat(So,") error. retry after 3 seconds. ")).call(aa,new Date().toTimeString())),Ia(function(){so(Gr,Kn-1,ro)},3500)):(yr.removeFileInfo(Gr.fileKey),lo.status?Hn.onError(new Dn(gi(No=gi(Sa="getOffset(".concat(So,") error: ")).call(Sa,lo.status," ")).call(No,lo.statusText))):Hn.onError(new Dn("getOffset(".concat(So,") error. no Error Code"))))}},lo.open("get",So),lo.setRequestHeader("x-nos-token",Ln.token),lo.timeout=Hn.getOffsetTimeout,lo.send()}},Gn=function so(Gr,Kn,ro,Hn){if(Gr.uploadState==="uploading"){var Ln=Gr.param,eo=Gr.config,lo=$o(File.prototype),So=Ln.ctx!==void 0?Ln.ctx:"",Co=Kn+eo.trunkSize>Gr.file.size,aa=Co?Gr.file.size:Kn+eo.trunkSize,No=new XMLHttpRequest,Sa=eo.directUploadAddr+"/".concat(Ln.bucketName)+"/".concat(encodeURIComponent(Ln.objectName));if(No.upload.onprogress=function(Wo){if(Gr.uploadState!=="abort"){var Ta=0;Wo.lengthComputable?(Ta=(Kn+Wo.loaded)/Gr.file.size,eo.onProgress(Ta),eo.onUploadProgress({loaded:Wo.loaded,total:Gr.file.size,percentage:Ta,percentageText:(100*Ta).toFixed(2)+"%"})):eo.onError(new Dn("browser does not support query upload progress"))}},No.onreadystatechange=function(){var Wo,Ta;if(Gr.uploadState!=="abort"&&No.readyState===4){var Yi,Qo,Xi,cs;try{cs=JSON.parse(No.responseText)}catch(Io){typeof((Wo=eo.logger)===null||Wo===void 0?void 0:Wo.error)=="function"&&eo.logger.error("JsonParseError in uploadTrunk",Io),cs={errMsg:"JsonParseError in uploadTrunk"}}No.status===200?(Gr.setContext(cs.context),Co?(Hn(),Gr.setComplete()):so(Gr,cs.offset,eo.retryCount,Hn)):No.status.toString().match(/^5/)?ro>0?so(Gr,Kn,ro-1,Hn):(yr.removeFileInfo(Gr.fileKey),eo.onError(new Dn(cs.errMsg,cs.errCode))):ro>0?(typeof((Ta=eo.logger)===null||Ta===void 0?void 0:Ta.error)=="function"&&eo.logger.error(gi(Yi="uploadTrunk(".concat(Sa,") error. retry after 3 seconds. ")).call(Yi,new Date().toTimeString())),Ia(function(){so(Gr,Kn,ro-1,Hn)},3500)):(yr.removeFileInfo(Gr.fileKey),No.status?eo.onError(new Dn(gi(Qo=gi(Xi="uploadTrunk(".concat(Sa,") error: ")).call(Xi,No.status," ")).call(Qo,No.statusText))):eo.onError(new Dn("uploadTrunk(".concat(Sa,") error. no Error Code. Please check your network"))))}},No.open("post",Sa+"?offset=".concat(Kn)+"&complete=".concat(Co)+"&context=".concat(So)+"&version=".concat(eo.version)),No.setRequestHeader("x-nos-token",Ln.token),Gr.file.type&&No.setRequestHeader("content-type",Gr.file.type),No.timeout=eo.trunkUploadTimeout,typeof FileReader<"u"){var Lo=new FileReader;Lo.addEventListener("load",function(Wo){var Ta;!((Ta=Wo==null?void 0:Wo.target)===null||Ta===void 0)&&Ta.result?No.send(Wo.target.result):eo.onError(new Dn("Read ArrayBuffer failed"))}),Lo.addEventListener("error",function(Wo){var Ta=Wo.target.error;eo.onError(new Dn("Read ArrayBuffer error. ".concat(Ta.toString()),Ta.code))}),Lo.readAsArrayBuffer(lo.call(Gr.file,Kn,aa))}else No.send(lo.call(Gr.file,Kn,aa))}};function $n(so,Gr){for(var Kn=0;Kn<Gr.length;Kn++){var ro=Gr[Kn];ro.enumerable=ro.enumerable||!1,ro.configurable=!0,"value"in ro&&(ro.writable=!0),bc(so,ro.key,ro)}}var ho=function(){function so(Kn,ro,Hn){(function(Ln,eo){if(!(Ln instanceof eo))throw new TypeError("Cannot call a class as a function")})(this,so),this.uploadState="paused",this.config=Hn,this.file=Kn,this.param=ro,this.fileKey=yr.initFile(ro,Kn,this.config.enableCache),this.resume()}var Gr;return(Gr=[{key:"resume",value:function(){var ro=this;if(this.uploadState!=="uploading"){this.setUploadState("uploading");var Hn=this.config;Fn(this,Hn.retryCount,function(Ln){Gn(ro,Ln,Hn.retryCount,function(){ro.setUploadState("ended"),typeof Hn.onComplete=="function"&&Hn.onComplete(ro.param)})})}}},{key:"pause",value:function(){this.setUploadState("paused")}},{key:"abort",value:function(){this.setUploadState("abort"),yr.removeFileInfo(this.fileKey),this.config.onError(new Dn("Upload Aborted",10499))}},{key:"setUploadState",value:function(ro){ro!==this.uploadState&&(this.uploadState=ro)}},{key:"setContext",value:function(ro){yr.setUploadContext(this.fileKey,ro,this.config.enableCache),this.param.ctx=ro}},{key:"setComplete",value:function(){yr.setComplete(this.fileKey,this.config.enableCache),this.setUploadState("ended")}}])&&$n(so.prototype,Gr),so}(),co={maxFileCache:6,expireTime:864e5,getFileUploadInformation:function(Gr){var Kn=yr.getFileKey(Gr),ro=yr.getFileInfo(Kn);return ro===null?null:xs()-ro.modifyAt>co.expireTime?(yr.removeFileInfo(Kn),null):{uploadInfo:Vn({bucketName:ro.bucket,objectName:ro.obj,token:ro.token,ctx:ro.ctx},ro.payload?{payload:ro.payload}:{}),complete:ro.end}},setMaxFileCache:function(Gr){co.maxFileCache=Gr},setExpireTime:function(Gr){co.expireTime=Gr},printCaches:function(){for(var Gr=0,Kn=ka(localStorage);Gr<Kn.length;Gr++){var ro=Kn[Gr],Hn=yr.getFileInfo(ro);Hn&&console.log(Hn,"modifiedAt",new Date(Hn.modifyAt).toTimeString())}},createConfig:function(Gr){return new Oe(Gr)},createTask:function(Gr,Kn,ro){return new ho(Gr,Kn,ro)}},oa=co;return $e.default}()}),Ql=g(function(pe,Ne){pe.exports=function(){function kt(rr){if(rr){var Pt,pr="";return Qn(Pt=ka(rr)).call(Pt,function(yr,Pr){pr+=Pr===0?"?":"&",pr+=yr+"="+rr[yr]}),pr}return""}function $e(rr,Pt,pr,yr){return Error.call(this,pr),this.source=rr,this.code=Pt,this.desc=pr,this.detail=yr||{},this}function Oe(rr,Pt){var pr=Cs(Pt.prototype);pr.constructor=rr,rr.prototype=pr}function Lt(rr,Pt){Pt===void 0&&(Pt={dataType:"json",method:"GET",timeout:5e3});var pr=Pt.dataType==="text"?"text/plain; charset=UTF-8":"application/json; charset=UTF-8",yr=Pt.method==="GET"?kt(Pt.params):"";return new xo(function(Pr,Rr){if(window.XMLHttpRequest){var Vr,Dr=new XMLHttpRequest;if(Dr.onreadystatechange=function(){if(Dr.readyState===4)if(Dr.status===200){try{Vr=JSON.parse(Dr.response||"{}")}catch{Vr=Dr.response}Pr({status:Dr.status,data:Vr})}else Rr(new $e(1,Dr.status,Dr.statusText))},Dr.open(Pt.method,""+rr+yr),Dr.timeout=Pt.timeout||5e3,Dr.setRequestHeader("Content-Type",pr),Pt.headers)for(var Xr in Pt.headers)Dr.setRequestHeader(Xr,Pt.headers[Xr]);Dr.ontimeout=function(kn){Rr(new $e(1,408,kn&&kn.message?kn.message:"request timeout"))},Dr.send(Ao(Pt.data))}else Rr(new $e(2,10400,"request no suppout"))})}return Oe($e,Error),Lt}()}),Iu=console,qC={setLogger:function(Ne){Iu=Ne},platform:"BROWSER",localStorage:window.localStorage,request:Ql,WebSocket:window.WebSocket,uploadFile:function(Ne){return zr(this,void 0,void 0,_r.mark(function kt(){var $e,Oe,Lt,rr,Pt,pr;return _r.wrap(function(Pr){for(;;)switch(Pr.prev=Pr.next){case 0:if(Ne.fileInput||Ne.file){Pr.next=2;break}throw new Error("File not exist");case 2:if(!Ne.file){Pr.next=6;break}rr=Ne.file,Pr.next=20;break;case 6:if(typeof Ne.fileInput!="string"){Pr.next=15;break}if(!((Pt=document.getElementById(Ne.fileInput))&&Pt.files&&Pt.files[0])){Pr.next=12;break}rr=Pt.files[0],Pr.next=13;break;case 12:throw new Error("Can not get file from fileInput");case 13:Pr.next=20;break;case 15:if(!(Ne.fileInput&&Ne.fileInput.files&&Ne.fileInput.files[0])){Pr.next=19;break}rr=Ne.fileInput.files[0],Pr.next=20;break;case 19:throw new Error("Can not get file from fileInput "+Ne.fileInput);case 20:if(!(Ne.maxSize&&rr.size>Ne.maxSize)){Pr.next=22;break}throw new Error("The file exceeds maxSize limit. maxSize: "+Ne.maxSize+", get "+rr.size);case 22:return Pr.next=24,new xo(function(Rr,Vr){var Dr=Sb.createConfig({enableCache:!1,directUploadAddr:Ne.chunkUploadHost,onError:function(Tn){Vr(Tn)},onProgress:Ne.onUploadProgress||function(){},onComplete:function(Tn){Rr(Tn)}}),Xr=Sb.createTask(rr,{bucketName:Ne.nosToken.bucket,objectName:decodeURIComponent(Ne.nosToken.objectName),token:Ne.nosToken.token},Dr);try{Ne.onUploadStart&&Ne.onUploadStart(Xr)}catch(kn){Iu.error("Adapter uploadFile: options.onUploadStart error",kn&&kn.message),Xr.abort(),Vr(kn)}});case 24:return(pr=Pr.sent).name=rr.name,pr.size=rr.size,pr.type=rr.type,pr.ext=bb($e=pr.name).call($e,".")>-1?$o(Oe=pr.name).call(Oe,bb(Lt=pr.name).call(Lt,".")+1).toLowerCase():"",Pr.abrupt("return",pr);case 30:case"end":return Pr.stop()}},kt)}))},getSystemInfo:function(){var Ne,kt;return{os:((Ne=il.os)===null||Ne===void 0?void 0:Ne.family)||"",osVer:((kt=il.os)===null||kt===void 0?void 0:kt.version)||"",browser:il.name||"",browserVer:il.version||"",hostEnv:"BROWSER",hostEnvVer:il.version||"",hostInfo:il.ua||""}}};return bp.setAdapters(qC),bp})})(QCHAT_BROWSER_SDK);var QCHAT_BROWSER_SDKExports=QCHAT_BROWSER_SDK.exports;const QChatSDK=getDefaultExportFromCjs(QCHAT_BROWSER_SDKExports);var NIM_BROWSER_SDK={exports:{}};(function(t,r){(function(e,n){t.exports=n()})(commonjsGlobal,function(){var e=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof commonjsGlobal<"u"?commonjsGlobal:typeof self<"u"?self:{};function n(xe){return xe&&xe.__esModule&&Object.prototype.hasOwnProperty.call(xe,"default")?xe.default:xe}function g(xe){var he={exports:{}};return xe(he,he.exports),he.exports}var y,i,k=n(g(function(xe){xe.exports=function(Ve){if(Ve===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return Ve},xe.exports.__esModule=!0,xe.exports.default=xe.exports})),L=function(xe){return xe&&xe.Math==Math&&xe},$=L(typeof globalThis=="object"&&globalThis)||L(typeof window=="object"&&window)||L(typeof self=="object"&&self)||L(typeof e=="object"&&e)||function(){return this}()||Function("return this")(),V=function(xe){try{return!!xe()}catch{return!0}},z=!V(function(){var xe=(function(){}).bind();return typeof xe!="function"||xe.hasOwnProperty("prototype")}),re=Function.prototype,oe=re.apply,le=re.call,ue=typeof Reflect=="object"&&Reflect.apply||(z?le.bind(oe):function(){return le.apply(oe,arguments)}),ie=Function.prototype,ae=ie.bind,Ie=ie.call,de=z&&ae.bind(Ie,Ie),Ce=z?function(xe){return xe&&de(xe)}:function(xe){return xe&&function(){return Ie.apply(xe,arguments)}},Ue=function(xe){return typeof xe=="function"},qe=!V(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!=7}),jt=Function.prototype.call,Fe=z?jt.bind(jt):function(){return jt.apply(jt,arguments)},Et={}.propertyIsEnumerable,cr=Object.getOwnPropertyDescriptor,er={f:cr&&!Et.call({1:2},1)?function(he){var Ve=cr(this,he);return!!Ve&&Ve.enumerable}:Et},nr=function(xe,he){return{enumerable:!(1&xe),configurable:!(2&xe),writable:!(4&xe),value:he}},dr=Ce({}.toString),ir=Ce("".slice),tr=function(xe){return ir(dr(xe),8,-1)},ur=Object,or=Ce("".split),fr=V(function(){return!ur("z").propertyIsEnumerable(0)})?function(xe){return tr(xe)=="String"?or(xe,""):ur(xe)}:ur,lr=function(xe){return xe==null},gr=TypeError,Sr=function(xe){if(lr(xe))throw gr("Can't call method on "+xe);return xe},wr=function(xe){return fr(Sr(xe))},kr=typeof document=="object"&&document.all,mr=kr===void 0&&kr!==void 0?function(xe){return typeof xe=="object"?xe!==null:Ue(xe)||xe===kr}:function(xe){return typeof xe=="object"?xe!==null:Ue(xe)},Ir={},Nr=function(xe){return Ue(xe)?xe:void 0},Er=function(xe,he){return arguments.length<2?Nr(Ir[xe])||Nr($[xe]):Ir[xe]&&Ir[xe][he]||$[xe]&&$[xe][he]},sr=Ce({}.isPrototypeOf),xr=Er("navigator","userAgent")||"",Or=$.process,Mr=$.Deno,br=Or&&Or.versions||Mr&&Mr.version,hr=br&&br.v8;hr&&(i=(y=hr.split("."))[0]>0&&y[0]<4?1:+(y[0]+y[1])),!i&&xr&&(!(y=xr.match(/Edge\/(\d+)/))||y[1]>=74)&&(y=xr.match(/Chrome\/(\d+)/))&&(i=+y[1]);var Tr,Br=i,Fr=!!Object.getOwnPropertySymbols&&!V(function(){var xe=Symbol();return!String(xe)||!(Object(xe)instanceof Symbol)||!Symbol.sham&&Br&&Br<41}),Lr=Fr&&!Symbol.sham&&typeof Symbol.iterator=="symbol",qr=Object,Ur=Lr?function(xe){return typeof xe=="symbol"}:function(xe){var he=Er("Symbol");return Ue(he)&&sr(he.prototype,qr(xe))},Qr=String,vn=function(xe){try{return Qr(xe)}catch{return"Object"}},_n=TypeError,Yr=function(xe){if(Ue(xe))return xe;throw _n(vn(xe)+" is not a function")},jn=function(xe,he){var Ve=xe[he];return lr(Ve)?void 0:Yr(Ve)},Zr=TypeError,An=Object.defineProperty,Jr="__core-js_shared__",Mn=$[Jr]||function(xe,he){try{An($,xe,{value:he,configurable:!0,writable:!0})}catch{$[xe]=he}return he}(Jr,{}),Bn=g(function(xe){(xe.exports=function(he,Ve){return Mn[he]||(Mn[he]=Ve!==void 0?Ve:{})})("versions",[]).push({version:"3.25.0",mode:"pure",copyright:"© 2014-2022 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.25.0/LICENSE",source:"https://github.com/zloirock/core-js"})}),wn=Object,In=function(xe){return wn(Sr(xe))},bn=Ce({}.hasOwnProperty),hn=Object.hasOwn||function(he,Ve){return bn(In(he),Ve)},Zn=0,Oo=Math.random(),Ho=Ce(1 .toString),Do=function(xe){return"Symbol("+(xe===void 0?"":xe)+")_"+Ho(++Zn+Oo,36)},Eo=Bn("wks"),Ko=$.Symbol,Wa=Ko&&Ko.for,Ts=Lr?Ko:Ko&&Ko.withoutSetter||Do,To=function(xe){if(!hn(Eo,xe)||!Fr&&typeof Eo[xe]!="string"){var he="Symbol."+xe;Fr&&hn(Ko,xe)?Eo[xe]=Ko[xe]:Eo[xe]=Lr&&Wa?Wa(he):Ts(he)}return Eo[xe]},Os=TypeError,to=To("toPrimitive"),ha=function(xe,he){if(!mr(xe)||Ur(xe))return xe;var Ve,ze=jn(xe,to);if(ze){if(he===void 0&&(he="default"),Ve=Fe(ze,xe,he),!mr(Ve)||Ur(Ve))return Ve;throw Os("Can't convert object to primitive value")}return he===void 0&&(he="number"),function(_e,At){var ar,Dt;if(At==="string"&&Ue(ar=_e.toString)&&!mr(Dt=Fe(ar,_e))||Ue(ar=_e.valueOf)&&!mr(Dt=Fe(ar,_e))||At!=="string"&&Ue(ar=_e.toString)&&!mr(Dt=Fe(ar,_e)))return Dt;throw Zr("Can't convert object to primitive value")}(xe,he)},ca=function(xe){var he=ha(xe,"string");return Ur(he)?he:he+""},$a=$.document,Qa=mr($a)&&mr($a.createElement),Xo=function(xe){return Qa?$a.createElement(xe):{}},ko=!qe&&!V(function(){return Object.defineProperty(Xo("div"),"a",{get:function(){return 7}}).a!=7}),ja=Object.getOwnPropertyDescriptor,Da={f:qe?ja:function(he,Ve){if(he=wr(he),Ve=ca(Ve),ko)try{return ja(he,Ve)}catch{}if(hn(he,Ve))return nr(!Fe(er.f,he,Ve),he[Ve])}},Hc=/#|\.prototype\./,Rs=function(xe,he){var Ve=Xn[Rn(xe)];return Ve==Na||Ve!=zo&&(Ue(he)?V(he):!!he)},Rn=Rs.normalize=function(xe){return String(xe).replace(Hc,".").toLowerCase()},Xn=Rs.data={},zo=Rs.NATIVE="N",Na=Rs.POLYFILL="P",vs=Rs,Us=Ce(Ce.bind),Go=function(xe,he){return Yr(xe),he===void 0?xe:z?Us(xe,he):function(){return xe.apply(he,arguments)}},Pi=qe&&V(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!=42}),Ti=String,Mp=TypeError,po=function(xe){if(mr(xe))return xe;throw Mp(Ti(xe)+" is not an object")},wb=TypeError,Pu=Object.defineProperty,_b=Object.getOwnPropertyDescriptor,xb="enumerable",Ib="configurable",Eb="writable",Oa={f:qe?Pi?function(he,Ve,ze){if(po(he),Ve=ca(Ve),po(ze),typeof he=="function"&&Ve==="prototype"&&"value"in ze&&Eb in ze&&!ze.writable){var _e=_b(he,Ve);_e&&_e.writable&&(he[Ve]=ze.value,ze={configurable:Ib in ze?ze.configurable:_e.configurable,enumerable:xb in ze?ze.enumerable:_e.enumerable,writable:!1})}return Pu(he,Ve,ze)}:Pu:function(he,Ve,ze){if(po(he),Ve=ca(Ve),po(ze),ko)try{return Pu(he,Ve,ze)}catch{}if("get"in ze||"set"in ze)throw wb("Accessors not supported");return"value"in ze&&(he[Ve]=ze.value),he}},va=qe?function(xe,he,Ve){return Oa.f(xe,he,nr(1,Ve))}:function(xe,he,Ve){return xe[he]=Ve,xe},Pb=Da.f,Ab=function(xe){var he=function(Ve,ze,_e){if(this instanceof he){switch(arguments.length){case 0:return new xe;case 1:return new xe(Ve);case 2:return new xe(Ve,ze)}return new xe(Ve,ze,_e)}return ue(xe,this,arguments)};return he.prototype=xe.prototype,he},xn=function(xe,he){var Ve,ze,_e,At,ar,Dt,vr,Cr,Ar=xe.target,$r=xe.global,jr=xe.stat,Hr=xe.proto,Kr=$r?$:jr?$[Ar]:($[Ar]||{}).prototype,Sn=$r?Ir:Ir[Ar]||va(Ir,Ar,{})[Ar],Cn=Sn.prototype;for(_e in he)Ve=!vs($r?_e:Ar+(jr?".":"#")+_e,xe.forced)&&Kr&&hn(Kr,_e),ar=Sn[_e],Ve&&(Dt=xe.dontCallGetSet?(Cr=Pb(Kr,_e))&&Cr.value:Kr[_e]),At=Ve&&Dt?Dt:he[_e],Ve&&typeof ar==typeof At||(vr=xe.bind&&Ve?Go(At,$):xe.wrap&&Ve?Ab(At):Hr&&Ue(At)?Ce(At):At,(xe.sham||At&&At.sham||ar&&ar.sham)&&va(vr,"sham",!0),va(Sn,_e,vr),Hr&&(hn(Ir,ze=Ar+"Prototype")||va(Ir,ze,{}),va(Ir[ze],_e,At),xe.real&&Cn&&!Cn[_e]&&va(Cn,_e,At)))},Nb=Math.ceil,Ob=Math.floor,Rb=Math.trunc||function(he){var Ve=+he;return(Ve>0?Ob:Nb)(Ve)},uc=function(xe){var he=+xe;return he!=he||he===0?0:Rb(he)},Bb=Math.max,Fb=Math.min,Ai=function(xe,he){var Ve=uc(xe);return Ve<0?Bb(Ve+he,0):Fb(Ve,he)},Lb=Math.min,Za=function(xe){return(he=xe.length)>0?Lb(uc(he),9007199254740991):0;var he},Bf=function(xe){return function(he,Ve,ze){var _e,At=wr(he),ar=Za(At),Dt=Ai(ze,ar);if(xe&&Ve!=Ve){for(;ar>Dt;)if((_e=At[Dt++])!=_e)return!0}else for(;ar>Dt;Dt++)if((xe||Dt in At)&&At[Dt]===Ve)return xe||Dt||0;return!xe&&-1}},Au={includes:Bf(!0),indexOf:Bf(!1)},Ni={},$b=Au.indexOf,Ff=Ce([].push),Lf=function(xe,he){var Ve,ze=wr(xe),_e=0,At=[];for(Ve in ze)!hn(Ni,Ve)&&hn(ze,Ve)&&Ff(At,Ve);for(;he.length>_e;)hn(ze,Ve=he[_e++])&&(~$b(At,Ve)||Ff(At,Ve));return At},dl=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],Vs=Object.keys||function(he){return Lf(he,dl)},jb=qe&&!Pi?Object.defineProperties:function(he,Ve){po(he);for(var ze,_e=wr(Ve),At=Vs(Ve),ar=At.length,Dt=0;ar>Dt;)Oa.f(he,ze=At[Dt++],_e[ze]);return he},$f={f:jb},Nu=Er("document","documentElement"),jf=Bn("keys"),pl=function(xe){return jf[xe]||(jf[xe]=Do(xe))},Df=pl("IE_PROTO"),Ou=function(){},Uf=function(xe){return"<script>"+xe+"<\/script>"},Vf=function(xe){xe.write(Uf("")),xe.close();var he=xe.parentWindow.Object;return xe=null,he},fl=function(){try{Tr=new ActiveXObject("htmlfile")}catch{}var xe,he;fl=typeof document<"u"?document.domain&&Tr?Vf(Tr):((he=Xo("iframe")).style.display="none",Nu.appendChild(he),he.src="javascript:",(xe=he.contentWindow.document).open(),xe.write(Uf("document.F=Object")),xe.close(),xe.F):Vf(Tr);for(var Ve=dl.length;Ve--;)delete fl.prototype[dl[Ve]];return fl()};Ni[Df]=!0;var es=Object.create||function(he,Ve){var ze;return he!==null?(Ou.prototype=po(he),ze=new Ou,Ou.prototype=null,ze[Df]=he):ze=fl(),Ve===void 0?ze:$f.f(ze,Ve)};xn({target:"Object",stat:!0,sham:!qe},{create:es});var Db=Ir.Object,Cs=function(he,Ve){return Db.create(he,Ve)},Ub=String,Vb=TypeError,dc=Object.setPrototypeOf||("__proto__"in{}?function(){var xe,he=!1,Ve={};try{(xe=Ce(Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set))(Ve,[]),he=Ve instanceof Array}catch{}return function(_e,At){return po(_e),function(ar){if(typeof ar=="object"||Ue(ar))return ar;throw Vb("Can't set "+Ub(ar)+" as a prototype")}(At),he?xe(_e,At):_e.__proto__=At,_e}}():void 0);xn({target:"Object",stat:!0},{setPrototypeOf:dc});var si=Ir.Object.setPrototypeOf,qs=Ce([].slice),qf=Function,qb=Ce([].concat),Hb=Ce([].join),Ru={},zb=function(xe,he,Ve){if(!hn(Ru,he)){for(var ze=[],_e=0;_e<he;_e++)ze[_e]="a["+_e+"]";Ru[he]=qf("C,a","return new C("+Hb(ze,",")+")")}return Ru[he](xe,Ve)},Bu=z?qf.bind:function(he){var Ve=Yr(this),ze=Ve.prototype,_e=qs(arguments,1),At=function(){var Dt=qb(_e,qs(arguments));return this instanceof At?zb(Ve,Dt.length,Dt):Ve.apply(he,Dt)};return mr(ze)&&(At.prototype=ze),At};xn({target:"Function",proto:!0,forced:Function.bind!==Bu},{bind:Bu});var sa=function(xe){return Ir[xe+"Prototype"]},Wb=sa("Function").bind,Fu=Function.prototype,Zo=function(xe){var he=xe.bind;return xe===Fu||sr(Fu,xe)&&he===Fu.bind?Wb:he},Lu=g(function(xe){function he(Ve,ze){var _e;return xe.exports=he=si?Zo(_e=si).call(_e):function(ar,Dt){return ar.__proto__=Dt,ar},xe.exports.__esModule=!0,xe.exports.default=xe.exports,he(Ve,ze)}xe.exports=he,xe.exports.__esModule=!0,xe.exports.default=xe.exports}),ea=n(g(function(xe){xe.exports=function(Ve,ze){Ve.prototype=Cs(ze.prototype),Ve.prototype.constructor=Ve,Lu(Ve,ze)},xe.exports.__esModule=!0,xe.exports.default=xe.exports})),Ms=Array.isArray||function(he){return tr(he)=="Array"},Gb=TypeError,$u=function(xe){if(xe>9007199254740991)throw Gb("Maximum allowed index exceeded");return xe},ii=function(xe,he,Ve){var ze=ca(he);ze in xe?Oa.f(xe,ze,nr(0,Ve)):xe[ze]=Ve},Hf={};Hf[To("toStringTag")]="z";var ju=String(Hf)==="[object z]",Kb=To("toStringTag"),Qb=Object,Jb=tr(function(){return arguments}())=="Arguments",ci=ju?tr:function(xe){var he,Ve,ze;return xe===void 0?"Undefined":xe===null?"Null":typeof(Ve=function(_e,At){try{return _e[At]}catch{}}(he=Qb(xe),Kb))=="string"?Ve:Jb?tr(he):(ze=tr(he))=="Object"&&Ue(he.callee)?"Arguments":ze},Yb=Ce(Function.toString);Ue(Mn.inspectSource)||(Mn.inspectSource=function(xe){return Yb(xe)});var zf=Mn.inspectSource,Wf=function(){},Xb=[],Gf=Er("Reflect","construct"),Du=/^\s*(?:class|function)\b/,Zb=Ce(Du.exec),e0=!Du.exec(Wf),pc=function(he){if(!Ue(he))return!1;try{return Gf(Wf,Xb,he),!0}catch{return!1}},Kf=function(he){if(!Ue(he))return!1;switch(ci(he)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return e0||!!Zb(Du,zf(he))}catch{return!0}};Kf.sham=!0;var ml=!Gf||V(function(){var xe;return pc(pc.call)||!pc(Object)||!pc(function(){xe=!0})||xe})?Kf:pc,t0=To("species"),Qf=Array,Uu=function(xe,he){return new(function(Ve){var ze;return Ms(Ve)&&(ze=Ve.constructor,(ml(ze)&&(ze===Qf||Ms(ze.prototype))||mr(ze)&&(ze=ze[t0])===null)&&(ze=void 0)),ze===void 0?Qf:ze}(xe))(he===0?0:he)},r0=To("species"),fc=function(xe){return Br>=51||!V(function(){var he=[];return(he.constructor={})[r0]=function(){return{foo:1}},he[xe](Boolean).foo!==1})},Jf=To("isConcatSpreadable"),n0=Br>=51||!V(function(){var xe=[];return xe[Jf]=!1,xe.concat()[0]!==xe}),o0=fc("concat"),a0=function(xe){if(!mr(xe))return!1;var he=xe[Jf];return he!==void 0?!!he:Ms(xe)};xn({target:"Array",proto:!0,arity:1,forced:!n0||!o0},{concat:function(he){var Ve,ze,_e,At,ar,Dt=In(this),vr=Uu(Dt,0),Cr=0;for(Ve=-1,_e=arguments.length;Ve<_e;Ve++)if(a0(ar=Ve===-1?Dt:arguments[Ve]))for(At=Za(ar),$u(Cr+At),ze=0;ze<At;ze++,Cr++)ze in ar&&ii(vr,Cr,ar[ze]);else $u(Cr+1),ii(vr,Cr++,ar);return vr.length=Cr,vr}});var gl,mc,hl,s0=String,rs=function(xe){if(ci(xe)==="Symbol")throw TypeError("Cannot convert a Symbol value to a string");return s0(xe)},i0=dl.concat("length","prototype"),gc={f:Object.getOwnPropertyNames||function(he){return Lf(he,i0)}},c0=Array,l0=Math.max,Vu=function(xe,he,Ve){for(var ze=Za(xe),_e=Ai(he,ze),At=Ai(Ve===void 0?ze:Ve,ze),ar=c0(l0(At-_e,0)),Dt=0;_e<At;_e++,Dt++)ii(ar,Dt,xe[_e]);return ar.length=Dt,ar},Yf=gc.f,Xf=typeof window=="object"&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],qu={f:function(he){return Xf&&tr(he)=="Window"?function(Ve){try{return Yf(Ve)}catch{return Vu(Xf)}}(he):Yf(wr(he))}},hc={f:Object.getOwnPropertySymbols},Hs=function(xe,he,Ve,ze){return ze&&ze.enumerable?xe[he]=Ve:va(xe,he,Ve),xe},Hu={f:To},u0=Oa.f,Vo=function(xe){var he=Ir.Symbol||(Ir.Symbol={});hn(he,xe)||u0(he,xe,{value:Hu.f(xe)})},Zf=function(){var xe=Er("Symbol"),he=xe&&xe.prototype,Ve=he&&he.valueOf,ze=To("toPrimitive");he&&!he[ze]&&Hs(he,ze,function(_e){return Fe(Ve,this)},{arity:1})},d0=ju?{}.toString:function(){return"[object "+ci(this)+"]"},p0=Oa.f,em=To("toStringTag"),li=function(xe,he,Ve,ze){if(xe){var _e=Ve?xe:xe.prototype;hn(_e,em)||p0(_e,em,{configurable:!0,value:he}),ze&&!ju&&va(_e,"toString",d0)}},tm=$.WeakMap,f0=Ue(tm)&&/native code/.test(String(tm)),rm="Object already initialized",zu=$.TypeError,m0=$.WeakMap;if(f0||Mn.state){var ui=Mn.state||(Mn.state=new m0),g0=Ce(ui.get),nm=Ce(ui.has),h0=Ce(ui.set);gl=function(xe,he){if(nm(ui,xe))throw zu(rm);return he.facade=xe,h0(ui,xe,he),he},mc=function(xe){return g0(ui,xe)||{}},hl=function(xe){return nm(ui,xe)}}else{var Oi=pl("state");Ni[Oi]=!0,gl=function(xe,he){if(hn(xe,Oi))throw zu(rm);return he.facade=xe,va(xe,Oi,he),he},mc=function(xe){return hn(xe,Oi)?xe[Oi]:{}},hl=function(xe){return hn(xe,Oi)}}var ts={set:gl,get:mc,has:hl,enforce:function(xe){return hl(xe)?mc(xe):gl(xe,{})},getterFor:function(xe){return function(he){var Ve;if(!mr(he)||(Ve=mc(he)).type!==xe)throw zu("Incompatible receiver, "+xe+" required");return Ve}}},om=Ce([].push),zs=function(xe){var he=xe==1,Ve=xe==2,ze=xe==3,_e=xe==4,At=xe==6,ar=xe==7,Dt=xe==5||At;return function(vr,Cr,Ar,$r){for(var jr,Hr,Kr=In(vr),Sn=fr(Kr),Cn=Go(Cr,Ar),Pn=Za(Sn),En=0,Nn=$r||Uu,zn=he?Nn(vr,Pn):Ve||ar?Nn(vr,0):void 0;Pn>En;En++)if((Dt||En in Sn)&&(Hr=Cn(jr=Sn[En],En,Kr),xe))if(he)zn[En]=Hr;else if(Hr)switch(xe){case 3:return!0;case 5:return jr;case 6:return En;case 2:om(zn,jr)}else switch(xe){case 4:return!1;case 7:om(zn,jr)}return At?-1:ze||_e?_e:zn}},Ws={forEach:zs(0),map:zs(1),filter:zs(2),some:zs(3),every:zs(4),find:zs(5),findIndex:zs(6),filterReject:zs(7)},vl=Ws.forEach,Ra=pl("hidden"),yl="Symbol",v0=ts.set,am=ts.getterFor(yl),as=Object.prototype,di=$.Symbol,vc=di&&di.prototype,y0=$.TypeError,Wu=$.QObject,sm=Da.f,Gs=Oa.f,im=qu.f,b0=er.f,cm=Ce([].push),ks=Bn("symbols"),yc=Bn("op-symbols"),S0=Bn("wks"),Gu=!Wu||!Wu.prototype||!Wu.prototype.findChild,Ku=qe&&V(function(){return es(Gs({},"a",{get:function(){return Gs(this,"a",{value:7}).a}})).a!=7})?function(xe,he,Ve){var ze=sm(as,he);ze&&delete as[he],Gs(xe,he,Ve),ze&&xe!==as&&Gs(as,he,ze)}:Gs,Qu=function(xe,he){var Ve=ks[xe]=es(vc);return v0(Ve,{type:yl,tag:xe,description:he}),qe||(Ve.description=he),Ve},bl=function(he,Ve,ze){he===as&&bl(yc,Ve,ze),po(he);var _e=ca(Ve);return po(ze),hn(ks,_e)?(ze.enumerable?(hn(he,Ra)&&he[Ra][_e]&&(he[Ra][_e]=!1),ze=es(ze,{enumerable:nr(0,!1)})):(hn(he,Ra)||Gs(he,Ra,nr(1,{})),he[Ra][_e]=!0),Ku(he,_e,ze)):Gs(he,_e,ze)},Ju=function(he,Ve){po(he);var ze=wr(Ve),_e=Vs(ze).concat(pm(ze));return vl(_e,function(At){qe&&!Fe(lm,ze,At)||bl(he,At,ze[At])}),he},lm=function(he){var Ve=ca(he),ze=Fe(b0,this,Ve);return!(this===as&&hn(ks,Ve)&&!hn(yc,Ve))&&(!(ze||!hn(this,Ve)||!hn(ks,Ve)||hn(this,Ra)&&this[Ra][Ve])||ze)},um=function(he,Ve){var ze=wr(he),_e=ca(Ve);if(ze!==as||!hn(ks,_e)||hn(yc,_e)){var At=sm(ze,_e);return!At||!hn(ks,_e)||hn(ze,Ra)&&ze[Ra][_e]||(At.enumerable=!0),At}},dm=function(he){var Ve=im(wr(he)),ze=[];return vl(Ve,function(_e){hn(ks,_e)||hn(Ni,_e)||cm(ze,_e)}),ze},pm=function(xe){var he=xe===as,Ve=im(he?yc:wr(xe)),ze=[];return vl(Ve,function(_e){!hn(ks,_e)||he&&!hn(as,_e)||cm(ze,ks[_e])}),ze};Fr||(di=function(){if(sr(vc,this))throw y0("Symbol is not a constructor");var he=arguments.length&&arguments[0]!==void 0?rs(arguments[0]):void 0,Ve=Do(he),ze=function(_e){this===as&&Fe(ze,yc,_e),hn(this,Ra)&&hn(this[Ra],Ve)&&(this[Ra][Ve]=!1),Ku(this,Ve,nr(1,_e))};return qe&&Gu&&Ku(as,Ve,{configurable:!0,set:ze}),Qu(Ve,he)},vc=di.prototype,Hs(vc,"toString",function(){return am(this).tag}),Hs(di,"withoutSetter",function(xe){return Qu(Do(xe),xe)}),er.f=lm,Oa.f=bl,$f.f=Ju,Da.f=um,gc.f=qu.f=dm,hc.f=pm,Hu.f=function(xe){return Qu(To(xe),xe)},qe&&Gs(vc,"description",{configurable:!0,get:function(){return am(this).description}})),xn({global:!0,constructor:!0,wrap:!0,forced:!Fr,sham:!Fr},{Symbol:di}),vl(Vs(S0),function(xe){Vo(xe)}),xn({target:yl,stat:!0,forced:!Fr},{useSetter:function(){Gu=!0},useSimple:function(){Gu=!1}}),xn({target:"Object",stat:!0,forced:!Fr,sham:!qe},{create:function(he,Ve){return Ve===void 0?es(he):Ju(es(he),Ve)},defineProperty:bl,defineProperties:Ju,getOwnPropertyDescriptor:um}),xn({target:"Object",stat:!0,forced:!Fr},{getOwnPropertyNames:dm}),Zf(),li(di,yl),Ni[Ra]=!0;var fm=Fr&&!!Symbol.for&&!!Symbol.keyFor,Yu=Bn("string-to-symbol-registry"),T0=Bn("symbol-to-string-registry");xn({target:"Symbol",stat:!0,forced:!fm},{for:function(xe){var he=rs(xe);if(hn(Yu,he))return Yu[he];var Ve=Er("Symbol")(he);return Yu[he]=Ve,T0[Ve]=he,Ve}});var mm=Bn("symbol-to-string-registry");xn({target:"Symbol",stat:!0,forced:!fm},{keyFor:function(he){if(!Ur(he))throw TypeError(vn(he)+" is not a symbol");if(hn(mm,he))return mm[he]}});var Ks=Er("JSON","stringify"),Sl=Ce(/./.exec),gm=Ce("".charAt),C0=Ce("".charCodeAt),M0=Ce("".replace),k0=Ce(1 .toString),w0=/[\uD800-\uDFFF]/g,hm=/^[\uD800-\uDBFF]$/,vm=/^[\uDC00-\uDFFF]$/,ym=!Fr||V(function(){var xe=Er("Symbol")();return Ks([xe])!="[null]"||Ks({a:xe})!="{}"||Ks(Object(xe))!="{}"}),bm=V(function(){return Ks("\uDF06\uD834")!=='"\\udf06\\ud834"'||Ks("\uDEAD")!=='"\\udead"'}),_0=function(xe,he){var Ve=qs(arguments),ze=he;if((mr(he)||xe!==void 0)&&!Ur(xe))return Ms(he)||(he=function(_e,At){if(Ue(ze)&&(At=Fe(ze,this,_e,At)),!Ur(At))return At}),Ve[1]=he,ue(Ks,null,Ve)},x0=function(xe,he,Ve){var ze=gm(Ve,he-1),_e=gm(Ve,he+1);return Sl(hm,xe)&&!Sl(vm,_e)||Sl(vm,xe)&&!Sl(hm,ze)?"\\u"+k0(C0(xe,0),16):xe};Ks&&xn({target:"JSON",stat:!0,arity:3,forced:ym||bm},{stringify:function(he,Ve,ze){var _e=qs(arguments),At=ue(ym?_0:Ks,null,_e);return bm&&typeof At=="string"?M0(At,w0,x0):At}});var I0=!Fr||V(function(){hc.f(1)});xn({target:"Object",stat:!0,forced:I0},{getOwnPropertySymbols:function(he){var Ve=hc.f;return Ve?Ve(In(he)):[]}}),Vo("asyncIterator"),Vo("hasInstance"),Vo("isConcatSpreadable"),Vo("iterator"),Vo("match"),Vo("matchAll"),Vo("replace"),Vo("search"),Vo("species"),Vo("split"),Vo("toPrimitive"),Zf(),Vo("toStringTag"),li(Er("Symbol"),"Symbol"),Vo("unscopables"),li($.JSON,"JSON",!0);var Qs,Sm,Tm,E0=Ir.Symbol,ws={},Cm=Function.prototype,P0=qe&&Object.getOwnPropertyDescriptor,Xu=hn(Cm,"name"),A0={EXISTS:Xu,PROPER:Xu&&(function(){}).name==="something",CONFIGURABLE:Xu&&(!qe||qe&&P0(Cm,"name").configurable)},Mm=!V(function(){function xe(){}return xe.prototype.constructor=null,Object.getPrototypeOf(new xe)!==xe.prototype}),km=pl("IE_PROTO"),Zu=Object,N0=Zu.prototype,Ri=Mm?Zu.getPrototypeOf:function(xe){var he=In(xe);if(hn(he,km))return he[km];var Ve=he.constructor;return Ue(Ve)&&he instanceof Ve?Ve.prototype:he instanceof Zu?N0:null},ed=To("iterator"),wm=!1;[].keys&&("next"in(Tm=[].keys())?(Sm=Ri(Ri(Tm)))!==Object.prototype&&(Qs=Sm):wm=!0);var O0=!mr(Qs)||V(function(){var xe={};return Qs[ed].call(xe)!==xe});Qs=O0?{}:es(Qs),Ue(Qs[ed])||Hs(Qs,ed,function(){return this});var _m={IteratorPrototype:Qs,BUGGY_SAFARI_ITERATORS:wm},R0=_m.IteratorPrototype,B0=function(){return this},F0=A0.PROPER,Tl=_m.BUGGY_SAFARI_ITERATORS,td=To("iterator"),xm="keys",Cl="values",Im="entries",L0=function(){return this},rd=function(xe,he,Ve,ze,_e,At,ar){(function(Pn,En,Nn,zn){var yo=En+" Iterator";Pn.prototype=es(R0,{next:nr(+!zn,Nn)}),li(Pn,yo,!1,!0),ws[yo]=B0})(Ve,he,ze);var Dt,vr,Cr,Ar=function(Pn){if(Pn===_e&&Sn)return Sn;if(!Tl&&Pn in Hr)return Hr[Pn];switch(Pn){case xm:return function(){return new Ve(this,Pn)};case Cl:return function(){return new Ve(this,Pn)};case Im:return function(){return new Ve(this,Pn)}}return function(){return new Ve(this)}},$r=he+" Iterator",jr=!1,Hr=xe.prototype,Kr=Hr[td]||Hr["@@iterator"]||_e&&Hr[_e],Sn=!Tl&&Kr||Ar(_e),Cn=he=="Array"&&Hr.entries||Kr;if(Cn&&(Dt=Ri(Cn.call(new xe)))!==Object.prototype&&Dt.next&&(li(Dt,$r,!0,!0),ws[$r]=L0),F0&&_e==Cl&&Kr&&Kr.name!==Cl&&(jr=!0,Sn=function(){return Fe(Kr,this)}),_e)if(vr={values:Ar(Cl),keys:At?Sn:Ar(xm),entries:Ar(Im)},ar)for(Cr in vr)(Tl||jr||!(Cr in Hr))&&Hs(Hr,Cr,vr[Cr]);else xn({target:he,proto:!0,forced:Tl||jr},vr);return ar&&Hr[td]!==Sn&&Hs(Hr,td,Sn,{name:_e}),ws[he]=Sn,vr};Oa.f;var Em="Array Iterator",$0=ts.set,j0=ts.getterFor(Em);rd(Array,"Array",function(xe,he){$0(this,{type:Em,target:wr(xe),index:0,kind:he})},function(){var xe=j0(this),he=xe.target,Ve=xe.kind,ze=xe.index++;return!he||ze>=he.length?(xe.target=void 0,{value:void 0,done:!0}):Ve=="keys"?{value:ze,done:!1}:Ve=="values"?{value:he[ze],done:!1}:{value:[ze,he[ze]],done:!1}},"values"),ws.Arguments=ws.Array;var Pm=To("toStringTag");for(var nd in{CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}){var Am=$[nd],od=Am&&Am.prototype;od&&ci(od)!==Pm&&va(od,Pm,nd),ws[nd]=ws.Array}var D0=E0;Vo("asyncDispose"),Vo("dispose"),Vo("matcher"),Vo("metadataKey"),Vo("observable"),Vo("metadata"),Vo("patternMatch"),Vo("replaceAll");var Ua=D0,U0=Ce("".charAt),Nm=Ce("".charCodeAt),V0=Ce("".slice),Om=function(xe){return function(he,Ve){var ze,_e,At=rs(Sr(he)),ar=uc(Ve),Dt=At.length;return ar<0||ar>=Dt?xe?"":void 0:(ze=Nm(At,ar))<55296||ze>56319||ar+1===Dt||(_e=Nm(At,ar+1))<56320||_e>57343?xe?U0(At,ar):ze:xe?V0(At,ar,ar+2):_e-56320+(ze-55296<<10)+65536}},q0={codeAt:Om(!1),charAt:Om(!0)}.charAt,Rm="String Iterator",H0=ts.set,z0=ts.getterFor(Rm);rd(String,"String",function(xe){H0(this,{type:Rm,string:rs(xe),index:0})},function(){var he,Ve=z0(this),ze=Ve.string,_e=Ve.index;return _e>=ze.length?{value:void 0,done:!0}:(he=q0(ze,_e),Ve.index+=he.length,{value:he,done:!1})});var Bm=Hu.f("iterator"),W0=g(function(xe){function he(Ve){return xe.exports=he=typeof Ua=="function"&&typeof Bm=="symbol"?function(ze){return typeof ze}:function(ze){return ze&&typeof Ua=="function"&&ze.constructor===Ua&&ze!==Ua.prototype?"symbol":typeof ze},xe.exports.__esModule=!0,xe.exports.default=xe.exports,he(Ve)}xe.exports=he,xe.exports.__esModule=!0,xe.exports.default=xe.exports}),Fm=Oa.f;xn({target:"Object",stat:!0,forced:Object.defineProperty!==Fm,sham:!qe},{defineProperty:Fm});var G0=g(function(xe){var he=Ir.Object,Ve=xe.exports=function(_e,At,ar){return he.defineProperty(_e,At,ar)};he.defineProperty.sham&&(Ve.sham=!0)}),bc=G0,K0=V(function(){Ri(1)});xn({target:"Object",stat:!0,forced:K0,sham:!Mm},{getPrototypeOf:function(he){return Ri(In(he))}});var pi=Ir.Object.getPrototypeOf,fi=function(xe,he){var Ve=[][xe];return!!Ve&&V(function(){Ve.call(null,he||function(){return 1},1)})},Q0=Ws.forEach,Lm=fi("forEach")?[].forEach:function(he){return Q0(this,he,arguments.length>1?arguments[1]:void 0)};xn({target:"Array",proto:!0,forced:[].forEach!=Lm},{forEach:Lm});var J0=sa("Array").forEach,ad=Array.prototype,Y0={DOMTokenList:!0,NodeList:!0},Qn=function(xe){var he=xe.forEach;return xe===ad||sr(ad,xe)&&he===ad.forEach||hn(Y0,ci(xe))?J0:he},X0=Ce([].concat),Z0=Er("Reflect","ownKeys")||function(he){var Ve=gc.f(po(he)),ze=hc.f;return ze?X0(Ve,ze(he)):Ve},$m=Error,e1=Ce("".replace),t1=String($m("zxcasd").stack),jm=/\n\s*at [^:]*:[^\n]*/,r1=jm.test(t1),n1=function(xe,he){if(r1&&typeof xe=="string"&&!$m.prepareStackTrace)for(;he--;)xe=e1(xe,jm,"");return xe},o1=function(xe,he){mr(he)&&"cause"in he&&va(xe,"cause",he.cause)},a1=To("iterator"),s1=Array.prototype,Dm=function(xe){return xe!==void 0&&(ws.Array===xe||s1[a1]===xe)},i1=To("iterator"),Ml=function(xe){if(!lr(xe))return jn(xe,i1)||jn(xe,"@@iterator")||ws[ci(xe)]},c1=TypeError,Sc=function(xe,he){var Ve=arguments.length<2?Ml(xe):he;if(Yr(Ve))return po(Fe(Ve,xe));throw c1(vn(xe)+" is not iterable")},sd=function(xe,he,Ve){var ze,_e;po(xe);try{if(!(ze=jn(xe,"return"))){if(he==="throw")throw Ve;return Ve}ze=Fe(ze,xe)}catch(At){_e=!0,ze=At}if(he==="throw")throw Ve;if(_e)throw ze;return po(ze),Ve},l1=TypeError,kl=function(xe,he){this.stopped=xe,this.result=he},Um=kl.prototype,_o=function(xe,he,Ve){var ze,_e,At,ar,Dt,vr,Cr,Ar=Ve&&Ve.that,$r=!(!Ve||!Ve.AS_ENTRIES),jr=!(!Ve||!Ve.IS_RECORD),Hr=!(!Ve||!Ve.IS_ITERATOR),Kr=!(!Ve||!Ve.INTERRUPTED),Sn=Go(he,Ar),Cn=function(En){return ze&&sd(ze,"normal",En),new kl(!0,En)},Pn=function(En){return $r?(po(En),Kr?Sn(En[0],En[1],Cn):Sn(En[0],En[1])):Kr?Sn(En,Cn):Sn(En)};if(jr)ze=xe.iterator;else if(Hr)ze=xe;else{if(!(_e=Ml(xe)))throw l1(vn(xe)+" is not iterable");if(Dm(_e)){for(At=0,ar=Za(xe);ar>At;At++)if((Dt=Pn(xe[At]))&&sr(Um,Dt))return Dt;return new kl(!1)}ze=Sc(xe,_e)}for(vr=jr?xe.next:ze.next;!(Cr=Fe(vr,ze)).done;){try{Dt=Pn(Cr.value)}catch(En){sd(ze,"throw",En)}if(typeof Dt=="object"&&Dt&&sr(Um,Dt))return Dt}return new kl(!1)},u1=function(xe,he){return xe===void 0?arguments.length<2?"":he:rs(xe)},d1=!V(function(){var xe=Error("a");return!("stack"in xe)||(Object.defineProperty(xe,"stack",nr(1,7)),xe.stack!==7)}),p1=To("toStringTag"),wl=Error,f1=[].push,Tc=function(he,Ve){var ze,_e=arguments.length>2?arguments[2]:void 0,At=sr(id,this);dc?ze=dc(wl(),At?Ri(this):id):(ze=At?this:es(id),va(ze,p1,"Error")),Ve!==void 0&&va(ze,"message",u1(Ve)),d1&&va(ze,"stack",n1(ze.stack,1)),o1(ze,_e);var ar=[];return _o(he,f1,{that:ar}),va(ze,"errors",ar),ze};dc?dc(Tc,wl):function(xe,he,Ve){for(var ze=Z0(he),_e=Oa.f,At=Da.f,ar=0;ar<ze.length;ar++){var Dt=ze[ar];hn(xe,Dt)||Ve&&hn(Ve,Dt)||_e(xe,Dt,At(he,Dt))}}(Tc,wl,{name:!0});var id=Tc.prototype=es(wl.prototype,{constructor:nr(1,Tc),message:nr(1,""),name:nr(1,"AggregateError")});xn({global:!0,constructor:!0,arity:2},{AggregateError:Tc});var Cc,Bi,Vm,cd,ds=tr($.process)=="process",qm=To("species"),Hm=function(xe){var he=Er(xe),Ve=Oa.f;qe&&he&&!he[qm]&&Ve(he,qm,{configurable:!0,get:function(){return this}})},m1=TypeError,ld=function(xe,he){if(sr(he,xe))return xe;throw m1("Incorrect invocation")},g1=TypeError,_l=function(xe){if(ml(xe))return xe;throw g1(vn(xe)+" is not a constructor")},h1=To("species"),Js=function(xe,he){var Ve,ze=po(xe).constructor;return ze===void 0||lr(Ve=po(ze)[h1])?he:_l(Ve)},v1=TypeError,zm=function(xe,he){if(xe<he)throw v1("Not enough arguments");return xe},Wm=/(?:ipad|iphone|ipod).*applewebkit/i.test(xr),ud=$.setImmediate,dd=$.clearImmediate,y1=$.process,pd=$.Dispatch,b1=$.Function,Gm=$.MessageChannel,S1=$.String,fd=0,Mc={},T1="onreadystatechange";try{Cc=$.location}catch{}var md=function(xe){if(hn(Mc,xe)){var he=Mc[xe];delete Mc[xe],he()}},gd=function(xe){return function(){md(xe)}},Km=function(xe){md(xe.data)},Qm=function(xe){$.postMessage(S1(xe),Cc.protocol+"//"+Cc.host)};ud&&dd||(ud=function(he){zm(arguments.length,1);var Ve=Ue(he)?he:b1(he),ze=qs(arguments,1);return Mc[++fd]=function(){ue(Ve,void 0,ze)},Bi(fd),fd},dd=function(he){delete Mc[he]},ds?Bi=function(xe){y1.nextTick(gd(xe))}:pd&&pd.now?Bi=function(xe){pd.now(gd(xe))}:Gm&&!Wm?(cd=(Vm=new Gm).port2,Vm.port1.onmessage=Km,Bi=Go(cd.postMessage,cd)):$.addEventListener&&Ue($.postMessage)&&!$.importScripts&&Cc&&Cc.protocol!=="file:"&&!V(Qm)?(Bi=Qm,$.addEventListener("message",Km,!1)):Bi=T1 in Xo("script")?function(xe){Nu.appendChild(Xo("script")).onreadystatechange=function(){Nu.removeChild(this),md(xe)}}:function(xe){setTimeout(gd(xe),0)});var kc,mi,wc,Fi,hd,vd,yd,Jm,Ym={set:ud,clear:dd},C1=/ipad|iphone|ipod/i.test(xr)&&$.Pebble!==void 0,M1=/web0s(?!.*chrome)/i.test(xr),k1=Da.f,bd=Ym.set,Xm=$.MutationObserver||$.WebKitMutationObserver,Zm=$.document,eg=$.process,xl=$.Promise,tg=k1($,"queueMicrotask"),rg=tg&&tg.value;rg||(kc=function(){var xe,he;for(ds&&(xe=eg.domain)&&xe.exit();mi;){he=mi.fn,mi=mi.next;try{he()}catch(Ve){throw mi?Fi():wc=void 0,Ve}}wc=void 0,xe&&xe.enter()},Wm||ds||M1||!Xm||!Zm?!C1&&xl&&xl.resolve?((yd=xl.resolve(void 0)).constructor=xl,Jm=Go(yd.then,yd),Fi=function(){Jm(kc)}):ds?Fi=function(){eg.nextTick(kc)}:(bd=Go(bd,$),Fi=function(){bd(kc)}):(hd=!0,vd=Zm.createTextNode(""),new Xm(kc).observe(vd,{characterData:!0}),Fi=function(){vd.data=hd=!hd}));var Sd=rg||function(xe){var he={fn:xe,next:void 0};wc&&(wc.next=he),mi||(mi=he,Fi()),wc=he},Li=function(xe){try{return{error:!1,value:xe()}}catch(he){return{error:!0,value:he}}},ng=function(){this.head=null,this.tail=null};ng.prototype={add:function(xe){var he={item:xe,next:null};this.head?this.tail.next=he:this.head=he,this.tail=he},get:function(){var xe=this.head;if(xe)return this.head=xe.next,this.tail===xe&&(this.tail=null),xe.item}};var Td,og,w1=ng,Ma=$.Promise,ag=typeof Deno=="object"&&Deno&&typeof Deno.version=="object",_1=!ag&&!ds&&typeof window=="object"&&typeof document=="object",sg=Ma&&Ma.prototype,x1=To("species"),ig=!1,cg=Ue($.PromiseRejectionEvent),I1=vs("Promise",function(){var xe=zf(Ma),he=xe!==String(Ma);if(!he&&Br===66||!sg.catch||!sg.finally)return!0;if(!Br||Br<51||!/native code/.test(xe)){var Ve=new Ma(function(_e){_e(1)}),ze=function(_e){_e(function(){},function(){})};if((Ve.constructor={})[x1]=ze,!(ig=Ve.then(function(){})instanceof ze))return!0}return!he&&(_1||ag)&&!cg}),$i={CONSTRUCTOR:I1,REJECTION_EVENT:cg,SUBCLASSING:ig},E1=TypeError,P1=function(xe){var he,Ve;this.promise=new xe(function(ze,_e){if(he!==void 0||Ve!==void 0)throw E1("Bad Promise constructor");he=ze,Ve=_e}),this.resolve=Yr(he),this.reject=Yr(Ve)},_s={f:function(xe){return new P1(xe)}},lg=Ym.set,Il="Promise",ug=$i.CONSTRUCTOR,A1=$i.REJECTION_EVENT,Cd=ts.getterFor(Il),N1=ts.set,O1=Ma&&Ma.prototype,_c=Ma,Md=O1,dg=$.TypeError,kd=$.document,wd=$.process,_d=_s.f,R1=_d,B1=!!(kd&&kd.createEvent&&$.dispatchEvent),pg="unhandledrejection",fg=function(xe){var he;return!(!mr(xe)||!Ue(he=xe.then))&&he},mg=function(xe,he){var Ve,ze,_e,At=he.value,ar=he.state==1,Dt=ar?xe.ok:xe.fail,vr=xe.resolve,Cr=xe.reject,Ar=xe.domain;try{Dt?(ar||(he.rejection===2&&L1(he),he.rejection=1),Dt===!0?Ve=At:(Ar&&Ar.enter(),Ve=Dt(At),Ar&&(Ar.exit(),_e=!0)),Ve===xe.promise?Cr(dg("Promise-chain cycle")):(ze=fg(Ve))?Fe(ze,Ve,vr,Cr):vr(Ve)):Cr(At)}catch($r){Ar&&!_e&&Ar.exit(),Cr($r)}},gg=function(xe,he){xe.notified||(xe.notified=!0,Sd(function(){for(var Ve,ze=xe.reactions;Ve=ze.get();)mg(Ve,xe);xe.notified=!1,he&&!xe.rejection&&F1(xe)}))},hg=function(xe,he,Ve){var ze,_e;B1?((ze=kd.createEvent("Event")).promise=he,ze.reason=Ve,ze.initEvent(xe,!1,!0),$.dispatchEvent(ze)):ze={promise:he,reason:Ve},!A1&&(_e=$["on"+xe])?_e(ze):xe===pg&&function(At,ar){var Dt=$.console;Dt&&Dt.error&&(arguments.length==1?Dt.error(At):Dt.error(At,ar))}("Unhandled promise rejection",Ve)},F1=function(xe){Fe(lg,$,function(){var he,Ve=xe.facade,ze=xe.value;if(vg(xe)&&(he=Li(function(){ds?wd.emit("unhandledRejection",ze,Ve):hg(pg,Ve,ze)}),xe.rejection=ds||vg(xe)?2:1,he.error))throw he.value})},vg=function(xe){return xe.rejection!==1&&!xe.parent},L1=function(xe){Fe(lg,$,function(){var he=xe.facade;ds?wd.emit("rejectionHandled",he):hg("rejectionhandled",he,xe.value)})},ji=function(xe,he,Ve){return function(ze){xe(he,ze,Ve)}},Di=function(xe,he,Ve){xe.done||(xe.done=!0,Ve&&(xe=Ve),xe.value=he,xe.state=2,gg(xe,!0))},xd=function(xe,he,Ve){if(!xe.done){xe.done=!0,Ve&&(xe=Ve);try{if(xe.facade===he)throw dg("Promise can't be resolved itself");var ze=fg(he);ze?Sd(function(){var _e={done:!1};try{Fe(ze,he,ji(xd,_e,xe),ji(Di,_e,xe))}catch(At){Di(_e,At,xe)}}):(xe.value=he,xe.state=1,gg(xe,!1))}catch(_e){Di({done:!1},_e,xe)}}};ug&&(Md=(_c=function(he){ld(this,Md),Yr(he),Fe(Td,this);var Ve=Cd(this);try{he(ji(xd,Ve),ji(Di,Ve))}catch(ze){Di(Ve,ze)}}).prototype,(Td=function(he){N1(this,{type:Il,done:!1,notified:!1,parent:!1,reactions:new w1,rejection:!1,state:0,value:void 0})}).prototype=Hs(Md,"then",function(he,Ve){var ze=Cd(this),_e=_d(Js(this,_c));return ze.parent=!0,_e.ok=!Ue(he)||he,_e.fail=Ue(Ve)&&Ve,_e.domain=ds?wd.domain:void 0,ze.state==0?ze.reactions.add(_e):Sd(function(){mg(_e,ze)}),_e.promise}),og=function(){var xe=new Td,he=Cd(xe);this.promise=xe,this.resolve=ji(xd,he),this.reject=ji(Di,he)},_s.f=_d=function(xe){return xe===_c||xe===void 0?new og(xe):R1(xe)}),xn({global:!0,constructor:!0,wrap:!0,forced:ug},{Promise:_c}),li(_c,Il,!1,!0),Hm(Il);var yg=To("iterator"),bg=!1;try{var $1=0,Sg={next:function(){return{done:!!$1++}},return:function(){bg=!0}};Sg[yg]=function(){return this},Array.from(Sg,function(){throw 2})}catch{}var Tg=function(xe,he){if(!he&&!bg)return!1;var Ve=!1;try{var ze={};ze[yg]=function(){return{next:function(){return{done:Ve=!0}}}},xe(ze)}catch{}return Ve},Cg=$i.CONSTRUCTOR||!Tg(function(xe){Ma.all(xe).then(void 0,function(){})});xn({target:"Promise",stat:!0,forced:Cg},{all:function(he){var Ve=this,ze=_s.f(Ve),_e=ze.resolve,At=ze.reject,ar=Li(function(){var Dt=Yr(Ve.resolve),vr=[],Cr=0,Ar=1;_o(he,function($r){var jr=Cr++,Hr=!1;Ar++,Fe(Dt,Ve,$r).then(function(Kr){Hr||(Hr=!0,vr[jr]=Kr,--Ar||_e(vr))},At)}),--Ar||_e(vr)});return ar.error&&At(ar.value),ze.promise}});var j1=$i.CONSTRUCTOR;Ma&&Ma.prototype,xn({target:"Promise",proto:!0,forced:j1,real:!0},{catch:function(xe){return this.then(void 0,xe)}}),xn({target:"Promise",stat:!0,forced:Cg},{race:function(he){var Ve=this,ze=_s.f(Ve),_e=ze.reject,At=Li(function(){var ar=Yr(Ve.resolve);_o(he,function(Dt){Fe(ar,Ve,Dt).then(ze.resolve,_e)})});return At.error&&_e(At.value),ze.promise}}),xn({target:"Promise",stat:!0,forced:$i.CONSTRUCTOR},{reject:function(he){var Ve=_s.f(this);return Fe(Ve.reject,void 0,he),Ve.promise}});var Id=function(xe,he){if(po(xe),mr(he)&&he.constructor===xe)return he;var Ve=_s.f(xe);return(0,Ve.resolve)(he),Ve.promise},D1=$i.CONSTRUCTOR,U1=Er("Promise"),V1=!D1;xn({target:"Promise",stat:!0,forced:!0},{resolve:function(he){return Id(V1&&this===U1?Ma:this,he)}}),xn({target:"Promise",stat:!0},{allSettled:function(he){var Ve=this,ze=_s.f(Ve),_e=ze.resolve,At=ze.reject,ar=Li(function(){var Dt=Yr(Ve.resolve),vr=[],Cr=0,Ar=1;_o(he,function($r){var jr=Cr++,Hr=!1;Ar++,Fe(Dt,Ve,$r).then(function(Kr){Hr||(Hr=!0,vr[jr]={status:"fulfilled",value:Kr},--Ar||_e(vr))},function(Kr){Hr||(Hr=!0,vr[jr]={status:"rejected",reason:Kr},--Ar||_e(vr))})}),--Ar||_e(vr)});return ar.error&&At(ar.value),ze.promise}});var Mg="No one promise resolved";xn({target:"Promise",stat:!0},{any:function(he){var Ve=this,ze=Er("AggregateError"),_e=_s.f(Ve),At=_e.resolve,ar=_e.reject,Dt=Li(function(){var vr=Yr(Ve.resolve),Cr=[],Ar=0,$r=1,jr=!1;_o(he,function(Hr){var Kr=Ar++,Sn=!1;$r++,Fe(vr,Ve,Hr).then(function(Cn){Sn||jr||(jr=!0,At(Cn))},function(Cn){Sn||jr||(Sn=!0,Cr[Kr]=Cn,--$r||ar(new ze(Cr,Mg)))})}),--$r||ar(new ze(Cr,Mg))});return Dt.error&&ar(Dt.value),_e.promise}});var q1=Ma&&Ma.prototype,H1=!!Ma&&V(function(){q1.finally.call({then:function(){}},function(){})});xn({target:"Promise",proto:!0,real:!0,forced:H1},{finally:function(xe){var he=Js(this,Er("Promise")),Ve=Ue(xe);return this.then(Ve?function(ze){return Id(he,xe()).then(function(){return ze})}:xe,Ve?function(ze){return Id(he,xe()).then(function(){throw ze})}:xe)}});var z1=Ir.Promise;xn({target:"Promise",stat:!0,forced:!0},{try:function(xe){var he=_s.f(this),Ve=Li(xe);return(Ve.error?he.reject:he.resolve)(Ve.value),he.promise}});var xo=z1,W1=Ce([].reverse),kg=[1,2];xn({target:"Array",proto:!0,forced:String(kg)===String(kg.reverse())},{reverse:function(){return Ms(this)&&(this.length=this.length),W1(this)}});var G1=sa("Array").reverse,Ed=Array.prototype,Yl=function(xe){var he=xe.reverse;return xe===Ed||sr(Ed,xe)&&he===Ed.reverse?G1:he},K1=fc("slice"),Q1=To("species"),Pd=Array,J1=Math.max;xn({target:"Array",proto:!0,forced:!K1},{slice:function(he,Ve){var ze,_e,At,ar=wr(this),Dt=Za(ar),vr=Ai(he,Dt),Cr=Ai(Ve===void 0?Dt:Ve,Dt);if(Ms(ar)&&(ze=ar.constructor,(ml(ze)&&(ze===Pd||Ms(ze.prototype))||mr(ze)&&(ze=ze[Q1])===null)&&(ze=void 0),ze===Pd||ze===void 0))return qs(ar,vr,Cr);for(_e=new(ze===void 0?Pd:ze)(J1(Cr-vr,0)),At=0;vr<Cr;vr++,At++)vr in ar&&ii(_e,At,ar[vr]);return _e.length=At,_e}});var Y1=sa("Array").slice,Ad=Array.prototype,$o=function(xe){var he=xe.slice;return xe===Ad||sr(Ad,xe)&&he===Ad.slice?Y1:he},X1=g(function(xe){var he=W0.default;function Ve(){xe.exports=Ve=function(){return ze},xe.exports.__esModule=!0,xe.exports.default=xe.exports;var ze={},_e=Object.prototype,At=_e.hasOwnProperty,ar=typeof Ua=="function"?Ua:{},Dt=ar.iterator||"@@iterator",vr=ar.asyncIterator||"@@asyncIterator",Cr=ar.toStringTag||"@@toStringTag";function Ar(Wn,Un,no){return bc(Wn,Un,{value:no,enumerable:!0,configurable:!0,writable:!0}),Wn[Un]}try{Ar({},"")}catch{Ar=function(no,uo,Mo){return no[uo]=Mo}}function $r(Wn,Un,no,uo){var Mo=Un&&Un.prototype instanceof Kr?Un:Kr,wo=Cs(Mo.prototype),pa=new Wr(uo||[]);return wo._invoke=function(Jo,ls,jo){var Yo="suspendedStart";return function(wa,ul){if(Yo==="executing")throw new Error("Generator is already running");if(Yo==="completed"){if(wa==="throw")throw ul;return oo()}for(jo.method=wa,jo.arg=ul;;){var ra=jo.delegate;if(ra){var qc=fo(ra,jo);if(qc){if(qc===Hr)continue;return qc}}if(jo.method==="next")jo.sent=jo._sent=jo.arg;else if(jo.method==="throw"){if(Yo==="suspendedStart")throw Yo="completed",jo.arg;jo.dispatchException(jo.arg)}else jo.method==="return"&&jo.abrupt("return",jo.arg);Yo="executing";var hs=jr(Jo,ls,jo);if(hs.type==="normal"){if(Yo=jo.done?"completed":"suspendedYield",hs.arg===Hr)continue;return{value:hs.arg,done:jo.done}}hs.type==="throw"&&(Yo="completed",jo.method="throw",jo.arg=hs.arg)}}}(Wn,no,pa),wo}function jr(Wn,Un,no){try{return{type:"normal",arg:Wn.call(Un,no)}}catch(uo){return{type:"throw",arg:uo}}}ze.wrap=$r;var Hr={};function Kr(){}function Sn(){}function Cn(){}var Pn={};Ar(Pn,Dt,function(){return this});var En=pi&&pi(pi(Yn([])));En&&En!==_e&&At.call(En,Dt)&&(Pn=En);var Nn=Cn.prototype=Kr.prototype=Cs(Pn);function zn(Wn){var Un;Qn(Un=["next","throw","return"]).call(Un,function(no){Ar(Wn,no,function(uo){return this._invoke(no,uo)})})}function yo(Wn,Un){function no(Mo,wo,pa,Jo){var ls=jr(Wn[Mo],Wn,wo);if(ls.type!=="throw"){var jo=ls.arg,Yo=jo.value;return Yo&&he(Yo)=="object"&&At.call(Yo,"__await")?Un.resolve(Yo.__await).then(function(wa){no("next",wa,pa,Jo)},function(wa){no("throw",wa,pa,Jo)}):Un.resolve(Yo).then(function(wa){jo.value=wa,pa(jo)},function(wa){return no("throw",wa,pa,Jo)})}Jo(ls.arg)}var uo;this._invoke=function(Mo,wo){function pa(){return new Un(function(Jo,ls){no(Mo,wo,Jo,ls)})}return uo=uo?uo.then(pa,pa):pa()}}function fo(Wn,Un){var no=Wn.iterator[Un.method];if(no===void 0){if(Un.delegate=null,Un.method==="throw"){if(Wn.iterator.return&&(Un.method="return",Un.arg=void 0,fo(Wn,Un),Un.method==="throw"))return Hr;Un.method="throw",Un.arg=new TypeError("The iterator does not provide a 'throw' method")}return Hr}var uo=jr(no,Wn.iterator,Un.arg);if(uo.type==="throw")return Un.method="throw",Un.arg=uo.arg,Un.delegate=null,Hr;var Mo=uo.arg;return Mo?Mo.done?(Un[Wn.resultName]=Mo.value,Un.next=Wn.nextLoc,Un.method!=="return"&&(Un.method="next",Un.arg=void 0),Un.delegate=null,Hr):Mo:(Un.method="throw",Un.arg=new TypeError("iterator result is not an object"),Un.delegate=null,Hr)}function qo(Wn){var Un={tryLoc:Wn[0]};1 in Wn&&(Un.catchLoc=Wn[1]),2 in Wn&&(Un.finallyLoc=Wn[2],Un.afterLoc=Wn[3]),this.tryEntries.push(Un)}function ao(Wn){var Un=Wn.completion||{};Un.type="normal",delete Un.arg,Wn.completion=Un}function Wr(Wn){this.tryEntries=[{tryLoc:"root"}],Qn(Wn).call(Wn,qo,this),this.reset(!0)}function Yn(Wn){if(Wn){var Un=Wn[Dt];if(Un)return Un.call(Wn);if(typeof Wn.next=="function")return Wn;if(!isNaN(Wn.length)){var no=-1,uo=function Mo(){for(;++no<Wn.length;)if(At.call(Wn,no))return Mo.value=Wn[no],Mo.done=!1,Mo;return Mo.value=void 0,Mo.done=!0,Mo};return uo.next=uo}}return{next:oo}}function oo(){return{value:void 0,done:!0}}return Sn.prototype=Cn,Ar(Nn,"constructor",Cn),Ar(Cn,"constructor",Sn),Sn.displayName=Ar(Cn,Cr,"GeneratorFunction"),ze.isGeneratorFunction=function(Wn){var Un=typeof Wn=="function"&&Wn.constructor;return!!Un&&(Un===Sn||(Un.displayName||Un.name)==="GeneratorFunction")},ze.mark=function(Wn){return si?si(Wn,Cn):(Wn.__proto__=Cn,Ar(Wn,Cr,"GeneratorFunction")),Wn.prototype=Cs(Nn),Wn},ze.awrap=function(Wn){return{__await:Wn}},zn(yo.prototype),Ar(yo.prototype,vr,function(){return this}),ze.AsyncIterator=yo,ze.async=function(Wn,Un,no,uo,Mo){Mo===void 0&&(Mo=xo);var wo=new yo($r(Wn,Un,no,uo),Mo);return ze.isGeneratorFunction(Un)?wo:wo.next().then(function(pa){return pa.done?pa.value:wo.next()})},zn(Nn),Ar(Nn,Cr,"Generator"),Ar(Nn,Dt,function(){return this}),Ar(Nn,"toString",function(){return"[object Generator]"}),ze.keys=function(Wn){var Un=[];for(var no in Wn)Un.push(no);return Yl(Un).call(Un),function uo(){for(;Un.length;){var Mo=Un.pop();if(Mo in Wn)return uo.value=Mo,uo.done=!1,uo}return uo.done=!0,uo}},ze.values=Yn,Wr.prototype={constructor:Wr,reset:function(Un){var no;if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,Qn(no=this.tryEntries).call(no,ao),!Un)for(var uo in this)uo.charAt(0)==="t"&&At.call(this,uo)&&!isNaN(+$o(uo).call(uo,1))&&(this[uo]=void 0)},stop:function(){this.done=!0;var Un=this.tryEntries[0].completion;if(Un.type==="throw")throw Un.arg;return this.rval},dispatchException:function(Un){if(this.done)throw Un;var no=this;function uo(jo,Yo){return pa.type="throw",pa.arg=Un,no.next=jo,Yo&&(no.method="next",no.arg=void 0),!!Yo}for(var Mo=this.tryEntries.length-1;Mo>=0;--Mo){var wo=this.tryEntries[Mo],pa=wo.completion;if(wo.tryLoc==="root")return uo("end");if(wo.tryLoc<=this.prev){var Jo=At.call(wo,"catchLoc"),ls=At.call(wo,"finallyLoc");if(Jo&&ls){if(this.prev<wo.catchLoc)return uo(wo.catchLoc,!0);if(this.prev<wo.finallyLoc)return uo(wo.finallyLoc)}else if(Jo){if(this.prev<wo.catchLoc)return uo(wo.catchLoc,!0)}else{if(!ls)throw new Error("try statement without catch or finally");if(this.prev<wo.finallyLoc)return uo(wo.finallyLoc)}}}},abrupt:function(Un,no){for(var uo=this.tryEntries.length-1;uo>=0;--uo){var Mo=this.tryEntries[uo];if(Mo.tryLoc<=this.prev&&At.call(Mo,"finallyLoc")&&this.prev<Mo.finallyLoc){var wo=Mo;break}}wo&&(Un==="break"||Un==="continue")&&wo.tryLoc<=no&&no<=wo.finallyLoc&&(wo=null);var pa=wo?wo.completion:{};return pa.type=Un,pa.arg=no,wo?(this.method="next",this.next=wo.finallyLoc,Hr):this.complete(pa)},complete:function(Un,no){if(Un.type==="throw")throw Un.arg;return Un.type==="break"||Un.type==="continue"?this.next=Un.arg:Un.type==="return"?(this.rval=this.arg=Un.arg,this.method="return",this.next="end"):Un.type==="normal"&&no&&(this.next=no),Hr},finish:function(Un){for(var no=this.tryEntries.length-1;no>=0;--no){var uo=this.tryEntries[no];if(uo.finallyLoc===Un)return this.complete(uo.completion,uo.afterLoc),ao(uo),Hr}},catch:function(Un){for(var no=this.tryEntries.length-1;no>=0;--no){var uo=this.tryEntries[no];if(uo.tryLoc===Un){var Mo=uo.completion;if(Mo.type==="throw"){var wo=Mo.arg;ao(uo)}return wo}}throw new Error("illegal catch attempt")},delegateYield:function(Un,no,uo){return this.delegate={iterator:Yn(Un),resultName:no,nextLoc:uo},this.method==="next"&&(this.arg=void 0),Hr}},ze}xe.exports=Ve,xe.exports.__esModule=!0,xe.exports.default=xe.exports}),El=X1(),_r=El;try{regeneratorRuntime=El}catch{typeof globalThis=="object"?globalThis.regeneratorRuntime=El:Function("r","regeneratorRuntime = r")(El)}xn({target:"Number",stat:!0,nonConfigurable:!0,nonWritable:!0},{MAX_SAFE_INTEGER:9007199254740991});var wg=9007199254740991,Xl=V(function(){Vs(1)});xn({target:"Object",stat:!0,forced:Xl},{keys:function(he){return Vs(In(he))}});var la=Ir.Object.keys,Zl=Object.assign,_g=Object.defineProperty,Vn=Ce([].concat),eu=!Zl||V(function(){if(qe&&Zl({b:1},Zl(_g({},"a",{enumerable:!0,get:function(){_g(this,"b",{value:3,enumerable:!1})}}),{b:2})).b!==1)return!0;var xe={},he={},Ve=Symbol(),ze="abcdefghijklmnopqrst";return xe[Ve]=7,ze.split("").forEach(function(_e){he[_e]=_e}),Zl({},xe)[Ve]!=7||Vs(Zl({},he)).join("")!=ze})?function(he,Ve){for(var ze=In(he),_e=arguments.length,At=1,ar=hc.f,Dt=er.f;_e>At;)for(var vr,Cr=fr(arguments[At++]),Ar=ar?Vn(Vs(Cr),ar(Cr)):Vs(Cr),$r=Ar.length,jr=0;$r>jr;)vr=Ar[jr++],qe&&!Fe(Dt,Cr,vr)||(ze[vr]=Cr[vr]);return ze}:Zl;xn({target:"Object",stat:!0,arity:2,forced:Object.assign!==eu},{assign:eu});var zr=Ir.Object.assign;Ir.JSON||(Ir.JSON={stringify:JSON.stringify});var Sv=function(he,Ve,ze){return ue(Ir.JSON.stringify,null,arguments)},fa=Sv,xg=Au.indexOf,Ig=Ce([].indexOf),Eg=!!Ig&&1/Ig([1],1,-0)<0,Z1=fi("indexOf");xn({target:"Array",proto:!0,forced:Eg||!Z1},{indexOf:function(he){var Ve=arguments.length>1?arguments[1]:void 0;return Eg?Ig(this,he,Ve)||0:xg(this,he,Ve)}});var eS=sa("Array").indexOf,Pg=Array.prototype,Ja=function(xe){var he=xe.indexOf;return xe===Pg||sr(Pg,xe)&&he===Pg.indexOf?eS:he},Tv=sa("Array").concat,kp=Array.prototype,Ys=function(xe){var he=xe.concat;return xe===kp||sr(kp,xe)&&he===kp.concat?Tv:he};function ri(xe,he){var Ve={};for(var ze in xe)Object.prototype.hasOwnProperty.call(xe,ze)&&he.indexOf(ze)<0&&(Ve[ze]=xe[ze]);if(xe!=null&&typeof Object.getOwnPropertySymbols=="function"){var _e=0;for(ze=Object.getOwnPropertySymbols(xe);_e<ze.length;_e++)he.indexOf(ze[_e])<0&&Object.prototype.propertyIsEnumerable.call(xe,ze[_e])&&(Ve[ze[_e]]=xe[ze[_e]])}return Ve}function qn(xe,he,Ve,ze){return new(Ve||(Ve=Promise))(function(_e,At){function ar(Cr){try{vr(ze.next(Cr))}catch(Ar){At(Ar)}}function Dt(Cr){try{vr(ze.throw(Cr))}catch(Ar){At(Ar)}}function vr(Cr){Cr.done?_e(Cr.value):function($r){return $r instanceof Ve?$r:new Ve(function(jr){jr($r)})}(Cr.value).then(ar,Dt)}vr((ze=ze.apply(xe,he||[])).next())})}var wp=V(function(){if(typeof ArrayBuffer=="function"){var xe=new ArrayBuffer(8);Object.isExtensible(xe)&&Object.defineProperty(xe,"a",{value:8})}}),Nd=Object.isExtensible,Ag=V(function(){Nd(1)})||wp?function(he){return!!mr(he)&&(!wp||tr(he)!="ArrayBuffer")&&(!Nd||Nd(he))}:Nd,Cv=!V(function(){return Object.isExtensible(Object.preventExtensions({}))}),Ng=g(function(xe){var he=Oa.f,Ve=!1,ze=Do("meta"),_e=0,At=function(Dt){he(Dt,ze,{value:{objectID:"O"+_e++,weakData:{}}})},ar=xe.exports={enable:function(){ar.enable=function(){},Ve=!0;var Dt=gc.f,vr=Ce([].splice),Cr={};Cr[ze]=1,Dt(Cr).length&&(gc.f=function(Ar){for(var $r=Dt(Ar),jr=0,Hr=$r.length;jr<Hr;jr++)if($r[jr]===ze){vr($r,jr,1);break}return $r},xn({target:"Object",stat:!0,forced:!0},{getOwnPropertyNames:qu.f}))},fastKey:function(Dt,vr){if(!mr(Dt))return typeof Dt=="symbol"?Dt:(typeof Dt=="string"?"S":"P")+Dt;if(!hn(Dt,ze)){if(!Ag(Dt))return"F";if(!vr)return"E";At(Dt)}return Dt[ze].objectID},getWeakData:function(Dt,vr){if(!hn(Dt,ze)){if(!Ag(Dt))return!0;if(!vr)return!1;At(Dt)}return Dt[ze].weakData},onFreeze:function(Dt){return Cv&&Ve&&Ag(Dt)&&!hn(Dt,ze)&&At(Dt),Dt}};Ni[ze]=!0}),Mv=Oa.f,kv=Ws.forEach,Zi=ts.set,tS=ts.getterFor,wv=function(xe,he,Ve){for(var ze in he)Ve&&Ve.unsafe&&xe[ze]?xe[ze]=he[ze]:Hs(xe,ze,he[ze],Ve);return xe},rS=Oa.f,_v=Ng.fastKey,Og=ts.set,Pl=ts.getterFor,xv={getConstructor:function(xe,he,Ve,ze){var _e=xe(function(Cr,Ar){ld(Cr,At),Og(Cr,{type:he,index:es(null),first:void 0,last:void 0,size:0}),qe||(Cr.size=0),lr(Ar)||_o(Ar,Cr[ze],{that:Cr,AS_ENTRIES:Ve})}),At=_e.prototype,ar=Pl(he),Dt=function(Cr,Ar,$r){var jr,Hr,Kr=ar(Cr),Sn=vr(Cr,Ar);return Sn?Sn.value=$r:(Kr.last=Sn={index:Hr=_v(Ar,!0),key:Ar,value:$r,previous:jr=Kr.last,next:void 0,removed:!1},Kr.first||(Kr.first=Sn),jr&&(jr.next=Sn),qe?Kr.size++:Cr.size++,Hr!=="F"&&(Kr.index[Hr]=Sn)),Cr},vr=function(Cr,Ar){var $r,jr=ar(Cr),Hr=_v(Ar);if(Hr!=="F")return jr.index[Hr];for($r=jr.first;$r;$r=$r.next)if($r.key==Ar)return $r};return wv(At,{clear:function(){for(var Ar=ar(this),$r=Ar.index,jr=Ar.first;jr;)jr.removed=!0,jr.previous&&(jr.previous=jr.previous.next=void 0),delete $r[jr.index],jr=jr.next;Ar.first=Ar.last=void 0,qe?Ar.size=0:this.size=0},delete:function(Cr){var Ar=this,$r=ar(Ar),jr=vr(Ar,Cr);if(jr){var Hr=jr.next,Kr=jr.previous;delete $r.index[jr.index],jr.removed=!0,Kr&&(Kr.next=Hr),Hr&&(Hr.previous=Kr),$r.first==jr&&($r.first=Hr),$r.last==jr&&($r.last=Kr),qe?$r.size--:Ar.size--}return!!jr},forEach:function(Ar){for(var $r,jr=ar(this),Hr=Go(Ar,arguments.length>1?arguments[1]:void 0);$r=$r?$r.next:jr.first;)for(Hr($r.value,$r.key,this);$r&&$r.removed;)$r=$r.previous},has:function(Ar){return!!vr(this,Ar)}}),wv(At,Ve?{get:function(Ar){var $r=vr(this,Ar);return $r&&$r.value},set:function(Ar,$r){return Dt(this,Ar===0?0:Ar,$r)}}:{add:function(Ar){return Dt(this,Ar=Ar===0?0:Ar,Ar)}}),qe&&rS(At,"size",{get:function(){return ar(this).size}}),_e},setStrong:function(xe,he,Ve){var ze=he+" Iterator",_e=Pl(he),At=Pl(ze);rd(xe,he,function(ar,Dt){Og(this,{type:ze,target:ar,state:_e(ar),kind:Dt,last:void 0})},function(){for(var ar=At(this),Dt=ar.kind,vr=ar.last;vr&&vr.removed;)vr=vr.previous;return ar.target&&(ar.last=vr=vr?vr.next:ar.state.first)?Dt=="keys"?{value:vr.key,done:!1}:Dt=="values"?{value:vr.value,done:!1}:{value:[vr.key,vr.value],done:!1}:(ar.target=void 0,{value:void 0,done:!0})},Ve?"entries":"values",!Ve,!0),Hm(he)}};(function(xe,he,Ve){var ze,_e=xe.indexOf("Map")!==-1,At=xe.indexOf("Weak")!==-1,ar=_e?"set":"add",Dt=$[xe],vr=Dt&&Dt.prototype,Cr={};if(qe&&Ue(Dt)&&(At||vr.forEach&&!V(function(){new Dt().entries().next()}))){var Ar=(ze=he(function(jr,Hr){Zi(ld(jr,Ar),{type:xe,collection:new Dt}),Hr!=null&&_o(Hr,jr[ar],{that:jr,AS_ENTRIES:_e})})).prototype,$r=tS(xe);kv(["add","clear","delete","forEach","get","has","set","keys","values","entries"],function(jr){var Hr=jr=="add"||jr=="set";!(jr in vr)||At&&jr=="clear"||va(Ar,jr,function(Kr,Sn){var Cn=$r(this).collection;if(!Hr&&At&&!mr(Kr))return jr=="get"&&void 0;var Pn=Cn[jr](Kr===0?0:Kr,Sn);return Hr?this:Pn})}),At||Mv(Ar,"size",{configurable:!0,get:function(){return $r(this).collection.size}})}else ze=Ve.getConstructor(he,xe,_e,ar),Ng.enable();li(ze,xe,!1,!0),Cr[xe]=ze,xn({global:!0,forced:!0},Cr),At||Ve.setStrong(ze,xe,_e)})("Map",function(xe){return function(){return xe(this,arguments.length?arguments[0]:void 0)}},xv);var nS=Ir.Map,xs=[].push;xn({target:"Map",stat:!0,forced:!0},{from:function(he){var Ve,ze,_e,At,ar=arguments.length,Dt=ar>1?arguments[1]:void 0;return _l(this),(Ve=Dt!==void 0)&&Yr(Dt),lr(he)?new this:(ze=[],Ve?(_e=0,At=Go(Dt,ar>2?arguments[2]:void 0),_o(he,function(vr){Fe(xs,ze,At(vr,_e++))})):_o(he,xs,{that:ze}),new this(ze))}}),xn({target:"Map",stat:!0,forced:!0},{of:function(){return new this(qs(arguments))}}),xn({target:"Map",proto:!0,real:!0,forced:!0},{deleteAll:function(){for(var he,Ve=po(this),ze=Yr(Ve.delete),_e=!0,At=0,ar=arguments.length;At<ar;At++)he=Fe(ze,Ve,arguments[At]),_e=_e&&he;return!!_e}}),xn({target:"Map",proto:!0,real:!0,forced:!0},{emplace:function(he,Ve){var ze,_e,At=po(this),ar=Yr(At.get),Dt=Yr(At.has),vr=Yr(At.set);return Fe(Dt,At,he)?(ze=Fe(ar,At,he),"update"in Ve&&(ze=Ve.update(ze,he,At),Fe(vr,At,he,ze)),ze):(_e=Ve.insert(he,At),Fe(vr,At,he,_e),_e)}});var ec=Sc;xn({target:"Map",proto:!0,real:!0,forced:!0},{every:function(he){var Ve=po(this),ze=ec(Ve),_e=Go(he,arguments.length>1?arguments[1]:void 0);return!_o(ze,function(At,ar,Dt){if(!_e(ar,At,Ve))return Dt()},{AS_ENTRIES:!0,IS_ITERATOR:!0,INTERRUPTED:!0}).stopped}}),xn({target:"Map",proto:!0,real:!0,forced:!0},{filter:function(he){var Ve=po(this),ze=ec(Ve),_e=Go(he,arguments.length>1?arguments[1]:void 0),At=new(Js(Ve,Er("Map"))),ar=Yr(At.set);return _o(ze,function(Dt,vr){_e(vr,Dt,Ve)&&Fe(ar,At,Dt,vr)},{AS_ENTRIES:!0,IS_ITERATOR:!0}),At}}),xn({target:"Map",proto:!0,real:!0,forced:!0},{find:function(he){var Ve=po(this),ze=ec(Ve),_e=Go(he,arguments.length>1?arguments[1]:void 0);return _o(ze,function(At,ar,Dt){if(_e(ar,At,Ve))return Dt(ar)},{AS_ENTRIES:!0,IS_ITERATOR:!0,INTERRUPTED:!0}).result}}),xn({target:"Map",proto:!0,real:!0,forced:!0},{findKey:function(he){var Ve=po(this),ze=ec(Ve),_e=Go(he,arguments.length>1?arguments[1]:void 0);return _o(ze,function(At,ar,Dt){if(_e(ar,At,Ve))return Dt(At)},{AS_ENTRIES:!0,IS_ITERATOR:!0,INTERRUPTED:!0}).result}});var Rg=Ce([].push);xn({target:"Map",stat:!0,forced:!0},{groupBy:function(he,Ve){Yr(Ve);var ze=Sc(he),_e=new this,At=Yr(_e.has),ar=Yr(_e.get),Dt=Yr(_e.set);return _o(ze,function(vr){var Cr=Ve(vr);Fe(At,_e,Cr)?Rg(Fe(ar,_e,Cr),vr):Fe(Dt,_e,Cr,[vr])},{IS_ITERATOR:!0}),_e}}),xn({target:"Map",proto:!0,real:!0,forced:!0},{includes:function(he){return _o(ec(po(this)),function(Ve,ze,_e){if((At=ze)===(ar=he)||At!=At&&ar!=ar)return _e();var At,ar},{AS_ENTRIES:!0,IS_ITERATOR:!0,INTERRUPTED:!0}).stopped}}),xn({target:"Map",stat:!0,forced:!0},{keyBy:function(he,Ve){var ze=new this;Yr(Ve);var _e=Yr(ze.set);return _o(he,function(At){Fe(_e,ze,Ve(At),At)}),ze}}),xn({target:"Map",proto:!0,real:!0,forced:!0},{keyOf:function(he){return _o(ec(po(this)),function(Ve,ze,_e){if(ze===he)return _e(Ve)},{AS_ENTRIES:!0,IS_ITERATOR:!0,INTERRUPTED:!0}).result}}),xn({target:"Map",proto:!0,real:!0,forced:!0},{mapKeys:function(he){var Ve=po(this),ze=ec(Ve),_e=Go(he,arguments.length>1?arguments[1]:void 0),At=new(Js(Ve,Er("Map"))),ar=Yr(At.set);return _o(ze,function(Dt,vr){Fe(ar,At,_e(vr,Dt,Ve),vr)},{AS_ENTRIES:!0,IS_ITERATOR:!0}),At}}),xn({target:"Map",proto:!0,real:!0,forced:!0},{mapValues:function(he){var Ve=po(this),ze=ec(Ve),_e=Go(he,arguments.length>1?arguments[1]:void 0),At=new(Js(Ve,Er("Map"))),ar=Yr(At.set);return _o(ze,function(Dt,vr){Fe(ar,At,Dt,_e(vr,Dt,Ve))},{AS_ENTRIES:!0,IS_ITERATOR:!0}),At}}),xn({target:"Map",proto:!0,real:!0,arity:1,forced:!0},{merge:function(he){for(var Ve=po(this),ze=Yr(Ve.set),_e=arguments.length,At=0;At<_e;)_o(arguments[At++],ze,{that:Ve,AS_ENTRIES:!0});return Ve}});var gi=TypeError;xn({target:"Map",proto:!0,real:!0,forced:!0},{reduce:function(he){var Ve=po(this),ze=ec(Ve),_e=arguments.length<2,At=_e?void 0:arguments[1];if(Yr(he),_o(ze,function(ar,Dt){_e?(_e=!1,At=Dt):At=he(At,Dt,ar,Ve)},{AS_ENTRIES:!0,IS_ITERATOR:!0}),_e)throw gi("Reduce of empty map with no initial value");return At}}),xn({target:"Map",proto:!0,real:!0,forced:!0},{some:function(he){var Ve=po(this),ze=ec(Ve),_e=Go(he,arguments.length>1?arguments[1]:void 0);return _o(ze,function(At,ar,Dt){if(_e(ar,At,Ve))return Dt()},{AS_ENTRIES:!0,IS_ITERATOR:!0,INTERRUPTED:!0}).stopped}});var oS=TypeError;xn({target:"Map",proto:!0,real:!0,forced:!0},{update:function(he,Ve){var ze=po(this),_e=Yr(ze.get),At=Yr(ze.has),ar=Yr(ze.set),Dt=arguments.length;Yr(Ve);var vr=Fe(At,ze,he);if(!vr&&Dt<3)throw oS("Updating absent value");var Cr=vr?Fe(_e,ze,he):Yr(Dt>2?arguments[2]:void 0)(he,ze);return Fe(ar,ze,he,Ve(Cr,he,ze)),ze}});var aS=TypeError,Bg=function(he,Ve){var ze,_e=po(this),At=Yr(_e.get),ar=Yr(_e.has),Dt=Yr(_e.set),vr=arguments.length>2?arguments[2]:void 0;if(!Ue(Ve)&&!Ue(vr))throw aS("At least one callback required");return Fe(ar,_e,he)?(ze=Fe(At,_e,he),Ue(Ve)&&(ze=Ve(ze),Fe(Dt,_e,he,ze))):Ue(vr)&&(ze=vr(),Fe(Dt,_e,he,ze)),ze};xn({target:"Map",proto:!0,real:!0,forced:!0},{upsert:Bg}),xn({target:"Map",proto:!0,real:!0,name:"upsert",forced:!0},{updateOrInsert:Bg});var xc=nS,Fg=Date,Iv=Ce(Fg.prototype.getTime);xn({target:"Date",stat:!0},{now:function(){return Iv(new Fg)}});var Ia=Ir.Date.now,sS=/MSIE .\./.test(xr),Ao=$.Function,Ev=function(xe){return sS?function(he,Ve){var ze=zm(arguments.length,1)>2,_e=Ue(he)?he:Ao(he),At=ze?qs(arguments,2):void 0;return xe(ze?function(){ue(_e,this,At)}:_e,Ve)}:xe},Pv={setTimeout:Ev($.setTimeout),setInterval:Ev($.setInterval)},Av=Pv.setInterval;xn({global:!0,bind:!0,forced:$.setInterval!==Av},{setInterval:Av});var _p=Pv.setTimeout;xn({global:!0,bind:!0,forced:$.setTimeout!==_p},{setTimeout:_p});var Ro=Ir.setTimeout,Lg=Ws.map,iS=fc("map");xn({target:"Array",proto:!0,forced:!iS},{map:function(he){return Lg(this,he,arguments.length>1?arguments[1]:void 0)}});var tu=sa("Array").map,xp=Array.prototype,Fo=function(xe){var he=xe.map;return xe===xp||sr(xp,xe)&&he===xp.map?tu:he},hi=g(function(xe){var he=Object.prototype.hasOwnProperty,Ve="~";function ze(){}function _e(vr,Cr,Ar){this.fn=vr,this.context=Cr,this.once=Ar||!1}function At(vr,Cr,Ar,$r,jr){if(typeof Ar!="function")throw new TypeError("The listener must be a function");var Hr=new _e(Ar,$r||vr,jr),Kr=Ve?Ve+Cr:Cr;return vr._events[Kr]?vr._events[Kr].fn?vr._events[Kr]=[vr._events[Kr],Hr]:vr._events[Kr].push(Hr):(vr._events[Kr]=Hr,vr._eventsCount++),vr}function ar(vr,Cr){--vr._eventsCount==0?vr._events=new ze:delete vr._events[Cr]}function Dt(){this._events=new ze,this._eventsCount=0}Object.create&&(ze.prototype=Object.create(null),new ze().__proto__||(Ve=!1)),Dt.prototype.eventNames=function(){var Cr,Ar,$r=[];if(this._eventsCount===0)return $r;for(Ar in Cr=this._events)he.call(Cr,Ar)&&$r.push(Ve?Ar.slice(1):Ar);return Object.getOwnPropertySymbols?$r.concat(Object.getOwnPropertySymbols(Cr)):$r},Dt.prototype.listeners=function(Cr){var Ar=Ve?Ve+Cr:Cr,$r=this._events[Ar];if(!$r)return[];if($r.fn)return[$r.fn];for(var jr=0,Hr=$r.length,Kr=new Array(Hr);jr<Hr;jr++)Kr[jr]=$r[jr].fn;return Kr},Dt.prototype.listenerCount=function(Cr){var Ar=Ve?Ve+Cr:Cr,$r=this._events[Ar];return $r?$r.fn?1:$r.length:0},Dt.prototype.emit=function(Cr,Ar,$r,jr,Hr,Kr){var Sn=Ve?Ve+Cr:Cr;if(!this._events[Sn])return!1;var Cn,Pn,En=this._events[Sn],Nn=arguments.length;if(En.fn){switch(En.once&&this.removeListener(Cr,En.fn,void 0,!0),Nn){case 1:return En.fn.call(En.context),!0;case 2:return En.fn.call(En.context,Ar),!0;case 3:return En.fn.call(En.context,Ar,$r),!0;case 4:return En.fn.call(En.context,Ar,$r,jr),!0;case 5:return En.fn.call(En.context,Ar,$r,jr,Hr),!0;case 6:return En.fn.call(En.context,Ar,$r,jr,Hr,Kr),!0}for(Pn=1,Cn=new Array(Nn-1);Pn<Nn;Pn++)Cn[Pn-1]=arguments[Pn];En.fn.apply(En.context,Cn)}else{var zn,yo=En.length;for(Pn=0;Pn<yo;Pn++)switch(En[Pn].once&&this.removeListener(Cr,En[Pn].fn,void 0,!0),Nn){case 1:En[Pn].fn.call(En[Pn].context);break;case 2:En[Pn].fn.call(En[Pn].context,Ar);break;case 3:En[Pn].fn.call(En[Pn].context,Ar,$r);break;case 4:En[Pn].fn.call(En[Pn].context,Ar,$r,jr);break;default:if(!Cn)for(zn=1,Cn=new Array(Nn-1);zn<Nn;zn++)Cn[zn-1]=arguments[zn];En[Pn].fn.apply(En[Pn].context,Cn)}}return!0},Dt.prototype.on=function(Cr,Ar,$r){return At(this,Cr,Ar,$r,!1)},Dt.prototype.once=function(Cr,Ar,$r){return At(this,Cr,Ar,$r,!0)},Dt.prototype.removeListener=function(Cr,Ar,$r,jr){var Hr=Ve?Ve+Cr:Cr;if(!this._events[Hr])return this;if(!Ar)return ar(this,Hr),this;var Kr=this._events[Hr];if(Kr.fn)Kr.fn!==Ar||jr&&!Kr.once||$r&&Kr.context!==$r||ar(this,Hr);else{for(var Sn=0,Cn=[],Pn=Kr.length;Sn<Pn;Sn++)(Kr[Sn].fn!==Ar||jr&&!Kr[Sn].once||$r&&Kr[Sn].context!==$r)&&Cn.push(Kr[Sn]);Cn.length?this._events[Hr]=Cn.length===1?Cn[0]:Cn:ar(this,Hr)}return this},Dt.prototype.removeAllListeners=function(Cr){var Ar;return Cr?(Ar=Ve?Ve+Cr:Cr,this._events[Ar]&&ar(this,Ar)):(this._events=new ze,this._eventsCount=0),this},Dt.prototype.off=Dt.prototype.removeListener,Dt.prototype.addListener=Dt.prototype.on,Dt.prefixed=Ve,Dt.EventEmitter=Dt,xe.exports=Dt}),tc=Al;function Al(xe){xe=xe||{},this.ms=xe.min||100,this.max=xe.max||1e4,this.factor=xe.factor||2,this.jitter=xe.jitter>0&&xe.jitter<=1?xe.jitter:0,this.attempts=0}Al.prototype.duration=function(){var xe=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var he=Math.random(),Ve=Math.floor(he*this.jitter*xe);xe=1&Math.floor(10*he)?xe+Ve:xe-Ve}return 0|Math.min(xe,this.max)},Al.prototype.reset=function(){this.attempts=0},Al.prototype.setMin=function(xe){this.ms=xe},Al.prototype.setMax=function(xe){this.max=xe},Al.prototype.setJitter=function(xe){this.jitter=xe};var Nv=typeof e=="object"&&e&&e.Object===Object&&e,cS=typeof self=="object"&&self&&self.Object===Object&&self,ni=Nv||cS||Function("return this")(),Ci=ni.Symbol,Ov=Object.prototype,lS=Ov.hasOwnProperty,Rv=Ov.toString,Mi=Ci?Ci.toStringTag:void 0,Ui=function(he){var Ve=lS.call(he,Mi),ze=he[Mi];try{he[Mi]=void 0;var _e=!0}catch{}var At=Rv.call(he);return _e&&(Ve?he[Mi]=ze:delete he[Mi]),At},Ip=Object.prototype.toString,Bv=function(he){return Ip.call(he)},Fv=Ci?Ci.toStringTag:void 0,zc=function(he){return he==null?he===void 0?"[object Undefined]":"[object Null]":Fv&&Fv in Object(he)?Ui(he):Bv(he)},Vi=function(he){var Ve=typeof he;return he!=null&&(Ve=="object"||Ve=="function")},Ep=function(he){if(!Vi(he))return!1;var Ve=zc(he);return Ve=="[object Function]"||Ve=="[object GeneratorFunction]"||Ve=="[object AsyncFunction]"||Ve=="[object Proxy]"},Lv={deviceId:"",timeout:8e3},uS={account:"",appkey:"",token:"",debugLevel:"off",needReconnect:!0,reconnectionAttempts:wg,isAbtestEnable:!0,abtestUrl:"https://abt-online.netease.im/v1/api/abt/client/getExperimentInfo",abtestProjectKey:"imElite_sdk_abtest_web"},$v="weblink.netease.im:443",dS=Au.includes,pS=V(function(){return!Array(1).includes()});xn({target:"Array",proto:!0,forced:pS},{includes:function(he){return dS(this,he,arguments.length>1?arguments[1]:void 0)}});var fS=sa("Array").includes,$g=To("match"),jg=TypeError,qi=function(xe){if(function(he){var Ve;return mr(he)&&((Ve=he[$g])!==void 0?!!Ve:tr(he)=="RegExp")}(xe))throw jg("The method doesn't accept regular expressions");return xe},mS=To("match"),gS=Ce("".indexOf);xn({target:"String",proto:!0,forced:!function(xe){var he=/./;try{"/./"[xe](he)}catch{try{return he[mS]=!1,"/./"[xe](he)}catch{}}return!1}("includes")},{includes:function(he){return!!~gS(rs(Sr(this)),rs(qi(he)),arguments.length>1?arguments[1]:void 0)}});var jv=sa("String").includes,Dg=Array.prototype,Od=String.prototype,Wc=function(xe){var he=xe.includes;return xe===Dg||sr(Dg,xe)&&he===Dg.includes?fS:typeof xe=="string"||xe===Od||sr(Od,xe)&&he===Od.includes?jv:he},hS=Ws.findIndex,vS="findIndex",Pp=!0;vS in[]&&Array(1).findIndex(function(){Pp=!1}),xn({target:"Array",proto:!0,forced:Pp},{findIndex:function(he){return hS(this,he,arguments.length>1?arguments[1]:void 0)}});var Dv=sa("Array").findIndex,Ug=Array.prototype,yS=function(xe){var he=xe.findIndex;return xe===Ug||sr(Ug,xe)&&he===Ug.findIndex?Dv:he},Vg=g(function(xe){function he(Ve){var ze;return xe.exports=he=si?Zo(ze=pi).call(ze):function(At){return At.__proto__||pi(At)},xe.exports.__esModule=!0,xe.exports.default=xe.exports,he(Ve)}xe.exports=he,xe.exports.__esModule=!0,xe.exports.default=xe.exports}),Ba=g(function(xe){xe.exports=function(Ve){var ze;return Ja(ze=Function.toString.call(Ve)).call(ze,"[native code]")!==-1},xe.exports.__esModule=!0,xe.exports.default=xe.exports}),qg=Er("Reflect","construct"),Hg=Object.prototype,bS=[].push,Uv=V(function(){function xe(){}return!(qg(function(){},[],xe)instanceof xe)}),zg=!V(function(){qg(function(){})}),Wg=Uv||zg;xn({target:"Reflect",stat:!0,forced:Wg,sham:Wg},{construct:function(he,Ve){_l(he),po(Ve);var ze=arguments.length<3?he:_l(arguments[2]);if(zg&&!Uv)return qg(he,Ve,ze);if(he==ze){switch(Ve.length){case 0:return new he;case 1:return new he(Ve[0]);case 2:return new he(Ve[0],Ve[1]);case 3:return new he(Ve[0],Ve[1],Ve[2]);case 4:return new he(Ve[0],Ve[1],Ve[2],Ve[3])}var _e=[null];return ue(bS,_e,Ve),new(ue(Bu,he,_e))}var At=ze.prototype,ar=es(mr(At)?At:Hg),Dt=ue(he,ar,Ve);return mr(Dt)?Dt:ar}});var rc=Ir.Reflect.construct,Ic=g(function(xe){xe.exports=function(){if(typeof Reflect>"u"||!rc||rc.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(rc(Boolean,[],function(){})),!0}catch{return!1}},xe.exports.__esModule=!0,xe.exports.default=xe.exports}),SS=g(function(xe){function he(Ve,ze,_e){var At;return Ic()?(xe.exports=he=Zo(At=rc).call(At),xe.exports.__esModule=!0,xe.exports.default=xe.exports):(xe.exports=he=function(Dt,vr,Cr){var Ar=[null];Ar.push.apply(Ar,vr);var $r=new(Zo(Function).apply(Dt,Ar));return Cr&&Lu($r,Cr.prototype),$r},xe.exports.__esModule=!0,xe.exports.default=xe.exports),he.apply(null,arguments)}xe.exports=he,xe.exports.__esModule=!0,xe.exports.default=xe.exports}),TS=g(function(xe){function he(Ve){var ze=typeof xc=="function"?new xc:void 0;return xe.exports=he=function(At){if(At===null||!Ba(At))return At;if(typeof At!="function")throw new TypeError("Super expression must either be null or a function");if(ze!==void 0){if(ze.has(At))return ze.get(At);ze.set(At,ar)}function ar(){return SS(At,arguments,Vg(this).constructor)}return ar.prototype=Cs(At.prototype,{constructor:{value:ar,enumerable:!1,writable:!0,configurable:!0}}),Lu(ar,At)},xe.exports.__esModule=!0,xe.exports.default=xe.exports,he(Ve)}xe.exports=he,xe.exports.__esModule=!0,xe.exports.default=xe.exports}),Ec=function(xe){function he(Ve,ze,_e){var At;return ze===void 0&&(ze={}),_e===void 0&&(_e=400),(At=xe.call(this,Ve)||this).data=ze,At.code=_e,At.name="customError",At}return ea(he,xe),he}(n(TS)(Error)),Bo=function(xe){function he(Ve,ze,_e){var At;return ze===void 0&&(ze={}),(At=xe.call(this,Ve,ze,414)||this).code=414,At.name="validateError",At.rules=_e,At}return ea(he,xe),he}(Ec),Nl={200:null,406:null,808:null,810:null,201:"The client version is incorrect. You need to upgrade the SDK",302:"The user name or password is incorrect. Please check whether the appkey and token are valid and whether the account and token match",403:"Illegal operation or no permission",404:"Target object does not exist",405:"Parameter length too long",408:"Client request timed out",414:"Request parameter error",415:"Service unavailable",416:"Frequency control",417:"Repeat operation",422:"Account disabled",500:"Server internal error",503:"Server busy",508:"Expiration date",509:"Invalid",7101:"Be pulled black",700:"Partial failure of batch operation",801:"The number of people in the team has reached the upper limit",802:"No permission",803:"The team does not exist or has not changed",804:"The user is not in the team",805:"Team type mismatch",806:"The number of teams created has reached the limit",807:"Team member not valid",809:"Already in the team",811:"The number of accounts in the forced push list exceeds the limit",812:"The team is muted",813:"Due to the limited number of team, some pull people successfully",814:"Disable team message read service",815:"Maximum number of team administrators",816:"Batch operation partial failure",997:"The packet has expired",998:"Deserialize packet error",999:"Serialize packet error",9102:"Channel failure",9103:"This call has been answered / rejected at another end",10201:"Signaling: target NIM client is offline",10202:"Signaling: push is unreachable",10404:"Signaling: channel not exists",10405:"Signaling: channel already exists",10406:"Signaling: member of channel not exists",10407:"Signaling: member of channel already exists",10408:"Signaling: the invitation request does not exist or has expired",10409:"Signaling: the invitation request has been rejected",10410:"Signaling: the invitation request has been accepted",10414:"Signaling: request parameter error",10417:"Signaling: uid conflict",10419:"Signaling: the number of members of channel exceed the limit",10420:"Signaling: member is already in the channel on other client",10700:"Signaling: phased success",13002:"Abnormal chatroom status",13003:"In the blacklist",13004:"In the mute list",13006:"All members are muted, and only the administrator can speak"},Ap=function(xe){function he(Ve,ze,_e,At,ar){var Dt;return _e===void 0&&(_e=""),At===void 0&&(At=new Date().getTime()),ar===void 0&&(ar={}),_e=_e||Nl[Ve],(Dt=xe.call(this,_e,ar,Ve)||this).name="cmdError",Dt.cmd=ze,Dt.timetag=At,Dt}return ea(he,xe),he}(Ec),Gg=function(xe){function he(Ve,ze,_e){var At;return(At=xe.call(this,Ve,{},412)||this).code=412,At.name="formatError",At.key=ze,At.reason=_e,At}return ea(he,xe),he}(Ec),ru=function(xe){function he(Ve,ze,_e,At,ar){var Dt;return(Dt=xe.call(this,Ve,{file:ar},400)||this).name="uploadError",Dt.rawError=ze,Dt.curProvider=_e||1,Dt.mixStorePolicy=At,Dt}return ea(he,xe),he}(Ec),Gc=["error","warn","log","debug"],Ol=function(){},Rd=["off","error","warn","log","debug"],Np=function(){function xe(Ve,ze){this.name=ze,this.strategies={debug:console.log,log:console.log,warn:console.warn,error:console.error},this.debug=Ol,this.log=Ol,this.warn=Ol,this.error=Ol,this.name=ze,xe.instancesName.push(ze),Wc(Rd).call(Rd,Ve)||(Ve="off"),this.setLogFunc(Ve)}var he=xe.prototype;return he.setLogFunc=function(ze){var _e=this,At=yS(Gc).call(Gc,function(ar){return ar===ze});Qn(Gc).call(Gc,function(ar,Dt){Dt<=At&&(_e[ar]=function(){var vr=$o(Array.prototype).call(arguments),Cr=this.formatArgs(vr,ar);this.strategies[ar](Cr)})})},he.formatArgs=function(ze,_e){var At=new Date,ar=At.getMonth()+1+"-"+At.getDate()+" "+At.getHours()+":"+At.getMinutes()+":"+At.getSeconds()+":"+At.getMilliseconds();return"[NIM "+_e+" "+this.name+" "+ar+"] "+Fo(ze).call(ze,function(Dt){return Dt instanceof Ec?Dt.name+", "+Dt.code+", "+Dt.message:Dt instanceof Error?Dt&&Dt.message?Dt.message:Dt:typeof Dt=="object"?fa(Dt):Dt}).join(" ")},xe}();Np.instancesName=[],xn({global:!0},{globalThis:$});var Vv=Ws.filter,CS=fc("filter");xn({target:"Array",proto:!0,forced:!CS},{filter:function(he){return Vv(this,he,arguments.length>1?arguments[1]:void 0)}});var ka=sa("Array").filter,Kg=Array.prototype,Bs=function(xe){var he=xe.filter;return xe===Kg||sr(Kg,xe)&&he===Kg.filter?ka:he},MS=g(function(xe,he){xe.exports=function(){function Ve(Cr,Ar){if(!(Cr instanceof Ar))throw new TypeError("Cannot call a class as a function")}function ze(Cr,Ar){for(var $r=0;$r<Ar.length;$r++){var jr=Ar[$r];jr.enumerable=jr.enumerable||!1,jr.configurable=!0,"value"in jr&&(jr.writable=!0),bc(Cr,jr.key,jr)}}function _e(Cr,Ar,$r){return Ar&&ze(Cr.prototype,Ar),$r&&ze(Cr,$r),bc(Cr,"prototype",{writable:!1}),Cr}var At={reportUrl:"https://statistic.live.126.net/statics/report/common/form",maxSize:100,msgListMaxSize:1e3,cacheMaxSize:1e3,maxDelay:3e5,maxInterval:3e4,minInterval:1e4,timeout:5e3,autoStart:!0},ar="https://statistic.live.126.net/dispatcher/req",Dt=function(){},vr=function(){function Cr(Ar){Ve(this,Cr),this.enable=!1,this.initConfigLoaded=!1,this.loading=!1,this.isDestroyed=!1,this.reportConfig=At,this.msgList=[],this.traceMsgCache={},this.lowPriorityMsgList=[],this.cacheMsgList=[],this.lastReportTime=Ia(),this.timer=null,this.setConfig(Ar),this.reportConfig.autoStart&&this.initUploadConfig()}return _e(Cr,[{key:"setConfig",value:function($r){this.reportConfig=zr({},this.reportConfig,$r)}},{key:"reportImmediately",value:function($r,jr){var Hr=this;this.reportConfig.request($r,zr({dataType:"json",method:"POST",timeout:this.reportConfig.timeout},jr)).catch(function(Kr){var Sn,Cn;(Cn=(Sn=Hr.reportConfig)===null||Sn===void 0?void 0:Sn.logger)===null||Cn===void 0||Cn.warn("Reporter immediately upload failed",Kr)})}},{key:"report",value:function($r,jr){var Hr=arguments.length>2&&arguments[2]!==void 0&&arguments[2];if($r){var Kr=Ia();Hr?this.lowPriorityMsgList.push({module:$r,msg:jr,createTime:Kr}):this.msgList.push({module:$r,msg:jr,createTime:Kr}),this.msgList.length>this.reportConfig.msgListMaxSize&&this.msgList.shift(),this.lowPriorityMsgList.length>this.reportConfig.msgListMaxSize&&this.lowPriorityMsgList.shift(),this.doReport()}}},{key:"reportTraceStart",value:function($r,jr){if($r&&!this.traceMsgCache[$r]){var Hr=zr(zr({start_time:Ia()},jr),{extension:[]});this.traceMsgCache[$r]=Hr}}},{key:"reportTraceUpdate",value:function($r){}},{key:"reportTraceUpdateV2",value:function($r,jr){if(this.traceMsgCache[$r]){var Hr=this.traceMsgCache[$r].extension.length,Kr=new Date().getTime();jr.duration=Hr===0?Kr-this.traceMsgCache[$r].start_time:Kr-this.traceMsgCache[$r].extension[Hr-1].end_time,this.traceMsgCache[$r].extension.push(zr({end_time:Kr},jr))}}},{key:"reportTraceEnd",value:function($r){var jr,Hr=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];this.traceMsgCache[$r]&&($r!=="nos"||Hr===!1?(typeof Hr=="boolean"?this.traceMsgCache[$r].succeed=!!Hr:this.traceMsgCache[$r].state=Hr,this.traceMsgCache[$r].duration=Ia()-this.traceMsgCache[$r].start_time,Qn(jr=this.traceMsgCache[$r].extension).call(jr,function(Kr){delete Kr.end_time}),this.report($r,this.traceMsgCache[$r]),this.traceMsgCache[$r]=null):this.traceMsgCache[$r]=null)}},{key:"reportTraceCancel",value:function($r){this.traceMsgCache[$r]=null}},{key:"pause",value:function(){this.enable=!1}},{key:"restore",value:function(){this.enable=!0,this.initConfigLoaded||this.initUploadConfig()}},{key:"destroy",value:function(){var $r,jr=this;Qn($r=la(this.traceMsgCache)).call($r,function(Hr){jr.reportTraceEnd(Hr,1)}),this.timer!==null&&clearTimeout(this.timer),this.setConfig=Dt,this.report=Dt,this.reportTraceStart=Dt,this.reportTraceUpdate=Dt,this.reportTraceEnd=Dt,this.pause=Dt,this.restore=Dt,this.destroy=Dt,this.cacheMsgList=[],this.traceMsgCache={},this.lowPriorityMsgList=[],this.msgList=[],this.reportConfig={},this.isDestroyed=!0}},{key:"initUploadConfig",value:function(){var $r,jr,Hr=this;if(!this.loading){this.loading=!0;var Kr=this.reportConfig.common||{};try{this.reportConfig.request(ar,{method:"GET",dataType:"json",params:{deviceId:Kr.dev_id,sdkVer:Kr.sdk_ver,platform:Kr.platform,appkey:Kr.app_key},timeout:this.reportConfig.timeout}).then(function(Sn){var Cn,Pn;if(!Hr.isDestroyed){if(Sn.status===200&&Sn.data&&Sn.data.code===200){var En=Sn.data.data||{};Hr.reportConfig.maxSize=En.maxSize>1e3?1e3:En.maxSize,Hr.reportConfig.maxInterval=En.maxInterval>1e4?1e4:En.maxInterval,Hr.reportConfig.maxInterval=En.maxInterval<10?10:En.maxInterval,Hr.reportConfig.minInterval=En.minInterval<2?2:En.minInterval,Hr.reportConfig.maxDelay=En.maxDelay||300,Hr.reportConfig.maxInterval=1e3*Hr.reportConfig.maxInterval,Hr.reportConfig.minInterval=1e3*Hr.reportConfig.minInterval,Hr.reportConfig.maxDelay=1e3*Hr.reportConfig.maxDelay,Hr.enable=!0,Hr.initConfigLoaded=!0,Hr.loading=!1,Hr.reportHeartBeat()}(Pn=(Cn=Hr.reportConfig)===null||Cn===void 0?void 0:Cn.logger)===null||Pn===void 0||Pn.log("Get reporter upload config success")}}).catch(function(Sn){var Cn,Pn;Hr.loading=!1,(Pn=(Cn=Hr.reportConfig)===null||Cn===void 0?void 0:Cn.logger)===null||Pn===void 0||Pn.error("Get reporter upload config failed",Sn)})}catch(Sn){this.loading=!1,(jr=($r=this.reportConfig)===null||$r===void 0?void 0:$r.logger)===null||jr===void 0||jr.error("Exec reporter request failed",Sn)}}}},{key:"reportHeartBeat",value:function(){var $r=this;this.isDestroyed||(this.timer=Ro(function(){$r.reportHeartBeat()},this.reportConfig.minInterval),this.doReport())}},{key:"doReport",value:function(){if(!this.isDestroyed){var $r=this.msgList.length+this.lowPriorityMsgList.length+this.cacheMsgList.length>2*this.reportConfig.maxSize?this.reportConfig.minInterval:this.reportConfig.maxInterval;Ia()-this.lastReportTime>=$r&&this.upload()}}},{key:"getUploadMsg",value:function(){var $r,jr,Hr,Kr,Sn,Cn=this,Pn={},En=Ia();this.msgList=Bs($r=this.msgList).call($r,function(Yn){return En-Yn.createTime<Cn.reportConfig.maxDelay}),this.lowPriorityMsgList=Bs(jr=this.lowPriorityMsgList).call(jr,function(Yn){return En-Yn.createTime<Cn.reportConfig.maxDelay}),this.cacheMsgList=Bs(Hr=this.cacheMsgList).call(Hr,function(Yn){return En-Yn.createTime<Cn.reportConfig.maxDelay});var Nn=$o(Kr=this.msgList).call(Kr,0,this.reportConfig.maxSize);if(this.msgList=$o(Sn=this.msgList).call(Sn,Nn.length),Nn.length<this.reportConfig.maxSize){var zn,yo,fo=this.reportConfig.maxSize-Nn.length;Nn=Ys(Nn).call(Nn,$o(zn=this.lowPriorityMsgList).call(zn,0,fo)),this.lowPriorityMsgList=$o(yo=this.lowPriorityMsgList).call(yo,fo)}if(Nn.length<this.reportConfig.maxSize){var qo,ao,Wr=this.reportConfig.maxSize-Nn.length;Nn=Ys(Nn).call(Nn,$o(qo=this.cacheMsgList).call(qo,0,Wr)),this.cacheMsgList=$o(ao=this.cacheMsgList).call(ao,Wr)}return Qn(Nn).call(Nn,function(Yn){Pn[Yn.module]?Pn[Yn.module].push(Yn.msg):Pn[Yn.module]=[Yn.msg]}),{uploadMsgArr:Nn,uploadMsg:Pn}}},{key:"upload",value:function(){var $r,jr,Hr=this;if(this.enable&&!(this.lastReportTime&&Ia()-this.lastReportTime<this.reportConfig.minInterval)){var Kr=this.getUploadMsg(),Sn=Kr.uploadMsgArr,Cn=Kr.uploadMsg;if(Sn.length){this.lastReportTime=Ia();try{this.reportConfig.request(this.reportConfig.reportUrl,{dataType:"json",method:"POST",data:{common:this.reportConfig.common,event:Cn},headers:{sdktype:"im"},timeout:this.reportConfig.timeout}).catch(function(Pn){var En,Nn,zn,yo;Hr.cacheMsgList=$o(En=Ys(Nn=Hr.cacheMsgList).call(Nn,Sn)).call(En,0,Hr.reportConfig.cacheMaxSize),(yo=(zn=Hr.reportConfig)===null||zn===void 0?void 0:zn.logger)===null||yo===void 0||yo.warn("Reporter upload failed",Pn)})}catch(Pn){(jr=($r=this.reportConfig)===null||$r===void 0?void 0:$r.logger)===null||jr===void 0||jr.warn("Exec reporter request failed",Pn)}clearTimeout(this.timer),this.reportHeartBeat()}}}}]),Cr}();return vr}()}),ua={setLogger:function(he){throw new Error("Function not implemented.")},platform:"",WebSocket:function(){function xe(Ve,ze){throw this.CONNECTING=0,this.OPEN=1,this.CLOSING=2,this.CLOSED=3,new Error("Method not implemented.")}var he=xe.prototype;return he.close=function(ze,_e){throw new Error("Method not implemented.")},he.send=function(ze){throw new Error("Method not implemented.")},he.onclose=function(ze){throw new Error("Method not implemented.")},he.onerror=function(ze){throw new Error("Method not implemented.")},he.onmessage=function(ze){throw new Error("Method not implemented.")},he.onopen=function(ze){throw new Error("Method not implemented.")},xe}(),localStorage:{},request:function(he,Ve){throw new Error("Function not implemented.")},uploadFile:function(he){throw new Error("Function not implemented.")},getSystemInfo:function(){throw new Error("Function not implemented.")}},ki=TypeError,qv=function(xe){return function(he,Ve,ze,_e){Yr(Ve);var At=In(he),ar=fr(At),Dt=Za(At),vr=xe?Dt-1:0,Cr=xe?-1:1;if(ze<2)for(;;){if(vr in ar){_e=ar[vr],vr+=Cr;break}if(vr+=Cr,xe?vr<0:Dt<=vr)throw ki("Reduce of empty array with no initial value")}for(;xe?vr>=0:Dt>vr;vr+=Cr)vr in ar&&(_e=Ve(_e,ar[vr],vr,At));return _e}},Ca={left:qv(!1),right:qv(!0)}.left,kS=fi("reduce");xn({target:"Array",proto:!0,forced:!kS||!ds&&Br>79&&Br<83},{reduce:function(he){var Ve=arguments.length;return Ca(this,he,Ve,Ve>1?arguments[1]:void 0)}});var Hv=sa("Array").reduce,Qg=Array.prototype,Op=function(xe){var he=xe.reduce;return xe===Qg||sr(Qg,xe)&&he===Qg.reduce?Hv:he},zv=function(he){return he===void 0},nu={},Kc={};function Wv(xe,he){var Ve,ze,_e;try{_e=JSON.parse(xe)}catch(Hr){throw he.error("Parse command error: ",xe),Hr}var At=_e.sid+"_"+_e.cid,ar=_e.r;if(Wc(Ve=["4_1","4_2","4_10","4_11"]).call(Ve,At)){var Dt=_e.r[1].headerPacket;At=Dt.sid+"_"+Dt.cid,ar=_e.r[1].body}var vr,Cr=Kc[At],Ar=nu[Cr],$r=function(Kr,Sn){var Cn=Nl[Kr];return Cn===null?null:new Ap(Kr,Sn,Cn,new Date().getTime())}(_e.code,Cr),jr={cmd:Cr,raw:_e,error:$r,service:Ar==null?void 0:Ar.service,content:{}};if(jr.error){if(jr.error.cmd=Cr,jr.error.callFunc="parseCmd",!(!((ze=Ar==null?void 0:Ar.ignoreErrCodes)===null||ze===void 0)&&Wc(ze).call(ze,_e.code)))return jr;he.warn("parseCmd:: ignore error ",jr.error),jr.error.ignore=!0}return!Cr||!Ar?(jr.notFound=!0,jr):(Ar.response&&Qn(vr=Ar.response).call(vr,function(Hr,Kr){var Sn=ar[Kr],Cn=Hr.type,Pn=Hr.name,En=Hr.reflectMapper;if(!zv(Sn))switch(Cn){case"Property":jr.content[Pn]=En?nc(Sn,En):Sn;break;case"PropertyArray":jr.content[Pn]=Fo(Sn).call(Sn,function(Nn){return En?nc(Nn,En):Nn});break;case"long":case"Long":case"byte":case"Byte":case"Number":jr.content[Pn]=+Sn;break;default:jr.content[Pn]=Sn}}),jr)}function Bd(xe,he){var Ve={};for(var ze in xe)he[ze]!==void 0&&(Ve[he[ze]]=xe[ze]);return Ve}function nc(xe,he){var Ve={};for(var ze in xe)he[ze]!==void 0&&(Ve[he[ze]]=xe[ze]);return Ve}function ps(xe){nu=zr(nu,xe.cmdConfig),Kc=zr(Kc,xe.cmdMap)}function Is(xe){var he;return Op(he=la(xe)).call(he,function(Ve,ze){var _e,At=xe[ze];return Ve[ze]=Op(_e=la(At)).call(_e,function(ar,Dt){return ar[At[Dt]]=Dt,ar},{}),Ve},{})}var ns=["disconnect","connect","heartbeat","message","json","event","ack","error","noop"],oc=["transport not supported","client not handshaken","unauthorized"],Qc=["reconnect"],Jg=function(xe){function he(ze,_e,At){var ar;return(ar=xe.call(this)||this).url=_e,ar.logger=At,ar.websocket=null,ar.core=ze,ar.url=_e,ar.status="disconnected",ar.logger=At,ar.connect(),ar}ea(he,xe);var Ve=he.prototype;return Ve.connect=function(){var _e=this;this.status!=="connecting"&&this.status!=="connected"?(this.status="connecting",this.core.adapters.request("https://"+this.url+"/socket.io/1/?t="+Ia(),{method:"GET",dataType:"text",timeout:8e3}).then(function(At){var ar=At.data.split(":"),Dt=ar[0],vr=ar[1];return _e.sessionId=Dt,_e.closeTimeout=1e3*vr,_e._createWebsocket("wss://"+_e.url+"/socket.io/1/websocket/"+Dt)}).catch(function(At){_e.logger.error("imsocket::handshake fail. ",At&&At.message),_e.status="disconnected",_e.emit("handshakeFailed")})):this.logger.warn("imsocket::socket is connecting or connected",this.status)},Ve.close=function(){if(this.websocket){this.logger.log("imsocket:: close websocket");try{this.websocket.send(this.encodePacket({type:"disconnect"})),this.websocket.close()}catch(_e){this.logger.warn("attempt to close websocket error",_e)}this.clean()}},Ve.clean=function(){this.status="disconnected",this.websocket&&(this.websocket.onmessage=null,this.websocket.onopen=null,this.websocket.onerror=null,this.websocket.onclose=null,this.websocket=null,this.emit("disconnect"))},Ve.onConnect=function(){this.status="connected",this.resetCloseTimer(),this.emit("connect")},Ve._createWebsocket=function(_e){var At,ar=this;this.websocket=new ua.WebSocket(_e),this.websocket.onmessage=Zo(At=this.onMessage).call(At,this),this.websocket.onclose=function(){ar.logger.log("imsocket:: receive websocket onclose event, current status",ar.status),ar.clean()},this.websocket.onerror=function(Dt){ar.logger.error("imsocket:: onerror",Dt)}},Ve.onMessage=function(_e){var At;this.resetCloseTimer();var ar=this.decodePacket(_e.data);if(ar)switch(ar.type){case"connect":this.onConnect();break;case"disconnect":this.close();break;case"message":case"json":this.emit("message",ar.data);break;case"event":ar.name&&this.emit(ar.name,ar.args);break;case"error":ar.reason==="unauthorized"?this.emit("connect_failed",ar.reason):this.emit("error",ar.reason);break;case"heartbeat":(At=this.websocket)===null||At===void 0||At.send(this.encodePacket({type:"heartbeat"}));break;default:this.logger.warn("imsocket::no handler type",ar.type)}},Ve.encodePacket=function(_e){var At,ar,Dt=_e.type,vr=_e.id,Cr=vr===void 0?"":vr,Ar=_e.endpoint,$r=Ar===void 0?"":Ar,jr=_e.ack,Hr=null;if(!Dt)return"";switch(Dt){case"error":At=_e.reason?Ja(oc).call(oc,_e.reason):"",ar=_e.advice?Ja(Qc).call(Qc,_e.advice):"",At===""&&ar===""||(Hr=At+(ar!==""?"+"+ar:""));break;case"message":_e.data!==""&&(Hr=_e.data);break;case"event":At={name:_e.name},At=_e.args&&_e.args.length?{name:_e.name,args:_e.args}:{name:_e.name},Hr=fa(At);break;case"json":Hr=fa(_e.data);break;case"connect":_e.qs&&(Hr=_e.qs);break;case"ack":Hr=_e.ackId+(_e.args&&_e.args.length?"+"+fa(_e.args):"")}var Kr=[Ja(ns).call(ns,Dt),Cr+(jr==="data"?"+":""),$r];return Hr!=null&&Kr.push(Hr),Kr.join(":")},Ve.decodePacket=function(_e){if(_e)if(_e.charAt(0)!="�"){var At=_e.match(/([^:]+):([0-9]+)?(\+)?:([^:]+)?:?([\s\S]*)?/);if(At){var ar,Dt=At[1],vr=At[2],Cr=At[3],Ar=At[4],$r=At[5],jr={type:ns[+Dt],endpoint:Ar};switch(vr&&(jr.id=vr,jr.ack=!Cr||"data"),jr.type){case"error":ar=$r.split("+"),jr.reason=oc[+ar[0]]||"";break;case"message":jr.data=$r||"";break;case"connect":jr.qs=$r||"";break;case"event":try{var Hr=JSON.parse($r);jr.name=Hr.name,jr.args=Hr.args}catch(Kr){this.logger.error("imsocket::parseData::type::event error",Kr)}jr.args=jr.args||[];break;case"json":try{jr.data=JSON.parse($r)}catch(Kr){this.logger.error("imsocket::parseData::type::json error",Kr)}break;case"ack":if((ar=$r.match(/^([0-9]+)(\+)?(.*)/))&&(jr.ackId=ar[1],jr.args=[],ar[3]))try{jr.args=ar[3]?JSON.parse(ar[3]):[]}catch(Kr){this.logger.error("imsocket::parseData::type::ack error",Kr)}}return jr}}else this.logger.error("imsocket::unrecognize dataStr",$o(_e).call(_e,0,20))},Ve.send=function(_e){var At,ar={data:_e,type:"message",endpoint:""};(At=this.websocket)===null||At===void 0||At.send(this.encodePacket(ar))},Ve.resetCloseTimer=function(){var _e=this;this.closeTimeout&&(clearTimeout(this.closeTimer),this.closeTimer=Ro(function(){_e.close()},this.closeTimeout))},he}(hi),Yg=sa("Array").values,Rp=Array.prototype,wS={DOMTokenList:!0,NodeList:!0},Bp=function(xe){var he=xe.values;return xe===Rp||sr(Rp,xe)&&he===Rp.values||hn(wS,ci(xe))?Yg:he};xn({target:"Array",stat:!0},{isArray:Ms});var Hi=Ir.Array.isArray,_S=Ws.every,Fp=fi("every");xn({target:"Array",proto:!0,forced:!Fp},{every:function(he){return _S(this,he,arguments.length>1?arguments[1]:void 0)}});var Es=sa("Array").every,Xg=Array.prototype,xS=function(xe){var he=xe.every;return xe===Xg||sr(Xg,xe)&&he===Xg.every?Es:he},zi=function(he){return he!=null&&typeof he=="object"},Zg=function(he){return zi(he)&&zc(he)=="[object RegExp]"},ou=function(he){return function(Ve){return he(Ve)}},Fs=g(function(xe,he){var Ve=he&&!he.nodeType&&he,ze=Ve&&xe&&!xe.nodeType&&xe,_e=ze&&ze.exports===Ve&&Nv.process,At=function(){try{var ar=ze&&ze.require&&ze.require("util").types;return ar||_e&&_e.binding&&_e.binding("util")}catch{}}();xe.exports=At}),Gv=Fs&&Fs.isRegExp,eh=Gv?ou(Gv):Zg,au=ni["__core-js_shared__"],th=function(){var xe=/[^.]+$/.exec(au&&au.keys&&au.keys.IE_PROTO||"");return xe?"Symbol(src)_1."+xe:""}(),IS=function(he){return!!th&&th in he},rh=Function.prototype.toString,Jc=function(he){if(he!=null){try{return rh.call(he)}catch{}try{return he+""}catch{}}return""},ES=/^\[object .+?Constructor\]$/,PS=Function.prototype,Rl=Object.prototype,AS=PS.toString,NS=Rl.hasOwnProperty,OS=RegExp("^"+AS.call(NS).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),RS=function(he){return!(!Vi(he)||IS(he))&&(Ep(he)?OS:ES).test(Jc(he))},BS=function(he,Ve){return he==null?void 0:he[Ve]},Bl=function(he,Ve){var ze=BS(he,Ve);return RS(ze)?ze:void 0},Fd=Bl(Object,"create"),FS=function(){this.__data__=Fd?Fd(null):{},this.size=0},Fl=function(he){var Ve=this.has(he)&&delete this.__data__[he];return this.size-=Ve?1:0,Ve},Ld=Object.prototype.hasOwnProperty,LS=function(he){var Ve=this.__data__;if(Fd){var ze=Ve[he];return ze==="__lodash_hash_undefined__"?void 0:ze}return Ld.call(Ve,he)?Ve[he]:void 0},$S=Object.prototype.hasOwnProperty,jS=function(he){var Ve=this.__data__;return Fd?Ve[he]!==void 0:$S.call(Ve,he)},DS=function(he,Ve){var ze=this.__data__;return this.size+=this.has(he)?0:1,ze[he]=Fd&&Ve===void 0?"__lodash_hash_undefined__":Ve,this};function su(xe){var he=-1,Ve=xe==null?0:xe.length;for(this.clear();++he<Ve;){var ze=xe[he];this.set(ze[0],ze[1])}}su.prototype.clear=FS,su.prototype.delete=Fl,su.prototype.get=LS,su.prototype.has=jS,su.prototype.set=DS;var Kv=su,US=function(){this.__data__=[],this.size=0},Pc=function(he,Ve){return he===Ve||he!=he&&Ve!=Ve},$d=function(he,Ve){for(var ze=he.length;ze--;)if(Pc(he[ze][0],Ve))return ze;return-1},VS=Array.prototype.splice,Lp=function(he){var Ve=this.__data__,ze=$d(Ve,he);return!(ze<0)&&(ze==Ve.length-1?Ve.pop():VS.call(Ve,ze,1),--this.size,!0)},$p=function(he){var Ve=this.__data__,ze=$d(Ve,he);return ze<0?void 0:Ve[ze][1]},qS=function(he){return $d(this.__data__,he)>-1},HS=function(he,Ve){var ze=this.__data__,_e=$d(ze,he);return _e<0?(++this.size,ze.push([he,Ve])):ze[_e][1]=Ve,this};function iu(xe){var he=-1,Ve=xe==null?0:xe.length;for(this.clear();++he<Ve;){var ze=xe[he];this.set(ze[0],ze[1])}}iu.prototype.clear=US,iu.prototype.delete=Lp,iu.prototype.get=$p,iu.prototype.has=qS,iu.prototype.set=HS;var jp=iu,jd=Bl(ni,"Map"),cu=function(){this.size=0,this.__data__={hash:new Kv,map:new(jd||jp),string:new Kv}},Dp=function(he){var Ve=typeof he;return Ve=="string"||Ve=="number"||Ve=="symbol"||Ve=="boolean"?he!=="__proto__":he===null},Yc=function(he,Ve){var ze=he.__data__;return Dp(Ve)?ze[typeof Ve=="string"?"string":"hash"]:ze.map},zS=function(he){var Ve=Yc(this,he).delete(he);return this.size-=Ve?1:0,Ve},WS=function(he){return Yc(this,he).get(he)},Up=function(he){return Yc(this,he).has(he)},GS=function(he,Ve){var ze=Yc(this,he),_e=ze.size;return ze.set(he,Ve),this.size+=ze.size==_e?0:1,this};function lu(xe){var he=-1,Ve=xe==null?0:xe.length;for(this.clear();++he<Ve;){var ze=xe[he];this.set(ze[0],ze[1])}}lu.prototype.clear=cu,lu.prototype.delete=zS,lu.prototype.get=WS,lu.prototype.has=Up,lu.prototype.set=GS;var Vp=lu,KS=function(he){return this.__data__.set(he,"__lodash_hash_undefined__"),this},uu=function(he){return this.__data__.has(he)};function Ll(xe){var he=-1,Ve=xe==null?0:xe.length;for(this.__data__=new Vp;++he<Ve;)this.add(xe[he])}Ll.prototype.add=Ll.prototype.push=KS,Ll.prototype.has=uu;var nh=Ll,Qv=function(he,Ve,ze,_e){for(var At=he.length,ar=ze+(_e?1:-1);_e?ar--:++ar<At;)if(Ve(he[ar],ar,he))return ar;return-1},qp=function(he){return he!=he},oh=function(he,Ve,ze){for(var _e=ze-1,At=he.length;++_e<At;)if(he[_e]===Ve)return _e;return-1},QS=function(he,Ve,ze){return Ve==Ve?oh(he,Ve,ze):Qv(he,qp,ze)},Jv=function(he,Ve){return!!(he!=null&&he.length)&&QS(he,Ve,0)>-1},Yv=function(he,Ve,ze){for(var _e=-1,At=he==null?0:he.length;++_e<At;)if(ze(Ve,he[_e]))return!0;return!1},ah=function(he,Ve){for(var ze=-1,_e=he==null?0:he.length,At=Array(_e);++ze<_e;)At[ze]=Ve(he[ze],ze,he);return At},Hp=function(he,Ve){return he.has(Ve)},Xv=function(he,Ve,ze,_e){var At=-1,ar=Jv,Dt=!0,vr=he.length,Cr=[],Ar=Ve.length;if(!vr)return Cr;ze&&(Ve=ah(Ve,ou(ze))),_e?(ar=Yv,Dt=!1):Ve.length>=200&&(ar=Hp,Dt=!1,Ve=new nh(Ve));e:for(;++At<vr;){var $r=he[At],jr=ze==null?$r:ze($r);if($r=_e||$r!==0?$r:0,Dt&&jr==jr){for(var Hr=Ar;Hr--;)if(Ve[Hr]===jr)continue e;Cr.push($r)}else ar(Ve,jr,_e)||Cr.push($r)}return Cr},du=function(he){return he},sh=function(he,Ve,ze){switch(ze.length){case 0:return he.call(Ve);case 1:return he.call(Ve,ze[0]);case 2:return he.call(Ve,ze[0],ze[1]);case 3:return he.call(Ve,ze[0],ze[1],ze[2])}return he.apply(Ve,ze)},ih=Math.max,zp=function(he,Ve,ze){return Ve=ih(Ve===void 0?he.length-1:Ve,0),function(){for(var _e=arguments,At=-1,ar=ih(_e.length-Ve,0),Dt=Array(ar);++At<ar;)Dt[At]=_e[Ve+At];At=-1;for(var vr=Array(Ve+1);++At<Ve;)vr[At]=_e[At];return vr[Ve]=ze(Dt),sh(he,this,vr)}},Zv=function(he){return function(){return he}},Dd=function(){try{var xe=Bl(Object,"defineProperty");return xe({},"",{}),xe}catch{}}(),ey=Dd?function(xe,he){return Dd(xe,"toString",{configurable:!0,enumerable:!1,value:Zv(he),writable:!0})}:du,JS=Date.now,Wp=function(he){var Ve=0,ze=0;return function(){var _e=JS(),At=16-(_e-ze);if(ze=_e,At>0){if(++Ve>=800)return arguments[0]}else Ve=0;return he.apply(void 0,arguments)}},ty=Wp(ey),ch=function(he){return typeof he=="number"&&he>-1&&he%1==0&&he<=9007199254740991},Gp=function(he){return he!=null&&ch(he.length)&&!Ep(he)},ry=function(he){return zi(he)&&Gp(he)},ny=function(he,Ve){return ty(zp(he,Ve,du),he+"")}(function(xe,he){return ry(xe)?Xv(xe,he):[]}),lh=ny;function Kp(xe,he){return he instanceof RegExp?"__REGEXP "+he.toString():he}function Jn(xe,he,Ve){var ze;he===void 0&&(he={});var _e={};return Qn(ze=la(xe)).call(ze,function(At){var ar=xe[At].type,Dt=Ve?"In "+Ve+", ":"";if(he[At]===void 0){if(xe[At].required===!1)return void(_e[At]=he[At]);throw new Bo(Dt+'param "'+At+'" is required',{key:At},"required")}var vr=YS[ar];if(vr&&!vr(he,At,xe[At]))throw new Bo(Dt+'param "'+At+'" expects '+fa(xe[At],Kp),{key:At,value:he[At]},fa(xe[At]));_e[At]=he[At]}),_e}var YS={string:function(he,Ve,ze){var _e=ze.allowEmpty,At=ze.max,ar=ze.min,Dt=ze.regExp,vr=he[Ve];return typeof vr=="string"&&(_e!==!1||vr!=="")&&!(typeof At=="number"&&vr.length>At)&&!(typeof ar=="number"&&vr.length<ar)&&!(eh(Dt)&&!Dt.test(vr))},number:function(he,Ve,ze){var _e=ze.min,At=ze.max,ar=he[Ve];return typeof ar=="number"&&!(typeof _e=="number"&&ar<_e)&&!(typeof At=="number"&&ar>At)},boolean:function(he,Ve){return typeof he[Ve]=="boolean"},enum:function(he,Ve,ze){var _e=Bp(ze),At=he[Ve];return!_e||Ja(_e).call(_e,At)>-1},array:function(he,Ve,ze){var _e,At=ze.itemType,ar=ze.rules,Dt=ze.min,vr=ze.max,Cr=Bp(ze),Ar=he[Ve];return!!Hi(Ar)&&!(typeof vr=="number"&&Ar.length>vr)&&!(typeof Dt=="number"&&Ar.length<Dt)&&!(At&&At!=="enum"&&!xS(Ar).call(Ar,function($r){return typeof $r===At}))&&(At!=="enum"||!Cr||!lh.apply(void 0,Ys(_e=[Ar]).call(_e,Cr)).length)&&(ar&&Qn(Ar).call(Ar,function($r,jr){return Jn(ar,$r,Ve+"["+jr+"]")}),!0)},object:function(he,Ve,ze){var _e=ze.rules,At=he[Ve];return _e&&Jn(_e,At,Ve),!0}},pu=Bl(ni,"Set"),XS=function(){},On=function(he){var Ve=-1,ze=Array(he.size);return he.forEach(function(_e){ze[++Ve]=_e}),ze},ZS=pu&&1/On(new pu([,-0]))[1]==1/0?function(xe){return new pu(xe)}:XS,fu=ZS,eT=function(he,Ve,ze){var _e=-1,At=Jv,ar=he.length,Dt=!0,vr=[],Cr=vr;if(ze)Dt=!1,At=Yv;else if(ar>=200){var Ar=Ve?null:fu(he);if(Ar)return On(Ar);Dt=!1,At=Hp,Cr=new nh}else Cr=Ve?[]:vr;e:for(;++_e<ar;){var $r=he[_e],jr=Ve?Ve($r):$r;if($r=ze||$r!==0?$r:0,Dt&&jr==jr){for(var Hr=Cr.length;Hr--;)if(Cr[Hr]===jr)continue e;Ve&&Cr.push(jr),vr.push($r)}else At(Cr,jr,ze)||(Cr!==vr&&Cr.push(jr),vr.push($r))}return vr},Qp=function(he){return he&&he.length?eT(he):[]},uh=`	
\v\f\r                　\u2028\u2029\uFEFF`,oy=Ce("".replace),Jp="["+uh+"]",tT=RegExp("^"+Jp+Jp+"*"),dh=RegExp(Jp+Jp+"*$"),Yp=function(xe){return function(he){var Ve=rs(Sr(he));return 1&xe&&(Ve=oy(Ve,tT,"")),2&xe&&(Ve=oy(Ve,dh,"")),Ve}},Xp={start:Yp(1),end:Yp(2),trim:Yp(3)}.trim,Ud=$.parseInt,ay=$.Symbol,Zp=ay&&ay.iterator,sy=/^[+-]?0x/i,Vd=Ce(sy.exec),ph=Ud(uh+"08")!==8||Ud(uh+"0x16")!==22||Zp&&!V(function(){Ud(Object(Zp))})?function(he,Ve){var ze=Xp(rs(he));return Ud(ze,Ve>>>0||(Vd(sy,ze)?16:10))}:Ud;xn({global:!0,forced:parseInt!=ph},{parseInt:ph});var ac,Uo=Ir.parseInt,ef=(ac=function(){return(65536*(1+Math.random())|0).toString(16).substring(1)},function(){return ac()+ac()+ac()+ac()+ac()+ac()+ac()+ac()});function Wi(xe){var he;return Bs(he=la(xe)).call(he,function(Ve){return!(+Ve>=0)})}function sc(xe,he){var Ve,ze=Bs(Ve=la(xe)).call(Ve,function(_e){return xe[_e]==he});return ze.length>0?ze[0]:void 0}function na(xe,he){if(he===void 0&&(he="-"),!xe)throw new Ec("No sessionId",{},400);var Ve=Ja(xe).call(xe,he);if(Ve===-1)throw new Ec("Can not find conjunctions",{},400);var ze=$o(xe).call(xe,0,Ve);return{accid:$o(xe).call(xe,Ve+1),scene:ze==="super_team"?"superTeam":ze}}var fh=TypeError,Ea=Object.getOwnPropertyDescriptor,iy=qe&&!function(){if(this!==void 0)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(xe){return xe instanceof TypeError}}()?function(xe,he){if(Ms(xe)&&!Ea(xe,"length").writable)throw fh("Cannot set read only .length");return xe.length=he}:function(xe,he){return xe.length=he},rT=TypeError,tf=function(xe,he){if(!delete xe[he])throw rT("Cannot delete property "+vn(he)+" of "+vn(xe))},nT=fc("splice"),oT=Math.max,rf=Math.min;xn({target:"Array",proto:!0,forced:!nT},{splice:function(he,Ve){var ze,_e,At,ar,Dt,vr,Cr=In(this),Ar=Za(Cr),$r=Ai(he,Ar),jr=arguments.length;for(jr===0?ze=_e=0:jr===1?(ze=0,_e=Ar-$r):(ze=jr-2,_e=rf(oT(uc(Ve),0),Ar-$r)),$u(Ar+ze-_e),At=Uu(Cr,_e),ar=0;ar<_e;ar++)(Dt=$r+ar)in Cr&&ii(At,ar,Cr[Dt]);if(At.length=_e,ze<_e){for(ar=$r;ar<Ar-_e;ar++)vr=ar+ze,(Dt=ar+_e)in Cr?Cr[vr]=Cr[Dt]:tf(Cr,vr);for(ar=Ar;ar>Ar-_e+ze;ar--)tf(Cr,ar-1)}else if(ze>_e)for(ar=Ar-_e;ar>$r;ar--)vr=ar+ze-1,(Dt=ar+_e-1)in Cr?Cr[vr]=Cr[Dt]:tf(Cr,vr);for(ar=0;ar<ze;ar++)Cr[ar+$r]=arguments[ar+2];return iy(Cr,Ar-_e+ze),At}});var aT=sa("Array").splice,mh=Array.prototype,gh=function(xe){var he=xe.splice;return xe===mh||sr(mh,xe)&&he===mh.splice?aT:he},sT=function(xe,he,Ve,ze){try{return ze?he(po(Ve)[0],Ve[1]):he(Ve)}catch(_e){sd(xe,"throw",_e)}},nf=Array,cy=!Tg(function(xe){Array.from(xe)});xn({target:"Array",stat:!0,forced:cy},{from:function(he){var Ve=In(he),ze=ml(this),_e=arguments.length,At=_e>1?arguments[1]:void 0,ar=At!==void 0;ar&&(At=Go(At,_e>2?arguments[2]:void 0));var Dt,vr,Cr,Ar,$r,jr,Hr=Ml(Ve),Kr=0;if(!Hr||this===nf&&Dm(Hr))for(Dt=Za(Ve),vr=ze?new this(Dt):nf(Dt);Dt>Kr;Kr++)jr=ar?At(Ve[Kr],Kr):Ve[Kr],ii(vr,Kr,jr);else for($r=(Ar=Sc(Ve,Hr)).next,vr=ze?new this:[];!(Cr=Fe($r,Ar)).done;Kr++)jr=ar?sT(Ar,At,[Cr.value,Kr],!0):Cr.value,ii(vr,Kr,jr);return vr.length=Kr,vr}});var of=Ir.Array.from,qd=Ml;function ly(xe,he){var Ve,ze=Ua!==void 0&&qd(xe)||xe["@@iterator"];if(ze)return Zo(Ve=(ze=ze.call(xe)).next).call(Ve,ze);if(Hi(xe)||(ze=function(ar,Dt){var vr;if(ar){if(typeof ar=="string")return Xc(ar,Dt);var Cr=$o(vr=Object.prototype.toString.call(ar)).call(vr,8,-1);if(Cr==="Object"&&ar.constructor&&(Cr=ar.constructor.name),Cr==="Map"||Cr==="Set")return of(ar);if(Cr==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(Cr))return Xc(ar,Dt)}}(xe))||he&&xe&&typeof xe.length=="number"){ze&&(xe=ze);var _e=0;return function(){return _e>=xe.length?{done:!0}:{done:!1,value:xe[_e++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Xc(xe,he){(he==null||he>xe.length)&&(he=xe.length);for(var Ve=0,ze=new Array(he);Ve<he;Ve++)ze[Ve]=xe[Ve];return ze}var fs,uy=function(){function xe(){this.timerList=[],this.id=0,this.timer=null,this.timeout=0}var he=xe.prototype;return he.addTimer=function(ze,_e,At){_e===void 0&&(_e=0),At===void 0&&(At=1);var ar=new Date().getTime(),Dt=this.id;return this.timerList.push({id:Dt,loop:At,count:0,timeout:ar+_e,interval:_e,callback:ze}),this.id++,this.checkTimer(ar),Dt},he.checkTimer=function(ze){if(ze===void 0&&(ze=new Date().getTime()),this.removeFinished(),this.timerList.length!==0||this.timer==null){for(var _e,At,ar=0,Dt=ly(this.timerList);!(_e=Dt()).done;){var vr=_e.value;(ar===0||ar>vr.timeout)&&(ar=vr.timeout)}this.timerList.length!==0&&(this.timer===null||ar<this.timeout||this.timeout<ze)&&(this.timer=Ro(Zo(At=this.nowTime).call(At,this),ar-ze),this.timeout=ar)}},he.nowTime=function(){for(var ze,_e=new Date().getTime(),At=ly(this.timerList);!(ze=At()).done;){var ar=ze.value;_e>=ar.timeout&&(ar.callback(),ar.count++,ar.timeout=_e+ar.interval)}this.clerTime(),this.checkTimer(_e)},he.clerTime=function(){this.timer!==null&&(clearTimeout(this.timer),this.timer=null)},he.deleteTimer=function(ze){for(var _e=this.timerList.length-1;_e>=0;_e--){var At;this.timerList[_e].id===ze&&gh(At=this.timerList).call(At,_e,1)}},he.removeFinished=function(){for(var ze=this.timerList.length-1;ze>=0;ze--){var _e,At=this.timerList[ze];At.loop>=0&&At.count>=At.loop&&gh(_e=this.timerList).call(_e,ze,1)}},he.destroy=function(){this.clerTime(),this.timerList=[],this.id=0,this.timer=null},xe}(),dy=function(){function xe(Ve){this.core=Ve}var he=xe.prototype;return he.request=function(ze,_e){var At=this,ar=new Date().getTime();return ua.request(ze,_e).catch(function(Dt){var vr,Cr,Ar=Dt;throw At.core.reporter.reportTraceStart("exceptions",{user_id:At.core.options.account,trace_id:(Cr=(vr=At.core)===null||vr===void 0?void 0:vr.socket)===null||Cr===void 0?void 0:Cr.sessionId,start_time:ar,action:1}),At.core.reporter.reportTraceUpdateV2("exceptions",{code:typeof Ar.code=="number"?Ar.code:0,description:Ar.message||""+Ar.code,operation_type:0,target:ze,context:_e?fa(_e):""}),At.core.reporter.reportTraceEnd("exceptions",1),Dt})},he.uploadFile=function(ze){var _e=this,At=new Date().getTime();return ua.uploadFile(ze).catch(function(ar){var Dt,vr,Cr=ar;_e.core.reporter.reportTraceStart("exceptions",{user_id:_e.core.options.account,trace_id:(vr=(Dt=_e.core)===null||Dt===void 0?void 0:Dt.socket)===null||vr===void 0?void 0:vr.sessionId,start_time:At,action:1});var Ar=ua.platform==="BROWSER"?ze.chunkUploadHost:ze.commonUploadHost?ze.commonUploadHost+"/"+(ze.nosToken&&ze.nosToken.bucket):"https://nos.netease.com/nim";throw _e.core.reporter.reportTraceUpdateV2("exceptions",{code:typeof Cr.code=="number"?Cr.code:0,description:Cr.message||""+Cr.code,operation_type:1,target:Ar}),_e.core.reporter.reportTraceEnd("exceptions",1),ar})},xe}();(function(xe){xe[xe.ACTIVE=1]="ACTIVE",xe[xe.KICKED=2]="KICKED",xe[xe.OFFLINE=3]="OFFLINE"})(fs||(fs={}));var Ls=window&&Ep(window.addEventListener)&&Ep(window.removeEventListener),py=function(xe){function he(ze,_e){var At;(At=xe.call(this)||this).status="unconnected",At.linkUrls=[],At.eventBus=new hi,At.packetSer=1,At.retryCount=0,At.reconnectTimer=0,At.backoff=new tc({max:8e3,min:1600,jitter:.01}),At.sendingCmdMap=new xc,At.pingTimer=0,At.config=Lv,At.abtInfo={},Jn({linkUrls:{type:"array",itemType:"string",required:!1}},ze),At.options=zr(zr({},uS),ze),At.adapters=new dy(k(At));var ar=ua.localStorage.getItem("__NIM_DEVC_ID__");At.options.isFixedDeviceId?(ar=ua.localStorage.getItem("__NIM_DEVC_ID__")||ef(),ua.localStorage.setItem("__NIM_DEVC_ID__",ar)):ar=ef(),At.config=zr(zr(zr({},Lv),_e),{deviceId:ar}),At.timerManager=new uy,At.logger=new Np(At.options.debugLevel,At.options.account);var Dt=ua.getSystemInfo();return At.reporter=new MS({common:{app_key:ze.appkey,dev_id:ar,platform:"Web",sdk_ver:"0.13.1",env:"online",os_name:Dt.os,os_ver:Dt.osVer,model:Dt.hostEnvVer,manufactor:Dt.hostEnv,host_env:Dt.hostEnv,host_info:Dt.hostInfo,host_env_ver:Dt.hostEnvVer},request:ua.request,logger:At.logger,autoStart:ua.platform==="BROWSER"}),ua.setLogger(At.logger),At.logger.log("Core init, version ","0.13.1"," sdk version ",91001," appkey ",ze.appkey),At}ea(he,xe);var Ve=he.prototype;return Ve.emit=function(_e){try{for(var At,ar,Dt=Ia(),vr=arguments.length,Cr=new Array(vr>1?vr-1:0),Ar=1;Ar<vr;Ar++)Cr[Ar-1]=arguments[Ar];var $r=(At=xe.prototype.emit).call.apply(At,Ys(ar=[this,_e]).call(ar,Cr)),jr=Ia()-Dt;return jr>=10&&this.logger.warn("Core::emit event: "+_e+" process takes: "+jr+"ms"),$r}catch(Hr){return this.logger.error("Core::emit event: "+_e+". Error: "+Hr),!1}},Ve.connect=function(_e,At){return _e===void 0&&(_e={}),qn(this,void 0,void 0,_r.mark(function ar(){var Dt,vr,Cr,Ar,$r,jr;return _r.wrap(function(Kr){for(;;)switch(Kr.prev=Kr.next){case 0:if(Jn({linkUrls:{type:"array",itemType:"string",required:!1}},_e),/^(unconnected|waitReconnect)$/.test(this.status)){Kr.next=5;break}return Dt="Core socket status is "+this.status+", and would not connect",this.logger.warn(Dt),Kr.abrupt("return",xo.reject(Dt));case 5:this.status="connecting",_e.linkUrls&&_e.linkUrls.length>0&&(this.linkUrls=Ys(vr=_e.linkUrls).call(vr,this.linkUrls),this.linkUrls=Qp(this.linkUrls)),this.linkUrls.length===0&&this.linkUrls.push($v),Cr=0;case 9:if(!(Cr<this.linkUrls.length)){Kr.next=32;break}return Ar=this.linkUrls[Cr],$r=new Date().getTime(),Kr.prev=12,Kr.next=15,this.doConnect(Ar);case 15:return this.status="connected",this.logger.log("core:: connect success with url: "+Ar),this.abtRequest(),Kr.abrupt("return",Ar);case 21:Kr.prev=21,Kr.t0=Kr.catch(12),jr=Kr.t0,At&&At(jr,Ar),this.reporter.reportTraceStart("exceptions",{user_id:this.options.account,start_time:$r,action:0}),this.reporter.reportTraceUpdateV2("exceptions",{code:typeof jr.code=="number"?jr.code:0,description:jr.message||""+jr.code,operation_type:0,target:Ar}),this.reporter.reportTraceEnd("exceptions",1),this.logger.warn("core:: connect failed with url: "+Ar,Kr.t0);case 29:Cr++,Kr.next=9;break;case 32:throw this.retryCount===0?this.doDisconnect(fs.ACTIVE,"SocketHandshakeFailed"):this.doDisconnect(fs.OFFLINE,"ReconnectHadRetryAllLinks"),new Error("core: socket handshake failed");case 34:case"end":return Kr.stop()}},ar,this,[[12,21]])}))},Ve.doConnect=function(_e){var At=this;return new xo(function(ar,Dt){var vr;At.socket=new Jg(At,_e,At.logger),At.socket.on("connect",function(){At.logger.log("socket on connect",_e),ar()}),At.socket.on("message",Zo(vr=At.onMessage).call(vr,At)),At.socket.on("disconnect",function(Cr){At.logger.log("core:: socket on disconnect",Cr),At.doDisconnect(fs.OFFLINE,"SocketOnDisconnect")}),At.socket.on("handshakeFailed",function(){At.logger.warn("core:: socket handshake failed"),Dt(new Ec("handshake failed",{},408))})})},Ve.resetConnectStatus=function(){clearTimeout(this.reconnectTimer),this.backoff.reset(),this.retryCount=0,this.initOnlineListener()},Ve.doDisconnect=function(_e,At){if(this.logger.log("doDisconnect: type "+_e+", description "+At),this.status!=="unconnected"){this.markAllCmdInvaild(new Ec("Packet timeout due to instance disconnect",{},408)),this.timerManager.destroy(),clearTimeout(this.pingTimer),this.socket&&(typeof this.socket.removeAllListeners=="function"&&this.socket.removeAllListeners(),typeof this.socket.close=="function"&&this.socket.close(),this.socket=void 0);var ar=!this.options.needReconnect||this.retryCount>=this.options.reconnectionAttempts;if(_e===fs.ACTIVE||ar)this.logger.log("doDisconnect: emit disconnect, type "+_e,ar),this.status="unconnected",this.reconnectTimer&&clearTimeout(this.reconnectTimer),this.eventBus.emit("disconnect"),this.emit("disconnect"),this.destroyOnlineListener();else if(_e===fs.KICKED){this.logger.log("doDisconnect: kicked"),this.status="unconnected",this.reconnectTimer&&clearTimeout(this.reconnectTimer);var Dt=typeof At=="string"?{reason:"unknow",message:At}:At;this.eventBus.emit("kicked",Dt),this.emit("kicked",Dt),this.destroyOnlineListener()}else _e===fs.OFFLINE?(this.logger.log("doDisconnect: start to reconnect"),this.attempToReconnect()):this.logger.log("doDisconnect: nothing to do")}else this.logger.warn("doDisconnect: already unconnected")},Ve.attempToReconnect=function(){var _e=this;if(this.status!=="waitReconnect"){var At=this.backoff.duration();this.retryCount++,this.logger.log("willReconnect "+this.retryCount+" "+At),this.eventBus.emit("willReconnect",{retryCount:this.retryCount,duration:At}),this.emit("willReconnect",{retryCount:this.retryCount,duration:At}),this.status="waitReconnect",this.reconnectTimer&&clearTimeout(this.reconnectTimer),this.reconnectTimer=Ro(function(){_e.status==="waitReconnect"?_e.connect({isAutoReconnect:!0}).catch(function(){_e.logger.error("core::attempToReconnect failed "+_e.retryCount)}):_e.logger.warn("doDisconnect: reconnectTimer status is "+_e.status+", would not go on reconnecting")},At)}else this.logger.warn("doDisconnect: already is waiting reconnect")},Ve.sendCmd=function(_e,At,ar){var Dt=this;if(this.status!=="logined"&&_e!=="login"&&_e!=="chatroomLogin"&&_e!=="qchatLogin")return this.logger.warn("nim status is "+this.status+", so can not sendCmd "+_e),xo.reject({cmd:_e,error:{code:"No_connected",message:"Connection not established",timetag:new Date().getTime()}});if(!this.socket||!this.socket.send)return xo.reject("No_socket");var vr=_e!=="heartbeat",Cr=vr?this.packetSer++:0,Ar=function(Pn,En,Nn,zn){var yo=nu[Pn];if(!yo)return Nn.error("createCmd:: can not find cmd config: ",Pn),null;var fo,qo={SER:En,SID:yo.sid,CID:yo.cid,Q:[]};return yo.params&&zn&&Qn(fo=yo.params).call(fo,function(ao){var Wr=zn[ao.name];if(!zv(Wr)){var Yn=ao.type,oo=ao.reflectMapper;switch(ao.type){case"PropertyArray":Yn="ArrayMable",Wr=Fo(Wr).call(Wr,function(Wn){return{t:"Property",v:oo?Bd(Wn,oo):Wn}});break;case"Property":Wr=oo?Bd(Wr,oo):Wr;break;case"Bool":case"bool":Wr=Wr?"true":"false"}qo.Q.push({t:Yn,v:Wr})}}),{packet:qo,isNoResponse:yo.isNoResponse||!1}}(_e,Cr,this.logger,At);if(!Ar){var $r="SendCmd "+Cr+" "+_e+" error";return this.logger.error($r),xo.reject($r)}var jr=Ar.packet,Hr=Ar.isNoResponse,Kr=fa(jr);vr&&(this.options.debugLevel==="debug"?this.logger.debug("core::sendCmd",_e,"ser:"+Cr,Kr):this.logger.log("core::sendCmd",_e,"ser:"+Cr));var Sn=new Date().getTime();return new xo(function(Cn,Pn){Dt.sendingCmdMap.set(Cr,{cmd:_e,params:At,callback:[Cn,Pn],timer:Hr?null:Ro(function(){var Nn,zn=new Ap(504,_e,"Packet Timeout",new Date().getTime(),{message:"ser "+Cr+" cmd "+_e+" timeout"});zn.callFunc="sendCmd",Dt.markCmdInvalid(Cr,zn,_e),Dt.reporter.reportTraceStart("exceptions",{user_id:Dt.options.account,trace_id:(Nn=Dt.socket)===null||Nn===void 0?void 0:Nn.sessionId,start_time:Sn,action:2}),Dt.reporter.reportTraceUpdateV2("exceptions",{code:408,description:"Packet timeout",operation_type:1,target:jr.SID+"-"+jr.CID,context:""+jr.SER}),Dt.reporter.reportTraceEnd("exceptions",1)},ar&&ar.timeout?ar.timeout:Dt.config.timeout)});try{Dt.socket.send(Kr)}catch(Nn){var En=new Ap(415,_e,Nn&&Nn.message||"Unable to send packet",new Date().getTime(),{message:"send json error",rawError:Nn});En.callFunc="sendCmd",Dt.markCmdInvalid(Cr,En,_e),Pn(Nn)}})},Ve.onMessage=function(_e){var At=Wv(_e,this.logger);if(At){var ar=At.raw.ser;if(At.error&&this.logger.error("core:onMessage packet error",At.raw.sid+"_"+At.raw.cid+", ser:"+ar+",",At.error),!At.notFound)return At.cmd!=="heartbeat"&&(this.options.debugLevel==="debug"?this.logger.debug("imsocket::recvCmd ser:"+ar,At.cmd,At.content):this.logger.log("imsocket::recvCmd ser:"+ar,At.cmd)),At.__receiveTime=Ia(),At;this.logger.warn("core::onMessage packet not found",At.raw.sid+"_"+At.raw.cid+", ser:"+ar)}},Ve.markCmdInvalid=function(_e,At,ar){var Dt=this.sendingCmdMap.get(_e);if(Dt){var vr=Dt.callback,Cr=Dt.timer;Cr&&clearTimeout(Cr),this.sendingCmdMap.delete(_e),this.logger.warn("packet "+_e+", "+ar+" is invalid:",At),vr[1](At)}},Ve.markAllCmdInvaild=function(_e){var At;this.logger.log("markAllCmdInvaild"),Qn(At=this.sendingCmdMap).call(At,function(ar){var Dt=ar.callback,vr=ar.timer;vr&&clearTimeout(vr),Dt[1](_e)}),this.sendingCmdMap.clear()},Ve.ping=function(){return qn(this,void 0,void 0,_r.mark(function _e(){var At=this;return _r.wrap(function(Dt){for(;;)switch(Dt.prev=Dt.next){case 0:return clearTimeout(this.pingTimer),Dt.prev=1,Dt.next=4,this.sendCmd("heartbeat");case 4:Dt.next=14;break;case 6:return Dt.prev=6,Dt.t0=Dt.catch(1),Dt.next=10,this.testHeartBeat5Timeout();case 10:if(!Dt.sent){Dt.next=14;break}return this.doDisconnect(fs.OFFLINE,"PingError"),Dt.abrupt("return");case 14:this.pingTimer=Ro(function(){At.ping()},3e4);case 15:case"end":return Dt.stop()}},_e,this,[[1,6]])}))},Ve.testHeartBeat5Timeout=function(){return qn(this,void 0,void 0,_r.mark(function _e(){var At;return _r.wrap(function(Dt){for(;;)switch(Dt.prev=Dt.next){case 0:clearTimeout(this.pingTimer),At=0;case 2:if(!(At<5)){Dt.next=15;break}return Dt.prev=3,Dt.next=6,this.sendCmd("heartbeat",{},{timeout:3e3});case 6:return Dt.abrupt("return",!1);case 9:Dt.prev=9,Dt.t0=Dt.catch(3),this.logger.debug("core:: test heartbeat "+At+" Timeout");case 12:At++,Dt.next=2;break;case 15:return Dt.abrupt("return",!0);case 16:case"end":return Dt.stop()}},_e,this,[[3,9]])}))},Ve.initOnlineListener=function(){var _e,At;this.onlineListener||(Ls?(this.onlineListener=Zo(_e=function(){this.status==="logined"&&this.ping()}).call(_e,this),this.offlineListener=Zo(At=function(){this.logger.log("offline"),this.doDisconnect(fs.OFFLINE,"OfflineListener")}).call(At,this),window.addEventListener("online",this.onlineListener),window.addEventListener("offline",this.offlineListener)):this.logger.warn("initOnlineListener not support add listener"))},Ve.destroyOnlineListener=function(){this.onlineListener&&(window.removeEventListener("online",this.onlineListener),this.onlineListener=void 0),this.offlineListener&&(window.removeEventListener("offline",this.offlineListener),this.offlineListener=void 0)},Ve.disconnect=function(){switch(this.status){case"connected":case"logined":case"connecting":case"waitReconnect":return this.doDisconnect(fs.ACTIVE,"UserActiveDisconnect"),xo.resolve();case"unconnected":case"destroyed":return xo.resolve()}},Ve.destroy=function(){var _e=this;return this.disconnect().then(function(){_e.status="destroyed",_e.removeAllListeners(),_e.eventBus.removeAllListeners(),_e.reporter.destroy(),_e.connect=function(){return xo.resolve()},_e.disconnect=function(){return xo.resolve()},_e.destroy=function(){return xo.resolve()}})},Ve.abtRequest=function(){var _e,At;return qn(this,void 0,void 0,_r.mark(function ar(){var Dt,vr;return _r.wrap(function(Ar){for(;;)switch(Ar.prev=Ar.next){case 0:if(this.options.isAbtestEnable){Ar.next=2;break}return Ar.abrupt("return");case 2:if(!this.abtInfo.experiments){Ar.next=4;break}return Ar.abrupt("return");case 4:if(this.options.abtestUrl){Ar.next=6;break}return Ar.abrupt("return");case 6:return Ar.prev=6,Ar.next=9,this.adapters.request(this.options.abtestUrl,{method:"POST",dataType:"json",headers:{sdktype:"ABTest"},data:{clientInfo:{projectKey:this.options.abtestProjectKey,appKey:this.options.appkey,osType:"Web",sdkVersion:"0.13.1",deviceId:this.config.deviceId},useLocalCache:!0}});case 9:Dt=Ar.sent,Ar.next=15;break;case 12:Ar.prev=12,Ar.t0=Ar.catch(6),this.logger.warn("ABTest request failed");case 15:this.abtInfo=((At=(_e=Dt==null?void 0:Dt.data)===null||_e===void 0?void 0:_e.data)===null||At===void 0?void 0:At.abtInfo)||{},this.abtInfo.experiments&&this.abtInfo.experiments.length>0&&this.reporter.reportImmediately("https://statistic.live.126.net/statics/report/abtest/result",{params:{app_key:this.options.appkey,biz_sdk_type:"IM",sdk_ver:"0.13.1",device_id:this.config.deviceId,platform:"Web",projectKey:this.options.abtestProjectKey,experiments:Fo(vr=this.abtInfo.experiments).call(vr,function($r){return{experimentKey:$r.experimentKey,schemeKey:$r.schemeKey}})},headers:{sdktype:"ABTest"},method:"POST",dataType:"json"});case 17:case"end":return Ar.stop()}},ar,this,[[6,12]])}))},he}(hi);py.setAdapters=function(he){zr(ua,he)};var fy={"1_2":"heartbeat","2_3":"login","2_5":"kicked","2_6":"logout","2_7":"multiPortLogin","2_8":"kick"},gy={login:{clientType:3,os:4,sdkVersion:6,appLogin:8,protocolVersion:9,pushTokenName:10,pushToken:11,deviceId:13,appkey:18,account:19,browser:24,session:26,deviceInfo:32,isReactNative:112,token:1e3,customTag:38,customClientType:39,sdkHumanVersion:40,sdkType:41,userAgent:42,authType:115,loginExt:116},loginRes:{lastLoginDeviceId:17,customTag:38,connectionId:102,ip:103,port:104,country:106,hasXMPush:111},loginPort:{type:3,os:4,mac:5,deviceId:13,account:19,deviceInfo:32,customTag:38,connectionId:102,ip:103,time:109},aosPushInfo:{pushType:110,hasTokenPreviously:111}},Hd=Is(gy),hy={login:{sid:2,cid:3,service:"auth",params:[{type:"Property",name:"login",reflectMapper:gy.login}],response:[{type:"Property",name:"loginRes",reflectMapper:Hd.loginRes},{type:"PropertyArray",name:"loginPorts",reflectMapper:Hd.loginPort},{type:"Property",name:"aosPushInfo",reflectMapper:Hd.aosPushInfo}]},logout:{sid:2,cid:6,service:"auth"},heartbeat:{sid:1,cid:2,service:"auth"},kicked:{sid:2,cid:5,service:"auth",response:[{type:"Number",name:"clientType"},{type:"Number",name:"reason"},{type:"String",name:"ext"},{type:"Number",name:"customClientType"}]},multiPortLogin:{sid:2,cid:7,service:"auth",response:[{type:"Number",name:"state"},{type:"PropertyArray",name:"loginPorts",reflectMapper:Hd.loginPort}]},kick:{sid:2,cid:8,service:"auth",params:[{type:"StrArray",name:"deviceIds"}],response:[{type:"StrArray",name:"deviceIds"}]}},Gi=Array.isArray,af=function(he){return typeof he=="symbol"||zi(he)&&zc(he)=="[object Symbol]"},hh=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,sf=/^\w*$/,vh=function(he,Ve){if(Gi(he))return!1;var ze=typeof he;return!(ze!="number"&&ze!="symbol"&&ze!="boolean"&&he!=null&&!af(he))||sf.test(he)||!hh.test(he)||Ve!=null&&he in Object(Ve)};function yh(xe,he){if(typeof xe!="function"||he!=null&&typeof he!="function")throw new TypeError("Expected a function");var Ve=function(){var ze=arguments,_e=he?he.apply(this,ze):ze[0],At=Ve.cache;if(At.has(_e))return At.get(_e);var ar=xe.apply(this,ze);return Ve.cache=At.set(_e,ar)||At,ar};return Ve.cache=new(yh.Cache||Vp),Ve}yh.Cache=Vp;var iT=yh,cT=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,lT=/\\(\\)?/g,mu=function(he){var Ve=iT(he,function(_e){return ze.size===500&&ze.clear(),_e}),ze=Ve.cache;return Ve}(function(xe){var he=[];return xe.charCodeAt(0)===46&&he.push(""),xe.replace(cT,function(Ve,ze,_e,At){he.push(_e?At.replace(lT,"$1"):ze||Ve)}),he}),cf=mu,vy=Ci?Ci.prototype:void 0,bh=vy?vy.toString:void 0,yy=function xe(he){if(typeof he=="string")return he;if(Gi(he))return ah(he,xe)+"";if(af(he))return bh?bh.call(he):"";var Ve=he+"";return Ve=="0"&&1/he==-1/0?"-0":Ve},uT=function(he){return he==null?"":yy(he)},zd=function(he,Ve){return Gi(he)?he:vh(he,Ve)?[he]:cf(uT(he))},$l=function(he){if(typeof he=="string"||af(he))return he;var Ve=he+"";return Ve=="0"&&1/he==-1/0?"-0":Ve},Sh=function(he,Ve){for(var ze=0,_e=(Ve=zd(Ve,he)).length;he!=null&&ze<_e;)he=he[$l(Ve[ze++])];return ze&&ze==_e?he:void 0},oi=function(he,Ve,ze){var _e=he==null?void 0:Sh(he,Ve);return _e===void 0?ze:_e},ic={debugLevel:"off",needReconnect:!0,reconnectionAttempts:wg,lbsUrls:["https://lbs.netease.im/lbs/webconf.jsp"],linkUrl:$v,isAbtestEnable:!0,abtestUrl:"https://abt-online.netease.im/v1/api/abt/client/getExperimentInfo",abtestProjectKey:"imElite_sdk_abtest_web"},lf={},ss=function(xe){function he(ze,_e){var At,ar;_e===void 0&&(_e={serverConfig:{},syncOptions:{},sessionConfig:{}}),(ar=xe.call(this,ze)||this).instanceName="NIM",ar.account="",ar.options={},ar.auth={},ar.offlinePush={},ar.sync={},ar.msg={},ar.msgLog={},ar.session={},ar.cloudSession={},ar.misc={},ar.user={},ar.friend={},ar.systemMessage={},ar.team={},ar.event={},ar.msgExtend={},ar.cloudStorage={},ar.passThrough={},ar.superTeam={},ar.plugin={},ar.signaling={},ar.setOptions(ze),ps({cmdMap:fy,cmdConfig:hy});var Dt=null;return Qn(At=la(lf)).call(At,function(vr){var Cr=lf[vr];vr==="sync"?Dt=Cr:ar[vr]=vr==="session"?new Cr(k(ar),_e.sessionConfig):vr==="cloudStorage"?new Cr(k(ar),zr({storageKeyPrefix:ar.instanceName},_e.serverConfig,_e.cloudStorageConfig)):new Cr(k(ar))}),Dt&&(ar.sync=new Dt(k(ar),_e.syncOptions)),he.instance=k(ar),ar}ea(he,xe),he.getInstance=function(_e,At){if(!he.instance){if(_e)return new he(_e,At);throw new Error("Instance not exist, please input options")}if(_e){if(he.instance.options.account===_e.account&&he.instance.options.appkey===_e.appkey)return he.instance.setOptions(_e),he.instance;throw new Error("Unexpected login")}return he.instance};var Ve=he.prototype;return Ve.setOptions=function(_e){Jn({account:{type:"string"},appkey:{type:"string"},token:{type:"string"},needReconnect:{type:"boolean",required:!1},reconnectionAttempts:{type:"number",required:!1},customClientType:{type:"number",min:1,required:!1},authType:{type:"number",min:0,max:2,required:!1},lbsUrls:{type:"array",itemType:"string",min:1,required:!1},linkUrl:{type:"string",allowEmpty:!1,required:!1}},_e),this.logger.log("NIM::setOptions options is",_e),this.account=_e.account,this.options=zr(zr({},ic),_e)},Ve.connect=function(_e){_e===void 0&&(_e={});var At=Cs(null,{connect:{get:function(){return xe.prototype.connect}}});return qn(this,void 0,void 0,_r.mark(function ar(){var Dt,vr,Cr=this;return _r.wrap(function($r){for(;;)switch($r.prev=$r.next){case 0:if(/^(unconnected|waitReconnect)$/.test(this.status)){$r.next=4;break}return Dt="NIM status is "+this.status+", and would not connect",this.logger.warn(Dt),$r.abrupt("return",xo.reject(Dt));case 4:return this.reporter.reportTraceCancel("login"),this.reporter.reportTraceStart("login",{user_id:this.options.account,action:_e.isAutoReconnect?"auto_login":"manual_login"}),this.reporter.reportTraceUpdateV2("login",{code:0,description:fa(zr(zr({},this.options),{account:"***",token:"***"})),operation_type:"conf_init",succeed:!0,duration:0,target:""}),$r.next=9,this.getLbsInfos();case 9:return $r.prev=9,$r.next=12,At.connect.call(this,_e,function(jr,Hr){Cr.reporter.reportTraceUpdateV2("login",{operation_type:"TCP",target:Hr,code:jr.code||408,description:"ws_handshake_failed:"+jr.message,succeed:!1})});case 12:(vr=$r.sent)&&this.reporter.reportTraceUpdateV2("login",{operation_type:"TCP",target:vr,code:200,succeed:!0}),$r.next=20;break;case 16:throw $r.prev=16,$r.t0=$r.catch(9),this.reporter.reportTraceEnd("login",!1),$r.t0;case 20:return $r.next=22,this.login(_e.isAutoReconnect);case 22:case"end":return $r.stop()}},ar,this,[[9,16]])}))},Ve.login=function(_e){return _e===void 0&&(_e=!1),qn(this,void 0,void 0,_r.mark(function At(){var ar,Dt;return _r.wrap(function(Cr){for(;;)switch(Cr.prev=Cr.next){case 0:return Cr.prev=0,Cr.next=3,this.auth.doLogin(_e);case 3:ar=Cr.sent,this.reporter.reportTraceUpdateV2("login",{operation_type:"protocol",target:"2-3",code:200,succeed:!0}),this.reporter.reportTraceEnd("login",!0),this.status="logined",Cr.next=20;break;case 9:if(Cr.prev=9,Cr.t0=Cr.catch(0),Dt=Cr.t0,this.logger.warn("nim login:: login failed",Cr.t0),this.reporter.reportTraceUpdateV2("login",{operation_type:"protocol",target:"2-3",code:Dt.code||0,succeed:!1,description:Dt.message}),this.reporter.reportTraceEnd("login",!1),this.retryCount!==0){Cr.next=18;break}throw this.doDisconnect(fs.ACTIVE,"FailedToInitializeLogin"),Cr.t0;case 18:return this.doDisconnect(fs.OFFLINE,"ReconnectLoginFailed"),Cr.abrupt("return");case 20:return Cr.prev=20,Cr.next=23,this.cloudStorage.init();case 23:Cr.next=28;break;case 25:Cr.prev=25,Cr.t1=Cr.catch(20),this.logger.error("NIM:login cloudStorage init failed ",Cr.t1);case 28:if(this.eventBus.emit("logined",ar),this.emit("logined",ar),this.logger.log("login done"),this.resetConnectStatus(),!this.sync||!this.sync.doSync){Cr.next=35;break}return Cr.next=35,this.sync.doSync();case 35:this.ping();case 36:case"end":return Cr.stop()}},At,this,[[0,9],[20,25]])}))},Ve.onMessage=function(_e){var At,ar,Dt=xe.prototype.onMessage.call(this,_e);if(Dt){var vr=Dt.raw.ser,Cr=this.sendingCmdMap.get(vr);if(Cr&&Cr.cmd===Dt.cmd){var Ar=Cr.callback,$r=Cr.timer,jr=Cr.params;if(clearTimeout($r),Dt.params=jr,this.sendingCmdMap.delete(vr),Dt.cmd==="heartbeat")return void Ar[0]();var Hr=(At=this[Dt.service])===null||At===void 0?void 0:At.process(Dt);Hr&&typeof Hr.then=="function"?Hr.then(function(Kr){Ar[0](Kr)}).catch(function(Kr){Ar[1](Kr)}):(this.logger.log("imsocket:: handlerFn without promise",Dt.service,Dt.cmd),Ar[0]())}else(ar=this[Dt.service])===null||ar===void 0||ar.process(Dt)}},Ve.getLbsInfos=function(){var _e;return qn(this,void 0,void 0,_r.mark(function At(){var ar,Dt,vr,Cr,Ar,$r,jr,Hr,Kr;return _r.wrap(function(Cn){for(;;)switch(Cn.prev=Cn.next){case 0:return ar=this.options.lbsUrls[0],Dt=Ja(ar).call(ar,"?")>-1?"&":"?",vr=ar+Dt+"k="+this.options.appkey+"&id="+this.options.account+"&sv=180&pv=1&networkType=0",Cn.prev=3,this.logger.log("getLbsInfos ",vr),Cn.next=7,this.adapters.request(vr,{method:"GET",dataType:"json",timeout:1e4});case 7:if((Ar=Cn.sent).status===200&&Ar.data){Cn.next=11;break}throw this.logger.error("getLbsInfos::error status",Ar.status,Ar),new Error("getLbsInfos failed, status "+Ar.status);case 11:this.reporter.reportTraceUpdateV2("login",{operation_type:"HTTP",target:vr,code:200,succeed:!0}),$r=Ar.data,jr=[this.options.linkUrl],oi($r,"common.link")&&(jr=Ys(Hr=oi($r,"common.link")).call(Hr,jr)),oi($r,'common["link.default"]')&&(jr=Ys(jr).call(jr,oi($r,'common["link.default"]'))),this.linkUrls=Qp(jr),Ar.data["nos-chunk"]&&((_e=this.cloudStorage)===null||_e===void 0||_e.setOptions({chunkUploadHost:Ar.data["nos-chunk"]})),this.logger.log("getLbsInfos success, socket link:",$o(Cr=this.linkUrls).call(Cr,0),"chunkUploadHost: ",Ar.data["nos-chunk"]),Cn.next=27;break;case 21:Cn.prev=21,Cn.t0=Cn.catch(3),Kr=Cn.t0,this.logger.error("getLbsInfos::error",Kr),this.linkUrls=[this.options.linkUrl],this.reporter.reportTraceUpdateV2("login",{operation_type:"HTTP",target:vr,description:Kr.message,code:Kr.code||0,succeed:!1});case 27:case"end":return Cn.stop()}},At,this,[[3,21]])}))},Ve.disconnect=function(){var _e=this;switch(this.status){case"logined":return this.sendCmd("logout",void 0,{timeout:1e3}).then(function(){xe.prototype.doDisconnect.call(_e,fs.ACTIVE,"UserActiveDisconnect")}).catch(function(At){_e.logger.error("NIM::disconnect sendCmd:logout error",At),xe.prototype.doDisconnect.call(_e,fs.ACTIVE,"UserActiveDisconnect")});case"connected":case"connecting":case"waitReconnect":return xe.prototype.doDisconnect.call(this,fs.ACTIVE,"UserActiveDisconnect"),xo.resolve();case"unconnected":case"destroyed":return xo.resolve()}},Ve.destroy=function(){return he.instance=null,xe.prototype.destroy.call(this)},Ve.kick=function(_e){return Jn({deviceIds:{type:"array",itemType:"string"}},_e),this.auth.kick(_e)},he.registerService=function(_e,At){lf[At]=_e},he}(py);ss.instance=null;var by=Math.min,Th=[].lastIndexOf,Ch=!!Th&&1/[1].lastIndexOf(1,-0)<0,dT=fi("lastIndexOf"),Mh=Ch||!dT?function(he){if(Ch)return ue(Th,this,arguments)||0;var Ve=wr(this),ze=Za(Ve),_e=ze-1;for(arguments.length>1&&(_e=by(_e,uc(arguments[1]))),_e<0&&(_e=ze+_e);_e>=0;_e--)if(_e in Ve&&Ve[_e]===he)return _e||0;return-1}:Th;xn({target:"Array",proto:!0,forced:Mh!==[].lastIndexOf},{lastIndexOf:Mh});var pT=sa("Array").lastIndexOf,uf=Array.prototype,kh=function(xe){var he=xe.lastIndexOf;return xe===uf||sr(uf,xe)&&he===uf.lastIndexOf?pT:he},gu=g(function(xe,he){(function(){var Ve={function:!0,object:!0}[typeof window]&&window||this,ze=he,_e=xe&&!xe.nodeType&&xe,At=ze&&_e&&typeof e=="object"&&e;!At||At.global!==At&&At.window!==At&&At.self!==At||(Ve=At);var ar=Math.pow(2,53)-1,Dt=/\bOpera/,vr=Object.prototype,Cr=vr.hasOwnProperty,Ar=vr.toString;function $r(Nn){return(Nn=String(Nn)).charAt(0).toUpperCase()+Nn.slice(1)}function jr(Nn){return Nn=Pn(Nn),/^(?:webOS|i(?:OS|P))/.test(Nn)?Nn:$r(Nn)}function Hr(Nn,zn){for(var yo in Nn)Cr.call(Nn,yo)&&zn(Nn[yo],yo,Nn)}function Kr(Nn){return Nn==null?$r(Nn):Ar.call(Nn).slice(8,-1)}function Sn(Nn){return String(Nn).replace(/([ -])(?!$)/g,"$1?")}function Cn(Nn,zn){var yo=null;return function(qo,ao){var Wr=-1,Yn=qo?qo.length:0;if(typeof Yn=="number"&&Yn>-1&&Yn<=ar)for(;++Wr<Yn;)ao(qo[Wr],Wr,qo);else Hr(qo,ao)}(Nn,function(fo,qo){yo=zn(yo,fo,qo,Nn)}),yo}function Pn(Nn){return String(Nn).replace(/^ +| +$/g,"")}var En=function Nn(zn){var yo=Ve,fo=zn&&typeof zn=="object"&&Kr(zn)!="String";fo&&(yo=zn,zn=null);var qo=yo.navigator||{},ao=qo.userAgent||"";zn||(zn=ao);var Wr,Yn,oo=fo?!!qo.likeChrome:/\bChrome\b/.test(zn)&&!/internal|\n/i.test(Ar.toString()),Wn="Object",Un=fo?Wn:"ScriptBridgingProxyObject",no=fo?Wn:"Environment",uo=fo&&yo.java?"JavaPackage":Kr(yo.java),Mo=fo?Wn:"RuntimeObject",wo=/\bJava/.test(uo)&&yo.java,pa=wo&&Kr(yo.environment)==no,Jo=wo?"a":"α",ls=wo?"b":"β",jo=yo.document||{},Yo=yo.operamini||yo.opera,wa=Dt.test(wa=fo&&Yo?Yo["[[Class]]"]:Kr(Yo))?wa:Yo=null,ul=zn,ra=[],qc=null,hs=zn==ao,Po=hs&&Yo&&typeof Yo.version=="function"&&Yo.version(),xa=function(os){return Cn(os,function(za,Xa){return za||RegExp("\\b"+(Xa.pattern||Sn(Xa))+"\\b","i").exec(zn)&&(Xa.label||Xa)})}([{label:"EdgeHTML",pattern:"Edge"},"Trident",{label:"WebKit",pattern:"AppleWebKit"},"iCab","Presto","NetFront","Tasman","KHTML","Gecko"]),go=function(os){return Cn(os,function(za,Xa){return za||RegExp("\\b"+(Xa.pattern||Sn(Xa))+"\\b","i").exec(zn)&&(Xa.label||Xa)})}(["Adobe AIR","Arora","Avant Browser","Breach","Camino","Electron","Epiphany","Fennec","Flock","Galeon","GreenBrowser","iCab","Iceweasel","K-Meleon","Konqueror","Lunascape","Maxthon",{label:"Microsoft Edge",pattern:"(?:Edge|Edg|EdgA|EdgiOS)"},"Midori","Nook Browser","PaleMoon","PhantomJS","Raven","Rekonq","RockMelt",{label:"Samsung Internet",pattern:"SamsungBrowser"},"SeaMonkey",{label:"Silk",pattern:"(?:Cloud9|Silk-Accelerated)"},"Sleipnir","SlimBrowser",{label:"SRWare Iron",pattern:"Iron"},"Sunrise","Swiftfox","Vivaldi","Waterfox","WebPositive",{label:"Yandex Browser",pattern:"YaBrowser"},{label:"UC Browser",pattern:"UCBrowser"},"Opera Mini",{label:"Opera Mini",pattern:"OPiOS"},"Opera",{label:"Opera",pattern:"OPR"},"Chromium","Chrome",{label:"Chrome",pattern:"(?:HeadlessChrome)"},{label:"Chrome Mobile",pattern:"(?:CriOS|CrMo)"},{label:"Firefox",pattern:"(?:Firefox|Minefield)"},{label:"Firefox for iOS",pattern:"FxiOS"},{label:"IE",pattern:"IEMobile"},{label:"IE",pattern:"MSIE"},"Safari"]),ia=YC([{label:"BlackBerry",pattern:"BB10"},"BlackBerry",{label:"Galaxy S",pattern:"GT-I9000"},{label:"Galaxy S2",pattern:"GT-I9100"},{label:"Galaxy S3",pattern:"GT-I9300"},{label:"Galaxy S4",pattern:"GT-I9500"},{label:"Galaxy S5",pattern:"SM-G900"},{label:"Galaxy S6",pattern:"SM-G920"},{label:"Galaxy S6 Edge",pattern:"SM-G925"},{label:"Galaxy S7",pattern:"SM-G930"},{label:"Galaxy S7 Edge",pattern:"SM-G935"},"Google TV","Lumia","iPad","iPod","iPhone","Kindle",{label:"Kindle Fire",pattern:"(?:Cloud9|Silk-Accelerated)"},"Nexus","Nook","PlayBook","PlayStation Vita","PlayStation","TouchPad","Transformer",{label:"Wii U",pattern:"WiiU"},"Wii","Xbox One",{label:"Xbox 360",pattern:"Xbox"},"Xoom"]),Ds=function(os){return Cn(os,function(za,Xa,bv){return za||(Xa[ia]||Xa[/^[a-z]+(?: +[a-z]+\b)*/i.exec(ia)]||RegExp("\\b"+Sn(bv)+"(?:\\b|\\w*\\d)","i").exec(zn))&&bv})}({Apple:{iPad:1,iPhone:1,iPod:1},Alcatel:{},Archos:{},Amazon:{Kindle:1,"Kindle Fire":1},Asus:{Transformer:1},"Barnes & Noble":{Nook:1},BlackBerry:{PlayBook:1},Google:{"Google TV":1,Nexus:1},HP:{TouchPad:1},HTC:{},Huawei:{},Lenovo:{},LG:{},Microsoft:{Xbox:1,"Xbox One":1},Motorola:{Xoom:1},Nintendo:{"Wii U":1,Wii:1},Nokia:{Lumia:1},Oppo:{},Samsung:{"Galaxy S":1,"Galaxy S2":1,"Galaxy S3":1,"Galaxy S4":1},Sony:{PlayStation:1,"PlayStation Vita":1},Xiaomi:{Mi:1,Redmi:1}}),bo=function(os){return Cn(os,function(za,Xa){var bv=Xa.pattern||Sn(Xa);return!za&&(za=RegExp("\\b"+bv+"(?:/[\\d.]+|[ \\w.]*)","i").exec(zn))&&(za=function(Jl,GC,KC){var QC={"10.0":"10",6.4:"10 Technical Preview",6.3:"8.1",6.2:"8",6.1:"Server 2008 R2 / 7","6.0":"Server 2008 / Vista",5.2:"Server 2003 / XP 64-bit",5.1:"XP",5.01:"2000 SP1","5.0":"2000","4.0":"NT","4.90":"ME"};return GC&&KC&&/^Win/i.test(Jl)&&!/^Windows Phone /i.test(Jl)&&(QC=QC[/[\d.]+$/.exec(Jl)])&&(Jl="Windows "+QC),Jl=String(Jl),GC&&KC&&(Jl=Jl.replace(RegExp(GC,"i"),KC)),jr(Jl.replace(/ ce$/i," CE").replace(/\bhpw/i,"web").replace(/\bMacintosh\b/,"Mac OS").replace(/_PowerPC\b/i," OS").replace(/\b(OS X) [^ \d]+/i,"$1").replace(/\bMac (OS X)\b/,"$1").replace(/\/(\d)/," $1").replace(/_/g,".").replace(/(?: BePC|[ .]*fc[ \d.]+)$/i,"").replace(/\bx86\.64\b/gi,"x86_64").replace(/\b(Windows Phone) OS\b/,"$1").replace(/\b(Chrome OS \w+) [\d.]+\b/,"$1").split(" on ")[0])}(za,bv,Xa.label||Xa)),za})}(["Windows Phone","KaiOS","Android","CentOS",{label:"Chrome OS",pattern:"CrOS"},"Debian",{label:"DragonFly BSD",pattern:"DragonFly"},"Fedora","FreeBSD","Gentoo","Haiku","Kubuntu","Linux Mint","OpenBSD","Red Hat","SuSE","Ubuntu","Xubuntu","Cygwin","Symbian OS","hpwOS","webOS ","webOS","Tablet OS","Tizen","Linux","Mac OS X","Macintosh","Mac","Windows 98;","Windows "]);function YC(Ei){return Cn(Ei,function(os,za){var Xa=za.pattern||Sn(za);return!os&&(os=RegExp("\\b"+Xa+" *\\d+[.\\w_]*","i").exec(zn)||RegExp("\\b"+Xa+" *\\w+-[\\w]*","i").exec(zn)||RegExp("\\b"+Xa+"(?:; *(?:[a-z]+[_-])?[a-z]+\\d+|[^ ();-]*)","i").exec(zn))&&((os=String(za.label&&!RegExp(Xa,"i").test(za.label)?za.label:os).split("/"))[1]&&!/[\d.]+/.test(os[0])&&(os[0]+=" "+os[1]),za=za.label||za,os=jr(os[0].replace(RegExp(Xa,"i"),za).replace(RegExp("; *(?:"+za+"[_-])?","i")," ").replace(RegExp("("+za+")[-_.]?(\\w)","i"),"$1 $2"))),os})}function XC(Ei){return Cn(Ei,function(os,za){return os||(RegExp(za+"(?:-[\\d.]+/|(?: for [\\w-]+)?[ /-])([\\d.]+[^ ();/_-]*)","i").exec(zn)||0)[1]||null})}if(xa&&(xa=[xa]),/\bAndroid\b/.test(bo)&&!ia&&(Wr=/\bAndroid[^;]*;(.*?)(?:Build|\) AppleWebKit)\b/i.exec(zn))&&(ia=Pn(Wr[1]).replace(/^[a-z]{2}-[a-z]{2};\s*/i,"")||null),Ds&&!ia?ia=YC([Ds]):Ds&&ia&&(ia=ia.replace(RegExp("^("+Sn(Ds)+")[-_.\\s]","i"),Ds+" ").replace(RegExp("^("+Sn(Ds)+")[-_.]?(\\w)","i"),Ds+" $2")),(Wr=/\bGoogle TV\b/.exec(ia))&&(ia=Wr[0]),/\bSimulator\b/i.test(zn)&&(ia=(ia?ia+" ":"")+"Simulator"),go=="Opera Mini"&&/\bOPiOS\b/.test(zn)&&ra.push("running in Turbo/Uncompressed mode"),go=="IE"&&/\blike iPhone OS\b/.test(zn)?(Ds=(Wr=Nn(zn.replace(/like iPhone OS/,""))).manufacturer,ia=Wr.product):/^iP/.test(ia)?(go||(go="Safari"),bo="iOS"+((Wr=/ OS ([\d_]+)/i.exec(zn))?" "+Wr[1].replace(/_/g,"."):"")):go=="Konqueror"&&/^Linux\b/i.test(bo)?bo="Kubuntu":Ds&&Ds!="Google"&&(/Chrome/.test(go)&&!/\bMobile Safari\b/i.test(zn)||/\bVita\b/.test(ia))||/\bAndroid\b/.test(bo)&&/^Chrome/.test(go)&&/\bVersion\//i.test(zn)?(go="Android Browser",bo=/\bAndroid\b/.test(bo)?bo:"Android"):go=="Silk"?(/\bMobi/i.test(zn)||(bo="Android",ra.unshift("desktop mode")),/Accelerated *= *true/i.test(zn)&&ra.unshift("accelerated")):go=="UC Browser"&&/\bUCWEB\b/.test(zn)?ra.push("speed mode"):go=="PaleMoon"&&(Wr=/\bFirefox\/([\d.]+)\b/.exec(zn))?ra.push("identifying as Firefox "+Wr[1]):go=="Firefox"&&(Wr=/\b(Mobile|Tablet|TV)\b/i.exec(zn))?(bo||(bo="Firefox OS"),ia||(ia=Wr[1])):!go||(Wr=!/\bMinefield\b/i.test(zn)&&/\b(?:Firefox|Safari)\b/.exec(go))?(go&&!ia&&/[\/,]|^[^(]+?\)/.test(zn.slice(zn.indexOf(Wr+"/")+8))&&(go=null),(Wr=ia||Ds||bo)&&(ia||Ds||/\b(?:Android|Symbian OS|Tablet OS|webOS)\b/.test(bo))&&(go=/[a-z]+(?: Hat)?/i.exec(/\bAndroid\b/.test(bo)?bo:Wr)+" Browser")):go=="Electron"&&(Wr=(/\bChrome\/([\d.]+)\b/.exec(zn)||0)[1])&&ra.push("Chromium "+Wr),Po||(Po=XC(["(?:Cloud9|CriOS|CrMo|Edge|Edg|EdgA|EdgiOS|FxiOS|HeadlessChrome|IEMobile|Iron|Opera ?Mini|OPiOS|OPR|Raven|SamsungBrowser|Silk(?!/[\\d.]+$)|UCBrowser|YaBrowser)","Version",Sn(go),"(?:Firefox|Minefield|NetFront)"])),(Wr=(xa=="iCab"&&parseFloat(Po)>3?"WebKit":/\bOpera\b/.test(go)&&(/\bOPR\b/.test(zn)?"Blink":"Presto"))||/\b(?:Midori|Nook|Safari)\b/i.test(zn)&&!/^(?:Trident|EdgeHTML)$/.test(xa)&&"WebKit"||!xa&&/\bMSIE\b/i.test(zn)&&(bo=="Mac OS"?"Tasman":"Trident")||xa=="WebKit"&&/\bPlayStation\b(?! Vita\b)/i.test(go)&&"NetFront")&&(xa=[Wr]),go=="IE"&&(Wr=(/; *(?:XBLWP|ZuneWP)(\d+)/i.exec(zn)||0)[1])?(go+=" Mobile",bo="Windows Phone "+(/\+$/.test(Wr)?Wr:Wr+".x"),ra.unshift("desktop mode")):/\bWPDesktop\b/i.test(zn)?(go="IE Mobile",bo="Windows Phone 8.x",ra.unshift("desktop mode"),Po||(Po=(/\brv:([\d.]+)/.exec(zn)||0)[1])):go!="IE"&&xa=="Trident"&&(Wr=/\brv:([\d.]+)/.exec(zn))&&(go&&ra.push("identifying as "+go+(Po?" "+Po:"")),go="IE",Po=Wr[1]),hs){if(function(os,za){var Xa=os!=null?typeof os[za]:"number";return!(/^(?:boolean|number|string|undefined)$/.test(Xa)||Xa=="object"&&!os[za])}(yo,"global"))if(wo&&(ul=(Wr=wo.lang.System).getProperty("os.arch"),bo=bo||Wr.getProperty("os.name")+" "+Wr.getProperty("os.version")),pa){try{Po=yo.require("ringo/engine").version.join("."),go="RingoJS"}catch{(Wr=yo.system)&&Wr.global.system==yo.system&&(go="Narwhal",bo||(bo=Wr[0].os||null))}go||(go="Rhino")}else typeof yo.process=="object"&&!yo.process.browser&&(Wr=yo.process)&&(typeof Wr.versions=="object"&&(typeof Wr.versions.electron=="string"?(ra.push("Node "+Wr.versions.node),go="Electron",Po=Wr.versions.electron):typeof Wr.versions.nw=="string"&&(ra.push("Chromium "+Po,"Node "+Wr.versions.node),go="NW.js",Po=Wr.versions.nw)),go||(go="Node.js",ul=Wr.arch,bo=Wr.platform,Po=(Po=/[\d.]+/.exec(Wr.version))?Po[0]:null));else Kr(Wr=yo.runtime)==Un?(go="Adobe AIR",bo=Wr.flash.system.Capabilities.os):Kr(Wr=yo.phantom)==Mo?(go="PhantomJS",Po=(Wr=Wr.version||null)&&Wr.major+"."+Wr.minor+"."+Wr.patch):typeof jo.documentMode=="number"&&(Wr=/\bTrident\/(\d+)/i.exec(zn))?(Po=[Po,jo.documentMode],(Wr=+Wr[1]+4)!=Po[1]&&(ra.push("IE "+Po[1]+" mode"),xa&&(xa[1]=""),Po[1]=Wr),Po=go=="IE"?String(Po[1].toFixed(1)):Po[0]):typeof jo.documentMode=="number"&&/^(?:Chrome|Firefox)\b/.test(go)&&(ra.push("masking as "+go+" "+Po),go="IE",Po="11.0",xa=["Trident"],bo="Windows");bo=bo&&jr(bo)}if(Po&&(Wr=/(?:[ab]|dp|pre|[ab]\d+pre)(?:\d+\+?)?$/i.exec(Po)||/(?:alpha|beta)(?: ?\d)?/i.exec(zn+";"+(hs&&qo.appMinorVersion))||/\bMinefield\b/i.test(zn)&&"a")&&(qc=/b/i.test(Wr)?"beta":"alpha",Po=Po.replace(RegExp(Wr+"\\+?$"),"")+(qc=="beta"?ls:Jo)+(/\d+\+?/.exec(Wr)||"")),go=="Fennec"||go=="Firefox"&&/\b(?:Android|Firefox OS|KaiOS)\b/.test(bo))go="Firefox Mobile";else if(go=="Maxthon"&&Po)Po=Po.replace(/\.[\d.]+/,".x");else if(/\bXbox\b/i.test(ia))ia=="Xbox 360"&&(bo=null),ia=="Xbox 360"&&/\bIEMobile\b/.test(zn)&&ra.unshift("mobile mode");else if(!/^(?:Chrome|IE|Opera)$/.test(go)&&(!go||ia||/Browser|Mobi/.test(go))||bo!="Windows CE"&&!/Mobi/i.test(zn))if(go=="IE"&&hs)try{yo.external===null&&ra.unshift("platform preview")}catch{ra.unshift("embedded")}else(/\bBlackBerry\b/.test(ia)||/\bBB10\b/.test(zn))&&(Wr=(RegExp(ia.replace(/ +/g," *")+"/([.\\d]+)","i").exec(zn)||0)[1]||Po)?(bo=((Wr=[Wr,/BB10/.test(zn)])[1]?(ia=null,Ds="BlackBerry"):"Device Software")+" "+Wr[0],Po=null):this!=Hr&&ia!="Wii"&&(hs&&Yo||/Opera/.test(go)&&/\b(?:MSIE|Firefox)\b/i.test(zn)||go=="Firefox"&&/\bOS X (?:\d+\.){2,}/.test(bo)||go=="IE"&&(bo&&!/^Win/.test(bo)&&Po>5.5||/\bWindows XP\b/.test(bo)&&Po>8||Po==8&&!/\bTrident\b/.test(zn)))&&!Dt.test(Wr=Nn.call(Hr,zn.replace(Dt,"")+";"))&&Wr.name&&(Wr="ing as "+Wr.name+((Wr=Wr.version)?" "+Wr:""),Dt.test(go)?(/\bIE\b/.test(Wr)&&bo=="Mac OS"&&(bo=null),Wr="identify"+Wr):(Wr="mask"+Wr,go=wa?jr(wa.replace(/([a-z])([A-Z])/g,"$1 $2")):"Opera",/\bIE\b/.test(Wr)&&(bo=null),hs||(Po=null)),xa=["Presto"],ra.push(Wr));else go+=" Mobile";(Wr=(/\bAppleWebKit\/([\d.]+\+?)/i.exec(zn)||0)[1])&&(Wr=[parseFloat(Wr.replace(/\.(\d)$/,".0$1")),Wr],go=="Safari"&&Wr[1].slice(-1)=="+"?(go="WebKit Nightly",qc="alpha",Po=Wr[1].slice(0,-1)):Po!=Wr[1]&&Po!=(Wr[2]=(/\bSafari\/([\d.]+\+?)/i.exec(zn)||0)[1])||(Po=null),Wr[1]=(/\b(?:Headless)?Chrome\/([\d.]+)/i.exec(zn)||0)[1],Wr[0]==537.36&&Wr[2]==537.36&&parseFloat(Wr[1])>=28&&xa=="WebKit"&&(xa=["Blink"]),hs&&(oo||Wr[1])?(xa&&(xa[1]="like Chrome"),Wr=Wr[1]||((Wr=Wr[0])<530?1:Wr<532?2:Wr<532.05?3:Wr<533?4:Wr<534.03?5:Wr<534.07?6:Wr<534.1?7:Wr<534.13?8:Wr<534.16?9:Wr<534.24?10:Wr<534.3?11:Wr<535.01?12:Wr<535.02?"13+":Wr<535.07?15:Wr<535.11?16:Wr<535.19?17:Wr<536.05?18:Wr<536.1?19:Wr<537.01?20:Wr<537.11?"21+":Wr<537.13?23:Wr<537.18?24:Wr<537.24?25:Wr<537.36?26:xa!="Blink"?"27":"28")):(xa&&(xa[1]="like Safari"),Wr=(Wr=Wr[0])<400?1:Wr<500?2:Wr<526?3:Wr<533?4:Wr<534?"4+":Wr<535?5:Wr<537?6:Wr<538?7:Wr<601?8:Wr<602?9:Wr<604?10:Wr<606?11:Wr<608?12:"12"),xa&&(xa[1]+=" "+(Wr+=typeof Wr=="number"?".x":/[.+]/.test(Wr)?"":"+")),go=="Safari"&&(!Po||parseInt(Po)>45)?Po=Wr:go=="Chrome"&&/\bHeadlessChrome/i.test(zn)&&ra.unshift("headless")),go=="Opera"&&(Wr=/\bzbov|zvav$/.exec(bo))?(go+=" ",ra.unshift("desktop mode"),Wr=="zvav"?(go+="Mini",Po=null):go+="Mobile",bo=bo.replace(RegExp(" *"+Wr+"$"),"")):go=="Safari"&&/\bChrome\b/.exec(xa&&xa[1])?(ra.unshift("desktop mode"),go="Chrome Mobile",Po=null,/\bOS X\b/.test(bo)?(Ds="Apple",bo="iOS 4.3+"):bo=null):/\bSRWare Iron\b/.test(go)&&!Po&&(Po=XC("Chrome")),Po&&Po.indexOf(Wr=/[\d.]+$/.exec(bo))==0&&zn.indexOf("/"+Wr+"-")>-1&&(bo=Pn(bo.replace(Wr,""))),bo&&bo.indexOf(go)!=-1&&!RegExp(go+" OS").test(bo)&&(bo=bo.replace(RegExp(" *"+Sn(go)+" *"),"")),xa&&!/\b(?:Avant|Nook)\b/.test(go)&&(/Browser|Lunascape|Maxthon/.test(go)||go!="Safari"&&/^iOS/.test(bo)&&/\bSafari\b/.test(xa[1])||/^(?:Adobe|Arora|Breach|Midori|Opera|Phantom|Rekonq|Rock|Samsung Internet|Sleipnir|SRWare Iron|Vivaldi|Web)/.test(go)&&xa[1])&&(Wr=xa[xa.length-1])&&ra.push(Wr),ra.length&&(ra=["("+ra.join("; ")+")"]),Ds&&ia&&ia.indexOf(Ds)<0&&ra.push("on "+Ds),ia&&ra.push((/^on /.test(ra[ra.length-1])?"":"on ")+ia),bo&&(Wr=/ ([\d.+]+)$/.exec(bo),Yn=Wr&&bo.charAt(bo.length-Wr[0].length-1)=="/",bo={architecture:32,family:Wr&&!Yn?bo.replace(Wr[0],""):bo,version:Wr?Wr[1]:null,toString:function(){var Ei=this.version;return this.family+(Ei&&!Yn?" "+Ei:"")+(this.architecture==64?" 64-bit":"")}}),(Wr=/\b(?:AMD|IA|Win|WOW|x86_|x)64\b/i.exec(ul))&&!/\bi686\b/i.test(ul)?(bo&&(bo.architecture=64,bo.family=bo.family.replace(RegExp(" *"+Wr),"")),go&&(/\bWOW64\b/i.test(zn)||hs&&/\w(?:86|32)$/.test(qo.cpuClass||qo.platform)&&!/\bWin64; x64\b/i.test(zn))&&ra.unshift("32-bit")):bo&&/^OS X/.test(bo.family)&&go=="Chrome"&&parseFloat(Po)>=39&&(bo.architecture=64),zn||(zn=null);var Si={};return Si.description=zn,Si.layout=xa&&xa[0],Si.manufacturer=Ds,Si.name=go,Si.prerelease=qc,Si.product=ia,Si.ua=zn,Si.version=go&&Po,Si.os=bo||{architecture:null,family:null,version:null,toString:function(){return"null"}},Si.parse=Nn,Si.toString=function(){return this.description||""},Si.version&&ra.unshift(Po),Si.name&&ra.unshift(go),bo&&go&&(bo!=String(bo).split(" ")[0]||bo!=go.split(" ")[0]&&!ia)&&ra.push(ia?"("+bo+")":"on "+bo),ra.length&&(Si.description=ra.join(" ")),Si}();ze&&_e?Hr(En,function(Nn,zn){ze[zn]=Nn}):Ve.platform=En}).call(e)}),fT=Math.floor,wh=function(xe,he){var Ve=xe.length,ze=fT(Ve/2);return Ve<8?_h(xe,he):mT(xe,wh(Vu(xe,0,ze),he),wh(Vu(xe,ze),he),he)},_h=function(xe,he){for(var Ve,ze,_e=xe.length,At=1;At<_e;){for(ze=At,Ve=xe[At];ze&&he(xe[ze-1],Ve)>0;)xe[ze]=xe[--ze];ze!==At++&&(xe[ze]=Ve)}return xe},mT=function(xe,he,Ve,ze){for(var _e=he.length,At=Ve.length,ar=0,Dt=0;ar<_e||Dt<At;)xe[ar+Dt]=ar<_e&&Dt<At?ze(he[ar],Ve[Dt])<=0?he[ar++]:Ve[Dt++]:ar<_e?he[ar++]:Ve[Dt++];return xe},xh=wh,Sy=xr.match(/firefox\/(\d+)/i),Wd=!!Sy&&+Sy[1],Ga=/MSIE|Trident/.test(xr),Ty=xr.match(/AppleWebKit\/(\d+)\./),Ih=!!Ty&&+Ty[1],Ac=[],Cy=Ce(Ac.sort),My=Ce(Ac.push),gT=V(function(){Ac.sort(void 0)}),ky=V(function(){Ac.sort(null)}),wy=fi("sort"),_y=!V(function(){if(Br)return Br<70;if(!(Wd&&Wd>3)){if(Ga)return!0;if(Ih)return Ih<603;var xe,he,Ve,ze,_e="";for(xe=65;xe<76;xe++){switch(he=String.fromCharCode(xe),xe){case 66:case 69:case 70:case 72:Ve=3;break;case 68:case 71:Ve=4;break;default:Ve=2}for(ze=0;ze<47;ze++)Ac.push({k:he+ze,v:Ve})}for(Ac.sort(function(At,ar){return ar.v-At.v}),ze=0;ze<Ac.length;ze++)he=Ac[ze].k.charAt(0),_e.charAt(_e.length-1)!==he&&(_e+=he);return _e!=="DGBEFHACIJK"}});xn({target:"Array",proto:!0,forced:gT||!ky||!wy||!_y},{sort:function(he){he!==void 0&&Yr(he);var Ve=In(this);if(_y)return he===void 0?Cy(Ve):Cy(Ve,he);var ze,_e,At=[],ar=Za(Ve);for(_e=0;_e<ar;_e++)_e in Ve&&My(At,Ve[_e]);for(xh(At,function(Dt){return function(vr,Cr){return Cr===void 0?-1:vr===void 0?1:Dt!==void 0?+Dt(vr,Cr)||0:rs(vr)>rs(Cr)?1:-1}}(he)),ze=Za(At),_e=0;_e<ze;)Ve[_e]=At[_e++];for(;_e<ar;)tf(Ve,_e++);return Ve}});var hT=sa("Array").sort,Eh=Array.prototype,Zc=function(xe){var he=xe.sort;return xe===Eh||sr(Eh,xe)&&he===Eh.sort?hT:he},Ph=g(function(xe,he){xe.exports=function(){var Ve={d:function(Wr,Yn){for(var oo in Yn)Ve.o(Yn,oo)&&!Ve.o(Wr,oo)&&bc(Wr,oo,{enumerable:!0,get:Yn[oo]})},o:function(Wr,Yn){return Object.prototype.hasOwnProperty.call(Wr,Yn)}},ze={};Ve.d(ze,{default:function(){return qo}});var _e=function ao(Wr){for(var Yn in function(oo,Wn){if(!(oo instanceof Wn))throw new TypeError("Cannot call a class as a function")}(this,ao),this.directUploadAddr="https://wanproxy-web.127.net",this.retryCount=4,this.trunkSize=4194304,this.trunkUploadTimeout=5e4,this.getOffsetTimeout=1e4,this.version="1.0",this.enableCache=!0,this.logger=console,this.onError=function(oo){},this.onProgress=function(oo){},this.onUploadProgress=function(oo){},this.onComplete=function(oo){},Wr)this[Yn]=Wr[Yn]};function At(ao,Wr){var Yn=Ua!==void 0&&qd(ao)||ao["@@iterator"];if(!Yn){if(Hi(ao)||(Yn=function(Mo,wo){if(Mo){var pa;if(typeof Mo=="string")return ar(Mo,wo);var Jo=$o(pa=Object.prototype.toString.call(Mo)).call(pa,8,-1);return Jo==="Object"&&Mo.constructor&&(Jo=Mo.constructor.name),Jo==="Map"||Jo==="Set"?of(Mo):Jo==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(Jo)?ar(Mo,wo):void 0}}(ao))||Wr&&ao&&typeof ao.length=="number"){Yn&&(ao=Yn);var oo=0,Wn=function(){};return{s:Wn,n:function(){return oo>=ao.length?{done:!0}:{done:!1,value:ao[oo++]}},e:function(wo){throw wo},f:Wn}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var Un,no=!0,uo=!1;return{s:function(){Yn=Yn.call(ao)},n:function(){var wo=Yn.next();return no=wo.done,wo},e:function(wo){uo=!0,Un=wo},f:function(){try{no||Yn.return==null||Yn.return()}finally{if(uo)throw Un}}}}function ar(ao,Wr){(Wr==null||Wr>ao.length)&&(Wr=ao.length);for(var Yn=0,oo=new Array(Wr);Yn<Wr;Yn++)oo[Yn]=ao[Yn];return oo}var Dt=window.localStorage;window.localStorage&&typeof window.localStorage.getItem=="function"&&typeof window.localStorage.setItem=="function"&&typeof window.localStorage.removeItem=="function"||(Dt={privateObj:{},setItem:function(Wr,Yn){Dt.privateObj[Wr]=Yn},getItem:function(Wr){return Dt.privateObj[Wr]},removeItem:function(Wr){delete Dt.privateObj[Wr]},getKeys:function(){return la(Dt.privateObj)}});var vr={getFileKey:function(Wr){var Yn=Wr.size.toString(),oo=Wr.lastModified.toString();return"_NosUploader_"+Wr.name+$o(Yn).call(Yn,Yn.length-5)+$o(oo).call(oo,oo.length-5)},getFileInfo:function(Wr){var Yn=Dt.getItem(Wr);if(!Yn)return null;try{return JSON.parse(Yn)}catch{return null}},initFile:function(Wr,Yn,oo){vr.clearExpiredInfo();var Wn=this.getFileKey(Yn),Un={ctx:Wr.ctx!==void 0?Wr.ctx:"",bucket:Wr.bucketName,obj:Wr.objectName,token:Wr.token,modifyAt:Ia(),end:!1};return Wr.payload&&(Un.payload=Wr.payload),oo&&Dt.setItem(Wn,fa(Un)),Wn},setUploadContext:function(Wr,Yn,oo){var Wn=this.getFileInfo(Wr);Wn&&(Wn.ctx=Yn,oo&&Dt.setItem(Wr,fa(Wn)))},setComplete:function(Wr,Yn){var oo=this.getFileInfo(Wr);oo&&(oo.modifyAt=Ia(),oo.end=!0,Yn&&Dt.setItem(Wr,fa(oo)))},getUploadContext:function(Wr){var Yn=this.getFileInfo(Wr);return Yn?Yn.ctx:""},removeFileInfo:function(Wr){Ja(Wr).call(Wr,"_NosUploader_")===0&&Dt.removeItem(Wr)},clearExpiredInfo:function(){var Wr,Yn=typeof Dt.getKeys=="function"?Dt.getKeys():la(Dt),oo=Ia(),Wn=[],Un=At(Yn);try{for(Un.s();!(Wr=Un.n()).done;){var no=Wr.value;if(Ja(no).call(no,"_NosUploader_")===0){var uo=vr.getFileInfo(no);uo===null||oo-uo.modifyAt>qo.expireTime?Dt.removeItem(no):Wn.push({fileInfo:uo,key:no})}}}catch(jo){Un.e(jo)}finally{Un.f()}if(Wn.length>qo.maxFileCache){var Mo,wo,pa=At($o(Mo=Zc(Wn).call(Wn,function(jo,Yo){return Yo.fileInfo.modifyAt-jo.fileInfo.modifyAt})).call(Mo,qo.maxFileCache));try{for(pa.s();!(wo=pa.n()).done;){var Jo,ls=wo.value;Ja(Jo=ls.key).call(Jo,"_NosUploader_")===0&&Dt.removeItem(ls.key)}}catch(jo){pa.e(jo)}finally{pa.f()}}}},Cr=vr;function Ar(ao){return(Ar=typeof Ua=="function"&&typeof Bm=="symbol"?function(Wr){return typeof Wr}:function(Wr){return Wr&&typeof Ua=="function"&&Wr.constructor===Ua&&Wr!==Ua.prototype?"symbol":typeof Wr})(ao)}function $r(ao,Wr){return!Wr||Ar(Wr)!=="object"&&typeof Wr!="function"?function(Yn){if(Yn===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return Yn}(ao):Wr}function jr(ao){var Wr=typeof xc=="function"?new xc:void 0;return(jr=function(oo){var Wn,Un;if(oo===null||(Un=oo,Ja(Wn=Function.toString.call(Un)).call(Wn,"[native code]")===-1))return oo;if(typeof oo!="function")throw new TypeError("Super expression must either be null or a function");if(Wr!==void 0){if(Wr.has(oo))return Wr.get(oo);Wr.set(oo,no)}function no(){return Hr(oo,arguments,Cn(this).constructor)}return no.prototype=Cs(oo.prototype,{constructor:{value:no,enumerable:!1,writable:!0,configurable:!0}}),Sn(no,oo)})(ao)}function Hr(ao,Wr,Yn){return(Hr=Kr()?rc:function(oo,Wn,Un){var no=[null];no.push.apply(no,Wn);var uo=new(Zo(Function).apply(oo,no));return Un&&Sn(uo,Un.prototype),uo}).apply(null,arguments)}function Kr(){if(typeof Reflect>"u"||!rc||rc.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(rc(Boolean,[],function(){})),!0}catch{return!1}}function Sn(ao,Wr){return(Sn=si||function(Yn,oo){return Yn.__proto__=oo,Yn})(ao,Wr)}function Cn(ao){return(Cn=si?pi:function(Wr){return Wr.__proto__||pi(Wr)})(ao)}var Pn=function(ao){(function(Un,no){if(typeof no!="function"&&no!==null)throw new TypeError("Super expression must either be null or a function");Un.prototype=Cs(no&&no.prototype,{constructor:{value:Un,writable:!0,configurable:!0}}),no&&Sn(Un,no)})(Wn,ao);var Wr,Yn,oo=(Wr=Wn,Yn=Kr(),function(){var Un,no=Cn(Wr);if(Yn){var uo=Cn(this).constructor;Un=rc(no,arguments,uo)}else Un=no.apply(this,arguments);return $r(this,Un)});function Wn(Un,no){var uo;return function(Mo,wo){if(!(Mo instanceof wo))throw new TypeError("Cannot call a class as a function")}(this,Wn),(uo=oo.call(this,"NosUploadError:"+Un)).errCode=no,uo.errMsg=Un,uo}return Wn}(jr(Error)),En=function ao(Wr,Yn,oo){if(Wr.uploadState==="uploading"){var Wn=Wr.config,Un=Wr.param,no=Cr.getUploadContext(Wr.fileKey);if(!no)return oo(0);var uo=new XMLHttpRequest,Mo=Wn.directUploadAddr+"/".concat(Un.bucketName)+"/".concat(encodeURIComponent(Un.objectName))+"?uploadContext"+"&context=".concat(no)+"&version=".concat(Wn.version);uo.onreadystatechange=function(){var wo;if(Wr.uploadState!=="abort"&&uo.readyState===4){var pa,Jo,ls,jo;try{jo=JSON.parse(uo.responseText)}catch{jo={errMsg:"JsonParseError in getOffset",errCode:500}}uo.status===200?jo.errCode?Wr.config.onError(new Pn(jo.errMsg,jo.errCode)):oo(jo.offset):uo.status.toString().match(/^5/)?ao(Wr,Yn-1,oo):Yn>0?(typeof((wo=Wn.logger)===null||wo===void 0?void 0:wo.error)=="function"&&Wn.logger.error(Ys(pa="getOffset(".concat(Mo,") error. retry after 3 seconds. ")).call(pa,new Date().toTimeString())),Ro(function(){ao(Wr,Yn-1,oo)},3500)):(Cr.removeFileInfo(Wr.fileKey),uo.status?Wn.onError(new Pn(Ys(Jo=Ys(ls="getOffset(".concat(Mo,") error: ")).call(ls,uo.status," ")).call(Jo,uo.statusText))):Wn.onError(new Pn("getOffset(".concat(Mo,") error. no Error Code"))))}},uo.open("get",Mo),uo.setRequestHeader("x-nos-token",Un.token),uo.timeout=Wn.getOffsetTimeout,uo.send()}},Nn=function ao(Wr,Yn,oo,Wn){if(Wr.uploadState==="uploading"){var Un=Wr.param,no=Wr.config,uo=$o(File.prototype),Mo=Un.ctx!==void 0?Un.ctx:"",wo=Yn+no.trunkSize>Wr.file.size,pa=wo?Wr.file.size:Yn+no.trunkSize,Jo=new XMLHttpRequest,ls=no.directUploadAddr+"/".concat(Un.bucketName)+"/".concat(encodeURIComponent(Un.objectName));if(Jo.upload.onprogress=function(Yo){if(Wr.uploadState!=="abort"){var wa=0;Yo.lengthComputable?(wa=(Yn+Yo.loaded)/Wr.file.size,no.onProgress(wa),no.onUploadProgress({loaded:Yo.loaded,total:Wr.file.size,percentage:wa,percentageText:(100*wa).toFixed(2)+"%"})):no.onError(new Pn("browser does not support query upload progress"))}},Jo.onreadystatechange=function(){var Yo,wa;if(Wr.uploadState!=="abort"&&Jo.readyState===4){var ul,ra,qc,hs;try{hs=JSON.parse(Jo.responseText)}catch(Po){typeof((Yo=no.logger)===null||Yo===void 0?void 0:Yo.error)=="function"&&no.logger.error("JsonParseError in uploadTrunk",Po),hs={errMsg:"JsonParseError in uploadTrunk"}}Jo.status===200?(Wr.setContext(hs.context),wo?(Wn(),Wr.setComplete()):ao(Wr,hs.offset,no.retryCount,Wn)):Jo.status.toString().match(/^5/)?oo>0?ao(Wr,Yn,oo-1,Wn):(Cr.removeFileInfo(Wr.fileKey),no.onError(new Pn(hs.errMsg,hs.errCode))):oo>0?(typeof((wa=no.logger)===null||wa===void 0?void 0:wa.error)=="function"&&no.logger.error(Ys(ul="uploadTrunk(".concat(ls,") error. retry after 3 seconds. ")).call(ul,new Date().toTimeString())),Ro(function(){ao(Wr,Yn,oo-1,Wn)},3500)):(Cr.removeFileInfo(Wr.fileKey),Jo.status?no.onError(new Pn(Ys(ra=Ys(qc="uploadTrunk(".concat(ls,") error: ")).call(qc,Jo.status," ")).call(ra,Jo.statusText))):no.onError(new Pn("uploadTrunk(".concat(ls,") error. no Error Code. Please check your network"))))}},Jo.open("post",ls+"?offset=".concat(Yn)+"&complete=".concat(wo)+"&context=".concat(Mo)+"&version=".concat(no.version)),Jo.setRequestHeader("x-nos-token",Un.token),Wr.file.type&&Jo.setRequestHeader("content-type",Wr.file.type),Jo.timeout=no.trunkUploadTimeout,typeof FileReader<"u"){var jo=new FileReader;jo.addEventListener("load",function(Yo){var wa;!((wa=Yo==null?void 0:Yo.target)===null||wa===void 0)&&wa.result?Jo.send(Yo.target.result):no.onError(new Pn("Read ArrayBuffer failed"))}),jo.addEventListener("error",function(Yo){var wa=Yo.target.error;no.onError(new Pn("Read ArrayBuffer error. ".concat(wa.toString()),wa.code))}),jo.readAsArrayBuffer(uo.call(Wr.file,Yn,pa))}else Jo.send(uo.call(Wr.file,Yn,pa))}};function zn(ao,Wr){for(var Yn=0;Yn<Wr.length;Yn++){var oo=Wr[Yn];oo.enumerable=oo.enumerable||!1,oo.configurable=!0,"value"in oo&&(oo.writable=!0),bc(ao,oo.key,oo)}}var yo=function(){function ao(Yn,oo,Wn){(function(Un,no){if(!(Un instanceof no))throw new TypeError("Cannot call a class as a function")})(this,ao),this.uploadState="paused",this.config=Wn,this.file=Yn,this.param=oo,this.fileKey=Cr.initFile(oo,Yn,this.config.enableCache),this.resume()}var Wr;return(Wr=[{key:"resume",value:function(){var oo=this;if(this.uploadState!=="uploading"){this.setUploadState("uploading");var Wn=this.config;En(this,Wn.retryCount,function(Un){Nn(oo,Un,Wn.retryCount,function(){oo.setUploadState("ended"),typeof Wn.onComplete=="function"&&Wn.onComplete(oo.param)})})}}},{key:"pause",value:function(){this.setUploadState("paused")}},{key:"abort",value:function(){this.setUploadState("abort"),Cr.removeFileInfo(this.fileKey),this.config.onError(new Pn("Upload Aborted",10499))}},{key:"setUploadState",value:function(oo){oo!==this.uploadState&&(this.uploadState=oo)}},{key:"setContext",value:function(oo){Cr.setUploadContext(this.fileKey,oo,this.config.enableCache),this.param.ctx=oo}},{key:"setComplete",value:function(){Cr.setComplete(this.fileKey,this.config.enableCache),this.setUploadState("ended")}}])&&zn(ao.prototype,Wr),ao}(),fo={maxFileCache:6,expireTime:864e5,getFileUploadInformation:function(Wr){var Yn=Cr.getFileKey(Wr),oo=Cr.getFileInfo(Yn);return oo===null?null:Ia()-oo.modifyAt>fo.expireTime?(Cr.removeFileInfo(Yn),null):{uploadInfo:zr({bucketName:oo.bucket,objectName:oo.obj,token:oo.token,ctx:oo.ctx},oo.payload?{payload:oo.payload}:{}),complete:oo.end}},setMaxFileCache:function(Wr){fo.maxFileCache=Wr},setExpireTime:function(Wr){fo.expireTime=Wr},printCaches:function(){for(var Wr=0,Yn=la(localStorage);Wr<Yn.length;Wr++){var oo=Yn[Wr],Wn=Cr.getFileInfo(oo);Wn&&console.log(Wn,"modifiedAt",new Date(Wn.modifyAt).toTimeString())}},createConfig:function(Wr){return new _e(Wr)},createTask:function(Wr,Yn,oo){return new yo(Wr,Yn,oo)}},qo=fo;return ze.default}()}),vT=g(function(xe,he){xe.exports=function(){function Ve(ar){if(ar){var Dt,vr="";return Qn(Dt=la(ar)).call(Dt,function(Cr,Ar){vr+=Ar===0?"?":"&",vr+=Cr+"="+ar[Cr]}),vr}return""}function ze(ar,Dt,vr,Cr){return Error.call(this,vr),this.source=ar,this.code=Dt,this.desc=vr,this.detail=Cr||{},this}function _e(ar,Dt){var vr=Cs(Dt.prototype);vr.constructor=ar,ar.prototype=vr}function At(ar,Dt){Dt===void 0&&(Dt={dataType:"json",method:"GET",timeout:5e3});var vr=Dt.dataType==="text"?"text/plain; charset=UTF-8":"application/json; charset=UTF-8",Cr=Dt.method==="GET"?Ve(Dt.params):"";return new xo(function(Ar,$r){if(window.XMLHttpRequest){var jr,Hr=new XMLHttpRequest;if(Hr.onreadystatechange=function(){if(Hr.readyState===4)if(Hr.status===200){try{jr=JSON.parse(Hr.response||"{}")}catch{jr=Hr.response}Ar({status:Hr.status,data:jr})}else $r(new ze(1,Hr.status,Hr.statusText))},Hr.open(Dt.method,""+ar+Cr),Hr.timeout=Dt.timeout||5e3,Hr.setRequestHeader("Content-Type",vr),Dt.headers)for(var Kr in Dt.headers)Hr.setRequestHeader(Kr,Dt.headers[Kr]);Hr.ontimeout=function(Sn){$r(new ze(1,408,Sn&&Sn.message?Sn.message:"request timeout"))},Hr.send(fa(Dt.data))}else $r(new ze(2,10400,"request no suppout"))})}return _e(ze,Error),At}()}),xy=console,Nc,us,hu,Va,wi,Iy={setLogger:function(he){xy=he},platform:"BROWSER",localStorage:window.localStorage,request:vT,WebSocket:window.WebSocket,uploadFile:function(he){return qn(this,void 0,void 0,_r.mark(function Ve(){var ze,_e,At,ar,Dt,vr;return _r.wrap(function(Ar){for(;;)switch(Ar.prev=Ar.next){case 0:if(he.fileInput||he.file){Ar.next=2;break}throw new Error("File not exist");case 2:if(!he.file){Ar.next=6;break}ar=he.file,Ar.next=20;break;case 6:if(typeof he.fileInput!="string"){Ar.next=15;break}if(!((Dt=document.getElementById(he.fileInput))&&Dt.files&&Dt.files[0])){Ar.next=12;break}ar=Dt.files[0],Ar.next=13;break;case 12:throw new Error("Can not get file from fileInput");case 13:Ar.next=20;break;case 15:if(!(he.fileInput&&he.fileInput.files&&he.fileInput.files[0])){Ar.next=19;break}ar=he.fileInput.files[0],Ar.next=20;break;case 19:throw new Error("Can not get file from fileInput "+he.fileInput);case 20:if(!(he.maxSize&&ar.size>he.maxSize)){Ar.next=22;break}throw new Error("The file exceeds maxSize limit. maxSize: "+he.maxSize+", get "+ar.size);case 22:return Ar.next=24,new xo(function($r,jr){var Hr=Ph.createConfig({enableCache:!1,directUploadAddr:he.chunkUploadHost,onError:function(Cn){jr(Cn)},onProgress:he.onUploadProgress||function(){},onComplete:function(Cn){$r(Cn)}}),Kr=Ph.createTask(ar,{bucketName:he.nosToken.bucket,objectName:decodeURIComponent(he.nosToken.objectName),token:he.nosToken.token},Hr);try{he.onUploadStart&&he.onUploadStart(Kr)}catch(Sn){xy.error("Adapter uploadFile: options.onUploadStart error",Sn&&Sn.message),Kr.abort(),jr(Sn)}});case 24:return(vr=Ar.sent).name=ar.name,vr.size=ar.size,vr.type=ar.type,vr.ext=kh(ze=vr.name).call(ze,".")>-1?$o(_e=vr.name).call(_e,kh(At=vr.name).call(At,".")+1).toLowerCase():"",Ar.abrupt("return",vr);case 30:case"end":return Ar.stop()}},Ve)}))},getSystemInfo:function(){var he,Ve;return{os:((he=gu.os)===null||he===void 0?void 0:he.family)||"",osVer:((Ve=gu.os)===null||Ve===void 0?void 0:Ve.version)||"",browser:gu.name||"",browserVer:gu.version||"",hostEnv:"BROWSER",hostEnvVer:gu.version||"",hostInfo:gu.ua||""}}},Ps=function(){function xe(he,Ve){this.name=he,this.core=Ve,this.name=he,this.logger=Ve.logger,this.core=Ve}return xe.prototype.process=function(Ve){var ze=this[Ve.cmd+"Handler"];return typeof ze=="function"?ze.call(this,Ve):Ve.error&&!Ve.error.ignore?xo.reject(Ve.error):xo.resolve(Ve)},xe}();(function(xe){xe[xe.text=0]="text",xe[xe.image=1]="image",xe[xe.audio=2]="audio",xe[xe.video=3]="video",xe[xe.geo=4]="geo",xe[xe.notification=5]="notification",xe[xe.file=6]="file",xe[xe.tip=10]="tip",xe[xe.robot=11]="robot",xe[xe.g2=12]="g2",xe[xe.custom=100]="custom"})(Nc||(Nc={})),function(xe){xe[xe.p2p=0]="p2p",xe[xe.team=1]="team",xe[xe.superTeam=5]="superTeam"}(us||(us={})),function(xe){xe[xe.Android=1]="Android",xe[xe.iOS=2]="iOS",xe[xe.PC=4]="PC",xe[xe.WindowsPhone=8]="WindowsPhone",xe[xe.Web=16]="Web",xe[xe.Server=32]="Server",xe[xe.Mac=64]="Mac"}(hu||(hu={})),function(xe){xe[xe.unread=1]="unread",xe[xe.read=2]="read",xe[xe.deleted=3]="deleted",xe[xe.sending=4]="sending",xe[xe.sendFailed=5]="sendFailed",xe[xe.sent=6]="sent",xe[xe.receipt=7]="receipt",xe[xe.refused=10]="refused"}(Va||(Va={})),function(xe){xe[xe.default=0]="default",xe[xe.leave=1]="leave",xe[xe.roam=2]="roam"}(wi||(wi={}));var Ah=function(he,Ve){return function(ze){return he(Ve(ze))}},Nh=Ah(Object.getPrototypeOf,Object),yT=Function.prototype,bT=Object.prototype,Ey=yT.toString,ST=bT.hasOwnProperty,jl=Ey.call(Object),Gd=function(he){if(!zi(he)||zc(he)!="[object Object]")return!1;var Ve=Nh(he);if(Ve===null)return!0;var ze=ST.call(Ve,"constructor")&&Ve.constructor;return typeof ze=="function"&&ze instanceof ze&&Ey.call(ze)==jl};function _i(xe,he){if(!Gd(he))return{};var Ve=JSON.parse(fa(he)),ze=Oh(xe,Ve);return JSON.parse(fa(zr(zr({},Ve),ze)))}function Oh(xe,he){if(!Gd(he))return{};var Ve={},ze=la(xe);return Qn(ze).call(ze,function(_e){var At=xe[_e].type;if(typeof At!="string"){var ar=Oh(xe[_e],he);la(ar).length>0&&(Ve[_e]=ar)}else{var Dt=xe[_e],vr=Dt.rawKey||_e,Cr=df[At](he,vr,Dt);Cr!==void 0&&(he[vr]=void 0,Ve[_e]=Cr)}}),Ve}var df={number:function(he,Ve){if(he[Ve]!==void 0)return+he[Ve]},string:function(he,Ve){if(he[Ve]!==void 0)return he[Ve]},boolean:function(he,Ve){return+he[Ve]>0||+he[Ve]!=0&&void 0},enum:function(he,Ve,ze){return Bp(ze)[he[Ve]]},object:function(he,Ve){if(he[Ve]!==void 0)try{return JSON.parse(he[Ve])}catch{return{}}}};function Kd(xe,he){if(!Gd(he))return{};var Ve=JSON.parse(fa(he)),ze=Py(xe,Ve);return JSON.parse(fa(zr(zr({},Ve),ze)))}function Py(xe,he){var Ve;if(!Gd(he))return Op(Ve=la(xe)).call(Ve,function(At,ar){return At[xe[ar].rawKey||ar]=void 0,At},{});var ze={},_e=la(xe);return Qn(_e).call(_e,function(At){var ar=xe[At].type;if(typeof ar!="string"){var Dt=Py(xe[At],he[At]);return zr(ze,Dt),void(he[At]=void 0)}var vr=xe[At],Cr=vr.rawKey||At,Ar=Rh[ar](he,At,vr);he[Cr]=void 0,ze[Cr]=Ar}),ze}var Rh={number:function(he,Ve){return he[Ve]},string:function(he,Ve){return he[Ve]},boolean:function(he,Ve){return he[Ve]===!0?1:he[Ve]===!1?0:void 0},enum:function(he,Ve,ze){return Bp(ze)[he[Ve]]},object:function(he,Ve){if(he[Ve]!==void 0)try{return fa(he[Ve])}catch{return""}}},TT=Rh,Ay=function(he){return function(Ve,ze,_e){for(var At=-1,ar=Object(Ve),Dt=_e(Ve),vr=Dt.length;vr--;){var Cr=Dt[he?vr:++At];if(ze(ar[Cr],Cr,ar)===!1)break}return Ve}}(),CT=function(he,Ve){for(var ze=-1,_e=Array(he);++ze<he;)_e[ze]=Ve(ze);return _e},Bh=function(he){return zi(he)&&zc(he)=="[object Arguments]"},Ny=Object.prototype,pf=Ny.hasOwnProperty,MT=Ny.propertyIsEnumerable,kT=Bh(function(){return arguments}())?Bh:function(xe){return zi(xe)&&pf.call(xe,"callee")&&!MT.call(xe,"callee")},Qd=kT,Fh=function(){return!1},ff=g(function(xe,he){var Ve=he&&!he.nodeType&&he,ze=Ve&&xe&&!xe.nodeType&&xe,_e=ze&&ze.exports===Ve?ni.Buffer:void 0,At=(_e?_e.isBuffer:void 0)||Fh;xe.exports=At}),wT=/^(?:0|[1-9]\d*)$/,mf=function(he,Ve){var ze=typeof he;return!!(Ve=Ve??9007199254740991)&&(ze=="number"||ze!="symbol"&&wT.test(he))&&he>-1&&he%1==0&&he<Ve},Ka={};Ka["[object Float32Array]"]=Ka["[object Float64Array]"]=Ka["[object Int8Array]"]=Ka["[object Int16Array]"]=Ka["[object Int32Array]"]=Ka["[object Uint8Array]"]=Ka["[object Uint8ClampedArray]"]=Ka["[object Uint16Array]"]=Ka["[object Uint32Array]"]=!0,Ka["[object Arguments]"]=Ka["[object Array]"]=Ka["[object ArrayBuffer]"]=Ka["[object Boolean]"]=Ka["[object DataView]"]=Ka["[object Date]"]=Ka["[object Error]"]=Ka["[object Function]"]=Ka["[object Map]"]=Ka["[object Number]"]=Ka["[object Object]"]=Ka["[object RegExp]"]=Ka["[object Set]"]=Ka["[object String]"]=Ka["[object WeakMap]"]=!1;var _T=function(he){return zi(he)&&ch(he.length)&&!!Ka[zc(he)]},Lh=Fs&&Fs.isTypedArray,$h=Lh?ou(Lh):_T,xT=Object.prototype.hasOwnProperty,Oy=function(he,Ve){var ze=Gi(he),_e=!ze&&Qd(he),At=!ze&&!_e&&ff(he),ar=!ze&&!_e&&!At&&$h(he),Dt=ze||_e||At||ar,vr=Dt?CT(he.length,String):[],Cr=vr.length;for(var Ar in he)!Ve&&!xT.call(he,Ar)||Dt&&(Ar=="length"||At&&(Ar=="offset"||Ar=="parent")||ar&&(Ar=="buffer"||Ar=="byteLength"||Ar=="byteOffset")||mf(Ar,Cr))||vr.push(Ar);return vr},gf=Object.prototype,Dl=function(he){var Ve=he&&he.constructor;return he===(typeof Ve=="function"&&Ve.prototype||gf)},jh=Ah(Object.keys,Object),ys=Object.prototype.hasOwnProperty,IT=function(he){if(!Dl(he))return jh(he);var Ve=[];for(var ze in Object(he))ys.call(he,ze)&&ze!="constructor"&&Ve.push(ze);return Ve},Jd=function(he){return Gp(he)?Oy(he):IT(he)},Ry=function(he,Ve){return he&&Ay(he,Ve,Jd)},ET=function(he,Ve,ze,_e){return Ry(he,function(At,ar,Dt){Ve(_e,ze(At),ar,Dt)}),_e},Dh,PT=function(he,Ve){return function(ze,_e){return ET(ze,he,Ve(_e),{})}},AT=Object.prototype.toString,bs=PT(function(xe,he,Ve){he!=null&&typeof he.toString!="function"&&(he=AT.call(he)),xe[he]=Ve},Zv(du)),NT=bs({Android:1,iOS:2,PC:4,WindowsPhone:8,Web:16,Server:32,Mac:64}),Uh={p2p:0,team:1,superTeam:5};function By(xe,he){return xe&&xe.length>0?Fo(xe).call(xe,function(Ve){return zr(zr({},Ve),{account:Ve.account,connectionId:Ve.connectionId,deviceId:Ve.deviceId,ip:Ve.ip,mac:Ve.mac,os:Ve.os,type:NT[Ve.type]||Ve.type,time:Uo(Ve.time),online:he!==3})}):[]}bs(Uh),function(xe){xe[xe.text=0]="text",xe[xe.image=1]="image",xe[xe.audio=2]="audio",xe[xe.video=3]="video",xe[xe.geo=4]="geo",xe[xe.notification=5]="notification",xe[xe.file=6]="file",xe[xe.tip=10]="tip",xe[xe.robot=11]="robot",xe[xe.g2=12]="g2",xe[xe.custom=100]="custom"}(Dh||(Dh={}));var OT={1:{reason:"samePlatformKick",message:"The same account is not allowed to multiple login at the same time"},2:{reason:"serverKick",message:"Kicked out by IM server"},3:{reason:"otherPlatformKick",message:"Kicked out by other client of your account"},4:{reason:"silentlyKick",message:"Quietly kicked"}},Fy={BROWSER:0,RN:2,UNIAPP:3,WECHAT:6},Ly=function(xe){function he(ze){var _e;return _e=xe.call(this,"auth",ze)||this,ps({cmdMap:fy,cmdConfig:hy}),_e}ea(he,xe);var Ve=he.prototype;return Ve.doLogin=function(_e){var At,ar;return _e===void 0&&(_e=!1),qn(this,void 0,void 0,_r.mark(function Dt(){var vr,Cr,Ar,$r,jr,Hr,Kr,Sn,Cn,Pn;return _r.wrap(function(Nn){for(;;)switch(Nn.prev=Nn.next){case 0:return vr=this.core.options,Cr=ua.getSystemInfo(),Ar=zr(zr({},vr),{appLogin:_e?0:1,appkey:vr.appkey,account:vr.account,token:vr.token,deviceId:this.core.config.deviceId,clientType:16,protocolVersion:1,sdkVersion:91001,sdkHumanVersion:"0.13.1",os:Cr.os,browser:Cr.browser,session:(At=this.core.socket)===null||At===void 0?void 0:At.sessionId,sdkType:Fy[ua.platform]||0,userAgent:"Native/0.13.1"}),$r=Cr.os.toLowerCase(),ua.platform!=="UNIAPP"||$r!=="ios"&&$r!=="android"||(Ar.isReactNative=1,Ar.clientType=$r==="ios"?2:1,Cr.pushDeviceInfo&&Cr.pushDeviceInfo.MANUFACTURER&&(Ar.deviceInfo=fa(Cr.pushDeviceInfo))),this.logger.log("auth::do login ",vr.account,(ar=this.core.socket)===null||ar===void 0?void 0:ar.sessionId),Nn.next=8,this.core.sendCmd("login",{login:Ar});case 8:if(!(jr=Nn.sent).error){Nn.next=11;break}throw jr.error;case 11:return Hr=jr.content,Kr=Hr.loginRes,Sn=Hr.loginPorts,Cn=Hr.aosPushInfo,Pn=By(Sn,2),(Pn=Bs(Pn).call(Pn,function(zn){return zn.connectionId!==Kr.connectionId})).length>0&&this.core.emit("multiPortLogin",Pn),Nn.abrupt("return",zr(zr({},Kr),{aosPushInfo:Cn}));case 16:case"end":return Nn.stop()}},Dt,this)}))},Ve.kick=function(_e){var At;return qn(this,void 0,void 0,_r.mark(function ar(){var Dt;return _r.wrap(function(Cr){for(;;)switch(Cr.prev=Cr.next){case 0:return Cr.next=2,this.core.sendCmd("kick",_e);case 2:return Dt=Cr.sent,Cr.abrupt("return",(At=Dt.content)===null||At===void 0?void 0:At.deviceIds);case 4:case"end":return Cr.stop()}},ar,this)}))},Ve.multiPortLoginHandler=function(_e){if(_e.error)this.logger.error("multiPortLoginHandler:: error, ",_e.error);else{var At=_e.content,ar=By(At.loginPorts,At.state);ar.length>0&&this.core.emit("multiPortLogin",ar)}},Ve.kickedHandler=function(_e){if(_e.error)this.logger.error("kickedHandler:: error, ",_e.error);else{var At=function(Dt){var vr=_i({clientType:{type:"enum",values:hu},customClientType:{type:"number"}},Dt),Cr=OT[vr.reason];return zr(vr,Cr=Cr||{reason:"unknow",message:"Unknown reason"})}(_e.content);this.logger.warn("kicked::",At),this.core.doDisconnect(fs.KICKED,At)}},he}(Ps);xn({target:"Number",stat:!0},{isNaN:function(he){return he!=he}});var Yd,RT=Ir.Number.isNaN,BT=bs({none:0,normal:1,all:3}),$y={normal:0,advanced:1},FT=bs($y),LT=bs({normal:0,owner:1,manager:2}),Vh={noVerify:0,needVerify:1,rejectAll:2},jy=bs(Vh),Dy={needVerify:0,noVerify:1},Uy=bs(Dy),vu={manager:0,all:1},Ul=bs(vu),qh={manager:0,all:1},vi=bs(qh),cc={manager:0,all:1},$T=bs(cc);function el(xe){var he,Ve=["teamId"],ze=["level","memberNum","memberUpdateTime","createTime","updateTime"],_e=["valid","validToCurrentUser","mute"],At={type:FT,muteType:BT,joinMode:jy,beInviteMode:Uy,inviteMode:Ul,updateTeamMode:vi,updateExtMode:$T};xe.bits;var ar=ri(xe,["bits"]);return Qn(Ve).call(Ve,function(Dt){ar[Dt]&&(ar[Dt]=ar[Dt].toString())}),Qn(ze).call(ze,function(Dt){ar[Dt]!==void 0&&(ar[Dt]=Uo(ar[Dt]))}),Qn(_e).call(_e,function(Dt){ar[Dt]!==void 0&&(ar[Dt]=Uo(ar[Dt])===1)}),Qn(he=la(At)).call(he,function(Dt){ar[Dt]!==void 0&&(ar[Dt]=At[Dt][ar[Dt]]||ar[Dt])}),ar}function Hh(xe){return xe&&xe.length>0?Fo(xe).call(xe,function(he){return el(he)}):[]}function zh(xe){var he,Ve=zr({},xe),ze=["avatar","name","intro","announcement","ext"],_e={type:$y,joinMode:Vh,beInviteMode:Dy,inviteMode:vu,updateTeamMode:qh,updateExtMode:cc};return Qn(ze).call(ze,function(At){Ve[At]!==void 0&&(Ve[At]=Ve[At].toString())}),Qn(he=la(_e)).call(he,function(At){Ve[At]!==void 0&&(Ve[At]=_e[At][Ve[At]])}),Ve}function Vy(xe){var he=["teamId","ext","account","nickInTeam"],Ve={};return xe.bitConfigMask!==void 0&&(Ve.bits=Uo(xe.bitConfigMask)),Qn(he).call(he,function(ze){xe[ze]&&(Ve[ze]=xe[ze].toString())}),Ve}function Xd(xe){var he,Ve=["teamId"],ze=["joinTime","updateTime","bitConfigMask"],_e=["active","valid","mute"],At={type:LT},ar=xe.bits,Dt=ri(xe,["bits"]);return ar!==void 0&&(Dt.muteTeam=Uo(ar)===1,Dt.bitConfigMask=ar),Dt.id=Dt.teamId+"-"+Dt.account,Qn(Ve).call(Ve,function(vr){Dt[vr]&&(Dt[vr]=Dt[vr].toString())}),Qn(ze).call(ze,function(vr){Dt[vr]!==void 0&&(Dt[vr]=Uo(Dt[vr]))}),Qn(_e).call(_e,function(vr){Dt[vr]!==void 0&&(Dt[vr]=Uo(Dt[vr])===1)}),Qn(he=la(At)).call(he,function(vr){Dt[vr]!==void 0&&(Dt[vr]=At[vr][Dt[vr]]||Dt[vr])}),Dt}function hf(xe){return xe&&xe.length>0?Fo(xe).call(xe,function(he){return Xd(he)}):[]}function qy(xe,he,Ve){return Ve===void 0&&(Ve="normal"),{id:xe.teamId+"-"+he,teamId:xe.teamId,account:he,type:Ve,nickInTeam:"",muteTeam:!1,mute:!1,joinTime:xe.memberUpdateTime,updateTime:xe.memberUpdateTime,active:!0,valid:!0}}function jT(xe,he,Ve){return Ve===void 0&&(Ve="normal"),he&&he.length>0?Fo(he).call(he,function(ze){return qy(xe,ze,Ve)}):[]}function yu(xe){var he=zr({},xe);return he.createTime&&(he.createTime=+he.createTime),he.updateTime&&(he.updateTime=+he.updateTime),he.gender&&(he.gender=Yd[+he.gender]),he}(function(xe){xe[xe.unknown=0]="unknown",xe[xe.male=1]="male",xe[xe.female=2]="female"})(Yd||(Yd={}));var Hy={"8_1":"createTeam","8_5":"addTeamMembers","8_6":"removeTeamMembers","8_7":"updateTeamInfo","8_8":"leaveTeam","8_9":"getTeamInfo","8_10":"getTeams","8_11":"getTeamMembers","8_12":"dismissTeam","8_13":"applyTeam","8_14":"passTeamApply","8_15":"rejectTeamApply","8_16":"addTeamManagers","8_17":"removeTeamManagers","8_18":"transferTeam","8_19":"updateMyMemberInfo","8_20":"updateNickInTeam","8_21":"acceptTeamInvite","8_22":"rejectTeamInvite","8_25":"muteTeamMember","8_27":"getMutedTeamMembers","8_28":"sendTeamMsgReceipt","8_29":"getTeamMsgReads","8_30":"getTeamMsgReadAccounts","8_31":"notifyTeamMsgReceipts","8_32":"muteTeam","8_33":"getTeamMemberInvitorAccid","8_34":"getTeamsById","8_101":"syncCreateTeam","8_109":"syncTeams","8_119":"syncUpdateTeamMember","8_126":"syncMyTeamMembers"},Oc={team:{teamId:1,name:3,type:4,owner:5,level:6,selfCustom:7,valid:8,memberNum:9,memberUpdateTime:10,createTime:11,updateTime:12,validToCurrentUser:13,intro:14,announcement:15,joinMode:16,bits:17,ext:18,serverExt:19,avatar:20,beInviteMode:21,inviteMode:22,updateTeamMode:23,updateExtMode:24,mute:100,muteType:101},teamMsgReceiptTag:{teamId:0,idServer:1,read:100,unread:101,idClient:102,account:103},teamMember:{teamId:1,account:3,type:4,nickInTeam:5,bits:7,active:8,valid:9,joinTime:10,updateTime:11,ext:12,mute:13,invitorAccid:14}},As=Is(Oc),zy={getTeamInfo:{sid:8,cid:9,service:"team",params:[{type:"Long",name:"teamId"}],response:[{type:"Property",name:"team",reflectMapper:As.team}]},getTeams:{sid:8,cid:10,service:"team",params:[{type:"long",name:"timetag"}],response:[{type:"PropertyArray",name:"teams",reflectMapper:As.team},{type:"Number",name:"timetag"}],ignoreErrCodes:[803]},createTeam:{sid:8,cid:1,service:"team",params:[{type:"Property",name:"team",reflectMapper:Oc.team},{type:"StrArray",name:"accounts"},{type:"String",name:"ps"}],response:[{type:"Property",name:"team",reflectMapper:As.team},{type:"StrArray",name:"abortedAccidList"}]},sendTeamMsgReceipt:{sid:8,cid:28,service:"team",params:[{type:"PropertyArray",name:"teamMsgReceipts",reflectMapper:Oc.teamMsgReceiptTag}],response:[{type:"PropertyArray",name:"teamMsgReceipts",reflectMapper:As.teamMsgReceiptTag}]},getTeamMsgReads:{sid:8,cid:29,service:"team",params:[{type:"PropertyArray",name:"teamMsgReceipts",reflectMapper:Oc.teamMsgReceiptTag}],response:[{type:"PropertyArray",name:"teamMsgReceipts",reflectMapper:As.teamMsgReceiptTag}]},getTeamMsgReadAccounts:{sid:8,cid:30,service:"team",params:[{type:"Property",name:"teamMsgReceiptTag",reflectMapper:Oc.teamMsgReceiptTag}],response:[{type:"Property",name:"teamMsgReceipt",reflectMapper:As.teamMsgReceiptTag},{type:"StrArray",name:"readAccounts"},{type:"StrArray",name:"unreadAccounts"}]},notifyTeamMsgReceipts:{sid:8,cid:31,service:"team",response:[{type:"PropertyArray",name:"teamMsgReceipts",reflectMapper:As.teamMsgReceiptTag}]},dismissTeam:{sid:8,cid:12,service:"team",params:[{type:"Long",name:"teamId"}]},leaveTeam:{sid:8,cid:8,service:"team",params:[{type:"Long",name:"teamId"}]},transferTeam:{sid:8,cid:18,service:"team",params:[{type:"Long",name:"teamId"},{type:"String",name:"account"},{type:"bool",name:"leave"}]},updateTeamInfo:{sid:8,cid:7,service:"team",params:[{type:"Property",name:"team",reflectMapper:Oc.team}],response:[{type:"Number",name:"id"},{type:"Number",name:"time"}]},getTeamsById:{sid:8,cid:34,service:"team",params:[{type:"LongArray",name:"teamIds"}],response:[{type:"PropertyArray",name:"teams",reflectMapper:As.team},{type:"StrArray",name:"tids"}],ignoreErrCodes:[816]},getTeamMembers:{sid:8,cid:11,service:"team",params:[{type:"Long",name:"teamId"},{type:"Long",name:"timetag"}],response:[{type:"String",name:"teamId"},{type:"PropertyArray",name:"teamMembers",reflectMapper:As.teamMember},{type:"Number",name:"timetag"}]},getMutedTeamMembers:{sid:8,cid:27,service:"team",params:[{type:"Long",name:"teamId"}],response:[{type:"String",name:"teamId"},{type:"PropertyArray",name:"teamMembers",reflectMapper:As.teamMember}]},addTeamMembers:{sid:8,cid:5,service:"team",params:[{type:"Long",name:"teamId"},{type:"StrArray",name:"accounts"},{type:"String",name:"ps"},{type:"String",name:"attach"}],response:[{type:"Long",name:"time"},{type:"StrArray",name:"abortedAccidList"}]},removeTeamMembers:{sid:8,cid:6,service:"team",params:[{type:"Long",name:"teamId"},{type:"StrArray",name:"accounts"}]},applyTeam:{sid:8,cid:13,service:"team",params:[{type:"Long",name:"teamId"},{type:"String",name:"ps"}],response:[{type:"Property",name:"team",reflectMapper:As.team}]},addTeamManagers:{sid:8,cid:16,service:"team",params:[{type:"Long",name:"teamId"},{type:"StrArray",name:"accounts"}]},removeTeamManagers:{sid:8,cid:17,service:"team",params:[{type:"Long",name:"teamId"},{type:"StrArray",name:"accounts"}]},updateMyMemberInfo:{sid:8,cid:19,service:"team",params:[{type:"Property",name:"teamMember",reflectMapper:Oc.teamMember}]},updateNickInTeam:{sid:8,cid:20,service:"team",params:[{type:"Property",name:"teamMember",reflectMapper:Oc.teamMember}]},muteTeamMember:{sid:8,cid:25,service:"team",params:[{type:"Long",name:"teamId"},{type:"String",name:"account"},{type:"Int",name:"mute"}]},getTeamMemberInvitorAccid:{sid:8,cid:33,service:"team",params:[{type:"Long",name:"teamId"},{type:"StrArray",name:"accounts"}],response:[{type:"Object",name:"accountsMap"}]},muteTeam:{sid:8,cid:32,service:"team",params:[{type:"Long",name:"teamId"},{type:"Int",name:"mute"}]},passTeamApply:{sid:8,cid:14,service:"team",params:[{type:"Long",name:"teamId"},{type:"String",name:"from"}]},rejectTeamApply:{sid:8,cid:15,service:"team",params:[{type:"Long",name:"teamId"},{type:"String",name:"from"},{type:"String",name:"ps"}]},acceptTeamInvite:{sid:8,cid:21,service:"team",params:[{type:"Long",name:"teamId"},{type:"String",name:"from"}]},rejectTeamInvite:{sid:8,cid:22,service:"team",params:[{type:"Long",name:"teamId"},{type:"String",name:"from"},{type:"String",name:"ps"}]},syncTeams:{sid:8,cid:109,service:"team",response:[{type:"Number",name:"timetag"},{type:"PropertyArray",name:"teams",reflectMapper:As.team}]},syncCreateTeam:{sid:8,cid:101,service:"team",response:[{type:"Property",name:"team",reflectMapper:As.team}]},syncUpdateTeamMember:{sid:8,cid:119,service:"team",response:[{type:"Property",name:"teamMember",reflectMapper:As.teamMember}]},syncMyTeamMembers:{sid:8,cid:126,ext:"sync",service:"team",response:[{type:"PropertyArray",name:"teamMembers",entity:"teamMember",reflectMapper:As.teamMember},{type:"Number",name:"timetag"}]}},Wy={"3_7":"getUsersNameCardFromServer","3_10":"updateMyNameCard","3_109":"syncMyNameCard","3_110":"onUpdateMyNameCard","3_3":"setBlack","3_103":"onUpdateBlackList","3_5":"setMute","3_105":"onUpdateMuteList","3_8":"syncRelations"},Rc={user:{account:1,nick:3,avatar:4,signature:5,gender:6,email:7,birth:8,tel:9,ext:10,createTime:12,updateTime:13},relationMember:{account:0,isMuted:1,isBlack:2,createTime:3,updateTime:4}},bu=Is(Rc),DT={syncMyNameCard:{sid:3,cid:109,service:"user",response:[{type:"Property",name:"user",reflectMapper:bu.user},{type:"Number",name:"timetag"}]},setBlack:{service:"user",sid:3,cid:3,params:[{type:"String",name:"account"},{type:"bool",name:"isAdd"}]},onUpdateBlackList:{service:"user",sid:3,cid:103,response:[{type:"String",name:"account"},{type:"Boolean",name:"isAdd"}]},setMute:{service:"user",sid:3,cid:5,params:[{type:"String",name:"account"},{type:"bool",name:"isAdd"}]},onUpdateMuteList:{service:"user",sid:3,cid:105,response:[{type:"String",name:"account"},{type:"Boolean",name:"isAdd"}]},syncRelations:{service:"user",sid:3,cid:8,params:[{type:"long",name:"timetag"}],response:[{type:"PropertyArray",name:"list",reflectMapper:bu.relationMember},{type:"Number",name:"timetag"}]},getUsersNameCardFromServer:{service:"user",sid:3,cid:7,params:[{type:"StrArray",name:"accounts"}],response:[{type:"PropertyArray",name:"users",reflectMapper:bu.user}]},updateMyNameCard:{service:"user",sid:3,cid:10,params:[{type:"Property",name:"user",reflectMapper:Rc.user}],response:[{type:"Number",name:"timetag"}]},onUpdateMyNameCard:{service:"user",sid:3,cid:110,response:[{type:"Property",name:"user",reflectMapper:bu.user}]}},Gy={needPush:{type:"boolean",required:!1},needPushBadge:{type:"boolean",required:!1},needPushNick:{type:"boolean",required:!1},pushContent:{type:"string",allowEmpty:!1,required:!1},pushPayload:{type:"string",allowEmpty:!1,required:!1},needForcePush:{type:"boolean",required:!1},forcePushIDsList:{type:"string",allowEmpty:!1,required:!1},forcePushContent:{type:"string",allowEmpty:!1,required:!1}};function UT(xe,he){var Ve,ze=Ua!==void 0&&qd(xe)||xe["@@iterator"];if(ze)return Zo(Ve=(ze=ze.call(xe)).next).call(Ve,ze);if(Hi(xe)||(ze=function(ar,Dt){var vr;if(ar){if(typeof ar=="string")return Ky(ar,Dt);var Cr=$o(vr=Object.prototype.toString.call(ar)).call(vr,8,-1);if(Cr==="Object"&&ar.constructor&&(Cr=ar.constructor.name),Cr==="Map"||Cr==="Set")return of(ar);if(Cr==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(Cr))return Ky(ar,Dt)}}(xe))||he&&xe&&typeof xe.length=="number"){ze&&(xe=ze);var _e=0;return function(){return _e>=xe.length?{done:!0}:{done:!1,value:xe[_e++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ky(xe,he){(he==null||he>xe.length)&&(he=xe.length);for(var Ve=0,ze=new Array(he);Ve<he;Ve++)ze[Ve]=xe[Ve];return ze}var Wh={subType:{type:"string"},setting:{resendFlag:{type:"boolean"},envConfig:{type:"string"},needSaveHistory:{type:"boolean"},needRoaming:{type:"boolean"},needOffline:{type:"boolean"},needSelfSync:{type:"boolean"},needRouted:{type:"boolean"},needUpdateSession:{type:"boolean"},isMuted:{type:"boolean"}},antiSpamInfo:{needAntiSpam:{type:"boolean"},antiSpamContent:{type:"string"},antiSpamBIZID:{type:"string"},clientAntispamHitting:{type:"boolean"},antiSpamUsingYidun:{type:"boolean"},yidunCallbackURL:{type:"string"},yidunAntiCheating:{type:"string"},yidunAntiSpamExtension:{type:"string"},yidunAntiSpamResult:{type:"string"}},pushInfo:Gy,teamSpecializationInfo:{needACK:{type:"boolean"},isACKSent:{type:"boolean"},ackSnapshot:{type:"number"}},threadMessageInfo:{replyMsgFromAccount:{type:"string"},replyMsgToAccount:{type:"string"},replyMsgTime:{type:"number"},replyMsgIdServer:{type:"string"},replyMsgIdClient:{type:"string"},threadMsgFromAccount:{type:"string"},threadMsgToAccount:{type:"string"},threadMsgTime:{type:"number"},threadMsgIdServer:{type:"string"},threadMsgIdClient:{type:"string"}}},tl={0:"addTeamMembers",1:"removeTeamMembers",2:"leaveTeam",3:"updateTeam",4:"dismissTeam",5:"passTeamApply",6:"transferTeam",7:"addTeamManagers",8:"removeTeamManagers",9:"acceptTeamInvite",10:"updateTeamMemberMute",101:"netcallMiss",102:"netcallBill",103:"netcallReject",401:"addSuperTeamMembers",402:"removeSuperTeamMembers",403:"leaveSuperTeam",404:"updateSuperTeam",405:"dismissSuperTeam",406:"transferSuperTeam",407:"addSuperTeamManagers",408:"removeSuperTeamManagers",409:"updateSuperTeamMembersMute",410:"passSuperTeamApply",411:"acceptSuperTeamInvite"};function Ki(xe,he){return us[xe.scene]+"-"+(xe.to===he?xe.from:xe.to)}function vf(xe,he){return xe.from===he?xe.to===he?"in":"out":"in"}function lc(xe,he){var Ve=he.account,ze=he.featureValue,_e=he.statusValue,At=he.sessionAck,ar=he.msgReceiptTime,Dt=us[xe.scene],vr=xe.to===Ve?xe.from:xe.to,Cr=wi.default,Ar=Va.unread;Uo(xe.isInBlackList)>0?(Ar=Va.refused,delete xe.isInBlackList):Ar=xe.from===Ve?ar&&ar>=+xe.time?Va.receipt:Va.sent:At&&At>=+xe.time?Va.read:Va.unread;var $r=zr(zr({},_i(Wh,xe)),{scene:Dt,type:Nc[xe.type],fromClientType:hu[xe.fromClientType],flow:vf(xe,Ve),target:vr,to:xe.to,from:xe.from,time:xe.time?+xe.time:void 0,userUpdateTime:xe.userUpdateTime?+xe.userUpdateTime:void 0,idClient:xe.idClient,sessionId:Dt+"-"+vr,status:Va[_e||Ar],feature:wi[ze||Cr]});if(typeof $r.attach=="string")try{$r.attach=JSON.parse($r.attach)}catch{}return $r.type==="notification"&&($r.attach=$r.attach?function(Hr){var Kr,Sn={};if(Sn.type=tl[Hr.id]||Hr.id,!Hr.data)return Sn;var Cn,Pn={ids:"accounts",id:"account",attach:"custom",channel:"channelId",calltype:"netcallType",mute:"mute",duration:"duration",time:"time",from:"from",ext:"ext"},En=Hr.data;return Qn(Kr=la(Pn)).call(Kr,function(Nn){En[Nn]!==void 0&&(Sn[Pn[Nn]]=En[Nn])}),En.tinfo&&(Sn.team=el(nc(En.tinfo,As.team))),En.uinfos&&(Sn.users=Fo(Cn=En.uinfos).call(Cn,function(Nn){return yu(nc(Nn,bu.user))})),En.mute!==void 0&&(Sn.mute=Uo(En.mute)===1),Sn}($r.attach):{}),$r}function Zd(xe,he){return xe&&xe.length>0?Su(Fo(xe).call(xe,function(Ve){return lc(Ve,he)})):[]}function Su(xe){for(var he,Ve,ze={},_e=UT(xe);!(Ve=_e()).done;){var At=Ve.value,ar=ze[At.idClient];ar&&ar.time>At.time||(ze[At.idClient]=At)}return Fo(he=la(ze)).call(he,function(Dt){return ze[Dt]})}function Vl(xe,he){he===void 0&&(he=!0);var Ve=zr({},xe);if(Ve.pushInfo&&he){for(var ze in Ve.pushInfo)typeof Ve.pushInfo[ze]=="boolean"?Ve[ze]=Ve.pushInfo[ze]?1:0:Ve[ze]=Ve.pushInfo[ze];delete Ve.pushInfo}return Ve.scene===us.team&&Ve.needForcePush&&(Ve.forcePushContent=Ve.forcePushContent||Ve.pushContent,Ve.forcePushIDsList=Ve.forcePushIDsList?Ve.forcePushIDsList:"#%@all@%#"),Ve}function ep(xe,he){return Fo(xe).call(xe,function(Ve){var ze;return ze=he||(RT(Uo(Ve.scene))?Ve.scene:Uo(Ve.scene)===1?"p2p":"team"),{deletedTime:Uo(Ve.time),from:Ve.from,idClient:Ve.deletedIdClient||Ve.idClient,idServer:Ve.deletedIdServer||Ve.idServer,scene:ze,time:Uo(Ve.time),to:Ve.to}})}var Gh=Array.prototype.reverse,ya=function(he){return he==null?he:Gh.call(he)},da=function(){function xe(he){this.core=he}return xe.prototype.processBroadcastMsg=function(Ve){var ze=Fo(Ve).call(Ve,function(_e){return zr(zr({},_e),{time:Uo(_e.time)})});return this.core.sendCmd("batchMarkRead",{sid:7,cid:17,ids:Fo(ze).call(ze,function(_e){return _e.id})}),ze},xe}(),Kh={needPush:{type:"boolean",required:!1},needPushBadge:{type:"boolean",required:!1},needPushNick:{type:"boolean",required:!1},pushContent:{type:"string",allowEmpty:!1,required:!1},pushPayload:{type:"string",allowEmpty:!1,required:!1}},Qy={pushContent:8,pushPayload:9,needPush:107,needPushBadge:109,needPushNick:110},ms={"4_4":"syncOfflineMsgs","4_9":"syncRoamingMsgs","4_17":"syncRoamingMsgs","4_21":"syncDeleteSelfMsgs","7_1":"sendMsg","8_23":"getHistoryTeamMsgs","21_14":"getHistorySuperTeamMsgs","8_2":"sendTeamMsg","21_2":"sendSuperTeamMsg","7_11":"sendMsgReceipt","7_13":"recallMsg","7_24":"deleteSelfMsgs","21_17":"recallSuperTeamMsg","7_2":"onMsg","8_3":"onMsg","21_3":"onMsg","7_101":"onMsg","8_102":"onMsg","21_102":"onMsg","8_4":"nimOnTeamMsgs","4_16":"syncBroadcastMsg","7_17":"onBroadcastMsg","7_123":"onDeleteSelfMsg","7_124":"onDeleteSelfMsgs"},is=zr({scene:0,to:1,from:2,fromClientType:4,fromDeviceId:5,fromNick:6,time:7,type:8,body:9,attach:10,idClient:11,idServer:12,resendFlag:13,userUpdateTime:14,ext:15,needAntiSpam:21,antiSpamContent:22,antiSpamBIZID:23,clientAntispamHitting:24,antiSpamUsingYidun:25,needACK:26,yidunCallbackURL:27,needUpdateSession:28,replyMsgFromAccount:29,replyMsgToAccount:30,replyMsgTime:31,replyMsgIdServer:32,replyMsgIdClient:33,threadMsgFromAccount:34,threadMsgToAccount:35,threadMsgTime:36,threadMsgIdServer:37,threadMsgIdClient:38,isDeleted:39,callbackExt:40,subType:41,yidunAntiCheating:42,envConfig:43,yidunAntiSpamExtension:44,yidunAntiSpamResult:45,needSaveHistory:100,needRoaming:101,needSelfSync:102,isMuted:104,needRouted:105,isInBlackList:106,needOffline:108,isReplyMsg:111,ackSnapshot:112},{pushContent:17,pushPayload:16,forcePushIDsList:18,forcePushContent:19,needForcePush:20,needPush:107,needPushBadge:109,needPushNick:110}),rl={msg:is,recallMsgTag:zr({time:0,type:1,to:2,from:3,ps:4,attach:5,deletedIdClient:10,deletedIdServer:11,opeAccount:16,env:21},Qy),deleteSelfMsgTag:{scene:1,from:2,to:3,idServer:4,idClient:5,time:6,deletedTime:7,ext:8},msgReceiptTag:{to:1,from:2,time:7,idClient:11},broadcastMsg:{id:1,fromAccid:2,time:4,body:5}},Ns=Is(rl),VT={sendMsg:{sid:7,cid:1,service:"msg",params:[{type:"Property",name:"msg",reflectMapper:rl.msg}],response:[{type:"Property",name:"msg",reflectMapper:Ns.msg}],ignoreErrCodes:[7101]},sendTeamMsg:{sid:8,cid:2,service:"msg",params:[{type:"Property",name:"msg",reflectMapper:rl.msg}],response:[{type:"Property",name:"msg",reflectMapper:Ns.msg}]},sendSuperTeamMsg:{sid:21,cid:2,service:"msg",params:[{type:"Property",name:"msg",reflectMapper:rl.msg}],response:[{type:"Property",name:"msg",reflectMapper:Ns.msg}]},onMsg:{sid:7,cid:2,service:"msg",response:[{type:"Property",name:"msg",reflectMapper:Ns.msg}]},nimOnTeamMsgs:{sid:8,cid:4,service:"msg",response:[{type:"PropertyArray",name:"datas",reflectMapper:Ns.msg}]},getHistoryTeamMsgs:{sid:8,cid:23,service:"msg",params:[{type:"Long",name:"to"},{type:"Long",name:"beginTime"},{type:"Long",name:"endTime"},{type:"Long",name:"lastMsgId"},{type:"int",name:"limit"},{type:"bool",name:"reverse"},{type:"LongArray",name:"msgTypes"}],response:[{type:"PropertyArray",name:"msgs",reflectMapper:Ns.msg}]},getHistorySuperTeamMsgs:{sid:21,cid:14,params:[{type:"Long",name:"to"},{type:"Long",name:"beginTime"},{type:"Long",name:"endTime"},{type:"Long",name:"lastMsgId"},{type:"int",name:"limit"},{type:"bool",name:"reverse"},{type:"LongArray",name:"msgTypes"}],response:[{type:"PropertyArray",name:"msgs",reflectMapper:Ns.msg}],service:"msg"},recallMsg:{sid:7,cid:13,service:"msg",params:[{type:"Property",name:"recallMsgTag",reflectMapper:rl.recallMsgTag}]},deleteSelfMsgs:{sid:7,cid:24,service:"msg",params:[{type:"PropertyArray",name:"deletedMsgs",reflectMapper:rl.deleteSelfMsgTag}],response:[{type:"Long",name:"timetag"}]},recallSuperTeamMsg:{sid:21,cid:17,service:"msg",params:[{type:"Property",name:"recallMsgTag",reflectMapper:rl.recallMsgTag}]},sendMsgReceipt:{sid:7,cid:11,service:"msg",params:[{type:"Property",name:"msgReceiptTag",reflectMapper:rl.msgReceiptTag}],response:[{type:"Property",name:"msgReceiptTag",reflectMapper:Ns.msgReceiptTag}]},batchMarkRead:{sid:4,cid:5,service:"msg",isNoResponse:!0,params:[{type:"byte",name:"sid"},{type:"byte",name:"cid"},{type:"LongArray",name:"ids"}]},syncMsgReceipts:{sid:4,cid:12,service:"msg",response:[{type:"PropertyArray",name:"msgReceipts",reflectMapper:Ns.msgReceiptTag},{type:"Number",name:"timetag"}]},syncOfflineMsgs:{sid:4,cid:4,service:"msg",response:[{type:"PropertyArray",name:"msgs",reflectMapper:Ns.msg}]},syncRoamingMsgs:{sid:4,cid:9,service:"msg",response:[{type:"PropertyArray",name:"msgs",reflectMapper:Ns.msg}]},syncBroadcastMsg:{sid:4,cid:16,service:"msg",response:[{type:"PropertyArray",name:"msgs",reflectMapper:Ns.broadcastMsg}]},onBroadcastMsg:{sid:7,cid:17,service:"msg",response:[{type:"Property",name:"msg",reflectMapper:Ns.broadcastMsg}]},onDeleteSelfMsg:{sid:7,cid:123,service:"msg",response:[{type:"Property",name:"deletedMsg",reflectMapper:Ns.deleteSelfMsgTag}]},onDeleteSelfMsgs:{sid:7,cid:124,service:"msg",response:[{type:"PropertyArray",name:"deletedMsgs",reflectMapper:Ns.deleteSelfMsgTag}]},syncDeleteSelfMsgs:{sid:4,cid:21,service:"msg",response:[{type:"PropertyArray",name:"deletedMsgs",reflectMapper:Ns.deleteSelfMsgTag}]}},Jy=function(xe){function he(ze){var _e;return(_e=xe.call(this,"msg",ze)||this).service=new da(ze),ps({cmdMap:ms,cmdConfig:VT}),_e}ea(he,xe);var Ve=he.prototype;return Ve.sendTextMsg=function(_e){return Jn({body:{type:"string",allowEmpty:!1}},_e),this.sendMsg(zr(zr({},_e),{type:"text"}))},Ve.sendTipMsg=function(_e){return Jn({body:{type:"string",allowEmpty:!1}},_e),this.sendMsg(zr(zr({},_e),{type:"tip"}))},Ve.sendGeoLocationMsg=function(_e){return Jn({attach:{type:"object",rules:{title:{type:"string",allowEmpty:!1},lat:{type:"number"},lng:{type:"number"}}}},_e),this.sendMsg(zr(zr({},_e),{type:"geo",attach:fa(_e.attach)}))},Ve.sendCustomMsg=function(_e){return Jn({attach:{type:"string",allowEmpty:!1}},_e),this.sendMsg(zr(zr({},_e),{type:"custom"}))},Ve.sendMsg=function(_e){var At,ar,Dt=this;!((At=this.core.sync)===null||At===void 0)&&At.getSyncDoneFlag()||this.logger.warn("Please send message after syncdone event"),Jn({scene:{type:"enum",values:Wi(us)},type:{type:"enum",values:Wi(Nc)},to:{type:"string",allowEmpty:!1},ext:{type:"string",required:!1},setting:{type:"object",rules:{resendFlag:{type:"boolean",required:!1},needSaveHistory:{type:"boolean",required:!1},needRoaming:{type:"boolean",required:!1},needOffline:{type:"boolean",required:!1},needSelfSync:{type:"boolean",required:!1},needRouted:{type:"boolean",required:!1},needUpdateSession:{type:"boolean",required:!1}},required:!1},antiSpamInfo:{type:"object",required:!1,rules:{clientAntispamHitting:{type:"boolean",required:!1},antiSpamUsingYidun:{type:"boolean",required:!1}}},pushInfo:{type:"object",required:!1,rules:Gy},teamSpecializationInfo:{type:"object",required:!1,rules:{needACK:{type:"boolean",required:!1}}}},_e);var vr,Cr=_e.scene==="p2p"?"sendMsg":_e.scene==="team"?"sendTeamMsg":"sendSuperTeamMsg",Ar=function(Hr,Kr,Sn,Cn){Hr.onSendBefore,Hr.onUploadStart,Hr.onUploadDone;var Pn=Hr.replyMsg,En=ri(Hr,["onSendBefore","onUploadStart","onUploadDone","replyMsg"]),Nn=zr(zr({},Kd(Wh,En)),{scene:us[Hr.scene],type:Nc[Hr.type],from:Kr,fromClientType:16,fromDeviceId:Sn,fromNick:Cn==null?void 0:Cn.nick,userUpdateTime:Cn==null?void 0:Cn.updateTime,status:Va[Va.sending]});if(Nn.idClient=Nn.resendFlag?Hr.idClient:ef(),!Nn.idClient)throw new Gg("idClient is required to resend a message","idClient","required");return Nn=Vl(Nn,!1),Pn&&(Nn.replyMsgFromAccount=Pn.from,Nn.replyMsgToAccount=Pn.to,Nn.replyMsgTime=+Pn.time,Nn.replyMsgIdServer=Pn.idServer,Nn.replyMsgIdClient=Pn.idClient,Nn.threadMsgFromAccount=Pn.from,Nn.threadMsgToAccount=Pn.to,Nn.threadMsgTime=+Pn.time,Nn.threadMsgIdServer=Pn.idServer,Nn.threadMsgIdClient=Pn.idClient,Pn.threadMessageInfo&&Pn.threadMessageInfo.threadMsgIdServer&&(Nn.threadMsgFromAccount=Pn.threadMessageInfo.threadMsgFromAccount,Nn.threadMsgToAccount=Pn.threadMessageInfo.threadMsgToAccount,Nn.threadMsgTime=Pn.threadMessageInfo.threadMsgTime,Nn.threadMsgIdServer=Pn.threadMessageInfo.threadMsgIdServer,Nn.threadMsgIdClient=Pn.threadMessageInfo.threadMsgIdClient)),Nn}(_e,this.core.account,this.core.config.deviceId,(ar=this.core.user)===null||ar===void 0?void 0:ar.myInfo),$r=lc(zr(zr({},Ar),{time:new Date().getTime()}),{account:this.core.account,featureValue:wi.default,statusValue:Va.sending});try{_e.onSendBefore&&_e.onSendBefore($r)}catch(jr){this.logger.error("sendMsg: options.onSendBefore error",jr)}return this.core.eventBus.emit("session/updateForNewMsg",$r),this.core.sendCmd(Cr,{msg:Ar}).then(function(jr){var Hr=jr.content,Kr=jr.error;if(vr=Hr.msg,Kr)throw Kr;var Sn=lc(zr(zr({},Ar),Hr.msg),{account:Dt.core.account,featureValue:wi.default,statusValue:Va.sent});return Sn.from===Sn.to&&Dt.markMsgsAck([Sn]),Dt.core.eventBus.emit("session/updateForNewMsg",Sn),Dt.core.reporter.report("msgSend",{msgId:Sn.idServer,clientId:Sn.idClient,msgTime:Sn.time,fromAccid:_e.scene==="p2p"?Dt.core.account:"",toAccid:Sn.to,type:us[Sn.scene],roomId:"",tid:_e.scene==="p2p"?"":Sn.to,result:200,faiReason:"",rt:Ia()-$r.time}),Sn}).catch(function(jr){var Hr=lc(zr(zr(zr({},Ar),{time:new Date().getTime()}),vr),{account:Dt.core.account,featureValue:wi.default,statusValue:jr.code===7101?Va.refused:Va.sendFailed});throw jr.msg=Hr,Dt.core.eventBus.emit("session/updateForNewMsg",Hr),Dt.core.reporter.report("msgSend",{msgId:Hr.idServer,clientId:Hr.idClient,msgTime:Hr.time,fromAccid:_e.scene==="p2p"?Dt.core.account:"",toAccid:Hr.to,type:us[Hr.scene],roomId:"",tid:_e.scene==="p2p"?"":Hr.to,result:jr==null?void 0:jr.code,faiReason:(jr==null?void 0:jr.message)||"",rt:Ia()-$r.time}),jr})},Ve.resendMsg=function(_e){return qn(this,void 0,void 0,_r.mark(function At(){var ar,Dt;return _r.wrap(function(Cr){for(;;)switch(Cr.prev=Cr.next){case 0:if(Jn({msg:{type:"object",rules:{idClient:{type:"string",allowEmpty:!1}}}},_e),ar=_e.msg,Dt=zr(zr({},ar),{attach:ar.attach?fa(ar.attach):void 0,setting:{resendFlag:!0}}),ar.from===this.core.account){Cr.next=5;break}throw new Error("You can only resend messages that you sent: "+ar.idClient);case 5:return Cr.abrupt("return",this.sendMsg(Dt));case 6:case"end":return Cr.stop()}},At,this)}))},Ve.forwardMsg=function(_e){return qn(this,void 0,void 0,_r.mark(function At(){var ar,Dt;return _r.wrap(function(Cr){for(;;)switch(Cr.prev=Cr.next){case 0:return Jn({msg:{type:"object",rules:{idClient:{type:"string",allowEmpty:!1}}},scene:{type:"enum",values:Wi(us)},to:{type:"string",allowEmpty:!1}},_e),ar=_e.msg,Dt=zr(zr({},ar),{scene:_e.scene,to:_e.to,attach:ar.attach?fa(ar.attach):void 0}),Cr.abrupt("return",this.sendMsg(Dt));case 4:case"end":return Cr.stop()}},At,this)}))},Ve.sendImageMsg=function(_e){return this.doSendFile(zr(zr({},_e),{type:"image"}))},Ve.sendFileMsg=function(_e){return this.doSendFile(zr(zr({},_e),{type:"file"}))},Ve.sendAudioMsg=function(_e){return this.doSendFile(zr(zr({},_e),{type:"audio"}))},Ve.sendVideoMsg=function(_e){return this.doSendFile(zr(zr({},_e),{type:"video"}))},Ve.doSendFile=function(_e){return qn(this,void 0,void 0,_r.mark(function At(){var ar,Dt;return _r.wrap(function(Cr){for(;;)switch(Cr.prev=Cr.next){case 0:if(Jn({scene:{type:"enum",values:Wi(us)},to:{type:"string",allowEmpty:!1},type:{type:"string",allowEmpty:!1},attach:{type:"object",rules:{url:{type:"string",allowEmpty:!1}},required:!1},maxSize:{type:"number",min:1,required:!1}},_e),ar=_e.attach){Cr.next=28;break}if(this.core.cloudStorage&&this.core.cloudStorage.uploadFile){Cr.next=5;break}throw new Error('Service "cloudStorage" does not exist');case 5:return Cr.prev=5,this.core.reporter.reportTraceStart("nos",{user_id:this.core.account,action:"upload"}),Cr.next=9,this.core.cloudStorage.uploadFile(_e);case 9:ar=Cr.sent,this.core.reporter.reportTraceEnd("nos",!0),Cr.next=20;break;case 13:throw Cr.prev=13,Cr.t0=Cr.catch(5),Dt=Cr.t0,this.core.reporter.reportTraceUpdateV2("nos",{operation_type:"transfer",description:Dt.message,code:Dt.code||0,target:"",succeed:!1}),this.core.reporter.reportTraceEnd("nos",!1),this.logger.error("sendFile:: upload File error or abort",Cr.t0),Cr.t0;case 20:Cr.prev=20,_e.onUploadDone&&_e.onUploadDone(ar),Cr.next=28;break;case 24:throw Cr.prev=24,Cr.t1=Cr.catch(20),this.logger.error("sendFile options.onUploadDone err",Cr.t1),Cr.t1;case 28:return Cr.abrupt("return",this.sendMsg(zr(zr({},_e),{attach:fa(ar),type:_e.type})));case 29:case"end":return Cr.stop()}},At,this,[[5,13],[20,24]])}))},Ve.recallMsg=function(_e){var At;return qn(this,void 0,void 0,_r.mark(function ar(){var Dt,vr,Cr;return _r.wrap(function($r){for(;;)switch($r.prev=$r.next){case 0:return!((At=this.core.sync)===null||At===void 0)&&At.getSyncDoneFlag()||this.logger.warn("Please call recallMsg after syncdone event"),Jn({msg:{type:"object",rules:{idClient:{type:"string",allowEmpty:!1},idServer:{type:"string",allowEmpty:!1},scene:{type:"enum",values:Wi(us)},time:{type:"number"}}},pushInfo:{type:"object",required:!1,rules:Kh},ps:{type:"string",allowEmpty:!1,required:!1}},_e),Dt=_e.msg,vr={p2p:"recallMsg",team:"recallMsg",superTeam:"recallSuperTeamMsg"},Cr={p2p:7,team:8,superTeam:12},$r.next=7,this.core.sendCmd(vr[Dt.scene],{recallMsgTag:Vl({time:Dt.time,type:Cr[Dt.scene],to:Dt.to,from:Dt.from,ps:_e.ps,attach:_e.attach,deletedIdClient:Dt.idClient,deletedIdServer:Dt.idServer,opeAccount:Dt.from,env:_e.env,pushInfo:_e.pushInfo})});case 7:return this.core.eventBus.emit("session/updateForDeletedMsg",ep([Dt])),$r.abrupt("return",Dt);case 9:case"end":return $r.stop()}},ar,this)}))},Ve.deleteSelfMsgs=function(_e){var At;return qn(this,void 0,void 0,_r.mark(function ar(){var Dt,vr,Cr;return _r.wrap(function($r){for(;;)switch($r.prev=$r.next){case 0:return!((At=this.core.sync)===null||At===void 0)&&At.getSyncDoneFlag()||this.logger.warn("Please call deleteSelfMsgs after syncdone event"),Jn({msgs:{type:"array",rules:{scene:{type:"enum",values:["p2p","team"]},from:{type:"string",allowEmpty:!1},to:{type:"string",allowEmpty:!1},idServer:{type:"string",allowEmpty:!1},idClient:{type:"string",allowEmpty:!1},time:{type:"number",allowEmpty:!1}}},ext:{type:"string",allowEmpty:!1,required:!1}},_e),Dt=_e.msgs,vr=Fo(Dt).call(Dt,function(jr){return{scene:jr.scene==="p2p"?1:2,from:jr.from,to:jr.to,idServer:jr.idServer,idClient:jr.idClient,time:jr.time,ext:_e.ext}}),$r.next=6,this.core.sendCmd("deleteSelfMsgs",{deletedMsgs:vr});case 6:return Cr=ep(vr),this.core.eventBus.emit("session/updateForDeletedMsg",Cr),$r.abrupt("return",Cr);case 9:case"end":return $r.stop()}},ar,this)}))},Ve.sendMsgReceipt=function(_e){var At,ar,Dt;return qn(this,void 0,void 0,_r.mark(function vr(){var Cr,Ar,$r,jr;return _r.wrap(function(Kr){for(;;)switch(Kr.prev=Kr.next){case 0:if(!((At=this.core.sync)===null||At===void 0)&&At.getSyncDoneFlag()||this.logger.warn("Please call sendMsgReceipt after syncdone event"),Jn({msg:{type:"object",rules:{idClient:{type:"string",allowEmpty:!1},target:{type:"string",allowEmpty:!1},time:{type:"number"}}}},_e),(Cr=_e.msg).scene==="p2p"&&Cr.flow==="in"){Kr.next=6;break}return this.logger.warn("Msg scene: "+Cr.scene+", flow: "+Cr.flow+" is not allowed to send msg receipt"),Kr.abrupt("return",void 0);case 6:return Ar={to:Cr.target,idClient:Cr.idClient,time:Cr.time},Kr.next=9,this.core.sendCmd("sendMsgReceipt",{msgReceiptTag:Ar});case 9:return $r=Kr.sent,jr=Uo((Dt=(ar=$r.content)===null||ar===void 0?void 0:ar.msgReceiptTag)===null||Dt===void 0?void 0:Dt.time),Kr.abrupt("return",zr(zr({},Ar),{time:jr?Math.min(jr,Ar.time):Ar.time}));case 12:case"end":return Kr.stop()}},vr,this)}))},Ve.sendTeamMsgReceipt=function(_e){var At;return qn(this,void 0,void 0,_r.mark(function ar(){var Dt;return _r.wrap(function(Cr){for(;;)switch(Cr.prev=Cr.next){case 0:return!((At=this.core.sync)===null||At===void 0)&&At.getSyncDoneFlag()||this.logger.warn("Please call sendTeamMsgReceipt after syncdone event"),Jn({teamMsgReceipts:{type:"array",rules:{teamId:{type:"string",allowEmpty:!1},idClient:{type:"string",allowEmpty:!1},idServer:{type:"string",allowEmpty:!1}},max:50}},_e),Dt=_e.teamMsgReceipts,this.core.sendCmd("sendTeamMsgReceipt",{teamMsgReceipts:Dt}),Cr.abrupt("return",void 0);case 5:case"end":return Cr.stop()}},ar,this)}))},Ve.getTeamMsgReads=function(_e){var At;return qn(this,void 0,void 0,_r.mark(function ar(){var Dt,vr,Cr;return _r.wrap(function($r){for(;;)switch($r.prev=$r.next){case 0:return Jn({teamMsgReceipts:{type:"array",rules:{teamId:{type:"string",allowEmpty:!1},idClient:{type:"string",allowEmpty:!1},idServer:{type:"string",allowEmpty:!1}}}},_e),Dt=_e.teamMsgReceipts,$r.next=4,this.core.sendCmd("getTeamMsgReads",{teamMsgReceipts:Dt});case 4:return vr=$r.sent,Cr=(Cr=(At=vr.content)===null||At===void 0?void 0:At.teamMsgReceipts)?Fo(Cr).call(Cr,function(jr){return zr(zr({},jr),{read:Uo(jr.read),unread:Uo(jr.unread)})}):[],$r.abrupt("return",Cr);case 8:case"end":return $r.stop()}},ar,this)}))},Ve.getTeamMsgReadAccounts=function(_e){return qn(this,void 0,void 0,_r.mark(function At(){var ar,Dt;return _r.wrap(function(Cr){for(;;)switch(Cr.prev=Cr.next){case 0:return Jn({teamMsgReceipt:{type:"object",rules:{teamId:{type:"string",allowEmpty:!1},idClient:{type:"string",allowEmpty:!1},idServer:{type:"string",allowEmpty:!1}}}},_e),ar=_e.teamMsgReceipt,Cr.next=4,this.core.sendCmd("getTeamMsgReadAccounts",{teamMsgReceiptTag:ar});case 4:return Dt=Cr.sent,Cr.abrupt("return",Dt.content);case 6:case"end":return Cr.stop()}},At,this)}))},Ve.markMsgsAck=function(_e){if(_e&&_e.length>0){var At=[],ar=[];Qn(_e).call(_e,function(Dt){Dt.scene==="p2p"&&Dt.flow==="in"?At.push(Dt):Dt.scene==="team"&&Dt.flow==="in"&&ar.push(Dt)}),At.length>0&&this.core.sendCmd("batchMarkRead",{sid:7,cid:2,ids:Fo(At).call(At,function(Dt){return Dt.idServer})}),ar.length>0&&this.core.sendCmd("batchMarkRead",{sid:8,cid:3,ids:Fo(ar).call(ar,function(Dt){return Dt.idServer})})}},Ve.onMsgHandler=function(_e){var At;if(_e.error)this.logger.error("msgHandler::recvError",_e.error);else{var ar=typeof oi(_e,"raw.r[0]")=="number"?""+_e.raw.r[0]:void 0,Dt=_e.content.msg;Dt.idServer=Dt.idServer||ar;var vr=Ia(),Cr=Ki(Dt,this.core.account),Ar=(At=this.core.session)===null||At===void 0?void 0:At.getSessionWithUncomplete({id:Cr}),$r=lc(Dt,Ar?{account:this.core.account,sessionAck:Ar.ack,msgReceiptTime:Ar.msgReceiptTime}:{account:this.core.account});if(this.core.options.debugLevel==="debug"?this.logger.debug("msgHandler::recvMsg",$r.idClient,$r.idServer,$r):this.logger.log("msgHandler::recvMsg",$r.idClient,$r.idServer),this.markMsgsAck([$r]),this.core.eventBus.emit("session/updateForNewMsg",$r),this.core.emit("msg",$r),$r.type==="notification")this.core.eventBus.emit("team/onNotification",$r);else if($r.flow!=="out"){var jr=$r.scene==="p2p",Hr={msgId:$r.idServer,clientId:$r.idClient,receiveTime:_e.__receiveTime,serverTime:$r.time,callbackTime:Ia(),preHandleTime:vr,fromAccid:$r.from,toAccid:this.core.account,type:us[$r.scene],tid:jr?"":$r.to,result:200,failReason:"",rt:Ia()-$r.time};this.core.reporter.report("msgReceive",Hr,!0)}}},Ve.nimOnTeamMsgsHandler=function(_e){var At,ar=this;Qn(At=_e.content.datas).call(At,function(Dt){ar.onMsgHandler(zr({},_e,{content:{msg:Dt}}))})},Ve.syncRoamingMsgsHandler=function(_e){var At,ar,Dt=_e.content.msgs||[];if(Dt.length!==0){var vr=Ki(Dt[0],this.core.account),Cr=(At=this.core.session)===null||At===void 0?void 0:At.getSessionWithUncomplete({id:vr}),Ar=(Dt=Zd(Dt,Cr?{account:this.core.account,featureValue:wi.roam,sessionAck:Cr.ack,msgReceiptTime:Cr.msgReceiptTime}:{account:this.core.account,featureValue:wi.roam}))[0].time,$r={timetag:Ar,sessionId:vr,msgs:ya(Dt)};!((ar=this.core.sync)===null||ar===void 0)&&ar.getSyncDoneFlag()||this.core.eventBus.emit("session/syncMsgs",$r),this.core.emit("syncRoamingMsgs",$r),this.core.eventBus.emit("sync/updateTimetag",{roamingMsgs:Ar})}},Ve.syncOfflineMsgsHandler=function(_e){var At,ar=this,Dt=_e.content.msgs||[];if(Dt.length!==0){var vr={},Cr=[];Qn(Dt).call(Dt,function($r){var jr=Ki($r,ar.core.account),Hr=ar.core.session.getSessionWithUncomplete({id:jr}),Kr=lc($r,Hr?{account:ar.core.account,featureValue:wi.leave,sessionAck:Hr.ack,msgReceiptTime:Hr.msgReceiptTime}:{account:ar.core.account,featureValue:wi.leave});Cr.push(Kr),vr[Kr.sessionId]?vr[Kr.sessionId].push(Kr):vr[Kr.sessionId]=[Kr]}),this.markMsgsAck(Cr);var Ar=0;Qn(At=la(vr)).call(At,function($r){var jr,Hr=Zc(jr=vr[$r]).call(jr,function(Sn,Cn){return Cn.time-Sn.time});(Hr=Su(Hr))[0].time>Ar&&(Ar=Hr[0].time);var Kr={timetag:Hr[0].time,sessionId:$r,msgs:Hr};ar.core.eventBus.emit("session/syncMsgs",Kr),ar.core.emit("syncOfflineMsgs",Kr)}),this.core.eventBus.emit("sync/updateTimetag",{offlineMsgs:Ar})}},Ve.syncDeleteSelfMsgsHandler=function(_e){var At,ar=(At=_e.content)===null||At===void 0?void 0:At.deletedMsgs;ar&&ar.length>0||this.logger.warn("syncDeleteSelfMsgs:: no msgs");var Dt=ar[ar.length-1].time;this.core.eventBus.emit("sync/updateTimetag",{deleteSelfMsgs:Dt})},Ve.onDeleteSelfMsgHandler=function(_e){var At=ep([_e.content.deletedMsg]);this.core.eventBus.emit("session/updateForDeletedMsg",At),this.core.emit("deleteSelfMsgs",At)},Ve.onDeleteSelfMsgsHandler=function(_e){var At=ep(_e.content.deletedMsgs);this.core.eventBus.emit("session/updateForDeletedMsg",At),this.core.emit("deleteSelfMsgs",At)},Ve.onBroadcastMsgHandler=function(_e){var At=_e.content.msg,ar=this.service.processBroadcastMsg([At]);this.core.emit("broadcastMsgs",ar)},Ve.syncBroadcastMsgHandler=function(_e){var At=_e.content.msgs,ar=this.service.processBroadcastMsg(At);this.core.emit("broadcastMsgs",ar)},he}(Ps),qT={"5_1":"sync"},HT={sync:{sid:5,cid:1,service:"sync",isNoResponse:!0,params:[{type:"Property",name:"sync",reflectMapper:{myInfo:1,offlineMsgs:2,teams:3,roamingMsgs:7,relations:9,friends:11,friendUsers:13,msgReceipts:14,myTeamMembers:15,donnop:16,recallMsg:17,sessionAck:18,broadcastMsgs:20,signaling:21,superTeams:22,mySuperTeamMembers:23,superTeamRoamingMsgs:24,deleteSuperTeamMsg:25,superTeamSessionAck:26,deleteSelfMsgs:27,stickTopSessions:28,sessionHistoryMsgsDelete:29}}],response:[{type:"Number",name:"timetag"}]}},yf=function(xe){function he(ze,_e){var At;return _e===void 0&&(_e={}),(At=xe.call(this,"sync",ze)||this).options=_e,At.syncDoneFlag=!1,At.options=zr({myInfo:!!ze.user.name,offlineMsgs:!!ze.msg.name,teams:!!ze.team.name,myTeamMembers:!!ze.team.name,roamingMsgs:!!ze.msg.name,relations:!!ze.user.name,friends:!!ze.friend.name,friendUsers:!!ze.user.name,msgReceipts:!!ze.msg.name,recallMsg:!!ze.msg.name,sessionAck:!!ze.session.name,superTeamSessionAck:!!ze.session.name,superTeams:!!ze.superTeam.name,mySuperTeamMembers:!!ze.superTeam.name,superTeamRoamingMsgs:!!ze.superTeam.name,deleteSuperTeamMsg:!!ze.superTeam.name,deleteSelfMsgs:!!ze.msg.name,sessionHistoryMsgsDelete:!!ze.msgLog.name,signaling:!!ze.signaling.name},_e),At.timetags={},At.pArray=[],At.initEventListeners(),ps({cmdMap:qT,cmdConfig:HT}),At}ea(he,xe);var Ve=he.prototype;return Ve.getSyncDoneFlag=function(){return this.syncDoneFlag},Ve.doSync=function(){return qn(this,void 0,void 0,_r.mark(function _e(){var At;return _r.wrap(function(Dt){for(;;)switch(Dt.prev=Dt.next){case 0:return At=this.genSyncParams(),this.logger.log("doSync: ",At),Dt.next=4,this.core.sendCmd("sync",{sync:At});case 4:case"end":return Dt.stop()}},_e,this)}))},Ve.initEventListeners=function(){var _e=this;this.core.eventBus.on("sync/updateTimetag",function(At){var ar;Qn(ar=la(At)).call(ar,function(Dt){At[Dt]>(_e.timetags[Dt]||0)&&(_e.timetags[Dt]=At[Dt])})}),this.core.eventBus.on("logined",function(){_e.syncDoneFlag=!1})},Ve.genSyncParams=function(){var _e,At,ar=this;return Op(_e=Bs(At=la(this.options)).call(At,function(Dt){var vr=Dt;return ar.options[vr]})).call(_e,function(Dt,vr){var Cr=vr;return Dt[Cr]=ar.timetags[Cr]||0,Dt},{})},Ve.handleImmediate=function(_e){var At;this.core.session&&this.core.session.onSyncDone&&this.core.session.onSyncDone(),this.logger.log("sync: emit syncdone",(At=_e.content)===null||At===void 0?void 0:At.timetag),this.syncDoneFlag=!0,this.core.emit("syncdone")},Ve.syncHandler=function(_e){var At=this;(function(){return typeof tt<"u"&&tt.getSystemInfo?"TT":typeof swan<"u"&&swan.getSystemInfo?"BAIDU":typeof my<"u"&&my.getSystemInfo?"ALI":typeof wx<"u"&&wx.getSystemInfo?"WX":"unknow environment"})()==="ALI"?(this.logger.log("sync: emit ALIAPP sycnHandler, handle later"),Ro(function(){At.handleImmediate(_e)},100)):this.handleImmediate(_e)},he}(Ps),qa={"6_26":"getNosCdnHost"},Yy={getNosCdnHost:{sid:6,cid:26,service:"misc",response:[{type:"Property",name:"nosConfigTag",reflectMapper:Is({nosConfigTag:{bucket:1,cdnDomain:2,expire:3,objectNamePrefix:4}}).nosConfigTag}]}},zT=function(xe){function he(Ve){var ze;return(ze=xe.call(this,"misc",Ve)||this).core=Ve,ze.nosCdnHostTimer=0,ps({cmdMap:qa,cmdConfig:Yy}),ze}return ea(he,xe),he}(Ps),Tu=function(he,Ve,ze){Ve=="__proto__"&&Dd?Dd(he,Ve,{configurable:!0,enumerable:!0,value:ze,writable:!0}):he[Ve]=ze},Xy=Object.prototype.hasOwnProperty,bf=function(he,Ve,ze){var _e=he[Ve];Xy.call(he,Ve)&&Pc(_e,ze)&&(ze!==void 0||Ve in he)||Tu(he,Ve,ze)},Qh=function(he,Ve,ze,_e){if(!Vi(he))return he;for(var At=-1,ar=(Ve=zd(Ve,he)).length,Dt=ar-1,vr=he;vr!=null&&++At<ar;){var Cr=$l(Ve[At]),Ar=ze;if(Cr==="__proto__"||Cr==="constructor"||Cr==="prototype")return he;if(At!=Dt){var $r=vr[Cr];(Ar=_e?_e($r,Cr,vr):void 0)===void 0&&(Ar=Vi($r)?$r:mf(Ve[At+1])?[]:{})}bf(vr,Cr,Ar),vr=vr[Cr]}return he},Zy=function(he,Ve,ze){for(var _e=-1,At=Ve.length,ar={};++_e<At;){var Dt=Ve[_e],vr=Sh(he,Dt);ze(vr,Dt)&&Qh(ar,zd(Dt,he),vr)}return ar},WT=function(he,Ve){return he!=null&&Ve in Object(he)},GT=function(he,Ve,ze){for(var _e=-1,At=(Ve=zd(Ve,he)).length,ar=!1;++_e<At;){var Dt=$l(Ve[_e]);if(!(ar=he!=null&&ze(he,Dt)))break;he=he[Dt]}return ar||++_e!=At?ar:!!(At=he==null?0:he.length)&&ch(At)&&mf(Dt,At)&&(Gi(he)||Qd(he))},tp=function(he,Ve){return he!=null&&GT(he,Ve,WT)},Jh=function(he,Ve){return Zy(he,Ve,function(ze,_e){return tp(he,_e)})},Cu=function(he,Ve){for(var ze=-1,_e=Ve.length,At=he.length;++ze<_e;)he[At+ze]=Ve[ze];return he},Bc=Ci?Ci.isConcatSpreadable:void 0,KT=function(he){return Gi(he)||Qd(he)||!!(Bc&&he&&he[Bc])},nl=function xe(he,Ve,ze,_e,At){var ar=-1,Dt=he.length;for(ze||(ze=KT),At||(At=[]);++ar<Dt;){var vr=he[ar];Ve>0&&ze(vr)?Ve>1?xe(vr,Ve-1,ze,_e,At):Cu(At,vr):_e||(At[At.length]=vr)}return At},QT=function(he){return he!=null&&he.length?nl(he,1):[]},rp=function(he){return ty(zp(he,void 0,QT),he+"")}(function(xe,he){return xe==null?{}:Jh(xe,he)}),eb=function(xe){function he(ze){var _e;return(_e=xe.call(this,"user",ze)||this).myInfo=yu({}),ps({cmdMap:Wy,cmdConfig:DT}),_e}ea(he,xe);var Ve=he.prototype;return Ve.setBlack=function(_e){return Jn({account:{type:"string",allowEmpty:!1},isAdd:{type:"boolean"}},_e),this.core.sendCmd("setBlack",_e).then(function(){})},Ve.setMute=function(_e){return Jn({account:{type:"string",allowEmpty:!1},isAdd:{type:"boolean"}},_e),this.core.sendCmd("setMute",_e).then(function(){})},Ve.getRelations=function(){return this.core.sendCmd("syncRelations",{timetag:0})},Ve.getBlackList=function(){return qn(this,void 0,void 0,_r.mark(function _e(){var At;return _r.wrap(function(Dt){for(;;)switch(Dt.prev=Dt.next){case 0:return Dt.next=2,this.core.sendCmd("syncRelations",{timetag:0});case 2:return At=Dt.sent,Dt.abrupt("return",At.blackList||[]);case 4:case"end":return Dt.stop()}},_e,this)}))},Ve.getMuteList=function(){return qn(this,void 0,void 0,_r.mark(function _e(){var At;return _r.wrap(function(Dt){for(;;)switch(Dt.prev=Dt.next){case 0:return Dt.next=2,this.core.sendCmd("syncRelations",{timetag:0});case 2:return At=Dt.sent,Dt.abrupt("return",At.muteList||[]);case 4:case"end":return Dt.stop()}},_e,this)}))},Ve.updatePushToken=function(){return qn(this,void 0,void 0,_r.mark(function _e(){return _r.wrap(function(ar){for(;;)switch(ar.prev=ar.next){case 0:this.logger.error("This function is deprecated, please use nim.offlinePush.setOfflinePushConfig instead");case 1:case"end":return ar.stop()}},_e,this)}))},Ve.updateAppBackground=function(){return qn(this,void 0,void 0,_r.mark(function _e(){return _r.wrap(function(ar){for(;;)switch(ar.prev=ar.next){case 0:this.logger.error("This function is deprecated, please use nim.offlinePush.setOfflinePushConfig instead");case 1:case"end":return ar.stop()}},_e,this)}))},Ve.getUsersNameCardFromServer=function(_e){var At=this;return Jn({accounts:{type:"array",max:150,itemType:"string"}},_e),this.core.sendCmd("getUsersNameCardFromServer",rp(_e,["accounts"])).then(function(ar){var Dt,vr=ar.content;return At.logger.log("user:: getUsers done",_e.accounts),vr&&vr.users?Fo(Dt=vr.users).call(Dt,function(Cr){return yu(Cr)}):[]})},Ve.updateMyNameCard=function(_e){var At=this;if(Jn({nick:{type:"string",required:!1},avatar:{type:"string",required:!1},signature:{type:"string",required:!1},gender:{type:"enum",values:Wi(Yd),required:!1},email:{type:"string",required:!1},birth:{type:"string",required:!1},tel:{type:"string",required:!1},ext:{type:"string",required:!1}},_e),la(_e).length===0)return xo.resolve(this.myInfo);var ar=rp(_e,["nick","avatar","signature","email","birth","tel","ext"]);return _e.gender&&(ar.gender=Yd[_e.gender]),this.core.sendCmd("updateMyNameCard",{user:ar}).then(function(Dt){var vr=Dt.content;return vr&&vr.timetag&&At.core.eventBus.emit("sync/updateTimetag",{myInfo:+vr.timetag}),_e.gender&&(ar.gender=_e.gender),At.myInfo=zr({},At.myInfo,ar),At.myInfo})},Ve.onUpdateBlackListHandler=function(_e){var At=_e.content;At.account?this.core.emit("updateBlackList",At):this.logger.warn("onUpdateBlackListHandler: no account")},Ve.onUpdateMuteListHandler=function(_e){var At=_e.content;At.account?this.core.emit("updateMuteList",At):this.logger.warn("onUpdateBlackListHandler: no account")},Ve.syncRelationsHandler=function(_e){var At=_e.content,ar=At.list,Dt=At.timetag,vr={blackList:[],muteList:[]};return Dt&&this.core.eventBus.emit("sync/updateTimetag",{relations:Dt}),ar&&ar.length&&Qn(ar).call(ar,function(Cr){var Ar=function(jr){var Hr={account:jr.account,updateTime:+jr.updateTime,createTime:+jr.createTime};return jr.isMuted==="1"&&(Hr.isMuted=!0),jr.isBlack==="1"&&(Hr.isBlack=!0),Hr}(Cr);Ar.isBlack&&vr.blackList.push(Ar),Ar.isMuted&&vr.muteList.push(Ar)}),this.core.emit("relations",vr),xo.resolve(vr)},Ve.syncMyNameCardHandler=function(_e){_e.content.user&&(this.myInfo=yu(_e.content.user),this.core.emit("syncMyNameCard",this.myInfo),this.core.eventBus.emit("sync/updateTimetag",{myInfo:_e.content.timetag}))},Ve.onUpdateMyNameCardHandler=function(_e){var At=_e.content.user;At?(zr(this.myInfo,yu(At)),this.core.emit("updateMyNameCard",this.myInfo)):this.logger.warn("onUpdateMyNameCardHandler no user info")},he}(Ps),Sf=function(){this.__data__=new jp,this.size=0},Pa=function(he){var Ve=this.__data__,ze=Ve.delete(he);return this.size=Ve.size,ze},xi=function(he){return this.__data__.get(he)},ql=function(he){return this.__data__.has(he)},JT=function(he,Ve){var ze=this.__data__;if(ze instanceof jp){var _e=ze.__data__;if(!jd||_e.length<199)return _e.push([he,Ve]),this.size=++ze.size,this;ze=this.__data__=new Vp(_e)}return ze.set(he,Ve),this.size=ze.size,this};function Hl(xe){var he=this.__data__=new jp(xe);this.size=he.size}Hl.prototype.clear=Sf,Hl.prototype.delete=Pa,Hl.prototype.get=xi,Hl.prototype.has=ql,Hl.prototype.set=JT;var np=Hl,YT=function(he,Ve){for(var ze=-1,_e=he==null?0:he.length;++ze<_e;)if(Ve(he[ze],ze,he))return!0;return!1},tb=function(he,Ve,ze,_e,At,ar){var Dt=1&ze,vr=he.length,Cr=Ve.length;if(vr!=Cr&&!(Dt&&Cr>vr))return!1;var Ar=ar.get(he),$r=ar.get(Ve);if(Ar&&$r)return Ar==Ve&&$r==he;var jr=-1,Hr=!0,Kr=2&ze?new nh:void 0;for(ar.set(he,Ve),ar.set(Ve,he);++jr<vr;){var Sn=he[jr],Cn=Ve[jr];if(_e)var Pn=Dt?_e(Cn,Sn,jr,Ve,he,ar):_e(Sn,Cn,jr,he,Ve,ar);if(Pn!==void 0){if(Pn)continue;Hr=!1;break}if(Kr){if(!YT(Ve,function(En,Nn){if(!Hp(Kr,Nn)&&(Sn===En||At(Sn,En,ze,_e,ar)))return Kr.push(Nn)})){Hr=!1;break}}else if(Sn!==Cn&&!At(Sn,Cn,ze,_e,ar)){Hr=!1;break}}return ar.delete(he),ar.delete(Ve),Hr},Tf=ni.Uint8Array,XT=function(he){var Ve=-1,ze=Array(he.size);return he.forEach(function(_e,At){ze[++Ve]=[At,_e]}),ze},rb=Ci?Ci.prototype:void 0,op=rb?rb.valueOf:void 0,ap=function(he,Ve,ze,_e,At,ar,Dt){switch(ze){case"[object DataView]":if(he.byteLength!=Ve.byteLength||he.byteOffset!=Ve.byteOffset)return!1;he=he.buffer,Ve=Ve.buffer;case"[object ArrayBuffer]":return!(he.byteLength!=Ve.byteLength||!ar(new Tf(he),new Tf(Ve)));case"[object Boolean]":case"[object Date]":case"[object Number]":return Pc(+he,+Ve);case"[object Error]":return he.name==Ve.name&&he.message==Ve.message;case"[object RegExp]":case"[object String]":return he==Ve+"";case"[object Map]":var vr=XT;case"[object Set]":var Cr=1&_e;if(vr||(vr=On),he.size!=Ve.size&&!Cr)return!1;var Ar=Dt.get(he);if(Ar)return Ar==Ve;_e|=2,Dt.set(he,Ve);var $r=tb(vr(he),vr(Ve),_e,At,ar,Dt);return Dt.delete(he),$r;case"[object Symbol]":if(op)return op.call(he)==op.call(Ve)}return!1},sp=function(he,Ve,ze){var _e=Ve(he);return Gi(he)?_e:Cu(_e,ze(he))},Yh=function(he,Ve){for(var ze=-1,_e=he==null?0:he.length,At=0,ar=[];++ze<_e;){var Dt=he[ze];Ve(Dt,ze,he)&&(ar[At++]=Dt)}return ar},ip=function(){return[]},cp=Object.prototype.propertyIsEnumerable,Xh=Object.getOwnPropertySymbols,ZT=Xh?function(xe){return xe==null?[]:(xe=Object(xe),Yh(Xh(xe),function(he){return cp.call(xe,he)}))}:ip,lp=ZT,Cf=function(he){return sp(he,Jd,lp)},eC=Object.prototype.hasOwnProperty,nb=function(he,Ve,ze,_e,At,ar){var Dt=1&ze,vr=Cf(he),Cr=vr.length;if(Cr!=Cf(Ve).length&&!Dt)return!1;for(var Ar=Cr;Ar--;){var $r=vr[Ar];if(!(Dt?$r in Ve:eC.call(Ve,$r)))return!1}var jr=ar.get(he),Hr=ar.get(Ve);if(jr&&Hr)return jr==Ve&&Hr==he;var Kr=!0;ar.set(he,Ve),ar.set(Ve,he);for(var Sn=Dt;++Ar<Cr;){var Cn=he[$r=vr[Ar]],Pn=Ve[$r];if(_e)var En=Dt?_e(Pn,Cn,$r,Ve,he,ar):_e(Cn,Pn,$r,he,Ve,ar);if(!(En===void 0?Cn===Pn||At(Cn,Pn,ze,_e,ar):En)){Kr=!1;break}Sn||(Sn=$r=="constructor")}if(Kr&&!Sn){var Nn=he.constructor,zn=Ve.constructor;Nn==zn||!("constructor"in he)||!("constructor"in Ve)||typeof Nn=="function"&&Nn instanceof Nn&&typeof zn=="function"&&zn instanceof zn||(Kr=!1)}return ar.delete(he),ar.delete(Ve),Kr},Zh=Bl(ni,"DataView"),Mf=Bl(ni,"Promise"),ev=Bl(ni,"WeakMap"),tv="[object Map]",Mu="[object Promise]",up="[object Set]",zl="[object WeakMap]",Wl="[object DataView]",tC=Jc(Zh),ob=Jc(jd),rC=Jc(Mf),nC=Jc(pu),ol=Jc(ev),Qi=zc;(Zh&&Qi(new Zh(new ArrayBuffer(1)))!=Wl||jd&&Qi(new jd)!=tv||Mf&&Qi(Mf.resolve())!=Mu||pu&&Qi(new pu)!=up||ev&&Qi(new ev)!=zl)&&(Qi=function(xe){var he=zc(xe),Ve=he=="[object Object]"?xe.constructor:void 0,ze=Ve?Jc(Ve):"";if(ze)switch(ze){case tC:return Wl;case ob:return tv;case rC:return Mu;case nC:return up;case ol:return zl}return he});var $s=Qi,yi="[object Arguments]",kf="[object Array]",ku="[object Object]",ab=Object.prototype.hasOwnProperty,Gl=function(he,Ve,ze,_e,At,ar){var Dt=Gi(he),vr=Gi(Ve),Cr=Dt?kf:$s(he),Ar=vr?kf:$s(Ve),$r=(Cr=Cr==yi?ku:Cr)==ku,jr=(Ar=Ar==yi?ku:Ar)==ku,Hr=Cr==Ar;if(Hr&&ff(he)){if(!ff(Ve))return!1;Dt=!0,$r=!1}if(Hr&&!$r)return ar||(ar=new np),Dt||$h(he)?tb(he,Ve,ze,_e,At,ar):ap(he,Ve,Cr,ze,_e,At,ar);if(!(1&ze)){var Kr=$r&&ab.call(he,"__wrapped__"),Sn=jr&&ab.call(Ve,"__wrapped__");if(Kr||Sn){var Cn=Kr?he.value():he,Pn=Sn?Ve.value():Ve;return ar||(ar=new np),At(Cn,Pn,ze,_e,ar)}}return!!Hr&&(ar||(ar=new np),nb(he,Ve,ze,_e,At,ar))},sb=function xe(he,Ve,ze,_e,At){return he===Ve||(he==null||Ve==null||!zi(he)&&!zi(Ve)?he!=he&&Ve!=Ve:Gl(he,Ve,ze,_e,xe,At))},oC=function(he,Ve,ze,_e){var At=ze.length,ar=At,Dt=!_e;if(he==null)return!ar;for(he=Object(he);At--;){var vr=ze[At];if(Dt&&vr[2]?vr[1]!==he[vr[0]]:!(vr[0]in he))return!1}for(;++At<ar;){var Cr=(vr=ze[At])[0],Ar=he[Cr],$r=vr[1];if(Dt&&vr[2]){if(Ar===void 0&&!(Cr in he))return!1}else{var jr=new np;if(_e)var Hr=_e(Ar,$r,Cr,he,Ve,jr);if(!(Hr===void 0?sb($r,Ar,3,_e,jr):Hr))return!1}}return!0},ib=function(he){return he==he&&!Vi(he)},wf=function(he){for(var Ve=Jd(he),ze=Ve.length;ze--;){var _e=Ve[ze],At=he[_e];Ve[ze]=[_e,At,ib(At)]}return Ve},dp=function(he,Ve){return function(ze){return ze!=null&&ze[he]===Ve&&(Ve!==void 0||he in Object(ze))}},Ji=function(he){var Ve=wf(he);return Ve.length==1&&Ve[0][2]?dp(Ve[0][0],Ve[0][1]):function(ze){return ze===he||oC(ze,he,Ve)}},pp=function(he,Ve){return vh(he)&&ib(Ve)?dp($l(he),Ve):function(ze){var _e=oi(ze,he);return _e===void 0&&_e===Ve?tp(ze,he):sb(Ve,_e,3)}},al=function(he){return function(Ve){return Ve==null?void 0:Ve[he]}},ba=function(he){return function(Ve){return Sh(Ve,he)}},Fc=function(he){return vh(he)?al($l(he)):ba(he)},wu=function(he){return typeof he=="function"?he:he==null?du:typeof he=="object"?Gi(he)?pp(he[0],he[1]):Ji(he):Fc(he)},rv=/\s/,aC=function(he){for(var Ve=he.length;Ve--&&rv.test(he.charAt(Ve)););return Ve},sC=/^\s+/,iC=function(he){return he&&he.slice(0,aC(he)+1).replace(sC,"")},cC=/^[-+]0x[0-9a-f]+$/i,lC=/^0b[01]+$/i,uC=/^0o[0-7]+$/i,dC=parseInt,pC=function(he){if(typeof he=="number")return he;if(af(he))return NaN;if(Vi(he)){var Ve=typeof he.valueOf=="function"?he.valueOf():he;he=Vi(Ve)?Ve+"":Ve}if(typeof he!="string")return he===0?he:+he;he=iC(he);var ze=lC.test(he);return ze||uC.test(he)?dC(he.slice(2),ze?2:8):cC.test(he)?NaN:+he},nv=1/0,fC=function(he){return he?(he=pC(he))===nv||he===-1/0?17976931348623157e292*(he<0?-1:1):he==he?he:0:he===0?he:0},cb=function(he){var Ve=fC(he),ze=Ve%1;return Ve==Ve?ze?Ve-ze:Ve:0},mC=Math.max,ov=function(he,Ve,ze){var _e=he==null?0:he.length;if(!_e)return-1;var At=ze==null?0:cb(ze);return At<0&&(At=mC(_e+At,0)),Qv(he,wu(Ve),At)},gC={"4_12":"syncMsgReceipts","4_14":"syncSessionAck","4_20":"syncSuperTeamSessionAck","4_22":"nimSyncSessionsWithMoreRoaming","4_25":"syncSessionReliableInfo","7_12":"multiSyncMsgReceipt","7_16":"markSessionAck","7_25":"markMultSessionsAck","7_116":"syncMarkSessionAck","21_25":"markSuperTeamSessionAck","21_32":"markMultSuperTeamSessionsAck","21_125":"syncMarkSuperTeamSessionAck","4_23":"nimSyncStickTopSessions","23_12":"nimAddStickTopSession","23_13":"nimDeleteStickTopSession","23_14":"nimUpdateStickTopSession","23_112":"nimMultiSyncAddStickTopSession","23_113":"nimMultiSyncDeleteStickTopSession","23_114":"nimMultiSyncUpdateStickTopSession"},_u={msgReceiptTag:{to:1,from:2,time:7,idClient:11},stickTopSessionTag:{id:1,ext:2,createTime:3,updateTime:4},sessionAckTag:{scene:1,to:2,timetag:3},sessionReliableSyncTag:{scene:1,sessionId:2,syncStatus:3,syncEndMsgId:4,syncEndMsgidClient:5,syncEndMsgTime:6,syncStartMsgid:7,syncStartMsgidClient:8,syncStartMsgTime:9,nextMsgid:10,nextMsgidClient:11,nextMsgTime:12,roamMsgSync:13,offlineMsgSync:14,netCallOfflineMsgSync:15}},Lc=Is(_u),hC={syncMsgReceipts:{sid:4,cid:12,service:"session",response:[{type:"PropertyArray",name:"msgReceipts",reflectMapper:Lc.msgReceiptTag},{type:"Number",name:"timetag"}]},syncSessionAck:{sid:4,cid:14,service:"session",response:[{type:"StrLongMap",name:"p2p"},{type:"LongLongMap",name:"team"},{type:"Number",name:"timetag"}]},syncSuperTeamSessionAck:{sid:4,cid:20,service:"session",response:[{type:"LongLongMap",name:"superTeam"},{type:"Number",name:"timetag"}]},multiSyncMsgReceipt:{sid:7,cid:12,service:"session",response:[{type:"Property",name:"msgReceiptTag",reflectMapper:Lc.msgReceiptTag}]},markSessionAck:{sid:7,cid:16,service:"session",params:[{type:"byte",name:"scene"},{type:"String",name:"to"},{type:"long",name:"timetag"}]},syncMarkSessionAck:{sid:7,cid:116,service:"session",response:[{type:"byte",name:"scene"},{type:"String",name:"to"},{type:"long",name:"timetag"}]},syncMarkSuperTeamSessionAck:{sid:21,cid:125,service:"session",response:[{type:"String",name:"to"},{type:"long",name:"timetag"}]},markMultSessionsAck:{sid:7,cid:25,service:"session",ignoreErrCodes:[700],params:[{type:"PropertyArray",name:"datas",reflectMapper:_u.sessionAckTag}]},markSuperTeamSessionAck:{sid:21,cid:25,service:"session",params:[{type:"long",name:"to"},{type:"long",name:"timetag"}]},nimAddStickTopSession:{sid:23,cid:12,service:"session",params:[{type:"Property",name:"tag",reflectMapper:_u.stickTopSessionTag}],response:[{type:"Property",name:"data",reflectMapper:Lc.stickTopSessionTag}]},nimDeleteStickTopSession:{sid:23,cid:13,service:"session",params:[{type:"Property",name:"tag",reflectMapper:_u.stickTopSessionTag}],response:[{type:"Number",name:"timetag"}]},nimUpdateStickTopSession:{sid:23,cid:14,service:"session",params:[{type:"Property",name:"tag",reflectMapper:_u.stickTopSessionTag}],response:[{type:"Property",name:"data",reflectMapper:Lc.stickTopSessionTag}]},nimMultiSyncAddStickTopSession:{sid:23,cid:112,service:"session",response:[{type:"Property",name:"data",reflectMapper:Lc.stickTopSessionTag}]},nimMultiSyncDeleteStickTopSession:{sid:23,cid:113,service:"session",response:[{type:"Number",name:"timetag"},{type:"Property",name:"data",reflectMapper:Lc.stickTopSessionTag}]},nimMultiSyncUpdateStickTopSession:{sid:23,cid:114,service:"session",response:[{type:"Property",name:"data",reflectMapper:Lc.stickTopSessionTag}]},nimSyncStickTopSessions:{sid:4,cid:23,service:"session",response:[{type:"Number",name:"timetag"},{type:"Boolean",name:"isThereAnyChange"},{type:"PropertyArray",name:"datas",reflectMapper:Lc.stickTopSessionTag}]},markMultSuperTeamSessionsAck:{sid:21,cid:32,service:"session",ignoreErrCodes:[700],params:[{type:"PropertyArray",name:"datas",reflectMapper:_u.sessionAckTag}]},nimSyncSessionsWithMoreRoaming:{sid:21,cid:22,service:"session",response:[{type:"PropertyArray",name:"datas",reflectMapper:{0:"scene",1:"to",2:"from",7:"time",12:"idServer"}}]},syncSessionReliableInfo:{sid:4,cid:25,service:"session",response:[{type:"Property",name:"context",reflectMapper:{1:"timetag",2:"type"}},{type:"PropertyArray",name:"datas",reflectMapper:Lc.sessionReliableSyncTag}]}},vC={id:{type:"string"},ext:{type:"string"},createTime:{type:"number"},updateTime:{type:"number"}};function _f(xe,he,Ve){Ve===void 0&&(Ve=!0);var ze=_i(vC,xe);return ze.isStickOnTop=Ve,ze.id=he.id,zr(zr({},he),{stickTopInfo:he.stickTopInfo?zr({},he.stickTopInfo,ze):ze})}var yC={scene:{type:"enum",values:us},time:{type:"number"}},fp=function(){function xe(Ve){this.core=Ve}var he=xe.prototype;return he.getSession=function(ze){return this.core.session.getSessionWithUncomplete({id:ze})||this.core.session.createSession(ze)},he.addStickTopSession=function(ze){return qn(this,void 0,void 0,_r.mark(function _e(){var At,ar,Dt,vr,Cr,Ar;return _r.wrap(function(jr){for(;;)switch(jr.prev=jr.next){case 0:return Jn({id:{type:"string",allowEmpty:!1},ext:{type:"string",required:!1}},ze),At=na(ze.id),ar=At.scene,Dt=At.accid,jr.next=4,this.core.sendCmd("nimAddStickTopSession",{tag:{id:(ar==="superTeam"?"super_team":ar)+"|"+Dt,ext:ze.ext}});case 4:return vr=jr.sent,Cr=this.getSession(ze.id),Ar=_f(vr.content.data,Cr),jr.abrupt("return",Ar);case 8:case"end":return jr.stop()}},_e,this)}))},he.deleteStickTopSession=function(ze){return qn(this,void 0,void 0,_r.mark(function _e(){var At,ar,Dt,vr,Cr,Ar;return _r.wrap(function(jr){for(;;)switch(jr.prev=jr.next){case 0:return Jn({id:{type:"string",allowEmpty:!1}},ze),At=na(ze.id),ar=At.scene,Dt=At.accid,jr.next=4,this.core.sendCmd("nimDeleteStickTopSession",{tag:{id:(ar==="superTeam"?"super_team":ar)+"|"+Dt}});case 4:return vr=jr.sent,Cr=this.getSession(ze.id),Ar=_f({updateTime:vr.content.timetag},Cr,!1),jr.abrupt("return",Ar);case 8:case"end":return jr.stop()}},_e,this)}))},he.updateStickTopSession=function(ze){return qn(this,void 0,void 0,_r.mark(function _e(){var At,ar,Dt,vr,Cr,Ar;return _r.wrap(function(jr){for(;;)switch(jr.prev=jr.next){case 0:return Jn({id:{type:"string",allowEmpty:!1},ext:{type:"string",required:!1}},ze),At=na(ze.id),ar=At.scene,Dt=At.accid,jr.next=4,this.core.sendCmd("nimUpdateStickTopSession",{tag:{id:(ar==="superTeam"?"super_team":ar)+"|"+Dt,ext:ze.ext}});case 4:return vr=jr.sent,Cr=this.getSession(ze.id),Ar=_f(vr.content.data,Cr),jr.abrupt("return",Ar);case 8:case"end":return jr.stop()}},_e,this)}))},he.stickTopSessionHandler=function(ze,_e){_e===void 0&&(_e=!0);var At=na(ze.id,"|"),ar=At.scene+"-"+At.accid;return _f(ze,this.getSession(ar),_e)},xe}(),xu=function(){function xe(Ve){this.core=Ve,this.logger=Ve.logger}var he=xe.prototype;return he.canSessionResetUnreadCount=function(ze){var _e=ze.id;if(ze.lastMsg===void 0)throw new Error("Session::canSessionResetUnreadCount: session "+_e+" is not completly, lastMsg undefined");return ze.lastMsg!==null||ze.unread>0?!(ze.ack&&ze.lastMsg&&ze.ack>=ze.lastMsg.time)||(this.logger.log("Session::canSessionResetUnreadCount: session "+_e+" reset failed, ack time is greater than last message time"),!1):(this.logger.log("Session::canSessionResetUnreadCount: session "+_e+" doesn't need to be updated, lastMsg null and unread 0"),!1)},he.filterSessionForResetUnreadCount=function(ze){var _e=this,At={cmd:"markMultSuperTeamSessionsAck",params:[]},ar={cmd:"markMultSessionsAck",params:[]};return Qn(ze).call(ze,function(Dt){var vr;try{if(!_e.canSessionResetUnreadCount(Dt))return;var Cr=na(Dt.id),Ar=Cr.accid,$r=Cr.scene,jr={to:Ar,sessionId:Dt.id,timetag:((vr=Dt==null?void 0:Dt.lastMsg)===null||vr===void 0?void 0:vr.time)||Dt.updateTime||0},Hr=function(Sn){return Kd({scene:{type:"enum",values:us}},Sn)}({scene:$r});$r==="superTeam"?At.params.push(jr):ar.params.push(zr(zr({},jr),Hr))}catch(Kr){_e.logger.warn(Kr)}}),{superTeam:At,p2pOrTeam:ar}},xe}(),av=function(he,Ve,ze){var _e=-1,At=he.length;Ve<0&&(Ve=-Ve>At?0:At+Ve),(ze=ze>At?At:ze)<0&&(ze+=At),At=Ve>ze?0:ze-Ve>>>0,Ve>>>=0;for(var ar=Array(At);++_e<At;)ar[_e]=he[_e+Ve];return ar},bC=function(he,Ve,ze){if(!Vi(ze))return!1;var _e=typeof Ve;return!!(_e=="number"?Gp(ze)&&mf(Ve,ze.length):_e=="string"&&Ve in ze)&&Pc(ze[Ve],he)},SC=Math.ceil,TC=Math.max,lb=function(he,Ve,ze){Ve=(ze?bC(he,Ve,ze):Ve===void 0)?1:TC(cb(Ve),0);var _e=he==null?0:he.length;if(!_e||Ve<1)return[];for(var At=0,ar=0,Dt=Array(SC(_e/Ve));At<_e;)Dt[ar++]=av(he,At,At+=Ve);return Dt};function gs(xe,he){var Ve,ze=Ua!==void 0&&qd(xe)||xe["@@iterator"];if(ze)return Zo(Ve=(ze=ze.call(xe)).next).call(Ve,ze);if(Hi(xe)||(ze=function(ar,Dt){var vr;if(ar){if(typeof ar=="string")return Aa(ar,Dt);var Cr=$o(vr=Object.prototype.toString.call(ar)).call(vr,8,-1);if(Cr==="Object"&&ar.constructor&&(Cr=ar.constructor.name),Cr==="Map"||Cr==="Set")return of(ar);if(Cr==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(Cr))return Aa(ar,Dt)}}(xe))||he&&xe&&typeof xe.length=="number"){ze&&(xe=ze);var _e=0;return function(){return _e>=xe.length?{done:!0}:{done:!1,value:xe[_e++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Aa(xe,he){(he==null||he>xe.length)&&(he=xe.length);for(var Ve=0,ze=new Array(he);Ve<he;Ve++)ze[Ve]=xe[Ve];return ze}var CC=function(xe){function he(ze,_e){var At;return(At=xe.call(this,"session",ze)||this).list=new xc,At.unreadCountFilterFn=function(ar){return!0},At.lastMessageFilterFn=function(ar){return!0},At.initEventListeners(),ps({cmdMap:gC,cmdConfig:hC}),typeof(_e==null?void 0:_e.unreadCountFilterFn)=="function"&&(At.unreadCountFilterFn=_e.unreadCountFilterFn),typeof(_e==null?void 0:_e.lastMessageFilterFn)=="function"&&(At.lastMessageFilterFn=_e.lastMessageFilterFn),At.stickTopService=new fp(ze),At.unreadModule=new xu(ze),At}ea(he,xe);var Ve=he.prototype;return Ve.initEventListeners=function(){var _e,At,ar,Dt=this;this.core.eventBus.on("session/syncMsgs",Zo(_e=this.onSyncMsgs).call(_e,this)),this.core.eventBus.on("session/updateForNewMsg",Zo(At=this.updateSessionWithMsg).call(At,this)),this.core.eventBus.on("session/updateForClearMsg",function(vr,Cr){Cr===void 0&&(Cr=!0),vr&&vr.length>0&&Qn(vr).call(vr,function(Ar){Dt.updateSession({id:Ar.sessionId,lastMsg:null,unread:0,unreadMsgs:[]},Cr)})}),this.core.eventBus.on("session/updateForDeletedMsg",Zo(ar=this.updateSessionForDeletedMsg).call(ar,this))},Ve.createSession=function(_e,At){try{var ar=na(_e);return{id:_e,scene:ar.scene,to:ar.accid,lastMsg:At,updateTime:At?At.time:0,unread:0,unreadMsgs:[],ack:0}}catch(Dt){throw this.logger.error("Failed to create session with "+_e,Dt),new Error("Failed to create session with "+_e)}},Ve.getSession=function(_e){Jn({id:{type:"string",allowEmpty:!1}},_e);var At=this.list.get(_e.id);if(this.isSessionComplete(At))return At},Ve.getSessionWithUncomplete=function(_e){return this.list.get(_e.id)},Ve.getAllSessions=function(){for(var _e,At=[],ar=gs(this.list);!(_e=ar()).done;){var Dt=_e.value;Dt[0];var vr=Dt[1];this.isSessionComplete(vr)&&At.push(vr)}return At},Ve.getSessions=function(_e){Jn({limit:{type:"number",required:!1},lastSessionId:{type:"string",allowEmpty:!1,required:!1},desc:{type:"boolean",required:!1}},_e);var At=[],ar=_e.limit,Dt=ar===void 0?100:ar,vr=_e.desc,Cr=vr===void 0||vr,Ar=_e.lastSessionId,$r=0;if(Cr){for(var jr,Hr,Kr=gs(this.list);!(Hr=Kr()).done;){var Sn=Hr.value,Cn=Sn[0],Pn=Sn[1];if(Ar===Cn)break;this.isSessionComplete(Pn)&&At.push(Pn)}return Yl(jr=$o(At).call(At,-Dt)).call(jr)}for(var En,Nn=gs(this.list);!(En=Nn()).done;){var zn=En.value,yo=zn[0],fo=zn[1];if(Ar)yo===Ar&&(Ar=void 0);else if(this.isSessionComplete(fo)){if(++$r>Dt)break;At.push(fo)}}return At},Ve.resetSessionUnreadCount=function(_e){var At,ar;return qn(this,void 0,void 0,_r.mark(function Dt(){var vr,Cr,Ar,$r,jr,Hr,Kr,Sn,Cn=this;return _r.wrap(function(En){for(;;)switch(En.prev=En.next){case 0:if(!((At=this.core.sync)===null||At===void 0)&&At.getSyncDoneFlag()||this.logger.warn("Please call resetSessionUnreadCount after syncdone event"),Jn({id:{type:"string",allowEmpty:!1}},_e),Jn({id:{type:"string",allowEmpty:!1}},_e),vr=_e.id,Cr=this.list.get(vr)){En.next=8;break}throw this.logger.warn("resetSessionUnreadCount: can not find session "+vr),new Error("Session::canSessionResetUnreadCount: can not find session "+vr);case 8:Ar=!1;try{Ar=this.unreadModule.canSessionResetUnreadCount(Cr)}catch(Nn){this.logger.warn(Nn)}if(Ar!==!1){En.next=12;break}return En.abrupt("return");case 12:return $r=na(vr),jr=$r.accid,Hr=$r.scene,Kr={to:jr,timetag:((ar=Cr==null?void 0:Cr.lastMsg)===null||ar===void 0?void 0:ar.time)||Cr.updateTime||0},Sn="markSuperTeamSessionAck",Hr!=="superTeam"&&(Kr.scene=Hr==="p2p"?0:1,Sn="markSessionAck"),En.abrupt("return",this.core.sendCmd(Sn,Kr).then(function(){var Nn=Cn.storeUnreadByAck(vr,Kr.timetag);Nn&&Cn.core.emit("updateSession",Nn)}));case 17:case"end":return En.stop()}},Dt,this)}))},Ve.resetMultiSessionUnreadCount=function(_e){var At;return qn(this,void 0,void 0,_r.mark(function ar(){var Dt,vr,Cr,Ar,$r,jr,Hr,Kr,Sn,Cn,Pn,En,Nn,zn,yo=this;return _r.wrap(function(qo){for(;;)switch(qo.prev=qo.next){case 0:!((At=this.core.sync)===null||At===void 0)&&At.getSyncDoneFlag()||this.logger.warn("Please call resetMultiSessionUnreadCount after syncdone event"),Jn({ids:{type:"array",itemType:"string",min:1}},_e),Cr=Bs(Dt=Fo(vr=_e.ids).call(vr,function(ao){return yo.list.get(ao)})).call(Dt,function(ao,Wr){return!!ao||(yo.logger.warn("Session::canSessionResetUnreadCount: can not find session "+_e.ids[Wr]),!1)}),Ar=this.unreadModule.filterSessionForResetUnreadCount(Cr),$r=Ar.superTeam,jr=Ar.p2pOrTeam,Hr=lb($r.params,10),Kr=lb(jr.params,10),Sn=gs(Hr);case 7:if((Cn=Sn()).done){qo.next=14;break}return Pn=Cn.value,qo.next=11,this.core.sendCmd($r.cmd,{datas:Pn});case 11:Qn(Pn).call(Pn,function(ao){var Wr=yo.storeUnreadByAck(ao.sessionId,ao.timetag);Wr&&yo.core.emit("updateSession",Wr)});case 12:qo.next=7;break;case 14:En=gs(Kr);case 15:if((Nn=En()).done){qo.next=22;break}return zn=Nn.value,qo.next=19,this.core.sendCmd(jr.cmd,{datas:zn});case 19:Qn(zn).call(zn,function(ao){var Wr=yo.storeUnreadByAck(ao.sessionId,ao.timetag);Wr&&yo.core.emit("updateSession",Wr)});case 20:qo.next=15;break;case 22:case"end":return qo.stop()}},ar,this)}))},Ve.resetAllSessionsUnreadCount=function(){var _e,At;!((At=this.core.sync)===null||At===void 0)&&At.getSyncDoneFlag()||this.logger.warn("Please call resetAllSessionsUnreadCount after syncdone event");var ar=[];return Qn(_e=this.list).call(_e,function(Dt){ar.push(Dt.id)}),this.resetMultiSessionUnreadCount({ids:ar})},Ve.deleteSession=function(_e){return qn(this,void 0,void 0,_r.mark(function At(){return _r.wrap(function(Dt){for(;;)switch(Dt.prev=Dt.next){case 0:if(Jn({id:{type:"string",allowEmpty:!1},isSyncToServer:{type:"boolean",required:!1}},_e),this.list.delete(_e.id),!this.core.msgLog||!_e.isSyncToServer){Dt.next=5;break}return Dt.next=5,this.core.msgLog.deleteRoamingMsgs({ids:[_e.id]});case 5:case"end":return Dt.stop()}},At,this)}))},Ve.deleteAllSessionsFromLocal=function(){this.list.clear()},Ve.addStickTopSession=function(_e){return qn(this,void 0,void 0,_r.mark(function At(){var ar;return _r.wrap(function(vr){for(;;)switch(vr.prev=vr.next){case 0:return vr.next=2,this.stickTopService.addStickTopSession(_e);case 2:return ar=vr.sent,this.list.set(ar.id,ar),vr.abrupt("return",ar);case 5:case"end":return vr.stop()}},At,this)}))},Ve.deleteStickTopSession=function(_e){return qn(this,void 0,void 0,_r.mark(function At(){var ar;return _r.wrap(function(vr){for(;;)switch(vr.prev=vr.next){case 0:return vr.next=2,this.stickTopService.deleteStickTopSession(_e);case 2:return ar=vr.sent,this.list.set(ar.id,ar),vr.abrupt("return",ar);case 5:case"end":return vr.stop()}},At,this)}))},Ve.updateStickTopSession=function(_e){return qn(this,void 0,void 0,_r.mark(function At(){var ar;return _r.wrap(function(vr){for(;;)switch(vr.prev=vr.next){case 0:return vr.next=2,this.stickTopService.updateStickTopSession(_e);case 2:return ar=vr.sent,this.list.set(ar.id,ar),vr.abrupt("return",ar);case 5:case"end":return vr.stop()}},At,this)}))},Ve.nimMultiSyncAddStickTopSessionHandler=function(_e){var At=this.stickTopService.stickTopSessionHandler(_e.content.data);this.list.set(At.id,At),this.core.emit("updateSession",At)},Ve.nimMultiSyncDeleteStickTopSessionHandler=function(_e){var At=this.stickTopService.stickTopSessionHandler({id:_e.content.data.id,updateTime:_e.content.timetag},!1);this.list.set(At.id,At),this.core.emit("updateSession",At)},Ve.nimMultiSyncUpdateStickTopSessionHandler=function(_e){var At=this.stickTopService.stickTopSessionHandler(_e.content.data);this.list.set(At.id,At),this.core.emit("updateSession",At)},Ve.nimSyncStickTopSessionsHandler=function(_e){var At=this,ar=_e.content.datas;Qn(ar).call(ar,function(Dt){var vr=At.stickTopService.stickTopSessionHandler(Dt);At.list.set(vr.id,vr)})},Ve.updateSessionWithMsg=function(_e){var At=!0,ar=!0;try{At=!!this.unreadCountFilterFn(_e)}catch(Ar){this.logger.error("session:updateSessionWithMsg, unreadCountFilterFn error",Ar)}try{ar=!!this.lastMessageFilterFn(_e)}catch(Ar){this.logger.error("session:updateSessionWithMsg, lastMessageFilterFn error",Ar)}var Dt=this.list.get(_e.sessionId)||this.createSession(_e.sessionId),vr=!1;if(this.logger.log("session:updateSessionWithMsg, pending ",_e.sessionId,_e.idClient,_e.idServer,ar,At),ar&&(!Dt.lastMsg||Dt.lastMsg.time<_e.time||_e.status===Va[Va.sending]||Dt.lastMsg.status===Va[Va.sending])&&(Dt.lastMsg=_e,Dt.updateTime=_e.time,vr=!0),At&&_e.status===Va[Va.unread]&&_e.time>(Dt.ack||0)){Dt.unread++;var Cr=Dt.unreadMsgs||[];Cr.unshift(_e),Zc(Cr).call(Cr,function(Ar,$r){return $r.time-Ar.time}),vr=!0}vr&&(this.logger.log("session:updateSessionWithMsg updating ",Dt.id,Dt.unread,Dt.lastMsg&&Dt.lastMsg.idClient),this.list.set(Dt.id,Dt),this.core.emit("updateSession",Dt))},Ve.storeUnreadByAck=function(_e,At){var ar=this.list.get(_e)||this.createSession(_e);if(!(ar.ack&&At<ar.ack)){var Dt=ar.unreadMsgs||[],vr=[],Cr=0;return ar.unreadMsgs=[],Dt.length>0&&(Qn(Dt).call(Dt,function(Ar){Ar.time>At&&(Cr++,vr.push(Ar))}),ar.unreadMsgs=Zc(vr).call(vr,function(Ar,$r){return $r.time-Ar.time})),ar.ack=At,ar.unread=Cr,ar.lastMsg&&ar.lastMsg.status==="unread"&&At>=ar.lastMsg.time&&(ar.lastMsg.status="read"),this.list.set(_e,ar),ar}this.logger.warn("storeUnreadByAck: not need update ack",_e,At,ar.ack)},Ve.updateSession=function(_e,At){At===void 0&&(At=!0);var ar=_e.id,Dt=this.list.get(ar)||this.createSession(_e.id),vr=zr(Dt,_e);return this.list.set(ar,vr),this.logger.log("updateSession: update",At,rp(_e,["id","ack","unread"]),vr.lastMsg&&vr.lastMsg.idClient),At&&this.core.emit("updateSession",vr),vr},Ve.isSessionComplete=function(_e){return!!_e&&!!(_e.id&&_e.scene&&_e.to)&&_e.lastMsg!==void 0},Ve.syncSessionAckHandler=function(_e){var At,ar,Dt=this,vr=_e.content.p2p||{},Cr=_e.content.team.m_map||{};this.logger.log("syncSessionAck::",vr,Cr),Qn(At=la(vr)).call(At,function(Ar){Dt.updateSession({id:"p2p-"+Ar,ack:vr[Ar]},!1)}),Qn(ar=la(Cr)).call(ar,function(Ar){Dt.updateSession({id:"team-"+Ar,ack:Cr[Ar]},!1)})},Ve.syncSuperTeamSessionAckHandler=function(_e){var At,ar=this,Dt=_e.content.superTeam.m_map;this.logger.log("syncSuperTeamSessionAck::",Dt),Qn(At=la(Dt)).call(At,function(vr){ar.updateSession({id:"superTeam-"+vr,ack:Dt[vr]},!1)})},Ve.syncMarkSessionAckHandler=function(_e){var At=_e.content,ar=(At.scene===0?"p2p":At.scene===1?"team":"superTeam")+"-"+At.to,Dt=this.list.get(ar);if(Dt&&Dt.ack&&At.timetag<Dt.ack)this.logger.warn("syncMarkSessionAckHandler: "+ar+" do not need update ack",Dt.ack,At.timetag);else{var vr=this.storeUnreadByAck(ar,At.timetag);vr&&this.core.emit("updateSession",vr)}},Ve.syncMarkSuperTeamSessionAckHandler=function(_e){_e.content.scene=5,this.syncMarkSessionAckHandler(_e)},Ve.onSyncDone=function(){var _e,At,ar,Dt=this,vr=[];Qn(_e=this.list).call(_e,function(Cr,Ar){vr.push(Dt.storeUnreadByAck(Ar,Cr.ack||0))}),this.list.clear(),Qn(At=Zc(vr).call(vr,function(Cr,Ar){return Cr.updateTime-Ar.updateTime})).call(At,function(Cr){Dt.list.set(Cr.id,Cr)}),(vr=Zc(ar=Bs(vr).call(vr,function(Cr){return Dt.isSessionComplete(Cr)})).call(ar,function(Cr,Ar){return Ar.updateTime-Cr.updateTime})).length>0&&this.core.emit("sessions",vr)},Ve.onSyncMsgs=function(_e){var At,ar=this,Dt=this.list.get(_e.sessionId),vr=[];try{var Cr;vr=Bs(Cr=_e.msgs).call(Cr,function(Kr){return ar.unreadCountFilterFn(JSON.parse(fa(Kr)))})}catch(Kr){this.logger.error("session:onSyncMsgs, unreadCountFilterFn error ",Kr)}var Ar,$r=[];try{var jr;$r=Bs(jr=_e.msgs).call(jr,function(Kr){return ar.lastMessageFilterFn(JSON.parse(fa(Kr)))})}catch(Kr){this.logger.error("session:onSyncMsgs, lastMessageFilterFn error ",Kr)}$r&&$r.length>0&&(Ar=$r[$r.length-1],Ar=$r[0].time>Ar.time?$r[0]:Ar);var Hr=Ar?Ar.time:0;Dt||(Dt=Ar?this.createSession(_e.sessionId,Ar):this.createSession(_e.sessionId)),Dt.unreadMsgs=Dt.unreadMsgs?Bs(At=Ys(vr).call(vr,Dt.unreadMsgs)).call(At,function(Kr){return Kr.status===Va[Va.unread]}):Bs(vr).call(vr,function(Kr){return Kr.status===Va[Va.unread]}),Dt.updateTime&&Dt.updateTime>=Hr||(Dt.updateTime=Hr),Dt.lastMsg&&Dt.lastMsg.time>=Hr||(Dt.lastMsg=Ar),this.list.set(Dt.id,Dt)},Ve.updateSessionForDeletedMsg=function(_e){var At,ar=this,Dt={};Qn(_e).call(_e,function(vr){var Cr=vr.to===ar.core.account?vr.from:vr.to,Ar=vr.scene+"-"+Cr,$r=ar.list.get(Ar);if($r){if(($r.ack||0)<vr.time&&vr.from!==ar.core.account&&$r.unread>0&&($r.unread=$r.unread-1,$r.unreadMsgs&&$r.unreadMsgs.length>0)){var jr,Hr=ov($r.unreadMsgs,{idClient:vr.idClient});Hr>=0&&gh(jr=$r.unreadMsgs).call(jr,Hr,1)}$r.lastMsg&&$r.lastMsg.idClient===vr.idClient&&($r.lastMsg=null),Dt[$r.id]=!0}}),Qn(At=la(Dt)).call(At,function(vr){var Cr=ar.list.get(vr);Cr&&ar.core.emit("updateSession",Cr)})},Ve.multiSyncMsgReceiptHandler=function(_e){var At,ar=(At=_e.content)===null||At===void 0?void 0:At.msgReceiptTag;if(ar){this.updateSessionMsgReceiptTime([ar],!0),ar.msgReceiptTime=ar.time,ar.sessionId="p2p-"+ar.from,ar.time,ar.from;var Dt=ri(ar,["time","from"]);this.core.emit("msgReceipts",[Dt])}},Ve.syncMsgReceiptsHandler=function(_e){var At,ar=(At=_e.content)===null||At===void 0?void 0:At.msgReceipts;ar&&this.updateSessionMsgReceiptTime(ar,!1)},Ve.updateSessionMsgReceiptTime=function(_e,At){var ar=this;At===void 0&&(At=!0),_e&&_e.length>0&&Qn(_e).call(_e,function(Dt){var vr=ar.list.get("p2p-"+Dt.from);vr||(vr=ar.createSession("p2p-"+Dt.from));var Cr=Uo(Dt.time);vr.msgReceiptTime&&vr.msgReceiptTime>=Cr||(vr.msgReceiptTime=Cr,vr.lastMsg&&vr.lastMsg.status==="sent"&&Cr>=vr.lastMsg.time&&(vr.lastMsg.status="receipt"),ar.logger.log("session: update session "+vr.id+" msgReceiptTime: "+vr.msgReceiptTime),ar.list.set(vr.id,vr),At&&ar.core.emit("updateSession",vr))})},Ve.nimSyncSessionsWithMoreRoamingHandler=function(_e){var At=function(Dt,vr){return Fo(Dt).call(Dt,function(Cr){var Ar=_i(yC,Cr);return Ar.sessionId=Ki(Cr,vr),Ar})}(_e.content.datas,this.core.account);this.logger.log("session:syncSessionsWithMoreRoaming",At)},he}(Ps),MC=function(){function xe(Ve){this.core=Ve}var he=xe.prototype;return he.notifyAddTeamMembers=function(ze,_e){this.core.emit("addTeamMembers",{team:ze,accounts:_e,members:jT(ze,_e)})},he.notifyUpdateTeamManagers=function(ze,_e,At,ar){this.core.emit("updateTeamManagers",{team:{teamId:ze,memberUpdateTime:ar},accounts:_e,isManager:At,members:Fo(_e).call(_e,function(Dt){return{id:ze+"-"+Dt,account:Dt,type:"manager",updateTime:ar}})})},he.notifyRemoveTeamMembers=function(ze,_e){this.core.emit("removeTeamMembers",{team:ze,accounts:_e})},he.notifyTransferTeam=function(ze,_e,At){this.core.emit("transferTeam",{team:ze,from:{id:ze.teamId+"-"+_e,type:"normal",account:_e,updateTime:ze.memberUpdateTime},to:{id:ze.teamId+"-"+At,type:"owner",account:At,updateTime:ze.memberUpdateTime}})},he.notifyUpdateTeamMembersMute=function(ze,_e,At){this.core.emit("updateTeamMembersMute",{team:ze,accounts:_e,members:Fo(_e).call(_e,function(ar){return{id:ze.teamId+"-"+ar,account:ar,teamId:ze.teamId,mute:At,updateTime:ze.memberUpdateTime}}),mute:At})},xe}(),kC=function(he,Ve){for(var ze=-1,_e=he==null?0:he.length;++ze<_e&&Ve(he[ze],ze,he)!==!1;);return he},xf=function(he,Ve,ze,_e){var At=!ze;ze||(ze={});for(var ar=-1,Dt=Ve.length;++ar<Dt;){var vr=Ve[ar],Cr=_e?_e(ze[vr],he[vr],vr,ze,he):void 0;Cr===void 0&&(Cr=he[vr]),At?Tu(ze,vr,Cr):bf(ze,vr,Cr)}return ze},wC=function(he,Ve){return he&&xf(Ve,Jd(Ve),he)},$c=function(he){var Ve=[];if(he!=null)for(var ze in Object(he))Ve.push(ze);return Ve},ai=Object.prototype.hasOwnProperty,If=function(he){if(!Vi(he))return $c(he);var Ve=Dl(he),ze=[];for(var _e in he)(_e!="constructor"||!Ve&&ai.call(he,_e))&&ze.push(_e);return ze},sv=function(he){return Gp(he)?Oy(he,!0):If(he)},js=function(he,Ve){return he&&xf(Ve,sv(Ve),he)},Fa=g(function(xe,he){var Ve=he&&!he.nodeType&&he,ze=Ve&&xe&&!xe.nodeType&&xe,_e=ze&&ze.exports===Ve?ni.Buffer:void 0,At=_e?_e.allocUnsafe:void 0;xe.exports=function(Dt,vr){if(vr)return Dt.slice();var Cr=Dt.length,Ar=At?At(Cr):new Dt.constructor(Cr);return Dt.copy(Ar),Ar}}),_C=function(he,Ve){var ze=-1,_e=he.length;for(Ve||(Ve=Array(_e));++ze<_e;)Ve[ze]=he[ze];return Ve},ub=function(he,Ve){return xf(he,lp(he),Ve)},Ef=Object.getOwnPropertySymbols?function(xe){for(var he=[];xe;)Cu(he,lp(xe)),xe=Nh(xe);return he}:ip,iv=function(he,Ve){return xf(he,Ef(he),Ve)},db=function(he){return sp(he,sv,Ef)},pb=Object.prototype.hasOwnProperty,mp=function(he){var Ve=he.length,ze=new he.constructor(Ve);return Ve&&typeof he[0]=="string"&&pb.call(he,"index")&&(ze.index=he.index,ze.input=he.input),ze},Pf=function(he){var Ve=new he.constructor(he.byteLength);return new Tf(Ve).set(new Tf(he)),Ve},cv=function(he,Ve){var ze=Ve?Pf(he.buffer):he.buffer;return new he.constructor(ze,he.byteOffset,he.byteLength)},fb=/\w*$/,Xs=function(he){var Ve=new he.constructor(he.source,fb.exec(he));return Ve.lastIndex=he.lastIndex,Ve},mb=Ci?Ci.prototype:void 0,lv=mb?mb.valueOf:void 0,xC=function(he){return lv?Object(lv.call(he)):{}},IC=function(he,Ve){var ze=Ve?Pf(he.buffer):he.buffer;return new he.constructor(ze,he.byteOffset,he.length)},EC=function(he,Ve,ze){var _e=he.constructor;switch(Ve){case"[object ArrayBuffer]":return Pf(he);case"[object Boolean]":case"[object Date]":return new _e(+he);case"[object DataView]":return cv(he,ze);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return IC(he,ze);case"[object Map]":case"[object Set]":return new _e;case"[object Number]":case"[object String]":return new _e(he);case"[object RegExp]":return Xs(he);case"[object Symbol]":return xC(he)}},gb=Object.create,PC=function(){function xe(){}return function(he){if(!Vi(he))return{};if(gb)return gb(he);xe.prototype=he;var Ve=new xe;return xe.prototype=void 0,Ve}}(),AC=function(he){return typeof he.constructor!="function"||Dl(he)?{}:PC(Nh(he))},NC=function(he){return zi(he)&&$s(he)=="[object Map]"},uv=Fs&&Fs.isMap,OC=uv?ou(uv):NC,RC=function(he){return zi(he)&&$s(he)=="[object Set]"},hb=Fs&&Fs.isSet,dv=hb?ou(hb):RC,vb="[object Arguments]",pv="[object Function]",Zs="[object Object]",Ha={};Ha[vb]=Ha["[object Array]"]=Ha["[object ArrayBuffer]"]=Ha["[object DataView]"]=Ha["[object Boolean]"]=Ha["[object Date]"]=Ha["[object Float32Array]"]=Ha["[object Float64Array]"]=Ha["[object Int8Array]"]=Ha["[object Int16Array]"]=Ha["[object Int32Array]"]=Ha["[object Map]"]=Ha["[object Number]"]=Ha[Zs]=Ha["[object RegExp]"]=Ha["[object Set]"]=Ha["[object String]"]=Ha["[object Symbol]"]=Ha["[object Uint8Array]"]=Ha["[object Uint8ClampedArray]"]=Ha["[object Uint16Array]"]=Ha["[object Uint32Array]"]=!0,Ha["[object Error]"]=Ha[pv]=Ha["[object WeakMap]"]=!1;var BC=function xe(he,Ve,ze,_e,At,ar){var Dt,vr=1&Ve,Cr=2&Ve,Ar=4&Ve;if(ze&&(Dt=At?ze(he,_e,At,ar):ze(he)),Dt!==void 0)return Dt;if(!Vi(he))return he;var $r=Gi(he);if($r){if(Dt=mp(he),!vr)return _C(he,Dt)}else{var jr=$s(he),Hr=jr==pv||jr=="[object GeneratorFunction]";if(ff(he))return Fa(he,vr);if(jr==Zs||jr==vb||Hr&&!At){if(Dt=Cr||Hr?{}:AC(he),!vr)return Cr?iv(he,js(Dt,he)):ub(he,wC(Dt,he))}else{if(!Ha[jr])return At?he:{};Dt=EC(he,jr,vr)}}ar||(ar=new np);var Kr=ar.get(he);if(Kr)return Kr;ar.set(he,Dt),dv(he)?he.forEach(function(Cn){Dt.add(xe(Cn,Ve,ze,Cn,he,ar))}):OC(he)&&he.forEach(function(Cn,Pn){Dt.set(Pn,xe(Cn,Ve,ze,Pn,he,ar))});var Sn=$r?void 0:(Ar?Cr?db:Cf:Cr?sv:Jd)(he);return kC(Sn||he,function(Cn,Pn){Sn&&(Cn=he[Pn=Cn]),bf(Dt,Pn,xe(Cn,Ve,ze,Pn,he,ar))}),Dt},sl,jc,Dc=function(he){return BC(he,5)},FC=function(xe){function he(ze){var _e;return(_e=xe.call(this,"team",ze)||this).myTeamMembersMap=new xc,_e.service=new MC(ze),_e.core.eventBus.on("team/onNotification",function(At){return _e.notificationHandler(At)}),ps({cmdMap:Hy,cmdConfig:zy}),_e}ea(he,xe);var Ve=he.prototype;return Ve.mergeMyTeamMembers=function(_e){var At=this;Qn(_e).call(_e,function(ar){var Dt=ar.teamId,vr=At.myTeamMembersMap.get(Dt),Cr=zr({},vr,ar);At.myTeamMembersMap.set(Dt,Cr)})},Ve.getTeamInfo=function(_e){return qn(this,void 0,void 0,_r.mark(function At(){var ar,Dt;return _r.wrap(function(Cr){for(;;)switch(Cr.prev=Cr.next){case 0:return Jn({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1}},_e),Cr.next=3,this.core.sendCmd("getTeamInfo",{teamId:_e.teamId});case 3:return ar=Cr.sent,Dt=ar.content.team,Cr.abrupt("return",el(Dt));case 6:case"end":return Cr.stop()}},At,this)}))},Ve.getTeams=function(){return qn(this,void 0,void 0,_r.mark(function _e(){var At,ar;return _r.wrap(function(vr){for(;;)switch(vr.prev=vr.next){case 0:return vr.next=2,this.core.sendCmd("getTeams",{timetag:0});case 2:return At=vr.sent,ar=At.content.teams,vr.abrupt("return",Hh(ar));case 5:case"end":return vr.stop()}},_e,this)}))},Ve.getTeamsById=function(_e){return qn(this,void 0,void 0,_r.mark(function At(){var ar,Dt;return _r.wrap(function(Cr){for(;;)switch(Cr.prev=Cr.next){case 0:return Jn({teamIds:{type:"array",itemType:"string"}},_e),Cr.next=3,this.core.sendCmd("getTeamsById",{teamIds:_e.teamIds});case 3:return ar=Cr.sent,Dt=Hh(ar.content.teams),Cr.abrupt("return",{teams:Dt,tids:ar.content.tids});case 6:case"end":return Cr.stop()}},At,this)}))},Ve.createTeam=function(_e){return qn(this,void 0,void 0,_r.mark(function At(){var ar,Dt,vr;return _r.wrap(function(Ar){for(;;)switch(Ar.prev=Ar.next){case 0:return Jn({type:{type:"enum",values:["advanced","normal"]},name:{type:"string",allowEmpty:!1},level:{type:"number",required:!1},accounts:{type:"array",itemType:"string",required:!1},ps:{type:"string",allowEmpty:!1,max:5e3,required:!1},joinMode:{type:"enum",values:["noVerify","needVerify","rejectAll"],required:!1},beInviteMode:{type:"enum",values:["noVerify","needVerify"],required:!1},inviteMode:{type:"enum",values:["manager","all"],required:!1},updateTeamMode:{type:"enum",values:["manager","all"],required:!1},updateExtMode:{type:"enum",values:["manager","all"],required:!1},intro:{type:"string",allowEmpty:!1,required:!1},announcement:{type:"string",allowEmpty:!1,required:!1},avatar:{type:"string",allowEmpty:!1,required:!1},ext:{type:"string",allowEmpty:!1,required:!1}},_e),ar=zh(_e),Ar.next=4,this.core.sendCmd("createTeam",{team:ar,accounts:_e.accounts||[],ps:_e.ps||""});case 4:return Dt=Ar.sent,vr=el(Dt.content.team),Ar.abrupt("return",vr);case 7:case"end":return Ar.stop()}},At,this)}))},Ve.dismissTeam=function(_e){return qn(this,void 0,void 0,_r.mark(function At(){return _r.wrap(function(Dt){for(;;)switch(Dt.prev=Dt.next){case 0:return Jn({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1}},_e),Dt.next=3,this.core.sendCmd("dismissTeam",{teamId:_e.teamId});case 3:case"end":return Dt.stop()}},At,this)}))},Ve.leaveTeam=function(_e){return qn(this,void 0,void 0,_r.mark(function At(){return _r.wrap(function(Dt){for(;;)switch(Dt.prev=Dt.next){case 0:return Jn({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1}},_e),Dt.next=3,this.core.sendCmd("leaveTeam",{teamId:_e.teamId});case 3:case"end":return Dt.stop()}},At,this)}))},Ve.transferTeam=function(_e){return qn(this,void 0,void 0,_r.mark(function At(){return _r.wrap(function(Dt){for(;;)switch(Dt.prev=Dt.next){case 0:return Jn({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1},account:{type:"string",allowEmpty:!1},leave:{type:"boolean"}},_e),Dt.next=3,this.core.sendCmd("transferTeam",_e);case 3:case"end":return Dt.stop()}},At,this)}))},Ve.updateTeamInfo=function(_e){return qn(this,void 0,void 0,_r.mark(function At(){var ar;return _r.wrap(function(vr){for(;;)switch(vr.prev=vr.next){case 0:return Jn({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1},joinMode:{type:"enum",values:["noVerify","needVerify","rejectAll"],required:!1},beInviteMode:{type:"enum",values:["noVerify","needVerify"],required:!1},inviteMode:{type:"enum",values:["manager","all"],required:!1},updateTeamMode:{type:"enum",values:["manager","all"],required:!1},updateExtMode:{type:"enum",values:["manager","all"],required:!1},intro:{type:"string",allowEmpty:!1,required:!1},announcement:{type:"string",allowEmpty:!1,required:!1},avatar:{type:"string",allowEmpty:!1,required:!1},ext:{type:"string",allowEmpty:!1,required:!1}},_e),ar=zh(_e),vr.next=4,this.core.sendCmd("updateTeamInfo",{team:ar});case 4:return vr.abrupt("return",el(ar));case 5:case"end":return vr.stop()}},At,this)}))},Ve.getTeamMembers=function(_e){var At;return qn(this,void 0,void 0,_r.mark(function ar(){var Dt,vr;return _r.wrap(function(Ar){for(;;)switch(Ar.prev=Ar.next){case 0:return Jn({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1},accounts:{type:"array",itemType:"string",required:!1}},_e),Ar.next=3,this.core.sendCmd("getTeamMembers",{teamId:_e.teamId,timetag:0});case 3:if(Dt=Ar.sent,vr=hf((At=Dt.content)===null||At===void 0?void 0:At.teamMembers),_e.accounts&&_e.accounts.length>0){Ar.next=7;break}return Ar.abrupt("return",vr);case 7:return Ar.abrupt("return",Bs(vr).call(vr,function($r){var jr;return(jr=_e.accounts)===null||jr===void 0?void 0:Wc(jr).call(jr,$r.account)}));case 8:case"end":return Ar.stop()}},ar,this)}))},Ve.getMutedTeamMembers=function(_e){return qn(this,void 0,void 0,_r.mark(function At(){var ar,Dt;return _r.wrap(function(Cr){for(;;)switch(Cr.prev=Cr.next){case 0:return Jn({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1}},_e),Cr.next=3,this.core.sendCmd("getMutedTeamMembers",{teamId:_e.teamId});case 3:return ar=Cr.sent,Dt=ar.content,Cr.abrupt("return",hf(Dt.teamMembers));case 6:case"end":return Cr.stop()}},At,this)}))},Ve.addTeamMembers=function(_e){return qn(this,void 0,void 0,_r.mark(function At(){return _r.wrap(function(Dt){for(;;)switch(Dt.prev=Dt.next){case 0:return Jn({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1},accounts:{type:"array",itemType:"string",min:1},ps:{type:"string",allowEmpty:!0,max:5e3,required:!1}},_e),Dt.next=3,this.core.sendCmd("addTeamMembers",{teamId:_e.teamId,accounts:_e.accounts,ps:_e.ps||"",attach:_e.ext||""});case 3:case"end":return Dt.stop()}},At,this)}))},Ve.removeTeamMembers=function(_e){return qn(this,void 0,void 0,_r.mark(function At(){return _r.wrap(function(Dt){for(;;)switch(Dt.prev=Dt.next){case 0:return Jn({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1},accounts:{type:"array",itemType:"string",min:1}},_e),Dt.next=3,this.core.sendCmd("removeTeamMembers",{teamId:_e.teamId,accounts:_e.accounts});case 3:case"end":return Dt.stop()}},At,this)}))},Ve.applyTeam=function(_e){return qn(this,void 0,void 0,_r.mark(function At(){var ar;return _r.wrap(function(vr){for(;;)switch(vr.prev=vr.next){case 0:return Jn({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1},ps:{type:"string",allowEmpty:!0,max:5e3,required:!1}},_e),vr.next=3,this.core.sendCmd("applyTeam",{teamId:_e.teamId,ps:_e.ps||""});case 3:return ar=vr.sent,vr.abrupt("return",el(ar.content.team));case 5:case"end":return vr.stop()}},At,this)}))},Ve.addTeamManagers=function(_e){return qn(this,void 0,void 0,_r.mark(function At(){return _r.wrap(function(Dt){for(;;)switch(Dt.prev=Dt.next){case 0:return Jn({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1},accounts:{type:"array",min:1,itemType:"string"}},_e),Dt.next=3,this.core.sendCmd("addTeamManagers",_e);case 3:case"end":return Dt.stop()}},At,this)}))},Ve.removeTeamManagers=function(_e){return qn(this,void 0,void 0,_r.mark(function At(){return _r.wrap(function(Dt){for(;;)switch(Dt.prev=Dt.next){case 0:return Jn({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1},accounts:{type:"array",min:1,itemType:"string"}},_e),Dt.next=3,this.core.sendCmd("removeTeamManagers",_e);case 3:case"end":return Dt.stop()}},At,this)}))},Ve.updateMyMemberInfo=function(_e){return qn(this,void 0,void 0,_r.mark(function At(){var ar,Dt,vr;return _r.wrap(function(Ar){for(;;)switch(Ar.prev=Ar.next){case 0:return Jn({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1},nickInTeam:{type:"string",allowEmpty:!1,required:!1},bitConfigMask:{type:"number",min:0,max:2,required:!1},ext:{type:"string",required:!1}},_e),ar=Vy({teamId:_e.teamId,nickInTeam:_e.nickInTeam,bitConfigMask:_e.bitConfigMask,ext:_e.ext}),Ar.next=4,this.core.sendCmd("updateMyMemberInfo",{teamMember:ar});case 4:return Dt=Xd(zr({updateTime:new Date().getTime(),account:this.core.account},ar)),this.mergeMyTeamMembers([Dt]),this.core.emit("updateTeamMember",Dt),vr=Dc(this.myTeamMembersMap.get(Dt.teamId)),this.core.emit("myTeamMembers",[vr]),Ar.abrupt("return",Dt);case 10:case"end":return Ar.stop()}},At,this)}))},Ve.updateMemberNick=function(_e){return qn(this,void 0,void 0,_r.mark(function At(){var ar,Dt;return _r.wrap(function(Cr){for(;;)switch(Cr.prev=Cr.next){case 0:return Jn({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1},account:{type:"string",allowEmpty:!1},nickInTeam:{type:"string",allowEmpty:!1}},_e),ar=Vy({teamId:_e.teamId,nickInTeam:_e.nickInTeam,account:_e.account}),Cr.next=4,this.core.sendCmd("updateNickInTeam",{teamMember:ar});case 4:return Dt=Xd(zr({updateTime:new Date().getTime()},ar)),Cr.abrupt("return",Dt);case 6:case"end":return Cr.stop()}},At,this)}))},Ve.muteTeamMember=function(_e){return qn(this,void 0,void 0,_r.mark(function At(){return _r.wrap(function(Dt){for(;;)switch(Dt.prev=Dt.next){case 0:return Jn({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1},account:{type:"string",allowEmpty:!1},mute:{type:"boolean"}},_e),Dt.next=3,this.core.sendCmd("muteTeamMember",{teamId:_e.teamId,account:_e.account,mute:_e.mute?1:0});case 3:case"end":return Dt.stop()}},At,this)}))},Ve.getTeamMemberInvitorAccid=function(_e){var At;return qn(this,void 0,void 0,_r.mark(function ar(){var Dt,vr;return _r.wrap(function(Ar){for(;;)switch(Ar.prev=Ar.next){case 0:return Jn({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1},accounts:{type:"array",itemType:"string",max:200}},_e),Dt={teamId:_e.teamId},_e.accounts&&_e.accounts.length>0&&(Dt.accounts=_e.accounts),Ar.next=5,this.core.sendCmd("getTeamMemberInvitorAccid",Dt);case 5:return vr=Ar.sent,Ar.abrupt("return",((At=vr.content)===null||At===void 0?void 0:At.accountsMap)||{});case 7:case"end":return Ar.stop()}},ar,this)}))},Ve.muteTeam=function(_e){return qn(this,void 0,void 0,_r.mark(function At(){return _r.wrap(function(Dt){for(;;)switch(Dt.prev=Dt.next){case 0:return Jn({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1},mute:{type:"boolean"}},_e),Dt.next=3,this.core.sendCmd("muteTeam",{teamId:_e.teamId,mute:_e.mute?1:0});case 3:case"end":return Dt.stop()}},At,this)}))},Ve.passTeamApply=function(_e){return qn(this,void 0,void 0,_r.mark(function At(){return _r.wrap(function(Dt){for(;;)switch(Dt.prev=Dt.next){case 0:return Jn({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1},from:{type:"string",allowEmpty:!1}},_e),Dt.next=3,this.core.sendCmd("passTeamApply",_e);case 3:case"end":return Dt.stop()}},At,this)}))},Ve.rejectTeamApply=function(_e){return qn(this,void 0,void 0,_r.mark(function At(){return _r.wrap(function(Dt){for(;;)switch(Dt.prev=Dt.next){case 0:return Jn({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1},from:{type:"string",allowEmpty:!1},ps:{type:"string",max:5e3,required:!1}},_e),Dt.next=3,this.core.sendCmd("rejectTeamApply",{teamId:_e.teamId,from:_e.from,ps:_e.ps||""});case 3:case"end":return Dt.stop()}},At,this)}))},Ve.acceptTeamInvite=function(_e){return qn(this,void 0,void 0,_r.mark(function At(){return _r.wrap(function(Dt){for(;;)switch(Dt.prev=Dt.next){case 0:return Jn({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1},from:{type:"string",allowEmpty:!1}},_e),Dt.next=3,this.core.sendCmd("acceptTeamInvite",_e);case 3:case"end":return Dt.stop()}},At,this)}))},Ve.rejectTeamInvite=function(_e){return qn(this,void 0,void 0,_r.mark(function At(){return _r.wrap(function(Dt){for(;;)switch(Dt.prev=Dt.next){case 0:return Jn({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1},from:{type:"string",allowEmpty:!1},ps:{type:"string",max:5e3,required:!1}},_e),Dt.next=3,this.core.sendCmd("rejectTeamInvite",{teamId:_e.teamId,from:_e.from,ps:_e.ps||""});case 3:case"end":return Dt.stop()}},At,this)}))},Ve.notifyTeamMsgReceiptsHandler=function(_e){var At,ar=(At=_e.content)===null||At===void 0?void 0:At.teamMsgReceipts;ar&&ar.length>0&&(this.core.emit("teamMsgReceipts",ar),this.core.emit("msgReceipts",ar))},Ve.syncTeamsHandler=function(_e){var At=_e.content;this.core.eventBus.emit("sync/updateTimetag",{teams:Uo(At.timetag)});var ar=At==null?void 0:At.teams;if(ar&&ar.length){var Dt=Hh(ar);this.core.emit("teams",Dt)}},Ve.syncCreateTeamHandler=function(_e){var At=_e.content,ar=el(At==null?void 0:At.team),Dt=qy(ar,ar.owner,"owner");this.core.emit("createTeam",ar,Dt)},Ve.syncUpdateTeamMemberHandler=function(_e){var At=_e.content,ar=Xd(At==null?void 0:At.teamMember);ar.updateTime||(ar.updateTime=new Date().getTime()),this.mergeMyTeamMembers([ar]),this.core.emit("updateTeamMember",ar);var Dt=Dc(this.myTeamMembersMap.get(ar.teamId));this.core.emit("myTeamMembers",[Dt])},Ve.syncMyTeamMembersHandler=function(_e){var At,ar=_e.content;this.core.eventBus.emit("sync/updateTimetag",{myTeamMembers:Uo(ar.timetag)});var Dt=ar==null?void 0:Fo(At=ar.teamMembers).call(At,function(vr){return Xd(vr)});this.mergeMyTeamMembers(Dt),this.core.emit("myTeamMembers",Dc(Dt))},Ve.notificationHandler=function(_e){var At=_e.attach,ar=_e.scene,Dt=_e.from,vr=_e.to,Cr=_e.time,Ar=_e.idServer,$r=_e.idClient,jr=At.team,Hr=At.account,Kr=At.accounts,Sn=At.type;if(ar==="team")switch(this.core.options.debugLevel==="debug"?this.logger.debug("team::recvNotification",Ar,$r,At):this.logger.log("team::recvNotification",Ar,$r,vr,Sn,Hr,Kr),Sn){case"updateTeam":jr.updateTime=Cr,this.core.emit("updateTeam",jr);break;case"addTeamMembers":this.service.notifyAddTeamMembers(jr,Kr);break;case"acceptTeamInvite":this.service.notifyAddTeamMembers(jr,[Dt]);break;case"passTeamApply":this.service.notifyAddTeamMembers(jr,[Hr]);break;case"addTeamManagers":this.service.notifyUpdateTeamManagers(vr,Kr,!0,Cr);break;case"removeTeamManagers":this.service.notifyUpdateTeamManagers(vr,Kr,!1,Cr);break;case"removeTeamMembers":this.service.notifyRemoveTeamMembers(jr,Kr);break;case"leaveTeam":this.service.notifyRemoveTeamMembers(jr,[Dt]);break;case"dismissTeam":this.core.emit("dismissTeam",{teamId:vr});break;case"transferTeam":this.service.notifyTransferTeam(jr,Dt,Hr);break;case"updateTeamMemberMute":this.service.notifyUpdateTeamMembersMute(jr,[Hr],At.mute)}},he}(Ps);(function(xe){xe[xe.none=0]="none",xe[xe.pass=1]="pass",xe[xe.decline=2]="decline",xe[xe.read=3]="read",xe[xe.deleted=4]="deleted",xe[xe.invalid=5]="invalid"})(sl||(sl={})),function(xe){xe[xe.default=0]="default",xe[xe.leave=1]="leave",xe[xe.roam=2]="roam"}(jc||(jc={}));var gp={applyTeam:0,rejectTeamApply:1,teamInvite:2,rejectTeamInvite:3,friendRequest:5,deleteFriend:6,recallMsgP2p:7,recallMsgTeam:8,recallMsgSuperTeam:12,deleteMsgP2pOneWay:13,deleteMsgTeamOneWay:14,applySuperTeam:15,rejectSuperTeamApply:16,superTeamInvite:17,rejectSuperTeamInvite:18,customP2p:100,customTeam:101,customSuperTeam:103},hp={1:"addFriend",2:"applyFriend",3:"passFriendApply",4:"rejectFriendApply"},Af={setting:{needSaveOffline:{type:"boolean"},isRoutable:{type:"boolean"},envConfig:{type:"string"}},antiSpamInfo:{needAntiSpam:{type:"boolean"},antiSpamContent:{type:"boolean"}},pushInfo:Kh,recallMessageInfo:{idClient:{type:"string",rawKey:"deletedIdClient"},idServer:{type:"string",rawKey:"deletedIdServer"},createTime:{type:"number",rawKey:"deletedMsgTime"},fromNick:{type:"string",rawKey:"deletedMsgFromNick"},opeAccount:{type:"string"}}};function vp(xe,he,Ve){var ze=+xe.type,_e=sc(gp,ze);Ve=Ve||jc.default;var At=zr(zr({},_i(Af,xe)),{type:_e,time:+xe.time,to:xe.to,from:xe.from,idServer:xe.idServer,state:sl[sl.none],feature:jc[Ve]});if(typeof At.attach=="string")try{At.attach=JSON.parse(At.attach)}catch(ar){he.error("formatSystemMessage: "+At.idServer+" parse attach error",ar&&ar.message)}return ze===5&&At.attach?(At.attach.type=hp[+At.attach.vt],At.attach.type==="passFriendApply"?At.state=sl[sl.pass]:At.attach.type==="rejectFriendApply"&&(At.state=sl[sl.decline])):ze<=3&&At.attach&&(At.attach=function(Dt){var vr=Dt.attach,Cr=Dt.tinfo,Ar=ri(Dt,["attach","tinfo"]);return Ar.ext=vr,Cr!==void 0&&(Ar.team=el(nc(Dt.tinfo,As.team))),Ar}(At.attach)),At}function LC(xe){var he=zr({},xe);return zr(zr({},Kd(Af,he)),{type:gp[he.type],to:he.to,attach:he.attach})}var $C={"4_6":"syncOfflineSysMsgs","4_18":"syncOfflineSysMsgs","4_19":"syncRecallMsgOfflineAndRoaming","4_101":"syncOfflineSysMsgs","7_3":"onSysMsg","7_7":"sendCustomSysMsg","7_14":"onRecallMsg","21_18":"onRecallMsg","21_117":"onRecallMsg","7_15":"syncRecallMsgOfflineAndRoaming","21_19":"onSysMsg","21_16":"sendSuperTeamCustomSysMsg","101_3":"onSysMsg","101_7":"sendFilterCustomSysMsg"},yp={sysMsg:zr({time:0,type:1,to:2,from:3,content:4,attach:5,idServer:6,needSaveOffline:7,deletedIdClient:10,deletedIdServer:11,needcAntiSpam:12,antiSpamContent:13,deletedMsgTime:14,deletedMsgFromNick:15,opeAccount:16,envConfig:21,callbackExt:22,isRoutable:105},Qy)},Kl=Is(yp),jC={onSysMsg:{service:"systemMessage",sid:7,cid:3,response:[{type:"Property",name:"sysMsg",reflectMapper:Kl.sysMsg}]},sendCustomSysMsg:{service:"systemMessage",sid:7,cid:7,params:[{type:"Property",name:"sysMsg",reflectMapper:yp.sysMsg}]},sendSuperTeamCustomSysMsg:{service:"systemMessage",sid:21,cid:16,params:[{type:"Property",name:"sysMsg",reflectMapper:yp.sysMsg}]},sendFilterCustomSysMsg:{service:"systemMessage",sid:101,cid:7,params:[{type:"Property",name:"sysMsg",reflectMapper:yp.sysMsg}]},batchMarkRead:{service:"systemMessage",sid:4,cid:5,isNoResponse:!0,params:[{type:"byte",name:"sid"},{type:"byte",name:"cid"},{type:"LongArray",name:"ids"}]},onRecallMsg:{sid:7,cid:14,service:"systemMessage",response:[{type:"Property",name:"sysMsg",reflectMapper:Kl.sysMsg}]},syncRecallMsgOfflineAndRoaming:{sid:7,cid:15,service:"systemMessage",response:[{type:"PropertyArray",name:"sysMsgs",reflectMapper:Kl.sysMsg},{type:"Number",name:"timetag"},{type:"Number",name:"type"}]},syncOfflineSysMsgs:{sid:4,cid:9,service:"systemMessage",response:[{type:"PropertyArray",name:"sysMsgs",reflectMapper:Kl.sysMsg}]}},DC=function(xe){function he(ze){var _e;return(_e=xe.call(this,"systemMessage",ze)||this).sysMsgUnread={total:0,friend:0,msg:0,team:0,superTeam:0},_e.core.eventBus.on("logined",function(){_e.initEventListeners()}),ps({cmdMap:$C,cmdConfig:jC}),_e}ea(he,xe);var Ve=he.prototype;return Ve.initEventListeners=function(){var _e=this;this.core.eventBus.on("systemMessage/passFriendApply",function(At){_e.core.emit("updateSystemMessages",[{idServer:At.idServer,from:At.account,state:"pass",type:"friendRequest"}])}),this.core.eventBus.on("systemMessage/rejectFriendApply",function(At){_e.core.emit("updateSystemMessages",[{idServer:At.idServer,from:At.account,state:"decline",type:"friendRequest"}])})},Ve.doMarkSysMsgAck=function(_e){var At=[],ar=[],Dt=["applySuperTeam","rejectSuperTeamApply","superTeamInvite","rejectSuperTeamInvite","customSuperTeam"];Qn(_e).call(_e,function(vr){vr.idServer&&(Wc(Dt).call(Dt,vr.type)?ar.push(vr.idServer):At.push(vr.idServer))}),At.length>0&&this.core.sendCmd("batchMarkRead",{sid:"7",cid:"3",ids:At}),ar.length>0&&this.core.sendCmd("batchMarkRead",{sid:"21",cid:"19",ids:ar})},Ve.sendCustomSysMsg=function(_e){var At=this;Jn({to:{type:"string",allowEmpty:!1},type:{type:"enum",values:["customP2p","customTeam","customSuperTeam"]},attach:{type:"string",allowEmpty:!1},setting:{type:"object",rules:{needSaveOffline:{type:"boolean",required:!1},env:{type:"string",allowEmpty:!1,required:!1}},required:!1},pushInfo:{type:"object",required:!1,rules:Kh}},_e);var ar=_e.type==="customSuperTeam"?"sendSuperTeamCustomSysMsg":"sendCustomSysMsg";return this.core.sendCmd(ar,{sysMsg:LC(_e)}).then(function(){At.logger.log("sendCustomSysMsg success")}).catch(function(Dt){throw At.logger.error("sendCustomSysMsg failed",Dt.message),Dt})},Ve.onSysMsgHandler=function(_e){var At,ar=(At=_e.content)===null||At===void 0?void 0:At.sysMsg;if(ar){var Dt=typeof oi(_e,"raw.r[0]")=="number"?""+_e.raw.r[0]:void 0;ar.idServer=ar.idServer||Dt;var vr=vp(ar,this.logger,jc.default);this.core.emit("sysMsg",vr),this.doMarkSysMsgAck([vr])}else this.logger.warn("onSysMsg no content.sysMsg")},Ve.syncOfflineSysMsgsHandler=function(_e){var At,ar=this;if(_e.content.sysMsgs&&_e.content.sysMsgs.length>0){var Dt=Fo(At=_e.content.sysMsgs).call(At,function(vr){return vp(vr,ar.logger,jc.leave)});this.core.emit("syncSysMsgs",Dt),this.doMarkSysMsgAck(Dt)}},Ve.onRecallMsgHandler=function(_e){var At,ar=(At=_e.content)===null||At===void 0?void 0:At.sysMsg;if(ar){var Dt=typeof oi(_e,"raw.r[0]")=="number"?""+_e.raw.r[0]:void 0;ar.idServer=ar.idServer||Dt;var vr=ep([ar],function($r){return $r===gp.recallMsgP2p?"p2p":$r===gp.recallMsgTeam?"team":$r===gp.recallMsgSuperTeam?"superTeam":""}(+ar.type));this.core.eventBus.emit("session/updateForDeletedMsg",vr);var Cr=vp(ar,this.logger,jc.default);this.core.emit("sysMsg",Cr),this.doMarkSysMsgAck([Cr])}else this.logger.warn("onSysMsg no content.sysMsg")},Ve.syncRecallMsgOfflineAndRoamingHandler=function(_e){var At=this,ar=_e.content,Dt=ar.timetag,vr=ar.type,Cr=ar.sysMsgs,Ar=Uo(vr),$r=Ar===1?jc.leave:jc.roam,jr=Fo(Cr).call(Cr,function(Hr){return vp(Hr,At.logger,$r)});Ar===1&&this.doMarkSysMsgAck(jr),this.core.eventBus.emit("sync/updateTimetag",{recallMsg:Dt}),this.core.emit("syncSysMsgs",jr)},he}(Ps);function bp(xe){var he=["bitsExtension","createTime","updateTime","passRelationShip","relationShip","source"],Ve=zr({},xe);return Qn(he).call(he,function(ze){Ve[ze]!==void 0&&(Ve[ze]=Uo(Ve[ze]))}),Ve.relationShip!==void 0&&(Ve.valid=Ve.relationShip===1),Ve}var UC={1:"addFriend",2:"applyFriend",3:"passFriendApply",4:"rejectFriendApply"},fv={"12_4":"getFriends","12_1":"friendReuqest","12_2":"deleteFriend","12_3":"updateFriend","12_5":"syncFriends","12_6":"syncFriendUsers","12_101":"syncFriendRequest","12_102":"syncDeleteFriend","12_103":"syncUpdateFriend"},Nf={updateFriendTag:{account:4,alias:8,ext:10},delFriendParams:{delAlias:1},friendTag:{account:4,relationShip:5,passRelationShip:6,source:7,alias:8,bitsExtension:9,ext:10,createTime:11,updateTime:12,serverex:13},userTag:{account:1,nick:3,avatar:4,sign:5,gender:6,email:7,birth:8,tel:9,ext:10,createTime:12,updateTime:13}},Of=Is(Nf),yb={getFriends:{sid:12,cid:4,service:"friend",params:[{type:"Long",name:"timetag"}],response:[{type:"PropertyArray",name:"friends",reflectMapper:Of.friendTag},{type:"Number",name:"timetag"}]},friendReuqest:{sid:12,cid:1,service:"friend",params:[{type:"String",name:"account"},{type:"Byte",name:"type"},{type:"String",name:"ps"}]},deleteFriend:{sid:12,cid:2,service:"friend",params:[{type:"String",name:"account"},{type:"Property",name:"delFriendParams",reflectMapper:Nf.delFriendParams}]},updateFriend:{sid:12,cid:3,service:"friend",params:[{type:"Property",name:"updateFriendTag",reflectMapper:Nf.updateFriendTag}]},syncFriends:{sid:12,cid:5,service:"friend",response:[{type:"PropertyArray",name:"friends",entity:"friendTag",reflectMapper:Of.friendTag},{type:"Number",name:"timetag"}]},syncFriendUsers:{sid:12,cid:6,service:"friend",response:[{type:"PropertyArray",name:"users",entity:"userTag",reflectMapper:Of.userTag},{type:"Number",name:"timetag"}]},syncFriendRequest:{sid:12,cid:101,service:"friend",params:[{type:"String",name:"account"},{type:"Number",name:"type"},{type:"String",name:"ps"}],response:[{type:"String",name:"account"},{type:"Number",name:"type"},{type:"String",name:"ps"}]},syncDeleteFriend:{sid:12,cid:102,service:"friend",response:[{type:"String",name:"account"}]},syncUpdateFriend:{sid:12,cid:103,service:"friend",response:[{type:"Property",name:"friend",reflectMapper:Of.friendTag}]}},VC=function(xe){function he(ze){var _e;return _e=xe.call(this,"friend",ze)||this,ps({cmdMap:fv,cmdConfig:yb}),_e}ea(he,xe);var Ve=he.prototype;return Ve.getFriends=function(){var _e;return qn(this,void 0,void 0,_r.mark(function At(){var ar,Dt;return _r.wrap(function(Cr){for(;;)switch(Cr.prev=Cr.next){case 0:return Cr.next=2,this.core.sendCmd("getFriends",{timetag:0});case 2:return ar=Cr.sent,Dt=((_e=ar.content)===null||_e===void 0?void 0:_e.friends)||[],Dt=Fo(Dt).call(Dt,function(Ar){return bp(Ar)}),Cr.abrupt("return",Dt);case 6:case"end":return Cr.stop()}},At,this)}))},Ve.addFriend=function(_e){return qn(this,void 0,void 0,_r.mark(function At(){var ar;return _r.wrap(function(vr){for(;;)switch(vr.prev=vr.next){case 0:return Jn({account:{type:"string",allowEmpty:!1},ps:{type:"string",allowEmpty:!1,required:!1}},_e),vr.next=3,this.core.sendCmd("friendReuqest",{account:_e.account,type:1,ps:_e.ps||""});case 3:return ar=new Date().getTime(),vr.abrupt("return",{account:_e.account,createTime:ar,updateTime:ar,valid:!0,source:0,passRelationShip:1,relationShip:1,bitsExtension:0});case 5:case"end":return vr.stop()}},At,this)}))},Ve.applyFriend=function(_e){return qn(this,void 0,void 0,_r.mark(function At(){return _r.wrap(function(Dt){for(;;)switch(Dt.prev=Dt.next){case 0:return Jn({account:{type:"string",allowEmpty:!1}},_e),Dt.next=3,this.core.sendCmd("friendReuqest",{account:_e.account,type:2,ps:_e.ps||""});case 3:case"end":return Dt.stop()}},At,this)}))},Ve.passFriendApply=function(_e){return qn(this,void 0,void 0,_r.mark(function At(){var ar=this;return _r.wrap(function(vr){for(;;)switch(vr.prev=vr.next){case 0:return Jn({account:{type:"string",allowEmpty:!1}},_e),vr.next=3,this.core.sendCmd("friendReuqest",{account:_e.account,type:3,ps:_e.ps||""}).then(function(Cr){return ar.core.eventBus.emit("systemMessage/passFriendApply",_e),Cr});case 3:case"end":return vr.stop()}},At,this)}))},Ve.rejectFriendApply=function(_e){return qn(this,void 0,void 0,_r.mark(function At(){var ar=this;return _r.wrap(function(vr){for(;;)switch(vr.prev=vr.next){case 0:return Jn({account:{type:"string",allowEmpty:!1}},_e),vr.next=3,this.core.sendCmd("friendReuqest",{account:_e.account,type:4,ps:_e.ps||""}).then(function(Cr){return ar.core.eventBus.emit("systemMessage/rejectFriendApply",_e),Cr});case 3:case"end":return vr.stop()}},At,this)}))},Ve.deleteFriend=function(_e){return qn(this,void 0,void 0,_r.mark(function At(){return _r.wrap(function(Dt){for(;;)switch(Dt.prev=Dt.next){case 0:return Jn({account:{type:"string",allowEmpty:!1},delAlias:{type:"boolean"}},_e),Dt.next=3,this.core.sendCmd("deleteFriend",{account:_e.account,delFriendParams:{delAlias:_e.delAlias===!0?1:0}});case 3:case"end":return Dt.stop()}},At,this)}))},Ve.updateFriend=function(_e){return qn(this,void 0,void 0,_r.mark(function At(){return _r.wrap(function(Dt){for(;;)switch(Dt.prev=Dt.next){case 0:return Jn({account:{type:"string",allowEmpty:!1},alias:{type:"string"},ext:{type:"string",required:!1}},_e),Dt.next=3,this.core.sendCmd("updateFriend",{updateFriendTag:_e});case 3:case"end":return Dt.stop()}},At,this)}))},Ve.syncFriendRequestHandler=function(_e){var At=function(Dt){var vr=zr({},Dt);try{vr.ps=vr.ps&&JSON.parse(vr.ps)}catch{}if(vr.type=UC[vr.type],vr.type==="addFriend"||vr.type==="passFriendApply"){var Cr=new Date().getTime();vr.friend={account:Dt.account,alias:"",createTime:Cr,ext:"",updateTime:Cr,valid:!0}}return vr}(_e.content);this.core.emit("syncFriend",At)},Ve.syncDeleteFriendHandler=function(_e){var At=_e.content.account;this.logger.log("friend::emit syncFriendAction: deleteFriend "+At),this.core.emit("syncFriend",{type:"deleteFriend",account:At})},Ve.syncUpdateFriendHandler=function(_e){var At=bp(_e.content.friend);this.logger.log("friend::emit syncFriendAction: updateFriend, ",At==null?void 0:At.account),this.core.emit("syncFriend",{type:"updateFriend",friend:At})},Ve.syncFriendsHandler=function(_e){var At=_e.content;this.core.eventBus.emit("sync/updateTimetag",{friends:Uo(At.timetag)});var ar=At==null?void 0:At.friends;if(ar&&ar.length){var Dt=Fo(ar).call(ar,function(vr){return bp(vr)});this.core.emit("friends",Dt)}},Ve.syncFriendUsersHandler=function(_e){var At=_e.content;this.core.eventBus.emit("sync/updateTimetag",{friendUsers:Uo(At.timetag)});var ar=At==null?void 0:At.users;if(ar&&ar.length){var Dt=Fo(ar).call(ar,function(vr){return yu(vr)});this.core.emit("users",Dt)}},he}(Ps),mv={1:"Android",2:"iOS",4:"PC",8:"WindowsPhone",16:"Web",32:"Server",64:"Mac"};function bb(xe){return xe&&xe.length>0?Fo(xe).call(xe,function(he){return function(ze){var _e=zr({},ze),At=["subscribeTime","time"];return Qn(At).call(At,function(ar){_e[ar]&&(_e[ar]=Uo(_e[ar]))}),_e}(he)}):[]}function il(xe){if(!xe)return xe;var he=xe.serverExt,Ve=ri(xe,["serverExt"]),ze=["time","type","value"];if(Qn(ze).call(ze,function(_e){Ve[_e]&&(Ve[_e]=Uo(Ve[_e]))}),Ve.clientType&&(Ve.clientType=mv[Ve.clientType]||""),he)try{Ve.ext=JSON.parse(he),typeof Ve.ext[0]=="string"&&(Ve.ext=Ve.ext[0])}catch{}return Ve}var Sb={"14_1":"publishEvent","14_2":"pushEvent","14_3":"subscribeEvent","14_4":"unSubscribeEventsByAccounts","14_5":"unSubscribeEventsByType","14_6":"querySubscribeEventsByAccounts","14_7":"querySubscribeEventsByType","14_9":"pushEvents"},Ql={msgEvent:{type:1,value:2,idClient:3,ext:4,validTime:5,broadcastType:6,sync:7,validTimeType:8,durable:9,time:10,idServer:11,clientType:12,serverConfig:13,serverExt:14,appid:101,account:103,enableMultiClient:104,consid:106},msgEventSubscribe:{type:1,subscribeTime:2,sync:3,to:102,from:104,time:105}},Iu=Is(Ql),qC={publishEvent:{sid:14,cid:1,service:"event",params:[{type:"Property",name:"msgEvent",reflectMapper:Ql.msgEvent}],response:[{type:"Property",name:"msgEvent",reflectMapper:Iu.msgEvent}]},pushEvent:{sid:14,cid:2,service:"event",response:[{type:"Property",name:"msgEvent",reflectMapper:Iu.msgEvent}]},subscribeEvent:{sid:14,cid:3,service:"event",params:[{type:"Property",name:"msgEventSubscribe",reflectMapper:Ql.msgEventSubscribe},{type:"StrArray",name:"accounts"}],response:[{type:"StrArray",name:"accounts"}]},unSubscribeEventsByAccounts:{sid:14,cid:4,service:"event",params:[{type:"Property",name:"msgEventSubscribe",reflectMapper:Ql.msgEventSubscribe},{type:"StrArray",name:"accounts"}],response:[{type:"StrArray",name:"accounts"}]},unSubscribeEventsByType:{sid:14,cid:5,service:"event",params:[{type:"Property",name:"msgEventSubscribe",reflectMapper:Ql.msgEventSubscribe}]},querySubscribeEventsByAccounts:{sid:14,cid:6,service:"event",params:[{type:"Property",name:"msgEventSubscribe",reflectMapper:Ql.msgEventSubscribe},{type:"StrArray",name:"accounts"}],response:[{type:"PropertyArray",name:"msgEventSubscribes",reflectMapper:Iu.msgEventSubscribe}]},querySubscribeEventsByType:{sid:14,cid:7,service:"event",params:[{type:"Property",name:"msgEventSubscribe",reflectMapper:Ql.msgEventSubscribe}],response:[{type:"PropertyArray",name:"msgEventSubscribes",reflectMapper:Iu.msgEventSubscribe}]},pushEvents:{sid:14,cid:9,service:"event",response:[{type:"PropertyArray",name:"msgEvents",reflectMapper:Iu.msgEvent}]}},pe=function(xe){function he(ze){var _e;return _e=xe.call(this,"event",ze)||this,ps({cmdMap:Sb,cmdConfig:qC}),_e}ea(he,xe);var Ve=he.prototype;return Ve.publishEvent=function(_e){var At;return qn(this,void 0,void 0,_r.mark(function ar(){var Dt,vr,Cr;return _r.wrap(function($r){for(;;)switch($r.prev=$r.next){case 0:return Jn({type:{type:"number"},value:{type:"number"},ext:{type:"string",required:!1},validTime:{type:"number",min:60,max:2592e3,required:!1},broadcastType:{type:"number",required:!1},sync:{type:"boolean",required:!1}},_e),Dt=zr(zr({validTime:604800},_e),{idClient:ef(),sync:_e.sync===!0?1:0}),$r.next=4,this.core.sendCmd("publishEvent",{msgEvent:Dt});case 4:return vr=$r.sent,Cr=((At=vr.content)===null||At===void 0?void 0:At.msgEvent)||{},$r.abrupt("return",il(Cr));case 7:case"end":return $r.stop()}},ar,this)}))},Ve.subscribeEvent=function(_e){var At;return qn(this,void 0,void 0,_r.mark(function ar(){var Dt,vr,Cr;return _r.wrap(function($r){for(;;)switch($r.prev=$r.next){case 0:return Jn({type:{type:"number"},accounts:{type:"array",itemType:"string",max:100},subscribeTime:{type:"number",min:60,max:2592e3,required:!1}},_e),Dt=zr(zr({subscribeTime:2592e3},_e),{sync:_e.sync===!0?1:0}),$r.next=4,this.core.sendCmd("subscribeEvent",{msgEventSubscribe:Dt,accounts:_e.accounts});case 4:return vr=$r.sent,Cr=((At=vr.content)===null||At===void 0?void 0:At.accounts)||[],$r.abrupt("return",{failedAccounts:Cr});case 7:case"end":return $r.stop()}},ar,this)}))},Ve.unSubscribeEvents=function(_e){var At;return qn(this,void 0,void 0,_r.mark(function ar(){var Dt,vr,Cr;return _r.wrap(function($r){for(;;)switch($r.prev=$r.next){case 0:if(Jn({type:{type:"number"},accounts:{type:"array",itemType:"string",max:100,required:!1}},_e),Dt={type:_e.type},!(_e.accounts&&_e.accounts.length>0)){$r.next=9;break}return $r.next=5,this.core.sendCmd("unSubscribeEventsByAccounts",{msgEventSubscribe:Dt,accounts:_e.accounts});case 5:Cr=$r.sent,vr=((At=Cr.content)===null||At===void 0?void 0:At.accounts)||[],$r.next=12;break;case 9:return $r.next=11,this.core.sendCmd("unSubscribeEventsByType",{msgEventSubscribe:Dt});case 11:vr=[];case 12:return $r.abrupt("return",{failedAccounts:vr});case 13:case"end":return $r.stop()}},ar,this)}))},Ve.querySubscribeEvents=function(_e){var At;return qn(this,void 0,void 0,_r.mark(function ar(){var Dt;return _r.wrap(function(Cr){for(;;)switch(Cr.prev=Cr.next){case 0:if(Jn({type:{type:"number"},accounts:{type:"array",itemType:"string",max:100,required:!1}},_e),!(_e.accounts&&_e.accounts.length>0)){Cr.next=7;break}return Cr.next=4,this.core.sendCmd("querySubscribeEventsByAccounts",{msgEventSubscribe:{type:_e.type},accounts:_e.accounts});case 4:Dt=Cr.sent,Cr.next=10;break;case 7:return Cr.next=9,this.core.sendCmd("querySubscribeEventsByType",{msgEventSubscribe:{type:_e.type}});case 9:Dt=Cr.sent;case 10:return Cr.abrupt("return",bb((At=Dt.content)===null||At===void 0?void 0:At.msgEventSubscribes));case 11:case"end":return Cr.stop()}},ar,this)}))},Ve.pushEventHandler=function(_e){var At,ar=((At=_e.content)===null||At===void 0?void 0:At.msgEvent)||{};this.core.emit("pushEvents",[il(ar)])},Ve.pushEventsHandler=function(_e){var At,ar=((At=_e.content)===null||At===void 0?void 0:At.msgEvents)||{};this.core.emit("pushEvents",function(vr){return Hi(vr)&&vr.length>0?Fo(vr).call(vr,function(Cr){return il(Cr)}):[]}(ar))},he}(Ps);function Ne(xe){var he={scene:Uh[xe.scene],from:xe.threadMsgFromAccount,to:xe.threadMsgToAccount,time:xe.threadMsgTime,idServer:xe.threadMsgIdServer},Ve={limit:xe.limit<100?xe.limit:100,beginTime:typeof xe.beginTime=="number"?xe.beginTime:0,reverse:Yl(xe)===!0?1:0};return xe.lastMsgId&&(Ve.lastMsgId=xe.lastMsgId),{msg:he,threadMsgReq:Ve}}var kt,$e={"23_1":"getThreadMsgs","23_2":"getMsgsByIdServer"},Oe={msg:is,threadMsgReq:{beginTime:1,endTime:2,lastMsgId:3,limit:4,reverse:5},threadMsgsMeta:{total:1,lastMsgTime:2}},Lt=Is(Oe),rr={getThreadMsgs:{sid:23,cid:1,service:"msgExtend",params:[{type:"Property",name:"msg",reflectMapper:Oe.msg},{type:"Property",name:"threadMsgReq",reflectMapper:Oe.threadMsgReq}],response:[{type:"Property",name:"threadMsg",reflectMapper:Lt.msg},{type:"Property",name:"threadMsgsMeta",reflectMapper:Lt.threadMsgsMeta},{type:"PropertyArray",name:"msgs",reflectMapper:Lt.msg}]},getMsgsByIdServer:{sid:23,cid:2,service:"msgExtend",params:[{type:"PropertyArray",name:"reqMsgs",reflectMapper:Oe.msg}],response:[{type:"PropertyArray",name:"msgs",reflectMapper:Lt.msg}]}},Pt=function(xe){function he(ze){var _e;return _e=xe.call(this,"msgExtend",ze)||this,ps({cmdMap:$e,cmdConfig:rr}),_e}ea(he,xe);var Ve=he.prototype;return Ve.getThreadMsgs=function(_e){var At;return qn(this,void 0,void 0,_r.mark(function ar(){var Dt,vr,Cr,Ar,$r,jr,Hr;return _r.wrap(function(Sn){for(;;)switch(Sn.prev=Sn.next){case 0:return Jn({scene:{type:"enum",values:Wi(us)},threadMsgFromAccount:{type:"string",allowEmpty:!1},threadMsgIdServer:{type:"string",allowEmpty:!1},threadMsgTime:{type:"number"},threadMsgToAccount:{type:"string",allowEmpty:!1},beginTime:{type:"number",required:!1},endTime:{type:"number",required:!1},lastMsgId:{type:"string",allowEmpty:!1,required:!1},limit:{type:"number",min:1,max:100,required:!1},reverse:{type:"boolean",required:!1}},_e),Sn.next=3,this.core.sendCmd("getThreadMsgs",Ne(_e));case 3:return Dt=Sn.sent,vr=Dt.content,Cr=vr.msgs,Ar=vr.threadMsg,$r=Dt.content.threadMsgsMeta,jr=Ki(Ar,this.core.account),Hr=(At=this.core.session)===null||At===void 0?void 0:At.getSessionWithUncomplete({id:jr}),Cr=Zd(Cr,Hr?{account:this.core.account,sessionAck:Hr.ack,msgReceiptTime:Hr.msgReceiptTime}:{account:this.core.account}),Ar=lc(Ar,Hr?{account:this.core.account,sessionAck:Hr.ack,msgReceiptTime:Hr.msgReceiptTime}:{account:this.core.account}),Sn.abrupt("return",{msgs:Cr,threadMsg:Ar,total:Uo($r.total),timetag:Uo($r.lastMsgTime)});case 11:case"end":return Sn.stop()}},ar,this)}))},Ve.getMsgsByIdServer=function(_e){return qn(this,void 0,void 0,_r.mark(function At(){var ar,Dt,vr,Cr,Ar=this;return _r.wrap(function(jr){for(;;)switch(jr.prev=jr.next){case 0:return Jn({reqMsgs:{type:"array",rules:{scene:{type:"enum",values:Wi(us)},from:{type:"string",allowEmpty:!1},to:{type:"string",allowEmpty:!1},idServer:{type:"string",allowEmpty:!1},time:{type:"number"}},min:1,max:100}},_e),jr.next=3,this.core.sendCmd("getMsgsByIdServer",{reqMsgs:Fo(ar=_e.reqMsgs).call(ar,function(Hr){return zr(zr({},Hr),{scene:sc(us,Hr.scene)})})});case 3:return vr=jr.sent,Cr=Fo(Dt=vr.content.msgs).call(Dt,function(Hr){var Kr,Sn=Ki(Hr,Ar.core.account),Cn=(Kr=Ar.core.session)===null||Kr===void 0?void 0:Kr.getSessionWithUncomplete({id:Sn});return lc(Hr,Cn?{account:Ar.core.account,sessionAck:Cn.ack,msgReceiptTime:Cn.msgReceiptTime}:{account:Ar.core.account})}),jr.abrupt("return",Cr);case 6:case"end":return jr.stop()}},At,this)}))},he}(Ps);(function(xe){xe[xe.ASC=1]="ASC",xe[xe.DESC=2]="DESC"})(kt||(kt={}));var pr,yr={"7_6":"getHistoryMsgs","7_9":"deleteRoamingMsgs","4_24":"syncClearServerHistoryMsgs","7_18":"clearHistoryMsgsFromServer","7_118":"multiSyncClearServerHistoryMsgs","7_26":"nimFtsCloudMsgLogsAggWithSession","7_27":"nimFtsCloudMsgLogs"},Pr={msg:is,clearHistoryMsgsFromServerReqTag:{type:0,otherAccid:1,isDeleteRoam:2,toTid:3,isSyncSelf:4,ext:7},clearMsgsParamsWithSync:{type:0,otherAccid:1,isDeleteRoam:2,toTid:3,isSyncSelf:4,fromAccid:5,time:6,ext:7},ftsReqTag:{keyword:1,fromTime:2,toTime:3,sessionLimit:4,msglogsLimit:5,orderRule:6,p2pSessionList:7,teamSessionList:8,senderList:9,msgTypeList:10,msgSubTypeList:11}},Rr=Is(Pr),Vr={deleteRoamingMsgs:{sid:7,cid:9,service:"msgLog",params:[{type:"StrArray",name:"ids"}]},getHistoryMsgs:{sid:7,cid:6,params:[{type:"String",name:"to"},{type:"Long",name:"beginTime"},{type:"Long",name:"endTime"},{type:"Long",name:"lastMsgId"},{type:"int",name:"limit"},{type:"bool",name:"reverse"},{type:"LongArray",name:"msgTypes"}],response:[{type:"PropertyArray",name:"msgs",reflectMapper:Rr.msg}],service:"msgLog"},clearHistoryMsgsFromServer:{sid:7,cid:18,params:[{type:"Property",name:"clearHistoryMsgsFromServerReqTag",reflectMapper:Pr.clearHistoryMsgsFromServerReqTag}],response:[{type:"Long",name:"timetag"}],service:"msgLog"},multiSyncClearServerHistoryMsgs:{sid:7,cid:118,response:[{type:"Property",name:"data",reflectMapper:Rr.clearMsgsParamsWithSync}],service:"msgLog"},syncClearServerHistoryMsgs:{sid:4,cid:24,service:"msgLog",response:[{type:"PropertyArray",name:"datas",reflectMapper:Rr.clearMsgsParamsWithSync}]},nimFtsCloudMsgLogsAggWithSession:{sid:7,cid:26,service:"msgLog",params:[{type:"Property",name:"tag",reflectMapper:Pr.ftsReqTag}],response:[{type:"PropertyArray",name:"datas",reflectMapper:Rr.msg}]},nimFtsCloudMsgLogs:{sid:7,cid:27,service:"msgLog",params:[{type:"Property",name:"tag",reflectMapper:Pr.ftsReqTag}],response:[{type:"PropertyArray",name:"datas",reflectMapper:Rr.msg}]}};(function(xe){xe[xe.p2p=1]="p2p",xe[xe.team=2]="team"})(pr||(pr={}));var Dr={type:{type:"enum",values:pr},isDeleteRoam:{type:"boolean"},isSyncSelf:{type:"boolean"},time:{type:"number"}};function Xr(xe){var he=_i(Dr,xe);return{sessionId:he.type==="p2p"?"p2p-"+he.otherAccid:"team-"+he.toTid,time:he.time}}var kn={orderRule:{type:"enum",values:kt}};function Tn(xe){var he,Ve=_i(kn,xe);Hi(Ve.msgTypeList)&&(Ve.msgTypeList=Fo(he=Ve.msgTypeList).call(he,function(_e){return Nc[_e]}).join(","));var ze=["p2pSessionList","teamSessionList","senderList","msgSubTypeList"];return Qn(ze).call(ze,function(_e){Hi(Ve[_e])&&(Ve[_e]=Ve[_e].join(","))}),Ve}var Dn=function(xe){function he(ze){var _e;return _e=xe.call(this,"msgLog",ze)||this,ps({cmdMap:yr,cmdConfig:Vr}),_e}ea(he,xe);var Ve=he.prototype;return Ve.deleteRoamingMsgs=function(_e){return qn(this,void 0,void 0,_r.mark(function At(){var ar,Dt;return _r.wrap(function(Cr){for(;;)switch(Cr.prev=Cr.next){case 0:Jn({ids:{type:"array",itemType:"string"}},_e),ar=[],Cr.prev=2,ar=Fo(Dt=_e.ids).call(Dt,function(Ar){var $r=na(Ar);return $r.scene+"|"+$r.accid}),Cr.next=10;break;case 6:throw Cr.prev=6,Cr.t0=Cr.catch(2),this.logger.error("Failed to delete roaming msgs with "+_e.ids,Cr.t0),new Error("Failed to create session with "+_e.ids);case 10:return Cr.next=12,this.core.sendCmd("deleteRoamingMsgs",{ids:ar});case 12:case"end":return Cr.stop()}},At,this,[[2,6]])}))},Ve.getHistoryMsgs=function(_e){var At,ar;return qn(this,void 0,void 0,_r.mark(function Dt(){var vr,Cr,Ar,$r,jr,Hr,Kr;return _r.wrap(function(Cn){for(;;)switch(Cn.prev=Cn.next){case 0:return!((At=this.core.sync)===null||At===void 0)&&At.getSyncDoneFlag()||this.logger.warn("Please call getHistoryMsgs after syncdone event"),Jn({scene:{type:"enum",values:la(Uh)},to:{type:"string",allowEmpty:!1},beginTime:{type:"number",required:!1},endTime:{type:"number",required:!1},limit:{type:"number",min:1,max:100,required:!1},reverse:{type:"boolean",required:!1},lastMsgId:{type:"string",required:!1,allowEmpty:!1},asc:{type:"boolean",required:!1},msgTypes:{type:"array",itemType:"string",required:!1}},_e),Cr=_e.scene==="p2p"?"getHistoryMsgs":_e.scene==="team"?"getHistoryTeamMsgs":"getHistorySuperTeamMsgs",Cn.next=5,this.core.sendCmd(Cr,zr(zr({beginTime:0,endTime:0,lastMsgId:0,limit:100,reverse:!1},_e),{msgTypes:_e.msgTypes?Fo(vr=_e.msgTypes).call(vr,function(Pn){return Dh[Pn]}):[]}));case 5:if(Ar=Cn.sent,($r=Ar.content).msgs&&$r.msgs.length>0){Cn.next=9;break}return Cn.abrupt("return",[]);case 9:if(jr=Ki($r.msgs[0],this.core.account),Hr=(ar=this.core.session)===null||ar===void 0?void 0:ar.getSessionWithUncomplete({id:jr}),Kr=Zd($r.msgs,Hr?{account:this.core.account,sessionAck:Hr.ack,msgReceiptTime:Hr.msgReceiptTime}:{account:this.core.account}),_e.asc!==!0){Cn.next=14;break}return Cn.abrupt("return",Zc(Kr).call(Kr,function(Pn,En){return Pn.time-En.time}));case 14:return Cn.abrupt("return",Kr);case 15:case"end":return Cn.stop()}},Dt,this)}))},Ve.clearHistoryMsgsFromServer=function(_e){return qn(this,void 0,void 0,_r.mark(function At(){var ar,Dt,vr;return _r.wrap(function(Ar){for(;;)switch(Ar.prev=Ar.next){case 0:return Jn({scene:{type:"enum",values:["p2p","team"]},to:{type:"string",allowEmpty:!1},ext:{type:"string",required:!1},isSyncSelf:{type:"boolean",required:!1}},_e),(ar=zr(zr({isDeleteRoam:1},_e),{type:_e.scene==="team"?2:1,isSyncSelf:_e.isSyncSelf===!0?1:0}))[ar.type===2?"toTid":"otherAccid"]=_e.to,Ar.next=5,this.core.sendCmd("clearHistoryMsgsFromServer",{clearHistoryMsgsFromServerReqTag:ar});case 5:return Dt=Ar.sent,vr=Dt.content,this.core.eventBus.emit("session/updateForClearMsg",[{sessionId:_e.scene+"-"+_e.to}],!0),Ar.abrupt("return",vr);case 9:case"end":return Ar.stop()}},At,this)}))},Ve.multiSyncClearServerHistoryMsgsHandler=function(_e){var At=Xr(_e.content.data);this.core.eventBus.emit("session/updateForClearMsg",[At],!0),this.core.emit("clearServerHistoryMsgs",[At])},Ve.ftsCloudMsgLogs=function(_e){return qn(this,void 0,void 0,_r.mark(function At(){return _r.wrap(function(Dt){for(;;)switch(Dt.prev=Dt.next){case 0:return Dt.abrupt("return",this.baseFtsCloudMsgLogs(_e,"nimFtsCloudMsgLogs"));case 1:case"end":return Dt.stop()}},At,this)}))},Ve.ftsCloudMsgLogsAggWithSession=function(_e){return qn(this,void 0,void 0,_r.mark(function At(){return _r.wrap(function(Dt){for(;;)switch(Dt.prev=Dt.next){case 0:return Dt.abrupt("return",this.baseFtsCloudMsgLogs(_e,"nimFtsCloudMsgLogsAggWithSession"));case 1:case"end":return Dt.stop()}},At,this)}))},Ve.baseFtsCloudMsgLogs=function(_e,At){return qn(this,void 0,void 0,_r.mark(function ar(){var Dt,vr,Cr,Ar=this;return _r.wrap(function(jr){for(;;)switch(jr.prev=jr.next){case 0:if(Jn({keyword:{type:"string",allowEmpty:!1},fromTime:{type:"number",required:!1},toTime:{type:"number",required:!1},sessionLimit:{type:"number",required:!1},msglogsLimit:{type:"number",required:!1},orderRule:{type:"enum",values:Wi(kt),required:!1},p2pSessionList:{type:"array",itemType:"string",required:!1},teamSessionList:{type:"array",itemType:"string",required:!1},senderList:{type:"array",itemType:"string",required:!1},msgTypeList:{type:"array",itemType:"enum",values:Wi(Nc),required:!1},msgSubTypeList:{type:"array",itemType:"number",required:!1}},_e),!(_e.fromTime&&_e.toTime&&_e.toTime<_e.fromTime)){jr.next=3;break}throw new Bo("Request parameter error: toTime should be greater than fromTime",_e,"");case 3:return vr=Tn(_e),jr.next=6,this.core.sendCmd(At,{tag:vr});case 6:return Cr=jr.sent,jr.abrupt("return",Fo(Dt=Cr.content.datas).call(Dt,function(Hr){var Kr,Sn=Ki(Hr,Ar.core.account),Cn=(Kr=Ar.core.session)===null||Kr===void 0?void 0:Kr.getSessionWithUncomplete({id:Sn});return lc(Hr,Cn?{account:Ar.core.account,sessionAck:Cn.ack,msgReceiptTime:Cn.msgReceiptTime}:{account:Ar.core.account})}));case 8:case"end":return jr.stop()}},ar,this)}))},Ve.syncClearServerHistoryMsgsHandler=function(_e){var At=function(Dt){return Hi(Dt)&&Dt.length>0?Fo(Dt).call(Dt,function(vr){return Xr(vr)}):[]}(_e.content.datas);this.core.emit("clearServerHistoryMsgs",At)},he}(Ps),Fn={"22_1":"requestProxy","22_2":"onRequestProxy"},Gn={requestProxyTag:{zone:1,path:2,method:3,header:4,body:5},requestProxyMsgTag:{from:1,body:2,time:3}},$n=Is(Gn),ho={requestProxy:{sid:22,cid:1,service:"passThrough",params:[{type:"Property",name:"requestProxyTag",reflectMapper:Gn.requestProxyTag}],response:[{type:"Property",name:"requestProxyTag",reflectMapper:$n.requestProxyTag}]},onRequestProxy:{sid:22,cid:2,service:"passThrough",response:[{type:"Property",name:"proxyMsg",reflectMapper:$n.requestProxyMsgTag}]}},co=function(xe){function he(ze){var _e;return(_e=xe.call(this,"passThrough",ze)||this).core=ze,ps({cmdMap:Fn,cmdConfig:ho}),_e}ea(he,xe);var Ve=he.prototype;return Ve.request=function(_e){return Jn({path:{type:"string",allowEmpty:!1}},_e),this.core.sendCmd("requestProxy",{requestProxyTag:_e}).then(function(At){return At.content.proxyTag})},Ve.onRequestProxyHandler=function(_e){var At=_e.content.proxyMsg;At&&At.time&&(At.time=+At.time),this.core.emit("proxyMsg",At)},he}(Ps),oa=Ws.some,so=fi("some");xn({target:"Array",proto:!0,forced:!so},{some:function(he){return oa(this,he,arguments.length>1?arguments[1]:void 0)}});var Gr=sa("Array").some,Kn=Array.prototype,ro=function(xe){var he=xe.some;return xe===Kn||sr(Kn,xe)&&he===Kn.some?Gr:he},Hn,Ln,eo=function(he,Ve){if(he==null)return{};var ze=ah(db(he),function(_e){return[_e]});return Ve=wu(Ve),Zy(he,ze,function(_e,At){return Ve(_e,At[0])})},lo={"6_2":"getNosToken","6_22":"getOriginUrl","6_26":"getNosCdnHost","6_27":"getGrayscaleConfig","6_28":"getMixStorePolicy","6_29":"getMixStoreToken","6_30":"getFileAuthToken"},So={nosToken:{objectName:1,token:2,bucket:3,expireTime:4,expireSec:7,tag:8,shortUrl:9},mixStoreTokenReqTag:{provider:0,tokenCount:1,fileExpireSec:2,tag:3,returnBody:4},nosConfigTag:{bucket:1,cdnDomain:2,expire:3,objectNamePrefix:4},grayConfigTag:{config:0,ttl:1},mixStorePolicyTag:{providers:0,ttl:1,mixEnable:2,nosPolicy:3,s3Policy:4},mixStoreTokenResTag:{provider:0,accessKeyId:1,secretAccessKey:2,sessionToken:3,token:4,expireTime:5,bucket:6,objectName:7,fileExpireSec:8,tag:9,shortUrl:10,region:11},nosSafeUrlTag:{safeUrl:0,originUrl:1},mixStoreAuthTokenReqTag:{type:1,urls:2},mixStoreAuthTokenResTag:{type:1,tokens:2,token:3,ttl:4}},Co=Is(So),aa={getNosToken:{sid:6,cid:2,service:"cloudStorage",response:[{type:"Property",name:"nosToken",reflectMapper:Co.nosToken}],params:[{type:"String",name:"responseBody"},{type:"Property",name:"nosToken",entity:"nosToken",reflectMapper:So.nosToken}]},getOriginUrl:{sid:6,cid:22,service:"cloudStorage",response:[{type:"Property",name:"nosSafeUrlTag",reflectMapper:Co.nosSafeUrlTag}],params:[{type:"Property",name:"nosSafeUrlTag",reflectMapper:So.nosSafeUrlTag}]},getNosCdnHost:{sid:6,cid:26,service:"misc",response:[{type:"Property",name:"nosConfigTag",reflectMapper:Co.nosConfigTag}]},getGrayscaleConfig:{sid:6,cid:27,service:"cloudStorage",response:[{type:"Property",name:"grayConfigTag",reflectMapper:Co.grayConfigTag}],params:[{type:"Property",name:"config"}]},getMixStorePolicy:{sid:6,cid:28,service:"cloudStorage",params:[{type:"LongArray",name:"supportType"}],response:[{type:"Property",name:"mixStorePolicyTag",reflectMapper:Co.mixStorePolicyTag}]},getMixStoreToken:{sid:6,cid:29,service:"cloudStorage",params:[{type:"Property",name:"mixStoreTokenReqTag",reflectMapper:So.mixStoreTokenReqTag}],response:[{type:"Property",name:"mixStoreTokenResTag",reflectMapper:Co.mixStoreTokenResTag}]},getFileAuthToken:{sid:6,cid:30,service:"cloudStorage",params:[{type:"Property",name:"mixStoreAuthTokenReqTag",reflectMapper:So.mixStoreAuthTokenReqTag}],response:[{type:"Property",name:"mixStoreAuthTokenResTag",reflectMapper:Co.mixStoreAuthTokenResTag}]}};(function(xe){xe[xe.nos=1]="nos",xe[xe.s3=2]="s3"})(Hn||(Hn={})),function(xe){xe[xe.dontNeed=-1]="dontNeed",xe[xe.time=2]="time",xe[xe.urls=3]="urls"}(Ln||(Ln={}));var No,Sa,Lo={chunkUploadHost:"https://wanproxy-web.127.net",commonUploadHost:"https://nos.netease.com",chunkMaxSize:4194304e4,commonMaxSize:104857600,uploadReplaceFormat:"https://{host}/{object}",cdn:{defaultCdnDomain:"nim.nosdn.127.net",cdnDomain:"",bucket:"",objectNamePrefix:""},downloadUrl:"https://{bucket}-nosdn.netease.im/{object}",downloadHostList:["nos.netease.com"],nosCdnEnable:!0,isNeedToGetUploadPolicyFromServer:!0},Wo={file:{md5:"$(Etag)",size:"$(ObjectSize)"},image:{md5:"$(Etag)",size:"$(ObjectSize)",w:"$(ImageInfo.Width)",h:"$(ImageInfo.Height)",orientation:"$(ImageInfo.Orientation)"},audio:{md5:"$(Etag)",size:"$(ObjectSize)",dur:"$(AVinfo.Audio.Duration)"},video:{md5:"$(Etag)",size:"$(ObjectSize)",dur:"$(AVinfo.Video.Duration)",w:"$(AVinfo.Video.Width)",h:"$(AVinfo.Video.Height)"}},Ta={accessKeyId:"",secretAccessKey:"",sessionToken:"",region:"",maxRetries:0,bucket:"",objectName:"",token:"",shortUrl:""};function Yi(xe){return xe===void 0&&(xe="file"),fa(Wo[xe]||{}).replace(/"/gi,'\\"')}(function(xe){xe[xe.nos=1]="nos",xe[xe.s3=2]="s3"})(No||(No={})),function(xe){xe[xe.dontNeed=-1]="dontNeed",xe[xe.time=2]="time",xe[xe.urls=3]="urls"}(Sa||(Sa={}));var Qo=function(){function xe(Ve,ze){ze===void 0&&(ze={}),this.GRAYKEY="AllGrayscaleConfig",this.MIXSTOREKEY="AllMixStorePolicy",this.config={},this.nosCdnHostTimer=0,this.grayConfig={mixStoreEnable:!1,timeStamp:0,ttl:0},this.mixStorePolicy={providers:[],timeStamp:0,ttl:0,s3Policy:null,nosPolicy:null},this.curProvider=No.nos,this.s3=null,this.mixStoreErrorCount=10,this.nosErrorCount=0,this.circuitTimer=0,this.name="cloudStorage",this.logger=Ve.logger,this.core=Ve,ps({cmdMap:lo,cmdConfig:aa}),this.setOptions(ze)}var he=xe.prototype;return he.setOptions=function(ze){ze===void 0&&(ze={});var _e=ze.storageKeyPrefix||"NIMClient";this.GRAYKEY=_e+"-AllGrayscaleConfig",this.MIXSTOREKEY=_e+"-AllMixStorePolicy";var At=ze.s3,ar=ri(ze,["s3"]),Dt=zr({},Lo,this.config);if(ar&&Object.prototype.hasOwnProperty.call(ar,"cdn")){var vr={cdn:zr(zr({},Dt.cdn),ar.cdn)};this.config=zr({},Dt,ar,vr)}else this.config=zr({},Dt,ar);At&&(this.s3=At)},he.init=function(){return qn(this,void 0,void 0,_r.mark(function ze(){return _r.wrap(function(At){for(;;)switch(At.prev=At.next){case 0:if(this.grayConfig=null,this.mixStorePolicy={providers:[],timeStamp:0,ttl:0,s3Policy:null,nosPolicy:null},this.curProvider=No.nos,this.mixStoreErrorCount=10,!this.config.isNeedToGetUploadPolicyFromServer){At.next=9;break}return At.next=7,this.getGrayscaleConfig(this.core.options.appkey);case 7:return At.next=9,this.getNosCdnHost();case 9:case"end":return At.stop()}},ze,this)}))},he.uploadFile=function(ze){return qn(this,void 0,void 0,_r.mark(function _e(){var At,ar,Dt;return _r.wrap(function(Cr){for(;;)switch(Cr.prev=Cr.next){case 0:if(Jn({maxSize:{type:"number",required:!1},type:{type:"enum",values:["file","image","audio","video"]}},ze),ze.fileInput||ze.file||ze.filePath){Cr.next=3;break}throw new Error("uploadFile needs target file object or a filePath");case 3:if(!ze.type||ze.type==="file"){Cr.next=7;break}if(typeof(At=oi(ze,"file.type"))!="string"||Ja(At).call(At,ze.type)!==-1){Cr.next=7;break}throw new Error('The meta type "'+At+'" does not match "'+ze.type+'"');case 7:if(this.grayConfig&&this.grayConfig.mixStoreEnable&&this.mixStorePolicy.providers.length){Cr.next=10;break}return this.logger.log("uploadFile:: uploadFile begin, use old nos"),Cr.abrupt("return",this.nosUpload(ze));case 10:return this.logger.log("uploadFile:: uploadFile begin,Current settings grayConfig mixStoreEnable:"+this.grayConfig.mixStoreEnable+" curProvider:"+this.curProvider),this.s3||(this.curProvider=No.nos),ar=Ta,Cr.prev=13,Cr.next=16,this.core.sendCmd("getMixStoreToken",{mixStoreTokenReqTag:{provider:this.curProvider,tokenCount:1,tag:"qchat",returnBody:Yi(ze.type)}});case 16:Dt=Cr.sent,ar=Dt.content.mixStoreTokenResTag,Cr.next=24;break;case 20:throw Cr.prev=20,Cr.t0=Cr.catch(13),this.core.logger.error("uploadFile:: getMixStoreToken error",Cr.t0),new ru("getMixStoreToken error",Cr.t0,this.curProvider,this.mixStorePolicy);case 24:return Cr.abrupt("return",this.curProvider===No.s3?this.s3Upload(ze,ar):this.nosUpload(ze,ar));case 25:case"end":return Cr.stop()}},_e,this,[[13,20]])}))},he.nosUpload=function(ze,_e){var At,ar;return qn(this,void 0,void 0,_r.mark(function Dt(){var vr,Cr,Ar,$r,jr,Hr,Kr,Sn,Cn,Pn,En,Nn,zn;return _r.wrap(function(fo){for(;;)switch(fo.prev=fo.next){case 0:if(vr=oi(this.core,"config.cdn.bucket"),Cr={tag:ze.nosScenes||vr||"nim",expireSec:ze.nosSurvivalTime},_e){fo.next=13;break}return fo.prev=3,fo.next=6,this.core.sendCmd("getNosToken",{responseBody:Yi(ze.type),nosToken:Cr});case 6:Ar=fo.sent,fo.next=13;break;case 9:throw fo.prev=9,fo.t0=fo.catch(3),this.core.logger.error("uploadFile:: getNosToken error",fo.t0),new ru("getNosToken error",fo.t0,1);case 13:return fo.prev=13,jr=Ar?Ar.content.nosToken:_e,this.core.logger.debug("uploadFile:: uploadFile params",{nosToken:jr,chunkUploadHost:this.config.chunkUploadHost,commonUploadHost:this.config.commonUploadHost,platform:ua.platform}),fo.next=18,this.core.adapters.uploadFile(zr(zr({},ze),{nosToken:jr,chunkUploadHost:this.config.chunkUploadHost,commonUploadHost:this.config.commonUploadHost,maxSize:ze.maxSize||this.config.chunkMaxSize}));case 18:$r=fo.sent,fo.next=42;break;case 21:if(fo.prev=21,fo.t1=fo.catch(13),this.core.logger.error("uploadFile::nos uploadFile error",fo.t1),!_e){fo.next=41;break}if(this.nosErrorCount!==0){fo.next=37;break}fo.prev=26,this._addCircuitTimer(),fo.next=33;break;case 30:throw fo.prev=30,fo.t2=fo.catch(26),new ru("upload file error",fo.t2,this.curProvider,this.mixStorePolicy,ze.file||ze.filePath);case 33:return this.nosErrorCount=(At=this.mixStorePolicy.nosPolicy)===null||At===void 0?void 0:At.uploadConfig.retryPolicy.retry,fo.abrupt("return",this.uploadFile(ze));case 37:return this.nosErrorCount--,fo.abrupt("return",this.nosUpload(ze,_e));case 39:fo.next=42;break;case 41:throw new ru("nos uploadFile error",fo.t1,1);case 42:if(Hr=$r==null?void 0:$r.type,Kr=Hr&&Ja(Hr).call(Hr,"/")>-1?$o(Hr).call(Hr,0,Ja(Hr).call(Hr,"/")):"",Sn={image:"imageInfo",video:"vinfo",audio:"vinfo"},Cn=this.config.uploadReplaceFormat.replace("{host}",this.config.cdn.cdnDomain||this.config.cdn.defaultCdnDomain).replace("{object}",Ar?Ar.content.nosToken.objectName:_e==null?void 0:_e.objectName),_e&&_e.shortUrl&&(Cn=_e.shortUrl),Sn[Kr]){fo.next=49;break}return fo.abrupt("return",zr({url:Cn},$r));case 49:if(fo.prev=49,!(Ja(Cn).call(Cn,"_im_url=1")<0)){fo.next=54;break}return fo.next=53,this.core.adapters.request(Cn+"?"+Sn[Kr],{method:"GET",dataType:"json",timeout:5e3});case 53:Pn=fo.sent;case 54:fo.next=60;break;case 56:return fo.prev=56,fo.t3=fo.catch(49),this.core.logger.error("uploadFile:: fetch file info error",fo.t3),fo.abrupt("return",zr({url:Cn},$r));case 60:if(!Pn){fo.next=67;break}return En=Pn.data,Nn=Sn[Kr]==="imageInfo"?En:(ar=En==null?void 0:En.GetVideoInfo)===null||ar===void 0?void 0:ar.VideoInfo,zn={url:Cn,name:$r.name,size:$r.size,ext:$r.ext,w:Nn.Width,h:Nn.Height,orientation:Nn.Orientation,dur:Nn.Duration,audioCodec:Nn.AudioCodec,videoCodec:Nn.VideoCodec,container:Nn.Container},fo.abrupt("return",eo(zn,function(qo,ao){return ao!==void 0}));case 67:return fo.abrupt("return",zr({url:Cn},$r));case 68:case"end":return fo.stop()}},Dt,this,[[3,9],[13,21],[26,30],[49,56]])}))},he.getNosCdnHost=function(){var ze;return qn(this,void 0,void 0,_r.mark(function _e(){var At,ar,Dt,vr=this;return _r.wrap(function(Ar){for(;;)switch(Ar.prev=Ar.next){case 0:return Ar.prev=0,Ar.next=3,this.core.sendCmd("getNosCdnHost");case 3:At=Ar.sent,Ar.next=10;break;case 6:return Ar.prev=6,Ar.t0=Ar.catch(0),this.logger.error("getNosCdnHost::error",Ar.t0),Ar.abrupt("return");case 10:if(At){Ar.next=12;break}return Ar.abrupt("return");case 12:ar=(ze=At==null?void 0:At.content)===null||ze===void 0?void 0:ze.nosConfigTag,(Dt=Uo(ar==null?void 0:ar.expire))!==0&&ar.cdnDomain?Dt===-1?(this.config.cdn.bucket=ar.bucket,this.config.cdn.cdnDomain=ar.cdnDomain,this.config.cdn.objectNamePrefix=ar.objectNamePrefix):(this.config.cdn.bucket=ar.bucket,this.config.cdn.cdnDomain=ar.cdnDomain,this.config.cdn.objectNamePrefix=ar.objectNamePrefix,this.nosCdnHostTimer=this.core.timerManager.addTimer(function(){vr.getNosCdnHost()},1e3*Dt)):(this.config.cdn.bucket="",this.config.cdn.cdnDomain="",this.config.cdn.objectNamePrefix="");case 15:case"end":return Ar.stop()}},_e,this,[[0,6]])}))},he.getGrayscaleConfig=function(ze){var _e;return qn(this,void 0,void 0,_r.mark(function At(){var ar,Dt;return _r.wrap(function(Cr){for(;;)switch(Cr.prev=Cr.next){case 0:if(ua.localStorage)try{ua.localStorage.getItem&&ua.localStorage.getItem(this.GRAYKEY)&&(this.grayConfig=JSON.parse(ua.localStorage.getItem(this.GRAYKEY))[ze])}catch(Ar){ua.localStorage.getItem(this.GRAYKEY)&&this.core.logger.error("uploadFile:: JSON.parse grayscaleConfig error ",Ar)}if(this.grayConfig&&!(this.grayConfig.timeStamp+1e3*this.grayConfig.ttl<new Date().getTime())){Cr.next=17;break}return Cr.next=4,this.core.sendCmd("getGrayscaleConfig",{config:{}});case 4:if(!(ar=Cr.sent).content||!ar.content.grayConfigTag){Cr.next=16;break}this.logger.log("uploadFile::getAppGrayConfigRequest success ");try{this.grayConfig=JSON.parse(ar.content.grayConfigTag.config),this.grayConfig.ttl=JSON.parse(ar.content.grayConfigTag.ttl)}catch(Ar){this.logger.error("getGrayscaleConfig error",Ar)}if(this.grayConfig){Cr.next=10;break}return Cr.abrupt("return");case 10:Dt=ua.localStorage.getItem(this.GRAYKEY)?JSON.parse(ua.localStorage.getItem(this.GRAYKEY)):{},this.grayConfig.timeStamp=new Date().getTime(),Dt[ze]=this.grayConfig,ua.localStorage.setItem(this.GRAYKEY,fa(Dt)),Cr.next=17;break;case 16:this.logger.debug("uploadFile:: result grayConfig:",ar.content);case 17:if(!(!((_e=this.grayConfig)===null||_e===void 0)&&_e.mixStoreEnable)){Cr.next=20;break}return Cr.next=20,this._getMixStorePolicy(ze);case 20:case"end":return Cr.stop()}},At,this)}))},he._getMixStorePolicy=function(ze){return qn(this,void 0,void 0,_r.mark(function _e(){var At,ar,Dt,vr,Cr,Ar,$r;return _r.wrap(function(Hr){for(;;)switch(Hr.prev=Hr.next){case 0:if(At=new Date().getTime(),ua.localStorage)try{this.mixStorePolicy=JSON.parse(ua.localStorage.getItem(this.MIXSTOREKEY))[ze],this.curProvider=Uo(this.mixStorePolicy.providers[0]),this.mixStorePolicy.timeStamp&&this.mixStorePolicy.timeStamp+1e3*this.mixStorePolicy.ttl>At&&(Dt=this.mixStorePolicy.timeStamp+1e3*this.mixStorePolicy.ttl-At,this.core.timerManager.addTimer(Zo(ar=this._getMixStorePolicy).call(ar,this,ze),Dt))}catch(Kr){ua.localStorage.getItem(this.MIXSTOREKEY)&&JSON.parse(ua.localStorage.getItem(this.MIXSTOREKEY))[ze]&&this.core.logger.error("uploadFile:: JSON.parse mixStorePolicy error ",Kr)}if(this.mixStorePolicy&&!(this.mixStorePolicy.timeStamp+1e3*this.mixStorePolicy.ttl<=At)){Hr.next=30;break}return Hr.prev=3,Hr.next=6,this.core.sendCmd("getMixStorePolicy",{supportType:this.s3?[1,2]:[1]});case 6:Cr=Hr.sent,Ar=Cr.content.mixStorePolicyTag,this.mixStorePolicy={providers:[],timeStamp:0,ttl:0,s3Policy:null,nosPolicy:null},this.mixStorePolicy.ttl=Number(Ar.ttl),this.mixStorePolicy.providers=Ar.providers.split(","),this.circuitTimer&&this.core.timerManager.deleteTimer(this.circuitTimer),this.curProvider=Uo(this.mixStorePolicy.providers[0]),this.mixStorePolicy.nosPolicy=Ar.nosPolicy?JSON.parse(Ar.nosPolicy):null,this.mixStorePolicy.s3Policy=Ar.s3Policy?JSON.parse(Ar.s3Policy):null,this.mixStorePolicy.s3Policy===null?this.mixStorePolicy.providers=["1"]:this.mixStorePolicy.nosPolicy===null?this.mixStorePolicy.providers=["2"]:this.mixStorePolicy.providers=this.mixStorePolicy.s3Policy.priority<this.mixStorePolicy.nosPolicy.priority?["2","1"]:["1","2"],this.core.timerManager.addTimer(Zo(vr=this._getMixStorePolicy).call(vr,this,ze),1e3*this.mixStorePolicy.ttl),$r=ua.localStorage.getItem(this.MIXSTOREKEY)?JSON.parse(ua.localStorage.getItem(this.MIXSTOREKEY)):{},this.mixStorePolicy.timeStamp=new Date().getTime(),$r[ze]=this.mixStorePolicy,ua.localStorage.setItem(this.MIXSTOREKEY,fa($r)),Hr.next=30;break;case 23:if(Hr.prev=23,Hr.t0=Hr.catch(3),this.logger.error("getMixStorePolicy error",Hr.t0),this.mixStoreErrorCount!==0){Hr.next=28;break}throw new Error("getMixStorePolicy all count error");case 28:this._getMixStorePolicy(ze),this.mixStoreErrorCount--;case 30:this.mixStorePolicy.nosPolicy&&(this.nosErrorCount=this.mixStorePolicy.nosPolicy.uploadConfig.retryPolicy.retry);case 31:case"end":return Hr.stop()}},_e,this,[[3,23]])}))},he.s3Upload=function(ze,_e){return qn(this,void 0,void 0,_r.mark(function At(){var ar,Dt,vr,Cr,Ar,$r,jr,Hr,Kr,Sn,Cn=this;return _r.wrap(function(En){for(;;)switch(En.prev=En.next){case 0:if(!ze.file){En.next=4;break}ar=ze.file,En.next=19;break;case 4:if(typeof ze.fileInput!="string"){En.next=14;break}if(this.logger.warn("fileInput will abandon,Please use file or filepath"),!((Dt=document.getElementById(ze.fileInput))&&Dt.files&&Dt.files[0])){En.next=11;break}ar=Dt.files[0],En.next=12;break;case 11:throw new Error("Can not get file from fileInput");case 12:En.next=19;break;case 14:if(!(ze.fileInput&&ze.fileInput.files&&ze.fileInput.files[0])){En.next=18;break}ar=ze.fileInput.files[0],En.next=19;break;case 18:throw new Error("Can not get file from fileInput "+ze.fileInput);case 19:if(this.mixStorePolicy.s3Policy){En.next=21;break}throw new Error("dont get s3 policy");case 21:return vr={accessKeyId:_e.accessKeyId,secretAccessKey:_e.secretAccessKey,sessionToken:_e.sessionToken,region:_e.region,maxRetries:this.mixStorePolicy.s3Policy.uploadConfig.retryPolicy.retry},Cr=this.s3,(Ar=new Cr).config.update(vr),$r=decodeURIComponent(_e.bucket),jr=decodeURIComponent(_e.objectName),Kr={Bucket:$r,Key:jr,Body:Hr=ar,Metadata:{token:_e.token},ContentType:Hr.type||"application/octet-stream"},this.core.logger.debug("uploadFile:: s3 upload params:",Kr),Sn=Ar.upload(Kr),En.abrupt("return",new xo(function(Nn){var zn=new Date().getTime();Sn.send(function(yo,fo){var qo,ao;if(yo){Cn.logger.error("uploadFile:","api::s3:upload file failed",yo),Cn.core.reporter.reportTraceStart("exceptions",{user_id:Cn.core.options.account,trace_id:(ao=(qo=Cn.core)===null||qo===void 0?void 0:qo.socket)===null||ao===void 0?void 0:ao.sessionId,start_time:zn,action:1}),Cn.core.reporter.reportTraceUpdateV2("exceptions",{code:typeof yo.status=="number"?yo.status:typeof yo.code=="number"?yo.code:0,description:yo.message||""+yo.code,operation_type:1,target:yo.hostname}),Cn.core.reporter.reportTraceEnd("exceptions",1);try{Cn._addCircuitTimer()}catch(Yn){throw new ru("upload file error",Yn,Cn.curProvider,Cn.mixStorePolicy,ze.file||ze.filePath)}Nn(Cn.uploadFile(ze))}else{var Wr=Cn.mixStorePolicy.s3Policy.cdnSchema;Wr=(Wr=Wr.replace("{cdnDomain}",Cn.mixStorePolicy.s3Policy.dlcdn)).replace("{objectName}",fo.Key),Nn({size:Hr.size,name:Hr.name,url:_e.shortUrl?_e.shortUrl:Wr,ext:Hr.name.split(".")[1]||"unknown"})}})}));case 32:case"end":return En.stop()}},At,this)}))},he.getPrivateUrl=function(ze){var _e;if(!new RegExp(/http(s)?:\/\/([\w-]+\.)+[\w-]+(\/[\w- ./?%&=]*)?/).test(ze))return this.logger.error("illegal file url:"+ze),"";var At=/^(?:([A-Za-z]+):)?(\/{0,3})([0-9.\-A-Za-z]+)(?::(\d+))?(?:\/([^?#]*))?(?:\?([^#]*))?(?:#(.*))?$/.exec(ze);At[0];var ar=At[1];At[2];var Dt=At[3];At[4];var vr=At[5];if(At[6],At[7],(_e=this.grayConfig)===null||_e===void 0?void 0:_e.mixStoreEnable){var Cr=this._getUrlType(ze);return Cr===No.s3&&this.mixStorePolicy.s3Policy&&(ze=this.mixStorePolicy.s3Policy.cdnSchema.replace("{cdnDomain}",this.mixStorePolicy.s3Policy.dlcdn).replace("{objectName}",vr)),Cr===No.nos&&this.mixStorePolicy.nosPolicy&&(ze=this.mixStorePolicy.nosPolicy.cdnSchema.replace("{cdnDomain}",this.mixStorePolicy.nosPolicy.dlcdn).replace("{objectName}",vr)),ze}var Ar=this.config,$r=Ar.downloadUrl,jr=Ar.downloadHostList,Hr=Ar.nosCdnEnable,Kr=this.config.cdn.cdnDomain,Sn=this.config.cdn.objectNamePrefix?decodeURIComponent(this.config.cdn.objectNamePrefix):"",Cn=decodeURIComponent(vr),Pn=Ja(Cn).call(Cn,Sn);if(Kr&&Pn>-1&&Hr)return""+ar+Kr+"/"+$o(Cn).call(Cn,Pn);if(Wc(jr).call(jr,Dt)&&Wc(vr).call(vr,"/")){var En=Ja(vr).call(vr,"/"),Nn=vr.substring(0,En),zn=vr.substring(En+1);return $r.replace("{bucket}",Nn).replace("{object}",zn)}var yo=Bs(jr).call(jr,function(qo){return typeof Dt=="string"&&Wc(Dt).call(Dt,qo)})[0],fo=yo?Dt.replace(yo,"").replace(/\W/g,""):null;return fo?$r.replace("{bucket}",fo).replace("{object}",vr):ze},he.getOriginUrl=function(ze){return qn(this,void 0,void 0,_r.mark(function _e(){var At;return _r.wrap(function(Dt){for(;;)switch(Dt.prev=Dt.next){case 0:return Dt.next=2,this.core.sendCmd("getOriginUrl",{nosSafeUrlTag:{safeUrl:ze}});case 2:return At=Dt.sent,Dt.abrupt("return",At.content.nosSafeUrlTag.originUrl);case 4:case"end":return Dt.stop()}},_e,this)}))},he.getFileToken=function(ze){return qn(this,void 0,void 0,_r.mark(function _e(){var At,ar,Dt,vr,Cr,Ar=this;return _r.wrap(function(jr){for(;;)switch(jr.prev=jr.next){case 0:if(Jn({type:{type:"number",min:2,max:3},urls:{type:"array",required:!1,itemType:"string"}},ze),At=this.mixStorePolicy.nosPolicy?this.mixStorePolicy.nosPolicy.authPolicy.policyType:null,ar=this.mixStorePolicy.s3Policy?this.mixStorePolicy.s3Policy.authPolicy.policyType:null,At!==String(Sa.dontNeed)||ar!==String(Sa.dontNeed)){jr.next=8;break}throw this.logger.error("don't need token"),new Error("don't need token");case 8:if(ze.type!==Sa.time){jr.next=17;break}if(!(At&&Ja(At).call(At,String(Sa.time))>=0||ar&&Ja(ar).call(ar,String(Sa.time))>0)){jr.next=13;break}return jr.abrupt("return",this.getFileAuthToken(ze));case 13:throw this.logger.error("don't support time token "),new Error("don't support type time token ");case 15:jr.next=33;break;case 17:if(ze.urls&&ze.urls.length){jr.next=20;break}throw this.logger.error("urls is required when urls token"),new Error("urls is required when urls token");case 20:if(vr=[],Cr=[],Qn(Dt=ze.urls).call(Dt,function(Hr){var Kr=Ar._getUrlType(Hr);Kr===No.nos&&Cr.push(Hr),Kr===No.s3&&vr.push(Hr)}),(!ar||vr.length!==0&&Ja(ar).call(ar,String(Sa.urls))<0)&&(this.logger.warn("s3 url don't support url token"),vr=[]),(!At||Cr.length!==0&&Ja(At).call(At,String(Sa.urls))<0)&&(this.logger.warn("nos url don't support url token"),Cr=[]),vr.length!==0||Cr.length!==0){jr.next=30;break}throw this.logger.error("not support urls"),new Error("not support urls");case 30:if(vr.length!==0&&Cr.length!==0){jr.next=33;break}return ze.urls=fa(ze.urls),jr.abrupt("return",this.getFileAuthToken(ze));case 33:case"end":return jr.stop()}},_e,this)}))},he.getFileAuthToken=function(ze){return qn(this,void 0,void 0,_r.mark(function _e(){var At;return _r.wrap(function(Dt){for(;;)switch(Dt.prev=Dt.next){case 0:return Dt.next=2,this.core.sendCmd("getFileAuthToken",{mixStoreAuthTokenReqTag:ze});case 2:return At=Dt.sent,Dt.abrupt("return",At.content.mixStoreAuthTokenResTag);case 4:case"end":return Dt.stop()}},_e,this)}))},he._getUrlType=function(ze){var _e,At;return this.mixStorePolicy.nosPolicy&&ro(_e=this.mixStorePolicy.nosPolicy.dlcdns).call(_e,function(ar){return Ja(ze).call(ze,ar)>=0})?No.nos:this.mixStorePolicy.s3Policy&&ro(At=this.mixStorePolicy.s3Policy.dlcdns).call(At,function(ar){return Ja(ze).call(ze,ar)>=0})?No.s3:null},he._addCircuitTimer=function(){var ze=this,_e=this.mixStorePolicy.providers,At=_e[(Ja(_e).call(_e,String(this.curProvider))+1)%_e.length];if(At===_e[0])throw new Error("uploadFile all policy fail");var ar=oi(this.mixStorePolicy,"s3Policy.uploadConfig.retryPolicy");if(ar&&ar.retryNext&&At&&(this.logger.log("uploadFile:: upload policy will change,now policy:"+this.curProvider+" nextProvider:"+At),this.curProvider=Uo(At),this.mixStorePolicy.nosPolicy&&this.mixStorePolicy.s3Policy)){var Dt=this.mixStorePolicy[this.curProvider===No.nos?"nosPolicy":"s3Policy"].uploadConfig.retryPolicy.circuit;if(!Dt||Dt===0)return;this.circuitTimer=this.core.timerManager.addTimer(function(){ze.logger.log("uploadFile:: upload policy will change,now policy:"+ze.curProvider+" nextProvider:"+Uo(ze.mixStorePolicy.providers[0])),ze.curProvider=Uo(ze.mixStorePolicy.providers[0]),ze.core.timerManager.deleteTimer(ze.circuitTimer)},1e3*Dt)}},he.process=function(ze){var _e=this[ze.cmd+"Handler"];return typeof _e=="function"?_e.call(this,ze):ze.error&&!ze.error.ignore?xo.reject(ze.error):xo.resolve(ze)},xe}(),Xi=bs({none:0,normal:1,all:3}),cs=bs({normal:0,advanced:1}),Io=bs({normal:0,owner:1,manager:2}),ma={noVerify:0,needVerify:1,rejectAll:2},mo=bs(ma),ta={needVerify:0,noVerify:1},Ss=bs(ta),vo={manager:0,all:1},Tb=bs(vo),gv={manager:0,all:1},ei=bs(gv),ti={manager:0,all:1},Ya=bs(ti);function ga(xe){var he,Ve=["teamId"],ze=["level","memberNum","memberUpdateTime","createTime","updateTime"],_e=["valid","validToCurrentUser","mute"],At={type:cs,muteType:Xi,joinMode:mo,beInviteMode:Ss,inviteMode:Tb,updateTeamMode:ei,updateExtMode:Ya};xe.bits;var ar=ri(xe,["bits"]);return Qn(Ve).call(Ve,function(Dt){ar[Dt]&&(ar[Dt]=ar[Dt].toString())}),Qn(ze).call(ze,function(Dt){ar[Dt]!==void 0&&(ar[Dt]=Uo(ar[Dt]))}),Qn(_e).call(_e,function(Dt){ar[Dt]!==void 0&&(ar[Dt]=Uo(ar[Dt])===1)}),Qn(he=la(At)).call(he,function(Dt){ar[Dt]!==void 0&&(ar[Dt]=At[Dt][ar[Dt]]||ar[Dt])}),ar}function La(xe){return xe&&xe.length>0?Fo(xe).call(xe,function(he){return ga(he)}):[]}function Sp(xe){var he,Ve=zr({},xe),ze=["avatar","name","intro","announcement","ext"],_e={joinMode:ma,beInviteMode:ta,inviteMode:vo,updateTeamMode:gv,updateExtMode:ti};return Qn(ze).call(ze,function(At){Ve[At]!==void 0&&(Ve[At]=Ve[At].toString())}),Qn(he=la(_e)).call(he,function(At){Ve[At]!==void 0&&(Ve[At]=_e[At][Ve[At]])}),Ve}function HC(xe){var he=["teamId","ext","account","nickInTeam"],Ve={};return xe.bitConfigMask!==void 0&&(Ve.bits=Uo(xe.bitConfigMask)),Qn(he).call(he,function(ze){xe[ze]&&(Ve[ze]=xe[ze].toString())}),Ve}function bi(xe){var he,Ve=["teamId"],ze=["joinTime","updateTime","bitConfigMask"],_e=["active","valid","mute"],At={type:Io},ar=xe.bits,Dt=ri(xe,["bits"]);return ar!==void 0&&(Dt.muteTeam=Uo(ar)===1,Dt.bitConfigMask=ar),Dt.id=Dt.teamId+"-"+Dt.account,Qn(Ve).call(Ve,function(vr){Dt[vr]&&(Dt[vr]=Dt[vr].toString())}),Qn(ze).call(ze,function(vr){Dt[vr]!==void 0&&(Dt[vr]=Uo(Dt[vr]))}),Qn(_e).call(_e,function(vr){Dt[vr]!==void 0&&(Dt[vr]=Uo(Dt[vr])===1)}),Qn(he=la(At)).call(he,function(vr){Dt[vr]!==void 0&&(Dt[vr]=At[vr][Dt[vr]]||Dt[vr])}),Dt}function Tp(xe){return xe&&xe.length>0?Fo(xe).call(xe,function(he){return bi(he)}):[]}function Rf(xe,he,Ve){return Ve===void 0&&(Ve="normal"),{id:xe.teamId+"-"+he,teamId:xe.teamId,account:he,type:Ve,nickInTeam:"",muteTeam:!1,mute:!1,joinTime:xe.memberUpdateTime,updateTime:xe.memberUpdateTime,active:!0,valid:!0}}function hv(xe,he,Ve){return Ve===void 0&&(Ve="normal"),he&&he.length>0?Fo(he).call(he,function(ze){return Rf(xe,ze,Ve)}):[]}var ZC=function(){function xe(Ve){this.core=Ve}var he=xe.prototype;return he.notifyAddSuperTeamMembers=function(ze,_e){this.core.emit("addSuperTeamMembers",{team:ze,accounts:_e,members:hv(ze,_e)})},he.notifyUpdateSuperTeamManagers=function(ze,_e,At,ar){this.core.emit("updateSuperTeamManagers",{team:{teamId:ze,memberUpdateTime:ar},accounts:_e,isManager:At,members:Fo(_e).call(_e,function(Dt){return{id:ze+"-"+Dt,type:"manager",account:Dt,updateTime:ar}})})},he.notifyRemoveSuperTeamMembers=function(ze,_e){this.core.emit("removeSuperTeamMembers",{team:ze,accounts:_e})},he.notifyTransferSuperTeam=function(ze,_e,At){this.core.emit("transferSuperTeam",{team:ze,from:{id:ze.teamId+"-"+_e,account:_e,type:"normal",updateTime:ze.memberUpdateTime},to:{id:ze.teamId+"-"+At,account:At,type:"owner",updateTime:ze.memberUpdateTime}})},he.notifyUpdateSuperTeamMembersMute=function(ze,_e,At){this.core.emit("updateSuperTeamMembersMute",{team:ze,accounts:_e,members:Fo(_e).call(_e,function(ar){return{id:ze.teamId+"-"+ar,account:ar,teamId:ze.teamId,mute:At,updateTime:ze.memberUpdateTime}}),mute:At})},xe}(),eM={"21_5":"addSuperTeamMembers","21_6":"removeSuperTeamMembers","21_7":"leaveSuperTeam","21_8":"updateSuperTeamInfo","21_9":"getSuperTeamInfo","21_12":"getSuperTeams","21_15":"getSuperTeamMembers","21_10":"updateMySuperTeamMemberInfo","21_20":"applySuperTeam","21_21":"passSuperTeamApply","21_22":"rejectSuperTeamApply","21_23":"acceptSuperTeamInvite","21_24":"rejectSuperTeamInvite","21_26":"addSuperTeamManagers","21_27":"removeSuperTeamManagers","21_28":"muteSuperTeam","21_29":"muteSuperTeamMembers","21_30":"updateSuperTeamMemberNick","21_31":"transferSuperTeam","21_33":"getSuperTeamMembersByAccounts","21_34":"queryMuteSuperTeamMembers","21_101":"syncCreateSuperTeam","21_109":"syncSuperTeams","21_110":"syncUpdateSuperTeamMember","21_111":"syncMySuperTeamMembers"},Cb={superTeam:{teamId:1,name:3,type:4,owner:5,level:6,selfCustom:7,valid:8,memberNum:9,memberUpdateTime:10,createTime:11,updateTime:12,validToCurrentUser:13,intro:14,announcement:15,joinMode:16,bits:17,ext:18,serverExt:19,avatar:20,beInviteMode:21,inviteMode:22,updateTeamMode:23,updateExtMode:24,mute:100,muteType:101},superTeamMember:{teamId:1,account:3,type:4,nickInTeam:5,bits:7,active:8,valid:9,updateTime:11,ext:12,mute:13,invitorAccid:14,joinTime:15}},cl=Is(Cb),tM={getSuperTeamInfo:{sid:21,cid:9,service:"superTeam",params:[{type:"Long",name:"teamId"}],response:[{type:"Property",name:"superTeam",reflectMapper:cl.superTeam}]},getSuperTeams:{sid:21,cid:12,service:"superTeam",params:[{type:"long",name:"timetag"}],response:[{type:"PropertyArray",name:"superTeams",reflectMapper:cl.superTeam},{type:"Number",name:"timetag"}]},updateSuperTeamInfo:{sid:21,cid:8,service:"superTeam",params:[{type:"Property",name:"superTeam",reflectMapper:Cb.superTeam}],response:[{type:"Number",name:"time"}]},addSuperTeamMembers:{sid:21,cid:5,service:"superTeam",params:[{type:"Long",name:"teamId"},{type:"StrArray",name:"accounts"},{type:"String",name:"ps"}],response:[{type:"StrArray",name:"abortedAccidList"},{type:"Long",name:"time"}]},removeSuperTeamMembers:{sid:21,cid:6,service:"superTeam",params:[{type:"Long",name:"teamId"},{type:"StrArray",name:"accounts"}]},addSuperTeamManagers:{sid:21,cid:26,service:"superTeam",params:[{type:"Long",name:"teamId"},{type:"StrArray",name:"accounts"}]},removeSuperTeamManagers:{sid:21,cid:27,service:"superTeam",params:[{type:"Long",name:"teamId"},{type:"StrArray",name:"accounts"}]},applySuperTeam:{sid:21,cid:20,service:"superTeam",params:[{type:"Long",name:"teamId"},{type:"String",name:"ps"}],response:[{type:"Property",name:"superTeam",reflectMapper:cl.superTeam}]},transferSuperTeam:{sid:21,cid:31,service:"superTeam",params:[{type:"Long",name:"teamId"},{type:"String",name:"account"},{type:"bool",name:"leave"}]},muteSuperTeam:{sid:21,cid:28,service:"superTeam",params:[{type:"Long",name:"teamId"},{type:"Int",name:"mute"}]},muteSuperTeamMembers:{sid:21,cid:29,service:"superTeam",params:[{type:"Long",name:"teamId"},{type:"StrArray",name:"accounts"},{type:"Int",name:"mute"}]},updateSuperTeamMemberNick:{sid:21,cid:30,service:"superTeam",params:[{type:"Property",name:"teamMember",reflectMapper:Cb.superTeamMember}]},updateMySuperTeamMemberInfo:{sid:21,cid:10,service:"superTeam",params:[{type:"Property",name:"teamMember",reflectMapper:Cb.superTeamMember}]},getSuperTeamMembersByAccounts:{sid:21,cid:33,service:"superTeam",params:[{type:"StrArray",name:"memberIds"}],response:[{type:"PropertyArray",name:"superTeamMembers",reflectMapper:cl.superTeamMember}]},getSuperTeamMembers:{sid:21,cid:15,service:"superTeam",params:[{type:"Long",name:"teamId"},{type:"Long",name:"joinTime"},{type:"Int",name:"limit"},{type:"Bool",name:"reverse"}],response:[{type:"PropertyArray",name:"superTeamMembers",reflectMapper:cl.superTeamMember}]},queryMuteSuperTeamMembers:{sid:21,cid:34,service:"superTeam",params:[{type:"Long",name:"teamId"},{type:"Long",name:"joinTime"},{type:"Int",name:"limit"},{type:"Bool",name:"reverse"}],response:[{type:"PropertyArray",name:"superTeamMembers",reflectMapper:cl.superTeamMember}]},leaveSuperTeam:{sid:21,cid:7,service:"superTeam",params:[{type:"Long",name:"teamId"}]},passSuperTeamApply:{sid:21,cid:21,service:"superTeam",params:[{type:"Long",name:"teamId"},{type:"String",name:"from"}]},rejectSuperTeamApply:{sid:21,cid:22,service:"superTeam",params:[{type:"Long",name:"teamId"},{type:"String",name:"from"},{type:"String",name:"ps"}]},acceptSuperTeamInvite:{sid:21,cid:23,service:"superTeam",params:[{type:"Long",name:"teamId"},{type:"String",name:"from"}]},rejectSuperTeamInvite:{sid:21,cid:24,service:"superTeam",params:[{type:"Long",name:"teamId"},{type:"String",name:"from"},{type:"String",name:"ps"}]},syncSuperTeams:{sid:21,cid:109,service:"superTeam",response:[{type:"PropertyArray",name:"teams",reflectMapper:cl.superTeam},{type:"Bool",name:"isAll"},{type:"Long",name:"timetag"}]},syncCreateSuperTeam:{sid:21,cid:101,service:"superTeam",response:[{type:"Property",name:"superTeam",reflectMapper:cl.superTeam}]},syncUpdateSuperTeamMember:{sid:21,cid:110,service:"superTeam",response:[{type:"Property",name:"teamMember",reflectMapper:cl.superTeamMember}]},syncMySuperTeamMembers:{sid:21,cid:111,ext:"sync",service:"superTeam",response:[{type:"PropertyArray",name:"teamMembers",reflectMapper:cl.superTeamMember},{type:"Number",name:"timetag"}]}},rM=function(xe){function he(ze){var _e;return(_e=xe.call(this,"superTeam",ze)||this).mySuperTeamMembersMap=new xc,_e.service=new ZC(ze),ps({cmdMap:eM,cmdConfig:tM}),_e.core.eventBus.on("team/onNotification",function(At){return _e.notificationHandler(At)}),_e}ea(he,xe);var Ve=he.prototype;return Ve.mergeMySuperTeamMembers=function(_e){var At=this;Qn(_e).call(_e,function(ar){var Dt=ar.teamId,vr=At.mySuperTeamMembersMap.get(Dt),Cr=zr({},vr,ar);At.mySuperTeamMembersMap.set(Dt,Cr)})},Ve.getSuperTeamInfo=function(_e){return qn(this,void 0,void 0,_r.mark(function At(){var ar,Dt;return _r.wrap(function(Cr){for(;;)switch(Cr.prev=Cr.next){case 0:return Jn({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1}},_e),Cr.next=3,this.core.sendCmd("getSuperTeamInfo",{teamId:_e.teamId});case 3:return ar=Cr.sent,Dt=ar.content.superTeam,Cr.abrupt("return",ga(Dt));case 6:case"end":return Cr.stop()}},At,this)}))},Ve.getSuperTeams=function(){return qn(this,void 0,void 0,_r.mark(function _e(){var At,ar;return _r.wrap(function(vr){for(;;)switch(vr.prev=vr.next){case 0:return vr.next=2,this.core.sendCmd("getSuperTeams",{timetag:0});case 2:return At=vr.sent,ar=At.content.superTeams,vr.abrupt("return",La(ar));case 5:case"end":return vr.stop()}},_e,this)}))},Ve.updateSuperTeamInfo=function(_e){return qn(this,void 0,void 0,_r.mark(function At(){var ar;return _r.wrap(function(vr){for(;;)switch(vr.prev=vr.next){case 0:return Jn({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1},name:{type:"string",allowEmpty:!1,required:!1},joinMode:{type:"enum",values:["noVerify","needVerify","rejectAll"],required:!1},beInviteMode:{type:"enum",values:["noVerify","needVerify"],required:!1},inviteMode:{type:"enum",values:["manager","all"],required:!1},updateTeamMode:{type:"enum",values:["manager","all"],required:!1},updateExtMode:{type:"enum",values:["manager","all"],required:!1},intro:{type:"string",allowEmpty:!1,required:!1},announcement:{type:"string",allowEmpty:!1,required:!1},avatar:{type:"string",allowEmpty:!1,required:!1},ext:{type:"string",allowEmpty:!1,required:!1}},_e),ar=Sp(_e),vr.next=4,this.core.sendCmd("updateSuperTeamInfo",{superTeam:ar});case 4:return vr.abrupt("return",ga(ar));case 5:case"end":return vr.stop()}},At,this)}))},Ve.addSuperTeamMembers=function(_e){return qn(this,void 0,void 0,_r.mark(function At(){return _r.wrap(function(Dt){for(;;)switch(Dt.prev=Dt.next){case 0:return Jn({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1},accounts:{type:"array",itemType:"string",min:1},ps:{type:"string",allowEmpty:!0,max:5e3,required:!1}},_e),Dt.next=3,this.core.sendCmd("addSuperTeamMembers",{teamId:_e.teamId,accounts:_e.accounts,ps:_e.ps||"",attach:_e.ext||""});case 3:case"end":return Dt.stop()}},At,this)}))},Ve.removeSuperTeamMembers=function(_e){return qn(this,void 0,void 0,_r.mark(function At(){return _r.wrap(function(Dt){for(;;)switch(Dt.prev=Dt.next){case 0:return Jn({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1},accounts:{type:"array",itemType:"string",min:1}},_e),Dt.next=3,this.core.sendCmd("removeSuperTeamMembers",{teamId:_e.teamId,accounts:_e.accounts});case 3:case"end":return Dt.stop()}},At,this)}))},Ve.addSuperTeamManagers=function(_e){return qn(this,void 0,void 0,_r.mark(function At(){return _r.wrap(function(Dt){for(;;)switch(Dt.prev=Dt.next){case 0:return Jn({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1},accounts:{type:"array",min:1,itemType:"string"}},_e),Dt.next=3,this.core.sendCmd("addSuperTeamManagers",_e);case 3:case"end":return Dt.stop()}},At,this)}))},Ve.removeSuperTeamManagers=function(_e){return qn(this,void 0,void 0,_r.mark(function At(){return _r.wrap(function(Dt){for(;;)switch(Dt.prev=Dt.next){case 0:return Jn({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1},accounts:{type:"array",min:1,itemType:"string"}},_e),Dt.next=3,this.core.sendCmd("removeSuperTeamManagers",_e);case 3:case"end":return Dt.stop()}},At,this)}))},Ve.applySuperTeam=function(_e){return qn(this,void 0,void 0,_r.mark(function At(){var ar;return _r.wrap(function(vr){for(;;)switch(vr.prev=vr.next){case 0:return Jn({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1},ps:{type:"string",allowEmpty:!0,max:5e3,required:!1}},_e),vr.next=3,this.core.sendCmd("applySuperTeam",{teamId:_e.teamId,ps:_e.ps||""});case 3:return ar=vr.sent,vr.abrupt("return",ga(ar.content.superTeam));case 5:case"end":return vr.stop()}},At,this)}))},Ve.transferSuperTeam=function(_e){return qn(this,void 0,void 0,_r.mark(function At(){return _r.wrap(function(Dt){for(;;)switch(Dt.prev=Dt.next){case 0:return Jn({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1},account:{type:"string",allowEmpty:!1},leave:{type:"boolean"}},_e),Dt.next=3,this.core.sendCmd("transferSuperTeam",_e);case 3:case"end":return Dt.stop()}},At,this)}))},Ve.muteSuperTeam=function(_e){return qn(this,void 0,void 0,_r.mark(function At(){return _r.wrap(function(Dt){for(;;)switch(Dt.prev=Dt.next){case 0:return Jn({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1},mute:{type:"boolean"}},_e),Dt.next=3,this.core.sendCmd("muteSuperTeam",{teamId:_e.teamId,mute:_e.mute?1:0});case 3:case"end":return Dt.stop()}},At,this)}))},Ve.muteSuperTeamMembers=function(_e){return qn(this,void 0,void 0,_r.mark(function At(){return _r.wrap(function(Dt){for(;;)switch(Dt.prev=Dt.next){case 0:return Jn({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1},accounts:{type:"array",itemType:"string"},mute:{type:"boolean"}},_e),Dt.next=3,this.core.sendCmd("muteSuperTeamMembers",{teamId:_e.teamId,accounts:_e.accounts,mute:_e.mute?1:0});case 3:case"end":return Dt.stop()}},At,this)}))},Ve.updateMemberNick=function(_e){return qn(this,void 0,void 0,_r.mark(function At(){var ar,Dt;return _r.wrap(function(Cr){for(;;)switch(Cr.prev=Cr.next){case 0:return Jn({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1},account:{type:"string",allowEmpty:!1},nickInTeam:{type:"string",allowEmpty:!1}},_e),ar=HC({teamId:_e.teamId,nickInTeam:_e.nickInTeam,account:_e.account}),Cr.next=4,this.core.sendCmd("updateSuperTeamMemberNick",{teamMember:ar});case 4:return Dt=bi(zr({updateTime:new Date().getTime()},ar)),Cr.abrupt("return",Dt);case 6:case"end":return Cr.stop()}},At,this)}))},Ve.updateMyMemberInfo=function(_e){return qn(this,void 0,void 0,_r.mark(function At(){var ar,Dt,vr;return _r.wrap(function(Ar){for(;;)switch(Ar.prev=Ar.next){case 0:return Jn({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1},nickInTeam:{type:"string",allowEmpty:!1,required:!1},bitConfigMask:{type:"number",min:0,max:2,required:!1},ext:{type:"string",required:!1}},_e),ar=HC({teamId:_e.teamId,nickInTeam:_e.nickInTeam,bitConfigMask:_e.bitConfigMask,ext:_e.ext}),Ar.next=4,this.core.sendCmd("updateMySuperTeamMemberInfo",{teamMember:ar});case 4:return Dt=bi(zr({updateTime:new Date().getTime(),account:this.core.account},ar)),this.mergeMySuperTeamMembers([Dt]),this.core.emit("updateSuperTeamMember",Dt),vr=Dc(this.mySuperTeamMembersMap.get(Dt.teamId)),this.core.emit("mySuperTeamMembers",[vr]),Ar.abrupt("return",Dt);case 10:case"end":return Ar.stop()}},At,this)}))},Ve.getSuperTeamMembersByAccounts=function(_e){var At;return qn(this,void 0,void 0,_r.mark(function ar(){var Dt,vr,Cr;return _r.wrap(function($r){for(;;)switch($r.prev=$r.next){case 0:return Jn({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1},accounts:{type:"array",itemType:"string",max:20,min:1}},_e),vr=Fo(Dt=_e.accounts).call(Dt,function(jr){return _e.teamId+"|"+jr}),$r.next=4,this.core.sendCmd("getSuperTeamMembersByAccounts",{memberIds:vr});case 4:return Cr=$r.sent,$r.abrupt("return",Tp((At=Cr.content)===null||At===void 0?void 0:At.superTeamMembers));case 6:case"end":return $r.stop()}},ar,this)}))},Ve.getSuperTeamMembers=function(_e){var At;return qn(this,void 0,void 0,_r.mark(function ar(){var Dt;return _r.wrap(function(Cr){for(;;)switch(Cr.prev=Cr.next){case 0:return Jn({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1},joinTime:{type:"number",min:0,required:!1},limit:{type:"number",min:1,max:1e3,required:!1},reverse:{type:"boolean",required:!1}},_e),Cr.next=3,this.core.sendCmd("getSuperTeamMembers",zr({joinTime:0,limit:100,reverse:!1},_e));case 3:return Dt=Cr.sent,Cr.abrupt("return",Tp((At=Dt.content)===null||At===void 0?void 0:At.superTeamMembers));case 5:case"end":return Cr.stop()}},ar,this)}))},Ve.queryMuteMembers=function(_e){return qn(this,void 0,void 0,_r.mark(function At(){var ar,Dt;return _r.wrap(function(Cr){for(;;)switch(Cr.prev=Cr.next){case 0:return Jn({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1},joinTime:{type:"number",min:0,required:!1},limit:{type:"number",min:1,required:!1},reverse:{type:"boolean",required:!1}},_e),Cr.next=3,this.core.sendCmd("queryMuteSuperTeamMembers",zr({limit:100,joinTime:0,reverse:!1},_e));case 3:return ar=Cr.sent,Dt=ar.content,Cr.abrupt("return",Tp(Dt.superTeamMembers));case 6:case"end":return Cr.stop()}},At,this)}))},Ve.leaveSuperTeam=function(_e){return qn(this,void 0,void 0,_r.mark(function At(){return _r.wrap(function(Dt){for(;;)switch(Dt.prev=Dt.next){case 0:return Jn({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1}},_e),Dt.next=3,this.core.sendCmd("leaveSuperTeam",{teamId:_e.teamId});case 3:case"end":return Dt.stop()}},At,this)}))},Ve.passSuperTeamApply=function(_e){return qn(this,void 0,void 0,_r.mark(function At(){return _r.wrap(function(Dt){for(;;)switch(Dt.prev=Dt.next){case 0:return Jn({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1},from:{type:"string",allowEmpty:!1}},_e),Dt.next=3,this.core.sendCmd("passSuperTeamApply",_e);case 3:case"end":return Dt.stop()}},At,this)}))},Ve.rejectSuperTeamApply=function(_e){return qn(this,void 0,void 0,_r.mark(function At(){return _r.wrap(function(Dt){for(;;)switch(Dt.prev=Dt.next){case 0:return Jn({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1},from:{type:"string",allowEmpty:!1},ps:{type:"string",max:5e3,required:!1}},_e),Dt.next=3,this.core.sendCmd("rejectSuperTeamApply",{teamId:_e.teamId,from:_e.from,ps:_e.ps||""});case 3:case"end":return Dt.stop()}},At,this)}))},Ve.acceptSuperTeamInvite=function(_e){return qn(this,void 0,void 0,_r.mark(function At(){return _r.wrap(function(Dt){for(;;)switch(Dt.prev=Dt.next){case 0:return Jn({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1},from:{type:"string",allowEmpty:!1}},_e),Dt.next=3,this.core.sendCmd("acceptSuperTeamInvite",_e);case 3:case"end":return Dt.stop()}},At,this)}))},Ve.rejectSuperTeamInvite=function(_e){return qn(this,void 0,void 0,_r.mark(function At(){return _r.wrap(function(Dt){for(;;)switch(Dt.prev=Dt.next){case 0:return Jn({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1},from:{type:"string",allowEmpty:!1},ps:{type:"string",max:5e3,required:!1}},_e),Dt.next=3,this.core.sendCmd("rejectSuperTeamInvite",{teamId:_e.teamId,from:_e.from,ps:_e.ps||""});case 3:case"end":return Dt.stop()}},At,this)}))},Ve.syncSuperTeamsHandler=function(_e){var At=_e.content;this.core.eventBus.emit("sync/updateTimetag",{superTeams:Uo(At.timetag)});var ar=At==null?void 0:At.superTeams;if(ar&&ar.length){var Dt=La(ar);this.core.emit("superTeams",Dt)}},Ve.syncCreateSuperTeamHandler=function(_e){var At=_e.content,ar=ga(At==null?void 0:At.superTeam),Dt=Rf(ar,ar.owner,"owner");this.core.emit("createSuperTeam",ar,Dt)},Ve.syncUpdateSuperTeamMemberHandler=function(_e){var At=_e.content,ar=bi(At==null?void 0:At.teamMember);ar.updateTime||(ar.updateTime=new Date().getTime()),this.mergeMySuperTeamMembers([ar]),this.core.emit("updateSuperTeamMember",ar);var Dt=Dc(this.mySuperTeamMembersMap.get(ar.teamId));this.core.emit("mySuperTeamMembers",[Dt])},Ve.syncMySuperTeamMembersHandler=function(_e){var At,ar=_e.content;this.core.eventBus.emit("sync/updateTimetag",{mySuperTeamMembers:Uo(ar.timetag)});var Dt=ar==null?void 0:Fo(At=ar.teamMembers).call(At,function(vr){return bi(vr)});this.mergeMySuperTeamMembers(Dt),this.core.emit("mySuperTeamMembers",Dc(Dt))},Ve.notificationHandler=function(_e){var At=_e.attach,ar=_e.scene,Dt=_e.from,vr=_e.to,Cr=_e.time,Ar=_e.idServer,$r=_e.idClient,jr=At.team,Hr=At.account,Kr=At.accounts,Sn=At.type;if(ar==="superTeam")switch(this.core.options.debugLevel==="debug"?this.logger.debug("superTeam::recvNotification",Ar,$r,At):this.logger.log("superTeam::recvNotification",Ar,$r,vr,Sn,Hr,Kr),Sn){case"updateSuperTeam":jr.updateTime=Cr,this.core.emit("updateSuperTeam",jr);break;case"addSuperTeamMembers":this.service.notifyAddSuperTeamMembers(jr,Kr);break;case"acceptSuperTeamInvite":this.service.notifyAddSuperTeamMembers(jr,[Dt]);break;case"passSuperTeamApply":this.service.notifyAddSuperTeamMembers(jr,[Hr]);break;case"addSuperTeamManagers":this.service.notifyUpdateSuperTeamManagers(vr,Kr,!0,Cr);break;case"removeSuperTeamManagers":this.service.notifyUpdateSuperTeamManagers(vr,Kr,!1,Cr);break;case"removeSuperTeamMembers":this.service.notifyRemoveSuperTeamMembers(jr,Kr);break;case"leaveSuperTeam":this.service.notifyRemoveSuperTeamMembers(jr,[Dt]);break;case"dismissSuperTeam":this.core.emit("dismissSuperTeam",{teamId:vr});break;case"transferSuperTeam":this.service.notifyTransferSuperTeam(jr,Dt,Hr);break;case"updateSuperTeamMembersMute":this.service.notifyUpdateSuperTeamMembersMute(jr,Kr,At.mute)}},he}(Ps),nM={"13_1":"getChatroomAddress","24_1":"getQChatAddress"},oM={getChatroomAddress:{sid:13,cid:1,service:"plugin",params:[{type:"Long",name:"chatroomId"},{type:"Boolean",name:"isWeixinApp"},{type:"Number",name:"ipType"}],response:[{type:"StrArray",name:"address"}]},getQChatAddress:{sid:24,cid:1,service:"plugin",params:[{type:"Property",name:"getQChatAddressTag",reflectMapper:{ipType:1}}],response:[{type:"StrArray",name:"address"}]}},aM=function(xe){function he(ze){var _e;return(_e=xe.call(this,"plugin",ze)||this).core=ze,ps({cmdMap:nM,cmdConfig:oM}),_e}ea(he,xe);var Ve=he.prototype;return Ve.getChatroomAddress=function(_e){return qn(this,void 0,void 0,_r.mark(function At(){var ar;return _r.wrap(function(vr){for(;;)switch(vr.prev=vr.next){case 0:return Jn({chatroomId:{type:"string",allowEmpty:!1},ipType:{type:"number",required:!1}},_e),vr.next=3,this.core.sendCmd("getChatroomAddress",{chatroomId:_e.chatroomId,isWeixinApp:ua.platform==="WXAPP",ipType:_e.ipType||0});case 3:return ar=vr.sent,vr.abrupt("return",ar.content.address);case 5:case"end":return vr.stop()}},At,this)}))},Ve.getQChatAddress=function(_e){return qn(this,void 0,void 0,_r.mark(function At(){var ar;return _r.wrap(function(vr){for(;;)switch(vr.prev=vr.next){case 0:return Jn({ipType:{type:"number",required:!1}},_e),vr.next=3,this.core.sendCmd("getQChatAddress",{getQChatAddressTag:{ipType:(_e==null?void 0:_e.ipType)||0}});case 3:return ar=vr.sent,vr.abrupt("return",ar.content.address);case 5:case"end":return vr.stop()}},At,this)}))},he}(Ps),sM={"7_19":"nimQueryCloudSessionList","7_20":"nimQueryCloudSession","7_21":"nimUpdateCloudSession","7_22":"nimDeleteCloudSessionList","7_121":"nimMultiSyncUpdateCloudSession"},vv={sessionReqTag:{minTimestamp:1,maxTimestamp:2,includedLastMsg:3,limit:4,hasMore:5},sessionTag:{sessionId:1,updateTime:2,ext:3,lastMsg:4,lastMsgType:5}},Mb=Is(vv),iM={nimQueryCloudSessionList:{sid:7,cid:19,service:"cloudSession",params:[{type:"Property",name:"tag",reflectMapper:vv.sessionReqTag}],response:[{type:"Property",name:"tag",reflectMapper:Mb.sessionReqTag},{type:"PropertyArray",name:"sessions",reflectMapper:Mb.sessionTag}]},nimQueryCloudSession:{sid:7,cid:20,service:"cloudSession",params:[{type:"Property",name:"tag",reflectMapper:vv.sessionTag}],response:[{type:"Property",name:"session",reflectMapper:Mb.sessionTag}]},nimUpdateCloudSession:{sid:7,cid:21,service:"cloudSession",params:[{type:"Property",name:"tag",reflectMapper:vv.sessionTag}]},nimDeleteCloudSessionList:{sid:7,cid:22,service:"cloudSession",params:[{type:"PropertyArray",name:"tags",reflectMapper:vv.sessionTag}]},nimMultiSyncUpdateCloudSession:{sid:7,cid:121,service:"cloudSession",response:[{type:"Property",name:"session",reflectMapper:Mb.sessionTag}]}},cM={sessionId:{type:"string"},updateTime:{type:"number"},ext:{type:"string"},lastMsg:{type:"object"},lastMsgType:{type:"number"}};function zC(xe,he,Ve){var ze=_i(cM,xe),_e=na(ze.sessionId,"|"),At=_e.accid,ar=_e.scene;if(ze.sessionId=ar+"-"+At,ze.lastMsg){var Dt=ze.lastMsgType===1;ze.lastMsgInfo=Dt?{isLastMsgRecalled:Dt,revokedMsg:vp(nc(ze.lastMsg,Kl.sysMsg),Ve)}:{isLastMsgRecalled:Dt,lastMsg:lc(nc(ze.lastMsg,Ns.msg),{account:he})}}return delete ze.lastMsg,delete ze.lastMsgType,ze}function lM(xe,he,Ve){return xe&&xe.length>0?Fo(xe).call(xe,function(ze){return zC(ze,he,Ve)}):[]}var JC,ll,yv,uM=function(xe){function he(ze){var _e;return _e=xe.call(this,"cloudSession",ze)||this,ps({cmdMap:sM,cmdConfig:iM}),_e}ea(he,xe);var Ve=he.prototype;return Ve.queryCloudSessionList=function(_e){var At;return qn(this,void 0,void 0,_r.mark(function ar(){var Dt,vr,Cr,Ar;return _r.wrap(function(jr){for(;;)switch(jr.prev=jr.next){case 0:return Jn({minTimestamp:{type:"number",min:0,required:!1},maxTimestamp:{type:"number",min:0,required:!1},limit:{type:"number",min:1,required:!1},includedLastMsg:{type:"boolean",required:!1}},_e),(Dt=zr({limit:100,includedLastMsg:!0},_e)).includedLastMsg=TT.boolean(_e,"includedLastMsg"),jr.next=5,this.core.sendCmd("nimQueryCloudSessionList",{tag:Dt});case 5:return vr=jr.sent,Cr=((At=vr.content)===null||At===void 0?void 0:At.tag)||{},Ar=vr.content.sessions,jr.abrupt("return",{hasMore:+Cr.hasMore>0,sessionList:lM(Ar,this.core.account,this.logger)});case 9:case"end":return jr.stop()}},ar,this)}))},Ve.queryCloudSession=function(_e){return qn(this,void 0,void 0,_r.mark(function At(){var ar,Dt,vr,Cr;return _r.wrap(function($r){for(;;)switch($r.prev=$r.next){case 0:return Jn({sessionId:{type:"string",allowEmpty:!1}},_e),ar=na(_e.sessionId,"-"),Dt=ar.accid,vr=ar.scene,$r.next=4,this.core.sendCmd("nimQueryCloudSession",{tag:{sessionId:vr==="superTeam"?"super_team|"+Dt:vr+"|"+Dt}});case 4:return Cr=$r.sent,$r.abrupt("return",zC(Cr.content.session,this.core.account,this.logger));case 6:case"end":return $r.stop()}},At,this)}))},Ve.updateCloudSession=function(_e){return qn(this,void 0,void 0,_r.mark(function At(){var ar,Dt,vr;return _r.wrap(function(Ar){for(;;)switch(Ar.prev=Ar.next){case 0:return Jn({sessionId:{type:"string",allowEmpty:!1},ext:{type:"string",allowEmpty:!1,required:!1}},_e),ar=na(_e.sessionId,"-"),Dt=ar.accid,vr=ar.scene,Ar.next=4,this.core.sendCmd("nimUpdateCloudSession",{tag:{sessionId:vr==="superTeam"?"super_team|"+Dt:vr+"|"+Dt,ext:_e.ext}});case 4:case"end":return Ar.stop()}},At,this)}))},Ve.deleteCloudSessionList=function(_e){return qn(this,void 0,void 0,_r.mark(function At(){var ar,Dt;return _r.wrap(function(Cr){for(;;)switch(Cr.prev=Cr.next){case 0:return Jn({sessionIdList:{type:"array",itemType:"string"}},_e),Dt=Fo(ar=_e.sessionIdList).call(ar,function(Ar){var $r=na(Ar,"-"),jr=$r.accid,Hr=$r.scene;return{sessionId:Hr==="superTeam"?"super_team|"+jr:Hr+"|"+jr}}),Cr.next=4,this.core.sendCmd("nimDeleteCloudSessionList",{tags:Dt});case 4:case"end":return Cr.stop()}},At,this)}))},Ve.nimMultiSyncUpdateCloudSessionHandler=function(_e){var At=zC(_e.content.session,this.core.account,this.logger);this.core.emit("multiSyncUpdateCloudSession",At)},he}(Ps);(function(xe){xe[xe.audio=1]="audio",xe[xe.video=2]="video",xe[xe.custom=3]="custom"})(JC||(JC={})),function(xe){xe[xe.kClose=1]="kClose",xe[xe.kJoin=2]="kJoin",xe[xe.kInvite=3]="kInvite",xe[xe.kCancelInvite=4]="kCancelInvite",xe[xe.kReject=5]="kReject",xe[xe.kAccept=6]="kAccept",xe[xe.kLeave=7]="kLeave",xe[xe.kCustom=8]="kCustom"}(ll||(ll={})),function(xe){xe[xe.kDefault=0]="kDefault",xe[xe.kLeave=1]="kLeave",xe[xe.kSelfSync=3]="kSelfSync"}(yv||(yv={}));var WC={needPush:{type:"boolean",required:!1},pushTitle:{type:"string",required:!1},pushContent:{type:"string",required:!1},pushPayload:{type:"string",required:!1},needPushBadge:{type:"boolean",required:!1}},dM={"15_1":"signalingCreate","15_2":"signalingDelay","15_3":"signalingClose","15_4":"signalingJoin","15_5":"signalingLeave","15_6":"signalingInvite","15_7":"signalingCancelInvite","15_8":"signalingReject","15_9":"signalingAccept","15_10":"signalingSendCustomCommand","15_11":"signalingRecvNotification","15_12":"signalingMultiSyncNotification","15_13":"signalingSyncNotification","15_14":"singalingSyncChannels","15_15":"signalingQueryInfo","15_16":"signalingCallEx","15_17":"signalingJoinAndAccept"},Ii={avSignalTag:zr({type:1,name:2,channelId:3,createTime:4,expireTime:5,creatorAccid:6,ext:7,invalid:8,fromAccid:10,toAccid:11,requestId:12,members:18,attach:19,attachExt:20,needOffline:21,msgId:22,uid:23,time:24,nertcChannelName:25,nertcTokenTtl:26,nertcToken:27,nertcJoinRoomQueryParamMap:28,nertcJoinRoomResponse:29,callStatus:30},{needPush:13,pushTitle:14,pushContent:15,pushPayload:16,needPushBadge:17})},Uc=Is(Ii),pM={signalingCreate:{sid:15,cid:1,service:"signaling",params:[{type:"Property",name:"tag",reflectMapper:Ii.avSignalTag}],response:[{type:"Property",name:"data",reflectMapper:Uc.avSignalTag}]},signalingDelay:{sid:15,cid:2,service:"signaling",params:[{type:"Property",name:"tag",reflectMapper:Ii.avSignalTag}],response:[{type:"Property",name:"data",reflectMapper:Uc.avSignalTag}]},signalingClose:{sid:15,cid:3,service:"signaling",params:[{type:"Property",name:"tag",reflectMapper:Ii.avSignalTag}],response:[{type:"Property",name:"data",reflectMapper:Uc.avSignalTag}]},signalingJoin:{sid:15,cid:4,service:"signaling",params:[{type:"Property",name:"tag",reflectMapper:Ii.avSignalTag}],response:[{type:"Property",name:"data",reflectMapper:Uc.avSignalTag}]},signalingLeave:{sid:15,cid:5,service:"signaling",params:[{type:"Property",name:"tag",reflectMapper:Ii.avSignalTag}]},signalingInvite:{sid:15,cid:6,service:"signaling",params:[{type:"Property",name:"tag",reflectMapper:Ii.avSignalTag}]},signalingCancelInvite:{sid:15,cid:7,service:"signaling",params:[{type:"Property",name:"tag",reflectMapper:Ii.avSignalTag}]},signalingReject:{sid:15,cid:8,service:"signaling",params:[{type:"Property",name:"tag",reflectMapper:Ii.avSignalTag}]},signalingAccept:{sid:15,cid:9,service:"signaling",params:[{type:"Property",name:"tag",reflectMapper:Ii.avSignalTag}]},signalingSendCustomCommand:{sid:15,cid:10,service:"signaling",params:[{type:"Property",name:"tag",reflectMapper:Ii.avSignalTag}]},signalingRecvNotification:{sid:15,cid:11,service:"signaling",response:[{type:"Property",name:"data",reflectMapper:Uc.avSignalTag}]},signalingMultiSyncNotification:{sid:15,cid:12,service:"signaling",response:[{type:"Property",name:"data",reflectMapper:Uc.avSignalTag}]},signalingSyncNotification:{sid:15,cid:13,service:"signaling",response:[{type:"PropertyArray",name:"datas",reflectMapper:Uc.avSignalTag}]},singalingSyncChannels:{sid:15,cid:14,service:"signaling",response:[{type:"PropertyArray",name:"datas",reflectMapper:Uc.avSignalTag}]},signalingQueryInfo:{sid:15,cid:15,service:"signaling",params:[{type:"Property",name:"tag",reflectMapper:Ii.avSignalTag}],response:[{type:"Property",name:"data",reflectMapper:Uc.avSignalTag}]},signalingCallEx:{sid:15,cid:16,service:"signaling",params:[{type:"Property",name:"tag",reflectMapper:Ii.avSignalTag}],response:[{type:"Property",name:"data",reflectMapper:Uc.avSignalTag}]},signalingJoinAndAccept:{sid:15,cid:17,service:"signaling",params:[{type:"Property",name:"tag",reflectMapper:Ii.avSignalTag}],response:[{type:"Property",name:"data",reflectMapper:Uc.avSignalTag}]},signalingBatchMarkRead:{sid:4,cid:5,isNoResponse:!0,service:"signaling",params:[{type:"byte",name:"sid"},{type:"byte",name:"cid"},{type:"LongArray",name:"ids"}]}},kb={type:{type:"number"},createTime:{type:"number"},expireTime:{type:"number"},invalid:{type:"boolean"},pushInfo:WC,pluginSetting:{nertcInfo:{nertcChannelName:{type:"string"},nertcTokenTtl:{type:"number"},nertcToken:{type:"string"},nertcJoinRoomQueryParamMap:{type:"string"},callStatus:{type:"number"}}},attach:{type:"object"},members:{type:"object"},needOffline:{type:"boolean"},uid:{type:"number"},time:{type:"number"}};function Cp(xe){var he,Ve=_i(kb,xe),ze=[];return Ve.members&&Ve.members.length>0&&(ze=Fo(he=Ve.members).call(he,function(_e){return function(ar){return _i(kb,nc(ar,{1:"accid",2:"uid",3:"createTime",4:"expireTime"}))}(_e)}),delete Ve.members),ze.length>0?{channelInfo:Ve,memberList:ze}:{channelInfo:Ve}}function Vc(xe){return Kd(kb,xe)}var fM=function(xe){function he(ze){var _e;return(_e=xe.call(this)||this).timer=0,_e.pollingInterval=12e4,_e.name="signaling",_e.logger=ze.logger,_e.core=ze,_e.channels={},ps({cmdMap:dM,cmdConfig:pM}),_e}ea(he,xe);var Ve=he.prototype;return Ve.callEx=function(_e){var At;return qn(this,void 0,void 0,_r.mark(function ar(){var Dt,vr,Cr,Ar;return _r.wrap(function(jr){for(;;)switch(jr.prev=jr.next){case 0:return Jn({type:{type:"number"},toAccid:{type:"string",allowEmpty:!1},requestId:{type:"string",allowEmpty:!1},needOffline:{type:"boolean",required:!1},pushInfo:{type:"object",required:!1,rules:WC},pluginSetting:{type:"object",required:!1,rules:{nertcInfo:{type:"object",required:!1}}}},_e),jr.next=3,this.core.sendCmd("signalingCallEx",{tag:Vc(_e)});case 3:return Dt=jr.sent,vr=((At=Dt.content)===null||At===void 0?void 0:At.data)||{},Cr=Cp(vr),this.channels[Cr.channelInfo.channelId]=Dc(Cr.channelInfo),this.timer||(this.timer=this.core.timerManager.addTimer(Zo(Ar=this.aotoDelay).call(Ar,this),this.pollingInterval,-1)),jr.abrupt("return",Cr);case 9:case"end":return jr.stop()}},ar,this)}))},Ve.joinAndAccept=function(_e){var At;return qn(this,void 0,void 0,_r.mark(function ar(){var Dt,vr,Cr,Ar,$r,jr;return _r.wrap(function(Kr){for(;;)switch(Kr.prev=Kr.next){case 0:return Jn({channelId:{type:"string",allowEmpty:!1},fromAccid:{type:"string",allowEmpty:!1},requestId:{type:"string",required:!1},needOffline:{type:"boolean",required:!1},uid:{type:"number",required:!1},pluginSetting:{type:"object",required:!1,rules:{nertcInfo:{type:"object",required:!1}}}},_e),Dt=_e.fromAccid,(vr=ri(_e,["fromAccid"])).toAccid=Dt,Kr.next=5,this.core.sendCmd("signalingJoinAndAccept",{tag:Vc(vr)});case 5:return Cr=Kr.sent,Ar=((At=Cr.content)===null||At===void 0?void 0:At.data)||{},$r=Cp(Ar),this.channels[$r.channelInfo.channelId]=Dc($r.channelInfo),this.timer||(this.timer=this.core.timerManager.addTimer(Zo(jr=this.aotoDelay).call(jr,this),this.pollingInterval,-1)),Kr.abrupt("return",$r);case 11:case"end":return Kr.stop()}},ar,this)}))},Ve.create=function(_e){var At;return qn(this,void 0,void 0,_r.mark(function ar(){var Dt,vr;return _r.wrap(function(Ar){for(;;)switch(Ar.prev=Ar.next){case 0:return Jn({type:{type:"number"},ext:{type:"string",required:!1}},_e),Ar.next=3,this.core.sendCmd("signalingCreate",{tag:Vc(_e)});case 3:return Dt=Ar.sent,vr=((At=Dt.content)===null||At===void 0?void 0:At.data)||{},Ar.abrupt("return",Cp(vr));case 6:case"end":return Ar.stop()}},ar,this)}))},Ve.close=function(_e){return qn(this,void 0,void 0,_r.mark(function At(){return _r.wrap(function(Dt){for(;;)switch(Dt.prev=Dt.next){case 0:return Jn({channelId:{type:"string",allowEmpty:!1},attachExt:{type:"string",required:!1},needOffline:{type:"boolean",required:!1}},_e),Dt.next=3,this.core.sendCmd("signalingClose",{tag:Vc(_e)});case 3:case"end":return Dt.stop()}},At,this)}))},Ve.queryInfo=function(_e){var At;return qn(this,void 0,void 0,_r.mark(function ar(){var Dt,vr;return _r.wrap(function(Ar){for(;;)switch(Ar.prev=Ar.next){case 0:return Jn({name:{type:"string",allowEmpty:!1}},_e),Ar.next=3,this.core.sendCmd("signalingQueryInfo",{tag:_e});case 3:return Dt=Ar.sent,vr=((At=Dt.content)===null||At===void 0?void 0:At.data)||{},Ar.abrupt("return",Cp(vr));case 6:case"end":return Ar.stop()}},ar,this)}))},Ve.join=function(_e){var At;return qn(this,void 0,void 0,_r.mark(function ar(){var Dt,vr,Cr,Ar;return _r.wrap(function(jr){for(;;)switch(jr.prev=jr.next){case 0:return Jn({channelId:{type:"string",allowEmpty:!1},attachExt:{type:"string",required:!1},uid:{type:"number",min:0,required:!1},needOffline:{type:"boolean",required:!1}},_e),jr.next=3,this.core.sendCmd("signalingJoin",{tag:Vc(_e)});case 3:return Dt=jr.sent,vr=((At=Dt.content)===null||At===void 0?void 0:At.data)||{},Cr=Cp(vr),this.channels[Cr.channelInfo.channelId]=Dc(Cr.channelInfo),this.timer||(this.timer=this.core.timerManager.addTimer(Zo(Ar=this.aotoDelay).call(Ar,this),this.pollingInterval,-1)),jr.abrupt("return",Cr);case 9:case"end":return jr.stop()}},ar,this)}))},Ve.aotoDelay=function(){return qn(this,void 0,void 0,_r.mark(function _e(){var At,ar,Dt,vr,Cr;return _r.wrap(function($r){for(;;)switch($r.prev=$r.next){case 0:if((At=la(this.channels)).length!==0){$r.next=4;break}return this.timer&&this.core.timerManager.deleteTimer(this.timer),$r.abrupt("return");case 4:this.logger.log("signling:autoDelay",At),ar=0;case 6:if(!(ar<At.length)){$r.next=23;break}return Dt=At[ar],$r.prev=8,$r.next=11,this.core.sendCmd("signalingDelay",{tag:{channelId:Dt}});case 11:vr=$r.sent,Cr=Cp(vr.content.data),this.channels[Dt]=Cr.channelInfo,$r.next=20;break;case 16:$r.prev=16,$r.t0=$r.catch(8),this.logger.warn("signling:autoDelay "+Dt+" failed",$r.t0),delete this.channels[Dt];case 20:ar++,$r.next=6;break;case 23:case"end":return $r.stop()}},_e,this,[[8,16]])}))},Ve.leave=function(_e){return qn(this,void 0,void 0,_r.mark(function At(){return _r.wrap(function(Dt){for(;;)switch(Dt.prev=Dt.next){case 0:return Jn({channelId:{type:"string",allowEmpty:!1},attachExt:{type:"string",required:!1},needOffline:{type:"boolean",required:!1}},_e),Dt.next=3,this.core.sendCmd("signalingLeave",{tag:Vc(_e)});case 3:delete this.channels[_e.channelId];case 4:case"end":return Dt.stop()}},At,this)}))},Ve.invite=function(_e){return qn(this,void 0,void 0,_r.mark(function At(){return _r.wrap(function(Dt){for(;;)switch(Dt.prev=Dt.next){case 0:return Jn({channelId:{type:"string",allowEmpty:!1},toAccid:{type:"string",allowEmpty:!1},requestId:{type:"string",allowEmpty:!1},attachExt:{type:"string",required:!1},needOffline:{type:"boolean",required:!1},pushInfo:{type:"object",required:!1,rules:WC}},_e),Dt.next=3,this.core.sendCmd("signalingInvite",{tag:Vc(_e)});case 3:case"end":return Dt.stop()}},At,this)}))},Ve.cancelInvite=function(_e){return qn(this,void 0,void 0,_r.mark(function At(){return _r.wrap(function(Dt){for(;;)switch(Dt.prev=Dt.next){case 0:return Jn({channelId:{type:"string",allowEmpty:!1},toAccid:{type:"string",allowEmpty:!1},requestId:{type:"string",allowEmpty:!1},attachExt:{type:"string",required:!1},needOffline:{type:"boolean",required:!1}},_e),Dt.next=3,this.core.sendCmd("signalingCancelInvite",{tag:Vc(_e)});case 3:case"end":return Dt.stop()}},At,this)}))},Ve.reject=function(_e){return qn(this,void 0,void 0,_r.mark(function At(){var ar,Dt;return _r.wrap(function(Cr){for(;;)switch(Cr.prev=Cr.next){case 0:return Jn({channelId:{type:"string",allowEmpty:!1},fromAccid:{type:"string",allowEmpty:!1},requestId:{type:"string",allowEmpty:!1},attachExt:{type:"string",required:!1},needOffline:{type:"boolean",required:!1}},_e),ar=_e.fromAccid,(Dt=ri(_e,["fromAccid"])).toAccid=ar,Cr.next=5,this.core.sendCmd("signalingReject",{tag:Vc(Dt)});case 5:case"end":return Cr.stop()}},At,this)}))},Ve.accept=function(_e){return qn(this,void 0,void 0,_r.mark(function At(){var ar,Dt,vr,Cr,Ar;return _r.wrap(function(jr){for(;;)switch(jr.prev=jr.next){case 0:return Jn({channelId:{type:"string",allowEmpty:!1},fromAccid:{type:"string",allowEmpty:!1},requestId:{type:"string",allowEmpty:!1},attachExt:{type:"string",required:!1},needOffline:{type:"boolean",required:!1},autoJoin:{type:"boolean",required:!1},uid:{type:"number",min:0,required:!1},joinAttachExt:{type:"string",required:!1}},_e),ar=_e.autoJoin,Dt=_e.joinAttachExt,vr=_e.fromAccid,(Cr=ri(_e,["autoJoin","joinAttachExt","fromAccid"])).toAccid=vr,jr.next=5,this.core.sendCmd("signalingAccept",{tag:Vc(Cr)});case 5:if(this.logger.log("Signaling:accept, accept success, autoJoin "+_e.autoJoin),!ar){jr.next=10;break}return Ar={channelId:_e.channelId,needOffline:_e.needOffline,attachExt:Dt,uid:_e.uid},jr.next=10,this.join(Ar);case 10:case"end":return jr.stop()}},At,this)}))},Ve.sendCustomCommand=function(_e){return qn(this,void 0,void 0,_r.mark(function At(){return _r.wrap(function(Dt){for(;;)switch(Dt.prev=Dt.next){case 0:return Jn({channelId:{type:"string",allowEmpty:!1},fromAccid:{type:"string",allowEmpty:!1,required:!1},attachExt:{type:"string",required:!1}},_e),Dt.next=3,this.core.sendCmd("signalingSendCustomCommand",{tag:Vc(_e)});case 3:case"end":return Dt.stop()}},At,this)}))},Ve.signalingRecvNotificationHandler=function(_e){var At=typeof oi(_e,"raw.r[0]")=="number"?""+_e.raw.r[0]:void 0;_e.content.data.msgId=At,this.doNotify(_e.content.data),At&&Uo(At)&&this.core.sendCmd("signalingBatchMarkRead",{sid:15,cid:11,ids:[At]})},Ve.signalingMultiSyncNotificationHandler=function(_e){this.doNotify(_e.content.data,yv.kSelfSync)},Ve.doNotify=function(_e,At){At===void 0&&(At=yv.kDefault);var ar=function(Cn,Pn){Pn===void 0&&(Pn=yv.kDefault);var En=_i(kb,Cn),Nn=En.attach,zn=En.time,yo=En.msgId;En.fromAccid,En.toAccid,En.members,En.requestId,En.pushInfo;var fo=ri(En,["attach","time","msgId","fromAccid","toAccid","members","requestId","pushInfo"]),qo=Nn.type,ao=En.ext;return delete En.attach,{metaData:{eventType:qo,channelInfo:fo,feature:Pn,ext:ao,time:zn,msgId:yo},rawData:En}}(_e,At),Dt=ar.metaData,vr=ar.rawData,Cr=vr.fromAccid,Ar=vr.toAccid,$r=vr.members,jr=vr.requestId,Hr=vr.pushInfo,Kr=vr.msgId;switch(Dt.eventType){case ll.kClose:this.emit("signalingClose",{fromAccid:Cr,metaData:Dt});break;case ll.kJoin:this.emit("signalingJoin",{member:$r,metaData:Dt});break;case ll.kInvite:this.emit("signalingInvite",{fromAccid:Cr,toAccid:Ar,requestId:jr,pushInfo:Hr,metaData:Dt});break;case ll.kCancelInvite:this.emit("signalingCancelInvite",{fromAccid:Cr,toAccid:Ar,requestId:jr,metaData:Dt});break;case ll.kReject:this.emit("signalingReject",{toAccid:Ar,requestId:jr,metaData:Dt});break;case ll.kAccept:this.emit("signalingAccept",{toAccid:Ar,requestId:jr,metaData:Dt});break;case ll.kLeave:this.emit("signalingLeave",{fromAccid:Cr,metaData:Dt});break;case ll.kCustom:this.emit("signalingCustomCommand",{fromAccid:Cr,metaData:Dt});break;default:this.logger.warn("signaling:notification, no such a type "+Dt.eventType,vr)}return Kr},Ve.signalingSyncNotificationHandler=function(_e){var At,ar,Dt=this;if(_e.content.datas&&_e.content.datas.length>0){var vr=Bs(At=Fo(ar=_e.content.datas).call(ar,function(Cr){return Dt.doNotify(Cr)})).call(At,function(Cr){return Cr});vr.length>0&&this.core.sendCmd("signalingBatchMarkRead",{sid:15,cid:11,ids:vr})}},Ve.singalingSyncChannelsHandler=function(_e){var At;if(this.timer=0,this.channels={},_e.content.datas&&_e.content.datas.length>0){var ar=Fo(At=_e.content.datas).call(At,function(Dt){return Cp(Dt)});this.emit("singalingSyncChannels",ar)}},Ve.process=function(_e){var At=this[_e.cmd+"Handler"];return typeof At=="function"?(At.call(this,_e),xo.resolve(_e)):_e.error&&!_e.error.ignore?xo.reject(_e.error):xo.resolve(_e)},he}(hi.EventEmitter);return ss.setAdapters(Iy),ss.registerService(Ly,"auth"),ss.registerService(Jy,"msg"),ss.registerService(zT,"misc"),ss.registerService(eb,"user"),ss.registerService(CC,"session"),ss.registerService(FC,"team"),ss.registerService(DC,"systemMessage"),ss.registerService(VC,"friend"),ss.registerService(pe,"event"),ss.registerService(Pt,"msgExtend"),ss.registerService(Dn,"msgLog"),ss.registerService(co,"passThrough"),ss.registerService(Qo,"cloudStorage"),ss.registerService(rM,"superTeam"),ss.registerService(yf,"sync"),ss.registerService(aM,"plugin"),ss.registerService(uM,"cloudSession"),ss.registerService(fM,"signaling"),ss})})(NIM_BROWSER_SDK);var NIM_BROWSER_SDKExports=NIM_BROWSER_SDK.exports;const NIMSDK=getDefaultExportFromCjs(NIM_BROWSER_SDKExports),elBadge="",elMessage="",_hoisted_1$9={class:"mt10"},_hoisted_2$4={style:{color:"gray","font-size":"small"}},_hoisted_3$4={class:"mt10"},_hoisted_4$4=createBaseVNode("label",null,"当前时间：",-1),_hoisted_5$3={style:{color:"gray"}},_hoisted_6$2={class:"mt10"},_hoisted_7$1=createBaseVNode("label",null,"上次启动：",-1),_hoisted_8$1={style:{color:"gray"}},_hoisted_9={class:"mt10"},_hoisted_10=createBaseVNode("label",null,"运行时长：",-1),_hoisted_11={style:{color:"gray"}},_hoisted_12=createBaseVNode("span",{title:"每分钟更新一次"},"错误日志",-1),_hoisted_13={style:{"margin-top":"-3px"}},_hoisted_14={style:{cursor:"pointer"}},_hoisted_15=["onClick"],_hoisted_16=createBaseVNode("span",{title:"每分钟更新一次"},"数据总览",-1),_hoisted_17=createBaseVNode("label",null,"日志",-1),_hoisted_18={class:"fs14"},_hoisted_19={key:0,class:"fs14"},_hoisted_20={key:1,class:"fs14"},_hoisted_21={class:"fs14"},_hoisted_22=createBaseVNode("label",null,"图片信息",-1),_hoisted_23={class:"fs14"},_hoisted_24={class:"fs14"},_hoisted_25={class:"fs14"},_hoisted_26={key:0},_hoisted_27=createBaseVNode("label",null,"插件信息",-1),_hoisted_28={class:"fs14"},_hoisted_29={class:"fs14"},_hoisted_30={class:"fs14"},_hoisted_31=createBaseVNode("span",{title:"实时更新"},"口袋消息",-1),_hoisted_32={style:{"margin-top":"-3px","margin-left":"-20px"}},_hoisted_33={style:{color:"gray","font-size":"14px"}},_hoisted_34=["onClick"],_hoisted_35={key:1},_hoisted_36={key:2},_hoisted_37=["href"],_hoisted_38=createBaseVNode("div",null,[createBaseVNode("span",null,"1、QQ机器人部署(2选1)："),createBaseVNode("div",{class:"mt5"},[createBaseVNode("a",{href:"https://llonebot.github.io/zh-CN/",target:"_blank"},"LLOneBot"),createBaseVNode("span",{style:{"font-size":"14px",color:"gray"}},"：配置简单，可视化配置，占用电脑资源较高(>=300m内存)")]),createBaseVNode("div",{class:"mt5"},[createBaseVNode("a",{href:"https://napneko.github.io/zh-CN/",target:"_blank"},"NapCatBot"),createBaseVNode("span",{style:{"font-size":"14px",color:"gray"}},"：非可视化配置，配置过程相对LLOneBot复杂，占用资源低( <=100m内存) ")])],-1),_hoisted_39=createBaseVNode("div",{class:"mt10"},[createBaseVNode("span",null,"2、配置项说明："),createBaseVNode("a",{href:"https://gitee.com/jaffoo/ParkerBot#配置教程",target:"_blank"},"参照此文档"),createBaseVNode("span",{style:{"font-size":"14px",color:"gray"}})],-1),_hoisted_40=createBaseVNode("div",{class:"mt10"},[createBaseVNode("span",null,"3、联系作者QQ："),createBaseVNode("span",{style:{color:"blue"}},"1615842006")],-1),_hoisted_41={style:{"margin-top":"-3px","margin-left":"-20px"}},_hoisted_42={style:{cursor:"pointer"}},_hoisted_43=["onClick"],_sfc_main$e=defineComponent({__name:"index",props:{enable:{type:Object,default:{bot:!1,qq:!1,wb:!1,bz:!1,kd:!1,xhs:!1,dy:!1,bd:!1}}},setup(t){const r=t,e=ref(),n=ref("点击启动"),g=ref(""),y=ref(),i=ref(),k=ref(!1),L=ref("无记录"),$=ref("0小时0分钟"),V=ref(),z=ref(),re=ref({pic:{total:0,today:0,old:0},plugin:{total:0,using:0,unusing:0},log:{total:0,idol:0,other:0,system:0}}),oe=ref(),le=ref(),ue=ref(),ie=ref(),ae=ref(),Ie=ref("help"),de=async()=>{var Sr,wr;if(Object.values(r.enable).every(kr=>kr===!1)){ElMessageBox.alert("没有启用任何功能");return}n.value="启动中！",ie.value||tr(),ae.value||or(),Ue();let gr=await startBot();if(gr.success)ElMessage.success("启动成功"),k.value=!0,n.value="正在运行",localStorage.setItem("lastStart",g.value),L.value=g.value,r.enable.bd&&((wr=(Sr=e.value)==null?void 0:Sr.bd)!=null&&wr.saveAliyunDisk)&&await startAliYunPan();else{let kr=gr.msg??"启动失败：未知错误";ElMessage.error(kr),logApi().addSystem(kr),dr(),n.value="点击启动"}r.enable.kd&&(await qe(),jt())},Ce=()=>{n.value="关闭中！",ElMessageBox.confirm("确定要关闭机器人吗？","温馨提示！",{type:"warning",confirmButtonText:"关闭",cancelButtonText:"我点错了"}).then(async()=>{await startBot(!1),ElMessage.success("关闭成功"),k.value=!1,n.value="点击启动"}).catch(()=>{k.value=!0,n.value="正在运行"})},Ue=()=>{oe.value&&oe.value.destroy(),le.value&&le.value.destroy(),ue.value&&ue.value.disconnect()},qe=async()=>{if(Ue(),e.value&&e.value.kd)try{oe.value=new NIMSDK({appkey:atob(e.value.kd.appKey),account:e.value.kd.account,token:e.value.kd.token}),await oe.value.connect(),le.value=new QChatSDK({appkey:atob(e.value.kd.appKey),account:e.value.kd.account,token:e.value.kd.token,linkAddresses:await oe.value.plugin.getQChatAddress({ipType:2})}),le.value.on("logined",Fe),le.value.on("message",Et),le.value.on("disconnect",cr),await le.value.login()}catch(lr){throw lr}},jt=()=>{ue.value=new NimChatroomSocket({liveId:e.value.kd.liveRoomId,onMessage:er}),ue.value.init(e.value.kd.appKey)},Fe=async function(){var lr=`口袋已登录。正在进入小偶像${e.value.kd.idolName}的口袋房间。`;if(logApi().addSystem(lr),le.value==null)throw"进入口袋房间失败，聊天室未成功实例化";if((await le.value.qchatServer.subscribeAllChannel({type:1,serverIds:[e.value.kd.serverId]})).failServerIds.length){lr=`进入小偶像${e.value.kd.idolName}的口袋房间失败。请检查配置后重试，如仍有问题，请联系开发者。`,logApi().addSystem(lr);return}lr=`成功进入小偶像${e.value.kd.idolName}的口袋房间。`,logApi().addSystem(lr)},Et=async function(lr){var Sr,wr,kr,mr,Ir,Nr;lr.fromType=1,lr.ext=JSON.parse(lr.ext),lr.channelName=await nr(lr.channelId),lr.time=dayjs(lr.time).format("YYYY-MM-DD HH:mm:ss"),await postMsg({content:JSON.stringify(lr)});let gr={type:"text",name:lr.ext.user.nickName,time:lr.time,avatar:((wr=(Sr=e.value)==null?void 0:Sr.kd)==null?void 0:wr.imgDomain)+lr.ext.user.avatar,color:"#409eff",channel:lr.channelName,idol:(mr=(kr=e.value)==null?void 0:kr.kd)==null?void 0:mr.idolName,roleId:lr.ext.user.roleId};lr.type=="text"?gr.content=lr.body:lr.type=="image"?(gr.type="pic",gr.url=(Ir=lr==null?void 0:lr.attach)==null?void 0:Ir.url):lr.type=="video"||lr.type=="audio"?(gr.type="link",gr.url=(Nr=lr==null?void 0:lr.attach)==null?void 0:Nr.url):gr.content="暂不支持此类型消息，请前往口袋查看。",logApi().add(gr),gr.roleId==3&&dr()},cr=function(...lr){logApi().addSystem("口袋登录连接状态已断开。")},er=function(lr,gr){gr.forEach(Sr=>{postMsg({content:JSON.stringify(Sr)},1)})},nr=async function(lr){if(le.value==null)return;const gr=await le.value.qchatChannel.getChannels({channelIds:[`${lr}`]});return gr?gr[0].name:""},dr=()=>{var gr;let lr=logApi().getLogs();!lr||lr.length<=0||(z.value=lr.filter(Sr=>Sr.type=="system").splice(0,10).reverse(),(gr=e.value)!=null&&gr.enableModule.kd&&(lr=lr.filter(Sr=>Sr.roleId==3),V.value=lr.slice(0,10).reverse()))},ir=(lr,gr="错误")=>{ElMessageBox.alert(lr,gr+"详情")},tr=()=>{ie.value=setInterval(ur,1e3*60)},ur=async()=>{i.value=(await getLogs()).data.reverse();let lr=(await getFun()).data,gr=await getCache({pageIndex:1,pageSize:9999});re.value.plugin.total=lr.length,re.value.plugin.unusing=lr.filter(wr=>!wr.status).length,re.value.plugin.using=lr.filter(wr=>wr.status).length,re.value.pic.total=gr.count,re.value.pic.today=gr.data.filter(wr=>new Date(wr.createDate).getDate()===new Date().getDate()).length,re.value.pic.old=re.value.pic.total-re.value.pic.today;let Sr=logApi().getLogs();Sr&&(re.value.log.total=Sr.length??0,re.value.log.idol=Sr.filter(wr=>wr.roleId==3).length,re.value.log.system=Sr.filter(wr=>wr.type=="system").length,re.value.log.other=re.value.log.total-re.value.log.idol)},or=()=>{ae.value=setInterval(fr,1e3)},fr=()=>{var lr=new Date,gr=lr.getHours();g.value=lr.toLocaleString(),gr>=0&&gr<=6&&(y.value="凌晨好"),gr>=7&&gr<=10&&(y.value="上午好"),gr>=11&&gr<=13&&(y.value="中午好"),gr>=14&&gr<=17&&(y.value="下午好"),gr>=18&&gr<=19&&(y.value="傍晚好"),gr>=20&&gr<=23&&(y.value="晚上好");let Sr=localStorage.getItem("lastStart");if(Sr)L.value=Sr;else if(L.value=="无记录")$.value="0小时0分钟";else{let Ir=new Date(L.value);var wr=lr.getTime()-Ir.getTime(),kr=Math.floor(wr/(1e3*60*60)),mr=Math.floor(wr%(1e3*60*60)/(1e3*60));$.value=`${kr}小时${mr}分钟`}};return onMounted(async()=>{let lr=await getConfig();e.value=lr.data,ur(),fr(),or(),dr()}),(lr,gr)=>{const Sr=ElCol,wr=ElRow,kr=ElCard,mr=ElIcon,Ir=ElScrollbar,Nr=ElDivider,Er=ElImage;return openBlock(),createBlock(Ir,{style:{height:"calc(100vh - 30px)"}},{default:withCtx(()=>[createVNode(wr,null,{default:withCtx(()=>[createVNode(Sr,{span:12},{default:withCtx(()=>[createVNode(kr,{shadow:"hover",class:"ch250"},{header:withCtx(()=>[createTextVNode(" StarBot ")]),default:withCtx(()=>[createVNode(wr,null,{default:withCtx(()=>[createVNode(Sr,{span:6},{default:withCtx(()=>[k.value?(openBlock(),createElementBlock("img",{key:0,title:"点击关闭",onClick:Ce,src:_imports_0,style:{width:"100px",height:"100px",cursor:"pointer","margin-left":"-17px"}})):(openBlock(),createElementBlock("img",{key:1,title:"点击启动",onClick:de,src:_imports_1,style:{width:"100px",height:"100px",cursor:"pointer","margin-left":"-17px"}})),createBaseVNode("div",{style:normalizeStyle({color:k.value?"green":n.value.includes("启动中")?"red":"blue"})},[createBaseVNode("span",null,toDisplayString(n.value),1)],4)]),_:1}),createVNode(Sr,{span:18},{default:withCtx(()=>[createBaseVNode("div",_hoisted_1$9,[createBaseVNode("span",_hoisted_2$4,toDisplayString(y.value)+"！生活变的再糟糕，也不妨碍我变得更好！",1)]),createBaseVNode("div",_hoisted_3$4,[_hoisted_4$4,createBaseVNode("span",_hoisted_5$3,toDisplayString(g.value),1)]),createBaseVNode("div",_hoisted_6$2,[_hoisted_7$1,createBaseVNode("span",_hoisted_8$1,toDisplayString(L.value),1)]),createBaseVNode("div",_hoisted_9,[_hoisted_10,createBaseVNode("span",_hoisted_11,toDisplayString(k.value?"已运行"+$.value:"未启动"),1)])]),_:1})]),_:1})]),_:1})]),_:1}),createVNode(Sr,{span:1}),createVNode(Sr,{span:11},{default:withCtx(()=>[createVNode(kr,{shadow:"hover",class:"ch250"},{header:withCtx(()=>[createVNode(wr,null,{default:withCtx(()=>[createVNode(Sr,null,{default:withCtx(()=>[_hoisted_12,createVNode(mr,{size:18},{default:withCtx(()=>[createVNode(unref(refresh_default),{class:"et5",onClick:gr[0]||(gr[0]=async()=>i.value=(await unref(getLogs)()).data.reverse())})]),_:1})]),_:1})]),_:1})]),default:withCtx(()=>[createVNode(Ir,{height:"180px",style:{"margin-top":"-10px","margin-left":"-20px"}},{default:withCtx(()=>[createBaseVNode("ul",_hoisted_13,[(openBlock(!0),createElementBlock(Fragment,null,renderList(i.value,sr=>(openBlock(),createElementBlock("li",_hoisted_14,[createBaseVNode("span",{onClick:xr=>ir(sr.content),title:"点击查看"},toDisplayString(sr.content.substring(0,20))+"--"+toDisplayString(sr.time),9,_hoisted_15)]))),256))])]),_:1})]),_:1})]),_:1})]),_:1}),createVNode(wr,{style:{"margin-top":"20px"}},{default:withCtx(()=>[createVNode(Sr,{span:24},{default:withCtx(()=>[createVNode(kr,{shadow:"hover",header:"快速预览",class:"chauto"},{default:withCtx(()=>[createVNode(wr,{gutter:15},{default:withCtx(()=>[createVNode(Sr,{span:8},{default:withCtx(()=>[createVNode(kr,{shadow:"hover",class:"ch320"},{header:withCtx(()=>[_hoisted_16]),default:withCtx(()=>[createBaseVNode("div",null,[_hoisted_17,createBaseVNode("div",null,[createBaseVNode("span",_hoisted_18,"全部:"+toDisplayString(re.value.log.total),1),createVNode(Nr,{direction:"vertical"}),t.enable.kd?(openBlock(),createElementBlock("span",_hoisted_19,"偶像:"+toDisplayString(re.value.log.idol),1)):(openBlock(),createElementBlock("span",_hoisted_20,"系统:"+toDisplayString(re.value.log.system),1)),createVNode(Nr,{direction:"vertical"}),createBaseVNode("span",_hoisted_21,"其他:"+toDisplayString(re.value.log.other),1)])]),createVNode(Nr),createBaseVNode("div",null,[_hoisted_22,createBaseVNode("div",null,[createBaseVNode("span",_hoisted_23,"全部:"+toDisplayString(re.value.pic.total),1),createVNode(Nr,{direction:"vertical"}),createBaseVNode("span",_hoisted_24,"今日:"+toDisplayString(re.value.pic.today),1),createVNode(Nr,{direction:"vertical"}),createBaseVNode("span",_hoisted_25,"更早:"+toDisplayString(re.value.pic.old),1)])]),createVNode(Nr),t.enable.bot?(openBlock(),createElementBlock("div",_hoisted_26,[_hoisted_27,createBaseVNode("div",null,[createBaseVNode("span",_hoisted_28,"全部:"+toDisplayString(re.value.plugin.total),1),createVNode(Nr,{direction:"vertical"}),createBaseVNode("span",_hoisted_29,"启用:"+toDisplayString(re.value.plugin.using),1),createVNode(Nr,{direction:"vertical"}),createBaseVNode("span",_hoisted_30,"禁用:"+toDisplayString(re.value.plugin.unusing),1)])])):createCommentVNode("",!0)]),_:1})]),_:1}),t.enable.kd?(openBlock(),createBlock(Sr,{key:0,span:8},{default:withCtx(()=>[createVNode(kr,{shadow:"hover",class:"ch320"},{header:withCtx(()=>[_hoisted_31]),default:withCtx(()=>[createVNode(Ir,{height:"250px",style:{"margin-top":"-10px"}},{default:withCtx(()=>[createBaseVNode("ul",_hoisted_32,[(openBlock(!0),createElementBlock(Fragment,null,renderList(V.value,sr=>{var xr,Or;return openBlock(),createElementBlock("li",null,[createBaseVNode("span",null,toDisplayString(sr.name),1),createBaseVNode("span",_hoisted_33,toDisplayString(sr.time),1),sr.type=="text"?(openBlock(),createElementBlock("div",{key:0,onClick:Mr=>ir(sr.content,"口袋消息"),title:"点击查看",style:{color:"skyblue",cursor:"pointer"}},toDisplayString((xr=sr.content)==null?void 0:xr.substring(0,20))+" "+toDisplayString((((Or=sr.content)==null?void 0:Or.length)||0)>20?"...":""),9,_hoisted_34)):createCommentVNode("",!0),sr.type=="pic"?(openBlock(),createElementBlock("div",_hoisted_35,[createVNode(Er,{src:sr.url,"preview-src-list":[sr.url],style:{width:"120px",height:"auto"}},null,8,["src","preview-src-list"])])):createCommentVNode("",!0),sr.type=="link"?(openBlock(),createElementBlock("div",_hoisted_36,[createBaseVNode("a",{target:"_blank",href:sr.url},"此消息带链接，点击查看！",8,_hoisted_37)])):createCommentVNode("",!0)])}),256))])]),_:1})]),_:1})]),_:1})):createCommentVNode("",!0),withDirectives(createVNode(Sr,{span:8},{default:withCtx(()=>[createVNode(kr,{shadow:"hover",class:"ch320"},{header:withCtx(()=>[createTextVNode("帮助反馈 "),createVNode(mr,{size:16},{default:withCtx(()=>[createVNode(unref(switch_default),{class:"et2",circle:"",onClick:gr[1]||(gr[1]=()=>Ie.value="log")})]),_:1})]),default:withCtx(()=>[_hoisted_38,_hoisted_39,_hoisted_40]),_:1})]),_:1},512),[[vShow,Ie.value=="help"]]),withDirectives(createVNode(Sr,{span:8},{default:withCtx(()=>[createVNode(kr,{shadow:"hover",class:"ch320"},{header:withCtx(()=>[createTextVNode("本地日志 "),createVNode(mr,{size:16},{default:withCtx(()=>[createVNode(unref(switch_default),{class:"et2",circle:"",onClick:gr[2]||(gr[2]=()=>Ie.value="help")})]),_:1})]),default:withCtx(()=>[createVNode(Ir,{height:"250px",style:{"margin-top":"-10px"}},{default:withCtx(()=>[createBaseVNode("ul",_hoisted_41,[(openBlock(!0),createElementBlock(Fragment,null,renderList(z.value,sr=>{var xr;return openBlock(),createElementBlock("li",_hoisted_42,[createBaseVNode("span",{onClick:Or=>ir(sr.content??"","日志"),title:"点击查看"},toDisplayString((xr=sr.content)==null?void 0:xr.substring(0,20))+"--"+toDisplayString(sr.time),9,_hoisted_43)])}),256))])]),_:1})]),_:1})]),_:1},512),[[vShow,Ie.value=="log"]])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})}}}),index_vue_vue_type_style_index_0_lang="",elAffix="",elButton="",elForm="",elFormItem="",elCheckbox="",_sfc_main$d=defineComponent({__name:"enable",props:{enable:{type:Object,default:{qq:!1,wb:!1,bz:!1,kd:!1,xhs:!1,dy:!1,bd:!1}}},emits:["enable-change"],setup(t,{emit:r}){var n=toRef(t.enable);const g=r;watch(n.value,()=>{g("enable-change",n.value)});const y=i=>{n.value.qq=i};return(i,k)=>{const L=ElCheckbox,$=ElFormItem,V=ElForm;return openBlock(),createBlock(V,{ref:"bdform","label-width":"150px","label-position":"left"},{default:withCtx(()=>[createVNode($,{label:"启用模块："},{default:withCtx(()=>[createVNode(L,{modelValue:unref(n).bot,"onUpdate:modelValue":k[0]||(k[0]=z=>unref(n).bot=z),label:"QQ&Bot",onChange:y},null,8,["modelValue"]),createVNode(L,{modelValue:unref(n).wb,"onUpdate:modelValue":k[1]||(k[1]=z=>unref(n).wb=z),label:"微博"},null,8,["modelValue"]),createVNode(L,{modelValue:unref(n).bz,"onUpdate:modelValue":k[2]||(k[2]=z=>unref(n).bz=z),label:"B站"},null,8,["modelValue"]),createVNode(L,{modelValue:unref(n).kd,"onUpdate:modelValue":k[3]||(k[3]=z=>unref(n).kd=z),label:"口袋48"},null,8,["modelValue"]),createVNode(L,{modelValue:unref(n).xhs,"onUpdate:modelValue":k[4]||(k[4]=z=>unref(n).xhs=z),label:"小红书"},null,8,["modelValue"]),createVNode(L,{modelValue:unref(n).bd,"onUpdate:modelValue":k[5]||(k[5]=z=>unref(n).bd=z),label:"百度"},null,8,["modelValue"]),createVNode(L,{modelValue:unref(n).dy,"onUpdate:modelValue":k[6]||(k[6]=z=>unref(n).dy=z),label:"抖音"},null,8,["modelValue"])]),_:1})]),_:1},512)}}}),elInput="",_hoisted_1$8=createBaseVNode("span",{id:"bot"},"机器人",-1),_sfc_main$c=defineComponent({__name:"bot",props:{bot:{type:Object,default:{host:"",websocktPort:"",httpPort:"",token:""}}},setup(t,{expose:r}){const e=ref(),n=ref({host:[{required:!0,message:"请输入该值",trigger:"blur"}],websocktPort:[{required:!0,message:"请输入该值",trigger:"blur"}],httpPort:[{required:!0,message:"请输入该值",trigger:"blur"}]});return r({validForm:async()=>{var y;return await((y=e.value)==null?void 0:y.validate(i=>!!i))}}),(y,i)=>{const k=ElInput,L=ElFormItem,$=ElForm,V=ElCard;return openBlock(),createBlock(V,{class:"card-bot"},{header:withCtx(()=>[_hoisted_1$8]),default:withCtx(()=>[createVNode($,{ref_key:"botform",ref:e,rules:n.value,model:t.bot,"label-width":"150px","label-position":"left"},{default:withCtx(()=>[createVNode(L,{label:"IP地址",prop:"host"},{default:withCtx(()=>[createVNode(k,{modelValue:t.bot.host,"onUpdate:modelValue":i[0]||(i[0]=z=>t.bot.host=z)},null,8,["modelValue"])]),_:1}),createVNode(L,{label:"WebScoket端口",prop:"websocktPort"},{default:withCtx(()=>[createVNode(k,{modelValue:t.bot.websocktPort,"onUpdate:modelValue":i[1]||(i[1]=z=>t.bot.websocktPort=z)},null,8,["modelValue"])]),_:1}),createVNode(L,{label:"Http端口",prop:"httpPort"},{default:withCtx(()=>[createVNode(k,{modelValue:t.bot.httpPort,"onUpdate:modelValue":i[2]||(i[2]=z=>t.bot.httpPort=z)},null,8,["modelValue"])]),_:1}),createVNode(L,{label:"token"},{default:withCtx(()=>[createVNode(k,{modelValue:t.bot.token,"onUpdate:modelValue":i[3]||(i[3]=z=>t.bot.token=z)},null,8,["modelValue"])]),_:1})]),_:1},8,["rules","model"])]),_:1})}}}),elSwitch="",_hoisted_1$7=createBaseVNode("span",{id:"qq"},"QQ",-1),_sfc_main$b=defineComponent({__name:"qq",props:{qq:{type:Object,default:{funcAdmin:new Array,group:"",save:!1,admin:"",notice:!1,permission:"",debug:!1}}},setup(t,{expose:r}){const e=ref(),n=ref({admin:[{required:!0,message:"请输入该值",trigger:"blur"}]});return r({validForm:async()=>{var y;return await((y=e.value)==null?void 0:y.validate(i=>!!i))}}),(y,i)=>{const k=ElInput,L=ElFormItem,$=ElSwitch,V=ElForm,z=ElCard;return openBlock(),createBlock(z,{class:"card-qq"},{header:withCtx(()=>[_hoisted_1$7]),default:withCtx(()=>[createVNode(V,{ref_key:"qqform",ref:e,model:t.qq,rules:n.value,"label-width":"150px","label-position":"left"},{default:withCtx(()=>[createVNode(L,{label:"超管",prop:"admin"},{default:withCtx(()=>[createVNode(k,{modelValue:t.qq.admin,"onUpdate:modelValue":i[0]||(i[0]=re=>t.qq.admin=re)},null,8,["modelValue"])]),_:1}),createVNode(L,{label:"管理员",prop:"permission"},{default:withCtx(()=>[createVNode(k,{modelValue:t.qq.permission,"onUpdate:modelValue":i[1]||(i[1]=re=>t.qq.permission=re)},null,8,["modelValue"])]),_:1}),createVNode(L,{label:"群",prop:"group"},{default:withCtx(()=>[createVNode(k,{modelValue:t.qq.group,"onUpdate:modelValue":i[2]||(i[2]=re=>t.qq.group=re)},null,8,["modelValue"])]),_:1}),createVNode(L,{label:"程序错误通知"},{default:withCtx(()=>[createVNode($,{modelValue:t.qq.debug,"onUpdate:modelValue":i[3]||(i[3]=re=>t.qq.debug=re),"active-text":"启用","inactive-text":"禁用"},null,8,["modelValue"])]),_:1}),createVNode(L,{label:"普通消息通知"},{default:withCtx(()=>[createVNode($,{modelValue:t.qq.notice,"onUpdate:modelValue":i[4]||(i[4]=re=>t.qq.notice=re),"active-text":"启用","inactive-text":"禁用"},null,8,["modelValue"])]),_:1}),createVNode(L,{label:"保存群消息"},{default:withCtx(()=>[createVNode($,{modelValue:t.qq.save,"onUpdate:modelValue":i[5]||(i[5]=re=>t.qq.save=re),"active-text":"保存","inactive-text":"不保存"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1})}}}),elInputNumber="",_hoisted_1$6=createBaseVNode("span",{id:"wb"},"微博",-1),_hoisted_2$3=createBaseVNode("span",{style:{color:"red"}},"用于转发动态和图片保存，一般是填idol",-1),_hoisted_3$3=createBaseVNode("span",{style:{color:"red"}},"仅用于图片保存，一般是填返图用户",-1),_hoisted_4$3=createBaseVNode("span",{style:{color:"red"}},"监听某些用户是否发送了包含关键词的动态",-1),_sfc_main$a=defineComponent({__name:"wb",props:{wb:{type:Object,default:{userAll:"",userPart:"",chiGuaUser:"",keyword:"",chiGuaQQ:"",chiGuaForwardQQ:!1,chiGuaGroup:"",chiGuaForwardGroup:!1,timeSpan:3,group:"",forwardGroup:!1,forwardQQ:!1,qq:""}}},setup(t,{expose:r}){const e=ref(),n=ref({userAll:[{required:!0,message:"请输入该值",trigger:"blur"}]});return r({validForm:async()=>{var y;return await((y=e.value)==null?void 0:y.validate(i=>!!i))}}),(y,i)=>{const k=ElInput,L=ElFormItem,$=ElSwitch,V=ElInputNumber,z=ElForm,re=ElCard;return openBlock(),createBlock(re,{class:"card-wb"},{header:withCtx(()=>[_hoisted_1$6]),default:withCtx(()=>[createVNode(z,{ref_key:"wbform",ref:e,model:t.wb,rules:n.value,"label-width":"150px","label-position":"left"},{default:withCtx(()=>[createVNode(L,{label:"微博用户",prop:"userAll"},{default:withCtx(()=>[createVNode(k,{modelValue:t.wb.userAll,"onUpdate:modelValue":i[0]||(i[0]=oe=>t.wb.userAll=oe)},null,8,["modelValue"]),_hoisted_2$3]),_:1}),createVNode(L,{label:"返图用户"},{default:withCtx(()=>[createVNode(k,{modelValue:t.wb.userPart,"onUpdate:modelValue":i[1]||(i[1]=oe=>t.wb.userPart=oe)},null,8,["modelValue"]),_hoisted_3$3]),_:1}),createVNode(L,{label:"转发至群"},{default:withCtx(()=>[createVNode($,{modelValue:t.wb.forwardGroup,"onUpdate:modelValue":i[2]||(i[2]=oe=>t.wb.forwardGroup=oe),"active-text":"转发","inactive-text":"不转发"},null,8,["modelValue"])]),_:1}),t.wb.forwardGroup?(openBlock(),createBlock(L,{key:0,label:"群qq号"},{default:withCtx(()=>[createVNode(k,{modelValue:t.wb.group,"onUpdate:modelValue":i[3]||(i[3]=oe=>t.wb.group=oe)},null,8,["modelValue"])]),_:1})):createCommentVNode("",!0),createVNode(L,{label:"转发至好友"},{default:withCtx(()=>[createVNode($,{modelValue:t.wb.forwardQQ,"onUpdate:modelValue":i[4]||(i[4]=oe=>t.wb.forwardQQ=oe),"active-text":"转发","inactive-text":"不转发"},null,8,["modelValue"])]),_:1}),t.wb.forwardQQ?(openBlock(),createBlock(L,{key:1,label:"好友qq"},{default:withCtx(()=>[createVNode(k,{modelValue:t.wb.qq,"onUpdate:modelValue":i[5]||(i[5]=oe=>t.wb.qq=oe)},null,8,["modelValue"])]),_:1})):createCommentVNode("",!0),createVNode(L,{label:"吃瓜用户"},{default:withCtx(()=>[createVNode(k,{modelValue:t.wb.chiGuaUser,"onUpdate:modelValue":i[6]||(i[6]=oe=>t.wb.chiGuaUser=oe)},null,8,["modelValue"]),_hoisted_4$3]),_:1}),createVNode(L,{label:"关键词"},{default:withCtx(()=>[createVNode(k,{modelValue:t.wb.keyword,"onUpdate:modelValue":i[7]||(i[7]=oe=>t.wb.keyword=oe)},null,8,["modelValue"])]),_:1}),createVNode(L,{label:"转发至群"},{default:withCtx(()=>[createVNode($,{modelValue:t.wb.chiGuaForwardGroup,"onUpdate:modelValue":i[8]||(i[8]=oe=>t.wb.chiGuaForwardGroup=oe),"active-text":"转发","inactive-text":"不转发"},null,8,["modelValue"])]),_:1}),t.wb.chiGuaForwardGroup?(openBlock(),createBlock(L,{key:2,label:"群qq号"},{default:withCtx(()=>[createVNode(k,{modelValue:t.wb.chiGuaGroup,"onUpdate:modelValue":i[9]||(i[9]=oe=>t.wb.chiGuaGroup=oe)},null,8,["modelValue"])]),_:1})):createCommentVNode("",!0),createVNode(L,{label:"转发至好友"},{default:withCtx(()=>[createVNode($,{modelValue:t.wb.chiGuaForwardQQ,"onUpdate:modelValue":i[10]||(i[10]=oe=>t.wb.chiGuaForwardQQ=oe),"active-text":"转发","inactive-text":"不转发"},null,8,["modelValue"])]),_:1}),t.wb.chiGuaForwardQQ?(openBlock(),createBlock(L,{key:3,label:"好友qq"},{default:withCtx(()=>[createVNode(k,{modelValue:t.wb.chiGuaQQ,"onUpdate:modelValue":i[11]||(i[11]=oe=>t.wb.chiGuaQQ=oe)},null,8,["modelValue"])]),_:1})):createCommentVNode("",!0),t.wb.forwardQQ||t.wb.forwardGroup||t.wb.chiGuaForwardGroup||t.wb.chiGuaForwardQQ?(openBlock(),createBlock(L,{key:4,label:"监听间隔"},{default:withCtx(()=>[createVNode(V,{modelValue:t.wb.timeSpan,"onUpdate:modelValue":i[12]||(i[12]=oe=>t.wb.timeSpan=oe)},null,8,["modelValue"])]),_:1})):createCommentVNode("",!0)]),_:1},8,["model","rules"])]),_:1})}}}),elCascader="",elTag="",elCascaderPanel="",elRadio="",elDialog="",elOverlay="",elCheckboxGroup="",elRadioGroup="",_hoisted_1$5=createBaseVNode("span",{id:"kd"},"口袋48",-1),_hoisted_2$2=createBaseVNode("span",{style:{color:"red"}},"*以上信息可通过查询获取",-1),_hoisted_3$2=createBaseVNode("span",{style:{color:"red"}},"*IM账号和IMtoken可点此登录口袋后自动获取",-1),_hoisted_4$2={key:0,style:{width:"95%","margin-top":"5px"}},_hoisted_5$2=createBaseVNode("span",null,"未查询到小偶像，检查名称等后重新查询或者点击下方地址自行获取小偶像信息填入：",-1),_sfc_main$9=defineComponent({__name:"kd",props:{kd:{type:Object,default:{group:"",forwardGroup:!1,forwardQQ:!1,qq:"",idolName:"",account:"",token:"",serverId:"",liveRoomId:"",msgTypeAll:new Array,msgType:[],saveMsg:0,saveImg:!1}}},setup(t,{expose:r}){const e=t,n=ref(),g=ref({idolName:[{required:!0,message:"请输入该值",trigger:"blur"}],serverId:[{required:!0,message:"请输入该值",trigger:"blur"}],liveRoomId:[{required:!0,message:"请输入该值",trigger:"blur"}],account:[{required:!0,message:"请输入该值",trigger:"blur"}],token:[{required:!0,message:"请输入该值",trigger:"blur"}],phone:[{required:!0,message:"请输入该值",trigger:"blur"}],code:[{required:!0,message:"请输入该值",trigger:"blur"}],name:[{required:!0,message:"请输入该值",trigger:"blur"}]}),y=ref(!1),i=ref({show:!1,group:[],name:"",loading:!1,url:""}),k=ref({phone:"",area:"86",hasSend:!1,code:"",sec:60}),L=ref([{label:"SNH48",value:"SNH48",children:[{value:"TEAM SII",label:"TEAM SII"},{value:"TEAM HII",label:"TEAM HII"},{value:"TEAM X",label:"TEAM X"}]},{label:"GNZ48",value:"GNZ48",children:[{value:"TEAM G",label:"TEAM G"},{value:"TEAM NIII",label:"TEAM NIII"},{value:"TEAM Z",label:"TEAM Z"},{value:"TEAM CII",label:"TEAM CII"}]},{label:"CGT48",value:"CGT48",children:[{value:"TEAM GII",label:"TEAM GII"}]},{label:"BEJ48",value:"BEJ48",children:[{value:"TEAM B",label:"TEAM B"},{value:"TEAM E",label:"TEAM E"}]},{label:"CKG48",value:"CKG48"}]),$=async()=>{if(!i.value.name){ElMessage({message:"请输入小偶像姓名",type:"error"});return}i.value.loading=!0;var ie=await searchIdol(i.value.group.toString(),i.value.name);if(ie.success){var ae=ie.data;e.kd.idolName=ae.name,e.kd.liveRoomId=ae.liveId,e.kd.serverId=ae.serverId,V()}else i.value.url=ie.msg||"";i.value.loading=!1},V=()=>{i.value.loading=!1,i.value.show=!1,i.value.name="",i.value.url="",i.value.group=[],y.value=!1,k.value.hasSend=!1,k.value.sec=60,k.value.code=""},z=async()=>{if(!k.value.phone){ElMessage({message:"请输入手机号码！",type:"warning"});return}var ie=/^1[3456789]\d{9}$/;if(ie.test(k.value.phone)==!1){ElMessage({message:"手机号码格式有误，请重新输入！",type:"warning"});return}k.value.hasSend=!0,oe();var ae=await sendSmsCode(k.value.phone,k.value.area);ae.success?ElMessage({message:"发送成功，请注意查收！",type:"success"}):(ElMessage({message:ae.msg||"发送失败！",type:"error"}),V())},re=async()=>{if(!k.value.phone){ElMessage({message:"请输入手机号码！",type:"warning"});return}if(!k.value.code){ElMessage({message:"请输入验证码！",type:"warning"});return}var ie=/^1[3456789]\d{9}$/;if(ie.test(k.value.phone)==!1){ElMessage({message:"手机号码格式有误，请重新输入！",type:"warning"});return}var ae=await pocketLogin(k.value.phone,k.value.code);if(ae.success){var Ie=await kdUserInfo({token:JSON.parse(ae.data).token});if(Ie.success){let de=JSON.parse(Ie.data);e.kd.token=de.pwd,e.kd.account=de.accid,setTimeout(()=>{V()},1e3),ElMessage({message:Ie.msg||"登录成功",type:"success"})}else ElMessage({message:Ie.msg||"登录失败！",type:"error"})}else ElMessage({message:ae.msg||"登录失败！",type:"error"})},oe=()=>{k.value.sec=60;let ie;ie=setInterval(()=>{k.value.sec>0?k.value.sec--:(clearInterval(ie),k.value.sec=60,k.value.hasSend=!1)},1e3)},le=async()=>{var ie;return await((ie=n.value)==null?void 0:ie.validate(ae=>!!ae))},ue=ie=>{openWindow(ie)};return r({validForm:le}),(ie,ae)=>{const Ie=ElInput,de=ElFormItem,Ce=ElButton,Ue=ElRadio,qe=ElRadioGroup,jt=ElCheckbox,Fe=ElCheckboxGroup$1,Et=ElSwitch,cr=ElForm,er=ElDialog,nr=ElCascader,dr=ElCard;return openBlock(),createBlock(dr,{class:"card-kd"},{header:withCtx(()=>[_hoisted_1$5]),default:withCtx(()=>[createVNode(cr,{ref_key:"kdform",ref:n,rules:g.value,model:t.kd,"label-width":"150px","label-position":"left"},{default:withCtx(()=>[createVNode(de,{label:"姓名",prop:"idolName"},{default:withCtx(()=>[createVNode(Ie,{modelValue:t.kd.idolName,"onUpdate:modelValue":ae[0]||(ae[0]=ir=>t.kd.idolName=ir)},null,8,["modelValue"])]),_:1}),createVNode(de,{label:"IMServerId",prop:"serverId"},{default:withCtx(()=>[createVNode(Ie,{modelValue:t.kd.serverId,"onUpdate:modelValue":ae[1]||(ae[1]=ir=>t.kd.serverId=ir)},null,8,["modelValue"])]),_:1}),createVNode(de,{label:"直播房间Id",prop:"liveRoomId"},{default:withCtx(()=>[createVNode(Ie,{modelValue:t.kd.liveRoomId,"onUpdate:modelValue":ae[2]||(ae[2]=ir=>t.kd.liveRoomId=ir)},null,8,["modelValue"])]),_:1}),createVNode(de,null,{default:withCtx(()=>[createVNode(Ce,{onClick:ae[3]||(ae[3]=ir=>i.value.show=!0)},{default:withCtx(()=>[createTextVNode("查询小偶像信息")]),_:1}),_hoisted_2$2]),_:1}),createVNode(de,{label:"IM账号",prop:"account"},{default:withCtx(()=>[createVNode(Ie,{modelValue:t.kd.account,"onUpdate:modelValue":ae[4]||(ae[4]=ir=>t.kd.account=ir)},null,8,["modelValue"])]),_:1}),createVNode(de,{label:"IMtoken",prop:"token"},{default:withCtx(()=>[createVNode(Ie,{modelValue:t.kd.token,"onUpdate:modelValue":ae[5]||(ae[5]=ir=>t.kd.token=ir)},null,8,["modelValue"])]),_:1}),createVNode(de,null,{default:withCtx(()=>[createVNode(Ce,{onClick:ae[6]||(ae[6]=ir=>y.value=!0)},{default:withCtx(()=>[createTextVNode("登录口袋48")]),_:1}),_hoisted_3$2]),_:1}),createVNode(de,{label:"保存消息"},{default:withCtx(()=>[createVNode(qe,{modelValue:t.kd.saveMsg,"onUpdate:modelValue":ae[7]||(ae[7]=ir=>t.kd.saveMsg=ir)},{default:withCtx(()=>[createVNode(Ue,{label:0,value:0},{default:withCtx(()=>[createTextVNode("不保存")]),_:1}),createVNode(Ue,{label:1,value:1},{default:withCtx(()=>[createTextVNode("仅小偶像")]),_:1}),createVNode(Ue,{label:2,value:2},{default:withCtx(()=>[createTextVNode("全部")]),_:1})]),_:1},8,["modelValue"])]),_:1}),createVNode(de,{label:"保存小偶像图片"},{default:withCtx(()=>[createVNode(qe,{modelValue:t.kd.saveImg,"onUpdate:modelValue":ae[8]||(ae[8]=ir=>t.kd.saveImg=ir)},{default:withCtx(()=>[createVNode(Ue,{label:!1,value:!1},{default:withCtx(()=>[createTextVNode("不保存")]),_:1}),createVNode(Ue,{label:!0,value:!0},{default:withCtx(()=>[createTextVNode("保存")]),_:1})]),_:1},8,["modelValue"])]),_:1}),createVNode(de,{label:"监听消息类型"},{default:withCtx(()=>[createVNode(Fe,{modelValue:t.kd.msgType,"onUpdate:modelValue":ae[9]||(ae[9]=ir=>t.kd.msgType=ir)},{default:withCtx(()=>[(openBlock(!0),createElementBlock(Fragment,null,renderList(t.kd.msgTypeAll,(ir,tr)=>(openBlock(),createBlock(jt,{label:ir.value,key:tr},{default:withCtx(()=>[createTextVNode(toDisplayString(ir.name),1)]),_:2},1032,["label"]))),128))]),_:1},8,["modelValue"])]),_:1}),createVNode(de,{label:"转发至群"},{default:withCtx(()=>[createVNode(Et,{modelValue:t.kd.forwardGroup,"onUpdate:modelValue":ae[10]||(ae[10]=ir=>t.kd.forwardGroup=ir),"active-text":"转发","inactive-text":"不转发"},null,8,["modelValue"])]),_:1}),t.kd.forwardGroup?(openBlock(),createBlock(de,{key:0,label:"群qq号"},{default:withCtx(()=>[createVNode(Ie,{modelValue:t.kd.group,"onUpdate:modelValue":ae[11]||(ae[11]=ir=>t.kd.group=ir)},null,8,["modelValue"])]),_:1})):createCommentVNode("",!0),createVNode(de,{label:"转发至好友"},{default:withCtx(()=>[createVNode(Et,{modelValue:t.kd.forwardQQ,"onUpdate:modelValue":ae[12]||(ae[12]=ir=>t.kd.forwardQQ=ir),"active-text":"转发","inactive-text":"不转发"},null,8,["modelValue"])]),_:1}),t.kd.forwardQQ?(openBlock(),createBlock(de,{key:1,label:"好友qq"},{default:withCtx(()=>[createVNode(Ie,{modelValue:t.kd.qq,"onUpdate:modelValue":ae[13]||(ae[13]=ir=>t.kd.qq=ir)},null,8,["modelValue"])]),_:1})):createCommentVNode("",!0)]),_:1},8,["rules","model"]),createVNode(er,{title:"登录口袋48",modelValue:y.value,"onUpdate:modelValue":ae[16]||(ae[16]=ir=>y.value=ir),"before-close":V,"close-on-click-modal":!1},{default:withCtx(()=>[createVNode(cr,{"label-width":"100px",rules:g.value,model:k.value},{default:withCtx(()=>[createVNode(de,{label:"手机号",class:"mt-4",prop:"phone"},{default:withCtx(()=>[createVNode(Ie,{modelValue:k.value.phone,"onUpdate:modelValue":ae[14]||(ae[14]=ir=>k.value.phone=ir),style:{width:"95%"}},{prepend:withCtx(()=>[createTextVNode("+"+toDisplayString(k.value.area),1)]),_:1},8,["modelValue"])]),_:1}),createVNode(de,{label:"验证码",prop:"code"},{default:withCtx(()=>[createVNode(Ie,{type:"primary",modelValue:k.value.code,"onUpdate:modelValue":ae[15]||(ae[15]=ir=>k.value.code=ir),style:{width:"65%"}},null,8,["modelValue"]),withDirectives(createVNode(Ce,{style:{width:"25%","margin-left":"5%"},onClick:z},{default:withCtx(()=>[createTextVNode("发送验证码")]),_:1},512),[[vShow,!k.value.hasSend]]),withDirectives(createVNode(Ce,{style:{width:"25%","margin-left":"5%"}},{default:withCtx(()=>[createTextVNode(toDisplayString(k.value.sec)+"秒",1)]),_:1},512),[[vShow,k.value.hasSend]])]),_:1}),createVNode(de,null,{default:withCtx(()=>[createVNode(Ce,{type:"primary",onClick:re},{default:withCtx(()=>[createTextVNode("登录")]),_:1})]),_:1})]),_:1},8,["rules","model"])]),_:1},8,["modelValue"]),createVNode(er,{title:"查询小偶像 ",modelValue:i.value.show,"onUpdate:modelValue":ae[20]||(ae[20]=ir=>i.value.show=ir),"before-close":V,"close-on-click-modal":!1},{default:withCtx(()=>[createVNode(cr,{"label-width":"100px",rules:g.value,model:i.value},{default:withCtx(()=>[createVNode(de,{label:"队伍",class:"mt-4"},{default:withCtx(()=>[createVNode(nr,{props:{expandTrigger:"hover",checkStrictly:"true"},placeholder:"请选择",modelValue:i.value.group,"onUpdate:modelValue":ae[17]||(ae[17]=ir=>i.value.group=ir),options:L.value,style:{width:"95%"}},null,8,["modelValue","options"])]),_:1}),createVNode(de,{label:"姓名",prop:"name"},{default:withCtx(()=>[createVNode(Ie,{modelValue:i.value.name,"onUpdate:modelValue":ae[18]||(ae[18]=ir=>i.value.name=ir),style:{width:"95%"}},null,8,["modelValue"])]),_:1}),createVNode(de,null,{default:withCtx(()=>[createVNode(Ce,{type:"primary",loading:i.value.loading,onClick:$},{default:withCtx(()=>[createTextVNode("查询")]),_:1},8,["loading"])]),_:1}),i.value.url?(openBlock(),createElementBlock("div",_hoisted_4$2,[_hoisted_5$2,createBaseVNode("a",{style:{"word-break":"break-all"},onClick:ae[19]||(ae[19]=ir=>ue(i.value.url))},toDisplayString(i.value.url),1)])):createCommentVNode("",!0)]),_:1},8,["rules","model"])]),_:1},8,["modelValue"])]),_:1})}}}),_hoisted_1$4=createBaseVNode("span",{id:"bz"},"b站",-1),_sfc_main$8=defineComponent({__name:"bz",props:{bz:{type:Object,default:{user:"",group:"",forwardGroup:!1,forwardQQ:!1,qq:"",timeSpan:3}}},setup(t,{expose:r}){const e=ref(),n=ref({user:[{required:!0,message:"请输入该值",trigger:"blur"}]});return r({validForm:async()=>{var y;return await((y=e.value)==null?void 0:y.validate(i=>!!i))}}),(y,i)=>{const k=ElInput,L=ElFormItem,$=ElSwitch,V=ElInputNumber,z=ElForm,re=ElCard;return openBlock(),createBlock(re,{class:"card-bz"},{header:withCtx(()=>[_hoisted_1$4]),default:withCtx(()=>[createVNode(z,{ref_key:"bzform",ref:e,model:t.bz,rules:n.value,"label-width":"150px","label-position":"left"},{default:withCtx(()=>[createVNode(L,{label:"b站用户",prop:"user"},{default:withCtx(()=>[createVNode(k,{modelValue:t.bz.user,"onUpdate:modelValue":i[0]||(i[0]=oe=>t.bz.user=oe)},null,8,["modelValue"])]),_:1}),createVNode(L,{label:"转发至群"},{default:withCtx(()=>[createVNode($,{modelValue:t.bz.forwardGroup,"onUpdate:modelValue":i[1]||(i[1]=oe=>t.bz.forwardGroup=oe),"active-text":"转发","inactive-text":"不转发"},null,8,["modelValue"])]),_:1}),t.bz.forwardGroup?(openBlock(),createBlock(L,{key:0,label:"群qq号"},{default:withCtx(()=>[createVNode(k,{modelValue:t.bz.group,"onUpdate:modelValue":i[2]||(i[2]=oe=>t.bz.group=oe)},null,8,["modelValue"])]),_:1})):createCommentVNode("",!0),createVNode(L,{label:"转发至好友"},{default:withCtx(()=>[createVNode($,{modelValue:t.bz.forwardQQ,"onUpdate:modelValue":i[3]||(i[3]=oe=>t.bz.forwardQQ=oe),"active-text":"转发","inactive-text":"不转发"},null,8,["modelValue"])]),_:1}),t.bz.forwardQQ?(openBlock(),createBlock(L,{key:1,label:"好友qq"},{default:withCtx(()=>[createVNode(k,{modelValue:t.bz.qq,"onUpdate:modelValue":i[4]||(i[4]=oe=>t.bz.qq=oe)},null,8,["modelValue"])]),_:1})):createCommentVNode("",!0),t.bz.forwardQQ||t.bz.forwardGroup?(openBlock(),createBlock(L,{key:2,label:"监听间隔"},{default:withCtx(()=>[createVNode(V,{modelValue:t.bz.timeSpan,"onUpdate:modelValue":i[5]||(i[5]=oe=>t.bz.timeSpan=oe)},null,8,["modelValue"])]),_:1})):createCommentVNode("",!0)]),_:1},8,["model","rules"])]),_:1})}}}),_hoisted_1$3=createBaseVNode("span",{id:"xhs"},"小红书",-1),_sfc_main$7=defineComponent({__name:"xhs",props:{xhs:{type:Object,default:{user:"",group:"",forwardGroup:!1,forwardQQ:!1,qq:"",timeSpan:3}}},setup(t,{expose:r}){const e=ref(),n=ref({user:[{required:!0,message:"请输入该值",trigger:"blur"}]});return r({validForm:async()=>{var y;return await((y=e.value)==null?void 0:y.validate(i=>!!i))}}),(y,i)=>{const k=ElInput,L=ElFormItem,$=ElSwitch,V=ElInputNumber,z=ElForm,re=ElCard;return openBlock(),createBlock(re,{class:"card-xhs"},{header:withCtx(()=>[_hoisted_1$3]),default:withCtx(()=>[createVNode(z,{ref_key:"xhsform",ref:e,model:t.xhs,rules:n.value,"label-width":"150px","label-position":"left"},{default:withCtx(()=>[createVNode(L,{label:"小红书用户",prop:"user"},{default:withCtx(()=>[createVNode(k,{modelValue:t.xhs.user,"onUpdate:modelValue":i[0]||(i[0]=oe=>t.xhs.user=oe)},null,8,["modelValue"])]),_:1}),createVNode(L,{label:"转发至群"},{default:withCtx(()=>[createVNode($,{modelValue:t.xhs.forwardGroup,"onUpdate:modelValue":i[1]||(i[1]=oe=>t.xhs.forwardGroup=oe),"active-text":"转发","inactive-text":"不转发"},null,8,["modelValue"])]),_:1}),t.xhs.forwardGroup?(openBlock(),createBlock(L,{key:0,label:"群qq号"},{default:withCtx(()=>[createVNode(k,{modelValue:t.xhs.group,"onUpdate:modelValue":i[2]||(i[2]=oe=>t.xhs.group=oe)},null,8,["modelValue"])]),_:1})):createCommentVNode("",!0),createVNode(L,{label:"转发至好友"},{default:withCtx(()=>[createVNode($,{modelValue:t.xhs.forwardQQ,"onUpdate:modelValue":i[3]||(i[3]=oe=>t.xhs.forwardQQ=oe),"active-text":"转发","inactive-text":"不转发"},null,8,["modelValue"])]),_:1}),t.xhs.forwardQQ?(openBlock(),createBlock(L,{key:1,label:"好友qq"},{default:withCtx(()=>[createVNode(k,{modelValue:t.xhs.qq,"onUpdate:modelValue":i[4]||(i[4]=oe=>t.xhs.qq=oe)},null,8,["modelValue"])]),_:1})):createCommentVNode("",!0),t.xhs.forwardQQ||t.xhs.forwardGroup?(openBlock(),createBlock(L,{key:2,label:"监听间隔"},{default:withCtx(()=>[createVNode(V,{modelValue:t.xhs.timeSpan,"onUpdate:modelValue":i[5]||(i[5]=oe=>t.xhs.timeSpan=oe)},null,8,["modelValue"])]),_:1})):createCommentVNode("",!0)]),_:1},8,["model","rules"])]),_:1})}}}),elUpload="",elProgress="",_hoisted_1$2=createBaseVNode("span",{id:"bd"},"百度",-1),_hoisted_2$1=createBaseVNode("span",{style:{color:"red"}},"*上传人脸轮廓清晰的图片",-1),_hoisted_3$1=createBaseVNode("span",{style:{color:"red"}},"*直接保存(非双胞胎建议80，双胞胎建议70)",-1),_hoisted_4$1=createBaseVNode("span",{style:{color:"red"}},"*超过该值，但未超过上面的值，将加入审核列表，审核通过才会保存",-1),_hoisted_5$1=createBaseVNode("span",{style:{color:"red"}},"*启用会将图片自动上传到阿里云盘相册",-1),_hoisted_6$1=["src"],_sfc_main$6=defineComponent({__name:"bd",props:{bd:{type:Object,default:{appKey:"",appSeret:"",similarity:0,saveAliyunDisk:!1,audit:0,albumName:"",faceVerify:!1,imageList:new Array}}},setup(t,{expose:r}){const e=t,n=ref([]),g=ref(),y=re=>{n.value.push({name:re.data.name,url:re.data.url}),e.bd.imageList&&e.bd.imageList.push({name:re.data.name,url:re.data.url})};watchEffect(()=>{e.bd.imageList&&(n.value=JSON.parse(JSON.stringify(e.bd.imageList)))});const i=re=>{e.bd.imageList&&(e.bd.imageList=e.bd.imageList.filter(oe=>oe.name!==re.name))},k=ref(""),L=ref(!1),$=re=>{k.value=re.url,L.value=!0},V=ref({appKey:[{required:!0,message:"请输入该值",trigger:"blur"}],appSeret:[{required:!0,message:"请输入该值",trigger:"blur"}],albumName:[{required:!0,message:"请输入该值",trigger:"blur"}],imageList:[{required:!0,message:"请上传人脸",trigger:"change"}]});return r({validForm:async()=>{var re;return await((re=g.value)==null?void 0:re.validate(oe=>!!oe))}}),(re,oe)=>{const le=ElInput,ue=ElFormItem,ie=ElSwitch,ae=ElIcon,Ie=ElUpload,de=ElCol,Ce=ElForm,Ue=ElCard,qe=ElDialog;return openBlock(),createElementBlock(Fragment,null,[createVNode(Ue,{class:"card-bd",style:{"margin-top":"10px"}},{header:withCtx(()=>[_hoisted_1$2]),default:withCtx(()=>[createVNode(Ce,{ref_key:"bdform",ref:g,model:t.bd,rules:V.value,"label-width":"150px","label-position":"left"},{default:withCtx(()=>[createVNode(ue,{label:"apiKey",prop:"appKey"},{default:withCtx(()=>[createVNode(le,{modelValue:t.bd.appKey,"onUpdate:modelValue":oe[0]||(oe[0]=jt=>t.bd.appKey=jt),placeholder:"百度appKey"},null,8,["modelValue"])]),_:1}),createVNode(ue,{label:"appSeret",prop:"appSeret"},{default:withCtx(()=>[createVNode(le,{modelValue:t.bd.appSeret,"onUpdate:modelValue":oe[1]||(oe[1]=jt=>t.bd.appSeret=jt),placeholder:"百度appSeret"},null,8,["modelValue"])]),_:1}),createVNode(ue,{label:"开启人脸验证"},{default:withCtx(()=>[createVNode(ie,{modelValue:t.bd.faceVerify,"onUpdate:modelValue":oe[2]||(oe[2]=jt=>t.bd.faceVerify=jt),"active-value":!0,"inactive-value":!1},null,8,["modelValue"])]),_:1}),withDirectives(createVNode(ue,{label:"基础人脸",prop:"imageList"},{default:withCtx(()=>[createVNode(Ie,{"file-list":n.value,"onUpdate:fileList":oe[3]||(oe[3]=jt=>n.value=jt),action:unref(ApiPrefix)+"/upload","on-success":y,"on-preview":$,"on-remove":i,"list-type":"picture-card",limit:3,accept:".jpg,.png,.jpeg"},{default:withCtx(()=>[createVNode(ae,null,{default:withCtx(()=>[createVNode(unref(plus_default))]),_:1})]),_:1},8,["file-list","action"]),_hoisted_2$1,withDirectives(createVNode(le,{modelValue:t.bd.imageList,"onUpdate:modelValue":oe[4]||(oe[4]=jt=>t.bd.imageList=jt)},null,8,["modelValue"]),[[vShow,!1]])]),_:1},512),[[vShow,t.bd.faceVerify]]),withDirectives(createVNode(ue,{label:"人脸相似度"},{default:withCtx(()=>[createVNode(de,{span:8},{default:withCtx(()=>[createVNode(le,{type:"number",modelValue:t.bd.similarity,"onUpdate:modelValue":oe[5]||(oe[5]=jt=>t.bd.similarity=jt)},null,8,["modelValue"])]),_:1}),_hoisted_3$1]),_:1},512),[[vShow,t.bd.faceVerify]]),withDirectives(createVNode(ue,{label:"审核相似度"},{default:withCtx(()=>[createVNode(de,{span:8},{default:withCtx(()=>[createVNode(le,{type:"number",modelValue:t.bd.audit,"onUpdate:modelValue":oe[6]||(oe[6]=jt=>t.bd.audit=jt)},null,8,["modelValue"])]),_:1}),_hoisted_4$1]),_:1},512),[[vShow,t.bd.faceVerify]]),withDirectives(createVNode(ue,{label:"上传云盘"},{default:withCtx(()=>[createVNode(ie,{modelValue:t.bd.saveAliyunDisk,"onUpdate:modelValue":oe[7]||(oe[7]=jt=>t.bd.saveAliyunDisk=jt),"active-value":!0,"inactive-value":!1},null,8,["modelValue"]),_hoisted_5$1]),_:1},512),[[vShow,t.bd.faceVerify]]),withDirectives(createVNode(ue,{label:"相册名称",prop:"albumName"},{default:withCtx(()=>[createVNode(de,{span:8},{default:withCtx(()=>[createVNode(le,{modelValue:t.bd.albumName,"onUpdate:modelValue":oe[8]||(oe[8]=jt=>t.bd.albumName=jt)},null,8,["modelValue"])]),_:1})]),_:1},512),[[vShow,t.bd.saveAliyunDisk]])]),_:1},8,["model","rules"])]),_:1}),createVNode(qe,{modelValue:L.value,"onUpdate:modelValue":oe[9]||(oe[9]=jt=>L.value=jt)},{default:withCtx(()=>[createBaseVNode("img",{"w-full":"",style:{height:"auto",width:"100%"},src:k.value,alt:"Preview Image"},null,8,_hoisted_6$1)]),_:1},8,["modelValue"])],64)}}}),_hoisted_1$1=createBaseVNode("span",{id:"dy"},"抖音",-1),_sfc_main$5=defineComponent({__name:"dy",props:{dy:{type:Object,default:{user:"",group:"",forwardGroup:!1,forwardQQ:!1,qq:"",timeSpan:3}}},setup(t,{expose:r}){const e=ref(),n=ref({user:[{required:!0,message:"请输入该值",trigger:"blur"}]});return r({validForm:async()=>{var y;return await((y=e.value)==null?void 0:y.validate(i=>!!i))}}),(y,i)=>{const k=ElInput,L=ElFormItem,$=ElSwitch,V=ElInputNumber,z=ElForm,re=ElCard;return openBlock(),createBlock(re,{class:"card-dy"},{header:withCtx(()=>[_hoisted_1$1]),default:withCtx(()=>[createVNode(z,{ref_key:"dyform",ref:e,model:t.dy,rules:n.value,"label-width":"150px","label-position":"left"},{default:withCtx(()=>[createVNode(L,{label:"抖音用户",prop:"user"},{default:withCtx(()=>[createVNode(k,{modelValue:t.dy.user,"onUpdate:modelValue":i[0]||(i[0]=oe=>t.dy.user=oe)},null,8,["modelValue"])]),_:1}),createVNode(L,{label:"转发至群"},{default:withCtx(()=>[createVNode($,{modelValue:t.dy.forwardGroup,"onUpdate:modelValue":i[1]||(i[1]=oe=>t.dy.forwardGroup=oe),"active-text":"转发","inactive-text":"不转发"},null,8,["modelValue"])]),_:1}),t.dy.forwardGroup?(openBlock(),createBlock(L,{key:0,label:"群qq号"},{default:withCtx(()=>[createVNode(k,{modelValue:t.dy.group,"onUpdate:modelValue":i[2]||(i[2]=oe=>t.dy.group=oe)},null,8,["modelValue"])]),_:1})):createCommentVNode("",!0),createVNode(L,{label:"转发至好友"},{default:withCtx(()=>[createVNode($,{modelValue:t.dy.forwardQQ,"onUpdate:modelValue":i[3]||(i[3]=oe=>t.dy.forwardQQ=oe),"active-text":"转发","inactive-text":"不转发"},null,8,["modelValue"])]),_:1}),t.dy.forwardQQ?(openBlock(),createBlock(L,{key:1,label:"好友qq"},{default:withCtx(()=>[createVNode(k,{modelValue:t.dy.qq,"onUpdate:modelValue":i[4]||(i[4]=oe=>t.dy.qq=oe)},null,8,["modelValue"])]),_:1})):createCommentVNode("",!0),t.dy.forwardQQ||t.dy.forwardGroup?(openBlock(),createBlock(L,{key:2,label:"监听间隔"},{default:withCtx(()=>[createVNode(V,{modelValue:t.dy.timeSpan,"onUpdate:modelValue":i[5]||(i[5]=oe=>t.dy.timeSpan=oe)},null,8,["modelValue"])]),_:1})):createCommentVNode("",!0)]),_:1},8,["model","rules"])]),_:1})}}}),elMessageBox="",_sfc_main$4=defineComponent({__name:"config",props:{enable:{type:Object,default:{qq:!1,wb:!1,bz:!1,kd:!1,xhs:!1,dy:!1,bd:!1}}},emits:["top-enable-change","change-menu"],setup(t,{expose:r,emit:e}){const n=t,g=ref(),y=ref(),i=ref(),k=ref(),L=ref(),$=ref(),V=ref(),z=ref(),re=ref({enableModule:n.enable}),oe=ref(),le=e,ue=de=>{re.value.enableModule=de,le("top-enable-change",de)},ie=async()=>{let de=!0;if(re.value.enableModule.bot&&(de=await g.value.validForm()),!de){le("change-menu","bot"),ElMessage.error("请填入机器人配置中的必填项！");return}if(re.value.enableModule.wb&&(de=await y.value.validForm()),!de){le("change-menu","wb"),ElMessage.error("请填入微博配置中的必填项！");return}if(re.value.enableModule.qq&&(de=await i.value.validForm()),!de){le("change-menu","qq"),ElMessage.error("请填入QQ配置中的必填项！");return}if(re.value.enableModule.bz&&(de=await k.value.validForm()),!de){le("change-menu","bz"),ElMessage.error("请填入B站配置中的必填项！");return}if(re.value.enableModule.bd&&(de=await L.value.validForm()),!de){le("change-menu","bd"),ElMessage.error("请填入百度配置中的必填项！");return}if(re.value.enableModule.kd&&(de=await $.value.validForm()),!de){le("change-menu","kd"),ElMessage.error("请填入口袋配置中的必填项！");return}if(re.value.enableModule.xhs&&(de=await V.value.validForm()),!de){le("change-menu","xhs"),ElMessage.error("请填入小红书配置中的必填项！");return}if(re.value.enableModule.dy&&(de=await z.value.validForm()),!de){le("change-menu","dy"),ElMessage.error("请填入抖音配置中的必填项！");return}var Ce=await saveConfig(re.value);Ce&&Ce.success?(oe.value=re.value,ElMessage.success(Ce.msg)):ElMessage.error(Ce.msg||"保存失败！")},ae=async()=>{var de=await getConfig();de&&de.success&&(re.value.enableModule=de.data.enableModule,re.value.bot=de.data.bot,re.value.qq=de.data.qq,re.value.wb=de.data.wb,re.value.kd=de.data.kd,re.value.bz=de.data.bz,re.value.bd=de.data.bd,re.value.xhs=de.data.xhs,re.value.dy=de.data.dy);let Ce=JSON.stringify(re.value),Ue=JSON.parse(Ce);oe.value=Ue},Ie=()=>{let de=JSON.stringify(oe.value),Ce=JSON.stringify(re.value);return de!==Ce?ElMessageBox.confirm("配置已被修改，但未保存，是否保存","警告",{confirmButtonText:"保存",cancelButtonText:"取消",type:"warning",closeOnClickModal:!1}).then(async()=>(await ie(),!0)).catch(async()=>!0):new Promise((Ue,qe)=>{Ue(!0)})};return onMounted(async()=>{await ae()}),r({checkData:Ie}),(de,Ce)=>{const Ue=ElButton,qe=ElCard,jt=ElAffix,Fe=ElScrollbar;return openBlock(),createElementBlock(Fragment,null,[createVNode(jt,{target:".el-scrollbar__view"},{default:withCtx(()=>[createVNode(qe,{id:"enable"},{header:withCtx(()=>[createVNode(Ue,{type:"primary","native-type":"button",icon:unref(edit_default),onClick:Ce[0]||(Ce[0]=Et=>ie())},{default:withCtx(()=>[createTextVNode("保存")]),_:1},8,["icon"]),createVNode(Ue,{type:"primary","native-type":"button",icon:unref(setting_default),onClick:Ce[1]||(Ce[1]=Et=>ae())},{default:withCtx(()=>[createTextVNode("重置")]),_:1},8,["icon"])]),default:withCtx(()=>[createVNode(_sfc_main$d,{enable:re.value.enableModule,onEnableChange:ue},null,8,["enable"])]),_:1})]),_:1}),createVNode(Fe,{style:{height:"calc(100vh - 230px)"},id:"pdom"},{default:withCtx(()=>[re.value.enableModule.bot?(openBlock(),createBlock(_sfc_main$c,{key:0,ref_key:"botRef",ref:g,bot:re.value.bot,class:"mt10"},null,8,["bot"])):createCommentVNode("",!0),re.value.enableModule.qq?(openBlock(),createBlock(_sfc_main$b,{key:1,ref_key:"qqRef",ref:i,qq:re.value.qq,class:"mt10"},null,8,["qq"])):createCommentVNode("",!0),re.value.enableModule.wb?(openBlock(),createBlock(_sfc_main$a,{key:2,ref_key:"wbRef",ref:y,wb:re.value.wb,class:"mt10"},null,8,["wb"])):createCommentVNode("",!0),re.value.enableModule.kd?(openBlock(),createBlock(_sfc_main$9,{key:3,ref_key:"kdRef",ref:$,kd:re.value.kd,class:"mt10"},null,8,["kd"])):createCommentVNode("",!0),re.value.enableModule.bz?(openBlock(),createBlock(_sfc_main$8,{key:4,ref_key:"bzRef",ref:k,bz:re.value.bz,class:"mt10"},null,8,["bz"])):createCommentVNode("",!0),re.value.enableModule.xhs?(openBlock(),createBlock(_sfc_main$7,{key:5,ref_key:"xhsRef",ref:V,xhs:re.value.xhs,class:"mt10"},null,8,["xhs"])):createCommentVNode("",!0),re.value.enableModule.bd?(openBlock(),createBlock(_sfc_main$6,{key:6,ref_key:"bdRef",ref:L,bd:re.value.bd},null,8,["bd"])):createCommentVNode("",!0),re.value.enableModule.dy?(openBlock(),createBlock(_sfc_main$5,{key:7,ref_key:"dyRef",ref:z,dy:re.value.dy,class:"mt10 mb50"},null,8,["dy"])):createCommentVNode("",!0)]),_:1})],64)}}}),config_vue_vue_type_style_index_0_lang="",elAvatar="",elSpace="",elOption="",elOptionGroup="",elSelect="";var FileSaver_min={exports:{}};(function(t,r){(function(e,n){n()})(commonjsGlobal,function(){function e($,V){return typeof V>"u"?V={autoBom:!1}:typeof V!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),V={autoBom:!V}),V.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test($.type)?new Blob(["\uFEFF",$],{type:$.type}):$}function n($,V,z){var re=new XMLHttpRequest;re.open("GET",$),re.responseType="blob",re.onload=function(){L(re.response,V,z)},re.onerror=function(){console.error("could not download file")},re.send()}function g($){var V=new XMLHttpRequest;V.open("HEAD",$,!1);try{V.send()}catch{}return 200<=V.status&&299>=V.status}function y($){try{$.dispatchEvent(new MouseEvent("click"))}catch{var V=document.createEvent("MouseEvents");V.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),$.dispatchEvent(V)}}var i=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof commonjsGlobal=="object"&&commonjsGlobal.global===commonjsGlobal?commonjsGlobal:void 0,k=i.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),L=i.saveAs||(typeof window!="object"||window!==i?function(){}:"download"in HTMLAnchorElement.prototype&&!k?function($,V,z){var re=i.URL||i.webkitURL,oe=document.createElement("a");V=V||$.name||"download",oe.download=V,oe.rel="noopener",typeof $=="string"?(oe.href=$,oe.origin===location.origin?y(oe):g(oe.href)?n($,V,z):y(oe,oe.target="_blank")):(oe.href=re.createObjectURL($),setTimeout(function(){re.revokeObjectURL(oe.href)},4e4),setTimeout(function(){y(oe)},0))}:"msSaveOrOpenBlob"in navigator?function($,V,z){if(V=V||$.name||"download",typeof $!="string")navigator.msSaveOrOpenBlob(e($,z),V);else if(g($))n($,V,z);else{var re=document.createElement("a");re.href=$,re.target="_blank",setTimeout(function(){y(re)})}}:function($,V,z,re){if(re=re||open("","_blank"),re&&(re.document.title=re.document.body.innerText="downloading..."),typeof $=="string")return n($,V,z);var oe=$.type==="application/octet-stream",le=/constructor/i.test(i.HTMLElement)||i.safari,ue=/CriOS\/[\d]+/.test(navigator.userAgent);if((ue||oe&&le||k)&&typeof FileReader<"u"){var ie=new FileReader;ie.onloadend=function(){var de=ie.result;de=ue?de:de.replace(/^data:[^;]*;/,"data:attachment/file;"),re?re.location.href=de:location=de,re=null},ie.readAsDataURL($)}else{var ae=i.URL||i.webkitURL,Ie=ae.createObjectURL($);re?re.location=Ie:location.href=Ie,re=null,setTimeout(function(){ae.revokeObjectURL(Ie)},4e4)}});i.saveAs=L.saveAs=L,t.exports=L})})(FileSaver_min);var FileSaver_minExports=FileSaver_min.exports;const _hoisted_1=createBaseVNode("label",null,"日志显示数量：",-1),_hoisted_2=createBaseVNode("label",null,"日志类型：",-1),_hoisted_3=createBaseVNode("span",null," ",-1),_hoisted_4={key:0},_hoisted_5={style:{"font-size":"12px",color:"gray"}},_hoisted_6={key:1},_hoisted_7={style:{"font-size":"12px",color:"gray"}},_hoisted_8=["onClick"],_sfc_main$3=defineComponent({__name:"log",props:{enable:{type:Object,default:{bot:!1,qq:!1,wb:!1,bz:!1,kd:!1,xhs:!1,dy:!1,bd:!1}}},setup(t){const r=ref("all"),e=ref(30),n=ref(new Array),g=z=>{z&&openWindow(z)},y=async()=>{if(n.value.length<=0){ElMessage.info("无日志");return}ElMessageBox.confirm("此操作将永久清空日志，是否删除","警告",{cancelButtonText:"取消",confirmButtonText:"确定"}).then(()=>{n.value=new Array,logApi().clearLog()})},i=()=>{if(!n.value||n.value.length<=0){ElMessage.info("无日志");return}let z=[""];n.value.forEach(oe=>{oe.type=="link"||oe.type=="pic"?z.push(oe.name+":"+oe.url):z.push(oe.name+":"+oe.content)});const re=new Blob(z,{type:"text/plain;charset=utf-8"});FileSaver_minExports.saveAs(re,"logs.txt")},k=()=>{var z=n.value.filter(re=>re.type=="pic").map(re=>re.url);return z??[]},L=z=>{var re=k().findIndex(oe=>oe==z);return re},$=()=>{setInterval(()=>{V()},3e3)},V=()=>{let z=logApi().getLogs();z&&(z=z.reverse(),r.value=="idol"?z=z.filter(re=>re.idol&&re.roleId==3):r.value&&r.value!="all"&&(z=z.filter(re=>re.type==r.value)),e&&(z=z.slice(0,e.value)),n.value=z)};return onMounted(()=>{V(),$()}),(z,re)=>{const oe=ElInputNumber,le=ElOption,ue=ElSelect,ie=ElButton,ae=ElSpace,Ie=ElAvatar,de=ElCol,Ce=ElRow,Ue=ElImage,qe=ElCard,jt=ElScrollbar;return openBlock(),createElementBlock("div",null,[createBaseVNode("div",null,[createVNode(ae,{wrap:""},{default:withCtx(()=>[_hoisted_1,createVNode(oe,{modelValue:e.value,"onUpdate:modelValue":re[0]||(re[0]=Fe=>e.value=Fe),min:1,max:1e3,onChange:V},null,8,["modelValue"]),_hoisted_2,createVNode(ue,{modelValue:r.value,"onUpdate:modelValue":re[1]||(re[1]=Fe=>r.value=Fe),style:{width:"120px"},onChange:V},{default:withCtx(()=>[(openBlock(),createBlock(le,{key:0,label:"全部",value:"all"})),(openBlock(),createBlock(le,{key:1,label:"系统",value:"system"})),(openBlock(),createBlock(le,{key:2,label:"图片",value:"pic"})),(openBlock(),createBlock(le,{key:3,label:"文本",value:"text"})),(openBlock(),createBlock(le,{key:4,label:"链接",value:"link"})),t.enable.kd?(openBlock(),createBlock(le,{key:5,label:"小偶像",value:"idol"})):createCommentVNode("",!0)]),_:1},8,["modelValue"]),createVNode(ie,{type:"primary",onClick:y},{default:withCtx(()=>[createTextVNode("清空")]),_:1}),createVNode(ie,{type:"primary",onClick:i},{default:withCtx(()=>[createTextVNode("导出")]),_:1})]),_:1})]),createVNode(jt,{style:{height:"calc(100vh - 100px)","margin-top":"10px"}},{default:withCtx(()=>[(openBlock(!0),createElementBlock(Fragment,null,renderList(n.value,Fe=>(openBlock(),createBlock(qe,{style:{"background-color":"rgba(220,220,220,0.1)","margin-bottom":"10px"},shadow:"never"},{default:withCtx(()=>[createVNode(Ce,null,{default:withCtx(()=>[createVNode(de,{span:1.5},{default:withCtx(()=>[Fe.type!=="system"?(openBlock(),createBlock(Ie,{key:0,src:Fe.avatar},null,8,["src"])):createCommentVNode("",!0)]),_:2},1024),createVNode(de,{span:.5},{default:withCtx(()=>[_hoisted_3]),_:1}),createVNode(de,{span:22},{default:withCtx(()=>[createVNode(Ce,null,{default:withCtx(()=>[Fe.type!=="system"?(openBlock(),createElementBlock("span",_hoisted_4,[createTextVNode(toDisplayString(Fe.name)+" ",1),createBaseVNode("span",_hoisted_5,toDisplayString((Fe.idol||"")+(Fe.channel?"【"+Fe.channel+"】":"")+Fe.time),1)])):(openBlock(),createElementBlock("span",_hoisted_6,[createTextVNode("系统信息："),createBaseVNode("span",_hoisted_7,toDisplayString(Fe.time),1)]))]),_:2},1024),createVNode(Ce,null,{default:withCtx(()=>[createVNode(qe,{"body-class":"card-body-diy"},{default:withCtx(()=>[(Fe.type=="text",openBlock(),createElementBlock("span",{key:0,style:normalizeStyle({color:Fe.color})},toDisplayString(Fe.content),5)),Fe.type=="link"?(openBlock(),createElementBlock("span",{key:1,style:normalizeStyle({color:Fe.color,"text-decoration":"underline",cursor:"pointer"}),onClick:Et=>g(Fe.url)},toDisplayString(Fe.url),13,_hoisted_8)):createCommentVNode("",!0),Fe.type=="pic"?(openBlock(),createBlock(Ue,{key:2,src:Fe.url,"initial-index":L(Fe.url),"preview-src-list":k(),style:{width:"120px",height:"auto"}},null,8,["src","initial-index","preview-src-list"])):createCommentVNode("",!0)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024))),256))]),_:1})])}}}),log_vue_vue_type_style_index_0_lang="",elConfigProvider="",elPagination="",elTable="",elTableColumn="";var zhCn={name:"zh-cn",el:{colorpicker:{confirm:"确定",clear:"清空"},datepicker:{now:"此刻",today:"今天",cancel:"取消",clear:"清空",confirm:"确定",selectDate:"选择日期",selectTime:"选择时间",startDate:"开始日期",startTime:"开始时间",endDate:"结束日期",endTime:"结束时间",prevYear:"前一年",nextYear:"后一年",prevMonth:"上个月",nextMonth:"下个月",year:"年",month1:"1 月",month2:"2 月",month3:"3 月",month4:"4 月",month5:"5 月",month6:"6 月",month7:"7 月",month8:"8 月",month9:"9 月",month10:"10 月",month11:"11 月",month12:"12 月",weeks:{sun:"日",mon:"一",tue:"二",wed:"三",thu:"四",fri:"五",sat:"六"},months:{jan:"一月",feb:"二月",mar:"三月",apr:"四月",may:"五月",jun:"六月",jul:"七月",aug:"八月",sep:"九月",oct:"十月",nov:"十一月",dec:"十二月"}},select:{loading:"加载中",noMatch:"无匹配数据",noData:"无数据",placeholder:"请选择"},cascader:{noMatch:"无匹配数据",loading:"加载中",placeholder:"请选择",noData:"暂无数据"},pagination:{goto:"前往",pagesize:"条/页",total:"共 {total} 条",pageClassifier:"页",page:"页",prev:"上一页",next:"下一页",currentPage:"第 {pager} 页",prevPages:"向前 {pager} 页",nextPages:"向后 {pager} 页",deprecationWarning:"你使用了一些已被废弃的用法，请参考 el-pagination 的官方文档"},messagebox:{title:"提示",confirm:"确定",cancel:"取消",error:"输入的数据不合法!"},upload:{deleteTip:"按 delete 键可删除",delete:"删除",preview:"查看图片",continue:"继续上传"},table:{emptyText:"暂无数据",confirmFilter:"筛选",resetFilter:"重置",clearFilter:"全部",sumText:"合计"},tour:{next:"下一步",previous:"上一步",finish:"结束导览"},tree:{emptyText:"暂无数据"},transfer:{noMatch:"无匹配数据",noData:"无数据",titles:["列表 1","列表 2"],filterPlaceholder:"请输入搜索内容",noCheckedFormat:"共 {total} 项",hasCheckedFormat:"已选 {checked}/{total} 项"},image:{error:"加载失败"},pageHeader:{title:"返回"},popconfirm:{confirmButtonText:"确定",cancelButtonText:"取消"},carousel:{leftArrow:"上一张幻灯片",rightArrow:"下一张幻灯片",indicator:"幻灯片切换至索引 {index}"}}};const _sfc_main$2=defineComponent({__name:"pic",setup(t){const r=ref({pageIndex:1,pageSize:5,total:0}),e=ref(),n=async i=>{let k=await saveImg(i);k.success?ElMessage.success(k.msg):ElMessage.error(k.msg),await y()},g=async i=>{let k=await delImg(i);k.success?ElMessage.success(k.msg):ElMessage.error(k.msg),await y()},y=async()=>{var i=await getCache(r.value);e.value=i.data,r.value.total=i.count};return onMounted(async()=>{await y()}),(i,k)=>{const L=ElButton,$=ElSpace,V=ElRow,z=ElTableColumn,re=ElImage,oe=ElTable,le=ElPagination,ue=ElConfigProvider;return openBlock(),createElementBlock("div",null,[createVNode(V,null,{default:withCtx(()=>[createVNode($,{wrap:""},{default:withCtx(()=>[createVNode(L,{type:"primary",icon:unref(refresh_default),onClick:y},{default:withCtx(()=>[createTextVNode("刷新")]),_:1},8,["icon"])]),_:1})]),_:1}),createVNode(V,{style:{"margin-top":"10px"}},{default:withCtx(()=>[createVNode(oe,{data:e.value,stripe:"",style:{width:"100%",height:"calc(100vh - 150px)"}},{default:withCtx(()=>[createVNode(z,{type:"index",width:"50"}),createVNode(z,{prop:"createDate",label:"时间"}),createVNode(z,{prop:"content",label:"图片"},{default:withCtx(ie=>[createVNode(re,{style:{width:"auto",height:"120px"},src:ie.row.content,"preview-teleported":"","preview-src-list":[ie.row.content]},null,8,["src","preview-src-list"])]),_:1}),createVNode(z,{label:"操作"},{default:withCtx(ie=>[createVNode(L,{type:"primary",onClick:ae=>n(ie.row.id)},{default:withCtx(()=>[createTextVNode("保存")]),_:2},1032,["onClick"]),createVNode(L,{type:"primary",onClick:ae=>g(ie.row.id)},{default:withCtx(()=>[createTextVNode("删除")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),createVNode(ue,{locale:unref(zhCn)},{default:withCtx(()=>[createVNode(le,{onSizeChange:k[0]||(k[0]=ie=>y()),onCurrentChange:k[1]||(k[1]=ie=>y()),background:"",class:"mt15",layout:"total, sizes, prev, pager, next, jumper",total:r.value.total,"page-sizes":[5,10,20,30],"current-page":r.value.pageIndex,"onUpdate:currentPage":k[2]||(k[2]=ie=>r.value.pageIndex=ie),"page-size":r.value.pageSize,"onUpdate:pageSize":k[3]||(k[3]=ie=>r.value.pageSize=ie)},null,8,["total","current-page","page-size"])]),_:1},8,["locale"])]),_:1})])}}}),_sfc_main$1=defineComponent({__name:"plugin",setup(t){const r=ref(),e=async()=>{var k=await getFun();r.value=k.data},n=async k=>{let L=await startPlugin(k.name,k.version);L.success?ElMessage.success(L.msg):ElMessage.error(L.msg),await e()},g=async k=>{let L=await stopPlugin(k);L.success?ElMessage.success(L.msg):ElMessage.error(L.msg),await e()},y=async k=>{let L=await delPlugin(k);L.success?ElMessage.success(L.msg):ElMessage.error(L.msg),await e()},i=async()=>{await e()};return onMounted(async()=>{await e()}),(k,L)=>{const $=ElButton,V=ElUpload,z=ElSpace,re=ElRow,oe=ElTableColumn,le=ElTag,ue=ElTable;return openBlock(),createElementBlock("div",null,[createVNode(re,null,{default:withCtx(()=>[createVNode(z,{wrap:""},{default:withCtx(()=>[createVNode(V,{accept:".dll",action:unref(ApiPrefix)+"/uploaddll",multiple:"","show-file-list":!1,"on-success":i},{default:withCtx(()=>[createVNode($,{type:"info",icon:unref(upload_default)},{default:withCtx(()=>[createTextVNode("上传插件")]),_:1},8,["icon"])]),_:1},8,["action"]),createVNode($,{type:"primary",icon:unref(refresh_default),onClick:e},{default:withCtx(()=>[createTextVNode("刷新")]),_:1},8,["icon"])]),_:1})]),_:1}),createVNode(re,{style:{"margin-top":"10px"}},{default:withCtx(()=>[createVNode(ue,{data:r.value,stripe:"",style:{width:"100%",height:"calc(100vh - 100px)"}},{default:withCtx(()=>[createVNode(oe,{type:"index",width:"50"}),createVNode(oe,{label:"插件名",width:"120"},{default:withCtx(ie=>[createTextVNode(toDisplayString(ie.row.pluginInfo.name),1)]),_:1}),createVNode(oe,{label:"版本",width:"120"},{default:withCtx(ie=>[createTextVNode(toDisplayString(ie.row.pluginInfo.version),1)]),_:1}),createVNode(oe,{label:"状态",width:"120"},{default:withCtx(ie=>[ie.row.status?(openBlock(),createBlock(le,{key:0,type:"success"},{default:withCtx(()=>[createTextVNode("启用")]),_:1})):(openBlock(),createBlock(le,{key:1,type:"danger"},{default:withCtx(()=>[createTextVNode("禁用")]),_:1}))]),_:1}),createVNode(oe,{label:"描述"},{default:withCtx(ie=>[createTextVNode(toDisplayString(ie.row.pluginInfo.desc),1)]),_:1}),createVNode(oe,{label:"操作",width:"180"},{default:withCtx(ie=>[ie.row.status?(openBlock(),createBlock($,{key:1,type:"warning",onClick:ae=>g(ie.row.pluginInfo.name)},{default:withCtx(()=>[createTextVNode("禁用")]),_:2},1032,["onClick"])):(openBlock(),createBlock($,{key:0,type:"primary",onClick:ae=>n(ie.row.pluginInfo)},{default:withCtx(()=>[createTextVNode("启用")]),_:2},1032,["onClick"])),createVNode($,{type:"danger",onClick:ae=>y(ie.row.pluginInfo.name)},{default:withCtx(()=>[createTextVNode("删除")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])]),_:1})])}}}),_sfc_main=defineComponent({__name:"App",setup(t){const r=ref(),e=ref({bot:!1,qq:!1,wb:!1,bz:!1,kd:!1,xhs:!1,dy:!1,bd:!1}),n=["index","log","pic","plugin"],g=ref(),y=ref("index"),i=async V=>{n.find(z=>z===V)?(g.value&&(await g.value.checkData(),await $()),y.value=V):k("enable")},k=async V=>{var oe;n.find(le=>le===y.value)&&(y.value="config",setTimeout(async()=>{await k(V)},100));const z=document.getElementById(V),re=(oe=document.getElementById("pdom"))==null?void 0:oe.parentElement;if(re&&z){const le=re.getBoundingClientRect(),ie=z.getBoundingClientRect().top+re.scrollTop-le.top-28;re.scrollTo({top:ie,behavior:"smooth"})}},L=V=>{e.value=V},$=async()=>{let V=await getConfig();e.value=V.data.enableModule;let z=JSON.stringify(V.data.enableModule),re=JSON.parse(z);r.value=re};return onMounted(async()=>{await $()}),(V,z)=>{const re=ElIcon,oe=ElMenuItem,le=ElSubMenu,ue=ElMenu,ie=ElScrollbar,ae=ElAside,Ie=ElCard,de=ElMain,Ce=ElContainer;return openBlock(),createBlock(Ce,{class:"layout-container"},{default:withCtx(()=>[createVNode(Ie,null,{default:withCtx(()=>[createVNode(ae,{width:"15vw"},{default:withCtx(()=>[createVNode(ie,{style:{height:"calc(100vh - 30px)"}},{default:withCtx(()=>[createVNode(ue,{"default-openeds":["99"],"default-active":"1"},{default:withCtx(()=>[createVNode(oe,{index:"1",onClick:z[0]||(z[0]=Ue=>i("index"))},{default:withCtx(()=>[createVNode(re,null,{default:withCtx(()=>[createVNode(unref(house_default))]),_:1}),createTextVNode(" 开始 ")]),_:1}),createVNode(oe,{index:"2",onClick:z[1]||(z[1]=Ue=>i("log"))},{default:withCtx(()=>[createVNode(re,null,{default:withCtx(()=>[createVNode(unref(tickets_default))]),_:1}),createTextVNode(" 日志 ")]),_:1}),createVNode(oe,{index:"3",onClick:z[2]||(z[2]=Ue=>i("pic"))},{default:withCtx(()=>[createVNode(re,null,{default:withCtx(()=>[createVNode(unref(picture_default))]),_:1}),createTextVNode(" 图片 ")]),_:1}),withDirectives(createVNode(oe,{index:"4",onClick:z[3]||(z[3]=Ue=>i("plugin"))},{default:withCtx(()=>[createVNode(re,null,{default:withCtx(()=>[createVNode(unref(cpu_default))]),_:1}),createTextVNode(" 插件 ")]),_:1},512),[[vShow,e.value.qq]]),createVNode(le,{index:"99"},{title:withCtx(()=>[createVNode(re,null,{default:withCtx(()=>[createVNode(unref(set_up_default))]),_:1}),createTextVNode("配置 ")]),default:withCtx(()=>[createVNode(oe,{index:"99-0",onClick:z[4]||(z[4]=Ue=>i("config"))},{default:withCtx(()=>[createTextVNode("启用模块")]),_:1}),withDirectives(createVNode(oe,{index:"99-1",onClick:z[5]||(z[5]=Ue=>k("bot"))},{default:withCtx(()=>[createTextVNode("机器人")]),_:1},512),[[vShow,e.value.bot]]),withDirectives(createVNode(oe,{index:"99-2",onClick:z[6]||(z[6]=Ue=>k("qq"))},{default:withCtx(()=>[createTextVNode("QQ")]),_:1},512),[[vShow,e.value.qq]]),withDirectives(createVNode(oe,{index:"99-3",onClick:z[7]||(z[7]=Ue=>k("wb"))},{default:withCtx(()=>[createTextVNode("微博")]),_:1},512),[[vShow,e.value.wb]]),withDirectives(createVNode(oe,{index:"99-4",onClick:z[8]||(z[8]=Ue=>k("kd"))},{default:withCtx(()=>[createTextVNode("口袋")]),_:1},512),[[vShow,e.value.kd]]),withDirectives(createVNode(oe,{index:"99-5",onClick:z[9]||(z[9]=Ue=>k("bz"))},{default:withCtx(()=>[createTextVNode("B站")]),_:1},512),[[vShow,e.value.bz]]),withDirectives(createVNode(oe,{index:"99-6",onClick:z[10]||(z[10]=Ue=>k("xhs"))},{default:withCtx(()=>[createTextVNode("小红书")]),_:1},512),[[vShow,e.value.xhs]]),withDirectives(createVNode(oe,{index:"99-7",onClick:z[11]||(z[11]=Ue=>k("bd"))},{default:withCtx(()=>[createTextVNode("百度")]),_:1},512),[[vShow,e.value.bd]]),withDirectives(createVNode(oe,{index:"99-8",onClick:z[12]||(z[12]=Ue=>k("dy"))},{default:withCtx(()=>[createTextVNode("抖音")]),_:1},512),[[vShow,e.value.dy]])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),createVNode(Ie,{style:{width:"90%","margin-left":"10px"}},{default:withCtx(()=>[createVNode(Ce,null,{default:withCtx(()=>[createVNode(de,{style:{"padding-left":"20px","padding-right":"20px"},id:"parentContainer"},{default:withCtx(()=>[withDirectives(createVNode(_sfc_main$e,{enable:e.value},null,8,["enable"]),[[vShow,y.value==="index"]]),withDirectives(createVNode(_sfc_main$3,{enable:e.value},null,8,["enable"]),[[vShow,y.value==="log"]]),y.value==="pic"?(openBlock(),createBlock(_sfc_main$2,{key:0})):createCommentVNode("",!0),y.value==="plugin"&&e.value.qq?(openBlock(),createBlock(_sfc_main$1,{key:1})):createCommentVNode("",!0),y.value==="config"?(openBlock(),createBlock(_sfc_main$4,{key:2,ref_key:"configRef",ref:g,enable:e.value,onTopEnableChange:L,onChangeMenu:k},null,8,["enable"])):createCommentVNode("",!0)]),_:1})]),_:1})]),_:1})]),_:1})}}}),App_vue_vue_type_style_index_0_scoped_e10cff3a_lang="",_export_sfc=(t,r)=>{const e=t.__vccOpts||t;for(const[n,g]of r)e[n]=g;return e},App=_export_sfc(_sfc_main,[["__scopeId","data-v-e10cff3a"]]),app=createApp(App);app.mount("#app");function objectSome(t,r){let e=!1;for(const n in t)if(t.hasOwnProperty(n)&&(e=r(n,t[n]),e))break;return e}var orgSend=WebSocket.prototype.send;WebSocket.prototype.send=function(){var t,r,e;if(/3:::/.test(arguments[0])){const n=arguments[0].replace(/3:::/,"");let g=null;try{g=JSON.parse(n)}catch{}if(g&&(g==null?void 0:g.SER)===1&&(g==null?void 0:g.SID)===2&&((t=g==null?void 0:g.Q)!=null&&t.length)){console.log("开始注入NIM_BROWSER_SDK.js拦截处理");for(const y of g.Q)if(/Property/i.test(y.t)&&y.v&&(objectSome(y.v,(i,k)=>/Microsoft Edge/i.test(k))||objectSome(y.v,(i,k)=>/Chromium/i.test(k)))){y.v[3]=2,y.v[42]="PocketFans201807/24020203",arguments[0]=`3:::${JSON.stringify(g)}`;break}}if(g&&(g==null?void 0:g.SER)===1&&(g==null?void 0:g.SID)===24&&((r=g==null?void 0:g.Q)!=null&&r.length)){for(const y of g.Q)if(/Property/i.test(y.t)&&y.v&&(objectSome(y.v,(i,k)=>/Microsoft Edge/i.test(k))||objectSome(y.v,(i,k)=>/Chromium/i.test(k)))){console.log("开始注入NIM_BROWSER_SDK.js拦截处理"),y.v[6]=2,arguments[0]=`3:::${JSON.stringify(g)}`;break}}if(g&&(g==null?void 0:g.SER)===1&&(g==null?void 0:g.SID)===13&&((e=g==null?void 0:g.Q)!=null&&e.length)){for(const y of g.Q)if(/Property/i.test(y.t)&&y.v&&(objectSome(y.v,(i,k)=>/Microsoft Edge/i.test(k))||objectSome(y.v,(i,k)=>/Chromium/i.test(k)))){y.v[3]=2,y.v[6]=2,y.v[42]="PocketFans201807/24020203",arguments[0]=`3:::${JSON.stringify(g)}`;break}}orgSend.apply(this,arguments)}};
