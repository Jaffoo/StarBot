var KM=Object.defineProperty;var QM=(t,n,e)=>n in t?KM(t,n,{enumerable:!0,configurable:!0,writable:!0,value:e}):t[n]=e;var La=(t,n,e)=>(QM(t,typeof n!="symbol"?n+"":n,e),e);(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function e(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=e(s);fetch(s.href,i)}})();/**
* @vue/shared v3.4.20
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function makeMap(t,n){const e=new Set(t.split(","));return n?r=>e.has(r.toLowerCase()):r=>e.has(r)}const EMPTY_OBJ={},EMPTY_ARR=[],NOOP=()=>{},NO=()=>!1,isOn=t=>t.charCodeAt(0)===111&&t.charCodeAt(1)===110&&(t.charCodeAt(2)>122||t.charCodeAt(2)<97),isModelListener=t=>t.startsWith("onUpdate:"),extend$1=Object.assign,remove=(t,n)=>{const e=t.indexOf(n);e>-1&&t.splice(e,1)},hasOwnProperty$6=Object.prototype.hasOwnProperty,hasOwn=(t,n)=>hasOwnProperty$6.call(t,n),isArray$3=Array.isArray,isMap=t=>toTypeString(t)==="[object Map]",isSet=t=>toTypeString(t)==="[object Set]",isFunction$2=t=>typeof t=="function",isString$2=t=>typeof t=="string",isSymbol$1=t=>typeof t=="symbol",isObject$2=t=>t!==null&&typeof t=="object",isPromise=t=>(isObject$2(t)||isFunction$2(t))&&isFunction$2(t.then)&&isFunction$2(t.catch),objectToString$1=Object.prototype.toString,toTypeString=t=>objectToString$1.call(t),toRawType=t=>toTypeString(t).slice(8,-1),isPlainObject$1=t=>toTypeString(t)==="[object Object]",isIntegerKey=t=>isString$2(t)&&t!=="NaN"&&t[0]!=="-"&&""+parseInt(t,10)===t,isReservedProp=makeMap(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),cacheStringFunction=t=>{const n=Object.create(null);return e=>n[e]||(n[e]=t(e))},camelizeRE=/-(\w)/g,camelize=cacheStringFunction(t=>t.replace(camelizeRE,(n,e)=>e?e.toUpperCase():"")),hyphenateRE=/\B([A-Z])/g,hyphenate=cacheStringFunction(t=>t.replace(hyphenateRE,"-$1").toLowerCase()),capitalize=cacheStringFunction(t=>t.charAt(0).toUpperCase()+t.slice(1)),toHandlerKey=cacheStringFunction(t=>t?`on${capitalize(t)}`:""),hasChanged=(t,n)=>!Object.is(t,n),invokeArrayFns=(t,n)=>{for(let e=0;e<t.length;e++)t[e](n)},def=(t,n,e)=>{Object.defineProperty(t,n,{configurable:!0,enumerable:!1,value:e})},looseToNumber=t=>{const n=parseFloat(t);return isNaN(n)?t:n},toNumber$1=t=>{const n=isString$2(t)?Number(t):NaN;return isNaN(n)?t:n};let _globalThis;const getGlobalThis=()=>_globalThis||(_globalThis=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function normalizeStyle(t){if(isArray$3(t)){const n={};for(let e=0;e<t.length;e++){const r=t[e],s=isString$2(r)?parseStringStyle(r):normalizeStyle(r);if(s)for(const i in s)n[i]=s[i]}return n}else if(isString$2(t)||isObject$2(t))return t}const listDelimiterRE=/;(?![^(]*\))/g,propertyDelimiterRE=/:([^]+)/,styleCommentRE=/\/\*[^]*?\*\//g;function parseStringStyle(t){const n={};return t.replace(styleCommentRE,"").split(listDelimiterRE).forEach(e=>{if(e){const r=e.split(propertyDelimiterRE);r.length>1&&(n[r[0].trim()]=r[1].trim())}}),n}function normalizeClass(t){let n="";if(isString$2(t))n=t;else if(isArray$3(t))for(let e=0;e<t.length;e++){const r=normalizeClass(t[e]);r&&(n+=r+" ")}else if(isObject$2(t))for(const e in t)t[e]&&(n+=e+" ");return n.trim()}function normalizeProps(t){if(!t)return null;let{class:n,style:e}=t;return n&&!isString$2(n)&&(t.class=normalizeClass(n)),e&&(t.style=normalizeStyle(e)),t}const specialBooleanAttrs="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",isSpecialBooleanAttr=makeMap(specialBooleanAttrs);function includeBooleanAttr(t){return!!t||t===""}const toDisplayString=t=>isString$2(t)?t:t==null?"":isArray$3(t)||isObject$2(t)&&(t.toString===objectToString$1||!isFunction$2(t.toString))?JSON.stringify(t,replacer,2):String(t),replacer=(t,n)=>n&&n.__v_isRef?replacer(t,n.value):isMap(n)?{[`Map(${n.size})`]:[...n.entries()].reduce((e,[r,s],i)=>(e[stringifySymbol(r,i)+" =>"]=s,e),{})}:isSet(n)?{[`Set(${n.size})`]:[...n.values()].map(e=>stringifySymbol(e))}:isSymbol$1(n)?stringifySymbol(n):isObject$2(n)&&!isArray$3(n)&&!isPlainObject$1(n)?String(n):n,stringifySymbol=(t,n="")=>{var e;return isSymbol$1(t)?`Symbol(${(e=t.description)!=null?e:n})`:t};/**
* @vue/reactivity v3.4.20
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let activeEffectScope;class EffectScope{constructor(n=!1){this.detached=n,this._active=!0,this.effects=[],this.cleanups=[],this.parent=activeEffectScope,!n&&activeEffectScope&&(this.index=(activeEffectScope.scopes||(activeEffectScope.scopes=[])).push(this)-1)}get active(){return this._active}run(n){if(this._active){const e=activeEffectScope;try{return activeEffectScope=this,n()}finally{activeEffectScope=e}}}on(){activeEffectScope=this}off(){activeEffectScope=this.parent}stop(n){if(this._active){let e,r;for(e=0,r=this.effects.length;e<r;e++)this.effects[e].stop();for(e=0,r=this.cleanups.length;e<r;e++)this.cleanups[e]();if(this.scopes)for(e=0,r=this.scopes.length;e<r;e++)this.scopes[e].stop(!0);if(!this.detached&&this.parent&&!n){const s=this.parent.scopes.pop();s&&s!==this&&(this.parent.scopes[this.index]=s,s.index=this.index)}this.parent=void 0,this._active=!1}}}function effectScope(t){return new EffectScope(t)}function recordEffectScope(t,n=activeEffectScope){n&&n.active&&n.effects.push(t)}function getCurrentScope(){return activeEffectScope}function onScopeDispose(t){activeEffectScope&&activeEffectScope.cleanups.push(t)}let activeEffect;class ReactiveEffect{constructor(n,e,r,s){this.fn=n,this.trigger=e,this.scheduler=r,this.active=!0,this.deps=[],this._dirtyLevel=4,this._trackId=0,this._runnings=0,this._shouldSchedule=!1,this._depsLength=0,recordEffectScope(this,s)}get dirty(){if(this._dirtyLevel===2||this._dirtyLevel===3){this._dirtyLevel=1,pauseTracking();for(let n=0;n<this._depsLength;n++){const e=this.deps[n];if(e.computed&&(triggerComputed(e.computed),this._dirtyLevel>=4))break}this._dirtyLevel===1&&(this._dirtyLevel=0),resetTracking()}return this._dirtyLevel>=4}set dirty(n){this._dirtyLevel=n?4:0}run(){if(this._dirtyLevel=0,!this.active)return this.fn();let n=shouldTrack,e=activeEffect;try{return shouldTrack=!0,activeEffect=this,this._runnings++,preCleanupEffect(this),this.fn()}finally{postCleanupEffect(this),this._runnings--,activeEffect=e,shouldTrack=n}}stop(){var n;this.active&&(preCleanupEffect(this),postCleanupEffect(this),(n=this.onStop)==null||n.call(this),this.active=!1)}}function triggerComputed(t){return t.value}function preCleanupEffect(t){t._trackId++,t._depsLength=0}function postCleanupEffect(t){if(t.deps.length>t._depsLength){for(let n=t._depsLength;n<t.deps.length;n++)cleanupDepEffect(t.deps[n],t);t.deps.length=t._depsLength}}function cleanupDepEffect(t,n){const e=t.get(n);e!==void 0&&n._trackId!==e&&(t.delete(n),t.size===0&&t.cleanup())}let shouldTrack=!0,pauseScheduleStack=0;const trackStack=[];function pauseTracking(){trackStack.push(shouldTrack),shouldTrack=!1}function resetTracking(){const t=trackStack.pop();shouldTrack=t===void 0?!0:t}function pauseScheduling(){pauseScheduleStack++}function resetScheduling(){for(pauseScheduleStack--;!pauseScheduleStack&&queueEffectSchedulers.length;)queueEffectSchedulers.shift()()}function trackEffect(t,n,e){if(n.get(t)!==t._trackId){n.set(t,t._trackId);const r=t.deps[t._depsLength];r!==n?(r&&cleanupDepEffect(r,t),t.deps[t._depsLength++]=n):t._depsLength++}}const queueEffectSchedulers=[];function triggerEffects(t,n,e){pauseScheduling();for(const r of t.keys()){let s;r._dirtyLevel<n&&(s??(s=t.get(r)===r._trackId))&&(r._shouldSchedule||(r._shouldSchedule=r._dirtyLevel===0),r._dirtyLevel=n),r._shouldSchedule&&(s??(s=t.get(r)===r._trackId))&&(r.trigger(),(!r._runnings||r.allowRecurse)&&r._dirtyLevel!==2&&(r._shouldSchedule=!1,r.scheduler&&queueEffectSchedulers.push(r.scheduler)))}resetScheduling()}const createDep=(t,n)=>{const e=new Map;return e.cleanup=t,e.computed=n,e},targetMap=new WeakMap,ITERATE_KEY=Symbol(""),MAP_KEY_ITERATE_KEY=Symbol("");function track(t,n,e){if(shouldTrack&&activeEffect){let r=targetMap.get(t);r||targetMap.set(t,r=new Map);let s=r.get(e);s||r.set(e,s=createDep(()=>r.delete(e))),trackEffect(activeEffect,s)}}function trigger(t,n,e,r,s,i){const o=targetMap.get(t);if(!o)return;let a=[];if(n==="clear")a=[...o.values()];else if(e==="length"&&isArray$3(t)){const d=Number(r);o.forEach((c,u)=>{(u==="length"||!isSymbol$1(u)&&u>=d)&&a.push(c)})}else switch(e!==void 0&&a.push(o.get(e)),n){case"add":isArray$3(t)?isIntegerKey(e)&&a.push(o.get("length")):(a.push(o.get(ITERATE_KEY)),isMap(t)&&a.push(o.get(MAP_KEY_ITERATE_KEY)));break;case"delete":isArray$3(t)||(a.push(o.get(ITERATE_KEY)),isMap(t)&&a.push(o.get(MAP_KEY_ITERATE_KEY)));break;case"set":isMap(t)&&a.push(o.get(ITERATE_KEY));break}pauseScheduling();for(const d of a)d&&triggerEffects(d,4);resetScheduling()}function getDepFromReactive(t,n){var e;return(e=targetMap.get(t))==null?void 0:e.get(n)}const isNonTrackableKeys=makeMap("__proto__,__v_isRef,__isVue"),builtInSymbols=new Set(Object.getOwnPropertyNames(Symbol).filter(t=>t!=="arguments"&&t!=="caller").map(t=>Symbol[t]).filter(isSymbol$1)),arrayInstrumentations=createArrayInstrumentations();function createArrayInstrumentations(){const t={};return["includes","indexOf","lastIndexOf"].forEach(n=>{t[n]=function(...e){const r=toRaw(this);for(let i=0,o=this.length;i<o;i++)track(r,"get",i+"");const s=r[n](...e);return s===-1||s===!1?r[n](...e.map(toRaw)):s}}),["push","pop","shift","unshift","splice"].forEach(n=>{t[n]=function(...e){pauseTracking(),pauseScheduling();const r=toRaw(this)[n].apply(this,e);return resetScheduling(),resetTracking(),r}}),t}function hasOwnProperty$5(t){const n=toRaw(this);return track(n,"has",t),n.hasOwnProperty(t)}class BaseReactiveHandler{constructor(n=!1,e=!1){this._isReadonly=n,this._isShallow=e}get(n,e,r){const s=this._isReadonly,i=this._isShallow;if(e==="__v_isReactive")return!s;if(e==="__v_isReadonly")return s;if(e==="__v_isShallow")return i;if(e==="__v_raw")return r===(s?i?shallowReadonlyMap:readonlyMap:i?shallowReactiveMap:reactiveMap).get(n)||Object.getPrototypeOf(n)===Object.getPrototypeOf(r)?n:void 0;const o=isArray$3(n);if(!s){if(o&&hasOwn(arrayInstrumentations,e))return Reflect.get(arrayInstrumentations,e,r);if(e==="hasOwnProperty")return hasOwnProperty$5}const a=Reflect.get(n,e,r);return(isSymbol$1(e)?builtInSymbols.has(e):isNonTrackableKeys(e))||(s||track(n,"get",e),i)?a:isRef(a)?o&&isIntegerKey(e)?a:a.value:isObject$2(a)?s?readonly(a):reactive(a):a}}class MutableReactiveHandler extends BaseReactiveHandler{constructor(n=!1){super(!1,n)}set(n,e,r,s){let i=n[e];if(!this._isShallow){const d=isReadonly(i);if(!isShallow(r)&&!isReadonly(r)&&(i=toRaw(i),r=toRaw(r)),!isArray$3(n)&&isRef(i)&&!isRef(r))return d?!1:(i.value=r,!0)}const o=isArray$3(n)&&isIntegerKey(e)?Number(e)<n.length:hasOwn(n,e),a=Reflect.set(n,e,r,s);return n===toRaw(s)&&(o?hasChanged(r,i)&&trigger(n,"set",e,r):trigger(n,"add",e,r)),a}deleteProperty(n,e){const r=hasOwn(n,e);n[e];const s=Reflect.deleteProperty(n,e);return s&&r&&trigger(n,"delete",e,void 0),s}has(n,e){const r=Reflect.has(n,e);return(!isSymbol$1(e)||!builtInSymbols.has(e))&&track(n,"has",e),r}ownKeys(n){return track(n,"iterate",isArray$3(n)?"length":ITERATE_KEY),Reflect.ownKeys(n)}}class ReadonlyReactiveHandler extends BaseReactiveHandler{constructor(n=!1){super(!0,n)}set(n,e){return!0}deleteProperty(n,e){return!0}}const mutableHandlers=new MutableReactiveHandler,readonlyHandlers=new ReadonlyReactiveHandler,shallowReactiveHandlers=new MutableReactiveHandler(!0),toShallow=t=>t,getProto=t=>Reflect.getPrototypeOf(t);function get$1(t,n,e=!1,r=!1){t=t.__v_raw;const s=toRaw(t),i=toRaw(n);e||(hasChanged(n,i)&&track(s,"get",n),track(s,"get",i));const{has:o}=getProto(s),a=r?toShallow:e?toReadonly:toReactive;if(o.call(s,n))return a(t.get(n));if(o.call(s,i))return a(t.get(i));t!==s&&t.get(n)}function has(t,n=!1){const e=this.__v_raw,r=toRaw(e),s=toRaw(t);return n||(hasChanged(t,s)&&track(r,"has",t),track(r,"has",s)),t===s?e.has(t):e.has(t)||e.has(s)}function size(t,n=!1){return t=t.__v_raw,!n&&track(toRaw(t),"iterate",ITERATE_KEY),Reflect.get(t,"size",t)}function add(t){t=toRaw(t);const n=toRaw(this);return getProto(n).has.call(n,t)||(n.add(t),trigger(n,"add",t,t)),this}function set(t,n){n=toRaw(n);const e=toRaw(this),{has:r,get:s}=getProto(e);let i=r.call(e,t);i||(t=toRaw(t),i=r.call(e,t));const o=s.call(e,t);return e.set(t,n),i?hasChanged(n,o)&&trigger(e,"set",t,n):trigger(e,"add",t,n),this}function deleteEntry(t){const n=toRaw(this),{has:e,get:r}=getProto(n);let s=e.call(n,t);s||(t=toRaw(t),s=e.call(n,t)),r&&r.call(n,t);const i=n.delete(t);return s&&trigger(n,"delete",t,void 0),i}function clear(){const t=toRaw(this),n=t.size!==0,e=t.clear();return n&&trigger(t,"clear",void 0,void 0),e}function createForEach(t,n){return function(r,s){const i=this,o=i.__v_raw,a=toRaw(o),d=n?toShallow:t?toReadonly:toReactive;return!t&&track(a,"iterate",ITERATE_KEY),o.forEach((c,u)=>r.call(s,d(c),d(u),i))}}function createIterableMethod(t,n,e){return function(...r){const s=this.__v_raw,i=toRaw(s),o=isMap(i),a=t==="entries"||t===Symbol.iterator&&o,d=t==="keys"&&o,c=s[t](...r),u=e?toShallow:n?toReadonly:toReactive;return!n&&track(i,"iterate",d?MAP_KEY_ITERATE_KEY:ITERATE_KEY),{next(){const{value:m,done:y}=c.next();return y?{value:m,done:y}:{value:a?[u(m[0]),u(m[1])]:u(m),done:y}},[Symbol.iterator](){return this}}}}function createReadonlyMethod(t){return function(...n){return t==="delete"?!1:t==="clear"?void 0:this}}function createInstrumentations(){const t={get(i){return get$1(this,i)},get size(){return size(this)},has,add,set,delete:deleteEntry,clear,forEach:createForEach(!1,!1)},n={get(i){return get$1(this,i,!1,!0)},get size(){return size(this)},has,add,set,delete:deleteEntry,clear,forEach:createForEach(!1,!0)},e={get(i){return get$1(this,i,!0)},get size(){return size(this,!0)},has(i){return has.call(this,i,!0)},add:createReadonlyMethod("add"),set:createReadonlyMethod("set"),delete:createReadonlyMethod("delete"),clear:createReadonlyMethod("clear"),forEach:createForEach(!0,!1)},r={get(i){return get$1(this,i,!0,!0)},get size(){return size(this,!0)},has(i){return has.call(this,i,!0)},add:createReadonlyMethod("add"),set:createReadonlyMethod("set"),delete:createReadonlyMethod("delete"),clear:createReadonlyMethod("clear"),forEach:createForEach(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach(i=>{t[i]=createIterableMethod(i,!1,!1),e[i]=createIterableMethod(i,!0,!1),n[i]=createIterableMethod(i,!1,!0),r[i]=createIterableMethod(i,!0,!0)}),[t,e,n,r]}const[mutableInstrumentations,readonlyInstrumentations,shallowInstrumentations,shallowReadonlyInstrumentations]=createInstrumentations();function createInstrumentationGetter(t,n){const e=n?t?shallowReadonlyInstrumentations:shallowInstrumentations:t?readonlyInstrumentations:mutableInstrumentations;return(r,s,i)=>s==="__v_isReactive"?!t:s==="__v_isReadonly"?t:s==="__v_raw"?r:Reflect.get(hasOwn(e,s)&&s in r?e:r,s,i)}const mutableCollectionHandlers={get:createInstrumentationGetter(!1,!1)},shallowCollectionHandlers={get:createInstrumentationGetter(!1,!0)},readonlyCollectionHandlers={get:createInstrumentationGetter(!0,!1)},reactiveMap=new WeakMap,shallowReactiveMap=new WeakMap,readonlyMap=new WeakMap,shallowReadonlyMap=new WeakMap;function targetTypeMap(t){switch(t){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function getTargetType(t){return t.__v_skip||!Object.isExtensible(t)?0:targetTypeMap(toRawType(t))}function reactive(t){return isReadonly(t)?t:createReactiveObject(t,!1,mutableHandlers,mutableCollectionHandlers,reactiveMap)}function shallowReactive(t){return createReactiveObject(t,!1,shallowReactiveHandlers,shallowCollectionHandlers,shallowReactiveMap)}function readonly(t){return createReactiveObject(t,!0,readonlyHandlers,readonlyCollectionHandlers,readonlyMap)}function createReactiveObject(t,n,e,r,s){if(!isObject$2(t)||t.__v_raw&&!(n&&t.__v_isReactive))return t;const i=s.get(t);if(i)return i;const o=getTargetType(t);if(o===0)return t;const a=new Proxy(t,o===2?r:e);return s.set(t,a),a}function isReactive(t){return isReadonly(t)?isReactive(t.__v_raw):!!(t&&t.__v_isReactive)}function isReadonly(t){return!!(t&&t.__v_isReadonly)}function isShallow(t){return!!(t&&t.__v_isShallow)}function isProxy(t){return isReactive(t)||isReadonly(t)}function toRaw(t){const n=t&&t.__v_raw;return n?toRaw(n):t}function markRaw(t){return Object.isExtensible(t)&&def(t,"__v_skip",!0),t}const toReactive=t=>isObject$2(t)?reactive(t):t,toReadonly=t=>isObject$2(t)?readonly(t):t;class ComputedRefImpl{constructor(n,e,r,s){this.getter=n,this._setter=e,this.dep=void 0,this.__v_isRef=!0,this.__v_isReadonly=!1,this.effect=new ReactiveEffect(()=>n(this._value),()=>triggerRefValue(this,this.effect._dirtyLevel===2?2:3)),this.effect.computed=this,this.effect.active=this._cacheable=!s,this.__v_isReadonly=r}get value(){const n=toRaw(this);return(!n._cacheable||n.effect.dirty)&&hasChanged(n._value,n._value=n.effect.run())&&triggerRefValue(n,4),trackRefValue(n),n.effect._dirtyLevel>=2&&triggerRefValue(n,2),n._value}set value(n){this._setter(n)}get _dirty(){return this.effect.dirty}set _dirty(n){this.effect.dirty=n}}function computed$1(t,n,e=!1){let r,s;const i=isFunction$2(t);return i?(r=t,s=NOOP):(r=t.get,s=t.set),new ComputedRefImpl(r,s,i||!s,e)}function trackRefValue(t){var n;shouldTrack&&activeEffect&&(t=toRaw(t),trackEffect(activeEffect,(n=t.dep)!=null?n:t.dep=createDep(()=>t.dep=void 0,t instanceof ComputedRefImpl?t:void 0)))}function triggerRefValue(t,n=4,e){t=toRaw(t);const r=t.dep;r&&triggerEffects(r,n)}function isRef(t){return!!(t&&t.__v_isRef===!0)}function ref(t){return createRef(t,!1)}function shallowRef(t){return createRef(t,!0)}function createRef(t,n){return isRef(t)?t:new RefImpl(t,n)}class RefImpl{constructor(n,e){this.__v_isShallow=e,this.dep=void 0,this.__v_isRef=!0,this._rawValue=e?n:toRaw(n),this._value=e?n:toReactive(n)}get value(){return trackRefValue(this),this._value}set value(n){const e=this.__v_isShallow||isShallow(n)||isReadonly(n);n=e?n:toRaw(n),hasChanged(n,this._rawValue)&&(this._rawValue=n,this._value=e?n:toReactive(n),triggerRefValue(this,4))}}function unref(t){return isRef(t)?t.value:t}const shallowUnwrapHandlers={get:(t,n,e)=>unref(Reflect.get(t,n,e)),set:(t,n,e,r)=>{const s=t[n];return isRef(s)&&!isRef(e)?(s.value=e,!0):Reflect.set(t,n,e,r)}};function proxyRefs(t){return isReactive(t)?t:new Proxy(t,shallowUnwrapHandlers)}function toRefs(t){const n=isArray$3(t)?new Array(t.length):{};for(const e in t)n[e]=propertyToRef(t,e);return n}class ObjectRefImpl{constructor(n,e,r){this._object=n,this._key=e,this._defaultValue=r,this.__v_isRef=!0}get value(){const n=this._object[this._key];return n===void 0?this._defaultValue:n}set value(n){this._object[this._key]=n}get dep(){return getDepFromReactive(toRaw(this._object),this._key)}}class GetterRefImpl{constructor(n){this._getter=n,this.__v_isRef=!0,this.__v_isReadonly=!0}get value(){return this._getter()}}function toRef(t,n,e){return isRef(t)?t:isFunction$2(t)?new GetterRefImpl(t):isObject$2(t)&&arguments.length>1?propertyToRef(t,n,e):ref(t)}function propertyToRef(t,n,e){const r=t[n];return isRef(r)?r:new ObjectRefImpl(t,n,e)}/**
* @vue/runtime-core v3.4.20
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/const stack=[];function warn$1(t,...n){pauseTracking();const e=stack.length?stack[stack.length-1].component:null,r=e&&e.appContext.config.warnHandler,s=getComponentTrace();if(r)callWithErrorHandling(r,e,11,[t+n.join(""),e&&e.proxy,s.map(({vnode:i})=>`at <${formatComponentName(e,i.type)}>`).join(`
`),s]);else{const i=[`[Vue warn]: ${t}`,...n];s.length&&i.push(`
`,...formatTrace(s)),console.warn(...i)}resetTracking()}function getComponentTrace(){let t=stack[stack.length-1];if(!t)return[];const n=[];for(;t;){const e=n[0];e&&e.vnode===t?e.recurseCount++:n.push({vnode:t,recurseCount:0});const r=t.component&&t.component.parent;t=r&&r.vnode}return n}function formatTrace(t){const n=[];return t.forEach((e,r)=>{n.push(...r===0?[]:[`
`],...formatTraceEntry(e))}),n}function formatTraceEntry({vnode:t,recurseCount:n}){const e=n>0?`... (${n} recursive calls)`:"",r=t.component?t.component.parent==null:!1,s=` at <${formatComponentName(t.component,t.type,r)}`,i=">"+e;return t.props?[s,...formatProps(t.props),i]:[s+i]}function formatProps(t){const n=[],e=Object.keys(t);return e.slice(0,3).forEach(r=>{n.push(...formatProp(r,t[r]))}),e.length>3&&n.push(" ..."),n}function formatProp(t,n,e){return isString$2(n)?(n=JSON.stringify(n),e?n:[`${t}=${n}`]):typeof n=="number"||typeof n=="boolean"||n==null?e?n:[`${t}=${n}`]:isRef(n)?(n=formatProp(t,toRaw(n.value),!0),e?n:[`${t}=Ref<`,n,">"]):isFunction$2(n)?[`${t}=fn${n.name?`<${n.name}>`:""}`]:(n=toRaw(n),e?n:[`${t}=`,n])}function callWithErrorHandling(t,n,e,r){try{return r?t(...r):t()}catch(s){handleError(s,n,e)}}function callWithAsyncErrorHandling(t,n,e,r){if(isFunction$2(t)){const i=callWithErrorHandling(t,n,e,r);return i&&isPromise(i)&&i.catch(o=>{handleError(o,n,e)}),i}const s=[];for(let i=0;i<t.length;i++)s.push(callWithAsyncErrorHandling(t[i],n,e,r));return s}function handleError(t,n,e,r=!0){const s=n?n.vnode:null;if(n){let i=n.parent;const o=n.proxy,a=`https://vuejs.org/error-reference/#runtime-${e}`;for(;i;){const c=i.ec;if(c){for(let u=0;u<c.length;u++)if(c[u](t,o,a)===!1)return}i=i.parent}const d=n.appContext.config.errorHandler;if(d){callWithErrorHandling(d,null,10,[t,o,a]);return}}logError(t,e,s,r)}function logError(t,n,e,r=!0){console.error(t)}let isFlushing=!1,isFlushPending=!1;const queue=[];let flushIndex=0;const pendingPostFlushCbs=[];let activePostFlushCbs=null,postFlushIndex=0;const resolvedPromise=Promise.resolve();let currentFlushPromise=null;function nextTick(t){const n=currentFlushPromise||resolvedPromise;return t?n.then(this?t.bind(this):t):n}function findInsertionIndex(t){let n=flushIndex+1,e=queue.length;for(;n<e;){const r=n+e>>>1,s=queue[r],i=getId(s);i<t||i===t&&s.pre?n=r+1:e=r}return n}function queueJob(t){(!queue.length||!queue.includes(t,isFlushing&&t.allowRecurse?flushIndex+1:flushIndex))&&(t.id==null?queue.push(t):queue.splice(findInsertionIndex(t.id),0,t),queueFlush())}function queueFlush(){!isFlushing&&!isFlushPending&&(isFlushPending=!0,currentFlushPromise=resolvedPromise.then(flushJobs))}function invalidateJob(t){const n=queue.indexOf(t);n>flushIndex&&queue.splice(n,1)}function queuePostFlushCb(t){isArray$3(t)?pendingPostFlushCbs.push(...t):(!activePostFlushCbs||!activePostFlushCbs.includes(t,t.allowRecurse?postFlushIndex+1:postFlushIndex))&&pendingPostFlushCbs.push(t),queueFlush()}function flushPreFlushCbs(t,n,e=isFlushing?flushIndex+1:0){for(;e<queue.length;e++){const r=queue[e];if(r&&r.pre){if(t&&r.id!==t.uid)continue;queue.splice(e,1),e--,r()}}}function flushPostFlushCbs(t){if(pendingPostFlushCbs.length){const n=[...new Set(pendingPostFlushCbs)].sort((e,r)=>getId(e)-getId(r));if(pendingPostFlushCbs.length=0,activePostFlushCbs){activePostFlushCbs.push(...n);return}for(activePostFlushCbs=n,postFlushIndex=0;postFlushIndex<activePostFlushCbs.length;postFlushIndex++)activePostFlushCbs[postFlushIndex]();activePostFlushCbs=null,postFlushIndex=0}}const getId=t=>t.id==null?1/0:t.id,comparator=(t,n)=>{const e=getId(t)-getId(n);if(e===0){if(t.pre&&!n.pre)return-1;if(n.pre&&!t.pre)return 1}return e};function flushJobs(t){isFlushPending=!1,isFlushing=!0,queue.sort(comparator);const n=NOOP;try{for(flushIndex=0;flushIndex<queue.length;flushIndex++){const e=queue[flushIndex];e&&e.active!==!1&&callWithErrorHandling(e,null,14)}}finally{flushIndex=0,queue.length=0,flushPostFlushCbs(),isFlushing=!1,currentFlushPromise=null,(queue.length||pendingPostFlushCbs.length)&&flushJobs()}}function emit(t,n,...e){if(t.isUnmounted)return;const r=t.vnode.props||EMPTY_OBJ;let s=e;const i=n.startsWith("update:"),o=i&&n.slice(7);if(o&&o in r){const u=`${o==="modelValue"?"model":o}Modifiers`,{number:m,trim:y}=r[u]||EMPTY_OBJ;y&&(s=e.map(S=>isString$2(S)?S.trim():S)),m&&(s=e.map(looseToNumber))}let a,d=r[a=toHandlerKey(n)]||r[a=toHandlerKey(camelize(n))];!d&&i&&(d=r[a=toHandlerKey(hyphenate(n))]),d&&callWithAsyncErrorHandling(d,t,6,s);const c=r[a+"Once"];if(c){if(!t.emitted)t.emitted={};else if(t.emitted[a])return;t.emitted[a]=!0,callWithAsyncErrorHandling(c,t,6,s)}}function normalizeEmitsOptions(t,n,e=!1){const r=n.emitsCache,s=r.get(t);if(s!==void 0)return s;const i=t.emits;let o={},a=!1;if(!isFunction$2(t)){const d=c=>{const u=normalizeEmitsOptions(c,n,!0);u&&(a=!0,extend$1(o,u))};!e&&n.mixins.length&&n.mixins.forEach(d),t.extends&&d(t.extends),t.mixins&&t.mixins.forEach(d)}return!i&&!a?(isObject$2(t)&&r.set(t,null),null):(isArray$3(i)?i.forEach(d=>o[d]=null):extend$1(o,i),isObject$2(t)&&r.set(t,o),o)}function isEmitListener(t,n){return!t||!isOn(n)?!1:(n=n.slice(2).replace(/Once$/,""),hasOwn(t,n[0].toLowerCase()+n.slice(1))||hasOwn(t,hyphenate(n))||hasOwn(t,n))}let currentRenderingInstance=null,currentScopeId=null;function setCurrentRenderingInstance(t){const n=currentRenderingInstance;return currentRenderingInstance=t,currentScopeId=t&&t.type.__scopeId||null,n}function withCtx(t,n=currentRenderingInstance,e){if(!n||t._n)return t;const r=(...s)=>{r._d&&setBlockTracking(-1);const i=setCurrentRenderingInstance(n);let o;try{o=t(...s)}finally{setCurrentRenderingInstance(i),r._d&&setBlockTracking(1)}return o};return r._n=!0,r._c=!0,r._d=!0,r}function markAttrsAccessed(){}function renderComponentRoot(t){const{type:n,vnode:e,proxy:r,withProxy:s,props:i,propsOptions:[o],slots:a,attrs:d,emit:c,render:u,renderCache:m,data:y,setupState:S,ctx:O,inheritAttrs:k}=t;let g,v;const ue=setCurrentRenderingInstance(t);try{if(e.shapeFlag&4){const re=s||r,le=re;g=normalizeVNode(u.call(le,re,m,i,S,y,O)),v=d}else{const re=n;g=normalizeVNode(re.length>1?re(i,{attrs:d,slots:a,emit:c}):re(i,null)),v=n.props?d:getFunctionalFallthrough(d)}}catch(re){blockStack.length=0,handleError(re,t,1),g=createVNode(Comment)}let L=g;if(v&&k!==!1){const re=Object.keys(v),{shapeFlag:le}=L;re.length&&le&7&&(o&&re.some(isModelListener)&&(v=filterModelListeners(v,o)),L=cloneVNode(L,v))}return e.dirs&&(L=cloneVNode(L),L.dirs=L.dirs?L.dirs.concat(e.dirs):e.dirs),e.transition&&(L.transition=e.transition),g=L,setCurrentRenderingInstance(ue),g}const getFunctionalFallthrough=t=>{let n;for(const e in t)(e==="class"||e==="style"||isOn(e))&&((n||(n={}))[e]=t[e]);return n},filterModelListeners=(t,n)=>{const e={};for(const r in t)(!isModelListener(r)||!(r.slice(9)in n))&&(e[r]=t[r]);return e};function shouldUpdateComponent(t,n,e){const{props:r,children:s,component:i}=t,{props:o,children:a,patchFlag:d}=n,c=i.emitsOptions;if(n.dirs||n.transition)return!0;if(e&&d>=0){if(d&1024)return!0;if(d&16)return r?hasPropsChanged(r,o,c):!!o;if(d&8){const u=n.dynamicProps;for(let m=0;m<u.length;m++){const y=u[m];if(o[y]!==r[y]&&!isEmitListener(c,y))return!0}}}else return(s||a)&&(!a||!a.$stable)?!0:r===o?!1:r?o?hasPropsChanged(r,o,c):!0:!!o;return!1}function hasPropsChanged(t,n,e){const r=Object.keys(n);if(r.length!==Object.keys(t).length)return!0;for(let s=0;s<r.length;s++){const i=r[s];if(n[i]!==t[i]&&!isEmitListener(e,i))return!0}return!1}function updateHOCHostEl({vnode:t,parent:n},e){for(;n;){const r=n.subTree;if(r.suspense&&r.suspense.activeBranch===t&&(r.el=t.el),r===t)(t=n.vnode).el=e,n=n.parent;else break}}const COMPONENTS="components";function resolveComponent(t,n){return resolveAsset(COMPONENTS,t,!0,n)||t}const NULL_DYNAMIC_COMPONENT=Symbol.for("v-ndc");function resolveDynamicComponent(t){return isString$2(t)?resolveAsset(COMPONENTS,t,!1)||t:t||NULL_DYNAMIC_COMPONENT}function resolveAsset(t,n,e=!0,r=!1){const s=currentRenderingInstance||currentInstance;if(s){const i=s.type;if(t===COMPONENTS){const a=getComponentName(i,!1);if(a&&(a===n||a===camelize(n)||a===capitalize(camelize(n))))return i}const o=resolve(s[t]||i[t],n)||resolve(s.appContext[t],n);return!o&&r?i:o}}function resolve(t,n){return t&&(t[n]||t[camelize(n)]||t[capitalize(camelize(n))])}const isSuspense=t=>t.__isSuspense;function queueEffectWithSuspense(t,n){n&&n.pendingBranch?isArray$3(t)?n.effects.push(...t):n.effects.push(t):queuePostFlushCb(t)}const ssrContextKey=Symbol.for("v-scx"),useSSRContext=()=>inject(ssrContextKey);function watchEffect(t,n){return doWatch(t,null,n)}const INITIAL_WATCHER_VALUE={};function watch(t,n,e){return doWatch(t,n,e)}function doWatch(t,n,{immediate:e,deep:r,flush:s,once:i,onTrack:o,onTrigger:a}=EMPTY_OBJ){if(n&&i){const oe=n;n=(...he)=>{oe(...he),le()}}const d=currentInstance,c=oe=>r===!0?oe:traverse(oe,r===!1?1:void 0);let u,m=!1,y=!1;if(isRef(t)?(u=()=>t.value,m=isShallow(t)):isReactive(t)?(u=()=>c(t),m=!0):isArray$3(t)?(y=!0,m=t.some(oe=>isReactive(oe)||isShallow(oe)),u=()=>t.map(oe=>{if(isRef(oe))return oe.value;if(isReactive(oe))return c(oe);if(isFunction$2(oe))return callWithErrorHandling(oe,d,2)})):isFunction$2(t)?n?u=()=>callWithErrorHandling(t,d,2):u=()=>(S&&S(),callWithAsyncErrorHandling(t,d,3,[O])):u=NOOP,n&&r){const oe=u;u=()=>traverse(oe())}let S,O=oe=>{S=L.onStop=()=>{callWithErrorHandling(oe,d,4),S=L.onStop=void 0}},k;if(isInSSRComponentSetup)if(O=NOOP,n?e&&callWithAsyncErrorHandling(n,d,3,[u(),y?[]:void 0,O]):u(),s==="sync"){const oe=useSSRContext();k=oe.__watcherHandles||(oe.__watcherHandles=[])}else return NOOP;let g=y?new Array(t.length).fill(INITIAL_WATCHER_VALUE):INITIAL_WATCHER_VALUE;const v=()=>{if(!(!L.active||!L.dirty))if(n){const oe=L.run();(r||m||(y?oe.some((he,Ie)=>hasChanged(he,g[Ie])):hasChanged(oe,g)))&&(S&&S(),callWithAsyncErrorHandling(n,d,3,[oe,g===INITIAL_WATCHER_VALUE?void 0:y&&g[0]===INITIAL_WATCHER_VALUE?[]:g,O]),g=oe)}else L.run()};v.allowRecurse=!!n;let ue;s==="sync"?ue=v:s==="post"?ue=()=>queuePostRenderEffect(v,d&&d.suspense):(v.pre=!0,d&&(v.id=d.uid),ue=()=>queueJob(v));const L=new ReactiveEffect(u,NOOP,ue),re=getCurrentScope(),le=()=>{L.stop(),re&&remove(re.effects,L)};return n?e?v():g=L.run():s==="post"?queuePostRenderEffect(L.run.bind(L),d&&d.suspense):L.run(),k&&k.push(le),le}function instanceWatch(t,n,e){const r=this.proxy,s=isString$2(t)?t.includes(".")?createPathGetter(r,t):()=>r[t]:t.bind(r,r);let i;isFunction$2(n)?i=n:(i=n.handler,e=n);const o=setCurrentInstance(this),a=doWatch(s,i.bind(r),e);return o(),a}function createPathGetter(t,n){const e=n.split(".");return()=>{let r=t;for(let s=0;s<e.length&&r;s++)r=r[e[s]];return r}}function traverse(t,n,e=0,r){if(!isObject$2(t)||t.__v_skip)return t;if(n&&n>0){if(e>=n)return t;e++}if(r=r||new Set,r.has(t))return t;if(r.add(t),isRef(t))traverse(t.value,n,e,r);else if(isArray$3(t))for(let s=0;s<t.length;s++)traverse(t[s],n,e,r);else if(isSet(t)||isMap(t))t.forEach(s=>{traverse(s,n,e,r)});else if(isPlainObject$1(t))for(const s in t)traverse(t[s],n,e,r);return t}function withDirectives(t,n){if(currentRenderingInstance===null)return t;const e=getExposeProxy(currentRenderingInstance)||currentRenderingInstance.proxy,r=t.dirs||(t.dirs=[]);for(let s=0;s<n.length;s++){let[i,o,a,d=EMPTY_OBJ]=n[s];i&&(isFunction$2(i)&&(i={mounted:i,updated:i}),i.deep&&traverse(o),r.push({dir:i,instance:e,value:o,oldValue:void 0,arg:a,modifiers:d}))}return t}function invokeDirectiveHook(t,n,e,r){const s=t.dirs,i=n&&n.dirs;for(let o=0;o<s.length;o++){const a=s[o];i&&(a.oldValue=i[o].value);let d=a.dir[r];d&&(pauseTracking(),callWithAsyncErrorHandling(d,e,8,[t.el,a,t,n]),resetTracking())}}const leaveCbKey=Symbol("_leaveCb"),enterCbKey=Symbol("_enterCb");function useTransitionState(){const t={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return onMounted(()=>{t.isMounted=!0}),onBeforeUnmount(()=>{t.isUnmounting=!0}),t}const TransitionHookValidator=[Function,Array],BaseTransitionPropsValidators={mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:TransitionHookValidator,onEnter:TransitionHookValidator,onAfterEnter:TransitionHookValidator,onEnterCancelled:TransitionHookValidator,onBeforeLeave:TransitionHookValidator,onLeave:TransitionHookValidator,onAfterLeave:TransitionHookValidator,onLeaveCancelled:TransitionHookValidator,onBeforeAppear:TransitionHookValidator,onAppear:TransitionHookValidator,onAfterAppear:TransitionHookValidator,onAppearCancelled:TransitionHookValidator},BaseTransitionImpl={name:"BaseTransition",props:BaseTransitionPropsValidators,setup(t,{slots:n}){const e=getCurrentInstance(),r=useTransitionState();return()=>{const s=n.default&&getTransitionRawChildren(n.default(),!0);if(!s||!s.length)return;let i=s[0];if(s.length>1){for(const y of s)if(y.type!==Comment){i=y;break}}const o=toRaw(t),{mode:a}=o;if(r.isLeaving)return emptyPlaceholder(i);const d=getKeepAliveChild(i);if(!d)return emptyPlaceholder(i);const c=resolveTransitionHooks(d,o,r,e);setTransitionHooks(d,c);const u=e.subTree,m=u&&getKeepAliveChild(u);if(m&&m.type!==Comment&&!isSameVNodeType(d,m)){const y=resolveTransitionHooks(m,o,r,e);if(setTransitionHooks(m,y),a==="out-in")return r.isLeaving=!0,y.afterLeave=()=>{r.isLeaving=!1,e.update.active!==!1&&(e.effect.dirty=!0,e.update())},emptyPlaceholder(i);a==="in-out"&&d.type!==Comment&&(y.delayLeave=(S,O,k)=>{const g=getLeavingNodesForType(r,m);g[String(m.key)]=m,S[leaveCbKey]=()=>{O(),S[leaveCbKey]=void 0,delete c.delayedLeave},c.delayedLeave=k})}return i}}},BaseTransition=BaseTransitionImpl;function getLeavingNodesForType(t,n){const{leavingVNodes:e}=t;let r=e.get(n.type);return r||(r=Object.create(null),e.set(n.type,r)),r}function resolveTransitionHooks(t,n,e,r){const{appear:s,mode:i,persisted:o=!1,onBeforeEnter:a,onEnter:d,onAfterEnter:c,onEnterCancelled:u,onBeforeLeave:m,onLeave:y,onAfterLeave:S,onLeaveCancelled:O,onBeforeAppear:k,onAppear:g,onAfterAppear:v,onAppearCancelled:ue}=n,L=String(t.key),re=getLeavingNodesForType(e,t),le=(Ie,ie)=>{Ie&&callWithAsyncErrorHandling(Ie,r,9,ie)},oe=(Ie,ie)=>{const Ne=ie[1];le(Ie,ie),isArray$3(Ie)?Ie.every(Ve=>Ve.length<=1)&&Ne():Ie.length<=1&&Ne()},he={mode:i,persisted:o,beforeEnter(Ie){let ie=a;if(!e.isMounted)if(s)ie=k||a;else return;Ie[leaveCbKey]&&Ie[leaveCbKey](!0);const Ne=re[L];Ne&&isSameVNodeType(t,Ne)&&Ne.el[leaveCbKey]&&Ne.el[leaveCbKey](),le(ie,[Ie])},enter(Ie){let ie=d,Ne=c,Ve=u;if(!e.isMounted)if(s)ie=g||d,Ne=v||c,Ve=ue||u;else return;let Ce=!1;const Ue=Ie[enterCbKey]=qe=>{Ce||(Ce=!0,qe?le(Ve,[Ie]):le(Ne,[Ie]),he.delayedLeave&&he.delayedLeave(),Ie[enterCbKey]=void 0)};ie?oe(ie,[Ie,Ue]):Ue()},leave(Ie,ie){const Ne=String(t.key);if(Ie[enterCbKey]&&Ie[enterCbKey](!0),e.isUnmounting)return ie();le(m,[Ie]);let Ve=!1;const Ce=Ie[leaveCbKey]=Ue=>{Ve||(Ve=!0,ie(),Ue?le(O,[Ie]):le(S,[Ie]),Ie[leaveCbKey]=void 0,re[Ne]===t&&delete re[Ne])};re[Ne]=t,y?oe(y,[Ie,Ce]):Ce()},clone(Ie){return resolveTransitionHooks(Ie,n,e,r)}};return he}function emptyPlaceholder(t){if(isKeepAlive(t))return t=cloneVNode(t),t.children=null,t}function getKeepAliveChild(t){return isKeepAlive(t)?t.children?t.children[0]:void 0:t}function setTransitionHooks(t,n){t.shapeFlag&6&&t.component?setTransitionHooks(t.component.subTree,n):t.shapeFlag&128?(t.ssContent.transition=n.clone(t.ssContent),t.ssFallback.transition=n.clone(t.ssFallback)):t.transition=n}function getTransitionRawChildren(t,n=!1,e){let r=[],s=0;for(let i=0;i<t.length;i++){let o=t[i];const a=e==null?o.key:String(e)+String(o.key!=null?o.key:i);o.type===Fragment?(o.patchFlag&128&&s++,r=r.concat(getTransitionRawChildren(o.children,n,a))):(n||o.type!==Comment)&&r.push(a!=null?cloneVNode(o,{key:a}):o)}if(s>1)for(let i=0;i<r.length;i++)r[i].patchFlag=-2;return r}/*! #__NO_SIDE_EFFECTS__ */function defineComponent(t,n){return isFunction$2(t)?(()=>extend$1({name:t.name},n,{setup:t}))():t}const isAsyncWrapper=t=>!!t.type.__asyncLoader,isKeepAlive=t=>t.type.__isKeepAlive;function onActivated(t,n){registerKeepAliveHook(t,"a",n)}function onDeactivated(t,n){registerKeepAliveHook(t,"da",n)}function registerKeepAliveHook(t,n,e=currentInstance){const r=t.__wdc||(t.__wdc=()=>{let s=e;for(;s;){if(s.isDeactivated)return;s=s.parent}return t()});if(injectHook(n,r,e),e){let s=e.parent;for(;s&&s.parent;)isKeepAlive(s.parent.vnode)&&injectToKeepAliveRoot(r,n,e,s),s=s.parent}}function injectToKeepAliveRoot(t,n,e,r){const s=injectHook(n,t,r,!0);onUnmounted(()=>{remove(r[n],s)},e)}function injectHook(t,n,e=currentInstance,r=!1){if(e){const s=e[t]||(e[t]=[]),i=n.__weh||(n.__weh=(...o)=>{if(e.isUnmounted)return;pauseTracking();const a=setCurrentInstance(e),d=callWithAsyncErrorHandling(n,e,t,o);return a(),resetTracking(),d});return r?s.unshift(i):s.push(i),i}}const createHook=t=>(n,e=currentInstance)=>(!isInSSRComponentSetup||t==="sp")&&injectHook(t,(...r)=>n(...r),e),onBeforeMount=createHook("bm"),onMounted=createHook("m"),onBeforeUpdate=createHook("bu"),onUpdated=createHook("u"),onBeforeUnmount=createHook("bum"),onUnmounted=createHook("um"),onServerPrefetch=createHook("sp"),onRenderTriggered=createHook("rtg"),onRenderTracked=createHook("rtc");function onErrorCaptured(t,n=currentInstance){injectHook("ec",t,n)}function renderList(t,n,e,r){let s;const i=e&&e[r];if(isArray$3(t)||isString$2(t)){s=new Array(t.length);for(let o=0,a=t.length;o<a;o++)s[o]=n(t[o],o,void 0,i&&i[o])}else if(typeof t=="number"){s=new Array(t);for(let o=0;o<t;o++)s[o]=n(o+1,o,void 0,i&&i[o])}else if(isObject$2(t))if(t[Symbol.iterator])s=Array.from(t,(o,a)=>n(o,a,void 0,i&&i[a]));else{const o=Object.keys(t);s=new Array(o.length);for(let a=0,d=o.length;a<d;a++){const c=o[a];s[a]=n(t[c],c,a,i&&i[a])}}else s=[];return e&&(e[r]=s),s}function createSlots(t,n){for(let e=0;e<n.length;e++){const r=n[e];if(isArray$3(r))for(let s=0;s<r.length;s++)t[r[s].name]=r[s].fn;else r&&(t[r.name]=r.key?(...s)=>{const i=r.fn(...s);return i&&(i.key=r.key),i}:r.fn)}return t}function renderSlot(t,n,e={},r,s){if(currentRenderingInstance.isCE||currentRenderingInstance.parent&&isAsyncWrapper(currentRenderingInstance.parent)&&currentRenderingInstance.parent.isCE)return n!=="default"&&(e.name=n),createVNode("slot",e,r&&r());let i=t[n];i&&i._c&&(i._d=!1),openBlock();const o=i&&ensureValidVNode(i(e)),a=createBlock(Fragment,{key:e.key||o&&o.key||`_${n}`},o||(r?r():[]),o&&t._===1?64:-2);return!s&&a.scopeId&&(a.slotScopeIds=[a.scopeId+"-s"]),i&&i._c&&(i._d=!0),a}function ensureValidVNode(t){return t.some(n=>isVNode(n)?!(n.type===Comment||n.type===Fragment&&!ensureValidVNode(n.children)):!0)?t:null}const getPublicInstance=t=>t?isStatefulComponent(t)?getExposeProxy(t)||t.proxy:getPublicInstance(t.parent):null,publicPropertiesMap=extend$1(Object.create(null),{$:t=>t,$el:t=>t.vnode.el,$data:t=>t.data,$props:t=>t.props,$attrs:t=>t.attrs,$slots:t=>t.slots,$refs:t=>t.refs,$parent:t=>getPublicInstance(t.parent),$root:t=>getPublicInstance(t.root),$emit:t=>t.emit,$options:t=>resolveMergedOptions(t),$forceUpdate:t=>t.f||(t.f=()=>{t.effect.dirty=!0,queueJob(t.update)}),$nextTick:t=>t.n||(t.n=nextTick.bind(t.proxy)),$watch:t=>instanceWatch.bind(t)}),hasSetupBinding=(t,n)=>t!==EMPTY_OBJ&&!t.__isScriptSetup&&hasOwn(t,n),PublicInstanceProxyHandlers={get({_:t},n){const{ctx:e,setupState:r,data:s,props:i,accessCache:o,type:a,appContext:d}=t;let c;if(n[0]!=="$"){const S=o[n];if(S!==void 0)switch(S){case 1:return r[n];case 2:return s[n];case 4:return e[n];case 3:return i[n]}else{if(hasSetupBinding(r,n))return o[n]=1,r[n];if(s!==EMPTY_OBJ&&hasOwn(s,n))return o[n]=2,s[n];if((c=t.propsOptions[0])&&hasOwn(c,n))return o[n]=3,i[n];if(e!==EMPTY_OBJ&&hasOwn(e,n))return o[n]=4,e[n];shouldCacheAccess&&(o[n]=0)}}const u=publicPropertiesMap[n];let m,y;if(u)return n==="$attrs"&&track(t,"get",n),u(t);if((m=a.__cssModules)&&(m=m[n]))return m;if(e!==EMPTY_OBJ&&hasOwn(e,n))return o[n]=4,e[n];if(y=d.config.globalProperties,hasOwn(y,n))return y[n]},set({_:t},n,e){const{data:r,setupState:s,ctx:i}=t;return hasSetupBinding(s,n)?(s[n]=e,!0):r!==EMPTY_OBJ&&hasOwn(r,n)?(r[n]=e,!0):hasOwn(t.props,n)||n[0]==="$"&&n.slice(1)in t?!1:(i[n]=e,!0)},has({_:{data:t,setupState:n,accessCache:e,ctx:r,appContext:s,propsOptions:i}},o){let a;return!!e[o]||t!==EMPTY_OBJ&&hasOwn(t,o)||hasSetupBinding(n,o)||(a=i[0])&&hasOwn(a,o)||hasOwn(r,o)||hasOwn(publicPropertiesMap,o)||hasOwn(s.config.globalProperties,o)},defineProperty(t,n,e){return e.get!=null?t._.accessCache[n]=0:hasOwn(e,"value")&&this.set(t,n,e.value,null),Reflect.defineProperty(t,n,e)}};function useSlots(){return getContext().slots}function useAttrs$1(){return getContext().attrs}function getContext(){const t=getCurrentInstance();return t.setupContext||(t.setupContext=createSetupContext(t))}function normalizePropsOrEmits(t){return isArray$3(t)?t.reduce((n,e)=>(n[e]=null,n),{}):t}let shouldCacheAccess=!0;function applyOptions(t){const n=resolveMergedOptions(t),e=t.proxy,r=t.ctx;shouldCacheAccess=!1,n.beforeCreate&&callHook$1(n.beforeCreate,t,"bc");const{data:s,computed:i,methods:o,watch:a,provide:d,inject:c,created:u,beforeMount:m,mounted:y,beforeUpdate:S,updated:O,activated:k,deactivated:g,beforeDestroy:v,beforeUnmount:ue,destroyed:L,unmounted:re,render:le,renderTracked:oe,renderTriggered:he,errorCaptured:Ie,serverPrefetch:ie,expose:Ne,inheritAttrs:Ve,components:Ce,directives:Ue,filters:qe}=n;if(c&&resolveInjections(c,r,null),o)for(const _e in o){const er=o[_e];isFunction$2(er)&&(r[_e]=er.bind(e))}if(s){const _e=s.call(e,e);isObject$2(_e)&&(t.data=reactive(_e))}if(shouldCacheAccess=!0,i)for(const _e in i){const er=i[_e],Pt=isFunction$2(er)?er.bind(e,e):isFunction$2(er.get)?er.get.bind(e,e):NOOP,ar=!isFunction$2(er)&&isFunction$2(er.set)?er.set.bind(e):NOOP,pr=computed({get:Pt,set:ar});Object.defineProperty(r,_e,{enumerable:!0,configurable:!0,get:()=>pr.value,set:lr=>pr.value=lr})}if(a)for(const _e in a)createWatcher(a[_e],r,e,_e);if(d){const _e=isFunction$2(d)?d.call(e):d;Reflect.ownKeys(_e).forEach(er=>{provide(er,_e[er])})}u&&callHook$1(u,t,"c");function $e(_e,er){isArray$3(er)?er.forEach(Pt=>_e(Pt.bind(e))):er&&_e(er.bind(e))}if($e(onBeforeMount,m),$e(onMounted,y),$e(onBeforeUpdate,S),$e(onUpdated,O),$e(onActivated,k),$e(onDeactivated,g),$e(onErrorCaptured,Ie),$e(onRenderTracked,oe),$e(onRenderTriggered,he),$e(onBeforeUnmount,ue),$e(onUnmounted,re),$e(onServerPrefetch,ie),isArray$3(Ne))if(Ne.length){const _e=t.exposed||(t.exposed={});Ne.forEach(er=>{Object.defineProperty(_e,er,{get:()=>e[er],set:Pt=>e[er]=Pt})})}else t.exposed||(t.exposed={});le&&t.render===NOOP&&(t.render=le),Ve!=null&&(t.inheritAttrs=Ve),Ce&&(t.components=Ce),Ue&&(t.directives=Ue)}function resolveInjections(t,n,e=NOOP){isArray$3(t)&&(t=normalizeInject(t));for(const r in t){const s=t[r];let i;isObject$2(s)?"default"in s?i=inject(s.from||r,s.default,!0):i=inject(s.from||r):i=inject(s),isRef(i)?Object.defineProperty(n,r,{enumerable:!0,configurable:!0,get:()=>i.value,set:o=>i.value=o}):n[r]=i}}function callHook$1(t,n,e){callWithAsyncErrorHandling(isArray$3(t)?t.map(r=>r.bind(n.proxy)):t.bind(n.proxy),n,e)}function createWatcher(t,n,e,r){const s=r.includes(".")?createPathGetter(e,r):()=>e[r];if(isString$2(t)){const i=n[t];isFunction$2(i)&&watch(s,i)}else if(isFunction$2(t))watch(s,t.bind(e));else if(isObject$2(t))if(isArray$3(t))t.forEach(i=>createWatcher(i,n,e,r));else{const i=isFunction$2(t.handler)?t.handler.bind(e):n[t.handler];isFunction$2(i)&&watch(s,i,t)}}function resolveMergedOptions(t){const n=t.type,{mixins:e,extends:r}=n,{mixins:s,optionsCache:i,config:{optionMergeStrategies:o}}=t.appContext,a=i.get(n);let d;return a?d=a:!s.length&&!e&&!r?d=n:(d={},s.length&&s.forEach(c=>mergeOptions(d,c,o,!0)),mergeOptions(d,n,o)),isObject$2(n)&&i.set(n,d),d}function mergeOptions(t,n,e,r=!1){const{mixins:s,extends:i}=n;i&&mergeOptions(t,i,e,!0),s&&s.forEach(o=>mergeOptions(t,o,e,!0));for(const o in n)if(!(r&&o==="expose")){const a=internalOptionMergeStrats[o]||e&&e[o];t[o]=a?a(t[o],n[o]):n[o]}return t}const internalOptionMergeStrats={data:mergeDataFn,props:mergeEmitsOrPropsOptions,emits:mergeEmitsOrPropsOptions,methods:mergeObjectOptions,computed:mergeObjectOptions,beforeCreate:mergeAsArray,created:mergeAsArray,beforeMount:mergeAsArray,mounted:mergeAsArray,beforeUpdate:mergeAsArray,updated:mergeAsArray,beforeDestroy:mergeAsArray,beforeUnmount:mergeAsArray,destroyed:mergeAsArray,unmounted:mergeAsArray,activated:mergeAsArray,deactivated:mergeAsArray,errorCaptured:mergeAsArray,serverPrefetch:mergeAsArray,components:mergeObjectOptions,directives:mergeObjectOptions,watch:mergeWatchOptions,provide:mergeDataFn,inject:mergeInject};function mergeDataFn(t,n){return n?t?function(){return extend$1(isFunction$2(t)?t.call(this,this):t,isFunction$2(n)?n.call(this,this):n)}:n:t}function mergeInject(t,n){return mergeObjectOptions(normalizeInject(t),normalizeInject(n))}function normalizeInject(t){if(isArray$3(t)){const n={};for(let e=0;e<t.length;e++)n[t[e]]=t[e];return n}return t}function mergeAsArray(t,n){return t?[...new Set([].concat(t,n))]:n}function mergeObjectOptions(t,n){return t?extend$1(Object.create(null),t,n):n}function mergeEmitsOrPropsOptions(t,n){return t?isArray$3(t)&&isArray$3(n)?[...new Set([...t,...n])]:extend$1(Object.create(null),normalizePropsOrEmits(t),normalizePropsOrEmits(n??{})):n}function mergeWatchOptions(t,n){if(!t)return n;if(!n)return t;const e=extend$1(Object.create(null),t);for(const r in n)e[r]=mergeAsArray(t[r],n[r]);return e}function createAppContext(){return{app:null,config:{isNativeTag:NO,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let uid$1=0;function createAppAPI(t,n){return function(r,s=null){isFunction$2(r)||(r=extend$1({},r)),s!=null&&!isObject$2(s)&&(s=null);const i=createAppContext(),o=new WeakSet;let a=!1;const d=i.app={_uid:uid$1++,_component:r,_props:s,_container:null,_context:i,_instance:null,version,get config(){return i.config},set config(c){},use(c,...u){return o.has(c)||(c&&isFunction$2(c.install)?(o.add(c),c.install(d,...u)):isFunction$2(c)&&(o.add(c),c(d,...u))),d},mixin(c){return i.mixins.includes(c)||i.mixins.push(c),d},component(c,u){return u?(i.components[c]=u,d):i.components[c]},directive(c,u){return u?(i.directives[c]=u,d):i.directives[c]},mount(c,u,m){if(!a){const y=createVNode(r,s);return y.appContext=i,m===!0?m="svg":m===!1&&(m=void 0),u&&n?n(y,c):t(y,c,m),a=!0,d._container=c,c.__vue_app__=d,getExposeProxy(y.component)||y.component.proxy}},unmount(){a&&(t(null,d._container),delete d._container.__vue_app__)},provide(c,u){return i.provides[c]=u,d},runWithContext(c){const u=currentApp;currentApp=d;try{return c()}finally{currentApp=u}}};return d}}let currentApp=null;function provide(t,n){if(currentInstance){let e=currentInstance.provides;const r=currentInstance.parent&&currentInstance.parent.provides;r===e&&(e=currentInstance.provides=Object.create(r)),e[t]=n}}function inject(t,n,e=!1){const r=currentInstance||currentRenderingInstance;if(r||currentApp){const s=r?r.parent==null?r.vnode.appContext&&r.vnode.appContext.provides:r.parent.provides:currentApp._context.provides;if(s&&t in s)return s[t];if(arguments.length>1)return e&&isFunction$2(n)?n.call(r&&r.proxy):n}}function initProps(t,n,e,r=!1){const s={},i={};def(i,InternalObjectKey,1),t.propsDefaults=Object.create(null),setFullProps(t,n,s,i);for(const o in t.propsOptions[0])o in s||(s[o]=void 0);e?t.props=r?s:shallowReactive(s):t.type.props?t.props=s:t.props=i,t.attrs=i}function updateProps(t,n,e,r){const{props:s,attrs:i,vnode:{patchFlag:o}}=t,a=toRaw(s),[d]=t.propsOptions;let c=!1;if((r||o>0)&&!(o&16)){if(o&8){const u=t.vnode.dynamicProps;for(let m=0;m<u.length;m++){let y=u[m];if(isEmitListener(t.emitsOptions,y))continue;const S=n[y];if(d)if(hasOwn(i,y))S!==i[y]&&(i[y]=S,c=!0);else{const O=camelize(y);s[O]=resolvePropValue(d,a,O,S,t,!1)}else S!==i[y]&&(i[y]=S,c=!0)}}}else{setFullProps(t,n,s,i)&&(c=!0);let u;for(const m in a)(!n||!hasOwn(n,m)&&((u=hyphenate(m))===m||!hasOwn(n,u)))&&(d?e&&(e[m]!==void 0||e[u]!==void 0)&&(s[m]=resolvePropValue(d,a,m,void 0,t,!0)):delete s[m]);if(i!==a)for(const m in i)(!n||!hasOwn(n,m))&&(delete i[m],c=!0)}c&&trigger(t,"set","$attrs")}function setFullProps(t,n,e,r){const[s,i]=t.propsOptions;let o=!1,a;if(n)for(let d in n){if(isReservedProp(d))continue;const c=n[d];let u;s&&hasOwn(s,u=camelize(d))?!i||!i.includes(u)?e[u]=c:(a||(a={}))[u]=c:isEmitListener(t.emitsOptions,d)||(!(d in r)||c!==r[d])&&(r[d]=c,o=!0)}if(i){const d=toRaw(e),c=a||EMPTY_OBJ;for(let u=0;u<i.length;u++){const m=i[u];e[m]=resolvePropValue(s,d,m,c[m],t,!hasOwn(c,m))}}return o}function resolvePropValue(t,n,e,r,s,i){const o=t[e];if(o!=null){const a=hasOwn(o,"default");if(a&&r===void 0){const d=o.default;if(o.type!==Function&&!o.skipFactory&&isFunction$2(d)){const{propsDefaults:c}=s;if(e in c)r=c[e];else{const u=setCurrentInstance(s);r=c[e]=d.call(null,n),u()}}else r=d}o[0]&&(i&&!a?r=!1:o[1]&&(r===""||r===hyphenate(e))&&(r=!0))}return r}function normalizePropsOptions(t,n,e=!1){const r=n.propsCache,s=r.get(t);if(s)return s;const i=t.props,o={},a=[];let d=!1;if(!isFunction$2(t)){const u=m=>{d=!0;const[y,S]=normalizePropsOptions(m,n,!0);extend$1(o,y),S&&a.push(...S)};!e&&n.mixins.length&&n.mixins.forEach(u),t.extends&&u(t.extends),t.mixins&&t.mixins.forEach(u)}if(!i&&!d)return isObject$2(t)&&r.set(t,EMPTY_ARR),EMPTY_ARR;if(isArray$3(i))for(let u=0;u<i.length;u++){const m=camelize(i[u]);validatePropName(m)&&(o[m]=EMPTY_OBJ)}else if(i)for(const u in i){const m=camelize(u);if(validatePropName(m)){const y=i[u],S=o[m]=isArray$3(y)||isFunction$2(y)?{type:y}:extend$1({},y);if(S){const O=getTypeIndex(Boolean,S.type),k=getTypeIndex(String,S.type);S[0]=O>-1,S[1]=k<0||O<k,(O>-1||hasOwn(S,"default"))&&a.push(m)}}}const c=[o,a];return isObject$2(t)&&r.set(t,c),c}function validatePropName(t){return t[0]!=="$"&&!isReservedProp(t)}function getType(t){return t===null?"null":typeof t=="function"?t.name||"":typeof t=="object"&&t.constructor&&t.constructor.name||""}function isSameType(t,n){return getType(t)===getType(n)}function getTypeIndex(t,n){return isArray$3(n)?n.findIndex(e=>isSameType(e,t)):isFunction$2(n)&&isSameType(n,t)?0:-1}const isInternalKey=t=>t[0]==="_"||t==="$stable",normalizeSlotValue=t=>isArray$3(t)?t.map(normalizeVNode):[normalizeVNode(t)],normalizeSlot=(t,n,e)=>{if(n._n)return n;const r=withCtx((...s)=>normalizeSlotValue(n(...s)),e);return r._c=!1,r},normalizeObjectSlots=(t,n,e)=>{const r=t._ctx;for(const s in t){if(isInternalKey(s))continue;const i=t[s];if(isFunction$2(i))n[s]=normalizeSlot(s,i,r);else if(i!=null){const o=normalizeSlotValue(i);n[s]=()=>o}}},normalizeVNodeSlots=(t,n)=>{const e=normalizeSlotValue(n);t.slots.default=()=>e},initSlots=(t,n)=>{if(t.vnode.shapeFlag&32){const e=n._;e?(t.slots=toRaw(n),def(n,"_",e)):normalizeObjectSlots(n,t.slots={})}else t.slots={},n&&normalizeVNodeSlots(t,n);def(t.slots,InternalObjectKey,1)},updateSlots=(t,n,e)=>{const{vnode:r,slots:s}=t;let i=!0,o=EMPTY_OBJ;if(r.shapeFlag&32){const a=n._;a?e&&a===1?i=!1:(extend$1(s,n),!e&&a===1&&delete s._):(i=!n.$stable,normalizeObjectSlots(n,s)),o=n}else n&&(normalizeVNodeSlots(t,n),o={default:1});if(i)for(const a in s)!isInternalKey(a)&&o[a]==null&&delete s[a]};function setRef(t,n,e,r,s=!1){if(isArray$3(t)){t.forEach((y,S)=>setRef(y,n&&(isArray$3(n)?n[S]:n),e,r,s));return}if(isAsyncWrapper(r)&&!s)return;const i=r.shapeFlag&4?getExposeProxy(r.component)||r.component.proxy:r.el,o=s?null:i,{i:a,r:d}=t,c=n&&n.r,u=a.refs===EMPTY_OBJ?a.refs={}:a.refs,m=a.setupState;if(c!=null&&c!==d&&(isString$2(c)?(u[c]=null,hasOwn(m,c)&&(m[c]=null)):isRef(c)&&(c.value=null)),isFunction$2(d))callWithErrorHandling(d,a,12,[o,u]);else{const y=isString$2(d),S=isRef(d);if(y||S){const O=()=>{if(t.f){const k=y?hasOwn(m,d)?m[d]:u[d]:d.value;s?isArray$3(k)&&remove(k,i):isArray$3(k)?k.includes(i)||k.push(i):y?(u[d]=[i],hasOwn(m,d)&&(m[d]=u[d])):(d.value=[i],t.k&&(u[t.k]=d.value))}else y?(u[d]=o,hasOwn(m,d)&&(m[d]=o)):S&&(d.value=o,t.k&&(u[t.k]=o))};o?(O.id=-1,queuePostRenderEffect(O,e)):O()}}}const queuePostRenderEffect=queueEffectWithSuspense;function createRenderer(t){return baseCreateRenderer(t)}function baseCreateRenderer(t,n){const e=getGlobalThis();e.__VUE__=!0;const{insert:r,remove:s,patchProp:i,createElement:o,createText:a,createComment:d,setText:c,setElementText:u,parentNode:m,nextSibling:y,setScopeId:S=NOOP,insertStaticContent:O}=t,k=(kt,Dt,gr,yr=null,vr=null,Ir=null,Mr=void 0,Ar=null,Fr=!!Dt.dynamicChildren)=>{if(kt===Dt)return;kt&&!isSameVNodeType(kt,Dt)&&(yr=dr(kt),lr(kt,vr,Ir,!0),kt=null),Dt.patchFlag===-2&&(Fr=!1,Dt.dynamicChildren=null);const{type:Dr,ref:Or,shapeFlag:Sn}=Dt;switch(Dr){case Text:g(kt,Dt,gr,yr);break;case Comment:v(kt,Dt,gr,yr);break;case Static:kt==null&&ue(Dt,gr,yr,Mr);break;case Fragment:Ce(kt,Dt,gr,yr,vr,Ir,Mr,Ar,Fr);break;default:Sn&1?le(kt,Dt,gr,yr,vr,Ir,Mr,Ar,Fr):Sn&6?Ue(kt,Dt,gr,yr,vr,Ir,Mr,Ar,Fr):(Sn&64||Sn&128)&&Dr.process(kt,Dt,gr,yr,vr,Ir,Mr,Ar,Fr,mr)}Or!=null&&vr&&setRef(Or,kt&&kt.ref,Ir,Dt||kt,!Dt)},g=(kt,Dt,gr,yr)=>{if(kt==null)r(Dt.el=a(Dt.children),gr,yr);else{const vr=Dt.el=kt.el;Dt.children!==kt.children&&c(vr,Dt.children)}},v=(kt,Dt,gr,yr)=>{kt==null?r(Dt.el=d(Dt.children||""),gr,yr):Dt.el=kt.el},ue=(kt,Dt,gr,yr)=>{[kt.el,kt.anchor]=O(kt.children,Dt,gr,yr,kt.el,kt.anchor)},L=({el:kt,anchor:Dt},gr,yr)=>{let vr;for(;kt&&kt!==Dt;)vr=y(kt),r(kt,gr,yr),kt=vr;r(Dt,gr,yr)},re=({el:kt,anchor:Dt})=>{let gr;for(;kt&&kt!==Dt;)gr=y(kt),s(kt),kt=gr;s(Dt)},le=(kt,Dt,gr,yr,vr,Ir,Mr,Ar,Fr)=>{Dt.type==="svg"?Mr="svg":Dt.type==="math"&&(Mr="mathml"),kt==null?oe(Dt,gr,yr,vr,Ir,Mr,Ar,Fr):ie(kt,Dt,vr,Ir,Mr,Ar,Fr)},oe=(kt,Dt,gr,yr,vr,Ir,Mr,Ar)=>{let Fr,Dr;const{props:Or,shapeFlag:Sn,transition:Rr,dirs:Wr}=kt;if(Fr=kt.el=o(kt.type,Ir,Or&&Or.is,Or),Sn&8?u(Fr,kt.children):Sn&16&&Ie(kt.children,Fr,null,yr,vr,resolveChildrenNamespace(kt,Ir),Mr,Ar),Wr&&invokeDirectiveHook(kt,null,yr,"created"),he(Fr,kt,kt.scopeId,Mr,yr),Or){for(const Ur in Or)Ur!=="value"&&!isReservedProp(Ur)&&i(Fr,Ur,null,Or[Ur],Ir,kt.children,yr,vr,ir);"value"in Or&&i(Fr,"value",null,Or.value,Ir),(Dr=Or.onVnodeBeforeMount)&&invokeVNodeHook(Dr,yr,kt)}Wr&&invokeDirectiveHook(kt,null,yr,"beforeMount");const Er=needTransition(vr,Rr);Er&&Rr.beforeEnter(Fr),r(Fr,Dt,gr),((Dr=Or&&Or.onVnodeMounted)||Er||Wr)&&queuePostRenderEffect(()=>{Dr&&invokeVNodeHook(Dr,yr,kt),Er&&Rr.enter(Fr),Wr&&invokeDirectiveHook(kt,null,yr,"mounted")},vr)},he=(kt,Dt,gr,yr,vr)=>{if(gr&&S(kt,gr),yr)for(let Ir=0;Ir<yr.length;Ir++)S(kt,yr[Ir]);if(vr){let Ir=vr.subTree;if(Dt===Ir){const Mr=vr.vnode;he(kt,Mr,Mr.scopeId,Mr.slotScopeIds,vr.parent)}}},Ie=(kt,Dt,gr,yr,vr,Ir,Mr,Ar,Fr=0)=>{for(let Dr=Fr;Dr<kt.length;Dr++){const Or=kt[Dr]=Ar?cloneIfMounted(kt[Dr]):normalizeVNode(kt[Dr]);k(null,Or,Dt,gr,yr,vr,Ir,Mr,Ar)}},ie=(kt,Dt,gr,yr,vr,Ir,Mr)=>{const Ar=Dt.el=kt.el;let{patchFlag:Fr,dynamicChildren:Dr,dirs:Or}=Dt;Fr|=kt.patchFlag&16;const Sn=kt.props||EMPTY_OBJ,Rr=Dt.props||EMPTY_OBJ;let Wr;if(gr&&toggleRecurse(gr,!1),(Wr=Rr.onVnodeBeforeUpdate)&&invokeVNodeHook(Wr,gr,Dt,kt),Or&&invokeDirectiveHook(Dt,kt,gr,"beforeUpdate"),gr&&toggleRecurse(gr,!0),Dr?Ne(kt.dynamicChildren,Dr,Ar,gr,yr,resolveChildrenNamespace(Dt,vr),Ir):Mr||er(kt,Dt,Ar,null,gr,yr,resolveChildrenNamespace(Dt,vr),Ir,!1),Fr>0){if(Fr&16)Ve(Ar,Dt,Sn,Rr,gr,yr,vr);else if(Fr&2&&Sn.class!==Rr.class&&i(Ar,"class",null,Rr.class,vr),Fr&4&&i(Ar,"style",Sn.style,Rr.style,vr),Fr&8){const Er=Dt.dynamicProps;for(let Ur=0;Ur<Er.length;Ur++){const Zr=Er[Ur],In=Sn[Zr],An=Rr[Zr];(An!==In||Zr==="value")&&i(Ar,Zr,In,An,vr,kt.children,gr,yr,ir)}}Fr&1&&kt.children!==Dt.children&&u(Ar,Dt.children)}else!Mr&&Dr==null&&Ve(Ar,Dt,Sn,Rr,gr,yr,vr);((Wr=Rr.onVnodeUpdated)||Or)&&queuePostRenderEffect(()=>{Wr&&invokeVNodeHook(Wr,gr,Dt,kt),Or&&invokeDirectiveHook(Dt,kt,gr,"updated")},yr)},Ne=(kt,Dt,gr,yr,vr,Ir,Mr)=>{for(let Ar=0;Ar<Dt.length;Ar++){const Fr=kt[Ar],Dr=Dt[Ar],Or=Fr.el&&(Fr.type===Fragment||!isSameVNodeType(Fr,Dr)||Fr.shapeFlag&70)?m(Fr.el):gr;k(Fr,Dr,Or,null,yr,vr,Ir,Mr,!0)}},Ve=(kt,Dt,gr,yr,vr,Ir,Mr)=>{if(gr!==yr){if(gr!==EMPTY_OBJ)for(const Ar in gr)!isReservedProp(Ar)&&!(Ar in yr)&&i(kt,Ar,gr[Ar],null,Mr,Dt.children,vr,Ir,ir);for(const Ar in yr){if(isReservedProp(Ar))continue;const Fr=yr[Ar],Dr=gr[Ar];Fr!==Dr&&Ar!=="value"&&i(kt,Ar,Dr,Fr,Mr,Dt.children,vr,Ir,ir)}"value"in yr&&i(kt,"value",gr.value,yr.value,Mr)}},Ce=(kt,Dt,gr,yr,vr,Ir,Mr,Ar,Fr)=>{const Dr=Dt.el=kt?kt.el:a(""),Or=Dt.anchor=kt?kt.anchor:a("");let{patchFlag:Sn,dynamicChildren:Rr,slotScopeIds:Wr}=Dt;Wr&&(Ar=Ar?Ar.concat(Wr):Wr),kt==null?(r(Dr,gr,yr),r(Or,gr,yr),Ie(Dt.children||[],gr,Or,vr,Ir,Mr,Ar,Fr)):Sn>0&&Sn&64&&Rr&&kt.dynamicChildren?(Ne(kt.dynamicChildren,Rr,gr,vr,Ir,Mr,Ar),(Dt.key!=null||vr&&Dt===vr.subTree)&&traverseStaticChildren(kt,Dt,!0)):er(kt,Dt,gr,Or,vr,Ir,Mr,Ar,Fr)},Ue=(kt,Dt,gr,yr,vr,Ir,Mr,Ar,Fr)=>{Dt.slotScopeIds=Ar,kt==null?Dt.shapeFlag&512?vr.ctx.activate(Dt,gr,yr,Mr,Fr):qe(Dt,gr,yr,vr,Ir,Mr,Fr):Oe(kt,Dt,Fr)},qe=(kt,Dt,gr,yr,vr,Ir,Mr)=>{const Ar=kt.component=createComponentInstance(kt,yr,vr);if(isKeepAlive(kt)&&(Ar.ctx.renderer=mr),setupComponent(Ar),Ar.asyncDep){if(vr&&vr.registerDep(Ar,$e),!kt.el){const Fr=Ar.subTree=createVNode(Comment);v(null,Fr,Dt,gr)}}else $e(Ar,kt,Dt,gr,vr,Ir,Mr)},Oe=(kt,Dt,gr)=>{const yr=Dt.component=kt.component;if(shouldUpdateComponent(kt,Dt,gr))if(yr.asyncDep&&!yr.asyncResolved){_e(yr,Dt,gr);return}else yr.next=Dt,invalidateJob(yr.update),yr.effect.dirty=!0,yr.update();else Dt.el=kt.el,yr.vnode=Dt},$e=(kt,Dt,gr,yr,vr,Ir,Mr)=>{const Ar=()=>{if(kt.isMounted){let{next:Or,bu:Sn,u:Rr,parent:Wr,vnode:Er}=kt;{const Zn=locateNonHydratedAsyncRoot(kt);if(Zn){Or&&(Or.el=Er.el,_e(kt,Or,Mr)),Zn.asyncDep.then(()=>{kt.isUnmounted||Ar()});return}}let Ur=Or,Zr;toggleRecurse(kt,!1),Or?(Or.el=Er.el,_e(kt,Or,Mr)):Or=Er,Sn&&invokeArrayFns(Sn),(Zr=Or.props&&Or.props.onVnodeBeforeUpdate)&&invokeVNodeHook(Zr,Wr,Or,Er),toggleRecurse(kt,!0);const In=renderComponentRoot(kt),An=kt.subTree;kt.subTree=In,k(An,In,m(An.el),dr(An),kt,vr,Ir),Or.el=In.el,Ur===null&&updateHOCHostEl(kt,In.el),Rr&&queuePostRenderEffect(Rr,vr),(Zr=Or.props&&Or.props.onVnodeUpdated)&&queuePostRenderEffect(()=>invokeVNodeHook(Zr,Wr,Or,Er),vr)}else{let Or;const{el:Sn,props:Rr}=Dt,{bm:Wr,m:Er,parent:Ur}=kt,Zr=isAsyncWrapper(Dt);if(toggleRecurse(kt,!1),Wr&&invokeArrayFns(Wr),!Zr&&(Or=Rr&&Rr.onVnodeBeforeMount)&&invokeVNodeHook(Or,Ur,Dt),toggleRecurse(kt,!0),Sn&&At){const In=()=>{kt.subTree=renderComponentRoot(kt),At(Sn,kt.subTree,kt,vr,null)};Zr?Dt.type.__asyncLoader().then(()=>!kt.isUnmounted&&In()):In()}else{const In=kt.subTree=renderComponentRoot(kt);k(null,In,gr,yr,kt,vr,Ir),Dt.el=In.el}if(Er&&queuePostRenderEffect(Er,vr),!Zr&&(Or=Rr&&Rr.onVnodeMounted)){const In=Dt;queuePostRenderEffect(()=>invokeVNodeHook(Or,Ur,In),vr)}(Dt.shapeFlag&256||Ur&&isAsyncWrapper(Ur.vnode)&&Ur.vnode.shapeFlag&256)&&kt.a&&queuePostRenderEffect(kt.a,vr),kt.isMounted=!0,Dt=gr=yr=null}},Fr=kt.effect=new ReactiveEffect(Ar,NOOP,()=>queueJob(Dr),kt.scope),Dr=kt.update=()=>{Fr.dirty&&Fr.run()};Dr.id=kt.uid,toggleRecurse(kt,!0),Dr()},_e=(kt,Dt,gr)=>{Dt.component=kt;const yr=kt.vnode.props;kt.vnode=Dt,kt.next=null,updateProps(kt,Dt.props,yr,gr),updateSlots(kt,Dt.children,gr),pauseTracking(),flushPreFlushCbs(kt),resetTracking()},er=(kt,Dt,gr,yr,vr,Ir,Mr,Ar,Fr=!1)=>{const Dr=kt&&kt.children,Or=kt?kt.shapeFlag:0,Sn=Dt.children,{patchFlag:Rr,shapeFlag:Wr}=Dt;if(Rr>0){if(Rr&128){ar(Dr,Sn,gr,yr,vr,Ir,Mr,Ar,Fr);return}else if(Rr&256){Pt(Dr,Sn,gr,yr,vr,Ir,Mr,Ar,Fr);return}}Wr&8?(Or&16&&ir(Dr,vr,Ir),Sn!==Dr&&u(gr,Sn)):Or&16?Wr&16?ar(Dr,Sn,gr,yr,vr,Ir,Mr,Ar,Fr):ir(Dr,vr,Ir,!0):(Or&8&&u(gr,""),Wr&16&&Ie(Sn,gr,yr,vr,Ir,Mr,Ar,Fr))},Pt=(kt,Dt,gr,yr,vr,Ir,Mr,Ar,Fr)=>{kt=kt||EMPTY_ARR,Dt=Dt||EMPTY_ARR;const Dr=kt.length,Or=Dt.length,Sn=Math.min(Dr,Or);let Rr;for(Rr=0;Rr<Sn;Rr++){const Wr=Dt[Rr]=Fr?cloneIfMounted(Dt[Rr]):normalizeVNode(Dt[Rr]);k(kt[Rr],Wr,gr,null,vr,Ir,Mr,Ar,Fr)}Dr>Or?ir(kt,vr,Ir,!0,!1,Sn):Ie(Dt,gr,yr,vr,Ir,Mr,Ar,Fr,Sn)},ar=(kt,Dt,gr,yr,vr,Ir,Mr,Ar,Fr)=>{let Dr=0;const Or=Dt.length;let Sn=kt.length-1,Rr=Or-1;for(;Dr<=Sn&&Dr<=Rr;){const Wr=kt[Dr],Er=Dt[Dr]=Fr?cloneIfMounted(Dt[Dr]):normalizeVNode(Dt[Dr]);if(isSameVNodeType(Wr,Er))k(Wr,Er,gr,null,vr,Ir,Mr,Ar,Fr);else break;Dr++}for(;Dr<=Sn&&Dr<=Rr;){const Wr=kt[Sn],Er=Dt[Rr]=Fr?cloneIfMounted(Dt[Rr]):normalizeVNode(Dt[Rr]);if(isSameVNodeType(Wr,Er))k(Wr,Er,gr,null,vr,Ir,Mr,Ar,Fr);else break;Sn--,Rr--}if(Dr>Sn){if(Dr<=Rr){const Wr=Rr+1,Er=Wr<Or?Dt[Wr].el:yr;for(;Dr<=Rr;)k(null,Dt[Dr]=Fr?cloneIfMounted(Dt[Dr]):normalizeVNode(Dt[Dr]),gr,Er,vr,Ir,Mr,Ar,Fr),Dr++}}else if(Dr>Rr)for(;Dr<=Sn;)lr(kt[Dr],vr,Ir,!0),Dr++;else{const Wr=Dr,Er=Dr,Ur=new Map;for(Dr=Er;Dr<=Rr;Dr++){const Ki=Dt[Dr]=Fr?cloneIfMounted(Dt[Dr]):normalizeVNode(Dt[Dr]);Ki.key!=null&&Ur.set(Ki.key,Dr)}let Zr,In=0;const An=Rr-Er+1;let Zn=!1,Nn=0;const Gi=new Array(An);for(Dr=0;Dr<An;Dr++)Gi[Dr]=0;for(Dr=Wr;Dr<=Sn;Dr++){const Ki=kt[Dr];if(In>=An){lr(Ki,vr,Ir,!0);continue}let yi;if(Ki.key!=null)yi=Ur.get(Ki.key);else for(Zr=Er;Zr<=Rr;Zr++)if(Gi[Zr-Er]===0&&isSameVNodeType(Ki,Dt[Zr])){yi=Zr;break}yi===void 0?lr(Ki,vr,Ir,!0):(Gi[yi-Er]=Dr+1,yi>=Nn?Nn=yi:Zn=!0,k(Ki,Dt[yi],gr,null,vr,Ir,Mr,Ar,Fr),In++)}const Iu=Zn?getSequence(Gi):EMPTY_ARR;for(Zr=Iu.length-1,Dr=An-1;Dr>=0;Dr--){const Ki=Er+Dr,yi=Dt[Ki],Ro=Ki+1<Or?Dt[Ki+1].el:yr;Gi[Dr]===0?k(null,yi,gr,Ro,vr,Ir,Mr,Ar,Fr):Zn&&(Zr<0||Dr!==Iu[Zr]?pr(yi,gr,Ro,2):Zr--)}}},pr=(kt,Dt,gr,yr,vr=null)=>{const{el:Ir,type:Mr,transition:Ar,children:Fr,shapeFlag:Dr}=kt;if(Dr&6){pr(kt.component.subTree,Dt,gr,yr);return}if(Dr&128){kt.suspense.move(Dt,gr,yr);return}if(Dr&64){Mr.move(kt,Dt,gr,mr);return}if(Mr===Fragment){r(Ir,Dt,gr);for(let Sn=0;Sn<Fr.length;Sn++)pr(Fr[Sn],Dt,gr,yr);r(kt.anchor,Dt,gr);return}if(Mr===Static){L(kt,Dt,gr);return}if(yr!==2&&Dr&1&&Ar)if(yr===0)Ar.beforeEnter(Ir),r(Ir,Dt,gr),queuePostRenderEffect(()=>Ar.enter(Ir),vr);else{const{leave:Sn,delayLeave:Rr,afterLeave:Wr}=Ar,Er=()=>r(Ir,Dt,gr),Ur=()=>{Sn(Ir,()=>{Er(),Wr&&Wr()})};Rr?Rr(Ir,Er,Ur):Ur()}else r(Ir,Dt,gr)},lr=(kt,Dt,gr,yr=!1,vr=!1)=>{const{type:Ir,props:Mr,ref:Ar,children:Fr,dynamicChildren:Dr,shapeFlag:Or,patchFlag:Sn,dirs:Rr}=kt;if(Ar!=null&&setRef(Ar,null,gr,kt,!0),Or&256){Dt.ctx.deactivate(kt);return}const Wr=Or&1&&Rr,Er=!isAsyncWrapper(kt);let Ur;if(Er&&(Ur=Mr&&Mr.onVnodeBeforeUnmount)&&invokeVNodeHook(Ur,Dt,kt),Or&6)nr(kt.component,gr,yr);else{if(Or&128){kt.suspense.unmount(gr,yr);return}Wr&&invokeDirectiveHook(kt,null,Dt,"beforeUnmount"),Or&64?kt.type.remove(kt,Dt,gr,vr,mr,yr):Dr&&(Ir!==Fragment||Sn>0&&Sn&64)?ir(Dr,Dt,gr,!1,!0):(Ir===Fragment&&Sn&384||!vr&&Or&16)&&ir(Fr,Dt,gr),yr&&or(kt)}(Er&&(Ur=Mr&&Mr.onVnodeUnmounted)||Wr)&&queuePostRenderEffect(()=>{Ur&&invokeVNodeHook(Ur,Dt,kt),Wr&&invokeDirectiveHook(kt,null,Dt,"unmounted")},gr)},or=kt=>{const{type:Dt,el:gr,anchor:yr,transition:vr}=kt;if(Dt===Fragment){xe(gr,yr);return}if(Dt===Static){re(kt);return}const Ir=()=>{s(gr),vr&&!vr.persisted&&vr.afterLeave&&vr.afterLeave()};if(kt.shapeFlag&1&&vr&&!vr.persisted){const{leave:Mr,delayLeave:Ar}=vr,Fr=()=>Mr(gr,Ir);Ar?Ar(kt.el,Ir,Fr):Fr()}else Ir()},xe=(kt,Dt)=>{let gr;for(;kt!==Dt;)gr=y(kt),s(kt),kt=gr;s(Dt)},nr=(kt,Dt,gr)=>{const{bum:yr,scope:vr,update:Ir,subTree:Mr,um:Ar}=kt;yr&&invokeArrayFns(yr),vr.stop(),Ir&&(Ir.active=!1,lr(Mr,kt,Dt,gr)),Ar&&queuePostRenderEffect(Ar,Dt),queuePostRenderEffect(()=>{kt.isUnmounted=!0},Dt),Dt&&Dt.pendingBranch&&!Dt.isUnmounted&&kt.asyncDep&&!kt.asyncResolved&&kt.suspenseId===Dt.pendingId&&(Dt.deps--,Dt.deps===0&&Dt.resolve())},ir=(kt,Dt,gr,yr=!1,vr=!1,Ir=0)=>{for(let Mr=Ir;Mr<kt.length;Mr++)lr(kt[Mr],Dt,gr,yr,vr)},dr=kt=>kt.shapeFlag&6?dr(kt.component.subTree):kt.shapeFlag&128?kt.suspense.next():y(kt.anchor||kt.el);let Lt=!1;const cr=(kt,Dt,gr)=>{kt==null?Dt._vnode&&lr(Dt._vnode,null,null,!0):k(Dt._vnode||null,kt,Dt,null,null,null,gr),Lt||(Lt=!0,flushPreFlushCbs(),flushPostFlushCbs(),Lt=!1),Dt._vnode=kt},mr={p:k,um:lr,m:pr,r:or,mt:qe,mc:Ie,pc:er,pbc:Ne,n:dr,o:t};let tr,At;return n&&([tr,At]=n(mr)),{render:cr,hydrate:tr,createApp:createAppAPI(cr,tr)}}function resolveChildrenNamespace({type:t,props:n},e){return e==="svg"&&t==="foreignObject"||e==="mathml"&&t==="annotation-xml"&&n&&n.encoding&&n.encoding.includes("html")?void 0:e}function toggleRecurse({effect:t,update:n},e){t.allowRecurse=n.allowRecurse=e}function needTransition(t,n){return(!t||t&&!t.pendingBranch)&&n&&!n.persisted}function traverseStaticChildren(t,n,e=!1){const r=t.children,s=n.children;if(isArray$3(r)&&isArray$3(s))for(let i=0;i<r.length;i++){const o=r[i];let a=s[i];a.shapeFlag&1&&!a.dynamicChildren&&((a.patchFlag<=0||a.patchFlag===32)&&(a=s[i]=cloneIfMounted(s[i]),a.el=o.el),e||traverseStaticChildren(o,a)),a.type===Text&&(a.el=o.el)}}function getSequence(t){const n=t.slice(),e=[0];let r,s,i,o,a;const d=t.length;for(r=0;r<d;r++){const c=t[r];if(c!==0){if(s=e[e.length-1],t[s]<c){n[r]=s,e.push(r);continue}for(i=0,o=e.length-1;i<o;)a=i+o>>1,t[e[a]]<c?i=a+1:o=a;c<t[e[i]]&&(i>0&&(n[r]=e[i-1]),e[i]=r)}}for(i=e.length,o=e[i-1];i-- >0;)e[i]=o,o=n[o];return e}function locateNonHydratedAsyncRoot(t){const n=t.subTree.component;if(n)return n.asyncDep&&!n.asyncResolved?n:locateNonHydratedAsyncRoot(n)}const isTeleport=t=>t.__isTeleport,isTeleportDisabled=t=>t&&(t.disabled||t.disabled===""),isTargetSVG=t=>typeof SVGElement<"u"&&t instanceof SVGElement,isTargetMathML=t=>typeof MathMLElement=="function"&&t instanceof MathMLElement,resolveTarget=(t,n)=>{const e=t&&t.to;return isString$2(e)?n?n(e):null:e},TeleportImpl={name:"Teleport",__isTeleport:!0,process(t,n,e,r,s,i,o,a,d,c){const{mc:u,pc:m,pbc:y,o:{insert:S,querySelector:O,createText:k,createComment:g}}=c,v=isTeleportDisabled(n.props);let{shapeFlag:ue,children:L,dynamicChildren:re}=n;if(t==null){const le=n.el=k(""),oe=n.anchor=k("");S(le,e,r),S(oe,e,r);const he=n.target=resolveTarget(n.props,O),Ie=n.targetAnchor=k("");he&&(S(Ie,he),o==="svg"||isTargetSVG(he)?o="svg":(o==="mathml"||isTargetMathML(he))&&(o="mathml"));const ie=(Ne,Ve)=>{ue&16&&u(L,Ne,Ve,s,i,o,a,d)};v?ie(e,oe):he&&ie(he,Ie)}else{n.el=t.el;const le=n.anchor=t.anchor,oe=n.target=t.target,he=n.targetAnchor=t.targetAnchor,Ie=isTeleportDisabled(t.props),ie=Ie?e:oe,Ne=Ie?le:he;if(o==="svg"||isTargetSVG(oe)?o="svg":(o==="mathml"||isTargetMathML(oe))&&(o="mathml"),re?(y(t.dynamicChildren,re,ie,s,i,o,a),traverseStaticChildren(t,n,!0)):d||m(t,n,ie,Ne,s,i,o,a,!1),v)Ie?n.props&&t.props&&n.props.to!==t.props.to&&(n.props.to=t.props.to):moveTeleport(n,e,le,c,1);else if((n.props&&n.props.to)!==(t.props&&t.props.to)){const Ve=n.target=resolveTarget(n.props,O);Ve&&moveTeleport(n,Ve,null,c,0)}else Ie&&moveTeleport(n,oe,he,c,1)}updateCssVars(n)},remove(t,n,e,r,{um:s,o:{remove:i}},o){const{shapeFlag:a,children:d,anchor:c,targetAnchor:u,target:m,props:y}=t;if(m&&i(u),o&&i(c),a&16){const S=o||!isTeleportDisabled(y);for(let O=0;O<d.length;O++){const k=d[O];s(k,n,e,S,!!k.dynamicChildren)}}},move:moveTeleport,hydrate:hydrateTeleport};function moveTeleport(t,n,e,{o:{insert:r},m:s},i=2){i===0&&r(t.targetAnchor,n,e);const{el:o,anchor:a,shapeFlag:d,children:c,props:u}=t,m=i===2;if(m&&r(o,n,e),(!m||isTeleportDisabled(u))&&d&16)for(let y=0;y<c.length;y++)s(c[y],n,e,2);m&&r(a,n,e)}function hydrateTeleport(t,n,e,r,s,i,{o:{nextSibling:o,parentNode:a,querySelector:d}},c){const u=n.target=resolveTarget(n.props,d);if(u){const m=u._lpa||u.firstChild;if(n.shapeFlag&16)if(isTeleportDisabled(n.props))n.anchor=c(o(t),n,a(t),e,r,s,i),n.targetAnchor=m;else{n.anchor=o(t);let y=m;for(;y;)if(y=o(y),y&&y.nodeType===8&&y.data==="teleport anchor"){n.targetAnchor=y,u._lpa=n.targetAnchor&&o(n.targetAnchor);break}c(m,n,u,e,r,s,i)}updateCssVars(n)}return n.anchor&&o(n.anchor)}const Teleport=TeleportImpl;function updateCssVars(t){const n=t.ctx;if(n&&n.ut){let e=t.children[0].el;for(;e&&e!==t.targetAnchor;)e.nodeType===1&&e.setAttribute("data-v-owner",n.uid),e=e.nextSibling;n.ut()}}const Fragment=Symbol.for("v-fgt"),Text=Symbol.for("v-txt"),Comment=Symbol.for("v-cmt"),Static=Symbol.for("v-stc"),blockStack=[];let currentBlock=null;function openBlock(t=!1){blockStack.push(currentBlock=t?null:[])}function closeBlock(){blockStack.pop(),currentBlock=blockStack[blockStack.length-1]||null}let isBlockTreeEnabled=1;function setBlockTracking(t){isBlockTreeEnabled+=t}function setupBlock(t){return t.dynamicChildren=isBlockTreeEnabled>0?currentBlock||EMPTY_ARR:null,closeBlock(),isBlockTreeEnabled>0&&currentBlock&&currentBlock.push(t),t}function createElementBlock(t,n,e,r,s,i){return setupBlock(createBaseVNode(t,n,e,r,s,i,!0))}function createBlock(t,n,e,r,s){return setupBlock(createVNode(t,n,e,r,s,!0))}function isVNode(t){return t?t.__v_isVNode===!0:!1}function isSameVNodeType(t,n){return t.type===n.type&&t.key===n.key}const InternalObjectKey="__vInternal",normalizeKey=({key:t})=>t??null,normalizeRef=({ref:t,ref_key:n,ref_for:e})=>(typeof t=="number"&&(t=""+t),t!=null?isString$2(t)||isRef(t)||isFunction$2(t)?{i:currentRenderingInstance,r:t,k:n,f:!!e}:t:null);function createBaseVNode(t,n=null,e=null,r=0,s=null,i=t===Fragment?0:1,o=!1,a=!1){const d={__v_isVNode:!0,__v_skip:!0,type:t,props:n,key:n&&normalizeKey(n),ref:n&&normalizeRef(n),scopeId:currentScopeId,slotScopeIds:null,children:e,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetAnchor:null,staticCount:0,shapeFlag:i,patchFlag:r,dynamicProps:s,dynamicChildren:null,appContext:null,ctx:currentRenderingInstance};return a?(normalizeChildren(d,e),i&128&&t.normalize(d)):e&&(d.shapeFlag|=isString$2(e)?8:16),isBlockTreeEnabled>0&&!o&&currentBlock&&(d.patchFlag>0||i&6)&&d.patchFlag!==32&&currentBlock.push(d),d}const createVNode=_createVNode;function _createVNode(t,n=null,e=null,r=0,s=null,i=!1){if((!t||t===NULL_DYNAMIC_COMPONENT)&&(t=Comment),isVNode(t)){const a=cloneVNode(t,n,!0);return e&&normalizeChildren(a,e),isBlockTreeEnabled>0&&!i&&currentBlock&&(a.shapeFlag&6?currentBlock[currentBlock.indexOf(t)]=a:currentBlock.push(a)),a.patchFlag|=-2,a}if(isClassComponent(t)&&(t=t.__vccOpts),n){n=guardReactiveProps(n);let{class:a,style:d}=n;a&&!isString$2(a)&&(n.class=normalizeClass(a)),isObject$2(d)&&(isProxy(d)&&!isArray$3(d)&&(d=extend$1({},d)),n.style=normalizeStyle(d))}const o=isString$2(t)?1:isSuspense(t)?128:isTeleport(t)?64:isObject$2(t)?4:isFunction$2(t)?2:0;return createBaseVNode(t,n,e,r,s,o,i,!0)}function guardReactiveProps(t){return t?isProxy(t)||InternalObjectKey in t?extend$1({},t):t:null}function cloneVNode(t,n,e=!1){const{props:r,ref:s,patchFlag:i,children:o}=t,a=n?mergeProps(r||{},n):r;return{__v_isVNode:!0,__v_skip:!0,type:t.type,props:a,key:a&&normalizeKey(a),ref:n&&n.ref?e&&s?isArray$3(s)?s.concat(normalizeRef(n)):[s,normalizeRef(n)]:normalizeRef(n):s,scopeId:t.scopeId,slotScopeIds:t.slotScopeIds,children:o,target:t.target,targetAnchor:t.targetAnchor,staticCount:t.staticCount,shapeFlag:t.shapeFlag,patchFlag:n&&t.type!==Fragment?i===-1?16:i|16:i,dynamicProps:t.dynamicProps,dynamicChildren:t.dynamicChildren,appContext:t.appContext,dirs:t.dirs,transition:t.transition,component:t.component,suspense:t.suspense,ssContent:t.ssContent&&cloneVNode(t.ssContent),ssFallback:t.ssFallback&&cloneVNode(t.ssFallback),el:t.el,anchor:t.anchor,ctx:t.ctx,ce:t.ce}}function createTextVNode(t=" ",n=0){return createVNode(Text,null,t,n)}function createCommentVNode(t="",n=!1){return n?(openBlock(),createBlock(Comment,null,t)):createVNode(Comment,null,t)}function normalizeVNode(t){return t==null||typeof t=="boolean"?createVNode(Comment):isArray$3(t)?createVNode(Fragment,null,t.slice()):typeof t=="object"?cloneIfMounted(t):createVNode(Text,null,String(t))}function cloneIfMounted(t){return t.el===null&&t.patchFlag!==-1||t.memo?t:cloneVNode(t)}function normalizeChildren(t,n){let e=0;const{shapeFlag:r}=t;if(n==null)n=null;else if(isArray$3(n))e=16;else if(typeof n=="object")if(r&65){const s=n.default;s&&(s._c&&(s._d=!1),normalizeChildren(t,s()),s._c&&(s._d=!0));return}else{e=32;const s=n._;!s&&!(InternalObjectKey in n)?n._ctx=currentRenderingInstance:s===3&&currentRenderingInstance&&(currentRenderingInstance.slots._===1?n._=1:(n._=2,t.patchFlag|=1024))}else isFunction$2(n)?(n={default:n,_ctx:currentRenderingInstance},e=32):(n=String(n),r&64?(e=16,n=[createTextVNode(n)]):e=8);t.children=n,t.shapeFlag|=e}function mergeProps(...t){const n={};for(let e=0;e<t.length;e++){const r=t[e];for(const s in r)if(s==="class")n.class!==r.class&&(n.class=normalizeClass([n.class,r.class]));else if(s==="style")n.style=normalizeStyle([n.style,r.style]);else if(isOn(s)){const i=n[s],o=r[s];o&&i!==o&&!(isArray$3(i)&&i.includes(o))&&(n[s]=i?[].concat(i,o):o)}else s!==""&&(n[s]=r[s])}return n}function invokeVNodeHook(t,n,e,r=null){callWithAsyncErrorHandling(t,n,7,[e,r])}const emptyAppContext=createAppContext();let uid=0;function createComponentInstance(t,n,e){const r=t.type,s=(n?n.appContext:t.appContext)||emptyAppContext,i={uid:uid++,vnode:t,type:r,parent:n,appContext:s,root:null,next:null,subTree:null,effect:null,update:null,scope:new EffectScope(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:n?n.provides:Object.create(s.provides),accessCache:null,renderCache:[],components:null,directives:null,propsOptions:normalizePropsOptions(r,s),emitsOptions:normalizeEmitsOptions(r,s),emit:null,emitted:null,propsDefaults:EMPTY_OBJ,inheritAttrs:r.inheritAttrs,ctx:EMPTY_OBJ,data:EMPTY_OBJ,props:EMPTY_OBJ,attrs:EMPTY_OBJ,slots:EMPTY_OBJ,refs:EMPTY_OBJ,setupState:EMPTY_OBJ,setupContext:null,attrsProxy:null,slotsProxy:null,suspense:e,suspenseId:e?e.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return i.ctx={_:i},i.root=n?n.root:i,i.emit=emit.bind(null,i),t.ce&&t.ce(i),i}let currentInstance=null;const getCurrentInstance=()=>currentInstance||currentRenderingInstance;let internalSetCurrentInstance,setInSSRSetupState;{const t=getGlobalThis(),n=(e,r)=>{let s;return(s=t[e])||(s=t[e]=[]),s.push(r),i=>{s.length>1?s.forEach(o=>o(i)):s[0](i)}};internalSetCurrentInstance=n("__VUE_INSTANCE_SETTERS__",e=>currentInstance=e),setInSSRSetupState=n("__VUE_SSR_SETTERS__",e=>isInSSRComponentSetup=e)}const setCurrentInstance=t=>{const n=currentInstance;return internalSetCurrentInstance(t),t.scope.on(),()=>{t.scope.off(),internalSetCurrentInstance(n)}},unsetCurrentInstance=()=>{currentInstance&&currentInstance.scope.off(),internalSetCurrentInstance(null)};function isStatefulComponent(t){return t.vnode.shapeFlag&4}let isInSSRComponentSetup=!1;function setupComponent(t,n=!1){n&&setInSSRSetupState(n);const{props:e,children:r}=t.vnode,s=isStatefulComponent(t);initProps(t,e,s,n),initSlots(t,r);const i=s?setupStatefulComponent(t,n):void 0;return n&&setInSSRSetupState(!1),i}function setupStatefulComponent(t,n){const e=t.type;t.accessCache=Object.create(null),t.proxy=markRaw(new Proxy(t.ctx,PublicInstanceProxyHandlers));const{setup:r}=e;if(r){const s=t.setupContext=r.length>1?createSetupContext(t):null,i=setCurrentInstance(t);pauseTracking();const o=callWithErrorHandling(r,t,0,[t.props,s]);if(resetTracking(),i(),isPromise(o)){if(o.then(unsetCurrentInstance,unsetCurrentInstance),n)return o.then(a=>{handleSetupResult(t,a,n)}).catch(a=>{handleError(a,t,0)});t.asyncDep=o}else handleSetupResult(t,o,n)}else finishComponentSetup(t,n)}function handleSetupResult(t,n,e){isFunction$2(n)?t.type.__ssrInlineRender?t.ssrRender=n:t.render=n:isObject$2(n)&&(t.setupState=proxyRefs(n)),finishComponentSetup(t,e)}let compile;function finishComponentSetup(t,n,e){const r=t.type;if(!t.render){if(!n&&compile&&!r.render){const s=r.template||resolveMergedOptions(t).template;if(s){const{isCustomElement:i,compilerOptions:o}=t.appContext.config,{delimiters:a,compilerOptions:d}=r,c=extend$1(extend$1({isCustomElement:i,delimiters:a},o),d);r.render=compile(s,c)}}t.render=r.render||NOOP}{const s=setCurrentInstance(t);pauseTracking();try{applyOptions(t)}finally{resetTracking(),s()}}}function getAttrsProxy(t){return t.attrsProxy||(t.attrsProxy=new Proxy(t.attrs,{get(n,e){return track(t,"get","$attrs"),n[e]}}))}function createSetupContext(t){const n=e=>{t.exposed=e||{}};return{get attrs(){return getAttrsProxy(t)},slots:t.slots,emit:t.emit,expose:n}}function getExposeProxy(t){if(t.exposed)return t.exposeProxy||(t.exposeProxy=new Proxy(proxyRefs(markRaw(t.exposed)),{get(n,e){if(e in n)return n[e];if(e in publicPropertiesMap)return publicPropertiesMap[e](t)},has(n,e){return e in n||e in publicPropertiesMap}}))}const classifyRE=/(?:^|[-_])(\w)/g,classify=t=>t.replace(classifyRE,n=>n.toUpperCase()).replace(/[-_]/g,"");function getComponentName(t,n=!0){return isFunction$2(t)?t.displayName||t.name:t.name||n&&t.__name}function formatComponentName(t,n,e=!1){let r=getComponentName(n);if(!r&&n.__file){const s=n.__file.match(/([^/\\]+)\.\w+$/);s&&(r=s[1])}if(!r&&t&&t.parent){const s=i=>{for(const o in i)if(i[o]===n)return o};r=s(t.components||t.parent.type.components)||s(t.appContext.components)}return r?classify(r):e?"App":"Anonymous"}function isClassComponent(t){return isFunction$2(t)&&"__vccOpts"in t}const computed=(t,n)=>computed$1(t,n,isInSSRComponentSetup);function h(t,n,e){const r=arguments.length;return r===2?isObject$2(n)&&!isArray$3(n)?isVNode(n)?createVNode(t,null,[n]):createVNode(t,n):createVNode(t,null,n):(r>3?e=Array.prototype.slice.call(arguments,2):r===3&&isVNode(e)&&(e=[e]),createVNode(t,n,e))}const version="3.4.20",warn=NOOP;/**
* @vue/runtime-dom v3.4.20
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/const svgNS="http://www.w3.org/2000/svg",mathmlNS="http://www.w3.org/1998/Math/MathML",doc=typeof document<"u"?document:null,templateContainer=doc&&doc.createElement("template"),nodeOps={insert:(t,n,e)=>{n.insertBefore(t,e||null)},remove:t=>{const n=t.parentNode;n&&n.removeChild(t)},createElement:(t,n,e,r)=>{const s=n==="svg"?doc.createElementNS(svgNS,t):n==="mathml"?doc.createElementNS(mathmlNS,t):doc.createElement(t,e?{is:e}:void 0);return t==="select"&&r&&r.multiple!=null&&s.setAttribute("multiple",r.multiple),s},createText:t=>doc.createTextNode(t),createComment:t=>doc.createComment(t),setText:(t,n)=>{t.nodeValue=n},setElementText:(t,n)=>{t.textContent=n},parentNode:t=>t.parentNode,nextSibling:t=>t.nextSibling,querySelector:t=>doc.querySelector(t),setScopeId(t,n){t.setAttribute(n,"")},insertStaticContent(t,n,e,r,s,i){const o=e?e.previousSibling:n.lastChild;if(s&&(s===i||s.nextSibling))for(;n.insertBefore(s.cloneNode(!0),e),!(s===i||!(s=s.nextSibling)););else{templateContainer.innerHTML=r==="svg"?`<svg>${t}</svg>`:r==="mathml"?`<math>${t}</math>`:t;const a=templateContainer.content;if(r==="svg"||r==="mathml"){const d=a.firstChild;for(;d.firstChild;)a.appendChild(d.firstChild);a.removeChild(d)}n.insertBefore(a,e)}return[o?o.nextSibling:n.firstChild,e?e.previousSibling:n.lastChild]}},TRANSITION="transition",ANIMATION="animation",vtcKey=Symbol("_vtc"),Transition=(t,{slots:n})=>h(BaseTransition,resolveTransitionProps(t),n);Transition.displayName="Transition";const DOMTransitionPropsValidators={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String};Transition.props=extend$1({},BaseTransitionPropsValidators,DOMTransitionPropsValidators);const callHook=(t,n=[])=>{isArray$3(t)?t.forEach(e=>e(...n)):t&&t(...n)},hasExplicitCallback=t=>t?isArray$3(t)?t.some(n=>n.length>1):t.length>1:!1;function resolveTransitionProps(t){const n={};for(const Ce in t)Ce in DOMTransitionPropsValidators||(n[Ce]=t[Ce]);if(t.css===!1)return n;const{name:e="v",type:r,duration:s,enterFromClass:i=`${e}-enter-from`,enterActiveClass:o=`${e}-enter-active`,enterToClass:a=`${e}-enter-to`,appearFromClass:d=i,appearActiveClass:c=o,appearToClass:u=a,leaveFromClass:m=`${e}-leave-from`,leaveActiveClass:y=`${e}-leave-active`,leaveToClass:S=`${e}-leave-to`}=t,O=normalizeDuration(s),k=O&&O[0],g=O&&O[1],{onBeforeEnter:v,onEnter:ue,onEnterCancelled:L,onLeave:re,onLeaveCancelled:le,onBeforeAppear:oe=v,onAppear:he=ue,onAppearCancelled:Ie=L}=n,ie=(Ce,Ue,qe)=>{removeTransitionClass(Ce,Ue?u:a),removeTransitionClass(Ce,Ue?c:o),qe&&qe()},Ne=(Ce,Ue)=>{Ce._isLeaving=!1,removeTransitionClass(Ce,m),removeTransitionClass(Ce,S),removeTransitionClass(Ce,y),Ue&&Ue()},Ve=Ce=>(Ue,qe)=>{const Oe=Ce?he:ue,$e=()=>ie(Ue,Ce,qe);callHook(Oe,[Ue,$e]),nextFrame(()=>{removeTransitionClass(Ue,Ce?d:i),addTransitionClass(Ue,Ce?u:a),hasExplicitCallback(Oe)||whenTransitionEnds(Ue,r,k,$e)})};return extend$1(n,{onBeforeEnter(Ce){callHook(v,[Ce]),addTransitionClass(Ce,i),addTransitionClass(Ce,o)},onBeforeAppear(Ce){callHook(oe,[Ce]),addTransitionClass(Ce,d),addTransitionClass(Ce,c)},onEnter:Ve(!1),onAppear:Ve(!0),onLeave(Ce,Ue){Ce._isLeaving=!0;const qe=()=>Ne(Ce,Ue);addTransitionClass(Ce,m),forceReflow(),addTransitionClass(Ce,y),nextFrame(()=>{Ce._isLeaving&&(removeTransitionClass(Ce,m),addTransitionClass(Ce,S),hasExplicitCallback(re)||whenTransitionEnds(Ce,r,g,qe))}),callHook(re,[Ce,qe])},onEnterCancelled(Ce){ie(Ce,!1),callHook(L,[Ce])},onAppearCancelled(Ce){ie(Ce,!0),callHook(Ie,[Ce])},onLeaveCancelled(Ce){Ne(Ce),callHook(le,[Ce])}})}function normalizeDuration(t){if(t==null)return null;if(isObject$2(t))return[NumberOf(t.enter),NumberOf(t.leave)];{const n=NumberOf(t);return[n,n]}}function NumberOf(t){return toNumber$1(t)}function addTransitionClass(t,n){n.split(/\s+/).forEach(e=>e&&t.classList.add(e)),(t[vtcKey]||(t[vtcKey]=new Set)).add(n)}function removeTransitionClass(t,n){n.split(/\s+/).forEach(r=>r&&t.classList.remove(r));const e=t[vtcKey];e&&(e.delete(n),e.size||(t[vtcKey]=void 0))}function nextFrame(t){requestAnimationFrame(()=>{requestAnimationFrame(t)})}let endId=0;function whenTransitionEnds(t,n,e,r){const s=t._endId=++endId,i=()=>{s===t._endId&&r()};if(e)return setTimeout(i,e);const{type:o,timeout:a,propCount:d}=getTransitionInfo(t,n);if(!o)return r();const c=o+"end";let u=0;const m=()=>{t.removeEventListener(c,y),i()},y=S=>{S.target===t&&++u>=d&&m()};setTimeout(()=>{u<d&&m()},a+1),t.addEventListener(c,y)}function getTransitionInfo(t,n){const e=window.getComputedStyle(t),r=O=>(e[O]||"").split(", "),s=r(`${TRANSITION}Delay`),i=r(`${TRANSITION}Duration`),o=getTimeout(s,i),a=r(`${ANIMATION}Delay`),d=r(`${ANIMATION}Duration`),c=getTimeout(a,d);let u=null,m=0,y=0;n===TRANSITION?o>0&&(u=TRANSITION,m=o,y=i.length):n===ANIMATION?c>0&&(u=ANIMATION,m=c,y=d.length):(m=Math.max(o,c),u=m>0?o>c?TRANSITION:ANIMATION:null,y=u?u===TRANSITION?i.length:d.length:0);const S=u===TRANSITION&&/\b(transform|all)(,|$)/.test(r(`${TRANSITION}Property`).toString());return{type:u,timeout:m,propCount:y,hasTransform:S}}function getTimeout(t,n){for(;t.length<n.length;)t=t.concat(t);return Math.max(...n.map((e,r)=>toMs(e)+toMs(t[r])))}function toMs(t){return t==="auto"?0:Number(t.slice(0,-1).replace(",","."))*1e3}function forceReflow(){return document.body.offsetHeight}function patchClass(t,n,e){const r=t[vtcKey];r&&(n=(n?[n,...r]:[...r]).join(" ")),n==null?t.removeAttribute("class"):e?t.setAttribute("class",n):t.className=n}const vShowOriginalDisplay=Symbol("_vod"),vShowHidden=Symbol("_vsh"),vShow={beforeMount(t,{value:n},{transition:e}){t[vShowOriginalDisplay]=t.style.display==="none"?"":t.style.display,e&&n?e.beforeEnter(t):setDisplay(t,n)},mounted(t,{value:n},{transition:e}){e&&n&&e.enter(t)},updated(t,{value:n,oldValue:e},{transition:r}){!n!=!e&&(r?n?(r.beforeEnter(t),setDisplay(t,!0),r.enter(t)):r.leave(t,()=>{setDisplay(t,!1)}):setDisplay(t,n))},beforeUnmount(t,{value:n}){setDisplay(t,n)}};function setDisplay(t,n){t.style.display=n?t[vShowOriginalDisplay]:"none",t[vShowHidden]=!n}const CSS_VAR_TEXT=Symbol(""),displayRE=/(^|;)\s*display\s*:/;function patchStyle(t,n,e){const r=t.style,s=isString$2(e);let i=!1;if(e&&!s){if(n)if(isString$2(n))for(const o of n.split(";")){const a=o.slice(0,o.indexOf(":")).trim();e[a]==null&&setStyle(r,a,"")}else for(const o in n)e[o]==null&&setStyle(r,o,"");for(const o in e)o==="display"&&(i=!0),setStyle(r,o,e[o])}else if(s){if(n!==e){const o=r[CSS_VAR_TEXT];o&&(e+=";"+o),r.cssText=e,i=displayRE.test(e)}}else n&&t.removeAttribute("style");vShowOriginalDisplay in t&&(t[vShowOriginalDisplay]=i?r.display:"",t[vShowHidden]&&(r.display="none"))}const importantRE=/\s*!important$/;function setStyle(t,n,e){if(isArray$3(e))e.forEach(r=>setStyle(t,n,r));else if(e==null&&(e=""),n.startsWith("--"))t.setProperty(n,e);else{const r=autoPrefix(t,n);importantRE.test(e)?t.setProperty(hyphenate(r),e.replace(importantRE,""),"important"):t[r]=e}}const prefixes=["Webkit","Moz","ms"],prefixCache={};function autoPrefix(t,n){const e=prefixCache[n];if(e)return e;let r=camelize(n);if(r!=="filter"&&r in t)return prefixCache[n]=r;r=capitalize(r);for(let s=0;s<prefixes.length;s++){const i=prefixes[s]+r;if(i in t)return prefixCache[n]=i}return n}const xlinkNS="http://www.w3.org/1999/xlink";function patchAttr(t,n,e,r,s){if(r&&n.startsWith("xlink:"))e==null?t.removeAttributeNS(xlinkNS,n.slice(6,n.length)):t.setAttributeNS(xlinkNS,n,e);else{const i=isSpecialBooleanAttr(n);e==null||i&&!includeBooleanAttr(e)?t.removeAttribute(n):t.setAttribute(n,i?"":e)}}function patchDOMProp(t,n,e,r,s,i,o){if(n==="innerHTML"||n==="textContent"){r&&o(r,s,i),t[n]=e??"";return}const a=t.tagName;if(n==="value"&&a!=="PROGRESS"&&!a.includes("-")){t._value=e;const c=a==="OPTION"?t.getAttribute("value")||"":t.value,u=e??"";c!==u&&(t.value=u),e==null&&t.removeAttribute(n);return}let d=!1;if(e===""||e==null){const c=typeof t[n];c==="boolean"?e=includeBooleanAttr(e):e==null&&c==="string"?(e="",d=!0):c==="number"&&(e=0,d=!0)}try{t[n]=e}catch{}d&&t.removeAttribute(n)}function addEventListener(t,n,e,r){t.addEventListener(n,e,r)}function removeEventListener(t,n,e,r){t.removeEventListener(n,e,r)}const veiKey=Symbol("_vei");function patchEvent(t,n,e,r,s=null){const i=t[veiKey]||(t[veiKey]={}),o=i[n];if(r&&o)o.value=r;else{const[a,d]=parseName(n);if(r){const c=i[n]=createInvoker(r,s);addEventListener(t,a,c,d)}else o&&(removeEventListener(t,a,o,d),i[n]=void 0)}}const optionsModifierRE=/(?:Once|Passive|Capture)$/;function parseName(t){let n;if(optionsModifierRE.test(t)){n={};let r;for(;r=t.match(optionsModifierRE);)t=t.slice(0,t.length-r[0].length),n[r[0].toLowerCase()]=!0}return[t[2]===":"?t.slice(3):hyphenate(t.slice(2)),n]}let cachedNow=0;const p=Promise.resolve(),getNow=()=>cachedNow||(p.then(()=>cachedNow=0),cachedNow=Date.now());function createInvoker(t,n){const e=r=>{if(!r._vts)r._vts=Date.now();else if(r._vts<=e.attached)return;callWithAsyncErrorHandling(patchStopImmediatePropagation(r,e.value),n,5,[r])};return e.value=t,e.attached=getNow(),e}function patchStopImmediatePropagation(t,n){if(isArray$3(n)){const e=t.stopImmediatePropagation;return t.stopImmediatePropagation=()=>{e.call(t),t._stopped=!0},n.map(r=>s=>!s._stopped&&r&&r(s))}else return n}const isNativeOn=t=>t.charCodeAt(0)===111&&t.charCodeAt(1)===110&&t.charCodeAt(2)>96&&t.charCodeAt(2)<123,patchProp=(t,n,e,r,s,i,o,a,d)=>{const c=s==="svg";n==="class"?patchClass(t,r,c):n==="style"?patchStyle(t,e,r):isOn(n)?isModelListener(n)||patchEvent(t,n,e,r,o):(n[0]==="."?(n=n.slice(1),!0):n[0]==="^"?(n=n.slice(1),!1):shouldSetAsProp(t,n,r,c))?patchDOMProp(t,n,r,i,o,a,d):(n==="true-value"?t._trueValue=r:n==="false-value"&&(t._falseValue=r),patchAttr(t,n,r,c))};function shouldSetAsProp(t,n,e,r){if(r)return!!(n==="innerHTML"||n==="textContent"||n in t&&isNativeOn(n)&&isFunction$2(e));if(n==="spellcheck"||n==="draggable"||n==="translate"||n==="form"||n==="list"&&t.tagName==="INPUT"||n==="type"&&t.tagName==="TEXTAREA")return!1;if(n==="width"||n==="height"){const s=t.tagName;if(s==="IMG"||s==="VIDEO"||s==="CANVAS"||s==="SOURCE")return!1}return isNativeOn(n)&&isString$2(e)?!1:n in t}const systemModifiers=["ctrl","shift","alt","meta"],modifierGuards={stop:t=>t.stopPropagation(),prevent:t=>t.preventDefault(),self:t=>t.target!==t.currentTarget,ctrl:t=>!t.ctrlKey,shift:t=>!t.shiftKey,alt:t=>!t.altKey,meta:t=>!t.metaKey,left:t=>"button"in t&&t.button!==0,middle:t=>"button"in t&&t.button!==1,right:t=>"button"in t&&t.button!==2,exact:(t,n)=>systemModifiers.some(e=>t[`${e}Key`]&&!n.includes(e))},withModifiers=(t,n)=>{const e=t._withMods||(t._withMods={}),r=n.join(".");return e[r]||(e[r]=(s,...i)=>{for(let o=0;o<n.length;o++){const a=modifierGuards[n[o]];if(a&&a(s,n))return}return t(s,...i)})},keyNames={esc:"escape",space:" ",up:"arrow-up",left:"arrow-left",right:"arrow-right",down:"arrow-down",delete:"backspace"},withKeys=(t,n)=>{const e=t._withKeys||(t._withKeys={}),r=n.join(".");return e[r]||(e[r]=s=>{if(!("key"in s))return;const i=hyphenate(s.key);if(n.some(o=>o===i||keyNames[o]===i))return t(s)})},rendererOptions=extend$1({patchProp},nodeOps);let renderer;function ensureRenderer(){return renderer||(renderer=createRenderer(rendererOptions))}const render=(...t)=>{ensureRenderer().render(...t)},createApp=(...t)=>{const n=ensureRenderer().createApp(...t),{mount:e}=n;return n.mount=r=>{const s=normalizeContainer(r);if(!s)return;const i=n._component;!isFunction$2(i)&&!i.render&&!i.template&&(i.template=s.innerHTML),s.innerHTML="";const o=e(s,!1,resolveRootNamespace(s));return s instanceof Element&&(s.removeAttribute("v-cloak"),s.setAttribute("data-v-app","")),o},n};function resolveRootNamespace(t){if(t instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&t instanceof MathMLElement)return"mathml"}function normalizeContainer(t){return isString$2(t)?document.querySelector(t):t}const FOCUSABLE_ELEMENT_SELECTORS='a[href],button:not([disabled]),button:not([hidden]),:not([tabindex="-1"]),input:not([disabled]),input:not([type="hidden"]),select:not([disabled]),textarea:not([disabled])',isVisible=t=>getComputedStyle(t).position==="fixed"?!1:t.offsetParent!==null,obtainAllFocusableElements$1=t=>Array.from(t.querySelectorAll(FOCUSABLE_ELEMENT_SELECTORS)).filter(n=>isFocusable(n)&&isVisible(n)),isFocusable=t=>{if(t.tabIndex>0||t.tabIndex===0&&t.getAttribute("tabIndex")!==null)return!0;if(t.disabled)return!1;switch(t.nodeName){case"A":return!!t.href&&t.rel!=="ignore";case"INPUT":return!(t.type==="hidden"||t.type==="file");case"BUTTON":case"SELECT":case"TEXTAREA":return!0;default:return!1}},composeEventHandlers=(t,n,{checkForDefaultPrevented:e=!0}={})=>s=>{const i=t==null?void 0:t(s);if(e===!1||!i)return n==null?void 0:n(s)},whenMouse=t=>n=>n.pointerType==="mouse"?t(n):void 0;var _a;const isClient=typeof window<"u",isString$1=t=>typeof t=="string",noop$1=()=>{},isIOS=isClient&&((_a=window==null?void 0:window.navigator)==null?void 0:_a.userAgent)&&/iP(ad|hone|od)/.test(window.navigator.userAgent);function resolveUnref(t){return typeof t=="function"?t():unref(t)}function createFilterWrapper(t,n){function e(...r){return new Promise((s,i)=>{Promise.resolve(t(()=>n.apply(this,r),{fn:n,thisArg:this,args:r})).then(s).catch(i)})}return e}function throttleFilter(t,n=!0,e=!0,r=!1){let s=0,i,o=!0,a=noop$1,d;const c=()=>{i&&(clearTimeout(i),i=void 0,a(),a=noop$1)};return m=>{const y=resolveUnref(t),S=Date.now()-s,O=()=>d=m();return c(),y<=0?(s=Date.now(),O()):(S>y&&(e||!o)?(s=Date.now(),O()):n&&(d=new Promise((k,g)=>{a=r?g:k,i=setTimeout(()=>{s=Date.now(),o=!0,k(O()),c()},Math.max(0,y-S))})),!e&&!i&&(i=setTimeout(()=>o=!0,y)),o=!1,d)}}function identity(t){return t}function tryOnScopeDispose(t){return getCurrentScope()?(onScopeDispose(t),!0):!1}function useThrottleFn(t,n=200,e=!1,r=!0,s=!1){return createFilterWrapper(throttleFilter(n,e,r,s),t)}function tryOnMounted(t,n=!0){getCurrentInstance()?onMounted(t):n?t():nextTick(t)}function useTimeoutFn(t,n,e={}){const{immediate:r=!0}=e,s=ref(!1);let i=null;function o(){i&&(clearTimeout(i),i=null)}function a(){s.value=!1,o()}function d(...c){o(),s.value=!0,i=setTimeout(()=>{s.value=!1,i=null,t(...c)},resolveUnref(n))}return r&&(s.value=!0,isClient&&d()),tryOnScopeDispose(a),{isPending:readonly(s),start:d,stop:a}}function unrefElement(t){var n;const e=resolveUnref(t);return(n=e==null?void 0:e.$el)!=null?n:e}const defaultWindow=isClient?window:void 0;function useEventListener(...t){let n,e,r,s;if(isString$1(t[0])||Array.isArray(t[0])?([e,r,s]=t,n=defaultWindow):[n,e,r,s]=t,!n)return noop$1;Array.isArray(e)||(e=[e]),Array.isArray(r)||(r=[r]);const i=[],o=()=>{i.forEach(u=>u()),i.length=0},a=(u,m,y,S)=>(u.addEventListener(m,y,S),()=>u.removeEventListener(m,y,S)),d=watch(()=>[unrefElement(n),resolveUnref(s)],([u,m])=>{o(),u&&i.push(...e.flatMap(y=>r.map(S=>a(u,y,S,m))))},{immediate:!0,flush:"post"}),c=()=>{d(),o()};return tryOnScopeDispose(c),c}let _iOSWorkaround=!1;function onClickOutside(t,n,e={}){const{window:r=defaultWindow,ignore:s=[],capture:i=!0,detectIframe:o=!1}=e;if(!r)return;isIOS&&!_iOSWorkaround&&(_iOSWorkaround=!0,Array.from(r.document.body.children).forEach(y=>y.addEventListener("click",noop$1)));let a=!0;const d=y=>s.some(S=>{if(typeof S=="string")return Array.from(r.document.querySelectorAll(S)).some(O=>O===y.target||y.composedPath().includes(O));{const O=unrefElement(S);return O&&(y.target===O||y.composedPath().includes(O))}}),u=[useEventListener(r,"click",y=>{const S=unrefElement(t);if(!(!S||S===y.target||y.composedPath().includes(S))){if(y.detail===0&&(a=!d(y)),!a){a=!0;return}n(y)}},{passive:!0,capture:i}),useEventListener(r,"pointerdown",y=>{const S=unrefElement(t);S&&(a=!y.composedPath().includes(S)&&!d(y))},{passive:!0}),o&&useEventListener(r,"blur",y=>{var S;const O=unrefElement(t);((S=r.document.activeElement)==null?void 0:S.tagName)==="IFRAME"&&!(O!=null&&O.contains(r.document.activeElement))&&n(y)})].filter(Boolean);return()=>u.forEach(y=>y())}function useSupported(t,n=!1){const e=ref(),r=()=>e.value=!!t();return r(),tryOnMounted(r,n),e}const _global$1=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},globalKey="__vueuse_ssr_handlers__";_global$1[globalKey]=_global$1[globalKey]||{};var __getOwnPropSymbols$g=Object.getOwnPropertySymbols,__hasOwnProp$g=Object.prototype.hasOwnProperty,__propIsEnum$g=Object.prototype.propertyIsEnumerable,__objRest$2=(t,n)=>{var e={};for(var r in t)__hasOwnProp$g.call(t,r)&&n.indexOf(r)<0&&(e[r]=t[r]);if(t!=null&&__getOwnPropSymbols$g)for(var r of __getOwnPropSymbols$g(t))n.indexOf(r)<0&&__propIsEnum$g.call(t,r)&&(e[r]=t[r]);return e};function useResizeObserver(t,n,e={}){const r=e,{window:s=defaultWindow}=r,i=__objRest$2(r,["window"]);let o;const a=useSupported(()=>s&&"ResizeObserver"in s),d=()=>{o&&(o.disconnect(),o=void 0)},c=watch(()=>unrefElement(t),m=>{d(),a.value&&s&&m&&(o=new ResizeObserver(n),o.observe(m,i))},{immediate:!0,flush:"post"}),u=()=>{d(),c()};return tryOnScopeDispose(u),{isSupported:a,stop:u}}var SwipeDirection;(function(t){t.UP="UP",t.RIGHT="RIGHT",t.DOWN="DOWN",t.LEFT="LEFT",t.NONE="NONE"})(SwipeDirection||(SwipeDirection={}));var __defProp=Object.defineProperty,__getOwnPropSymbols=Object.getOwnPropertySymbols,__hasOwnProp=Object.prototype.hasOwnProperty,__propIsEnum=Object.prototype.propertyIsEnumerable,__defNormalProp=(t,n,e)=>n in t?__defProp(t,n,{enumerable:!0,configurable:!0,writable:!0,value:e}):t[n]=e,__spreadValues=(t,n)=>{for(var e in n||(n={}))__hasOwnProp.call(n,e)&&__defNormalProp(t,e,n[e]);if(__getOwnPropSymbols)for(var e of __getOwnPropSymbols(n))__propIsEnum.call(n,e)&&__defNormalProp(t,e,n[e]);return t};const _TransitionPresets={easeInSine:[.12,0,.39,0],easeOutSine:[.61,1,.88,1],easeInOutSine:[.37,0,.63,1],easeInQuad:[.11,0,.5,0],easeOutQuad:[.5,1,.89,1],easeInOutQuad:[.45,0,.55,1],easeInCubic:[.32,0,.67,0],easeOutCubic:[.33,1,.68,1],easeInOutCubic:[.65,0,.35,1],easeInQuart:[.5,0,.75,0],easeOutQuart:[.25,1,.5,1],easeInOutQuart:[.76,0,.24,1],easeInQuint:[.64,0,.78,0],easeOutQuint:[.22,1,.36,1],easeInOutQuint:[.83,0,.17,1],easeInExpo:[.7,0,.84,0],easeOutExpo:[.16,1,.3,1],easeInOutExpo:[.87,0,.13,1],easeInCirc:[.55,0,1,.45],easeOutCirc:[0,.55,.45,1],easeInOutCirc:[.85,0,.15,1],easeInBack:[.36,0,.66,-.56],easeOutBack:[.34,1.56,.64,1],easeInOutBack:[.68,-.6,.32,1.6]};__spreadValues({linear:identity},_TransitionPresets);const isFirefox=()=>isClient&&/firefox/i.test(window.navigator.userAgent),isInContainer=(t,n)=>{if(!isClient||!t||!n)return!1;const e=t.getBoundingClientRect();let r;return n instanceof Element?r=n.getBoundingClientRect():r={top:0,right:window.innerWidth,bottom:window.innerHeight,left:0},e.top<r.bottom&&e.bottom>r.top&&e.right>r.left&&e.left<r.right};var freeGlobal=typeof global=="object"&&global&&global.Object===Object&&global;const freeGlobal$1=freeGlobal;var freeSelf=typeof self=="object"&&self&&self.Object===Object&&self,root=freeGlobal$1||freeSelf||Function("return this")();const root$1=root;var Symbol$1=root$1.Symbol;const Symbol$2=Symbol$1;var objectProto$4=Object.prototype,hasOwnProperty$4=objectProto$4.hasOwnProperty,nativeObjectToString$1=objectProto$4.toString,symToStringTag$1=Symbol$2?Symbol$2.toStringTag:void 0;function getRawTag(t){var n=hasOwnProperty$4.call(t,symToStringTag$1),e=t[symToStringTag$1];try{t[symToStringTag$1]=void 0;var r=!0}catch{}var s=nativeObjectToString$1.call(t);return r&&(n?t[symToStringTag$1]=e:delete t[symToStringTag$1]),s}var objectProto$3=Object.prototype,nativeObjectToString=objectProto$3.toString;function objectToString(t){return nativeObjectToString.call(t)}var nullTag="[object Null]",undefinedTag="[object Undefined]",symToStringTag=Symbol$2?Symbol$2.toStringTag:void 0;function baseGetTag(t){return t==null?t===void 0?undefinedTag:nullTag:symToStringTag&&symToStringTag in Object(t)?getRawTag(t):objectToString(t)}function isObjectLike(t){return t!=null&&typeof t=="object"}var symbolTag="[object Symbol]";function isSymbol(t){return typeof t=="symbol"||isObjectLike(t)&&baseGetTag(t)==symbolTag}function arrayMap(t,n){for(var e=-1,r=t==null?0:t.length,s=Array(r);++e<r;)s[e]=n(t[e],e,t);return s}var isArray$1=Array.isArray;const isArray$2=isArray$1;var INFINITY$1=1/0,symbolProto=Symbol$2?Symbol$2.prototype:void 0,symbolToString=symbolProto?symbolProto.toString:void 0;function baseToString(t){if(typeof t=="string")return t;if(isArray$2(t))return arrayMap(t,baseToString)+"";if(isSymbol(t))return symbolToString?symbolToString.call(t):"";var n=t+"";return n=="0"&&1/t==-INFINITY$1?"-0":n}var reWhitespace=/\s/;function trimmedEndIndex(t){for(var n=t.length;n--&&reWhitespace.test(t.charAt(n)););return n}var reTrimStart=/^\s+/;function baseTrim(t){return t&&t.slice(0,trimmedEndIndex(t)+1).replace(reTrimStart,"")}function isObject$1(t){var n=typeof t;return t!=null&&(n=="object"||n=="function")}var NAN=0/0,reIsBadHex=/^[-+]0x[0-9a-f]+$/i,reIsBinary=/^0b[01]+$/i,reIsOctal=/^0o[0-7]+$/i,freeParseInt=parseInt;function toNumber(t){if(typeof t=="number")return t;if(isSymbol(t))return NAN;if(isObject$1(t)){var n=typeof t.valueOf=="function"?t.valueOf():t;t=isObject$1(n)?n+"":n}if(typeof t!="string")return t===0?t:+t;t=baseTrim(t);var e=reIsBinary.test(t);return e||reIsOctal.test(t)?freeParseInt(t.slice(2),e?2:8):reIsBadHex.test(t)?NAN:+t}var asyncTag="[object AsyncFunction]",funcTag="[object Function]",genTag="[object GeneratorFunction]",proxyTag="[object Proxy]";function isFunction$1(t){if(!isObject$1(t))return!1;var n=baseGetTag(t);return n==funcTag||n==genTag||n==asyncTag||n==proxyTag}var coreJsData=root$1["__core-js_shared__"];const coreJsData$1=coreJsData;var maskSrcKey=function(){var t=/[^.]+$/.exec(coreJsData$1&&coreJsData$1.keys&&coreJsData$1.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}();function isMasked(t){return!!maskSrcKey&&maskSrcKey in t}var funcProto$1=Function.prototype,funcToString$1=funcProto$1.toString;function toSource(t){if(t!=null){try{return funcToString$1.call(t)}catch{}try{return t+""}catch{}}return""}var reRegExpChar=/[\\^$.*+?()[\]{}|]/g,reIsHostCtor=/^\[object .+?Constructor\]$/,funcProto=Function.prototype,objectProto$2=Object.prototype,funcToString=funcProto.toString,hasOwnProperty$3=objectProto$2.hasOwnProperty,reIsNative=RegExp("^"+funcToString.call(hasOwnProperty$3).replace(reRegExpChar,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function baseIsNative(t){if(!isObject$1(t)||isMasked(t))return!1;var n=isFunction$1(t)?reIsNative:reIsHostCtor;return n.test(toSource(t))}function getValue(t,n){return t==null?void 0:t[n]}function getNative(t,n){var e=getValue(t,n);return baseIsNative(e)?e:void 0}function eq(t,n){return t===n||t!==t&&n!==n}var reIsDeepProp=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,reIsPlainProp=/^\w*$/;function isKey(t,n){if(isArray$2(t))return!1;var e=typeof t;return e=="number"||e=="symbol"||e=="boolean"||t==null||isSymbol(t)?!0:reIsPlainProp.test(t)||!reIsDeepProp.test(t)||n!=null&&t in Object(n)}var nativeCreate=getNative(Object,"create");const nativeCreate$1=nativeCreate;function hashClear(){this.__data__=nativeCreate$1?nativeCreate$1(null):{},this.size=0}function hashDelete(t){var n=this.has(t)&&delete this.__data__[t];return this.size-=n?1:0,n}var HASH_UNDEFINED$1="__lodash_hash_undefined__",objectProto$1=Object.prototype,hasOwnProperty$2=objectProto$1.hasOwnProperty;function hashGet(t){var n=this.__data__;if(nativeCreate$1){var e=n[t];return e===HASH_UNDEFINED$1?void 0:e}return hasOwnProperty$2.call(n,t)?n[t]:void 0}var objectProto=Object.prototype,hasOwnProperty$1=objectProto.hasOwnProperty;function hashHas(t){var n=this.__data__;return nativeCreate$1?n[t]!==void 0:hasOwnProperty$1.call(n,t)}var HASH_UNDEFINED="__lodash_hash_undefined__";function hashSet(t,n){var e=this.__data__;return this.size+=this.has(t)?0:1,e[t]=nativeCreate$1&&n===void 0?HASH_UNDEFINED:n,this}function Hash(t){var n=-1,e=t==null?0:t.length;for(this.clear();++n<e;){var r=t[n];this.set(r[0],r[1])}}Hash.prototype.clear=hashClear;Hash.prototype.delete=hashDelete;Hash.prototype.get=hashGet;Hash.prototype.has=hashHas;Hash.prototype.set=hashSet;function listCacheClear(){this.__data__=[],this.size=0}function assocIndexOf(t,n){for(var e=t.length;e--;)if(eq(t[e][0],n))return e;return-1}var arrayProto=Array.prototype,splice=arrayProto.splice;function listCacheDelete(t){var n=this.__data__,e=assocIndexOf(n,t);if(e<0)return!1;var r=n.length-1;return e==r?n.pop():splice.call(n,e,1),--this.size,!0}function listCacheGet(t){var n=this.__data__,e=assocIndexOf(n,t);return e<0?void 0:n[e][1]}function listCacheHas(t){return assocIndexOf(this.__data__,t)>-1}function listCacheSet(t,n){var e=this.__data__,r=assocIndexOf(e,t);return r<0?(++this.size,e.push([t,n])):e[r][1]=n,this}function ListCache(t){var n=-1,e=t==null?0:t.length;for(this.clear();++n<e;){var r=t[n];this.set(r[0],r[1])}}ListCache.prototype.clear=listCacheClear;ListCache.prototype.delete=listCacheDelete;ListCache.prototype.get=listCacheGet;ListCache.prototype.has=listCacheHas;ListCache.prototype.set=listCacheSet;var Map$1=getNative(root$1,"Map");const Map$2=Map$1;function mapCacheClear(){this.size=0,this.__data__={hash:new Hash,map:new(Map$2||ListCache),string:new Hash}}function isKeyable(t){var n=typeof t;return n=="string"||n=="number"||n=="symbol"||n=="boolean"?t!=="__proto__":t===null}function getMapData(t,n){var e=t.__data__;return isKeyable(n)?e[typeof n=="string"?"string":"hash"]:e.map}function mapCacheDelete(t){var n=getMapData(this,t).delete(t);return this.size-=n?1:0,n}function mapCacheGet(t){return getMapData(this,t).get(t)}function mapCacheHas(t){return getMapData(this,t).has(t)}function mapCacheSet(t,n){var e=getMapData(this,t),r=e.size;return e.set(t,n),this.size+=e.size==r?0:1,this}function MapCache(t){var n=-1,e=t==null?0:t.length;for(this.clear();++n<e;){var r=t[n];this.set(r[0],r[1])}}MapCache.prototype.clear=mapCacheClear;MapCache.prototype.delete=mapCacheDelete;MapCache.prototype.get=mapCacheGet;MapCache.prototype.has=mapCacheHas;MapCache.prototype.set=mapCacheSet;var FUNC_ERROR_TEXT$2="Expected a function";function memoize(t,n){if(typeof t!="function"||n!=null&&typeof n!="function")throw new TypeError(FUNC_ERROR_TEXT$2);var e=function(){var r=arguments,s=n?n.apply(this,r):r[0],i=e.cache;if(i.has(s))return i.get(s);var o=t.apply(this,r);return e.cache=i.set(s,o)||i,o};return e.cache=new(memoize.Cache||MapCache),e}memoize.Cache=MapCache;var MAX_MEMOIZE_SIZE=500;function memoizeCapped(t){var n=memoize(t,function(r){return e.size===MAX_MEMOIZE_SIZE&&e.clear(),r}),e=n.cache;return n}var rePropName=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,reEscapeChar=/\\(\\)?/g,stringToPath=memoizeCapped(function(t){var n=[];return t.charCodeAt(0)===46&&n.push(""),t.replace(rePropName,function(e,r,s,i){n.push(s?i.replace(reEscapeChar,"$1"):r||e)}),n});const stringToPath$1=stringToPath;function toString$1(t){return t==null?"":baseToString(t)}function castPath(t,n){return isArray$2(t)?t:isKey(t,n)?[t]:stringToPath$1(toString$1(t))}var INFINITY=1/0;function toKey(t){if(typeof t=="string"||isSymbol(t))return t;var n=t+"";return n=="0"&&1/t==-INFINITY?"-0":n}function baseGet(t,n){n=castPath(n,t);for(var e=0,r=n.length;t!=null&&e<r;)t=t[toKey(n[e++])];return e&&e==r?t:void 0}function get(t,n,e){var r=t==null?void 0:baseGet(t,n);return r===void 0?e:r}function castArray(){if(!arguments.length)return[];var t=arguments[0];return isArray$2(t)?t:[t]}var now=function(){return root$1.Date.now()};const now$1=now;var FUNC_ERROR_TEXT$1="Expected a function",nativeMax=Math.max,nativeMin=Math.min;function debounce(t,n,e){var r,s,i,o,a,d,c=0,u=!1,m=!1,y=!0;if(typeof t!="function")throw new TypeError(FUNC_ERROR_TEXT$1);n=toNumber(n)||0,isObject$1(e)&&(u=!!e.leading,m="maxWait"in e,i=m?nativeMax(toNumber(e.maxWait)||0,n):i,y="trailing"in e?!!e.trailing:y);function S(oe){var he=r,Ie=s;return r=s=void 0,c=oe,o=t.apply(Ie,he),o}function O(oe){return c=oe,a=setTimeout(v,n),u?S(oe):o}function k(oe){var he=oe-d,Ie=oe-c,ie=n-he;return m?nativeMin(ie,i-Ie):ie}function g(oe){var he=oe-d,Ie=oe-c;return d===void 0||he>=n||he<0||m&&Ie>=i}function v(){var oe=now$1();if(g(oe))return ue(oe);a=setTimeout(v,k(oe))}function ue(oe){return a=void 0,y&&r?S(oe):(r=s=void 0,o)}function L(){a!==void 0&&clearTimeout(a),c=0,r=d=s=a=void 0}function re(){return a===void 0?o:ue(now$1())}function le(){var oe=now$1(),he=g(oe);if(r=arguments,s=this,d=oe,he){if(a===void 0)return O(d);if(m)return clearTimeout(a),a=setTimeout(v,n),S(d)}return a===void 0&&(a=setTimeout(v,n)),o}return le.cancel=L,le.flush=re,le}function fromPairs(t){for(var n=-1,e=t==null?0:t.length,r={};++n<e;){var s=t[n];r[s[0]]=s[1]}return r}function isNil(t){return t==null}function isUndefined$2(t){return t===void 0}var FUNC_ERROR_TEXT="Expected a function";function throttle(t,n,e){var r=!0,s=!0;if(typeof t!="function")throw new TypeError(FUNC_ERROR_TEXT);return isObject$1(e)&&(r="leading"in e?!!e.leading:r,s="trailing"in e?!!e.trailing:s),debounce(t,n,{leading:r,maxWait:n,trailing:s})}const isUndefined$1=t=>t===void 0,isBoolean$1=t=>typeof t=="boolean",isNumber$1=t=>typeof t=="number",isElement=t=>typeof Element>"u"?!1:t instanceof Element,isStringNumber=t=>isString$2(t)?!Number.isNaN(Number(t)):!1,keysOf=t=>Object.keys(t);class ElementPlusError extends Error{constructor(n){super(n),this.name="ElementPlusError"}}function throwError(t,n){throw new ElementPlusError(`[${t}] ${n}`)}function debugWarn(t,n){}const classNameToArray=(t="")=>t.split(" ").filter(n=>!!n.trim()),hasClass=(t,n)=>{if(!t||!n)return!1;if(n.includes(" "))throw new Error("className should not contain space.");return t.classList.contains(n)},addClass=(t,n)=>{!t||!n.trim()||t.classList.add(...classNameToArray(n))},removeClass=(t,n)=>{!t||!n.trim()||t.classList.remove(...classNameToArray(n))},getStyle=(t,n)=>{var e;if(!isClient||!t||!n)return"";let r=camelize(n);r==="float"&&(r="cssFloat");try{const s=t.style[r];if(s)return s;const i=(e=document.defaultView)==null?void 0:e.getComputedStyle(t,"");return i?i[r]:""}catch{return t.style[r]}};function addUnit(t,n="px"){if(!t)return"";if(isNumber$1(t)||isStringNumber(t))return`${t}${n}`;if(isString$2(t))return t}const isScroll=(t,n)=>{if(!isClient)return!1;const e={undefined:"overflow",true:"overflow-y",false:"overflow-x"}[String(n)],r=getStyle(t,e);return["scroll","auto","overlay"].some(s=>r.includes(s))},getScrollContainer=(t,n)=>{if(!isClient)return;let e=t;for(;e;){if([window,document,document.documentElement].includes(e))return window;if(isScroll(e,n))return e;e=e.parentNode}return e};let scrollBarWidth;const getScrollBarWidth=t=>{var n;if(!isClient)return 0;if(scrollBarWidth!==void 0)return scrollBarWidth;const e=document.createElement("div");e.className=`${t}-scrollbar__wrap`,e.style.visibility="hidden",e.style.width="100px",e.style.position="absolute",e.style.top="-9999px",document.body.appendChild(e);const r=e.offsetWidth;e.style.overflow="scroll";const s=document.createElement("div");s.style.width="100%",e.appendChild(s);const i=s.offsetWidth;return(n=e.parentNode)==null||n.removeChild(e),scrollBarWidth=r-i,scrollBarWidth};/*! Element Plus Icons Vue v2.3.1 */var arrow_down_bold_vue_vue_type_script_setup_true_lang_default=defineComponent({name:"ArrowDownBold",__name:"arrow-down-bold",setup(t){return(n,e)=>(openBlock(),createElementBlock("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[createBaseVNode("path",{fill:"currentColor",d:"M104.704 338.752a64 64 0 0 1 90.496 0l316.8 316.8 316.8-316.8a64 64 0 0 1 90.496 90.496L557.248 791.296a64 64 0 0 1-90.496 0L104.704 429.248a64 64 0 0 1 0-90.496z"})]))}}),arrow_down_bold_default=arrow_down_bold_vue_vue_type_script_setup_true_lang_default,arrow_down_vue_vue_type_script_setup_true_lang_default=defineComponent({name:"ArrowDown",__name:"arrow-down",setup(t){return(n,e)=>(openBlock(),createElementBlock("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[createBaseVNode("path",{fill:"currentColor",d:"M831.872 340.864 512 652.672 192.128 340.864a30.592 30.592 0 0 0-42.752 0 29.12 29.12 0 0 0 0 41.6L489.664 714.24a32 32 0 0 0 44.672 0l340.288-331.712a29.12 29.12 0 0 0 0-41.728 30.592 30.592 0 0 0-42.752 0z"})]))}}),arrow_down_default=arrow_down_vue_vue_type_script_setup_true_lang_default,arrow_left_vue_vue_type_script_setup_true_lang_default=defineComponent({name:"ArrowLeft",__name:"arrow-left",setup(t){return(n,e)=>(openBlock(),createElementBlock("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[createBaseVNode("path",{fill:"currentColor",d:"M609.408 149.376 277.76 489.6a32 32 0 0 0 0 44.672l331.648 340.352a29.12 29.12 0 0 0 41.728 0 30.592 30.592 0 0 0 0-42.752L339.264 511.936l311.872-319.872a30.592 30.592 0 0 0 0-42.688 29.12 29.12 0 0 0-41.728 0z"})]))}}),arrow_left_default=arrow_left_vue_vue_type_script_setup_true_lang_default,arrow_right_vue_vue_type_script_setup_true_lang_default=defineComponent({name:"ArrowRight",__name:"arrow-right",setup(t){return(n,e)=>(openBlock(),createElementBlock("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[createBaseVNode("path",{fill:"currentColor",d:"M340.864 149.312a30.592 30.592 0 0 0 0 42.752L652.736 512 340.864 831.872a30.592 30.592 0 0 0 0 42.752 29.12 29.12 0 0 0 41.728 0L714.24 534.336a32 32 0 0 0 0-44.672L382.592 149.376a29.12 29.12 0 0 0-41.728 0z"})]))}}),arrow_right_default=arrow_right_vue_vue_type_script_setup_true_lang_default,circle_check_vue_vue_type_script_setup_true_lang_default=defineComponent({name:"CircleCheck",__name:"circle-check",setup(t){return(n,e)=>(openBlock(),createElementBlock("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[createBaseVNode("path",{fill:"currentColor",d:"M512 896a384 384 0 1 0 0-768 384 384 0 0 0 0 768m0 64a448 448 0 1 1 0-896 448 448 0 0 1 0 896"}),createBaseVNode("path",{fill:"currentColor",d:"M745.344 361.344a32 32 0 0 1 45.312 45.312l-288 288a32 32 0 0 1-45.312 0l-160-160a32 32 0 1 1 45.312-45.312L480 626.752l265.344-265.408z"})]))}}),circle_check_default=circle_check_vue_vue_type_script_setup_true_lang_default,circle_close_filled_vue_vue_type_script_setup_true_lang_default=defineComponent({name:"CircleCloseFilled",__name:"circle-close-filled",setup(t){return(n,e)=>(openBlock(),createElementBlock("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[createBaseVNode("path",{fill:"currentColor",d:"M512 64a448 448 0 1 1 0 896 448 448 0 0 1 0-896m0 393.664L407.936 353.6a38.4 38.4 0 1 0-54.336 54.336L457.664 512 353.6 616.064a38.4 38.4 0 1 0 54.336 54.336L512 566.336 616.064 670.4a38.4 38.4 0 1 0 54.336-54.336L566.336 512 670.4 407.936a38.4 38.4 0 1 0-54.336-54.336z"})]))}}),circle_close_filled_default=circle_close_filled_vue_vue_type_script_setup_true_lang_default,circle_close_vue_vue_type_script_setup_true_lang_default=defineComponent({name:"CircleClose",__name:"circle-close",setup(t){return(n,e)=>(openBlock(),createElementBlock("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[createBaseVNode("path",{fill:"currentColor",d:"m466.752 512-90.496-90.496a32 32 0 0 1 45.248-45.248L512 466.752l90.496-90.496a32 32 0 1 1 45.248 45.248L557.248 512l90.496 90.496a32 32 0 1 1-45.248 45.248L512 557.248l-90.496 90.496a32 32 0 0 1-45.248-45.248z"}),createBaseVNode("path",{fill:"currentColor",d:"M512 896a384 384 0 1 0 0-768 384 384 0 0 0 0 768m0 64a448 448 0 1 1 0-896 448 448 0 0 1 0 896"})]))}}),circle_close_default=circle_close_vue_vue_type_script_setup_true_lang_default,close_vue_vue_type_script_setup_true_lang_default=defineComponent({name:"Close",__name:"close",setup(t){return(n,e)=>(openBlock(),createElementBlock("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[createBaseVNode("path",{fill:"currentColor",d:"M764.288 214.592 512 466.88 259.712 214.592a31.936 31.936 0 0 0-45.12 45.12L466.752 512 214.528 764.224a31.936 31.936 0 1 0 45.12 45.184L512 557.184l252.288 252.288a31.936 31.936 0 0 0 45.12-45.12L557.12 512.064l252.288-252.352a31.936 31.936 0 1 0-45.12-45.184z"})]))}}),close_default=close_vue_vue_type_script_setup_true_lang_default,full_screen_vue_vue_type_script_setup_true_lang_default=defineComponent({name:"FullScreen",__name:"full-screen",setup(t){return(n,e)=>(openBlock(),createElementBlock("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[createBaseVNode("path",{fill:"currentColor",d:"m160 96.064 192 .192a32 32 0 0 1 0 64l-192-.192V352a32 32 0 0 1-64 0V96h64zm0 831.872V928H96V672a32 32 0 1 1 64 0v191.936l192-.192a32 32 0 1 1 0 64zM864 96.064V96h64v256a32 32 0 1 1-64 0V160.064l-192 .192a32 32 0 1 1 0-64l192-.192zm0 831.872-192-.192a32 32 0 0 1 0-64l192 .192V672a32 32 0 1 1 64 0v256h-64z"})]))}}),full_screen_default=full_screen_vue_vue_type_script_setup_true_lang_default,hide_vue_vue_type_script_setup_true_lang_default=defineComponent({name:"Hide",__name:"hide",setup(t){return(n,e)=>(openBlock(),createElementBlock("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[createBaseVNode("path",{fill:"currentColor",d:"M876.8 156.8c0-9.6-3.2-16-9.6-22.4-6.4-6.4-12.8-9.6-22.4-9.6-9.6 0-16 3.2-22.4 9.6L736 220.8c-64-32-137.6-51.2-224-60.8-160 16-288 73.6-377.6 176C44.8 438.4 0 496 0 512s48 73.6 134.4 176c22.4 25.6 44.8 48 73.6 67.2l-86.4 89.6c-6.4 6.4-9.6 12.8-9.6 22.4 0 9.6 3.2 16 9.6 22.4 6.4 6.4 12.8 9.6 22.4 9.6 9.6 0 16-3.2 22.4-9.6l704-710.4c3.2-6.4 6.4-12.8 6.4-22.4Zm-646.4 528c-76.8-70.4-128-128-153.6-172.8 28.8-48 80-105.6 153.6-172.8C304 272 400 230.4 512 224c64 3.2 124.8 19.2 176 44.8l-54.4 54.4C598.4 300.8 560 288 512 288c-64 0-115.2 22.4-160 64s-64 96-64 160c0 48 12.8 89.6 35.2 124.8L256 707.2c-9.6-6.4-19.2-16-25.6-22.4Zm140.8-96c-12.8-22.4-19.2-48-19.2-76.8 0-44.8 16-83.2 48-112 32-28.8 67.2-48 112-48 28.8 0 54.4 6.4 73.6 19.2zM889.599 336c-12.8-16-28.8-28.8-41.6-41.6l-48 48c73.6 67.2 124.8 124.8 150.4 169.6-28.8 48-80 105.6-153.6 172.8-73.6 67.2-172.8 108.8-284.8 115.2-51.2-3.2-99.2-12.8-140.8-28.8l-48 48c57.6 22.4 118.4 38.4 188.8 44.8 160-16 288-73.6 377.6-176C979.199 585.6 1024 528 1024 512s-48.001-73.6-134.401-176Z"}),createBaseVNode("path",{fill:"currentColor",d:"M511.998 672c-12.8 0-25.6-3.2-38.4-6.4l-51.2 51.2c28.8 12.8 57.6 19.2 89.6 19.2 64 0 115.2-22.4 160-64 41.6-41.6 64-96 64-160 0-32-6.4-64-19.2-89.6l-51.2 51.2c3.2 12.8 6.4 25.6 6.4 38.4 0 44.8-16 83.2-48 112-32 28.8-67.2 48-112 48Z"})]))}}),hide_default=hide_vue_vue_type_script_setup_true_lang_default,info_filled_vue_vue_type_script_setup_true_lang_default=defineComponent({name:"InfoFilled",__name:"info-filled",setup(t){return(n,e)=>(openBlock(),createElementBlock("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[createBaseVNode("path",{fill:"currentColor",d:"M512 64a448 448 0 1 1 0 896.064A448 448 0 0 1 512 64m67.2 275.072c33.28 0 60.288-23.104 60.288-57.344s-27.072-57.344-60.288-57.344c-33.28 0-60.16 23.104-60.16 57.344s26.88 57.344 60.16 57.344M590.912 699.2c0-6.848 2.368-24.64 1.024-34.752l-52.608 60.544c-10.88 11.456-24.512 19.392-30.912 17.28a12.992 12.992 0 0 1-8.256-14.72l87.68-276.992c7.168-35.136-12.544-67.2-54.336-71.296-44.096 0-108.992 44.736-148.48 101.504 0 6.784-1.28 23.68.064 33.792l52.544-60.608c10.88-11.328 23.552-19.328 29.952-17.152a12.8 12.8 0 0 1 7.808 16.128L388.48 728.576c-10.048 32.256 8.96 63.872 55.04 71.04 67.84 0 107.904-43.648 147.456-100.416z"})]))}}),info_filled_default=info_filled_vue_vue_type_script_setup_true_lang_default,loading_vue_vue_type_script_setup_true_lang_default=defineComponent({name:"Loading",__name:"loading",setup(t){return(n,e)=>(openBlock(),createElementBlock("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[createBaseVNode("path",{fill:"currentColor",d:"M512 64a32 32 0 0 1 32 32v192a32 32 0 0 1-64 0V96a32 32 0 0 1 32-32m0 640a32 32 0 0 1 32 32v192a32 32 0 1 1-64 0V736a32 32 0 0 1 32-32m448-192a32 32 0 0 1-32 32H736a32 32 0 1 1 0-64h192a32 32 0 0 1 32 32m-640 0a32 32 0 0 1-32 32H96a32 32 0 0 1 0-64h192a32 32 0 0 1 32 32M195.2 195.2a32 32 0 0 1 45.248 0L376.32 331.008a32 32 0 0 1-45.248 45.248L195.2 240.448a32 32 0 0 1 0-45.248zm452.544 452.544a32 32 0 0 1 45.248 0L828.8 783.552a32 32 0 0 1-45.248 45.248L647.744 692.992a32 32 0 0 1 0-45.248zM828.8 195.264a32 32 0 0 1 0 45.184L692.992 376.32a32 32 0 0 1-45.248-45.248l135.808-135.808a32 32 0 0 1 45.248 0m-452.544 452.48a32 32 0 0 1 0 45.248L240.448 828.8a32 32 0 0 1-45.248-45.248l135.808-135.808a32 32 0 0 1 45.248 0z"})]))}}),loading_default=loading_vue_vue_type_script_setup_true_lang_default,refresh_left_vue_vue_type_script_setup_true_lang_default=defineComponent({name:"RefreshLeft",__name:"refresh-left",setup(t){return(n,e)=>(openBlock(),createElementBlock("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[createBaseVNode("path",{fill:"currentColor",d:"M289.088 296.704h92.992a32 32 0 0 1 0 64H232.96a32 32 0 0 1-32-32V179.712a32 32 0 0 1 64 0v50.56a384 384 0 0 1 643.84 282.88 384 384 0 0 1-383.936 384 384 384 0 0 1-384-384h64a320 320 0 1 0 640 0 320 320 0 0 0-555.712-216.448z"})]))}}),refresh_left_default=refresh_left_vue_vue_type_script_setup_true_lang_default,refresh_right_vue_vue_type_script_setup_true_lang_default=defineComponent({name:"RefreshRight",__name:"refresh-right",setup(t){return(n,e)=>(openBlock(),createElementBlock("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[createBaseVNode("path",{fill:"currentColor",d:"M784.512 230.272v-50.56a32 32 0 1 1 64 0v149.056a32 32 0 0 1-32 32H667.52a32 32 0 1 1 0-64h92.992A320 320 0 1 0 524.8 833.152a320 320 0 0 0 320-320h64a384 384 0 0 1-384 384 384 384 0 0 1-384-384 384 384 0 0 1 643.712-282.88z"})]))}}),refresh_right_default=refresh_right_vue_vue_type_script_setup_true_lang_default,scale_to_original_vue_vue_type_script_setup_true_lang_default=defineComponent({name:"ScaleToOriginal",__name:"scale-to-original",setup(t){return(n,e)=>(openBlock(),createElementBlock("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[createBaseVNode("path",{fill:"currentColor",d:"M813.176 180.706a60.235 60.235 0 0 1 60.236 60.235v481.883a60.235 60.235 0 0 1-60.236 60.235H210.824a60.235 60.235 0 0 1-60.236-60.235V240.94a60.235 60.235 0 0 1 60.236-60.235h602.352zm0-60.235H210.824A120.47 120.47 0 0 0 90.353 240.94v481.883a120.47 120.47 0 0 0 120.47 120.47h602.353a120.47 120.47 0 0 0 120.471-120.47V240.94a120.47 120.47 0 0 0-120.47-120.47zm-120.47 180.705a30.118 30.118 0 0 0-30.118 30.118v301.177a30.118 30.118 0 0 0 60.236 0V331.294a30.118 30.118 0 0 0-30.118-30.118zm-361.412 0a30.118 30.118 0 0 0-30.118 30.118v301.177a30.118 30.118 0 1 0 60.236 0V331.294a30.118 30.118 0 0 0-30.118-30.118M512 361.412a30.118 30.118 0 0 0-30.118 30.117v30.118a30.118 30.118 0 0 0 60.236 0V391.53A30.118 30.118 0 0 0 512 361.412M512 512a30.118 30.118 0 0 0-30.118 30.118v30.117a30.118 30.118 0 0 0 60.236 0v-30.117A30.118 30.118 0 0 0 512 512"})]))}}),scale_to_original_default=scale_to_original_vue_vue_type_script_setup_true_lang_default,setting_vue_vue_type_script_setup_true_lang_default=defineComponent({name:"Setting",__name:"setting",setup(t){return(n,e)=>(openBlock(),createElementBlock("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[createBaseVNode("path",{fill:"currentColor",d:"M600.704 64a32 32 0 0 1 30.464 22.208l35.2 109.376c14.784 7.232 28.928 15.36 42.432 24.512l112.384-24.192a32 32 0 0 1 34.432 15.36L944.32 364.8a32 32 0 0 1-4.032 37.504l-77.12 85.12a357.12 357.12 0 0 1 0 49.024l77.12 85.248a32 32 0 0 1 4.032 37.504l-88.704 153.6a32 32 0 0 1-34.432 15.296L708.8 803.904c-13.44 9.088-27.648 17.28-42.368 24.512l-35.264 109.376A32 32 0 0 1 600.704 960H423.296a32 32 0 0 1-30.464-22.208L357.696 828.48a351.616 351.616 0 0 1-42.56-24.64l-112.32 24.256a32 32 0 0 1-34.432-15.36L79.68 659.2a32 32 0 0 1 4.032-37.504l77.12-85.248a357.12 357.12 0 0 1 0-48.896l-77.12-85.248A32 32 0 0 1 79.68 364.8l88.704-153.6a32 32 0 0 1 34.432-15.296l112.32 24.256c13.568-9.152 27.776-17.408 42.56-24.64l35.2-109.312A32 32 0 0 1 423.232 64H600.64zm-23.424 64H446.72l-36.352 113.088-24.512 11.968a294.113 294.113 0 0 0-34.816 20.096l-22.656 15.36-116.224-25.088-65.28 113.152 79.68 88.192-1.92 27.136a293.12 293.12 0 0 0 0 40.192l1.92 27.136-79.808 88.192 65.344 113.152 116.224-25.024 22.656 15.296a294.113 294.113 0 0 0 34.816 20.096l24.512 11.968L446.72 896h130.688l36.48-113.152 24.448-11.904a288.282 288.282 0 0 0 34.752-20.096l22.592-15.296 116.288 25.024 65.28-113.152-79.744-88.192 1.92-27.136a293.12 293.12 0 0 0 0-40.256l-1.92-27.136 79.808-88.128-65.344-113.152-116.288 24.96-22.592-15.232a287.616 287.616 0 0 0-34.752-20.096l-24.448-11.904L577.344 128zM512 320a192 192 0 1 1 0 384 192 192 0 0 1 0-384m0 64a128 128 0 1 0 0 256 128 128 0 0 0 0-256"})]))}}),setting_default=setting_vue_vue_type_script_setup_true_lang_default,success_filled_vue_vue_type_script_setup_true_lang_default=defineComponent({name:"SuccessFilled",__name:"success-filled",setup(t){return(n,e)=>(openBlock(),createElementBlock("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[createBaseVNode("path",{fill:"currentColor",d:"M512 64a448 448 0 1 1 0 896 448 448 0 0 1 0-896m-55.808 536.384-99.52-99.584a38.4 38.4 0 1 0-54.336 54.336l126.72 126.72a38.272 38.272 0 0 0 54.336 0l262.4-262.464a38.4 38.4 0 1 0-54.272-54.336z"})]))}}),success_filled_default=success_filled_vue_vue_type_script_setup_true_lang_default,view_vue_vue_type_script_setup_true_lang_default=defineComponent({name:"View",__name:"view",setup(t){return(n,e)=>(openBlock(),createElementBlock("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[createBaseVNode("path",{fill:"currentColor",d:"M512 160c320 0 512 352 512 352S832 864 512 864 0 512 0 512s192-352 512-352m0 64c-225.28 0-384.128 208.064-436.8 288 52.608 79.872 211.456 288 436.8 288 225.28 0 384.128-208.064 436.8-288-52.608-79.872-211.456-288-436.8-288zm0 64a224 224 0 1 1 0 448 224 224 0 0 1 0-448m0 64a160.192 160.192 0 0 0-160 160c0 88.192 71.744 160 160 160s160-71.808 160-160-71.744-160-160-160"})]))}}),view_default=view_vue_vue_type_script_setup_true_lang_default,warning_filled_vue_vue_type_script_setup_true_lang_default=defineComponent({name:"WarningFilled",__name:"warning-filled",setup(t){return(n,e)=>(openBlock(),createElementBlock("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[createBaseVNode("path",{fill:"currentColor",d:"M512 64a448 448 0 1 1 0 896 448 448 0 0 1 0-896m0 192a58.432 58.432 0 0 0-58.24 63.744l23.36 256.384a35.072 35.072 0 0 0 69.76 0l23.296-256.384A58.432 58.432 0 0 0 512 256m0 512a51.2 51.2 0 1 0 0-102.4 51.2 51.2 0 0 0 0 102.4"})]))}}),warning_filled_default=warning_filled_vue_vue_type_script_setup_true_lang_default,zoom_in_vue_vue_type_script_setup_true_lang_default=defineComponent({name:"ZoomIn",__name:"zoom-in",setup(t){return(n,e)=>(openBlock(),createElementBlock("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[createBaseVNode("path",{fill:"currentColor",d:"m795.904 750.72 124.992 124.928a32 32 0 0 1-45.248 45.248L750.656 795.904a416 416 0 1 1 45.248-45.248zM480 832a352 352 0 1 0 0-704 352 352 0 0 0 0 704m-32-384v-96a32 32 0 0 1 64 0v96h96a32 32 0 0 1 0 64h-96v96a32 32 0 0 1-64 0v-96h-96a32 32 0 0 1 0-64z"})]))}}),zoom_in_default=zoom_in_vue_vue_type_script_setup_true_lang_default,zoom_out_vue_vue_type_script_setup_true_lang_default=defineComponent({name:"ZoomOut",__name:"zoom-out",setup(t){return(n,e)=>(openBlock(),createElementBlock("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[createBaseVNode("path",{fill:"currentColor",d:"m795.904 750.72 124.992 124.928a32 32 0 0 1-45.248 45.248L750.656 795.904a416 416 0 1 1 45.248-45.248zM480 832a352 352 0 1 0 0-704 352 352 0 0 0 0 704M352 448h256a32 32 0 0 1 0 64H352a32 32 0 0 1 0-64"})]))}}),zoom_out_default=zoom_out_vue_vue_type_script_setup_true_lang_default;const epPropKey="__epPropKey",definePropType=t=>t,isEpProp=t=>isObject$2(t)&&!!t[epPropKey],buildProp=(t,n)=>{if(!isObject$2(t)||isEpProp(t))return t;const{values:e,required:r,default:s,type:i,validator:o}=t,d={type:i,required:!!r,validator:e||o?c=>{let u=!1,m=[];if(e&&(m=Array.from(e),hasOwn(t,"default")&&m.push(s),u||(u=m.includes(c))),o&&(u||(u=o(c))),!u&&m.length>0){const y=[...new Set(m)].map(S=>JSON.stringify(S)).join(", ");warn(`Invalid prop: validation failed${n?` for prop "${n}"`:""}. Expected one of [${y}], got value ${JSON.stringify(c)}.`)}return u}:void 0,[epPropKey]:!0};return hasOwn(t,"default")&&(d.default=s),d},buildProps=t=>fromPairs(Object.entries(t).map(([n,e])=>[n,buildProp(e,n)])),iconPropType=definePropType([String,Object,Function]),TypeComponents={Close:close_default,SuccessFilled:success_filled_default,InfoFilled:info_filled_default,WarningFilled:warning_filled_default,CircleCloseFilled:circle_close_filled_default},TypeComponentsMap={success:success_filled_default,warning:warning_filled_default,error:circle_close_filled_default,info:info_filled_default},ValidateComponentsMap={validating:loading_default,success:circle_check_default,error:circle_close_default},withInstall=(t,n)=>{if(t.install=e=>{for(const r of[t,...Object.values(n??{})])e.component(r.name,r)},n)for(const[e,r]of Object.entries(n))t[e]=r;return t},withInstallFunction=(t,n)=>(t.install=e=>{t._context=e._context,e.config.globalProperties[n]=t},t),withNoopInstall=t=>(t.install=NOOP,t),composeRefs=(...t)=>n=>{t.forEach(e=>{isFunction$2(e)?e(n):e.value=n})},EVENT_CODE={tab:"Tab",enter:"Enter",space:"Space",left:"ArrowLeft",up:"ArrowUp",right:"ArrowRight",down:"ArrowDown",esc:"Escape",delete:"Delete",backspace:"Backspace",numpadEnter:"NumpadEnter",pageUp:"PageUp",pageDown:"PageDown",home:"Home",end:"End"},UPDATE_MODEL_EVENT="update:modelValue",componentSizes=["","default","small","large"],isValidComponentSize=t=>["",...componentSizes].includes(t);var PatchFlags=(t=>(t[t.TEXT=1]="TEXT",t[t.CLASS=2]="CLASS",t[t.STYLE=4]="STYLE",t[t.PROPS=8]="PROPS",t[t.FULL_PROPS=16]="FULL_PROPS",t[t.HYDRATE_EVENTS=32]="HYDRATE_EVENTS",t[t.STABLE_FRAGMENT=64]="STABLE_FRAGMENT",t[t.KEYED_FRAGMENT=128]="KEYED_FRAGMENT",t[t.UNKEYED_FRAGMENT=256]="UNKEYED_FRAGMENT",t[t.NEED_PATCH=512]="NEED_PATCH",t[t.DYNAMIC_SLOTS=1024]="DYNAMIC_SLOTS",t[t.HOISTED=-1]="HOISTED",t[t.BAIL=-2]="BAIL",t))(PatchFlags||{});const isKorean=t=>/([\uAC00-\uD7AF\u3130-\u318F])+/gi.test(t),mutable=t=>t,DEFAULT_EXCLUDE_KEYS=["class","style"],LISTENER_PREFIX=/^on[A-Z]/,useAttrs=(t={})=>{const{excludeListeners:n=!1,excludeKeys:e}=t,r=computed(()=>((e==null?void 0:e.value)||[]).concat(DEFAULT_EXCLUDE_KEYS)),s=getCurrentInstance();return computed(s?()=>{var i;return fromPairs(Object.entries((i=s.proxy)==null?void 0:i.$attrs).filter(([o])=>!r.value.includes(o)&&!(n&&LISTENER_PREFIX.test(o))))}:()=>({}))},useDeprecated=({from:t,replacement:n,scope:e,version:r,ref:s,type:i="API"},o)=>{watch(()=>unref(o),a=>{},{immediate:!0})},useDraggable=(t,n,e,r)=>{let s={offsetX:0,offsetY:0};const i=d=>{const c=d.clientX,u=d.clientY,{offsetX:m,offsetY:y}=s,S=t.value.getBoundingClientRect(),O=S.left,k=S.top,g=S.width,v=S.height,ue=document.documentElement.clientWidth,L=document.documentElement.clientHeight,re=-O+m,le=-k+y,oe=ue-O-g+m,he=L-k-v+y,Ie=Ne=>{let Ve=m+Ne.clientX-c,Ce=y+Ne.clientY-u;r!=null&&r.value||(Ve=Math.min(Math.max(Ve,re),oe),Ce=Math.min(Math.max(Ce,le),he)),s={offsetX:Ve,offsetY:Ce},t.value&&(t.value.style.transform=`translate(${addUnit(Ve)}, ${addUnit(Ce)})`)},ie=()=>{document.removeEventListener("mousemove",Ie),document.removeEventListener("mouseup",ie)};document.addEventListener("mousemove",Ie),document.addEventListener("mouseup",ie)},o=()=>{n.value&&t.value&&n.value.addEventListener("mousedown",i)},a=()=>{n.value&&t.value&&n.value.removeEventListener("mousedown",i)};onMounted(()=>{watchEffect(()=>{e.value?o():a()})}),onBeforeUnmount(()=>{a()})};var English={name:"en",el:{colorpicker:{confirm:"OK",clear:"Clear",defaultLabel:"color picker",description:"current color is {color}. press enter to select a new color."},datepicker:{now:"Now",today:"Today",cancel:"Cancel",clear:"Clear",confirm:"OK",dateTablePrompt:"Use the arrow keys and enter to select the day of the month",monthTablePrompt:"Use the arrow keys and enter to select the month",yearTablePrompt:"Use the arrow keys and enter to select the year",selectedDate:"Selected date",selectDate:"Select date",selectTime:"Select time",startDate:"Start Date",startTime:"Start Time",endDate:"End Date",endTime:"End Time",prevYear:"Previous Year",nextYear:"Next Year",prevMonth:"Previous Month",nextMonth:"Next Month",year:"",month1:"January",month2:"February",month3:"March",month4:"April",month5:"May",month6:"June",month7:"July",month8:"August",month9:"September",month10:"October",month11:"November",month12:"December",week:"week",weeks:{sun:"Sun",mon:"Mon",tue:"Tue",wed:"Wed",thu:"Thu",fri:"Fri",sat:"Sat"},weeksFull:{sun:"Sunday",mon:"Monday",tue:"Tuesday",wed:"Wednesday",thu:"Thursday",fri:"Friday",sat:"Saturday"},months:{jan:"Jan",feb:"Feb",mar:"Mar",apr:"Apr",may:"May",jun:"Jun",jul:"Jul",aug:"Aug",sep:"Sep",oct:"Oct",nov:"Nov",dec:"Dec"}},inputNumber:{decrease:"decrease number",increase:"increase number"},select:{loading:"Loading",noMatch:"No matching data",noData:"No data",placeholder:"Select"},dropdown:{toggleDropdown:"Toggle Dropdown"},cascader:{noMatch:"No matching data",loading:"Loading",placeholder:"Select",noData:"No data"},pagination:{goto:"Go to",pagesize:"/page",total:"Total {total}",pageClassifier:"",page:"Page",prev:"Go to previous page",next:"Go to next page",currentPage:"page {pager}",prevPages:"Previous {pager} pages",nextPages:"Next {pager} pages",deprecationWarning:"Deprecated usages detected, please refer to the el-pagination documentation for more details"},dialog:{close:"Close this dialog"},drawer:{close:"Close this dialog"},messagebox:{title:"Message",confirm:"OK",cancel:"Cancel",error:"Illegal input",close:"Close this dialog"},upload:{deleteTip:"press delete to remove",delete:"Delete",preview:"Preview",continue:"Continue"},slider:{defaultLabel:"slider between {min} and {max}",defaultRangeStartLabel:"pick start value",defaultRangeEndLabel:"pick end value"},table:{emptyText:"No Data",confirmFilter:"Confirm",resetFilter:"Reset",clearFilter:"All",sumText:"Sum"},tour:{next:"Next",previous:"Previous",finish:"Finish"},tree:{emptyText:"No Data"},transfer:{noMatch:"No matching data",noData:"No data",titles:["List 1","List 2"],filterPlaceholder:"Enter keyword",noCheckedFormat:"{total} items",hasCheckedFormat:"{checked}/{total} checked"},image:{error:"FAILED"},pageHeader:{title:"Back"},popconfirm:{confirmButtonText:"Yes",cancelButtonText:"No"},carousel:{leftArrow:"Carousel arrow left",rightArrow:"Carousel arrow right",indicator:"Carousel switch to index {index}"}}};const buildTranslator=t=>(n,e)=>translate(n,e,unref(t)),translate=(t,n,e)=>get(e,t,t).replace(/\{(\w+)\}/g,(r,s)=>{var i;return`${(i=n==null?void 0:n[s])!=null?i:`{${s}}`}`}),buildLocaleContext=t=>{const n=computed(()=>unref(t).name),e=isRef(t)?t:ref(t);return{lang:n,locale:e,t:buildTranslator(t)}},localeContextKey=Symbol("localeContextKey"),useLocale=t=>{const n=t||inject(localeContextKey,ref());return buildLocaleContext(computed(()=>n.value||English))},defaultNamespace="el",statePrefix="is-",_bem=(t,n,e,r,s)=>{let i=`${t}-${n}`;return e&&(i+=`-${e}`),r&&(i+=`__${r}`),s&&(i+=`--${s}`),i},namespaceContextKey=Symbol("namespaceContextKey"),useGetDerivedNamespace=t=>{const n=t||(getCurrentInstance()?inject(namespaceContextKey,ref(defaultNamespace)):ref(defaultNamespace));return computed(()=>unref(n)||defaultNamespace)},useNamespace=(t,n)=>{const e=useGetDerivedNamespace(n);return{namespace:e,b:(k="")=>_bem(e.value,t,k,"",""),e:k=>k?_bem(e.value,t,"",k,""):"",m:k=>k?_bem(e.value,t,"","",k):"",be:(k,g)=>k&&g?_bem(e.value,t,k,g,""):"",em:(k,g)=>k&&g?_bem(e.value,t,"",k,g):"",bm:(k,g)=>k&&g?_bem(e.value,t,k,"",g):"",bem:(k,g,v)=>k&&g&&v?_bem(e.value,t,k,g,v):"",is:(k,...g)=>{const v=g.length>=1?g[0]:!0;return k&&v?`${statePrefix}${k}`:""},cssVar:k=>{const g={};for(const v in k)k[v]&&(g[`--${e.value}-${v}`]=k[v]);return g},cssVarName:k=>`--${e.value}-${k}`,cssVarBlock:k=>{const g={};for(const v in k)k[v]&&(g[`--${e.value}-${t}-${v}`]=k[v]);return g},cssVarBlockName:k=>`--${e.value}-${t}-${k}`}},useLockscreen=(t,n={})=>{isRef(t)||throwError("[useLockscreen]","You need to pass a ref param to this function");const e=n.ns||useNamespace("popup"),r=computed$1(()=>e.bm("parent","hidden"));if(!isClient||hasClass(document.body,r.value))return;let s=0,i=!1,o="0";const a=()=>{setTimeout(()=>{removeClass(document==null?void 0:document.body,r.value),i&&document&&(document.body.style.width=o)},200)};watch(t,d=>{if(!d){a();return}i=!hasClass(document.body,r.value),i&&(o=document.body.style.width),s=getScrollBarWidth(e.namespace.value);const c=document.documentElement.clientHeight<document.body.scrollHeight,u=getStyle(document.body,"overflowY");s>0&&(c||u==="scroll")&&i&&(document.body.style.width=`calc(100% - ${s}px)`),addClass(document.body,r.value)}),onScopeDispose(()=>a())},_prop=buildProp({type:definePropType(Boolean),default:null}),_event=buildProp({type:definePropType(Function)}),createModelToggleComposable=t=>{const n=`update:${t}`,e=`onUpdate:${t}`,r=[n],s={[t]:_prop,[e]:_event};return{useModelToggle:({indicator:o,toggleReason:a,shouldHideWhenRouteChanges:d,shouldProceed:c,onShow:u,onHide:m})=>{const y=getCurrentInstance(),{emit:S}=y,O=y.props,k=computed(()=>isFunction$2(O[e])),g=computed(()=>O[t]===null),v=he=>{o.value!==!0&&(o.value=!0,a&&(a.value=he),isFunction$2(u)&&u(he))},ue=he=>{o.value!==!1&&(o.value=!1,a&&(a.value=he),isFunction$2(m)&&m(he))},L=he=>{if(O.disabled===!0||isFunction$2(c)&&!c())return;const Ie=k.value&&isClient;Ie&&S(n,!0),(g.value||!Ie)&&v(he)},re=he=>{if(O.disabled===!0||!isClient)return;const Ie=k.value&&isClient;Ie&&S(n,!1),(g.value||!Ie)&&ue(he)},le=he=>{isBoolean$1(he)&&(O.disabled&&he?k.value&&S(n,!1):o.value!==he&&(he?v():ue()))},oe=()=>{o.value?re():L()};return watch(()=>O[t],le),d&&y.appContext.config.globalProperties.$route!==void 0&&watch(()=>({...y.proxy.$route}),()=>{d.value&&o.value&&re()}),onMounted(()=>{le(O[t])}),{hide:re,show:L,toggle:oe,hasUpdateHandler:k}},useModelToggleProps:s,useModelToggleEmits:r}};createModelToggleComposable("modelValue");const useProp=t=>{const n=getCurrentInstance();return computed(()=>{var e,r;return(r=(e=n==null?void 0:n.proxy)==null?void 0:e.$props)==null?void 0:r[t]})};var E="top",R="bottom",W="right",P="left",me="auto",G=[E,R,W,P],U="start",J="end",Xe="clippingParents",je="viewport",K="popper",Ye="reference",De=G.reduce(function(t,n){return t.concat([n+"-"+U,n+"-"+J])},[]),Ee=[].concat(G,[me]).reduce(function(t,n){return t.concat([n,n+"-"+U,n+"-"+J])},[]),Ge="beforeRead",Je="read",Ke="afterRead",Qe="beforeMain",Ze="main",et="afterMain",tt$1="beforeWrite",nt="write",rt="afterWrite",ot=[Ge,Je,Ke,Qe,Ze,et,tt$1,nt,rt];function C(t){return t?(t.nodeName||"").toLowerCase():null}function H(t){if(t==null)return window;if(t.toString()!=="[object Window]"){var n=t.ownerDocument;return n&&n.defaultView||window}return t}function Q(t){var n=H(t).Element;return t instanceof n||t instanceof Element}function B(t){var n=H(t).HTMLElement;return t instanceof n||t instanceof HTMLElement}function Pe(t){if(typeof ShadowRoot>"u")return!1;var n=H(t).ShadowRoot;return t instanceof n||t instanceof ShadowRoot}function Mt(t){var n=t.state;Object.keys(n.elements).forEach(function(e){var r=n.styles[e]||{},s=n.attributes[e]||{},i=n.elements[e];!B(i)||!C(i)||(Object.assign(i.style,r),Object.keys(s).forEach(function(o){var a=s[o];a===!1?i.removeAttribute(o):i.setAttribute(o,a===!0?"":a)}))})}function Rt(t){var n=t.state,e={popper:{position:n.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(n.elements.popper.style,e.popper),n.styles=e,n.elements.arrow&&Object.assign(n.elements.arrow.style,e.arrow),function(){Object.keys(n.elements).forEach(function(r){var s=n.elements[r],i=n.attributes[r]||{},o=Object.keys(n.styles.hasOwnProperty(r)?n.styles[r]:e[r]),a=o.reduce(function(d,c){return d[c]="",d},{});!B(s)||!C(s)||(Object.assign(s.style,a),Object.keys(i).forEach(function(d){s.removeAttribute(d)}))})}}var Ae={name:"applyStyles",enabled:!0,phase:"write",fn:Mt,effect:Rt,requires:["computeStyles"]};function q(t){return t.split("-")[0]}var X=Math.max,ve=Math.min,Z=Math.round;function ee(t,n){n===void 0&&(n=!1);var e=t.getBoundingClientRect(),r=1,s=1;if(B(t)&&n){var i=t.offsetHeight,o=t.offsetWidth;o>0&&(r=Z(e.width)/o||1),i>0&&(s=Z(e.height)/i||1)}return{width:e.width/r,height:e.height/s,top:e.top/s,right:e.right/r,bottom:e.bottom/s,left:e.left/r,x:e.left/r,y:e.top/s}}function ke(t){var n=ee(t),e=t.offsetWidth,r=t.offsetHeight;return Math.abs(n.width-e)<=1&&(e=n.width),Math.abs(n.height-r)<=1&&(r=n.height),{x:t.offsetLeft,y:t.offsetTop,width:e,height:r}}function it(t,n){var e=n.getRootNode&&n.getRootNode();if(t.contains(n))return!0;if(e&&Pe(e)){var r=n;do{if(r&&t.isSameNode(r))return!0;r=r.parentNode||r.host}while(r)}return!1}function N(t){return H(t).getComputedStyle(t)}function Wt(t){return["table","td","th"].indexOf(C(t))>=0}function I(t){return((Q(t)?t.ownerDocument:t.document)||window.document).documentElement}function ge(t){return C(t)==="html"?t:t.assignedSlot||t.parentNode||(Pe(t)?t.host:null)||I(t)}function at(t){return!B(t)||N(t).position==="fixed"?null:t.offsetParent}function Bt(t){var n=navigator.userAgent.toLowerCase().indexOf("firefox")!==-1,e=navigator.userAgent.indexOf("Trident")!==-1;if(e&&B(t)){var r=N(t);if(r.position==="fixed")return null}var s=ge(t);for(Pe(s)&&(s=s.host);B(s)&&["html","body"].indexOf(C(s))<0;){var i=N(s);if(i.transform!=="none"||i.perspective!=="none"||i.contain==="paint"||["transform","perspective"].indexOf(i.willChange)!==-1||n&&i.willChange==="filter"||n&&i.filter&&i.filter!=="none")return s;s=s.parentNode}return null}function se(t){for(var n=H(t),e=at(t);e&&Wt(e)&&N(e).position==="static";)e=at(e);return e&&(C(e)==="html"||C(e)==="body"&&N(e).position==="static")?n:e||Bt(t)||n}function Le(t){return["top","bottom"].indexOf(t)>=0?"x":"y"}function fe(t,n,e){return X(t,ve(n,e))}function St(t,n,e){var r=fe(t,n,e);return r>e?e:r}function st(){return{top:0,right:0,bottom:0,left:0}}function ft(t){return Object.assign({},st(),t)}function ct(t,n){return n.reduce(function(e,r){return e[r]=t,e},{})}var Tt=function(t,n){return t=typeof t=="function"?t(Object.assign({},n.rects,{placement:n.placement})):t,ft(typeof t!="number"?t:ct(t,G))};function Ht(t){var n,e=t.state,r=t.name,s=t.options,i=e.elements.arrow,o=e.modifiersData.popperOffsets,a=q(e.placement),d=Le(a),c=[P,W].indexOf(a)>=0,u=c?"height":"width";if(!(!i||!o)){var m=Tt(s.padding,e),y=ke(i),S=d==="y"?E:P,O=d==="y"?R:W,k=e.rects.reference[u]+e.rects.reference[d]-o[d]-e.rects.popper[u],g=o[d]-e.rects.reference[d],v=se(i),ue=v?d==="y"?v.clientHeight||0:v.clientWidth||0:0,L=k/2-g/2,re=m[S],le=ue-y[u]-m[O],oe=ue/2-y[u]/2+L,he=fe(re,oe,le),Ie=d;e.modifiersData[r]=(n={},n[Ie]=he,n.centerOffset=he-oe,n)}}function Ct(t){var n=t.state,e=t.options,r=e.element,s=r===void 0?"[data-popper-arrow]":r;s!=null&&(typeof s=="string"&&(s=n.elements.popper.querySelector(s),!s)||!it(n.elements.popper,s)||(n.elements.arrow=s))}var pt={name:"arrow",enabled:!0,phase:"main",fn:Ht,effect:Ct,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function te(t){return t.split("-")[1]}var qt={top:"auto",right:"auto",bottom:"auto",left:"auto"};function Vt(t){var n=t.x,e=t.y,r=window,s=r.devicePixelRatio||1;return{x:Z(n*s)/s||0,y:Z(e*s)/s||0}}function ut(t){var n,e=t.popper,r=t.popperRect,s=t.placement,i=t.variation,o=t.offsets,a=t.position,d=t.gpuAcceleration,c=t.adaptive,u=t.roundOffsets,m=t.isFixed,y=o.x,S=y===void 0?0:y,O=o.y,k=O===void 0?0:O,g=typeof u=="function"?u({x:S,y:k}):{x:S,y:k};S=g.x,k=g.y;var v=o.hasOwnProperty("x"),ue=o.hasOwnProperty("y"),L=P,re=E,le=window;if(c){var oe=se(e),he="clientHeight",Ie="clientWidth";if(oe===H(e)&&(oe=I(e),N(oe).position!=="static"&&a==="absolute"&&(he="scrollHeight",Ie="scrollWidth")),oe=oe,s===E||(s===P||s===W)&&i===J){re=R;var ie=m&&oe===le&&le.visualViewport?le.visualViewport.height:oe[he];k-=ie-r.height,k*=d?1:-1}if(s===P||(s===E||s===R)&&i===J){L=W;var Ne=m&&oe===le&&le.visualViewport?le.visualViewport.width:oe[Ie];S-=Ne-r.width,S*=d?1:-1}}var Ve=Object.assign({position:a},c&&qt),Ce=u===!0?Vt({x:S,y:k}):{x:S,y:k};if(S=Ce.x,k=Ce.y,d){var Ue;return Object.assign({},Ve,(Ue={},Ue[re]=ue?"0":"",Ue[L]=v?"0":"",Ue.transform=(le.devicePixelRatio||1)<=1?"translate("+S+"px, "+k+"px)":"translate3d("+S+"px, "+k+"px, 0)",Ue))}return Object.assign({},Ve,(n={},n[re]=ue?k+"px":"",n[L]=v?S+"px":"",n.transform="",n))}function Nt(t){var n=t.state,e=t.options,r=e.gpuAcceleration,s=r===void 0?!0:r,i=e.adaptive,o=i===void 0?!0:i,a=e.roundOffsets,d=a===void 0?!0:a,c={placement:q(n.placement),variation:te(n.placement),popper:n.elements.popper,popperRect:n.rects.popper,gpuAcceleration:s,isFixed:n.options.strategy==="fixed"};n.modifiersData.popperOffsets!=null&&(n.styles.popper=Object.assign({},n.styles.popper,ut(Object.assign({},c,{offsets:n.modifiersData.popperOffsets,position:n.options.strategy,adaptive:o,roundOffsets:d})))),n.modifiersData.arrow!=null&&(n.styles.arrow=Object.assign({},n.styles.arrow,ut(Object.assign({},c,{offsets:n.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:d})))),n.attributes.popper=Object.assign({},n.attributes.popper,{"data-popper-placement":n.placement})}var Me={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:Nt,data:{}},ye={passive:!0};function It(t){var n=t.state,e=t.instance,r=t.options,s=r.scroll,i=s===void 0?!0:s,o=r.resize,a=o===void 0?!0:o,d=H(n.elements.popper),c=[].concat(n.scrollParents.reference,n.scrollParents.popper);return i&&c.forEach(function(u){u.addEventListener("scroll",e.update,ye)}),a&&d.addEventListener("resize",e.update,ye),function(){i&&c.forEach(function(u){u.removeEventListener("scroll",e.update,ye)}),a&&d.removeEventListener("resize",e.update,ye)}}var Re={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:It,data:{}},_t={left:"right",right:"left",bottom:"top",top:"bottom"};function be(t){return t.replace(/left|right|bottom|top/g,function(n){return _t[n]})}var zt={start:"end",end:"start"};function lt(t){return t.replace(/start|end/g,function(n){return zt[n]})}function We(t){var n=H(t),e=n.pageXOffset,r=n.pageYOffset;return{scrollLeft:e,scrollTop:r}}function Be(t){return ee(I(t)).left+We(t).scrollLeft}function Ft(t){var n=H(t),e=I(t),r=n.visualViewport,s=e.clientWidth,i=e.clientHeight,o=0,a=0;return r&&(s=r.width,i=r.height,/^((?!chrome|android).)*safari/i.test(navigator.userAgent)||(o=r.offsetLeft,a=r.offsetTop)),{width:s,height:i,x:o+Be(t),y:a}}function Ut(t){var n,e=I(t),r=We(t),s=(n=t.ownerDocument)==null?void 0:n.body,i=X(e.scrollWidth,e.clientWidth,s?s.scrollWidth:0,s?s.clientWidth:0),o=X(e.scrollHeight,e.clientHeight,s?s.scrollHeight:0,s?s.clientHeight:0),a=-r.scrollLeft+Be(t),d=-r.scrollTop;return N(s||e).direction==="rtl"&&(a+=X(e.clientWidth,s?s.clientWidth:0)-i),{width:i,height:o,x:a,y:d}}function Se(t){var n=N(t),e=n.overflow,r=n.overflowX,s=n.overflowY;return/auto|scroll|overlay|hidden/.test(e+s+r)}function dt(t){return["html","body","#document"].indexOf(C(t))>=0?t.ownerDocument.body:B(t)&&Se(t)?t:dt(ge(t))}function ce(t,n){var e;n===void 0&&(n=[]);var r=dt(t),s=r===((e=t.ownerDocument)==null?void 0:e.body),i=H(r),o=s?[i].concat(i.visualViewport||[],Se(r)?r:[]):r,a=n.concat(o);return s?a:a.concat(ce(ge(o)))}function Te(t){return Object.assign({},t,{left:t.x,top:t.y,right:t.x+t.width,bottom:t.y+t.height})}function Xt(t){var n=ee(t);return n.top=n.top+t.clientTop,n.left=n.left+t.clientLeft,n.bottom=n.top+t.clientHeight,n.right=n.left+t.clientWidth,n.width=t.clientWidth,n.height=t.clientHeight,n.x=n.left,n.y=n.top,n}function ht(t,n){return n===je?Te(Ft(t)):Q(n)?Xt(n):Te(Ut(I(t)))}function Yt(t){var n=ce(ge(t)),e=["absolute","fixed"].indexOf(N(t).position)>=0,r=e&&B(t)?se(t):t;return Q(r)?n.filter(function(s){return Q(s)&&it(s,r)&&C(s)!=="body"}):[]}function Gt(t,n,e){var r=n==="clippingParents"?Yt(t):[].concat(n),s=[].concat(r,[e]),i=s[0],o=s.reduce(function(a,d){var c=ht(t,d);return a.top=X(c.top,a.top),a.right=ve(c.right,a.right),a.bottom=ve(c.bottom,a.bottom),a.left=X(c.left,a.left),a},ht(t,i));return o.width=o.right-o.left,o.height=o.bottom-o.top,o.x=o.left,o.y=o.top,o}function mt(t){var n=t.reference,e=t.element,r=t.placement,s=r?q(r):null,i=r?te(r):null,o=n.x+n.width/2-e.width/2,a=n.y+n.height/2-e.height/2,d;switch(s){case E:d={x:o,y:n.y-e.height};break;case R:d={x:o,y:n.y+n.height};break;case W:d={x:n.x+n.width,y:a};break;case P:d={x:n.x-e.width,y:a};break;default:d={x:n.x,y:n.y}}var c=s?Le(s):null;if(c!=null){var u=c==="y"?"height":"width";switch(i){case U:d[c]=d[c]-(n[u]/2-e[u]/2);break;case J:d[c]=d[c]+(n[u]/2-e[u]/2);break}}return d}function ne(t,n){n===void 0&&(n={});var e=n,r=e.placement,s=r===void 0?t.placement:r,i=e.boundary,o=i===void 0?Xe:i,a=e.rootBoundary,d=a===void 0?je:a,c=e.elementContext,u=c===void 0?K:c,m=e.altBoundary,y=m===void 0?!1:m,S=e.padding,O=S===void 0?0:S,k=ft(typeof O!="number"?O:ct(O,G)),g=u===K?Ye:K,v=t.rects.popper,ue=t.elements[y?g:u],L=Gt(Q(ue)?ue:ue.contextElement||I(t.elements.popper),o,d),re=ee(t.elements.reference),le=mt({reference:re,element:v,strategy:"absolute",placement:s}),oe=Te(Object.assign({},v,le)),he=u===K?oe:re,Ie={top:L.top-he.top+k.top,bottom:he.bottom-L.bottom+k.bottom,left:L.left-he.left+k.left,right:he.right-L.right+k.right},ie=t.modifiersData.offset;if(u===K&&ie){var Ne=ie[s];Object.keys(Ie).forEach(function(Ve){var Ce=[W,R].indexOf(Ve)>=0?1:-1,Ue=[E,R].indexOf(Ve)>=0?"y":"x";Ie[Ve]+=Ne[Ue]*Ce})}return Ie}function Jt(t,n){n===void 0&&(n={});var e=n,r=e.placement,s=e.boundary,i=e.rootBoundary,o=e.padding,a=e.flipVariations,d=e.allowedAutoPlacements,c=d===void 0?Ee:d,u=te(r),m=u?a?De:De.filter(function(O){return te(O)===u}):G,y=m.filter(function(O){return c.indexOf(O)>=0});y.length===0&&(y=m);var S=y.reduce(function(O,k){return O[k]=ne(t,{placement:k,boundary:s,rootBoundary:i,padding:o})[q(k)],O},{});return Object.keys(S).sort(function(O,k){return S[O]-S[k]})}function Kt(t){if(q(t)===me)return[];var n=be(t);return[lt(t),n,lt(n)]}function Qt(t){var n=t.state,e=t.options,r=t.name;if(!n.modifiersData[r]._skip){for(var s=e.mainAxis,i=s===void 0?!0:s,o=e.altAxis,a=o===void 0?!0:o,d=e.fallbackPlacements,c=e.padding,u=e.boundary,m=e.rootBoundary,y=e.altBoundary,S=e.flipVariations,O=S===void 0?!0:S,k=e.allowedAutoPlacements,g=n.options.placement,v=q(g),ue=v===g,L=d||(ue||!O?[be(g)]:Kt(g)),re=[g].concat(L).reduce(function(xe,nr){return xe.concat(q(nr)===me?Jt(n,{placement:nr,boundary:u,rootBoundary:m,padding:c,flipVariations:O,allowedAutoPlacements:k}):nr)},[]),le=n.rects.reference,oe=n.rects.popper,he=new Map,Ie=!0,ie=re[0],Ne=0;Ne<re.length;Ne++){var Ve=re[Ne],Ce=q(Ve),Ue=te(Ve)===U,qe=[E,R].indexOf(Ce)>=0,Oe=qe?"width":"height",$e=ne(n,{placement:Ve,boundary:u,rootBoundary:m,altBoundary:y,padding:c}),_e=qe?Ue?W:P:Ue?R:E;le[Oe]>oe[Oe]&&(_e=be(_e));var er=be(_e),Pt=[];if(i&&Pt.push($e[Ce]<=0),a&&Pt.push($e[_e]<=0,$e[er]<=0),Pt.every(function(xe){return xe})){ie=Ve,Ie=!1;break}he.set(Ve,Pt)}if(Ie)for(var ar=O?3:1,pr=function(xe){var nr=re.find(function(ir){var dr=he.get(ir);if(dr)return dr.slice(0,xe).every(function(Lt){return Lt})});if(nr)return ie=nr,"break"},lr=ar;lr>0;lr--){var or=pr(lr);if(or==="break")break}n.placement!==ie&&(n.modifiersData[r]._skip=!0,n.placement=ie,n.reset=!0)}}var vt={name:"flip",enabled:!0,phase:"main",fn:Qt,requiresIfExists:["offset"],data:{_skip:!1}};function gt(t,n,e){return e===void 0&&(e={x:0,y:0}),{top:t.top-n.height-e.y,right:t.right-n.width+e.x,bottom:t.bottom-n.height+e.y,left:t.left-n.width-e.x}}function yt(t){return[E,W,R,P].some(function(n){return t[n]>=0})}function Zt(t){var n=t.state,e=t.name,r=n.rects.reference,s=n.rects.popper,i=n.modifiersData.preventOverflow,o=ne(n,{elementContext:"reference"}),a=ne(n,{altBoundary:!0}),d=gt(o,r),c=gt(a,s,i),u=yt(d),m=yt(c);n.modifiersData[e]={referenceClippingOffsets:d,popperEscapeOffsets:c,isReferenceHidden:u,hasPopperEscaped:m},n.attributes.popper=Object.assign({},n.attributes.popper,{"data-popper-reference-hidden":u,"data-popper-escaped":m})}var bt={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:Zt};function en(t,n,e){var r=q(t),s=[P,E].indexOf(r)>=0?-1:1,i=typeof e=="function"?e(Object.assign({},n,{placement:t})):e,o=i[0],a=i[1];return o=o||0,a=(a||0)*s,[P,W].indexOf(r)>=0?{x:a,y:o}:{x:o,y:a}}function tn(t){var n=t.state,e=t.options,r=t.name,s=e.offset,i=s===void 0?[0,0]:s,o=Ee.reduce(function(u,m){return u[m]=en(m,n.rects,i),u},{}),a=o[n.placement],d=a.x,c=a.y;n.modifiersData.popperOffsets!=null&&(n.modifiersData.popperOffsets.x+=d,n.modifiersData.popperOffsets.y+=c),n.modifiersData[r]=o}var wt={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:tn};function nn(t){var n=t.state,e=t.name;n.modifiersData[e]=mt({reference:n.rects.reference,element:n.rects.popper,strategy:"absolute",placement:n.placement})}var He={name:"popperOffsets",enabled:!0,phase:"read",fn:nn,data:{}};function rn(t){return t==="x"?"y":"x"}function on(t){var n=t.state,e=t.options,r=t.name,s=e.mainAxis,i=s===void 0?!0:s,o=e.altAxis,a=o===void 0?!1:o,d=e.boundary,c=e.rootBoundary,u=e.altBoundary,m=e.padding,y=e.tether,S=y===void 0?!0:y,O=e.tetherOffset,k=O===void 0?0:O,g=ne(n,{boundary:d,rootBoundary:c,padding:m,altBoundary:u}),v=q(n.placement),ue=te(n.placement),L=!ue,re=Le(v),le=rn(re),oe=n.modifiersData.popperOffsets,he=n.rects.reference,Ie=n.rects.popper,ie=typeof k=="function"?k(Object.assign({},n.rects,{placement:n.placement})):k,Ne=typeof ie=="number"?{mainAxis:ie,altAxis:ie}:Object.assign({mainAxis:0,altAxis:0},ie),Ve=n.modifiersData.offset?n.modifiersData.offset[n.placement]:null,Ce={x:0,y:0};if(oe){if(i){var Ue,qe=re==="y"?E:P,Oe=re==="y"?R:W,$e=re==="y"?"height":"width",_e=oe[re],er=_e+g[qe],Pt=_e-g[Oe],ar=S?-Ie[$e]/2:0,pr=ue===U?he[$e]:Ie[$e],lr=ue===U?-Ie[$e]:-he[$e],or=n.elements.arrow,xe=S&&or?ke(or):{width:0,height:0},nr=n.modifiersData["arrow#persistent"]?n.modifiersData["arrow#persistent"].padding:st(),ir=nr[qe],dr=nr[Oe],Lt=fe(0,he[$e],xe[$e]),cr=L?he[$e]/2-ar-Lt-ir-Ne.mainAxis:pr-Lt-ir-Ne.mainAxis,mr=L?-he[$e]/2+ar+Lt+dr+Ne.mainAxis:lr+Lt+dr+Ne.mainAxis,tr=n.elements.arrow&&se(n.elements.arrow),At=tr?re==="y"?tr.clientTop||0:tr.clientLeft||0:0,kt=(Ue=Ve==null?void 0:Ve[re])!=null?Ue:0,Dt=_e+cr-kt-At,gr=_e+mr-kt,yr=fe(S?ve(er,Dt):er,_e,S?X(Pt,gr):Pt);oe[re]=yr,Ce[re]=yr-_e}if(a){var vr,Ir=re==="x"?E:P,Mr=re==="x"?R:W,Ar=oe[le],Fr=le==="y"?"height":"width",Dr=Ar+g[Ir],Or=Ar-g[Mr],Sn=[E,P].indexOf(v)!==-1,Rr=(vr=Ve==null?void 0:Ve[le])!=null?vr:0,Wr=Sn?Dr:Ar-he[Fr]-Ie[Fr]-Rr+Ne.altAxis,Er=Sn?Ar+he[Fr]+Ie[Fr]-Rr-Ne.altAxis:Or,Ur=S&&Sn?St(Wr,Ar,Er):fe(S?Wr:Dr,Ar,S?Er:Or);oe[le]=Ur,Ce[le]=Ur-Ar}n.modifiersData[r]=Ce}}var xt={name:"preventOverflow",enabled:!0,phase:"main",fn:on,requiresIfExists:["offset"]};function an(t){return{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}}function sn(t){return t===H(t)||!B(t)?We(t):an(t)}function fn(t){var n=t.getBoundingClientRect(),e=Z(n.width)/t.offsetWidth||1,r=Z(n.height)/t.offsetHeight||1;return e!==1||r!==1}function cn(t,n,e){e===void 0&&(e=!1);var r=B(n),s=B(n)&&fn(n),i=I(n),o=ee(t,s),a={scrollLeft:0,scrollTop:0},d={x:0,y:0};return(r||!r&&!e)&&((C(n)!=="body"||Se(i))&&(a=sn(n)),B(n)?(d=ee(n,!0),d.x+=n.clientLeft,d.y+=n.clientTop):i&&(d.x=Be(i))),{x:o.left+a.scrollLeft-d.x,y:o.top+a.scrollTop-d.y,width:o.width,height:o.height}}function pn(t){var n=new Map,e=new Set,r=[];t.forEach(function(i){n.set(i.name,i)});function s(i){e.add(i.name);var o=[].concat(i.requires||[],i.requiresIfExists||[]);o.forEach(function(a){if(!e.has(a)){var d=n.get(a);d&&s(d)}}),r.push(i)}return t.forEach(function(i){e.has(i.name)||s(i)}),r}function un(t){var n=pn(t);return ot.reduce(function(e,r){return e.concat(n.filter(function(s){return s.phase===r}))},[])}function ln(t){var n;return function(){return n||(n=new Promise(function(e){Promise.resolve().then(function(){n=void 0,e(t())})})),n}}function dn(t){var n=t.reduce(function(e,r){var s=e[r.name];return e[r.name]=s?Object.assign({},s,r,{options:Object.assign({},s.options,r.options),data:Object.assign({},s.data,r.data)}):r,e},{});return Object.keys(n).map(function(e){return n[e]})}var Ot={placement:"bottom",modifiers:[],strategy:"absolute"};function $t(){for(var t=arguments.length,n=new Array(t),e=0;e<t;e++)n[e]=arguments[e];return!n.some(function(r){return!(r&&typeof r.getBoundingClientRect=="function")})}function we(t){t===void 0&&(t={});var n=t,e=n.defaultModifiers,r=e===void 0?[]:e,s=n.defaultOptions,i=s===void 0?Ot:s;return function(o,a,d){d===void 0&&(d=i);var c={placement:"bottom",orderedModifiers:[],options:Object.assign({},Ot,i),modifiersData:{},elements:{reference:o,popper:a},attributes:{},styles:{}},u=[],m=!1,y={state:c,setOptions:function(k){var g=typeof k=="function"?k(c.options):k;O(),c.options=Object.assign({},i,c.options,g),c.scrollParents={reference:Q(o)?ce(o):o.contextElement?ce(o.contextElement):[],popper:ce(a)};var v=un(dn([].concat(r,c.options.modifiers)));return c.orderedModifiers=v.filter(function(ue){return ue.enabled}),S(),y.update()},forceUpdate:function(){if(!m){var k=c.elements,g=k.reference,v=k.popper;if($t(g,v)){c.rects={reference:cn(g,se(v),c.options.strategy==="fixed"),popper:ke(v)},c.reset=!1,c.placement=c.options.placement,c.orderedModifiers.forEach(function(Ie){return c.modifiersData[Ie.name]=Object.assign({},Ie.data)});for(var ue=0;ue<c.orderedModifiers.length;ue++){if(c.reset===!0){c.reset=!1,ue=-1;continue}var L=c.orderedModifiers[ue],re=L.fn,le=L.options,oe=le===void 0?{}:le,he=L.name;typeof re=="function"&&(c=re({state:c,options:oe,name:he,instance:y})||c)}}}},update:ln(function(){return new Promise(function(k){y.forceUpdate(),k(c)})}),destroy:function(){O(),m=!0}};if(!$t(o,a))return y;y.setOptions(d).then(function(k){!m&&d.onFirstUpdate&&d.onFirstUpdate(k)});function S(){c.orderedModifiers.forEach(function(k){var g=k.name,v=k.options,ue=v===void 0?{}:v,L=k.effect;if(typeof L=="function"){var re=L({state:c,name:g,instance:y,options:ue}),le=function(){};u.push(re||le)}})}function O(){u.forEach(function(k){return k()}),u=[]}return y}}we();var mn=[Re,He,Me,Ae];we({defaultModifiers:mn});var gn=[Re,He,Me,Ae,wt,vt,xt,pt,bt],yn=we({defaultModifiers:gn});const usePopper=(t,n,e={})=>{const r={name:"updateState",enabled:!0,phase:"write",fn:({state:d})=>{const c=deriveState(d);Object.assign(o.value,c)},requires:["computeStyles"]},s=computed(()=>{const{onFirstUpdate:d,placement:c,strategy:u,modifiers:m}=unref(e);return{onFirstUpdate:d,placement:c||"bottom",strategy:u||"absolute",modifiers:[...m||[],r,{name:"applyStyles",enabled:!1}]}}),i=shallowRef(),o=ref({styles:{popper:{position:unref(s).strategy,left:"0",top:"0"},arrow:{position:"absolute"}},attributes:{}}),a=()=>{i.value&&(i.value.destroy(),i.value=void 0)};return watch(s,d=>{const c=unref(i);c&&c.setOptions(d)},{deep:!0}),watch([t,n],([d,c])=>{a(),!(!d||!c)&&(i.value=yn(d,c,unref(s)))}),onBeforeUnmount(()=>{a()}),{state:computed(()=>{var d;return{...((d=unref(i))==null?void 0:d.state)||{}}}),styles:computed(()=>unref(o).styles),attributes:computed(()=>unref(o).attributes),update:()=>{var d;return(d=unref(i))==null?void 0:d.update()},forceUpdate:()=>{var d;return(d=unref(i))==null?void 0:d.forceUpdate()},instanceRef:computed(()=>unref(i))}};function deriveState(t){const n=Object.keys(t.elements),e=fromPairs(n.map(s=>[s,t.styles[s]||{}])),r=fromPairs(n.map(s=>[s,t.attributes[s]]));return{styles:e,attributes:r}}const useSameTarget=t=>{if(!t)return{onClick:NOOP,onMousedown:NOOP,onMouseup:NOOP};let n=!1,e=!1;return{onClick:o=>{n&&e&&t(o),n=e=!1},onMousedown:o=>{n=o.target===o.currentTarget},onMouseup:o=>{e=o.target===o.currentTarget}}};function useTimeout(){let t;const n=(r,s)=>{e(),t=window.setTimeout(r,s)},e=()=>window.clearTimeout(t);return tryOnScopeDispose(()=>e()),{registerTimeout:n,cancelTimeout:e}}const defaultIdInjection={prefix:Math.floor(Math.random()*1e4),current:0},ID_INJECTION_KEY=Symbol("elIdInjection"),useIdInjection=()=>getCurrentInstance()?inject(ID_INJECTION_KEY,defaultIdInjection):defaultIdInjection,useId=t=>{const n=useIdInjection(),e=useGetDerivedNamespace();return computed(()=>unref(t)||`${e.value}-id-${n.prefix}-${n.current++}`)};let registeredEscapeHandlers=[];const cachedHandler=t=>{const n=t;n.key===EVENT_CODE.esc&&registeredEscapeHandlers.forEach(e=>e(n))},useEscapeKeydown=t=>{onMounted(()=>{registeredEscapeHandlers.length===0&&document.addEventListener("keydown",cachedHandler),isClient&&registeredEscapeHandlers.push(t)}),onBeforeUnmount(()=>{registeredEscapeHandlers=registeredEscapeHandlers.filter(n=>n!==t),registeredEscapeHandlers.length===0&&isClient&&document.removeEventListener("keydown",cachedHandler)})};let cachedContainer;const usePopperContainerId=()=>{const t=useGetDerivedNamespace(),n=useIdInjection(),e=computed(()=>`${t.value}-popper-container-${n.prefix}`),r=computed(()=>`#${e.value}`);return{id:e,selector:r}},createContainer=t=>{const n=document.createElement("div");return n.id=t,document.body.appendChild(n),n},usePopperContainer=()=>{const{id:t,selector:n}=usePopperContainerId();return onBeforeMount(()=>{isClient&&!cachedContainer&&!document.body.querySelector(n.value)&&(cachedContainer=createContainer(t.value))}),{id:t,selector:n}},useDelayedToggleProps=buildProps({showAfter:{type:Number,default:0},hideAfter:{type:Number,default:200},autoClose:{type:Number,default:0}}),useDelayedToggle=({showAfter:t,hideAfter:n,autoClose:e,open:r,close:s})=>{const{registerTimeout:i}=useTimeout(),{registerTimeout:o,cancelTimeout:a}=useTimeout();return{onOpen:u=>{i(()=>{r(u);const m=unref(e);isNumber$1(m)&&m>0&&o(()=>{s(u)},m)},unref(t))},onClose:u=>{a(),i(()=>{s(u)},unref(n))}}},FORWARD_REF_INJECTION_KEY=Symbol("elForwardRef"),useForwardRef=t=>{provide(FORWARD_REF_INJECTION_KEY,{setForwardRef:e=>{t.value=e}})},useForwardRefDirective=t=>({mounted(n){t(n)},updated(n){t(n)},unmounted(){t(null)}}),zIndex=ref(0),defaultInitialZIndex=2e3,zIndexContextKey=Symbol("zIndexContextKey"),useZIndex=t=>{const n=t||(getCurrentInstance()?inject(zIndexContextKey,void 0):void 0),e=computed(()=>{const i=unref(n);return isNumber$1(i)?i:defaultInitialZIndex}),r=computed(()=>e.value+zIndex.value);return{initialZIndex:e,currentZIndex:r,nextZIndex:()=>(zIndex.value++,r.value)}};function useCursor(t){const n=ref();function e(){if(t.value==null)return;const{selectionStart:s,selectionEnd:i,value:o}=t.value;if(s==null||i==null)return;const a=o.slice(0,Math.max(0,s)),d=o.slice(Math.max(0,i));n.value={selectionStart:s,selectionEnd:i,value:o,beforeTxt:a,afterTxt:d}}function r(){if(t.value==null||n.value==null)return;const{value:s}=t.value,{beforeTxt:i,afterTxt:o,selectionStart:a}=n.value;if(i==null||o==null||a==null)return;let d=s.length;if(s.endsWith(o))d=s.length-o.length;else if(s.startsWith(i))d=i.length;else{const c=i[a-1],u=s.indexOf(c,a-1);u!==-1&&(d=u+1)}t.value.setSelectionRange(d,d)}return[e,r]}const useSizeProp=buildProp({type:String,values:componentSizes,required:!1}),SIZE_INJECTION_KEY=Symbol("size"),useGlobalSize=()=>{const t=inject(SIZE_INJECTION_KEY,{});return computed(()=>unref(t.size)||"")};function useFocusController(t,{afterFocus:n,beforeBlur:e,afterBlur:r}={}){const s=getCurrentInstance(),{emit:i}=s,o=shallowRef(),a=ref(!1),d=m=>{a.value||(a.value=!0,i("focus",m),n==null||n())},c=m=>{var y;isFunction$2(e)&&e(m)||m.relatedTarget&&((y=o.value)!=null&&y.contains(m.relatedTarget))||(a.value=!1,i("blur",m),r==null||r())},u=()=>{var m;(m=t.value)==null||m.focus()};return watch(o,m=>{m&&m.setAttribute("tabindex","-1")}),useEventListener(o,"click",u),{wrapperRef:o,isFocused:a,handleFocus:d,handleBlur:c}}const configProviderContextKey=Symbol(),globalConfig=ref();function useGlobalConfig(t,n=void 0){const e=getCurrentInstance()?inject(configProviderContextKey,globalConfig):globalConfig;return t?computed(()=>{var r,s;return(s=(r=e.value)==null?void 0:r[t])!=null?s:n}):e}function useGlobalComponentSettings(t,n){const e=useGlobalConfig(),r=useNamespace(t,computed(()=>{var a;return((a=e.value)==null?void 0:a.namespace)||defaultNamespace})),s=useLocale(computed(()=>{var a;return(a=e.value)==null?void 0:a.locale})),i=useZIndex(computed(()=>{var a;return((a=e.value)==null?void 0:a.zIndex)||defaultInitialZIndex})),o=computed(()=>{var a;return unref(n)||((a=e.value)==null?void 0:a.size)||""});return provideGlobalConfig(computed(()=>unref(e)||{})),{ns:r,locale:s,zIndex:i,size:o}}const provideGlobalConfig=(t,n,e=!1)=>{var r;const s=!!getCurrentInstance(),i=s?useGlobalConfig():void 0,o=(r=n==null?void 0:n.provide)!=null?r:s?provide:void 0;if(!o)return;const a=computed(()=>{const d=unref(t);return i!=null&&i.value?mergeConfig$1(i.value,d):d});return o(configProviderContextKey,a),o(localeContextKey,computed(()=>a.value.locale)),o(namespaceContextKey,computed(()=>a.value.namespace)),o(zIndexContextKey,computed(()=>a.value.zIndex)),o(SIZE_INJECTION_KEY,{size:computed(()=>a.value.size||"")}),(e||!globalConfig.value)&&(globalConfig.value=a.value),a},mergeConfig$1=(t,n)=>{var e;const r=[...new Set([...keysOf(t),...keysOf(n)])],s={};for(const i of r)s[i]=(e=n[i])!=null?e:t[i];return s},messageConfig={};var _export_sfc=(t,n)=>{const e=t.__vccOpts||t;for(const[r,s]of n)e[r]=s;return e};const iconProps=buildProps({size:{type:definePropType([Number,String])},color:{type:String}}),__default__$m=defineComponent({name:"ElIcon",inheritAttrs:!1}),_sfc_main$B=defineComponent({...__default__$m,props:iconProps,setup(t){const n=t,e=useNamespace("icon"),r=computed(()=>{const{size:s,color:i}=n;return!s&&!i?{}:{fontSize:isUndefined$1(s)?void 0:addUnit(s),"--color":i}});return(s,i)=>(openBlock(),createElementBlock("i",mergeProps({class:unref(e).b(),style:unref(r)},s.$attrs),[renderSlot(s.$slots,"default")],16))}});var Icon=_export_sfc(_sfc_main$B,[["__file","icon.vue"]]);const ElIcon=withInstall(Icon),formContextKey=Symbol("formContextKey"),formItemContextKey=Symbol("formItemContextKey"),useFormSize=(t,n={})=>{const e=ref(void 0),r=n.prop?e:useProp("size"),s=n.global?e:useGlobalSize(),i=n.form?{size:void 0}:inject(formContextKey,void 0),o=n.formItem?{size:void 0}:inject(formItemContextKey,void 0);return computed(()=>r.value||unref(t)||(o==null?void 0:o.size)||(i==null?void 0:i.size)||s.value||"")},useFormDisabled=t=>{const n=useProp("disabled"),e=inject(formContextKey,void 0);return computed(()=>n.value||unref(t)||(e==null?void 0:e.disabled)||!1)},useFormItem=()=>{const t=inject(formContextKey,void 0),n=inject(formItemContextKey,void 0);return{form:t,formItem:n}},useFormItemInputId=(t,{formItemContext:n,disableIdGeneration:e,disableIdManagement:r})=>{e||(e=ref(!1)),r||(r=ref(!1));const s=ref();let i;const o=computed(()=>{var a;return!!(!t.label&&n&&n.inputIds&&((a=n.inputIds)==null?void 0:a.length)<=1)});return onMounted(()=>{i=watch([toRef(t,"id"),e],([a,d])=>{const c=a??(d?void 0:useId().value);c!==s.value&&(n!=null&&n.removeInputId&&(s.value&&n.removeInputId(s.value),!(r!=null&&r.value)&&!d&&c&&n.addInputId(c)),s.value=c)},{immediate:!0})}),onUnmounted(()=>{i&&i(),n!=null&&n.removeInputId&&s.value&&n.removeInputId(s.value)}),{isLabeledByFormItem:o,inputId:s}};let hiddenTextarea;const HIDDEN_STYLE=`
  height:0 !important;
  visibility:hidden !important;
  ${isFirefox()?"":"overflow:hidden !important;"}
  position:absolute !important;
  z-index:-1000 !important;
  top:0 !important;
  right:0 !important;
`,CONTEXT_STYLE=["letter-spacing","line-height","padding-top","padding-bottom","font-family","font-weight","font-size","text-rendering","text-transform","width","text-indent","padding-left","padding-right","border-width","box-sizing"];function calculateNodeStyling(t){const n=window.getComputedStyle(t),e=n.getPropertyValue("box-sizing"),r=Number.parseFloat(n.getPropertyValue("padding-bottom"))+Number.parseFloat(n.getPropertyValue("padding-top")),s=Number.parseFloat(n.getPropertyValue("border-bottom-width"))+Number.parseFloat(n.getPropertyValue("border-top-width"));return{contextStyle:CONTEXT_STYLE.map(o=>`${o}:${n.getPropertyValue(o)}`).join(";"),paddingSize:r,borderSize:s,boxSizing:e}}function calcTextareaHeight(t,n=1,e){var r;hiddenTextarea||(hiddenTextarea=document.createElement("textarea"),document.body.appendChild(hiddenTextarea));const{paddingSize:s,borderSize:i,boxSizing:o,contextStyle:a}=calculateNodeStyling(t);hiddenTextarea.setAttribute("style",`${a};${HIDDEN_STYLE}`),hiddenTextarea.value=t.value||t.placeholder||"";let d=hiddenTextarea.scrollHeight;const c={};o==="border-box"?d=d+i:o==="content-box"&&(d=d-s),hiddenTextarea.value="";const u=hiddenTextarea.scrollHeight-s;if(isNumber$1(n)){let m=u*n;o==="border-box"&&(m=m+s+i),d=Math.max(m,d),c.minHeight=`${m}px`}if(isNumber$1(e)){let m=u*e;o==="border-box"&&(m=m+s+i),d=Math.min(m,d)}return c.height=`${d}px`,(r=hiddenTextarea.parentNode)==null||r.removeChild(hiddenTextarea),hiddenTextarea=void 0,c}const inputProps=buildProps({id:{type:String,default:void 0},size:useSizeProp,disabled:Boolean,modelValue:{type:definePropType([String,Number,Object]),default:""},maxlength:{type:[String,Number]},minlength:{type:[String,Number]},type:{type:String,default:"text"},resize:{type:String,values:["none","both","horizontal","vertical"]},autosize:{type:definePropType([Boolean,Object]),default:!1},autocomplete:{type:String,default:"off"},formatter:{type:Function},parser:{type:Function},placeholder:{type:String},form:{type:String},readonly:{type:Boolean,default:!1},clearable:{type:Boolean,default:!1},showPassword:{type:Boolean,default:!1},showWordLimit:{type:Boolean,default:!1},suffixIcon:{type:iconPropType},prefixIcon:{type:iconPropType},containerRole:{type:String,default:void 0},label:{type:String,default:void 0},tabindex:{type:[String,Number],default:0},validateEvent:{type:Boolean,default:!0},inputStyle:{type:definePropType([Object,Array,String]),default:()=>mutable({})},autofocus:{type:Boolean,default:!1}}),inputEmits={[UPDATE_MODEL_EVENT]:t=>isString$2(t),input:t=>isString$2(t),change:t=>isString$2(t),focus:t=>t instanceof FocusEvent,blur:t=>t instanceof FocusEvent,clear:()=>!0,mouseleave:t=>t instanceof MouseEvent,mouseenter:t=>t instanceof MouseEvent,keydown:t=>t instanceof Event,compositionstart:t=>t instanceof CompositionEvent,compositionupdate:t=>t instanceof CompositionEvent,compositionend:t=>t instanceof CompositionEvent},_hoisted_1$9=["role"],_hoisted_2$5=["id","minlength","maxlength","type","disabled","readonly","autocomplete","tabindex","aria-label","placeholder","form","autofocus"],_hoisted_3$2=["id","minlength","maxlength","tabindex","disabled","readonly","autocomplete","aria-label","placeholder","form","autofocus"],__default__$l=defineComponent({name:"ElInput",inheritAttrs:!1}),_sfc_main$A=defineComponent({...__default__$l,props:inputProps,emits:inputEmits,setup(t,{expose:n,emit:e}){const r=t,s=useAttrs$1(),i=useSlots(),o=computed(()=>{const Rr={};return r.containerRole==="combobox"&&(Rr["aria-haspopup"]=s["aria-haspopup"],Rr["aria-owns"]=s["aria-owns"],Rr["aria-expanded"]=s["aria-expanded"]),Rr}),a=computed(()=>[r.type==="textarea"?g.b():k.b(),k.m(S.value),k.is("disabled",O.value),k.is("exceed",xe.value),{[k.b("group")]:i.prepend||i.append,[k.bm("group","append")]:i.append,[k.bm("group","prepend")]:i.prepend,[k.m("prefix")]:i.prefix||r.prefixIcon,[k.m("suffix")]:i.suffix||r.suffixIcon||r.clearable||r.showPassword,[k.bm("suffix","password-clear")]:ar.value&&pr.value},s.class]),d=computed(()=>[k.e("wrapper"),k.is("focus",Ne.value)]),c=useAttrs({excludeKeys:computed(()=>Object.keys(o.value))}),{form:u,formItem:m}=useFormItem(),{inputId:y}=useFormItemInputId(r,{formItemContext:m}),S=useFormSize(),O=useFormDisabled(),k=useNamespace("input"),g=useNamespace("textarea"),v=shallowRef(),ue=shallowRef(),L=ref(!1),re=ref(!1),le=ref(!1),oe=ref(),he=shallowRef(r.inputStyle),Ie=computed(()=>v.value||ue.value),{wrapperRef:ie,isFocused:Ne,handleFocus:Ve,handleBlur:Ce}=useFocusController(Ie,{afterBlur(){var Rr;r.validateEvent&&((Rr=m==null?void 0:m.validate)==null||Rr.call(m,"blur").catch(Wr=>void 0))}}),Ue=computed(()=>{var Rr;return(Rr=u==null?void 0:u.statusIcon)!=null?Rr:!1}),qe=computed(()=>(m==null?void 0:m.validateState)||""),Oe=computed(()=>qe.value&&ValidateComponentsMap[qe.value]),$e=computed(()=>le.value?view_default:hide_default),_e=computed(()=>[s.style]),er=computed(()=>[r.inputStyle,he.value,{resize:r.resize}]),Pt=computed(()=>isNil(r.modelValue)?"":String(r.modelValue)),ar=computed(()=>r.clearable&&!O.value&&!r.readonly&&!!Pt.value&&(Ne.value||L.value)),pr=computed(()=>r.showPassword&&!O.value&&!r.readonly&&!!Pt.value&&(!!Pt.value||Ne.value)),lr=computed(()=>r.showWordLimit&&!!r.maxlength&&(r.type==="text"||r.type==="textarea")&&!O.value&&!r.readonly&&!r.showPassword),or=computed(()=>Pt.value.length),xe=computed(()=>!!lr.value&&or.value>Number(r.maxlength)),nr=computed(()=>!!i.suffix||!!r.suffixIcon||ar.value||r.showPassword||lr.value||!!qe.value&&Ue.value),[ir,dr]=useCursor(v);useResizeObserver(ue,Rr=>{if(mr(),!lr.value||r.resize!=="both")return;const Wr=Rr[0],{width:Er}=Wr.contentRect;oe.value={right:`calc(100% - ${Er+15+6}px)`}});const Lt=()=>{const{type:Rr,autosize:Wr}=r;if(!(!isClient||Rr!=="textarea"||!ue.value))if(Wr){const Er=isObject$2(Wr)?Wr.minRows:void 0,Ur=isObject$2(Wr)?Wr.maxRows:void 0,Zr=calcTextareaHeight(ue.value,Er,Ur);he.value={overflowY:"hidden",...Zr},nextTick(()=>{ue.value.offsetHeight,he.value=Zr})}else he.value={minHeight:calcTextareaHeight(ue.value).minHeight}},mr=(Rr=>{let Wr=!1;return()=>{var Er;if(Wr||!r.autosize)return;((Er=ue.value)==null?void 0:Er.offsetParent)===null||(Rr(),Wr=!0)}})(Lt),tr=()=>{const Rr=Ie.value,Wr=r.formatter?r.formatter(Pt.value):Pt.value;!Rr||Rr.value===Wr||(Rr.value=Wr)},At=async Rr=>{ir();let{value:Wr}=Rr.target;if(r.formatter&&(Wr=r.parser?r.parser(Wr):Wr),!re.value){if(Wr===Pt.value){tr();return}e(UPDATE_MODEL_EVENT,Wr),e("input",Wr),await nextTick(),tr(),dr()}},kt=Rr=>{e("change",Rr.target.value)},Dt=Rr=>{e("compositionstart",Rr),re.value=!0},gr=Rr=>{var Wr;e("compositionupdate",Rr);const Er=(Wr=Rr.target)==null?void 0:Wr.value,Ur=Er[Er.length-1]||"";re.value=!isKorean(Ur)},yr=Rr=>{e("compositionend",Rr),re.value&&(re.value=!1,At(Rr))},vr=()=>{le.value=!le.value,Ir()},Ir=async()=>{var Rr;await nextTick(),(Rr=Ie.value)==null||Rr.focus()},Mr=()=>{var Rr;return(Rr=Ie.value)==null?void 0:Rr.blur()},Ar=Rr=>{L.value=!1,e("mouseleave",Rr)},Fr=Rr=>{L.value=!0,e("mouseenter",Rr)},Dr=Rr=>{e("keydown",Rr)},Or=()=>{var Rr;(Rr=Ie.value)==null||Rr.select()},Sn=()=>{e(UPDATE_MODEL_EVENT,""),e("change",""),e("clear"),e("input","")};return watch(()=>r.modelValue,()=>{var Rr;nextTick(()=>Lt()),r.validateEvent&&((Rr=m==null?void 0:m.validate)==null||Rr.call(m,"change").catch(Wr=>void 0))}),watch(Pt,()=>tr()),watch(()=>r.type,async()=>{await nextTick(),tr(),Lt()}),onMounted(()=>{!r.formatter&&r.parser,tr(),nextTick(Lt)}),n({input:v,textarea:ue,ref:Ie,textareaStyle:er,autosize:toRef(r,"autosize"),focus:Ir,blur:Mr,select:Or,clear:Sn,resizeTextarea:Lt}),(Rr,Wr)=>withDirectives((openBlock(),createElementBlock("div",mergeProps(unref(o),{class:unref(a),style:unref(_e),role:Rr.containerRole,onMouseenter:Fr,onMouseleave:Ar}),[createCommentVNode(" input "),Rr.type!=="textarea"?(openBlock(),createElementBlock(Fragment,{key:0},[createCommentVNode(" prepend slot "),Rr.$slots.prepend?(openBlock(),createElementBlock("div",{key:0,class:normalizeClass(unref(k).be("group","prepend"))},[renderSlot(Rr.$slots,"prepend")],2)):createCommentVNode("v-if",!0),createBaseVNode("div",{ref_key:"wrapperRef",ref:ie,class:normalizeClass(unref(d))},[createCommentVNode(" prefix slot "),Rr.$slots.prefix||Rr.prefixIcon?(openBlock(),createElementBlock("span",{key:0,class:normalizeClass(unref(k).e("prefix"))},[createBaseVNode("span",{class:normalizeClass(unref(k).e("prefix-inner"))},[renderSlot(Rr.$slots,"prefix"),Rr.prefixIcon?(openBlock(),createBlock(unref(ElIcon),{key:0,class:normalizeClass(unref(k).e("icon"))},{default:withCtx(()=>[(openBlock(),createBlock(resolveDynamicComponent(Rr.prefixIcon)))]),_:1},8,["class"])):createCommentVNode("v-if",!0)],2)],2)):createCommentVNode("v-if",!0),createBaseVNode("input",mergeProps({id:unref(y),ref_key:"input",ref:v,class:unref(k).e("inner")},unref(c),{minlength:Rr.minlength,maxlength:Rr.maxlength,type:Rr.showPassword?le.value?"text":"password":Rr.type,disabled:unref(O),readonly:Rr.readonly,autocomplete:Rr.autocomplete,tabindex:Rr.tabindex,"aria-label":Rr.label,placeholder:Rr.placeholder,style:Rr.inputStyle,form:Rr.form,autofocus:Rr.autofocus,onCompositionstart:Dt,onCompositionupdate:gr,onCompositionend:yr,onInput:At,onFocus:Wr[0]||(Wr[0]=(...Er)=>unref(Ve)&&unref(Ve)(...Er)),onBlur:Wr[1]||(Wr[1]=(...Er)=>unref(Ce)&&unref(Ce)(...Er)),onChange:kt,onKeydown:Dr}),null,16,_hoisted_2$5),createCommentVNode(" suffix slot "),unref(nr)?(openBlock(),createElementBlock("span",{key:1,class:normalizeClass(unref(k).e("suffix"))},[createBaseVNode("span",{class:normalizeClass(unref(k).e("suffix-inner"))},[!unref(ar)||!unref(pr)||!unref(lr)?(openBlock(),createElementBlock(Fragment,{key:0},[renderSlot(Rr.$slots,"suffix"),Rr.suffixIcon?(openBlock(),createBlock(unref(ElIcon),{key:0,class:normalizeClass(unref(k).e("icon"))},{default:withCtx(()=>[(openBlock(),createBlock(resolveDynamicComponent(Rr.suffixIcon)))]),_:1},8,["class"])):createCommentVNode("v-if",!0)],64)):createCommentVNode("v-if",!0),unref(ar)?(openBlock(),createBlock(unref(ElIcon),{key:1,class:normalizeClass([unref(k).e("icon"),unref(k).e("clear")]),onMousedown:withModifiers(unref(NOOP),["prevent"]),onClick:Sn},{default:withCtx(()=>[createVNode(unref(circle_close_default))]),_:1},8,["class","onMousedown"])):createCommentVNode("v-if",!0),unref(pr)?(openBlock(),createBlock(unref(ElIcon),{key:2,class:normalizeClass([unref(k).e("icon"),unref(k).e("password")]),onClick:vr},{default:withCtx(()=>[(openBlock(),createBlock(resolveDynamicComponent(unref($e))))]),_:1},8,["class"])):createCommentVNode("v-if",!0),unref(lr)?(openBlock(),createElementBlock("span",{key:3,class:normalizeClass(unref(k).e("count"))},[createBaseVNode("span",{class:normalizeClass(unref(k).e("count-inner"))},toDisplayString(unref(or))+" / "+toDisplayString(Rr.maxlength),3)],2)):createCommentVNode("v-if",!0),unref(qe)&&unref(Oe)&&unref(Ue)?(openBlock(),createBlock(unref(ElIcon),{key:4,class:normalizeClass([unref(k).e("icon"),unref(k).e("validateIcon"),unref(k).is("loading",unref(qe)==="validating")])},{default:withCtx(()=>[(openBlock(),createBlock(resolveDynamicComponent(unref(Oe))))]),_:1},8,["class"])):createCommentVNode("v-if",!0)],2)],2)):createCommentVNode("v-if",!0)],2),createCommentVNode(" append slot "),Rr.$slots.append?(openBlock(),createElementBlock("div",{key:1,class:normalizeClass(unref(k).be("group","append"))},[renderSlot(Rr.$slots,"append")],2)):createCommentVNode("v-if",!0)],64)):(openBlock(),createElementBlock(Fragment,{key:1},[createCommentVNode(" textarea "),createBaseVNode("textarea",mergeProps({id:unref(y),ref_key:"textarea",ref:ue,class:unref(g).e("inner")},unref(c),{minlength:Rr.minlength,maxlength:Rr.maxlength,tabindex:Rr.tabindex,disabled:unref(O),readonly:Rr.readonly,autocomplete:Rr.autocomplete,style:unref(er),"aria-label":Rr.label,placeholder:Rr.placeholder,form:Rr.form,autofocus:Rr.autofocus,onCompositionstart:Dt,onCompositionupdate:gr,onCompositionend:yr,onInput:At,onFocus:Wr[2]||(Wr[2]=(...Er)=>unref(Ve)&&unref(Ve)(...Er)),onBlur:Wr[3]||(Wr[3]=(...Er)=>unref(Ce)&&unref(Ce)(...Er)),onChange:kt,onKeydown:Dr}),null,16,_hoisted_3$2),unref(lr)?(openBlock(),createElementBlock("span",{key:0,style:normalizeStyle(oe.value),class:normalizeClass(unref(k).e("count"))},toDisplayString(unref(or))+" / "+toDisplayString(Rr.maxlength),7)):createCommentVNode("v-if",!0)],64))],16,_hoisted_1$9)),[[vShow,Rr.type!=="hidden"]])}});var Input=_export_sfc(_sfc_main$A,[["__file","input.vue"]]);const ElInput=withInstall(Input),GAP=4,BAR_MAP={vertical:{offset:"offsetHeight",scroll:"scrollTop",scrollSize:"scrollHeight",size:"height",key:"vertical",axis:"Y",client:"clientY",direction:"top"},horizontal:{offset:"offsetWidth",scroll:"scrollLeft",scrollSize:"scrollWidth",size:"width",key:"horizontal",axis:"X",client:"clientX",direction:"left"}},renderThumbStyle=({move:t,size:n,bar:e})=>({[e.size]:n,transform:`translate${e.axis}(${t}%)`}),scrollbarContextKey=Symbol("scrollbarContextKey"),thumbProps=buildProps({vertical:Boolean,size:String,move:Number,ratio:{type:Number,required:!0},always:Boolean}),COMPONENT_NAME$1="Thumb",_sfc_main$z=defineComponent({__name:"thumb",props:thumbProps,setup(t){const n=t,e=inject(scrollbarContextKey),r=useNamespace("scrollbar");e||throwError(COMPONENT_NAME$1,"can not inject scrollbar context");const s=ref(),i=ref(),o=ref({}),a=ref(!1);let d=!1,c=!1,u=isClient?document.onselectstart:null;const m=computed(()=>BAR_MAP[n.vertical?"vertical":"horizontal"]),y=computed(()=>renderThumbStyle({size:n.size,move:n.move,bar:m.value})),S=computed(()=>s.value[m.value.offset]**2/e.wrapElement[m.value.scrollSize]/n.ratio/i.value[m.value.offset]),O=oe=>{var he;if(oe.stopPropagation(),oe.ctrlKey||[1,2].includes(oe.button))return;(he=window.getSelection())==null||he.removeAllRanges(),g(oe);const Ie=oe.currentTarget;Ie&&(o.value[m.value.axis]=Ie[m.value.offset]-(oe[m.value.client]-Ie.getBoundingClientRect()[m.value.direction]))},k=oe=>{if(!i.value||!s.value||!e.wrapElement)return;const he=Math.abs(oe.target.getBoundingClientRect()[m.value.direction]-oe[m.value.client]),Ie=i.value[m.value.offset]/2,ie=(he-Ie)*100*S.value/s.value[m.value.offset];e.wrapElement[m.value.scroll]=ie*e.wrapElement[m.value.scrollSize]/100},g=oe=>{oe.stopImmediatePropagation(),d=!0,document.addEventListener("mousemove",v),document.addEventListener("mouseup",ue),u=document.onselectstart,document.onselectstart=()=>!1},v=oe=>{if(!s.value||!i.value||d===!1)return;const he=o.value[m.value.axis];if(!he)return;const Ie=(s.value.getBoundingClientRect()[m.value.direction]-oe[m.value.client])*-1,ie=i.value[m.value.offset]-he,Ne=(Ie-ie)*100*S.value/s.value[m.value.offset];e.wrapElement[m.value.scroll]=Ne*e.wrapElement[m.value.scrollSize]/100},ue=()=>{d=!1,o.value[m.value.axis]=0,document.removeEventListener("mousemove",v),document.removeEventListener("mouseup",ue),le(),c&&(a.value=!1)},L=()=>{c=!1,a.value=!!n.size},re=()=>{c=!0,a.value=d};onBeforeUnmount(()=>{le(),document.removeEventListener("mouseup",ue)});const le=()=>{document.onselectstart!==u&&(document.onselectstart=u)};return useEventListener(toRef(e,"scrollbarElement"),"mousemove",L),useEventListener(toRef(e,"scrollbarElement"),"mouseleave",re),(oe,he)=>(openBlock(),createBlock(Transition,{name:unref(r).b("fade"),persisted:""},{default:withCtx(()=>[withDirectives(createBaseVNode("div",{ref_key:"instance",ref:s,class:normalizeClass([unref(r).e("bar"),unref(r).is(unref(m).key)]),onMousedown:k},[createBaseVNode("div",{ref_key:"thumb",ref:i,class:normalizeClass(unref(r).e("thumb")),style:normalizeStyle(unref(y)),onMousedown:O},null,38)],34),[[vShow,oe.always||a.value]])]),_:1},8,["name"]))}});var Thumb=_export_sfc(_sfc_main$z,[["__file","thumb.vue"]]);const barProps=buildProps({always:{type:Boolean,default:!0},minSize:{type:Number,required:!0}}),_sfc_main$y=defineComponent({__name:"bar",props:barProps,setup(t,{expose:n}){const e=t,r=inject(scrollbarContextKey),s=ref(0),i=ref(0),o=ref(""),a=ref(""),d=ref(1),c=ref(1);return n({handleScroll:y=>{if(y){const S=y.offsetHeight-GAP,O=y.offsetWidth-GAP;i.value=y.scrollTop*100/S*d.value,s.value=y.scrollLeft*100/O*c.value}},update:()=>{const y=r==null?void 0:r.wrapElement;if(!y)return;const S=y.offsetHeight-GAP,O=y.offsetWidth-GAP,k=S**2/y.scrollHeight,g=O**2/y.scrollWidth,v=Math.max(k,e.minSize),ue=Math.max(g,e.minSize);d.value=k/(S-k)/(v/(S-v)),c.value=g/(O-g)/(ue/(O-ue)),a.value=v+GAP<S?`${v}px`:"",o.value=ue+GAP<O?`${ue}px`:""}}),(y,S)=>(openBlock(),createElementBlock(Fragment,null,[createVNode(Thumb,{move:s.value,ratio:c.value,size:o.value,always:y.always},null,8,["move","ratio","size","always"]),createVNode(Thumb,{move:i.value,ratio:d.value,size:a.value,vertical:"",always:y.always},null,8,["move","ratio","size","always"])],64))}});var Bar=_export_sfc(_sfc_main$y,[["__file","bar.vue"]]);const scrollbarProps=buildProps({height:{type:[String,Number],default:""},maxHeight:{type:[String,Number],default:""},native:{type:Boolean,default:!1},wrapStyle:{type:definePropType([String,Object,Array]),default:""},wrapClass:{type:[String,Array],default:""},viewClass:{type:[String,Array],default:""},viewStyle:{type:[String,Array,Object],default:""},noresize:Boolean,tag:{type:String,default:"div"},always:Boolean,minSize:{type:Number,default:20},id:String,role:String,ariaLabel:String,ariaOrientation:{type:String,values:["horizontal","vertical"]}}),scrollbarEmits={scroll:({scrollTop:t,scrollLeft:n})=>[t,n].every(isNumber$1)},COMPONENT_NAME="ElScrollbar",__default__$k=defineComponent({name:COMPONENT_NAME}),_sfc_main$x=defineComponent({...__default__$k,props:scrollbarProps,emits:scrollbarEmits,setup(t,{expose:n,emit:e}){const r=t,s=useNamespace("scrollbar");let i,o;const a=ref(),d=ref(),c=ref(),u=ref(),m=computed(()=>{const L={};return r.height&&(L.height=addUnit(r.height)),r.maxHeight&&(L.maxHeight=addUnit(r.maxHeight)),[r.wrapStyle,L]}),y=computed(()=>[r.wrapClass,s.e("wrap"),{[s.em("wrap","hidden-default")]:!r.native}]),S=computed(()=>[s.e("view"),r.viewClass]),O=()=>{var L;d.value&&((L=u.value)==null||L.handleScroll(d.value),e("scroll",{scrollTop:d.value.scrollTop,scrollLeft:d.value.scrollLeft}))};function k(L,re){isObject$2(L)?d.value.scrollTo(L):isNumber$1(L)&&isNumber$1(re)&&d.value.scrollTo(L,re)}const g=L=>{isNumber$1(L)&&(d.value.scrollTop=L)},v=L=>{isNumber$1(L)&&(d.value.scrollLeft=L)},ue=()=>{var L;(L=u.value)==null||L.update()};return watch(()=>r.noresize,L=>{L?(i==null||i(),o==null||o()):({stop:i}=useResizeObserver(c,ue),o=useEventListener("resize",ue))},{immediate:!0}),watch(()=>[r.maxHeight,r.height],()=>{r.native||nextTick(()=>{var L;ue(),d.value&&((L=u.value)==null||L.handleScroll(d.value))})}),provide(scrollbarContextKey,reactive({scrollbarElement:a,wrapElement:d})),onMounted(()=>{r.native||nextTick(()=>{ue()})}),onUpdated(()=>ue()),n({wrapRef:d,update:ue,scrollTo:k,setScrollTop:g,setScrollLeft:v,handleScroll:O}),(L,re)=>(openBlock(),createElementBlock("div",{ref_key:"scrollbarRef",ref:a,class:normalizeClass(unref(s).b())},[createBaseVNode("div",{ref_key:"wrapRef",ref:d,class:normalizeClass(unref(y)),style:normalizeStyle(unref(m)),onScroll:O},[(openBlock(),createBlock(resolveDynamicComponent(L.tag),{id:L.id,ref_key:"resizeRef",ref:c,class:normalizeClass(unref(S)),style:normalizeStyle(L.viewStyle),role:L.role,"aria-label":L.ariaLabel,"aria-orientation":L.ariaOrientation},{default:withCtx(()=>[renderSlot(L.$slots,"default")]),_:3},8,["id","class","style","role","aria-label","aria-orientation"]))],38),L.native?createCommentVNode("v-if",!0):(openBlock(),createBlock(Bar,{key:0,ref_key:"barRef",ref:u,always:L.always,"min-size":L.minSize},null,8,["always","min-size"]))],2))}});var Scrollbar=_export_sfc(_sfc_main$x,[["__file","scrollbar.vue"]]);const ElScrollbar=withInstall(Scrollbar),POPPER_INJECTION_KEY=Symbol("popper"),POPPER_CONTENT_INJECTION_KEY=Symbol("popperContent"),roleTypes=["dialog","grid","group","listbox","menu","navigation","tooltip","tree"],popperProps=buildProps({role:{type:String,values:roleTypes,default:"tooltip"}}),__default__$j=defineComponent({name:"ElPopper",inheritAttrs:!1}),_sfc_main$w=defineComponent({...__default__$j,props:popperProps,setup(t,{expose:n}){const e=t,r=ref(),s=ref(),i=ref(),o=ref(),a=computed(()=>e.role),d={triggerRef:r,popperInstanceRef:s,contentRef:i,referenceRef:o,role:a};return n(d),provide(POPPER_INJECTION_KEY,d),(c,u)=>renderSlot(c.$slots,"default")}});var Popper=_export_sfc(_sfc_main$w,[["__file","popper.vue"]]);const popperArrowProps=buildProps({arrowOffset:{type:Number,default:5}}),__default__$i=defineComponent({name:"ElPopperArrow",inheritAttrs:!1}),_sfc_main$v=defineComponent({...__default__$i,props:popperArrowProps,setup(t,{expose:n}){const e=t,r=useNamespace("popper"),{arrowOffset:s,arrowRef:i,arrowStyle:o}=inject(POPPER_CONTENT_INJECTION_KEY,void 0);return watch(()=>e.arrowOffset,a=>{s.value=a}),onBeforeUnmount(()=>{i.value=void 0}),n({arrowRef:i}),(a,d)=>(openBlock(),createElementBlock("span",{ref_key:"arrowRef",ref:i,class:normalizeClass(unref(r).e("arrow")),style:normalizeStyle(unref(o)),"data-popper-arrow":""},null,6))}});var ElPopperArrow=_export_sfc(_sfc_main$v,[["__file","arrow.vue"]]);const NAME="ElOnlyChild",OnlyChild=defineComponent({name:NAME,setup(t,{slots:n,attrs:e}){var r;const s=inject(FORWARD_REF_INJECTION_KEY),i=useForwardRefDirective((r=s==null?void 0:s.setForwardRef)!=null?r:NOOP);return()=>{var o;const a=(o=n.default)==null?void 0:o.call(n,e);if(!a||a.length>1)return null;const d=findFirstLegitChild(a);return d?withDirectives(cloneVNode(d,e),[[i]]):null}}});function findFirstLegitChild(t){if(!t)return null;const n=t;for(const e of n){if(isObject$2(e))switch(e.type){case Comment:continue;case Text:case"svg":return wrapTextContent(e);case Fragment:return findFirstLegitChild(e.children);default:return e}return wrapTextContent(e)}return null}function wrapTextContent(t){const n=useNamespace("only-child");return createVNode("span",{class:n.e("content")},[t])}const popperTriggerProps=buildProps({virtualRef:{type:definePropType(Object)},virtualTriggering:Boolean,onMouseenter:{type:definePropType(Function)},onMouseleave:{type:definePropType(Function)},onClick:{type:definePropType(Function)},onKeydown:{type:definePropType(Function)},onFocus:{type:definePropType(Function)},onBlur:{type:definePropType(Function)},onContextmenu:{type:definePropType(Function)},id:String,open:Boolean}),__default__$h=defineComponent({name:"ElPopperTrigger",inheritAttrs:!1}),_sfc_main$u=defineComponent({...__default__$h,props:popperTriggerProps,setup(t,{expose:n}){const e=t,{role:r,triggerRef:s}=inject(POPPER_INJECTION_KEY,void 0);useForwardRef(s);const i=computed(()=>a.value?e.id:void 0),o=computed(()=>{if(r&&r.value==="tooltip")return e.open&&e.id?e.id:void 0}),a=computed(()=>{if(r&&r.value!=="tooltip")return r.value}),d=computed(()=>a.value?`${e.open}`:void 0);let c;return onMounted(()=>{watch(()=>e.virtualRef,u=>{u&&(s.value=unrefElement(u))},{immediate:!0}),watch(s,(u,m)=>{c==null||c(),c=void 0,isElement(u)&&(["onMouseenter","onMouseleave","onClick","onKeydown","onFocus","onBlur","onContextmenu"].forEach(y=>{var S;const O=e[y];O&&(u.addEventListener(y.slice(2).toLowerCase(),O),(S=m==null?void 0:m.removeEventListener)==null||S.call(m,y.slice(2).toLowerCase(),O))}),c=watch([i,o,a,d],y=>{["aria-controls","aria-describedby","aria-haspopup","aria-expanded"].forEach((S,O)=>{isNil(y[O])?u.removeAttribute(S):u.setAttribute(S,y[O])})},{immediate:!0})),isElement(m)&&["aria-controls","aria-describedby","aria-haspopup","aria-expanded"].forEach(y=>m.removeAttribute(y))},{immediate:!0})}),onBeforeUnmount(()=>{c==null||c(),c=void 0}),n({triggerRef:s}),(u,m)=>u.virtualTriggering?createCommentVNode("v-if",!0):(openBlock(),createBlock(unref(OnlyChild),mergeProps({key:0},u.$attrs,{"aria-controls":unref(i),"aria-describedby":unref(o),"aria-expanded":unref(d),"aria-haspopup":unref(a)}),{default:withCtx(()=>[renderSlot(u.$slots,"default")]),_:3},16,["aria-controls","aria-describedby","aria-expanded","aria-haspopup"]))}});var ElPopperTrigger=_export_sfc(_sfc_main$u,[["__file","trigger.vue"]]);const FOCUS_AFTER_TRAPPED="focus-trap.focus-after-trapped",FOCUS_AFTER_RELEASED="focus-trap.focus-after-released",FOCUSOUT_PREVENTED="focus-trap.focusout-prevented",FOCUS_AFTER_TRAPPED_OPTS={cancelable:!0,bubbles:!1},FOCUSOUT_PREVENTED_OPTS={cancelable:!0,bubbles:!1},ON_TRAP_FOCUS_EVT="focusAfterTrapped",ON_RELEASE_FOCUS_EVT="focusAfterReleased",FOCUS_TRAP_INJECTION_KEY=Symbol("elFocusTrap"),focusReason=ref(),lastUserFocusTimestamp=ref(0),lastAutomatedFocusTimestamp=ref(0);let focusReasonUserCount=0;const obtainAllFocusableElements=t=>{const n=[],e=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,{acceptNode:r=>{const s=r.tagName==="INPUT"&&r.type==="hidden";return r.disabled||r.hidden||s?NodeFilter.FILTER_SKIP:r.tabIndex>=0||r===document.activeElement?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;e.nextNode();)n.push(e.currentNode);return n},getVisibleElement=(t,n)=>{for(const e of t)if(!isHidden(e,n))return e},isHidden=(t,n)=>{if(getComputedStyle(t).visibility==="hidden")return!0;for(;t;){if(n&&t===n)return!1;if(getComputedStyle(t).display==="none")return!0;t=t.parentElement}return!1},getEdges=t=>{const n=obtainAllFocusableElements(t),e=getVisibleElement(n,t),r=getVisibleElement(n.reverse(),t);return[e,r]},isSelectable=t=>t instanceof HTMLInputElement&&"select"in t,tryFocus=(t,n)=>{if(t&&t.focus){const e=document.activeElement;t.focus({preventScroll:!0}),lastAutomatedFocusTimestamp.value=window.performance.now(),t!==e&&isSelectable(t)&&n&&t.select()}};function removeFromStack(t,n){const e=[...t],r=t.indexOf(n);return r!==-1&&e.splice(r,1),e}const createFocusableStack=()=>{let t=[];return{push:r=>{const s=t[0];s&&r!==s&&s.pause(),t=removeFromStack(t,r),t.unshift(r)},remove:r=>{var s,i;t=removeFromStack(t,r),(i=(s=t[0])==null?void 0:s.resume)==null||i.call(s)}}},focusFirstDescendant=(t,n=!1)=>{const e=document.activeElement;for(const r of t)if(tryFocus(r,n),document.activeElement!==e)return},focusableStack=createFocusableStack(),isFocusCausedByUserEvent=()=>lastUserFocusTimestamp.value>lastAutomatedFocusTimestamp.value,notifyFocusReasonPointer=()=>{focusReason.value="pointer",lastUserFocusTimestamp.value=window.performance.now()},notifyFocusReasonKeydown=()=>{focusReason.value="keyboard",lastUserFocusTimestamp.value=window.performance.now()},useFocusReason=()=>(onMounted(()=>{focusReasonUserCount===0&&(document.addEventListener("mousedown",notifyFocusReasonPointer),document.addEventListener("touchstart",notifyFocusReasonPointer),document.addEventListener("keydown",notifyFocusReasonKeydown)),focusReasonUserCount++}),onBeforeUnmount(()=>{focusReasonUserCount--,focusReasonUserCount<=0&&(document.removeEventListener("mousedown",notifyFocusReasonPointer),document.removeEventListener("touchstart",notifyFocusReasonPointer),document.removeEventListener("keydown",notifyFocusReasonKeydown))}),{focusReason,lastUserFocusTimestamp,lastAutomatedFocusTimestamp}),createFocusOutPreventedEvent=t=>new CustomEvent(FOCUSOUT_PREVENTED,{...FOCUSOUT_PREVENTED_OPTS,detail:t}),_sfc_main$t=defineComponent({name:"ElFocusTrap",inheritAttrs:!1,props:{loop:Boolean,trapped:Boolean,focusTrapEl:Object,focusStartEl:{type:[Object,String],default:"first"}},emits:[ON_TRAP_FOCUS_EVT,ON_RELEASE_FOCUS_EVT,"focusin","focusout","focusout-prevented","release-requested"],setup(t,{emit:n}){const e=ref();let r,s;const{focusReason:i}=useFocusReason();useEscapeKeydown(O=>{t.trapped&&!o.paused&&n("release-requested",O)});const o={paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}},a=O=>{if(!t.loop&&!t.trapped||o.paused)return;const{key:k,altKey:g,ctrlKey:v,metaKey:ue,currentTarget:L,shiftKey:re}=O,{loop:le}=t,oe=k===EVENT_CODE.tab&&!g&&!v&&!ue,he=document.activeElement;if(oe&&he){const Ie=L,[ie,Ne]=getEdges(Ie);if(ie&&Ne){if(!re&&he===Ne){const Ce=createFocusOutPreventedEvent({focusReason:i.value});n("focusout-prevented",Ce),Ce.defaultPrevented||(O.preventDefault(),le&&tryFocus(ie,!0))}else if(re&&[ie,Ie].includes(he)){const Ce=createFocusOutPreventedEvent({focusReason:i.value});n("focusout-prevented",Ce),Ce.defaultPrevented||(O.preventDefault(),le&&tryFocus(Ne,!0))}}else if(he===Ie){const Ce=createFocusOutPreventedEvent({focusReason:i.value});n("focusout-prevented",Ce),Ce.defaultPrevented||O.preventDefault()}}};provide(FOCUS_TRAP_INJECTION_KEY,{focusTrapRef:e,onKeydown:a}),watch(()=>t.focusTrapEl,O=>{O&&(e.value=O)},{immediate:!0}),watch([e],([O],[k])=>{O&&(O.addEventListener("keydown",a),O.addEventListener("focusin",u),O.addEventListener("focusout",m)),k&&(k.removeEventListener("keydown",a),k.removeEventListener("focusin",u),k.removeEventListener("focusout",m))});const d=O=>{n(ON_TRAP_FOCUS_EVT,O)},c=O=>n(ON_RELEASE_FOCUS_EVT,O),u=O=>{const k=unref(e);if(!k)return;const g=O.target,v=O.relatedTarget,ue=g&&k.contains(g);t.trapped||v&&k.contains(v)||(r=v),ue&&n("focusin",O),!o.paused&&t.trapped&&(ue?s=g:tryFocus(s,!0))},m=O=>{const k=unref(e);if(!(o.paused||!k))if(t.trapped){const g=O.relatedTarget;!isNil(g)&&!k.contains(g)&&setTimeout(()=>{if(!o.paused&&t.trapped){const v=createFocusOutPreventedEvent({focusReason:i.value});n("focusout-prevented",v),v.defaultPrevented||tryFocus(s,!0)}},0)}else{const g=O.target;g&&k.contains(g)||n("focusout",O)}};async function y(){await nextTick();const O=unref(e);if(O){focusableStack.push(o);const k=O.contains(document.activeElement)?r:document.activeElement;if(r=k,!O.contains(k)){const v=new Event(FOCUS_AFTER_TRAPPED,FOCUS_AFTER_TRAPPED_OPTS);O.addEventListener(FOCUS_AFTER_TRAPPED,d),O.dispatchEvent(v),v.defaultPrevented||nextTick(()=>{let ue=t.focusStartEl;isString$2(ue)||(tryFocus(ue),document.activeElement!==ue&&(ue="first")),ue==="first"&&focusFirstDescendant(obtainAllFocusableElements(O),!0),(document.activeElement===k||ue==="container")&&tryFocus(O)})}}}function S(){const O=unref(e);if(O){O.removeEventListener(FOCUS_AFTER_TRAPPED,d);const k=new CustomEvent(FOCUS_AFTER_RELEASED,{...FOCUS_AFTER_TRAPPED_OPTS,detail:{focusReason:i.value}});O.addEventListener(FOCUS_AFTER_RELEASED,c),O.dispatchEvent(k),!k.defaultPrevented&&(i.value=="keyboard"||!isFocusCausedByUserEvent()||O.contains(document.activeElement))&&tryFocus(r??document.body),O.removeEventListener(FOCUS_AFTER_RELEASED,c),focusableStack.remove(o)}}return onMounted(()=>{t.trapped&&y(),watch(()=>t.trapped,O=>{O?y():S()})}),onBeforeUnmount(()=>{t.trapped&&S()}),{onKeydown:a}}});function _sfc_render$a(t,n,e,r,s,i){return renderSlot(t.$slots,"default",{handleKeydown:t.onKeydown})}var ElFocusTrap=_export_sfc(_sfc_main$t,[["render",_sfc_render$a],["__file","focus-trap.vue"]]);const POSITIONING_STRATEGIES=["fixed","absolute"],popperCoreConfigProps=buildProps({boundariesPadding:{type:Number,default:0},fallbackPlacements:{type:definePropType(Array),default:void 0},gpuAcceleration:{type:Boolean,default:!0},offset:{type:Number,default:12},placement:{type:String,values:Ee,default:"bottom"},popperOptions:{type:definePropType(Object),default:()=>({})},strategy:{type:String,values:POSITIONING_STRATEGIES,default:"absolute"}}),popperContentProps=buildProps({...popperCoreConfigProps,id:String,style:{type:definePropType([String,Array,Object])},className:{type:definePropType([String,Array,Object])},effect:{type:String,default:"dark"},visible:Boolean,enterable:{type:Boolean,default:!0},pure:Boolean,focusOnShow:{type:Boolean,default:!1},trapping:{type:Boolean,default:!1},popperClass:{type:definePropType([String,Array,Object])},popperStyle:{type:definePropType([String,Array,Object])},referenceEl:{type:definePropType(Object)},triggerTargetEl:{type:definePropType(Object)},stopPopperMouseEvent:{type:Boolean,default:!0},ariaLabel:{type:String,default:void 0},virtualTriggering:Boolean,zIndex:Number}),popperContentEmits={mouseenter:t=>t instanceof MouseEvent,mouseleave:t=>t instanceof MouseEvent,focus:()=>!0,blur:()=>!0,close:()=>!0},buildPopperOptions=(t,n=[])=>{const{placement:e,strategy:r,popperOptions:s}=t,i={placement:e,strategy:r,...s,modifiers:[...genModifiers(t),...n]};return deriveExtraModifiers(i,s==null?void 0:s.modifiers),i},unwrapMeasurableEl=t=>{if(isClient)return unrefElement(t)};function genModifiers(t){const{offset:n,gpuAcceleration:e,fallbackPlacements:r}=t;return[{name:"offset",options:{offset:[0,n??12]}},{name:"preventOverflow",options:{padding:{top:2,bottom:2,left:5,right:5}}},{name:"flip",options:{padding:5,fallbackPlacements:r}},{name:"computeStyles",options:{gpuAcceleration:e}}]}function deriveExtraModifiers(t,n){n&&(t.modifiers=[...t.modifiers,...n??[]])}const DEFAULT_ARROW_OFFSET=0,usePopperContent=t=>{const{popperInstanceRef:n,contentRef:e,triggerRef:r,role:s}=inject(POPPER_INJECTION_KEY,void 0),i=ref(),o=ref(),a=computed(()=>({name:"eventListeners",enabled:!!t.visible})),d=computed(()=>{var v;const ue=unref(i),L=(v=unref(o))!=null?v:DEFAULT_ARROW_OFFSET;return{name:"arrow",enabled:!isUndefined$2(ue),options:{element:ue,padding:L}}}),c=computed(()=>({onFirstUpdate:()=>{O()},...buildPopperOptions(t,[unref(d),unref(a)])})),u=computed(()=>unwrapMeasurableEl(t.referenceEl)||unref(r)),{attributes:m,state:y,styles:S,update:O,forceUpdate:k,instanceRef:g}=usePopper(u,e,c);return watch(g,v=>n.value=v),onMounted(()=>{watch(()=>{var v;return(v=unref(u))==null?void 0:v.getBoundingClientRect()},()=>{O()})}),{attributes:m,arrowRef:i,contentRef:e,instanceRef:g,state:y,styles:S,role:s,forceUpdate:k,update:O}},usePopperContentDOM=(t,{attributes:n,styles:e,role:r})=>{const{nextZIndex:s}=useZIndex(),i=useNamespace("popper"),o=computed(()=>unref(n).popper),a=ref(isNumber$1(t.zIndex)?t.zIndex:s()),d=computed(()=>[i.b(),i.is("pure",t.pure),i.is(t.effect),t.popperClass]),c=computed(()=>[{zIndex:unref(a)},unref(e).popper,t.popperStyle||{}]),u=computed(()=>r.value==="dialog"?"false":void 0),m=computed(()=>unref(e).arrow||{});return{ariaModal:u,arrowStyle:m,contentAttrs:o,contentClass:d,contentStyle:c,contentZIndex:a,updateZIndex:()=>{a.value=isNumber$1(t.zIndex)?t.zIndex:s()}}},usePopperContentFocusTrap=(t,n)=>{const e=ref(!1),r=ref();return{focusStartRef:r,trapped:e,onFocusAfterReleased:c=>{var u;((u=c.detail)==null?void 0:u.focusReason)!=="pointer"&&(r.value="first",n("blur"))},onFocusAfterTrapped:()=>{n("focus")},onFocusInTrap:c=>{t.visible&&!e.value&&(c.target&&(r.value=c.target),e.value=!0)},onFocusoutPrevented:c=>{t.trapping||(c.detail.focusReason==="pointer"&&c.preventDefault(),e.value=!1)},onReleaseRequested:()=>{e.value=!1,n("close")}}},__default__$g=defineComponent({name:"ElPopperContent"}),_sfc_main$s=defineComponent({...__default__$g,props:popperContentProps,emits:popperContentEmits,setup(t,{expose:n,emit:e}){const r=t,{focusStartRef:s,trapped:i,onFocusAfterReleased:o,onFocusAfterTrapped:a,onFocusInTrap:d,onFocusoutPrevented:c,onReleaseRequested:u}=usePopperContentFocusTrap(r,e),{attributes:m,arrowRef:y,contentRef:S,styles:O,instanceRef:k,role:g,update:v}=usePopperContent(r),{ariaModal:ue,arrowStyle:L,contentAttrs:re,contentClass:le,contentStyle:oe,updateZIndex:he}=usePopperContentDOM(r,{styles:O,attributes:m,role:g}),Ie=inject(formItemContextKey,void 0),ie=ref();provide(POPPER_CONTENT_INJECTION_KEY,{arrowStyle:L,arrowRef:y,arrowOffset:ie}),Ie&&(Ie.addInputId||Ie.removeInputId)&&provide(formItemContextKey,{...Ie,addInputId:NOOP,removeInputId:NOOP});let Ne;const Ve=(Ue=!0)=>{v(),Ue&&he()},Ce=()=>{Ve(!1),r.visible&&r.focusOnShow?i.value=!0:r.visible===!1&&(i.value=!1)};return onMounted(()=>{watch(()=>r.triggerTargetEl,(Ue,qe)=>{Ne==null||Ne(),Ne=void 0;const Oe=unref(Ue||S.value),$e=unref(qe||S.value);isElement(Oe)&&(Ne=watch([g,()=>r.ariaLabel,ue,()=>r.id],_e=>{["role","aria-label","aria-modal","id"].forEach((er,Pt)=>{isNil(_e[Pt])?Oe.removeAttribute(er):Oe.setAttribute(er,_e[Pt])})},{immediate:!0})),$e!==Oe&&isElement($e)&&["role","aria-label","aria-modal","id"].forEach(_e=>{$e.removeAttribute(_e)})},{immediate:!0}),watch(()=>r.visible,Ce,{immediate:!0})}),onBeforeUnmount(()=>{Ne==null||Ne(),Ne=void 0}),n({popperContentRef:S,popperInstanceRef:k,updatePopper:Ve,contentStyle:oe}),(Ue,qe)=>(openBlock(),createElementBlock("div",mergeProps({ref_key:"contentRef",ref:S},unref(re),{style:unref(oe),class:unref(le),tabindex:"-1",onMouseenter:qe[0]||(qe[0]=Oe=>Ue.$emit("mouseenter",Oe)),onMouseleave:qe[1]||(qe[1]=Oe=>Ue.$emit("mouseleave",Oe))}),[createVNode(unref(ElFocusTrap),{trapped:unref(i),"trap-on-focus-in":!0,"focus-trap-el":unref(S),"focus-start-el":unref(s),onFocusAfterTrapped:unref(a),onFocusAfterReleased:unref(o),onFocusin:unref(d),onFocusoutPrevented:unref(c),onReleaseRequested:unref(u)},{default:withCtx(()=>[renderSlot(Ue.$slots,"default")]),_:3},8,["trapped","focus-trap-el","focus-start-el","onFocusAfterTrapped","onFocusAfterReleased","onFocusin","onFocusoutPrevented","onReleaseRequested"])],16))}});var ElPopperContent=_export_sfc(_sfc_main$s,[["__file","content.vue"]]);const ElPopper=withInstall(Popper),TOOLTIP_INJECTION_KEY=Symbol("elTooltip"),useTooltipContentProps=buildProps({...useDelayedToggleProps,...popperContentProps,appendTo:{type:definePropType([String,Object])},content:{type:String,default:""},rawContent:{type:Boolean,default:!1},persistent:Boolean,ariaLabel:String,visible:{type:definePropType(Boolean),default:null},transition:String,teleported:{type:Boolean,default:!0},disabled:Boolean}),useTooltipTriggerProps=buildProps({...popperTriggerProps,disabled:Boolean,trigger:{type:definePropType([String,Array]),default:"hover"},triggerKeys:{type:definePropType(Array),default:()=>[EVENT_CODE.enter,EVENT_CODE.space]}}),{useModelToggleProps:useTooltipModelToggleProps,useModelToggleEmits:useTooltipModelToggleEmits,useModelToggle:useTooltipModelToggle}=createModelToggleComposable("visible"),useTooltipProps=buildProps({...popperProps,...useTooltipModelToggleProps,...useTooltipContentProps,...useTooltipTriggerProps,...popperArrowProps,showArrow:{type:Boolean,default:!0}}),tooltipEmits=[...useTooltipModelToggleEmits,"before-show","before-hide","show","hide","open","close"],isTriggerType=(t,n)=>isArray$3(t)?t.includes(n):t===n,whenTrigger=(t,n,e)=>r=>{isTriggerType(unref(t),n)&&e(r)},__default__$f=defineComponent({name:"ElTooltipTrigger"}),_sfc_main$r=defineComponent({...__default__$f,props:useTooltipTriggerProps,setup(t,{expose:n}){const e=t,r=useNamespace("tooltip"),{controlled:s,id:i,open:o,onOpen:a,onClose:d,onToggle:c}=inject(TOOLTIP_INJECTION_KEY,void 0),u=ref(null),m=()=>{if(unref(s)||e.disabled)return!0},y=toRef(e,"trigger"),S=composeEventHandlers(m,whenTrigger(y,"hover",a)),O=composeEventHandlers(m,whenTrigger(y,"hover",d)),k=composeEventHandlers(m,whenTrigger(y,"click",re=>{re.button===0&&c(re)})),g=composeEventHandlers(m,whenTrigger(y,"focus",a)),v=composeEventHandlers(m,whenTrigger(y,"focus",d)),ue=composeEventHandlers(m,whenTrigger(y,"contextmenu",re=>{re.preventDefault(),c(re)})),L=composeEventHandlers(m,re=>{const{code:le}=re;e.triggerKeys.includes(le)&&(re.preventDefault(),c(re))});return n({triggerRef:u}),(re,le)=>(openBlock(),createBlock(unref(ElPopperTrigger),{id:unref(i),"virtual-ref":re.virtualRef,open:unref(o),"virtual-triggering":re.virtualTriggering,class:normalizeClass(unref(r).e("trigger")),onBlur:unref(v),onClick:unref(k),onContextmenu:unref(ue),onFocus:unref(g),onMouseenter:unref(S),onMouseleave:unref(O),onKeydown:unref(L)},{default:withCtx(()=>[renderSlot(re.$slots,"default")]),_:3},8,["id","virtual-ref","open","virtual-triggering","class","onBlur","onClick","onContextmenu","onFocus","onMouseenter","onMouseleave","onKeydown"]))}});var ElTooltipTrigger=_export_sfc(_sfc_main$r,[["__file","trigger.vue"]]);const __default__$e=defineComponent({name:"ElTooltipContent",inheritAttrs:!1}),_sfc_main$q=defineComponent({...__default__$e,props:useTooltipContentProps,setup(t,{expose:n}){const e=t,{selector:r}=usePopperContainerId(),s=useNamespace("tooltip"),i=ref(null),o=ref(!1),{controlled:a,id:d,open:c,trigger:u,onClose:m,onOpen:y,onShow:S,onHide:O,onBeforeShow:k,onBeforeHide:g}=inject(TOOLTIP_INJECTION_KEY,void 0),v=computed(()=>e.transition||`${s.namespace.value}-fade-in-linear`),ue=computed(()=>e.persistent);onBeforeUnmount(()=>{o.value=!0});const L=computed(()=>unref(ue)?!0:unref(c)),re=computed(()=>e.disabled?!1:unref(c)),le=computed(()=>e.appendTo||r.value),oe=computed(()=>{var _e;return(_e=e.style)!=null?_e:{}}),he=computed(()=>!unref(c)),Ie=()=>{O()},ie=()=>{if(unref(a))return!0},Ne=composeEventHandlers(ie,()=>{e.enterable&&unref(u)==="hover"&&y()}),Ve=composeEventHandlers(ie,()=>{unref(u)==="hover"&&m()}),Ce=()=>{var _e,er;(er=(_e=i.value)==null?void 0:_e.updatePopper)==null||er.call(_e),k==null||k()},Ue=()=>{g==null||g()},qe=()=>{S(),$e=onClickOutside(computed(()=>{var _e;return(_e=i.value)==null?void 0:_e.popperContentRef}),()=>{if(unref(a))return;unref(u)!=="hover"&&m()})},Oe=()=>{e.virtualTriggering||m()};let $e;return watch(()=>unref(c),_e=>{_e||$e==null||$e()},{flush:"post"}),watch(()=>e.content,()=>{var _e,er;(er=(_e=i.value)==null?void 0:_e.updatePopper)==null||er.call(_e)}),n({contentRef:i}),(_e,er)=>(openBlock(),createBlock(Teleport,{disabled:!_e.teleported,to:unref(le)},[createVNode(Transition,{name:unref(v),onAfterLeave:Ie,onBeforeEnter:Ce,onAfterEnter:qe,onBeforeLeave:Ue},{default:withCtx(()=>[unref(L)?withDirectives((openBlock(),createBlock(unref(ElPopperContent),mergeProps({key:0,id:unref(d),ref_key:"contentRef",ref:i},_e.$attrs,{"aria-label":_e.ariaLabel,"aria-hidden":unref(he),"boundaries-padding":_e.boundariesPadding,"fallback-placements":_e.fallbackPlacements,"gpu-acceleration":_e.gpuAcceleration,offset:_e.offset,placement:_e.placement,"popper-options":_e.popperOptions,strategy:_e.strategy,effect:_e.effect,enterable:_e.enterable,pure:_e.pure,"popper-class":_e.popperClass,"popper-style":[_e.popperStyle,unref(oe)],"reference-el":_e.referenceEl,"trigger-target-el":_e.triggerTargetEl,visible:unref(re),"z-index":_e.zIndex,onMouseenter:unref(Ne),onMouseleave:unref(Ve),onBlur:Oe,onClose:unref(m)}),{default:withCtx(()=>[o.value?createCommentVNode("v-if",!0):renderSlot(_e.$slots,"default",{key:0})]),_:3},16,["id","aria-label","aria-hidden","boundaries-padding","fallback-placements","gpu-acceleration","offset","placement","popper-options","strategy","effect","enterable","pure","popper-class","popper-style","reference-el","trigger-target-el","visible","z-index","onMouseenter","onMouseleave","onClose"])),[[vShow,unref(re)]]):createCommentVNode("v-if",!0)]),_:3},8,["name"])],8,["disabled","to"]))}});var ElTooltipContent=_export_sfc(_sfc_main$q,[["__file","content.vue"]]);const _hoisted_1$8=["innerHTML"],_hoisted_2$4={key:1},__default__$d=defineComponent({name:"ElTooltip"}),_sfc_main$p=defineComponent({...__default__$d,props:useTooltipProps,emits:tooltipEmits,setup(t,{expose:n,emit:e}){const r=t;usePopperContainer();const s=useId(),i=ref(),o=ref(),a=()=>{var v;const ue=unref(i);ue&&((v=ue.popperInstanceRef)==null||v.update())},d=ref(!1),c=ref(),{show:u,hide:m,hasUpdateHandler:y}=useTooltipModelToggle({indicator:d,toggleReason:c}),{onOpen:S,onClose:O}=useDelayedToggle({showAfter:toRef(r,"showAfter"),hideAfter:toRef(r,"hideAfter"),autoClose:toRef(r,"autoClose"),open:u,close:m}),k=computed(()=>isBoolean$1(r.visible)&&!y.value);provide(TOOLTIP_INJECTION_KEY,{controlled:k,id:s,open:readonly(d),trigger:toRef(r,"trigger"),onOpen:v=>{S(v)},onClose:v=>{O(v)},onToggle:v=>{unref(d)?O(v):S(v)},onShow:()=>{e("show",c.value)},onHide:()=>{e("hide",c.value)},onBeforeShow:()=>{e("before-show",c.value)},onBeforeHide:()=>{e("before-hide",c.value)},updatePopper:a}),watch(()=>r.disabled,v=>{v&&d.value&&(d.value=!1)});const g=v=>{var ue,L;const re=(L=(ue=o.value)==null?void 0:ue.contentRef)==null?void 0:L.popperContentRef,le=(v==null?void 0:v.relatedTarget)||document.activeElement;return re&&re.contains(le)};return onDeactivated(()=>d.value&&m()),n({popperRef:i,contentRef:o,isFocusInsideContent:g,updatePopper:a,onOpen:S,onClose:O,hide:m}),(v,ue)=>(openBlock(),createBlock(unref(ElPopper),{ref_key:"popperRef",ref:i,role:v.role},{default:withCtx(()=>[createVNode(ElTooltipTrigger,{disabled:v.disabled,trigger:v.trigger,"trigger-keys":v.triggerKeys,"virtual-ref":v.virtualRef,"virtual-triggering":v.virtualTriggering},{default:withCtx(()=>[v.$slots.default?renderSlot(v.$slots,"default",{key:0}):createCommentVNode("v-if",!0)]),_:3},8,["disabled","trigger","trigger-keys","virtual-ref","virtual-triggering"]),createVNode(ElTooltipContent,{ref_key:"contentRef",ref:o,"aria-label":v.ariaLabel,"boundaries-padding":v.boundariesPadding,content:v.content,disabled:v.disabled,effect:v.effect,enterable:v.enterable,"fallback-placements":v.fallbackPlacements,"hide-after":v.hideAfter,"gpu-acceleration":v.gpuAcceleration,offset:v.offset,persistent:v.persistent,"popper-class":v.popperClass,"popper-style":v.popperStyle,placement:v.placement,"popper-options":v.popperOptions,pure:v.pure,"raw-content":v.rawContent,"reference-el":v.referenceEl,"trigger-target-el":v.triggerTargetEl,"show-after":v.showAfter,strategy:v.strategy,teleported:v.teleported,transition:v.transition,"virtual-triggering":v.virtualTriggering,"z-index":v.zIndex,"append-to":v.appendTo},{default:withCtx(()=>[renderSlot(v.$slots,"content",{},()=>[v.rawContent?(openBlock(),createElementBlock("span",{key:0,innerHTML:v.content},null,8,_hoisted_1$8)):(openBlock(),createElementBlock("span",_hoisted_2$4,toDisplayString(v.content),1))]),v.showArrow?(openBlock(),createBlock(unref(ElPopperArrow),{key:0,"arrow-offset":v.arrowOffset},null,8,["arrow-offset"])):createCommentVNode("v-if",!0)]),_:3},8,["aria-label","boundaries-padding","content","disabled","effect","enterable","fallback-placements","hide-after","gpu-acceleration","offset","persistent","popper-class","popper-style","placement","popper-options","pure","raw-content","reference-el","trigger-target-el","show-after","strategy","teleported","transition","virtual-triggering","z-index","append-to"])]),_:3},8,["role"]))}});var Tooltip=_export_sfc(_sfc_main$p,[["__file","tooltip.vue"]]);const ElTooltip=withInstall(Tooltip),badgeProps=buildProps({value:{type:[String,Number],default:""},max:{type:Number,default:99},isDot:Boolean,hidden:Boolean,type:{type:String,values:["primary","success","warning","info","danger"],default:"danger"}}),_hoisted_1$7=["textContent"],__default__$c=defineComponent({name:"ElBadge"}),_sfc_main$o=defineComponent({...__default__$c,props:badgeProps,setup(t,{expose:n}){const e=t,r=useNamespace("badge"),s=computed(()=>e.isDot?"":isNumber$1(e.value)&&isNumber$1(e.max)?e.max<e.value?`${e.max}+`:`${e.value}`:`${e.value}`);return n({content:s}),(i,o)=>(openBlock(),createElementBlock("div",{class:normalizeClass(unref(r).b())},[renderSlot(i.$slots,"default"),createVNode(Transition,{name:`${unref(r).namespace.value}-zoom-in-center`,persisted:""},{default:withCtx(()=>[withDirectives(createBaseVNode("sup",{class:normalizeClass([unref(r).e("content"),unref(r).em("content",i.type),unref(r).is("fixed",!!i.$slots.default),unref(r).is("dot",i.isDot)]),textContent:toDisplayString(unref(s))},null,10,_hoisted_1$7),[[vShow,!i.hidden&&(unref(s)||i.isDot)]])]),_:1},8,["name"])],2))}});var Badge=_export_sfc(_sfc_main$o,[["__file","badge.vue"]]);const ElBadge=withInstall(Badge),buttonGroupContextKey=Symbol("buttonGroupContextKey"),useButton=(t,n)=>{useDeprecated({from:"type.text",replacement:"link",version:"3.0.0",scope:"props",ref:"https://element-plus.org/en-US/component/button.html#button-attributes"},computed(()=>t.type==="text"));const e=inject(buttonGroupContextKey,void 0),r=useGlobalConfig("button"),{form:s}=useFormItem(),i=useFormSize(computed(()=>e==null?void 0:e.size)),o=useFormDisabled(),a=ref(),d=useSlots(),c=computed(()=>t.type||(e==null?void 0:e.type)||""),u=computed(()=>{var O,k,g;return(g=(k=t.autoInsertSpace)!=null?k:(O=r.value)==null?void 0:O.autoInsertSpace)!=null?g:!1}),m=computed(()=>t.tag==="button"?{ariaDisabled:o.value||t.loading,disabled:o.value||t.loading,autofocus:t.autofocus,type:t.nativeType}:{}),y=computed(()=>{var O;const k=(O=d.default)==null?void 0:O.call(d);if(u.value&&(k==null?void 0:k.length)===1){const g=k[0];if((g==null?void 0:g.type)===Text){const v=g.children;return/^\p{Unified_Ideograph}{2}$/u.test(v.trim())}}return!1});return{_disabled:o,_size:i,_type:c,_ref:a,_props:m,shouldAddSpace:y,handleClick:O=>{t.nativeType==="reset"&&(s==null||s.resetFields()),n("click",O)}}},buttonTypes=["default","primary","success","warning","info","danger","text",""],buttonNativeTypes=["button","submit","reset"],buttonProps=buildProps({size:useSizeProp,disabled:Boolean,type:{type:String,values:buttonTypes,default:""},icon:{type:iconPropType},nativeType:{type:String,values:buttonNativeTypes,default:"button"},loading:Boolean,loadingIcon:{type:iconPropType,default:()=>loading_default},plain:Boolean,text:Boolean,link:Boolean,bg:Boolean,autofocus:Boolean,round:Boolean,circle:Boolean,color:String,dark:Boolean,autoInsertSpace:{type:Boolean,default:void 0},tag:{type:definePropType([String,Object]),default:"button"}}),buttonEmits={click:t=>t instanceof MouseEvent};function bound01(t,n){isOnePointZero(t)&&(t="100%");var e=isPercentage(t);return t=n===360?t:Math.min(n,Math.max(0,parseFloat(t))),e&&(t=parseInt(String(t*n),10)/100),Math.abs(t-n)<1e-6?1:(n===360?t=(t<0?t%n+n:t%n)/parseFloat(String(n)):t=t%n/parseFloat(String(n)),t)}function clamp01(t){return Math.min(1,Math.max(0,t))}function isOnePointZero(t){return typeof t=="string"&&t.indexOf(".")!==-1&&parseFloat(t)===1}function isPercentage(t){return typeof t=="string"&&t.indexOf("%")!==-1}function boundAlpha(t){return t=parseFloat(t),(isNaN(t)||t<0||t>1)&&(t=1),t}function convertToPercentage(t){return t<=1?"".concat(Number(t)*100,"%"):t}function pad2(t){return t.length===1?"0"+t:String(t)}function rgbToRgb(t,n,e){return{r:bound01(t,255)*255,g:bound01(n,255)*255,b:bound01(e,255)*255}}function rgbToHsl(t,n,e){t=bound01(t,255),n=bound01(n,255),e=bound01(e,255);var r=Math.max(t,n,e),s=Math.min(t,n,e),i=0,o=0,a=(r+s)/2;if(r===s)o=0,i=0;else{var d=r-s;switch(o=a>.5?d/(2-r-s):d/(r+s),r){case t:i=(n-e)/d+(n<e?6:0);break;case n:i=(e-t)/d+2;break;case e:i=(t-n)/d+4;break}i/=6}return{h:i,s:o,l:a}}function hue2rgb(t,n,e){return e<0&&(e+=1),e>1&&(e-=1),e<1/6?t+(n-t)*(6*e):e<1/2?n:e<2/3?t+(n-t)*(2/3-e)*6:t}function hslToRgb(t,n,e){var r,s,i;if(t=bound01(t,360),n=bound01(n,100),e=bound01(e,100),n===0)s=e,i=e,r=e;else{var o=e<.5?e*(1+n):e+n-e*n,a=2*e-o;r=hue2rgb(a,o,t+1/3),s=hue2rgb(a,o,t),i=hue2rgb(a,o,t-1/3)}return{r:r*255,g:s*255,b:i*255}}function rgbToHsv(t,n,e){t=bound01(t,255),n=bound01(n,255),e=bound01(e,255);var r=Math.max(t,n,e),s=Math.min(t,n,e),i=0,o=r,a=r-s,d=r===0?0:a/r;if(r===s)i=0;else{switch(r){case t:i=(n-e)/a+(n<e?6:0);break;case n:i=(e-t)/a+2;break;case e:i=(t-n)/a+4;break}i/=6}return{h:i,s:d,v:o}}function hsvToRgb(t,n,e){t=bound01(t,360)*6,n=bound01(n,100),e=bound01(e,100);var r=Math.floor(t),s=t-r,i=e*(1-n),o=e*(1-s*n),a=e*(1-(1-s)*n),d=r%6,c=[e,o,i,i,a,e][d],u=[a,e,e,o,i,i][d],m=[i,i,a,e,e,o][d];return{r:c*255,g:u*255,b:m*255}}function rgbToHex(t,n,e,r){var s=[pad2(Math.round(t).toString(16)),pad2(Math.round(n).toString(16)),pad2(Math.round(e).toString(16))];return r&&s[0].startsWith(s[0].charAt(1))&&s[1].startsWith(s[1].charAt(1))&&s[2].startsWith(s[2].charAt(1))?s[0].charAt(0)+s[1].charAt(0)+s[2].charAt(0):s.join("")}function rgbaToHex(t,n,e,r,s){var i=[pad2(Math.round(t).toString(16)),pad2(Math.round(n).toString(16)),pad2(Math.round(e).toString(16)),pad2(convertDecimalToHex(r))];return s&&i[0].startsWith(i[0].charAt(1))&&i[1].startsWith(i[1].charAt(1))&&i[2].startsWith(i[2].charAt(1))&&i[3].startsWith(i[3].charAt(1))?i[0].charAt(0)+i[1].charAt(0)+i[2].charAt(0)+i[3].charAt(0):i.join("")}function convertDecimalToHex(t){return Math.round(parseFloat(t)*255).toString(16)}function convertHexToDecimal(t){return parseIntFromHex(t)/255}function parseIntFromHex(t){return parseInt(t,16)}function numberInputToObject(t){return{r:t>>16,g:(t&65280)>>8,b:t&255}}var names={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",goldenrod:"#daa520",gold:"#ffd700",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavenderblush:"#fff0f5",lavender:"#e6e6fa",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};function inputToRGB(t){var n={r:0,g:0,b:0},e=1,r=null,s=null,i=null,o=!1,a=!1;return typeof t=="string"&&(t=stringInputToObject(t)),typeof t=="object"&&(isValidCSSUnit(t.r)&&isValidCSSUnit(t.g)&&isValidCSSUnit(t.b)?(n=rgbToRgb(t.r,t.g,t.b),o=!0,a=String(t.r).substr(-1)==="%"?"prgb":"rgb"):isValidCSSUnit(t.h)&&isValidCSSUnit(t.s)&&isValidCSSUnit(t.v)?(r=convertToPercentage(t.s),s=convertToPercentage(t.v),n=hsvToRgb(t.h,r,s),o=!0,a="hsv"):isValidCSSUnit(t.h)&&isValidCSSUnit(t.s)&&isValidCSSUnit(t.l)&&(r=convertToPercentage(t.s),i=convertToPercentage(t.l),n=hslToRgb(t.h,r,i),o=!0,a="hsl"),Object.prototype.hasOwnProperty.call(t,"a")&&(e=t.a)),e=boundAlpha(e),{ok:o,format:t.format||a,r:Math.min(255,Math.max(n.r,0)),g:Math.min(255,Math.max(n.g,0)),b:Math.min(255,Math.max(n.b,0)),a:e}}var CSS_INTEGER="[-\\+]?\\d+%?",CSS_NUMBER="[-\\+]?\\d*\\.\\d+%?",CSS_UNIT="(?:".concat(CSS_NUMBER,")|(?:").concat(CSS_INTEGER,")"),PERMISSIVE_MATCH3="[\\s|\\(]+(".concat(CSS_UNIT,")[,|\\s]+(").concat(CSS_UNIT,")[,|\\s]+(").concat(CSS_UNIT,")\\s*\\)?"),PERMISSIVE_MATCH4="[\\s|\\(]+(".concat(CSS_UNIT,")[,|\\s]+(").concat(CSS_UNIT,")[,|\\s]+(").concat(CSS_UNIT,")[,|\\s]+(").concat(CSS_UNIT,")\\s*\\)?"),matchers={CSS_UNIT:new RegExp(CSS_UNIT),rgb:new RegExp("rgb"+PERMISSIVE_MATCH3),rgba:new RegExp("rgba"+PERMISSIVE_MATCH4),hsl:new RegExp("hsl"+PERMISSIVE_MATCH3),hsla:new RegExp("hsla"+PERMISSIVE_MATCH4),hsv:new RegExp("hsv"+PERMISSIVE_MATCH3),hsva:new RegExp("hsva"+PERMISSIVE_MATCH4),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/};function stringInputToObject(t){if(t=t.trim().toLowerCase(),t.length===0)return!1;var n=!1;if(names[t])t=names[t],n=!0;else if(t==="transparent")return{r:0,g:0,b:0,a:0,format:"name"};var e=matchers.rgb.exec(t);return e?{r:e[1],g:e[2],b:e[3]}:(e=matchers.rgba.exec(t),e?{r:e[1],g:e[2],b:e[3],a:e[4]}:(e=matchers.hsl.exec(t),e?{h:e[1],s:e[2],l:e[3]}:(e=matchers.hsla.exec(t),e?{h:e[1],s:e[2],l:e[3],a:e[4]}:(e=matchers.hsv.exec(t),e?{h:e[1],s:e[2],v:e[3]}:(e=matchers.hsva.exec(t),e?{h:e[1],s:e[2],v:e[3],a:e[4]}:(e=matchers.hex8.exec(t),e?{r:parseIntFromHex(e[1]),g:parseIntFromHex(e[2]),b:parseIntFromHex(e[3]),a:convertHexToDecimal(e[4]),format:n?"name":"hex8"}:(e=matchers.hex6.exec(t),e?{r:parseIntFromHex(e[1]),g:parseIntFromHex(e[2]),b:parseIntFromHex(e[3]),format:n?"name":"hex"}:(e=matchers.hex4.exec(t),e?{r:parseIntFromHex(e[1]+e[1]),g:parseIntFromHex(e[2]+e[2]),b:parseIntFromHex(e[3]+e[3]),a:convertHexToDecimal(e[4]+e[4]),format:n?"name":"hex8"}:(e=matchers.hex3.exec(t),e?{r:parseIntFromHex(e[1]+e[1]),g:parseIntFromHex(e[2]+e[2]),b:parseIntFromHex(e[3]+e[3]),format:n?"name":"hex"}:!1)))))))))}function isValidCSSUnit(t){return!!matchers.CSS_UNIT.exec(String(t))}var TinyColor=function(){function t(n,e){n===void 0&&(n=""),e===void 0&&(e={});var r;if(n instanceof t)return n;typeof n=="number"&&(n=numberInputToObject(n)),this.originalInput=n;var s=inputToRGB(n);this.originalInput=n,this.r=s.r,this.g=s.g,this.b=s.b,this.a=s.a,this.roundA=Math.round(100*this.a)/100,this.format=(r=e.format)!==null&&r!==void 0?r:s.format,this.gradientType=e.gradientType,this.r<1&&(this.r=Math.round(this.r)),this.g<1&&(this.g=Math.round(this.g)),this.b<1&&(this.b=Math.round(this.b)),this.isValid=s.ok}return t.prototype.isDark=function(){return this.getBrightness()<128},t.prototype.isLight=function(){return!this.isDark()},t.prototype.getBrightness=function(){var n=this.toRgb();return(n.r*299+n.g*587+n.b*114)/1e3},t.prototype.getLuminance=function(){var n=this.toRgb(),e,r,s,i=n.r/255,o=n.g/255,a=n.b/255;return i<=.03928?e=i/12.92:e=Math.pow((i+.055)/1.055,2.4),o<=.03928?r=o/12.92:r=Math.pow((o+.055)/1.055,2.4),a<=.03928?s=a/12.92:s=Math.pow((a+.055)/1.055,2.4),.2126*e+.7152*r+.0722*s},t.prototype.getAlpha=function(){return this.a},t.prototype.setAlpha=function(n){return this.a=boundAlpha(n),this.roundA=Math.round(100*this.a)/100,this},t.prototype.isMonochrome=function(){var n=this.toHsl().s;return n===0},t.prototype.toHsv=function(){var n=rgbToHsv(this.r,this.g,this.b);return{h:n.h*360,s:n.s,v:n.v,a:this.a}},t.prototype.toHsvString=function(){var n=rgbToHsv(this.r,this.g,this.b),e=Math.round(n.h*360),r=Math.round(n.s*100),s=Math.round(n.v*100);return this.a===1?"hsv(".concat(e,", ").concat(r,"%, ").concat(s,"%)"):"hsva(".concat(e,", ").concat(r,"%, ").concat(s,"%, ").concat(this.roundA,")")},t.prototype.toHsl=function(){var n=rgbToHsl(this.r,this.g,this.b);return{h:n.h*360,s:n.s,l:n.l,a:this.a}},t.prototype.toHslString=function(){var n=rgbToHsl(this.r,this.g,this.b),e=Math.round(n.h*360),r=Math.round(n.s*100),s=Math.round(n.l*100);return this.a===1?"hsl(".concat(e,", ").concat(r,"%, ").concat(s,"%)"):"hsla(".concat(e,", ").concat(r,"%, ").concat(s,"%, ").concat(this.roundA,")")},t.prototype.toHex=function(n){return n===void 0&&(n=!1),rgbToHex(this.r,this.g,this.b,n)},t.prototype.toHexString=function(n){return n===void 0&&(n=!1),"#"+this.toHex(n)},t.prototype.toHex8=function(n){return n===void 0&&(n=!1),rgbaToHex(this.r,this.g,this.b,this.a,n)},t.prototype.toHex8String=function(n){return n===void 0&&(n=!1),"#"+this.toHex8(n)},t.prototype.toHexShortString=function(n){return n===void 0&&(n=!1),this.a===1?this.toHexString(n):this.toHex8String(n)},t.prototype.toRgb=function(){return{r:Math.round(this.r),g:Math.round(this.g),b:Math.round(this.b),a:this.a}},t.prototype.toRgbString=function(){var n=Math.round(this.r),e=Math.round(this.g),r=Math.round(this.b);return this.a===1?"rgb(".concat(n,", ").concat(e,", ").concat(r,")"):"rgba(".concat(n,", ").concat(e,", ").concat(r,", ").concat(this.roundA,")")},t.prototype.toPercentageRgb=function(){var n=function(e){return"".concat(Math.round(bound01(e,255)*100),"%")};return{r:n(this.r),g:n(this.g),b:n(this.b),a:this.a}},t.prototype.toPercentageRgbString=function(){var n=function(e){return Math.round(bound01(e,255)*100)};return this.a===1?"rgb(".concat(n(this.r),"%, ").concat(n(this.g),"%, ").concat(n(this.b),"%)"):"rgba(".concat(n(this.r),"%, ").concat(n(this.g),"%, ").concat(n(this.b),"%, ").concat(this.roundA,")")},t.prototype.toName=function(){if(this.a===0)return"transparent";if(this.a<1)return!1;for(var n="#"+rgbToHex(this.r,this.g,this.b,!1),e=0,r=Object.entries(names);e<r.length;e++){var s=r[e],i=s[0],o=s[1];if(n===o)return i}return!1},t.prototype.toString=function(n){var e=!!n;n=n??this.format;var r=!1,s=this.a<1&&this.a>=0,i=!e&&s&&(n.startsWith("hex")||n==="name");return i?n==="name"&&this.a===0?this.toName():this.toRgbString():(n==="rgb"&&(r=this.toRgbString()),n==="prgb"&&(r=this.toPercentageRgbString()),(n==="hex"||n==="hex6")&&(r=this.toHexString()),n==="hex3"&&(r=this.toHexString(!0)),n==="hex4"&&(r=this.toHex8String(!0)),n==="hex8"&&(r=this.toHex8String()),n==="name"&&(r=this.toName()),n==="hsl"&&(r=this.toHslString()),n==="hsv"&&(r=this.toHsvString()),r||this.toHexString())},t.prototype.toNumber=function(){return(Math.round(this.r)<<16)+(Math.round(this.g)<<8)+Math.round(this.b)},t.prototype.clone=function(){return new t(this.toString())},t.prototype.lighten=function(n){n===void 0&&(n=10);var e=this.toHsl();return e.l+=n/100,e.l=clamp01(e.l),new t(e)},t.prototype.brighten=function(n){n===void 0&&(n=10);var e=this.toRgb();return e.r=Math.max(0,Math.min(255,e.r-Math.round(255*-(n/100)))),e.g=Math.max(0,Math.min(255,e.g-Math.round(255*-(n/100)))),e.b=Math.max(0,Math.min(255,e.b-Math.round(255*-(n/100)))),new t(e)},t.prototype.darken=function(n){n===void 0&&(n=10);var e=this.toHsl();return e.l-=n/100,e.l=clamp01(e.l),new t(e)},t.prototype.tint=function(n){return n===void 0&&(n=10),this.mix("white",n)},t.prototype.shade=function(n){return n===void 0&&(n=10),this.mix("black",n)},t.prototype.desaturate=function(n){n===void 0&&(n=10);var e=this.toHsl();return e.s-=n/100,e.s=clamp01(e.s),new t(e)},t.prototype.saturate=function(n){n===void 0&&(n=10);var e=this.toHsl();return e.s+=n/100,e.s=clamp01(e.s),new t(e)},t.prototype.greyscale=function(){return this.desaturate(100)},t.prototype.spin=function(n){var e=this.toHsl(),r=(e.h+n)%360;return e.h=r<0?360+r:r,new t(e)},t.prototype.mix=function(n,e){e===void 0&&(e=50);var r=this.toRgb(),s=new t(n).toRgb(),i=e/100,o={r:(s.r-r.r)*i+r.r,g:(s.g-r.g)*i+r.g,b:(s.b-r.b)*i+r.b,a:(s.a-r.a)*i+r.a};return new t(o)},t.prototype.analogous=function(n,e){n===void 0&&(n=6),e===void 0&&(e=30);var r=this.toHsl(),s=360/e,i=[this];for(r.h=(r.h-(s*n>>1)+720)%360;--n;)r.h=(r.h+s)%360,i.push(new t(r));return i},t.prototype.complement=function(){var n=this.toHsl();return n.h=(n.h+180)%360,new t(n)},t.prototype.monochromatic=function(n){n===void 0&&(n=6);for(var e=this.toHsv(),r=e.h,s=e.s,i=e.v,o=[],a=1/n;n--;)o.push(new t({h:r,s,v:i})),i=(i+a)%1;return o},t.prototype.splitcomplement=function(){var n=this.toHsl(),e=n.h;return[this,new t({h:(e+72)%360,s:n.s,l:n.l}),new t({h:(e+216)%360,s:n.s,l:n.l})]},t.prototype.onBackground=function(n){var e=this.toRgb(),r=new t(n).toRgb(),s=e.a+r.a*(1-e.a);return new t({r:(e.r*e.a+r.r*r.a*(1-e.a))/s,g:(e.g*e.a+r.g*r.a*(1-e.a))/s,b:(e.b*e.a+r.b*r.a*(1-e.a))/s,a:s})},t.prototype.triad=function(){return this.polyad(3)},t.prototype.tetrad=function(){return this.polyad(4)},t.prototype.polyad=function(n){for(var e=this.toHsl(),r=e.h,s=[this],i=360/n,o=1;o<n;o++)s.push(new t({h:(r+o*i)%360,s:e.s,l:e.l}));return s},t.prototype.equals=function(n){return this.toRgbString()===new t(n).toRgbString()},t}();function darken(t,n=20){return t.mix("#141414",n).toString()}function useButtonCustomStyle(t){const n=useFormDisabled(),e=useNamespace("button");return computed(()=>{let r={};const s=t.color;if(s){const i=new TinyColor(s),o=t.dark?i.tint(20).toString():darken(i,20);if(t.plain)r=e.cssVarBlock({"bg-color":t.dark?darken(i,90):i.tint(90).toString(),"text-color":s,"border-color":t.dark?darken(i,50):i.tint(50).toString(),"hover-text-color":`var(${e.cssVarName("color-white")})`,"hover-bg-color":s,"hover-border-color":s,"active-bg-color":o,"active-text-color":`var(${e.cssVarName("color-white")})`,"active-border-color":o}),n.value&&(r[e.cssVarBlockName("disabled-bg-color")]=t.dark?darken(i,90):i.tint(90).toString(),r[e.cssVarBlockName("disabled-text-color")]=t.dark?darken(i,50):i.tint(50).toString(),r[e.cssVarBlockName("disabled-border-color")]=t.dark?darken(i,80):i.tint(80).toString());else{const a=t.dark?darken(i,30):i.tint(30).toString(),d=i.isDark()?`var(${e.cssVarName("color-white")})`:`var(${e.cssVarName("color-black")})`;if(r=e.cssVarBlock({"bg-color":s,"text-color":d,"border-color":s,"hover-bg-color":a,"hover-text-color":d,"hover-border-color":a,"active-bg-color":o,"active-border-color":o}),n.value){const c=t.dark?darken(i,50):i.tint(50).toString();r[e.cssVarBlockName("disabled-bg-color")]=c,r[e.cssVarBlockName("disabled-text-color")]=t.dark?"rgba(255, 255, 255, 0.5)":`var(${e.cssVarName("color-white")})`,r[e.cssVarBlockName("disabled-border-color")]=c}}}return r})}const __default__$b=defineComponent({name:"ElButton"}),_sfc_main$n=defineComponent({...__default__$b,props:buttonProps,emits:buttonEmits,setup(t,{expose:n,emit:e}){const r=t,s=useButtonCustomStyle(r),i=useNamespace("button"),{_ref:o,_size:a,_type:d,_disabled:c,_props:u,shouldAddSpace:m,handleClick:y}=useButton(r,e);return n({ref:o,size:a,type:d,disabled:c,shouldAddSpace:m}),(S,O)=>(openBlock(),createBlock(resolveDynamicComponent(S.tag),mergeProps({ref_key:"_ref",ref:o},unref(u),{class:[unref(i).b(),unref(i).m(unref(d)),unref(i).m(unref(a)),unref(i).is("disabled",unref(c)),unref(i).is("loading",S.loading),unref(i).is("plain",S.plain),unref(i).is("round",S.round),unref(i).is("circle",S.circle),unref(i).is("text",S.text),unref(i).is("link",S.link),unref(i).is("has-bg",S.bg)],style:unref(s),onClick:unref(y)}),{default:withCtx(()=>[S.loading?(openBlock(),createElementBlock(Fragment,{key:0},[S.$slots.loading?renderSlot(S.$slots,"loading",{key:0}):(openBlock(),createBlock(unref(ElIcon),{key:1,class:normalizeClass(unref(i).is("loading"))},{default:withCtx(()=>[(openBlock(),createBlock(resolveDynamicComponent(S.loadingIcon)))]),_:1},8,["class"]))],64)):S.icon||S.$slots.icon?(openBlock(),createBlock(unref(ElIcon),{key:1},{default:withCtx(()=>[S.icon?(openBlock(),createBlock(resolveDynamicComponent(S.icon),{key:0})):renderSlot(S.$slots,"icon",{key:1})]),_:3})):createCommentVNode("v-if",!0),S.$slots.default?(openBlock(),createElementBlock("span",{key:2,class:normalizeClass({[unref(i).em("text","expand")]:unref(m)})},[renderSlot(S.$slots,"default")],2)):createCommentVNode("v-if",!0)]),_:3},16,["class","style","onClick"]))}});var Button=_export_sfc(_sfc_main$n,[["__file","button.vue"]]);const buttonGroupProps={size:buttonProps.size,type:buttonProps.type},__default__$a=defineComponent({name:"ElButtonGroup"}),_sfc_main$m=defineComponent({...__default__$a,props:buttonGroupProps,setup(t){const n=t;provide(buttonGroupContextKey,reactive({size:toRef(n,"size"),type:toRef(n,"type")}));const e=useNamespace("button");return(r,s)=>(openBlock(),createElementBlock("div",{class:normalizeClass(`${unref(e).b("group")}`)},[renderSlot(r.$slots,"default")],2))}});var ButtonGroup=_export_sfc(_sfc_main$m,[["__file","button-group.vue"]]);const ElButton=withInstall(Button,{ButtonGroup});withNoopInstall(ButtonGroup);var commonjsGlobal=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function getDefaultExportFromCjs(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var dayjs_min={exports:{}};(function(t,n){(function(e,r){t.exports=r()})(commonjsGlobal,function(){var e=1e3,r=6e4,s=36e5,i="millisecond",o="second",a="minute",d="hour",c="day",u="week",m="month",y="quarter",S="year",O="date",k="Invalid Date",g=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,v=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,ue={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(qe){var Oe=["th","st","nd","rd"],$e=qe%100;return"["+qe+(Oe[($e-20)%10]||Oe[$e]||Oe[0])+"]"}},L=function(qe,Oe,$e){var _e=String(qe);return!_e||_e.length>=Oe?qe:""+Array(Oe+1-_e.length).join($e)+qe},re={s:L,z:function(qe){var Oe=-qe.utcOffset(),$e=Math.abs(Oe),_e=Math.floor($e/60),er=$e%60;return(Oe<=0?"+":"-")+L(_e,2,"0")+":"+L(er,2,"0")},m:function qe(Oe,$e){if(Oe.date()<$e.date())return-qe($e,Oe);var _e=12*($e.year()-Oe.year())+($e.month()-Oe.month()),er=Oe.clone().add(_e,m),Pt=$e-er<0,ar=Oe.clone().add(_e+(Pt?-1:1),m);return+(-(_e+($e-er)/(Pt?er-ar:ar-er))||0)},a:function(qe){return qe<0?Math.ceil(qe)||0:Math.floor(qe)},p:function(qe){return{M:m,y:S,w:u,d:c,D:O,h:d,m:a,s:o,ms:i,Q:y}[qe]||String(qe||"").toLowerCase().replace(/s$/,"")},u:function(qe){return qe===void 0}},le="en",oe={};oe[le]=ue;var he="$isDayjsObject",Ie=function(qe){return qe instanceof Ce||!(!qe||!qe[he])},ie=function qe(Oe,$e,_e){var er;if(!Oe)return le;if(typeof Oe=="string"){var Pt=Oe.toLowerCase();oe[Pt]&&(er=Pt),$e&&(oe[Pt]=$e,er=Pt);var ar=Oe.split("-");if(!er&&ar.length>1)return qe(ar[0])}else{var pr=Oe.name;oe[pr]=Oe,er=pr}return!_e&&er&&(le=er),er||!_e&&le},Ne=function(qe,Oe){if(Ie(qe))return qe.clone();var $e=typeof Oe=="object"?Oe:{};return $e.date=qe,$e.args=arguments,new Ce($e)},Ve=re;Ve.l=ie,Ve.i=Ie,Ve.w=function(qe,Oe){return Ne(qe,{locale:Oe.$L,utc:Oe.$u,x:Oe.$x,$offset:Oe.$offset})};var Ce=function(){function qe($e){this.$L=ie($e.locale,null,!0),this.parse($e),this.$x=this.$x||$e.x||{},this[he]=!0}var Oe=qe.prototype;return Oe.parse=function($e){this.$d=function(_e){var er=_e.date,Pt=_e.utc;if(er===null)return new Date(NaN);if(Ve.u(er))return new Date;if(er instanceof Date)return new Date(er);if(typeof er=="string"&&!/Z$/i.test(er)){var ar=er.match(g);if(ar){var pr=ar[2]-1||0,lr=(ar[7]||"0").substring(0,3);return Pt?new Date(Date.UTC(ar[1],pr,ar[3]||1,ar[4]||0,ar[5]||0,ar[6]||0,lr)):new Date(ar[1],pr,ar[3]||1,ar[4]||0,ar[5]||0,ar[6]||0,lr)}}return new Date(er)}($e),this.init()},Oe.init=function(){var $e=this.$d;this.$y=$e.getFullYear(),this.$M=$e.getMonth(),this.$D=$e.getDate(),this.$W=$e.getDay(),this.$H=$e.getHours(),this.$m=$e.getMinutes(),this.$s=$e.getSeconds(),this.$ms=$e.getMilliseconds()},Oe.$utils=function(){return Ve},Oe.isValid=function(){return this.$d.toString()!==k},Oe.isSame=function($e,_e){var er=Ne($e);return this.startOf(_e)<=er&&er<=this.endOf(_e)},Oe.isAfter=function($e,_e){return Ne($e)<this.startOf(_e)},Oe.isBefore=function($e,_e){return this.endOf(_e)<Ne($e)},Oe.$g=function($e,_e,er){return Ve.u($e)?this[_e]:this.set(er,$e)},Oe.unix=function(){return Math.floor(this.valueOf()/1e3)},Oe.valueOf=function(){return this.$d.getTime()},Oe.startOf=function($e,_e){var er=this,Pt=!!Ve.u(_e)||_e,ar=Ve.p($e),pr=function(cr,mr){var tr=Ve.w(er.$u?Date.UTC(er.$y,mr,cr):new Date(er.$y,mr,cr),er);return Pt?tr:tr.endOf(c)},lr=function(cr,mr){return Ve.w(er.toDate()[cr].apply(er.toDate("s"),(Pt?[0,0,0,0]:[23,59,59,999]).slice(mr)),er)},or=this.$W,xe=this.$M,nr=this.$D,ir="set"+(this.$u?"UTC":"");switch(ar){case S:return Pt?pr(1,0):pr(31,11);case m:return Pt?pr(1,xe):pr(0,xe+1);case u:var dr=this.$locale().weekStart||0,Lt=(or<dr?or+7:or)-dr;return pr(Pt?nr-Lt:nr+(6-Lt),xe);case c:case O:return lr(ir+"Hours",0);case d:return lr(ir+"Minutes",1);case a:return lr(ir+"Seconds",2);case o:return lr(ir+"Milliseconds",3);default:return this.clone()}},Oe.endOf=function($e){return this.startOf($e,!1)},Oe.$set=function($e,_e){var er,Pt=Ve.p($e),ar="set"+(this.$u?"UTC":""),pr=(er={},er[c]=ar+"Date",er[O]=ar+"Date",er[m]=ar+"Month",er[S]=ar+"FullYear",er[d]=ar+"Hours",er[a]=ar+"Minutes",er[o]=ar+"Seconds",er[i]=ar+"Milliseconds",er)[Pt],lr=Pt===c?this.$D+(_e-this.$W):_e;if(Pt===m||Pt===S){var or=this.clone().set(O,1);or.$d[pr](lr),or.init(),this.$d=or.set(O,Math.min(this.$D,or.daysInMonth())).$d}else pr&&this.$d[pr](lr);return this.init(),this},Oe.set=function($e,_e){return this.clone().$set($e,_e)},Oe.get=function($e){return this[Ve.p($e)]()},Oe.add=function($e,_e){var er,Pt=this;$e=Number($e);var ar=Ve.p(_e),pr=function(xe){var nr=Ne(Pt);return Ve.w(nr.date(nr.date()+Math.round(xe*$e)),Pt)};if(ar===m)return this.set(m,this.$M+$e);if(ar===S)return this.set(S,this.$y+$e);if(ar===c)return pr(1);if(ar===u)return pr(7);var lr=(er={},er[a]=r,er[d]=s,er[o]=e,er)[ar]||1,or=this.$d.getTime()+$e*lr;return Ve.w(or,this)},Oe.subtract=function($e,_e){return this.add(-1*$e,_e)},Oe.format=function($e){var _e=this,er=this.$locale();if(!this.isValid())return er.invalidDate||k;var Pt=$e||"YYYY-MM-DDTHH:mm:ssZ",ar=Ve.z(this),pr=this.$H,lr=this.$m,or=this.$M,xe=er.weekdays,nr=er.months,ir=er.meridiem,dr=function(mr,tr,At,kt){return mr&&(mr[tr]||mr(_e,Pt))||At[tr].slice(0,kt)},Lt=function(mr){return Ve.s(pr%12||12,mr,"0")},cr=ir||function(mr,tr,At){var kt=mr<12?"AM":"PM";return At?kt.toLowerCase():kt};return Pt.replace(v,function(mr,tr){return tr||function(At){switch(At){case"YY":return String(_e.$y).slice(-2);case"YYYY":return Ve.s(_e.$y,4,"0");case"M":return or+1;case"MM":return Ve.s(or+1,2,"0");case"MMM":return dr(er.monthsShort,or,nr,3);case"MMMM":return dr(nr,or);case"D":return _e.$D;case"DD":return Ve.s(_e.$D,2,"0");case"d":return String(_e.$W);case"dd":return dr(er.weekdaysMin,_e.$W,xe,2);case"ddd":return dr(er.weekdaysShort,_e.$W,xe,3);case"dddd":return xe[_e.$W];case"H":return String(pr);case"HH":return Ve.s(pr,2,"0");case"h":return Lt(1);case"hh":return Lt(2);case"a":return cr(pr,lr,!0);case"A":return cr(pr,lr,!1);case"m":return String(lr);case"mm":return Ve.s(lr,2,"0");case"s":return String(_e.$s);case"ss":return Ve.s(_e.$s,2,"0");case"SSS":return Ve.s(_e.$ms,3,"0");case"Z":return ar}return null}(mr)||ar.replace(":","")})},Oe.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},Oe.diff=function($e,_e,er){var Pt,ar=this,pr=Ve.p(_e),lr=Ne($e),or=(lr.utcOffset()-this.utcOffset())*r,xe=this-lr,nr=function(){return Ve.m(ar,lr)};switch(pr){case S:Pt=nr()/12;break;case m:Pt=nr();break;case y:Pt=nr()/3;break;case u:Pt=(xe-or)/6048e5;break;case c:Pt=(xe-or)/864e5;break;case d:Pt=xe/s;break;case a:Pt=xe/r;break;case o:Pt=xe/e;break;default:Pt=xe}return er?Pt:Ve.a(Pt)},Oe.daysInMonth=function(){return this.endOf(m).$D},Oe.$locale=function(){return oe[this.$L]},Oe.locale=function($e,_e){if(!$e)return this.$L;var er=this.clone(),Pt=ie($e,_e,!0);return Pt&&(er.$L=Pt),er},Oe.clone=function(){return Ve.w(this.$d,this)},Oe.toDate=function(){return new Date(this.valueOf())},Oe.toJSON=function(){return this.isValid()?this.toISOString():null},Oe.toISOString=function(){return this.$d.toISOString()},Oe.toString=function(){return this.$d.toUTCString()},qe}(),Ue=Ce.prototype;return Ne.prototype=Ue,[["$ms",i],["$s",o],["$m",a],["$H",d],["$W",c],["$M",m],["$y",S],["$D",O]].forEach(function(qe){Ue[qe[1]]=function(Oe){return this.$g(Oe,qe[0],qe[1])}}),Ne.extend=function(qe,Oe){return qe.$i||(qe(Oe,Ce,Ne),qe.$i=!0),Ne},Ne.locale=ie,Ne.isDayjs=Ie,Ne.unix=function(qe){return Ne(1e3*qe)},Ne.en=oe[le],Ne.Ls=oe,Ne.p={},Ne})})(dayjs_min);var dayjs_minExports=dayjs_min.exports;const dayjs=getDefaultExportFromCjs(dayjs_minExports),FOCUSABLE_CHILDREN="_trap-focus-children",FOCUS_STACK=[],FOCUS_HANDLER=t=>{if(FOCUS_STACK.length===0)return;const n=FOCUS_STACK[FOCUS_STACK.length-1][FOCUSABLE_CHILDREN];if(n.length>0&&t.code===EVENT_CODE.tab){if(n.length===1){t.preventDefault(),document.activeElement!==n[0]&&n[0].focus();return}const e=t.shiftKey,r=t.target===n[0],s=t.target===n[n.length-1];r&&e&&(t.preventDefault(),n[n.length-1].focus()),s&&!e&&(t.preventDefault(),n[0].focus())}},TrapFocus={beforeMount(t){t[FOCUSABLE_CHILDREN]=obtainAllFocusableElements$1(t),FOCUS_STACK.push(t),FOCUS_STACK.length<=1&&document.addEventListener("keydown",FOCUS_HANDLER)},updated(t){nextTick(()=>{t[FOCUSABLE_CHILDREN]=obtainAllFocusableElements$1(t)})},unmounted(){FOCUS_STACK.shift(),FOCUS_STACK.length===0&&document.removeEventListener("keydown",FOCUS_HANDLER)}},rowContextKey=Symbol("rowContextKey"),RowJustify=["start","center","end","space-around","space-between","space-evenly"],RowAlign=["top","middle","bottom"],rowProps=buildProps({tag:{type:String,default:"div"},gutter:{type:Number,default:0},justify:{type:String,values:RowJustify,default:"start"},align:{type:String,values:RowAlign}}),__default__$9=defineComponent({name:"ElRow"}),_sfc_main$l=defineComponent({...__default__$9,props:rowProps,setup(t){const n=t,e=useNamespace("row"),r=computed(()=>n.gutter);provide(rowContextKey,{gutter:r});const s=computed(()=>{const o={};return n.gutter&&(o.marginRight=o.marginLeft=`-${n.gutter/2}px`),o}),i=computed(()=>[e.b(),e.is(`justify-${n.justify}`,n.justify!=="start"),e.is(`align-${n.align}`,!!n.align)]);return(o,a)=>(openBlock(),createBlock(resolveDynamicComponent(o.tag),{class:normalizeClass(unref(i)),style:normalizeStyle(unref(s))},{default:withCtx(()=>[renderSlot(o.$slots,"default")]),_:3},8,["class","style"]))}});var Row=_export_sfc(_sfc_main$l,[["__file","row.vue"]]);const ElRow=withInstall(Row),colProps=buildProps({tag:{type:String,default:"div"},span:{type:Number,default:24},offset:{type:Number,default:0},pull:{type:Number,default:0},push:{type:Number,default:0},xs:{type:definePropType([Number,Object]),default:()=>mutable({})},sm:{type:definePropType([Number,Object]),default:()=>mutable({})},md:{type:definePropType([Number,Object]),default:()=>mutable({})},lg:{type:definePropType([Number,Object]),default:()=>mutable({})},xl:{type:definePropType([Number,Object]),default:()=>mutable({})}}),__default__$8=defineComponent({name:"ElCol"}),_sfc_main$k=defineComponent({...__default__$8,props:colProps,setup(t){const n=t,{gutter:e}=inject(rowContextKey,{gutter:computed(()=>0)}),r=useNamespace("col"),s=computed(()=>{const o={};return e.value&&(o.paddingLeft=o.paddingRight=`${e.value/2}px`),o}),i=computed(()=>{const o=[];return["span","offset","pull","push"].forEach(c=>{const u=n[c];isNumber$1(u)&&(c==="span"?o.push(r.b(`${n[c]}`)):u>0&&o.push(r.b(`${c}-${n[c]}`)))}),["xs","sm","md","lg","xl"].forEach(c=>{isNumber$1(n[c])?o.push(r.b(`${c}-${n[c]}`)):isObject$2(n[c])&&Object.entries(n[c]).forEach(([u,m])=>{o.push(u!=="span"?r.b(`${c}-${u}-${m}`):r.b(`${c}-${m}`))})}),e.value&&o.push(r.is("guttered")),[r.b(),o]});return(o,a)=>(openBlock(),createBlock(resolveDynamicComponent(o.tag),{class:normalizeClass(unref(i)),style:normalizeStyle(unref(s))},{default:withCtx(()=>[renderSlot(o.$slots,"default")]),_:3},8,["class","style"]))}});var Col=_export_sfc(_sfc_main$k,[["__file","col.vue"]]);const ElCol=withInstall(Col),__default__$7=defineComponent({name:"ElContainer"}),_sfc_main$j=defineComponent({...__default__$7,props:{direction:{type:String}},setup(t){const n=t,e=useSlots(),r=useNamespace("container"),s=computed(()=>n.direction==="vertical"?!0:n.direction==="horizontal"?!1:e&&e.default?e.default().some(o=>{const a=o.type.name;return a==="ElHeader"||a==="ElFooter"}):!1);return(i,o)=>(openBlock(),createElementBlock("section",{class:normalizeClass([unref(r).b(),unref(r).is("vertical",unref(s))])},[renderSlot(i.$slots,"default")],2))}});var Container=_export_sfc(_sfc_main$j,[["__file","container.vue"]]);const __default__$6=defineComponent({name:"ElAside"}),_sfc_main$i=defineComponent({...__default__$6,props:{width:{type:String,default:null}},setup(t){const n=t,e=useNamespace("aside"),r=computed(()=>n.width?e.cssVarBlock({width:n.width}):{});return(s,i)=>(openBlock(),createElementBlock("aside",{class:normalizeClass(unref(e).b()),style:normalizeStyle(unref(r))},[renderSlot(s.$slots,"default")],6))}});var Aside=_export_sfc(_sfc_main$i,[["__file","aside.vue"]]);const __default__$5=defineComponent({name:"ElFooter"}),_sfc_main$h=defineComponent({...__default__$5,props:{height:{type:String,default:null}},setup(t){const n=t,e=useNamespace("footer"),r=computed(()=>n.height?e.cssVarBlock({height:n.height}):{});return(s,i)=>(openBlock(),createElementBlock("footer",{class:normalizeClass(unref(e).b()),style:normalizeStyle(unref(r))},[renderSlot(s.$slots,"default")],6))}});var Footer=_export_sfc(_sfc_main$h,[["__file","footer.vue"]]);const __default__$4=defineComponent({name:"ElHeader"}),_sfc_main$g=defineComponent({...__default__$4,props:{height:{type:String,default:null}},setup(t){const n=t,e=useNamespace("header"),r=computed(()=>n.height?e.cssVarBlock({height:n.height}):{});return(s,i)=>(openBlock(),createElementBlock("header",{class:normalizeClass(unref(e).b()),style:normalizeStyle(unref(r))},[renderSlot(s.$slots,"default")],6))}});var Header=_export_sfc(_sfc_main$g,[["__file","header.vue"]]);const __default__$3=defineComponent({name:"ElMain"}),_sfc_main$f=defineComponent({...__default__$3,setup(t){const n=useNamespace("main");return(e,r)=>(openBlock(),createElementBlock("main",{class:normalizeClass(unref(n).b())},[renderSlot(e.$slots,"default")],2))}});var Main=_export_sfc(_sfc_main$f,[["__file","main.vue"]]);const ElContainer=withInstall(Container,{Aside,Footer,Header,Main});withNoopInstall(Aside);withNoopInstall(Footer);const ElHeader=withNoopInstall(Header),ElMain=withNoopInstall(Main),overlayProps=buildProps({mask:{type:Boolean,default:!0},customMaskEvent:{type:Boolean,default:!1},overlayClass:{type:definePropType([String,Array,Object])},zIndex:{type:definePropType([String,Number])}}),overlayEmits={click:t=>t instanceof MouseEvent},BLOCK="overlay";var Overlay=defineComponent({name:"ElOverlay",props:overlayProps,emits:overlayEmits,setup(t,{slots:n,emit:e}){const r=useNamespace(BLOCK),s=d=>{e("click",d)},{onClick:i,onMousedown:o,onMouseup:a}=useSameTarget(t.customMaskEvent?void 0:s);return()=>t.mask?createVNode("div",{class:[r.b(),t.overlayClass],style:{zIndex:t.zIndex},onClick:i,onMousedown:o,onMouseup:a},[renderSlot(n,"default")],PatchFlags.STYLE|PatchFlags.CLASS|PatchFlags.PROPS,["onClick","onMouseup","onMousedown"]):h("div",{class:t.overlayClass,style:{zIndex:t.zIndex,position:"fixed",top:"0px",right:"0px",bottom:"0px",left:"0px"}},[renderSlot(n,"default")])}});const ElOverlay=Overlay,_sfc_main$e=defineComponent({inheritAttrs:!1});function _sfc_render$9(t,n,e,r,s,i){return renderSlot(t.$slots,"default")}var Collection=_export_sfc(_sfc_main$e,[["render",_sfc_render$9],["__file","collection.vue"]]);const _sfc_main$d=defineComponent({name:"ElCollectionItem",inheritAttrs:!1});function _sfc_render$8(t,n,e,r,s,i){return renderSlot(t.$slots,"default")}var CollectionItem=_export_sfc(_sfc_main$d,[["render",_sfc_render$8],["__file","collection-item.vue"]]);const COLLECTION_ITEM_SIGN="data-el-collection-item",createCollectionWithScope=t=>{const n=`El${t}Collection`,e=`${n}Item`,r=Symbol(n),s=Symbol(e),i={...Collection,name:n,setup(){const a=ref(null),d=new Map;provide(r,{itemMap:d,getItems:()=>{const u=unref(a);if(!u)return[];const m=Array.from(u.querySelectorAll(`[${COLLECTION_ITEM_SIGN}]`));return[...d.values()].sort((S,O)=>m.indexOf(S.ref)-m.indexOf(O.ref))},collectionRef:a})}},o={...CollectionItem,name:e,setup(a,{attrs:d}){const c=ref(null),u=inject(r,void 0);provide(s,{collectionItemRef:c}),onMounted(()=>{const m=unref(c);m&&u.itemMap.set(m,{ref:m,...d})}),onBeforeUnmount(()=>{const m=unref(c);u.itemMap.delete(m)})}};return{COLLECTION_INJECTION_KEY:r,COLLECTION_ITEM_INJECTION_KEY:s,ElCollection:i,ElCollectionItem:o}},rovingFocusGroupProps=buildProps({style:{type:definePropType([String,Array,Object])},currentTabId:{type:definePropType(String)},defaultCurrentTabId:String,loop:Boolean,dir:{type:String,values:["ltr","rtl"],default:"ltr"},orientation:{type:definePropType(String)},onBlur:Function,onFocus:Function,onMousedown:Function}),{ElCollection:ElCollection$1,ElCollectionItem:ElCollectionItem$1,COLLECTION_INJECTION_KEY:COLLECTION_INJECTION_KEY$1,COLLECTION_ITEM_INJECTION_KEY:COLLECTION_ITEM_INJECTION_KEY$1}=createCollectionWithScope("RovingFocusGroup"),ROVING_FOCUS_GROUP_INJECTION_KEY=Symbol("elRovingFocusGroup"),ROVING_FOCUS_GROUP_ITEM_INJECTION_KEY=Symbol("elRovingFocusGroupItem"),MAP_KEY_TO_FOCUS_INTENT={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"},getDirectionAwareKey=(t,n)=>{if(n!=="rtl")return t;switch(t){case EVENT_CODE.right:return EVENT_CODE.left;case EVENT_CODE.left:return EVENT_CODE.right;default:return t}},getFocusIntent=(t,n,e)=>{const r=getDirectionAwareKey(t.key,e);if(!(n==="vertical"&&[EVENT_CODE.left,EVENT_CODE.right].includes(r))&&!(n==="horizontal"&&[EVENT_CODE.up,EVENT_CODE.down].includes(r)))return MAP_KEY_TO_FOCUS_INTENT[r]},reorderArray=(t,n)=>t.map((e,r)=>t[(r+n)%t.length]),focusFirst=t=>{const{activeElement:n}=document;for(const e of t)if(e===n||(e.focus(),n!==document.activeElement))return},CURRENT_TAB_ID_CHANGE_EVT="currentTabIdChange",ENTRY_FOCUS_EVT="rovingFocusGroup.entryFocus",EVT_OPTS={bubbles:!1,cancelable:!0},_sfc_main$c=defineComponent({name:"ElRovingFocusGroupImpl",inheritAttrs:!1,props:rovingFocusGroupProps,emits:[CURRENT_TAB_ID_CHANGE_EVT,"entryFocus"],setup(t,{emit:n}){var e;const r=ref((e=t.currentTabId||t.defaultCurrentTabId)!=null?e:null),s=ref(!1),i=ref(!1),o=ref(null),{getItems:a}=inject(COLLECTION_INJECTION_KEY$1,void 0),d=computed(()=>[{outline:"none"},t.style]),c=k=>{n(CURRENT_TAB_ID_CHANGE_EVT,k)},u=()=>{s.value=!0},m=composeEventHandlers(k=>{var g;(g=t.onMousedown)==null||g.call(t,k)},()=>{i.value=!0}),y=composeEventHandlers(k=>{var g;(g=t.onFocus)==null||g.call(t,k)},k=>{const g=!unref(i),{target:v,currentTarget:ue}=k;if(v===ue&&g&&!unref(s)){const L=new Event(ENTRY_FOCUS_EVT,EVT_OPTS);if(ue==null||ue.dispatchEvent(L),!L.defaultPrevented){const re=a().filter(ie=>ie.focusable),le=re.find(ie=>ie.active),oe=re.find(ie=>ie.id===unref(r)),Ie=[le,oe,...re].filter(Boolean).map(ie=>ie.ref);focusFirst(Ie)}}i.value=!1}),S=composeEventHandlers(k=>{var g;(g=t.onBlur)==null||g.call(t,k)},()=>{s.value=!1}),O=(...k)=>{n("entryFocus",...k)};provide(ROVING_FOCUS_GROUP_INJECTION_KEY,{currentTabbedId:readonly(r),loop:toRef(t,"loop"),tabIndex:computed(()=>unref(s)?-1:0),rovingFocusGroupRef:o,rovingFocusGroupRootStyle:d,orientation:toRef(t,"orientation"),dir:toRef(t,"dir"),onItemFocus:c,onItemShiftTab:u,onBlur:S,onFocus:y,onMousedown:m}),watch(()=>t.currentTabId,k=>{r.value=k??null}),useEventListener(o,ENTRY_FOCUS_EVT,O)}});function _sfc_render$7(t,n,e,r,s,i){return renderSlot(t.$slots,"default")}var ElRovingFocusGroupImpl=_export_sfc(_sfc_main$c,[["render",_sfc_render$7],["__file","roving-focus-group-impl.vue"]]);const _sfc_main$b=defineComponent({name:"ElRovingFocusGroup",components:{ElFocusGroupCollection:ElCollection$1,ElRovingFocusGroupImpl}});function _sfc_render$6(t,n,e,r,s,i){const o=resolveComponent("el-roving-focus-group-impl"),a=resolveComponent("el-focus-group-collection");return openBlock(),createBlock(a,null,{default:withCtx(()=>[createVNode(o,normalizeProps(guardReactiveProps(t.$attrs)),{default:withCtx(()=>[renderSlot(t.$slots,"default")]),_:3},16)]),_:3})}var ElRovingFocusGroup=_export_sfc(_sfc_main$b,[["render",_sfc_render$6],["__file","roving-focus-group.vue"]]);const _sfc_main$a=defineComponent({components:{ElRovingFocusCollectionItem:ElCollectionItem$1},props:{focusable:{type:Boolean,default:!0},active:{type:Boolean,default:!1}},emits:["mousedown","focus","keydown"],setup(t,{emit:n}){const{currentTabbedId:e,loop:r,onItemFocus:s,onItemShiftTab:i}=inject(ROVING_FOCUS_GROUP_INJECTION_KEY,void 0),{getItems:o}=inject(COLLECTION_INJECTION_KEY$1,void 0),a=useId(),d=ref(null),c=composeEventHandlers(S=>{n("mousedown",S)},S=>{t.focusable?s(unref(a)):S.preventDefault()}),u=composeEventHandlers(S=>{n("focus",S)},()=>{s(unref(a))}),m=composeEventHandlers(S=>{n("keydown",S)},S=>{const{key:O,shiftKey:k,target:g,currentTarget:v}=S;if(O===EVENT_CODE.tab&&k){i();return}if(g!==v)return;const ue=getFocusIntent(S);if(ue){S.preventDefault();let re=o().filter(le=>le.focusable).map(le=>le.ref);switch(ue){case"last":{re.reverse();break}case"prev":case"next":{ue==="prev"&&re.reverse();const le=re.indexOf(v);re=r.value?reorderArray(re,le+1):re.slice(le+1);break}}nextTick(()=>{focusFirst(re)})}}),y=computed(()=>e.value===unref(a));return provide(ROVING_FOCUS_GROUP_ITEM_INJECTION_KEY,{rovingFocusGroupItemRef:d,tabIndex:computed(()=>unref(y)?0:-1),handleMousedown:c,handleFocus:u,handleKeydown:m}),{id:a,handleKeydown:m,handleFocus:u,handleMousedown:c}}});function _sfc_render$5(t,n,e,r,s,i){const o=resolveComponent("el-roving-focus-collection-item");return openBlock(),createBlock(o,{id:t.id,focusable:t.focusable,active:t.active},{default:withCtx(()=>[renderSlot(t.$slots,"default")]),_:3},8,["id","focusable","active"])}var ElRovingFocusItem=_export_sfc(_sfc_main$a,[["render",_sfc_render$5],["__file","roving-focus-item.vue"]]);const dropdownProps=buildProps({trigger:useTooltipTriggerProps.trigger,effect:{...useTooltipContentProps.effect,default:"light"},type:{type:definePropType(String)},placement:{type:definePropType(String),default:"bottom"},popperOptions:{type:definePropType(Object),default:()=>({})},id:String,size:{type:String,default:""},splitButton:Boolean,hideOnClick:{type:Boolean,default:!0},loop:{type:Boolean,default:!0},showTimeout:{type:Number,default:150},hideTimeout:{type:Number,default:150},tabindex:{type:definePropType([Number,String]),default:0},maxHeight:{type:definePropType([Number,String]),default:""},popperClass:{type:String,default:""},disabled:{type:Boolean,default:!1},role:{type:String,default:"menu"},buttonProps:{type:definePropType(Object)},teleported:useTooltipContentProps.teleported}),dropdownItemProps=buildProps({command:{type:[Object,String,Number],default:()=>({})},disabled:Boolean,divided:Boolean,textValue:String,icon:{type:iconPropType}}),dropdownMenuProps=buildProps({onKeydown:{type:definePropType(Function)}}),FIRST_KEYS=[EVENT_CODE.down,EVENT_CODE.pageDown,EVENT_CODE.home],LAST_KEYS=[EVENT_CODE.up,EVENT_CODE.pageUp,EVENT_CODE.end],FIRST_LAST_KEYS=[...FIRST_KEYS,...LAST_KEYS],{ElCollection,ElCollectionItem,COLLECTION_INJECTION_KEY,COLLECTION_ITEM_INJECTION_KEY}=createCollectionWithScope("Dropdown"),DROPDOWN_INJECTION_KEY=Symbol("elDropdown"),{ButtonGroup:ElButtonGroup}=ElButton,_sfc_main$9=defineComponent({name:"ElDropdown",components:{ElButton,ElButtonGroup,ElScrollbar,ElDropdownCollection:ElCollection,ElTooltip,ElRovingFocusGroup,ElOnlyChild:OnlyChild,ElIcon,ArrowDown:arrow_down_default},props:dropdownProps,emits:["visible-change","click","command"],setup(t,{emit:n}){const e=getCurrentInstance(),r=useNamespace("dropdown"),{t:s}=useLocale(),i=ref(),o=ref(),a=ref(null),d=ref(null),c=ref(null),u=ref(null),m=ref(!1),y=[EVENT_CODE.enter,EVENT_CODE.space,EVENT_CODE.down],S=computed(()=>({maxHeight:addUnit(t.maxHeight)})),O=computed(()=>[r.m(le.value)]),k=computed(()=>castArray(t.trigger)),g=useId().value,v=computed(()=>t.id||g);watch([i,k],([_e,er],[Pt])=>{var ar,pr,lr;(ar=Pt==null?void 0:Pt.$el)!=null&&ar.removeEventListener&&Pt.$el.removeEventListener("pointerenter",he),(pr=_e==null?void 0:_e.$el)!=null&&pr.removeEventListener&&_e.$el.removeEventListener("pointerenter",he),(lr=_e==null?void 0:_e.$el)!=null&&lr.addEventListener&&er.includes("hover")&&_e.$el.addEventListener("pointerenter",he)},{immediate:!0}),onBeforeUnmount(()=>{var _e,er;(er=(_e=i.value)==null?void 0:_e.$el)!=null&&er.removeEventListener&&i.value.$el.removeEventListener("pointerenter",he)});function ue(){L()}function L(){var _e;(_e=a.value)==null||_e.onClose()}function re(){var _e;(_e=a.value)==null||_e.onOpen()}const le=useFormSize();function oe(..._e){n("command",..._e)}function he(){var _e,er;(er=(_e=i.value)==null?void 0:_e.$el)==null||er.focus()}function Ie(){}function ie(){const _e=unref(d);k.value.includes("hover")&&(_e==null||_e.focus()),u.value=null}function Ne(_e){u.value=_e}function Ve(_e){m.value||(_e.preventDefault(),_e.stopImmediatePropagation())}function Ce(){n("visible-change",!0)}function Ue(_e){(_e==null?void 0:_e.type)==="keydown"&&d.value.focus()}function qe(){n("visible-change",!1)}return provide(DROPDOWN_INJECTION_KEY,{contentRef:d,role:computed(()=>t.role),triggerId:v,isUsingKeyboard:m,onItemEnter:Ie,onItemLeave:ie}),provide("elDropdown",{instance:e,dropdownSize:le,handleClick:ue,commandHandler:oe,trigger:toRef(t,"trigger"),hideOnClick:toRef(t,"hideOnClick")}),{t:s,ns:r,scrollbar:c,wrapStyle:S,dropdownTriggerKls:O,dropdownSize:le,triggerId:v,triggerKeys:y,currentTabId:u,handleCurrentTabIdChange:Ne,handlerMainButtonClick:_e=>{n("click",_e)},handleEntryFocus:Ve,handleClose:L,handleOpen:re,handleBeforeShowTooltip:Ce,handleShowTooltip:Ue,handleBeforeHideTooltip:qe,onFocusAfterTrapped:_e=>{var er,Pt;_e.preventDefault(),(Pt=(er=d.value)==null?void 0:er.focus)==null||Pt.call(er,{preventScroll:!0})},popperRef:a,contentRef:d,triggeringElementRef:i,referenceElementRef:o}}});function _sfc_render$4(t,n,e,r,s,i){var o;const a=resolveComponent("el-dropdown-collection"),d=resolveComponent("el-roving-focus-group"),c=resolveComponent("el-scrollbar"),u=resolveComponent("el-only-child"),m=resolveComponent("el-tooltip"),y=resolveComponent("el-button"),S=resolveComponent("arrow-down"),O=resolveComponent("el-icon"),k=resolveComponent("el-button-group");return openBlock(),createElementBlock("div",{class:normalizeClass([t.ns.b(),t.ns.is("disabled",t.disabled)])},[createVNode(m,{ref:"popperRef",role:t.role,effect:t.effect,"fallback-placements":["bottom","top"],"popper-options":t.popperOptions,"gpu-acceleration":!1,"hide-after":t.trigger==="hover"?t.hideTimeout:0,"manual-mode":!0,placement:t.placement,"popper-class":[t.ns.e("popper"),t.popperClass],"reference-element":(o=t.referenceElementRef)==null?void 0:o.$el,trigger:t.trigger,"trigger-keys":t.triggerKeys,"trigger-target-el":t.contentRef,"show-after":t.trigger==="hover"?t.showTimeout:0,"stop-popper-mouse-event":!1,"virtual-ref":t.triggeringElementRef,"virtual-triggering":t.splitButton,disabled:t.disabled,transition:`${t.ns.namespace.value}-zoom-in-top`,teleported:t.teleported,pure:"",persistent:"",onBeforeShow:t.handleBeforeShowTooltip,onShow:t.handleShowTooltip,onBeforeHide:t.handleBeforeHideTooltip},createSlots({content:withCtx(()=>[createVNode(c,{ref:"scrollbar","wrap-style":t.wrapStyle,tag:"div","view-class":t.ns.e("list")},{default:withCtx(()=>[createVNode(d,{loop:t.loop,"current-tab-id":t.currentTabId,orientation:"horizontal",onCurrentTabIdChange:t.handleCurrentTabIdChange,onEntryFocus:t.handleEntryFocus},{default:withCtx(()=>[createVNode(a,null,{default:withCtx(()=>[renderSlot(t.$slots,"dropdown")]),_:3})]),_:3},8,["loop","current-tab-id","onCurrentTabIdChange","onEntryFocus"])]),_:3},8,["wrap-style","view-class"])]),_:2},[t.splitButton?void 0:{name:"default",fn:withCtx(()=>[createVNode(u,{id:t.triggerId,ref:"triggeringElementRef",role:"button",tabindex:t.tabindex},{default:withCtx(()=>[renderSlot(t.$slots,"default")]),_:3},8,["id","tabindex"])])}]),1032,["role","effect","popper-options","hide-after","placement","popper-class","reference-element","trigger","trigger-keys","trigger-target-el","show-after","virtual-ref","virtual-triggering","disabled","transition","teleported","onBeforeShow","onShow","onBeforeHide"]),t.splitButton?(openBlock(),createBlock(k,{key:0},{default:withCtx(()=>[createVNode(y,mergeProps({ref:"referenceElementRef"},t.buttonProps,{size:t.dropdownSize,type:t.type,disabled:t.disabled,tabindex:t.tabindex,onClick:t.handlerMainButtonClick}),{default:withCtx(()=>[renderSlot(t.$slots,"default")]),_:3},16,["size","type","disabled","tabindex","onClick"]),createVNode(y,mergeProps({id:t.triggerId,ref:"triggeringElementRef"},t.buttonProps,{role:"button",size:t.dropdownSize,type:t.type,class:t.ns.e("caret-button"),disabled:t.disabled,tabindex:t.tabindex,"aria-label":t.t("el.dropdown.toggleDropdown")}),{default:withCtx(()=>[createVNode(O,{class:normalizeClass(t.ns.e("icon"))},{default:withCtx(()=>[createVNode(S)]),_:1},8,["class"])]),_:1},16,["id","size","type","class","disabled","tabindex","aria-label"])]),_:3})):createCommentVNode("v-if",!0)],2)}var Dropdown=_export_sfc(_sfc_main$9,[["render",_sfc_render$4],["__file","dropdown.vue"]]);const _sfc_main$8=defineComponent({name:"DropdownItemImpl",components:{ElIcon},props:dropdownItemProps,emits:["pointermove","pointerleave","click","clickimpl"],setup(t,{emit:n}){const e=useNamespace("dropdown"),{role:r}=inject(DROPDOWN_INJECTION_KEY,void 0),{collectionItemRef:s}=inject(COLLECTION_ITEM_INJECTION_KEY,void 0),{collectionItemRef:i}=inject(COLLECTION_ITEM_INJECTION_KEY$1,void 0),{rovingFocusGroupItemRef:o,tabIndex:a,handleFocus:d,handleKeydown:c,handleMousedown:u}=inject(ROVING_FOCUS_GROUP_ITEM_INJECTION_KEY,void 0),m=composeRefs(s,i,o),y=computed(()=>r.value==="menu"?"menuitem":r.value==="navigation"?"link":"button"),S=composeEventHandlers(O=>{const{code:k}=O;if(k===EVENT_CODE.enter||k===EVENT_CODE.space)return O.preventDefault(),O.stopImmediatePropagation(),n("clickimpl",O),!0},c);return{ns:e,itemRef:m,dataset:{[COLLECTION_ITEM_SIGN]:""},role:y,tabIndex:a,handleFocus:d,handleKeydown:S,handleMousedown:u}}}),_hoisted_1$6=["aria-disabled","tabindex","role"];function _sfc_render$3(t,n,e,r,s,i){const o=resolveComponent("el-icon");return openBlock(),createElementBlock(Fragment,null,[t.divided?(openBlock(),createElementBlock("li",mergeProps({key:0,role:"separator",class:t.ns.bem("menu","item","divided")},t.$attrs),null,16)):createCommentVNode("v-if",!0),createBaseVNode("li",mergeProps({ref:t.itemRef},{...t.dataset,...t.$attrs},{"aria-disabled":t.disabled,class:[t.ns.be("menu","item"),t.ns.is("disabled",t.disabled)],tabindex:t.tabIndex,role:t.role,onClick:n[0]||(n[0]=a=>t.$emit("clickimpl",a)),onFocus:n[1]||(n[1]=(...a)=>t.handleFocus&&t.handleFocus(...a)),onKeydown:n[2]||(n[2]=withModifiers((...a)=>t.handleKeydown&&t.handleKeydown(...a),["self"])),onMousedown:n[3]||(n[3]=(...a)=>t.handleMousedown&&t.handleMousedown(...a)),onPointermove:n[4]||(n[4]=a=>t.$emit("pointermove",a)),onPointerleave:n[5]||(n[5]=a=>t.$emit("pointerleave",a))}),[t.icon?(openBlock(),createBlock(o,{key:0},{default:withCtx(()=>[(openBlock(),createBlock(resolveDynamicComponent(t.icon)))]),_:1})):createCommentVNode("v-if",!0),renderSlot(t.$slots,"default")],16,_hoisted_1$6)],64)}var ElDropdownItemImpl=_export_sfc(_sfc_main$8,[["render",_sfc_render$3],["__file","dropdown-item-impl.vue"]]);const useDropdown=()=>{const t=inject("elDropdown",{}),n=computed(()=>t==null?void 0:t.dropdownSize);return{elDropdown:t,_elDropdownSize:n}},_sfc_main$7=defineComponent({name:"ElDropdownItem",components:{ElDropdownCollectionItem:ElCollectionItem,ElRovingFocusItem,ElDropdownItemImpl},inheritAttrs:!1,props:dropdownItemProps,emits:["pointermove","pointerleave","click"],setup(t,{emit:n,attrs:e}){const{elDropdown:r}=useDropdown(),s=getCurrentInstance(),i=ref(null),o=computed(()=>{var S,O;return(O=(S=unref(i))==null?void 0:S.textContent)!=null?O:""}),{onItemEnter:a,onItemLeave:d}=inject(DROPDOWN_INJECTION_KEY,void 0),c=composeEventHandlers(S=>(n("pointermove",S),S.defaultPrevented),whenMouse(S=>{if(t.disabled){d(S);return}const O=S.currentTarget;O===document.activeElement||O.contains(document.activeElement)||(a(S),S.defaultPrevented||O==null||O.focus())})),u=composeEventHandlers(S=>(n("pointerleave",S),S.defaultPrevented),whenMouse(S=>{d(S)})),m=composeEventHandlers(S=>{if(!t.disabled)return n("click",S),S.type!=="keydown"&&S.defaultPrevented},S=>{var O,k,g;if(t.disabled){S.stopImmediatePropagation();return}(O=r==null?void 0:r.hideOnClick)!=null&&O.value&&((k=r.handleClick)==null||k.call(r)),(g=r.commandHandler)==null||g.call(r,t.command,s,S)}),y=computed(()=>({...t,...e}));return{handleClick:m,handlePointerMove:c,handlePointerLeave:u,textContent:o,propsAndAttrs:y}}});function _sfc_render$2(t,n,e,r,s,i){var o;const a=resolveComponent("el-dropdown-item-impl"),d=resolveComponent("el-roving-focus-item"),c=resolveComponent("el-dropdown-collection-item");return openBlock(),createBlock(c,{disabled:t.disabled,"text-value":(o=t.textValue)!=null?o:t.textContent},{default:withCtx(()=>[createVNode(d,{focusable:!t.disabled},{default:withCtx(()=>[createVNode(a,mergeProps(t.propsAndAttrs,{onPointerleave:t.handlePointerLeave,onPointermove:t.handlePointerMove,onClickimpl:t.handleClick}),{default:withCtx(()=>[renderSlot(t.$slots,"default")]),_:3},16,["onPointerleave","onPointermove","onClickimpl"])]),_:3},8,["focusable"])]),_:3},8,["disabled","text-value"])}var DropdownItem=_export_sfc(_sfc_main$7,[["render",_sfc_render$2],["__file","dropdown-item.vue"]]);const _sfc_main$6=defineComponent({name:"ElDropdownMenu",props:dropdownMenuProps,setup(t){const n=useNamespace("dropdown"),{_elDropdownSize:e}=useDropdown(),r=e.value,{focusTrapRef:s,onKeydown:i}=inject(FOCUS_TRAP_INJECTION_KEY,void 0),{contentRef:o,role:a,triggerId:d}=inject(DROPDOWN_INJECTION_KEY,void 0),{collectionRef:c,getItems:u}=inject(COLLECTION_INJECTION_KEY,void 0),{rovingFocusGroupRef:m,rovingFocusGroupRootStyle:y,tabIndex:S,onBlur:O,onFocus:k,onMousedown:g}=inject(ROVING_FOCUS_GROUP_INJECTION_KEY,void 0),{collectionRef:v}=inject(COLLECTION_INJECTION_KEY$1,void 0),ue=computed(()=>[n.b("menu"),n.bm("menu",r==null?void 0:r.value)]),L=composeRefs(o,c,s,m,v),re=composeEventHandlers(oe=>{var he;(he=t.onKeydown)==null||he.call(t,oe)},oe=>{const{currentTarget:he,code:Ie,target:ie}=oe;if(he.contains(ie),EVENT_CODE.tab===Ie&&oe.stopImmediatePropagation(),oe.preventDefault(),ie!==unref(o)||!FIRST_LAST_KEYS.includes(Ie))return;const Ve=u().filter(Ce=>!Ce.disabled).map(Ce=>Ce.ref);LAST_KEYS.includes(Ie)&&Ve.reverse(),focusFirst(Ve)});return{size:r,rovingFocusGroupRootStyle:y,tabIndex:S,dropdownKls:ue,role:a,triggerId:d,dropdownListWrapperRef:L,handleKeydown:oe=>{re(oe),i(oe)},onBlur:O,onFocus:k,onMousedown:g}}}),_hoisted_1$5=["role","aria-labelledby"];function _sfc_render$1(t,n,e,r,s,i){return openBlock(),createElementBlock("ul",{ref:t.dropdownListWrapperRef,class:normalizeClass(t.dropdownKls),style:normalizeStyle(t.rovingFocusGroupRootStyle),tabindex:-1,role:t.role,"aria-labelledby":t.triggerId,onBlur:n[0]||(n[0]=(...o)=>t.onBlur&&t.onBlur(...o)),onFocus:n[1]||(n[1]=(...o)=>t.onFocus&&t.onFocus(...o)),onKeydown:n[2]||(n[2]=withModifiers((...o)=>t.handleKeydown&&t.handleKeydown(...o),["self"])),onMousedown:n[3]||(n[3]=withModifiers((...o)=>t.onMousedown&&t.onMousedown(...o),["self"]))},[renderSlot(t.$slots,"default")],46,_hoisted_1$5)}var DropdownMenu=_export_sfc(_sfc_main$6,[["render",_sfc_render$1],["__file","dropdown-menu.vue"]]);const ElDropdown=withInstall(Dropdown,{DropdownItem,DropdownMenu}),ElDropdownItem=withNoopInstall(DropdownItem),ElDropdownMenu=withNoopInstall(DropdownMenu),imageViewerProps=buildProps({urlList:{type:definePropType(Array),default:()=>mutable([])},zIndex:{type:Number},initialIndex:{type:Number,default:0},infinite:{type:Boolean,default:!0},hideOnClickModal:Boolean,teleported:Boolean,closeOnPressEscape:{type:Boolean,default:!0},zoomRate:{type:Number,default:1.2},minScale:{type:Number,default:.2},maxScale:{type:Number,default:7},crossorigin:{type:definePropType(String)}}),imageViewerEmits={close:()=>!0,switch:t=>isNumber$1(t),rotate:t=>isNumber$1(t)},_hoisted_1$4=["src","crossorigin"],__default__$2=defineComponent({name:"ElImageViewer"}),_sfc_main$5=defineComponent({...__default__$2,props:imageViewerProps,emits:imageViewerEmits,setup(t,{expose:n,emit:e}){var r;const s=t,i={CONTAIN:{name:"contain",icon:markRaw(full_screen_default)},ORIGINAL:{name:"original",icon:markRaw(scale_to_original_default)}},{t:o}=useLocale(),a=useNamespace("image-viewer"),{nextZIndex:d}=useZIndex(),c=ref(),u=ref([]),m=effectScope(),y=ref(!0),S=ref(s.initialIndex),O=shallowRef(i.CONTAIN),k=ref({scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}),g=ref((r=s.zIndex)!=null?r:d()),v=computed(()=>{const{urlList:ar}=s;return ar.length<=1}),ue=computed(()=>S.value===0),L=computed(()=>S.value===s.urlList.length-1),re=computed(()=>s.urlList[S.value]),le=computed(()=>[a.e("btn"),a.e("prev"),a.is("disabled",!s.infinite&&ue.value)]),oe=computed(()=>[a.e("btn"),a.e("next"),a.is("disabled",!s.infinite&&L.value)]),he=computed(()=>{const{scale:ar,deg:pr,offsetX:lr,offsetY:or,enableTransition:xe}=k.value;let nr=lr/ar,ir=or/ar;switch(pr%360){case 90:case-270:[nr,ir]=[ir,-nr];break;case 180:case-180:[nr,ir]=[-nr,-ir];break;case 270:case-90:[nr,ir]=[-ir,nr];break}const dr={transform:`scale(${ar}) rotate(${pr}deg) translate(${nr}px, ${ir}px)`,transition:xe?"transform .3s":""};return O.value.name===i.CONTAIN.name&&(dr.maxWidth=dr.maxHeight="100%"),dr});function Ie(){Ne(),e("close")}function ie(){const ar=throttle(lr=>{switch(lr.code){case EVENT_CODE.esc:s.closeOnPressEscape&&Ie();break;case EVENT_CODE.space:Oe();break;case EVENT_CODE.left:_e();break;case EVENT_CODE.up:Pt("zoomIn");break;case EVENT_CODE.right:er();break;case EVENT_CODE.down:Pt("zoomOut");break}}),pr=throttle(lr=>{const or=lr.deltaY||lr.deltaX;Pt(or<0?"zoomIn":"zoomOut",{zoomRate:s.zoomRate,enableTransition:!1})});m.run(()=>{useEventListener(document,"keydown",ar),useEventListener(document,"wheel",pr)})}function Ne(){m.stop()}function Ve(){y.value=!1}function Ce(ar){y.value=!1,ar.target.alt=o("el.image.error")}function Ue(ar){if(y.value||ar.button!==0||!c.value)return;k.value.enableTransition=!1;const{offsetX:pr,offsetY:lr}=k.value,or=ar.pageX,xe=ar.pageY,nr=throttle(dr=>{k.value={...k.value,offsetX:pr+dr.pageX-or,offsetY:lr+dr.pageY-xe}}),ir=useEventListener(document,"mousemove",nr);useEventListener(document,"mouseup",()=>{ir()}),ar.preventDefault()}function qe(){k.value={scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}}function Oe(){if(y.value)return;const ar=keysOf(i),pr=Object.values(i),lr=O.value.name,xe=(pr.findIndex(nr=>nr.name===lr)+1)%ar.length;O.value=i[ar[xe]],qe()}function $e(ar){const pr=s.urlList.length;S.value=(ar+pr)%pr}function _e(){ue.value&&!s.infinite||$e(S.value-1)}function er(){L.value&&!s.infinite||$e(S.value+1)}function Pt(ar,pr={}){if(y.value)return;const{minScale:lr,maxScale:or}=s,{zoomRate:xe,rotateDeg:nr,enableTransition:ir}={zoomRate:s.zoomRate,rotateDeg:90,enableTransition:!0,...pr};switch(ar){case"zoomOut":k.value.scale>lr&&(k.value.scale=Number.parseFloat((k.value.scale/xe).toFixed(3)));break;case"zoomIn":k.value.scale<or&&(k.value.scale=Number.parseFloat((k.value.scale*xe).toFixed(3)));break;case"clockwise":k.value.deg+=nr,e("rotate",k.value.deg);break;case"anticlockwise":k.value.deg-=nr,e("rotate",k.value.deg);break}k.value.enableTransition=ir}return watch(re,()=>{nextTick(()=>{const ar=u.value[0];ar!=null&&ar.complete||(y.value=!0)})}),watch(S,ar=>{qe(),e("switch",ar)}),onMounted(()=>{var ar,pr;ie(),(pr=(ar=c.value)==null?void 0:ar.focus)==null||pr.call(ar)}),n({setActiveItem:$e}),(ar,pr)=>(openBlock(),createBlock(Teleport,{to:"body",disabled:!ar.teleported},[createVNode(Transition,{name:"viewer-fade",appear:""},{default:withCtx(()=>[createBaseVNode("div",{ref_key:"wrapper",ref:c,tabindex:-1,class:normalizeClass(unref(a).e("wrapper")),style:normalizeStyle({zIndex:g.value})},[createBaseVNode("div",{class:normalizeClass(unref(a).e("mask")),onClick:pr[0]||(pr[0]=withModifiers(lr=>ar.hideOnClickModal&&Ie(),["self"]))},null,2),createCommentVNode(" CLOSE "),createBaseVNode("span",{class:normalizeClass([unref(a).e("btn"),unref(a).e("close")]),onClick:Ie},[createVNode(unref(ElIcon),null,{default:withCtx(()=>[createVNode(unref(close_default))]),_:1})],2),createCommentVNode(" ARROW "),unref(v)?createCommentVNode("v-if",!0):(openBlock(),createElementBlock(Fragment,{key:0},[createBaseVNode("span",{class:normalizeClass(unref(le)),onClick:_e},[createVNode(unref(ElIcon),null,{default:withCtx(()=>[createVNode(unref(arrow_left_default))]),_:1})],2),createBaseVNode("span",{class:normalizeClass(unref(oe)),onClick:er},[createVNode(unref(ElIcon),null,{default:withCtx(()=>[createVNode(unref(arrow_right_default))]),_:1})],2)],64)),createCommentVNode(" ACTIONS "),createBaseVNode("div",{class:normalizeClass([unref(a).e("btn"),unref(a).e("actions")])},[createBaseVNode("div",{class:normalizeClass(unref(a).e("actions__inner"))},[createVNode(unref(ElIcon),{onClick:pr[1]||(pr[1]=lr=>Pt("zoomOut"))},{default:withCtx(()=>[createVNode(unref(zoom_out_default))]),_:1}),createVNode(unref(ElIcon),{onClick:pr[2]||(pr[2]=lr=>Pt("zoomIn"))},{default:withCtx(()=>[createVNode(unref(zoom_in_default))]),_:1}),createBaseVNode("i",{class:normalizeClass(unref(a).e("actions__divider"))},null,2),createVNode(unref(ElIcon),{onClick:Oe},{default:withCtx(()=>[(openBlock(),createBlock(resolveDynamicComponent(unref(O).icon)))]),_:1}),createBaseVNode("i",{class:normalizeClass(unref(a).e("actions__divider"))},null,2),createVNode(unref(ElIcon),{onClick:pr[3]||(pr[3]=lr=>Pt("anticlockwise"))},{default:withCtx(()=>[createVNode(unref(refresh_left_default))]),_:1}),createVNode(unref(ElIcon),{onClick:pr[4]||(pr[4]=lr=>Pt("clockwise"))},{default:withCtx(()=>[createVNode(unref(refresh_right_default))]),_:1})],2)],2),createCommentVNode(" CANVAS "),createBaseVNode("div",{class:normalizeClass(unref(a).e("canvas"))},[(openBlock(!0),createElementBlock(Fragment,null,renderList(ar.urlList,(lr,or)=>withDirectives((openBlock(),createElementBlock("img",{ref_for:!0,ref:xe=>u.value[or]=xe,key:lr,src:lr,style:normalizeStyle(unref(he)),class:normalizeClass(unref(a).e("img")),crossorigin:ar.crossorigin,onLoad:Ve,onError:Ce,onMousedown:Ue},null,46,_hoisted_1$4)),[[vShow,or===S.value]])),128))],2),renderSlot(ar.$slots,"default")],6)]),_:3})],8,["disabled"]))}});var ImageViewer=_export_sfc(_sfc_main$5,[["__file","image-viewer.vue"]]);const ElImageViewer=withInstall(ImageViewer),imageProps=buildProps({hideOnClickModal:Boolean,src:{type:String,default:""},fit:{type:String,values:["","contain","cover","fill","none","scale-down"],default:""},loading:{type:String,values:["eager","lazy"]},lazy:Boolean,scrollContainer:{type:definePropType([String,Object])},previewSrcList:{type:definePropType(Array),default:()=>mutable([])},previewTeleported:Boolean,zIndex:{type:Number},initialIndex:{type:Number,default:0},infinite:{type:Boolean,default:!0},closeOnPressEscape:{type:Boolean,default:!0},zoomRate:{type:Number,default:1.2},minScale:{type:Number,default:.2},maxScale:{type:Number,default:7},crossorigin:{type:definePropType(String)}}),imageEmits={load:t=>t instanceof Event,error:t=>t instanceof Event,switch:t=>isNumber$1(t),close:()=>!0,show:()=>!0},_hoisted_1$3=["src","loading","crossorigin"],_hoisted_2$3={key:0},__default__$1=defineComponent({name:"ElImage",inheritAttrs:!1}),_sfc_main$4=defineComponent({...__default__$1,props:imageProps,emits:imageEmits,setup(t,{emit:n}){const e=t;let r="";const{t:s}=useLocale(),i=useNamespace("image"),o=useAttrs$1(),a=useAttrs(),d=ref(),c=ref(!1),u=ref(!0),m=ref(!1),y=ref(),S=ref(),O=isClient&&"loading"in HTMLImageElement.prototype;let k,g;const v=computed(()=>[i.e("inner"),re.value&&i.e("preview"),u.value&&i.is("loading")]),ue=computed(()=>o.style),L=computed(()=>{const{fit:er}=e;return isClient&&er?{objectFit:er}:{}}),re=computed(()=>{const{previewSrcList:er}=e;return Array.isArray(er)&&er.length>0}),le=computed(()=>{const{previewSrcList:er,initialIndex:Pt}=e;let ar=Pt;return Pt>er.length-1&&(ar=0),ar}),oe=computed(()=>e.loading==="eager"?!1:!O&&e.loading==="lazy"||e.lazy),he=()=>{isClient&&(u.value=!0,c.value=!1,d.value=e.src)};function Ie(er){u.value=!1,c.value=!1,n("load",er)}function ie(er){u.value=!1,c.value=!0,n("error",er)}function Ne(){isInContainer(y.value,S.value)&&(he(),Ue())}const Ve=useThrottleFn(Ne,200,!0);async function Ce(){var er;if(!isClient)return;await nextTick();const{scrollContainer:Pt}=e;isElement(Pt)?S.value=Pt:isString$2(Pt)&&Pt!==""?S.value=(er=document.querySelector(Pt))!=null?er:void 0:y.value&&(S.value=getScrollContainer(y.value)),S.value&&(k=useEventListener(S,"scroll",Ve),setTimeout(()=>Ne(),100))}function Ue(){!isClient||!S.value||!Ve||(k==null||k(),S.value=void 0)}function qe(er){if(er.ctrlKey){if(er.deltaY<0)return er.preventDefault(),!1;if(er.deltaY>0)return er.preventDefault(),!1}}function Oe(){re.value&&(g=useEventListener("wheel",qe,{passive:!1}),r=document.body.style.overflow,document.body.style.overflow="hidden",m.value=!0,n("show"))}function $e(){g==null||g(),document.body.style.overflow=r,m.value=!1,n("close")}function _e(er){n("switch",er)}return watch(()=>e.src,()=>{oe.value?(u.value=!0,c.value=!1,Ue(),Ce()):he()}),onMounted(()=>{oe.value?Ce():he()}),(er,Pt)=>(openBlock(),createElementBlock("div",{ref_key:"container",ref:y,class:normalizeClass([unref(i).b(),er.$attrs.class]),style:normalizeStyle(unref(ue))},[c.value?renderSlot(er.$slots,"error",{key:0},()=>[createBaseVNode("div",{class:normalizeClass(unref(i).e("error"))},toDisplayString(unref(s)("el.image.error")),3)]):(openBlock(),createElementBlock(Fragment,{key:1},[d.value!==void 0?(openBlock(),createElementBlock("img",mergeProps({key:0},unref(a),{src:d.value,loading:er.loading,style:unref(L),class:unref(v),crossorigin:er.crossorigin,onClick:Oe,onLoad:Ie,onError:ie}),null,16,_hoisted_1$3)):createCommentVNode("v-if",!0),u.value?(openBlock(),createElementBlock("div",{key:1,class:normalizeClass(unref(i).e("wrapper"))},[renderSlot(er.$slots,"placeholder",{},()=>[createBaseVNode("div",{class:normalizeClass(unref(i).e("placeholder"))},null,2)])],2)):createCommentVNode("v-if",!0)],64)),unref(re)?(openBlock(),createElementBlock(Fragment,{key:2},[m.value?(openBlock(),createBlock(unref(ElImageViewer),{key:0,"z-index":er.zIndex,"initial-index":unref(le),infinite:er.infinite,"zoom-rate":er.zoomRate,"min-scale":er.minScale,"max-scale":er.maxScale,"url-list":er.previewSrcList,"hide-on-click-modal":er.hideOnClickModal,teleported:er.previewTeleported,"close-on-press-escape":er.closeOnPressEscape,onClose:$e,onSwitch:_e},{default:withCtx(()=>[er.$slots.viewer?(openBlock(),createElementBlock("div",_hoisted_2$3,[renderSlot(er.$slots,"viewer")])):createCommentVNode("v-if",!0)]),_:3},8,["z-index","initial-index","infinite","zoom-rate","min-scale","max-scale","url-list","hide-on-click-modal","teleported","close-on-press-escape"])):createCommentVNode("v-if",!0)],64)):createCommentVNode("v-if",!0)],6))}});var Image$1=_export_sfc(_sfc_main$4,[["__file","image.vue"]]);const ElImage=withInstall(Image$1),messageTypes=["success","info","warning","error"],messageDefaults=mutable({customClass:"",center:!1,dangerouslyUseHTMLString:!1,duration:3e3,icon:void 0,id:"",message:"",onClose:void 0,showClose:!1,type:"info",offset:16,zIndex:0,grouping:!1,repeatNum:1,appendTo:isClient?document.body:void 0}),messageProps=buildProps({customClass:{type:String,default:messageDefaults.customClass},center:{type:Boolean,default:messageDefaults.center},dangerouslyUseHTMLString:{type:Boolean,default:messageDefaults.dangerouslyUseHTMLString},duration:{type:Number,default:messageDefaults.duration},icon:{type:iconPropType,default:messageDefaults.icon},id:{type:String,default:messageDefaults.id},message:{type:definePropType([String,Object,Function]),default:messageDefaults.message},onClose:{type:definePropType(Function),required:!1},showClose:{type:Boolean,default:messageDefaults.showClose},type:{type:String,values:messageTypes,default:messageDefaults.type},offset:{type:Number,default:messageDefaults.offset},zIndex:{type:Number,default:messageDefaults.zIndex},grouping:{type:Boolean,default:messageDefaults.grouping},repeatNum:{type:Number,default:messageDefaults.repeatNum}}),messageEmits={destroy:()=>!0},instances=shallowReactive([]),getInstance=t=>{const n=instances.findIndex(s=>s.id===t),e=instances[n];let r;return n>0&&(r=instances[n-1]),{current:e,prev:r}},getLastOffset=t=>{const{prev:n}=getInstance(t);return n?n.vm.exposed.bottom.value:0},getOffsetOrSpace=(t,n)=>instances.findIndex(r=>r.id===t)>0?20:n,_hoisted_1$2=["id"],_hoisted_2$2=["innerHTML"],__default__=defineComponent({name:"ElMessage"}),_sfc_main$3=defineComponent({...__default__,props:messageProps,emits:messageEmits,setup(t,{expose:n}){const e=t,{Close:r}=TypeComponents,{ns:s,zIndex:i}=useGlobalComponentSettings("message"),{currentZIndex:o,nextZIndex:a}=i,d=ref(),c=ref(!1),u=ref(0);let m;const y=computed(()=>e.type?e.type==="error"?"danger":e.type:"info"),S=computed(()=>{const he=e.type;return{[s.bm("icon",he)]:he&&TypeComponentsMap[he]}}),O=computed(()=>e.icon||TypeComponentsMap[e.type]||""),k=computed(()=>getLastOffset(e.id)),g=computed(()=>getOffsetOrSpace(e.id,e.offset)+k.value),v=computed(()=>u.value+g.value),ue=computed(()=>({top:`${g.value}px`,zIndex:o.value}));function L(){e.duration!==0&&({stop:m}=useTimeoutFn(()=>{le()},e.duration))}function re(){m==null||m()}function le(){c.value=!1}function oe({code:he}){he===EVENT_CODE.esc&&le()}return onMounted(()=>{L(),a(),c.value=!0}),watch(()=>e.repeatNum,()=>{re(),L()}),useEventListener(document,"keydown",oe),useResizeObserver(d,()=>{u.value=d.value.getBoundingClientRect().height}),n({visible:c,bottom:v,close:le}),(he,Ie)=>(openBlock(),createBlock(Transition,{name:unref(s).b("fade"),onBeforeLeave:he.onClose,onAfterLeave:Ie[0]||(Ie[0]=ie=>he.$emit("destroy")),persisted:""},{default:withCtx(()=>[withDirectives(createBaseVNode("div",{id:he.id,ref_key:"messageRef",ref:d,class:normalizeClass([unref(s).b(),{[unref(s).m(he.type)]:he.type},unref(s).is("center",he.center),unref(s).is("closable",he.showClose),he.customClass]),style:normalizeStyle(unref(ue)),role:"alert",onMouseenter:re,onMouseleave:L},[he.repeatNum>1?(openBlock(),createBlock(unref(ElBadge),{key:0,value:he.repeatNum,type:unref(y),class:normalizeClass(unref(s).e("badge"))},null,8,["value","type","class"])):createCommentVNode("v-if",!0),unref(O)?(openBlock(),createBlock(unref(ElIcon),{key:1,class:normalizeClass([unref(s).e("icon"),unref(S)])},{default:withCtx(()=>[(openBlock(),createBlock(resolveDynamicComponent(unref(O))))]),_:1},8,["class"])):createCommentVNode("v-if",!0),renderSlot(he.$slots,"default",{},()=>[he.dangerouslyUseHTMLString?(openBlock(),createElementBlock(Fragment,{key:1},[createCommentVNode(" Caution here, message could've been compromised, never use user's input as message "),createBaseVNode("p",{class:normalizeClass(unref(s).e("content")),innerHTML:he.message},null,10,_hoisted_2$2)],2112)):(openBlock(),createElementBlock("p",{key:0,class:normalizeClass(unref(s).e("content"))},toDisplayString(he.message),3))]),he.showClose?(openBlock(),createBlock(unref(ElIcon),{key:2,class:normalizeClass(unref(s).e("closeBtn")),onClick:withModifiers(le,["stop"])},{default:withCtx(()=>[createVNode(unref(r))]),_:1},8,["class","onClick"])):createCommentVNode("v-if",!0)],46,_hoisted_1$2),[[vShow,c.value]])]),_:3},8,["name","onBeforeLeave"]))}});var MessageConstructor=_export_sfc(_sfc_main$3,[["__file","message.vue"]]);let seed=1;const normalizeOptions=t=>{const n=!t||isString$2(t)||isVNode(t)||isFunction$2(t)?{message:t}:t,e={...messageDefaults,...n};if(!e.appendTo)e.appendTo=document.body;else if(isString$2(e.appendTo)){let r=document.querySelector(e.appendTo);isElement(r)||(r=document.body),e.appendTo=r}return e},closeMessage=t=>{const n=instances.indexOf(t);if(n===-1)return;instances.splice(n,1);const{handler:e}=t;e.close()},createMessage=({appendTo:t,...n},e)=>{const r=`message_${seed++}`,s=n.onClose,i=document.createElement("div"),o={...n,id:r,onClose:()=>{s==null||s(),closeMessage(u)},onDestroy:()=>{render(null,i)}},a=createVNode(MessageConstructor,o,isFunction$2(o.message)||isVNode(o.message)?{default:isFunction$2(o.message)?o.message:()=>o.message}:null);a.appContext=e||message._context,render(a,i),t.appendChild(i.firstElementChild);const d=a.component,u={id:r,vnode:a,vm:d,handler:{close:()=>{d.exposed.visible.value=!1}},props:a.component.props};return u},message=(t={},n)=>{if(!isClient)return{close:()=>{}};if(isNumber$1(messageConfig.max)&&instances.length>=messageConfig.max)return{close:()=>{}};const e=normalizeOptions(t);if(e.grouping&&instances.length){const s=instances.find(({vnode:i})=>{var o;return((o=i.props)==null?void 0:o.message)===e.message});if(s)return s.props.repeatNum+=1,s.props.type=e.type,s.handler}const r=createMessage(e,n);return instances.push(r),r.handler};messageTypes.forEach(t=>{message[t]=(n={},e)=>{const r=normalizeOptions(n);return message({...r,type:t},e)}});function closeAll(t){for(const n of instances)(!t||t===n.props.type)&&n.handler.close()}message.closeAll=closeAll;message._context=null;const ElMessage=withInstallFunction(message,"$message"),_sfc_main$2=defineComponent({name:"ElMessageBox",directives:{TrapFocus},components:{ElButton,ElFocusTrap,ElInput,ElOverlay,ElIcon,...TypeComponents},inheritAttrs:!1,props:{buttonSize:{type:String,validator:isValidComponentSize},modal:{type:Boolean,default:!0},lockScroll:{type:Boolean,default:!0},showClose:{type:Boolean,default:!0},closeOnClickModal:{type:Boolean,default:!0},closeOnPressEscape:{type:Boolean,default:!0},closeOnHashChange:{type:Boolean,default:!0},center:Boolean,draggable:Boolean,overflow:Boolean,roundButton:{default:!1,type:Boolean},container:{type:String,default:"body"},boxType:{type:String,default:""}},emits:["vanish","action"],setup(t,{emit:n}){const{locale:e,zIndex:r,ns:s,size:i}=useGlobalComponentSettings("message-box",computed(()=>t.buttonSize)),{t:o}=e,{nextZIndex:a}=r,d=ref(!1),c=reactive({autofocus:!0,beforeClose:null,callback:null,cancelButtonText:"",cancelButtonClass:"",confirmButtonText:"",confirmButtonClass:"",customClass:"",customStyle:{},dangerouslyUseHTMLString:!1,distinguishCancelAndClose:!1,icon:"",inputPattern:null,inputPlaceholder:"",inputType:"text",inputValue:null,inputValidator:null,inputErrorMessage:"",message:null,modalFade:!0,modalClass:"",showCancelButton:!1,showConfirmButton:!0,type:"",title:void 0,showInput:!1,action:"",confirmButtonLoading:!1,cancelButtonLoading:!1,confirmButtonDisabled:!1,editorErrorMessage:"",validateError:!1,zIndex:a()}),u=computed(()=>{const $e=c.type;return{[s.bm("icon",$e)]:$e&&TypeComponentsMap[$e]}}),m=useId(),y=useId(),S=computed(()=>c.icon||TypeComponentsMap[c.type]||""),O=computed(()=>!!c.message),k=ref(),g=ref(),v=ref(),ue=ref(),L=ref(),re=computed(()=>c.confirmButtonClass);watch(()=>c.inputValue,async $e=>{await nextTick(),t.boxType==="prompt"&&$e!==null&&Ce()},{immediate:!0}),watch(()=>d.value,$e=>{var _e,er;$e&&(t.boxType!=="prompt"&&(c.autofocus?v.value=(er=(_e=L.value)==null?void 0:_e.$el)!=null?er:k.value:v.value=k.value),c.zIndex=a()),t.boxType==="prompt"&&($e?nextTick().then(()=>{var Pt;ue.value&&ue.value.$el&&(c.autofocus?v.value=(Pt=Ue())!=null?Pt:k.value:v.value=k.value)}):(c.editorErrorMessage="",c.validateError=!1))});const le=computed(()=>t.draggable),oe=computed(()=>t.overflow);useDraggable(k,g,le,oe),onMounted(async()=>{await nextTick(),t.closeOnHashChange&&window.addEventListener("hashchange",he)}),onBeforeUnmount(()=>{t.closeOnHashChange&&window.removeEventListener("hashchange",he)});function he(){d.value&&(d.value=!1,nextTick(()=>{c.action&&n("action",c.action)}))}const Ie=()=>{t.closeOnClickModal&&Ve(c.distinguishCancelAndClose?"close":"cancel")},ie=useSameTarget(Ie),Ne=$e=>{if(c.inputType!=="textarea")return $e.preventDefault(),Ve("confirm")},Ve=$e=>{var _e;t.boxType==="prompt"&&$e==="confirm"&&!Ce()||(c.action=$e,c.beforeClose?(_e=c.beforeClose)==null||_e.call(c,$e,c,he):he())},Ce=()=>{if(t.boxType==="prompt"){const $e=c.inputPattern;if($e&&!$e.test(c.inputValue||""))return c.editorErrorMessage=c.inputErrorMessage||o("el.messagebox.error"),c.validateError=!0,!1;const _e=c.inputValidator;if(typeof _e=="function"){const er=_e(c.inputValue);if(er===!1)return c.editorErrorMessage=c.inputErrorMessage||o("el.messagebox.error"),c.validateError=!0,!1;if(typeof er=="string")return c.editorErrorMessage=er,c.validateError=!0,!1}}return c.editorErrorMessage="",c.validateError=!1,!0},Ue=()=>{const $e=ue.value.$refs;return $e.input||$e.textarea},qe=()=>{Ve("close")},Oe=()=>{t.closeOnPressEscape&&qe()};return t.lockScroll&&useLockscreen(d),{...toRefs(c),ns:s,overlayEvent:ie,visible:d,hasMessage:O,typeClass:u,contentId:m,inputId:y,btnSize:i,iconComponent:S,confirmButtonClasses:re,rootRef:k,focusStartRef:v,headerRef:g,inputRef:ue,confirmRef:L,doClose:he,handleClose:qe,onCloseRequested:Oe,handleWrapperClick:Ie,handleInputEnter:Ne,handleAction:Ve,t:o}}}),_hoisted_1$1=["aria-label","aria-describedby"],_hoisted_2$1=["aria-label"],_hoisted_3$1=["id"];function _sfc_render(t,n,e,r,s,i){const o=resolveComponent("el-icon"),a=resolveComponent("close"),d=resolveComponent("el-input"),c=resolveComponent("el-button"),u=resolveComponent("el-focus-trap"),m=resolveComponent("el-overlay");return openBlock(),createBlock(Transition,{name:"fade-in-linear",onAfterLeave:n[11]||(n[11]=y=>t.$emit("vanish")),persisted:""},{default:withCtx(()=>[withDirectives(createVNode(m,{"z-index":t.zIndex,"overlay-class":[t.ns.is("message-box"),t.modalClass],mask:t.modal},{default:withCtx(()=>[createBaseVNode("div",{role:"dialog","aria-label":t.title,"aria-modal":"true","aria-describedby":t.showInput?void 0:t.contentId,class:normalizeClass(`${t.ns.namespace.value}-overlay-message-box`),onClick:n[8]||(n[8]=(...y)=>t.overlayEvent.onClick&&t.overlayEvent.onClick(...y)),onMousedown:n[9]||(n[9]=(...y)=>t.overlayEvent.onMousedown&&t.overlayEvent.onMousedown(...y)),onMouseup:n[10]||(n[10]=(...y)=>t.overlayEvent.onMouseup&&t.overlayEvent.onMouseup(...y))},[createVNode(u,{loop:"",trapped:t.visible,"focus-trap-el":t.rootRef,"focus-start-el":t.focusStartRef,onReleaseRequested:t.onCloseRequested},{default:withCtx(()=>[createBaseVNode("div",{ref:"rootRef",class:normalizeClass([t.ns.b(),t.customClass,t.ns.is("draggable",t.draggable),{[t.ns.m("center")]:t.center}]),style:normalizeStyle(t.customStyle),tabindex:"-1",onClick:n[7]||(n[7]=withModifiers(()=>{},["stop"]))},[t.title!==null&&t.title!==void 0?(openBlock(),createElementBlock("div",{key:0,ref:"headerRef",class:normalizeClass([t.ns.e("header"),{"show-close":t.showClose}])},[createBaseVNode("div",{class:normalizeClass(t.ns.e("title"))},[t.iconComponent&&t.center?(openBlock(),createBlock(o,{key:0,class:normalizeClass([t.ns.e("status"),t.typeClass])},{default:withCtx(()=>[(openBlock(),createBlock(resolveDynamicComponent(t.iconComponent)))]),_:1},8,["class"])):createCommentVNode("v-if",!0),createBaseVNode("span",null,toDisplayString(t.title),1)],2),t.showClose?(openBlock(),createElementBlock("button",{key:0,type:"button",class:normalizeClass(t.ns.e("headerbtn")),"aria-label":t.t("el.messagebox.close"),onClick:n[0]||(n[0]=y=>t.handleAction(t.distinguishCancelAndClose?"close":"cancel")),onKeydown:n[1]||(n[1]=withKeys(withModifiers(y=>t.handleAction(t.distinguishCancelAndClose?"close":"cancel"),["prevent"]),["enter"]))},[createVNode(o,{class:normalizeClass(t.ns.e("close"))},{default:withCtx(()=>[createVNode(a)]),_:1},8,["class"])],42,_hoisted_2$1)):createCommentVNode("v-if",!0)],2)):createCommentVNode("v-if",!0),createBaseVNode("div",{id:t.contentId,class:normalizeClass(t.ns.e("content"))},[createBaseVNode("div",{class:normalizeClass(t.ns.e("container"))},[t.iconComponent&&!t.center&&t.hasMessage?(openBlock(),createBlock(o,{key:0,class:normalizeClass([t.ns.e("status"),t.typeClass])},{default:withCtx(()=>[(openBlock(),createBlock(resolveDynamicComponent(t.iconComponent)))]),_:1},8,["class"])):createCommentVNode("v-if",!0),t.hasMessage?(openBlock(),createElementBlock("div",{key:1,class:normalizeClass(t.ns.e("message"))},[renderSlot(t.$slots,"default",{},()=>[t.dangerouslyUseHTMLString?(openBlock(),createBlock(resolveDynamicComponent(t.showInput?"label":"p"),{key:1,for:t.showInput?t.inputId:void 0,innerHTML:t.message},null,8,["for","innerHTML"])):(openBlock(),createBlock(resolveDynamicComponent(t.showInput?"label":"p"),{key:0,for:t.showInput?t.inputId:void 0},{default:withCtx(()=>[createTextVNode(toDisplayString(t.dangerouslyUseHTMLString?"":t.message),1)]),_:1},8,["for"]))])],2)):createCommentVNode("v-if",!0)],2),withDirectives(createBaseVNode("div",{class:normalizeClass(t.ns.e("input"))},[createVNode(d,{id:t.inputId,ref:"inputRef",modelValue:t.inputValue,"onUpdate:modelValue":n[2]||(n[2]=y=>t.inputValue=y),type:t.inputType,placeholder:t.inputPlaceholder,"aria-invalid":t.validateError,class:normalizeClass({invalid:t.validateError}),onKeydown:withKeys(t.handleInputEnter,["enter"])},null,8,["id","modelValue","type","placeholder","aria-invalid","class","onKeydown"]),createBaseVNode("div",{class:normalizeClass(t.ns.e("errormsg")),style:normalizeStyle({visibility:t.editorErrorMessage?"visible":"hidden"})},toDisplayString(t.editorErrorMessage),7)],2),[[vShow,t.showInput]])],10,_hoisted_3$1),createBaseVNode("div",{class:normalizeClass(t.ns.e("btns"))},[t.showCancelButton?(openBlock(),createBlock(c,{key:0,loading:t.cancelButtonLoading,class:normalizeClass([t.cancelButtonClass]),round:t.roundButton,size:t.btnSize,onClick:n[3]||(n[3]=y=>t.handleAction("cancel")),onKeydown:n[4]||(n[4]=withKeys(withModifiers(y=>t.handleAction("cancel"),["prevent"]),["enter"]))},{default:withCtx(()=>[createTextVNode(toDisplayString(t.cancelButtonText||t.t("el.messagebox.cancel")),1)]),_:1},8,["loading","class","round","size"])):createCommentVNode("v-if",!0),withDirectives(createVNode(c,{ref:"confirmRef",type:"primary",loading:t.confirmButtonLoading,class:normalizeClass([t.confirmButtonClasses]),round:t.roundButton,disabled:t.confirmButtonDisabled,size:t.btnSize,onClick:n[5]||(n[5]=y=>t.handleAction("confirm")),onKeydown:n[6]||(n[6]=withKeys(withModifiers(y=>t.handleAction("confirm"),["prevent"]),["enter"]))},{default:withCtx(()=>[createTextVNode(toDisplayString(t.confirmButtonText||t.t("el.messagebox.confirm")),1)]),_:1},8,["loading","class","round","disabled","size"]),[[vShow,t.showConfirmButton]])],2)],6)]),_:3},8,["trapped","focus-trap-el","focus-start-el","onReleaseRequested"])],42,_hoisted_1$1)]),_:3},8,["z-index","overlay-class","mask"]),[[vShow,t.visible]])]),_:3})}var MessageBoxConstructor=_export_sfc(_sfc_main$2,[["render",_sfc_render],["__file","index.vue"]]);const messageInstance=new Map,getAppendToElement=t=>{let n=document.body;return t.appendTo&&(isString$2(t.appendTo)&&(n=document.querySelector(t.appendTo)),isElement(t.appendTo)&&(n=t.appendTo),isElement(n)||(n=document.body)),n},initInstance=(t,n,e=null)=>{const r=createVNode(MessageBoxConstructor,t,isFunction$2(t.message)||isVNode(t.message)?{default:isFunction$2(t.message)?t.message:()=>t.message}:null);return r.appContext=e,render(r,n),getAppendToElement(t).appendChild(n.firstElementChild),r.component},genContainer=()=>document.createElement("div"),showMessage=(t,n)=>{const e=genContainer();t.onVanish=()=>{render(null,e),messageInstance.delete(s)},t.onAction=i=>{const o=messageInstance.get(s);let a;t.showInput?a={value:s.inputValue,action:i}:a=i,t.callback?t.callback(a,r.proxy):i==="cancel"||i==="close"?t.distinguishCancelAndClose&&i!=="cancel"?o.reject("close"):o.reject("cancel"):o.resolve(a)};const r=initInstance(t,e,n),s=r.proxy;for(const i in t)hasOwn(t,i)&&!hasOwn(s.$props,i)&&(s[i]=t[i]);return s.visible=!0,s};function MessageBox(t,n=null){if(!isClient)return Promise.reject();let e;return isString$2(t)||isVNode(t)?t={message:t}:e=t.callback,new Promise((r,s)=>{const i=showMessage(t,n??MessageBox._context);messageInstance.set(i,{options:t,callback:e,resolve:r,reject:s})})}const MESSAGE_BOX_VARIANTS=["alert","confirm","prompt"],MESSAGE_BOX_DEFAULT_OPTS={alert:{closeOnPressEscape:!1,closeOnClickModal:!1},confirm:{showCancelButton:!0},prompt:{showCancelButton:!0,showInput:!0}};MESSAGE_BOX_VARIANTS.forEach(t=>{MessageBox[t]=messageBoxFactory(t)});function messageBoxFactory(t){return(n,e,r,s)=>{let i="";return isObject$2(e)?(r=e,i=""):isUndefined$1(e)?i="":i=e,MessageBox(Object.assign({title:i,message:n,type:"",...MESSAGE_BOX_DEFAULT_OPTS[t]},r,{boxType:t}),s)}}MessageBox.close=()=>{messageInstance.forEach((t,n)=>{n.doClose()}),messageInstance.clear()};MessageBox._context=null;const _MessageBox=MessageBox;_MessageBox.install=t=>{_MessageBox._context=t._context,t.config.globalProperties.$msgbox=_MessageBox,t.config.globalProperties.$messageBox=_MessageBox,t.config.globalProperties.$alert=_MessageBox.alert,t.config.globalProperties.$confirm=_MessageBox.confirm,t.config.globalProperties.$prompt=_MessageBox.prompt};const ElMessageBox=_MessageBox,base="",elContainer="",elAside="",elFooter="",elHeader="",elMain="",elRow="",elCol="",elImage="",elImageViewer="",elButton="",elButtonGroup="",elPopper="",elScrollbar="",elDropdown="",elDropdownMenu="",elDropdownItem="",elIcon="";/*!
  * vue-router v4.3.0
  * (c) 2024 Eduardo San Martin Morote
  * @license MIT
  */var NavigationType;(function(t){t.pop="pop",t.push="push"})(NavigationType||(NavigationType={}));var NavigationDirection;(function(t){t.back="back",t.forward="forward",t.unknown=""})(NavigationDirection||(NavigationDirection={}));var NavigationFailureType;(function(t){t[t.aborted=4]="aborted",t[t.cancelled=8]="cancelled",t[t.duplicated=16]="duplicated"})(NavigationFailureType||(NavigationFailureType={}));const routerKey=Symbol("");function useRouter(){return inject(routerKey)}function bind(t,n){return function(){return t.apply(n,arguments)}}const{toString}=Object.prototype,{getPrototypeOf}=Object,kindOf=(t=>n=>{const e=toString.call(n);return t[e]||(t[e]=e.slice(8,-1).toLowerCase())})(Object.create(null)),kindOfTest=t=>(t=t.toLowerCase(),n=>kindOf(n)===t),typeOfTest=t=>n=>typeof n===t,{isArray}=Array,isUndefined=typeOfTest("undefined");function isBuffer(t){return t!==null&&!isUndefined(t)&&t.constructor!==null&&!isUndefined(t.constructor)&&isFunction(t.constructor.isBuffer)&&t.constructor.isBuffer(t)}const isArrayBuffer=kindOfTest("ArrayBuffer");function isArrayBufferView(t){let n;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?n=ArrayBuffer.isView(t):n=t&&t.buffer&&isArrayBuffer(t.buffer),n}const isString=typeOfTest("string"),isFunction=typeOfTest("function"),isNumber=typeOfTest("number"),isObject=t=>t!==null&&typeof t=="object",isBoolean=t=>t===!0||t===!1,isPlainObject=t=>{if(kindOf(t)!=="object")return!1;const n=getPrototypeOf(t);return(n===null||n===Object.prototype||Object.getPrototypeOf(n)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)},isDate=kindOfTest("Date"),isFile=kindOfTest("File"),isBlob=kindOfTest("Blob"),isFileList=kindOfTest("FileList"),isStream=t=>isObject(t)&&isFunction(t.pipe),isFormData=t=>{let n;return t&&(typeof FormData=="function"&&t instanceof FormData||isFunction(t.append)&&((n=kindOf(t))==="formdata"||n==="object"&&isFunction(t.toString)&&t.toString()==="[object FormData]"))},isURLSearchParams=kindOfTest("URLSearchParams"),trim=t=>t.trim?t.trim():t.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function forEach(t,n,{allOwnKeys:e=!1}={}){if(t===null||typeof t>"u")return;let r,s;if(typeof t!="object"&&(t=[t]),isArray(t))for(r=0,s=t.length;r<s;r++)n.call(null,t[r],r,t);else{const i=e?Object.getOwnPropertyNames(t):Object.keys(t),o=i.length;let a;for(r=0;r<o;r++)a=i[r],n.call(null,t[a],a,t)}}function findKey(t,n){n=n.toLowerCase();const e=Object.keys(t);let r=e.length,s;for(;r-- >0;)if(s=e[r],n===s.toLowerCase())return s;return null}const _global=(()=>typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global)(),isContextDefined=t=>!isUndefined(t)&&t!==_global;function merge(){const{caseless:t}=isContextDefined(this)&&this||{},n={},e=(r,s)=>{const i=t&&findKey(n,s)||s;isPlainObject(n[i])&&isPlainObject(r)?n[i]=merge(n[i],r):isPlainObject(r)?n[i]=merge({},r):isArray(r)?n[i]=r.slice():n[i]=r};for(let r=0,s=arguments.length;r<s;r++)arguments[r]&&forEach(arguments[r],e);return n}const extend=(t,n,e,{allOwnKeys:r}={})=>(forEach(n,(s,i)=>{e&&isFunction(s)?t[i]=bind(s,e):t[i]=s},{allOwnKeys:r}),t),stripBOM=t=>(t.charCodeAt(0)===65279&&(t=t.slice(1)),t),inherits=(t,n,e,r)=>{t.prototype=Object.create(n.prototype,r),t.prototype.constructor=t,Object.defineProperty(t,"super",{value:n.prototype}),e&&Object.assign(t.prototype,e)},toFlatObject=(t,n,e,r)=>{let s,i,o;const a={};if(n=n||{},t==null)return n;do{for(s=Object.getOwnPropertyNames(t),i=s.length;i-- >0;)o=s[i],(!r||r(o,t,n))&&!a[o]&&(n[o]=t[o],a[o]=!0);t=e!==!1&&getPrototypeOf(t)}while(t&&(!e||e(t,n))&&t!==Object.prototype);return n},endsWith=(t,n,e)=>{t=String(t),(e===void 0||e>t.length)&&(e=t.length),e-=n.length;const r=t.indexOf(n,e);return r!==-1&&r===e},toArray=t=>{if(!t)return null;if(isArray(t))return t;let n=t.length;if(!isNumber(n))return null;const e=new Array(n);for(;n-- >0;)e[n]=t[n];return e},isTypedArray=(t=>n=>t&&n instanceof t)(typeof Uint8Array<"u"&&getPrototypeOf(Uint8Array)),forEachEntry=(t,n)=>{const r=(t&&t[Symbol.iterator]).call(t);let s;for(;(s=r.next())&&!s.done;){const i=s.value;n.call(t,i[0],i[1])}},matchAll=(t,n)=>{let e;const r=[];for(;(e=t.exec(n))!==null;)r.push(e);return r},isHTMLForm=kindOfTest("HTMLFormElement"),toCamelCase=t=>t.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(e,r,s){return r.toUpperCase()+s}),hasOwnProperty=(({hasOwnProperty:t})=>(n,e)=>t.call(n,e))(Object.prototype),isRegExp=kindOfTest("RegExp"),reduceDescriptors=(t,n)=>{const e=Object.getOwnPropertyDescriptors(t),r={};forEach(e,(s,i)=>{let o;(o=n(s,i,t))!==!1&&(r[i]=o||s)}),Object.defineProperties(t,r)},freezeMethods=t=>{reduceDescriptors(t,(n,e)=>{if(isFunction(t)&&["arguments","caller","callee"].indexOf(e)!==-1)return!1;const r=t[e];if(isFunction(r)){if(n.enumerable=!1,"writable"in n){n.writable=!1;return}n.set||(n.set=()=>{throw Error("Can not rewrite read-only method '"+e+"'")})}})},toObjectSet=(t,n)=>{const e={},r=s=>{s.forEach(i=>{e[i]=!0})};return isArray(t)?r(t):r(String(t).split(n)),e},noop=()=>{},toFiniteNumber=(t,n)=>(t=+t,Number.isFinite(t)?t:n),ALPHA="abcdefghijklmnopqrstuvwxyz",DIGIT="0123456789",ALPHABET={DIGIT,ALPHA,ALPHA_DIGIT:ALPHA+ALPHA.toUpperCase()+DIGIT},generateString=(t=16,n=ALPHABET.ALPHA_DIGIT)=>{let e="";const{length:r}=n;for(;t--;)e+=n[Math.random()*r|0];return e};function isSpecCompliantForm(t){return!!(t&&isFunction(t.append)&&t[Symbol.toStringTag]==="FormData"&&t[Symbol.iterator])}const toJSONObject=t=>{const n=new Array(10),e=(r,s)=>{if(isObject(r)){if(n.indexOf(r)>=0)return;if(!("toJSON"in r)){n[s]=r;const i=isArray(r)?[]:{};return forEach(r,(o,a)=>{const d=e(o,s+1);!isUndefined(d)&&(i[a]=d)}),n[s]=void 0,i}}return r};return e(t,0)},isAsyncFn=kindOfTest("AsyncFunction"),isThenable=t=>t&&(isObject(t)||isFunction(t))&&isFunction(t.then)&&isFunction(t.catch),utils$1={isArray,isArrayBuffer,isBuffer,isFormData,isArrayBufferView,isString,isNumber,isBoolean,isObject,isPlainObject,isUndefined,isDate,isFile,isBlob,isRegExp,isFunction,isStream,isURLSearchParams,isTypedArray,isFileList,forEach,merge,extend,trim,stripBOM,inherits,toFlatObject,kindOf,kindOfTest,endsWith,toArray,forEachEntry,matchAll,isHTMLForm,hasOwnProperty,hasOwnProp:hasOwnProperty,reduceDescriptors,freezeMethods,toObjectSet,toCamelCase,noop,toFiniteNumber,findKey,global:_global,isContextDefined,ALPHABET,generateString,isSpecCompliantForm,toJSONObject,isAsyncFn,isThenable};function AxiosError(t,n,e,r,s){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=t,this.name="AxiosError",n&&(this.code=n),e&&(this.config=e),r&&(this.request=r),s&&(this.response=s)}utils$1.inherits(AxiosError,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:utils$1.toJSONObject(this.config),code:this.code,status:this.response&&this.response.status?this.response.status:null}}});const prototype$1=AxiosError.prototype,descriptors={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(t=>{descriptors[t]={value:t}});Object.defineProperties(AxiosError,descriptors);Object.defineProperty(prototype$1,"isAxiosError",{value:!0});AxiosError.from=(t,n,e,r,s,i)=>{const o=Object.create(prototype$1);return utils$1.toFlatObject(t,o,function(d){return d!==Error.prototype},a=>a!=="isAxiosError"),AxiosError.call(o,t.message,n,e,r,s),o.cause=t,o.name=t.name,i&&Object.assign(o,i),o};const httpAdapter=null;function isVisitable(t){return utils$1.isPlainObject(t)||utils$1.isArray(t)}function removeBrackets(t){return utils$1.endsWith(t,"[]")?t.slice(0,-2):t}function renderKey(t,n,e){return t?t.concat(n).map(function(s,i){return s=removeBrackets(s),!e&&i?"["+s+"]":s}).join(e?".":""):n}function isFlatArray(t){return utils$1.isArray(t)&&!t.some(isVisitable)}const predicates=utils$1.toFlatObject(utils$1,{},null,function(n){return/^is[A-Z]/.test(n)});function toFormData(t,n,e){if(!utils$1.isObject(t))throw new TypeError("target must be an object");n=n||new FormData,e=utils$1.toFlatObject(e,{metaTokens:!0,dots:!1,indexes:!1},!1,function(k,g){return!utils$1.isUndefined(g[k])});const r=e.metaTokens,s=e.visitor||u,i=e.dots,o=e.indexes,d=(e.Blob||typeof Blob<"u"&&Blob)&&utils$1.isSpecCompliantForm(n);if(!utils$1.isFunction(s))throw new TypeError("visitor must be a function");function c(O){if(O===null)return"";if(utils$1.isDate(O))return O.toISOString();if(!d&&utils$1.isBlob(O))throw new AxiosError("Blob is not supported. Use a Buffer instead.");return utils$1.isArrayBuffer(O)||utils$1.isTypedArray(O)?d&&typeof Blob=="function"?new Blob([O]):Buffer.from(O):O}function u(O,k,g){let v=O;if(O&&!g&&typeof O=="object"){if(utils$1.endsWith(k,"{}"))k=r?k:k.slice(0,-2),O=JSON.stringify(O);else if(utils$1.isArray(O)&&isFlatArray(O)||(utils$1.isFileList(O)||utils$1.endsWith(k,"[]"))&&(v=utils$1.toArray(O)))return k=removeBrackets(k),v.forEach(function(L,re){!(utils$1.isUndefined(L)||L===null)&&n.append(o===!0?renderKey([k],re,i):o===null?k:k+"[]",c(L))}),!1}return isVisitable(O)?!0:(n.append(renderKey(g,k,i),c(O)),!1)}const m=[],y=Object.assign(predicates,{defaultVisitor:u,convertValue:c,isVisitable});function S(O,k){if(!utils$1.isUndefined(O)){if(m.indexOf(O)!==-1)throw Error("Circular reference detected in "+k.join("."));m.push(O),utils$1.forEach(O,function(v,ue){(!(utils$1.isUndefined(v)||v===null)&&s.call(n,v,utils$1.isString(ue)?ue.trim():ue,k,y))===!0&&S(v,k?k.concat(ue):[ue])}),m.pop()}}if(!utils$1.isObject(t))throw new TypeError("data must be an object");return S(t),n}function encode$1(t){const n={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(t).replace(/[!'()~]|%20|%00/g,function(r){return n[r]})}function AxiosURLSearchParams(t,n){this._pairs=[],t&&toFormData(t,this,n)}const prototype=AxiosURLSearchParams.prototype;prototype.append=function(n,e){this._pairs.push([n,e])};prototype.toString=function(n){const e=n?function(r){return n.call(this,r,encode$1)}:encode$1;return this._pairs.map(function(s){return e(s[0])+"="+e(s[1])},"").join("&")};function encode(t){return encodeURIComponent(t).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function buildURL(t,n,e){if(!n)return t;const r=e&&e.encode||encode,s=e&&e.serialize;let i;if(s?i=s(n,e):i=utils$1.isURLSearchParams(n)?n.toString():new AxiosURLSearchParams(n,e).toString(r),i){const o=t.indexOf("#");o!==-1&&(t=t.slice(0,o)),t+=(t.indexOf("?")===-1?"?":"&")+i}return t}class InterceptorManager{constructor(){this.handlers=[]}use(n,e,r){return this.handlers.push({fulfilled:n,rejected:e,synchronous:r?r.synchronous:!1,runWhen:r?r.runWhen:null}),this.handlers.length-1}eject(n){this.handlers[n]&&(this.handlers[n]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(n){utils$1.forEach(this.handlers,function(r){r!==null&&n(r)})}}const InterceptorManager$1=InterceptorManager,transitionalDefaults={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},URLSearchParams$1=typeof URLSearchParams<"u"?URLSearchParams:AxiosURLSearchParams,FormData$1=typeof FormData<"u"?FormData:null,Blob$1=typeof Blob<"u"?Blob:null,platform$1={isBrowser:!0,classes:{URLSearchParams:URLSearchParams$1,FormData:FormData$1,Blob:Blob$1},protocols:["http","https","file","blob","url","data"]},hasBrowserEnv=typeof window<"u"&&typeof document<"u",hasStandardBrowserEnv=(t=>hasBrowserEnv&&["ReactNative","NativeScript","NS"].indexOf(t)<0)(typeof navigator<"u"&&navigator.product),hasStandardBrowserWebWorkerEnv=(()=>typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function")(),utils=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv,hasStandardBrowserEnv,hasStandardBrowserWebWorkerEnv},Symbol.toStringTag,{value:"Module"})),platform={...utils,...platform$1};function toURLEncodedForm(t,n){return toFormData(t,new platform.classes.URLSearchParams,Object.assign({visitor:function(e,r,s,i){return platform.isNode&&utils$1.isBuffer(e)?(this.append(r,e.toString("base64")),!1):i.defaultVisitor.apply(this,arguments)}},n))}function parsePropPath(t){return utils$1.matchAll(/\w+|\[(\w*)]/g,t).map(n=>n[0]==="[]"?"":n[1]||n[0])}function arrayToObject(t){const n={},e=Object.keys(t);let r;const s=e.length;let i;for(r=0;r<s;r++)i=e[r],n[i]=t[i];return n}function formDataToJSON(t){function n(e,r,s,i){let o=e[i++];if(o==="__proto__")return!0;const a=Number.isFinite(+o),d=i>=e.length;return o=!o&&utils$1.isArray(s)?s.length:o,d?(utils$1.hasOwnProp(s,o)?s[o]=[s[o],r]:s[o]=r,!a):((!s[o]||!utils$1.isObject(s[o]))&&(s[o]=[]),n(e,r,s[o],i)&&utils$1.isArray(s[o])&&(s[o]=arrayToObject(s[o])),!a)}if(utils$1.isFormData(t)&&utils$1.isFunction(t.entries)){const e={};return utils$1.forEachEntry(t,(r,s)=>{n(parsePropPath(r),s,e,0)}),e}return null}function stringifySafely(t,n,e){if(utils$1.isString(t))try{return(n||JSON.parse)(t),utils$1.trim(t)}catch(r){if(r.name!=="SyntaxError")throw r}return(e||JSON.stringify)(t)}const defaults={transitional:transitionalDefaults,adapter:["xhr","http"],transformRequest:[function(n,e){const r=e.getContentType()||"",s=r.indexOf("application/json")>-1,i=utils$1.isObject(n);if(i&&utils$1.isHTMLForm(n)&&(n=new FormData(n)),utils$1.isFormData(n))return s?JSON.stringify(formDataToJSON(n)):n;if(utils$1.isArrayBuffer(n)||utils$1.isBuffer(n)||utils$1.isStream(n)||utils$1.isFile(n)||utils$1.isBlob(n))return n;if(utils$1.isArrayBufferView(n))return n.buffer;if(utils$1.isURLSearchParams(n))return e.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),n.toString();let a;if(i){if(r.indexOf("application/x-www-form-urlencoded")>-1)return toURLEncodedForm(n,this.formSerializer).toString();if((a=utils$1.isFileList(n))||r.indexOf("multipart/form-data")>-1){const d=this.env&&this.env.FormData;return toFormData(a?{"files[]":n}:n,d&&new d,this.formSerializer)}}return i||s?(e.setContentType("application/json",!1),stringifySafely(n)):n}],transformResponse:[function(n){const e=this.transitional||defaults.transitional,r=e&&e.forcedJSONParsing,s=this.responseType==="json";if(n&&utils$1.isString(n)&&(r&&!this.responseType||s)){const o=!(e&&e.silentJSONParsing)&&s;try{return JSON.parse(n)}catch(a){if(o)throw a.name==="SyntaxError"?AxiosError.from(a,AxiosError.ERR_BAD_RESPONSE,this,null,this.response):a}}return n}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:platform.classes.FormData,Blob:platform.classes.Blob},validateStatus:function(n){return n>=200&&n<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};utils$1.forEach(["delete","get","head","post","put","patch"],t=>{defaults.headers[t]={}});const defaults$1=defaults,ignoreDuplicateOf=utils$1.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),parseHeaders=t=>{const n={};let e,r,s;return t&&t.split(`
`).forEach(function(o){s=o.indexOf(":"),e=o.substring(0,s).trim().toLowerCase(),r=o.substring(s+1).trim(),!(!e||n[e]&&ignoreDuplicateOf[e])&&(e==="set-cookie"?n[e]?n[e].push(r):n[e]=[r]:n[e]=n[e]?n[e]+", "+r:r)}),n},$internals=Symbol("internals");function normalizeHeader(t){return t&&String(t).trim().toLowerCase()}function normalizeValue(t){return t===!1||t==null?t:utils$1.isArray(t)?t.map(normalizeValue):String(t)}function parseTokens(t){const n=Object.create(null),e=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let r;for(;r=e.exec(t);)n[r[1]]=r[2];return n}const isValidHeaderName=t=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(t.trim());function matchHeaderValue(t,n,e,r,s){if(utils$1.isFunction(r))return r.call(this,n,e);if(s&&(n=e),!!utils$1.isString(n)){if(utils$1.isString(r))return n.indexOf(r)!==-1;if(utils$1.isRegExp(r))return r.test(n)}}function formatHeader(t){return t.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(n,e,r)=>e.toUpperCase()+r)}function buildAccessors(t,n){const e=utils$1.toCamelCase(" "+n);["get","set","has"].forEach(r=>{Object.defineProperty(t,r+e,{value:function(s,i,o){return this[r].call(this,n,s,i,o)},configurable:!0})})}class AxiosHeaders{constructor(n){n&&this.set(n)}set(n,e,r){const s=this;function i(a,d,c){const u=normalizeHeader(d);if(!u)throw new Error("header name must be a non-empty string");const m=utils$1.findKey(s,u);(!m||s[m]===void 0||c===!0||c===void 0&&s[m]!==!1)&&(s[m||d]=normalizeValue(a))}const o=(a,d)=>utils$1.forEach(a,(c,u)=>i(c,u,d));return utils$1.isPlainObject(n)||n instanceof this.constructor?o(n,e):utils$1.isString(n)&&(n=n.trim())&&!isValidHeaderName(n)?o(parseHeaders(n),e):n!=null&&i(e,n,r),this}get(n,e){if(n=normalizeHeader(n),n){const r=utils$1.findKey(this,n);if(r){const s=this[r];if(!e)return s;if(e===!0)return parseTokens(s);if(utils$1.isFunction(e))return e.call(this,s,r);if(utils$1.isRegExp(e))return e.exec(s);throw new TypeError("parser must be boolean|regexp|function")}}}has(n,e){if(n=normalizeHeader(n),n){const r=utils$1.findKey(this,n);return!!(r&&this[r]!==void 0&&(!e||matchHeaderValue(this,this[r],r,e)))}return!1}delete(n,e){const r=this;let s=!1;function i(o){if(o=normalizeHeader(o),o){const a=utils$1.findKey(r,o);a&&(!e||matchHeaderValue(r,r[a],a,e))&&(delete r[a],s=!0)}}return utils$1.isArray(n)?n.forEach(i):i(n),s}clear(n){const e=Object.keys(this);let r=e.length,s=!1;for(;r--;){const i=e[r];(!n||matchHeaderValue(this,this[i],i,n,!0))&&(delete this[i],s=!0)}return s}normalize(n){const e=this,r={};return utils$1.forEach(this,(s,i)=>{const o=utils$1.findKey(r,i);if(o){e[o]=normalizeValue(s),delete e[i];return}const a=n?formatHeader(i):String(i).trim();a!==i&&delete e[i],e[a]=normalizeValue(s),r[a]=!0}),this}concat(...n){return this.constructor.concat(this,...n)}toJSON(n){const e=Object.create(null);return utils$1.forEach(this,(r,s)=>{r!=null&&r!==!1&&(e[s]=n&&utils$1.isArray(r)?r.join(", "):r)}),e}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([n,e])=>n+": "+e).join(`
`)}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(n){return n instanceof this?n:new this(n)}static concat(n,...e){const r=new this(n);return e.forEach(s=>r.set(s)),r}static accessor(n){const r=(this[$internals]=this[$internals]={accessors:{}}).accessors,s=this.prototype;function i(o){const a=normalizeHeader(o);r[a]||(buildAccessors(s,o),r[a]=!0)}return utils$1.isArray(n)?n.forEach(i):i(n),this}}AxiosHeaders.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);utils$1.reduceDescriptors(AxiosHeaders.prototype,({value:t},n)=>{let e=n[0].toUpperCase()+n.slice(1);return{get:()=>t,set(r){this[e]=r}}});utils$1.freezeMethods(AxiosHeaders);const AxiosHeaders$1=AxiosHeaders;function transformData(t,n){const e=this||defaults$1,r=n||e,s=AxiosHeaders$1.from(r.headers);let i=r.data;return utils$1.forEach(t,function(a){i=a.call(e,i,s.normalize(),n?n.status:void 0)}),s.normalize(),i}function isCancel(t){return!!(t&&t.__CANCEL__)}function CanceledError(t,n,e){AxiosError.call(this,t??"canceled",AxiosError.ERR_CANCELED,n,e),this.name="CanceledError"}utils$1.inherits(CanceledError,AxiosError,{__CANCEL__:!0});function settle(t,n,e){const r=e.config.validateStatus;!e.status||!r||r(e.status)?t(e):n(new AxiosError("Request failed with status code "+e.status,[AxiosError.ERR_BAD_REQUEST,AxiosError.ERR_BAD_RESPONSE][Math.floor(e.status/100)-4],e.config,e.request,e))}const cookies=platform.hasStandardBrowserEnv?{write(t,n,e,r,s,i){const o=[t+"="+encodeURIComponent(n)];utils$1.isNumber(e)&&o.push("expires="+new Date(e).toGMTString()),utils$1.isString(r)&&o.push("path="+r),utils$1.isString(s)&&o.push("domain="+s),i===!0&&o.push("secure"),document.cookie=o.join("; ")},read(t){const n=document.cookie.match(new RegExp("(^|;\\s*)("+t+")=([^;]*)"));return n?decodeURIComponent(n[3]):null},remove(t){this.write(t,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function isAbsoluteURL(t){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(t)}function combineURLs(t,n){return n?t.replace(/\/?\/$/,"")+"/"+n.replace(/^\/+/,""):t}function buildFullPath(t,n){return t&&!isAbsoluteURL(n)?combineURLs(t,n):n}const isURLSameOrigin=platform.hasStandardBrowserEnv?function(){const n=/(msie|trident)/i.test(navigator.userAgent),e=document.createElement("a");let r;function s(i){let o=i;return n&&(e.setAttribute("href",o),o=e.href),e.setAttribute("href",o),{href:e.href,protocol:e.protocol?e.protocol.replace(/:$/,""):"",host:e.host,search:e.search?e.search.replace(/^\?/,""):"",hash:e.hash?e.hash.replace(/^#/,""):"",hostname:e.hostname,port:e.port,pathname:e.pathname.charAt(0)==="/"?e.pathname:"/"+e.pathname}}return r=s(window.location.href),function(o){const a=utils$1.isString(o)?s(o):o;return a.protocol===r.protocol&&a.host===r.host}}():function(){return function(){return!0}}();function parseProtocol(t){const n=/^([-+\w]{1,25})(:?\/\/|:)/.exec(t);return n&&n[1]||""}function speedometer(t,n){t=t||10;const e=new Array(t),r=new Array(t);let s=0,i=0,o;return n=n!==void 0?n:1e3,function(d){const c=Date.now(),u=r[i];o||(o=c),e[s]=d,r[s]=c;let m=i,y=0;for(;m!==s;)y+=e[m++],m=m%t;if(s=(s+1)%t,s===i&&(i=(i+1)%t),c-o<n)return;const S=u&&c-u;return S?Math.round(y*1e3/S):void 0}}function progressEventReducer(t,n){let e=0;const r=speedometer(50,250);return s=>{const i=s.loaded,o=s.lengthComputable?s.total:void 0,a=i-e,d=r(a),c=i<=o;e=i;const u={loaded:i,total:o,progress:o?i/o:void 0,bytes:a,rate:d||void 0,estimated:d&&o&&c?(o-i)/d:void 0,event:s};u[n?"download":"upload"]=!0,t(u)}}const isXHRAdapterSupported=typeof XMLHttpRequest<"u",xhrAdapter=isXHRAdapterSupported&&function(t){return new Promise(function(e,r){let s=t.data;const i=AxiosHeaders$1.from(t.headers).normalize();let{responseType:o,withXSRFToken:a}=t,d;function c(){t.cancelToken&&t.cancelToken.unsubscribe(d),t.signal&&t.signal.removeEventListener("abort",d)}let u;if(utils$1.isFormData(s)){if(platform.hasStandardBrowserEnv||platform.hasStandardBrowserWebWorkerEnv)i.setContentType(!1);else if((u=i.getContentType())!==!1){const[k,...g]=u?u.split(";").map(v=>v.trim()).filter(Boolean):[];i.setContentType([k||"multipart/form-data",...g].join("; "))}}let m=new XMLHttpRequest;if(t.auth){const k=t.auth.username||"",g=t.auth.password?unescape(encodeURIComponent(t.auth.password)):"";i.set("Authorization","Basic "+btoa(k+":"+g))}const y=buildFullPath(t.baseURL,t.url);m.open(t.method.toUpperCase(),buildURL(y,t.params,t.paramsSerializer),!0),m.timeout=t.timeout;function S(){if(!m)return;const k=AxiosHeaders$1.from("getAllResponseHeaders"in m&&m.getAllResponseHeaders()),v={data:!o||o==="text"||o==="json"?m.responseText:m.response,status:m.status,statusText:m.statusText,headers:k,config:t,request:m};settle(function(L){e(L),c()},function(L){r(L),c()},v),m=null}if("onloadend"in m?m.onloadend=S:m.onreadystatechange=function(){!m||m.readyState!==4||m.status===0&&!(m.responseURL&&m.responseURL.indexOf("file:")===0)||setTimeout(S)},m.onabort=function(){m&&(r(new AxiosError("Request aborted",AxiosError.ECONNABORTED,t,m)),m=null)},m.onerror=function(){r(new AxiosError("Network Error",AxiosError.ERR_NETWORK,t,m)),m=null},m.ontimeout=function(){let g=t.timeout?"timeout of "+t.timeout+"ms exceeded":"timeout exceeded";const v=t.transitional||transitionalDefaults;t.timeoutErrorMessage&&(g=t.timeoutErrorMessage),r(new AxiosError(g,v.clarifyTimeoutError?AxiosError.ETIMEDOUT:AxiosError.ECONNABORTED,t,m)),m=null},platform.hasStandardBrowserEnv&&(a&&utils$1.isFunction(a)&&(a=a(t)),a||a!==!1&&isURLSameOrigin(y))){const k=t.xsrfHeaderName&&t.xsrfCookieName&&cookies.read(t.xsrfCookieName);k&&i.set(t.xsrfHeaderName,k)}s===void 0&&i.setContentType(null),"setRequestHeader"in m&&utils$1.forEach(i.toJSON(),function(g,v){m.setRequestHeader(v,g)}),utils$1.isUndefined(t.withCredentials)||(m.withCredentials=!!t.withCredentials),o&&o!=="json"&&(m.responseType=t.responseType),typeof t.onDownloadProgress=="function"&&m.addEventListener("progress",progressEventReducer(t.onDownloadProgress,!0)),typeof t.onUploadProgress=="function"&&m.upload&&m.upload.addEventListener("progress",progressEventReducer(t.onUploadProgress)),(t.cancelToken||t.signal)&&(d=k=>{m&&(r(!k||k.type?new CanceledError(null,t,m):k),m.abort(),m=null)},t.cancelToken&&t.cancelToken.subscribe(d),t.signal&&(t.signal.aborted?d():t.signal.addEventListener("abort",d)));const O=parseProtocol(y);if(O&&platform.protocols.indexOf(O)===-1){r(new AxiosError("Unsupported protocol "+O+":",AxiosError.ERR_BAD_REQUEST,t));return}m.send(s||null)})},knownAdapters={http:httpAdapter,xhr:xhrAdapter};utils$1.forEach(knownAdapters,(t,n)=>{if(t){try{Object.defineProperty(t,"name",{value:n})}catch{}Object.defineProperty(t,"adapterName",{value:n})}});const renderReason=t=>`- ${t}`,isResolvedHandle=t=>utils$1.isFunction(t)||t===null||t===!1,adapters={getAdapter:t=>{t=utils$1.isArray(t)?t:[t];const{length:n}=t;let e,r;const s={};for(let i=0;i<n;i++){e=t[i];let o;if(r=e,!isResolvedHandle(e)&&(r=knownAdapters[(o=String(e)).toLowerCase()],r===void 0))throw new AxiosError(`Unknown adapter '${o}'`);if(r)break;s[o||"#"+i]=r}if(!r){const i=Object.entries(s).map(([a,d])=>`adapter ${a} `+(d===!1?"is not supported by the environment":"is not available in the build"));let o=n?i.length>1?`since :
`+i.map(renderReason).join(`
`):" "+renderReason(i[0]):"as no adapter specified";throw new AxiosError("There is no suitable adapter to dispatch the request "+o,"ERR_NOT_SUPPORT")}return r},adapters:knownAdapters};function throwIfCancellationRequested(t){if(t.cancelToken&&t.cancelToken.throwIfRequested(),t.signal&&t.signal.aborted)throw new CanceledError(null,t)}function dispatchRequest(t){return throwIfCancellationRequested(t),t.headers=AxiosHeaders$1.from(t.headers),t.data=transformData.call(t,t.transformRequest),["post","put","patch"].indexOf(t.method)!==-1&&t.headers.setContentType("application/x-www-form-urlencoded",!1),adapters.getAdapter(t.adapter||defaults$1.adapter)(t).then(function(r){return throwIfCancellationRequested(t),r.data=transformData.call(t,t.transformResponse,r),r.headers=AxiosHeaders$1.from(r.headers),r},function(r){return isCancel(r)||(throwIfCancellationRequested(t),r&&r.response&&(r.response.data=transformData.call(t,t.transformResponse,r.response),r.response.headers=AxiosHeaders$1.from(r.response.headers))),Promise.reject(r)})}const headersToObject=t=>t instanceof AxiosHeaders$1?t.toJSON():t;function mergeConfig(t,n){n=n||{};const e={};function r(c,u,m){return utils$1.isPlainObject(c)&&utils$1.isPlainObject(u)?utils$1.merge.call({caseless:m},c,u):utils$1.isPlainObject(u)?utils$1.merge({},u):utils$1.isArray(u)?u.slice():u}function s(c,u,m){if(utils$1.isUndefined(u)){if(!utils$1.isUndefined(c))return r(void 0,c,m)}else return r(c,u,m)}function i(c,u){if(!utils$1.isUndefined(u))return r(void 0,u)}function o(c,u){if(utils$1.isUndefined(u)){if(!utils$1.isUndefined(c))return r(void 0,c)}else return r(void 0,u)}function a(c,u,m){if(m in n)return r(c,u);if(m in t)return r(void 0,c)}const d={url:i,method:i,data:i,baseURL:o,transformRequest:o,transformResponse:o,paramsSerializer:o,timeout:o,timeoutMessage:o,withCredentials:o,withXSRFToken:o,adapter:o,responseType:o,xsrfCookieName:o,xsrfHeaderName:o,onUploadProgress:o,onDownloadProgress:o,decompress:o,maxContentLength:o,maxBodyLength:o,beforeRedirect:o,transport:o,httpAgent:o,httpsAgent:o,cancelToken:o,socketPath:o,responseEncoding:o,validateStatus:a,headers:(c,u)=>s(headersToObject(c),headersToObject(u),!0)};return utils$1.forEach(Object.keys(Object.assign({},t,n)),function(u){const m=d[u]||s,y=m(t[u],n[u],u);utils$1.isUndefined(y)&&m!==a||(e[u]=y)}),e}const VERSION="1.6.7",validators$1={};["object","boolean","number","function","string","symbol"].forEach((t,n)=>{validators$1[t]=function(r){return typeof r===t||"a"+(n<1?"n ":" ")+t}});const deprecatedWarnings={};validators$1.transitional=function(n,e,r){function s(i,o){return"[Axios v"+VERSION+"] Transitional option '"+i+"'"+o+(r?". "+r:"")}return(i,o,a)=>{if(n===!1)throw new AxiosError(s(o," has been removed"+(e?" in "+e:"")),AxiosError.ERR_DEPRECATED);return e&&!deprecatedWarnings[o]&&(deprecatedWarnings[o]=!0,console.warn(s(o," has been deprecated since v"+e+" and will be removed in the near future"))),n?n(i,o,a):!0}};function assertOptions(t,n,e){if(typeof t!="object")throw new AxiosError("options must be an object",AxiosError.ERR_BAD_OPTION_VALUE);const r=Object.keys(t);let s=r.length;for(;s-- >0;){const i=r[s],o=n[i];if(o){const a=t[i],d=a===void 0||o(a,i,t);if(d!==!0)throw new AxiosError("option "+i+" must be "+d,AxiosError.ERR_BAD_OPTION_VALUE);continue}if(e!==!0)throw new AxiosError("Unknown option "+i,AxiosError.ERR_BAD_OPTION)}}const validator={assertOptions,validators:validators$1},validators=validator.validators;class Axios{constructor(n){this.defaults=n,this.interceptors={request:new InterceptorManager$1,response:new InterceptorManager$1}}async request(n,e){try{return await this._request(n,e)}catch(r){if(r instanceof Error){let s;Error.captureStackTrace?Error.captureStackTrace(s={}):s=new Error;const i=s.stack?s.stack.replace(/^.+\n/,""):"";r.stack?i&&!String(r.stack).endsWith(i.replace(/^.+\n.+\n/,""))&&(r.stack+=`
`+i):r.stack=i}throw r}}_request(n,e){typeof n=="string"?(e=e||{},e.url=n):e=n||{},e=mergeConfig(this.defaults,e);const{transitional:r,paramsSerializer:s,headers:i}=e;r!==void 0&&validator.assertOptions(r,{silentJSONParsing:validators.transitional(validators.boolean),forcedJSONParsing:validators.transitional(validators.boolean),clarifyTimeoutError:validators.transitional(validators.boolean)},!1),s!=null&&(utils$1.isFunction(s)?e.paramsSerializer={serialize:s}:validator.assertOptions(s,{encode:validators.function,serialize:validators.function},!0)),e.method=(e.method||this.defaults.method||"get").toLowerCase();let o=i&&utils$1.merge(i.common,i[e.method]);i&&utils$1.forEach(["delete","get","head","post","put","patch","common"],O=>{delete i[O]}),e.headers=AxiosHeaders$1.concat(o,i);const a=[];let d=!0;this.interceptors.request.forEach(function(k){typeof k.runWhen=="function"&&k.runWhen(e)===!1||(d=d&&k.synchronous,a.unshift(k.fulfilled,k.rejected))});const c=[];this.interceptors.response.forEach(function(k){c.push(k.fulfilled,k.rejected)});let u,m=0,y;if(!d){const O=[dispatchRequest.bind(this),void 0];for(O.unshift.apply(O,a),O.push.apply(O,c),y=O.length,u=Promise.resolve(e);m<y;)u=u.then(O[m++],O[m++]);return u}y=a.length;let S=e;for(m=0;m<y;){const O=a[m++],k=a[m++];try{S=O(S)}catch(g){k.call(this,g);break}}try{u=dispatchRequest.call(this,S)}catch(O){return Promise.reject(O)}for(m=0,y=c.length;m<y;)u=u.then(c[m++],c[m++]);return u}getUri(n){n=mergeConfig(this.defaults,n);const e=buildFullPath(n.baseURL,n.url);return buildURL(e,n.params,n.paramsSerializer)}}utils$1.forEach(["delete","get","head","options"],function(n){Axios.prototype[n]=function(e,r){return this.request(mergeConfig(r||{},{method:n,url:e,data:(r||{}).data}))}});utils$1.forEach(["post","put","patch"],function(n){function e(r){return function(i,o,a){return this.request(mergeConfig(a||{},{method:n,headers:r?{"Content-Type":"multipart/form-data"}:{},url:i,data:o}))}}Axios.prototype[n]=e(),Axios.prototype[n+"Form"]=e(!0)});const Axios$1=Axios;class CancelToken{constructor(n){if(typeof n!="function")throw new TypeError("executor must be a function.");let e;this.promise=new Promise(function(i){e=i});const r=this;this.promise.then(s=>{if(!r._listeners)return;let i=r._listeners.length;for(;i-- >0;)r._listeners[i](s);r._listeners=null}),this.promise.then=s=>{let i;const o=new Promise(a=>{r.subscribe(a),i=a}).then(s);return o.cancel=function(){r.unsubscribe(i)},o},n(function(i,o,a){r.reason||(r.reason=new CanceledError(i,o,a),e(r.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(n){if(this.reason){n(this.reason);return}this._listeners?this._listeners.push(n):this._listeners=[n]}unsubscribe(n){if(!this._listeners)return;const e=this._listeners.indexOf(n);e!==-1&&this._listeners.splice(e,1)}static source(){let n;return{token:new CancelToken(function(s){n=s}),cancel:n}}}const CancelToken$1=CancelToken;function spread(t){return function(e){return t.apply(null,e)}}function isAxiosError(t){return utils$1.isObject(t)&&t.isAxiosError===!0}const HttpStatusCode={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(HttpStatusCode).forEach(([t,n])=>{HttpStatusCode[n]=t});const HttpStatusCode$1=HttpStatusCode;function createInstance(t){const n=new Axios$1(t),e=bind(Axios$1.prototype.request,n);return utils$1.extend(e,Axios$1.prototype,n,{allOwnKeys:!0}),utils$1.extend(e,n,null,{allOwnKeys:!0}),e.create=function(s){return createInstance(mergeConfig(t,s))},e}const axios=createInstance(defaults$1);axios.Axios=Axios$1;axios.CanceledError=CanceledError;axios.CancelToken=CancelToken$1;axios.isCancel=isCancel;axios.VERSION=VERSION;axios.toFormData=toFormData;axios.AxiosError=AxiosError;axios.Cancel=axios.CanceledError;axios.all=function(n){return Promise.all(n)};axios.spread=spread;axios.isAxiosError=isAxiosError;axios.mergeConfig=mergeConfig;axios.AxiosHeaders=AxiosHeaders$1;axios.formToJSON=t=>formDataToJSON(utils$1.isHTMLForm(t)?new FormData(t):t);axios.getAdapter=adapters.getAdapter;axios.HttpStatusCode=HttpStatusCode$1;axios.default=axios;const axios$1=axios;var QCHAT_BROWSER_SDK={exports:{}};(function(t,n){(function(e,r){t.exports=r()})(commonjsGlobal,function(){var e=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof commonjsGlobal<"u"?commonjsGlobal:typeof self<"u"?self:{};function r(b){return b&&b.__esModule&&Object.prototype.hasOwnProperty.call(b,"default")?b.default:b}function s(b){var w={exports:{}};return b(w,w.exports),w.exports}var i,o,a=r(s(function(b){b.exports=function($){if($===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return $},b.exports.__esModule=!0,b.exports.default=b.exports})),d=function(b){return b&&b.Math==Math&&b},c=d(typeof globalThis=="object"&&globalThis)||d(typeof window=="object"&&window)||d(typeof self=="object"&&self)||d(typeof e=="object"&&e)||function(){return this}()||Function("return this")(),u=function(b){try{return!!b()}catch{return!0}},m=!u(function(){var b=(function(){}).bind();return typeof b!="function"||b.hasOwnProperty("prototype")}),y=Function.prototype,S=y.apply,O=y.call,k=typeof Reflect=="object"&&Reflect.apply||(m?O.bind(S):function(){return O.apply(S,arguments)}),g=Function.prototype,v=g.bind,ue=g.call,L=m&&v.bind(ue,ue),re=m?function(b){return b&&L(b)}:function(b){return b&&function(){return ue.apply(b,arguments)}},le=function(b){return typeof b=="function"},oe=!u(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!=7}),he=Function.prototype.call,Ie=m?he.bind(he):function(){return he.apply(he,arguments)},ie={}.propertyIsEnumerable,Ne=Object.getOwnPropertyDescriptor,Ve={f:Ne&&!ie.call({1:2},1)?function(w){var $=Ne(this,w);return!!$&&$.enumerable}:ie},Ce=function(b,w){return{enumerable:!(1&b),configurable:!(2&b),writable:!(4&b),value:w}},Ue=re({}.toString),qe=re("".slice),Oe=function(b){return qe(Ue(b),8,-1)},$e=Object,_e=re("".split),er=u(function(){return!$e("z").propertyIsEnumerable(0)})?function(b){return Oe(b)=="String"?_e(b,""):$e(b)}:$e,Pt=function(b){return b==null},ar=TypeError,pr=function(b){if(Pt(b))throw ar("Can't call method on "+b);return b},lr=function(b){return er(pr(b))},or=typeof document=="object"&&document.all,xe=or===void 0&&or!==void 0?function(b){return typeof b=="object"?b!==null:le(b)||b===or}:function(b){return typeof b=="object"?b!==null:le(b)},nr={},ir=function(b){return le(b)?b:void 0},dr=function(b,w){return arguments.length<2?ir(nr[b])||ir(c[b]):nr[b]&&nr[b][w]||c[b]&&c[b][w]},Lt=re({}.isPrototypeOf),cr=dr("navigator","userAgent")||"",mr=c.process,tr=c.Deno,At=mr&&mr.versions||tr&&tr.version,kt=At&&At.v8;kt&&(o=(i=kt.split("."))[0]>0&&i[0]<4?1:+(i[0]+i[1])),!o&&cr&&(!(i=cr.match(/Edge\/(\d+)/))||i[1]>=74)&&(i=cr.match(/Chrome\/(\d+)/))&&(o=+i[1]);var Dt,gr=o,yr=!!Object.getOwnPropertySymbols&&!u(function(){var b=Symbol();return!String(b)||!(Object(b)instanceof Symbol)||!Symbol.sham&&gr&&gr<41}),vr=yr&&!Symbol.sham&&typeof Symbol.iterator=="symbol",Ir=Object,Mr=vr?function(b){return typeof b=="symbol"}:function(b){var w=dr("Symbol");return le(w)&&Lt(w.prototype,Ir(b))},Ar=String,Fr=function(b){try{return Ar(b)}catch{return"Object"}},Dr=TypeError,Or=function(b){if(le(b))return b;throw Dr(Fr(b)+" is not a function")},Sn=function(b,w){var $=b[w];return Pt($)?void 0:Or($)},Rr=TypeError,Wr=Object.defineProperty,Er="__core-js_shared__",Ur=c[Er]||function(b,w){try{Wr(c,b,{value:w,configurable:!0,writable:!0})}catch{c[b]=w}return w}(Er,{}),Zr=s(function(b){(b.exports=function(w,$){return Ur[w]||(Ur[w]=$!==void 0?$:{})})("versions",[]).push({version:"3.25.0",mode:"pure",copyright:"© 2014-2022 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.25.0/LICENSE",source:"https://github.com/zloirock/core-js"})}),In=Object,An=function(b){return In(pr(b))},Zn=re({}.hasOwnProperty),Nn=Object.hasOwn||function(w,$){return Zn(An(w),$)},Gi=0,Iu=Math.random(),Ki=re(1 .toString),yi=function(b){return"Symbol("+(b===void 0?"":b)+")_"+Ki(++Gi+Iu,36)},Ro=Zr("wks"),Lo=c.Symbol,Ai=Lo&&Lo.for,As=vr?Lo:Lo&&Lo.withoutSetter||yi,Yn=function(b){if(!Nn(Ro,b)||!yr&&typeof Ro[b]!="string"){var w="Symbol."+b;yr&&Nn(Lo,b)?Ro[b]=Lo[b]:Ro[b]=vr&&Ai?Ai(w):As(w)}return Ro[b]},Ks=TypeError,On=Yn("toPrimitive"),Qo=function(b,w){if(!xe(b)||Mr(b))return b;var $,A=Sn(b,On);if(A){if(w===void 0&&(w="default"),$=Ie(A,b,w),!xe($)||Mr($))return $;throw Ks("Can't convert object to primitive value")}return w===void 0&&(w="number"),function(_,Y){var de,V;if(Y==="string"&&le(de=_.toString)&&!xe(V=Ie(de,_))||le(de=_.valueOf)&&!xe(V=Ie(de,_))||Y!=="string"&&le(de=_.toString)&&!xe(V=Ie(de,_)))return V;throw Rr("Can't convert object to primitive value")}(b,w)},ei=function(b){var w=Qo(b,"string");return Mr(w)?w:w+""},vi=c.document,wi=xe(vi)&&xe(vi.createElement),Io=function(b){return wi?vi.createElement(b):{}},eo=!oe&&!u(function(){return Object.defineProperty(Io("div"),"a",{get:function(){return 7}}).a!=7}),Mi=Object.getOwnPropertyDescriptor,Ii={f:oe?Mi:function(w,$){if(w=lr(w),$=ei($),eo)try{return Mi(w,$)}catch{}if(Nn(w,$))return Ce(!Ie(Ve.f,w,$),w[$])}},_u=/#|\.prototype\./,ws=function(b,w){var $=$o[na(b)];return $==al||$!=Os&&(le(w)?u(w):!!w)},na=ws.normalize=function(b){return String(b).replace(_u,".").toLowerCase()},$o=ws.data={},Os=ws.NATIVE="N",al=ws.POLYFILL="P",Ua=ws,Tc=re(re.bind),_o=function(b,w){return Or(b),w===void 0?b:m?Tc(b,w):function(){return b.apply(w,arguments)}},pf=oe&&u(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!=42}),nb=String,ob=TypeError,Dn=function(b){if(xe(b))return b;throw ob(nb(b)+" is not an object")},ib=TypeError,cl=Object.defineProperty,sb=Object.getOwnPropertyDescriptor,ab="enumerable",cb="configurable",ub="writable",ii={f:oe?pf?function(w,$,A){if(Dn(w),$=ei($),Dn(A),typeof w=="function"&&$==="prototype"&&"value"in A&&ub in A&&!A.writable){var _=sb(w,$);_&&_.writable&&(w[$]=A.value,A={configurable:cb in A?A.configurable:_.configurable,enumerable:ab in A?A.enumerable:_.enumerable,writable:!1})}return cl(w,$,A)}:cl:function(w,$,A){if(Dn(w),$=ei($),Dn(A),eo)try{return cl(w,$,A)}catch{}if("get"in A||"set"in A)throw ib("Accessors not supported");return"value"in A&&(w[$]=A.value),w}},Ho=oe?function(b,w,$){return ii.f(b,w,Ce(1,$))}:function(b,w,$){return b[w]=$,b},lb=Ii.f,db=function(b){var w=function($,A,_){if(this instanceof w){switch(arguments.length){case 0:return new b;case 1:return new b($);case 2:return new b($,A)}return new b($,A,_)}return k(b,this,arguments)};return w.prototype=b.prototype,w},qr=function(b,w){var $,A,_,Y,de,V,Fe,Et,sr=b.target,fr=b.global,Sr=b.stat,Tr=b.proto,Pr=fr?c:Sr?c[sr]:(c[sr]||{}).prototype,Lr=fr?nr:nr[sr]||Ho(nr,sr,{})[sr],jr=Lr.prototype;for(_ in w)$=!Ua(fr?_:sr+(Sr?".":"#")+_,b.forced)&&Pr&&Nn(Pr,_),de=Lr[_],$&&(V=b.dontCallGetSet?(Et=lb(Pr,_))&&Et.value:Pr[_]),Y=$&&V?V:w[_],$&&typeof de==typeof Y||(Fe=b.bind&&$?_o(Y,c):b.wrap&&$?db(Y):Tr&&le(Y)?re(Y):Y,(b.sham||Y&&Y.sham||de&&de.sham)&&Ho(Fe,"sham",!0),Ho(Lr,_,Fe),Tr&&(Nn(nr,A=sr+"Prototype")||Ho(nr,A,{}),Ho(nr[A],_,Y),b.real&&jr&&!jr[_]&&Ho(jr,_,Y)))},pb=Math.ceil,fb=Math.floor,mb=Math.trunc||function(w){var $=+w;return($>0?fb:pb)($)},Da=function(b){var w=+b;return w!=w||w===0?0:mb(w)},gb=Math.max,hb=Math.min,oa=function(b,w){var $=Da(b);return $<0?gb($+w,0):hb($,w)},yb=Math.min,Ci=function(b){return(w=b.length)>0?yb(Da(w),9007199254740991):0;var w},ff=function(b){return function(w,$,A){var _,Y=lr(w),de=Ci(Y),V=oa(A,de);if(b&&$!=$){for(;de>V;)if((_=Y[V++])!=_)return!0}else for(;de>V;V++)if((b||V in Y)&&Y[V]===$)return b||V||0;return!b&&-1}},ul={includes:ff(!0),indexOf:ff(!1)},ia={},vb=ul.indexOf,mf=re([].push),gf=function(b,w){var $,A=lr(b),_=0,Y=[];for($ in A)!Nn(ia,$)&&Nn(A,$)&&mf(Y,$);for(;w.length>_;)Nn(A,$=w[_++])&&(~vb(Y,$)||mf(Y,$));return Y},qc=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],ps=Object.keys||function(w){return gf(w,qc)},bb=oe&&!pf?Object.defineProperties:function(w,$){Dn(w);for(var A,_=lr($),Y=ps($),de=Y.length,V=0;de>V;)ii.f(w,A=Y[V++],_[A]);return w},hf={f:bb},ll=dr("document","documentElement"),yf=Zr("keys"),$c=function(b){return yf[b]||(yf[b]=yi(b))},vf=$c("IE_PROTO"),dl=function(){},bf=function(b){return"<script>"+b+"<\/script>"},Tf=function(b){b.write(bf("")),b.close();var w=b.parentWindow.Object;return b=null,w},Hc=function(){try{Dt=new ActiveXObject("htmlfile")}catch{}var b,w;Hc=typeof document<"u"?document.domain&&Dt?Tf(Dt):((w=Io("iframe")).style.display="none",ll.appendChild(w),w.src="javascript:",(b=w.contentWindow.document).open(),b.write(bf("document.F=Object")),b.close(),b.F):Tf(Dt);for(var $=qc.length;$--;)delete Hc.prototype[qc[$]];return Hc()};ia[vf]=!0;var ki=Object.create||function(w,$){var A;return w!==null?(dl.prototype=Dn(w),A=new dl,dl.prototype=null,A[vf]=w):A=Hc(),$===void 0?A:hf.f(A,$)};qr({target:"Object",stat:!0,sham:!oe},{create:ki});var Tb=nr.Object,Qi=function(w,$){return Tb.create(w,$)},Sb=String,Mb=TypeError,qa=Object.setPrototypeOf||("__proto__"in{}?function(){var b,w=!1,$={};try{(b=re(Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set))($,[]),w=$ instanceof Array}catch{}return function(_,Y){return Dn(_),function(de){if(typeof de=="object"||le(de))return de;throw Mb("Can't set "+Sb(de)+" as a prototype")}(Y),w?b(_,Y):_.__proto__=Y,_}}():void 0);qr({target:"Object",stat:!0},{setPrototypeOf:qa});var Rs=nr.Object.setPrototypeOf,fs=re([].slice),Sf=Function,Cb=re([].concat),kb=re([].join),pl={},xb=function(b,w,$){if(!Nn(pl,w)){for(var A=[],_=0;_<w;_++)A[_]="a["+_+"]";pl[w]=Sf("C,a","return new C("+kb(A,",")+")")}return pl[w](b,$)},fl=m?Sf.bind:function(w){var $=Or(this),A=$.prototype,_=fs(arguments,1),Y=function(){var V=Cb(_,fs(arguments));return this instanceof Y?xb($,V.length,V):$.apply(w,V)};return xe(A)&&(Y.prototype=A),Y};qr({target:"Function",proto:!0,forced:Function.bind!==fl},{bind:fl});var Ao=function(b){return nr[b+"Prototype"]},wb=Ao("Function").bind,ml=Function.prototype,Mo=function(b){var w=b.bind;return b===ml||Lt(ml,b)&&w===ml.bind?wb:w},gl=s(function(b){function w($,A){var _;return b.exports=w=Rs?Mo(_=Rs).call(_):function(de,V){return de.__proto__=V,de},b.exports.__esModule=!0,b.exports.default=b.exports,w($,A)}b.exports=w,b.exports.__esModule=!0,b.exports.default=b.exports}),Co=r(s(function(b){b.exports=function($,A){$.prototype=Qi(A.prototype),$.prototype.constructor=$,gl($,A)},b.exports.__esModule=!0,b.exports.default=b.exports})),Ji=Array.isArray||function(w){return Oe(w)=="Array"},Ib=TypeError,hl=function(b){if(b>9007199254740991)throw Ib("Maximum allowed index exceeded");return b},Ns=function(b,w,$){var A=ei(w);A in b?ii.f(b,A,Ce(0,$)):b[A]=$},Mf={};Mf[Yn("toStringTag")]="z";var yl=String(Mf)==="[object z]",_b=Yn("toStringTag"),Eb=Object,Pb=Oe(function(){return arguments}())=="Arguments",Fs=yl?Oe:function(b){var w,$,A;return b===void 0?"Undefined":b===null?"Null":typeof($=function(_,Y){try{return _[Y]}catch{}}(w=Eb(b),_b))=="string"?$:Pb?Oe(w):(A=Oe(w))=="Object"&&le(w.callee)?"Arguments":A},Ab=re(Function.toString);le(Ur.inspectSource)||(Ur.inspectSource=function(b){return Ab(b)});var Cf=Ur.inspectSource,kf=function(){},Ob=[],xf=dr("Reflect","construct"),vl=/^\s*(?:class|function)\b/,Rb=re(vl.exec),Nb=!vl.exec(kf),$a=function(w){if(!le(w))return!1;try{return xf(kf,Ob,w),!0}catch{return!1}},wf=function(w){if(!le(w))return!1;switch(Fs(w)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return Nb||!!Rb(vl,Cf(w))}catch{return!0}};wf.sham=!0;var Vc=!xf||u(function(){var b;return $a($a.call)||!$a(Object)||!$a(function(){b=!0})||b})?wf:$a,Fb=Yn("species"),If=Array,bl=function(b,w){return new(function($){var A;return Ji($)&&(A=$.constructor,(Vc(A)&&(A===If||Ji(A.prototype))||xe(A)&&(A=A[Fb])===null)&&(A=void 0)),A===void 0?If:A}(b))(w===0?0:w)},jb=Yn("species"),Ha=function(b){return gr>=51||!u(function(){var w=[];return(w.constructor={})[jb]=function(){return{foo:1}},w[b](Boolean).foo!==1})},_f=Yn("isConcatSpreadable"),Bb=gr>=51||!u(function(){var b=[];return b[_f]=!1,b.concat()[0]!==b}),Lb=Ha("concat"),Ub=function(b){if(!xe(b))return!1;var w=b[_f];return w!==void 0?!!w:Ji(b)};qr({target:"Array",proto:!0,arity:1,forced:!Bb||!Lb},{concat:function(w){var $,A,_,Y,de,V=An(this),Fe=bl(V,0),Et=0;for($=-1,_=arguments.length;$<_;$++)if(Ub(de=$===-1?V:arguments[$]))for(Y=Ci(de),hl(Et+Y),A=0;A<Y;A++,Et++)A in de&&Ns(Fe,Et,de[A]);else hl(Et+1),Ns(Fe,Et++,de);return Fe.length=Et,Fe}});var zc,Va,Wc,Db=String,_i=function(b){if(Fs(b)==="Symbol")throw TypeError("Cannot convert a Symbol value to a string");return Db(b)},qb=qc.concat("length","prototype"),za={f:Object.getOwnPropertyNames||function(w){return gf(w,qb)}},$b=Array,Hb=Math.max,Tl=function(b,w,$){for(var A=Ci(b),_=oa(w,A),Y=oa($===void 0?A:$,A),de=$b(Hb(Y-_,0)),V=0;_<Y;_++,V++)Ns(de,V,b[_]);return de.length=V,de},Ef=za.f,Pf=typeof window=="object"&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],Sl={f:function(w){return Pf&&Oe(w)=="Window"?function($){try{return Ef($)}catch{return Tl(Pf)}}(w):Ef(lr(w))}},Wa={f:Object.getOwnPropertySymbols},ms=function(b,w,$,A){return A&&A.enumerable?b[w]=$:Ho(b,w,$),b},Ml={f:Yn},Vb=ii.f,ho=function(b){var w=nr.Symbol||(nr.Symbol={});Nn(w,b)||Vb(w,b,{value:Ml.f(b)})},Af=function(){var b=dr("Symbol"),w=b&&b.prototype,$=w&&w.valueOf,A=Yn("toPrimitive");w&&!w[A]&&ms(w,A,function(_){return Ie($,this)},{arity:1})},zb=yl?{}.toString:function(){return"[object "+Fs(this)+"]"},Wb=ii.f,Of=Yn("toStringTag"),js=function(b,w,$,A){if(b){var _=$?b:b.prototype;Nn(_,Of)||Wb(_,Of,{configurable:!0,value:w}),A&&!yl&&Ho(_,"toString",zb)}},Rf=c.WeakMap,Gb=le(Rf)&&/native code/.test(String(Rf)),Nf="Object already initialized",Cl=c.TypeError,Kb=c.WeakMap;if(Gb||Ur.state){var Bs=Ur.state||(Ur.state=new Kb),Qb=re(Bs.get),Ff=re(Bs.has),Jb=re(Bs.set);zc=function(b,w){if(Ff(Bs,b))throw Cl(Nf);return w.facade=b,Jb(Bs,b,w),w},Va=function(b){return Qb(Bs,b)||{}},Wc=function(b){return Ff(Bs,b)}}else{var sa=$c("state");ia[sa]=!0,zc=function(b,w){if(Nn(b,sa))throw Cl(Nf);return w.facade=b,Ho(b,sa,w),w},Va=function(b){return Nn(b,sa)?b[sa]:{}},Wc=function(b){return Nn(b,sa)}}var xi={set:zc,get:Va,has:Wc,enforce:function(b){return Wc(b)?Va(b):zc(b,{})},getterFor:function(b){return function(w){var $;if(!xe(w)||($=Va(w)).type!==b)throw Cl("Incompatible receiver, "+b+" required");return $}}},jf=re([].push),gs=function(b){var w=b==1,$=b==2,A=b==3,_=b==4,Y=b==6,de=b==7,V=b==5||Y;return function(Fe,Et,sr,fr){for(var Sr,Tr,Pr=An(Fe),Lr=er(Pr),jr=_o(Et,sr),Jr=Ci(Lr),Gr=0,Mn=fr||bl,Qr=w?Mn(Fe,Jr):$||de?Mn(Fe,0):void 0;Jr>Gr;Gr++)if((V||Gr in Lr)&&(Tr=jr(Sr=Lr[Gr],Gr,Pr),b))if(w)Qr[Gr]=Tr;else if(Tr)switch(b){case 3:return!0;case 5:return Sr;case 6:return Gr;case 2:jf(Qr,Sr)}else switch(b){case 4:return!1;case 7:jf(Qr,Sr)}return Y?-1:A||_?_:Qr}},hs={forEach:gs(0),map:gs(1),filter:gs(2),some:gs(3),every:gs(4),find:gs(5),findIndex:gs(6),filterReject:gs(7)},Gc=hs.forEach,si=$c("hidden"),Kc="Symbol",Yb=xi.set,Bf=xi.getterFor(Kc),Oi=Object.prototype,Ls=c.Symbol,Ga=Ls&&Ls.prototype,Xb=c.TypeError,kl=c.QObject,Lf=Ii.f,ys=ii.f,Uf=Sl.f,Zb=Ve.f,Df=re([].push),Yi=Zr("symbols"),Ka=Zr("op-symbols"),e0=Zr("wks"),xl=!kl||!kl.prototype||!kl.prototype.findChild,wl=oe&&u(function(){return ki(ys({},"a",{get:function(){return ys(this,"a",{value:7}).a}})).a!=7})?function(b,w,$){var A=Lf(Oi,w);A&&delete Oi[w],ys(b,w,$),A&&b!==Oi&&ys(Oi,w,A)}:ys,Il=function(b,w){var $=Yi[b]=ki(Ga);return Yb($,{type:Kc,tag:b,description:w}),oe||($.description=w),$},Qc=function(w,$,A){w===Oi&&Qc(Ka,$,A),Dn(w);var _=ei($);return Dn(A),Nn(Yi,_)?(A.enumerable?(Nn(w,si)&&w[si][_]&&(w[si][_]=!1),A=ki(A,{enumerable:Ce(0,!1)})):(Nn(w,si)||ys(w,si,Ce(1,{})),w[si][_]=!0),wl(w,_,A)):ys(w,_,A)},_l=function(w,$){Dn(w);var A=lr($),_=ps(A).concat(Vf(A));return Gc(_,function(Y){oe&&!Ie(qf,A,Y)||Qc(w,Y,A[Y])}),w},qf=function(w){var $=ei(w),A=Ie(Zb,this,$);return!(this===Oi&&Nn(Yi,$)&&!Nn(Ka,$))&&(!(A||!Nn(this,$)||!Nn(Yi,$)||Nn(this,si)&&this[si][$])||A)},$f=function(w,$){var A=lr(w),_=ei($);if(A!==Oi||!Nn(Yi,_)||Nn(Ka,_)){var Y=Lf(A,_);return!Y||!Nn(Yi,_)||Nn(A,si)&&A[si][_]||(Y.enumerable=!0),Y}},Hf=function(w){var $=Uf(lr(w)),A=[];return Gc($,function(_){Nn(Yi,_)||Nn(ia,_)||Df(A,_)}),A},Vf=function(b){var w=b===Oi,$=Uf(w?Ka:lr(b)),A=[];return Gc($,function(_){!Nn(Yi,_)||w&&!Nn(Oi,_)||Df(A,Yi[_])}),A};yr||(Ls=function(){if(Lt(Ga,this))throw Xb("Symbol is not a constructor");var w=arguments.length&&arguments[0]!==void 0?_i(arguments[0]):void 0,$=yi(w),A=function(_){this===Oi&&Ie(A,Ka,_),Nn(this,si)&&Nn(this[si],$)&&(this[si][$]=!1),wl(this,$,Ce(1,_))};return oe&&xl&&wl(Oi,$,{configurable:!0,set:A}),Il($,w)},Ga=Ls.prototype,ms(Ga,"toString",function(){return Bf(this).tag}),ms(Ls,"withoutSetter",function(b){return Il(yi(b),b)}),Ve.f=qf,ii.f=Qc,hf.f=_l,Ii.f=$f,za.f=Sl.f=Hf,Wa.f=Vf,Ml.f=function(b){return Il(Yn(b),b)},oe&&ys(Ga,"description",{configurable:!0,get:function(){return Bf(this).description}})),qr({global:!0,constructor:!0,wrap:!0,forced:!yr,sham:!yr},{Symbol:Ls}),Gc(ps(e0),function(b){ho(b)}),qr({target:Kc,stat:!0,forced:!yr},{useSetter:function(){xl=!0},useSimple:function(){xl=!1}}),qr({target:"Object",stat:!0,forced:!yr,sham:!oe},{create:function(w,$){return $===void 0?ki(w):_l(ki(w),$)},defineProperty:Qc,defineProperties:_l,getOwnPropertyDescriptor:$f}),qr({target:"Object",stat:!0,forced:!yr},{getOwnPropertyNames:Hf}),Af(),js(Ls,Kc),ia[si]=!0;var zf=yr&&!!Symbol.for&&!!Symbol.keyFor,El=Zr("string-to-symbol-registry"),t0=Zr("symbol-to-string-registry");qr({target:"Symbol",stat:!0,forced:!zf},{for:function(b){var w=_i(b);if(Nn(El,w))return El[w];var $=dr("Symbol")(w);return El[w]=$,t0[$]=w,$}});var Wf=Zr("symbol-to-string-registry");qr({target:"Symbol",stat:!0,forced:!zf},{keyFor:function(w){if(!Mr(w))throw TypeError(Fr(w)+" is not a symbol");if(Nn(Wf,w))return Wf[w]}});var vs=dr("JSON","stringify"),Jc=re(/./.exec),Gf=re("".charAt),r0=re("".charCodeAt),n0=re("".replace),o0=re(1 .toString),i0=/[\uD800-\uDFFF]/g,Kf=/^[\uD800-\uDBFF]$/,Qf=/^[\uDC00-\uDFFF]$/,Jf=!yr||u(function(){var b=dr("Symbol")();return vs([b])!="[null]"||vs({a:b})!="{}"||vs(Object(b))!="{}"}),Yf=u(function(){return vs("\uDF06\uD834")!=='"\\udf06\\ud834"'||vs("\uDEAD")!=='"\\udead"'}),s0=function(b,w){var $=fs(arguments),A=w;if((xe(w)||b!==void 0)&&!Mr(b))return Ji(w)||(w=function(_,Y){if(le(A)&&(Y=Ie(A,this,_,Y)),!Mr(Y))return Y}),$[1]=w,k(vs,null,$)},a0=function(b,w,$){var A=Gf($,w-1),_=Gf($,w+1);return Jc(Kf,b)&&!Jc(Qf,_)||Jc(Qf,b)&&!Jc(Kf,A)?"\\u"+o0(r0(b,0),16):b};vs&&qr({target:"JSON",stat:!0,arity:3,forced:Jf||Yf},{stringify:function(w,$,A){var _=fs(arguments),Y=k(Jf?s0:vs,null,_);return Yf&&typeof Y=="string"?n0(Y,i0,a0):Y}});var c0=!yr||u(function(){Wa.f(1)});qr({target:"Object",stat:!0,forced:c0},{getOwnPropertySymbols:function(w){var $=Wa.f;return $?$(An(w)):[]}}),ho("asyncIterator"),ho("hasInstance"),ho("isConcatSpreadable"),ho("iterator"),ho("match"),ho("matchAll"),ho("replace"),ho("search"),ho("species"),ho("split"),ho("toPrimitive"),Af(),ho("toStringTag"),js(dr("Symbol"),"Symbol"),ho("unscopables"),js(c.JSON,"JSON",!0);var bs,Xf,Zf,u0=nr.Symbol,Xi={},em=Function.prototype,l0=oe&&Object.getOwnPropertyDescriptor,Pl=Nn(em,"name"),d0={EXISTS:Pl,PROPER:Pl&&(function(){}).name==="something",CONFIGURABLE:Pl&&(!oe||oe&&l0(em,"name").configurable)},tm=!u(function(){function b(){}return b.prototype.constructor=null,Object.getPrototypeOf(new b)!==b.prototype}),rm=$c("IE_PROTO"),Al=Object,p0=Al.prototype,aa=tm?Al.getPrototypeOf:function(b){var w=An(b);if(Nn(w,rm))return w[rm];var $=w.constructor;return le($)&&w instanceof $?$.prototype:w instanceof Al?p0:null},Ol=Yn("iterator"),nm=!1;[].keys&&("next"in(Zf=[].keys())?(Xf=aa(aa(Zf)))!==Object.prototype&&(bs=Xf):nm=!0);var f0=!xe(bs)||u(function(){var b={};return bs[Ol].call(b)!==b});bs=f0?{}:ki(bs),le(bs[Ol])||ms(bs,Ol,function(){return this});var om={IteratorPrototype:bs,BUGGY_SAFARI_ITERATORS:nm},m0=om.IteratorPrototype,g0=function(){return this},h0=d0.PROPER,Yc=om.BUGGY_SAFARI_ITERATORS,Rl=Yn("iterator"),im="keys",Xc="values",sm="entries",y0=function(){return this},Nl=function(b,w,$,A,_,Y,de){(function(Jr,Gr,Mn,Qr){var Vn=Gr+" Iterator";Jr.prototype=ki(m0,{next:Ce(+!Qr,Mn)}),js(Jr,Vn,!1,!0),Xi[Vn]=g0})($,w,A);var V,Fe,Et,sr=function(Jr){if(Jr===_&&Lr)return Lr;if(!Yc&&Jr in Tr)return Tr[Jr];switch(Jr){case im:return function(){return new $(this,Jr)};case Xc:return function(){return new $(this,Jr)};case sm:return function(){return new $(this,Jr)}}return function(){return new $(this)}},fr=w+" Iterator",Sr=!1,Tr=b.prototype,Pr=Tr[Rl]||Tr["@@iterator"]||_&&Tr[_],Lr=!Yc&&Pr||sr(_),jr=w=="Array"&&Tr.entries||Pr;if(jr&&(V=aa(jr.call(new b)))!==Object.prototype&&V.next&&(js(V,fr,!0,!0),Xi[fr]=y0),h0&&_==Xc&&Pr&&Pr.name!==Xc&&(Sr=!0,Lr=function(){return Ie(Pr,this)}),_)if(Fe={values:sr(Xc),keys:Y?Lr:sr(im),entries:sr(sm)},de)for(Et in Fe)(Yc||Sr||!(Et in Tr))&&ms(Tr,Et,Fe[Et]);else qr({target:w,proto:!0,forced:Yc||Sr},Fe);return de&&Tr[Rl]!==Lr&&ms(Tr,Rl,Lr,{name:_}),Xi[w]=Lr,Fe};ii.f;var am="Array Iterator",v0=xi.set,b0=xi.getterFor(am);Nl(Array,"Array",function(b,w){v0(this,{type:am,target:lr(b),index:0,kind:w})},function(){var b=b0(this),w=b.target,$=b.kind,A=b.index++;return!w||A>=w.length?(b.target=void 0,{value:void 0,done:!0}):$=="keys"?{value:A,done:!1}:$=="values"?{value:w[A],done:!1}:{value:[A,w[A]],done:!1}},"values"),Xi.Arguments=Xi.Array;var cm=Yn("toStringTag");for(var Fl in{CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}){var um=c[Fl],jl=um&&um.prototype;jl&&Fs(jl)!==cm&&Ho(jl,cm,Fl),Xi[Fl]=Xi.Array}var T0=u0;ho("asyncDispose"),ho("dispose"),ho("matcher"),ho("metadataKey"),ho("observable"),ho("metadata"),ho("patternMatch"),ho("replaceAll");var li=T0,S0=re("".charAt),lm=re("".charCodeAt),M0=re("".slice),dm=function(b){return function(w,$){var A,_,Y=_i(pr(w)),de=Da($),V=Y.length;return de<0||de>=V?b?"":void 0:(A=lm(Y,de))<55296||A>56319||de+1===V||(_=lm(Y,de+1))<56320||_>57343?b?S0(Y,de):A:b?M0(Y,de,de+2):_-56320+(A-55296<<10)+65536}},C0={codeAt:dm(!1),charAt:dm(!0)}.charAt,pm="String Iterator",k0=xi.set,x0=xi.getterFor(pm);Nl(String,"String",function(b){k0(this,{type:pm,string:_i(b),index:0})},function(){var w,$=x0(this),A=$.string,_=$.index;return _>=A.length?{value:void 0,done:!0}:(w=C0(A,_),$.index+=w.length,{value:w,done:!1})});var fm=Ml.f("iterator"),w0=s(function(b){function w($){return b.exports=w=typeof li=="function"&&typeof fm=="symbol"?function(A){return typeof A}:function(A){return A&&typeof li=="function"&&A.constructor===li&&A!==li.prototype?"symbol":typeof A},b.exports.__esModule=!0,b.exports.default=b.exports,w($)}b.exports=w,b.exports.__esModule=!0,b.exports.default=b.exports}),mm=ii.f;qr({target:"Object",stat:!0,forced:Object.defineProperty!==mm,sham:!oe},{defineProperty:mm});var I0=s(function(b){var w=nr.Object,$=b.exports=function(_,Y,de){return w.defineProperty(_,Y,de)};w.defineProperty.sham&&($.sham=!0)}),Qa=I0,_0=u(function(){aa(1)});qr({target:"Object",stat:!0,forced:_0,sham:!tm},{getPrototypeOf:function(w){return aa(An(w))}});var Us=nr.Object.getPrototypeOf,Ds=function(b,w){var $=[][b];return!!$&&u(function(){$.call(null,w||function(){return 1},1)})},E0=hs.forEach,gm=Ds("forEach")?[].forEach:function(w){return E0(this,w,arguments.length>1?arguments[1]:void 0)};qr({target:"Array",proto:!0,forced:[].forEach!=gm},{forEach:gm});var P0=Ao("Array").forEach,Bl=Array.prototype,A0={DOMTokenList:!0,NodeList:!0},kn=function(b){var w=b.forEach;return b===Bl||Lt(Bl,b)&&w===Bl.forEach||Nn(A0,Fs(b))?P0:w},O0=re([].concat),R0=dr("Reflect","ownKeys")||function(w){var $=za.f(Dn(w)),A=Wa.f;return A?O0($,A(w)):$},hm=Error,N0=re("".replace),F0=String(hm("zxcasd").stack),ym=/\n\s*at [^:]*:[^\n]*/,j0=ym.test(F0),B0=function(b,w){if(j0&&typeof b=="string"&&!hm.prepareStackTrace)for(;w--;)b=N0(b,ym,"");return b},L0=function(b,w){xe(w)&&"cause"in w&&Ho(b,"cause",w.cause)},U0=Yn("iterator"),D0=Array.prototype,vm=function(b){return b!==void 0&&(Xi.Array===b||D0[U0]===b)},q0=Yn("iterator"),Zc=function(b){if(!Pt(b))return Sn(b,q0)||Sn(b,"@@iterator")||Xi[Fs(b)]},$0=TypeError,Ja=function(b,w){var $=arguments.length<2?Zc(b):w;if(Or($))return Dn(Ie($,b));throw $0(Fr(b)+" is not iterable")},Ll=function(b,w,$){var A,_;Dn(b);try{if(!(A=Sn(b,"return"))){if(w==="throw")throw $;return $}A=Ie(A,b)}catch(Y){_=!0,A=Y}if(w==="throw")throw $;if(_)throw A;return Dn(A),$},H0=TypeError,eu=function(b,w){this.stopped=b,this.result=w},bm=eu.prototype,to=function(b,w,$){var A,_,Y,de,V,Fe,Et,sr=$&&$.that,fr=!(!$||!$.AS_ENTRIES),Sr=!(!$||!$.IS_RECORD),Tr=!(!$||!$.IS_ITERATOR),Pr=!(!$||!$.INTERRUPTED),Lr=_o(w,sr),jr=function(Gr){return A&&Ll(A,"normal",Gr),new eu(!0,Gr)},Jr=function(Gr){return fr?(Dn(Gr),Pr?Lr(Gr[0],Gr[1],jr):Lr(Gr[0],Gr[1])):Pr?Lr(Gr,jr):Lr(Gr)};if(Sr)A=b.iterator;else if(Tr)A=b;else{if(!(_=Zc(b)))throw H0(Fr(b)+" is not iterable");if(vm(_)){for(Y=0,de=Ci(b);de>Y;Y++)if((V=Jr(b[Y]))&&Lt(bm,V))return V;return new eu(!1)}A=Ja(b,_)}for(Fe=Sr?b.next:A.next;!(Et=Ie(Fe,A)).done;){try{V=Jr(Et.value)}catch(Gr){Ll(A,"throw",Gr)}if(typeof V=="object"&&V&&Lt(bm,V))return V}return new eu(!1)},V0=function(b,w){return b===void 0?arguments.length<2?"":w:_i(b)},z0=!u(function(){var b=Error("a");return!("stack"in b)||(Object.defineProperty(b,"stack",Ce(1,7)),b.stack!==7)}),W0=Yn("toStringTag"),tu=Error,G0=[].push,Ya=function(w,$){var A,_=arguments.length>2?arguments[2]:void 0,Y=Lt(Ul,this);qa?A=qa(tu(),Y?aa(this):Ul):(A=Y?this:ki(Ul),Ho(A,W0,"Error")),$!==void 0&&Ho(A,"message",V0($)),z0&&Ho(A,"stack",B0(A.stack,1)),L0(A,_);var de=[];return to(w,G0,{that:de}),Ho(A,"errors",de),A};qa?qa(Ya,tu):function(b,w,$){for(var A=R0(w),_=ii.f,Y=Ii.f,de=0;de<A.length;de++){var V=A[de];Nn(b,V)||$&&Nn($,V)||_(b,V,Y(w,V))}}(Ya,tu,{name:!0});var Ul=Ya.prototype=ki(tu.prototype,{constructor:Ce(1,Ya),message:Ce(1,""),name:Ce(1,"AggregateError")});qr({global:!0,constructor:!0,arity:2},{AggregateError:Ya});var Xa,ca,Tm,Dl,Li=Oe(c.process)=="process",Sm=Yn("species"),Mm=function(b){var w=dr(b),$=ii.f;oe&&w&&!w[Sm]&&$(w,Sm,{configurable:!0,get:function(){return this}})},K0=TypeError,ql=function(b,w){if(Lt(w,b))return b;throw K0("Incorrect invocation")},Q0=TypeError,ru=function(b){if(Vc(b))return b;throw Q0(Fr(b)+" is not a constructor")},J0=Yn("species"),Ts=function(b,w){var $,A=Dn(b).constructor;return A===void 0||Pt($=Dn(A)[J0])?w:ru($)},Y0=TypeError,Cm=function(b,w){if(b<w)throw Y0("Not enough arguments");return b},km=/(?:ipad|iphone|ipod).*applewebkit/i.test(cr),$l=c.setImmediate,Hl=c.clearImmediate,X0=c.process,Vl=c.Dispatch,Z0=c.Function,xm=c.MessageChannel,e1=c.String,zl=0,Za={},t1="onreadystatechange";try{Xa=c.location}catch{}var Wl=function(b){if(Nn(Za,b)){var w=Za[b];delete Za[b],w()}},Gl=function(b){return function(){Wl(b)}},wm=function(b){Wl(b.data)},Im=function(b){c.postMessage(e1(b),Xa.protocol+"//"+Xa.host)};$l&&Hl||($l=function(w){Cm(arguments.length,1);var $=le(w)?w:Z0(w),A=fs(arguments,1);return Za[++zl]=function(){k($,void 0,A)},ca(zl),zl},Hl=function(w){delete Za[w]},Li?ca=function(b){X0.nextTick(Gl(b))}:Vl&&Vl.now?ca=function(b){Vl.now(Gl(b))}:xm&&!km?(Dl=(Tm=new xm).port2,Tm.port1.onmessage=wm,ca=_o(Dl.postMessage,Dl)):c.addEventListener&&le(c.postMessage)&&!c.importScripts&&Xa&&Xa.protocol!=="file:"&&!u(Im)?(ca=Im,c.addEventListener("message",wm,!1)):ca=t1 in Io("script")?function(b){ll.appendChild(Io("script")).onreadystatechange=function(){ll.removeChild(this),Wl(b)}}:function(b){setTimeout(Gl(b),0)});var ec,qs,tc,ua,Kl,Ql,Jl,_m,Em={set:$l,clear:Hl},r1=/ipad|iphone|ipod/i.test(cr)&&c.Pebble!==void 0,n1=/web0s(?!.*chrome)/i.test(cr),o1=Ii.f,Yl=Em.set,Pm=c.MutationObserver||c.WebKitMutationObserver,Am=c.document,Om=c.process,nu=c.Promise,Rm=o1(c,"queueMicrotask"),Nm=Rm&&Rm.value;Nm||(ec=function(){var b,w;for(Li&&(b=Om.domain)&&b.exit();qs;){w=qs.fn,qs=qs.next;try{w()}catch($){throw qs?ua():tc=void 0,$}}tc=void 0,b&&b.enter()},km||Li||n1||!Pm||!Am?!r1&&nu&&nu.resolve?((Jl=nu.resolve(void 0)).constructor=nu,_m=_o(Jl.then,Jl),ua=function(){_m(ec)}):Li?ua=function(){Om.nextTick(ec)}:(Yl=_o(Yl,c),ua=function(){Yl(ec)}):(Kl=!0,Ql=Am.createTextNode(""),new Pm(ec).observe(Ql,{characterData:!0}),ua=function(){Ql.data=Kl=!Kl}));var Xl=Nm||function(b){var w={fn:b,next:void 0};tc&&(tc.next=w),qs||(qs=w,ua()),tc=w},la=function(b){try{return{error:!1,value:b()}}catch(w){return{error:!0,value:w}}},Fm=function(){this.head=null,this.tail=null};Fm.prototype={add:function(b){var w={item:b,next:null};this.head?this.tail.next=w:this.head=w,this.tail=w},get:function(){var b=this.head;if(b)return this.head=b.next,this.tail===b&&(this.tail=null),b.item}};var Zl,jm,i1=Fm,Jo=c.Promise,Bm=typeof Deno=="object"&&Deno&&typeof Deno.version=="object",s1=!Bm&&!Li&&typeof window=="object"&&typeof document=="object",Lm=Jo&&Jo.prototype,a1=Yn("species"),Um=!1,Dm=le(c.PromiseRejectionEvent),c1=Ua("Promise",function(){var b=Cf(Jo),w=b!==String(Jo);if(!w&&gr===66||!Lm.catch||!Lm.finally)return!0;if(!gr||gr<51||!/native code/.test(b)){var $=new Jo(function(_){_(1)}),A=function(_){_(function(){},function(){})};if(($.constructor={})[a1]=A,!(Um=$.then(function(){})instanceof A))return!0}return!w&&(s1||Bm)&&!Dm}),da={CONSTRUCTOR:c1,REJECTION_EVENT:Dm,SUBCLASSING:Um},u1=TypeError,l1=function(b){var w,$;this.promise=new b(function(A,_){if(w!==void 0||$!==void 0)throw u1("Bad Promise constructor");w=A,$=_}),this.resolve=Or(w),this.reject=Or($)},Zi={f:function(b){return new l1(b)}},qm=Em.set,ou="Promise",$m=da.CONSTRUCTOR,d1=da.REJECTION_EVENT,ed=xi.getterFor(ou),p1=xi.set,f1=Jo&&Jo.prototype,rc=Jo,td=f1,Hm=c.TypeError,rd=c.document,nd=c.process,od=Zi.f,m1=od,g1=!!(rd&&rd.createEvent&&c.dispatchEvent),Vm="unhandledrejection",zm=function(b){var w;return!(!xe(b)||!le(w=b.then))&&w},Wm=function(b,w){var $,A,_,Y=w.value,de=w.state==1,V=de?b.ok:b.fail,Fe=b.resolve,Et=b.reject,sr=b.domain;try{V?(de||(w.rejection===2&&y1(w),w.rejection=1),V===!0?$=Y:(sr&&sr.enter(),$=V(Y),sr&&(sr.exit(),_=!0)),$===b.promise?Et(Hm("Promise-chain cycle")):(A=zm($))?Ie(A,$,Fe,Et):Fe($)):Et(Y)}catch(fr){sr&&!_&&sr.exit(),Et(fr)}},Gm=function(b,w){b.notified||(b.notified=!0,Xl(function(){for(var $,A=b.reactions;$=A.get();)Wm($,b);b.notified=!1,w&&!b.rejection&&h1(b)}))},Km=function(b,w,$){var A,_;g1?((A=rd.createEvent("Event")).promise=w,A.reason=$,A.initEvent(b,!1,!0),c.dispatchEvent(A)):A={promise:w,reason:$},!d1&&(_=c["on"+b])?_(A):b===Vm&&function(Y,de){var V=c.console;V&&V.error&&(arguments.length==1?V.error(Y):V.error(Y,de))}("Unhandled promise rejection",$)},h1=function(b){Ie(qm,c,function(){var w,$=b.facade,A=b.value;if(Qm(b)&&(w=la(function(){Li?nd.emit("unhandledRejection",A,$):Km(Vm,$,A)}),b.rejection=Li||Qm(b)?2:1,w.error))throw w.value})},Qm=function(b){return b.rejection!==1&&!b.parent},y1=function(b){Ie(qm,c,function(){var w=b.facade;Li?nd.emit("rejectionHandled",w):Km("rejectionhandled",w,b.value)})},pa=function(b,w,$){return function(A){b(w,A,$)}},fa=function(b,w,$){b.done||(b.done=!0,$&&(b=$),b.value=w,b.state=2,Gm(b,!0))},id=function(b,w,$){if(!b.done){b.done=!0,$&&(b=$);try{if(b.facade===w)throw Hm("Promise can't be resolved itself");var A=zm(w);A?Xl(function(){var _={done:!1};try{Ie(A,w,pa(id,_,b),pa(fa,_,b))}catch(Y){fa(_,Y,b)}}):(b.value=w,b.state=1,Gm(b,!1))}catch(_){fa({done:!1},_,b)}}};$m&&(td=(rc=function(w){ql(this,td),Or(w),Ie(Zl,this);var $=ed(this);try{w(pa(id,$),pa(fa,$))}catch(A){fa($,A)}}).prototype,(Zl=function(w){p1(this,{type:ou,done:!1,notified:!1,parent:!1,reactions:new i1,rejection:!1,state:0,value:void 0})}).prototype=ms(td,"then",function(w,$){var A=ed(this),_=od(Ts(this,rc));return A.parent=!0,_.ok=!le(w)||w,_.fail=le($)&&$,_.domain=Li?nd.domain:void 0,A.state==0?A.reactions.add(_):Xl(function(){Wm(_,A)}),_.promise}),jm=function(){var b=new Zl,w=ed(b);this.promise=b,this.resolve=pa(id,w),this.reject=pa(fa,w)},Zi.f=od=function(b){return b===rc||b===void 0?new jm(b):m1(b)}),qr({global:!0,constructor:!0,wrap:!0,forced:$m},{Promise:rc}),js(rc,ou,!1,!0),Mm(ou);var Jm=Yn("iterator"),Ym=!1;try{var v1=0,Xm={next:function(){return{done:!!v1++}},return:function(){Ym=!0}};Xm[Jm]=function(){return this},Array.from(Xm,function(){throw 2})}catch{}var Zm=function(b,w){if(!w&&!Ym)return!1;var $=!1;try{var A={};A[Jm]=function(){return{next:function(){return{done:$=!0}}}},b(A)}catch{}return $},eg=da.CONSTRUCTOR||!Zm(function(b){Jo.all(b).then(void 0,function(){})});qr({target:"Promise",stat:!0,forced:eg},{all:function(w){var $=this,A=Zi.f($),_=A.resolve,Y=A.reject,de=la(function(){var V=Or($.resolve),Fe=[],Et=0,sr=1;to(w,function(fr){var Sr=Et++,Tr=!1;sr++,Ie(V,$,fr).then(function(Pr){Tr||(Tr=!0,Fe[Sr]=Pr,--sr||_(Fe))},Y)}),--sr||_(Fe)});return de.error&&Y(de.value),A.promise}});var b1=da.CONSTRUCTOR;Jo&&Jo.prototype,qr({target:"Promise",proto:!0,forced:b1,real:!0},{catch:function(b){return this.then(void 0,b)}}),qr({target:"Promise",stat:!0,forced:eg},{race:function(w){var $=this,A=Zi.f($),_=A.reject,Y=la(function(){var de=Or($.resolve);to(w,function(V){Ie(de,$,V).then(A.resolve,_)})});return Y.error&&_(Y.value),A.promise}}),qr({target:"Promise",stat:!0,forced:da.CONSTRUCTOR},{reject:function(w){var $=Zi.f(this);return Ie($.reject,void 0,w),$.promise}});var sd=function(b,w){if(Dn(b),xe(w)&&w.constructor===b)return w;var $=Zi.f(b);return(0,$.resolve)(w),$.promise},T1=da.CONSTRUCTOR,S1=dr("Promise"),M1=!T1;qr({target:"Promise",stat:!0,forced:!0},{resolve:function(w){return sd(M1&&this===S1?Jo:this,w)}}),qr({target:"Promise",stat:!0},{allSettled:function(w){var $=this,A=Zi.f($),_=A.resolve,Y=A.reject,de=la(function(){var V=Or($.resolve),Fe=[],Et=0,sr=1;to(w,function(fr){var Sr=Et++,Tr=!1;sr++,Ie(V,$,fr).then(function(Pr){Tr||(Tr=!0,Fe[Sr]={status:"fulfilled",value:Pr},--sr||_(Fe))},function(Pr){Tr||(Tr=!0,Fe[Sr]={status:"rejected",reason:Pr},--sr||_(Fe))})}),--sr||_(Fe)});return de.error&&Y(de.value),A.promise}});var tg="No one promise resolved";qr({target:"Promise",stat:!0},{any:function(w){var $=this,A=dr("AggregateError"),_=Zi.f($),Y=_.resolve,de=_.reject,V=la(function(){var Fe=Or($.resolve),Et=[],sr=0,fr=1,Sr=!1;to(w,function(Tr){var Pr=sr++,Lr=!1;fr++,Ie(Fe,$,Tr).then(function(jr){Lr||Sr||(Sr=!0,Y(jr))},function(jr){Lr||Sr||(Lr=!0,Et[Pr]=jr,--fr||de(new A(Et,tg)))})}),--fr||de(new A(Et,tg))});return V.error&&de(V.value),_.promise}});var C1=Jo&&Jo.prototype,k1=!!Jo&&u(function(){C1.finally.call({then:function(){}},function(){})});qr({target:"Promise",proto:!0,real:!0,forced:k1},{finally:function(b){var w=Ts(this,dr("Promise")),$=le(b);return this.then($?function(A){return sd(w,b()).then(function(){return A})}:b,$?function(A){return sd(w,b()).then(function(){throw A})}:b)}});var x1=nr.Promise;qr({target:"Promise",stat:!0,forced:!0},{try:function(b){var w=Zi.f(this),$=la(b);return($.error?w.reject:w.resolve)($.value),w.promise}});var ro=x1,w1=re([].reverse),rg=[1,2];qr({target:"Array",proto:!0,forced:String(rg)===String(rg.reverse())},{reverse:function(){return Ji(this)&&(this.length=this.length),w1(this)}});var I1=Ao("Array").reverse,ad=Array.prototype,Eu=function(b){var w=b.reverse;return b===ad||Lt(ad,b)&&w===ad.reverse?I1:w},_1=Ha("slice"),E1=Yn("species"),cd=Array,P1=Math.max;qr({target:"Array",proto:!0,forced:!_1},{slice:function(w,$){var A,_,Y,de=lr(this),V=Ci(de),Fe=oa(w,V),Et=oa($===void 0?V:$,V);if(Ji(de)&&(A=de.constructor,(Vc(A)&&(A===cd||Ji(A.prototype))||xe(A)&&(A=A[E1])===null)&&(A=void 0),A===cd||A===void 0))return fs(de,Fe,Et);for(_=new(A===void 0?cd:A)(P1(Et-Fe,0)),Y=0;Fe<Et;Fe++,Y++)Fe in de&&Ns(_,Y,de[Fe]);return _.length=Y,_}});var A1=Ao("Array").slice,ud=Array.prototype,fo=function(b){var w=b.slice;return b===ud||Lt(ud,b)&&w===ud.slice?A1:w},O1=s(function(b){var w=w0.default;function $(){b.exports=$=function(){return A},b.exports.__esModule=!0,b.exports.default=b.exports;var A={},_=Object.prototype,Y=_.hasOwnProperty,de=typeof li=="function"?li:{},V=de.iterator||"@@iterator",Fe=de.asyncIterator||"@@asyncIterator",Et=de.toStringTag||"@@toStringTag";function sr(vn,Kr,_n){return Qa(vn,Kr,{value:_n,enumerable:!0,configurable:!0,writable:!0}),vn[Kr]}try{sr({},"")}catch{sr=function(_n,Ln,Kn){return _n[Ln]=Kn}}function fr(vn,Kr,_n,Ln){var Kn=Kr&&Kr.prototype instanceof Pr?Kr:Pr,Qn=Qi(Kn.prototype),Po=new wr(Ln||[]);return Qn._invoke=function(ao,Wo,po){var vo="suspendedStart";return function(Go,ka){if(vo==="executing")throw new Error("Generator is already running");if(vo==="completed"){if(Go==="throw")throw ka;return En()}for(po.method=Go,po.arg=ka;;){var bo=po.delegate;if(bo){var xa=Bn(bo,po);if(xa){if(xa===Tr)continue;return xa}}if(po.method==="next")po.sent=po._sent=po.arg;else if(po.method==="throw"){if(vo==="suspendedStart")throw vo="completed",po.arg;po.dispatchException(po.arg)}else po.method==="return"&&po.abrupt("return",po.arg);vo="executing";var Fi=Sr(ao,Wo,po);if(Fi.type==="normal"){if(vo=po.done?"completed":"suspendedYield",Fi.arg===Tr)continue;return{value:Fi.arg,done:po.done}}Fi.type==="throw"&&(vo="completed",po.method="throw",po.arg=Fi.arg)}}}(vn,_n,Po),Qn}function Sr(vn,Kr,_n){try{return{type:"normal",arg:vn.call(Kr,_n)}}catch(Ln){return{type:"throw",arg:Ln}}}A.wrap=fr;var Tr={};function Pr(){}function Lr(){}function jr(){}var Jr={};sr(Jr,V,function(){return this});var Gr=Us&&Us(Us(Cn([])));Gr&&Gr!==_&&Y.call(Gr,V)&&(Jr=Gr);var Mn=jr.prototype=Pr.prototype=Qi(Jr);function Qr(vn){var Kr;kn(Kr=["next","throw","return"]).call(Kr,function(_n){sr(vn,_n,function(Ln){return this._invoke(_n,Ln)})})}function Vn(vn,Kr){function _n(Kn,Qn,Po,ao){var Wo=Sr(vn[Kn],vn,Qn);if(Wo.type!=="throw"){var po=Wo.arg,vo=po.value;return vo&&w(vo)=="object"&&Y.call(vo,"__await")?Kr.resolve(vo.__await).then(function(Go){_n("next",Go,Po,ao)},function(Go){_n("throw",Go,Po,ao)}):Kr.resolve(vo).then(function(Go){po.value=Go,Po(po)},function(Go){return _n("throw",Go,Po,ao)})}ao(Wo.arg)}var Ln;this._invoke=function(Kn,Qn){function Po(){return new Kr(function(ao,Wo){_n(Kn,Qn,ao,Wo)})}return Ln=Ln?Ln.then(Po,Po):Po()}}function Bn(vn,Kr){var _n=vn.iterator[Kr.method];if(_n===void 0){if(Kr.delegate=null,Kr.method==="throw"){if(vn.iterator.return&&(Kr.method="return",Kr.arg=void 0,Bn(vn,Kr),Kr.method==="throw"))return Tr;Kr.method="throw",Kr.arg=new TypeError("The iterator does not provide a 'throw' method")}return Tr}var Ln=Sr(_n,vn.iterator,Kr.arg);if(Ln.type==="throw")return Kr.method="throw",Kr.arg=Ln.arg,Kr.delegate=null,Tr;var Kn=Ln.arg;return Kn?Kn.done?(Kr[vn.resultName]=Kn.value,Kr.next=vn.nextLoc,Kr.method!=="return"&&(Kr.method="next",Kr.arg=void 0),Kr.delegate=null,Tr):Kn:(Kr.method="throw",Kr.arg=new TypeError("iterator result is not an object"),Kr.delegate=null,Tr)}function Eo(vn){var Kr={tryLoc:vn[0]};1 in vn&&(Kr.catchLoc=vn[1]),2 in vn&&(Kr.finallyLoc=vn[2],Kr.afterLoc=vn[3]),this.tryEntries.push(Kr)}function jn(vn){var Kr=vn.completion||{};Kr.type="normal",delete Kr.arg,vn.completion=Kr}function wr(vn){this.tryEntries=[{tryLoc:"root"}],kn(vn).call(vn,Eo,this),this.reset(!0)}function Cn(vn){if(vn){var Kr=vn[V];if(Kr)return Kr.call(vn);if(typeof vn.next=="function")return vn;if(!isNaN(vn.length)){var _n=-1,Ln=function Kn(){for(;++_n<vn.length;)if(Y.call(vn,_n))return Kn.value=vn[_n],Kn.done=!1,Kn;return Kn.value=void 0,Kn.done=!0,Kn};return Ln.next=Ln}}return{next:En}}function En(){return{value:void 0,done:!0}}return Lr.prototype=jr,sr(Mn,"constructor",jr),sr(jr,"constructor",Lr),Lr.displayName=sr(jr,Et,"GeneratorFunction"),A.isGeneratorFunction=function(vn){var Kr=typeof vn=="function"&&vn.constructor;return!!Kr&&(Kr===Lr||(Kr.displayName||Kr.name)==="GeneratorFunction")},A.mark=function(vn){return Rs?Rs(vn,jr):(vn.__proto__=jr,sr(vn,Et,"GeneratorFunction")),vn.prototype=Qi(Mn),vn},A.awrap=function(vn){return{__await:vn}},Qr(Vn.prototype),sr(Vn.prototype,Fe,function(){return this}),A.AsyncIterator=Vn,A.async=function(vn,Kr,_n,Ln,Kn){Kn===void 0&&(Kn=ro);var Qn=new Vn(fr(vn,Kr,_n,Ln),Kn);return A.isGeneratorFunction(Kr)?Qn:Qn.next().then(function(Po){return Po.done?Po.value:Qn.next()})},Qr(Mn),sr(Mn,Et,"Generator"),sr(Mn,V,function(){return this}),sr(Mn,"toString",function(){return"[object Generator]"}),A.keys=function(vn){var Kr=[];for(var _n in vn)Kr.push(_n);return Eu(Kr).call(Kr),function Ln(){for(;Kr.length;){var Kn=Kr.pop();if(Kn in vn)return Ln.value=Kn,Ln.done=!1,Ln}return Ln.done=!0,Ln}},A.values=Cn,wr.prototype={constructor:wr,reset:function(Kr){var _n;if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,kn(_n=this.tryEntries).call(_n,jn),!Kr)for(var Ln in this)Ln.charAt(0)==="t"&&Y.call(this,Ln)&&!isNaN(+fo(Ln).call(Ln,1))&&(this[Ln]=void 0)},stop:function(){this.done=!0;var Kr=this.tryEntries[0].completion;if(Kr.type==="throw")throw Kr.arg;return this.rval},dispatchException:function(Kr){if(this.done)throw Kr;var _n=this;function Ln(po,vo){return Po.type="throw",Po.arg=Kr,_n.next=po,vo&&(_n.method="next",_n.arg=void 0),!!vo}for(var Kn=this.tryEntries.length-1;Kn>=0;--Kn){var Qn=this.tryEntries[Kn],Po=Qn.completion;if(Qn.tryLoc==="root")return Ln("end");if(Qn.tryLoc<=this.prev){var ao=Y.call(Qn,"catchLoc"),Wo=Y.call(Qn,"finallyLoc");if(ao&&Wo){if(this.prev<Qn.catchLoc)return Ln(Qn.catchLoc,!0);if(this.prev<Qn.finallyLoc)return Ln(Qn.finallyLoc)}else if(ao){if(this.prev<Qn.catchLoc)return Ln(Qn.catchLoc,!0)}else{if(!Wo)throw new Error("try statement without catch or finally");if(this.prev<Qn.finallyLoc)return Ln(Qn.finallyLoc)}}}},abrupt:function(Kr,_n){for(var Ln=this.tryEntries.length-1;Ln>=0;--Ln){var Kn=this.tryEntries[Ln];if(Kn.tryLoc<=this.prev&&Y.call(Kn,"finallyLoc")&&this.prev<Kn.finallyLoc){var Qn=Kn;break}}Qn&&(Kr==="break"||Kr==="continue")&&Qn.tryLoc<=_n&&_n<=Qn.finallyLoc&&(Qn=null);var Po=Qn?Qn.completion:{};return Po.type=Kr,Po.arg=_n,Qn?(this.method="next",this.next=Qn.finallyLoc,Tr):this.complete(Po)},complete:function(Kr,_n){if(Kr.type==="throw")throw Kr.arg;return Kr.type==="break"||Kr.type==="continue"?this.next=Kr.arg:Kr.type==="return"?(this.rval=this.arg=Kr.arg,this.method="return",this.next="end"):Kr.type==="normal"&&_n&&(this.next=_n),Tr},finish:function(Kr){for(var _n=this.tryEntries.length-1;_n>=0;--_n){var Ln=this.tryEntries[_n];if(Ln.finallyLoc===Kr)return this.complete(Ln.completion,Ln.afterLoc),jn(Ln),Tr}},catch:function(Kr){for(var _n=this.tryEntries.length-1;_n>=0;--_n){var Ln=this.tryEntries[_n];if(Ln.tryLoc===Kr){var Kn=Ln.completion;if(Kn.type==="throw"){var Qn=Kn.arg;jn(Ln)}return Qn}}throw new Error("illegal catch attempt")},delegateYield:function(Kr,_n,Ln){return this.delegate={iterator:Cn(Kr),resultName:_n,nextLoc:Ln},this.method==="next"&&(this.arg=void 0),Tr}},A}b.exports=$,b.exports.__esModule=!0,b.exports.default=b.exports}),iu=O1(),rr=iu;try{regeneratorRuntime=iu}catch{typeof globalThis=="object"?globalThis.regeneratorRuntime=iu:Function("r","regeneratorRuntime = r")(iu)}qr({target:"Number",stat:!0,nonConfigurable:!0,nonWritable:!0},{MAX_SAFE_INTEGER:9007199254740991});var ng=9007199254740991,Pu=Object.assign,No=Object.defineProperty,Au=re([].concat),og=!Pu||u(function(){if(oe&&Pu({b:1},Pu(No({},"a",{enumerable:!0,get:function(){No(this,"b",{value:3,enumerable:!1})}}),{b:2})).b!==1)return!0;var b={},w={},$=Symbol(),A="abcdefghijklmnopqrst";return b[$]=7,A.split("").forEach(function(_){w[_]=_}),Pu({},b)[$]!=7||ps(Pu({},w)).join("")!=A})?function(w,$){for(var A=An(w),_=arguments.length,Y=1,de=Wa.f,V=Ve.f;_>Y;)for(var Fe,Et=er(arguments[Y++]),sr=de?Au(ps(Et),de(Et)):ps(Et),fr=sr.length,Sr=0;fr>Sr;)Fe=sr[Sr++],oe&&!Ie(V,Et,Fe)||(A[Fe]=Et[Fe]);return A}:Pu;qr({target:"Object",stat:!0,arity:2,forced:Object.assign!==og},{assign:og});var Xr=nr.Object.assign;function Ou(b,w){var $={};for(var A in b)Object.prototype.hasOwnProperty.call(b,A)&&w.indexOf(A)<0&&($[A]=b[A]);if(b!=null&&typeof Object.getOwnPropertySymbols=="function"){var _=0;for(A=Object.getOwnPropertySymbols(b);_<A.length;_++)w.indexOf(A[_])<0&&Object.prototype.propertyIsEnumerable.call(b,A[_])&&($[A[_]]=b[A[_]])}return $}function kr(b,w,$,A){return new($||($=Promise))(function(_,Y){function de(Et){try{Fe(A.next(Et))}catch(sr){Y(sr)}}function V(Et){try{Fe(A.throw(Et))}catch(sr){Y(sr)}}function Fe(Et){Et.done?_(Et.value):function(fr){return fr instanceof $?fr:new $(function(Sr){Sr(fr)})}(Et.value).then(de,V)}Fe((A=A.apply(b,w||[])).next())})}var Xh=u(function(){if(typeof ArrayBuffer=="function"){var b=new ArrayBuffer(8);Object.isExtensible(b)&&Object.defineProperty(b,"a",{value:8})}}),Uo=Object.isExtensible,ig=u(function(){Uo(1)})||Xh?function(w){return!!xe(w)&&(!Xh||Oe(w)!="ArrayBuffer")&&(!Uo||Uo(w))}:Uo,sg=!u(function(){return Object.isExtensible(Object.preventExtensions({}))}),ag=s(function(b){var w=ii.f,$=!1,A=yi("meta"),_=0,Y=function(V){w(V,A,{value:{objectID:"O"+_++,weakData:{}}})},de=b.exports={enable:function(){de.enable=function(){},$=!0;var V=za.f,Fe=re([].splice),Et={};Et[A]=1,V(Et).length&&(za.f=function(sr){for(var fr=V(sr),Sr=0,Tr=fr.length;Sr<Tr;Sr++)if(fr[Sr]===A){Fe(fr,Sr,1);break}return fr},qr({target:"Object",stat:!0,forced:!0},{getOwnPropertyNames:Sl.f}))},fastKey:function(V,Fe){if(!xe(V))return typeof V=="symbol"?V:(typeof V=="string"?"S":"P")+V;if(!Nn(V,A)){if(!ig(V))return"F";if(!Fe)return"E";Y(V)}return V[A].objectID},getWeakData:function(V,Fe){if(!Nn(V,A)){if(!ig(V))return!0;if(!Fe)return!1;Y(V)}return V[A].weakData},onFreeze:function(V){return sg&&$&&ig(V)&&!Nn(V,A)&&Y(V),V}};ia[A]=!0}),R1=ii.f,N1=hs.forEach,cg=xi.set,bi=xi.getterFor,Zh=function(b,w,$){var A,_=b.indexOf("Map")!==-1,Y=b.indexOf("Weak")!==-1,de=_?"set":"add",V=c[b],Fe=V&&V.prototype,Et={};if(oe&&le(V)&&(Y||Fe.forEach&&!u(function(){new V().entries().next()}))){var sr=(A=w(function(Sr,Tr){cg(ql(Sr,sr),{type:b,collection:new V}),Tr!=null&&to(Tr,Sr[de],{that:Sr,AS_ENTRIES:_})})).prototype,fr=bi(b);N1(["add","clear","delete","forEach","get","has","set","keys","values","entries"],function(Sr){var Tr=Sr=="add"||Sr=="set";!(Sr in Fe)||Y&&Sr=="clear"||Ho(sr,Sr,function(Pr,Lr){var jr=fr(this).collection;if(!Tr&&Y&&!xe(Pr))return Sr=="get"&&void 0;var Jr=jr[Sr](Pr===0?0:Pr,Lr);return Tr?this:Jr})}),Y||R1(sr,"size",{configurable:!0,get:function(){return fr(this).collection.size}})}else A=$.getConstructor(w,b,_,de),ag.enable();return js(A,b,!1,!0),Et[b]=A,qr({global:!0,forced:!0},Et),Y||$.setStrong(A,b,_),A},tp=function(b,w,$){for(var A in w)$&&$.unsafe&&b[A]?b[A]=w[A]:ms(b,A,w[A],$);return b},Ss=ii.f,Is=ag.fastKey,hn=xi.set,rp=xi.getterFor,ld={getConstructor:function(b,w,$,A){var _=b(function(Et,sr){ql(Et,Y),hn(Et,{type:w,index:ki(null),first:void 0,last:void 0,size:0}),oe||(Et.size=0),Pt(sr)||to(sr,Et[A],{that:Et,AS_ENTRIES:$})}),Y=_.prototype,de=rp(w),V=function(Et,sr,fr){var Sr,Tr,Pr=de(Et),Lr=Fe(Et,sr);return Lr?Lr.value=fr:(Pr.last=Lr={index:Tr=Is(sr,!0),key:sr,value:fr,previous:Sr=Pr.last,next:void 0,removed:!1},Pr.first||(Pr.first=Lr),Sr&&(Sr.next=Lr),oe?Pr.size++:Et.size++,Tr!=="F"&&(Pr.index[Tr]=Lr)),Et},Fe=function(Et,sr){var fr,Sr=de(Et),Tr=Is(sr);if(Tr!=="F")return Sr.index[Tr];for(fr=Sr.first;fr;fr=fr.next)if(fr.key==sr)return fr};return tp(Y,{clear:function(){for(var sr=de(this),fr=sr.index,Sr=sr.first;Sr;)Sr.removed=!0,Sr.previous&&(Sr.previous=Sr.previous.next=void 0),delete fr[Sr.index],Sr=Sr.next;sr.first=sr.last=void 0,oe?sr.size=0:this.size=0},delete:function(Et){var sr=this,fr=de(sr),Sr=Fe(sr,Et);if(Sr){var Tr=Sr.next,Pr=Sr.previous;delete fr.index[Sr.index],Sr.removed=!0,Pr&&(Pr.next=Tr),Tr&&(Tr.previous=Pr),fr.first==Sr&&(fr.first=Tr),fr.last==Sr&&(fr.last=Pr),oe?fr.size--:sr.size--}return!!Sr},forEach:function(sr){for(var fr,Sr=de(this),Tr=_o(sr,arguments.length>1?arguments[1]:void 0);fr=fr?fr.next:Sr.first;)for(Tr(fr.value,fr.key,this);fr&&fr.removed;)fr=fr.previous},has:function(sr){return!!Fe(this,sr)}}),tp(Y,$?{get:function(sr){var fr=Fe(this,sr);return fr&&fr.value},set:function(sr,fr){return V(this,sr===0?0:sr,fr)}}:{add:function(sr){return V(this,sr=sr===0?0:sr,sr)}}),oe&&Ss(Y,"size",{get:function(){return de(this).size}}),_},setStrong:function(b,w,$){var A=w+" Iterator",_=rp(w),Y=rp(A);Nl(b,w,function(de,V){hn(this,{type:A,target:de,state:_(de),kind:V,last:void 0})},function(){for(var de=Y(this),V=de.kind,Fe=de.last;Fe&&Fe.removed;)Fe=Fe.previous;return de.target&&(de.last=Fe=Fe?Fe.next:de.state.first)?V=="keys"?{value:Fe.key,done:!1}:V=="values"?{value:Fe.value,done:!1}:{value:[Fe.key,Fe.value],done:!1}:(de.target=void 0,{value:void 0,done:!0})},$?"entries":"values",!$,!0),Mm(w)}};Zh("Map",function(b){return function(){return b(this,arguments.length?arguments[0]:void 0)}},ld);var ug=nr.Map,ey=[].push,lg=function(w){var $,A,_,Y,de=arguments.length,V=de>1?arguments[1]:void 0;return ru(this),($=V!==void 0)&&Or(V),Pt(w)?new this:(A=[],$?(_=0,Y=_o(V,de>2?arguments[2]:void 0),to(w,function(Fe){Ie(ey,A,Y(Fe,_++))})):to(w,ey,{that:A}),new this(A))};qr({target:"Map",stat:!0,forced:!0},{from:lg});var ty=function(){return new this(fs(arguments))};qr({target:"Map",stat:!0,forced:!0},{of:ty});var ry=function(){for(var w,$=Dn(this),A=Or($.delete),_=!0,Y=0,de=arguments.length;Y<de;Y++)w=Ie(A,$,arguments[Y]),_=_&&w;return!!_};qr({target:"Map",proto:!0,real:!0,forced:!0},{deleteAll:ry}),qr({target:"Map",proto:!0,real:!0,forced:!0},{emplace:function(w,$){var A,_,Y=Dn(this),de=Or(Y.get),V=Or(Y.has),Fe=Or(Y.set);return Ie(V,Y,w)?(A=Ie(de,Y,w),"update"in $&&(A=$.update(A,w,Y),Ie(Fe,Y,w,A)),A):(_=$.insert(w,Y),Ie(Fe,Y,w,_),_)}});var wa=Ja;qr({target:"Map",proto:!0,real:!0,forced:!0},{every:function(w){var $=Dn(this),A=wa($),_=_o(w,arguments.length>1?arguments[1]:void 0);return!to(A,function(Y,de,V){if(!_(de,Y,$))return V()},{AS_ENTRIES:!0,IS_ITERATOR:!0,INTERRUPTED:!0}).stopped}}),qr({target:"Map",proto:!0,real:!0,forced:!0},{filter:function(w){var $=Dn(this),A=wa($),_=_o(w,arguments.length>1?arguments[1]:void 0),Y=new(Ts($,dr("Map"))),de=Or(Y.set);return to(A,function(V,Fe){_(Fe,V,$)&&Ie(de,Y,V,Fe)},{AS_ENTRIES:!0,IS_ITERATOR:!0}),Y}}),qr({target:"Map",proto:!0,real:!0,forced:!0},{find:function(w){var $=Dn(this),A=wa($),_=_o(w,arguments.length>1?arguments[1]:void 0);return to(A,function(Y,de,V){if(_(de,Y,$))return V(de)},{AS_ENTRIES:!0,IS_ITERATOR:!0,INTERRUPTED:!0}).result}}),qr({target:"Map",proto:!0,real:!0,forced:!0},{findKey:function(w){var $=Dn(this),A=wa($),_=_o(w,arguments.length>1?arguments[1]:void 0);return to(A,function(Y,de,V){if(_(de,Y,$))return V(Y)},{AS_ENTRIES:!0,IS_ITERATOR:!0,INTERRUPTED:!0}).result}});var F1=re([].push);qr({target:"Map",stat:!0,forced:!0},{groupBy:function(w,$){Or($);var A=Ja(w),_=new this,Y=Or(_.has),de=Or(_.get),V=Or(_.set);return to(A,function(Fe){var Et=$(Fe);Ie(Y,_,Et)?F1(Ie(de,_,Et),Fe):Ie(V,_,Et,[Fe])},{IS_ITERATOR:!0}),_}}),qr({target:"Map",proto:!0,real:!0,forced:!0},{includes:function(w){return to(wa(Dn(this)),function($,A,_){if((Y=A)===(de=w)||Y!=Y&&de!=de)return _();var Y,de},{AS_ENTRIES:!0,IS_ITERATOR:!0,INTERRUPTED:!0}).stopped}}),qr({target:"Map",stat:!0,forced:!0},{keyBy:function(w,$){var A=new this;Or($);var _=Or(A.set);return to(w,function(Y){Ie(_,A,$(Y),Y)}),A}}),qr({target:"Map",proto:!0,real:!0,forced:!0},{keyOf:function(w){return to(wa(Dn(this)),function($,A,_){if(A===w)return _($)},{AS_ENTRIES:!0,IS_ITERATOR:!0,INTERRUPTED:!0}).result}}),qr({target:"Map",proto:!0,real:!0,forced:!0},{mapKeys:function(w){var $=Dn(this),A=wa($),_=_o(w,arguments.length>1?arguments[1]:void 0),Y=new(Ts($,dr("Map"))),de=Or(Y.set);return to(A,function(V,Fe){Ie(de,Y,_(Fe,V,$),Fe)},{AS_ENTRIES:!0,IS_ITERATOR:!0}),Y}}),qr({target:"Map",proto:!0,real:!0,forced:!0},{mapValues:function(w){var $=Dn(this),A=wa($),_=_o(w,arguments.length>1?arguments[1]:void 0),Y=new(Ts($,dr("Map"))),de=Or(Y.set);return to(A,function(V,Fe){Ie(de,Y,V,_(Fe,V,$))},{AS_ENTRIES:!0,IS_ITERATOR:!0}),Y}}),qr({target:"Map",proto:!0,real:!0,arity:1,forced:!0},{merge:function(w){for(var $=Dn(this),A=Or($.set),_=arguments.length,Y=0;Y<_;)to(arguments[Y++],A,{that:$,AS_ENTRIES:!0});return $}});var ny=TypeError;qr({target:"Map",proto:!0,real:!0,forced:!0},{reduce:function(w){var $=Dn(this),A=wa($),_=arguments.length<2,Y=_?void 0:arguments[1];if(Or(w),to(A,function(de,V){_?(_=!1,Y=V):Y=w(Y,V,de,$)},{AS_ENTRIES:!0,IS_ITERATOR:!0}),_)throw ny("Reduce of empty map with no initial value");return Y}}),qr({target:"Map",proto:!0,real:!0,forced:!0},{some:function(w){var $=Dn(this),A=wa($),_=_o(w,arguments.length>1?arguments[1]:void 0);return to(A,function(Y,de,V){if(_(de,Y,$))return V()},{AS_ENTRIES:!0,IS_ITERATOR:!0,INTERRUPTED:!0}).stopped}});var j1=TypeError;qr({target:"Map",proto:!0,real:!0,forced:!0},{update:function(w,$){var A=Dn(this),_=Or(A.get),Y=Or(A.has),de=Or(A.set),V=arguments.length;Or($);var Fe=Ie(Y,A,w);if(!Fe&&V<3)throw j1("Updating absent value");var Et=Fe?Ie(_,A,w):Or(V>2?arguments[2]:void 0)(w,A);return Ie(de,A,w,$(Et,w,A)),A}});var oy=TypeError,dg=function(w,$){var A,_=Dn(this),Y=Or(_.get),de=Or(_.has),V=Or(_.set),Fe=arguments.length>2?arguments[2]:void 0;if(!le($)&&!le(Fe))throw oy("At least one callback required");return Ie(de,_,w)?(A=Ie(Y,_,w),le($)&&(A=$(A),Ie(V,_,w,A))):le(Fe)&&(A=Fe(),Ie(V,_,w,A)),A};qr({target:"Map",proto:!0,real:!0,forced:!0},{upsert:dg}),qr({target:"Map",proto:!0,real:!0,name:"upsert",forced:!0},{updateOrInsert:dg});var su=ug,iy=Date,B1=re(iy.prototype.getTime);qr({target:"Date",stat:!0},{now:function(){return B1(new iy)}});var es=nr.Date.now,Ia=Ao("Array").concat,pg=Array.prototype,$s=function(b){var w=b.concat;return b===pg||Lt(pg,b)&&w===pg.concat?Ia:w},L1=/MSIE .\./.test(cr),U1=c.Function,fg=function(b){return L1?function(w,$){var A=Cm(arguments.length,1)>2,_=le(w)?w:U1(w),Y=A?fs(arguments,2):void 0;return b(A?function(){k(_,this,Y)}:_,$)}:b},nc={setTimeout:fg(c.setTimeout),setInterval:fg(c.setInterval)},mg=nc.setInterval;qr({global:!0,bind:!0,forced:c.setInterval!==mg},{setInterval:mg});var sy=nc.setTimeout;qr({global:!0,bind:!0,forced:c.setTimeout!==sy},{setTimeout:sy});var ti=nr.setTimeout;nr.JSON||(nr.JSON={stringify:JSON.stringify});var D1=function(w,$,A){return k(nr.JSON.stringify,null,arguments)},so=D1,ay=hs.map,cy=Ha("map");qr({target:"Array",proto:!0,forced:!cy},{map:function(w){return ay(this,w,arguments.length>1?arguments[1]:void 0)}});var uy=Ao("Array").map,np=Array.prototype,co=function(b){var w=b.map;return b===np||Lt(np,b)&&w===np.map?uy:w},gg=s(function(b){var w=Object.prototype.hasOwnProperty,$="~";function A(){}function _(Fe,Et,sr){this.fn=Fe,this.context=Et,this.once=sr||!1}function Y(Fe,Et,sr,fr,Sr){if(typeof sr!="function")throw new TypeError("The listener must be a function");var Tr=new _(sr,fr||Fe,Sr),Pr=$?$+Et:Et;return Fe._events[Pr]?Fe._events[Pr].fn?Fe._events[Pr]=[Fe._events[Pr],Tr]:Fe._events[Pr].push(Tr):(Fe._events[Pr]=Tr,Fe._eventsCount++),Fe}function de(Fe,Et){--Fe._eventsCount==0?Fe._events=new A:delete Fe._events[Et]}function V(){this._events=new A,this._eventsCount=0}Object.create&&(A.prototype=Object.create(null),new A().__proto__||($=!1)),V.prototype.eventNames=function(){var Et,sr,fr=[];if(this._eventsCount===0)return fr;for(sr in Et=this._events)w.call(Et,sr)&&fr.push($?sr.slice(1):sr);return Object.getOwnPropertySymbols?fr.concat(Object.getOwnPropertySymbols(Et)):fr},V.prototype.listeners=function(Et){var sr=$?$+Et:Et,fr=this._events[sr];if(!fr)return[];if(fr.fn)return[fr.fn];for(var Sr=0,Tr=fr.length,Pr=new Array(Tr);Sr<Tr;Sr++)Pr[Sr]=fr[Sr].fn;return Pr},V.prototype.listenerCount=function(Et){var sr=$?$+Et:Et,fr=this._events[sr];return fr?fr.fn?1:fr.length:0},V.prototype.emit=function(Et,sr,fr,Sr,Tr,Pr){var Lr=$?$+Et:Et;if(!this._events[Lr])return!1;var jr,Jr,Gr=this._events[Lr],Mn=arguments.length;if(Gr.fn){switch(Gr.once&&this.removeListener(Et,Gr.fn,void 0,!0),Mn){case 1:return Gr.fn.call(Gr.context),!0;case 2:return Gr.fn.call(Gr.context,sr),!0;case 3:return Gr.fn.call(Gr.context,sr,fr),!0;case 4:return Gr.fn.call(Gr.context,sr,fr,Sr),!0;case 5:return Gr.fn.call(Gr.context,sr,fr,Sr,Tr),!0;case 6:return Gr.fn.call(Gr.context,sr,fr,Sr,Tr,Pr),!0}for(Jr=1,jr=new Array(Mn-1);Jr<Mn;Jr++)jr[Jr-1]=arguments[Jr];Gr.fn.apply(Gr.context,jr)}else{var Qr,Vn=Gr.length;for(Jr=0;Jr<Vn;Jr++)switch(Gr[Jr].once&&this.removeListener(Et,Gr[Jr].fn,void 0,!0),Mn){case 1:Gr[Jr].fn.call(Gr[Jr].context);break;case 2:Gr[Jr].fn.call(Gr[Jr].context,sr);break;case 3:Gr[Jr].fn.call(Gr[Jr].context,sr,fr);break;case 4:Gr[Jr].fn.call(Gr[Jr].context,sr,fr,Sr);break;default:if(!jr)for(Qr=1,jr=new Array(Mn-1);Qr<Mn;Qr++)jr[Qr-1]=arguments[Qr];Gr[Jr].fn.apply(Gr[Jr].context,jr)}}return!0},V.prototype.on=function(Et,sr,fr){return Y(this,Et,sr,fr,!1)},V.prototype.once=function(Et,sr,fr){return Y(this,Et,sr,fr,!0)},V.prototype.removeListener=function(Et,sr,fr,Sr){var Tr=$?$+Et:Et;if(!this._events[Tr])return this;if(!sr)return de(this,Tr),this;var Pr=this._events[Tr];if(Pr.fn)Pr.fn!==sr||Sr&&!Pr.once||fr&&Pr.context!==fr||de(this,Tr);else{for(var Lr=0,jr=[],Jr=Pr.length;Lr<Jr;Lr++)(Pr[Lr].fn!==sr||Sr&&!Pr[Lr].once||fr&&Pr[Lr].context!==fr)&&jr.push(Pr[Lr]);jr.length?this._events[Tr]=jr.length===1?jr[0]:jr:de(this,Tr)}return this},V.prototype.removeAllListeners=function(Et){var sr;return Et?(sr=$?$+Et:Et,this._events[sr]&&de(this,sr)):(this._events=new A,this._eventsCount=0),this},V.prototype.off=V.prototype.removeListener,V.prototype.addListener=V.prototype.on,V.prefixed=$,V.EventEmitter=V,b.exports=V}),q1=Ru;function Ru(b){b=b||{},this.ms=b.min||100,this.max=b.max||1e4,this.factor=b.factor||2,this.jitter=b.jitter>0&&b.jitter<=1?b.jitter:0,this.attempts=0}Ru.prototype.duration=function(){var b=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var w=Math.random(),$=Math.floor(w*this.jitter*b);b=1&Math.floor(10*w)?b+$:b-$}return 0|Math.min(b,this.max)},Ru.prototype.reset=function(){this.attempts=0},Ru.prototype.setMin=function(b){this.ms=b},Ru.prototype.setMax=function(b){this.max=b},Ru.prototype.setJitter=function(b){this.jitter=b};var op=typeof e=="object"&&e&&e.Object===Object&&e,lo=typeof self=="object"&&self&&self.Object===Object&&self,Hs=op||lo||Function("return this")(),Ea=Hs.Symbol,au=Object.prototype,ly=au.hasOwnProperty,$1=au.toString,_s=Ea?Ea.toStringTag:void 0,Qs=function(w){var $=ly.call(w,_s),A=w[_s];try{w[_s]=void 0;var _=!0}catch{}var Y=$1.call(w);return _&&($?w[_s]=A:delete w[_s]),Y},dy=Object.prototype.toString,H1=function(w){return dy.call(w)},py=Ea?Ea.toStringTag:void 0,Js=function(w){return w==null?w===void 0?"[object Undefined]":"[object Null]":py&&py in Object(w)?Qs(w):H1(w)},ma=function(w){var $=typeof w;return w!=null&&($=="object"||$=="function")},ip=function(w){if(!ma(w))return!1;var $=Js(w);return $=="[object Function]"||$=="[object GeneratorFunction]"||$=="[object AsyncFunction]"||$=="[object Proxy]"},fy={deviceId:"",timeout:8e3},gy={account:"",appkey:"",token:"",debugLevel:"off",needReconnect:!0,reconnectionAttempts:ng,isAbtestEnable:!0,abtestUrl:"https://abt-online.netease.im/v1/api/abt/client/getExperimentInfo",abtestProjectKey:"imElite_sdk_abtest_web"},Sc=ul.includes,ga=u(function(){return!Array(1).includes()});qr({target:"Array",proto:!0,forced:ga},{includes:function(w){return Sc(this,w,arguments.length>1?arguments[1]:void 0)}});var sp=Ao("Array").includes,hy=Yn("match"),V1=TypeError,yy=function(b){if(function(w){var $;return xe(w)&&(($=w[hy])!==void 0?!!$:Oe(w)=="RegExp")}(b))throw V1("The method doesn't accept regular expressions");return b},z1=Yn("match"),W1=re("".indexOf);qr({target:"String",proto:!0,forced:!function(b){var w=/./;try{"/./"[b](w)}catch{try{return w[z1]=!1,"/./"[b](w)}catch{}}return!1}("includes")},{includes:function(w){return!!~W1(_i(pr(this)),_i(yy(w)),arguments.length>1?arguments[1]:void 0)}});var G1=Ao("String").includes,hg=Array.prototype,yg=String.prototype,ha=function(b){var w=b.includes;return b===hg||Lt(hg,b)&&w===hg.includes?sp:typeof b=="string"||b===yg||Lt(yg,b)&&w===yg.includes?G1:w},K1=hs.findIndex,Q1="findIndex",vy=!0;Q1 in[]&&Array(1).findIndex(function(){vy=!1}),qr({target:"Array",proto:!0,forced:vy},{findIndex:function(w){return K1(this,w,arguments.length>1?arguments[1]:void 0)}});var vg=Ao("Array").findIndex,dd=Array.prototype,Mc=function(b){var w=b.findIndex;return b===dd||Lt(dd,b)&&w===dd.findIndex?vg:w},J1=s(function(b){function w($){var A;return b.exports=w=Rs?Mo(A=Us).call(A):function(Y){return Y.__proto__||Us(Y)},b.exports.__esModule=!0,b.exports.default=b.exports,w($)}b.exports=w,b.exports.__esModule=!0,b.exports.default=b.exports}),Y1=ul.indexOf,ap=re([].indexOf),by=!!ap&&1/ap([1],1,-0)<0,bg=Ds("indexOf");qr({target:"Array",proto:!0,forced:by||!bg},{indexOf:function(w){var $=arguments.length>1?arguments[1]:void 0;return by?ap(this,w,$)||0:Y1(this,w,$)}});var X1=Ao("Array").indexOf,Tg=Array.prototype,ai=function(b){var w=b.indexOf;return b===Tg||Lt(Tg,b)&&w===Tg.indexOf?X1:w},Sg=s(function(b){b.exports=function($){var A;return ai(A=Function.toString.call($)).call(A,"[native code]")!==-1},b.exports.__esModule=!0,b.exports.default=b.exports}),Mg=dr("Reflect","construct"),Z1=Object.prototype,Ty=[].push,Cg=u(function(){function b(){}return!(Mg(function(){},[],b)instanceof b)}),kg=!u(function(){Mg(function(){})}),Pa=Cg||kg;qr({target:"Reflect",stat:!0,forced:Pa,sham:Pa},{construct:function(w,$){ru(w),Dn($);var A=arguments.length<3?w:ru(arguments[2]);if(kg&&!Cg)return Mg(w,$,A);if(w==A){switch($.length){case 0:return new w;case 1:return new w($[0]);case 2:return new w($[0],$[1]);case 3:return new w($[0],$[1],$[2]);case 4:return new w($[0],$[1],$[2],$[3])}var _=[null];return k(Ty,_,$),new(k(fl,w,_))}var Y=A.prototype,de=ki(xe(Y)?Y:Z1),V=k(w,de,$);return xe(V)?V:de}});var oc=nr.Reflect.construct,eT=s(function(b){b.exports=function(){if(typeof Reflect>"u"||!oc||oc.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(oc(Boolean,[],function(){})),!0}catch{return!1}},b.exports.__esModule=!0,b.exports.default=b.exports}),tT=s(function(b){function w($,A,_){var Y;return eT()?(b.exports=w=Mo(Y=oc).call(Y),b.exports.__esModule=!0,b.exports.default=b.exports):(b.exports=w=function(V,Fe,Et){var sr=[null];sr.push.apply(sr,Fe);var fr=new(Mo(Function).apply(V,sr));return Et&&gl(fr,Et.prototype),fr},b.exports.__esModule=!0,b.exports.default=b.exports),w.apply(null,arguments)}b.exports=w,b.exports.__esModule=!0,b.exports.default=b.exports}),ic=s(function(b){function w($){var A=typeof su=="function"?new su:void 0;return b.exports=w=function(Y){if(Y===null||!Sg(Y))return Y;if(typeof Y!="function")throw new TypeError("Super expression must either be null or a function");if(A!==void 0){if(A.has(Y))return A.get(Y);A.set(Y,de)}function de(){return tT(Y,arguments,J1(this).constructor)}return de.prototype=Qi(Y.prototype,{constructor:{value:de,enumerable:!1,writable:!0,configurable:!0}}),gl(de,Y)},b.exports.__esModule=!0,b.exports.default=b.exports,w($)}b.exports=w,b.exports.__esModule=!0,b.exports.default=b.exports}),uo=function(b){function w($,A,_){var Y;return A===void 0&&(A={}),_===void 0&&(_=400),(Y=b.call(this,$)||this).data=A,Y.code=_,Y.name="customError",Y}return Co(w,b),w}(r(ic)(Error)),cu=function(b){function w($,A,_){var Y;return A===void 0&&(A={}),(Y=b.call(this,$,A,414)||this).code=414,Y.name="validateError",Y.rules=_,Y}return Co(w,b),w}(uo),cp={200:null,406:null,808:null,810:null,201:"The client version is incorrect. You need to upgrade the SDK",302:"The user name or password is incorrect. Please check whether the appkey and token are valid and whether the account and token match",403:"Illegal operation or no permission",404:"Target object does not exist",405:"Parameter length too long",408:"Client request timed out",414:"Request parameter error",415:"Service unavailable",416:"Frequency control",417:"Repeat operation",422:"Account disabled",500:"Server internal error",503:"Server busy",508:"Expiration date",509:"Invalid",7101:"Be pulled black",700:"Partial failure of batch operation",801:"The number of people in the team has reached the upper limit",802:"No permission",803:"The team does not exist or has not changed",804:"The user is not in the team",805:"Team type mismatch",806:"The number of teams created has reached the limit",807:"Team member not valid",809:"Already in the team",811:"The number of accounts in the forced push list exceeds the limit",812:"The team is muted",813:"Due to the limited number of team, some pull people successfully",814:"Disable team message read service",815:"Maximum number of team administrators",816:"Batch operation partial failure",997:"The packet has expired",998:"Deserialize packet error",999:"Serialize packet error",9102:"Channel failure",9103:"This call has been answered / rejected at another end",10201:"Signaling: target NIM client is offline",10202:"Signaling: push is unreachable",10404:"Signaling: channel not exists",10405:"Signaling: channel already exists",10406:"Signaling: member of channel not exists",10407:"Signaling: member of channel already exists",10408:"Signaling: the invitation request does not exist or has expired",10409:"Signaling: the invitation request has been rejected",10410:"Signaling: the invitation request has been accepted",10414:"Signaling: request parameter error",10417:"Signaling: uid conflict",10419:"Signaling: the number of members of channel exceed the limit",10420:"Signaling: member is already in the channel on other client",10700:"Signaling: phased success",13002:"Abnormal chatroom status",13003:"In the blacklist",13004:"In the mute list",13006:"All members are muted, and only the administrator can speak"},xg=function(b){function w($,A,_,Y,de){var V;return _===void 0&&(_=""),Y===void 0&&(Y=new Date().getTime()),de===void 0&&(de={}),_=_||cp[$],(V=b.call(this,_,de,$)||this).name="cmdError",V.cmd=A,V.timetag=Y,V}return Co(w,b),w}(uo),Nu=function(b){function w($,A,_){var Y;return(Y=b.call(this,$,{},412)||this).code=412,Y.name="formatError",Y.key=A,Y.reason=_,Y}return Co(w,b),w}(uo),Cc=function(b){function w($,A,_,Y,de){var V;return(V=b.call(this,$,{file:de},400)||this).name="uploadError",V.rawError=A,V.curProvider=_||1,V.mixStorePolicy=Y,V}return Co(w,b),w}(uo),uu=["error","warn","log","debug"],pd=function(){},up=["off","error","warn","log","debug"],Sy=function(){function b($,A){this.name=A,this.strategies={debug:console.log,log:console.log,warn:console.warn,error:console.error},this.debug=pd,this.log=pd,this.warn=pd,this.error=pd,this.name=A,b.instancesName.push(A),ha(up).call(up,$)||($="off"),this.setLogFunc($)}var w=b.prototype;return w.setLogFunc=function(A){var _=this,Y=Mc(uu).call(uu,function(de){return de===A});kn(uu).call(uu,function(de,V){V<=Y&&(_[de]=function(){var Fe=fo(Array.prototype).call(arguments),Et=this.formatArgs(Fe,de);this.strategies[de](Et)})})},w.formatArgs=function(A,_){var Y=new Date,de=Y.getMonth()+1+"-"+Y.getDate()+" "+Y.getHours()+":"+Y.getMinutes()+":"+Y.getSeconds()+":"+Y.getMilliseconds();return"[NIM "+_+" "+this.name+" "+de+"] "+co(A).call(A,function(V){return V instanceof uo?V.name+", "+V.code+", "+V.message:V instanceof Error?V&&V.message?V.message:V:typeof V=="object"?so(V):V}).join(" ")},b}();Sy.instancesName=[],qr({global:!0},{globalThis:c});var rT=u(function(){ps(1)});qr({target:"Object",stat:!0,forced:rT},{keys:function(w){return ps(An(w))}});var Yo=nr.Object.keys,wg=hs.filter,ss=Ha("filter");qr({target:"Array",proto:!0,forced:!ss},{filter:function(w){return wg(this,w,arguments.length>1?arguments[1]:void 0)}});var nT=Ao("Array").filter,Fo=Array.prototype,Ys=function(b){var w=b.filter;return b===Fo||Lt(Fo,b)&&w===Fo.filter?nT:w},My=s(function(b,w){b.exports=function(){function $(Et,sr){if(!(Et instanceof sr))throw new TypeError("Cannot call a class as a function")}function A(Et,sr){for(var fr=0;fr<sr.length;fr++){var Sr=sr[fr];Sr.enumerable=Sr.enumerable||!1,Sr.configurable=!0,"value"in Sr&&(Sr.writable=!0),Qa(Et,Sr.key,Sr)}}function _(Et,sr,fr){return sr&&A(Et.prototype,sr),fr&&A(Et,fr),Qa(Et,"prototype",{writable:!1}),Et}var Y={reportUrl:"https://statistic.live.126.net/statics/report/common/form",maxSize:100,msgListMaxSize:1e3,cacheMaxSize:1e3,maxDelay:3e5,maxInterval:3e4,minInterval:1e4,timeout:5e3,autoStart:!0},de="https://statistic.live.126.net/dispatcher/req",V=function(){},Fe=function(){function Et(sr){$(this,Et),this.enable=!1,this.initConfigLoaded=!1,this.loading=!1,this.isDestroyed=!1,this.reportConfig=Y,this.msgList=[],this.traceMsgCache={},this.lowPriorityMsgList=[],this.cacheMsgList=[],this.lastReportTime=es(),this.timer=null,this.setConfig(sr),this.reportConfig.autoStart&&this.initUploadConfig()}return _(Et,[{key:"setConfig",value:function(fr){this.reportConfig=Xr({},this.reportConfig,fr)}},{key:"reportImmediately",value:function(fr,Sr){var Tr=this;this.reportConfig.request(fr,Xr({dataType:"json",method:"POST",timeout:this.reportConfig.timeout},Sr)).catch(function(Pr){var Lr,jr;(jr=(Lr=Tr.reportConfig)===null||Lr===void 0?void 0:Lr.logger)===null||jr===void 0||jr.warn("Reporter immediately upload failed",Pr)})}},{key:"report",value:function(fr,Sr){var Tr=arguments.length>2&&arguments[2]!==void 0&&arguments[2];if(fr){var Pr=es();Tr?this.lowPriorityMsgList.push({module:fr,msg:Sr,createTime:Pr}):this.msgList.push({module:fr,msg:Sr,createTime:Pr}),this.msgList.length>this.reportConfig.msgListMaxSize&&this.msgList.shift(),this.lowPriorityMsgList.length>this.reportConfig.msgListMaxSize&&this.lowPriorityMsgList.shift(),this.doReport()}}},{key:"reportTraceStart",value:function(fr,Sr){if(fr&&!this.traceMsgCache[fr]){var Tr=Xr(Xr({start_time:es()},Sr),{extension:[]});this.traceMsgCache[fr]=Tr}}},{key:"reportTraceUpdate",value:function(fr){}},{key:"reportTraceUpdateV2",value:function(fr,Sr){if(this.traceMsgCache[fr]){var Tr=this.traceMsgCache[fr].extension.length,Pr=new Date().getTime();Sr.duration=Tr===0?Pr-this.traceMsgCache[fr].start_time:Pr-this.traceMsgCache[fr].extension[Tr-1].end_time,this.traceMsgCache[fr].extension.push(Xr({end_time:Pr},Sr))}}},{key:"reportTraceEnd",value:function(fr){var Sr,Tr=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];this.traceMsgCache[fr]&&(fr!=="nos"||Tr===!1?(typeof Tr=="boolean"?this.traceMsgCache[fr].succeed=!!Tr:this.traceMsgCache[fr].state=Tr,this.traceMsgCache[fr].duration=es()-this.traceMsgCache[fr].start_time,kn(Sr=this.traceMsgCache[fr].extension).call(Sr,function(Pr){delete Pr.end_time}),this.report(fr,this.traceMsgCache[fr]),this.traceMsgCache[fr]=null):this.traceMsgCache[fr]=null)}},{key:"reportTraceCancel",value:function(fr){this.traceMsgCache[fr]=null}},{key:"pause",value:function(){this.enable=!1}},{key:"restore",value:function(){this.enable=!0,this.initConfigLoaded||this.initUploadConfig()}},{key:"destroy",value:function(){var fr,Sr=this;kn(fr=Yo(this.traceMsgCache)).call(fr,function(Tr){Sr.reportTraceEnd(Tr,1)}),this.timer!==null&&clearTimeout(this.timer),this.setConfig=V,this.report=V,this.reportTraceStart=V,this.reportTraceUpdate=V,this.reportTraceEnd=V,this.pause=V,this.restore=V,this.destroy=V,this.cacheMsgList=[],this.traceMsgCache={},this.lowPriorityMsgList=[],this.msgList=[],this.reportConfig={},this.isDestroyed=!0}},{key:"initUploadConfig",value:function(){var fr,Sr,Tr=this;if(!this.loading){this.loading=!0;var Pr=this.reportConfig.common||{};try{this.reportConfig.request(de,{method:"GET",dataType:"json",params:{deviceId:Pr.dev_id,sdkVer:Pr.sdk_ver,platform:Pr.platform,appkey:Pr.app_key},timeout:this.reportConfig.timeout}).then(function(Lr){var jr,Jr;if(!Tr.isDestroyed){if(Lr.status===200&&Lr.data&&Lr.data.code===200){var Gr=Lr.data.data||{};Tr.reportConfig.maxSize=Gr.maxSize>1e3?1e3:Gr.maxSize,Tr.reportConfig.maxInterval=Gr.maxInterval>1e4?1e4:Gr.maxInterval,Tr.reportConfig.maxInterval=Gr.maxInterval<10?10:Gr.maxInterval,Tr.reportConfig.minInterval=Gr.minInterval<2?2:Gr.minInterval,Tr.reportConfig.maxDelay=Gr.maxDelay||300,Tr.reportConfig.maxInterval=1e3*Tr.reportConfig.maxInterval,Tr.reportConfig.minInterval=1e3*Tr.reportConfig.minInterval,Tr.reportConfig.maxDelay=1e3*Tr.reportConfig.maxDelay,Tr.enable=!0,Tr.initConfigLoaded=!0,Tr.loading=!1,Tr.reportHeartBeat()}(Jr=(jr=Tr.reportConfig)===null||jr===void 0?void 0:jr.logger)===null||Jr===void 0||Jr.log("Get reporter upload config success")}}).catch(function(Lr){var jr,Jr;Tr.loading=!1,(Jr=(jr=Tr.reportConfig)===null||jr===void 0?void 0:jr.logger)===null||Jr===void 0||Jr.error("Get reporter upload config failed",Lr)})}catch(Lr){this.loading=!1,(Sr=(fr=this.reportConfig)===null||fr===void 0?void 0:fr.logger)===null||Sr===void 0||Sr.error("Exec reporter request failed",Lr)}}}},{key:"reportHeartBeat",value:function(){var fr=this;this.isDestroyed||(this.timer=ti(function(){fr.reportHeartBeat()},this.reportConfig.minInterval),this.doReport())}},{key:"doReport",value:function(){if(!this.isDestroyed){var fr=this.msgList.length+this.lowPriorityMsgList.length+this.cacheMsgList.length>2*this.reportConfig.maxSize?this.reportConfig.minInterval:this.reportConfig.maxInterval;es()-this.lastReportTime>=fr&&this.upload()}}},{key:"getUploadMsg",value:function(){var fr,Sr,Tr,Pr,Lr,jr=this,Jr={},Gr=es();this.msgList=Ys(fr=this.msgList).call(fr,function(Cn){return Gr-Cn.createTime<jr.reportConfig.maxDelay}),this.lowPriorityMsgList=Ys(Sr=this.lowPriorityMsgList).call(Sr,function(Cn){return Gr-Cn.createTime<jr.reportConfig.maxDelay}),this.cacheMsgList=Ys(Tr=this.cacheMsgList).call(Tr,function(Cn){return Gr-Cn.createTime<jr.reportConfig.maxDelay});var Mn=fo(Pr=this.msgList).call(Pr,0,this.reportConfig.maxSize);if(this.msgList=fo(Lr=this.msgList).call(Lr,Mn.length),Mn.length<this.reportConfig.maxSize){var Qr,Vn,Bn=this.reportConfig.maxSize-Mn.length;Mn=$s(Mn).call(Mn,fo(Qr=this.lowPriorityMsgList).call(Qr,0,Bn)),this.lowPriorityMsgList=fo(Vn=this.lowPriorityMsgList).call(Vn,Bn)}if(Mn.length<this.reportConfig.maxSize){var Eo,jn,wr=this.reportConfig.maxSize-Mn.length;Mn=$s(Mn).call(Mn,fo(Eo=this.cacheMsgList).call(Eo,0,wr)),this.cacheMsgList=fo(jn=this.cacheMsgList).call(jn,wr)}return kn(Mn).call(Mn,function(Cn){Jr[Cn.module]?Jr[Cn.module].push(Cn.msg):Jr[Cn.module]=[Cn.msg]}),{uploadMsgArr:Mn,uploadMsg:Jr}}},{key:"upload",value:function(){var fr,Sr,Tr=this;if(this.enable&&!(this.lastReportTime&&es()-this.lastReportTime<this.reportConfig.minInterval)){var Pr=this.getUploadMsg(),Lr=Pr.uploadMsgArr,jr=Pr.uploadMsg;if(Lr.length){this.lastReportTime=es();try{this.reportConfig.request(this.reportConfig.reportUrl,{dataType:"json",method:"POST",data:{common:this.reportConfig.common,event:jr},headers:{sdktype:"im"},timeout:this.reportConfig.timeout}).catch(function(Jr){var Gr,Mn,Qr,Vn;Tr.cacheMsgList=fo(Gr=$s(Mn=Tr.cacheMsgList).call(Mn,Lr)).call(Gr,0,Tr.reportConfig.cacheMaxSize),(Vn=(Qr=Tr.reportConfig)===null||Qr===void 0?void 0:Qr.logger)===null||Vn===void 0||Vn.warn("Reporter upload failed",Jr)})}catch(Jr){(Sr=(fr=this.reportConfig)===null||fr===void 0?void 0:fr.logger)===null||Sr===void 0||Sr.warn("Exec reporter request failed",Jr)}clearTimeout(this.timer),this.reportHeartBeat()}}}}]),Et}();return Fe}()}),Ko={setLogger:function(w){throw new Error("Function not implemented.")},platform:"",WebSocket:function(){function b($,A){throw this.CONNECTING=0,this.OPEN=1,this.CLOSING=2,this.CLOSED=3,new Error("Method not implemented.")}var w=b.prototype;return w.close=function(A,_){throw new Error("Method not implemented.")},w.send=function(A){throw new Error("Method not implemented.")},w.onclose=function(A){throw new Error("Method not implemented.")},w.onerror=function(A){throw new Error("Method not implemented.")},w.onmessage=function(A){throw new Error("Method not implemented.")},w.onopen=function(A){throw new Error("Method not implemented.")},b}(),localStorage:{},request:function(w,$){throw new Error("Function not implemented.")},uploadFile:function(w){throw new Error("Function not implemented.")},getSystemInfo:function(){throw new Error("Function not implemented.")}},oT=TypeError,Cy=function(b){return function(w,$,A,_){Or($);var Y=An(w),de=er(Y),V=Ci(Y),Fe=b?V-1:0,Et=b?-1:1;if(A<2)for(;;){if(Fe in de){_=de[Fe],Fe+=Et;break}if(Fe+=Et,b?Fe<0:V<=Fe)throw oT("Reduce of empty array with no initial value")}for(;b?Fe>=0:V>Fe;Fe+=Et)Fe in de&&(_=$(_,de[Fe],Fe,Y));return _}},Ig={left:Cy(!1),right:Cy(!0)}.left,lp=Ds("reduce");qr({target:"Array",proto:!0,forced:!lp||!Li&&gr>79&&gr<83},{reduce:function(w){var $=arguments.length;return Ig(this,w,$,$>1?arguments[1]:void 0)}});var ky=Ao("Array").reduce,Fu=Array.prototype,kc=function(b){var w=b.reduce;return b===Fu||Lt(Fu,b)&&w===Fu.reduce?ky:w},xy=function(w){return w===void 0},fd={},Aa={};function Ui(b,w){var $,A,_;try{_=JSON.parse(b)}catch(Tr){throw w.error("Parse command error: ",b),Tr}var Y=_.sid+"_"+_.cid,de=_.r;if(ha($=["4_1","4_2","4_10","4_11"]).call($,Y)){var V=_.r[1].headerPacket;Y=V.sid+"_"+V.cid,de=_.r[1].body}var Fe,Et=Aa[Y],sr=fd[Et],fr=function(Pr,Lr){var jr=cp[Pr];return jr===null?null:new xg(Pr,Lr,jr,new Date().getTime())}(_.code,Et),Sr={cmd:Et,raw:_,error:fr,service:sr==null?void 0:sr.service,content:{}};if(Sr.error){if(Sr.error.cmd=Et,Sr.error.callFunc="parseCmd",!(!((A=sr==null?void 0:sr.ignoreErrCodes)===null||A===void 0)&&ha(A).call(A,_.code)))return Sr;w.warn("parseCmd:: ignore error ",Sr.error),Sr.error.ignore=!0}return!Et||!sr?(Sr.notFound=!0,Sr):(sr.response&&kn(Fe=sr.response).call(Fe,function(Tr,Pr){var Lr=de[Pr],jr=Tr.type,Jr=Tr.name,Gr=Tr.reflectMapper;if(!xy(Lr))switch(jr){case"Property":Sr.content[Jr]=Gr?Ei(Lr,Gr):Lr;break;case"PropertyArray":Sr.content[Jr]=co(Lr).call(Lr,function(Mn){return Gr?Ei(Mn,Gr):Mn});break;case"long":case"Long":case"byte":case"Byte":case"Number":Sr.content[Jr]=+Lr;break;default:Sr.content[Jr]=Lr}}),Sr)}function ts(b,w){var $={};for(var A in b)w[A]!==void 0&&($[w[A]]=b[A]);return $}function Ei(b,w){var $={};for(var A in b)w[A]!==void 0&&($[w[A]]=b[A]);return $}function Oa(b){fd=Xr(fd,b.cmdConfig),Aa=Xr(Aa,b.cmdMap)}function xc(b){var w;return kc(w=Yo(b)).call(w,function($,A){var _,Y=b[A];return $[A]=kc(_=Yo(Y)).call(_,function(de,V){return de[Y[V]]=V,de},{}),$},{})}var _g=["disconnect","connect","heartbeat","message","json","event","ack","error","noop"],Eg=["transport not supported","client not handshaken","unauthorized"],dp=["reconnect"],iT=function(b){function w(A,_,Y){var de;return(de=b.call(this)||this).url=_,de.logger=Y,de.websocket=null,de.core=A,de.url=_,de.status="disconnected",de.logger=Y,de.connect(),de}Co(w,b);var $=w.prototype;return $.connect=function(){var _=this;this.status!=="connecting"&&this.status!=="connected"?(this.status="connecting",this.core.adapters.request("https://"+this.url+"/socket.io/1/?t="+es(),{method:"GET",dataType:"text",timeout:8e3}).then(function(Y){var de=Y.data.split(":"),V=de[0],Fe=de[1];return _.sessionId=V,_.closeTimeout=1e3*Fe,_._createWebsocket("wss://"+_.url+"/socket.io/1/websocket/"+V)}).catch(function(Y){_.logger.error("imsocket::handshake fail. ",Y&&Y.message),_.status="disconnected",_.emit("handshakeFailed")})):this.logger.warn("imsocket::socket is connecting or connected",this.status)},$.close=function(){if(this.websocket){this.logger.log("imsocket:: close websocket");try{this.websocket.send(this.encodePacket({type:"disconnect"})),this.websocket.close()}catch(_){this.logger.warn("attempt to close websocket error",_)}this.clean()}},$.clean=function(){this.status="disconnected",this.websocket&&(this.websocket.onmessage=null,this.websocket.onopen=null,this.websocket.onerror=null,this.websocket.onclose=null,this.websocket=null,this.emit("disconnect"))},$.onConnect=function(){this.status="connected",this.resetCloseTimer(),this.emit("connect")},$._createWebsocket=function(_){var Y,de=this;this.websocket=new Ko.WebSocket(_),this.websocket.onmessage=Mo(Y=this.onMessage).call(Y,this),this.websocket.onclose=function(){de.logger.log("imsocket:: receive websocket onclose event, current status",de.status),de.clean()},this.websocket.onerror=function(V){de.logger.error("imsocket:: onerror",V)}},$.onMessage=function(_){var Y;this.resetCloseTimer();var de=this.decodePacket(_.data);if(de)switch(de.type){case"connect":this.onConnect();break;case"disconnect":this.close();break;case"message":case"json":this.emit("message",de.data);break;case"event":de.name&&this.emit(de.name,de.args);break;case"error":de.reason==="unauthorized"?this.emit("connect_failed",de.reason):this.emit("error",de.reason);break;case"heartbeat":(Y=this.websocket)===null||Y===void 0||Y.send(this.encodePacket({type:"heartbeat"}));break;default:this.logger.warn("imsocket::no handler type",de.type)}},$.encodePacket=function(_){var Y,de,V=_.type,Fe=_.id,Et=Fe===void 0?"":Fe,sr=_.endpoint,fr=sr===void 0?"":sr,Sr=_.ack,Tr=null;if(!V)return"";switch(V){case"error":Y=_.reason?ai(Eg).call(Eg,_.reason):"",de=_.advice?ai(dp).call(dp,_.advice):"",Y===""&&de===""||(Tr=Y+(de!==""?"+"+de:""));break;case"message":_.data!==""&&(Tr=_.data);break;case"event":Y={name:_.name},Y=_.args&&_.args.length?{name:_.name,args:_.args}:{name:_.name},Tr=so(Y);break;case"json":Tr=so(_.data);break;case"connect":_.qs&&(Tr=_.qs);break;case"ack":Tr=_.ackId+(_.args&&_.args.length?"+"+so(_.args):"")}var Pr=[ai(_g).call(_g,V),Et+(Sr==="data"?"+":""),fr];return Tr!=null&&Pr.push(Tr),Pr.join(":")},$.decodePacket=function(_){if(_)if(_.charAt(0)!="�"){var Y=_.match(/([^:]+):([0-9]+)?(\+)?:([^:]+)?:?([\s\S]*)?/);if(Y){var de,V=Y[1],Fe=Y[2],Et=Y[3],sr=Y[4],fr=Y[5],Sr={type:_g[+V],endpoint:sr};switch(Fe&&(Sr.id=Fe,Sr.ack=!Et||"data"),Sr.type){case"error":de=fr.split("+"),Sr.reason=Eg[+de[0]]||"";break;case"message":Sr.data=fr||"";break;case"connect":Sr.qs=fr||"";break;case"event":try{var Tr=JSON.parse(fr);Sr.name=Tr.name,Sr.args=Tr.args}catch(Pr){this.logger.error("imsocket::parseData::type::event error",Pr)}Sr.args=Sr.args||[];break;case"json":try{Sr.data=JSON.parse(fr)}catch(Pr){this.logger.error("imsocket::parseData::type::json error",Pr)}break;case"ack":if((de=fr.match(/^([0-9]+)(\+)?(.*)/))&&(Sr.ackId=de[1],Sr.args=[],de[3]))try{Sr.args=de[3]?JSON.parse(de[3]):[]}catch(Pr){this.logger.error("imsocket::parseData::type::ack error",Pr)}}return Sr}}else this.logger.error("imsocket::unrecognize dataStr",fo(_).call(_,0,20))},$.send=function(_){var Y,de={data:_,type:"message",endpoint:""};(Y=this.websocket)===null||Y===void 0||Y.send(this.encodePacket(de))},$.resetCloseTimer=function(){var _=this;this.closeTimeout&&(clearTimeout(this.closeTimer),this.closeTimer=ti(function(){_.close()},this.closeTimeout))},w}(gg),pp=Ao("Array").values,ya=Array.prototype,sT={DOMTokenList:!0,NodeList:!0},fp=function(b){var w=b.values;return b===ya||Lt(ya,b)&&w===ya.values||Nn(sT,Fs(b))?pp:w};qr({target:"Array",stat:!0},{isArray:Ji});var rs=nr.Array.isArray,Pg=hs.every,aT=Ds("every");qr({target:"Array",proto:!0,forced:!aT},{every:function(w){return Pg(this,w,arguments.length>1?arguments[1]:void 0)}});var va=Ao("Array").every,Ag=Array.prototype,ju=function(b){var w=b.every;return b===Ag||Lt(Ag,b)&&w===Ag.every?va:w},as=function(w){return w!=null&&typeof w=="object"},wy=function(w){return as(w)&&Js(w)=="[object RegExp]"},Og=function(w){return function($){return w($)}},Bu=s(function(b,w){var $=w&&!w.nodeType&&w,A=$&&b&&!b.nodeType&&b,_=A&&A.exports===$&&op.process,Y=function(){try{var de=A&&A.require&&A.require("util").types;return de||_&&_.binding&&_.binding("util")}catch{}}();b.exports=Y}),Rg=Bu&&Bu.isRegExp,cT=Rg?Og(Rg):wy,Ng=Hs["__core-js_shared__"],wc=function(){var b=/[^.]+$/.exec(Ng&&Ng.keys&&Ng.keys.IE_PROTO||"");return b?"Symbol(src)_1."+b:""}(),uT=function(w){return!!wc&&wc in w},lT=Function.prototype.toString,lu=function(w){if(w!=null){try{return lT.call(w)}catch{}try{return w+""}catch{}}return""},dT=/^\[object .+?Constructor\]$/,pT=Function.prototype,fT=Object.prototype,mT=pT.toString,gT=fT.hasOwnProperty,du=RegExp("^"+mT.call(gT).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),md=function(w){return!(!ma(w)||uT(w))&&(ip(w)?du:dT).test(lu(w))},hT=function(w,$){return w==null?void 0:w[$]},pu=function(w,$){var A=hT(w,$);return md(A)?A:void 0},gd=pu(Object,"create"),yT=function(){this.__data__=gd?gd(null):{},this.size=0},vT=function(w){var $=this.has(w)&&delete this.__data__[w];return this.size-=$?1:0,$},bT=Object.prototype.hasOwnProperty,TT=function(w){var $=this.__data__;if(gd){var A=$[w];return A==="__lodash_hash_undefined__"?void 0:A}return bT.call($,w)?$[w]:void 0},Lu=Object.prototype.hasOwnProperty,Iy=function(w){var $=this.__data__;return gd?$[w]!==void 0:Lu.call($,w)},ST=function(w,$){var A=this.__data__;return this.size+=this.has(w)?0:1,A[w]=gd&&$===void 0?"__lodash_hash_undefined__":$,this};function sc(b){var w=-1,$=b==null?0:b.length;for(this.clear();++w<$;){var A=b[w];this.set(A[0],A[1])}}sc.prototype.clear=yT,sc.prototype.delete=vT,sc.prototype.get=TT,sc.prototype.has=Iy,sc.prototype.set=ST;var hd=sc,MT=function(){this.__data__=[],this.size=0},mp=function(w,$){return w===$||w!=w&&$!=$},gp=function(w,$){for(var A=w.length;A--;)if(mp(w[A][0],$))return A;return-1},CT=Array.prototype.splice,kT=function(w){var $=this.__data__,A=gp($,w);return!(A<0)&&(A==$.length-1?$.pop():CT.call($,A,1),--this.size,!0)},Uu=function(w){var $=this.__data__,A=gp($,w);return A<0?void 0:$[A][1]},hp=function(w){return gp(this.__data__,w)>-1},yd=function(w,$){var A=this.__data__,_=gp(A,w);return _<0?(++this.size,A.push([w,$])):A[_][1]=$,this};function Du(b){var w=-1,$=b==null?0:b.length;for(this.clear();++w<$;){var A=b[w];this.set(A[0],A[1])}}Du.prototype.clear=MT,Du.prototype.delete=kT,Du.prototype.get=Uu,Du.prototype.has=hp,Du.prototype.set=yd;var yp=Du,Ic=pu(Hs,"Map"),xT=function(){this.size=0,this.__data__={hash:new hd,map:new(Ic||yp),string:new hd}},wT=function(w){var $=typeof w;return $=="string"||$=="number"||$=="symbol"||$=="boolean"?w!=="__proto__":w===null},vp=function(w,$){var A=w.__data__;return wT($)?A[typeof $=="string"?"string":"hash"]:A.map},IT=function(w){var $=vp(this,w).delete(w);return this.size-=$?1:0,$},qu=function(w){return vp(this,w).get(w)},bp=function(w){return vp(this,w).has(w)},_T=function(w,$){var A=vp(this,w),_=A.size;return A.set(w,$),this.size+=A.size==_?0:1,this};function $u(b){var w=-1,$=b==null?0:b.length;for(this.clear();++w<$;){var A=b[w];this.set(A[0],A[1])}}$u.prototype.clear=xT,$u.prototype.delete=IT,$u.prototype.get=qu,$u.prototype.has=bp,$u.prototype.set=_T;var fu=$u,Fg=function(w){return this.__data__.set(w,"__lodash_hash_undefined__"),this},_y=function(w){return this.__data__.has(w)};function Tp(b){var w=-1,$=b==null?0:b.length;for(this.__data__=new fu;++w<$;)this.add(b[w])}Tp.prototype.add=Tp.prototype.push=Fg,Tp.prototype.has=_y;var jg=Tp,ET=function(w,$,A,_){for(var Y=w.length,de=A+(_?1:-1);_?de--:++de<Y;)if($(w[de],de,w))return de;return-1},Ey=function(w){return w!=w},Py=function(w,$,A){for(var _=A-1,Y=w.length;++_<Y;)if(w[_]===$)return _;return-1},Bg=function(w,$,A){return $==$?Py(w,$,A):ET(w,Ey,A)},Sp=function(w,$){return!!(w!=null&&w.length)&&Bg(w,$,0)>-1},Ay=function(w,$,A){for(var _=-1,Y=w==null?0:w.length;++_<Y;)if(A($,w[_]))return!0;return!1},Hu=function(w,$){for(var A=-1,_=w==null?0:w.length,Y=Array(_);++A<_;)Y[A]=$(w[A],A,w);return Y},Lg=function(w,$){return w.has($)},Ug=function(w,$,A,_){var Y=-1,de=Sp,V=!0,Fe=w.length,Et=[],sr=$.length;if(!Fe)return Et;A&&($=Hu($,Og(A))),_?(de=Ay,V=!1):$.length>=200&&(de=Lg,V=!1,$=new jg($));e:for(;++Y<Fe;){var fr=w[Y],Sr=A==null?fr:A(fr);if(fr=_||fr!==0?fr:0,V&&Sr==Sr){for(var Tr=sr;Tr--;)if($[Tr]===Sr)continue e;Et.push(fr)}else de($,Sr,_)||Et.push(fr)}return Et},Mp=function(w){return w},Oy=function(w,$,A){switch(A.length){case 0:return w.call($);case 1:return w.call($,A[0]);case 2:return w.call($,A[0],A[1]);case 3:return w.call($,A[0],A[1],A[2])}return w.apply($,A)},vd=Math.max,Ry=function(w,$,A){return $=vd($===void 0?w.length-1:$,0),function(){for(var _=arguments,Y=-1,de=vd(_.length-$,0),V=Array(de);++Y<de;)V[Y]=_[$+Y];Y=-1;for(var Fe=Array($+1);++Y<$;)Fe[Y]=_[Y];return Fe[$]=A(V),Oy(w,this,Fe)}},PT=function(w){return function(){return w}},Cp=function(){try{var b=pu(Object,"defineProperty");return b({},"",{}),b}catch{}}(),Ny=Cp?function(b,w){return Cp(b,"toString",{configurable:!0,enumerable:!1,value:PT(w),writable:!0})}:Mp,Dg=Date.now,kp=function(w){var $=0,A=0;return function(){var _=Dg(),Y=16-(_-A);if(A=_,Y>0){if(++$>=800)return arguments[0]}else $=0;return w.apply(void 0,arguments)}},Fy=kp(Ny),jy=function(w,$){return Fy(Ry(w,$,Mp),w+"")},qg=function(w){return typeof w=="number"&&w>-1&&w%1==0&&w<=9007199254740991},xp=function(w){return w!=null&&qg(w.length)&&!ip(w)},xn=function(w){return as(w)&&xp(w)},AT=jy(function(b,w){return xn(b)?Ug(b,w):[]}),Vu=AT;function OT(b,w){return w instanceof RegExp?"__REGEXP "+w.toString():w}function zr(b,w,$){var A;w===void 0&&(w={});var _={};return kn(A=Yo(b)).call(A,function(Y){var de=b[Y].type,V=$?"In "+$+", ":"";if(w[Y]===void 0){if(b[Y].required===!1)return void(_[Y]=w[Y]);throw new cu(V+'param "'+Y+'" is required',{key:Y},"required")}var Fe=RT[de];if(Fe&&!Fe(w,Y,b[Y]))throw new cu(V+'param "'+Y+'" expects '+so(b[Y],OT),{key:Y,value:w[Y]},so(b[Y]));_[Y]=w[Y]}),_}var RT={string:function(w,$,A){var _=A.allowEmpty,Y=A.max,de=A.min,V=A.regExp,Fe=w[$];return typeof Fe=="string"&&(_!==!1||Fe!=="")&&!(typeof Y=="number"&&Fe.length>Y)&&!(typeof de=="number"&&Fe.length<de)&&!(cT(V)&&!V.test(Fe))},number:function(w,$,A){var _=A.min,Y=A.max,de=w[$];return typeof de=="number"&&!(typeof _=="number"&&de<_)&&!(typeof Y=="number"&&de>Y)},boolean:function(w,$){return typeof w[$]=="boolean"},enum:function(w,$,A){var _=fp(A),Y=w[$];return!_||ai(_).call(_,Y)>-1},array:function(w,$,A){var _,Y=A.itemType,de=A.rules,V=A.min,Fe=A.max,Et=fp(A),sr=w[$];return!!rs(sr)&&!(typeof Fe=="number"&&sr.length>Fe)&&!(typeof V=="number"&&sr.length<V)&&!(Y&&Y!=="enum"&&!ju(sr).call(sr,function(fr){return typeof fr===Y}))&&(Y!=="enum"||!Et||!Vu.apply(void 0,$s(_=[sr]).call(_,Et)).length)&&(de&&kn(sr).call(sr,function(fr,Sr){return zr(de,fr,$+"["+Sr+"]")}),!0)},object:function(w,$,A){var _=A.rules,Y=w[$];return _&&zr(_,Y,$),!0}},zu=pu(Hs,"Set"),NT=function(){},wp=function(w){var $=-1,A=Array(w.size);return w.forEach(function(_){A[++$]=_}),A},$g=zu&&1/wp(new zu([,-0]))[1]==1/0?function(b){return new zu(b)}:NT,By=$g,Ip=function(w,$,A){var _=-1,Y=Sp,de=w.length,V=!0,Fe=[],Et=Fe;if(A)V=!1,Y=Ay;else if(de>=200){var sr=$?null:By(w);if(sr)return wp(sr);V=!1,Y=Lg,Et=new jg}else Et=$?[]:Fe;e:for(;++_<de;){var fr=w[_],Sr=$?$(fr):fr;if(fr=A||fr!==0?fr:0,V&&Sr==Sr){for(var Tr=Et.length;Tr--;)if(Et[Tr]===Sr)continue e;$&&Et.push(Sr),Fe.push(fr)}else Y(Et,Sr,A)||(Et!==Fe&&Et.push(Sr),Fe.push(fr))}return Fe},FT=function(w){return w&&w.length?Ip(w):[]},Hg=`	
\v\f\r                　\u2028\u2029\uFEFF`,_p=re("".replace),Ep="["+Hg+"]",bd=RegExp("^"+Ep+Ep+"*"),Ly=RegExp(Ep+Ep+"*$"),Pp=function(b){return function(w){var $=_i(pr(w));return 1&b&&($=_p($,bd,"")),2&b&&($=_p($,Ly,"")),$}},Uy={start:Pp(1),end:Pp(2),trim:Pp(3)}.trim,Td=c.parseInt,Vg=c.Symbol,Ra=Vg&&Vg.iterator,go=/^[+-]?0x/i,Ap=re(go.exec),ba=Td(Hg+"08")!==8||Td(Hg+"0x16")!==22||Ra&&!u(function(){Td(Object(Ra))})?function(w,$){var A=Uy(_i(w));return Td(A,$>>>0||(Ap(go,A)?16:10))}:Td;qr({global:!0,forced:parseInt!=ba},{parseInt:ba});var Na,wo=nr.parseInt,zg=(Na=function(){return(65536*(1+Math.random())|0).toString(16).substring(1)},function(){return Na()+Na()+Na()+Na()+Na()+Na()+Na()+Na()});function ri(b){var w;return Ys(w=Yo(b)).call(w,function($){return!(+$>=0)})}function Dy(b,w){var $,A=Ys($=Yo(b)).call($,function(_){return b[_]==w});return A.length>0?A[0]:void 0}var jT=TypeError,Op=Object.getOwnPropertyDescriptor,BT=oe&&!function(){if(this!==void 0)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(b){return b instanceof TypeError}}()?function(b,w){if(Ji(b)&&!Op(b,"length").writable)throw jT("Cannot set read only .length");return b.length=w}:function(b,w){return b.length=w},LT=TypeError,Rp=function(b,w){if(!delete b[w])throw LT("Cannot delete property "+Fr(w)+" of "+Fr(b))},UT=Ha("splice"),Wg=Math.max,Gg=Math.min;qr({target:"Array",proto:!0,forced:!UT},{splice:function(w,$){var A,_,Y,de,V,Fe,Et=An(this),sr=Ci(Et),fr=oa(w,sr),Sr=arguments.length;for(Sr===0?A=_=0:Sr===1?(A=0,_=sr-fr):(A=Sr-2,_=Gg(Wg(Da($),0),sr-fr)),hl(sr+A-_),Y=bl(Et,_),de=0;de<_;de++)(V=fr+de)in Et&&Ns(Y,de,Et[V]);if(Y.length=_,A<_){for(de=fr;de<sr-_;de++)Fe=de+A,(V=de+_)in Et?Et[Fe]=Et[V]:Rp(Et,Fe);for(de=sr;de>sr-_+A;de--)Rp(Et,de-1)}else if(A>_)for(de=sr-_;de>fr;de--)Fe=de+A-1,(V=de+_-1)in Et?Et[Fe]=Et[V]:Rp(Et,Fe);for(de=0;de<A;de++)Et[de+fr]=arguments[de+2];return BT(Et,sr-_+A),Y}});var DT=Ao("Array").splice,Np=Array.prototype,qy=function(b){var w=b.splice;return b===Np||Lt(Np,b)&&w===Np.splice?DT:w},Fp=function(b,w,$,A){try{return A?w(Dn($)[0],$[1]):w($)}catch(_){Ll(b,"throw",_)}},Sd=Array,$y=!Zm(function(b){Array.from(b)});qr({target:"Array",stat:!0,forced:$y},{from:function(w){var $=An(w),A=Vc(this),_=arguments.length,Y=_>1?arguments[1]:void 0,de=Y!==void 0;de&&(Y=_o(Y,_>2?arguments[2]:void 0));var V,Fe,Et,sr,fr,Sr,Tr=Zc($),Pr=0;if(!Tr||this===Sd&&vm(Tr))for(V=Ci($),Fe=A?new this(V):Sd(V);V>Pr;Pr++)Sr=de?Y($[Pr],Pr):$[Pr],Ns(Fe,Pr,Sr);else for(fr=(sr=Ja($,Tr)).next,Fe=A?new this:[];!(Et=Ie(fr,sr)).done;Pr++)Sr=de?Fp(sr,Y,[Et.value,Pr],!0):Et.value,Ns(Fe,Pr,Sr);return Fe.length=Pr,Fe}});var _c=nr.Array.from,Di=Zc;function Hy(b,w){var $,A=li!==void 0&&Di(b)||b["@@iterator"];if(A)return Mo($=(A=A.call(b)).next).call($,A);if(rs(b)||(A=function(de,V){var Fe;if(de){if(typeof de=="string")return Vy(de,V);var Et=fo(Fe=Object.prototype.toString.call(de)).call(Fe,8,-1);if(Et==="Object"&&de.constructor&&(Et=de.constructor.name),Et==="Map"||Et==="Set")return _c(de);if(Et==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(Et))return Vy(de,V)}}(b))||w&&b&&typeof b.length=="number"){A&&(b=A);var _=0;return function(){return _>=b.length?{done:!0}:{done:!1,value:b[_++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Vy(b,w){(w==null||w>b.length)&&(w=b.length);for(var $=0,A=new Array(w);$<w;$++)A[$]=b[$];return A}var cs,zy=function(){function b(){this.timerList=[],this.id=0,this.timer=null,this.timeout=0}var w=b.prototype;return w.addTimer=function(A,_,Y){_===void 0&&(_=0),Y===void 0&&(Y=1);var de=new Date().getTime(),V=this.id;return this.timerList.push({id:V,loop:Y,count:0,timeout:de+_,interval:_,callback:A}),this.id++,this.checkTimer(de),V},w.checkTimer=function(A){if(A===void 0&&(A=new Date().getTime()),this.removeFinished(),this.timerList.length!==0||this.timer==null){for(var _,Y,de=0,V=Hy(this.timerList);!(_=V()).done;){var Fe=_.value;(de===0||de>Fe.timeout)&&(de=Fe.timeout)}this.timerList.length!==0&&(this.timer===null||de<this.timeout||this.timeout<A)&&(this.timer=ti(Mo(Y=this.nowTime).call(Y,this),de-A),this.timeout=de)}},w.nowTime=function(){for(var A,_=new Date().getTime(),Y=Hy(this.timerList);!(A=Y()).done;){var de=A.value;_>=de.timeout&&(de.callback(),de.count++,de.timeout=_+de.interval)}this.clerTime(),this.checkTimer(_)},w.clerTime=function(){this.timer!==null&&(clearTimeout(this.timer),this.timer=null)},w.deleteTimer=function(A){for(var _=this.timerList.length-1;_>=0;_--){var Y;this.timerList[_].id===A&&qy(Y=this.timerList).call(Y,_,1)}},w.removeFinished=function(){for(var A=this.timerList.length-1;A>=0;A--){var _,Y=this.timerList[A];Y.loop>=0&&Y.count>=Y.loop&&qy(_=this.timerList).call(_,A,1)}},w.destroy=function(){this.clerTime(),this.timerList=[],this.id=0,this.timer=null},b}(),Wy=function(){function b($){this.core=$}var w=b.prototype;return w.request=function(A,_){var Y=this,de=new Date().getTime();return Ko.request(A,_).catch(function(V){var Fe,Et,sr=V;throw Y.core.reporter.reportTraceStart("exceptions",{user_id:Y.core.options.account,trace_id:(Et=(Fe=Y.core)===null||Fe===void 0?void 0:Fe.socket)===null||Et===void 0?void 0:Et.sessionId,start_time:de,action:1}),Y.core.reporter.reportTraceUpdateV2("exceptions",{code:typeof sr.code=="number"?sr.code:0,description:sr.message||""+sr.code,operation_type:0,target:A,context:_?so(_):""}),Y.core.reporter.reportTraceEnd("exceptions",1),V})},w.uploadFile=function(A){var _=this,Y=new Date().getTime();return Ko.uploadFile(A).catch(function(de){var V,Fe,Et=de;_.core.reporter.reportTraceStart("exceptions",{user_id:_.core.options.account,trace_id:(Fe=(V=_.core)===null||V===void 0?void 0:V.socket)===null||Fe===void 0?void 0:Fe.sessionId,start_time:Y,action:1});var sr=Ko.platform==="BROWSER"?A.chunkUploadHost:A.commonUploadHost?A.commonUploadHost+"/"+(A.nosToken&&A.nosToken.bucket):"https://nos.netease.com/nim";throw _.core.reporter.reportTraceUpdateV2("exceptions",{code:typeof Et.code=="number"?Et.code:0,description:Et.message||""+Et.code,operation_type:1,target:sr}),_.core.reporter.reportTraceEnd("exceptions",1),de})},b}();(function(b){b[b.ACTIVE=1]="ACTIVE",b[b.KICKED=2]="KICKED",b[b.OFFLINE=3]="OFFLINE"})(cs||(cs={}));var Gy=window&&ip(window.addEventListener)&&ip(window.removeEventListener),Md=function(b){function w(A,_){var Y;(Y=b.call(this)||this).status="unconnected",Y.linkUrls=[],Y.eventBus=new gg,Y.packetSer=1,Y.retryCount=0,Y.reconnectTimer=0,Y.backoff=new q1({max:8e3,min:1600,jitter:.01}),Y.sendingCmdMap=new su,Y.pingTimer=0,Y.config=fy,Y.abtInfo={},zr({linkUrls:{type:"array",itemType:"string",required:!1}},A),Y.options=Xr(Xr({},gy),A),Y.adapters=new Wy(a(Y));var de=Ko.localStorage.getItem("__NIM_DEVC_ID__");Y.options.isFixedDeviceId?(de=Ko.localStorage.getItem("__NIM_DEVC_ID__")||zg(),Ko.localStorage.setItem("__NIM_DEVC_ID__",de)):de=zg(),Y.config=Xr(Xr(Xr({},fy),_),{deviceId:de}),Y.timerManager=new zy,Y.logger=new Sy(Y.options.debugLevel,Y.options.account);var V=Ko.getSystemInfo();return Y.reporter=new My({common:{app_key:A.appkey,dev_id:de,platform:"Web",sdk_ver:"0.13.1",env:"online",os_name:V.os,os_ver:V.osVer,model:V.hostEnvVer,manufactor:V.hostEnv,host_env:V.hostEnv,host_info:V.hostInfo,host_env_ver:V.hostEnvVer},request:Ko.request,logger:Y.logger,autoStart:Ko.platform==="BROWSER"}),Ko.setLogger(Y.logger),Y.logger.log("Core init, version ","0.13.1"," sdk version ",91001," appkey ",A.appkey),Y}Co(w,b);var $=w.prototype;return $.emit=function(_){try{for(var Y,de,V=es(),Fe=arguments.length,Et=new Array(Fe>1?Fe-1:0),sr=1;sr<Fe;sr++)Et[sr-1]=arguments[sr];var fr=(Y=b.prototype.emit).call.apply(Y,$s(de=[this,_]).call(de,Et)),Sr=es()-V;return Sr>=10&&this.logger.warn("Core::emit event: "+_+" process takes: "+Sr+"ms"),fr}catch(Tr){return this.logger.error("Core::emit event: "+_+". Error: "+Tr),!1}},$.connect=function(_,Y){return _===void 0&&(_={}),kr(this,void 0,void 0,rr.mark(function de(){var V,Fe,Et,sr,fr,Sr;return rr.wrap(function(Pr){for(;;)switch(Pr.prev=Pr.next){case 0:if(zr({linkUrls:{type:"array",itemType:"string",required:!1}},_),/^(unconnected|waitReconnect)$/.test(this.status)){Pr.next=5;break}return V="Core socket status is "+this.status+", and would not connect",this.logger.warn(V),Pr.abrupt("return",ro.reject(V));case 5:this.status="connecting",_.linkUrls&&_.linkUrls.length>0&&(this.linkUrls=$s(Fe=_.linkUrls).call(Fe,this.linkUrls),this.linkUrls=FT(this.linkUrls)),this.linkUrls.length===0&&this.linkUrls.push("weblink.netease.im:443"),Et=0;case 9:if(!(Et<this.linkUrls.length)){Pr.next=32;break}return sr=this.linkUrls[Et],fr=new Date().getTime(),Pr.prev=12,Pr.next=15,this.doConnect(sr);case 15:return this.status="connected",this.logger.log("core:: connect success with url: "+sr),this.abtRequest(),Pr.abrupt("return",sr);case 21:Pr.prev=21,Pr.t0=Pr.catch(12),Sr=Pr.t0,Y&&Y(Sr,sr),this.reporter.reportTraceStart("exceptions",{user_id:this.options.account,start_time:fr,action:0}),this.reporter.reportTraceUpdateV2("exceptions",{code:typeof Sr.code=="number"?Sr.code:0,description:Sr.message||""+Sr.code,operation_type:0,target:sr}),this.reporter.reportTraceEnd("exceptions",1),this.logger.warn("core:: connect failed with url: "+sr,Pr.t0);case 29:Et++,Pr.next=9;break;case 32:throw this.retryCount===0?this.doDisconnect(cs.ACTIVE,"SocketHandshakeFailed"):this.doDisconnect(cs.OFFLINE,"ReconnectHadRetryAllLinks"),new Error("core: socket handshake failed");case 34:case"end":return Pr.stop()}},de,this,[[12,21]])}))},$.doConnect=function(_){var Y=this;return new ro(function(de,V){var Fe;Y.socket=new iT(Y,_,Y.logger),Y.socket.on("connect",function(){Y.logger.log("socket on connect",_),de()}),Y.socket.on("message",Mo(Fe=Y.onMessage).call(Fe,Y)),Y.socket.on("disconnect",function(Et){Y.logger.log("core:: socket on disconnect",Et),Y.doDisconnect(cs.OFFLINE,"SocketOnDisconnect")}),Y.socket.on("handshakeFailed",function(){Y.logger.warn("core:: socket handshake failed"),V(new uo("handshake failed",{},408))})})},$.resetConnectStatus=function(){clearTimeout(this.reconnectTimer),this.backoff.reset(),this.retryCount=0,this.initOnlineListener()},$.doDisconnect=function(_,Y){if(this.logger.log("doDisconnect: type "+_+", description "+Y),this.status!=="unconnected"){this.markAllCmdInvaild(new uo("Packet timeout due to instance disconnect",{},408)),this.timerManager.destroy(),clearTimeout(this.pingTimer),this.socket&&(typeof this.socket.removeAllListeners=="function"&&this.socket.removeAllListeners(),typeof this.socket.close=="function"&&this.socket.close(),this.socket=void 0);var de=!this.options.needReconnect||this.retryCount>=this.options.reconnectionAttempts;if(_===cs.ACTIVE||de)this.logger.log("doDisconnect: emit disconnect, type "+_,de),this.status="unconnected",this.reconnectTimer&&clearTimeout(this.reconnectTimer),this.eventBus.emit("disconnect"),this.emit("disconnect"),this.destroyOnlineListener();else if(_===cs.KICKED){this.logger.log("doDisconnect: kicked"),this.status="unconnected",this.reconnectTimer&&clearTimeout(this.reconnectTimer);var V=typeof Y=="string"?{reason:"unknow",message:Y}:Y;this.eventBus.emit("kicked",V),this.emit("kicked",V),this.destroyOnlineListener()}else _===cs.OFFLINE?(this.logger.log("doDisconnect: start to reconnect"),this.attempToReconnect()):this.logger.log("doDisconnect: nothing to do")}else this.logger.warn("doDisconnect: already unconnected")},$.attempToReconnect=function(){var _=this;if(this.status!=="waitReconnect"){var Y=this.backoff.duration();this.retryCount++,this.logger.log("willReconnect "+this.retryCount+" "+Y),this.eventBus.emit("willReconnect",{retryCount:this.retryCount,duration:Y}),this.emit("willReconnect",{retryCount:this.retryCount,duration:Y}),this.status="waitReconnect",this.reconnectTimer&&clearTimeout(this.reconnectTimer),this.reconnectTimer=ti(function(){_.status==="waitReconnect"?_.connect({isAutoReconnect:!0}).catch(function(){_.logger.error("core::attempToReconnect failed "+_.retryCount)}):_.logger.warn("doDisconnect: reconnectTimer status is "+_.status+", would not go on reconnecting")},Y)}else this.logger.warn("doDisconnect: already is waiting reconnect")},$.sendCmd=function(_,Y,de){var V=this;if(this.status!=="logined"&&_!=="login"&&_!=="chatroomLogin"&&_!=="qchatLogin")return this.logger.warn("nim status is "+this.status+", so can not sendCmd "+_),ro.reject({cmd:_,error:{code:"No_connected",message:"Connection not established",timetag:new Date().getTime()}});if(!this.socket||!this.socket.send)return ro.reject("No_socket");var Fe=_!=="heartbeat",Et=Fe?this.packetSer++:0,sr=function(Jr,Gr,Mn,Qr){var Vn=fd[Jr];if(!Vn)return Mn.error("createCmd:: can not find cmd config: ",Jr),null;var Bn,Eo={SER:Gr,SID:Vn.sid,CID:Vn.cid,Q:[]};return Vn.params&&Qr&&kn(Bn=Vn.params).call(Bn,function(jn){var wr=Qr[jn.name];if(!xy(wr)){var Cn=jn.type,En=jn.reflectMapper;switch(jn.type){case"PropertyArray":Cn="ArrayMable",wr=co(wr).call(wr,function(vn){return{t:"Property",v:En?ts(vn,En):vn}});break;case"Property":wr=En?ts(wr,En):wr;break;case"Bool":case"bool":wr=wr?"true":"false"}Eo.Q.push({t:Cn,v:wr})}}),{packet:Eo,isNoResponse:Vn.isNoResponse||!1}}(_,Et,this.logger,Y);if(!sr){var fr="SendCmd "+Et+" "+_+" error";return this.logger.error(fr),ro.reject(fr)}var Sr=sr.packet,Tr=sr.isNoResponse,Pr=so(Sr);Fe&&(this.options.debugLevel==="debug"?this.logger.debug("core::sendCmd",_,"ser:"+Et,Pr):this.logger.log("core::sendCmd",_,"ser:"+Et));var Lr=new Date().getTime();return new ro(function(jr,Jr){V.sendingCmdMap.set(Et,{cmd:_,params:Y,callback:[jr,Jr],timer:Tr?null:ti(function(){var Mn,Qr=new xg(504,_,"Packet Timeout",new Date().getTime(),{message:"ser "+Et+" cmd "+_+" timeout"});Qr.callFunc="sendCmd",V.markCmdInvalid(Et,Qr,_),V.reporter.reportTraceStart("exceptions",{user_id:V.options.account,trace_id:(Mn=V.socket)===null||Mn===void 0?void 0:Mn.sessionId,start_time:Lr,action:2}),V.reporter.reportTraceUpdateV2("exceptions",{code:408,description:"Packet timeout",operation_type:1,target:Sr.SID+"-"+Sr.CID,context:""+Sr.SER}),V.reporter.reportTraceEnd("exceptions",1)},de&&de.timeout?de.timeout:V.config.timeout)});try{V.socket.send(Pr)}catch(Mn){var Gr=new xg(415,_,Mn&&Mn.message||"Unable to send packet",new Date().getTime(),{message:"send json error",rawError:Mn});Gr.callFunc="sendCmd",V.markCmdInvalid(Et,Gr,_),Jr(Mn)}})},$.onMessage=function(_){var Y=Ui(_,this.logger);if(Y){var de=Y.raw.ser;if(Y.error&&this.logger.error("core:onMessage packet error",Y.raw.sid+"_"+Y.raw.cid+", ser:"+de+",",Y.error),!Y.notFound)return Y.cmd!=="heartbeat"&&(this.options.debugLevel==="debug"?this.logger.debug("imsocket::recvCmd ser:"+de,Y.cmd,Y.content):this.logger.log("imsocket::recvCmd ser:"+de,Y.cmd)),Y.__receiveTime=es(),Y;this.logger.warn("core::onMessage packet not found",Y.raw.sid+"_"+Y.raw.cid+", ser:"+de)}},$.markCmdInvalid=function(_,Y,de){var V=this.sendingCmdMap.get(_);if(V){var Fe=V.callback,Et=V.timer;Et&&clearTimeout(Et),this.sendingCmdMap.delete(_),this.logger.warn("packet "+_+", "+de+" is invalid:",Y),Fe[1](Y)}},$.markAllCmdInvaild=function(_){var Y;this.logger.log("markAllCmdInvaild"),kn(Y=this.sendingCmdMap).call(Y,function(de){var V=de.callback,Fe=de.timer;Fe&&clearTimeout(Fe),V[1](_)}),this.sendingCmdMap.clear()},$.ping=function(){return kr(this,void 0,void 0,rr.mark(function _(){var Y=this;return rr.wrap(function(V){for(;;)switch(V.prev=V.next){case 0:return clearTimeout(this.pingTimer),V.prev=1,V.next=4,this.sendCmd("heartbeat");case 4:V.next=14;break;case 6:return V.prev=6,V.t0=V.catch(1),V.next=10,this.testHeartBeat5Timeout();case 10:if(!V.sent){V.next=14;break}return this.doDisconnect(cs.OFFLINE,"PingError"),V.abrupt("return");case 14:this.pingTimer=ti(function(){Y.ping()},3e4);case 15:case"end":return V.stop()}},_,this,[[1,6]])}))},$.testHeartBeat5Timeout=function(){return kr(this,void 0,void 0,rr.mark(function _(){var Y;return rr.wrap(function(V){for(;;)switch(V.prev=V.next){case 0:clearTimeout(this.pingTimer),Y=0;case 2:if(!(Y<5)){V.next=15;break}return V.prev=3,V.next=6,this.sendCmd("heartbeat",{},{timeout:3e3});case 6:return V.abrupt("return",!1);case 9:V.prev=9,V.t0=V.catch(3),this.logger.debug("core:: test heartbeat "+Y+" Timeout");case 12:Y++,V.next=2;break;case 15:return V.abrupt("return",!0);case 16:case"end":return V.stop()}},_,this,[[3,9]])}))},$.initOnlineListener=function(){var _,Y;this.onlineListener||(Gy?(this.onlineListener=Mo(_=function(){this.status==="logined"&&this.ping()}).call(_,this),this.offlineListener=Mo(Y=function(){this.logger.log("offline"),this.doDisconnect(cs.OFFLINE,"OfflineListener")}).call(Y,this),window.addEventListener("online",this.onlineListener),window.addEventListener("offline",this.offlineListener)):this.logger.warn("initOnlineListener not support add listener"))},$.destroyOnlineListener=function(){this.onlineListener&&(window.removeEventListener("online",this.onlineListener),this.onlineListener=void 0),this.offlineListener&&(window.removeEventListener("offline",this.offlineListener),this.offlineListener=void 0)},$.disconnect=function(){switch(this.status){case"connected":case"logined":case"connecting":case"waitReconnect":return this.doDisconnect(cs.ACTIVE,"UserActiveDisconnect"),ro.resolve();case"unconnected":case"destroyed":return ro.resolve()}},$.destroy=function(){var _=this;return this.disconnect().then(function(){_.status="destroyed",_.removeAllListeners(),_.eventBus.removeAllListeners(),_.reporter.destroy(),_.connect=function(){return ro.resolve()},_.disconnect=function(){return ro.resolve()},_.destroy=function(){return ro.resolve()}})},$.abtRequest=function(){var _,Y;return kr(this,void 0,void 0,rr.mark(function de(){var V,Fe;return rr.wrap(function(sr){for(;;)switch(sr.prev=sr.next){case 0:if(this.options.isAbtestEnable){sr.next=2;break}return sr.abrupt("return");case 2:if(!this.abtInfo.experiments){sr.next=4;break}return sr.abrupt("return");case 4:if(this.options.abtestUrl){sr.next=6;break}return sr.abrupt("return");case 6:return sr.prev=6,sr.next=9,this.adapters.request(this.options.abtestUrl,{method:"POST",dataType:"json",headers:{sdktype:"ABTest"},data:{clientInfo:{projectKey:this.options.abtestProjectKey,appKey:this.options.appkey,osType:"Web",sdkVersion:"0.13.1",deviceId:this.config.deviceId},useLocalCache:!0}});case 9:V=sr.sent,sr.next=15;break;case 12:sr.prev=12,sr.t0=sr.catch(6),this.logger.warn("ABTest request failed");case 15:this.abtInfo=((Y=(_=V==null?void 0:V.data)===null||_===void 0?void 0:_.data)===null||Y===void 0?void 0:Y.abtInfo)||{},this.abtInfo.experiments&&this.abtInfo.experiments.length>0&&this.reporter.reportImmediately("https://statistic.live.126.net/statics/report/abtest/result",{params:{app_key:this.options.appkey,biz_sdk_type:"IM",sdk_ver:"0.13.1",device_id:this.config.deviceId,platform:"Web",projectKey:this.options.abtestProjectKey,experiments:co(Fe=this.abtInfo.experiments).call(Fe,function(fr){return{experimentKey:fr.experimentKey,schemeKey:fr.schemeKey}})},headers:{sdktype:"ABTest"},method:"POST",dataType:"json"});case 17:case"end":return sr.stop()}},de,this,[[6,12]])}))},w}(gg);Md.setAdapters=function(w){Xr(Ko,w)};var Ky=hs.some,Ta=Ds("some");qr({target:"Array",proto:!0,forced:!Ta},{some:function(w){return Ky(this,w,arguments.length>1?arguments[1]:void 0)}});var jp=Ao("Array").some,Kg=Array.prototype,Bp=function(b){var w=b.some;return b===Kg||Lt(Kg,b)&&w===Kg.some?jp:w},Qg=function(){this.__data__=new yp,this.size=0},Jg=function(w){var $=this.__data__,A=$.delete(w);return this.size=$.size,A},qT=function(w){return this.__data__.get(w)},$T=function(w){return this.__data__.has(w)},HT=function(w,$){var A=this.__data__;if(A instanceof yp){var _=A.__data__;if(!Ic||_.length<199)return _.push([w,$]),this.size=++A.size,this;A=this.__data__=new fu(_)}return A.set(w,$),this.size=A.size,this};function Wu(b){var w=this.__data__=new yp(b);this.size=w.size}Wu.prototype.clear=Qg,Wu.prototype.delete=Jg,Wu.prototype.get=qT,Wu.prototype.has=$T,Wu.prototype.set=HT;var Lp=Wu,Qy=function(w,$){for(var A=-1,_=w==null?0:w.length;++A<_;)if($(w[A],A,w))return!0;return!1},Yg=function(w,$,A,_,Y,de){var V=1&A,Fe=w.length,Et=$.length;if(Fe!=Et&&!(V&&Et>Fe))return!1;var sr=de.get(w),fr=de.get($);if(sr&&fr)return sr==$&&fr==w;var Sr=-1,Tr=!0,Pr=2&A?new jg:void 0;for(de.set(w,$),de.set($,w);++Sr<Fe;){var Lr=w[Sr],jr=$[Sr];if(_)var Jr=V?_(jr,Lr,Sr,$,w,de):_(Lr,jr,Sr,w,$,de);if(Jr!==void 0){if(Jr)continue;Tr=!1;break}if(Pr){if(!Qy($,function(Gr,Mn){if(!Lg(Pr,Mn)&&(Lr===Gr||Y(Lr,Gr,A,_,de)))return Pr.push(Mn)})){Tr=!1;break}}else if(Lr!==jr&&!Y(Lr,jr,A,_,de)){Tr=!1;break}}return de.delete(w),de.delete($),Tr},Jy=Hs.Uint8Array,VT=function(w){var $=-1,A=Array(w.size);return w.forEach(function(_,Y){A[++$]=[Y,_]}),A},Cd=Ea?Ea.prototype:void 0,mu=Cd?Cd.valueOf:void 0,Xg=function(w,$,A,_,Y,de,V){switch(A){case"[object DataView]":if(w.byteLength!=$.byteLength||w.byteOffset!=$.byteOffset)return!1;w=w.buffer,$=$.buffer;case"[object ArrayBuffer]":return!(w.byteLength!=$.byteLength||!de(new Jy(w),new Jy($)));case"[object Boolean]":case"[object Date]":case"[object Number]":return mp(+w,+$);case"[object Error]":return w.name==$.name&&w.message==$.message;case"[object RegExp]":case"[object String]":return w==$+"";case"[object Map]":var Fe=VT;case"[object Set]":var Et=1&_;if(Fe||(Fe=wp),w.size!=$.size&&!Et)return!1;var sr=V.get(w);if(sr)return sr==$;_|=2,V.set(w,$);var fr=Yg(Fe(w),Fe($),_,Y,de,V);return V.delete(w),fr;case"[object Symbol]":if(mu)return mu.call(w)==mu.call($)}return!1},Es=function(w,$){for(var A=-1,_=$.length,Y=w.length;++A<_;)w[Y+A]=$[A];return w},Fa=Array.isArray,Up=function(w,$,A){var _=$(w);return Fa(w)?_:Es(_,A(w))},Ri=function(w,$){for(var A=-1,_=w==null?0:w.length,Y=0,de=[];++A<_;){var V=w[A];$(V,A,w)&&(de[Y++]=V)}return de},Yy=function(){return[]},Zg=Object.prototype.propertyIsEnumerable,eh=Object.getOwnPropertySymbols,zT=eh?function(b){return b==null?[]:(b=Object(b),Ri(eh(b),function(w){return Zg.call(b,w)}))}:Yy,th=zT,WT=function(w,$){for(var A=-1,_=Array(w);++A<w;)_[A]=$(A);return _},Dp=function(w){return as(w)&&Js(w)=="[object Arguments]"},rh=Object.prototype,Gu=rh.hasOwnProperty,GT=rh.propertyIsEnumerable,nh=Dp(function(){return arguments}())?Dp:function(b){return as(b)&&Gu.call(b,"callee")&&!GT.call(b,"callee")},oh=nh,KT=function(){return!1},ih=s(function(b,w){var $=w&&!w.nodeType&&w,A=$&&b&&!b.nodeType&&b,_=A&&A.exports===$?Hs.Buffer:void 0,Y=(_?_.isBuffer:void 0)||KT;b.exports=Y}),Xy=/^(?:0|[1-9]\d*)$/,kd=function(w,$){var A=typeof w;return!!($=$??9007199254740991)&&(A=="number"||A!="symbol"&&Xy.test(w))&&w>-1&&w%1==0&&w<$},gi={};gi["[object Float32Array]"]=gi["[object Float64Array]"]=gi["[object Int8Array]"]=gi["[object Int16Array]"]=gi["[object Int32Array]"]=gi["[object Uint8Array]"]=gi["[object Uint8ClampedArray]"]=gi["[object Uint16Array]"]=gi["[object Uint32Array]"]=!0,gi["[object Arguments]"]=gi["[object Array]"]=gi["[object ArrayBuffer]"]=gi["[object Boolean]"]=gi["[object DataView]"]=gi["[object Date]"]=gi["[object Error]"]=gi["[object Function]"]=gi["[object Map]"]=gi["[object Number]"]=gi["[object Object]"]=gi["[object RegExp]"]=gi["[object Set]"]=gi["[object String]"]=gi["[object WeakMap]"]=!1;var Zy=function(w){return as(w)&&qg(w.length)&&!!gi[Js(w)]},sh=Bu&&Bu.isTypedArray,ac=sh?Og(sh):Zy,ev=Object.prototype.hasOwnProperty,tv=function(w,$){var A=Fa(w),_=!A&&oh(w),Y=!A&&!_&&ih(w),de=!A&&!_&&!Y&&ac(w),V=A||_||Y||de,Fe=V?WT(w.length,String):[],Et=Fe.length;for(var sr in w)!$&&!ev.call(w,sr)||V&&(sr=="length"||Y&&(sr=="offset"||sr=="parent")||de&&(sr=="buffer"||sr=="byteLength"||sr=="byteOffset")||kd(sr,Et))||Fe.push(sr);return Fe},QT=Object.prototype,rv=function(w){var $=w&&w.constructor;return w===(typeof $=="function"&&$.prototype||QT)},nv=function(w,$){return function(A){return w($(A))}},ov=nv(Object.keys,Object),JT=Object.prototype.hasOwnProperty,ah=function(w){if(!rv(w))return ov(w);var $=[];for(var A in Object(w))JT.call(w,A)&&A!="constructor"&&$.push(A);return $},Ec=function(w){return xp(w)?tv(w):ah(w)},ch=function(w){return Up(w,Ec,th)},YT=Object.prototype.hasOwnProperty,iv=function(w,$,A,_,Y,de){var V=1&A,Fe=ch(w),Et=Fe.length;if(Et!=ch($).length&&!V)return!1;for(var sr=Et;sr--;){var fr=Fe[sr];if(!(V?fr in $:YT.call($,fr)))return!1}var Sr=de.get(w),Tr=de.get($);if(Sr&&Tr)return Sr==$&&Tr==w;var Pr=!0;de.set(w,$),de.set($,w);for(var Lr=V;++sr<Et;){var jr=w[fr=Fe[sr]],Jr=$[fr];if(_)var Gr=V?_(Jr,jr,fr,$,w,de):_(jr,Jr,fr,w,$,de);if(!(Gr===void 0?jr===Jr||Y(jr,Jr,A,_,de):Gr)){Pr=!1;break}Lr||(Lr=fr=="constructor")}if(Pr&&!Lr){var Mn=w.constructor,Qr=$.constructor;Mn==Qr||!("constructor"in w)||!("constructor"in $)||typeof Mn=="function"&&Mn instanceof Mn&&typeof Qr=="function"&&Qr instanceof Qr||(Pr=!1)}return de.delete(w),de.delete($),Pr},cc=pu(Hs,"DataView"),Bi=pu(Hs,"Promise"),Ku=pu(Hs,"WeakMap"),di="[object Map]",Xs="[object Promise]",sv="[object Set]",ns="[object WeakMap]",uh="[object DataView]",lh=lu(cc),XT=lu(Ic),ZT=lu(Bi),av=lu(zu),eS=lu(Ku),gu=Js;(cc&&gu(new cc(new ArrayBuffer(1)))!=uh||Ic&&gu(new Ic)!=di||Bi&&gu(Bi.resolve())!=Xs||zu&&gu(new zu)!=sv||Ku&&gu(new Ku)!=ns)&&(gu=function(b){var w=Js(b),$=w=="[object Object]"?b.constructor:void 0,A=$?lu($):"";if(A)switch(A){case lh:return uh;case XT:return di;case ZT:return Xs;case av:return sv;case eS:return ns}return w});var xd=gu,Zs="[object Arguments]",dh="[object Array]",qp="[object Object]",wd=Object.prototype.hasOwnProperty,cv=function(w,$,A,_,Y,de){var V=Fa(w),Fe=Fa($),Et=V?dh:xd(w),sr=Fe?dh:xd($),fr=(Et=Et==Zs?qp:Et)==qp,Sr=(sr=sr==Zs?qp:sr)==qp,Tr=Et==sr;if(Tr&&ih(w)){if(!ih($))return!1;V=!0,fr=!1}if(Tr&&!fr)return de||(de=new Lp),V||ac(w)?Yg(w,$,A,_,Y,de):Xg(w,$,Et,A,_,Y,de);if(!(1&A)){var Pr=fr&&wd.call(w,"__wrapped__"),Lr=Sr&&wd.call($,"__wrapped__");if(Pr||Lr){var jr=Pr?w.value():w,Jr=Lr?$.value():$;return de||(de=new Lp),Y(jr,Jr,A,_,de)}}return!!Tr&&(de||(de=new Lp),iv(w,$,A,_,Y,de))},ph=function b(w,$,A,_,Y){return w===$||(w==null||$==null||!as(w)&&!as($)?w!=w&&$!=$:cv(w,$,A,_,b,Y))},tS=function(w,$,A,_){var Y=A.length,de=Y,V=!_;if(w==null)return!de;for(w=Object(w);Y--;){var Fe=A[Y];if(V&&Fe[2]?Fe[1]!==w[Fe[0]]:!(Fe[0]in w))return!1}for(;++Y<de;){var Et=(Fe=A[Y])[0],sr=w[Et],fr=Fe[1];if(V&&Fe[2]){if(sr===void 0&&!(Et in w))return!1}else{var Sr=new Lp;if(_)var Tr=_(sr,fr,Et,w,$,Sr);if(!(Tr===void 0?ph(fr,sr,3,_,Sr):Tr))return!1}}return!0},uv=function(w){return w==w&&!ma(w)},rS=function(w){for(var $=Ec(w),A=$.length;A--;){var _=$[A],Y=w[_];$[A]=[_,Y,uv(Y)]}return $},fh=function(w,$){return function(A){return A!=null&&A[w]===$&&($!==void 0||w in Object(A))}},lv=function(w){var $=rS(w);return $.length==1&&$[0][2]?fh($[0][0],$[0][1]):function(A){return A===w||tS(A,w,$)}},$p=function(w){return typeof w=="symbol"||as(w)&&Js(w)=="[object Symbol]"},nS=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,oS=/^\w*$/,Id=function(w,$){if(Fa(w))return!1;var A=typeof w;return!(A!="number"&&A!="symbol"&&A!="boolean"&&w!=null&&!$p(w))||oS.test(w)||!nS.test(w)||$!=null&&w in Object($)};function mh(b,w){if(typeof b!="function"||w!=null&&typeof w!="function")throw new TypeError("Expected a function");var $=function(){var A=arguments,_=w?w.apply(this,A):A[0],Y=$.cache;if(Y.has(_))return Y.get(_);var de=b.apply(this,A);return $.cache=Y.set(_,de)||Y,de};return $.cache=new(mh.Cache||fu),$}mh.Cache=fu;var Hp=mh,iS=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Vp=/\\(\\)?/g,hi=function(w){var $=Hp(w,function(_){return A.size===500&&A.clear(),_}),A=$.cache;return $}(function(b){var w=[];return b.charCodeAt(0)===46&&w.push(""),b.replace(iS,function($,A,_,Y){w.push(_?Y.replace(Vp,"$1"):A||$)}),w}),sS=hi,gh=Ea?Ea.prototype:void 0,hh=gh?gh.toString:void 0,aS=function b(w){if(typeof w=="string")return w;if(Fa(w))return Hu(w,b)+"";if($p(w))return hh?hh.call(w):"";var $=w+"";return $=="0"&&1/w==-1/0?"-0":$},dv=function(w){return w==null?"":aS(w)},zp=function(w,$){return Fa(w)?w:Id(w,$)?[w]:sS(dv(w))},hu=function(w){if(typeof w=="string"||$p(w))return w;var $=w+"";return $=="0"&&1/w==-1/0?"-0":$},yh=function(w,$){for(var A=0,_=($=zp($,w)).length;w!=null&&A<_;)w=w[hu($[A++])];return A&&A==_?w:void 0},Vi=function(w,$,A){var _=w==null?void 0:yh(w,$);return _===void 0?A:_},cS=function(w,$){return w!=null&&$ in Object(w)},_d=function(w,$,A){for(var _=-1,Y=($=zp($,w)).length,de=!1;++_<Y;){var V=hu($[_]);if(!(de=w!=null&&A(w,V)))break;w=w[V]}return de||++_!=Y?de:!!(Y=w==null?0:w.length)&&qg(Y)&&kd(V,Y)&&(Fa(w)||oh(w))},pv=function(w,$){return w!=null&&_d(w,$,cS)},uS=function(w,$){return Id(w)&&uv($)?fh(hu(w),$):function(A){var _=Vi(A,w);return _===void 0&&_===$?pv(A,w):ph($,_,3)}},vh=function(w){return function($){return $==null?void 0:$[w]}},lS=function(w){return function($){return yh($,w)}},dS=function(w){return Id(w)?vh(hu(w)):lS(w)},zi=function(w){return typeof w=="function"?w:w==null?Mp:typeof w=="object"?Fa(w)?uS(w[0],w[1]):lv(w):dS(w)},pS=function(w,$,A){$=="__proto__"&&Cp?Cp(w,$,{configurable:!0,enumerable:!0,value:A,writable:!0}):w[$]=A},bh=Object.prototype.hasOwnProperty,fv=function(w,$,A){var _=w[$];bh.call(w,$)&&mp(_,A)&&(A!==void 0||$ in w)||pS(w,$,A)},fS=function(w,$,A,_){if(!ma(w))return w;for(var Y=-1,de=($=zp($,w)).length,V=de-1,Fe=w;Fe!=null&&++Y<de;){var Et=hu($[Y]),sr=A;if(Et==="__proto__"||Et==="constructor"||Et==="prototype")return w;if(Y!=V){var fr=Fe[Et];(sr=_?_(fr,Et,Fe):void 0)===void 0&&(sr=ma(fr)?fr:kd($[Y+1])?[]:{})}fv(Fe,Et,sr),Fe=Fe[Et]}return w},mv=function(w,$,A){for(var _=-1,Y=$.length,de={};++_<Y;){var V=$[_],Fe=yh(w,V);A(Fe,V)&&fS(de,zp(V,w),Fe)}return de},gv=nv(Object.getPrototypeOf,Object),Ed=Object.getOwnPropertySymbols?function(b){for(var w=[];b;)Es(w,th(b)),b=gv(b);return w}:Yy,mS=function(w){var $=[];if(w!=null)for(var A in Object(w))$.push(A);return $},gS=Object.prototype.hasOwnProperty,hv=function(w){if(!ma(w))return mS(w);var $=rv(w),A=[];for(var _ in w)(_!="constructor"||!$&&gS.call(w,_))&&A.push(_);return A},hS=function(w){return xp(w)?tv(w,!0):hv(w)},yS=function(w){return Up(w,hS,Ed)},Th,yv,vv=function(w,$){if(w==null)return{};var A=Hu(yS(w),function(_){return[_]});return $=zi($),mv(w,A,function(_,Y){return $(_,Y[0])})},bv={"6_2":"getNosToken","6_22":"getOriginUrl","6_26":"getNosCdnHost","6_27":"getGrayscaleConfig","6_28":"getMixStorePolicy","6_29":"getMixStoreToken","6_30":"getFileAuthToken"},Qu={nosToken:{objectName:1,token:2,bucket:3,expireTime:4,expireSec:7,tag:8,shortUrl:9},mixStoreTokenReqTag:{provider:0,tokenCount:1,fileExpireSec:2,tag:3,returnBody:4},nosConfigTag:{bucket:1,cdnDomain:2,expire:3,objectNamePrefix:4},grayConfigTag:{config:0,ttl:1},mixStorePolicyTag:{providers:0,ttl:1,mixEnable:2,nosPolicy:3,s3Policy:4},mixStoreTokenResTag:{provider:0,accessKeyId:1,secretAccessKey:2,sessionToken:3,token:4,expireTime:5,bucket:6,objectName:7,fileExpireSec:8,tag:9,shortUrl:10,region:11},nosSafeUrlTag:{safeUrl:0,originUrl:1},mixStoreAuthTokenReqTag:{type:1,urls:2},mixStoreAuthTokenResTag:{type:1,tokens:2,token:3,ttl:4}},yu=xc(Qu),Sh={getNosToken:{sid:6,cid:2,service:"cloudStorage",response:[{type:"Property",name:"nosToken",reflectMapper:yu.nosToken}],params:[{type:"String",name:"responseBody"},{type:"Property",name:"nosToken",entity:"nosToken",reflectMapper:Qu.nosToken}]},getOriginUrl:{sid:6,cid:22,service:"cloudStorage",response:[{type:"Property",name:"nosSafeUrlTag",reflectMapper:yu.nosSafeUrlTag}],params:[{type:"Property",name:"nosSafeUrlTag",reflectMapper:Qu.nosSafeUrlTag}]},getNosCdnHost:{sid:6,cid:26,service:"misc",response:[{type:"Property",name:"nosConfigTag",reflectMapper:yu.nosConfigTag}]},getGrayscaleConfig:{sid:6,cid:27,service:"cloudStorage",response:[{type:"Property",name:"grayConfigTag",reflectMapper:yu.grayConfigTag}],params:[{type:"Property",name:"config"}]},getMixStorePolicy:{sid:6,cid:28,service:"cloudStorage",params:[{type:"LongArray",name:"supportType"}],response:[{type:"Property",name:"mixStorePolicyTag",reflectMapper:yu.mixStorePolicyTag}]},getMixStoreToken:{sid:6,cid:29,service:"cloudStorage",params:[{type:"Property",name:"mixStoreTokenReqTag",reflectMapper:Qu.mixStoreTokenReqTag}],response:[{type:"Property",name:"mixStoreTokenResTag",reflectMapper:yu.mixStoreTokenResTag}]},getFileAuthToken:{sid:6,cid:30,service:"cloudStorage",params:[{type:"Property",name:"mixStoreAuthTokenReqTag",reflectMapper:Qu.mixStoreAuthTokenReqTag}],response:[{type:"Property",name:"mixStoreAuthTokenResTag",reflectMapper:yu.mixStoreAuthTokenResTag}]}};(function(b){b[b.nos=1]="nos",b[b.s3=2]="s3"})(Th||(Th={})),function(b){b[b.dontNeed=-1]="dontNeed",b[b.time=2]="time",b[b.urls=3]="urls"}(yv||(yv={}));var Vs,ja,vS={chunkUploadHost:"https://wanproxy-web.127.net",commonUploadHost:"https://nos.netease.com",chunkMaxSize:4194304e4,commonMaxSize:104857600,uploadReplaceFormat:"https://{host}/{object}",cdn:{defaultCdnDomain:"nim.nosdn.127.net",cdnDomain:"",bucket:"",objectNamePrefix:""},downloadUrl:"https://{bucket}-nosdn.netease.im/{object}",downloadHostList:["nos.netease.com"],nosCdnEnable:!0,isNeedToGetUploadPolicyFromServer:!0},Pc={file:{md5:"$(Etag)",size:"$(ObjectSize)"},image:{md5:"$(Etag)",size:"$(ObjectSize)",w:"$(ImageInfo.Width)",h:"$(ImageInfo.Height)",orientation:"$(ImageInfo.Orientation)"},audio:{md5:"$(Etag)",size:"$(ObjectSize)",dur:"$(AVinfo.Audio.Duration)"},video:{md5:"$(Etag)",size:"$(ObjectSize)",dur:"$(AVinfo.Video.Duration)",w:"$(AVinfo.Video.Width)",h:"$(AVinfo.Video.Height)"}},Mh={accessKeyId:"",secretAccessKey:"",sessionToken:"",region:"",maxRetries:0,bucket:"",objectName:"",token:"",shortUrl:""};function Ch(b){return b===void 0&&(b="file"),so(Pc[b]||{}).replace(/"/gi,'\\"')}(function(b){b[b.nos=1]="nos",b[b.s3=2]="s3"})(Vs||(Vs={})),function(b){b[b.dontNeed=-1]="dontNeed",b[b.time=2]="time",b[b.urls=3]="urls"}(ja||(ja={}));var Tv=function(){function b($,A){A===void 0&&(A={}),this.GRAYKEY="AllGrayscaleConfig",this.MIXSTOREKEY="AllMixStorePolicy",this.config={},this.nosCdnHostTimer=0,this.grayConfig={mixStoreEnable:!1,timeStamp:0,ttl:0},this.mixStorePolicy={providers:[],timeStamp:0,ttl:0,s3Policy:null,nosPolicy:null},this.curProvider=Vs.nos,this.s3=null,this.mixStoreErrorCount=10,this.nosErrorCount=0,this.circuitTimer=0,this.name="cloudStorage",this.logger=$.logger,this.core=$,Oa({cmdMap:bv,cmdConfig:Sh}),this.setOptions(A)}var w=b.prototype;return w.setOptions=function(A){A===void 0&&(A={});var _=A.storageKeyPrefix||"NIMClient";this.GRAYKEY=_+"-AllGrayscaleConfig",this.MIXSTOREKEY=_+"-AllMixStorePolicy";var Y=A.s3,de=Ou(A,["s3"]),V=Xr({},vS,this.config);if(de&&Object.prototype.hasOwnProperty.call(de,"cdn")){var Fe={cdn:Xr(Xr({},V.cdn),de.cdn)};this.config=Xr({},V,de,Fe)}else this.config=Xr({},V,de);Y&&(this.s3=Y)},w.init=function(){return kr(this,void 0,void 0,rr.mark(function A(){return rr.wrap(function(Y){for(;;)switch(Y.prev=Y.next){case 0:if(this.grayConfig=null,this.mixStorePolicy={providers:[],timeStamp:0,ttl:0,s3Policy:null,nosPolicy:null},this.curProvider=Vs.nos,this.mixStoreErrorCount=10,!this.config.isNeedToGetUploadPolicyFromServer){Y.next=9;break}return Y.next=7,this.getGrayscaleConfig(this.core.options.appkey);case 7:return Y.next=9,this.getNosCdnHost();case 9:case"end":return Y.stop()}},A,this)}))},w.uploadFile=function(A){return kr(this,void 0,void 0,rr.mark(function _(){var Y,de,V;return rr.wrap(function(Et){for(;;)switch(Et.prev=Et.next){case 0:if(zr({maxSize:{type:"number",required:!1},type:{type:"enum",values:["file","image","audio","video"]}},A),A.fileInput||A.file||A.filePath){Et.next=3;break}throw new Error("uploadFile needs target file object or a filePath");case 3:if(!A.type||A.type==="file"){Et.next=7;break}if(typeof(Y=Vi(A,"file.type"))!="string"||ai(Y).call(Y,A.type)!==-1){Et.next=7;break}throw new Error('The meta type "'+Y+'" does not match "'+A.type+'"');case 7:if(this.grayConfig&&this.grayConfig.mixStoreEnable&&this.mixStorePolicy.providers.length){Et.next=10;break}return this.logger.log("uploadFile:: uploadFile begin, use old nos"),Et.abrupt("return",this.nosUpload(A));case 10:return this.logger.log("uploadFile:: uploadFile begin,Current settings grayConfig mixStoreEnable:"+this.grayConfig.mixStoreEnable+" curProvider:"+this.curProvider),this.s3||(this.curProvider=Vs.nos),de=Mh,Et.prev=13,Et.next=16,this.core.sendCmd("getMixStoreToken",{mixStoreTokenReqTag:{provider:this.curProvider,tokenCount:1,tag:"qchat",returnBody:Ch(A.type)}});case 16:V=Et.sent,de=V.content.mixStoreTokenResTag,Et.next=24;break;case 20:throw Et.prev=20,Et.t0=Et.catch(13),this.core.logger.error("uploadFile:: getMixStoreToken error",Et.t0),new Cc("getMixStoreToken error",Et.t0,this.curProvider,this.mixStorePolicy);case 24:return Et.abrupt("return",this.curProvider===Vs.s3?this.s3Upload(A,de):this.nosUpload(A,de));case 25:case"end":return Et.stop()}},_,this,[[13,20]])}))},w.nosUpload=function(A,_){var Y,de;return kr(this,void 0,void 0,rr.mark(function V(){var Fe,Et,sr,fr,Sr,Tr,Pr,Lr,jr,Jr,Gr,Mn,Qr;return rr.wrap(function(Bn){for(;;)switch(Bn.prev=Bn.next){case 0:if(Fe=Vi(this.core,"config.cdn.bucket"),Et={tag:A.nosScenes||Fe||"nim",expireSec:A.nosSurvivalTime},_){Bn.next=13;break}return Bn.prev=3,Bn.next=6,this.core.sendCmd("getNosToken",{responseBody:Ch(A.type),nosToken:Et});case 6:sr=Bn.sent,Bn.next=13;break;case 9:throw Bn.prev=9,Bn.t0=Bn.catch(3),this.core.logger.error("uploadFile:: getNosToken error",Bn.t0),new Cc("getNosToken error",Bn.t0,1);case 13:return Bn.prev=13,Sr=sr?sr.content.nosToken:_,this.core.logger.debug("uploadFile:: uploadFile params",{nosToken:Sr,chunkUploadHost:this.config.chunkUploadHost,commonUploadHost:this.config.commonUploadHost,platform:Ko.platform}),Bn.next=18,this.core.adapters.uploadFile(Xr(Xr({},A),{nosToken:Sr,chunkUploadHost:this.config.chunkUploadHost,commonUploadHost:this.config.commonUploadHost,maxSize:A.maxSize||this.config.chunkMaxSize}));case 18:fr=Bn.sent,Bn.next=42;break;case 21:if(Bn.prev=21,Bn.t1=Bn.catch(13),this.core.logger.error("uploadFile::nos uploadFile error",Bn.t1),!_){Bn.next=41;break}if(this.nosErrorCount!==0){Bn.next=37;break}Bn.prev=26,this._addCircuitTimer(),Bn.next=33;break;case 30:throw Bn.prev=30,Bn.t2=Bn.catch(26),new Cc("upload file error",Bn.t2,this.curProvider,this.mixStorePolicy,A.file||A.filePath);case 33:return this.nosErrorCount=(Y=this.mixStorePolicy.nosPolicy)===null||Y===void 0?void 0:Y.uploadConfig.retryPolicy.retry,Bn.abrupt("return",this.uploadFile(A));case 37:return this.nosErrorCount--,Bn.abrupt("return",this.nosUpload(A,_));case 39:Bn.next=42;break;case 41:throw new Cc("nos uploadFile error",Bn.t1,1);case 42:if(Tr=fr==null?void 0:fr.type,Pr=Tr&&ai(Tr).call(Tr,"/")>-1?fo(Tr).call(Tr,0,ai(Tr).call(Tr,"/")):"",Lr={image:"imageInfo",video:"vinfo",audio:"vinfo"},jr=this.config.uploadReplaceFormat.replace("{host}",this.config.cdn.cdnDomain||this.config.cdn.defaultCdnDomain).replace("{object}",sr?sr.content.nosToken.objectName:_==null?void 0:_.objectName),_&&_.shortUrl&&(jr=_.shortUrl),Lr[Pr]){Bn.next=49;break}return Bn.abrupt("return",Xr({url:jr},fr));case 49:if(Bn.prev=49,!(ai(jr).call(jr,"_im_url=1")<0)){Bn.next=54;break}return Bn.next=53,this.core.adapters.request(jr+"?"+Lr[Pr],{method:"GET",dataType:"json",timeout:5e3});case 53:Jr=Bn.sent;case 54:Bn.next=60;break;case 56:return Bn.prev=56,Bn.t3=Bn.catch(49),this.core.logger.error("uploadFile:: fetch file info error",Bn.t3),Bn.abrupt("return",Xr({url:jr},fr));case 60:if(!Jr){Bn.next=67;break}return Gr=Jr.data,Mn=Lr[Pr]==="imageInfo"?Gr:(de=Gr==null?void 0:Gr.GetVideoInfo)===null||de===void 0?void 0:de.VideoInfo,Qr={url:jr,name:fr.name,size:fr.size,ext:fr.ext,w:Mn.Width,h:Mn.Height,orientation:Mn.Orientation,dur:Mn.Duration,audioCodec:Mn.AudioCodec,videoCodec:Mn.VideoCodec,container:Mn.Container},Bn.abrupt("return",vv(Qr,function(Eo,jn){return jn!==void 0}));case 67:return Bn.abrupt("return",Xr({url:jr},fr));case 68:case"end":return Bn.stop()}},V,this,[[3,9],[13,21],[26,30],[49,56]])}))},w.getNosCdnHost=function(){var A;return kr(this,void 0,void 0,rr.mark(function _(){var Y,de,V,Fe=this;return rr.wrap(function(sr){for(;;)switch(sr.prev=sr.next){case 0:return sr.prev=0,sr.next=3,this.core.sendCmd("getNosCdnHost");case 3:Y=sr.sent,sr.next=10;break;case 6:return sr.prev=6,sr.t0=sr.catch(0),this.logger.error("getNosCdnHost::error",sr.t0),sr.abrupt("return");case 10:if(Y){sr.next=12;break}return sr.abrupt("return");case 12:de=(A=Y==null?void 0:Y.content)===null||A===void 0?void 0:A.nosConfigTag,(V=wo(de==null?void 0:de.expire))!==0&&de.cdnDomain?V===-1?(this.config.cdn.bucket=de.bucket,this.config.cdn.cdnDomain=de.cdnDomain,this.config.cdn.objectNamePrefix=de.objectNamePrefix):(this.config.cdn.bucket=de.bucket,this.config.cdn.cdnDomain=de.cdnDomain,this.config.cdn.objectNamePrefix=de.objectNamePrefix,this.nosCdnHostTimer=this.core.timerManager.addTimer(function(){Fe.getNosCdnHost()},1e3*V)):(this.config.cdn.bucket="",this.config.cdn.cdnDomain="",this.config.cdn.objectNamePrefix="");case 15:case"end":return sr.stop()}},_,this,[[0,6]])}))},w.getGrayscaleConfig=function(A){var _;return kr(this,void 0,void 0,rr.mark(function Y(){var de,V;return rr.wrap(function(Et){for(;;)switch(Et.prev=Et.next){case 0:if(Ko.localStorage)try{Ko.localStorage.getItem&&Ko.localStorage.getItem(this.GRAYKEY)&&(this.grayConfig=JSON.parse(Ko.localStorage.getItem(this.GRAYKEY))[A])}catch(sr){Ko.localStorage.getItem(this.GRAYKEY)&&this.core.logger.error("uploadFile:: JSON.parse grayscaleConfig error ",sr)}if(this.grayConfig&&!(this.grayConfig.timeStamp+1e3*this.grayConfig.ttl<new Date().getTime())){Et.next=17;break}return Et.next=4,this.core.sendCmd("getGrayscaleConfig",{config:{}});case 4:if(!(de=Et.sent).content||!de.content.grayConfigTag){Et.next=16;break}this.logger.log("uploadFile::getAppGrayConfigRequest success ");try{this.grayConfig=JSON.parse(de.content.grayConfigTag.config),this.grayConfig.ttl=JSON.parse(de.content.grayConfigTag.ttl)}catch(sr){this.logger.error("getGrayscaleConfig error",sr)}if(this.grayConfig){Et.next=10;break}return Et.abrupt("return");case 10:V=Ko.localStorage.getItem(this.GRAYKEY)?JSON.parse(Ko.localStorage.getItem(this.GRAYKEY)):{},this.grayConfig.timeStamp=new Date().getTime(),V[A]=this.grayConfig,Ko.localStorage.setItem(this.GRAYKEY,so(V)),Et.next=17;break;case 16:this.logger.debug("uploadFile:: result grayConfig:",de.content);case 17:if(!(!((_=this.grayConfig)===null||_===void 0)&&_.mixStoreEnable)){Et.next=20;break}return Et.next=20,this._getMixStorePolicy(A);case 20:case"end":return Et.stop()}},Y,this)}))},w._getMixStorePolicy=function(A){return kr(this,void 0,void 0,rr.mark(function _(){var Y,de,V,Fe,Et,sr,fr;return rr.wrap(function(Tr){for(;;)switch(Tr.prev=Tr.next){case 0:if(Y=new Date().getTime(),Ko.localStorage)try{this.mixStorePolicy=JSON.parse(Ko.localStorage.getItem(this.MIXSTOREKEY))[A],this.curProvider=wo(this.mixStorePolicy.providers[0]),this.mixStorePolicy.timeStamp&&this.mixStorePolicy.timeStamp+1e3*this.mixStorePolicy.ttl>Y&&(V=this.mixStorePolicy.timeStamp+1e3*this.mixStorePolicy.ttl-Y,this.core.timerManager.addTimer(Mo(de=this._getMixStorePolicy).call(de,this,A),V))}catch(Pr){Ko.localStorage.getItem(this.MIXSTOREKEY)&&JSON.parse(Ko.localStorage.getItem(this.MIXSTOREKEY))[A]&&this.core.logger.error("uploadFile:: JSON.parse mixStorePolicy error ",Pr)}if(this.mixStorePolicy&&!(this.mixStorePolicy.timeStamp+1e3*this.mixStorePolicy.ttl<=Y)){Tr.next=30;break}return Tr.prev=3,Tr.next=6,this.core.sendCmd("getMixStorePolicy",{supportType:this.s3?[1,2]:[1]});case 6:Et=Tr.sent,sr=Et.content.mixStorePolicyTag,this.mixStorePolicy={providers:[],timeStamp:0,ttl:0,s3Policy:null,nosPolicy:null},this.mixStorePolicy.ttl=Number(sr.ttl),this.mixStorePolicy.providers=sr.providers.split(","),this.circuitTimer&&this.core.timerManager.deleteTimer(this.circuitTimer),this.curProvider=wo(this.mixStorePolicy.providers[0]),this.mixStorePolicy.nosPolicy=sr.nosPolicy?JSON.parse(sr.nosPolicy):null,this.mixStorePolicy.s3Policy=sr.s3Policy?JSON.parse(sr.s3Policy):null,this.mixStorePolicy.s3Policy===null?this.mixStorePolicy.providers=["1"]:this.mixStorePolicy.nosPolicy===null?this.mixStorePolicy.providers=["2"]:this.mixStorePolicy.providers=this.mixStorePolicy.s3Policy.priority<this.mixStorePolicy.nosPolicy.priority?["2","1"]:["1","2"],this.core.timerManager.addTimer(Mo(Fe=this._getMixStorePolicy).call(Fe,this,A),1e3*this.mixStorePolicy.ttl),fr=Ko.localStorage.getItem(this.MIXSTOREKEY)?JSON.parse(Ko.localStorage.getItem(this.MIXSTOREKEY)):{},this.mixStorePolicy.timeStamp=new Date().getTime(),fr[A]=this.mixStorePolicy,Ko.localStorage.setItem(this.MIXSTOREKEY,so(fr)),Tr.next=30;break;case 23:if(Tr.prev=23,Tr.t0=Tr.catch(3),this.logger.error("getMixStorePolicy error",Tr.t0),this.mixStoreErrorCount!==0){Tr.next=28;break}throw new Error("getMixStorePolicy all count error");case 28:this._getMixStorePolicy(A),this.mixStoreErrorCount--;case 30:this.mixStorePolicy.nosPolicy&&(this.nosErrorCount=this.mixStorePolicy.nosPolicy.uploadConfig.retryPolicy.retry);case 31:case"end":return Tr.stop()}},_,this,[[3,23]])}))},w.s3Upload=function(A,_){return kr(this,void 0,void 0,rr.mark(function Y(){var de,V,Fe,Et,sr,fr,Sr,Tr,Pr,Lr,jr=this;return rr.wrap(function(Gr){for(;;)switch(Gr.prev=Gr.next){case 0:if(!A.file){Gr.next=4;break}de=A.file,Gr.next=19;break;case 4:if(typeof A.fileInput!="string"){Gr.next=14;break}if(this.logger.warn("fileInput will abandon,Please use file or filepath"),!((V=document.getElementById(A.fileInput))&&V.files&&V.files[0])){Gr.next=11;break}de=V.files[0],Gr.next=12;break;case 11:throw new Error("Can not get file from fileInput");case 12:Gr.next=19;break;case 14:if(!(A.fileInput&&A.fileInput.files&&A.fileInput.files[0])){Gr.next=18;break}de=A.fileInput.files[0],Gr.next=19;break;case 18:throw new Error("Can not get file from fileInput "+A.fileInput);case 19:if(this.mixStorePolicy.s3Policy){Gr.next=21;break}throw new Error("dont get s3 policy");case 21:return Fe={accessKeyId:_.accessKeyId,secretAccessKey:_.secretAccessKey,sessionToken:_.sessionToken,region:_.region,maxRetries:this.mixStorePolicy.s3Policy.uploadConfig.retryPolicy.retry},Et=this.s3,(sr=new Et).config.update(Fe),fr=decodeURIComponent(_.bucket),Sr=decodeURIComponent(_.objectName),Pr={Bucket:fr,Key:Sr,Body:Tr=de,Metadata:{token:_.token},ContentType:Tr.type||"application/octet-stream"},this.core.logger.debug("uploadFile:: s3 upload params:",Pr),Lr=sr.upload(Pr),Gr.abrupt("return",new ro(function(Mn){var Qr=new Date().getTime();Lr.send(function(Vn,Bn){var Eo,jn;if(Vn){jr.logger.error("uploadFile:","api::s3:upload file failed",Vn),jr.core.reporter.reportTraceStart("exceptions",{user_id:jr.core.options.account,trace_id:(jn=(Eo=jr.core)===null||Eo===void 0?void 0:Eo.socket)===null||jn===void 0?void 0:jn.sessionId,start_time:Qr,action:1}),jr.core.reporter.reportTraceUpdateV2("exceptions",{code:typeof Vn.status=="number"?Vn.status:typeof Vn.code=="number"?Vn.code:0,description:Vn.message||""+Vn.code,operation_type:1,target:Vn.hostname}),jr.core.reporter.reportTraceEnd("exceptions",1);try{jr._addCircuitTimer()}catch(Cn){throw new Cc("upload file error",Cn,jr.curProvider,jr.mixStorePolicy,A.file||A.filePath)}Mn(jr.uploadFile(A))}else{var wr=jr.mixStorePolicy.s3Policy.cdnSchema;wr=(wr=wr.replace("{cdnDomain}",jr.mixStorePolicy.s3Policy.dlcdn)).replace("{objectName}",Bn.Key),Mn({size:Tr.size,name:Tr.name,url:_.shortUrl?_.shortUrl:wr,ext:Tr.name.split(".")[1]||"unknown"})}})}));case 32:case"end":return Gr.stop()}},Y,this)}))},w.getPrivateUrl=function(A){var _;if(!new RegExp(/http(s)?:\/\/([\w-]+\.)+[\w-]+(\/[\w- ./?%&=]*)?/).test(A))return this.logger.error("illegal file url:"+A),"";var Y=/^(?:([A-Za-z]+):)?(\/{0,3})([0-9.\-A-Za-z]+)(?::(\d+))?(?:\/([^?#]*))?(?:\?([^#]*))?(?:#(.*))?$/.exec(A);Y[0];var de=Y[1];Y[2];var V=Y[3];Y[4];var Fe=Y[5];if(Y[6],Y[7],(_=this.grayConfig)===null||_===void 0?void 0:_.mixStoreEnable){var Et=this._getUrlType(A);return Et===Vs.s3&&this.mixStorePolicy.s3Policy&&(A=this.mixStorePolicy.s3Policy.cdnSchema.replace("{cdnDomain}",this.mixStorePolicy.s3Policy.dlcdn).replace("{objectName}",Fe)),Et===Vs.nos&&this.mixStorePolicy.nosPolicy&&(A=this.mixStorePolicy.nosPolicy.cdnSchema.replace("{cdnDomain}",this.mixStorePolicy.nosPolicy.dlcdn).replace("{objectName}",Fe)),A}var sr=this.config,fr=sr.downloadUrl,Sr=sr.downloadHostList,Tr=sr.nosCdnEnable,Pr=this.config.cdn.cdnDomain,Lr=this.config.cdn.objectNamePrefix?decodeURIComponent(this.config.cdn.objectNamePrefix):"",jr=decodeURIComponent(Fe),Jr=ai(jr).call(jr,Lr);if(Pr&&Jr>-1&&Tr)return""+de+Pr+"/"+fo(jr).call(jr,Jr);if(ha(Sr).call(Sr,V)&&ha(Fe).call(Fe,"/")){var Gr=ai(Fe).call(Fe,"/"),Mn=Fe.substring(0,Gr),Qr=Fe.substring(Gr+1);return fr.replace("{bucket}",Mn).replace("{object}",Qr)}var Vn=Ys(Sr).call(Sr,function(Eo){return typeof V=="string"&&ha(V).call(V,Eo)})[0],Bn=Vn?V.replace(Vn,"").replace(/\W/g,""):null;return Bn?fr.replace("{bucket}",Bn).replace("{object}",Fe):A},w.getOriginUrl=function(A){return kr(this,void 0,void 0,rr.mark(function _(){var Y;return rr.wrap(function(V){for(;;)switch(V.prev=V.next){case 0:return V.next=2,this.core.sendCmd("getOriginUrl",{nosSafeUrlTag:{safeUrl:A}});case 2:return Y=V.sent,V.abrupt("return",Y.content.nosSafeUrlTag.originUrl);case 4:case"end":return V.stop()}},_,this)}))},w.getFileToken=function(A){return kr(this,void 0,void 0,rr.mark(function _(){var Y,de,V,Fe,Et,sr=this;return rr.wrap(function(Sr){for(;;)switch(Sr.prev=Sr.next){case 0:if(zr({type:{type:"number",min:2,max:3},urls:{type:"array",required:!1,itemType:"string"}},A),Y=this.mixStorePolicy.nosPolicy?this.mixStorePolicy.nosPolicy.authPolicy.policyType:null,de=this.mixStorePolicy.s3Policy?this.mixStorePolicy.s3Policy.authPolicy.policyType:null,Y!==String(ja.dontNeed)||de!==String(ja.dontNeed)){Sr.next=8;break}throw this.logger.error("don't need token"),new Error("don't need token");case 8:if(A.type!==ja.time){Sr.next=17;break}if(!(Y&&ai(Y).call(Y,String(ja.time))>=0||de&&ai(de).call(de,String(ja.time))>0)){Sr.next=13;break}return Sr.abrupt("return",this.getFileAuthToken(A));case 13:throw this.logger.error("don't support time token "),new Error("don't support type time token ");case 15:Sr.next=33;break;case 17:if(A.urls&&A.urls.length){Sr.next=20;break}throw this.logger.error("urls is required when urls token"),new Error("urls is required when urls token");case 20:if(Fe=[],Et=[],kn(V=A.urls).call(V,function(Tr){var Pr=sr._getUrlType(Tr);Pr===Vs.nos&&Et.push(Tr),Pr===Vs.s3&&Fe.push(Tr)}),(!de||Fe.length!==0&&ai(de).call(de,String(ja.urls))<0)&&(this.logger.warn("s3 url don't support url token"),Fe=[]),(!Y||Et.length!==0&&ai(Y).call(Y,String(ja.urls))<0)&&(this.logger.warn("nos url don't support url token"),Et=[]),Fe.length!==0||Et.length!==0){Sr.next=30;break}throw this.logger.error("not support urls"),new Error("not support urls");case 30:if(Fe.length!==0&&Et.length!==0){Sr.next=33;break}return A.urls=so(A.urls),Sr.abrupt("return",this.getFileAuthToken(A));case 33:case"end":return Sr.stop()}},_,this)}))},w.getFileAuthToken=function(A){return kr(this,void 0,void 0,rr.mark(function _(){var Y;return rr.wrap(function(V){for(;;)switch(V.prev=V.next){case 0:return V.next=2,this.core.sendCmd("getFileAuthToken",{mixStoreAuthTokenReqTag:A});case 2:return Y=V.sent,V.abrupt("return",Y.content.mixStoreAuthTokenResTag);case 4:case"end":return V.stop()}},_,this)}))},w._getUrlType=function(A){var _,Y;return this.mixStorePolicy.nosPolicy&&Bp(_=this.mixStorePolicy.nosPolicy.dlcdns).call(_,function(de){return ai(A).call(A,de)>=0})?Vs.nos:this.mixStorePolicy.s3Policy&&Bp(Y=this.mixStorePolicy.s3Policy.dlcdns).call(Y,function(de){return ai(A).call(A,de)>=0})?Vs.s3:null},w._addCircuitTimer=function(){var A=this,_=this.mixStorePolicy.providers,Y=_[(ai(_).call(_,String(this.curProvider))+1)%_.length];if(Y===_[0])throw new Error("uploadFile all policy fail");var de=Vi(this.mixStorePolicy,"s3Policy.uploadConfig.retryPolicy");if(de&&de.retryNext&&Y&&(this.logger.log("uploadFile:: upload policy will change,now policy:"+this.curProvider+" nextProvider:"+Y),this.curProvider=wo(Y),this.mixStorePolicy.nosPolicy&&this.mixStorePolicy.s3Policy)){var V=this.mixStorePolicy[this.curProvider===Vs.nos?"nosPolicy":"s3Policy"].uploadConfig.retryPolicy.circuit;if(!V||V===0)return;this.circuitTimer=this.core.timerManager.addTimer(function(){A.logger.log("uploadFile:: upload policy will change,now policy:"+A.curProvider+" nextProvider:"+wo(A.mixStorePolicy.providers[0])),A.curProvider=wo(A.mixStorePolicy.providers[0]),A.core.timerManager.deleteTimer(A.circuitTimer)},1e3*V)}},w.process=function(A){var _=this[A.cmd+"Handler"];return typeof _=="function"?_.call(this,A):A.error&&!A.error.ignore?ro.reject(A.error):ro.resolve(A)},b}(),Pd=Math.floor,Wp=function(b,w){var $=b.length,A=Pd($/2);return $<8?Sv(b,w):bS(b,Wp(Tl(b,0,A),w),Wp(Tl(b,A),w),w)},Sv=function(b,w){for(var $,A,_=b.length,Y=1;Y<_;){for(A=Y,$=b[Y];A&&w(b[A-1],$)>0;)b[A]=b[--A];A!==Y++&&(b[A]=$)}return b},bS=function(b,w,$,A){for(var _=w.length,Y=$.length,de=0,V=0;de<_||V<Y;)b[de+V]=de<_&&V<Y?A(w[de],$[V])<=0?w[de++]:$[V++]:de<_?w[de++]:$[V++];return b},Ju=Wp,Mv=cr.match(/firefox\/(\d+)/i),uc=!!Mv&&+Mv[1],os=/MSIE|Trident/.test(cr),Cv=cr.match(/AppleWebKit\/(\d+)\./),kv=!!Cv&&+Cv[1],lc=[],Yu=re(lc.sort),TS=re(lc.push),xv=u(function(){lc.sort(void 0)}),SS=u(function(){lc.sort(null)}),wv=Ds("sort"),kh=!u(function(){if(gr)return gr<70;if(!(uc&&uc>3)){if(os)return!0;if(kv)return kv<603;var b,w,$,A,_="";for(b=65;b<76;b++){switch(w=String.fromCharCode(b),b){case 66:case 69:case 70:case 72:$=3;break;case 68:case 71:$=4;break;default:$=2}for(A=0;A<47;A++)lc.push({k:w+A,v:$})}for(lc.sort(function(Y,de){return de.v-Y.v}),A=0;A<lc.length;A++)w=lc[A].k.charAt(0),_.charAt(_.length-1)!==w&&(_+=w);return _!=="DGBEFHACIJK"}});qr({target:"Array",proto:!0,forced:xv||!SS||!wv||!kh},{sort:function(w){w!==void 0&&Or(w);var $=An(this);if(kh)return w===void 0?Yu($):Yu($,w);var A,_,Y=[],de=Ci($);for(_=0;_<de;_++)_ in $&&TS(Y,$[_]);for(Ju(Y,function(V){return function(Fe,Et){return Et===void 0?-1:Fe===void 0?1:V!==void 0?+V(Fe,Et)||0:_i(Fe)>_i(Et)?1:-1}}(w)),A=Ci(Y),_=0;_<A;)$[_]=Y[_++];for(;_<de;)Rp($,_++);return $}});var Ac,Sa,Gp,Ba=Ao("Array").sort,Ad=Array.prototype,Xu=function(b){var w=b.sort;return b===Ad||Lt(Ad,b)&&w===Ad.sort?Ba:w};(function(b){b[b.ASC=1]="ASC",b[b.DESC=2]="DESC"})(Ac||(Ac={})),function(b){b[b.reorderWeight=0]="reorderWeight",b[b.createTime=1]="createTime",b[b.totalMember=2]="totalMember"}(Sa||(Sa={})),function(b){b[b.square=1]="square",b[b.person=2]="person"}(Gp||(Gp={}));var vu=function(){function b(w,$){this.name=w,this.core=$,this.name=w,this.logger=$.logger,this.core=$}return b.prototype.process=function($){var A=this[$.cmd+"Handler"];return typeof A=="function"?A.call(this,$):$.error&&!$.error.ignore?ro.reject($.error):ro.resolve($)},b}(),Od={"24_15":"qchatSubscribe","24_27":"qchatGetUnreadInfo","24_48":"qchatCreateChannel","24_49":"qchatDeleteChannel","24_50":"qchatUpdateChannel","24_51":"qchatGetChannels","24_52":"qchatGetChannelsByPage","24_53":"qchatGetMembersByPage","24_54":"qchatUpdateWhiteBlackRole","24_55":"qchatGetWhiteBlackRolesPage","24_56":"qchatUpdateWhiteBlackMembers","24_57":"qchatGetWhiteBlackMembersPage","24_58":"qchatGetExistingWhiteBlackRoles","24_59":"qchatGetExistingWhiteBlackMembers","24_60":"qchatUpdateCategoryInfoOfChannel","24_109":"qchatCreateChannelCategory","24_110":"qchatRemoveChannelCategory","24_111":"qchatUpdateChannelCategory","24_112":"qchatGetChannelCategoriesByID","24_113":"qchatUpdateChannelCategoryWhiteBlackRole","24_114":"qchatGetChannelCategoryWhiteBlackRolesPage","24_115":"qchatUpdateChannelCategoryWhiteBlackMembers","24_116":"qchatGetChannelCategoryWhiteBlackMembersPage","24_117":"qchatGetChannelCategoryWhiteBlackRoles","24_118":"qchatGetChannelCategoryWhiteBlackMembers","24_119":"qchatGetChannelCategoriesPage","24_120":"qchatGetChannelCategoryChannelsPage","24_93":"qchatGetChannelSearchByPage","24_95":"qchatChannelMemberSearch","25_8":"qchatGetRoleIdsByServerId","25_9":"qchatSubscribeAsVisitor"},xh={serverId:1,channelId:2,ackTimestamp:3,unreadCount:4,mentionedCount:5,maxCount:6,lastMsgTime:7},Vo={channelInfo:{channelId:1,serverId:2,name:4,topic:5,ext:6,type:7,validFlag:8,createTime:9,updateTime:10,owner:11,viewMode:12,categoryId:13,syncMode:14,reorderWeight:15,visitorMode:16},antispamTag:{antiSpamBusinessId:1},memberInfo:{serverId:1,accid:3,nick:4,avatar:5,ext:6,type:7,joinTime:8,inviter:9,validFlag:10,createTime:11,updateTime:12},serverRole:{serverId:1,roleId:2,name:3,icon:4,ext:5,auths:6,type:7,memberCount:8,priority:9,createTime:10,updateTime:11},qchatSubReqTag:{type:1,opeType:2},qchatChannelIdInfoTag:{serverId:1,channelId:2},unreadInfo:xh,qchatGetChannelListPageTag:{serverId:1,timetag:2,limit:3},qchatGetMembersByPageTag:{serverId:1,channelId:2,timetag:3,limit:4},qchatUpdateWhiteBlackRoleTag:{serverId:1,channelId:2,type:3,opeType:4,roleId:5},qchatGetWhiteBlackRolesPageTag:{serverId:1,channelId:2,type:3,timetag:4,limit:5},qchatUpdateWhiteBlackMembersTag:{serverId:1,channelId:2,type:3,opeType:4,toAccids:5},qchatGetWhiteBlackMembersPageTag:{serverId:1,channelId:2,type:3,timetag:4,limit:5},qchatGetExistingWhiteBlackRolesTag:{serverId:1,channelId:2,type:3,roleIds:4},qchatGetExistingWhiteBlackMembersTag:{serverId:1,channelId:2,type:3,accids:4},QChatChannelCategoryInfo:{categoryId:1,serverId:2,name:4,ext:5,owner:6,viewMode:7,validFlag:8,createTime:9,updateTime:10,channelNumber:11},qchatUpdateChannelCategoryWhiteBlackRoleTag:{serverId:1,categoryId:2,type:3,opeType:4,roleId:5},qchatGetChannelCategoryWhiteBlackRolesPageTag:{serverId:1,categoryId:2,type:3,timetag:4,limit:5},qchatUpdateChannelCategoryWhiteBlackMembersTag:{serverId:1,categoryId:2,type:3,opeType:4,toAccids:5},qchatGetChannelCategoryWhiteBlackMembersPageTag:{serverId:1,categoryId:2,type:3,timetag:4,limit:5},qchatGetChannelCategoryWhiteBlackRolesTag:{serverId:1,categoryId:2,type:3,roleIds:4},qchatGetChannelCategoryWhiteBlackMembersTag:{serverId:1,categoryId:2,type:3,accids:4},qchatGetChannelCategoriesPageTag:{serverId:1,timetag:2,limit:3},qchatGetChannelCategoryChannelsPageTag:{serverId:1,categoryId:2,timetag:3,limit:4},qchatGetChannelSearchByPageTag:{keyword:1,startTime:2,endTime:3,order:4,limit:5,serverId:6,sort:7,cursor:8},qchatUpdateChannelTag:{channelId:1,name:4,topic:5,ext:6,viewMode:12,visitorMode:16},serverRoles:{serverId:1,roleIds:2,timeTag:3},qchatChannelMemberSearchTag:{serverId:1,channelId:2,keyword:3,limit:4},qchatChannelMemberInfo:{serverId:1,channelId:2,avatar:3,accid:4,nick:5,createTime:6,updateTime:7}},jo=xc(Vo),wh={qchatCreateChannel:{sid:24,cid:48,service:"qchatChannel",params:[{type:"Property",name:"channelInfo",reflectMapper:Vo.channelInfo},{type:"Property",name:"antispamTag",reflectMapper:Vo.antispamTag}],response:[{type:"Property",name:"channelInfo",reflectMapper:jo.channelInfo}]},qchatDeleteChannel:{sid:24,cid:49,service:"qchatChannel",params:[{type:"Long",name:"channelId"}]},qchatUpdateChannel:{sid:24,cid:50,service:"qchatChannel",params:[{type:"Property",name:"channelInfo",reflectMapper:Vo.qchatUpdateChannelTag},{type:"Property",name:"antispamTag",reflectMapper:Vo.antispamTag}],response:[{type:"Property",name:"channelInfo",reflectMapper:jo.channelInfo}]},qchatGetChannels:{sid:24,cid:51,service:"qchatChannel",params:[{type:"LongArray",name:"channelIds"}],response:[{type:"PropertyArray",name:"channelList",reflectMapper:jo.channelInfo}]},qchatGetChannelsByPage:{sid:24,cid:52,service:"qchatChannel",params:[{type:"Property",name:"qchatGetChannelListPageTag",reflectMapper:Vo.qchatGetChannelListPageTag}],response:[{type:"Property",name:"listQueryTag",reflectMapper:{1:"hasMore",2:"nextTimetag"}},{type:"PropertyArray",name:"datas",reflectMapper:jo.channelInfo}]},qchatGetMembersByPage:{sid:24,cid:53,service:"qchatChannel",params:[{type:"Property",name:"qchatGetMembersByPageTag",reflectMapper:Vo.qchatGetMembersByPageTag}],response:[{type:"Property",name:"listQueryTag",reflectMapper:{1:"hasMore",2:"nextTimetag"}},{type:"PropertyArray",name:"datas",reflectMapper:jo.memberInfo}]},qchatUpdateWhiteBlackRole:{sid:24,cid:54,service:"qchatChannel",params:[{type:"Property",name:"qchatUpdateWhiteBlackRoleTag",reflectMapper:Vo.qchatUpdateWhiteBlackRoleTag}],response:[{type:"Property",name:"listQueryTag",reflectMapper:{1:"hasMore",2:"nextTimetag"}},{type:"PropertyArray",name:"datas",reflectMapper:jo.memberInfo}]},qchatGetWhiteBlackRolesPage:{sid:24,cid:55,service:"qchatChannel",params:[{type:"Property",name:"qchatGetWhiteBlackRolesPageTag",reflectMapper:Vo.qchatGetWhiteBlackRolesPageTag}],response:[{type:"Property",name:"listQueryTag",reflectMapper:{1:"hasMore",2:"nextTimetag"}},{type:"PropertyArray",name:"datas",reflectMapper:jo.serverRole}]},qchatUpdateWhiteBlackMembers:{sid:24,cid:56,service:"qchatChannel",params:[{type:"Property",name:"qchatUpdateWhiteBlackMembersTag",reflectMapper:Vo.qchatUpdateWhiteBlackMembersTag}]},qchatGetWhiteBlackMembersPage:{sid:24,cid:57,service:"qchatChannel",params:[{type:"Property",name:"qchatGetWhiteBlackMembersPageTag",reflectMapper:Vo.qchatGetWhiteBlackMembersPageTag}],response:[{type:"Property",name:"listQueryTag",reflectMapper:{1:"hasMore",2:"nextTimetag"}},{type:"PropertyArray",name:"datas",reflectMapper:jo.memberInfo}]},qchatGetExistingWhiteBlackRoles:{sid:24,cid:58,service:"qchatChannel",params:[{type:"Property",name:"qchatGetExistingWhiteBlackRolesTag",reflectMapper:Vo.qchatGetExistingWhiteBlackRolesTag}],response:[{type:"PropertyArray",name:"datas",reflectMapper:jo.serverRole}]},qchatGetExistingWhiteBlackMembers:{sid:24,cid:59,service:"qchatChannel",params:[{type:"Property",name:"qchatGetExistingWhiteBlackMembersTag",reflectMapper:Vo.qchatGetExistingWhiteBlackMembersTag}],response:[{type:"PropertyArray",name:"datas",reflectMapper:jo.memberInfo}]},qchatUpdateCategoryInfoOfChannel:{sid:24,cid:60,service:"qchatChannel",params:[{type:"Property",name:"qchatUpdateCategoryInfoOfChannelTag",reflectMapper:Vo.channelInfo}],response:[{type:"Property",name:"channelInfo",reflectMapper:jo.channelInfo}]},qchatCreateChannelCategory:{sid:24,cid:109,service:"qchatChannel",params:[{type:"Property",name:"qchatCreateChannelCategoryTag",reflectMapper:Vo.QChatChannelCategoryInfo}],response:[{type:"Property",name:"QChatChannelCategoryInfo",reflectMapper:jo.QChatChannelCategoryInfo}]},qchatRemoveChannelCategory:{sid:24,cid:110,service:"qchatChannel",params:[{type:"Long",name:"categoryId"}]},qchatUpdateChannelCategory:{sid:24,cid:111,service:"qchatChannel",params:[{type:"Property",name:"qchatUpdateChannelCategoryTag",reflectMapper:Vo.QChatChannelCategoryInfo}],response:[{type:"Property",name:"QChatChannelCategoryInfo",reflectMapper:jo.QChatChannelCategoryInfo}]},qchatGetChannelCategoriesByID:{sid:24,cid:112,service:"qchatChannel",params:[{type:"LongArray",name:"categoryIds"}],response:[{type:"PropertyArray",name:"channelCategoryList",reflectMapper:jo.QChatChannelCategoryInfo}]},qchatUpdateChannelCategoryWhiteBlackRole:{sid:24,cid:113,service:"qchatChannel",params:[{type:"Property",name:"qchatUpdateChannelCategoryWhiteBlackRoleTag",reflectMapper:Vo.qchatUpdateChannelCategoryWhiteBlackRoleTag}]},qchatGetChannelCategoryWhiteBlackRolesPage:{sid:24,cid:114,service:"qchatChannel",params:[{type:"Property",name:"qchatGetChannelCategoryWhiteBlackRolesPageTag",reflectMapper:Vo.qchatGetChannelCategoryWhiteBlackRolesPageTag}],response:[{type:"Property",name:"listQueryTag",reflectMapper:{1:"hasMore",2:"nextTimetag"}},{type:"PropertyArray",name:"datas",reflectMapper:jo.serverRole}]},qchatUpdateChannelCategoryWhiteBlackMembers:{sid:24,cid:115,service:"qchatChannel",params:[{type:"Property",name:"qchatUpdateChannelCategoryWhiteBlackMembersTag",reflectMapper:Vo.qchatUpdateChannelCategoryWhiteBlackMembersTag}]},qchatGetChannelCategoryWhiteBlackMembersPage:{sid:24,cid:116,service:"qchatChannel",params:[{type:"Property",name:"qchatGetChannelCategoryWhiteBlackMembersPageTag",reflectMapper:Vo.qchatGetChannelCategoryWhiteBlackMembersPageTag}],response:[{type:"Property",name:"listQueryTag",reflectMapper:{1:"hasMore",2:"nextTimetag"}},{type:"PropertyArray",name:"datas",reflectMapper:jo.memberInfo}]},qchatGetChannelCategoryWhiteBlackRoles:{sid:24,cid:117,service:"qchatChannel",params:[{type:"Property",name:"qchatGetChannelCategoryWhiteBlackRolesTag",reflectMapper:Vo.qchatGetChannelCategoryWhiteBlackRolesTag}],response:[{type:"PropertyArray",name:"datas",reflectMapper:jo.serverRole}]},qchatGetChannelCategoryWhiteBlackMembers:{sid:24,cid:118,service:"qchatChannel",params:[{type:"Property",name:"qchatGetChannelCategoryWhiteBlackMembersTag",reflectMapper:Vo.qchatGetChannelCategoryWhiteBlackMembersTag}],response:[{type:"PropertyArray",name:"datas",reflectMapper:jo.memberInfo}]},qchatGetChannelCategoriesPage:{sid:24,cid:119,service:"qchatChannel",params:[{type:"Property",name:"qchatGetChannelCategoriesPageTag",reflectMapper:Vo.qchatGetChannelCategoriesPageTag}],response:[{type:"Property",name:"listQueryTag",reflectMapper:{1:"hasMore",2:"nextTimetag"}},{type:"PropertyArray",name:"datas",reflectMapper:jo.QChatChannelCategoryInfo}]},qchatGetChannelCategoryChannelsPage:{sid:24,cid:120,service:"qchatChannel",params:[{type:"Property",name:"qchatGetChannelCategoryChannelsPageTag",reflectMapper:Vo.qchatGetChannelCategoryChannelsPageTag}],response:[{type:"Property",name:"listQueryTag",reflectMapper:{1:"hasMore",2:"nextTimetag"}},{type:"PropertyArray",name:"datas",reflectMapper:jo.channelInfo}]},qchatSubscribe:{sid:24,cid:15,service:"qchatChannel",params:[{type:"Property",name:"qchatSubReqTag",reflectMapper:Vo.qchatSubReqTag},{type:"PropertyArray",name:"channels",reflectMapper:Vo.qchatChannelIdInfoTag}],response:[{type:"PropertyArray",name:"unreadInfos",reflectMapper:jo.unreadInfo},{type:"PropertyArray",name:"failedChannels",reflectMapper:jo.qchatChannelIdInfoTag}]},qchatGetUnreadInfo:{sid:24,cid:27,service:"qchatChannel",params:[{type:"PropertyArray",name:"channels",reflectMapper:Vo.qchatChannelIdInfoTag}],response:[{type:"PropertyArray",name:"unreadInfos",reflectMapper:jo.unreadInfo}]},qchatGetChannelSearchByPage:{sid:24,cid:93,service:"qchatChannel",params:[{type:"Property",name:"qchatGetChannelSearchByPageTag",reflectMapper:Vo.qchatGetChannelSearchByPageTag}],response:[{type:"Property",name:"listQueryTag",reflectMapper:{1:"hasMore",2:"nextTimetag",3:"cursor"}},{type:"PropertyArray",name:"datas",reflectMapper:jo.channelInfo}]},qchatGetRoleIdsByServerId:{sid:25,cid:8,service:"qchatChannel",params:[{type:"Property",name:"qchatGetRoleIdsByServerIdTag",reflectMapper:{serverIdTimeTags:1}}],response:[{type:"PropertyArray",name:"serverRoles",reflectMapper:jo.serverRoles},{type:"LongArray",name:"failServerIds"}]},qchatChannelMemberSearch:{sid:24,cid:95,service:"qchatChannel",params:[{type:"Property",name:"qchatChannelMemberSearchTag",reflectMapper:Vo.qchatChannelMemberSearchTag}],response:[{type:"PropertyArray",name:"datas",reflectMapper:jo.qchatChannelMemberInfo}]},qchatSubscribeAsVisitor:{sid:25,cid:9,service:"qchatChannel",params:[{type:"Property",name:"tag",reflectMapper:Vo.qchatSubReqTag},{type:"PropertyArray",name:"datas",reflectMapper:Vo.qchatChannelIdInfoTag}],response:[{type:"PropertyArray",name:"failedArr",reflectMapper:jo.qchatChannelIdInfoTag}]}},Iv={"24_31":"qchatCreateServer","24_32":"qchatDeleteServer","24_33":"qchatUpdateServer","24_34":"qchatGetServers","24_35":"qchatGetServersByPage","24_36":"qchatInviteServerMembers","24_37":"qchatAcceptServerInvite","24_38":"qchatRejectInviteServer","24_39":"qchatApplyServerJoin","24_40":"qchatAcceptServerApply","24_41":"qchatRejectServerApply","24_42":"qchatKickServerMembers","24_43":"qchatLeaveServer","24_44":"qchatUpdateMyMemberInfo","24_45":"qchatUpdateServerMemberInfo","24_46":"qchatGetServerMembers","24_47":"qchatGetServerMembersByPage","24_104":"qchatUpdateServerMemberBan","24_105":"qchatGetBannedMembersByPage","24_91":"qchatServerSearchByPage","24_92":"qchatServerMemberSearchByPage","24_122":"qchatGenerateInviteCode","24_123":"qchatJoinByInviteCode","24_124":"qchatGetInviteApplyRecordOfServer","24_125":"qchatGetInviteApplyRecordOfSelf","25_5":"qchatClearServersUnread","25_7":"qchatSubscribeChannelsByServers","25_10":"qchatEnterAsVisitor","25_11":"qchatLeaveAsVisitor"},qi={serverInfo:{serverId:1,name:3,icon:4,ext:5,owner:6,memberNumber:7,inviteMode:8,applyMode:9,validFlag:10,createTime:11,updateTime:12,channelNumber:13,categoryNumber:14,searchType:15,searchEnable:16,reorderWeight:17},antispamTag:{antiSpamBusinessId:1},memberInfo:{serverId:1,accid:3,nick:4,avatar:5,ext:6,type:7,joinTime:8,inviter:9,validFlag:10,createTime:11,updateTime:12},otherMemberInfo:{serverId:1,accid:3,nick:4,avatar:5,type:7,joinTime:8,inviter:9,validFlag:10,createTime:11,updateTime:12},getServerListPageTag:{timestamp:1,limit:2},getServerMemberListPageTag:{serverId:1,timetag:2,limit:3},updateServerMemberBanTag:{serverId:1,opeType:2,accid:3,ext:4},getBannedMembersByPageTag:{serverId:1,timetag:2,limit:3},serverMemberBanInfo:{serverId:1,appid:2,accid:3,ext:4,banTime:5,validFlag:6,createTime:7,updateTime:8},serverSearchByPageTag:{keyword:1,startTime:2,endTime:3,order:4,limit:5,serverType:6,searchType:7,sort:8,cursor:9},serverMemberSearchByPageTag:{serverId:1,keyword:3,limit:4},inviteRespParamTag:{requestId:1},applyRespParamTag:{requestId:1,expireTime:2},inviteApplyRecord:{accid:1,type:2,serverId:3,status:4,requestId:5,createTime:6,updateTime:7,expireTime:8,data:9,recordId:10},clearServersUnreadTag:{successServerIds:1,failServerIds:2,ackTimestamp:3},unreadInfo:xh},Ni=xc(qi),Oc={qchatCreateServer:{sid:24,cid:31,service:"qchatServer",params:[{type:"Property",name:"serverInfo",reflectMapper:qi.serverInfo},{type:"Property",name:"antispamTag",reflectMapper:qi.antispamTag}],response:[{type:"Property",name:"serverInfo",reflectMapper:Ni.serverInfo}]},qchatDeleteServer:{sid:24,cid:32,service:"qchatServer",params:[{type:"Long",name:"serverId"}]},qchatUpdateServer:{sid:24,cid:33,service:"qchatServer",params:[{type:"Property",name:"serverInfo",reflectMapper:qi.serverInfo},{type:"Property",name:"antispamTag",reflectMapper:qi.antispamTag}],response:[{type:"Property",name:"serverInfo",reflectMapper:Ni.serverInfo}]},qchatGetServers:{sid:24,cid:34,service:"qchatServer",params:[{type:"LongArray",name:"serverIds"}],response:[{type:"PropertyArray",name:"serverList",reflectMapper:Ni.serverInfo}]},qchatGetServersByPage:{sid:24,cid:35,service:"qchatServer",params:[{type:"Property",name:"tag",reflectMapper:qi.getServerListPageTag}],response:[{type:"Property",name:"listQueryTag",reflectMapper:{1:"hasMore",2:"nextTimetag"}},{type:"PropertyArray",name:"datas",reflectMapper:Ni.serverInfo}]},qchatInviteServerMembers:{sid:24,cid:36,service:"qchatServer",params:[{type:"Long",name:"serverId"},{type:"StrArray",name:"accids"},{type:"String",name:"ps"},{type:"Property",name:"params",reflectMapper:{ttl:1}}],response:[{type:"StrArray",name:"failByOverAccids"},{type:"StrArray",name:"failByBanAccids"},{type:"Property",name:"record",reflectMapper:Ni.applyRespParamTag}]},qchatAcceptServerInvite:{sid:24,cid:37,service:"qchatServer",params:[{type:"Long",name:"serverId"},{type:"String",name:"accid"},{type:"Property",name:"recordInfo",reflectMapper:qi.inviteRespParamTag}]},qchatRejectInviteServer:{sid:24,cid:38,service:"qchatServer",params:[{type:"Long",name:"serverId"},{type:"String",name:"accid"},{type:"String",name:"ps"},{type:"Property",name:"recordInfo",reflectMapper:qi.inviteRespParamTag}]},qchatApplyServerJoin:{sid:24,cid:39,service:"qchatServer",params:[{type:"Long",name:"serverId"},{type:"String",name:"ps"},{type:"Property",name:"params",reflectMapper:{ttl:1}}],response:[{type:"Property",name:"data",reflectMapper:Ni.applyRespParamTag}]},qchatAcceptServerApply:{sid:24,cid:40,service:"qchatServer",params:[{type:"Long",name:"serverId"},{type:"String",name:"accid"},{type:"Property",name:"recordInfo",reflectMapper:qi.applyRespParamTag}]},qchatRejectServerApply:{sid:24,cid:41,service:"qchatServer",params:[{type:"Long",name:"serverId"},{type:"String",name:"accid"},{type:"String",name:"ps"},{type:"Property",name:"recordInfo",reflectMapper:qi.applyRespParamTag}]},qchatKickServerMembers:{sid:24,cid:42,service:"qchatServer",params:[{type:"Long",name:"serverId"},{type:"StrArray",name:"accids"}]},qchatLeaveServer:{sid:24,cid:43,service:"qchatServer",params:[{type:"Long",name:"serverId"}]},qchatUpdateMyMemberInfo:{sid:24,cid:44,service:"qchatServer",params:[{type:"Property",name:"memberInfo",reflectMapper:qi.memberInfo},{type:"Property",name:"antispamTag",reflectMapper:qi.antispamTag}],response:[{type:"Property",name:"memberInfo",reflectMapper:Ni.memberInfo}]},qchatUpdateServerMemberInfo:{sid:24,cid:45,service:"qchatServer",params:[{type:"Property",name:"memberInfo",reflectMapper:qi.otherMemberInfo},{type:"Property",name:"antispamTag",reflectMapper:qi.antispamTag}],response:[{type:"Property",name:"memberInfo",reflectMapper:Ni.memberInfo}]},qchatGetServerMembers:{sid:24,cid:46,service:"qchatServer",params:[{type:"StrArray",name:"accids"}],response:[{type:"PropertyArray",name:"accidList",reflectMapper:Ni.memberInfo}]},qchatGetServerMembersByPage:{sid:24,cid:47,service:"qchatServer",params:[{type:"Property",name:"tag",reflectMapper:qi.getServerMemberListPageTag}],response:[{type:"Property",name:"listQueryTag",reflectMapper:{1:"hasMore",2:"nextTimetag"}},{type:"PropertyArray",name:"datas",reflectMapper:Ni.memberInfo}]},qchatUpdateServerMemberBan:{sid:24,cid:104,service:"qchatServer",params:[{type:"Property",name:"tag",reflectMapper:qi.updateServerMemberBanTag}]},qchatGetBannedMembersByPage:{sid:24,cid:105,service:"qchatServer",params:[{type:"Property",name:"tag",reflectMapper:qi.getBannedMembersByPageTag}],response:[{type:"Property",name:"listQueryTag",reflectMapper:{1:"hasMore",2:"nextTimetag"}},{type:"PropertyArray",name:"datas",reflectMapper:Ni.serverMemberBanInfo}]},qchatServerSearchByPage:{sid:24,cid:91,service:"qchatServer",params:[{type:"Property",name:"tag",reflectMapper:qi.serverSearchByPageTag}],response:[{type:"Property",name:"listQueryTag",reflectMapper:{1:"hasMore",2:"nextTimetag",3:"cursor"}},{type:"PropertyArray",name:"datas",reflectMapper:Ni.serverInfo}]},qchatServerMemberSearchByPage:{sid:24,cid:92,service:"qchatServer",params:[{type:"Property",name:"tag",reflectMapper:qi.serverMemberSearchByPageTag}],response:[{type:"PropertyArray",name:"members",reflectMapper:Ni.serverMemberBanInfo}]},qchatGenerateInviteCode:{sid:24,cid:122,service:"qchatServer",params:[{type:"Property",name:"tag",reflectMapper:{serverId:1,ttl:2}}],response:[{type:"Property",name:"data",reflectMapper:{1:"serverId",2:"requestId",3:"inviteCode",4:"expireTime"}}]},qchatJoinByInviteCode:{sid:24,cid:123,service:"qchatServer",params:[{type:"Property",name:"tag",reflectMapper:{serverId:1,inviteCode:2,ps:3}}]},qchatGetInviteApplyRecordOfServer:{sid:24,cid:124,service:"qchatServer",params:[{type:"Property",name:"tag",reflectMapper:{serverId:1,fromTime:2,toTime:3,reverse:4,limit:5,cursor:6}}],response:[{type:"PropertyArray",name:"data",reflectMapper:Ni.inviteApplyRecord}]},qchatGetInviteApplyRecordOfSelf:{sid:24,cid:125,service:"qchatServer",params:[{type:"Property",name:"tag",reflectMapper:{fromTime:1,toTime:2,reverse:3,limit:4,cursor:5}}],response:[{type:"PropertyArray",name:"data",reflectMapper:Ni.inviteApplyRecord}]},qchatClearServersUnread:{sid:25,cid:5,service:"qchatServer",params:[{type:"LongArray",name:"serverIds"}],response:[{type:"Property",name:"clearServersUnreadTag",reflectMapper:Ni.clearServersUnreadTag}]},qchatSubscribeChannelsByServers:{sid:25,cid:7,service:"qchatServer",params:[{type:"int",name:"type"},{type:"LongArray",name:"serverIds"}],response:[{type:"PropertyArray",name:"unreadInfos",reflectMapper:Ni.unreadInfo},{type:"LongArray",name:"failServerIds"}]},qchatEnterAsVisitor:{sid:25,cid:10,service:"qchatServer",params:[{type:"Property",name:"tag",reflectMapper:{serverIds:1}}],response:[{type:"LongArray",name:"failServerIds"}]},qchatLeaveAsVisitor:{sid:25,cid:11,service:"qchatServer",params:[{type:"Property",name:"tag",reflectMapper:{serverIds:1}}],response:[{type:"LongArray",name:"failServerIds"}]}},is=Function.prototype,MS=Object.prototype,_v=is.toString,CS=MS.hasOwnProperty,kS=_v.call(Object),Kp=function(w){if(!as(w)||Js(w)!="[object Object]")return!1;var $=gv(w);if($===null)return!0;var A=CS.call($,"constructor")&&$.constructor;return typeof A=="function"&&A instanceof A&&_v.call(A)==kS};function pi(b,w){if(!Kp(w))return{};var $=JSON.parse(so(w)),A=Ev(b,$);return JSON.parse(so(Xr(Xr({},$),A)))}function Ev(b,w){if(!Kp(w))return{};var $={},A=Yo(b);return kn(A).call(A,function(_){var Y=b[_].type;if(typeof Y!="string"){var de=Ev(b[_],w);Yo(de).length>0&&($[_]=de)}else{var V=b[_],Fe=V.rawKey||_,Et=xS[Y](w,Fe,V);Et!==void 0&&(w[Fe]=void 0,$[_]=Et)}}),$}var xS={number:function(w,$){if(w[$]!==void 0)return+w[$]},string:function(w,$){if(w[$]!==void 0)return w[$]},boolean:function(w,$){return+w[$]>0||+w[$]!=0&&void 0},enum:function(w,$,A){return fp(A)[w[$]]},object:function(w,$){if(w[$]!==void 0)try{return JSON.parse(w[$])}catch{return{}}}};function Zu(b,w){if(!Kp(w))return{};var $=JSON.parse(so(w)),A=Pv(b,$);return JSON.parse(so(Xr(Xr({},$),A)))}function Pv(b,w){var $;if(!Kp(w))return kc($=Yo(b)).call($,function(Y,de){return Y[b[de].rawKey||de]=void 0,Y},{});var A={},_=Yo(b);return kn(_).call(_,function(Y){var de=b[Y].type;if(typeof de!="string"){var V=Pv(b[Y],w[Y]);return Xr(A,V),void(w[Y]=void 0)}var Fe=b[Y],Et=Fe.rawKey||Y,sr=Qp[de](w,Y,Fe);w[Et]=void 0,A[Et]=sr}),A}var Qp={number:function(w,$){return w[$]},string:function(w,$){return w[$]},boolean:function(w,$){return w[$]===!0?1:w[$]===!1?0:void 0},enum:function(w,$,A){return fp(A)[w[$]]},object:function(w,$){if(w[$]!==void 0)try{return so(w[$])}catch{return""}}},Ih=Qp,Av={serverId:{type:"string"},name:{type:"string"},icon:{type:"string"},ext:{type:"string"},owner:{type:"string"},memberNumber:{type:"number"},inviteMode:{type:"number"},applyMode:{type:"number"},validFlag:{type:"boolean"},createTime:{type:"number"},updateTime:{type:"number"},channelNumber:{type:"number"},categoryNumber:{type:"number"},searchType:{type:"number"},searchEnable:{type:"boolean"},reorderWeight:{type:"string"}},wS={serverId:{type:"string"},uid:{type:"string"},accid:{type:"string"},nick:{type:"string"},avatar:{type:"string"},ext:{type:"string"},type:{type:"number"},joinTime:{type:"number"},inviter:{type:"string"},validFlag:{type:"boolean"},createTime:{type:"number"},updateTime:{type:"number"}},IS={serverId:{type:"string"},appid:{type:"string"},accid:{type:"string"},ext:{type:"string"},banTime:{type:"number"},validFlag:{type:"boolean"},createTime:{type:"number"},updateTime:{type:"number"}};function Rd(b){return pi(Av,b)}function _h(b){return rs(b)&&b.length>0?co(b).call(b,function(w){return Rd(w)}):[]}function el(b){return pi(wS,b)}function dc(b){return rs(b)&&b.length>0?co(b).call(b,function(w){return el(w)}):[]}function _S(b){return rs(b)&&b.length>0?co(b).call(b,function(w){return function(A){return pi(IS,A)}(w)}):[]}function Rc(b){var w,$,A;if(!b.antispamTag)return{};var _=Xr({},b.antispamTag);return!((w=b.antispamTag)===null||w===void 0)&&w.antiSpamBusinessId&&typeof(($=b.antispamTag)===null||$===void 0?void 0:$.antiSpamBusinessId)!="string"&&(_.antiSpamBusinessId=so((A=b.antispamTag)===null||A===void 0?void 0:A.antiSpamBusinessId)),_}var ES={accid:{type:"string"},type:{type:"number"},serverId:{type:"string"},status:{type:"number"},requestId:{type:"string"},createTime:{type:"number"},updateTime:{type:"number"},expireTime:{type:"number"},data:{type:"object"}};function Nd(b){return pi(ES,b)}function Ov(b){return rs(b)&&b.length>0?co(b).call(b,function(w){return Nd(w)}):[]}var Jp,ni,ea,bu,PS={successServerIds:{type:"object"},failServerIds:{type:"object"},ackTimestamp:{type:"number"}};function Tu(b){return pi(PS,b)}(function(b){b[b.reorderWeight=0]="reorderWeight",b[b.createTime=1]="createTime"})(Jp||(Jp={})),function(b){b[b.white=1]="white",b[b.black=2]="black"}(ni||(ni={})),function(b){b[b.add=1]="add",b[b.remove=2]="remove"}(ea||(ea={})),function(b){b[b.message=0]="message",b[b.media=1]="media",b[b.ext=100]="ext"}(bu||(bu={}));var Fd={channelId:{type:"string"},serverId:{type:"string"},name:{type:"string"},topic:{type:"string"},ext:{type:"string"},type:{type:"enum",values:bu},validFlag:{type:"boolean"},createTime:{type:"number"},updateTime:{type:"number"},viewMode:{type:"number"},categoryId:{type:"string"},syncMode:{type:"number"},visitorMode:{type:"number"},reorderWeight:{type:"string"}},AS={serverId:{type:"string"},channelId:{type:"string"},ackTimestamp:{type:"number"},unreadCount:{type:"number"},mentionedCount:{type:"number"},maxCount:{type:"number"},lastMsgTime:{type:"number"}},Rv={serverId:{type:"string"},channelId:{type:"string"},type:{type:"enum",values:ni},opeType:{type:"enum",values:ea},toAccids:{type:"object"}},Yp={serverId:{type:"string"},channelId:{type:"string"},type:{type:"enum",values:ni},opeType:{type:"enum",values:ea},roleId:{type:"string"}},OS={categoryId:{type:"string"},serverId:{type:"string"},name:{type:"string"},ext:{type:"string"},owner:{type:"string"},viewMode:{type:"number"},validFlag:{type:"boolean"},createTime:{type:"number"},updateTime:{type:"number"},channelNumber:{type:"number"}},Nv={serverId:{type:"string"},channelId:{type:"string"},accid:{type:"string"},avatar:{type:"string"},nick:{type:"string"},createTime:{type:"number"},updateTime:{type:"number"}};function jd(b){return pi(Yp,b)}function Bd(b){return pi(Fd,b)}function Ld(b){return rs(b)&&b.length>0?co(b).call(b,function(w){return Bd(w)}):[]}function Eh(b){return pi(AS,b)}function Ud(b){return rs(b)&&b.length>0?co(b).call(b,function(w){return Eh(w)}):[]}function Dd(b){return pi(OS,b)}function Ph(b){return rs(b)&&b.length>0?co(b).call(b,function(w){return Dd(w)}):[]}function RS(b){return rs(b)&&b.length>0?co(b).call(b,function(w){return function(A){return pi(Nv,A)}(w)}):[]}function qd(b){try{return JSON.parse(b)}catch{return[]}}var Xp=Ea?Ea.isConcatSpreadable:void 0,NS=function(w){return Fa(w)||oh(w)||!!(Xp&&w&&w[Xp])},Fv=function b(w,$,A,_,Y){var de=-1,V=w.length;for(A||(A=NS),Y||(Y=[]);++de<V;){var Fe=w[de];$>0&&A(Fe)?$>1?b(Fe,$-1,A,_,Y):Es(Y,Fe):_||(Y[Y.length]=Fe)}return Y},Ah=jy(function(b,w){return xn(b)?Ug(b,Fv(w,1,xn,!0)):[]}),Zp=Ah;function Oh(b,w){var $,A=li!==void 0&&Di(b)||b["@@iterator"];if(A)return Mo($=(A=A.call(b)).next).call($,A);if(rs(b)||(A=function(de,V){var Fe;if(de){if(typeof de=="string")return Rh(de,V);var Et=fo(Fe=Object.prototype.toString.call(de)).call(Fe,8,-1);if(Et==="Object"&&de.constructor&&(Et=de.constructor.name),Et==="Map"||Et==="Set")return _c(de);if(Et==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(Et))return Rh(de,V)}}(b))||w&&b&&typeof b.length=="number"){A&&(b=A);var _=0;return function(){return _>=b.length?{done:!0}:{done:!1,value:b[_++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Rh(b,w){(w==null||w>b.length)&&(w=b.length);for(var $=0,A=new Array(w);$<w;$++)A[$]=b[$];return A}var tl,$d,Su,Mu,FS=function(b){function w(A){var _;return(_=b.call(this,"qchatServer",A)||this).core=A,Oa({cmdMap:Iv,cmdConfig:Oc}),_}Co(w,b);var $=w.prototype;return $.createServer=function(_){return kr(this,void 0,void 0,rr.mark(function Y(){var de;return rr.wrap(function(Fe){for(;;)switch(Fe.prev=Fe.next){case 0:return zr({icon:{type:"string",required:!1},name:{type:"string",required:!1},ext:{type:"string",required:!1},searchType:{type:"number",required:!1,min:0},searchEnable:{type:"boolean",required:!1},inviteMode:{type:"number",min:0,max:1,required:!1},applyMode:{type:"number",min:0,max:1,required:!1}},_),Fe.next=3,this.core.sendCmd("qchatCreateServer",{serverInfo:Xr(Xr({},_),{searchEnable:_.searchEnable===!1?0:1}),antispamTag:Rc(_)});case 3:return de=Fe.sent,Fe.abrupt("return",Rd(de.content.serverInfo));case 5:case"end":return Fe.stop()}},Y,this)}))},$.deleteServer=function(_){return kr(this,void 0,void 0,rr.mark(function Y(){return rr.wrap(function(V){for(;;)switch(V.prev=V.next){case 0:return zr({serverId:{type:"string",min:1}},_),V.next=3,this.core.sendCmd("qchatDeleteServer",_);case 3:case"end":return V.stop()}},Y,this)}))},$.updateServer=function(_){return kr(this,void 0,void 0,rr.mark(function Y(){var de;return rr.wrap(function(Fe){for(;;)switch(Fe.prev=Fe.next){case 0:return zr({serverId:{type:"string",min:1},icon:{type:"string",required:!1},name:{type:"string",required:!1},ext:{type:"string",required:!1},searchType:{type:"number",required:!1,min:0},searchEnable:{type:"boolean",required:!1},inviteMode:{type:"number",min:0,max:1,required:!1},applyMode:{type:"number",min:0,max:1,required:!1}},_),Fe.next=3,this.core.sendCmd("qchatUpdateServer",{serverInfo:Xr(Xr({},_),{searchEnable:_.searchEnable===!1?0:1}),antispamTag:Rc(_)});case 3:return de=Fe.sent,Fe.abrupt("return",Rd(de.content.serverInfo));case 5:case"end":return Fe.stop()}},Y,this)}))},$.getServers=function(_){return kr(this,void 0,void 0,rr.mark(function Y(){var de;return rr.wrap(function(Fe){for(;;)switch(Fe.prev=Fe.next){case 0:return zr({serverIds:{type:"array",itemType:"string",min:1}},_),Fe.next=3,this.core.sendCmd("qchatGetServers",_);case 3:return de=Fe.sent,Fe.abrupt("return",_h(de.content.serverList));case 5:case"end":return Fe.stop()}},Y,this)}))},$.getServersByPage=function(_){return kr(this,void 0,void 0,rr.mark(function Y(){var de,V,Fe,Et;return rr.wrap(function(fr){for(;;)switch(fr.prev=fr.next){case 0:return zr({timestamp:{type:"number"},limit:{type:"number",min:1,required:!1}},_),fr.next=3,this.core.sendCmd("qchatGetServersByPage",{tag:_});case 3:return de=fr.sent,V=de.content,Fe=V.datas,Et=V.listQueryTag,fr.abrupt("return",{listQueryTag:{hasMore:+Et.hasMore==1,nextTimetag:wo(Et.nextTimetag)},datas:_h(Fe)});case 6:case"end":return fr.stop()}},Y,this)}))},$.inviteServerMembers=function(_){return kr(this,void 0,void 0,rr.mark(function Y(){var de,V;return rr.wrap(function(Et){for(;;)switch(Et.prev=Et.next){case 0:return zr({serverId:{type:"string",min:1},accids:{type:"array",itemType:"string",min:1},ps:{type:"string"},params:{type:"object",rules:{ttl:{type:"number"}},required:!1}},_),Et.next=3,this.core.sendCmd("qchatInviteServerMembers",_);case 3:return de=Et.sent,V=de.content.record||{},Et.abrupt("return",{failByOverAccids:de.content.failByOverAccids,failByBanAccids:de.content.failByBanAccids,recordInfo:Nd(V)});case 6:case"end":return Et.stop()}},Y,this)}))},$.acceptServerInvite=function(_){return kr(this,void 0,void 0,rr.mark(function Y(){return rr.wrap(function(V){for(;;)switch(V.prev=V.next){case 0:return zr({serverId:{type:"string",allowEmpty:!1},accid:{type:"string",allowEmpty:!1},recordInfo:{type:"object",rules:{requestId:{type:"string",allowEmpty:!1}}}},_),V.next=3,this.core.sendCmd("qchatAcceptServerInvite",_);case 3:case"end":return V.stop()}},Y,this)}))},$.rejectInviteServer=function(_){return kr(this,void 0,void 0,rr.mark(function Y(){return rr.wrap(function(V){for(;;)switch(V.prev=V.next){case 0:return zr({serverId:{type:"string",min:1},accid:{type:"string",min:1},ps:{type:"string"},recordInfo:{type:"object",rules:{requestId:{type:"string",allowEmpty:!1}}}},_),V.next=3,this.core.sendCmd("qchatRejectInviteServer",_);case 3:case"end":return V.stop()}},Y,this)}))},$.applyServerJoin=function(_){return kr(this,void 0,void 0,rr.mark(function Y(){var de;return rr.wrap(function(Fe){for(;;)switch(Fe.prev=Fe.next){case 0:return zr({serverId:{type:"string",min:1},ps:{type:"string"},params:{type:"object",rules:{ttl:{type:"number"}},required:!1}},_),Fe.next=3,this.core.sendCmd("qchatApplyServerJoin",_);case 3:return de=Fe.sent,Fe.abrupt("return",Nd(de.content.data));case 5:case"end":return Fe.stop()}},Y,this)}))},$.acceptServerApply=function(_){return kr(this,void 0,void 0,rr.mark(function Y(){return rr.wrap(function(V){for(;;)switch(V.prev=V.next){case 0:return zr({serverId:{type:"string",min:1},accid:{type:"string",min:1},recordInfo:{type:"object",rules:{requestId:{type:"string",allowEmpty:!1}}}},_),V.next=3,this.core.sendCmd("qchatAcceptServerApply",_);case 3:case"end":return V.stop()}},Y,this)}))},$.rejectServerApply=function(_){return kr(this,void 0,void 0,rr.mark(function Y(){return rr.wrap(function(V){for(;;)switch(V.prev=V.next){case 0:return zr({serverId:{type:"string",min:1},accid:{type:"string",min:1},ps:{type:"string"},recordInfo:{type:"object",rules:{requestId:{type:"string",allowEmpty:!1}}}},_),V.next=3,this.core.sendCmd("qchatRejectServerApply",_);case 3:case"end":return V.stop()}},Y,this)}))},$.kickServerMembers=function(_){return kr(this,void 0,void 0,rr.mark(function Y(){return rr.wrap(function(V){for(;;)switch(V.prev=V.next){case 0:return zr({serverId:{type:"string",min:1},accids:{type:"array",itemType:"string",min:1}},_),V.next=3,this.core.sendCmd("qchatKickServerMembers",_);case 3:case"end":return V.stop()}},Y,this)}))},$.leaveServer=function(_){return kr(this,void 0,void 0,rr.mark(function Y(){return rr.wrap(function(V){for(;;)switch(V.prev=V.next){case 0:return zr({serverId:{type:"string",min:1}},_),V.next=3,this.core.sendCmd("qchatLeaveServer",_);case 3:case"end":return V.stop()}},Y,this)}))},$.updateMyMemberInfo=function(_){return kr(this,void 0,void 0,rr.mark(function Y(){var de;return rr.wrap(function(Fe){for(;;)switch(Fe.prev=Fe.next){case 0:return zr({serverId:{type:"string",min:1},accid:{type:"string",required:!1},nick:{type:"string",required:!1},avatar:{type:"string",required:!1},ext:{type:"string",required:!1}},_),Fe.next=3,this.core.sendCmd("qchatUpdateMyMemberInfo",{memberInfo:_,antispamTag:Rc(_)});case 3:return de=Fe.sent,Fe.abrupt("return",el(de.content.memberInfo));case 5:case"end":return Fe.stop()}},Y,this)}))},$.updateServerMemberInfo=function(_){return kr(this,void 0,void 0,rr.mark(function Y(){var de;return rr.wrap(function(Fe){for(;;)switch(Fe.prev=Fe.next){case 0:return zr({serverId:{type:"string",min:1},accid:{type:"string",min:1},nick:{type:"string",required:!1},avatar:{type:"string",required:!1}},_),Fe.next=3,this.core.sendCmd("qchatUpdateServerMemberInfo",{memberInfo:_,antispamTag:Rc(_)});case 3:return de=Fe.sent,Fe.abrupt("return",el(de.content.memberInfo));case 5:case"end":return Fe.stop()}},Y,this)}))},$.getServerMembers=function(_){return kr(this,void 0,void 0,rr.mark(function Y(){var de,V,Fe,Et,sr;return rr.wrap(function(Sr){for(;;)switch(Sr.prev=Sr.next){case 0:if(zr({accids:{type:"array"}},_),de=[],_.accids.length)for(V=Oh(_.accids);!(Fe=V()).done;)Et=Fe.value,de.push(Et.serverId+"|"+Et.accid);return Sr.next=5,this.core.sendCmd("qchatGetServerMembers",{accids:de});case 5:return sr=Sr.sent,Sr.abrupt("return",dc(sr.content.accidList));case 7:case"end":return Sr.stop()}},Y,this)}))},$.getServerMembersByPage=function(_){return kr(this,void 0,void 0,rr.mark(function Y(){var de,V,Fe,Et;return rr.wrap(function(fr){for(;;)switch(fr.prev=fr.next){case 0:return zr({serverId:{type:"string",min:1},timetag:{type:"number"},limit:{type:"number",min:1,required:!1}},_),fr.next=3,this.core.sendCmd("qchatGetServerMembersByPage",{tag:_});case 3:return de=fr.sent,V=de.content,Fe=V.datas,Et=V.listQueryTag,fr.abrupt("return",{listQueryTag:{hasMore:+Et.hasMore==1,nextTimetag:wo(Et.nextTimetag)},datas:dc(Fe)});case 6:case"end":return fr.stop()}},Y,this)}))},$.subscribeServer=function(_){return kr(this,void 0,void 0,rr.mark(function Y(){var de,V,Fe,Et;return rr.wrap(function(fr){for(;;)switch(fr.prev=fr.next){case 0:if(zr({type:{type:"number",min:4,max:4,required:!1},opeType:{type:"number",min:1,max:2}},_),_.type||(_.type=4),!_.servers.length){fr.next=10;break}return V=Xr(Xr({},_),{channels:co(de=_.servers).call(de,function(Sr){return{serverId:Sr.serverId,channelId:""}})}),fr.next=6,this.core.qchatChannel.subscribeModuleService.subscribe(V);case 6:return Fe=fr.sent,Et=Fe.failedChannels,this.core.qchatChannel.subscribeModuleService.cacheSubscribe(V),fr.abrupt("return",{failedServers:Et});case 10:case"end":return fr.stop()}},Y,this)}))},$.banServerMember=function(_){return kr(this,void 0,void 0,rr.mark(function Y(){return rr.wrap(function(V){for(;;)switch(V.prev=V.next){case 0:return zr({serverId:{type:"string",allowEmpty:!1},accid:{type:"string",allowEmpty:!1},ext:{type:"string",required:!1}},_),V.next=3,this.core.sendCmd("qchatUpdateServerMemberBan",{tag:Xr(Xr({},_),{opeType:1})});case 3:case"end":return V.stop()}},Y,this)}))},$.unbanServerMember=function(_){return kr(this,void 0,void 0,rr.mark(function Y(){return rr.wrap(function(V){for(;;)switch(V.prev=V.next){case 0:return zr({serverId:{type:"string",allowEmpty:!1},accid:{type:"string",allowEmpty:!1},ext:{type:"string",required:!1}},_),V.next=3,this.core.sendCmd("qchatUpdateServerMemberBan",{tag:Xr(Xr({},_),{opeType:2})});case 3:case"end":return V.stop()}},Y,this)}))},$.getBannedMembersByPage=function(_){return kr(this,void 0,void 0,rr.mark(function Y(){var de,V,Fe,Et;return rr.wrap(function(fr){for(;;)switch(fr.prev=fr.next){case 0:return zr({serverId:{type:"string",allowEmpty:!1},timetag:{type:"number",min:0},limit:{type:"number",min:1,required:!1}},_),fr.next=3,this.core.sendCmd("qchatGetBannedMembersByPage",{tag:_});case 3:return de=fr.sent,V=de.content,Fe=V.datas,Et=V.listQueryTag,fr.abrupt("return",{listQueryTag:{hasMore:+Et.hasMore==1,nextTimetag:wo(Et.nextTimetag)},datas:_S(Fe)});case 6:case"end":return fr.stop()}},Y,this)}))},$.serverSearchByPage=function(_){return kr(this,void 0,void 0,rr.mark(function Y(){var de,V,Fe,Et;return rr.wrap(function(fr){for(;;)switch(fr.prev=fr.next){case 0:if(zr({keyword:{type:"string",allowEmpty:!1},startTime:{type:"number",min:0,required:!1},endTime:{type:"number",min:0,required:!1},limit:{type:"number",min:1,required:!1},serverType:{type:"array",itemType:"number",min:0,required:!1},order:{type:"enum",values:ri(Ac),required:!1},searchType:{type:"enum",values:ri(Gp)},sort:{type:"enum",values:ri(Sa),required:!1},cursor:{type:"string",allowEmpty:!1,required:!1}},_),!(_.startTime&&_.endTime&&_.startTime>=_.endTime)){fr.next=3;break}throw new cu("startTime more than endTime",_,"timeRule");case 3:return fr.next=5,this.core.sendCmd("qchatServerSearchByPage",{tag:Xr(Xr({},_),{order:_.order&&Ac[_.order],searchType:Gp[_.searchType],sort:Xu(_)&&Sa[Xu(_)],serverType:so(_.serverType)})});case 5:return de=fr.sent,V=de.content,Fe=V.datas,Et=V.listQueryTag,fr.abrupt("return",{listQueryTag:{hasMore:+Et.hasMore==1,nextTimetag:wo(Et.nextTimetag),cursor:Et.cursor},datas:_h(Fe)});case 8:case"end":return fr.stop()}},Y,this)}))},$.serverMemberSearchByPage=function(_){return kr(this,void 0,void 0,rr.mark(function Y(){var de;return rr.wrap(function(Fe){for(;;)switch(Fe.prev=Fe.next){case 0:return zr({serverId:{type:"string",allowEmpty:!1},keyword:{type:"string",allowEmpty:!1},limit:{type:"number",min:1,required:!1}},_),Fe.next=3,this.core.sendCmd("qchatServerMemberSearchByPage",{tag:_});case 3:return de=Fe.sent,Fe.abrupt("return",dc(de.content.members));case 5:case"end":return Fe.stop()}},Y,this)}))},$.generateInviteCode=function(_){return kr(this,void 0,void 0,rr.mark(function Y(){var de;return rr.wrap(function(Fe){for(;;)switch(Fe.prev=Fe.next){case 0:return zr({serverId:{type:"string",allowEmpty:!1},ttl:{type:"number",min:0,required:!1}},_),Fe.next=3,this.core.sendCmd("qchatGenerateInviteCode",{tag:_});case 3:return de=Fe.sent,Fe.abrupt("return",pi({expireTime:{type:"number"}},de.content.data));case 5:case"end":return Fe.stop()}},Y,this)}))},$.joinByInviteCode=function(_){return kr(this,void 0,void 0,rr.mark(function Y(){return rr.wrap(function(V){for(;;)switch(V.prev=V.next){case 0:return zr({serverId:{type:"string",allowEmpty:!1},inviteCode:{type:"string",allowEmpty:!1},ps:{type:"string",required:!1}},_),V.next=3,this.core.sendCmd("qchatJoinByInviteCode",{tag:_});case 3:case"end":return V.stop()}},Y,this)}))},$.getInviteApplyRecordOfServer=function(_){return kr(this,void 0,void 0,rr.mark(function Y(){var de;return rr.wrap(function(Fe){for(;;)switch(Fe.prev=Fe.next){case 0:return zr({serverId:{type:"string",allowEmpty:!1},fromTime:{type:"number",min:0},toTime:{type:"number",min:0},reverse:{type:"boolean",required:!1},limit:{type:"number",min:1,required:!1},cursor:{type:"string",allowEmpty:!1,required:!1}},_),Fe.next=3,this.core.sendCmd("qchatGetInviteApplyRecordOfServer",{tag:Xr(Xr({},_),{reverse:Eu(_)?1:0})});case 3:return de=Fe.sent,Fe.abrupt("return",Ov(de.content.data));case 5:case"end":return Fe.stop()}},Y,this)}))},$.getInviteApplyRecordOfSelf=function(_){return kr(this,void 0,void 0,rr.mark(function Y(){var de;return rr.wrap(function(Fe){for(;;)switch(Fe.prev=Fe.next){case 0:return zr({fromTime:{type:"number",min:0},toTime:{type:"number",min:0},reverse:{type:"boolean",required:!1},limit:{type:"number",min:1,required:!1},cursor:{type:"string",allowEmpty:!1,required:!1}},_),Fe.next=3,this.core.sendCmd("qchatGetInviteApplyRecordOfSelf",{tag:Xr(Xr({},_),{reverse:Eu(_)?1:0})});case 3:return de=Fe.sent,Fe.abrupt("return",Ov(de.content.data));case 5:case"end":return Fe.stop()}},Y,this)}))},$.markRead=function(_){return kr(this,void 0,void 0,rr.mark(function Y(){var de,V,Fe,Et;return rr.wrap(function(fr){for(;;)switch(fr.prev=fr.next){case 0:return zr({serverIds:{type:"array",itemType:"string",required:!0}},_),fr.next=3,this.core.sendCmd("qchatClearServersUnread",_);case 3:return de=fr.sent,V=Tu(de.content.clearServersUnreadTag),Fe=V.successServerIds,Et=V.ackTimestamp,this.logger.log("qchatServer::clearServersUnread:: begin auto clear servers unreadInfo"),this.core.eventBus.emit("qchatChannel/clearUnreadCountByServers",Fe,Et),fr.abrupt("return",V);case 9:case"end":return fr.stop()}},Y,this)}))},$.subscribeAllChannel=function(_){return kr(this,void 0,void 0,rr.mark(function Y(){var de,V,Fe;return rr.wrap(function(sr){for(;;)switch(sr.prev=sr.next){case 0:return zr({type:{type:"number",required:!0},serverIds:{type:"array",itemType:"string",required:!0,max:10}},_),sr.next=3,this.core.sendCmd("qchatSubscribeChannelsByServers",_,{timeout:3e4});case 3:return(V=sr.sent).content.unreadInfos=Ud(V.content.unreadInfos),V.content.failServerIds=qd(V.content.failServerIds),Fe={type:_.type,opeType:1,channels:co(de=V.content.unreadInfos).call(de,function(fr){return{serverId:fr.serverId,channelId:fr.channelId}})},this.core.eventBus.emit("qchatChannel/cacheSubscribe",Fe),this.core.eventBus.emit("qchatChannel/getRoleIdsByServerId",_.serverIds),this.core.eventBus.emit("qchatChannel/updateUnreads",V.content.unreadInfos),sr.abrupt("return",V.content);case 11:case"end":return sr.stop()}},Y,this)}))},$.enterAsVisitor=function(_){return kr(this,void 0,void 0,rr.mark(function Y(){var de,V,Fe;return rr.wrap(function(sr){for(;;)switch(sr.prev=sr.next){case 0:return zr({serverIds:{type:"array",itemType:"string",min:1}},_),sr.next=3,this.core.sendCmd("qchatEnterAsVisitor",{tag:{serverIds:so(_.serverIds)}});case 3:return de=sr.sent,V=qd(de.content.failServerIds),Fe=Zp(_.serverIds,V),this.core.qchatChannel.subscribeForVisitorService.cacheServer(Fe),sr.abrupt("return",{failedServers:V});case 8:case"end":return sr.stop()}},Y,this)}))},$.leaveAsVisitor=function(_){return kr(this,void 0,void 0,rr.mark(function Y(){var de,V,Fe,Et=this;return rr.wrap(function(fr){for(;;)switch(fr.prev=fr.next){case 0:return zr({serverIds:{type:"array",itemType:"string",min:1}},_),fr.next=3,this.core.sendCmd("qchatLeaveAsVisitor",{tag:{serverIds:so(_.serverIds)}});case 3:return de=fr.sent,V=qd(de.content.failServerIds),Fe=Zp(_.serverIds,V),kn(Fe).call(Fe,function(Sr){Et.core.qchatChannel.subscribeForVisitorService.deleteServer(Sr)}),fr.abrupt("return",{failedServers:V});case 8:case"end":return fr.stop()}},Y,this)}))},$.subscribeAsVisitor=function(_){return kr(this,void 0,void 0,rr.mark(function Y(){return rr.wrap(function(V){for(;;)switch(V.prev=V.next){case 0:if(zr({opeType:{type:"number",min:1,max:2},type:{type:"number",required:!1},serverIds:{type:"array",itemType:"string",min:1}},_),!_.serverIds.length){V.next=5;break}return V.next=4,this.core.qchatChannel.subscribeForVisitorService.subscribeServerAsVisitor(_);case 4:return V.abrupt("return",V.sent);case 5:return V.abrupt("return",{failedServers:[]});case 6:case"end":return V.stop()}},Y,this)}))},w}(vu);(function(b){b[b.everyone=1]="everyone",b[b.custom=2]="custom"})(tl||(tl={})),function(b){b[b.normal=0]="normal",b[b.owner=1]="owner"}($d||($d={})),function(b){b[b.ignore=0]="ignore",b[b.deny=-1]="deny",b[b.allow=1]="allow"}(Su||(Su={})),function(b){b[b.manageServer=1]="manageServer",b[b.manageChannel=2]="manageChannel",b[b.manageRole=3]="manageRole",b[b.sendMsg=4]="sendMsg",b[b.accountInfoSelf=5]="accountInfoSelf",b[b.inviteServer=6]="inviteServer",b[b.kickServer=7]="kickServer",b[b.accountInfoOther=8]="accountInfoOther",b[b.recallMsg=9]="recallMsg",b[b.deleteMsg=10]="deleteMsg",b[b.remindOther=11]="remindOther",b[b.remindEveryone=12]="remindEveryone",b[b.manageBlackWhiteList=13]="manageBlackWhiteList",b[b.banServerMember=14]="banServerMember",b[b.RTCChannelConnect=15]="RTCChannelConnect",b[b.RTCChannelDisconnectOther=16]="RTCChannelDisconnectOther",b[b.RTCChannelOpenMicrophone=17]="RTCChannelOpenMicrophone",b[b.RTCChannelOpenCamera=18]="RTCChannelOpenCamera",b[b.RTCChannelOpenCloseOtherMicrophone=19]="RTCChannelOpenCloseOtherMicrophone",b[b.RTCChannelOpenCloseOtherCamera=20]="RTCChannelOpenCloseOtherCamera",b[b.RTCChannelOpenCloseEveryoneMicrophone=21]="RTCChannelOpenCloseEveryoneMicrophone",b[b.RTCChannelOpenCloseEveryoneCamera=22]="RTCChannelOpenCloseEveryoneCamera",b[b.RTCChannelOpenShareScreen=23]="RTCChannelOpenShareScreen",b[b.RTCChannelCloseOtherShareScreen=24]="RTCChannelCloseOtherShareScreen",b[b.manageInviteApply=25]="manageInviteApply",b[b.manageInviteApplyHistory=26]="manageInviteApplyHistory",b[b.mentionedRole=27]="mentionedRole"}(Mu||(Mu={}));var jv={type:{type:"enum",values:tl},memberType:{type:"enum",values:$d},createTime:{type:"number"},updateTime:{type:"number"},priority:{type:"number"},memberCount:{type:"number"},joinTime:{type:"number"}},jS={roleId:{type:"string"},categoryId:{type:"string"},serverId:{type:"string"},type:{type:"enum",values:tl},validFlag:{type:"boolean"},createTime:{type:"number"},updateTime:{type:"number"},name:{type:"string"},icon:{type:"string"},ext:{type:"string"}},BS={id:{type:"string"},accid:{type:"string"},categoryId:{type:"string"},serverId:{type:"string"},validFlag:{type:"boolean"},createTime:{type:"number"},updateTime:{type:"number"},nick:{type:"string"},avatar:{type:"string"},ext:{type:"string"},memberType:{type:"enum",values:$d},joinTime:{type:"number"},inviter:{type:"string"}};function Nc(b){var w=Xr({},b),$=Zu(jv,w);return $.auths&&($.auths=function(_){var Y,de=kc(Y=Yo(_)).call(Y,function(V,Fe){var Et=Mu[Fe];return Et?V[Et]=Su[_[Fe]]:V[Fe]=Su[_[Fe]],V},{});return so(de)}($.auths)),$}function Ma(b){var w;return kc(w=Yo(b)).call(w,function($,A){var _=Dy(Mu,A);return _?$[_]=Su[b[A]]:$[wo(A)]=Su[b[A]],$},{})}function us(b){var w=pi(jv,b);return b.auths&&(w.auths=Ma(JSON.parse(w.auths))),w.isMember&&delete w.isMember,w}function zs(b){return rs(b)&&b.length>0?co(b).call(b,function(w){return us(w)}):[]}function ef(b){return b.auths&&(b.auths=Ma(JSON.parse(b.auths))),pi(jS,b)}function rl(b){return b.auths&&(b.auths=Ma(JSON.parse(b.auths))),pi(BS,b)}Zh("Set",function(b){return function(){return b(this,arguments.length?arguments[0]:void 0)}},ld);var Bv=nr.Set;qr({target:"Set",stat:!0,forced:!0},{from:lg}),qr({target:"Set",stat:!0,forced:!0},{of:ty}),qr({target:"Set",proto:!0,real:!0,forced:!0},{addAll:function(){for(var w=Dn(this),$=Or(w.add),A=0,_=arguments.length;A<_;A++)Ie($,w,arguments[A]);return w}}),qr({target:"Set",proto:!0,real:!0,forced:!0},{deleteAll:ry});var Cu=Ja;qr({target:"Set",proto:!0,real:!0,forced:!0},{every:function(w){var $=Dn(this),A=Cu($),_=_o(w,arguments.length>1?arguments[1]:void 0);return!to(A,function(Y,de){if(!_(Y,Y,$))return de()},{IS_ITERATOR:!0,INTERRUPTED:!0}).stopped}}),qr({target:"Set",proto:!0,real:!0,forced:!0},{difference:function(w){var $=Dn(this),A=new(Ts($,dr("Set")))($),_=Or(A.delete);return to(w,function(Y){Ie(_,A,Y)}),A}}),qr({target:"Set",proto:!0,real:!0,forced:!0},{filter:function(w){var $=Dn(this),A=Cu($),_=_o(w,arguments.length>1?arguments[1]:void 0),Y=new(Ts($,dr("Set"))),de=Or(Y.add);return to(A,function(V){_(V,V,$)&&Ie(de,Y,V)},{IS_ITERATOR:!0}),Y}}),qr({target:"Set",proto:!0,real:!0,forced:!0},{find:function(w){var $=Dn(this),A=Cu($),_=_o(w,arguments.length>1?arguments[1]:void 0);return to(A,function(Y,de){if(_(Y,Y,$))return de(Y)},{IS_ITERATOR:!0,INTERRUPTED:!0}).result}}),qr({target:"Set",proto:!0,real:!0,forced:!0},{intersection:function(w){var $=Dn(this),A=new(Ts($,dr("Set"))),_=Or($.has),Y=Or(A.add);return to(w,function(de){Ie(_,$,de)&&Ie(Y,A,de)}),A}}),qr({target:"Set",proto:!0,real:!0,forced:!0},{isDisjointFrom:function(w){var $=Dn(this),A=Or($.has);return!to(w,function(_,Y){if(Ie(A,$,_)===!0)return Y()},{INTERRUPTED:!0}).stopped}}),qr({target:"Set",proto:!0,real:!0,forced:!0},{isSubsetOf:function(w){var $=Ja(this),A=Dn(w),_=A.has;return le(_)||(A=new(dr("Set"))(w),_=Or(A.has)),!to($,function(Y,de){if(Ie(_,A,Y)===!1)return de()},{IS_ITERATOR:!0,INTERRUPTED:!0}).stopped}}),qr({target:"Set",proto:!0,real:!0,forced:!0},{isSupersetOf:function(w){var $=Dn(this),A=Or($.has);return!to(w,function(_,Y){if(Ie(A,$,_)===!1)return Y()},{INTERRUPTED:!0}).stopped}});var Lv=re([].join),LS=[].push;qr({target:"Set",proto:!0,real:!0,forced:!0},{join:function(w){var $=Dn(this),A=Cu($),_=w===void 0?",":_i(w),Y=[];return to(A,LS,{that:Y,IS_ITERATOR:!0}),Lv(Y,_)}}),qr({target:"Set",proto:!0,real:!0,forced:!0},{map:function(w){var $=Dn(this),A=Cu($),_=_o(w,arguments.length>1?arguments[1]:void 0),Y=new(Ts($,dr("Set"))),de=Or(Y.add);return to(A,function(V){Ie(de,Y,_(V,V,$))},{IS_ITERATOR:!0}),Y}});var Uv=TypeError;qr({target:"Set",proto:!0,real:!0,forced:!0},{reduce:function(w){var $=Dn(this),A=Cu($),_=arguments.length<2,Y=_?void 0:arguments[1];if(Or(w),to(A,function(de){_?(_=!1,Y=de):Y=w(Y,de,de,$)},{IS_ITERATOR:!0}),_)throw Uv("Reduce of empty set with no initial value");return Y}}),qr({target:"Set",proto:!0,real:!0,forced:!0},{some:function(w){var $=Dn(this),A=Cu($),_=_o(w,arguments.length>1?arguments[1]:void 0);return to(A,function(Y,de){if(_(Y,Y,$))return de()},{IS_ITERATOR:!0,INTERRUPTED:!0}).stopped}}),qr({target:"Set",proto:!0,real:!0,forced:!0},{symmetricDifference:function(w){var $=Dn(this),A=new(Ts($,dr("Set")))($),_=Or(A.delete),Y=Or(A.add);return to(w,function(de){Ie(_,A,de)||Ie(Y,A,de)}),A}}),qr({target:"Set",proto:!0,real:!0,forced:!0},{union:function(w){var $=Dn(this),A=new(Ts($,dr("Set")))($);return to(w,Or(A.add),{that:A}),A}});var tf,Hd,Ca,Vd,Fc,zo,pc,nl=Bv;(function(b){b[b.sendTime=1]="sendTime"})(tf||(tf={})),function(b){b[b.text=0]="text",b[b.image=1]="image",b[b.audio=2]="audio",b[b.video=3]="video",b[b.geo=4]="geo",b[b.notification=5]="notification",b[b.file=6]="file",b[b.tip=10]="tip",b[b.robot=11]="robot",b[b.g2=12]="g2",b[b.custom=100]="custom"}(Hd||(Hd={})),function(b){b[b.sending=1]="sending",b[b.success=2]="success",b[b.failed=3]="failed"}(Ca||(Ca={})),function(b){b[b.notifyAll=1]="notifyAll",b[b.notifySubscribe=2]="notifySubscribe"}(Vd||(Vd={})),function(b){b[b.unknown=0]="unknown",b[b.server=1]="server",b[b.channel=2]="channel",b[b.serverAccids=3]="serverAccids",b[b.channelAccids=4]="channelAccids",b[b.accids=5]="accids"}(Fc||(Fc={})),function(b){b[b.serverMemberInvite=1]="serverMemberInvite",b[b.serverMemberInviteReject=2]="serverMemberInviteReject",b[b.serverMemberApply=3]="serverMemberApply",b[b.serverMemberApplyReject=4]="serverMemberApplyReject",b[b.serverCreate=5]="serverCreate",b[b.serverRemove=6]="serverRemove",b[b.serverUpdate=7]="serverUpdate",b[b.serverMemberInviteDone=8]="serverMemberInviteDone",b[b.serverMemberInviteAccept=9]="serverMemberInviteAccept",b[b.serverMemberApplyDone=10]="serverMemberApplyDone",b[b.serverMemberApplyAccept=11]="serverMemberApplyAccept",b[b.serverMemberKick=12]="serverMemberKick",b[b.serverMemberLeave=13]="serverMemberLeave",b[b.serverMemberUpdate=14]="serverMemberUpdate",b[b.channelCreate=15]="channelCreate",b[b.channelRemove=16]="channelRemove",b[b.channelUpdate=17]="channelUpdate",b[b.channelUpdateWhiteBlackIdentify=18]="channelUpdateWhiteBlackIdentify",b[b.channelUpdateWhiteBlackIdentifyUser=19]="channelUpdateWhiteBlackIdentifyUser",b[b.updateQuickComment=20]="updateQuickComment",b[b.channelCategoryCreate=21]="channelCategoryCreate",b[b.channelCategoryRemove=22]="channelCategoryRemove",b[b.channelCategoryUpdate=23]="channelCategoryUpdate",b[b.channelCategoryUpdateWhiteBlackIdentify=24]="channelCategoryUpdateWhiteBlackIdentify",b[b.channelCategoryUpdateWhiteBlackIdentifyUser=25]="channelCategoryUpdateWhiteBlackIdentifyUser",b[b.serverIdentifyAdd=26]="serverIdentifyAdd",b[b.serverIdentifyRemove=27]="serverIdentifyRemove",b[b.serverIdentifyUpdate=28]="serverIdentifyUpdate",b[b.channelIdentifyUpdate=29]="channelIdentifyUpdate",b[b.userIdentifyUpdate=30]="userIdentifyUpdate",b[b.channelVisibilityUpdate=31]="channelVisibilityUpdate",b[b.serverEnterLeave=32]="serverEnterLeave",b[b.serverMemberJoinByInviteCode=33]="serverMemberJoinByInviteCode",b[b.channelVisibilityToVisitorUpdate=34]="channelVisibilityToVisitorUpdate",b[b.myMemberInfoUpdated=35]="myMemberInfoUpdated",b[b.custom=100]="custom",b[b.msgTyping=101]="msgTyping"}(zo||(zo={})),function(b){b[b.reply=1]="reply",b[b.thread=2]="thread",b[b.all=3]="all"}(pc||(pc={}));var Nh=function(){return Hs.Date.now()},US=/\s/,DS=function(w){for(var $=w.length;$--&&US.test(w.charAt($)););return $},qS=/^\s+/,$S=function(w){return w&&w.slice(0,DS(w)+1).replace(qS,"")},HS=/^[-+]0x[0-9a-f]+$/i,VS=/^0b[01]+$/i,zS=/^0o[0-7]+$/i,WS=parseInt,Fh=function(w){if(typeof w=="number")return w;if($p(w))return NaN;if(ma(w)){var $=typeof w.valueOf=="function"?w.valueOf():w;w=ma($)?$+"":$}if(typeof w!="string")return w===0?w:+w;w=$S(w);var A=VS.test(w);return A||zS.test(w)?WS(w.slice(2),A?2:8):HS.test(w)?NaN:+w},GS=Math.max,Dv=Math.min,KS=function(w,$,A){var _,Y,de,V,Fe,Et,sr=0,fr=!1,Sr=!1,Tr=!0;if(typeof w!="function")throw new TypeError("Expected a function");function Pr(Qr){var Vn=_,Bn=Y;return _=Y=void 0,sr=Qr,V=w.apply(Bn,Vn)}function Lr(Qr){return sr=Qr,Fe=setTimeout(Jr,$),fr?Pr(Qr):V}function jr(Qr){var Vn=Qr-Et;return Et===void 0||Vn>=$||Vn<0||Sr&&Qr-sr>=de}function Jr(){var Qr=Nh();if(jr(Qr))return Gr(Qr);Fe=setTimeout(Jr,function(Bn){var Eo=$-(Bn-Et);return Sr?Dv(Eo,de-(Bn-sr)):Eo}(Qr))}function Gr(Qr){return Fe=void 0,Tr&&_?Pr(Qr):(_=Y=void 0,V)}function Mn(){var Qr=Nh(),Vn=jr(Qr);if(_=arguments,Y=this,Et=Qr,Vn){if(Fe===void 0)return Lr(Et);if(Sr)return clearTimeout(Fe),Fe=setTimeout(Jr,$),Pr(Et)}return Fe===void 0&&(Fe=setTimeout(Jr,$)),V}return $=Fh($)||0,ma(A)&&(fr=!!A.leading,de=(Sr="maxWait"in A)?GS(Fh(A.maxWait)||0,$):de,Tr="trailing"in A?!!A.trailing:Tr),Mn.cancel=function(){Fe!==void 0&&clearTimeout(Fe),sr=0,_=Et=Y=Fe=void 0},Mn.flush=function(){return Fe===void 0?V:Gr(Nh())},Mn},jh=function(w,$,A){var _=!0,Y=!0;if(typeof w!="function")throw new TypeError("Expected a function");return ma(A)&&(_="leading"in A?!!A.leading:_,Y="trailing"in A?!!A.trailing:Y),KS(w,$,{leading:_,maxWait:$,trailing:Y})},QS=function(w,$,A){var _=-1,Y=w.length;$<0&&($=-$>Y?0:Y+$),(A=A>Y?Y:A)<0&&(A+=Y),Y=$>A?0:A-$>>>0,$>>>=0;for(var de=Array(Y);++_<Y;)de[_]=w[_+$];return de},ol=function(w,$,A){if(!ma(A))return!1;var _=typeof $;return!!(_=="number"?xp(A)&&kd($,A.length):_=="string"&&$ in A)&&mp(A[$],w)},fc=1/0,JS=function(w){return w?(w=Fh(w))===fc||w===-1/0?17976931348623157e292*(w<0?-1:1):w==w?w:0:w===0?w:0},YS=function(w){var $=JS(w),A=$%1;return $==$?A?$-A:$:0},rf=Math.ceil,XS=Math.max,zd,il=function(w,$,A){$=(A?ol(w,$,A):$===void 0)?1:XS(YS($),0);var _=w==null?0:w.length;if(!_||$<1)return[];for(var Y=0,de=0,V=Array(rf(_/$));Y<_;)V[de++]=QS(w,Y,Y+=$);return V};(function(b){b[b.sub=1]="sub",b[b.unSub=2]="unSub"})(zd||(zd={}));var Bh,ZS=function(){function b($){var A=this;this.unreadCount={},this.autoSubscribeUnreadMap={},this.autoSubscribeServerMap={},this.autoSubscribeTypingMap={},this.unreadServerCount={},this.serverRoleIdsMap={},this._serverUnreadInfo=jh(function(_){A.core.emit("serverUnreadInfo",A.getServerUnreadInfo(_))},100),this.core=$}var w=b.prototype;return w.changeCacheServerRoleIds=function(A){return kr(this,void 0,void 0,rr.mark(function _(){var Y,de,V,Fe,Et,sr,fr,Sr=this;return rr.wrap(function(Pr){for(;;)switch(Pr.prev=Pr.next){case 0:if(de=A.attach.serverIdentifyInfo,V=de.serverId,Fe=de.roleId,this.serverRoleIdsMap[V]){Pr.next=4;break}return Pr.next=4,this.getRoleIdsByServerId([V]);case 4:if(Et=this.serverRoleIdsMap[V],!(A.time<Et.timeTag)){Pr.next=7;break}return Pr.abrupt("return");case 7:if(A.type===zo[zo.serverIdentifyAdd]?Et.roleIds.add(Fe):Et.roleIds.delete(Fe),this.core.logger.debug("QChatChannel::qchatChannel/serverIdentifyChange::now "+V+" roleIds is",$s(Y=[]).call(Y,Et.roleIds)),sr=this.unreadServerCount[V]){Pr.next=12;break}return Pr.abrupt("return");case 12:fr=il(Yo(sr),100),kn(fr).call(fr,function(Lr){Sr.core.qchatChannel.getChannelUnreadInfos({channels:co(Lr).call(Lr,function(jr){return{serverId:V,channelId:jr}})})});case 14:case"end":return Pr.stop()}},_,this)}))},w.getRoleIdsByServerId=function(A){return kr(this,void 0,void 0,rr.mark(function _(){var Y,de,V,Fe,Et=this;return rr.wrap(function(fr){for(;;)switch(fr.prev=fr.next){case 0:if((de=Ys(A).call(A,function(Sr){return!Et.serverRoleIdsMap[Sr]})).length){fr.next=3;break}return fr.abrupt("return");case 3:return V={serverIdTimeTags:de},fr.next=6,this.core.sendCmd("qchatGetRoleIdsByServerId",{qchatGetRoleIdsByServerIdTag:V});case 6:Fe=fr.sent,this.core.logger.debug("QChatChannel:: getRoleIdsByServerId, params is ",V,"result is",Fe),kn(Y=Fe.content.serverRoles).call(Y,function(Sr){try{Sr.roleIds=JSON.parse(Sr.roleIds)}catch(Tr){Et.core.logger.error("QChatChannel:: getRoleIdsByServerId JSON parse roleIds error",Tr)}Et.serverRoleIdsMap[Sr.serverId]={roleIds:new nl(Sr.roleIds),timeTag:Sr.timeTag}});case 9:case"end":return fr.stop()}},_,this)}))},w._unSubscribeChannel=function(A,_){return kr(this,void 0,void 0,rr.mark(function Y(){var de,V;return rr.wrap(function(Et){for(;;)switch(Et.prev=Et.next){case 0:if(de=A+"_"+_,V=this.autoSubscribeUnreadMap[de]){Et.next=4;break}return Et.abrupt("return");case 4:this.subscribe({opeType:zd.unSub,type:V,channels:[{serverId:A,channelId:_}]}),this.autoSubscribeUnreadMap[de]=void 0;case 6:case"end":return Et.stop()}},Y,this)}))},w.subscribe=function(A){return kr(this,void 0,void 0,rr.mark(function _(){var Y,de,V,Fe,Et=this;return rr.wrap(function(fr){for(;;)switch(fr.prev=fr.next){case 0:return zr({type:{type:"number",min:1,max:5},opeType:{type:"number",min:1,max:2}},A),fr.next=3,this.core.sendCmd("qchatSubscribe",{qchatSubReqTag:{type:A.type,opeType:A.opeType},channels:A.channels});case 3:return de=fr.sent,V=new nl,kn(Y=A.channels).call(Y,function(Sr){return kr(Et,void 0,void 0,rr.mark(function Tr(){return rr.wrap(function(Lr){for(;;)switch(Lr.prev=Lr.next){case 0:this.serverRoleIdsMap[Sr.serverId]||V.add(Sr.serverId);case 1:case"end":return Lr.stop()}},Tr,this)}))}),Fe=il(_c(V),10),kn(Fe).call(Fe,function(Sr){Et.getRoleIdsByServerId(Sr)}),fr.abrupt("return",de.content);case 9:case"end":return fr.stop()}},_,this)}))},w.resumeSubscribe=function(A){return kr(this,void 0,void 0,rr.mark(function _(){var Y,de,V,Fe,Et,sr,fr,Sr=this;return rr.wrap(function(Pr){for(;;)switch(Pr.prev=Pr.next){case 0:if(this.serverRoleIdsMap={},this.unreadServerCount={},this.unreadCount={},Et=100,A.isAutoReconnect){Pr.next=6;break}return Pr.abrupt("return");case 6:return sr={},kn(Y=Yo(this.autoSubscribeUnreadMap)).call(Y,function(Lr){var jr=Sr.autoSubscribeUnreadMap[Lr];if(jr){var Jr=Lr.split("_"),Gr={serverId:Jr[0],channelId:Jr[1]};sr[jr]=sr[jr]||[],sr[jr].push(Gr)}}),sr[5]=[],kn(de=Yo(this.autoSubscribeTypingMap)).call(de,function(Lr){return kr(Sr,void 0,void 0,rr.mark(function jr(){var Jr,Gr,Mn,Qr;return rr.wrap(function(Bn){for(;;)switch(Bn.prev=Bn.next){case 0:this.autoSubscribeTypingMap[Lr]&&(Jr=Lr.split("_"),Gr=Jr[0],Mn=Jr[1],Qr={serverId:Gr,channelId:Mn},sr[5].push(Qr));case 2:case"end":return Bn.stop()}},jr,this)}))}),sr[4]=[],kn(V=Yo(this.autoSubscribeServerMap)).call(V,function(Lr){return kr(Sr,void 0,void 0,rr.mark(function jr(){var Jr;return rr.wrap(function(Mn){for(;;)switch(Mn.prev=Mn.next){case 0:this.autoSubscribeServerMap[Lr]&&(Jr={serverId:Lr},sr[4].push(Jr));case 2:case"end":return Mn.stop()}},jr,this)}))}),fr=[],kn(Fe=Yo(sr)).call(Fe,function(Lr){var jr=sr[Lr];if(jr&&jr.length===0)return ro.resolve();if(jr.length>Et){var Jr=il(jr,100);return kn(Jr).call(Jr,function(Gr){fr.push(Sr.createSubscribePromise(Gr,Lr))})}fr.push(Sr.createSubscribePromise(jr,Lr))}),Pr.next=16,ro.all(fr);case 16:case"end":return Pr.stop()}},_,this)}))},w.createSubscribePromise=function(A,_){var Y=this,de={type:wo(_),opeType:1,channels:A};return this.core.logger.debug("qchatChannel:: autoSubscribeUnread params",de),this.subscribe(de).then(function(V){var Fe=V.unreadInfos;Fe&&Fe.length>0&&(Fe=Ud(Fe),Y.cacheUnreadCount(Fe))}).catch(function(V){Y.core.logger.error("qchatChannel:: autoSubscribeUnread error ",V)})},w.cacheSubscribe=function(A){var _,Y=this;kn(_=A.channels).call(_,function(de){var V=de.channelId?de.serverId+"_"+de.channelId:""+de.serverId,Fe=A.type===5?Y.autoSubscribeTypingMap:A.type===4?Y.autoSubscribeServerMap:Y.autoSubscribeUnreadMap;A.opeType===zd.sub?Fe[V]=A.type:A.opeType===zd.unSub&&(Fe[V]=void 0)})},w.cacheUnreadCount=function(A){var _=this;kn(A).call(A,function(Y){var de=Y.serverId+"_"+Y.channelId;_.unreadCount[de]=Xr({},Y),_.unreadServerCount[Y.serverId]||(_.unreadServerCount[Y.serverId]={}),_.unreadServerCount[Y.serverId][Y.channelId]=!0})},w.getServerUnreadInfo=function(A){var _,Y=this,de={serverId:A,unreadCount:0,mentionedCount:0,maxCount:0},V=this.unreadServerCount[A];return V&&(kn(_=Yo(V)).call(_,function(Fe){var Et=A+"_"+Fe,sr=Y.unreadCount[Et];de.unreadCount+=sr.unreadCount,de.mentionedCount+=sr.mentionedCount,sr.maxCount!==void 0&&(de.maxCount=sr.maxCount)}),de.unreadCount=de.unreadCount>de.maxCount?de.maxCount:de.unreadCount,de.mentionedCount=de.mentionedCount>de.maxCount?de.maxCount:de.mentionedCount),de},w.getUnreadInfo=function(A){zr({serverId:{type:"string"},channelId:{type:"string"}},A);var _=A.serverId+"_"+A.channelId;return this.unreadCount[_]?this.unreadCount[_]:null},w.shouldChangeUnread=function(A,_){if(!A.serverId||!A.channelId||this.core.qchatChannel.subscribeForVisitorService.isInSubscribeChannels(A.serverId,A.channelId)||A.historyEnable===!1||A.needBadge===!1||A.fromAccount===this.core.account||_&&(A==null?void 0:A.status)!==2)return!1;if(A.notifyReason&&A.notifyReason===Dy(Vd,Vd.notifySubscribe)){if(!A.serverId||!A.channelId)return!1;var Y=this.getUnreadInfo({serverId:A.serverId,channelId:A.channelId}),de=_?"ackTimestamp":"lastMsgTime";if(!Y||A.time&&Y[de]&&Y[de]>A.time)return!1}return!0},w.shouldChangeMentionedUnread=function(A,_){return _===void 0&&(_=!1),kr(this,void 0,void 0,rr.mark(function Y(){var de,V;return rr.wrap(function(Et){for(;;)switch(Et.prev=Et.next){case 0:if(!A.accidsOfMentionedRoles||!ha(de=A.accidsOfMentionedRoles).call(de,this.core.account)){Et.next=2;break}return Et.abrupt("return",!0);case 2:if(!A.mentionRoleIds||!A.serverId){Et.next=16;break}if(this.serverRoleIdsMap[A.serverId]){Et.next=9;break}if(_){Et.next=7;break}return this.handledRoleMsg(A),Et.abrupt("return",!1);case 7:return Et.next=9,this.getRoleIdsByServerId([A.serverId]);case 9:V=0;case 10:if(!(V<A.mentionRoleIds.length)){Et.next=16;break}if(!this.serverRoleIdsMap[A.serverId].roleIds.has(A.mentionRoleIds[V])){Et.next=13;break}return Et.abrupt("return",!0);case 13:V++,Et.next=10;break;case 16:return Et.abrupt("return",!1);case 17:case"end":return Et.stop()}},Y,this)}))},w.handledRoleMsg=function(A){return kr(this,void 0,void 0,rr.mark(function _(){var Y,de,V,Fe,Et,sr=this;return rr.wrap(function(Sr){for(;;)switch(Sr.prev=Sr.next){case 0:if(A.mentionRoleIds){Sr.next=2;break}return Sr.abrupt("return");case 2:if(this.serverRoleIdsMap[A.serverId]){Sr.next=5;break}return Sr.next=5,this.getRoleIdsByServerId([A.serverId]);case 5:if(this.serverRoleIdsMap[A.serverId]){Sr.next=8;break}return this.core.logger.warn("QChatChannel::handledRoleMsg::can not get serverRoleIds,server id",A.serverId),Sr.abrupt("return");case 8:if(de=!1,kn(Y=A.mentionRoleIds).call(Y,function(Tr){sr.serverRoleIdsMap[A.serverId].roleIds.has(Tr)&&(de=!0,sr.core.logger.debug("QChatChannel::handledRoleMsg::will update message mentionedCount，message is ",A))}),de){Sr.next=12;break}return Sr.abrupt("return");case 12:if(V=this.unreadCount[A.serverId+"_"+A.channelId],Fe=(A==null?void 0:A.status)===2,V.mentionedCount=Fe?V.mentionedCount?V.mentionedCount-1:0:V.mentionedCount?V.mentionedCount+1:1,typeof V.maxCount!="number"){Sr.next=24;break}if(!((Et=(Et=V.mentionedCount)>V.maxCount?V.maxCount:Et)>V.maxCount)){Sr.next=21;break}return this.core.logger.debug("QChatChannel::handledRoleMsg::tempUnreadCount more than maxCount"),Sr.abrupt("return");case 21:this.core.emit("unreadInfo",Xr(Xr({},V),{mentionedCount:Et})),this.core.emit("unreadInfos",[Xr(Xr({},V),{mentionedCount:Et})]),this._serverUnreadInfo(A.serverId);case 24:case"end":return Sr.stop()}},_,this)}))},w.getMentionedFlag=function(A,_){return _===void 0&&(_=!1),kr(this,void 0,void 0,rr.mark(function Y(){var de;return rr.wrap(function(Fe){for(;;)switch(Fe.prev=Fe.next){case 0:if(!A.mentionAll){Fe.next=4;break}return Fe.abrupt("return",!0);case 4:if(!A.mentionRoleIds&&!A.accidsOfMentionedRoles){Fe.next=10;break}return Fe.next=7,this.shouldChangeMentionedUnread(A,_);case 7:return Fe.abrupt("return",Fe.sent);case 10:if(!A.mentionAccids||!ha(de=A.mentionAccids).call(de,this.core.account)){Fe.next=12;break}return Fe.abrupt("return",!0);case 12:return Fe.abrupt("return",!1);case 13:case"end":return Fe.stop()}},Y,this)}))},w.changeUnread=function(A,_){return kr(this,void 0,void 0,rr.mark(function Y(){var de,V,Fe,Et,sr,fr,Sr;return rr.wrap(function(Pr){for(;;)switch(Pr.prev=Pr.next){case 0:if(de=A.serverId,V=A.channelId,Fe=de+"_"+V,this.shouldChangeUnread(A,_)){Pr.next=6;break}return this.core.logger.debug("changeUnread: "+Fe+" does not need to update unreadInfo"),Pr.abrupt("return");case 6:if(this.unreadCount[Fe]){Pr.next=11;break}return Pr.next=9,this.core.qchatChannel.getChannelUnreadInfos({channels:[{serverId:de,channelId:V}]});case 9:return!this.serverRoleIdsMap[de]&&A.mentionRoleIds&&this.getRoleIdsByServerId([de]),Pr.abrupt("return");case 11:return Et=this.unreadCount[Fe],sr=(A==null?void 0:A.status)===2,Pr.next=15,this.getMentionedFlag(A);case 15:if(fr=Pr.sent,sr?(Et.unreadCount=Et.unreadCount?Et.unreadCount-1:0,fr&&(Et.mentionedCount=Et.mentionedCount?Et.mentionedCount-1:0),delete Et.lastMsgTime,this.core.logger.debug("changeUnread: "+Fe+" unread reduce ",Et)):(Et.unreadCount=Et.unreadCount?Et.unreadCount+1:1,fr&&(Et.mentionedCount=Et.mentionedCount?Et.mentionedCount+1:1),A.time&&(Et.lastMsgTime=A.time),this.core.logger.debug("changeUnread: "+Fe+" unread add ",Et)),Sr=typeof Et.maxCount=="number"?Et.maxCount:100,!(Et.unreadCount>Sr)){Pr.next=21;break}return this.core.logger.debug("QChatChannel::subscribe::tempUnreadCount more than maxCount"),Pr.abrupt("return");case 21:this.core.logger.warn("unreadInfo event will abandon,please use unreadInfos"),this.core.emit("unreadInfo",Xr(Xr({},Et),{mentionedCount:Et.mentionedCount>Sr?Sr:Et.mentionedCount,unreadCount:Et.unreadCount>Sr?Sr:Et.unreadCount})),this.core.emit("unreadInfos",[Xr(Xr({},Et),{mentionedCount:Et.mentionedCount>Sr?Sr:Et.mentionedCount,unreadCount:Et.unreadCount>Sr?Sr:Et.unreadCount})]),this._serverUnreadInfo(de);case 25:case"end":return Pr.stop()}},Y,this)}))},w.updateUnreads=function(A){var _,Y=this;if(A&&A.length>0){var de=this.getServerUnreadInfo(A[0].serverId),V=this.unreadServerCount[A[0].serverId],Fe=co(_=Ys(A).call(A,function(Lr){var jr=Lr.serverId+"_"+Lr.channelId,Jr=Y.unreadCount[jr],Gr=Vi(Jr,"ackTimestamp"),Mn=Vi(Lr,"ackTimestamp");return!(Gr&&Mn&&Mn<Gr)&&(Vi(Jr,"unreadCount")!==Vi(Lr,"unreadCount")||Vi(Jr,"mentionedCount")!==Vi(Lr,"mentionedCount"))})).call(_,function(Lr){var jr=Lr.serverId,Jr=Lr.channelId,Gr=jr+"_"+Jr;return Y.core.logger.debug("qchat channel updateUnread: ",Lr),Y.unreadCount[Gr]=Xr({},Lr),Y.unreadServerCount[jr]||(Y.unreadServerCount[jr]={}),Y.unreadServerCount[jr][Jr]=!0,Lr});if(Fe.length>0){this.core.emit("unreadInfos",Fe);var Et=this.getServerUnreadInfo(A[0].serverId),sr=this.unreadServerCount[A[0].serverId],fr=de.unreadCount!==Et.unreadCount,Sr=!V||Yo(V).length===0,Tr=sr&&Yo(sr).length>0,Pr=de.mentionedCount!==Et.mentionedCount;(fr||Pr||Sr&&Tr)&&this._serverUnreadInfo(Fe[0].serverId)}kn(Fe).call(Fe,function(Lr){Y.core.emit("unreadInfo",Lr)})}},w.clearUnreadCountByServers=function(A,_){var Y=this,de=[];kn(A).call(A,function(Fe){var Et;Y.unreadServerCount[Fe]&&kn(Et=Yo(Y.unreadServerCount[Fe])).call(Et,function(sr){de.push(Fe+"_"+sr)})});var V=[];kn(de).call(de,function(Fe){V.push(Xr(Xr({},Y.unreadCount[Fe]),{unreadCount:0,mentionedCount:0,ackTimestamp:_}))}),this.updateUnreads(V)},b}(),eM=function(){function b($){this.limitForBatchEnter=10,this.limitForBatchSubscribe=100,this.autoServers=new nl,this.autoVisitorSubscribeServer=new nl,this.autoVisitorSubscribeChannel=new nl,this.core=$}var w=b.prototype;return w.subscribeChannelAsVisitor=function(A){return kr(this,void 0,void 0,rr.mark(function _(){var Y,de,V,Fe,Et=this;return rr.wrap(function(fr){for(;;)switch(fr.prev=fr.next){case 0:return fr.next=2,this.core.sendCmd("qchatSubscribeAsVisitor",{tag:{type:A.type||6,opeType:A.opeType},datas:A.channels});case 2:return de=fr.sent,V=de.content.failedArr,Fe=Ys(Y=A.channels).call(Y,function(Sr){return!Bp(V).call(V,function(Tr){return Tr.channelId===Sr.channelId&&Tr.serverId===Sr.serverId})}),kn(Fe).call(Fe,function(Sr){A.opeType===1?Et.autoVisitorSubscribeChannel.add(Sr.serverId+"&"+Sr.channelId):Et.autoVisitorSubscribeChannel.delete(Sr.serverId+"&"+Sr.channelId)}),fr.abrupt("return",{failedChannels:V});case 7:case"end":return fr.stop()}},_,this)}))},w.subscribeServerAsVisitor=function(A){return kr(this,void 0,void 0,rr.mark(function _(){var Y,de,V,Fe,Et,sr,fr=this;return rr.wrap(function(Tr){for(;;)switch(Tr.prev=Tr.next){case 0:return Tr.next=2,this.core.sendCmd("qchatSubscribeAsVisitor",{tag:{type:A.type||7,opeType:A.opeType},datas:co(Y=A.serverIds).call(Y,function(Pr){return{serverId:Pr}})});case 2:return Fe=Tr.sent,Et=Fe.content.failedArr,sr=Ys(de=A.serverIds).call(de,function(Pr){return!Bp(Et).call(Et,function(Lr){return Lr.serverId===Pr})}),kn(sr).call(sr,function(Pr){A.opeType===1?fr.autoVisitorSubscribeServer.add(Pr):fr.autoVisitorSubscribeServer.delete(Pr)}),Tr.abrupt("return",{failedServers:co(V=Fe.content.failedArr).call(V,function(Pr){return Pr.serverId})});case 7:case"end":return Tr.stop()}},_,this)}))},w.deleteServer=function(A){var _;this.autoServers.delete(A),this.autoVisitorSubscribeServer.has(A)&&this.subscribeServerAsVisitor({opeType:2,serverIds:[A]});var Y=[];kn(_=this.autoVisitorSubscribeChannel).call(_,function(de){if(ai(de).call(de,A)===0){var V=de.replace(A+"&","");Y.push({serverId:A,channelId:V})}}),Y.length>0&&this.subscribeChannelAsVisitor({opeType:2,channels:Y})},w.deleteAutoSetInServerId=function(A){var _,Y=this;this.autoServers.delete(A),this.autoVisitorSubscribeServer.delete(A),kn(_=this.autoVisitorSubscribeChannel).call(_,function(de){ai(de).call(de,A)===0&&Y.autoVisitorSubscribeChannel.delete(de)})},w.deleteAutoSetInChannel=function(A,_){this.autoVisitorSubscribeChannel.delete(A+"&"+_)},w.unSubscribeChannel=function(A,_){this.subscribeChannelAsVisitor({opeType:2,channels:[{serverId:A,channelId:_}]})},w.isInSubscribeChannels=function(A,_){return this.autoVisitorSubscribeChannel.has(A+"&"+_)},w.isInAutoServers=function(A){return this.autoServers.has(A)},w.doAutoSubscribe=function(){var A=this,_=[],Y=il(_c(this.autoVisitorSubscribeServer),this.limitForBatchSubscribe);kn(Y).call(Y,function(V){_.push(A.subscribeServerAsVisitor({opeType:1,serverIds:V}))});var de=il(_c(this.autoVisitorSubscribeChannel),this.limitForBatchSubscribe);return kn(de).call(de,function(V){_.push(A.subscribeChannelAsVisitor({opeType:1,channels:co(V).call(V,function(Fe){var Et=ai(Fe).call(Fe,"&");return{serverId:fo(Fe).call(Fe,0,Et),channelId:fo(Fe).call(Fe,Et+1)}})}))}),ro.all(_)},w.doAutoEnterServer=function(){return kr(this,void 0,void 0,rr.mark(function A(){var _,Y,de,V=this;return rr.wrap(function(Et){for(;;)switch(Et.prev=Et.next){case 0:return _=il(_c(this.autoServers),this.limitForBatchEnter),Y=[],kn(_).call(_,function(sr){Y.push(V.core.qchatServer.enterAsVisitor({serverIds:sr}))}),Et.next=5,ro.all(Y);case 5:de=Et.sent,kn(de).call(de,function(sr){var fr;kn(fr=sr.failedServers).call(fr,function(Sr){V.deleteAutoSetInServerId(Sr)})});case 7:case"end":return Et.stop()}},A,this)}))},w.resumeSubscribe=function(A){return kr(this,void 0,void 0,rr.mark(function _(){return rr.wrap(function(de){for(;;)switch(de.prev=de.next){case 0:if(!A.isAutoReconnect){de.next=7;break}return de.next=3,this.doAutoEnterServer();case 3:return de.next=5,this.doAutoSubscribe();case 5:de.next=10;break;case 7:this.autoServers.clear(),this.autoVisitorSubscribeChannel.clear(),this.autoVisitorSubscribeServer.clear();case 10:case"end":return de.stop()}},_,this)}))},w.cacheServer=function(A){var _=this;kn(A).call(A,function(Y){return _.autoServers.add(Y)})},b}();(function(b){b[b.sub=1]="sub",b[b.unSub=2]="unSub"})(Bh||(Bh={}));var tM=function(b){function w(A){var _,Y,de,V,Fe,Et;return(Et=b.call(this,"qchatChannel",A)||this).core=A,Oa({cmdMap:Od,cmdConfig:wh}),Et.subscribeModuleService=new ZS(A),Et.subscribeForVisitorService=new eM(A),Et.core.eventBus.on("qchatChannel/changeUnread",Mo(_=Et.subscribeModuleService.changeUnread).call(_,Et.subscribeModuleService)),Et.core.eventBus.on("qchatChannel/updateUnreads",Mo(Y=Et.subscribeModuleService.updateUnreads).call(Y,Et.subscribeModuleService)),Et.core.eventBus.on("qchatChannel/cacheSubscribe",Mo(de=Et.subscribeModuleService.cacheSubscribe).call(de,Et.subscribeModuleService)),Et.core.eventBus.on("qchatChannel/clearUnreadCountByServers",Mo(V=Et.subscribeModuleService.clearUnreadCountByServers).call(V,Et.subscribeModuleService)),Et.core.eventBus.on("qchatChannel/getRoleIdsByServerId",Mo(Fe=Et.subscribeModuleService.getRoleIdsByServerId).call(Fe,Et.subscribeModuleService)),Et.core.eventBus.on("logined",function(sr){Et.subscribeModuleService.resumeSubscribe(sr),Et.subscribeForVisitorService.resumeSubscribe(sr)}),Et.core.eventBus.on("qchatChannel/autoUnSubscribe",function(sr){if(Et.logger.log("QChatChannel::enter autoUnSubscribe sysMsg is",sr),sr.type===zo[zo.channelVisibilityUpdate])Et.logger.log("QChatChannel::begin autoUnSubscribe channel key is",sr.serverId+"_"+sr.channelId),Et.subscribeModuleService._unSubscribeChannel(sr.serverId,sr.channelId),Et.logger.log("QChatChannel::autoUnSubscribe channel done key is",sr.serverId+"_"+sr.channelId);else if(sr.type===zo[zo.serverEnterLeave]){var fr;Et.subscribeModuleService.autoSubscribeServerMap[sr.serverId]&&(Et.logger.log("QChatChannel::begin autoUnSubscribe server key is",sr.serverId),Et.subscribeModuleService.subscribe({type:4,opeType:Bh.unSub,channels:[{serverId:sr.serverId,channelId:""}]}),Et.logger.log("QChatChannel::autoUnSubscribe server done key is",sr.serverId));var Sr=Et.subscribeModuleService.unreadServerCount[sr.serverId];if(!Sr)return;Et.logger.log("QChatChannel::begin autoUnSubscribe channels key is",Yo(Sr)),kn(fr=Yo(Sr)).call(fr,function(Tr){Et.subscribeModuleService._unSubscribeChannel(sr.serverId,Tr)}),Et.logger.log("QChatChannel::autoUnSubscribe channels done key is",Yo(Sr))}}),Et.core.eventBus.on("qchatChannel/serverIdentifyChange",function(sr){Et.subscribeModuleService.changeCacheServerRoleIds(sr)}),Et}Co(w,b);var $=w.prototype;return $.createChannel=function(_){return kr(this,void 0,void 0,rr.mark(function Y(){var de;return rr.wrap(function(Fe){for(;;)switch(Fe.prev=Fe.next){case 0:return zr({serverId:{type:"string",min:1},type:{type:"enum",values:ri(bu)},name:{type:"string",required:!1},topic:{type:"string",required:!1},ext:{type:"string",required:!1},visitorMode:{type:"number",required:!1}},_),Fe.next=3,this.core.sendCmd("qchatCreateChannel",{channelInfo:Xr(Xr({},_),{type:bu[_.type]}),antispamTag:Rc(_)});case 3:return de=Fe.sent,Fe.abrupt("return",Bd(de.content.channelInfo));case 5:case"end":return Fe.stop()}},Y,this)}))},$.deleteChannel=function(_){return kr(this,void 0,void 0,rr.mark(function Y(){return rr.wrap(function(V){for(;;)switch(V.prev=V.next){case 0:return zr({channelId:{type:"string",allowEmpty:!1}},_),V.next=3,this.core.sendCmd("qchatDeleteChannel",_);case 3:case"end":return V.stop()}},Y,this)}))},$.updateChannel=function(_){return kr(this,void 0,void 0,rr.mark(function Y(){var de,V;return rr.wrap(function(Et){for(;;)switch(Et.prev=Et.next){case 0:return zr({channelId:{type:"string",min:1},serverId:{type:"string",required:!1},type:{type:"enum",values:ri(bu),required:!1},name:{type:"string",required:!1},topic:{type:"string",required:!1},ext:{type:"string",required:!1},visitorMode:{type:"number",required:!1}},_),de=_,_.type&&(de.type=bu[_.type]),Et.next=5,this.core.sendCmd("qchatUpdateChannel",{channelInfo:de,antispamTag:Rc(_)});case 5:return V=Et.sent,Et.abrupt("return",Bd(V.content.channelInfo));case 7:case"end":return Et.stop()}},Y,this)}))},$.getChannels=function(_){return kr(this,void 0,void 0,rr.mark(function Y(){var de;return rr.wrap(function(Fe){for(;;)switch(Fe.prev=Fe.next){case 0:return zr({channelIds:{type:"array",itemType:"string",min:1}},_),Fe.next=3,this.core.sendCmd("qchatGetChannels",_);case 3:return de=Fe.sent,Fe.abrupt("return",Ld(de.content.channelList));case 5:case"end":return Fe.stop()}},Y,this)}))},$.getChannelsByPage=function(_){return kr(this,void 0,void 0,rr.mark(function Y(){var de,V,Fe,Et;return rr.wrap(function(fr){for(;;)switch(fr.prev=fr.next){case 0:return zr({serverId:{type:"string",min:1},timetag:{type:"number"},limit:{type:"number",min:1,required:!1}},_),fr.next=3,this.core.sendCmd("qchatGetChannelsByPage",{qchatGetChannelListPageTag:Xr({limit:100},_)});case 3:return de=fr.sent,V=de.content,Fe=V.datas,Et=V.listQueryTag,fr.abrupt("return",{listQueryTag:{hasMore:+Et.hasMore==1,nextTimetag:wo(Et.nextTimetag)},datas:Ld(Fe)});case 6:case"end":return fr.stop()}},Y,this)}))},$.getMembersByPage=function(_){return kr(this,void 0,void 0,rr.mark(function Y(){var de,V,Fe,Et;return rr.wrap(function(fr){for(;;)switch(fr.prev=fr.next){case 0:return zr({serverId:{type:"string",min:1},channelId:{type:"string",min:1},timetag:{type:"number"},limit:{type:"number",min:1,required:!1}},_),fr.next=3,this.core.sendCmd("qchatGetMembersByPage",{qchatGetMembersByPageTag:_});case 3:return de=fr.sent,V=de.content,Fe=V.datas,Et=V.listQueryTag,fr.abrupt("return",{listQueryTag:{hasMore:+Et.hasMore==1,nextTimetag:wo(Et.nextTimetag)},datas:dc(Fe)});case 6:case"end":return fr.stop()}},Y,this)}))},$.updateWhiteBlackRole=function(_){return kr(this,void 0,void 0,rr.mark(function Y(){return rr.wrap(function(V){for(;;)switch(V.prev=V.next){case 0:return zr({serverId:{type:"string",min:1},channelId:{type:"string",min:1},roleId:{type:"string",min:1},type:{type:"enum",values:ri(ni)},opeType:{type:"enum",values:ri(ea)}},_),V.next=3,this.core.sendCmd("qchatUpdateWhiteBlackRole",{qchatUpdateWhiteBlackRoleTag:Xr(Xr({},_),{type:ni[_.type],opeType:ea[_.opeType]})});case 3:case"end":return V.stop()}},Y,this)}))},$.getWhiteBlackRolesPage=function(_){return kr(this,void 0,void 0,rr.mark(function Y(){var de,V,Fe,Et;return rr.wrap(function(fr){for(;;)switch(fr.prev=fr.next){case 0:return zr({serverId:{type:"string",min:1},channelId:{type:"string",min:1},type:{type:"enum",values:ri(ni)},timetag:{type:"number"},limit:{type:"number",min:1,required:!1}},_),fr.next=3,this.core.sendCmd("qchatGetWhiteBlackRolesPage",{qchatGetWhiteBlackRolesPageTag:Xr(Xr({},_),{type:ni[_.type]})});case 3:return de=fr.sent,V=de.content,Fe=V.datas,Et=V.listQueryTag,fr.abrupt("return",{listQueryTag:{hasMore:+Et.hasMore==1,nextTimetag:wo(Et.nextTimetag)},datas:zs(Fe)});case 6:case"end":return fr.stop()}},Y,this)}))},$.updateWhiteBlackMembers=function(_){return kr(this,void 0,void 0,rr.mark(function Y(){return rr.wrap(function(V){for(;;)switch(V.prev=V.next){case 0:return zr({serverId:{type:"string",min:1},channelId:{type:"string",min:1},type:{type:"enum",values:ri(ni)},opeType:{type:"enum",values:ri(ea)},toAccids:{type:"array",itemType:"string",min:1}},_),V.next=3,this.core.sendCmd("qchatUpdateWhiteBlackMembers",{qchatUpdateWhiteBlackMembersTag:Xr(Xr({},_),{type:ni[_.type],opeType:ea[_.opeType],toAccids:so(_.toAccids)})});case 3:case"end":return V.stop()}},Y,this)}))},$.getWhiteBlackMembersPage=function(_){return kr(this,void 0,void 0,rr.mark(function Y(){var de,V,Fe,Et;return rr.wrap(function(fr){for(;;)switch(fr.prev=fr.next){case 0:return zr({serverId:{type:"string",min:1},channelId:{type:"string",min:1},type:{type:"enum",values:ri(ni)},timetag:{type:"number"},limit:{type:"number",min:1,required:!1}},_),fr.next=3,this.core.sendCmd("qchatGetWhiteBlackMembersPage",{qchatGetWhiteBlackMembersPageTag:Xr(Xr({limit:100},_),{type:ni[_.type]})});case 3:return de=fr.sent,V=de.content,Fe=V.datas,Et=V.listQueryTag,fr.abrupt("return",{listQueryTag:{hasMore:+Et.hasMore==1,nextTimetag:wo(Et.nextTimetag)},datas:dc(Fe)});case 6:case"end":return fr.stop()}},Y,this)}))},$.getExistingWhiteBlackRoles=function(_){return kr(this,void 0,void 0,rr.mark(function Y(){var de,V;return rr.wrap(function(Et){for(;;)switch(Et.prev=Et.next){case 0:return zr({serverId:{type:"string",min:1},channelId:{type:"string",min:1},type:{type:"enum",values:ri(ni)},roleIds:{type:"array",itemType:"string",min:1}},_),Et.next=3,this.core.sendCmd("qchatGetExistingWhiteBlackRoles",{qchatGetExistingWhiteBlackRolesTag:Xr(Xr({},_),{type:ni[_.type],roleIds:so(_.roleIds)})});case 3:return de=Et.sent,V=de.content.datas,Et.abrupt("return",{datas:zs(V)});case 6:case"end":return Et.stop()}},Y,this)}))},$.getExistingWhiteBlackMembers=function(_){return kr(this,void 0,void 0,rr.mark(function Y(){var de,V;return rr.wrap(function(Et){for(;;)switch(Et.prev=Et.next){case 0:return zr({serverId:{type:"string",min:1},channelId:{type:"string",min:1},type:{type:"enum",values:ri(ni)},accids:{type:"array",itemType:"string",min:1}},_),Et.next=3,this.core.sendCmd("qchatGetExistingWhiteBlackMembers",{qchatGetExistingWhiteBlackMembersTag:Xr(Xr({},_),{type:ni[_.type],accids:so(_.accids)})});case 3:return de=Et.sent,V=de.content.datas,Et.abrupt("return",{datas:dc(V)});case 6:case"end":return Et.stop()}},Y,this)}))},$.updateCategoryInfoOfChannel=function(_){return kr(this,void 0,void 0,rr.mark(function Y(){var de;return rr.wrap(function(Fe){for(;;)switch(Fe.prev=Fe.next){case 0:return zr({channelId:{type:"string",min:1},categoryId:{type:"string",allowEmpty:!1,required:!1},syncMode:{type:"number",min:0,max:1,required:!1}},_),Fe.next=3,this.core.sendCmd("qchatUpdateCategoryInfoOfChannel",{qchatUpdateCategoryInfoOfChannelTag:_});case 3:return de=Fe.sent,Fe.abrupt("return",Bd(de.content.channelInfo));case 5:case"end":return Fe.stop()}},Y,this)}))},$.createChannelCategory=function(_){return kr(this,void 0,void 0,rr.mark(function Y(){var de;return rr.wrap(function(Fe){for(;;)switch(Fe.prev=Fe.next){case 0:return zr({serverId:{type:"string",allowEmpty:!1},name:{type:"string",allowEmpty:!1,required:!1},ext:{type:"string",required:!1},viewMode:{type:"number",min:0,max:1,required:!1}},_),Fe.next=3,this.core.sendCmd("qchatCreateChannelCategory",{qchatCreateChannelCategoryTag:_});case 3:return de=Fe.sent,Fe.abrupt("return",Dd(de.content.QChatChannelCategoryInfo));case 5:case"end":return Fe.stop()}},Y,this)}))},$.removeChannelCategory=function(_){return kr(this,void 0,void 0,rr.mark(function Y(){return rr.wrap(function(V){for(;;)switch(V.prev=V.next){case 0:return zr({categoryId:{type:"string",allowEmpty:!1}},_),V.next=3,this.core.sendCmd("qchatRemoveChannelCategory",_);case 3:case"end":return V.stop()}},Y,this)}))},$.updateChannelCategory=function(_){return kr(this,void 0,void 0,rr.mark(function Y(){var de;return rr.wrap(function(Fe){for(;;)switch(Fe.prev=Fe.next){case 0:return zr({categoryId:{type:"string",allowEmpty:!1},name:{type:"string",allowEmpty:!1,required:!1},ext:{type:"string",required:!1},viewMode:{type:"number",min:0,max:1,required:!1}},_),Fe.next=3,this.core.sendCmd("qchatUpdateChannelCategory",{qchatUpdateChannelCategoryTag:_});case 3:return de=Fe.sent,Fe.abrupt("return",Dd(de.content.QChatChannelCategoryInfo));case 5:case"end":return Fe.stop()}},Y,this)}))},$.getChannelCategoriesByID=function(_){return kr(this,void 0,void 0,rr.mark(function Y(){var de;return rr.wrap(function(Fe){for(;;)switch(Fe.prev=Fe.next){case 0:return zr({categoryIds:{type:"array",itemType:"string",min:1}},_),Fe.next=3,this.core.sendCmd("qchatGetChannelCategoriesByID",_);case 3:return de=Fe.sent,Fe.abrupt("return",Ph(de.content.channelCategoryList));case 5:case"end":return Fe.stop()}},Y,this)}))},$.updateChannelCategoryWhiteBlackRole=function(_){return kr(this,void 0,void 0,rr.mark(function Y(){return rr.wrap(function(V){for(;;)switch(V.prev=V.next){case 0:return zr({categoryId:{type:"string",allowEmpty:!1},serverId:{type:"string",allowEmpty:!1},type:{type:"enum",values:ri(ni)},opeType:{type:"enum",values:ri(ea)},roleId:{type:"string",allowEmpty:!1}},_),V.next=3,this.core.sendCmd("qchatUpdateChannelCategoryWhiteBlackRole",{qchatUpdateChannelCategoryWhiteBlackRoleTag:Xr(Xr({},_),{type:ni[_.type],opeType:ea[_.opeType]})});case 3:case"end":return V.stop()}},Y,this)}))},$.getChannelCategoryWhiteBlackRolesPage=function(_){return kr(this,void 0,void 0,rr.mark(function Y(){var de,V,Fe,Et;return rr.wrap(function(fr){for(;;)switch(fr.prev=fr.next){case 0:return zr({categoryId:{type:"string",allowEmpty:!1},serverId:{type:"string",allowEmpty:!1},type:{type:"enum",values:ri(ni)},timetag:{type:"number",min:0},limit:{type:"number",min:1,required:!1}},_),fr.next=3,this.core.sendCmd("qchatGetChannelCategoryWhiteBlackRolesPage",{qchatGetChannelCategoryWhiteBlackRolesPageTag:Xr(Xr({},_),{type:ni[_.type]})});case 3:return de=fr.sent,V=de.content,Fe=V.datas,Et=V.listQueryTag,fr.abrupt("return",{listQueryTag:{hasMore:+Et.hasMore==1,nextTimetag:wo(Et.nextTimetag)},datas:zs(Fe)});case 6:case"end":return fr.stop()}},Y,this)}))},$.updateChannelCategoryWhiteBlackMembers=function(_){return kr(this,void 0,void 0,rr.mark(function Y(){return rr.wrap(function(V){for(;;)switch(V.prev=V.next){case 0:return zr({categoryId:{type:"string",allowEmpty:!1},serverId:{type:"string",allowEmpty:!1},type:{type:"enum",values:ri(ni)},opeType:{type:"enum",values:ri(ea)},toAccids:{type:"array",itemType:"string",min:1}},_),V.next=3,this.core.sendCmd("qchatUpdateChannelCategoryWhiteBlackMembers",{qchatUpdateChannelCategoryWhiteBlackMembersTag:Xr(Xr({},_),{type:ni[_.type],opeType:ea[_.opeType],toAccids:so(_.toAccids)})});case 3:case"end":return V.stop()}},Y,this)}))},$.getChannelCategoryWhiteBlackMembersPage=function(_){return kr(this,void 0,void 0,rr.mark(function Y(){var de,V,Fe,Et;return rr.wrap(function(fr){for(;;)switch(fr.prev=fr.next){case 0:return zr({categoryId:{type:"string",allowEmpty:!1},serverId:{type:"string",allowEmpty:!1},type:{type:"enum",values:ri(ni)},timetag:{type:"number",min:0},limit:{type:"number",min:1,required:!1}},_),fr.next=3,this.core.sendCmd("qchatGetChannelCategoryWhiteBlackMembersPage",{qchatGetChannelCategoryWhiteBlackMembersPageTag:Xr(Xr({},_),{type:ni[_.type]})});case 3:return de=fr.sent,V=de.content,Fe=V.datas,Et=V.listQueryTag,fr.abrupt("return",{listQueryTag:{hasMore:+Et.hasMore==1,nextTimetag:wo(Et.nextTimetag)},datas:dc(Fe)});case 6:case"end":return fr.stop()}},Y,this)}))},$.getChannelCategoryWhiteBlackRoles=function(_){return kr(this,void 0,void 0,rr.mark(function Y(){var de,V;return rr.wrap(function(Et){for(;;)switch(Et.prev=Et.next){case 0:return zr({categoryId:{type:"string",allowEmpty:!1},serverId:{type:"string",allowEmpty:!1},type:{type:"enum",values:ri(ni)},roleIds:{type:"array",itemType:"string",min:1}},_),Et.next=3,this.core.sendCmd("qchatGetChannelCategoryWhiteBlackRoles",{qchatGetChannelCategoryWhiteBlackRolesTag:Xr(Xr({},_),{type:ni[_.type],roleIds:so(_.roleIds)})});case 3:return de=Et.sent,V=de.content.datas,Et.abrupt("return",zs(V));case 6:case"end":return Et.stop()}},Y,this)}))},$.getChannelCategoryWhiteBlackMembers=function(_){return kr(this,void 0,void 0,rr.mark(function Y(){var de,V;return rr.wrap(function(Et){for(;;)switch(Et.prev=Et.next){case 0:return zr({categoryId:{type:"string",allowEmpty:!1},serverId:{type:"string",allowEmpty:!1},type:{type:"enum",values:ri(ni)},accids:{type:"array",itemType:"string",min:1}},_),Et.next=3,this.core.sendCmd("qchatGetChannelCategoryWhiteBlackMembers",{qchatGetChannelCategoryWhiteBlackMembersTag:Xr(Xr({},_),{type:ni[_.type],accids:so(_.accids)})});case 3:return de=Et.sent,V=de.content.datas,Et.abrupt("return",dc(V));case 6:case"end":return Et.stop()}},Y,this)}))},$.getChannelCategoriesPage=function(_){return kr(this,void 0,void 0,rr.mark(function Y(){var de,V,Fe,Et;return rr.wrap(function(fr){for(;;)switch(fr.prev=fr.next){case 0:return zr({serverId:{type:"string",allowEmpty:!1},timetag:{type:"number",min:0},limit:{type:"number",min:1,required:!1}},_),fr.next=3,this.core.sendCmd("qchatGetChannelCategoriesPage",{qchatGetChannelCategoriesPageTag:_});case 3:return de=fr.sent,V=de.content,Fe=V.datas,Et=V.listQueryTag,fr.abrupt("return",{listQueryTag:{hasMore:+Et.hasMore==1,nextTimetag:wo(Et.nextTimetag)},datas:Ph(Fe)});case 6:case"end":return fr.stop()}},Y,this)}))},$.getChannelCategoryChannelsPage=function(_){return kr(this,void 0,void 0,rr.mark(function Y(){var de,V,Fe,Et;return rr.wrap(function(fr){for(;;)switch(fr.prev=fr.next){case 0:return zr({serverId:{type:"string",allowEmpty:!1},categoryId:{type:"string",allowEmpty:!1},timetag:{type:"number",min:0},limit:{type:"number",min:1,required:!1}},_),fr.next=3,this.core.sendCmd("qchatGetChannelCategoryChannelsPage",{qchatGetChannelCategoryChannelsPageTag:_});case 3:return de=fr.sent,V=de.content,Fe=V.datas,Et=V.listQueryTag,fr.abrupt("return",{listQueryTag:{hasMore:+Et.hasMore==1,nextTimetag:wo(Et.nextTimetag)},datas:Ld(Fe)});case 6:case"end":return fr.stop()}},Y,this)}))},$.subscribeChannel=function(_){return kr(this,void 0,void 0,rr.mark(function Y(){var de,V;return rr.wrap(function(Et){for(;;)switch(Et.prev=Et.next){case 0:return zr({type:{type:"number",min:1,max:5},opeType:{type:"number",min:1,max:2}},_),Et.next=3,this.subscribeModuleService.subscribe(_);case 3:if((de=Et.sent).unreadInfos=Ud(de.unreadInfos),_.opeType===1&&(_.channels=co(V=de.unreadInfos).call(V,function(sr){return{serverId:sr.serverId,channelId:sr.channelId}})),this.logger.debug("QChatChannel::subscribeChannel:: cacheSubscribe ",_),this.subscribeModuleService.cacheSubscribe(_),_.type!==5){Et.next=10;break}return Et.abrupt("return");case 10:return this.subscribeModuleService.updateUnreads(de.unreadInfos),Et.abrupt("return",de);case 12:case"end":return Et.stop()}},Y,this)}))},$.getChannelUnreadInfos=function(_){return kr(this,void 0,void 0,rr.mark(function Y(){var de,V;return rr.wrap(function(Et){for(;;)switch(Et.prev=Et.next){case 0:return Et.next=2,this.core.sendCmd("qchatGetUnreadInfo",_);case 2:return de=Et.sent,V=Ud(de.content.unreadInfos),this.subscribeModuleService.updateUnreads(V),Et.abrupt("return",V);case 6:case"end":return Et.stop()}},Y,this)}))},$.getChannelSearchByPage=function(_){return kr(this,void 0,void 0,rr.mark(function Y(){var de,V,Fe,Et;return rr.wrap(function(fr){for(;;)switch(fr.prev=fr.next){case 0:if(zr({keyword:{type:"string",allowEmpty:!1},startTime:{type:"number",min:0,required:!1},endTime:{type:"number",min:1,required:!1},order:{type:"enum",values:ri(Ac),required:!1},limit:{type:"number",min:1,required:!1},serverId:{type:"string",required:!1},sort:{type:"enum",values:ri(Jp),required:!1},cursor:{type:"string",allowEmpty:!1,required:!1}},_),!(_.startTime&&_.endTime&&_.startTime>=_.endTime)){fr.next=3;break}throw new cu("startTime more than endTime",_,"timeRule");case 3:return fr.next=5,this.core.sendCmd("qchatGetChannelSearchByPage",{qchatGetChannelSearchByPageTag:Xr(Xr({},_),{order:_.order&&Ac[_.order],sort:Xu(_)&&Jp[Xu(_)]})});case 5:return de=fr.sent,V=de.content,Fe=V.datas,Et=V.listQueryTag,fr.abrupt("return",{listQueryTag:{hasMore:+Et.hasMore==1,nextTimetag:wo(Et.nextTimetag),cursor:Et.cursor},datas:Ld(Fe)});case 8:case"end":return fr.stop()}},Y,this)}))},$.channelMemberSearch=function(_){return kr(this,void 0,void 0,rr.mark(function Y(){var de;return rr.wrap(function(Fe){for(;;)switch(Fe.prev=Fe.next){case 0:return zr({serverId:{type:"string",allowEmpty:!1},channelId:{type:"string",allowEmpty:!1},keyword:{type:"string",allowEmpty:!1},limit:{type:"number",min:1,required:!1}},_),Fe.next=3,this.core.sendCmd("qchatChannelMemberSearch",{qchatChannelMemberSearchTag:_});case 3:return de=Fe.sent,Fe.abrupt("return",RS(de.content.datas));case 5:case"end":return Fe.stop()}},Y,this)}))},$.subscribeAsVisitor=function(_){return kr(this,void 0,void 0,rr.mark(function Y(){return rr.wrap(function(V){for(;;)switch(V.prev=V.next){case 0:return zr({opeType:{type:"number",min:1,max:2},type:{type:"number",required:!1},channels:{type:"array",rules:{serverId:{type:"string",allowEmpty:!1},channelId:{type:"string",allowEmpty:!1}},min:1}},_),V.next=3,this.subscribeForVisitorService.subscribeChannelAsVisitor(_);case 3:return V.abrupt("return",V.sent);case 4:case"end":return V.stop()}},Y,this)}))},w}(vu),qv={"24_61":"qchatCreateServerRole","24_62":"qchatDeleteServerRole","24_63":"qchatUpdateServerRole","24_64":"qchatGetServerRoles","24_65":"qchatAddChannelRole","24_66":"qchatRemoveChannelRole","24_67":"qchatUpdateChannelRole","24_68":"qchatGetChannelRoles","24_69":"qchatAddMemberRole","24_70":"qchatRemoveMemberRole","24_71":"qchatUpdateMemberRole","24_72":"qchatGetMemberRoles","24_73":"qchatAddMembersToServerRole","24_74":"qchatRemoveMembersFromServerRole","24_75":"qchatGetMembersFromServerRole","24_76":"qchatGetServerRolesByAccid","24_77":"qchatGetExistingServerRolesByAccids","24_78":"qchatGetExistingChannelRolesByServerRoleIds","24_79":"qchatGetExistingAccidsOfMemberRoles","24_80":"qchatUpdateServerRolePriorities","24_81":"qchatGetExistingAccidsInServerRole","24_82":"qchatCheckPermission","24_83":"qchatAddChannelCategoryRole","24_84":"qchatRemoveChannelCategoryRole","24_85":"qchatUpdateChannelCategoryRole","24_86":"qchatGetChannelCategoryRole","24_87":"qchatAddChannelCategoryMemberRole","24_88":"qchatRemoveChannelCategoryMemberRole","24_89":"qchatUpdateChannelCategoryMemberRole","24_90":"qchatGetChannelCategoryMemberRole","24_126":"qchatCheckPermissions"},$i={channelRole:{serverId:1,roleId:2,parentRoleId:3,channelId:4,name:5,icon:6,ext:7,auths:8,type:9,createTime:10,updateTime:11},memberRole:{serverId:1,id:2,accid:3,channelId:4,auths:5,createTime:6,updateTime:7,nick:8,avatar:9,ext:10,memberType:11,joinTime:12,inviter:13},antispamTag:{antiSpamBusinessId:1},serverRole:{serverId:1,roleId:2,name:3,icon:4,ext:5,auths:6,type:7,memberCount:8,priority:9,createTime:10,updateTime:11,isMember:12},getRoleByPagesTag:{serverId:1,channelId:2,time:3,limit:4},checkPermissionTag:{serverId:1,channelId:2,auth:3},member:{serverId:1,roleId:2,accid:3,createTime:4,updateTime:5,nick:6,avatar:7,ext:8,type:9,joinTime:10,inviter:11},qchatAddChannelCategoryRoleTag:{categoryId:3,serverId:4,parentRoleId:5},channelCategoryRole:{roleId:1,categoryId:3,serverId:4,parentRoleId:5,type:6,validFlag:7,createTime:8,updateTime:9,auths:10,name:11,icon:12,ext:13},qchatGetChannelCategoryRoleTag:{serverId:1,categoryId:2,timetag:3,limit:4},channelCategoryMemberRole:{id:1,accid:3,categoryId:4,serverId:5,validFlag:6,createTime:7,updateTime:8,auths:9,nick:10,avatar:11,ext:12,memberType:13,joinTime:14,inviter:15},qchatGetChannelCategoryMemberRoleTag:{serverId:1,categoryId:2,timetag:3,limit:4},checkPermissionsTag:{serverId:1,channelId:2,auths:3}},oi=xc($i),rM={qchatCreateServerRole:{service:"qchatRole",sid:24,cid:61,params:[{type:"Property",name:"serverRole",reflectMapper:$i.serverRole},{type:"Property",name:"antispamTag",reflectMapper:$i.antispamTag}],response:[{type:"Property",name:"serverRole",reflectMapper:oi.serverRole}]},qchatDeleteServerRole:{service:"qchatRole",sid:24,cid:62,params:[{type:"Long",name:"serverId"},{type:"Long",name:"roleId"}]},qchatUpdateServerRole:{service:"qchatRole",sid:24,cid:63,params:[{type:"Property",name:"updateServerRoleTag",reflectMapper:{serverId:1,roleId:2,name:3,icon:4,ext:5,auths:6,priority:7}},{type:"Property",name:"antispamTag",reflectMapper:$i.antispamTag}],response:[{type:"Property",name:"serverRole",reflectMapper:oi.serverRole}]},qchatGetServerRoles:{service:"qchatRole",sid:24,cid:64,params:[{type:"Property",name:"getServerRolesTag",reflectMapper:{serverId:1,timetag:2,limit:3,priority:4,channelId:5,categoryId:6}}],response:[{type:"PropertyArray",name:"serverRoles",reflectMapper:oi.serverRole}]},qchatAddChannelRole:{service:"qchatRole",sid:24,cid:65,params:[{type:"Property",name:"channelRole",reflectMapper:$i.channelRole}],response:[{type:"Property",name:"channelRole",reflectMapper:oi.channelRole}]},qchatRemoveChannelRole:{service:"qchatRole",sid:24,cid:66,params:[{type:"Long",name:"serverId"},{type:"Long",name:"channelId"},{type:"Long",name:"roleId"}]},qchatUpdateChannelRole:{service:"qchatRole",sid:24,cid:67,params:[{type:"Property",name:"updateChannelRoleTag",reflectMapper:{serverId:1,roleId:2,channelId:3,auths:4}}],response:[{type:"Property",name:"channelRole",reflectMapper:oi.channelRole}]},qchatGetChannelRoles:{service:"qchatRole",sid:24,cid:68,params:[{type:"Property",name:"getChannelRolesTag",reflectMapper:{serverId:1,channelId:2,timetag:3,limit:4}}],response:[{type:"PropertyArray",name:"channelRoles",reflectMapper:oi.channelRole}]},qchatAddMemberRole:{service:"qchatRole",sid:24,cid:69,params:[{type:"Property",name:"memberRole",reflectMapper:$i.memberRole}],response:[{type:"Property",name:"memberRole",reflectMapper:oi.memberRole}]},qchatRemoveMemberRole:{service:"qchatRole",sid:24,cid:70,params:[{type:"Property",name:"memberRole",reflectMapper:$i.memberRole}]},qchatUpdateMemberRole:{service:"qchatRole",sid:24,cid:71,params:[{type:"Property",name:"updateMemberRoleTag",reflectMapper:{serverId:1,accid:2,channelId:3,auths:4}}],response:[{type:"Property",name:"memberRole",reflectMapper:oi.memberRole}]},qchatGetMemberRoles:{service:"qchatRole",sid:24,cid:72,params:[{type:"Property",name:"getMemberRolesTag",reflectMapper:{serverId:1,channelId:2,timetag:3,limit:4}}],response:[{type:"PropertyArray",name:"memberRoles",reflectMapper:oi.memberRole}]},qchatAddMembersToServerRole:{service:"qchatRole",sid:24,cid:73,params:[{type:"Long",name:"serverId"},{type:"Long",name:"roleId"},{type:"String",name:"accids"}],response:[{type:"Property",name:"accids",reflectMapper:{1:"successAccids",2:"failedAccids"}}]},qchatRemoveMembersFromServerRole:{service:"qchatRole",sid:24,cid:74,params:[{type:"Long",name:"serverId"},{type:"Long",name:"roleId"},{type:"String",name:"accids"}],response:[{type:"Property",name:"accids",reflectMapper:{1:"successAccids",2:"failedAccids"}}]},qchatGetMembersFromServerRole:{service:"qchatRole",sid:24,cid:75,params:[{type:"Property",name:"getMembersFromServerRoleTag",reflectMapper:{serverId:1,roleId:2,timetag:3,accid:4,limit:5}}],response:[{type:"PropertyArray",name:"members",reflectMapper:oi.member}]},qchatGetServerRolesByAccid:{service:"qchatRole",sid:24,cid:76,params:[{type:"Property",name:"getServerRolesByAccidTag",reflectMapper:{serverId:1,accid:2,timetag:3,limit:4}}],response:[{type:"PropertyArray",name:"serverRoles",reflectMapper:oi.serverRole}]},qchatGetExistingServerRolesByAccids:{service:"qchatRole",sid:24,cid:77,params:[{type:"Long",name:"serverId"},{type:"String",name:"accids"}],response:[{type:"String",name:"serverRoles"}]},qchatGetExistingChannelRolesByServerRoleIds:{service:"qchatRole",sid:24,cid:78,params:[{type:"Long",name:"serverId"},{type:"Long",name:"channelId"},{type:"String",name:"roleIds"}],response:[{type:"PropertyArray",name:"channelRoles",reflectMapper:oi.channelRole}]},qchatGetExistingAccidsOfMemberRoles:{service:"qchatRole",sid:24,cid:79,params:[{type:"Long",name:"serverId"},{type:"Long",name:"channelId"},{type:"String",name:"accids"}],response:[{type:"PropertyArray",name:"memberRoles",reflectMapper:oi.memberRole}]},qchatUpdateServerRolePriorities:{service:"qchatRole",sid:24,cid:80,params:[{type:"Long",name:"serverId"},{type:"PropertyArray",name:"serverRoles",reflectMapper:{serverId:1,roleId:2,priority:7}}],response:[{type:"PropertyArray",name:"serverRoles",reflectMapper:oi.serverRole}]},qchatGetExistingAccidsInServerRole:{service:"qchatRole",sid:24,cid:81,params:[{type:"Long",name:"serverId"},{type:"Long",name:"roleId"},{type:"String",name:"accids"}],response:[{type:"PropertyArray",name:"members",reflectMapper:oi.member}]},qchatCheckPermission:{service:"qchatRole",sid:24,cid:82,params:[{type:"Property",name:"checkPermissionTag",reflectMapper:$i.checkPermissionTag}],response:[{type:"Boolean",name:"checked"}]},qchatAddChannelCategoryRole:{service:"qchatRole",sid:24,cid:83,params:[{type:"Property",name:"qchatAddChannelCategoryRoleTag",reflectMapper:$i.channelCategoryRole}],response:[{type:"Property",name:"channelCategoryRole",reflectMapper:oi.channelCategoryRole}]},qchatRemoveChannelCategoryRole:{service:"qchatRole",sid:24,cid:84,params:[{type:"Long",name:"serverId"},{type:"Long",name:"categoryId"},{type:"Long",name:"roleId"}]},qchatUpdateChannelCategoryRole:{service:"qchatRole",sid:24,cid:85,params:[{type:"Property",name:"qchatUpdateChannelCategoryRoleTag",reflectMapper:$i.channelCategoryRole}],response:[{type:"Property",name:"channelCategoryRole",reflectMapper:oi.channelCategoryRole}]},qchatGetChannelCategoryRole:{service:"qchatRole",sid:24,cid:86,params:[{type:"Property",name:"qchatGetChannelCategoryRoleTag",reflectMapper:$i.qchatGetChannelCategoryRoleTag}],response:[{type:"PropertyArray",name:"list",reflectMapper:oi.channelCategoryRole}]},qchatAddChannelCategoryMemberRole:{service:"qchatRole",sid:24,cid:87,params:[{type:"Property",name:"qchatAddChannelCategoryMemberRoleTag",reflectMapper:$i.channelCategoryMemberRole}],response:[{type:"Property",name:"channelCategoryMemberRole",reflectMapper:oi.channelCategoryMemberRole}]},qchatRemoveChannelCategoryMemberRole:{service:"qchatRole",sid:24,cid:88,params:[{type:"Long",name:"serverId"},{type:"Long",name:"categoryId"},{type:"String",name:"accid"}]},qchatUpdateChannelCategoryMemberRole:{service:"qchatRole",sid:24,cid:89,params:[{type:"Property",name:"qchatUpdateChannelCategoryMemberRoleTag",reflectMapper:$i.channelCategoryMemberRole}],response:[{type:"Property",name:"channelCategoryMemberRole",reflectMapper:oi.channelCategoryMemberRole}]},qchatGetChannelCategoryMemberRole:{service:"qchatRole",sid:24,cid:90,params:[{type:"Property",name:"qchatGetChannelCategoryMemberRoleTag",reflectMapper:$i.qchatGetChannelCategoryMemberRoleTag}],response:[{type:"PropertyArray",name:"list",reflectMapper:oi.channelCategoryMemberRole}]},qchatCheckPermissions:{service:"qchatRole",sid:24,cid:126,params:[{type:"Property",name:"checkPermissionsTag",reflectMapper:$i.checkPermissionsTag}],response:[{type:"PropertyArray",name:"checkPermissionsResult",reflectMapper:{1:"auth",2:"isAllow"}}]}},nM=function(){function b($){this.core=$}var w=b.prototype;return w.addChannelCategoryRole=function(A){return kr(this,void 0,void 0,rr.mark(function _(){var Y;return rr.wrap(function(V){for(;;)switch(V.prev=V.next){case 0:return zr({serverId:{type:"string",allowEmpty:!1},categoryId:{type:"string",allowEmpty:!1},parentRoleId:{type:"string",allowEmpty:!1}},A),V.next=3,this.core.sendCmd("qchatAddChannelCategoryRole",{qchatAddChannelCategoryRoleTag:A});case 3:return Y=V.sent,V.abrupt("return",ef(Y.content.channelCategoryRole));case 5:case"end":return V.stop()}},_,this)}))},w.removeChannelCategoryRole=function(A){return kr(this,void 0,void 0,rr.mark(function _(){return rr.wrap(function(de){for(;;)switch(de.prev=de.next){case 0:return zr({serverId:{type:"string",allowEmpty:!1},categoryId:{type:"string",allowEmpty:!1},roleId:{type:"string",allowEmpty:!1}},A),de.next=3,this.core.sendCmd("qchatRemoveChannelCategoryRole",A);case 3:case"end":return de.stop()}},_,this)}))},w.updateChannelCategoryRole=function(A){return kr(this,void 0,void 0,rr.mark(function _(){var Y;return rr.wrap(function(V){for(;;)switch(V.prev=V.next){case 0:return zr({serverId:{type:"string",allowEmpty:!1},categoryId:{type:"string",allowEmpty:!1},roleId:{type:"string",allowEmpty:!1},auths:{type:"object"}},A),V.next=3,this.core.sendCmd("qchatUpdateChannelCategoryRole",{qchatUpdateChannelCategoryRoleTag:Nc(A)});case 3:if((Y=V.sent).raw.code!==406){V.next=6;break}throw new uo("No update required",{},406);case 6:return V.abrupt("return",ef(Y.content.channelCategoryRole));case 7:case"end":return V.stop()}},_,this)}))},w.getChannelCategoryRole=function(A){return kr(this,void 0,void 0,rr.mark(function _(){var Y;return rr.wrap(function(V){for(;;)switch(V.prev=V.next){case 0:return zr({serverId:{type:"string",allowEmpty:!1},categoryId:{type:"string",allowEmpty:!1},timetag:{type:"number",min:0,required:!1},limit:{type:"number",min:1,required:!1}},A),V.next=3,this.core.sendCmd("qchatGetChannelCategoryRole",{qchatGetChannelCategoryRoleTag:A});case 3:return Y=V.sent,V.abrupt("return",(Fe=Y.content.list,rs(Fe)&&Fe.length>0?co(Fe).call(Fe,function(Et){return ef(Et)}):[]));case 5:case"end":return V.stop()}var Fe},_,this)}))},w.addChannelCategoryMemberRole=function(A){return kr(this,void 0,void 0,rr.mark(function _(){var Y;return rr.wrap(function(V){for(;;)switch(V.prev=V.next){case 0:return zr({serverId:{type:"string",allowEmpty:!1},categoryId:{type:"string",allowEmpty:!1},accid:{type:"string",allowEmpty:!1}},A),V.next=3,this.core.sendCmd("qchatAddChannelCategoryMemberRole",{qchatAddChannelCategoryMemberRoleTag:A});case 3:return Y=V.sent,V.abrupt("return",rl(Y.content.channelCategoryMemberRole));case 5:case"end":return V.stop()}},_,this)}))},w.removeChannelCategoryMemberRole=function(A){return kr(this,void 0,void 0,rr.mark(function _(){return rr.wrap(function(de){for(;;)switch(de.prev=de.next){case 0:return zr({serverId:{type:"string",allowEmpty:!1},categoryId:{type:"string",allowEmpty:!1},accid:{type:"string",allowEmpty:!1}},A),de.next=3,this.core.sendCmd("qchatRemoveChannelCategoryMemberRole",A);case 3:case"end":return de.stop()}},_,this)}))},w.updateChannelCategoryMemberRole=function(A){return kr(this,void 0,void 0,rr.mark(function _(){var Y;return rr.wrap(function(V){for(;;)switch(V.prev=V.next){case 0:return zr({serverId:{type:"string",allowEmpty:!1},categoryId:{type:"string",allowEmpty:!1},accid:{type:"string",allowEmpty:!1},auths:{type:"object"}},A),V.next=3,this.core.sendCmd("qchatUpdateChannelCategoryMemberRole",{qchatUpdateChannelCategoryMemberRoleTag:Nc(A)});case 3:if((Y=V.sent).raw.code!==406){V.next=6;break}throw new uo("No update required",{},406);case 6:return V.abrupt("return",rl(Y.content.channelCategoryMemberRole));case 7:case"end":return V.stop()}},_,this)}))},w.getChannelCategoryMemberRole=function(A){return kr(this,void 0,void 0,rr.mark(function _(){var Y;return rr.wrap(function(V){for(;;)switch(V.prev=V.next){case 0:return zr({serverId:{type:"string",allowEmpty:!1},categoryId:{type:"string",allowEmpty:!1},timetag:{type:"number",min:0,required:!1},limit:{type:"number",min:1,required:!1}},A),V.next=3,this.core.sendCmd("qchatGetChannelCategoryMemberRole",{qchatGetChannelCategoryMemberRoleTag:A});case 3:return Y=V.sent,V.abrupt("return",(Fe=Y.content.list,rs(Fe)&&Fe.length>0?co(Fe).call(Fe,function(Et){return rl(Et)}):[]));case 5:case"end":return V.stop()}var Fe},_,this)}))},b}(),oM=function(b){function w(A){var _;return(_=b.call(this,"qchatRole",A)||this).core=A,Oa({cmdMap:qv,cmdConfig:rM}),_.category=new nM(A),_}Co(w,b);var $=w.prototype;return $.createServerRole=function(_){return kr(this,void 0,void 0,rr.mark(function Y(){var de;return rr.wrap(function(Fe){for(;;)switch(Fe.prev=Fe.next){case 0:return zr({serverId:{type:"string",allowEmpty:!1},name:{type:"string",allowEmpty:!1},priority:{type:"number",min:1},icon:{type:"string",required:!1},ext:{type:"string",required:!1}},_),Fe.next=3,this.core.sendCmd("qchatCreateServerRole",{serverRole:Xr(Xr({},Nc(_)),{type:tl.custom}),antispamTag:Rc(_)});case 3:return de=Fe.sent,Fe.abrupt("return",us(de.content.serverRole));case 5:case"end":return Fe.stop()}},Y,this)}))},$.updateServerRole=function(_){return kr(this,void 0,void 0,rr.mark(function Y(){var de;return rr.wrap(function(Fe){for(;;)switch(Fe.prev=Fe.next){case 0:return zr({serverId:{type:"string",allowEmpty:!1},roleId:{type:"string",allowEmpty:!1},name:{type:"string",required:!1},icon:{type:"string",required:!1},ext:{type:"string",required:!1},priority:{type:"number",required:!1},auths:{type:"object",required:!1}},_),Fe.next=3,this.core.sendCmd("qchatUpdateServerRole",{updateServerRoleTag:Nc(_),antispamTag:Rc(_)});case 3:return de=Fe.sent,Fe.abrupt("return",us(de.content.serverRole));case 5:case"end":return Fe.stop()}},Y,this)}))},$.deleteServerRole=function(_){return kr(this,void 0,void 0,rr.mark(function Y(){return rr.wrap(function(V){for(;;)switch(V.prev=V.next){case 0:return zr({serverId:{type:"string",allowEmpty:!1},roleId:{type:"string",allowEmpty:!1}},_),V.next=3,this.core.sendCmd("qchatDeleteServerRole",_);case 3:case"end":return V.stop()}},Y,this)}))},$.getServerRoles=function(_){return kr(this,void 0,void 0,rr.mark(function Y(){var de,V,Fe;return rr.wrap(function(sr){for(;;)switch(sr.prev=sr.next){case 0:return zr({serverId:{type:"string",allowEmpty:!1},channelId:{type:"string",allowEmpty:!1,required:!1},categoryId:{type:"string",allowEmpty:!1,required:!1},limit:{type:"number",min:1,required:!1},priority:{type:"number",required:!1}},_),sr.next=3,this.core.sendCmd("qchatGetServerRoles",{getServerRolesTag:Nc(_)});case 3:return V=sr.sent,Fe=Ys(de=V.content.serverRoles).call(de,function(fr){return wo(fr.isMember)===1}),Fe=co(Fe).call(Fe,function(fr){return fr.roleId}),sr.abrupt("return",{roles:zs(V.content.serverRoles),isMemberRoles:Fe});case 7:case"end":return sr.stop()}},Y,this)}))},$.addChannelRole=function(_){return kr(this,void 0,void 0,rr.mark(function Y(){var de;return rr.wrap(function(Fe){for(;;)switch(Fe.prev=Fe.next){case 0:return zr({serverId:{type:"string",allowEmpty:!1},channelId:{type:"string",allowEmpty:!1},parentRoleId:{type:"string",allowEmpty:!1}},_),Fe.next=3,this.core.sendCmd("qchatAddChannelRole",{channelRole:Nc(_)});case 3:return de=Fe.sent,Fe.abrupt("return",us(de.content.channelRole));case 5:case"end":return Fe.stop()}},Y,this)}))},$.getChannelRoles=function(_){return kr(this,void 0,void 0,rr.mark(function Y(){var de;return rr.wrap(function(Fe){for(;;)switch(Fe.prev=Fe.next){case 0:return zr({serverId:{type:"string",allowEmpty:!1},channelId:{type:"string",allowEmpty:!1},timetag:{type:"number",required:!1},limit:{type:"number",min:1,required:!1}},_),Fe.next=3,this.core.sendCmd("qchatGetChannelRoles",{getChannelRolesTag:_});case 3:return de=Fe.sent,Fe.abrupt("return",zs(de.content.channelRoles));case 5:case"end":return Fe.stop()}},Y,this)}))},$.removeChannelRole=function(_){return kr(this,void 0,void 0,rr.mark(function Y(){return rr.wrap(function(V){for(;;)switch(V.prev=V.next){case 0:return zr({serverId:{type:"string",allowEmpty:!1},channelId:{type:"string",allowEmpty:!1},roleId:{type:"string",allowEmpty:!1}},_),V.next=3,this.core.sendCmd("qchatRemoveChannelRole",_);case 3:case"end":return V.stop()}},Y,this)}))},$.updateChannelRole=function(_){return kr(this,void 0,void 0,rr.mark(function Y(){var de;return rr.wrap(function(Fe){for(;;)switch(Fe.prev=Fe.next){case 0:return zr({serverId:{type:"string",allowEmpty:!1},channelId:{type:"string",allowEmpty:!1},roleId:{type:"string",allowEmpty:!1},auths:{type:"object",required:!1}},_),Fe.next=3,this.core.sendCmd("qchatUpdateChannelRole",{updateChannelRoleTag:Nc(_)});case 3:if((de=Fe.sent).raw.code!==406){Fe.next=6;break}throw new uo("No update required",{},406);case 6:return Fe.abrupt("return",us(de.content.channelRole));case 7:case"end":return Fe.stop()}},Y,this)}))},$.addMemberRole=function(_){return kr(this,void 0,void 0,rr.mark(function Y(){var de;return rr.wrap(function(Fe){for(;;)switch(Fe.prev=Fe.next){case 0:return zr({serverId:{type:"string",allowEmpty:!1},channelId:{type:"string",allowEmpty:!1},accid:{type:"string",allowEmpty:!1}},_),Fe.next=3,this.core.sendCmd("qchatAddMemberRole",{memberRole:_});case 3:return de=Fe.sent,Fe.abrupt("return",us(de.content.memberRole));case 5:case"end":return Fe.stop()}},Y,this)}))},$.getMemberRoles=function(_){return kr(this,void 0,void 0,rr.mark(function Y(){var de;return rr.wrap(function(Fe){for(;;)switch(Fe.prev=Fe.next){case 0:return zr({serverId:{type:"string",allowEmpty:!1},channelId:{type:"string",allowEmpty:!1},timetag:{type:"number",required:!1},limit:{type:"number",min:1,required:!1}},_),Fe.next=3,this.core.sendCmd("qchatGetMemberRoles",{getMemberRolesTag:_});case 3:return de=Fe.sent,Fe.abrupt("return",zs(de.content.memberRoles));case 5:case"end":return Fe.stop()}},Y,this)}))},$.removeMemberRole=function(_){return kr(this,void 0,void 0,rr.mark(function Y(){return rr.wrap(function(V){for(;;)switch(V.prev=V.next){case 0:return zr({serverId:{type:"string",allowEmpty:!1},channelId:{type:"string",allowEmpty:!1},accid:{type:"string",allowEmpty:!1}},_),V.next=3,this.core.sendCmd("qchatRemoveMemberRole",{memberRole:_});case 3:case"end":return V.stop()}},Y,this)}))},$.updateMemberRole=function(_){return kr(this,void 0,void 0,rr.mark(function Y(){var de;return rr.wrap(function(Fe){for(;;)switch(Fe.prev=Fe.next){case 0:return zr({serverId:{type:"string",allowEmpty:!1},channelId:{type:"string",allowEmpty:!1},accid:{type:"string",allowEmpty:!1},auths:{type:"object",required:!1}},_),Fe.next=3,this.core.sendCmd("qchatUpdateMemberRole",{updateMemberRoleTag:Nc(_)});case 3:if((de=Fe.sent).raw.code!==406){Fe.next=6;break}throw new uo("No update required",{},406);case 6:return Fe.abrupt("return",us(de.content.memberRole));case 7:case"end":return Fe.stop()}},Y,this)}))},$.addMembersToServerRole=function(_){return kr(this,void 0,void 0,rr.mark(function Y(){var de,V,Fe;return rr.wrap(function(sr){for(;;)switch(sr.prev=sr.next){case 0:return zr({serverId:{type:"string",allowEmpty:!1},roleId:{type:"string",allowEmpty:!1},accids:{type:"array",itemType:"string",min:1}},_),sr.next=3,this.core.sendCmd("qchatAddMembersToServerRole",Xr(Xr({},_),{accids:so(_.accids)}));case 3:return de=sr.sent,V=Vi(de,"content.accids.successAccids"),Fe=Vi(de,"content.accids.failedAccids"),sr.abrupt("return",{successAccids:V?JSON.parse(V):[],failedAccids:Fe?JSON.parse(Fe):[]});case 7:case"end":return sr.stop()}},Y,this)}))},$.removeMembersFromServerRole=function(_){return kr(this,void 0,void 0,rr.mark(function Y(){var de,V,Fe;return rr.wrap(function(sr){for(;;)switch(sr.prev=sr.next){case 0:return zr({serverId:{type:"string",allowEmpty:!1},roleId:{type:"string",allowEmpty:!1},accids:{type:"array",itemType:"string",min:1}},_),sr.next=3,this.core.sendCmd("qchatRemoveMembersFromServerRole",Xr(Xr({},_),{accids:so(_.accids)}));case 3:return de=sr.sent,V=Vi(de,"content.accids.successAccids"),Fe=Vi(de,"content.accids.failedAccids"),sr.abrupt("return",{successAccids:V?JSON.parse(V):[],failedAccids:Fe?JSON.parse(Fe):[]});case 7:case"end":return sr.stop()}},Y,this)}))},$.getMembersFromServerRole=function(_){return kr(this,void 0,void 0,rr.mark(function Y(){var de;return rr.wrap(function(Fe){for(;;)switch(Fe.prev=Fe.next){case 0:return zr({serverId:{type:"string",allowEmpty:!1},roleId:{type:"string",allowEmpty:!1},timetag:{type:"number",required:!1},accid:{type:"string",allowEmpty:!1,required:!1},limit:{type:"number",min:1,required:!1}},_),Fe.next=3,this.core.sendCmd("qchatGetMembersFromServerRole",{getMembersFromServerRoleTag:_});case 3:return de=Fe.sent,Fe.abrupt("return",zs(de.content.members));case 5:case"end":return Fe.stop()}},Y,this)}))},$.getServerRolesByAccid=function(_){return kr(this,void 0,void 0,rr.mark(function Y(){var de;return rr.wrap(function(Fe){for(;;)switch(Fe.prev=Fe.next){case 0:return zr({serverId:{type:"string",allowEmpty:!1},accid:{type:"string",allowEmpty:!1},timetag:{type:"number",required:!1},limit:{type:"number",min:1,required:!1}},_),Fe.next=3,this.core.sendCmd("qchatGetServerRolesByAccid",{getServerRolesByAccidTag:_});case 3:return de=Fe.sent,Fe.abrupt("return",zs(de.content.serverRoles));case 5:case"end":return Fe.stop()}},Y,this)}))},$.getExistingServerRolesByAccids=function(_){return kr(this,void 0,void 0,rr.mark(function Y(){var de,V,Fe;return rr.wrap(function(sr){for(;;)switch(sr.prev=sr.next){case 0:return zr({serverId:{type:"string",allowEmpty:!1},accids:{type:"array",itemType:"string"}},_),sr.next=3,this.core.sendCmd("qchatGetExistingServerRolesByAccids",{serverId:_.serverId,accids:so(_.accids)});case 3:return de=sr.sent,sr.prev=4,Fe=JSON.parse(de.content.serverRoles),kn(V=Yo(Fe)).call(V,function(fr){var Sr;kn(Sr=Fe[fr]).call(Sr,function(Tr,Pr){Fe[fr][Pr]=Ei(Tr,oi.serverRole)}),Fe[fr]=zs(Fe[fr])}),sr.abrupt("return",Fe);case 10:throw sr.prev=10,sr.t0=sr.catch(4),this.logger.error("can not parse serverRolesGroupByAccid from "+_.serverId+" and "+_.accids,de.content.serverRoles),sr.t0;case 14:case"end":return sr.stop()}},Y,this,[[4,10]])}))},$.getExistingChannelRolesByServerRoleIds=function(_){return kr(this,void 0,void 0,rr.mark(function Y(){var de;return rr.wrap(function(Fe){for(;;)switch(Fe.prev=Fe.next){case 0:return zr({serverId:{type:"string",allowEmpty:!1},channelId:{type:"string",allowEmpty:!1},roleIds:{type:"array",itemType:"string"}},_),Fe.next=3,this.core.sendCmd("qchatGetExistingChannelRolesByServerRoleIds",{serverId:_.serverId,channelId:_.channelId,roleIds:so(_.roleIds)});case 3:return de=Fe.sent,Fe.abrupt("return",zs(de.content.channelRoles));case 5:case"end":return Fe.stop()}},Y,this)}))},$.getExistingAccidsOfMemberRoles=function(_){return kr(this,void 0,void 0,rr.mark(function Y(){var de,V;return rr.wrap(function(Et){for(;;)switch(Et.prev=Et.next){case 0:return zr({serverId:{type:"string",allowEmpty:!1},channelId:{type:"string",allowEmpty:!1},accids:{type:"array",itemType:"string"}},_),Et.next=3,this.core.sendCmd("qchatGetExistingAccidsOfMemberRoles",{serverId:_.serverId,channelId:_.channelId,accids:so(_.accids)});case 3:return de=Et.sent,V=de.content.memberRoles,Et.abrupt("return",V&&V.length>0?co(V).call(V,function(sr){return sr.accid}):[]);case 6:case"end":return Et.stop()}},Y,this)}))},$.getExistingAccidsInServerRole=function(_){return kr(this,void 0,void 0,rr.mark(function Y(){var de,V;return rr.wrap(function(Et){for(;;)switch(Et.prev=Et.next){case 0:return zr({serverId:{type:"string",allowEmpty:!1},roleId:{type:"string",allowEmpty:!1},accids:{type:"array",itemType:"string"}},_),Et.next=3,this.core.sendCmd("qchatGetExistingAccidsInServerRole",{serverId:_.serverId,roleId:_.roleId,accids:so(_.accids)});case 3:return de=Et.sent,V=de.content.members,Et.abrupt("return",V&&V.length>0?co(V).call(V,function(sr){return sr.accid}):[]);case 6:case"end":return Et.stop()}},Y,this)}))},$.updateServerRolePriorities=function(_){return kr(this,void 0,void 0,rr.mark(function Y(){var de,V;return rr.wrap(function(Et){for(;;)switch(Et.prev=Et.next){case 0:return zr({serverId:{type:"string",allowEmpty:!1},serverRoles:{type:"array"}},_),Et.next=3,this.core.sendCmd("qchatUpdateServerRolePriorities",{serverId:_.serverId,serverRoles:co(de=_.serverRoles).call(de,function(sr){return{serverId:sr.serverId,roleId:sr.roleId,priority:sr.priority}})});case 3:return V=Et.sent,Et.abrupt("return",zs(V.content.serverRoles));case 5:case"end":return Et.stop()}},Y,this)}))},$.checkPermission=function(_){return kr(this,void 0,void 0,rr.mark(function Y(){var de;return rr.wrap(function(Fe){for(;;)switch(Fe.prev=Fe.next){case 0:return zr({serverId:{type:"string",allowEmpty:!1},channelId:{type:"string",allowEmpty:!1,required:!1},auth:{type:"string"}},_),Fe.next=3,this.core.sendCmd("qchatCheckPermission",{checkPermissionTag:Xr(Xr({},_),{auth:Mu[_.auth]||_.auth})});case 3:return de=Fe.sent,Fe.abrupt("return",de.content.checked);case 5:case"end":return Fe.stop()}},Y,this)}))},$.addChannelCategoryRole=function(_){return kr(this,void 0,void 0,rr.mark(function Y(){return rr.wrap(function(V){for(;;)switch(V.prev=V.next){case 0:return V.next=2,this.category.addChannelCategoryRole(_);case 2:return V.abrupt("return",V.sent);case 3:case"end":return V.stop()}},Y,this)}))},$.removeChannelCategoryRole=function(_){return kr(this,void 0,void 0,rr.mark(function Y(){return rr.wrap(function(V){for(;;)switch(V.prev=V.next){case 0:return V.next=2,this.category.removeChannelCategoryRole(_);case 2:return V.abrupt("return",V.sent);case 3:case"end":return V.stop()}},Y,this)}))},$.updateChannelCategoryRole=function(_){return kr(this,void 0,void 0,rr.mark(function Y(){return rr.wrap(function(V){for(;;)switch(V.prev=V.next){case 0:return V.next=2,this.category.updateChannelCategoryRole(_);case 2:return V.abrupt("return",V.sent);case 3:case"end":return V.stop()}},Y,this)}))},$.getChannelCategoryRole=function(_){return kr(this,void 0,void 0,rr.mark(function Y(){return rr.wrap(function(V){for(;;)switch(V.prev=V.next){case 0:return V.next=2,this.category.getChannelCategoryRole(_);case 2:return V.abrupt("return",V.sent);case 3:case"end":return V.stop()}},Y,this)}))},$.addChannelCategoryMemberRole=function(_){return kr(this,void 0,void 0,rr.mark(function Y(){return rr.wrap(function(V){for(;;)switch(V.prev=V.next){case 0:return V.next=2,this.category.addChannelCategoryMemberRole(_);case 2:return V.abrupt("return",V.sent);case 3:case"end":return V.stop()}},Y,this)}))},$.removeChannelCategoryMemberRole=function(_){return kr(this,void 0,void 0,rr.mark(function Y(){return rr.wrap(function(V){for(;;)switch(V.prev=V.next){case 0:return V.next=2,this.category.removeChannelCategoryMemberRole(_);case 2:return V.abrupt("return",V.sent);case 3:case"end":return V.stop()}},Y,this)}))},$.updateChannelCategoryMemberRole=function(_){return kr(this,void 0,void 0,rr.mark(function Y(){return rr.wrap(function(V){for(;;)switch(V.prev=V.next){case 0:return V.next=2,this.category.updateChannelCategoryMemberRole(_);case 2:return V.abrupt("return",V.sent);case 3:case"end":return V.stop()}},Y,this)}))},$.getChannelCategoryMemberRole=function(_){return kr(this,void 0,void 0,rr.mark(function Y(){return rr.wrap(function(V){for(;;)switch(V.prev=V.next){case 0:return V.next=2,this.category.getChannelCategoryMemberRole(_);case 2:return V.abrupt("return",V.sent);case 3:case"end":return V.stop()}},Y,this)}))},$.checkPermissions=function(_){return kr(this,void 0,void 0,rr.mark(function Y(){var de,V,Fe,Et;return rr.wrap(function(fr){for(;;)switch(fr.prev=fr.next){case 0:return zr({serverId:{type:"string",allowEmpty:!1},channelId:{type:"string",allowEmpty:!1,required:!1},auths:{type:"array",itemType:"string"}},_),this.core.logger.log("qchatRole::checkPermission options is",_),fr.next=4,this.core.sendCmd("qchatCheckPermissions",{checkPermissionsTag:Xr(Xr({},_),{auths:so(co(de=_.auths).call(de,function(Sr){return Mu[Sr]||Sr}))})});case 4:return Fe=fr.sent,this.core.logger.log("qchatRole::checkPermission result is",Fe.content),Et={},kn(V=Fe.content.checkPermissionsResult).call(V,function(Sr){Et[Sr.auth]=Sr.isAllow}),this.core.logger.log("qchatRole::checkPermission auths is",Et),fr.abrupt("return",Ma(Et));case 10:case"end":return fr.stop()}},Y,this)}))},w}(vu),nf=function(w,$){return mv(w,$,function(A,_){return pv(w,_)})},iM=function(w){return w!=null&&w.length?Fv(w,1):[]},mc,Ps,of=function(w){return Fy(Ry(w,void 0,iM),w+"")}(function(b,w){return b==null?{}:nf(b,w)}),Lh={"24_10":"qchatSendMsg","24_11":"qchatOnMsg","24_12":"qchatOnRecvUnreadInfo","24_13":"qchatSendCustomSysMsg","24_14":"qchatOnSysMsg","24_16":"qchatGetHistoryMsg","24_17":"qchatMarkMessageRead","24_18":"qchatMultiSyncMessageRead","24_22":"qchatUpdateSystemNotification","24_23":"qchatMultiSyncSystemNotificationUpdate","24_24":"qchatSyncSystemNotification","24_25":"qchatUpdateMessage","24_26":"qchatRecvMessageUpdate","24_28":"qchatMarkSysMsgRead","24_94":"qchatMessageSearchByPage","24_100":"qchatGetMessageHistoryByIds","24_101":"qchatGetThreadMessages","24_102":"qchatUpdateQuickComment","24_103":"qchatGetQuickComments","24_108":"qchatGetThreadRootMessagesMeta","24_121":"qchatGetLastMessageOfChannels","24_127":"qchatGetMentionedMeMessages","25_6":"qchatMultiSyncServersMessageRead"},ls={getHistoryMsgTag:{serverId:1,channelId:2,beginTime:3,endTime:4,excludeMsgId:5,limit:6,reverse:7},getThreadHistoryMsgTag:{beginTime:1,endTime:2,excludeMsgId:3,limit:4,reverse:5},qchatMsgTag:{serverId:1,channelId:2,fromAccount:3,fromClientType:4,fromDeviceId:5,fromNick:6,time:7,updateTime:8,type:9,body:10,attach:11,ext:12,msgIdClient:13,msgIdServer:14,resendFlag:15,status:16,pushPayload:17,pushContent:18,mentionAccids:19,mentionAll:20,env:21,callbackExt:22,replyMsgFromAccount:23,replyMsgTime:24,replyMsgIdServer:25,replyMsgIdClient:26,threadMsgFromAccount:27,threadMsgTime:28,threadMsgIdServer:29,threadMsgIdClient:30,useCustomContent:31,antiSpamContent:32,antiSpamBusinessId:33,antiSpamUsingYidun:34,yidunCallback:35,yidunAntiCheating:36,yidunAntiSpamExt:37,yidunAntiSpamRes:38,mentionRoleIds:41,accidsOfMentionedRoles:42,updateContent:39,updateOperatorInfo:40,subType:61,historyEnable:100,pushEnable:101,needBadge:102,needPushNick:103,notifyReason:104,routeEnable:105,isAntispam:106},sysMsg:{toType:1,serverId:2,channelId:3,toAccids:4,fromAccount:5,fromClientType:6,fromDeviceId:7,fromNick:8,time:9,updateTime:10,type:11,msgIdClient:12,msgIdServer:13,body:14,attach:15,ext:16,resendFlag:17,status:18,pushPayload:19,pushContent:20,env:21,callbackExt:22,persistEnable:100,pushEnable:101,needBadge:102,needPushNick:103,routeEnable:104},qchatMsgUpdateTag:{operatorAccount:1,operatorClientType:2,ps:3,ext:4,pushContent:5,pushPayload:6,env:7,routeEnable:100},markMsgReadTag:{serverId:1,channelId:2,time:3},qchatQuickCommentRequestTag:{serverId:1,channelId:2,fromAccount:3,msgIdServer:4,time:5,type:6,opeType:7,opeAccid:8},qchatQuickCommentQueryTag:{serverId:1,channelId:2,msgIdServerList:3},qchatGetLastMessageOfChannelsTag:{serverId:1,channelIdList:2},qchatMultiSyncServersMessageReadTag:{successServerIds:1,failServerIds:2,ackTimestamp:3},qchatMessageSearchByPageTag:{keyword:1,serverId:2,channelId:3,fromAccid:4,fromTime:5,toTime:6,msgTypes:7,subTypes:8,includeSelf:9,order:10,limit:11,sort:12,cursor:13},qchatPageQueryTag:{hasMore:1,nextTimetag:2,cursor:3},unreadInfo:xh},ci=xc(ls),sM={qchatSendMsg:{service:"qchatMsg",sid:24,cid:10,params:[{type:"Property",name:"qchatMsg",reflectMapper:ls.qchatMsgTag}],response:[{type:"Property",name:"qchatMsg",reflectMapper:ci.qchatMsgTag}]},qchatOnMsg:{service:"qchatMsg",sid:24,cid:11,response:[{type:"Property",name:"qchatMsg",reflectMapper:ci.qchatMsgTag}]},qchatOnRecvUnreadInfo:{service:"qchatMsg",sid:24,cid:12,response:[{type:"Property",name:"qchatMsg",reflectMapper:ci.qchatMsgTag}]},qchatSendCustomSysMsg:{service:"qchatMsg",sid:24,cid:13,params:[{type:"Property",name:"sysMsg",reflectMapper:ls.sysMsg}],response:[{type:"Property",name:"sysMsg",reflectMapper:ci.sysMsg}]},qchatOnSysMsg:{service:"qchatMsg",sid:24,cid:14,response:[{type:"Property",name:"sysMsg",reflectMapper:ci.sysMsg}]},qchatGetHistoryMsg:{service:"qchatMsg",sid:24,cid:16,params:[{type:"Property",name:"getHistoryMsgTag",reflectMapper:ls.getHistoryMsgTag}],response:[{type:"PropertyArray",name:"qchatMsgs",reflectMapper:ci.qchatMsgTag}]},qchatUpdateMessage:{service:"qchatMsg",sid:24,cid:25,params:[{type:"Property",name:"qchatMsgUpdateTag",reflectMapper:ls.qchatMsgUpdateTag},{type:"Property",name:"qchatMsg",reflectMapper:ls.qchatMsgTag}],response:[{type:"Property",name:"qchatMsg",reflectMapper:ci.qchatMsgTag}]},qchatRecvMessageUpdate:{service:"qchatMsg",sid:24,cid:26,response:[{type:"Property",name:"qchatMsgUpdateInfo",reflectMapper:ci.qchatMsgUpdateTag},{type:"Property",name:"qchatMsg",reflectMapper:ci.qchatMsgTag}]},qchatMarkMessageRead:{sid:24,cid:17,service:"qchatMsg",params:[{type:"Property",name:"markMsgReadTag",reflectMapper:ls.markMsgReadTag}],response:[{type:"Property",name:"unreadInfo",reflectMapper:ci.unreadInfo}]},qchatMultiSyncMessageRead:{sid:24,cid:18,service:"qchatMsg",response:[{type:"Property",name:"unreadInfo",reflectMapper:ci.unreadInfo}]},qchatUpdateSystemNotification:{service:"qchatMsg",sid:24,cid:22,params:[{type:"Property",name:"qchatMsgUpdateTag",reflectMapper:ls.qchatMsgUpdateTag},{type:"Property",name:"sysMsg",reflectMapper:ls.sysMsg}],response:[{type:"Property",name:"sysMsg",reflectMapper:ci.sysMsg}]},qchatMultiSyncSystemNotificationUpdate:{service:"qchatMsg",sid:24,cid:23,response:[{type:"Property",name:"qchatMsgUpdateTag",reflectMapper:ci.qchatMsgUpdateTag},{type:"Property",name:"sysMsg",reflectMapper:ci.sysMsg}]},qchatSyncSystemNotification:{service:"qchatMsg",sid:24,cid:24,response:[{type:"PropertyArray",name:"systemNotifications",reflectMapper:ci.sysMsg}]},qchatMarkSysMsgRead:{service:"qchatMsg",sid:24,cid:28,params:[{type:"PropertyArray",name:"sysMsgs",reflectMapper:ls.sysMsg}]},qchatMessageSearchByPage:{service:"qchatMsg",sid:24,cid:94,params:[{type:"Property",name:"qchatMessageSearchByPageTag",reflectMapper:ls.qchatMessageSearchByPageTag}],response:[{type:"Property",name:"listQueryTag",reflectMapper:ci.qchatPageQueryTag},{type:"PropertyArray",name:"datas",reflectMapper:ci.qchatMsgTag}]},qchatGetMessageHistoryByIds:{service:"qchatMsg",sid:24,cid:100,params:[{type:"Property",name:"channelInfo",reflectMapper:{serverId:1,channelId:2}},{type:"PropertyArray",name:"messageReferList",reflectMapper:{msgIdServer:1,time:2}}],response:[{type:"PropertyArray",name:"qchatMsgs",reflectMapper:ci.qchatMsgTag}]},qchatGetThreadMessages:{service:"qchatMsg",sid:24,cid:101,params:[{type:"Property",name:"qchatMsg",reflectMapper:ls.qchatMsgTag},{type:"Property",name:"getThreadHistoryMsgTag",reflectMapper:ls.getThreadHistoryMsgTag}],response:[{type:"Property",name:"thread",reflectMapper:ci.qchatMsgTag},{type:"Property",name:"threadInfo",reflectMapper:{1:"messageCount",2:"lastMessageTimestamp"}},{type:"PropertyArray",name:"qchatMsgs",reflectMapper:ci.qchatMsgTag}]},qchatUpdateQuickComment:{service:"qchatMsg",sid:24,cid:102,params:[{type:"Property",name:"tag",reflectMapper:ls.qchatQuickCommentRequestTag}]},qchatGetQuickComments:{service:"qchatMsg",sid:24,cid:103,params:[{type:"Property",name:"tag",reflectMapper:ls.qchatQuickCommentQueryTag}],response:[{type:"PropertyArray",name:"quickCommentResponse",reflectMapper:{1:"serverId",2:"channelId",3:"msgIdServer",4:"totalCount",5:"lastUpdateTime",6:"details"}}]},qchatGetThreadRootMessagesMeta:{service:"qchatMsg",sid:24,cid:108,params:[{type:"Property",name:"tag",reflectMapper:{serverId:1,channelId:2}},{type:"PropertyArray",name:"qchatMsgs",reflectMapper:{time:7,msgIdServer:14}}],response:[{type:"PropertyArray",name:"metas",reflectMapper:{1:"total",2:"timestamp",3:"msgIdServer",4:"msgTime"}}]},qchatGetLastMessageOfChannels:{service:"qchatMsg",sid:24,cid:121,params:[{type:"Property",name:"tag",reflectMapper:ls.qchatGetLastMessageOfChannelsTag}],response:[{type:"PropertyArray",name:"msgs",reflectMapper:ci.qchatMsgTag}]},qchatMultiSyncServersMessageRead:{service:"qchatMsg",sid:25,cid:6,response:[{type:"Property",name:"qchatMultiSyncServersMessageReadTag",reflectMapper:ci.qchatMultiSyncServersMessageReadTag}]},qchatGetMentionedMeMessages:{service:"qchatMsg",sid:24,cid:127,params:[{type:"Property",name:"tag",reflectMapper:{serverId:1,channelId:2,timestamp:3,limit:4}}],response:[{type:"Property",name:"page",reflectMapper:ci.qchatPageQueryTag},{type:"PropertyArray",name:"datas",reflectMapper:ci.qchatMsgTag}]}};(function(b){b[b.Android=1]="Android",b[b.iOS=2]="iOS",b[b.PC=4]="PC",b[b.WindowsPhone=8]="WindowsPhone",b[b.Web=16]="Web",b[b.Server=32]="Server",b[b.Mac=64]="Mac"})(mc||(mc={}));var $v=["image","audio","video","file"],sf={time:{type:"number"},updateTime:{type:"number"},resendFlag:{type:"boolean"},persistEnable:{type:"boolean"},routeEnable:{type:"boolean"},pushEnable:{type:"boolean"},needBadge:{type:"boolean"},needPushNick:{type:"boolean"},type:{type:"enum",values:zo},fromClientType:{type:"enum",values:mc},status:{type:"number"},toAccids:{type:"object"},toType:{type:"number"},attach:{type:"object"},pushPayload:{type:"object"}};function Uh(b,w){var $=Xr({},b),A=Xr({type:w||zo.custom},Zu(sf,$));return A.serverId&&A.channelId&&A.toAccids?A.toType=Fc.channelAccids:A.serverId&&A.toAccids?A.toType=Fc.serverAccids:A.serverId&&A.channelId?A.toType=Fc.channel:A.serverId?A.toType=Fc.server:A.toAccids?A.toType=Fc.accids:A.toType=Fc.unknown,A}function Hv(b){var w=of(b,["msgIdServer","type"]);return Zu(sf,w)}var Vv=((Ps={})[zo.channelUpdateWhiteBlackIdentify]=function(b){return b.notify=jd(Ei(b.notify,jo.qchatUpdateWhiteBlackRoleTag)),b},Ps[zo.channelUpdateWhiteBlackIdentifyUser]=function(b){return b.notify=function($){return pi(Rv,$)}(Ei(b.notify,jo.qchatUpdateWhiteBlackMembersTag)),b},Ps[zo.updateQuickComment]=function(b){return b.notify=function($){return pi(uM,$)}(Ei(b.notify,ci.qchatQuickCommentRequestTag)),b},Ps[zo.channelCategoryCreate]=function(b){return b.categoryInfo=Dd(Ei(b.categoryInfo,jo.QChatChannelCategoryInfo)),b},Ps[zo.channelCategoryUpdate]=function(b){return b.categoryInfo=Dd(Ei(b.categoryInfo,jo.QChatChannelCategoryInfo)),b},Ps[zo.channelCategoryUpdateWhiteBlackIdentify]=function(b){return b.notify=jd(Ei(b.notify,jo.qchatUpdateChannelCategoryWhiteBlackRoleTag)),b},Ps[zo.channelCategoryUpdateWhiteBlackIdentifyUser]=function(b){return b.notify=jd(Ei(b.notify,jo.qchatUpdateChannelCategoryWhiteBlackMembersTag)),b},Ps[zo.serverIdentifyAdd]=function(b){return b.serverIdentifyInfo=us(Ei(b.serverIdentifyInfo,oi.serverRole)),b},Ps[zo.serverIdentifyRemove]=function(b){return b.serverIdentifyInfo=us(Ei(b.serverIdentifyInfo,oi.serverRole)),b},Ps[zo.serverIdentifyUpdate]=function(b){return b.serverIdentifyInfo=us(Ei(b.serverIdentifyInfo,oi.serverRole)),b},Ps[zo.channelIdentifyUpdate]=function(b){return b.channelIdentifyInfo=us(Ei(b.channelIdentifyInfo,oi.channelRole)),b},Ps[zo.userIdentifyUpdate]=function(b){return b.userIdentifyInfo=us(Ei(b.userIdentifyInfo,oi.memberRole)),b},Ps[zo.myMemberInfoUpdated]=function(b){var w,$=Vi(b,"userInfo.name"),A=Vi(b,"userInfo.icon");return b.updatedInfos=co(w=b.reuseServers).call(w,function(_){var Y={serverId:_.serverId};return(1&_.bits)==1&&typeof $=="string"&&Xr(Y,{nickChanged:!0,nick:$}),(2&_.bits)==2&&typeof A=="string"&&Xr(Y,{avatarChanged:!0,avatar:A}),Y}),delete b.userInfo,delete b.reuseServers,b},Ps);function Wd(b,w){var $=pi(sf,b);if(!$.attach)return $;if($.attach.serverInfo&&($.attach.serverInfo=Rd(Ei($.attach.serverInfo,Ni.serverInfo))),$.attach.channelInfo&&($.attach.channelInfo=Bd(Ei($.attach.channelInfo,jo.channelInfo))),$.attach.serverMember&&($.attach.serverMember=el(Ei($.attach.serverMember,Ni.memberInfo))),Vv[$.attach.type]&&($.attach=Vv[$.attach.type]($.attach)),$.attach.updateAuths)try{$.attach.updateAuths=Ma(JSON.parse($.attach.updateAuths))}catch(A){w.error("formatSystemNotification:JSON parse updateAuths error: ",A)}return $.attach.type&&($.attach.rawType=$.attach.type,$.attach.type=zo[$.attach.type]),$}var af={type:{type:"enum",values:Hd},fromClientType:{type:"enum",values:mc},status:{type:"number"},resendFlag:{type:"boolean"},mentionAll:{type:"boolean"},notifyReason:{type:"enum",values:Vd},pushEnable:{type:"boolean"},historyEnable:{type:"boolean"},needBadge:{type:"boolean"},needPushNick:{type:"boolean"},routeEnable:{type:"boolean"},time:{type:"number"},updateTime:{type:"number"},mentionAccids:{type:"object"},mentionRoleIds:{type:"object"},accidsOfMentionedRoles:{type:"object"},attach:{type:"object"},pushPayload:{type:"object"},isAntispam:{type:"boolean"},antiSpamInfo:{useCustomContent:{type:"boolean"},antiSpamContent:{type:"string"},antiSpamBusinessId:{type:"string"},antiSpamUsingYidun:{type:"boolean"},yidunCallback:{type:"string"},yidunAntiCheating:{type:"object"},yidunAntiSpamExt:{type:"object"},yidunAntiSpamRes:{type:"string"}},replyRefer:{fromAccount:{type:"string",rawKey:"replyMsgFromAccount"},time:{type:"number",rawKey:"replyMsgTime"},msgIdServer:{type:"string",rawKey:"replyMsgIdServer"},msgIdClient:{type:"string",rawKey:"replyMsgIdClient"}},threadRefer:{fromAccount:{type:"string",rawKey:"threadMsgFromAccount"},time:{type:"number",rawKey:"threadMsgTime"},msgIdServer:{type:"string",rawKey:"threadMsgIdServer"},msgIdClient:{type:"string",rawKey:"threadMsgIdClient"}}};function Dh(b){b.onSendBefore,b.onUploadStart,b.onUploadDone,b.onUploadProgress;var w=Ou(b,["onSendBefore","onUploadStart","onUploadDone","onUploadProgress"]),$=Zu(af,w);if($.msgIdClient=b.resendFlag?b.msgIdClient:zg(),!$.msgIdClient)throw new Nu("msgIdClient is required for resend a message","msgIdClient","required");return b.replyMessage&&b.replyMessage.msgIdServer&&($.replyMsgFromAccount=b.replyMessage.fromAccount,$.replyMsgTime=+b.replyMessage.time,$.replyMsgIdServer=b.replyMessage.msgIdServer,$.replyMsgIdClient=b.replyMessage.msgIdClient,b.replyMessage.threadRefer&&b.replyMessage.threadRefer.msgIdServer?($.threadMsgFromAccount=b.replyMessage.threadRefer.fromAccount,$.threadMsgTime=+b.replyMessage.threadRefer.time,$.threadMsgIdServer=b.replyMessage.threadRefer.msgIdServer,$.threadMsgIdClient=b.replyMessage.threadRefer.msgIdClient):($.threadMsgFromAccount=b.replyMessage.fromAccount,$.threadMsgTime=+b.replyMessage.time,$.threadMsgIdServer=b.replyMessage.msgIdServer,$.threadMsgIdClient=b.replyMessage.msgIdClient),delete $.replyMessage),$}function zv(b){return pi({operatorClientType:{type:"enum",values:mc},pushPayload:{type:"object"}},b)}function Ms(b,w,$){var A,_;return w===void 0&&(w={}),kr(this,void 0,void 0,rr.mark(function Y(){var de,V,Fe;return rr.wrap(function(sr){for(;;)switch(sr.prev=sr.next){case 0:return(de=pi(af,b)).deliveryStatus=w.deliveryStatus?Ca[w.deliveryStatus]:Ca[Ca.success],w.time&&(de.time=w.time),de.updateContent&&(V=pi({status:{type:"number"}},V=Ei(V=JSON.parse(de.updateContent),ci.qchatMsgTag)),de.updateContent=V),de.updateOperatorInfo&&(Fe=zv(Ei(Fe=JSON.parse(de.updateOperatorInfo),ci.qchatMsgUpdateTag)),de.updateOperatorInfo=Fe),((A=de==null?void 0:de.threadRefer)===null||A===void 0?void 0:A.fromAccount)===""&&delete de.threadRefer,((_=de==null?void 0:de.replyRefer)===null||_===void 0?void 0:_.fromAccount)===""&&delete de.replyRefer,de.attach&&w.attachUrl&&(de.attach.url=w.attachUrl),sr.next=10,Wv(de,$);case 10:return sr.abrupt("return",sr.sent);case 11:case"end":return sr.stop()}},Y)}))}function Wv(b,w){return kr(this,void 0,void 0,rr.mark(function $(){var A;return rr.wrap(function(Y){for(;;)switch(Y.prev=Y.next){case 0:if(ha($v).call($v,b.type)&&b.attach&&b.attach.url){Y.next=2;break}return Y.abrupt("return",b);case 2:if(w&&w.cloudStorage&&typeof w.cloudStorage.getPrivateUrl=="function"&&typeof w.cloudStorage.getOriginUrl=="function"){Y.next=4;break}return Y.abrupt("return",b);case 4:if(!(ai(A=b.attach.url).call(A,"_im_url=1")<0)){Y.next=7;break}return b.attach.url=w.cloudStorage.getPrivateUrl(b.attach.url),Y.abrupt("return",b);case 7:return Y.prev=7,Y.next=10,w.cloudStorage.getOriginUrl(b.attach.url);case 10:b.attach.url=Y.sent,Y.next=16;break;case 13:throw Y.prev=13,Y.t0=Y.catch(7),new Nu('url "'+b.attach.url+'" parse error',"message.attach.url","parse error");case 16:return Y.abrupt("return",b);case 17:case"end":return Y.stop()}},$,null,[[7,13]])}))}function qh(b,w,$){return w===void 0&&(w={}),kr(this,void 0,void 0,rr.mark(function A(){var _;return rr.wrap(function(de){for(;;)switch(de.prev=de.next){case 0:if(rs(b)&&b.length>0){de.next=2;break}return de.abrupt("return",[]);case 2:return _=co(b).call(b,function(V){return Ms(V,w,$)}),de.next=5,ro.all(_);case 5:return de.abrupt("return",de.sent);case 6:case"end":return de.stop()}},A)}))}var aM={totalCount:{type:"number"},lastUpdateTime:{type:"number"},details:{type:"object"}};function cM(b){var w=co(b).call(b,function(A){var _,Y=pi(aM,A);return Y.details=co(_=Y.details).call(_,function(de){return{count:de.count,hasSelf:de.self,severalAccids:de.topN,type:de.type}}),Y}),$={};return kn(w).call(w,function(A){return $[A.msgIdServer]=A}),$}var uM={type:{type:"number"},time:{type:"number"},opeType:{type:"number"}},Gv={includeSelf:{type:"number"},order:{type:"enum",values:Ac},sort:{type:"enum",values:tf},msgTypes:{type:"object"},subTypes:{type:"object"}},lM={hasMore:{type:"boolean"},nextTimetag:{type:"number"},cursor:{type:"string"}},dM={6:function(w){return this.core.qchatChannel.subscribeForVisitorService.deleteAutoSetInServerId(w.serverId),!0},16:function(w){return this.core.qchatChannel.subscribeForVisitorService.deleteAutoSetInChannel(w.serverId,w.channelId),!0},26:function(w){var $=Vi(w,"attach.addAccids");return $&&ha($).call($,this.core.account)&&this.core.eventBus.emit("qchatChannel/serverIdentifyChange",w),!0},27:function(w){var $=Vi(w,"attach.deleteAccids");return $&&ha($).call($,this.core.account)&&this.core.eventBus.emit("qchatChannel/serverIdentifyChange",w),!0},31:function(w){return w.attach.event===2&&(this.core.eventBus.emit("qchatChannel/autoUnSubscribe",w),this.core.eventBus.emit("qchatMedia/serverOrChannelLeave",w)),!0},32:function(w){return w.attach.event===2?(this.core.eventBus.emit("qchatChannel/autoUnSubscribe",w),this.core.eventBus.emit("qchatMedia/serverOrChannelLeave",w)):w.attach.event===1&&this.core.qchatChannel.subscribeForVisitorService.deleteServer(w.serverId),!0},34:function(w){return w.attach.event===2&&this.core.qchatChannel.subscribeForVisitorService.unSubscribeChannel(w.serverId,w.channelId),!0},101:function(w){var $=of(w,["serverId","channelId","ext","fromAccount","fromNick","time"]);return this.logger.log("qchat on recvTypingEvent: ",$),this.core.emit("recvTypingEvent",$),!1}},pM=function(){function b($){this.core=$,this.logger=$.logger}var w=b.prototype;return w.sendSystemNotification=function(A){return kr(this,void 0,void 0,rr.mark(function _(){var Y,de;return rr.wrap(function(Fe){for(;;)switch(Fe.prev=Fe.next){case 0:return Fe.next=2,this.core.sendCmd("qchatSendCustomSysMsg",{sysMsg:Uh(A)});case 2:return Y=Fe.sent,de=Wd(Y.content.sysMsg,this.logger),this.core.options.debugLevel==="debug"?this.logger.debug("sendCustomSysMsg success",de):this.logger.log("sendCustomSysMsg success",de.serverId,de.channelId,de.msgIdServer),Fe.abrupt("return",de);case 6:case"end":return Fe.stop()}},_,this)}))},w.updateSystemNotification=function(A){return kr(this,void 0,void 0,rr.mark(function _(){var Y,de,V,Fe,Et;return rr.wrap(function(fr){for(;;)switch(fr.prev=fr.next){case 0:return Y=A.systemNotification,de=Ou(A,["systemNotification"]),V=of(Y,["msgIdServer","type","body","ext","status"]),Fe=Uh(V),fr.next=5,this.core.sendCmd("qchatUpdateSystemNotification",{sysMsg:Fe,qchatMsgUpdateTag:Xr(Xr({},de),{operatorAccount:this.core.account,operatorClientType:mc.Web,pushPayload:so(A.pushPayload),routeEnable:Ih.boolean(A,"routeEnable")})});case 5:return Et=fr.sent,fr.abrupt("return",Wd(Et.content.sysMsg,this.logger));case 7:case"end":return fr.stop()}},_,this)}))},w.markSystemNotificationsRead=function(A){return kr(this,void 0,void 0,rr.mark(function _(){var Y;return rr.wrap(function(V){for(;;)switch(V.prev=V.next){case 0:return V.next=2,this.core.sendCmd("qchatMarkSysMsgRead",{sysMsgs:co(Y=A.systemNotifications).call(Y,function(Fe){return Hv(Fe)})});case 2:case"end":return V.stop()}},_,this)}))},w.onSysMsg=function(A){var _=A.content.sysMsg;if(_){var Y=Wd(_,this.core.logger),de=dM[zo[Y.type]];if(de&&de.call(this,Y)===!1)return;var V={feature:"default",systemNotifications:[Y]};this.logger.log("qchat on systemNotification: ",V),this.core.emit("systemNotification",V)}else this.core.logger.warn("No sysMsg in onSysMsg packet")},w.onMultiSysMsg=function(A){var _=A.content.sysMsg;if(_){var Y=Wd(_,this.logger);this.core.emit("systemNotificationUpdate",Y)}},w.onSyncSysMsg=function(A){var _=this,Y=A.content.systemNotifications;if(Y&&Y.length>0){var de=co(Y).call(Y,function(V){return Wd(V,_.logger)});this.core.emit("systemNotification",{feature:"sync",systemNotifications:de})}else this.logger.warn("sync system notification not exist")},b}(),$h=["image","audio","video","file"],fM=function(){function b($){var A=this;this.markMessageRead=jh(function(_){return kr(A,void 0,void 0,rr.mark(function Y(){var de,V;return rr.wrap(function(Et){for(;;)switch(Et.prev=Et.next){case 0:return Et.next=2,this.core.sendCmd("qchatMarkMessageRead",{markMsgReadTag:_});case 2:de=Et.sent,V=Eh(de.content.unreadInfo),this.core.eventBus.emit("qchatChannel/updateUnreads",[V]);case 5:case"end":return Et.stop()}},Y,this)}))},200),this.core=$,this.logger=$.logger}var w=b.prototype;return w.sendMessage=function(A){var _,Y,de,V;return kr(this,void 0,void 0,rr.mark(function Fe(){var Et,sr,fr,Sr,Tr,Pr;return rr.wrap(function(jr){for(;;)switch(jr.prev=jr.next){case 0:if(!(ai($h).call($h,A.type)>-1)){jr.next=4;break}return jr.next=3,this.doSendFile(A);case 3:A.attach=jr.sent;case 4:return Et=Dh(Xr({fromAccount:this.core.account},A)),jr.next=7,Ms(Et,{time:new Date().getTime(),deliveryStatus:Ca.sending},this.core);case 7:sr=jr.sent;try{A.onSendBefore&&A.onSendBefore(sr)}catch(Jr){this.logger.error("sendMsg: options.onSendBefore error",Jr)}return jr.prev=9,jr.next=12,this.core.sendCmd("qchatSendMsg",{qchatMsg:Et});case 12:fr=jr.sent,jr.next=22;break;case 15:return jr.prev=15,jr.t0=jr.catch(9),jr.next=19,Ms(Et,{time:new Date().getTime(),deliveryStatus:Ca.failed,attachUrl:(_=sr.attach)===null||_===void 0?void 0:_.url},this.core);case 19:throw Sr=jr.sent,jr.t0.msg=Sr,jr.t0;case 22:return Tr=fr.content,jr.next=25,Ms(Xr({},Tr.qchatMsg),{deliveryStatus:Ca.success,attachUrl:(Y=sr.attach)===null||Y===void 0?void 0:Y.url},this.core);case 25:if(!(Pr=jr.sent).isAntispam){jr.next=29;break}throw{code:10403,msg:Pr,message:((de=Pr==null?void 0:Pr.antiSpamInfo)===null||de===void 0?void 0:de.yidunAntiSpamRes)||"message has be antispam",isAntispam:!0,yidunAntiSpamRes:((V=Pr==null?void 0:Pr.antiSpamInfo)===null||V===void 0?void 0:V.yidunAntiSpamRes)||""};case 29:return jr.abrupt("return",Pr);case 30:case"end":return jr.stop()}},Fe,this,[[9,15]])}))},w.doSendFile=function(A){return kr(this,void 0,void 0,rr.mark(function _(){var Y;return rr.wrap(function(V){for(;;)switch(V.prev=V.next){case 0:if(zr({type:{type:"enum",values:["image","audio","video","file"]},attach:{type:"object",rules:{url:{type:"string",allowEmpty:!1}},required:!1},maxSize:{type:"number",min:1,required:!1}},A),Y=A.attach){V.next=23;break}if(this.core.cloudStorage&&this.core.cloudStorage.uploadFile){V.next=5;break}throw new Error('Service "cloudStorage" does not exist');case 5:return V.prev=5,V.next=8,this.core.cloudStorage.uploadFile(A);case 8:Y=V.sent,V.next=15;break;case 11:throw V.prev=11,V.t0=V.catch(5),this.logger.error("sendFile:: upload File error or abort",V.t0),V.t0;case 15:V.prev=15,A.onUploadDone&&A.onUploadDone(Y),V.next=23;break;case 19:throw V.prev=19,V.t1=V.catch(15),this.logger.error("sendFile options.onUploadDone err",V.t1),V.t1;case 23:return V.abrupt("return",Y);case 24:case"end":return V.stop()}},_,this,[[5,11],[15,19]])}))},w.resendMessage=function(A){var _,Y;return kr(this,void 0,void 0,rr.mark(function de(){var V,Fe,Et,sr,fr;return rr.wrap(function(Tr){for(;;)switch(Tr.prev=Tr.next){case 0:return(V=Dh(Xr(Xr({},A),{resendFlag:!0}))).deliveryStatus=Ca.sending,Tr.prev=2,Tr.next=5,this.core.sendCmd("qchatSendMsg",{qchatMsg:V});case 5:Fe=Tr.sent,Tr.next=15;break;case 8:return Tr.prev=8,Tr.t0=Tr.catch(2),Tr.next=12,Ms(V,{time:new Date().getTime(),deliveryStatus:Ca.failed},this.core);case 12:throw Et=Tr.sent,Tr.t0.msg=Et,Tr.t0;case 15:return sr=Fe.content,Tr.next=18,Ms(Xr({},sr.qchatMsg),{deliveryStatus:Ca.success},this.core);case 18:if(!(fr=Tr.sent).isAntispam){Tr.next=22;break}throw{code:10403,msg:fr,message:((_=fr==null?void 0:fr.antiSpamInfo)===null||_===void 0?void 0:_.yidunAntiSpamRes)||"message has be antispam",isAntispam:!0,yidunAntiSpamRes:((Y=fr==null?void 0:fr.antiSpamInfo)===null||Y===void 0?void 0:Y.yidunAntiSpamRes)||""};case 22:return Tr.abrupt("return",fr);case 23:case"end":return Tr.stop()}},de,this,[[2,8]])}))},w.doUpdateMessage=function(A){var _,Y;return kr(this,void 0,void 0,rr.mark(function de(){var V,Fe,Et,sr,fr;return rr.wrap(function(Tr){for(;;)switch(Tr.prev=Tr.next){case 0:return V=A.message,Fe=Ou(A,["message"]),(Et=Dh(V)).msgIdClient=void 0,Et.time=V.time,Tr.next=6,this.core.sendCmd("qchatUpdateMessage",{qchatMsg:Et,qchatMsgUpdateTag:Xr(Xr({},Fe),{operatorAccount:this.core.account,operatorClientType:mc.Web,pushPayload:so(A.pushPayload),routeEnable:Ih.boolean(A,"routeEnable")})});case 6:return sr=Tr.sent,Tr.next=9,Ms(sr.content.qchatMsg,{},this.core);case 9:if(fr=Tr.sent,this.core.eventBus.emit("qchatChannel/changeUnread",fr,!0),!sr.content.qchatMsg.isAntispam){Tr.next=14;break}throw{code:10403,msg:Et,message:((_=sr.content.qchatMsg)===null||_===void 0?void 0:_.yidunAntiSpamRes)||"message has be antispam",isAntispam:!0,yidunAntiSpamRes:((Y=sr.content.qchatMsg)===null||Y===void 0?void 0:Y.yidunAntiSpamRes)||""};case 14:return Tr.abrupt("return",fr);case 15:case"end":return Tr.stop()}},de,this)}))},w.getHistoryMessage=function(A){return kr(this,void 0,void 0,rr.mark(function _(){var Y,de,V,Fe=this;return rr.wrap(function(sr){for(;;)switch(sr.prev=sr.next){case 0:return sr.next=2,this.core.sendCmd("qchatGetHistoryMsg",{getHistoryMsgTag:Xr(Xr({},A),{reverse:Eu(A)?1:0})});case 2:return de=sr.sent,V=de.content,sr.next=6,ro.all(co(Y=V.qchatMsgs).call(Y,function(fr){return Ms(fr,{},Fe.core)}));case 6:return sr.abrupt("return",sr.sent);case 7:case"end":return sr.stop()}},_,this)}))},w.getMentionedMeMessages=function(A){return kr(this,void 0,void 0,rr.mark(function _(){var Y,de,V,Fe,Et,sr=this;return rr.wrap(function(Sr){for(;;)switch(Sr.prev=Sr.next){case 0:return Sr.next=2,this.core.sendCmd("qchatGetMentionedMeMessages",{tag:A});case 2:return de=Sr.sent,V=de.content,Tr=V.page,Fe=pi(lM,Tr),Sr.next=7,ro.all(co(Y=V.datas).call(Y,function(Pr){return Ms(Pr,{},sr.core)}));case 7:return Et=Sr.sent,Sr.abrupt("return",{pageInfo:Fe,messages:Et});case 9:case"end":return Sr.stop()}var Tr},_,this)}))},w.areMentionedMeMessages=function(A){return kr(this,void 0,void 0,rr.mark(function _(){var Y,de,V;return rr.wrap(function(Et){for(;;)switch(Et.prev=Et.next){case 0:Y={},de=0;case 2:if(!(de<A.length)){Et.next=13;break}if((V=A[de]).fromAccount!==this.core.account){Et.next=7;break}return Y[V.msgIdClient]=!1,Et.abrupt("continue",10);case 7:return Et.next=9,this.core.qchatChannel.subscribeModuleService.getMentionedFlag(V,!0);case 9:Y[V.msgIdClient]=Et.sent;case 10:de++,Et.next=2;break;case 13:return Et.abrupt("return",Y);case 14:case"end":return Et.stop()}},_,this)}))},w.getLastMessageOfChannels=function(A){return kr(this,void 0,void 0,rr.mark(function _(){var Y,de,V;return rr.wrap(function(Et){for(;;)switch(Et.prev=Et.next){case 0:return Et.next=2,this.core.sendCmd("qchatGetLastMessageOfChannels",{tag:A});case 2:return Y=Et.sent,de=Y.content.msgs,Et.next=6,qh(de,{},this.core);case 6:return V=Et.sent,Et.abrupt("return",kc(V).call(V,function(sr,fr){return sr[fr.channelId]=fr,sr},{}));case 8:case"end":return Et.stop()}},_,this)}))},w.messageSearchByPage=function(A){return kr(this,void 0,void 0,rr.mark(function _(){var Y,de,V,Fe,Et;return rr.wrap(function(fr){for(;;)switch(fr.prev=fr.next){case 0:return fr.next=2,this.core.sendCmd("qchatMessageSearchByPage",{qchatMessageSearchByPageTag:Xr(Xr({},(Sr=A,Zu(Gv,Sr))),{includeSelf:A.includeSelf?1:""})});case 2:return Y=fr.sent,de=Y.content,V=de.datas,Fe=de.listQueryTag,fr.next=6,qh(V,{},this.core);case 6:return Et=fr.sent,fr.abrupt("return",{listQueryTag:{hasMore:+Fe.hasMore==1,nextTimetag:Fe.nextTimetag?wo(Fe.nextTimetag):0,cursor:Fe.cursor},datas:Et});case 8:case"end":return fr.stop()}var Sr},_,this)}))},w.onMsg=function(A){return kr(this,void 0,void 0,rr.mark(function _(){var Y,de;return rr.wrap(function(Fe){for(;;)switch(Fe.prev=Fe.next){case 0:if(Y=A.content.qchatMsg){Fe.next=4;break}return this.logger.warn("No qchatMsg in qchatMsg packet"),Fe.abrupt("return");case 4:return Fe.next=6,Ms(Y,{},this.core);case 6:de=Fe.sent,this.core.eventBus.emit("qchatChannel/changeUnread",de,!1),this.core.emit("message",de);case 9:case"end":return Fe.stop()}},_,this)}))},w.onRecvUnreadInfo=function(A){return kr(this,void 0,void 0,rr.mark(function _(){var Y,de;return rr.wrap(function(Fe){for(;;)switch(Fe.prev=Fe.next){case 0:if(Y=A.content.qchatMsg){Fe.next=3;break}return Fe.abrupt("return");case 3:return Fe.next=5,Ms(Y);case 5:de=Fe.sent,this.core.eventBus.emit("qchatChannel/changeUnread",de,!1);case 7:case"end":return Fe.stop()}},_,this)}))},w.onMultiSyncRead=function(A){var _=A.content.unreadInfo;if(_){var Y=Eh(_);this.core.eventBus.emit("qchatChannel/updateUnreads",[Y])}},w.onMultiSyncServersRead=function(A){var _=A.content.qchatMultiSyncServersMessageReadTag;if(_){var Y=Tu(_),de=Y.successServerIds,V=Y.ackTimestamp;this.core.eventBus.emit("qchatChannel/clearUnreadCountByServers",de,V)}},w.onRecvMsgUpdate=function(A){return kr(this,void 0,void 0,rr.mark(function _(){var Y,de,V,Fe;return rr.wrap(function(sr){for(;;)switch(sr.prev=sr.next){case 0:if(Y=A.content.qchatMsg,de=A.content.qchatMsgUpdateInfo,Y){sr.next=4;break}return sr.abrupt("return");case 4:return sr.next=6,Ms(Y,{},this.core);case 6:V=sr.sent,Fe=zv(de),this.core.eventBus.emit("qchatChannel/changeUnread",V,!0),this.core.emit("messageUpdate",V,Fe);case 10:case"end":return sr.stop()}},_,this)}))},b}(),mM=function(){function b($){var A=this;this._sendTypingEvent=jh(function(_){return kr(A,void 0,void 0,rr.mark(function Y(){return rr.wrap(function(V){for(;;)switch(V.prev=V.next){case 0:return V.next=2,this.core.sendCmd("qchatSendCustomSysMsg",{sysMsg:Uh(Xr(Xr({},_),{resendFlag:!1,persistEnable:!1,routeEnable:!1,pushEnable:!1,needBadge:!1,needPushNick:!1}),zo.msgTyping)});case 2:case"end":return V.stop()}},Y,this)}))},3e3),this.core=$,this.logger=$.logger,this.lastChannelIdInTyping=""}var w=b.prototype;return w.getMessageHistoryByIds=function(A){return kr(this,void 0,void 0,rr.mark(function _(){var Y,de;return rr.wrap(function(Fe){for(;;)switch(Fe.prev=Fe.next){case 0:return Fe.next=2,this.core.sendCmd("qchatGetMessageHistoryByIds",{channelInfo:{serverId:A.serverId,channelId:A.channelId},messageReferList:A.messageReferList});case 2:return de=Fe.sent,Fe.abrupt("return",ro.all(co(Y=de.content.qchatMsgs).call(Y,function(Et){return Ms(Et)})));case 4:case"end":return Fe.stop()}},_,this)}))},w.getReferMessages=function(A){var _,Y;return kr(this,void 0,void 0,rr.mark(function de(){var V;return rr.wrap(function(Et){for(;;)switch(Et.prev=Et.next){case 0:if(!((_=A.message.replyRefer)===null||_===void 0)&&_.msgIdServer&&(!((Y=A.message.threadRefer)===null||Y===void 0)&&Y.msgIdServer)){Et.next=2;break}throw new Error("Message has no reply");case 2:return Et.next=4,this.getMessageHistoryByIds({serverId:A.message.serverId,channelId:A.message.channelId,messageReferList:[A.message.replyRefer,A.message.threadRefer]});case 4:if(V=Et.sent,A.referType!==pc[pc.all]){Et.next=9;break}return Et.abrupt("return",{replyMessage:V[0],threadMessage:V[1]});case 9:if(A.referType!==pc[pc.reply]){Et.next=13;break}return Et.abrupt("return",{replyMessage:V[0]});case 13:if(A.referType!==pc[pc.thread]){Et.next=15;break}return Et.abrupt("return",{threadMessage:V[1]});case 15:return Et.abrupt("return",{replyMessage:V[0],threadMessage:V[1]});case 16:case"end":return Et.stop()}},de,this)}))},w.getThreadMessages=function(A){var _;return kr(this,void 0,void 0,rr.mark(function Y(){var de,V,Fe,Et,sr;return rr.wrap(function(Sr){for(;;)switch(Sr.prev=Sr.next){case 0:return V=!((_=A.message.threadRefer)===null||_===void 0)&&_.msgIdServer?Xr({serverId:A.message.serverId,channelId:A.message.channelId},A.message.threadRefer):A.message,Sr.next=3,this.core.sendCmd("qchatGetThreadMessages",{qchatMsg:V,getThreadHistoryMsgTag:Xr(Xr({},A.messageQueryOption),{reverse:Ih.boolean(A.messageQueryOption,"reverse")})});case 3:return Fe=Sr.sent,Sr.next=6,Ms(Fe.content.thread);case 6:return Et=Sr.sent,Sr.next=9,ro.all(co(de=Fe.content.qchatMsgs).call(de,function(Tr){return Ms(Tr)}));case 9:return sr=Sr.sent,Sr.abrupt("return",{thread:Et,threadInfo:{messageCount:+Fe.content.threadInfo.messageCount,lastMessageTimestamp:+Fe.content.threadInfo.lastMessageTimestamp},messages:sr});case 11:case"end":return Sr.stop()}},Y,this)}))},w.getThreadRootMessagesMeta=function(A){return kr(this,void 0,void 0,rr.mark(function _(){var Y,de,V,Fe;return rr.wrap(function(sr){for(;;)switch(sr.prev=sr.next){case 0:return Y=A.threadRootMessages,de=Ou(A,["threadRootMessages"]),sr.next=3,this.core.sendCmd("qchatGetThreadRootMessagesMeta",{qchatMsgs:Y,tag:de});case 3:if(V=sr.sent,!((Fe=V.content.metas)&&Fe.length>0)){sr.next=7;break}return sr.abrupt("return",co(Fe).call(Fe,function(fr){return Xr(Xr({},fr),{total:wo(fr.total),timestamp:wo(fr.timestamp),msgTime:wo(fr.msgTime)})}));case 7:return sr.abrupt("return",[]);case 8:case"end":return sr.stop()}},_,this)}))},w.getQuickComments=function(A){return kr(this,void 0,void 0,rr.mark(function _(){var Y,de,V;return rr.wrap(function(Et){for(;;)switch(Et.prev=Et.next){case 0:return Et.next=2,this.core.sendCmd("qchatGetQuickComments",{tag:{serverId:A.serverId,channelId:A.channelId,msgIdServerList:so(co(Y=A.msgList).call(Y,function(sr){return sr.msgIdServer}))}});case 2:return de=Et.sent,V=de.content.quickCommentResponse,Et.abrupt("return",cM(V));case 5:case"end":return Et.stop()}},_,this)}))},w.updateQuickComment=function(A,_){return kr(this,void 0,void 0,rr.mark(function Y(){var de,V,Fe,Et,sr,fr;return rr.wrap(function(Tr){for(;;)switch(Tr.prev=Tr.next){case 0:return zr({type:{type:"number"},commentMessage:{type:"object",rules:{msgIdServer:{type:"string",allowEmpty:!1}}}},A),de=A.commentMessage,V=de.serverId,Fe=de.channelId,Et=de.fromAccount,sr=de.msgIdServer,fr=de.time,Tr.next=4,this.core.sendCmd("qchatUpdateQuickComment",{tag:{serverId:V,channelId:Fe,fromAccount:Et,msgIdServer:sr,time:fr,type:A.type,opeType:_,opeAccid:this.core.account}});case 4:case"end":return Tr.stop()}},Y,this)}))},w.sendTypingEvent=function(A){return kr(this,void 0,void 0,rr.mark(function _(){return rr.wrap(function(de){for(;;)switch(de.prev=de.next){case 0:if(A.channelId!==this.lastChannelIdInTyping){de.next=4;break}return this.logger.log("qchatMsg sendTypingEvent throttle"),this._sendTypingEvent(A),de.abrupt("return");case 4:this.lastChannelIdInTyping=A.channelId,this._sendTypingEvent.flush(),this._sendTypingEvent(A);case 7:case"end":return de.stop()}},_,this)}))},b}(),Kv=function(b){function w(A){var _;return(_=b.call(this,"qchatMsg",A)||this).core=A,_.lastChannelIdInMark="",Oa({cmdMap:Lh,cmdConfig:sM}),_.notificationModuleService=new pM(A),_.messageModuleService=new fM(A),_.extendModuleService=new mM(A),_}Co(w,b);var $=w.prototype;return $.sendMessage=function(_){return kr(this,void 0,void 0,rr.mark(function Y(){return rr.wrap(function(V){for(;;)switch(V.prev=V.next){case 0:return zr({serverId:{type:"string",allowEmpty:!1},channelId:{type:"string",allowEmpty:!1},type:{type:"enum",values:ri(Hd)},ext:{type:"string",required:!1},mentionAll:{type:"boolean",required:!1},mentionAccids:{type:"array",itemType:"string",required:!1},mentionRoleIds:{type:"array",itemType:"string",required:!1,min:1},historyEnable:{type:"boolean",required:!1},pushEnable:{type:"boolean",required:!1}},_),V.next=3,this.messageModuleService.sendMessage(_);case 3:return V.abrupt("return",V.sent);case 4:case"end":return V.stop()}},Y,this)}))},$.updateMessage=function(_){return kr(this,void 0,void 0,rr.mark(function Y(){return rr.wrap(function(V){for(;;)switch(V.prev=V.next){case 0:if(zr({message:{type:"object",rules:{serverId:{type:"string",allowEmpty:!1},channelId:{type:"string",allowEmpty:!1},msgIdServer:{type:"string",allowEmpty:!1},time:{type:"number",min:0},body:{type:"string",required:!1},ext:{type:"string",required:!1}}}},_),!(typeof _.message.status=="number"&&_.message.status<1e4)){V.next=3;break}throw new uo("Status should be greater than or equal to 10000");case 3:return V.next=5,this.messageModuleService.doUpdateMessage(_);case 5:return V.abrupt("return",V.sent);case 6:case"end":return V.stop()}},Y,this)}))},$.resendMessage=function(_){return kr(this,void 0,void 0,rr.mark(function Y(){return rr.wrap(function(V){for(;;)switch(V.prev=V.next){case 0:return zr({serverId:{type:"string",allowEmpty:!1},channelId:{type:"string",allowEmpty:!1},msgIdClient:{type:"string",allowEmpty:!1}},_),V.next=3,this.messageModuleService.resendMessage(_);case 3:return V.abrupt("return",V.sent);case 4:case"end":return V.stop()}},Y,this)}))},$.deleteMessage=function(_){return kr(this,void 0,void 0,rr.mark(function Y(){var de;return rr.wrap(function(Fe){for(;;)switch(Fe.prev=Fe.next){case 0:return zr({message:{type:"object",rules:{serverId:{type:"string",allowEmpty:!1},channelId:{type:"string",allowEmpty:!1},msgIdServer:{type:"string",allowEmpty:!1},time:{type:"number",min:0}}}},_),(de=JSON.parse(so(_))).message.status=2,Fe.next=5,this.messageModuleService.doUpdateMessage(de);case 5:return Fe.abrupt("return",Fe.sent);case 6:case"end":return Fe.stop()}},Y,this)}))},$.revokeMessage=function(_){return kr(this,void 0,void 0,rr.mark(function Y(){var de;return rr.wrap(function(Fe){for(;;)switch(Fe.prev=Fe.next){case 0:return zr({message:{type:"object",rules:{serverId:{type:"string",allowEmpty:!1},channelId:{type:"string",allowEmpty:!1},msgIdServer:{type:"string",allowEmpty:!1},time:{type:"number",min:0}}}},_),(de=JSON.parse(so(_))).message=of(de.message,["serverId","channelId","msgIdServer","time"]),de.message.status=1,Fe.next=6,this.messageModuleService.doUpdateMessage(de);case 6:return Fe.abrupt("return",Fe.sent);case 7:case"end":return Fe.stop()}},Y,this)}))},$.markMessageRead=function(_){return kr(this,void 0,void 0,rr.mark(function Y(){return rr.wrap(function(V){for(;;)switch(V.prev=V.next){case 0:zr({serverId:{type:"string"},channelId:{type:"string"},time:{type:"number",min:0}},_),_.channelId!==this.lastChannelIdInMark&&this.messageModuleService.markMessageRead.flush(),this.lastChannelIdInMark=_.channelId,this.messageModuleService.markMessageRead(_);case 4:case"end":return V.stop()}},Y,this)}))},$.replyMessage=function(_){zr({replyMessage:{type:"object",rules:{msgIdServer:{type:"string",allowEmpty:!1}}}},_);var Y=_.replyMessage;if(_.serverId!==Y.serverId||_.channelId!==Y.channelId)throw new uo("Forbid replying to message from other server, channel");return this.sendMessage(_)},$.getMessageHistoryByIds=function(_){return kr(this,void 0,void 0,rr.mark(function Y(){return rr.wrap(function(V){for(;;)switch(V.prev=V.next){case 0:return zr({serverId:{type:"string",allowEmpty:!1},channelId:{type:"string",allowEmpty:!1},messageReferList:{type:"array",rules:{msgIdServer:{type:"string",allowEmpty:!1},time:{type:"number"}}}},_),V.next=3,this.extendModuleService.getMessageHistoryByIds(_);case 3:return V.abrupt("return",V.sent);case 4:case"end":return V.stop()}},Y,this)}))},$.getReferMessages=function(_){return kr(this,void 0,void 0,rr.mark(function Y(){return rr.wrap(function(V){for(;;)switch(V.prev=V.next){case 0:return zr({message:{type:"object",rules:{msgIdServer:{type:"string",allowEmpty:!1},time:{type:"number"}}},referType:{type:"enum",values:ri(pc),required:!1}},_),V.next=3,this.extendModuleService.getReferMessages(_);case 3:return V.abrupt("return",V.sent);case 4:case"end":return V.stop()}},Y,this)}))},$.getThreadMessages=function(_){return kr(this,void 0,void 0,rr.mark(function Y(){return rr.wrap(function(V){for(;;)switch(V.prev=V.next){case 0:return zr({message:{type:"object",rules:{msgIdServer:{type:"string",allowEmpty:!1},time:{type:"number"}}},messageQueryOption:{type:"object",rules:{beginTime:{type:"number",required:!1},endTime:{type:"number",required:!1},excludeMsgId:{type:"string",required:!1},limit:{type:"number",required:!1},reverse:{type:"boolean",required:!1}}}},_),V.next=3,this.extendModuleService.getThreadMessages(_);case 3:return V.abrupt("return",V.sent);case 4:case"end":return V.stop()}},Y,this)}))},$.getThreadRootMessagesMeta=function(_){return kr(this,void 0,void 0,rr.mark(function Y(){return rr.wrap(function(V){for(;;)switch(V.prev=V.next){case 0:return zr({serverId:{type:"string",allowEmpty:!1},channelId:{type:"string",allowEmpty:!1},threadRootMessages:{type:"array",rules:{msgIdServer:{type:"string",allowEmpty:!1},time:{type:"number"}}}},_),V.next=3,this.extendModuleService.getThreadRootMessagesMeta(_);case 3:return V.abrupt("return",V.sent);case 4:case"end":return V.stop()}},Y,this)}))},$.sendSystemNotification=function(_){return kr(this,void 0,void 0,rr.mark(function Y(){return rr.wrap(function(V){for(;;)switch(V.prev=V.next){case 0:return zr({serverId:{type:"string",allowEmpty:!1},channelId:{type:"string",allowEmpty:!1,required:!1},attach:{type:"object",required:!1}},_),V.next=3,this.notificationModuleService.sendSystemNotification(_);case 3:return V.abrupt("return",V.sent);case 4:case"end":return V.stop()}},Y,this)}))},$.updateSystemNotification=function(_){return kr(this,void 0,void 0,rr.mark(function Y(){return rr.wrap(function(V){for(;;)switch(V.prev=V.next){case 0:return zr({systemNotification:{type:"object",rules:{msgIdServer:{type:"string",allowEmpty:!1},type:{type:"enum",values:ri(zo)},body:{type:"string",required:!1},ext:{type:"string",required:!1},status:{type:"number",required:!1}}}},_),V.next=3,this.notificationModuleService.updateSystemNotification(_);case 3:return V.abrupt("return",V.sent);case 4:case"end":return V.stop()}},Y,this)}))},$.markSystemNotificationsRead=function(_){return kr(this,void 0,void 0,rr.mark(function Y(){return rr.wrap(function(V){for(;;)switch(V.prev=V.next){case 0:return zr({systemNotifications:{type:"array",rules:{msgIdServer:{type:"string",allowEmpty:!1},type:{type:"string",allowEmpty:!1}},min:1}},_),V.next=3,this.notificationModuleService.markSystemNotificationsRead(_);case 3:case"end":return V.stop()}},Y,this)}))},$.getHistoryMessage=function(_){return kr(this,void 0,void 0,rr.mark(function Y(){return rr.wrap(function(V){for(;;)switch(V.prev=V.next){case 0:return zr({serverId:{type:"string",allowEmpty:!1},channelId:{type:"string",allowEmpty:!1},beginTime:{type:"number",min:0,required:!1},endTime:{type:"number",min:0,required:!1},excludeMsgId:{type:"string",allowEmpty:!1,required:!1},limit:{type:"number",min:1,required:!1},reverse:{type:"boolean",required:!1}},_),V.next=3,this.messageModuleService.getHistoryMessage(_);case 3:return V.abrupt("return",V.sent);case 4:case"end":return V.stop()}},Y,this)}))},$.getMentionedMeMessages=function(_){return kr(this,void 0,void 0,rr.mark(function Y(){return rr.wrap(function(V){for(;;)switch(V.prev=V.next){case 0:return zr({serverId:{type:"string",allowEmpty:!1},channelId:{type:"string",allowEmpty:!1},timestamp:{type:"number",min:0,required:!1},limit:{type:"number",min:1,required:!1}},_),V.next=3,this.messageModuleService.getMentionedMeMessages(_);case 3:return V.abrupt("return",V.sent);case 4:case"end":return V.stop()}},Y,this)}))},$.areMentionedMeMessages=function(_){return kr(this,void 0,void 0,rr.mark(function Y(){var de;return rr.wrap(function(Fe){for(;;)switch(Fe.prev=Fe.next){case 0:if(zr({messages:{type:"array",rules:{serverId:{type:"string",allowEmpty:!1},channelId:{type:"string",allowEmpty:!1},msgIdServer:{type:"string",allowEmpty:!1}},min:1}},_),ju(de=_.messages).call(de,function(Et){return _.messages[0].serverId===Et.serverId})){Fe.next=4;break}throw new uo("Different serverId",_,10414);case 4:if(!this.core.qchatChannel.subscribeForVisitorService.isInAutoServers(_.messages[0].serverId)){Fe.next=7;break}throw new uo("Not allowed for visitor",_,10403);case 7:return Fe.next=9,this.messageModuleService.areMentionedMeMessages(_.messages);case 9:return Fe.abrupt("return",Fe.sent);case 10:case"end":return Fe.stop()}},Y,this)}))},$.addQuickComment=function(_){return kr(this,void 0,void 0,rr.mark(function Y(){return rr.wrap(function(V){for(;;)switch(V.prev=V.next){case 0:return V.next=2,this.extendModuleService.updateQuickComment(_,1);case 2:case"end":return V.stop()}},Y,this)}))},$.removeQuickComment=function(_){return kr(this,void 0,void 0,rr.mark(function Y(){return rr.wrap(function(V){for(;;)switch(V.prev=V.next){case 0:return V.next=2,this.extendModuleService.updateQuickComment(_,2);case 2:case"end":return V.stop()}},Y,this)}))},$.getQuickComments=function(_){return kr(this,void 0,void 0,rr.mark(function Y(){return rr.wrap(function(V){for(;;)switch(V.prev=V.next){case 0:return zr({serverId:{type:"string",allowEmpty:!1},channelId:{type:"string",allowEmpty:!1},msgList:{type:"array",rules:{msgIdServer:{type:"string",allowEmpty:!1}},min:1}},_),V.next=3,this.extendModuleService.getQuickComments(_);case 3:return V.abrupt("return",V.sent);case 4:case"end":return V.stop()}},Y,this)}))},$.sendTypingEvent=function(_){return kr(this,void 0,void 0,rr.mark(function Y(){return rr.wrap(function(V){for(;;)switch(V.prev=V.next){case 0:return zr({serverId:{type:"string",allowEmpty:!1},channelId:{type:"string",allowEmpty:!1},ext:{type:"string",required:!1}},_),V.next=3,this.extendModuleService.sendTypingEvent(_);case 3:return V.abrupt("return",V.sent);case 4:case"end":return V.stop()}},Y,this)}))},$.getLastMessageOfChannels=function(_){return kr(this,void 0,void 0,rr.mark(function Y(){return rr.wrap(function(V){for(;;)switch(V.prev=V.next){case 0:return zr({serverId:{type:"string",allowEmpty:!1},channelIdList:{type:"array",itemType:"string"}},_),V.next=3,this.messageModuleService.getLastMessageOfChannels(_);case 3:return V.abrupt("return",V.sent);case 4:case"end":return V.stop()}},Y,this)}))},$.qchatOnMsgHandler=function(_){return kr(this,void 0,void 0,rr.mark(function Y(){return rr.wrap(function(V){for(;;)switch(V.prev=V.next){case 0:this.messageModuleService.onMsg(_);case 1:case"end":return V.stop()}},Y,this)}))},$.qchatOnRecvUnreadInfoHandler=function(_){return kr(this,void 0,void 0,rr.mark(function Y(){return rr.wrap(function(V){for(;;)switch(V.prev=V.next){case 0:this.messageModuleService.onRecvUnreadInfo(_);case 1:case"end":return V.stop()}},Y,this)}))},$.qchatOnSysMsgHandler=function(_){this.notificationModuleService.onSysMsg(_)},$.qchatMultiSyncMessageReadHandler=function(_){this.messageModuleService.onMultiSyncRead(_)},$.qchatMultiSyncSystemNotificationUpdateHandler=function(_){this.notificationModuleService.onMultiSysMsg(_)},$.qchatSyncSystemNotificationHandler=function(_){this.notificationModuleService.onSyncSysMsg(_)},$.qchatRecvMessageUpdateHandler=function(_){return kr(this,void 0,void 0,rr.mark(function Y(){return rr.wrap(function(V){for(;;)switch(V.prev=V.next){case 0:this.messageModuleService.onRecvMsgUpdate(_);case 1:case"end":return V.stop()}},Y,this)}))},$.searchMsgByPage=function(_){return kr(this,void 0,void 0,rr.mark(function Y(){return rr.wrap(function(V){for(;;)switch(V.prev=V.next){case 0:return zr({keyword:{type:"string",allowEmpty:!1,required:!1},serverId:{type:"string",allowEmpty:!1,required:!0},channelId:{type:"string",allowEmpty:!1,required:!1},fromAccid:{type:"string",allowEmpty:!1,required:!1},fromTime:{type:"number",allowEmpty:!1,required:!1},toTime:{type:"number",allowEmpty:!1,required:!1},msgTypes:{type:"array",itemType:"string",allowEmpty:!1,required:!0},subTypes:{type:"array",itemType:"string",allowEmpty:!1,required:!1},includeSelf:{type:"boolean",allowEmpty:!1,required:!1},order:{type:"enum",values:ri(Ac),required:!1},limit:{type:"number",min:0,required:!1},sort:{type:"enum",values:ri(tf),required:!1},cursor:{type:"string",allowEmpty:!1,required:!1}},_),V.next=3,this.messageModuleService.messageSearchByPage(_);case 3:return V.abrupt("return",V.sent);case 4:case"end":return V.stop()}},Y,this)}))},$.qchatMultiSyncServersMessageReadHandler=function(_){this.messageModuleService.onMultiSyncServersRead(_)},w}(vu);function Hh(b,w){w===void 0&&(w=1);var $=pi({clientPort:{type:"number"},clientType:{type:"enum",values:mc},customClientType:{type:"number"},loginTime:{type:"number"},hasTokenPreviously:{type:"boolean"},pushType:{type:"number"}},b);return Xr(Xr({},$),{account:$.account,connectionId:$.connectionId,deviceId:$.deviceId,ip:$.ip,mac:$.ip,os:$.os,clientType:$.clientType,time:$.time,online:w!==2})}var Qv={1:{reason:"samePlatformKick",message:"The same account is not allowed to multiple login at the same time"},2:{reason:"serverKick",message:"Kicked out by IM server"},3:{reason:"otherPlatformKick",message:"Kicked out by other client of your account"},4:{reason:"silentlyKick",message:"Quietly kicked"}},Vh,Cs,fi={BROWSER:0,RN:2,UNIAPP:3,WECHAT:6},gM=function(b){function w(A){var _;return(_=b.call(this,"qchatAuth",A)||this).syncTimeTag=0,_}Co(w,b);var $=w.prototype;return $.doLogin=function(_){var Y;return _===void 0&&(_=!1),kr(this,void 0,void 0,rr.mark(function de(){var V,Fe,Et,sr,fr,Sr,Tr;return rr.wrap(function(Lr){for(;;)switch(Lr.prev=Lr.next){case 0:return V=this.core.options,Fe=Ko.getSystemInfo(),Et=Xr(Xr({},V),{appLogin:_?0:1,clientType:16,clientSession:(Y=this.core.socket)===null||Y===void 0?void 0:Y.sessionId,deviceId:this.core.config.deviceId,sdkVersion:91001,sdkType:fi[Ko.platform]||0,userAgent:"Native/0.13.1",sdkHumanVersion:"0.13.1",os:Fe.os,browser:Fe.browser}),Lr.next=5,this.core.sendCmd("qchatLogin",{qchatLoginReqTag:Et});case 5:if(!(sr=Lr.sent).error){Lr.next=8;break}throw sr.error;case 8:return fr=sr.content,Sr=fr.qchatLoginResTag,Tr=fr.qchatMultiLoginResult,Sr.isAutoReconnect=_,Lr.abrupt("return",{loginResult:Hh(Sr),multiLoginResults:co(Tr).call(Tr,function(jr){return Hh(jr)})});case 11:case"end":return Lr.stop()}},de,this)}))},$.kick=function(_){var Y;return kr(this,void 0,void 0,rr.mark(function de(){var V;return rr.wrap(function(Et){for(;;)switch(Et.prev=Et.next){case 0:return Et.next=2,this.core.sendCmd("qchatKick",_);case 2:return V=Et.sent,Et.abrupt("return",(Y=V.content)===null||Y===void 0?void 0:Y.deviceIds);case 4:case"end":return Et.stop()}},de,this)}))},$.sync=function(){return kr(this,void 0,void 0,rr.mark(function _(){return rr.wrap(function(de){for(;;)switch(de.prev=de.next){case 0:return de.next=2,this.core.sendCmd("qchatSync",{qchatSyncTag:{systemNotification:this.syncTimeTag||0}});case 2:case"end":return de.stop()}},_,this)}))},$.qchatSyncHandler=function(_){var Y,de;this.logger.log("sync: emit syncdone",(Y=_.content)===null||Y===void 0?void 0:Y.timetag),this.core.emit("syncdone"),this.syncTimeTag=((de=_.content)===null||de===void 0?void 0:de.timetag)||0},$.qchatMultiSpotLoginHandler=function(_){if(_.error)this.logger.error("qchatMultiPortLoginHandler:: error, ",_.error);else{var Y=_.content,de=Hh(Y.qchatLoginResTag,Y.state);this.core.emit("multiSpotLogin",[de])}},$.qchatBeKickedHandler=function(_){if(_.error)this.logger.error("qchatBeKickedHandler error, ",_.error);else{var Y=function(V){var Fe=pi({clientType:{type:"enum",values:mc},customClientType:{type:"number"}},V),Et=Qv[Fe.reason];return Xr(Fe,Et=Et||{reason:"unknow",message:"Unknown reason"})}(_.content.beKickedTag);this.logger.warn("bekicked::",Y),this.core.doDisconnect(cs.KICKED,Y)}},w}(vu);(function(b){b.UNKNOWN="UNKNOWN",b.LOGIN_STATE_ERROR="LOGIN_STATE_ERROR",b.CLOSE_BY_BACKEND="CLOSE_BY_BACKEND",b.ALL_MEMBERS_OUT="ALL_MEMBERS_OUT",b.END_OF_LIFE="END_OF_LIFE",b.CLOSE_BY_MEMBER="CLOSE_BY_MEMBER",b.KICK_OUT="KICK_OUT",b.SYNC_DATA_ERROR="SYNC_DATA_ERROR",b.LEAVE_BY_SELF="LEAVE_BY_SELF",b.kICK_BY_SELF="kICK_BY_SELF"})(Vh||(Vh={})),function(b){b.offNotAllowSelfOn="offNotAllowSelfOn",b.offAllowSelfOn="offAllowSelfOn",b.disable="disable"}(Cs||(Cs={}));var jc={serverId:{type:"string"},uid:{type:"string"},accid:{type:"string"},nick:{type:"string"},avatar:{type:"string"},ext:{type:"string"},type:{type:"number"},joinTime:{type:"number"},inviter:{type:"string"},validFlag:{type:"boolean"},createTime:{type:"number"},updateTime:{type:"number"}},gc={limit:{type:"number"}};function hc(b){return rs(b)&&b.length>0?co(b).call(b,function(w){return function(A){return pi(jc,A)}(w)}):[]}function hM(b){try{b.audio&&(b.audio=JSON.parse(b.audio))}catch{throw new cu('result "audio" JSON parse error',{key:"audio"},"JSON parse error")}try{b.video&&(b.video=JSON.parse(b.video))}catch{throw new cu('result "video" JSON parse error',{key:"video"},"JSON parse error")}return pi(gc,b)}var Gd={"25_1":"qchatGetNeroomToken","25_2":"qchatUpdateRTCChannelConfig","25_3":"qchatGetRTCChannelConfig","25_4":"qchatGetRTCChannelMembers"},Kd={QChatRTCChannelConfigTag:{serverId:1,channelId:2,limit:3,audio:4,video:5},QChatRTCChannelConfigResultTag:{limit:1,audio:2,video:3},QChatGetRTCParams:{serverId:1,channelId:2},qchatGetRTCChannelMembersTag:{serverId:1,channelId:2},memberInfo:{serverId:1,accid:3,nick:4,avatar:5,ext:6,type:7,joinTime:8,inviter:9,validFlag:10,createTime:11,updateTime:12},QChatGetNeroomTokenResultTag:{token:1,expire:2},QChatGetNeroomTokenParams:{neroomDeviceId:1}},cf=xc(Kd),Qd={qchatGetNeroomToken:{sid:25,cid:1,service:"qchatMedia",params:[{type:"Property",name:"qchatGetNeroomTokenTag",reflectMapper:Kd.QChatGetNeroomTokenParams}],response:[{type:"Property",name:"neroomToken",reflectMapper:cf.QChatGetNeroomTokenResultTag}]},qchatUpdateRTCChannelConfig:{sid:25,cid:2,service:"qchatMedia",params:[{type:"Property",name:"RTCChannelConfig",reflectMapper:Kd.QChatRTCChannelConfigTag}]},qchatGetRTCChannelConfig:{sid:25,cid:3,service:"qchatMedia",params:[{type:"Property",name:"qchatGetRTCChannelConfigTag",reflectMapper:Kd.QChatGetRTCParams}],response:[{type:"Property",name:"RTCChannelConfig",reflectMapper:cf.QChatRTCChannelConfigResultTag}]},qchatGetRTCChannelMembers:{sid:25,cid:4,service:"qchatMedia",params:[{type:"Property",name:"qchatGetRTCChannelMembersTag",reflectMapper:Kd.QChatGetRTCParams}],response:[{type:"PropertyArray",name:"memberList",reflectMapper:cf.memberInfo}]}},yM=function(b){function w(A){var _;return(_=b.call(this,"qchatMedia",A)||this).tokenExpireTime=24e4,_.getTokenState=!1,_.core=A,Oa({cmdMap:Gd,cmdConfig:Qd}),_.core.on("disconnect",function(){return kr(a(_),void 0,void 0,rr.mark(function Y(){return rr.wrap(function(V){for(;;)switch(V.prev=V.next){case 0:if(!this.roomContext){V.next=3;break}return V.next=3,this.disconnectChannel();case 3:this.tokenTimer&&(this.core.timerManager.deleteTimer(this.tokenTimer),this.tokenTimer=void 0);case 4:case"end":return V.stop()}},Y,this)}))}),_.core.on("kicked",function(){return kr(a(_),void 0,void 0,rr.mark(function Y(){return rr.wrap(function(V){for(;;)switch(V.prev=V.next){case 0:if(!this.roomContext){V.next=3;break}return V.next=3,this.disconnectChannel();case 3:this.tokenTimer&&(this.core.timerManager.deleteTimer(this.tokenTimer),this.tokenTimer=void 0);case 4:case"end":return V.stop()}},Y,this)}))}),_.core.eventBus.on("qchatMedia/serverOrChannelLeave",function(Y){return kr(a(_),void 0,void 0,rr.mark(function de(){return rr.wrap(function(Fe){for(;;)switch(Fe.prev=Fe.next){case 0:if(!(Y.type===zo[zo.channelVisibilityUpdate]&&Y.channelId===this.channelId||Y.type===zo[zo.serverEnterLeave]&&Y.serverId===this.serverId)){Fe.next=4;break}if(!this.roomContext||!this.roomContext.roomUuid){Fe.next=4;break}return Fe.next=4,this.disconnectChannel();case 4:case"end":return Fe.stop()}},de,this)}))}),_.tokenExpireTime=24e4,_.channelId="",_.serverId="",_}Co(w,b);var $=w.prototype;return $.setNeroom=function(_){this.neroom=new _},$._checkPermission=function(_){return kr(this,void 0,void 0,rr.mark(function Y(){var de;return rr.wrap(function(Fe){for(;;)switch(Fe.prev=Fe.next){case 0:return Fe.next=2,this.core.qchatRole.checkPermission(_);case 2:return de=Fe.sent,Fe.abrupt("return",de);case 4:case"end":return Fe.stop()}},Y,this)}))},$._checkConnectState=function(){if(this.state!=="connect")throw new uo("QChatMedia::you should connect first")},$.kickMemberOut=function(_){var Y;return kr(this,void 0,void 0,rr.mark(function de(){return rr.wrap(function(Fe){for(;;)switch(Fe.prev=Fe.next){case 0:return this._checkConnectState(),zr({accid:{type:"string",allowEmpty:!1}},_),Fe.prev=2,Fe.next=5,(Y=this.roomContext)===null||Y===void 0?void 0:Y.kickMemberOut(_.accid);case 5:Fe.next=11;break;case 7:throw Fe.prev=7,Fe.t0=Fe.catch(2),this.logger.error("QChatMedia::kickMemberOut error params is "+so(_),Fe.t0),new uo("QChatMedia::kickMemberOut error",Fe.t0);case 11:case"end":return Fe.stop()}},de,this,[[2,7]])}))},$.disconnectChannel=function(){var _;return kr(this,void 0,void 0,rr.mark(function Y(){return rr.wrap(function(V){for(;;)switch(V.prev=V.next){case 0:return this._checkConnectState(),this.logger.debug("QChatMedia::disconnect begin disconnect"),V.prev=2,V.next=5,(_=this.roomContext)===null||_===void 0?void 0:_.leaveRoom();case 5:V.next=10;break;case 7:V.prev=7,V.t0=V.catch(2),this.logger.error("QChatMedia::disconnect error",V.t0);case 10:if(!this.authService){V.next=13;break}return V.next=13,this.authService.logout();case 13:this._setStateInit(),this.core.emit("qchatMediaDisconnect");case 15:case"end":return V.stop()}},Y,this,[[2,7]])}))},$._setStateInit=function(){this.logger.debug("QChatMedia::disconnect end"),this.roomContext=void 0,this.rtcController=void 0,this.state="init",this.tokenTimer&&(this.core.timerManager.deleteTimer(this.tokenTimer),this.tokenTimer=void 0),this.channelId="",this.serverId=""},$.muteAudio=function(_){var Y,de,V,Fe,Et;return kr(this,void 0,void 0,rr.mark(function sr(){var fr;return rr.wrap(function(Tr){for(;;)switch(Tr.prev=Tr.next){case 0:if(this._checkConnectState(),zr({accid:{type:"string",allowEmpty:!1}},_),((Y=this.roomContext)===null||Y===void 0?void 0:Y.localMember.uuid)!==_.accid){Tr.next=14;break}return Tr.prev=3,Tr.next=6,(de=this.rtcController)===null||de===void 0?void 0:de.muteMyAudio();case 6:Tr.next=12;break;case 8:throw Tr.prev=8,Tr.t0=Tr.catch(3),this.logger.error("QChatMedia::muteAudio error",Tr.t0),new uo("QChatMedia::muteAudio error",Tr.t0);case 12:case 25:Tr.next=31;break;case 14:if(Tr.prev=14,!(fr=(V=this.roomContext)===null||V===void 0?void 0:V.roomProperties.audioOff)||((Fe=fr.value)===null||Fe===void 0?void 0:Fe.split("_")[0])!==Cs.offNotAllowSelfOn){Tr.next=23;break}return Tr.next=19,this._checkPermission({serverId:this.serverId,channelId:this.channelId,auth:"RTCChannelOpenCloseEveryoneMicrophone"});case 19:if(Tr.sent){Tr.next=23;break}return this.logger.error("QChatMedia::unMuteAudio not allow open auido"),Tr.abrupt("return");case 23:return Tr.next=25,(Et=this.rtcController)===null||Et===void 0?void 0:Et.muteMemberAudio(_.accid);case 27:throw Tr.prev=27,Tr.t1=Tr.catch(14),this.logger.error("QChatMedia::muteAudio error params is "+so(_),Tr.t1),new uo("QChatMedia::muteAudio error",Tr.t1);case 31:case"end":return Tr.stop()}},sr,this,[[3,8],[14,27]])}))},$.unMuteAudio=function(_){var Y,de,V,Fe,Et;return kr(this,void 0,void 0,rr.mark(function sr(){var fr;return rr.wrap(function(Tr){for(;;)switch(Tr.prev=Tr.next){case 0:if(this._checkConnectState(),zr({accid:{type:"string",allowEmpty:!1}},_),!(fr=(Y=this.roomContext)===null||Y===void 0?void 0:Y.roomProperties.audioOff)||((de=fr.value)===null||de===void 0?void 0:de.split("_")[0])!==Cs.offNotAllowSelfOn){Tr.next=10;break}return Tr.next=6,this._checkPermission({serverId:this.serverId,channelId:this.channelId,auth:"RTCChannelOpenCloseEveryoneMicrophone"});case 6:if(Tr.sent){Tr.next=10;break}return this.logger.error("QChatMedia::unMuteAudio not allow open auido"),Tr.abrupt("return");case 10:if(((V=this.roomContext)===null||V===void 0?void 0:V.localMember.uuid)!==_.accid){Tr.next=22;break}return Tr.prev=11,Tr.next=14,(Fe=this.rtcController)===null||Fe===void 0?void 0:Fe.unmuteMyAudio();case 14:Tr.next=20;break;case 16:throw Tr.prev=16,Tr.t0=Tr.catch(11),this.logger.error("QChatMedia::unMuteAudio error",Tr.t0),new uo("QChatMedia::unMuteAudio error",Tr.t0);case 20:case 25:Tr.next=31;break;case 22:return Tr.prev=22,Tr.next=25,(Et=this.rtcController)===null||Et===void 0?void 0:Et.unmuteMemberAudio(_.accid);case 27:throw Tr.prev=27,Tr.t1=Tr.catch(22),this.logger.error("QChatMedia::unMuteAudio error params is "+so(_),Tr.t1),new uo("QChatMedia::unMuteAudio error",Tr.t1);case 31:case"end":return Tr.stop()}},sr,this,[[11,16],[22,27]])}))},$.muteVideo=function(_){var Y,de,V,Fe,Et;return kr(this,void 0,void 0,rr.mark(function sr(){var fr;return rr.wrap(function(Tr){for(;;)switch(Tr.prev=Tr.next){case 0:if(this._checkConnectState(),zr({accid:{type:"string",allowEmpty:!1}},_),((Y=this.roomContext)===null||Y===void 0?void 0:Y.localMember.uuid)!==_.accid){Tr.next=14;break}return Tr.prev=3,Tr.next=6,(de=this.rtcController)===null||de===void 0?void 0:de.muteMyVideo();case 6:Tr.next=12;break;case 8:throw Tr.prev=8,Tr.t0=Tr.catch(3),this.logger.error("QChatMedia::muteVideo error",Tr.t0),new uo("QChatMedia::muteVideo error",Tr.t0);case 12:case 25:Tr.next=31;break;case 14:if(Tr.prev=14,!(fr=(V=this.roomContext)===null||V===void 0?void 0:V.roomProperties.videoOff)||((Fe=fr.value)===null||Fe===void 0?void 0:Fe.split("_")[0])!==Cs.offNotAllowSelfOn){Tr.next=23;break}return Tr.next=19,this._checkPermission({serverId:this.serverId,channelId:this.channelId,auth:"RTCChannelOpenCloseEveryoneCamera"});case 19:if(Tr.sent){Tr.next=23;break}return this.logger.error("QChatMedia::unMuteVideo not allow open video"),Tr.abrupt("return");case 23:return Tr.next=25,(Et=this.rtcController)===null||Et===void 0?void 0:Et.muteMemberVideo(_.accid);case 27:throw Tr.prev=27,Tr.t1=Tr.catch(14),this.logger.error("QChatMedia::muteVideo error params is "+so(_),Tr.t1),new uo("QChatMedia::muteVideo error",Tr.t1);case 31:case"end":return Tr.stop()}},sr,this,[[3,8],[14,27]])}))},$.unMuteVideo=function(_){var Y,de,V,Fe,Et;return kr(this,void 0,void 0,rr.mark(function sr(){var fr;return rr.wrap(function(Tr){for(;;)switch(Tr.prev=Tr.next){case 0:if(this._checkConnectState(),zr({accid:{type:"string",allowEmpty:!1}},_),!(fr=(Y=this.roomContext)===null||Y===void 0?void 0:Y.roomProperties.videoOff)||((de=fr.value)===null||de===void 0?void 0:de.split("_")[0])!==Cs.offNotAllowSelfOn){Tr.next=10;break}return Tr.next=6,this._checkPermission({serverId:this.serverId,channelId:this.channelId,auth:"RTCChannelOpenCloseEveryoneCamera"});case 6:if(Tr.sent){Tr.next=10;break}return this.logger.error("QChatMedia::unMuteVideo not allow open video"),Tr.abrupt("return");case 10:if(((V=this.roomContext)===null||V===void 0?void 0:V.localMember.uuid)!==_.accid){Tr.next=22;break}return Tr.prev=11,Tr.next=14,(Fe=this.rtcController)===null||Fe===void 0?void 0:Fe.unmuteMyVideo();case 14:Tr.next=20;break;case 16:throw Tr.prev=16,Tr.t0=Tr.catch(11),this.logger.error("QChatMedia::unMuteVideo error",Tr.t0),new uo("QChatMedia::unMuteVideo error",Tr.t0);case 20:Tr.next=30;break;case 22:Tr.prev=22,(Et=this.rtcController)===null||Et===void 0||Et.unmuteMemberVideo(_.accid),Tr.next=30;break;case 26:throw Tr.prev=26,Tr.t1=Tr.catch(22),this.logger.error("QChatMedia::unMuteVideo error",Tr.t1),new uo("QChatMedia::unMuteVideo error",Tr.t1);case 30:case"end":return Tr.stop()}},sr,this,[[11,16],[22,26]])}))},$.startScreenShare=function(){var _;return kr(this,void 0,void 0,rr.mark(function Y(){return rr.wrap(function(V){for(;;)switch(V.prev=V.next){case 0:this._checkConnectState(),V.prev=1,(_=this.rtcController)===null||_===void 0||_.startScreenShare(),V.next=9;break;case 5:throw V.prev=5,V.t0=V.catch(1),this.logger.error("QChatMedia::startScreenShare error",V.t0),new uo("QChatMedia::startScreenShare error",V.t0);case 9:case"end":return V.stop()}},Y,this,[[1,5]])}))},$.stopScreenShare=function(){var _;return kr(this,void 0,void 0,rr.mark(function Y(){return rr.wrap(function(V){for(;;)switch(V.prev=V.next){case 0:this._checkConnectState(),V.prev=1,(_=this.rtcController)===null||_===void 0||_.stopScreenShare(),V.next=9;break;case 5:throw V.prev=5,V.t0=V.catch(1),this.logger.error("QChatMedia::stopScreenShare error",V.t0),new uo("QChatMedia::stopScreenShare error",V.t0);case 9:case"end":return V.stop()}},Y,this,[[1,5]])}))},$.stopMemberScreenShare=function(_){var Y;return kr(this,void 0,void 0,rr.mark(function de(){return rr.wrap(function(Fe){for(;;)switch(Fe.prev=Fe.next){case 0:this._checkConnectState(),zr({accid:{type:"string",allowEmpty:!1}},_),Fe.prev=2,(Y=this.rtcController)===null||Y===void 0||Y.stopMemberScreenShare(_.accid),Fe.next=10;break;case 6:throw Fe.prev=6,Fe.t0=Fe.catch(2),this.logger.error("QChatMedia::stopMemberScreenShare error",Fe.t0),new uo("QChatMedia::stopMemberScreenShare error",Fe.t0);case 10:case"end":return Fe.stop()}},de,this,[[2,6]])}))},$.subscribeRemoteVideoStream=function(_){var Y;return kr(this,void 0,void 0,rr.mark(function de(){return rr.wrap(function(Fe){for(;;)switch(Fe.prev=Fe.next){case 0:this._checkConnectState(),zr({accid:{type:"string",allowEmpty:!1},streamType:{type:"number",allowEmpty:!1,min:0,max:1}},_),Fe.prev=2,(Y=this.rtcController)===null||Y===void 0||Y.subscribeRemoteVideoStream(_.accid,_.streamType),Fe.next=10;break;case 6:throw Fe.prev=6,Fe.t0=Fe.catch(2),this.logger.error("QChatMedia::subscribeRemoteVideoStream error",Fe.t0),new uo("QChatMedia::subscribeRemoteVideoStream error",Fe.t0);case 10:case"end":return Fe.stop()}},de,this,[[2,6]])}))},$.unSubscribeRemoteVideoStream=function(_){var Y;return kr(this,void 0,void 0,rr.mark(function de(){return rr.wrap(function(Fe){for(;;)switch(Fe.prev=Fe.next){case 0:this._checkConnectState(),zr({accid:{type:"string",allowEmpty:!1},streamType:{type:"number",allowEmpty:!1,min:0,max:1}},_),Fe.prev=2,(Y=this.rtcController)===null||Y===void 0||Y.unsubscribeRemoteVideoStream(_.accid,_.streamType),Fe.next=10;break;case 6:throw Fe.prev=6,Fe.t0=Fe.catch(2),this.logger.error("QChatMedia::unSubscribeRemoteVideoStream error",Fe.t0),new uo("QChatMedia::unSubscribeRemoteVideoStream error",Fe.t0);case 10:case"end":return Fe.stop()}},de,this,[[2,6]])}))},$.setupVideoCanvas=function(_){var Y;if(this._checkConnectState(),((Y=this.roomContext)===null||Y===void 0?void 0:Y.localMember.uuid)===_.accid)try{return this.rtcController.setupLocalVideoCanvas(_.videoView)}catch(de){throw this.logger.error("QChatMedia::setupVideoCanvas error",de),new uo("QChatMedia::setupVideoCanvas error",de)}else try{return this.rtcController.setupRemoteVideoCanvas(_.videoView,_.accid)}catch(de){throw this.logger.error("QChatMedia::setupVideoCanvas error",de),new uo("QChatMedia::setupVideoCanvas error",de)}},$.setupRemoteVideoSubStreamCanvas=function(_){this._checkConnectState(),zr({accid:{type:"string",allowEmpty:!1}},_);try{return this.rtcController.setupRemoteVideoSubStreamCanvas(_.videoView,_.accid)}catch(Y){throw this.logger.error("QChatMedia::setupRemoteVideoSubStreamCanvas error",Y),new uo("QChatMedia::setupRemoteVideoSubStreamCanvas error",Y)}},$.getScreenSharingUserUuid=function(){this._checkConnectState();try{return this.rtcController.getScreenSharingUserUuid()}catch(_){throw this.logger.error("QChatMedia::getScreenSharingUserUuid error",_),new uo("QChatMedia::getScreenSharingUserUuid error",_)}},$.initQChatMedia=function(_){return kr(this,void 0,void 0,rr.mark(function Y(){return rr.wrap(function(V){for(;;)switch(V.prev=V.next){case 0:if(this.neroom){V.next=3;break}return this.logger.warn("QChatMedia::init::you should import neroom SDK"),V.abrupt("return");case 3:if(this.state===void 0){V.next=6;break}return this.logger.error("QChatMedia::init::you already init QChatMedia"),V.abrupt("return");case 6:V.prev=6,this.neroom.initialize({appKey:this.core.options.appkey,serverConfig:_.serverConfig}),V.next=14;break;case 10:throw V.prev=10,V.t0=V.catch(6),this.logger.error("QChatMedia::initQChatMedia error",V.t0),new uo("QChatMedia::initQChatMedia error",V.t0);case 14:this.authService=this.neroom.authService,this.roomService=this.neroom.roomService,this.messageChannelService=this.neroom.messageChannelService,this.state="init";case 18:case"end":return V.stop()}},Y,this,[[6,10]])}))},$.loginByIM=function(){var _;return kr(this,void 0,void 0,rr.mark(function Y(){var de,V;return rr.wrap(function(Et){for(;;)switch(Et.prev=Et.next){case 0:if(this.state==="init"){Et.next=3;break}return this.logger.error("QChatMedia::connect::you should init before login"),Et.abrupt("return");case 3:return de=this.core.options,Et.next=6,this._getToken();case 6:return V=Et.sent,Et.prev=7,Et.next=10,(_=this.authService)===null||_===void 0?void 0:_.loginByIM(de.account,V,de.token);case 10:Et.next=16;break;case 12:throw Et.prev=12,Et.t0=Et.catch(7),this.logger.error("QChatMedia::loginByIM error",Et.t0),new uo("QChatMedia::loginByIM error",Et.t0);case 16:this.state="login";case 17:case"end":return Et.stop()}},Y,this,[[7,12]])}))},$._getToken=function(){var _;return kr(this,void 0,void 0,rr.mark(function Y(){var de,V,Fe,Et,sr=this;return rr.wrap(function(Sr){for(;;)switch(Sr.prev=Sr.next){case 0:return this.logger.log("QChatMedia::getToken begin getToken"),Sr.next=3,this.core.sendCmd("qchatGetNeroomToken",{qchatGetNeroomTokenTag:{neroomDeviceId:(_=this.neroom)===null||_===void 0?void 0:_.deviceId}});case 3:return de=Sr.sent,V=de.content.neroomToken,Fe=V.token,Et=V.expire,this.logger.log("QChatMedia::getToken success token is "+Fe+",expire is "+Et+" "),this.tokenTimer||(this.logger.debug("QChatMedia::getToken set token timer,expire is "+(1e3*Et-this.tokenExpireTime)+" "),this.tokenTimer=this.core.timerManager.addTimer(function(){return kr(sr,void 0,void 0,rr.mark(function Tr(){var Pr;return rr.wrap(function(jr){for(;;)switch(jr.prev=jr.next){case 0:return this.tokenTimer&&this.core.timerManager.deleteTimer(this.tokenTimer),this.tokenTimer=void 0,jr.next=4,this._getToken();case 4:Pr=jr.sent,this.authService&&this.authService.renewToken(Pr);case 6:case"end":return jr.stop()}},Tr,this)}))},1e3*Et-this.tokenExpireTime)),Sr.abrupt("return",Fe);case 8:case"end":return Sr.stop()}},Y,this)}))},$.connectChannel=function(_){var Y,de;return kr(this,void 0,void 0,rr.mark(function V(){var Fe;return rr.wrap(function(sr){for(;;)switch(sr.prev=sr.next){case 0:if(this.state!==void 0){sr.next=3;break}return this.logger.error("QChatMedia::connect::you should init before login"),sr.abrupt("return");case 3:if(this.state!=="init"){sr.next=6;break}return sr.next=6,this.loginByIM();case 6:return this.serverId=_.serverId,this.channelId=_.channelId,sr.prev=8,sr.next=11,(Y=this.roomService)===null||Y===void 0?void 0:Y.joinRoom({roomUuid:_.channelId,role:"qchatAudience",userName:this.core.options.account,initialProperties:{}},{});case 11:sr.next=17;break;case 13:throw sr.prev=13,sr.t0=sr.catch(8),this.logger.error("QChatMedia::connectChannel error",sr.t0),new uo("QChatMedia::connectChannel error",sr.t0);case 17:if(!(Fe=(de=this.roomService)===null||de===void 0?void 0:de.getRoomContext(_.channelId))){sr.next=27;break}return this.roomContext=Fe,this.rtcController=this.roomContext.rtcController,this.state="connect",sr.next=24,this.rtcController.joinRtcChannel();case 24:this.core.emit("connectChannel"),sr.next=28;break;case 27:this.logger.error("QChatMedia::connect room not exited");case 28:case"end":return sr.stop()}},V,this,[[8,13]])}))},$.updateRTCChannelInfo=function(_){return kr(this,void 0,void 0,rr.mark(function Y(){return rr.wrap(function(V){for(;;)switch(V.prev=V.next){case 0:return zr({serverId:{type:"string",allowEmpty:!1},channelId:{type:"string",allowEmpty:!1},limit:{type:"number",allowEmpty:!1}},_),V.next=3,this.core.sendCmd("qchatUpdateRTCChannelConfig",{RTCChannelConfig:Xr(Xr({},_),{audio:so(_.audio),video:so(_.video)})});case 3:case"end":return V.stop()}},Y,this)}))},$.getRTCChannelInfo=function(_){return kr(this,void 0,void 0,rr.mark(function Y(){var de;return rr.wrap(function(Fe){for(;;)switch(Fe.prev=Fe.next){case 0:return zr({serverId:{type:"string",allowEmpty:!1},channelId:{type:"string",allowEmpty:!1}},_),Fe.next=3,this.core.sendCmd("qchatGetRTCChannelConfig",{qchatGetRTCChannelConfigTag:_});case 3:return de=Fe.sent,Fe.abrupt("return",hM(de.content.RTCChannelConfig));case 5:case"end":return Fe.stop()}},Y,this)}))},$.getRTCChannelOnlineMembers=function(_){return kr(this,void 0,void 0,rr.mark(function Y(){var de;return rr.wrap(function(Fe){for(;;)switch(Fe.prev=Fe.next){case 0:return zr({serverId:{type:"string",allowEmpty:!1},channelId:{type:"string",allowEmpty:!1}},_),Fe.next=3,this.core.sendCmd("qchatGetRTCChannelMembers",{qchatGetRTCChannelMembersTag:_});case 3:return de=Fe.sent,Fe.abrupt("return",hc(de.content.memberList));case 5:case"end":return Fe.stop()}},Y,this)}))},$.addRTCChannelListener=function(){var _,Y,de=this;this._checkConnectState();try{(_=this.authService)===null||_===void 0||_.addAuthListener({onAuthEvent:function(Fe){return kr(de,void 0,void 0,rr.mark(function Et(){var sr;return rr.wrap(function(Sr){for(;;)switch(Sr.prev=Sr.next){case 0:if(Fe!==1026||this.getTokenState){Sr.next=10;break}return this.logger.log("QChatMedia::loginByIM token expire,begin get new token "),this.getTokenState=!0,Sr.next=5,this._getToken();case 5:if(sr=Sr.sent,!this.authService){Sr.next=9;break}return Sr.next=9,this.authService.renewToken(sr);case 9:this.getTokenState=!1;case 10:case"end":return Sr.stop()}},Et,this)}))}})}catch(V){throw this.getTokenState=!1,this.logger.error("QChatMedia::loginByIM addAuthListener error",V),new uo("QChatMedia::loginByIM addAuthListener error",V)}(Y=this.roomContext)===null||Y===void 0||Y.addRoomListener({onRoomPropertiesChanged:function(Fe){var Et,sr,fr,Sr,Tr,Pr;if(de.logger.log("QChatMedia::addRTCChannelListener::onRoomPropertiesChanged",Fe),Fe.audioOff){var Lr=(Et=Fe.audioOff.value)===null||Et===void 0?void 0:Et.split("_")[0];Lr!==Cs.offNotAllowSelfOn&&Lr!==Cs.offAllowSelfOn||!((sr=de.roomContext)===null||sr===void 0)&&sr.localMember.isAudioOn&&((fr=de.rtcController)===null||fr===void 0||fr.muteMyAudio())}else if(Fe.videoOff){var jr=(Sr=Fe.videoOff.value)===null||Sr===void 0?void 0:Sr.split("_")[0];jr!==Cs.offNotAllowSelfOn&&jr!==Cs.offAllowSelfOn||!((Tr=de.roomContext)===null||Tr===void 0)&&Tr.localMember.isVideoOn&&((Pr=de.rtcController)===null||Pr===void 0||Pr.muteMyVideo())}},onRoomPropertiesDeleted:function(Fe){de.logger.log("QChatMedia::addRTCChannelListener::onRoomPropertiesDeleted",Fe)},onMemberJoinRtcChannel:function(Fe){de.logger.log("QChatMedia::addRTCChannelListener::onMemberJoinRTCChannel",Fe);var Et=co(Fe).call(Fe,function(sr){return sr.uuid});de.core.emit("memberJoinRTCChannel",Et)},onMemberLeaveRoom:function(Fe){de.logger.log("QChatMedia::addRTCChannelListener::onMemberLeaveRoom",Fe);var Et=co(Fe).call(Fe,function(sr){return sr.uuid});de.core.emit("memberLeaveRTCChannel",Et)},onRoomEnded:function(Fe){de.authService&&de.authService.logout(),de._setStateInit(),de.logger.log("QChatMedia::addRTCChannelListener::onRoomEnded",Fe),de.core.emit("RTCChannelEnded",Fe)},onRtcChannelError:function(Fe){de.logger.log("QChatMedia::addRTCChannelListener::onRtcChannelError",Fe),Fe==="SOCKET_ERROR"&&de.disconnectChannel(),de.core.emit("RTCChannelError",Fe)},onRtcAudioVolumeIndication:function(Fe){de.logger.log("QChatMedia::addRTCChannelListener::onRtcAudioVolumeIndication",Fe),de.core.emit("onRtcAudioVolumeIndication",Fe)},onMemberAudioMuteChanged:function(Fe,Et,sr){de.logger.log("QChatMedia::addRTCChannelListener::onMemberAudioMuteChanged",Fe,Et),de.core.emit("memberAudioMuteChanged",{memberAccId:Fe.uuid,mute:Et,operateByAccId:sr.uuid})},onMemberScreenShareStateChanged:function(Fe,Et,sr){de.logger.log("QChatMedia::addRTCChannelListener::onMemberScreenShareStateChanged",Fe,Et),de.core.emit("memberScreenShareStateChanged",{memberAccId:Fe.uuid,isSharing:Et,operateByAccId:sr.uuid})},onMemberVideoMuteChanged:function(Fe,Et,sr){de.logger.log("QChatMedia::addRTCChannelListener::onMemberVideoMuteChanged",Fe,Et),de.core.emit("memberVideoMuteChanged",{memberAccId:Fe.uuid,mute:Et,operateByAccId:sr.uuid})}})},$.enumCameraDevices=function(){var _=this;return this._checkConnectState(),this.rtcController.enumCameraDevices().then(function(Y){return Y.data},function(Y){throw _.logger.error("QChatMedia::enumCameraDevices error",Y),new uo("QChatMedia::enumCameraDevices error",Y)})},$.enumPlayoutDevices=function(){var _=this;return this._checkConnectState(),this.rtcController.enumPlayoutDevices().then(function(Y){return Y.data},function(Y){throw _.logger.error("QChatMedia::enumPlayoutDevices error",Y),new uo("QChatMedia::enumPlayoutDevices error",Y)})},$.enumRecordDevices=function(){var _=this;return this._checkConnectState(),this.rtcController.enumRecordDevices().then(function(Y){return Y.data},function(Y){throw _.logger.error("QChatMedia::enumRecordDevices error",Y),new uo("QChatMedia::enumRecordDevices error",Y)})},$.removeRTCChannelListener=function(){var _,Y;this._checkConnectState(),(_=this.roomContext)===null||_===void 0||_.removeRoomListener({}),(Y=this.authService)===null||Y===void 0||Y.removeAuthListener({})},$.setSelectedCameraDevice=function(_){var Y=this;return this._checkConnectState(),zr({deviceId:{type:"string",allowEmpty:!1}},_),this.rtcController.setSelectedCameraDevice(_.deviceId).then(function(de){return de.data},function(de){throw Y.logger.error("QChatMedia::setSelectedCameraDevice error",de),new uo("QChatMedia::setSelectedCameraDevice error",de)})},$.setSelectedPlayoutDevice=function(_){var Y=this;return this._checkConnectState(),zr({deviceId:{type:"string",allowEmpty:!1}},_),this.rtcController.setSelectedPlayoutDevice(_.deviceId).then(function(de){return de.data},function(de){throw Y.logger.error("QChatMedia::setSelectedPlayoutDevice error",de),new uo("QChatMedia::setSelectedPlayoutDevice error",de)})},$.setSelectedRecordDevice=function(_){var Y=this;return this._checkConnectState(),zr({deviceId:{type:"string",allowEmpty:!1}},_),this.rtcController.setSelectedRecordDevice(_.deviceId).then(function(de){return de.data},function(de){throw Y.logger.error("QChatMedia::setSelectedRecordDevice error",de),new uo("QChatMedia::setSelectedRecordDevice error",de)})},$.getRTCMembers=function(){var _,Y;return this._checkConnectState(),co(_=Ys(Y=this.roomContext.remoteMembers).call(Y,function(de){return de.isInRtcChannel})).call(_,function(de){return{accid:de.uuid,isAudioOn:!!de.isAudioOn,isVideoOn:!!de.isVideoOn,isSharingScreen:!!de.isSharingScreen,properties:de.properties}})},$.subscribeRemoteVideoSubStream=function(_){var Y;return kr(this,void 0,void 0,rr.mark(function de(){return rr.wrap(function(Fe){for(;;)switch(Fe.prev=Fe.next){case 0:this._checkConnectState(),zr({accid:{type:"string",allowEmpty:!1}},_),Fe.prev=2,(Y=this.rtcController)===null||Y===void 0||Y.subscribeRemoteVideoSubStream(_.accid),Fe.next=10;break;case 6:throw Fe.prev=6,Fe.t0=Fe.catch(2),this.logger.error("QChatMedia::subscribeRemoteVideoSubStream error",Fe.t0),new uo("QChatMedia::subscribeRemoteVideoSubStream error",Fe.t0);case 10:case"end":return Fe.stop()}},de,this,[[2,6]])}))},$.unsubscribeRemoteVideoSubStream=function(_){var Y;return kr(this,void 0,void 0,rr.mark(function de(){return rr.wrap(function(Fe){for(;;)switch(Fe.prev=Fe.next){case 0:this._checkConnectState(),zr({accid:{type:"string",allowEmpty:!1}},_),Fe.prev=2,(Y=this.rtcController)===null||Y===void 0||Y.unsubscribeRemoteVideoSubStream(_.accid),Fe.next=10;break;case 6:throw Fe.prev=6,Fe.t0=Fe.catch(2),this.logger.error("QChatMedia::unsubscribeRemoteVideoSubStream error",Fe.t0),new uo("QChatMedia::unsubscribeRemoteVideoSubStream error",Fe.t0);case 10:case"end":return Fe.stop()}},de,this,[[2,6]])}))},$.muteAllAudio=function(){var _;return kr(this,void 0,void 0,rr.mark(function Y(){return rr.wrap(function(V){for(;;)switch(V.prev=V.next){case 0:return this._checkConnectState(),V.next=3,this._checkPermission({serverId:this.serverId,channelId:this.channelId,auth:"RTCChannelOpenCloseEveryoneMicrophone"});case 3:if(V.sent){V.next=7;break}return this.logger.error("QChatMedia::connect::auth your have not RTCChannelOpenCloseEveryoneMicrophone auth"),V.abrupt("return");case 7:V.prev=7,(_=this.roomContext)===null||_===void 0||_.updateRoomProperty("audioOff",so({value:Cs.offNotAllowSelfOn+"_"+new Date().getTime()})),V.next=15;break;case 11:throw V.prev=11,V.t0=V.catch(7),this.logger.error("QChatMedia::muteAllAudio error",V.t0),new uo("QChatMedia::muteAllAudio error",V.t0);case 15:case"end":return V.stop()}},Y,this,[[7,11]])}))},$.muteAllVideo=function(){var _;return kr(this,void 0,void 0,rr.mark(function Y(){return rr.wrap(function(V){for(;;)switch(V.prev=V.next){case 0:return this._checkConnectState(),V.next=3,this._checkPermission({serverId:this.serverId,channelId:this.channelId,auth:"RTCChannelOpenCloseEveryoneCamera"});case 3:if(V.sent){V.next=7;break}return this.logger.error("QChatMedia::connect::auth your have not RTCChannelOpenCloseEveryoneCamera auth"),V.abrupt("return");case 7:V.prev=7,(_=this.roomContext)===null||_===void 0||_.updateRoomProperty("videoOff",so({value:Cs.offNotAllowSelfOn+"_"+new Date().getTime()})),V.next=15;break;case 11:throw V.prev=11,V.t0=V.catch(7),this.logger.error("QChatMedia::muteAllVideo error",V.t0),new uo("QChatMedia::muteAllVideo error",V.t0);case 15:case"end":return V.stop()}},Y,this,[[7,11]])}))},$.unMuteAllAudio=function(){var _;return kr(this,void 0,void 0,rr.mark(function Y(){return rr.wrap(function(V){for(;;)switch(V.prev=V.next){case 0:return this._checkConnectState(),V.next=3,this._checkPermission({serverId:this.serverId,channelId:this.channelId,auth:"RTCChannelOpenCloseEveryoneMicrophone"});case 3:if(V.sent){V.next=7;break}return this.logger.error("QChatMedia::connect::auth your have not RTCChannelOpenCloseEveryoneMicrophone auth"),V.abrupt("return");case 7:V.prev=7,(_=this.roomContext)===null||_===void 0||_.updateRoomProperty("audioOff",so({value:Cs.disable+"_"+new Date().getTime()})),V.next=15;break;case 11:throw V.prev=11,V.t0=V.catch(7),this.logger.error("QChatMedia::unMuteAllAudio error",V.t0),new uo("QChatMedia::unMuteAllAudio error",V.t0);case 15:case"end":return V.stop()}},Y,this,[[7,11]])}))},$.unMuteAllVideo=function(){var _;return kr(this,void 0,void 0,rr.mark(function Y(){return rr.wrap(function(V){for(;;)switch(V.prev=V.next){case 0:return this._checkConnectState(),V.next=3,this._checkPermission({serverId:this.serverId,channelId:this.channelId,auth:"RTCChannelOpenCloseEveryoneCamera"});case 3:if(V.sent){V.next=7;break}return this.logger.error("QChatMedia::connect::auth your have not RTCChannelOpenCloseEveryoneCamera auth"),V.abrupt("return");case 7:V.prev=7,(_=this.roomContext)===null||_===void 0||_.updateRoomProperty("videoOff",so({value:Cs.disable+"_"+new Date().getTime()})),V.next=15;break;case 11:throw V.prev=11,V.t0=V.catch(7),this.logger.error("QChatMedia::unMuteAllVideo error",V.t0),new uo("QChatMedia::unMuteAllVideo error",V.t0);case 15:case"end":return V.stop()}},Y,this,[[7,11]])}))},w}(vu),vM={"1_2":"heartbeat","24_2":"qchatLogin","24_4":"qchatExit","24_5":"qchatBeKicked","24_8":"qchatMultiSpotLogin","24_9":"qchatKick","24_19":"qchatSync"},Jd={qchatLoginTag:{appkey:1,account:2,authType:3,token:4,loginExt:5,clientType:6,clientSession:7,deviceId:8,sdkVersion:9,sdkType:10,userAgent:11,customTag:12,customClientType:13,sdkHumanVersion:14,pushTokenName:20,pushToken:21,pushkitTokenName:22,pushkitToken:23,deviceInfo:24,customPushContentType:25,os:30,mac:31,bundleId:32,simCarrierCode:33,simCountryCode:34,networkCode:35,browser:36,deviceModel:37,androidid:38,imei:39,idfv:40,openuuid:41,pushType:100,hasTokenPreviously:101,consid:102,clientIP:103,clientPort:104,loginTime:105}},ku=xc(Jd),bM={heartbeat:{sid:1,cid:2,service:"qchatAuth"},qchatLogin:{sid:24,cid:2,service:"qchatAuth",params:[{type:"Property",name:"qchatLoginReqTag",reflectMapper:Jd.qchatLoginTag}],response:[{type:"Property",name:"qchatLoginResTag",reflectMapper:ku.qchatLoginTag},{type:"PropertyArray",name:"qchatMultiLoginResult",reflectMapper:ku.qchatLoginTag}]},qchatExit:{sid:24,cid:4,service:"qchatAuth"},qchatBeKicked:{sid:24,cid:5,service:"qchatAuth",response:[{type:"Property",name:"beKickedTag",reflectMapper:{1:"clientType",2:"reason",3:"ext",4:"customClientType"}}]},qchatMultiSpotLogin:{sid:24,cid:8,service:"qchatAuth",response:[{type:"Number",name:"state"},{type:"Property",name:"qchatLoginResTag",reflectMapper:ku.qchatLoginTag}]},qchatKick:{sid:24,cid:9,service:"qchatAuth",params:[{type:"StrArray",name:"deviceIds"}],response:[{type:"StrArray",name:"deviceIds"}]},qchatSync:{sid:24,cid:19,service:"qchatAuth",isNoResponse:!0,params:[{type:"Property",name:"qchatSyncTag",reflectMapper:{systemNotification:1,pushConfig:2}}],response:[{type:"Number",name:"timetag"}]}},TM={debugLevel:"off",needReconnect:!0,reconnectionAttempts:ng,isAbtestEnable:!0,abtestUrl:"https://abt-online.netease.im/v1/api/abt/client/getExperimentInfo",abtestProjectKey:"imElite_sdk_abtest_web"},Yd=function(b){function w(A,_){var Y;return _===void 0&&(_={cloudStorageConfig:{}}),(Y=b.call(this,A)||this).instanceName="QChat",Y.account="",Y.options={},Y.qchatAuth={},Y.qchatServer={},Y.qchatChannel={},Y.qchatMsg={},Y.qchatRole={},Y.qchatMedia={},Y.cloudStorage={},Y.setOptions(A),Oa({cmdMap:vM,cmdConfig:bM}),Oa({cmdMap:bv,cmdConfig:Sh}),Y.qchatAuth=new gM(a(Y)),Y.qchatServer=new FS(a(Y)),Y.qchatChannel=new tM(a(Y)),Y.qchatMsg=new Kv(a(Y)),Y.qchatRole=new oM(a(Y)),Y.qchatMedia=new yM(a(Y)),Y.cloudStorage=new Tv(a(Y),Xr({storageKeyPrefix:Y.instanceName},_.cloudStorageConfig)),_&&Y.setOtherOptions(_),w.instance=a(Y),Y}Co(w,b),w.getInstance=function(_,Y){if(!w.instance){if(_)return new w(_,Y);throw new Error("Instance not exist, please input options")}if(_){if(w.instance.options.account===_.account&&w.instance.options.appkey===_.appkey)return w.instance.setOptions(_),Y&&w.instance.setOtherOptions(Y),w.instance;throw new Error("Unexpected login")}return w.instance};var $=w.prototype;return $.connect=function(_){_===void 0&&(_={});var Y=Qi(null,{connect:{get:function(){return b.prototype.connect}}});return kr(this,void 0,void 0,rr.mark(function de(){var V,Fe,Et;return rr.wrap(function(fr){for(;;)switch(fr.prev=fr.next){case 0:if(/^(unconnected|waitReconnect)$/.test(this.status)){fr.next=4;break}return V="QChat status is "+this.status+", and would not connect",this.logger.warn(V),fr.abrupt("return",ro.reject(V));case 4:return Fe=_.isAutoReconnect||!1,fr.next=7,Y.connect.call(this,{linkUrls:this.options.linkAddresses,isAutoReconnect:Fe});case 7:return fr.prev=7,fr.next=10,this.qchatAuth.doLogin(Fe);case 10:Et=fr.sent,fr.next=21;break;case 13:if(fr.prev=13,fr.t0=fr.catch(7),this.logger.warn("qchat connect:: login failed",fr.t0),this.retryCount!==0){fr.next=19;break}throw this.doDisconnect(cs.ACTIVE,"FailedToInitializeLogin"),fr.t0;case 19:return this.doDisconnect(cs.OFFLINE,"ReconnectLoginFailed"),fr.abrupt("return");case 21:return this.status="logined",Et.loginResult.appkey=this.options.appkey,this.eventBus.emit("logined",Et.loginResult),this.emit("logined",Et.loginResult),Et.multiLoginResults&&Et.multiLoginResults.length>0&&this.emit("multiSpotLogin",Et.multiLoginResults),this.resetConnectStatus(),this.ping(),fr.prev=28,fr.next=31,this.cloudStorage.init();case 31:fr.next=36;break;case 33:fr.prev=33,fr.t1=fr.catch(28),this.logger.error("NIM:login cloudStorage init failed ",fr.t1);case 36:return fr.next=38,this.qchatAuth.sync();case 38:case"end":return fr.stop()}},de,this,[[7,13],[28,33]])}))},$.login=function(_){return _===void 0&&(_={}),this.connect(_)},$.setOptions=function(_){zr({account:{type:"string"},appkey:{type:"string"},token:{type:"string"},linkAddresses:{type:"array",itemType:"string",min:1},needReconnect:{type:"boolean",required:!1},reconnectionAttempts:{type:"number",required:!1},debugLevel:{type:"enum",values:up,required:!1}},_),this.logger.log("QChat::setOptions options is",_),this.account=_.account,this.options=Xr(Xr({},TM),_)},$.setOtherOptions=function(_){var Y;!((Y=_==null?void 0:_.QChatMedia)===null||Y===void 0)&&Y.neroom&&this.qchatMedia.setNeroom(_.QChatMedia.neroom)},$.onMessage=function(_){var Y,de,V=b.prototype.onMessage.call(this,_);if(V){var Fe=V.raw.ser,Et=this.sendingCmdMap.get(Fe);if(Et&&Et.cmd===V.cmd){var sr=Et.callback,fr=Et.timer,Sr=Et.params;if(clearTimeout(fr),V.params=Sr,this.sendingCmdMap.delete(Fe),V.cmd==="heartbeat")return void sr[0]();var Tr=(Y=this[V.service])===null||Y===void 0?void 0:Y.process(V);Tr&&typeof Tr.then=="function"?Tr.then(function(Pr){sr[0](Pr)}).catch(function(Pr){sr[1](Pr)}):(this.logger.log("imsocket:: handlerFn without promise",V.service,V.cmd),sr[0]())}else(de=this[V.service])===null||de===void 0||de.process(V)}},$.disconnect=function(){var _=this;switch(this.status){case"logined":return this.sendCmd("qchatExit").then(function(){b.prototype.doDisconnect.call(_,cs.ACTIVE,"UserActiveDisconnect")});case"connected":case"connecting":case"waitReconnect":return b.prototype.doDisconnect.call(this,cs.ACTIVE,"UserActiveDisconnect"),ro.resolve();case"unconnected":case"destroyed":return ro.resolve()}},$.logout=function(){return this.disconnect()},$.destroy=function(){return w.instance=null,b.prototype.destroy.call(this)},$.kickOtherClients=function(_){return zr({deviceIds:{type:"array",itemType:"string"}},_),this.qchatAuth.kick(_)},w}(Md);Yd.instance=null;var SM=Math.min,zh=[].lastIndexOf,uf=!!zh&&1/[1].lastIndexOf(1,-0)<0,lf=Ds("lastIndexOf"),Jv=uf||!lf?function(w){if(uf)return k(zh,this,arguments)||0;var $=lr(this),A=Ci($),_=A-1;for(arguments.length>1&&(_=SM(_,Da(arguments[1]))),_<0&&(_=A+_);_>=0;_--)if(_ in $&&$[_]===w)return _||0;return-1}:zh;qr({target:"Array",proto:!0,forced:Jv!==[].lastIndexOf},{lastIndexOf:Jv});var MM=Ao("Array").lastIndexOf,Wh=Array.prototype,Yv=function(b){var w=b.lastIndexOf;return b===Wh||Lt(Wh,b)&&w===Wh.lastIndexOf?MM:w},Bc=s(function(b,w){(function(){var $={function:!0,object:!0}[typeof window]&&window||this,A=w,_=b&&!b.nodeType&&b,Y=A&&_&&typeof e=="object"&&e;!Y||Y.global!==Y&&Y.window!==Y&&Y.self!==Y||($=Y);var de=Math.pow(2,53)-1,V=/\bOpera/,Fe=Object.prototype,Et=Fe.hasOwnProperty,sr=Fe.toString;function fr(Mn){return(Mn=String(Mn)).charAt(0).toUpperCase()+Mn.slice(1)}function Sr(Mn){return Mn=Jr(Mn),/^(?:webOS|i(?:OS|P))/.test(Mn)?Mn:fr(Mn)}function Tr(Mn,Qr){for(var Vn in Mn)Et.call(Mn,Vn)&&Qr(Mn[Vn],Vn,Mn)}function Pr(Mn){return Mn==null?fr(Mn):sr.call(Mn).slice(8,-1)}function Lr(Mn){return String(Mn).replace(/([ -])(?!$)/g,"$1?")}function jr(Mn,Qr){var Vn=null;return function(Eo,jn){var wr=-1,Cn=Eo?Eo.length:0;if(typeof Cn=="number"&&Cn>-1&&Cn<=de)for(;++wr<Cn;)jn(Eo[wr],wr,Eo);else Tr(Eo,jn)}(Mn,function(Bn,Eo){Vn=Qr(Vn,Bn,Eo,Mn)}),Vn}function Jr(Mn){return String(Mn).replace(/^ +| +$/g,"")}var Gr=function Mn(Qr){var Vn=$,Bn=Qr&&typeof Qr=="object"&&Pr(Qr)!="String";Bn&&(Vn=Qr,Qr=null);var Eo=Vn.navigator||{},jn=Eo.userAgent||"";Qr||(Qr=jn);var wr,Cn,En=Bn?!!Eo.likeChrome:/\bChrome\b/.test(Qr)&&!/internal|\n/i.test(sr.toString()),vn="Object",Kr=Bn?vn:"ScriptBridgingProxyObject",_n=Bn?vn:"Environment",Ln=Bn&&Vn.java?"JavaPackage":Pr(Vn.java),Kn=Bn?vn:"RuntimeObject",Qn=/\bJava/.test(Ln)&&Vn.java,Po=Qn&&Pr(Vn.environment)==_n,ao=Qn?"a":"α",Wo=Qn?"b":"β",po=Vn.document||{},vo=Vn.operamini||Vn.opera,Go=V.test(Go=Bn&&vo?vo["[[Class]]"]:Pr(vo))?Go:vo=null,ka=Qr,bo=[],xa=null,Fi=Qr==jn,no=Fi&&vo&&typeof vo.version=="function"&&vo.version(),Do=function(Ti){return jr(Ti,function(qo,ui){return qo||RegExp("\\b"+(ui.pattern||Lr(ui))+"\\b","i").exec(Qr)&&(ui.label||ui)})}([{label:"EdgeHTML",pattern:"Edge"},"Trident",{label:"WebKit",pattern:"AppleWebKit"},"iCab","Presto","NetFront","Tasman","KHTML","Gecko"]),$n=function(Ti){return jr(Ti,function(qo,ui){return qo||RegExp("\\b"+(ui.pattern||Lr(ui))+"\\b","i").exec(Qr)&&(ui.label||ui)})}(["Adobe AIR","Arora","Avant Browser","Breach","Camino","Electron","Epiphany","Fennec","Flock","Galeon","GreenBrowser","iCab","Iceweasel","K-Meleon","Konqueror","Lunascape","Maxthon",{label:"Microsoft Edge",pattern:"(?:Edge|Edg|EdgA|EdgiOS)"},"Midori","Nook Browser","PaleMoon","PhantomJS","Raven","Rekonq","RockMelt",{label:"Samsung Internet",pattern:"SamsungBrowser"},"SeaMonkey",{label:"Silk",pattern:"(?:Cloud9|Silk-Accelerated)"},"Sleipnir","SlimBrowser",{label:"SRWare Iron",pattern:"Iron"},"Sunrise","Swiftfox","Vivaldi","Waterfox","WebPositive",{label:"Yandex Browser",pattern:"YaBrowser"},{label:"UC Browser",pattern:"UCBrowser"},"Opera Mini",{label:"Opera Mini",pattern:"OPiOS"},"Opera",{label:"Opera",pattern:"OPR"},"Chromium","Chrome",{label:"Chrome",pattern:"(?:HeadlessChrome)"},{label:"Chrome Mobile",pattern:"(?:CriOS|CrMo)"},{label:"Firefox",pattern:"(?:Firefox|Minefield)"},{label:"Firefox for iOS",pattern:"FxiOS"},{label:"IE",pattern:"IEMobile"},{label:"IE",pattern:"MSIE"},"Safari"]),ko=Zv([{label:"BlackBerry",pattern:"BB10"},"BlackBerry",{label:"Galaxy S",pattern:"GT-I9000"},{label:"Galaxy S2",pattern:"GT-I9100"},{label:"Galaxy S3",pattern:"GT-I9300"},{label:"Galaxy S4",pattern:"GT-I9500"},{label:"Galaxy S5",pattern:"SM-G900"},{label:"Galaxy S6",pattern:"SM-G920"},{label:"Galaxy S6 Edge",pattern:"SM-G925"},{label:"Galaxy S7",pattern:"SM-G930"},{label:"Galaxy S7 Edge",pattern:"SM-G935"},"Google TV","Lumia","iPad","iPod","iPhone","Kindle",{label:"Kindle Fire",pattern:"(?:Cloud9|Silk-Accelerated)"},"Nexus","Nook","PlayBook","PlayStation Vita","PlayStation","TouchPad","Transformer",{label:"Wii U",pattern:"WiiU"},"Wii","Xbox One",{label:"Xbox 360",pattern:"Xbox"},"Xoom"]),Wi=function(Ti){return jr(Ti,function(qo,ui,Xd){return qo||(ui[ko]||ui[/^[a-z]+(?: +[a-z]+\b)*/i.exec(ko)]||RegExp("\\b"+Lr(Xd)+"(?:\\b|\\w*\\d)","i").exec(Qr))&&Xd})}({Apple:{iPad:1,iPhone:1,iPod:1},Alcatel:{},Archos:{},Amazon:{Kindle:1,"Kindle Fire":1},Asus:{Transformer:1},"Barnes & Noble":{Nook:1},BlackBerry:{PlayBook:1},Google:{"Google TV":1,Nexus:1},HP:{TouchPad:1},HTC:{},Huawei:{},Lenovo:{},LG:{},Microsoft:{Xbox:1,"Xbox One":1},Motorola:{Xoom:1},Nintendo:{"Wii U":1,Wii:1},Nokia:{Lumia:1},Oppo:{},Samsung:{"Galaxy S":1,"Galaxy S2":1,"Galaxy S3":1,"Galaxy S4":1},Sony:{PlayStation:1,"PlayStation Vita":1},Xiaomi:{Mi:1,Redmi:1}}),zn=function(Ti){return jr(Ti,function(qo,ui){var Xd=ui.pattern||Lr(ui);return!qo&&(qo=RegExp("\\b"+Xd+"(?:/[\\d.]+|[ \\w.]*)","i").exec(Qr))&&(qo=function(Ws,Zd,df){var Kh={"10.0":"10",6.4:"10 Technical Preview",6.3:"8.1",6.2:"8",6.1:"Server 2008 R2 / 7","6.0":"Server 2008 / Vista",5.2:"Server 2003 / XP 64-bit",5.1:"XP",5.01:"2000 SP1","5.0":"2000","4.0":"NT","4.90":"ME"};return Zd&&df&&/^Win/i.test(Ws)&&!/^Windows Phone /i.test(Ws)&&(Kh=Kh[/[\d.]+$/.exec(Ws)])&&(Ws="Windows "+Kh),Ws=String(Ws),Zd&&df&&(Ws=Ws.replace(RegExp(Zd,"i"),df)),Sr(Ws.replace(/ ce$/i," CE").replace(/\bhpw/i,"web").replace(/\bMacintosh\b/,"Mac OS").replace(/_PowerPC\b/i," OS").replace(/\b(OS X) [^ \d]+/i,"$1").replace(/\bMac (OS X)\b/,"$1").replace(/\/(\d)/," $1").replace(/_/g,".").replace(/(?: BePC|[ .]*fc[ \d.]+)$/i,"").replace(/\bx86\.64\b/gi,"x86_64").replace(/\b(Windows Phone) OS\b/,"$1").replace(/\b(Chrome OS \w+) [\d.]+\b/,"$1").split(" on ")[0])}(qo,Xd,ui.label||ui)),qo})}(["Windows Phone","KaiOS","Android","CentOS",{label:"Chrome OS",pattern:"CrOS"},"Debian",{label:"DragonFly BSD",pattern:"DragonFly"},"Fedora","FreeBSD","Gentoo","Haiku","Kubuntu","Linux Mint","OpenBSD","Red Hat","SuSE","Ubuntu","Xubuntu","Cygwin","Symbian OS","hpwOS","webOS ","webOS","Tablet OS","Tizen","Linux","Mac OS X","Macintosh","Mac","Windows 98;","Windows "]);function Zv(xs){return jr(xs,function(Ti,qo){var ui=qo.pattern||Lr(qo);return!Ti&&(Ti=RegExp("\\b"+ui+" *\\d+[.\\w_]*","i").exec(Qr)||RegExp("\\b"+ui+" *\\w+-[\\w]*","i").exec(Qr)||RegExp("\\b"+ui+"(?:; *(?:[a-z]+[_-])?[a-z]+\\d+|[^ ();-]*)","i").exec(Qr))&&((Ti=String(qo.label&&!RegExp(ui,"i").test(qo.label)?qo.label:Ti).split("/"))[1]&&!/[\d.]+/.test(Ti[0])&&(Ti[0]+=" "+Ti[1]),qo=qo.label||qo,Ti=Sr(Ti[0].replace(RegExp(ui,"i"),qo).replace(RegExp("; *(?:"+qo+"[_-])?","i")," ").replace(RegExp("("+qo+")[-_.]?(\\w)","i"),"$1 $2"))),Ti})}function Gh(xs){return jr(xs,function(Ti,qo){return Ti||(RegExp(qo+"(?:-[\\d.]+/|(?: for [\\w-]+)?[ /-])([\\d.]+[^ ();/_-]*)","i").exec(Qr)||0)[1]||null})}if(Do&&(Do=[Do]),/\bAndroid\b/.test(zn)&&!ko&&(wr=/\bAndroid[^;]*;(.*?)(?:Build|\) AppleWebKit)\b/i.exec(Qr))&&(ko=Jr(wr[1]).replace(/^[a-z]{2}-[a-z]{2};\s*/i,"")||null),Wi&&!ko?ko=Zv([Wi]):Wi&&ko&&(ko=ko.replace(RegExp("^("+Lr(Wi)+")[-_.\\s]","i"),Wi+" ").replace(RegExp("^("+Lr(Wi)+")[-_.]?(\\w)","i"),Wi+" $2")),(wr=/\bGoogle TV\b/.exec(ko))&&(ko=wr[0]),/\bSimulator\b/i.test(Qr)&&(ko=(ko?ko+" ":"")+"Simulator"),$n=="Opera Mini"&&/\bOPiOS\b/.test(Qr)&&bo.push("running in Turbo/Uncompressed mode"),$n=="IE"&&/\blike iPhone OS\b/.test(Qr)?(Wi=(wr=Mn(Qr.replace(/like iPhone OS/,""))).manufacturer,ko=wr.product):/^iP/.test(ko)?($n||($n="Safari"),zn="iOS"+((wr=/ OS ([\d_]+)/i.exec(Qr))?" "+wr[1].replace(/_/g,"."):"")):$n=="Konqueror"&&/^Linux\b/i.test(zn)?zn="Kubuntu":Wi&&Wi!="Google"&&(/Chrome/.test($n)&&!/\bMobile Safari\b/i.test(Qr)||/\bVita\b/.test(ko))||/\bAndroid\b/.test(zn)&&/^Chrome/.test($n)&&/\bVersion\//i.test(Qr)?($n="Android Browser",zn=/\bAndroid\b/.test(zn)?zn:"Android"):$n=="Silk"?(/\bMobi/i.test(Qr)||(zn="Android",bo.unshift("desktop mode")),/Accelerated *= *true/i.test(Qr)&&bo.unshift("accelerated")):$n=="UC Browser"&&/\bUCWEB\b/.test(Qr)?bo.push("speed mode"):$n=="PaleMoon"&&(wr=/\bFirefox\/([\d.]+)\b/.exec(Qr))?bo.push("identifying as Firefox "+wr[1]):$n=="Firefox"&&(wr=/\b(Mobile|Tablet|TV)\b/i.exec(Qr))?(zn||(zn="Firefox OS"),ko||(ko=wr[1])):!$n||(wr=!/\bMinefield\b/i.test(Qr)&&/\b(?:Firefox|Safari)\b/.exec($n))?($n&&!ko&&/[\/,]|^[^(]+?\)/.test(Qr.slice(Qr.indexOf(wr+"/")+8))&&($n=null),(wr=ko||Wi||zn)&&(ko||Wi||/\b(?:Android|Symbian OS|Tablet OS|webOS)\b/.test(zn))&&($n=/[a-z]+(?: Hat)?/i.exec(/\bAndroid\b/.test(zn)?zn:wr)+" Browser")):$n=="Electron"&&(wr=(/\bChrome\/([\d.]+)\b/.exec(Qr)||0)[1])&&bo.push("Chromium "+wr),no||(no=Gh(["(?:Cloud9|CriOS|CrMo|Edge|Edg|EdgA|EdgiOS|FxiOS|HeadlessChrome|IEMobile|Iron|Opera ?Mini|OPiOS|OPR|Raven|SamsungBrowser|Silk(?!/[\\d.]+$)|UCBrowser|YaBrowser)","Version",Lr($n),"(?:Firefox|Minefield|NetFront)"])),(wr=(Do=="iCab"&&parseFloat(no)>3?"WebKit":/\bOpera\b/.test($n)&&(/\bOPR\b/.test(Qr)?"Blink":"Presto"))||/\b(?:Midori|Nook|Safari)\b/i.test(Qr)&&!/^(?:Trident|EdgeHTML)$/.test(Do)&&"WebKit"||!Do&&/\bMSIE\b/i.test(Qr)&&(zn=="Mac OS"?"Tasman":"Trident")||Do=="WebKit"&&/\bPlayStation\b(?! Vita\b)/i.test($n)&&"NetFront")&&(Do=[wr]),$n=="IE"&&(wr=(/; *(?:XBLWP|ZuneWP)(\d+)/i.exec(Qr)||0)[1])?($n+=" Mobile",zn="Windows Phone "+(/\+$/.test(wr)?wr:wr+".x"),bo.unshift("desktop mode")):/\bWPDesktop\b/i.test(Qr)?($n="IE Mobile",zn="Windows Phone 8.x",bo.unshift("desktop mode"),no||(no=(/\brv:([\d.]+)/.exec(Qr)||0)[1])):$n!="IE"&&Do=="Trident"&&(wr=/\brv:([\d.]+)/.exec(Qr))&&($n&&bo.push("identifying as "+$n+(no?" "+no:"")),$n="IE",no=wr[1]),Fi){if(function(Ti,qo){var ui=Ti!=null?typeof Ti[qo]:"number";return!(/^(?:boolean|number|string|undefined)$/.test(ui)||ui=="object"&&!Ti[qo])}(Vn,"global"))if(Qn&&(ka=(wr=Qn.lang.System).getProperty("os.arch"),zn=zn||wr.getProperty("os.name")+" "+wr.getProperty("os.version")),Po){try{no=Vn.require("ringo/engine").version.join("."),$n="RingoJS"}catch{(wr=Vn.system)&&wr.global.system==Vn.system&&($n="Narwhal",zn||(zn=wr[0].os||null))}$n||($n="Rhino")}else typeof Vn.process=="object"&&!Vn.process.browser&&(wr=Vn.process)&&(typeof wr.versions=="object"&&(typeof wr.versions.electron=="string"?(bo.push("Node "+wr.versions.node),$n="Electron",no=wr.versions.electron):typeof wr.versions.nw=="string"&&(bo.push("Chromium "+no,"Node "+wr.versions.node),$n="NW.js",no=wr.versions.nw)),$n||($n="Node.js",ka=wr.arch,zn=wr.platform,no=(no=/[\d.]+/.exec(wr.version))?no[0]:null));else Pr(wr=Vn.runtime)==Kr?($n="Adobe AIR",zn=wr.flash.system.Capabilities.os):Pr(wr=Vn.phantom)==Kn?($n="PhantomJS",no=(wr=wr.version||null)&&wr.major+"."+wr.minor+"."+wr.patch):typeof po.documentMode=="number"&&(wr=/\bTrident\/(\d+)/i.exec(Qr))?(no=[no,po.documentMode],(wr=+wr[1]+4)!=no[1]&&(bo.push("IE "+no[1]+" mode"),Do&&(Do[1]=""),no[1]=wr),no=$n=="IE"?String(no[1].toFixed(1)):no[0]):typeof po.documentMode=="number"&&/^(?:Chrome|Firefox)\b/.test($n)&&(bo.push("masking as "+$n+" "+no),$n="IE",no="11.0",Do=["Trident"],zn="Windows");zn=zn&&Sr(zn)}if(no&&(wr=/(?:[ab]|dp|pre|[ab]\d+pre)(?:\d+\+?)?$/i.exec(no)||/(?:alpha|beta)(?: ?\d)?/i.exec(Qr+";"+(Fi&&Eo.appMinorVersion))||/\bMinefield\b/i.test(Qr)&&"a")&&(xa=/b/i.test(wr)?"beta":"alpha",no=no.replace(RegExp(wr+"\\+?$"),"")+(xa=="beta"?Wo:ao)+(/\d+\+?/.exec(wr)||"")),$n=="Fennec"||$n=="Firefox"&&/\b(?:Android|Firefox OS|KaiOS)\b/.test(zn))$n="Firefox Mobile";else if($n=="Maxthon"&&no)no=no.replace(/\.[\d.]+/,".x");else if(/\bXbox\b/i.test(ko))ko=="Xbox 360"&&(zn=null),ko=="Xbox 360"&&/\bIEMobile\b/.test(Qr)&&bo.unshift("mobile mode");else if(!/^(?:Chrome|IE|Opera)$/.test($n)&&(!$n||ko||/Browser|Mobi/.test($n))||zn!="Windows CE"&&!/Mobi/i.test(Qr))if($n=="IE"&&Fi)try{Vn.external===null&&bo.unshift("platform preview")}catch{bo.unshift("embedded")}else(/\bBlackBerry\b/.test(ko)||/\bBB10\b/.test(Qr))&&(wr=(RegExp(ko.replace(/ +/g," *")+"/([.\\d]+)","i").exec(Qr)||0)[1]||no)?(zn=((wr=[wr,/BB10/.test(Qr)])[1]?(ko=null,Wi="BlackBerry"):"Device Software")+" "+wr[0],no=null):this!=Tr&&ko!="Wii"&&(Fi&&vo||/Opera/.test($n)&&/\b(?:MSIE|Firefox)\b/i.test(Qr)||$n=="Firefox"&&/\bOS X (?:\d+\.){2,}/.test(zn)||$n=="IE"&&(zn&&!/^Win/.test(zn)&&no>5.5||/\bWindows XP\b/.test(zn)&&no>8||no==8&&!/\bTrident\b/.test(Qr)))&&!V.test(wr=Mn.call(Tr,Qr.replace(V,"")+";"))&&wr.name&&(wr="ing as "+wr.name+((wr=wr.version)?" "+wr:""),V.test($n)?(/\bIE\b/.test(wr)&&zn=="Mac OS"&&(zn=null),wr="identify"+wr):(wr="mask"+wr,$n=Go?Sr(Go.replace(/([a-z])([A-Z])/g,"$1 $2")):"Opera",/\bIE\b/.test(wr)&&(zn=null),Fi||(no=null)),Do=["Presto"],bo.push(wr));else $n+=" Mobile";(wr=(/\bAppleWebKit\/([\d.]+\+?)/i.exec(Qr)||0)[1])&&(wr=[parseFloat(wr.replace(/\.(\d)$/,".0$1")),wr],$n=="Safari"&&wr[1].slice(-1)=="+"?($n="WebKit Nightly",xa="alpha",no=wr[1].slice(0,-1)):no!=wr[1]&&no!=(wr[2]=(/\bSafari\/([\d.]+\+?)/i.exec(Qr)||0)[1])||(no=null),wr[1]=(/\b(?:Headless)?Chrome\/([\d.]+)/i.exec(Qr)||0)[1],wr[0]==537.36&&wr[2]==537.36&&parseFloat(wr[1])>=28&&Do=="WebKit"&&(Do=["Blink"]),Fi&&(En||wr[1])?(Do&&(Do[1]="like Chrome"),wr=wr[1]||((wr=wr[0])<530?1:wr<532?2:wr<532.05?3:wr<533?4:wr<534.03?5:wr<534.07?6:wr<534.1?7:wr<534.13?8:wr<534.16?9:wr<534.24?10:wr<534.3?11:wr<535.01?12:wr<535.02?"13+":wr<535.07?15:wr<535.11?16:wr<535.19?17:wr<536.05?18:wr<536.1?19:wr<537.01?20:wr<537.11?"21+":wr<537.13?23:wr<537.18?24:wr<537.24?25:wr<537.36?26:Do!="Blink"?"27":"28")):(Do&&(Do[1]="like Safari"),wr=(wr=wr[0])<400?1:wr<500?2:wr<526?3:wr<533?4:wr<534?"4+":wr<535?5:wr<537?6:wr<538?7:wr<601?8:wr<602?9:wr<604?10:wr<606?11:wr<608?12:"12"),Do&&(Do[1]+=" "+(wr+=typeof wr=="number"?".x":/[.+]/.test(wr)?"":"+")),$n=="Safari"&&(!no||parseInt(no)>45)?no=wr:$n=="Chrome"&&/\bHeadlessChrome/i.test(Qr)&&bo.unshift("headless")),$n=="Opera"&&(wr=/\bzbov|zvav$/.exec(zn))?($n+=" ",bo.unshift("desktop mode"),wr=="zvav"?($n+="Mini",no=null):$n+="Mobile",zn=zn.replace(RegExp(" *"+wr+"$"),"")):$n=="Safari"&&/\bChrome\b/.exec(Do&&Do[1])?(bo.unshift("desktop mode"),$n="Chrome Mobile",no=null,/\bOS X\b/.test(zn)?(Wi="Apple",zn="iOS 4.3+"):zn=null):/\bSRWare Iron\b/.test($n)&&!no&&(no=Gh("Chrome")),no&&no.indexOf(wr=/[\d.]+$/.exec(zn))==0&&Qr.indexOf("/"+wr+"-")>-1&&(zn=Jr(zn.replace(wr,""))),zn&&zn.indexOf($n)!=-1&&!RegExp($n+" OS").test(zn)&&(zn=zn.replace(RegExp(" *"+Lr($n)+" *"),"")),Do&&!/\b(?:Avant|Nook)\b/.test($n)&&(/Browser|Lunascape|Maxthon/.test($n)||$n!="Safari"&&/^iOS/.test(zn)&&/\bSafari\b/.test(Do[1])||/^(?:Adobe|Arora|Breach|Midori|Opera|Phantom|Rekonq|Rock|Samsung Internet|Sleipnir|SRWare Iron|Vivaldi|Web)/.test($n)&&Do[1])&&(wr=Do[Do.length-1])&&bo.push(wr),bo.length&&(bo=["("+bo.join("; ")+")"]),Wi&&ko&&ko.indexOf(Wi)<0&&bo.push("on "+Wi),ko&&bo.push((/^on /.test(bo[bo.length-1])?"":"on ")+ko),zn&&(wr=/ ([\d.+]+)$/.exec(zn),Cn=wr&&zn.charAt(zn.length-wr[0].length-1)=="/",zn={architecture:32,family:wr&&!Cn?zn.replace(wr[0],""):zn,version:wr?wr[1]:null,toString:function(){var xs=this.version;return this.family+(xs&&!Cn?" "+xs:"")+(this.architecture==64?" 64-bit":"")}}),(wr=/\b(?:AMD|IA|Win|WOW|x86_|x)64\b/i.exec(ka))&&!/\bi686\b/i.test(ka)?(zn&&(zn.architecture=64,zn.family=zn.family.replace(RegExp(" *"+wr),"")),$n&&(/\bWOW64\b/i.test(Qr)||Fi&&/\w(?:86|32)$/.test(Eo.cpuClass||Eo.platform)&&!/\bWin64; x64\b/i.test(Qr))&&bo.unshift("32-bit")):zn&&/^OS X/.test(zn.family)&&$n=="Chrome"&&parseFloat(no)>=39&&(zn.architecture=64),Qr||(Qr=null);var ks={};return ks.description=Qr,ks.layout=Do&&Do[0],ks.manufacturer=Wi,ks.name=$n,ks.prerelease=xa,ks.product=ko,ks.ua=Qr,ks.version=$n&&no,ks.os=zn||{architecture:null,family:null,version:null,toString:function(){return"null"}},ks.parse=Mn,ks.toString=function(){return this.description||""},ks.version&&bo.unshift(no),ks.name&&bo.unshift($n),zn&&$n&&(zn!=String(zn).split(" ")[0]||zn!=$n.split(" ")[0]&&!ko)&&bo.push(ko?"("+zn+")":"on "+zn),bo.length&&(ks.description=bo.join(" ")),ks}();A&&_?Tr(Gr,function(Mn,Qr){A[Qr]=Mn}):$.platform=Gr}).call(e)}),Xv=s(function(b,w){b.exports=function(){var $={d:function(wr,Cn){for(var En in Cn)$.o(Cn,En)&&!$.o(wr,En)&&Qa(wr,En,{enumerable:!0,get:Cn[En]})},o:function(wr,Cn){return Object.prototype.hasOwnProperty.call(wr,Cn)}},A={};$.d(A,{default:function(){return Eo}});var _=function jn(wr){for(var Cn in function(En,vn){if(!(En instanceof vn))throw new TypeError("Cannot call a class as a function")}(this,jn),this.directUploadAddr="https://wanproxy-web.127.net",this.retryCount=4,this.trunkSize=4194304,this.trunkUploadTimeout=5e4,this.getOffsetTimeout=1e4,this.version="1.0",this.enableCache=!0,this.logger=console,this.onError=function(En){},this.onProgress=function(En){},this.onUploadProgress=function(En){},this.onComplete=function(En){},wr)this[Cn]=wr[Cn]};function Y(jn,wr){var Cn=li!==void 0&&Di(jn)||jn["@@iterator"];if(!Cn){if(rs(jn)||(Cn=function(Kn,Qn){if(Kn){var Po;if(typeof Kn=="string")return de(Kn,Qn);var ao=fo(Po=Object.prototype.toString.call(Kn)).call(Po,8,-1);return ao==="Object"&&Kn.constructor&&(ao=Kn.constructor.name),ao==="Map"||ao==="Set"?_c(Kn):ao==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(ao)?de(Kn,Qn):void 0}}(jn))||wr&&jn&&typeof jn.length=="number"){Cn&&(jn=Cn);var En=0,vn=function(){};return{s:vn,n:function(){return En>=jn.length?{done:!0}:{done:!1,value:jn[En++]}},e:function(Qn){throw Qn},f:vn}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var Kr,_n=!0,Ln=!1;return{s:function(){Cn=Cn.call(jn)},n:function(){var Qn=Cn.next();return _n=Qn.done,Qn},e:function(Qn){Ln=!0,Kr=Qn},f:function(){try{_n||Cn.return==null||Cn.return()}finally{if(Ln)throw Kr}}}}function de(jn,wr){(wr==null||wr>jn.length)&&(wr=jn.length);for(var Cn=0,En=new Array(wr);Cn<wr;Cn++)En[Cn]=jn[Cn];return En}var V=window.localStorage;window.localStorage&&typeof window.localStorage.getItem=="function"&&typeof window.localStorage.setItem=="function"&&typeof window.localStorage.removeItem=="function"||(V={privateObj:{},setItem:function(wr,Cn){V.privateObj[wr]=Cn},getItem:function(wr){return V.privateObj[wr]},removeItem:function(wr){delete V.privateObj[wr]},getKeys:function(){return Yo(V.privateObj)}});var Fe={getFileKey:function(wr){var Cn=wr.size.toString(),En=wr.lastModified.toString();return"_NosUploader_"+wr.name+fo(Cn).call(Cn,Cn.length-5)+fo(En).call(En,En.length-5)},getFileInfo:function(wr){var Cn=V.getItem(wr);if(!Cn)return null;try{return JSON.parse(Cn)}catch{return null}},initFile:function(wr,Cn,En){Fe.clearExpiredInfo();var vn=this.getFileKey(Cn),Kr={ctx:wr.ctx!==void 0?wr.ctx:"",bucket:wr.bucketName,obj:wr.objectName,token:wr.token,modifyAt:es(),end:!1};return wr.payload&&(Kr.payload=wr.payload),En&&V.setItem(vn,so(Kr)),vn},setUploadContext:function(wr,Cn,En){var vn=this.getFileInfo(wr);vn&&(vn.ctx=Cn,En&&V.setItem(wr,so(vn)))},setComplete:function(wr,Cn){var En=this.getFileInfo(wr);En&&(En.modifyAt=es(),En.end=!0,Cn&&V.setItem(wr,so(En)))},getUploadContext:function(wr){var Cn=this.getFileInfo(wr);return Cn?Cn.ctx:""},removeFileInfo:function(wr){ai(wr).call(wr,"_NosUploader_")===0&&V.removeItem(wr)},clearExpiredInfo:function(){var wr,Cn=typeof V.getKeys=="function"?V.getKeys():Yo(V),En=es(),vn=[],Kr=Y(Cn);try{for(Kr.s();!(wr=Kr.n()).done;){var _n=wr.value;if(ai(_n).call(_n,"_NosUploader_")===0){var Ln=Fe.getFileInfo(_n);Ln===null||En-Ln.modifyAt>Eo.expireTime?V.removeItem(_n):vn.push({fileInfo:Ln,key:_n})}}}catch(po){Kr.e(po)}finally{Kr.f()}if(vn.length>Eo.maxFileCache){var Kn,Qn,Po=Y(fo(Kn=Xu(vn).call(vn,function(po,vo){return vo.fileInfo.modifyAt-po.fileInfo.modifyAt})).call(Kn,Eo.maxFileCache));try{for(Po.s();!(Qn=Po.n()).done;){var ao,Wo=Qn.value;ai(ao=Wo.key).call(ao,"_NosUploader_")===0&&V.removeItem(Wo.key)}}catch(po){Po.e(po)}finally{Po.f()}}}},Et=Fe;function sr(jn){return(sr=typeof li=="function"&&typeof fm=="symbol"?function(wr){return typeof wr}:function(wr){return wr&&typeof li=="function"&&wr.constructor===li&&wr!==li.prototype?"symbol":typeof wr})(jn)}function fr(jn,wr){return!wr||sr(wr)!=="object"&&typeof wr!="function"?function(Cn){if(Cn===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return Cn}(jn):wr}function Sr(jn){var wr=typeof su=="function"?new su:void 0;return(Sr=function(En){var vn,Kr;if(En===null||(Kr=En,ai(vn=Function.toString.call(Kr)).call(vn,"[native code]")===-1))return En;if(typeof En!="function")throw new TypeError("Super expression must either be null or a function");if(wr!==void 0){if(wr.has(En))return wr.get(En);wr.set(En,_n)}function _n(){return Tr(En,arguments,jr(this).constructor)}return _n.prototype=Qi(En.prototype,{constructor:{value:_n,enumerable:!1,writable:!0,configurable:!0}}),Lr(_n,En)})(jn)}function Tr(jn,wr,Cn){return(Tr=Pr()?oc:function(En,vn,Kr){var _n=[null];_n.push.apply(_n,vn);var Ln=new(Mo(Function).apply(En,_n));return Kr&&Lr(Ln,Kr.prototype),Ln}).apply(null,arguments)}function Pr(){if(typeof Reflect>"u"||!oc||oc.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(oc(Boolean,[],function(){})),!0}catch{return!1}}function Lr(jn,wr){return(Lr=Rs||function(Cn,En){return Cn.__proto__=En,Cn})(jn,wr)}function jr(jn){return(jr=Rs?Us:function(wr){return wr.__proto__||Us(wr)})(jn)}var Jr=function(jn){(function(Kr,_n){if(typeof _n!="function"&&_n!==null)throw new TypeError("Super expression must either be null or a function");Kr.prototype=Qi(_n&&_n.prototype,{constructor:{value:Kr,writable:!0,configurable:!0}}),_n&&Lr(Kr,_n)})(vn,jn);var wr,Cn,En=(wr=vn,Cn=Pr(),function(){var Kr,_n=jr(wr);if(Cn){var Ln=jr(this).constructor;Kr=oc(_n,arguments,Ln)}else Kr=_n.apply(this,arguments);return fr(this,Kr)});function vn(Kr,_n){var Ln;return function(Kn,Qn){if(!(Kn instanceof Qn))throw new TypeError("Cannot call a class as a function")}(this,vn),(Ln=En.call(this,"NosUploadError:"+Kr)).errCode=_n,Ln.errMsg=Kr,Ln}return vn}(Sr(Error)),Gr=function jn(wr,Cn,En){if(wr.uploadState==="uploading"){var vn=wr.config,Kr=wr.param,_n=Et.getUploadContext(wr.fileKey);if(!_n)return En(0);var Ln=new XMLHttpRequest,Kn=vn.directUploadAddr+"/".concat(Kr.bucketName)+"/".concat(encodeURIComponent(Kr.objectName))+"?uploadContext"+"&context=".concat(_n)+"&version=".concat(vn.version);Ln.onreadystatechange=function(){var Qn;if(wr.uploadState!=="abort"&&Ln.readyState===4){var Po,ao,Wo,po;try{po=JSON.parse(Ln.responseText)}catch{po={errMsg:"JsonParseError in getOffset",errCode:500}}Ln.status===200?po.errCode?wr.config.onError(new Jr(po.errMsg,po.errCode)):En(po.offset):Ln.status.toString().match(/^5/)?jn(wr,Cn-1,En):Cn>0?(typeof((Qn=vn.logger)===null||Qn===void 0?void 0:Qn.error)=="function"&&vn.logger.error($s(Po="getOffset(".concat(Kn,") error. retry after 3 seconds. ")).call(Po,new Date().toTimeString())),ti(function(){jn(wr,Cn-1,En)},3500)):(Et.removeFileInfo(wr.fileKey),Ln.status?vn.onError(new Jr($s(ao=$s(Wo="getOffset(".concat(Kn,") error: ")).call(Wo,Ln.status," ")).call(ao,Ln.statusText))):vn.onError(new Jr("getOffset(".concat(Kn,") error. no Error Code"))))}},Ln.open("get",Kn),Ln.setRequestHeader("x-nos-token",Kr.token),Ln.timeout=vn.getOffsetTimeout,Ln.send()}},Mn=function jn(wr,Cn,En,vn){if(wr.uploadState==="uploading"){var Kr=wr.param,_n=wr.config,Ln=fo(File.prototype),Kn=Kr.ctx!==void 0?Kr.ctx:"",Qn=Cn+_n.trunkSize>wr.file.size,Po=Qn?wr.file.size:Cn+_n.trunkSize,ao=new XMLHttpRequest,Wo=_n.directUploadAddr+"/".concat(Kr.bucketName)+"/".concat(encodeURIComponent(Kr.objectName));if(ao.upload.onprogress=function(vo){if(wr.uploadState!=="abort"){var Go=0;vo.lengthComputable?(Go=(Cn+vo.loaded)/wr.file.size,_n.onProgress(Go),_n.onUploadProgress({loaded:vo.loaded,total:wr.file.size,percentage:Go,percentageText:(100*Go).toFixed(2)+"%"})):_n.onError(new Jr("browser does not support query upload progress"))}},ao.onreadystatechange=function(){var vo,Go;if(wr.uploadState!=="abort"&&ao.readyState===4){var ka,bo,xa,Fi;try{Fi=JSON.parse(ao.responseText)}catch(no){typeof((vo=_n.logger)===null||vo===void 0?void 0:vo.error)=="function"&&_n.logger.error("JsonParseError in uploadTrunk",no),Fi={errMsg:"JsonParseError in uploadTrunk"}}ao.status===200?(wr.setContext(Fi.context),Qn?(vn(),wr.setComplete()):jn(wr,Fi.offset,_n.retryCount,vn)):ao.status.toString().match(/^5/)?En>0?jn(wr,Cn,En-1,vn):(Et.removeFileInfo(wr.fileKey),_n.onError(new Jr(Fi.errMsg,Fi.errCode))):En>0?(typeof((Go=_n.logger)===null||Go===void 0?void 0:Go.error)=="function"&&_n.logger.error($s(ka="uploadTrunk(".concat(Wo,") error. retry after 3 seconds. ")).call(ka,new Date().toTimeString())),ti(function(){jn(wr,Cn,En-1,vn)},3500)):(Et.removeFileInfo(wr.fileKey),ao.status?_n.onError(new Jr($s(bo=$s(xa="uploadTrunk(".concat(Wo,") error: ")).call(xa,ao.status," ")).call(bo,ao.statusText))):_n.onError(new Jr("uploadTrunk(".concat(Wo,") error. no Error Code. Please check your network"))))}},ao.open("post",Wo+"?offset=".concat(Cn)+"&complete=".concat(Qn)+"&context=".concat(Kn)+"&version=".concat(_n.version)),ao.setRequestHeader("x-nos-token",Kr.token),wr.file.type&&ao.setRequestHeader("content-type",wr.file.type),ao.timeout=_n.trunkUploadTimeout,typeof FileReader<"u"){var po=new FileReader;po.addEventListener("load",function(vo){var Go;!((Go=vo==null?void 0:vo.target)===null||Go===void 0)&&Go.result?ao.send(vo.target.result):_n.onError(new Jr("Read ArrayBuffer failed"))}),po.addEventListener("error",function(vo){var Go=vo.target.error;_n.onError(new Jr("Read ArrayBuffer error. ".concat(Go.toString()),Go.code))}),po.readAsArrayBuffer(Ln.call(wr.file,Cn,Po))}else ao.send(Ln.call(wr.file,Cn,Po))}};function Qr(jn,wr){for(var Cn=0;Cn<wr.length;Cn++){var En=wr[Cn];En.enumerable=En.enumerable||!1,En.configurable=!0,"value"in En&&(En.writable=!0),Qa(jn,En.key,En)}}var Vn=function(){function jn(Cn,En,vn){(function(Kr,_n){if(!(Kr instanceof _n))throw new TypeError("Cannot call a class as a function")})(this,jn),this.uploadState="paused",this.config=vn,this.file=Cn,this.param=En,this.fileKey=Et.initFile(En,Cn,this.config.enableCache),this.resume()}var wr;return(wr=[{key:"resume",value:function(){var En=this;if(this.uploadState!=="uploading"){this.setUploadState("uploading");var vn=this.config;Gr(this,vn.retryCount,function(Kr){Mn(En,Kr,vn.retryCount,function(){En.setUploadState("ended"),typeof vn.onComplete=="function"&&vn.onComplete(En.param)})})}}},{key:"pause",value:function(){this.setUploadState("paused")}},{key:"abort",value:function(){this.setUploadState("abort"),Et.removeFileInfo(this.fileKey),this.config.onError(new Jr("Upload Aborted",10499))}},{key:"setUploadState",value:function(En){En!==this.uploadState&&(this.uploadState=En)}},{key:"setContext",value:function(En){Et.setUploadContext(this.fileKey,En,this.config.enableCache),this.param.ctx=En}},{key:"setComplete",value:function(){Et.setComplete(this.fileKey,this.config.enableCache),this.setUploadState("ended")}}])&&Qr(jn.prototype,wr),jn}(),Bn={maxFileCache:6,expireTime:864e5,getFileUploadInformation:function(wr){var Cn=Et.getFileKey(wr),En=Et.getFileInfo(Cn);return En===null?null:es()-En.modifyAt>Bn.expireTime?(Et.removeFileInfo(Cn),null):{uploadInfo:Xr({bucketName:En.bucket,objectName:En.obj,token:En.token,ctx:En.ctx},En.payload?{payload:En.payload}:{}),complete:En.end}},setMaxFileCache:function(wr){Bn.maxFileCache=wr},setExpireTime:function(wr){Bn.expireTime=wr},printCaches:function(){for(var wr=0,Cn=Yo(localStorage);wr<Cn.length;wr++){var En=Cn[wr],vn=Et.getFileInfo(En);vn&&console.log(vn,"modifiedAt",new Date(vn.modifyAt).toTimeString())}},createConfig:function(wr){return new _(wr)},createTask:function(wr,Cn,En){return new Vn(wr,Cn,En)}},Eo=Bn;return A.default}()}),xu=s(function(b,w){b.exports=function(){function $(de){if(de){var V,Fe="";return kn(V=Yo(de)).call(V,function(Et,sr){Fe+=sr===0?"?":"&",Fe+=Et+"="+de[Et]}),Fe}return""}function A(de,V,Fe,Et){return Error.call(this,Fe),this.source=de,this.code=V,this.desc=Fe,this.detail=Et||{},this}function _(de,V){var Fe=Qi(V.prototype);Fe.constructor=de,de.prototype=Fe}function Y(de,V){V===void 0&&(V={dataType:"json",method:"GET",timeout:5e3});var Fe=V.dataType==="text"?"text/plain; charset=UTF-8":"application/json; charset=UTF-8",Et=V.method==="GET"?$(V.params):"";return new ro(function(sr,fr){if(window.XMLHttpRequest){var Sr,Tr=new XMLHttpRequest;if(Tr.onreadystatechange=function(){if(Tr.readyState===4)if(Tr.status===200){try{Sr=JSON.parse(Tr.response||"{}")}catch{Sr=Tr.response}sr({status:Tr.status,data:Sr})}else fr(new A(1,Tr.status,Tr.statusText))},Tr.open(V.method,""+de+Et),Tr.timeout=V.timeout||5e3,Tr.setRequestHeader("Content-Type",Fe),V.headers)for(var Pr in V.headers)Tr.setRequestHeader(Pr,V.headers[Pr]);Tr.ontimeout=function(Lr){fr(new A(1,408,Lr&&Lr.message?Lr.message:"request timeout"))},Tr.send(so(V.data))}else fr(new A(2,10400,"request no suppout"))})}return _(A,Error),Y}()}),sl=console,CM={setLogger:function(w){sl=w},platform:"BROWSER",localStorage:window.localStorage,request:xu,WebSocket:window.WebSocket,uploadFile:function(w){return kr(this,void 0,void 0,rr.mark(function $(){var A,_,Y,de,V,Fe;return rr.wrap(function(sr){for(;;)switch(sr.prev=sr.next){case 0:if(w.fileInput||w.file){sr.next=2;break}throw new Error("File not exist");case 2:if(!w.file){sr.next=6;break}de=w.file,sr.next=20;break;case 6:if(typeof w.fileInput!="string"){sr.next=15;break}if(!((V=document.getElementById(w.fileInput))&&V.files&&V.files[0])){sr.next=12;break}de=V.files[0],sr.next=13;break;case 12:throw new Error("Can not get file from fileInput");case 13:sr.next=20;break;case 15:if(!(w.fileInput&&w.fileInput.files&&w.fileInput.files[0])){sr.next=19;break}de=w.fileInput.files[0],sr.next=20;break;case 19:throw new Error("Can not get file from fileInput "+w.fileInput);case 20:if(!(w.maxSize&&de.size>w.maxSize)){sr.next=22;break}throw new Error("The file exceeds maxSize limit. maxSize: "+w.maxSize+", get "+de.size);case 22:return sr.next=24,new ro(function(fr,Sr){var Tr=Xv.createConfig({enableCache:!1,directUploadAddr:w.chunkUploadHost,onError:function(jr){Sr(jr)},onProgress:w.onUploadProgress||function(){},onComplete:function(jr){fr(jr)}}),Pr=Xv.createTask(de,{bucketName:w.nosToken.bucket,objectName:decodeURIComponent(w.nosToken.objectName),token:w.nosToken.token},Tr);try{w.onUploadStart&&w.onUploadStart(Pr)}catch(Lr){sl.error("Adapter uploadFile: options.onUploadStart error",Lr&&Lr.message),Pr.abort(),Sr(Lr)}});case 24:return(Fe=sr.sent).name=de.name,Fe.size=de.size,Fe.type=de.type,Fe.ext=Yv(A=Fe.name).call(A,".")>-1?fo(_=Fe.name).call(_,Yv(Y=Fe.name).call(Y,".")+1).toLowerCase():"",sr.abrupt("return",Fe);case 30:case"end":return sr.stop()}},$)}))},getSystemInfo:function(){var w,$;return{os:((w=Bc.os)===null||w===void 0?void 0:w.family)||"",osVer:(($=Bc.os)===null||$===void 0?void 0:$.version)||"",browser:Bc.name||"",browserVer:Bc.version||"",hostEnv:"BROWSER",hostEnvVer:Bc.version||"",hostInfo:Bc.ua||""}}};return Yd.setAdapters(CM),Yd})})(QCHAT_BROWSER_SDK);var QCHAT_BROWSER_SDKExports=QCHAT_BROWSER_SDK.exports;const QChatSDK=getDefaultExportFromCjs(QCHAT_BROWSER_SDKExports);var NIM_BROWSER_SDK={exports:{}};(function(t,n){(function(e,r){t.exports=r()})(commonjsGlobal,function(){var e=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof commonjsGlobal<"u"?commonjsGlobal:typeof self<"u"?self:{};function r(x){return x&&x.__esModule&&Object.prototype.hasOwnProperty.call(x,"default")?x.default:x}function s(x){var T={exports:{}};return x(T,T.exports),T.exports}var i,o,a=r(s(function(x){x.exports=function(F){if(F===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return F},x.exports.__esModule=!0,x.exports.default=x.exports})),d=function(x){return x&&x.Math==Math&&x},c=d(typeof globalThis=="object"&&globalThis)||d(typeof window=="object"&&window)||d(typeof self=="object"&&self)||d(typeof e=="object"&&e)||function(){return this}()||Function("return this")(),u=function(x){try{return!!x()}catch{return!0}},m=!u(function(){var x=(function(){}).bind();return typeof x!="function"||x.hasOwnProperty("prototype")}),y=Function.prototype,S=y.apply,O=y.call,k=typeof Reflect=="object"&&Reflect.apply||(m?O.bind(S):function(){return O.apply(S,arguments)}),g=Function.prototype,v=g.bind,ue=g.call,L=m&&v.bind(ue,ue),re=m?function(x){return x&&L(x)}:function(x){return x&&function(){return ue.apply(x,arguments)}},le=function(x){return typeof x=="function"},oe=!u(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!=7}),he=Function.prototype.call,Ie=m?he.bind(he):function(){return he.apply(he,arguments)},ie={}.propertyIsEnumerable,Ne=Object.getOwnPropertyDescriptor,Ve={f:Ne&&!ie.call({1:2},1)?function(T){var F=Ne(this,T);return!!F&&F.enumerable}:ie},Ce=function(x,T){return{enumerable:!(1&x),configurable:!(2&x),writable:!(4&x),value:T}},Ue=re({}.toString),qe=re("".slice),Oe=function(x){return qe(Ue(x),8,-1)},$e=Object,_e=re("".split),er=u(function(){return!$e("z").propertyIsEnumerable(0)})?function(x){return Oe(x)=="String"?_e(x,""):$e(x)}:$e,Pt=function(x){return x==null},ar=TypeError,pr=function(x){if(Pt(x))throw ar("Can't call method on "+x);return x},lr=function(x){return er(pr(x))},or=typeof document=="object"&&document.all,xe=or===void 0&&or!==void 0?function(x){return typeof x=="object"?x!==null:le(x)||x===or}:function(x){return typeof x=="object"?x!==null:le(x)},nr={},ir=function(x){return le(x)?x:void 0},dr=function(x,T){return arguments.length<2?ir(nr[x])||ir(c[x]):nr[x]&&nr[x][T]||c[x]&&c[x][T]},Lt=re({}.isPrototypeOf),cr=dr("navigator","userAgent")||"",mr=c.process,tr=c.Deno,At=mr&&mr.versions||tr&&tr.version,kt=At&&At.v8;kt&&(o=(i=kt.split("."))[0]>0&&i[0]<4?1:+(i[0]+i[1])),!o&&cr&&(!(i=cr.match(/Edge\/(\d+)/))||i[1]>=74)&&(i=cr.match(/Chrome\/(\d+)/))&&(o=+i[1]);var Dt,gr=o,yr=!!Object.getOwnPropertySymbols&&!u(function(){var x=Symbol();return!String(x)||!(Object(x)instanceof Symbol)||!Symbol.sham&&gr&&gr<41}),vr=yr&&!Symbol.sham&&typeof Symbol.iterator=="symbol",Ir=Object,Mr=vr?function(x){return typeof x=="symbol"}:function(x){var T=dr("Symbol");return le(T)&&Lt(T.prototype,Ir(x))},Ar=String,Fr=function(x){try{return Ar(x)}catch{return"Object"}},Dr=TypeError,Or=function(x){if(le(x))return x;throw Dr(Fr(x)+" is not a function")},Sn=function(x,T){var F=x[T];return Pt(F)?void 0:Or(F)},Rr=TypeError,Wr=Object.defineProperty,Er="__core-js_shared__",Ur=c[Er]||function(x,T){try{Wr(c,x,{value:T,configurable:!0,writable:!0})}catch{c[x]=T}return T}(Er,{}),Zr=s(function(x){(x.exports=function(T,F){return Ur[T]||(Ur[T]=F!==void 0?F:{})})("versions",[]).push({version:"3.25.0",mode:"pure",copyright:"© 2014-2022 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.25.0/LICENSE",source:"https://github.com/zloirock/core-js"})}),In=Object,An=function(x){return In(pr(x))},Zn=re({}.hasOwnProperty),Nn=Object.hasOwn||function(T,F){return Zn(An(T),F)},Gi=0,Iu=Math.random(),Ki=re(1 .toString),yi=function(x){return"Symbol("+(x===void 0?"":x)+")_"+Ki(++Gi+Iu,36)},Ro=Zr("wks"),Lo=c.Symbol,Ai=Lo&&Lo.for,As=vr?Lo:Lo&&Lo.withoutSetter||yi,Yn=function(x){if(!Nn(Ro,x)||!yr&&typeof Ro[x]!="string"){var T="Symbol."+x;yr&&Nn(Lo,x)?Ro[x]=Lo[x]:Ro[x]=vr&&Ai?Ai(T):As(T)}return Ro[x]},Ks=TypeError,On=Yn("toPrimitive"),Qo=function(x,T){if(!xe(x)||Mr(x))return x;var F,D=Sn(x,On);if(D){if(T===void 0&&(T="default"),F=Ie(D,x,T),!xe(F)||Mr(F))return F;throw Ks("Can't convert object to primitive value")}return T===void 0&&(T="number"),function(M,z){var pe,ae;if(z==="string"&&le(pe=M.toString)&&!xe(ae=Ie(pe,M))||le(pe=M.valueOf)&&!xe(ae=Ie(pe,M))||z!=="string"&&le(pe=M.toString)&&!xe(ae=Ie(pe,M)))return ae;throw Rr("Can't convert object to primitive value")}(x,T)},ei=function(x){var T=Qo(x,"string");return Mr(T)?T:T+""},vi=c.document,wi=xe(vi)&&xe(vi.createElement),Io=function(x){return wi?vi.createElement(x):{}},eo=!oe&&!u(function(){return Object.defineProperty(Io("div"),"a",{get:function(){return 7}}).a!=7}),Mi=Object.getOwnPropertyDescriptor,Ii={f:oe?Mi:function(T,F){if(T=lr(T),F=ei(F),eo)try{return Mi(T,F)}catch{}if(Nn(T,F))return Ce(!Ie(Ve.f,T,F),T[F])}},_u=/#|\.prototype\./,ws=function(x,T){var F=$o[na(x)];return F==al||F!=Os&&(le(T)?u(T):!!T)},na=ws.normalize=function(x){return String(x).replace(_u,".").toLowerCase()},$o=ws.data={},Os=ws.NATIVE="N",al=ws.POLYFILL="P",Ua=ws,Tc=re(re.bind),_o=function(x,T){return Or(x),T===void 0?x:m?Tc(x,T):function(){return x.apply(T,arguments)}},pf=oe&&u(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!=42}),nb=String,ob=TypeError,Dn=function(x){if(xe(x))return x;throw ob(nb(x)+" is not an object")},ib=TypeError,cl=Object.defineProperty,sb=Object.getOwnPropertyDescriptor,ab="enumerable",cb="configurable",ub="writable",ii={f:oe?pf?function(T,F,D){if(Dn(T),F=ei(F),Dn(D),typeof T=="function"&&F==="prototype"&&"value"in D&&ub in D&&!D.writable){var M=sb(T,F);M&&M.writable&&(T[F]=D.value,D={configurable:cb in D?D.configurable:M.configurable,enumerable:ab in D?D.enumerable:M.enumerable,writable:!1})}return cl(T,F,D)}:cl:function(T,F,D){if(Dn(T),F=ei(F),Dn(D),eo)try{return cl(T,F,D)}catch{}if("get"in D||"set"in D)throw ib("Accessors not supported");return"value"in D&&(T[F]=D.value),T}},Ho=oe?function(x,T,F){return ii.f(x,T,Ce(1,F))}:function(x,T,F){return x[T]=F,x},lb=Ii.f,db=function(x){var T=function(F,D,M){if(this instanceof T){switch(arguments.length){case 0:return new x;case 1:return new x(F);case 2:return new x(F,D)}return new x(F,D,M)}return k(x,this,arguments)};return T.prototype=x.prototype,T},qr=function(x,T){var F,D,M,z,pe,ae,ze,jt,ur=x.target,hr=x.global,br=x.stat,Cr=x.proto,_r=hr?c:br?c[ur]:(c[ur]||{}).prototype,Nr=hr?nr:nr[ur]||Ho(nr,ur,{})[ur],Br=Nr.prototype;for(M in T)F=!Ua(hr?M:ur+(br?".":"#")+M,x.forced)&&_r&&Nn(_r,M),pe=Nr[M],F&&(ae=x.dontCallGetSet?(jt=lb(_r,M))&&jt.value:_r[M]),z=F&&ae?ae:T[M],F&&typeof pe==typeof z||(ze=x.bind&&F?_o(z,c):x.wrap&&F?db(z):Cr&&le(z)?re(z):z,(x.sham||z&&z.sham||pe&&pe.sham)&&Ho(ze,"sham",!0),Ho(Nr,M,ze),Cr&&(Nn(nr,D=ur+"Prototype")||Ho(nr,D,{}),Ho(nr[D],M,z),x.real&&Br&&!Br[M]&&Ho(Br,M,z)))},pb=Math.ceil,fb=Math.floor,mb=Math.trunc||function(T){var F=+T;return(F>0?fb:pb)(F)},Da=function(x){var T=+x;return T!=T||T===0?0:mb(T)},gb=Math.max,hb=Math.min,oa=function(x,T){var F=Da(x);return F<0?gb(F+T,0):hb(F,T)},yb=Math.min,Ci=function(x){return(T=x.length)>0?yb(Da(T),9007199254740991):0;var T},ff=function(x){return function(T,F,D){var M,z=lr(T),pe=Ci(z),ae=oa(D,pe);if(x&&F!=F){for(;pe>ae;)if((M=z[ae++])!=M)return!0}else for(;pe>ae;ae++)if((x||ae in z)&&z[ae]===F)return x||ae||0;return!x&&-1}},ul={includes:ff(!0),indexOf:ff(!1)},ia={},vb=ul.indexOf,mf=re([].push),gf=function(x,T){var F,D=lr(x),M=0,z=[];for(F in D)!Nn(ia,F)&&Nn(D,F)&&mf(z,F);for(;T.length>M;)Nn(D,F=T[M++])&&(~vb(z,F)||mf(z,F));return z},qc=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],ps=Object.keys||function(T){return gf(T,qc)},bb=oe&&!pf?Object.defineProperties:function(T,F){Dn(T);for(var D,M=lr(F),z=ps(F),pe=z.length,ae=0;pe>ae;)ii.f(T,D=z[ae++],M[D]);return T},hf={f:bb},ll=dr("document","documentElement"),yf=Zr("keys"),$c=function(x){return yf[x]||(yf[x]=yi(x))},vf=$c("IE_PROTO"),dl=function(){},bf=function(x){return"<script>"+x+"<\/script>"},Tf=function(x){x.write(bf("")),x.close();var T=x.parentWindow.Object;return x=null,T},Hc=function(){try{Dt=new ActiveXObject("htmlfile")}catch{}var x,T;Hc=typeof document<"u"?document.domain&&Dt?Tf(Dt):((T=Io("iframe")).style.display="none",ll.appendChild(T),T.src="javascript:",(x=T.contentWindow.document).open(),x.write(bf("document.F=Object")),x.close(),x.F):Tf(Dt);for(var F=qc.length;F--;)delete Hc.prototype[qc[F]];return Hc()};ia[vf]=!0;var ki=Object.create||function(T,F){var D;return T!==null?(dl.prototype=Dn(T),D=new dl,dl.prototype=null,D[vf]=T):D=Hc(),F===void 0?D:hf.f(D,F)};qr({target:"Object",stat:!0,sham:!oe},{create:ki});var Tb=nr.Object,Qi=function(T,F){return Tb.create(T,F)},Sb=String,Mb=TypeError,qa=Object.setPrototypeOf||("__proto__"in{}?function(){var x,T=!1,F={};try{(x=re(Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set))(F,[]),T=F instanceof Array}catch{}return function(M,z){return Dn(M),function(pe){if(typeof pe=="object"||le(pe))return pe;throw Mb("Can't set "+Sb(pe)+" as a prototype")}(z),T?x(M,z):M.__proto__=z,M}}():void 0);qr({target:"Object",stat:!0},{setPrototypeOf:qa});var Rs=nr.Object.setPrototypeOf,fs=re([].slice),Sf=Function,Cb=re([].concat),kb=re([].join),pl={},xb=function(x,T,F){if(!Nn(pl,T)){for(var D=[],M=0;M<T;M++)D[M]="a["+M+"]";pl[T]=Sf("C,a","return new C("+kb(D,",")+")")}return pl[T](x,F)},fl=m?Sf.bind:function(T){var F=Or(this),D=F.prototype,M=fs(arguments,1),z=function(){var ae=Cb(M,fs(arguments));return this instanceof z?xb(F,ae.length,ae):F.apply(T,ae)};return xe(D)&&(z.prototype=D),z};qr({target:"Function",proto:!0,forced:Function.bind!==fl},{bind:fl});var Ao=function(x){return nr[x+"Prototype"]},wb=Ao("Function").bind,ml=Function.prototype,Mo=function(x){var T=x.bind;return x===ml||Lt(ml,x)&&T===ml.bind?wb:T},gl=s(function(x){function T(F,D){var M;return x.exports=T=Rs?Mo(M=Rs).call(M):function(pe,ae){return pe.__proto__=ae,pe},x.exports.__esModule=!0,x.exports.default=x.exports,T(F,D)}x.exports=T,x.exports.__esModule=!0,x.exports.default=x.exports}),Co=r(s(function(x){x.exports=function(F,D){F.prototype=Qi(D.prototype),F.prototype.constructor=F,gl(F,D)},x.exports.__esModule=!0,x.exports.default=x.exports})),Ji=Array.isArray||function(T){return Oe(T)=="Array"},Ib=TypeError,hl=function(x){if(x>9007199254740991)throw Ib("Maximum allowed index exceeded");return x},Ns=function(x,T,F){var D=ei(T);D in x?ii.f(x,D,Ce(0,F)):x[D]=F},Mf={};Mf[Yn("toStringTag")]="z";var yl=String(Mf)==="[object z]",_b=Yn("toStringTag"),Eb=Object,Pb=Oe(function(){return arguments}())=="Arguments",Fs=yl?Oe:function(x){var T,F,D;return x===void 0?"Undefined":x===null?"Null":typeof(F=function(M,z){try{return M[z]}catch{}}(T=Eb(x),_b))=="string"?F:Pb?Oe(T):(D=Oe(T))=="Object"&&le(T.callee)?"Arguments":D},Ab=re(Function.toString);le(Ur.inspectSource)||(Ur.inspectSource=function(x){return Ab(x)});var Cf=Ur.inspectSource,kf=function(){},Ob=[],xf=dr("Reflect","construct"),vl=/^\s*(?:class|function)\b/,Rb=re(vl.exec),Nb=!vl.exec(kf),$a=function(T){if(!le(T))return!1;try{return xf(kf,Ob,T),!0}catch{return!1}},wf=function(T){if(!le(T))return!1;switch(Fs(T)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return Nb||!!Rb(vl,Cf(T))}catch{return!0}};wf.sham=!0;var Vc=!xf||u(function(){var x;return $a($a.call)||!$a(Object)||!$a(function(){x=!0})||x})?wf:$a,Fb=Yn("species"),If=Array,bl=function(x,T){return new(function(F){var D;return Ji(F)&&(D=F.constructor,(Vc(D)&&(D===If||Ji(D.prototype))||xe(D)&&(D=D[Fb])===null)&&(D=void 0)),D===void 0?If:D}(x))(T===0?0:T)},jb=Yn("species"),Ha=function(x){return gr>=51||!u(function(){var T=[];return(T.constructor={})[jb]=function(){return{foo:1}},T[x](Boolean).foo!==1})},_f=Yn("isConcatSpreadable"),Bb=gr>=51||!u(function(){var x=[];return x[_f]=!1,x.concat()[0]!==x}),Lb=Ha("concat"),Ub=function(x){if(!xe(x))return!1;var T=x[_f];return T!==void 0?!!T:Ji(x)};qr({target:"Array",proto:!0,arity:1,forced:!Bb||!Lb},{concat:function(T){var F,D,M,z,pe,ae=An(this),ze=bl(ae,0),jt=0;for(F=-1,M=arguments.length;F<M;F++)if(Ub(pe=F===-1?ae:arguments[F]))for(z=Ci(pe),hl(jt+z),D=0;D<z;D++,jt++)D in pe&&Ns(ze,jt,pe[D]);else hl(jt+1),Ns(ze,jt++,pe);return ze.length=jt,ze}});var zc,Va,Wc,Db=String,_i=function(x){if(Fs(x)==="Symbol")throw TypeError("Cannot convert a Symbol value to a string");return Db(x)},qb=qc.concat("length","prototype"),za={f:Object.getOwnPropertyNames||function(T){return gf(T,qb)}},$b=Array,Hb=Math.max,Tl=function(x,T,F){for(var D=Ci(x),M=oa(T,D),z=oa(F===void 0?D:F,D),pe=$b(Hb(z-M,0)),ae=0;M<z;M++,ae++)Ns(pe,ae,x[M]);return pe.length=ae,pe},Ef=za.f,Pf=typeof window=="object"&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],Sl={f:function(T){return Pf&&Oe(T)=="Window"?function(F){try{return Ef(F)}catch{return Tl(Pf)}}(T):Ef(lr(T))}},Wa={f:Object.getOwnPropertySymbols},ms=function(x,T,F,D){return D&&D.enumerable?x[T]=F:Ho(x,T,F),x},Ml={f:Yn},Vb=ii.f,ho=function(x){var T=nr.Symbol||(nr.Symbol={});Nn(T,x)||Vb(T,x,{value:Ml.f(x)})},Af=function(){var x=dr("Symbol"),T=x&&x.prototype,F=T&&T.valueOf,D=Yn("toPrimitive");T&&!T[D]&&ms(T,D,function(M){return Ie(F,this)},{arity:1})},zb=yl?{}.toString:function(){return"[object "+Fs(this)+"]"},Wb=ii.f,Of=Yn("toStringTag"),js=function(x,T,F,D){if(x){var M=F?x:x.prototype;Nn(M,Of)||Wb(M,Of,{configurable:!0,value:T}),D&&!yl&&Ho(M,"toString",zb)}},Rf=c.WeakMap,Gb=le(Rf)&&/native code/.test(String(Rf)),Nf="Object already initialized",Cl=c.TypeError,Kb=c.WeakMap;if(Gb||Ur.state){var Bs=Ur.state||(Ur.state=new Kb),Qb=re(Bs.get),Ff=re(Bs.has),Jb=re(Bs.set);zc=function(x,T){if(Ff(Bs,x))throw Cl(Nf);return T.facade=x,Jb(Bs,x,T),T},Va=function(x){return Qb(Bs,x)||{}},Wc=function(x){return Ff(Bs,x)}}else{var sa=$c("state");ia[sa]=!0,zc=function(x,T){if(Nn(x,sa))throw Cl(Nf);return T.facade=x,Ho(x,sa,T),T},Va=function(x){return Nn(x,sa)?x[sa]:{}},Wc=function(x){return Nn(x,sa)}}var xi={set:zc,get:Va,has:Wc,enforce:function(x){return Wc(x)?Va(x):zc(x,{})},getterFor:function(x){return function(T){var F;if(!xe(T)||(F=Va(T)).type!==x)throw Cl("Incompatible receiver, "+x+" required");return F}}},jf=re([].push),gs=function(x){var T=x==1,F=x==2,D=x==3,M=x==4,z=x==6,pe=x==7,ae=x==5||z;return function(ze,jt,ur,hr){for(var br,Cr,_r=An(ze),Nr=er(_r),Br=_o(jt,ur),Hr=Ci(Nr),$r=0,Vr=hr||bl,bn=T?Vr(ze,Hr):F||pe?Vr(ze,0):void 0;Hr>$r;$r++)if((ae||$r in Nr)&&(Cr=Br(br=Nr[$r],$r,_r),x))if(T)bn[$r]=Cr;else if(Cr)switch(x){case 3:return!0;case 5:return br;case 6:return $r;case 2:jf(bn,br)}else switch(x){case 4:return!1;case 7:jf(bn,br)}return z?-1:D||M?M:bn}},hs={forEach:gs(0),map:gs(1),filter:gs(2),some:gs(3),every:gs(4),find:gs(5),findIndex:gs(6),filterReject:gs(7)},Gc=hs.forEach,si=$c("hidden"),Kc="Symbol",Yb=xi.set,Bf=xi.getterFor(Kc),Oi=Object.prototype,Ls=c.Symbol,Ga=Ls&&Ls.prototype,Xb=c.TypeError,kl=c.QObject,Lf=Ii.f,ys=ii.f,Uf=Sl.f,Zb=Ve.f,Df=re([].push),Yi=Zr("symbols"),Ka=Zr("op-symbols"),e0=Zr("wks"),xl=!kl||!kl.prototype||!kl.prototype.findChild,wl=oe&&u(function(){return ki(ys({},"a",{get:function(){return ys(this,"a",{value:7}).a}})).a!=7})?function(x,T,F){var D=Lf(Oi,T);D&&delete Oi[T],ys(x,T,F),D&&x!==Oi&&ys(Oi,T,D)}:ys,Il=function(x,T){var F=Yi[x]=ki(Ga);return Yb(F,{type:Kc,tag:x,description:T}),oe||(F.description=T),F},Qc=function(T,F,D){T===Oi&&Qc(Ka,F,D),Dn(T);var M=ei(F);return Dn(D),Nn(Yi,M)?(D.enumerable?(Nn(T,si)&&T[si][M]&&(T[si][M]=!1),D=ki(D,{enumerable:Ce(0,!1)})):(Nn(T,si)||ys(T,si,Ce(1,{})),T[si][M]=!0),wl(T,M,D)):ys(T,M,D)},_l=function(T,F){Dn(T);var D=lr(F),M=ps(D).concat(Vf(D));return Gc(M,function(z){oe&&!Ie(qf,D,z)||Qc(T,z,D[z])}),T},qf=function(T){var F=ei(T),D=Ie(Zb,this,F);return!(this===Oi&&Nn(Yi,F)&&!Nn(Ka,F))&&(!(D||!Nn(this,F)||!Nn(Yi,F)||Nn(this,si)&&this[si][F])||D)},$f=function(T,F){var D=lr(T),M=ei(F);if(D!==Oi||!Nn(Yi,M)||Nn(Ka,M)){var z=Lf(D,M);return!z||!Nn(Yi,M)||Nn(D,si)&&D[si][M]||(z.enumerable=!0),z}},Hf=function(T){var F=Uf(lr(T)),D=[];return Gc(F,function(M){Nn(Yi,M)||Nn(ia,M)||Df(D,M)}),D},Vf=function(x){var T=x===Oi,F=Uf(T?Ka:lr(x)),D=[];return Gc(F,function(M){!Nn(Yi,M)||T&&!Nn(Oi,M)||Df(D,Yi[M])}),D};yr||(Ls=function(){if(Lt(Ga,this))throw Xb("Symbol is not a constructor");var T=arguments.length&&arguments[0]!==void 0?_i(arguments[0]):void 0,F=yi(T),D=function(M){this===Oi&&Ie(D,Ka,M),Nn(this,si)&&Nn(this[si],F)&&(this[si][F]=!1),wl(this,F,Ce(1,M))};return oe&&xl&&wl(Oi,F,{configurable:!0,set:D}),Il(F,T)},Ga=Ls.prototype,ms(Ga,"toString",function(){return Bf(this).tag}),ms(Ls,"withoutSetter",function(x){return Il(yi(x),x)}),Ve.f=qf,ii.f=Qc,hf.f=_l,Ii.f=$f,za.f=Sl.f=Hf,Wa.f=Vf,Ml.f=function(x){return Il(Yn(x),x)},oe&&ys(Ga,"description",{configurable:!0,get:function(){return Bf(this).description}})),qr({global:!0,constructor:!0,wrap:!0,forced:!yr,sham:!yr},{Symbol:Ls}),Gc(ps(e0),function(x){ho(x)}),qr({target:Kc,stat:!0,forced:!yr},{useSetter:function(){xl=!0},useSimple:function(){xl=!1}}),qr({target:"Object",stat:!0,forced:!yr,sham:!oe},{create:function(T,F){return F===void 0?ki(T):_l(ki(T),F)},defineProperty:Qc,defineProperties:_l,getOwnPropertyDescriptor:$f}),qr({target:"Object",stat:!0,forced:!yr},{getOwnPropertyNames:Hf}),Af(),js(Ls,Kc),ia[si]=!0;var zf=yr&&!!Symbol.for&&!!Symbol.keyFor,El=Zr("string-to-symbol-registry"),t0=Zr("symbol-to-string-registry");qr({target:"Symbol",stat:!0,forced:!zf},{for:function(x){var T=_i(x);if(Nn(El,T))return El[T];var F=dr("Symbol")(T);return El[T]=F,t0[F]=T,F}});var Wf=Zr("symbol-to-string-registry");qr({target:"Symbol",stat:!0,forced:!zf},{keyFor:function(T){if(!Mr(T))throw TypeError(Fr(T)+" is not a symbol");if(Nn(Wf,T))return Wf[T]}});var vs=dr("JSON","stringify"),Jc=re(/./.exec),Gf=re("".charAt),r0=re("".charCodeAt),n0=re("".replace),o0=re(1 .toString),i0=/[\uD800-\uDFFF]/g,Kf=/^[\uD800-\uDBFF]$/,Qf=/^[\uDC00-\uDFFF]$/,Jf=!yr||u(function(){var x=dr("Symbol")();return vs([x])!="[null]"||vs({a:x})!="{}"||vs(Object(x))!="{}"}),Yf=u(function(){return vs("\uDF06\uD834")!=='"\\udf06\\ud834"'||vs("\uDEAD")!=='"\\udead"'}),s0=function(x,T){var F=fs(arguments),D=T;if((xe(T)||x!==void 0)&&!Mr(x))return Ji(T)||(T=function(M,z){if(le(D)&&(z=Ie(D,this,M,z)),!Mr(z))return z}),F[1]=T,k(vs,null,F)},a0=function(x,T,F){var D=Gf(F,T-1),M=Gf(F,T+1);return Jc(Kf,x)&&!Jc(Qf,M)||Jc(Qf,x)&&!Jc(Kf,D)?"\\u"+o0(r0(x,0),16):x};vs&&qr({target:"JSON",stat:!0,arity:3,forced:Jf||Yf},{stringify:function(T,F,D){var M=fs(arguments),z=k(Jf?s0:vs,null,M);return Yf&&typeof z=="string"?n0(z,i0,a0):z}});var c0=!yr||u(function(){Wa.f(1)});qr({target:"Object",stat:!0,forced:c0},{getOwnPropertySymbols:function(T){var F=Wa.f;return F?F(An(T)):[]}}),ho("asyncIterator"),ho("hasInstance"),ho("isConcatSpreadable"),ho("iterator"),ho("match"),ho("matchAll"),ho("replace"),ho("search"),ho("species"),ho("split"),ho("toPrimitive"),Af(),ho("toStringTag"),js(dr("Symbol"),"Symbol"),ho("unscopables"),js(c.JSON,"JSON",!0);var bs,Xf,Zf,u0=nr.Symbol,Xi={},em=Function.prototype,l0=oe&&Object.getOwnPropertyDescriptor,Pl=Nn(em,"name"),d0={EXISTS:Pl,PROPER:Pl&&(function(){}).name==="something",CONFIGURABLE:Pl&&(!oe||oe&&l0(em,"name").configurable)},tm=!u(function(){function x(){}return x.prototype.constructor=null,Object.getPrototypeOf(new x)!==x.prototype}),rm=$c("IE_PROTO"),Al=Object,p0=Al.prototype,aa=tm?Al.getPrototypeOf:function(x){var T=An(x);if(Nn(T,rm))return T[rm];var F=T.constructor;return le(F)&&T instanceof F?F.prototype:T instanceof Al?p0:null},Ol=Yn("iterator"),nm=!1;[].keys&&("next"in(Zf=[].keys())?(Xf=aa(aa(Zf)))!==Object.prototype&&(bs=Xf):nm=!0);var f0=!xe(bs)||u(function(){var x={};return bs[Ol].call(x)!==x});bs=f0?{}:ki(bs),le(bs[Ol])||ms(bs,Ol,function(){return this});var om={IteratorPrototype:bs,BUGGY_SAFARI_ITERATORS:nm},m0=om.IteratorPrototype,g0=function(){return this},h0=d0.PROPER,Yc=om.BUGGY_SAFARI_ITERATORS,Rl=Yn("iterator"),im="keys",Xc="values",sm="entries",y0=function(){return this},Nl=function(x,T,F,D,M,z,pe){(function(Hr,$r,Vr,bn){var Wn=$r+" Iterator";Hr.prototype=ki(m0,{next:Ce(+!bn,Vr)}),js(Hr,Wn,!1,!0),Xi[Wn]=g0})(F,T,D);var ae,ze,jt,ur=function(Hr){if(Hr===M&&Nr)return Nr;if(!Yc&&Hr in Cr)return Cr[Hr];switch(Hr){case im:return function(){return new F(this,Hr)};case Xc:return function(){return new F(this,Hr)};case sm:return function(){return new F(this,Hr)}}return function(){return new F(this)}},hr=T+" Iterator",br=!1,Cr=x.prototype,_r=Cr[Rl]||Cr["@@iterator"]||M&&Cr[M],Nr=!Yc&&_r||ur(M),Br=T=="Array"&&Cr.entries||_r;if(Br&&(ae=aa(Br.call(new x)))!==Object.prototype&&ae.next&&(js(ae,hr,!0,!0),Xi[hr]=y0),h0&&M==Xc&&_r&&_r.name!==Xc&&(br=!0,Nr=function(){return Ie(_r,this)}),M)if(ze={values:ur(Xc),keys:z?Nr:ur(im),entries:ur(sm)},pe)for(jt in ze)(Yc||br||!(jt in Cr))&&ms(Cr,jt,ze[jt]);else qr({target:T,proto:!0,forced:Yc||br},ze);return pe&&Cr[Rl]!==Nr&&ms(Cr,Rl,Nr,{name:M}),Xi[T]=Nr,ze};ii.f;var am="Array Iterator",v0=xi.set,b0=xi.getterFor(am);Nl(Array,"Array",function(x,T){v0(this,{type:am,target:lr(x),index:0,kind:T})},function(){var x=b0(this),T=x.target,F=x.kind,D=x.index++;return!T||D>=T.length?(x.target=void 0,{value:void 0,done:!0}):F=="keys"?{value:D,done:!1}:F=="values"?{value:T[D],done:!1}:{value:[D,T[D]],done:!1}},"values"),Xi.Arguments=Xi.Array;var cm=Yn("toStringTag");for(var Fl in{CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}){var um=c[Fl],jl=um&&um.prototype;jl&&Fs(jl)!==cm&&Ho(jl,cm,Fl),Xi[Fl]=Xi.Array}var T0=u0;ho("asyncDispose"),ho("dispose"),ho("matcher"),ho("metadataKey"),ho("observable"),ho("metadata"),ho("patternMatch"),ho("replaceAll");var li=T0,S0=re("".charAt),lm=re("".charCodeAt),M0=re("".slice),dm=function(x){return function(T,F){var D,M,z=_i(pr(T)),pe=Da(F),ae=z.length;return pe<0||pe>=ae?x?"":void 0:(D=lm(z,pe))<55296||D>56319||pe+1===ae||(M=lm(z,pe+1))<56320||M>57343?x?S0(z,pe):D:x?M0(z,pe,pe+2):M-56320+(D-55296<<10)+65536}},C0={codeAt:dm(!1),charAt:dm(!0)}.charAt,pm="String Iterator",k0=xi.set,x0=xi.getterFor(pm);Nl(String,"String",function(x){k0(this,{type:pm,string:_i(x),index:0})},function(){var T,F=x0(this),D=F.string,M=F.index;return M>=D.length?{value:void 0,done:!0}:(T=C0(D,M),F.index+=T.length,{value:T,done:!1})});var fm=Ml.f("iterator"),w0=s(function(x){function T(F){return x.exports=T=typeof li=="function"&&typeof fm=="symbol"?function(D){return typeof D}:function(D){return D&&typeof li=="function"&&D.constructor===li&&D!==li.prototype?"symbol":typeof D},x.exports.__esModule=!0,x.exports.default=x.exports,T(F)}x.exports=T,x.exports.__esModule=!0,x.exports.default=x.exports}),mm=ii.f;qr({target:"Object",stat:!0,forced:Object.defineProperty!==mm,sham:!oe},{defineProperty:mm});var I0=s(function(x){var T=nr.Object,F=x.exports=function(M,z,pe){return T.defineProperty(M,z,pe)};T.defineProperty.sham&&(F.sham=!0)}),Qa=I0,_0=u(function(){aa(1)});qr({target:"Object",stat:!0,forced:_0,sham:!tm},{getPrototypeOf:function(T){return aa(An(T))}});var Us=nr.Object.getPrototypeOf,Ds=function(x,T){var F=[][x];return!!F&&u(function(){F.call(null,T||function(){return 1},1)})},E0=hs.forEach,gm=Ds("forEach")?[].forEach:function(T){return E0(this,T,arguments.length>1?arguments[1]:void 0)};qr({target:"Array",proto:!0,forced:[].forEach!=gm},{forEach:gm});var P0=Ao("Array").forEach,Bl=Array.prototype,A0={DOMTokenList:!0,NodeList:!0},kn=function(x){var T=x.forEach;return x===Bl||Lt(Bl,x)&&T===Bl.forEach||Nn(A0,Fs(x))?P0:T},O0=re([].concat),R0=dr("Reflect","ownKeys")||function(T){var F=za.f(Dn(T)),D=Wa.f;return D?O0(F,D(T)):F},hm=Error,N0=re("".replace),F0=String(hm("zxcasd").stack),ym=/\n\s*at [^:]*:[^\n]*/,j0=ym.test(F0),B0=function(x,T){if(j0&&typeof x=="string"&&!hm.prepareStackTrace)for(;T--;)x=N0(x,ym,"");return x},L0=function(x,T){xe(T)&&"cause"in T&&Ho(x,"cause",T.cause)},U0=Yn("iterator"),D0=Array.prototype,vm=function(x){return x!==void 0&&(Xi.Array===x||D0[U0]===x)},q0=Yn("iterator"),Zc=function(x){if(!Pt(x))return Sn(x,q0)||Sn(x,"@@iterator")||Xi[Fs(x)]},$0=TypeError,Ja=function(x,T){var F=arguments.length<2?Zc(x):T;if(Or(F))return Dn(Ie(F,x));throw $0(Fr(x)+" is not iterable")},Ll=function(x,T,F){var D,M;Dn(x);try{if(!(D=Sn(x,"return"))){if(T==="throw")throw F;return F}D=Ie(D,x)}catch(z){M=!0,D=z}if(T==="throw")throw F;if(M)throw D;return Dn(D),F},H0=TypeError,eu=function(x,T){this.stopped=x,this.result=T},bm=eu.prototype,to=function(x,T,F){var D,M,z,pe,ae,ze,jt,ur=F&&F.that,hr=!(!F||!F.AS_ENTRIES),br=!(!F||!F.IS_RECORD),Cr=!(!F||!F.IS_ITERATOR),_r=!(!F||!F.INTERRUPTED),Nr=_o(T,ur),Br=function($r){return D&&Ll(D,"normal",$r),new eu(!0,$r)},Hr=function($r){return hr?(Dn($r),_r?Nr($r[0],$r[1],Br):Nr($r[0],$r[1])):_r?Nr($r,Br):Nr($r)};if(br)D=x.iterator;else if(Cr)D=x;else{if(!(M=Zc(x)))throw H0(Fr(x)+" is not iterable");if(vm(M)){for(z=0,pe=Ci(x);pe>z;z++)if((ae=Hr(x[z]))&&Lt(bm,ae))return ae;return new eu(!1)}D=Ja(x,M)}for(ze=br?x.next:D.next;!(jt=Ie(ze,D)).done;){try{ae=Hr(jt.value)}catch($r){Ll(D,"throw",$r)}if(typeof ae=="object"&&ae&&Lt(bm,ae))return ae}return new eu(!1)},V0=function(x,T){return x===void 0?arguments.length<2?"":T:_i(x)},z0=!u(function(){var x=Error("a");return!("stack"in x)||(Object.defineProperty(x,"stack",Ce(1,7)),x.stack!==7)}),W0=Yn("toStringTag"),tu=Error,G0=[].push,Ya=function(T,F){var D,M=arguments.length>2?arguments[2]:void 0,z=Lt(Ul,this);qa?D=qa(tu(),z?aa(this):Ul):(D=z?this:ki(Ul),Ho(D,W0,"Error")),F!==void 0&&Ho(D,"message",V0(F)),z0&&Ho(D,"stack",B0(D.stack,1)),L0(D,M);var pe=[];return to(T,G0,{that:pe}),Ho(D,"errors",pe),D};qa?qa(Ya,tu):function(x,T,F){for(var D=R0(T),M=ii.f,z=Ii.f,pe=0;pe<D.length;pe++){var ae=D[pe];Nn(x,ae)||F&&Nn(F,ae)||M(x,ae,z(T,ae))}}(Ya,tu,{name:!0});var Ul=Ya.prototype=ki(tu.prototype,{constructor:Ce(1,Ya),message:Ce(1,""),name:Ce(1,"AggregateError")});qr({global:!0,constructor:!0,arity:2},{AggregateError:Ya});var Xa,ca,Tm,Dl,Li=Oe(c.process)=="process",Sm=Yn("species"),Mm=function(x){var T=dr(x),F=ii.f;oe&&T&&!T[Sm]&&F(T,Sm,{configurable:!0,get:function(){return this}})},K0=TypeError,ql=function(x,T){if(Lt(T,x))return x;throw K0("Incorrect invocation")},Q0=TypeError,ru=function(x){if(Vc(x))return x;throw Q0(Fr(x)+" is not a constructor")},J0=Yn("species"),Ts=function(x,T){var F,D=Dn(x).constructor;return D===void 0||Pt(F=Dn(D)[J0])?T:ru(F)},Y0=TypeError,Cm=function(x,T){if(x<T)throw Y0("Not enough arguments");return x},km=/(?:ipad|iphone|ipod).*applewebkit/i.test(cr),$l=c.setImmediate,Hl=c.clearImmediate,X0=c.process,Vl=c.Dispatch,Z0=c.Function,xm=c.MessageChannel,e1=c.String,zl=0,Za={},t1="onreadystatechange";try{Xa=c.location}catch{}var Wl=function(x){if(Nn(Za,x)){var T=Za[x];delete Za[x],T()}},Gl=function(x){return function(){Wl(x)}},wm=function(x){Wl(x.data)},Im=function(x){c.postMessage(e1(x),Xa.protocol+"//"+Xa.host)};$l&&Hl||($l=function(T){Cm(arguments.length,1);var F=le(T)?T:Z0(T),D=fs(arguments,1);return Za[++zl]=function(){k(F,void 0,D)},ca(zl),zl},Hl=function(T){delete Za[T]},Li?ca=function(x){X0.nextTick(Gl(x))}:Vl&&Vl.now?ca=function(x){Vl.now(Gl(x))}:xm&&!km?(Dl=(Tm=new xm).port2,Tm.port1.onmessage=wm,ca=_o(Dl.postMessage,Dl)):c.addEventListener&&le(c.postMessage)&&!c.importScripts&&Xa&&Xa.protocol!=="file:"&&!u(Im)?(ca=Im,c.addEventListener("message",wm,!1)):ca=t1 in Io("script")?function(x){ll.appendChild(Io("script")).onreadystatechange=function(){ll.removeChild(this),Wl(x)}}:function(x){setTimeout(Gl(x),0)});var ec,qs,tc,ua,Kl,Ql,Jl,_m,Em={set:$l,clear:Hl},r1=/ipad|iphone|ipod/i.test(cr)&&c.Pebble!==void 0,n1=/web0s(?!.*chrome)/i.test(cr),o1=Ii.f,Yl=Em.set,Pm=c.MutationObserver||c.WebKitMutationObserver,Am=c.document,Om=c.process,nu=c.Promise,Rm=o1(c,"queueMicrotask"),Nm=Rm&&Rm.value;Nm||(ec=function(){var x,T;for(Li&&(x=Om.domain)&&x.exit();qs;){T=qs.fn,qs=qs.next;try{T()}catch(F){throw qs?ua():tc=void 0,F}}tc=void 0,x&&x.enter()},km||Li||n1||!Pm||!Am?!r1&&nu&&nu.resolve?((Jl=nu.resolve(void 0)).constructor=nu,_m=_o(Jl.then,Jl),ua=function(){_m(ec)}):Li?ua=function(){Om.nextTick(ec)}:(Yl=_o(Yl,c),ua=function(){Yl(ec)}):(Kl=!0,Ql=Am.createTextNode(""),new Pm(ec).observe(Ql,{characterData:!0}),ua=function(){Ql.data=Kl=!Kl}));var Xl=Nm||function(x){var T={fn:x,next:void 0};tc&&(tc.next=T),qs||(qs=T,ua()),tc=T},la=function(x){try{return{error:!1,value:x()}}catch(T){return{error:!0,value:T}}},Fm=function(){this.head=null,this.tail=null};Fm.prototype={add:function(x){var T={item:x,next:null};this.head?this.tail.next=T:this.head=T,this.tail=T},get:function(){var x=this.head;if(x)return this.head=x.next,this.tail===x&&(this.tail=null),x.item}};var Zl,jm,i1=Fm,Jo=c.Promise,Bm=typeof Deno=="object"&&Deno&&typeof Deno.version=="object",s1=!Bm&&!Li&&typeof window=="object"&&typeof document=="object",Lm=Jo&&Jo.prototype,a1=Yn("species"),Um=!1,Dm=le(c.PromiseRejectionEvent),c1=Ua("Promise",function(){var x=Cf(Jo),T=x!==String(Jo);if(!T&&gr===66||!Lm.catch||!Lm.finally)return!0;if(!gr||gr<51||!/native code/.test(x)){var F=new Jo(function(M){M(1)}),D=function(M){M(function(){},function(){})};if((F.constructor={})[a1]=D,!(Um=F.then(function(){})instanceof D))return!0}return!T&&(s1||Bm)&&!Dm}),da={CONSTRUCTOR:c1,REJECTION_EVENT:Dm,SUBCLASSING:Um},u1=TypeError,l1=function(x){var T,F;this.promise=new x(function(D,M){if(T!==void 0||F!==void 0)throw u1("Bad Promise constructor");T=D,F=M}),this.resolve=Or(T),this.reject=Or(F)},Zi={f:function(x){return new l1(x)}},qm=Em.set,ou="Promise",$m=da.CONSTRUCTOR,d1=da.REJECTION_EVENT,ed=xi.getterFor(ou),p1=xi.set,f1=Jo&&Jo.prototype,rc=Jo,td=f1,Hm=c.TypeError,rd=c.document,nd=c.process,od=Zi.f,m1=od,g1=!!(rd&&rd.createEvent&&c.dispatchEvent),Vm="unhandledrejection",zm=function(x){var T;return!(!xe(x)||!le(T=x.then))&&T},Wm=function(x,T){var F,D,M,z=T.value,pe=T.state==1,ae=pe?x.ok:x.fail,ze=x.resolve,jt=x.reject,ur=x.domain;try{ae?(pe||(T.rejection===2&&y1(T),T.rejection=1),ae===!0?F=z:(ur&&ur.enter(),F=ae(z),ur&&(ur.exit(),M=!0)),F===x.promise?jt(Hm("Promise-chain cycle")):(D=zm(F))?Ie(D,F,ze,jt):ze(F)):jt(z)}catch(hr){ur&&!M&&ur.exit(),jt(hr)}},Gm=function(x,T){x.notified||(x.notified=!0,Xl(function(){for(var F,D=x.reactions;F=D.get();)Wm(F,x);x.notified=!1,T&&!x.rejection&&h1(x)}))},Km=function(x,T,F){var D,M;g1?((D=rd.createEvent("Event")).promise=T,D.reason=F,D.initEvent(x,!1,!0),c.dispatchEvent(D)):D={promise:T,reason:F},!d1&&(M=c["on"+x])?M(D):x===Vm&&function(z,pe){var ae=c.console;ae&&ae.error&&(arguments.length==1?ae.error(z):ae.error(z,pe))}("Unhandled promise rejection",F)},h1=function(x){Ie(qm,c,function(){var T,F=x.facade,D=x.value;if(Qm(x)&&(T=la(function(){Li?nd.emit("unhandledRejection",D,F):Km(Vm,F,D)}),x.rejection=Li||Qm(x)?2:1,T.error))throw T.value})},Qm=function(x){return x.rejection!==1&&!x.parent},y1=function(x){Ie(qm,c,function(){var T=x.facade;Li?nd.emit("rejectionHandled",T):Km("rejectionhandled",T,x.value)})},pa=function(x,T,F){return function(D){x(T,D,F)}},fa=function(x,T,F){x.done||(x.done=!0,F&&(x=F),x.value=T,x.state=2,Gm(x,!0))},id=function(x,T,F){if(!x.done){x.done=!0,F&&(x=F);try{if(x.facade===T)throw Hm("Promise can't be resolved itself");var D=zm(T);D?Xl(function(){var M={done:!1};try{Ie(D,T,pa(id,M,x),pa(fa,M,x))}catch(z){fa(M,z,x)}}):(x.value=T,x.state=1,Gm(x,!1))}catch(M){fa({done:!1},M,x)}}};$m&&(td=(rc=function(T){ql(this,td),Or(T),Ie(Zl,this);var F=ed(this);try{T(pa(id,F),pa(fa,F))}catch(D){fa(F,D)}}).prototype,(Zl=function(T){p1(this,{type:ou,done:!1,notified:!1,parent:!1,reactions:new i1,rejection:!1,state:0,value:void 0})}).prototype=ms(td,"then",function(T,F){var D=ed(this),M=od(Ts(this,rc));return D.parent=!0,M.ok=!le(T)||T,M.fail=le(F)&&F,M.domain=Li?nd.domain:void 0,D.state==0?D.reactions.add(M):Xl(function(){Wm(M,D)}),M.promise}),jm=function(){var x=new Zl,T=ed(x);this.promise=x,this.resolve=pa(id,T),this.reject=pa(fa,T)},Zi.f=od=function(x){return x===rc||x===void 0?new jm(x):m1(x)}),qr({global:!0,constructor:!0,wrap:!0,forced:$m},{Promise:rc}),js(rc,ou,!1,!0),Mm(ou);var Jm=Yn("iterator"),Ym=!1;try{var v1=0,Xm={next:function(){return{done:!!v1++}},return:function(){Ym=!0}};Xm[Jm]=function(){return this},Array.from(Xm,function(){throw 2})}catch{}var Zm=function(x,T){if(!T&&!Ym)return!1;var F=!1;try{var D={};D[Jm]=function(){return{next:function(){return{done:F=!0}}}},x(D)}catch{}return F},eg=da.CONSTRUCTOR||!Zm(function(x){Jo.all(x).then(void 0,function(){})});qr({target:"Promise",stat:!0,forced:eg},{all:function(T){var F=this,D=Zi.f(F),M=D.resolve,z=D.reject,pe=la(function(){var ae=Or(F.resolve),ze=[],jt=0,ur=1;to(T,function(hr){var br=jt++,Cr=!1;ur++,Ie(ae,F,hr).then(function(_r){Cr||(Cr=!0,ze[br]=_r,--ur||M(ze))},z)}),--ur||M(ze)});return pe.error&&z(pe.value),D.promise}});var b1=da.CONSTRUCTOR;Jo&&Jo.prototype,qr({target:"Promise",proto:!0,forced:b1,real:!0},{catch:function(x){return this.then(void 0,x)}}),qr({target:"Promise",stat:!0,forced:eg},{race:function(T){var F=this,D=Zi.f(F),M=D.reject,z=la(function(){var pe=Or(F.resolve);to(T,function(ae){Ie(pe,F,ae).then(D.resolve,M)})});return z.error&&M(z.value),D.promise}}),qr({target:"Promise",stat:!0,forced:da.CONSTRUCTOR},{reject:function(T){var F=Zi.f(this);return Ie(F.reject,void 0,T),F.promise}});var sd=function(x,T){if(Dn(x),xe(T)&&T.constructor===x)return T;var F=Zi.f(x);return(0,F.resolve)(T),F.promise},T1=da.CONSTRUCTOR,S1=dr("Promise"),M1=!T1;qr({target:"Promise",stat:!0,forced:!0},{resolve:function(T){return sd(M1&&this===S1?Jo:this,T)}}),qr({target:"Promise",stat:!0},{allSettled:function(T){var F=this,D=Zi.f(F),M=D.resolve,z=D.reject,pe=la(function(){var ae=Or(F.resolve),ze=[],jt=0,ur=1;to(T,function(hr){var br=jt++,Cr=!1;ur++,Ie(ae,F,hr).then(function(_r){Cr||(Cr=!0,ze[br]={status:"fulfilled",value:_r},--ur||M(ze))},function(_r){Cr||(Cr=!0,ze[br]={status:"rejected",reason:_r},--ur||M(ze))})}),--ur||M(ze)});return pe.error&&z(pe.value),D.promise}});var tg="No one promise resolved";qr({target:"Promise",stat:!0},{any:function(T){var F=this,D=dr("AggregateError"),M=Zi.f(F),z=M.resolve,pe=M.reject,ae=la(function(){var ze=Or(F.resolve),jt=[],ur=0,hr=1,br=!1;to(T,function(Cr){var _r=ur++,Nr=!1;hr++,Ie(ze,F,Cr).then(function(Br){Nr||br||(br=!0,z(Br))},function(Br){Nr||br||(Nr=!0,jt[_r]=Br,--hr||pe(new D(jt,tg)))})}),--hr||pe(new D(jt,tg))});return ae.error&&pe(ae.value),M.promise}});var C1=Jo&&Jo.prototype,k1=!!Jo&&u(function(){C1.finally.call({then:function(){}},function(){})});qr({target:"Promise",proto:!0,real:!0,forced:k1},{finally:function(x){var T=Ts(this,dr("Promise")),F=le(x);return this.then(F?function(D){return sd(T,x()).then(function(){return D})}:x,F?function(D){return sd(T,x()).then(function(){throw D})}:x)}});var x1=nr.Promise;qr({target:"Promise",stat:!0,forced:!0},{try:function(x){var T=Zi.f(this),F=la(x);return(F.error?T.reject:T.resolve)(F.value),T.promise}});var ro=x1,w1=re([].reverse),rg=[1,2];qr({target:"Array",proto:!0,forced:String(rg)===String(rg.reverse())},{reverse:function(){return Ji(this)&&(this.length=this.length),w1(this)}});var I1=Ao("Array").reverse,ad=Array.prototype,Eu=function(x){var T=x.reverse;return x===ad||Lt(ad,x)&&T===ad.reverse?I1:T},_1=Ha("slice"),E1=Yn("species"),cd=Array,P1=Math.max;qr({target:"Array",proto:!0,forced:!_1},{slice:function(T,F){var D,M,z,pe=lr(this),ae=Ci(pe),ze=oa(T,ae),jt=oa(F===void 0?ae:F,ae);if(Ji(pe)&&(D=pe.constructor,(Vc(D)&&(D===cd||Ji(D.prototype))||xe(D)&&(D=D[E1])===null)&&(D=void 0),D===cd||D===void 0))return fs(pe,ze,jt);for(M=new(D===void 0?cd:D)(P1(jt-ze,0)),z=0;ze<jt;ze++,z++)ze in pe&&Ns(M,z,pe[ze]);return M.length=z,M}});var A1=Ao("Array").slice,ud=Array.prototype,fo=function(x){var T=x.slice;return x===ud||Lt(ud,x)&&T===ud.slice?A1:T},O1=s(function(x){var T=w0.default;function F(){x.exports=F=function(){return D},x.exports.__esModule=!0,x.exports.default=x.exports;var D={},M=Object.prototype,z=M.hasOwnProperty,pe=typeof li=="function"?li:{},ae=pe.iterator||"@@iterator",ze=pe.asyncIterator||"@@asyncIterator",jt=pe.toStringTag||"@@toStringTag";function ur(Tn,Yr,Pn){return Qa(Tn,Yr,{value:Pn,enumerable:!0,configurable:!0,writable:!0}),Tn[Yr]}try{ur({},"")}catch{ur=function(Pn,Un,Jn){return Pn[Un]=Jn}}function hr(Tn,Yr,Pn,Un){var Jn=Yr&&Yr.prototype instanceof _r?Yr:_r,Xn=Qi(Jn.prototype),Bo=new xr(Un||[]);return Xn._invoke=function(To,ji,mo){var So="suspendedStart";return function(Xo,Dc){if(So==="executing")throw new Error("Generator is already running");if(So==="completed"){if(Xo==="throw")throw Dc;return Rn()}for(mo.method=Xo,mo.arg=Dc;;){var xo=mo.delegate;if(xo){var bc=qn(xo,mo);if(bc){if(bc===Cr)continue;return bc}}if(mo.method==="next")mo.sent=mo._sent=mo.arg;else if(mo.method==="throw"){if(So==="suspendedStart")throw So="completed",mo.arg;mo.dispatchException(mo.arg)}else mo.method==="return"&&mo.abrupt("return",mo.arg);So="executing";var Hi=br(To,ji,mo);if(Hi.type==="normal"){if(So=mo.done?"completed":"suspendedYield",Hi.arg===Cr)continue;return{value:Hi.arg,done:mo.done}}Hi.type==="throw"&&(So="completed",mo.method="throw",mo.arg=Hi.arg)}}}(Tn,Pn,Bo),Xn}function br(Tn,Yr,Pn){try{return{type:"normal",arg:Tn.call(Yr,Pn)}}catch(Un){return{type:"throw",arg:Un}}}D.wrap=hr;var Cr={};function _r(){}function Nr(){}function Br(){}var Hr={};ur(Hr,ae,function(){return this});var $r=Us&&Us(Us(wn([])));$r&&$r!==M&&z.call($r,ae)&&(Hr=$r);var Vr=Br.prototype=_r.prototype=Qi(Hr);function bn(Tn){var Yr;kn(Yr=["next","throw","return"]).call(Yr,function(Pn){ur(Tn,Pn,function(Un){return this._invoke(Pn,Un)})})}function Wn(Tn,Yr){function Pn(Jn,Xn,Bo,To){var ji=br(Tn[Jn],Tn,Xn);if(ji.type!=="throw"){var mo=ji.arg,So=mo.value;return So&&T(So)=="object"&&z.call(So,"__await")?Yr.resolve(So.__await).then(function(Xo){Pn("next",Xo,Bo,To)},function(Xo){Pn("throw",Xo,Bo,To)}):Yr.resolve(So).then(function(Xo){mo.value=Xo,Bo(mo)},function(Xo){return Pn("throw",Xo,Bo,To)})}To(ji.arg)}var Un;this._invoke=function(Jn,Xn){function Bo(){return new Yr(function(To,ji){Pn(Jn,Xn,To,ji)})}return Un=Un?Un.then(Bo,Bo):Bo()}}function qn(Tn,Yr){var Pn=Tn.iterator[Yr.method];if(Pn===void 0){if(Yr.delegate=null,Yr.method==="throw"){if(Tn.iterator.return&&(Yr.method="return",Yr.arg=void 0,qn(Tn,Yr),Yr.method==="throw"))return Cr;Yr.method="throw",Yr.arg=new TypeError("The iterator does not provide a 'throw' method")}return Cr}var Un=br(Pn,Tn.iterator,Yr.arg);if(Un.type==="throw")return Yr.method="throw",Yr.arg=Un.arg,Yr.delegate=null,Cr;var Jn=Un.arg;return Jn?Jn.done?(Yr[Tn.resultName]=Jn.value,Yr.next=Tn.nextLoc,Yr.method!=="return"&&(Yr.method="next",Yr.arg=void 0),Yr.delegate=null,Cr):Jn:(Yr.method="throw",Yr.arg=new TypeError("iterator result is not an object"),Yr.delegate=null,Cr)}function yo(Tn){var Yr={tryLoc:Tn[0]};1 in Tn&&(Yr.catchLoc=Tn[1]),2 in Tn&&(Yr.finallyLoc=Tn[2],Yr.afterLoc=Tn[3]),this.tryEntries.push(Yr)}function Fn(Tn){var Yr=Tn.completion||{};Yr.type="normal",delete Yr.arg,Tn.completion=Yr}function xr(Tn){this.tryEntries=[{tryLoc:"root"}],kn(Tn).call(Tn,yo,this),this.reset(!0)}function wn(Tn){if(Tn){var Yr=Tn[ae];if(Yr)return Yr.call(Tn);if(typeof Tn.next=="function")return Tn;if(!isNaN(Tn.length)){var Pn=-1,Un=function Jn(){for(;++Pn<Tn.length;)if(z.call(Tn,Pn))return Jn.value=Tn[Pn],Jn.done=!1,Jn;return Jn.value=void 0,Jn.done=!0,Jn};return Un.next=Un}}return{next:Rn}}function Rn(){return{value:void 0,done:!0}}return Nr.prototype=Br,ur(Vr,"constructor",Br),ur(Br,"constructor",Nr),Nr.displayName=ur(Br,jt,"GeneratorFunction"),D.isGeneratorFunction=function(Tn){var Yr=typeof Tn=="function"&&Tn.constructor;return!!Yr&&(Yr===Nr||(Yr.displayName||Yr.name)==="GeneratorFunction")},D.mark=function(Tn){return Rs?Rs(Tn,Br):(Tn.__proto__=Br,ur(Tn,jt,"GeneratorFunction")),Tn.prototype=Qi(Vr),Tn},D.awrap=function(Tn){return{__await:Tn}},bn(Wn.prototype),ur(Wn.prototype,ze,function(){return this}),D.AsyncIterator=Wn,D.async=function(Tn,Yr,Pn,Un,Jn){Jn===void 0&&(Jn=ro);var Xn=new Wn(hr(Tn,Yr,Pn,Un),Jn);return D.isGeneratorFunction(Yr)?Xn:Xn.next().then(function(Bo){return Bo.done?Bo.value:Xn.next()})},bn(Vr),ur(Vr,jt,"Generator"),ur(Vr,ae,function(){return this}),ur(Vr,"toString",function(){return"[object Generator]"}),D.keys=function(Tn){var Yr=[];for(var Pn in Tn)Yr.push(Pn);return Eu(Yr).call(Yr),function Un(){for(;Yr.length;){var Jn=Yr.pop();if(Jn in Tn)return Un.value=Jn,Un.done=!1,Un}return Un.done=!0,Un}},D.values=wn,xr.prototype={constructor:xr,reset:function(Yr){var Pn;if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,kn(Pn=this.tryEntries).call(Pn,Fn),!Yr)for(var Un in this)Un.charAt(0)==="t"&&z.call(this,Un)&&!isNaN(+fo(Un).call(Un,1))&&(this[Un]=void 0)},stop:function(){this.done=!0;var Yr=this.tryEntries[0].completion;if(Yr.type==="throw")throw Yr.arg;return this.rval},dispatchException:function(Yr){if(this.done)throw Yr;var Pn=this;function Un(mo,So){return Bo.type="throw",Bo.arg=Yr,Pn.next=mo,So&&(Pn.method="next",Pn.arg=void 0),!!So}for(var Jn=this.tryEntries.length-1;Jn>=0;--Jn){var Xn=this.tryEntries[Jn],Bo=Xn.completion;if(Xn.tryLoc==="root")return Un("end");if(Xn.tryLoc<=this.prev){var To=z.call(Xn,"catchLoc"),ji=z.call(Xn,"finallyLoc");if(To&&ji){if(this.prev<Xn.catchLoc)return Un(Xn.catchLoc,!0);if(this.prev<Xn.finallyLoc)return Un(Xn.finallyLoc)}else if(To){if(this.prev<Xn.catchLoc)return Un(Xn.catchLoc,!0)}else{if(!ji)throw new Error("try statement without catch or finally");if(this.prev<Xn.finallyLoc)return Un(Xn.finallyLoc)}}}},abrupt:function(Yr,Pn){for(var Un=this.tryEntries.length-1;Un>=0;--Un){var Jn=this.tryEntries[Un];if(Jn.tryLoc<=this.prev&&z.call(Jn,"finallyLoc")&&this.prev<Jn.finallyLoc){var Xn=Jn;break}}Xn&&(Yr==="break"||Yr==="continue")&&Xn.tryLoc<=Pn&&Pn<=Xn.finallyLoc&&(Xn=null);var Bo=Xn?Xn.completion:{};return Bo.type=Yr,Bo.arg=Pn,Xn?(this.method="next",this.next=Xn.finallyLoc,Cr):this.complete(Bo)},complete:function(Yr,Pn){if(Yr.type==="throw")throw Yr.arg;return Yr.type==="break"||Yr.type==="continue"?this.next=Yr.arg:Yr.type==="return"?(this.rval=this.arg=Yr.arg,this.method="return",this.next="end"):Yr.type==="normal"&&Pn&&(this.next=Pn),Cr},finish:function(Yr){for(var Pn=this.tryEntries.length-1;Pn>=0;--Pn){var Un=this.tryEntries[Pn];if(Un.finallyLoc===Yr)return this.complete(Un.completion,Un.afterLoc),Fn(Un),Cr}},catch:function(Yr){for(var Pn=this.tryEntries.length-1;Pn>=0;--Pn){var Un=this.tryEntries[Pn];if(Un.tryLoc===Yr){var Jn=Un.completion;if(Jn.type==="throw"){var Xn=Jn.arg;Fn(Un)}return Xn}}throw new Error("illegal catch attempt")},delegateYield:function(Yr,Pn,Un){return this.delegate={iterator:wn(Yr),resultName:Pn,nextLoc:Un},this.method==="next"&&(this.arg=void 0),Cr}},D}x.exports=F,x.exports.__esModule=!0,x.exports.default=x.exports}),iu=O1(),rr=iu;try{regeneratorRuntime=iu}catch{typeof globalThis=="object"?globalThis.regeneratorRuntime=iu:Function("r","regeneratorRuntime = r")(iu)}qr({target:"Number",stat:!0,nonConfigurable:!0,nonWritable:!0},{MAX_SAFE_INTEGER:9007199254740991});var ng=9007199254740991,Pu=u(function(){ps(1)});qr({target:"Object",stat:!0,forced:Pu},{keys:function(T){return ps(An(T))}});var No=nr.Object.keys,Au=Object.assign,og=Object.defineProperty,Xr=re([].concat),Ou=!Au||u(function(){if(oe&&Au({b:1},Au(og({},"a",{enumerable:!0,get:function(){og(this,"b",{value:3,enumerable:!1})}}),{b:2})).b!==1)return!0;var x={},T={},F=Symbol(),D="abcdefghijklmnopqrst";return x[F]=7,D.split("").forEach(function(M){T[M]=M}),Au({},x)[F]!=7||ps(Au({},T)).join("")!=D})?function(T,F){for(var D=An(T),M=arguments.length,z=1,pe=Wa.f,ae=Ve.f;M>z;)for(var ze,jt=er(arguments[z++]),ur=pe?Xr(ps(jt),pe(jt)):ps(jt),hr=ur.length,br=0;hr>br;)ze=ur[br++],oe&&!Ie(ae,jt,ze)||(D[ze]=jt[ze]);return D}:Au;qr({target:"Object",stat:!0,arity:2,forced:Object.assign!==Ou},{assign:Ou});var kr=nr.Object.assign;nr.JSON||(nr.JSON={stringify:JSON.stringify});var Xh=function(T,F,D){return k(nr.JSON.stringify,null,arguments)},Uo=Xh,ig=ul.indexOf,sg=re([].indexOf),ag=!!sg&&1/sg([1],1,-0)<0,R1=Ds("indexOf");qr({target:"Array",proto:!0,forced:ag||!R1},{indexOf:function(T){var F=arguments.length>1?arguments[1]:void 0;return ag?sg(this,T,F)||0:ig(this,T,F)}});var N1=Ao("Array").indexOf,cg=Array.prototype,bi=function(x){var T=x.indexOf;return x===cg||Lt(cg,x)&&T===cg.indexOf?N1:T},Zh=Ao("Array").concat,tp=Array.prototype,Ss=function(x){var T=x.concat;return x===tp||Lt(tp,x)&&T===tp.concat?Zh:T};function Is(x,T){var F={};for(var D in x)Object.prototype.hasOwnProperty.call(x,D)&&T.indexOf(D)<0&&(F[D]=x[D]);if(x!=null&&typeof Object.getOwnPropertySymbols=="function"){var M=0;for(D=Object.getOwnPropertySymbols(x);M<D.length;M++)T.indexOf(D[M])<0&&Object.prototype.propertyIsEnumerable.call(x,D[M])&&(F[D[M]]=x[D[M]])}return F}function hn(x,T,F,D){return new(F||(F=Promise))(function(M,z){function pe(jt){try{ze(D.next(jt))}catch(ur){z(ur)}}function ae(jt){try{ze(D.throw(jt))}catch(ur){z(ur)}}function ze(jt){jt.done?M(jt.value):function(hr){return hr instanceof F?hr:new F(function(br){br(hr)})}(jt.value).then(pe,ae)}ze((D=D.apply(x,T||[])).next())})}var rp=u(function(){if(typeof ArrayBuffer=="function"){var x=new ArrayBuffer(8);Object.isExtensible(x)&&Object.defineProperty(x,"a",{value:8})}}),ld=Object.isExtensible,ug=u(function(){ld(1)})||rp?function(T){return!!xe(T)&&(!rp||Oe(T)!="ArrayBuffer")&&(!ld||ld(T))}:ld,ey=!u(function(){return Object.isExtensible(Object.preventExtensions({}))}),lg=s(function(x){var T=ii.f,F=!1,D=yi("meta"),M=0,z=function(ae){T(ae,D,{value:{objectID:"O"+M++,weakData:{}}})},pe=x.exports={enable:function(){pe.enable=function(){},F=!0;var ae=za.f,ze=re([].splice),jt={};jt[D]=1,ae(jt).length&&(za.f=function(ur){for(var hr=ae(ur),br=0,Cr=hr.length;br<Cr;br++)if(hr[br]===D){ze(hr,br,1);break}return hr},qr({target:"Object",stat:!0,forced:!0},{getOwnPropertyNames:Sl.f}))},fastKey:function(ae,ze){if(!xe(ae))return typeof ae=="symbol"?ae:(typeof ae=="string"?"S":"P")+ae;if(!Nn(ae,D)){if(!ug(ae))return"F";if(!ze)return"E";z(ae)}return ae[D].objectID},getWeakData:function(ae,ze){if(!Nn(ae,D)){if(!ug(ae))return!0;if(!ze)return!1;z(ae)}return ae[D].weakData},onFreeze:function(ae){return ey&&F&&ug(ae)&&!Nn(ae,D)&&z(ae),ae}};ia[D]=!0}),ty=ii.f,ry=hs.forEach,wa=xi.set,F1=xi.getterFor,ny=function(x,T,F){for(var D in T)F&&F.unsafe&&x[D]?x[D]=T[D]:ms(x,D,T[D],F);return x},j1=ii.f,oy=lg.fastKey,dg=xi.set,su=xi.getterFor,iy={getConstructor:function(x,T,F,D){var M=x(function(jt,ur){ql(jt,z),dg(jt,{type:T,index:ki(null),first:void 0,last:void 0,size:0}),oe||(jt.size=0),Pt(ur)||to(ur,jt[D],{that:jt,AS_ENTRIES:F})}),z=M.prototype,pe=su(T),ae=function(jt,ur,hr){var br,Cr,_r=pe(jt),Nr=ze(jt,ur);return Nr?Nr.value=hr:(_r.last=Nr={index:Cr=oy(ur,!0),key:ur,value:hr,previous:br=_r.last,next:void 0,removed:!1},_r.first||(_r.first=Nr),br&&(br.next=Nr),oe?_r.size++:jt.size++,Cr!=="F"&&(_r.index[Cr]=Nr)),jt},ze=function(jt,ur){var hr,br=pe(jt),Cr=oy(ur);if(Cr!=="F")return br.index[Cr];for(hr=br.first;hr;hr=hr.next)if(hr.key==ur)return hr};return ny(z,{clear:function(){for(var ur=pe(this),hr=ur.index,br=ur.first;br;)br.removed=!0,br.previous&&(br.previous=br.previous.next=void 0),delete hr[br.index],br=br.next;ur.first=ur.last=void 0,oe?ur.size=0:this.size=0},delete:function(jt){var ur=this,hr=pe(ur),br=ze(ur,jt);if(br){var Cr=br.next,_r=br.previous;delete hr.index[br.index],br.removed=!0,_r&&(_r.next=Cr),Cr&&(Cr.previous=_r),hr.first==br&&(hr.first=Cr),hr.last==br&&(hr.last=_r),oe?hr.size--:ur.size--}return!!br},forEach:function(ur){for(var hr,br=pe(this),Cr=_o(ur,arguments.length>1?arguments[1]:void 0);hr=hr?hr.next:br.first;)for(Cr(hr.value,hr.key,this);hr&&hr.removed;)hr=hr.previous},has:function(ur){return!!ze(this,ur)}}),ny(z,F?{get:function(ur){var hr=ze(this,ur);return hr&&hr.value},set:function(ur,hr){return ae(this,ur===0?0:ur,hr)}}:{add:function(ur){return ae(this,ur=ur===0?0:ur,ur)}}),oe&&j1(z,"size",{get:function(){return pe(this).size}}),M},setStrong:function(x,T,F){var D=T+" Iterator",M=su(T),z=su(D);Nl(x,T,function(pe,ae){dg(this,{type:D,target:pe,state:M(pe),kind:ae,last:void 0})},function(){for(var pe=z(this),ae=pe.kind,ze=pe.last;ze&&ze.removed;)ze=ze.previous;return pe.target&&(pe.last=ze=ze?ze.next:pe.state.first)?ae=="keys"?{value:ze.key,done:!1}:ae=="values"?{value:ze.value,done:!1}:{value:[ze.key,ze.value],done:!1}:(pe.target=void 0,{value:void 0,done:!0})},F?"entries":"values",!F,!0),Mm(T)}};(function(x,T,F){var D,M=x.indexOf("Map")!==-1,z=x.indexOf("Weak")!==-1,pe=M?"set":"add",ae=c[x],ze=ae&&ae.prototype,jt={};if(oe&&le(ae)&&(z||ze.forEach&&!u(function(){new ae().entries().next()}))){var ur=(D=T(function(br,Cr){wa(ql(br,ur),{type:x,collection:new ae}),Cr!=null&&to(Cr,br[pe],{that:br,AS_ENTRIES:M})})).prototype,hr=F1(x);ry(["add","clear","delete","forEach","get","has","set","keys","values","entries"],function(br){var Cr=br=="add"||br=="set";!(br in ze)||z&&br=="clear"||Ho(ur,br,function(_r,Nr){var Br=hr(this).collection;if(!Cr&&z&&!xe(_r))return br=="get"&&void 0;var Hr=Br[br](_r===0?0:_r,Nr);return Cr?this:Hr})}),z||ty(ur,"size",{configurable:!0,get:function(){return hr(this).collection.size}})}else D=F.getConstructor(T,x,M,pe),lg.enable();js(D,x,!1,!0),jt[x]=D,qr({global:!0,forced:!0},jt),z||F.setStrong(D,x,M)})("Map",function(x){return function(){return x(this,arguments.length?arguments[0]:void 0)}},iy);var B1=nr.Map,es=[].push;qr({target:"Map",stat:!0,forced:!0},{from:function(T){var F,D,M,z,pe=arguments.length,ae=pe>1?arguments[1]:void 0;return ru(this),(F=ae!==void 0)&&Or(ae),Pt(T)?new this:(D=[],F?(M=0,z=_o(ae,pe>2?arguments[2]:void 0),to(T,function(ze){Ie(es,D,z(ze,M++))})):to(T,es,{that:D}),new this(D))}}),qr({target:"Map",stat:!0,forced:!0},{of:function(){return new this(fs(arguments))}}),qr({target:"Map",proto:!0,real:!0,forced:!0},{deleteAll:function(){for(var T,F=Dn(this),D=Or(F.delete),M=!0,z=0,pe=arguments.length;z<pe;z++)T=Ie(D,F,arguments[z]),M=M&&T;return!!M}}),qr({target:"Map",proto:!0,real:!0,forced:!0},{emplace:function(T,F){var D,M,z=Dn(this),pe=Or(z.get),ae=Or(z.has),ze=Or(z.set);return Ie(ae,z,T)?(D=Ie(pe,z,T),"update"in F&&(D=F.update(D,T,z),Ie(ze,z,T,D)),D):(M=F.insert(T,z),Ie(ze,z,T,M),M)}});var Ia=Ja;qr({target:"Map",proto:!0,real:!0,forced:!0},{every:function(T){var F=Dn(this),D=Ia(F),M=_o(T,arguments.length>1?arguments[1]:void 0);return!to(D,function(z,pe,ae){if(!M(pe,z,F))return ae()},{AS_ENTRIES:!0,IS_ITERATOR:!0,INTERRUPTED:!0}).stopped}}),qr({target:"Map",proto:!0,real:!0,forced:!0},{filter:function(T){var F=Dn(this),D=Ia(F),M=_o(T,arguments.length>1?arguments[1]:void 0),z=new(Ts(F,dr("Map"))),pe=Or(z.set);return to(D,function(ae,ze){M(ze,ae,F)&&Ie(pe,z,ae,ze)},{AS_ENTRIES:!0,IS_ITERATOR:!0}),z}}),qr({target:"Map",proto:!0,real:!0,forced:!0},{find:function(T){var F=Dn(this),D=Ia(F),M=_o(T,arguments.length>1?arguments[1]:void 0);return to(D,function(z,pe,ae){if(M(pe,z,F))return ae(pe)},{AS_ENTRIES:!0,IS_ITERATOR:!0,INTERRUPTED:!0}).result}}),qr({target:"Map",proto:!0,real:!0,forced:!0},{findKey:function(T){var F=Dn(this),D=Ia(F),M=_o(T,arguments.length>1?arguments[1]:void 0);return to(D,function(z,pe,ae){if(M(pe,z,F))return ae(z)},{AS_ENTRIES:!0,IS_ITERATOR:!0,INTERRUPTED:!0}).result}});var pg=re([].push);qr({target:"Map",stat:!0,forced:!0},{groupBy:function(T,F){Or(F);var D=Ja(T),M=new this,z=Or(M.has),pe=Or(M.get),ae=Or(M.set);return to(D,function(ze){var jt=F(ze);Ie(z,M,jt)?pg(Ie(pe,M,jt),ze):Ie(ae,M,jt,[ze])},{IS_ITERATOR:!0}),M}}),qr({target:"Map",proto:!0,real:!0,forced:!0},{includes:function(T){return to(Ia(Dn(this)),function(F,D,M){if((z=D)===(pe=T)||z!=z&&pe!=pe)return M();var z,pe},{AS_ENTRIES:!0,IS_ITERATOR:!0,INTERRUPTED:!0}).stopped}}),qr({target:"Map",stat:!0,forced:!0},{keyBy:function(T,F){var D=new this;Or(F);var M=Or(D.set);return to(T,function(z){Ie(M,D,F(z),z)}),D}}),qr({target:"Map",proto:!0,real:!0,forced:!0},{keyOf:function(T){return to(Ia(Dn(this)),function(F,D,M){if(D===T)return M(F)},{AS_ENTRIES:!0,IS_ITERATOR:!0,INTERRUPTED:!0}).result}}),qr({target:"Map",proto:!0,real:!0,forced:!0},{mapKeys:function(T){var F=Dn(this),D=Ia(F),M=_o(T,arguments.length>1?arguments[1]:void 0),z=new(Ts(F,dr("Map"))),pe=Or(z.set);return to(D,function(ae,ze){Ie(pe,z,M(ze,ae,F),ze)},{AS_ENTRIES:!0,IS_ITERATOR:!0}),z}}),qr({target:"Map",proto:!0,real:!0,forced:!0},{mapValues:function(T){var F=Dn(this),D=Ia(F),M=_o(T,arguments.length>1?arguments[1]:void 0),z=new(Ts(F,dr("Map"))),pe=Or(z.set);return to(D,function(ae,ze){Ie(pe,z,ae,M(ze,ae,F))},{AS_ENTRIES:!0,IS_ITERATOR:!0}),z}}),qr({target:"Map",proto:!0,real:!0,arity:1,forced:!0},{merge:function(T){for(var F=Dn(this),D=Or(F.set),M=arguments.length,z=0;z<M;)to(arguments[z++],D,{that:F,AS_ENTRIES:!0});return F}});var $s=TypeError;qr({target:"Map",proto:!0,real:!0,forced:!0},{reduce:function(T){var F=Dn(this),D=Ia(F),M=arguments.length<2,z=M?void 0:arguments[1];if(Or(T),to(D,function(pe,ae){M?(M=!1,z=ae):z=T(z,ae,pe,F)},{AS_ENTRIES:!0,IS_ITERATOR:!0}),M)throw $s("Reduce of empty map with no initial value");return z}}),qr({target:"Map",proto:!0,real:!0,forced:!0},{some:function(T){var F=Dn(this),D=Ia(F),M=_o(T,arguments.length>1?arguments[1]:void 0);return to(D,function(z,pe,ae){if(M(pe,z,F))return ae()},{AS_ENTRIES:!0,IS_ITERATOR:!0,INTERRUPTED:!0}).stopped}});var L1=TypeError;qr({target:"Map",proto:!0,real:!0,forced:!0},{update:function(T,F){var D=Dn(this),M=Or(D.get),z=Or(D.has),pe=Or(D.set),ae=arguments.length;Or(F);var ze=Ie(z,D,T);if(!ze&&ae<3)throw L1("Updating absent value");var jt=ze?Ie(M,D,T):Or(ae>2?arguments[2]:void 0)(T,D);return Ie(pe,D,T,F(jt,T,D)),D}});var U1=TypeError,fg=function(T,F){var D,M=Dn(this),z=Or(M.get),pe=Or(M.has),ae=Or(M.set),ze=arguments.length>2?arguments[2]:void 0;if(!le(F)&&!le(ze))throw U1("At least one callback required");return Ie(pe,M,T)?(D=Ie(z,M,T),le(F)&&(D=F(D),Ie(ae,M,T,D))):le(ze)&&(D=ze(),Ie(ae,M,T,D)),D};qr({target:"Map",proto:!0,real:!0,forced:!0},{upsert:fg}),qr({target:"Map",proto:!0,real:!0,name:"upsert",forced:!0},{updateOrInsert:fg});var nc=B1,mg=Date,sy=re(mg.prototype.getTime);qr({target:"Date",stat:!0},{now:function(){return sy(new mg)}});var ti=nr.Date.now,D1=/MSIE .\./.test(cr),so=c.Function,ay=function(x){return D1?function(T,F){var D=Cm(arguments.length,1)>2,M=le(T)?T:so(T),z=D?fs(arguments,2):void 0;return x(D?function(){k(M,this,z)}:M,F)}:x},cy={setTimeout:ay(c.setTimeout),setInterval:ay(c.setInterval)},uy=cy.setInterval;qr({global:!0,bind:!0,forced:c.setInterval!==uy},{setInterval:uy});var np=cy.setTimeout;qr({global:!0,bind:!0,forced:c.setTimeout!==np},{setTimeout:np});var co=nr.setTimeout,gg=hs.map,q1=Ha("map");qr({target:"Array",proto:!0,forced:!q1},{map:function(T){return gg(this,T,arguments.length>1?arguments[1]:void 0)}});var Ru=Ao("Array").map,op=Array.prototype,lo=function(x){var T=x.map;return x===op||Lt(op,x)&&T===op.map?Ru:T},Hs=s(function(x){var T=Object.prototype.hasOwnProperty,F="~";function D(){}function M(ze,jt,ur){this.fn=ze,this.context=jt,this.once=ur||!1}function z(ze,jt,ur,hr,br){if(typeof ur!="function")throw new TypeError("The listener must be a function");var Cr=new M(ur,hr||ze,br),_r=F?F+jt:jt;return ze._events[_r]?ze._events[_r].fn?ze._events[_r]=[ze._events[_r],Cr]:ze._events[_r].push(Cr):(ze._events[_r]=Cr,ze._eventsCount++),ze}function pe(ze,jt){--ze._eventsCount==0?ze._events=new D:delete ze._events[jt]}function ae(){this._events=new D,this._eventsCount=0}Object.create&&(D.prototype=Object.create(null),new D().__proto__||(F=!1)),ae.prototype.eventNames=function(){var jt,ur,hr=[];if(this._eventsCount===0)return hr;for(ur in jt=this._events)T.call(jt,ur)&&hr.push(F?ur.slice(1):ur);return Object.getOwnPropertySymbols?hr.concat(Object.getOwnPropertySymbols(jt)):hr},ae.prototype.listeners=function(jt){var ur=F?F+jt:jt,hr=this._events[ur];if(!hr)return[];if(hr.fn)return[hr.fn];for(var br=0,Cr=hr.length,_r=new Array(Cr);br<Cr;br++)_r[br]=hr[br].fn;return _r},ae.prototype.listenerCount=function(jt){var ur=F?F+jt:jt,hr=this._events[ur];return hr?hr.fn?1:hr.length:0},ae.prototype.emit=function(jt,ur,hr,br,Cr,_r){var Nr=F?F+jt:jt;if(!this._events[Nr])return!1;var Br,Hr,$r=this._events[Nr],Vr=arguments.length;if($r.fn){switch($r.once&&this.removeListener(jt,$r.fn,void 0,!0),Vr){case 1:return $r.fn.call($r.context),!0;case 2:return $r.fn.call($r.context,ur),!0;case 3:return $r.fn.call($r.context,ur,hr),!0;case 4:return $r.fn.call($r.context,ur,hr,br),!0;case 5:return $r.fn.call($r.context,ur,hr,br,Cr),!0;case 6:return $r.fn.call($r.context,ur,hr,br,Cr,_r),!0}for(Hr=1,Br=new Array(Vr-1);Hr<Vr;Hr++)Br[Hr-1]=arguments[Hr];$r.fn.apply($r.context,Br)}else{var bn,Wn=$r.length;for(Hr=0;Hr<Wn;Hr++)switch($r[Hr].once&&this.removeListener(jt,$r[Hr].fn,void 0,!0),Vr){case 1:$r[Hr].fn.call($r[Hr].context);break;case 2:$r[Hr].fn.call($r[Hr].context,ur);break;case 3:$r[Hr].fn.call($r[Hr].context,ur,hr);break;case 4:$r[Hr].fn.call($r[Hr].context,ur,hr,br);break;default:if(!Br)for(bn=1,Br=new Array(Vr-1);bn<Vr;bn++)Br[bn-1]=arguments[bn];$r[Hr].fn.apply($r[Hr].context,Br)}}return!0},ae.prototype.on=function(jt,ur,hr){return z(this,jt,ur,hr,!1)},ae.prototype.once=function(jt,ur,hr){return z(this,jt,ur,hr,!0)},ae.prototype.removeListener=function(jt,ur,hr,br){var Cr=F?F+jt:jt;if(!this._events[Cr])return this;if(!ur)return pe(this,Cr),this;var _r=this._events[Cr];if(_r.fn)_r.fn!==ur||br&&!_r.once||hr&&_r.context!==hr||pe(this,Cr);else{for(var Nr=0,Br=[],Hr=_r.length;Nr<Hr;Nr++)(_r[Nr].fn!==ur||br&&!_r[Nr].once||hr&&_r[Nr].context!==hr)&&Br.push(_r[Nr]);Br.length?this._events[Cr]=Br.length===1?Br[0]:Br:pe(this,Cr)}return this},ae.prototype.removeAllListeners=function(jt){var ur;return jt?(ur=F?F+jt:jt,this._events[ur]&&pe(this,ur)):(this._events=new D,this._eventsCount=0),this},ae.prototype.off=ae.prototype.removeListener,ae.prototype.addListener=ae.prototype.on,ae.prefixed=F,ae.EventEmitter=ae,x.exports=ae}),Ea=au;function au(x){x=x||{},this.ms=x.min||100,this.max=x.max||1e4,this.factor=x.factor||2,this.jitter=x.jitter>0&&x.jitter<=1?x.jitter:0,this.attempts=0}au.prototype.duration=function(){var x=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var T=Math.random(),F=Math.floor(T*this.jitter*x);x=1&Math.floor(10*T)?x+F:x-F}return 0|Math.min(x,this.max)},au.prototype.reset=function(){this.attempts=0},au.prototype.setMin=function(x){this.ms=x},au.prototype.setMax=function(x){this.max=x},au.prototype.setJitter=function(x){this.jitter=x};var ly=typeof e=="object"&&e&&e.Object===Object&&e,$1=typeof self=="object"&&self&&self.Object===Object&&self,_s=ly||$1||Function("return this")(),Qs=_s.Symbol,dy=Object.prototype,H1=dy.hasOwnProperty,py=dy.toString,Js=Qs?Qs.toStringTag:void 0,ma=function(T){var F=H1.call(T,Js),D=T[Js];try{T[Js]=void 0;var M=!0}catch{}var z=py.call(T);return M&&(F?T[Js]=D:delete T[Js]),z},ip=Object.prototype.toString,fy=function(T){return ip.call(T)},gy=Qs?Qs.toStringTag:void 0,Sc=function(T){return T==null?T===void 0?"[object Undefined]":"[object Null]":gy&&gy in Object(T)?ma(T):fy(T)},ga=function(T){var F=typeof T;return T!=null&&(F=="object"||F=="function")},sp=function(T){if(!ga(T))return!1;var F=Sc(T);return F=="[object Function]"||F=="[object GeneratorFunction]"||F=="[object AsyncFunction]"||F=="[object Proxy]"},hy={deviceId:"",timeout:8e3},V1={account:"",appkey:"",token:"",debugLevel:"off",needReconnect:!0,reconnectionAttempts:ng,isAbtestEnable:!0,abtestUrl:"https://abt-online.netease.im/v1/api/abt/client/getExperimentInfo",abtestProjectKey:"imElite_sdk_abtest_web"},yy="weblink.netease.im:443",z1=ul.includes,W1=u(function(){return!Array(1).includes()});qr({target:"Array",proto:!0,forced:W1},{includes:function(T){return z1(this,T,arguments.length>1?arguments[1]:void 0)}});var G1=Ao("Array").includes,hg=Yn("match"),yg=TypeError,ha=function(x){if(function(T){var F;return xe(T)&&((F=T[hg])!==void 0?!!F:Oe(T)=="RegExp")}(x))throw yg("The method doesn't accept regular expressions");return x},K1=Yn("match"),Q1=re("".indexOf);qr({target:"String",proto:!0,forced:!function(x){var T=/./;try{"/./"[x](T)}catch{try{return T[K1]=!1,"/./"[x](T)}catch{}}return!1}("includes")},{includes:function(T){return!!~Q1(_i(pr(this)),_i(ha(T)),arguments.length>1?arguments[1]:void 0)}});var vy=Ao("String").includes,vg=Array.prototype,dd=String.prototype,Mc=function(x){var T=x.includes;return x===vg||Lt(vg,x)&&T===vg.includes?G1:typeof x=="string"||x===dd||Lt(dd,x)&&T===dd.includes?vy:T},J1=hs.findIndex,Y1="findIndex",ap=!0;Y1 in[]&&Array(1).findIndex(function(){ap=!1}),qr({target:"Array",proto:!0,forced:ap},{findIndex:function(T){return J1(this,T,arguments.length>1?arguments[1]:void 0)}});var by=Ao("Array").findIndex,bg=Array.prototype,X1=function(x){var T=x.findIndex;return x===bg||Lt(bg,x)&&T===bg.findIndex?by:T},Tg=s(function(x){function T(F){var D;return x.exports=T=Rs?Mo(D=Us).call(D):function(z){return z.__proto__||Us(z)},x.exports.__esModule=!0,x.exports.default=x.exports,T(F)}x.exports=T,x.exports.__esModule=!0,x.exports.default=x.exports}),ai=s(function(x){x.exports=function(F){var D;return bi(D=Function.toString.call(F)).call(D,"[native code]")!==-1},x.exports.__esModule=!0,x.exports.default=x.exports}),Sg=dr("Reflect","construct"),Mg=Object.prototype,Z1=[].push,Ty=u(function(){function x(){}return!(Sg(function(){},[],x)instanceof x)}),Cg=!u(function(){Sg(function(){})}),kg=Ty||Cg;qr({target:"Reflect",stat:!0,forced:kg,sham:kg},{construct:function(T,F){ru(T),Dn(F);var D=arguments.length<3?T:ru(arguments[2]);if(Cg&&!Ty)return Sg(T,F,D);if(T==D){switch(F.length){case 0:return new T;case 1:return new T(F[0]);case 2:return new T(F[0],F[1]);case 3:return new T(F[0],F[1],F[2]);case 4:return new T(F[0],F[1],F[2],F[3])}var M=[null];return k(Z1,M,F),new(k(fl,T,M))}var z=D.prototype,pe=ki(xe(z)?z:Mg),ae=k(T,pe,F);return xe(ae)?ae:pe}});var Pa=nr.Reflect.construct,oc=s(function(x){x.exports=function(){if(typeof Reflect>"u"||!Pa||Pa.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Pa(Boolean,[],function(){})),!0}catch{return!1}},x.exports.__esModule=!0,x.exports.default=x.exports}),eT=s(function(x){function T(F,D,M){var z;return oc()?(x.exports=T=Mo(z=Pa).call(z),x.exports.__esModule=!0,x.exports.default=x.exports):(x.exports=T=function(ae,ze,jt){var ur=[null];ur.push.apply(ur,ze);var hr=new(Mo(Function).apply(ae,ur));return jt&&gl(hr,jt.prototype),hr},x.exports.__esModule=!0,x.exports.default=x.exports),T.apply(null,arguments)}x.exports=T,x.exports.__esModule=!0,x.exports.default=x.exports}),tT=s(function(x){function T(F){var D=typeof nc=="function"?new nc:void 0;return x.exports=T=function(z){if(z===null||!ai(z))return z;if(typeof z!="function")throw new TypeError("Super expression must either be null or a function");if(D!==void 0){if(D.has(z))return D.get(z);D.set(z,pe)}function pe(){return eT(z,arguments,Tg(this).constructor)}return pe.prototype=Qi(z.prototype,{constructor:{value:pe,enumerable:!1,writable:!0,configurable:!0}}),gl(pe,z)},x.exports.__esModule=!0,x.exports.default=x.exports,T(F)}x.exports=T,x.exports.__esModule=!0,x.exports.default=x.exports}),ic=function(x){function T(F,D,M){var z;return D===void 0&&(D={}),M===void 0&&(M=400),(z=x.call(this,F)||this).data=D,z.code=M,z.name="customError",z}return Co(T,x),T}(r(tT)(Error)),uo=function(x){function T(F,D,M){var z;return D===void 0&&(D={}),(z=x.call(this,F,D,414)||this).code=414,z.name="validateError",z.rules=M,z}return Co(T,x),T}(ic),cu={200:null,406:null,808:null,810:null,201:"The client version is incorrect. You need to upgrade the SDK",302:"The user name or password is incorrect. Please check whether the appkey and token are valid and whether the account and token match",403:"Illegal operation or no permission",404:"Target object does not exist",405:"Parameter length too long",408:"Client request timed out",414:"Request parameter error",415:"Service unavailable",416:"Frequency control",417:"Repeat operation",422:"Account disabled",500:"Server internal error",503:"Server busy",508:"Expiration date",509:"Invalid",7101:"Be pulled black",700:"Partial failure of batch operation",801:"The number of people in the team has reached the upper limit",802:"No permission",803:"The team does not exist or has not changed",804:"The user is not in the team",805:"Team type mismatch",806:"The number of teams created has reached the limit",807:"Team member not valid",809:"Already in the team",811:"The number of accounts in the forced push list exceeds the limit",812:"The team is muted",813:"Due to the limited number of team, some pull people successfully",814:"Disable team message read service",815:"Maximum number of team administrators",816:"Batch operation partial failure",997:"The packet has expired",998:"Deserialize packet error",999:"Serialize packet error",9102:"Channel failure",9103:"This call has been answered / rejected at another end",10201:"Signaling: target NIM client is offline",10202:"Signaling: push is unreachable",10404:"Signaling: channel not exists",10405:"Signaling: channel already exists",10406:"Signaling: member of channel not exists",10407:"Signaling: member of channel already exists",10408:"Signaling: the invitation request does not exist or has expired",10409:"Signaling: the invitation request has been rejected",10410:"Signaling: the invitation request has been accepted",10414:"Signaling: request parameter error",10417:"Signaling: uid conflict",10419:"Signaling: the number of members of channel exceed the limit",10420:"Signaling: member is already in the channel on other client",10700:"Signaling: phased success",13002:"Abnormal chatroom status",13003:"In the blacklist",13004:"In the mute list",13006:"All members are muted, and only the administrator can speak"},cp=function(x){function T(F,D,M,z,pe){var ae;return M===void 0&&(M=""),z===void 0&&(z=new Date().getTime()),pe===void 0&&(pe={}),M=M||cu[F],(ae=x.call(this,M,pe,F)||this).name="cmdError",ae.cmd=D,ae.timetag=z,ae}return Co(T,x),T}(ic),xg=function(x){function T(F,D,M){var z;return(z=x.call(this,F,{},412)||this).code=412,z.name="formatError",z.key=D,z.reason=M,z}return Co(T,x),T}(ic),Nu=function(x){function T(F,D,M,z,pe){var ae;return(ae=x.call(this,F,{file:pe},400)||this).name="uploadError",ae.rawError=D,ae.curProvider=M||1,ae.mixStorePolicy=z,ae}return Co(T,x),T}(ic),Cc=["error","warn","log","debug"],uu=function(){},pd=["off","error","warn","log","debug"],up=function(){function x(F,D){this.name=D,this.strategies={debug:console.log,log:console.log,warn:console.warn,error:console.error},this.debug=uu,this.log=uu,this.warn=uu,this.error=uu,this.name=D,x.instancesName.push(D),Mc(pd).call(pd,F)||(F="off"),this.setLogFunc(F)}var T=x.prototype;return T.setLogFunc=function(D){var M=this,z=X1(Cc).call(Cc,function(pe){return pe===D});kn(Cc).call(Cc,function(pe,ae){ae<=z&&(M[pe]=function(){var ze=fo(Array.prototype).call(arguments),jt=this.formatArgs(ze,pe);this.strategies[pe](jt)})})},T.formatArgs=function(D,M){var z=new Date,pe=z.getMonth()+1+"-"+z.getDate()+" "+z.getHours()+":"+z.getMinutes()+":"+z.getSeconds()+":"+z.getMilliseconds();return"[NIM "+M+" "+this.name+" "+pe+"] "+lo(D).call(D,function(ae){return ae instanceof ic?ae.name+", "+ae.code+", "+ae.message:ae instanceof Error?ae&&ae.message?ae.message:ae:typeof ae=="object"?Uo(ae):ae}).join(" ")},x}();up.instancesName=[],qr({global:!0},{globalThis:c});var Sy=hs.filter,rT=Ha("filter");qr({target:"Array",proto:!0,forced:!rT},{filter:function(T){return Sy(this,T,arguments.length>1?arguments[1]:void 0)}});var Yo=Ao("Array").filter,wg=Array.prototype,ss=function(x){var T=x.filter;return x===wg||Lt(wg,x)&&T===wg.filter?Yo:T},nT=s(function(x,T){x.exports=function(){function F(jt,ur){if(!(jt instanceof ur))throw new TypeError("Cannot call a class as a function")}function D(jt,ur){for(var hr=0;hr<ur.length;hr++){var br=ur[hr];br.enumerable=br.enumerable||!1,br.configurable=!0,"value"in br&&(br.writable=!0),Qa(jt,br.key,br)}}function M(jt,ur,hr){return ur&&D(jt.prototype,ur),hr&&D(jt,hr),Qa(jt,"prototype",{writable:!1}),jt}var z={reportUrl:"https://statistic.live.126.net/statics/report/common/form",maxSize:100,msgListMaxSize:1e3,cacheMaxSize:1e3,maxDelay:3e5,maxInterval:3e4,minInterval:1e4,timeout:5e3,autoStart:!0},pe="https://statistic.live.126.net/dispatcher/req",ae=function(){},ze=function(){function jt(ur){F(this,jt),this.enable=!1,this.initConfigLoaded=!1,this.loading=!1,this.isDestroyed=!1,this.reportConfig=z,this.msgList=[],this.traceMsgCache={},this.lowPriorityMsgList=[],this.cacheMsgList=[],this.lastReportTime=ti(),this.timer=null,this.setConfig(ur),this.reportConfig.autoStart&&this.initUploadConfig()}return M(jt,[{key:"setConfig",value:function(hr){this.reportConfig=kr({},this.reportConfig,hr)}},{key:"reportImmediately",value:function(hr,br){var Cr=this;this.reportConfig.request(hr,kr({dataType:"json",method:"POST",timeout:this.reportConfig.timeout},br)).catch(function(_r){var Nr,Br;(Br=(Nr=Cr.reportConfig)===null||Nr===void 0?void 0:Nr.logger)===null||Br===void 0||Br.warn("Reporter immediately upload failed",_r)})}},{key:"report",value:function(hr,br){var Cr=arguments.length>2&&arguments[2]!==void 0&&arguments[2];if(hr){var _r=ti();Cr?this.lowPriorityMsgList.push({module:hr,msg:br,createTime:_r}):this.msgList.push({module:hr,msg:br,createTime:_r}),this.msgList.length>this.reportConfig.msgListMaxSize&&this.msgList.shift(),this.lowPriorityMsgList.length>this.reportConfig.msgListMaxSize&&this.lowPriorityMsgList.shift(),this.doReport()}}},{key:"reportTraceStart",value:function(hr,br){if(hr&&!this.traceMsgCache[hr]){var Cr=kr(kr({start_time:ti()},br),{extension:[]});this.traceMsgCache[hr]=Cr}}},{key:"reportTraceUpdate",value:function(hr){}},{key:"reportTraceUpdateV2",value:function(hr,br){if(this.traceMsgCache[hr]){var Cr=this.traceMsgCache[hr].extension.length,_r=new Date().getTime();br.duration=Cr===0?_r-this.traceMsgCache[hr].start_time:_r-this.traceMsgCache[hr].extension[Cr-1].end_time,this.traceMsgCache[hr].extension.push(kr({end_time:_r},br))}}},{key:"reportTraceEnd",value:function(hr){var br,Cr=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];this.traceMsgCache[hr]&&(hr!=="nos"||Cr===!1?(typeof Cr=="boolean"?this.traceMsgCache[hr].succeed=!!Cr:this.traceMsgCache[hr].state=Cr,this.traceMsgCache[hr].duration=ti()-this.traceMsgCache[hr].start_time,kn(br=this.traceMsgCache[hr].extension).call(br,function(_r){delete _r.end_time}),this.report(hr,this.traceMsgCache[hr]),this.traceMsgCache[hr]=null):this.traceMsgCache[hr]=null)}},{key:"reportTraceCancel",value:function(hr){this.traceMsgCache[hr]=null}},{key:"pause",value:function(){this.enable=!1}},{key:"restore",value:function(){this.enable=!0,this.initConfigLoaded||this.initUploadConfig()}},{key:"destroy",value:function(){var hr,br=this;kn(hr=No(this.traceMsgCache)).call(hr,function(Cr){br.reportTraceEnd(Cr,1)}),this.timer!==null&&clearTimeout(this.timer),this.setConfig=ae,this.report=ae,this.reportTraceStart=ae,this.reportTraceUpdate=ae,this.reportTraceEnd=ae,this.pause=ae,this.restore=ae,this.destroy=ae,this.cacheMsgList=[],this.traceMsgCache={},this.lowPriorityMsgList=[],this.msgList=[],this.reportConfig={},this.isDestroyed=!0}},{key:"initUploadConfig",value:function(){var hr,br,Cr=this;if(!this.loading){this.loading=!0;var _r=this.reportConfig.common||{};try{this.reportConfig.request(pe,{method:"GET",dataType:"json",params:{deviceId:_r.dev_id,sdkVer:_r.sdk_ver,platform:_r.platform,appkey:_r.app_key},timeout:this.reportConfig.timeout}).then(function(Nr){var Br,Hr;if(!Cr.isDestroyed){if(Nr.status===200&&Nr.data&&Nr.data.code===200){var $r=Nr.data.data||{};Cr.reportConfig.maxSize=$r.maxSize>1e3?1e3:$r.maxSize,Cr.reportConfig.maxInterval=$r.maxInterval>1e4?1e4:$r.maxInterval,Cr.reportConfig.maxInterval=$r.maxInterval<10?10:$r.maxInterval,Cr.reportConfig.minInterval=$r.minInterval<2?2:$r.minInterval,Cr.reportConfig.maxDelay=$r.maxDelay||300,Cr.reportConfig.maxInterval=1e3*Cr.reportConfig.maxInterval,Cr.reportConfig.minInterval=1e3*Cr.reportConfig.minInterval,Cr.reportConfig.maxDelay=1e3*Cr.reportConfig.maxDelay,Cr.enable=!0,Cr.initConfigLoaded=!0,Cr.loading=!1,Cr.reportHeartBeat()}(Hr=(Br=Cr.reportConfig)===null||Br===void 0?void 0:Br.logger)===null||Hr===void 0||Hr.log("Get reporter upload config success")}}).catch(function(Nr){var Br,Hr;Cr.loading=!1,(Hr=(Br=Cr.reportConfig)===null||Br===void 0?void 0:Br.logger)===null||Hr===void 0||Hr.error("Get reporter upload config failed",Nr)})}catch(Nr){this.loading=!1,(br=(hr=this.reportConfig)===null||hr===void 0?void 0:hr.logger)===null||br===void 0||br.error("Exec reporter request failed",Nr)}}}},{key:"reportHeartBeat",value:function(){var hr=this;this.isDestroyed||(this.timer=co(function(){hr.reportHeartBeat()},this.reportConfig.minInterval),this.doReport())}},{key:"doReport",value:function(){if(!this.isDestroyed){var hr=this.msgList.length+this.lowPriorityMsgList.length+this.cacheMsgList.length>2*this.reportConfig.maxSize?this.reportConfig.minInterval:this.reportConfig.maxInterval;ti()-this.lastReportTime>=hr&&this.upload()}}},{key:"getUploadMsg",value:function(){var hr,br,Cr,_r,Nr,Br=this,Hr={},$r=ti();this.msgList=ss(hr=this.msgList).call(hr,function(wn){return $r-wn.createTime<Br.reportConfig.maxDelay}),this.lowPriorityMsgList=ss(br=this.lowPriorityMsgList).call(br,function(wn){return $r-wn.createTime<Br.reportConfig.maxDelay}),this.cacheMsgList=ss(Cr=this.cacheMsgList).call(Cr,function(wn){return $r-wn.createTime<Br.reportConfig.maxDelay});var Vr=fo(_r=this.msgList).call(_r,0,this.reportConfig.maxSize);if(this.msgList=fo(Nr=this.msgList).call(Nr,Vr.length),Vr.length<this.reportConfig.maxSize){var bn,Wn,qn=this.reportConfig.maxSize-Vr.length;Vr=Ss(Vr).call(Vr,fo(bn=this.lowPriorityMsgList).call(bn,0,qn)),this.lowPriorityMsgList=fo(Wn=this.lowPriorityMsgList).call(Wn,qn)}if(Vr.length<this.reportConfig.maxSize){var yo,Fn,xr=this.reportConfig.maxSize-Vr.length;Vr=Ss(Vr).call(Vr,fo(yo=this.cacheMsgList).call(yo,0,xr)),this.cacheMsgList=fo(Fn=this.cacheMsgList).call(Fn,xr)}return kn(Vr).call(Vr,function(wn){Hr[wn.module]?Hr[wn.module].push(wn.msg):Hr[wn.module]=[wn.msg]}),{uploadMsgArr:Vr,uploadMsg:Hr}}},{key:"upload",value:function(){var hr,br,Cr=this;if(this.enable&&!(this.lastReportTime&&ti()-this.lastReportTime<this.reportConfig.minInterval)){var _r=this.getUploadMsg(),Nr=_r.uploadMsgArr,Br=_r.uploadMsg;if(Nr.length){this.lastReportTime=ti();try{this.reportConfig.request(this.reportConfig.reportUrl,{dataType:"json",method:"POST",data:{common:this.reportConfig.common,event:Br},headers:{sdktype:"im"},timeout:this.reportConfig.timeout}).catch(function(Hr){var $r,Vr,bn,Wn;Cr.cacheMsgList=fo($r=Ss(Vr=Cr.cacheMsgList).call(Vr,Nr)).call($r,0,Cr.reportConfig.cacheMaxSize),(Wn=(bn=Cr.reportConfig)===null||bn===void 0?void 0:bn.logger)===null||Wn===void 0||Wn.warn("Reporter upload failed",Hr)})}catch(Hr){(br=(hr=this.reportConfig)===null||hr===void 0?void 0:hr.logger)===null||br===void 0||br.warn("Exec reporter request failed",Hr)}clearTimeout(this.timer),this.reportHeartBeat()}}}}]),jt}();return ze}()}),Fo={setLogger:function(T){throw new Error("Function not implemented.")},platform:"",WebSocket:function(){function x(F,D){throw this.CONNECTING=0,this.OPEN=1,this.CLOSING=2,this.CLOSED=3,new Error("Method not implemented.")}var T=x.prototype;return T.close=function(D,M){throw new Error("Method not implemented.")},T.send=function(D){throw new Error("Method not implemented.")},T.onclose=function(D){throw new Error("Method not implemented.")},T.onerror=function(D){throw new Error("Method not implemented.")},T.onmessage=function(D){throw new Error("Method not implemented.")},T.onopen=function(D){throw new Error("Method not implemented.")},x}(),localStorage:{},request:function(T,F){throw new Error("Function not implemented.")},uploadFile:function(T){throw new Error("Function not implemented.")},getSystemInfo:function(){throw new Error("Function not implemented.")}},Ys=TypeError,My=function(x){return function(T,F,D,M){Or(F);var z=An(T),pe=er(z),ae=Ci(z),ze=x?ae-1:0,jt=x?-1:1;if(D<2)for(;;){if(ze in pe){M=pe[ze],ze+=jt;break}if(ze+=jt,x?ze<0:ae<=ze)throw Ys("Reduce of empty array with no initial value")}for(;x?ze>=0:ae>ze;ze+=jt)ze in pe&&(M=F(M,pe[ze],ze,z));return M}},Ko={left:My(!1),right:My(!0)}.left,oT=Ds("reduce");qr({target:"Array",proto:!0,forced:!oT||!Li&&gr>79&&gr<83},{reduce:function(T){var F=arguments.length;return Ko(this,T,F,F>1?arguments[1]:void 0)}});var Cy=Ao("Array").reduce,Ig=Array.prototype,lp=function(x){var T=x.reduce;return x===Ig||Lt(Ig,x)&&T===Ig.reduce?Cy:T},ky=function(T){return T===void 0},Fu={},kc={};function xy(x,T){var F,D,M;try{M=JSON.parse(x)}catch(Cr){throw T.error("Parse command error: ",x),Cr}var z=M.sid+"_"+M.cid,pe=M.r;if(Mc(F=["4_1","4_2","4_10","4_11"]).call(F,z)){var ae=M.r[1].headerPacket;z=ae.sid+"_"+ae.cid,pe=M.r[1].body}var ze,jt=kc[z],ur=Fu[jt],hr=function(_r,Nr){var Br=cu[_r];return Br===null?null:new cp(_r,Nr,Br,new Date().getTime())}(M.code,jt),br={cmd:jt,raw:M,error:hr,service:ur==null?void 0:ur.service,content:{}};if(br.error){if(br.error.cmd=jt,br.error.callFunc="parseCmd",!(!((D=ur==null?void 0:ur.ignoreErrCodes)===null||D===void 0)&&Mc(D).call(D,M.code)))return br;T.warn("parseCmd:: ignore error ",br.error),br.error.ignore=!0}return!jt||!ur?(br.notFound=!0,br):(ur.response&&kn(ze=ur.response).call(ze,function(Cr,_r){var Nr=pe[_r],Br=Cr.type,Hr=Cr.name,$r=Cr.reflectMapper;if(!ky(Nr))switch(Br){case"Property":br.content[Hr]=$r?Aa(Nr,$r):Nr;break;case"PropertyArray":br.content[Hr]=lo(Nr).call(Nr,function(Vr){return $r?Aa(Vr,$r):Vr});break;case"long":case"Long":case"byte":case"Byte":case"Number":br.content[Hr]=+Nr;break;default:br.content[Hr]=Nr}}),br)}function fd(x,T){var F={};for(var D in x)T[D]!==void 0&&(F[T[D]]=x[D]);return F}function Aa(x,T){var F={};for(var D in x)T[D]!==void 0&&(F[T[D]]=x[D]);return F}function Ui(x){Fu=kr(Fu,x.cmdConfig),kc=kr(kc,x.cmdMap)}function ts(x){var T;return lp(T=No(x)).call(T,function(F,D){var M,z=x[D];return F[D]=lp(M=No(z)).call(M,function(pe,ae){return pe[z[ae]]=ae,pe},{}),F},{})}var Ei=["disconnect","connect","heartbeat","message","json","event","ack","error","noop"],Oa=["transport not supported","client not handshaken","unauthorized"],xc=["reconnect"],_g=function(x){function T(D,M,z){var pe;return(pe=x.call(this)||this).url=M,pe.logger=z,pe.websocket=null,pe.core=D,pe.url=M,pe.status="disconnected",pe.logger=z,pe.connect(),pe}Co(T,x);var F=T.prototype;return F.connect=function(){var M=this;this.status!=="connecting"&&this.status!=="connected"?(this.status="connecting",this.core.adapters.request("https://"+this.url+"/socket.io/1/?t="+ti(),{method:"GET",dataType:"text",timeout:8e3}).then(function(z){var pe=z.data.split(":"),ae=pe[0],ze=pe[1];return M.sessionId=ae,M.closeTimeout=1e3*ze,M._createWebsocket("wss://"+M.url+"/socket.io/1/websocket/"+ae)}).catch(function(z){M.logger.error("imsocket::handshake fail. ",z&&z.message),M.status="disconnected",M.emit("handshakeFailed")})):this.logger.warn("imsocket::socket is connecting or connected",this.status)},F.close=function(){if(this.websocket){this.logger.log("imsocket:: close websocket");try{this.websocket.send(this.encodePacket({type:"disconnect"})),this.websocket.close()}catch(M){this.logger.warn("attempt to close websocket error",M)}this.clean()}},F.clean=function(){this.status="disconnected",this.websocket&&(this.websocket.onmessage=null,this.websocket.onopen=null,this.websocket.onerror=null,this.websocket.onclose=null,this.websocket=null,this.emit("disconnect"))},F.onConnect=function(){this.status="connected",this.resetCloseTimer(),this.emit("connect")},F._createWebsocket=function(M){var z,pe=this;this.websocket=new Fo.WebSocket(M),this.websocket.onmessage=Mo(z=this.onMessage).call(z,this),this.websocket.onclose=function(){pe.logger.log("imsocket:: receive websocket onclose event, current status",pe.status),pe.clean()},this.websocket.onerror=function(ae){pe.logger.error("imsocket:: onerror",ae)}},F.onMessage=function(M){var z;this.resetCloseTimer();var pe=this.decodePacket(M.data);if(pe)switch(pe.type){case"connect":this.onConnect();break;case"disconnect":this.close();break;case"message":case"json":this.emit("message",pe.data);break;case"event":pe.name&&this.emit(pe.name,pe.args);break;case"error":pe.reason==="unauthorized"?this.emit("connect_failed",pe.reason):this.emit("error",pe.reason);break;case"heartbeat":(z=this.websocket)===null||z===void 0||z.send(this.encodePacket({type:"heartbeat"}));break;default:this.logger.warn("imsocket::no handler type",pe.type)}},F.encodePacket=function(M){var z,pe,ae=M.type,ze=M.id,jt=ze===void 0?"":ze,ur=M.endpoint,hr=ur===void 0?"":ur,br=M.ack,Cr=null;if(!ae)return"";switch(ae){case"error":z=M.reason?bi(Oa).call(Oa,M.reason):"",pe=M.advice?bi(xc).call(xc,M.advice):"",z===""&&pe===""||(Cr=z+(pe!==""?"+"+pe:""));break;case"message":M.data!==""&&(Cr=M.data);break;case"event":z={name:M.name},z=M.args&&M.args.length?{name:M.name,args:M.args}:{name:M.name},Cr=Uo(z);break;case"json":Cr=Uo(M.data);break;case"connect":M.qs&&(Cr=M.qs);break;case"ack":Cr=M.ackId+(M.args&&M.args.length?"+"+Uo(M.args):"")}var _r=[bi(Ei).call(Ei,ae),jt+(br==="data"?"+":""),hr];return Cr!=null&&_r.push(Cr),_r.join(":")},F.decodePacket=function(M){if(M)if(M.charAt(0)!="�"){var z=M.match(/([^:]+):([0-9]+)?(\+)?:([^:]+)?:?([\s\S]*)?/);if(z){var pe,ae=z[1],ze=z[2],jt=z[3],ur=z[4],hr=z[5],br={type:Ei[+ae],endpoint:ur};switch(ze&&(br.id=ze,br.ack=!jt||"data"),br.type){case"error":pe=hr.split("+"),br.reason=Oa[+pe[0]]||"";break;case"message":br.data=hr||"";break;case"connect":br.qs=hr||"";break;case"event":try{var Cr=JSON.parse(hr);br.name=Cr.name,br.args=Cr.args}catch(_r){this.logger.error("imsocket::parseData::type::event error",_r)}br.args=br.args||[];break;case"json":try{br.data=JSON.parse(hr)}catch(_r){this.logger.error("imsocket::parseData::type::json error",_r)}break;case"ack":if((pe=hr.match(/^([0-9]+)(\+)?(.*)/))&&(br.ackId=pe[1],br.args=[],pe[3]))try{br.args=pe[3]?JSON.parse(pe[3]):[]}catch(_r){this.logger.error("imsocket::parseData::type::ack error",_r)}}return br}}else this.logger.error("imsocket::unrecognize dataStr",fo(M).call(M,0,20))},F.send=function(M){var z,pe={data:M,type:"message",endpoint:""};(z=this.websocket)===null||z===void 0||z.send(this.encodePacket(pe))},F.resetCloseTimer=function(){var M=this;this.closeTimeout&&(clearTimeout(this.closeTimer),this.closeTimer=co(function(){M.close()},this.closeTimeout))},T}(Hs),Eg=Ao("Array").values,dp=Array.prototype,iT={DOMTokenList:!0,NodeList:!0},pp=function(x){var T=x.values;return x===dp||Lt(dp,x)&&T===dp.values||Nn(iT,Fs(x))?Eg:T};qr({target:"Array",stat:!0},{isArray:Ji});var ya=nr.Array.isArray,sT=hs.every,fp=Ds("every");qr({target:"Array",proto:!0,forced:!fp},{every:function(T){return sT(this,T,arguments.length>1?arguments[1]:void 0)}});var rs=Ao("Array").every,Pg=Array.prototype,aT=function(x){var T=x.every;return x===Pg||Lt(Pg,x)&&T===Pg.every?rs:T},va=function(T){return T!=null&&typeof T=="object"},Ag=function(T){return va(T)&&Sc(T)=="[object RegExp]"},ju=function(T){return function(F){return T(F)}},as=s(function(x,T){var F=T&&!T.nodeType&&T,D=F&&x&&!x.nodeType&&x,M=D&&D.exports===F&&ly.process,z=function(){try{var pe=D&&D.require&&D.require("util").types;return pe||M&&M.binding&&M.binding("util")}catch{}}();x.exports=z}),wy=as&&as.isRegExp,Og=wy?ju(wy):Ag,Bu=_s["__core-js_shared__"],Rg=function(){var x=/[^.]+$/.exec(Bu&&Bu.keys&&Bu.keys.IE_PROTO||"");return x?"Symbol(src)_1."+x:""}(),cT=function(T){return!!Rg&&Rg in T},Ng=Function.prototype.toString,wc=function(T){if(T!=null){try{return Ng.call(T)}catch{}try{return T+""}catch{}}return""},uT=/^\[object .+?Constructor\]$/,lT=Function.prototype,lu=Object.prototype,dT=lT.toString,pT=lu.hasOwnProperty,fT=RegExp("^"+dT.call(pT).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),mT=function(T){return!(!ga(T)||cT(T))&&(sp(T)?fT:uT).test(wc(T))},gT=function(T,F){return T==null?void 0:T[F]},du=function(T,F){var D=gT(T,F);return mT(D)?D:void 0},md=du(Object,"create"),hT=function(){this.__data__=md?md(null):{},this.size=0},pu=function(T){var F=this.has(T)&&delete this.__data__[T];return this.size-=F?1:0,F},gd=Object.prototype.hasOwnProperty,yT=function(T){var F=this.__data__;if(md){var D=F[T];return D==="__lodash_hash_undefined__"?void 0:D}return gd.call(F,T)?F[T]:void 0},vT=Object.prototype.hasOwnProperty,bT=function(T){var F=this.__data__;return md?F[T]!==void 0:vT.call(F,T)},TT=function(T,F){var D=this.__data__;return this.size+=this.has(T)?0:1,D[T]=md&&F===void 0?"__lodash_hash_undefined__":F,this};function Lu(x){var T=-1,F=x==null?0:x.length;for(this.clear();++T<F;){var D=x[T];this.set(D[0],D[1])}}Lu.prototype.clear=hT,Lu.prototype.delete=pu,Lu.prototype.get=yT,Lu.prototype.has=bT,Lu.prototype.set=TT;var Iy=Lu,ST=function(){this.__data__=[],this.size=0},sc=function(T,F){return T===F||T!=T&&F!=F},hd=function(T,F){for(var D=T.length;D--;)if(sc(T[D][0],F))return D;return-1},MT=Array.prototype.splice,mp=function(T){var F=this.__data__,D=hd(F,T);return!(D<0)&&(D==F.length-1?F.pop():MT.call(F,D,1),--this.size,!0)},gp=function(T){var F=this.__data__,D=hd(F,T);return D<0?void 0:F[D][1]},CT=function(T){return hd(this.__data__,T)>-1},kT=function(T,F){var D=this.__data__,M=hd(D,T);return M<0?(++this.size,D.push([T,F])):D[M][1]=F,this};function Uu(x){var T=-1,F=x==null?0:x.length;for(this.clear();++T<F;){var D=x[T];this.set(D[0],D[1])}}Uu.prototype.clear=ST,Uu.prototype.delete=mp,Uu.prototype.get=gp,Uu.prototype.has=CT,Uu.prototype.set=kT;var hp=Uu,yd=du(_s,"Map"),Du=function(){this.size=0,this.__data__={hash:new Iy,map:new(yd||hp),string:new Iy}},yp=function(T){var F=typeof T;return F=="string"||F=="number"||F=="symbol"||F=="boolean"?T!=="__proto__":T===null},Ic=function(T,F){var D=T.__data__;return yp(F)?D[typeof F=="string"?"string":"hash"]:D.map},xT=function(T){var F=Ic(this,T).delete(T);return this.size-=F?1:0,F},wT=function(T){return Ic(this,T).get(T)},vp=function(T){return Ic(this,T).has(T)},IT=function(T,F){var D=Ic(this,T),M=D.size;return D.set(T,F),this.size+=D.size==M?0:1,this};function qu(x){var T=-1,F=x==null?0:x.length;for(this.clear();++T<F;){var D=x[T];this.set(D[0],D[1])}}qu.prototype.clear=Du,qu.prototype.delete=xT,qu.prototype.get=wT,qu.prototype.has=vp,qu.prototype.set=IT;var bp=qu,_T=function(T){return this.__data__.set(T,"__lodash_hash_undefined__"),this},$u=function(T){return this.__data__.has(T)};function fu(x){var T=-1,F=x==null?0:x.length;for(this.__data__=new bp;++T<F;)this.add(x[T])}fu.prototype.add=fu.prototype.push=_T,fu.prototype.has=$u;var Fg=fu,_y=function(T,F,D,M){for(var z=T.length,pe=D+(M?1:-1);M?pe--:++pe<z;)if(F(T[pe],pe,T))return pe;return-1},Tp=function(T){return T!=T},jg=function(T,F,D){for(var M=D-1,z=T.length;++M<z;)if(T[M]===F)return M;return-1},ET=function(T,F,D){return F==F?jg(T,F,D):_y(T,Tp,D)},Ey=function(T,F){return!!(T!=null&&T.length)&&ET(T,F,0)>-1},Py=function(T,F,D){for(var M=-1,z=T==null?0:T.length;++M<z;)if(D(F,T[M]))return!0;return!1},Bg=function(T,F){for(var D=-1,M=T==null?0:T.length,z=Array(M);++D<M;)z[D]=F(T[D],D,T);return z},Sp=function(T,F){return T.has(F)},Ay=function(T,F,D,M){var z=-1,pe=Ey,ae=!0,ze=T.length,jt=[],ur=F.length;if(!ze)return jt;D&&(F=Bg(F,ju(D))),M?(pe=Py,ae=!1):F.length>=200&&(pe=Sp,ae=!1,F=new Fg(F));e:for(;++z<ze;){var hr=T[z],br=D==null?hr:D(hr);if(hr=M||hr!==0?hr:0,ae&&br==br){for(var Cr=ur;Cr--;)if(F[Cr]===br)continue e;jt.push(hr)}else pe(F,br,M)||jt.push(hr)}return jt},Hu=function(T){return T},Lg=function(T,F,D){switch(D.length){case 0:return T.call(F);case 1:return T.call(F,D[0]);case 2:return T.call(F,D[0],D[1]);case 3:return T.call(F,D[0],D[1],D[2])}return T.apply(F,D)},Ug=Math.max,Mp=function(T,F,D){return F=Ug(F===void 0?T.length-1:F,0),function(){for(var M=arguments,z=-1,pe=Ug(M.length-F,0),ae=Array(pe);++z<pe;)ae[z]=M[F+z];z=-1;for(var ze=Array(F+1);++z<F;)ze[z]=M[z];return ze[F]=D(ae),Lg(T,this,ze)}},Oy=function(T){return function(){return T}},vd=function(){try{var x=du(Object,"defineProperty");return x({},"",{}),x}catch{}}(),Ry=vd?function(x,T){return vd(x,"toString",{configurable:!0,enumerable:!1,value:Oy(T),writable:!0})}:Hu,PT=Date.now,Cp=function(T){var F=0,D=0;return function(){var M=PT(),z=16-(M-D);if(D=M,z>0){if(++F>=800)return arguments[0]}else F=0;return T.apply(void 0,arguments)}},Ny=Cp(Ry),Dg=function(T){return typeof T=="number"&&T>-1&&T%1==0&&T<=9007199254740991},kp=function(T){return T!=null&&Dg(T.length)&&!sp(T)},Fy=function(T){return va(T)&&kp(T)},jy=function(T,F){return Ny(Mp(T,F,Hu),T+"")}(function(x,T){return Fy(x)?Ay(x,T):[]}),qg=jy;function xp(x,T){return T instanceof RegExp?"__REGEXP "+T.toString():T}function xn(x,T,F){var D;T===void 0&&(T={});var M={};return kn(D=No(x)).call(D,function(z){var pe=x[z].type,ae=F?"In "+F+", ":"";if(T[z]===void 0){if(x[z].required===!1)return void(M[z]=T[z]);throw new uo(ae+'param "'+z+'" is required',{key:z},"required")}var ze=AT[pe];if(ze&&!ze(T,z,x[z]))throw new uo(ae+'param "'+z+'" expects '+Uo(x[z],xp),{key:z,value:T[z]},Uo(x[z]));M[z]=T[z]}),M}var AT={string:function(T,F,D){var M=D.allowEmpty,z=D.max,pe=D.min,ae=D.regExp,ze=T[F];return typeof ze=="string"&&(M!==!1||ze!=="")&&!(typeof z=="number"&&ze.length>z)&&!(typeof pe=="number"&&ze.length<pe)&&!(Og(ae)&&!ae.test(ze))},number:function(T,F,D){var M=D.min,z=D.max,pe=T[F];return typeof pe=="number"&&!(typeof M=="number"&&pe<M)&&!(typeof z=="number"&&pe>z)},boolean:function(T,F){return typeof T[F]=="boolean"},enum:function(T,F,D){var M=pp(D),z=T[F];return!M||bi(M).call(M,z)>-1},array:function(T,F,D){var M,z=D.itemType,pe=D.rules,ae=D.min,ze=D.max,jt=pp(D),ur=T[F];return!!ya(ur)&&!(typeof ze=="number"&&ur.length>ze)&&!(typeof ae=="number"&&ur.length<ae)&&!(z&&z!=="enum"&&!aT(ur).call(ur,function(hr){return typeof hr===z}))&&(z!=="enum"||!jt||!qg.apply(void 0,Ss(M=[ur]).call(M,jt)).length)&&(pe&&kn(ur).call(ur,function(hr,br){return xn(pe,hr,F+"["+br+"]")}),!0)},object:function(T,F,D){var M=D.rules,z=T[F];return M&&xn(M,z,F),!0}},Vu=du(_s,"Set"),OT=function(){},zr=function(T){var F=-1,D=Array(T.size);return T.forEach(function(M){D[++F]=M}),D},RT=Vu&&1/zr(new Vu([,-0]))[1]==1/0?function(x){return new Vu(x)}:OT,zu=RT,NT=function(T,F,D){var M=-1,z=Ey,pe=T.length,ae=!0,ze=[],jt=ze;if(D)ae=!1,z=Py;else if(pe>=200){var ur=F?null:zu(T);if(ur)return zr(ur);ae=!1,z=Sp,jt=new Fg}else jt=F?[]:ze;e:for(;++M<pe;){var hr=T[M],br=F?F(hr):hr;if(hr=D||hr!==0?hr:0,ae&&br==br){for(var Cr=jt.length;Cr--;)if(jt[Cr]===br)continue e;F&&jt.push(br),ze.push(hr)}else z(jt,br,D)||(jt!==ze&&jt.push(br),ze.push(hr))}return ze},wp=function(T){return T&&T.length?NT(T):[]},$g=`	
\v\f\r                　\u2028\u2029\uFEFF`,By=re("".replace),Ip="["+$g+"]",FT=RegExp("^"+Ip+Ip+"*"),Hg=RegExp(Ip+Ip+"*$"),_p=function(x){return function(T){var F=_i(pr(T));return 1&x&&(F=By(F,FT,"")),2&x&&(F=By(F,Hg,"")),F}},Ep={start:_p(1),end:_p(2),trim:_p(3)}.trim,bd=c.parseInt,Ly=c.Symbol,Pp=Ly&&Ly.iterator,Uy=/^[+-]?0x/i,Td=re(Uy.exec),Vg=bd($g+"08")!==8||bd($g+"0x16")!==22||Pp&&!u(function(){bd(Object(Pp))})?function(T,F){var D=Ep(_i(T));return bd(D,F>>>0||(Td(Uy,D)?16:10))}:bd;qr({global:!0,forced:parseInt!=Vg},{parseInt:Vg});var Ra,go=nr.parseInt,Ap=(Ra=function(){return(65536*(1+Math.random())|0).toString(16).substring(1)},function(){return Ra()+Ra()+Ra()+Ra()+Ra()+Ra()+Ra()+Ra()});function ba(x){var T;return ss(T=No(x)).call(T,function(F){return!(+F>=0)})}function Na(x,T){var F,D=ss(F=No(x)).call(F,function(M){return x[M]==T});return D.length>0?D[0]:void 0}function wo(x,T){if(T===void 0&&(T="-"),!x)throw new ic("No sessionId",{},400);var F=bi(x).call(x,T);if(F===-1)throw new ic("Can not find conjunctions",{},400);var D=fo(x).call(x,0,F);return{accid:fo(x).call(x,F+1),scene:D==="super_team"?"superTeam":D}}var zg=TypeError,ri=Object.getOwnPropertyDescriptor,Dy=oe&&!function(){if(this!==void 0)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(x){return x instanceof TypeError}}()?function(x,T){if(Ji(x)&&!ri(x,"length").writable)throw zg("Cannot set read only .length");return x.length=T}:function(x,T){return x.length=T},jT=TypeError,Op=function(x,T){if(!delete x[T])throw jT("Cannot delete property "+Fr(T)+" of "+Fr(x))},BT=Ha("splice"),LT=Math.max,Rp=Math.min;qr({target:"Array",proto:!0,forced:!BT},{splice:function(T,F){var D,M,z,pe,ae,ze,jt=An(this),ur=Ci(jt),hr=oa(T,ur),br=arguments.length;for(br===0?D=M=0:br===1?(D=0,M=ur-hr):(D=br-2,M=Rp(LT(Da(F),0),ur-hr)),hl(ur+D-M),z=bl(jt,M),pe=0;pe<M;pe++)(ae=hr+pe)in jt&&Ns(z,pe,jt[ae]);if(z.length=M,D<M){for(pe=hr;pe<ur-M;pe++)ze=pe+D,(ae=pe+M)in jt?jt[ze]=jt[ae]:Op(jt,ze);for(pe=ur;pe>ur-M+D;pe--)Op(jt,pe-1)}else if(D>M)for(pe=ur-M;pe>hr;pe--)ze=pe+D-1,(ae=pe+M-1)in jt?jt[ze]=jt[ae]:Op(jt,ze);for(pe=0;pe<D;pe++)jt[pe+hr]=arguments[pe+2];return Dy(jt,ur-M+D),z}});var UT=Ao("Array").splice,Wg=Array.prototype,Gg=function(x){var T=x.splice;return x===Wg||Lt(Wg,x)&&T===Wg.splice?UT:T},DT=function(x,T,F,D){try{return D?T(Dn(F)[0],F[1]):T(F)}catch(M){Ll(x,"throw",M)}},Np=Array,qy=!Zm(function(x){Array.from(x)});qr({target:"Array",stat:!0,forced:qy},{from:function(T){var F=An(T),D=Vc(this),M=arguments.length,z=M>1?arguments[1]:void 0,pe=z!==void 0;pe&&(z=_o(z,M>2?arguments[2]:void 0));var ae,ze,jt,ur,hr,br,Cr=Zc(F),_r=0;if(!Cr||this===Np&&vm(Cr))for(ae=Ci(F),ze=D?new this(ae):Np(ae);ae>_r;_r++)br=pe?z(F[_r],_r):F[_r],Ns(ze,_r,br);else for(hr=(ur=Ja(F,Cr)).next,ze=D?new this:[];!(jt=Ie(hr,ur)).done;_r++)br=pe?DT(ur,z,[jt.value,_r],!0):jt.value,Ns(ze,_r,br);return ze.length=_r,ze}});var Fp=nr.Array.from,Sd=Zc;function $y(x,T){var F,D=li!==void 0&&Sd(x)||x["@@iterator"];if(D)return Mo(F=(D=D.call(x)).next).call(F,D);if(ya(x)||(D=function(pe,ae){var ze;if(pe){if(typeof pe=="string")return _c(pe,ae);var jt=fo(ze=Object.prototype.toString.call(pe)).call(ze,8,-1);if(jt==="Object"&&pe.constructor&&(jt=pe.constructor.name),jt==="Map"||jt==="Set")return Fp(pe);if(jt==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(jt))return _c(pe,ae)}}(x))||T&&x&&typeof x.length=="number"){D&&(x=D);var M=0;return function(){return M>=x.length?{done:!0}:{done:!1,value:x[M++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _c(x,T){(T==null||T>x.length)&&(T=x.length);for(var F=0,D=new Array(T);F<T;F++)D[F]=x[F];return D}var Di,Hy=function(){function x(){this.timerList=[],this.id=0,this.timer=null,this.timeout=0}var T=x.prototype;return T.addTimer=function(D,M,z){M===void 0&&(M=0),z===void 0&&(z=1);var pe=new Date().getTime(),ae=this.id;return this.timerList.push({id:ae,loop:z,count:0,timeout:pe+M,interval:M,callback:D}),this.id++,this.checkTimer(pe),ae},T.checkTimer=function(D){if(D===void 0&&(D=new Date().getTime()),this.removeFinished(),this.timerList.length!==0||this.timer==null){for(var M,z,pe=0,ae=$y(this.timerList);!(M=ae()).done;){var ze=M.value;(pe===0||pe>ze.timeout)&&(pe=ze.timeout)}this.timerList.length!==0&&(this.timer===null||pe<this.timeout||this.timeout<D)&&(this.timer=co(Mo(z=this.nowTime).call(z,this),pe-D),this.timeout=pe)}},T.nowTime=function(){for(var D,M=new Date().getTime(),z=$y(this.timerList);!(D=z()).done;){var pe=D.value;M>=pe.timeout&&(pe.callback(),pe.count++,pe.timeout=M+pe.interval)}this.clerTime(),this.checkTimer(M)},T.clerTime=function(){this.timer!==null&&(clearTimeout(this.timer),this.timer=null)},T.deleteTimer=function(D){for(var M=this.timerList.length-1;M>=0;M--){var z;this.timerList[M].id===D&&Gg(z=this.timerList).call(z,M,1)}},T.removeFinished=function(){for(var D=this.timerList.length-1;D>=0;D--){var M,z=this.timerList[D];z.loop>=0&&z.count>=z.loop&&Gg(M=this.timerList).call(M,D,1)}},T.destroy=function(){this.clerTime(),this.timerList=[],this.id=0,this.timer=null},x}(),Vy=function(){function x(F){this.core=F}var T=x.prototype;return T.request=function(D,M){var z=this,pe=new Date().getTime();return Fo.request(D,M).catch(function(ae){var ze,jt,ur=ae;throw z.core.reporter.reportTraceStart("exceptions",{user_id:z.core.options.account,trace_id:(jt=(ze=z.core)===null||ze===void 0?void 0:ze.socket)===null||jt===void 0?void 0:jt.sessionId,start_time:pe,action:1}),z.core.reporter.reportTraceUpdateV2("exceptions",{code:typeof ur.code=="number"?ur.code:0,description:ur.message||""+ur.code,operation_type:0,target:D,context:M?Uo(M):""}),z.core.reporter.reportTraceEnd("exceptions",1),ae})},T.uploadFile=function(D){var M=this,z=new Date().getTime();return Fo.uploadFile(D).catch(function(pe){var ae,ze,jt=pe;M.core.reporter.reportTraceStart("exceptions",{user_id:M.core.options.account,trace_id:(ze=(ae=M.core)===null||ae===void 0?void 0:ae.socket)===null||ze===void 0?void 0:ze.sessionId,start_time:z,action:1});var ur=Fo.platform==="BROWSER"?D.chunkUploadHost:D.commonUploadHost?D.commonUploadHost+"/"+(D.nosToken&&D.nosToken.bucket):"https://nos.netease.com/nim";throw M.core.reporter.reportTraceUpdateV2("exceptions",{code:typeof jt.code=="number"?jt.code:0,description:jt.message||""+jt.code,operation_type:1,target:ur}),M.core.reporter.reportTraceEnd("exceptions",1),pe})},x}();(function(x){x[x.ACTIVE=1]="ACTIVE",x[x.KICKED=2]="KICKED",x[x.OFFLINE=3]="OFFLINE"})(Di||(Di={}));var cs=window&&sp(window.addEventListener)&&sp(window.removeEventListener),zy=function(x){function T(D,M){var z;(z=x.call(this)||this).status="unconnected",z.linkUrls=[],z.eventBus=new Hs,z.packetSer=1,z.retryCount=0,z.reconnectTimer=0,z.backoff=new Ea({max:8e3,min:1600,jitter:.01}),z.sendingCmdMap=new nc,z.pingTimer=0,z.config=hy,z.abtInfo={},xn({linkUrls:{type:"array",itemType:"string",required:!1}},D),z.options=kr(kr({},V1),D),z.adapters=new Vy(a(z));var pe=Fo.localStorage.getItem("__NIM_DEVC_ID__");z.options.isFixedDeviceId?(pe=Fo.localStorage.getItem("__NIM_DEVC_ID__")||Ap(),Fo.localStorage.setItem("__NIM_DEVC_ID__",pe)):pe=Ap(),z.config=kr(kr(kr({},hy),M),{deviceId:pe}),z.timerManager=new Hy,z.logger=new up(z.options.debugLevel,z.options.account);var ae=Fo.getSystemInfo();return z.reporter=new nT({common:{app_key:D.appkey,dev_id:pe,platform:"Web",sdk_ver:"0.13.1",env:"online",os_name:ae.os,os_ver:ae.osVer,model:ae.hostEnvVer,manufactor:ae.hostEnv,host_env:ae.hostEnv,host_info:ae.hostInfo,host_env_ver:ae.hostEnvVer},request:Fo.request,logger:z.logger,autoStart:Fo.platform==="BROWSER"}),Fo.setLogger(z.logger),z.logger.log("Core init, version ","0.13.1"," sdk version ",91001," appkey ",D.appkey),z}Co(T,x);var F=T.prototype;return F.emit=function(M){try{for(var z,pe,ae=ti(),ze=arguments.length,jt=new Array(ze>1?ze-1:0),ur=1;ur<ze;ur++)jt[ur-1]=arguments[ur];var hr=(z=x.prototype.emit).call.apply(z,Ss(pe=[this,M]).call(pe,jt)),br=ti()-ae;return br>=10&&this.logger.warn("Core::emit event: "+M+" process takes: "+br+"ms"),hr}catch(Cr){return this.logger.error("Core::emit event: "+M+". Error: "+Cr),!1}},F.connect=function(M,z){return M===void 0&&(M={}),hn(this,void 0,void 0,rr.mark(function pe(){var ae,ze,jt,ur,hr,br;return rr.wrap(function(_r){for(;;)switch(_r.prev=_r.next){case 0:if(xn({linkUrls:{type:"array",itemType:"string",required:!1}},M),/^(unconnected|waitReconnect)$/.test(this.status)){_r.next=5;break}return ae="Core socket status is "+this.status+", and would not connect",this.logger.warn(ae),_r.abrupt("return",ro.reject(ae));case 5:this.status="connecting",M.linkUrls&&M.linkUrls.length>0&&(this.linkUrls=Ss(ze=M.linkUrls).call(ze,this.linkUrls),this.linkUrls=wp(this.linkUrls)),this.linkUrls.length===0&&this.linkUrls.push(yy),jt=0;case 9:if(!(jt<this.linkUrls.length)){_r.next=32;break}return ur=this.linkUrls[jt],hr=new Date().getTime(),_r.prev=12,_r.next=15,this.doConnect(ur);case 15:return this.status="connected",this.logger.log("core:: connect success with url: "+ur),this.abtRequest(),_r.abrupt("return",ur);case 21:_r.prev=21,_r.t0=_r.catch(12),br=_r.t0,z&&z(br,ur),this.reporter.reportTraceStart("exceptions",{user_id:this.options.account,start_time:hr,action:0}),this.reporter.reportTraceUpdateV2("exceptions",{code:typeof br.code=="number"?br.code:0,description:br.message||""+br.code,operation_type:0,target:ur}),this.reporter.reportTraceEnd("exceptions",1),this.logger.warn("core:: connect failed with url: "+ur,_r.t0);case 29:jt++,_r.next=9;break;case 32:throw this.retryCount===0?this.doDisconnect(Di.ACTIVE,"SocketHandshakeFailed"):this.doDisconnect(Di.OFFLINE,"ReconnectHadRetryAllLinks"),new Error("core: socket handshake failed");case 34:case"end":return _r.stop()}},pe,this,[[12,21]])}))},F.doConnect=function(M){var z=this;return new ro(function(pe,ae){var ze;z.socket=new _g(z,M,z.logger),z.socket.on("connect",function(){z.logger.log("socket on connect",M),pe()}),z.socket.on("message",Mo(ze=z.onMessage).call(ze,z)),z.socket.on("disconnect",function(jt){z.logger.log("core:: socket on disconnect",jt),z.doDisconnect(Di.OFFLINE,"SocketOnDisconnect")}),z.socket.on("handshakeFailed",function(){z.logger.warn("core:: socket handshake failed"),ae(new ic("handshake failed",{},408))})})},F.resetConnectStatus=function(){clearTimeout(this.reconnectTimer),this.backoff.reset(),this.retryCount=0,this.initOnlineListener()},F.doDisconnect=function(M,z){if(this.logger.log("doDisconnect: type "+M+", description "+z),this.status!=="unconnected"){this.markAllCmdInvaild(new ic("Packet timeout due to instance disconnect",{},408)),this.timerManager.destroy(),clearTimeout(this.pingTimer),this.socket&&(typeof this.socket.removeAllListeners=="function"&&this.socket.removeAllListeners(),typeof this.socket.close=="function"&&this.socket.close(),this.socket=void 0);var pe=!this.options.needReconnect||this.retryCount>=this.options.reconnectionAttempts;if(M===Di.ACTIVE||pe)this.logger.log("doDisconnect: emit disconnect, type "+M,pe),this.status="unconnected",this.reconnectTimer&&clearTimeout(this.reconnectTimer),this.eventBus.emit("disconnect"),this.emit("disconnect"),this.destroyOnlineListener();else if(M===Di.KICKED){this.logger.log("doDisconnect: kicked"),this.status="unconnected",this.reconnectTimer&&clearTimeout(this.reconnectTimer);var ae=typeof z=="string"?{reason:"unknow",message:z}:z;this.eventBus.emit("kicked",ae),this.emit("kicked",ae),this.destroyOnlineListener()}else M===Di.OFFLINE?(this.logger.log("doDisconnect: start to reconnect"),this.attempToReconnect()):this.logger.log("doDisconnect: nothing to do")}else this.logger.warn("doDisconnect: already unconnected")},F.attempToReconnect=function(){var M=this;if(this.status!=="waitReconnect"){var z=this.backoff.duration();this.retryCount++,this.logger.log("willReconnect "+this.retryCount+" "+z),this.eventBus.emit("willReconnect",{retryCount:this.retryCount,duration:z}),this.emit("willReconnect",{retryCount:this.retryCount,duration:z}),this.status="waitReconnect",this.reconnectTimer&&clearTimeout(this.reconnectTimer),this.reconnectTimer=co(function(){M.status==="waitReconnect"?M.connect({isAutoReconnect:!0}).catch(function(){M.logger.error("core::attempToReconnect failed "+M.retryCount)}):M.logger.warn("doDisconnect: reconnectTimer status is "+M.status+", would not go on reconnecting")},z)}else this.logger.warn("doDisconnect: already is waiting reconnect")},F.sendCmd=function(M,z,pe){var ae=this;if(this.status!=="logined"&&M!=="login"&&M!=="chatroomLogin"&&M!=="qchatLogin")return this.logger.warn("nim status is "+this.status+", so can not sendCmd "+M),ro.reject({cmd:M,error:{code:"No_connected",message:"Connection not established",timetag:new Date().getTime()}});if(!this.socket||!this.socket.send)return ro.reject("No_socket");var ze=M!=="heartbeat",jt=ze?this.packetSer++:0,ur=function(Hr,$r,Vr,bn){var Wn=Fu[Hr];if(!Wn)return Vr.error("createCmd:: can not find cmd config: ",Hr),null;var qn,yo={SER:$r,SID:Wn.sid,CID:Wn.cid,Q:[]};return Wn.params&&bn&&kn(qn=Wn.params).call(qn,function(Fn){var xr=bn[Fn.name];if(!ky(xr)){var wn=Fn.type,Rn=Fn.reflectMapper;switch(Fn.type){case"PropertyArray":wn="ArrayMable",xr=lo(xr).call(xr,function(Tn){return{t:"Property",v:Rn?fd(Tn,Rn):Tn}});break;case"Property":xr=Rn?fd(xr,Rn):xr;break;case"Bool":case"bool":xr=xr?"true":"false"}yo.Q.push({t:wn,v:xr})}}),{packet:yo,isNoResponse:Wn.isNoResponse||!1}}(M,jt,this.logger,z);if(!ur){var hr="SendCmd "+jt+" "+M+" error";return this.logger.error(hr),ro.reject(hr)}var br=ur.packet,Cr=ur.isNoResponse,_r=Uo(br);ze&&(this.options.debugLevel==="debug"?this.logger.debug("core::sendCmd",M,"ser:"+jt,_r):this.logger.log("core::sendCmd",M,"ser:"+jt));var Nr=new Date().getTime();return new ro(function(Br,Hr){ae.sendingCmdMap.set(jt,{cmd:M,params:z,callback:[Br,Hr],timer:Cr?null:co(function(){var Vr,bn=new cp(504,M,"Packet Timeout",new Date().getTime(),{message:"ser "+jt+" cmd "+M+" timeout"});bn.callFunc="sendCmd",ae.markCmdInvalid(jt,bn,M),ae.reporter.reportTraceStart("exceptions",{user_id:ae.options.account,trace_id:(Vr=ae.socket)===null||Vr===void 0?void 0:Vr.sessionId,start_time:Nr,action:2}),ae.reporter.reportTraceUpdateV2("exceptions",{code:408,description:"Packet timeout",operation_type:1,target:br.SID+"-"+br.CID,context:""+br.SER}),ae.reporter.reportTraceEnd("exceptions",1)},pe&&pe.timeout?pe.timeout:ae.config.timeout)});try{ae.socket.send(_r)}catch(Vr){var $r=new cp(415,M,Vr&&Vr.message||"Unable to send packet",new Date().getTime(),{message:"send json error",rawError:Vr});$r.callFunc="sendCmd",ae.markCmdInvalid(jt,$r,M),Hr(Vr)}})},F.onMessage=function(M){var z=xy(M,this.logger);if(z){var pe=z.raw.ser;if(z.error&&this.logger.error("core:onMessage packet error",z.raw.sid+"_"+z.raw.cid+", ser:"+pe+",",z.error),!z.notFound)return z.cmd!=="heartbeat"&&(this.options.debugLevel==="debug"?this.logger.debug("imsocket::recvCmd ser:"+pe,z.cmd,z.content):this.logger.log("imsocket::recvCmd ser:"+pe,z.cmd)),z.__receiveTime=ti(),z;this.logger.warn("core::onMessage packet not found",z.raw.sid+"_"+z.raw.cid+", ser:"+pe)}},F.markCmdInvalid=function(M,z,pe){var ae=this.sendingCmdMap.get(M);if(ae){var ze=ae.callback,jt=ae.timer;jt&&clearTimeout(jt),this.sendingCmdMap.delete(M),this.logger.warn("packet "+M+", "+pe+" is invalid:",z),ze[1](z)}},F.markAllCmdInvaild=function(M){var z;this.logger.log("markAllCmdInvaild"),kn(z=this.sendingCmdMap).call(z,function(pe){var ae=pe.callback,ze=pe.timer;ze&&clearTimeout(ze),ae[1](M)}),this.sendingCmdMap.clear()},F.ping=function(){return hn(this,void 0,void 0,rr.mark(function M(){var z=this;return rr.wrap(function(ae){for(;;)switch(ae.prev=ae.next){case 0:return clearTimeout(this.pingTimer),ae.prev=1,ae.next=4,this.sendCmd("heartbeat");case 4:ae.next=14;break;case 6:return ae.prev=6,ae.t0=ae.catch(1),ae.next=10,this.testHeartBeat5Timeout();case 10:if(!ae.sent){ae.next=14;break}return this.doDisconnect(Di.OFFLINE,"PingError"),ae.abrupt("return");case 14:this.pingTimer=co(function(){z.ping()},3e4);case 15:case"end":return ae.stop()}},M,this,[[1,6]])}))},F.testHeartBeat5Timeout=function(){return hn(this,void 0,void 0,rr.mark(function M(){var z;return rr.wrap(function(ae){for(;;)switch(ae.prev=ae.next){case 0:clearTimeout(this.pingTimer),z=0;case 2:if(!(z<5)){ae.next=15;break}return ae.prev=3,ae.next=6,this.sendCmd("heartbeat",{},{timeout:3e3});case 6:return ae.abrupt("return",!1);case 9:ae.prev=9,ae.t0=ae.catch(3),this.logger.debug("core:: test heartbeat "+z+" Timeout");case 12:z++,ae.next=2;break;case 15:return ae.abrupt("return",!0);case 16:case"end":return ae.stop()}},M,this,[[3,9]])}))},F.initOnlineListener=function(){var M,z;this.onlineListener||(cs?(this.onlineListener=Mo(M=function(){this.status==="logined"&&this.ping()}).call(M,this),this.offlineListener=Mo(z=function(){this.logger.log("offline"),this.doDisconnect(Di.OFFLINE,"OfflineListener")}).call(z,this),window.addEventListener("online",this.onlineListener),window.addEventListener("offline",this.offlineListener)):this.logger.warn("initOnlineListener not support add listener"))},F.destroyOnlineListener=function(){this.onlineListener&&(window.removeEventListener("online",this.onlineListener),this.onlineListener=void 0),this.offlineListener&&(window.removeEventListener("offline",this.offlineListener),this.offlineListener=void 0)},F.disconnect=function(){switch(this.status){case"connected":case"logined":case"connecting":case"waitReconnect":return this.doDisconnect(Di.ACTIVE,"UserActiveDisconnect"),ro.resolve();case"unconnected":case"destroyed":return ro.resolve()}},F.destroy=function(){var M=this;return this.disconnect().then(function(){M.status="destroyed",M.removeAllListeners(),M.eventBus.removeAllListeners(),M.reporter.destroy(),M.connect=function(){return ro.resolve()},M.disconnect=function(){return ro.resolve()},M.destroy=function(){return ro.resolve()}})},F.abtRequest=function(){var M,z;return hn(this,void 0,void 0,rr.mark(function pe(){var ae,ze;return rr.wrap(function(ur){for(;;)switch(ur.prev=ur.next){case 0:if(this.options.isAbtestEnable){ur.next=2;break}return ur.abrupt("return");case 2:if(!this.abtInfo.experiments){ur.next=4;break}return ur.abrupt("return");case 4:if(this.options.abtestUrl){ur.next=6;break}return ur.abrupt("return");case 6:return ur.prev=6,ur.next=9,this.adapters.request(this.options.abtestUrl,{method:"POST",dataType:"json",headers:{sdktype:"ABTest"},data:{clientInfo:{projectKey:this.options.abtestProjectKey,appKey:this.options.appkey,osType:"Web",sdkVersion:"0.13.1",deviceId:this.config.deviceId},useLocalCache:!0}});case 9:ae=ur.sent,ur.next=15;break;case 12:ur.prev=12,ur.t0=ur.catch(6),this.logger.warn("ABTest request failed");case 15:this.abtInfo=((z=(M=ae==null?void 0:ae.data)===null||M===void 0?void 0:M.data)===null||z===void 0?void 0:z.abtInfo)||{},this.abtInfo.experiments&&this.abtInfo.experiments.length>0&&this.reporter.reportImmediately("https://statistic.live.126.net/statics/report/abtest/result",{params:{app_key:this.options.appkey,biz_sdk_type:"IM",sdk_ver:"0.13.1",device_id:this.config.deviceId,platform:"Web",projectKey:this.options.abtestProjectKey,experiments:lo(ze=this.abtInfo.experiments).call(ze,function(hr){return{experimentKey:hr.experimentKey,schemeKey:hr.schemeKey}})},headers:{sdktype:"ABTest"},method:"POST",dataType:"json"});case 17:case"end":return ur.stop()}},pe,this,[[6,12]])}))},T}(Hs);zy.setAdapters=function(T){kr(Fo,T)};var Wy={"1_2":"heartbeat","2_3":"login","2_5":"kicked","2_6":"logout","2_7":"multiPortLogin","2_8":"kick"},Gy={login:{clientType:3,os:4,sdkVersion:6,appLogin:8,protocolVersion:9,pushTokenName:10,pushToken:11,deviceId:13,appkey:18,account:19,browser:24,session:26,deviceInfo:32,isReactNative:112,token:1e3,customTag:38,customClientType:39,sdkHumanVersion:40,sdkType:41,userAgent:42,authType:115,loginExt:116},loginRes:{lastLoginDeviceId:17,customTag:38,connectionId:102,ip:103,port:104,country:106,hasXMPush:111},loginPort:{type:3,os:4,mac:5,deviceId:13,account:19,deviceInfo:32,customTag:38,connectionId:102,ip:103,time:109},aosPushInfo:{pushType:110,hasTokenPreviously:111}},Md=ts(Gy),Ky={login:{sid:2,cid:3,service:"auth",params:[{type:"Property",name:"login",reflectMapper:Gy.login}],response:[{type:"Property",name:"loginRes",reflectMapper:Md.loginRes},{type:"PropertyArray",name:"loginPorts",reflectMapper:Md.loginPort},{type:"Property",name:"aosPushInfo",reflectMapper:Md.aosPushInfo}]},logout:{sid:2,cid:6,service:"auth"},heartbeat:{sid:1,cid:2,service:"auth"},kicked:{sid:2,cid:5,service:"auth",response:[{type:"Number",name:"clientType"},{type:"Number",name:"reason"},{type:"String",name:"ext"},{type:"Number",name:"customClientType"}]},multiPortLogin:{sid:2,cid:7,service:"auth",response:[{type:"Number",name:"state"},{type:"PropertyArray",name:"loginPorts",reflectMapper:Md.loginPort}]},kick:{sid:2,cid:8,service:"auth",params:[{type:"StrArray",name:"deviceIds"}],response:[{type:"StrArray",name:"deviceIds"}]}},Ta=Array.isArray,jp=function(T){return typeof T=="symbol"||va(T)&&Sc(T)=="[object Symbol]"},Kg=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Bp=/^\w*$/,Qg=function(T,F){if(Ta(T))return!1;var D=typeof T;return!(D!="number"&&D!="symbol"&&D!="boolean"&&T!=null&&!jp(T))||Bp.test(T)||!Kg.test(T)||F!=null&&T in Object(F)};function Jg(x,T){if(typeof x!="function"||T!=null&&typeof T!="function")throw new TypeError("Expected a function");var F=function(){var D=arguments,M=T?T.apply(this,D):D[0],z=F.cache;if(z.has(M))return z.get(M);var pe=x.apply(this,D);return F.cache=z.set(M,pe)||z,pe};return F.cache=new(Jg.Cache||bp),F}Jg.Cache=bp;var qT=Jg,$T=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,HT=/\\(\\)?/g,Wu=function(T){var F=qT(T,function(M){return D.size===500&&D.clear(),M}),D=F.cache;return F}(function(x){var T=[];return x.charCodeAt(0)===46&&T.push(""),x.replace($T,function(F,D,M,z){T.push(M?z.replace(HT,"$1"):D||F)}),T}),Lp=Wu,Qy=Qs?Qs.prototype:void 0,Yg=Qy?Qy.toString:void 0,Jy=function x(T){if(typeof T=="string")return T;if(Ta(T))return Bg(T,x)+"";if(jp(T))return Yg?Yg.call(T):"";var F=T+"";return F=="0"&&1/T==-1/0?"-0":F},VT=function(T){return T==null?"":Jy(T)},Cd=function(T,F){return Ta(T)?T:Qg(T,F)?[T]:Lp(VT(T))},mu=function(T){if(typeof T=="string"||jp(T))return T;var F=T+"";return F=="0"&&1/T==-1/0?"-0":F},Xg=function(T,F){for(var D=0,M=(F=Cd(F,T)).length;T!=null&&D<M;)T=T[mu(F[D++])];return D&&D==M?T:void 0},Es=function(T,F,D){var M=T==null?void 0:Xg(T,F);return M===void 0?D:M},Fa={debugLevel:"off",needReconnect:!0,reconnectionAttempts:ng,lbsUrls:["https://lbs.netease.im/lbs/webconf.jsp"],linkUrl:yy,isAbtestEnable:!0,abtestUrl:"https://abt-online.netease.im/v1/api/abt/client/getExperimentInfo",abtestProjectKey:"imElite_sdk_abtest_web"},Up={},Ri=function(x){function T(D,M){var z,pe;M===void 0&&(M={serverConfig:{},syncOptions:{},sessionConfig:{}}),(pe=x.call(this,D)||this).instanceName="NIM",pe.account="",pe.options={},pe.auth={},pe.offlinePush={},pe.sync={},pe.msg={},pe.msgLog={},pe.session={},pe.cloudSession={},pe.misc={},pe.user={},pe.friend={},pe.systemMessage={},pe.team={},pe.event={},pe.msgExtend={},pe.cloudStorage={},pe.passThrough={},pe.superTeam={},pe.plugin={},pe.signaling={},pe.setOptions(D),Ui({cmdMap:Wy,cmdConfig:Ky});var ae=null;return kn(z=No(Up)).call(z,function(ze){var jt=Up[ze];ze==="sync"?ae=jt:pe[ze]=ze==="session"?new jt(a(pe),M.sessionConfig):ze==="cloudStorage"?new jt(a(pe),kr({storageKeyPrefix:pe.instanceName},M.serverConfig,M.cloudStorageConfig)):new jt(a(pe))}),ae&&(pe.sync=new ae(a(pe),M.syncOptions)),T.instance=a(pe),pe}Co(T,x),T.getInstance=function(M,z){if(!T.instance){if(M)return new T(M,z);throw new Error("Instance not exist, please input options")}if(M){if(T.instance.options.account===M.account&&T.instance.options.appkey===M.appkey)return T.instance.setOptions(M),T.instance;throw new Error("Unexpected login")}return T.instance};var F=T.prototype;return F.setOptions=function(M){xn({account:{type:"string"},appkey:{type:"string"},token:{type:"string"},needReconnect:{type:"boolean",required:!1},reconnectionAttempts:{type:"number",required:!1},customClientType:{type:"number",min:1,required:!1},authType:{type:"number",min:0,max:2,required:!1},lbsUrls:{type:"array",itemType:"string",min:1,required:!1},linkUrl:{type:"string",allowEmpty:!1,required:!1}},M),this.logger.log("NIM::setOptions options is",M),this.account=M.account,this.options=kr(kr({},Fa),M)},F.connect=function(M){M===void 0&&(M={});var z=Qi(null,{connect:{get:function(){return x.prototype.connect}}});return hn(this,void 0,void 0,rr.mark(function pe(){var ae,ze,jt=this;return rr.wrap(function(hr){for(;;)switch(hr.prev=hr.next){case 0:if(/^(unconnected|waitReconnect)$/.test(this.status)){hr.next=4;break}return ae="NIM status is "+this.status+", and would not connect",this.logger.warn(ae),hr.abrupt("return",ro.reject(ae));case 4:return this.reporter.reportTraceCancel("login"),this.reporter.reportTraceStart("login",{user_id:this.options.account,action:M.isAutoReconnect?"auto_login":"manual_login"}),this.reporter.reportTraceUpdateV2("login",{code:0,description:Uo(kr(kr({},this.options),{account:"***",token:"***"})),operation_type:"conf_init",succeed:!0,duration:0,target:""}),hr.next=9,this.getLbsInfos();case 9:return hr.prev=9,hr.next=12,z.connect.call(this,M,function(br,Cr){jt.reporter.reportTraceUpdateV2("login",{operation_type:"TCP",target:Cr,code:br.code||408,description:"ws_handshake_failed:"+br.message,succeed:!1})});case 12:(ze=hr.sent)&&this.reporter.reportTraceUpdateV2("login",{operation_type:"TCP",target:ze,code:200,succeed:!0}),hr.next=20;break;case 16:throw hr.prev=16,hr.t0=hr.catch(9),this.reporter.reportTraceEnd("login",!1),hr.t0;case 20:return hr.next=22,this.login(M.isAutoReconnect);case 22:case"end":return hr.stop()}},pe,this,[[9,16]])}))},F.login=function(M){return M===void 0&&(M=!1),hn(this,void 0,void 0,rr.mark(function z(){var pe,ae;return rr.wrap(function(jt){for(;;)switch(jt.prev=jt.next){case 0:return jt.prev=0,jt.next=3,this.auth.doLogin(M);case 3:pe=jt.sent,this.reporter.reportTraceUpdateV2("login",{operation_type:"protocol",target:"2-3",code:200,succeed:!0}),this.reporter.reportTraceEnd("login",!0),this.status="logined",jt.next=20;break;case 9:if(jt.prev=9,jt.t0=jt.catch(0),ae=jt.t0,this.logger.warn("nim login:: login failed",jt.t0),this.reporter.reportTraceUpdateV2("login",{operation_type:"protocol",target:"2-3",code:ae.code||0,succeed:!1,description:ae.message}),this.reporter.reportTraceEnd("login",!1),this.retryCount!==0){jt.next=18;break}throw this.doDisconnect(Di.ACTIVE,"FailedToInitializeLogin"),jt.t0;case 18:return this.doDisconnect(Di.OFFLINE,"ReconnectLoginFailed"),jt.abrupt("return");case 20:return jt.prev=20,jt.next=23,this.cloudStorage.init();case 23:jt.next=28;break;case 25:jt.prev=25,jt.t1=jt.catch(20),this.logger.error("NIM:login cloudStorage init failed ",jt.t1);case 28:if(this.eventBus.emit("logined",pe),this.emit("logined",pe),this.logger.log("login done"),this.resetConnectStatus(),!this.sync||!this.sync.doSync){jt.next=35;break}return jt.next=35,this.sync.doSync();case 35:this.ping();case 36:case"end":return jt.stop()}},z,this,[[0,9],[20,25]])}))},F.onMessage=function(M){var z,pe,ae=x.prototype.onMessage.call(this,M);if(ae){var ze=ae.raw.ser,jt=this.sendingCmdMap.get(ze);if(jt&&jt.cmd===ae.cmd){var ur=jt.callback,hr=jt.timer,br=jt.params;if(clearTimeout(hr),ae.params=br,this.sendingCmdMap.delete(ze),ae.cmd==="heartbeat")return void ur[0]();var Cr=(z=this[ae.service])===null||z===void 0?void 0:z.process(ae);Cr&&typeof Cr.then=="function"?Cr.then(function(_r){ur[0](_r)}).catch(function(_r){ur[1](_r)}):(this.logger.log("imsocket:: handlerFn without promise",ae.service,ae.cmd),ur[0]())}else(pe=this[ae.service])===null||pe===void 0||pe.process(ae)}},F.getLbsInfos=function(){var M;return hn(this,void 0,void 0,rr.mark(function z(){var pe,ae,ze,jt,ur,hr,br,Cr,_r;return rr.wrap(function(Br){for(;;)switch(Br.prev=Br.next){case 0:return pe=this.options.lbsUrls[0],ae=bi(pe).call(pe,"?")>-1?"&":"?",ze=pe+ae+"k="+this.options.appkey+"&id="+this.options.account+"&sv=180&pv=1&networkType=0",Br.prev=3,this.logger.log("getLbsInfos ",ze),Br.next=7,this.adapters.request(ze,{method:"GET",dataType:"json",timeout:1e4});case 7:if((ur=Br.sent).status===200&&ur.data){Br.next=11;break}throw this.logger.error("getLbsInfos::error status",ur.status,ur),new Error("getLbsInfos failed, status "+ur.status);case 11:this.reporter.reportTraceUpdateV2("login",{operation_type:"HTTP",target:ze,code:200,succeed:!0}),hr=ur.data,br=[this.options.linkUrl],Es(hr,"common.link")&&(br=Ss(Cr=Es(hr,"common.link")).call(Cr,br)),Es(hr,'common["link.default"]')&&(br=Ss(br).call(br,Es(hr,'common["link.default"]'))),this.linkUrls=wp(br),ur.data["nos-chunk"]&&((M=this.cloudStorage)===null||M===void 0||M.setOptions({chunkUploadHost:ur.data["nos-chunk"]})),this.logger.log("getLbsInfos success, socket link:",fo(jt=this.linkUrls).call(jt,0),"chunkUploadHost: ",ur.data["nos-chunk"]),Br.next=27;break;case 21:Br.prev=21,Br.t0=Br.catch(3),_r=Br.t0,this.logger.error("getLbsInfos::error",_r),this.linkUrls=[this.options.linkUrl],this.reporter.reportTraceUpdateV2("login",{operation_type:"HTTP",target:ze,description:_r.message,code:_r.code||0,succeed:!1});case 27:case"end":return Br.stop()}},z,this,[[3,21]])}))},F.disconnect=function(){var M=this;switch(this.status){case"logined":return this.sendCmd("logout",void 0,{timeout:1e3}).then(function(){x.prototype.doDisconnect.call(M,Di.ACTIVE,"UserActiveDisconnect")}).catch(function(z){M.logger.error("NIM::disconnect sendCmd:logout error",z),x.prototype.doDisconnect.call(M,Di.ACTIVE,"UserActiveDisconnect")});case"connected":case"connecting":case"waitReconnect":return x.prototype.doDisconnect.call(this,Di.ACTIVE,"UserActiveDisconnect"),ro.resolve();case"unconnected":case"destroyed":return ro.resolve()}},F.destroy=function(){return T.instance=null,x.prototype.destroy.call(this)},F.kick=function(M){return xn({deviceIds:{type:"array",itemType:"string"}},M),this.auth.kick(M)},T.registerService=function(M,z){Up[z]=M},T}(zy);Ri.instance=null;var Yy=Math.min,Zg=[].lastIndexOf,eh=!!Zg&&1/[1].lastIndexOf(1,-0)<0,zT=Ds("lastIndexOf"),th=eh||!zT?function(T){if(eh)return k(Zg,this,arguments)||0;var F=lr(this),D=Ci(F),M=D-1;for(arguments.length>1&&(M=Yy(M,Da(arguments[1]))),M<0&&(M=D+M);M>=0;M--)if(M in F&&F[M]===T)return M||0;return-1}:Zg;qr({target:"Array",proto:!0,forced:th!==[].lastIndexOf},{lastIndexOf:th});var WT=Ao("Array").lastIndexOf,Dp=Array.prototype,rh=function(x){var T=x.lastIndexOf;return x===Dp||Lt(Dp,x)&&T===Dp.lastIndexOf?WT:T},Gu=s(function(x,T){(function(){var F={function:!0,object:!0}[typeof window]&&window||this,D=T,M=x&&!x.nodeType&&x,z=D&&M&&typeof e=="object"&&e;!z||z.global!==z&&z.window!==z&&z.self!==z||(F=z);var pe=Math.pow(2,53)-1,ae=/\bOpera/,ze=Object.prototype,jt=ze.hasOwnProperty,ur=ze.toString;function hr(Vr){return(Vr=String(Vr)).charAt(0).toUpperCase()+Vr.slice(1)}function br(Vr){return Vr=Hr(Vr),/^(?:webOS|i(?:OS|P))/.test(Vr)?Vr:hr(Vr)}function Cr(Vr,bn){for(var Wn in Vr)jt.call(Vr,Wn)&&bn(Vr[Wn],Wn,Vr)}function _r(Vr){return Vr==null?hr(Vr):ur.call(Vr).slice(8,-1)}function Nr(Vr){return String(Vr).replace(/([ -])(?!$)/g,"$1?")}function Br(Vr,bn){var Wn=null;return function(yo,Fn){var xr=-1,wn=yo?yo.length:0;if(typeof wn=="number"&&wn>-1&&wn<=pe)for(;++xr<wn;)Fn(yo[xr],xr,yo);else Cr(yo,Fn)}(Vr,function(qn,yo){Wn=bn(Wn,qn,yo,Vr)}),Wn}function Hr(Vr){return String(Vr).replace(/^ +| +$/g,"")}var $r=function Vr(bn){var Wn=F,qn=bn&&typeof bn=="object"&&_r(bn)!="String";qn&&(Wn=bn,bn=null);var yo=Wn.navigator||{},Fn=yo.userAgent||"";bn||(bn=Fn);var xr,wn,Rn=qn?!!yo.likeChrome:/\bChrome\b/.test(bn)&&!/internal|\n/i.test(ur.toString()),Tn="Object",Yr=qn?Tn:"ScriptBridgingProxyObject",Pn=qn?Tn:"Environment",Un=qn&&Wn.java?"JavaPackage":_r(Wn.java),Jn=qn?Tn:"RuntimeObject",Xn=/\bJava/.test(Un)&&Wn.java,Bo=Xn&&_r(Wn.environment)==Pn,To=Xn?"a":"α",ji=Xn?"b":"β",mo=Wn.document||{},So=Wn.operamini||Wn.opera,Xo=ae.test(Xo=qn&&So?So["[[Class]]"]:_r(So))?Xo:So=null,Dc=bn,xo=[],bc=null,Hi=bn==Fn,oo=Hi&&So&&typeof So.version=="function"&&So.version(),Zo=function(Pi){return Br(Pi,function(mi,Si){return mi||RegExp("\\b"+(Si.pattern||Nr(Si))+"\\b","i").exec(bn)&&(Si.label||Si)})}([{label:"EdgeHTML",pattern:"Edge"},"Trident",{label:"WebKit",pattern:"AppleWebKit"},"iCab","Presto","NetFront","Tasman","KHTML","Gecko"]),Hn=function(Pi){return Br(Pi,function(mi,Si){return mi||RegExp("\\b"+(Si.pattern||Nr(Si))+"\\b","i").exec(bn)&&(Si.label||Si)})}(["Adobe AIR","Arora","Avant Browser","Breach","Camino","Electron","Epiphany","Fennec","Flock","Galeon","GreenBrowser","iCab","Iceweasel","K-Meleon","Konqueror","Lunascape","Maxthon",{label:"Microsoft Edge",pattern:"(?:Edge|Edg|EdgA|EdgiOS)"},"Midori","Nook Browser","PaleMoon","PhantomJS","Raven","Rekonq","RockMelt",{label:"Samsung Internet",pattern:"SamsungBrowser"},"SeaMonkey",{label:"Silk",pattern:"(?:Cloud9|Silk-Accelerated)"},"Sleipnir","SlimBrowser",{label:"SRWare Iron",pattern:"Iron"},"Sunrise","Swiftfox","Vivaldi","Waterfox","WebPositive",{label:"Yandex Browser",pattern:"YaBrowser"},{label:"UC Browser",pattern:"UCBrowser"},"Opera Mini",{label:"Opera Mini",pattern:"OPiOS"},"Opera",{label:"Opera",pattern:"OPR"},"Chromium","Chrome",{label:"Chrome",pattern:"(?:HeadlessChrome)"},{label:"Chrome Mobile",pattern:"(?:CriOS|CrMo)"},{label:"Firefox",pattern:"(?:Firefox|Minefield)"},{label:"Firefox for iOS",pattern:"FxiOS"},{label:"IE",pattern:"IEMobile"},{label:"IE",pattern:"MSIE"},"Safari"]),Oo=AM([{label:"BlackBerry",pattern:"BB10"},"BlackBerry",{label:"Galaxy S",pattern:"GT-I9000"},{label:"Galaxy S2",pattern:"GT-I9100"},{label:"Galaxy S3",pattern:"GT-I9300"},{label:"Galaxy S4",pattern:"GT-I9500"},{label:"Galaxy S5",pattern:"SM-G900"},{label:"Galaxy S6",pattern:"SM-G920"},{label:"Galaxy S6 Edge",pattern:"SM-G925"},{label:"Galaxy S7",pattern:"SM-G930"},{label:"Galaxy S7 Edge",pattern:"SM-G935"},"Google TV","Lumia","iPad","iPod","iPhone","Kindle",{label:"Kindle Fire",pattern:"(?:Cloud9|Silk-Accelerated)"},"Nexus","Nook","PlayBook","PlayStation Vita","PlayStation","TouchPad","Transformer",{label:"Wii U",pattern:"WiiU"},"Wii","Xbox One",{label:"Xbox 360",pattern:"Xbox"},"Xoom"]),ds=function(Pi){return Br(Pi,function(mi,Si,Yh){return mi||(Si[Oo]||Si[/^[a-z]+(?: +[a-z]+\b)*/i.exec(Oo)]||RegExp("\\b"+Nr(Yh)+"(?:\\b|\\w*\\d)","i").exec(bn))&&Yh})}({Apple:{iPad:1,iPhone:1,iPod:1},Alcatel:{},Archos:{},Amazon:{Kindle:1,"Kindle Fire":1},Asus:{Transformer:1},"Barnes & Noble":{Nook:1},BlackBerry:{PlayBook:1},Google:{"Google TV":1,Nexus:1},HP:{TouchPad:1},HTC:{},Huawei:{},Lenovo:{},LG:{},Microsoft:{Xbox:1,"Xbox One":1},Motorola:{Xoom:1},Nintendo:{"Wii U":1,Wii:1},Nokia:{Lumia:1},Oppo:{},Samsung:{"Galaxy S":1,"Galaxy S2":1,"Galaxy S3":1,"Galaxy S4":1},Sony:{PlayStation:1,"PlayStation Vita":1},Xiaomi:{Mi:1,Redmi:1}}),Gn=function(Pi){return Br(Pi,function(mi,Si){var Yh=Si.pattern||Nr(Si);return!mi&&(mi=RegExp("\\b"+Yh+"(?:/[\\d.]+|[ \\w.]*)","i").exec(bn))&&(mi=function(wu,IM,_M){var EM={"10.0":"10",6.4:"10 Technical Preview",6.3:"8.1",6.2:"8",6.1:"Server 2008 R2 / 7","6.0":"Server 2008 / Vista",5.2:"Server 2003 / XP 64-bit",5.1:"XP",5.01:"2000 SP1","5.0":"2000","4.0":"NT","4.90":"ME"};return IM&&_M&&/^Win/i.test(wu)&&!/^Windows Phone /i.test(wu)&&(EM=EM[/[\d.]+$/.exec(wu)])&&(wu="Windows "+EM),wu=String(wu),IM&&_M&&(wu=wu.replace(RegExp(IM,"i"),_M)),br(wu.replace(/ ce$/i," CE").replace(/\bhpw/i,"web").replace(/\bMacintosh\b/,"Mac OS").replace(/_PowerPC\b/i," OS").replace(/\b(OS X) [^ \d]+/i,"$1").replace(/\bMac (OS X)\b/,"$1").replace(/\/(\d)/," $1").replace(/_/g,".").replace(/(?: BePC|[ .]*fc[ \d.]+)$/i,"").replace(/\bx86\.64\b/gi,"x86_64").replace(/\b(Windows Phone) OS\b/,"$1").replace(/\b(Chrome OS \w+) [\d.]+\b/,"$1").split(" on ")[0])}(mi,Yh,Si.label||Si)),mi})}(["Windows Phone","KaiOS","Android","CentOS",{label:"Chrome OS",pattern:"CrOS"},"Debian",{label:"DragonFly BSD",pattern:"DragonFly"},"Fedora","FreeBSD","Gentoo","Haiku","Kubuntu","Linux Mint","OpenBSD","Red Hat","SuSE","Ubuntu","Xubuntu","Cygwin","Symbian OS","hpwOS","webOS ","webOS","Tablet OS","Tizen","Linux","Mac OS X","Macintosh","Mac","Windows 98;","Windows "]);function AM(ra){return Br(ra,function(Pi,mi){var Si=mi.pattern||Nr(mi);return!Pi&&(Pi=RegExp("\\b"+Si+" *\\d+[.\\w_]*","i").exec(bn)||RegExp("\\b"+Si+" *\\w+-[\\w]*","i").exec(bn)||RegExp("\\b"+Si+"(?:; *(?:[a-z]+[_-])?[a-z]+\\d+|[^ ();-]*)","i").exec(bn))&&((Pi=String(mi.label&&!RegExp(Si,"i").test(mi.label)?mi.label:Pi).split("/"))[1]&&!/[\d.]+/.test(Pi[0])&&(Pi[0]+=" "+Pi[1]),mi=mi.label||mi,Pi=br(Pi[0].replace(RegExp(Si,"i"),mi).replace(RegExp("; *(?:"+mi+"[_-])?","i")," ").replace(RegExp("("+mi+")[-_.]?(\\w)","i"),"$1 $2"))),Pi})}function OM(ra){return Br(ra,function(Pi,mi){return Pi||(RegExp(mi+"(?:-[\\d.]+/|(?: for [\\w-]+)?[ /-])([\\d.]+[^ ();/_-]*)","i").exec(bn)||0)[1]||null})}if(Zo&&(Zo=[Zo]),/\bAndroid\b/.test(Gn)&&!Oo&&(xr=/\bAndroid[^;]*;(.*?)(?:Build|\) AppleWebKit)\b/i.exec(bn))&&(Oo=Hr(xr[1]).replace(/^[a-z]{2}-[a-z]{2};\s*/i,"")||null),ds&&!Oo?Oo=AM([ds]):ds&&Oo&&(Oo=Oo.replace(RegExp("^("+Nr(ds)+")[-_.\\s]","i"),ds+" ").replace(RegExp("^("+Nr(ds)+")[-_.]?(\\w)","i"),ds+" $2")),(xr=/\bGoogle TV\b/.exec(Oo))&&(Oo=xr[0]),/\bSimulator\b/i.test(bn)&&(Oo=(Oo?Oo+" ":"")+"Simulator"),Hn=="Opera Mini"&&/\bOPiOS\b/.test(bn)&&xo.push("running in Turbo/Uncompressed mode"),Hn=="IE"&&/\blike iPhone OS\b/.test(bn)?(ds=(xr=Vr(bn.replace(/like iPhone OS/,""))).manufacturer,Oo=xr.product):/^iP/.test(Oo)?(Hn||(Hn="Safari"),Gn="iOS"+((xr=/ OS ([\d_]+)/i.exec(bn))?" "+xr[1].replace(/_/g,"."):"")):Hn=="Konqueror"&&/^Linux\b/i.test(Gn)?Gn="Kubuntu":ds&&ds!="Google"&&(/Chrome/.test(Hn)&&!/\bMobile Safari\b/i.test(bn)||/\bVita\b/.test(Oo))||/\bAndroid\b/.test(Gn)&&/^Chrome/.test(Hn)&&/\bVersion\//i.test(bn)?(Hn="Android Browser",Gn=/\bAndroid\b/.test(Gn)?Gn:"Android"):Hn=="Silk"?(/\bMobi/i.test(bn)||(Gn="Android",xo.unshift("desktop mode")),/Accelerated *= *true/i.test(bn)&&xo.unshift("accelerated")):Hn=="UC Browser"&&/\bUCWEB\b/.test(bn)?xo.push("speed mode"):Hn=="PaleMoon"&&(xr=/\bFirefox\/([\d.]+)\b/.exec(bn))?xo.push("identifying as Firefox "+xr[1]):Hn=="Firefox"&&(xr=/\b(Mobile|Tablet|TV)\b/i.exec(bn))?(Gn||(Gn="Firefox OS"),Oo||(Oo=xr[1])):!Hn||(xr=!/\bMinefield\b/i.test(bn)&&/\b(?:Firefox|Safari)\b/.exec(Hn))?(Hn&&!Oo&&/[\/,]|^[^(]+?\)/.test(bn.slice(bn.indexOf(xr+"/")+8))&&(Hn=null),(xr=Oo||ds||Gn)&&(Oo||ds||/\b(?:Android|Symbian OS|Tablet OS|webOS)\b/.test(Gn))&&(Hn=/[a-z]+(?: Hat)?/i.exec(/\bAndroid\b/.test(Gn)?Gn:xr)+" Browser")):Hn=="Electron"&&(xr=(/\bChrome\/([\d.]+)\b/.exec(bn)||0)[1])&&xo.push("Chromium "+xr),oo||(oo=OM(["(?:Cloud9|CriOS|CrMo|Edge|Edg|EdgA|EdgiOS|FxiOS|HeadlessChrome|IEMobile|Iron|Opera ?Mini|OPiOS|OPR|Raven|SamsungBrowser|Silk(?!/[\\d.]+$)|UCBrowser|YaBrowser)","Version",Nr(Hn),"(?:Firefox|Minefield|NetFront)"])),(xr=(Zo=="iCab"&&parseFloat(oo)>3?"WebKit":/\bOpera\b/.test(Hn)&&(/\bOPR\b/.test(bn)?"Blink":"Presto"))||/\b(?:Midori|Nook|Safari)\b/i.test(bn)&&!/^(?:Trident|EdgeHTML)$/.test(Zo)&&"WebKit"||!Zo&&/\bMSIE\b/i.test(bn)&&(Gn=="Mac OS"?"Tasman":"Trident")||Zo=="WebKit"&&/\bPlayStation\b(?! Vita\b)/i.test(Hn)&&"NetFront")&&(Zo=[xr]),Hn=="IE"&&(xr=(/; *(?:XBLWP|ZuneWP)(\d+)/i.exec(bn)||0)[1])?(Hn+=" Mobile",Gn="Windows Phone "+(/\+$/.test(xr)?xr:xr+".x"),xo.unshift("desktop mode")):/\bWPDesktop\b/i.test(bn)?(Hn="IE Mobile",Gn="Windows Phone 8.x",xo.unshift("desktop mode"),oo||(oo=(/\brv:([\d.]+)/.exec(bn)||0)[1])):Hn!="IE"&&Zo=="Trident"&&(xr=/\brv:([\d.]+)/.exec(bn))&&(Hn&&xo.push("identifying as "+Hn+(oo?" "+oo:"")),Hn="IE",oo=xr[1]),Hi){if(function(Pi,mi){var Si=Pi!=null?typeof Pi[mi]:"number";return!(/^(?:boolean|number|string|undefined)$/.test(Si)||Si=="object"&&!Pi[mi])}(Wn,"global"))if(Xn&&(Dc=(xr=Xn.lang.System).getProperty("os.arch"),Gn=Gn||xr.getProperty("os.name")+" "+xr.getProperty("os.version")),Bo){try{oo=Wn.require("ringo/engine").version.join("."),Hn="RingoJS"}catch{(xr=Wn.system)&&xr.global.system==Wn.system&&(Hn="Narwhal",Gn||(Gn=xr[0].os||null))}Hn||(Hn="Rhino")}else typeof Wn.process=="object"&&!Wn.process.browser&&(xr=Wn.process)&&(typeof xr.versions=="object"&&(typeof xr.versions.electron=="string"?(xo.push("Node "+xr.versions.node),Hn="Electron",oo=xr.versions.electron):typeof xr.versions.nw=="string"&&(xo.push("Chromium "+oo,"Node "+xr.versions.node),Hn="NW.js",oo=xr.versions.nw)),Hn||(Hn="Node.js",Dc=xr.arch,Gn=xr.platform,oo=(oo=/[\d.]+/.exec(xr.version))?oo[0]:null));else _r(xr=Wn.runtime)==Yr?(Hn="Adobe AIR",Gn=xr.flash.system.Capabilities.os):_r(xr=Wn.phantom)==Jn?(Hn="PhantomJS",oo=(xr=xr.version||null)&&xr.major+"."+xr.minor+"."+xr.patch):typeof mo.documentMode=="number"&&(xr=/\bTrident\/(\d+)/i.exec(bn))?(oo=[oo,mo.documentMode],(xr=+xr[1]+4)!=oo[1]&&(xo.push("IE "+oo[1]+" mode"),Zo&&(Zo[1]=""),oo[1]=xr),oo=Hn=="IE"?String(oo[1].toFixed(1)):oo[0]):typeof mo.documentMode=="number"&&/^(?:Chrome|Firefox)\b/.test(Hn)&&(xo.push("masking as "+Hn+" "+oo),Hn="IE",oo="11.0",Zo=["Trident"],Gn="Windows");Gn=Gn&&br(Gn)}if(oo&&(xr=/(?:[ab]|dp|pre|[ab]\d+pre)(?:\d+\+?)?$/i.exec(oo)||/(?:alpha|beta)(?: ?\d)?/i.exec(bn+";"+(Hi&&yo.appMinorVersion))||/\bMinefield\b/i.test(bn)&&"a")&&(bc=/b/i.test(xr)?"beta":"alpha",oo=oo.replace(RegExp(xr+"\\+?$"),"")+(bc=="beta"?ji:To)+(/\d+\+?/.exec(xr)||"")),Hn=="Fennec"||Hn=="Firefox"&&/\b(?:Android|Firefox OS|KaiOS)\b/.test(Gn))Hn="Firefox Mobile";else if(Hn=="Maxthon"&&oo)oo=oo.replace(/\.[\d.]+/,".x");else if(/\bXbox\b/i.test(Oo))Oo=="Xbox 360"&&(Gn=null),Oo=="Xbox 360"&&/\bIEMobile\b/.test(bn)&&xo.unshift("mobile mode");else if(!/^(?:Chrome|IE|Opera)$/.test(Hn)&&(!Hn||Oo||/Browser|Mobi/.test(Hn))||Gn!="Windows CE"&&!/Mobi/i.test(bn))if(Hn=="IE"&&Hi)try{Wn.external===null&&xo.unshift("platform preview")}catch{xo.unshift("embedded")}else(/\bBlackBerry\b/.test(Oo)||/\bBB10\b/.test(bn))&&(xr=(RegExp(Oo.replace(/ +/g," *")+"/([.\\d]+)","i").exec(bn)||0)[1]||oo)?(Gn=((xr=[xr,/BB10/.test(bn)])[1]?(Oo=null,ds="BlackBerry"):"Device Software")+" "+xr[0],oo=null):this!=Cr&&Oo!="Wii"&&(Hi&&So||/Opera/.test(Hn)&&/\b(?:MSIE|Firefox)\b/i.test(bn)||Hn=="Firefox"&&/\bOS X (?:\d+\.){2,}/.test(Gn)||Hn=="IE"&&(Gn&&!/^Win/.test(Gn)&&oo>5.5||/\bWindows XP\b/.test(Gn)&&oo>8||oo==8&&!/\bTrident\b/.test(bn)))&&!ae.test(xr=Vr.call(Cr,bn.replace(ae,"")+";"))&&xr.name&&(xr="ing as "+xr.name+((xr=xr.version)?" "+xr:""),ae.test(Hn)?(/\bIE\b/.test(xr)&&Gn=="Mac OS"&&(Gn=null),xr="identify"+xr):(xr="mask"+xr,Hn=Xo?br(Xo.replace(/([a-z])([A-Z])/g,"$1 $2")):"Opera",/\bIE\b/.test(xr)&&(Gn=null),Hi||(oo=null)),Zo=["Presto"],xo.push(xr));else Hn+=" Mobile";(xr=(/\bAppleWebKit\/([\d.]+\+?)/i.exec(bn)||0)[1])&&(xr=[parseFloat(xr.replace(/\.(\d)$/,".0$1")),xr],Hn=="Safari"&&xr[1].slice(-1)=="+"?(Hn="WebKit Nightly",bc="alpha",oo=xr[1].slice(0,-1)):oo!=xr[1]&&oo!=(xr[2]=(/\bSafari\/([\d.]+\+?)/i.exec(bn)||0)[1])||(oo=null),xr[1]=(/\b(?:Headless)?Chrome\/([\d.]+)/i.exec(bn)||0)[1],xr[0]==537.36&&xr[2]==537.36&&parseFloat(xr[1])>=28&&Zo=="WebKit"&&(Zo=["Blink"]),Hi&&(Rn||xr[1])?(Zo&&(Zo[1]="like Chrome"),xr=xr[1]||((xr=xr[0])<530?1:xr<532?2:xr<532.05?3:xr<533?4:xr<534.03?5:xr<534.07?6:xr<534.1?7:xr<534.13?8:xr<534.16?9:xr<534.24?10:xr<534.3?11:xr<535.01?12:xr<535.02?"13+":xr<535.07?15:xr<535.11?16:xr<535.19?17:xr<536.05?18:xr<536.1?19:xr<537.01?20:xr<537.11?"21+":xr<537.13?23:xr<537.18?24:xr<537.24?25:xr<537.36?26:Zo!="Blink"?"27":"28")):(Zo&&(Zo[1]="like Safari"),xr=(xr=xr[0])<400?1:xr<500?2:xr<526?3:xr<533?4:xr<534?"4+":xr<535?5:xr<537?6:xr<538?7:xr<601?8:xr<602?9:xr<604?10:xr<606?11:xr<608?12:"12"),Zo&&(Zo[1]+=" "+(xr+=typeof xr=="number"?".x":/[.+]/.test(xr)?"":"+")),Hn=="Safari"&&(!oo||parseInt(oo)>45)?oo=xr:Hn=="Chrome"&&/\bHeadlessChrome/i.test(bn)&&xo.unshift("headless")),Hn=="Opera"&&(xr=/\bzbov|zvav$/.exec(Gn))?(Hn+=" ",xo.unshift("desktop mode"),xr=="zvav"?(Hn+="Mini",oo=null):Hn+="Mobile",Gn=Gn.replace(RegExp(" *"+xr+"$"),"")):Hn=="Safari"&&/\bChrome\b/.exec(Zo&&Zo[1])?(xo.unshift("desktop mode"),Hn="Chrome Mobile",oo=null,/\bOS X\b/.test(Gn)?(ds="Apple",Gn="iOS 4.3+"):Gn=null):/\bSRWare Iron\b/.test(Hn)&&!oo&&(oo=OM("Chrome")),oo&&oo.indexOf(xr=/[\d.]+$/.exec(Gn))==0&&bn.indexOf("/"+xr+"-")>-1&&(Gn=Hr(Gn.replace(xr,""))),Gn&&Gn.indexOf(Hn)!=-1&&!RegExp(Hn+" OS").test(Gn)&&(Gn=Gn.replace(RegExp(" *"+Nr(Hn)+" *"),"")),Zo&&!/\b(?:Avant|Nook)\b/.test(Hn)&&(/Browser|Lunascape|Maxthon/.test(Hn)||Hn!="Safari"&&/^iOS/.test(Gn)&&/\bSafari\b/.test(Zo[1])||/^(?:Adobe|Arora|Breach|Midori|Opera|Phantom|Rekonq|Rock|Samsung Internet|Sleipnir|SRWare Iron|Vivaldi|Web)/.test(Hn)&&Zo[1])&&(xr=Zo[Zo.length-1])&&xo.push(xr),xo.length&&(xo=["("+xo.join("; ")+")"]),ds&&Oo&&Oo.indexOf(ds)<0&&xo.push("on "+ds),Oo&&xo.push((/^on /.test(xo[xo.length-1])?"":"on ")+Oo),Gn&&(xr=/ ([\d.+]+)$/.exec(Gn),wn=xr&&Gn.charAt(Gn.length-xr[0].length-1)=="/",Gn={architecture:32,family:xr&&!wn?Gn.replace(xr[0],""):Gn,version:xr?xr[1]:null,toString:function(){var ra=this.version;return this.family+(ra&&!wn?" "+ra:"")+(this.architecture==64?" 64-bit":"")}}),(xr=/\b(?:AMD|IA|Win|WOW|x86_|x)64\b/i.exec(Dc))&&!/\bi686\b/i.test(Dc)?(Gn&&(Gn.architecture=64,Gn.family=Gn.family.replace(RegExp(" *"+xr),"")),Hn&&(/\bWOW64\b/i.test(bn)||Hi&&/\w(?:86|32)$/.test(yo.cpuClass||yo.platform)&&!/\bWin64; x64\b/i.test(bn))&&xo.unshift("32-bit")):Gn&&/^OS X/.test(Gn.family)&&Hn=="Chrome"&&parseFloat(oo)>=39&&(Gn.architecture=64),bn||(bn=null);var Gs={};return Gs.description=bn,Gs.layout=Zo&&Zo[0],Gs.manufacturer=ds,Gs.name=Hn,Gs.prerelease=bc,Gs.product=Oo,Gs.ua=bn,Gs.version=Hn&&oo,Gs.os=Gn||{architecture:null,family:null,version:null,toString:function(){return"null"}},Gs.parse=Vr,Gs.toString=function(){return this.description||""},Gs.version&&xo.unshift(oo),Gs.name&&xo.unshift(Hn),Gn&&Hn&&(Gn!=String(Gn).split(" ")[0]||Gn!=Hn.split(" ")[0]&&!Oo)&&xo.push(Oo?"("+Gn+")":"on "+Gn),xo.length&&(Gs.description=xo.join(" ")),Gs}();D&&M?Cr($r,function(Vr,bn){D[bn]=Vr}):F.platform=$r}).call(e)}),GT=Math.floor,nh=function(x,T){var F=x.length,D=GT(F/2);return F<8?oh(x,T):KT(x,nh(Tl(x,0,D),T),nh(Tl(x,D),T),T)},oh=function(x,T){for(var F,D,M=x.length,z=1;z<M;){for(D=z,F=x[z];D&&T(x[D-1],F)>0;)x[D]=x[--D];D!==z++&&(x[D]=F)}return x},KT=function(x,T,F,D){for(var M=T.length,z=F.length,pe=0,ae=0;pe<M||ae<z;)x[pe+ae]=pe<M&&ae<z?D(T[pe],F[ae])<=0?T[pe++]:F[ae++]:pe<M?T[pe++]:F[ae++];return x},ih=nh,Xy=cr.match(/firefox\/(\d+)/i),kd=!!Xy&&+Xy[1],gi=/MSIE|Trident/.test(cr),Zy=cr.match(/AppleWebKit\/(\d+)\./),sh=!!Zy&&+Zy[1],ac=[],ev=re(ac.sort),tv=re(ac.push),QT=u(function(){ac.sort(void 0)}),rv=u(function(){ac.sort(null)}),nv=Ds("sort"),ov=!u(function(){if(gr)return gr<70;if(!(kd&&kd>3)){if(gi)return!0;if(sh)return sh<603;var x,T,F,D,M="";for(x=65;x<76;x++){switch(T=String.fromCharCode(x),x){case 66:case 69:case 70:case 72:F=3;break;case 68:case 71:F=4;break;default:F=2}for(D=0;D<47;D++)ac.push({k:T+D,v:F})}for(ac.sort(function(z,pe){return pe.v-z.v}),D=0;D<ac.length;D++)T=ac[D].k.charAt(0),M.charAt(M.length-1)!==T&&(M+=T);return M!=="DGBEFHACIJK"}});qr({target:"Array",proto:!0,forced:QT||!rv||!nv||!ov},{sort:function(T){T!==void 0&&Or(T);var F=An(this);if(ov)return T===void 0?ev(F):ev(F,T);var D,M,z=[],pe=Ci(F);for(M=0;M<pe;M++)M in F&&tv(z,F[M]);for(ih(z,function(ae){return function(ze,jt){return jt===void 0?-1:ze===void 0?1:ae!==void 0?+ae(ze,jt)||0:_i(ze)>_i(jt)?1:-1}}(T)),D=Ci(z),M=0;M<D;)F[M]=z[M++];for(;M<pe;)Op(F,M++);return F}});var JT=Ao("Array").sort,ah=Array.prototype,Ec=function(x){var T=x.sort;return x===ah||Lt(ah,x)&&T===ah.sort?JT:T},ch=s(function(x,T){x.exports=function(){var F={d:function(xr,wn){for(var Rn in wn)F.o(wn,Rn)&&!F.o(xr,Rn)&&Qa(xr,Rn,{enumerable:!0,get:wn[Rn]})},o:function(xr,wn){return Object.prototype.hasOwnProperty.call(xr,wn)}},D={};F.d(D,{default:function(){return yo}});var M=function Fn(xr){for(var wn in function(Rn,Tn){if(!(Rn instanceof Tn))throw new TypeError("Cannot call a class as a function")}(this,Fn),this.directUploadAddr="https://wanproxy-web.127.net",this.retryCount=4,this.trunkSize=4194304,this.trunkUploadTimeout=5e4,this.getOffsetTimeout=1e4,this.version="1.0",this.enableCache=!0,this.logger=console,this.onError=function(Rn){},this.onProgress=function(Rn){},this.onUploadProgress=function(Rn){},this.onComplete=function(Rn){},xr)this[wn]=xr[wn]};function z(Fn,xr){var wn=li!==void 0&&Sd(Fn)||Fn["@@iterator"];if(!wn){if(ya(Fn)||(wn=function(Jn,Xn){if(Jn){var Bo;if(typeof Jn=="string")return pe(Jn,Xn);var To=fo(Bo=Object.prototype.toString.call(Jn)).call(Bo,8,-1);return To==="Object"&&Jn.constructor&&(To=Jn.constructor.name),To==="Map"||To==="Set"?Fp(Jn):To==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(To)?pe(Jn,Xn):void 0}}(Fn))||xr&&Fn&&typeof Fn.length=="number"){wn&&(Fn=wn);var Rn=0,Tn=function(){};return{s:Tn,n:function(){return Rn>=Fn.length?{done:!0}:{done:!1,value:Fn[Rn++]}},e:function(Xn){throw Xn},f:Tn}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var Yr,Pn=!0,Un=!1;return{s:function(){wn=wn.call(Fn)},n:function(){var Xn=wn.next();return Pn=Xn.done,Xn},e:function(Xn){Un=!0,Yr=Xn},f:function(){try{Pn||wn.return==null||wn.return()}finally{if(Un)throw Yr}}}}function pe(Fn,xr){(xr==null||xr>Fn.length)&&(xr=Fn.length);for(var wn=0,Rn=new Array(xr);wn<xr;wn++)Rn[wn]=Fn[wn];return Rn}var ae=window.localStorage;window.localStorage&&typeof window.localStorage.getItem=="function"&&typeof window.localStorage.setItem=="function"&&typeof window.localStorage.removeItem=="function"||(ae={privateObj:{},setItem:function(xr,wn){ae.privateObj[xr]=wn},getItem:function(xr){return ae.privateObj[xr]},removeItem:function(xr){delete ae.privateObj[xr]},getKeys:function(){return No(ae.privateObj)}});var ze={getFileKey:function(xr){var wn=xr.size.toString(),Rn=xr.lastModified.toString();return"_NosUploader_"+xr.name+fo(wn).call(wn,wn.length-5)+fo(Rn).call(Rn,Rn.length-5)},getFileInfo:function(xr){var wn=ae.getItem(xr);if(!wn)return null;try{return JSON.parse(wn)}catch{return null}},initFile:function(xr,wn,Rn){ze.clearExpiredInfo();var Tn=this.getFileKey(wn),Yr={ctx:xr.ctx!==void 0?xr.ctx:"",bucket:xr.bucketName,obj:xr.objectName,token:xr.token,modifyAt:ti(),end:!1};return xr.payload&&(Yr.payload=xr.payload),Rn&&ae.setItem(Tn,Uo(Yr)),Tn},setUploadContext:function(xr,wn,Rn){var Tn=this.getFileInfo(xr);Tn&&(Tn.ctx=wn,Rn&&ae.setItem(xr,Uo(Tn)))},setComplete:function(xr,wn){var Rn=this.getFileInfo(xr);Rn&&(Rn.modifyAt=ti(),Rn.end=!0,wn&&ae.setItem(xr,Uo(Rn)))},getUploadContext:function(xr){var wn=this.getFileInfo(xr);return wn?wn.ctx:""},removeFileInfo:function(xr){bi(xr).call(xr,"_NosUploader_")===0&&ae.removeItem(xr)},clearExpiredInfo:function(){var xr,wn=typeof ae.getKeys=="function"?ae.getKeys():No(ae),Rn=ti(),Tn=[],Yr=z(wn);try{for(Yr.s();!(xr=Yr.n()).done;){var Pn=xr.value;if(bi(Pn).call(Pn,"_NosUploader_")===0){var Un=ze.getFileInfo(Pn);Un===null||Rn-Un.modifyAt>yo.expireTime?ae.removeItem(Pn):Tn.push({fileInfo:Un,key:Pn})}}}catch(mo){Yr.e(mo)}finally{Yr.f()}if(Tn.length>yo.maxFileCache){var Jn,Xn,Bo=z(fo(Jn=Ec(Tn).call(Tn,function(mo,So){return So.fileInfo.modifyAt-mo.fileInfo.modifyAt})).call(Jn,yo.maxFileCache));try{for(Bo.s();!(Xn=Bo.n()).done;){var To,ji=Xn.value;bi(To=ji.key).call(To,"_NosUploader_")===0&&ae.removeItem(ji.key)}}catch(mo){Bo.e(mo)}finally{Bo.f()}}}},jt=ze;function ur(Fn){return(ur=typeof li=="function"&&typeof fm=="symbol"?function(xr){return typeof xr}:function(xr){return xr&&typeof li=="function"&&xr.constructor===li&&xr!==li.prototype?"symbol":typeof xr})(Fn)}function hr(Fn,xr){return!xr||ur(xr)!=="object"&&typeof xr!="function"?function(wn){if(wn===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return wn}(Fn):xr}function br(Fn){var xr=typeof nc=="function"?new nc:void 0;return(br=function(Rn){var Tn,Yr;if(Rn===null||(Yr=Rn,bi(Tn=Function.toString.call(Yr)).call(Tn,"[native code]")===-1))return Rn;if(typeof Rn!="function")throw new TypeError("Super expression must either be null or a function");if(xr!==void 0){if(xr.has(Rn))return xr.get(Rn);xr.set(Rn,Pn)}function Pn(){return Cr(Rn,arguments,Br(this).constructor)}return Pn.prototype=Qi(Rn.prototype,{constructor:{value:Pn,enumerable:!1,writable:!0,configurable:!0}}),Nr(Pn,Rn)})(Fn)}function Cr(Fn,xr,wn){return(Cr=_r()?Pa:function(Rn,Tn,Yr){var Pn=[null];Pn.push.apply(Pn,Tn);var Un=new(Mo(Function).apply(Rn,Pn));return Yr&&Nr(Un,Yr.prototype),Un}).apply(null,arguments)}function _r(){if(typeof Reflect>"u"||!Pa||Pa.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Pa(Boolean,[],function(){})),!0}catch{return!1}}function Nr(Fn,xr){return(Nr=Rs||function(wn,Rn){return wn.__proto__=Rn,wn})(Fn,xr)}function Br(Fn){return(Br=Rs?Us:function(xr){return xr.__proto__||Us(xr)})(Fn)}var Hr=function(Fn){(function(Yr,Pn){if(typeof Pn!="function"&&Pn!==null)throw new TypeError("Super expression must either be null or a function");Yr.prototype=Qi(Pn&&Pn.prototype,{constructor:{value:Yr,writable:!0,configurable:!0}}),Pn&&Nr(Yr,Pn)})(Tn,Fn);var xr,wn,Rn=(xr=Tn,wn=_r(),function(){var Yr,Pn=Br(xr);if(wn){var Un=Br(this).constructor;Yr=Pa(Pn,arguments,Un)}else Yr=Pn.apply(this,arguments);return hr(this,Yr)});function Tn(Yr,Pn){var Un;return function(Jn,Xn){if(!(Jn instanceof Xn))throw new TypeError("Cannot call a class as a function")}(this,Tn),(Un=Rn.call(this,"NosUploadError:"+Yr)).errCode=Pn,Un.errMsg=Yr,Un}return Tn}(br(Error)),$r=function Fn(xr,wn,Rn){if(xr.uploadState==="uploading"){var Tn=xr.config,Yr=xr.param,Pn=jt.getUploadContext(xr.fileKey);if(!Pn)return Rn(0);var Un=new XMLHttpRequest,Jn=Tn.directUploadAddr+"/".concat(Yr.bucketName)+"/".concat(encodeURIComponent(Yr.objectName))+"?uploadContext"+"&context=".concat(Pn)+"&version=".concat(Tn.version);Un.onreadystatechange=function(){var Xn;if(xr.uploadState!=="abort"&&Un.readyState===4){var Bo,To,ji,mo;try{mo=JSON.parse(Un.responseText)}catch{mo={errMsg:"JsonParseError in getOffset",errCode:500}}Un.status===200?mo.errCode?xr.config.onError(new Hr(mo.errMsg,mo.errCode)):Rn(mo.offset):Un.status.toString().match(/^5/)?Fn(xr,wn-1,Rn):wn>0?(typeof((Xn=Tn.logger)===null||Xn===void 0?void 0:Xn.error)=="function"&&Tn.logger.error(Ss(Bo="getOffset(".concat(Jn,") error. retry after 3 seconds. ")).call(Bo,new Date().toTimeString())),co(function(){Fn(xr,wn-1,Rn)},3500)):(jt.removeFileInfo(xr.fileKey),Un.status?Tn.onError(new Hr(Ss(To=Ss(ji="getOffset(".concat(Jn,") error: ")).call(ji,Un.status," ")).call(To,Un.statusText))):Tn.onError(new Hr("getOffset(".concat(Jn,") error. no Error Code"))))}},Un.open("get",Jn),Un.setRequestHeader("x-nos-token",Yr.token),Un.timeout=Tn.getOffsetTimeout,Un.send()}},Vr=function Fn(xr,wn,Rn,Tn){if(xr.uploadState==="uploading"){var Yr=xr.param,Pn=xr.config,Un=fo(File.prototype),Jn=Yr.ctx!==void 0?Yr.ctx:"",Xn=wn+Pn.trunkSize>xr.file.size,Bo=Xn?xr.file.size:wn+Pn.trunkSize,To=new XMLHttpRequest,ji=Pn.directUploadAddr+"/".concat(Yr.bucketName)+"/".concat(encodeURIComponent(Yr.objectName));if(To.upload.onprogress=function(So){if(xr.uploadState!=="abort"){var Xo=0;So.lengthComputable?(Xo=(wn+So.loaded)/xr.file.size,Pn.onProgress(Xo),Pn.onUploadProgress({loaded:So.loaded,total:xr.file.size,percentage:Xo,percentageText:(100*Xo).toFixed(2)+"%"})):Pn.onError(new Hr("browser does not support query upload progress"))}},To.onreadystatechange=function(){var So,Xo;if(xr.uploadState!=="abort"&&To.readyState===4){var Dc,xo,bc,Hi;try{Hi=JSON.parse(To.responseText)}catch(oo){typeof((So=Pn.logger)===null||So===void 0?void 0:So.error)=="function"&&Pn.logger.error("JsonParseError in uploadTrunk",oo),Hi={errMsg:"JsonParseError in uploadTrunk"}}To.status===200?(xr.setContext(Hi.context),Xn?(Tn(),xr.setComplete()):Fn(xr,Hi.offset,Pn.retryCount,Tn)):To.status.toString().match(/^5/)?Rn>0?Fn(xr,wn,Rn-1,Tn):(jt.removeFileInfo(xr.fileKey),Pn.onError(new Hr(Hi.errMsg,Hi.errCode))):Rn>0?(typeof((Xo=Pn.logger)===null||Xo===void 0?void 0:Xo.error)=="function"&&Pn.logger.error(Ss(Dc="uploadTrunk(".concat(ji,") error. retry after 3 seconds. ")).call(Dc,new Date().toTimeString())),co(function(){Fn(xr,wn,Rn-1,Tn)},3500)):(jt.removeFileInfo(xr.fileKey),To.status?Pn.onError(new Hr(Ss(xo=Ss(bc="uploadTrunk(".concat(ji,") error: ")).call(bc,To.status," ")).call(xo,To.statusText))):Pn.onError(new Hr("uploadTrunk(".concat(ji,") error. no Error Code. Please check your network"))))}},To.open("post",ji+"?offset=".concat(wn)+"&complete=".concat(Xn)+"&context=".concat(Jn)+"&version=".concat(Pn.version)),To.setRequestHeader("x-nos-token",Yr.token),xr.file.type&&To.setRequestHeader("content-type",xr.file.type),To.timeout=Pn.trunkUploadTimeout,typeof FileReader<"u"){var mo=new FileReader;mo.addEventListener("load",function(So){var Xo;!((Xo=So==null?void 0:So.target)===null||Xo===void 0)&&Xo.result?To.send(So.target.result):Pn.onError(new Hr("Read ArrayBuffer failed"))}),mo.addEventListener("error",function(So){var Xo=So.target.error;Pn.onError(new Hr("Read ArrayBuffer error. ".concat(Xo.toString()),Xo.code))}),mo.readAsArrayBuffer(Un.call(xr.file,wn,Bo))}else To.send(Un.call(xr.file,wn,Bo))}};function bn(Fn,xr){for(var wn=0;wn<xr.length;wn++){var Rn=xr[wn];Rn.enumerable=Rn.enumerable||!1,Rn.configurable=!0,"value"in Rn&&(Rn.writable=!0),Qa(Fn,Rn.key,Rn)}}var Wn=function(){function Fn(wn,Rn,Tn){(function(Yr,Pn){if(!(Yr instanceof Pn))throw new TypeError("Cannot call a class as a function")})(this,Fn),this.uploadState="paused",this.config=Tn,this.file=wn,this.param=Rn,this.fileKey=jt.initFile(Rn,wn,this.config.enableCache),this.resume()}var xr;return(xr=[{key:"resume",value:function(){var Rn=this;if(this.uploadState!=="uploading"){this.setUploadState("uploading");var Tn=this.config;$r(this,Tn.retryCount,function(Yr){Vr(Rn,Yr,Tn.retryCount,function(){Rn.setUploadState("ended"),typeof Tn.onComplete=="function"&&Tn.onComplete(Rn.param)})})}}},{key:"pause",value:function(){this.setUploadState("paused")}},{key:"abort",value:function(){this.setUploadState("abort"),jt.removeFileInfo(this.fileKey),this.config.onError(new Hr("Upload Aborted",10499))}},{key:"setUploadState",value:function(Rn){Rn!==this.uploadState&&(this.uploadState=Rn)}},{key:"setContext",value:function(Rn){jt.setUploadContext(this.fileKey,Rn,this.config.enableCache),this.param.ctx=Rn}},{key:"setComplete",value:function(){jt.setComplete(this.fileKey,this.config.enableCache),this.setUploadState("ended")}}])&&bn(Fn.prototype,xr),Fn}(),qn={maxFileCache:6,expireTime:864e5,getFileUploadInformation:function(xr){var wn=jt.getFileKey(xr),Rn=jt.getFileInfo(wn);return Rn===null?null:ti()-Rn.modifyAt>qn.expireTime?(jt.removeFileInfo(wn),null):{uploadInfo:kr({bucketName:Rn.bucket,objectName:Rn.obj,token:Rn.token,ctx:Rn.ctx},Rn.payload?{payload:Rn.payload}:{}),complete:Rn.end}},setMaxFileCache:function(xr){qn.maxFileCache=xr},setExpireTime:function(xr){qn.expireTime=xr},printCaches:function(){for(var xr=0,wn=No(localStorage);xr<wn.length;xr++){var Rn=wn[xr],Tn=jt.getFileInfo(Rn);Tn&&console.log(Tn,"modifiedAt",new Date(Tn.modifyAt).toTimeString())}},createConfig:function(xr){return new M(xr)},createTask:function(xr,wn,Rn){return new Wn(xr,wn,Rn)}},yo=qn;return D.default}()}),YT=s(function(x,T){x.exports=function(){function F(pe){if(pe){var ae,ze="";return kn(ae=No(pe)).call(ae,function(jt,ur){ze+=ur===0?"?":"&",ze+=jt+"="+pe[jt]}),ze}return""}function D(pe,ae,ze,jt){return Error.call(this,ze),this.source=pe,this.code=ae,this.desc=ze,this.detail=jt||{},this}function M(pe,ae){var ze=Qi(ae.prototype);ze.constructor=pe,pe.prototype=ze}function z(pe,ae){ae===void 0&&(ae={dataType:"json",method:"GET",timeout:5e3});var ze=ae.dataType==="text"?"text/plain; charset=UTF-8":"application/json; charset=UTF-8",jt=ae.method==="GET"?F(ae.params):"";return new ro(function(ur,hr){if(window.XMLHttpRequest){var br,Cr=new XMLHttpRequest;if(Cr.onreadystatechange=function(){if(Cr.readyState===4)if(Cr.status===200){try{br=JSON.parse(Cr.response||"{}")}catch{br=Cr.response}ur({status:Cr.status,data:br})}else hr(new D(1,Cr.status,Cr.statusText))},Cr.open(ae.method,""+pe+jt),Cr.timeout=ae.timeout||5e3,Cr.setRequestHeader("Content-Type",ze),ae.headers)for(var _r in ae.headers)Cr.setRequestHeader(_r,ae.headers[_r]);Cr.ontimeout=function(Nr){hr(new D(1,408,Nr&&Nr.message?Nr.message:"request timeout"))},Cr.send(Uo(ae.data))}else hr(new D(2,10400,"request no suppout"))})}return M(D,Error),z}()}),iv=console,cc,Bi,Ku,di,Xs,sv={setLogger:function(T){iv=T},platform:"BROWSER",localStorage:window.localStorage,request:YT,WebSocket:window.WebSocket,uploadFile:function(T){return hn(this,void 0,void 0,rr.mark(function F(){var D,M,z,pe,ae,ze;return rr.wrap(function(ur){for(;;)switch(ur.prev=ur.next){case 0:if(T.fileInput||T.file){ur.next=2;break}throw new Error("File not exist");case 2:if(!T.file){ur.next=6;break}pe=T.file,ur.next=20;break;case 6:if(typeof T.fileInput!="string"){ur.next=15;break}if(!((ae=document.getElementById(T.fileInput))&&ae.files&&ae.files[0])){ur.next=12;break}pe=ae.files[0],ur.next=13;break;case 12:throw new Error("Can not get file from fileInput");case 13:ur.next=20;break;case 15:if(!(T.fileInput&&T.fileInput.files&&T.fileInput.files[0])){ur.next=19;break}pe=T.fileInput.files[0],ur.next=20;break;case 19:throw new Error("Can not get file from fileInput "+T.fileInput);case 20:if(!(T.maxSize&&pe.size>T.maxSize)){ur.next=22;break}throw new Error("The file exceeds maxSize limit. maxSize: "+T.maxSize+", get "+pe.size);case 22:return ur.next=24,new ro(function(hr,br){var Cr=ch.createConfig({enableCache:!1,directUploadAddr:T.chunkUploadHost,onError:function(Br){br(Br)},onProgress:T.onUploadProgress||function(){},onComplete:function(Br){hr(Br)}}),_r=ch.createTask(pe,{bucketName:T.nosToken.bucket,objectName:decodeURIComponent(T.nosToken.objectName),token:T.nosToken.token},Cr);try{T.onUploadStart&&T.onUploadStart(_r)}catch(Nr){iv.error("Adapter uploadFile: options.onUploadStart error",Nr&&Nr.message),_r.abort(),br(Nr)}});case 24:return(ze=ur.sent).name=pe.name,ze.size=pe.size,ze.type=pe.type,ze.ext=rh(D=ze.name).call(D,".")>-1?fo(M=ze.name).call(M,rh(z=ze.name).call(z,".")+1).toLowerCase():"",ur.abrupt("return",ze);case 30:case"end":return ur.stop()}},F)}))},getSystemInfo:function(){var T,F;return{os:((T=Gu.os)===null||T===void 0?void 0:T.family)||"",osVer:((F=Gu.os)===null||F===void 0?void 0:F.version)||"",browser:Gu.name||"",browserVer:Gu.version||"",hostEnv:"BROWSER",hostEnvVer:Gu.version||"",hostInfo:Gu.ua||""}}},ns=function(){function x(T,F){this.name=T,this.core=F,this.name=T,this.logger=F.logger,this.core=F}return x.prototype.process=function(F){var D=this[F.cmd+"Handler"];return typeof D=="function"?D.call(this,F):F.error&&!F.error.ignore?ro.reject(F.error):ro.resolve(F)},x}();(function(x){x[x.text=0]="text",x[x.image=1]="image",x[x.audio=2]="audio",x[x.video=3]="video",x[x.geo=4]="geo",x[x.notification=5]="notification",x[x.file=6]="file",x[x.tip=10]="tip",x[x.robot=11]="robot",x[x.g2=12]="g2",x[x.custom=100]="custom"})(cc||(cc={})),function(x){x[x.p2p=0]="p2p",x[x.team=1]="team",x[x.superTeam=5]="superTeam"}(Bi||(Bi={})),function(x){x[x.Android=1]="Android",x[x.iOS=2]="iOS",x[x.PC=4]="PC",x[x.WindowsPhone=8]="WindowsPhone",x[x.Web=16]="Web",x[x.Server=32]="Server",x[x.Mac=64]="Mac"}(Ku||(Ku={})),function(x){x[x.unread=1]="unread",x[x.read=2]="read",x[x.deleted=3]="deleted",x[x.sending=4]="sending",x[x.sendFailed=5]="sendFailed",x[x.sent=6]="sent",x[x.receipt=7]="receipt",x[x.refused=10]="refused"}(di||(di={})),function(x){x[x.default=0]="default",x[x.leave=1]="leave",x[x.roam=2]="roam"}(Xs||(Xs={}));var uh=function(T,F){return function(D){return T(F(D))}},lh=uh(Object.getPrototypeOf,Object),XT=Function.prototype,ZT=Object.prototype,av=XT.toString,eS=ZT.hasOwnProperty,gu=av.call(Object),xd=function(T){if(!va(T)||Sc(T)!="[object Object]")return!1;var F=lh(T);if(F===null)return!0;var D=eS.call(F,"constructor")&&F.constructor;return typeof D=="function"&&D instanceof D&&av.call(D)==gu};function Zs(x,T){if(!xd(T))return{};var F=JSON.parse(Uo(T)),D=dh(x,F);return JSON.parse(Uo(kr(kr({},F),D)))}function dh(x,T){if(!xd(T))return{};var F={},D=No(x);return kn(D).call(D,function(M){var z=x[M].type;if(typeof z!="string"){var pe=dh(x[M],T);No(pe).length>0&&(F[M]=pe)}else{var ae=x[M],ze=ae.rawKey||M,jt=qp[z](T,ze,ae);jt!==void 0&&(T[ze]=void 0,F[M]=jt)}}),F}var qp={number:function(T,F){if(T[F]!==void 0)return+T[F]},string:function(T,F){if(T[F]!==void 0)return T[F]},boolean:function(T,F){return+T[F]>0||+T[F]!=0&&void 0},enum:function(T,F,D){return pp(D)[T[F]]},object:function(T,F){if(T[F]!==void 0)try{return JSON.parse(T[F])}catch{return{}}}};function wd(x,T){if(!xd(T))return{};var F=JSON.parse(Uo(T)),D=cv(x,F);return JSON.parse(Uo(kr(kr({},F),D)))}function cv(x,T){var F;if(!xd(T))return lp(F=No(x)).call(F,function(z,pe){return z[x[pe].rawKey||pe]=void 0,z},{});var D={},M=No(x);return kn(M).call(M,function(z){var pe=x[z].type;if(typeof pe!="string"){var ae=cv(x[z],T[z]);return kr(D,ae),void(T[z]=void 0)}var ze=x[z],jt=ze.rawKey||z,ur=ph[pe](T,z,ze);T[jt]=void 0,D[jt]=ur}),D}var ph={number:function(T,F){return T[F]},string:function(T,F){return T[F]},boolean:function(T,F){return T[F]===!0?1:T[F]===!1?0:void 0},enum:function(T,F,D){return pp(D)[T[F]]},object:function(T,F){if(T[F]!==void 0)try{return Uo(T[F])}catch{return""}}},tS=ph,uv=function(T){return function(F,D,M){for(var z=-1,pe=Object(F),ae=M(F),ze=ae.length;ze--;){var jt=ae[T?ze:++z];if(D(pe[jt],jt,pe)===!1)break}return F}}(),rS=function(T,F){for(var D=-1,M=Array(T);++D<T;)M[D]=F(D);return M},fh=function(T){return va(T)&&Sc(T)=="[object Arguments]"},lv=Object.prototype,$p=lv.hasOwnProperty,nS=lv.propertyIsEnumerable,oS=fh(function(){return arguments}())?fh:function(x){return va(x)&&$p.call(x,"callee")&&!nS.call(x,"callee")},Id=oS,mh=function(){return!1},Hp=s(function(x,T){var F=T&&!T.nodeType&&T,D=F&&x&&!x.nodeType&&x,M=D&&D.exports===F?_s.Buffer:void 0,z=(M?M.isBuffer:void 0)||mh;x.exports=z}),iS=/^(?:0|[1-9]\d*)$/,Vp=function(T,F){var D=typeof T;return!!(F=F??9007199254740991)&&(D=="number"||D!="symbol"&&iS.test(T))&&T>-1&&T%1==0&&T<F},hi={};hi["[object Float32Array]"]=hi["[object Float64Array]"]=hi["[object Int8Array]"]=hi["[object Int16Array]"]=hi["[object Int32Array]"]=hi["[object Uint8Array]"]=hi["[object Uint8ClampedArray]"]=hi["[object Uint16Array]"]=hi["[object Uint32Array]"]=!0,hi["[object Arguments]"]=hi["[object Array]"]=hi["[object ArrayBuffer]"]=hi["[object Boolean]"]=hi["[object DataView]"]=hi["[object Date]"]=hi["[object Error]"]=hi["[object Function]"]=hi["[object Map]"]=hi["[object Number]"]=hi["[object Object]"]=hi["[object RegExp]"]=hi["[object Set]"]=hi["[object String]"]=hi["[object WeakMap]"]=!1;var sS=function(T){return va(T)&&Dg(T.length)&&!!hi[Sc(T)]},gh=as&&as.isTypedArray,hh=gh?ju(gh):sS,aS=Object.prototype.hasOwnProperty,dv=function(T,F){var D=Ta(T),M=!D&&Id(T),z=!D&&!M&&Hp(T),pe=!D&&!M&&!z&&hh(T),ae=D||M||z||pe,ze=ae?rS(T.length,String):[],jt=ze.length;for(var ur in T)!F&&!aS.call(T,ur)||ae&&(ur=="length"||z&&(ur=="offset"||ur=="parent")||pe&&(ur=="buffer"||ur=="byteLength"||ur=="byteOffset")||Vp(ur,jt))||ze.push(ur);return ze},zp=Object.prototype,hu=function(T){var F=T&&T.constructor;return T===(typeof F=="function"&&F.prototype||zp)},yh=uh(Object.keys,Object),Vi=Object.prototype.hasOwnProperty,cS=function(T){if(!hu(T))return yh(T);var F=[];for(var D in Object(T))Vi.call(T,D)&&D!="constructor"&&F.push(D);return F},_d=function(T){return kp(T)?dv(T):cS(T)},pv=function(T,F){return T&&uv(T,F,_d)},uS=function(T,F,D,M){return pv(T,function(z,pe,ae){F(M,D(z),pe,ae)}),M},vh,lS=function(T,F){return function(D,M){return uS(D,T,F(M),{})}},dS=Object.prototype.toString,zi=lS(function(x,T,F){T!=null&&typeof T.toString!="function"&&(T=dS.call(T)),x[T]=F},Oy(Hu)),pS=zi({Android:1,iOS:2,PC:4,WindowsPhone:8,Web:16,Server:32,Mac:64}),bh={p2p:0,team:1,superTeam:5};function fv(x,T){return x&&x.length>0?lo(x).call(x,function(F){return kr(kr({},F),{account:F.account,connectionId:F.connectionId,deviceId:F.deviceId,ip:F.ip,mac:F.mac,os:F.os,type:pS[F.type]||F.type,time:go(F.time),online:T!==3})}):[]}zi(bh),function(x){x[x.text=0]="text",x[x.image=1]="image",x[x.audio=2]="audio",x[x.video=3]="video",x[x.geo=4]="geo",x[x.notification=5]="notification",x[x.file=6]="file",x[x.tip=10]="tip",x[x.robot=11]="robot",x[x.g2=12]="g2",x[x.custom=100]="custom"}(vh||(vh={}));var fS={1:{reason:"samePlatformKick",message:"The same account is not allowed to multiple login at the same time"},2:{reason:"serverKick",message:"Kicked out by IM server"},3:{reason:"otherPlatformKick",message:"Kicked out by other client of your account"},4:{reason:"silentlyKick",message:"Quietly kicked"}},mv={BROWSER:0,RN:2,UNIAPP:3,WECHAT:6},gv=function(x){function T(D){var M;return M=x.call(this,"auth",D)||this,Ui({cmdMap:Wy,cmdConfig:Ky}),M}Co(T,x);var F=T.prototype;return F.doLogin=function(M){var z,pe;return M===void 0&&(M=!1),hn(this,void 0,void 0,rr.mark(function ae(){var ze,jt,ur,hr,br,Cr,_r,Nr,Br,Hr;return rr.wrap(function(Vr){for(;;)switch(Vr.prev=Vr.next){case 0:return ze=this.core.options,jt=Fo.getSystemInfo(),ur=kr(kr({},ze),{appLogin:M?0:1,appkey:ze.appkey,account:ze.account,token:ze.token,deviceId:this.core.config.deviceId,clientType:16,protocolVersion:1,sdkVersion:91001,sdkHumanVersion:"0.13.1",os:jt.os,browser:jt.browser,session:(z=this.core.socket)===null||z===void 0?void 0:z.sessionId,sdkType:mv[Fo.platform]||0,userAgent:"Native/0.13.1"}),hr=jt.os.toLowerCase(),Fo.platform!=="UNIAPP"||hr!=="ios"&&hr!=="android"||(ur.isReactNative=1,ur.clientType=hr==="ios"?2:1,jt.pushDeviceInfo&&jt.pushDeviceInfo.MANUFACTURER&&(ur.deviceInfo=Uo(jt.pushDeviceInfo))),this.logger.log("auth::do login ",ze.account,(pe=this.core.socket)===null||pe===void 0?void 0:pe.sessionId),Vr.next=8,this.core.sendCmd("login",{login:ur});case 8:if(!(br=Vr.sent).error){Vr.next=11;break}throw br.error;case 11:return Cr=br.content,_r=Cr.loginRes,Nr=Cr.loginPorts,Br=Cr.aosPushInfo,Hr=fv(Nr,2),(Hr=ss(Hr).call(Hr,function(bn){return bn.connectionId!==_r.connectionId})).length>0&&this.core.emit("multiPortLogin",Hr),Vr.abrupt("return",kr(kr({},_r),{aosPushInfo:Br}));case 16:case"end":return Vr.stop()}},ae,this)}))},F.kick=function(M){var z;return hn(this,void 0,void 0,rr.mark(function pe(){var ae;return rr.wrap(function(jt){for(;;)switch(jt.prev=jt.next){case 0:return jt.next=2,this.core.sendCmd("kick",M);case 2:return ae=jt.sent,jt.abrupt("return",(z=ae.content)===null||z===void 0?void 0:z.deviceIds);case 4:case"end":return jt.stop()}},pe,this)}))},F.multiPortLoginHandler=function(M){if(M.error)this.logger.error("multiPortLoginHandler:: error, ",M.error);else{var z=M.content,pe=fv(z.loginPorts,z.state);pe.length>0&&this.core.emit("multiPortLogin",pe)}},F.kickedHandler=function(M){if(M.error)this.logger.error("kickedHandler:: error, ",M.error);else{var z=function(ae){var ze=Zs({clientType:{type:"enum",values:Ku},customClientType:{type:"number"}},ae),jt=fS[ze.reason];return kr(ze,jt=jt||{reason:"unknow",message:"Unknown reason"})}(M.content);this.logger.warn("kicked::",z),this.core.doDisconnect(Di.KICKED,z)}},T}(ns);qr({target:"Number",stat:!0},{isNaN:function(T){return T!=T}});var Ed,mS=nr.Number.isNaN,gS=zi({none:0,normal:1,all:3}),hv={normal:0,advanced:1},hS=zi(hv),yS=zi({normal:0,owner:1,manager:2}),Th={noVerify:0,needVerify:1,rejectAll:2},yv=zi(Th),vv={needVerify:0,noVerify:1},bv=zi(vv),Qu={manager:0,all:1},yu=zi(Qu),Sh={manager:0,all:1},Vs=zi(Sh),ja={manager:0,all:1},vS=zi(ja);function Pc(x){var T,F=["teamId"],D=["level","memberNum","memberUpdateTime","createTime","updateTime"],M=["valid","validToCurrentUser","mute"],z={type:hS,muteType:gS,joinMode:yv,beInviteMode:bv,inviteMode:yu,updateTeamMode:Vs,updateExtMode:vS};x.bits;var pe=Is(x,["bits"]);return kn(F).call(F,function(ae){pe[ae]&&(pe[ae]=pe[ae].toString())}),kn(D).call(D,function(ae){pe[ae]!==void 0&&(pe[ae]=go(pe[ae]))}),kn(M).call(M,function(ae){pe[ae]!==void 0&&(pe[ae]=go(pe[ae])===1)}),kn(T=No(z)).call(T,function(ae){pe[ae]!==void 0&&(pe[ae]=z[ae][pe[ae]]||pe[ae])}),pe}function Mh(x){return x&&x.length>0?lo(x).call(x,function(T){return Pc(T)}):[]}function Ch(x){var T,F=kr({},x),D=["avatar","name","intro","announcement","ext"],M={type:hv,joinMode:Th,beInviteMode:vv,inviteMode:Qu,updateTeamMode:Sh,updateExtMode:ja};return kn(D).call(D,function(z){F[z]!==void 0&&(F[z]=F[z].toString())}),kn(T=No(M)).call(T,function(z){F[z]!==void 0&&(F[z]=M[z][F[z]])}),F}function Tv(x){var T=["teamId","ext","account","nickInTeam"],F={};return x.bitConfigMask!==void 0&&(F.bits=go(x.bitConfigMask)),kn(T).call(T,function(D){x[D]&&(F[D]=x[D].toString())}),F}function Pd(x){var T,F=["teamId"],D=["joinTime","updateTime","bitConfigMask"],M=["active","valid","mute"],z={type:yS},pe=x.bits,ae=Is(x,["bits"]);return pe!==void 0&&(ae.muteTeam=go(pe)===1,ae.bitConfigMask=pe),ae.id=ae.teamId+"-"+ae.account,kn(F).call(F,function(ze){ae[ze]&&(ae[ze]=ae[ze].toString())}),kn(D).call(D,function(ze){ae[ze]!==void 0&&(ae[ze]=go(ae[ze]))}),kn(M).call(M,function(ze){ae[ze]!==void 0&&(ae[ze]=go(ae[ze])===1)}),kn(T=No(z)).call(T,function(ze){ae[ze]!==void 0&&(ae[ze]=z[ze][ae[ze]]||ae[ze])}),ae}function Wp(x){return x&&x.length>0?lo(x).call(x,function(T){return Pd(T)}):[]}function Sv(x,T,F){return F===void 0&&(F="normal"),{id:x.teamId+"-"+T,teamId:x.teamId,account:T,type:F,nickInTeam:"",muteTeam:!1,mute:!1,joinTime:x.memberUpdateTime,updateTime:x.memberUpdateTime,active:!0,valid:!0}}function bS(x,T,F){return F===void 0&&(F="normal"),T&&T.length>0?lo(T).call(T,function(D){return Sv(x,D,F)}):[]}function Ju(x){var T=kr({},x);return T.createTime&&(T.createTime=+T.createTime),T.updateTime&&(T.updateTime=+T.updateTime),T.gender&&(T.gender=Ed[+T.gender]),T}(function(x){x[x.unknown=0]="unknown",x[x.male=1]="male",x[x.female=2]="female"})(Ed||(Ed={}));var Mv={"8_1":"createTeam","8_5":"addTeamMembers","8_6":"removeTeamMembers","8_7":"updateTeamInfo","8_8":"leaveTeam","8_9":"getTeamInfo","8_10":"getTeams","8_11":"getTeamMembers","8_12":"dismissTeam","8_13":"applyTeam","8_14":"passTeamApply","8_15":"rejectTeamApply","8_16":"addTeamManagers","8_17":"removeTeamManagers","8_18":"transferTeam","8_19":"updateMyMemberInfo","8_20":"updateNickInTeam","8_21":"acceptTeamInvite","8_22":"rejectTeamInvite","8_25":"muteTeamMember","8_27":"getMutedTeamMembers","8_28":"sendTeamMsgReceipt","8_29":"getTeamMsgReads","8_30":"getTeamMsgReadAccounts","8_31":"notifyTeamMsgReceipts","8_32":"muteTeam","8_33":"getTeamMemberInvitorAccid","8_34":"getTeamsById","8_101":"syncCreateTeam","8_109":"syncTeams","8_119":"syncUpdateTeamMember","8_126":"syncMyTeamMembers"},uc={team:{teamId:1,name:3,type:4,owner:5,level:6,selfCustom:7,valid:8,memberNum:9,memberUpdateTime:10,createTime:11,updateTime:12,validToCurrentUser:13,intro:14,announcement:15,joinMode:16,bits:17,ext:18,serverExt:19,avatar:20,beInviteMode:21,inviteMode:22,updateTeamMode:23,updateExtMode:24,mute:100,muteType:101},teamMsgReceiptTag:{teamId:0,idServer:1,read:100,unread:101,idClient:102,account:103},teamMember:{teamId:1,account:3,type:4,nickInTeam:5,bits:7,active:8,valid:9,joinTime:10,updateTime:11,ext:12,mute:13,invitorAccid:14}},os=ts(uc),Cv={getTeamInfo:{sid:8,cid:9,service:"team",params:[{type:"Long",name:"teamId"}],response:[{type:"Property",name:"team",reflectMapper:os.team}]},getTeams:{sid:8,cid:10,service:"team",params:[{type:"long",name:"timetag"}],response:[{type:"PropertyArray",name:"teams",reflectMapper:os.team},{type:"Number",name:"timetag"}],ignoreErrCodes:[803]},createTeam:{sid:8,cid:1,service:"team",params:[{type:"Property",name:"team",reflectMapper:uc.team},{type:"StrArray",name:"accounts"},{type:"String",name:"ps"}],response:[{type:"Property",name:"team",reflectMapper:os.team},{type:"StrArray",name:"abortedAccidList"}]},sendTeamMsgReceipt:{sid:8,cid:28,service:"team",params:[{type:"PropertyArray",name:"teamMsgReceipts",reflectMapper:uc.teamMsgReceiptTag}],response:[{type:"PropertyArray",name:"teamMsgReceipts",reflectMapper:os.teamMsgReceiptTag}]},getTeamMsgReads:{sid:8,cid:29,service:"team",params:[{type:"PropertyArray",name:"teamMsgReceipts",reflectMapper:uc.teamMsgReceiptTag}],response:[{type:"PropertyArray",name:"teamMsgReceipts",reflectMapper:os.teamMsgReceiptTag}]},getTeamMsgReadAccounts:{sid:8,cid:30,service:"team",params:[{type:"Property",name:"teamMsgReceiptTag",reflectMapper:uc.teamMsgReceiptTag}],response:[{type:"Property",name:"teamMsgReceipt",reflectMapper:os.teamMsgReceiptTag},{type:"StrArray",name:"readAccounts"},{type:"StrArray",name:"unreadAccounts"}]},notifyTeamMsgReceipts:{sid:8,cid:31,service:"team",response:[{type:"PropertyArray",name:"teamMsgReceipts",reflectMapper:os.teamMsgReceiptTag}]},dismissTeam:{sid:8,cid:12,service:"team",params:[{type:"Long",name:"teamId"}]},leaveTeam:{sid:8,cid:8,service:"team",params:[{type:"Long",name:"teamId"}]},transferTeam:{sid:8,cid:18,service:"team",params:[{type:"Long",name:"teamId"},{type:"String",name:"account"},{type:"bool",name:"leave"}]},updateTeamInfo:{sid:8,cid:7,service:"team",params:[{type:"Property",name:"team",reflectMapper:uc.team}],response:[{type:"Number",name:"id"},{type:"Number",name:"time"}]},getTeamsById:{sid:8,cid:34,service:"team",params:[{type:"LongArray",name:"teamIds"}],response:[{type:"PropertyArray",name:"teams",reflectMapper:os.team},{type:"StrArray",name:"tids"}],ignoreErrCodes:[816]},getTeamMembers:{sid:8,cid:11,service:"team",params:[{type:"Long",name:"teamId"},{type:"Long",name:"timetag"}],response:[{type:"String",name:"teamId"},{type:"PropertyArray",name:"teamMembers",reflectMapper:os.teamMember},{type:"Number",name:"timetag"}]},getMutedTeamMembers:{sid:8,cid:27,service:"team",params:[{type:"Long",name:"teamId"}],response:[{type:"String",name:"teamId"},{type:"PropertyArray",name:"teamMembers",reflectMapper:os.teamMember}]},addTeamMembers:{sid:8,cid:5,service:"team",params:[{type:"Long",name:"teamId"},{type:"StrArray",name:"accounts"},{type:"String",name:"ps"},{type:"String",name:"attach"}],response:[{type:"Long",name:"time"},{type:"StrArray",name:"abortedAccidList"}]},removeTeamMembers:{sid:8,cid:6,service:"team",params:[{type:"Long",name:"teamId"},{type:"StrArray",name:"accounts"}]},applyTeam:{sid:8,cid:13,service:"team",params:[{type:"Long",name:"teamId"},{type:"String",name:"ps"}],response:[{type:"Property",name:"team",reflectMapper:os.team}]},addTeamManagers:{sid:8,cid:16,service:"team",params:[{type:"Long",name:"teamId"},{type:"StrArray",name:"accounts"}]},removeTeamManagers:{sid:8,cid:17,service:"team",params:[{type:"Long",name:"teamId"},{type:"StrArray",name:"accounts"}]},updateMyMemberInfo:{sid:8,cid:19,service:"team",params:[{type:"Property",name:"teamMember",reflectMapper:uc.teamMember}]},updateNickInTeam:{sid:8,cid:20,service:"team",params:[{type:"Property",name:"teamMember",reflectMapper:uc.teamMember}]},muteTeamMember:{sid:8,cid:25,service:"team",params:[{type:"Long",name:"teamId"},{type:"String",name:"account"},{type:"Int",name:"mute"}]},getTeamMemberInvitorAccid:{sid:8,cid:33,service:"team",params:[{type:"Long",name:"teamId"},{type:"StrArray",name:"accounts"}],response:[{type:"Object",name:"accountsMap"}]},muteTeam:{sid:8,cid:32,service:"team",params:[{type:"Long",name:"teamId"},{type:"Int",name:"mute"}]},passTeamApply:{sid:8,cid:14,service:"team",params:[{type:"Long",name:"teamId"},{type:"String",name:"from"}]},rejectTeamApply:{sid:8,cid:15,service:"team",params:[{type:"Long",name:"teamId"},{type:"String",name:"from"},{type:"String",name:"ps"}]},acceptTeamInvite:{sid:8,cid:21,service:"team",params:[{type:"Long",name:"teamId"},{type:"String",name:"from"}]},rejectTeamInvite:{sid:8,cid:22,service:"team",params:[{type:"Long",name:"teamId"},{type:"String",name:"from"},{type:"String",name:"ps"}]},syncTeams:{sid:8,cid:109,service:"team",response:[{type:"Number",name:"timetag"},{type:"PropertyArray",name:"teams",reflectMapper:os.team}]},syncCreateTeam:{sid:8,cid:101,service:"team",response:[{type:"Property",name:"team",reflectMapper:os.team}]},syncUpdateTeamMember:{sid:8,cid:119,service:"team",response:[{type:"Property",name:"teamMember",reflectMapper:os.teamMember}]},syncMyTeamMembers:{sid:8,cid:126,ext:"sync",service:"team",response:[{type:"PropertyArray",name:"teamMembers",entity:"teamMember",reflectMapper:os.teamMember},{type:"Number",name:"timetag"}]}},kv={"3_7":"getUsersNameCardFromServer","3_10":"updateMyNameCard","3_109":"syncMyNameCard","3_110":"onUpdateMyNameCard","3_3":"setBlack","3_103":"onUpdateBlackList","3_5":"setMute","3_105":"onUpdateMuteList","3_8":"syncRelations"},lc={user:{account:1,nick:3,avatar:4,signature:5,gender:6,email:7,birth:8,tel:9,ext:10,createTime:12,updateTime:13},relationMember:{account:0,isMuted:1,isBlack:2,createTime:3,updateTime:4}},Yu=ts(lc),TS={syncMyNameCard:{sid:3,cid:109,service:"user",response:[{type:"Property",name:"user",reflectMapper:Yu.user},{type:"Number",name:"timetag"}]},setBlack:{service:"user",sid:3,cid:3,params:[{type:"String",name:"account"},{type:"bool",name:"isAdd"}]},onUpdateBlackList:{service:"user",sid:3,cid:103,response:[{type:"String",name:"account"},{type:"Boolean",name:"isAdd"}]},setMute:{service:"user",sid:3,cid:5,params:[{type:"String",name:"account"},{type:"bool",name:"isAdd"}]},onUpdateMuteList:{service:"user",sid:3,cid:105,response:[{type:"String",name:"account"},{type:"Boolean",name:"isAdd"}]},syncRelations:{service:"user",sid:3,cid:8,params:[{type:"long",name:"timetag"}],response:[{type:"PropertyArray",name:"list",reflectMapper:Yu.relationMember},{type:"Number",name:"timetag"}]},getUsersNameCardFromServer:{service:"user",sid:3,cid:7,params:[{type:"StrArray",name:"accounts"}],response:[{type:"PropertyArray",name:"users",reflectMapper:Yu.user}]},updateMyNameCard:{service:"user",sid:3,cid:10,params:[{type:"Property",name:"user",reflectMapper:lc.user}],response:[{type:"Number",name:"timetag"}]},onUpdateMyNameCard:{service:"user",sid:3,cid:110,response:[{type:"Property",name:"user",reflectMapper:Yu.user}]}},xv={needPush:{type:"boolean",required:!1},needPushBadge:{type:"boolean",required:!1},needPushNick:{type:"boolean",required:!1},pushContent:{type:"string",allowEmpty:!1,required:!1},pushPayload:{type:"string",allowEmpty:!1,required:!1},needForcePush:{type:"boolean",required:!1},forcePushIDsList:{type:"string",allowEmpty:!1,required:!1},forcePushContent:{type:"string",allowEmpty:!1,required:!1}};function SS(x,T){var F,D=li!==void 0&&Sd(x)||x["@@iterator"];if(D)return Mo(F=(D=D.call(x)).next).call(F,D);if(ya(x)||(D=function(pe,ae){var ze;if(pe){if(typeof pe=="string")return wv(pe,ae);var jt=fo(ze=Object.prototype.toString.call(pe)).call(ze,8,-1);if(jt==="Object"&&pe.constructor&&(jt=pe.constructor.name),jt==="Map"||jt==="Set")return Fp(pe);if(jt==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(jt))return wv(pe,ae)}}(x))||T&&x&&typeof x.length=="number"){D&&(x=D);var M=0;return function(){return M>=x.length?{done:!0}:{done:!1,value:x[M++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function wv(x,T){(T==null||T>x.length)&&(T=x.length);for(var F=0,D=new Array(T);F<T;F++)D[F]=x[F];return D}var kh={subType:{type:"string"},setting:{resendFlag:{type:"boolean"},envConfig:{type:"string"},needSaveHistory:{type:"boolean"},needRoaming:{type:"boolean"},needOffline:{type:"boolean"},needSelfSync:{type:"boolean"},needRouted:{type:"boolean"},needUpdateSession:{type:"boolean"},isMuted:{type:"boolean"}},antiSpamInfo:{needAntiSpam:{type:"boolean"},antiSpamContent:{type:"string"},antiSpamBIZID:{type:"string"},clientAntispamHitting:{type:"boolean"},antiSpamUsingYidun:{type:"boolean"},yidunCallbackURL:{type:"string"},yidunAntiCheating:{type:"string"},yidunAntiSpamExtension:{type:"string"},yidunAntiSpamResult:{type:"string"}},pushInfo:xv,teamSpecializationInfo:{needACK:{type:"boolean"},isACKSent:{type:"boolean"},ackSnapshot:{type:"number"}},threadMessageInfo:{replyMsgFromAccount:{type:"string"},replyMsgToAccount:{type:"string"},replyMsgTime:{type:"number"},replyMsgIdServer:{type:"string"},replyMsgIdClient:{type:"string"},threadMsgFromAccount:{type:"string"},threadMsgToAccount:{type:"string"},threadMsgTime:{type:"number"},threadMsgIdServer:{type:"string"},threadMsgIdClient:{type:"string"}}},Ac={0:"addTeamMembers",1:"removeTeamMembers",2:"leaveTeam",3:"updateTeam",4:"dismissTeam",5:"passTeamApply",6:"transferTeam",7:"addTeamManagers",8:"removeTeamManagers",9:"acceptTeamInvite",10:"updateTeamMemberMute",101:"netcallMiss",102:"netcallBill",103:"netcallReject",401:"addSuperTeamMembers",402:"removeSuperTeamMembers",403:"leaveSuperTeam",404:"updateSuperTeam",405:"dismissSuperTeam",406:"transferSuperTeam",407:"addSuperTeamManagers",408:"removeSuperTeamManagers",409:"updateSuperTeamMembersMute",410:"passSuperTeamApply",411:"acceptSuperTeamInvite"};function Sa(x,T){return Bi[x.scene]+"-"+(x.to===T?x.from:x.to)}function Gp(x,T){return x.from===T?x.to===T?"in":"out":"in"}function Ba(x,T){var F=T.account,D=T.featureValue,M=T.statusValue,z=T.sessionAck,pe=T.msgReceiptTime,ae=Bi[x.scene],ze=x.to===F?x.from:x.to,jt=Xs.default,ur=di.unread;go(x.isInBlackList)>0?(ur=di.refused,delete x.isInBlackList):ur=x.from===F?pe&&pe>=+x.time?di.receipt:di.sent:z&&z>=+x.time?di.read:di.unread;var hr=kr(kr({},Zs(kh,x)),{scene:ae,type:cc[x.type],fromClientType:Ku[x.fromClientType],flow:Gp(x,F),target:ze,to:x.to,from:x.from,time:x.time?+x.time:void 0,userUpdateTime:x.userUpdateTime?+x.userUpdateTime:void 0,idClient:x.idClient,sessionId:ae+"-"+ze,status:di[M||ur],feature:Xs[D||jt]});if(typeof hr.attach=="string")try{hr.attach=JSON.parse(hr.attach)}catch{}return hr.type==="notification"&&(hr.attach=hr.attach?function(Cr){var _r,Nr={};if(Nr.type=Ac[Cr.id]||Cr.id,!Cr.data)return Nr;var Br,Hr={ids:"accounts",id:"account",attach:"custom",channel:"channelId",calltype:"netcallType",mute:"mute",duration:"duration",time:"time",from:"from",ext:"ext"},$r=Cr.data;return kn(_r=No(Hr)).call(_r,function(Vr){$r[Vr]!==void 0&&(Nr[Hr[Vr]]=$r[Vr])}),$r.tinfo&&(Nr.team=Pc(Aa($r.tinfo,os.team))),$r.uinfos&&(Nr.users=lo(Br=$r.uinfos).call(Br,function(Vr){return Ju(Aa(Vr,Yu.user))})),$r.mute!==void 0&&(Nr.mute=go($r.mute)===1),Nr}(hr.attach):{}),hr}function Ad(x,T){return x&&x.length>0?Xu(lo(x).call(x,function(F){return Ba(F,T)})):[]}function Xu(x){for(var T,F,D={},M=SS(x);!(F=M()).done;){var z=F.value,pe=D[z.idClient];pe&&pe.time>z.time||(D[z.idClient]=z)}return lo(T=No(D)).call(T,function(ae){return D[ae]})}function vu(x,T){T===void 0&&(T=!0);var F=kr({},x);if(F.pushInfo&&T){for(var D in F.pushInfo)typeof F.pushInfo[D]=="boolean"?F[D]=F.pushInfo[D]?1:0:F[D]=F.pushInfo[D];delete F.pushInfo}return F.scene===Bi.team&&F.needForcePush&&(F.forcePushContent=F.forcePushContent||F.pushContent,F.forcePushIDsList=F.forcePushIDsList?F.forcePushIDsList:"#%@all@%#"),F}function Od(x,T){return lo(x).call(x,function(F){var D;return D=T||(mS(go(F.scene))?F.scene:go(F.scene)===1?"p2p":"team"),{deletedTime:go(F.time),from:F.from,idClient:F.deletedIdClient||F.idClient,idServer:F.deletedIdServer||F.idServer,scene:D,time:go(F.time),to:F.to}})}var xh=Array.prototype.reverse,Vo=function(T){return T==null?T:xh.call(T)},jo=function(){function x(T){this.core=T}return x.prototype.processBroadcastMsg=function(F){var D=lo(F).call(F,function(M){return kr(kr({},M),{time:go(M.time)})});return this.core.sendCmd("batchMarkRead",{sid:7,cid:17,ids:lo(D).call(D,function(M){return M.id})}),D},x}(),wh={needPush:{type:"boolean",required:!1},needPushBadge:{type:"boolean",required:!1},needPushNick:{type:"boolean",required:!1},pushContent:{type:"string",allowEmpty:!1,required:!1},pushPayload:{type:"string",allowEmpty:!1,required:!1}},Iv={pushContent:8,pushPayload:9,needPush:107,needPushBadge:109,needPushNick:110},qi={"4_4":"syncOfflineMsgs","4_9":"syncRoamingMsgs","4_17":"syncRoamingMsgs","4_21":"syncDeleteSelfMsgs","7_1":"sendMsg","8_23":"getHistoryTeamMsgs","21_14":"getHistorySuperTeamMsgs","8_2":"sendTeamMsg","21_2":"sendSuperTeamMsg","7_11":"sendMsgReceipt","7_13":"recallMsg","7_24":"deleteSelfMsgs","21_17":"recallSuperTeamMsg","7_2":"onMsg","8_3":"onMsg","21_3":"onMsg","7_101":"onMsg","8_102":"onMsg","21_102":"onMsg","8_4":"nimOnTeamMsgs","4_16":"syncBroadcastMsg","7_17":"onBroadcastMsg","7_123":"onDeleteSelfMsg","7_124":"onDeleteSelfMsgs"},Ni=kr({scene:0,to:1,from:2,fromClientType:4,fromDeviceId:5,fromNick:6,time:7,type:8,body:9,attach:10,idClient:11,idServer:12,resendFlag:13,userUpdateTime:14,ext:15,needAntiSpam:21,antiSpamContent:22,antiSpamBIZID:23,clientAntispamHitting:24,antiSpamUsingYidun:25,needACK:26,yidunCallbackURL:27,needUpdateSession:28,replyMsgFromAccount:29,replyMsgToAccount:30,replyMsgTime:31,replyMsgIdServer:32,replyMsgIdClient:33,threadMsgFromAccount:34,threadMsgToAccount:35,threadMsgTime:36,threadMsgIdServer:37,threadMsgIdClient:38,isDeleted:39,callbackExt:40,subType:41,yidunAntiCheating:42,envConfig:43,yidunAntiSpamExtension:44,yidunAntiSpamResult:45,needSaveHistory:100,needRoaming:101,needSelfSync:102,isMuted:104,needRouted:105,isInBlackList:106,needOffline:108,isReplyMsg:111,ackSnapshot:112},{pushContent:17,pushPayload:16,forcePushIDsList:18,forcePushContent:19,needForcePush:20,needPush:107,needPushBadge:109,needPushNick:110}),Oc={msg:Ni,recallMsgTag:kr({time:0,type:1,to:2,from:3,ps:4,attach:5,deletedIdClient:10,deletedIdServer:11,opeAccount:16,env:21},Iv),deleteSelfMsgTag:{scene:1,from:2,to:3,idServer:4,idClient:5,time:6,deletedTime:7,ext:8},msgReceiptTag:{to:1,from:2,time:7,idClient:11},broadcastMsg:{id:1,fromAccid:2,time:4,body:5}},is=ts(Oc),MS={sendMsg:{sid:7,cid:1,service:"msg",params:[{type:"Property",name:"msg",reflectMapper:Oc.msg}],response:[{type:"Property",name:"msg",reflectMapper:is.msg}],ignoreErrCodes:[7101]},sendTeamMsg:{sid:8,cid:2,service:"msg",params:[{type:"Property",name:"msg",reflectMapper:Oc.msg}],response:[{type:"Property",name:"msg",reflectMapper:is.msg}]},sendSuperTeamMsg:{sid:21,cid:2,service:"msg",params:[{type:"Property",name:"msg",reflectMapper:Oc.msg}],response:[{type:"Property",name:"msg",reflectMapper:is.msg}]},onMsg:{sid:7,cid:2,service:"msg",response:[{type:"Property",name:"msg",reflectMapper:is.msg}]},nimOnTeamMsgs:{sid:8,cid:4,service:"msg",response:[{type:"PropertyArray",name:"datas",reflectMapper:is.msg}]},getHistoryTeamMsgs:{sid:8,cid:23,service:"msg",params:[{type:"Long",name:"to"},{type:"Long",name:"beginTime"},{type:"Long",name:"endTime"},{type:"Long",name:"lastMsgId"},{type:"int",name:"limit"},{type:"bool",name:"reverse"},{type:"LongArray",name:"msgTypes"}],response:[{type:"PropertyArray",name:"msgs",reflectMapper:is.msg}]},getHistorySuperTeamMsgs:{sid:21,cid:14,params:[{type:"Long",name:"to"},{type:"Long",name:"beginTime"},{type:"Long",name:"endTime"},{type:"Long",name:"lastMsgId"},{type:"int",name:"limit"},{type:"bool",name:"reverse"},{type:"LongArray",name:"msgTypes"}],response:[{type:"PropertyArray",name:"msgs",reflectMapper:is.msg}],service:"msg"},recallMsg:{sid:7,cid:13,service:"msg",params:[{type:"Property",name:"recallMsgTag",reflectMapper:Oc.recallMsgTag}]},deleteSelfMsgs:{sid:7,cid:24,service:"msg",params:[{type:"PropertyArray",name:"deletedMsgs",reflectMapper:Oc.deleteSelfMsgTag}],response:[{type:"Long",name:"timetag"}]},recallSuperTeamMsg:{sid:21,cid:17,service:"msg",params:[{type:"Property",name:"recallMsgTag",reflectMapper:Oc.recallMsgTag}]},sendMsgReceipt:{sid:7,cid:11,service:"msg",params:[{type:"Property",name:"msgReceiptTag",reflectMapper:Oc.msgReceiptTag}],response:[{type:"Property",name:"msgReceiptTag",reflectMapper:is.msgReceiptTag}]},batchMarkRead:{sid:4,cid:5,service:"msg",isNoResponse:!0,params:[{type:"byte",name:"sid"},{type:"byte",name:"cid"},{type:"LongArray",name:"ids"}]},syncMsgReceipts:{sid:4,cid:12,service:"msg",response:[{type:"PropertyArray",name:"msgReceipts",reflectMapper:is.msgReceiptTag},{type:"Number",name:"timetag"}]},syncOfflineMsgs:{sid:4,cid:4,service:"msg",response:[{type:"PropertyArray",name:"msgs",reflectMapper:is.msg}]},syncRoamingMsgs:{sid:4,cid:9,service:"msg",response:[{type:"PropertyArray",name:"msgs",reflectMapper:is.msg}]},syncBroadcastMsg:{sid:4,cid:16,service:"msg",response:[{type:"PropertyArray",name:"msgs",reflectMapper:is.broadcastMsg}]},onBroadcastMsg:{sid:7,cid:17,service:"msg",response:[{type:"Property",name:"msg",reflectMapper:is.broadcastMsg}]},onDeleteSelfMsg:{sid:7,cid:123,service:"msg",response:[{type:"Property",name:"deletedMsg",reflectMapper:is.deleteSelfMsgTag}]},onDeleteSelfMsgs:{sid:7,cid:124,service:"msg",response:[{type:"PropertyArray",name:"deletedMsgs",reflectMapper:is.deleteSelfMsgTag}]},syncDeleteSelfMsgs:{sid:4,cid:21,service:"msg",response:[{type:"PropertyArray",name:"deletedMsgs",reflectMapper:is.deleteSelfMsgTag}]}},_v=function(x){function T(D){var M;return(M=x.call(this,"msg",D)||this).service=new jo(D),Ui({cmdMap:qi,cmdConfig:MS}),M}Co(T,x);var F=T.prototype;return F.sendTextMsg=function(M){return xn({body:{type:"string",allowEmpty:!1}},M),this.sendMsg(kr(kr({},M),{type:"text"}))},F.sendTipMsg=function(M){return xn({body:{type:"string",allowEmpty:!1}},M),this.sendMsg(kr(kr({},M),{type:"tip"}))},F.sendGeoLocationMsg=function(M){return xn({attach:{type:"object",rules:{title:{type:"string",allowEmpty:!1},lat:{type:"number"},lng:{type:"number"}}}},M),this.sendMsg(kr(kr({},M),{type:"geo",attach:Uo(M.attach)}))},F.sendCustomMsg=function(M){return xn({attach:{type:"string",allowEmpty:!1}},M),this.sendMsg(kr(kr({},M),{type:"custom"}))},F.sendMsg=function(M){var z,pe,ae=this;!((z=this.core.sync)===null||z===void 0)&&z.getSyncDoneFlag()||this.logger.warn("Please send message after syncdone event"),xn({scene:{type:"enum",values:ba(Bi)},type:{type:"enum",values:ba(cc)},to:{type:"string",allowEmpty:!1},ext:{type:"string",required:!1},setting:{type:"object",rules:{resendFlag:{type:"boolean",required:!1},needSaveHistory:{type:"boolean",required:!1},needRoaming:{type:"boolean",required:!1},needOffline:{type:"boolean",required:!1},needSelfSync:{type:"boolean",required:!1},needRouted:{type:"boolean",required:!1},needUpdateSession:{type:"boolean",required:!1}},required:!1},antiSpamInfo:{type:"object",required:!1,rules:{clientAntispamHitting:{type:"boolean",required:!1},antiSpamUsingYidun:{type:"boolean",required:!1}}},pushInfo:{type:"object",required:!1,rules:xv},teamSpecializationInfo:{type:"object",required:!1,rules:{needACK:{type:"boolean",required:!1}}}},M);var ze,jt=M.scene==="p2p"?"sendMsg":M.scene==="team"?"sendTeamMsg":"sendSuperTeamMsg",ur=function(Cr,_r,Nr,Br){Cr.onSendBefore,Cr.onUploadStart,Cr.onUploadDone;var Hr=Cr.replyMsg,$r=Is(Cr,["onSendBefore","onUploadStart","onUploadDone","replyMsg"]),Vr=kr(kr({},wd(kh,$r)),{scene:Bi[Cr.scene],type:cc[Cr.type],from:_r,fromClientType:16,fromDeviceId:Nr,fromNick:Br==null?void 0:Br.nick,userUpdateTime:Br==null?void 0:Br.updateTime,status:di[di.sending]});if(Vr.idClient=Vr.resendFlag?Cr.idClient:Ap(),!Vr.idClient)throw new xg("idClient is required to resend a message","idClient","required");return Vr=vu(Vr,!1),Hr&&(Vr.replyMsgFromAccount=Hr.from,Vr.replyMsgToAccount=Hr.to,Vr.replyMsgTime=+Hr.time,Vr.replyMsgIdServer=Hr.idServer,Vr.replyMsgIdClient=Hr.idClient,Vr.threadMsgFromAccount=Hr.from,Vr.threadMsgToAccount=Hr.to,Vr.threadMsgTime=+Hr.time,Vr.threadMsgIdServer=Hr.idServer,Vr.threadMsgIdClient=Hr.idClient,Hr.threadMessageInfo&&Hr.threadMessageInfo.threadMsgIdServer&&(Vr.threadMsgFromAccount=Hr.threadMessageInfo.threadMsgFromAccount,Vr.threadMsgToAccount=Hr.threadMessageInfo.threadMsgToAccount,Vr.threadMsgTime=Hr.threadMessageInfo.threadMsgTime,Vr.threadMsgIdServer=Hr.threadMessageInfo.threadMsgIdServer,Vr.threadMsgIdClient=Hr.threadMessageInfo.threadMsgIdClient)),Vr}(M,this.core.account,this.core.config.deviceId,(pe=this.core.user)===null||pe===void 0?void 0:pe.myInfo),hr=Ba(kr(kr({},ur),{time:new Date().getTime()}),{account:this.core.account,featureValue:Xs.default,statusValue:di.sending});try{M.onSendBefore&&M.onSendBefore(hr)}catch(br){this.logger.error("sendMsg: options.onSendBefore error",br)}return this.core.eventBus.emit("session/updateForNewMsg",hr),this.core.sendCmd(jt,{msg:ur}).then(function(br){var Cr=br.content,_r=br.error;if(ze=Cr.msg,_r)throw _r;var Nr=Ba(kr(kr({},ur),Cr.msg),{account:ae.core.account,featureValue:Xs.default,statusValue:di.sent});return Nr.from===Nr.to&&ae.markMsgsAck([Nr]),ae.core.eventBus.emit("session/updateForNewMsg",Nr),ae.core.reporter.report("msgSend",{msgId:Nr.idServer,clientId:Nr.idClient,msgTime:Nr.time,fromAccid:M.scene==="p2p"?ae.core.account:"",toAccid:Nr.to,type:Bi[Nr.scene],roomId:"",tid:M.scene==="p2p"?"":Nr.to,result:200,faiReason:"",rt:ti()-hr.time}),Nr}).catch(function(br){var Cr=Ba(kr(kr(kr({},ur),{time:new Date().getTime()}),ze),{account:ae.core.account,featureValue:Xs.default,statusValue:br.code===7101?di.refused:di.sendFailed});throw br.msg=Cr,ae.core.eventBus.emit("session/updateForNewMsg",Cr),ae.core.reporter.report("msgSend",{msgId:Cr.idServer,clientId:Cr.idClient,msgTime:Cr.time,fromAccid:M.scene==="p2p"?ae.core.account:"",toAccid:Cr.to,type:Bi[Cr.scene],roomId:"",tid:M.scene==="p2p"?"":Cr.to,result:br==null?void 0:br.code,faiReason:(br==null?void 0:br.message)||"",rt:ti()-hr.time}),br})},F.resendMsg=function(M){return hn(this,void 0,void 0,rr.mark(function z(){var pe,ae;return rr.wrap(function(jt){for(;;)switch(jt.prev=jt.next){case 0:if(xn({msg:{type:"object",rules:{idClient:{type:"string",allowEmpty:!1}}}},M),pe=M.msg,ae=kr(kr({},pe),{attach:pe.attach?Uo(pe.attach):void 0,setting:{resendFlag:!0}}),pe.from===this.core.account){jt.next=5;break}throw new Error("You can only resend messages that you sent: "+pe.idClient);case 5:return jt.abrupt("return",this.sendMsg(ae));case 6:case"end":return jt.stop()}},z,this)}))},F.forwardMsg=function(M){return hn(this,void 0,void 0,rr.mark(function z(){var pe,ae;return rr.wrap(function(jt){for(;;)switch(jt.prev=jt.next){case 0:return xn({msg:{type:"object",rules:{idClient:{type:"string",allowEmpty:!1}}},scene:{type:"enum",values:ba(Bi)},to:{type:"string",allowEmpty:!1}},M),pe=M.msg,ae=kr(kr({},pe),{scene:M.scene,to:M.to,attach:pe.attach?Uo(pe.attach):void 0}),jt.abrupt("return",this.sendMsg(ae));case 4:case"end":return jt.stop()}},z,this)}))},F.sendImageMsg=function(M){return this.doSendFile(kr(kr({},M),{type:"image"}))},F.sendFileMsg=function(M){return this.doSendFile(kr(kr({},M),{type:"file"}))},F.sendAudioMsg=function(M){return this.doSendFile(kr(kr({},M),{type:"audio"}))},F.sendVideoMsg=function(M){return this.doSendFile(kr(kr({},M),{type:"video"}))},F.doSendFile=function(M){return hn(this,void 0,void 0,rr.mark(function z(){var pe,ae;return rr.wrap(function(jt){for(;;)switch(jt.prev=jt.next){case 0:if(xn({scene:{type:"enum",values:ba(Bi)},to:{type:"string",allowEmpty:!1},type:{type:"string",allowEmpty:!1},attach:{type:"object",rules:{url:{type:"string",allowEmpty:!1}},required:!1},maxSize:{type:"number",min:1,required:!1}},M),pe=M.attach){jt.next=28;break}if(this.core.cloudStorage&&this.core.cloudStorage.uploadFile){jt.next=5;break}throw new Error('Service "cloudStorage" does not exist');case 5:return jt.prev=5,this.core.reporter.reportTraceStart("nos",{user_id:this.core.account,action:"upload"}),jt.next=9,this.core.cloudStorage.uploadFile(M);case 9:pe=jt.sent,this.core.reporter.reportTraceEnd("nos",!0),jt.next=20;break;case 13:throw jt.prev=13,jt.t0=jt.catch(5),ae=jt.t0,this.core.reporter.reportTraceUpdateV2("nos",{operation_type:"transfer",description:ae.message,code:ae.code||0,target:"",succeed:!1}),this.core.reporter.reportTraceEnd("nos",!1),this.logger.error("sendFile:: upload File error or abort",jt.t0),jt.t0;case 20:jt.prev=20,M.onUploadDone&&M.onUploadDone(pe),jt.next=28;break;case 24:throw jt.prev=24,jt.t1=jt.catch(20),this.logger.error("sendFile options.onUploadDone err",jt.t1),jt.t1;case 28:return jt.abrupt("return",this.sendMsg(kr(kr({},M),{attach:Uo(pe),type:M.type})));case 29:case"end":return jt.stop()}},z,this,[[5,13],[20,24]])}))},F.recallMsg=function(M){var z;return hn(this,void 0,void 0,rr.mark(function pe(){var ae,ze,jt;return rr.wrap(function(hr){for(;;)switch(hr.prev=hr.next){case 0:return!((z=this.core.sync)===null||z===void 0)&&z.getSyncDoneFlag()||this.logger.warn("Please call recallMsg after syncdone event"),xn({msg:{type:"object",rules:{idClient:{type:"string",allowEmpty:!1},idServer:{type:"string",allowEmpty:!1},scene:{type:"enum",values:ba(Bi)},time:{type:"number"}}},pushInfo:{type:"object",required:!1,rules:wh},ps:{type:"string",allowEmpty:!1,required:!1}},M),ae=M.msg,ze={p2p:"recallMsg",team:"recallMsg",superTeam:"recallSuperTeamMsg"},jt={p2p:7,team:8,superTeam:12},hr.next=7,this.core.sendCmd(ze[ae.scene],{recallMsgTag:vu({time:ae.time,type:jt[ae.scene],to:ae.to,from:ae.from,ps:M.ps,attach:M.attach,deletedIdClient:ae.idClient,deletedIdServer:ae.idServer,opeAccount:ae.from,env:M.env,pushInfo:M.pushInfo})});case 7:return this.core.eventBus.emit("session/updateForDeletedMsg",Od([ae])),hr.abrupt("return",ae);case 9:case"end":return hr.stop()}},pe,this)}))},F.deleteSelfMsgs=function(M){var z;return hn(this,void 0,void 0,rr.mark(function pe(){var ae,ze,jt;return rr.wrap(function(hr){for(;;)switch(hr.prev=hr.next){case 0:return!((z=this.core.sync)===null||z===void 0)&&z.getSyncDoneFlag()||this.logger.warn("Please call deleteSelfMsgs after syncdone event"),xn({msgs:{type:"array",rules:{scene:{type:"enum",values:["p2p","team"]},from:{type:"string",allowEmpty:!1},to:{type:"string",allowEmpty:!1},idServer:{type:"string",allowEmpty:!1},idClient:{type:"string",allowEmpty:!1},time:{type:"number",allowEmpty:!1}}},ext:{type:"string",allowEmpty:!1,required:!1}},M),ae=M.msgs,ze=lo(ae).call(ae,function(br){return{scene:br.scene==="p2p"?1:2,from:br.from,to:br.to,idServer:br.idServer,idClient:br.idClient,time:br.time,ext:M.ext}}),hr.next=6,this.core.sendCmd("deleteSelfMsgs",{deletedMsgs:ze});case 6:return jt=Od(ze),this.core.eventBus.emit("session/updateForDeletedMsg",jt),hr.abrupt("return",jt);case 9:case"end":return hr.stop()}},pe,this)}))},F.sendMsgReceipt=function(M){var z,pe,ae;return hn(this,void 0,void 0,rr.mark(function ze(){var jt,ur,hr,br;return rr.wrap(function(_r){for(;;)switch(_r.prev=_r.next){case 0:if(!((z=this.core.sync)===null||z===void 0)&&z.getSyncDoneFlag()||this.logger.warn("Please call sendMsgReceipt after syncdone event"),xn({msg:{type:"object",rules:{idClient:{type:"string",allowEmpty:!1},target:{type:"string",allowEmpty:!1},time:{type:"number"}}}},M),(jt=M.msg).scene==="p2p"&&jt.flow==="in"){_r.next=6;break}return this.logger.warn("Msg scene: "+jt.scene+", flow: "+jt.flow+" is not allowed to send msg receipt"),_r.abrupt("return",void 0);case 6:return ur={to:jt.target,idClient:jt.idClient,time:jt.time},_r.next=9,this.core.sendCmd("sendMsgReceipt",{msgReceiptTag:ur});case 9:return hr=_r.sent,br=go((ae=(pe=hr.content)===null||pe===void 0?void 0:pe.msgReceiptTag)===null||ae===void 0?void 0:ae.time),_r.abrupt("return",kr(kr({},ur),{time:br?Math.min(br,ur.time):ur.time}));case 12:case"end":return _r.stop()}},ze,this)}))},F.sendTeamMsgReceipt=function(M){var z;return hn(this,void 0,void 0,rr.mark(function pe(){var ae;return rr.wrap(function(jt){for(;;)switch(jt.prev=jt.next){case 0:return!((z=this.core.sync)===null||z===void 0)&&z.getSyncDoneFlag()||this.logger.warn("Please call sendTeamMsgReceipt after syncdone event"),xn({teamMsgReceipts:{type:"array",rules:{teamId:{type:"string",allowEmpty:!1},idClient:{type:"string",allowEmpty:!1},idServer:{type:"string",allowEmpty:!1}},max:50}},M),ae=M.teamMsgReceipts,this.core.sendCmd("sendTeamMsgReceipt",{teamMsgReceipts:ae}),jt.abrupt("return",void 0);case 5:case"end":return jt.stop()}},pe,this)}))},F.getTeamMsgReads=function(M){var z;return hn(this,void 0,void 0,rr.mark(function pe(){var ae,ze,jt;return rr.wrap(function(hr){for(;;)switch(hr.prev=hr.next){case 0:return xn({teamMsgReceipts:{type:"array",rules:{teamId:{type:"string",allowEmpty:!1},idClient:{type:"string",allowEmpty:!1},idServer:{type:"string",allowEmpty:!1}}}},M),ae=M.teamMsgReceipts,hr.next=4,this.core.sendCmd("getTeamMsgReads",{teamMsgReceipts:ae});case 4:return ze=hr.sent,jt=(jt=(z=ze.content)===null||z===void 0?void 0:z.teamMsgReceipts)?lo(jt).call(jt,function(br){return kr(kr({},br),{read:go(br.read),unread:go(br.unread)})}):[],hr.abrupt("return",jt);case 8:case"end":return hr.stop()}},pe,this)}))},F.getTeamMsgReadAccounts=function(M){return hn(this,void 0,void 0,rr.mark(function z(){var pe,ae;return rr.wrap(function(jt){for(;;)switch(jt.prev=jt.next){case 0:return xn({teamMsgReceipt:{type:"object",rules:{teamId:{type:"string",allowEmpty:!1},idClient:{type:"string",allowEmpty:!1},idServer:{type:"string",allowEmpty:!1}}}},M),pe=M.teamMsgReceipt,jt.next=4,this.core.sendCmd("getTeamMsgReadAccounts",{teamMsgReceiptTag:pe});case 4:return ae=jt.sent,jt.abrupt("return",ae.content);case 6:case"end":return jt.stop()}},z,this)}))},F.markMsgsAck=function(M){if(M&&M.length>0){var z=[],pe=[];kn(M).call(M,function(ae){ae.scene==="p2p"&&ae.flow==="in"?z.push(ae):ae.scene==="team"&&ae.flow==="in"&&pe.push(ae)}),z.length>0&&this.core.sendCmd("batchMarkRead",{sid:7,cid:2,ids:lo(z).call(z,function(ae){return ae.idServer})}),pe.length>0&&this.core.sendCmd("batchMarkRead",{sid:8,cid:3,ids:lo(pe).call(pe,function(ae){return ae.idServer})})}},F.onMsgHandler=function(M){var z;if(M.error)this.logger.error("msgHandler::recvError",M.error);else{var pe=typeof Es(M,"raw.r[0]")=="number"?""+M.raw.r[0]:void 0,ae=M.content.msg;ae.idServer=ae.idServer||pe;var ze=ti(),jt=Sa(ae,this.core.account),ur=(z=this.core.session)===null||z===void 0?void 0:z.getSessionWithUncomplete({id:jt}),hr=Ba(ae,ur?{account:this.core.account,sessionAck:ur.ack,msgReceiptTime:ur.msgReceiptTime}:{account:this.core.account});if(this.core.options.debugLevel==="debug"?this.logger.debug("msgHandler::recvMsg",hr.idClient,hr.idServer,hr):this.logger.log("msgHandler::recvMsg",hr.idClient,hr.idServer),this.markMsgsAck([hr]),this.core.eventBus.emit("session/updateForNewMsg",hr),this.core.emit("msg",hr),hr.type==="notification")this.core.eventBus.emit("team/onNotification",hr);else if(hr.flow!=="out"){var br=hr.scene==="p2p",Cr={msgId:hr.idServer,clientId:hr.idClient,receiveTime:M.__receiveTime,serverTime:hr.time,callbackTime:ti(),preHandleTime:ze,fromAccid:hr.from,toAccid:this.core.account,type:Bi[hr.scene],tid:br?"":hr.to,result:200,failReason:"",rt:ti()-hr.time};this.core.reporter.report("msgReceive",Cr,!0)}}},F.nimOnTeamMsgsHandler=function(M){var z,pe=this;kn(z=M.content.datas).call(z,function(ae){pe.onMsgHandler(kr({},M,{content:{msg:ae}}))})},F.syncRoamingMsgsHandler=function(M){var z,pe,ae=M.content.msgs||[];if(ae.length!==0){var ze=Sa(ae[0],this.core.account),jt=(z=this.core.session)===null||z===void 0?void 0:z.getSessionWithUncomplete({id:ze}),ur=(ae=Ad(ae,jt?{account:this.core.account,featureValue:Xs.roam,sessionAck:jt.ack,msgReceiptTime:jt.msgReceiptTime}:{account:this.core.account,featureValue:Xs.roam}))[0].time,hr={timetag:ur,sessionId:ze,msgs:Vo(ae)};!((pe=this.core.sync)===null||pe===void 0)&&pe.getSyncDoneFlag()||this.core.eventBus.emit("session/syncMsgs",hr),this.core.emit("syncRoamingMsgs",hr),this.core.eventBus.emit("sync/updateTimetag",{roamingMsgs:ur})}},F.syncOfflineMsgsHandler=function(M){var z,pe=this,ae=M.content.msgs||[];if(ae.length!==0){var ze={},jt=[];kn(ae).call(ae,function(hr){var br=Sa(hr,pe.core.account),Cr=pe.core.session.getSessionWithUncomplete({id:br}),_r=Ba(hr,Cr?{account:pe.core.account,featureValue:Xs.leave,sessionAck:Cr.ack,msgReceiptTime:Cr.msgReceiptTime}:{account:pe.core.account,featureValue:Xs.leave});jt.push(_r),ze[_r.sessionId]?ze[_r.sessionId].push(_r):ze[_r.sessionId]=[_r]}),this.markMsgsAck(jt);var ur=0;kn(z=No(ze)).call(z,function(hr){var br,Cr=Ec(br=ze[hr]).call(br,function(Nr,Br){return Br.time-Nr.time});(Cr=Xu(Cr))[0].time>ur&&(ur=Cr[0].time);var _r={timetag:Cr[0].time,sessionId:hr,msgs:Cr};pe.core.eventBus.emit("session/syncMsgs",_r),pe.core.emit("syncOfflineMsgs",_r)}),this.core.eventBus.emit("sync/updateTimetag",{offlineMsgs:ur})}},F.syncDeleteSelfMsgsHandler=function(M){var z,pe=(z=M.content)===null||z===void 0?void 0:z.deletedMsgs;pe&&pe.length>0||this.logger.warn("syncDeleteSelfMsgs:: no msgs");var ae=pe[pe.length-1].time;this.core.eventBus.emit("sync/updateTimetag",{deleteSelfMsgs:ae})},F.onDeleteSelfMsgHandler=function(M){var z=Od([M.content.deletedMsg]);this.core.eventBus.emit("session/updateForDeletedMsg",z),this.core.emit("deleteSelfMsgs",z)},F.onDeleteSelfMsgsHandler=function(M){var z=Od(M.content.deletedMsgs);this.core.eventBus.emit("session/updateForDeletedMsg",z),this.core.emit("deleteSelfMsgs",z)},F.onBroadcastMsgHandler=function(M){var z=M.content.msg,pe=this.service.processBroadcastMsg([z]);this.core.emit("broadcastMsgs",pe)},F.syncBroadcastMsgHandler=function(M){var z=M.content.msgs,pe=this.service.processBroadcastMsg(z);this.core.emit("broadcastMsgs",pe)},T}(ns),CS={"5_1":"sync"},kS={sync:{sid:5,cid:1,service:"sync",isNoResponse:!0,params:[{type:"Property",name:"sync",reflectMapper:{myInfo:1,offlineMsgs:2,teams:3,roamingMsgs:7,relations:9,friends:11,friendUsers:13,msgReceipts:14,myTeamMembers:15,donnop:16,recallMsg:17,sessionAck:18,broadcastMsgs:20,signaling:21,superTeams:22,mySuperTeamMembers:23,superTeamRoamingMsgs:24,deleteSuperTeamMsg:25,superTeamSessionAck:26,deleteSelfMsgs:27,stickTopSessions:28,sessionHistoryMsgsDelete:29}}],response:[{type:"Number",name:"timetag"}]}},Kp=function(x){function T(D,M){var z;return M===void 0&&(M={}),(z=x.call(this,"sync",D)||this).options=M,z.syncDoneFlag=!1,z.options=kr({myInfo:!!D.user.name,offlineMsgs:!!D.msg.name,teams:!!D.team.name,myTeamMembers:!!D.team.name,roamingMsgs:!!D.msg.name,relations:!!D.user.name,friends:!!D.friend.name,friendUsers:!!D.user.name,msgReceipts:!!D.msg.name,recallMsg:!!D.msg.name,sessionAck:!!D.session.name,superTeamSessionAck:!!D.session.name,superTeams:!!D.superTeam.name,mySuperTeamMembers:!!D.superTeam.name,superTeamRoamingMsgs:!!D.superTeam.name,deleteSuperTeamMsg:!!D.superTeam.name,deleteSelfMsgs:!!D.msg.name,sessionHistoryMsgsDelete:!!D.msgLog.name,signaling:!!D.signaling.name},M),z.timetags={},z.pArray=[],z.initEventListeners(),Ui({cmdMap:CS,cmdConfig:kS}),z}Co(T,x);var F=T.prototype;return F.getSyncDoneFlag=function(){return this.syncDoneFlag},F.doSync=function(){return hn(this,void 0,void 0,rr.mark(function M(){var z;return rr.wrap(function(ae){for(;;)switch(ae.prev=ae.next){case 0:return z=this.genSyncParams(),this.logger.log("doSync: ",z),ae.next=4,this.core.sendCmd("sync",{sync:z});case 4:case"end":return ae.stop()}},M,this)}))},F.initEventListeners=function(){var M=this;this.core.eventBus.on("sync/updateTimetag",function(z){var pe;kn(pe=No(z)).call(pe,function(ae){z[ae]>(M.timetags[ae]||0)&&(M.timetags[ae]=z[ae])})}),this.core.eventBus.on("logined",function(){M.syncDoneFlag=!1})},F.genSyncParams=function(){var M,z,pe=this;return lp(M=ss(z=No(this.options)).call(z,function(ae){var ze=ae;return pe.options[ze]})).call(M,function(ae,ze){var jt=ze;return ae[jt]=pe.timetags[jt]||0,ae},{})},F.handleImmediate=function(M){var z;this.core.session&&this.core.session.onSyncDone&&this.core.session.onSyncDone(),this.logger.log("sync: emit syncdone",(z=M.content)===null||z===void 0?void 0:z.timetag),this.syncDoneFlag=!0,this.core.emit("syncdone")},F.syncHandler=function(M){var z=this;(function(){return typeof tt<"u"&&tt.getSystemInfo?"TT":typeof swan<"u"&&swan.getSystemInfo?"BAIDU":typeof my<"u"&&my.getSystemInfo?"ALI":typeof wx<"u"&&wx.getSystemInfo?"WX":"unknow environment"})()==="ALI"?(this.logger.log("sync: emit ALIAPP sycnHandler, handle later"),co(function(){z.handleImmediate(M)},100)):this.handleImmediate(M)},T}(ns),pi={"6_26":"getNosCdnHost"},Ev={getNosCdnHost:{sid:6,cid:26,service:"misc",response:[{type:"Property",name:"nosConfigTag",reflectMapper:ts({nosConfigTag:{bucket:1,cdnDomain:2,expire:3,objectNamePrefix:4}}).nosConfigTag}]}},xS=function(x){function T(F){var D;return(D=x.call(this,"misc",F)||this).core=F,D.nosCdnHostTimer=0,Ui({cmdMap:pi,cmdConfig:Ev}),D}return Co(T,x),T}(ns),Zu=function(T,F,D){F=="__proto__"&&vd?vd(T,F,{configurable:!0,enumerable:!0,value:D,writable:!0}):T[F]=D},Pv=Object.prototype.hasOwnProperty,Qp=function(T,F,D){var M=T[F];Pv.call(T,F)&&sc(M,D)&&(D!==void 0||F in T)||Zu(T,F,D)},Ih=function(T,F,D,M){if(!ga(T))return T;for(var z=-1,pe=(F=Cd(F,T)).length,ae=pe-1,ze=T;ze!=null&&++z<pe;){var jt=mu(F[z]),ur=D;if(jt==="__proto__"||jt==="constructor"||jt==="prototype")return T;if(z!=ae){var hr=ze[jt];(ur=M?M(hr,jt,ze):void 0)===void 0&&(ur=ga(hr)?hr:Vp(F[z+1])?[]:{})}Qp(ze,jt,ur),ze=ze[jt]}return T},Av=function(T,F,D){for(var M=-1,z=F.length,pe={};++M<z;){var ae=F[M],ze=Xg(T,ae);D(ze,ae)&&Ih(pe,Cd(ae,T),ze)}return pe},wS=function(T,F){return T!=null&&F in Object(T)},IS=function(T,F,D){for(var M=-1,z=(F=Cd(F,T)).length,pe=!1;++M<z;){var ae=mu(F[M]);if(!(pe=T!=null&&D(T,ae)))break;T=T[ae]}return pe||++M!=z?pe:!!(z=T==null?0:T.length)&&Dg(z)&&Vp(ae,z)&&(Ta(T)||Id(T))},Rd=function(T,F){return T!=null&&IS(T,F,wS)},_h=function(T,F){return Av(T,F,function(D,M){return Rd(T,M)})},el=function(T,F){for(var D=-1,M=F.length,z=T.length;++D<M;)T[z+D]=F[D];return T},dc=Qs?Qs.isConcatSpreadable:void 0,_S=function(T){return Ta(T)||Id(T)||!!(dc&&T&&T[dc])},Rc=function x(T,F,D,M,z){var pe=-1,ae=T.length;for(D||(D=_S),z||(z=[]);++pe<ae;){var ze=T[pe];F>0&&D(ze)?F>1?x(ze,F-1,D,M,z):el(z,ze):M||(z[z.length]=ze)}return z},ES=function(T){return T!=null&&T.length?Rc(T,1):[]},Nd=function(T){return Ny(Mp(T,void 0,ES),T+"")}(function(x,T){return x==null?{}:_h(x,T)}),Ov=function(x){function T(D){var M;return(M=x.call(this,"user",D)||this).myInfo=Ju({}),Ui({cmdMap:kv,cmdConfig:TS}),M}Co(T,x);var F=T.prototype;return F.setBlack=function(M){return xn({account:{type:"string",allowEmpty:!1},isAdd:{type:"boolean"}},M),this.core.sendCmd("setBlack",M).then(function(){})},F.setMute=function(M){return xn({account:{type:"string",allowEmpty:!1},isAdd:{type:"boolean"}},M),this.core.sendCmd("setMute",M).then(function(){})},F.getRelations=function(){return this.core.sendCmd("syncRelations",{timetag:0})},F.getBlackList=function(){return hn(this,void 0,void 0,rr.mark(function M(){var z;return rr.wrap(function(ae){for(;;)switch(ae.prev=ae.next){case 0:return ae.next=2,this.core.sendCmd("syncRelations",{timetag:0});case 2:return z=ae.sent,ae.abrupt("return",z.blackList||[]);case 4:case"end":return ae.stop()}},M,this)}))},F.getMuteList=function(){return hn(this,void 0,void 0,rr.mark(function M(){var z;return rr.wrap(function(ae){for(;;)switch(ae.prev=ae.next){case 0:return ae.next=2,this.core.sendCmd("syncRelations",{timetag:0});case 2:return z=ae.sent,ae.abrupt("return",z.muteList||[]);case 4:case"end":return ae.stop()}},M,this)}))},F.updatePushToken=function(){return hn(this,void 0,void 0,rr.mark(function M(){return rr.wrap(function(pe){for(;;)switch(pe.prev=pe.next){case 0:this.logger.error("This function is deprecated, please use nim.offlinePush.setOfflinePushConfig instead");case 1:case"end":return pe.stop()}},M,this)}))},F.updateAppBackground=function(){return hn(this,void 0,void 0,rr.mark(function M(){return rr.wrap(function(pe){for(;;)switch(pe.prev=pe.next){case 0:this.logger.error("This function is deprecated, please use nim.offlinePush.setOfflinePushConfig instead");case 1:case"end":return pe.stop()}},M,this)}))},F.getUsersNameCardFromServer=function(M){var z=this;return xn({accounts:{type:"array",max:150,itemType:"string"}},M),this.core.sendCmd("getUsersNameCardFromServer",Nd(M,["accounts"])).then(function(pe){var ae,ze=pe.content;return z.logger.log("user:: getUsers done",M.accounts),ze&&ze.users?lo(ae=ze.users).call(ae,function(jt){return Ju(jt)}):[]})},F.updateMyNameCard=function(M){var z=this;if(xn({nick:{type:"string",required:!1},avatar:{type:"string",required:!1},signature:{type:"string",required:!1},gender:{type:"enum",values:ba(Ed),required:!1},email:{type:"string",required:!1},birth:{type:"string",required:!1},tel:{type:"string",required:!1},ext:{type:"string",required:!1}},M),No(M).length===0)return ro.resolve(this.myInfo);var pe=Nd(M,["nick","avatar","signature","email","birth","tel","ext"]);return M.gender&&(pe.gender=Ed[M.gender]),this.core.sendCmd("updateMyNameCard",{user:pe}).then(function(ae){var ze=ae.content;return ze&&ze.timetag&&z.core.eventBus.emit("sync/updateTimetag",{myInfo:+ze.timetag}),M.gender&&(pe.gender=M.gender),z.myInfo=kr({},z.myInfo,pe),z.myInfo})},F.onUpdateBlackListHandler=function(M){var z=M.content;z.account?this.core.emit("updateBlackList",z):this.logger.warn("onUpdateBlackListHandler: no account")},F.onUpdateMuteListHandler=function(M){var z=M.content;z.account?this.core.emit("updateMuteList",z):this.logger.warn("onUpdateBlackListHandler: no account")},F.syncRelationsHandler=function(M){var z=M.content,pe=z.list,ae=z.timetag,ze={blackList:[],muteList:[]};return ae&&this.core.eventBus.emit("sync/updateTimetag",{relations:ae}),pe&&pe.length&&kn(pe).call(pe,function(jt){var ur=function(br){var Cr={account:br.account,updateTime:+br.updateTime,createTime:+br.createTime};return br.isMuted==="1"&&(Cr.isMuted=!0),br.isBlack==="1"&&(Cr.isBlack=!0),Cr}(jt);ur.isBlack&&ze.blackList.push(ur),ur.isMuted&&ze.muteList.push(ur)}),this.core.emit("relations",ze),ro.resolve(ze)},F.syncMyNameCardHandler=function(M){M.content.user&&(this.myInfo=Ju(M.content.user),this.core.emit("syncMyNameCard",this.myInfo),this.core.eventBus.emit("sync/updateTimetag",{myInfo:M.content.timetag}))},F.onUpdateMyNameCardHandler=function(M){var z=M.content.user;z?(kr(this.myInfo,Ju(z)),this.core.emit("updateMyNameCard",this.myInfo)):this.logger.warn("onUpdateMyNameCardHandler no user info")},T}(ns),Jp=function(){this.__data__=new hp,this.size=0},ni=function(T){var F=this.__data__,D=F.delete(T);return this.size=F.size,D},ea=function(T){return this.__data__.get(T)},bu=function(T){return this.__data__.has(T)},PS=function(T,F){var D=this.__data__;if(D instanceof hp){var M=D.__data__;if(!yd||M.length<199)return M.push([T,F]),this.size=++D.size,this;D=this.__data__=new bp(M)}return D.set(T,F),this.size=D.size,this};function Tu(x){var T=this.__data__=new hp(x);this.size=T.size}Tu.prototype.clear=Jp,Tu.prototype.delete=ni,Tu.prototype.get=ea,Tu.prototype.has=bu,Tu.prototype.set=PS;var Fd=Tu,AS=function(T,F){for(var D=-1,M=T==null?0:T.length;++D<M;)if(F(T[D],D,T))return!0;return!1},Rv=function(T,F,D,M,z,pe){var ae=1&D,ze=T.length,jt=F.length;if(ze!=jt&&!(ae&&jt>ze))return!1;var ur=pe.get(T),hr=pe.get(F);if(ur&&hr)return ur==F&&hr==T;var br=-1,Cr=!0,_r=2&D?new Fg:void 0;for(pe.set(T,F),pe.set(F,T);++br<ze;){var Nr=T[br],Br=F[br];if(M)var Hr=ae?M(Br,Nr,br,F,T,pe):M(Nr,Br,br,T,F,pe);if(Hr!==void 0){if(Hr)continue;Cr=!1;break}if(_r){if(!AS(F,function($r,Vr){if(!Sp(_r,Vr)&&(Nr===$r||z(Nr,$r,D,M,pe)))return _r.push(Vr)})){Cr=!1;break}}else if(Nr!==Br&&!z(Nr,Br,D,M,pe)){Cr=!1;break}}return pe.delete(T),pe.delete(F),Cr},Yp=_s.Uint8Array,OS=function(T){var F=-1,D=Array(T.size);return T.forEach(function(M,z){D[++F]=[z,M]}),D},Nv=Qs?Qs.prototype:void 0,jd=Nv?Nv.valueOf:void 0,Bd=function(T,F,D,M,z,pe,ae){switch(D){case"[object DataView]":if(T.byteLength!=F.byteLength||T.byteOffset!=F.byteOffset)return!1;T=T.buffer,F=F.buffer;case"[object ArrayBuffer]":return!(T.byteLength!=F.byteLength||!pe(new Yp(T),new Yp(F)));case"[object Boolean]":case"[object Date]":case"[object Number]":return sc(+T,+F);case"[object Error]":return T.name==F.name&&T.message==F.message;case"[object RegExp]":case"[object String]":return T==F+"";case"[object Map]":var ze=OS;case"[object Set]":var jt=1&M;if(ze||(ze=zr),T.size!=F.size&&!jt)return!1;var ur=ae.get(T);if(ur)return ur==F;M|=2,ae.set(T,F);var hr=Rv(ze(T),ze(F),M,z,pe,ae);return ae.delete(T),hr;case"[object Symbol]":if(jd)return jd.call(T)==jd.call(F)}return!1},Ld=function(T,F,D){var M=F(T);return Ta(T)?M:el(M,D(T))},Eh=function(T,F){for(var D=-1,M=T==null?0:T.length,z=0,pe=[];++D<M;){var ae=T[D];F(ae,D,T)&&(pe[z++]=ae)}return pe},Ud=function(){return[]},Dd=Object.prototype.propertyIsEnumerable,Ph=Object.getOwnPropertySymbols,RS=Ph?function(x){return x==null?[]:(x=Object(x),Eh(Ph(x),function(T){return Dd.call(x,T)}))}:Ud,qd=RS,Xp=function(T){return Ld(T,_d,qd)},NS=Object.prototype.hasOwnProperty,Fv=function(T,F,D,M,z,pe){var ae=1&D,ze=Xp(T),jt=ze.length;if(jt!=Xp(F).length&&!ae)return!1;for(var ur=jt;ur--;){var hr=ze[ur];if(!(ae?hr in F:NS.call(F,hr)))return!1}var br=pe.get(T),Cr=pe.get(F);if(br&&Cr)return br==F&&Cr==T;var _r=!0;pe.set(T,F),pe.set(F,T);for(var Nr=ae;++ur<jt;){var Br=T[hr=ze[ur]],Hr=F[hr];if(M)var $r=ae?M(Hr,Br,hr,F,T,pe):M(Br,Hr,hr,T,F,pe);if(!($r===void 0?Br===Hr||z(Br,Hr,D,M,pe):$r)){_r=!1;break}Nr||(Nr=hr=="constructor")}if(_r&&!Nr){var Vr=T.constructor,bn=F.constructor;Vr==bn||!("constructor"in T)||!("constructor"in F)||typeof Vr=="function"&&Vr instanceof Vr&&typeof bn=="function"&&bn instanceof bn||(_r=!1)}return pe.delete(T),pe.delete(F),_r},Ah=du(_s,"DataView"),Zp=du(_s,"Promise"),Oh=du(_s,"WeakMap"),Rh="[object Map]",tl="[object Promise]",$d="[object Set]",Su="[object WeakMap]",Mu="[object DataView]",FS=wc(Ah),jv=wc(yd),jS=wc(Zp),BS=wc(Vu),Nc=wc(Oh),Ma=Sc;(Ah&&Ma(new Ah(new ArrayBuffer(1)))!=Mu||yd&&Ma(new yd)!=Rh||Zp&&Ma(Zp.resolve())!=tl||Vu&&Ma(new Vu)!=$d||Oh&&Ma(new Oh)!=Su)&&(Ma=function(x){var T=Sc(x),F=T=="[object Object]"?x.constructor:void 0,D=F?wc(F):"";if(D)switch(D){case FS:return Mu;case jv:return Rh;case jS:return tl;case BS:return $d;case Nc:return Su}return T});var us=Ma,zs="[object Arguments]",ef="[object Array]",rl="[object Object]",Bv=Object.prototype.hasOwnProperty,Cu=function(T,F,D,M,z,pe){var ae=Ta(T),ze=Ta(F),jt=ae?ef:us(T),ur=ze?ef:us(F),hr=(jt=jt==zs?rl:jt)==rl,br=(ur=ur==zs?rl:ur)==rl,Cr=jt==ur;if(Cr&&Hp(T)){if(!Hp(F))return!1;ae=!0,hr=!1}if(Cr&&!hr)return pe||(pe=new Fd),ae||hh(T)?Rv(T,F,D,M,z,pe):Bd(T,F,jt,D,M,z,pe);if(!(1&D)){var _r=hr&&Bv.call(T,"__wrapped__"),Nr=br&&Bv.call(F,"__wrapped__");if(_r||Nr){var Br=_r?T.value():T,Hr=Nr?F.value():F;return pe||(pe=new Fd),z(Br,Hr,D,M,pe)}}return!!Cr&&(pe||(pe=new Fd),Fv(T,F,D,M,z,pe))},Lv=function x(T,F,D,M,z){return T===F||(T==null||F==null||!va(T)&&!va(F)?T!=T&&F!=F:Cu(T,F,D,M,x,z))},LS=function(T,F,D,M){var z=D.length,pe=z,ae=!M;if(T==null)return!pe;for(T=Object(T);z--;){var ze=D[z];if(ae&&ze[2]?ze[1]!==T[ze[0]]:!(ze[0]in T))return!1}for(;++z<pe;){var jt=(ze=D[z])[0],ur=T[jt],hr=ze[1];if(ae&&ze[2]){if(ur===void 0&&!(jt in T))return!1}else{var br=new Fd;if(M)var Cr=M(ur,hr,jt,T,F,br);if(!(Cr===void 0?Lv(hr,ur,3,M,br):Cr))return!1}}return!0},Uv=function(T){return T==T&&!ga(T)},tf=function(T){for(var F=_d(T),D=F.length;D--;){var M=F[D],z=T[M];F[D]=[M,z,Uv(z)]}return F},Hd=function(T,F){return function(D){return D!=null&&D[T]===F&&(F!==void 0||T in Object(D))}},Ca=function(T){var F=tf(T);return F.length==1&&F[0][2]?Hd(F[0][0],F[0][1]):function(D){return D===T||LS(D,T,F)}},Vd=function(T,F){return Qg(T)&&Uv(F)?Hd(mu(T),F):function(D){var M=Es(D,T);return M===void 0&&M===F?Rd(D,T):Lv(F,M,3)}},Fc=function(T){return function(F){return F==null?void 0:F[T]}},zo=function(T){return function(F){return Xg(F,T)}},pc=function(T){return Qg(T)?Fc(mu(T)):zo(T)},nl=function(T){return typeof T=="function"?T:T==null?Hu:typeof T=="object"?Ta(T)?Vd(T[0],T[1]):Ca(T):pc(T)},Nh=/\s/,US=function(T){for(var F=T.length;F--&&Nh.test(T.charAt(F)););return F},DS=/^\s+/,qS=function(T){return T&&T.slice(0,US(T)+1).replace(DS,"")},$S=/^[-+]0x[0-9a-f]+$/i,HS=/^0b[01]+$/i,VS=/^0o[0-7]+$/i,zS=parseInt,WS=function(T){if(typeof T=="number")return T;if(jp(T))return NaN;if(ga(T)){var F=typeof T.valueOf=="function"?T.valueOf():T;T=ga(F)?F+"":F}if(typeof T!="string")return T===0?T:+T;T=qS(T);var D=HS.test(T);return D||VS.test(T)?zS(T.slice(2),D?2:8):$S.test(T)?NaN:+T},Fh=1/0,GS=function(T){return T?(T=WS(T))===Fh||T===-1/0?17976931348623157e292*(T<0?-1:1):T==T?T:0:T===0?T:0},Dv=function(T){var F=GS(T),D=F%1;return F==F?D?F-D:F:0},KS=Math.max,jh=function(T,F,D){var M=T==null?0:T.length;if(!M)return-1;var z=D==null?0:Dv(D);return z<0&&(z=KS(M+z,0)),_y(T,nl(F),z)},QS={"4_12":"syncMsgReceipts","4_14":"syncSessionAck","4_20":"syncSuperTeamSessionAck","4_22":"nimSyncSessionsWithMoreRoaming","4_25":"syncSessionReliableInfo","7_12":"multiSyncMsgReceipt","7_16":"markSessionAck","7_25":"markMultSessionsAck","7_116":"syncMarkSessionAck","21_25":"markSuperTeamSessionAck","21_32":"markMultSuperTeamSessionsAck","21_125":"syncMarkSuperTeamSessionAck","4_23":"nimSyncStickTopSessions","23_12":"nimAddStickTopSession","23_13":"nimDeleteStickTopSession","23_14":"nimUpdateStickTopSession","23_112":"nimMultiSyncAddStickTopSession","23_113":"nimMultiSyncDeleteStickTopSession","23_114":"nimMultiSyncUpdateStickTopSession"},ol={msgReceiptTag:{to:1,from:2,time:7,idClient:11},stickTopSessionTag:{id:1,ext:2,createTime:3,updateTime:4},sessionAckTag:{scene:1,to:2,timetag:3},sessionReliableSyncTag:{scene:1,sessionId:2,syncStatus:3,syncEndMsgId:4,syncEndMsgidClient:5,syncEndMsgTime:6,syncStartMsgid:7,syncStartMsgidClient:8,syncStartMsgTime:9,nextMsgid:10,nextMsgidClient:11,nextMsgTime:12,roamMsgSync:13,offlineMsgSync:14,netCallOfflineMsgSync:15}},fc=ts(ol),JS={syncMsgReceipts:{sid:4,cid:12,service:"session",response:[{type:"PropertyArray",name:"msgReceipts",reflectMapper:fc.msgReceiptTag},{type:"Number",name:"timetag"}]},syncSessionAck:{sid:4,cid:14,service:"session",response:[{type:"StrLongMap",name:"p2p"},{type:"LongLongMap",name:"team"},{type:"Number",name:"timetag"}]},syncSuperTeamSessionAck:{sid:4,cid:20,service:"session",response:[{type:"LongLongMap",name:"superTeam"},{type:"Number",name:"timetag"}]},multiSyncMsgReceipt:{sid:7,cid:12,service:"session",response:[{type:"Property",name:"msgReceiptTag",reflectMapper:fc.msgReceiptTag}]},markSessionAck:{sid:7,cid:16,service:"session",params:[{type:"byte",name:"scene"},{type:"String",name:"to"},{type:"long",name:"timetag"}]},syncMarkSessionAck:{sid:7,cid:116,service:"session",response:[{type:"byte",name:"scene"},{type:"String",name:"to"},{type:"long",name:"timetag"}]},syncMarkSuperTeamSessionAck:{sid:21,cid:125,service:"session",response:[{type:"String",name:"to"},{type:"long",name:"timetag"}]},markMultSessionsAck:{sid:7,cid:25,service:"session",ignoreErrCodes:[700],params:[{type:"PropertyArray",name:"datas",reflectMapper:ol.sessionAckTag}]},markSuperTeamSessionAck:{sid:21,cid:25,service:"session",params:[{type:"long",name:"to"},{type:"long",name:"timetag"}]},nimAddStickTopSession:{sid:23,cid:12,service:"session",params:[{type:"Property",name:"tag",reflectMapper:ol.stickTopSessionTag}],response:[{type:"Property",name:"data",reflectMapper:fc.stickTopSessionTag}]},nimDeleteStickTopSession:{sid:23,cid:13,service:"session",params:[{type:"Property",name:"tag",reflectMapper:ol.stickTopSessionTag}],response:[{type:"Number",name:"timetag"}]},nimUpdateStickTopSession:{sid:23,cid:14,service:"session",params:[{type:"Property",name:"tag",reflectMapper:ol.stickTopSessionTag}],response:[{type:"Property",name:"data",reflectMapper:fc.stickTopSessionTag}]},nimMultiSyncAddStickTopSession:{sid:23,cid:112,service:"session",response:[{type:"Property",name:"data",reflectMapper:fc.stickTopSessionTag}]},nimMultiSyncDeleteStickTopSession:{sid:23,cid:113,service:"session",response:[{type:"Number",name:"timetag"},{type:"Property",name:"data",reflectMapper:fc.stickTopSessionTag}]},nimMultiSyncUpdateStickTopSession:{sid:23,cid:114,service:"session",response:[{type:"Property",name:"data",reflectMapper:fc.stickTopSessionTag}]},nimSyncStickTopSessions:{sid:4,cid:23,service:"session",response:[{type:"Number",name:"timetag"},{type:"Boolean",name:"isThereAnyChange"},{type:"PropertyArray",name:"datas",reflectMapper:fc.stickTopSessionTag}]},markMultSuperTeamSessionsAck:{sid:21,cid:32,service:"session",ignoreErrCodes:[700],params:[{type:"PropertyArray",name:"datas",reflectMapper:ol.sessionAckTag}]},nimSyncSessionsWithMoreRoaming:{sid:21,cid:22,service:"session",response:[{type:"PropertyArray",name:"datas",reflectMapper:{0:"scene",1:"to",2:"from",7:"time",12:"idServer"}}]},syncSessionReliableInfo:{sid:4,cid:25,service:"session",response:[{type:"Property",name:"context",reflectMapper:{1:"timetag",2:"type"}},{type:"PropertyArray",name:"datas",reflectMapper:fc.sessionReliableSyncTag}]}},YS={id:{type:"string"},ext:{type:"string"},createTime:{type:"number"},updateTime:{type:"number"}};function rf(x,T,F){F===void 0&&(F=!0);var D=Zs(YS,x);return D.isStickOnTop=F,D.id=T.id,kr(kr({},T),{stickTopInfo:T.stickTopInfo?kr({},T.stickTopInfo,D):D})}var XS={scene:{type:"enum",values:Bi},time:{type:"number"}},zd=function(){function x(F){this.core=F}var T=x.prototype;return T.getSession=function(D){return this.core.session.getSessionWithUncomplete({id:D})||this.core.session.createSession(D)},T.addStickTopSession=function(D){return hn(this,void 0,void 0,rr.mark(function M(){var z,pe,ae,ze,jt,ur;return rr.wrap(function(br){for(;;)switch(br.prev=br.next){case 0:return xn({id:{type:"string",allowEmpty:!1},ext:{type:"string",required:!1}},D),z=wo(D.id),pe=z.scene,ae=z.accid,br.next=4,this.core.sendCmd("nimAddStickTopSession",{tag:{id:(pe==="superTeam"?"super_team":pe)+"|"+ae,ext:D.ext}});case 4:return ze=br.sent,jt=this.getSession(D.id),ur=rf(ze.content.data,jt),br.abrupt("return",ur);case 8:case"end":return br.stop()}},M,this)}))},T.deleteStickTopSession=function(D){return hn(this,void 0,void 0,rr.mark(function M(){var z,pe,ae,ze,jt,ur;return rr.wrap(function(br){for(;;)switch(br.prev=br.next){case 0:return xn({id:{type:"string",allowEmpty:!1}},D),z=wo(D.id),pe=z.scene,ae=z.accid,br.next=4,this.core.sendCmd("nimDeleteStickTopSession",{tag:{id:(pe==="superTeam"?"super_team":pe)+"|"+ae}});case 4:return ze=br.sent,jt=this.getSession(D.id),ur=rf({updateTime:ze.content.timetag},jt,!1),br.abrupt("return",ur);case 8:case"end":return br.stop()}},M,this)}))},T.updateStickTopSession=function(D){return hn(this,void 0,void 0,rr.mark(function M(){var z,pe,ae,ze,jt,ur;return rr.wrap(function(br){for(;;)switch(br.prev=br.next){case 0:return xn({id:{type:"string",allowEmpty:!1},ext:{type:"string",required:!1}},D),z=wo(D.id),pe=z.scene,ae=z.accid,br.next=4,this.core.sendCmd("nimUpdateStickTopSession",{tag:{id:(pe==="superTeam"?"super_team":pe)+"|"+ae,ext:D.ext}});case 4:return ze=br.sent,jt=this.getSession(D.id),ur=rf(ze.content.data,jt),br.abrupt("return",ur);case 8:case"end":return br.stop()}},M,this)}))},T.stickTopSessionHandler=function(D,M){M===void 0&&(M=!0);var z=wo(D.id,"|"),pe=z.scene+"-"+z.accid;return rf(D,this.getSession(pe),M)},x}(),il=function(){function x(F){this.core=F,this.logger=F.logger}var T=x.prototype;return T.canSessionResetUnreadCount=function(D){var M=D.id;if(D.lastMsg===void 0)throw new Error("Session::canSessionResetUnreadCount: session "+M+" is not completly, lastMsg undefined");return D.lastMsg!==null||D.unread>0?!(D.ack&&D.lastMsg&&D.ack>=D.lastMsg.time)||(this.logger.log("Session::canSessionResetUnreadCount: session "+M+" reset failed, ack time is greater than last message time"),!1):(this.logger.log("Session::canSessionResetUnreadCount: session "+M+" doesn't need to be updated, lastMsg null and unread 0"),!1)},T.filterSessionForResetUnreadCount=function(D){var M=this,z={cmd:"markMultSuperTeamSessionsAck",params:[]},pe={cmd:"markMultSessionsAck",params:[]};return kn(D).call(D,function(ae){var ze;try{if(!M.canSessionResetUnreadCount(ae))return;var jt=wo(ae.id),ur=jt.accid,hr=jt.scene,br={to:ur,sessionId:ae.id,timetag:((ze=ae==null?void 0:ae.lastMsg)===null||ze===void 0?void 0:ze.time)||ae.updateTime||0},Cr=function(Nr){return wd({scene:{type:"enum",values:Bi}},Nr)}({scene:hr});hr==="superTeam"?z.params.push(br):pe.params.push(kr(kr({},br),Cr))}catch(_r){M.logger.warn(_r)}}),{superTeam:z,p2pOrTeam:pe}},x}(),Bh=function(T,F,D){var M=-1,z=T.length;F<0&&(F=-F>z?0:z+F),(D=D>z?z:D)<0&&(D+=z),z=F>D?0:D-F>>>0,F>>>=0;for(var pe=Array(z);++M<z;)pe[M]=T[M+F];return pe},ZS=function(T,F,D){if(!ga(D))return!1;var M=typeof F;return!!(M=="number"?kp(D)&&Vp(F,D.length):M=="string"&&F in D)&&sc(D[F],T)},eM=Math.ceil,tM=Math.max,qv=function(T,F,D){F=(D?ZS(T,F,D):F===void 0)?1:tM(Dv(F),0);var M=T==null?0:T.length;if(!M||F<1)return[];for(var z=0,pe=0,ae=Array(eM(M/F));z<M;)ae[pe++]=Bh(T,z,z+=F);return ae};function $i(x,T){var F,D=li!==void 0&&Sd(x)||x["@@iterator"];if(D)return Mo(F=(D=D.call(x)).next).call(F,D);if(ya(x)||(D=function(pe,ae){var ze;if(pe){if(typeof pe=="string")return oi(pe,ae);var jt=fo(ze=Object.prototype.toString.call(pe)).call(ze,8,-1);if(jt==="Object"&&pe.constructor&&(jt=pe.constructor.name),jt==="Map"||jt==="Set")return Fp(pe);if(jt==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(jt))return oi(pe,ae)}}(x))||T&&x&&typeof x.length=="number"){D&&(x=D);var M=0;return function(){return M>=x.length?{done:!0}:{done:!1,value:x[M++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function oi(x,T){(T==null||T>x.length)&&(T=x.length);for(var F=0,D=new Array(T);F<T;F++)D[F]=x[F];return D}var rM=function(x){function T(D,M){var z;return(z=x.call(this,"session",D)||this).list=new nc,z.unreadCountFilterFn=function(pe){return!0},z.lastMessageFilterFn=function(pe){return!0},z.initEventListeners(),Ui({cmdMap:QS,cmdConfig:JS}),typeof(M==null?void 0:M.unreadCountFilterFn)=="function"&&(z.unreadCountFilterFn=M.unreadCountFilterFn),typeof(M==null?void 0:M.lastMessageFilterFn)=="function"&&(z.lastMessageFilterFn=M.lastMessageFilterFn),z.stickTopService=new zd(D),z.unreadModule=new il(D),z}Co(T,x);var F=T.prototype;return F.initEventListeners=function(){var M,z,pe,ae=this;this.core.eventBus.on("session/syncMsgs",Mo(M=this.onSyncMsgs).call(M,this)),this.core.eventBus.on("session/updateForNewMsg",Mo(z=this.updateSessionWithMsg).call(z,this)),this.core.eventBus.on("session/updateForClearMsg",function(ze,jt){jt===void 0&&(jt=!0),ze&&ze.length>0&&kn(ze).call(ze,function(ur){ae.updateSession({id:ur.sessionId,lastMsg:null,unread:0,unreadMsgs:[]},jt)})}),this.core.eventBus.on("session/updateForDeletedMsg",Mo(pe=this.updateSessionForDeletedMsg).call(pe,this))},F.createSession=function(M,z){try{var pe=wo(M);return{id:M,scene:pe.scene,to:pe.accid,lastMsg:z,updateTime:z?z.time:0,unread:0,unreadMsgs:[],ack:0}}catch(ae){throw this.logger.error("Failed to create session with "+M,ae),new Error("Failed to create session with "+M)}},F.getSession=function(M){xn({id:{type:"string",allowEmpty:!1}},M);var z=this.list.get(M.id);if(this.isSessionComplete(z))return z},F.getSessionWithUncomplete=function(M){return this.list.get(M.id)},F.getAllSessions=function(){for(var M,z=[],pe=$i(this.list);!(M=pe()).done;){var ae=M.value;ae[0];var ze=ae[1];this.isSessionComplete(ze)&&z.push(ze)}return z},F.getSessions=function(M){xn({limit:{type:"number",required:!1},lastSessionId:{type:"string",allowEmpty:!1,required:!1},desc:{type:"boolean",required:!1}},M);var z=[],pe=M.limit,ae=pe===void 0?100:pe,ze=M.desc,jt=ze===void 0||ze,ur=M.lastSessionId,hr=0;if(jt){for(var br,Cr,_r=$i(this.list);!(Cr=_r()).done;){var Nr=Cr.value,Br=Nr[0],Hr=Nr[1];if(ur===Br)break;this.isSessionComplete(Hr)&&z.push(Hr)}return Eu(br=fo(z).call(z,-ae)).call(br)}for(var $r,Vr=$i(this.list);!($r=Vr()).done;){var bn=$r.value,Wn=bn[0],qn=bn[1];if(ur)Wn===ur&&(ur=void 0);else if(this.isSessionComplete(qn)){if(++hr>ae)break;z.push(qn)}}return z},F.resetSessionUnreadCount=function(M){var z,pe;return hn(this,void 0,void 0,rr.mark(function ae(){var ze,jt,ur,hr,br,Cr,_r,Nr,Br=this;return rr.wrap(function($r){for(;;)switch($r.prev=$r.next){case 0:if(!((z=this.core.sync)===null||z===void 0)&&z.getSyncDoneFlag()||this.logger.warn("Please call resetSessionUnreadCount after syncdone event"),xn({id:{type:"string",allowEmpty:!1}},M),xn({id:{type:"string",allowEmpty:!1}},M),ze=M.id,jt=this.list.get(ze)){$r.next=8;break}throw this.logger.warn("resetSessionUnreadCount: can not find session "+ze),new Error("Session::canSessionResetUnreadCount: can not find session "+ze);case 8:ur=!1;try{ur=this.unreadModule.canSessionResetUnreadCount(jt)}catch(Vr){this.logger.warn(Vr)}if(ur!==!1){$r.next=12;break}return $r.abrupt("return");case 12:return hr=wo(ze),br=hr.accid,Cr=hr.scene,_r={to:br,timetag:((pe=jt==null?void 0:jt.lastMsg)===null||pe===void 0?void 0:pe.time)||jt.updateTime||0},Nr="markSuperTeamSessionAck",Cr!=="superTeam"&&(_r.scene=Cr==="p2p"?0:1,Nr="markSessionAck"),$r.abrupt("return",this.core.sendCmd(Nr,_r).then(function(){var Vr=Br.storeUnreadByAck(ze,_r.timetag);Vr&&Br.core.emit("updateSession",Vr)}));case 17:case"end":return $r.stop()}},ae,this)}))},F.resetMultiSessionUnreadCount=function(M){var z;return hn(this,void 0,void 0,rr.mark(function pe(){var ae,ze,jt,ur,hr,br,Cr,_r,Nr,Br,Hr,$r,Vr,bn,Wn=this;return rr.wrap(function(yo){for(;;)switch(yo.prev=yo.next){case 0:!((z=this.core.sync)===null||z===void 0)&&z.getSyncDoneFlag()||this.logger.warn("Please call resetMultiSessionUnreadCount after syncdone event"),xn({ids:{type:"array",itemType:"string",min:1}},M),jt=ss(ae=lo(ze=M.ids).call(ze,function(Fn){return Wn.list.get(Fn)})).call(ae,function(Fn,xr){return!!Fn||(Wn.logger.warn("Session::canSessionResetUnreadCount: can not find session "+M.ids[xr]),!1)}),ur=this.unreadModule.filterSessionForResetUnreadCount(jt),hr=ur.superTeam,br=ur.p2pOrTeam,Cr=qv(hr.params,10),_r=qv(br.params,10),Nr=$i(Cr);case 7:if((Br=Nr()).done){yo.next=14;break}return Hr=Br.value,yo.next=11,this.core.sendCmd(hr.cmd,{datas:Hr});case 11:kn(Hr).call(Hr,function(Fn){var xr=Wn.storeUnreadByAck(Fn.sessionId,Fn.timetag);xr&&Wn.core.emit("updateSession",xr)});case 12:yo.next=7;break;case 14:$r=$i(_r);case 15:if((Vr=$r()).done){yo.next=22;break}return bn=Vr.value,yo.next=19,this.core.sendCmd(br.cmd,{datas:bn});case 19:kn(bn).call(bn,function(Fn){var xr=Wn.storeUnreadByAck(Fn.sessionId,Fn.timetag);xr&&Wn.core.emit("updateSession",xr)});case 20:yo.next=15;break;case 22:case"end":return yo.stop()}},pe,this)}))},F.resetAllSessionsUnreadCount=function(){var M,z;!((z=this.core.sync)===null||z===void 0)&&z.getSyncDoneFlag()||this.logger.warn("Please call resetAllSessionsUnreadCount after syncdone event");var pe=[];return kn(M=this.list).call(M,function(ae){pe.push(ae.id)}),this.resetMultiSessionUnreadCount({ids:pe})},F.deleteSession=function(M){return hn(this,void 0,void 0,rr.mark(function z(){return rr.wrap(function(ae){for(;;)switch(ae.prev=ae.next){case 0:if(xn({id:{type:"string",allowEmpty:!1},isSyncToServer:{type:"boolean",required:!1}},M),this.list.delete(M.id),!this.core.msgLog||!M.isSyncToServer){ae.next=5;break}return ae.next=5,this.core.msgLog.deleteRoamingMsgs({ids:[M.id]});case 5:case"end":return ae.stop()}},z,this)}))},F.deleteAllSessionsFromLocal=function(){this.list.clear()},F.addStickTopSession=function(M){return hn(this,void 0,void 0,rr.mark(function z(){var pe;return rr.wrap(function(ze){for(;;)switch(ze.prev=ze.next){case 0:return ze.next=2,this.stickTopService.addStickTopSession(M);case 2:return pe=ze.sent,this.list.set(pe.id,pe),ze.abrupt("return",pe);case 5:case"end":return ze.stop()}},z,this)}))},F.deleteStickTopSession=function(M){return hn(this,void 0,void 0,rr.mark(function z(){var pe;return rr.wrap(function(ze){for(;;)switch(ze.prev=ze.next){case 0:return ze.next=2,this.stickTopService.deleteStickTopSession(M);case 2:return pe=ze.sent,this.list.set(pe.id,pe),ze.abrupt("return",pe);case 5:case"end":return ze.stop()}},z,this)}))},F.updateStickTopSession=function(M){return hn(this,void 0,void 0,rr.mark(function z(){var pe;return rr.wrap(function(ze){for(;;)switch(ze.prev=ze.next){case 0:return ze.next=2,this.stickTopService.updateStickTopSession(M);case 2:return pe=ze.sent,this.list.set(pe.id,pe),ze.abrupt("return",pe);case 5:case"end":return ze.stop()}},z,this)}))},F.nimMultiSyncAddStickTopSessionHandler=function(M){var z=this.stickTopService.stickTopSessionHandler(M.content.data);this.list.set(z.id,z),this.core.emit("updateSession",z)},F.nimMultiSyncDeleteStickTopSessionHandler=function(M){var z=this.stickTopService.stickTopSessionHandler({id:M.content.data.id,updateTime:M.content.timetag},!1);this.list.set(z.id,z),this.core.emit("updateSession",z)},F.nimMultiSyncUpdateStickTopSessionHandler=function(M){var z=this.stickTopService.stickTopSessionHandler(M.content.data);this.list.set(z.id,z),this.core.emit("updateSession",z)},F.nimSyncStickTopSessionsHandler=function(M){var z=this,pe=M.content.datas;kn(pe).call(pe,function(ae){var ze=z.stickTopService.stickTopSessionHandler(ae);z.list.set(ze.id,ze)})},F.updateSessionWithMsg=function(M){var z=!0,pe=!0;try{z=!!this.unreadCountFilterFn(M)}catch(ur){this.logger.error("session:updateSessionWithMsg, unreadCountFilterFn error",ur)}try{pe=!!this.lastMessageFilterFn(M)}catch(ur){this.logger.error("session:updateSessionWithMsg, lastMessageFilterFn error",ur)}var ae=this.list.get(M.sessionId)||this.createSession(M.sessionId),ze=!1;if(this.logger.log("session:updateSessionWithMsg, pending ",M.sessionId,M.idClient,M.idServer,pe,z),pe&&(!ae.lastMsg||ae.lastMsg.time<M.time||M.status===di[di.sending]||ae.lastMsg.status===di[di.sending])&&(ae.lastMsg=M,ae.updateTime=M.time,ze=!0),z&&M.status===di[di.unread]&&M.time>(ae.ack||0)){ae.unread++;var jt=ae.unreadMsgs||[];jt.unshift(M),Ec(jt).call(jt,function(ur,hr){return hr.time-ur.time}),ze=!0}ze&&(this.logger.log("session:updateSessionWithMsg updating ",ae.id,ae.unread,ae.lastMsg&&ae.lastMsg.idClient),this.list.set(ae.id,ae),this.core.emit("updateSession",ae))},F.storeUnreadByAck=function(M,z){var pe=this.list.get(M)||this.createSession(M);if(!(pe.ack&&z<pe.ack)){var ae=pe.unreadMsgs||[],ze=[],jt=0;return pe.unreadMsgs=[],ae.length>0&&(kn(ae).call(ae,function(ur){ur.time>z&&(jt++,ze.push(ur))}),pe.unreadMsgs=Ec(ze).call(ze,function(ur,hr){return hr.time-ur.time})),pe.ack=z,pe.unread=jt,pe.lastMsg&&pe.lastMsg.status==="unread"&&z>=pe.lastMsg.time&&(pe.lastMsg.status="read"),this.list.set(M,pe),pe}this.logger.warn("storeUnreadByAck: not need update ack",M,z,pe.ack)},F.updateSession=function(M,z){z===void 0&&(z=!0);var pe=M.id,ae=this.list.get(pe)||this.createSession(M.id),ze=kr(ae,M);return this.list.set(pe,ze),this.logger.log("updateSession: update",z,Nd(M,["id","ack","unread"]),ze.lastMsg&&ze.lastMsg.idClient),z&&this.core.emit("updateSession",ze),ze},F.isSessionComplete=function(M){return!!M&&!!(M.id&&M.scene&&M.to)&&M.lastMsg!==void 0},F.syncSessionAckHandler=function(M){var z,pe,ae=this,ze=M.content.p2p||{},jt=M.content.team.m_map||{};this.logger.log("syncSessionAck::",ze,jt),kn(z=No(ze)).call(z,function(ur){ae.updateSession({id:"p2p-"+ur,ack:ze[ur]},!1)}),kn(pe=No(jt)).call(pe,function(ur){ae.updateSession({id:"team-"+ur,ack:jt[ur]},!1)})},F.syncSuperTeamSessionAckHandler=function(M){var z,pe=this,ae=M.content.superTeam.m_map;this.logger.log("syncSuperTeamSessionAck::",ae),kn(z=No(ae)).call(z,function(ze){pe.updateSession({id:"superTeam-"+ze,ack:ae[ze]},!1)})},F.syncMarkSessionAckHandler=function(M){var z=M.content,pe=(z.scene===0?"p2p":z.scene===1?"team":"superTeam")+"-"+z.to,ae=this.list.get(pe);if(ae&&ae.ack&&z.timetag<ae.ack)this.logger.warn("syncMarkSessionAckHandler: "+pe+" do not need update ack",ae.ack,z.timetag);else{var ze=this.storeUnreadByAck(pe,z.timetag);ze&&this.core.emit("updateSession",ze)}},F.syncMarkSuperTeamSessionAckHandler=function(M){M.content.scene=5,this.syncMarkSessionAckHandler(M)},F.onSyncDone=function(){var M,z,pe,ae=this,ze=[];kn(M=this.list).call(M,function(jt,ur){ze.push(ae.storeUnreadByAck(ur,jt.ack||0))}),this.list.clear(),kn(z=Ec(ze).call(ze,function(jt,ur){return jt.updateTime-ur.updateTime})).call(z,function(jt){ae.list.set(jt.id,jt)}),(ze=Ec(pe=ss(ze).call(ze,function(jt){return ae.isSessionComplete(jt)})).call(pe,function(jt,ur){return ur.updateTime-jt.updateTime})).length>0&&this.core.emit("sessions",ze)},F.onSyncMsgs=function(M){var z,pe=this,ae=this.list.get(M.sessionId),ze=[];try{var jt;ze=ss(jt=M.msgs).call(jt,function(_r){return pe.unreadCountFilterFn(JSON.parse(Uo(_r)))})}catch(_r){this.logger.error("session:onSyncMsgs, unreadCountFilterFn error ",_r)}var ur,hr=[];try{var br;hr=ss(br=M.msgs).call(br,function(_r){return pe.lastMessageFilterFn(JSON.parse(Uo(_r)))})}catch(_r){this.logger.error("session:onSyncMsgs, lastMessageFilterFn error ",_r)}hr&&hr.length>0&&(ur=hr[hr.length-1],ur=hr[0].time>ur.time?hr[0]:ur);var Cr=ur?ur.time:0;ae||(ae=ur?this.createSession(M.sessionId,ur):this.createSession(M.sessionId)),ae.unreadMsgs=ae.unreadMsgs?ss(z=Ss(ze).call(ze,ae.unreadMsgs)).call(z,function(_r){return _r.status===di[di.unread]}):ss(ze).call(ze,function(_r){return _r.status===di[di.unread]}),ae.updateTime&&ae.updateTime>=Cr||(ae.updateTime=Cr),ae.lastMsg&&ae.lastMsg.time>=Cr||(ae.lastMsg=ur),this.list.set(ae.id,ae)},F.updateSessionForDeletedMsg=function(M){var z,pe=this,ae={};kn(M).call(M,function(ze){var jt=ze.to===pe.core.account?ze.from:ze.to,ur=ze.scene+"-"+jt,hr=pe.list.get(ur);if(hr){if((hr.ack||0)<ze.time&&ze.from!==pe.core.account&&hr.unread>0&&(hr.unread=hr.unread-1,hr.unreadMsgs&&hr.unreadMsgs.length>0)){var br,Cr=jh(hr.unreadMsgs,{idClient:ze.idClient});Cr>=0&&Gg(br=hr.unreadMsgs).call(br,Cr,1)}hr.lastMsg&&hr.lastMsg.idClient===ze.idClient&&(hr.lastMsg=null),ae[hr.id]=!0}}),kn(z=No(ae)).call(z,function(ze){var jt=pe.list.get(ze);jt&&pe.core.emit("updateSession",jt)})},F.multiSyncMsgReceiptHandler=function(M){var z,pe=(z=M.content)===null||z===void 0?void 0:z.msgReceiptTag;if(pe){this.updateSessionMsgReceiptTime([pe],!0),pe.msgReceiptTime=pe.time,pe.sessionId="p2p-"+pe.from,pe.time,pe.from;var ae=Is(pe,["time","from"]);this.core.emit("msgReceipts",[ae])}},F.syncMsgReceiptsHandler=function(M){var z,pe=(z=M.content)===null||z===void 0?void 0:z.msgReceipts;pe&&this.updateSessionMsgReceiptTime(pe,!1)},F.updateSessionMsgReceiptTime=function(M,z){var pe=this;z===void 0&&(z=!0),M&&M.length>0&&kn(M).call(M,function(ae){var ze=pe.list.get("p2p-"+ae.from);ze||(ze=pe.createSession("p2p-"+ae.from));var jt=go(ae.time);ze.msgReceiptTime&&ze.msgReceiptTime>=jt||(ze.msgReceiptTime=jt,ze.lastMsg&&ze.lastMsg.status==="sent"&&jt>=ze.lastMsg.time&&(ze.lastMsg.status="receipt"),pe.logger.log("session: update session "+ze.id+" msgReceiptTime: "+ze.msgReceiptTime),pe.list.set(ze.id,ze),z&&pe.core.emit("updateSession",ze))})},F.nimSyncSessionsWithMoreRoamingHandler=function(M){var z=function(ae,ze){return lo(ae).call(ae,function(jt){var ur=Zs(XS,jt);return ur.sessionId=Sa(jt,ze),ur})}(M.content.datas,this.core.account);this.logger.log("session:syncSessionsWithMoreRoaming",z)},T}(ns),nM=function(){function x(F){this.core=F}var T=x.prototype;return T.notifyAddTeamMembers=function(D,M){this.core.emit("addTeamMembers",{team:D,accounts:M,members:bS(D,M)})},T.notifyUpdateTeamManagers=function(D,M,z,pe){this.core.emit("updateTeamManagers",{team:{teamId:D,memberUpdateTime:pe},accounts:M,isManager:z,members:lo(M).call(M,function(ae){return{id:D+"-"+ae,account:ae,type:"manager",updateTime:pe}})})},T.notifyRemoveTeamMembers=function(D,M){this.core.emit("removeTeamMembers",{team:D,accounts:M})},T.notifyTransferTeam=function(D,M,z){this.core.emit("transferTeam",{team:D,from:{id:D.teamId+"-"+M,type:"normal",account:M,updateTime:D.memberUpdateTime},to:{id:D.teamId+"-"+z,type:"owner",account:z,updateTime:D.memberUpdateTime}})},T.notifyUpdateTeamMembersMute=function(D,M,z){this.core.emit("updateTeamMembersMute",{team:D,accounts:M,members:lo(M).call(M,function(pe){return{id:D.teamId+"-"+pe,account:pe,teamId:D.teamId,mute:z,updateTime:D.memberUpdateTime}}),mute:z})},x}(),oM=function(T,F){for(var D=-1,M=T==null?0:T.length;++D<M&&F(T[D],D,T)!==!1;);return T},nf=function(T,F,D,M){var z=!D;D||(D={});for(var pe=-1,ae=F.length;++pe<ae;){var ze=F[pe],jt=M?M(D[ze],T[ze],ze,D,T):void 0;jt===void 0&&(jt=T[ze]),z?Zu(D,ze,jt):Qp(D,ze,jt)}return D},iM=function(T,F){return T&&nf(F,_d(F),T)},mc=function(T){var F=[];if(T!=null)for(var D in Object(T))F.push(D);return F},Ps=Object.prototype.hasOwnProperty,of=function(T){if(!ga(T))return mc(T);var F=hu(T),D=[];for(var M in T)(M!="constructor"||!F&&Ps.call(T,M))&&D.push(M);return D},Lh=function(T){return kp(T)?dv(T,!0):of(T)},ls=function(T,F){return T&&nf(F,Lh(F),T)},ci=s(function(x,T){var F=T&&!T.nodeType&&T,D=F&&x&&!x.nodeType&&x,M=D&&D.exports===F?_s.Buffer:void 0,z=M?M.allocUnsafe:void 0;x.exports=function(ae,ze){if(ze)return ae.slice();var jt=ae.length,ur=z?z(jt):new ae.constructor(jt);return ae.copy(ur),ur}}),sM=function(T,F){var D=-1,M=T.length;for(F||(F=Array(M));++D<M;)F[D]=T[D];return F},$v=function(T,F){return nf(T,qd(T),F)},sf=Object.getOwnPropertySymbols?function(x){for(var T=[];x;)el(T,qd(x)),x=lh(x);return T}:Ud,Uh=function(T,F){return nf(T,sf(T),F)},Hv=function(T){return Ld(T,Lh,sf)},Vv=Object.prototype.hasOwnProperty,Wd=function(T){var F=T.length,D=new T.constructor(F);return F&&typeof T[0]=="string"&&Vv.call(T,"index")&&(D.index=T.index,D.input=T.input),D},af=function(T){var F=new T.constructor(T.byteLength);return new Yp(F).set(new Yp(T)),F},Dh=function(T,F){var D=F?af(T.buffer):T.buffer;return new T.constructor(D,T.byteOffset,T.byteLength)},zv=/\w*$/,Ms=function(T){var F=new T.constructor(T.source,zv.exec(T));return F.lastIndex=T.lastIndex,F},Wv=Qs?Qs.prototype:void 0,qh=Wv?Wv.valueOf:void 0,aM=function(T){return qh?Object(qh.call(T)):{}},cM=function(T,F){var D=F?af(T.buffer):T.buffer;return new T.constructor(D,T.byteOffset,T.length)},uM=function(T,F,D){var M=T.constructor;switch(F){case"[object ArrayBuffer]":return af(T);case"[object Boolean]":case"[object Date]":return new M(+T);case"[object DataView]":return Dh(T,D);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return cM(T,D);case"[object Map]":case"[object Set]":return new M;case"[object Number]":case"[object String]":return new M(T);case"[object RegExp]":return Ms(T);case"[object Symbol]":return aM(T)}},Gv=Object.create,lM=function(){function x(){}return function(T){if(!ga(T))return{};if(Gv)return Gv(T);x.prototype=T;var F=new x;return x.prototype=void 0,F}}(),dM=function(T){return typeof T.constructor!="function"||hu(T)?{}:lM(lh(T))},pM=function(T){return va(T)&&us(T)=="[object Map]"},$h=as&&as.isMap,fM=$h?ju($h):pM,mM=function(T){return va(T)&&us(T)=="[object Set]"},Kv=as&&as.isSet,Hh=Kv?ju(Kv):mM,Qv="[object Arguments]",Vh="[object Function]",Cs="[object Object]",fi={};fi[Qv]=fi["[object Array]"]=fi["[object ArrayBuffer]"]=fi["[object DataView]"]=fi["[object Boolean]"]=fi["[object Date]"]=fi["[object Float32Array]"]=fi["[object Float64Array]"]=fi["[object Int8Array]"]=fi["[object Int16Array]"]=fi["[object Int32Array]"]=fi["[object Map]"]=fi["[object Number]"]=fi[Cs]=fi["[object RegExp]"]=fi["[object Set]"]=fi["[object String]"]=fi["[object Symbol]"]=fi["[object Uint8Array]"]=fi["[object Uint8ClampedArray]"]=fi["[object Uint16Array]"]=fi["[object Uint32Array]"]=!0,fi["[object Error]"]=fi[Vh]=fi["[object WeakMap]"]=!1;var gM=function x(T,F,D,M,z,pe){var ae,ze=1&F,jt=2&F,ur=4&F;if(D&&(ae=z?D(T,M,z,pe):D(T)),ae!==void 0)return ae;if(!ga(T))return T;var hr=Ta(T);if(hr){if(ae=Wd(T),!ze)return sM(T,ae)}else{var br=us(T),Cr=br==Vh||br=="[object GeneratorFunction]";if(Hp(T))return ci(T,ze);if(br==Cs||br==Qv||Cr&&!z){if(ae=jt||Cr?{}:dM(T),!ze)return jt?Uh(T,ls(ae,T)):$v(T,iM(ae,T))}else{if(!fi[br])return z?T:{};ae=uM(T,br,ze)}}pe||(pe=new Fd);var _r=pe.get(T);if(_r)return _r;pe.set(T,ae),Hh(T)?T.forEach(function(Br){ae.add(x(Br,F,D,Br,T,pe))}):fM(T)&&T.forEach(function(Br,Hr){ae.set(Hr,x(Br,F,D,Hr,T,pe))});var Nr=hr?void 0:(ur?jt?Hv:Xp:jt?Lh:_d)(T);return oM(Nr||T,function(Br,Hr){Nr&&(Br=T[Hr=Br]),Qp(ae,Hr,x(Br,F,D,Hr,T,pe))}),ae},jc,gc,hc=function(T){return gM(T,5)},hM=function(x){function T(D){var M;return(M=x.call(this,"team",D)||this).myTeamMembersMap=new nc,M.service=new nM(D),M.core.eventBus.on("team/onNotification",function(z){return M.notificationHandler(z)}),Ui({cmdMap:Mv,cmdConfig:Cv}),M}Co(T,x);var F=T.prototype;return F.mergeMyTeamMembers=function(M){var z=this;kn(M).call(M,function(pe){var ae=pe.teamId,ze=z.myTeamMembersMap.get(ae),jt=kr({},ze,pe);z.myTeamMembersMap.set(ae,jt)})},F.getTeamInfo=function(M){return hn(this,void 0,void 0,rr.mark(function z(){var pe,ae;return rr.wrap(function(jt){for(;;)switch(jt.prev=jt.next){case 0:return xn({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1}},M),jt.next=3,this.core.sendCmd("getTeamInfo",{teamId:M.teamId});case 3:return pe=jt.sent,ae=pe.content.team,jt.abrupt("return",Pc(ae));case 6:case"end":return jt.stop()}},z,this)}))},F.getTeams=function(){return hn(this,void 0,void 0,rr.mark(function M(){var z,pe;return rr.wrap(function(ze){for(;;)switch(ze.prev=ze.next){case 0:return ze.next=2,this.core.sendCmd("getTeams",{timetag:0});case 2:return z=ze.sent,pe=z.content.teams,ze.abrupt("return",Mh(pe));case 5:case"end":return ze.stop()}},M,this)}))},F.getTeamsById=function(M){return hn(this,void 0,void 0,rr.mark(function z(){var pe,ae;return rr.wrap(function(jt){for(;;)switch(jt.prev=jt.next){case 0:return xn({teamIds:{type:"array",itemType:"string"}},M),jt.next=3,this.core.sendCmd("getTeamsById",{teamIds:M.teamIds});case 3:return pe=jt.sent,ae=Mh(pe.content.teams),jt.abrupt("return",{teams:ae,tids:pe.content.tids});case 6:case"end":return jt.stop()}},z,this)}))},F.createTeam=function(M){return hn(this,void 0,void 0,rr.mark(function z(){var pe,ae,ze;return rr.wrap(function(ur){for(;;)switch(ur.prev=ur.next){case 0:return xn({type:{type:"enum",values:["advanced","normal"]},name:{type:"string",allowEmpty:!1},level:{type:"number",required:!1},accounts:{type:"array",itemType:"string",required:!1},ps:{type:"string",allowEmpty:!1,max:5e3,required:!1},joinMode:{type:"enum",values:["noVerify","needVerify","rejectAll"],required:!1},beInviteMode:{type:"enum",values:["noVerify","needVerify"],required:!1},inviteMode:{type:"enum",values:["manager","all"],required:!1},updateTeamMode:{type:"enum",values:["manager","all"],required:!1},updateExtMode:{type:"enum",values:["manager","all"],required:!1},intro:{type:"string",allowEmpty:!1,required:!1},announcement:{type:"string",allowEmpty:!1,required:!1},avatar:{type:"string",allowEmpty:!1,required:!1},ext:{type:"string",allowEmpty:!1,required:!1}},M),pe=Ch(M),ur.next=4,this.core.sendCmd("createTeam",{team:pe,accounts:M.accounts||[],ps:M.ps||""});case 4:return ae=ur.sent,ze=Pc(ae.content.team),ur.abrupt("return",ze);case 7:case"end":return ur.stop()}},z,this)}))},F.dismissTeam=function(M){return hn(this,void 0,void 0,rr.mark(function z(){return rr.wrap(function(ae){for(;;)switch(ae.prev=ae.next){case 0:return xn({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1}},M),ae.next=3,this.core.sendCmd("dismissTeam",{teamId:M.teamId});case 3:case"end":return ae.stop()}},z,this)}))},F.leaveTeam=function(M){return hn(this,void 0,void 0,rr.mark(function z(){return rr.wrap(function(ae){for(;;)switch(ae.prev=ae.next){case 0:return xn({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1}},M),ae.next=3,this.core.sendCmd("leaveTeam",{teamId:M.teamId});case 3:case"end":return ae.stop()}},z,this)}))},F.transferTeam=function(M){return hn(this,void 0,void 0,rr.mark(function z(){return rr.wrap(function(ae){for(;;)switch(ae.prev=ae.next){case 0:return xn({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1},account:{type:"string",allowEmpty:!1},leave:{type:"boolean"}},M),ae.next=3,this.core.sendCmd("transferTeam",M);case 3:case"end":return ae.stop()}},z,this)}))},F.updateTeamInfo=function(M){return hn(this,void 0,void 0,rr.mark(function z(){var pe;return rr.wrap(function(ze){for(;;)switch(ze.prev=ze.next){case 0:return xn({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1},joinMode:{type:"enum",values:["noVerify","needVerify","rejectAll"],required:!1},beInviteMode:{type:"enum",values:["noVerify","needVerify"],required:!1},inviteMode:{type:"enum",values:["manager","all"],required:!1},updateTeamMode:{type:"enum",values:["manager","all"],required:!1},updateExtMode:{type:"enum",values:["manager","all"],required:!1},intro:{type:"string",allowEmpty:!1,required:!1},announcement:{type:"string",allowEmpty:!1,required:!1},avatar:{type:"string",allowEmpty:!1,required:!1},ext:{type:"string",allowEmpty:!1,required:!1}},M),pe=Ch(M),ze.next=4,this.core.sendCmd("updateTeamInfo",{team:pe});case 4:return ze.abrupt("return",Pc(pe));case 5:case"end":return ze.stop()}},z,this)}))},F.getTeamMembers=function(M){var z;return hn(this,void 0,void 0,rr.mark(function pe(){var ae,ze;return rr.wrap(function(ur){for(;;)switch(ur.prev=ur.next){case 0:return xn({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1},accounts:{type:"array",itemType:"string",required:!1}},M),ur.next=3,this.core.sendCmd("getTeamMembers",{teamId:M.teamId,timetag:0});case 3:if(ae=ur.sent,ze=Wp((z=ae.content)===null||z===void 0?void 0:z.teamMembers),M.accounts&&M.accounts.length>0){ur.next=7;break}return ur.abrupt("return",ze);case 7:return ur.abrupt("return",ss(ze).call(ze,function(hr){var br;return(br=M.accounts)===null||br===void 0?void 0:Mc(br).call(br,hr.account)}));case 8:case"end":return ur.stop()}},pe,this)}))},F.getMutedTeamMembers=function(M){return hn(this,void 0,void 0,rr.mark(function z(){var pe,ae;return rr.wrap(function(jt){for(;;)switch(jt.prev=jt.next){case 0:return xn({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1}},M),jt.next=3,this.core.sendCmd("getMutedTeamMembers",{teamId:M.teamId});case 3:return pe=jt.sent,ae=pe.content,jt.abrupt("return",Wp(ae.teamMembers));case 6:case"end":return jt.stop()}},z,this)}))},F.addTeamMembers=function(M){return hn(this,void 0,void 0,rr.mark(function z(){return rr.wrap(function(ae){for(;;)switch(ae.prev=ae.next){case 0:return xn({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1},accounts:{type:"array",itemType:"string",min:1},ps:{type:"string",allowEmpty:!0,max:5e3,required:!1}},M),ae.next=3,this.core.sendCmd("addTeamMembers",{teamId:M.teamId,accounts:M.accounts,ps:M.ps||"",attach:M.ext||""});case 3:case"end":return ae.stop()}},z,this)}))},F.removeTeamMembers=function(M){return hn(this,void 0,void 0,rr.mark(function z(){return rr.wrap(function(ae){for(;;)switch(ae.prev=ae.next){case 0:return xn({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1},accounts:{type:"array",itemType:"string",min:1}},M),ae.next=3,this.core.sendCmd("removeTeamMembers",{teamId:M.teamId,accounts:M.accounts});case 3:case"end":return ae.stop()}},z,this)}))},F.applyTeam=function(M){return hn(this,void 0,void 0,rr.mark(function z(){var pe;return rr.wrap(function(ze){for(;;)switch(ze.prev=ze.next){case 0:return xn({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1},ps:{type:"string",allowEmpty:!0,max:5e3,required:!1}},M),ze.next=3,this.core.sendCmd("applyTeam",{teamId:M.teamId,ps:M.ps||""});case 3:return pe=ze.sent,ze.abrupt("return",Pc(pe.content.team));case 5:case"end":return ze.stop()}},z,this)}))},F.addTeamManagers=function(M){return hn(this,void 0,void 0,rr.mark(function z(){return rr.wrap(function(ae){for(;;)switch(ae.prev=ae.next){case 0:return xn({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1},accounts:{type:"array",min:1,itemType:"string"}},M),ae.next=3,this.core.sendCmd("addTeamManagers",M);case 3:case"end":return ae.stop()}},z,this)}))},F.removeTeamManagers=function(M){return hn(this,void 0,void 0,rr.mark(function z(){return rr.wrap(function(ae){for(;;)switch(ae.prev=ae.next){case 0:return xn({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1},accounts:{type:"array",min:1,itemType:"string"}},M),ae.next=3,this.core.sendCmd("removeTeamManagers",M);case 3:case"end":return ae.stop()}},z,this)}))},F.updateMyMemberInfo=function(M){return hn(this,void 0,void 0,rr.mark(function z(){var pe,ae,ze;return rr.wrap(function(ur){for(;;)switch(ur.prev=ur.next){case 0:return xn({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1},nickInTeam:{type:"string",allowEmpty:!1,required:!1},bitConfigMask:{type:"number",min:0,max:2,required:!1},ext:{type:"string",required:!1}},M),pe=Tv({teamId:M.teamId,nickInTeam:M.nickInTeam,bitConfigMask:M.bitConfigMask,ext:M.ext}),ur.next=4,this.core.sendCmd("updateMyMemberInfo",{teamMember:pe});case 4:return ae=Pd(kr({updateTime:new Date().getTime(),account:this.core.account},pe)),this.mergeMyTeamMembers([ae]),this.core.emit("updateTeamMember",ae),ze=hc(this.myTeamMembersMap.get(ae.teamId)),this.core.emit("myTeamMembers",[ze]),ur.abrupt("return",ae);case 10:case"end":return ur.stop()}},z,this)}))},F.updateMemberNick=function(M){return hn(this,void 0,void 0,rr.mark(function z(){var pe,ae;return rr.wrap(function(jt){for(;;)switch(jt.prev=jt.next){case 0:return xn({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1},account:{type:"string",allowEmpty:!1},nickInTeam:{type:"string",allowEmpty:!1}},M),pe=Tv({teamId:M.teamId,nickInTeam:M.nickInTeam,account:M.account}),jt.next=4,this.core.sendCmd("updateNickInTeam",{teamMember:pe});case 4:return ae=Pd(kr({updateTime:new Date().getTime()},pe)),jt.abrupt("return",ae);case 6:case"end":return jt.stop()}},z,this)}))},F.muteTeamMember=function(M){return hn(this,void 0,void 0,rr.mark(function z(){return rr.wrap(function(ae){for(;;)switch(ae.prev=ae.next){case 0:return xn({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1},account:{type:"string",allowEmpty:!1},mute:{type:"boolean"}},M),ae.next=3,this.core.sendCmd("muteTeamMember",{teamId:M.teamId,account:M.account,mute:M.mute?1:0});case 3:case"end":return ae.stop()}},z,this)}))},F.getTeamMemberInvitorAccid=function(M){var z;return hn(this,void 0,void 0,rr.mark(function pe(){var ae,ze;return rr.wrap(function(ur){for(;;)switch(ur.prev=ur.next){case 0:return xn({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1},accounts:{type:"array",itemType:"string",max:200}},M),ae={teamId:M.teamId},M.accounts&&M.accounts.length>0&&(ae.accounts=M.accounts),ur.next=5,this.core.sendCmd("getTeamMemberInvitorAccid",ae);case 5:return ze=ur.sent,ur.abrupt("return",((z=ze.content)===null||z===void 0?void 0:z.accountsMap)||{});case 7:case"end":return ur.stop()}},pe,this)}))},F.muteTeam=function(M){return hn(this,void 0,void 0,rr.mark(function z(){return rr.wrap(function(ae){for(;;)switch(ae.prev=ae.next){case 0:return xn({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1},mute:{type:"boolean"}},M),ae.next=3,this.core.sendCmd("muteTeam",{teamId:M.teamId,mute:M.mute?1:0});case 3:case"end":return ae.stop()}},z,this)}))},F.passTeamApply=function(M){return hn(this,void 0,void 0,rr.mark(function z(){return rr.wrap(function(ae){for(;;)switch(ae.prev=ae.next){case 0:return xn({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1},from:{type:"string",allowEmpty:!1}},M),ae.next=3,this.core.sendCmd("passTeamApply",M);case 3:case"end":return ae.stop()}},z,this)}))},F.rejectTeamApply=function(M){return hn(this,void 0,void 0,rr.mark(function z(){return rr.wrap(function(ae){for(;;)switch(ae.prev=ae.next){case 0:return xn({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1},from:{type:"string",allowEmpty:!1},ps:{type:"string",max:5e3,required:!1}},M),ae.next=3,this.core.sendCmd("rejectTeamApply",{teamId:M.teamId,from:M.from,ps:M.ps||""});case 3:case"end":return ae.stop()}},z,this)}))},F.acceptTeamInvite=function(M){return hn(this,void 0,void 0,rr.mark(function z(){return rr.wrap(function(ae){for(;;)switch(ae.prev=ae.next){case 0:return xn({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1},from:{type:"string",allowEmpty:!1}},M),ae.next=3,this.core.sendCmd("acceptTeamInvite",M);case 3:case"end":return ae.stop()}},z,this)}))},F.rejectTeamInvite=function(M){return hn(this,void 0,void 0,rr.mark(function z(){return rr.wrap(function(ae){for(;;)switch(ae.prev=ae.next){case 0:return xn({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1},from:{type:"string",allowEmpty:!1},ps:{type:"string",max:5e3,required:!1}},M),ae.next=3,this.core.sendCmd("rejectTeamInvite",{teamId:M.teamId,from:M.from,ps:M.ps||""});case 3:case"end":return ae.stop()}},z,this)}))},F.notifyTeamMsgReceiptsHandler=function(M){var z,pe=(z=M.content)===null||z===void 0?void 0:z.teamMsgReceipts;pe&&pe.length>0&&(this.core.emit("teamMsgReceipts",pe),this.core.emit("msgReceipts",pe))},F.syncTeamsHandler=function(M){var z=M.content;this.core.eventBus.emit("sync/updateTimetag",{teams:go(z.timetag)});var pe=z==null?void 0:z.teams;if(pe&&pe.length){var ae=Mh(pe);this.core.emit("teams",ae)}},F.syncCreateTeamHandler=function(M){var z=M.content,pe=Pc(z==null?void 0:z.team),ae=Sv(pe,pe.owner,"owner");this.core.emit("createTeam",pe,ae)},F.syncUpdateTeamMemberHandler=function(M){var z=M.content,pe=Pd(z==null?void 0:z.teamMember);pe.updateTime||(pe.updateTime=new Date().getTime()),this.mergeMyTeamMembers([pe]),this.core.emit("updateTeamMember",pe);var ae=hc(this.myTeamMembersMap.get(pe.teamId));this.core.emit("myTeamMembers",[ae])},F.syncMyTeamMembersHandler=function(M){var z,pe=M.content;this.core.eventBus.emit("sync/updateTimetag",{myTeamMembers:go(pe.timetag)});var ae=pe==null?void 0:lo(z=pe.teamMembers).call(z,function(ze){return Pd(ze)});this.mergeMyTeamMembers(ae),this.core.emit("myTeamMembers",hc(ae))},F.notificationHandler=function(M){var z=M.attach,pe=M.scene,ae=M.from,ze=M.to,jt=M.time,ur=M.idServer,hr=M.idClient,br=z.team,Cr=z.account,_r=z.accounts,Nr=z.type;if(pe==="team")switch(this.core.options.debugLevel==="debug"?this.logger.debug("team::recvNotification",ur,hr,z):this.logger.log("team::recvNotification",ur,hr,ze,Nr,Cr,_r),Nr){case"updateTeam":br.updateTime=jt,this.core.emit("updateTeam",br);break;case"addTeamMembers":this.service.notifyAddTeamMembers(br,_r);break;case"acceptTeamInvite":this.service.notifyAddTeamMembers(br,[ae]);break;case"passTeamApply":this.service.notifyAddTeamMembers(br,[Cr]);break;case"addTeamManagers":this.service.notifyUpdateTeamManagers(ze,_r,!0,jt);break;case"removeTeamManagers":this.service.notifyUpdateTeamManagers(ze,_r,!1,jt);break;case"removeTeamMembers":this.service.notifyRemoveTeamMembers(br,_r);break;case"leaveTeam":this.service.notifyRemoveTeamMembers(br,[ae]);break;case"dismissTeam":this.core.emit("dismissTeam",{teamId:ze});break;case"transferTeam":this.service.notifyTransferTeam(br,ae,Cr);break;case"updateTeamMemberMute":this.service.notifyUpdateTeamMembersMute(br,[Cr],z.mute)}},T}(ns);(function(x){x[x.none=0]="none",x[x.pass=1]="pass",x[x.decline=2]="decline",x[x.read=3]="read",x[x.deleted=4]="deleted",x[x.invalid=5]="invalid"})(jc||(jc={})),function(x){x[x.default=0]="default",x[x.leave=1]="leave",x[x.roam=2]="roam"}(gc||(gc={}));var Gd={applyTeam:0,rejectTeamApply:1,teamInvite:2,rejectTeamInvite:3,friendRequest:5,deleteFriend:6,recallMsgP2p:7,recallMsgTeam:8,recallMsgSuperTeam:12,deleteMsgP2pOneWay:13,deleteMsgTeamOneWay:14,applySuperTeam:15,rejectSuperTeamApply:16,superTeamInvite:17,rejectSuperTeamInvite:18,customP2p:100,customTeam:101,customSuperTeam:103},Kd={1:"addFriend",2:"applyFriend",3:"passFriendApply",4:"rejectFriendApply"},cf={setting:{needSaveOffline:{type:"boolean"},isRoutable:{type:"boolean"},envConfig:{type:"string"}},antiSpamInfo:{needAntiSpam:{type:"boolean"},antiSpamContent:{type:"boolean"}},pushInfo:wh,recallMessageInfo:{idClient:{type:"string",rawKey:"deletedIdClient"},idServer:{type:"string",rawKey:"deletedIdServer"},createTime:{type:"number",rawKey:"deletedMsgTime"},fromNick:{type:"string",rawKey:"deletedMsgFromNick"},opeAccount:{type:"string"}}};function Qd(x,T,F){var D=+x.type,M=Na(Gd,D);F=F||gc.default;var z=kr(kr({},Zs(cf,x)),{type:M,time:+x.time,to:x.to,from:x.from,idServer:x.idServer,state:jc[jc.none],feature:gc[F]});if(typeof z.attach=="string")try{z.attach=JSON.parse(z.attach)}catch(pe){T.error("formatSystemMessage: "+z.idServer+" parse attach error",pe&&pe.message)}return D===5&&z.attach?(z.attach.type=Kd[+z.attach.vt],z.attach.type==="passFriendApply"?z.state=jc[jc.pass]:z.attach.type==="rejectFriendApply"&&(z.state=jc[jc.decline])):D<=3&&z.attach&&(z.attach=function(ae){var ze=ae.attach,jt=ae.tinfo,ur=Is(ae,["attach","tinfo"]);return ur.ext=ze,jt!==void 0&&(ur.team=Pc(Aa(ae.tinfo,os.team))),ur}(z.attach)),z}function yM(x){var T=kr({},x);return kr(kr({},wd(cf,T)),{type:Gd[T.type],to:T.to,attach:T.attach})}var vM={"4_6":"syncOfflineSysMsgs","4_18":"syncOfflineSysMsgs","4_19":"syncRecallMsgOfflineAndRoaming","4_101":"syncOfflineSysMsgs","7_3":"onSysMsg","7_7":"sendCustomSysMsg","7_14":"onRecallMsg","21_18":"onRecallMsg","21_117":"onRecallMsg","7_15":"syncRecallMsgOfflineAndRoaming","21_19":"onSysMsg","21_16":"sendSuperTeamCustomSysMsg","101_3":"onSysMsg","101_7":"sendFilterCustomSysMsg"},Jd={sysMsg:kr({time:0,type:1,to:2,from:3,content:4,attach:5,idServer:6,needSaveOffline:7,deletedIdClient:10,deletedIdServer:11,needcAntiSpam:12,antiSpamContent:13,deletedMsgTime:14,deletedMsgFromNick:15,opeAccount:16,envConfig:21,callbackExt:22,isRoutable:105},Iv)},ku=ts(Jd),bM={onSysMsg:{service:"systemMessage",sid:7,cid:3,response:[{type:"Property",name:"sysMsg",reflectMapper:ku.sysMsg}]},sendCustomSysMsg:{service:"systemMessage",sid:7,cid:7,params:[{type:"Property",name:"sysMsg",reflectMapper:Jd.sysMsg}]},sendSuperTeamCustomSysMsg:{service:"systemMessage",sid:21,cid:16,params:[{type:"Property",name:"sysMsg",reflectMapper:Jd.sysMsg}]},sendFilterCustomSysMsg:{service:"systemMessage",sid:101,cid:7,params:[{type:"Property",name:"sysMsg",reflectMapper:Jd.sysMsg}]},batchMarkRead:{service:"systemMessage",sid:4,cid:5,isNoResponse:!0,params:[{type:"byte",name:"sid"},{type:"byte",name:"cid"},{type:"LongArray",name:"ids"}]},onRecallMsg:{sid:7,cid:14,service:"systemMessage",response:[{type:"Property",name:"sysMsg",reflectMapper:ku.sysMsg}]},syncRecallMsgOfflineAndRoaming:{sid:7,cid:15,service:"systemMessage",response:[{type:"PropertyArray",name:"sysMsgs",reflectMapper:ku.sysMsg},{type:"Number",name:"timetag"},{type:"Number",name:"type"}]},syncOfflineSysMsgs:{sid:4,cid:9,service:"systemMessage",response:[{type:"PropertyArray",name:"sysMsgs",reflectMapper:ku.sysMsg}]}},TM=function(x){function T(D){var M;return(M=x.call(this,"systemMessage",D)||this).sysMsgUnread={total:0,friend:0,msg:0,team:0,superTeam:0},M.core.eventBus.on("logined",function(){M.initEventListeners()}),Ui({cmdMap:vM,cmdConfig:bM}),M}Co(T,x);var F=T.prototype;return F.initEventListeners=function(){var M=this;this.core.eventBus.on("systemMessage/passFriendApply",function(z){M.core.emit("updateSystemMessages",[{idServer:z.idServer,from:z.account,state:"pass",type:"friendRequest"}])}),this.core.eventBus.on("systemMessage/rejectFriendApply",function(z){M.core.emit("updateSystemMessages",[{idServer:z.idServer,from:z.account,state:"decline",type:"friendRequest"}])})},F.doMarkSysMsgAck=function(M){var z=[],pe=[],ae=["applySuperTeam","rejectSuperTeamApply","superTeamInvite","rejectSuperTeamInvite","customSuperTeam"];kn(M).call(M,function(ze){ze.idServer&&(Mc(ae).call(ae,ze.type)?pe.push(ze.idServer):z.push(ze.idServer))}),z.length>0&&this.core.sendCmd("batchMarkRead",{sid:"7",cid:"3",ids:z}),pe.length>0&&this.core.sendCmd("batchMarkRead",{sid:"21",cid:"19",ids:pe})},F.sendCustomSysMsg=function(M){var z=this;xn({to:{type:"string",allowEmpty:!1},type:{type:"enum",values:["customP2p","customTeam","customSuperTeam"]},attach:{type:"string",allowEmpty:!1},setting:{type:"object",rules:{needSaveOffline:{type:"boolean",required:!1},env:{type:"string",allowEmpty:!1,required:!1}},required:!1},pushInfo:{type:"object",required:!1,rules:wh}},M);var pe=M.type==="customSuperTeam"?"sendSuperTeamCustomSysMsg":"sendCustomSysMsg";return this.core.sendCmd(pe,{sysMsg:yM(M)}).then(function(){z.logger.log("sendCustomSysMsg success")}).catch(function(ae){throw z.logger.error("sendCustomSysMsg failed",ae.message),ae})},F.onSysMsgHandler=function(M){var z,pe=(z=M.content)===null||z===void 0?void 0:z.sysMsg;if(pe){var ae=typeof Es(M,"raw.r[0]")=="number"?""+M.raw.r[0]:void 0;pe.idServer=pe.idServer||ae;var ze=Qd(pe,this.logger,gc.default);this.core.emit("sysMsg",ze),this.doMarkSysMsgAck([ze])}else this.logger.warn("onSysMsg no content.sysMsg")},F.syncOfflineSysMsgsHandler=function(M){var z,pe=this;if(M.content.sysMsgs&&M.content.sysMsgs.length>0){var ae=lo(z=M.content.sysMsgs).call(z,function(ze){return Qd(ze,pe.logger,gc.leave)});this.core.emit("syncSysMsgs",ae),this.doMarkSysMsgAck(ae)}},F.onRecallMsgHandler=function(M){var z,pe=(z=M.content)===null||z===void 0?void 0:z.sysMsg;if(pe){var ae=typeof Es(M,"raw.r[0]")=="number"?""+M.raw.r[0]:void 0;pe.idServer=pe.idServer||ae;var ze=Od([pe],function(hr){return hr===Gd.recallMsgP2p?"p2p":hr===Gd.recallMsgTeam?"team":hr===Gd.recallMsgSuperTeam?"superTeam":""}(+pe.type));this.core.eventBus.emit("session/updateForDeletedMsg",ze);var jt=Qd(pe,this.logger,gc.default);this.core.emit("sysMsg",jt),this.doMarkSysMsgAck([jt])}else this.logger.warn("onSysMsg no content.sysMsg")},F.syncRecallMsgOfflineAndRoamingHandler=function(M){var z=this,pe=M.content,ae=pe.timetag,ze=pe.type,jt=pe.sysMsgs,ur=go(ze),hr=ur===1?gc.leave:gc.roam,br=lo(jt).call(jt,function(Cr){return Qd(Cr,z.logger,hr)});ur===1&&this.doMarkSysMsgAck(br),this.core.eventBus.emit("sync/updateTimetag",{recallMsg:ae}),this.core.emit("syncSysMsgs",br)},T}(ns);function Yd(x){var T=["bitsExtension","createTime","updateTime","passRelationShip","relationShip","source"],F=kr({},x);return kn(T).call(T,function(D){F[D]!==void 0&&(F[D]=go(F[D]))}),F.relationShip!==void 0&&(F.valid=F.relationShip===1),F}var SM={1:"addFriend",2:"applyFriend",3:"passFriendApply",4:"rejectFriendApply"},zh={"12_4":"getFriends","12_1":"friendReuqest","12_2":"deleteFriend","12_3":"updateFriend","12_5":"syncFriends","12_6":"syncFriendUsers","12_101":"syncFriendRequest","12_102":"syncDeleteFriend","12_103":"syncUpdateFriend"},uf={updateFriendTag:{account:4,alias:8,ext:10},delFriendParams:{delAlias:1},friendTag:{account:4,relationShip:5,passRelationShip:6,source:7,alias:8,bitsExtension:9,ext:10,createTime:11,updateTime:12,serverex:13},userTag:{account:1,nick:3,avatar:4,sign:5,gender:6,email:7,birth:8,tel:9,ext:10,createTime:12,updateTime:13}},lf=ts(uf),Jv={getFriends:{sid:12,cid:4,service:"friend",params:[{type:"Long",name:"timetag"}],response:[{type:"PropertyArray",name:"friends",reflectMapper:lf.friendTag},{type:"Number",name:"timetag"}]},friendReuqest:{sid:12,cid:1,service:"friend",params:[{type:"String",name:"account"},{type:"Byte",name:"type"},{type:"String",name:"ps"}]},deleteFriend:{sid:12,cid:2,service:"friend",params:[{type:"String",name:"account"},{type:"Property",name:"delFriendParams",reflectMapper:uf.delFriendParams}]},updateFriend:{sid:12,cid:3,service:"friend",params:[{type:"Property",name:"updateFriendTag",reflectMapper:uf.updateFriendTag}]},syncFriends:{sid:12,cid:5,service:"friend",response:[{type:"PropertyArray",name:"friends",entity:"friendTag",reflectMapper:lf.friendTag},{type:"Number",name:"timetag"}]},syncFriendUsers:{sid:12,cid:6,service:"friend",response:[{type:"PropertyArray",name:"users",entity:"userTag",reflectMapper:lf.userTag},{type:"Number",name:"timetag"}]},syncFriendRequest:{sid:12,cid:101,service:"friend",params:[{type:"String",name:"account"},{type:"Number",name:"type"},{type:"String",name:"ps"}],response:[{type:"String",name:"account"},{type:"Number",name:"type"},{type:"String",name:"ps"}]},syncDeleteFriend:{sid:12,cid:102,service:"friend",response:[{type:"String",name:"account"}]},syncUpdateFriend:{sid:12,cid:103,service:"friend",response:[{type:"Property",name:"friend",reflectMapper:lf.friendTag}]}},MM=function(x){function T(D){var M;return M=x.call(this,"friend",D)||this,Ui({cmdMap:zh,cmdConfig:Jv}),M}Co(T,x);var F=T.prototype;return F.getFriends=function(){var M;return hn(this,void 0,void 0,rr.mark(function z(){var pe,ae;return rr.wrap(function(jt){for(;;)switch(jt.prev=jt.next){case 0:return jt.next=2,this.core.sendCmd("getFriends",{timetag:0});case 2:return pe=jt.sent,ae=((M=pe.content)===null||M===void 0?void 0:M.friends)||[],ae=lo(ae).call(ae,function(ur){return Yd(ur)}),jt.abrupt("return",ae);case 6:case"end":return jt.stop()}},z,this)}))},F.addFriend=function(M){return hn(this,void 0,void 0,rr.mark(function z(){var pe;return rr.wrap(function(ze){for(;;)switch(ze.prev=ze.next){case 0:return xn({account:{type:"string",allowEmpty:!1},ps:{type:"string",allowEmpty:!1,required:!1}},M),ze.next=3,this.core.sendCmd("friendReuqest",{account:M.account,type:1,ps:M.ps||""});case 3:return pe=new Date().getTime(),ze.abrupt("return",{account:M.account,createTime:pe,updateTime:pe,valid:!0,source:0,passRelationShip:1,relationShip:1,bitsExtension:0});case 5:case"end":return ze.stop()}},z,this)}))},F.applyFriend=function(M){return hn(this,void 0,void 0,rr.mark(function z(){return rr.wrap(function(ae){for(;;)switch(ae.prev=ae.next){case 0:return xn({account:{type:"string",allowEmpty:!1}},M),ae.next=3,this.core.sendCmd("friendReuqest",{account:M.account,type:2,ps:M.ps||""});case 3:case"end":return ae.stop()}},z,this)}))},F.passFriendApply=function(M){return hn(this,void 0,void 0,rr.mark(function z(){var pe=this;return rr.wrap(function(ze){for(;;)switch(ze.prev=ze.next){case 0:return xn({account:{type:"string",allowEmpty:!1}},M),ze.next=3,this.core.sendCmd("friendReuqest",{account:M.account,type:3,ps:M.ps||""}).then(function(jt){return pe.core.eventBus.emit("systemMessage/passFriendApply",M),jt});case 3:case"end":return ze.stop()}},z,this)}))},F.rejectFriendApply=function(M){return hn(this,void 0,void 0,rr.mark(function z(){var pe=this;return rr.wrap(function(ze){for(;;)switch(ze.prev=ze.next){case 0:return xn({account:{type:"string",allowEmpty:!1}},M),ze.next=3,this.core.sendCmd("friendReuqest",{account:M.account,type:4,ps:M.ps||""}).then(function(jt){return pe.core.eventBus.emit("systemMessage/rejectFriendApply",M),jt});case 3:case"end":return ze.stop()}},z,this)}))},F.deleteFriend=function(M){return hn(this,void 0,void 0,rr.mark(function z(){return rr.wrap(function(ae){for(;;)switch(ae.prev=ae.next){case 0:return xn({account:{type:"string",allowEmpty:!1},delAlias:{type:"boolean"}},M),ae.next=3,this.core.sendCmd("deleteFriend",{account:M.account,delFriendParams:{delAlias:M.delAlias===!0?1:0}});case 3:case"end":return ae.stop()}},z,this)}))},F.updateFriend=function(M){return hn(this,void 0,void 0,rr.mark(function z(){return rr.wrap(function(ae){for(;;)switch(ae.prev=ae.next){case 0:return xn({account:{type:"string",allowEmpty:!1},alias:{type:"string"},ext:{type:"string",required:!1}},M),ae.next=3,this.core.sendCmd("updateFriend",{updateFriendTag:M});case 3:case"end":return ae.stop()}},z,this)}))},F.syncFriendRequestHandler=function(M){var z=function(ae){var ze=kr({},ae);try{ze.ps=ze.ps&&JSON.parse(ze.ps)}catch{}if(ze.type=SM[ze.type],ze.type==="addFriend"||ze.type==="passFriendApply"){var jt=new Date().getTime();ze.friend={account:ae.account,alias:"",createTime:jt,ext:"",updateTime:jt,valid:!0}}return ze}(M.content);this.core.emit("syncFriend",z)},F.syncDeleteFriendHandler=function(M){var z=M.content.account;this.logger.log("friend::emit syncFriendAction: deleteFriend "+z),this.core.emit("syncFriend",{type:"deleteFriend",account:z})},F.syncUpdateFriendHandler=function(M){var z=Yd(M.content.friend);this.logger.log("friend::emit syncFriendAction: updateFriend, ",z==null?void 0:z.account),this.core.emit("syncFriend",{type:"updateFriend",friend:z})},F.syncFriendsHandler=function(M){var z=M.content;this.core.eventBus.emit("sync/updateTimetag",{friends:go(z.timetag)});var pe=z==null?void 0:z.friends;if(pe&&pe.length){var ae=lo(pe).call(pe,function(ze){return Yd(ze)});this.core.emit("friends",ae)}},F.syncFriendUsersHandler=function(M){var z=M.content;this.core.eventBus.emit("sync/updateTimetag",{friendUsers:go(z.timetag)});var pe=z==null?void 0:z.users;if(pe&&pe.length){var ae=lo(pe).call(pe,function(ze){return Ju(ze)});this.core.emit("users",ae)}},T}(ns),Wh={1:"Android",2:"iOS",4:"PC",8:"WindowsPhone",16:"Web",32:"Server",64:"Mac"};function Yv(x){return x&&x.length>0?lo(x).call(x,function(T){return function(D){var M=kr({},D),z=["subscribeTime","time"];return kn(z).call(z,function(pe){M[pe]&&(M[pe]=go(M[pe]))}),M}(T)}):[]}function Bc(x){if(!x)return x;var T=x.serverExt,F=Is(x,["serverExt"]),D=["time","type","value"];if(kn(D).call(D,function(M){F[M]&&(F[M]=go(F[M]))}),F.clientType&&(F.clientType=Wh[F.clientType]||""),T)try{F.ext=JSON.parse(T),typeof F.ext[0]=="string"&&(F.ext=F.ext[0])}catch{}return F}var Xv={"14_1":"publishEvent","14_2":"pushEvent","14_3":"subscribeEvent","14_4":"unSubscribeEventsByAccounts","14_5":"unSubscribeEventsByType","14_6":"querySubscribeEventsByAccounts","14_7":"querySubscribeEventsByType","14_9":"pushEvents"},xu={msgEvent:{type:1,value:2,idClient:3,ext:4,validTime:5,broadcastType:6,sync:7,validTimeType:8,durable:9,time:10,idServer:11,clientType:12,serverConfig:13,serverExt:14,appid:101,account:103,enableMultiClient:104,consid:106},msgEventSubscribe:{type:1,subscribeTime:2,sync:3,to:102,from:104,time:105}},sl=ts(xu),CM={publishEvent:{sid:14,cid:1,service:"event",params:[{type:"Property",name:"msgEvent",reflectMapper:xu.msgEvent}],response:[{type:"Property",name:"msgEvent",reflectMapper:sl.msgEvent}]},pushEvent:{sid:14,cid:2,service:"event",response:[{type:"Property",name:"msgEvent",reflectMapper:sl.msgEvent}]},subscribeEvent:{sid:14,cid:3,service:"event",params:[{type:"Property",name:"msgEventSubscribe",reflectMapper:xu.msgEventSubscribe},{type:"StrArray",name:"accounts"}],response:[{type:"StrArray",name:"accounts"}]},unSubscribeEventsByAccounts:{sid:14,cid:4,service:"event",params:[{type:"Property",name:"msgEventSubscribe",reflectMapper:xu.msgEventSubscribe},{type:"StrArray",name:"accounts"}],response:[{type:"StrArray",name:"accounts"}]},unSubscribeEventsByType:{sid:14,cid:5,service:"event",params:[{type:"Property",name:"msgEventSubscribe",reflectMapper:xu.msgEventSubscribe}]},querySubscribeEventsByAccounts:{sid:14,cid:6,service:"event",params:[{type:"Property",name:"msgEventSubscribe",reflectMapper:xu.msgEventSubscribe},{type:"StrArray",name:"accounts"}],response:[{type:"PropertyArray",name:"msgEventSubscribes",reflectMapper:sl.msgEventSubscribe}]},querySubscribeEventsByType:{sid:14,cid:7,service:"event",params:[{type:"Property",name:"msgEventSubscribe",reflectMapper:xu.msgEventSubscribe}],response:[{type:"PropertyArray",name:"msgEventSubscribes",reflectMapper:sl.msgEventSubscribe}]},pushEvents:{sid:14,cid:9,service:"event",response:[{type:"PropertyArray",name:"msgEvents",reflectMapper:sl.msgEvent}]}},b=function(x){function T(D){var M;return M=x.call(this,"event",D)||this,Ui({cmdMap:Xv,cmdConfig:CM}),M}Co(T,x);var F=T.prototype;return F.publishEvent=function(M){var z;return hn(this,void 0,void 0,rr.mark(function pe(){var ae,ze,jt;return rr.wrap(function(hr){for(;;)switch(hr.prev=hr.next){case 0:return xn({type:{type:"number"},value:{type:"number"},ext:{type:"string",required:!1},validTime:{type:"number",min:60,max:2592e3,required:!1},broadcastType:{type:"number",required:!1},sync:{type:"boolean",required:!1}},M),ae=kr(kr({validTime:604800},M),{idClient:Ap(),sync:M.sync===!0?1:0}),hr.next=4,this.core.sendCmd("publishEvent",{msgEvent:ae});case 4:return ze=hr.sent,jt=((z=ze.content)===null||z===void 0?void 0:z.msgEvent)||{},hr.abrupt("return",Bc(jt));case 7:case"end":return hr.stop()}},pe,this)}))},F.subscribeEvent=function(M){var z;return hn(this,void 0,void 0,rr.mark(function pe(){var ae,ze,jt;return rr.wrap(function(hr){for(;;)switch(hr.prev=hr.next){case 0:return xn({type:{type:"number"},accounts:{type:"array",itemType:"string",max:100},subscribeTime:{type:"number",min:60,max:2592e3,required:!1}},M),ae=kr(kr({subscribeTime:2592e3},M),{sync:M.sync===!0?1:0}),hr.next=4,this.core.sendCmd("subscribeEvent",{msgEventSubscribe:ae,accounts:M.accounts});case 4:return ze=hr.sent,jt=((z=ze.content)===null||z===void 0?void 0:z.accounts)||[],hr.abrupt("return",{failedAccounts:jt});case 7:case"end":return hr.stop()}},pe,this)}))},F.unSubscribeEvents=function(M){var z;return hn(this,void 0,void 0,rr.mark(function pe(){var ae,ze,jt;return rr.wrap(function(hr){for(;;)switch(hr.prev=hr.next){case 0:if(xn({type:{type:"number"},accounts:{type:"array",itemType:"string",max:100,required:!1}},M),ae={type:M.type},!(M.accounts&&M.accounts.length>0)){hr.next=9;break}return hr.next=5,this.core.sendCmd("unSubscribeEventsByAccounts",{msgEventSubscribe:ae,accounts:M.accounts});case 5:jt=hr.sent,ze=((z=jt.content)===null||z===void 0?void 0:z.accounts)||[],hr.next=12;break;case 9:return hr.next=11,this.core.sendCmd("unSubscribeEventsByType",{msgEventSubscribe:ae});case 11:ze=[];case 12:return hr.abrupt("return",{failedAccounts:ze});case 13:case"end":return hr.stop()}},pe,this)}))},F.querySubscribeEvents=function(M){var z;return hn(this,void 0,void 0,rr.mark(function pe(){var ae;return rr.wrap(function(jt){for(;;)switch(jt.prev=jt.next){case 0:if(xn({type:{type:"number"},accounts:{type:"array",itemType:"string",max:100,required:!1}},M),!(M.accounts&&M.accounts.length>0)){jt.next=7;break}return jt.next=4,this.core.sendCmd("querySubscribeEventsByAccounts",{msgEventSubscribe:{type:M.type},accounts:M.accounts});case 4:ae=jt.sent,jt.next=10;break;case 7:return jt.next=9,this.core.sendCmd("querySubscribeEventsByType",{msgEventSubscribe:{type:M.type}});case 9:ae=jt.sent;case 10:return jt.abrupt("return",Yv((z=ae.content)===null||z===void 0?void 0:z.msgEventSubscribes));case 11:case"end":return jt.stop()}},pe,this)}))},F.pushEventHandler=function(M){var z,pe=((z=M.content)===null||z===void 0?void 0:z.msgEvent)||{};this.core.emit("pushEvents",[Bc(pe)])},F.pushEventsHandler=function(M){var z,pe=((z=M.content)===null||z===void 0?void 0:z.msgEvents)||{};this.core.emit("pushEvents",function(ze){return ya(ze)&&ze.length>0?lo(ze).call(ze,function(jt){return Bc(jt)}):[]}(pe))},T}(ns);function w(x){var T={scene:bh[x.scene],from:x.threadMsgFromAccount,to:x.threadMsgToAccount,time:x.threadMsgTime,idServer:x.threadMsgIdServer},F={limit:x.limit<100?x.limit:100,beginTime:typeof x.beginTime=="number"?x.beginTime:0,reverse:Eu(x)===!0?1:0};return x.lastMsgId&&(F.lastMsgId=x.lastMsgId),{msg:T,threadMsgReq:F}}var $,A={"23_1":"getThreadMsgs","23_2":"getMsgsByIdServer"},_={msg:Ni,threadMsgReq:{beginTime:1,endTime:2,lastMsgId:3,limit:4,reverse:5},threadMsgsMeta:{total:1,lastMsgTime:2}},Y=ts(_),de={getThreadMsgs:{sid:23,cid:1,service:"msgExtend",params:[{type:"Property",name:"msg",reflectMapper:_.msg},{type:"Property",name:"threadMsgReq",reflectMapper:_.threadMsgReq}],response:[{type:"Property",name:"threadMsg",reflectMapper:Y.msg},{type:"Property",name:"threadMsgsMeta",reflectMapper:Y.threadMsgsMeta},{type:"PropertyArray",name:"msgs",reflectMapper:Y.msg}]},getMsgsByIdServer:{sid:23,cid:2,service:"msgExtend",params:[{type:"PropertyArray",name:"reqMsgs",reflectMapper:_.msg}],response:[{type:"PropertyArray",name:"msgs",reflectMapper:Y.msg}]}},V=function(x){function T(D){var M;return M=x.call(this,"msgExtend",D)||this,Ui({cmdMap:A,cmdConfig:de}),M}Co(T,x);var F=T.prototype;return F.getThreadMsgs=function(M){var z;return hn(this,void 0,void 0,rr.mark(function pe(){var ae,ze,jt,ur,hr,br,Cr;return rr.wrap(function(Nr){for(;;)switch(Nr.prev=Nr.next){case 0:return xn({scene:{type:"enum",values:ba(Bi)},threadMsgFromAccount:{type:"string",allowEmpty:!1},threadMsgIdServer:{type:"string",allowEmpty:!1},threadMsgTime:{type:"number"},threadMsgToAccount:{type:"string",allowEmpty:!1},beginTime:{type:"number",required:!1},endTime:{type:"number",required:!1},lastMsgId:{type:"string",allowEmpty:!1,required:!1},limit:{type:"number",min:1,max:100,required:!1},reverse:{type:"boolean",required:!1}},M),Nr.next=3,this.core.sendCmd("getThreadMsgs",w(M));case 3:return ae=Nr.sent,ze=ae.content,jt=ze.msgs,ur=ze.threadMsg,hr=ae.content.threadMsgsMeta,br=Sa(ur,this.core.account),Cr=(z=this.core.session)===null||z===void 0?void 0:z.getSessionWithUncomplete({id:br}),jt=Ad(jt,Cr?{account:this.core.account,sessionAck:Cr.ack,msgReceiptTime:Cr.msgReceiptTime}:{account:this.core.account}),ur=Ba(ur,Cr?{account:this.core.account,sessionAck:Cr.ack,msgReceiptTime:Cr.msgReceiptTime}:{account:this.core.account}),Nr.abrupt("return",{msgs:jt,threadMsg:ur,total:go(hr.total),timetag:go(hr.lastMsgTime)});case 11:case"end":return Nr.stop()}},pe,this)}))},F.getMsgsByIdServer=function(M){return hn(this,void 0,void 0,rr.mark(function z(){var pe,ae,ze,jt,ur=this;return rr.wrap(function(br){for(;;)switch(br.prev=br.next){case 0:return xn({reqMsgs:{type:"array",rules:{scene:{type:"enum",values:ba(Bi)},from:{type:"string",allowEmpty:!1},to:{type:"string",allowEmpty:!1},idServer:{type:"string",allowEmpty:!1},time:{type:"number"}},min:1,max:100}},M),br.next=3,this.core.sendCmd("getMsgsByIdServer",{reqMsgs:lo(pe=M.reqMsgs).call(pe,function(Cr){return kr(kr({},Cr),{scene:Na(Bi,Cr.scene)})})});case 3:return ze=br.sent,jt=lo(ae=ze.content.msgs).call(ae,function(Cr){var _r,Nr=Sa(Cr,ur.core.account),Br=(_r=ur.core.session)===null||_r===void 0?void 0:_r.getSessionWithUncomplete({id:Nr});return Ba(Cr,Br?{account:ur.core.account,sessionAck:Br.ack,msgReceiptTime:Br.msgReceiptTime}:{account:ur.core.account})}),br.abrupt("return",jt);case 6:case"end":return br.stop()}},z,this)}))},T}(ns);(function(x){x[x.ASC=1]="ASC",x[x.DESC=2]="DESC"})($||($={}));var Fe,Et={"7_6":"getHistoryMsgs","7_9":"deleteRoamingMsgs","4_24":"syncClearServerHistoryMsgs","7_18":"clearHistoryMsgsFromServer","7_118":"multiSyncClearServerHistoryMsgs","7_26":"nimFtsCloudMsgLogsAggWithSession","7_27":"nimFtsCloudMsgLogs"},sr={msg:Ni,clearHistoryMsgsFromServerReqTag:{type:0,otherAccid:1,isDeleteRoam:2,toTid:3,isSyncSelf:4,ext:7},clearMsgsParamsWithSync:{type:0,otherAccid:1,isDeleteRoam:2,toTid:3,isSyncSelf:4,fromAccid:5,time:6,ext:7},ftsReqTag:{keyword:1,fromTime:2,toTime:3,sessionLimit:4,msglogsLimit:5,orderRule:6,p2pSessionList:7,teamSessionList:8,senderList:9,msgTypeList:10,msgSubTypeList:11}},fr=ts(sr),Sr={deleteRoamingMsgs:{sid:7,cid:9,service:"msgLog",params:[{type:"StrArray",name:"ids"}]},getHistoryMsgs:{sid:7,cid:6,params:[{type:"String",name:"to"},{type:"Long",name:"beginTime"},{type:"Long",name:"endTime"},{type:"Long",name:"lastMsgId"},{type:"int",name:"limit"},{type:"bool",name:"reverse"},{type:"LongArray",name:"msgTypes"}],response:[{type:"PropertyArray",name:"msgs",reflectMapper:fr.msg}],service:"msgLog"},clearHistoryMsgsFromServer:{sid:7,cid:18,params:[{type:"Property",name:"clearHistoryMsgsFromServerReqTag",reflectMapper:sr.clearHistoryMsgsFromServerReqTag}],response:[{type:"Long",name:"timetag"}],service:"msgLog"},multiSyncClearServerHistoryMsgs:{sid:7,cid:118,response:[{type:"Property",name:"data",reflectMapper:fr.clearMsgsParamsWithSync}],service:"msgLog"},syncClearServerHistoryMsgs:{sid:4,cid:24,service:"msgLog",response:[{type:"PropertyArray",name:"datas",reflectMapper:fr.clearMsgsParamsWithSync}]},nimFtsCloudMsgLogsAggWithSession:{sid:7,cid:26,service:"msgLog",params:[{type:"Property",name:"tag",reflectMapper:sr.ftsReqTag}],response:[{type:"PropertyArray",name:"datas",reflectMapper:fr.msg}]},nimFtsCloudMsgLogs:{sid:7,cid:27,service:"msgLog",params:[{type:"Property",name:"tag",reflectMapper:sr.ftsReqTag}],response:[{type:"PropertyArray",name:"datas",reflectMapper:fr.msg}]}};(function(x){x[x.p2p=1]="p2p",x[x.team=2]="team"})(Fe||(Fe={}));var Tr={type:{type:"enum",values:Fe},isDeleteRoam:{type:"boolean"},isSyncSelf:{type:"boolean"},time:{type:"number"}};function Pr(x){var T=Zs(Tr,x);return{sessionId:T.type==="p2p"?"p2p-"+T.otherAccid:"team-"+T.toTid,time:T.time}}var Lr={orderRule:{type:"enum",values:$}};function jr(x){var T,F=Zs(Lr,x);ya(F.msgTypeList)&&(F.msgTypeList=lo(T=F.msgTypeList).call(T,function(M){return cc[M]}).join(","));var D=["p2pSessionList","teamSessionList","senderList","msgSubTypeList"];return kn(D).call(D,function(M){ya(F[M])&&(F[M]=F[M].join(","))}),F}var Jr=function(x){function T(D){var M;return M=x.call(this,"msgLog",D)||this,Ui({cmdMap:Et,cmdConfig:Sr}),M}Co(T,x);var F=T.prototype;return F.deleteRoamingMsgs=function(M){return hn(this,void 0,void 0,rr.mark(function z(){var pe,ae;return rr.wrap(function(jt){for(;;)switch(jt.prev=jt.next){case 0:xn({ids:{type:"array",itemType:"string"}},M),pe=[],jt.prev=2,pe=lo(ae=M.ids).call(ae,function(ur){var hr=wo(ur);return hr.scene+"|"+hr.accid}),jt.next=10;break;case 6:throw jt.prev=6,jt.t0=jt.catch(2),this.logger.error("Failed to delete roaming msgs with "+M.ids,jt.t0),new Error("Failed to create session with "+M.ids);case 10:return jt.next=12,this.core.sendCmd("deleteRoamingMsgs",{ids:pe});case 12:case"end":return jt.stop()}},z,this,[[2,6]])}))},F.getHistoryMsgs=function(M){var z,pe;return hn(this,void 0,void 0,rr.mark(function ae(){var ze,jt,ur,hr,br,Cr,_r;return rr.wrap(function(Br){for(;;)switch(Br.prev=Br.next){case 0:return!((z=this.core.sync)===null||z===void 0)&&z.getSyncDoneFlag()||this.logger.warn("Please call getHistoryMsgs after syncdone event"),xn({scene:{type:"enum",values:No(bh)},to:{type:"string",allowEmpty:!1},beginTime:{type:"number",required:!1},endTime:{type:"number",required:!1},limit:{type:"number",min:1,max:100,required:!1},reverse:{type:"boolean",required:!1},lastMsgId:{type:"string",required:!1,allowEmpty:!1},asc:{type:"boolean",required:!1},msgTypes:{type:"array",itemType:"string",required:!1}},M),jt=M.scene==="p2p"?"getHistoryMsgs":M.scene==="team"?"getHistoryTeamMsgs":"getHistorySuperTeamMsgs",Br.next=5,this.core.sendCmd(jt,kr(kr({beginTime:0,endTime:0,lastMsgId:0,limit:100,reverse:!1},M),{msgTypes:M.msgTypes?lo(ze=M.msgTypes).call(ze,function(Hr){return vh[Hr]}):[]}));case 5:if(ur=Br.sent,(hr=ur.content).msgs&&hr.msgs.length>0){Br.next=9;break}return Br.abrupt("return",[]);case 9:if(br=Sa(hr.msgs[0],this.core.account),Cr=(pe=this.core.session)===null||pe===void 0?void 0:pe.getSessionWithUncomplete({id:br}),_r=Ad(hr.msgs,Cr?{account:this.core.account,sessionAck:Cr.ack,msgReceiptTime:Cr.msgReceiptTime}:{account:this.core.account}),M.asc!==!0){Br.next=14;break}return Br.abrupt("return",Ec(_r).call(_r,function(Hr,$r){return Hr.time-$r.time}));case 14:return Br.abrupt("return",_r);case 15:case"end":return Br.stop()}},ae,this)}))},F.clearHistoryMsgsFromServer=function(M){return hn(this,void 0,void 0,rr.mark(function z(){var pe,ae,ze;return rr.wrap(function(ur){for(;;)switch(ur.prev=ur.next){case 0:return xn({scene:{type:"enum",values:["p2p","team"]},to:{type:"string",allowEmpty:!1},ext:{type:"string",required:!1},isSyncSelf:{type:"boolean",required:!1}},M),(pe=kr(kr({isDeleteRoam:1},M),{type:M.scene==="team"?2:1,isSyncSelf:M.isSyncSelf===!0?1:0}))[pe.type===2?"toTid":"otherAccid"]=M.to,ur.next=5,this.core.sendCmd("clearHistoryMsgsFromServer",{clearHistoryMsgsFromServerReqTag:pe});case 5:return ae=ur.sent,ze=ae.content,this.core.eventBus.emit("session/updateForClearMsg",[{sessionId:M.scene+"-"+M.to}],!0),ur.abrupt("return",ze);case 9:case"end":return ur.stop()}},z,this)}))},F.multiSyncClearServerHistoryMsgsHandler=function(M){var z=Pr(M.content.data);this.core.eventBus.emit("session/updateForClearMsg",[z],!0),this.core.emit("clearServerHistoryMsgs",[z])},F.ftsCloudMsgLogs=function(M){return hn(this,void 0,void 0,rr.mark(function z(){return rr.wrap(function(ae){for(;;)switch(ae.prev=ae.next){case 0:return ae.abrupt("return",this.baseFtsCloudMsgLogs(M,"nimFtsCloudMsgLogs"));case 1:case"end":return ae.stop()}},z,this)}))},F.ftsCloudMsgLogsAggWithSession=function(M){return hn(this,void 0,void 0,rr.mark(function z(){return rr.wrap(function(ae){for(;;)switch(ae.prev=ae.next){case 0:return ae.abrupt("return",this.baseFtsCloudMsgLogs(M,"nimFtsCloudMsgLogsAggWithSession"));case 1:case"end":return ae.stop()}},z,this)}))},F.baseFtsCloudMsgLogs=function(M,z){return hn(this,void 0,void 0,rr.mark(function pe(){var ae,ze,jt,ur=this;return rr.wrap(function(br){for(;;)switch(br.prev=br.next){case 0:if(xn({keyword:{type:"string",allowEmpty:!1},fromTime:{type:"number",required:!1},toTime:{type:"number",required:!1},sessionLimit:{type:"number",required:!1},msglogsLimit:{type:"number",required:!1},orderRule:{type:"enum",values:ba($),required:!1},p2pSessionList:{type:"array",itemType:"string",required:!1},teamSessionList:{type:"array",itemType:"string",required:!1},senderList:{type:"array",itemType:"string",required:!1},msgTypeList:{type:"array",itemType:"enum",values:ba(cc),required:!1},msgSubTypeList:{type:"array",itemType:"number",required:!1}},M),!(M.fromTime&&M.toTime&&M.toTime<M.fromTime)){br.next=3;break}throw new uo("Request parameter error: toTime should be greater than fromTime",M,"");case 3:return ze=jr(M),br.next=6,this.core.sendCmd(z,{tag:ze});case 6:return jt=br.sent,br.abrupt("return",lo(ae=jt.content.datas).call(ae,function(Cr){var _r,Nr=Sa(Cr,ur.core.account),Br=(_r=ur.core.session)===null||_r===void 0?void 0:_r.getSessionWithUncomplete({id:Nr});return Ba(Cr,Br?{account:ur.core.account,sessionAck:Br.ack,msgReceiptTime:Br.msgReceiptTime}:{account:ur.core.account})}));case 8:case"end":return br.stop()}},pe,this)}))},F.syncClearServerHistoryMsgsHandler=function(M){var z=function(ae){return ya(ae)&&ae.length>0?lo(ae).call(ae,function(ze){return Pr(ze)}):[]}(M.content.datas);this.core.emit("clearServerHistoryMsgs",z)},T}(ns),Gr={"22_1":"requestProxy","22_2":"onRequestProxy"},Mn={requestProxyTag:{zone:1,path:2,method:3,header:4,body:5},requestProxyMsgTag:{from:1,body:2,time:3}},Qr=ts(Mn),Vn={requestProxy:{sid:22,cid:1,service:"passThrough",params:[{type:"Property",name:"requestProxyTag",reflectMapper:Mn.requestProxyTag}],response:[{type:"Property",name:"requestProxyTag",reflectMapper:Qr.requestProxyTag}]},onRequestProxy:{sid:22,cid:2,service:"passThrough",response:[{type:"Property",name:"proxyMsg",reflectMapper:Qr.requestProxyMsgTag}]}},Bn=function(x){function T(D){var M;return(M=x.call(this,"passThrough",D)||this).core=D,Ui({cmdMap:Gr,cmdConfig:Vn}),M}Co(T,x);var F=T.prototype;return F.request=function(M){return xn({path:{type:"string",allowEmpty:!1}},M),this.core.sendCmd("requestProxy",{requestProxyTag:M}).then(function(z){return z.content.proxyTag})},F.onRequestProxyHandler=function(M){var z=M.content.proxyMsg;z&&z.time&&(z.time=+z.time),this.core.emit("proxyMsg",z)},T}(ns),Eo=hs.some,jn=Ds("some");qr({target:"Array",proto:!0,forced:!jn},{some:function(T){return Eo(this,T,arguments.length>1?arguments[1]:void 0)}});var wr=Ao("Array").some,Cn=Array.prototype,En=function(x){var T=x.some;return x===Cn||Lt(Cn,x)&&T===Cn.some?wr:T},vn,Kr,_n=function(T,F){if(T==null)return{};var D=Bg(Hv(T),function(M){return[M]});return F=nl(F),Av(T,D,function(M,z){return F(M,z[0])})},Ln={"6_2":"getNosToken","6_22":"getOriginUrl","6_26":"getNosCdnHost","6_27":"getGrayscaleConfig","6_28":"getMixStorePolicy","6_29":"getMixStoreToken","6_30":"getFileAuthToken"},Kn={nosToken:{objectName:1,token:2,bucket:3,expireTime:4,expireSec:7,tag:8,shortUrl:9},mixStoreTokenReqTag:{provider:0,tokenCount:1,fileExpireSec:2,tag:3,returnBody:4},nosConfigTag:{bucket:1,cdnDomain:2,expire:3,objectNamePrefix:4},grayConfigTag:{config:0,ttl:1},mixStorePolicyTag:{providers:0,ttl:1,mixEnable:2,nosPolicy:3,s3Policy:4},mixStoreTokenResTag:{provider:0,accessKeyId:1,secretAccessKey:2,sessionToken:3,token:4,expireTime:5,bucket:6,objectName:7,fileExpireSec:8,tag:9,shortUrl:10,region:11},nosSafeUrlTag:{safeUrl:0,originUrl:1},mixStoreAuthTokenReqTag:{type:1,urls:2},mixStoreAuthTokenResTag:{type:1,tokens:2,token:3,ttl:4}},Qn=ts(Kn),Po={getNosToken:{sid:6,cid:2,service:"cloudStorage",response:[{type:"Property",name:"nosToken",reflectMapper:Qn.nosToken}],params:[{type:"String",name:"responseBody"},{type:"Property",name:"nosToken",entity:"nosToken",reflectMapper:Kn.nosToken}]},getOriginUrl:{sid:6,cid:22,service:"cloudStorage",response:[{type:"Property",name:"nosSafeUrlTag",reflectMapper:Qn.nosSafeUrlTag}],params:[{type:"Property",name:"nosSafeUrlTag",reflectMapper:Kn.nosSafeUrlTag}]},getNosCdnHost:{sid:6,cid:26,service:"misc",response:[{type:"Property",name:"nosConfigTag",reflectMapper:Qn.nosConfigTag}]},getGrayscaleConfig:{sid:6,cid:27,service:"cloudStorage",response:[{type:"Property",name:"grayConfigTag",reflectMapper:Qn.grayConfigTag}],params:[{type:"Property",name:"config"}]},getMixStorePolicy:{sid:6,cid:28,service:"cloudStorage",params:[{type:"LongArray",name:"supportType"}],response:[{type:"Property",name:"mixStorePolicyTag",reflectMapper:Qn.mixStorePolicyTag}]},getMixStoreToken:{sid:6,cid:29,service:"cloudStorage",params:[{type:"Property",name:"mixStoreTokenReqTag",reflectMapper:Kn.mixStoreTokenReqTag}],response:[{type:"Property",name:"mixStoreTokenResTag",reflectMapper:Qn.mixStoreTokenResTag}]},getFileAuthToken:{sid:6,cid:30,service:"cloudStorage",params:[{type:"Property",name:"mixStoreAuthTokenReqTag",reflectMapper:Kn.mixStoreAuthTokenReqTag}],response:[{type:"Property",name:"mixStoreAuthTokenResTag",reflectMapper:Qn.mixStoreAuthTokenResTag}]}};(function(x){x[x.nos=1]="nos",x[x.s3=2]="s3"})(vn||(vn={})),function(x){x[x.dontNeed=-1]="dontNeed",x[x.time=2]="time",x[x.urls=3]="urls"}(Kr||(Kr={}));var ao,Wo,po={chunkUploadHost:"https://wanproxy-web.127.net",commonUploadHost:"https://nos.netease.com",chunkMaxSize:4194304e4,commonMaxSize:104857600,uploadReplaceFormat:"https://{host}/{object}",cdn:{defaultCdnDomain:"nim.nosdn.127.net",cdnDomain:"",bucket:"",objectNamePrefix:""},downloadUrl:"https://{bucket}-nosdn.netease.im/{object}",downloadHostList:["nos.netease.com"],nosCdnEnable:!0,isNeedToGetUploadPolicyFromServer:!0},vo={file:{md5:"$(Etag)",size:"$(ObjectSize)"},image:{md5:"$(Etag)",size:"$(ObjectSize)",w:"$(ImageInfo.Width)",h:"$(ImageInfo.Height)",orientation:"$(ImageInfo.Orientation)"},audio:{md5:"$(Etag)",size:"$(ObjectSize)",dur:"$(AVinfo.Audio.Duration)"},video:{md5:"$(Etag)",size:"$(ObjectSize)",dur:"$(AVinfo.Video.Duration)",w:"$(AVinfo.Video.Width)",h:"$(AVinfo.Video.Height)"}},Go={accessKeyId:"",secretAccessKey:"",sessionToken:"",region:"",maxRetries:0,bucket:"",objectName:"",token:"",shortUrl:""};function ka(x){return x===void 0&&(x="file"),Uo(vo[x]||{}).replace(/"/gi,'\\"')}(function(x){x[x.nos=1]="nos",x[x.s3=2]="s3"})(ao||(ao={})),function(x){x[x.dontNeed=-1]="dontNeed",x[x.time=2]="time",x[x.urls=3]="urls"}(Wo||(Wo={}));var bo=function(){function x(F,D){D===void 0&&(D={}),this.GRAYKEY="AllGrayscaleConfig",this.MIXSTOREKEY="AllMixStorePolicy",this.config={},this.nosCdnHostTimer=0,this.grayConfig={mixStoreEnable:!1,timeStamp:0,ttl:0},this.mixStorePolicy={providers:[],timeStamp:0,ttl:0,s3Policy:null,nosPolicy:null},this.curProvider=ao.nos,this.s3=null,this.mixStoreErrorCount=10,this.nosErrorCount=0,this.circuitTimer=0,this.name="cloudStorage",this.logger=F.logger,this.core=F,Ui({cmdMap:Ln,cmdConfig:Po}),this.setOptions(D)}var T=x.prototype;return T.setOptions=function(D){D===void 0&&(D={});var M=D.storageKeyPrefix||"NIMClient";this.GRAYKEY=M+"-AllGrayscaleConfig",this.MIXSTOREKEY=M+"-AllMixStorePolicy";var z=D.s3,pe=Is(D,["s3"]),ae=kr({},po,this.config);if(pe&&Object.prototype.hasOwnProperty.call(pe,"cdn")){var ze={cdn:kr(kr({},ae.cdn),pe.cdn)};this.config=kr({},ae,pe,ze)}else this.config=kr({},ae,pe);z&&(this.s3=z)},T.init=function(){return hn(this,void 0,void 0,rr.mark(function D(){return rr.wrap(function(z){for(;;)switch(z.prev=z.next){case 0:if(this.grayConfig=null,this.mixStorePolicy={providers:[],timeStamp:0,ttl:0,s3Policy:null,nosPolicy:null},this.curProvider=ao.nos,this.mixStoreErrorCount=10,!this.config.isNeedToGetUploadPolicyFromServer){z.next=9;break}return z.next=7,this.getGrayscaleConfig(this.core.options.appkey);case 7:return z.next=9,this.getNosCdnHost();case 9:case"end":return z.stop()}},D,this)}))},T.uploadFile=function(D){return hn(this,void 0,void 0,rr.mark(function M(){var z,pe,ae;return rr.wrap(function(jt){for(;;)switch(jt.prev=jt.next){case 0:if(xn({maxSize:{type:"number",required:!1},type:{type:"enum",values:["file","image","audio","video"]}},D),D.fileInput||D.file||D.filePath){jt.next=3;break}throw new Error("uploadFile needs target file object or a filePath");case 3:if(!D.type||D.type==="file"){jt.next=7;break}if(typeof(z=Es(D,"file.type"))!="string"||bi(z).call(z,D.type)!==-1){jt.next=7;break}throw new Error('The meta type "'+z+'" does not match "'+D.type+'"');case 7:if(this.grayConfig&&this.grayConfig.mixStoreEnable&&this.mixStorePolicy.providers.length){jt.next=10;break}return this.logger.log("uploadFile:: uploadFile begin, use old nos"),jt.abrupt("return",this.nosUpload(D));case 10:return this.logger.log("uploadFile:: uploadFile begin,Current settings grayConfig mixStoreEnable:"+this.grayConfig.mixStoreEnable+" curProvider:"+this.curProvider),this.s3||(this.curProvider=ao.nos),pe=Go,jt.prev=13,jt.next=16,this.core.sendCmd("getMixStoreToken",{mixStoreTokenReqTag:{provider:this.curProvider,tokenCount:1,tag:"qchat",returnBody:ka(D.type)}});case 16:ae=jt.sent,pe=ae.content.mixStoreTokenResTag,jt.next=24;break;case 20:throw jt.prev=20,jt.t0=jt.catch(13),this.core.logger.error("uploadFile:: getMixStoreToken error",jt.t0),new Nu("getMixStoreToken error",jt.t0,this.curProvider,this.mixStorePolicy);case 24:return jt.abrupt("return",this.curProvider===ao.s3?this.s3Upload(D,pe):this.nosUpload(D,pe));case 25:case"end":return jt.stop()}},M,this,[[13,20]])}))},T.nosUpload=function(D,M){var z,pe;return hn(this,void 0,void 0,rr.mark(function ae(){var ze,jt,ur,hr,br,Cr,_r,Nr,Br,Hr,$r,Vr,bn;return rr.wrap(function(qn){for(;;)switch(qn.prev=qn.next){case 0:if(ze=Es(this.core,"config.cdn.bucket"),jt={tag:D.nosScenes||ze||"nim",expireSec:D.nosSurvivalTime},M){qn.next=13;break}return qn.prev=3,qn.next=6,this.core.sendCmd("getNosToken",{responseBody:ka(D.type),nosToken:jt});case 6:ur=qn.sent,qn.next=13;break;case 9:throw qn.prev=9,qn.t0=qn.catch(3),this.core.logger.error("uploadFile:: getNosToken error",qn.t0),new Nu("getNosToken error",qn.t0,1);case 13:return qn.prev=13,br=ur?ur.content.nosToken:M,this.core.logger.debug("uploadFile:: uploadFile params",{nosToken:br,chunkUploadHost:this.config.chunkUploadHost,commonUploadHost:this.config.commonUploadHost,platform:Fo.platform}),qn.next=18,this.core.adapters.uploadFile(kr(kr({},D),{nosToken:br,chunkUploadHost:this.config.chunkUploadHost,commonUploadHost:this.config.commonUploadHost,maxSize:D.maxSize||this.config.chunkMaxSize}));case 18:hr=qn.sent,qn.next=42;break;case 21:if(qn.prev=21,qn.t1=qn.catch(13),this.core.logger.error("uploadFile::nos uploadFile error",qn.t1),!M){qn.next=41;break}if(this.nosErrorCount!==0){qn.next=37;break}qn.prev=26,this._addCircuitTimer(),qn.next=33;break;case 30:throw qn.prev=30,qn.t2=qn.catch(26),new Nu("upload file error",qn.t2,this.curProvider,this.mixStorePolicy,D.file||D.filePath);case 33:return this.nosErrorCount=(z=this.mixStorePolicy.nosPolicy)===null||z===void 0?void 0:z.uploadConfig.retryPolicy.retry,qn.abrupt("return",this.uploadFile(D));case 37:return this.nosErrorCount--,qn.abrupt("return",this.nosUpload(D,M));case 39:qn.next=42;break;case 41:throw new Nu("nos uploadFile error",qn.t1,1);case 42:if(Cr=hr==null?void 0:hr.type,_r=Cr&&bi(Cr).call(Cr,"/")>-1?fo(Cr).call(Cr,0,bi(Cr).call(Cr,"/")):"",Nr={image:"imageInfo",video:"vinfo",audio:"vinfo"},Br=this.config.uploadReplaceFormat.replace("{host}",this.config.cdn.cdnDomain||this.config.cdn.defaultCdnDomain).replace("{object}",ur?ur.content.nosToken.objectName:M==null?void 0:M.objectName),M&&M.shortUrl&&(Br=M.shortUrl),Nr[_r]){qn.next=49;break}return qn.abrupt("return",kr({url:Br},hr));case 49:if(qn.prev=49,!(bi(Br).call(Br,"_im_url=1")<0)){qn.next=54;break}return qn.next=53,this.core.adapters.request(Br+"?"+Nr[_r],{method:"GET",dataType:"json",timeout:5e3});case 53:Hr=qn.sent;case 54:qn.next=60;break;case 56:return qn.prev=56,qn.t3=qn.catch(49),this.core.logger.error("uploadFile:: fetch file info error",qn.t3),qn.abrupt("return",kr({url:Br},hr));case 60:if(!Hr){qn.next=67;break}return $r=Hr.data,Vr=Nr[_r]==="imageInfo"?$r:(pe=$r==null?void 0:$r.GetVideoInfo)===null||pe===void 0?void 0:pe.VideoInfo,bn={url:Br,name:hr.name,size:hr.size,ext:hr.ext,w:Vr.Width,h:Vr.Height,orientation:Vr.Orientation,dur:Vr.Duration,audioCodec:Vr.AudioCodec,videoCodec:Vr.VideoCodec,container:Vr.Container},qn.abrupt("return",_n(bn,function(yo,Fn){return Fn!==void 0}));case 67:return qn.abrupt("return",kr({url:Br},hr));case 68:case"end":return qn.stop()}},ae,this,[[3,9],[13,21],[26,30],[49,56]])}))},T.getNosCdnHost=function(){var D;return hn(this,void 0,void 0,rr.mark(function M(){var z,pe,ae,ze=this;return rr.wrap(function(ur){for(;;)switch(ur.prev=ur.next){case 0:return ur.prev=0,ur.next=3,this.core.sendCmd("getNosCdnHost");case 3:z=ur.sent,ur.next=10;break;case 6:return ur.prev=6,ur.t0=ur.catch(0),this.logger.error("getNosCdnHost::error",ur.t0),ur.abrupt("return");case 10:if(z){ur.next=12;break}return ur.abrupt("return");case 12:pe=(D=z==null?void 0:z.content)===null||D===void 0?void 0:D.nosConfigTag,(ae=go(pe==null?void 0:pe.expire))!==0&&pe.cdnDomain?ae===-1?(this.config.cdn.bucket=pe.bucket,this.config.cdn.cdnDomain=pe.cdnDomain,this.config.cdn.objectNamePrefix=pe.objectNamePrefix):(this.config.cdn.bucket=pe.bucket,this.config.cdn.cdnDomain=pe.cdnDomain,this.config.cdn.objectNamePrefix=pe.objectNamePrefix,this.nosCdnHostTimer=this.core.timerManager.addTimer(function(){ze.getNosCdnHost()},1e3*ae)):(this.config.cdn.bucket="",this.config.cdn.cdnDomain="",this.config.cdn.objectNamePrefix="");case 15:case"end":return ur.stop()}},M,this,[[0,6]])}))},T.getGrayscaleConfig=function(D){var M;return hn(this,void 0,void 0,rr.mark(function z(){var pe,ae;return rr.wrap(function(jt){for(;;)switch(jt.prev=jt.next){case 0:if(Fo.localStorage)try{Fo.localStorage.getItem&&Fo.localStorage.getItem(this.GRAYKEY)&&(this.grayConfig=JSON.parse(Fo.localStorage.getItem(this.GRAYKEY))[D])}catch(ur){Fo.localStorage.getItem(this.GRAYKEY)&&this.core.logger.error("uploadFile:: JSON.parse grayscaleConfig error ",ur)}if(this.grayConfig&&!(this.grayConfig.timeStamp+1e3*this.grayConfig.ttl<new Date().getTime())){jt.next=17;break}return jt.next=4,this.core.sendCmd("getGrayscaleConfig",{config:{}});case 4:if(!(pe=jt.sent).content||!pe.content.grayConfigTag){jt.next=16;break}this.logger.log("uploadFile::getAppGrayConfigRequest success ");try{this.grayConfig=JSON.parse(pe.content.grayConfigTag.config),this.grayConfig.ttl=JSON.parse(pe.content.grayConfigTag.ttl)}catch(ur){this.logger.error("getGrayscaleConfig error",ur)}if(this.grayConfig){jt.next=10;break}return jt.abrupt("return");case 10:ae=Fo.localStorage.getItem(this.GRAYKEY)?JSON.parse(Fo.localStorage.getItem(this.GRAYKEY)):{},this.grayConfig.timeStamp=new Date().getTime(),ae[D]=this.grayConfig,Fo.localStorage.setItem(this.GRAYKEY,Uo(ae)),jt.next=17;break;case 16:this.logger.debug("uploadFile:: result grayConfig:",pe.content);case 17:if(!(!((M=this.grayConfig)===null||M===void 0)&&M.mixStoreEnable)){jt.next=20;break}return jt.next=20,this._getMixStorePolicy(D);case 20:case"end":return jt.stop()}},z,this)}))},T._getMixStorePolicy=function(D){return hn(this,void 0,void 0,rr.mark(function M(){var z,pe,ae,ze,jt,ur,hr;return rr.wrap(function(Cr){for(;;)switch(Cr.prev=Cr.next){case 0:if(z=new Date().getTime(),Fo.localStorage)try{this.mixStorePolicy=JSON.parse(Fo.localStorage.getItem(this.MIXSTOREKEY))[D],this.curProvider=go(this.mixStorePolicy.providers[0]),this.mixStorePolicy.timeStamp&&this.mixStorePolicy.timeStamp+1e3*this.mixStorePolicy.ttl>z&&(ae=this.mixStorePolicy.timeStamp+1e3*this.mixStorePolicy.ttl-z,this.core.timerManager.addTimer(Mo(pe=this._getMixStorePolicy).call(pe,this,D),ae))}catch(_r){Fo.localStorage.getItem(this.MIXSTOREKEY)&&JSON.parse(Fo.localStorage.getItem(this.MIXSTOREKEY))[D]&&this.core.logger.error("uploadFile:: JSON.parse mixStorePolicy error ",_r)}if(this.mixStorePolicy&&!(this.mixStorePolicy.timeStamp+1e3*this.mixStorePolicy.ttl<=z)){Cr.next=30;break}return Cr.prev=3,Cr.next=6,this.core.sendCmd("getMixStorePolicy",{supportType:this.s3?[1,2]:[1]});case 6:jt=Cr.sent,ur=jt.content.mixStorePolicyTag,this.mixStorePolicy={providers:[],timeStamp:0,ttl:0,s3Policy:null,nosPolicy:null},this.mixStorePolicy.ttl=Number(ur.ttl),this.mixStorePolicy.providers=ur.providers.split(","),this.circuitTimer&&this.core.timerManager.deleteTimer(this.circuitTimer),this.curProvider=go(this.mixStorePolicy.providers[0]),this.mixStorePolicy.nosPolicy=ur.nosPolicy?JSON.parse(ur.nosPolicy):null,this.mixStorePolicy.s3Policy=ur.s3Policy?JSON.parse(ur.s3Policy):null,this.mixStorePolicy.s3Policy===null?this.mixStorePolicy.providers=["1"]:this.mixStorePolicy.nosPolicy===null?this.mixStorePolicy.providers=["2"]:this.mixStorePolicy.providers=this.mixStorePolicy.s3Policy.priority<this.mixStorePolicy.nosPolicy.priority?["2","1"]:["1","2"],this.core.timerManager.addTimer(Mo(ze=this._getMixStorePolicy).call(ze,this,D),1e3*this.mixStorePolicy.ttl),hr=Fo.localStorage.getItem(this.MIXSTOREKEY)?JSON.parse(Fo.localStorage.getItem(this.MIXSTOREKEY)):{},this.mixStorePolicy.timeStamp=new Date().getTime(),hr[D]=this.mixStorePolicy,Fo.localStorage.setItem(this.MIXSTOREKEY,Uo(hr)),Cr.next=30;break;case 23:if(Cr.prev=23,Cr.t0=Cr.catch(3),this.logger.error("getMixStorePolicy error",Cr.t0),this.mixStoreErrorCount!==0){Cr.next=28;break}throw new Error("getMixStorePolicy all count error");case 28:this._getMixStorePolicy(D),this.mixStoreErrorCount--;case 30:this.mixStorePolicy.nosPolicy&&(this.nosErrorCount=this.mixStorePolicy.nosPolicy.uploadConfig.retryPolicy.retry);case 31:case"end":return Cr.stop()}},M,this,[[3,23]])}))},T.s3Upload=function(D,M){return hn(this,void 0,void 0,rr.mark(function z(){var pe,ae,ze,jt,ur,hr,br,Cr,_r,Nr,Br=this;return rr.wrap(function($r){for(;;)switch($r.prev=$r.next){case 0:if(!D.file){$r.next=4;break}pe=D.file,$r.next=19;break;case 4:if(typeof D.fileInput!="string"){$r.next=14;break}if(this.logger.warn("fileInput will abandon,Please use file or filepath"),!((ae=document.getElementById(D.fileInput))&&ae.files&&ae.files[0])){$r.next=11;break}pe=ae.files[0],$r.next=12;break;case 11:throw new Error("Can not get file from fileInput");case 12:$r.next=19;break;case 14:if(!(D.fileInput&&D.fileInput.files&&D.fileInput.files[0])){$r.next=18;break}pe=D.fileInput.files[0],$r.next=19;break;case 18:throw new Error("Can not get file from fileInput "+D.fileInput);case 19:if(this.mixStorePolicy.s3Policy){$r.next=21;break}throw new Error("dont get s3 policy");case 21:return ze={accessKeyId:M.accessKeyId,secretAccessKey:M.secretAccessKey,sessionToken:M.sessionToken,region:M.region,maxRetries:this.mixStorePolicy.s3Policy.uploadConfig.retryPolicy.retry},jt=this.s3,(ur=new jt).config.update(ze),hr=decodeURIComponent(M.bucket),br=decodeURIComponent(M.objectName),_r={Bucket:hr,Key:br,Body:Cr=pe,Metadata:{token:M.token},ContentType:Cr.type||"application/octet-stream"},this.core.logger.debug("uploadFile:: s3 upload params:",_r),Nr=ur.upload(_r),$r.abrupt("return",new ro(function(Vr){var bn=new Date().getTime();Nr.send(function(Wn,qn){var yo,Fn;if(Wn){Br.logger.error("uploadFile:","api::s3:upload file failed",Wn),Br.core.reporter.reportTraceStart("exceptions",{user_id:Br.core.options.account,trace_id:(Fn=(yo=Br.core)===null||yo===void 0?void 0:yo.socket)===null||Fn===void 0?void 0:Fn.sessionId,start_time:bn,action:1}),Br.core.reporter.reportTraceUpdateV2("exceptions",{code:typeof Wn.status=="number"?Wn.status:typeof Wn.code=="number"?Wn.code:0,description:Wn.message||""+Wn.code,operation_type:1,target:Wn.hostname}),Br.core.reporter.reportTraceEnd("exceptions",1);try{Br._addCircuitTimer()}catch(wn){throw new Nu("upload file error",wn,Br.curProvider,Br.mixStorePolicy,D.file||D.filePath)}Vr(Br.uploadFile(D))}else{var xr=Br.mixStorePolicy.s3Policy.cdnSchema;xr=(xr=xr.replace("{cdnDomain}",Br.mixStorePolicy.s3Policy.dlcdn)).replace("{objectName}",qn.Key),Vr({size:Cr.size,name:Cr.name,url:M.shortUrl?M.shortUrl:xr,ext:Cr.name.split(".")[1]||"unknown"})}})}));case 32:case"end":return $r.stop()}},z,this)}))},T.getPrivateUrl=function(D){var M;if(!new RegExp(/http(s)?:\/\/([\w-]+\.)+[\w-]+(\/[\w- ./?%&=]*)?/).test(D))return this.logger.error("illegal file url:"+D),"";var z=/^(?:([A-Za-z]+):)?(\/{0,3})([0-9.\-A-Za-z]+)(?::(\d+))?(?:\/([^?#]*))?(?:\?([^#]*))?(?:#(.*))?$/.exec(D);z[0];var pe=z[1];z[2];var ae=z[3];z[4];var ze=z[5];if(z[6],z[7],(M=this.grayConfig)===null||M===void 0?void 0:M.mixStoreEnable){var jt=this._getUrlType(D);return jt===ao.s3&&this.mixStorePolicy.s3Policy&&(D=this.mixStorePolicy.s3Policy.cdnSchema.replace("{cdnDomain}",this.mixStorePolicy.s3Policy.dlcdn).replace("{objectName}",ze)),jt===ao.nos&&this.mixStorePolicy.nosPolicy&&(D=this.mixStorePolicy.nosPolicy.cdnSchema.replace("{cdnDomain}",this.mixStorePolicy.nosPolicy.dlcdn).replace("{objectName}",ze)),D}var ur=this.config,hr=ur.downloadUrl,br=ur.downloadHostList,Cr=ur.nosCdnEnable,_r=this.config.cdn.cdnDomain,Nr=this.config.cdn.objectNamePrefix?decodeURIComponent(this.config.cdn.objectNamePrefix):"",Br=decodeURIComponent(ze),Hr=bi(Br).call(Br,Nr);if(_r&&Hr>-1&&Cr)return""+pe+_r+"/"+fo(Br).call(Br,Hr);if(Mc(br).call(br,ae)&&Mc(ze).call(ze,"/")){var $r=bi(ze).call(ze,"/"),Vr=ze.substring(0,$r),bn=ze.substring($r+1);return hr.replace("{bucket}",Vr).replace("{object}",bn)}var Wn=ss(br).call(br,function(yo){return typeof ae=="string"&&Mc(ae).call(ae,yo)})[0],qn=Wn?ae.replace(Wn,"").replace(/\W/g,""):null;return qn?hr.replace("{bucket}",qn).replace("{object}",ze):D},T.getOriginUrl=function(D){return hn(this,void 0,void 0,rr.mark(function M(){var z;return rr.wrap(function(ae){for(;;)switch(ae.prev=ae.next){case 0:return ae.next=2,this.core.sendCmd("getOriginUrl",{nosSafeUrlTag:{safeUrl:D}});case 2:return z=ae.sent,ae.abrupt("return",z.content.nosSafeUrlTag.originUrl);case 4:case"end":return ae.stop()}},M,this)}))},T.getFileToken=function(D){return hn(this,void 0,void 0,rr.mark(function M(){var z,pe,ae,ze,jt,ur=this;return rr.wrap(function(br){for(;;)switch(br.prev=br.next){case 0:if(xn({type:{type:"number",min:2,max:3},urls:{type:"array",required:!1,itemType:"string"}},D),z=this.mixStorePolicy.nosPolicy?this.mixStorePolicy.nosPolicy.authPolicy.policyType:null,pe=this.mixStorePolicy.s3Policy?this.mixStorePolicy.s3Policy.authPolicy.policyType:null,z!==String(Wo.dontNeed)||pe!==String(Wo.dontNeed)){br.next=8;break}throw this.logger.error("don't need token"),new Error("don't need token");case 8:if(D.type!==Wo.time){br.next=17;break}if(!(z&&bi(z).call(z,String(Wo.time))>=0||pe&&bi(pe).call(pe,String(Wo.time))>0)){br.next=13;break}return br.abrupt("return",this.getFileAuthToken(D));case 13:throw this.logger.error("don't support time token "),new Error("don't support type time token ");case 15:br.next=33;break;case 17:if(D.urls&&D.urls.length){br.next=20;break}throw this.logger.error("urls is required when urls token"),new Error("urls is required when urls token");case 20:if(ze=[],jt=[],kn(ae=D.urls).call(ae,function(Cr){var _r=ur._getUrlType(Cr);_r===ao.nos&&jt.push(Cr),_r===ao.s3&&ze.push(Cr)}),(!pe||ze.length!==0&&bi(pe).call(pe,String(Wo.urls))<0)&&(this.logger.warn("s3 url don't support url token"),ze=[]),(!z||jt.length!==0&&bi(z).call(z,String(Wo.urls))<0)&&(this.logger.warn("nos url don't support url token"),jt=[]),ze.length!==0||jt.length!==0){br.next=30;break}throw this.logger.error("not support urls"),new Error("not support urls");case 30:if(ze.length!==0&&jt.length!==0){br.next=33;break}return D.urls=Uo(D.urls),br.abrupt("return",this.getFileAuthToken(D));case 33:case"end":return br.stop()}},M,this)}))},T.getFileAuthToken=function(D){return hn(this,void 0,void 0,rr.mark(function M(){var z;return rr.wrap(function(ae){for(;;)switch(ae.prev=ae.next){case 0:return ae.next=2,this.core.sendCmd("getFileAuthToken",{mixStoreAuthTokenReqTag:D});case 2:return z=ae.sent,ae.abrupt("return",z.content.mixStoreAuthTokenResTag);case 4:case"end":return ae.stop()}},M,this)}))},T._getUrlType=function(D){var M,z;return this.mixStorePolicy.nosPolicy&&En(M=this.mixStorePolicy.nosPolicy.dlcdns).call(M,function(pe){return bi(D).call(D,pe)>=0})?ao.nos:this.mixStorePolicy.s3Policy&&En(z=this.mixStorePolicy.s3Policy.dlcdns).call(z,function(pe){return bi(D).call(D,pe)>=0})?ao.s3:null},T._addCircuitTimer=function(){var D=this,M=this.mixStorePolicy.providers,z=M[(bi(M).call(M,String(this.curProvider))+1)%M.length];if(z===M[0])throw new Error("uploadFile all policy fail");var pe=Es(this.mixStorePolicy,"s3Policy.uploadConfig.retryPolicy");if(pe&&pe.retryNext&&z&&(this.logger.log("uploadFile:: upload policy will change,now policy:"+this.curProvider+" nextProvider:"+z),this.curProvider=go(z),this.mixStorePolicy.nosPolicy&&this.mixStorePolicy.s3Policy)){var ae=this.mixStorePolicy[this.curProvider===ao.nos?"nosPolicy":"s3Policy"].uploadConfig.retryPolicy.circuit;if(!ae||ae===0)return;this.circuitTimer=this.core.timerManager.addTimer(function(){D.logger.log("uploadFile:: upload policy will change,now policy:"+D.curProvider+" nextProvider:"+go(D.mixStorePolicy.providers[0])),D.curProvider=go(D.mixStorePolicy.providers[0]),D.core.timerManager.deleteTimer(D.circuitTimer)},1e3*ae)}},T.process=function(D){var M=this[D.cmd+"Handler"];return typeof M=="function"?M.call(this,D):D.error&&!D.error.ignore?ro.reject(D.error):ro.resolve(D)},x}(),xa=zi({none:0,normal:1,all:3}),Fi=zi({normal:0,advanced:1}),no=zi({normal:0,owner:1,manager:2}),Do={noVerify:0,needVerify:1,rejectAll:2},$n=zi(Do),ko={needVerify:0,noVerify:1},Wi=zi(ko),zn={manager:0,all:1},Zv=zi(zn),Gh={manager:0,all:1},ks=zi(Gh),xs={manager:0,all:1},Ti=zi(xs);function qo(x){var T,F=["teamId"],D=["level","memberNum","memberUpdateTime","createTime","updateTime"],M=["valid","validToCurrentUser","mute"],z={type:Fi,muteType:xa,joinMode:$n,beInviteMode:Wi,inviteMode:Zv,updateTeamMode:ks,updateExtMode:Ti};x.bits;var pe=Is(x,["bits"]);return kn(F).call(F,function(ae){pe[ae]&&(pe[ae]=pe[ae].toString())}),kn(D).call(D,function(ae){pe[ae]!==void 0&&(pe[ae]=go(pe[ae]))}),kn(M).call(M,function(ae){pe[ae]!==void 0&&(pe[ae]=go(pe[ae])===1)}),kn(T=No(z)).call(T,function(ae){pe[ae]!==void 0&&(pe[ae]=z[ae][pe[ae]]||pe[ae])}),pe}function ui(x){return x&&x.length>0?lo(x).call(x,function(T){return qo(T)}):[]}function Xd(x){var T,F=kr({},x),D=["avatar","name","intro","announcement","ext"],M={joinMode:Do,beInviteMode:ko,inviteMode:zn,updateTeamMode:Gh,updateExtMode:xs};return kn(D).call(D,function(z){F[z]!==void 0&&(F[z]=F[z].toString())}),kn(T=No(M)).call(T,function(z){F[z]!==void 0&&(F[z]=M[z][F[z]])}),F}function kM(x){var T=["teamId","ext","account","nickInTeam"],F={};return x.bitConfigMask!==void 0&&(F.bits=go(x.bitConfigMask)),kn(T).call(T,function(D){x[D]&&(F[D]=x[D].toString())}),F}function Ws(x){var T,F=["teamId"],D=["joinTime","updateTime","bitConfigMask"],M=["active","valid","mute"],z={type:no},pe=x.bits,ae=Is(x,["bits"]);return pe!==void 0&&(ae.muteTeam=go(pe)===1,ae.bitConfigMask=pe),ae.id=ae.teamId+"-"+ae.account,kn(F).call(F,function(ze){ae[ze]&&(ae[ze]=ae[ze].toString())}),kn(D).call(D,function(ze){ae[ze]!==void 0&&(ae[ze]=go(ae[ze]))}),kn(M).call(M,function(ze){ae[ze]!==void 0&&(ae[ze]=go(ae[ze])===1)}),kn(T=No(z)).call(T,function(ze){ae[ze]!==void 0&&(ae[ze]=z[ze][ae[ze]]||ae[ze])}),ae}function Zd(x){return x&&x.length>0?lo(x).call(x,function(T){return Ws(T)}):[]}function df(x,T,F){return F===void 0&&(F="normal"),{id:x.teamId+"-"+T,teamId:x.teamId,account:T,type:F,nickInTeam:"",muteTeam:!1,mute:!1,joinTime:x.memberUpdateTime,updateTime:x.memberUpdateTime,active:!0,valid:!0}}function Kh(x,T,F){return F===void 0&&(F="normal"),T&&T.length>0?lo(T).call(T,function(D){return df(x,D,F)}):[]}var RM=function(){function x(F){this.core=F}var T=x.prototype;return T.notifyAddSuperTeamMembers=function(D,M){this.core.emit("addSuperTeamMembers",{team:D,accounts:M,members:Kh(D,M)})},T.notifyUpdateSuperTeamManagers=function(D,M,z,pe){this.core.emit("updateSuperTeamManagers",{team:{teamId:D,memberUpdateTime:pe},accounts:M,isManager:z,members:lo(M).call(M,function(ae){return{id:D+"-"+ae,type:"manager",account:ae,updateTime:pe}})})},T.notifyRemoveSuperTeamMembers=function(D,M){this.core.emit("removeSuperTeamMembers",{team:D,accounts:M})},T.notifyTransferSuperTeam=function(D,M,z){this.core.emit("transferSuperTeam",{team:D,from:{id:D.teamId+"-"+M,account:M,type:"normal",updateTime:D.memberUpdateTime},to:{id:D.teamId+"-"+z,account:z,type:"owner",updateTime:D.memberUpdateTime}})},T.notifyUpdateSuperTeamMembersMute=function(D,M,z){this.core.emit("updateSuperTeamMembersMute",{team:D,accounts:M,members:lo(M).call(M,function(pe){return{id:D.teamId+"-"+pe,account:pe,teamId:D.teamId,mute:z,updateTime:D.memberUpdateTime}}),mute:z})},x}(),NM={"21_5":"addSuperTeamMembers","21_6":"removeSuperTeamMembers","21_7":"leaveSuperTeam","21_8":"updateSuperTeamInfo","21_9":"getSuperTeamInfo","21_12":"getSuperTeams","21_15":"getSuperTeamMembers","21_10":"updateMySuperTeamMemberInfo","21_20":"applySuperTeam","21_21":"passSuperTeamApply","21_22":"rejectSuperTeamApply","21_23":"acceptSuperTeamInvite","21_24":"rejectSuperTeamInvite","21_26":"addSuperTeamManagers","21_27":"removeSuperTeamManagers","21_28":"muteSuperTeam","21_29":"muteSuperTeamMembers","21_30":"updateSuperTeamMemberNick","21_31":"transferSuperTeam","21_33":"getSuperTeamMembersByAccounts","21_34":"queryMuteSuperTeamMembers","21_101":"syncCreateSuperTeam","21_109":"syncSuperTeams","21_110":"syncUpdateSuperTeamMember","21_111":"syncMySuperTeamMembers"},eb={superTeam:{teamId:1,name:3,type:4,owner:5,level:6,selfCustom:7,valid:8,memberNum:9,memberUpdateTime:10,createTime:11,updateTime:12,validToCurrentUser:13,intro:14,announcement:15,joinMode:16,bits:17,ext:18,serverExt:19,avatar:20,beInviteMode:21,inviteMode:22,updateTeamMode:23,updateExtMode:24,mute:100,muteType:101},superTeamMember:{teamId:1,account:3,type:4,nickInTeam:5,bits:7,active:8,valid:9,updateTime:11,ext:12,mute:13,invitorAccid:14,joinTime:15}},Lc=ts(eb),FM={getSuperTeamInfo:{sid:21,cid:9,service:"superTeam",params:[{type:"Long",name:"teamId"}],response:[{type:"Property",name:"superTeam",reflectMapper:Lc.superTeam}]},getSuperTeams:{sid:21,cid:12,service:"superTeam",params:[{type:"long",name:"timetag"}],response:[{type:"PropertyArray",name:"superTeams",reflectMapper:Lc.superTeam},{type:"Number",name:"timetag"}]},updateSuperTeamInfo:{sid:21,cid:8,service:"superTeam",params:[{type:"Property",name:"superTeam",reflectMapper:eb.superTeam}],response:[{type:"Number",name:"time"}]},addSuperTeamMembers:{sid:21,cid:5,service:"superTeam",params:[{type:"Long",name:"teamId"},{type:"StrArray",name:"accounts"},{type:"String",name:"ps"}],response:[{type:"StrArray",name:"abortedAccidList"},{type:"Long",name:"time"}]},removeSuperTeamMembers:{sid:21,cid:6,service:"superTeam",params:[{type:"Long",name:"teamId"},{type:"StrArray",name:"accounts"}]},addSuperTeamManagers:{sid:21,cid:26,service:"superTeam",params:[{type:"Long",name:"teamId"},{type:"StrArray",name:"accounts"}]},removeSuperTeamManagers:{sid:21,cid:27,service:"superTeam",params:[{type:"Long",name:"teamId"},{type:"StrArray",name:"accounts"}]},applySuperTeam:{sid:21,cid:20,service:"superTeam",params:[{type:"Long",name:"teamId"},{type:"String",name:"ps"}],response:[{type:"Property",name:"superTeam",reflectMapper:Lc.superTeam}]},transferSuperTeam:{sid:21,cid:31,service:"superTeam",params:[{type:"Long",name:"teamId"},{type:"String",name:"account"},{type:"bool",name:"leave"}]},muteSuperTeam:{sid:21,cid:28,service:"superTeam",params:[{type:"Long",name:"teamId"},{type:"Int",name:"mute"}]},muteSuperTeamMembers:{sid:21,cid:29,service:"superTeam",params:[{type:"Long",name:"teamId"},{type:"StrArray",name:"accounts"},{type:"Int",name:"mute"}]},updateSuperTeamMemberNick:{sid:21,cid:30,service:"superTeam",params:[{type:"Property",name:"teamMember",reflectMapper:eb.superTeamMember}]},updateMySuperTeamMemberInfo:{sid:21,cid:10,service:"superTeam",params:[{type:"Property",name:"teamMember",reflectMapper:eb.superTeamMember}]},getSuperTeamMembersByAccounts:{sid:21,cid:33,service:"superTeam",params:[{type:"StrArray",name:"memberIds"}],response:[{type:"PropertyArray",name:"superTeamMembers",reflectMapper:Lc.superTeamMember}]},getSuperTeamMembers:{sid:21,cid:15,service:"superTeam",params:[{type:"Long",name:"teamId"},{type:"Long",name:"joinTime"},{type:"Int",name:"limit"},{type:"Bool",name:"reverse"}],response:[{type:"PropertyArray",name:"superTeamMembers",reflectMapper:Lc.superTeamMember}]},queryMuteSuperTeamMembers:{sid:21,cid:34,service:"superTeam",params:[{type:"Long",name:"teamId"},{type:"Long",name:"joinTime"},{type:"Int",name:"limit"},{type:"Bool",name:"reverse"}],response:[{type:"PropertyArray",name:"superTeamMembers",reflectMapper:Lc.superTeamMember}]},leaveSuperTeam:{sid:21,cid:7,service:"superTeam",params:[{type:"Long",name:"teamId"}]},passSuperTeamApply:{sid:21,cid:21,service:"superTeam",params:[{type:"Long",name:"teamId"},{type:"String",name:"from"}]},rejectSuperTeamApply:{sid:21,cid:22,service:"superTeam",params:[{type:"Long",name:"teamId"},{type:"String",name:"from"},{type:"String",name:"ps"}]},acceptSuperTeamInvite:{sid:21,cid:23,service:"superTeam",params:[{type:"Long",name:"teamId"},{type:"String",name:"from"}]},rejectSuperTeamInvite:{sid:21,cid:24,service:"superTeam",params:[{type:"Long",name:"teamId"},{type:"String",name:"from"},{type:"String",name:"ps"}]},syncSuperTeams:{sid:21,cid:109,service:"superTeam",response:[{type:"PropertyArray",name:"teams",reflectMapper:Lc.superTeam},{type:"Bool",name:"isAll"},{type:"Long",name:"timetag"}]},syncCreateSuperTeam:{sid:21,cid:101,service:"superTeam",response:[{type:"Property",name:"superTeam",reflectMapper:Lc.superTeam}]},syncUpdateSuperTeamMember:{sid:21,cid:110,service:"superTeam",response:[{type:"Property",name:"teamMember",reflectMapper:Lc.superTeamMember}]},syncMySuperTeamMembers:{sid:21,cid:111,ext:"sync",service:"superTeam",response:[{type:"PropertyArray",name:"teamMembers",reflectMapper:Lc.superTeamMember},{type:"Number",name:"timetag"}]}},jM=function(x){function T(D){var M;return(M=x.call(this,"superTeam",D)||this).mySuperTeamMembersMap=new nc,M.service=new RM(D),Ui({cmdMap:NM,cmdConfig:FM}),M.core.eventBus.on("team/onNotification",function(z){return M.notificationHandler(z)}),M}Co(T,x);var F=T.prototype;return F.mergeMySuperTeamMembers=function(M){var z=this;kn(M).call(M,function(pe){var ae=pe.teamId,ze=z.mySuperTeamMembersMap.get(ae),jt=kr({},ze,pe);z.mySuperTeamMembersMap.set(ae,jt)})},F.getSuperTeamInfo=function(M){return hn(this,void 0,void 0,rr.mark(function z(){var pe,ae;return rr.wrap(function(jt){for(;;)switch(jt.prev=jt.next){case 0:return xn({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1}},M),jt.next=3,this.core.sendCmd("getSuperTeamInfo",{teamId:M.teamId});case 3:return pe=jt.sent,ae=pe.content.superTeam,jt.abrupt("return",qo(ae));case 6:case"end":return jt.stop()}},z,this)}))},F.getSuperTeams=function(){return hn(this,void 0,void 0,rr.mark(function M(){var z,pe;return rr.wrap(function(ze){for(;;)switch(ze.prev=ze.next){case 0:return ze.next=2,this.core.sendCmd("getSuperTeams",{timetag:0});case 2:return z=ze.sent,pe=z.content.superTeams,ze.abrupt("return",ui(pe));case 5:case"end":return ze.stop()}},M,this)}))},F.updateSuperTeamInfo=function(M){return hn(this,void 0,void 0,rr.mark(function z(){var pe;return rr.wrap(function(ze){for(;;)switch(ze.prev=ze.next){case 0:return xn({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1},name:{type:"string",allowEmpty:!1,required:!1},joinMode:{type:"enum",values:["noVerify","needVerify","rejectAll"],required:!1},beInviteMode:{type:"enum",values:["noVerify","needVerify"],required:!1},inviteMode:{type:"enum",values:["manager","all"],required:!1},updateTeamMode:{type:"enum",values:["manager","all"],required:!1},updateExtMode:{type:"enum",values:["manager","all"],required:!1},intro:{type:"string",allowEmpty:!1,required:!1},announcement:{type:"string",allowEmpty:!1,required:!1},avatar:{type:"string",allowEmpty:!1,required:!1},ext:{type:"string",allowEmpty:!1,required:!1}},M),pe=Xd(M),ze.next=4,this.core.sendCmd("updateSuperTeamInfo",{superTeam:pe});case 4:return ze.abrupt("return",qo(pe));case 5:case"end":return ze.stop()}},z,this)}))},F.addSuperTeamMembers=function(M){return hn(this,void 0,void 0,rr.mark(function z(){return rr.wrap(function(ae){for(;;)switch(ae.prev=ae.next){case 0:return xn({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1},accounts:{type:"array",itemType:"string",min:1},ps:{type:"string",allowEmpty:!0,max:5e3,required:!1}},M),ae.next=3,this.core.sendCmd("addSuperTeamMembers",{teamId:M.teamId,accounts:M.accounts,ps:M.ps||"",attach:M.ext||""});case 3:case"end":return ae.stop()}},z,this)}))},F.removeSuperTeamMembers=function(M){return hn(this,void 0,void 0,rr.mark(function z(){return rr.wrap(function(ae){for(;;)switch(ae.prev=ae.next){case 0:return xn({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1},accounts:{type:"array",itemType:"string",min:1}},M),ae.next=3,this.core.sendCmd("removeSuperTeamMembers",{teamId:M.teamId,accounts:M.accounts});case 3:case"end":return ae.stop()}},z,this)}))},F.addSuperTeamManagers=function(M){return hn(this,void 0,void 0,rr.mark(function z(){return rr.wrap(function(ae){for(;;)switch(ae.prev=ae.next){case 0:return xn({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1},accounts:{type:"array",min:1,itemType:"string"}},M),ae.next=3,this.core.sendCmd("addSuperTeamManagers",M);case 3:case"end":return ae.stop()}},z,this)}))},F.removeSuperTeamManagers=function(M){return hn(this,void 0,void 0,rr.mark(function z(){return rr.wrap(function(ae){for(;;)switch(ae.prev=ae.next){case 0:return xn({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1},accounts:{type:"array",min:1,itemType:"string"}},M),ae.next=3,this.core.sendCmd("removeSuperTeamManagers",M);case 3:case"end":return ae.stop()}},z,this)}))},F.applySuperTeam=function(M){return hn(this,void 0,void 0,rr.mark(function z(){var pe;return rr.wrap(function(ze){for(;;)switch(ze.prev=ze.next){case 0:return xn({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1},ps:{type:"string",allowEmpty:!0,max:5e3,required:!1}},M),ze.next=3,this.core.sendCmd("applySuperTeam",{teamId:M.teamId,ps:M.ps||""});case 3:return pe=ze.sent,ze.abrupt("return",qo(pe.content.superTeam));case 5:case"end":return ze.stop()}},z,this)}))},F.transferSuperTeam=function(M){return hn(this,void 0,void 0,rr.mark(function z(){return rr.wrap(function(ae){for(;;)switch(ae.prev=ae.next){case 0:return xn({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1},account:{type:"string",allowEmpty:!1},leave:{type:"boolean"}},M),ae.next=3,this.core.sendCmd("transferSuperTeam",M);case 3:case"end":return ae.stop()}},z,this)}))},F.muteSuperTeam=function(M){return hn(this,void 0,void 0,rr.mark(function z(){return rr.wrap(function(ae){for(;;)switch(ae.prev=ae.next){case 0:return xn({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1},mute:{type:"boolean"}},M),ae.next=3,this.core.sendCmd("muteSuperTeam",{teamId:M.teamId,mute:M.mute?1:0});case 3:case"end":return ae.stop()}},z,this)}))},F.muteSuperTeamMembers=function(M){return hn(this,void 0,void 0,rr.mark(function z(){return rr.wrap(function(ae){for(;;)switch(ae.prev=ae.next){case 0:return xn({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1},accounts:{type:"array",itemType:"string"},mute:{type:"boolean"}},M),ae.next=3,this.core.sendCmd("muteSuperTeamMembers",{teamId:M.teamId,accounts:M.accounts,mute:M.mute?1:0});case 3:case"end":return ae.stop()}},z,this)}))},F.updateMemberNick=function(M){return hn(this,void 0,void 0,rr.mark(function z(){var pe,ae;return rr.wrap(function(jt){for(;;)switch(jt.prev=jt.next){case 0:return xn({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1},account:{type:"string",allowEmpty:!1},nickInTeam:{type:"string",allowEmpty:!1}},M),pe=kM({teamId:M.teamId,nickInTeam:M.nickInTeam,account:M.account}),jt.next=4,this.core.sendCmd("updateSuperTeamMemberNick",{teamMember:pe});case 4:return ae=Ws(kr({updateTime:new Date().getTime()},pe)),jt.abrupt("return",ae);case 6:case"end":return jt.stop()}},z,this)}))},F.updateMyMemberInfo=function(M){return hn(this,void 0,void 0,rr.mark(function z(){var pe,ae,ze;return rr.wrap(function(ur){for(;;)switch(ur.prev=ur.next){case 0:return xn({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1},nickInTeam:{type:"string",allowEmpty:!1,required:!1},bitConfigMask:{type:"number",min:0,max:2,required:!1},ext:{type:"string",required:!1}},M),pe=kM({teamId:M.teamId,nickInTeam:M.nickInTeam,bitConfigMask:M.bitConfigMask,ext:M.ext}),ur.next=4,this.core.sendCmd("updateMySuperTeamMemberInfo",{teamMember:pe});case 4:return ae=Ws(kr({updateTime:new Date().getTime(),account:this.core.account},pe)),this.mergeMySuperTeamMembers([ae]),this.core.emit("updateSuperTeamMember",ae),ze=hc(this.mySuperTeamMembersMap.get(ae.teamId)),this.core.emit("mySuperTeamMembers",[ze]),ur.abrupt("return",ae);case 10:case"end":return ur.stop()}},z,this)}))},F.getSuperTeamMembersByAccounts=function(M){var z;return hn(this,void 0,void 0,rr.mark(function pe(){var ae,ze,jt;return rr.wrap(function(hr){for(;;)switch(hr.prev=hr.next){case 0:return xn({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1},accounts:{type:"array",itemType:"string",max:20,min:1}},M),ze=lo(ae=M.accounts).call(ae,function(br){return M.teamId+"|"+br}),hr.next=4,this.core.sendCmd("getSuperTeamMembersByAccounts",{memberIds:ze});case 4:return jt=hr.sent,hr.abrupt("return",Zd((z=jt.content)===null||z===void 0?void 0:z.superTeamMembers));case 6:case"end":return hr.stop()}},pe,this)}))},F.getSuperTeamMembers=function(M){var z;return hn(this,void 0,void 0,rr.mark(function pe(){var ae;return rr.wrap(function(jt){for(;;)switch(jt.prev=jt.next){case 0:return xn({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1},joinTime:{type:"number",min:0,required:!1},limit:{type:"number",min:1,max:1e3,required:!1},reverse:{type:"boolean",required:!1}},M),jt.next=3,this.core.sendCmd("getSuperTeamMembers",kr({joinTime:0,limit:100,reverse:!1},M));case 3:return ae=jt.sent,jt.abrupt("return",Zd((z=ae.content)===null||z===void 0?void 0:z.superTeamMembers));case 5:case"end":return jt.stop()}},pe,this)}))},F.queryMuteMembers=function(M){return hn(this,void 0,void 0,rr.mark(function z(){var pe,ae;return rr.wrap(function(jt){for(;;)switch(jt.prev=jt.next){case 0:return xn({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1},joinTime:{type:"number",min:0,required:!1},limit:{type:"number",min:1,required:!1},reverse:{type:"boolean",required:!1}},M),jt.next=3,this.core.sendCmd("queryMuteSuperTeamMembers",kr({limit:100,joinTime:0,reverse:!1},M));case 3:return pe=jt.sent,ae=pe.content,jt.abrupt("return",Zd(ae.superTeamMembers));case 6:case"end":return jt.stop()}},z,this)}))},F.leaveSuperTeam=function(M){return hn(this,void 0,void 0,rr.mark(function z(){return rr.wrap(function(ae){for(;;)switch(ae.prev=ae.next){case 0:return xn({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1}},M),ae.next=3,this.core.sendCmd("leaveSuperTeam",{teamId:M.teamId});case 3:case"end":return ae.stop()}},z,this)}))},F.passSuperTeamApply=function(M){return hn(this,void 0,void 0,rr.mark(function z(){return rr.wrap(function(ae){for(;;)switch(ae.prev=ae.next){case 0:return xn({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1},from:{type:"string",allowEmpty:!1}},M),ae.next=3,this.core.sendCmd("passSuperTeamApply",M);case 3:case"end":return ae.stop()}},z,this)}))},F.rejectSuperTeamApply=function(M){return hn(this,void 0,void 0,rr.mark(function z(){return rr.wrap(function(ae){for(;;)switch(ae.prev=ae.next){case 0:return xn({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1},from:{type:"string",allowEmpty:!1},ps:{type:"string",max:5e3,required:!1}},M),ae.next=3,this.core.sendCmd("rejectSuperTeamApply",{teamId:M.teamId,from:M.from,ps:M.ps||""});case 3:case"end":return ae.stop()}},z,this)}))},F.acceptSuperTeamInvite=function(M){return hn(this,void 0,void 0,rr.mark(function z(){return rr.wrap(function(ae){for(;;)switch(ae.prev=ae.next){case 0:return xn({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1},from:{type:"string",allowEmpty:!1}},M),ae.next=3,this.core.sendCmd("acceptSuperTeamInvite",M);case 3:case"end":return ae.stop()}},z,this)}))},F.rejectSuperTeamInvite=function(M){return hn(this,void 0,void 0,rr.mark(function z(){return rr.wrap(function(ae){for(;;)switch(ae.prev=ae.next){case 0:return xn({teamId:{type:"string",regExp:/\d+/,allowEmpty:!1},from:{type:"string",allowEmpty:!1},ps:{type:"string",max:5e3,required:!1}},M),ae.next=3,this.core.sendCmd("rejectSuperTeamInvite",{teamId:M.teamId,from:M.from,ps:M.ps||""});case 3:case"end":return ae.stop()}},z,this)}))},F.syncSuperTeamsHandler=function(M){var z=M.content;this.core.eventBus.emit("sync/updateTimetag",{superTeams:go(z.timetag)});var pe=z==null?void 0:z.superTeams;if(pe&&pe.length){var ae=ui(pe);this.core.emit("superTeams",ae)}},F.syncCreateSuperTeamHandler=function(M){var z=M.content,pe=qo(z==null?void 0:z.superTeam),ae=df(pe,pe.owner,"owner");this.core.emit("createSuperTeam",pe,ae)},F.syncUpdateSuperTeamMemberHandler=function(M){var z=M.content,pe=Ws(z==null?void 0:z.teamMember);pe.updateTime||(pe.updateTime=new Date().getTime()),this.mergeMySuperTeamMembers([pe]),this.core.emit("updateSuperTeamMember",pe);var ae=hc(this.mySuperTeamMembersMap.get(pe.teamId));this.core.emit("mySuperTeamMembers",[ae])},F.syncMySuperTeamMembersHandler=function(M){var z,pe=M.content;this.core.eventBus.emit("sync/updateTimetag",{mySuperTeamMembers:go(pe.timetag)});var ae=pe==null?void 0:lo(z=pe.teamMembers).call(z,function(ze){return Ws(ze)});this.mergeMySuperTeamMembers(ae),this.core.emit("mySuperTeamMembers",hc(ae))},F.notificationHandler=function(M){var z=M.attach,pe=M.scene,ae=M.from,ze=M.to,jt=M.time,ur=M.idServer,hr=M.idClient,br=z.team,Cr=z.account,_r=z.accounts,Nr=z.type;if(pe==="superTeam")switch(this.core.options.debugLevel==="debug"?this.logger.debug("superTeam::recvNotification",ur,hr,z):this.logger.log("superTeam::recvNotification",ur,hr,ze,Nr,Cr,_r),Nr){case"updateSuperTeam":br.updateTime=jt,this.core.emit("updateSuperTeam",br);break;case"addSuperTeamMembers":this.service.notifyAddSuperTeamMembers(br,_r);break;case"acceptSuperTeamInvite":this.service.notifyAddSuperTeamMembers(br,[ae]);break;case"passSuperTeamApply":this.service.notifyAddSuperTeamMembers(br,[Cr]);break;case"addSuperTeamManagers":this.service.notifyUpdateSuperTeamManagers(ze,_r,!0,jt);break;case"removeSuperTeamManagers":this.service.notifyUpdateSuperTeamManagers(ze,_r,!1,jt);break;case"removeSuperTeamMembers":this.service.notifyRemoveSuperTeamMembers(br,_r);break;case"leaveSuperTeam":this.service.notifyRemoveSuperTeamMembers(br,[ae]);break;case"dismissSuperTeam":this.core.emit("dismissSuperTeam",{teamId:ze});break;case"transferSuperTeam":this.service.notifyTransferSuperTeam(br,ae,Cr);break;case"updateSuperTeamMembersMute":this.service.notifyUpdateSuperTeamMembersMute(br,_r,z.mute)}},T}(ns),BM={"13_1":"getChatroomAddress","24_1":"getQChatAddress"},LM={getChatroomAddress:{sid:13,cid:1,service:"plugin",params:[{type:"Long",name:"chatroomId"},{type:"Boolean",name:"isWeixinApp"},{type:"Number",name:"ipType"}],response:[{type:"StrArray",name:"address"}]},getQChatAddress:{sid:24,cid:1,service:"plugin",params:[{type:"Property",name:"getQChatAddressTag",reflectMapper:{ipType:1}}],response:[{type:"StrArray",name:"address"}]}},UM=function(x){function T(D){var M;return(M=x.call(this,"plugin",D)||this).core=D,Ui({cmdMap:BM,cmdConfig:LM}),M}Co(T,x);var F=T.prototype;return F.getChatroomAddress=function(M){return hn(this,void 0,void 0,rr.mark(function z(){var pe;return rr.wrap(function(ze){for(;;)switch(ze.prev=ze.next){case 0:return xn({chatroomId:{type:"string",allowEmpty:!1},ipType:{type:"number",required:!1}},M),ze.next=3,this.core.sendCmd("getChatroomAddress",{chatroomId:M.chatroomId,isWeixinApp:Fo.platform==="WXAPP",ipType:M.ipType||0});case 3:return pe=ze.sent,ze.abrupt("return",pe.content.address);case 5:case"end":return ze.stop()}},z,this)}))},F.getQChatAddress=function(M){return hn(this,void 0,void 0,rr.mark(function z(){var pe;return rr.wrap(function(ze){for(;;)switch(ze.prev=ze.next){case 0:return xn({ipType:{type:"number",required:!1}},M),ze.next=3,this.core.sendCmd("getQChatAddress",{getQChatAddressTag:{ipType:(M==null?void 0:M.ipType)||0}});case 3:return pe=ze.sent,ze.abrupt("return",pe.content.address);case 5:case"end":return ze.stop()}},z,this)}))},T}(ns),DM={"7_19":"nimQueryCloudSessionList","7_20":"nimQueryCloudSession","7_21":"nimUpdateCloudSession","7_22":"nimDeleteCloudSessionList","7_121":"nimMultiSyncUpdateCloudSession"},Qh={sessionReqTag:{minTimestamp:1,maxTimestamp:2,includedLastMsg:3,limit:4,hasMore:5},sessionTag:{sessionId:1,updateTime:2,ext:3,lastMsg:4,lastMsgType:5}},tb=ts(Qh),qM={nimQueryCloudSessionList:{sid:7,cid:19,service:"cloudSession",params:[{type:"Property",name:"tag",reflectMapper:Qh.sessionReqTag}],response:[{type:"Property",name:"tag",reflectMapper:tb.sessionReqTag},{type:"PropertyArray",name:"sessions",reflectMapper:tb.sessionTag}]},nimQueryCloudSession:{sid:7,cid:20,service:"cloudSession",params:[{type:"Property",name:"tag",reflectMapper:Qh.sessionTag}],response:[{type:"Property",name:"session",reflectMapper:tb.sessionTag}]},nimUpdateCloudSession:{sid:7,cid:21,service:"cloudSession",params:[{type:"Property",name:"tag",reflectMapper:Qh.sessionTag}]},nimDeleteCloudSessionList:{sid:7,cid:22,service:"cloudSession",params:[{type:"PropertyArray",name:"tags",reflectMapper:Qh.sessionTag}]},nimMultiSyncUpdateCloudSession:{sid:7,cid:121,service:"cloudSession",response:[{type:"Property",name:"session",reflectMapper:tb.sessionTag}]}},$M={sessionId:{type:"string"},updateTime:{type:"number"},ext:{type:"string"},lastMsg:{type:"object"},lastMsgType:{type:"number"}};function xM(x,T,F){var D=Zs($M,x),M=wo(D.sessionId,"|"),z=M.accid,pe=M.scene;if(D.sessionId=pe+"-"+z,D.lastMsg){var ae=D.lastMsgType===1;D.lastMsgInfo=ae?{isLastMsgRecalled:ae,revokedMsg:Qd(Aa(D.lastMsg,ku.sysMsg),F)}:{isLastMsgRecalled:ae,lastMsg:Ba(Aa(D.lastMsg,is.msg),{account:T})}}return delete D.lastMsg,delete D.lastMsgType,D}function HM(x,T,F){return x&&x.length>0?lo(x).call(x,function(D){return xM(D,T,F)}):[]}var PM,Uc,Jh,VM=function(x){function T(D){var M;return M=x.call(this,"cloudSession",D)||this,Ui({cmdMap:DM,cmdConfig:qM}),M}Co(T,x);var F=T.prototype;return F.queryCloudSessionList=function(M){var z;return hn(this,void 0,void 0,rr.mark(function pe(){var ae,ze,jt,ur;return rr.wrap(function(br){for(;;)switch(br.prev=br.next){case 0:return xn({minTimestamp:{type:"number",min:0,required:!1},maxTimestamp:{type:"number",min:0,required:!1},limit:{type:"number",min:1,required:!1},includedLastMsg:{type:"boolean",required:!1}},M),(ae=kr({limit:100,includedLastMsg:!0},M)).includedLastMsg=tS.boolean(M,"includedLastMsg"),br.next=5,this.core.sendCmd("nimQueryCloudSessionList",{tag:ae});case 5:return ze=br.sent,jt=((z=ze.content)===null||z===void 0?void 0:z.tag)||{},ur=ze.content.sessions,br.abrupt("return",{hasMore:+jt.hasMore>0,sessionList:HM(ur,this.core.account,this.logger)});case 9:case"end":return br.stop()}},pe,this)}))},F.queryCloudSession=function(M){return hn(this,void 0,void 0,rr.mark(function z(){var pe,ae,ze,jt;return rr.wrap(function(hr){for(;;)switch(hr.prev=hr.next){case 0:return xn({sessionId:{type:"string",allowEmpty:!1}},M),pe=wo(M.sessionId,"-"),ae=pe.accid,ze=pe.scene,hr.next=4,this.core.sendCmd("nimQueryCloudSession",{tag:{sessionId:ze==="superTeam"?"super_team|"+ae:ze+"|"+ae}});case 4:return jt=hr.sent,hr.abrupt("return",xM(jt.content.session,this.core.account,this.logger));case 6:case"end":return hr.stop()}},z,this)}))},F.updateCloudSession=function(M){return hn(this,void 0,void 0,rr.mark(function z(){var pe,ae,ze;return rr.wrap(function(ur){for(;;)switch(ur.prev=ur.next){case 0:return xn({sessionId:{type:"string",allowEmpty:!1},ext:{type:"string",allowEmpty:!1,required:!1}},M),pe=wo(M.sessionId,"-"),ae=pe.accid,ze=pe.scene,ur.next=4,this.core.sendCmd("nimUpdateCloudSession",{tag:{sessionId:ze==="superTeam"?"super_team|"+ae:ze+"|"+ae,ext:M.ext}});case 4:case"end":return ur.stop()}},z,this)}))},F.deleteCloudSessionList=function(M){return hn(this,void 0,void 0,rr.mark(function z(){var pe,ae;return rr.wrap(function(jt){for(;;)switch(jt.prev=jt.next){case 0:return xn({sessionIdList:{type:"array",itemType:"string"}},M),ae=lo(pe=M.sessionIdList).call(pe,function(ur){var hr=wo(ur,"-"),br=hr.accid,Cr=hr.scene;return{sessionId:Cr==="superTeam"?"super_team|"+br:Cr+"|"+br}}),jt.next=4,this.core.sendCmd("nimDeleteCloudSessionList",{tags:ae});case 4:case"end":return jt.stop()}},z,this)}))},F.nimMultiSyncUpdateCloudSessionHandler=function(M){var z=xM(M.content.session,this.core.account,this.logger);this.core.emit("multiSyncUpdateCloudSession",z)},T}(ns);(function(x){x[x.audio=1]="audio",x[x.video=2]="video",x[x.custom=3]="custom"})(PM||(PM={})),function(x){x[x.kClose=1]="kClose",x[x.kJoin=2]="kJoin",x[x.kInvite=3]="kInvite",x[x.kCancelInvite=4]="kCancelInvite",x[x.kReject=5]="kReject",x[x.kAccept=6]="kAccept",x[x.kLeave=7]="kLeave",x[x.kCustom=8]="kCustom"}(Uc||(Uc={})),function(x){x[x.kDefault=0]="kDefault",x[x.kLeave=1]="kLeave",x[x.kSelfSync=3]="kSelfSync"}(Jh||(Jh={}));var wM={needPush:{type:"boolean",required:!1},pushTitle:{type:"string",required:!1},pushContent:{type:"string",required:!1},pushPayload:{type:"string",required:!1},needPushBadge:{type:"boolean",required:!1}},zM={"15_1":"signalingCreate","15_2":"signalingDelay","15_3":"signalingClose","15_4":"signalingJoin","15_5":"signalingLeave","15_6":"signalingInvite","15_7":"signalingCancelInvite","15_8":"signalingReject","15_9":"signalingAccept","15_10":"signalingSendCustomCommand","15_11":"signalingRecvNotification","15_12":"signalingMultiSyncNotification","15_13":"signalingSyncNotification","15_14":"singalingSyncChannels","15_15":"signalingQueryInfo","15_16":"signalingCallEx","15_17":"signalingJoinAndAccept"},ta={avSignalTag:kr({type:1,name:2,channelId:3,createTime:4,expireTime:5,creatorAccid:6,ext:7,invalid:8,fromAccid:10,toAccid:11,requestId:12,members:18,attach:19,attachExt:20,needOffline:21,msgId:22,uid:23,time:24,nertcChannelName:25,nertcTokenTtl:26,nertcToken:27,nertcJoinRoomQueryParamMap:28,nertcJoinRoomResponse:29,callStatus:30},{needPush:13,pushTitle:14,pushContent:15,pushPayload:16,needPushBadge:17})},yc=ts(ta),WM={signalingCreate:{sid:15,cid:1,service:"signaling",params:[{type:"Property",name:"tag",reflectMapper:ta.avSignalTag}],response:[{type:"Property",name:"data",reflectMapper:yc.avSignalTag}]},signalingDelay:{sid:15,cid:2,service:"signaling",params:[{type:"Property",name:"tag",reflectMapper:ta.avSignalTag}],response:[{type:"Property",name:"data",reflectMapper:yc.avSignalTag}]},signalingClose:{sid:15,cid:3,service:"signaling",params:[{type:"Property",name:"tag",reflectMapper:ta.avSignalTag}],response:[{type:"Property",name:"data",reflectMapper:yc.avSignalTag}]},signalingJoin:{sid:15,cid:4,service:"signaling",params:[{type:"Property",name:"tag",reflectMapper:ta.avSignalTag}],response:[{type:"Property",name:"data",reflectMapper:yc.avSignalTag}]},signalingLeave:{sid:15,cid:5,service:"signaling",params:[{type:"Property",name:"tag",reflectMapper:ta.avSignalTag}]},signalingInvite:{sid:15,cid:6,service:"signaling",params:[{type:"Property",name:"tag",reflectMapper:ta.avSignalTag}]},signalingCancelInvite:{sid:15,cid:7,service:"signaling",params:[{type:"Property",name:"tag",reflectMapper:ta.avSignalTag}]},signalingReject:{sid:15,cid:8,service:"signaling",params:[{type:"Property",name:"tag",reflectMapper:ta.avSignalTag}]},signalingAccept:{sid:15,cid:9,service:"signaling",params:[{type:"Property",name:"tag",reflectMapper:ta.avSignalTag}]},signalingSendCustomCommand:{sid:15,cid:10,service:"signaling",params:[{type:"Property",name:"tag",reflectMapper:ta.avSignalTag}]},signalingRecvNotification:{sid:15,cid:11,service:"signaling",response:[{type:"Property",name:"data",reflectMapper:yc.avSignalTag}]},signalingMultiSyncNotification:{sid:15,cid:12,service:"signaling",response:[{type:"Property",name:"data",reflectMapper:yc.avSignalTag}]},signalingSyncNotification:{sid:15,cid:13,service:"signaling",response:[{type:"PropertyArray",name:"datas",reflectMapper:yc.avSignalTag}]},singalingSyncChannels:{sid:15,cid:14,service:"signaling",response:[{type:"PropertyArray",name:"datas",reflectMapper:yc.avSignalTag}]},signalingQueryInfo:{sid:15,cid:15,service:"signaling",params:[{type:"Property",name:"tag",reflectMapper:ta.avSignalTag}],response:[{type:"Property",name:"data",reflectMapper:yc.avSignalTag}]},signalingCallEx:{sid:15,cid:16,service:"signaling",params:[{type:"Property",name:"tag",reflectMapper:ta.avSignalTag}],response:[{type:"Property",name:"data",reflectMapper:yc.avSignalTag}]},signalingJoinAndAccept:{sid:15,cid:17,service:"signaling",params:[{type:"Property",name:"tag",reflectMapper:ta.avSignalTag}],response:[{type:"Property",name:"data",reflectMapper:yc.avSignalTag}]},signalingBatchMarkRead:{sid:4,cid:5,isNoResponse:!0,service:"signaling",params:[{type:"byte",name:"sid"},{type:"byte",name:"cid"},{type:"LongArray",name:"ids"}]}},rb={type:{type:"number"},createTime:{type:"number"},expireTime:{type:"number"},invalid:{type:"boolean"},pushInfo:wM,pluginSetting:{nertcInfo:{nertcChannelName:{type:"string"},nertcTokenTtl:{type:"number"},nertcToken:{type:"string"},nertcJoinRoomQueryParamMap:{type:"string"},callStatus:{type:"number"}}},attach:{type:"object"},members:{type:"object"},needOffline:{type:"boolean"},uid:{type:"number"},time:{type:"number"}};function ep(x){var T,F=Zs(rb,x),D=[];return F.members&&F.members.length>0&&(D=lo(T=F.members).call(T,function(M){return function(pe){return Zs(rb,Aa(pe,{1:"accid",2:"uid",3:"createTime",4:"expireTime"}))}(M)}),delete F.members),D.length>0?{channelInfo:F,memberList:D}:{channelInfo:F}}function vc(x){return wd(rb,x)}var GM=function(x){function T(D){var M;return(M=x.call(this)||this).timer=0,M.pollingInterval=12e4,M.name="signaling",M.logger=D.logger,M.core=D,M.channels={},Ui({cmdMap:zM,cmdConfig:WM}),M}Co(T,x);var F=T.prototype;return F.callEx=function(M){var z;return hn(this,void 0,void 0,rr.mark(function pe(){var ae,ze,jt,ur;return rr.wrap(function(br){for(;;)switch(br.prev=br.next){case 0:return xn({type:{type:"number"},toAccid:{type:"string",allowEmpty:!1},requestId:{type:"string",allowEmpty:!1},needOffline:{type:"boolean",required:!1},pushInfo:{type:"object",required:!1,rules:wM},pluginSetting:{type:"object",required:!1,rules:{nertcInfo:{type:"object",required:!1}}}},M),br.next=3,this.core.sendCmd("signalingCallEx",{tag:vc(M)});case 3:return ae=br.sent,ze=((z=ae.content)===null||z===void 0?void 0:z.data)||{},jt=ep(ze),this.channels[jt.channelInfo.channelId]=hc(jt.channelInfo),this.timer||(this.timer=this.core.timerManager.addTimer(Mo(ur=this.aotoDelay).call(ur,this),this.pollingInterval,-1)),br.abrupt("return",jt);case 9:case"end":return br.stop()}},pe,this)}))},F.joinAndAccept=function(M){var z;return hn(this,void 0,void 0,rr.mark(function pe(){var ae,ze,jt,ur,hr,br;return rr.wrap(function(_r){for(;;)switch(_r.prev=_r.next){case 0:return xn({channelId:{type:"string",allowEmpty:!1},fromAccid:{type:"string",allowEmpty:!1},requestId:{type:"string",required:!1},needOffline:{type:"boolean",required:!1},uid:{type:"number",required:!1},pluginSetting:{type:"object",required:!1,rules:{nertcInfo:{type:"object",required:!1}}}},M),ae=M.fromAccid,(ze=Is(M,["fromAccid"])).toAccid=ae,_r.next=5,this.core.sendCmd("signalingJoinAndAccept",{tag:vc(ze)});case 5:return jt=_r.sent,ur=((z=jt.content)===null||z===void 0?void 0:z.data)||{},hr=ep(ur),this.channels[hr.channelInfo.channelId]=hc(hr.channelInfo),this.timer||(this.timer=this.core.timerManager.addTimer(Mo(br=this.aotoDelay).call(br,this),this.pollingInterval,-1)),_r.abrupt("return",hr);case 11:case"end":return _r.stop()}},pe,this)}))},F.create=function(M){var z;return hn(this,void 0,void 0,rr.mark(function pe(){var ae,ze;return rr.wrap(function(ur){for(;;)switch(ur.prev=ur.next){case 0:return xn({type:{type:"number"},ext:{type:"string",required:!1}},M),ur.next=3,this.core.sendCmd("signalingCreate",{tag:vc(M)});case 3:return ae=ur.sent,ze=((z=ae.content)===null||z===void 0?void 0:z.data)||{},ur.abrupt("return",ep(ze));case 6:case"end":return ur.stop()}},pe,this)}))},F.close=function(M){return hn(this,void 0,void 0,rr.mark(function z(){return rr.wrap(function(ae){for(;;)switch(ae.prev=ae.next){case 0:return xn({channelId:{type:"string",allowEmpty:!1},attachExt:{type:"string",required:!1},needOffline:{type:"boolean",required:!1}},M),ae.next=3,this.core.sendCmd("signalingClose",{tag:vc(M)});case 3:case"end":return ae.stop()}},z,this)}))},F.queryInfo=function(M){var z;return hn(this,void 0,void 0,rr.mark(function pe(){var ae,ze;return rr.wrap(function(ur){for(;;)switch(ur.prev=ur.next){case 0:return xn({name:{type:"string",allowEmpty:!1}},M),ur.next=3,this.core.sendCmd("signalingQueryInfo",{tag:M});case 3:return ae=ur.sent,ze=((z=ae.content)===null||z===void 0?void 0:z.data)||{},ur.abrupt("return",ep(ze));case 6:case"end":return ur.stop()}},pe,this)}))},F.join=function(M){var z;return hn(this,void 0,void 0,rr.mark(function pe(){var ae,ze,jt,ur;return rr.wrap(function(br){for(;;)switch(br.prev=br.next){case 0:return xn({channelId:{type:"string",allowEmpty:!1},attachExt:{type:"string",required:!1},uid:{type:"number",min:0,required:!1},needOffline:{type:"boolean",required:!1}},M),br.next=3,this.core.sendCmd("signalingJoin",{tag:vc(M)});case 3:return ae=br.sent,ze=((z=ae.content)===null||z===void 0?void 0:z.data)||{},jt=ep(ze),this.channels[jt.channelInfo.channelId]=hc(jt.channelInfo),this.timer||(this.timer=this.core.timerManager.addTimer(Mo(ur=this.aotoDelay).call(ur,this),this.pollingInterval,-1)),br.abrupt("return",jt);case 9:case"end":return br.stop()}},pe,this)}))},F.aotoDelay=function(){return hn(this,void 0,void 0,rr.mark(function M(){var z,pe,ae,ze,jt;return rr.wrap(function(hr){for(;;)switch(hr.prev=hr.next){case 0:if((z=No(this.channels)).length!==0){hr.next=4;break}return this.timer&&this.core.timerManager.deleteTimer(this.timer),hr.abrupt("return");case 4:this.logger.log("signling:autoDelay",z),pe=0;case 6:if(!(pe<z.length)){hr.next=23;break}return ae=z[pe],hr.prev=8,hr.next=11,this.core.sendCmd("signalingDelay",{tag:{channelId:ae}});case 11:ze=hr.sent,jt=ep(ze.content.data),this.channels[ae]=jt.channelInfo,hr.next=20;break;case 16:hr.prev=16,hr.t0=hr.catch(8),this.logger.warn("signling:autoDelay "+ae+" failed",hr.t0),delete this.channels[ae];case 20:pe++,hr.next=6;break;case 23:case"end":return hr.stop()}},M,this,[[8,16]])}))},F.leave=function(M){return hn(this,void 0,void 0,rr.mark(function z(){return rr.wrap(function(ae){for(;;)switch(ae.prev=ae.next){case 0:return xn({channelId:{type:"string",allowEmpty:!1},attachExt:{type:"string",required:!1},needOffline:{type:"boolean",required:!1}},M),ae.next=3,this.core.sendCmd("signalingLeave",{tag:vc(M)});case 3:delete this.channels[M.channelId];case 4:case"end":return ae.stop()}},z,this)}))},F.invite=function(M){return hn(this,void 0,void 0,rr.mark(function z(){return rr.wrap(function(ae){for(;;)switch(ae.prev=ae.next){case 0:return xn({channelId:{type:"string",allowEmpty:!1},toAccid:{type:"string",allowEmpty:!1},requestId:{type:"string",allowEmpty:!1},attachExt:{type:"string",required:!1},needOffline:{type:"boolean",required:!1},pushInfo:{type:"object",required:!1,rules:wM}},M),ae.next=3,this.core.sendCmd("signalingInvite",{tag:vc(M)});case 3:case"end":return ae.stop()}},z,this)}))},F.cancelInvite=function(M){return hn(this,void 0,void 0,rr.mark(function z(){return rr.wrap(function(ae){for(;;)switch(ae.prev=ae.next){case 0:return xn({channelId:{type:"string",allowEmpty:!1},toAccid:{type:"string",allowEmpty:!1},requestId:{type:"string",allowEmpty:!1},attachExt:{type:"string",required:!1},needOffline:{type:"boolean",required:!1}},M),ae.next=3,this.core.sendCmd("signalingCancelInvite",{tag:vc(M)});case 3:case"end":return ae.stop()}},z,this)}))},F.reject=function(M){return hn(this,void 0,void 0,rr.mark(function z(){var pe,ae;return rr.wrap(function(jt){for(;;)switch(jt.prev=jt.next){case 0:return xn({channelId:{type:"string",allowEmpty:!1},fromAccid:{type:"string",allowEmpty:!1},requestId:{type:"string",allowEmpty:!1},attachExt:{type:"string",required:!1},needOffline:{type:"boolean",required:!1}},M),pe=M.fromAccid,(ae=Is(M,["fromAccid"])).toAccid=pe,jt.next=5,this.core.sendCmd("signalingReject",{tag:vc(ae)});case 5:case"end":return jt.stop()}},z,this)}))},F.accept=function(M){return hn(this,void 0,void 0,rr.mark(function z(){var pe,ae,ze,jt,ur;return rr.wrap(function(br){for(;;)switch(br.prev=br.next){case 0:return xn({channelId:{type:"string",allowEmpty:!1},fromAccid:{type:"string",allowEmpty:!1},requestId:{type:"string",allowEmpty:!1},attachExt:{type:"string",required:!1},needOffline:{type:"boolean",required:!1},autoJoin:{type:"boolean",required:!1},uid:{type:"number",min:0,required:!1},joinAttachExt:{type:"string",required:!1}},M),pe=M.autoJoin,ae=M.joinAttachExt,ze=M.fromAccid,(jt=Is(M,["autoJoin","joinAttachExt","fromAccid"])).toAccid=ze,br.next=5,this.core.sendCmd("signalingAccept",{tag:vc(jt)});case 5:if(this.logger.log("Signaling:accept, accept success, autoJoin "+M.autoJoin),!pe){br.next=10;break}return ur={channelId:M.channelId,needOffline:M.needOffline,attachExt:ae,uid:M.uid},br.next=10,this.join(ur);case 10:case"end":return br.stop()}},z,this)}))},F.sendCustomCommand=function(M){return hn(this,void 0,void 0,rr.mark(function z(){return rr.wrap(function(ae){for(;;)switch(ae.prev=ae.next){case 0:return xn({channelId:{type:"string",allowEmpty:!1},fromAccid:{type:"string",allowEmpty:!1,required:!1},attachExt:{type:"string",required:!1}},M),ae.next=3,this.core.sendCmd("signalingSendCustomCommand",{tag:vc(M)});case 3:case"end":return ae.stop()}},z,this)}))},F.signalingRecvNotificationHandler=function(M){var z=typeof Es(M,"raw.r[0]")=="number"?""+M.raw.r[0]:void 0;M.content.data.msgId=z,this.doNotify(M.content.data),z&&go(z)&&this.core.sendCmd("signalingBatchMarkRead",{sid:15,cid:11,ids:[z]})},F.signalingMultiSyncNotificationHandler=function(M){this.doNotify(M.content.data,Jh.kSelfSync)},F.doNotify=function(M,z){z===void 0&&(z=Jh.kDefault);var pe=function(Br,Hr){Hr===void 0&&(Hr=Jh.kDefault);var $r=Zs(rb,Br),Vr=$r.attach,bn=$r.time,Wn=$r.msgId;$r.fromAccid,$r.toAccid,$r.members,$r.requestId,$r.pushInfo;var qn=Is($r,["attach","time","msgId","fromAccid","toAccid","members","requestId","pushInfo"]),yo=Vr.type,Fn=$r.ext;return delete $r.attach,{metaData:{eventType:yo,channelInfo:qn,feature:Hr,ext:Fn,time:bn,msgId:Wn},rawData:$r}}(M,z),ae=pe.metaData,ze=pe.rawData,jt=ze.fromAccid,ur=ze.toAccid,hr=ze.members,br=ze.requestId,Cr=ze.pushInfo,_r=ze.msgId;switch(ae.eventType){case Uc.kClose:this.emit("signalingClose",{fromAccid:jt,metaData:ae});break;case Uc.kJoin:this.emit("signalingJoin",{member:hr,metaData:ae});break;case Uc.kInvite:this.emit("signalingInvite",{fromAccid:jt,toAccid:ur,requestId:br,pushInfo:Cr,metaData:ae});break;case Uc.kCancelInvite:this.emit("signalingCancelInvite",{fromAccid:jt,toAccid:ur,requestId:br,metaData:ae});break;case Uc.kReject:this.emit("signalingReject",{toAccid:ur,requestId:br,metaData:ae});break;case Uc.kAccept:this.emit("signalingAccept",{toAccid:ur,requestId:br,metaData:ae});break;case Uc.kLeave:this.emit("signalingLeave",{fromAccid:jt,metaData:ae});break;case Uc.kCustom:this.emit("signalingCustomCommand",{fromAccid:jt,metaData:ae});break;default:this.logger.warn("signaling:notification, no such a type "+ae.eventType,ze)}return _r},F.signalingSyncNotificationHandler=function(M){var z,pe,ae=this;if(M.content.datas&&M.content.datas.length>0){var ze=ss(z=lo(pe=M.content.datas).call(pe,function(jt){return ae.doNotify(jt)})).call(z,function(jt){return jt});ze.length>0&&this.core.sendCmd("signalingBatchMarkRead",{sid:15,cid:11,ids:ze})}},F.singalingSyncChannelsHandler=function(M){var z;if(this.timer=0,this.channels={},M.content.datas&&M.content.datas.length>0){var pe=lo(z=M.content.datas).call(z,function(ae){return ep(ae)});this.emit("singalingSyncChannels",pe)}},F.process=function(M){var z=this[M.cmd+"Handler"];return typeof z=="function"?(z.call(this,M),ro.resolve(M)):M.error&&!M.error.ignore?ro.reject(M.error):ro.resolve(M)},T}(Hs.EventEmitter);return Ri.setAdapters(sv),Ri.registerService(gv,"auth"),Ri.registerService(_v,"msg"),Ri.registerService(xS,"misc"),Ri.registerService(Ov,"user"),Ri.registerService(rM,"session"),Ri.registerService(hM,"team"),Ri.registerService(TM,"systemMessage"),Ri.registerService(MM,"friend"),Ri.registerService(b,"event"),Ri.registerService(V,"msgExtend"),Ri.registerService(Jr,"msgLog"),Ri.registerService(Bn,"passThrough"),Ri.registerService(bo,"cloudStorage"),Ri.registerService(jM,"superTeam"),Ri.registerService(Kp,"sync"),Ri.registerService(UM,"plugin"),Ri.registerService(VM,"cloudSession"),Ri.registerService(GM,"signaling"),Ri})})(NIM_BROWSER_SDK);var NIM_BROWSER_SDKExports=NIM_BROWSER_SDK.exports;const NIMSDK=getDefaultExportFromCjs(NIM_BROWSER_SDKExports);var NIM_Web_SDK={exports:{}};/*!
 * 
 * VERSION: 9.14.4
 * Git Hash: 98d1c9786af772ff439f12534089825e2c3c6776
 * 
 * Create At: 2024/2/23 下午3:43:35
 * 
 * Target: NIM_Web_SDK
 */(function(module,exports){(function(t,n){module.exports=n()})(window,function(){return function(t){var n={};function e(r){if(n[r])return n[r].exports;var s=n[r]={i:r,l:!1,exports:{}};return t[r].call(s.exports,s,s.exports,e),s.l=!0,s.exports}return e.m=t,e.c=n,e.d=function(r,s,i){e.o(r,s)||Object.defineProperty(r,s,{enumerable:!0,get:i})},e.r=function(r){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(r,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(r,"__esModule",{value:!0})},e.t=function(r,s){if(1&s&&(r=e(r)),8&s||4&s&&typeof r=="object"&&r&&r.__esModule)return r;var i=Object.create(null);if(e.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:r}),2&s&&typeof r!="string")for(var o in r)e.d(i,o,(function(a){return r[a]}).bind(null,o));return i},e.n=function(r){var s=r&&r.__esModule?function(){return r.default}:function(){return r};return e.d(s,"a",s),s},e.o=function(r,s){return Object.prototype.hasOwnProperty.call(r,s)},e.p="",e(e.s=916)}([function(t,n,e){var r=e(51),s=e(2),i=e(7),o=e(15),a=e(4),d=e(121),c=e(71),u=e(122),m=e(32),y=e(6),S=e(9),O=e(8),k=e(123),g=e(141),v=e(24),ue=e(16),L=e(462),re=e(466),le=e(3),oe=e(88),he=e(89),Ie=e(72),ie=e(52),Ne=e(53),Ve=e(54),Ce=e(55),Ue=e(43),qe=e(22);function Oe(tr,At){var kt=a(tr);if(ie){var Dt=ie(tr);At&&(Dt=ue(Dt).call(Dt,function(gr){return Ne(tr,gr).enumerable})),kt.push.apply(kt,Dt)}return kt}function $e(tr,At){var kt=he!==void 0&&Ie(tr)||tr["@@iterator"];if(!kt){if(m(tr)||(kt=function(Mr,Ar){var Fr;if(Mr){if(typeof Mr=="string")return _e(Mr,Ar);var Dr=o(Fr=Object.prototype.toString.call(Mr)).call(Fr,8,-1);if(Dr==="Object"&&Mr.constructor&&(Dr=Mr.constructor.name),Dr==="Map"||Dr==="Set")return oe(Mr);if(Dr==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(Dr))return _e(Mr,Ar)}}(tr))||At&&tr&&typeof tr.length=="number"){kt&&(tr=kt);var Dt=0,gr=function(){};return{s:gr,n:function(){return Dt>=tr.length?{done:!0}:{done:!1,value:tr[Dt++]}},e:function(Mr){throw Mr},f:gr}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var yr,vr=!0,Ir=!1;return{s:function(){kt=kt.call(tr)},n:function(){var Mr=kt.next();return vr=Mr.done,Mr},e:function(Mr){Ir=!0,yr=Mr},f:function(){try{vr||kt.return==null||kt.return()}finally{if(Ir)throw yr}}}}function _e(tr,At){(At==null||At>tr.length)&&(At=tr.length);for(var kt=0,Dt=new Array(At);kt<At;kt++)Dt[kt]=tr[kt];return Dt}var er=e(256),Pt=e(200);function ar(tr){qe(tr)==="object"?(this.callFunc=tr.callFunc||null,this.message=tr.message||"UNKNOW ERROR"):this.message=tr,this.time=new Date,this.timetag=+this.time}e(490);var pr,lr,or=e(62),xe=or.getGlobal(),nr=/\s+/;or.deduplicate=function(tr){var At=[];return s(tr).call(tr,function(kt){i(At).call(At,kt)===-1&&At.push(kt)}),At},or.capFirstLetter=function(tr){return tr?o(tr=""+tr).call(tr,0,1).toUpperCase()+o(tr).call(tr,1):""},or.guid=(pr=function(){return(65536*(1+Math.random())|0).toString(16).substring(1)},function(){return pr()+pr()+pr()+pr()+pr()+pr()+pr()+pr()}),or.extend=function(tr,At,kt){for(var Dt in At)tr[Dt]!==void 0&&kt!==!0||(tr[Dt]=At[Dt])},or.filterObj=function(tr,At){var kt={};return or.isString(At)&&(At=At.split(nr)),s(At).call(At,function(Dt){tr.hasOwnProperty(Dt)&&(kt[Dt]=tr[Dt])}),kt},or.copy=function(tr,At){var kt;return At=At||{},tr&&s(kt=a(tr)).call(kt,function(Dt){or.exist(tr[Dt])&&(At[Dt]=tr[Dt])}),At},or.copyWithNull=function(tr,At){var kt;return At=At||{},tr&&s(kt=a(tr)).call(kt,function(Dt){(or.exist(tr[Dt])||or.isnull(tr[Dt]))&&(At[Dt]=tr[Dt])}),At},or.findObjIndexInArray=function(tr,At){tr=tr||[];var kt=At.keyPath||"id",Dt=-1;return d(tr).call(tr,function(gr,yr){if(Pt(gr,kt)===At.value)return Dt=yr,!0}),Dt},or.findObjInArray=function(tr,At){var kt=or.findObjIndexInArray(tr,At);return kt===-1?null:tr[kt]},or.mergeObjArray=function(){var tr=[],At=o([]).call(arguments,0,-1),kt=arguments[arguments.length-1];or.isArray(kt)&&(At.push(kt),kt={});var Dt,gr=kt.keyPath=kt.keyPath||"id";for(kt.sortPath=kt.sortPath||gr;!tr.length&&At.length;)tr=At.shift()||[],tr=o(tr).call(tr,0);return s(At).call(At,function(yr){yr&&s(yr).call(yr,function(vr){(Dt=or.findObjIndexInArray(tr,{keyPath:gr,value:Pt(vr,gr)}))!==-1?tr[Dt]=or.merge({},tr[Dt],vr):tr.push(vr)})}),kt.notSort||(tr=or.sortObjArray(tr,kt)),tr},or.cutObjArray=function(tr){var At=o(tr).call(tr,0),kt=arguments.length,Dt=o([]).call(arguments,1,kt-1),gr=arguments[kt-1];or.isObject(gr)||(Dt.push(gr),gr={});var yr,vr=gr.keyPath=gr.keyPath||"id";return s(Dt).call(Dt,function(Ir){or.isArray(Ir)||(Ir=[Ir]),s(Ir).call(Ir,function(Mr){Mr&&(gr.value=Pt(Mr,vr),(yr=or.findObjIndexInArray(At,gr))!==-1&&c(At).call(At,yr,1))})}),At},or.sortObjArray=function(tr,At){var kt=(At=At||{}).sortPath||"id";er.insensitive=!!At.insensitive;var Dt,gr,yr,vr=!!At.desc;return yr=or.isFunction(At.compare)?At.compare:function(Ir,Mr){return Dt=Pt(Ir,kt),gr=Pt(Mr,kt),vr?er(gr,Dt):er(Dt,gr)},u(tr).call(tr,yr)},or.emptyFunc=function(){},or.isEmptyFunc=function(tr){return tr===or.emptyFunc},or.notEmptyFunc=function(tr){return tr!==or.emptyFunc},or.splice=function(tr,At,kt){return c([]).call(tr,At,kt)},or.reshape2d=function(tr,At){if(m(tr)){or.verifyParamType("type",At,"number","util::reshape2d");var kt=tr.length;if(kt<=At)return[tr];for(var Dt=Math.ceil(kt/At),gr=[],yr=0;yr<Dt;yr++)gr.push(o(tr).call(tr,yr*At,(yr+1)*At));return gr}return tr},or.flatten2d=function(tr){if(m(tr)){var At=[];return s(tr).call(tr,function(kt){At=y(At).call(At,kt)}),At}return tr},or.dropArrayDuplicates=function(tr){if(m(tr)){for(var At={},kt=[];tr.length>0;)At[tr.shift()]=!0;for(var Dt in At)At[Dt]===!0&&kt.push(Dt);return kt}return tr},or.onError=function(tr){throw new ar(tr)},or.verifyParamPresent=function(tr,At,kt,Dt){kt=kt||"";var gr=!1;switch(or.typeOf(At)){case"undefined":case"null":gr=!0;break;case"string":At===""&&(gr=!0);break;case"StrStrMap":case"object":a(At).length||(gr=!0);break;case"array":At.length?d(At).call(At,function(yr){if(or.notexist(yr))return gr=!0,!0}):gr=!0}gr&&or.onParamAbsent(kt+tr,Dt)},or.onParamAbsent=function(tr,At){or.onParamError("缺少参数 ".concat(tr,", 请确保参数不是 空字符串、空对象、空数组、null或undefined, 或数组的内容不是 null/undefined"),At)},or.verifyParamAbsent=function(tr,At,kt,Dt){kt=kt||"",At!==void 0&&or.onParamPresent(kt+tr,Dt)},or.onParamPresent=function(tr,At){or.onParamError("多余的参数 ".concat(tr),At)},or.verifyParamType=function(tr,At,kt,Dt){var gr=or.typeOf(At).toLowerCase();or.isArray(kt)||(kt=[kt]),kt=S(kt).call(kt,function(vr){return vr.toLowerCase()});var yr=!0;switch(i(kt).call(kt,gr)===-1&&(yr=!1),gr){case"number":isNaN(At)&&(yr=!1);break;case"string":kt.join("")==="numeric or numeric string"&&(yr=!!/^[0-9]+$/.test(At))}yr||or.onParamInvalidType(tr,kt,"",Dt)},or.onParamInvalidType=function(tr,At,kt,Dt){kt=kt||"",At=or.isArray(At)?(At=S(At).call(At,function(gr){return'"'+gr+'"'})).join(", "):'"'+At+'"',or.onParamError('参数"'+kt+tr+'"类型错误, 合法的类型包括: ['+At+"]",Dt)},or.verifyParamValid=function(tr,At,kt,Dt){or.isArray(kt)||(kt=[kt]),i(kt).call(kt,At)===-1&&or.onParamInvalidValue(tr,kt,Dt)},or.onParamInvalidValue=function(tr,At,kt){var Dt;or.isArray(At)||(At=[At]),At=S(At).call(At,function(gr){return'"'+gr+'"'}),or.isArray(At)&&(At=At.join(", ")),or.onParamError(y(Dt="参数 ".concat(tr,"值错误, 合法的值包括: [")).call(Dt,O(At),"]"),kt)},or.verifyParamMin=function(tr,At,kt,Dt){At<kt&&or.onParamError("参数"+tr+"的值不能小于"+kt,Dt)},or.verifyParamMax=function(tr,At,kt,Dt){At>kt&&or.onParamError("参数"+tr+"的值不能大于"+kt,Dt)},or.verifyArrayMax=function(tr,At,kt,Dt){At.length>kt&&or.onParamError("参数"+tr+"的长度不能大于"+kt,Dt)},or.verifyEmail=(lr=/^\S+@\S+$/,function(tr,At,kt){lr.test(At)||or.onParamError("参数"+tr+"邮箱格式错误, 合法格式必须包含@符号, @符号前后至少要各有一个字符",kt)}),or.verifyTel=function(){var tr=/^[+\-()\d]+$/;return function(At,kt,Dt){tr.test(kt)||or.onParamError("参数"+At+"电话号码格式错误, 合法字符包括+、-、英文括号和数字",Dt)}}(),or.verifyBirth=function(){var tr=/^(\d{4})-(0[1-9]|1[012])-(0[1-9]|[12][0-9]|3[01])$/;return function(At,kt,Dt){tr.test(kt)||or.onParamError("参数"+At+'生日格式错误, 合法为"yyyy-MM-dd"',Dt)}}(),or.onParamError=function(tr,At){or.onError({message:tr,callFunc:At})},or.verifyOptions=function(tr,At,kt,Dt,gr){if(tr=tr||{},At&&(or.isString(At)&&(At=At.split(nr)),or.isArray(At))){typeof kt!="boolean"&&(gr=kt||null,kt=!0,Dt="");var yr=kt?or.verifyParamPresent:or.verifyParamAbsent;s(At).call(At,function(vr){yr.call(or,vr,tr[vr],Dt,gr)})}return tr},or.verifyParamAtLeastPresentOne=function(tr,At,kt){At&&(or.isString(At)&&(At=At.split(nr)),or.isArray(At)&&(d(At).call(At,function(Dt){return or.exist(tr[Dt])})||or.onParamError("以下参数["+At.join(", ")+"]至少需要传入一个",kt)))},or.verifyParamPresentJustOne=function(tr,At,kt){At&&(or.isString(At)&&(At=At.split(nr)),or.isArray(At)&&k(At).call(At,function(Dt,gr){return or.exist(tr[gr])&&Dt++,Dt},0)!==1&&or.onParamError("以下参数["+At.join(", ")+"]必须且只能传入一个",kt))},or.verifyBooleanWithDefault=function(tr,At,kt,Dt,gr){or.undef(kt)&&(kt=!0),nr.test(At)&&(At=At.split(nr)),or.isArray(At)?s(At).call(At,function(yr){or.verifyBooleanWithDefault(tr,yr,kt,Dt,gr)}):tr[At]===void 0?tr[At]=kt:or.isBoolean(tr[At])||or.onParamInvalidType(At,"boolean",Dt,gr)},or.verifyFileInput=function(tr,At){var kt;return or.verifyParamPresent("fileInput",tr,"",At),or.isString(tr)&&((tr=typeof document>"u"?void 0:document.getElementById(tr))||or.onParamError("找不到要上传的文件对应的input, 请检查fileInput id ".concat(tr),At)),tr.tagName&&tr.tagName.toLowerCase()==="input"&&tr.type.toLowerCase()==="file"||or.onParamError(y(kt="请提供正确的 fileInput, 必须为 file 类型的 input 节点 tagname:".concat(tr.tagName,", filetype:")).call(kt,tr.type),At),tr},or.verifyFileType=function(tr,At){or.verifyParamValid("type",tr,or.validFileTypes,At)},or.verifyCallback=function(tr,At,kt){nr.test(At)&&(At=At.split(nr)),or.isArray(At)?s(At).call(At,function(Dt){or.verifyCallback(tr,Dt,kt)}):tr[At]?or.isFunction(tr[At])||or.onParamInvalidType(At,"function","",kt):tr[At]=or.emptyFunc},or.verifyFileUploadCallback=function(tr,At){or.verifyCallback(tr,"uploadprogress uploaddone uploaderror uploadcancel",At)},or.validFileTypes=["image","audio","video","file"],or.validFileExts={image:["bmp","gif","jpg","jpeg","jng","png","webp"],audio:["mp3","wav","aac","wma","wmv","amr","mp2","flac","vorbis","ac3"],video:["mp4","rm","rmvb","wmv","avi","mpg","mpeg","mov"]},or.filterFiles=function(tr,At){var kt,Dt,gr=(At=At.toLowerCase())==="file",yr=[];return s([]).call(tr,function(vr){var Ir,Mr;if(gr)yr.push(vr);else if(kt=o(Ir=vr.name).call(Ir,g(Mr=vr.name).call(Mr,".")+1),(Dt=vr.type.split("/"))[0]&&Dt[1]){var Ar,Fr=!1;Dt[0].toLowerCase()===At?Fr=!0:Fr=i(Ar=or.validFileExts[At]).call(Ar,kt)!==-1,Fr&&yr.push(vr)}}),yr};var ir,dr,Lt=or.supportFormData=or.notundef(xe.FormData);or.getFileName=function(tr){return tr=or.verifyFileInput(tr),Lt?tr.files[0].name:o(At=tr.value).call(At,g(kt=tr.value).call(kt,"\\")+1);var At,kt},or.getFileInfo=(ir={ppt:1,pptx:2,pdf:3,doc:6,docx:7},function(tr){var At={};if(!(tr=or.verifyFileInput(tr)).files)return At;var kt=tr.files[0];return Lt&&(At.name=kt.name,At.size=kt.size,At.type=kt.name.match(/\.(\w+)$/),At.type=At.type&&At.type[1].toLowerCase(),At.transcodeType=ir[At.type]||0),At}),or.sizeText=(dr=["B","KB","MB","GB","TB","PB","EB","ZB","BB"],function(tr){var At,kt=0;do At=(tr=Math.floor(100*tr)/100)+dr[kt],tr/=1024,kt++;while(tr>1);return At}),or.promises2cmds=function(tr){return S(tr).call(tr,function(At){return At.cmd})},or.objs2accounts=function(tr){return S(tr).call(tr,function(At){return At.account})},or.teams2ids=function(tr){return S(tr).call(tr,function(At){return At.teamId})},or.objs2ids=function(tr){return S(tr).call(tr,function(At){return At.id})},or.getMaxUpdateTime=function(tr){var At=S(tr).call(tr,function(kt){return+kt.updateTime});return Math.max.apply(Math,At)},or.genCheckUniqueFunc=function(tr){return tr=tr||"id",function(At){this.uniqueSet=this.uniqueSet||{},this.uniqueSet[tr]=this.uniqueSet[tr]||{};var kt=this.uniqueSet[tr],Dt=At[tr];return!kt[Dt]&&(kt[Dt]=!0,!0)}},or.fillPropertyWithDefault=function(tr,At,kt){return!!or.undef(tr[At])&&(tr[At]=kt,!0)},or.throttle=function(tr,At,kt,Dt){var gr,yr,vr=null,Ir=0;kt||(kt={});var Mr=function(){Ir=kt.leading===!1?0:new Date().getTime(),vr=null,tr.apply(gr,yr),vr||(gr=yr=null)};return function(){var Ar=new Date().getTime();Ir||kt.leading!==!1||(Ir=Ar);var Fr=At-(Ar-Ir);return gr=this,yr=arguments,Fr<=0||Fr>At?(clearTimeout(vr),vr=null,Ir=Ar,tr.apply(gr,yr),vr||(gr=yr=null)):vr||kt.trailing===!1?vr&&Dt&&Dt.apply(gr,yr):(vr=v(Mr,Fr),Dt&&Dt.apply(gr,yr)),vr}},or.get=function(tr,At){var kt=arguments.length>2&&arguments[2]!==void 0?arguments[2]:void 0;if(qe(tr)!=="object")return kt;var Dt,gr=At.replace(/\[(\d+)\]/g,".$1").split("."),yr=tr,vr=$e(gr);try{for(vr.s();!(Dt=vr.n()).done;){var Ir=Dt.value;if((yr=Object(yr)[Ir])===void 0)return kt}}catch(Mr){vr.e(Mr)}finally{vr.f()}return yr},or.pickAsString=function(tr,At){var kt;return tr?S(kt=ue(At).call(At,function(Dt){return tr[Dt]!==void 0})).call(kt,function(Dt){var gr;return y(gr="".concat(Dt,"=")).call(gr,tr[Dt])}).join(","):""},or.omitAsString=function(tr,At){var kt,Dt;if(!tr)return"";var gr={};return s(At).call(At,function(yr){gr[yr]=!0}),S(kt=ue(Dt=a(tr)).call(Dt,function(yr){return!gr[yr]})).call(kt,function(yr){var vr;return y(vr="".concat(yr,"=")).call(vr,tr[yr])}).join(",")};var cr={session:function(tr){var At=function(Dt){for(var gr=1;gr<arguments.length;gr++){var yr,vr,Ir=arguments[gr]!=null?arguments[gr]:{};gr%2?s(yr=Oe(Object(Ir),!0)).call(yr,function(Mr){r(Dt,Mr,Ir[Mr])}):Ve?Ce(Dt,Ve(Ir)):s(vr=Oe(Object(Ir))).call(vr,function(Mr){Ue(Dt,Mr,Ne(Ir,Mr))})}return Dt}({},tr),kt=["topCustom","localCustom","extra"];return s(kt).call(kt,function(Dt){At[Dt]&&(At[Dt]="***")}),At.lastMsg&&(At.lastMsg={idServer:At.lastMsg.idServer,idClient:At.lastMsg.idClient}),At}};or.secureOutput=function(tr,At){m(At)||(At=[At]);var kt=cr[tr];return(At=S(At).call(At,function(Dt){return kt(Dt)})).length===1?At[0]:At};var mr={string:function(tr,At,kt){var Dt=kt.required,gr=kt.allowEmpty,yr=tr[At];return Dt===!1&&yr===void 0||typeof yr=="string"&&!(!gr&&yr==="")},number:function(tr,At,kt){var Dt=kt.required,gr=kt.min,yr=tr[At];return Dt===!1&&yr===void 0||typeof yr=="number"&&!(yr<gr)},enum:function(tr,At,kt){var Dt=kt.required,gr=L(kt),yr=tr[At];return Dt===!1&&yr===void 0||i(gr).call(gr,yr)>-1},array:function(tr,At,kt){var Dt=kt.itemType,gr=kt.min,yr=kt.max,vr=kt.required,Ir=tr[At];return vr===!1&&Ir===void 0||!!m(Ir)&&!(typeof yr=="number"&&Ir.length>yr)&&!(typeof gr=="number"&&Ir.length<gr)&&!(Dt&&Dt!=="enum"&&!re(Ir).call(Ir,function(Mr){return qe(Mr)===Dt}))}};or.validate=function(tr,At,kt){var Dt,gr={};return s(Dt=a(tr)).call(Dt,function(yr){var vr,Ir=tr[yr].type,Mr=mr[Ir];Mr&&!Mr(At,yr,tr[yr])?or.onError({message:y(vr="Error in parameter verification, ".concat(yr," expected value is ")).call(vr,O(tr[yr])),callFunc:kt}):gr[yr]=At[yr]}),gr},or.asyncPool=function(tr,At,kt){if(typeof tr!="number"||typeof kt!="function"||!At||!At.length)return le.resolve();var Dt=0,gr=[],yr=[];return function vr(){if(Dt===At.length)return le.resolve();var Ir=At[Dt++],Mr=le.resolve().then(function(){return kt(Ir,At)});gr.push(Mr);var Ar=le.resolve();if(tr<=At.length){var Fr=Mr.then(function(){return c(yr).call(yr,i(yr).call(yr,Fr),1)});yr.push(Fr),yr.length>=tr&&(Ar=le.race(yr))}return Ar.then(function(){return vr()})}().then(function(){return le.all(gr)})},or.getIdArray=function(tr){if(!tr||typeof tr!="string")throw new Error("id type error");var At=i(tr).call(tr,"-");if(At<0||At===tr.length-1)throw new Error("id format error");return[o(tr).call(tr,0,At),o(tr).call(tr,At+1)]},t.exports=or},function(t,n,e){var r=e(14),s=e(79),i=e(159),o=e(17),a=e(95).f,d=e(211),c=e(13),u=e(34),m=e(61),y=e(30),S=function(O){var k=function(g,v,ue){if(this instanceof k){switch(arguments.length){case 0:return new O;case 1:return new O(g);case 2:return new O(g,v)}return new O(g,v,ue)}return s(O,this,arguments)};return k.prototype=O.prototype,k};t.exports=function(O,k){var g,v,ue,L,re,le,oe,he,Ie,ie=O.target,Ne=O.global,Ve=O.stat,Ce=O.proto,Ue=Ne?r:Ve?r[ie]:(r[ie]||{}).prototype,qe=Ne?c:c[ie]||m(c,ie,{})[ie],Oe=qe.prototype;for(L in k)v=!(g=d(Ne?L:ie+(Ve?".":"#")+L,O.forced))&&Ue&&y(Ue,L),le=qe[L],v&&(oe=O.dontCallGetSet?(Ie=a(Ue,L))&&Ie.value:Ue[L]),re=v&&oe?oe:k[L],v&&typeof le==typeof re||(he=O.bind&&v?u(re,r):O.wrap&&v?S(re):Ce&&o(re)?i(re):re,(O.sham||re&&re.sham||le&&le.sham)&&m(he,"sham",!0),m(qe,L,he),Ce&&(y(c,ue=ie+"Prototype")||m(c,ue,{}),m(c[ue],L,re),O.real&&Oe&&(g||!Oe[L])&&m(Oe,L,re)))}},function(t,n,e){t.exports=e(230)},function(t,n,e){t.exports=e(232)},function(t,n,e){t.exports=e(231)},function(t,n){t.exports=function(e){try{return!!e()}catch{return!0}}},function(t,n,e){t.exports=e(323)},function(t,n,e){t.exports=e(207)},function(t,n,e){t.exports=e(384)},function(t,n,e){t.exports=e(440)},function(t,n,e){t.exports=e(276)},function(t,n,e){var r=e(7),s=e(6),i=!1;try{typeof localStorage.setItem=="function"&&typeof localStorage.getItem=="function"&&(localStorage.setItem("nim_localstorage_exist_test","1"),i=localStorage.getItem("nim_localstorage_exist_test")==="1",localStorage.removeItem("nim_localstorage_exist_test"))}catch{i=!1}var o={nodeEnv:"production",info:{hash:"98d1c9786af772ff439f12534089825e2c3c6776",shortHash:"98d1c978",version:"9.14.4",sdkVersion:"91404",sdkHumanVersion:"9.14.4",protocolVersion:1},lbsUrl:"https://lbs.netease.im/lbs/webconf.jsp",needToXHR:!0,connectTimeout:1e4,xhrTimeout:8e3,reconnectionDelay:1600,reconnectionDelayMax:8e3,reconnectionJitter:.01,reconnectiontimer:null,heartbeatInterval:3e4,cmdTimeout:8e3,hbCmdTimeout:5e3,isWeixinApp:!1,isNodejs:!1,isRN:!1,ipVersion:0,PUSHTOKEN:"",PUSHCONFIG:{},CLIENTTYPE:16,PushPermissionAsked:!1,iosPushConfig:null,androidPushConfig:null,optionDefaultLinkUrl:"",defaultLinkUrl:"weblink.netease.im",ipv6DefaultLinkUrl:"weblink.netease.im",optionIpv6DefaultLinkUrl:"",wxDefaultLinkUrl:"wlnimsc0.netease.im",serverNosConfig:i?{cdnDomain:localStorage.getItem("nim_cdn_domain")||"",objectPrefix:localStorage.getItem("nim_object_prefix")||""}:{},hasLocalStorage:i,privateConf:{isABTestEnable:!0,isDataReportEnable:!0,isMixStoreEnable:!0,reportConfigUrl:"https://statistic.live.126.net/dispatcher/req",reportUrl:"https://statistic.live.126.net/statics/report/common/form"},getDefaultLinkUrl:function(a){var d,c;o.ipVersion===1?(d=o.optionIpv6DefaultLinkUrl,c=o.ipv6DefaultLinkUrl):(d=o.optionDefaultLinkUrl,c=o.defaultLinkUrl);var u=d||(o.isWeixinApp?o.wxDefaultLinkUrl:c);if(!u)return!1;var m=a?"https":"http",y=a?"443":"80",S=u;return r(u).call(u,"http")===-1&&(S=m+"://"+S),r(u).call(u,":")===-1&&(S=S+":"+y),S},ipProbeAddr:{ipv4:"https://check-ipv4.netease.im/test/",ipv6:"https://check-ipv6.netease.im/test/"},formatSocketUrl:function(a){var d=a.url,c=a.secure?"https":"http";return r(d).call(d,"http")===-1?c+"://"+d:d},uploadUrl:"https://nos.netease.com",chunkUploadUrl:"https://wanproxy-web.127.net",commonMaxSize:104857600,chunkSize:4194304,chunkMaxSize:4194304e4,replaceUrl:"https://{bucket}-nosdn.netease.im/{object}",downloadHost:"nos.netease.com",downloadHostList:["nos.netease.com"],downloadUrl:"https://{bucket}-nosdn.netease.im/{object}",nosCdnEnable:!0,httpsEnabled:!1,threshold:0,nosLbsUrls:[],edgeList:["https://wanproxy-web.127.net","https://nosup-hz1.127.net"],genUploadUrl:function(a){return o.uploadUrl+"/"+a},genChunkUploadUrl:function(a){return o.chunkUploadUrl?o.chunkUploadUrl+"/"+a.bucket+"/"+a.objectName:""},genDownloadUrl:function(a,d,c){var u,m,y,S,O,k=a.bucket,g=a.expireSec,v=+new Date,ue=g?"&survivalTime=".concat(g):"";if(c)return s(y=s(S=s(O="https://".concat(c,"/")).call(O,d,"?createTime=")).call(S,v)).call(y,ue);var L=s(u=s(m="".concat(o.replaceUrl,"?createTime=")).call(m,v)).call(u,ue);return(L=o.genNosProtocolUrl(L)).replace("{bucket}",k).replace("{object}",d)},genFileUrl:function(a){var d=a.bucket,c=a.objectName;return o.genNosProtocolUrl(o.replaceUrl).replace("{bucket}",d).replace("{object}",c)},genNosProtocolUrl:function(a){return/^http/.test(a)?o.httpsEnabled&&r(a).call(a,"https://")!==0&&(a=a.replace("http","https")):a=o.httpsEnabled?"https://".concat(a):"http://".concat(a),a}};o.hostEnv="BROWSER",t.exports=o},function(t,n,e){var r=e(109),s=Function.prototype,i=s.call,o=r&&s.bind.bind(i,i);t.exports=r?o:function(a){return function(){return i.apply(a,arguments)}}},function(t,n){t.exports={}},function(t,n,e){(function(r){var s=function(i){return i&&i.Math==Math&&i};t.exports=s(typeof globalThis=="object"&&globalThis)||s(typeof window=="object"&&window)||s(typeof self=="object"&&self)||s(typeof r=="object"&&r)||function(){return this}()||Function("return this")()}).call(this,e(73))},function(t,n,e){t.exports=e(251)},function(t,n,e){t.exports=e(458)},function(t,n,e){var r=e(208),s=r.all;t.exports=r.IS_HTMLDDA?function(i){return typeof i=="function"||i===s}:function(i){return typeof i=="function"}},function(t,n,e){t.exports=e(216)},function(t,n,e){var r=e(12);t.exports=r({}.isPrototypeOf)},function(t,n,e){var r=e(109),s=Function.prototype.call;t.exports=r?s.bind(s):function(){return s.apply(s,arguments)}},function(t,n,e){var r=e(14),s=e(111),i=e(30),o=e(130),a=e(97),d=e(209),c=s("wks"),u=r.Symbol,m=u&&u.for,y=d?u:u&&u.withoutSetter||o;t.exports=function(S){if(!i(c,S)||!a&&typeof c[S]!="string"){var O="Symbol."+S;a&&i(u,S)?c[S]=u[S]:c[S]=d&&m?m(O):y(O)}return c[S]}},function(t,n,e){var r=e(155),s=e(365);function i(o){return t.exports=i=typeof r=="function"&&typeof s=="symbol"?function(a){return typeof a}:function(a){return a&&typeof r=="function"&&a.constructor===r&&a!==r.prototype?"symbol":typeof a},t.exports.__esModule=!0,t.exports.default=t.exports,i(o)}t.exports=i,t.exports.__esModule=!0,t.exports.default=t.exports},function(t,n,e){var r=e(13),s=e(30),i=e(136),o=e(39).f;t.exports=function(a){var d=r.Symbol||(r.Symbol={});s(d,a)||o(d,a,{value:i.f(a)})}},function(t,n,e){t.exports=e(454)},function(t,n,e){var r=e(51),s=e(60),i=e(6),o=e(24),a=e(8),d=e(32),c=e(4),u=e(52),m=e(16),y=e(53),S=e(2),O=e(54),k=e(55),g=e(43),v=e(15),ue=e(88),L=e(89),re=e(72);function le(Ue,qe){var Oe=L!==void 0&&re(Ue)||Ue["@@iterator"];if(!Oe){if(d(Ue)||(Oe=function(pr,lr){var or;if(pr){if(typeof pr=="string")return oe(pr,lr);var xe=v(or=Object.prototype.toString.call(pr)).call(or,8,-1);if(xe==="Object"&&pr.constructor&&(xe=pr.constructor.name),xe==="Map"||xe==="Set")return ue(pr);if(xe==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(xe))return oe(pr,lr)}}(Ue))||qe&&Ue&&typeof Ue.length=="number"){Oe&&(Ue=Oe);var $e=0,_e=function(){};return{s:_e,n:function(){return $e>=Ue.length?{done:!0}:{done:!1,value:Ue[$e++]}},e:function(pr){throw pr},f:_e}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var er,Pt=!0,ar=!1;return{s:function(){Oe=Oe.call(Ue)},n:function(){var pr=Oe.next();return Pt=pr.done,pr},e:function(pr){ar=!0,er=pr},f:function(){try{Pt||Oe.return==null||Oe.return()}finally{if(ar)throw er}}}}function oe(Ue,qe){(qe==null||qe>Ue.length)&&(qe=Ue.length);for(var Oe=0,$e=new Array(qe);Oe<qe;Oe++)$e[Oe]=Ue[Oe];return $e}function he(Ue,qe){var Oe=c(Ue);if(u){var $e=u(Ue);qe&&($e=m($e).call($e,function(_e){return y(Ue,_e).enumerable})),Oe.push.apply(Oe,$e)}return Oe}function Ie(Ue){for(var qe=1;qe<arguments.length;qe++){var Oe,$e,_e=arguments[qe]!=null?arguments[qe]:{};qe%2?S(Oe=he(Object(_e),!0)).call(Oe,function(er){r(Ue,er,_e[er])}):O?k(Ue,O(_e)):S($e=he(Object(_e))).call($e,function(er){g(Ue,er,y(_e,er))})}return Ue}var ie=e(45),Ne=e(0);function Ve(Ue){return Ne.get(Ue,"code")||Ne.get(Ue,"msg.code")||Ne.get(Ue,"statusCode")||Ne.get(Ue,"event.code")||0}function Ce(Ue){var qe,Oe,$e=typeof Ue=="string"?Ue:Ne.get(Ue,"msg")||Ne.get(Ue,"message")||Ne.get(Ue,"error")||Ne.get(Ue,"event.msg")||Ne.get(Ue,"event.message")||Ne.get(Ue,"event")||"unknown",_e="",er="";Ue&&typeof Ue.toString=="function"&&(_e=Ue.toString());try{er=a(Ue)}catch{}return i(qe=i(Oe=`
errMsg: `.concat($e,`
errStr: `)).call(Oe,_e,`
errJsonStr: `)).call(qe,er,`
  `)}t.exports={reportAPI:function(Ue){var qe=Ue.instance,Oe=Ue.className,$e=Ue.funcName,_e=Ue.hasCallback,er=_e===void 0||_e,Pt=Ue.done;if(!function(lr){if(!lr||!d(lr.experiments))return!1;var or,xe=le(lr.experiments);try{for(xe.s();!(or=xe.n()).done;){var nr=or.value;if(nr.experimentKey==="api_trace_collection"&&nr.schemeKey==="open_flow"&&d(nr.variates)){var ir,dr=le(nr.variates);try{for(dr.s();!(ir=dr.n()).done;){var Lt=ir.value;if(Lt.key==="open"&&Lt.value===!0)return!0}}catch(cr){dr.e(cr)}finally{dr.f()}}}}catch(cr){xe.e(cr)}finally{xe.f()}return!1}(qe.abtInfo)||!qe.reporter||!qe.reporter.isUploadEnable)return Pt;var ar,pr={user_id:Ne.get(qe,"options.account")||"",trace_id:Ne.get(qe,"socket.socket.sessionid"),class_name:Oe,api_name:$e,action:er?1:0,active_id:ie.deviceId,start_time:s()};return er?(ar=o(function(){qe&&qe.logger&&qe.logger.warn("API 数据上报回调函数未调用",pr),qe&&qe.reporter&&qe.reporter.report("nim_api_trace",Ie(Ie({},pr),{},{state:1,error_code:408,error_msg:"API回调函数未被调用",duration:s()-pr.start_time}))},1e4),function(lr){if(clearTimeout(ar),typeof Pt=="function"){for(var or,xe=arguments.length,nr=new Array(xe>1?xe-1:0),ir=1;ir<xe;ir++)nr[ir-1]=arguments[ir];Pt.apply(void 0,i(or=[lr]).call(or,nr))}try{if(!qe||!qe.reporter)return;lr?qe.reporter.report("nim_api_trace",Ie(Ie({},pr),{},{state:1,error_code:Ve(lr),error_msg:Ce(lr),duration:s()-pr.start_time})):qe.reporter.report("nim_api_trace",Ie(Ie({},pr),{},{state:0,duration:s()-pr.start_time}))}catch(dr){qe&&qe.logger&&qe.logger.error("api report error",dr)}}):(qe.reporter.report("nim_api_trace",Ie(Ie({},pr),{},{state:0,duration:1})),Pt)}}},function(t,n,e){t.exports=e(273)},function(t,n,e){var r=e(5);t.exports=!r(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!=7})},function(t,n,e){var r=e(17),s=e(208),i=s.all;t.exports=s.IS_HTMLDDA?function(o){return typeof o=="object"?o!==null:r(o)||o===i}:function(o){return typeof o=="object"?o!==null:r(o)}},function(t,n,e){var r=e(13);t.exports=function(s){return r[s+"Prototype"]}},function(t,n,e){var r=e(12),s=e(42),i=r({}.hasOwnProperty);t.exports=Object.hasOwn||function(o,a){return i(s(o),a)}},function(t,n,e){var r=e(17),s=e(81),i=TypeError;t.exports=function(o){if(r(o))return o;throw i(s(o)+" is not a function")}},function(t,n,e){t.exports=e(300)},function(t,n,e){var r=e(13),s=e(14),i=e(17),o=function(a){return i(a)?a:void 0};t.exports=function(a,d){return arguments.length<2?o(r[a])||o(s[a]):r[a]&&r[a][d]||s[a]&&s[a][d]}},function(t,n,e){var r=e(159),s=e(31),i=e(109),o=r(r.bind);t.exports=function(a,d){return s(a),d===void 0?a:i?o(a,d):function(){return a.apply(d,arguments)}}},function(t,n,e){var r=e(18),s=e(26),i=e(3),o=e(75),a=e(78),d=e(11),c=e(0),u=e(291),m=c.undef,y=e(310),S=e(149),O=e(153),k=e(784),g=e(785);function v(re){var le,oe,he,Ie=this;c.verifyOptions(re,"appKey account token","protocol::IMProtocol"),c.verifyCallback(re,["onconnect","onerror","onwillreconnect","ondisconnect","onloginportschange","onmyinfo","onblacklist","onmutelist","onfriends","onusers","onrobots","onteams","onSuperTeams","onsessions","onSessionsWithMoreRoaming","onStickTopSessions","onroamingmsgs","onofflinemsgs","onofflinefiltermsgs","onroamingsysmsgs","onofflinesysmsgs","onofflinefiltersysmsgs","onofflinecustomsysmsgs","onofflinefiltercustomsysmsgs","onbroadcastmsg","onbroadcastmsgs","onsysmsgunread","onsyncdone","onteammembers","onsyncteammembersdone","onsyncsuperteammembersdone","onmsg","onsysmsg","oncustomsysmsg","onupdatemyinfo","onupdateuser","onSyncUpdateServerSession","onUpdateSuperTeamMember","onMySuperTeamMembers","onCreateSuperTeam","onUpdateSuperTeam","onAddSuperTeamMembers","onRemoveSuperTeamMembers","onUpdateSuperTeamManagers","onDismissSuperTeam","onTransferSuperTeam","onUpdateSuperTeamMembersMute","onupdateteammember","onMyTeamMembers","onMsgReceipts","onCreateTeam","onUpdateTeam","onAddTeamMembers","onRemoveTeamMembers","onUpdateTeamManagers","onDismissTeam","onTransferTeam","onUpdateTeamMembersMute","onTeamMsgReceipt","onupdatesession","onQuickComment","onDeleteQuickComment","onPinMsgChange","onupdatesysmsgunread","onupdatesysmsg","onsynccreateteam","onsyncsupercreateteam","onsyncmarkinblacklist","onsyncmarkinmutelist","onsyncfriendaction","shouldIgnoreNotification","shouldIgnoreMsg","onDeleteMsgSelf","shouldCountNotifyUnread","onPushNotificationMultiportConfig","onPushNotificationMultiportConfigUpdate","onpushevents"],"protocol::IMProtocol"),le=typeof c.get(re,"privateConf.isDataReportEnable")=="boolean"?re.privateConf.isDataReportEnable:d.privateConf.isDataReportEnable,oe=typeof c.get(re,"privateConf.reportConfigUrl")=="string"?re.privateConf.reportConfigUrl:d.privateConf.reportConfigUrl,he=typeof c.get(re,"privateConf.reportUrl")=="string"?re.privateConf.reportUrl:d.privateConf.reportUrl,Ie.reporter=u.initReporter({isDataReportEnable:le,reportConfigUrl:oe,reportUrl:he,appKey:re.appKey,logger:Ie.logger}),Ie.db=re.api.db=new o({logger:re.logger,reporter:Ie.reporter,account:re.account,core:Ie,notifyError:function(ie){Ie.notifyError&&Ie.notifyError("DB error",ie)}}),this.processId=c.guid(),a.call(Ie,re)}var ue=a.fn,L=v.fn=v.prototype=r(ue);L.init=function(){var re,le,oe;ue.init.call(this),S.IM.setProtocol(this),this.parser=S.IM,s(re=this.sendCmd).call(re,this),this.socketUrls=[],this.syncing=!0,this.canHandleDeletedMsgInSyncing=!1,this.hasSynced=!1,this.hasSyncedTeamMembers=!1,this.syncPromiseArray=[],this.syncResult={},this.syncTeamMembersPromiseArray=[],this.syncSuperTeamMembersPromiseArray=[],this.syncTeamMembersResult={},this.syncSuperTeamMembersResult={},this.timetags={},this.superTeamMembersData={},this.saveAck={},this.sysMsgUnread=O.completeUnread({}),this.resetUnsettledMsgs(),this.resetUnsettledSysMsgs(),this.msgPromise=i.resolve(),this.sysMsgPromise=i.resolve(),this.msgDelayArr=[],this.msgDelayTimer=null,this.msgStatEnable=!1,this.nosCdnHostTimer=null,this.relativeServerTime=0,this.sessionSet={},this.msgReceiptTasks={},this.userSet={},this.pushNotificationMultiportConfig=y.getDefaultConfig(),this.msgAckBufferManager=new k({processFn:s(le=this.handleMsgsAck).call(le,this),throttleTime:500}),this.roamingMsgSyncDoneBufferManager=new k({processFn:s(oe=this.onSyncDone).call(oe,this),throttleTime:1500}),this.reporterHookLBS=new g(this)},L.reset=function(){ue.reset.call(this);var re=this.options;this.db.reset(re.db),m(re.lbsUrl)&&(re.lbsUrl=d.lbsUrl),this.autoconnect=!!re.autoconnect,this.resetAutoMarkRead()},L.resetAutoMarkRead=function(){var re=this.options;c.verifyBooleanWithDefault(re,"autoMarkRead",!0,"","protocol::resetAutoMarkRead")},L.resetUnsettledMsgs=function(){this.unhandledMsgs=[],this.unupdatedMsgs=[]},L.resetUnsettledSysMsgs=function(){this.unhandledSysMsgs=[],this.unhandledSysMsgsForDeletedMsgs=[],this.unupdatedSysMsgs=[]},L.packetFromSync=function(re){return!re.obj||!!re.obj.sync},t.exports=v,e(786),e(787),e(788),e(808),e(810),e(811),e(812),e(813),e(814),e(815),e(816),e(821),e(822),e(823),e(824),e(828),e(829),e(830),e(831),e(832),e(833)},function(t,n,e){var r=e(28),s=String,i=TypeError;t.exports=function(o){if(r(o))return o;throw i(s(o)+" is not an object")}},function(t,n,e){t.exports=e(305)},function(t,n,e){var r=e(81);t.exports=function(s){if(typeof s=="object"&&"size"in s&&"has"in s&&"get"in s&&"set"in s&&"delete"in s&&"entries"in s)return s;throw TypeError(r(s)+" is not a map")}},function(t,n,e){var r=e(27),s=e(210),i=e(212),o=e(36),a=e(128),d=TypeError,c=Object.defineProperty,u=Object.getOwnPropertyDescriptor;n.f=r?i?function(m,y,S){if(o(m),y=a(y),o(S),typeof m=="function"&&y==="prototype"&&"value"in S&&"writable"in S&&!S.writable){var O=u(m,y);O&&O.writable&&(m[y]=S.value,S={configurable:"configurable"in S?S.configurable:O.configurable,enumerable:"enumerable"in S?S.enumerable:O.enumerable,writable:!1})}return c(m,y,S)}:c:function(m,y,S){if(o(m),y=a(y),o(S),s)try{return c(m,y,S)}catch{}if("get"in S||"set"in S)throw d("Accessors not supported");return"value"in S&&(m[y]=S.value),m}},function(t,n,e){var r=e(18),s=e(77),i=e(35),o=e(11),a=e(834),d=e(149).IM,c=e(156);function u(y){var S=c(y);return this.subType="im",this.nosScene=S.nosScene||"im",this.nosSurvivalTime=S.nosSurvivalTime,S.Protocol=i,S.Message=a,S.constructor=u,this.init(S)}u.Protocol=i,u.parser=d,u.use=s.use,u.getInstance=s.getInstance,u.rmAllInstances=s.rmAllInstances,u.genInstanceName=function(y){return"NIM-account-"+y.account};var m=u.fn=u.prototype=r(s.prototype);u.info=m.info=o.info,t.exports=u,e(845),e(846),e(847),e(848),e(849),e(850),e(851),e(852),e(853),e(863),e(874),e(875),e(876),e(877),e(878),e(879),e(880),e(881),e(882),e(885),e(886)},function(t,n,e){var r=e(18),s=e(2),i=e(22);function o(c,u){var m=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},y=this;y.message=c||m.message||"",i(u)==="object"?(y.event=u,y.code="Other_Error"):u!==void 0&&(y.code=u),y.timetag=+new Date,m!==void 0&&(y.event=m),y.event&&(y.callFunc=y.event.callFunc||null,delete y.event.callFunc)}o.prototype=r(Error.prototype),o.prototype.name="NIMError";var a={201:"客户端版本不对, 需升级sdk",302:"用户名或密码错误, 请检查appKey和token是否有效, account和token是否匹配",403:"非法操作或没有权限",404:"对象(用户/群/聊天室)不存在",405:"参数长度过长",408:"客户端请求超时",414:"参数错误",415:"服务不可用/没有聊天室服务器可分配",416:"频率控制",417:"重复操作",422:"帐号被禁用",500:"服务器内部错误",501:"数据库操作失败",503:"服务器繁忙",508:"删除有效期过了",509:"已失效",7101:"被拉黑",700:"批量操作部分失败",801:"群人数达到上限",802:"没有权限",803:"群不存在或未发生变化",804:"用户不在群里面",805:"群类型不匹配",806:"创建群数量达到限制",807:"群成员状态不对",809:"已经在群里",811:"强推列表中帐号数量超限",812:"群被禁言",813:"因群数量限制，部分拉人成功",814:"禁止使用群组消息已读服务",815:"群管理员人数上限",816:"批量操作部分失败",997:"协议已失效",998:"解包错误",999:"打包错误",9102:"通道失效",9103:"已经在其他端接听/拒绝过这通电话",11001:"对方离线, 通话不可送达",13002:"聊天室状态异常",13003:"在黑名单中",13004:"在禁言名单中",13006:"聊天室处于整体禁言状态,只有管理员能发言",Connect_Failed:"无法建立连接, 请确保能 ping/telnet 到云信服务器; 如果是IE8/9, 请确保项目部署在 HTTPS 环境下",Error_Internet_Disconnected:"网断了",Error_Connection_is_not_Established:"连接未建立",Error_Connection_Socket_State_not_Match:"socket状态不对",Error_Timeout:"超时",Param_Error:"参数错误",No_File_Selected:"请选择文件",Wrong_File_Type:"文件类型错误",File_Too_Large:"文件过大",Cross_Origin_Iframe:"不能获取跨域Iframe的内容",Not_Support:"不支持",NO_DB:"无数据库",DB:"数据库错误",Still_In_Team:"还在群里",Session_Exist:"会话已存在",Session_Not_Exist:"会话不存在",Error_Unknown:"未知错误",Operation_Canceled:"操作取消",Sync_Error:"同步数据失败"},d=[200,406,808,810];s(d).call(d,function(c){a[c]=null}),o.genError=function(c){var u=a[c];return u===void 0&&(u="操作失败"),u===null?null:new o(u,c)},o.multiInstance=function(c){return new o("不允许初始化多个实例","Not_Allow_Multi_Instance",c)},o.newNetworkError=function(c){var u="Error_Internet_Disconnected";return new o(a[u],u,c)},o.newConnectError=function(c){var u="Connect_Failed";return new o(a[u]||null,u,c)},o.newConnectionError=function(c){var u="Error_Connection_is_not_Established";return new o(a[u],u,c)},o.newSocketStateError=function(c){var u="Error_Connection_Socket_State_not_Match";return new o(a[u],u,c)},o.newTimeoutError=function(c){var u="Error_Timeout";return new o(a[u],u,c)},o.newFrequencyControlError=function(c){var u=new o(a[416],416,c);return u.from="local",u},o.newParamError=function(c,u){return new o(c||a.Param_Error,"Param_Error",u)},o.newNoFileError=function(c,u){var m="No_File_Selected";return new o(c||a[m],m,u)},o.newWrongFileTypeError=function(c,u){var m="Wrong_File_Type";return new o(c||a[m],m,u)},o.newFileTooLargeError=function(c,u){var m="File_Too_Large";return new o(c||a[m],m,u)},o.newCORSIframeError=function(c){var u="Cross_Origin_Iframe";return new o(a[u],u,c)},o.newSupportError=function(c,u,m){return new o("不支持"+c,"Not_Support_"+u,m)},o.newSupportDBError=function(c){return o.newSupportError("数据库","DB",c)},o.noDBError=function(c){return new o(a.NO_DB,"NO_DB",c)},o.newDBError=function(c){return new o(a.DB,"DB",c)},o.newUnknownError=function(c){var u="Error_Unknown";return new o(a[u],u,c)},o.stillInTeamError=function(c){var u="Still_In_Team";return new o(a[u],u,c)},o.sessionExist=function(c){var u="Session_Exist";return new o(a[u],u,c)},o.sessionNotExist=function(c){var u="Session_Not_Exist";return new o(a[u],u,c)},o.cancel=function(c){var u="Operation_Canceled";return new o(a[u],u,c)},o.syncError=function(c){return new o(a.Sync_Error,"Sync_Error",c)},o.customError=function(c,u){c=c||"Other_Error";var m="";return(u=u||{}).message||(m=a[c]||c),i(c)!=="object"?new o(m,c,u):new o(m,"Other_Error",u===void 0?c:u)},t.exports=o},function(t,n,e){var r=e(110),s=Object;t.exports=function(i){return s(r(i))}},function(t,n,e){t.exports=e(249)},function(t,n,e){var r=e(127),s=e(110);t.exports=function(i){return r(s(i))}},function(t,n,e){var r=e(0),s={init:function(){s.deviceId=r.guid()}};s.init(),s.clientTypeMap={1:"Android",2:"iOS",4:"PC",8:"WindowsPhone",16:"Web",32:"Server",64:"Mac"},s.db={open:function(){}},s.rnfs=null,t.exports=s},function(t,n,e){var r=e(322);t.exports=function(s){return r(s.length)}},function(t,n,e){var r=e(34),s=e(20),i=e(36),o=e(81),a=e(235),d=e(46),c=e(19),u=e(236),m=e(139),y=e(237),S=TypeError,O=function(g,v){this.stopped=g,this.result=v},k=O.prototype;t.exports=function(g,v,ue){var L,re,le,oe,he,Ie,ie,Ne=ue&&ue.that,Ve=!(!ue||!ue.AS_ENTRIES),Ce=!(!ue||!ue.IS_RECORD),Ue=!(!ue||!ue.IS_ITERATOR),qe=!(!ue||!ue.INTERRUPTED),Oe=r(v,Ne),$e=function(er){return L&&y(L,"normal",er),new O(!0,er)},_e=function(er){return Ve?(i(er),qe?Oe(er[0],er[1],$e):Oe(er[0],er[1])):qe?Oe(er,$e):Oe(er)};if(Ce)L=g.iterator;else if(Ue)L=g;else{if(!(re=m(g)))throw S(o(g)+" is not iterable");if(a(re)){for(le=0,oe=d(g);oe>le;le++)if((he=_e(g[le]))&&c(k,he))return he;return new O(!1)}L=u(g,re)}for(Ie=Ce?g.next:L.next;!(ie=s(Ie,L)).done;){try{he=_e(ie.value)}catch(er){y(L,"throw",er)}if(typeof he=="object"&&he&&c(k,he))return he}return new O(!1)}},function(t,n,e){t.exports=e(563)},function(t,n){t.exports=!0},function(t,n,e){var r=e(67),s=String;t.exports=function(i){if(r(i)==="Symbol")throw TypeError("Cannot convert a Symbol value to a string");return s(i)}},function(t,n,e){var r=e(140),s=e(250);t.exports=function(i,o,a){return(o=s(o))in i?r(i,o,{value:a,enumerable:!0,configurable:!0,writable:!0}):i[o]=a,i},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,n,e){t.exports=e(255)},function(t,n,e){t.exports=e(481)},function(t,n,e){t.exports=e(484)},function(t,n,e){t.exports=e(487)},function(t,n,e){var r=e(258),s=typeof self=="object"&&self&&self.Object===Object&&self,i=r||s||Function("return this")();t.exports=i},function(t,n,e){var r=e(650)();t.exports=r;try{regeneratorRuntime=r}catch{typeof globalThis=="object"?globalThis.regeneratorRuntime=r:Function("r","regeneratorRuntime = r")(r)}},function(t,n,e){var r=e(288);function s(i,o,a,d,c,u,m){try{var y=i[u](m),S=y.value}catch(O){return void a(O)}y.done?o(S):r.resolve(S).then(d,c)}t.exports=function(i){return function(){var o=this,a=arguments;return new r(function(d,c){var u=i.apply(o,a);function m(S){s(u,d,c,m,y,"next",S)}function y(S){s(u,d,c,m,y,"throw",S)}m(void 0)})}},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,n,e){var r=e(721);t.exports=function(s,i,o){return o?r(s.entries(),function(a){return i(a[1],a[0])}):s.forEach(i)}},function(t,n,e){t.exports=e(585)},function(t,n,e){var r=e(27),s=e(39),i=e(80);t.exports=r?function(o,a,d){return s.f(o,a,i(1,d))}:function(o,a,d){return o[a]=d,o}},function(t,n,e){(function(r){var s=e(15),i=e(24),o=e(7),a=e(141),d=e(2),c=e(8),u=e(4),m=e(122),y=e(3),S=e(88),O=e(89),k=e(72),g=e(32);function v(At,kt){var Dt=O!==void 0&&k(At)||At["@@iterator"];if(!Dt){if(g(At)||(Dt=function(Ar,Fr){var Dr;if(Ar){if(typeof Ar=="string")return ue(Ar,Fr);var Or=s(Dr=Object.prototype.toString.call(Ar)).call(Dr,8,-1);if(Or==="Object"&&Ar.constructor&&(Or=Ar.constructor.name),Or==="Map"||Or==="Set")return S(Ar);if(Or==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(Or))return ue(Ar,Fr)}}(At))||kt&&At&&typeof At.length=="number"){Dt&&(At=Dt);var gr=0,yr=function(){};return{s:yr,n:function(){return gr>=At.length?{done:!0}:{done:!1,value:At[gr++]}},e:function(Ar){throw Ar},f:yr}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var vr,Ir=!0,Mr=!1;return{s:function(){Dt=Dt.call(At)},n:function(){var Ar=Dt.next();return Ir=Ar.done,Ar},e:function(Ar){Mr=!0,vr=Ar},f:function(){try{Ir||Dt.return==null||Dt.return()}finally{if(Mr)throw vr}}}}function ue(At,kt){(kt==null||kt>At.length)&&(kt=At.length);for(var Dt=0,gr=new Array(kt);Dt<kt;Dt++)gr[Dt]=At[Dt];return gr}var L=e(156);function re(){return typeof window<"u"?window:r!==void 0?r:typeof self<"u"?self:{}}function le(At){var kt;return s(kt=Object.prototype.toString.call(At)).call(kt,8,-1)}function oe(At){return le(At).toLowerCase()}function he(At){return oe(At)==="string"}function Ie(At){return oe(At)==="number"}function ie(At){return oe(At)==="array"}function Ne(At){return typeof At=="function"}function Ve(At){return oe(At)==="date"}function Ce(At){return At===null}function Ue(At){return At!==null}function qe(At){return At===void 0}function Oe(At){return At!==void 0}function $e(At){return Oe(At)&&Ue(At)}function _e(At){return qe(At)||Ce(At)}function er(At){return $e(At)&&oe(At)==="object"}var Pt=function(At,kt,Dt){At.addEventListener?At.addEventListener(kt,Dt,!1):At.attachEvent&&At.attachEvent("on"+kt,Dt)},ar=Pt,pr=function(At,kt,Dt){At.removeEventListener?At.removeEventListener(kt,Dt,!1):At.detachEvent&&At.detachEvent("on"+kt,Dt)},lr=pr;function or(){var At=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},kt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:function(){},Dt=arguments.length>2?arguments[2]:void 0;for(var gr in At)At.hasOwnProperty(gr)&&kt.call(Dt,gr,At[gr])}function xe(At,kt){or(kt,function(Dt,gr){At[Dt]=gr})}var nr,ir=(nr=0,function(){return""+nr++});function dr(At){return he(At)&&o(At).call(At,"{")===0&&a(At).call(At,"}")===At.length-1}function Lt(At,kt,Dt){if(!At)return"";var gr=[];return or(At,function(yr,vr){Ne(vr)||(Ve(vr)?vr=vr.getTime():ie(vr)?vr=vr.join(","):er(vr)&&(vr=c(vr)),Dt&&(vr=encodeURIComponent(vr)),gr.push(encodeURIComponent(yr)+"="+vr))}),gr.join(kt||",")}var cr,mr=(cr=/^([\w]+?:\/\/.*?(?=\/|$))/i,function(At){return cr.test(At||"")?RegExp.$1.toLowerCase():""});function tr(At){var kt=re();return At.tagName&&At.tagName.toUpperCase()==="INPUT"||kt.Blob&&At instanceof kt.Blob}t.exports={o:{},emptyObj:{},f:function(){},emptyFunc:function(){},regBlank:/\s+/gi,regWhiteSpace:/\s+/gi,getGlobal:re,getClass:le,typeOf:oe,isString:he,isNumber:Ie,isInt:function(At){return Ie(At)&&At%1==0},isBoolean:function(At){return oe(At)==="boolean"},isArray:ie,isFunction:Ne,isDate:Ve,isRegExp:function(At){return oe(At)==="regexp"},isError:function(At){return oe(At)==="error"},isnull:Ce,notnull:Ue,undef:qe,notundef:Oe,exist:$e,notexist:_e,isObject:er,isEmpty:function(At){return _e(At)||(he(At)||ie(At))&&At.length===0},remove:function(At){At.parentNode&&At.parentNode.removeChild(At)},dataset:function(At,kt,Dt){if(!$e(Dt))return At.getAttribute("data-"+kt);At.setAttribute("data-"+kt,Dt)},addEventListener:Pt,on:ar,removeEventListener:pr,off:lr,target:function(At){return At.target||At.srcElement},createIframe:function(At){if(typeof document<"u"){var kt;if((At=At||{}).name)try{(kt=document.createElement('<iframe name="'+At.name+'"></iframe>')).frameBorder=0}catch{(kt=document.createElement("iframe")).name=At.name}else kt=document.createElement("iframe");At.visible||(kt.style.display="none"),Ne(At.onload)&&ar(kt,"load",function gr(yr){kt.src&&(At.multi||lr(kt,"load",gr),At.onload(yr))}),(At.parent||document.body).appendChild(kt);var Dt=At.src||"about:blank";return i(function(){kt.src=Dt},0),kt}},html2node:function(At){if(typeof document<"u"){var kt=document.createElement("div");kt.innerHTML=At;var Dt,gr,yr=[];if(kt.children)for(Dt=0,gr=kt.children.length;Dt<gr;Dt++)yr.push(kt.children[Dt]);else for(Dt=0,gr=kt.childNodes.length;Dt<gr;Dt++){var vr=kt.childNodes[Dt];vr.nodeType===1&&yr.push(vr)}return yr.length>1?kt:yr[0]}},forOwn:or,mixin:xe,uniqueID:ir,isJSON:dr,parseJSON:function At(kt){try{dr(kt)&&(kt=JSON.parse(kt)),er(kt)&&or(kt,function(Dt,gr){switch(oe(gr)){case"string":case"object":kt[Dt]=At(gr)}})}catch{}return kt},simpleClone:function(At){return L(At)},merge:function(){for(var At=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},kt=arguments.length,Dt=new Array(kt>1?kt-1:0),gr=1;gr<kt;gr++)Dt[gr-1]=arguments[gr];return d(Dt).call(Dt,function(yr){xe(At,yr)}),At},fillUndef:function(At,kt){return or(kt,function(Dt,gr){qe(At[Dt])&&(At[Dt]=gr)}),At},checkWithDefault:function(At,kt,Dt){var gr=At[kt]||At[kt.toLowerCase()];return _e(gr)&&(gr=Dt,At[kt]=gr),gr},fetch:function(At,kt){return or(At,function(Dt){$e(kt[Dt])&&(At[Dt]=kt[Dt])}),At},string2object:function(){var At,kt=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",Dt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:",",gr={};return d(At=kt.split(Dt)).call(At,function(yr){var vr=yr.split("="),Ir=vr.shift();Ir&&(gr[decodeURIComponent(Ir)]=decodeURIComponent(vr.join("=")))}),gr},object2string:Lt,genUrlSep:function(At){return o(At).call(At,"?")<0?"?":"&"},object2query:function(At){return Lt(At,"&",!0)},url2origin:mr,isFileInput:tr,getKeys:function(At,kt){var Dt=u(At);return kt&&m(Dt).call(Dt,function(gr,yr){var vr=tr(At[gr]);return vr===tr(At[yr])?0:vr?1:-1}),Dt},_get:function(At,kt){var Dt,gr=arguments.length>2&&arguments[2]!==void 0?arguments[2]:void 0,yr=kt.replace(/\[(\d+)\]/g,".$1").split("."),vr=At,Ir=v(yr);try{for(Ir.s();!(Dt=Ir.n()).done;){var Mr=Dt.value;if((vr=Object(vr)[Mr])===void 0)return gr}}catch(Ar){Ir.e(Ar)}finally{Ir.f()}return vr},getPromiseWithAbort:function(At){var kt={},Dt=new y(function(gr,yr){kt.abort=yr});return kt.promise=y.race([At,Dt]),kt}}}).call(this,e(73))},function(t,n,e){var r=e(33),s=e(718),i=r("Map");t.exports={Map:i,set:s("set",2),get:s("get",1),has:s("has",1),remove:s("delete",1),proto:i.prototype}},function(t,n,e){(function(r){var s=e(15),i=e(7),o=e(303),a=e(48),d=e(22),c=function(){var u=(r===void 0?"undefined":d(r))==="object"?r:window,m=Math.pow(2,53)-1,y=/\bOpera/,S=Object.prototype,O=S.hasOwnProperty,k=S.toString;function g(he){return(he=String(he)).charAt(0).toUpperCase()+s(he).call(he,1)}function v(he){return he=oe(he),/^(?:webOS|i(?:OS|P))/.test(he)?he:g(he)}function ue(he,Ie){for(var ie in he)O.call(he,ie)&&Ie(he[ie],ie,he)}function L(he){var Ie;return he==null?g(he):s(Ie=k.call(he)).call(Ie,8,-1)}function re(he){return String(he).replace(/([ -])(?!$)/g,"$1?")}function le(he,Ie){var ie=null;return function(Ne,Ve){var Ce=-1,Ue=Ne?Ne.length:0;if(typeof Ue=="number"&&Ue>-1&&Ue<=m)for(;++Ce<Ue;)Ve(Ne[Ce],Ce,Ne);else ue(Ne,Ve)}(he,function(Ne,Ve){ie=Ie(ie,Ne,Ve,he)}),ie}function oe(he){return String(he).replace(/^ +| +$/g,"")}return function he(Ie){var ie=u,Ne=Ie&&d(Ie)==="object"&&L(Ie)!="String";Ne&&(ie=Ie,Ie=null);var Ve=ie.navigator||{},Ce=Ve.userAgent||"";Ie||(Ie=Ce);var Ue,qe,Oe,$e,_e,er=Ne?!!Ve.likeChrome:/\bChrome\b/.test(Ie)&&!/internal|\n/i.test(k.toString()),Pt=Ne?"Object":"ScriptBridgingProxyObject",ar=Ne?"Object":"Environment",pr=Ne&&ie.java?"JavaPackage":L(ie.java),lr=Ne?"Object":"RuntimeObject",or=/\bJava/.test(pr)&&ie.java,xe=or&&L(ie.environment)==ar,nr=or?"a":"α",ir=or?"b":"β",dr=ie.document||{},Lt=ie.operamini||ie.opera,cr=y.test(cr=Ne&&Lt?Lt["[[Class]]"]:L(Lt))?cr:Lt=null,mr=Ie,tr=[],At=null,kt=Ie==Ce,Dt=kt&&Lt&&typeof Lt.version=="function"&&Lt.version(),gr=le([{label:"EdgeHTML",pattern:"Edge"},"Trident",{label:"WebKit",pattern:"AppleWebKit"},"iCab","Presto","NetFront","Tasman","KHTML","Gecko"],function(Sn,Rr){return Sn||RegExp("\\b"+(Rr.pattern||re(Rr))+"\\b","i").exec(Ie)&&(Rr.label||Rr)}),yr=function(Sn){return le(Sn,function(Rr,Wr){return Rr||RegExp("\\b"+(Wr.pattern||re(Wr))+"\\b","i").exec(Ie)&&(Wr.label||Wr)})}(["Adobe AIR","Arora","Avant Browser","Breach","Camino","Electron","Epiphany","Fennec","Flock","Galeon","GreenBrowser","iCab","Iceweasel","K-Meleon","Konqueror","Lunascape","Maxthon",{label:"Microsoft Edge",pattern:"Edge"},"Midori","Nook Browser","PaleMoon","PhantomJS","Raven","Rekonq","RockMelt",{label:"Samsung Internet",pattern:"SamsungBrowser"},"SeaMonkey",{label:"Silk",pattern:"(?:Cloud9|Silk-Accelerated)"},"Sleipnir","SlimBrowser",{label:"SRWare Iron",pattern:"Iron"},"Sunrise","Swiftfox","Waterfox","WebPositive","Opera Mini",{label:"Opera Mini",pattern:"OPiOS"},"Opera",{label:"Opera",pattern:"OPR"},"Chrome",{label:"Chrome",pattern:"(?:HeadlessChrome)"},{label:"Chrome Mobile",pattern:"(?:CriOS|CrMo)"},{label:"Firefox",pattern:"(?:Firefox|Minefield)"},{label:"Firefox for iOS",pattern:"FxiOS"},{label:"IE",pattern:"IEMobile"},{label:"IE",pattern:"MSIE"},"Safari"]),vr=Ar([{label:"BlackBerry",pattern:"BB10"},"BlackBerry",{label:"Galaxy S",pattern:"GT-I9000"},{label:"Galaxy S2",pattern:"GT-I9100"},{label:"Galaxy S3",pattern:"GT-I9300"},{label:"Galaxy S4",pattern:"GT-I9500"},{label:"Galaxy S5",pattern:"SM-G900"},{label:"Galaxy S6",pattern:"SM-G920"},{label:"Galaxy S6 Edge",pattern:"SM-G925"},{label:"Galaxy S7",pattern:"SM-G930"},{label:"Galaxy S7 Edge",pattern:"SM-G935"},"Google TV","Lumia","iPad","iPod","iPhone","Kindle",{label:"Kindle Fire",pattern:"(?:Cloud9|Silk-Accelerated)"},"Nexus","Nook","PlayBook","PlayStation Vita","PlayStation","TouchPad","Transformer",{label:"Wii U",pattern:"WiiU"},"Wii","Xbox One",{label:"Xbox 360",pattern:"Xbox"},"Xoom"]),Ir=function(Sn){return le(Sn,function(Rr,Wr,Er){return Rr||(Wr[vr]||Wr[/^[a-z]+(?: +[a-z]+\b)*/i.exec(vr)]||RegExp("\\b"+re(Er)+"(?:\\b|\\w*\\d)","i").exec(Ie))&&Er})}({Apple:{iPad:1,iPhone:1,iPod:1},Archos:{},Amazon:{Kindle:1,"Kindle Fire":1},Asus:{Transformer:1},"Barnes & Noble":{Nook:1},BlackBerry:{PlayBook:1},Google:{"Google TV":1,Nexus:1},HP:{TouchPad:1},HTC:{},LG:{},Microsoft:{Xbox:1,"Xbox One":1},Motorola:{Xoom:1},Nintendo:{"Wii U":1,Wii:1},Nokia:{Lumia:1},Samsung:{"Galaxy S":1,"Galaxy S2":1,"Galaxy S3":1,"Galaxy S4":1},Sony:{PlayStation:1,"PlayStation Vita":1}}),Mr=function(Sn){return le(Sn,function(Rr,Wr){var Er=Wr.pattern||re(Wr);return!Rr&&(Rr=RegExp("\\b"+Er+"(?:/[\\d.]+|[ \\w.]*)","i").exec(Ie))&&(Rr=function(Ur,Zr,In){var An={"10.0":"10",6.4:"10 Technical Preview",6.3:"8.1",6.2:"8",6.1:"Server 2008 R2 / 7","6.0":"Server 2008 / Vista",5.2:"Server 2003 / XP 64-bit",5.1:"XP",5.01:"2000 SP1","5.0":"2000","4.0":"NT","4.90":"ME"};return Zr&&In&&/^Win/i.test(Ur)&&!/^Windows Phone /i.test(Ur)&&(An=An[/[\d.]+$/.exec(Ur)])&&(Ur="Windows "+An),Ur=String(Ur),Zr&&In&&(Ur=Ur.replace(RegExp(Zr,"i"),In)),Ur=v(Ur.replace(/ ce$/i," CE").replace(/\bhpw/i,"web").replace(/\bMacintosh\b/,"Mac OS").replace(/_PowerPC\b/i," OS").replace(/\b(OS X) [^ \d]+/i,"$1").replace(/\bMac (OS X)\b/,"$1").replace(/\/(\d)/," $1").replace(/_/g,".").replace(/(?: BePC|[ .]*fc[ \d.]+)$/i,"").replace(/\bx86\.64\b/gi,"x86_64").replace(/\b(Windows Phone) OS\b/,"$1").replace(/\b(Chrome OS \w+) [\d.]+\b/,"$1").split(" on ")[0])}(Rr,Er,Wr.label||Wr)),Rr})}(["Windows Phone","Android","CentOS",{label:"Chrome OS",pattern:"CrOS"},"Debian","Fedora","FreeBSD","Gentoo","Haiku","Kubuntu","Linux Mint","OpenBSD","Red Hat","SuSE","Ubuntu","Xubuntu","Cygwin","Symbian OS","hpwOS","webOS ","webOS","Tablet OS","Tizen","Linux","Mac OS X","Macintosh","Mac","Windows 98;","Windows "]);function Ar(Sn){return le(Sn,function(Rr,Wr){var Er=Wr.pattern||re(Wr);return!Rr&&(Rr=RegExp("\\b"+Er+" *\\d+[.\\w_]*","i").exec(Ie)||RegExp("\\b"+Er+" *\\w+-[\\w]*","i").exec(Ie)||RegExp("\\b"+Er+"(?:; *(?:[a-z]+[_-])?[a-z]+\\d+|[^ ();-]*)","i").exec(Ie))&&((Rr=String(Wr.label&&!RegExp(Er,"i").test(Wr.label)?Wr.label:Rr).split("/"))[1]&&!/[\d.]+/.test(Rr[0])&&(Rr[0]+=" "+Rr[1]),Wr=Wr.label||Wr,Rr=v(Rr[0].replace(RegExp(Er,"i"),Wr).replace(RegExp("; *(?:"+Wr+"[_-])?","i")," ").replace(RegExp("("+Wr+")[-_.]?(\\w)","i"),"$1 $2"))),Rr})}if(gr&&(gr=[gr]),Ir&&!vr&&(vr=Ar([Ir])),(Ue=/\bGoogle TV\b/.exec(vr))&&(vr=Ue[0]),/\bSimulator\b/i.test(Ie)&&(vr=(vr?vr+" ":"")+"Simulator"),yr=="Opera Mini"&&/\bOPiOS\b/.test(Ie)&&tr.push("running in Turbo/Uncompressed mode"),yr=="IE"&&/\blike iPhone OS\b/.test(Ie)?(Ir=(Ue=he(Ie.replace(/like iPhone OS/,""))).manufacturer,vr=Ue.product):/^iP/.test(vr)?(yr||(yr="Safari"),Mr="iOS"+((Ue=/ OS ([\d_]+)/i.exec(Ie))?" "+Ue[1].replace(/_/g,"."):"")):yr!="Konqueror"||/buntu/i.test(Mr)?Ir&&Ir!="Google"&&(/Chrome/.test(yr)&&!/\bMobile Safari\b/i.test(Ie)||/\bVita\b/.test(vr))||/\bAndroid\b/.test(Mr)&&/^Chrome/.test(yr)&&/\bVersion\//i.test(Ie)?(yr="Android Browser",Mr=/\bAndroid\b/.test(Mr)?Mr:"Android"):yr=="Silk"?(/\bMobi/i.test(Ie)||(Mr="Android",tr.unshift("desktop mode")),/Accelerated *= *true/i.test(Ie)&&tr.unshift("accelerated")):yr=="PaleMoon"&&(Ue=/\bFirefox\/([\d.]+)\b/.exec(Ie))?tr.push("identifying as Firefox "+Ue[1]):yr=="Firefox"&&(Ue=/\b(Mobile|Tablet|TV)\b/i.exec(Ie))?(Mr||(Mr="Firefox OS"),vr||(vr=Ue[1])):!yr||(Ue=!/\bMinefield\b/i.test(Ie)&&/\b(?:Firefox|Safari)\b/.exec(yr))?(yr&&!vr&&/[\/,]|^[^(]+?\)/.test(s(Ie).call(Ie,i(Ie).call(Ie,Ue+"/")+8))&&(yr=null),(Ue=vr||Ir||Mr)&&(vr||Ir||/\b(?:Android|Symbian OS|Tablet OS|webOS)\b/.test(Mr))&&(yr=/[a-z]+(?: Hat)?/i.exec(/\bAndroid\b/.test(Mr)?Mr:Ue)+" Browser")):yr=="Electron"&&(Ue=(/\bChrome\/([\d.]+)\b/.exec(Ie)||0)[1])&&tr.push("Chromium "+Ue):Mr="Kubuntu",Dt||(Dt=le(["(?:Cloud9|CriOS|CrMo|Edge|FxiOS|IEMobile|Iron|Opera ?Mini|OPiOS|OPR|Raven|SamsungBrowser|Silk(?!/[\\d.]+$))","Version","HeadlessChrome",re(yr),"(?:Firefox|Minefield|NetFront)"],function(Sn,Rr){return Sn||(RegExp(Rr+"(?:-[\\d.]+/|(?: for [\\w-]+)?[ /-])([\\d.]+[^ ();/_-]*)","i").exec(Ie)||0)[1]||null})),(Ue=(gr=="iCab"&&o(Dt)>3?"WebKit":/\bOpera\b/.test(yr)&&(/\bOPR\b/.test(Ie)?"Blink":"Presto"))||/\b(?:Midori|Nook|Safari)\b/i.test(Ie)&&!/^(?:Trident|EdgeHTML)$/.test(gr)&&"WebKit"||!gr&&/\bMSIE\b/i.test(Ie)&&(Mr=="Mac OS"?"Tasman":"Trident")||gr=="WebKit"&&/\bPlayStation\b(?! Vita\b)/i.test(yr)&&"NetFront")&&(gr=[Ue]),yr=="IE"&&(Ue=(/; *(?:XBLWP|ZuneWP)(\d+)/i.exec(Ie)||0)[1])?(yr+=" Mobile",Mr="Windows Phone "+(/\+$/.test(Ue)?Ue:Ue+".x"),tr.unshift("desktop mode")):/\bWPDesktop\b/i.test(Ie)?(yr="IE Mobile",Mr="Windows Phone 8.x",tr.unshift("desktop mode"),Dt||(Dt=(/\brv:([\d.]+)/.exec(Ie)||0)[1])):yr!="IE"&&gr=="Trident"&&(Ue=/\brv:([\d.]+)/.exec(Ie))&&(yr&&tr.push("identifying as "+yr+(Dt?" "+Dt:"")),yr="IE",Dt=Ue[1]),kt){if($e="global",_e=(Oe=ie)!=null?d(Oe[$e]):"number",/^(?:boolean|number|string|undefined)$/.test(_e)||_e=="object"&&!Oe[$e])L(Ue=ie.runtime)==Pt?(yr="Adobe AIR",Mr=Ue.flash.system.Capabilities.os):L(Ue=ie.phantom)==lr?(yr="PhantomJS",Dt=(Ue=Ue.version||null)&&Ue.major+"."+Ue.minor+"."+Ue.patch):typeof dr.documentMode=="number"&&(Ue=/\bTrident\/(\d+)/i.exec(Ie))?(Dt=[Dt,dr.documentMode],(Ue=+Ue[1]+4)!=Dt[1]&&(tr.push("IE "+Dt[1]+" mode"),gr&&(gr[1]=""),Dt[1]=Ue),Dt=yr=="IE"?String(Dt[1].toFixed(1)):Dt[0]):typeof dr.documentMode=="number"&&/^(?:Chrome|Firefox)\b/.test(yr)&&(tr.push("masking as "+yr+" "+Dt),yr="IE",Dt="11.0",gr=["Trident"],Mr="Windows");else if(or&&(mr=(Ue=or.lang.System).getProperty("os.arch"),Mr=Mr||Ue.getProperty("os.name")+" "+Ue.getProperty("os.version")),xe){try{Dt=ie.require("ringo/engine").version.join("."),yr="RingoJS"}catch{(Ue=ie.system)&&Ue.global.system==ie.system&&(yr="Narwhal",Mr||(Mr=Ue[0].os||null))}yr||(yr="Rhino")}else d(ie.process)==="object"&&!ie.process.browser&&(Ue=ie.process)&&(d(Ue.versions)==="object"&&(typeof Ue.versions.electron=="string"?(tr.push("Node "+Ue.versions.node),yr="Electron",Dt=Ue.versions.electron):typeof Ue.versions.nw=="string"&&(tr.push("Chromium "+Dt,"Node "+Ue.versions.node),yr="NW.js",Dt=Ue.versions.nw)),yr||(yr="Node.js",mr=Ue.arch,Mr=Ue.platform,Dt=(Dt=/[\d.]+/.exec(Ue.version))?Dt[0]:null));Mr=Mr&&v(Mr)}if(Dt&&(Ue=/(?:[ab]|dp|pre|[ab]\d+pre)(?:\d+\+?)?$/i.exec(Dt)||/(?:alpha|beta)(?: ?\d)?/i.exec(Ie+";"+(kt&&Ve.appMinorVersion))||/\bMinefield\b/i.test(Ie)&&"a")&&(At=/b/i.test(Ue)?"beta":"alpha",Dt=Dt.replace(RegExp(Ue+"\\+?$"),"")+(At=="beta"?ir:nr)+(/\d+\+?/.exec(Ue)||"")),yr=="Fennec"||yr=="Firefox"&&/\b(?:Android|Firefox OS)\b/.test(Mr))yr="Firefox Mobile";else if(yr=="Maxthon"&&Dt)Dt=Dt.replace(/\.[\d.]+/,".x");else if(/\bXbox\b/i.test(vr))vr=="Xbox 360"&&(Mr=null),vr=="Xbox 360"&&/\bIEMobile\b/.test(Ie)&&tr.unshift("mobile mode");else if(!/^(?:Chrome|IE|Opera)$/.test(yr)&&(!yr||vr||/Browser|Mobi/.test(yr))||Mr!="Windows CE"&&!/Mobi/i.test(Ie))if(yr=="IE"&&kt)try{ie.external===null&&tr.unshift("platform preview")}catch{tr.unshift("embedded")}else(/\bBlackBerry\b/.test(vr)||/\bBB10\b/.test(Ie))&&(Ue=(RegExp(vr.replace(/ +/g," *")+"/([.\\d]+)","i").exec(Ie)||0)[1]||Dt)?(Mr=((Ue=[Ue,/BB10/.test(Ie)])[1]?(vr=null,Ir="BlackBerry"):"Device Software")+" "+Ue[0],Dt=null):this!=ue&&vr!="Wii"&&(kt&&Lt||/Opera/.test(yr)&&/\b(?:MSIE|Firefox)\b/i.test(Ie)||yr=="Firefox"&&/\bOS X (?:\d+\.){2,}/.test(Mr)||yr=="IE"&&(Mr&&!/^Win/.test(Mr)&&Dt>5.5||/\bWindows XP\b/.test(Mr)&&Dt>8||Dt==8&&!/\bTrident\b/.test(Ie)))&&!y.test(Ue=he.call(ue,Ie.replace(y,"")+";"))&&Ue.name&&(Ue="ing as "+Ue.name+((Ue=Ue.version)?" "+Ue:""),y.test(yr)?(/\bIE\b/.test(Ue)&&Mr=="Mac OS"&&(Mr=null),Ue="identify"+Ue):(Ue="mask"+Ue,yr=cr?v(cr.replace(/([a-z])([A-Z])/g,"$1 $2")):"Opera",/\bIE\b/.test(Ue)&&(Mr=null),kt||(Dt=null)),gr=["Presto"],tr.push(Ue));else yr+=" Mobile";if(Ue=(/\bAppleWebKit\/([\d.]+\+?)/i.exec(Ie)||0)[1]){var Fr,Dr;Ue=[o(Ue.replace(/\.(\d)$/,".0$1")),Ue],yr=="Safari"&&s(Fr=Ue[1]).call(Fr,-1)=="+"?(yr="WebKit Nightly",At="alpha",Dt=s(Dr=Ue[1]).call(Dr,0,-1)):Dt!=Ue[1]&&Dt!=(Ue[2]=(/\bSafari\/([\d.]+\+?)/i.exec(Ie)||0)[1])||(Dt=null),Ue[1]=(/\b(?:Headless)?Chrome\/([\d.]+)/i.exec(Ie)||0)[1],Ue[0]==537.36&&Ue[2]==537.36&&o(Ue[1])>=28&&gr=="WebKit"&&(gr=["Blink"]),kt&&(er||Ue[1])?(gr&&(gr[1]="like Chrome"),Ue=Ue[1]||((Ue=Ue[0])<530?1:Ue<532?2:Ue<532.05?3:Ue<533?4:Ue<534.03?5:Ue<534.07?6:Ue<534.1?7:Ue<534.13?8:Ue<534.16?9:Ue<534.24?10:Ue<534.3?11:Ue<535.01?12:Ue<535.02?"13+":Ue<535.07?15:Ue<535.11?16:Ue<535.19?17:Ue<536.05?18:Ue<536.1?19:Ue<537.01?20:Ue<537.11?"21+":Ue<537.13?23:Ue<537.18?24:Ue<537.24?25:Ue<537.36?26:gr!="Blink"?"27":"28")):(gr&&(gr[1]="like Safari"),Ue=(Ue=Ue[0])<400?1:Ue<500?2:Ue<526?3:Ue<533?4:Ue<534?"4+":Ue<535?5:Ue<537?6:Ue<538?7:Ue<601?8:"8"),gr&&(gr[1]+=" "+(Ue+=typeof Ue=="number"?".x":/[.+]/.test(Ue)?"":"+")),yr=="Safari"&&(!Dt||a(Dt)>45)&&(Dt=Ue)}yr=="Opera"&&(Ue=/\bzbov|zvav$/.exec(Mr))?(yr+=" ",tr.unshift("desktop mode"),Ue=="zvav"?(yr+="Mini",Dt=null):yr+="Mobile",Mr=Mr.replace(RegExp(" *"+Ue+"$"),"")):yr=="Safari"&&/\bChrome\b/.exec(gr&&gr[1])&&(tr.unshift("desktop mode"),yr="Chrome Mobile",Dt=null,/\bOS X\b/.test(Mr)?(Ir="Apple",Mr="iOS 4.3+"):Mr=null),Dt&&i(Dt).call(Dt,Ue=/[\d.]+$/.exec(Mr))==0&&i(Ie).call(Ie,"/"+Ue+"-")>-1&&(Mr=oe(Mr.replace(Ue,""))),gr&&!/\b(?:Avant|Nook)\b/.test(yr)&&(/Browser|Lunascape|Maxthon/.test(yr)||yr!="Safari"&&/^iOS/.test(Mr)&&/\bSafari\b/.test(gr[1])||/^(?:Adobe|Arora|Breach|Midori|Opera|Phantom|Rekonq|Rock|Samsung Internet|Sleipnir|Web)/.test(yr)&&gr[1])&&(Ue=gr[gr.length-1])&&tr.push(Ue),tr.length&&(tr=["("+tr.join("; ")+")"]),Ir&&vr&&i(vr).call(vr,Ir)<0&&tr.push("on "+Ir),vr&&tr.push((/^on /.test(tr[tr.length-1])?"":"on ")+vr),Mr&&(Ue=/ ([\d.+]+)$/.exec(Mr),qe=Ue&&Mr.charAt(Mr.length-Ue[0].length-1)=="/",Mr={architecture:32,family:Ue&&!qe?Mr.replace(Ue[0],""):Mr,version:Ue?Ue[1]:null,toString:function(){var Sn=this.version;return this.family+(Sn&&!qe?" "+Sn:"")+(this.architecture==64?" 64-bit":"")}}),(Ue=/\b(?:AMD|IA|Win|WOW|x86_|x)64\b/i.exec(mr))&&!/\bi686\b/i.test(mr)?(Mr&&(Mr.architecture=64,Mr.family=Mr.family.replace(RegExp(" *"+Ue),"")),yr&&(/\bWOW64\b/i.test(Ie)||kt&&/\w(?:86|32)$/.test(Ve.cpuClass||Ve.platform)&&!/\bWin64; x64\b/i.test(Ie))&&tr.unshift("32-bit")):Mr&&/^OS X/.test(Mr.family)&&yr=="Chrome"&&o(Dt)>=39&&(Mr.architecture=64),Ie||(Ie=null);var Or={};return Or.description=Ie,Or.layout=gr&&gr[0],Or.manufacturer=Ir,Or.name=yr,Or.prerelease=At,Or.product=vr,Or.ua=Ie,Or.version=yr&&Dt,Or.os=Mr||{architecture:null,family:null,version:null,toString:function(){return"null"}},Or.parse=he,Or.toString=function(){return this.description||""},Or.version&&tr.unshift(Dt),Or.name&&tr.unshift(yr),Mr&&yr&&(Mr!=String(Mr).split(" ")[0]||Mr!=yr.split(" ")[0]&&!vr)&&tr.push(vr?"("+Mr+")":"on "+Mr),tr.length&&(Or.description=tr.join(" ")),Or}()}();t.exports=c}).call(this,e(73))},function(t,n,e){var r=e(12),s=r({}.toString),i=r("".slice);t.exports=function(o){return i(s(o),8,-1)}},function(t,n,e){var r=e(33);t.exports=r("navigator","userAgent")||""},function(t,n,e){var r=e(165),s=e(17),i=e(65),o=e(21)("toStringTag"),a=Object,d=i(function(){return arguments}())=="Arguments";t.exports=r?i:function(c){var u,m,y;return c===void 0?"Undefined":c===null?"Null":typeof(m=function(S,O){try{return S[O]}catch{}}(u=a(c),o))=="string"?m:d?i(u):(y=i(u))=="Object"&&s(u.callee)?"Arguments":y}},function(t,n,e){var r=e(61);t.exports=function(s,i,o,a){return a&&a.enumerable?s[i]=o:r(s,i,o),s}},function(t,n,e){e(86);var r=e(356),s=e(14),i=e(67),o=e(61),a=e(103),d=e(21)("toStringTag");for(var c in r){var u=s[c],m=u&&u.prototype;m&&i(m)!==d&&o(m,d,c),a[c]=a.Array}},function(t,n,e){var r=e(31),s=TypeError,i=function(o){var a,d;this.promise=new o(function(c,u){if(a!==void 0||d!==void 0)throw s("Bad Promise constructor");a=c,d=u}),this.resolve=r(a),this.reject=r(d)};t.exports.f=function(o){return new i(o)}},function(t,n,e){t.exports=e(427)},function(t,n,e){t.exports=e(475)},function(t,n){var e;e=function(){return this}();try{e=e||new Function("return this")()}catch{typeof window=="object"&&(e=window)}t.exports=e},function(t,n,e){var r=e(34),s=e(12),i=e(127),o=e(42),a=e(46),d=e(164),c=s([].push),u=function(m){var y=m==1,S=m==2,O=m==3,k=m==4,g=m==6,v=m==7,ue=m==5||g;return function(L,re,le,oe){for(var he,Ie,ie=o(L),Ne=i(ie),Ve=r(re,le),Ce=a(Ne),Ue=0,qe=oe||d,Oe=y?qe(L,Ce):S||v?qe(L,0):void 0;Ce>Ue;Ue++)if((ue||Ue in Ne)&&(Ie=Ve(he=Ne[Ue],Ue,ie),m))if(y)Oe[Ue]=Ie;else if(Ie)switch(m){case 3:return!0;case 5:return he;case 6:return Ue;case 2:c(Oe,he)}else switch(m){case 4:return!1;case 7:c(Oe,he)}return g?-1:O||k?k:Oe}};t.exports={forEach:u(0),map:u(1),filter:u(2),some:u(3),every:u(4),find:u(5),findIndex:u(6),filterReject:u(7)}},function(t,n,e){var r=e(771);r.fn=r.prototype,t.exports=r,e(773),e(774),e(775),e(776),e(777),e(778),e(779),e(780),e(781),e(782),e(783)},function(t,n,e){var r=e(22),s=e(4),i=e(8),o=e(16),a=e(2),d=e(9),c=e(15),u=e(88),m=e(89),y=e(72),S=e(32);function O(Ce,Ue){var qe=m!==void 0&&y(Ce)||Ce["@@iterator"];if(!qe){if(S(Ce)||(qe=function(ar,pr){var lr;if(ar){if(typeof ar=="string")return k(ar,pr);var or=c(lr=Object.prototype.toString.call(ar)).call(lr,8,-1);if(or==="Object"&&ar.constructor&&(or=ar.constructor.name),or==="Map"||or==="Set")return u(ar);if(or==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(or))return k(ar,pr)}}(Ce))||Ue&&Ce&&typeof Ce.length=="number"){qe&&(Ce=qe);var Oe=0,$e=function(){};return{s:$e,n:function(){return Oe>=Ce.length?{done:!0}:{done:!1,value:Ce[Oe++]}},e:function(ar){throw ar},f:$e}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var _e,er=!0,Pt=!1;return{s:function(){qe=qe.call(Ce)},n:function(){var ar=qe.next();return er=ar.done,ar},e:function(ar){Pt=!0,_e=ar},f:function(){try{er||qe.return==null||qe.return()}finally{if(Pt)throw _e}}}}function k(Ce,Ue){(Ue==null||Ue>Ce.length)&&(Ue=Ce.length);for(var qe=0,Oe=new Array(Ue);qe<Ue;qe++)Oe[qe]=Ce[qe];return Oe}var g=e(0),v=g.undef,ue=g.notundef,L=g.exist,re=e(195),le=e(297),oe={p2p:0,team:1,superTeam:5},he={0:"p2p",1:"team",5:"superTeam"},Ie=s(oe),ie=le.typeMap,Ne=le.validTypes;function Ve(Ce){g.verifyOptions(Ce,"scene to type","msg::Message"),g.verifyParamValid("scene",Ce.scene,Ie,"msg::Message"),this.scene=oe[Ce.scene],this.to=""+Ce.to,this.type=ie[Ce.type],this.resend=Ce.resend?1:0,Ce.resend?(g.verifyOptions(Ce,"idClient","msg::Message"),this.idClient=Ce.idClient):this.idClient=g.guid(),ue(Ce.subType)&&(g.isInt(+Ce.subType)&&+Ce.subType>0?this.subType=+Ce.subType:g.onParamError("subType只能是大于0的整数","msg::Message"));var Ue=Ce.replyMsg;Ue&&Ue.idServer&&Ue.from&&Ue.to&&Ue.time&&(this.replyMsgFromAccount=Ue.from,this.replyMsgToAccount=Ue.to,this.replyMsgTime=Ue.time,this.replyMsgIdServer=Ue.idServer,this.replyMsgIdClient=Ue.idClient,Ue.threadMsgFromAccount&&Ue.threadMsgIdServer&&Ue.threadMsgTime&&Ue.threadMsgToAccount?(this.threadMsgFromAccount=Ue.threadMsgFromAccount,this.threadMsgToAccount=Ue.threadMsgToAccount,this.threadMsgTime=Ue.threadMsgTime,this.threadMsgIdServer=Ue.threadMsgIdServer,this.threadMsgIdClient=Ue.threadMsgIdClient):(this.threadMsgFromAccount=Ue.from,this.threadMsgToAccount=Ue.to,this.threadMsgTime=Ue.time,this.threadMsgIdServer=Ue.idServer,this.threadMsgIdClient=Ue.idClient)),ue(Ce.text)&&(this.body=""+Ce.text),ue(Ce.custom)&&(r(Ce.custom)==="object"?this.custom=i(Ce.custom):this.custom=""+Ce.custom),ue(Ce.body)&&(this.body=""+Ce.body),ue(Ce.pushContent)&&(this.pushContent=""+Ce.pushContent),ue(Ce.pushPayload)&&(this.pushPayload=""+Ce.pushPayload);var qe=Ce.apns;if(ue(qe)&&Ce.scene==="team"){var Oe=qe.accounts;ue(Oe)&&g.verifyParamType("apns.accounts",Oe,"array","msg::Message"),this.apnsAccounts=Oe?i(Oe):"#%@all@%#",this.apnsContent=qe.content||Ce.pushContent||"",g.verifyBooleanWithDefault(qe,"forcePush",!0,"options.apns","msg::Message"),this.apnsForcePush=qe.forcePush?1:0}var $e=Ce.robotInfo;ue($e)&&(Ce.scene==="team"&&g.verifyOptions(Ce.robotInfo,"account","msg::Message::robotInfo scene === team"),$e.function&&(this.robotInfoFunction=$e.function),$e.topic&&(this.robotInfoTopic=$e.topic),$e.customContent&&(this.robotInfoCustomContent=$e.customContent),$e.account&&(this.robotInfoAccount=$e.account)),ue(Ce.isHistoryable)&&(this.isHistoryable=Ce.isHistoryable?1:0),ue(Ce.isRoamingable)&&(this.isRoamingable=Ce.isRoamingable?1:0),ue(Ce.isSyncable)&&(this.isSyncable=Ce.isSyncable?1:0),ue(Ce.cc)&&(this.cc=Ce.cc?1:0),ue(Ce.env)&&(this.env=Ce.env),ue(Ce.isPushable)&&(this.isPushable=Ce.isPushable?1:0),ue(Ce.isOfflinable)&&(this.isOfflinable=Ce.isOfflinable?1:0),ue(Ce.isUnreadable)&&(this.isUnreadable=Ce.isUnreadable?1:0),ue(Ce.needPushNick)&&(this.needPushNick=Ce.needPushNick?1:0),ue(Ce.needMsgReceipt)&&(this.needMsgReceipt=Ce.needMsgReceipt?1:0),ue(Ce.yidunEnable)&&(this.yidunEnable=Ce.yidunEnable?1:0),this.needUpdateSession=Ce.needUpdateSession===!1?0:1,ue(Ce.antiSpamUsingYidun)&&(this.antiSpamUsingYidun=Ce.antiSpamUsingYidun?1:0),ue(Ce.clientAntiSpam)&&(this.clientAntiSpam=Ce.clientAntiSpam?1:0),ue(Ce.antiSpamContent)&&(r(Ce.antiSpamContent)==="object"?this.antiSpamContent=i(Ce.antiSpamContent):this.antiSpamContent=""+Ce.antiSpamContent),ue(Ce.antiSpamBusinessId)&&(r(Ce.antiSpamBusinessId)==="object"?this.antiSpamBusinessId=i(Ce.antiSpamBusinessId):this.antiSpamBusinessId=""+Ce.antiSpamBusinessId),ue(Ce.yidunAntiCheating)&&(this.yidunAntiCheating=Ce.yidunAntiCheating),ue(Ce.yidunAntiSpamExt)&&(this.yidunAntiSpamExt=Ce.yidunAntiSpamExt)}g.merge(Ve.prototype,le.prototype),Ve.prototype.getScene=function(){return he[this.scene]},Ve.getType=le.getType,Ve.setFlow=le.setFlow,Ve.reverse=function(Ce){var Ue,qe=he[Ce.scene];if(Ue=Ce.delete==="1"?{delete:!0,scene:qe||Ce.scene,from:Ce.from,time:+Ce.time,to:""+Ce.to}:{scene:qe||Ce.scene,from:Ce.from,fromNick:Ce.fromNick,fromClientType:re.reverseType(Ce.fromClientType),fromDeviceId:Ce.fromDeviceId,to:""+Ce.to,time:+Ce.time,type:Ve.getType(Ce),text:L(Ce.body)?Ce.body:Ce.text||"",isHistoryable:v(Ce.isHistoryable)||+Ce.isHistoryable==1,isRoamingable:v(Ce.isRoamingable)||+Ce.isRoamingable==1,isSyncable:v(Ce.isSyncable)||+Ce.isSyncable==1,cc:v(Ce.cc)||+Ce.cc==1,isPushable:v(Ce.isPushable)||+Ce.isPushable==1,isOfflinable:v(Ce.isOfflinable)||+Ce.isOfflinable==1,isUnreadable:v(Ce.isUnreadable)||+Ce.isUnreadable==1,isReplyMsg:v(Ce.isReplyMsg)||+Ce.isReplyMsg==1,needPushNick:v(Ce.needPushNick)||+Ce.needPushNick==1,needMsgReceipt:+Ce.needMsgReceipt==1,isLocal:!1},Ce.isInBlackList&&(Ue.isInBlackList=+Ce.isInBlackList==1,Ue.isInBlackList&&(Ce.status="fail")),ue(Ce.isMuted)&&(Ue.isMuted=+Ce.isMuted==1),ue(Ce.resend)&&(Ue.resend=+Ce.resend==1),ue(Ce.idClient)&&(Ue.idClient=Ce.idClient),ue(Ce.idServer)&&(Ue.idServer=""+Ce.idServer),ue(Ce.userUpdateTime)&&(Ue.userUpdateTime=+Ce.userUpdateTime),ue(Ce.custom)&&(Ue.custom=Ce.custom),ue(Ce.callbackExt)&&(Ue.callbackExt=Ce.callbackExt),ue(Ce.subType)&&(Ue.subType=+Ce.subType),ue(Ce.pushContent)&&(Ue.pushContent=Ce.pushContent),ue(Ce.pushPayload)&&(Ue.pushPayload=Ce.pushPayload),ue(Ce.tempTeamMemberCount)&&(Ue.tempTeamMemberCount=+Ce.tempTeamMemberCount),ue(Ce.yidunAntiSpamRes)&&(Ue.yidunAntiSpamRes=Ce.yidunAntiSpamRes),ue(Ce.apnsAccounts)){if(Ue.apns={},Ce.apnsAccounts!=="#%@all@%#"){var Oe=Ce.apnsAccounts;try{Ue.apns.accounts=JSON.parse(Oe)}catch{Ue.apns.accounts=[]}}Ue.apns.content=Ce.apnsContent||"",Ue.apns.forcePush=+Ce.apnsForcePush==1}if(ue(Ce.robotInfoFunction)&&(Ue.robotInfo=Ue.robotInfo||{},Ce.robotInfoFunction&&(Ue.robotInfo.function=Ce.robotInfoFunction)),ue(Ce.robotInfoCustomContent)&&(Ue.robotInfo=Ue.robotInfo||{},Ce.robotInfoCustomContent&&(Ue.robotInfo.customContent=Ce.robotInfoCustomContent)),ue(Ce.robotInfoTopic)&&(Ue.robotInfo=Ue.robotInfo||{},Ce.robotInfoTopic&&(Ue.robotInfo.topic=Ce.robotInfoTopic)),ue(Ce.robotInfoAccount)&&(Ue.robotInfo=Ue.robotInfo||{},Ce.robotInfoAccount&&(Ue.robotInfo.account=Ce.robotInfoAccount)),ue(Ce.needUpdateSession)&&(Ue.needUpdateSession=+Ce.needUpdateSession==1),Ue.status=Ce.status||"success",ue(o(Ce))&&(Ue.filter=o(Ce)),Ce.replyMsgIdServer&&Ce.threadMsgIdServer){var $e=["replyMsgFromAccount","replyMsgToAccount","replyMsgTime","replyMsgIdServer","replyMsgIdClient","threadMsgFromAccount","threadMsgToAccount","threadMsgTime","threadMsgIdServer","threadMsgIdClient"];a($e).call($e,function(_e){Ue[_e]=Ce[_e]}),Ue.replyMsgTime=+Ue.replyMsgTime,Ue.threadMsgTime=+Ue.threadMsgTime}return Ue},Ve.setExtra=function(Ce,Ue){Ce.target=Ve.getMsgTarget(Ce,Ue),Ce.sessionId=Ce.scene+"-"+Ce.target,le.setFlow(Ce,Ue)},Ve.getMsgTarget=function(Ce,Ue){return Ce.scene==="p2p"?Ce.to===Ue?Ce.from:Ce.to:Ce.scene==="team"||Ce.scene==="superTeam"?Ce.to:void 0},Ve.deduplication=function(Ce){var Ue,qe,Oe={},$e=O(Ce);try{for($e.s();!(qe=$e.n()).done;){var _e=qe.value,er=Oe[_e.idClient];er&&er.time>_e.time||(Oe[_e.idClient]=_e)}}catch(Pt){$e.e(Pt)}finally{$e.f()}return d(Ue=s(Oe)).call(Ue,function(Pt){return Oe[Pt]})},Ve.sortMsgs=function(Ce){return Ce=c(Ce).call(Ce,0),g.sortObjArray(Ce,{sortPath:"time"}),Ce},Ve.getLastMsg=function(Ce){return(Ce=Ve.sortMsgs(Ce))[Ce.length-1]},Ve.getLastNotIgnoredMsg=function(Ce){for(var Ue=null,qe=(Ce=Ve.sortMsgs(Ce)).length-1;qe>=0;qe--)if(!(Ue=Ce[qe]).ignore)return Ue;return null},Ve.getMaxTimetag=function(Ce){return Ve.getLastMsg(Ce).time},Ve.validScenes=Ie,Ve.validTypes=Ne,Ve.sceneMap=oe,Ve.sceneReverseMap=he,t.exports=Ve},function(t,n,e){var r=e(22),s=e(18),i=e(32),o=e(2),a=e(378),d=e(7),c=e(4),u=e(8),m=e(3),y=e(173),S=e(0),O=S.notundef,k=e(558),g=e(11),v=(e(186),e(45)),ue=e(584).wrapSafeCallback,L=e(25).reportAPI,re=e(156);function le(){}var oe={};le.getInstance=function(Ne){Ne=Ie(Ne),S.verifyOptions(Ne,"account","api::Base.getInstance");var Ve=this.genInstanceName(Ne),Ce=oe[Ve];return Ce?le.updateInstance(Ce,Ne):Ce=oe[Ve]=new this(Ne),Ce},le.updateInstance=function(Ne,Ve){Ne.setOptions(Ve),Ne.connect()};var he=le.fn=le.prototype=s(new y),Ie=function(Ne){return Ne.nosSurvivalTime?(S.verifyParamType("nosSurvivalTime",Ne.nosSurvivalTime,"number","api::Base.getInstance"),S.verifyParamMin("nosSurvivalTime",Ne.nosSurvivalTime,86400,"api::Base.getInstance")):Ne.nosSurvivalTime=1/0,Ne};he.updatePrivateConf=function(Ne){if(L({instance:this,className:"ApiBaseFn",funcName:"updatePrivateConf",hasCallback:!1}),Ne&&r(Ne.privateConf)==="object"){var Ve=Ne.privateConf;typeof Ve.lbs_web=="string"&&(Ne.lbsUrl=Ve.lbs_web),typeof Ve.link_ssl_web=="boolean"&&(Ne.secure=Ve.link_ssl_web),typeof Ve.https_enabled=="boolean"&&(Ne.httpsEnabled=Ve.https_enabled),Ne.uploadUrl=Ve.nos_uploader_web?Ve.nos_uploader_web:null,Ne.chunkUploadUrl=Ve.nos_uploader_web?Ve.nos_uploader_web:null,Ne.replaceUrl=Ve.nos_downloader?Ve.nos_downloader:null,Ne.downloadUrl=Ve.nos_accelerate?Ve.nos_accelerate:null,Ne.downloadHost=Ve.nos_accelerate_host?Ve.nos_accelerate_host:null,Ne.downloadHostList=Ve.nos_accelerate_host_list||[],Ne.downloadHost&&Ne.downloadHostList.push(Ne.downloadHost),Ne.nosCdnEnable=Ve.nos_cdn_enable!==!1,Ne.ntServerAddress=Ve.nt_server||null,Ne.kibanaServer=Ve.kibana_server,Ne.statisticServer=Ve.statistic_server,Ne.reportGlobalServer=Ve.report_global_server,Ne.ipVersion=Ve.ip_protocol_version||Ne.ipVersion,Ne.defaultLink=Ve.link_web||Ne.defaultLink,Ne.ipv6DefaultLink=Ve.link_ipv6_web||Ne.ipv6DefaultLink,typeof Ve.nos_lbs=="string"?Ne.nosLbsUrls=[Ve.nos_lbs]:Ne.nosLbsUrls=[],i(Ve.nos_edge_list)&&(Ne.edgeList=Ve.nos_edge_list)}return Ne.ntServerAddress===null||Ne.ntServerAddress===""?g.ntServerAddress=null:g.ntServerAddress=Ne.ntServerAddress,g.uploadUrl=Ne.uploadUrl||g.uploadUrl,g.chunkUploadUrl=Ne.chunkUploadUrl||g.chunkUploadUrl,g.downloadUrl=Ne.downloadUrl||g.downloadUrl,g.downloadHost=Ne.downloadHost||g.downloadHost,g.downloadHostList=Ne.downloadHostList&&Ne.downloadHostList.length>0?Ne.downloadHostList:g.downloadHostList,g.nosCdnEnable=Ne.nosCdnEnable!==!1,g.replaceUrl=Ne.replaceUrl||g.replaceUrl,g.httpsEnabled=Ne.httpsEnabled||g.httpsEnabled,Ne.probe_ipv4_url&&(g.ipProbeAddr.ipv4=Ne.probe_ipv4_url),Ne.probe_ipv6_url&&(g.ipProbeAddr.ipv6=Ne.probe_ipv6_url),Ne},he.init=function(Ne){S.verifyOptions(Ne,"account","api::Base.init"),Ne=this.updatePrivateConf(Ne),S.verifyBooleanWithDefault(Ne,"exifOrientation",!0,"","api::Base.init"),Ne.lbsBackup=Ne.lbsBackup===void 0||Ne.lbsBackup;var Ve=this.account=Ne.account=Ne.account+"",Ce=Ne.constructor.genInstanceName(Ne),Ue=oe[Ce];if(Ne._disableSingleton&&(Ue=null),Ue)return le.updateInstance(Ue,Ne),Ue;this.logger=Ne.logger=new k({debug:Ne.debug,logFunc:Ne.logFunc,prefix:this.subType,dbLog:Ne.dbLog!==!1,account:Ne.account,expire:Ne.expire,logLevel:Ne.logLevel}),this.options=ue(Ne,this),Ne.api=this;var qe=this.protocol=new Ne.Protocol(Ne);return qe.name="Protocol-"+Ce,qe.account=Ve,qe.api=this,qe.message=this.message=new Ne.Message({account:Ve}),this.reporter=qe.reporter,this.statusProtector=qe.statusProtector,this.reporterHook=qe.reporterHook,this.abtInfo={},(typeof S.get(Ne,"privateConf.isABTestEnable")=="boolean"?Ne.privateConf.isABTestEnable:g.privateConf.isABTestEnable)&&this.abTestConfigRequset(),this.name=Ce,oe[Ce]=this,this},he.destroy=function(Ne){var Ve=this;(Ne=Ne||{}).done=L({instance:this,className:"ApiBaseFn",funcName:"destroy",done:Ne.done});var Ce=this;if(!Ce.__beginDestroy){var Ue;Ce.__beginDestroy=!0,Ne=Ne||{};var qe,Oe=this.name;if(this.logger.warn("destroy::start"),!Oe)return this.logger&&this.logger.warn&&this.logger.warn("destroy::no instanceName"),void(Ce.__beginDestroy=void 0);this.protocol&&(Ue=this.protocol.connectTimer),this.protocol&&this.protocol.resetPush&&this.protocol.resetPush(),this.eventNames&&typeof this.eventNames=="function"&&o(qe=this.eventNames()).call(qe,function($e){delete Ve._events[$e]}),this.disconnect({done:function($e){var _e,er,Pt;Ce.logger.warn(`ApiBase::destroy: instance destroyed ...

`),Ce.__beginDestroy=void 0,Ce.reporter.destroy(),Ce.statusProtector.destroy(),Ce.reporterHook.destroy(),o(_e=a(Ce.options)).call(_e,function(pr){d(pr).call(pr,"on")===0&&(Ce.options[pr]=function(){},Ce.protocol.options[pr]=function(){},Ce.protocol.api.options[pr]=function(){})}),Ce.logger.destroy(),r(Ce.protocol.sessionSet)==="object"&&o(er=c(Ce.protocol.sessionSet)).call(er,function(pr){Ce.protocol.sessionSet[pr].unreadMsgs=[],Ce.protocol.sessionSet[pr]=void 0}),Ce.protocol.syncResult={},Ce.db&&Ce.db.close();var ar=Ce.protocol;o(Pt=a(Ce)).call(Pt,function(pr){Ce[pr]=void 0}),oe&&(oe[Oe]=null,clearTimeout(Ue)),ar&&(ar.__destroyed=!0),Ne.done instanceof Function&&Ne.done($e)}})}},he.setOptions=function(Ne){var Ve=re(Ne);Ve=ue(Ve,this),this.protocol.setOptions(Ve)},he.abTestConfigRequset=function(){var Ne=this,Ve=Ne.options.abTestUrl||"https://abt-online.netease.im/v1/api/abt/client/getExperimentInfo",Ce={projectKey:"im1_sdk_abtest_web",appKey:Ne.options.appKey,osType:"Web",sdkVersion:Ne.info.version,deviceId:v.deviceId},Ue=u({clientInfo:Ce});this.protocol.adaptersRequest(Ve,{method:"POST",timeout:5e3,headers:{"Content-Type":"application/json"},data:Ue,onload:function(qe){var Oe=JSON.parse(qe);Ne.abtInfo=Oe.data.abtInfo||{},Ne.logger&&Ne.logger.info("abTestConfigRequset::success",Ne.abtInfo)},onerror:function(){Ne.logger&&Ne.logger.info("abTestConfigRequset::fail")}},{exception_service:7})},he.processCallback=function(Ne,Ve){ie(Ne,Ve)},he.processCallbackPromise=function(Ne,Ve){return new m(function(Ce,Ue){ie(Ne,Ve,!0,Ce,Ue)})};var ie=function(Ne,Ve,Ce,Ue,qe){var Oe="api::processCallback";Ce&&(Oe="api::processCallbackPromise"),S.verifyCallback(Ne,"done",Oe),Ne.callback=function($e,_e,er){var Pt=Ne.callback.options;if(_e=_e||Pt,Ve&&(_e=Pt),S.isFunction(Ne.cbaop)){var ar=Ne.cbaop($e,_e);O(ar)&&(_e=ar)}var pr=Ne.done;S.isObject(_e)&&(delete _e.done,delete _e.cb,delete _e.callback),Ce?$e?qe({message:"生成接口回调错误",callFunc:Oe,event:$e}):Ue(_e):pr($e,_e,er)},Ne.callback.options=S.copy(Ne)};he.processPs=function(Ne){S.notexist(Ne.ps)&&(Ne.ps=""),S.verifyArrayMax("ps",Ne.ps,5e3)},he.processCustom=function(Ne){S.notexist(Ne.custom)&&(Ne.custom="")},he.sendCmd=function(){this.protocol.sendCmd.apply(this.protocol,arguments)},he.sendCmdWithResp=function(Ne,Ve,Ce){this.sendCmd(Ne,Ve,function(Ue,qe,Oe){S.isFunction(Ce)&&(Ue?Ce(Ue,qe):Ce(null,Oe))})},he.cbAndSendCmd=function(Ne,Ve){var Ce=this.processCallbackPromise(Ve);return this.sendCmd(Ne,Ve),Ce},he.sendCmdUsePromise=function(Ne,Ve){var Ce=this,Ue=L({instance:this,className:"ApiBaseFn",funcName:Ne,hasCallback:!0});return new m(function(qe,Oe){Ce.sendCmd(Ne,Ve,function($e,_e,er){if($e)typeof Ue=="function"&&Ue($e),Oe($e);else{var Pt=S.merge({},_e,er);typeof Ue=="function"&&Ue(void 0),qe(Pt)}})})},le.use=function(Ne,Ve){Ne&&Ne.install&&S.isFunction(Ne.install)&&Ne.install(this,Ve)},le.rmAllInstances=function(){for(var Ne in oe)oe[Ne].destroy();oe={}},he.logout=function(){var Ne=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Ne.callback=L({instance:this,className:"ApiBaseFn",funcName:"logout",done:Ne.callback}),Ne=Ne||{},this.protocol.shouldReconnect=!1,this.protocol.doLogout=!0,this.processCallback(Ne),this.sendCmd("logout",Ne,Ne.callback),this.protocol.statusProtector.emit("auth/loginLifeCycleLogout")},t.exports=le,e(588),e(589),e(631),e(632),e(642),e(646)},function(t,n,e){var r=e(90),s=e(32),i=e(4),o=e(16),a=e(158),d=e(7),c=e(71),u=e(6),m=e(2),y=e(8),S=e(60),O=e(24),k=e(26),g=e(0),v=g.undef,ue=e(11),L=e(41),re=e(157),le=re.StatusProtector,oe=(re.V2NIMLoginStatus,e(107)),he=oe.ReporterHook,Ie=oe.EMSyncType,ie=e(647),Ne=e(648),Ve=e(649);function Ce(qe){g.undef(qe.secure)&&(qe.secure=!0),this.options=qe,this.keepNosSafeUrl=this.options.keepNosSafeUrl||!1;var Oe=qe.defaultLink||qe.defaultLinkUrl;g.notundef(Oe)&&g.isString(Oe)&&(ue.optionDefaultLinkUrl=r(Oe).call(Oe)),g.notundef(qe.ipv6DefaultLink)&&g.isString(qe.ipv6DefaultLink)&&(ue.optionIpv6DefaultLinkUrl=qe.ipv6DefaultLink),typeof qe.heartbeatInterval=="number"&&(ue.heartbeatInterval=qe.heartbeatInterval),s(qe.nosLbsUrls)&&(ue.nosLbsUrls=qe.nosLbsUrls);var $e=this.options.socketConcurrent;$e=typeof $e=="number"&&$e>=1&&$e<=3?$e:1,this.options.socketConcurrent=$e,this.options.rollbackDelMsgUnread!==void 0&&typeof this.options.rollbackDelMsgUnread=="boolean"||(this.options.rollbackDelMsgUnread=!0),this.init(),this.connect()}var Ue=Ce.fn=Ce.prototype;Ue.init=function(){var qe=this;this.logger=this.options.logger,this.getNosOriginUrlReqNum=0,this.checkNosReqNum=0,this.timerMap={},this.cmdCallbackMap={},this.cmdContentMap={},this.initConnect(),this.reset(),this.statusProtector=new le(this),this.reporterHook=new he(this,this.options.reporterHookConfig),this.reporterHookLinkKeep=new ie(this),this.promiseAbortManager=new Ne,this.imsocket=new Ve(this,{socketConcurrent:this.options.socketConcurrent}),this.statusProtector.on("auth/loginLifeCycleLogout",function(){qe.promiseAbortManager.clear()}),this.statusProtector.on("auth/loginLifeCycleLoginSucc",function(){qe.reporterHook.reset(),qe.reporterHook.setOriginTimetick()})},Ue.reset=function(){v(this.options.thumbnailToStatic)&&(this.options.thumbnailToStatic=!0),this.resetConnect()},Ue.setOptions=function(qe){var Oe=this.options,$e=i(Oe),_e=i(qe),er=["onconnect","onerror","onwillreconnect","ondisconnect","onloginportschange","onmyinfo","onblacklist","onmutelist","onfriends","onusers","onrobots","onteams","onSuperTeams","onsessions","onSessionsWithMoreRoaming","onStickTopSessions","onroamingmsgs","onofflinemsgs","onofflinefiltermsgs","onroamingsysmsgs","onofflinesysmsgs","onofflinefiltersysmsgs","onofflinecustomsysmsgs","onofflinefiltercustomsysmsgs","onbroadcastmsg","onbroadcastmsgs","onsysmsgunread","onsyncdone","onteammembers","onsyncteammembersdone","onsyncsuperteammembersdone","onmsg","onsysmsg","oncustomsysmsg","onupdatemyinfo","onupdateuser","onSyncUpdateServerSession","onUpdateSuperTeamMember","onMySuperTeamMembers","onCreateSuperTeam","onUpdateSuperTeam","onAddSuperTeamMembers","onRemoveSuperTeamMembers","onUpdateSuperTeamManagers","onDismissSuperTeam","onTransferSuperTeam","onUpdateSuperTeamMembersMute","onupdateteammember","onMyTeamMembers","onMsgReceipts","onCreateTeam","onUpdateTeam","onAddTeamMembers","onRemoveTeamMembers","onUpdateTeamManagers","onDismissTeam","onTransferTeam","onUpdateTeamMembersMute","onTeamMsgReceipt","onupdatesession","onQuickComment","onDeleteQuickComment","onPinMsgChange","onupdatesysmsgunread","onupdatesysmsg","onsynccreateteam","onsyncsupercreateteam","onsyncmarkinblacklist","onsyncmarkinmutelist","onsyncfriendaction","shouldIgnoreNotification","shouldIgnoreMsg","onDeleteMsgSelf","shouldCountNotifyUnread","onPushNotificationMultiportConfig","onPushNotificationMultiportConfigUpdate","onpushevents"],Pt=o(_e).call(_e,function(pr){return a(er).call(er,pr)}),ar=d($e).call($e,"account");g.verifyCallback(qe,Pt,"protocol::IMProtocol"),this.logger.info("setOptions::",g.omitAsString(qe,["appKey","token","loginExt","customTag"])),ar!==-1&&c($e).call($e,ar,1),qe=g.filterObj(qe,$e),this.options=g.merge(Oe,qe),this.reset()},Ue.sendCmd=function(qe){var Oe,$e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",_e=arguments.length>2?arguments[2]:void 0,er=this;er.heartbeat();var Pt,ar=qe,pr=(qe=er.parser.createCmd(qe,$e)).SER;$e=$e||{},er.cmdContentMap[pr]=$e,$e.single&&(delete $e.single,(Pt=i($e)).length===1&&(er.cmdContentMap[pr]=$e[Pt[0]])),$e.__exceptionInfo={target:u(Oe="".concat(qe.SID,"-")).call(Oe,qe.CID),context:pr,startTime:er.reporterHook.getSafeClock()},$e.NOTSTORE&&(Pt=$e.NOTSTORE.split(" "),m(Pt).call(Pt,function(lr){delete $e[lr]}),delete $e.NOTSTORE),(_e=_e||$e.callback)&&(er.cmdCallbackMap[pr]=_e),er.executeCmdTask({cmdName:ar,cmd:y(qe)})},Ue.executeCmdTask=function(qe){var Oe=qe.cmdName,$e=qe.cmd,_e=($e=JSON.parse($e)).SER;this.isFrequencyControlled(Oe)?(this.logger.warn("protocol::executeCmdTask: ".concat(Oe," hit freq control")),this.markCallbackInvalid(_e,L.newFrequencyControlError({callFunc:"protocol::executeCmdTask",message:"".concat(Oe," hit freq control")}))):this.hasLogin?(Oe!=="heartbeat"&&(this.logger.debugEnable?this.logger.debug("protocol::sendCmd: ".concat(qe.cmd)):this.logger.info("protocol::sendCmd: ".concat(Oe))),this.doSendCmd($e)):Oe==="login"&&this.isConnected()?(this.logger.debugEnable?this.logger.debug("protocol::sendCmd: ".concat(qe.cmd)):this.logger.info("protocol::sendCmd: ".concat(Oe)),this.doSendCmd($e)):(this.logger.warn("protocol::executeCmdTask: ".concat(Oe," not connected or login")),this.markCallbackInvalid(_e,L.newSocketStateError({callFunc:"protocol::executeCmdTask",message:"".concat(Oe," not connected or not login")})))},Ue.isFrequencyControlled=function(qe){var Oe=this.frequencyControlMap&&this.frequencyControlMap[qe];if(Oe){if(S()<Oe.from+Oe.duration)return!0;delete this.frequencyControlMap[qe]}},Ue.doSendCmd=function(qe){var Oe=this,$e=qe.SER,_e=$e===0?ue.hbCmdTimeout:ue.cmdTimeout,er=new Date().getTime(),Pt=Oe.cmdContentMap[$e];function ar(){Oe.markCallbackInvalid($e,L.newSocketStateError({callFunc:"protocol::doSendCmd",message:"ser ".concat($e," socketSendJson Error")})),Oe.onDisconnect("protocol::doSendCmd:socketSendJson","broken")}Pt&&Pt.__exceptionInfo&&(Pt.__exceptionInfo.startTime=Oe.reporterHook.getSafeClock()),qe.isAwaitable&&(Oe.timerMap[$e]=O(function(){var pr;qe.SID!==1&&qe.CID!==2&&Oe.detectHeartbeat(),Oe.markCallbackInvalid($e,L.newTimeoutError({callFunc:"protocol::doSendCmd",message:"ser ".concat($e," Timeout Error")})),Oe.reporter.reportTraceStart("exceptions",{user_id:g.get(Oe,"options.account")||"",trace_id:g.get(Oe,"socket.socket.sessionid"),start_time:er,action:2,exception_service:6}),Oe.reporter.reportTraceUpdateV2("exceptions",{code:408,description:"Packet timeout",operation_type:1,target:u(pr="".concat(qe.SID,"-")).call(pr,qe.CID),context:"".concat(qe.SER),net_connect:Oe.checkNetworkAvailable()}),Oe.reporter.reportTraceEnd("exceptions",1)},_e));try{Oe.socket&&Oe.socket.send?Oe.socket.send(y(qe)):ar()}catch{ar()}},Ue.getObjWithSer=function(qe){var Oe=this.cmdContentMap[qe];return Oe&&!Oe.isImSyncDataObj&&delete this.cmdContentMap[qe],Oe&&g.copy(Oe)},Ue.getCallbackWithSer=function(qe){var Oe=this.cmdCallbackMap[qe];return Oe&&!Oe.isImSyncDataCb&&delete this.cmdCallbackMap[qe],Oe},Ue.getTimerWithSer=function(qe){var Oe=this.timerMap[qe];return delete this.timerMap[qe],Oe},Ue.clearTimerWithSer=function(qe){var Oe=this.getTimerWithSer(qe);Oe&&clearTimeout(Oe)},Ue.markCallbackInvalid=function(qe,Oe){this.getObjWithSer(qe),this.clearTimerWithSer(qe);var $e=this.getCallbackWithSer(qe);if($e){var _e=$e.options;O(function(){$e(Oe||L.newUnknownError({ser:qe}),_e)},0)}},Ue.markAllCallbackInvalid=function(qe){var Oe=this;try{var $e,_e;m($e=i(this.cmdContentMap)).call($e,function(er){var Pt=Oe.getObjWithSer(er);if(Pt&&Pt.__exceptionInfo){var ar=Pt.__exceptionInfo.target,pr=Pt.__exceptionInfo.context,lr=g.get(qe,"event.uploadCode")||qe&&qe.code;lr=typeof lr!="number"?415:lr;var or=g.get(qe,"event.disconnectReason"),xe=or?y({disconnect_reason:or}):qe&&qe.message||"send cmd failed";Oe.reporter.reportTraceStart("exceptions",{user_id:g.get(Oe,"options.account")||"",trace_id:g.get(Oe,"socket.socket.sessionid"),start_time:Oe.reporterHook.getNTPTime(Pt.__exceptionInfo.startTime),action:2,exception_service:6}),Oe.reporter.reportTraceUpdateV2("exceptions",{code:lr,description:xe,operation_type:1,target:ar,context:pr,net_connect:Oe.checkNetworkAvailable()}),Oe.reporter.reportTraceEnd("exceptions",1),delete Pt.__exceptionInfo}}),m(_e=i(this.cmdCallbackMap)).call(_e,function(er){Oe.markCallbackInvalid(er,qe)})}catch(er){Oe.logger&&Oe.logger.error("protocol::markAllCallbackInvalid error: ",er)}},Ue.getPacketObj=function(qe){var Oe=null;if(qe&&qe.raw){var $e=qe.raw.ser;g.notundef($e)&&(Oe=this.getObjWithSer($e))}return Oe},Ue.callPacketAckCallback=function(qe){var Oe=this;if(qe&&qe.raw){var $e=qe.raw.ser;if(g.notundef($e)){Oe.clearTimerWithSer($e);var _e=Oe.getCallbackWithSer($e);if(_e){var er;_e.originUrl&&qe.obj&&qe.obj.file&&(qe.obj.file._url_safe=qe.obj.file.url,qe.obj.file.url=_e.originUrl,qe.obj.type==="audio"&&(qe.obj.file.mp3Url=_e.originUrl+(~d(er=_e.originUrl).call(er,"?")?"&":"?")+"audioTrans&type=mp3")),qe.promise?qe.promise.then(function(){_e(qe.error,qe.obj)},function(Pt){var ar,pr;Pt.callFunc="protocol::callPacketAckCallback",Pt.message=u(ar=u(pr="Resp Promoise Error: cmd: ".concat(qe.cmd,", ser: ")).call(pr,$e,", reason: ")).call(ar,Pt.message);var lr=L.customError("CALLBACK_ACK_ERR",Pt);Oe.logger.error(`protocol::callPacketAckCallback error stack: 
`.concat(Pt.stack||Pt.event&&Pt.event.stack)),_e(lr,qe.obj,qe.content)}):_e(qe.error,qe.obj,qe.content)}}}},Ue.onMessage=function(qe){var Oe=this;Oe.heartbeat(),Oe.parser.parseResponse(qe).then(function($e){var _e;if($e.notFound&&Oe.logger.warn("protocol::onMessage: packet not found ".concat(y($e))),$e.error){var er,Pt;$e.error.message=u(er="".concat($e.cmd," error: ")).call(er,$e.error.message),Oe.logger.error(u(Pt="protocol::onMessage: packet error ".concat(y($e.error),"，raw cmd ")).call(Pt,$e.rawStr));var ar=$e.raw||{};ar.code!==408&&ar.code!==415&&ar.code!==500||Oe.reporter.report("nimErrEvent",{code:ar.code,module:$e.cmd,accid:Oe.account})}$e.__receiveTime=Oe.reporterHook.getSafeClock();var pr=Ie[u(_e="kSyncType".concat($e.raw.sid,"_")).call(_e,$e.raw.cid)];if(pr){var lr=g.get($e,"raw.r"),or=1;if(lr&&lr.length>0){var xe=o(lr).call(lr,function(tr){return s(tr)}),nr=g.get(xe,"0.length");or=typeof nr=="number"?nr:1}Oe.reporterHook.emit("reporter/syncItem",pr,or)}$e.frequencyControlDuration&&(Oe.logger.error("protocol::onMessage: server freq control ".concat(y($e.cmd))),Oe.frequencyControlMap=Oe.frequencyControlMap||{},Oe.frequencyControlMap[$e.cmd]={from:+new Date,duration:$e.frequencyControlDuration}),$e.obj=Oe.getPacketObj($e),$e.obj&&$e.obj.__exceptionInfo&&delete $e.obj.__exceptionInfo,$e.cmd!=="heartbeat"&&(Oe.logger.debugEnable?Oe.logger.debug("protocol::recvCmd: ".concat($e.rawStr)):Oe.logger.log("protocol::recvCmd: ".concat($e.cmd)));var ir="process"+g.capFirstLetter($e.service);if(Oe[ir])if($e.cmd==="syncDone"){if(Oe.cmdCallbackMap[$e.raw.ser]&&Oe.cmdCallbackMap[$e.raw.ser].isImSyncDataCb){var dr;Oe.cmdCallbackMap[$e.raw.ser].isImSyncDataCb=!1;var Lt=k(dr=function(tr,At){this.checkNosReqNum++,this.getNosOriginUrlReqNum<=0||this.checkNosReqNum>=20?this[tr](At):O(Lt,300)}).call(dr,Oe,ir,$e);O(function(){Lt.call(Oe,ir,$e)},10)}}else{$e.cmd!=="syncTeamMembersDone"&&$e.cmd!=="syncSuperTeamMembersDone"||Oe.cmdCallbackMap[$e.raw.ser]&&Oe.cmdCallbackMap[$e.raw.ser].isImSyncDataCb&&(Oe.cmdCallbackMap[$e.raw.ser].isImSyncDataCb=!1);try{Oe[ir]($e)}catch(tr){var cr,mr;Oe.logger.warn(u(cr=u(mr="protocol::onMessage: ".concat(ir,".")).call(mr,$e.cmd," excute failed ")).call(cr,$e.obj?"":", maybe the packet timed out",": "),tr.message)}}else Oe.logger.warn("protocol::onMessage: ".concat(ir," not found"));Oe.callPacketAckCallback($e)})},Ue.onMiscError=function(qe,Oe,$e){Oe&&this.notifyError(qe,Oe,$e)},Ue.onCustomError=function(qe,Oe){var $e=L.customError(qe,Oe),_e=Oe.message||"未知错误";this.onMiscError(_e,$e)},Ue.notifyError=function(qe,Oe,$e){var _e;this.isConnected()&&(this.logger.error(u(_e="".concat(qe||""," ")).call(_e,this.name),Oe,$e),this.options.onerror(Oe,$e))},Ue.emitAPI=function(qe){var Oe=qe.type,$e=qe.obj;this.api.emit(Oe,$e)},t.exports=Ce,e(669),e(685),e(686),e(687),e(688),e(689)},function(t,n,e){var r=e(109),s=Function.prototype,i=s.apply,o=s.call;t.exports=typeof Reflect=="object"&&Reflect.apply||(r?o.bind(i):function(){return o.apply(i,arguments)})},function(t,n){t.exports=function(e,r){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:r}}},function(t,n){var e=String;t.exports=function(r){try{return e(r)}catch{return"Object"}}},function(t,n,e){var r=e(5);t.exports=function(s,i){var o=[][s];return!!o&&r(function(){o.call(null,i||function(){return 1},1)})}},function(t,n,e){var r=e(65);t.exports=Array.isArray||function(s){return r(s)=="Array"}},function(t,n,e){var r,s=e(36),i=e(166),o=e(167),a=e(114),d=e(218),c=e(162),u=e(133),m=u("IE_PROTO"),y=function(){},S=function(g){return"<script>"+g+"<\/script>"},O=function(g){g.write(S("")),g.close();var v=g.parentWindow.Object;return g=null,v},k=function(){try{r=new ActiveXObject("htmlfile")}catch{}var g,v;k=typeof document<"u"?document.domain&&r?O(r):((v=c("iframe")).style.display="none",d.appendChild(v),v.src="javascript:",(g=v.contentWindow.document).open(),g.write(S("document.F=Object")),g.close(),g.F):O(r);for(var ue=o.length;ue--;)delete k.prototype[o[ue]];return k()};a[m]=!0,t.exports=Object.create||function(g,v){var ue;return g!==null?(y.prototype=s(g),ue=new y,y.prototype=null,ue[m]=g):ue=k(),v===void 0?ue:i.f(ue,v)}},function(t,n,e){var r=e(165),s=e(39).f,i=e(61),o=e(30),a=e(334),d=e(21)("toStringTag");t.exports=function(c,u,m,y){if(c){var S=m?c:c.prototype;o(S,d)||s(S,d,{configurable:!0,value:u}),y&&!r&&i(S,"toString",a)}}},function(t,n,e){var r=e(44),s=e(199),i=e(103),o=e(101),a=e(39).f,d=e(169),c=e(170),u=e(49),m=e(27),y=o.set,S=o.getterFor("Array Iterator");t.exports=d(Array,"Array",function(k,g){y(this,{type:"Array Iterator",target:r(k),index:0,kind:g})},function(){var k=S(this),g=k.target,v=k.kind,ue=k.index++;return!g||ue>=g.length?(k.target=void 0,c(void 0,!0)):c(v=="keys"?ue:v=="values"?g[ue]:[ue,g[ue]],!1)},"values");var O=i.Arguments=i.Array;if(s("keys"),s("values"),s("entries"),!u&&m&&O.name!=="values")try{a(O,"name",{value:"values"})}catch{}},function(t,n,e){var r=e(503),s=e(508);t.exports=function(i,o){var a=s(i,o);return r(a)?a:void 0}},function(t,n,e){t.exports=e(301)},function(t,n,e){t.exports=e(219)},function(t,n,e){t.exports=e(577)},function(t,n){t.exports=function(e){var r=typeof e;return e!=null&&(r=="object"||r=="function")}},function(t,n){t.exports=function(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,n,e){var r=e(140),s=e(250);function i(o,a){for(var d=0;d<a.length;d++){var c=a[d];c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),r(o,s(c.key),c)}}t.exports=function(o,a,d){return a&&i(o.prototype,a),d&&i(o,d),r(o,"prototype",{writable:!1}),o},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,n,e){(function(r){var s;t.exports=(s=s||function(i,o){var a;if(typeof window<"u"&&window.crypto&&(a=window.crypto),typeof self<"u"&&self.crypto&&(a=self.crypto),typeof globalThis<"u"&&globalThis.crypto&&(a=globalThis.crypto),!a&&typeof window<"u"&&window.msCrypto&&(a=window.msCrypto),!a&&r!==void 0&&r.crypto&&(a=r.crypto),!a)try{a=e(892)}catch{}var d=function(){if(a){if(typeof a.getRandomValues=="function")try{return a.getRandomValues(new Uint32Array(1))[0]}catch{}if(typeof a.randomBytes=="function")try{return a.randomBytes(4).readInt32LE()}catch{}}throw new Error("Native crypto module could not be used to get secure random number.")},c=Object.create||function(){function re(){}return function(le){var oe;return re.prototype=le,oe=new re,re.prototype=null,oe}}(),u={},m=u.lib={},y=m.Base={extend:function(re){var le=c(this);return re&&le.mixIn(re),le.hasOwnProperty("init")&&this.init!==le.init||(le.init=function(){le.$super.init.apply(this,arguments)}),le.init.prototype=le,le.$super=this,le},create:function(){var re=this.extend();return re.init.apply(re,arguments),re},init:function(){},mixIn:function(re){for(var le in re)re.hasOwnProperty(le)&&(this[le]=re[le]);re.hasOwnProperty("toString")&&(this.toString=re.toString)},clone:function(){return this.init.prototype.extend(this)}},S=m.WordArray=y.extend({init:function(re,le){re=this.words=re||[],this.sigBytes=le??4*re.length},toString:function(re){return(re||k).stringify(this)},concat:function(re){var le=this.words,oe=re.words,he=this.sigBytes,Ie=re.sigBytes;if(this.clamp(),he%4)for(var ie=0;ie<Ie;ie++){var Ne=oe[ie>>>2]>>>24-ie%4*8&255;le[he+ie>>>2]|=Ne<<24-(he+ie)%4*8}else for(var Ve=0;Ve<Ie;Ve+=4)le[he+Ve>>>2]=oe[Ve>>>2];return this.sigBytes+=Ie,this},clamp:function(){var re=this.words,le=this.sigBytes;re[le>>>2]&=4294967295<<32-le%4*8,re.length=i.ceil(le/4)},clone:function(){var re=y.clone.call(this);return re.words=this.words.slice(0),re},random:function(re){for(var le=[],oe=0;oe<re;oe+=4)le.push(d());return new S.init(le,re)}}),O=u.enc={},k=O.Hex={stringify:function(re){for(var le=re.words,oe=re.sigBytes,he=[],Ie=0;Ie<oe;Ie++){var ie=le[Ie>>>2]>>>24-Ie%4*8&255;he.push((ie>>>4).toString(16)),he.push((15&ie).toString(16))}return he.join("")},parse:function(re){for(var le=re.length,oe=[],he=0;he<le;he+=2)oe[he>>>3]|=parseInt(re.substr(he,2),16)<<24-he%8*4;return new S.init(oe,le/2)}},g=O.Latin1={stringify:function(re){for(var le=re.words,oe=re.sigBytes,he=[],Ie=0;Ie<oe;Ie++){var ie=le[Ie>>>2]>>>24-Ie%4*8&255;he.push(String.fromCharCode(ie))}return he.join("")},parse:function(re){for(var le=re.length,oe=[],he=0;he<le;he++)oe[he>>>2]|=(255&re.charCodeAt(he))<<24-he%4*8;return new S.init(oe,le)}},v=O.Utf8={stringify:function(re){try{return decodeURIComponent(escape(g.stringify(re)))}catch{throw new Error("Malformed UTF-8 data")}},parse:function(re){return g.parse(unescape(encodeURIComponent(re)))}},ue=m.BufferedBlockAlgorithm=y.extend({reset:function(){this._data=new S.init,this._nDataBytes=0},_append:function(re){typeof re=="string"&&(re=v.parse(re)),this._data.concat(re),this._nDataBytes+=re.sigBytes},_process:function(re){var le,oe=this._data,he=oe.words,Ie=oe.sigBytes,ie=this.blockSize,Ne=Ie/(4*ie),Ve=(Ne=re?i.ceil(Ne):i.max((0|Ne)-this._minBufferSize,0))*ie,Ce=i.min(4*Ve,Ie);if(Ve){for(var Ue=0;Ue<Ve;Ue+=ie)this._doProcessBlock(he,Ue);le=he.splice(0,Ve),oe.sigBytes-=Ce}return new S.init(le,Ce)},clone:function(){var re=y.clone.call(this);return re._data=this._data.clone(),re},_minBufferSize:0}),L=(m.Hasher=ue.extend({cfg:y.extend(),init:function(re){this.cfg=this.cfg.extend(re),this.reset()},reset:function(){ue.reset.call(this),this._doReset()},update:function(re){return this._append(re),this._process(),this},finalize:function(re){return re&&this._append(re),this._doFinalize()},blockSize:16,_createHelper:function(re){return function(le,oe){return new re.init(oe).finalize(le)}},_createHmacHelper:function(re){return function(le,oe){return new L.HMAC.init(re,oe).finalize(le)}}}),u.algo={});return u}(Math),s)}).call(this,e(73))},function(t,n,e){var r=e(27),s=e(20),i=e(150),o=e(80),a=e(44),d=e(128),c=e(30),u=e(210),m=Object.getOwnPropertyDescriptor;n.f=r?m:function(y,S){if(y=a(y),S=d(S),u)try{return m(y,S)}catch{}if(c(y,S))return o(!s(i.f,y,S),y[S])}},function(t,n){t.exports=function(e){return e==null}},function(t,n,e){var r=e(98),s=e(5);t.exports=!!Object.getOwnPropertySymbols&&!s(function(){var i=Symbol();return!String(i)||!(Object(i)instanceof Symbol)||!Symbol.sham&&r&&r<41})},function(t,n,e){var r,s,i=e(14),o=e(66),a=i.process,d=i.Deno,c=a&&a.versions||d&&d.version,u=c&&c.v8;u&&(s=(r=u.split("."))[0]>0&&r[0]<4?1:+(r[0]+r[1])),!s&&o&&(!(r=o.match(/Edge\/(\d+)/))||r[1]>=74)&&(r=o.match(/Chrome\/(\d+)/))&&(s=+r[1]),t.exports=s},function(t,n,e){var r=e(128),s=e(39),i=e(80);t.exports=function(o,a,d){var c=r(a);c in o?s.f(o,c,i(0,d)):o[c]=d}},function(t,n){},function(t,n,e){var r,s,i,o=e(335),a=e(14),d=e(28),c=e(61),u=e(30),m=e(161),y=e(133),S=e(114),O=a.TypeError,k=a.WeakMap;if(o||m.state){var g=m.state||(m.state=new k);g.get=g.get,g.has=g.has,g.set=g.set,r=function(ue,L){if(g.has(ue))throw O("Object already initialized");return L.facade=ue,g.set(ue,L),L},s=function(ue){return g.get(ue)||{}},i=function(ue){return g.has(ue)}}else{var v=y("state");S[v]=!0,r=function(ue,L){if(u(ue,v))throw O("Object already initialized");return L.facade=ue,c(ue,v,L),L},s=function(ue){return u(ue,v)?ue[v]:{}},i=function(ue){return u(ue,v)}}t.exports={set:r,get:s,has:i,enforce:function(ue){return i(ue)?s(ue):r(ue,{})},getterFor:function(ue){return function(L){var re;if(!d(L)||(re=s(L)).type!==ue)throw O("Incompatible receiver, "+ue+" required");return re}}}},function(t,n,e){var r=e(12);t.exports=r([].slice)},function(t,n){t.exports={}},function(t,n){t.exports=function(e){try{return{error:!1,value:e()}}catch(r){return{error:!0,value:r}}}},function(t,n,e){var r=e(14);t.exports=r.Promise},function(t,n){t.exports=function(e){return e!=null&&typeof e=="object"}},function(t,n,e){var r=e(279),s=e(60),i=e(3),o=e(24),a=e(26),d=e(6),c=e(48),u=e(16),m=e(2),y=e(4),S=e(9),O=e(123),k=e(37),g=e(92),v=e(93),ue=e(281),L=e(282),re=e(192);function le(qe){var Oe=function(){if(typeof Reflect>"u"||!r||r.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],function(){})),!0}catch{return!1}}();return function(){var $e,_e=re(qe);if(Oe){var er=re(this).constructor;$e=r(_e,arguments,er)}else $e=_e.apply(this,arguments);return L(this,$e)}}var oe=e(173),he=e(0),Ie=e(11).heartbeatInterval,ie=e(157).V2NIMLoginStatus,Ne=e(11),Ve={kSyncAction5_1:0,kSyncAction5_2:1,kSyncAction5_3:2},Ce={kKnown:-1,kSucceed:0,kFailed:1,kAborted:2,kCanceled:3},Ue=function(qe){ue($e,qe);var Oe=le($e);function $e(_e){var er,Pt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return g(this,$e),(er=Oe.call(this)).clientProto=_e,er.logger=_e.logger,er.reporter=_e.reporter,er.timer=null,er.setClientOrigin(),er.serverOrigin={timeStamp:null,rtt:null,baseTimeStamp:null},er.tolerantRTT=Pt.tolerantRTT||3e3,er.bestRTT=Pt.bestRTT||100,er.maxChances=Pt.maxChances||10,er.isSettingNTP=!1,er.currentChance=0,er.syncTraceData={},er.syncTraceMap={},er.syncTraceLastItem={},er.uploadTraceData={},er.setMonitorForSync(),er.setMonitorForResources(),er}return v($e,[{key:"hasOriginTimetick",value:function(){return!!this.serverOrigin.timeStamp}},{key:"setOriginTimetick",value:function(){var _e=this,er=this.clientProto.options;if((typeof he.get(er,"privateConf.isDataReportEnable")=="boolean"?er.privateConf.isDataReportEnable:Ne.privateConf.isDataReportEnable)&&Ne.isBrowser&&performance&&performance.now&&!(this.isSettingNTP||this.currentChance>=this.maxChances)){this.isSettingNTP=!0,this.currentChance++,clearTimeout(this.timer),this.timer=null;var Pt="ReporterHook::setOriginTimetick:",ar=s();return this.logger.info("".concat(Pt," getServerTime start, times ").concat(this.currentChance)),new i(function(pr){_e.clientProto.sendCmd("getServerTime",{},function(lr,or){if(_e.isSettingNTP=!1,lr){var xe;_e.logger.warn("".concat(Pt," Calculate Delay time, getServerTime error"),lr),_e.clientProto.statusProtector.getLoginStatus()===ie.V2NIM_LOGIN_STATUS_LOGINED&&(_e.timer=o(a(xe=_e.setOriginTimetick).call(xe,_e),Ie)),pr()}else{if(!or)return _e.logger.warn("".concat(Pt," Calculate Delay time, getServerTime not correct")),void pr();var nr,ir=s()-ar;if(ir>_e.tolerantRTT)_e.logger.warn("".concat(Pt," Denied, cause of exceeding the maximum tolerance range of RTT: ").concat(ir)),_e.timer=o(a(nr=_e.setOriginTimetick).call(nr,_e),Ie);else if(ir>_e.bestRTT){var dr,Lt,cr;_e.serverOrigin.rtt&&ir>=_e.serverOrigin.rtt?_e.logger.info("".concat(Pt," Denied, cause of current.RTT >= serverOrigin.RTT: ").concat(ir)):(_e.setServerOrigin(ir,or),_e.logger.info(d(Lt=d(cr="".concat(Pt," Accept within maximum tolerance range of RTT: ").concat(ir,", ntpTimestamp: ")).call(cr,_e.serverOrigin.timeStamp,", localClock: ")).call(Lt,_e.serverOrigin.baseTimeStamp))),_e.timer=o(a(dr=_e.setOriginTimetick).call(dr,_e),Ie)}else{var mr,tr;_e.setServerOrigin(ir,or),_e.logger.info(d(mr=d(tr="".concat(Pt," Accept within best RTT: ").concat(ir,", ntpTimestamp: ")).call(tr,_e.serverOrigin.timeStamp,", localClock: ")).call(mr,_e.serverOrigin.baseTimeStamp))}pr()}})})}}},{key:"getNTPTime",value:function(_e){if(typeof _e!="number"&&(_e=this.getSafeClock()),this.serverOrigin.timeStamp){var er=c(_e-this.serverOrigin.baseTimeStamp);return this.serverOrigin.timeStamp+er}var Pt=c(_e-this.clientOrigin.baseTimeStamp);return this.clientOrigin.timeStamp+Pt}},{key:"getSafeClock",value:function(){return Ne.isBrowser&&performance&&performance.now?performance.now():s()}},{key:"setMonitorForSync",value:function(){var _e=this,er="ReporterHook::setMonitorForSync:";this.on("reporter/syncStart",function(){_e.logger.info("".concat(er," sync start")),_e.syncTraceData={user_id:_e.clientProto.account,trace_id:he.get(_e.clientProto,"socket.socket.sessionid"),action:Ve.kSyncAction5_1,sync_begin_time:_e.getSafeClock(),sync_end_time:0,sync_duration:0,overall_duration:0,extension:[]}}),this.on("reporter/syncRecv",function(){_e.syncTraceData.user_id&&(_e.logger.info("".concat(er," sync receive packet")),_e.syncTraceData.sync_end_time=_e.getSafeClock(),_e.syncTraceData.sync_duration=c(_e.syncTraceData.sync_end_time-_e.syncTraceData.sync_begin_time))}),this.on("reporter/syncItem",function(Pt,ar){var pr;if(typeof Pt=="number"&&_e.syncTraceData.user_id){_e.logger.info(d(pr="".concat(er," receive sync item: ").concat(Pt,", total: ")).call(pr,ar));var lr=_e.getSafeClock();_e.syncTraceMap[Pt]=_e.syncTraceMap[Pt]?_e.syncTraceMap[Pt]:{sync_type:Pt,times:0,total:0,sync_duration:0,proc_duration:0,description:"",items:[]};var or={total:ar,pre_item_recv_time:_e.syncTraceLastItem.cur_item_recv_time?_e.syncTraceLastItem.cur_item_recv_time:_e.syncTraceData.sync_begin_time,cur_item_recv_time:lr};_e.syncTraceMap[Pt].items.push(or),_e.syncTraceLastItem=or}}),this.on("reporter/syncItemComplete",function(Pt){var ar;if(typeof Pt=="number"&&_e.syncTraceData.user_id){var pr=_e.syncTraceMap[Pt];if(pr){_e.logger.info("".concat(er," sync item ").concat(Pt," callback done"));var lr=u(ar=pr.items).call(ar,function(or){return!or.callback_time});lr.length!==0&&(lr[0].callback_time=_e.getSafeClock())}}}),this.on("reporter/syncComplete",function(){var Pt;_e.syncTraceData.user_id&&(_e.logger.info("".concat(er," sync complete")),m(Pt=y(_e.syncTraceMap)).call(Pt,function(ar){var pr,lr=S(pr=_e.syncTraceMap[ar].items).call(pr,function(xe){return{total:xe.total,pre_item_recv_time:_e.getNTPTime(xe.pre_item_recv_time),cur_item_recv_time:_e.getNTPTime(xe.cur_item_recv_time),callback_time:_e.getNTPTime(xe.callback_time)}}),or=O(lr).call(lr,function(xe,nr){return xe.times+=1,xe.total+=nr.total,xe.sync_duration+=nr.cur_item_recv_time-nr.pre_item_recv_time,xe.proc_duration+=nr.callback_time-nr.cur_item_recv_time,xe},{times:0,total:0,sync_duration:0,proc_duration:0});_e.syncTraceMap[ar].items=lr,k(_e.syncTraceMap[ar],or),_e.syncTraceData.extension.push(_e.syncTraceMap[ar])}),_e.syncTraceData.sync_begin_time=_e.getNTPTime(_e.syncTraceData.sync_begin_time),_e.syncTraceData.sync_end_time=_e.getNTPTime(_e.syncTraceData.sync_end_time),_e.syncTraceData.overall_duration=_e.getNTPTime()-_e.syncTraceData.sync_begin_time,_e.reporter.report("nim_sdk_sync",_e.syncTraceData),_e.syncTraceData={},_e.syncTraceMap={})})}},{key:"setMonitorForResources",value:function(){var _e=this,er="ReporterHook::setMonitorForResources:";this.on("reporter/uploadStart",function(){_e.logger.info("".concat(er," upload start")),_e.uploadTraceData={user_id:_e.clientProto.account,trace_id:he.get(_e.clientProto,"socket.socket.sessionid"),action:0,duration:0,start_time:_e.getSafeClock(),offset:0,full_size:0,transferred_size:0}}),this.on("reporter/uploadUpdate",function(){var Pt,ar=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};_e.uploadTraceData.user_id&&(_e.logger.info("".concat(er," upload update"),ar),m(Pt=y(ar)).call(Pt,function(pr){_e.uploadTraceData[pr]=ar[pr]}))}),this.on("reporter/uploadEnd",function(){var Pt=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Ce.kKnown;_e.uploadTraceData.user_id&&(_e.logger.info("".concat(er," upload end cause of ").concat(Pt)),_e.uploadTraceData.state=Pt,_e.uploadTraceData.start_time=_e.getNTPTime(_e.uploadTraceData.start_time),_e.uploadTraceData.duration=_e.getNTPTime(_e.getSafeClock())-_e.uploadTraceData.start_time,_e.reporter.report("nim_sdk_resources",_e.uploadTraceData),_e.uploadTraceData={})})}},{key:"destroy",value:function(){this.reset(),this.removeAllListeners(),this.logger.info("ReporterHook::destroy: complete")}},{key:"reset",value:function(){this.logger.info("ReporterHook::reset"),this.serverOrigin={},this.setClientOrigin(),this.currentChance=0,this.timer&&clearTimeout(this.timer),this.syncTraceData={},this.syncTraceMap={},this.syncTraceLastItem={},this.uploadTraceData={}}},{key:"setClientOrigin",value:function(){this.clientOrigin={timeStamp:s(),baseTimeStamp:this.getSafeClock()}}},{key:"setServerOrigin",value:function(_e,er){this.serverOrigin={timeStamp:er+c(_e/2),rtt:_e,baseTimeStamp:this.getSafeClock()}}}]),$e}(oe);t.exports={EMSyncAction:Ve,EMSyncType:{kSyncType3_8:30008,kSyncType3_109:30109,kSyncType4_4:40004,kSyncType4_6:40006,kSyncType4_9:40009,kSyncType4_12:40012,kSyncType4_13:40013,kSyncType4_14:40014,kSyncType4_16:40016,kSyncType4_17:40017,kSyncType4_18:40018,kSyncType4_19:40019,kSyncType4_20:40020,kSyncType4_21:40021,kSyncType4_23:40023,kSyncType4_24:40024,kSyncType4_100:40100,kSyncType4_101:40101,kSyncType7_15:70015,kSyncType8_109:80109,kSyncType8_126:80126,kSyncType12_5:12005,kSyncType12_6:12006,kSyncType15_13:15013,kSyncType21_109:21109,kSyncType21_111:21111},ReporterHook:Ue,EMExceptionState:Ce,EMResourceUploadWay:{kResourceUploadWayNOS:0,kResourceUploadWayAWSPlugin:1,kResourceUploadWayNOSPlugin:2}}},function(t,n,e){var r=e(7),s=e(15),i=e(2),o=e(6),a=e(158),d=e(16),c=e(88),u=e(89),m=e(72),y=e(32);function S(v,ue){var L=u!==void 0&&m(v)||v["@@iterator"];if(!L){if(y(v)||(L=function(ie,Ne){var Ve;if(ie){if(typeof ie=="string")return O(ie,Ne);var Ce=s(Ve=Object.prototype.toString.call(ie)).call(Ve,8,-1);if(Ce==="Object"&&ie.constructor&&(Ce=ie.constructor.name),Ce==="Map"||Ce==="Set")return c(ie);if(Ce==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(Ce))return O(ie,Ne)}}(v))||ue&&v&&typeof v.length=="number"){L&&(v=L);var re=0,le=function(){};return{s:le,n:function(){return re>=v.length?{done:!0}:{done:!1,value:v[re++]}},e:function(ie){throw ie},f:le}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var oe,he=!0,Ie=!1;return{s:function(){L=L.call(v)},n:function(){var ie=L.next();return he=ie.done,ie},e:function(ie){Ie=!0,oe=ie},f:function(){try{he||L.return==null||L.return()}finally{if(Ie)throw oe}}}}function O(v,ue){(ue==null||ue>v.length)&&(ue=v.length);for(var L=0,re=new Array(ue);L<ue;L++)re[L]=v[L];return re}var k=e(11),g={genUrlSep:function(v){return r(v=""+v).call(v,"?")===-1?"?imageView&":"&"},urlQuery2Object:function(v){if(Object.prototype.toString.call(v)!=="[object String]"||v==="")return{};var ue=r(v).call(v,"?");if(ue!==-1){var L=s(v).call(v,ue+1).split("&"),re={};return i(L).call(L,function(le){if(~r(le).call(le,"=")){var oe=le.split("=");re[oe[0]]=decodeURIComponent(oe[1])}else re[le]=""}),re}},url2object:function(v){Object.prototype.toString.call(v)!=="[object String]"&&(v="");var ue=r(v=v||"").call(v,"https")>=0?"https://":"http://",L=v.replace(ue,"");r(L).call(L,"?")>=0&&(L=L.substring(0,r(L).call(L,"?")));var re=L.split("/");L=re[0];var le="";if(re.length>0&&(le=s(re).call(re,1).join("/")),r(v).call(v,"?")===-1)return{protocol:ue,hostname:L,path:le,query:{}};var oe=v.substr(r(v).call(v,"?")+1).split("&"),he={};return i(oe).call(oe,function(Ie){if(r(Ie).call(Ie,"=")>0){var ie=Ie.split("=");he[ie[0]]=decodeURIComponent(ie[1])}else he[Ie]=""}),{protocol:ue,hostname:L,path:le,query:he}},object2url:function(v){var ue,L=v.protocol,re=v.hostname,le=v.path,oe=v.query;L=L||"http://",re=re||"",le&&(re=o(ue="".concat(re,"/")).call(ue,le)),oe=oe||{};var he,Ie,ie,Ne=[];for(var Ve in oe){var Ce;Ve!=="imageView"&&Ne.push(o(Ce="".concat(Ve,"=")).call(Ce,encodeURIComponent(oe[Ve])))}return Ne.length>0?o(he=o(Ie="".concat(L)).call(Ie,re,"?imageView&")).call(he,Ne.join("&")):o(ie="".concat(L)).call(ie,re)},genPrivateUrl:function(v,ue,L){if(ue&&ue.length){var re,le=S(ue);try{for(le.s();!(re=le.n()).done;){var oe=re.value;if(r(v).call(v,oe)>=0)return oe!==L&&(v=v.replace(oe,L)),v;if(r(v).call(v,oe)>=0&&oe===L)return v}}catch(xe){le.e(xe)}finally{le.f()}}var he,Ie,ie=g.url2object(v),Ne=ie.hostname,Ve=ie.path,Ce=k.downloadUrl,Ue=k.downloadHostList,qe=k.nosCdnEnable,Oe=k.serverNosConfig.cdnDomain,$e=decodeURIComponent(k.serverNosConfig.objectPrefix),_e=decodeURIComponent(Ve),er=r(_e).call(_e,$e);if(Oe&&er>-1&&qe)return o(he=o(Ie="".concat(ie.protocol)).call(Ie,Oe,"/")).call(he,s(_e).call(_e,er));if(a(Ue).call(Ue,Ne)&&a(Ve).call(Ve,"/")){var Pt=r(Ve).call(Ve,"/"),ar=Ve.substring(0,Pt),pr=Ve.substring(Pt+1);return Ce.replace("{bucket}",ar).replace("{object}",pr)}var lr=d(Ue).call(Ue,function(xe){return typeof Ne=="string"&&a(Ne).call(Ne,xe)})[0],or=lr?Ne.replace(lr,"").replace(/\W/g,""):null;return or?Ce.replace("{bucket}",or).replace("{object}",Ve):v}};t.exports=g},function(t,n,e){var r=e(5);t.exports=!r(function(){var s=(function(){}).bind();return typeof s!="function"||s.hasOwnProperty("prototype")})},function(t,n,e){var r=e(96),s=TypeError;t.exports=function(i){if(r(i))throw s("Can't call method on "+i);return i}},function(t,n,e){var r=e(49),s=e(161);(t.exports=function(i,o){return s[i]||(s[i]=o!==void 0?o:{})})("versions",[]).push({version:"3.27.1",mode:r?"pure":"global",copyright:"© 2014-2022 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.27.1/LICENSE",source:"https://github.com/zloirock/core-js"})},function(t,n,e){var r=e(321);t.exports=function(s){var i=+s;return i!=i||i===0?0:r(i)}},function(t,n,e){var r=e(5),s=e(21),i=e(98),o=s("species");t.exports=function(a){return i>=51||!r(function(){var d=[];return(d.constructor={})[o]=function(){return{foo:1}},d[a](Boolean).foo!==1})}},function(t,n){t.exports={}},function(t,n,e){var r=e(371).charAt,s=e(50),i=e(101),o=e(169),a=e(170),d=i.set,c=i.getterFor("String Iterator");o(String,"String",function(u){d(this,{type:"String Iterator",string:s(u),index:0})},function(){var u,m=c(this),y=m.string,S=m.index;return S>=y.length?a(void 0,!0):(u=r(y,S),m.index+=u.length,a(u,!1))})},function(t,n,e){var r=e(65),s=e(14);t.exports=r(s.process)=="process"},function(t,n,e){var r=e(14),s=e(105),i=e(17),o=e(211),a=e(215),d=e(21),c=e(400),u=e(243),m=e(49),y=e(98),S=s&&s.prototype,O=d("species"),k=!1,g=i(r.PromiseRejectionEvent),v=o("Promise",function(){var ue=a(s),L=ue!==String(s);if(!L&&y===66||m&&(!S.catch||!S.finally))return!0;if(!y||y<51||!/native code/.test(ue)){var re=new s(function(oe){oe(1)}),le=function(oe){oe(function(){},function(){})};if((re.constructor={})[O]=le,!(k=re.then(function(){})instanceof le))return!0}return!L&&(c||u)&&!g});t.exports={CONSTRUCTOR:v,REJECTION_EVENT:g,SUBCLASSING:k}},function(t,n,e){var r=e(26),s=e(62),i=e(574),o=e(576),a=e(582),d={},c=s.f;function u(g){var v=g.upload=(g.headers||s.o)["Content-Type"]==="multipart/form-data",ue=!1;try{ue=(location.protocol+"//"+location.host).toLowerCase()!==s.url2origin(g.url)}catch{}return g.cors=ue,v||ue||g.mode?function(L){var re=L.mode,le=i,oe=s.getGlobal();return!oe.FormData&&oe.document&&(re="iframe"),re==="iframe"&&(le=L.upload?o:a),new le(L)}(g):new i(g)}function m(g,v,ue){var L=d[g];if(L){v==="onload"&&L.result&&(ue=function(le,oe){oe={data:oe};var he=le.result.headers;return he&&(oe.headers=le.req.header(he)),oe}(L,ue)),function(le){var oe=d[le];oe&&(oe.req.destroy(),delete d[le])}(g);var re={type:v,result:ue};c(re),re.stopped||L[v](re.result)}}function y(g,v){m(g,"onload",v)}function S(g,v){m(g,"onerror",v)}function O(g,v){var ue=s.genUrlSep(g);return v=v||"",s.isObject(v)&&(v=s.object2query(v)),v&&(g+=ue+v),g}function k(g,v){v=v||{};var ue=s.uniqueID(),L={result:v.result,onload:v.onload||s.f,onerror:v.onerror||s.f};d[ue]=L,v.onload=r(y).call(y,null,ue),v.onerror=r(S).call(S,null,ue),v.query&&(g=O(g,v.query));var re=v.method||"";return re&&!/get/i.test(re)||!v.data||(g=O(g,v.data),v.data=null),v.url=g,L.req=u(v),ue}k.filter=function(g){s.isFunction(g)&&(c=g)},k.abort=function(g){var v=d[g];v&&v.req&&v.req.abort()},t.exports=k},function(t,n,e){var r=e(8),s=e(303),i=e(22),o=e(108).genPrivateUrl,a=e(0),d=a.notundef,c=a.exist,u=e(195),m=e(297),y=m.typeMap;function S(O){O.resend?(a.verifyOptions(O,"idClient","msg::Message"),this.idClient=O.idClient):this.idClient=a.guid(),this.type=y[O.type],this.resend=O.resend?1:0,d(O.subType)&&(a.isInt(+O.subType)&&+O.subType>0?this.subType=+O.subType:a.onParamError("subType只能是大于0的整数","msg::Message")),d(O.custom)&&(i(O.custom)==="object"?this.custom=r(O.custom):this.custom=""+O.custom),d(O.text)&&(this.body=""+O.text),d(O.body)&&(this.body=""+O.body),d(O.yidunEnable)&&(this.yidunEnable=O.yidunEnable?1:0),d(O.antiSpamUsingYidun)&&(this.antiSpamUsingYidun=O.antiSpamUsingYidun?1:0),d(O.antiSpamContent)&&(i(O.antiSpamContent)==="object"?this.antiSpamContent=r(O.antiSpamContent):this.antiSpamContent=""+O.antiSpamContent),d(O.antiSpamBusinessId)&&(i(O.antiSpamBusinessId)==="object"?this.antiSpamBusinessId=r(O.antiSpamBusinessId):this.antiSpamBusinessId=""+O.antiSpamBusinessId),d(O.yidunAntiCheating)&&(this.yidunAntiCheating=O.yidunAntiCheating+""),d(O.skipHistory)&&(this.skipHistory=O.skipHistory?1:0),d(O.highPriority)&&(this.highPriority=O.highPriority?1:0),d(O.clientAntiSpam)&&(this.clientAntiSpam=O.clientAntiSpam?1:0),d(O.env)&&(this.env=O.env),d(O.notifyTargetTags)&&(this.notifyTargetTags=O.notifyTargetTags),d(O.yidunAntiSpamExt)&&(this.yidunAntiSpamExt=O.yidunAntiSpamExt),(d(O.loc_x)||d(O.loc_y)||d(O.loc_z))&&(this.loc_x=O.loc_x,this.loc_y=O.loc_y,this.loc_z=O.loc_z)}S.validTypes=m.validTypes,a.merge(S.prototype,m.prototype),S.getType=m.getType,S.setFlow=m.setFlow,S.reverse=function(O){var k=a.filterObj(O,"chatroomId idClient from fromNick fromAvatar _fromAvatar_safe fromCustom userUpdateTime custom status notifyTargetTags");return d(k.fromAvatar)&&(k.fromAvatar=o(k.fromAvatar)),k=a.merge(k,{fromClientType:u.reverseType(O.fromClientType),time:+O.time,type:S.getType(O),text:c(O.body)?O.body:O.text||"",resend:+O.resend==1}),d(k.userUpdateTime)&&(k.userUpdateTime=+k.userUpdateTime),d(O.callbackExt)&&(k.callbackExt=O.callbackExt),d(O.subType)&&(k.subType=+O.subType),d(O.yidunAntiSpamRes)&&(k.yidunAntiSpamRes=O.yidunAntiSpamRes),d(O.loc_x)&&(k.x=s(O.loc_x),k.y=s(O.loc_y),k.z=s(O.loc_z)),d(O.toAccids)&&(k.toAccids=O.toAccids),k.status=k.status||"success",k},S.setExtra=function(O,k){m.setFlow(O,k)},t.exports=S},function(t,n,e){var r=e(217),s=e(167);t.exports=Object.keys||function(i){return r(i,s)}},function(t,n,e){t.exports=e(423)},function(t,n,e){t.exports=e(432)},function(t,n,e){t.exports=e(444)},function(t,n,e){var r=e(175),s=e(504),i=e(505),o=r?r.toStringTag:void 0;t.exports=function(a){return a==null?a===void 0?"[object Undefined]":"[object Null]":o&&o in Object(a)?s(a):i(a)}},function(t,n,e){var r=e(596),s=e(188),i=e(603);t.exports=function(o,a){if(o==null)return{};var d,c,u=i(o,a);if(r){var m=r(o);for(c=0;c<m.length;c++)d=m[c],s(a).call(a,d)>=0||Object.prototype.propertyIsEnumerable.call(o,d)&&(u[d]=o[d])}return u},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,n,e){t.exports=e(570)},function(t,n,e){var r=e(12),s=e(5),i=e(65),o=Object,a=r("".split);t.exports=s(function(){return!o("z").propertyIsEnumerable(0)})?function(d){return i(d)=="String"?a(d,""):o(d)}:o},function(t,n,e){var r=e(318),s=e(129);t.exports=function(i){var o=r(i,"string");return s(o)?o:o+""}},function(t,n,e){var r=e(33),s=e(17),i=e(19),o=e(209),a=Object;t.exports=o?function(d){return typeof d=="symbol"}:function(d){var c=r("Symbol");return s(c)&&i(c.prototype,a(d))}},function(t,n,e){var r=e(12),s=0,i=Math.random(),o=r(1 .toString);t.exports=function(a){return"Symbol("+(a===void 0?"":a)+")_"+o(++s+i,36)}},function(t,n,e){var r=e(112),s=Math.max,i=Math.min;t.exports=function(o,a){var d=r(o);return d<0?s(d+a,0):i(d,a)}},function(t,n,e){var r=e(12),s=e(5),i=e(17),o=e(67),a=e(33),d=e(215),c=function(){},u=[],m=a("Reflect","construct"),y=/^\s*(?:class|function)\b/,S=r(y.exec),O=!y.exec(c),k=function(v){if(!i(v))return!1;try{return m(c,u,v),!0}catch{return!1}},g=function(v){if(!i(v))return!1;switch(o(v)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return O||!!S(y,d(v))}catch{return!0}};g.sham=!0,t.exports=!m||s(function(){var v;return k(k.call)||!k(Object)||!k(function(){v=!0})||v})?g:k},function(t,n,e){var r=e(111),s=e(130),i=r("keys");t.exports=function(o){return i[o]||(i[o]=s(o))}},function(t,n,e){var r=e(217),s=e(167).concat("length","prototype");n.f=Object.getOwnPropertyNames||function(i){return r(i,s)}},function(t,n){n.f=Object.getOwnPropertySymbols},function(t,n,e){var r=e(21);n.f=r},function(t,n,e){var r=e(30),s=e(17),i=e(42),o=e(133),a=e(229),d=o("IE_PROTO"),c=Object,u=c.prototype;t.exports=a?c.getPrototypeOf:function(m){var y=i(m);if(r(y,d))return y[d];var S=y.constructor;return s(S)&&y instanceof S?S.prototype:y instanceof c?u:null}},function(t,n,e){var r=e(12),s=e(36),i=e(355);t.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var o,a=!1,d={};try{(o=r(Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set))(d,[]),a=d instanceof Array}catch{}return function(c,u){return s(c),i(u),a?o(c,u):c.__proto__=u,c}}():void 0)},function(t,n,e){var r=e(67),s=e(160),i=e(96),o=e(103),a=e(21)("iterator");t.exports=function(d){if(!i(d))return s(d,a)||s(d,"@@iterator")||o[r(d)]}},function(t,n,e){t.exports=e(407)},function(t,n,e){t.exports=e(449)},function(t,n,e){var r=e(493),s=e(494),i=e(495),o=e(496),a=e(497);function d(c){var u=-1,m=c==null?0:c.length;for(this.clear();++u<m;){var y=c[u];this.set(y[0],y[1])}}d.prototype.clear=r,d.prototype.delete=s,d.prototype.get=i,d.prototype.has=o,d.prototype.set=a,t.exports=d},function(t,n,e){var r=e(201);t.exports=function(s,i){for(var o=s.length;o--;)if(r(s[o][0],i))return o;return-1}},function(t,n,e){var r=e(87)(Object,"create");t.exports=r},function(t,n,e){var r=e(517);t.exports=function(s,i){var o=s.__data__;return r(i)?o[typeof i=="string"?"string":"hash"]:o.map}},function(t,n,e){var r=e(261),s=e(262);t.exports=function(i,o,a,d){var c=!a;a||(a={});for(var u=-1,m=o.length;++u<m;){var y=o[u],S=d?d(a[y],i[y],y,a,i):void 0;S===void 0&&(S=i[y]),c?s(a,y,S):r(a,y,S)}return a}},function(t,n){t.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},function(t,n){t.exports=`	
\v\f\r                　\u2028\u2029\uFEFF`},function(t,n,e){var r,s=e(18),i=e(2),o=e(9),a=e(3),d=e(6),c=e(7),u=e(26),m=e(8),y=e(108).urlQuery2Object,S=e(0),O=e(41),k=e(744),g=e(745),v=e(746),ue=e(747),L=e(748),re=e(749);function le(ie){this.mixin(ie)}le.prototype=s((function(){}).prototype,{protocol:{value:null,writable:!0,enumerable:!0,configurable:!0}}),le.prototype.setProtocol=function(ie){this.protocol=ie},le.prototype.mixin=function(ie){var Ne,Ve,Ce=this;this.configMap=this.configMap||{},i(Ne=["idMap","cmdConfig","packetConfig"]).call(Ne,function(Ue){Ce.configMap[Ue]=S.merge({},Ce.configMap[Ue],ie.configMap&&ie.configMap[Ue])}),i(Ve=["serializeMap","unserializeMap"]).call(Ve,function(Ue){Ce[Ue]=S.merge({},Ce[Ue],ie[Ue])})},le.prototype.createCmd=(r=1,function(ie,Ne){var Ve,Ce=this,Ue=this.configMap.cmdConfig[ie],qe=this.configMap.packetConfig[Ue.sid+"_"+Ue.cid],Oe=ie==="heartbeat"?0:r++;return Oe>32767&&(Oe=1,r=2),ie={SID:Ue.sid,CID:Ue.cid,SER:Oe,isAwaitable:typeof Ue.isAwaitable=="boolean"?Ue.isAwaitable:!(!qe||!qe.response)},Ue.params&&(ie.Q=[],i(Ve=Ue.params).call(Ve,function($e){var _e=$e.type,er=$e.name,Pt=$e.entity,ar=Ne[er];if(!S.undef(ar)){switch(_e){case"PropertyArray":_e="ArrayMable",ar=o(ar).call(ar,function(pr){return{t:"Property",v:Ce.serialize(pr,Pt)}});break;case"Property":ar=Ce.serialize(ar,er);break;case"bool":ar=ar?"true":"false"}ie.Q.push({t:_e,v:ar})}})),ie}),le.prototype.parseResponse=function(ie){var Ne=this;return new a(function(Ve){var Ce=JSON.parse(ie),Ue={raw:Ce,rawStr:ie,error:O.genError(Ce.code)},qe=Ne.configMap.packetConfig[Ce.sid+"_"+Ce.cid];if(!qe)return Ue.notFound={sid:Ce.sid,cid:Ce.cid},void Ve(Ue);var Oe=Ce.r,$e=qe.service==="notify"&&!qe.cmd;if(Ue.isNotify=$e,$e){var _e=Ce.r[1].headerPacket;if(qe=Ne.configMap.packetConfig[_e.sid+"_"+_e.cid],Oe=Ce.r[1].body,!qe)return Ue.notFound={sid:_e.sid,cid:_e.cid},void Ve(Ue)}if(Ue.service=qe.service,Ue.cmd=qe.cmd,Ue.error){var er,Pt,ar=d(er="".concat(Ce.sid,"_")).call(er,Ce.cid);if($e&&(ar=d(Pt="".concat(_e.sid,"_")).call(Pt,_e.cid)),Ue.error.cmd=Ue.cmd,Ue.error.callFunc="protocol::parseResponse: ".concat(ar),Ue.error.code===416){var pr=Oe[0];pr&&(Ue.frequencyControlDuration=1e3*pr)}}var lr,or=!1;Ue.error&&qe.trivialErrorCodes&&(or=c(lr=qe.trivialErrorCodes).call(lr,Ue.error.code)!==-1);var xe=[];if((!Ue.error||or)&&qe.response){var nr;Ue.content={};var ir=function(dr,Lt,cr,mr){if(dr&&mr==="msg"||mr==="sysMsg"){var tr=cr.content[mr];S.isObject(tr)&&!tr.idServer&&(tr.idServer=""+Lt.r[0])}};i(nr=qe.response).call(nr,function(dr,Lt){var cr,mr=Oe[Lt];if(!S.undef(mr)){var tr=dr.type,At=dr.name,kt=dr.entity||At;switch(tr){case"Property":xe.push(Ne.unserialize(mr,kt).then(u(cr=function(Dt,gr,yr,vr,Ir){yr.content[vr]=Ir,ir(Dt,gr,yr,vr)}).call(cr,this,$e,Ce,Ue,At)));break;case"PropertyArray":Ue.content[At]=[],i(mr).call(mr,function(Dt,gr){var yr;xe.push(Ne.unserialize(Dt,kt).then(u(yr=function(vr,Ir,Mr){vr.content[Ir][gr]=Mr}).call(yr,this,Ue,At)))});break;case"KVArray":Ue.content[At]=mr,ir($e,Ce,Ue,At);break;case"long":case"Long":case"byte":case"Byte":case"Number":Ue.content[At]=+mr;break;default:Ue.content[At]=mr,ir($e,Ce,Ue,At)}}})}a.all(xe).then(function(){Ve(Ue)})})},le.prototype.serialize=function(ie,Ne){var Ve=this.serializeMap[Ne],Ce={};for(var Ue in Ve)ie.hasOwnProperty(Ue)&&(Ce[Ve[Ue]]=ie[Ue]);return Ce},le.prototype.matchNosSafeUrl=function(ie){if(!S.isString(ie)||!~c(ie).call(ie,"_im_url=1"))return!1;var Ne=y(ie);return!(!Ne||!Ne._im_url||Ne._im_url!=1)},le.prototype.getOneNosOriginUrl=function(ie,Ne,Ve){var Ce=this;return new a(function(Ue){Ce.protocol.getNosOriginUrlReqNum++,Ce.protocol.sendCmd("getNosOriginUrl",{nosFileUrlTag:{safeUrl:ie}},function(qe,Oe,$e){Ce.protocol.getNosOriginUrlReqNum--,qe?Ce.protocol.logger.warn("error: get nos originUrl failed",qe):(Ne["_"+Ve+"_safe"]=Ne[Ve],Ne[Ve]=$e.nosFileUrlTag&&$e.nosFileUrlTag.originUrl),Ue()})})},le.prototype.checkObjSafeUrl=function(ie,Ne,Ve){var Ce=this;for(var Ue in ie)if(ie.hasOwnProperty(Ue)){var qe=ie[Ue];if(S.isString(qe)){if(this.matchNosSafeUrl(qe)){var Oe=this.getOneNosOriginUrl(qe,ie,Ue);Ne.push(Oe),Ve.push(Oe)}}else S.isObject(qe)?this.checkObjSafeUrl(qe,Ne,Ve):S.isArray(qe)&&i(qe).call(qe,function($e){S.isObject($e)&&Ce.checkObjSafeUrl($e,Ne,Ve)})}};var oe=["url","avatar","fromAvatar","chatroomAvatar"];le.prototype.unserialize=function(ie,Ne){var Ve=this;return new a(function(Ce){var Ue=Ve.unserializeMap[Ne],qe={},Oe=[];if(ie)for(var $e in Ue){var _e,er=[];if(ie.hasOwnProperty($e)&&(qe[Ue[$e]]=ie[$e],Ve.protocol.hasLogin&&!Ve.protocol.keepNosSafeUrl))if(Ue[$e]==="attach"&&ie[$e]&&c(ie[$e])&&~c(_e=ie[$e]).call(_e,"_im_url=1"))try{var Pt,ar=JSON.parse(ie[$e]);ar.isS3||Ve.checkObjSafeUrl(ar,er,Oe),a.all(er).then(u(Pt=function(pr,lr){pr.attach=m(lr)}).call(Pt,Ve,qe,ar))}catch(pr){Ve.logger.warn("unserialize",pr&&pr.message)}else~c(oe).call(oe,Ue[$e])&&ie[$e]&&Ve.matchNosSafeUrl(ie[$e])&&Oe.push(Ve.getOneNosOriginUrl(ie[$e],qe,Ue[$e]))}a.all(Oe).then(function(){Ce(qe)})})},le.prototype.syncUnserialize=function(ie,Ne){var Ve=this.unserializeMap[Ne],Ce={};if(ie)for(var Ue in Ve)ie.hasOwnProperty(Ue)&&(Ce[Ve[Ue]]=ie[Ue]);return Ce};var he=new le({configMap:k,serializeMap:g,unserializeMap:v}),Ie=new le({configMap:ue,serializeMap:L,unserializeMap:re});t.exports={IM:he,Chatroom:Ie}},function(t,n,e){var r={}.propertyIsEnumerable,s=Object.getOwnPropertyDescriptor,i=s&&!r.call({1:2},1);n.f=i?function(o){var a=s(this,o);return!!a&&a.enumerable}:r},function(t,n,e){t.exports=e(622)},function(t,n,e){var r=e(9),s=e(10),i=e(0),o=i.notundef,a=i.fillPropertyWithDefault,d={0:"normal",1:"owner",2:"manager"};function c(u){i.verifyOptions(u,"teamId","team::TeamMember"),i.verifyParamAtLeastPresentOne(u,"nickInTeam muteTeam muteNotiType custom","team::TeamMember"),this.teamId=u.teamId,o(u.account)&&(this.account=u.account),o(u.nickInTeam)&&(this.nickInTeam=u.nickInTeam),o(u.muteNotiType)?this.bits=u.muteNotiType:o(u.muteTeam)&&(this.bits=0,u.muteTeam&&(this.bits+=1)),o(u.mute)&&(this.mute=u.mute?1:0),o(u.custom)&&(this.custom=""+u.custom)}c.reverse=function(u){var m=i.copy(u);if(o(m.teamId)&&(m.teamId=""+m.teamId),o(m.type)&&(m.type=d[m.type]),o(m.active)&&(m.active=+m.active==1),o(m.valid)&&(m.valid=+m.valid==1),o(m.mute)&&(m.mute=+m.mute==1),o(m.joinTime)&&(m.joinTime=+m.joinTime),o(m.updateTime)&&(m.updateTime=+m.updateTime),o(m.bits)){var y=m.bits;delete m.bits,m.muteTeam=!!(1&y),m.muteNotiType=y}return o(m.teamId)&&o(m.account)&&(m.id=c.genId(m.teamId,m.account)),o(m.followAccountIds)&&(m.followAccountIds=JSON.parse(m.followAccountIds)),m},c.reverseMembers=function(u){return r(u).call(u,function(m){return s(c).call(c,m)})},c.fillProperties=function(u){var m=a(u,"mute",!1),y=a(u,"custom","");return m||y},c.genId=function(u,m){return u+"-"+m},c.accounts2ids=function(u,m){return r(m).call(m,function(y){return c.genId(u,y)})},c.assembleMembers=function(u,m){return i.isArray(m)||(m=[m]),r(m).call(m,function(y){return c.assembleMember(u,y)})},c.assembleMember=function(u,m){return{id:c.genId(u.teamId,m),account:m,teamId:u.teamId,type:"normal",nickInTeam:"",muteTeam:!1,mute:!1,joinTime:u.memberUpdateTime,updateTime:u.memberUpdateTime,active:!0,valid:!0,invitorAccid:"",followAccountIds:[]}},c.assembleOwner=function(u){var m=c.assembleMember(u,u.owner);return m.type="owner",m},t.exports=c},function(t,n,e){var r,s=e(22),i=e(7),o=e(8),a=e(6),d=e(4),c=e(10),u=e(16),m=e(9),y=e(2),S=e(0),O=S.undef,k=S.notundef,g=e(149).IM,v=e(194),ue=e(152),L={customP2p:100,customTeam:101,customSuperTeam:103,deleteMsgP2p:7,deleteMsgTeam:8,deleteMsgSuperTeam:12,deleteOnewayMsgP2p:13,deleteOnewayMsgTeam:14},re={0:"applyTeam",1:"rejectTeamApply",2:"teamInvite",3:"rejectTeamInvite",5:"friendRequest",6:"deleteFriend",7:"deleteMsgP2p",8:"deleteMsgTeam",12:"deleteMsgSuperTeam",13:"deleteMsgP2pOneWay",14:"deleteMsgTeamOneWay",15:"applySuperTeam",16:"rejectSuperTeamApply",17:"superTeamInvite",18:"rejectSuperTeamInvite",100:"customP2p",101:"customTeam",103:"customSuperTeam",102:"customP2p"},le={1:"addFriend",2:"applyFriend",3:"passFriendApply",4:"rejectFriendApply"},oe=["team","superTeam","friend","msg"],he={applyTeam:"team",rejectTeamApply:"team",teamInvite:"team",rejectTeamInvite:"team",applySuperTeam:"superTeam",rejectSuperTeamApply:"superTeam",superTeamInvite:"superTeam",rejectSuperTeamInvite:"superTeam",addFriend:"friend",applyFriend:"friend",passFriendApply:"friend",rejectFriendApply:"friend",deleteFriend:"friend",deleteMsg:"msg"};function Ie(ie){var Ne,Ve;S.verifyOptions(ie,"type to","sysmsg::SystemMessage"),S.verifyParamValid("type",ie.type,Ie.validTypes,"sysmsg::SystemMessage"),i(Ne=ie.type).call(Ne,"custom")!==-1&&(S.verifyOptions(ie,"content","sysmsg::SystemMessage"),this.attach=ie.content,k(ie.apnsText)&&(this.apnsText=""+ie.apnsText),k(ie.pushPayload)&&(s(ie.pushPayload)==="object"?this.pushPayload=o(ie.pushPayload):this.pushPayload=""+ie.pushPayload),k(ie.sendToOnlineUsersOnly)&&(this.sendToOnlineUsersOnly=ie.sendToOnlineUsersOnly?0:1),k(ie.cc)&&(this.cc=ie.cc?1:0),k(ie.isPushable)&&(this.isPushable=ie.isPushable?1:0),k(ie.isUnreadable)&&(this.isUnreadable=ie.isUnreadable?1:0),k(ie.needPushNick)&&(this.needPushNick=ie.needPushNick?1:0)),i(Ve=ie.type).call(Ve,"deleteMsg")===0&&(ie.apnsText&&(this.apnsText=ie.apnsText),ie.pushPayload&&(this.pushPayload=ie.pushPayload),ie.attach&&(this.attach=ie.attach)),this.time=ie.time||+new Date,this.type=L[ie.type],this.to=ie.to,k(ie.from)&&(this.from=ie.from),k(ie.ps)&&(this.ps=ie.ps),k(ie.deletedIdClient)&&(this.deletedIdClient=ie.deletedIdClient),k(ie.deletedIdServer)&&(this.deletedIdServer=ie.deletedIdServer),k(ie.opeAccount)&&(this.opeAccount=ie.opeAccount),k(ie.yidunEnable)&&(this.yidunEnable=ie.yidunEnable?1:0),k(ie.antiSpamContent)&&(s(ie.antiSpamContent)==="object"?this.antiSpamContent=o(ie.antiSpamContent):this.antiSpamContent=""+ie.antiSpamContent),k(ie.antiSpamBusinessId)&&(s(ie.antiSpamBusinessId)==="object"?this.antiSpamBusinessId=o(ie.antiSpamBusinessId):this.antiSpamBusinessId=""+ie.antiSpamBusinessId),k(ie.env)&&(this.env=ie.env),this.idClient=ie.idClient||S.guid()}Ie.validTypes=a(r=d(L)).call(r,d(he)),Ie.validCategories=["team","friend"],Ie.isCustom=function(ie){return ie.type==="custom"},Ie.reverse=function(ie){var Ne,Ve={time:+ie.time,to:ie.to,type:re[ie.type]};if(k(ie.from)&&(Ve.from=ie.from),k(ie.idClient)&&(Ve.idClient=ie.idClient),k(ie.idServer)&&(Ve.idServer=""+ie.idServer),k(ie.deletedIdClient)&&(Ve.deletedIdClient=ie.deletedIdClient),k(ie.deletedIdServer)&&(Ve.deletedIdServer=""+ie.deletedIdServer),k(ie.deletedMsgTime)&&(Ve.deletedMsgTime=+ie.deletedMsgTime),k(ie.deletedMsgFromNick)&&(Ve.deletedMsgFromNick=""+ie.deletedMsgFromNick),k(ie.opeAccount)&&(Ve.opeAccount=ie.opeAccount),k(ie.ps)&&(Ve.ps=ie.ps),k(ie.callbackExt)&&(Ve.callbackExt=ie.callbackExt),ie.attach=ie.attach?""+ie.attach:"",Ve.type==="customP2p"||Ve.type==="customTeam"||Ve.type==="customSuperTeam")Ve.content=ie.attach,k(ie.apnsText)&&(Ve.apnsText=ie.apnsText),k(ie.pushPayload)&&(Ve.pushPayload=ie.pushPayload),S.merge(Ve,{sendToOnlineUsersOnly:O(ie.sendToOnlineUsersOnly)||+ie.sendToOnlineUsersOnly==0,cc:O(ie.cc)||+ie.cc==1,isPushable:O(ie.isPushable)||+ie.isPushable==1,isUnreadable:O(ie.isUnreadable)||+ie.isUnreadable==1,needPushNick:k(ie.needPushNick)&&+ie.needPushNick==1}),Ve.type==="customP2p"?Ve.scene="p2p":Ve.type==="customSuperTeam"?Ve.scene="superTeam":Ve.type==="customTeam"&&(Ve.scene="team"),Ve.type="custom";else if(i(Ne=Ve.type).call(Ne,"deleteMsg")===0){ie.apnsText&&(Ve.apnsText=ie.apnsText),ie.pushPayload&&(Ve.pushPayload=ie.pushPayload),ie.attach&&(Ve.attach=ie.attach);var Ce=Ve.type.toLowerCase();i(Ce).call(Ce,"p2p")>-1?Ve.scene="p2p":i(Ce).call(Ce,"superteam")>-1?Ve.scene="superTeam":i(Ce).call(Ce,"team")>-1&&(Ve.scene="team"),Ve.type="deleteMsg"}else{if(ie.attach){Ve.attach={};var Ue=JSON.parse(ie.attach);k(Ue.vt)?(Ve.type=le[Ue.vt],Ue.serverex&&Ue.serverex[0]===1&&(Ve.serverex=Ue.serverex[1]),delete Ve.attach):(k(Ue.tinfo)&&(Ve.attach.team=c(v).call(v,g.syncUnserialize(Ue.tinfo,"team"))),k(Ue.tlist)&&(Ve.attach.member=c(ue).call(ue,g.syncUnserialize(Ue.tlist,"teamMember"))),k(Ue.attach)&&(Ve.attach.custom=Ue.attach))}Ve.category=he[Ve.type],Ve.read=!1,Ve.state="init"}return k(ie.cc)&&(Ve.cc=+ie.cc==1),Ve.status=ie.status||"success",k(u(ie))&&(Ve.filter=u(ie)),Ve},Ie.reverseSysMsgs=function(ie,Ne){var Ve=(Ne=Ne||{}).mapper,Ce=S.isFunction(Ve);return m(ie).call(ie,function(Ue){return Ue=c(Ie).call(Ie,Ue),Ce&&(Ue=Ve(Ue)),Ue})},Ie.completeUnread=function(ie){var Ne,Ve;return ie=ie||{},y(oe).call(oe,function(Ce){delete ie[Ce]}),y(Ne=d(he)).call(Ne,function(Ce){ie[Ce]=ie[Ce]||0,ie[Ce]<0&&(ie[Ce]=0),ie[Ve=he[Ce]]=ie[Ve]||0,ie[Ve]=ie[Ve]+ie[Ce]}),ie.total=0,y(oe).call(oe,function(Ce){ie.total+=ie[Ce]}),ie},t.exports=Ie},function(t,n,e){var r=e(125),s=["unreadMsgs"],i=e(0);function o(){}o.parse=function(a){var d=a.split("|");return{scene:d[0],to:d[1]}},o.genSessionByMsg=function(a){return{id:a.sessionId,scene:a.scene,to:a.target,updateTime:a.time,lastMsg:a}},o.appendLastMsg=function(a){var d=a.lastMsg;a["last"+i.capFirstLetter(d.type)+"Msg"]=d,a["last"+i.capFirstLetter(d.flow)+"Msg"]=d},o.genSessionByMsgs=function(a,d){var c=a.getLastNotIgnoredMsg(d);return c?o.genSessionByMsg(c):null},o.trim=function(a){var d=a=i.simpleClone(a);return d.unreadMsgs,r(d,s)},o.isComplete=function(a){return a.id&&a.scene&&a.to},t.exports=o},function(t,n,e){t.exports=e(329)},function(t,n,e){var r=e(491);t.exports=function(s){return r(s,5)}},function(t,n,e){var r=e(18),s=e(173),i={V2NIM_LOGIN_STATUS_LOGOUT:0,V2NIM_LOGIN_STATUS_LOGINED:1,V2NIM_LOGIN_STATUS_LOGINING:2},o={V2NIM_CONNECT_STATUS_DISCONNECTED:0,V2NIM_CONNECT_STATUS_CONNECTED:1,V2NIM_CONNECT_STATUS_CONNECTING:2,V2NIM_CONNECT_STATUS_WAITING:3};function a(d){this.loginStatus=i.V2NIM_LOGIN_STATUS_LOGOUT,this.connectStatus=o.V2NIM_CONNECT_STATUS_DISCONNECTED,this.logger=d.logger,this.setMonitor()}a.prototype=r(new s),a.prototype.setMonitor=function(){var d=this;this.on("auth/loginLifeCycleAddressing",function(){d.logger.log("auth::life cycle addressing"),d.setLoginStatus(i.V2NIM_LOGIN_STATUS_LOGINING),d.setConnectStatus(o.V2NIM_CONNECT_STATUS_CONNECTING)}),this.on("auth/loginLifeCycleConnect",function(){d.logger.log("auth::life cycle connecting"),d.setLoginStatus(i.V2NIM_LOGIN_STATUS_LOGINING),d.setConnectStatus(o.V2NIM_CONNECT_STATUS_CONNECTING)}),this.on("auth/loginLifeCycleConnectSucc",function(){d.logger.log("auth::life cycle connect success"),d.setLoginStatus(i.V2NIM_LOGIN_STATUS_LOGINING),d.setConnectStatus(o.V2NIM_CONNECT_STATUS_CONNECTED)}),this.on("auth/loginLifeCycleConnectFail",function(c){d.logger.log("auth::life cycle connect fail"),d.setLoginStatus(i.V2NIM_LOGIN_STATUS_LOGOUT),d.setConnectStatus(o.V2NIM_CONNECT_STATUS_DISCONNECTED,c)}),this.on("auth/loginLifeCycleDisconnected",function(c){d.logger.log("auth::life cycle disconnected:",c&&c.message),d.setLoginStatus(i.V2NIM_LOGIN_STATUS_LOGOUT),d.setConnectStatus(o.V2NIM_CONNECT_STATUS_DISCONNECTED,c)}),this.on("auth/loginLifeCycleLoginSucc",function(){d.logger.log("auth::life cycle login success, verify authentication success"),d.setLoginStatus(i.V2NIM_LOGIN_STATUS_LOGINED)}),this.on("auth/loginLifeCycleLoginFail",function(c){d.logger.log("auth::life cycle login fail due to verify authentication failed:",c),d.setLoginStatus(i.V2NIM_LOGIN_STATUS_LOGOUT,c)}),this.on("auth/loginLifeCycleLogout",function(){d.logger.log("auth::life cycle logout"),d.setLoginStatus(i.V2NIM_LOGIN_STATUS_LOGOUT)}),this.on("auth/loginLifeCycleKicked",function(c){d.logger.log("auth::life cycle kicked",c),d.setLoginStatus(i.V2NIM_LOGIN_STATUS_LOGOUT)}),this.on("auth/loginLifeCycleWaiting",function(){d.logger.log("auth::life cycle waiting to reconnect"),d.getConnectStatus(),d.setLoginStatus(i.V2NIM_LOGIN_STATUS_LOGOUT),d.setConnectStatus(o.V2NIM_CONNECT_STATUS_WAITING)})},a.prototype.getConnectStatus=function(){return this.connectStatus},a.prototype.getLoginStatus=function(){return this.loginStatus},a.prototype.setLoginStatus=function(d,c){if(d!==this.loginStatus){var u=this.loginStatus;this.loginStatus=d,this.emit("loginStatus",d),this.delegateLoginEvent(u,d,c)}},a.prototype.delegateLoginEvent=function(d,c,u){d===i.V2NIM_LOGIN_STATUS_LOGINING&&c===i.V2NIM_LOGIN_STATUS_LOGOUT&&this.emit("loginFailed",u)},a.prototype.setConnectStatus=function(d,c){if(d!==this.connectStatus){var u=this.connectStatus;this.connectStatus=d,this.emit("connectStatus",d),this.delegateConnectEvent(u,d,c)}},a.prototype.delegateConnectEvent=function(d,c,u){d===o.V2NIM_CONNECT_STATUS_CONNECTED&&c===o.V2NIM_CONNECT_STATUS_DISCONNECTED&&this.emit("disconnected",u),d===o.V2NIM_CONNECT_STATUS_CONNECTING&&c===o.V2NIM_CONNECT_STATUS_CONNECTED&&this.emit("connectSuccess"),d===o.V2NIM_CONNECT_STATUS_CONNECTING&&c===o.V2NIM_CONNECT_STATUS_DISCONNECTED&&this.emit("connectFailed",u),d!==o.V2NIM_CONNECT_STATUS_DISCONNECTED&&this.connectStatus!==o.V2NIM_CONNECT_STATUS_WAITING||c!==o.V2NIM_CONNECT_STATUS_CONNECTING||this.emit("connecting")},a.prototype.destroy=function(){this.removeAllListeners()},t.exports={V2NIMLoginStatus:i,V2NIMConnectStatus:o,StatusProtector:a}},function(t,n,e){t.exports=e(633)},function(t,n,e){var r=e(65),s=e(12);t.exports=function(i){if(r(i)==="Function")return s(i)}},function(t,n,e){var r=e(31),s=e(96);t.exports=function(i,o){var a=i[o];return s(a)?void 0:r(a)}},function(t,n,e){var r=e(14),s=e(320),i=r["__core-js_shared__"]||s("__core-js_shared__",{});t.exports=i},function(t,n,e){var r=e(14),s=e(28),i=r.document,o=s(i)&&s(i.createElement);t.exports=function(a){return o?i.createElement(a):{}}},function(t,n,e){var r=e(44),s=e(131),i=e(46),o=function(a){return function(d,c,u){var m,y=r(d),S=i(y),O=s(u,S);if(a&&c!=c){for(;S>O;)if((m=y[O++])!=m)return!0}else for(;S>O;O++)if((a||O in y)&&y[O]===c)return a||O||0;return!a&&-1}};t.exports={includes:o(!0),indexOf:o(!1)}},function(t,n,e){var r=e(326);t.exports=function(s,i){return new(r(s))(i===0?0:i)}},function(t,n,e){var r={};r[e(21)("toStringTag")]="z",t.exports=String(r)==="[object z]"},function(t,n,e){var r=e(27),s=e(212),i=e(39),o=e(36),a=e(44),d=e(120);n.f=r&&!s?Object.defineProperties:function(c,u){o(c);for(var m,y=a(u),S=d(u),O=S.length,k=0;O>k;)i.f(c,m=S[k++],y[m]);return c}},function(t,n){t.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},function(t,n,e){var r=e(65),s=e(44),i=e(134).f,o=e(221),a=typeof window=="object"&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];t.exports.f=function(d){return a&&r(d)=="Window"?function(c){try{return i(c)}catch{return o(a)}}(d):i(s(d))}},function(t,n,e){var r=e(1),s=e(20),i=e(49),o=e(227),a=e(17),d=e(354),c=e(137),u=e(138),m=e(85),y=e(61),S=e(68),O=e(21),k=e(103),g=e(228),v=o.PROPER,ue=o.CONFIGURABLE,L=g.IteratorPrototype,re=g.BUGGY_SAFARI_ITERATORS,le=O("iterator"),oe=function(){return this};t.exports=function(he,Ie,ie,Ne,Ve,Ce,Ue){d(ie,Ie,Ne);var qe,Oe,$e,_e=function(xe){if(xe===Ve&&lr)return lr;if(!re&&xe in ar)return ar[xe];switch(xe){case"keys":case"values":case"entries":return function(){return new ie(this,xe)}}return function(){return new ie(this)}},er=Ie+" Iterator",Pt=!1,ar=he.prototype,pr=ar[le]||ar["@@iterator"]||Ve&&ar[Ve],lr=!re&&pr||_e(Ve),or=Ie=="Array"&&ar.entries||pr;if(or&&(qe=c(or.call(new he)))!==Object.prototype&&qe.next&&(i||c(qe)===L||(u?u(qe,L):a(qe[le])||S(qe,le,oe)),m(qe,er,!0,!0),i&&(k[er]=oe)),v&&Ve=="values"&&pr&&pr.name!=="values"&&(!i&&ue?y(ar,"name","values"):(Pt=!0,lr=function(){return s(pr,this)})),Ve)if(Oe={values:_e("values"),keys:Ce?lr:_e("keys"),entries:_e("entries")},Ue)for($e in Oe)(re||Pt||!($e in ar))&&S(ar,$e,Oe[$e]);else r({target:Ie,proto:!0,forced:re||Pt},Oe);return i&&!Ue||ar[le]===lr||S(ar,le,lr,{name:Ve}),k[Ie]=lr,Oe}},function(t,n){t.exports=function(e,r){return{value:e,done:r}}},function(t,n,e){var r=e(19),s=TypeError;t.exports=function(i,o){if(r(o,i))return i;throw s("Incorrect invocation")}},function(t,n,e){var r=e(132),s=e(81),i=TypeError;t.exports=function(o){if(r(o))return o;throw i(s(o)+" is not a constructor")}},function(t,n,e){var r=Object.prototype.hasOwnProperty,s="~";function i(){}function o(u,m,y){this.fn=u,this.context=m,this.once=y||!1}function a(u,m,y,S,O){if(typeof y!="function")throw new TypeError("The listener must be a function");var k=new o(y,S||u,O),g=s?s+m:m;return u._events[g]?u._events[g].fn?u._events[g]=[u._events[g],k]:u._events[g].push(k):(u._events[g]=k,u._eventsCount++),u}function d(u,m){--u._eventsCount==0?u._events=new i:delete u._events[m]}function c(){this._events=new i,this._eventsCount=0}Object.create&&(i.prototype=Object.create(null),new i().__proto__||(s=!1)),c.prototype.eventNames=function(){var u,m,y=[];if(this._eventsCount===0)return y;for(m in u=this._events)r.call(u,m)&&y.push(s?m.slice(1):m);return Object.getOwnPropertySymbols?y.concat(Object.getOwnPropertySymbols(u)):y},c.prototype.listeners=function(u){var m=s?s+u:u,y=this._events[m];if(!y)return[];if(y.fn)return[y.fn];for(var S=0,O=y.length,k=new Array(O);S<O;S++)k[S]=y[S].fn;return k},c.prototype.listenerCount=function(u){var m=s?s+u:u,y=this._events[m];return y?y.fn?1:y.length:0},c.prototype.emit=function(u,m,y,S,O,k){var g=s?s+u:u;if(!this._events[g])return!1;var v,ue,L=this._events[g],re=arguments.length;if(L.fn){switch(L.once&&this.removeListener(u,L.fn,void 0,!0),re){case 1:return L.fn.call(L.context),!0;case 2:return L.fn.call(L.context,m),!0;case 3:return L.fn.call(L.context,m,y),!0;case 4:return L.fn.call(L.context,m,y,S),!0;case 5:return L.fn.call(L.context,m,y,S,O),!0;case 6:return L.fn.call(L.context,m,y,S,O,k),!0}for(ue=1,v=new Array(re-1);ue<re;ue++)v[ue-1]=arguments[ue];L.fn.apply(L.context,v)}else{var le,oe=L.length;for(ue=0;ue<oe;ue++)switch(L[ue].once&&this.removeListener(u,L[ue].fn,void 0,!0),re){case 1:L[ue].fn.call(L[ue].context);break;case 2:L[ue].fn.call(L[ue].context,m);break;case 3:L[ue].fn.call(L[ue].context,m,y);break;case 4:L[ue].fn.call(L[ue].context,m,y,S);break;default:if(!v)for(le=1,v=new Array(re-1);le<re;le++)v[le-1]=arguments[le];L[ue].fn.apply(L[ue].context,v)}}return!0},c.prototype.on=function(u,m,y){return a(this,u,m,y,!1)},c.prototype.once=function(u,m,y){return a(this,u,m,y,!0)},c.prototype.removeListener=function(u,m,y,S){var O=s?s+u:u;if(!this._events[O])return this;if(!m)return d(this,O),this;var k=this._events[O];if(k.fn)k.fn!==m||S&&!k.once||y&&k.context!==y||d(this,O);else{for(var g=0,v=[],ue=k.length;g<ue;g++)(k[g].fn!==m||S&&!k[g].once||y&&k[g].context!==y)&&v.push(k[g]);v.length?this._events[O]=v.length===1?v[0]:v:d(this,O)}return this},c.prototype.removeAllListeners=function(u){var m;return u?(m=s?s+u:u,this._events[m]&&d(this,m)):(this._events=new i,this._eventsCount=0),this},c.prototype.off=c.prototype.removeListener,c.prototype.addListener=c.prototype.on,c.prefixed=s,c.EventEmitter=c,t.exports=c},function(t,n,e){var r=e(87)(e(56),"Map");t.exports=r},function(t,n,e){var r=e(56).Symbol;t.exports=r},function(t,n,e){var r=e(263),s=e(530),i=e(202);t.exports=function(o){return i(o)?r(o):s(o)}},function(t,n){var e=Array.isArray;t.exports=e},function(t,n){t.exports=function(e){return function(r){return e(r)}}},function(t,n,e){(function(r){var s=e(258),i=n&&!n.nodeType&&n,o=i&&typeof r=="object"&&r&&!r.nodeType&&r,a=o&&o.exports===i&&s.process,d=function(){try{var c=o&&o.require&&o.require("util").types;return c||a&&a.binding&&a.binding("util")}catch{}}();r.exports=d}).call(this,e(147)(t))},function(t,n){var e=Object.prototype;t.exports=function(r){var s=r&&r.constructor;return r===(typeof s=="function"&&s.prototype||e)}},function(t,n,e){var r=e(263),s=e(533),i=e(202);t.exports=function(o){return i(o)?r(o,!0):s(o)}},function(t,n,e){var r=e(538),s=e(267),i=Object.prototype.propertyIsEnumerable,o=Object.getOwnPropertySymbols,a=o?function(d){return d==null?[]:(d=Object(d),r(o(d),function(c){return i.call(d,c)}))}:s;t.exports=a},function(t,n,e){var r=e(542),s=e(174),i=e(543),o=e(272),a=e(544),d=e(124),c=e(259),u=c(r),m=c(s),y=c(i),S=c(o),O=c(a),k=d;(r&&k(new r(new ArrayBuffer(1)))!="[object DataView]"||s&&k(new s)!="[object Map]"||i&&k(i.resolve())!="[object Promise]"||o&&k(new o)!="[object Set]"||a&&k(new a)!="[object WeakMap]")&&(k=function(g){var v=d(g),ue=v=="[object Object]"?g.constructor:void 0,L=ue?c(ue):"";if(L)switch(L){case u:return"[object DataView]";case m:return"[object Map]";case y:return"[object Promise]";case S:return"[object Set]";case O:return"[object WeakMap]"}return v}),t.exports=k},function(t,n,e){var r=e(547);t.exports=function(s){var i=new s.constructor(s.byteLength);return new r(i).set(new r(s)),i}},function(t,n,e){var r=e(12),s=e(110),i=e(50),o=e(148),a=r("".replace),d="["+o+"]",c=RegExp("^"+d+d+"*"),u=RegExp(d+d+"*$"),m=function(y){return function(S){var O=i(s(S));return 1&y&&(O=a(O,c,"")),2&y&&(O=a(O,u,"")),O}};t.exports={start:m(1),end:m(2),trim:m(3)}},function(t,n,e){var r=e(118),s=e(583);r.json=s,t.exports=r},function(t,n,e){var r=e(18),s=e(24),i=e(7),o=e(2),a=e(62),d=a.f,c=e(575);function u(y){y.onload&&this.once("load",y.onload),y.onerror&&this.once("error",y.onerror),y.onbeforesend&&this.once("beforesend",y.onbeforesend),y.onaftersend&&this.once("aftersend",y.onaftersend);var S=(y=this.options=a.fetch({method:"GET",url:"",sync:!1,data:null,headers:{},cookie:!1,timeout:6e4,type:"text",form:null,input:null,putFileAtEnd:!1,proxyUrl:""},y)).headers;a.notexist(S["Content-Type"])&&(S["Content-Type"]="application/x-www-form-urlencoded"),this.send()}var m=u.prototype=r(c.prototype);m.send=function(){var y=this,S=y.options;s(function(){try{try{y.emit("beforesend",S)}catch{}y.doSend()}catch(O){y.onError("serverError","请求失败:"+O.message)}},0)},m.doSend=d,m.afterSend=function(){var y=this;s(function(){y.emit("aftersend",y.options)},0)},m.onLoad=function(y){var S,O=this.options,k=y.status,g=y.result;if(typeof k!="number"||k!==0)if(i(S=""+k).call(S,"2")===0){if(O.type==="json")try{g=JSON.parse(g)}catch{return void this.onError("parseError",g)}this.emit("load",g)}else this.onError("serverError","服务器返回异常状态",{status:k,result:g,date:y.date});else this.onError("netError","网络错误",{status:408})},m.onError=function(y,S,O){var k=a.isObject(O)?O:{};k.code=y||"error",k.message=S||"发生错误",this.emit("error",k)},m.onTimeout=function(){this.onError("timeout","请求超时",{status:408})},m.abort=function(){this.onError("abort","客户端中止",{status:415})},m.header=function(y){var S=this;if(!a.isArray(y))return S.getResponseHeader(y||"");var O={};return o(y).call(y,function(k){O[k]=S.header(k)}),O},m.getResponseHeader=d,m.destroy=d,t.exports=u},function(t,n,e){t.exports=e(600)},function(t,n,e){t.exports=e(613)},function(t,n,e){var r=e(191),s=e(151);function i(o,a){var d;return t.exports=i=r?s(d=r).call(d):function(c,u){return c.__proto__=u,c},t.exports.__esModule=!0,t.exports.default=t.exports,i(o,a)}t.exports=i,t.exports.__esModule=!0,t.exports.default=t.exports},function(t,n,e){t.exports=e(616)},function(t,n,e){var r=e(191),s=e(151),i=e(283);function o(a){var d;return t.exports=o=r?s(d=i).call(d):function(c){return c.__proto__||i(c)},t.exports.__esModule=!0,t.exports.default=t.exports,o(a)}t.exports=o,t.exports.__esModule=!0,t.exports.default=t.exports},function(t,n){var e={link:{id:1,heartbeat:2,negotiateTransport:5,initTransport:6},sync:{id:5,sync:1,syncTeamMembers:2},misc:{id:6,getSimpleNosToken:1,getNosToken:2,notifyUploadLog:3,uploadSdkLogUrl:4,audioToText:5,processImage:6,getNosTokenTrans:7,notifyTransLog:8,fetchFile:9,fetchFileList:10,removeFile:11,getClientAntispam:17,fileQuickTransfer:18,getNosOriginUrl:22,getServerTime:23,getNosAccessToken:24,deleteNosAccessToken:25,getNosCdnHost:26,getGrayscaleConfig:27,getMixStorePolicy:28,getMixStoreToken:29,getBackSourceToken:30,uploadDetect:32},avSignal:{id:15,signalingCreate:1,signalingDelay:2,signalingClose:3,signalingJoin:4,signalingLeave:5,signalingInvite:6,signalingCancel:7,signalingReject:8,signalingAccept:9,signalingControl:10,signalingNotify:11,signalingMutilClientSyncNotify:12,signalingUnreadMessageSyncNotify:13,signalingChannelsSyncNotify:14,signalingGetChannelInfo:15,signalingCallEx:16,signalingJoinAndAccept:17}},r={heartbeat:{sid:e.link.id,cid:e.link.heartbeat},negotiateTransport:{sid:e.link.id,cid:e.link.negotiateTransport,params:[{type:"int",name:"sdkVersion"},{type:"Property",name:"negotiateTransportTag"}]},initTransport:{sid:e.link.id,cid:e.link.initTransport,params:[{type:"Property",name:"initTransportTag"}]},getGrayscaleConfig:{sid:e.misc.id,cid:e.misc.getGrayscaleConfig,params:[{type:"Property",name:"providers"}]},getMixStorePolicy:{sid:e.misc.id,cid:e.misc.getMixStorePolicy,params:[{type:"LongArray",name:"providers"}]},getMixStoreToken:{sid:e.misc.id,cid:e.misc.getMixStoreToken,params:[{type:"Property",name:"mixTokenReq"}]},getBackSourceToken:{sid:e.misc.id,cid:e.misc.getBackSourceToken,params:[{type:"Property",name:"mixAuthTokenReq"}]},uploadDetect:{sid:e.misc.id,cid:e.misc.uploadDetect,isAwaitable:!1,params:[{type:"Property",name:"notifyDetectTag"}]},getSimpleNosToken:{sid:e.misc.id,cid:e.misc.getSimpleNosToken,params:[{type:"int",name:"num"}]},getNosToken:{sid:e.misc.id,cid:e.misc.getNosToken,params:[{type:"String",name:"responseBody"},{type:"Property",name:"nosToken",entity:"nosToken"}]},uploadSdkLogUrl:{sid:e.misc.id,cid:e.misc.uploadSdkLogUrl,params:[{type:"string",name:"url"}]},audioToText:{sid:e.misc.id,cid:e.misc.audioToText,params:[{type:"Property",name:"audioToText"}]},processImage:{sid:e.misc.id,cid:e.misc.processImage,params:[{type:"String",name:"url"},{type:"PropertyArray",name:"imageOps",entity:"imageOp"}]},getClientAntispam:{sid:e.misc.id,cid:e.misc.getClientAntispam,params:[{type:"Property",name:"clientAntispam"}]},fileQuickTransfer:{sid:e.misc.id,cid:e.misc.fileQuickTransfer,params:[{type:"Property",name:"fileQuickTransfer"}]},getNosOriginUrl:{sid:e.misc.id,cid:e.misc.getNosOriginUrl,params:[{type:"Property",name:"nosFileUrlTag"}]},getServerTime:{sid:e.misc.id,cid:e.misc.getServerTime,params:[]},getNosAccessToken:{sid:e.misc.id,cid:e.misc.getNosAccessToken,params:[{type:"Property",name:"nosAccessTokenTag"}]},deleteNosAccessToken:{sid:e.misc.id,cid:e.misc.deleteNosAccessToken,params:[{type:"Property",name:"nosAccessTokenTag"}]},getNosTokenTrans:{sid:e.misc.id,cid:e.misc.getNosTokenTrans,params:[{type:"Property",name:"transToken"}]},fetchFile:{sid:e.misc.id,cid:e.misc.fetchFile,params:[{type:"String",name:"docId"}]},fetchFileList:{sid:e.misc.id,cid:e.misc.fetchFileList,params:[{type:"Property",name:"fileListParam"}]},removeFile:{sid:e.misc.id,cid:e.misc.removeFile,params:[{type:"String",name:"docId"}]},getNosCdnHost:{sid:e.misc.id,cid:e.misc.getNosCdnHost,params:[]},signalingCreate:{sid:e.avSignal.id,cid:e.avSignal.signalingCreate,params:[{type:"Property",name:"avSignalTag"}]},signalingDelay:{sid:e.avSignal.id,cid:e.avSignal.signalingDelay,params:[{type:"Property",name:"avSignalTag"}]},signalingClose:{sid:e.avSignal.id,cid:e.avSignal.signalingClose,params:[{type:"Property",name:"avSignalTag"}]},signalingJoin:{sid:e.avSignal.id,cid:e.avSignal.signalingJoin,params:[{type:"Property",name:"avSignalTag"}]},signalingLeave:{sid:e.avSignal.id,cid:e.avSignal.signalingLeave,params:[{type:"Property",name:"avSignalTag"}]},signalingInvite:{sid:e.avSignal.id,cid:e.avSignal.signalingInvite,params:[{type:"Property",name:"avSignalTag"}]},signalingCancel:{sid:e.avSignal.id,cid:e.avSignal.signalingCancel,params:[{type:"Property",name:"avSignalTag"}]},signalingReject:{sid:e.avSignal.id,cid:e.avSignal.signalingReject,params:[{type:"Property",name:"avSignalTag"}]},signalingAccept:{sid:e.avSignal.id,cid:e.avSignal.signalingAccept,params:[{type:"Property",name:"avSignalTag"}]},signalingControl:{sid:e.avSignal.id,cid:e.avSignal.signalingControl,params:[{type:"Property",name:"avSignalTag"}]},signalingGetChannelInfo:{sid:e.avSignal.id,cid:e.avSignal.signalingGetChannelInfo,params:[{type:"Property",name:"avSignalTag"}]},signalingCallEx:{sid:e.avSignal.id,cid:e.avSignal.signalingCallEx,params:[{type:"Property",name:"avSignalTag"}]},signalingJoinAndAccept:{sid:e.avSignal.id,cid:e.avSignal.signalingJoinAndAccept,params:[{type:"Property",name:"avSignalTag"}]}};t.exports={idMap:e,cmdConfig:r,packetConfig:{"1_2":{service:"link",cmd:"heartbeat",response:[]},"1_5":{service:"link",cmd:"negotiateTransport",response:[{type:"Property",name:"negotiateTransportTag"}]},"1_6":{service:"link",cmd:"initTransport",response:[{type:"Property",name:"initTransportTag"}]},"6_1":{service:"misc",cmd:"getSimpleNosToken",response:[{type:"PropertyArray",name:"nosTokens",entity:"nosToken"}]},"6_2":{service:"misc",cmd:"getNosToken",response:[{type:"Property",name:"nosToken"}]},"6_3":{service:"misc",cmd:"notifyUploadLog"},"6_4":{service:"misc",cmd:"uploadSdkLogUrl"},"6_5":{service:"misc",cmd:"audioToText",response:[{type:"String",name:"text"}]},"6_6":{service:"misc",cmd:"processImage",response:[{type:"String",name:"url"}]},"6_7":{service:"misc",cmd:"getNosTokenTrans",response:[{type:"Property",name:"nosToken"},{type:"String",name:"docId"}]},"6_8":{service:"misc",cmd:"notifyTransLog",response:[{type:"Property",name:"transInfo"}]},"6_9":{service:"misc",cmd:"fetchFile",response:[{type:"Property",name:"info",entity:"transInfo"}]},"6_10":{service:"misc",cmd:"fetchFileList",response:[{type:"PropertyArray",name:"list",entity:"transInfo"},{type:"Number",name:"totalCount"}]},"6_11":{service:"misc",cmd:"removeFile",response:[{type:"String",name:"res"}]},"6_17":{service:"misc",cmd:"getClientAntispam",response:[{type:"Property",name:"clientAntispam"}]},"6_18":{service:"misc",cmd:"fileQuickTransfer",response:[{type:"Property",name:"fileQuickTransfer"}]},"6_22":{service:"misc",cmd:"getNosOriginUrl",response:[{type:"Property",name:"nosFileUrlTag"}]},"6_23":{service:"misc",cmd:"getServerTime",response:[{type:"Number",name:"time"}]},"6_24":{service:"misc",cmd:"getNosAccessToken",response:[{type:"Property",name:"nosAccessTokenTag"}]},"6_25":{service:"misc",cmd:"deleteNosAccessToken"},"6_26":{service:"misc",cmd:"getNosCdnHost",response:[{type:"Property",name:"nosConfigTag"}]},"6_27":{service:"misc",cmd:"getGrayscaleConfig",response:[{type:"Property",name:"appGrayConfigTag"}]},"6_28":{service:"misc",cmd:"getMixStorePolicy",response:[{type:"Property",name:"mixStorePolicyTag"}]},"6_29":{service:"misc",cmd:"getMixStoreToken",response:[{type:"Property",name:"mixStoreTokenTag"}]},"6_30":{service:"misc",cmd:"getBackSourceToken",response:[{type:"Property",name:"backSourceTokenTag"}]},"6_31":{service:"link",cmd:"notifyDetect",response:[{type:"Property",name:"notifyDetectTag"}]},"6_32":{service:"link",cmd:"uploadDetect",response:[]},"15_1":{service:"avSignal",cmd:"signalingCreate",response:[{type:"Property",name:"avSignalTag"}]},"15_2":{service:"avSignal",cmd:"signalingDelay",response:[{type:"Property",name:"avSignalTag"}]},"15_3":{service:"avSignal",cmd:"signalingClose",response:[{type:"Property",name:"avSignalTag"}]},"15_4":{service:"avSignal",cmd:"signalingJoin",response:[{type:"Property",name:"avSignalTag"}]},"15_5":{service:"avSignal",cmd:"signalingLeave",response:[]},"15_6":{service:"avSignal",cmd:"signalingInvite",response:[]},"15_7":{service:"avSignal",cmd:"signalingCancel",response:[]},"15_8":{service:"avSignal",cmd:"signalingReject",response:[]},"15_9":{service:"avSignal",cmd:"signalingAccept",response:[]},"15_10":{service:"avSignal",cmd:"signalingControl",response:[]},"15_11":{service:"avSignal",cmd:"signalingNotify",response:[{type:"Property",name:"avSignalTag"}]},"15_12":{service:"avSignal",cmd:"signalingMutilClientSyncNotify",response:[{type:"Property",name:"avSignalTag"}]},"15_13":{service:"avSignal",cmd:"signalingUnreadMessageSyncNotify",response:[{type:"PropertyArray",name:"avSignalTag"}]},"15_14":{service:"avSignal",cmd:"signalingChannelsSyncNotify",response:[{type:"PropertyArray",name:"avSignalTag"}]},"15_15":{service:"avSignal",cmd:"signalingGetChannelInfo",response:[{type:"Property",name:"avSignalTag"}]},"15_16":{service:"avSignal",cmd:"signalingCallEx",response:[{type:"Property",name:"avSignalTag"}]},"15_17":{service:"avSignal",cmd:"signalingJoinAndAccept",response:[{type:"Property",name:"avSignalTag"}]}}}},function(t,n,e){var r=e(4),s=e(2),i=e(26),o=e(0),a=o.notundef,d=o.fillPropertyWithDefault,c=r,u={},m={},y=[],S={},O={normal:0,advanced:1},k={0:"normal",1:"advanced"},g=c(O),v=u.joinMode={noVerify:0,needVerify:1,rejectAll:2};m.joinMode={0:"noVerify",1:"needVerify",2:"rejectAll"},y.push("join"),S.joinMode=c(v);var ue=u.beInviteMode={needVerify:0,noVerify:1};m.beInviteMode={0:"needVerify",1:"noVerify"},y.push("beInvite"),S.beInviteMode=c(ue);var L=u.inviteMode={manager:0,all:1};m.inviteMode={0:"manager",1:"all"},y.push("invite"),S.inviteMode=c(L);var re=u.updateTeamMode={manager:0,all:1};m.updateTeamMode={0:"manager",1:"all"},y.push("updateTeam"),S.updateTeamMode=c(re);var le=u.updateCustomMode={manager:0,all:1};function oe(Ie){var ie;switch(o.verifyOptions(Ie,"action","team::Team"),Ie.action){case"create":o.verifyOptions(Ie,"teamId",!1,"team::Team"),o.verifyOptions(Ie,"type name","team::Team"),o.verifyParamValid("type",Ie.type,g,"team::Team"),a(Ie.level)&&(o.verifyParamType("level",Ie.level,"number","team::Team"),this.level=Ie.level);break;case"update":o.verifyOptions(Ie,"teamId","team::Team"),o.verifyOptions(Ie,"type",!1,"team::Team")}a(Ie.teamId)&&(this.teamId=Ie.teamId),a(Ie.type)&&(this.type=O[Ie.type]),a(Ie.avatar)&&(this.avatar=""+Ie.avatar),a(Ie.name)&&(this.name=""+Ie.name),a(Ie.intro)&&(this.intro=""+Ie.intro),a(Ie.announcement)&&(this.announcement=""+Ie.announcement),s(y).call(y,i(ie=this.setMode).call(ie,this,Ie)),a(Ie.custom)&&(this.custom=""+Ie.custom)}function he(Ie,ie){a(Ie[ie+="Mode"])&&(Ie[ie]=m[ie][Ie[ie]])}m.updateCustomMode={0:"manager",1:"all"},y.push("updateCustom"),S.updateCustomMode=c(le),oe.prototype.setMode=function(Ie,ie){a(Ie[ie+="Mode"])&&(o.verifyParamValid(ie,Ie[ie],S[ie],"team::Team"),this[ie]=u[ie][Ie[ie]])},oe.reverse=function(Ie,ie){var Ne=o.copy(Ie);if(a(Ne.teamId)&&(Ne.teamId=""+Ne.teamId),a(Ne.type)&&(Ne.type=k[Ne.type]),a(Ne.level)&&(Ne.level=+Ne.level),a(Ne.valid)&&(Ne.valid=+Ne.valid==1),a(Ne.memberNum)&&(Ne.memberNum=+Ne.memberNum),a(Ne.memberUpdateTime)&&(Ne.memberUpdateTime=+Ne.memberUpdateTime),a(Ne.createTime)&&(Ne.createTime=+Ne.createTime),a(Ne.updateTime)&&(Ne.updateTime=+Ne.updateTime),a(Ne.validToCurrentUser)&&(Ne.validToCurrentUser=Ne.validToCurrentUser==="1"),a(Ne.mute)&&(Ne.mute=Ne.mute==="1"),a(Ne.muteType))switch(Ne.muteType){case"0":Ne.mute=!1,Ne.muteType="none";break;case"1":Ne.mute=!0,Ne.muteType="normal";break;case"3":Ne.mute=!0,Ne.muteType="all"}else a(Ne.mute)&&(Ne.mute===1?(Ne.mute=!0,Ne.muteType="normal"):(Ne.mute=!1,Ne.muteType="none"));return s(y).call(y,i(he).call(he,null,Ne)),delete Ne.bits,ie||oe.fillProperties(Ne),Ne},oe.fillProperties=function(Ie){var ie=d(Ie,"beInviteMode","needVerify"),Ne=d(Ie,"inviteMode","manager"),Ve=d(Ie,"updateTeamMode","manager"),Ce=d(Ie,"updateCustomMode","manager"),Ue=d(Ie,"avatar","");return ie||Ne||Ve||Ce||Ue},t.exports=oe},function(t,n,e){var r=e(45).clientTypeMap;function s(){}s.reverse=function(i){var o=i;return o.type=r[o.type],o},s.reverseType=function(i){return r[i]||i},t.exports=s},function(t,n,e){var r=e(22),s=e(121),i=e(7),o=e(11),a=e(64);function d(){if(!navigator||!navigator.userAgent)return!1;var m=[/Android/i,/webOS/i,/iPhone/i,/iPad/i,/iPod/i,/BlackBerry/i,/Windows Phone/i];return s(m).call(m,function(y){return navigator.userAgent.match(y)})}function c(){var m;return!(!navigator||!navigator.userAgent)&&(typeof navigator>"u"?"undefined":r(navigator))==="object"&&typeof navigator.userAgent=="string"&&i(m=navigator.userAgent).call(m,"Electron")>=0}function u(){return navigator&&navigator.userAgent}t.exports={getHostEnv:function(){return o.isBrowser?c()?"Electron":d()?"H5":u()?"BROWSER":"Unset":o.isRN?"RN":o.isWeixinApp?"Weixin":"Unset"},getHostEnvEnum:function(){return o.isBrowser?c()?5:d()?101:u()?100:0:o.isRN?2:o.isWeixinApp?6:0},getHostEnvVer:function(){if(!o.isBrowser)return"";if(!c())return a.version;try{return navigator.userAgent.match(/Electron\/([\d.]+\d+)/)[1]||a.version}catch{return a.version}},getLibEnv:function(){return"BROWSER"}}},function(t,n,e){var r=e(18),s=e(37),i=e(8),o=e(77),a=e(198),d=e(11),c=e(767),u=e(900),m=e(0),y=m.verifyOptions,S=m.verifyParamType,O=e(25).reportAPI,k=e(149).Chatroom,g=e(156);function v(L){var re=g(L);return this.subType="chatroom",this.nosScene=re.nosScene||"chatroom",this.nosSurvivalTime=re.nosSurvivalTime,re.Protocol=a,re.Message=u,re.constructor=v,re.isAnonymous&&(re.account=re.account||"nimanon_".concat(m.guid()),re.isAnonymous=1,m.verifyOptions(re,"chatroomNick","api::Chatroom"),re.chatroomAvatar=re.chatroomAvatar||" "),this.init(re)}v.Protocol=a,v.parser=k,v.use=o.use,v.getInstance=function(L){return L.isAnonymous&&(L.account=L.account||"nimanon_".concat(m.guid()),L.isAnonymous=1,m.verifyOptions(L,"chatroomNick","api::Chatroom.getInstance"),L.chatroomAvatar=L.chatroomAvatar||" "),o.getInstance.call(this,L)},v.genInstanceName=function(L){return m.verifyOptions(L,"chatroomId","api::Chatroom.genInstanceName"),"Chatroom-account-"+L.account+"-chatroomId-"+L.chatroomId};var ue=v.fn=v.prototype=r(o.prototype);v.info=ue.info=d.info,ue.getChatroom=function(L){(L=L||{}).done=O({instance:this,className:"ChatroomFn",funcName:"getChatroom",done:L.done}),this.processCallback(L),this.sendCmd("getChatroom",L)},ue.updateChatroom=function(L){(L=L||{}).done=O({instance:this,className:"ChatroomFn",funcName:"updateChatroom",done:L.done}),y(L,"chatroom needNotify","api::updateChatroom"),S("needNotify",L.needNotify,"boolean"),this.processCustom(L),this.processCallback(L),L.chatroom=new c(L.chatroom),L.antispamTag={antiSpamBusinessId:L.antiSpamBusinessId},this.sendCmd("updateChatroom",L)},ue.closeChatroom=function(L){(L=L||{}).done=O({instance:this,className:"ChatroomFn",funcName:"closeChatroom",done:L.done}),this.processCustom(L),this.processCallback(L),this.sendCmd("closeChatroom",L)},ue.updateTags=function(L){(L=L||{}).done=O({instance:this,className:"ChatroomFn",funcName:"updateTags",done:L.done}),m.validate({tags:{type:"array",required:!1},notifyTargetTags:{type:"string",allowEmpty:!0,required:!1},needNotify:{type:"boolean",required:!1}},L,"chatroom::updateTags");var re=s({},L);this.processCallback(re),re.tags&&(re.tags=i(re.tags)),re.needNotify&&(re.needNotify=re.needNotify?1:0),this.sendCmd("updateChatroomTags",{chatRoomTagsUpdateTag:re},re.done)},t.exports=v,e(910),e(911),e(912),e(913)},function(t,n,e){var r=e(18),s=e(26),i=e(9),o=e(10),a=e(78),d=e(0),c=d.undef,u=d.notundef,m=e(291),y=e(11),S=e(149),O=e(767),k=e(312);function g(L){var re,le,oe;d.verifyOptions(L,"appKey account chatroomId chatroomAddresses","protocol::ChatroomProtocol"),L.isAnonymous||d.verifyOptions(L,"token","protocol::ChatroomProtocol"),d.verifyParamType("chatroomAddresses",L.chatroomAddresses,"array","protocol::ChatroomProtocol"),d.verifyCallback(L,"onconnect onerror onwillreconnect ondisconnect onmsg onmsgs onrobots","protocol::ChatroomProtocol"),re=typeof d.get(L,"privateConf.isDataReportEnable")=="boolean"?L.privateConf.isDataReportEnable:y.privateConf.isDataReportEnable,le=typeof d.get(L,"privateConf.reportConfigUrl")=="string"?L.privateConf.reportConfigUrl:y.privateConf.reportConfigUrl,oe=typeof d.get(L,"privateConf.reportUrl")=="string"?L.privateConf.reportUrl:y.privateConf.reportUrl,this.reporter=m.initReporter({isDataReportEnable:re,reportConfigUrl:le,reportUrl:oe,appKey:L.appKey,logger:this.logger}),a.call(this,L)}var v=a.fn,ue=g.fn=g.prototype=r(v);ue.init=function(){var L;v.init.call(this),S.Chatroom.setProtocol(this),this.parser=S.Chatroom,s(L=this.sendCmd).call(L,this),this.syncResult={},this.timetags={},this.msgBuffer=[]},ue.reset=function(){var L=this;v.reset.call(L);var re,le=L.options;L.autoconnect=!!le.autoconnect,c(le.msgBufferInterval)&&(le.msgBufferInterval=300),d.verifyParamType("msgBufferInterval",le.msgBufferInterval,"number","protocol::ChatroomProtocol.reset"),c(le.msgBufferSize)&&(le.msgBufferSize=500),d.verifyParamType("msgBufferSize",le.msgBufferSize,"number","protocol::ChatroomProtocol.reset"),u(le.chatroomAddresses)&&(L.socketUrlsBackup=i(re=le.chatroomAddresses).call(re,function(oe){return y.formatSocketUrl({url:oe,secure:L.options.secure})}))},ue.processChatroom=function(L){switch(L.cmd){case"login":L.error||(L.obj={chatroom:o(O).call(O,L.content.chatroom),member:o(k).call(k,L.content.chatroomMember)},this.cdnInfo={},this.initCdnData(),clearTimeout(this.queryCdnTimer),this.onCdnMsgInfo(L.content.chatroomCdnInfo));break;case"kicked":this.onKicked(L);break;case"logout":break;case"sendMsg":this.onSendMsg(L);break;case"msg":this.onMsg(L),this.cdnInfo&&this.cdnInfo.enable&&this.correctCdnTime(+L.content.msg.time);break;case"getChatroomMembers":case"getChatroomMembersByTag":this.onChatroomMembers(L);break;case"getChatroomMemberCountByTag":this.onGetChatroomMemberCountByTag(L);break;case"getHistoryMsgs":case"getHistoryMsgsByTags":this.onHistoryMsgs(L);break;case"markChatroomMember":this.onMarkChatroomMember(L);break;case"closeChatroom":break;case"getChatroom":this.onChatroom(L);break;case"updateChatroom":break;case"updateMyChatroomMemberInfo":delete L.obj.chatroomMember;break;case"getChatroomMembersInfo":this.onChatroomMembersInfo(L);break;case"kickChatroomMember":case"updateChatroomMemberTempMute":break;case"queueList":L.error||(L.obj=L.content);break;case"syncRobot":this.onSyncRobot(L);break;case"notifyCdnInfo":this.onCdnMsgInfo(L.content&&L.content.chatroomCdnInfo);break;case"updateChatroomTag":this.onTagsUpdate(L.content)}},ue.onChatroom=function(L){L.error||(L.obj.chatroom=o(O).call(O,L.content.chatroom))},ue.onTagsUpdate=function(L){if(this.logger.info("onTagsUpdate:: ",L),this.options.onTagsUpdate&&typeof this.options.onTagsUpdate=="function"){var re=L.updateTags&&L.updateTags.currentTags;try{re=JSON.parse(re)}catch(le){this.logger.error("onTagsUpdate:: parse tags failed",le)}this.options.onTagsUpdate(re)}},t.exports=g,e(888),e(889),e(890),e(899)},function(t,n){t.exports=function(){}},function(t,n){t.exports=function(e,r){for(var s=r.split(".");s.length;){var i=s.shift(),o=!1;if(i[i.length-1]=="?"&&(i=i.slice(0,-1),o=!0),!(e=e[i])&&o)return e}return e}},function(t,n){t.exports=function(e,r){return e===r||e!=e&&r!=r}},function(t,n,e){var r=e(257),s=e(265);t.exports=function(i){return i!=null&&s(i.length)&&!r(i)}},function(t,n,e){var r=e(9),s=e(10),i=e(0),o=i.notundef,a=i.fillPropertyWithDefault,d={0:"normal",1:"owner",2:"manager"};function c(u){i.verifyOptions(u,"teamId","superTeam::TeamMember"),i.verifyParamAtLeastPresentOne(u,"nickInTeam muteTeam custom muteNotiType","superTeam::SuperTeamMember"),this.teamId=u.teamId,o(u.account)&&(this.account=u.account),o(u.nickInTeam)&&(this.nickInTeam=u.nickInTeam),o(u.muteNotiType)?this.bits=u.muteNotiType:o(u.muteTeam)&&(this.bits=0,u.muteTeam&&(this.bits+=1)),o(u.mute)&&(this.mute=u.mute?1:0),o(u.custom)&&(this.custom=""+u.custom)}c.reverse=function(u){var m=i.copy(u);if(o(m.teamId)&&(m.teamId=""+m.teamId),o(m.type)&&(m.type=d[m.type]),o(m.active)&&(m.active=+m.active==1),o(m.valid)&&(m.valid=+m.valid==1),o(m.mute)&&(m.mute=+m.mute==1),o(m.joinTime)&&(m.joinTime=+m.joinTime),o(m.updateTime)&&(m.updateTime=+m.updateTime),o(m.bits)){var y=m.bits;delete m.bits,m.muteTeam=!!(1&y),m.muteNotiType=y}return o(m.teamId)&&o(m.account)&&(m.id=c.genId(m.teamId,m.account)),o(m.followAccountIds)&&(m.followAccountIds=JSON.parse(m.followAccountIds)),m},c.reverseMembers=function(u){return r(u).call(u,function(m){return s(c).call(c,m)})},c.fillProperties=function(u){var m=a(u,"mute",!1),y=a(u,"custom","");return m||y},c.genId=function(u,m){return u+"-"+m},c.accounts2ids=function(u,m){return r(m).call(m,function(y){return c.genId(u,y)})},c.assembleMembers=function(u,m){return i.isArray(m)||(m=[m]),r(m).call(m,function(y){return c.assembleMember(u,y)})},c.assembleMember=function(u,m){return{id:c.genId(u.teamId,m),account:m,teamId:u.teamId,type:"normal",nickInTeam:"",muteTeam:!1,mute:!1,joinTime:u.memberUpdateTime,updateTime:u.memberUpdateTime,active:!0,valid:!0,followAccountIds:[]}},c.assembleOwner=function(u){var m=c.assembleMember(u,u.owner);return m.type="owner",m},t.exports=c},function(t,n,e){var r=e(9),s=e(10),i=e(4),o=e(108).genPrivateUrl,a=e(0),d={unknown:0,male:1,female:2},c={0:"unknown",1:"male",2:"female"};function u(m){a.merge(this,m),a.notundef(this.gender)&&(a.verifyParamValid("gender",this.gender,u.validGenders,"user::User"),this.gender=d[this.gender]),a.notundef(this.email)&&this.email!==""&&a.verifyEmail("email",this.email,"user::User"),a.notundef(this.birth)&&this.birth!==""&&a.verifyBirth("birth",this.birth,"user::User"),a.notundef(this.tel)&&this.tel!==""&&a.verifyTel("tel",this.tel,"user::User")}u.reverse=function(m,y,S){var O=a.filterObj(m,"account nick avatar _avatar_safe sign gender email birth tel custom createTime updateTime");return a.notundef(O.avatar)&&(O.avatar=o(O.avatar,y,S)),a.notundef(O.gender)&&(O.gender=c[O.gender]),a.notundef(O.createTime)&&(O.createTime=+O.createTime),a.notundef(O.updateTime)&&(O.updateTime=+O.updateTime),O},u.reverseUsers=function(m){return r(m).call(m,function(y){return s(u).call(u,y)})},u.validGenders=i(d),t.exports=u},function(t,n,e){var r=e(8),s=e(18),i=e(10),o=e(7),a=e(108).genPrivateUrl,d=e(76),c=e(0),u=e(11);function m(k,g){switch(c.notundef(k.type)?c.verifyFileType(k.type,"msg::FileMessage"):k.type="file",c.verifyOptions(k,"file","msg::FileMessage"),c.verifyOptions(k.file,"url ext size",!0,"file.","msg::FileMessage"),k.type){case"image":y.verifyFile(k.file,"msg::FileMessage");break;case"audio":S.verifyFile(k.file,"msg::FileMessage");break;case"video":O.verifyFile(k.file,"msg::FileMessage")}d.call(this,k),g&&(this.idClient=g),this.attach=r(k.file)}m.prototype=s(d.prototype),m.reverse=function(k){var g=i(d).call(d,k);if(k.attach=k.attach?""+k.attach:"",k.attach&&(g.file=JSON.parse(k.attach),!g.file.isS3)){var v,ue;g.file.url=a(g.file.url)||"",g.type==="audio"&&g.file.url&&!g.file.mp3Url&&(g.file.mp3Url=g.file.url+(~o(ue=g.file.url).call(ue,"?")?"&":"?")+"audioTrans&type=mp3"),u.httpsEnabled&&o(v=g.file.url).call(v,"https://")!==0&&(g.file.url=g.file.url.replace("http","https"))}return g},t.exports=m;var y=e(836),S=e(837),O=e(838)},function(t,n,e){var r=e(8),s=e(18),i=e(10),o=e(7),a=e(108).genPrivateUrl,d=e(119),c=e(0),u=e(11);function m(k,g){switch(c.notundef(k.type)?c.verifyFileType(k.type,"msg::FileMessage"):k.type="file",c.verifyOptions(k,"file","msg::FileMessage"),c.verifyOptions(k.file,"url ext size",!0,"file.","msg::FileMessage"),k.type){case"image":y.verifyFile(k.file,"msg::FileMessage");break;case"audio":S.verifyFile(k.file,"msg::FileMessage");break;case"video":O.verifyFile(k.file,"msg::FileMessage")}d.call(this,k),g&&(this.idClient=g),this.attach=r(k.file)}m.prototype=s(d.prototype),m.reverse=function(k){var g=i(d).call(d,k);if(k.attach=k.attach?""+k.attach:"",k.attach&&(g.file=JSON.parse(k.attach),!g.file.isS3)){var v,ue;g.file.url=a(g.file.url)||"",g.type==="audio"&&g.file.url&&!g.file.mp3Url&&(g.file.mp3Url=g.file.url+(~o(ue=g.file.url).call(ue,"?")?"&":"?")+"audioTrans&type=mp3"),u.httpsEnabled&&o(v=g.file.url).call(v,"https://")!==0&&(g.file.url=g.file.url.replace("http","https"))}return g},t.exports=m;var y=e(902),S=e(903),O=e(904)},function(t,n,e){var r=e(315);t.exports=r},function(t,n){var e=typeof document=="object"&&document.all,r=e===void 0&&e!==void 0;t.exports={all:e,IS_HTMLDDA:r}},function(t,n,e){var r=e(97);t.exports=r&&!Symbol.sham&&typeof Symbol.iterator=="symbol"},function(t,n,e){var r=e(27),s=e(5),i=e(162);t.exports=!r&&!s(function(){return Object.defineProperty(i("div"),"a",{get:function(){return 7}}).a!=7})},function(t,n,e){var r=e(5),s=e(17),i=/#|\.prototype\./,o=function(m,y){var S=d[a(m)];return S==u||S!=c&&(s(y)?r(y):!!y)},a=o.normalize=function(m){return String(m).replace(i,".").toLowerCase()},d=o.data={},c=o.NATIVE="N",u=o.POLYFILL="P";t.exports=o},function(t,n,e){var r=e(27),s=e(5);t.exports=r&&s(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!=42})},function(t,n,e){var r=e(1),s=e(5),i=e(83),o=e(28),a=e(42),d=e(46),c=e(214),u=e(99),m=e(164),y=e(113),S=e(21),O=e(98),k=S("isConcatSpreadable"),g=O>=51||!s(function(){var L=[];return L[k]=!1,L.concat()[0]!==L}),v=y("concat"),ue=function(L){if(!o(L))return!1;var re=L[k];return re!==void 0?!!re:i(L)};r({target:"Array",proto:!0,arity:1,forced:!g||!v},{concat:function(L){var re,le,oe,he,Ie,ie=a(this),Ne=m(ie,0),Ve=0;for(re=-1,oe=arguments.length;re<oe;re++)if(ue(Ie=re===-1?ie:arguments[re]))for(he=d(Ie),c(Ve+he),le=0;le<he;le++,Ve++)le in Ie&&u(Ne,Ve,Ie[le]);else c(Ve+1),u(Ne,Ve++,Ie);return Ne.length=Ve,Ne}})},function(t,n){var e=TypeError;t.exports=function(r){if(r>9007199254740991)throw e("Maximum allowed index exceeded");return r}},function(t,n,e){var r=e(12),s=e(17),i=e(161),o=r(Function.toString);s(i.inspectSource)||(i.inspectSource=function(a){return o(a)}),t.exports=i.inspectSource},function(t,n,e){var r=e(327);t.exports=r},function(t,n,e){var r=e(12),s=e(30),i=e(44),o=e(163).indexOf,a=e(114),d=r([].push);t.exports=function(c,u){var m,y=i(c),S=0,O=[];for(m in y)!s(a,m)&&s(y,m)&&d(O,m);for(;u.length>S;)s(y,m=u[S++])&&(~o(O,m)||d(O,m));return O}},function(t,n,e){var r=e(33);t.exports=r("document","documentElement")},function(t,n,e){var r=e(332);e(69),t.exports=r},function(t,n,e){e(333),e(336),e(337),e(224),e(338)},function(t,n,e){var r=e(131),s=e(46),i=e(99),o=Array,a=Math.max;t.exports=function(d,c,u){for(var m=s(d),y=r(c,m),S=r(u===void 0?m:u,m),O=o(a(S-y,0)),k=0;y<S;y++,k++)i(O,k,d[y]);return O.length=k,O}},function(t,n,e){var r=e(20),s=e(33),i=e(21),o=e(68);t.exports=function(){var a=s("Symbol"),d=a&&a.prototype,c=d&&d.valueOf,u=i("toPrimitive");d&&!d[u]&&o(d,u,function(m){return r(c,this)},{arity:1})}},function(t,n,e){var r=e(97);t.exports=r&&!!Symbol.for&&!!Symbol.keyFor},function(t,n,e){var r=e(1),s=e(33),i=e(79),o=e(20),a=e(12),d=e(5),c=e(83),u=e(17),m=e(28),y=e(129),S=e(102),O=e(97),k=s("JSON","stringify"),g=a(/./.exec),v=a("".charAt),ue=a("".charCodeAt),L=a("".replace),re=a(1 .toString),le=/[\uD800-\uDFFF]/g,oe=/^[\uD800-\uDBFF]$/,he=/^[\uDC00-\uDFFF]$/,Ie=!O||d(function(){var Ce=s("Symbol")();return k([Ce])!="[null]"||k({a:Ce})!="{}"||k(Object(Ce))!="{}"}),ie=d(function(){return k("\uDF06\uD834")!=='"\\udf06\\ud834"'||k("\uDEAD")!=='"\\udead"'}),Ne=function(Ce,Ue){var qe=S(arguments),Oe=Ue;if((m(Ue)||Ce!==void 0)&&!y(Ce))return c(Ue)||(Ue=function($e,_e){if(u(Oe)&&(_e=o(Oe,this,$e,_e)),!y(_e))return _e}),qe[1]=Ue,i(k,null,qe)},Ve=function(Ce,Ue,qe){var Oe=v(qe,Ue-1),$e=v(qe,Ue+1);return g(oe,Ce)&&!g(he,$e)||g(he,Ce)&&!g(oe,Oe)?"\\u"+re(ue(Ce,0),16):Ce};k&&r({target:"JSON",stat:!0,arity:3,forced:Ie||ie},{stringify:function(Ce,Ue,qe){var Oe=S(arguments),$e=i(Ie?Ne:k,null,Oe);return ie&&typeof $e=="string"?L($e,le,Ve):$e}})},function(t,n,e){e(23)("iterator")},function(t,n,e){var r=e(23),s=e(222);r("toPrimitive"),s()},function(t,n,e){var r=e(27),s=e(30),i=Function.prototype,o=r&&Object.getOwnPropertyDescriptor,a=s(i,"name"),d=a&&(function(){}).name==="something",c=a&&(!r||r&&o(i,"name").configurable);t.exports={EXISTS:a,PROPER:d,CONFIGURABLE:c}},function(t,n,e){var r,s,i,o=e(5),a=e(17),d=e(28),c=e(84),u=e(137),m=e(68),y=e(21),S=e(49),O=y("iterator"),k=!1;[].keys&&("next"in(i=[].keys())?(s=u(u(i)))!==Object.prototype&&(r=s):k=!0),!d(r)||o(function(){var g={};return r[O].call(g)!==g})?r={}:S&&(r=c(r)),a(r[O])||m(r,O,function(){return this}),t.exports={IteratorPrototype:r,BUGGY_SAFARI_ITERATORS:k}},function(t,n,e){var r=e(5);t.exports=!r(function(){function s(){}return s.prototype.constructor=null,Object.getPrototypeOf(new s)!==s.prototype})},function(t,n,e){e(69);var r=e(67),s=e(30),i=e(19),o=e(374),a=Array.prototype,d={DOMTokenList:!0,NodeList:!0};t.exports=function(c){var u=c.forEach;return c===a||i(a,c)&&u===a.forEach||s(d,r(c))?o:u}},function(t,n,e){var r=e(382);t.exports=r},function(t,n,e){var r=e(386);e(69),t.exports=r},function(t,n,e){e(387)},function(t,n,e){var r=e(33),s=e(12),i=e(134),o=e(135),a=e(36),d=s([].concat);t.exports=r("Reflect","ownKeys")||function(c){var u=i.f(a(c)),m=o.f;return m?d(u,m(c)):u}},function(t,n,e){var r=e(21),s=e(103),i=r("iterator"),o=Array.prototype;t.exports=function(a){return a!==void 0&&(s.Array===a||o[i]===a)}},function(t,n,e){var r=e(20),s=e(31),i=e(36),o=e(81),a=e(139),d=TypeError;t.exports=function(c,u){var m=arguments.length<2?a(c):u;if(s(m))return i(r(m,c));throw d(o(c)+" is not iterable")}},function(t,n,e){var r=e(20),s=e(36),i=e(160);t.exports=function(o,a,d){var c,u;s(o);try{if(!(c=i(o,"return"))){if(a==="throw")throw d;return d}c=r(c,o)}catch(m){u=!0,c=m}if(a==="throw")throw d;if(u)throw c;return s(c),d}},function(t,n,e){var r=e(33),s=e(39),i=e(21),o=e(27),a=i("species");t.exports=function(d){var c=r(d),u=s.f;o&&c&&!c[a]&&u(c,a,{configurable:!0,get:function(){return this}})}},function(t,n,e){var r=e(36),s=e(172),i=e(96),o=e(21)("species");t.exports=function(a,d){var c,u=r(a).constructor;return u===void 0||i(c=r(u)[o])?d:s(c)}},function(t,n,e){var r,s,i,o,a=e(14),d=e(79),c=e(34),u=e(17),m=e(30),y=e(5),S=e(218),O=e(102),k=e(162),g=e(241),v=e(242),ue=e(116),L=a.setImmediate,re=a.clearImmediate,le=a.process,oe=a.Dispatch,he=a.Function,Ie=a.MessageChannel,ie=a.String,Ne=0,Ve={};try{r=a.location}catch{}var Ce=function($e){if(m(Ve,$e)){var _e=Ve[$e];delete Ve[$e],_e()}},Ue=function($e){return function(){Ce($e)}},qe=function($e){Ce($e.data)},Oe=function($e){a.postMessage(ie($e),r.protocol+"//"+r.host)};L&&re||(L=function($e){g(arguments.length,1);var _e=u($e)?$e:he($e),er=O(arguments,1);return Ve[++Ne]=function(){d(_e,void 0,er)},s(Ne),Ne},re=function($e){delete Ve[$e]},ue?s=function($e){le.nextTick(Ue($e))}:oe&&oe.now?s=function($e){oe.now(Ue($e))}:Ie&&!v?(o=(i=new Ie).port2,i.port1.onmessage=qe,s=c(o.postMessage,o)):a.addEventListener&&u(a.postMessage)&&!a.importScripts&&r&&r.protocol!=="file:"&&!y(Oe)?(s=Oe,a.addEventListener("message",qe,!1)):s="onreadystatechange"in k("script")?function($e){S.appendChild(k("script")).onreadystatechange=function(){S.removeChild(this),Ce($e)}}:function($e){setTimeout(Ue($e),0)}),t.exports={set:L,clear:re}},function(t,n){var e=TypeError;t.exports=function(r,s){if(r<s)throw e("Not enough arguments");return r}},function(t,n,e){var r=e(66);t.exports=/(?:ipad|iphone|ipod).*applewebkit/i.test(r)},function(t,n){t.exports=typeof Deno=="object"&&Deno&&typeof Deno.version=="object"},function(t,n,e){var r=e(105),s=e(245),i=e(117).CONSTRUCTOR;t.exports=i||!s(function(o){r.all(o).then(void 0,function(){})})},function(t,n,e){var r=e(21)("iterator"),s=!1;try{var i=0,o={next:function(){return{done:!!i++}},return:function(){s=!0}};o[r]=function(){return this},Array.from(o,function(){throw 2})}catch{}t.exports=function(a,d){if(!d&&!s)return!1;var c=!1;try{var u={};u[r]=function(){return{next:function(){return{done:c=!0}}}},a(u)}catch{}return c}},function(t,n,e){var r=e(36),s=e(28),i=e(70);t.exports=function(o,a){if(r(o),s(a)&&a.constructor===o)return a;var d=i.f(o);return(0,d.resolve)(a),d.promise}},function(t,n,e){var r=e(1),s=e(20),i=e(31),o=e(70),a=e(104),d=e(47);r({target:"Promise",stat:!0},{allSettled:function(c){var u=this,m=o.f(u),y=m.resolve,S=m.reject,O=a(function(){var k=i(u.resolve),g=[],v=0,ue=1;d(c,function(L){var re=v++,le=!1;ue++,s(k,u,L).then(function(oe){le||(le=!0,g[re]={status:"fulfilled",value:oe},--ue||y(g))},function(oe){le||(le=!0,g[re]={status:"rejected",reason:oe},--ue||y(g))})}),--ue||y(g)});return O.error&&S(O.value),m.promise}})},function(t,n,e){var r=e(1),s=e(20),i=e(31),o=e(33),a=e(70),d=e(104),c=e(47);r({target:"Promise",stat:!0},{any:function(u){var m=this,y=o("AggregateError"),S=a.f(m),O=S.resolve,k=S.reject,g=d(function(){var v=i(m.resolve),ue=[],L=0,re=1,le=!1;c(u,function(oe){var he=L++,Ie=!1;re++,s(v,m,oe).then(function(ie){Ie||le||(le=!0,O(ie))},function(ie){Ie||le||(Ie=!0,ue[he]=ie,--re||k(new y(ue,"No one promise resolved")))})}),--re||k(new y(ue,"No one promise resolved"))});return g.error&&k(g.value),S.promise}})},function(t,n,e){var r=e(410);t.exports=r},function(t,n,e){var r=e(22).default,s=e(412);t.exports=function(i){var o=s(i,"string");return r(o)==="symbol"?o:String(o)},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,n,e){var r=e(420);t.exports=r},function(t,n,e){var r=e(81),s=TypeError;t.exports=function(i,o){if(!delete i[o])throw s("Cannot delete property "+r(o)+" of "+r(i))}},function(t,n,e){e(455),e(457)},function(t,n,e){var r,s=e(14),i=e(79),o=e(17),a=e(456),d=e(66),c=e(102),u=e(241),m=s.Function,y=/MSIE .\./.test(d)||a&&((r=s.Bun.version.split(".")).length<3||r[0]==0&&(r[1]<3||r[1]==3&&r[2]==0));t.exports=function(S,O){var k=O?2:1;return y?function(g,v){var ue=u(arguments.length,1)>k,L=o(g)?g:m(g),re=ue?c(arguments,k):[],le=ue?function(){i(L,this,re)}:L;return O?S(le,v):S(le)}:S}},function(t,n,e){var r=e(480);t.exports=r},function(t,n){t.exports=function e(r,s){var i,o,a=/(^([+\-]?(?:0|[1-9]\d*)(?:\.\d*)?(?:[eE][+\-]?\d+)?)?$|^0x[0-9a-f]+$|\d+)/gi,d=/(^[ ]*|[ ]*$)/g,c=/(^([\w ]+,?[\w ]+)?[\w ]+,?[\w ]+\d+:\d+(:\d+)?[\w ]?|^\d{1,4}[\/\-]\d{1,4}[\/\-]\d{1,4}|^\w+, \w+ \d+, \d{4})/,u=/^0x[0-9a-f]+$/i,m=/^0/,y=function(le){return e.insensitive&&(""+le).toLowerCase()||""+le},S=y(r).replace(d,"")||"",O=y(s).replace(d,"")||"",k=S.replace(a,"\0$1\0").replace(/\0$/,"").replace(/^\0/,"").split("\0"),g=O.replace(a,"\0$1\0").replace(/\0$/,"").replace(/^\0/,"").split("\0"),v=parseInt(S.match(u),16)||k.length!==1&&S.match(c)&&Date.parse(S),ue=parseInt(O.match(u),16)||v&&O.match(c)&&Date.parse(O)||null;if(ue){if(v<ue)return-1;if(v>ue)return 1}for(var L=0,re=Math.max(k.length,g.length);L<re;L++){if(i=!(k[L]||"").match(m)&&parseFloat(k[L])||k[L]||0,o=!(g[L]||"").match(m)&&parseFloat(g[L])||g[L]||0,isNaN(i)!==isNaN(o))return isNaN(i)?1:-1;if(typeof i!=typeof o&&(i+="",o+=""),i<o)return-1;if(i>o)return 1}return 0}},function(t,n,e){var r=e(124),s=e(91);t.exports=function(i){if(!s(i))return!1;var o=r(i);return o=="[object Function]"||o=="[object GeneratorFunction]"||o=="[object AsyncFunction]"||o=="[object Proxy]"}},function(t,n,e){(function(r){var s=typeof r=="object"&&r&&r.Object===Object&&r;t.exports=s}).call(this,e(73))},function(t,n){var e=Function.prototype.toString;t.exports=function(r){if(r!=null){try{return e.call(r)}catch{}try{return r+""}catch{}}return""}},function(t,n,e){var r=e(509),s=e(516),i=e(518),o=e(519),a=e(520);function d(c){var u=-1,m=c==null?0:c.length;for(this.clear();++u<m;){var y=c[u];this.set(y[0],y[1])}}d.prototype.clear=r,d.prototype.delete=s,d.prototype.get=i,d.prototype.has=o,d.prototype.set=a,t.exports=d},function(t,n,e){var r=e(262),s=e(201),i=Object.prototype.hasOwnProperty;t.exports=function(o,a,d){var c=o[a];i.call(o,a)&&s(c,d)&&(d!==void 0||a in o)||r(o,a,d)}},function(t,n,e){var r=e(522);t.exports=function(s,i,o){i=="__proto__"&&r?r(s,i,{configurable:!0,enumerable:!0,value:o,writable:!0}):s[i]=o}},function(t,n,e){var r=e(524),s=e(525),i=e(177),o=e(264),a=e(302),d=e(528),c=Object.prototype.hasOwnProperty;t.exports=function(u,m){var y=i(u),S=!y&&s(u),O=!y&&!S&&o(u),k=!y&&!S&&!O&&d(u),g=y||S||O||k,v=g?r(u.length,String):[],ue=v.length;for(var L in u)!m&&!c.call(u,L)||g&&(L=="length"||O&&(L=="offset"||L=="parent")||k&&(L=="buffer"||L=="byteLength"||L=="byteOffset")||a(L,ue))||v.push(L);return v}},function(t,n,e){(function(r){var s=e(56),i=e(527),o=n&&!n.nodeType&&n,a=o&&typeof r=="object"&&r&&!r.nodeType&&r,d=a&&a.exports===o?s.Buffer:void 0,c=(d?d.isBuffer:void 0)||i;r.exports=c}).call(this,e(147)(t))},function(t,n){t.exports=function(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=9007199254740991}},function(t,n){t.exports=function(e,r){return function(s){return e(r(s))}}},function(t,n){t.exports=function(){return[]}},function(t,n,e){var r=e(269),s=e(270),i=e(182),o=e(267),a=Object.getOwnPropertySymbols?function(d){for(var c=[];d;)r(c,i(d)),d=s(d);return c}:o;t.exports=a},function(t,n){t.exports=function(e,r){for(var s=-1,i=r.length,o=e.length;++s<i;)e[o+s]=r[s];return e}},function(t,n,e){var r=e(266)(Object.getPrototypeOf,Object);t.exports=r},function(t,n,e){var r=e(269),s=e(177);t.exports=function(i,o,a){var d=o(i);return s(i)?d:r(d,a(i))}},function(t,n,e){var r=e(87)(e(56),"Set");t.exports=r},function(t,n,e){var r=e(571);t.exports=r},function(t,n,e){var r=e(12),s=e(31),i=e(28),o=e(30),a=e(102),d=e(109),c=Function,u=r([].concat),m=r([].join),y={},S=function(O,k,g){if(!o(y,k)){for(var v=[],ue=0;ue<k;ue++)v[ue]="a["+ue+"]";y[k]=c("C,a","return new C("+m(v,",")+")")}return y[k](O,g)};t.exports=d?c.bind:function(O){var k=s(this),g=k.prototype,v=a(arguments,1),ue=function(){var L=u(v,a(arguments));return this instanceof ue?S(k,L.length,L):k.apply(O,L)};return i(g)&&(ue.prototype=g),ue}},function(t,n,e){var r=e(90),s=e(7),i=e(71),o=e(126),a=e(8),d=e(62),c=d.getGlobal(),u={},m=c.name||"_parent",y=[],S=[];u.addMsgListener=function(oe){y.push(oe)};var O,k,g,v,ue=(O=/^([\w]+?:\/\/.*?(?=\/|$))/i,function(oe){return oe=oe||"",O.test(oe)?RegExp.$1:"*"}),L=function(){var oe,he,Ie=r(oe=unescape(c.name||"")).call(oe);if(Ie&&s(Ie).call(Ie,"MSG|")===0){c.name="";var ie=d.string2object(Ie.replace("MSG|",""),"|"),Ne=(ie.origin||"").toLowerCase();Ne&&Ne!=="*"&&s(he=location.href.toLowerCase()).call(he,Ne)!==0||function(Ve){for(var Ce=0,Ue=y.length;Ce<Ue;Ce++)try{y[Ce].call(null,Ve)}catch{}}({data:JSON.parse(ie.data||"null"),source:c.frames[ie.self]||ie.self,origin:ue(ie.ref||(typeof document>"u"?"":document.referrer))})}},re=(g=function(oe,he){for(var Ie=0,ie=oe.length;Ie<ie;Ie++)if(oe[Ie]===he)return!0;return!1},function(){if(S.length){k=[];for(var oe,he=S.length-1;he>=0;he--)oe=S[he],g(k,oe.w)||(k.push(oe.w),i(S).call(S,he,1),oe.w.name=oe.d);k=null}}),le=u.startTimer=(v=!1,function(){v||(v=!0,c.postMessage||(o(re,100),o(L,20)))});u.postMessage=function(oe){var he=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(d.fillUndef(he,{origin:"*",source:m}),c.postMessage){var Ie=he.data;c.FormData||(Ie=a(Ie)),oe.postMessage(Ie,he.origin)}else{if(le(),d.isObject(he)){var ie={};ie.origin=he.origin||"",ie.ref=location.href,ie.self=he.source,ie.data=a(he.data),he="MSG|"+d.object2string(ie,"|",!0)}S.unshift({w:oe,d:escape(he)})}},t.exports=u},function(t,n,e){var r=e(593);t.exports=r},function(t,n,e){var r=e(0),s={file:{md5:"$(Etag)",size:"$(ObjectSize)"},image:{md5:"$(Etag)",size:"$(ObjectSize)",w:"$(ImageInfo.Width)",h:"$(ImageInfo.Height)",orientation:"$(ImageInfo.Orientation)"},audio:{md5:"$(Etag)",size:"$(ObjectSize)",dur:"$(AVinfo.Audio.Duration)"},video:{md5:"$(Etag)",size:"$(ObjectSize)",dur:"$(AVinfo.Video.Duration)",w:"$(AVinfo.Video.Width)",h:"$(AVinfo.Video.Height)"}},i={genResponseBody:function(o){return s[o=o||"file"]},parseResponse:function(o,a){r.notundef(o.size)&&(o.size=+o.size),r.notundef(o.w)&&(o.w=+o.w),r.notundef(o.h)&&(o.h=+o.h),r.notundef(o.dur)&&(o.dur=+o.dur);var d=o.orientation;if(r.notundef(d)&&(delete o.orientation,a&&(d==="right, top"||d==="left, bottom"))){var c=o.w;o.w=o.h,o.h=c}return o}};t.exports=i},function(t,n,e){var r=e(125),s=e(15),i=e(7),o=e(60),a=e(48),d=e(24),c=["Code","code","Message","message"],u=e(11),m=e(0),y=e(41),S=e(609),O=e(610),k=e(107),g=k.EMResourceUploadWay,v=k.EMExceptionState,ue=e(186).abort,L=m.supportFormData;function re(oe,he){var Ie=this,ie=oe.uploadprogress,Ne=oe.uploaddone,Ve=oe.beginupload;return{beginupload:typeof Ve=="function"?function(Ce){try{Ve(Ce,he)}catch(Ue){Ie.logger.error("Upload::options.beginupload execute error",Ue)}}:function(){},uploadprogress:typeof ie=="function"?function(Ce){Ie.reporterHook.emit("reporter/uploadUpdate",{transferred_size:Ce.loaded});try{ie(Ce,he)}catch(Ue){Ie.logger.error("Upload::options.uploadprogress execute error",Ue)}}:function(Ce){Ie.reporterHook.emit("reporter/uploadUpdate",{transferred_size:Ce.loaded})},uploaddone:function(Ce,Ue){Ce?Ie.reporterHook.emit("reporter/uploadEnd",Ce.code==="RequestAbortedError"||Ce.code==="abort"?v.kCanceled:v.kFailed):Ie.reporterHook.emit("reporter/uploadEnd",v.kSucceed);try{Ne(Ce,Ue,null,he)}catch(qe){Ie.logger.error("Upload::options.uploaddone execute error",qe)}}}}function le(oe,he,Ie){var ie=this;ie.options=m.copy(oe),oe=ie.options,m.verifyOptions(oe,"url fileName"),m.verifyParamPresentJustOne(oe,"blob fileInput"),m.verifyCallback(oe,"beginupload uploadprogress uploaddone"),ie.reporterHook=he.reporterHook,ie.logger=he.logger,ie.message=Ie;var Ne=re.call(this,oe,Ie),Ve=Ne.beginupload,Ce=Ne.uploadprogress,Ue=Ne.uploaddone;ie.options.beginupload=Ve,ie.options.uploadprogress=Ce,ie.options.uploaddone=Ue,oe.fileInput&&(oe.fileInput=m.verifyFileInput(oe.fileInput)),oe.type&&m.verifyFileType(oe.type),oe.timeout?m.verifyParamType("timeout",oe.timeout,"number"):oe.timeout=6e5,m.verifyFileUploadCallback(oe),oe.data={},oe.params&&m.merge(oe.data,oe.params);var qe,Oe,$e=oe.fileName,_e=oe.fileInput;if(L){if(_e){if(!(Oe=oe.type?m.filterFiles(_e.files,oe.type):s([]).call(_e.files,0))||!Oe.length)return void oe.uploaddone(y.newWrongFileTypeError("未读取到"+oe.type+"类型的文件, 请确保文件选择节点的文件不为空, 并且请确保选择了"+oe.type+"类型的文件"));oe.data[$e]=Oe[0],qe=_e.files[0].size}else if(oe.blob){var er;if(oe.data[$e]=oe.blob,oe.type!=="file"&&oe.blob.type&&i(er=oe.blob.type).call(er,oe.type)===-1)return void oe.uploaddone(y.newWrongFileTypeError("未读取到"+oe.type+"类型的文件, 请确保选择了"+oe.type+"类型的文件"));qe=oe.blob.size}if(ie.reporterHook.emit("reporter/uploadUpdate",{full_size:qe}),oe.maxSize&&qe>oe.maxSize)return void oe.uploaddone(y.newFileTooLargeError("上传文件大小超过".concat(oe.maxSize,"限制")))}function Pt(){if(ie.logger.info("Upload:enter aws upload"),qe){if(qe>u.chunkMaxSize)oe.uploaddone(y.newFileTooLargeError("直传文件大小超过".concat(u.commonMaxSize,"限制")));else if(oe.s3Policy&&oe.s3Policy.uploadConfig&&oe.s3Policy.uploadConfig.retryPolicy){var lr=oe.s3Policy.uploadConfig.retryPolicy,or={accessKeyId:oe.mixStoreToken.accessKeyId,secretAccessKey:oe.mixStoreToken.secretAccessKey,sessionToken:oe.mixStoreToken.sessionToken,region:oe.mixStoreToken.region,maxRetries:lr.retry},xe=new oe.s3;xe.config.update(or);var nr=ie.reporterHook.getNTPTime();xe.config.systemClockOffset=nr-o();var ir=decodeURIComponent(oe.mixStoreToken.bucket),dr=decodeURIComponent(oe.mixStoreToken.objectName),Lt=oe.data[$e],cr=xe.upload({Bucket:ir,Key:dr,Body:Lt,Metadata:{token:oe.mixStoreToken.token},ContentType:Lt.type||"application/octet-stream"});cr.on("httpUploadProgress",function(mr){var tr=Math.floor(1e4*mr.loaded/mr.total)/100,At={docId:oe.docId,total:mr.total,loaded:mr.loaded,percentage:tr,percentageText:tr+"%"};oe.fileInput&&(At.fileInput=oe.fileInput),oe.blob&&(At.blob=oe.blob),oe.uploadprogress(At)}),cr.send(function(mr,tr){if(oe.errorHook({bucket:ir,object:dr},{provider:"s3"}),oe.docId&&(tr.docId=oe.docId),mr&&mr.code==="RequestAbortedError")ie.logger.error("uploadFile:","api::s3:upload file abort",mr),ie.onError(mr);else if(mr){var At;oe.logger.error("error:","api::s3:upload file failed",mr);var kt=oe.providers[(i(At=oe.providers).call(At,oe.curProvider)+1)%oe.providers.length];lr.retryNext&&kt?(ie.addCircuitTimer(oe,kt),kt===1&&oe.getMixStoreToken(1,function(gr){oe.mixStoreToken=gr,ar()})):ie.onError(tr),oe.errorHook(mr,{provider:"s3"})}else{var Dt=ie.options.s3Policy.cdnSchema;Dt=(Dt=Dt.replace("{cdnDomain}",ie.options.s3Policy.dlcdn)).replace("{objectName}",tr.Key),oe.uploaddone(null,{size:Lt.size,name:Lt.name,url:Dt,ext:Lt.name&&Lt.name.split(".")[1]||"unknown",_url_safe:oe.mixStoreToken.shortUrl,isS3:!0}),oe.logger.info("s3 Upload done: fileObj is",{size:Lt.size,name:Lt.name,url:Dt,ext:Lt.name&&Lt.name.split(".")[1]||"unknown",_url_safe:oe.mixStoreToken.shortUrl,isS3:!0})}}),typeof oe.beginupload=="function"&&oe.beginupload(cr)}}else oe.uploaddone(y.newFileTooLargeError("Browser version is too low"))}function ar(){if(ie.logger.info("Upload:enter nos upload"),qe&&!oe.commonUpload)return ie.logger.info("Upload:use chunk upload, url ".concat(oe.url)),qe>u.chunkMaxSize?void oe.uploaddone(y.newFileTooLargeError("直传文件大小超过".concat(u.chunkMaxSize,"限制"))):void(ie.sn=O(oe,$e,ie,-1));if(ie.logger.info("Upload:use common upload, url ".concat(oe.url)),qe&&qe>u.commonMaxSize)oe.uploaddone(y.newFileTooLargeError("普通上传文件大小超过".concat(u.commonMaxSize,"限制")));else{qe||(m.dataset(_e,"name",$e),oe.data.input=_e);var lr=0,or={data:oe.data,onaftersend:function(){oe.beginupload(ie,ie.message)},onuploading:function(xe){if(lr!==100){var nr=Math.floor(1e4*xe.loaded/xe.total)/100;a(nr)>=100&&(lr=nr=100);var ir={docId:oe.docId,total:xe.total,loaded:xe.loaded,percentage:nr,percentageText:nr+"%"};oe.fileInput&&(ir.fileInput=oe.fileInput),oe.blob&&(ir.blob=oe.blob),oe.uploadprogress(ir)}},onload:function(xe){var nr;if(oe.docId&&(xe.docId=oe.docId),!xe.Error)return oe.uploaddone(null,xe),void oe.logger.info("nos Upload done: fileObj is",xe);if(oe.mixEnable&&oe.curProvider===1){var ir=oe.nosPolicy.uploadConfig.retryPolicy,dr=oe.providers[(i(nr=oe.providers).call(nr,oe.curProvider)+1)%oe.providers.length];ir.retryNext&&dr?(ie.addCircuitTimer(oe,dr),dr===2&&oe.getMixStoreToken(2,function(Lt){oe.mixStoreToken=Lt,Pt()})):ie.onError(xe)}else ie.onError(xe)},onerror:function(xe){var nr;if(oe.mixEnable&&oe.curProvider===1){var ir,dr=oe.nosPolicy.uploadConfig.retryPolicy,Lt=oe.providers[(i(ir=oe.providers).call(ir,oe.curProvider)+1)%oe.providers.length];if(dr.retryNext&&Lt)ie.addCircuitTimer(oe,Lt),Lt===2&&oe.getMixStoreToken(2,function(cr){oe.mixStoreToken=cr,Pt()});else try{nr=xe.result?JSON.parse(xe.result):xe,ie.onError(nr)}catch{oe.uploaddone(new y(xe.message,xe.code),ie.options)}}else try{nr=xe.result?JSON.parse(xe.result):xe,ie.onError(nr)}catch{oe.uploaddone(new y(xe.message,xe.code),ie.options)}oe.errorHook(xe,{provider:"nos"})}};L||(or.mode="iframe"),or.putFileAtEnd=!0,ie.sn=S(oe.url,or)}}if(oe.mixEnable&&oe.curProvider===2){var pr=ie.options.s3Policy.cdnSchema;pr=pr.replace("{cdnDomain}",ie.options.s3Policy.dlcdn),ie.reporterHook.emit("reporter/uploadUpdate",{remote_addr:pr,operation_type:g.kResourceUploadWayAWSPlugin}),Pt()}else oe.mixEnable&&oe.curProvider===1?(ie.reporterHook.emit("reporter/uploadUpdate",{remote_addr:oe.url,operation_type:g.kResourceUploadWayNOSPlugin}),ar()):(ie.reporterHook.emit("reporter/uploadUpdate",{remote_addr:oe.url,operation_type:g.kResourceUploadWayNOS}),ar())}le.prototype.addCircuitTimer=function(oe,he){var Ie=this;if(oe.curProvider=he,oe.s3Policy&&oe.nosPolicy){var ie=oe[oe.curProvider===1?"nosPolicy":"s3Policy"].uploadConfig.retryPolicy.circuit;if(!ie||ie===0)return;Ie.circuitTimer&&clearTimeout(Ie.circuitTimer),Ie.circuitTimer=d(function(){oe.curProvider=oe.providers[0],Ie.circuitTimer=void 0},1e3*ie)}},le.prototype.onError=function(){var oe=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},he=this,Ie=he.options,ie=oe.Error||oe||{},Ne=ie.Code,Ve=ie.code,Ce=ie.Message,Ue=ie.message,qe=r(ie,c),Oe=Ne||Ve||"unknown",$e=Ce||Ue||"未知错误";Ie.uploaddone(new y(Oe+"("+$e+")",Oe,qe))},le.prototype.abort=function(){ue(this.sn)},t.exports=le},function(t,n,e){t.exports=e(280)},function(t,n,e){var r=e(611);t.exports=r},function(t,n,e){var r=e(189),s=e(140),i=e(190);t.exports=function(o,a){if(typeof a!="function"&&a!==null)throw new TypeError("Super expression must either be null or a function");o.prototype=r(a&&a.prototype,{constructor:{value:o,writable:!0,configurable:!0}}),s(o,"prototype",{writable:!1}),a&&i(o,a)},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,n,e){var r=e(22).default,s=e(625);t.exports=function(i,o){if(o&&(r(o)==="object"||typeof o=="function"))return o;if(o!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return s(i)},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,n,e){t.exports=e(626)},function(t,n,e){var r=e(629);t.exports=r},function(t,n,e){var r=e(7),s=e(0),i={fromDataURL:function(o){var a,d,c=s.getGlobal();d=r(a=o.split(",")[0]).call(a,"base64")>=0?c.atob(o.split(",")[1]):c.decodeURIComponent(o.split(",")[1]);for(var u=o.split(",")[0].split(":")[1].split(";")[0],m=new Uint8Array(d.length),y=0;y<d.length;y++)m[y]=d.charCodeAt(y);return new c.Blob([m],{type:u})}};t.exports=i},function(t,n,e){var r=e(4),s=e(9),i=e(10),o=e(0),a={stripmeta:0,blur:2,quality:3,crop:4,rotate:5,thumbnail:7,interlace:9},d={0:"stripmeta",1:"type",2:"blur",3:"quality",4:"crop",5:"rotate",6:"pixel",7:"thumbnail",8:"watermark",9:"interlace",10:"tmp"};function c(u){o.verifyOptions(u,"type","image::ImageOp"),o.verifyParamValid("type",u.type,c.validTypes,"image::ImageOp"),o.merge(this,u),this.type=a[u.type]}c.validTypes=r(a),c.reverse=function(u){var m=o.copy(u);return m.type=d[m.type],m},c.reverseImageOps=function(u){return s(u).call(u,function(m){return i(c).call(c,m)})},t.exports=c},function(t,n,e){var r=e(2),s=e(4),i={1:"ROOM_CLOSE",2:"ROOM_JOIN",3:"INVITE",4:"CANCEL_INVITE",5:"REJECT",6:"ACCEPT",7:"LEAVE",8:"CONTROL"},o={1:"accid",2:"uid",3:"createTime",4:"expireTime",5:"web_uid"},a={10404:"ROOM_NOT_EXISTS",10405:"ROOM_HAS_EXISTS",10406:"ROOM_MEMBER_NOT_EXISTS",10407:"ROOM_MEMBER_HAS_EXISTS",10408:"INVITE_NOT_EXISTS",10409:"INVITE_HAS_REJECT",10410:"INVITE_HAS_ACCEPT",10201:"PEER_NIM_OFFLINE",10202:"PEER_PUSH_OFFLINE",10419:"ROOM_MEMBER_EXCEED",10420:"ROOM_MEMBER_HAS_EXISTS_OTHER_CLIENT",10417:"UID_CONFLICT"};t.exports={parseAvSignalType:function(d){return i[d]||d},parseAvSignalMember:function(d){var c,u={};return r(c=s(d)).call(c,function(m){u[o[m]]=d[m]}),u},parseAvSignalError:function(d){return d.message=a[d.code]||d.message||d,d}}},function(t,n,e){t.exports=e(655)},function(module,exports,__webpack_require__){(function(global,module){var __WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;/*! Socket.IO.js build:0.9.11, development. Copyright(c) 2011 LearnBoost <dev@learnboost.com> MIT Licensed */function getGlobal(){return typeof window<"u"?window:typeof self<"u"?self:global!==void 0?global:{}}var root=getGlobal(),io=module.exports;root.location===void 0&&(root.location=null),root.io?module&&(module.exports=io=root.io):root.io=io,function(){(function(t,n){var e=t;e.version="0.9.11",e.protocol=1,e.transports=[],e.j=[],e.sockets={},e.connect=function(r,s){var i,o,a=e.util.parseUri(r);n&&n.location&&(a.protocol=a.protocol||n.location.protocol.slice(0,-1),a.host=a.host||(n.document?n.document.domain:n.location.hostname),a.port=a.port||n.location.port),i=e.util.uniqueUri(a);var d={host:a.ipv6uri?"["+a.host+"]":a.host,secure:a.protocol==="https",port:a.port||(a.protocol==="https"?443:80),query:a.query||""};return e.util.merge(d,s),!d["force new connection"]&&e.sockets[i]||(o=new e.Socket(d)),!d["force new connection"]&&o&&(e.sockets[i]=o),(o=o||e.sockets[i]).of(a.path.length>1?a.path:"")}})(module.exports,root),function(t,n){var e=t.util={},r=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,s=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];e.parseUri=function(o){var a=o,d=o.indexOf("["),c=o.indexOf("]");d!=-1&&c!=-1&&(o=o.substring(0,d)+o.substring(d,c).replace(/:/g,";")+o.substring(c,o.length));for(var u=r.exec(o||""),m={},y=14;y--;)m[s[y]]=u[y]||"";return d!=-1&&c!=-1&&(m.source=a,m.host=m.host.substring(1,m.host.length-1).replace(/;/g,":"),m.authority=m.authority.replace("[","").replace("]","").replace(/;/g,":"),m.ipv6uri=!0),m},e.uniqueUri=function(o){var a=o.protocol,d=o.host,c=o.port;return"document"in n&&n.document?(d=d||document.domain,c=c||(a=="https"&&document.location.protocol!=="https:"?443:document.location.port)):(d=d||"localhost",c||a!="https"||(c=443)),(a||"http")+"://"+d+":"+(c||80)},e.query=function(o,a){var d=e.chunkQuery(o||""),c=[];for(var u in e.merge(d,e.chunkQuery(a||"")),d)d.hasOwnProperty(u)&&c.push(u+"="+d[u]);return c.length?"?"+c.join("&"):""},e.chunkQuery=function(o){for(var a,d={},c=o.split("&"),u=0,m=c.length;u<m;++u)(a=c[u].split("="))[0]&&(d[a[0]]=a[1]);return d};var i=!1;e.load=function(o){if(typeof document<"u"&&document&&document.readyState==="complete"||i)return o();e.on(n,"load",o,!1)},e.on=function(o,a,d,c){o.attachEvent?o.attachEvent("on"+a,d):o.addEventListener&&o.addEventListener(a,d,c)},e.request=function(o){if(o&&typeof XDomainRequest<"u"&&!e.ua.hasCORS)return new XDomainRequest;if(typeof XMLHttpRequest<"u"&&(!o||e.ua.hasCORS))return new XMLHttpRequest;if(!o)try{return new root[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch{}return null},root!==void 0&&e.load(function(){i=!0}),e.defer=function(o){if(!e.ua.webkit||typeof importScripts<"u")return o();e.load(function(){setTimeout(o,100)})},e.merge=function(o,a,d,c){var u,m=c||[],y=d===void 0?2:d;for(u in a)a.hasOwnProperty(u)&&e.indexOf(m,u)<0&&(typeof o[u]=="object"&&y?e.merge(o[u],a[u],y-1,m):(o[u]=a[u],m.push(a[u])));return o},e.mixin=function(o,a){e.merge(o.prototype,a.prototype)},e.inherit=function(o,a){function d(){}d.prototype=a.prototype,o.prototype=new d},e.isArray=Array.isArray||function(o){return Object.prototype.toString.call(o)==="[object Array]"},e.intersect=function(o,a){for(var d=[],c=o.length>a.length?o:a,u=o.length>a.length?a:o,m=0,y=u.length;m<y;m++)~e.indexOf(c,u[m])&&d.push(u[m]);return d},e.indexOf=function(o,a,d){var c=o.length;for(d=d<0?d+c<0?0:d+c:d||0;d<c&&o[d]!==a;d++);return c<=d?-1:d},e.toArray=function(o){for(var a=[],d=0,c=o.length;d<c;d++)a.push(o[d]);return a},e.ua={},e.ua.hasCORS=typeof XMLHttpRequest<"u"&&function(){try{var o=new XMLHttpRequest}catch{return!1}return o.withCredentials!=null}(),e.ua.webkit=typeof navigator<"u"&&/webkit/i.test(navigator.userAgent),e.ua.iDevice=typeof navigator<"u"&&/iPad|iPhone|iPod/i.test(navigator.userAgent)}(io!==void 0?io:module.exports,root),function(t,n){function e(){}t.EventEmitter=e,e.prototype.on=function(r,s){return this.$events||(this.$events={}),this.$events[r]?n.util.isArray(this.$events[r])?this.$events[r].push(s):this.$events[r]=[this.$events[r],s]:this.$events[r]=s,this},e.prototype.addListener=e.prototype.on,e.prototype.once=function(r,s){var i=this;function o(){i.removeListener(r,o),s.apply(this,arguments)}return o.listener=s,this.on(r,o),this},e.prototype.removeListener=function(r,s){if(this.$events&&this.$events[r]){var i=this.$events[r];if(n.util.isArray(i)){for(var o=-1,a=0,d=i.length;a<d;a++)if(i[a]===s||i[a].listener&&i[a].listener===s){o=a;break}if(o<0)return this;i.splice(o,1),i.length||delete this.$events[r]}else(i===s||i.listener&&i.listener===s)&&delete this.$events[r]}return this},e.prototype.removeAllListeners=function(r){return r===void 0?(this.$events={},this):(this.$events&&this.$events[r]&&(this.$events[r]=null),this)},e.prototype.removeAllListenersX=function(r){if(r===void 0)return this.$events={},this;for(let s in this.$events)s!==r&&(this.$events[s]=null);return this},e.prototype.listeners=function(r){return this.$events||(this.$events={}),this.$events[r]||(this.$events[r]=[]),n.util.isArray(this.$events[r])||(this.$events[r]=[this.$events[r]]),this.$events[r]},e.prototype.emit=function(r){if(!this.$events)return!1;var s=this.$events[r];if(!s)return!1;var i=Array.prototype.slice.call(arguments,1);if(typeof s=="function")s.apply(this,i);else{if(!n.util.isArray(s))return!1;for(var o=s.slice(),a=0,d=o.length;a<d;a++)o[a].apply(this,i)}return!0}}(io!==void 0?io:module.exports,io!==void 0?io:module.parent.exports),function(exports,nativeJSON){if(nativeJSON&&nativeJSON.parse)return exports.JSON={parse:nativeJSON.parse,stringify:nativeJSON.stringify};var JSON=exports.JSON={};function f(t){return t<10?"0"+t:t}function date(t,n){return isFinite(t.valueOf())?t.getUTCFullYear()+"-"+f(t.getUTCMonth()+1)+"-"+f(t.getUTCDate())+"T"+f(t.getUTCHours())+":"+f(t.getUTCMinutes())+":"+f(t.getUTCSeconds())+"Z":null}var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;function quote(t){return escapable.lastIndex=0,escapable.test(t)?'"'+t.replace(escapable,function(n){var e=meta[n];return typeof e=="string"?e:"\\u"+("0000"+n.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+t+'"'}function str(t,n){var e,r,s,i,o,a=gap,d=n[t];switch(d instanceof Date&&(d=date(t)),typeof rep=="function"&&(d=rep.call(n,t,d)),typeof d){case"string":return quote(d);case"number":return isFinite(d)?String(d):"null";case"boolean":case"null":return String(d);case"object":if(!d)return"null";if(gap+=indent,o=[],Object.prototype.toString.apply(d)==="[object Array]"){for(i=d.length,e=0;e<i;e+=1)o[e]=str(e,d)||"null";return s=o.length===0?"[]":gap?`[
`+gap+o.join(`,
`+gap)+`
`+a+"]":"["+o.join(",")+"]",gap=a,s}if(rep&&typeof rep=="object")for(i=rep.length,e=0;e<i;e+=1)typeof rep[e]=="string"&&(s=str(r=rep[e],d))&&o.push(quote(r)+(gap?": ":":")+s);else for(r in d)Object.prototype.hasOwnProperty.call(d,r)&&(s=str(r,d))&&o.push(quote(r)+(gap?": ":":")+s);return s=o.length===0?"{}":gap?`{
`+gap+o.join(`,
`+gap)+`
`+a+"}":"{"+o.join(",")+"}",gap=a,s}}JSON.stringify=function(t,n,e){var r;if(gap="",indent="",typeof e=="number")for(r=0;r<e;r+=1)indent+=" ";else typeof e=="string"&&(indent=e);if(rep=n,n&&typeof n!="function"&&(typeof n!="object"||typeof n.length!="number"))throw new Error("socket.io:: replacer cannot JSON.stringify");return str("",{"":t})},JSON.parse=function(text,reviver){var j;function walk(t,n){var e,r,s=t[n];if(s&&typeof s=="object")for(e in s)Object.prototype.hasOwnProperty.call(s,e)&&((r=walk(s,e))!==void 0?s[e]=r:delete s[e]);return reviver.call(t,n,s)}if(text=String(text),cx.lastIndex=0,cx.test(text)&&(text=text.replace(cx,function(t){return"\\u"+("0000"+t.charCodeAt(0).toString(16)).slice(-4)})),/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return j=eval("("+text+")"),typeof reviver=="function"?walk({"":j},""):j;throw new SyntaxError("socket.io:: reviver cannot JSON.parse")}}(io!==void 0?io:module.exports,typeof JSON<"u"?JSON:void 0),function(t,n){var e=t.parser={},r=e.packets=["disconnect","connect","heartbeat","message","json","event","ack","error","noop"],s=e.reasons=["transport not supported","client not handshaken","unauthorized"],i=e.advice=["reconnect"],o=n.JSON,a=n.util.indexOf;e.encodePacket=function(c){var u=a(r,c.type),m=c.id||"",y=c.endpoint||"",S=c.ack,O=null;switch(c.type){case"error":var k=c.reason?a(s,c.reason):"",g=c.advice?a(i,c.advice):"";k===""&&g===""||(O=k+(g!==""?"+"+g:""));break;case"message":c.data!==""&&(O=c.data);break;case"event":var v={name:c.name};c.args&&c.args.length&&(v.args=c.args),O=o.stringify(v);break;case"json":O=o.stringify(c.data);break;case"connect":c.qs&&(O=c.qs);break;case"ack":O=c.ackId+(c.args&&c.args.length?"+"+o.stringify(c.args):"")}var ue=[u,m+(S=="data"?"+":""),y];return O!=null&&ue.push(O),ue.join(":")},e.encodePayload=function(c){var u="";if(c.length==1)return c[0];for(var m=0,y=c.length;m<y;m++)u+="�"+c[m].length+"�"+c[m];return u};var d=/([^:]+):([0-9]+)?(\+)?:([^:]+)?:?([\s\S]*)?/;e.decodePacket=function(c){if(!(y=c.match(d)))return{};var u=y[2]||"",m=(c=y[5]||"",{type:r[y[1]],endpoint:y[4]||""});switch(u&&(m.id=u,y[3]?m.ack="data":m.ack=!0),m.type){case"error":var y=c.split("+");m.reason=s[y[0]]||"",m.advice=i[y[1]]||"";break;case"message":m.data=c||"";break;case"event":try{var S=o.parse(c);m.name=S.name,m.args=S.args}catch{}m.args=m.args||[];break;case"json":try{m.data=o.parse(c)}catch{}break;case"connect":m.qs=c||"";break;case"ack":if((y=c.match(/^([0-9]+)(\+)?(.*)/))&&(m.ackId=y[1],m.args=[],y[3]))try{m.args=y[3]?o.parse(y[3]):[]}catch{}}return m},e.decodePayload=function(c){var u=function(g,v){for(var ue=0,L=g;L<v.length;L++){if(v.charAt(L)=="�")return ue;ue++}return ue};if(c.charAt(0)=="�"){for(var m=[],y=1,S="";y<c.length;y++)if(c.charAt(y)=="�"){var O=c.substr(y+1).substr(0,S);if(c.charAt(y+1+Number(S))!="�"&&y+1+Number(S)!=c.length){var k=Number(S);l=u(y+k+1,c),O=c.substr(y+1).substr(0,k+l),y+=l}m.push(e.decodePacket(O)),y+=Number(S)+1,S=""}else S+=c.charAt(y);return m}return[e.decodePacket(c)]}}(io!==void 0?io:module.exports,io!==void 0?io:module.parent.exports),function(t,n){function e(r,s){this.socket=r,this.sessid=s}t.Transport=e,n.util.mixin(e,n.EventEmitter),e.prototype.heartbeats=function(){return!0},e.prototype.onData=function(r){if(this!==this.socket.transport)return this;if(this.clearCloseTimeout(),(this.socket.connected||this.socket.connecting||this.socket.reconnecting)&&this.setCloseTimeout(),r!==""){var s=n.parser.decodePayload(r);if(s&&s.length)for(var i=0,o=s.length;i<o;i++)this.onPacket(s[i])}return this},e.prototype.onPacket=function(r){return this.socket.setHeartbeatTimeout(),r.type=="heartbeat"?this.onHeartbeat():(r.type=="connect"&&r.endpoint==""&&this.onConnect(),r.type=="error"&&r.advice=="reconnect"&&(this.isOpen=!1),this.socket.onPacket(r),this)},e.prototype.setCloseTimeout=function(){if(!this.closeTimeout){var r=this;this.closeTimeout=setTimeout(function(){r.socket&&r.socket.publish("info","socket disconnected by setCloseTimeout"),r.onDisconnect()},this.socket.closeTimeout)}},e.prototype.onDisconnect=function(){return this.isOpen&&this.close(),this.clearTimeouts(),this.socket?(this.socket.transport===this?this.socket.onDisconnect():this.socket.setBuffer(!1),this):this},e.prototype.onConnect=function(){return this.socket.onConnect(),this},e.prototype.clearCloseTimeout=function(){this.closeTimeout&&(clearTimeout(this.closeTimeout),this.closeTimeout=null)},e.prototype.clearTimeouts=function(){this.clearCloseTimeout(),this.reopenTimeout&&clearTimeout(this.reopenTimeout)},e.prototype.packet=function(r){this.send(n.parser.encodePacket(r))},e.prototype.onHeartbeat=function(r){this.packet({type:"heartbeat"})},e.prototype.onOpen=function(){this.isOpen=!0,this.clearCloseTimeout(),this.socket.onOpen()},e.prototype.onClose=function(){this.socket.publish("info","transport onClose"),this.isOpen=!1,this.socket.transport===this?this.socket.onClose():this.socket.setBuffer(!1),this.onDisconnect(),this.onDisconnectDone instanceof Function&&this.onDisconnectDone(null),this.onConnectionOver instanceof Function&&this.onConnectionOver(null)},e.prototype.onDisconnectDone=function(){},e.prototype.onConnectionOver=function(){},e.prototype.prepareUrl=function(){var r=this.socket.options;return this.scheme()+"://"+r.host+":"+r.port+"/"+r.resource+"/"+n.protocol+"/"+this.name+"/"+this.sessid},e.prototype.ready=function(r,s){s.call(this)}}(io!==void 0?io:module.exports,io!==void 0?io:module.parent.exports),function(t,n,e){function r(i){if(this.options={port:80,secure:!1,document:"document"in e&&document,resource:"socket.io",transports:i.transports||n.transports,"connect timeout":1e4,"try multiple transports":!0,reconnect:!0,"reconnection delay":500,"reconnection limit":1/0,"reopen delay":3e3,"max reconnection attempts":10,"sync disconnect on unload":!1,"auto connect":!0,"flash policy port":10843,needToXHR:!0,manualFlush:!1},n.util.merge(this.options,i),this.connected=!1,this.open=!1,this.connecting=!1,this.reconnecting=!1,this.namespaces={},this.buffer=[],this.doBuffer=!1,this.options["sync disconnect on unload"]&&(!this.isXDomain()||n.util.ua.hasCORS)){var o=this;n.util.on(e,"beforeunload",function(){o.disconnectSync()},!1)}this.options["auto connect"]&&this.connect()}function s(){}t.Socket=r,n.util.mixin(r,n.EventEmitter),r.prototype.of=function(i){return this.namespaces[i]||(this.namespaces[i]=new n.SocketNamespace(this,i),i!==""&&this.namespaces[i].packet({type:"connect"})),this.namespaces[i]},r.prototype.publish=function(){var i;for(var o in this.emit.apply(this,arguments),this.namespaces)this.namespaces.hasOwnProperty(o)&&(i=this.of(o)).$emit.apply(i,arguments)},r.prototype.guid=function(){var i=root.crypto||root.msCrypto;if(i){var o=new Uint8Array(16);i.getRandomValues(o),o[6]&=15,o[6]|=64,o[8]&=63,o[8]|=128;for(var a="",d=0;d<o.length;d++){var c=o[d].toString(16);c.length===1&&(c="0"+c),a+=c}return a.substring(0,8)+"-"+a.substring(8,12)+"-"+a.substring(12,16)+"-"+a.substring(16,20)+"-"+a.substring(20)}},r.prototype.handshake=function(i){var o=this,a=this.options;if(!this.options.needToXHR&&this.options.transports.length===1&&this.options.transports[0]==="websocket"){var d=this.guid();if(d)return void setTimeout(function(){o.publish("info","xhr, skip and get:"+d),i.apply(null,[d,"90","60","websocket"])},0)}function c(O){O instanceof Error?(o.connecting=!1,o.publish("info","xhr, status:200, but got error:",O),o.onError("xhr, status:200, but got error:"+O.message,O)):i.apply(null,O.split(":"))}var u=["http"+(a.secure?"s":"")+":/",a.host+":"+a.port,a.resource,n.protocol,n.util.query(this.options.query,"t="+ +new Date)].join("/");if(this.isXDomain()&&!n.util.ua.hasCORS&&typeof document<"u"&&document){var m=document.getElementsByTagName("script")[0],y=document.createElement("script");y.src=u+"&jsonp="+n.j.length,y.onreadystatechange=function(){this.readyState=="loaded"&&y.parentNode&&(y.parentNode.removeChild(y),o.connecting=!1,o.publish("info","xhr, jsonp:Server down or port not open"),!o.reconnecting&&o.onError("Server down or port not open",new Error("xhr, jsonp:server down or port not open")),o.publish("handshake_failed"))},m.parentNode.insertBefore(y,m),n.j.push(function(O){c(O),y.parentNode.removeChild(y)})}else{var S=n.util.request();S.open("GET",u,!0),S.timeout=8e3,this.isXDomain()&&(S.withCredentials=!0),S.onreadystatechange=function(){o.publish("info","xhr, readyState:"+S.readyState+" status:"+S.status),S.readyState==4&&(o.publish("info","xhr, responseText:"+S.responseText),S.onreadystatechange=s,S.status==200?c(S.responseText):S.status==403?(o.connecting=!1,o.onError(S.responseText,new Error("xhr, status:403"+S.responseText)),o.publish("handshake_failed")):(o.connecting=!1,!o.reconnecting&&o.onError(S.responseText,new Error("xhr, status:"+S.status+" "+S.responseText)),o.publish("handshake_failed")))},S.ontimeout=function(O){o.publish("info","xhr, timeout"),o.connecting=!1,!o.reconnecting&&o.onError(S.responseText,new Error("xhr, timeout")),o.publish("handshake_failed")},S.send(null)}},r.prototype.connect=function(i){if(this.connecting)return this;var o=this;return o.connecting=!0,this.handshake(function(a,d,c,u){o.publish("info","SocketIO handshake parameter: sid: "+a+", transports: "+u+", close: "+c+", heartbeat: "+d),o.sessionid=a,o.closeTimeout=1e3*c,o.heartbeatTimeout=1e3*d,o.transports||(o.transports=o.origTransports=u?n.util.intersect(u.split(","),o.options.transports):o.options.transports),o.setHeartbeatTimeout(),o.once("connect",function(){o.publish("info","tcp, clear connect timeout due to recv connect event"),clearTimeout(o.connectTimeoutTimer),o.connectTimeoutTimer=null,i&&typeof i=="function"&&i()}),o.doConnect()}),this},r.prototype.doConnect=function(){var i=this;if(i.transport&&i.transport.clearTimeouts(),i.transport=i.getTransport(i.transports),!i.transport)return i.publish("connect_failed");i.transport.ready(i,function(){i.connecting=!0,i.publish("info","tcp, connecting, transport ready in "+i.transport.name),i.publish("connecting",i.transport.name),i.transport.open(),i.options["connect timeout"]&&(i.connectTimeoutTimer&&clearTimeout(i.connectTimeoutTimer),i.publish("info","set new connect timeout"),i.connectTimeoutTimer=setTimeout(function(){i.publish("info","trigger connect timeout due to setTimeout"),i.transport.close(),i.tryNextTransport()},i.options["connect timeout"]))})},r.prototype.getTransport=function(i){const o=this;for(var a,d=i||this.transports,c=0;a=d[c];c++)if(o.publish("info","check transport: "+a),n.Transport[a]&&n.Transport[a].check(this)&&(!this.isXDomain()||n.Transport[a].xdomainCheck(this)))return o.publish("info","use transport: "+a),new n.Transport[a](this,this.sessionid);return null},r.prototype.tryNextTransport=function(){if(!this.connected&&(this.connecting=!1,this.options["try multiple transports"])){for(var i=this.transports;i.length>0&&i.splice(0,1)[0]!=this.transport.name;);i.length?this.doConnect():this.publish("connect_failed")}},r.prototype.setHeartbeatTimeout=function(){if(clearTimeout(this.heartbeatTimeoutTimer),!this.transport||this.transport.heartbeats()){var i=this;this.heartbeatTimeoutTimer=setTimeout(function(){i.transport&&(i.publish("info","transport closed by setHeartbeatTimeout"),i.transport.onClose())},this.heartbeatTimeout)}},r.prototype.packet=function(i){return this.connected&&!this.doBuffer?this.transport.packet(i):this.buffer.push(i),this},r.prototype.setBuffer=function(i){this.doBuffer=i,!i&&this.connected&&this.buffer.length&&(this.options.manualFlush||this.flushBuffer())},r.prototype.flushBuffer=function(){this.transport.payload(this.buffer),this.buffer=[]},r.prototype.disconnect=function(){return(this.connected||this.connecting)&&(this.open&&this.of("").packet({type:"disconnect"}),this.publish("info","socket disconnected by IM SDK"),this.onDisconnect("booted")),this},r.prototype.disconnectSync=function(){var i=n.util.request(),o=["http"+(this.options.secure?"s":"")+":/",this.options.host+":"+this.options.port,this.options.resource,n.protocol,"",this.sessionid].join("/")+"/?disconnect=1";i.open("GET",o,!1),i.send(null),this.publish("info","socket disconnected by disconnectSync before page unload"),this.onDisconnect("booted")},r.prototype.isXDomain=function(){var i=e&&e.location||{},o=i.port||(i.protocol=="https:"?443:80);return this.options.host!==i.hostname||this.options.port!=o},r.prototype.onConnect=function(){this.connected||(this.connected=!0,this.connecting=!1,this.doBuffer||this.setBuffer(!1),this.emit("connect"))},r.prototype.onOpen=function(){this.publish("info","tcp, websocket onOpen"),this.open=!0},r.prototype.onClose=function(){this.publish("info","tcp, websocket onClose"),this.open=!1,clearTimeout(this.heartbeatTimeoutTimer)},r.prototype.onPacket=function(i){this.of(i.endpoint).onPacket(i)},r.prototype.onError=function(i,o){i&&i.advice&&i.advice==="reconnect"&&(this.connected||this.connecting)&&(this.disconnect(),this.options.reconnect&&this.reconnect()),this.publish("error",i&&i.reason?i.reason:i,o)},r.prototype.onDisconnect=function(i){var o=this.connected,a=this.connecting;this.publish("info",i?"tcp, onDisconnect reason:"+i:"tcp, onDisconnect"),this.connected=!1,this.connecting=!1,this.open=!1,(o||a)&&this.transport&&(this.transport.close(),this.transport.clearTimeouts(),o&&(this.publish("disconnect",i),i!="booted"&&this.options.reconnect&&!this.reconnecting&&this.reconnect()),a&&(this.connectTimeoutTimer&&(this.publish("info","clear connect timeout due to onDisconnect"),clearTimeout(this.connectTimeoutTimer)),this.tryNextTransport()))},r.prototype.reconnect=function(){this.reconnecting=!0,this.reconnectionAttempts=0,this.reconnectionDelay=this.options["reconnection delay"];var i=this,o=this.options["max reconnection attempts"],a=this.options["try multiple transports"],d=this.options["reconnection limit"];function c(){if(i.connected){for(var m in i.namespaces)i.namespaces.hasOwnProperty(m)&&m!==""&&i.namespaces[m].packet({type:"connect"});i.publish("reconnect",i.transport.name,i.reconnectionAttempts)}clearTimeout(i.reconnectionTimer),i.removeListener("connect_failed",u),i.removeListener("connect",u),i.reconnecting=!1,delete i.reconnectionAttempts,delete i.reconnectionDelay,delete i.reconnectionTimer,delete i.redoTransports,i.options["try multiple transports"]=a}function u(){if(i.reconnecting)return i.connected?c():i.connecting&&i.reconnecting?i.reconnectionTimer=setTimeout(u,1e3):void(i.reconnectionAttempts++>=o?i.redoTransports?(i.publish("reconnect_failed"),c()):(i.on("connect_failed",u),i.options["try multiple transports"]=!0,i.transports=i.origTransports,i.transport=i.getTransport(),i.redoTransports=!0,i.connect()):(i.reconnectionDelay<d&&(i.reconnectionDelay*=2),i.connect(),i.publish("reconnecting",i.reconnectionDelay,i.reconnectionAttempts),i.reconnectionTimer=setTimeout(u,i.reconnectionDelay)))}this.options["try multiple transports"]=!1,this.reconnectionTimer=setTimeout(u,this.reconnectionDelay),this.on("connect",u)}}(io!==void 0?io:module.exports,io!==void 0?io:module.parent.exports,root),function(t,n){function e(s,i){this.socket=s,this.name=i||"",this.flags={},this.json=new r(this,"json"),this.ackPackets=0,this.acks={}}function r(s,i){this.namespace=s,this.name=i}t.SocketNamespace=e,n.util.mixin(e,n.EventEmitter),e.prototype.$emit=n.EventEmitter.prototype.emit,e.prototype.of=function(){return this.socket.of.apply(this.socket,arguments)},e.prototype.packet=function(s){return s.endpoint=this.name,this.socket.packet(s),this.flags={},this},e.prototype.send=function(s,i){var o={type:this.flags.json?"json":"message",data:s};return typeof i=="function"&&(o.id=++this.ackPackets,o.ack=!0,this.acks[o.id]=i),this.packet(o)},e.prototype.emit=function(s){var i=Array.prototype.slice.call(arguments,1),o=i[i.length-1],a={type:"event",name:s};return typeof o=="function"&&(a.id=++this.ackPackets,a.ack="data",this.acks[a.id]=o,i=i.slice(0,i.length-1)),a.args=i,this.packet(a)},e.prototype.disconnect=function(){return this.name===""?this.socket.disconnect():(this.packet({type:"disconnect"}),this.$emit("disconnect")),this},e.prototype.onPacket=function(s){var i=this;function o(){i.packet({type:"ack",args:n.util.toArray(arguments),ackId:s.id})}switch(s.type){case"connect":this.$emit("connect");break;case"disconnect":this.name===""?(this.socket.publish("info","socket disconnected by SocketNameSpace.onPacket"),this.socket.onDisconnect(s.reason||"booted")):this.$emit("disconnect",s.reason);break;case"message":case"json":var a=["message",s.data];s.ack=="data"?a.push(o):s.ack&&this.packet({type:"ack",ackId:s.id}),this.$emit.apply(this,a);break;case"event":a=[s.name].concat(s.args),s.ack=="data"&&a.push(o),this.$emit.apply(this,a);break;case"ack":this.acks[s.ackId]&&(this.acks[s.ackId].apply(this,s.args),delete this.acks[s.ackId]);break;case"error":this.socket.publish("info","packet, type:error",s),s.advice?this.socket.onError(s,new Error("packet, type:error and advice is "+s.advice)):s.reason==="unauthorized"?this.$emit("connect_failed",s.reason):this.$emit("error",s.reason,new Error("packet, type:error and reason is "+s.reason))}},r.prototype.send=function(){this.namespace.flags[this.name]=!0,this.namespace.send.apply(this.namespace,arguments)},r.prototype.emit=function(){this.namespace.flags[this.name]=!0,this.namespace.emit.apply(this.namespace,arguments)}}(io!==void 0?io:module.exports,io!==void 0?io:module.parent.exports),function(t,n,e){function r(s){n.Transport.apply(this,arguments)}t.websocket=r,n.util.inherit(r,n.Transport),r.prototype.name="websocket",r.prototype.open=function(){var s,i=n.util.query(this.socket.options.query),o=this;return s||(s=e.MozWebSocket||e.WebSocket),this.websocket=new s(this.prepareUrl()+i),this.websocket.onopen=function(){o.onOpen(),o.socket.setBuffer(!1)},this.websocket.onmessage=function(a){o.onData(a.data)},this.websocket.onclose=function(a){o.socket.setBuffer(!0),o.socket.publish("websocketOnclose",a),o.onClose()},this.websocket.onerror=function(a){var d="";a&&a.message?d=a.message:a.target&&(d=a.target.readyState?"websocket, readyState:"+a.target.readyState:"websocket event"),o.onError(d,a)},this},n.util.ua.iDevice?r.prototype.send=function(s){var i=this;return setTimeout(function(){i.websocket.send(s)},0),this}:r.prototype.send=function(s){return this.websocket.send(s),this},r.prototype.payload=function(s){for(var i=0,o=s.length;i<o;i++)this.packet(s[i]);return this},r.prototype.close=function(){return this.websocket.close(),this},r.prototype.onError=function(s,i){this.socket.publish("info","tcp, onError",s,i),this.socket.onError(s,i)},r.prototype.scheme=function(){return this.socket.options.secure?"wss":"ws"},r.check=function(){return"WebSocket"in e&&!("__addTask"in WebSocket)||"MozWebSocket"in e},r.xdomainCheck=function(){return!0},n.transports.push("websocket")}(io!==void 0?io.Transport:module.exports,io!==void 0?io:module.parent.exports,root),function(t,n,e){function r(i){i&&(n.Transport.apply(this,arguments),this.sendBuffer=[])}function s(){}t.XHR=r,n.util.inherit(r,n.Transport),r.prototype.open=function(){return this.socket.setBuffer(!1),this.onOpen(),this.get(),this.setCloseTimeout(),this},r.prototype.payload=function(i){for(var o=[],a=0,d=i.length;a<d;a++)o.push(n.parser.encodePacket(i[a]));this.send(n.parser.encodePayload(o))},r.prototype.send=function(i){return this.post(i),this},r.prototype.post=function(i){var o=this;this.socket.setBuffer(!0),this.sendXHR=this.request("POST"),e.XDomainRequest&&this.sendXHR instanceof XDomainRequest?this.sendXHR.onload=this.sendXHR.onerror=function(){this.onload=s,o.socket.setBuffer(!1)}:this.sendXHR.onreadystatechange=function(){this.readyState==4&&(this.onreadystatechange=s,o.posting=!1,this.status==200?o.socket.setBuffer(!1):o.onClose())},this.sendXHR.send(i)},r.prototype.close=function(){return this.onClose(),this},r.prototype.request=function(i){var o=n.util.request(this.socket.isXDomain()),a=n.util.query(this.socket.options.query,"t="+ +new Date);if(o.open(i||"GET",this.prepareUrl()+a,!0),i=="POST")try{o.setRequestHeader?o.setRequestHeader("Content-type","text/plain;charset=UTF-8"):o.contentType="text/plain"}catch{}return o},r.prototype.scheme=function(){return this.socket.options.secure?"https":"http"},r.check=function(i,o){try{var a=n.util.request(o),d=e.XDomainRequest&&a instanceof XDomainRequest,c=i&&i.options&&i.options.secure?"https:":"http:",u=e.location&&c!=e.location.protocol;if(a&&(!d||!u))return!0}catch{}return!1},r.xdomainCheck=function(i){return r.check(i,!0)}}(io!==void 0?io.Transport:module.exports,io!==void 0?io:module.parent.exports,root),function(t,n,e){function r(){n.Transport.XHR.apply(this,arguments)}function s(){}t["xhr-polling"]=r,n.util.inherit(r,n.Transport.XHR),n.util.merge(r,n.Transport.XHR),r.prototype.name="xhr-polling",r.prototype.heartbeats=function(){return!1},r.prototype.open=function(){return n.Transport.XHR.prototype.open.call(this),!1},r.prototype.get=function(){if(this.isOpen){var i=this;this.xhr=this.request(),e.XDomainRequest&&this.xhr instanceof XDomainRequest?(this.xhr.onload=function(){this.onload=s,this.onerror=s,i.retryCounter=1,i.onData(this.responseText),i.get()},this.xhr.onerror=function(){i.retryCounter++,!i.retryCounter||i.retryCounter>3?i.onClose():i.get()}):this.xhr.onreadystatechange=function(){this.readyState==4&&(this.onreadystatechange=s,this.status==200?(i.onData(this.responseText),i.get()):i.onClose())},this.xhr.send(null)}},r.prototype.onClose=function(){if(n.Transport.XHR.prototype.onClose.call(this),this.xhr){this.xhr.onreadystatechange=this.xhr.onload=this.xhr.onerror=s;try{this.xhr.abort()}catch{}this.xhr=null}},r.prototype.ready=function(i,o){var a=this;n.util.defer(function(){o.call(a)})},n.transports.push("xhr-polling")}(io!==void 0?io.Transport:module.exports,io!==void 0?io:module.parent.exports,root),__WEBPACK_AMD_DEFINE_ARRAY__=[],__WEBPACK_AMD_DEFINE_RESULT__=(function(){return io}).apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__),__WEBPACK_AMD_DEFINE_RESULT__===void 0||(module.exports=__WEBPACK_AMD_DEFINE_RESULT__)}()}).call(this,__webpack_require__(73),__webpack_require__(147)(module))},function(t,n){t.exports=function(e){var r=-1,s=Array(e.size);return e.forEach(function(i){s[++r]=i}),s}},function(t,n,e){var r,s=e(26),i=e(45),o=e(11),a=e(64),d=e(690),c=e(697),u=e(196),m=u.getLibEnv,y=u.getHostEnv,S=u.getHostEnvVer,O={initReporter:function(){var k=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},g={app_key:k.appKey,platform:"Web",dev_id:i.deviceId,sdk_ver:o.info.version,env:"online",os_name:a.os?a.os.family:"",os_ver:a.os?a.os.version:"",lib_env:m(),host_env:y(),host_env_ver:S(),manufactor:a.name,model:S()};o.isBrowser||(k.isDataReportEnable=!1);var v=new d({isDataReportEnable:k.isDataReportEnable,reportConfigUrl:k.reportConfigUrl,reportUrl:k.reportUrl,common:g,request:c,logger:k.logger,autoStart:o.isBrowser});return v}};O.sendBeacon=navigator&&navigator.sendBeacon&&s(r=navigator.sendBeacon).call(r,navigator)||function(k,g){var v=new XMLHttpRequest;v.open("POST",k,!0),v.send(g)},t.exports=O},function(t,n,e){t.exports=e(691)},function(t,n,e){var r=e(1),s=e(14);r({global:!0,forced:s.globalThis!==s},{globalThis:s})},function(t,n,e){var r=e(1),s=e(12),i=e(114),o=e(28),a=e(30),d=e(39).f,c=e(134),u=e(168),m=e(708),y=e(130),S=e(710),O=!1,k=y("meta"),g=0,v=function(L){d(L,k,{value:{objectID:"O"+g++,weakData:{}}})},ue=t.exports={enable:function(){ue.enable=function(){},O=!0;var L=c.f,re=s([].splice),le={};le[k]=1,L(le).length&&(c.f=function(oe){for(var he=L(oe),Ie=0,ie=he.length;Ie<ie;Ie++)if(he[Ie]===k){re(he,Ie,1);break}return he},r({target:"Object",stat:!0,forced:!0},{getOwnPropertyNames:u.f}))},fastKey:function(L,re){if(!o(L))return typeof L=="symbol"?L:(typeof L=="string"?"S":"P")+L;if(!a(L,k)){if(!m(L))return"F";if(!re)return"E";v(L)}return L[k].objectID},getWeakData:function(L,re){if(!a(L,k)){if(!m(L))return!0;if(!re)return!1;v(L)}return L[k].weakData},onFreeze:function(L){return S&&O&&m(L)&&!a(L,k)&&v(L),L}};i[k]=!0},function(t,n,e){var r=e(20),s=e(31),i=e(17),o=e(36),a=TypeError;t.exports=function(d,c){var u,m=o(this),y=s(m.get),S=s(m.has),O=s(m.set),k=arguments.length>2?arguments[2]:void 0;if(!i(c)&&!i(k))throw a("At least one callback required");return r(S,m,d)?(u=r(y,m,d),i(c)&&(u=c(u),r(O,m,d,u))):i(k)&&(u=k(),r(O,m,d,u)),u}},function(t,n,e){t.exports=e(740)},function(t,n,e){var r=e(4);e(45);function s(){}s.typeMap={text:0,image:1,audio:2,video:3,geo:4,notification:5,file:6,tip:10,robot:11,g2:12,custom:100};var i=s.typeReverseMap={0:"text",1:"image",2:"audio",3:"video",4:"geo",5:"notification",6:"file",10:"tip",11:"robot",12:"g2",100:"custom"};s.validTypes=r(s.typeMap),s.setFlow=function(o,a){o.flow=o.from===a?o.to===a?"in":"out":"in",o.type==="robot"&&o.content&&o.content.msgOut&&(o.flow="in")},s.getType=function(o){var a=o.type;return i[a]||a},t.exports=s},function(t,n,e){t.exports=function(r,s,i,o){var a=self||window;try{try{var d;try{d=new a.Blob([r])}catch{(d=new(a.BlobBuilder||a.WebKitBlobBuilder||a.MozBlobBuilder||a.MSBlobBuilder)).append(r),d=d.getBlob()}var c=a.URL||a.webkitURL,u=c.createObjectURL(d),m=new a[s](u,i);return c.revokeObjectURL(u),m}catch{return new a[s]("data:application/javascript,".concat(encodeURIComponent(r)),i)}}catch{if(!o)throw Error("Inline worker is not supported");return new a[s](o,i)}}},function(t,n,e){e(11).isBrowser=!0},function(t,n,e){var r=e(372);t.exports=r},function(t,n,e){var r=e(471);t.exports=r},function(t,n){var e=/^(?:0|[1-9]\d*)$/;t.exports=function(r,s){var i=typeof r;return!!(s=s??9007199254740991)&&(i=="number"||i!="symbol"&&e.test(r))&&r>-1&&r%1==0&&r<s}},function(t,n,e){t.exports=e(559)},function(t,n,e){(function(r){var s,i=e(22),o=e(3),a=e(126),d=e(15),c=e(32),u=e(2),m=e(43),y=e(6),S=e(4),O=e(16);(function(k,g){var v,ue=(k=k!==void 0?k:typeof self<"u"?self:r!==void 0?r:{}).IDBKeyRange||k.webkitIDBKeyRange,L="readonly",re="readwrite",le=Object.prototype.hasOwnProperty,oe=function(){if(!v&&!(v=k.indexedDB||k.webkitIndexedDB||k.mozIndexedDB||k.oIndexedDB||k.msIndexedDB||(k.indexedDB===null&&k.shimIndexedDB?k.shimIndexedDB:void 0)))throw"IndexedDB required";return v},he=!1,Ie=navigator&&!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent),ie=function(ar){return ar},Ne=function(ar){var pr;return d(pr=Object.prototype.toString.call(ar)).call(pr,8,-1).toLowerCase()},Ve=function(ar){return typeof ar=="function"},Ce=function(ar){return Ne(ar)==="number"},Ue=function(ar){return Ne(ar)==="array"},qe=function(ar){return ar===void 0},Oe=function(ar,pr){var lr=this,or=!1;this.name=pr,this.getIndexedDB=function(){return ar},this.add=function(ir){if(or)throw"Database has been closed";for(var dr=[],Lt=0,cr=0;cr<arguments.length-1;cr++)if(c(arguments[cr+1]))for(var mr=0;mr<arguments[cr+1].length;mr++)dr[Lt]=arguments[cr+1][mr],Lt++;else dr[Lt]=arguments[cr+1],Lt++;var tr=ar.transaction(ir,re),At=tr.objectStore(ir);return new o(function(kt,Dt){u(dr).call(dr,function(gr){var yr;if(gr.item&&gr.key){var vr=gr.key;gr=gr.item,yr=At.add(gr,vr)}else yr=At.add(gr);yr.onsuccess=function(Ir){var Mr=Ir.target,Ar=Mr.source.keyPath;Ar===null&&(Ar="__id__"),m(gr,Ar,{value:Mr.result,enumerable:!0})}}),tr.oncomplete=function(){kt(dr,lr)},tr.onerror=function(gr){gr.preventDefault(),Dt(gr)},tr.onabort=function(gr){Dt(gr)}})},this.updateAndDelete=function(ir,dr,Lt){if(or)throw"Database has been closed";var cr=ar.transaction(ir,re),mr=cr.objectStore(ir),tr=mr.keyPath;return new o(function(At,kt){u(dr).call(dr,function(Dt){if(Dt.item&&Dt.key){var gr=Dt.key;Dt=Dt.item,mr.put(Dt,gr)}else mr.put(Dt)}),u(Lt).call(Lt,function(Dt){mr.delete(Dt[tr])}),cr.oncomplete=function(){At([dr,Lt])},cr.onerror=function(Dt){kt(Dt)}})},this.update=function(ir){if(or)throw"Database has been closed";for(var dr,Lt=[],cr=1;cr<arguments.length;cr++)c(dr=arguments[cr])?Lt=y(Lt).call(Lt,dr):Lt.push(dr);var mr=ar.transaction(ir,re),tr=mr.objectStore(ir);return tr.keyPath,new o(function(At,kt){u(Lt).call(Lt,function(Dt){var gr;if(Dt.item&&Dt.key){var yr=Dt.key;Dt=Dt.item,gr=tr.put(Dt,yr)}else gr=tr.put(Dt);gr.onsuccess=function(vr){},gr.onerror=function(vr){}}),mr.oncomplete=function(){At(Lt,lr)},mr.onerror=function(Dt){kt(Dt)},mr.onabort=function(Dt){kt(Dt)}})},this.remove=function(ir,dr,Lt,cr,mr,tr,At){if(or)throw"Database has been closed";var kt=ar.transaction(ir,re),Dt=kt.objectStore(ir);return new o(function(gr,yr){function vr(Mr){return Mr==null}var Ir;vr(cr)&&(cr=-1/0),vr(mr)&&(mr=1/0),dr===null||c(dr)||(dr=[dr]),vr(Lt)?dr!==null?u(dr).call(dr,function(Mr){Dt.delete(Mr)}):Dt.delete(range=ue.bound(cr,mr,tr,At)):(Ir=dr!==null?ue.only(dr[0]):ue.bound(cr,mr,tr,At),Dt.index(Lt).openCursor(Ir).onsuccess=function(Mr){var Ar=Mr.target.result;Ar&&(Ar.delete(),Ar.continue())}),kt.oncomplete=function(){gr()},kt.onerror=function(Mr){yr(Mr)},kt.onabort=function(Mr){yr(Mr)}})},this.clear=function(ir){if(or)throw"Database has been closed";var dr=ar.transaction(ir,re);return dr.objectStore(ir).clear(),new o(function(Lt,cr){dr.oncomplete=function(){Lt()},dr.onerror=function(mr){cr(mr)}})},this.close=function(){or||(ar.close(),or=!0,delete er[pr])},this.get=function(ir,dr){if(or)throw"Database has been closed";var Lt=ar.transaction(ir),cr=Lt.objectStore(ir).get(dr);return new o(function(mr,tr){cr.onsuccess=function(At){mr(At.target.result)},Lt.onerror=function(At){tr(At)}})},this.query=function(ir,dr){if(or)throw"Database has been closed";return new $e(ir,ar,dr)},this.count=function(ir,dr){if(or)throw"Database has been closed";ar.transaction(ir).objectStore(ir)};for(var xe=0,nr=ar.objectStoreNames.length;xe<nr;xe++)(function(ir){for(var dr in lr[ir]={},lr)le.call(lr,dr)&&dr!=="close"&&(lr[ir][dr]=function(Lt){return function(){var cr,mr=y(cr=[ir]).call(cr,d([]).call(arguments,0));return lr[Lt].apply(lr,mr)}}(dr))})(ar.objectStoreNames[xe])},$e=function(ar,pr,lr){var or,xe=this,nr=!1,ir=!1,dr=function(cr,mr,tr,At,kt,Dt,gr){return new o(function(yr,vr){var Ir=nr||ir?re:L,Mr=pr.transaction(ar,Ir),Ar=Mr.objectStore(ar),Fr=lr?Ar.index(lr):Ar,Dr=cr?ue[cr].apply(null,mr):null,Or=[],Sn=[Dr],Rr=0;kt=kt||null,Dt=Dt||[],tr!=="count"&&Sn.push(At||"next");var Wr=!!nr&&S(nr);Fr[tr].apply(Fr,Sn).onsuccess=function(Er){var Ur=Er.target.result;if(i(Ur)===i(0))Or=Ur;else if(Ur){if(kt!==null&&kt[0]>Rr)Rr=kt[0],Ur.advance(kt[0]);else if(!(kt!==null&&Rr>=kt[0]+kt[1])){var Zr=!0,In="value"in Ur?Ur.value:Ur.key;u(Dt).call(Dt,function(An){An&&An.length&&(An.length===2?Zr=Zr&&In[An[0]]===An[1]:Ve(An[0])&&(Zr=Zr&&An[0].apply(void 0,[In])))}),Zr&&(Rr++,Or.push(gr(In)),ir?Ur.delete():nr&&(In=function(An){for(var Zn=0;Zn<Wr.length;Zn++){var Nn=Wr[Zn],Gi=nr[Nn];Gi instanceof Function&&(Gi=Gi(An)),An[Nn]=Gi}return An}(In),Ur.update(In))),Ur.continue()}}},Mr.oncomplete=function(){yr(Or)},Mr.onerror=function(Er){vr(Er)},Mr.onabort=function(Er){vr(Er)}})},Lt=function(cr,mr){var tr="next",At="openCursor",kt=[],Dt=null,gr=ie,yr=!1,vr=function(){return dr(cr,mr,At,yr?tr+"unique":tr,Dt,kt,gr)},Ir=function(){return tr=null,At="count",{execute:vr}},Mr=function Ur(){return(Dt=Ue(arguments[0])?arguments[0]:d(Array.prototype).call(arguments,0,2)).length==1&&Dt.unshift(0),Ce(Dt[1])||(Dt=null),{execute:vr,count:Ir,keys:Ar,filter:Fr,asc:Dr,desc:Or,distinct:Sn,modify:Rr,limit:Ur,map:Wr,remove:Er}},Ar=function Ur(Zr){return(Zr=!!qe(Zr)||!!Zr)&&(At="openKeyCursor"),{execute:vr,keys:Ur,filter:Fr,asc:Dr,desc:Or,distinct:Sn,modify:Rr,limit:Mr,map:Wr,remove:Er}},Fr=function Ur(){return kt.push(d(Array.prototype).call(arguments,0,2)),{execute:vr,count:Ir,keys:Ar,filter:Ur,asc:Dr,desc:Or,distinct:Sn,modify:Rr,limit:Mr,map:Wr,remove:Er}},Dr=function Ur(Zr){return Zr=!!qe(Zr)||!!Zr,tr=Zr?"next":"prev",{execute:vr,count:Ir,keys:Ar,filter:Fr,asc:Ur,desc:Or,distinct:Sn,modify:Rr,limit:Mr,map:Wr,remove:Er}},Or=function Ur(Zr){return Zr=!!qe(Zr)||!!Zr,tr=Zr?"prev":"next",{execute:vr,count:Ir,keys:Ar,filter:Fr,asc:Dr,desc:Ur,distinct:Sn,modify:Rr,limit:Mr,map:Wr,remove:Er}},Sn=function Ur(Zr){return Zr=!!qe(Zr)||!!Zr,yr=Zr,{execute:vr,count:Ir,keys:Ar,filter:Fr,asc:Dr,desc:Or,distinct:Ur,modify:Rr,limit:Mr,map:Wr,remove:Er}},Rr=function Ur(Zr){return nr=Zr,{execute:vr,count:Ir,keys:Ar,filter:Fr,asc:Dr,desc:Or,distinct:Sn,modify:Ur,limit:Mr,map:Wr,remove:Er}},Wr=function Ur(Zr){return Ve(Zr)&&(gr=Zr),{execute:vr,count:Ir,keys:Ar,filter:Fr,asc:Dr,desc:Or,distinct:Sn,modify:Rr,limit:Mr,map:Ur,remove:Er}},Er=function Ur(Zr){return Zr=!!qe(Zr)||!!Zr,ir=Zr,{execute:vr,count:Ir,keys:Ar,filter:Fr,asc:Dr,desc:Or,distinct:Sn,modify:Rr,limit:Mr,map:Wr,remove:Ur}};return{execute:vr,count:Ir,keys:Ar,filter:Fr,asc:Dr,desc:Or,distinct:Sn,modify:Rr,limit:Mr,map:Wr,remove:Er}};u(or="only bound upperBound lowerBound".split(" ")).call(or,function(cr){xe[cr]=function(){return new Lt(cr,arguments)}}),this.filter=function(){var cr=new Lt(null,null);return O(cr).apply(cr,arguments)},this.all=function(){var cr;return O(cr=this).call(cr)}},_e=function(ar,pr,lr,or){var xe=ar.target.result,nr=new Oe(xe,pr);return er[pr]=xe,o.resolve(nr)},er={},Pt={version:"0.10.2",open:function(ar){var pr;return new o(function(lr,or){var xe;er[ar.server]?_e({target:{result:er[ar.server]}},ar.server,ar.version,ar.schema).then(lr,or):(he?o.resolve():Ie&&oe().databases?new o(function(nr){var ir=function(){return oe().databases().finally(nr)};xe=a(ir,100),ir()}).finally(function(){he=!0,clearInterval(xe)}):(he=!0,o.resolve())).then(function(){try{pr=oe().open(ar.server,ar.version)}catch(nr){or(nr)}pr.onsuccess=function(nr){_e(nr,ar.server,ar.version,ar.schema).then(lr,or)},pr.onupgradeneeded=function(nr){(function(ir,dr,Lt){for(var cr in typeof dr=="function"&&(dr=dr()),dr){var mr,tr=dr[cr];for(var At in mr=!le.call(dr,cr)||Lt.objectStoreNames.contains(cr)?ir.currentTarget.transaction.objectStore(cr):Lt.createObjectStore(cr,tr.key),tr.indexes){var kt=tr.indexes[At];try{mr.index(At)}catch{mr.createIndex(At,kt.key||At,S(kt).length?kt:{unique:!1})}}}})(nr,ar.schema,nr.target.result)},pr.onerror=function(nr){or(nr)}})})},remove:function(ar){return new o(function(pr,lr){if(!ar)return pr();var or,xe;i(ar)===Oe&&(ar=ar.name),typeof ar=="string"&&(or=er[ar]),or&&typeof or.close=="function"&&or.close();try{xe=oe().deleteDatabase(ar)}catch(nr){lr(nr)}xe.onsuccess=function(nr){delete er[ar],pr(ar)},xe.onerror=function(nr){lr(nr)},xe.onblocked=function(nr){lr(nr)}})}};t.exports!==void 0?t.exports=Pt:(s=(function(){return Pt}).call(n,e,n,t))===void 0||(t.exports=s)})(void 0)}).call(this,e(73))},function(t,n,e){var r=e(590);t.exports=r},function(t,n,e){t.exports=e(643)},function(t,n){var e={set:function(r,s,i){e[r]=s,i&&(i.support=s)}};t.exports=e},function(t,n,e){var r=e(4),s=e(2),i=e(26),o=e(0),a=o.notundef,d=o.fillPropertyWithDefault,c=r,u={},m={},y={},S=[],O={normal:0,advanced:1},k={manager:0,all:1};u.inviteMode=u.updateCustomMode=u.updateTeamMode=k;var g={0:"normal",1:"advanced"},v=u.joinMode={noVerify:0,needVerify:1,rejectAll:2};m.joinMode={0:"noVerify",1:"needVerify",2:"rejectAll"},y.joinMode=c(v),S.push("join");var ue=u.beInviteMode={needVerify:0,noVerify:1};function L(le){var oe;o.verifyOptions(le,"action","superTeam::SuperTeam"),o.verifyOptions(le,"teamId","superTeam::SuperTeam"),a(le.teamId)&&(this.teamId=le.teamId),a(le.type)&&(this.type=O[le.type]),a(le.avatar)&&(this.avatar=""+le.avatar),a(le.name)&&(this.name=""+le.name),a(le.intro)&&(this.intro=""+le.intro),a(le.announcement)&&(this.announcement=""+le.announcement),a(le.custom)&&(this.custom=""+le.custom),a(le.inviteMode)&&(this.inviteMode=k[le.inviteMode]),a(le.updateCustomMode)&&(this.updateCustomMode=k[le.updateCustomMode]),a(le.updateTeamMode)&&(this.updateTeamMode=k[le.updateTeamMode]),s(S).call(S,i(oe=this.setMode).call(oe,this,le))}function re(le,oe){a(le[oe+="Mode"])&&(le[oe]=m[oe][le[oe]])}m.beInviteMode={0:"needVerify",1:"noVerify"},S.push("beInvite"),m.inviteMode=m.updateCustomMode=m.updateTeamMode={0:"manager",1:"all"},S.push("invite"),S.push("updateCustom"),S.push("updateTeam"),y.inviteMode=y.updateCustomMode=y.updateTeamMode=c(k),y.beInviteMode=c(ue),L.prototype.setMode=function(le,oe){a(le[oe+="Mode"])&&(o.verifyParamValid(oe,le[oe],y[oe],"Superteam::Team"),this[oe]=u[oe][le[oe]])},L.reverse=function(le,oe){var he=o.copy(le);if(a(he.teamId)&&(he.teamId=""+he.teamId),a(he.type)&&(he.type=g[he.type]),a(he.level)&&(he.level=+he.level),a(he.valid)&&(he.valid=+he.valid==1),a(he.memberNum)&&(he.memberNum=+he.memberNum),a(he.memberUpdateTime)&&(he.memberUpdateTime=+he.memberUpdateTime),a(he.createTime)&&(he.createTime=+he.createTime),a(he.updateTime)&&(he.updateTime=+he.updateTime),a(he.validToCurrentUser)&&(he.validToCurrentUser=he.validToCurrentUser==="1"),a(he.mute)&&(he.mute=he.mute==="1"),a(he.muteType))switch(he.muteType){case"0":he.mute=!1,he.muteType="none";break;case"1":he.mute=!0,he.muteType="normal";break;case"3":he.mute=!0,he.muteType="all"}else a(he.mute)&&(he.mute===1?(he.mute=!0,he.muteType="normal"):(he.mute=!1,he.muteType="none"));return s(S).call(S,i(re).call(re,null,he)),delete he.bits,oe||L.fillProperties(he),he},L.fillProperties=function(le){return d(le,"avatar","")},t.exports=L},function(t,n,e){t.exports=e(666)},function(t,n,e){var r=e(0).notundef;function s(i){r(i.shouldPushNotificationWhenPCOnline)&&(this.open=i.shouldPushNotificationWhenPCOnline?2:1)}s.getDefaultConfig=function(){return{shouldPushNotificationWhenPCOnline:!0}},s.reverse=function(i){return{shouldPushNotificationWhenPCOnline:+i.open!=1}},t.exports=s},function(t,n,e){var r=e(64),s=e(760),i=e(289),o=e(256),a=e(200),d=e(0),c=e(307),u=e(285),m=e(186),y=e(765),S=e(766);t.exports=function(O){d.merge(O,{platform:r,xhr:s,io:i,naturalSort:o,deepAccess:a,util:d,support:c,blob:u,ajax:m,LoggerPlugin:y,usePlugin:S})}},function(t,n,e){var r=e(9),s=e(10),i=e(4),o=e(108).genPrivateUrl,a=e(0),d=a.notundef,c={"-2":"unset","-1":"restricted",0:"common",1:"owner",2:"manager",3:"guest",4:"anonymous"};function u(m){d(m.nick)&&(this.nick=""+m.nick),d(m.avatar)&&(this.avatar=""+m.avatar),d(m.custom)&&(this.custom=""+m.custom)}u.reverse=function(m){var y=a.copy(m);return d(y.chatroomId)&&(y.chatroomId=""+y.chatroomId),d(y.avatar)&&(y.avatar=o(y.avatar)),d(y.type)&&(y.type=c[y.type]),d(y.level)&&(y.level=+y.level),d(y.online)&&(y.online=+y.online==1),d(y.enterTime)&&(y.enterTime=+y.enterTime),d(y.guest)&&(y.guest=+y.guest==1),d(y.blacked)&&(y.blacked=+y.blacked==1),d(y.gaged)&&(y.gaged=+y.gaged==1),d(y.valid)&&(y.valid=+y.valid==1),d(y.updateTime)&&(y.updateTime=+y.updateTime),d(y.tempMuted)?y.tempMuted=+y.tempMuted==1:y.tempMuted=!1,d(y.tempMuteDuration)?y.tempMuteDuration=+y.tempMuteDuration:y.tempMuteDuration=0,y.online||delete y.enterTime,y.guest&&(y.type="guest",delete y.valid),y.type!=="common"&&delete y.level,delete y.guest,y},u.reverseMembers=function(m){return r(m).call(m,function(y){return s(u).call(u,y)})},u.validTypes=i(c),u.typeReverseMap=c,t.exports=u},function(t,n,e){var r,s,i,o,a,d,c,u,m,y,S,O,k,g,v,ue,L,re,le;t.exports=(r=e(94),e(769),void(r.lib.Cipher||(s=r,i=s.lib,o=i.Base,a=i.WordArray,d=i.BufferedBlockAlgorithm,c=s.enc,c.Utf8,u=c.Base64,m=s.algo.EvpKDF,y=i.Cipher=d.extend({cfg:o.extend(),createEncryptor:function(oe,he){return this.create(this._ENC_XFORM_MODE,oe,he)},createDecryptor:function(oe,he){return this.create(this._DEC_XFORM_MODE,oe,he)},init:function(oe,he,Ie){this.cfg=this.cfg.extend(Ie),this._xformMode=oe,this._key=he,this.reset()},reset:function(){d.reset.call(this),this._doReset()},process:function(oe){return this._append(oe),this._process()},finalize:function(oe){return oe&&this._append(oe),this._doFinalize()},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(){function oe(he){return typeof he=="string"?le:L}return function(he){return{encrypt:function(Ie,ie,Ne){return oe(ie).encrypt(he,Ie,ie,Ne)},decrypt:function(Ie,ie,Ne){return oe(ie).decrypt(he,Ie,ie,Ne)}}}}()}),i.StreamCipher=y.extend({_doFinalize:function(){return this._process(!0)},blockSize:1}),S=s.mode={},O=i.BlockCipherMode=o.extend({createEncryptor:function(oe,he){return this.Encryptor.create(oe,he)},createDecryptor:function(oe,he){return this.Decryptor.create(oe,he)},init:function(oe,he){this._cipher=oe,this._iv=he}}),k=S.CBC=function(){var oe=O.extend();function he(Ie,ie,Ne){var Ve,Ce=this._iv;Ce?(Ve=Ce,this._iv=void 0):Ve=this._prevBlock;for(var Ue=0;Ue<Ne;Ue++)Ie[ie+Ue]^=Ve[Ue]}return oe.Encryptor=oe.extend({processBlock:function(Ie,ie){var Ne=this._cipher,Ve=Ne.blockSize;he.call(this,Ie,ie,Ve),Ne.encryptBlock(Ie,ie),this._prevBlock=Ie.slice(ie,ie+Ve)}}),oe.Decryptor=oe.extend({processBlock:function(Ie,ie){var Ne=this._cipher,Ve=Ne.blockSize,Ce=Ie.slice(ie,ie+Ve);Ne.decryptBlock(Ie,ie),he.call(this,Ie,ie,Ve),this._prevBlock=Ce}}),oe}(),g=(s.pad={}).Pkcs7={pad:function(oe,he){for(var Ie=4*he,ie=Ie-oe.sigBytes%Ie,Ne=ie<<24|ie<<16|ie<<8|ie,Ve=[],Ce=0;Ce<ie;Ce+=4)Ve.push(Ne);var Ue=a.create(Ve,ie);oe.concat(Ue)},unpad:function(oe){var he=255&oe.words[oe.sigBytes-1>>>2];oe.sigBytes-=he}},i.BlockCipher=y.extend({cfg:y.cfg.extend({mode:k,padding:g}),reset:function(){var oe;y.reset.call(this);var he=this.cfg,Ie=he.iv,ie=he.mode;this._xformMode==this._ENC_XFORM_MODE?oe=ie.createEncryptor:(oe=ie.createDecryptor,this._minBufferSize=1),this._mode&&this._mode.__creator==oe?this._mode.init(this,Ie&&Ie.words):(this._mode=oe.call(ie,this,Ie&&Ie.words),this._mode.__creator=oe)},_doProcessBlock:function(oe,he){this._mode.processBlock(oe,he)},_doFinalize:function(){var oe,he=this.cfg.padding;return this._xformMode==this._ENC_XFORM_MODE?(he.pad(this._data,this.blockSize),oe=this._process(!0)):(oe=this._process(!0),he.unpad(oe)),oe},blockSize:4}),v=i.CipherParams=o.extend({init:function(oe){this.mixIn(oe)},toString:function(oe){return(oe||this.formatter).stringify(this)}}),ue=(s.format={}).OpenSSL={stringify:function(oe){var he=oe.ciphertext,Ie=oe.salt;return(Ie?a.create([1398893684,1701076831]).concat(Ie).concat(he):he).toString(u)},parse:function(oe){var he,Ie=u.parse(oe),ie=Ie.words;return ie[0]==1398893684&&ie[1]==1701076831&&(he=a.create(ie.slice(2,4)),ie.splice(0,4),Ie.sigBytes-=16),v.create({ciphertext:Ie,salt:he})}},L=i.SerializableCipher=o.extend({cfg:o.extend({format:ue}),encrypt:function(oe,he,Ie,ie){ie=this.cfg.extend(ie);var Ne=oe.createEncryptor(Ie,ie),Ve=Ne.finalize(he),Ce=Ne.cfg;return v.create({ciphertext:Ve,key:Ie,iv:Ce.iv,algorithm:oe,mode:Ce.mode,padding:Ce.padding,blockSize:oe.blockSize,formatter:ie.format})},decrypt:function(oe,he,Ie,ie){return ie=this.cfg.extend(ie),he=this._parse(he,ie.format),oe.createDecryptor(Ie,ie).finalize(he.ciphertext)},_parse:function(oe,he){return typeof oe=="string"?he.parse(oe,this):oe}}),re=(s.kdf={}).OpenSSL={execute:function(oe,he,Ie,ie){ie||(ie=a.random(8));var Ne=m.create({keySize:he+Ie}).compute(oe,ie),Ve=a.create(Ne.words.slice(he),4*Ie);return Ne.sigBytes=4*he,v.create({key:Ne,iv:Ve,salt:ie})}},le=i.PasswordBasedCipher=L.extend({cfg:L.cfg.extend({kdf:re}),encrypt:function(oe,he,Ie,ie){var Ne=(ie=this.cfg.extend(ie)).kdf.execute(Ie,oe.keySize,oe.ivSize);ie.iv=Ne.iv;var Ve=L.encrypt.call(this,oe,he,Ne.key,ie);return Ve.mixIn(Ne),Ve},decrypt:function(oe,he,Ie,ie){ie=this.cfg.extend(ie),he=this._parse(he,ie.format);var Ne=ie.kdf.execute(Ie,oe.keySize,oe.ivSize,he.salt);return ie.iv=Ne.iv,L.decrypt.call(this,oe,he,Ne.key,ie)}}))))},function(t,n,e){t.exports=e(284)},function(t,n,e){var r=e(19),s=e(316),i=Array.prototype;t.exports=function(o){var a=o.indexOf;return o===i||r(i,o)&&a===i.indexOf?s:a}},function(t,n,e){e(317);var r=e(29);t.exports=r("Array").indexOf},function(t,n,e){var r=e(1),s=e(159),i=e(163).indexOf,o=e(82),a=s([].indexOf),d=!!a&&1/a([1],1,-0)<0,c=o("indexOf");r({target:"Array",proto:!0,forced:d||!c},{indexOf:function(u){var m=arguments.length>1?arguments[1]:void 0;return d?a(this,u,m)||0:i(this,u,m)}})},function(t,n,e){var r=e(20),s=e(28),i=e(129),o=e(160),a=e(319),d=e(21),c=TypeError,u=d("toPrimitive");t.exports=function(m,y){if(!s(m)||i(m))return m;var S,O=o(m,u);if(O){if(y===void 0&&(y="default"),S=r(O,m,y),!s(S)||i(S))return S;throw c("Can't convert object to primitive value")}return y===void 0&&(y="number"),a(m,y)}},function(t,n,e){var r=e(20),s=e(17),i=e(28),o=TypeError;t.exports=function(a,d){var c,u;if(d==="string"&&s(c=a.toString)&&!i(u=r(c,a))||s(c=a.valueOf)&&!i(u=r(c,a))||d!=="string"&&s(c=a.toString)&&!i(u=r(c,a)))return u;throw o("Can't convert object to primitive value")}},function(t,n,e){var r=e(14),s=Object.defineProperty;t.exports=function(i,o){try{s(r,i,{value:o,configurable:!0,writable:!0})}catch{r[i]=o}return o}},function(t,n){var e=Math.ceil,r=Math.floor;t.exports=Math.trunc||function(s){var i=+s;return(i>0?r:e)(i)}},function(t,n,e){var r=e(112),s=Math.min;t.exports=function(i){return i>0?s(r(i),9007199254740991):0}},function(t,n,e){var r=e(324);t.exports=r},function(t,n,e){var r=e(19),s=e(325),i=Array.prototype;t.exports=function(o){var a=o.concat;return o===i||r(i,o)&&a===i.concat?s:a}},function(t,n,e){e(213);var r=e(29);t.exports=r("Array").concat},function(t,n,e){var r=e(83),s=e(132),i=e(28),o=e(21)("species"),a=Array;t.exports=function(d){var c;return r(d)&&(c=d.constructor,(s(c)&&(c===a||r(c.prototype))||i(c)&&(c=c[o])===null)&&(c=void 0)),c===void 0?a:c}},function(t,n,e){e(328);var r=e(13).Object;t.exports=function(s,i){return r.create(s,i)}},function(t,n,e){e(1)({target:"Object",stat:!0,sham:!e(27)},{create:e(84)})},function(t,n,e){t.exports=e(330)},function(t,n,e){var r=e(331);e(358),e(359),e(360),e(361),e(362),e(363),e(364),t.exports=r},function(t,n,e){var r=e(219);e(357),t.exports=r},function(t,n,e){e(213),e(100),e(220),e(339),e(340),e(341),e(342),e(225),e(343),e(344),e(345),e(346),e(347),e(348),e(226),e(349),e(350),e(351),e(352),e(353);var r=e(13);t.exports=r.Symbol},function(t,n,e){var r=e(1),s=e(14),i=e(20),o=e(12),a=e(49),d=e(27),c=e(97),u=e(5),m=e(30),y=e(19),S=e(36),O=e(44),k=e(128),g=e(50),v=e(80),ue=e(84),L=e(120),re=e(134),le=e(168),oe=e(135),he=e(95),Ie=e(39),ie=e(166),Ne=e(150),Ve=e(68),Ce=e(111),Ue=e(133),qe=e(114),Oe=e(130),$e=e(21),_e=e(136),er=e(23),Pt=e(222),ar=e(85),pr=e(101),lr=e(74).forEach,or=Ue("hidden"),xe=pr.set,nr=pr.getterFor("Symbol"),ir=Object.prototype,dr=s.Symbol,Lt=dr&&dr.prototype,cr=s.TypeError,mr=s.QObject,tr=he.f,At=Ie.f,kt=le.f,Dt=Ne.f,gr=o([].push),yr=Ce("symbols"),vr=Ce("op-symbols"),Ir=Ce("wks"),Mr=!mr||!mr.prototype||!mr.prototype.findChild,Ar=d&&u(function(){return ue(At({},"a",{get:function(){return At(this,"a",{value:7}).a}})).a!=7})?function(Ur,Zr,In){var An=tr(ir,Zr);An&&delete ir[Zr],At(Ur,Zr,In),An&&Ur!==ir&&At(ir,Zr,An)}:At,Fr=function(Ur,Zr){var In=yr[Ur]=ue(Lt);return xe(In,{type:"Symbol",tag:Ur,description:Zr}),d||(In.description=Zr),In},Dr=function(Ur,Zr,In){Ur===ir&&Dr(vr,Zr,In),S(Ur);var An=k(Zr);return S(In),m(yr,An)?(In.enumerable?(m(Ur,or)&&Ur[or][An]&&(Ur[or][An]=!1),In=ue(In,{enumerable:v(0,!1)})):(m(Ur,or)||At(Ur,or,v(1,{})),Ur[or][An]=!0),Ar(Ur,An,In)):At(Ur,An,In)},Or=function(Ur,Zr){S(Ur);var In=O(Zr),An=L(In).concat(Er(In));return lr(An,function(Zn){d&&!i(Sn,In,Zn)||Dr(Ur,Zn,In[Zn])}),Ur},Sn=function(Ur){var Zr=k(Ur),In=i(Dt,this,Zr);return!(this===ir&&m(yr,Zr)&&!m(vr,Zr))&&(!(In||!m(this,Zr)||!m(yr,Zr)||m(this,or)&&this[or][Zr])||In)},Rr=function(Ur,Zr){var In=O(Ur),An=k(Zr);if(In!==ir||!m(yr,An)||m(vr,An)){var Zn=tr(In,An);return!Zn||!m(yr,An)||m(In,or)&&In[or][An]||(Zn.enumerable=!0),Zn}},Wr=function(Ur){var Zr=kt(O(Ur)),In=[];return lr(Zr,function(An){m(yr,An)||m(qe,An)||gr(In,An)}),In},Er=function(Ur){var Zr=Ur===ir,In=kt(Zr?vr:O(Ur)),An=[];return lr(In,function(Zn){!m(yr,Zn)||Zr&&!m(ir,Zn)||gr(An,yr[Zn])}),An};c||(Ve(Lt=(dr=function(){if(y(Lt,this))throw cr("Symbol is not a constructor");var Ur=arguments.length&&arguments[0]!==void 0?g(arguments[0]):void 0,Zr=Oe(Ur),In=function(An){this===ir&&i(In,vr,An),m(this,or)&&m(this[or],Zr)&&(this[or][Zr]=!1),Ar(this,Zr,v(1,An))};return d&&Mr&&Ar(ir,Zr,{configurable:!0,set:In}),Fr(Zr,Ur)}).prototype,"toString",function(){return nr(this).tag}),Ve(dr,"withoutSetter",function(Ur){return Fr(Oe(Ur),Ur)}),Ne.f=Sn,Ie.f=Dr,ie.f=Or,he.f=Rr,re.f=le.f=Wr,oe.f=Er,_e.f=function(Ur){return Fr($e(Ur),Ur)},d&&(At(Lt,"description",{configurable:!0,get:function(){return nr(this).description}}),a||Ve(ir,"propertyIsEnumerable",Sn,{unsafe:!0}))),r({global:!0,constructor:!0,wrap:!0,forced:!c,sham:!c},{Symbol:dr}),lr(L(Ir),function(Ur){er(Ur)}),r({target:"Symbol",stat:!0,forced:!c},{useSetter:function(){Mr=!0},useSimple:function(){Mr=!1}}),r({target:"Object",stat:!0,forced:!c,sham:!d},{create:function(Ur,Zr){return Zr===void 0?ue(Ur):Or(ue(Ur),Zr)},defineProperty:Dr,defineProperties:Or,getOwnPropertyDescriptor:Rr}),r({target:"Object",stat:!0,forced:!c},{getOwnPropertyNames:Wr}),Pt(),ar(dr,"Symbol"),qe[or]=!0},function(t,n,e){var r=e(165),s=e(67);t.exports=r?{}.toString:function(){return"[object "+s(this)+"]"}},function(t,n,e){var r=e(14),s=e(17),i=r.WeakMap;t.exports=s(i)&&/native code/.test(String(i))},function(t,n,e){var r=e(1),s=e(33),i=e(30),o=e(50),a=e(111),d=e(223),c=a("string-to-symbol-registry"),u=a("symbol-to-string-registry");r({target:"Symbol",stat:!0,forced:!d},{for:function(m){var y=o(m);if(i(c,y))return c[y];var S=s("Symbol")(y);return c[y]=S,u[S]=y,S}})},function(t,n,e){var r=e(1),s=e(30),i=e(129),o=e(81),a=e(111),d=e(223),c=a("symbol-to-string-registry");r({target:"Symbol",stat:!0,forced:!d},{keyFor:function(u){if(!i(u))throw TypeError(o(u)+" is not a symbol");if(s(c,u))return c[u]}})},function(t,n,e){var r=e(1),s=e(97),i=e(5),o=e(135),a=e(42);r({target:"Object",stat:!0,forced:!s||i(function(){o.f(1)})},{getOwnPropertySymbols:function(d){var c=o.f;return c?c(a(d)):[]}})},function(t,n,e){e(23)("asyncIterator")},function(t,n){},function(t,n,e){e(23)("hasInstance")},function(t,n,e){e(23)("isConcatSpreadable")},function(t,n,e){e(23)("match")},function(t,n,e){e(23)("matchAll")},function(t,n,e){e(23)("replace")},function(t,n,e){e(23)("search")},function(t,n,e){e(23)("species")},function(t,n,e){e(23)("split")},function(t,n,e){var r=e(33),s=e(23),i=e(85);s("toStringTag"),i(r("Symbol"),"Symbol")},function(t,n,e){e(23)("unscopables")},function(t,n,e){var r=e(14);e(85)(r.JSON,"JSON",!0)},function(t,n){},function(t,n){},function(t,n,e){var r=e(228).IteratorPrototype,s=e(84),i=e(80),o=e(85),a=e(103),d=function(){return this};t.exports=function(c,u,m,y){var S=u+" Iterator";return c.prototype=s(r,{next:i(+!y,m)}),o(c,S,!1,!0),a[S]=d,c}},function(t,n,e){var r=e(17),s=String,i=TypeError;t.exports=function(o){if(typeof o=="object"||r(o))return o;throw i("Can't set "+s(o)+" as a prototype")}},function(t,n){t.exports={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}},function(t,n,e){e(23)("dispose")},function(t,n,e){e(23)("asyncDispose")},function(t,n,e){e(23)("matcher")},function(t,n,e){e(23)("metadataKey")},function(t,n,e){e(23)("observable")},function(t,n,e){e(23)("metadata")},function(t,n,e){e(23)("patternMatch")},function(t,n,e){e(23)("replaceAll")},function(t,n,e){t.exports=e(366)},function(t,n,e){t.exports=e(367)},function(t,n,e){var r=e(368);t.exports=r},function(t,n,e){var r=e(369);t.exports=r},function(t,n,e){var r=e(370);e(69),t.exports=r},function(t,n,e){e(86),e(100),e(115),e(225);var r=e(136);t.exports=r.f("iterator")},function(t,n,e){var r=e(12),s=e(112),i=e(50),o=e(110),a=r("".charAt),d=r("".charCodeAt),c=r("".slice),u=function(m){return function(y,S){var O,k,g=i(o(y)),v=s(S),ue=g.length;return v<0||v>=ue?m?"":void 0:(O=d(g,v))<55296||O>56319||v+1===ue||(k=d(g,v+1))<56320||k>57343?m?a(g,v):O:m?c(g,v,v+2):k-56320+(O-55296<<10)+65536}};t.exports={codeAt:u(!1),charAt:u(!0)}},function(t,n,e){e(373);var r=e(13);t.exports=r.Array.isArray},function(t,n,e){e(1)({target:"Array",stat:!0},{isArray:e(83)})},function(t,n,e){var r=e(375);t.exports=r},function(t,n,e){e(376);var r=e(29);t.exports=r("Array").forEach},function(t,n,e){var r=e(1),s=e(377);r({target:"Array",proto:!0,forced:[].forEach!=s},{forEach:s})},function(t,n,e){var r=e(74).forEach,s=e(82)("forEach");t.exports=s?[].forEach:function(i){return r(this,i,arguments.length>1?arguments[1]:void 0)}},function(t,n,e){t.exports=e(379)},function(t,n,e){var r=e(380);t.exports=r},function(t,n,e){e(381);var r=e(13).Object;t.exports=function(s){return r.getOwnPropertyNames(s)}},function(t,n,e){var r=e(1),s=e(5),i=e(168).f;r({target:"Object",stat:!0,forced:s(function(){return!Object.getOwnPropertyNames(1)})},{getOwnPropertyNames:i})},function(t,n,e){e(383);var r=e(13);t.exports=r.Object.keys},function(t,n,e){var r=e(1),s=e(42),i=e(120);r({target:"Object",stat:!0,forced:e(5)(function(){i(1)})},{keys:function(o){return i(s(o))}})},function(t,n,e){var r=e(385);t.exports=r},function(t,n,e){e(224);var r=e(13),s=e(79);r.JSON||(r.JSON={stringify:JSON.stringify}),t.exports=function(i,o,a){return s(r.JSON.stringify,null,arguments)}},function(t,n,e){e(233),e(86),e(100),e(393),e(247),e(248),e(406),e(115);var r=e(13);t.exports=r.Promise},function(t,n,e){var r=e(1),s=e(19),i=e(137),o=e(138),a=e(388),d=e(84),c=e(61),u=e(80),m=e(389),y=e(390),S=e(47),O=e(391),k=e(21),g=e(392),v=k("toStringTag"),ue=Error,L=[].push,re=function(oe,he){var Ie,ie=arguments.length>2?arguments[2]:void 0,Ne=s(le,this);o?Ie=o(ue(),Ne?i(this):le):(Ie=Ne?this:d(le),c(Ie,v,"Error")),he!==void 0&&c(Ie,"message",O(he)),g&&c(Ie,"stack",m(Ie.stack,1)),y(Ie,ie);var Ve=[];return S(oe,L,{that:Ve}),c(Ie,"errors",Ve),Ie};o?o(re,ue):a(re,ue,{name:!0});var le=re.prototype=d(ue.prototype,{constructor:u(1,re),message:u(1,""),name:u(1,"AggregateError")});r({global:!0,constructor:!0,arity:2},{AggregateError:re})},function(t,n,e){var r=e(30),s=e(234),i=e(95),o=e(39);t.exports=function(a,d,c){for(var u=s(d),m=o.f,y=i.f,S=0;S<u.length;S++){var O=u[S];r(a,O)||c&&r(c,O)||m(a,O,y(d,O))}}},function(t,n,e){var r=e(12),s=Error,i=r("".replace),o=String(s("zxcasd").stack),a=/\n\s*at [^:]*:[^\n]*/,d=a.test(o);t.exports=function(c,u){if(d&&typeof c=="string"&&!s.prepareStackTrace)for(;u--;)c=i(c,a,"");return c}},function(t,n,e){var r=e(28),s=e(61);t.exports=function(i,o){r(o)&&"cause"in o&&s(i,"cause",o.cause)}},function(t,n,e){var r=e(50);t.exports=function(s,i){return s===void 0?arguments.length<2?"":i:r(s)}},function(t,n,e){var r=e(5),s=e(80);t.exports=!r(function(){var i=Error("a");return!("stack"in i)||(Object.defineProperty(i,"stack",s(1,7)),i.stack!==7)})},function(t,n,e){e(394),e(401),e(402),e(403),e(404),e(405)},function(t,n,e){var r,s,i,o=e(1),a=e(49),d=e(116),c=e(14),u=e(20),m=e(68),y=e(138),S=e(85),O=e(238),k=e(31),g=e(17),v=e(28),ue=e(171),L=e(239),re=e(240).set,le=e(395),oe=e(398),he=e(104),Ie=e(399),ie=e(101),Ne=e(105),Ve=e(117),Ce=e(70),Ue=Ve.CONSTRUCTOR,qe=Ve.REJECTION_EVENT,Oe=Ve.SUBCLASSING,$e=ie.getterFor("Promise"),_e=ie.set,er=Ne&&Ne.prototype,Pt=Ne,ar=er,pr=c.TypeError,lr=c.document,or=c.process,xe=Ce.f,nr=xe,ir=!!(lr&&lr.createEvent&&c.dispatchEvent),dr=function(vr){var Ir;return!(!v(vr)||!g(Ir=vr.then))&&Ir},Lt=function(vr,Ir){var Mr,Ar,Fr,Dr=Ir.value,Or=Ir.state==1,Sn=Or?vr.ok:vr.fail,Rr=vr.resolve,Wr=vr.reject,Er=vr.domain;try{Sn?(Or||(Ir.rejection===2&&kt(Ir),Ir.rejection=1),Sn===!0?Mr=Dr:(Er&&Er.enter(),Mr=Sn(Dr),Er&&(Er.exit(),Fr=!0)),Mr===vr.promise?Wr(pr("Promise-chain cycle")):(Ar=dr(Mr))?u(Ar,Mr,Rr,Wr):Rr(Mr)):Wr(Dr)}catch(Ur){Er&&!Fr&&Er.exit(),Wr(Ur)}},cr=function(vr,Ir){vr.notified||(vr.notified=!0,le(function(){for(var Mr,Ar=vr.reactions;Mr=Ar.get();)Lt(Mr,vr);vr.notified=!1,Ir&&!vr.rejection&&tr(vr)}))},mr=function(vr,Ir,Mr){var Ar,Fr;ir?((Ar=lr.createEvent("Event")).promise=Ir,Ar.reason=Mr,Ar.initEvent(vr,!1,!0),c.dispatchEvent(Ar)):Ar={promise:Ir,reason:Mr},!qe&&(Fr=c["on"+vr])?Fr(Ar):vr==="unhandledrejection"&&oe("Unhandled promise rejection",Mr)},tr=function(vr){u(re,c,function(){var Ir,Mr=vr.facade,Ar=vr.value;if(At(vr)&&(Ir=he(function(){d?or.emit("unhandledRejection",Ar,Mr):mr("unhandledrejection",Mr,Ar)}),vr.rejection=d||At(vr)?2:1,Ir.error))throw Ir.value})},At=function(vr){return vr.rejection!==1&&!vr.parent},kt=function(vr){u(re,c,function(){var Ir=vr.facade;d?or.emit("rejectionHandled",Ir):mr("rejectionhandled",Ir,vr.value)})},Dt=function(vr,Ir,Mr){return function(Ar){vr(Ir,Ar,Mr)}},gr=function(vr,Ir,Mr){vr.done||(vr.done=!0,Mr&&(vr=Mr),vr.value=Ir,vr.state=2,cr(vr,!0))},yr=function(vr,Ir,Mr){if(!vr.done){vr.done=!0,Mr&&(vr=Mr);try{if(vr.facade===Ir)throw pr("Promise can't be resolved itself");var Ar=dr(Ir);Ar?le(function(){var Fr={done:!1};try{u(Ar,Ir,Dt(yr,Fr,vr),Dt(gr,Fr,vr))}catch(Dr){gr(Fr,Dr,vr)}}):(vr.value=Ir,vr.state=1,cr(vr,!1))}catch(Fr){gr({done:!1},Fr,vr)}}};if(Ue&&(ar=(Pt=function(vr){ue(this,ar),k(vr),u(r,this);var Ir=$e(this);try{vr(Dt(yr,Ir),Dt(gr,Ir))}catch(Mr){gr(Ir,Mr)}}).prototype,(r=function(vr){_e(this,{type:"Promise",done:!1,notified:!1,parent:!1,reactions:new Ie,rejection:!1,state:0,value:void 0})}).prototype=m(ar,"then",function(vr,Ir){var Mr=$e(this),Ar=xe(L(this,Pt));return Mr.parent=!0,Ar.ok=!g(vr)||vr,Ar.fail=g(Ir)&&Ir,Ar.domain=d?or.domain:void 0,Mr.state==0?Mr.reactions.add(Ar):le(function(){Lt(Ar,Mr)}),Ar.promise}),s=function(){var vr=new r,Ir=$e(vr);this.promise=vr,this.resolve=Dt(yr,Ir),this.reject=Dt(gr,Ir)},Ce.f=xe=function(vr){return vr===Pt||vr===void 0?new s(vr):nr(vr)},!a&&g(Ne)&&er!==Object.prototype)){i=er.then,Oe||m(er,"then",function(vr,Ir){var Mr=this;return new Pt(function(Ar,Fr){u(i,Mr,Ar,Fr)}).then(vr,Ir)},{unsafe:!0});try{delete er.constructor}catch{}y&&y(er,ar)}o({global:!0,constructor:!0,wrap:!0,forced:Ue},{Promise:Pt}),S(Pt,"Promise",!1,!0),O("Promise")},function(t,n,e){var r,s,i,o,a,d,c,u,m=e(14),y=e(34),S=e(95).f,O=e(240).set,k=e(242),g=e(396),v=e(397),ue=e(116),L=m.MutationObserver||m.WebKitMutationObserver,re=m.document,le=m.process,oe=m.Promise,he=S(m,"queueMicrotask"),Ie=he&&he.value;Ie||(r=function(){var ie,Ne;for(ue&&(ie=le.domain)&&ie.exit();s;){Ne=s.fn,s=s.next;try{Ne()}catch(Ve){throw s?o():i=void 0,Ve}}i=void 0,ie&&ie.enter()},k||ue||v||!L||!re?!g&&oe&&oe.resolve?((c=oe.resolve(void 0)).constructor=oe,u=y(c.then,c),o=function(){u(r)}):ue?o=function(){le.nextTick(r)}:(O=y(O,m),o=function(){O(r)}):(a=!0,d=re.createTextNode(""),new L(r).observe(d,{characterData:!0}),o=function(){d.data=a=!a})),t.exports=Ie||function(ie){var Ne={fn:ie,next:void 0};i&&(i.next=Ne),s||(s=Ne,o()),i=Ne}},function(t,n,e){var r=e(66),s=e(14);t.exports=/ipad|iphone|ipod/i.test(r)&&s.Pebble!==void 0},function(t,n,e){var r=e(66);t.exports=/web0s(?!.*chrome)/i.test(r)},function(t,n,e){var r=e(14);t.exports=function(s,i){var o=r.console;o&&o.error&&(arguments.length==1?o.error(s):o.error(s,i))}},function(t,n){var e=function(){this.head=null,this.tail=null};e.prototype={add:function(r){var s={item:r,next:null};this.head?this.tail.next=s:this.head=s,this.tail=s},get:function(){var r=this.head;if(r)return this.head=r.next,this.tail===r&&(this.tail=null),r.item}},t.exports=e},function(t,n,e){var r=e(243),s=e(116);t.exports=!r&&!s&&typeof window=="object"&&typeof document=="object"},function(t,n,e){var r=e(1),s=e(20),i=e(31),o=e(70),a=e(104),d=e(47);r({target:"Promise",stat:!0,forced:e(244)},{all:function(c){var u=this,m=o.f(u),y=m.resolve,S=m.reject,O=a(function(){var k=i(u.resolve),g=[],v=0,ue=1;d(c,function(L){var re=v++,le=!1;ue++,s(k,u,L).then(function(oe){le||(le=!0,g[re]=oe,--ue||y(g))},S)}),--ue||y(g)});return O.error&&S(O.value),m.promise}})},function(t,n,e){var r=e(1),s=e(49),i=e(117).CONSTRUCTOR,o=e(105),a=e(33),d=e(17),c=e(68),u=o&&o.prototype;if(r({target:"Promise",proto:!0,forced:i,real:!0},{catch:function(y){return this.then(void 0,y)}}),!s&&d(o)){var m=a("Promise").prototype.catch;u.catch!==m&&c(u,"catch",m,{unsafe:!0})}},function(t,n,e){var r=e(1),s=e(20),i=e(31),o=e(70),a=e(104),d=e(47);r({target:"Promise",stat:!0,forced:e(244)},{race:function(c){var u=this,m=o.f(u),y=m.reject,S=a(function(){var O=i(u.resolve);d(c,function(k){s(O,u,k).then(m.resolve,y)})});return S.error&&y(S.value),m.promise}})},function(t,n,e){var r=e(1),s=e(20),i=e(70);r({target:"Promise",stat:!0,forced:e(117).CONSTRUCTOR},{reject:function(o){var a=i.f(this);return s(a.reject,void 0,o),a.promise}})},function(t,n,e){var r=e(1),s=e(33),i=e(49),o=e(105),a=e(117).CONSTRUCTOR,d=e(246),c=s("Promise"),u=i&&!a;r({target:"Promise",stat:!0,forced:i||a},{resolve:function(m){return d(u&&this===c?o:this,m)}})},function(t,n,e){var r=e(1),s=e(49),i=e(105),o=e(5),a=e(33),d=e(17),c=e(239),u=e(246),m=e(68),y=i&&i.prototype;if(r({target:"Promise",proto:!0,real:!0,forced:!!i&&o(function(){y.finally.call({then:function(){}},function(){})})},{finally:function(O){var k=c(this,a("Promise")),g=d(O);return this.then(g?function(v){return u(k,O()).then(function(){return v})}:O,g?function(v){return u(k,O()).then(function(){throw v})}:O)}}),!s&&d(i)){var S=a("Promise").prototype.finally;y.finally!==S&&m(y,"finally",S,{unsafe:!0})}},function(t,n,e){t.exports=e(408)},function(t,n,e){var r=e(409);t.exports=r},function(t,n,e){var r=e(249);t.exports=r},function(t,n,e){e(411);var r=e(13).Object,s=t.exports=function(i,o,a){return r.defineProperty(i,o,a)};r.defineProperty.sham&&(s.sham=!0)},function(t,n,e){var r=e(1),s=e(27),i=e(39).f;r({target:"Object",stat:!0,forced:Object.defineProperty!==i,sham:!s},{defineProperty:i})},function(t,n,e){var r=e(413),s=e(22).default;t.exports=function(i,o){if(s(i)!=="object"||i===null)return i;var a=i[r];if(a!==void 0){var d=a.call(i,o||"default");if(s(d)!=="object")return d;throw new TypeError("@@toPrimitive must return a primitive value.")}return(o==="string"?String:Number)(i)},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,n,e){t.exports=e(414)},function(t,n,e){t.exports=e(415)},function(t,n,e){var r=e(416);t.exports=r},function(t,n,e){var r=e(417);t.exports=r},function(t,n,e){var r=e(418);t.exports=r},function(t,n,e){e(419),e(226);var r=e(136);t.exports=r.f("toPrimitive")},function(t,n){},function(t,n,e){var r=e(19),s=e(421),i=Array.prototype;t.exports=function(o){var a=o.slice;return o===i||r(i,o)&&a===i.slice?s:a}},function(t,n,e){e(422);var r=e(29);t.exports=r("Array").slice},function(t,n,e){var r=e(1),s=e(83),i=e(132),o=e(28),a=e(131),d=e(46),c=e(44),u=e(99),m=e(21),y=e(113),S=e(102),O=y("slice"),k=m("species"),g=Array,v=Math.max;r({target:"Array",proto:!0,forced:!O},{slice:function(ue,L){var re,le,oe,he=c(this),Ie=d(he),ie=a(ue,Ie),Ne=a(L===void 0?Ie:L,Ie);if(s(he)&&(re=he.constructor,(i(re)&&(re===g||s(re.prototype))||o(re)&&(re=re[k])===null)&&(re=void 0),re===g||re===void 0))return S(he,ie,Ne);for(le=new(re===void 0?g:re)(v(Ne-ie,0)),oe=0;ie<Ne;ie++,oe++)ie in he&&u(le,oe,he[ie]);return le.length=oe,le}})},function(t,n,e){var r=e(424);t.exports=r},function(t,n,e){var r=e(19),s=e(425),i=Array.prototype;t.exports=function(o){var a=o.some;return o===i||r(i,o)&&a===i.some?s:a}},function(t,n,e){e(426);var r=e(29);t.exports=r("Array").some},function(t,n,e){var r=e(1),s=e(74).some;r({target:"Array",proto:!0,forced:!e(82)("some")},{some:function(i){return s(this,i,arguments.length>1?arguments[1]:void 0)}})},function(t,n,e){var r=e(428);t.exports=r},function(t,n,e){var r=e(19),s=e(429),i=Array.prototype;t.exports=function(o){var a=o.splice;return o===i||r(i,o)&&a===i.splice?s:a}},function(t,n,e){e(430);var r=e(29);t.exports=r("Array").splice},function(t,n,e){var r=e(1),s=e(42),i=e(131),o=e(112),a=e(46),d=e(431),c=e(214),u=e(164),m=e(99),y=e(252),S=e(113)("splice"),O=Math.max,k=Math.min;r({target:"Array",proto:!0,forced:!S},{splice:function(g,v){var ue,L,re,le,oe,he,Ie=s(this),ie=a(Ie),Ne=i(g,ie),Ve=arguments.length;for(Ve===0?ue=L=0:Ve===1?(ue=0,L=ie-Ne):(ue=Ve-2,L=k(O(o(v),0),ie-Ne)),c(ie+ue-L),re=u(Ie,L),le=0;le<L;le++)(oe=Ne+le)in Ie&&m(re,le,Ie[oe]);if(re.length=L,ue<L){for(le=Ne;le<ie-L;le++)he=le+ue,(oe=le+L)in Ie?Ie[he]=Ie[oe]:y(Ie,he);for(le=ie;le>ie-L+ue;le--)y(Ie,le-1)}else if(ue>L)for(le=ie-L;le>Ne;le--)he=le+ue-1,(oe=le+L-1)in Ie?Ie[he]=Ie[oe]:y(Ie,he);for(le=0;le<ue;le++)Ie[le+Ne]=arguments[le+2];return d(Ie,ie-L+ue),re}})},function(t,n,e){var r=e(27),s=e(83),i=TypeError,o=Object.getOwnPropertyDescriptor,a=r&&!function(){if(this!==void 0)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(d){return d instanceof TypeError}}();t.exports=a?function(d,c){if(s(d)&&!o(d,"length").writable)throw i("Cannot set read only .length");return d.length=c}:function(d,c){return d.length=c}},function(t,n,e){var r=e(433);t.exports=r},function(t,n,e){var r=e(19),s=e(434),i=Array.prototype;t.exports=function(o){var a=o.sort;return o===i||r(i,o)&&a===i.sort?s:a}},function(t,n,e){e(435);var r=e(29);t.exports=r("Array").sort},function(t,n,e){var r=e(1),s=e(12),i=e(31),o=e(42),a=e(46),d=e(252),c=e(50),u=e(5),m=e(436),y=e(82),S=e(437),O=e(438),k=e(98),g=e(439),v=[],ue=s(v.sort),L=s(v.push),re=u(function(){v.sort(void 0)}),le=u(function(){v.sort(null)}),oe=y("sort"),he=!u(function(){if(k)return k<70;if(!(S&&S>3)){if(O)return!0;if(g)return g<603;var Ie,ie,Ne,Ve,Ce="";for(Ie=65;Ie<76;Ie++){switch(ie=String.fromCharCode(Ie),Ie){case 66:case 69:case 70:case 72:Ne=3;break;case 68:case 71:Ne=4;break;default:Ne=2}for(Ve=0;Ve<47;Ve++)v.push({k:ie+Ve,v:Ne})}for(v.sort(function(Ue,qe){return qe.v-Ue.v}),Ve=0;Ve<v.length;Ve++)ie=v[Ve].k.charAt(0),Ce.charAt(Ce.length-1)!==ie&&(Ce+=ie);return Ce!=="DGBEFHACIJK"}});r({target:"Array",proto:!0,forced:re||!le||!oe||!he},{sort:function(Ie){Ie!==void 0&&i(Ie);var ie=o(this);if(he)return Ie===void 0?ue(ie):ue(ie,Ie);var Ne,Ve,Ce=[],Ue=a(ie);for(Ve=0;Ve<Ue;Ve++)Ve in ie&&L(Ce,ie[Ve]);for(m(Ce,function(qe){return function(Oe,$e){return $e===void 0?-1:Oe===void 0?1:qe!==void 0?+qe(Oe,$e)||0:c(Oe)>c($e)?1:-1}}(Ie)),Ne=a(Ce),Ve=0;Ve<Ne;)ie[Ve]=Ce[Ve++];for(;Ve<Ue;)d(ie,Ve++);return ie}})},function(t,n,e){var r=e(221),s=Math.floor,i=function(d,c){var u=d.length,m=s(u/2);return u<8?o(d,c):a(d,i(r(d,0,m),c),i(r(d,m),c),c)},o=function(d,c){for(var u,m,y=d.length,S=1;S<y;){for(m=S,u=d[S];m&&c(d[m-1],u)>0;)d[m]=d[--m];m!==S++&&(d[m]=u)}return d},a=function(d,c,u,m){for(var y=c.length,S=u.length,O=0,k=0;O<y||k<S;)d[O+k]=O<y&&k<S?m(c[O],u[k])<=0?c[O++]:u[k++]:O<y?c[O++]:u[k++];return d};t.exports=i},function(t,n,e){var r=e(66).match(/firefox\/(\d+)/i);t.exports=!!r&&+r[1]},function(t,n,e){var r=e(66);t.exports=/MSIE|Trident/.test(r)},function(t,n,e){var r=e(66).match(/AppleWebKit\/(\d+)\./);t.exports=!!r&&+r[1]},function(t,n,e){var r=e(441);t.exports=r},function(t,n,e){var r=e(19),s=e(442),i=Array.prototype;t.exports=function(o){var a=o.map;return o===i||r(i,o)&&a===i.map?s:a}},function(t,n,e){e(443);var r=e(29);t.exports=r("Array").map},function(t,n,e){var r=e(1),s=e(74).map;r({target:"Array",proto:!0,forced:!e(113)("map")},{map:function(i){return s(this,i,arguments.length>1?arguments[1]:void 0)}})},function(t,n,e){var r=e(445);t.exports=r},function(t,n,e){var r=e(19),s=e(446),i=Array.prototype;t.exports=function(o){var a=o.reduce;return o===i||r(i,o)&&a===i.reduce?s:a}},function(t,n,e){e(447);var r=e(29);t.exports=r("Array").reduce},function(t,n,e){var r=e(1),s=e(448).left,i=e(82),o=e(98),a=e(116);r({target:"Array",proto:!0,forced:!i("reduce")||!a&&o>79&&o<83},{reduce:function(d){var c=arguments.length;return s(this,d,c,c>1?arguments[1]:void 0)}})},function(t,n,e){var r=e(31),s=e(42),i=e(127),o=e(46),a=TypeError,d=function(c){return function(u,m,y,S){r(m);var O=s(u),k=i(O),g=o(O),v=c?g-1:0,ue=c?-1:1;if(y<2)for(;;){if(v in k){S=k[v],v+=ue;break}if(v+=ue,c?v<0:g<=v)throw a("Reduce of empty array with no initial value")}for(;c?v>=0:g>v;v+=ue)v in k&&(S=m(S,k[v],v,O));return S}};t.exports={left:d(!1),right:d(!0)}},function(t,n,e){var r=e(450);t.exports=r},function(t,n,e){var r=e(19),s=e(451),i=Array.prototype;t.exports=function(o){var a=o.lastIndexOf;return o===i||r(i,o)&&a===i.lastIndexOf?s:a}},function(t,n,e){e(452);var r=e(29);t.exports=r("Array").lastIndexOf},function(t,n,e){var r=e(1),s=e(453);r({target:"Array",proto:!0,forced:s!==[].lastIndexOf},{lastIndexOf:s})},function(t,n,e){var r=e(79),s=e(44),i=e(112),o=e(46),a=e(82),d=Math.min,c=[].lastIndexOf,u=!!c&&1/[1].lastIndexOf(1,-0)<0,m=a("lastIndexOf"),y=u||!m;t.exports=y?function(S){if(u)return r(c,this,arguments)||0;var O=s(this),k=o(O),g=k-1;for(arguments.length>1&&(g=d(g,i(arguments[1]))),g<0&&(g=k+g);g>=0;g--)if(g in O&&O[g]===S)return g||0;return-1}:c},function(t,n,e){e(253);var r=e(13);t.exports=r.setTimeout},function(t,n,e){var r=e(1),s=e(14),i=e(254)(s.setInterval,!0);r({global:!0,bind:!0,forced:s.setInterval!==i},{setInterval:i})},function(t,n){t.exports=typeof Bun=="function"&&Bun&&typeof Bun.version=="string"},function(t,n,e){var r=e(1),s=e(14),i=e(254)(s.setTimeout,!0);r({global:!0,bind:!0,forced:s.setTimeout!==i},{setTimeout:i})},function(t,n,e){var r=e(459);t.exports=r},function(t,n,e){var r=e(19),s=e(460),i=Array.prototype;t.exports=function(o){var a=o.filter;return o===i||r(i,o)&&a===i.filter?s:a}},function(t,n,e){e(461);var r=e(29);t.exports=r("Array").filter},function(t,n,e){var r=e(1),s=e(74).filter;r({target:"Array",proto:!0,forced:!e(113)("filter")},{filter:function(i){return s(this,i,arguments.length>1?arguments[1]:void 0)}})},function(t,n,e){t.exports=e(463)},function(t,n,e){e(69);var r=e(67),s=e(30),i=e(19),o=e(464),a=Array.prototype,d={DOMTokenList:!0,NodeList:!0};t.exports=function(c){var u=c.values;return c===a||i(a,c)&&u===a.values||s(d,r(c))?o:u}},function(t,n,e){var r=e(465);t.exports=r},function(t,n,e){e(86),e(100);var r=e(29);t.exports=r("Array").values},function(t,n,e){t.exports=e(467)},function(t,n,e){var r=e(468);t.exports=r},function(t,n,e){var r=e(19),s=e(469),i=Array.prototype;t.exports=function(o){var a=o.every;return o===i||r(i,o)&&a===i.every?s:a}},function(t,n,e){e(470);var r=e(29);t.exports=r("Array").every},function(t,n,e){var r=e(1),s=e(74).every;r({target:"Array",proto:!0,forced:!e(82)("every")},{every:function(i){return s(this,i,arguments.length>1?arguments[1]:void 0)}})},function(t,n,e){e(115),e(472);var r=e(13);t.exports=r.Array.from},function(t,n,e){var r=e(1),s=e(473);r({target:"Array",stat:!0,forced:!e(245)(function(i){Array.from(i)})},{from:s})},function(t,n,e){var r=e(34),s=e(20),i=e(42),o=e(474),a=e(235),d=e(132),c=e(46),u=e(99),m=e(236),y=e(139),S=Array;t.exports=function(O){var k=i(O),g=d(this),v=arguments.length,ue=v>1?arguments[1]:void 0,L=ue!==void 0;L&&(ue=r(ue,v>2?arguments[2]:void 0));var re,le,oe,he,Ie,ie,Ne=y(k),Ve=0;if(!Ne||this===S&&a(Ne))for(re=c(k),le=g?new this(re):S(re);re>Ve;Ve++)ie=L?ue(k[Ve],Ve):k[Ve],u(le,Ve,ie);else for(Ie=(he=m(k,Ne)).next,le=g?new this:[];!(oe=s(Ie,he)).done;Ve++)ie=L?o(he,ue,[oe.value,Ve],!0):oe.value,u(le,Ve,ie);return le.length=Ve,le}},function(t,n,e){var r=e(36),s=e(237);t.exports=function(i,o,a,d){try{return d?o(r(a)[0],a[1]):o(a)}catch(c){s(i,"throw",c)}}},function(t,n,e){t.exports=e(476)},function(t,n,e){var r=e(477);t.exports=r},function(t,n,e){var r=e(478);t.exports=r},function(t,n,e){var r=e(479);e(69),t.exports=r},function(t,n,e){e(86),e(115);var r=e(139);t.exports=r},function(t,n,e){e(220);var r=e(13);t.exports=r.Object.getOwnPropertySymbols},function(t,n,e){var r=e(482);t.exports=r},function(t,n,e){e(483);var r=e(13).Object,s=t.exports=function(i,o){return r.getOwnPropertyDescriptor(i,o)};r.getOwnPropertyDescriptor.sham&&(s.sham=!0)},function(t,n,e){var r=e(1),s=e(5),i=e(44),o=e(95).f,a=e(27),d=s(function(){o(1)});r({target:"Object",stat:!0,forced:!a||d,sham:!a},{getOwnPropertyDescriptor:function(c,u){return o(i(c),u)}})},function(t,n,e){var r=e(485);t.exports=r},function(t,n,e){e(486);var r=e(13);t.exports=r.Object.getOwnPropertyDescriptors},function(t,n,e){var r=e(1),s=e(27),i=e(234),o=e(44),a=e(95),d=e(99);r({target:"Object",stat:!0,sham:!s},{getOwnPropertyDescriptors:function(c){for(var u,m,y=o(c),S=a.f,O=i(y),k={},g=0;O.length>g;)(m=S(y,u=O[g++]))!==void 0&&d(k,u,m);return k}})},function(t,n,e){var r=e(488);t.exports=r},function(t,n,e){e(489);var r=e(13).Object,s=t.exports=function(i,o){return r.defineProperties(i,o)};r.defineProperties.sham&&(s.sham=!0)},function(t,n,e){var r=e(1),s=e(27),i=e(166).f;r({target:"Object",stat:!0,forced:Object.defineProperties!==i,sham:!s},{defineProperties:i})},function(t,n,e){var r=e(11);typeof window<"u"&&(window.console||r.isWeixinApp||(window.console={log:function(){},info:function(){},warn:function(){},error:function(){}}))},function(t,n,e){var r=e(492),s=e(521),i=e(261),o=e(523),a=e(532),d=e(535),c=e(536),u=e(537),m=e(539),y=e(540),S=e(541),O=e(183),k=e(545),g=e(546),v=e(552),ue=e(177),L=e(264),re=e(554),le=e(91),oe=e(556),he=e(176),Ie=e(181),ie={};ie["[object Arguments]"]=ie["[object Array]"]=ie["[object ArrayBuffer]"]=ie["[object DataView]"]=ie["[object Boolean]"]=ie["[object Date]"]=ie["[object Float32Array]"]=ie["[object Float64Array]"]=ie["[object Int8Array]"]=ie["[object Int16Array]"]=ie["[object Int32Array]"]=ie["[object Map]"]=ie["[object Number]"]=ie["[object Object]"]=ie["[object RegExp]"]=ie["[object Set]"]=ie["[object String]"]=ie["[object Symbol]"]=ie["[object Uint8Array]"]=ie["[object Uint8ClampedArray]"]=ie["[object Uint16Array]"]=ie["[object Uint32Array]"]=!0,ie["[object Error]"]=ie["[object Function]"]=ie["[object WeakMap]"]=!1,t.exports=function Ne(Ve,Ce,Ue,qe,Oe,$e){var _e,er=1&Ce,Pt=2&Ce,ar=4&Ce;if(Ue&&(_e=Oe?Ue(Ve,qe,Oe,$e):Ue(Ve)),_e!==void 0)return _e;if(!le(Ve))return Ve;var pr=ue(Ve);if(pr){if(_e=k(Ve),!er)return c(Ve,_e)}else{var lr=O(Ve),or=lr=="[object Function]"||lr=="[object GeneratorFunction]";if(L(Ve))return d(Ve,er);if(lr=="[object Object]"||lr=="[object Arguments]"||or&&!Oe){if(_e=Pt||or?{}:v(Ve),!er)return Pt?m(Ve,a(_e,Ve)):u(Ve,o(_e,Ve))}else{if(!ie[lr])return Oe?Ve:{};_e=g(Ve,lr,er)}}$e||($e=new r);var xe=$e.get(Ve);if(xe)return xe;$e.set(Ve,_e),oe(Ve)?Ve.forEach(function(ir){_e.add(Ne(ir,Ce,Ue,ir,Ve,$e))}):re(Ve)&&Ve.forEach(function(ir,dr){_e.set(dr,Ne(ir,Ce,Ue,dr,Ve,$e))});var nr=pr?void 0:(ar?Pt?S:y:Pt?Ie:he)(Ve);return s(nr||Ve,function(ir,dr){nr&&(ir=Ve[dr=ir]),i(_e,dr,Ne(ir,Ce,Ue,dr,Ve,$e))}),_e}},function(t,n,e){var r=e(142),s=e(498),i=e(499),o=e(500),a=e(501),d=e(502);function c(u){var m=this.__data__=new r(u);this.size=m.size}c.prototype.clear=s,c.prototype.delete=i,c.prototype.get=o,c.prototype.has=a,c.prototype.set=d,t.exports=c},function(t,n){t.exports=function(){this.__data__=[],this.size=0}},function(t,n,e){var r=e(143),s=Array.prototype.splice;t.exports=function(i){var o=this.__data__,a=r(o,i);return!(a<0)&&(a==o.length-1?o.pop():s.call(o,a,1),--this.size,!0)}},function(t,n,e){var r=e(143);t.exports=function(s){var i=this.__data__,o=r(i,s);return o<0?void 0:i[o][1]}},function(t,n,e){var r=e(143);t.exports=function(s){return r(this.__data__,s)>-1}},function(t,n,e){var r=e(143);t.exports=function(s,i){var o=this.__data__,a=r(o,s);return a<0?(++this.size,o.push([s,i])):o[a][1]=i,this}},function(t,n,e){var r=e(142);t.exports=function(){this.__data__=new r,this.size=0}},function(t,n){t.exports=function(e){var r=this.__data__,s=r.delete(e);return this.size=r.size,s}},function(t,n){t.exports=function(e){return this.__data__.get(e)}},function(t,n){t.exports=function(e){return this.__data__.has(e)}},function(t,n,e){var r=e(142),s=e(174),i=e(260);t.exports=function(o,a){var d=this.__data__;if(d instanceof r){var c=d.__data__;if(!s||c.length<199)return c.push([o,a]),this.size=++d.size,this;d=this.__data__=new i(c)}return d.set(o,a),this.size=d.size,this}},function(t,n,e){var r=e(257),s=e(506),i=e(91),o=e(259),a=/^\[object .+?Constructor\]$/,d=Function.prototype,c=Object.prototype,u=d.toString,m=c.hasOwnProperty,y=RegExp("^"+u.call(m).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");t.exports=function(S){return!(!i(S)||s(S))&&(r(S)?y:a).test(o(S))}},function(t,n,e){var r=e(175),s=Object.prototype,i=s.hasOwnProperty,o=s.toString,a=r?r.toStringTag:void 0;t.exports=function(d){var c=i.call(d,a),u=d[a];try{d[a]=void 0;var m=!0}catch{}var y=o.call(d);return m&&(c?d[a]=u:delete d[a]),y}},function(t,n){var e=Object.prototype.toString;t.exports=function(r){return e.call(r)}},function(t,n,e){var r,s=e(507),i=(r=/[^.]+$/.exec(s&&s.keys&&s.keys.IE_PROTO||""))?"Symbol(src)_1."+r:"";t.exports=function(o){return!!i&&i in o}},function(t,n,e){var r=e(56)["__core-js_shared__"];t.exports=r},function(t,n){t.exports=function(e,r){return e==null?void 0:e[r]}},function(t,n,e){var r=e(510),s=e(142),i=e(174);t.exports=function(){this.size=0,this.__data__={hash:new r,map:new(i||s),string:new r}}},function(t,n,e){var r=e(511),s=e(512),i=e(513),o=e(514),a=e(515);function d(c){var u=-1,m=c==null?0:c.length;for(this.clear();++u<m;){var y=c[u];this.set(y[0],y[1])}}d.prototype.clear=r,d.prototype.delete=s,d.prototype.get=i,d.prototype.has=o,d.prototype.set=a,t.exports=d},function(t,n,e){var r=e(144);t.exports=function(){this.__data__=r?r(null):{},this.size=0}},function(t,n){t.exports=function(e){var r=this.has(e)&&delete this.__data__[e];return this.size-=r?1:0,r}},function(t,n,e){var r=e(144),s=Object.prototype.hasOwnProperty;t.exports=function(i){var o=this.__data__;if(r){var a=o[i];return a==="__lodash_hash_undefined__"?void 0:a}return s.call(o,i)?o[i]:void 0}},function(t,n,e){var r=e(144),s=Object.prototype.hasOwnProperty;t.exports=function(i){var o=this.__data__;return r?o[i]!==void 0:s.call(o,i)}},function(t,n,e){var r=e(144);t.exports=function(s,i){var o=this.__data__;return this.size+=this.has(s)?0:1,o[s]=r&&i===void 0?"__lodash_hash_undefined__":i,this}},function(t,n,e){var r=e(145);t.exports=function(s){var i=r(this,s).delete(s);return this.size-=i?1:0,i}},function(t,n){t.exports=function(e){var r=typeof e;return r=="string"||r=="number"||r=="symbol"||r=="boolean"?e!=="__proto__":e===null}},function(t,n,e){var r=e(145);t.exports=function(s){return r(this,s).get(s)}},function(t,n,e){var r=e(145);t.exports=function(s){return r(this,s).has(s)}},function(t,n,e){var r=e(145);t.exports=function(s,i){var o=r(this,s),a=o.size;return o.set(s,i),this.size+=o.size==a?0:1,this}},function(t,n){t.exports=function(e,r){for(var s=-1,i=e==null?0:e.length;++s<i&&r(e[s],s,e)!==!1;);return e}},function(t,n,e){var r=e(87),s=function(){try{var i=r(Object,"defineProperty");return i({},"",{}),i}catch{}}();t.exports=s},function(t,n,e){var r=e(146),s=e(176);t.exports=function(i,o){return i&&r(o,s(o),i)}},function(t,n){t.exports=function(e,r){for(var s=-1,i=Array(e);++s<e;)i[s]=r(s);return i}},function(t,n,e){var r=e(526),s=e(106),i=Object.prototype,o=i.hasOwnProperty,a=i.propertyIsEnumerable,d=r(function(){return arguments}())?r:function(c){return s(c)&&o.call(c,"callee")&&!a.call(c,"callee")};t.exports=d},function(t,n,e){var r=e(124),s=e(106);t.exports=function(i){return s(i)&&r(i)=="[object Arguments]"}},function(t,n){t.exports=function(){return!1}},function(t,n,e){var r=e(529),s=e(178),i=e(179),o=i&&i.isTypedArray,a=o?s(o):r;t.exports=a},function(t,n,e){var r=e(124),s=e(265),i=e(106),o={};o["[object Float32Array]"]=o["[object Float64Array]"]=o["[object Int8Array]"]=o["[object Int16Array]"]=o["[object Int32Array]"]=o["[object Uint8Array]"]=o["[object Uint8ClampedArray]"]=o["[object Uint16Array]"]=o["[object Uint32Array]"]=!0,o["[object Arguments]"]=o["[object Array]"]=o["[object ArrayBuffer]"]=o["[object Boolean]"]=o["[object DataView]"]=o["[object Date]"]=o["[object Error]"]=o["[object Function]"]=o["[object Map]"]=o["[object Number]"]=o["[object Object]"]=o["[object RegExp]"]=o["[object Set]"]=o["[object String]"]=o["[object WeakMap]"]=!1,t.exports=function(a){return i(a)&&s(a.length)&&!!o[r(a)]}},function(t,n,e){var r=e(180),s=e(531),i=Object.prototype.hasOwnProperty;t.exports=function(o){if(!r(o))return s(o);var a=[];for(var d in Object(o))i.call(o,d)&&d!="constructor"&&a.push(d);return a}},function(t,n,e){var r=e(266)(Object.keys,Object);t.exports=r},function(t,n,e){var r=e(146),s=e(181);t.exports=function(i,o){return i&&r(o,s(o),i)}},function(t,n,e){var r=e(91),s=e(180),i=e(534),o=Object.prototype.hasOwnProperty;t.exports=function(a){if(!r(a))return i(a);var d=s(a),c=[];for(var u in a)(u!="constructor"||!d&&o.call(a,u))&&c.push(u);return c}},function(t,n){t.exports=function(e){var r=[];if(e!=null)for(var s in Object(e))r.push(s);return r}},function(t,n,e){(function(r){var s=e(56),i=n&&!n.nodeType&&n,o=i&&typeof r=="object"&&r&&!r.nodeType&&r,a=o&&o.exports===i?s.Buffer:void 0,d=a?a.allocUnsafe:void 0;r.exports=function(c,u){if(u)return c.slice();var m=c.length,y=d?d(m):new c.constructor(m);return c.copy(y),y}}).call(this,e(147)(t))},function(t,n){t.exports=function(e,r){var s=-1,i=e.length;for(r||(r=Array(i));++s<i;)r[s]=e[s];return r}},function(t,n,e){var r=e(146),s=e(182);t.exports=function(i,o){return r(i,s(i),o)}},function(t,n){t.exports=function(e,r){for(var s=-1,i=e==null?0:e.length,o=0,a=[];++s<i;){var d=e[s];r(d,s,e)&&(a[o++]=d)}return a}},function(t,n,e){var r=e(146),s=e(268);t.exports=function(i,o){return r(i,s(i),o)}},function(t,n,e){var r=e(271),s=e(182),i=e(176);t.exports=function(o){return r(o,i,s)}},function(t,n,e){var r=e(271),s=e(268),i=e(181);t.exports=function(o){return r(o,i,s)}},function(t,n,e){var r=e(87)(e(56),"DataView");t.exports=r},function(t,n,e){var r=e(87)(e(56),"Promise");t.exports=r},function(t,n,e){var r=e(87)(e(56),"WeakMap");t.exports=r},function(t,n){var e=Object.prototype.hasOwnProperty;t.exports=function(r){var s=r.length,i=new r.constructor(s);return s&&typeof r[0]=="string"&&e.call(r,"index")&&(i.index=r.index,i.input=r.input),i}},function(t,n,e){var r=e(184),s=e(548),i=e(549),o=e(550),a=e(551);t.exports=function(d,c,u){var m=d.constructor;switch(c){case"[object ArrayBuffer]":return r(d);case"[object Boolean]":case"[object Date]":return new m(+d);case"[object DataView]":return s(d,u);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return a(d,u);case"[object Map]":return new m;case"[object Number]":case"[object String]":return new m(d);case"[object RegExp]":return i(d);case"[object Set]":return new m;case"[object Symbol]":return o(d)}}},function(t,n,e){var r=e(56).Uint8Array;t.exports=r},function(t,n,e){var r=e(184);t.exports=function(s,i){var o=i?r(s.buffer):s.buffer;return new s.constructor(o,s.byteOffset,s.byteLength)}},function(t,n){var e=/\w*$/;t.exports=function(r){var s=new r.constructor(r.source,e.exec(r));return s.lastIndex=r.lastIndex,s}},function(t,n,e){var r=e(175),s=r?r.prototype:void 0,i=s?s.valueOf:void 0;t.exports=function(o){return i?Object(i.call(o)):{}}},function(t,n,e){var r=e(184);t.exports=function(s,i){var o=i?r(s.buffer):s.buffer;return new s.constructor(o,s.byteOffset,s.length)}},function(t,n,e){var r=e(553),s=e(270),i=e(180);t.exports=function(o){return typeof o.constructor!="function"||i(o)?{}:r(s(o))}},function(t,n,e){var r=e(91),s=Object.create,i=function(){function o(){}return function(a){if(!r(a))return{};if(s)return s(a);o.prototype=a;var d=new o;return o.prototype=void 0,d}}();t.exports=i},function(t,n,e){var r=e(555),s=e(178),i=e(179),o=i&&i.isMap,a=o?s(o):r;t.exports=a},function(t,n,e){var r=e(183),s=e(106);t.exports=function(i){return s(i)&&r(i)=="[object Map]"}},function(t,n,e){var r=e(557),s=e(178),i=e(179),o=i&&i.isSet,a=o?s(o):r;t.exports=a},function(t,n,e){var r=e(183),s=e(106);t.exports=function(i){return s(i)&&r(i)=="[object Set]"}},function(t,n,e){var r=e(2),s=e(4),i=e(7),o=e(71),a=e(8),d=e(15),c=e(6),u=e(3),m=e(64),y=e(0),S=e(11),O=e(45),k={};function g(){var oe=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};!oe.logLevel&&oe.debug&&(oe.logLevel="debug"),y.merge(this,{options:oe,debugEnable:!1,api:"log",style:"color:blue;",logLevel:oe.logLevel&&oe.logLevel.toLowerCase()||"off",debug:y.emptyFunc,log:y.emptyFunc,info:y.emptyFunc,warn:y.emptyFunc,error:y.emptyFunc}),this.prefix=oe.prefix||"",this.localEnable=k.enable&&oe.dbLog&&oe.account,this.setDebug(oe.debug),this.localEnable&&(this._local=new k(oe.account,oe.expire),this._local.logError=this.error)}k=e(567);var v=g.prototype,ue=["Chrome","Safari","Firefox"],L={debug:1e3,log:2e3,info:3e3,warn:4e3,error:5e3,off:6e3};function re(oe){var he,Ie=[];return r(he=s(L)).call(he,function(ie){L[ie]>=L[oe]&&Ie.push(ie)}),Ie}v.setDebug=function(){var oe=arguments.length>0&&arguments[0]!==void 0&&arguments[0],he=this;if(he.debugEnable=oe||he.logLevel==="debug",oe.style&&(he.style=oe.style),y.exist(console)){if(he.logLevel!=="off"){var Ie=console,ie=re(he.logLevel);r(ie).call(ie,function(Ve){he[Ve]=function(){var Ce=he.formatArgsAndSave(arguments,Ve);i(ue).call(ue,m.name)!==-1&&y.isString(Ce[0])&&(Ce[0]="%c"+Ce[0],o(Ce).call(Ce,1,0,he.style)),he._log(Ve,Ce)}}),he.options.logFunc?he._log=function(){}:he._log=function(Ve,Ce){if(Ve==="debug"&&(Ve="log"),Ie[Ve])try{Ie[Ve].apply?he.chrome(Ve,Ce):he.ie(Ve,Ce)}catch{}},he.chrome=function(Ve,Ce){i(ue).call(ue,m.name)!==-1?Ie[Ve].apply(Ie,Ce):he.ie(Ve,Ce)},he.ie=function(Ve,Ce){r(Ce).call(Ce,function(Ue){Ie[Ve](a(Ue,null,4))})}}else if(S.isRN||this.localEnable||this.options.logFunc){var Ne=!S.isRN&&!this.localEnable;he.log=function(){he.formatArgsAndSave(arguments,"log",Ne)},he.info=function(){he.formatArgsAndSave(arguments,"info",Ne)},he.warn=function(){he.formatArgsAndSave(arguments,"warn",Ne)},he.error=function(){he.formatArgsAndSave(arguments,"error",Ne)},he.debug=function(){he.formatArgsAndSave(arguments,"log",Ne)}}}},v.destroy=function(){this.localEnable=!1,this.log=function(){},this.info=function(){},this.warn=function(){},this.error=function(){},this.debug=function(){},this._local&&this._local.destroy()},v.formatArgsAndSave=function(oe,he,Ie){var ie,Ne;oe=d([]).call(oe,0);var Ve=new Date,Ce=le(Ve.getMonth()+1)+"-"+le(Ve.getDate())+" "+le(Ve.getHours())+":"+le(Ve.getMinutes())+":"+le(Ve.getSeconds())+":"+le(Ve.getMilliseconds(),3),Ue=c(ie=c(Ne="[NIM ".concat(he.toUpperCase()," ")).call(Ne,Ce," ")).call(ie,this.prefix.toUpperCase(),"]  "),qe="";y.isString(oe[0])?oe[0]=Ue+oe[0]:o(oe).call(oe,0,0,Ue),r(oe).call(oe,function($e,_e){y.isArray($e)||y.isObject($e)?(oe[_e]=y.simpleClone($e),qe+=a(oe[_e])+" "):qe+=$e+" "});var Oe=this.options.logFunc;return Oe&&y.isFunction(Oe[he])&&Oe[he].apply(Oe,oe),!Ie&&this.writeLocalLog(qe,he,+Ve),oe},v.writeLocalLog=function(oe,he,Ie){return S.isRN?this.writeLocalLogRN(oe,he,Ie):S.isBrowser?this.writeLocalLogBrowser(oe,he,Ie):void 0};var le=function(oe,he){he=he||2;for(var Ie=""+oe;Ie.length<he;)Ie="0"+Ie;return Ie};v.writeLocalLogBrowser=function(oe,he,Ie){this._local&&this._local.saveLog({log:oe,level:he,time:Ie})},v.writeLocalLogRN=function(oe,he){if(O.rnfs&&O.rnfs.writeFile&&O.rnfs.appendFile&&O.rnfs.DocumentDirectoryPath&&/error|warn|info/.test(he)){var Ie,ie=O.rnfs,Ne=ie.size/2-256;oe+=`\r
`,ie.nimPromise=ie.nimPromise.then(function(){return Ie=Ve(ie.nimIndex),ie.exists(Ie)}).then(function(Ce){return Ce?ie.appendFile(Ie,oe):ie.writeFile(Ie,oe)}).then(function(){return ie.stat(Ie)}).then(function(Ce){if(Ce.size>Ne)return ie.nimIndex++,ie.nimIndex>1&&(ie.nimIndex=ie.nimIndex%2),ie.unlink(Ve(ie.nimIndex)).catch(function(){return u.resolve()})}).catch(function(){})}function Ve(Ce){return O.rnfs.DocumentDirectoryPath+"/nimlog_"+Ce+".log"}},t.exports=g},function(t,n,e){var r=e(560);t.exports=r},function(t,n,e){e(561);var r=e(13);t.exports=r.parseFloat},function(t,n,e){var r=e(1),s=e(562);r({global:!0,forced:parseFloat!=s},{parseFloat:s})},function(t,n,e){var r=e(14),s=e(5),i=e(12),o=e(50),a=e(185).trim,d=e(148),c=i("".charAt),u=r.parseFloat,m=r.Symbol,y=m&&m.iterator,S=1/u(d+"-0")!=-1/0||y&&!s(function(){u(Object(y))});t.exports=S?function(O){var k=a(o(O)),g=u(k);return g===0&&c(k,0)=="-"?-0:g}:u},function(t,n,e){var r=e(564);t.exports=r},function(t,n,e){e(565);var r=e(13);t.exports=r.parseInt},function(t,n,e){var r=e(1),s=e(566);r({global:!0,forced:parseInt!=s},{parseInt:s})},function(t,n,e){var r=e(14),s=e(5),i=e(12),o=e(50),a=e(185).trim,d=e(148),c=r.parseInt,u=r.Symbol,m=u&&u.iterator,y=/^[+-]?0x/i,S=i(y.exec),O=c(d+"08")!==8||c(d+"0x16")!==22||m&&!s(function(){c(Object(m))});t.exports=O?function(k,g){var v=a(o(k));return c(v,g>>>0||(S(y,v)?16:10))}:c},function(t,n,e){var r=e(15),s=e(24),i=e(3),o=e(568),a=e(569),d=e(0).getGlobal(),c=e(64).name,u=typeof o=="function",m=d.indexedDB&&!/^(IE)$/.test(c);function y(O,k){this.logWorker=null,this.db=null,this.logQueue=[],this.callbackList=[],this.preTime=null,this.lastTime=+new Date,this.saveLogTimer=void 0,this.initLogLocal({name:O,expire:k})}var S=y.prototype;y.enable=!0,S.saveLog=function(O){var k=this;try{if(!y.enable)return;var g,v=this.logQueue.length,ue=this.logQueue[v-1];if(O.time===this.preTime&&ue)return void(ue.log+=`\r
`+O.log);this.logQueue.length>50||O.time-this.lastTime>3e3&&this.logQueue.length>0?(this.doSaveLog(r(g=this.logQueue).call(g,0)),this.lastTime=ue.time,this.logQueue=[],clearTimeout(this.saveLogTimer)):(clearTimeout(this.saveLogTimer),this.saveLogTimer=s(function(){var L;k.logQueue.length>0&&(ue=k.logQueue[k.logQueue.length-1],k.doSaveLog(r(L=k.logQueue).call(L,0)),k.lastTime=ue.time,k.logQueue=[])},3e3-(O.time-this.lastTime))),this.logQueue.push(O),this.preTime=O.time}catch(L){console.error("saveLog Error",L)}},S.destroy=function(){if(this.logQueue.length>0){var O,k=this.logQueue[this.logQueue.length-1];this.doSaveLog(r(O=this.logQueue).call(O,0)),this.lastTime=k.time,this.logQueue=[]}clearTimeout(this.saveLogTimer)},S.doSaveLog=function(){},S.initLogLocal=function(){},S.fetchLog=function(){},S.deleteLogs=function(){},S.logError=function(){},m?u?(S.doSaveLog=function(O){this.logWorker.postMessage(O)},S.initLogLocal=function(O){var k=this;this.logWorker=new o({}),this.logWorker.onmessage=function(g){var v=g.data||{};switch(v.type){case"fetchDone":k.fetchLogDone(v.code,v.msg);break;case"error":k.logError(v.msg)}},this.logWorker.postMessage({type:"init",msg:O})},S.fetchLog=function(){var O=this;return new i(function(k,g){O.callbackList.length===0&&O.logWorker.postMessage({type:"fetch"}),O.callbackList.push(k),O.callbackList.push(g)})},S.fetchLogDone=function(O,k){for(var g=O===200?0:1,v=0;v<this.callbackList.length/2;v++)this.callbackList[2*v+g](k);this.callbackList=[]},S.deleteLogs=function(O){return this.logWorker.postMessage({type:"delete",msg:O}),i.resolve()}):(S.doSaveLog=function(O){var k=this;this.db.putLog(O).catch(function(g){k.logError({msg:"putLog error",error:g})})},S.initLogLocal=function(O){var k=this;this.db=new a(O),this.db.init().catch(function(g){k.logError({msg:"dbLog init error",error:g})})},S.fetchLog=function(){return this.db.getAllLogs()},S.deleteLogs=function(O){return this.db.deleteLogs(O)}):y.enable=!1,t.exports=y},function(t,n,e){e.r(n),e.d(n,"default",function(){return i});var r=e(298),s=e.n(r);function i(){return s()(`/*!
 * 
 * VERSION: 9.14.4
 * Git Hash: 98d1c9786af772ff439f12534089825e2c3c6776
 * 
 * Create At: 2024/2/23 下午3:43:35
 * 
 * Target: NIM_Web_log.worker
 */!function(t){var n={};function r(e){if(n[e])return n[e].exports;var o=n[e]={i:e,l:!1,exports:{}};return t[e].call(o.exports,o,o.exports,r),o.l=!0,o.exports}r.m=t,r.c=n,r.d=function(t,n,e){r.o(t,n)||Object.defineProperty(t,n,{enumerable:!0,get:e})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,n){if(1&n&&(t=r(t)),8&n)return t;if(4&n&&"object"==typeof t&&t&&t.__esModule)return t;var e=Object.create(null);if(r.r(e),Object.defineProperty(e,"default",{enumerable:!0,value:t}),2&n&&"string"!=typeof t)for(var o in t)r.d(e,o,function(n){return t[n]}.bind(null,o));return e},r.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(n,"a",n),n},r.o=function(t,n){return Object.prototype.hasOwnProperty.call(t,n)},r.p="",r(r.s=109)}([function(t,n,r){"use strict";var e=r(1),o=r(41),i=r(78),c=r(2),u=r(43).f,a=r(84),f=r(13),s=r(34),p=r(19),l=r(8),v=function(t){var n=function(r,e,i){if(this instanceof n){switch(arguments.length){case 0:return new t;case 1:return new t(r);case 2:return new t(r,e)}return new t(r,e,i)}return o(t,this,arguments)};return n.prototype=t.prototype,n};t.exports=function(t,n){var r,o,d,y,h,m,g,x,b,w=t.target,S=t.global,j=t.stat,O=t.proto,P=S?e:j?e[w]:(e[w]||{}).prototype,T=S?f:f[w]||p(f,w,{})[w],A=T.prototype;for(y in n)o=!(r=a(S?y:w+(j?".":"#")+y,t.forced))&&P&&l(P,y),m=T[y],o&&(g=t.dontCallGetSet?(b=u(P,y))&&b.value:P[y]),h=o&&g?g:n[y],o&&typeof m==typeof h||(x=t.bind&&o?s(h,e):t.wrap&&o?v(h):O&&c(h)?i(h):h,(t.sham||h&&h.sham||m&&m.sham)&&p(x,"sham",!0),p(T,y,x),O&&(l(f,d=w+"Prototype")||p(f,d,{}),p(f[d],y,h),t.real&&A&&(r||!A[y])&&p(A,y,h)))}},function(t,n,r){(function(n){var r=function(t){return t&&t.Math==Math&&t};t.exports=r("object"==typeof globalThis&&globalThis)||r("object"==typeof window&&window)||r("object"==typeof self&&self)||r("object"==typeof n&&n)||function(){return this}()||Function("return this")()}).call(this,r(77))},function(t,n,r){var e=r(79),o=e.all;t.exports=e.IS_HTMLDDA?function(t){return"function"==typeof t||t===o}:function(t){return"function"==typeof t}},function(t,n,r){var e=r(13),o=r(8),i=r(75),c=r(16).f;t.exports=function(t){var n=e.Symbol||(e.Symbol={});o(n,t)||c(n,t,{value:i.f(t)})}},function(t,n,r){var e=r(1),o=r(33),i=r(8),c=r(60),u=r(24),a=r(82),f=o("wks"),s=e.Symbol,p=s&&s.for,l=a?s:s&&s.withoutSetter||c;t.exports=function(t){if(!i(f,t)||!u&&"string"!=typeof f[t]){var n="Symbol."+t;u&&i(s,t)?f[t]=s[t]:f[t]=a&&p?p(n):l(n)}return f[t]}},function(t,n){t.exports=function(t){try{return!!t()}catch(t){return!0}}},function(t,n,r){var e=r(42),o=Function.prototype,i=o.call,c=e&&o.bind.bind(i,i);t.exports=e?c:function(t){return function(){return i.apply(t,arguments)}}},function(t,n,r){var e=r(42),o=Function.prototype.call;t.exports=e?o.bind(o):function(){return o.apply(o,arguments)}},function(t,n,r){var e=r(6),o=r(25),i=e({}.hasOwnProperty);t.exports=Object.hasOwn||function(t,n){return i(o(t),n)}},function(t,n,r){var e=r(13),o=r(1),i=r(2),c=function(t){return i(t)?t:void 0};t.exports=function(t,n){return arguments.length<2?c(e[t])||c(o[t]):e[t]&&e[t][n]||o[t]&&o[t][n]}},function(t,n,r){var e=r(2),o=r(79),i=o.all;t.exports=o.IS_HTMLDDA?function(t){return"object"==typeof t?null!==t:e(t)||t===i}:function(t){return"object"==typeof t?null!==t:e(t)}},function(t,n,r){var e=r(5);t.exports=!e((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]}))},function(t,n,r){var e=r(10),o=String,i=TypeError;t.exports=function(t){if(e(t))return t;throw i(o(t)+" is not an object")}},function(t,n){t.exports={}},function(t,n,r){var e=r(6);t.exports=e({}.isPrototypeOf)},function(t,n){t.exports=!0},function(t,n,r){var e=r(11),o=r(83),i=r(85),c=r(12),u=r(45),a=TypeError,f=Object.defineProperty,s=Object.getOwnPropertyDescriptor;n.f=e?i?function(t,n,r){if(c(t),n=u(n),c(r),"function"==typeof t&&"prototype"===n&&"value"in r&&"writable"in r&&!r.writable){var e=s(t,n);e&&e.writable&&(t[n]=r.value,r={configurable:"configurable"in r?r.configurable:e.configurable,enumerable:"enumerable"in r?r.enumerable:e.enumerable,writable:!1})}return f(t,n,r)}:f:function(t,n,r){if(c(t),n=u(n),c(r),o)try{return f(t,n,r)}catch(t){}if("get"in r||"set"in r)throw a("Accessors not supported");return"value"in r&&(t[n]=r.value),t}},function(t,n,r){var e=r(2),o=r(32),i=TypeError;t.exports=function(t){if(e(t))return t;throw i(o(t)+" is not a function")}},function(t,n,r){var e=r(81),o=r(57);t.exports=function(t){return e(o(t))}},function(t,n,r){var e=r(11),o=r(16),i=r(20);t.exports=e?function(t,n,r){return o.f(t,n,i(1,r))}:function(t,n,r){return t[n]=r,t}},function(t,n){t.exports=function(t,n){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:n}}},function(t,n,r){var e=r(19);t.exports=function(t,n,r,o){return o&&o.enumerable?t[n]=r:e(t,n,r),t}},function(t,n,r){"use strict";var e=r(17),o=TypeError,i=function(t){var n,r;this.promise=new t((function(t,e){if(void 0!==n||void 0!==r)throw o("Bad Promise constructor");n=t,r=e})),this.resolve=e(n),this.reject=e(r)};t.exports.f=function(t){return new i(t)}},function(t,n,r){var e=r(6),o=e({}.toString),i=e("".slice);t.exports=function(t){return i(o(t),8,-1)}},function(t,n,r){var e=r(47),o=r(5);t.exports=!!Object.getOwnPropertySymbols&&!o((function(){var t=Symbol();return!String(t)||!(Object(t)instanceof Symbol)||!Symbol.sham&&e&&e<41}))},function(t,n,r){var e=r(57),o=Object;t.exports=function(t){return o(e(t))}},function(t,n,r){var e=r(124);t.exports=function(t){return e(t.length)}},function(t,n){t.exports={}},function(t,n,r){var e=r(70),o=r(2),i=r(23),c=r(4)("toStringTag"),u=Object,a="Arguments"==i(function(){return arguments}());t.exports=e?i:function(t){var n,r,e;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(r=function(t,n){try{return t[n]}catch(t){}}(n=u(t),c))?r:a?i(n):"Object"==(e=i(n))&&o(n.callee)?"Arguments":e}},function(t,n,r){var e=r(70),o=r(16).f,i=r(19),c=r(8),u=r(136),a=r(4)("toStringTag");t.exports=function(t,n,r,f){if(t){var s=r?t:t.prototype;c(s,a)||o(s,a,{configurable:!0,value:n}),f&&!e&&i(s,"toString",u)}}},function(t,n,r){var e=r(1);t.exports=e.Promise},function(t,n,r){var e=r(9);t.exports=e("navigator","userAgent")||""},function(t,n){var r=String;t.exports=function(t){try{return r(t)}catch(t){return"Object"}}},function(t,n,r){var e=r(15),o=r(59);(t.exports=function(t,n){return o[t]||(o[t]=void 0!==n?n:{})})("versions",[]).push({version:"3.27.1",mode:e?"pure":"global",copyright:"© 2014-2022 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.27.1/LICENSE",source:"https://github.com/zloirock/core-js"})},function(t,n,r){var e=r(78),o=r(17),i=r(42),c=e(e.bind);t.exports=function(t,n){return o(t),void 0===n?t:i?c(t,n):function(){return t.apply(n,arguments)}}},function(t,n,r){var e=r(34),o=r(7),i=r(12),c=r(32),u=r(127),a=r(26),f=r(14),s=r(128),p=r(89),l=r(129),v=TypeError,d=function(t,n){this.stopped=t,this.result=n},y=d.prototype;t.exports=function(t,n,r){var h,m,g,x,b,w,S,j=r&&r.that,O=!(!r||!r.AS_ENTRIES),P=!(!r||!r.IS_RECORD),T=!(!r||!r.IS_ITERATOR),A=!(!r||!r.INTERRUPTED),E=e(n,j),k=function(t){return h&&l(h,"normal",t),new d(!0,t)},I=function(t){return O?(i(t),A?E(t[0],t[1],k):E(t[0],t[1])):A?E(t,k):E(t)};if(P)h=t.iterator;else if(T)h=t;else{if(!(m=p(t)))throw v(c(t)+" is not iterable");if(u(m)){for(g=0,x=a(t);x>g;g++)if((b=I(t[g]))&&f(y,b))return b;return new d(!1)}h=s(t,m)}for(w=P?t.next:h.next;!(S=o(w,h)).done;){try{b=I(S.value)}catch(t){l(h,"throw",t)}if("object"==typeof b&&b&&f(y,b))return b}return new d(!1)}},function(t,n,r){var e=r(28),o=String;t.exports=function(t){if("Symbol"===e(t))throw TypeError("Cannot convert a Symbol value to a string");return o(t)}},function(t,n){t.exports=function(t){try{return{error:!1,value:t()}}catch(t){return{error:!0,value:t}}}},function(t,n,r){var e=r(1),o=r(30),i=r(2),c=r(84),u=r(94),a=r(4),f=r(147),s=r(98),p=r(15),l=r(47),v=o&&o.prototype,d=a("species"),y=!1,h=i(e.PromiseRejectionEvent),m=c("Promise",(function(){var t=u(o),n=t!==String(o);if(!n&&66===l)return!0;if(p&&(!v.catch||!v.finally))return!0;if(!l||l<51||!/native code/.test(t)){var r=new o((function(t){t(1)})),e=function(t){t((function(){}),(function(){}))};if((r.constructor={})[d]=e,!(y=r.then((function(){}))instanceof e))return!0}return!n&&(f||s)&&!h}));t.exports={CONSTRUCTOR:m,REJECTION_EVENT:h,SUBCLASSING:y}},function(t,n,r){var e=r(23);t.exports=Array.isArray||function(t){return"Array"==e(t)}},function(t,n,r){var e=r(13);t.exports=function(t){return e[t+"Prototype"]}},function(t,n,r){var e=r(42),o=Function.prototype,i=o.apply,c=o.call;t.exports="object"==typeof Reflect&&Reflect.apply||(e?c.bind(i):function(){return c.apply(i,arguments)})},function(t,n,r){var e=r(5);t.exports=!e((function(){var t=function(){}.bind();return"function"!=typeof t||t.hasOwnProperty("prototype")}))},function(t,n,r){var e=r(11),o=r(7),i=r(80),c=r(20),u=r(18),a=r(45),f=r(8),s=r(83),p=Object.getOwnPropertyDescriptor;n.f=e?p:function(t,n){if(t=u(t),n=a(n),s)try{return p(t,n)}catch(t){}if(f(t,n))return c(!o(i.f,t,n),t[n])}},function(t,n){t.exports=function(t){return null==t}},function(t,n,r){var e=r(115),o=r(46);t.exports=function(t){var n=e(t,"string");return o(n)?n:n+""}},function(t,n,r){var e=r(9),o=r(2),i=r(14),c=r(82),u=Object;t.exports=c?function(t){return"symbol"==typeof t}:function(t){var n=e("Symbol");return o(n)&&i(n.prototype,u(t))}},function(t,n,r){var e,o,i=r(1),c=r(31),u=i.process,a=i.Deno,f=u&&u.versions||a&&a.version,s=f&&f.v8;s&&(o=(e=s.split("."))[0]>0&&e[0]<4?1:+(e[0]+e[1])),!o&&c&&(!(e=c.match(/Edge\\/(\\d+)/))||e[1]>=74)&&(e=c.match(/Chrome\\/(\\d+)/))&&(o=+e[1]),t.exports=o},function(t,n,r){var e=r(33),o=r(60),i=e("keys");t.exports=function(t){return i[t]||(i[t]=o(t))}},function(t,n){t.exports={}},function(t,n,r){var e,o=r(12),i=r(87),c=r(67),u=r(49),a=r(88),f=r(61),s=r(48),p=s("IE_PROTO"),l=function(){},v=function(t){return"<script>"+t+"<\\/script>"},d=function(t){t.write(v("")),t.close();var n=t.parentWindow.Object;return t=null,n},y=function(){try{e=new ActiveXObject("htmlfile")}catch(t){}var t,n;y="undefined"!=typeof document?document.domain&&e?d(e):((n=f("iframe")).style.display="none",a.appendChild(n),n.src=String("javascript:"),(t=n.contentWindow.document).open(),t.write(v("document.F=Object")),t.close(),t.F):d(e);for(var r=c.length;r--;)delete y.prototype[c[r]];return y()};u[p]=!0,t.exports=Object.create||function(t,n){var r;return null!==t?(l.prototype=o(t),r=new l,l.prototype=null,r[p]=t):r=y(),void 0===n?r:i.f(r,n)}},function(t,n,r){var e,o,i,c=r(133),u=r(1),a=r(10),f=r(19),s=r(8),p=r(59),l=r(48),v=r(49),d=u.TypeError,y=u.WeakMap;if(c||p.state){var h=p.state||(p.state=new y);h.get=h.get,h.has=h.has,h.set=h.set,e=function(t,n){if(h.has(t))throw d("Object already initialized");return n.facade=t,h.set(t,n),n},o=function(t){return h.get(t)||{}},i=function(t){return h.has(t)}}else{var m=l("state");v[m]=!0,e=function(t,n){if(s(t,m))throw d("Object already initialized");return n.facade=t,f(t,m,n),n},o=function(t){return s(t,m)?t[m]:{}},i=function(t){return s(t,m)}}t.exports={set:e,get:o,has:i,enforce:function(t){return i(t)?o(t):e(t,{})},getterFor:function(t){return function(n){var r;if(!a(n)||(r=o(n)).type!==t)throw d("Incompatible receiver, "+t+" required");return r}}}},function(t,n,r){var e=r(23),o=r(1);t.exports="process"==e(o.process)},function(t,n,r){var e=r(6);t.exports=e([].slice)},function(t,n,r){r(71);var e=r(158),o=r(1),i=r(28),c=r(19),u=r(27),a=r(4)("toStringTag");for(var f in e){var s=o[f],p=s&&s.prototype;p&&i(p)!==a&&c(p,a,f),u[f]=u.Array}},function(t,n,r){var e=r(5),o=r(4),i=r(47),c=o("species");t.exports=function(t){return i>=51||!e((function(){var n=[];return(n.constructor={})[c]=function(){return{foo:1}},1!==n[t](Boolean).foo}))}},function(t,n,r){var e=r(34),o=r(6),i=r(81),c=r(25),u=r(26),a=r(103),f=o([].push),s=function(t){var n=1==t,r=2==t,o=3==t,s=4==t,p=6==t,l=7==t,v=5==t||p;return function(d,y,h,m){for(var g,x,b=c(d),w=i(b),S=e(y,h),j=u(w),O=0,P=m||a,T=n?P(d,j):r||l?P(d,0):void 0;j>O;O++)if((v||O in w)&&(x=S(g=w[O],O,b),t))if(n)T[O]=x;else if(x)switch(t){case 3:return!0;case 5:return g;case 6:return O;case 2:f(T,g)}else switch(t){case 4:return!1;case 7:f(T,g)}return p?-1:o||s?s:T}};t.exports={forEach:s(0),map:s(1),filter:s(2),some:s(3),every:s(4),find:s(5),findIndex:s(6),filterReject:s(7)}},function(t,n,r){var e=r(44),o=TypeError;t.exports=function(t){if(e(t))throw o("Can't call method on "+t);return t}},function(t,n,r){var e=r(17),o=r(44);t.exports=function(t,n){var r=t[n];return o(r)?void 0:e(r)}},function(t,n,r){var e=r(1),o=r(117),i=e["__core-js_shared__"]||o("__core-js_shared__",{});t.exports=i},function(t,n,r){var e=r(6),o=0,i=Math.random(),c=e(1..toString);t.exports=function(t){return"Symbol("+(void 0===t?"":t)+")_"+c(++o+i,36)}},function(t,n,r){var e=r(1),o=r(10),i=e.document,c=o(i)&&o(i.createElement);t.exports=function(t){return c?i.createElement(t):{}}},function(t,n,r){var e=r(8),o=r(2),i=r(25),c=r(48),u=r(118),a=c("IE_PROTO"),f=Object,s=f.prototype;t.exports=u?f.getPrototypeOf:function(t){var n=i(t);if(e(n,a))return n[a];var r=n.constructor;return o(r)&&n instanceof r?r.prototype:n instanceof f?s:null}},function(t,n,r){var e=r(6),o=r(12),i=r(119);t.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var t,n=!1,r={};try{(t=e(Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set))(r,[]),n=r instanceof Array}catch(t){}return function(r,e){return o(r),i(e),n?t(r,e):r.__proto__=e,r}}():void 0)},function(t,n,r){var e=r(86),o=r(67).concat("length","prototype");n.f=Object.getOwnPropertyNames||function(t){return e(t,o)}},function(t,n,r){var e=r(66),o=Math.max,i=Math.min;t.exports=function(t,n){var r=e(t);return r<0?o(r+n,0):i(r,n)}},function(t,n,r){var e=r(123);t.exports=function(t){var n=+t;return n!=n||0===n?0:e(n)}},function(t,n){t.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},function(t,n){n.f=Object.getOwnPropertySymbols},function(t,n,r){var e=r(86),o=r(67);t.exports=Object.keys||function(t){return e(t,o)}},function(t,n,r){var e={};e[r(4)("toStringTag")]="z",t.exports="[object z]"===String(e)},function(t,n,r){"use strict";var e=r(18),o=r(132),i=r(27),c=r(51),u=r(16).f,a=r(90),f=r(92),s=r(15),p=r(11),l=c.set,v=c.getterFor("Array Iterator");t.exports=a(Array,"Array",(function(t,n){l(this,{type:"Array Iterator",target:e(t),index:0,kind:n})}),(function(){var t=v(this),n=t.target,r=t.kind,e=t.index++;return!n||e>=n.length?(t.target=void 0,f(void 0,!0)):f("keys"==r?e:"values"==r?n[e]:[e,n[e]],!1)}),"values");var d=i.Arguments=i.Array;if(o("keys"),o("values"),o("entries"),!s&&p&&"values"!==d.name)try{u(d,"name",{value:"values"})}catch(t){}},function(t,n){},function(t,n,r){var e=r(6),o=r(5),i=r(2),c=r(28),u=r(9),a=r(94),f=function(){},s=[],p=u("Reflect","construct"),l=/^\\s*(?:class|function)\\b/,v=e(l.exec),d=!l.exec(f),y=function(t){if(!i(t))return!1;try{return p(f,s,t),!0}catch(t){return!1}},h=function(t){if(!i(t))return!1;switch(c(t)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return d||!!v(l,a(t))}catch(t){return!0}};h.sham=!0,t.exports=!p||o((function(){var t;return y(y.call)||!y(Object)||!y((function(){t=!0}))||t}))?h:y},function(t,n,r){"use strict";var e=r(45),o=r(16),i=r(20);t.exports=function(t,n,r){var c=e(n);c in t?o.f(t,c,i(0,r)):t[c]=r}},function(t,n,r){var e=r(4);n.f=e},function(t,n,r){t.exports=r(111)},function(t,n){var r;r=function(){return this}();try{r=r||new Function("return this")()}catch(t){"object"==typeof window&&(r=window)}t.exports=r},function(t,n,r){var e=r(23),o=r(6);t.exports=function(t){if("Function"===e(t))return o(t)}},function(t,n){var r="object"==typeof document&&document.all,e=void 0===r&&void 0!==r;t.exports={all:r,IS_HTMLDDA:e}},function(t,n,r){"use strict";var e={}.propertyIsEnumerable,o=Object.getOwnPropertyDescriptor,i=o&&!e.call({1:2},1);n.f=i?function(t){var n=o(this,t);return!!n&&n.enumerable}:e},function(t,n,r){var e=r(6),o=r(5),i=r(23),c=Object,u=e("".split);t.exports=o((function(){return!c("z").propertyIsEnumerable(0)}))?function(t){return"String"==i(t)?u(t,""):c(t)}:c},function(t,n,r){var e=r(24);t.exports=e&&!Symbol.sham&&"symbol"==typeof Symbol.iterator},function(t,n,r){var e=r(11),o=r(5),i=r(61);t.exports=!e&&!o((function(){return 7!=Object.defineProperty(i("div"),"a",{get:function(){return 7}}).a}))},function(t,n,r){var e=r(5),o=r(2),i=/#|\\.prototype\\./,c=function(t,n){var r=a[u(t)];return r==s||r!=f&&(o(n)?e(n):!!n)},u=c.normalize=function(t){return String(t).replace(i,".").toLowerCase()},a=c.data={},f=c.NATIVE="N",s=c.POLYFILL="P";t.exports=c},function(t,n,r){var e=r(11),o=r(5);t.exports=e&&o((function(){return 42!=Object.defineProperty((function(){}),"prototype",{value:42,writable:!1}).prototype}))},function(t,n,r){var e=r(6),o=r(8),i=r(18),c=r(122).indexOf,u=r(49),a=e([].push);t.exports=function(t,n){var r,e=i(t),f=0,s=[];for(r in e)!o(u,r)&&o(e,r)&&a(s,r);for(;n.length>f;)o(e,r=n[f++])&&(~c(s,r)||a(s,r));return s}},function(t,n,r){var e=r(11),o=r(85),i=r(16),c=r(12),u=r(18),a=r(69);n.f=e&&!o?Object.defineProperties:function(t,n){c(t);for(var r,e=u(n),o=a(n),f=o.length,s=0;f>s;)i.f(t,r=o[s++],e[r]);return t}},function(t,n,r){var e=r(9);t.exports=e("document","documentElement")},function(t,n,r){var e=r(28),o=r(58),i=r(44),c=r(27),u=r(4)("iterator");t.exports=function(t){if(!i(t))return o(t,u)||o(t,"@@iterator")||c[e(t)]}},function(t,n,r){"use strict";var e=r(0),o=r(7),i=r(15),c=r(134),u=r(2),a=r(135),f=r(62),s=r(63),p=r(29),l=r(19),v=r(21),d=r(4),y=r(27),h=r(91),m=c.PROPER,g=c.CONFIGURABLE,x=h.IteratorPrototype,b=h.BUGGY_SAFARI_ITERATORS,w=d("iterator"),S=function(){return this};t.exports=function(t,n,r,c,d,h,j){a(r,n,c);var O,P,T,A=function(t){if(t===d&&L)return L;if(!b&&t in I)return I[t];switch(t){case"keys":case"values":case"entries":return function(){return new r(this,t)}}return function(){return new r(this)}},E=n+" Iterator",k=!1,I=t.prototype,D=I[w]||I["@@iterator"]||d&&I[d],L=!b&&D||A(d),_="Array"==n&&I.entries||D;if(_&&(O=f(_.call(new t)))!==Object.prototype&&O.next&&(i||f(O)===x||(s?s(O,x):u(O[w])||v(O,w,S)),p(O,E,!0,!0),i&&(y[E]=S)),m&&"values"==d&&D&&"values"!==D.name&&(!i&&g?l(I,"name","values"):(k=!0,L=function(){return o(D,this)})),d)if(P={values:A("values"),keys:h?L:A("keys"),entries:A("entries")},j)for(T in P)(b||k||!(T in I))&&v(I,T,P[T]);else e({target:n,proto:!0,forced:b||k},P);return i&&!j||I[w]===L||v(I,w,L,{name:d}),y[n]=L,P}},function(t,n,r){"use strict";var e,o,i,c=r(5),u=r(2),a=r(10),f=r(50),s=r(62),p=r(21),l=r(4),v=r(15),d=l("iterator"),y=!1;[].keys&&("next"in(i=[].keys())?(o=s(s(i)))!==Object.prototype&&(e=o):y=!0),!a(e)||c((function(){var t={};return e[d].call(t)!==t}))?e={}:v&&(e=f(e)),u(e[d])||p(e,d,(function(){return this})),t.exports={IteratorPrototype:e,BUGGY_SAFARI_ITERATORS:y}},function(t,n){t.exports=function(t,n){return{value:t,done:n}}},function(t,n,r){var e=r(12),o=r(141),i=r(44),c=r(4)("species");t.exports=function(t,n){var r,u=e(t).constructor;return void 0===u||i(r=e(u)[c])?n:o(r)}},function(t,n,r){var e=r(6),o=r(2),i=r(59),c=e(Function.toString);o(i.inspectSource)||(i.inspectSource=function(t){return c(t)}),t.exports=i.inspectSource},function(t,n,r){var e,o,i,c,u=r(1),a=r(41),f=r(34),s=r(2),p=r(8),l=r(5),v=r(88),d=r(53),y=r(61),h=r(96),m=r(97),g=r(52),x=u.setImmediate,b=u.clearImmediate,w=u.process,S=u.Dispatch,j=u.Function,O=u.MessageChannel,P=u.String,T=0,A={};try{e=u.location}catch(t){}var E=function(t){if(p(A,t)){var n=A[t];delete A[t],n()}},k=function(t){return function(){E(t)}},I=function(t){E(t.data)},D=function(t){u.postMessage(P(t),e.protocol+"//"+e.host)};x&&b||(x=function(t){h(arguments.length,1);var n=s(t)?t:j(t),r=d(arguments,1);return A[++T]=function(){a(n,void 0,r)},o(T),T},b=function(t){delete A[t]},g?o=function(t){w.nextTick(k(t))}:S&&S.now?o=function(t){S.now(k(t))}:O&&!m?(c=(i=new O).port2,i.port1.onmessage=I,o=f(c.postMessage,c)):u.addEventListener&&s(u.postMessage)&&!u.importScripts&&e&&"file:"!==e.protocol&&!l(D)?(o=D,u.addEventListener("message",I,!1)):o="onreadystatechange"in y("script")?function(t){v.appendChild(y("script")).onreadystatechange=function(){v.removeChild(this),E(t)}}:function(t){setTimeout(k(t),0)}),t.exports={set:x,clear:b}},function(t,n){var r=TypeError;t.exports=function(t,n){if(t<n)throw r("Not enough arguments");return t}},function(t,n,r){var e=r(31);t.exports=/(?:ipad|iphone|ipod).*applewebkit/i.test(e)},function(t,n){t.exports="object"==typeof Deno&&Deno&&"object"==typeof Deno.version},function(t,n,r){var e=r(30),o=r(149),i=r(38).CONSTRUCTOR;t.exports=i||!o((function(t){e.all(t).then(void 0,(function(){}))}))},function(t,n,r){var e=r(12),o=r(10),i=r(22);t.exports=function(t,n){if(e(t),o(n)&&n.constructor===t)return n;var r=i.f(t);return(0,r.resolve)(n),r.promise}},function(t,n,r){"use strict";var e=r(157).charAt,o=r(36),i=r(51),c=r(90),u=r(92),a=i.set,f=i.getterFor("String Iterator");c(String,"String",(function(t){a(this,{type:"String Iterator",string:o(t),index:0})}),(function(){var t,n=f(this),r=n.string,o=n.index;return o>=r.length?u(void 0,!0):(t=e(r,o),n.index+=t.length,u(t,!1))}))},function(t,n,r){t.exports=r(159)},function(t,n,r){var e=r(168);t.exports=function(t,n){return new(e(t))(0===n?0:n)}},function(t,n,r){"use strict";var e=r(0),o=r(5),i=r(39),c=r(10),u=r(25),a=r(26),f=r(177),s=r(74),p=r(103),l=r(55),v=r(4),d=r(47),y=v("isConcatSpreadable"),h=d>=51||!o((function(){var t=[];return t[y]=!1,t.concat()[0]!==t})),m=l("concat"),g=function(t){if(!c(t))return!1;var n=t[y];return void 0!==n?!!n:i(t)};e({target:"Array",proto:!0,arity:1,forced:!h||!m},{concat:function(t){var n,r,e,o,i,c=u(this),l=p(c,0),v=0;for(n=-1,e=arguments.length;n<e;n++)if(g(i=-1===n?c:arguments[n]))for(o=a(i),f(v+o),r=0;r<o;r++,v++)r in i&&s(l,v,i[r]);else f(v+1),s(l,v++,i);return l.length=v,l}})},function(t,n,r){var e=r(7),o=r(9),i=r(4),c=r(21);t.exports=function(){var t=o("Symbol"),n=t&&t.prototype,r=n&&n.valueOf,u=i("toPrimitive");n&&!n[u]&&c(n,u,(function(t){return e(r,this)}),{arity:1})}},function(t,n,r){var e=r(24);t.exports=e&&!!Symbol.for&&!!Symbol.keyFor},function(t,n,r){r(3)("iterator")},function(t,n,r){"use strict";var e,o=r(1),i=r(41),c=r(2),u=r(220),a=r(31),f=r(53),s=r(96),p=o.Function,l=/MSIE .\\./.test(a)||u&&((e=o.Bun.version.split(".")).length<3||0==e[0]&&(e[1]<3||3==e[1]&&0==e[2]));t.exports=function(t,n){var r=n?2:1;return l?function(e,o){var u=s(arguments.length,1)>r,a=c(e)?e:p(e),l=u?f(arguments,r):[],v=u?function(){i(a,this,l)}:a;return n?t(v,o):t(v)}:t}},function(t,n,r){var e=r(110),o=null;function i(t){return t&&"string"!=typeof t?t.message?t.message:t.target&&t.target.error?t.target.error.message:"unknown error":t}self.onmessage=function(t){switch(t.data.type){case"init":r=t.data.msg,(o=new e(r)).init().catch((function(t){postMessage({type:"error",msg:{msg:"dbLog init error",error:i(t)}})}));break;case"fetch":o.getAllLogs().then((function(t){postMessage({type:"fetchDone",code:200,msg:t})})).catch((function(t){postMessage({type:"fetchDone",code:500,msg:i(t)})}));break;case"delete":o.deleteLogs(n).catch((function(t){postMessage({type:"deleteLogs",code:500,msg:i(t)})}));break;default:!function(t){if(!o)return;o.putLog(t).then((function(){postMessage(200)})).catch((function(t){postMessage({type:"error",msg:{msg:"putLog error",error:i(t)}})}))}(t.data)}var n,r}},function(t,n,r){var e=r(76),o=r(102),i=r(163),c=r(169),u={log:{key:{keyPath:"time"},indexes:{level:{unique:!1},time:{unique:!0}}}};function a(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.server=null,this.expire=t.expire||72,this.name=t.name}var f=a.prototype;f.init=function(){var t=this;if(!this.server)return c.open({server:"nim-log-"+this.name,version:1,schema:u}).then((function(n){t.server=n}))},f.putLog=function(t){var n=this;if(!this.server)return e.reject("no db server");var r=o(t).call(t,-1)[0].time-36e5*this.expire;return this.deleteLogs(r).then((function(){return n.server.add("log",t)}))},f.getAllLogs=function(){return this.server?this.server.query("log","time").all().execute().then((function(t){var n={},r=o(t).call(t,-1)[0];return n.logs=i(t).call(t,(function(t){return t.log})).join("\\r\\n"),n.time=r&&r.time,n})):e.reject("no db server")},f.deleteLogs=function(t){return this.server?this.server.remove("log",null,"time",0,t):e.reject("no db server")},t.exports=a},function(t,n,r){var e=r(112);r(54),t.exports=e},function(t,n,r){r(113),r(71),r(72),r(137),r(154),r(155),r(156),r(101);var e=r(13);t.exports=e.Promise},function(t,n,r){r(114)},function(t,n,r){"use strict";var e=r(0),o=r(14),i=r(62),c=r(63),u=r(120),a=r(50),f=r(19),s=r(20),p=r(125),l=r(126),v=r(35),d=r(130),y=r(4),h=r(131),m=y("toStringTag"),g=Error,x=[].push,b=function(t,n){var r,e=arguments.length>2?arguments[2]:void 0,u=o(w,this);c?r=c(g(),u?i(this):w):(r=u?this:a(w),f(r,m,"Error")),void 0!==n&&f(r,"message",d(n)),h&&f(r,"stack",p(r.stack,1)),l(r,e);var s=[];return v(t,x,{that:s}),f(r,"errors",s),r};c?c(b,g):u(b,g,{name:!0});var w=b.prototype=a(g.prototype,{constructor:s(1,b),message:s(1,""),name:s(1,"AggregateError")});e({global:!0,constructor:!0,arity:2},{AggregateError:b})},function(t,n,r){var e=r(7),o=r(10),i=r(46),c=r(58),u=r(116),a=r(4),f=TypeError,s=a("toPrimitive");t.exports=function(t,n){if(!o(t)||i(t))return t;var r,a=c(t,s);if(a){if(void 0===n&&(n="default"),r=e(a,t,n),!o(r)||i(r))return r;throw f("Can't convert object to primitive value")}return void 0===n&&(n="number"),u(t,n)}},function(t,n,r){var e=r(7),o=r(2),i=r(10),c=TypeError;t.exports=function(t,n){var r,u;if("string"===n&&o(r=t.toString)&&!i(u=e(r,t)))return u;if(o(r=t.valueOf)&&!i(u=e(r,t)))return u;if("string"!==n&&o(r=t.toString)&&!i(u=e(r,t)))return u;throw c("Can't convert object to primitive value")}},function(t,n,r){var e=r(1),o=Object.defineProperty;t.exports=function(t,n){try{o(e,t,{value:n,configurable:!0,writable:!0})}catch(r){e[t]=n}return n}},function(t,n,r){var e=r(5);t.exports=!e((function(){function t(){}return t.prototype.constructor=null,Object.getPrototypeOf(new t)!==t.prototype}))},function(t,n,r){var e=r(2),o=String,i=TypeError;t.exports=function(t){if("object"==typeof t||e(t))return t;throw i("Can't set "+o(t)+" as a prototype")}},function(t,n,r){var e=r(8),o=r(121),i=r(43),c=r(16);t.exports=function(t,n,r){for(var u=o(n),a=c.f,f=i.f,s=0;s<u.length;s++){var p=u[s];e(t,p)||r&&e(r,p)||a(t,p,f(n,p))}}},function(t,n,r){var e=r(9),o=r(6),i=r(64),c=r(68),u=r(12),a=o([].concat);t.exports=e("Reflect","ownKeys")||function(t){var n=i.f(u(t)),r=c.f;return r?a(n,r(t)):n}},function(t,n,r){var e=r(18),o=r(65),i=r(26),c=function(t){return function(n,r,c){var u,a=e(n),f=i(a),s=o(c,f);if(t&&r!=r){for(;f>s;)if((u=a[s++])!=u)return!0}else for(;f>s;s++)if((t||s in a)&&a[s]===r)return t||s||0;return!t&&-1}};t.exports={includes:c(!0),indexOf:c(!1)}},function(t,n){var r=Math.ceil,e=Math.floor;t.exports=Math.trunc||function(t){var n=+t;return(n>0?e:r)(n)}},function(t,n,r){var e=r(66),o=Math.min;t.exports=function(t){return t>0?o(e(t),9007199254740991):0}},function(t,n,r){var e=r(6),o=Error,i=e("".replace),c=String(o("zxcasd").stack),u=/\\n\\s*at [^:]*:[^\\n]*/,a=u.test(c);t.exports=function(t,n){if(a&&"string"==typeof t&&!o.prepareStackTrace)for(;n--;)t=i(t,u,"");return t}},function(t,n,r){var e=r(10),o=r(19);t.exports=function(t,n){e(n)&&"cause"in n&&o(t,"cause",n.cause)}},function(t,n,r){var e=r(4),o=r(27),i=e("iterator"),c=Array.prototype;t.exports=function(t){return void 0!==t&&(o.Array===t||c[i]===t)}},function(t,n,r){var e=r(7),o=r(17),i=r(12),c=r(32),u=r(89),a=TypeError;t.exports=function(t,n){var r=arguments.length<2?u(t):n;if(o(r))return i(e(r,t));throw a(c(t)+" is not iterable")}},function(t,n,r){var e=r(7),o=r(12),i=r(58);t.exports=function(t,n,r){var c,u;o(t);try{if(!(c=i(t,"return"))){if("throw"===n)throw r;return r}c=e(c,t)}catch(t){u=!0,c=t}if("throw"===n)throw r;if(u)throw c;return o(c),r}},function(t,n,r){var e=r(36);t.exports=function(t,n){return void 0===t?arguments.length<2?"":n:e(t)}},function(t,n,r){var e=r(5),o=r(20);t.exports=!e((function(){var t=Error("a");return!("stack"in t)||(Object.defineProperty(t,"stack",o(1,7)),7!==t.stack)}))},function(t,n){t.exports=function(){}},function(t,n,r){var e=r(1),o=r(2),i=e.WeakMap;t.exports=o(i)&&/native code/.test(String(i))},function(t,n,r){var e=r(11),o=r(8),i=Function.prototype,c=e&&Object.getOwnPropertyDescriptor,u=o(i,"name"),a=u&&"something"===function(){}.name,f=u&&(!e||e&&c(i,"name").configurable);t.exports={EXISTS:u,PROPER:a,CONFIGURABLE:f}},function(t,n,r){"use strict";var e=r(91).IteratorPrototype,o=r(50),i=r(20),c=r(29),u=r(27),a=function(){return this};t.exports=function(t,n,r,f){var s=n+" Iterator";return t.prototype=o(e,{next:i(+!f,r)}),c(t,s,!1,!0),u[s]=a,t}},function(t,n,r){"use strict";var e=r(70),o=r(28);t.exports=e?{}.toString:function(){return"[object "+o(this)+"]"}},function(t,n,r){r(138),r(148),r(150),r(151),r(152),r(153)},function(t,n,r){"use strict";var e,o,i,c=r(0),u=r(15),a=r(52),f=r(1),s=r(7),p=r(21),l=r(63),v=r(29),d=r(139),y=r(17),h=r(2),m=r(10),g=r(140),x=r(93),b=r(95).set,w=r(142),S=r(145),j=r(37),O=r(146),P=r(51),T=r(30),A=r(38),E=r(22),k=A.CONSTRUCTOR,I=A.REJECTION_EVENT,D=A.SUBCLASSING,L=P.getterFor("Promise"),_=P.set,C=T&&T.prototype,M=T,R=C,N=f.TypeError,F=f.document,B=f.process,G=E.f,U=G,z=!!(F&&F.createEvent&&f.dispatchEvent),q=function(t){var n;return!(!m(t)||!h(n=t.then))&&n},V=function(t,n){var r,e,o,i=n.value,c=1==n.state,u=c?t.ok:t.fail,a=t.resolve,f=t.reject,p=t.domain;try{u?(c||(2===n.rejection&&Y(n),n.rejection=1),!0===u?r=i:(p&&p.enter(),r=u(i),p&&(p.exit(),o=!0)),r===t.promise?f(N("Promise-chain cycle")):(e=q(r))?s(e,r,a,f):a(r)):f(i)}catch(t){p&&!o&&p.exit(),f(t)}},H=function(t,n){t.notified||(t.notified=!0,w((function(){for(var r,e=t.reactions;r=e.get();)V(r,t);t.notified=!1,n&&!t.rejection&&K(t)})))},J=function(t,n,r){var e,o;z?((e=F.createEvent("Event")).promise=n,e.reason=r,e.initEvent(t,!1,!0),f.dispatchEvent(e)):e={promise:n,reason:r},!I&&(o=f["on"+t])?o(e):"unhandledrejection"===t&&S("Unhandled promise rejection",r)},K=function(t){s(b,f,(function(){var n,r=t.facade,e=t.value;if(W(t)&&(n=j((function(){a?B.emit("unhandledRejection",e,r):J("unhandledrejection",r,e)})),t.rejection=a||W(t)?2:1,n.error))throw n.value}))},W=function(t){return 1!==t.rejection&&!t.parent},Y=function(t){s(b,f,(function(){var n=t.facade;a?B.emit("rejectionHandled",n):J("rejectionhandled",n,t.value)}))},X=function(t,n,r){return function(e){t(n,e,r)}},$=function(t,n,r){t.done||(t.done=!0,r&&(t=r),t.value=n,t.state=2,H(t,!0))},Q=function(t,n,r){if(!t.done){t.done=!0,r&&(t=r);try{if(t.facade===n)throw N("Promise can't be resolved itself");var e=q(n);e?w((function(){var r={done:!1};try{s(e,n,X(Q,r,t),X($,r,t))}catch(n){$(r,n,t)}})):(t.value=n,t.state=1,H(t,!1))}catch(n){$({done:!1},n,t)}}};if(k&&(R=(M=function(t){g(this,R),y(t),s(e,this);var n=L(this);try{t(X(Q,n),X($,n))}catch(t){$(n,t)}}).prototype,(e=function(t){_(this,{type:"Promise",done:!1,notified:!1,parent:!1,reactions:new O,rejection:!1,state:0,value:void 0})}).prototype=p(R,"then",(function(t,n){var r=L(this),e=G(x(this,M));return r.parent=!0,e.ok=!h(t)||t,e.fail=h(n)&&n,e.domain=a?B.domain:void 0,0==r.state?r.reactions.add(e):w((function(){V(e,r)})),e.promise})),o=function(){var t=new e,n=L(t);this.promise=t,this.resolve=X(Q,n),this.reject=X($,n)},E.f=G=function(t){return t===M||void 0===t?new o(t):U(t)},!u&&h(T)&&C!==Object.prototype)){i=C.then,D||p(C,"then",(function(t,n){var r=this;return new M((function(t,n){s(i,r,t,n)})).then(t,n)}),{unsafe:!0});try{delete C.constructor}catch(t){}l&&l(C,R)}c({global:!0,constructor:!0,wrap:!0,forced:k},{Promise:M}),v(M,"Promise",!1,!0),d("Promise")},function(t,n,r){"use strict";var e=r(9),o=r(16),i=r(4),c=r(11),u=i("species");t.exports=function(t){var n=e(t),r=o.f;c&&n&&!n[u]&&r(n,u,{configurable:!0,get:function(){return this}})}},function(t,n,r){var e=r(14),o=TypeError;t.exports=function(t,n){if(e(n,t))return t;throw o("Incorrect invocation")}},function(t,n,r){var e=r(73),o=r(32),i=TypeError;t.exports=function(t){if(e(t))return t;throw i(o(t)+" is not a constructor")}},function(t,n,r){var e,o,i,c,u,a,f,s,p=r(1),l=r(34),v=r(43).f,d=r(95).set,y=r(97),h=r(143),m=r(144),g=r(52),x=p.MutationObserver||p.WebKitMutationObserver,b=p.document,w=p.process,S=p.Promise,j=v(p,"queueMicrotask"),O=j&&j.value;O||(e=function(){var t,n;for(g&&(t=w.domain)&&t.exit();o;){n=o.fn,o=o.next;try{n()}catch(t){throw o?c():i=void 0,t}}i=void 0,t&&t.enter()},y||g||m||!x||!b?!h&&S&&S.resolve?((f=S.resolve(void 0)).constructor=S,s=l(f.then,f),c=function(){s(e)}):g?c=function(){w.nextTick(e)}:(d=l(d,p),c=function(){d(e)}):(u=!0,a=b.createTextNode(""),new x(e).observe(a,{characterData:!0}),c=function(){a.data=u=!u})),t.exports=O||function(t){var n={fn:t,next:void 0};i&&(i.next=n),o||(o=n,c()),i=n}},function(t,n,r){var e=r(31),o=r(1);t.exports=/ipad|iphone|ipod/i.test(e)&&void 0!==o.Pebble},function(t,n,r){var e=r(31);t.exports=/web0s(?!.*chrome)/i.test(e)},function(t,n,r){var e=r(1);t.exports=function(t,n){var r=e.console;r&&r.error&&(1==arguments.length?r.error(t):r.error(t,n))}},function(t,n){var r=function(){this.head=null,this.tail=null};r.prototype={add:function(t){var n={item:t,next:null};this.head?this.tail.next=n:this.head=n,this.tail=n},get:function(){var t=this.head;if(t)return this.head=t.next,this.tail===t&&(this.tail=null),t.item}},t.exports=r},function(t,n,r){var e=r(98),o=r(52);t.exports=!e&&!o&&"object"==typeof window&&"object"==typeof document},function(t,n,r){"use strict";var e=r(0),o=r(7),i=r(17),c=r(22),u=r(37),a=r(35);e({target:"Promise",stat:!0,forced:r(99)},{all:function(t){var n=this,r=c.f(n),e=r.resolve,f=r.reject,s=u((function(){var r=i(n.resolve),c=[],u=0,s=1;a(t,(function(t){var i=u++,a=!1;s++,o(r,n,t).then((function(t){a||(a=!0,c[i]=t,--s||e(c))}),f)})),--s||e(c)}));return s.error&&f(s.value),r.promise}})},function(t,n,r){var e=r(4)("iterator"),o=!1;try{var i=0,c={next:function(){return{done:!!i++}},return:function(){o=!0}};c[e]=function(){return this},Array.from(c,(function(){throw 2}))}catch(t){}t.exports=function(t,n){if(!n&&!o)return!1;var r=!1;try{var i={};i[e]=function(){return{next:function(){return{done:r=!0}}}},t(i)}catch(t){}return r}},function(t,n,r){"use strict";var e=r(0),o=r(15),i=r(38).CONSTRUCTOR,c=r(30),u=r(9),a=r(2),f=r(21),s=c&&c.prototype;if(e({target:"Promise",proto:!0,forced:i,real:!0},{catch:function(t){return this.then(void 0,t)}}),!o&&a(c)){var p=u("Promise").prototype.catch;s.catch!==p&&f(s,"catch",p,{unsafe:!0})}},function(t,n,r){"use strict";var e=r(0),o=r(7),i=r(17),c=r(22),u=r(37),a=r(35);e({target:"Promise",stat:!0,forced:r(99)},{race:function(t){var n=this,r=c.f(n),e=r.reject,f=u((function(){var c=i(n.resolve);a(t,(function(t){o(c,n,t).then(r.resolve,e)}))}));return f.error&&e(f.value),r.promise}})},function(t,n,r){"use strict";var e=r(0),o=r(7),i=r(22);e({target:"Promise",stat:!0,forced:r(38).CONSTRUCTOR},{reject:function(t){var n=i.f(this);return o(n.reject,void 0,t),n.promise}})},function(t,n,r){"use strict";var e=r(0),o=r(9),i=r(15),c=r(30),u=r(38).CONSTRUCTOR,a=r(100),f=o("Promise"),s=i&&!u;e({target:"Promise",stat:!0,forced:i||u},{resolve:function(t){return a(s&&this===f?c:this,t)}})},function(t,n,r){"use strict";var e=r(0),o=r(7),i=r(17),c=r(22),u=r(37),a=r(35);e({target:"Promise",stat:!0},{allSettled:function(t){var n=this,r=c.f(n),e=r.resolve,f=r.reject,s=u((function(){var r=i(n.resolve),c=[],u=0,f=1;a(t,(function(t){var i=u++,a=!1;f++,o(r,n,t).then((function(t){a||(a=!0,c[i]={status:"fulfilled",value:t},--f||e(c))}),(function(t){a||(a=!0,c[i]={status:"rejected",reason:t},--f||e(c))}))})),--f||e(c)}));return s.error&&f(s.value),r.promise}})},function(t,n,r){"use strict";var e=r(0),o=r(7),i=r(17),c=r(9),u=r(22),a=r(37),f=r(35);e({target:"Promise",stat:!0},{any:function(t){var n=this,r=c("AggregateError"),e=u.f(n),s=e.resolve,p=e.reject,l=a((function(){var e=i(n.resolve),c=[],u=0,a=1,l=!1;f(t,(function(t){var i=u++,f=!1;a++,o(e,n,t).then((function(t){f||l||(l=!0,s(t))}),(function(t){f||l||(f=!0,c[i]=t,--a||p(new r(c,"No one promise resolved")))}))})),--a||p(new r(c,"No one promise resolved"))}));return l.error&&p(l.value),e.promise}})},function(t,n,r){"use strict";var e=r(0),o=r(15),i=r(30),c=r(5),u=r(9),a=r(2),f=r(93),s=r(100),p=r(21),l=i&&i.prototype;if(e({target:"Promise",proto:!0,real:!0,forced:!!i&&c((function(){l.finally.call({then:function(){}},(function(){}))}))},{finally:function(t){var n=f(this,u("Promise")),r=a(t);return this.then(r?function(r){return s(n,t()).then((function(){return r}))}:t,r?function(r){return s(n,t()).then((function(){throw r}))}:t)}}),!o&&a(i)){var v=u("Promise").prototype.finally;l.finally!==v&&p(l,"finally",v,{unsafe:!0})}},function(t,n,r){var e=r(6),o=r(66),i=r(36),c=r(57),u=e("".charAt),a=e("".charCodeAt),f=e("".slice),s=function(t){return function(n,r){var e,s,p=i(c(n)),l=o(r),v=p.length;return l<0||l>=v?t?"":void 0:(e=a(p,l))<55296||e>56319||l+1===v||(s=a(p,l+1))<56320||s>57343?t?u(p,l):e:t?f(p,l,l+2):s-56320+(e-55296<<10)+65536}};t.exports={codeAt:s(!1),charAt:s(!0)}},function(t,n){t.exports={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}},function(t,n,r){var e=r(160);t.exports=e},function(t,n,r){var e=r(14),o=r(161),i=Array.prototype;t.exports=function(t){var n=t.slice;return t===i||e(i,t)&&n===i.slice?o:n}},function(t,n,r){r(162);var e=r(40);t.exports=e("Array").slice},function(t,n,r){"use strict";var e=r(0),o=r(39),i=r(73),c=r(10),u=r(65),a=r(26),f=r(18),s=r(74),p=r(4),l=r(55),v=r(53),d=l("slice"),y=p("species"),h=Array,m=Math.max;e({target:"Array",proto:!0,forced:!d},{slice:function(t,n){var r,e,p,l=f(this),d=a(l),g=u(t,d),x=u(void 0===n?d:n,d);if(o(l)&&(r=l.constructor,(i(r)&&(r===h||o(r.prototype))||c(r)&&null===(r=r[y]))&&(r=void 0),r===h||void 0===r))return v(l,g,x);for(e=new(void 0===r?h:r)(m(x-g,0)),p=0;g<x;g++,p++)g in l&&s(e,p,l[g]);return e.length=p,e}})},function(t,n,r){t.exports=r(164)},function(t,n,r){var e=r(165);t.exports=e},function(t,n,r){var e=r(14),o=r(166),i=Array.prototype;t.exports=function(t){var n=t.map;return t===i||e(i,t)&&n===i.map?o:n}},function(t,n,r){r(167);var e=r(40);t.exports=e("Array").map},function(t,n,r){"use strict";var e=r(0),o=r(56).map;e({target:"Array",proto:!0,forced:!r(55)("map")},{map:function(t){return o(this,t,arguments.length>1?arguments[1]:void 0)}})},function(t,n,r){var e=r(39),o=r(73),i=r(10),c=r(4)("species"),u=Array;t.exports=function(t){var n;return e(t)&&(n=t.constructor,(o(n)&&(n===u||e(n.prototype))||i(n)&&null===(n=n[c]))&&(n=void 0)),void 0===n?u:n}},function(t,n,r){(function(e){var o,i=r(170),c=r(76),u=r(216),a=r(102),f=r(222),s=r(226),p=r(233),l=r(237),v=r(241),d=r(245);!function(y,h){"use strict";var m,g=(y=void 0!==y?y:"undefined"!=typeof self?self:void 0!==e?e:{}).IDBKeyRange||y.webkitIDBKeyRange,x="readonly",b="readwrite",w=Object.prototype.hasOwnProperty,S=function(){if(!m&&!(m=y.indexedDB||y.webkitIndexedDB||y.mozIndexedDB||y.oIndexedDB||y.msIndexedDB||(null===y.indexedDB&&y.shimIndexedDB?y.shimIndexedDB:void 0)))throw"IndexedDB required";return m},j=!1,O=navigator&&!navigator.userAgentData&&/Safari\\//.test(navigator.userAgent)&&!/Chrom(e|ium)\\//.test(navigator.userAgent),P=function(t){return t},T=function(t){var n;return a(n=Object.prototype.toString.call(t)).call(n,8,-1).toLowerCase()},A=function(t){return"function"==typeof t},E=function(t){return"number"===T(t)},k=function(t){return"array"===T(t)},I=function(t){return void 0===t},D=function(t,n){var r=this,e=!1;this.name=n,this.getIndexedDB=function(){return t},this.add=function(n){if(e)throw"Database has been closed";for(var o=[],i=0,u=0;u<arguments.length-1;u++)if(f(arguments[u+1]))for(var a=0;a<arguments[u+1].length;a++)o[i]=arguments[u+1][a],i++;else o[i]=arguments[u+1],i++;var l=t.transaction(n,b),v=l.objectStore(n);return new c((function(t,n){s(o).call(o,(function(t){var n;if(t.item&&t.key){var r=t.key;t=t.item,n=v.add(t,r)}else n=v.add(t);n.onsuccess=function(n){var r=n.target,e=r.source.keyPath;null===e&&(e="__id__"),p(t,e,{value:r.result,enumerable:!0})}})),l.oncomplete=function(){t(o,r)},l.onerror=function(t){t.preventDefault(),n(t)},l.onabort=function(t){n(t)}}))},this.updateAndDelete=function(n,r,o){if(e)throw"Database has been closed";var i=t.transaction(n,b),u=i.objectStore(n),a=u.keyPath;return new c((function(t,n){s(r).call(r,(function(t){if(t.item&&t.key){var n=t.key;t=t.item,u.put(t,n)}else u.put(t)})),s(o).call(o,(function(t){u.delete(t[a])})),i.oncomplete=function(){t([r,o])},i.onerror=function(t){n(t)}}))},this.update=function(n){if(e)throw"Database has been closed";for(var o,i=[],u=1;u<arguments.length;u++)f(o=arguments[u])?i=l(i).call(i,o):i.push(o);var a=t.transaction(n,b),p=a.objectStore(n);p.keyPath;return new c((function(t,n){s(i).call(i,(function(t){var n;if(t.item&&t.key){var r=t.key;t=t.item,n=p.put(t,r)}else n=p.put(t);n.onsuccess=function(t){},n.onerror=function(t){}})),a.oncomplete=function(){t(i,r)},a.onerror=function(t){n(t)},a.onabort=function(t){n(t)}}))},this.remove=function(n,r,o,i,u,a,p){if(e)throw"Database has been closed";var l=t.transaction(n,b),v=l.objectStore(n);return new c((function(t,n){function e(t){return null==t}var c;(e(i)&&(i=-1/0),e(u)&&(u=1/0),null===r||f(r)||(r=[r]),e(o))?null!==r?s(r).call(r,(function(t){v.delete(t)})):v.delete(range=g.bound(i,u,a,p)):(c=null!==r?g.only(r[0]):g.bound(i,u,a,p),v.index(o).openCursor(c).onsuccess=function(t){var n=t.target.result;n&&(n.delete(),n.continue())});l.oncomplete=function(){t()},l.onerror=function(t){n(t)},l.onabort=function(t){n(t)}}))},this.clear=function(n){if(e)throw"Database has been closed";var r=t.transaction(n,b);r.objectStore(n).clear();return new c((function(t,n){r.oncomplete=function(){t()},r.onerror=function(t){n(t)}}))},this.close=function(){e||(t.close(),e=!0,delete C[n])},this.get=function(n,r){if(e)throw"Database has been closed";var o=t.transaction(n),i=o.objectStore(n).get(r);return new c((function(t,n){i.onsuccess=function(n){t(n.target.result)},o.onerror=function(t){n(t)}}))},this.query=function(n,r){if(e)throw"Database has been closed";return new L(n,t,r)},this.count=function(n,r){if(e)throw"Database has been closed";t.transaction(n).objectStore(n)};for(var o=0,i=t.objectStoreNames.length;o<i;o++)!function(t){for(var n in r[t]={},r)w.call(r,n)&&"close"!==n&&(r[t][n]=function(n){return function(){var e,o=l(e=[t]).call(e,a([]).call(arguments,0));return r[n].apply(r,o)}}(n))}(t.objectStoreNames[o])},L=function(t,n,r){var e,o=this,u=!1,f=!1,p=function(e,o,a,p,l,d,y){return new c((function(c,h){var m=u||f?b:x,w=n.transaction(t,m),S=w.objectStore(t),j=r?S.index(r):S,O=e?g[e].apply(null,o):null,P=[],T=[O],E=0;l=l||null,d=d||[],"count"!==a&&T.push(p||"next");var k=!!u&&v(u);j[a].apply(j,T).onsuccess=function(t){var n=t.target.result;if(i(n)===i(0))P=n;else if(n)if(null!==l&&l[0]>E)E=l[0],n.advance(l[0]);else if(null!==l&&E>=l[0]+l[1]);else{var r=!0,e="value"in n?n.value:n.key;s(d).call(d,(function(t){t&&t.length&&(2===t.length?r=r&&e[t[0]]===t[1]:A(t[0])&&(r=r&&t[0].apply(void 0,[e])))})),r&&(E++,P.push(y(e)),f?n.delete():u&&(e=function(t){for(var n=0;n<k.length;n++){var r=k[n],e=u[r];e instanceof Function&&(e=e(t)),t[r]=e}return t}(e),n.update(e))),n.continue()}},w.oncomplete=function(){c(P)},w.onerror=function(t){h(t)},w.onabort=function(t){h(t)}}))},l=function(t,n){var r="next",e="openCursor",o=[],i=null,c=P,s=!1,l=function(){return p(t,n,e,s?r+"unique":r,i,o,c)},v=function(){return r=null,e="count",{execute:l}},d=function t(){return 1==(i=k(arguments[0])?arguments[0]:a(Array.prototype).call(arguments,0,2)).length&&i.unshift(0),E(i[1])||(i=null),{execute:l,count:v,keys:y,filter:h,asc:m,desc:g,distinct:x,modify:b,limit:t,map:w,remove:S}},y=function t(n){return(n=!!I(n)||!!n)&&(e="openKeyCursor"),{execute:l,keys:t,filter:h,asc:m,desc:g,distinct:x,modify:b,limit:d,map:w,remove:S}},h=function t(){return o.push(a(Array.prototype).call(arguments,0,2)),{execute:l,count:v,keys:y,filter:t,asc:m,desc:g,distinct:x,modify:b,limit:d,map:w,remove:S}},m=function t(n){return n=!!I(n)||!!n,r=n?"next":"prev",{execute:l,count:v,keys:y,filter:h,asc:t,desc:g,distinct:x,modify:b,limit:d,map:w,remove:S}},g=function t(n){return n=!!I(n)||!!n,r=n?"prev":"next",{execute:l,count:v,keys:y,filter:h,asc:m,desc:t,distinct:x,modify:b,limit:d,map:w,remove:S}},x=function t(n){return n=!!I(n)||!!n,s=n,{execute:l,count:v,keys:y,filter:h,asc:m,desc:g,distinct:t,modify:b,limit:d,map:w,remove:S}},b=function t(n){return u=n,{execute:l,count:v,keys:y,filter:h,asc:m,desc:g,distinct:x,modify:t,limit:d,map:w,remove:S}},w=function t(n){return A(n)&&(c=n),{execute:l,count:v,keys:y,filter:h,asc:m,desc:g,distinct:x,modify:b,limit:d,map:t,remove:S}},S=function t(n){return n=!!I(n)||!!n,f=n,{execute:l,count:v,keys:y,filter:h,asc:m,desc:g,distinct:x,modify:b,limit:d,map:w,remove:t}};return{execute:l,count:v,keys:y,filter:h,asc:m,desc:g,distinct:x,modify:b,limit:d,map:w,remove:S}};s(e="only bound upperBound lowerBound".split(" ")).call(e,(function(t){o[t]=function(){return new l(t,arguments)}})),this.filter=function(){var t=new l(null,null);return d(t).apply(t,arguments)},this.all=function(){var t;return d(t=this).call(t)}},_=function(t,n,r,e){var o=t.target.result,i=new D(o,n);return C[n]=o,c.resolve(i)},C={},M={version:"0.10.2",open:function(t){var n;return new c((function(r,e){var o;C[t.server]?_({target:{result:C[t.server]}},t.server,t.version,t.schema).then(r,e):(j?c.resolve():O&&S().databases?new c((function(t){var n=function(){return S().databases().finally(t)};o=u(n,100),n()})).finally((function(){j=!0,clearInterval(o)})):(j=!0,c.resolve())).then((function(){try{n=S().open(t.server,t.version)}catch(t){e(t)}n.onsuccess=function(n){_(n,t.server,t.version,t.schema).then(r,e)},n.onupgradeneeded=function(n){!function(t,n,r){for(var e in"function"==typeof n&&(n=n()),n){var o,i=n[e];for(var c in o=!w.call(n,e)||r.objectStoreNames.contains(e)?t.currentTarget.transaction.objectStore(e):r.createObjectStore(e,i.key),i.indexes){var u=i.indexes[c];try{o.index(c)}catch(t){o.createIndex(c,u.key||c,v(u).length?u:{unique:!1})}}}}(n,t.schema,n.target.result)},n.onerror=function(t){e(t)}}))}))},remove:function(t){return new c((function(n,r){if(!t)return n();var e,o;i(t)===D&&(t=t.name),"string"==typeof t&&(e=C[t]),e&&"function"==typeof e.close&&e.close();try{o=S().deleteDatabase(t)}catch(t){r(t)}o.onsuccess=function(r){delete C[t],n(t)},o.onerror=function(t){r(t)},o.onblocked=function(t){r(t)}}))}};void 0!==t.exports?t.exports=M:void 0===(o=function(){return M}.call(n,r,n,t))||(t.exports=o)}(void 0)}).call(this,r(77))},function(t,n,r){var e=r(171),o=r(210);function i(n){return t.exports=i="function"==typeof e&&"symbol"==typeof o?function(t){return typeof t}:function(t){return t&&"function"==typeof e&&t.constructor===e&&t!==e.prototype?"symbol":typeof t},t.exports.__esModule=!0,t.exports.default=t.exports,i(n)}t.exports=i,t.exports.__esModule=!0,t.exports.default=t.exports},function(t,n,r){t.exports=r(172)},function(t,n,r){t.exports=r(173)},function(t,n,r){var e=r(174);r(203),r(204),r(205),r(206),r(207),r(208),r(209),t.exports=e},function(t,n,r){var e=r(175);r(202),t.exports=e},function(t,n,r){var e=r(176);r(54),t.exports=e},function(t,n,r){r(104),r(72),r(178),r(186),r(187),r(188),r(189),r(107),r(190),r(191),r(192),r(193),r(194),r(195),r(196),r(197),r(198),r(199),r(200),r(201);var e=r(13);t.exports=e.Symbol},function(t,n){var r=TypeError;t.exports=function(t){if(t>9007199254740991)throw r("Maximum allowed index exceeded");return t}},function(t,n,r){r(179),r(182),r(183),r(184),r(185)},function(t,n,r){"use strict";var e=r(0),o=r(1),i=r(7),c=r(6),u=r(15),a=r(11),f=r(24),s=r(5),p=r(8),l=r(14),v=r(12),d=r(18),y=r(45),h=r(36),m=r(20),g=r(50),x=r(69),b=r(64),w=r(180),S=r(68),j=r(43),O=r(16),P=r(87),T=r(80),A=r(21),E=r(33),k=r(48),I=r(49),D=r(60),L=r(4),_=r(75),C=r(3),M=r(105),R=r(29),N=r(51),F=r(56).forEach,B=k("hidden"),G=N.set,U=N.getterFor("Symbol"),z=Object.prototype,q=o.Symbol,V=q&&q.prototype,H=o.TypeError,J=o.QObject,K=j.f,W=O.f,Y=w.f,X=T.f,$=c([].push),Q=E("symbols"),Z=E("op-symbols"),tt=E("wks"),nt=!J||!J.prototype||!J.prototype.findChild,rt=a&&s((function(){return 7!=g(W({},"a",{get:function(){return W(this,"a",{value:7}).a}})).a}))?function(t,n,r){var e=K(z,n);e&&delete z[n],W(t,n,r),e&&t!==z&&W(z,n,e)}:W,et=function(t,n){var r=Q[t]=g(V);return G(r,{type:"Symbol",tag:t,description:n}),a||(r.description=n),r},ot=function(t,n,r){t===z&&ot(Z,n,r),v(t);var e=y(n);return v(r),p(Q,e)?(r.enumerable?(p(t,B)&&t[B][e]&&(t[B][e]=!1),r=g(r,{enumerable:m(0,!1)})):(p(t,B)||W(t,B,m(1,{})),t[B][e]=!0),rt(t,e,r)):W(t,e,r)},it=function(t,n){v(t);var r=d(n),e=x(r).concat(ft(r));return F(e,(function(n){a&&!i(ct,r,n)||ot(t,n,r[n])})),t},ct=function(t){var n=y(t),r=i(X,this,n);return!(this===z&&p(Q,n)&&!p(Z,n))&&(!(r||!p(this,n)||!p(Q,n)||p(this,B)&&this[B][n])||r)},ut=function(t,n){var r=d(t),e=y(n);if(r!==z||!p(Q,e)||p(Z,e)){var o=K(r,e);return!o||!p(Q,e)||p(r,B)&&r[B][e]||(o.enumerable=!0),o}},at=function(t){var n=Y(d(t)),r=[];return F(n,(function(t){p(Q,t)||p(I,t)||$(r,t)})),r},ft=function(t){var n=t===z,r=Y(n?Z:d(t)),e=[];return F(r,(function(t){!p(Q,t)||n&&!p(z,t)||$(e,Q[t])})),e};f||(A(V=(q=function(){if(l(V,this))throw H("Symbol is not a constructor");var t=arguments.length&&void 0!==arguments[0]?h(arguments[0]):void 0,n=D(t),r=function(t){this===z&&i(r,Z,t),p(this,B)&&p(this[B],n)&&(this[B][n]=!1),rt(this,n,m(1,t))};return a&&nt&&rt(z,n,{configurable:!0,set:r}),et(n,t)}).prototype,"toString",(function(){return U(this).tag})),A(q,"withoutSetter",(function(t){return et(D(t),t)})),T.f=ct,O.f=ot,P.f=it,j.f=ut,b.f=w.f=at,S.f=ft,_.f=function(t){return et(L(t),t)},a&&(W(V,"description",{configurable:!0,get:function(){return U(this).description}}),u||A(z,"propertyIsEnumerable",ct,{unsafe:!0}))),e({global:!0,constructor:!0,wrap:!0,forced:!f,sham:!f},{Symbol:q}),F(x(tt),(function(t){C(t)})),e({target:"Symbol",stat:!0,forced:!f},{useSetter:function(){nt=!0},useSimple:function(){nt=!1}}),e({target:"Object",stat:!0,forced:!f,sham:!a},{create:function(t,n){return void 0===n?g(t):it(g(t),n)},defineProperty:ot,defineProperties:it,getOwnPropertyDescriptor:ut}),e({target:"Object",stat:!0,forced:!f},{getOwnPropertyNames:at}),M(),R(q,"Symbol"),I[B]=!0},function(t,n,r){var e=r(23),o=r(18),i=r(64).f,c=r(181),u="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];t.exports.f=function(t){return u&&"Window"==e(t)?function(t){try{return i(t)}catch(t){return c(u)}}(t):i(o(t))}},function(t,n,r){var e=r(65),o=r(26),i=r(74),c=Array,u=Math.max;t.exports=function(t,n,r){for(var a=o(t),f=e(n,a),s=e(void 0===r?a:r,a),p=c(u(s-f,0)),l=0;f<s;f++,l++)i(p,l,t[f]);return p.length=l,p}},function(t,n,r){var e=r(0),o=r(9),i=r(8),c=r(36),u=r(33),a=r(106),f=u("string-to-symbol-registry"),s=u("symbol-to-string-registry");e({target:"Symbol",stat:!0,forced:!a},{for:function(t){var n=c(t);if(i(f,n))return f[n];var r=o("Symbol")(n);return f[n]=r,s[r]=n,r}})},function(t,n,r){var e=r(0),o=r(8),i=r(46),c=r(32),u=r(33),a=r(106),f=u("symbol-to-string-registry");e({target:"Symbol",stat:!0,forced:!a},{keyFor:function(t){if(!i(t))throw TypeError(c(t)+" is not a symbol");if(o(f,t))return f[t]}})},function(t,n,r){var e=r(0),o=r(9),i=r(41),c=r(7),u=r(6),a=r(5),f=r(39),s=r(2),p=r(10),l=r(46),v=r(53),d=r(24),y=o("JSON","stringify"),h=u(/./.exec),m=u("".charAt),g=u("".charCodeAt),x=u("".replace),b=u(1..toString),w=/[\\uD800-\\uDFFF]/g,S=/^[\\uD800-\\uDBFF]$/,j=/^[\\uDC00-\\uDFFF]$/,O=!d||a((function(){var t=o("Symbol")();return"[null]"!=y([t])||"{}"!=y({a:t})||"{}"!=y(Object(t))})),P=a((function(){return'"\\\\udf06\\\\ud834"'!==y("\\udf06\\ud834")||'"\\\\udead"'!==y("\\udead")})),T=function(t,n){var r=v(arguments),e=n;if((p(n)||void 0!==t)&&!l(t))return f(n)||(n=function(t,n){if(s(e)&&(n=c(e,this,t,n)),!l(n))return n}),r[1]=n,i(y,null,r)},A=function(t,n,r){var e=m(r,n-1),o=m(r,n+1);return h(S,t)&&!h(j,o)||h(j,t)&&!h(S,e)?"\\\\u"+b(g(t,0),16):t};y&&e({target:"JSON",stat:!0,arity:3,forced:O||P},{stringify:function(t,n,r){var e=v(arguments),o=i(O?T:y,null,e);return P&&"string"==typeof o?x(o,w,A):o}})},function(t,n,r){var e=r(0),o=r(24),i=r(5),c=r(68),u=r(25);e({target:"Object",stat:!0,forced:!o||i((function(){c.f(1)}))},{getOwnPropertySymbols:function(t){var n=c.f;return n?n(u(t)):[]}})},function(t,n,r){r(3)("asyncIterator")},function(t,n){},function(t,n,r){r(3)("hasInstance")},function(t,n,r){r(3)("isConcatSpreadable")},function(t,n,r){r(3)("match")},function(t,n,r){r(3)("matchAll")},function(t,n,r){r(3)("replace")},function(t,n,r){r(3)("search")},function(t,n,r){r(3)("species")},function(t,n,r){r(3)("split")},function(t,n,r){var e=r(3),o=r(105);e("toPrimitive"),o()},function(t,n,r){var e=r(9),o=r(3),i=r(29);o("toStringTag"),i(e("Symbol"),"Symbol")},function(t,n,r){r(3)("unscopables")},function(t,n,r){var e=r(1);r(29)(e.JSON,"JSON",!0)},function(t,n){},function(t,n){},function(t,n,r){r(3)("dispose")},function(t,n,r){r(3)("asyncDispose")},function(t,n,r){r(3)("matcher")},function(t,n,r){r(3)("metadataKey")},function(t,n,r){r(3)("observable")},function(t,n,r){r(3)("metadata")},function(t,n,r){r(3)("patternMatch")},function(t,n,r){r(3)("replaceAll")},function(t,n,r){t.exports=r(211)},function(t,n,r){t.exports=r(212)},function(t,n,r){var e=r(213);t.exports=e},function(t,n,r){var e=r(214);t.exports=e},function(t,n,r){var e=r(215);r(54),t.exports=e},function(t,n,r){r(71),r(72),r(101),r(107);var e=r(75);t.exports=e.f("iterator")},function(t,n,r){t.exports=r(217)},function(t,n,r){r(218);var e=r(13);t.exports=e.setInterval},function(t,n,r){r(219),r(221)},function(t,n,r){var e=r(0),o=r(1),i=r(108)(o.setInterval,!0);e({global:!0,bind:!0,forced:o.setInterval!==i},{setInterval:i})},function(t,n){t.exports="function"==typeof Bun&&Bun&&"string"==typeof Bun.version},function(t,n,r){var e=r(0),o=r(1),i=r(108)(o.setTimeout,!0);e({global:!0,bind:!0,forced:o.setTimeout!==i},{setTimeout:i})},function(t,n,r){t.exports=r(223)},function(t,n,r){var e=r(224);t.exports=e},function(t,n,r){r(225);var e=r(13);t.exports=e.Array.isArray},function(t,n,r){r(0)({target:"Array",stat:!0},{isArray:r(39)})},function(t,n,r){t.exports=r(227)},function(t,n,r){r(54);var e=r(28),o=r(8),i=r(14),c=r(228),u=Array.prototype,a={DOMTokenList:!0,NodeList:!0};t.exports=function(t){var n=t.forEach;return t===u||i(u,t)&&n===u.forEach||o(a,e(t))?c:n}},function(t,n,r){var e=r(229);t.exports=e},function(t,n,r){r(230);var e=r(40);t.exports=e("Array").forEach},function(t,n,r){"use strict";var e=r(0),o=r(231);e({target:"Array",proto:!0,forced:[].forEach!=o},{forEach:o})},function(t,n,r){"use strict";var e=r(56).forEach,o=r(232)("forEach");t.exports=o?[].forEach:function(t){return e(this,t,arguments.length>1?arguments[1]:void 0)}},function(t,n,r){"use strict";var e=r(5);t.exports=function(t,n){var r=[][t];return!!r&&e((function(){r.call(null,n||function(){return 1},1)}))}},function(t,n,r){t.exports=r(234)},function(t,n,r){var e=r(235);t.exports=e},function(t,n,r){r(236);var e=r(13).Object,o=t.exports=function(t,n,r){return e.defineProperty(t,n,r)};e.defineProperty.sham&&(o.sham=!0)},function(t,n,r){var e=r(0),o=r(11),i=r(16).f;e({target:"Object",stat:!0,forced:Object.defineProperty!==i,sham:!o},{defineProperty:i})},function(t,n,r){t.exports=r(238)},function(t,n,r){var e=r(239);t.exports=e},function(t,n,r){var e=r(14),o=r(240),i=Array.prototype;t.exports=function(t){var n=t.concat;return t===i||e(i,t)&&n===i.concat?o:n}},function(t,n,r){r(104);var e=r(40);t.exports=e("Array").concat},function(t,n,r){t.exports=r(242)},function(t,n,r){var e=r(243);t.exports=e},function(t,n,r){r(244);var e=r(13);t.exports=e.Object.keys},function(t,n,r){var e=r(0),o=r(25),i=r(69);e({target:"Object",stat:!0,forced:r(5)((function(){i(1)}))},{keys:function(t){return i(o(t))}})},function(t,n,r){t.exports=r(246)},function(t,n,r){var e=r(247);t.exports=e},function(t,n,r){var e=r(14),o=r(248),i=Array.prototype;t.exports=function(t){var n=t.filter;return t===i||e(i,t)&&n===i.filter?o:n}},function(t,n,r){r(249);var e=r(40);t.exports=e("Array").filter},function(t,n,r){"use strict";var e=r(0),o=r(56).filter;e({target:"Array",proto:!0,forced:!r(55)("filter")},{filter:function(t){return o(this,t,arguments.length>1?arguments[1]:void 0)}})}]);`,"Worker",void 0,void 0)}},function(t,n,e){var r=e(3),s=e(15),i=e(9),o=e(304),a={log:{key:{keyPath:"time"},indexes:{level:{unique:!1},time:{unique:!0}}}};function d(){var u=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.server=null,this.expire=u.expire||72,this.name=u.name}var c=d.prototype;c.init=function(){var u=this;if(!this.server)return o.open({server:"nim-log-"+this.name,version:1,schema:a}).then(function(m){u.server=m})},c.putLog=function(u){var m=this;if(!this.server)return r.reject("no db server");var y=s(u).call(u,-1)[0].time-36e5*this.expire;return this.deleteLogs(y).then(function(){return m.server.add("log",u)})},c.getAllLogs=function(){return this.server?this.server.query("log","time").all().execute().then(function(u){var m={},y=s(u).call(u,-1)[0];return m.logs=i(u).call(u,function(S){return S.log}).join(`\r
`),m.time=y&&y.time,m}):r.reject("no db server")},c.deleteLogs=function(u){return this.server?this.server.remove("log",null,"time",0,u):r.reject("no db server")},t.exports=d},function(t,n,e){e(253);var r=e(13);t.exports=r.setInterval},function(t,n,e){var r=e(19),s=e(572),i=Function.prototype;t.exports=function(o){var a=o.bind;return o===i||r(i,o)&&a===i.bind?s:a}},function(t,n,e){e(573);var r=e(29);t.exports=r("Function").bind},function(t,n,e){var r=e(1),s=e(274);r({target:"Function",proto:!0,forced:Function.bind!==s},{bind:s})},function(t,n,e){var r=e(18),s=e(26),i=e(2),o=e(24),a=e(4),d=e(62),c=e(187);function u(S){S.onuploading&&this.on("uploading",S.onuploading),c.call(this,S)}var m=c.prototype,y=u.prototype=r(m);y.doSend=function(){var S,O,k,g=this.options,v=g.headers,ue=this.xhr=new XMLHttpRequest;if(v["Content-Type"]==="multipart/form-data"){var L,re;delete v["Content-Type"],ue.upload.onprogress=s(L=this.onProgress).call(L,this),ue.upload.onload=s(re=this.onProgress).call(re,this);var le,oe=g.data;g.data=new window.FormData,oe&&i(le=d.getKeys(oe,g.putFileAtEnd)).call(le,function(ie){var Ne=oe[ie];Ne.tagName&&Ne.tagName.toUpperCase()==="INPUT"?Ne.type==="file"&&i([]).call(Ne.files,function(Ve){g.data.append(d.dataset(Ne,"name")||Ne.name||Ve.name||"file-"+d.uniqueID(),Ve)}):g.data.append(ie,Ne)})}else if(v["x-nos-token"]){var he,Ie;ue.upload.onprogress=s(he=this.onProgress).call(he,this),ue.upload.onload=s(Ie=this.onProgress).call(Ie,this)}ue.onreadystatechange=s(S=this.onStateChange).call(S,this),g.timeout!==0&&(this.timer=o(s(k=this.onTimeout).call(k,this),g.timeout)),ue.open(g.method,g.url,!g.sync),i(O=a(v)).call(O,function(ie){ue.setRequestHeader(ie,v[ie])}),g.cookie&&"withCredentials"in ue&&(ue.withCredentials=!0),ue.send(g.data),this.afterSend()},y.onProgress=function(S){S.lengthComputable&&S.loaded<=S.total&&this.emit("uploading",S)},y.onStateChange=function(){var S,O=this.xhr;O.readyState===4&&(S={status:O.status,result:O.responseText||""},this.onLoad(S))},y.getResponseHeader=function(S){var O=this.xhr;return O?O.getResponseHeader(S):""},y.destroy=function(){clearTimeout(this.timer);try{this.xhr.onreadystatechange=d.f,this.xhr.abort()}catch{}m.destroy.call(this)},t.exports=u},function(t,n,e){var r;/*!
 * EventEmitter v5.2.9 - git.io/ee
 * Unlicense - http://unlicense.org/
 * Oliver Caldwell - https://oli.me.uk/
 * @preserve
 */(function(s){function i(){}var o=i.prototype,a=s.EventEmitter;function d(u,m){for(var y=u.length;y--;)if(u[y].listener===m)return y;return-1}function c(u){return function(){return this[u].apply(this,arguments)}}o.getListeners=function(u){var m,y,S=this._getEvents();if(u instanceof RegExp)for(y in m={},S)S.hasOwnProperty(y)&&u.test(y)&&(m[y]=S[y]);else m=S[u]||(S[u]=[]);return m},o.flattenListeners=function(u){var m,y=[];for(m=0;m<u.length;m+=1)y.push(u[m].listener);return y},o.getListenersAsObject=function(u){var m,y=this.getListeners(u);return y instanceof Array&&((m={})[u]=y),m||y},o.addListener=function(u,m){if(!function k(g){return typeof g=="function"||g instanceof RegExp||!(!g||typeof g!="object")&&k(g.listener)}(m))throw new TypeError("listener must be a function");var y,S=this.getListenersAsObject(u),O=typeof m=="object";for(y in S)S.hasOwnProperty(y)&&d(S[y],m)===-1&&S[y].push(O?m:{listener:m,once:!1});return this},o.on=c("addListener"),o.addOnceListener=function(u,m){return this.addListener(u,{listener:m,once:!0})},o.once=c("addOnceListener"),o.defineEvent=function(u){return this.getListeners(u),this},o.defineEvents=function(u){for(var m=0;m<u.length;m+=1)this.defineEvent(u[m]);return this},o.removeListener=function(u,m){var y,S,O=this.getListenersAsObject(u);for(S in O)O.hasOwnProperty(S)&&(y=d(O[S],m))!==-1&&O[S].splice(y,1);return this},o.off=c("removeListener"),o.addListeners=function(u,m){return this.manipulateListeners(!1,u,m)},o.removeListeners=function(u,m){return this.manipulateListeners(!0,u,m)},o.manipulateListeners=function(u,m,y){var S,O,k=u?this.removeListener:this.addListener,g=u?this.removeListeners:this.addListeners;if(typeof m!="object"||m instanceof RegExp)for(S=y.length;S--;)k.call(this,m,y[S]);else for(S in m)m.hasOwnProperty(S)&&(O=m[S])&&(typeof O=="function"?k.call(this,S,O):g.call(this,S,O));return this},o.removeEvent=function(u){var m,y=typeof u,S=this._getEvents();if(y==="string")delete S[u];else if(u instanceof RegExp)for(m in S)S.hasOwnProperty(m)&&u.test(m)&&delete S[m];else delete this._events;return this},o.removeAllListeners=c("removeEvent"),o.emitEvent=function(u,m){var y,S,O,k,g=this.getListenersAsObject(u);for(k in g)if(g.hasOwnProperty(k))for(y=g[k].slice(0),O=0;O<y.length;O++)(S=y[O]).once===!0&&this.removeListener(u,S.listener),S.listener.apply(this,m||[])===this._getOnceReturnValue()&&this.removeListener(u,S.listener);return this},o.trigger=c("emitEvent"),o.emit=function(u){var m=Array.prototype.slice.call(arguments,1);return this.emitEvent(u,m)},o.setOnceReturnValue=function(u){return this._onceReturnValue=u,this},o._getOnceReturnValue=function(){return!this.hasOwnProperty("_onceReturnValue")||this._onceReturnValue},o._getEvents=function(){return this._events||(this._events={})},i.noConflict=function(){return s.EventEmitter=a,i},(r=(function(){return i}).call(s,e,s,t))===void 0||(t.exports=r)})(typeof window<"u"?window:this||{})},function(t,n,e){var r=e(18),s=e(7),i=e(2),o=e(26),a=e(90),d=e(62),c=e(187),u=e(275),m="NEJ-UPLOAD-RESULT:",y={};function S(g){this.init(),c.call(this,g)}var O=c.prototype,k=S.prototype=r(O);k.init=function(){var g=!1;function v(ue){var L=ue.data;if(s(L).call(L,m)===0){var re=(L=JSON.parse(L.replace(m,""))).key,le=y[re];le&&(delete y[re],L.result=decodeURIComponent(L.result||""),le.onLoad(L.result))}}return function(){(function(){if(!g){g=!0;var ue=d.getGlobal();ue.postMessage?d.on(ue,"message",v):(u.addMsgListener(v),u.startTimer())}})()}}(),k.doSend=function(){var g=this,v=g.options,ue=g.key="zoro-ajax-upload-iframe-"+d.uniqueID();y[ue]=g;var L=g.form=d.html2node('<form style="display:none;"></form>');typeof document>"u"||document.body.appendChild(L),L.target=ue,L.method="POST",L.enctype="multipart/form-data",L.encoding="multipart/form-data";var re=v.url,le=d.genUrlSep(re);L.action=re+le+"_proxy_=form";var oe,he=v.data,Ie=[],ie=[];he&&i(oe=d.getKeys(he,v.putFileAtEnd)).call(oe,function(Ce){var Ue=he[Ce];if(Ue.tagName&&Ue.tagName.toUpperCase()==="INPUT"){if(Ue.type==="file"){var qe=Ue,Oe=qe.cloneNode(!0);qe.parentNode.insertBefore(Oe,qe);var $e=d.dataset(qe,"name");$e&&(qe.name=$e),L.appendChild(qe),d.isFunction(qe.setAttribute)&&(qe.setAttribute("form",""),qe.removeAttribute("form")),Ie.push(Ue),ie.push(Oe)}}else{var _e=d.html2node('<input type="hidden"/>');_e.name=Ce,_e.value=Ue,L.appendChild(_e)}});function Ne(){i(Ie).call(Ie,function(Ce,Ue){var qe=ie[Ue];qe.parentNode&&(Ce.name=qe.name,d.isFunction(Ce.setAttribute)&&Ce.setAttribute("form",qe.getAttribute("form")),qe.parentNode.replaceChild(Ce,qe))})}var Ve=g.iframe=d.createIframe({name:ue,onload:function(){var Ce;g.aborted?Ne():(d.on(Ve,"load",o(Ce=g.checkResult).call(Ce,g)),L.submit(),Ne(),g.afterSend())}})},k.checkResult=function(){var g,v;try{var ue,L;if(g=this.iframe.contentWindow.document.body,v=a(ue=g.innerText||g.textContent||"").call(ue),s(v).call(v,m)>=0||s(L=g.innerHTML).call(L,m)>=0)return}catch{return}this.onLoad(v)},k.onLoad=function(g){O.onLoad.call(this,{status:200,result:g}),d.remove(this.form),d.remove(this.iframe),O.destroy.call(this)},k.destroy=function(){d.remove(this.iframe),d.remove(this.form)},k.abort=function(){this.aborted=!0,delete y[this.key],O.abort.call(this)},t.exports=S},function(t,n,e){var r=e(578);t.exports=r},function(t,n,e){var r=e(19),s=e(579),i=String.prototype;t.exports=function(o){var a=o.trim;return typeof o=="string"||o===i||r(i,o)&&a===i.trim?s:a}},function(t,n,e){e(580);var r=e(29);t.exports=r("String").trim},function(t,n,e){var r=e(1),s=e(185).trim;r({target:"String",proto:!0,forced:e(581)("trim")},{trim:function(){return s(this)}})},function(t,n,e){var r=e(227).PROPER,s=e(5),i=e(148);t.exports=function(o){return s(function(){return!!i[o]()||"​᠎"[o]()!=="​᠎"||r&&i[o].name!==o})}},function(t,n,e){var r=e(18),s=e(7),i=e(26),o=e(2),a=e(62),d=e(275),c=e(187),u={};function m(O){this.init(),c.call(this,O)}var y=c.prototype,S=m.prototype=r(y);S.init=function(){var O="NEJ-AJAX-DATA:",k=!1;function g(v){var ue=v.data;if(s(ue).call(ue,O)===0){var L=(ue=JSON.parse(ue.replace(O,""))).key,re=u[L];re&&(delete u[L],ue.result=decodeURIComponent(ue.result||""),re.onLoad(ue))}}return function(){(function(){if(!k){k=!0;var v=a.getGlobal();v.postMessage?a.on(v,"message",g):d.addMsgListener(g)}})()}}(),S.doSend=function(){var O=this.options,k=a.url2origin(O.url),g=O.proxyUrl||k+"/res/nej_proxy_frame.html",v=u[g];if(a.isArray(v)){var ue;v.push(i(ue=this.doSend).call(ue,this,O))}else{var L;if(!v)return u[g]=[i(L=this.doSend).call(L,this,O)],void a.createIframe({src:g,onload:function(oe){var he=u[g];u[g]=a.target(oe).contentWindow,o(he).call(he,function(Ie){try{Ie()}catch{}})}});if(!this.aborted){var re=this.key=a.uniqueID();u[re]=this;var le=a.fetch({method:"GET",url:"",data:null,headers:{},timeout:0},O);le.key=re,d.postMessage(v,{data:le}),this.afterSend()}}},S.abort=function(){this.aborted=!0,delete u[this.key],y.abort.call(this)},t.exports=m},function(t,n,e){var r,s,i=e(8),o=e(62),a=e(118),d=(r=/json/i,s=/post/i,function(c,u){var m=(u=u||{}).data=u.data||{},y=u.headers=u.headers||{},S=o.checkWithDefault(y,"Accept","application/json"),O=o.checkWithDefault(y,"Content-Type","application/json");return r.test(S)&&(u.type="json"),s.test(u.method)&&r.test(O)&&(u.data=i(m)),a(c,u)});t.exports=d},function(t,n,e){var r=e(4),s=e(16),i=e(7),o=e(2),a=e(6),d=e(15),c=e(24);t.exports={wrapSafeCallback:function(u,m){if(u.__wrapSafeCallback__)return u;u.__wrapSafeCallback__=!0;var y=r(u);return y=s(y).call(y,function(S){return i(S).call(S,"on")===0&&Object.prototype.toString.call(u[S])==="[object Function]"}),o(y).call(y,function(S){var O=u[S];u[S]=function(){var k=this;try{var g;return O.call.apply(O,a(g=[this]).call(g,d(Array.prototype).call(arguments)))}catch(ue){var v;this.logger.error(a(v="wrapSafeCallback. CallbackName: ".concat(S,". Error: ")).call(v,ue)),c(function(){var L;throw k.logger.error(a(L="wrapSafeCallback. throw error in setTimeout. CallbackName: ".concat(S,". Error: ")).call(L,ue)),ue},0),m.logger&&m.logger.error("userOption:".concat(S," function error"),ue)}}}),u}}},function(t,n,e){var r=e(586);t.exports=r},function(t,n,e){e(587);var r=e(13);t.exports=r.Date.now},function(t,n,e){var r=e(1),s=e(12),i=Date,o=s(i.prototype.getTime);r({target:"Date",stat:!0},{now:function(){return o(new i)}})},function(t,n,e){var r=e(77).fn,s=e(0),i=e(25).reportAPI;r.isConnected=function(){return i({instance:this,className:"ApiBaseFn",funcName:"isConnected",hasCallback:!1}),!!this.protocol&&this.protocol.isConnected()},r.connect=function(){i({instance:this,className:"ApiBaseFn",funcName:"connect",hasCallback:!1}),this.protocol.processId=s.guid(),this.protocol.connect()},r.detectHeartbeat=function(){this.protocol.detectHeartbeat()},r.disconnect=function(){}},function(t,n,e){var r=e(22),s=e(8),i=e(26),o=e(9),a=e(37),d=e(15),c=e(141),u=e(90),m=e(7),y=e(48),S=e(24),O=e(10),k=e(32),g=e(2),v=e(6),ue=e(4),L=e(52),re=e(16),le=e(53),oe=e(54),he=e(55),Ie=e(43),ie=e(51),Ne=e(125),Ve=["loc_x","loc_y","loc_z"];function Ce(xe,nr){var ir=ue(xe);if(L){var dr=L(xe);nr&&(dr=re(dr).call(dr,function(Lt){return le(xe,Lt).enumerable})),ir.push.apply(ir,dr)}return ir}function Ue(xe){for(var nr=1;nr<arguments.length;nr++){var ir,dr,Lt=arguments[nr]!=null?arguments[nr]:{};nr%2?g(ir=Ce(Object(Lt),!0)).call(ir,function(cr){ie(xe,cr,Lt[cr])}):oe?he(xe,oe(Lt)):g(dr=Ce(Object(Lt))).call(dr,function(cr){Ie(xe,cr,le(Lt,cr))})}return xe}var qe=e(77).fn,Oe=e(0),$e=e(608),_e=e(41),er=e(11),Pt=e(277),ar=e(278),pr=e(285),lr=e(107).EMExceptionState,or=e(25).reportAPI;qe.sendText=function(xe){(xe=xe||{}).done=or({instance:this,className:"ApiBaseFn",funcName:"sendText",async:!0,done:xe.done});var nr=xe,ir=nr.loc_x,dr=nr.loc_y,Lt=nr.loc_z,cr=Ne(nr,Ve);return ir===void 0||dr===void 0||Lt===void 0?xe=Ue({},cr):(typeof xe.loc_x!="number"&&(xe.loc_x=0),typeof xe.loc_y!="number"&&(xe.loc_y=0),typeof xe.loc_z!="number"&&(xe.loc_z=0)),this.processCallback(xe),xe.msg=new this.message.TextMessage(xe),this.sendMsg(xe)},qe.previewFile=function(xe,nr){var ir;(xe=xe||{}).done=or({instance:this,className:"ApiBaseFn",funcName:"previewFile",done:xe.done});var dr=this,Lt=dr.protocol.appGrayConfig;if(Lt&&Lt.grayConfig&&Lt.grayConfig.mixStoreEnable&&(xe.mixEnable=!0),Oe.verifyOptions(xe,"done","msg::previewFile"),xe.type||(xe.type="file"),Oe.verifyParamPresentJustOne(xe,"dataURL blob fileInput filePath wxFilePath fileObject","msg::previewFile"),Oe.exist(xe.maxSize)&&Oe.verifyParamType("maxSize",xe.maxSize,"number","api::previewFile"),Oe.exist(xe.commonUpload)&&Oe.verifyParamType("commonUpload",xe.commonUpload,"boolean","api::previewFile"),xe.nosSurvivalTime?(Oe.verifyParamType("nosSurvivalTime",xe.nosSurvivalTime,"number","api::Base.getInstance"),Oe.verifyParamMin("nosSurvivalTime",xe.nosSurvivalTime,86400,"api::Base.getInstance")):xe.nosSurvivalTime=this.nosSurvivalTime,xe.filePath=xe.filePath||xe.wxFilePath,delete xe.wxFilePath,xe.dataURL)xe.blob=pr.fromDataURL(xe.dataURL);else if(!xe.blob){if(xe.fileInput){if(xe.fileInput=Oe.verifyFileInput(xe.fileInput,"msg::previewFile"),xe.fileInput.files){if(!xe.fileInput.files.length)return void xe.done(_e.newNoFileError("请选择"+xe.type+"文件",{callFunc:"msg::previewFile",fileInput:xe.fileInput}),xe);xe.fileSize=xe.fileInput.files[0].size}xe.fileInputName=Oe.getFileName(xe.fileInput)}}this.processCallback(xe);var cr=s(Pt.genResponseBody(xe.type)||{}).replace(/"/gi,'\\"'),mr=null,tr=xe.transcode?"getNosTokenTrans":"getNosToken";if(xe.transcode){Oe.verifyOptions(xe,"fileInput","msg::previewFile");var At=Oe.getFileInfo(xe.fileInput);mr={transToken:{name:At.name,type:At.transcodeType,transType:xe.transcode==="png"?11:10,size:At.size,body:cr}}}else mr=cr;this[tr]({responseBody:mr,nosToken:{nosScene:xe.nosScene||this.nosScene,nosSurvivalTime:xe.nosSurvivalTime},callback:i(ir=function(kt,Dt){if(kt)xe.done(kt);else if(xe.transcode?(xe.nosToken=Dt.nosToken,xe.docId=Dt.docId):xe.nosToken=Dt,xe.logger=dr.logger,xe.mixEnable){var gr,yr;if(!this.protocol.mixStorePolicy)try{this.protocol.mixStorePolicy=JSON.parse(localStorage.getItem("NIM-AllMixStorePolicy"))[this.options.appKey]}catch(vr){dr.logger.error("error:","get last mixStorePolicy failed",vr)}if(!this.protocol.mixStorePolicy)return void dr.logger.error("error:","get mixStorePolicy failed");xe.providers=o(gr=this.protocol.mixStorePolicy.providers||[]).call(gr,function(vr){return Number(vr)}),xe.curProvider=xe.providers[0]?Number(xe.providers[0]):1,xe.nosPolicy=this.protocol.mixStorePolicy.nosPolicy,xe.s3Policy=this.protocol.mixStorePolicy.s3Policy,dr.getMixStoreToken({curProvider:xe.curProvider,responseBody:mr,callback:i(yr=function(vr,Ir){vr?xe.done(vr):(xe.mixStoreToken=Ir,xe.getMixStoreToken=function(Mr,Ar){dr.getMixStoreToken({curProvider:Mr,responseBody:mr,callback:function(Fr,Dr){Fr?xe.done(Fr):Ar(Dr)}})},xe.curProvider===1&&(xe.nosToken=Ir),dr._doPreviewFile(xe,nr))}).call(yr,dr)})}else this._doPreviewFile(xe,nr)}).call(ir,this)})},qe._doPreviewFile=function(xe,nr){var ir=this;xe=Oe.merge(xe,ir.options.providers);var dr=er.genUploadUrl(xe.nosToken.bucket);xe.mixEnable&&xe.curProvider===1&&(dr=er.genUploadUrl(xe.mixStoreToken.bucket));var Lt,cr=er.chunkUploadUrl;ir.logger.info("_doPreviewFile: start upload"),xe.commonUpload||!cr||er.isWeixinApp||er.isNodejs||er.isRN?(xe.commonUpload=!0,Lt=dr):(Lt=cr,xe.nosLbsUrls=er.nosLbsUrls,ir.options.edgeList?xe.edgeList=ir.options.edgeList:xe.updateNosEdgeList=function(Dt){ir.options.edgeList=Dt}),ir.protocol.reporterHook.emit("reporter/uploadStart");var mr=this.assembleUploadParams(xe.nosToken);xe.mixEnable&&xe.curProvider===1&&(mr=this.assembleUploadParams(xe.mixStoreToken));function tr(Dt,gr,yr,vr){if(Dt){var Ir=Oe.get(Dt,"msg.message")||Oe.get(Dt,"message")||"Unknown error message",Mr=Oe.get(Dt,"msg.code")||Oe.get(Dt,"code")||"Unknown error code";ir.logger.warn("_doPreviewFile: upload done, failed ",Mr,Ir),ir.protocol.reporterHook.emit("reporter/uploadEnd",Dt.code==="RequestAbortedError"||Dt.code==="abort"?lr.kCanceled:lr.kFailed);var Ar=a({},vr||nr,{status:"fail"}),Fr=Ue(Ue({},xe.callback.options),{},{msg:Ar});return xe.uploaddone&&xe.uploaddone(Dt,Fr,Ar),void xe.done(Dt,xe.callback.options)}if(ir.logger.info("_doPreviewFile: upload done, success"),ir.protocol.reporterHook.emit("reporter/uploadEnd",lr.kSucceed),xe.uploaddone&&xe.uploaddone(null,Oe.copy(gr),vr||nr),gr=Pt.parseResponse(gr,ir.options.exifOrientation),yr||gr.isS3||(gr.url=er.genDownloadUrl(xe.nosToken,mr.Object,er.serverNosConfig.cdnDomain),xe.nosToken.shortUrl&&(gr._url_safe=xe.nosToken.shortUrl)),Oe.exist(xe.fileInputName))gr.name=xe.fileInputName;else if(xe.blob){var Dr=xe.blob.name;if(gr.name=Dr||"blob-"+gr.md5,!Dr){var Or=xe.blob.type;gr.ext=d(Or).call(Or,c(Or).call(Or,"/")+1)}}else xe.filePath?gr.name=xe.filePath:xe.fileObject&&(gr.name=xe.fileObject.fileName);if(!gr.ext){var Sn,Rr,Wr=c(Sn=gr.name).call(Sn,".");Wr===-1?gr.ext="unknown":gr.ext=d(Rr=gr.name).call(Rr,Wr+1)}gr.size=gr.size||0,gr.isS3&&gr._url_safe?ir.getNosOriginUrl({safeShortUrl:gr._url_safe,done:function(Er,Ur){Er?ir.logger.error("error:","getNosOriginUrl failed",Er):(gr.url=Ur,xe.done(null,Oe.copy(gr)))}}):xe.done(null,Oe.copy(gr))}if(er.isWeixinApp)Oe.verifyOptions(xe,"filePath","msg::_doPreviewFile"),ir.fileQuickTransfer(xe,tr,function(){var Dt=wx.uploadFile({url:Lt,filePath:xe.filePath,name:"file",formData:mr,fail:function(gr){tr({code:"FAILED",msg:gr}),ir.logger.error("error:","api::msg:upload file failed",gr)},success:function(gr){if(gr.statusCode===200)try{tr(null,JSON.parse(gr.data))}catch(yr){ir.logger.error("error:","parse wx upload file res error",yr),tr({code:"PARSE_WX_UPLOAD_FILE_RES_ERROR",str:gr.data,msg:gr.errMsg})}else tr({code:gr.statusCode,msg:gr.errMsg})}});typeof xe.uploadprogress=="function"&&Dt&&(xe.beginupload(Dt,nr),ir.logger.info("_doPreviewFile::mini uploadprogress"),Dt.onProgressUpdate(function(gr){xe.uploadprogress({total:gr.totalBytesExpectedToSend,loaded:gr.totalBytesSent,percentage:gr.progress,percentageText:gr.progress+"%"},nr)}))});else if(er.isNodejs){var At={url:Lt,name:"file",formData:mr,success:function(Dt){if(Dt.statusCode===200)try{tr(null,JSON.parse(Dt.data))}catch(gr){ir.protocol.logger.error("error:","parse nodejs upload file res error",gr),tr({code:"PARSE_NODEJS_UPLOAD_FILE_RES_ERROR",str:Dt.data,msg:Dt.errMsg})}else tr({code:Dt.statusCode,msg:Dt.errMsg})},fail:function(Dt){tr({code:"FAILED",msg:Dt}),ir.protocol.logger.error("error:","api::msg:upload file failed",Dt)}};if(xe.filePath)At.filePath=xe.filePath;else{if(r(xe.fileObject)!=="object")throw new _e("Nodejs上传fileObject参数类型应如 {fileName:..,fileData:..} ");At.fileData=xe.fileObject.fileData}ir.fileQuickTransfer(xe,tr,function(){ar.uploadFile(At)})}else if(er.isRN){var kt={url:Lt,name:"file",formData:mr,filePath:xe.filePath,success:function(Dt){if(Dt.ok&&Dt.status===200)try{var gr=o(Dt.headers)&&o(Dt.headers).etag;Dt.md5=gr?typeof gr=="string"?gr:gr[0]:"UNKNOWN",tr(null,Dt)}catch(yr){ir.protocol.logger.error("error:","parse React Native upload file res error",yr),tr({code:"PARSE_React_Native_UPLOAD_FILE_RES_ERROR",res:Dt})}else tr({code:Dt.status,msg:Dt.statusText})},fail:function(Dt){tr({code:"FAILED",msg:Dt}),ir.protocol.logger.error("error:","api::msg:upload file failed",Dt)}};ir.fileQuickTransfer(xe,tr,function(){ar.uploadFile(kt)})}else xe.url=Lt,xe.params=mr,xe.fileName="file",ir.fileQuickTransfer(xe,tr,function(){return ir.protocol.adaptersUploadFile(a({},xe,{uploaddone:tr}),nr)})},qe.fileQuickTransfer=function(xe,nr,ir){var dr,Lt=this;xe=xe||{},nr instanceof Function||(nr=function(){}),ir instanceof Function||(ir=function(){});var cr=xe.fastPass;if(cr)try{cr=JSON.parse(cr),xe.fastPass=cr}catch{Lt.protocol.logger.error("快传参数解析失败")}var mr=xe.fileInputName||xe.name||xe.blob&&xe.blob.name||"",tr=xe.fileSize||xe.size||xe.blob&&xe.blob.size||0,At=cr?u(dr=(cr.md5||xe.digest||"")+"").call(dr):"",kt=xe.type||xe.blob&&xe.blob.type;if(At&&tr>=er.threshold){var Dt=!0,gr={name:mr,md5:At,ext:d(mr).call(mr,c(mr).call(mr,".")+1),type:kt};switch(kt){case"image":cr&&cr.w&&cr.h?(gr.w=cr.w,gr.h=cr.h):(Dt=!1,Lt.protocol.logger.error("快传 image 文件缺少参数 w 或 h"));break;case"video":cr&&cr.w&&cr.h&&cr.dur?(gr.w=cr.w,gr.h=cr.h,gr.dur=cr.dur):(Dt=!1,Lt.protocol.logger.error("快传 video 文件缺少参数 w 或 h 或 dur"));break;case"audio":cr&&cr.dur?gr.dur=cr.dur:(Dt=!1,Lt.protocol.logger.error("快传 audio 文件缺少参数 dur"))}if(!Dt)return void ir();var yr={fileQuickTransfer:{md5:At}};return tr&&(yr.fileQuickTransfer.size=tr),this.protocol.sendCmd("fileQuickTransfer",yr,function(vr,Ir,Mr){!vr&&Mr&&Mr.fileQuickTransfer&&Mr.fileQuickTransfer.url||(Lt.protocol.logger.error("misc::fileQuickTransfer: not found",vr,Ir),ir()),Mr&&Mr.fileQuickTransfer&&Mr.fileQuickTransfer.threshold&&(er.threshold=Mr.fileQuickTransfer.threshold||0),Mr&&Mr.fileQuickTransfer&&Mr.fileQuickTransfer.url&&(gr.size=tr||Mr.fileQuickTransfer.size,gr.url=Mr.fileQuickTransfer.url,Mr.fileQuickTransfer._url_safe&&(gr._url_safe=Mr.fileQuickTransfer._url_safe),nr(vr,gr,!0))})}ir()},qe.sendFile=function(xe){if((xe=xe||{}).done=or({instance:this,className:"ApiBaseFn",funcName:"sendFile",done:xe.done}),xe.type||(xe.type="file"),xe=Oe.merge(xe,this.options.providers),Oe.verifyParamPresentJustOne(xe,"dataURL blob fileInput file filePath wxFilePath fileObject","msg::sendFile"),Oe.exist(xe.maxSize)&&Oe.verifyParamType("maxSize",xe.maxSize,"number","api::previewFile"),Oe.exist(xe.commonUpload)&&Oe.verifyParamType("commonUpload",xe.commonUpload,"boolean","api::previewFile"),this.processCallback(xe),xe.filePath=xe.filePath||xe.wxFilePath,delete xe.wxFilePath,xe.dataURL)return this._previewAndSendFile(xe);if(xe.blob)return this._previewAndSendFile(xe);if(xe.fileInput)return xe.fileInput=Oe.verifyFileInput(xe.fileInput,"msg::sendFile"),xe.fileInput.files&&!xe.fileInput.files.length?void xe.done(_e.newNoFileError("请选择"+xe.type+"文件",{callFunc:"msg::sendFile",fileInput:xe.fileInput}),xe.callback.options):this._previewAndSendFile(xe);if(xe.filePath||xe.fileObject)return this._previewAndSendFile(xe);if(xe.file){var nr,ir=xe.file._url_safe;return ir&&(nr=xe.file.url,xe.file.url=ir,delete xe.file._url_safe),xe.msg=new this.message.FileMessage(xe),this.sendMsg(xe,nr)}},qe._previewAndSendFile=function(xe){var nr=this;Oe.verifyCallback(xe,"uploaddone beforesend","msg::_previewAndSendFile");var ir=Ue({},xe),dr=new nr.message.Message(ir);dr.type=xe.type;var Lt=nr.formatReturnMsg(dr),cr=nr.protocol.reporterHook.getSafeClock(),mr={apiCallingTime:nr.protocol.reporterHook.getNTPTime(cr),attachUploadDuration:0},tr=xe.done;return xe.done=function(At,kt){if(xe.done=tr,At){var Dt=a({},Lt,{status:"fail"}),gr=Ue(Ue({},xe.callback.options),{},{msg:Dt});xe.done(At,gr)}else{if(mr.attachUploadDuration=nr.protocol.reporterHook.getSafeClock()-cr,/chatroom/.test(xe.scene))return;var yr,vr=kt._url_safe;vr&&!kt.isS3&&(yr=kt.url,kt.url=vr,delete kt._url_safe),xe.file=kt,xe.msg=new nr.message.FileMessage(xe,dr.idClient),xe.beforesend(nr.sendMsg(xe,yr,mr))}},nr.previewFile(xe,Lt),Lt},qe.assembleUploadParams=function(xe){return xe?{Object:decodeURIComponent(xe.objectName),"x-nos-token":xe.token,"x-nos-entity-type":"json"}:null},qe.deleteFile=function(xe){or({instance:this,className:"ApiBaseFn",funcName:"deleteFile",hasCallback:!1}),Oe.verifyParamPresentJustOne(xe,"docId","msg::deleteFile"),this.removeFile({docId:xe.docId,callback:function(nr,ir){nr?xe.error&&xe.error(nr,ir):xe.success&&xe.success(ir)}})},qe.getFile=function(xe){or({instance:this,className:"ApiBaseFn",funcName:"getFile",hasCallback:!1}),Oe.verifyParamPresentJustOne(xe,"docId","msg::getFile"),this.fetchFile({docId:xe.docId,callback:function(nr,ir){nr?xe.error&&xe.error(nr,ir):xe.success&&xe.success(ir.info)}})},qe.getFileList=function(xe){or({instance:this,className:"ApiBaseFn",funcName:"getFileList",hasCallback:!1});var nr=xe.fromDocId,ir=nr===void 0?"":nr,dr=xe.limit,Lt=dr===void 0?10:dr,cr={limit:Lt};ir&&(cr.fromDocId=ir),this.fetchFileList({fileListParam:cr,callback:function(mr,tr){mr?(Lt>30&&(mr.message=mr.message+"::文档条数超过限制:30"),xe.error&&xe.error(mr,tr)):xe.success&&xe.success(tr)}})},qe.sendGeo=function(xe){return(xe=xe||{}).done=or({instance:this,className:"ApiBaseFn",funcName:"sendGeo",done:xe.done}),this.processCallback(xe),xe.msg=new this.message.GeoMessage(xe),this.sendMsg(xe)},qe.sendTipMsg=function(xe){return(xe=xe||{}).done=or({instance:this,className:"ApiBaseFn",funcName:"sendTipMsg",done:xe.done}),this.processCallback(xe),xe.msg=new this.message.TipMessage(xe),this.sendMsg(xe)},qe.sendCustomMsg=function(xe){return(xe=xe||{}).done=or({instance:this,className:"ApiBaseFn",funcName:"sendCustomMsg",done:xe.done}),this.processCallback(xe),xe.msg=new this.message.CustomMessage(xe),this.sendMsg(xe)},qe.sendRobotMsg=function(xe){return(xe=xe||{}).done=or({instance:this,className:"ApiBaseFn",funcName:"sendRobotMsg",done:xe.done}),this.logger.warn("this api will be abandon"),this.processCallback(xe),xe.msg=new this.message.RobotMessage(xe),this.sendMsg(xe)},qe.sendMsg=function(xe,nr,ir){var dr=this,Lt=dr.protocol,cr=xe.msg,mr={};ir=ir||{apiCallingTime:Lt.reporterHook.getNTPTime(),attachUploadDuration:0};var tr,At=!!xe.isLocal;if(this.logger.warn("sendMsg::start: "+cr.idClient),At&&(xe.time&&(cr.time=xe.time),xe.idClient&&(cr.idClient=xe.idClient),xe.localFrom&&(tr=xe.localFrom+"")),xe.resend&&(xe.flow!=="out"||xe.status!=="fail"))return Oe.onError("只能重发发送失败的消息");xe.callback.options.idClient=cr.idClient,dr.beforeSendMsg(xe,mr);var kt=xe.rtnMsg=dr.formatReturnMsg(cr,tr);if(nr&&!dr.options.keepNosSafeUrl&&kt.file&&(kt.file._url_safe=kt.file.url,kt.file.url=nr,kt.type==="audio"&&(kt.file.mp3Url=nr+(~m(nr).call(nr,"?")?"&":"?")+"audioTrans&type=mp3")),kt.hasOwnProperty("chatroomId")&&!kt.chatroomId)return Oe.onError("聊天室未连接");if(At&&(kt.status="success",kt.isLocal=!0),Lt.storeSendMsg&&(mr.promise=Lt.storeSendMsg(kt)),xe.cbaop=function(gr,yr){if(gr)return gr.code===7101&&(kt.isInBlackList=!0,kt.idServer=yr.idServer,kt.time=yr.time),gr.from!=="server"?(kt.status="fail",Lt.updateSendMsgError&&Lt.updateSendMsgError(kt),kt):void 0},!At){nr&&!dr.options.keepNosSafeUrl&&xe.callback&&(xe.callback.originUrl=nr),xe.toAccids&&xe.toAccids.length&&(cr.toAccids=s(xe.toAccids)),mr.msg=cr,ir.sendTime=Lt.reporterHook.getNTPTime(),Lt.reporterHook.hasOriginTimetick()&&(mr.msg.__clientExt=s({statistics:ir}));var Dt=cr;dr.sendCmd(xe.cmd,mr,function(){if(er.isBrowser){var gr=arguments[0],yr=arguments[1]||{},vr=dr.subType==="chatroom",Ir=Dt.scene===0,Mr=Lt.reporterHook.getNTPTime(),Ar={msgId:yr.idServer,clientId:Dt.idClient,msgTime:yr.time||0,fromAccid:dr.account,toAccid:Ir?Dt.to:"",type:vr?4:Dt.scene,roomId:vr?dr.options.chatroomId:"",tid:vr||Ir?"":Dt.to,result:gr?gr.code:200,failReason:gr?gr.message:"",rt:y(Mr-ir.apiCallingTime),apiCallingTime:ir.apiCallingTime,sendTime:ir.sendTime,attachUploadDuration:ir.attachUploadDuration,apiCallbackTime:Mr};dr.reporter&&dr.reporter.report("msgSend",Ar)}xe.callback&&xe.callback.apply(dr,arguments);var Fr=arguments[0],Dr=arguments[1];!Fr&&Dr&&Dr.from===Dr.to&&dr.protocol.markMsgRead(Dr)})}return dr.afterSendMsg(xe),At&&S(function(){kt=Oe.simpleClone(kt),xe.done(null,kt)},0),Oe.copy(kt)},qe.beforeSendMsg=function(){},qe.afterSendMsg=function(){},qe.formatReturnMsg=function(xe,nr){var ir;return xe=Oe.copy(xe),this.protocol.completeMsg(xe),xe.status="sending",nr&&(xe.from=nr),xe=O(ir=this.message).call(ir,xe),xe=this.protocol.amendMsg(xe)},qe.resendMsg=function(xe){return(xe=xe||{}).done=or({instance:this,className:"ApiBaseFn",funcName:"resendMsg",done:xe.done}),Oe.verifyOptions(xe,"msg","msg::resendMsg"),this.trimMsgFlag(xe),xe.resend=!0,this._sendMsgByType(xe)},qe.forwardMsg=function(xe){return(xe=xe||{}).done=or({instance:this,className:"ApiBaseFn",funcName:"forwardMsg",done:xe.done}),Oe.verifyOptions(xe,"msg","msg::forwardMsg"),this.trimMsgFlag(xe),this.beforeForwardMsg(xe),xe.forward=!0,xe.msg.idClient=Oe.guid(),this._sendMsgByType(xe)},qe.trimMsgFlag=function(xe){xe&&xe.msg&&(xe.msg=Oe.copy(xe.msg),delete xe.msg.resend,delete xe.msg.forward)},qe.beforeForwardMsg=function(){},qe._sendMsgByType=function(xe){switch(Oe.verifyOptions(xe,"msg","msg::_sendMsgByType"),Oe.verifyParamValid("msg.type",xe.msg.type,this.message.validTypes,"msg::_sendMsgByType"),Oe.merge(xe,xe.msg),xe.type){case"text":return this.sendText(xe);case"image":case"audio":case"video":case"file":return this.sendFile(xe);case"geo":return this.sendGeo(xe);case"custom":return this.sendCustomMsg(xe);case"tip":return this.sendTipMsg(xe);default:throw new _e("不能发送类型为 "+xe.type+" 的消息")}},qe.parseRobotTemplate=function(xe){if(this.logger.warn("this api will be abandon"),/<template[^>/]+\/>/.test(xe))return{raw:xe,json:[{type:"text",name:"",text:""}]};if(!/<template[^>/]+>/.test(xe))return{raw:xe,json:[{type:"text",name:"",text:xe}]};var nr=new $e({escapeMode:!1});xe=xe.replace(/<template [^>]+>/,"<template>");var ir=nr.xml2js(xe);ir=ir.template.LinearLayout,k(ir)||(ir=[ir]);var dr=[];return ir=g(ir).call(ir,function(mr){mr.image&&(dr=v(dr).call(dr,cr(mr))),mr.text&&(dr=v(dr).call(dr,Lt(mr))),mr.link&&(dr=v(dr).call(dr,function(tr){if(tr.link){var At=tr.link;k(At)||(At=[At]),At=o(At).call(At,function(kt){return kt.image&&(kt.image=cr(kt)),kt.text&&(kt.text=Lt(kt)),kt._type==="url"?(kt.type="url",kt.style=kt._style||"",kt.target=kt._target,delete kt._target,delete kt._style):kt._type==="block"&&(kt.type="block",kt.style=kt._style||"",kt.params=kt._params||"",kt.target=kt._target,delete kt._params,delete kt._target,delete kt._style),delete kt._type,kt}),tr.link=At}return tr.link}(mr)))}),{raw:xe,json:dr};function Lt(mr){var tr;return k(mr.text)||(mr.text=[mr.text]),mr.text=o(tr=mr.text).call(tr,function(At){return{type:"text",name:At._name,text:At.__text}}),mr.text}function cr(mr){var tr;return k(mr.image)||(mr.image=[mr.image]),mr.image=o(tr=mr.image).call(tr,function(At){return{type:"image",name:At._name,url:At._url}}),mr.image}}},function(t,n,e){e(591);var r=e(13);t.exports=r.Object.assign},function(t,n,e){var r=e(1),s=e(592);r({target:"Object",stat:!0,arity:2,forced:Object.assign!==s},{assign:s})},function(t,n,e){var r=e(27),s=e(12),i=e(20),o=e(5),a=e(120),d=e(135),c=e(150),u=e(42),m=e(127),y=Object.assign,S=Object.defineProperty,O=s([].concat);t.exports=!y||o(function(){if(r&&y({b:1},y(S({},"a",{enumerable:!0,get:function(){S(this,"b",{value:3,enumerable:!1})}}),{b:2})).b!==1)return!0;var k={},g={},v=Symbol();return k[v]=7,"abcdefghijklmnopqrst".split("").forEach(function(ue){g[ue]=ue}),y({},k)[v]!=7||a(y({},g)).join("")!="abcdefghijklmnopqrst"})?function(k,g){for(var v=u(k),ue=arguments.length,L=1,re=d.f,le=c.f;ue>L;)for(var oe,he=m(arguments[L++]),Ie=re?O(a(he),re(he)):a(he),ie=Ie.length,Ne=0;ie>Ne;)oe=Ie[Ne++],r&&!i(le,he,oe)||(v[oe]=he[oe]);return v}:y},function(t,n,e){var r=e(19),s=e(594),i=Array.prototype;t.exports=function(o){var a=o.reverse;return o===i||r(i,o)&&a===i.reverse?s:a}},function(t,n,e){e(595);var r=e(29);t.exports=r("Array").reverse},function(t,n,e){var r=e(1),s=e(12),i=e(83),o=s([].reverse),a=[1,2];r({target:"Array",proto:!0,forced:String(a)===String(a.reverse())},{reverse:function(){return i(this)&&(this.length=this.length),o(this)}})},function(t,n,e){t.exports=e(597)},function(t,n,e){t.exports=e(598)},function(t,n,e){var r=e(599);t.exports=r},function(t,n,e){var r=e(255);t.exports=r},function(t,n,e){t.exports=e(601)},function(t,n,e){var r=e(602);t.exports=r},function(t,n,e){var r=e(207);t.exports=r},function(t,n,e){var r=e(604),s=e(188);t.exports=function(i,o){if(i==null)return{};var a,d,c={},u=r(i);for(d=0;d<u.length;d++)a=u[d],s(o).call(o,a)>=0||(c[a]=i[a]);return c},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,n,e){t.exports=e(605)},function(t,n,e){t.exports=e(606)},function(t,n,e){var r=e(607);t.exports=r},function(t,n,e){var r=e(231);t.exports=r},function(t,n,e){var r,s,i;(function(o,a){s=[],(i=typeof(r=function(d){return function(c){(c=c||{}).arrayAccessForm=c.arrayAccessForm||"none",c.emptyNodeForm=c.emptyNodeForm||"text",c.jsAttributeFilter=c.jsAttributeFilter,c.jsAttributeConverter=c.jsAttributeConverter,c.attributeConverters=c.attributeConverters||[],c.datetimeAccessFormPaths=c.datetimeAccessFormPaths||[],c.arrayAccessFormPaths=c.arrayAccessFormPaths||[],c.xmldomOptions=c.xmldomOptions||{},c.enableToStringFunc===void 0&&(c.enableToStringFunc=!0),c.skipEmptyTextNodesForObj===void 0&&(c.skipEmptyTextNodesForObj=!0),c.stripWhitespaces===void 0&&(c.stripWhitespaces=!0),c.useDoubleQuotes===void 0&&(c.useDoubleQuotes=!0),c.ignoreRoot===void 0&&(c.ignoreRoot=!1),c.escapeMode===void 0&&(c.escapeMode=!0),c.attributePrefix===void 0&&(c.attributePrefix="_"),c.selfClosingElements===void 0&&(c.selfClosingElements=!0),c.keepCData===void 0&&(c.keepCData=!1),c.keepText===void 0&&(c.keepText=!1),c.jsDateUTC===void 0&&(c.jsDateUTC=!1),function(){function qe(Oe){var $e=String(Oe);return $e.length===1&&($e="0"+$e),$e}typeof String.prototype.trim!="function"&&(String.prototype.trim=function(){return this.replace(/^\s+|^\n+|(\s|\n)+$/g,"")}),typeof Date.prototype.toISOString!="function"&&(Date.prototype.toISOString=function(){return this.getUTCFullYear()+"-"+qe(this.getUTCMonth()+1)+"-"+qe(this.getUTCDate())+"T"+qe(this.getUTCHours())+":"+qe(this.getUTCMinutes())+":"+qe(this.getUTCSeconds())+"."+String((this.getUTCMilliseconds()/1e3).toFixed(3)).slice(2,5)+"Z"})}();var u=1,m=3,y=4,S=8,O=9;function k(qe){var Oe=qe.localName;return Oe==null&&(Oe=qe.baseName),Oe!=null&&Oe!==""||(Oe=qe.nodeName),Oe}function g(qe){return typeof qe=="string"?qe.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;"):qe}function v(qe,Oe,$e){switch(c.arrayAccessForm){case"property":qe[Oe]instanceof Array?qe[Oe+"_asArray"]=qe[Oe]:qe[Oe+"_asArray"]=[qe[Oe]]}if(!(qe[Oe]instanceof Array)&&c.arrayAccessFormPaths.length>0){for(var _e=!1,er=0;er<c.arrayAccessFormPaths.length;er++){var Pt=c.arrayAccessFormPaths[er];if(typeof Pt=="string"){if(Pt===$e){_e=!0;break}}else if(Pt instanceof RegExp){if(Pt.test($e)){_e=!0;break}}else if(typeof Pt=="function"&&Pt(Oe,$e)){_e=!0;break}}_e&&(qe[Oe]=[qe[Oe]])}}function ue(qe){var Oe=qe.split(/[-T:+Z]/g),$e=new Date(Oe[0],Oe[1]-1,Oe[2]),_e=Oe[5].split(".");if($e.setHours(Oe[3],Oe[4],_e[0]),_e.length>1&&$e.setMilliseconds(_e[1]),Oe[6]&&Oe[7]){var er=60*Oe[6]+Number(Oe[7]);er=0+((/\d\d-\d\d:\d\d$/.test(qe)?"-":"+")=="-"?-1*er:er),$e.setMinutes($e.getMinutes()-er-$e.getTimezoneOffset())}else qe.indexOf("Z",qe.length-1)!==-1&&($e=new Date(Date.UTC($e.getFullYear(),$e.getMonth(),$e.getDate(),$e.getHours(),$e.getMinutes(),$e.getSeconds(),$e.getMilliseconds())));return $e}function L(qe,Oe){for(var $e={__cnt:0},_e=qe.childNodes,er=0;er<_e.length;er++){var Pt=_e.item(er),ar=k(Pt);Pt.nodeType!==S&&($e.__cnt++,$e[ar]==null?($e[ar]=re(Pt,Oe+"."+ar),v($e,ar,Oe+"."+ar)):($e[ar]instanceof Array||($e[ar]=[$e[ar]],v($e,ar,Oe+"."+ar)),$e[ar][$e[ar].length]=re(Pt,Oe+"."+ar)))}for(var pr=0;pr<qe.attributes.length;pr++){var lr=qe.attributes.item(pr);$e.__cnt++;for(var or=lr.value,xe=0;xe<c.attributeConverters.length;xe++){var nr=c.attributeConverters[xe];nr.test.call(null,lr.name,lr.value)&&(or=nr.convert.call(null,lr.name,lr.value))}$e[c.attributePrefix+lr.name]=or}var ir=qe.prefix;return ir&&($e.__cnt++,$e.__prefix=ir),$e["#text"]&&($e.__text=$e["#text"],$e.__text instanceof Array&&($e.__text=$e.__text.join(`
`)),c.escapeMode&&($e.__text=$e.__text.replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&#x27;/g,"'").replace(/&amp;/g,"&")),c.stripWhitespaces&&($e.__text=$e.__text.trim()),delete $e["#text"],c.arrayAccessForm==="property"&&delete $e["#text_asArray"],$e.__text=function(dr,Lt,cr){if(c.datetimeAccessFormPaths.length>0)for(var mr=cr.split(".#")[0],tr=0;tr<c.datetimeAccessFormPaths.length;tr++){var At=c.datetimeAccessFormPaths[tr];if(typeof At=="string"){if(At===mr)return ue(dr)}else if(At instanceof RegExp){if(At.test(mr))return ue(dr)}else if(typeof At=="function"&&At(mr))return ue(dr)}return dr}($e.__text,0,Oe+".#text")),$e.hasOwnProperty("#cdata-section")&&($e.__cdata=$e["#cdata-section"],delete $e["#cdata-section"],c.arrayAccessForm==="property"&&delete $e["#cdata-section_asArray"]),$e.__cnt===1&&$e.__text&&!c.keepText?$e=$e.__text:$e.__cnt===0&&c.emptyNodeForm==="text"?$e="":$e.__cnt>1&&$e.__text!==void 0&&c.skipEmptyTextNodesForObj&&(c.stripWhitespaces&&$e.__text===""||$e.__text.trim()==="")&&delete $e.__text,delete $e.__cnt,c.keepCData||$e.hasOwnProperty("__text")||!$e.hasOwnProperty("__cdata")||Object.keys($e).length!==1?(c.enableToStringFunc&&($e.__text||$e.__cdata)&&($e.toString=function(){return(this.__text?this.__text:"")+(this.__cdata?this.__cdata:"")}),$e):$e.__cdata?$e.__cdata:""}function re(qe,Oe){return qe.nodeType===O?function($e){for(var _e={},er=$e.childNodes,Pt=0;Pt<er.length;Pt++){var ar=er.item(Pt);if(ar.nodeType===u){var pr=k(ar);c.ignoreRoot?_e=re(ar,pr):_e[pr]=re(ar,pr)}}return _e}(qe):qe.nodeType===u?L(qe,Oe):qe.nodeType===m||qe.nodeType===y?qe.nodeValue:null}function le(qe,Oe,$e,_e){var er="<"+(qe&&qe.__prefix?qe.__prefix+":":"")+Oe;if($e)for(var Pt=0;Pt<$e.length;Pt++){var ar=$e[Pt],pr=qe[ar];c.escapeMode&&(pr=g(pr)),er+=" "+ar.substr(c.attributePrefix.length)+"=",c.useDoubleQuotes?er+='"'+pr+'"':er+="'"+pr+"'"}return er+=_e?" />":">"}function oe(qe,Oe){return"</"+(qe&&qe.__prefix?qe.__prefix+":":"")+Oe+">"}function he(qe,Oe){return c.arrayAccessForm==="property"&&($e=Oe.toString(),_e="_asArray",$e.indexOf(_e,$e.length-_e.length)!==-1)||Oe.toString().indexOf(c.attributePrefix)===0||Oe.toString().indexOf("__")===0||qe[Oe]instanceof Function;var $e,_e}function Ie(qe){var Oe=0;if(qe instanceof Object)for(var $e in qe)he(qe,$e)||Oe++;return Oe}function ie(qe){var Oe=[];if(qe instanceof Object)for(var $e in qe)$e.toString().indexOf("__")===-1&&$e.toString().indexOf(c.attributePrefix)===0&&Oe.push($e);return Oe}function Ne(qe){var Oe="";return qe instanceof Object?Oe+=function($e){var _e="";return $e.__cdata&&(_e+="<![CDATA["+$e.__cdata+"]]>"),($e.__text||typeof $e.__text=="number"||typeof $e.__text=="boolean")&&(c.escapeMode?_e+=g($e.__text):_e+=$e.__text),_e}(qe):qe!==null&&(c.escapeMode?Oe+=g(qe):Oe+=qe),Oe}function Ve(qe,Oe,$e){var _e="";return c.jsAttributeFilter&&c.jsAttributeFilter.call(null,Oe,qe)||(c.jsAttributeConverter&&(qe=c.jsAttributeConverter.call(null,Oe,qe)),qe!=null&&qe!==""||!c.selfClosingElements?typeof qe=="object"?Object.prototype.toString.call(qe)==="[object Array]"?_e+=function(er,Pt,ar){var pr="";if(er.length===0)pr+=le(er,Pt,ar,!0);else for(var lr=0;lr<er.length;lr++)pr+=Ve(er[lr],Pt,ie(er[lr]));return pr}(qe,Oe,$e):qe instanceof Date?(_e+=le(qe,Oe,$e,!1),_e+=c.jsDateUTC?qe.toUTCString():qe.toISOString(),_e+=oe(qe,Oe)):Ie(qe)>0||typeof qe.__text=="number"||typeof qe.__text=="boolean"||qe.__text||qe.__cdata?(_e+=le(qe,Oe,$e,!1),_e+=Ce(qe),_e+=oe(qe,Oe)):c.selfClosingElements?_e+=le(qe,Oe,$e,!0):(_e+=le(qe,Oe,$e,!1),_e+=oe(qe,Oe)):(_e+=le(qe,Oe,$e,!1),_e+=Ne(qe),_e+=oe(qe,Oe)):_e+=le(qe,Oe,$e,!0)),_e}function Ce(qe){var Oe="";if(Ie(qe)>0){for(var $e in qe)if(!he(qe,$e)){var _e=qe[$e];Oe+=Ve(_e,$e,ie(_e))}}return Oe+=Ne(qe)}function Ue(qe){if(qe===void 0||typeof qe!="string")return null;var Oe=null,$e=null;if(d)$e=(Oe=new d(c.xmldomOptions)).parseFromString(qe,"text/xml");else if(window&&window.DOMParser){Oe=new window.DOMParser;var _e=null;if(!(window.ActiveXObject||"ActiveXObject"in window)&&document.all&&!document.addEventListener)try{_e=Oe.parseFromString("INVALID","text/xml").childNodes[0].namespaceURI}catch{_e=null}try{$e=Oe.parseFromString(qe,"text/xml"),_e!==null&&$e.getElementsByTagNameNS(_e,"parsererror").length>0&&($e=null)}catch{$e=null}}else qe.indexOf("<?")===0&&(qe=qe.substr(qe.indexOf("?>")+2)),($e=new ActiveXObject("Microsoft.XMLDOM")).async="false",$e.loadXML(qe);return $e}this.asArray=function(qe){return qe==null?[]:qe instanceof Array?qe:[qe]},this.toXmlDateTime=function(qe){return qe instanceof Date?qe.toISOString():typeof qe=="number"?new Date(qe).toISOString():null},this.asDateTime=function(qe){return typeof qe=="string"?ue(qe):qe},this.xml2dom=function(qe){return Ue(qe)},this.dom2js=function(qe){return re(qe,null)},this.js2dom=function(qe){return Ue(this.js2xml(qe))},this.xml2js=function(qe){var Oe=Ue(qe);return Oe!=null?this.dom2js(Oe):null},this.js2xml=function(qe){return Ce(qe)},this.getVersion=function(){return"3.4.4"}}})=="function"?r.apply(n,s):r)===void 0||(t.exports=i)})()},function(t,n,e){var r=e(118);t.exports=function(s,i){return i.method="POST",i.headers=i.headers||{},i.headers["Content-Type"]="multipart/form-data",i.timeout=0,i.type=i.type||"json",r(s,i)}},function(t,n,e){var r=e(15),s=e(48),i=e(7),o=e(3),a=e(11),d=a.chunkSize,c=e(118),u={mp4:"video/mp4",avi:"video/x-msvideo",wmv:"video/x-ms-wmv",mpeg:"video/mpeg",mov:"video/quicktime",aac:"audio/x-aac",wma:"audio/x-ms-wma",wav:"audio/x-wav",mp3:"audio/mp3"};t.exports=function m(y,S,O,k){var g={file:y.data[S],fileSize:y.data[S].size,fileUploadedSize:0,percentage:0},v=y.url;function ue(Ve){var Ce=g.fileUploadedSize+Ve.loaded,Ue=Math.floor(1e4*Ce/g.fileSize)/100;if(s(Ue)>=100&&(Ue=100,ue=function(){}),g.percentage!==Ue){g.percentage=Ue;var qe={docId:y.docId,total:g.fileSize,loaded:Ce,percentage:Ue,percentageText:Ue+"%"};y.fileInput&&(qe.fileInput=y.fileInput),y.blob&&(qe.blob=y.blob),y.uploadprogress(qe)}}function L(Ve){try{Ve=JSON.parse(Ve)}catch(qe){return void O.onError(qe)}if(Ve.errMsg||Ve.errCode)O.onError(Ve);else if(Ve.offset<g.fileSize)delete he.onaftersend,g.fileUploadedSize=Ve.offset,function(qe,Oe,$e,_e){var er=qe.offset,Pt=qe.offset+d;if(typeof FileReader<"u"){var ar,pr=new FileReader;pr.readAsArrayBuffer(r(ar=_e.file).call(ar,er,Pt)),pr.addEventListener("load",function(or){Oe.data=or.target.result,Oe.query.offset=qe.offset,Oe.query.complete=Pt>=_e.fileSize,Oe.query.context=qe.context,Oe.onuploading=ue,Oe.onload=L,Oe.onerror=re,O.sn=c(v,Oe)}),pr.addEventListener("error",function(or){Oe.onerror(or.target.error)})}else{var lr;Oe.data=r(lr=_e.file).call(lr,er,Pt),Oe.query.offset=qe.offset,Oe.query.complete=Pt>=_e.fileSize,Oe.query.context=qe.context,Oe.onuploading=ue,Oe.onload=L,Oe.onerror=re,O.sn=c(v,Oe)}}(Ve,he,0,g);else{var Ce=a.genFileUrl(y.nosToken);y.type==="image"?c(Ce+"?imageInfo",{onload:function(qe){try{qe=JSON.parse(qe),y.uploaddone(null,{docId:Ve.docId,w:qe.Width,h:qe.Height,orientation:qe.Orientation||"",type:qe.Type,size:qe.Size||g.fileSize})}catch(Oe){Ue(Oe)}},onerror:function(qe){if(typeof Image<"u"){var Oe=new Image;Oe.src=Ce,Oe.onload=function(){y.uploaddone(null,{docId:Ve.docId,w:Oe.width,h:Oe.height,size:g.fileSize})},Oe.onerror=function($e){Ue($e)}}else Ue(qe)}}):y.type==="video"||y.type==="audio"?c(Ce+"?vinfo",{onload:function(qe){try{(qe=JSON.parse(qe)).GetVideoInfo&&qe.GetVideoInfo.VideoInfo&&(qe=qe.GetVideoInfo.VideoInfo),y.uploaddone(null,{docId:Ve.docId,w:qe.Width,h:qe.Height,dur:qe.Duration,orientation:qe.Rotate,audioCodec:qe.AudioCodec,videoCodec:qe.VideoCodec,container:qe.Container,size:qe.Size||g.fileSize})}catch(Oe){Ue(Oe)}},onerror:Ue}):y.uploaddone(null,{docId:Ve.docId,size:g.fileSize})}function Ue(qe){O.onError(qe)}}function re(Ve){y.errorHook(Ve,{url:v,provider:"nos"});var Ce=Ve&&Ve.code;function Ue(){try{if(Ve.result)var qe=JSON.parse(Ve.result);else qe=Ve;O.onError(qe)}catch(Oe){O.onError(Oe)}}g.fileUploadedSize===0&&Ce!=="abort"?y.edgeList?k<y.edgeList.length-1?m(y,S,O,k+1):Ue():y.nosLbsUrls&&y.nosLbsUrls.length>0?function(qe,Oe,$e,_e,er){return new o(function(Pt){function ar(){er.adaptersRequest($e[qe],{query:{version:"1.0",bucketname:Oe},method:"GET",onerror:pr,onload:function(lr){try{(lr=JSON.parse(lr))&&lr.upload&&lr.upload.length?Pt(lr.upload):pr()}catch{pr()}}},{exception_service:3})}function pr(){_e.onLbsUrlFail($e[qe]),qe<$e.length-1?(qe++,ar()):Pt([])}ar()})}(0,y.nosToken.bucket,y.nosLbsUrls,O,y).then(function(qe){qe.length>0?(y.edgeList=qe,y.updateNosEdgeList&&y.updateNosEdgeList(qe),m(y,S,O,k+1)):Ue()}):(y.edgeList=a.edgeList,m(y,S,O,k+1)):Ue()}typeof k!="number"&&(k=-1),y.edgeList&&y.edgeList.length&&(k=k>0?k:0,v=y.edgeList[k]),v+="/"+y.nosToken.bucket+"/"+y.nosToken.objectName;var le=y.data.file&&y.data.file.type;if(!le||i(le).call(le,"/")<0){var oe=(y.fileInputName||"").split(".").pop();y.type==="image"?le="image/"+(oe==="jpg"?"jpeg":oe):y.type!=="audio"&&y.type!=="video"||(le=u[oe])}var he={query:{offset:0,complete:d>=g.fileSize,version:"1.0"},headers:{"Content-Type":le||"application/octet-stream","x-nos-token":y.nosToken.token},method:"POST",timeout:0,onaftersend:function(){y.beginupload(O)},onuploading:ue,onload:L,onerror:re};if(typeof FileReader<"u"){var Ie,ie=new FileReader;ie.addEventListener("load",function(Ve){he.data=Ve.target.result,O.sn=c(v,he)}),ie.addEventListener("error",function(Ve){he.onerror(Ve.target.error)}),ie.readAsArrayBuffer(r(Ie=g.file).call(Ie,0,d))}else{var Ne;he.data=r(Ne=g.file).call(Ne,0,d),O.sn=c(v,he)}}},function(t,n,e){e(612);var r=e(13);t.exports=r.Reflect.construct},function(t,n,e){var r=e(1),s=e(33),i=e(79),o=e(274),a=e(172),d=e(36),c=e(28),u=e(84),m=e(5),y=s("Reflect","construct"),S=Object.prototype,O=[].push,k=m(function(){function ue(){}return!(y(function(){},[],ue)instanceof ue)}),g=!m(function(){y(function(){})}),v=k||g;r({target:"Reflect",stat:!0,forced:v,sham:v},{construct:function(ue,L){a(ue),d(L);var re=arguments.length<3?ue:a(arguments[2]);if(g&&!k)return y(ue,L,re);if(ue==re){switch(L.length){case 0:return new ue;case 1:return new ue(L[0]);case 2:return new ue(L[0],L[1]);case 3:return new ue(L[0],L[1],L[2]);case 4:return new ue(L[0],L[1],L[2],L[3])}var le=[null];return i(O,le,L),new(i(o,ue,le))}var oe=re.prototype,he=u(c(oe)?oe:S),Ie=i(ue,he,L);return c(Ie)?Ie:he}})},function(t,n,e){t.exports=e(614)},function(t,n,e){var r=e(615);t.exports=r},function(t,n,e){var r=e(216);t.exports=r},function(t,n,e){t.exports=e(617)},function(t,n,e){var r=e(618);t.exports=r},function(t,n,e){var r=e(619);t.exports=r},function(t,n,e){var r=e(620);t.exports=r},function(t,n,e){e(621);var r=e(13);t.exports=r.Object.setPrototypeOf},function(t,n,e){e(1)({target:"Object",stat:!0},{setPrototypeOf:e(138)})},function(t,n,e){t.exports=e(623)},function(t,n,e){var r=e(624);t.exports=r},function(t,n,e){var r=e(273);t.exports=r},function(t,n){t.exports=function(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,n,e){t.exports=e(627)},function(t,n,e){var r=e(628);t.exports=r},function(t,n,e){var r=e(284);t.exports=r},function(t,n,e){e(630);var r=e(13);t.exports=r.Object.getPrototypeOf},function(t,n,e){var r=e(1),s=e(5),i=e(42),o=e(137),a=e(229);r({target:"Object",stat:!0,forced:s(function(){o(1)}),sham:!a},{getPrototypeOf:function(d){return o(i(d))}})},function(t,n,e){var r,s=e(141),i=e(7),o=e(8),a=e(26),d=e(9),c=e(15),u=e(4),m=e(0),y=e(77).fn,S=e(286),O=e(277),k=e(41),g=e(25).reportAPI;y.transDoc=function(v){var ue;m.verifyOptions(v,"fileInput done","nos::transDoc");try{var L=v.fileInput.files[0],re=["ppt","pdf","pptx","doc","docx"],le=v.fileInputName=L.name,oe={ppt:1,pptx:2,pdf:3,doc:6,docx:7},he=le.substring(s(le).call(le,".")+1);if(i(re).call(re,he)<0)return void v.done(k.newNoFileError("请上传正确格式的文件【ppt, pptx, pdf, doc, docx】",{callFunc:"nos: transDoc",fileInput:v.fileInput}),v)}catch{return void v.done(k.newNoFileError("请上传正确的文件节点",{callFunc:"msg::previewFile",fileInput:v.fileInput}),v)}var Ie=o(O.genResponseBody("file")||{}).replace(/"/gi,'\\"'),ie={transToken:{name:le,type:oe[he],transType:v.transcode==="png"?11:10,size:L.size,body:Ie}};this.getNosTokenTrans({responseBody:ie,nosToken:{nosScene:v.nosScene||this.nosScene,nosSurvivalTime:v.nosSurvivalTime},callback:a(ue=function(Ne,Ve){Ne?v.done(Ne):(v.nosToken=Ve.nosToken,v.docId=Ve.docId,this._doPreviewFile(v))}).call(ue,this)})},y.getSimpleNosToken=function(){var v=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return v.num=1,m.verifyOptions(v),this.cbAndSendCmd("getSimpleNosToken",v)},y.getNosToken=function(v){var ue=v.callback,L=v.nosToken,re=v.responseBody,le={tag:L.nosScene};L.nosSurvivalTime&&L.nosSurvivalTime!==1/0&&(le.expireSec=L.nosSurvivalTime),this.sendCmd("getNosToken",{responseBody:re,nosToken:le},ue)},y.getNosTokenTrans=function(v){this.sendCmd("getNosTokenTrans",v.responseBody,v.callback)},y.getMixStoreToken=function(v){this.sendCmd("getMixStoreToken",{mixTokenReq:{provider:v.curProvider,tokenCount:v.tokenCount||1,tag:"im",returnBody:v.responseBody}},v.callback)},y.packFileDownloadName=function(v){g({instance:this,className:"ApiBaseFn",funcName:"packFileDownloadName",hasCallback:!1}),m.verifyOptions(v,"url name",!0,"","nos::packFileDownloadName");var ue=v.url;return ue+m.genUrlSep(ue)+"download="+encodeURIComponent(v.name)},y.audioToMp3=function(v){g({instance:this,className:"ApiBaseFn",funcName:"audioToMp3",hasCallback:!1}),m.verifyOptions(v,"url","nos::audioToMp3");var ue=v.url;return ue+m.genUrlSep(ue)+"audioTrans&type=mp3"},y.removeFile=function(v){this.sendCmd("removeFile",v,v.callback)},y.fetchFile=function(v){this.sendCmd("fetchFile",v,v.callback)},y.fetchFileList=function(v){this.sendCmd("fetchFileList",v,v.callback)},y.stripImageMeta=function(v){return g({instance:this,className:"ApiBaseFn",funcName:"stripImageMeta",hasCallback:!1}),this.beforeProcessImage(v,"stripmeta")},y.qualityImage=function(v){return g({instance:this,className:"ApiBaseFn",funcName:"qualityImage",hasCallback:!1}),this.beforeProcessImage(v,"quality")},y.interlaceImage=function(v){return g({instance:this,className:"ApiBaseFn",funcName:"interlaceImage",hasCallback:!1}),this.beforeProcessImage(v,"interlace")},y.rotateImage=function(v){return g({instance:this,className:"ApiBaseFn",funcName:"rotateImage",hasCallback:!1}),this.beforeProcessImage(v,"rotate")},y.blurImage=function(v){return g({instance:this,className:"ApiBaseFn",funcName:"blurImage",hasCallback:!1}),this.beforeProcessImage(v,"blur")},y.cropImage=function(v){return g({instance:this,className:"ApiBaseFn",funcName:"cropImage",hasCallback:!1}),this.beforeProcessImage(v,"crop")},y.thumbnailImage=function(v){return g({instance:this,className:"ApiBaseFn",funcName:"thumbnailImage",hasCallback:!1}),this.beforeProcessImage(v,"thumbnail")},y.beforeProcessImage=function(v,ue){var L=m.copy(v);return L.type=ue,v.ops=[L],this.processImage(v)},y.processImage=function(v){var ue;v.callback=g({instance:this,className:"ApiBaseFn",funcName:"processImage",done:v.callback});var L=this;m.verifyOptions(v,"url ops",!0,"","nos::processImage"),m.verifyParamType("ops",v.ops,"array","nos::processImage");var re=d(ue=v.ops).call(ue,function(le){var oe,he;return m.verifyOptions(le,"type",!0,"","nos::processImage"),m.verifyParamValid("type",le.type,S.validTypes,"nos::processImage"),L["gen"+c(oe=le.type).call(oe,0,1).toUpperCase()+c(he=le.type).call(he,1)+"Op"](le)});L.processCallback(v),L.sendCmd("processImage",{url:v.url,imageOps:re},v.callback)},y.genStripmetaOp=function(v){return new S({type:v.type,stripmeta:v.strip?1:0})},y.genQualityOp=function(v){m.verifyOptions(v,"quality",!0,"","nos::genQualityOp"),m.verifyParamType("quality",v.quality,"number","nos::genQualityOp"),m.verifyParamMin("quality",v.quality,0,"nos::genQualityOp"),m.verifyParamMax("quality",v.quality,100,"nos::genQualityOp");var ue=Math.round(v.quality);return new S({type:v.type,qualityQuality:ue})},y.genInterlaceOp=function(v){return new S({type:v.type})},y.genRotateOp=function(v){for(m.verifyOptions(v,"angle",!0,"","nos::genRotateOp"),m.verifyParamType("angle",v.angle,"number","nos::genRotateOp");v.angle<0;)v.angle=v.angle+360;v.angle=v.angle%360;var ue=Math.round(v.angle);return new S({type:v.type,rotateAngle:ue})},y.genBlurOp=function(v){m.verifyOptions(v,"radius sigma","nos::genBlurOp"),m.verifyParamType("radius",v.radius,"number","nos::genBlurOp"),m.verifyParamMin("radius",v.radius,1,"nos::genBlurOp"),m.verifyParamMax("radius",v.radius,50,"nos::genBlurOp"),m.verifyParamType("sigma",v.sigma,"number","nos::genBlurOp"),m.verifyParamMin("sigma",v.sigma,0,"nos::genBlurOp");var ue=Math.round(v.radius),L=Math.round(v.sigma);return new S({type:v.type,blurRadius:ue,blurSigma:L})},y.genCropOp=function(v){m.verifyOptions(v,"x y width height","nos::genCropOp"),m.verifyParamType("x",v.x,"number","nos::genCropOp"),m.verifyParamMin("x",v.x,0,"nos::genCropOp"),m.verifyParamType("y",v.y,"number","nos::genCropOp"),m.verifyParamMin("y",v.y,0,"nos::genCropOp"),m.verifyParamType("width",v.width,"number","nos::genCropOp"),m.verifyParamMin("width",v.width,0,"nos::genCropOp"),m.verifyParamType("height",v.height,"number","nos::genCropOp"),m.verifyParamMin("height",v.height,0,"nos::genCropOp");var ue=Math.round(v.x),L=Math.round(v.y),re=Math.round(v.width),le=Math.round(v.height);return new S({type:v.type,cropX:ue,cropY:L,cropWidth:re,cropHeight:le})},y.genThumbnailOp=(r={cover:"z",contain:"x",crop:"y"},function(v){m.verifyOptions(v,"mode","nos::genThumbnailOp"),m.verifyParamValid("mode",v.mode,u(r),"nos::genThumbnailOp"),v.mode==="contain"?m.verifyParamAtLeastPresentOne(v,"width height","nos::genThumbnailOp"):m.verifyOptions(v,"width height","nos::genThumbnailOp"),m.undef(v.width)&&(v.width=0),m.undef(v.height)&&(v.height=0),m.verifyParamType("width",v.width,"number","nos::genThumbnailOp"),m.verifyParamMin("width",v.width,0,"nos::genThumbnailOp"),m.verifyParamType("height",v.height,"number","nos::genThumbnailOp"),m.verifyParamMin("height",v.height,0,"nos::genThumbnailOp");var ue=Math.round(v.width),L=Math.round(v.height),re=new S({type:v.type,thumbnailMode:r[v.mode],thumbnailWidth:ue,thumbnailHeight:L});if(v.mode==="crop"&&m.notundef(v.axis)){m.undef(v.axis.x)&&(v.axis.x=5),m.undef(v.axis.y)&&(v.axis.y=5),m.verifyParamMin("axis.x",v.axis.x,0,"nos::genThumbnailOp"),m.verifyParamMax("axis.x",v.axis.x,10,"nos::genThumbnailOp"),m.verifyParamMin("axis.y",v.axis.y,0,"nos::genThumbnailOp"),m.verifyParamMax("axis.y",v.axis.y,10,"nos::genThumbnailOp");var le=Math.round(v.axis.x),oe=Math.round(v.axis.y);re.thumbnailAxisX=le,re.thumbnailAxisY=oe}return m.notundef(v.enlarge)&&(m.verifyParamType("enlarge",v.enlarge,"boolean","nos::genThumbnailOp"),v.enlarge&&(re.thumbnailEnlarge=1)),re.thumbnailToStatic=this.options.thumbnailToStatic?1:0,re}),y.getNosOriginUrl=function(v){var ue;(v=v||{}).done=g({instance:this,className:"ApiBaseFn",funcName:"getNosOriginUrl",done:v.done}),m.verifyOptions(v,"safeShortUrl",!0,"","nos::getNosOriginUrl"),m.verifyParamType("safeShortUrl",v.safeShortUrl,"string","nos::getNosOriginUrl"),/^http(s)?:/.test(v.safeShortUrl)&&~i(ue=v.safeShortUrl).call(ue,"im_url=1")?(this.processCallback(v),this.sendCmd("getNosOriginUrl",{nosFileUrlTag:{safeUrl:v.safeShortUrl}},v.callback)):v.done(new k("参数 “safeShortUrl” 内容非文件安全短链",{callFunc:"nos: getNosOriginUrl"}),v)}},function(t,n,e){var r,s=e(6),i=e(7),o=e(4),a=e(22),d=e(108),c=d.genUrlSep,u=d.url2object,m=d.object2url,y=e(0),S=e(77).fn,O=e(25).reportAPI;S.viewImageSync=function(k){O({instance:this,className:"ApiBaseFn",funcName:"viewImageSync",hasCallback:!1});var g=this.options;y.verifyOptions(k,"url","nos::viewImageSync");var v=k.url,ue=u(v),L=ue.protocol,re=ue.hostname,le=ue.path,oe=ue.query;if(typeof k.strip=="boolean"&&(oe.stripmeta=k.strip?1:0),typeof k.quality=="number"&&(y.verifyParamMin("quality",k.quality,0,"nos::viewImageSync"),y.verifyParamMax("quality",k.quality,100,"nos::viewImageSync"),oe.quality=Math.round(k.quality)),typeof k.interlace=="boolean"&&(oe.interlace=k.interlace?1:0),typeof k.rotate=="number"&&(oe.rotate=Math.round(k.rotate)),a(k.thumbnail)==="object"){var he=k.thumbnail.mode||"crop",Ie=k.thumbnail.width,ie=k.thumbnail.height;if(Ie>=0&&ie>=0&&Ie<4096&&ie<4096&&(Ie>0||ie>0)){var Ne,Ve;switch(he){case"crop":he="y";break;case"contain":he="x";break;case"cover":he="z";break;default:he="x"}oe.thumbnail=s(Ne=s(Ve="".concat(Ie)).call(Ve,he)).call(Ne,ie)}}if(g.downloadUrl){var Ce=u(k.url),Ue=g.downloadUrl,qe=Ce.path,Oe=i(qe).call(qe,"/");if(Oe!==-1){var $e=qe.substring(0,Oe),_e=qe.substring(Oe+1);Ue=Ue.replace("{bucket}",$e).replace("{object}",_e)}var er=u(Ue);return m({protocol:er.protocol,hostname:er.hostname,path:er.path,query:y.merge(er.query,oe)})}return m({protocol:L,hostname:re,path:le,query:oe})},S.viewImageStripMeta=function(k){O({instance:this,className:"ApiBaseFn",funcName:"viewImageStripMeta",hasCallback:!1}),y.verifyOptions(k,"url strip","nos::viewImageStripMeta"),y.verifyParamType("strip",k.strip,"boolean","nos::viewImageStripMeta");var g="stripmeta="+(k.strip?1:0),v=c(k.url);return k.url+v+g},S.viewImageQuality=function(k){O({instance:this,className:"ApiBaseFn",funcName:"viewImageQuality",hasCallback:!1}),y.verifyOptions(k,"url quality","nos::viewImageQuality"),y.verifyParamType("quality",k.quality,"number","nos::viewImageQuality"),y.verifyParamMin("quality",k.quality,0,"nos::viewImageQuality"),y.verifyParamMax("quality",k.quality,100,"nos::viewImageQuality");var g="quality="+Math.round(k.quality),v=c(k.url);return k.url+v+g},S.viewImageInterlace=function(k){O({instance:this,className:"ApiBaseFn",funcName:"viewImageInterlace",hasCallback:!1}),y.verifyOptions(k,"url","nos::viewImageInterlace");var g=c(k.url);return k.url+g+"interlace=1"},S.viewImageRotate=function(k){for(O({instance:this,className:"ApiBaseFn",funcName:"viewImageRotate",hasCallback:!1}),y.verifyOptions(k,"url angle","nos::viewImageRotate"),y.verifyParamType("angle",k.angle,"number","nos::viewImageRotate");k.angle<0;)k.angle=k.angle+360;k.angle=k.angle%360;var g="rotate="+Math.round(k.angle),v=c(k.url);return k.url+v+g},S.viewImageBlur=function(k){O({instance:this,className:"ApiBaseFn",funcName:"viewImageBlur",hasCallback:!1}),y.verifyOptions(k,"url radius sigma","nos::viewImageBlur"),y.verifyParamType("radius",k.radius,"number","nos::viewImageBlur"),y.verifyParamMin("radius",k.radius,1,"nos::viewImageBlur"),y.verifyParamMax("radius",k.radius,50,"nos::viewImageBlur"),y.verifyParamType("sigma",k.sigma,"number","nos::viewImageBlur"),y.verifyParamMin("sigma",k.sigma,0,"nos::viewImageBlur");var g="blur="+Math.round(k.radius)+"x"+Math.round(k.sigma),v=c(k.url);return k.url+v+g},S.viewImageCrop=function(k){O({instance:this,className:"ApiBaseFn",funcName:"viewImageCrop",hasCallback:!1}),y.verifyOptions(k,"url x y width height","nos::viewImageCrop"),y.verifyParamType("x",k.x,"number","nos::viewImageCrop"),y.verifyParamMin("x",k.x,0,"nos::viewImageCrop"),y.verifyParamType("y",k.y,"number","nos::viewImageCrop"),y.verifyParamMin("y",k.y,0,"nos::viewImageCrop"),y.verifyParamType("width",k.width,"number","nos::viewImageCrop"),y.verifyParamMin("width",k.width,0,"nos::viewImageCrop"),y.verifyParamType("height",k.height,"number","nos::viewImageCrop"),y.verifyParamMin("height",k.height,0,"nos::viewImageCrop");var g="crop="+Math.round(k.x)+"_"+Math.round(k.y)+"_"+Math.round(k.width)+"_"+Math.round(k.height),v=c(k.url);return k.url+v+g},S.viewImageThumbnail=(r={cover:"z",contain:"x",crop:"y"},function(k){y.verifyOptions(k,"url mode","nos::viewImageThumbnail"),y.verifyParamValid("mode",k.mode,o(r),"nos::viewImageThumbnail"),k.mode==="contain"?y.verifyParamAtLeastPresentOne(k,"width height","nos::viewImageThumbnail"):y.verifyOptions(k,"width height","nos::viewImageThumbnail"),y.undef(k.width)&&(k.width=0),y.undef(k.height)&&(k.height=0),y.verifyParamType("width",k.width,"number","nos::viewImageThumbnail"),y.verifyParamMin("width",k.width,0,"nos::viewImageThumbnail"),y.verifyParamType("height",k.height,"number","nos::viewImageThumbnail"),y.verifyParamMin("height",k.height,0,"nos::viewImageThumbnail");var g=Math.round(k.width),v=Math.round(k.height),ue="thumbnail="+g+r[k.mode]+v;k.mode==="crop"&&y.notundef(k.axis)&&(y.undef(k.axis.x)&&(k.axis.x=5),y.undef(k.axis.y)&&(k.axis.y=5),y.verifyParamMin("axis.x",k.axis.x,0,"nos::viewImageThumbnail"),y.verifyParamMax("axis.x",k.axis.x,10,"nos::viewImageThumbnail"),y.verifyParamMin("axis.y",k.axis.y,0,"nos::viewImageThumbnail"),y.verifyParamMax("axis.y",k.axis.y,10,"nos::viewImageThumbnail"),ue=ue+"&axis="+Math.round(k.axis.x)+"_"+Math.round(k.axis.y)),y.notundef(k.enlarge)&&(y.verifyParamType("enlarge",k.enlarge,"boolean","nos::viewImageThumbnail"),k.enlarge&&(ue+="&enlarge=1"));var L=c(k.url);return k.url+L+ue})},function(t,n,e){var r=e(634);t.exports=r},function(t,n,e){var r=e(19),s=e(635),i=e(637),o=Array.prototype,a=String.prototype;t.exports=function(d){var c=d.includes;return d===o||r(o,d)&&c===o.includes?s:typeof d=="string"||d===a||r(a,d)&&c===a.includes?i:c}},function(t,n,e){e(636);var r=e(29);t.exports=r("Array").includes},function(t,n,e){var r=e(1),s=e(163).includes,i=e(5),o=e(199);r({target:"Array",proto:!0,forced:i(function(){return!Array(1).includes()})},{includes:function(a){return s(this,a,arguments.length>1?arguments[1]:void 0)}}),o("includes")},function(t,n,e){e(638);var r=e(29);t.exports=r("String").includes},function(t,n,e){var r=e(1),s=e(12),i=e(639),o=e(110),a=e(50),d=e(641),c=s("".indexOf);r({target:"String",proto:!0,forced:!d("includes")},{includes:function(u){return!!~c(a(o(this)),a(i(u)),arguments.length>1?arguments[1]:void 0)}})},function(t,n,e){var r=e(640),s=TypeError;t.exports=function(i){if(r(i))throw s("The method doesn't accept regular expressions");return i}},function(t,n,e){var r=e(28),s=e(65),i=e(21)("match");t.exports=function(o){var a;return r(o)&&((a=o[i])!==void 0?!!a:s(o)=="RegExp")}},function(t,n,e){var r=e(21)("match");t.exports=function(s){var i=/./;try{"/./"[s](i)}catch{try{return i[r]=!1,"/./"[s](i)}catch{}}return!1}},function(t,n,e){var r=e(22),s=e(8),i=e(7),o=e(306),a=e(0),d=e(77).fn,c=e(11),u=e(25).reportAPI;function m(S,O,k,g){var v=!1,ue="";if(k===1?i(S).call(S,O)>=0&&(v=!0,ue=O):k===2&&(ue=new RegExp(O,"g")).test(S)&&(v=!0),v&&ue!=="")switch(g){case 1:return S.replace(ue,"**");case 2:return{code:2};case 3:return{code:3}}return S}function y(S,O){for(var k=O.match,g=O.operate,v=S,ue=0;ue<o(O).length;ue++){var L=o(O)[ue],re=L.match||k,le=L.operate||g;try{if(v=m(v,L.key,re,le),r(v)==="object")return v}catch(oe){this.logger.warn("misc::filterContent: js cannot parse this regexp ",oe)}}return v}d.uploadSdkLogUrl=function(S){return a.verifyOptions(S,"url","misc::uploadSdkLogUrl"),this.cbAndSendCmd("uploadSdkLogUrl",S)},d.getClientAntispamLexicon=function(S){var O=this;(S=S||{}).done=u({instance:this,className:"ApiBaseFn",funcName:"getClientAntispamLexicon",done:S.done});var k=(S=S||{}).done;k instanceof Function||(k=function(){}),S={clientAntispam:{version:0}};var g=this;if(c.hasLocalStorage&&localStorage.getItem("antispamLexicon")&&localStorage.getItem("antispamLexicon")!=="{}")try{g.antispamLexicon=JSON.parse(localStorage.getItem("antispamLexicon"))}catch(v){this.logger.error("JSON parse antispamLexicon error",v)}g.antispamLexicon&&k.call(this,null,{clientAntispam:g.antispamLexicon}),this.protocol.sendCmd("getClientAntispam",S,function(v,ue,L){v?(g.protocol.logger.error("misc::getClientAntispamLexicon:",v),k.call(O,v,{})):(c.hasLocalStorage&&localStorage.setItem("antispamLexicon",s(L.clientAntispam)),g.antispamLexicon||k.call(O,null,L),g.antispamLexicon=L.clientAntispam||{})})},d.filterClientAntispam=function(S){u({instance:this,className:"ApiBaseFn",funcName:"filterClientAntispam",hasCallback:!1});var O=S.content;if(!O)return{code:404,errmsg:"待反垃圾文本content不存在"};var k=this.antispamLexicon&&this.antispamLexicon.thesaurus;if(!k)return{code:404,errmsg:"没有反垃圾词库或者词库格式不合法"};try{k=JSON.parse(k).thesaurus}catch{return this.protocol.logger.error("misc::filterClientAntispam: parse thesaurus error"),{code:500,errmsg:"反垃圾词库格式不合法"}}for(var g=O,v=0;v<k.length;v++)if(g=y.call(this,g,k[v]),r(g)==="object"){if(g.code===2)return{code:200,type:2,errmsg:"建议拒绝发送",content:O,result:""};if(g.code===3)return{code:200,type:3,errmsg:"建议服务器处理反垃圾，发消息带上字段clientAntiSpam",content:O,result:O}}return g===O?{code:200,type:0,errmsg:"",content:O,result:g}:{code:200,type:1,errmsg:"已对特殊字符做了过滤",content:O,result:g}},d.getServerTime=function(S){(S=S||{}).done=u({instance:this,className:"ApiBaseFn",funcName:"getServerTime",done:S.done}),this.processCallback(S),this.sendCmd("getServerTime",{},S.callback)},d.getNosAccessToken=function(S){(S=S||{}).done=u({instance:this,className:"ApiBaseFn",funcName:"getNosAccessToken",done:S.done}),a.verifyOptions(S,"url","misc::getNosAccessToken"),this.processCallback(S);var O={url:S.url};S.userAgent&&(O.userAgent=S.userAgent),S.ext&&(O.ext=S.ext),this.sendCmd("getNosAccessToken",{nosAccessTokenTag:O},function(k,g,v){var ue=v&&v.nosAccessTokenTag&&v.nosAccessTokenTag.token,L=S.url,re=ue?{token:ue,resUrl:i(L).call(L,"?")!==-1?L+"&token="+ue:L+"?token="+ue}:{};S.done(k,re)})},d.deleteNosAccessToken=function(S){(S=S||{}).done=u({instance:this,className:"ApiBaseFn",funcName:"deleteNosAccessToken",done:S.done}),a.verifyOptions(S,"token","misc::deleteNosAccessToken"),this.processCallback(S),this.sendCmd("deleteNosAccessToken",{nosAccessTokenTag:{token:S.token}},S.callback)}},function(t,n,e){e(69);var r=e(67),s=e(30),i=e(19),o=e(644),a=Array.prototype,d={DOMTokenList:!0,NodeList:!0};t.exports=function(c){var u=c.keys;return c===a||i(a,c)&&u===a.keys||s(d,r(c))?o:u}},function(t,n,e){var r=e(645);t.exports=r},function(t,n,e){e(86),e(100);var r=e(29);t.exports=r("Array").keys},function(t,n,e){var r=e(22),s=e(3),i=e(9),o=e(8),a=e(77).fn,d=e(0),c=e(193),u=e(287),m=e(25).reportAPI;a.signalingCreate=function(){var y=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},S=y.type,O=y.channelName,k=y.ext;return d.verifyOptions(y,"type","api::signalling"),this.sendCmdUsePromise("signalingCreate",{avSignalTag:{type:S,channelName:O,ext:k}}).then(function(g){var v=g.avSignalTag;return s.resolve(v)}).catch(function(g){return s.reject(u.parseAvSignalError(g))})},a.signalingDelay=function(){var y=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return d.verifyOptions(y,"channelId","api::signalling"),this.sendCmdUsePromise("signalingDelay",{avSignalTag:y}).then(function(S){var O=S.avSignalTag;return s.resolve(O)}).catch(function(S){return s.reject(u.parseAvSignalError(S))})},a.signalingClose=function(){var y=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},S=y.offlineEnabled;return d.verifyOptions(y,"channelId","api::signalling"),this.sendCmdUsePromise("signalingClose",{avSignalTag:d.merge(y,{isSave:S===!0?1:0})}).then(function(O){var k=O.avSignalTag;return k.offlineEnabled=k.isSave===1,delete k.isSave,s.resolve(k)}).catch(function(O){return s.reject(u.parseAvSignalError(O))})},a.signalingJoin=function(){var y=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},S=y.offlineEnabled;return d.verifyOptions(y,"channelId","api::signalling"),this.sendCmdUsePromise("signalingJoin",{avSignalTag:d.merge(y,{isSave:S===!0?1:0})}).then(function(O){var k,g=O.avSignalTag,v=g.members;return typeof g.members=="string"&&(v=i(k=JSON.parse(g.members)).call(k,function(ue){return u.parseAvSignalMember(ue)})),g.members=v,s.resolve(g)}).catch(function(O){return s.reject(u.parseAvSignalError(O))})},a.signalingLeave=function(){var y=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},S=y.offlineEnabled;return d.verifyOptions(y,"channelId","api::signalling"),this.sendCmdUsePromise("signalingLeave",{avSignalTag:d.merge(y,{isSave:S===!0?1:0})}).then(function(O){var k=O.avSignalTag;return k.offlineEnabled=k.isSave===1,delete k.isSave,s.resolve(k)}).catch(function(O){return s.reject(u.parseAvSignalError(O))})},a.signalingGetChannelInfo=function(){var y=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},S=y.channelName;return d.verifyOptions(y,"channelName","api::signalling"),this.sendCmdUsePromise("signalingGetChannelInfo",{avSignalTag:{channelName:S}}).then(function(O){var k,g=O.avSignalTag,v=g.members;return typeof g.members=="string"&&(v=i(k=JSON.parse(g.members)).call(k,function(ue){return u.parseAvSignalMember(ue)})),g.members=v,s.resolve(g)}).catch(function(O){return s.reject(u.parseAvSignalError(O))})},a.signalingInvite=function(){var y=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},S=y.account,O=y.offlineEnabled,k=y.pushInfo,g=k===void 0?{}:k;d.verifyOptions(y,"channelId requestId account","api::signalling"),r(g.pushPayload)==="object"&&(g.pushPayload=o(g.pushPayload));var v=d.merge(y,g,{to:S,isSave:O===!0?1:0,needPush:g.needPush===!0?1:0,needBadge:g.needBadge===!1?0:1});return this.sendCmdUsePromise("signalingInvite",{avSignalTag:v}).then(function(ue){var L=ue.avSignalTag;return L.offlineEnabled=L.isSave===1,L.needBadge=L.needBadge===1,L.needPush=L.needPush===1,delete L.isSave,s.resolve(L)}).catch(function(ue){return s.reject(u.parseAvSignalError(ue))})},a.signalingCancel=function(y){var S=y.account,O=y.offlineEnabled;return d.verifyOptions(y,"channelId requestId account","api::signalling"),this.sendCmdUsePromise("signalingCancel",{avSignalTag:d.merge(y,{to:S,isSave:O===!0?1:0})}).then(function(k){var g=k.avSignalTag;return g.offlineEnabled=g.isSave===1,delete g.isSave,s.resolve(g)}).catch(function(k){return s.reject(u.parseAvSignalError(k))})},a.signalingCreateAndJoin=function(y){var S=this,O=m({instance:this,className:"ApiBaseFn",funcName:"signalingCreateAndJoin",hasCallback:!0}),k=y.channelName,g=y.uid,v=g===void 0?0:g,ue=y.offlineEnabled,L=ue===void 0||ue,re=y.attachExt,le=re===void 0?"":re;return this.signalingCreate(y).catch(function(oe){return oe.code===10405?(S.logger.warn("api::avSignal:signalingCall room already exists:",oe),S.signalingGetChannelInfo({channelName:k})):s.reject(oe)}).then(function(oe){var he={channelId:oe.channelId,offlineEnabled:L,attachExt:le,nertcChannelName:y.nertcChannelName,nertcTokenTtl:y.nertcTokenTtl,nertcJoinRoomQueryParamMap:y.nertcJoinRoomQueryParamMap};return v&&d.merge(he,{uid:v}),S.signalingJoin(he)}).then(function(oe){return typeof O=="function"&&O(void 0),oe}).catch(function(oe){throw typeof O=="function"&&O(oe),oe})},a.signalingCall=function(y){var S=this,O=m({instance:this,className:"ApiBaseFn",funcName:"signalingCall",hasCallback:!0}),k=y.account,g=y.offlineEnabled,v=y.requestId;d.verifyOptions(y,"type requestId account","api::signalling");var ue="";return this.signalingCreateAndJoin(y).then(function(L){ue=L.channelId||ue,S.logger.info("api::avSignal:signalingCall join:",ue);var re={channelId:ue,account:k,requestId:v,offlineEnabled:g,attachExt:y.attachExt||"",pushInfo:y.pushInfo||{},nertcTokenTtl:L.nertcTokenTtl,nertcToken:L.nertcToken};return S.signalingInvite(re)}).then(function(L){return typeof O=="function"&&O(void 0),L}).catch(function(L){throw typeof O=="function"&&O(L),L})},a.signalingReject=function(y){var S=y.account,O=y.offlineEnabled;return d.verifyOptions(y,"channelId requestId account","api::signalling"),this.sendCmdUsePromise("signalingReject",{avSignalTag:d.merge(y,{to:S,isSave:O===!0?1:0})}).then(function(k){var g=k.avSignalTag;return g.offlineEnabled=g.isSave===1,delete g.isSave,s.resolve(g)}).catch(function(k){return s.reject(u.parseAvSignalError(k))})},a.signalingAccept=function(y){var S=this,O=y.account,k=y.offlineEnabled;return d.verifyOptions(y,"channelId requestId account","api::signalling"),this.sendCmdUsePromise("signalingAccept",{avSignalTag:d.merge(y,{to:O,isSave:k===!0?1:0})}).then(function(g){var v=g.avSignalTag;return v.offlineEnabled=v.isSave===1,delete v.isSave,s.resolve(v)}).catch(function(g){return s.reject(u.parseAvSignalError(g))}).then(function(g){if(y.autoJoin){var v={channelId:y.channelId,offlineEnabled:y.offlineEnabled,attachExt:y.joinAttachExt,uid:y.uid,nertcChannelName:y.nertcChannelName,nertcTokenTtl:y.nertcTokenTtl,nertcJoinRoomQueryParamMap:y.nertcJoinRoomQueryParamMap};return S.signalingJoin(v)}return g})},a.signalingControl=function(y){var S=y.account;return d.verifyOptions(y,"channelId","api::signalling"),this.sendCmdUsePromise("signalingControl",{avSignalTag:d.merge(y,S?{to:S}:{})}).then(function(O){var k=O.avSignalTag;return s.resolve(k)}).catch(function(O){return s.reject(u.parseAvSignalError(O))})},a.signalingSync=function(){return this.sendCmdUsePromise("sync",{sync:{avSignal:0}}).then(function(y){var S=y.avSignalTag;return s.resolve(S)}).catch(function(y){return s.reject(u.parseAvSignalError(y))})},a.signalingMarkMsgRead=function(){var y=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};m({instance:this,className:"ApiBaseFn",funcName:"signalingMarkMsgRead",hasCallback:!1}),d.verifyOptions(y,"msgid","api::signalling");var S,O=c.idMap.avSignal;return S=typeof y.msgid=="string"?[y.msgid]:y.msgid,this.sendCmd("batchMarkRead",{sid:O.id,cid:O.signalingNotify,ids:S})},a.signalingCallEx=function(){var y=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},S=y.account,O=y.offlineEnabled,k=y.pushInfo,g=k===void 0?{}:k;r(g.pushPayload)==="object"&&(g.pushPayload=o(g.pushPayload)),d.verifyOptions(y,"type","api::signalling"),d.verifyOptions(y,"account","api::signalling");var v=d.merge(y,g,{to:S,isSave:O===!0?1:0,needPush:g.needPush===!0?1:0,needBadge:g.needBadge===!1?0:1});return this.sendCmdUsePromise("signalingCallEx",{avSignalTag:v}).then(function(ue){var L,re=ue.avSignalTag,le=re.members;return typeof re.members=="string"&&(le=i(L=JSON.parse(re.members)).call(L,function(oe){return u.parseAvSignalMember(oe)})),re.members=le,s.resolve(re)}).catch(function(ue){return s.reject(u.parseAvSignalError(ue))})},a.signalingJoinAndAccept=function(){var y=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},S=y.channelId,O=y.attachExt,k=y.offlineEnabled,g=y.uid,v=y.account,ue=y.requestId,L=y.nertcChannelName,re=y.nertcTokenTtl,le=y.nertcJoinRoomQueryParamMap;return d.verifyOptions(y,"channelId","api::signalling"),d.verifyOptions(y,"account","api::signalling"),d.verifyOptions(y,"requestId","api::signalling"),this.sendCmdUsePromise("signalingJoinAndAccept",{avSignalTag:{channelId:S,attachExt:O,isSave:k===!0?1:0,uid:g,to:v,requestId:ue,nertcChannelName:L,nertcTokenTtl:re,nertcJoinRoomQueryParamMap:le}}).then(function(oe){var he,Ie=oe.avSignalTag,ie=Ie.members;return typeof Ie.members=="string"&&(ie=i(he=JSON.parse(Ie.members)).call(he,function(Ne){return u.parseAvSignalMember(Ne)})),Ie.members=ie,s.resolve(Ie)}).catch(function(oe){return s.reject(u.parseAvSignalError(oe))})}},function(t,n,e){var r=e(51),s=e(37),i=e(4),o=e(52),a=e(16),d=e(53),c=e(2),u=e(54),m=e(55),y=e(43),S=e(92),O=e(93);function k(v,ue){var L=i(v);if(o){var re=o(v);ue&&(re=a(re).call(re,function(le){return d(v,le).enumerable})),L.push.apply(L,re)}return L}e(0);var g={user_id:"",trace_id:"",action:7,exception_service:6,duration:0,start_time:0,state:1,extension:[]};t.exports=function(){function v(ue){S(this,v),this.clientProto=ue,this.reset()}return O(v,[{key:"reset",value:function(){this.traceData=s({},g),this.traceData.extension=[]}},{key:"start",value:function(ue){this.reset(),s(this.traceData,ue),this.traceData.user_id=this.clientProto.account,this.traceData.start_time=new Date().getTime()}},{key:"update",value:function(ue){var L=this.clientProto.checkNetworkAvailable();this.traceData.extension.push(function(re){for(var le=1;le<arguments.length;le++){var oe,he,Ie=arguments[le]!=null?arguments[le]:{};le%2?c(oe=k(Object(Ie),!0)).call(oe,function(ie){r(re,ie,Ie[ie])}):u?m(re,u(Ie)):c(he=k(Object(Ie))).call(he,function(ie){y(re,ie,d(Ie,ie))})}return re}({code:0,description:"",foreground:!0,foreg_backg_switch:!1,net_type:0,net_connect:L},ue))}},{key:"end",value:function(ue){var L=this.traceData.extension[0],re=this.traceData.extension[1];if(L&&L.operation_type===0&&re&&re.operation_type===1){var le=L.net_type!==re.net_type||L.net_connect!==re.net_connect;if(ue||!le)return this.traceData.duration=new Date().getTime()-this.traceData.start_time,this.clientProto.reporter.report("exceptions",this.traceData),void this.reset();this.reset()}else this.reset()}}]),v}()},function(t,n,e){var r=e(2),s=e(92),i=e(93),o=e(62).getPromiseWithAbort,a=function(){function d(){s(this,d),this.abortFns=[]}return i(d,[{key:"add",value:function(c){var u=o(c);return this.abortFns.push(u.abort),u.promise}},{key:"clear",value:function(){var c;r(c=this.abortFns).call(c,function(u){return u("Request aborted")}),this.abortFns=[]}},{key:"destroy",value:function(){this.clear()}}]),d}();t.exports=a},function(t,n,e){var r=e(57),s=e(58),i=e(2),o=e(71),a=e(3),d=e(9),c=e(60),u=e(15),m=e(6),y=e(8),S=e(26),O=e(92),k=e(93),g=e(0),v=e(11),ue=e(64),L=e(289),re=e(41);t.exports=function(){function le(he){var Ie=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{socketConcurrent:1};O(this,le),this.clientProto=he,this.logger=he.logger,this.urls=[],this.sockets=[],this.config=Ie}var oe;return k(le,[{key:"setConfig",value:function(){var he=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{socketConcurrent:1};this.config=he}},{key:"setUrls",value:function(he){this.urls=he}},{key:"resetSockets",value:function(){var he;i(he=this.sockets).call(he,function(Ie){Ie&&(Ie.removeAllListenersX("info"),Ie.disconnect())}),this.sockets=[]}},{key:"connect",value:(oe=s(r.mark(function he(){var Ie,ie,Ne,Ve=this;return r.wrap(function(Ce){for(;;)switch(Ce.prev=Ce.next){case 0:if(this.clientProto.statusProtector.emit("auth/loginLifeCycleConnect"),(ie=o(Ie=this.urls).call(Ie,0,this.config.socketConcurrent)).length!==0){Ce.next=4;break}throw new re("no_socket_url",408,{});case 4:return Ce.prev=4,Ce.next=7,a.any(d(ie).call(ie,function(Ue,qe){return Ve.doConnect(Ue,qe)}));case 7:return Ce.abrupt("return",Ce.sent);case 10:throw Ce.prev=10,Ce.t0=Ce.catch(4),i(Ne=Ce.t0.errors).call(Ne,function(Ue,qe){Ve.logger.warn("imsocket::connect failed ".concat(qe),Ue)}),Ce.t0;case 14:case"end":return Ce.stop()}},he,this,[[4,10]])})),function(){return oe.apply(this,arguments)})},{key:"success",value:function(he){var Ie;return i(Ie=this.sockets).call(Ie,function(ie,Ne){he!==Ne&&ie&&(ie.removeAllListenersX("info"),ie.disconnect())}),this.sockets[he]}},{key:"failed",value:function(he){var Ie=this.sockets[he];Ie&&(Ie.removeAllListenersX("info"),Ie.disconnect())}},{key:"getTransport",value:function(he){var Ie=g.getGlobal();if(typeof window>"u"){var ie=he.split(":");return Ie&&!Ie.location&&ie.length>1&&(Ie.location={protocol:ie.shift(),port:ie.pop(),hostname:ie.join("")}),["websocket"]}return this.clientProto.options.transports?this.clientProto.options.transports:ue.name!=="IE"||Ie.WebSocket?["websocket"]:["xhr-polling"]}},{key:"doConnect",value:function(he,Ie){var ie=this;if(this.clientProto&&this.clientProto.__destroyed===!0)return a.reject("instance has been destroyed");var Ne=this.getTransport(he),Ve=c();return new a(function(Ce,Ue){var qe,Oe,$e,_e;try{_e=L.connect(he,{transports:u(Ne).call(Ne),reconnect:!1,"force new connection":!0,"connect timeout":v.connectTimeout,needToXHR:typeof ie.clientProto.options.needToXHR=="boolean"?ie.clientProto.options.needToXHR:v.needToXHR}),ie.sockets[Ie]=_e}catch(Pt){var er;return ie.logger.warn(m(er="link::connectToUrl ".concat(Ie,":io.connect caught exception: ")).call(er,Pt&&Pt.message),Pt),void Ue(new re("socket_error",408,{startTime:Ve,url:he,reason:Pt.message,rawError:Pt}))}ie.logger.info(m(qe=m(Oe="link::connectToUrl ".concat(Ie,": socket url: ")).call(Oe,he,", transports: ")).call(qe,y(Ne))),_e.on("connect",function(){ie.logger.info("link::connectToUrl ".concat(Ie," success")),ie.success(Ie),ie.clientProto.reporterHookLinkKeep.start({trace_id:_e.socket.sessionid}),ie.clientProto.reporterHookLinkKeep.update({code:0,description:"",operation_type:0,target:he}),ie.clientProto.url=he,Ce(_e)}),_e.on("handshake_failed",function(){ie.failed(Ie),Ue(new re("handshake_failed",408,{startTime:Ve,url:he}))}),_e.on("connect_failed",function(Pt){ie.failed(Ie),Ue(new re("connect_failed",408,{startTime:Ve,url:he,reason:Pt}))}),_e.on("error",function(){var Pt,ar=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",pr=arguments.length>1?arguments[1]:void 0,lr=pr&&pr.message||ar;ie.logger.warn(m(Pt="link::onSocketError ".concat(Ie,": reason is ")).call(Pt,lr,", error is "),pr),Ue(new re("socket_error",408,{startTime:Ve,url:he,reason:lr,rawError:pr}))}),_e.on("info",function(Pt,ar){var pr,lr;ar?ie.logger.info(m(pr="link::onSocketInfo ".concat(Ie,": ")).call(pr,Pt,", extraInfo:"),ar):ie.logger.info(m(lr="link::onSocketInfo ".concat(Ie,": ")).call(lr,Pt,"."))}),_e.on("message",S($e=ie.clientProto.onMessage).call($e,ie.clientProto)),_e.on("disconnect",function(Pt){ie.logger.warn("link::onSocketDisconnect: socket url: ".concat(he,", disconnected"),Pt),ie.clientProto.hasLogin=!1,ie.clientProto.doLogout?ie.clientProto.logout():ie.clientProto.onDisconnect("link::socketDisconnect"),ie.clientProto.statusProtector.emit("auth/loginLifeCycleDisconnected",new Error("disconnect due to internal reasons"))}),_e.on("websocketOnclose",function(Pt){ie.clientProto.reporterHookLinkKeep.update({code:Pt&&Pt.code||0,description:Pt&&Pt.reason||"",operation_type:1,target:he}),ie.clientProto.reporterHookLinkKeep.end(!1)})})}},{key:"destroy",value:function(){this.urls=[],this.resetSockets()}}]),le}()},function(t,n,e){var r=e(22).default,s=e(140),i=e(155),o=e(189),a=e(283),d=e(651),c=e(191),u=e(288),m=e(662),y=e(309);function S(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */t.exports=S=function(){return O},t.exports.__esModule=!0,t.exports.default=t.exports;var O={},k=Object.prototype,g=k.hasOwnProperty,v=s||function(nr,ir,dr){nr[ir]=dr.value},ue=typeof i=="function"?i:{},L=ue.iterator||"@@iterator",re=ue.asyncIterator||"@@asyncIterator",le=ue.toStringTag||"@@toStringTag";function oe(nr,ir,dr){return s(nr,ir,{value:dr,enumerable:!0,configurable:!0,writable:!0}),nr[ir]}try{oe({},"")}catch{oe=function(ir,dr,Lt){return ir[dr]=Lt}}function he(nr,ir,dr,Lt){var cr=ir&&ir.prototype instanceof Ne?ir:Ne,mr=o(cr.prototype),tr=new lr(Lt||[]);return v(mr,"_invoke",{value:er(nr,dr,tr)}),mr}function Ie(nr,ir,dr){try{return{type:"normal",arg:nr.call(ir,dr)}}catch(Lt){return{type:"throw",arg:Lt}}}O.wrap=he;var ie={};function Ne(){}function Ve(){}function Ce(){}var Ue={};oe(Ue,L,function(){return this});var qe=a&&a(a(or([])));qe&&qe!==k&&g.call(qe,L)&&(Ue=qe);var Oe=Ce.prototype=Ne.prototype=o(Ue);function $e(nr){var ir;d(ir=["next","throw","return"]).call(ir,function(dr){oe(nr,dr,function(Lt){return this._invoke(dr,Lt)})})}function _e(nr,ir){var dr;v(this,"_invoke",{value:function(Lt,cr){function mr(){return new ir(function(tr,At){(function kt(Dt,gr,yr,vr){var Ir=Ie(nr[Dt],nr,gr);if(Ir.type!=="throw"){var Mr=Ir.arg,Ar=Mr.value;return Ar&&r(Ar)=="object"&&g.call(Ar,"__await")?ir.resolve(Ar.__await).then(function(Fr){kt("next",Fr,yr,vr)},function(Fr){kt("throw",Fr,yr,vr)}):ir.resolve(Ar).then(function(Fr){Mr.value=Fr,yr(Mr)},function(Fr){return kt("throw",Fr,yr,vr)})}vr(Ir.arg)})(Lt,cr,tr,At)})}return dr=dr?dr.then(mr,mr):mr()}})}function er(nr,ir,dr){var Lt="suspendedStart";return function(cr,mr){if(Lt==="executing")throw new Error("Generator is already running");if(Lt==="completed"){if(cr==="throw")throw mr;return xe()}for(dr.method=cr,dr.arg=mr;;){var tr=dr.delegate;if(tr){var At=Pt(tr,dr);if(At){if(At===ie)continue;return At}}if(dr.method==="next")dr.sent=dr._sent=dr.arg;else if(dr.method==="throw"){if(Lt==="suspendedStart")throw Lt="completed",dr.arg;dr.dispatchException(dr.arg)}else dr.method==="return"&&dr.abrupt("return",dr.arg);Lt="executing";var kt=Ie(nr,ir,dr);if(kt.type==="normal"){if(Lt=dr.done?"completed":"suspendedYield",kt.arg===ie)continue;return{value:kt.arg,done:dr.done}}kt.type==="throw"&&(Lt="completed",dr.method="throw",dr.arg=kt.arg)}}}function Pt(nr,ir){var dr=ir.method,Lt=nr.iterator[dr];if(Lt===void 0)return ir.delegate=null,dr==="throw"&&nr.iterator.return&&(ir.method="return",ir.arg=void 0,Pt(nr,ir),ir.method==="throw")||dr!=="return"&&(ir.method="throw",ir.arg=new TypeError("The iterator does not provide a '"+dr+"' method")),ie;var cr=Ie(Lt,nr.iterator,ir.arg);if(cr.type==="throw")return ir.method="throw",ir.arg=cr.arg,ir.delegate=null,ie;var mr=cr.arg;return mr?mr.done?(ir[nr.resultName]=mr.value,ir.next=nr.nextLoc,ir.method!=="return"&&(ir.method="next",ir.arg=void 0),ir.delegate=null,ie):mr:(ir.method="throw",ir.arg=new TypeError("iterator result is not an object"),ir.delegate=null,ie)}function ar(nr){var ir={tryLoc:nr[0]};1 in nr&&(ir.catchLoc=nr[1]),2 in nr&&(ir.finallyLoc=nr[2],ir.afterLoc=nr[3]),this.tryEntries.push(ir)}function pr(nr){var ir=nr.completion||{};ir.type="normal",delete ir.arg,nr.completion=ir}function lr(nr){this.tryEntries=[{tryLoc:"root"}],d(nr).call(nr,ar,this),this.reset(!0)}function or(nr){if(nr){var ir=nr[L];if(ir)return ir.call(nr);if(typeof nr.next=="function")return nr;if(!isNaN(nr.length)){var dr=-1,Lt=function cr(){for(;++dr<nr.length;)if(g.call(nr,dr))return cr.value=nr[dr],cr.done=!1,cr;return cr.value=void 0,cr.done=!0,cr};return Lt.next=Lt}}return{next:xe}}function xe(){return{value:void 0,done:!0}}return Ve.prototype=Ce,v(Oe,"constructor",{value:Ce,configurable:!0}),v(Ce,"constructor",{value:Ve,configurable:!0}),Ve.displayName=oe(Ce,le,"GeneratorFunction"),O.isGeneratorFunction=function(nr){var ir=typeof nr=="function"&&nr.constructor;return!!ir&&(ir===Ve||(ir.displayName||ir.name)==="GeneratorFunction")},O.mark=function(nr){return c?c(nr,Ce):(nr.__proto__=Ce,oe(nr,le,"GeneratorFunction")),nr.prototype=o(Oe),nr},O.awrap=function(nr){return{__await:nr}},$e(_e.prototype),oe(_e.prototype,re,function(){return this}),O.AsyncIterator=_e,O.async=function(nr,ir,dr,Lt,cr){cr===void 0&&(cr=u);var mr=new _e(he(nr,ir,dr,Lt),cr);return O.isGeneratorFunction(ir)?mr:mr.next().then(function(tr){return tr.done?tr.value:mr.next()})},$e(Oe),oe(Oe,le,"Generator"),oe(Oe,L,function(){return this}),oe(Oe,"toString",function(){return"[object Generator]"}),O.keys=function(nr){var ir=Object(nr),dr=[];for(var Lt in ir)dr.push(Lt);return m(dr).call(dr),function cr(){for(;dr.length;){var mr=dr.pop();if(mr in ir)return cr.value=mr,cr.done=!1,cr}return cr.done=!0,cr}},O.values=or,lr.prototype={constructor:lr,reset:function(nr){var ir;if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,d(ir=this.tryEntries).call(ir,pr),!nr)for(var dr in this)dr.charAt(0)==="t"&&g.call(this,dr)&&!isNaN(+y(dr).call(dr,1))&&(this[dr]=void 0)},stop:function(){this.done=!0;var nr=this.tryEntries[0].completion;if(nr.type==="throw")throw nr.arg;return this.rval},dispatchException:function(nr){if(this.done)throw nr;var ir=this;function dr(kt,Dt){return mr.type="throw",mr.arg=nr,ir.next=kt,Dt&&(ir.method="next",ir.arg=void 0),!!Dt}for(var Lt=this.tryEntries.length-1;Lt>=0;--Lt){var cr=this.tryEntries[Lt],mr=cr.completion;if(cr.tryLoc==="root")return dr("end");if(cr.tryLoc<=this.prev){var tr=g.call(cr,"catchLoc"),At=g.call(cr,"finallyLoc");if(tr&&At){if(this.prev<cr.catchLoc)return dr(cr.catchLoc,!0);if(this.prev<cr.finallyLoc)return dr(cr.finallyLoc)}else if(tr){if(this.prev<cr.catchLoc)return dr(cr.catchLoc,!0)}else{if(!At)throw new Error("try statement without catch or finally");if(this.prev<cr.finallyLoc)return dr(cr.finallyLoc)}}}},abrupt:function(nr,ir){for(var dr=this.tryEntries.length-1;dr>=0;--dr){var Lt=this.tryEntries[dr];if(Lt.tryLoc<=this.prev&&g.call(Lt,"finallyLoc")&&this.prev<Lt.finallyLoc){var cr=Lt;break}}cr&&(nr==="break"||nr==="continue")&&cr.tryLoc<=ir&&ir<=cr.finallyLoc&&(cr=null);var mr=cr?cr.completion:{};return mr.type=nr,mr.arg=ir,cr?(this.method="next",this.next=cr.finallyLoc,ie):this.complete(mr)},complete:function(nr,ir){if(nr.type==="throw")throw nr.arg;return nr.type==="break"||nr.type==="continue"?this.next=nr.arg:nr.type==="return"?(this.rval=this.arg=nr.arg,this.method="return",this.next="end"):nr.type==="normal"&&ir&&(this.next=ir),ie},finish:function(nr){for(var ir=this.tryEntries.length-1;ir>=0;--ir){var dr=this.tryEntries[ir];if(dr.finallyLoc===nr)return this.complete(dr.completion,dr.afterLoc),pr(dr),ie}},catch:function(nr){for(var ir=this.tryEntries.length-1;ir>=0;--ir){var dr=this.tryEntries[ir];if(dr.tryLoc===nr){var Lt=dr.completion;if(Lt.type==="throw"){var cr=Lt.arg;pr(dr)}return cr}}throw new Error("illegal catch attempt")},delegateYield:function(nr,ir,dr){return this.delegate={iterator:or(nr),resultName:ir,nextLoc:dr},this.method==="next"&&(this.arg=void 0),ie}},O}t.exports=S,t.exports.__esModule=!0,t.exports.default=t.exports},function(t,n,e){t.exports=e(652)},function(t,n,e){t.exports=e(653)},function(t,n,e){var r=e(654);t.exports=r},function(t,n,e){var r=e(230);t.exports=r},function(t,n,e){t.exports=e(656)},function(t,n,e){var r=e(657);e(658),e(659),e(660),e(661),t.exports=r},function(t,n,e){var r=e(232);t.exports=r},function(t,n,e){e(233)},function(t,n,e){e(247)},function(t,n,e){var r=e(1),s=e(70),i=e(104);r({target:"Promise",stat:!0,forced:!0},{try:function(o){var a=s.f(this),d=i(o);return(d.error?a.reject:a.resolve)(d.value),a.promise}})},function(t,n,e){e(248)},function(t,n,e){t.exports=e(663)},function(t,n,e){t.exports=e(664)},function(t,n,e){var r=e(665);t.exports=r},function(t,n,e){var r=e(276);t.exports=r},function(t,n,e){t.exports=e(667)},function(t,n,e){var r=e(668);t.exports=r},function(t,n,e){var r=e(251);t.exports=r},function(t,n,e){var r=e(57),s=e(58),i=e(2),o=e(6),a=e(15),d=e(71),c=e(24),u=e(3),m=e(26),y=e(78).fn,S=e(41),O=e(670),k=e(11),g=e(0),v=e(671);function ue(){this.logger.log("offlineListener enter"),this.forceDisconnect(),this.statusProtector.emit("auth/loginLifeCycleDisconnected",new Error("disconnect due to network offline")),this.options.ondisconnect&&this.options.ondisconnect({code:"offlineListener",callFunc:"link::offlineListener",message:"offlineListener disconnect"}),this.onDisconnect("link::offlineListener","broken")}function L(){var re=this;this.logger.log("onlineListener start"),this&&this.isConnected()&&!this.connecting?(this.stopHeartbeat(),this.sendCmd("heartbeat",null,function(le){if(le){re.logger.info("onlineListener heartbeat detect error",le);try{re.forceDisconnect(),re.onDisconnect("link::onHeartbeat","broken")}catch(oe){re.logger.info("onlineListener heartbeat websocket.onclose",oe)}}else re.logger.log("onlineListener heartbeat detect success")})):this.logger.log("onlineListener disconnected or connecting",this&&this.isConnected(),this.connecting)}y.initConnect=function(){this.socket=null,this.retryCount=0,this.connecting=!1,this.shouldReconnect=!0,this.hasNotifyDisconnected=!1,this.doLogout=!1},y.resetConnect=function(){var re=this.options;g.notundef(re.needReconnect)?(g.verifyParamType("needReconnect",re.needReconnect,"boolean","link::resetConnect"),this.needReconnect=re.needReconnect):this.needReconnect=!0,this.logger.info("link::resetConnect: needReconnect ".concat(this.needReconnect)),g.notundef(re.reconnectionAttempts)&&g.verifyParamType("reconnectionAttempts",re.reconnectionAttempts,"number","link::resetConnect"),g.notundef(re.noCacheLinkUrl)&&g.verifyParamType("noCacheLinkUrl",re.noCacheLinkUrl,"boolean","link::resetConnect"),this.reconnectionAttempts=typeof re.reconnectionAttempts=="number"?re.reconnectionAttempts:1/0,this.backoff=new O({min:k.reconnectionDelay,max:k.reconnectionDelayMax,jitter:k.reconnectionJitter})},y.reportTCPException=function(re){var le=this;i(re).call(re,function(oe,he){var Ie,ie=oe.event,Ne=ie===void 0?{}:ie,Ve=oe.message,Ce=Ne.startTime,Ue=Ne.code,qe=Ne.reason,Oe=Ne.url,$e="";Ve==="handshake_failed"?$e="handshake_failed":Ve==="connect_failed"?$e=qe?"connect_failed:".concat(qe):"connect_failed":Ve==="socket_error"&&($e=qe?"socket.io error:".concat(qe):"socket.io error"),le.logger.warn(o(Ie="connect::failed ".concat(he,", ")).call(Ie,$e),oe),le.reporter.reportTraceStart("exceptions",{user_id:le.options.account,trace_id:g.get(self,"socket.socket.sessionid"),start_time:Ce,action:0,exception_service:6}),le.reporter.reportTraceUpdateV2("exceptions",{code:Ue,description:Ve,operation_type:0,target:Oe,net_connect:le.checkNetworkAvailable()}),le.reporter.reportTraceEnd("exceptions",1)})},y.connect=s(r.mark(function re(){var le,oe,he,Ie,ie;return r.wrap(function(Ne){for(;;)switch(Ne.prev=Ne.next){case 0:if(he=this,clearTimeout(he.connectTimer),!he.isConnected()){Ne.next=5;break}return he.logger.warn("link::connect: already connected"),Ne.abrupt("return");case 5:if(!he.connecting){Ne.next=8;break}return he.logger.warn("link::connect: already connecting"),Ne.abrupt("return");case 8:if(he.connecting=!0,he.hasNotifyDisconnected=!1,he.shouldReconnect=!0,he.socket&&he.forceDisconnect(),he.logger.info("link::connect: connect to new socket, autoconnect is "+he.autoconnect),typeof he.options.socketUrl=="string"&&(he.logger.info("link::connect: try to options.socketUrl ",he.options.socketUrl),he.socketUrls=[he.options.socketUrl]),Ne.prev=14,he.socketUrls&&he.socketUrls.length>0){Ne.next=20;break}return Ne.next=18,he.refreshSocketUrl();case 18:he.socketUrls=v(he.socketUrls),he.logger.info("link::connect: refreshSocketUrl success, socketConcurrent ".concat(he.imsocket.config.socketConcurrent),he.socketUrls);case 20:Ne.next=28;break;case 22:return Ne.prev=22,Ne.t0=Ne.catch(14),he.logger.warn("connect::refreshSocketUrl: catch exception,",Ne.t0&&Ne.t0.message),he.connecting=!1,this.options.ondisconnect({code:"initConnectFail",callFunc:"ProtocolFn.connect",message:"refresh socket url fail"}),Ne.abrupt("return");case 28:return he.imsocket.resetSockets(),he.imsocket.setUrls(a(le=he.socketUrls).call(le,0)),d(oe=he.socketUrls).call(oe,0,he.imsocket.config.socketConcurrent),Ne.prev=31,Ne.next=34,he.imsocket.connect();case 34:he.socket=Ne.sent,he.onConnect(),Ne.next=46;break;case 38:Ne.prev=38,Ne.t1=Ne.catch(31),ie="",Ne.t1.errors&&(he.reportTCPException(Ne.t1.errors),Ie=Ne.t1.errors[0]),Ie.message==="handshake_failed"?(he.onHandshakeFailed(Ie.event.startTime,Ie.event.url),ie="link::onHandshakeFailed"):Ie.message==="connect_failed"?(he.onConnectFailed(Ie.event.reason,Ie.event.startTime,Ie.event.url),ie="link::onConnectFailed"):Ie.message==="socket_error"?(he.onSocketError(Ie.event.reason,Ie.event.startTime,Ie.event.url),ie="link::onSocketError"):(ie="link::otherFailed",he.logger.warn("link::otherFailed",Ie)),this.statusProtector.emit("auth/loginLifeCycleConnectFail",new Error("".concat(ie," 408"))),he.connecting=!1,he.willReconnect()?he.onDisconnect(ie):this.options.ondisconnect({code:"initConnectFail",callFunc:"ProtocolFn.connect",message:"init connect fail"});case 46:case"end":return Ne.stop()}},re,this,[[14,22],[31,38]])})),y.isConnected=function(){return!!this.socket&&!!this.socket.socket&&this.socket.socket.connected},y.disconnect=function(){var re=arguments.length>0&&arguments[0]!==void 0?arguments[0]:function(){},le=this;function oe(he){clearTimeout(le.disconnectCallbackTimer),le.msgAckBufferManager&&le.msgAckBufferManager.clear(),le.roamingMsgSyncDoneBufferManager&&le.roamingMsgSyncDoneBufferManager.clear(),le.statusProtector.emit("auth/loginLifeCycleDisconnected",new Error("disconnect due to active action")),le.statusProtector.emit("auth/loginLifeCycleLogout"),c(function(){re(he)},0)}clearTimeout(le.connectTimer),le.disconnectCallbackTimer=c(function(){re.call(le,"mark disconnected due to timeout")},1e4),le.mixStorePolicy=null,le.appGrayConfig=null,le.resetReconnectStatus(),clearTimeout(le.mixStorePolicyClock),this.onlineListener&&typeof window<"u"&&g.isFunction(window.removeEventListener)&&(window.removeEventListener("online",this.onlineListener),window.removeEventListener("offline",this.offlineListener),this.onlineListener=null,this.offlineListener=null),le.isConnected()?(le.logger.warn("link::disconnect: start disconnecting"),le.logout()):le.connecting?(le.logger.warn("link::disconnect: abort connecting"),le.disconnectSocket()):(le.logger.warn("link::disconnect: already disconnected"),le.connecting=!1,le.shouldReconnect=!1,le.socket=null,le.autoconnect=!1,le.options.ondisconnect({code:"alreadyDisconnected",callFunc:"link::disconnect",message:"manually disconnect status"})),le.socket&&le.socket.socket&&le.socket.socket.transport?le.socket.socket.transport.onDisconnectDone=function(he){le.logger.warn("link::disconnect: invoke [done] when socket closed",he),oe(he)}:(le.logger.warn("link::disconnect: invoke [done]"),oe(null))},y.resetReconnectStatus=function(){this.backoff&&(this.backoff.setMin(k.reconnectionDelay),this.backoff.setMax(k.reconnectionDelayMax),this.backoff.reset()),this.retryCount=0,this.logger.info("link::resetReconnectStatus: reset retryCount and backoff")},y.onConnect=function(){this.connecting=!1,this.shouldReconnect=!0,this.hasNotifyDisconnected=!1,this.logger.info("link::onConnect success"),this.statusProtector.emit("auth/loginLifeCycleConnectSucc"),this.login()},y.onDisconnect=function(){var re=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,le=arguments.length>1?arguments[1]:void 0,oe=this;this.logger.warn("socket::onDisconnect: "+re),oe.connecting=!1,oe.markAllCallbackInvalid(S.newNetworkError({callFunc:re,uploadCode:415,disconnectReason:le})),oe.msgAckBufferManager&&oe.msgAckBufferManager.clear(),oe.roamingMsgSyncDoneBufferManager&&oe.roamingMsgSyncDoneBufferManager.clear(),oe.stopHeartbeat(),oe.reconnect()},y.willReconnect=function(){return this.shouldReconnect&&this.needReconnect&&this.retryCount<this.reconnectionAttempts},y.reconnect=function(){var re=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!this.__destroyed)if(this.willReconnect()){if(this.socket&&(this.logger.info("link::reconnect: try to force disconnect"),this.forceDisconnect()),this.socketUrls.length===0&&!this.options.socketUrl&&typeof re.allFailedCB=="function")return this.logger.log("reconnect: All socket links have been polled, trigger hooks"),void re.allFailedCB();this.doReconnect()}else this.notifyDisconnect({code:"allAttemptsFailed",message:"All attempts failed"})},y.doReconnect=function(){var re,le=this;le.socket=null,le.retryCount++,le.hasLogin=!1;var oe,he=le.backoff.duration();le.logger.info(o(re="link::reconnect: will retry after ".concat(he,"ms, retryCount ")).call(re,le.retryCount)),oe=le.options.onwillreconnect({retryCount:le.retryCount,duration:he}),le.statusProtector.emit("auth/loginLifeCycleWaiting"),clearTimeout(le.connectTimer),le.connectTimer=c(function(){+le.options.authType==1&&oe instanceof u?(le.logger.info("link::reconnect: wait onwillreconnect promise"),oe.finally(function(){return le.connect()})):le.connect()},he)},y.notifyConnectError=function(re){var le=S.newConnectError({message:re,callFunc:"link::notifyConnectError"});this.logger.error("link::notifyConnectError:",le),this.options.onerror(le)},y.notifyDisconnect=function(re){this.hasNotifyDisconnected?this.logger.warn("notifyDisconnect:: already notified"):(this.hasNotifyDisconnected=!0,this.disconnectSocket(),this.forceDisconnect(),(re=re||new S).retryCount=this.retryCount,re.willReconnect=this.willReconnect(),this.backoff&&this.backoff.reset(),this.retryCount=0,this.autoconnect=!1,this.logger.info("link::notifyDisconnect: ondisconnected",re),this.options.ondisconnect(re),this.onWbNotifyHangup instanceof Function&&this.onWbNotifyHangup({content:{account:this.account,channelId:null,timetag:+Date()}}))},y.disconnectSocket=function(){if(this.isConnected()||this.connecting){this.connecting=!1,this.shouldReconnect=!1;try{this.socket&&this.socket.disconnect()}catch(re){this.socket&&typeof this.socket.removeAllListenersX=="function"&&this.socket.removeAllListenersX("info"),this.logger.info("link::disconnectSocket: disconnect failed, error ",re&&re.message)}}},y.initOnlineListener=function(){this.needReconnect&&this.options&&this.options.quickReconnect?typeof window<"u"&&g.isFunction(window.addEventListener)?this.onlineListener||(this.onlineListener=m(L).call(L,this),this.offlineListener=m(ue).call(ue,this),this.logger.info("initOnlineListener success"),window.addEventListener("online",this.onlineListener),window.addEventListener("offline",this.offlineListener)):this.logger.warn("initOnlineListener no window.addEventListener"):this.logger.warn("initOnlineListener no quickReconnect")},y.forceDisconnect=function(){var re=this.socket||{};this.socket=null;try{typeof re.removeAllListenersX=="function"&&re.removeAllListenersX("info"),typeof re.disconnect=="function"&&re.disconnect()}catch(le){this.logger.error("forceDisconnect:: oldSocket error",le||le.message)}this.hasLogin=!1}},function(t,n){function e(r){r=r||{},this.ms=r.min||100,this.max=r.max||1e4,this.factor=r.factor||2,this.jitter=r.jitter>0&&r.jitter<=1?r.jitter:0,this.attempts=0}t.exports=e,e.prototype.duration=function(){var r=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var s=Math.random(),i=Math.floor(s*this.jitter*r);r=1&Math.floor(10*s)?r+i:r-i}return 0|Math.min(r,this.max)},e.prototype.reset=function(){this.attempts=0},e.prototype.setMin=function(r){this.ms=r},e.prototype.setMax=function(r){this.max=r},e.prototype.setJitter=function(r){this.jitter=r}},function(t,n,e){var r=e(672);t.exports=function(s){return s&&s.length?r(s):[]}},function(t,n,e){var r=e(673),s=e(676),i=e(681),o=e(682),a=e(683),d=e(290);t.exports=function(c,u,m){var y=-1,S=s,O=c.length,k=!0,g=[],v=g;if(m)k=!1,S=i;else if(O>=200){var ue=u?null:a(c);if(ue)return d(ue);k=!1,S=o,v=new r}else v=u?[]:g;e:for(;++y<O;){var L=c[y],re=u?u(L):L;if(L=m||L!==0?L:0,k&&re==re){for(var le=v.length;le--;)if(v[le]===re)continue e;u&&v.push(re),g.push(L)}else S(v,re,m)||(v!==g&&v.push(re),g.push(L))}return g}},function(t,n,e){var r=e(260),s=e(674),i=e(675);function o(a){var d=-1,c=a==null?0:a.length;for(this.__data__=new r;++d<c;)this.add(a[d])}o.prototype.add=o.prototype.push=s,o.prototype.has=i,t.exports=o},function(t,n){t.exports=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this}},function(t,n){t.exports=function(e){return this.__data__.has(e)}},function(t,n,e){var r=e(677);t.exports=function(s,i){return!!(s!=null&&s.length)&&r(s,i,0)>-1}},function(t,n,e){var r=e(678),s=e(679),i=e(680);t.exports=function(o,a,d){return a==a?i(o,a,d):r(o,s,d)}},function(t,n){t.exports=function(e,r,s,i){for(var o=e.length,a=s+(i?1:-1);i?a--:++a<o;)if(r(e[a],a,e))return a;return-1}},function(t,n){t.exports=function(e){return e!=e}},function(t,n){t.exports=function(e,r,s){for(var i=s-1,o=e.length;++i<o;)if(e[i]===r)return i;return-1}},function(t,n){t.exports=function(e,r,s){for(var i=-1,o=e==null?0:e.length;++i<o;)if(s(r,e[i]))return!0;return!1}},function(t,n){t.exports=function(e,r){return e.has(r)}},function(t,n,e){var r=e(272),s=e(684),i=e(290),o=r&&1/i(new r([,-0]))[1]==1/0?function(a){return new r(a)}:s;t.exports=o},function(t,n){t.exports=function(){}},function(t,n,e){var r,s=e(15),i=e(78).fn,o=e(41),a=e(195),d=e(0),c=e(11),u=e(45),m=e(196).getLibEnv,y=e(64),S=e(196).getHostEnvEnum,O=d.notundef;i.genSessionKey=(r={},function(){var k=this.name;return r[k]=r[k]||d.guid()}),i.afterLogin=d.emptyFunc,i.assembleIMLogin=function(){var k,g=this.options,v=g.account;this.sdkSession=this.genSessionKey();var ue={appLogin:this.autoconnect?0:1,appKey:g.appKey,account:v,token:g.token,sdkVersion:c.info.sdkVersion,sdkHumanVersion:c.info.sdkHumanVersion,protocolVersion:c.info.protocolVersion,os:y.os.toString()==="[object Object]"?y.os.family:y.os.toString(),browser:y.name+" "+y.version,clientType:c.CLIENTTYPE||16,session:this.sdkSession,deviceId:u.deviceId,isReactNative:c.isRN?1:0,customTag:g.customTag||""};return ue.userAgent=(c.isBrowser?navigator&&navigator.userAgent:"")||"",ue.userAgent=g.loginSDKTypeParamCompat?"Native/"+c.info.sdkHumanVersion:s(k=ue.userAgent).call(k,0,299),ue.libEnv=g.loginSDKTypeParamCompat?void 0:m(),ue.sdkType=g.loginSDKTypeParamCompat?0:S(),g.customClientType&&(ue.customClientType=+g.customClientType),g.authType&&(ue.authType=+g.authType),g.loginExt&&(ue.loginExt=g.loginExt),ue},i.notifyLogin=function(k){this.logger.info("link::notifyLogin: on connect",k),this.options.onconnect(k)},i.logout=function(){if(this.doLogout)return this.doLogout=!1,void this.onAuthError(new o("done logout","logout",{disconnectReason:"close",uploadCode:415}),"link::logout");this.isConnected()&&this.onAuthError(new o("done disconnect","logout",{disconnectReason:"close",uploadCode:415}),"link::logout")},i.onKicked=function(k){var g=k.content,v=g.from,ue=g.reason,L=g.custom,re=g.customClientType,le={reason:this.kickedReasons[ue]||"unknown",message:this.kickedMessages[ue]||"未知原因"};O(v)&&(le.from=a.reverseType(v)),O(L)&&(le.custom=L),+re>0&&(le.customClientType=re),this.logger.warn("link::onKicked:",le);var oe=new o("被踢了","kicked",{disconnectReason:"kicked",uploadCode:415});d.merge(oe,le),this.onAuthError(oe,"link::onKicked"),this.statusProtector.emit("auth/loginLifeCycleDisconnected",new Error("disconnect due to kicked")),this.statusProtector.emit("auth/loginLifeCycleKicked",le)},i.onAuthError=function(k,g){var v=k&&k.code;if(this.logger.error("onAuthError ",g,v),/^(Error_Internet_Disconnected|Error_Timeout|Error_Connection_Socket_State_not_Match)$/.test(v))return this.forceDisconnect(),void this.onDisconnect("link::onAuthError::"+v,"broken");(k=k||o.newConnectionError({callFunc:g,uploadCode:415,disconnectReason:"close"})).callFunc=k.callFunc||g||null,this.shouldReconnect=!1,this.markAllCallbackInvalid(k),this.notifyDisconnect(k)}},function(t,n,e){var r=e(24),s=e(26),i=e(22),o=e(78).fn,a=e(11),d=e(0);o.processLink=function(c){switch(c.cmd){case"heartbeat":this.startHeartbeat();break;case"notifyDetect":i(d._get(c,"content.notifyDetectTag"))==="object"&&(c.content.notifyDetectTag.t3=new Date().getTime(),this.startDetect(c))}},o.startHeartbeat=function(){var c=this;c.stopHeartbeat(),c.heartbeatTimer=r(function(){var u;c.sendCmd("heartbeat",null,s(u=c.onHeartbeat).call(u,c))},a.heartbeatInterval)},o.detectHeartbeat=function(){var c;this.stopHeartbeat(),this.sendCmd("heartbeat",null,s(c=this.onHeartbeat).call(c,this))},o.startDetect=function(c){var u=c.content.notifyDetectTag;u.t4=new Date().getTime(),this.sendCmd("uploadDetect",{notifyDetectTag:u})},o.stopHeartbeat=function(){this.heartbeatTimer&&(clearTimeout(this.heartbeatTimer),this.heartbeatTimer=null)},o.onHeartbeat=function(c){if(c){if(this.syncing)return this.logger.warn("onHeartbeat::ignore error in connecting"),void this.startHeartbeat();var u;c.callFunc="link::onHeartbeat",this.onCustomError("heartbeat error",c),this.heartbeatFail++,this.logger.warn("onHeartbeat::error ",c.code,c),c.code==="Error_Timeout"&&(this.heartbeatFail>1?(this.reporterHookLinkKeep.update({code:0,description:"Heartbeat-discovered link failure",operation_type:1,target:this.url}),this.reporterHookLinkKeep.end(!0),this.forceDisconnect(),this.onDisconnect("link::onHeartbeat","broken")):this.sendCmd("heartbeat",null,s(u=this.onHeartbeat).call(u,this)))}else this.heartbeatFail=0},o.checkNetworkAvailable=typeof navigator<"u"&&typeof navigator.onLine=="boolean"?function(){return navigator.onLine}:function(){},o.heartbeat=function(){}},function(t,n,e){var r=e(3),s=e(7),i=e(32),o=e(24),a=e(48),d=e(78).fn,c=e(286),u=e(11),m=e(45);d.processMisc=function(y){switch(y.cmd){case"getSimpleNosToken":y.error||(y.obj=y.content.nosTokens[0]);break;case"getNosToken":y.error||(y.obj=y.content.nosToken);break;case"getGrayscaleConfig":y.error||(y.obj=y.content.appGrayConfigTag);break;case"getMixStorePolicy":y.error||(y.obj=y.content.mixStorePolicyTag);break;case"getMixStoreToken":y.error||(y.obj=y.content.mixStoreTokenTag);break;case"getBackSourceToken":y.error||(y.obj=y.content.backSourceTokenTag);break;case"uploadSdkLogUrl":y.error?this.logger.error("uploadSdkLogUrl::error",y.error):this.logger.info("uploadSdkLogUrl::success",y.obj&&y.obj.url);break;case"notifyUploadLog":y.error||(u.isRN?this.uploadLocalLogRN():u.isBrowser&&this.uploadLocalLogWeb(),this.emitAPI({type:"notifyUploadLog"}));break;case"audioToText":y.error||(y.obj.text=y.content.text);break;case"processImage":y.obj.imageOps=c.reverseImageOps(y.obj.imageOps),y.error||(y.obj={url:y.content.url});break;case"getNosTokenTrans":y.error||(y.obj={nosToken:y.content.nosToken,docId:y.content.docId});break;case"getNosOriginUrl":y.error||(y.obj=y.content.nosFileUrlTag.originUrl);break;case"notifyTransLog":y.error||this.emitAPI({type:"notifyTransLog",obj:y.content.transInfo});break;case"fetchFile":case"fetchFileList":case"removeFile":y.error||(y.obj=y.content);break;case"getServerTime":y.obj=y.content&&y.content.time;break;case"getNosCdnHost":this.getNosCdnHost(y)}},d.uploadLocalLogRN=function(){if(u.isRN&&m.rnfs){var y=m.rnfs,S=this,O=y.nimIndex,k=(y.nimIndex+1)%2;y.nimPromise=y.nimPromise.then(function(){return r.all([y.exists(g(O)),y.exists(g(k))])}).then(function(v){return v&&(v[0]||v[1])?v[0]&&v[1]?y.copyFile(g(k),g(2)).then(function(){return y.readFile(g(O))}).then(function(ue){return y.appendFile(g(2),ue)}):v[0]?y.copyFile(g(O),g(2)):void(v[1]&&y.copyFile(g(k),g(2))):r.reject()}).then(function(){return new r(function(v){S.api.previewFile({filePath:g(2),done:function(ue,L){if(r.all([y.unlink(g(2)),y.unlink(g(1)),y.unlink(g(0))]).finally(function(){v()}),ue)S.logger.error("nim::uploadLocalLogRN:previewFile:error",ue);else{var re=L.url;s(re).call(re,"?")>0?re+="&":re+="?",re+="download="+new Date().getTime()+"_rn.log",S.api.uploadSdkLogUrl({url:re})}}})})}).catch(function(v){y.unlink(g(2)).catch(function(){}),S.logger.error("nim::protocol::uploadLocalLogRN",v)})}function g(v){return y.DocumentDirectoryPath+"/nimlog_"+v+".log"}},d.uploadLocalLogWeb=function(){var y=this;this.options.dbLog!==!1&&this.logger._local?this.logger._local.fetchLog().then(function(S){!S||!S.logs||i(S.logs)&&S.logs.length===0?y.logger.warn("uploadLocalLogWeb::no logs"):y.api.previewFile({blob:new Blob([S.logs],{type:"text/plain"}),done:function(O,k){if(O)y.logger.error("uploadLocalLogWeb::previewFile:error",O);else{y.logger.log("uploadLocalLogWeb::previewFile:success",k);var g=k.url;g+=(s(g).call(g,"?")>0?"&":"?")+"download="+new Date().getTime()+"_web.log",y.api.uploadSdkLogUrl({url:g}),y.logger._local.deleteLogs(S.time).then(function(){y.logger.log("uploadLocalLogWeb::deleteLogs success")}).catch(function(v){return y.logger.error("uploadLocalLogWeb::deleteLogs:error ,",v)})}}})}).catch(function(S){y.logger.error("uploadLocalLogWeb::fetchLog:error",S)}):this.logger.warn("uploadLocalLogWeb::no dbLog")},d.getNosCdnHost=function(y){var S=this,O=y.error;if(O&&(O.callFunc="events::getNosCdnHost",S.onCustomError("getNosCdnHost","EVENT_GET_NOS_CDN_HOST_ERROR",O)),y.content&&y.content.nosConfigTag){var k=y.content.nosConfigTag,g="",v="";k.expire!==0&&k.cdnDomain?k.expire===-1?(g=k.cdnDomain,v=k.objectNamePrefix):(g=k.cdnDomain,v=k.objectNamePrefix,S.nosCdnHostTimer&&clearTimeout(S.nosCdnHostTimer),S.nosCdnHostTimer=o(function(){S.sendCmd("getNosCdnHost",{})},800*a(k.expire))):(g="",v=""),u.serverNosConfig.cdnDomain=g,u.serverNosConfig.objectPrefix=v,u.hasLocalStorage&&(localStorage.setItem("nim_cdn_domain",g),localStorage.setItem("nim_object_prefix",v))}}},function(t,n,e){var r=e(9),s=e(32),i=e(78).fn,o=e(0),a=e(287),d=e(107).EMSyncType;i.processAvSignal=function(u){switch(u.cmd){case"signalingCreate":case"signalingDelay":case"signalingClose":case"signalingJoin":case"signalingLeave":case"signalingInvite":case"signalingCancel":case"signalingReject":case"signalingAccept":case"signalingControl":case"signalingSyncMsgRead":case"signalingGetChannelInfo":case"signalingCallEx":break;case"signalingNotify":this.onSignalingNotify(u);break;case"signalingMutilClientSyncNotify":this.onSignalingMutilClientSyncNotify(u);break;case"signalingUnreadMessageSyncNotify":this.onSignalingUnreadMessageSyncNotify(u);break;case"signalingChannelsSyncNotify":this.onSignalingMembersSyncNotify(u);break;default:this.logger.warn("avSignal::unhandled cmd:",u.cmd)}};var c=function(){var u=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(u.needPush&&(u.needPush=u.needPush==="1"),u.needBadge&&(u.needBadge=u.needBadge==="1"),u.channelInValid&&(u.channelInValid=u.channelInValid==="1"),u.attach){var m=JSON.parse(u.attach);u.eventType=a.parseAvSignalType(m.type)}if(u.members){var y=JSON.parse(u.members);u.members=r(y).call(y,function(S){return a.parseAvSignalMember(S)})}return u};i.onSignalingNotify=function(u){if(u.error){var m=u.error;this.logger.error("protocal::avSignal:onSignalingNotify error",m),this.emitAPI({type:"error",error:m}),this.options.onerror(m)}else{u.raw&&u.raw.r&&u.raw.r.length&&u.content&&u.content.avSignalTag&&(u.content.avSignalTag.msgid=u.raw.r[0]);var y=u.content.avSignalTag;y=s(y)?r(y).call(y,function(S){return c(S)}):c(y),this.emitAPI({type:"signalingNotify",obj:y}),o.isFunction(this.options.onSignalingNotify)&&this.options.onSignalingNotify(y)}},i.onSignalingMutilClientSyncNotify=function(u){if(u.error){var m=u.error;this.logger.error("protocal::avSignal:onSignalingMutilClientSyncNotify error",m),this.emitAPI({type:"error",error:m}),this.options.onerror(m)}else{var y=u.content.avSignalTag;y=s(y)?r(y).call(y,function(S){return c(S)}):c(y),this.emitAPI({type:"signalingMutilClientSyncNotify",obj:y}),o.isFunction(this.options.onSignalingMutilClientSyncNotify)&&this.options.onSignalingMutilClientSyncNotify(y)}},i.onSignalingUnreadMessageSyncNotify=function(u){if(u.error){var m=u.error;this.logger.error("protocal::avSignal:onSignalingUnreadMessageSyncNotify error",m),this.emitAPI({type:"error",error:m}),this.options.onerror(m)}else{var y=u.content.avSignalTag;s(y)&&(y=r(y).call(y,function(S){return c(S)})),this.emitAPI({type:"signalingUnreadMessageSyncNotify",obj:y}),this.reporterHook.emit("reporter/syncItemComplete",d.kSyncType15_13),o.isFunction(this.options.onSignalingUnreadMessageSyncNotify)&&this.options.onSignalingUnreadMessageSyncNotify(y)}},i.onSignalingMembersSyncNotify=function(u){if(u.error){var m=u.error;this.logger.error("protocal::avSignal:onSignalingMembersSyncNotify error",m),this.emitAPI({type:"error",error:m}),this.options.onerror(m)}else{var y=u.content.avSignalTag;s(y)||(y=[y]),y=r(y).call(y,function(S){return c(S)}),this.emitAPI({type:"signalingChannelsSyncNotify",obj:y}),o.isFunction(this.options.onSignalingMembersSyncNotify)&&this.options.onSignalingMembersSyncNotify(y)}}},function(t,n,e){var r=e(8),s=e(26),i=e(0),o=e(78).fn,a=e(118),d=e(278);o.adaptersRequest=function(c){var u=this,m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},y=arguments.length>2?arguments[2]:void 0,S=m.onerror||function(){},O=new Date().getTime(),k=i.get(y,"exception_service")||0;return m.onerror=function(){S.apply(void 0,arguments);var g=arguments.length<=0?void 0:arguments[0];u.reporter.reportTraceStart("exceptions",{user_id:u.account,trace_id:i.get(self,"socket.socket.sessionid"),start_time:O,action:1,exception_service:k}),u.reporter.reportTraceUpdateV2("exceptions",{code:typeof g.status=="number"?g.status:typeof g.code=="number"?g.code:0,description:g.message||"".concat(g.code),operation_type:0,target:c,context:m?r(m):"",net_connect:u.checkNetworkAvailable()}),u.reporter.reportTraceEnd("exceptions",1)},a(c,m)},o.adaptersUploadFile=function(c,u){var m,y=this;c.adaptersRequest=s(m=o.adaptersRequest).call(m,this);var S=new Date().getTime();return c.errorHook=function(O){var k=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(O){y.reporter.reportTraceStart("exceptions",{user_id:y.account,trace_id:i.get(self,"socket.socket.sessionid"),start_time:S,action:1,exception_service:k.provider==="s3"?4:3});var g=k.url||c.url;O.bucket&&(g=r(O)),y.reporter.reportTraceUpdateV2("exceptions",{code:typeof O.status=="number"?O.status:typeof O.code=="number"?O.code:0,description:O.message||"".concat(O.code),operation_type:1,target:g,net_connect:y.checkNetworkAvailable()}),y.reporter.reportTraceEnd("exceptions",1)}},new d(c,this,u)}},function(t,n,e){e(292);var r,s,i,o=e(43),a=e(60),d=e(37),c=e(2),u=e(3),m=e(4),y=e(24),S=e(16),O=e(15),k=e(6),g=e(22);i=function(){function v(re,le){for(var oe=0;oe<le.length;oe++){var he=le[oe];he.enumerable=he.enumerable||!1,he.configurable=!0,"value"in he&&(he.writable=!0),o(re,he.key,he)}}var ue={isDataReportEnable:!0,maxSize:100,msgListMaxSize:1e3,cacheMaxSize:1e3,maxDelay:3e5,maxInterval:3e4,minInterval:1e4,timeout:5e3,autoStart:!0},L=function(){};return function(){function re(he){(function(Ie,ie){if(!(Ie instanceof ie))throw new TypeError("Cannot call a class as a function")})(this,re),this.isUploadEnable=!1,this.initConfigLoaded=!1,this.loading=!1,this.isDestroyed=!1,this.reportConfig=ue,this.traceMsgCache={},this.highPriorityMsgList=[],this.msgList=[],this.lowPriorityMsgList=[],this.cacheMsgList=[],this.lastReportTime=a(),this.timer=null,this.setConfig(he),this.reportConfig.isDataReportEnable&&this.reportConfig.autoStart&&this.initUploadConfig()}var le,oe;return le=re,(oe=[{key:"setConfig",value:function(he){var Ie=d({},this.reportConfig.common,he.common);this.reportConfig=d({},this.reportConfig,he),this.reportConfig.common=Ie,this.reportConfig.common.sdk_type||(this.reportConfig.common.sdk_type="im")}},{key:"reportImmediately",value:function(he,Ie){var ie=this;this.reportConfig.isDataReportEnable&&this.reportConfig.request(he,d({dataType:"json",method:"POST",timeout:this.reportConfig.timeout},Ie)).catch(function(Ne){var Ve,Ce;(Ce=(Ve=ie.reportConfig)===null||Ve===void 0?void 0:Ve.logger)===null||Ce===void 0||Ce.warn("Reporter immediately upload failed",Ne)})}},{key:"report",value:function(he,Ie){var ie=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(ie.priority||(ie.priority=this.getEventPriority(he,Ie)),this.reportConfig.isDataReportEnable&&he){var Ne=a();ie.priority==="HIGH"?this.highPriorityMsgList.push({module:he,msg:Ie,createTime:Ne}):ie.priority==="NORMAL"?this.msgList.push({module:he,msg:Ie,createTime:Ne}):ie.priority==="LOW"&&this.lowPriorityMsgList.push({module:he,msg:Ie,createTime:Ne}),this.highPriorityMsgList.length>this.reportConfig.msgListMaxSize&&this.highPriorityMsgList.shift(),this.msgList.length>this.reportConfig.msgListMaxSize&&this.msgList.shift(),this.lowPriorityMsgList.length>this.reportConfig.msgListMaxSize&&this.lowPriorityMsgList.shift(),this.doReport()}}},{key:"reportTraceStart",value:function(he,Ie){if(this.reportConfig.isDataReportEnable&&he&&!this.traceMsgCache[he]){var ie=d(d({start_time:a()},Ie),{extension:[]});this.traceMsgCache[he]=ie}}},{key:"reportTraceUpdate",value:function(he){}},{key:"reportTraceUpdateV2",value:function(he,Ie,ie){var Ne,Ve=this;if(this.reportConfig.isDataReportEnable&&this.traceMsgCache[he]){var Ce=this.traceMsgCache[he].extension,Ue=Ce.length,qe=new Date().getTime();Ue===0?Ie.duration=qe-this.traceMsgCache[he].start_time:Ce[Ue-1].end_time?Ie.duration=qe-Ce[Ue-1].end_time:Ie.duration=qe-this.traceMsgCache[he].start_time,Ce.push(d({end_time:qe},Ie));var Oe=Ce.length-1;ie!=null&&ie.asyncParams&&((Ne=this.traceMsgCache[he]).asyncPromiseArray||(Ne.asyncPromiseArray=[]),this.traceMsgCache[he].asyncPromiseArray.push(ie.asyncParams.then(function($e){Ve.traceMsgCache[he]&&Ve.traceMsgCache[he].extension[Oe]&&d(Ve.traceMsgCache[he].extension[Oe],$e)})))}}},{key:"reportTraceEnd",value:function(he){var Ie,ie=this,Ne=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];if(this.reportConfig.isDataReportEnable&&this.traceMsgCache[he])if(he!=="nos"||Ne===!1)if(typeof Ne=="boolean"?this.traceMsgCache[he].succeed=!!Ne:this.traceMsgCache[he].state=Ne,this.traceMsgCache[he].duration=a()-this.traceMsgCache[he].start_time,c(Ie=this.traceMsgCache[he].extension).call(Ie,function(Ue){delete Ue.end_time}),this.traceMsgCache[he].asyncPromiseArray){var Ve=this.traceMsgCache[he],Ce=function(){Ve===ie.traceMsgCache[he]&&(delete ie.traceMsgCache[he].asyncPromiseArray,ie.report(he,ie.traceMsgCache[he],{priority:ie.getEventPriority(he,ie.traceMsgCache[he])}),ie.traceMsgCache[he]=null)};u.all(this.traceMsgCache[he].asyncPromiseArray).then(Ce).catch(Ce)}else this.report(he,this.traceMsgCache[he],{priority:this.getEventPriority(he,this.traceMsgCache[he])}),this.traceMsgCache[he]=null;else this.traceMsgCache[he]=null}},{key:"getEventPriority",value:function(he,Ie){if(he==="exceptions"){if(Ie.action===0||Ie.action===2||Ie.action===1&&Ie.exception_service!==0)return"HIGH"}else if(he==="msgReceive"||he==="nim_api_trace")return"LOW";return"NORMAL"}},{key:"reportTraceCancel",value:function(he){this.reportConfig.isDataReportEnable&&(this.traceMsgCache[he]=null)}},{key:"pause",value:function(){this.reportConfig.isDataReportEnable&&(this.isUploadEnable=!1)}},{key:"restore",value:function(){this.reportConfig.isDataReportEnable&&(this.isUploadEnable=!0,this.initConfigLoaded||this.initUploadConfig())}},{key:"destroy",value:function(){var he,Ie=this;this.reportConfig.isDataReportEnable&&(c(he=m(this.traceMsgCache)).call(he,function(ie){Ie.reportTraceEnd(ie,1)}),this.timer!==null&&clearTimeout(this.timer),this.setConfig=L,this.report=L,this.reportTraceStart=L,this.reportTraceUpdate=L,this.reportTraceEnd=L,this.pause=L,this.restore=L,this.destroy=L,this.cacheMsgList=[],this.traceMsgCache={},this.lowPriorityMsgList=[],this.msgList=[],this.highPriorityMsgList=[],this.reportConfig={},this.isDestroyed=!0)}},{key:"initUploadConfig",value:function(){var he,Ie,ie=this;if(!this.loading){this.loading=!0;var Ne=this.reportConfig.common||{};try{this.reportConfig.request(this.reportConfig.reportConfigUrl,{method:"GET",dataType:"json",params:{deviceId:Ne.dev_id,sdkVer:Ne.sdk_ver,platform:Ne.platform,appkey:Ne.app_key},timeout:this.reportConfig.timeout}).then(function(Ve){var Ce,Ue;if(!ie.isDestroyed){if(Ve.status===200&&Ve.data&&Ve.data.code===200){var qe=Ve.data.data||{};ie.reportConfig.maxSize=qe.maxSize>1e3?1e3:qe.maxSize,ie.reportConfig.maxInterval=qe.maxInterval>1e4?1e4:qe.maxInterval,ie.reportConfig.maxInterval=qe.maxInterval<10?10:qe.maxInterval,ie.reportConfig.minInterval=qe.minInterval<2?2:qe.minInterval,ie.reportConfig.maxDelay=qe.maxDelay||300,ie.reportConfig.maxInterval=1e3*ie.reportConfig.maxInterval,ie.reportConfig.minInterval=1e3*ie.reportConfig.minInterval,ie.reportConfig.maxDelay=1e3*ie.reportConfig.maxDelay,ie.isUploadEnable=!0,ie.initConfigLoaded=!0,ie.loading=!1,ie.reportHeartBeat()}(Ue=(Ce=ie.reportConfig)===null||Ce===void 0?void 0:Ce.logger)===null||Ue===void 0||Ue.log("Get reporter upload config success")}}).catch(function(Ve){var Ce,Ue;ie.loading=!1,(Ue=(Ce=ie.reportConfig)===null||Ce===void 0?void 0:Ce.logger)===null||Ue===void 0||Ue.error("Get reporter upload config failed",Ve)})}catch(Ve){this.loading=!1,(Ie=(he=this.reportConfig)===null||he===void 0?void 0:he.logger)===null||Ie===void 0||Ie.error("Exec reporter request failed",Ve)}}}},{key:"reportHeartBeat",value:function(){var he=this;this.isDestroyed||(this.timer=y(function(){he.reportHeartBeat()},this.reportConfig.minInterval),this.doReport())}},{key:"doReport",value:function(){if(!this.isDestroyed){var he=this.highPriorityMsgList.length+this.msgList.length+this.lowPriorityMsgList.length+this.cacheMsgList.length>2*this.reportConfig.maxSize?this.reportConfig.minInterval:this.reportConfig.maxInterval;a()-this.lastReportTime>=he&&this.upload()}}},{key:"getUploadMsg",value:function(){var he,Ie,ie,Ne,Ve,Ce,Ue=this,qe={},Oe=a();this.highPriorityMsgList=S(he=this.highPriorityMsgList).call(he,function(ir){return Oe-ir.createTime<Ue.reportConfig.maxDelay}),this.msgList=S(Ie=this.msgList).call(Ie,function(ir){return Oe-ir.createTime<Ue.reportConfig.maxDelay}),this.lowPriorityMsgList=S(ie=this.lowPriorityMsgList).call(ie,function(ir){return Oe-ir.createTime<Ue.reportConfig.maxDelay}),this.cacheMsgList=S(Ne=this.cacheMsgList).call(Ne,function(ir){return Oe-ir.createTime<Ue.reportConfig.maxDelay});var $e=O(Ve=this.highPriorityMsgList).call(Ve,0,this.reportConfig.maxSize);if(this.highPriorityMsgList=O(Ce=this.highPriorityMsgList).call(Ce,$e.length),$e.length<this.reportConfig.maxSize){var _e,er,Pt=this.reportConfig.maxSize-$e.length;$e=k($e).call($e,O(_e=this.msgList).call(_e,0,Pt)),this.msgList=O(er=this.msgList).call(er,Pt)}if($e.length<this.reportConfig.maxSize){var ar,pr,lr=this.reportConfig.maxSize-$e.length;$e=k($e).call($e,O(ar=this.lowPriorityMsgList).call(ar,0,lr)),this.lowPriorityMsgList=O(pr=this.lowPriorityMsgList).call(pr,lr)}if($e.length<this.reportConfig.maxSize){var or,xe,nr=this.reportConfig.maxSize-$e.length;$e=k($e).call($e,O(or=this.cacheMsgList).call(or,0,nr)),this.cacheMsgList=O(xe=this.cacheMsgList).call(xe,nr)}return c($e).call($e,function(ir){qe[ir.module]?qe[ir.module].push(ir.msg):qe[ir.module]=[ir.msg]}),{uploadMsgArr:$e,uploadMsg:qe}}},{key:"upload",value:function(){var he,Ie,ie=this;if(this.isUploadEnable&&!(this.lastReportTime&&a()-this.lastReportTime<this.reportConfig.minInterval)){var Ne=this.getUploadMsg(),Ve=Ne.uploadMsgArr,Ce=Ne.uploadMsg;if(Ve.length){this.lastReportTime=a();try{this.reportConfig.request(this.reportConfig.reportUrl,{dataType:"json",method:"POST",data:{common:this.reportConfig.common,event:Ce},headers:{sdktype:"im"},timeout:this.reportConfig.timeout}).catch(function(Ue){var qe,Oe,$e,_e;ie.cacheMsgList=O(qe=k(Oe=ie.cacheMsgList).call(Oe,Ve)).call(qe,0,ie.reportConfig.cacheMaxSize),(_e=($e=ie.reportConfig)===null||$e===void 0?void 0:$e.logger)===null||_e===void 0||_e.warn("Reporter upload failed",Ue)})}catch(Ue){(Ie=(he=this.reportConfig)===null||he===void 0?void 0:he.logger)===null||Ie===void 0||Ie.warn("Exec reporter request failed",Ue)}clearTimeout(this.timer),this.reportHeartBeat()}}}}])&&v(le.prototype,oe),o(le,"prototype",{writable:!1}),re}()},g(n)==="object"&&t!==void 0?t.exports=i():(s=typeof(r=i)=="function"?r.call(n,e,n,t):r)===void 0||(t.exports=s)},function(t,n,e){t.exports=e(692)},function(t,n,e){e(693);var r=e(694);t.exports=r},function(t,n,e){e(293)},function(t,n,e){var r=e(695);t.exports=r},function(t,n,e){var r=e(696);t.exports=r},function(t,n,e){e(293),t.exports=e(14)},function(t,n,e){var r,s,i,o=e(93),a=e(92),d=e(281),c=e(282),u=e(192),m=e(698),y=(e(292),e(2)),S=e(4),O=e(6),k=e(3),g=e(24),v=e(8),ue=e(279),L=e(22);function re(le){var oe=function(){if(typeof Reflect>"u"||!ue||ue.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(ue(Boolean,[],function(){})),!0}catch{return!1}}();return function(){var he,Ie=u(le);if(oe){var ie=u(this).constructor;he=ue(Ie,arguments,ie)}else he=Ie.apply(this,arguments);return c(this,he)}}i=function(){function le(he){if(he){var Ie,ie="";return y(Ie=S(he)).call(Ie,function(Ne,Ve){var Ce;ie+=Ve===0?"?":"&",ie+=O(Ce="".concat(Ne,"=")).call(Ce,he[Ne])}),ie}return""}var oe=function(he){d(ie,he);var Ie=re(ie);function ie(Ne,Ve,Ce,Ue){var qe;return a(this,ie),(qe=Ie.call(this,Ce)).source=Ne,qe.code=Ve,qe.desc=Ce,qe.detail=Ue||{},qe}return o(ie)}(m(Error));return function(he){var Ie=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{dataType:"json",method:"GET",timeout:5e3},ie=Ie.dataType==="text"?"text/plain; charset=UTF-8":"application/json; charset=UTF-8",Ne=Ie.method==="GET"?le(Ie.params):"";return new k(function(Ve,Ce){if(window.XMLHttpRequest){var Ue,qe,Oe=new XMLHttpRequest;if(Oe.onreadystatechange=function(){if(Oe.readyState===4)if(Oe.status===200){try{qe=JSON.parse(Oe.response||"{}")}catch{qe=Oe.response}Ve({status:Oe.status,data:qe})}else g(function(){var _e;Ce(new oe(1,Oe.status,O(_e="readyState: ".concat(Oe.readyState,"; statusText: ")).call(_e,Oe.statusText)))},0)},Oe.open(Ie.method,O(Ue="".concat(he)).call(Ue,Ne)),Oe.timeout=Ie.timeout||5e3,Oe.setRequestHeader("Content-Type",ie),Ie.headers)for(var $e in Ie.headers)Oe.setRequestHeader($e,Ie.headers[$e]);Oe.ontimeout=function(_e){Ce(new oe(1,408,_e&&_e.message?_e.message:"request timeout"))},Oe.send(v(Ie.data))}else Ce(new oe(2,10400,"request no suppout"))})}},L(n)==="object"&&t!==void 0?t.exports=i():(s=typeof(r=i)=="function"?r.call(n,e,n,t):r)===void 0||(t.exports=s)},function(t,n,e){var r=e(699),s=e(189),i=e(192),o=e(190),a=e(738),d=e(739);function c(u){var m=typeof r=="function"?new r:void 0;return t.exports=c=function(y){if(y===null||!a(y))return y;if(typeof y!="function")throw new TypeError("Super expression must either be null or a function");if(m!==void 0){if(m.has(y))return m.get(y);m.set(y,S)}function S(){return d(y,arguments,i(this).constructor)}return S.prototype=s(y.prototype,{constructor:{value:S,enumerable:!1,writable:!0,configurable:!0}}),o(S,y)},t.exports.__esModule=!0,t.exports.default=t.exports,c(u)}t.exports=c,t.exports.__esModule=!0,t.exports.default=t.exports},function(t,n,e){t.exports=e(700)},function(t,n,e){t.exports=e(701)},function(t,n,e){var r=e(702);e(713),e(715),e(717),e(719),e(720),e(722),e(723),e(724),e(725),e(726),e(728),e(729),e(730),e(731),e(732),e(733),e(734),e(735),e(736),e(737),t.exports=r},function(t,n,e){var r=e(703);t.exports=r},function(t,n,e){var r=e(704);e(69),t.exports=r},function(t,n,e){e(86),e(705),e(100),e(115);var r=e(13);t.exports=r.Map},function(t,n,e){e(706)},function(t,n,e){e(707)("Map",function(r){return function(){return r(this,arguments.length?arguments[0]:void 0)}},e(711))},function(t,n,e){var r=e(1),s=e(14),i=e(294),o=e(5),a=e(61),d=e(47),c=e(171),u=e(17),m=e(28),y=e(85),S=e(39).f,O=e(74).forEach,k=e(27),g=e(101),v=g.set,ue=g.getterFor;t.exports=function(L,re,le){var oe,he=L.indexOf("Map")!==-1,Ie=L.indexOf("Weak")!==-1,ie=he?"set":"add",Ne=s[L],Ve=Ne&&Ne.prototype,Ce={};if(k&&u(Ne)&&(Ie||Ve.forEach&&!o(function(){new Ne().entries().next()}))){var Ue=(oe=re(function(Oe,$e){v(c(Oe,Ue),{type:L,collection:new Ne}),$e!=null&&d($e,Oe[ie],{that:Oe,AS_ENTRIES:he})})).prototype,qe=ue(L);O(["add","clear","delete","forEach","get","has","set","keys","values","entries"],function(Oe){var $e=Oe=="add"||Oe=="set";!(Oe in Ve)||Ie&&Oe=="clear"||a(Ue,Oe,function(_e,er){var Pt=qe(this).collection;if(!$e&&Ie&&!m(_e))return Oe=="get"&&void 0;var ar=Pt[Oe](_e===0?0:_e,er);return $e?this:ar})}),Ie||S(Ue,"size",{configurable:!0,get:function(){return qe(this).collection.size}})}else oe=le.getConstructor(re,L,he,ie),i.enable();return y(oe,L,!1,!0),Ce[L]=oe,r({global:!0,forced:!0},Ce),Ie||le.setStrong(oe,L,he),oe}},function(t,n,e){var r=e(5),s=e(28),i=e(65),o=e(709),a=Object.isExtensible,d=r(function(){});t.exports=d||o?function(c){return!!s(c)&&(!o||i(c)!="ArrayBuffer")&&(!a||a(c))}:a},function(t,n,e){var r=e(5);t.exports=r(function(){if(typeof ArrayBuffer=="function"){var s=new ArrayBuffer(8);Object.isExtensible(s)&&Object.defineProperty(s,"a",{value:8})}})},function(t,n,e){var r=e(5);t.exports=!r(function(){return Object.isExtensible(Object.preventExtensions({}))})},function(t,n,e){var r=e(39).f,s=e(84),i=e(712),o=e(34),a=e(171),d=e(96),c=e(47),u=e(169),m=e(170),y=e(238),S=e(27),O=e(294).fastKey,k=e(101),g=k.set,v=k.getterFor;t.exports={getConstructor:function(ue,L,re,le){var oe=ue(function(Ve,Ce){a(Ve,he),g(Ve,{type:L,index:s(null),first:void 0,last:void 0,size:0}),S||(Ve.size=0),d(Ce)||c(Ce,Ve[le],{that:Ve,AS_ENTRIES:re})}),he=oe.prototype,Ie=v(L),ie=function(Ve,Ce,Ue){var qe,Oe,$e=Ie(Ve),_e=Ne(Ve,Ce);return _e?_e.value=Ue:($e.last=_e={index:Oe=O(Ce,!0),key:Ce,value:Ue,previous:qe=$e.last,next:void 0,removed:!1},$e.first||($e.first=_e),qe&&(qe.next=_e),S?$e.size++:Ve.size++,Oe!=="F"&&($e.index[Oe]=_e)),Ve},Ne=function(Ve,Ce){var Ue,qe=Ie(Ve),Oe=O(Ce);if(Oe!=="F")return qe.index[Oe];for(Ue=qe.first;Ue;Ue=Ue.next)if(Ue.key==Ce)return Ue};return i(he,{clear:function(){for(var Ve=Ie(this),Ce=Ve.index,Ue=Ve.first;Ue;)Ue.removed=!0,Ue.previous&&(Ue.previous=Ue.previous.next=void 0),delete Ce[Ue.index],Ue=Ue.next;Ve.first=Ve.last=void 0,S?Ve.size=0:this.size=0},delete:function(Ve){var Ce=Ie(this),Ue=Ne(this,Ve);if(Ue){var qe=Ue.next,Oe=Ue.previous;delete Ce.index[Ue.index],Ue.removed=!0,Oe&&(Oe.next=qe),qe&&(qe.previous=Oe),Ce.first==Ue&&(Ce.first=qe),Ce.last==Ue&&(Ce.last=Oe),S?Ce.size--:this.size--}return!!Ue},forEach:function(Ve){for(var Ce,Ue=Ie(this),qe=o(Ve,arguments.length>1?arguments[1]:void 0);Ce=Ce?Ce.next:Ue.first;)for(qe(Ce.value,Ce.key,this);Ce&&Ce.removed;)Ce=Ce.previous},has:function(Ve){return!!Ne(this,Ve)}}),i(he,re?{get:function(Ve){var Ce=Ne(this,Ve);return Ce&&Ce.value},set:function(Ve,Ce){return ie(this,Ve===0?0:Ve,Ce)}}:{add:function(Ve){return ie(this,Ve=Ve===0?0:Ve,Ve)}}),S&&r(he,"size",{get:function(){return Ie(this).size}}),oe},setStrong:function(ue,L,re){var le=L+" Iterator",oe=v(L),he=v(le);u(ue,L,function(Ie,ie){g(this,{type:le,target:Ie,state:oe(Ie),kind:ie,last:void 0})},function(){for(var Ie=he(this),ie=Ie.kind,Ne=Ie.last;Ne&&Ne.removed;)Ne=Ne.previous;return Ie.target&&(Ie.last=Ne=Ne?Ne.next:Ie.state.first)?m(ie=="keys"?Ne.key:ie=="values"?Ne.value:[Ne.key,Ne.value],!1):(Ie.target=void 0,m(void 0,!0))},re?"entries":"values",!re,!0),y(L)}}},function(t,n,e){var r=e(68);t.exports=function(s,i,o){for(var a in i)o&&o.unsafe&&s[a]?s[a]=i[a]:r(s,a,i[a],o);return s}},function(t,n,e){e(1)({target:"Map",stat:!0,forced:!0},{from:e(714)})},function(t,n,e){var r=e(34),s=e(20),i=e(31),o=e(172),a=e(96),d=e(47),c=[].push;t.exports=function(u){var m,y,S,O,k=arguments.length,g=k>1?arguments[1]:void 0;return o(this),(m=g!==void 0)&&i(g),a(u)?new this:(y=[],m?(S=0,O=r(g,k>2?arguments[2]:void 0),d(u,function(v){s(c,y,O(v,S++))})):d(u,c,{that:y}),new this(y))}},function(t,n,e){e(1)({target:"Map",stat:!0,forced:!0},{of:e(716)})},function(t,n,e){var r=e(102);t.exports=function(){return new this(r(arguments))}},function(t,n,e){var r=e(1),s=e(38),i=e(63).remove;r({target:"Map",proto:!0,real:!0,forced:!0},{deleteAll:function(){for(var o,a=s(this),d=!0,c=0,u=arguments.length;c<u;c++)o=i(a,arguments[c]),d=d&&o;return!!d}})},function(t,n){t.exports=function(e,r){return r==1?function(s,i){return s[e](i)}:function(s,i,o){return s[e](i,o)}}},function(t,n,e){var r=e(1),s=e(38),i=e(63),o=i.get,a=i.has,d=i.set;r({target:"Map",proto:!0,real:!0,forced:!0},{emplace:function(c,u){var m,y,S=s(this);return a(S,c)?(m=o(S,c),"update"in u&&(m=u.update(m,c,S),d(S,c,m)),m):(y=u.insert(c,S),d(S,c,y),y)}})},function(t,n,e){var r=e(1),s=e(34),i=e(38),o=e(59);r({target:"Map",proto:!0,real:!0,forced:!0},{every:function(a){var d=i(this),c=s(a,arguments.length>1?arguments[1]:void 0);return o(d,function(u,m){if(!c(u,m,d))return!1},!0)!==!1}})},function(t,n,e){var r=e(20);t.exports=function(s,i,o){for(var a,d,c=o||s.next;!(a=r(c,s)).done;)if((d=i(a.value))!==void 0)return d}},function(t,n,e){var r=e(1),s=e(34),i=e(38),o=e(63),a=e(59),d=o.Map,c=o.set;r({target:"Map",proto:!0,real:!0,forced:!0},{filter:function(u){var m=i(this),y=s(u,arguments.length>1?arguments[1]:void 0),S=new d;return a(m,function(O,k){y(O,k,m)&&c(S,k,O)}),S}})},function(t,n,e){var r=e(1),s=e(34),i=e(38),o=e(59);r({target:"Map",proto:!0,real:!0,forced:!0},{find:function(a){var d=i(this),c=s(a,arguments.length>1?arguments[1]:void 0),u=o(d,function(m,y){if(c(m,y,d))return{value:m}},!0);return u&&u.value}})},function(t,n,e){var r=e(1),s=e(34),i=e(38),o=e(59);r({target:"Map",proto:!0,real:!0,forced:!0},{findKey:function(a){var d=i(this),c=s(a,arguments.length>1?arguments[1]:void 0),u=o(d,function(m,y){if(c(m,y,d))return{key:y}},!0);return u&&u.key}})},function(t,n,e){var r=e(1),s=e(20),i=e(12),o=e(17),a=e(31),d=e(47),c=e(63).Map,u=i([].push);r({target:"Map",stat:!0,forced:!0},{groupBy:function(m,y){var S=new(o(this)?this:c);a(y);var O=a(S.has),k=a(S.get),g=a(S.set);return d(m,function(v){var ue=y(v);s(O,S,ue)?u(s(k,S,ue),v):s(g,S,ue,[v])}),S}})},function(t,n,e){var r=e(1),s=e(727),i=e(38),o=e(59);r({target:"Map",proto:!0,real:!0,forced:!0},{includes:function(a){return o(i(this),function(d){if(s(d,a))return!0},!0)===!0}})},function(t,n){t.exports=function(e,r){return e===r||e!=e&&r!=r}},function(t,n,e){var r=e(1),s=e(20),i=e(47),o=e(17),a=e(31),d=e(63).Map;r({target:"Map",stat:!0,forced:!0},{keyBy:function(c,u){var m=new(o(this)?this:d);a(u);var y=a(m.set);return i(c,function(S){s(y,m,u(S),S)}),m}})},function(t,n,e){var r=e(1),s=e(38),i=e(59);r({target:"Map",proto:!0,real:!0,forced:!0},{keyOf:function(o){var a=i(s(this),function(d,c){if(d===o)return{key:c}},!0);return a&&a.key}})},function(t,n,e){var r=e(1),s=e(34),i=e(38),o=e(63),a=e(59),d=o.Map,c=o.set;r({target:"Map",proto:!0,real:!0,forced:!0},{mapKeys:function(u){var m=i(this),y=s(u,arguments.length>1?arguments[1]:void 0),S=new d;return a(m,function(O,k){c(S,y(O,k,m),O)}),S}})},function(t,n,e){var r=e(1),s=e(34),i=e(38),o=e(63),a=e(59),d=o.Map,c=o.set;r({target:"Map",proto:!0,real:!0,forced:!0},{mapValues:function(u){var m=i(this),y=s(u,arguments.length>1?arguments[1]:void 0),S=new d;return a(m,function(O,k){c(S,k,y(O,k,m))}),S}})},function(t,n,e){var r=e(1),s=e(38),i=e(47),o=e(63).set;r({target:"Map",proto:!0,real:!0,arity:1,forced:!0},{merge:function(a){for(var d=s(this),c=arguments.length,u=0;u<c;)i(arguments[u++],function(m,y){o(d,m,y)},{AS_ENTRIES:!0});return d}})},function(t,n,e){var r=e(1),s=e(31),i=e(38),o=e(59),a=TypeError;r({target:"Map",proto:!0,real:!0,forced:!0},{reduce:function(d){var c=i(this),u=arguments.length<2,m=u?void 0:arguments[1];if(s(d),o(c,function(y,S){u?(u=!1,m=y):m=d(m,y,S,c)}),u)throw a("Reduce of empty map with no initial value");return m}})},function(t,n,e){var r=e(1),s=e(34),i=e(38),o=e(59);r({target:"Map",proto:!0,real:!0,forced:!0},{some:function(a){var d=i(this),c=s(a,arguments.length>1?arguments[1]:void 0);return o(d,function(u,m){if(c(u,m,d))return!0},!0)===!0}})},function(t,n,e){var r=e(1),s=e(31),i=e(38),o=e(63),a=TypeError,d=o.get,c=o.has,u=o.set;r({target:"Map",proto:!0,real:!0,forced:!0},{update:function(m,y){var S=i(this),O=arguments.length;s(y);var k=c(S,m);if(!k&&O<3)throw a("Updating absent value");var g=k?d(S,m):s(O>2?arguments[2]:void 0)(m,S);return u(S,m,y(g,m,S)),S}})},function(t,n,e){e(1)({target:"Map",proto:!0,real:!0,forced:!0},{upsert:e(295)})},function(t,n,e){e(1)({target:"Map",proto:!0,real:!0,name:"upsert",forced:!0},{updateOrInsert:e(295)})},function(t,n,e){var r=e(188);t.exports=function(s){var i;return r(i=Function.toString.call(s)).call(i,"[native code]")!==-1},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,n,e){var r=e(151),s=e(296),i=e(190),o=e(743);function a(d,c,u){var m;return o()?(t.exports=a=r(m=s).call(m),t.exports.__esModule=!0,t.exports.default=t.exports):(t.exports=a=function(y,S,O){var k=[null];k.push.apply(k,S);var g=new(r(Function).apply(y,k));return O&&i(g,O.prototype),g},t.exports.__esModule=!0,t.exports.default=t.exports),a.apply(null,arguments)}t.exports=a,t.exports.__esModule=!0,t.exports.default=t.exports},function(t,n,e){t.exports=e(741)},function(t,n,e){var r=e(742);t.exports=r},function(t,n,e){var r=e(280);t.exports=r},function(t,n,e){var r=e(296);t.exports=function(){if(typeof Reflect>"u"||!r||r.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(r(Boolean,[],function(){})),!0}catch{return!1}},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,n,e){var r=e(16),s=e(0),i=e(193),o=s.merge({},i.idMap,{auth:{id:2,login:3,kicked:5,logout:6,multiPortLogin:7,kick:8},user:{id:3,updatePushToken:1,appBackground:2,markInBlacklist:3,getBlacklist:4,markInMutelist:5,getMutelist:6,getRelations:8,getUsers:7,updateMyInfo:10,updateDonnop:15,syncMyInfo:109,syncUpdateMyInfo:110},notify:{id:4,markRead:3,syncOfflineMsgs:4,batchMarkRead:5,syncOfflineSysMsgs:6,syncOfflineNetcallMsgs:8,syncRoamingMsgs:9,syncMsgReceipts:12,syncRobots:15,syncBroadcastMsgs:16,syncSuperTeamRoamingMsgs:17,syncOfflineSuperTeamSysMsgs:18,syncDeleteSuperTeamMsgOfflineRoaming:19,syncDeleteMsgSelf:21,syncSessionsWithMoreRoaming:22,syncStickTopSessions:23,syncSessionHistoryMsgsDelete:24,syncSessionReliableInfo:25},sync:{id:5,sync:1,syncTeamMembers:2,syncSuperTeamMembers:3},msg:{id:7,sendMsg:1,msg:2,sysMsg:3,getHistoryMsgs:6,sendCustomSysMsg:7,searchHistoryMsgs:8,deleteSessions:9,getSessions:10,syncSendMsg:101,sendMsgReceipt:11,msgReceipt:12,deleteMsg:13,msgDeleted:14,markSessionAck:16,markSessionAckBatch:25,broadcastMsg:17,clearServerHistoryMsgs:18,getServerSessions:19,getServerSession:20,updateServerSession:21,deleteServerSessions:22,deleteMsgSelf:23,deleteMsgSelfBatch:24,msgFtsInServer:26,msgFtsInServerByTiming:27,onClearServerHistoryMsgs:118,syncUpdateServerSession:121,onDeleteMsgSelf:123,onDeleteMsgSelfBatch:124},msgExtend:{id:23,getThreadMsgs:1,getMsgsByIdServer:2,addQuickComment:3,deleteQuickComment:4,onQuickComment:5,onDeleteQuickComment:6,getQuickComments:7,addCollect:8,deleteCollects:9,updateCollect:10,getCollects:11,addStickTopSession:12,deleteStickTopSession:13,updateStickTopSession:14,addMsgPin:15,updateMsgPin:16,deleteMsgPin:17,onAddMsgPin:18,onUpdateMsgPin:19,onDeleteMsgPin:20,getMsgPins:21,syncAddQuickComment:103,syncDeleteQuickComment:104,syncAddStickTopSession:112,syncDeleteStickTopSession:113,syncUpdateStickTopSession:114,syncAddMsgPin:115,syncUpdateMsgPin:116,syncDeleteMsgPin:117},team:{id:8,createTeam:1,sendTeamMsg:2,teamMsg:3,teamMsgs:4,addTeamMembers:5,removeTeamMembers:6,updateTeam:7,leaveTeam:8,getTeam:9,getTeams:10,getTeamMembers:11,dismissTeam:12,applyTeam:13,passTeamApply:14,rejectTeamApply:15,addTeamManagers:16,removeTeamManagers:17,transferTeam:18,updateInfoInTeam:19,updateNickInTeam:20,acceptTeamInvite:21,rejectTeamInvite:22,getTeamHistoryMsgs:23,searchTeamHistoryMsgs:24,updateMuteStateInTeam:25,getMyTeamMembers:26,getMutedTeamMembers:27,sendTeamMsgReceipt:28,getTeamMsgReads:29,getTeamMsgReadAccounts:30,notifyTeamMsgReads:31,muteTeamAll:32,getTeamMemberInvitorAccid:33,getTeamsById:34,syncMyTeamMembers:126,syncTeams:109,syncTeamMembers:111,syncCreateTeam:101,syncSendTeamMsg:102,syncUpdateTeamMember:119},superTeam:{id:21,sendSuperTeamMsg:2,superTeamMsg:3,addSuperTeamMembers:5,removeSuperTeamMembers:6,leaveSuperTeam:7,updateSuperTeam:8,getSuperTeam:9,getSuperTeams:12,updateInfoInSuperTeam:10,getMySuperTeamMembers:11,getSuperTeamMembers:13,getSuperTeamHistoryMsgs:14,getSuperTeamMembersByJoinTime:15,sendSuperTeamCustomSysMsg:16,deleteSuperTeamMsg:17,superTeamMsgDelete:18,superTeamCustomSysMsg:19,applySuperTeam:20,passSuperTeamApply:21,rejectSuperTeamApply:22,acceptSuperTeamInvite:23,rejectSuperTeamInvite:24,markSuperTeamSessionAck:25,addSuperTeamManagers:26,removeSuperTeamManagers:27,updateSuperTeamMute:28,updateSuperTeamMembersMute:29,updateNickInSuperTeam:30,transferSuperTeam:31,markSuperTeamSessionsAck:32,getSuperTeamMembersByAccounts:33,getMutedSuperTeamMembers:34,syncMySuperTeamMembers:111,syncSuperTeams:109,syncSuperTeamMembers:113,syncCreateSuperTeam:101,syncSendSuperTeamMsg:102,syncUpdateSuperTeamMember:110,syncDeleteSuperTeamMsg:117},friend:{id:12,friendRequest:1,syncFriendRequest:101,deleteFriend:2,syncDeleteFriend:102,updateFriend:3,syncUpdateFriend:103,getFriends:4},chatroom:{id:13,getChatroomAddress:1},filter:{id:101,sendFilterMsg:1,filterMsg:2,filterSysMsg:3,sendFilterCustomSysMsg:7},eventService:{id:14,publishEvent:1,pushEvent:2,subscribeEvent:3,unSubscribeEventsByAccounts:4,unSubscribeEventsByType:5,querySubscribeEventsByAccounts:6,querySubscribeEventsByType:7,pushEvents:9},proxyService:{id:22,httpProxy:1,onProxyMsg:2},qchat:{id:24,getQChatAddress:1}}),a=s.merge({},i.cmdConfig,{login:{sid:o.auth.id,cid:o.auth.login,params:[{type:"Property",name:"login"}]},logout:{sid:o.auth.id,cid:o.auth.logout},kick:{sid:o.auth.id,cid:o.auth.kick,params:[{type:"StrArray",name:"deviceIds"}]},updatePushToken:{sid:o.user.id,cid:o.user.updatePushToken,params:[{type:"String",name:"tokenName"},{type:"String",name:"token"},{type:"int",name:"pushkit"}]},appBackground:{sid:o.user.id,cid:o.user.appBackground,params:[{type:"bool",name:"isBackground"},{type:"Int",name:"badge"}]},markInBlacklist:{sid:o.user.id,cid:o.user.markInBlacklist,params:[{type:"String",name:"account"},{type:"bool",name:"isAdd"}]},getBlacklist:{sid:o.user.id,cid:o.user.getBlacklist,params:[{type:"long",name:"time"}]},markInMutelist:{sid:o.user.id,cid:o.user.markInMutelist,params:[{type:"String",name:"account"},{type:"bool",name:"isAdd"}]},getMutelist:{sid:o.user.id,cid:o.user.getMutelist,params:[{type:"long",name:"time"}]},getRelations:{sid:o.user.id,cid:o.user.getRelations,params:[{type:"long",name:"timetag"}]},getUsers:{sid:o.user.id,cid:o.user.getUsers,params:[{type:"StrArray",name:"accounts"}]},updateMyInfo:{sid:o.user.id,cid:o.user.updateMyInfo,params:[{type:"Property",name:"user"},{type:"Property",name:"antispamTag"}]},updateDonnop:{sid:o.user.id,cid:o.user.updateDonnop,params:[{type:"Property",name:"donnop"}]},markRead:{sid:o.notify.id,cid:o.notify.markRead,params:[{type:"long",name:"id"},{type:"ph",name:"ph"}]},batchMarkRead:{sid:o.notify.id,cid:o.notify.batchMarkRead,params:[{type:"byte",name:"sid"},{type:"byte",name:"cid"},{type:"LongArray",name:"ids"}]},sync:{sid:o.sync.id,cid:o.sync.sync,isAwaitable:!1,params:[{type:"Property",name:"sync"}]},syncTeamMembers:{sid:o.sync.id,cid:o.sync.syncTeamMembers,params:[{type:"LongLongMap",name:"sync"}]},syncSuperTeamMembers:{sid:o.sync.id,cid:o.sync.syncSuperTeamMembers,params:[{type:"LongLongMap",name:"sync"}]},sendMsg:{sid:o.msg.id,cid:o.msg.sendMsg,params:[{type:"Property",name:"msg"}]},getHistoryMsgs:{sid:o.msg.id,cid:o.msg.getHistoryMsgs,params:[{type:"String",name:"to"},{type:"long",name:"beginTime"},{type:"long",name:"endTime"},{type:"long",name:"lastMsgId"},{type:"int",name:"limit"},{type:"bool",name:"reverse"},{type:"LongArray",name:"msgTypes"}]},sendCustomSysMsg:{sid:o.msg.id,cid:o.msg.sendCustomSysMsg,params:[{type:"Property",name:"sysMsg"}]},searchHistoryMsgs:{sid:o.msg.id,cid:o.msg.searchHistoryMsgs,params:[{type:"String",name:"to"},{type:"long",name:"beginTime"},{type:"long",name:"endTime"},{type:"String",name:"keyword"},{type:"int",name:"limit"},{type:"bool",name:"reverse"}]},getSessions:{sid:o.msg.id,cid:o.msg.getSessions,params:[{type:"long",name:"time"}]},deleteSessions:{sid:o.msg.id,cid:o.msg.deleteSessions,params:[{type:"StrArray",name:"sessions"}]},sendMsgReceipt:{sid:o.msg.id,cid:o.msg.sendMsgReceipt,params:[{type:"Property",name:"msgReceipt"}]},deleteMsg:{sid:o.msg.id,cid:o.msg.deleteMsg,params:[{type:"Property",name:"sysMsg"}]},markSessionAck:{sid:o.msg.id,cid:o.msg.markSessionAck,params:[{type:"byte",name:"scene"},{type:"String",name:"to"},{type:"long",name:"timetag"}]},markSessionAckBatch:{sid:o.msg.id,cid:o.msg.markSessionAckBatch,params:[{type:"PropertyArray",name:"sessionAckTags",entity:"sessionAckTag"}]},clearServerHistoryMsgs:{sid:o.msg.id,cid:o.msg.clearServerHistoryMsgs,params:[{type:"Property",name:"clearMsgsParams"}]},clearServerHistoryMsgsWithSync:{sid:o.msg.id,cid:o.msg.clearServerHistoryMsgs,params:[{type:"Property",name:"clearMsgsParamsWithSync"}]},msgFtsInServer:{sid:o.msg.id,cid:o.msg.msgFtsInServer,params:[{type:"Property",name:"msgFullSearchRequestTag"}]},msgFtsInServerByTiming:{sid:o.msg.id,cid:o.msg.msgFtsInServerByTiming,params:[{type:"Property",name:"msgTimingFullSearchRequestTag"}]},onClearServerHistoryMsgs:{sid:o.msg.id,cid:o.msg.clearServerHistoryMsgs},getServerSessions:{sid:o.msg.id,cid:o.msg.getServerSessions,params:[{type:"Property",name:"sessionReqTag"}]},getServerSession:{sid:o.msg.id,cid:o.msg.getServerSession,params:[{type:"Property",name:"session"}]},updateServerSession:{sid:o.msg.id,cid:o.msg.updateServerSession,params:[{type:"Property",name:"session"}]},deleteServerSessions:{sid:o.msg.id,cid:o.msg.deleteServerSessions,params:[{type:"PropertyArray",name:"sessions",entity:"session"}]},deleteMsgSelf:{sid:o.msg.id,cid:o.msg.deleteMsgSelf,params:[{type:"Property",name:"deleteMsgSelfTag"}]},deleteMsgSelfBatch:{sid:o.msg.id,cid:o.msg.deleteMsgSelfBatch,params:[{type:"PropertyArray",name:"deleteMsgSelfTags",entity:"deleteMsgSelfTag"}]},onDeleteMsgSelf:{sid:o.msg.id,cid:o.msg.onDeleteMsgSelf},onDeleteMsgSelfBatch:{sid:o.msg.id,cid:o.msg.onDeleteMsgSelfBatch},sendSuperTeamMsg:{sid:o.superTeam.id,cid:o.superTeam.sendSuperTeamMsg,params:[{type:"Property",name:"msg"}]},addSuperTeamMembers:{sid:o.superTeam.id,cid:o.superTeam.addSuperTeamMembers,params:[{type:"long",name:"teamId"},{type:"StrArray",name:"accounts"},{type:"String",name:"ps"}]},removeSuperTeamMembers:{sid:o.superTeam.id,cid:o.superTeam.removeSuperTeamMembers,params:[{type:"long",name:"teamId"},{type:"StrArray",name:"accounts"}]},leaveSuperTeam:{sid:o.superTeam.id,cid:o.superTeam.leaveSuperTeam,params:[{type:"long",name:"teamId"}]},updateSuperTeam:{sid:o.superTeam.id,cid:o.superTeam.updateSuperTeam,params:[{type:"Property",name:"team"},{type:"Property",name:"antispamTag"}]},getSuperTeam:{sid:o.superTeam.id,cid:o.superTeam.getSuperTeam,params:[{type:"long",name:"teamId"}]},getSuperTeams:{sid:o.superTeam.id,cid:o.superTeam.getSuperTeams,params:[{type:"long",name:"timetag"}]},getSuperTeamMembers:{sid:o.superTeam.id,cid:o.superTeam.getSuperTeamMembers,params:[{type:"long",name:"teamId"},{type:"long",name:"timetag"}]},updateInfoInSuperTeam:{sid:o.superTeam.id,cid:o.superTeam.updateInfoInSuperTeam,params:[{type:"Property",name:"superTeamMember"},{type:"Property",name:"teamSpecialFollowUpdateTag"}]},getSuperTeamHistoryMsgs:{sid:o.superTeam.id,cid:o.superTeam.getSuperTeamHistoryMsgs,params:[{type:"long",name:"to"},{type:"long",name:"beginTime"},{type:"long",name:"endTime"},{type:"long",name:"lastMsgId"},{type:"int",name:"limit"},{type:"bool",name:"reverse"},{type:"LongArray",name:"msgTypes"}]},applySuperTeam:{sid:o.superTeam.id,cid:o.superTeam.applySuperTeam,params:[{type:"long",name:"teamId"},{type:"String",name:"ps"}]},passSuperTeamApply:{sid:o.superTeam.id,cid:o.superTeam.passSuperTeamApply,params:[{type:"long",name:"teamId"},{type:"String",name:"from"}]},rejectSuperTeamApply:{sid:o.superTeam.id,cid:o.superTeam.rejectSuperTeamApply,params:[{type:"long",name:"teamId"},{type:"String",name:"from"},{type:"String",name:"ps"}]},acceptSuperTeamInvite:{sid:o.superTeam.id,cid:o.superTeam.acceptSuperTeamInvite,params:[{type:"long",name:"teamId"},{type:"String",name:"from"}]},rejectSuperTeamInvite:{sid:o.superTeam.id,cid:o.superTeam.rejectSuperTeamInvite,params:[{type:"long",name:"teamId"},{type:"String",name:"from"},{type:"String",name:"ps"}]},markSuperTeamSessionAck:{sid:o.superTeam.id,cid:o.superTeam.markSuperTeamSessionAck,params:[{type:"long",name:"to"},{type:"long",name:"timetag"}]},addSuperTeamManagers:{sid:o.superTeam.id,cid:o.superTeam.addSuperTeamManagers,params:[{type:"long",name:"teamId"},{type:"StrArray",name:"accounts"}]},removeSuperTeamManagers:{sid:o.superTeam.id,cid:o.superTeam.removeSuperTeamManagers,params:[{type:"long",name:"teamId"},{type:"StrArray",name:"accounts"}]},updateSuperTeamMute:{sid:o.superTeam.id,cid:o.superTeam.updateSuperTeamMute,params:[{type:"long",name:"teamId"},{type:"int",name:"mute"}]},updateSuperTeamMembersMute:{sid:o.superTeam.id,cid:o.superTeam.updateSuperTeamMembersMute,params:[{type:"long",name:"teamId"},{type:"StrArray",name:"accounts"},{type:"int",name:"mute"}]},updateNickInSuperTeam:{sid:o.superTeam.id,cid:o.superTeam.updateNickInSuperTeam,params:[{type:"Property",name:"superTeamMember"}]},transferSuperTeam:{sid:o.superTeam.id,cid:o.superTeam.transferSuperTeam,params:[{type:"long",name:"teamId"},{type:"String",name:"account"},{type:"bool",name:"leave"}]},markSuperTeamSessionsAck:{sid:o.superTeam.id,cid:o.superTeam.markSuperTeamSessionsAck,params:[{type:"PropertyArray",name:"sessionAckTags",entity:"sessionAckTag"}]},getSuperTeamMembersByJoinTime:{sid:o.superTeam.id,cid:o.superTeam.getSuperTeamMembersByJoinTime,params:[{type:"long",name:"teamId"},{type:"long",name:"joinTime"},{type:"int",name:"limit"},{type:"bool",name:"reverse"}]},getSuperTeamMembersByAccounts:{sid:o.superTeam.id,cid:o.superTeam.getSuperTeamMembersByAccounts,params:[{type:"StrArray",name:"memberIds"}]},getMutedSuperTeamMembers:{sid:o.superTeam.id,cid:o.superTeam.getMutedSuperTeamMembers,params:[{type:"long",name:"teamId"},{type:"long",name:"joinTime"},{type:"int",name:"limit"},{type:"bool",name:"reverse"}]},sendSuperTeamCustomSysMsg:{sid:o.superTeam.id,cid:o.superTeam.sendSuperTeamCustomSysMsg,params:[{type:"Property",name:"sysMsg"}]},deleteSuperTeamMsg:{sid:o.superTeam.id,cid:o.superTeam.deleteSuperTeamMsg,params:[{type:"Property",name:"sysMsg"}]},getMySuperTeamMembers:{sid:o.superTeam.id,cid:o.superTeam.getMySuperTeamMembers,params:[{type:"LongArray",name:"teamIds"}]},createTeam:{sid:o.team.id,cid:o.team.createTeam,params:[{type:"Property",name:"team"},{type:"StrArray",name:"accounts"},{type:"String",name:"ps"},{type:"Property",name:"antispamTag"}]},sendTeamMsg:{sid:o.team.id,cid:o.team.sendTeamMsg,params:[{type:"Property",name:"msg"}]},addTeamMembers:{sid:o.team.id,cid:o.team.addTeamMembers,params:[{type:"long",name:"teamId"},{type:"StrArray",name:"accounts"},{type:"String",name:"ps"},{type:"String",name:"attach"}]},removeTeamMembers:{sid:o.team.id,cid:o.team.removeTeamMembers,params:[{type:"long",name:"teamId"},{type:"StrArray",name:"accounts"}]},updateTeam:{sid:o.team.id,cid:o.team.updateTeam,params:[{type:"Property",name:"team"},{type:"Property",name:"antispamTag"}]},leaveTeam:{sid:o.team.id,cid:o.team.leaveTeam,params:[{type:"long",name:"teamId"}]},getTeam:{sid:o.team.id,cid:o.team.getTeam,params:[{type:"long",name:"teamId"}]},getTeams:{sid:o.team.id,cid:o.team.getTeams,params:[{type:"long",name:"timetag"}]},getTeamsById:{sid:o.team.id,cid:o.team.getTeamsById,params:[{type:"longArray",name:"teamIds"}]},getTeamMembers:{sid:o.team.id,cid:o.team.getTeamMembers,params:[{type:"long",name:"teamId"},{type:"long",name:"timetag"}]},dismissTeam:{sid:o.team.id,cid:o.team.dismissTeam,params:[{type:"long",name:"teamId"}]},applyTeam:{sid:o.team.id,cid:o.team.applyTeam,params:[{type:"long",name:"teamId"},{type:"String",name:"ps"}]},passTeamApply:{sid:o.team.id,cid:o.team.passTeamApply,params:[{type:"long",name:"teamId"},{type:"String",name:"from"}]},rejectTeamApply:{sid:o.team.id,cid:o.team.rejectTeamApply,params:[{type:"long",name:"teamId"},{type:"String",name:"from"},{type:"String",name:"ps"}]},addTeamManagers:{sid:o.team.id,cid:o.team.addTeamManagers,params:[{type:"long",name:"teamId"},{type:"StrArray",name:"accounts"}]},removeTeamManagers:{sid:o.team.id,cid:o.team.removeTeamManagers,params:[{type:"long",name:"teamId"},{type:"StrArray",name:"accounts"}]},transferTeam:{sid:o.team.id,cid:o.team.transferTeam,params:[{type:"long",name:"teamId"},{type:"String",name:"account"},{type:"bool",name:"leave"}]},updateInfoInTeam:{sid:o.team.id,cid:o.team.updateInfoInTeam,params:[{type:"Property",name:"teamMember"},{type:"Property",name:"teamSpecialFollowUpdateTag"}]},updateNickInTeam:{sid:o.team.id,cid:o.team.updateNickInTeam,params:[{type:"Property",name:"teamMember"}]},acceptTeamInvite:{sid:o.team.id,cid:o.team.acceptTeamInvite,params:[{type:"long",name:"teamId"},{type:"String",name:"from"}]},rejectTeamInvite:{sid:o.team.id,cid:o.team.rejectTeamInvite,params:[{type:"long",name:"teamId"},{type:"String",name:"from"},{type:"String",name:"ps"}]},getTeamHistoryMsgs:{sid:o.team.id,cid:o.team.getTeamHistoryMsgs,params:[{type:"long",name:"to"},{type:"long",name:"beginTime"},{type:"long",name:"endTime"},{type:"long",name:"lastMsgId"},{type:"int",name:"limit"},{type:"bool",name:"reverse"},{type:"LongArray",name:"msgTypes"}]},searchTeamHistoryMsgs:{sid:o.team.id,cid:o.team.searchTeamHistoryMsgs,params:[{type:"long",name:"to"},{type:"long",name:"beginTime"},{type:"long",name:"endTime"},{type:"String",name:"keyword"},{type:"int",name:"limit"},{type:"bool",name:"reverse"}]},updateMuteStateInTeam:{sid:o.team.id,cid:o.team.updateMuteStateInTeam,params:[{type:"long",name:"teamId"},{type:"String",name:"account"},{type:"int",name:"mute"}]},getMyTeamMembers:{sid:o.team.id,cid:o.team.getMyTeamMembers,params:[{type:"LongArray",name:"teamIds"}]},getMutedTeamMembers:{sid:o.team.id,cid:o.team.getMutedTeamMembers,params:[{type:"long",name:"teamId"}]},sendTeamMsgReceipt:{sid:o.team.id,cid:o.team.sendTeamMsgReceipt,params:[{type:"PropertyArray",name:"teamMsgReceipts",entity:"teamMsgReceipt"}]},getTeamMsgReads:{sid:o.team.id,cid:o.team.getTeamMsgReads,params:[{type:"PropertyArray",name:"teamMsgReceipts",entity:"teamMsgReceipt"}]},getTeamMsgReadAccounts:{sid:o.team.id,cid:o.team.getTeamMsgReadAccounts,params:[{type:"Property",name:"teamMsgReceipt"}]},muteTeamAll:{sid:o.team.id,cid:o.team.muteTeamAll,params:[{type:"long",name:"teamId"},{type:"int",name:"mute"}]},getTeamMemberInvitorAccid:{sid:o.team.id,cid:o.team.getTeamMemberInvitorAccid,params:[{type:"long",name:"teamId"},{type:"StrArray",name:"accounts"}]},friendRequest:{sid:o.friend.id,cid:o.friend.friendRequest,params:[{type:"String",name:"account"},{type:"byte",name:"type"},{type:"String",name:"ps"}]},deleteFriend:{sid:o.friend.id,cid:o.friend.deleteFriend,params:[{type:"String",name:"account"},{type:"Property",name:"delFriendParams"}]},updateFriend:{sid:o.friend.id,cid:o.friend.updateFriend,params:[{type:"Property",name:"friend"}]},getFriends:{sid:o.friend.id,cid:o.friend.getFriends,params:[{type:"long",name:"timetag"}]},getChatroomAddress:{sid:o.chatroom.id,cid:o.chatroom.getChatroomAddress,params:[{type:"long",name:"chatroomId"},{type:"bool",name:"isWeixinApp"},{type:"number",name:"type"}]},sendFilterMsg:{sid:r(o).id,cid:r(o).sendFilterMsg,params:[{type:"Property",name:"msg"}]},sendFilterCustomSysMsg:{sid:r(o).id,cid:r(o).sendFilterCustomSysMsg,params:[{type:"Property",name:"sysMsg"}]},publishEvent:{sid:o.eventService.id,cid:o.eventService.publishEvent,params:[{type:"Property",name:"msgEvent"}]},pushEvent:{sid:o.eventService.id,cid:o.eventService.pushEvent},subscribeEvent:{sid:o.eventService.id,cid:o.eventService.subscribeEvent,params:[{type:"Property",name:"msgEventSubscribe"},{type:"StrArray",name:"accounts"}]},unSubscribeEventsByAccounts:{sid:o.eventService.id,cid:o.eventService.unSubscribeEventsByAccounts,params:[{type:"Property",name:"msgEventSubscribe"},{type:"StrArray",name:"accounts"}]},unSubscribeEventsByType:{sid:o.eventService.id,cid:o.eventService.unSubscribeEventsByType,params:[{type:"Property",name:"msgEventSubscribe"}]},querySubscribeEventsByAccounts:{sid:o.eventService.id,cid:o.eventService.querySubscribeEventsByAccounts,params:[{type:"Property",name:"msgEventSubscribe"},{type:"StrArray",name:"accounts"}]},querySubscribeEventsByType:{sid:o.eventService.id,cid:o.eventService.querySubscribeEventsByType,params:[{type:"Property",name:"msgEventSubscribe"}]},pushEvents:{sid:o.eventService.id,cid:o.eventService.pushEvents},getThreadMsgs:{sid:o.msgExtend.id,cid:o.msgExtend.getThreadMsgs,params:[{type:"Property",name:"msg"},{type:"Property",name:"threadMsgReq"}]},getMsgsByIdServer:{sid:o.msgExtend.id,cid:o.msgExtend.getMsgsByIdServer,params:[{type:"PropertyArray",name:"reqMsgs",entity:"msg"}]},addQuickComment:{sid:o.msgExtend.id,cid:o.msgExtend.addQuickComment,params:[{type:"Property",name:"msg"},{type:"Property",name:"comment"}]},deleteQuickComment:{sid:o.msgExtend.id,cid:o.msgExtend.deleteQuickComment,params:[{type:"Property",name:"msg"},{type:"Property",name:"comment"}]},getQuickComments:{sid:o.msgExtend.id,cid:o.msgExtend.getQuickComments,params:[{type:"PropertyArray",name:"commentReq",entity:"commentReq"}]},addCollect:{sid:o.msgExtend.id,cid:o.msgExtend.addCollect,params:[{type:"Property",name:"collect"}]},deleteCollects:{sid:o.msgExtend.id,cid:o.msgExtend.deleteCollects,params:[{type:"PropertyArray",name:"collectList",entity:"collect"}]},updateCollect:{sid:o.msgExtend.id,cid:o.msgExtend.updateCollect,params:[{type:"Property",name:"collect"}]},getCollects:{sid:o.msgExtend.id,cid:o.msgExtend.getCollects,params:[{type:"Property",name:"collectQuery"}]},addStickTopSession:{sid:o.msgExtend.id,cid:o.msgExtend.addStickTopSession,params:[{type:"Property",name:"stickTopSession"}]},updateStickTopSession:{sid:o.msgExtend.id,cid:o.msgExtend.updateStickTopSession,params:[{type:"Property",name:"stickTopSession"}]},deleteStickTopSession:{sid:o.msgExtend.id,cid:o.msgExtend.deleteStickTopSession,params:[{type:"Property",name:"stickTopSession"}]},addMsgPin:{sid:o.msgExtend.id,cid:o.msgExtend.addMsgPin,params:[{type:"Property",name:"msg"},{type:"Property",name:"pinTag"}]},updateMsgPin:{sid:o.msgExtend.id,cid:o.msgExtend.updateMsgPin,params:[{type:"Property",name:"msg"},{type:"Property",name:"pinTag"}]},deleteMsgPin:{sid:o.msgExtend.id,cid:o.msgExtend.deleteMsgPin,params:[{type:"Property",name:"msg"},{type:"Property",name:"pinTag"}]},getMsgPins:{sid:o.msgExtend.id,cid:o.msgExtend.getMsgPins,params:[{type:"Property",name:"msgPinReq"}]},httpProxy:{sid:o.proxyService.id,cid:o.proxyService.httpProxy,params:[{type:"Property",name:"proxyTag"}]},getQChatAddress:{sid:o.qchat.id,cid:o.qchat.getQChatAddress,params:[{type:"Property",name:"getQChatAddressTag"}]}}),d=s.merge({},i.packetConfig,{"2_3":{service:"auth",cmd:"login",response:[{type:"Property",name:"loginRes"},{type:"PropertyArray",name:"loginPorts",entity:"loginPort"},{type:"Property",name:"aosPushInfo"}]},"2_5":{service:"auth",cmd:"kicked",response:[{type:"Number",name:"from"},{type:"Number",name:"reason"},{type:"String",name:"custom"},{type:"Number",name:"customClientType"}]},"2_6":{service:"auth",cmd:"logout"},"2_7":{service:"auth",cmd:"multiPortLogin",response:[{type:"Number",name:"state"},{type:"PropertyArray",name:"loginPorts",entity:"loginPort"}]},"2_8":{service:"auth",cmd:"kick",response:[{type:"StrArray",name:"deviceIds"}]},"3_1":{service:"user",cmd:"updatePushToken"},"3_2":{service:"user",cmd:"appBackground"},"3_3":{service:"user",cmd:"markInBlacklist"},"3_103":{service:"user",cmd:"syncMarkInBlacklist",response:[{type:"String",name:"account"},{type:"Boolean",name:"isAdd"}]},"3_4":{service:"user",cmd:"getBlacklist",response:[{type:"StrArray",name:"blacklist"}]},"3_5":{service:"user",cmd:"markInMutelist"},"3_105":{service:"user",cmd:"syncMarkInMutelist",response:[{type:"String",name:"account"},{type:"Boolean",name:"isAdd"}]},"3_6":{service:"user",cmd:"getMutelist",response:[{type:"StrArray",name:"mutelist"}]},"3_8":{service:"user",cmd:"getRelations",response:[{type:"PropertyArray",name:"specialRelations",entity:"specialRelation"},{type:"Number",name:"timetag"}]},"3_7":{service:"user",cmd:"getUsers",response:[{type:"PropertyArray",name:"users",entity:"user"}]},"3_10":{service:"user",cmd:"updateMyInfo",response:[{type:"Number",name:"timetag"}]},"3_15":{service:"user",cmd:"updateDonnop",response:[{type:"Number",name:"timetag"}]},"3_115":{service:"user",cmd:"syncUpdateDonnop",response:[{type:"Property",name:"donnop"},{type:"Number",name:"timetag"}]},"3_109":{service:"user",cmd:"syncMyInfo",response:[{type:"Property",name:"user"},{type:"Number",name:"timetag"}]},"3_110":{service:"user",cmd:"syncUpdateMyInfo",response:[{type:"Property",name:"user"}]},"4_1":{service:"notify"},"4_2":{service:"notify"},"4_3":{service:"notify",cmd:"markRead"},"4_4":{service:"notify",cmd:"syncOfflineMsgs",response:[{type:"PropertyArray",name:"msgs",entity:"msg"}]},"4_5":{service:"notify",cmd:"batchMarkRead"},"4_6":{service:"notify",cmd:"syncOfflineSysMsgs",response:[{type:"PropertyArray",name:"sysMsgs",entity:"sysMsg"}]},"4_8":{service:"notify",cmd:"syncOfflineNetcallMsgs",response:[{type:"PropertyArray",name:"msgs",entity:"msg"}]},"4_9":{service:"notify",cmd:"syncRoamingMsgs",response:[{type:"PropertyArray",name:"msgs",entity:"msg"}]},"4_12":{service:"notify",cmd:"syncMsgReceipts",response:[{type:"PropertyArray",name:"msgReceipts",entity:"msgReceipt"},{type:"Number",name:"timetag"}]},"4_13":{service:"notify",cmd:"syncDonnop",response:[{type:"Property",name:"donnop"},{type:"Number",name:"timetag"}]},"4_14":{service:"notify",cmd:"syncSessionAck",response:[{type:"StrLongMap",name:"p2p"},{type:"LongLongMap",name:"team"},{type:"Number",name:"timetag"}]},"4_15":{service:"notify",cmd:"syncRobots",response:[{type:"PropertyArray",name:"robots",entity:"robot"}]},"4_16":{service:"notify",cmd:"syncBroadcastMsgs",response:[{type:"PropertyArray",name:"broadcastMsgs",entity:"broadcastMsg"}]},"4_17":{service:"notify",cmd:"syncSuperTeamRoamingMsgs",response:[{type:"PropertyArray",name:"msgs",entity:"msg"}]},"4_18":{service:"notify",cmd:"syncOfflineSuperTeamSysMsgs",response:[{type:"PropertyArray",name:"sysMsgs",entity:"sysMsg"}]},"4_19":{service:"notify",cmd:"syncDeleteSuperTeamMsgOfflineRoaming",response:[{type:"PropertyArray",name:"sysMsgs",entity:"sysMsg"},{type:"Number",name:"timetag"},{type:"Number",name:"type"}]},"4_20":{service:"notify",cmd:"syncSuperTeamSessionAck",response:[{type:"LongLongMap",name:"superTeam"},{type:"Number",name:"timetag"}]},"4_21":{service:"notify",cmd:"syncDeleteMsgSelf",response:[{type:"PropertyArray",name:"deletedMsgs",entity:"deleteMsgSelfTag"}]},"4_22":{service:"notify",cmd:"syncSessionsWithMoreRoaming",response:[{type:"PropertyArray",name:"sessions",entity:"msg"}]},"4_23":{service:"notify",cmd:"syncStickTopSessions",response:[{type:"Number",name:"timetag"},{type:"boolean",name:"modify"},{type:"PropertyArray",name:"sessions",entity:"stickTopSession"}]},"4_24":{service:"notify",cmd:"syncSessionHistoryMsgsDelete",response:[{type:"PropertyArray",name:"sessionHistoryMsgsDeleteTags",entity:"clearMsgsParamsWithSync"}]},"4_25":{service:"notify",cmd:"syncSessionReliableInfo",response:[{type:"Property",name:"context",entity:"sessionReliableSyncContextTag"},{type:"PropertyArray",name:"datas",entity:"sessionReliableSyncTag"}]},"4_100":{service:"notify",cmd:"syncOfflineFilterMsgs",response:[{type:"PropertyArray",name:"msgs",entity:"msg"}]},"4_101":{service:"notify",cmd:"syncOfflineFilterSysMsgs",response:[{type:"PropertyArray",name:"sysMsgs",entity:"sysMsg"}]},"5_1":{service:"sync",cmd:"syncDone",response:[{type:"Number",name:"timetag"}]},"5_2":{service:"sync",cmd:"syncTeamMembersDone",response:[{type:"Number",name:"timetag"}]},"5_3":{service:"sync",cmd:"syncSuperTeamMembersDone",response:[{type:"Number",name:"timetag"}]},"7_1":{service:"msg",cmd:"sendMsg",response:[{type:"Property",name:"msg"}],trivialErrorCodes:[7101]},"7_2":{service:"msg",cmd:"msg",response:[{type:"Property",name:"msg"}]},"7_3":{service:"msg",cmd:"sysMsg",response:[{type:"Property",name:"sysMsg"}]},"7_6":{service:"msg",cmd:"getHistoryMsgs",response:[{type:"PropertyArray",name:"msgs",entity:"msg"}]},"7_7":{service:"msg",cmd:"sendCustomSysMsg",trivialErrorCodes:[7101]},"7_8":{service:"msg",cmd:"searchHistoryMsgs",response:[{type:"PropertyArray",name:"msgs",entity:"msg"}]},"7_9":{service:"msg",cmd:"deleteSessions"},"7_10":{service:"msg",cmd:"getSessions",response:[{type:"StrArray",name:"sessions"}]},"7_101":{service:"msg",cmd:"syncSendMsg",response:[{type:"Property",name:"msg"}]},"7_11":{service:"msg",cmd:"sendMsgReceipt",response:[{type:"Property",name:"msgReceipt"}]},"7_12":{service:"msg",cmd:"msgReceipt",response:[{type:"Property",name:"msgReceipt"}]},"7_13":{service:"msg",cmd:"onDeleteMsg"},"7_14":{service:"msg",cmd:"onMsgDeleted",response:[{type:"Property",name:"sysMsg"}]},"7_15":{service:"msg",cmd:"onDeleteMsgOfflineRoaming",response:[{type:"PropertyArray",name:"sysMsgs",entity:"sysMsg"},{type:"Number",name:"timetag"},{type:"Number",name:"type"}]},"7_16":{service:"msg",cmd:"onMarkSessionAck"},"7_17":{service:"msg",cmd:"broadcastMsg",response:[{type:"Property",name:"broadcastMsg"}]},"7_18":{service:"msg",cmd:"clearServerHistoryMsgs",response:[{type:"Long",name:"timetag"}]},"7_19":{service:"session",cmd:"getServerSessions",response:[{type:"Property",name:"sessionReqTag"},{type:"PropertyArray",name:"sessionList",entity:"session"}]},"7_20":{service:"session",cmd:"getServerSession",response:[{type:"Property",name:"session"}]},"7_21":{service:"session",cmd:"updateServerSession"},"7_22":{service:"session",cmd:"deleteServerSessions"},"7_23":{service:"msg",cmd:"deleteMsgSelf",response:[{type:"Long",name:"timetag"}]},"7_24":{service:"msg",cmd:"deleteMsgSelfBatch",response:[{type:"Long",name:"timetag"}]},"7_25":{service:"msg",cmd:"onMarkSessionAckBatch"},"7_26":{service:"msg",cmd:"msgFtsInServer",response:[{type:"PropertyArray",name:"msgs",entity:"msg"}]},"7_27":{service:"msg",cmd:"msgFtsInServerByTiming",response:[{type:"PropertyArray",name:"msgs",entity:"msg"}]},"7_118":{service:"msg",cmd:"onClearServerHistoryMsgs",response:[{type:"Property",name:"sessionHistoryMsgsDeleteTag",entity:"clearMsgsParamsWithSync"}]},"7_123":{service:"msg",cmd:"onDeleteMsgSelf",response:[{type:"Property",name:"deleteMsgSelfTag"}]},"7_124":{service:"msg",cmd:"onDeleteMsgSelfBatch",response:[{type:"PropertyArray",name:"deleteMsgSelfTags",entity:"deleteMsgSelfTag"}]},"7_116":{service:"msg",cmd:"syncMarkSessionAck",response:[{type:"Number",name:"scene"},{type:"String",name:"to"},{type:"Number",name:"timetag"}]},"7_121":{service:"msg",cmd:"syncUpdateServerSession",response:[{type:"Property",name:"session"}]},"23_1":{service:"msgExtend",cmd:"getThreadMsgs",response:[{type:"Property",name:"threadMsg",entity:"msg"},{type:"Property",name:"threadMsgsMeta"},{type:"PropertyArray",name:"msgs",entity:"msg"}]},"23_2":{service:"msgExtend",cmd:"getMsgsByIdServer",response:[{type:"PropertyArray",name:"msgs",entity:"msg"}]},"23_3":{service:"msgExtend",cmd:"addQuickComment",response:[{type:"Number",name:"timetag"}]},"23_4":{service:"msgExtend",cmd:"deleteQuickComment",response:[{type:"Number",name:"timetag"}]},"23_5":{service:"msgExtend",cmd:"onQuickComment",response:[{type:"Property",name:"msg"},{type:"Property",name:"comment"}]},"23_6":{service:"msgExtend",cmd:"onDeleteQuickComment",response:[{type:"Property",name:"msg"},{type:"Property",name:"comment"}]},"23_7":{service:"msgExtend",cmd:"getQuickComments",response:[{type:"PropertyArray",name:"commentRes",entity:"commentRes"}]},"23_8":{service:"msgExtend",cmd:"addCollect",response:[{type:"Property",name:"collect"}]},"23_9":{service:"msgExtend",cmd:"deleteCollects",response:[{type:"Number",name:"deleteNum"}]},"23_10":{service:"msgExtend",cmd:"updateCollect",response:[{type:"Property",name:"collect"}]},"23_11":{service:"msgExtend",cmd:"getCollects",response:[{type:"Number",name:"total"},{type:"PropertyArray",name:"collectList",entity:"collect"}]},"23_12":{service:"msgExtend",cmd:"addStickTopSession",response:[{type:"Property",name:"stickTopSession"}]},"23_13":{service:"msgExtend",cmd:"deleteStickTopSession",response:[{type:"Number",name:"timetag"}]},"23_14":{service:"msgExtend",cmd:"updateStickTopSession",response:[{type:"Property",name:"stickTopSession"}]},"23_15":{service:"msgExtend",cmd:"addMsgPin",response:[{type:"Number",name:"timetag"}]},"23_16":{service:"msgExtend",cmd:"updateMsgPin",response:[{type:"Number",name:"timetag"}]},"23_17":{service:"msgExtend",cmd:"deleteMsgPin",response:[{type:"Number",name:"timetag"}]},"23_18":{service:"msgExtend",cmd:"onAddMsgPin",response:[{type:"Property",name:"msg"},{type:"Property",name:"pinTag"},{type:"Number",name:"timetag"}]},"23_19":{service:"msgExtend",cmd:"onUpdateMsgPin",response:[{type:"Property",name:"msg"},{type:"Property",name:"pinTag"},{type:"Number",name:"timetag"}]},"23_20":{service:"msgExtend",cmd:"onDeleteMsgPin",response:[{type:"Property",name:"msg"},{type:"Property",name:"pinTag"},{type:"Number",name:"timetag"}]},"23_21":{service:"msgExtend",cmd:"getMsgPins",response:[{type:"Number",name:"timetag"},{type:"Boolean",name:"modify"},{type:"PropertyArray",name:"pins",entity:"msgPinRes"}]},"23_103":{service:"msgExtend",cmd:"syncAddQuickComment",response:[{type:"Property",name:"msg"},{type:"Property",name:"comment"}]},"23_104":{service:"msgExtend",cmd:"syncDeleteQuickComment",response:[{type:"Property",name:"msg"},{type:"Property",name:"comment"}]},"23_112":{service:"msgExtend",cmd:"syncAddStickTopSession",response:[{type:"Property",name:"stickTopSession"}]},"23_113":{service:"msgExtend",cmd:"syncDeleteStickTopSession",response:[{type:"Number",name:"timetag"},{type:"Property",name:"stickTopSession"}]},"23_114":{service:"msgExtend",cmd:"syncUpdateStickTopSession",response:[{type:"Property",name:"stickTopSession"}]},"23_115":{service:"msgExtend",cmd:"syncAddMsgPin",response:[{type:"Property",name:"msg"},{type:"Property",name:"pinTag"},{type:"Number",name:"timetag"}]},"23_116":{service:"msgExtend",cmd:"syncUpdateMsgPin",response:[{type:"Property",name:"msg"},{type:"Property",name:"pinTag"},{type:"Number",name:"timetag"}]},"23_117":{service:"msgExtend",cmd:"syncDeleteMsgPin",response:[{type:"Property",name:"msg"},{type:"Property",name:"pinTag"},{type:"Number",name:"timetag"}]},"21_2":{service:"superTeam",cmd:"sendSuperTeamMsg",response:[{type:"Property",name:"msg"}]},"21_3":{service:"superTeam",cmd:"superTeamMsg",response:[{type:"Property",name:"msg"}]},"21_5":{service:"superTeam",cmd:"addSuperTeamMembers",response:[{type:"StrArray",name:"abortedAccidList"},{type:"long",name:"timetag"}]},"21_6":{service:"superTeam",cmd:"removeSuperTeamMembers"},"21_7":{service:"superTeam",cmd:"leaveSuperTeam"},"21_8":{service:"superTeam",cmd:"updateSuperTeam",response:[{type:"long",name:"timetag"}]},"21_9":{service:"superTeam",cmd:"getSuperTeam",response:[{type:"Property",name:"team"}]},"21_12":{service:"superTeam",cmd:"getSuperTeams",response:[{type:"PropertyArray",name:"teams",entity:"superTeam"},{type:"bool",name:"isAll"},{type:"long",name:"timetag"}]},"21_10":{service:"superTeam",cmd:"updateInfoInSuperTeam",response:[{type:"Property",name:"superTeamMember"}]},"21_13":{service:"superTeam",cmd:"getSuperTeamMembers",response:[{type:"long",name:"timetag"}]},"21_11":{service:"superTeam",cmd:"getMySuperTeamMembers",response:[{type:"PropertyArray",name:"members",entity:"superTeamMember"}]},"21_14":{service:"superTeam",cmd:"getSuperTeamHistoryMsgs",response:[{type:"PropertyArray",name:"msgs",entity:"msg"}]},"21_15":{service:"superTeam",cmd:"getSuperTeamMembersByJoinTime",response:[{type:"PropertyArray",name:"members",entity:"superTeamMember"}]},"21_16":{service:"superTeam",cmd:"sendSuperTeamCustomSysMsg",trivialErrorCodes:[7101]},"21_17":{service:"superTeam",cmd:"onDeleteSuperTeamMsg"},"21_18":{service:"superTeam",cmd:"onSuperTeamMsgDelete",response:[{type:"Property",name:"sysMsg"}]},"21_19":{service:"superTeam",cmd:"superTeamCustomSysMsg",response:[{type:"Property",name:"sysMsg"}]},"21_20":{service:"superTeam",cmd:"applySuperTeam",response:[{type:"Property",name:"team"}]},"21_21":{service:"superTeam",cmd:"passSuperTeamApply"},"21_22":{service:"superTeam",cmd:"rejectSuperTeamApply"},"21_23":{service:"superTeam",cmd:"acceptSuperTeamInvite",response:[{type:"Property",name:"team"}]},"21_24":{service:"superTeam",cmd:"rejectSuperTeamInvite"},"21_25":{service:"superTeam",cmd:"onMarkSuperTeamSessionAck"},"21_26":{service:"superTeam",cmd:"addSuperTeamManagers"},"21_27":{service:"superTeam",cmd:"removeSuperTeamManagers"},"21_28":{service:"superTeam",cmd:"updateSuperTeamMute"},"21_29":{service:"superTeam",cmd:"updateSuperTeamMembersMute",response:[{type:"long",name:"timetag"}]},"21_30":{service:"superTeam",cmd:"updateNickInSuperTeam"},"21_31":{service:"superTeam",cmd:"transferSuperTeam"},"21_32":{service:"superTeam",cmd:"onMarkSuperTeamSessionsAck"},"21_33":{service:"superTeam",cmd:"getSuperTeamMembersByAccounts",response:[{type:"PropertyArray",name:"members",entity:"superTeamMember"}]},"21_34":{service:"superTeam",cmd:"getMutedSuperTeamMembers",response:[{type:"PropertyArray",name:"members",entity:"superTeamMember"}]},"21_113":{service:"superTeam",cmd:"syncSuperTeamMembers",response:[{type:"Number",name:"teamId"},{type:"PropertyArray",name:"members",entity:"superTeamMember"},{type:"bool",name:"isAll"},{type:"long",name:"timetag"}]},"21_111":{service:"superTeam",cmd:"syncMySuperTeamMembers",response:[{type:"PropertyArray",name:"teamMembers",entity:"superTeamMember"},{type:"long",name:"timetag"}]},"21_109":{service:"superTeam",cmd:"syncSuperTeams",response:[{type:"PropertyArray",name:"teams",entity:"superTeam"},{type:"bool",name:"isAll"},{type:"long",name:"timetag"}]},"21_101":{service:"superTeam",cmd:"syncCreateSuperTeam",response:[{type:"Property",name:"team"}]},"21_102":{service:"superTeam",cmd:"syncSendSuperTeamMsg",response:[{type:"Property",name:"msg"}]},"21_110":{service:"superTeam",cmd:"syncUpdateSuperTeamMember",response:[{type:"Property",name:"teamMember",entity:"superTeamMember"}]},"21_117":{service:"superTeam",cmd:"syncDeleteSuperTeamMsg",response:[{type:"Property",name:"sysMsg"}]},"21_125":{service:"superTeam",cmd:"syncMarkSuperTeamSessionAck",response:[{type:"Long",name:"to"},{type:"Long",name:"timetag"}]},"8_1":{service:"team",cmd:"createTeam",response:[{type:"Property",name:"team"},{type:"StrArray",name:"abortedAccidList"}]},"8_2":{service:"team",cmd:"sendTeamMsg",response:[{type:"Property",name:"msg"}]},"8_3":{service:"team",cmd:"teamMsg",response:[{type:"Property",name:"msg"}]},"8_4":{service:"team",cmd:"teamMsgs",response:[{type:"PropertyArray",name:"msgs",entity:"msg"}]},"8_5":{service:"team",cmd:"addTeamMembers",response:[{type:"long",name:"time"},{type:"StrArray",name:"abortedAccidList"}]},"8_6":{service:"team",cmd:"removeTeamMembers"},"8_7":{service:"team",cmd:"updateTeam",response:[{type:"Number",name:"id"},{type:"Number",name:"time"}]},"8_8":{service:"team",cmd:"leaveTeam"},"8_9":{service:"team",cmd:"getTeam",response:[{type:"Property",name:"team"}]},"8_10":{service:"team",cmd:"getTeams",response:[{type:"PropertyArray",name:"teams",entity:"team"},{type:"Number",name:"timetag"}]},"8_11":{service:"team",cmd:"getTeamMembers",response:[{type:"Number",name:"teamId"},{type:"PropertyArray",name:"members",entity:"teamMember"},{type:"Number",name:"timetag"}]},"8_12":{service:"team",cmd:"dismissTeam"},"8_13":{service:"team",cmd:"applyTeam",response:[{type:"Property",name:"team"}]},"8_14":{service:"team",cmd:"passTeamApply"},"8_15":{service:"team",cmd:"rejectTeamApply"},"8_16":{service:"team",cmd:"addTeamManagers"},"8_17":{service:"team",cmd:"removeTeamManagers"},"8_18":{service:"team",cmd:"transferTeam"},"8_19":{service:"team",cmd:"updateInfoInTeam",response:[{type:"Property",name:"teamMember"}]},"8_20":{service:"team",cmd:"updateNickInTeam"},"8_21":{service:"team",cmd:"acceptTeamInvite",response:[{type:"Property",name:"team"}]},"8_22":{service:"team",cmd:"rejectTeamInvite"},"8_23":{service:"team",cmd:"getTeamHistoryMsgs",response:[{type:"PropertyArray",name:"msgs",entity:"msg"}]},"8_24":{service:"team",cmd:"searchTeamHistoryMsgs",response:[{type:"PropertyArray",name:"msgs",entity:"msg"}]},"8_25":{service:"team",cmd:"updateMuteStateInTeam"},"8_26":{service:"team",cmd:"getMyTeamMembers",response:[{type:"PropertyArray",name:"teamMembers",entity:"teamMember"}]},"8_27":{service:"team",cmd:"getMutedTeamMembers",response:[{type:"Number",name:"teamId"},{type:"PropertyArray",name:"teamMembers",entity:"teamMember"}]},"8_28":{service:"team",cmd:"sendTeamMsgReceipt",response:[{type:"PropertyArray",name:"teamMsgReceipts",entity:"teamMsgReceipt"}]},"8_29":{service:"team",cmd:"getTeamMsgReads",response:[{type:"PropertyArray",name:"teamMsgReceipts",entity:"teamMsgReceipt"}]},"8_30":{service:"team",cmd:"getTeamMsgReadAccounts",response:[{type:"Property",name:"teamMsgReceipt"},{type:"StrArray",name:"readAccounts"},{type:"StrArray",name:"unreadAccounts"}]},"8_31":{service:"team",cmd:"notifyTeamMsgReads",response:[{type:"PropertyArray",name:"teamMsgReceipts",entity:"teamMsgReceipt"}]},"8_32":{service:"team",cmd:"muteTeamAll",response:[]},"8_33":{service:"team",cmd:"getTeamMemberInvitorAccid",response:[{type:"object",name:"accountsMap"}]},"8_34":{service:"team",cmd:"getTeamsById",response:[{type:"PropertyArray",name:"teams",entity:"team"},{type:"StrArray",name:"tids"}],trivialErrorCodes:[816]},"8_126":{service:"team",cmd:"syncMyTeamMembers",response:[{type:"PropertyArray",name:"teamMembers",entity:"teamMember"},{type:"Number",name:"timetag"}]},"8_109":{service:"team",cmd:"syncTeams",response:[{type:"Number",name:"timetag"},{type:"PropertyArray",name:"teams",entity:"team"}]},"8_111":{service:"team",cmd:"syncTeamMembers",response:[{type:"Number",name:"teamId"},{type:"PropertyArray",name:"members",entity:"teamMember"},{type:"Number",name:"timetag"}]},"8_101":{service:"team",cmd:"syncCreateTeam",response:[{type:"Property",name:"team"}]},"8_102":{service:"team",cmd:"syncSendTeamMsg",response:[{type:"Property",name:"msg"}]},"8_119":{service:"team",cmd:"syncUpdateTeamMember",response:[{type:"Property",name:"teamMember"}]},"12_1":{service:"friend",cmd:"friendRequest"},"12_101":{service:"friend",cmd:"syncFriendRequest",response:[{type:"String",name:"account"},{type:"Number",name:"type"},{type:"String",name:"ps"}]},"12_2":{service:"friend",cmd:"deleteFriend"},"12_102":{service:"friend",cmd:"syncDeleteFriend",response:[{type:"String",name:"account"}]},"12_3":{service:"friend",cmd:"updateFriend"},"12_103":{service:"friend",cmd:"syncUpdateFriend",response:[{type:"Property",name:"friend"}]},"12_4":{service:"friend",cmd:"getFriends",response:[{type:"PropertyArray",name:"friends",entity:"friend"},{type:"Number",name:"timetag"}]},"12_5":{service:"friend",cmd:"syncFriends",response:[{type:"PropertyArray",name:"friends",entity:"friend"},{type:"Number",name:"timetag"}]},"12_6":{service:"friend",cmd:"syncFriendUsers",response:[{type:"PropertyArray",name:"users",entity:"user"},{type:"Number",name:"timetag"}]},"13_1":{service:"chatroom",cmd:"getChatroomAddress",response:[{type:"StrArray",name:"address"}]},"14_1":{service:"eventService",cmd:"publishEvent",response:[{type:"Property",name:"msgEvent"}]},"14_2":{service:"eventService",cmd:"pushEvent",response:[{type:"Property",name:"msgEvent"}]},"14_3":{service:"eventService",cmd:"subscribeEvent",response:[{type:"StrArray",name:"accounts"}]},"14_4":{service:"eventService",cmd:"unSubscribeEventsByAccounts",response:[{type:"StrArray",name:"accounts"}]},"14_5":{service:"eventService",cmd:"unSubscribeEventsByType"},"14_6":{service:"eventService",cmd:"querySubscribeEventsByAccounts",response:[{type:"PropertyArray",name:"msgEventSubscribes",entity:"msgEventSubscribe"}]},"14_7":{service:"eventService",cmd:"querySubscribeEventsByType",response:[{type:"PropertyArray",name:"msgEventSubscribes",entity:"msgEventSubscribe"}]},"14_9":{service:"eventService",cmd:"pushEvents",response:[{type:"PropertyArray",name:"msgEvents",entity:"msgEvent"}]},"22_1":{service:"proxyService",cmd:"httpProxy",response:[{type:"Property",name:"proxyTag"}]},"22_2":{service:"proxyService",cmd:"onProxyMsg",response:[{type:"Property",name:"proxyMsg",entity:"proxyMsgTag"}]},"24_1":{service:"qchat",cmd:"getQChatAddress",response:[{type:"StrArray",name:"address"}]},"101_1":{service:"filter",cmd:"sendFilterMsg",response:[{type:"Property",name:"msg"}]},"101_2":{service:"filter",cmd:"filterMsg",response:[{type:"Property",name:"msg"}]},"101_3":{service:"filter",cmd:"filterSysMsg",response:[{type:"Property",name:"sysMsg"}]},"101_7":{service:"filter",cmd:"sendFilterCustomSysMsg"}});t.exports={idMap:o,cmdConfig:a,packetConfig:d}},function(t,n){t.exports={negotiateTransportTag:{version:-1,serializeList:1,serialize:101},initTransportTag:{},nosToken:{objectName:1,token:2,bucket:3,expireTime:4,expireSec:7,tag:8,shortUrl:9},audioToText:{url:2},imageOp:{type:0,stripmeta:1,typeType:2,blurRadius:3,blurSigma:4,qualityQuality:5,cropX:6,cropY:7,cropWidth:8,cropHeight:9,rotateAngle:10,pixelPixel:11,thumbnailMode:12,thumbnailWidth:13,thumbnailHeight:14,thumbnailAxisX:15,thumbnailAxisY:16,thumbnailCenterX:17,thumbnailCenterY:18,thumbnailEnlarge:19,thumbnailToStatic:20,watermarkType:21,watermarkGravity:22,watermarkDissolve:23,watermarkDx:24,watermarkDy:25,watermarkImage:26,watermarkText:27,watermarkFont:28,watermarkFontSize:29,watermarkFontColor:30,interlace:31},robot:{account:4,nick:5,avatar:6,intro:7,config:8,valid:9,createTime:10,updateTime:11,custid:12,botid:13,bindTime:14},clientAntispam:{version:1,md5:2,nosurl:3,thesaurus:4},fileQuickTransfer:{md5:1,url:2,size:3,threshold:4},transToken:{name:1,type:2,transType:3,size:4,extra:5,body:6},transInfo:{docId:1,name:2,prefix:3,size:4,type:5,state:6,transType:7,transSize:8,pageCount:9,picInfo:10,extra:11,flag:12},nosFileUrlTag:{safeUrl:0,originUrl:1},nosAccessTokenTag:{token:0,url:1,userAgent:2,ext:3},fileListParam:{fromDocId:1,limit:2},avSignalTag:{type:1,channelName:2,channelId:3,channelCreateTime:4,channelExpireTime:5,creator:6,ext:7,channelInValid:8,from:10,to:11,requestId:12,needPush:13,pushTitle:14,pushContent:15,pushPayload:16,needBadge:17,members:18,attach:19,attachExt:20,isSave:21,msgid:22,uid:23,time:24,nertcChannelName:25,nertcTokenTtl:26,nertcToken:27,nertcJoinRoomQueryParamMap:28,nertcJoinRoomResponse:29,callStatus:30},login:{clientType:3,os:4,sdkVersion:6,appLogin:8,protocolVersion:9,pushTokenName:10,pushToken:11,deviceId:13,appKey:18,account:19,browser:24,session:26,deviceInfo:32,sdkType:41,userAgent:42,libEnv:44,isReactNative:112,token:1e3,customTag:38,customClientType:39,sdkHumanVersion:40,authType:115,loginExt:116},loginRes:{lastLoginDeviceId:17,customTag:38,connectionId:102,ip:103,port:104,country:106,hasXMPush:111},loginPort:{type:3,os:4,mac:5,deviceId:13,account:19,deviceInfo:32,connectionId:102,ip:103,time:109,customTag:38,customClientType:39},aosPushInfo:{pushType:110,hasTokenPreviously:111},sync:{myInfo:1,offlineMsgs:2,teams:3,netcallMsgs:6,roamingMsgs:7,relations:9,friends:11,sessions:12,friendUsers:13,msgReceipts:14,myTeamMembers:15,donnop:16,deleteMsg:17,sessionAck:18,robots:19,broadcastMsgs:20,avSignal:21,superTeams:22,myInfoInSuperTeams:23,superTeamRoamingMsgs:24,deleteSuperTeamMsg:25,superTeamSessionAck:26,deleteMsgSelf:27,stickTopSessions:28,sessionHistoryMsgsDelete:29,filterMsgs:100},donnop:{open:1},sessionReqTag:{minTimestamp:1,maxTimestamp:2,needLastMsg:3,limit:4,hasMore:5},session:{id:1,updateTime:2,ext:3,lastMsg:4},superTeam:{teamId:1,name:3,type:4,owner:5,level:6,selfCustom:7,valid:8,memberNum:9,memberUpdateTime:10,createTime:11,updateTime:12,validToCurrentUser:13,intro:14,announcement:15,joinMode:16,bits:17,custom:18,serverCustom:19,avatar:20,beInviteMode:21,inviteMode:22,updateTeamMode:23,updateCustomMode:24,mute:100,muteType:101},superTeamMember:{teamId:1,account:3,type:4,nickInTeam:5,bits:7,active:8,valid:9,createTime:10,updateTime:11,custom:12,mute:13,invitoraccid:14,joinTime:15,followAccountIds:17},team:{teamId:1,name:3,type:4,owner:5,level:6,selfCustom:7,valid:8,memberNum:9,memberUpdateTime:10,createTime:11,updateTime:12,validToCurrentUser:13,intro:14,announcement:15,joinMode:16,bits:17,custom:18,serverCustom:19,avatar:20,beInviteMode:21,inviteMode:22,updateTeamMode:23,updateCustomMode:24,mute:100,muteType:101},teamMember:{teamId:1,account:3,type:4,nickInTeam:5,bits:7,active:8,valid:9,joinTime:10,updateTime:11,custom:12,mute:13,invitorAccid:14,followAccountIds:16},teamSpecialFollowUpdateTag:{accountIds:1,type:2},msg:{scene:0,to:1,from:2,fromClientType:4,fromDeviceId:5,fromNick:6,time:7,type:8,body:9,attach:10,idClient:11,idServer:12,resend:13,userUpdateTime:14,custom:15,pushPayload:16,pushContent:17,apnsAccounts:18,apnsContent:19,apnsForcePush:20,yidunEnable:21,antiSpamContent:22,antiSpamBusinessId:23,clientAntiSpam:24,antiSpamUsingYidun:25,needMsgReceipt:26,needUpdateSession:28,replyMsgFromAccount:29,replyMsgToAccount:30,replyMsgTime:31,replyMsgIdServer:32,replyMsgIdClient:33,threadMsgFromAccount:34,threadMsgToAccount:35,threadMsgTime:36,threadMsgIdServer:37,threadMsgIdClient:38,delete:39,callbackExt:40,subType:41,yidunAntiCheating:42,env:43,yidunAntiSpamExt:44,yidunAntiSpamRes:45,__clientExt:46,robotInfoFunction:47,robotInfoTopic:48,robotInfoCustomContent:49,robotInfoAccount:50,isHistoryable:100,isRoamingable:101,isSyncable:102,isMuted:104,cc:105,isInBlackList:106,isPushable:107,isOfflinable:108,isUnreadable:109,needPushNick:110,isReplyMsg:111,tempTeamMemberCount:112},threadMsgReq:{beginTime:1,endTime:2,lastMsgId:3,limit:4,reverse:5},threadMsgsMeta:{total:1,lastMsgTime:2},comment:{from:1,body:2,time:3,custom:4,needPush:5,needBadge:6,pushTitle:7,apnsText:8,pushPayload:9},commentReq:{scene:1,from:2,to:3,time:4,idServer:5,idClient:6,timestamp:100},commentRes:{scene:1,from:2,to:3,time:4,idServer:5,idClient:6,detail:7,modify:8,timestamp:100},collect:{id:1,type:2,data:3,custom:4,uniqueId:5,createTime:6,updateTime:7},collectQuery:{beginTime:1,endTime:2,lastMsgId:3,limit:4,reverse:5,type:6},stickTopSession:{id:1,topCustom:2,createTime:3,updateTime:4},pinTag:{pinFrom:1,pinCustom:2,createTime:3,updateTime:4},msgPinReq:{sessionId:1,timetag:2},msgPinRes:{scene:1,from:2,to:3,time:4,idServer:5,idClient:6,pinFrom:7,pinCustom:8},msgReceipt:{to:1,from:2,time:7,idClient:11},teamMsgReceipt:{teamId:0,idServer:1,read:100,unread:101,idClient:102,account:103},deleteMsgSelfTag:{scene:1,from:2,to:3,idServer:4,idClient:5,time:6,deletedTime:7,custom:8},sysMsg:{time:0,type:1,to:2,from:3,ps:4,attach:5,idServer:6,sendToOnlineUsersOnly:7,apnsText:8,pushPayload:9,deletedIdClient:10,deletedIdServer:11,yidunEnable:12,antiSpamContent:13,deletedMsgTime:14,deletedMsgFromNick:15,opeAccount:16,env:21,idClient:23,callbackExt:22,cc:105,isPushable:107,isUnreadable:109,needPushNick:110},broadcastMsg:{broadcastId:1,fromAccid:2,fromUid:3,timestamp:4,body:5},friend:{account:4,flag:5,beflag:6,source:7,alias:8,bits:9,custom:10,createTime:11,updateTime:12,serverex:13},user:{account:1,nick:3,avatar:4,sign:5,gender:6,email:7,birth:8,tel:9,custom:10,createTime:12,updateTime:13},antispamTag:{antiSpamBusinessId:1},specialRelation:{account:0,isMuted:1,isBlacked:2,createTime:3,updateTime:4},msgType:{text:0,picture:1,audio:2,video:3,location:4,notification:5,file:6,netcall_audio:7,netcall_vedio:8,datatunnel_new:9,tips:10,robot:11,custom:100},msgEvent:{type:1,value:2,idClient:3,custom:4,validTime:5,broadcastType:6,sync:7,validTimeType:8,durable:9,time:10,idServer:11,clientType:12,serverConfig:13,serverCustom:14,appid:101,account:103,enableMultiClient:104,consid:106},msgEventSubscribe:{type:1,subscribeTime:2,sync:3,to:102,from:104,time:105},clearMsgsParams:{account:1,delRoam:2},clearMsgsParamsWithSync:{type:0,otherAccid:1,isDeleteRoam:2,toTid:3,isSyncSelf:4,fromAccid:5,time:6,ext:7},msgFullSearchRequestTag:{keyword:1,fromTime:2,toTime:3,sessionLimit:4,msgLimit:5,order:6,p2pList:7,teamList:8,senderList:9,msgTypeList:10,msgSubTypeList:11},msgTimingFullSearchRequestTag:{keyword:1,fromTime:2,toTime:3,msgLimit:5,order:6,p2pList:7,teamList:8,senderList:9,msgTypeList:10,msgSubTypeList:11},delFriendParams:{delAlias:1},proxyTag:{zone:1,path:2,method:3,header:4,body:5},proxyMsgTag:{from:1,body:2,time:3},sessionAckTag:{scene:1,to:2,timetag:3},mixTokenReq:{provider:0,tokenCount:1,fileExpireSec:2,tag:3,returnBody:4},mixAuthTokenReq:{type:1,urls:2},notifyDetectTag:{type:1,params:2,result:3,t1:100,t2:101,t3:102,t4:103,t5:104,t6:105},getQChatAddressTag:{ipType:1}}},function(t,n){t.exports={negotiateTransportTag:{"-1":"version",1:"serializeList",101:"serialize"},initTransportTag:{},nosToken:{1:"objectName",2:"token",3:"bucket",4:"expireTime",7:"expireSec",8:"tag",9:"shortUrl"},audioToText:{2:"url"},imageOp:{0:"type",1:"stripmeta",2:"typeType",3:"blurRadius",4:"blurSigma",5:"qualityQuality",6:"cropX",7:"cropY",8:"cropWidth",9:"cropHeight",10:"rotateAngle",11:"pixelPixel",12:"thumbnailMode",13:"thumbnailWidth",14:"thumbnailHeight",15:"thumbnailAxisX",16:"thumbnailAxisY",17:"thumbnailCenterX",18:"thumbnailCenterY",19:"thumbnailEnlarge",20:"thumbnailToStatic",21:"watermarkType",22:"watermarkGravity",23:"watermarkDissolve",24:"watermarkDx",25:"watermarkDy",26:"watermarkImage",27:"watermarkText",28:"watermarkFont",29:"watermarkFontSize",30:"watermarkFontColor",31:"interlace"},robot:{4:"account",5:"nick",6:"avatar",7:"intro",8:"config",9:"valid",10:"createTime",11:"updateTime",12:"custid",13:"botid",14:"bindTime",_6_safe:"_avatar_safe"},clientAntispam:{1:"version",2:"md5",3:"nosurl",4:"thesaurus"},fileQuickTransfer:{1:"md5",2:"url",3:"size",4:"threshold",_2_safe:"_url_safe"},transToken:{1:"name",2:"type",3:"transType",4:"size",5:"extra",6:"body"},transInfo:{1:"docId",2:"name",3:"prefix",4:"size",5:"type",6:"state",7:"transType",8:"transSize",9:"pageCount",10:"picInfo",11:"extra",12:"flag"},nosFileUrlTag:{0:"safeUrl",1:"originUrl"},nosAccessTokenTag:{0:"token",1:"url",2:"userAgent",3:"ext"},nosConfigTag:{1:"bucket",2:"cdnDomain",3:"expire",4:"objectNamePrefix"},appGrayConfigTag:{0:"grayConfig",1:"ttl"},mixStorePolicyTag:{0:"providers",1:"ttl",2:"mixEnable",3:"nosPolicy",4:"s3Policy"},mixStoreTokenTag:{0:"provider",1:"accessKeyId",2:"secretAccessKey",3:"sessionToken",4:"token",5:"expireAt",6:"bucket",7:"objectName",8:"fileExpireSec",9:"tag",10:"shortUrl",11:"region"},notifyDetectTag:{1:"type",2:"params",3:"result",100:"t1",101:"t2",102:"t3",103:"t4",104:"t5",105:"t6"},backSourceTokenTag:{1:"type",2:"tokens",3:"token",4:"ttl"},fileListParam:{1:"fromDocId",2:"limit"},avSignalTag:{1:"type",2:"channelName",3:"channelId",4:"channelCreateTime",5:"channelExpireTime",6:"creator",7:"ext",8:"channelInValid",10:"from",11:"to",12:"requestId",13:"needPush",14:"pushTitle",15:"pushContent",16:"pushPayload",17:"needBadge",18:"members",19:"attach",20:"attachExt",21:"isSave",22:"msgid",23:"uid",24:"time",25:"nertcChannelName",26:"nertcTokenTtl",27:"nertcToken",28:"nertcJoinRoomQueryParamMap",29:"nertcJoinRoomResponse",30:"callStatus"},login:{3:"clientType",4:"os",6:"sdkVersion",8:"appLogin",9:"protocolVersion",10:"pushTokenName",11:"pushToken",13:"deviceId",18:"appKey",19:"account",24:"browser",26:"session",32:"deviceInfo",38:"customTag",39:"customClientType",40:"sdkHumanVersion",112:"isReactNative",115:"authType",116:"loginExt",1e3:"token"},loginRes:{17:"lastLoginDeviceId",38:"customTag",102:"connectionId",103:"ip",104:"port",106:"country",111:"hasXMPush"},loginPort:{3:"type",4:"os",5:"mac",13:"deviceId",19:"account",32:"deviceInfo",38:"customTag",39:"customClientType",102:"connectionId",103:"ip",109:"time"},aosPushInfo:{110:"pushType",111:"hasTokenPreviously"},sync:{1:"myInfo",2:"offlineMsgs",3:"teams",6:"netcallMsgs",7:"roamingMsgs",9:"relations",11:"friends",12:"sessions",13:"friendUsers",14:"msgReceipts",15:"myTeamMembers",16:"donnop",17:"deleteMsg",18:"sessionAck",19:"robots",20:"broadcastMsgs",21:"avSignal",22:"superTeams",23:"myInfoInSuperTeams",24:"superTeamRoamingMsgs",25:"deleteSuperTeamMsg",26:"superTeamSessionAck",27:"deleteMsgSelf",28:"stickTopSessions",29:"sessionHistoryMsgsDelete",100:"filterMsgs"},donnop:{1:"open"},sessionReqTag:{1:"minTimestamp",2:"maxTimestamp",3:"needLastMsg",4:"limit",5:"hasMore"},session:{1:"id",2:"updateTime",3:"ext",4:"lastMsg",5:"lastMsgType"},superTeam:{1:"teamId",3:"name",4:"type",5:"owner",6:"level",7:"selfCustom",8:"valid",9:"memberNum",10:"memberUpdateTime",11:"createTime",12:"updateTime",13:"validToCurrentUser",14:"intro",15:"announcement",16:"joinMode",17:"bits",18:"custom",19:"serverCustom",20:"avatar",21:"beInviteMode",22:"inviteMode",23:"updateTeamMode",24:"updateCustomMode",100:"mute",101:"muteType",_20_safe:"_avatar_safe"},superTeamMember:{1:"teamId",3:"account",4:"type",5:"nickInTeam",7:"bits",8:"active",9:"valid",10:"createTime",11:"updateTime",12:"custom",13:"mute",14:"invitoraccid",15:"joinTime",17:"followAccountIds"},team:{1:"teamId",3:"name",4:"type",5:"owner",6:"level",7:"selfCustom",8:"valid",9:"memberNum",10:"memberUpdateTime",11:"createTime",12:"updateTime",13:"validToCurrentUser",14:"intro",15:"announcement",16:"joinMode",17:"bits",18:"custom",19:"serverCustom",20:"avatar",21:"beInviteMode",22:"inviteMode",23:"updateTeamMode",24:"updateCustomMode",100:"mute",101:"muteType",_20_safe:"_avatar_safe"},teamMember:{1:"teamId",3:"account",4:"type",5:"nickInTeam",7:"bits",8:"active",9:"valid",10:"joinTime",11:"updateTime",12:"custom",13:"mute",14:"invitorAccid",16:"followAccountIds"},msg:{0:"scene",1:"to",2:"from",4:"fromClientType",5:"fromDeviceId",6:"fromNick",7:"time",8:"type",9:"body",10:"attach",11:"idClient",12:"idServer",13:"resend",14:"userUpdateTime",15:"custom",16:"pushPayload",17:"pushContent",18:"apnsAccounts",19:"apnsContent",20:"apnsForcePush",21:"yidunEnable",22:"antiSpamContent",23:"antiSpamBusinessId",24:"clientAntiSpam",25:"antiSpamUsingYidun",26:"needMsgReceipt",28:"needUpdateSession",29:"replyMsgFromAccount",30:"replyMsgToAccount",31:"replyMsgTime",32:"replyMsgIdServer",33:"replyMsgIdClient",34:"threadMsgFromAccount",35:"threadMsgToAccount",36:"threadMsgTime",37:"threadMsgIdServer",38:"threadMsgIdClient",39:"delete",40:"callbackExt",41:"subType",42:"yidunAntiCheating",43:"env",44:"yidunAntiSpamExt",45:"yidunAntiSpamRes",46:"__clientExt",47:"robotInfoFunction",48:"robotInfoTopic",49:"robotInfoCustomContent",50:"robotInfoAccount",100:"isHistoryable",101:"isRoamingable",102:"isSyncable",104:"isMuted",105:"cc",106:"isInBlackList",107:"isPushable",108:"isOfflinable",109:"isUnreadable",110:"needPushNick",111:"isReplyMsg",112:"tempTeamMemberCount"},threadMsgReq:{1:"beginTime",2:"endTime",3:"lastMsgId",4:"limit",5:"reverse"},threadMsgsMeta:{1:"total",2:"lastMsgTime"},comment:{1:"from",2:"body",3:"time",4:"custom",5:"needPush",6:"needBadge",7:"pushTitle",8:"apnsText",9:"pushPayload"},commentReq:{1:"scene",2:"from",3:"to",4:"time",5:"idServer",6:"idClient",100:"timestamp"},commentRes:{1:"scene",2:"from",3:"to",4:"time",5:"idServer",6:"idClient",7:"detail",8:"modify",100:"timestamp"},collect:{1:"id",2:"type",3:"data",4:"custom",5:"uniqueId",6:"createTime",7:"updateTime"},collectQuery:{1:"beginTime",2:"endTime",3:"lastMsgId",4:"limit",5:"reverse",6:"type"},stickTopSession:{1:"id",2:"topCustom",3:"createTime",4:"updateTime"},pinTag:{1:"pinFrom",2:"pinCustom",3:"createTime",4:"updateTime"},msgPinReq:{1:"sessionId",2:"timetag"},msgPinRes:{1:"scene",2:"from",3:"to",4:"time",5:"idServer",6:"idClient",7:"pinFrom",8:"pinCustom"},msgReceipt:{1:"to",2:"from",7:"time",11:"idClient"},teamMsgReceipt:{0:"teamId",1:"idServer",100:"read",101:"unread",102:"idClient",103:"account"},deleteMsgSelfTag:{1:"scene",2:"from",3:"to",4:"idServer",5:"idClient",6:"time",7:"deletedTime",8:"custom"},sysMsg:{0:"time",1:"type",2:"to",3:"from",4:"ps",5:"attach",6:"idServer",7:"sendToOnlineUsersOnly",8:"apnsText",9:"pushPayload",10:"deletedIdClient",11:"deletedIdServer",12:"yidunEnable",13:"antiSpamContent",14:"deletedMsgTime",15:"deletedMsgFromNick",16:"opeAccount",21:"env",22:"callbackExt",23:"idClient",105:"cc",107:"isPushable",109:"isUnreadable",110:"needPushNick"},broadcastMsg:{1:"broadcastId",2:"fromAccid",3:"fromUid",4:"timestamp",5:"body"},friend:{4:"account",5:"flag",6:"beflag",7:"source",8:"alias",9:"bits",10:"custom",11:"createTime",12:"updateTime",13:"serverex"},user:{1:"account",3:"nick",4:"avatar",5:"sign",6:"gender",7:"email",8:"birth",9:"tel",10:"custom",12:"createTime",13:"updateTime",_4_safe:"_avatar_safe"},antispamTag:{antiSpamBusinessId:1},specialRelation:{0:"account",1:"isMuted",2:"isBlacked",3:"createTime",4:"updateTime"},msgType:{0:"text",1:"picture",2:"audio",3:"video",4:"location",5:"notification",6:"file",7:"netcall_audio",8:"netcall_vedio",9:"datatunnel_new",10:"tips",11:"robot",100:"custom"},msgEvent:{1:"type",2:"value",3:"idClient",4:"custom",5:"validTime",6:"broadcastType",7:"sync",8:"validTimeType",9:"durable",10:"time",11:"idServer",12:"clientType",13:"serverConfig",14:"serverCustom",101:"appid",103:"account",104:"enableMultiClient",106:"consid"},msgEventSubscribe:{1:"type",2:"subscribeTime",3:"sync",102:"to",104:"from",105:"time"},clearMsgsParams:{1:"account",2:"delRoam"},clearMsgsParamsWithSync:{0:"type",1:"otherAccid",2:"delRoam",3:"toTid",4:"isSyncSelf",5:"fromAccid",6:"time",7:"ext"},msgFullSearchRequestTag:{1:"keyword",2:"fromTime",3:"toTime",4:"sessionLimit",5:"msgLimit",6:"order",7:"p2pList",8:"teamList",9:"senderList",10:"msgTypeList",11:"msgSubTypeList"},delFriendParams:{1:"delAlias"},proxyTag:{1:"zone",2:"path",3:"method",4:"header",5:"body"},proxyMsgTag:{1:"from",2:"body",3:"time"},sessionReliableSyncTag:{1:"scene",2:"sessionId",3:"syncStatus",4:"syncEndMsgId",5:"syncEndMsgidClient",6:"syncEndMsgTime",7:"syncStartMsgid",8:"syncStartMsgidClient",9:"syncStartMsgTime",10:"nextMsgid",11:"nextMsgidClient",12:"nextMsgTime",13:"roamMsgSync",14:"offlineMsgSync",15:"netCallOfflineMsgSync"},sessionReliableSyncContextTag:{1:"timetag",2:"type"}}},function(t,n,e){var r=e(0),s=e(193),i=r.merge({},s.idMap,{chatroom:{id:13,login:2,kicked:3,logout:4,sendMsg:6,msg:7,getChatroomMembers:8,getHistoryMsgs:9,markChatroomMember:11,closeChatroom:12,getChatroom:13,updateChatroom:14,updateMyChatroomMemberInfo:15,getChatroomMembersInfo:16,kickChatroomMember:17,updateChatroomMemberTempMute:19,queueOffer:20,queuePoll:21,queueList:22,peak:23,queueDrop:24,queueInit:25,queueChange:26,updateTagMembersTempMute:30,getChatroomMembersByTag:31,getChatroomMemberCountByTag:32,updateCoordinate:33,updateChatroomTags:34,sendChatroomMsgAck:35,getHistoryMsgsByTags:36,notifyCdnInfo:99},user:{id:3,syncRobot:16}}),o=r.merge({},s.cmdConfig,{login:{sid:i.chatroom.id,cid:i.chatroom.login,params:[{type:"byte",name:"type"},{type:"Property",name:"login"},{type:"Property",name:"imLogin"}]},logout:{sid:i.chatroom.id,cid:i.chatroom.logout},sendMsg:{sid:i.chatroom.id,cid:i.chatroom.sendMsg,params:[{type:"Property",name:"msg"}]},getChatroomMembers:{sid:i.chatroom.id,cid:i.chatroom.getChatroomMembers,params:[{type:"byte",name:"type"},{type:"long",name:"time"},{type:"int",name:"limit"}]},getHistoryMsgs:{sid:i.chatroom.id,cid:i.chatroom.getHistoryMsgs,params:[{type:"long",name:"timetag"},{type:"int",name:"limit"},{type:"bool",name:"reverse"},{type:"LongArray",name:"msgTypes"}]},markChatroomMember:{sid:i.chatroom.id,cid:i.chatroom.markChatroomMember,params:[{type:"string",name:"account"},{type:"int",name:"type"},{type:"bool",name:"isAdd"},{type:"int",name:"level"},{type:"string",name:"custom"}]},closeChatroom:{sid:i.chatroom.id,cid:i.chatroom.closeChatroom,params:[{type:"string",name:"custom"}]},getChatroom:{sid:i.chatroom.id,cid:i.chatroom.getChatroom},updateChatroom:{sid:i.chatroom.id,cid:i.chatroom.updateChatroom,params:[{type:"Property",name:"chatroom"},{type:"bool",name:"needNotify"},{type:"String",name:"custom"},{type:"Property",name:"antispamTag"}]},updateMyChatroomMemberInfo:{sid:i.chatroom.id,cid:i.chatroom.updateMyChatroomMemberInfo,params:[{type:"Property",name:"chatroomMember"},{type:"bool",name:"needNotify"},{type:"String",name:"custom"},{type:"bool",name:"needSave"},{type:"Property",name:"antispamTag"}]},getChatroomMembersInfo:{sid:i.chatroom.id,cid:i.chatroom.getChatroomMembersInfo,params:[{type:"StrArray",name:"accounts"}]},kickChatroomMember:{sid:i.chatroom.id,cid:i.chatroom.kickChatroomMember,params:[{type:"string",name:"account"},{type:"string",name:"custom"}]},updateChatroomMemberTempMute:{sid:i.chatroom.id,cid:i.chatroom.updateChatroomMemberTempMute,params:[{type:"String",name:"account"},{type:"long",name:"duration"},{type:"bool",name:"needNotify"},{type:"String",name:"custom"}]},queueOffer:{sid:i.chatroom.id,cid:i.chatroom.queueOffer,params:[{type:"string",name:"elementKey"},{type:"string",name:"elementValue"},{type:"bool",name:"transient"},{type:"string",name:"elementAccount"}]},queuePoll:{sid:i.chatroom.id,cid:i.chatroom.queuePoll,params:[{type:"string",name:"elementKey"}]},queueList:{sid:i.chatroom.id,cid:i.chatroom.queueList},peak:{sid:i.chatroom.id,cid:i.chatroom.peak},queueDrop:{sid:i.chatroom.id,cid:i.chatroom.queueDrop},queueInit:{sid:i.chatroom.id,cid:i.chatroom.queueInit,params:[{type:"int",name:"limit"}]},queueChange:{sid:i.chatroom.id,cid:i.chatroom.queueChange,params:[{type:"StrStrMap",name:"elementMap"},{type:"bool",name:"needNotify"},{type:"string",name:"notifyExt"}]},updateTagMembersTempMute:{sid:i.chatroom.id,cid:i.chatroom.updateTagMembersTempMute,params:[{type:"Property",name:"tagMuteReq"}]},updateCoordinate:{sid:i.chatroom.id,cid:i.chatroom.updateCoordinate,params:[{type:"Property",name:"coordinateReq"}]},getChatroomMemberCountByTag:{sid:i.chatroom.id,cid:i.chatroom.getChatroomMemberCountByTag,params:[{type:"String",name:"tag"}]},getChatroomMembersByTag:{sid:i.chatroom.id,cid:i.chatroom.getChatroomMembersByTag,params:[{type:"Property",name:"tagMemberReq"}]},updateChatroomTags:{sid:i.chatroom.id,cid:i.chatroom.updateChatroomTags,params:[{type:"Property",name:"chatRoomTagsUpdateTag"}]},sendChatroomMsgAck:{sid:i.chatroom.id,cid:i.chatroom.sendChatroomMsgAck,params:[{type:"Property",name:"chatRoomMsgAckTag"}]},getHistoryMsgsByTags:{sid:i.chatroom.id,cid:i.chatroom.getHistoryMsgsByTags,params:[{type:"Property",name:"chatRoomTagHistoryMsgRequestTag"}]},notifyCdnInfo:{sid:i.chatroom.id,cid:i.chatroom.notifyCdnInfo},syncRobot:{sid:i.user.id,cid:i.user.syncRobot,params:[{type:"long",name:"timetag"}]}}),a=r.merge({},s.packetConfig,{"4_10":{service:"notify"},"4_11":{service:"notify"},"3_16":{service:"chatroom",cmd:"syncRobot",response:[{type:"PropertyArray",name:"robots",entity:"robot"}]},"13_2":{service:"chatroom",cmd:"login",response:[{type:"Property",name:"chatroom"},{type:"Property",name:"chatroomMember"},{type:"Property",name:"chatroomCdnInfo"}]},"13_3":{service:"chatroom",cmd:"kicked",response:[{type:"Number",name:"reason"},{type:"String",name:"custom"}]},"13_4":{service:"chatroom",cmd:"logout"},"13_6":{service:"chatroom",cmd:"sendMsg",response:[{type:"Property",name:"msg"}]},"13_7":{service:"chatroom",cmd:"msg",response:[{type:"Property",name:"msg"}]},"13_8":{service:"chatroom",cmd:"getChatroomMembers",response:[{type:"PropertyArray",name:"members",entity:"chatroomMember"}]},"13_9":{service:"chatroom",cmd:"getHistoryMsgs",response:[{type:"PropertyArray",name:"msgs",entity:"msg"}]},"13_11":{service:"chatroom",cmd:"markChatroomMember",response:[{type:"Property",name:"chatroomMember"}]},"13_12":{service:"chatroom",cmd:"closeChatroom"},"13_13":{service:"chatroom",cmd:"getChatroom",response:[{type:"Property",name:"chatroom"}]},"13_14":{service:"chatroom",cmd:"updateChatroom"},"13_15":{service:"chatroom",cmd:"updateMyChatroomMemberInfo"},"13_16":{service:"chatroom",cmd:"getChatroomMembersInfo",response:[{type:"PropertyArray",name:"members",entity:"chatroomMember"}]},"13_17":{service:"chatroom",cmd:"kickChatroomMember"},"13_19":{service:"chatroom",cmd:"updateChatroomMemberTempMute"},"13_20":{service:"chatroom",cmd:"queueOffer"},"13_21":{service:"chatroom",cmd:"queuePoll",response:[{type:"String",name:"elementKey"},{type:"String",name:"elementValue"}]},"13_22":{service:"chatroom",cmd:"queueList",response:[{type:"KVArray",name:"queueList"}]},"13_23":{service:"chatroom",cmd:"peak",response:[{type:"String",name:"elementKey"},{type:"String",name:"elementValue"}]},"13_24":{service:"chatroom",cmd:"queueDrop"},"13_25":{service:"chatroom",cmd:"queueInit"},"13_26":{service:"chatroom",cmd:"queueChange",response:[{type:"StrArray",name:"elementKeyArray"}]},"13_30":{service:"chatroom",cmd:"updateTagMembersTempMute"},"13_33":{service:"chatroom",cmd:"updateCoordinate"},"13_31":{service:"chatroom",cmd:"getChatroomMembersByTag",response:[{type:"PropertyArray",name:"members",entity:"chatroomMember"}]},"13_32":{service:"chatroom",cmd:"getChatroomMemberCountByTag",response:[{type:"long",name:"count"}]},"13_34":{service:"chatroom",cmd:"updateChatroomTags"},"13_36":{service:"chatroom",cmd:"getHistoryMsgsByTags",response:[{type:"PropertyArray",name:"msgs",entity:"msg"}]},"13_99":{service:"chatroom",cmd:"notifyCdnInfo",response:[{type:"Property",name:"chatroomCdnInfo"}]},"13_101":{service:"chatroom",cmd:"updateChatroomTag",response:[{type:"Property",name:"updateTags"}]}});t.exports={idMap:i,cmdConfig:o,packetConfig:a}},function(t,n){t.exports={imLogin:{clientType:3,os:4,sdkVersion:6,appLogin:8,protocolVersion:9,pushTokenName:10,pushToken:11,deviceId:13,appKey:18,account:19,browser:24,session:26,deviceInfo:32,sdkType:41,userAgent:42,libEnv:44,isReactNative:112,authType:115,loginExt:116,token:1e3,customTag:38},nosToken:{objectName:1,token:2,bucket:3,expireTime:4,expireSec:7,tag:8,shortUrl:9},audioToText:{url:2},imageOp:{type:0,stripmeta:1,typeType:2,blurRadius:3,blurSigma:4,qualityQuality:5,cropX:6,cropY:7,cropWidth:8,cropHeight:9,rotateAngle:10,pixelPixel:11,thumbnailMode:12,thumbnailWidth:13,thumbnailHeight:14,thumbnailAxisX:15,thumbnailAxisY:16,thumbnailCenterX:17,thumbnailCenterY:18,thumbnailEnlarge:19,thumbnailToStatic:20,watermarkType:21,watermarkGravity:22,watermarkDissolve:23,watermarkDx:24,watermarkDy:25,watermarkImage:26,watermarkText:27,watermarkFont:28,watermarkFontSize:29,watermarkFontColor:30,interlace:31},robot:{account:4,nick:5,avatar:6,intro:7,config:8,valid:9,createTime:10,updateTime:11,custid:12,botid:13,bindTime:14},clientAntispam:{version:1,md5:2,nosurl:3,thesaurus:4},fileQuickTransfer:{md5:1,url:2,size:3,threshold:4},transToken:{name:1,type:2,transType:3,size:4,extra:5,body:6},transInfo:{docId:1,name:2,prefix:3,size:4,type:5,state:6,transType:7,transSize:8,pageCount:9,picInfo:10,extra:11,flag:12},nosFileUrlTag:{safeUrl:0,originUrl:1},nosAccessTokenTag:{token:0,url:1,userAgent:2,ext:3},fileListParam:{fromDocId:1,limit:2},avSignalTag:{type:1,channelName:2,channelId:3,channelCreateTime:4,channelExpireTime:5,creator:6,ext:7,channelInValid:8,from:10,to:11,requestId:12,needPush:13,pushTitle:14,pushContent:15,pushPayload:16,needBadge:17,members:18,attach:19,attachExt:20,isSave:21,msgid:22,uid:23,time:24,nertcChannelName:25,nertcTokenTtl:26,nertcToken:27,nertcJoinRoomQueryParamMap:28,nertcJoinRoomResponse:29,callStatus:30},login:{appKey:1,account:2,deviceId:3,chatroomId:5,appLogin:8,chatroomNick:20,chatroomAvatar:21,chatroomCustom:22,chatroomEnterCustom:23,session:26,isAnonymous:38,tags:39,notifyTargetTags:40,loginAuthType:41,loginExt:42,loc_x:43,loc_y:44,loc_z:45,distance:46,antiSpamBusinessId:47},chatroom:{id:1,name:3,announcement:4,broadcastUrl:5,custom:12,createTime:14,updateTime:15,queuelevel:16,creator:100,onlineMemberNum:101,mute:102},msg:{idClient:1,type:2,attach:3,custom:4,resend:5,userUpdateTime:6,fromNick:7,fromAvatar:8,fromCustom:9,yidunEnable:10,antiSpamContent:11,skipHistory:12,body:13,antiSpamBusinessId:14,clientAntiSpam:15,antiSpamUsingYidun:16,time:20,from:21,chatroomId:22,fromClientType:23,highPriority:25,callbackExt:27,subType:28,yidunAntiCheating:29,env:30,notifyTargetTags:31,yidunAntiSpamExt:32,yidunAntiSpamRes:33,loc_x:34,loc_y:35,loc_z:36,toAccids:37,needHighPriorityMsgAck:38,__clientExt:39},chatroomMember:{chatroomId:1,account:2,type:3,level:4,nick:5,avatar:6,custom:7,online:8,guest:9,enterTime:10,blacked:12,gaged:13,valid:14,updateTime:15,tempMuted:16,tempMuteDuration:17},antispamTag:{antiSpamBusinessId:1},chatroomCdnInfo:{enable:1,cdnUrls:2,timestamp:3,interval:4,decryptType:5,decryptKey:6,timeout:7},tagMemberReq:{tag:1,time:2,limit:3},tagMuteReq:{tag:1,duration:2,needNotify:3,custom:4,notifyTargetTags:5},coordinateReq:{x:1,y:2,z:3,distance:4},chatRoomTagsUpdateTag:{tags:1,notifyTargetTags:2,needNotify:3,ext:4},chatRoomMsgAckTag:{idClient:1,chatroomId:2},chatRoomTagHistoryMsgRequestTag:{tags:1,types:2,fromTime:3,toTime:4,limit:5,reverse:6}}},function(t,n){t.exports={imLogin:{3:"clientType",4:"os",6:"sdkVersion",8:"appLogin",9:"protocolVersion",10:"pushTokenName",11:"pushToken",13:"deviceId",18:"appKey",19:"account",24:"browser",26:"session",32:"deviceInfo",38:"customTag",41:"sdkType",42:"userAgent",44:"libEnv",112:"isReactNative",1e3:"token"},nosToken:{1:"objectName",2:"token",3:"bucket",4:"expireTime",7:"expireSec",8:"tag",9:"shortUrl"},audioToText:{2:"url"},imageOp:{0:"type",1:"stripmeta",2:"typeType",3:"blurRadius",4:"blurSigma",5:"qualityQuality",6:"cropX",7:"cropY",8:"cropWidth",9:"cropHeight",10:"rotateAngle",11:"pixelPixel",12:"thumbnailMode",13:"thumbnailWidth",14:"thumbnailHeight",15:"thumbnailAxisX",16:"thumbnailAxisY",17:"thumbnailCenterX",18:"thumbnailCenterY",19:"thumbnailEnlarge",20:"thumbnailToStatic",21:"watermarkType",22:"watermarkGravity",23:"watermarkDissolve",24:"watermarkDx",25:"watermarkDy",26:"watermarkImage",27:"watermarkText",28:"watermarkFont",29:"watermarkFontSize",30:"watermarkFontColor",31:"interlace"},robot:{4:"account",5:"nick",6:"avatar",7:"intro",8:"config",9:"valid",10:"createTime",11:"updateTime",12:"custid",13:"botid",14:"bindTime",_6_safe:"_avatar_safe"},clientAntispam:{1:"version",2:"md5",3:"nosurl",4:"thesaurus"},fileQuickTransfer:{1:"md5",2:"url",3:"size",4:"threshold",_2_safe:"_url_safe"},transToken:{1:"name",2:"type",3:"transType",4:"size",5:"extra",6:"body"},transInfo:{1:"docId",2:"name",3:"prefix",4:"size",5:"type",6:"state",7:"transType",8:"transSize",9:"pageCount",10:"picInfo",11:"extra",12:"flag"},nosFileUrlTag:{0:"safeUrl",1:"originUrl"},nosAccessTokenTag:{0:"token",1:"url",2:"userAgent",3:"ext"},fileListParam:{1:"fromDocId",2:"limit"},avSignalTag:{1:"type",2:"channelName",3:"channelId",4:"channelCreateTime",5:"channelExpireTime",6:"creator",7:"ext",8:"channelInValid",10:"from",11:"to",12:"requestId",13:"needPush",14:"pushTitle",15:"pushContent",16:"pushPayload",17:"needBadge",18:"members",19:"attach",20:"attachExt",21:"isSave",22:"msgid",23:"uid",24:"time",25:"nertcChannelName",26:"nertcTokenTtl",27:"nertcToken",28:"nertcJoinRoomQueryParamMap",29:"nertcJoinRoomResponse",30:"callStatus"},login:{1:"appKey",2:"account",3:"deviceId",5:"chatroomId",8:"appLogin",20:"chatroomNick",21:"chatroomAvatar",22:"chatroomCustom",23:"chatroomEnterCustom",26:"session",38:"isAnonymous",39:"tags",40:"notifyTargetTags",41:"loginAuthType",42:"loginExt",43:"loc_x",44:"loc_y",45:"loc_z",46:"distance",47:"antiSpamBusinessId",_21_safe:"_chatroomAvatar_safe"},chatroom:{1:"id",3:"name",4:"announcement",5:"broadcastUrl",12:"custom",14:"createTime",15:"updateTime",16:"queuelevel",100:"creator",101:"onlineMemberNum",102:"mute"},msg:{1:"idClient",2:"type",3:"attach",4:"custom",5:"resend",6:"userUpdateTime",7:"fromNick",8:"fromAvatar",9:"fromCustom",10:"yidunEnable",11:"antiSpamContent",12:"skipHistory",13:"body",14:"antiSpamBusinessId",15:"clientAntiSpam",16:"antiSpamUsingYidun",20:"time",21:"from",22:"chatroomId",23:"fromClientType",25:"highPriority",27:"callbackExt",28:"subType",29:"yidunAntiCheating",30:"env",31:"notifyTargetTags",32:"yidunAntiSpamExt",33:"yidunAntiSpamRes",34:"loc_x",35:"loc_y",36:"loc_z",37:"toAccids",38:"needHighPriorityMsgAck",39:"__clientExt",_8_safe:"_fromAvatar_safe"},chatroomMember:{1:"chatroomId",2:"account",3:"type",4:"level",5:"nick",6:"avatar",7:"custom",8:"online",9:"guest",10:"enterTime",12:"blacked",13:"gaged",14:"valid",15:"updateTime",16:"tempMuted",17:"tempMuteDuration",_6_safe:"_avatar_safe"},antispamTag:{antiSpamBusinessId:1},chatroomCdnInfo:{1:"enable",2:"cdnUrls",3:"timestamp",4:"interval",5:"decryptType",6:"decryptKey",7:"timeout"},nosConfigTag:{1:"bucket",2:"cdnDomain",3:"expire",4:"objectNamePrefix"},updateTags:{1:"currentTags"}}},function(t,n,e){t.exports=e(791)},function(t,n){t.exports=function(e,r){(r==null||r>e.length)&&(r=e.length);for(var s=0,i=new Array(r);s<r;s++)i[s]=e[s];return i},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,n,e){t.exports=e(795)},function(t,n,e){var r=e(309),s=e(752),i=e(751);t.exports=function(o,a){var d;if(o){if(typeof o=="string")return i(o,a);var c=r(d=Object.prototype.toString.call(o)).call(d,8,-1);return c==="Object"&&o.constructor&&(c=o.constructor.name),c==="Map"||c==="Set"?s(o):c==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c)?i(o,a):void 0}},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,n,e){t.exports=e(799)},function(t,n,e){var r=e(4),s=e(37),i=e(0),o=i.notundef,a={addFriend:1,applyFriend:2,passFriendApply:3,rejectFriendApply:4},d={1:"addFriend",2:"applyFriend",3:"passFriendApply",4:"rejectFriendApply"};function c(u){i.verifyOptions(u,"account","friend::Friend"),i.verifyParamAtLeastPresentOne(u,"alias custom","friend::Friend"),this.account=u.account,o(u.alias)&&(this.alias=u.alias),o(u.custom)&&(this.custom=u.custom)}c.reverse=function(u){var m=i.filterObj(u,"account alias custom createTime updateTime serverex");return o(u.flag)&&(m.valid=u.flag==="1"),o(m.createTime)&&(m.createTime=+m.createTime),o(m.updateTime)&&(m.updateTime=+m.updateTime),m},c.validTypes=function(){return r(a)},c.getByteFromType=function(u){return a[u]},c.getTypeFromByte=function(u){return d[u]},c.assembleFriend=function(u){var m=+new Date;return s({},u,{alias:"",createTime:m,custom:"",updateTime:m,valid:!0})},t.exports=c},function(t,n,e){var r=e(757),s=e(37),i=e(0),o=i.notundef;function a(d,c){r(d.body)||i.onParamError("body只能是整数",c),this.body=d.body,this.from=d.from||"",this.custom=d.custom||"",o(d.pushTitle)&&(this.pushTitle=d.pushTitle),o(d.apnsText)&&(this.apnsText=d.apnsText),o(d.pushPayload)&&(this.pushPayload=d.pushPayload),o(d.needPush)&&(this.needPush=d.needPush===!0?1:0),o(d.needBadge)&&(this.needBadge=d.needBadge===!0?1:0)}a.reverse=function(d){var c=s({},d);return o(d.needBadge)&&(c.needBadge=+d.needBadge==1),o(d.needPush)&&(c.needPush=+d.needPush==1),c.body=+d.body,c.time=+d.time,c},t.exports=a},function(t,n,e){t.exports=e(817)},function(t,n,e){var r=e(757),s=e(37),i=e(0);function o(a,d){r(a.type)||i.onParamError("Collect.type只能是整数",d),i.notundef(a.uniqueId)&&(this.uniqueId=a.uniqueId),this.type=a.type,this.data=a.data||"",this.custom=a.custom||""}o.reverse=function(a){var d=s({},a);return d.type=+d.type,d.createTime=+d.createTime,d.updateTime=+d.updateTime,d},t.exports=o},function(t,n,e){var r=e(825),s=e(826),i=e(753),o=e(827);t.exports=function(a,d){return r(a)||s(a,d)||i(a,d)||o()},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,n,e){var r=e(761),s=e(762),i=e(763),o=e(764);function a(u,m,y){var S=u;return s(m)?(y=m,typeof u=="string"&&(S={uri:u})):S=o(m,{uri:u}),S.callback=y,S}function d(u,m,y){return c(m=a(u,m,y))}function c(u){if(u.callback===void 0)throw new Error("callback argument missing");var m=!1,y=function(Ve,Ce,Ue){m||(m=!0,u.callback(Ve,Ce,Ue))};function S(){var Ve=void 0;if(Ve=ue.response?ue.response:ue.responseText||function(Ce){try{if(Ce.responseType==="document")return Ce.responseXML;var Ue=Ce.responseXML&&Ce.responseXML.documentElement.nodeName==="parsererror";if(Ce.responseType===""&&!Ue)return Ce.responseXML}catch{}return null}(ue),ie)try{Ve=JSON.parse(Ve)}catch{}return Ve}function O(Ve){return clearTimeout(L),Ve instanceof Error||(Ve=new Error(""+(Ve||"Unknown XMLHttpRequest Error"))),Ve.statusCode=0,y(Ve,Ne)}function k(){if(!v){var Ve;clearTimeout(L),Ve=u.useXDR&&ue.status===void 0?200:ue.status===1223?204:ue.status;var Ce=Ne,Ue=null;return Ve!==0?(Ce={body:S(),statusCode:Ve,method:le,headers:{},url:re,rawRequest:ue},ue.getAllResponseHeaders&&(Ce.headers=i(ue.getAllResponseHeaders()))):Ue=new Error("Internal XMLHttpRequest Error"),y(Ue,Ce,Ce.body)}}var g,v,ue=u.xhr||null;ue||(ue=u.cors||u.useXDR?new d.XDomainRequest:new d.XMLHttpRequest);var L,re=ue.url=u.uri||u.url,le=ue.method=u.method||"GET",oe=u.body||u.data,he=ue.headers=u.headers||{},Ie=!!u.sync,ie=!1,Ne={body:void 0,headers:{},statusCode:0,method:le,url:re,rawRequest:ue};if("json"in u&&u.json!==!1&&(ie=!0,he.accept||he.Accept||(he.Accept="application/json"),le!=="GET"&&le!=="HEAD"&&(he["content-type"]||he["Content-Type"]||(he["Content-Type"]="application/json"),oe=JSON.stringify(u.json===!0?oe:u.json))),ue.onreadystatechange=function(){ue.readyState===4&&setTimeout(k,0)},ue.onload=k,ue.onerror=O,ue.onprogress=function(){},ue.onabort=function(){v=!0},ue.ontimeout=O,ue.open(le,re,!Ie,u.username,u.password),Ie||(ue.withCredentials=!!u.withCredentials),!Ie&&u.timeout>0&&(L=setTimeout(function(){if(!v){v=!0,ue.abort("timeout");var Ve=new Error("XMLHttpRequest timeout");Ve.code="ETIMEDOUT",O(Ve)}},u.timeout)),ue.setRequestHeader)for(g in he)he.hasOwnProperty(g)&&ue.setRequestHeader(g,he[g]);else if(u.headers&&!function(Ve){for(var Ce in Ve)if(Ve.hasOwnProperty(Ce))return!1;return!0}(u.headers))throw new Error("Headers cannot be set on an XDomainRequest object");return"responseType"in u&&(ue.responseType=u.responseType),"beforeSend"in u&&typeof u.beforeSend=="function"&&u.beforeSend(ue),ue.send(oe||null),ue}t.exports=d,t.exports.default=d,d.XMLHttpRequest=r.XMLHttpRequest||function(){},d.XDomainRequest="withCredentials"in new d.XMLHttpRequest?d.XMLHttpRequest:r.XDomainRequest,function(u,m){for(var y=0;y<u.length;y++)m(u[y])}(["get","put","post","patch","head","delete"],function(u){d[u==="delete"?"del":u]=function(m,y,S){return(y=a(m,y,S)).method=u.toUpperCase(),c(y)}})},function(t,n,e){(function(r){var s;s=typeof window<"u"?window:r!==void 0?r:typeof self<"u"?self:{},t.exports=s}).call(this,e(73))},function(t,n){t.exports=function(r){if(!r)return!1;var s=e.call(r);return s==="[object Function]"||typeof r=="function"&&s!=="[object RegExp]"||typeof window<"u"&&(r===window.setTimeout||r===window.alert||r===window.confirm||r===window.prompt)};var e=Object.prototype.toString},function(t,n){var e=function(r){return r.replace(/^\s+|\s+$/g,"")};t.exports=function(r){if(!r)return{};for(var s,i={},o=e(r).split(`
`),a=0;a<o.length;a++){var d=o[a],c=d.indexOf(":"),u=e(d.slice(0,c)).toLowerCase(),m=e(d.slice(c+1));i[u]===void 0?i[u]=m:(s=i[u],Object.prototype.toString.call(s)==="[object Array]"?i[u].push(m):i[u]=[i[u],m])}return i}},function(t,n){t.exports=function(){for(var r={},s=0;s<arguments.length;s++){var i=arguments[s];for(var o in i)e.call(i,o)&&(r[o]=i[o])}return r};var e=Object.prototype.hasOwnProperty},function(t,n,e){var r=e(22),s=e(126),i=e(6),o=e(8);function a(d){var c=this,u=d.url||null;c.level={debug:0,log:1,info:2,warn:3,error:4}[d.level]||0,c.logCache=[],c.logNum=1,c.timeInterval=5e3,window.onerror=function(m,y,S,O,k){c.error(k)},s(function(){c.logCache.length>0&&u&&c.postLogs(u,c.logCache)},c.timeInterval)}a.prototype.debug=function(){var d;this.level>0||(console.debug.apply(this,arguments),this.cacheLogs.apply(this,i(d=["[degbug]"]).call(d,arguments)))},a.prototype.log=function(){var d;this.level>1||(console.log.apply(this,arguments),this.cacheLogs.apply(this,i(d=["[log]"]).call(d,arguments)))},a.prototype.info=function(){var d;this.level>2||(console.info.apply(this,arguments),this.cacheLogs.apply(this,i(d=["[info]"]).call(d,arguments)))},a.prototype.warn=function(){var d;this.level>3||(console.warn.apply(this,arguments),this.cacheLogs.apply(this,i(d=["[warn]"]).call(d,arguments)))},a.prototype.error=function(){var d;this.level>4||(console.error.apply(this,arguments),this.cacheLogs.apply(this,i(d=["[error]"]).call(d,arguments)))},a.prototype.cacheLogs=function(d,c){for(var u=[],m=0;m<c.length;m++){var y=c[m];r(y)==="object"?u.push(o(y)):u.push(y)}var S=this.logNum+++" "+d+" "+u.join("; ");this.logCache.push(S.replace("%c",""))},a.prototype.postLogs=function(d,c){var u=this,m=new XMLHttpRequest;m.onreadystatechange=function(){m.readyState===4&&(m.status===200?(console.info("LoggerPlugin::日志上报完成"),u.logCache=[],u.timeInterval=5e3):u.timeInterval+=5e3)},m.open("POST",d),m.setRequestHeader("Content-Type","plain/text;charset=utf-8"),m.timeout=360,m.send(c.join(`
`))},t.exports=a},function(t,n,e){var r=e(3),s=e(45);t.exports=function(i){var o,a,d,c;i.db&&(s.db=i.db),i.rnfs&&(s.rnfs=i.rnfs,s.rnfs.size||(s.rnfs.size=1048576),s.rnfs.nimPromise=(o=s.rnfs,a=o.size/2-256,c=0,d=s.rnfs.DocumentDirectoryPath+"/nimlog_"+c+".log",o.exists(d).then(function(u){return u?o.stat(d):r.reject(0)}).then(function(u){return u&&u.size>a?r.reject(1):r.reject(0)}).catch(function(u){return typeof u=="number"&&(o.nimIndex=u),r.resolve()})))}},function(t,n,e){var r=e(48),s=e(0),i=s.notundef,o=s.undef;function a(d){i(d.name)&&(this.name=""+d.name),i(d.announcement)&&(this.announcement=""+d.announcement),i(d.broadcastUrl)&&(this.broadcastUrl=""+d.broadcastUrl),i(d.custom)&&(this.custom=""+d.custom),i(d.queuelevel)&&(this.queuelevel=r(d.queuelevel))}a.reverse=function(d){var c=s.copy(d);return o(c.announcement)&&(c.announcement=""),o(c.broadcastUrl)&&(c.broadcastUrl=""),o(c.custom)&&(c.custom=""),i(c.createTime)&&(c.createTime=+c.createTime),i(c.updateTime)&&(c.updateTime=+c.updateTime),i(c.onlineMemberNum)&&(c.onlineMemberNum=+c.onlineMemberNum),i(c.mute)&&(c.mute=c.mute==="1"),c},t.exports=a},function(t,n,e){var r,s,i;t.exports=(i=e(94),s=(r=i).lib.WordArray,r.enc.Base64={stringify:function(o){var a=o.words,d=o.sigBytes,c=this._map;o.clamp();for(var u=[],m=0;m<d;m+=3)for(var y=(a[m>>>2]>>>24-m%4*8&255)<<16|(a[m+1>>>2]>>>24-(m+1)%4*8&255)<<8|a[m+2>>>2]>>>24-(m+2)%4*8&255,S=0;S<4&&m+.75*S<d;S++)u.push(c.charAt(y>>>6*(3-S)&63));var O=c.charAt(64);if(O)for(;u.length%4;)u.push(O);return u.join("")},parse:function(o){var a=o.length,d=this._map,c=this._reverseMap;if(!c){c=this._reverseMap=[];for(var u=0;u<d.length;u++)c[d.charCodeAt(u)]=u}var m=d.charAt(64);if(m){var y=o.indexOf(m);y!==-1&&(a=y)}return function(S,O,k){for(var g=[],v=0,ue=0;ue<O;ue++)if(ue%4){var L=k[S.charCodeAt(ue-1)]<<ue%4*2,re=k[S.charCodeAt(ue)]>>>6-ue%4*2,le=L|re;g[v>>>2]|=le<<24-v%4*8,v++}return s.create(g,v)}(o,a,c)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="},i.enc.Base64)},function(t,n,e){var r,s,i,o,a,d,c,u;t.exports=(u=e(94),e(894),e(895),s=(r=u).lib,i=s.Base,o=s.WordArray,a=r.algo,d=a.MD5,c=a.EvpKDF=i.extend({cfg:i.extend({keySize:4,hasher:d,iterations:1}),init:function(m){this.cfg=this.cfg.extend(m)},compute:function(m,y){for(var S,O=this.cfg,k=O.hasher.create(),g=o.create(),v=g.words,ue=O.keySize,L=O.iterations;v.length<ue;){S&&k.update(S),S=k.update(m).finalize(y),k.reset();for(var re=1;re<L;re++)S=k.finalize(S),k.reset();g.concat(S)}return g.sigBytes=4*ue,g}}),r.EvpKDF=function(m,y,S){return c.create(S).compute(m,y)},u.EvpKDF)},function(t,n,e){e(299);var r=e(40);e(311)(r),t.exports=r},function(t,n,e){var r=e(48),s=e(3),i=e(15),o=e(8),a=e(2),d=e(6),c=e(306),u=e(9),m=e(16),y=e(64),S=e(200),O=e(304),k=e(772),g=e(0),v=e(307),ue=e(41),L=ue.newSupportDBError,re=ue.noDBError,le=!1;function oe(ie){le=ie,v.set("db",ie,O)}if(oe(!!g.getGlobal().indexedDB),y.name==="IE"&&oe(!1),y.name==="Microsoft Edge"&&oe(!1),y.name==="Safari")try{r(y.version.split(".")[0],10)<10&&oe(!1)}catch{}function he(ie){this.concurrency=0,this.pendingTasks=[],this.queue=s.resolve(),this.logger=ie.logger,this.reporter=ie.reporter,this.core=ie.core,this.account=ie.account,this.notifyError=ie.notifyError}var Ie=he.prototype;Ie.reset=g.emptyFunc,le&&(Ie.reset=function(ie){this.enable=ie!==!1}),Ie.addTask=function(ie){var Ne=this;return new s(function(Ve,Ce){function Ue(qe){Ne.concurrency--;var Oe=Ne.pendingTasks.shift();Oe&&Ne.addTask(Oe),qe()}if(Ne.concurrency<100)return Ne.concurrency++,ie().then(function(qe){Ue(function(){Ve(qe),ie.resolve&&ie.resolve(qe)})},function(qe){Ue(function(){var Oe=(qe=qe||{}).event||qe,$e={event:Oe,callFunc:qe.callFunc||"db::addTask"};Ne.logger.error("db::error event is",Oe,g.get(Oe,"target.error")),Ce($e),ie.reject&&ie.reject($e)})});ie.resolve||(ie.resolve=Ve,ie.reject=Ce),Ne.pendingTasks.push(ie)})},Ie.reportError=function(ie){var Ne=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},Ve=arguments.length>2?arguments[2]:void 0;this.reporter.reportTraceStart("exceptions",{user_id:this.account,trace_id:g.get(this.core,"socket.socket.sessionid"),action:4,exception_service:0});var Ce,Ue=Ne.context||"";if(Ve)try{var qe;Ce=i(qe=o(Ve)).call(qe,0,100),Ue+=". ".concat(Ce)}catch{Ce=""}var Oe=g.get(ie,"code")||g.get(ie,"target.error.code")||0,$e=g.get(ie,"message")||g.get(ie,"target.error.message")||"unknown";this.reporter.reportTraceUpdateV2("exceptions",{code:Oe,description:$e,operation_type:Ne.operation_type,target:Ne.target||this.name,context:Ue}),this.reporter.reportTraceEnd("exceptions",1)},Ie.init=function(ie){var Ne=this;return Ne.addTask(function(){return Ne.enable?Ne.server?s.resolve():(Ne.name="nim-"+ie,O.open({server:Ne.name,version:k.version,schema:k.schema}).then(function(Ve){Ne.logger.info("db::init: ".concat(Ne.name)),Ne.server=Ve},function(Ve){throw oe(!1),Ne.server=null,Ne.name=null,Ve}).catch(function(Ve){throw Ne.reportError(Ve,{operation_type:0,context:"version ".concat(k.version),target:"nim-"+ie}),Ve})):s.reject(L({callFunc:"db::init"}))})},Ie.destroy=function(){var ie=this;return ie.addTask(function(){if(!ie.enable)return s.reject(L({callFunc:"db::destroy"}));if(!ie.server)return s.resolve();try{return O.remove(ie.name).then(function(){ie.logger.info("db::destroy: ".concat(ie.name)),ie.server=null,ie.name=null}).catch(function(Ne){throw ie.reportError(Ne,{operation_type:1,context:"remove database failed"}),Ne})}catch(Ne){throw ie.reportError(Ne,{operation_type:1,context:"remove database failed"}),Ne}})},Ie.clear=function(){var ie=this;return ie.addTask(function(){return ie.enable?ie.server?ie.server.clear("timetag").then(function(){var Ne=i([]).call(ie.server.getIndexedDB().objectStoreNames),Ve=[];if(a(Ne).call(Ne,function(Ce){Ve.push(ie.server.clear(Ce).catch(function(Ue){throw ie.reportError(Ue,{operation_type:3,context:"tableName: ".concat(Ce,". clear table failed")}),Ue}))}),Ve.length)return s.all(Ve).then(function(){ie.logger.info("db::clear: ".concat(ie.name))}).catch(function(Ce){return ie.logger.error("db::clear: ",Ce),s.reject(Ce)})}):s.resolve():s.reject(L({callFunc:"db::clear"}))})},Ie.close=function(){this.server&&(this.server.close(),this.server=null,this.name=null)},Ie.remove=function(ie,Ne,Ve,Ce,Ue,qe,Oe){var $e=this;return $e.addTask(function(){$e.checkDB();try{return $e.server.remove(ie,Ne,Ve,Ce,Ue,qe,Oe).then(function(){var _e;$e.logger.info(d(_e="db::delete: ".concat(ie," ")).call(_e,Ne||Ve))}).catch(function(_e){throw $e.reportError(_e,{operation_type:3,context:"tableName: ".concat(ie,", remove failed")},{name:ie,keys:Ne,keyName:Ve,lowerBound:Ce,upperBound:Ue,lowerOpen:qe,upperOpen:Oe}),$e.logger.error("db::remove::server.remove error",_e),_e})}catch(_e){throw $e.reportError(_e,{operation_type:3,context:"tableName: ".concat(ie,", remove failed")},{name:ie,keys:Ne,keyName:Ve,lowerBound:Ce,upperBound:Ue,lowerOpen:qe,upperOpen:Oe}),$e.logger.error("db::remove::server.remove error",_e),_e}})},Ie.put=function(ie,Ne){var Ve=this;return Ve.addTask(function(){Ve.checkDB(),g.isArray(Ne)||(Ne=[Ne]);try{return Ve.server.update(ie,Ne).then(function(Ce){var Ue=[ie],qe=k.keyPath(ie),Oe=[];return qe&&(a(Ce).call(Ce,function($e){Oe.push(S($e,qe))}),Ue.push(Oe.length===1?Oe[0]:Oe)),Ue.unshift("db::put:"),ie==="timetag"&&Ue.push(Ce[0]),Ve.logger.log.apply(Ve.logger.log,Ue),Ce}).catch(function(Ce){throw Ve.reportError(Ce,{operation_type:3,context:"tableName: ".concat(ie,". put failed")},Ne),Ce})}catch(Ce){throw Ve.reportError(Ce,{operation_type:3,context:"tableName: ".concat(ie,". put failed")},Ne),Ce}})},Ie.get=function(ie,Ne){var Ve=this;return Ve.addTask(function(){Ve.checkDB();try{return Ve.server.get(ie,Ne).catch(function(Ue){var qe;throw Ve.reportError(Ue,{operation_type:3,context:d(qe="tableName: ".concat(ie,". get failed with key ")).call(qe,Ne)}),Ue})}catch(Ue){var Ce;throw Ve.reportError(Ue,{operation_type:3,context:d(Ce="tableName: ".concat(ie,". get failed with key ")).call(Ce,Ne)}),Ue}})},Ie.modifyOrPut=function(ie){var Ne=this,Ve=ie.table,Ce=g.copy(ie.obj),Ue=ie.key,qe=ie.modifyObjWhenPut,Oe=g.copy(Ce);return delete Oe[Ue],Ne.getOne(Ve,null,Ce[Ue],{modifyObj:Oe}).then(function($e){return $e?(Oe.idClient?Oe={idClient:Oe.idClient,server:Oe.server,pinFrom:Oe.pinFrom}:(Oe.lastMsg=Oe.lastMsg&&Oe.lastMsg.idServer+"_"+Oe.lastMsg.idClient,Oe.localCustom=Oe.localCustom&&"***",Oe.topCustom=Oe.topCustom&&"***"),Ne.logger.log("db::modifyOrPut: update table ".concat(Ve),Oe),$e):(Ce=g.merge(Ce,qe),Ne.put(Ve,Ce).then(function(_e){return _e[0]}))})},Ie.updateAndDelete=function(ie,Ne,Ve){var Ce=this;return Ce.addTask(function(){Ce.checkDB();try{return Ce.server.updateAndDelete(ie,Ne,Ve).catch(function(Ue){throw Ce.reportError(Ue,{operation_type:3,context:"tableName: ".concat(ie,". updateAndDelete failed")},{updates:Ne,deletes:Ve}),Ue})}catch(Ue){throw Ce.reportError(Ue,{operation_type:3,context:"tableName: ".concat(ie,". updateAndDelete failed")},{updates:Ne,deletes:Ve}),Ue}})},Ie.getAll=function(ie,Ne){var Ve=this;return Ve.addTask(function(){Ve.checkDB(),(Ne=Ne||{}).keys=c(Ne)===!0,Ne.desc=Ne.desc===!0,Ne.distinct=Ne.distinct===!0;try{var Ce,Ue,qe;return u(Ce=c(Ue=m(qe=Ve.server.query(ie,Ne.index)).call(qe,m(Ne))).call(Ue,c(Ne)).desc(Ne.desc).limit(Ne.limit).distinct(Ne.distinct)).call(Ce,Ne.mapper).modify(Ne.modifyObj).execute().catch(function(Oe){throw Ve.reportError(Oe,{operation_type:3,context:"tableName: ".concat(ie,". getAll failed")},Ne),Oe})}catch(Oe){throw Ve.reportError(Oe,{operation_type:3,context:"tableName: ".concat(ie,". getAll failed")},Ne),Oe}})},Ie.getOnly=function(ie,Ne,Ve,Ce){var Ue=this;return Ue.addTask(function(){Ue.checkDB(),(Ce=Ce||{}).keys=c(Ce)===!0,Ce.desc=Ce.desc===!0,Ce.distinct=Ce.distinct===!0,Ce.remove=Ce.remove===!0;try{var qe,Oe,$e;return u(qe=c(Oe=m($e=Ue.server.query(ie,Ne).only(Ve)).call($e,m(Ce))).call(Oe,c(Ce)).desc(Ce.desc).limit(Ce.limit).distinct(Ce.distinct)).call(qe,Ce.mapper).modify(Ce.modifyObj).remove(Ce.remove).execute().catch(function(Pt){var ar,pr;throw Ue.reportError(Pt,{operation_type:3,context:d(ar=d(pr="tableName: ".concat(ie,". getOnly failed with index: ")).call(pr,Ne,", matchValue: ")).call(ar,Ve)},Ce),Pt})}catch(Pt){var _e,er;throw Ue.reportError(Pt,{operation_type:3,context:d(_e=d(er="tableName: ".concat(ie,". getOnly failed with index: ")).call(er,Ne,", matchValue: ")).call(_e,Ve)},Ce),Pt}})},Ie.getOne=function(){var ie=this;return ie.getOnly.apply(ie,arguments).then(function(Ne){return Ne[0]})},Ie.clearTable=function(ie){var Ne=this;return Ne.addTask(function(){Ne.checkDB();try{return Ne.server.clear(ie).catch(function(Ve){throw Ne.reportError(Ve,{operation_type:3,context:"tableName: ".concat(ie,". clearTable failed")},options),Ve})}catch(Ve){throw Ne.reportError(Ve,{operation_type:3,context:"tableName: ".concat(ie,". clearTable failed")},options),Ve}})},Ie.checkDB=function(){if(!this.enable)throw L({callFunc:"db::checkDB"});if(!this.server)throw re({callFunc:"db::checkDB"})},t.exports=he},function(t,n){var e={version:13},r={kv:{key:{keyPath:"key"}},timetag:{key:{keyPath:"name"}},sessionsWithMoreRoaming:{key:{keyPath:"id"}},msgReadDetail:{key:{keyPath:"idClient"}},blacklist:{key:{keyPath:"account"}},mutelist:{key:{keyPath:"account"}},friend:{key:{keyPath:"account"}},user:{key:{keyPath:"account"}},team:{key:{keyPath:"teamId"}},teamMember:{key:{keyPath:"id"},indexes:{teamId:{unique:!1},account:{unique:!1}}},superTeam:{key:{keyPath:"teamId"}},superTeamMember:{key:{keyPath:"id"},indexes:{teamId:{unique:!1},account:{unique:!1},id:{unique:!1}}},msg:{key:{autoIncrement:!0},indexes:{idClient:{unique:!0},sessionId:{unique:!1},time:{unique:!1},type:{unique:!1},sessionType:{unique:!1},status:{unique:!1},sessionTime:{key:["sessionId","time"],unique:!1}}},msg1:{key:{keyPath:"idClient"},indexes:{threadMsgIdClient:{unique:!1},sessionId:{unique:!1},time:{unique:!1},status:{unique:!1},sessionTime:{key:["sessionId","time"],unique:!1}}},msgPin:{key:{keyPath:"idClient"},indexes:{sessionId:{unique:!1}}},broadcastMsg:{key:{keyPath:"broadcastId"},indexes:{time:{unique:!1}}},sysMsg:{key:{autoIncrement:!0},indexes:{idServer:{unique:!0},category:{unique:!1},type:{unique:!1}}},sysMsgUnread:{key:{keyPath:"type"}},session:{key:{keyPath:"id"},indexes:{updateTime:{unique:!1}}}};e.keyPath=function(s){return r[s].key.keyPath},e.schema=function(){return window._nimForceSyncIM=!0,r},t.exports=e},function(t,n,e){var r=e(75).fn;r.setKey=function(s,i){return this.put("kv",{key:s,value:i})},r.getKey=function(s){return this.get("kv",s).then(function(i){return i&&i.value})},r.setDonnop=function(s){return this.setKey("donnop",s)},r.getDonnop=function(){return this.getKey("donnop")}},function(t,n,e){var r=e(7),s=e(48),i=e(75).fn;i.getTimetags=function(o){var a={};return this.getAll("timetag",{filter:o,mapper:function(d){return a[d.name]=d.value,d}}).then(function(){return a})},i.getTeamMemberTimetags=function(){return this.getTimetags(function(o){var a;return r(a=o.name).call(a,"team-")!==-1})},i.getSuperTeamMemberTimetags=function(){return this.getTimetags(function(o){var a;return r(a=o.name).call(a,"superTeam-")!==-1})},i.getTimetag=function(o){return this.getOne("timetag",null,o).then(function(a){return(a=a||{value:0}).value})},i.getTeamMemberTimetag=function(){return 0},i.updateTimetag=function(o,a){var d=this,c={name:o,value:a};return this.put("timetag",c).catch(function(u){d.notifyError&&d.notifyError(u)})},i.updateMyInfoTimetag=function(o){return this.updateTimetag("myInfo",o)},i.updateRelationTimetag=function(o){return this.updateTimetag("relations",o)},i.getRelationsTimetag=function(){return this.getTimetag("relations")},i.updateFriendTimetag=function(o){return this.updateTimetag("friends",o)},i.getFriendsTimetag=function(){return this.getTimetag("friends")},i.updateFriendUserTimetag=function(o){return this.updateTimetag("friendUsers",o)},i.updateTeamTimetag=function(o){return this.updateTimetag("teams",o)},i.getTeamsTimetag=function(){return this.getTimetag("teams")},i.updateSuperTeamTimetag=function(o){return this.updateTimetag("superTeams",o)},i.getSuperTeamsTimetag=function(){return this.getTimetag("superTeams")},i.updateTeamMemberTimetag=function(o,a){return this.updateTimetag("team-"+o,a)},i.getTeamMembersTimetag=function(o){return this.getTimetag("team-"+o)},i.updateSuperTeamMemberTimetag=function(o,a){return this.updateTimetag("superTeam-"+o,a)},i.getSuperTeamMembersTimetag=function(o){return this.getTimetag("superTeam-"+o)},i.updateMyTeamMembersTimetag=function(o){return this.updateTimetag("myTeamMembers",o)},i.updateMySuperTeamMembersTimetag=function(o){return this.updateTimetag("myInfoInSuperTeams",o)},i.getBroadcastMsgTimetag=function(){return this.getTimetag("broadcastMsg")},i.updateBroadcastMsgTimetag=function(o){return this.updateTimetag("broadcastMsg",s(o))},i.updateRoamingMsgTimetag=function(o){return this.updateTimetag("roamingMsgs",o)},i.updateSuperTeamRoamingMsgTimetag=function(o){return this.updateTimetag("superTeamRoamingMsgs",o)},i.updateMsgReceiptsTimetag=function(o){return this.updateTimetag("msgReceipts",o)},i.updateDonnopTimetag=function(o){return this.updateTimetag("donnop",o)},i.updateSessionAck=function(o){return this.updateTimetag("sessionAck",o)},i.updateDeleteMsgSelf=function(o){return this.updateTimetag("deleteMsgSelf",o)},i.updateSuperTeamSessionAck=function(o){return this.updateTimetag("superTeamSessionAck",o)},i.deleteTimetag=function(o){return this.remove("timetag",o)},i.deleteTeamMemberTimetag=function(o){return this.deleteTimetag("team-"+o)},i.deleteSuperTeamMemberTimetag=function(o){return this.deleteTimetag("superTeam-"+o)}},function(t,n,e){var r=e(3),s=e(75).fn,i=e(0);s.mergeRelations=function(o,a,d,c,u){var m=this,y=m.updateAndDelete("blacklist",o,a),S=m.updateAndDelete("mutelist",d,c);return r.all([y,S]).then(function(){return m.logger.info("db::mergeRelations: timetag ".concat(u)),m.updateRelationTimetag(u),[o,a,d,c,u]})},s.getRelations=function(){var o=this.getAll("blacklist"),a=this.getAll("mutelist");return r.all([o,a])},s.markInBlacklist=function(o){if((o=i.copy(o)).isAdd){var a=o.record;return this.put("blacklist",a)}var d=o.account;return this.remove("blacklist",d)},s.markInMutelist=function(o){if((o=i.copy(o)).isAdd){var a=o.record;return this.put("mutelist",a)}var d=o.account;return this.remove("mutelist",d)}},function(t,n,e){var r=e(9),s=e(3),i=e(123),o=e(75).fn,a=e(0);o.mergeFriends=function(d,c,u){var m=this;return m.updateAndDelete("friend",d,c).then(function(){return m.logger.log("db::mergeFriends: updateAndDelete done",d&&r(d).call(d,function(y){return y.account}).join(",")),u&&m.updateFriendTimetag(u),[d,c,u]})},o.putFriend=function(d){return this.put("friend",d)},o.updateFriend=function(d){var c=this,u=(d=a.copy(d)).account;return this.getOne("friend",null,u,{modifyObj:d}).then(function(m){return m?c.logger.log("db::updateFriend: ".concat(u)):c.logger.warn("db::updateFriend: no record ".concat(u)),m})},o.deleteFriend=function(d){var c=this.remove("friend",d),u=this.deleteUser(d);return s.all([c,u])},o.getFriends=function(){var d,c=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},u={};c.accountIds!==void 0&&(u=i(d=c.accountIds).call(d,function(y,S){return y[S]=!0,y},{}));var m=function(y){return!!y.valid&&!(c.updateTime!==void 0&&y.updateTime<=c.updateTime)&&!(c.accountIds!==void 0&&!u[y.account])};return this.getAll("friend",{filter:m})},o.getFriend=function(d){return this.getOne("friend",null,d)},o.getUserFromBlackList=function(d){return this.getOne("blacklist",null,d)}},function(t,n,e){var r=e(3),s=e(2),i=e(6),o=e(123),a=e(9),d=e(75).fn,c=e(0),u=e(41),m=e(194),y=e(152);function S(g){return g.valid&&g.validToCurrentUser}function O(g){return g&&g.valid}function k(g){return g&&c.fillUndef(g,{mute:!1,custom:""}),g}d.mergeTeams=function(g,v,ue){var L=this,re=L.put("team",g),le=L.leaveTeams(v,ue);return r.all([re,le]).then(function(){return L.logger.log("db::mergeTeams:"),L.updateTeamTimetag(ue),[g,v,ue]})},d.putTeam=function(g){if(g)return c.isArray(g)||(g=[g]),s(g).call(g,function(v){v.validToCurrentUser=!0}),this.put("team",g)},d.updateTeam=function(g){var v=this,ue=(g=c.copy(g)).teamId;return v.getOne("team",null,ue,{modifyObj:g}).then(function(L){if(L)v.logger.log("db::updateTeam: ".concat(ue));else if(v.logger.warn("db::updateTeam: no record ".concat(ue)),g.validToCurrentUser)return v.putTeam(g);return L})},d.transferTeam=function(g,v,ue){var L=this,re=g.teamId,le=g.memberUpdateTime,oe={teamId:re,account:v,type:"normal",updateTime:le},he={teamId:re,account:ue,type:"owner",updateTime:le};return L.updateTeamMembers([oe,he]).then(function(){return L.putTeam(g).then(function(){var Ie,ie;return L.logger.info(i(Ie=i(ie="db::transferTeam: ".concat(g.teamId," ")).call(ie,v," -> ")).call(Ie,ue)),[g,v,ue]})})},d.leaveTeam=function(g){var v=this;return v.updateTeam({teamId:g,validToCurrentUser:!1}).then(function(){return v.removeAllTeamMembers(g)})},d.dismissTeam=function(g,v){var ue=this,L={teamId:g,valid:!1,validToCurrentUser:!1,updateTime:v};return ue.updateTeam(L).then(function(){return ue.removeAllTeamMembers(g)})},d.leaveTeams=function(g,v){var ue,L=this,re=[];return s(g).call(g,function(le){ue=L.leaveTeam(le.teamId,v),re.push(ue)}),r.all(re)},d.getTeamsByTeamIds=function(g){var v,ue=this,L=[];return s(g).call(g,function(re){v=ue.getTeam(re),L.push(v)}),r.all(L)},d.getTeam=function(g){g=""+g;var v=this;return v.getOne("team",null,g).then(function(ue){return ue?(v.updateTeamProperties([ue]),ue):null})},d.getTeams=function(){var g,v=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},ue={};v.teamIds!==void 0&&(ue=o(g=v.teamIds).call(g,function(re,le){return re[le]=!0,re},{}));var L=function(re){return!!S(re)&&!(v.teamIds!==void 0&&!ue[re.teamId])};return this.getAll("team",{filter:L})},d.updateTeamProperties=function(g){s(g).call(g,function(v){v&&m.fillProperties(v)})},d.mergeTeamMembers=function(g,v,ue,L){var re=this,le=re.putTeamMembers(v),oe=re.updateTeamMembers(ue);return r.all([le,oe]).then(function(){return re.logger.log("db::mergeTeamMembers: ".concat(g)),re.updateTeamMemberTimetag(g,L)})},d.putTeamMembers=function(g){return this.put("teamMember",g)},d.getTeamMembersByAccount=function(g){return this.getOnly("teamMember","account",g,{filter:O,mapper:k}).then()},d.getTeamMembers=function(){var g,v=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},ue={};v.accountIds!==void 0&&(ue=o(g=v.accountIds).call(g,function(oe,he){return oe[he]=!0,oe},{}));var L,re={};v.teamIds!==void 0&&(re=o(L=v.teamIds).call(L,function(oe,he){return oe[he]=!0,oe},{}));var le=function(oe){return!!oe.valid&&!(v.teamIds!==void 0&&!re[oe.teamId])&&!(v.accountIds!==void 0&&!ue[oe.account])};return this.getAll("teamMember",{filter:le})},d.getTeamMembersByTeamId=function(g){return this.getOnly("teamMember","teamId",g,{filter:O,mapper:k})},d.getTeamMembersById=function(g){return this.getOnly("teamMember",null,g,{filter:O,mapper:k})},d.updateTeamMemberProperties=function(g){var v,ue=this,L=[];return s(g).call(g,function(re){y.fillProperties(re)&&(v=ue.updateTeamMember(re),L.push(v))}),r.all(L)},d.getInvalidTeamMembers=function(g,v){var ue=this;g=""+g;var L,re=[];return s(v).call(v,function(le){L=ue.getOne("teamMember",null,y.genId(g,le)).then(function(oe){return k(oe)}),re.push(L)}),r.all(re)},d.updateTeamMember=function(g){var v=this,ue=g.teamId,L=g.account,re=y.genId(ue,L),le=c.filterObj(g,"nickInTeam muteTeam mute custom updateTime type valid followAccountIds");return this.getOne("teamMember",null,re,{modifyObj:le,mapper:k}).then(function(oe){var he,Ie;return oe?v.logger.log(i(he="db::updateTeamMember: ".concat(ue," ")).call(he,L),c.pickAsString(le,["muteTeam","mute","updateTime","type","valid"])):v.logger.warn(i(Ie="db::updateTeam: no record ".concat(ue," ")).call(Ie,L)),oe})},d.updateTeamMembers=function(g){var v=this;if(!g.length)return r.resolve();var ue,L=[];return s(g).call(g,function(re){ue=v.updateTeamMember(re),L.push(ue)}),r.all(L)},d.updateTeamManagers=function(g,v,ue,L){var re=a(v).call(v,function(le){return{teamId:g,account:le,type:ue?"manager":"normal",updateTime:L}});return this.updateTeamMembers(re)},d.removeTeamMembersByAccounts=function(g,v){var ue=a(v).call(v,function(L){return{teamId:g,account:L,valid:!1}});return this.updateTeamMembers(ue)},d.removeAllTeamMembers=function(g){var v=this;return v.getOnly("teamMember","teamId",g,{modifyObj:{valid:!1}}).then(function(){return v.logger.warn("db::removeAllTeamMembers: ".concat(g)),v.deleteTeamMemberTimetag(g)})},d.deleteTeamMembers=function(g){var v=this;return v.getOnly("teamMember","teamId",g,{remove:!0}).then(function(){v.logger.warn("db::deleteTeamMembers: ".concat(g)),v.deleteTeamMemberTimetag(g)})},d.deleteTeam=function(g){var v,ue=this,L=[];return c.isArray(g)||(g=[g]),s(g).call(g,function(re){re=""+re,v=ue.get("team",re).then(function(le){if(le&&S(le))throw u.stillInTeamError({callFunc:"team::deleteTeam",team:le});var oe=ue.remove("team",re),he=ue.deleteTeamMembers(re);return r.all([oe,he])}),L.push(v)}),L.length===1?L[0]:r.all(L)}},function(t,n,e){var r=e(3),s=e(2),i=e(10),o=e(6),a=e(9),d=e(75).fn,c=e(0),u=e(41),m=e(308),y=e(203);function S(g){return g.valid&&g.validToCurrentUser}function O(g){return g&&g.valid}function k(g){return g&&c.fillUndef(g,{mute:!1,custom:""}),g}d.mergeSuperTeams=function(g,v,ue){var L=this,re=L.put("superTeam",g),le=L.leaveTeams(v,ue);return r.all([re,le]).then(function(){return L.logger.log("db::mergeSuperTeams:"),L.updateSuperTeamTimetag(ue),[g,v,ue]})},d.putSuperTeam=function(g){if(g)return c.isArray(g)||(g=[g]),s(g).call(g,function(v){v.validToCurrentUser=!0}),this.put("superTeam",g)},d.updateSuperTeam=function(g){var v=this,ue=(g=c.copy(g)).teamId;return v.getOne("superTeam",null,ue,{modifyObj:g}).then(function(L){return L?(v.logger.info("db::updateSuperTeam: ".concat(ue)),L):(v.logger.warn("db::updateSuperTeam: no record ".concat(ue)),v.putSuperTeam(g))})},d.leaveSuperTeam=function(g){var v=this;return v.updateSuperTeam({teamId:g,validToCurrentUser:!1}).then(function(){return v.removeAllSuperTeamMembers(g)})},d.dismissSuperTeam=function(g,v){var ue=this,L={teamId:g,valid:!1,validToCurrentUser:!1,updateTime:v};return ue.updateSuperTeam(L).then(function(){return ue.removeAllSuperTeamMembers(g)})},d.leaveSuperTeams=function(g,v){var ue,L=this,re=[];return s(g).call(g,function(le){ue=L.leaveSuperTeam(le.teamId,v),re.push(ue)}),r.all(re)},d.getSuperTeamsByTeamIds=function(g){var v,ue=this,L=[];return s(g).call(g,function(re){v=ue.getSuperTeam(re),L.push(v)}),r.all(L)},d.getSuperTeam=function(g){g=""+g;var v=this;return v.getOne("superTeam",null,g).then(function(ue){return ue?(v.updateSuperTeamProperties([ue]),ue):null})},d.getSuperTeams=function(){var g=this;return g.getAll("superTeam",{filter:S}).then(function(v){return g.updateSuperTeamProperties(v),v})},d.updateSuperTeamProperties=function(g){s(g).call(g,function(v){v&&m.fillProperties(v)})},d.mergeSuperTeamMembers=function(g,v,ue,L){var re=this,le=re.putSuperTeamMembers(v),oe=re.updateSuperTeamMembers(ue);return r.all([le,oe]).then(function(){return re.logger.log("db::mergeSuperTeamMembers: ".concat(g)),L!=null?re.updateSuperTeamMemberTimetag(g,L):r.resolve()})},d.getSuperTeamMembersByTeamId=function(g){return this.getOnly("superTeamMember","teamId",g,{filter:O,mapper:k}).then()},d.getSuperTeamMembersById=function(g){return this.getOnly("superTeamMember",null,g,{filter:O,mapper:k}).then()},d.putSuperTeamMembers=function(g){return this.put("superTeamMember",g)},d.getSuperTeamMemberById=function(g){return this.get("superTeamMember",g)},d.getSuperTeamMembers=function(g,v){var ue=this;g=""+g;var L={filter:function(re){return re.valid},mapper:k};if(v){if(typeof v.joinTime!="number")return void ue.logger.error("db::getSuperTeamMembers::params.joinTime should be number, not ",v.joinTime);v.limit&&(L.limit=v.limit),i(v)?L.filter=function(re){return re.valid&&re.joinTime<=v.joinTime}:L.filter=function(re){return re.valid&&re.joinTime>=v.joinTime}}return ue.getOnly("superTeamMember","teamId",g,L).then(function(re){return ue.updateSuperTeamMemberProperties(re).then(function(){return re})})},d.getSuperTeamMembersByAccount=function(g){return this.getOnly("superTeamMember","account",g,{filter:O,mapper:k}).then()},d.updateSuperTeamMemberProperties=function(g){var v,ue=this,L=[];return s(g).call(g,function(re){y.fillProperties(re)&&(v=ue.updateSuperTeamMember(re),L.push(v))}),r.all(L)},d.getInvalidSuperTeamMembers=function(g,v){var ue=this;g=""+g;var L,re=[];return s(v).call(v,function(le){L=ue.getOne("superTeamMember","id",y.genId(g,le)).then(function(oe){return k(oe)}),re.push(L)}),r.all(re)},d.updateSuperTeamMember=function(g){var v=this,ue=g.teamId,L=g.account,re=y.genId(ue,L),le=c.filterObj(g,"nickInTeam muteTeam mute custom updateTime type valid followAccountIds");return this.getOne("superTeamMember","id",re,{modifyObj:le,mapper:k}).then(function(oe){var he,Ie;return oe?v.logger.log(o(he="db::updateSuperTeamMember: ".concat(ue," ")).call(he,L),c.pickAsString(le,["muteTeam","mute","updateTime","type","valid"])):v.logger.warn(o(Ie="db::updateSuperTeam: no record ".concat(ue," ")).call(Ie,L)),oe})},d.updateSuperTeamMembers=function(g){var v=this;if(!g.length)return r.resolve();var ue,L=[];return s(g).call(g,function(re){ue=v.updateSuperTeamMember(re),L.push(ue)}),r.all(L)},d.removeSuperTeamMembersByAccounts=function(g,v){var ue=a(v).call(v,function(L){return{teamId:g,account:L,valid:!1}});return this.updateSuperTeamMembers(ue)},d.removeAllSuperTeamMembers=function(g){var v=this;return v.getOnly("superTeamMember","teamId",g,{modifyObj:{valid:!1}}).then(function(){return v.logger.warn("db::removeAllSuperTeamMembers: ".concat(g)),v.deleteSuperTeamMemberTimetag(g)})},d.deleteSuperTeamMembers=function(g){var v=this;return v.getOnly("superTeamMember","teamId",g,{remove:!0}).then(function(){v.logger.warn("db::deleteSuperTeamMembers: ".concat(g)),v.deleteSuperTeamMemberTimetag(g)})},d.deleteSuperTeam=function(g){var v,ue=this,L=[];return c.isArray(g)||(g=[g]),s(g).call(g,function(re){re=""+re,v=ue.get("superTeam",re).then(function(le){if(le&&S(le))throw u.stillInTeamError({callFunc:"team::deleteTeam",team:le});var oe=ue.remove("superTeam",re),he=ue.deleteSuperTeamMembers(re);return r.all([oe,he])}),L.push(v)}),L.length===1?L[0]:r.all(L)},d.transferSuperTeam=function(g,v,ue){var L=this;return L.updateSuperTeamMembers([v,ue]).then(function(){return L.putSuperTeam(g).then(function(){var re,le;return L.logger.info(o(re=o(le="db::transferSuperTeam: ".concat(g.teamId," ")).call(le,v.account," -> ")).call(re,ue.account)),[g,v,ue]})})}},function(t,n,e){var r=e(2),s=e(3),i=e(123),o=e(75).fn,a=e(0);o.mergeMyInfo=function(d,c){var u=this;return u.put("user",d).then(function(){return c?u.updateMyInfoTimetag(d.updateTime):d})},o.mergeFriendUsers=function(d,c){var u=this;return u.putUsers(d).then(function(){u.updateFriendUserTimetag(c)})},o.putUsers=function(d){return this.put("user",d)},o.putUser=function(d){return this.put("user",d)},o.updateUser=function(d){var c=this,u=(d=a.copy(d)).account;return this.getOne("user",null,u,{modifyObj:d}).then(function(m){return m?c.logger.log("db::updateUser: ".concat(u)):c.logger.warn("db::updateUser: no record ".concat(u)),m})},o.putUsersIfIsFriend=function(d){var c,u=this,m=[],y=[];return r(d).call(d,function(S){c=u.getFriend(S.account).then(function(O){return O&&(c=u.putUser(S),y.push(c)),O}),m.push(c)}),s.all(m).then(function(){return s.all(y).then(function(S){return S})})},o.deleteUser=function(d){return this.remove("user",d)},o.getUser=function(d){return this.getOne("user",null,d)},o.getUsers=function(){var d,c=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},u={};c.accountIds!==void 0&&(u=i(d=c.accountIds).call(d,function(y,S){return y[S]=!0,y},{}));var m=function(y){return!(c.accountIds!==void 0&&!u[y.account])};return this.getAll("user",{filter:m})},o.getAllUsers=function(){return this.getAll("user")}},function(t,n,e){var r=e(16),s=e(3),i=e(6),o=e(2),a=e(37),d=e(32),c=e(7),u=e(122),m=e(9),y=e(75).fn,S=e(0),O=e(11);y.putMsg=function(k){var g=this;return S.isArray(k)||(k=[k]),!k.length||r(k[0])?s.resolve():(k=r(k).call(k,function(v){return!v.ignore}),g.put("msg1",k).catch(function(v){return g.notifyError&&g.notifyError(v),s.resolve(k,v)}))},y.putMsgReadDetail=function(k){var g=this;if(k.idClient)return this.put("msgReadDetail",k).catch(function(v){g.logger.error("putMsgReadDetail error",v)})},y.getMsgReadDetail=function(k){return this.getOne("msgReadDetail",null,k)},y.updateMsg=function(k){var g=this;if(!r(k)){var v=k.idClient,ue=S.filterObj(k,"resend status idServer time localCustom commentTimetag comments hasSendAck callbackExt");return g.getOne("msg1",null,v,{modifyObj:ue}).then(function(L){var re,le,oe;return L?g.logger.info(i(re=i(le=i(oe="db::updateMsg: ".concat(v,"，idServer: ")).call(oe,ue.idServer,"，status: ")).call(le,ue.status,"，time: ")).call(re,ue.time)):g.logger.warn("db::updateMsg: no record ".concat(v)),L}).catch(function(L){return g.notifyError&&g.notifyError(L),s.resolve(k)})}},y.updateMsgBatch=function(k){var g=this;if(O.isRN)this.logger.warn("react native can not support updateMsgBatch");else{this.checkDB();var v=this.server.getIndexedDB().transaction(["msg1"],"readwrite").objectStore("msg1");o(k).call(k,function(ue){if(ue.idClient){var L=v.get(ue.idClient);L.onerror=function(re){g.logger.error("updateMsgBatch::store.get:error",re)},L.onsuccess=function(){var re=L.result||ue;v.put(a({},re,ue)).onerror=function(le){g.logger.error("updateMsgBatch::store.put:error",le)}}}})}},y.getMsgs=function(k){return O.isBrowser?this.getMsgsIndexedDB(k):O.isRN?this.getMsgsRN(k):s.resolve()},y.getSubMessages=function(k){return O.isBrowser?this.getSubMessagesIndexedDB(k):s.resolve([])},y.getMsgsRN=function(k){var g={};return typeof k.start=="number"&&(g.lowerBound=["time",k.start]),typeof k.end=="number"&&k.end!==1/0&&(g.upperBound=["time",k.end]),g.desc=!1,g.index="time",typeof k.desc=="boolean"&&(g.desc=k.desc),typeof k.limit=="number"&&(g.limit=k.limit),g.searchIndex=[],k.sessionId&&g.searchIndex.push(["sessionId",k.sessionId]),typeof k.type=="string"&&g.searchIndex.push(["type",k.type]),this.getAll("msg1",g)},y.getMsgsIndexedDB=function(k){var g,v=this;v.checkDB();var ue="time",L=!1,re=!1,le=(k=k||{}).sessionId||[],oe=k.sessionIds||[];S.isString(le)?le=[le]:d(le)||(le=[]),S.isString(oe)?oe=[oe]:d(oe)||(oe=[]);var he=i(le).call(le,oe);he.length===1?(L=!0,ue="sessionTime",le=he[0]):he.length>1&&(L=!0,re=!0,oe=he);var Ie=k.start||0,ie=k.end||1/0,Ne=Ie,Ve=ie;L&&!re&&(Ne=[le,Ie],Ve=[le,ie]);var Ce=k.desc!==!1,Ue=k.limit||100,qe=!1,Oe=!1,$e=k.type||[],_e=k.types||[];S.isString($e)?$e=[$e]:d($e)||($e=[]),S.isString(_e)?_e=[_e]:d(_e)||(_e=[]);var er=i($e).call($e,_e);er.length===1?(qe=!0,$e=er[0]):er.length>1&&(qe=!0,Oe=!0,_e=er);var Pt,ar=k.subTypes&&k.subTypes.length,pr=k.keyword||"",lr=k.filterFunc;return(re||qe||pr||ar||S.isFunction(lr))&&(Pt=function(or){var xe;if(re&&c(oe).call(oe,or.sessionId)===-1)return!1;if(qe){if(Oe){if(c(_e).call(_e,or.type)===-1)return!1}else if($e!==or.type)return!1}if(ar&&c(xe=k.subTypes).call(xe,or.subType)===-1)return!1;if(pr){var nr=or.text||or.tip||"";if(c(nr).call(nr,pr)===-1)return!1}return!lr||lr(or)}),r(g=v.server.query("msg1",ue).bound(Ne,Ve,!0,!0).desc(Ce).limit(Ue)).call(g,Pt).execute().catch(function(or){throw v.reportError(or,{operation_type:3,context:"tableName: ".concat("msg1",", index ").concat(ue,", getMsgsIndexedDB error")},k),or})},y.getSubMessagesIndexedDB=function(k){var g=this;return g.checkDB(),g.getOnly("msg1","threadMsgIdClient",k).then(function(v){var ue;return u(ue=v||[]).call(ue,function(L,re){return L.time-re.time})}).catch(function(v){throw g.reportError(v,{operation_type:3,context:"tableName: ".concat("msg1",", IndexThreadMsgIdClient ").concat(k,", getSubMessagesIndexedDB error")}),v})},y.getMsgCountAfterAck=function(k){return O.isBrowser?this.getMsgCountAfterAckIndexedDB(k):O.isRN?this.getMsgCountAfterAckRN(k):s.resolve()},y.getMsgCountAfterAckRN=function(k){var g=this,v=k=k||{},ue=v.sessionId,L=v.ack;return g.checkDB(),g.getAll("msg1",{searchIndex:["sessionId",ue],lowerBound:["time",L]}).then(function(re){var le=r(re).call(re,function(oe){if(oe.flow==="out"||oe.isUnreadable===!1)return!1;if(oe.type==="notification")try{return k.shouldCountNotifyUnread(oe)}catch(he){throw g.logger.error("userOption:shouldCountNotifyUnread function error",he),he}return!0});return s.resolve(le.length)})},y.getMsgCountAfterAckIndexedDB=function(k){var g=this,v=(k=k||{}).sessionId;return g.checkDB(),g.server.query("msg1","sessionTime").bound([v,k.ack],[v,1/0],!0,!0).execute().then(function(ue){var L=r(ue).call(ue,function(re){if(re.flow==="out"||re.isUnreadable===!1)return!1;if(re.type==="notification")try{return k.shouldCountNotifyUnread(re)}catch(le){throw g.logger.error("userOption:shouldCountNotifyUnread function error",le),le}return!0});return s.resolve(L.length)}).catch(function(ue){throw g.reportError(ue,{operation_type:3,context:"tableName: ".concat("msg1",", IndexSessionTime ").concat("sessionTime",", getMsgCountAfterAckIndexedDB error")},k),ue})},y.amendMsg=function(k){return k?(S.notexist(k.text)&&(k.text=""),k):null},y.getMsgByIdClient=function(k){var g=this;return g.getOne("msg1",null,k).then(function(v){return g.amendMsg(v)})},y.getMsgsByIdClients=function(k){var g,v=this,ue=[];return o(k).call(k,function(L){g=v.getMsgByIdClient(L),ue.push(g)}),s.all(ue)},y.clearSendingMsgs=function(){var k=this;return k.getOnly("msg1","status","sending",{modifyObj:{status:"fail"}}).then(function(g){k.logger.info("db::clearSendingMsgs: msgs send failed",g&&m(g).call(g,function(v){return v.idClient}).join(","))})},y.deleteMsg=function(k){var g,v=this,ue=[];return S.isArray(k)||(k=[k]),o(k).call(k,function(L){g=v.getOne("msg1",null,L,{remove:!0}).then(function(re){return v.logger.info("db::deleteMsg done",L,re&&re.idClient),re}).catch(function(re){throw v.logger.error("db::deleteMsg failed",L,re),re}),ue.push(g)}),ue.length===1?ue[0]:s.all(ue)},y.deleteMsgsBySessionId=function(k){var g=this,v=null,ue=k.start,L=k.end;return ue!==void 0&&L!==void 0?v=function(re){return re>ue&&re<L}:ue!==void 0?v=function(re){return re>ue}:L!==void 0&&(v=function(re){return re<L}),v?g.getOnly("msg1","sessionId",k.sessionId).then(function(re){var le=[];return m(re=re||[]).call(re,function(oe){v(oe.time)&&le.push(oe.idClient)}),g.logger.info("db::deleteMsgsBySessionId: session results",le),g.deleteMsg(le)}):g.getOnly("msg1","sessionId",k.sessionId,{remove:!0})},y.deleteMsgsByTime=function(k){return this.remove("msg1",null,"time",k.start,k.end,!0,!0)},y.getDeletedMsgsCountByTime=function(k){this.checkDB();var g=this.server.getIndexedDB().transaction(["msg1"],"readonly").objectStore("msg1").index("time"),v=IDBKeyRange.bound(k.start,k.end,!0,!0),ue=g.count(v);return new s(function(L,re){ue.onsuccess=function(le){L(le.target.result)},ue.onerror=function(le){this.logger.error("countDeletedMsgsByTime::index.count:error",le),re(le)}})},y.deleteAllMsgs=function(){var k=this.clearTable("msg1"),g=this.clearTable("session");return s.all([k,g])},y.getMsgPins=function(k){return this.getOnly("msgPin","sessionId",k)},y.deleteMsgPins=function(k){return this.getOnly("msgPin","sessionId",k,{remove:!0})},y.putMsgPin=function(k){var g=this;return this.modifyOrPut({table:"msgPin",obj:k,key:"idClient"}).catch(function(v){g.notifyError&&g.notifyError(v)})},y.putMsgPins=function(k){return this.put("msgPin",k)},y.deleteMsgPin=function(k){var g=this;return this.getOne("msgPin",null,k.idClient,{remove:!0}).then(function(v){return g.logger.info("db::deleteMsgPin:",v.idClient),v})}},function(t,n,e){var r=e(3),s=e(16),i=e(2),o=e(10),a=e(4),d=e(75).fn,c=e(0),u=c.notundef;d.putSysMsg=function(m){var y=this;return new r(function(S){if(c.isArray(m)||(m=[m]),!s(m[0])){var O=[],k=m.length;i(m).call(m,function(v){v=c.copy(v),y.put("sysMsg",v).then(function(ue){O.push(ue[0]),g()},g)})}function g(){--k===0&&S(O)}})},d.getSysMsgs=function(m){var y=!o(m=m||{}),S=m.limit||100,O=null,k=null;m.category&&(O="category",k=m.category),m.type&&(O="type",k=m.type);var g,v=m.lastIdServer,ue=!1,L=m.read;return(u(v)||u(L))&&(g=function(re){return u(v)?(v=""+v,ue?le():(re.idServer===v&&(ue=!0),!1)):le();function le(){return!u(L)||re.read===L}}),m={filter:g,desc:y,limit:S},O?this.getOnly("sysMsg",O,k,m):this.getAll("sysMsg",m)},d.getSysMsgByIdServer=function(m){return this.getOne("sysMsg","idServer",m)},d.updateSysMsg=function(m){var y=this;if(!s(m)){var S=""+m.idServer,O=c.filterObj(m,"read state error localCustom");return this.getOne("sysMsg","idServer",S,{modifyObj:O}).then(function(k){return k?y.logger.log("db::updateSysMsg: ".concat(S),c.pickAsString(O,["read","state","error"])):y.logger.warn("db::updateSession: ".concat(S)),k})}},d.markSysMsgRead=function(m){var y=this;return new r(function(S,O){c.isArray(m)||(m=[m]);var k,g,v=[],ue=[];i(m).call(m,function(L){k=y.getSysMsgByIdServer(L.idServer).then(function(re){re&&!re.read&&(g=y.updateSysMsg({idServer:re.idServer,read:!0}),ue.push(g))},O),v.push(k)}),r.all(v).then(function(){r.all(ue).then(function(L){S(L)},O)},O)})},d.deleteSysMsg=function(m){var y,S=this,O=[];return c.isArray(m)||(m=[m]),i(m).call(m,function(k){k=""+k,y=S.getOne("sysMsg","idServer",k,{remove:!0}),O.push(y)}),O.length===1?O[0]:r.all(O)},d.deleteAllSysMsgs=function(){var m=this.clearTable("sysMsg"),y=this.clearTable("sysMsgUnread");return r.all([m,y])},d.getSysMsgUnread=function(){return this.getAll("sysMsgUnread").then(function(m){var y={};return i(m).call(m,function(S){y[S.type]=S.num}),y})},d.updateSysMsgUnread=function(m){var y,S=this;m=c.copy(m);var O=[];return i(y=a(m)).call(y,function(k){O.push({type:k,num:m[k]})}),this.put("sysMsgUnread",O).then(function(){return S.logger.info("db::updateSysMsgUnread: ",m),m})}},function(t,n,e){var r=e(3),s=e(2),i=e(75).fn,o=e(0);i.putBroadcastMsg=function(a){var d=this;return new r(function(c){o.isArray(a)||(a=[a]);var u=[],m=a.length;function y(){--m===0&&c(u)}s(a).call(a,function(S){S=o.copy(S),d.put("broadcastMsg",S).then(function(O){u.push(O[0]),y()},y)})})},i.getBroadcastMsgs=function(a){return a=a||{},this.getAll("broadcastMsg",a)}},function(t,n,e){var r=e(3),s=e(10),i=e(6),o=e(32),a=e(2),d=e(75).fn,c=e(0),u=c.notundef;d.putSession=function(m){var y=this,S=m.unread;return(m=c.merge({},m)).updateTime===void 0&&m.lastMsg&&m.lastMsg.time&&(m.updateTime=m.lastMsg.time),(m.lastMsg||!m.ack&&!m.msgReceiptTime)&&(m.isDeleted=!1),delete m.unread,this.modifyOrPut({table:"session",obj:m,key:"id",modifyObjWhenPut:{unread:0}}).catch(function(O){return y.notifyError&&y.notifyError(O),m.unread=S,r.resolve(m)})},d.getAllSessions=function(){return this.getAll("session",{index:"updateTime",desc:!0}).catch(function(m){self.notifyError&&self.notifyError(m)})},d.getSessions=function(m){var y=!s(m=m||{}),S=m.limit||100,O=m.lastSessionId,k=m.sessionId,g=!1,v=this,ue=function(){return!0},L=function(){return!0};return u(k)?this.getSession(k,m.isDeleted):(u(O)&&(ue=function(re){return re.id===O&&(g=!0),g}),m.includeDeleted||(L=function(re){return!re.isDeleted}),this.getAll("session",{index:"updateTime",desc:y,limit:S,filter:function(re){return ue(re)&&L(re)}}).catch(function(re){v.notifyError&&v.notifyError(re)}))},d.getSession=function(m,y){var S=this;return this.get("session",m).then(function(O){return r.resolve(!y&&O&&O.isDeleted?void 0:O)}).catch(function(O){throw S.notifyError&&S.notifyError(O),O})},d.updateSession=function(m){var y=this,S=m.id,O=c.filterObj(m,"ack unread lastMsg localCustom msgReceiptTime msgReceiptServerTime isTop topCustom isDeleted");return m.lastMsg&&(O.lastMsg=m.lastMsg),this.getOne("session",null,S,{modifyObj:O}).then(function(k){if(k){var g,v=i(g="db::updateSession: ".concat(S," ")).call(g,c.pickAsString(O,["ack","unread","msgReceiptTime","msgReceiptServerTime","isTop","isDeleted"]));v+=O.lastMsg?" lastMsg.idClient:".concat(c.get(O,"lastMsg.idClient")):"",y.logger.info(v)}else y.logger.warn("db::updateSession: no record ".concat(S));return k}).catch(function(k){y.notifyError&&y.notifyError(k)})},d.getStickTopSessions=function(){var m=this;return this.getAll("session",{filter:function(y){return y&&y.isTop}}).catch(function(y){m.notifyError&&m.notifyError(y)})},d.deleteSession=function(m,y){var S=y&&y.scene||"";return S==="superTeam"?this.updateSuperTeamSessionAck(0):(S==="p2p"||S==="team"||this.updateSuperTeamSessionAck(0),this.updateSessionAck(0)),this.updateMsgReceiptsTimetag(0),this.remove("session",m)},d.deleteSessionLogic=function(m){var y=this;if(!o(m))return this.getOne("session",null,m,{modifyObj:{isDeleted:!0}});var S=[];return a(m).call(m,function(O){S.push(y.getOne("session",null,O,{modifyObj:{isDeleted:!0}}))}),r.all(S)},d.putSessionsWithMoreRoaming=function(m){return this.put("sessionsWithMoreRoaming",m)},d.updateSessionsWithMoreRoaming=function(m){var y=m.id;return delete m.id,this.getOne("sessionsWithMoreRoaming",null,y,{modifyObj:m})},d.deleteSessionsWithMoreRoaming=function(m){return this.remove("sessionsWithMoreRoaming",m)},d.getSessionsWithMoreRoaming=function(m){return m?this.get("sessionsWithMoreRoaming",m):this.getAll("sessionsWithMoreRoaming")}},function(t,n,e){var r=e(6),s=e(92),i=e(93),o=e(0).throttle,a=function(){function d(c){s(this,d),this.arr=[],this.timer=null,this.maxLength=c.maxLength||100,this.throttleTime=c.throttleTime||5e3,this.processFn=c.processFn||function(){},this.throttleFn=c.processFn||function(){},c.processFn&&(this.throttleFn=o(function(u){c.processFn(u),u.length=0},this.throttleTime,{leading:!1}))}return i(d,[{key:"add",value:function(c){var u;Object.prototype.toString.call(c)==="[object Array]"?this.arr=r(u=this.arr).call(u,c):this.arr.push(c),this.arr.length>=this.maxLength&&(this.processFn(this.arr),this.arr=[]),this.timer=this.throttleFn(this.arr)}},{key:"destroy",value:function(){this.arr=[],this.timer&&clearTimeout(this.timer),this.processFn=function(){},this.throttleFn=function(){}}},{key:"clear",value:function(){this.arr=[],this.timer&&clearTimeout(this.timer)}}]),d}();t.exports=a},function(t,n,e){var r=e(51),s=e(37),i=e(60),o=e(2),a=e(16),d=e(4),c=e(52),u=e(53),m=e(54),y=e(55),S=e(43),O=e(92),k=e(93);function g(ue,L){var re=d(ue);if(c){var le=c(ue);L&&(le=a(le).call(le,function(oe){return u(ue,oe).enumerable})),re.push.apply(re,le)}return re}var v={user_id:"",trace_id:"",duration:0,start_time:0,history:[]};t.exports=function(){function ue(L){O(this,ue),this.clientProto=L,this.reset()}return k(ue,[{key:"reset",value:function(){this.traceData=s({},v),this.traceData.history=[]}},{key:"start",value:function(){this.reset(),this.traceData.start_time=i()}},{key:"updateBegin",value:function(L){this.traceData.history.push(function(re){for(var le=1;le<arguments.length;le++){var oe,he,Ie=arguments[le]!=null?arguments[le]:{};le%2?o(oe=g(Object(Ie),!0)).call(oe,function(ie){r(re,ie,Ie[ie])}):m?y(re,m(Ie)):o(he=g(Object(Ie))).call(he,function(ie){S(re,ie,u(Ie,ie))})}return re}({head:"",body:"",start_time:i(),httpdns:!1,index:0},L))}},{key:"updateComplete",value:function(L){var re;o(re=this.traceData.history).call(re,function(le){le.target===L.target&&(s(le,L),le.duration=i()-le.start_time)})}},{key:"end",value:function(L){var re;if(this.traceData.succeed=L,this.traceData.history=a(re=this.traceData.history).call(re,function(oe){return oe.code!==void 0}),this.traceData.history.length!==0){this.traceData.duration=i()-this.traceData.start_time;var le=this.clientProto.checkNetworkAvailable();this.traceData.net_type=0,this.traceData.net_connect=le,this.clientProto.reporter.report("nim_sdk_lbs_records",this.traceData),this.reset()}else this.reset()}}]),ue}()},function(t,n,e){var r=e(22),s=e(51),i=e(60),o=e(8),a=e(314),d=e(6),c=e(3),u=e(24),m=e(16),y=e(7),S=e(15),O=e(26),k=e(2),g=e(126),v=e(4),ue=e(52),L=e(53),re=e(54),le=e(55),oe=e(43);function he(_e,er){var Pt=v(_e);if(ue){var ar=ue(_e);er&&(ar=m(ar).call(ar,function(pr){return L(_e,pr).enumerable})),Pt.push.apply(Pt,ar)}return Pt}function Ie(_e){for(var er=1;er<arguments.length;er++){var Pt,ar,pr=arguments[er]!=null?arguments[er]:{};er%2?k(Pt=he(Object(pr),!0)).call(Pt,function(lr){s(_e,lr,pr[lr])}):re?le(_e,re(pr)):k(ar=he(Object(pr))).call(ar,function(lr){oe(_e,lr,L(pr,lr))})}return _e}var ie=e(35).fn,Ne=e(0),Ve=e(11),Ce=e(157).V2NIMConnectStatus;function Ue(_e,er){var Pt,ar,pr,lr,or=this,xe=Ve.getDefaultLinkUrl(or.options.secure);or.socketUrls=[xe],or.reporterHookLBS.updateComplete({target:er,code:200,body:_e}),or.reporterHookLBS.end(!0),or.reporter.reportTraceUpdateV2("login",{operation_type:"HTTP",target:er,code:200,net_connect:or.checkNetworkAvailable(),succeed:!0}),or.msgStatEnable=!!_e.common["msg.stat.enable"],or.msgStatEnable&&(or.msgDelayTimer=u(O(ar=or.doReportMsgDelay).call(ar,or),1e4)),_e.common&&_e.common.link&&k(pr=_e.common.link).call(pr,function(dr){or.socketUrls.unshift(Ve.formatSocketUrl({url:dr,secure:or.options.secure}))}),_e.common&&_e.common["link.default"]&&k(lr=_e.common["link.default"]).call(lr,function(dr){var Lt,cr;dr=Ve.formatSocketUrl({url:dr,secure:or.options.secure}),y(Lt=or.socketUrls).call(Lt,dr)===-1&&(or.socketUrls=d(cr=or.socketUrls).call(cr,dr))}),or.socketUrls=m(Pt=or.socketUrls).call(Pt,function(dr,Lt,cr){return y(cr).call(cr,dr)===Lt});try{Ve.uploadUrl=_e.nosup[0]}catch{}if(Ve.chunkUploadUrl=_e["nos-chunk"]||Ve.chunkUploadUrl||"",or.logger.info("link::refreshSocketUrl: ".concat(er," ajax load , got socket urls "),or.socketUrls),Ve.hasLocalStorage){_e.common["lbs.backup"]&&or.options.lbsBackup&&localStorage.setItem("nim_lbs_backup",o(_e.common["lbs.backup"]));var nr=Ne.get(_e,"common.report.apierror.on");_e.common.report&&localStorage.setItem("nim_lbs_fail_report_on",nr===!1?"0":"1")}if(_e.common.socketConcurrent){var ir=_e.common.socketConcurrent;typeof ir=="number"&&ir>=1&&ir<=3&&(or.options.socketConcurrent=ir,or.imsocket.setConfig({socketConcurrent:ir}))}}function qe(_e,er){if(this.statusProtector.getConnectStatus()===Ce.V2NIM_CONNECT_STATUS_DISCONNECTED)return c.reject(new Error("already disconnected"));if(_e>=er){this.logger.warn("doRequestBackupLbsUrls backup lbs all tried");var Pt=Ve.getDefaultLinkUrl(this.options.secure);return this.logger.warn("doRequestBackupLbsUrls: use default socket link",Pt),this.socketUrls=[Pt],this.reporterHookLBS.end(!1),c.resolve()}return this.logger.warn("doRequestBackupLbsUrls: wait for next lbs request"),c.reject(new Error("lbs request failed"))}function Oe(_e,er){var Pt=er.status||10001,ar=typeof er=="string"?er:er&&er.message?er.message:"Unknown error";this.reporterHookLBS.updateComplete({target:_e,code:er.status||er.code||0,body:er&&er.message||""}),this.reporter.reportTraceUpdateV2("login",{operation_type:"HTTP",target:_e,code:Pt,description:ar,net_connect:this.checkNetworkAvailable(),succeed:!1})}function $e(_e){var er=this;if(!(_e&&_e.length>0))throw new Error("No  lbs url to try");var Pt=0,ar=0,pr=!1,lr=null;er.logger.log("doRequestBackupLbsUrls: use lbs url in index ",Pt,_e),er.reporterHookLBS.start();var or=function(xe){var nr=_e[xe],ir=new Date().getTime();return er.reporterHookLBS.updateBegin({target:nr,index:xe}),er.promiseAbortManager.add(er.doRequestLbs(nr)).then(function(dr){if(lr&&clearInterval(lr),pr===!1)return Ue.call(er,dr,nr),pr=!0,c.resolve()}).catch(function(dr){return ar+=1,er.logger.warn("doRequestBackupLbsUrls: ".concat(nr," ajax lbs error"),dr),Oe.call(er,nr,dr,ir),qe.call(er,ar,_e.length)})};return new c(function(xe,nr){lr=g(function(){if(!(Pt>=_e.length))return er.statusProtector.getConnectStatus()===Ce.V2NIM_CONNECT_STATUS_DISCONNECTED?(lr&&clearInterval(lr),void nr(new Error("already disconnected"))):void or(Pt++).then(function(){lr&&clearInterval(lr),xe()}).catch(function(){});lr&&clearInterval(lr)},2e3),or(Pt++).then(function(){lr&&clearInterval(lr),xe()}).catch(function(){})})}ie.connect=function(){Ve.isBrowser&&this.reporter.restore(),this.createConnectTime=i(),this.reporter.reportTraceCancel("login"),this.autoconnect?this.reporter.reportTraceStart("login",{user_id:this.options.account,action:"auto_login"}):this.reporter.reportTraceStart("login",{user_id:this.options.account,action:"manual_login",process_id:this.processId}),this.reporter.reportTraceUpdateV2("login",{code:0,description:o(Ie(Ie({},this.options),{},{account:"***",token:"***"}),function(_e,er){return _e===""||typeof er!="function"&&r(er)!=="object"?er:void 0}),operation_type:"conf_init",net_connect:this.checkNetworkAvailable(),succeed:!0,target:""}),a(ie).connect.call(this)},ie.onConnect=function(){this.reporter.reportTraceUpdateV2("login",{operation_type:"TCP",target:this.url,code:200,net_connect:this.checkNetworkAvailable(),succeed:!0}),a(ie).onConnect.call(this)},ie.onHandshakeFailed=function(_e,er){var Pt;this.reporter.reportTraceUpdateV2("login",{operation_type:"TCP",target:er,code:408,succeed:!1,net_connect:this.checkNetworkAvailable(),description:"ws_handshake_failed"}),this.reporter.reportTraceEnd("login",!1),this.logger.warn(d(Pt="link::onHandshakeFailed: shandshake failed, startTime: ".concat(_e,", targetUrl: ")).call(Pt,er))},ie.onConnectFailed=function(_e,er,Pt){var ar,pr;this.reporter.reportTraceUpdateV2("login",{operation_type:"TCP",target:Pt,code:408,succeed:!1,net_connect:this.checkNetworkAvailable(),description:"ws_connect_failed"}),this.reporter.reportTraceEnd("login",!1),this.logger.warn(d(ar=d(pr="link::onConnectFailed: connect failed due to ".concat(_e,", startTime: ")).call(pr,er,", targetUrl: ")).call(ar,Pt))},ie.onSocketError=function(_e,er,Pt){var ar,pr;this.reporter.reportTraceUpdateV2("login",{operation_type:"TCP",target:Pt,description:"ws_onerror:"+_e,code:0,net_connect:this.checkNetworkAvailable(),succeed:!1}),this.reporter.reportTraceEnd("login",!1),this.logger.warn(d(ar=d(pr="link::onSocketError: due to ".concat(_e,", startTime: ")).call(pr,er,", targetUrl: ")).call(ar,Pt))},ie.probeIp=function(){var _e=this,er=Ve.ipProbeAddr;return new c(function(Pt){var ar=0,pr=-1;function lr(){++ar===2&&(ar=-1,Pt(pr))}_e.adaptersRequest(er.ipv4,{timeout:2e3,onerror:lr,onload:function(or){pr++,lr()}}),_e.adaptersRequest(er.ipv6,{timeout:2e3,onerror:lr,onload:function(or){pr+=2,lr()}}),u(function(){ar||pr===-1||(ar=-1,Pt(pr))},100)})},ie.refreshSocketUrl=function(){var _e=this;return this.statusProtector.emit("auth/loginLifeCycleAddressing"),Ve.isWeixinApp?this.doRefreshSocketUrl(2):this.options.ipVersion===2?this.probeIp().then(function(er){return _e.doRefreshSocketUrl(er)}):this.doRefreshSocketUrl(this.options.ipVersion)},ie.doRefreshSocketUrl=function(_e){var er,Pt,ar=this.options.lbsUrl||Ve.lbsUrl;_e!==1&&_e!==2&&(_e=0),Ve.ipVersion=_e;var pr=this.options.lbsBackupUrlsCustomer||[],lr=[];this.options.lbsBackup&&Ve.hasLocalStorage&&(lr=(lr=localStorage.getItem("nim_lbs_backup"))?JSON.parse(lr):[]);var or=d(er=d(Pt=[ar]).call(Pt,lr)).call(er,pr);return or=m(or).call(or,function(xe,nr,ir){return y(ir).call(ir,xe)===nr}),$e.call(this,or)},ie.doRequestLbs=function(_e){var er=this,Pt=this.options,ar=Ve.info;_e=_e+Ne.genUrlSep(_e)+"id="+Pt.account+"&sv="+ar.sdkVersion+"&pv="+ar.protocolVersion+"&networkType="+Ve.ipVersion+"&hostEnv="+Ve.hostEnv+"&k="+Pt.appKey,this.logger.info("doRequestLbs ".concat(S(_e).call(_e,0,-32)));var pr=this;return new c(function(lr,or){Ve.isWeixinApp?wx.request({url:_e,success:function(xe){var nr=xe&&xe.statusCode,ir=xe&&xe.data;nr===200?lr(ir):or(ir)},fail:function(xe){or(xe)}}):er.adaptersRequest(_e,{proxyUrl:Ne.url2origin(_e)+"/lbs/res/cors/nej_proxy_frame.html",timeout:Ve.xhrTimeout,onload:function(xe){try{var nr=JSON.parse(xe);lr(nr)}catch(ir){pr.logger.warn("doRequestLbs parse JSON Error. request lbs failed"),or(ir)}},onerror:function(xe){or(xe)}},{exception_service:1})})},ie.disconnect=function(){var _e=this,er=arguments.length>0&&arguments[0]!==void 0?arguments[0]:function(){};if(this.isConnected())return this.sendCmd("logout"),void u(function(){a(ie).disconnect.call(_e,er)},0);this.connecting?this.logger.warn("IMProtocolFn api disconnect:: connecting but exiting"):this.statusProtector.getConnectStatus()!==Ce.V2NIM_CONNECT_STATUS_DISCONNECTED?this.logger.warn("IMProtocolFn api disconnect:: has tried to disconnect"):this.logger.warn("IMProtocolFn api disconnect:: other logic entered");var Pt=a(ie);Pt.disconnect.call(this,er)},ie.notifyDisconnect=function(_e){a(ie).notifyDisconnect.call(this,_e)}},function(t,n,e){var r=e(57),s=e(51),i=e(58),o=e(3),a=e(8),d=e(24),c=e(26),u=e(7),m=e(2),y=e(16),S=e(4),O=e(52),k=e(53),g=e(54),v=e(55),ue=e(43);function L(qe,Oe){var $e=S(qe);if(O){var _e=O(qe);Oe&&(_e=y(_e).call(_e,function(er){return k(qe,er).enumerable})),$e.push.apply($e,_e)}return $e}function re(qe){for(var Oe=1;Oe<arguments.length;Oe++){var $e,_e,er=arguments[Oe]!=null?arguments[Oe]:{};Oe%2?m($e=L(Object(er),!0)).call($e,function(Pt){s(qe,Pt,er[Pt])}):g?v(qe,g(er)):m(_e=L(Object(er))).call(_e,function(Pt){ue(qe,Pt,k(er,Pt))})}return qe}var le=e(35).fn,oe=e(195),he=e(11),Ie="NIM-AllGrayscaleConfig",ie="NIM-AllMixStorePolicy",Ne=e(0);function Ve(){var qe=this;if(he.hasLocalStorage&&localStorage.getItem(Ie)){var Oe=null;try{Oe=JSON.parse(localStorage.getItem(Ie))[qe.options.appKey]}catch($e){qe.logger.error("appGrayConfig error",$e)}Oe&&(qe.appGrayConfig=Oe.timeStamp+1e3*Oe.ttl>new Date().getTime()?Oe:null,qe.appGrayConfig&&Ce.apply(qe))}qe.appGrayConfig||qe.sendCmd("getGrayscaleConfig",{providers:""},function($e,_e){if($e)qe.logger.error("Calculate Delay time, getGrayscaleConfig error",$e);else if(_e){var er=_e;if(er.grayConfig=JSON.parse(er.grayConfig),er.ttl=Number(er.ttl),er.timeStamp=new Date().getTime(),qe.appGrayConfig=er,he.hasLocalStorage){var Pt=localStorage.getItem(Ie)?JSON.parse(localStorage.getItem(Ie)):{};Pt[qe.options.appKey]=er,localStorage.setItem(Ie,a(Pt))}Ce.apply(qe)}else qe.logger.error("Calculate Delay time, getGrayscaleConfig error",_e)})}function Ce(){var qe=this;if(he.hasLocalStorage&&localStorage.getItem(ie)){var Oe=null;try{Oe=JSON.parse(localStorage.getItem(ie))[qe.options.appKey]}catch($e){qe.logger.error("mixStorePolicy error",$e)}Oe&&(qe.mixStorePolicy=Oe.timeStamp+1e3*Oe.ttl>new Date().getTime()?Oe:null,qe.mixStorePolicy&&Oe.ttl&&Oe.ttl!==0&&(qe.mixStorePolicyClock=d(c(Ce).call(Ce,qe),1e3*Oe.ttl)))}qe.mixStorePolicy||qe.sendCmd("getMixStorePolicy",{providers:qe.options.providers&&qe.options.providers.s3?[1,2]:[1]},function($e,_e){if($e){qe.logger.error("Calculate Delay time, getMixStorePolicy error",$e);try{_e=JSON.parse(localStorage.getItem("NIM-AllMixStorePolicy"))[qe.options.appKey]}catch(ar){qe.logger.error("error:","get last mixStorePolicy failed",ar)}}else if(_e){var er=_e;if(er.ttl=Number(er.ttl),er.providers=er.providers.split(","),er.nosPolicy=er.nosPolicy?JSON.parse(er.nosPolicy):null,er.s3Policy=er.s3Policy?JSON.parse(er.s3Policy):null,er.timeStamp=new Date().getTime(),qe.mixStorePolicy=er,er.ttl&&er.ttl!==0&&(qe.mixStorePolicyClock=d(c(Ce).call(Ce,qe),1e3*er.ttl)),he.hasLocalStorage){var Pt=localStorage.getItem(ie)?JSON.parse(localStorage.getItem(ie)):{};Pt[qe.options.appKey]=er,localStorage.setItem(ie,a(Pt))}}else qe.logger.error("Calculate Delay time, mixStorePolicy error",_e)})}function Ue(qe){var Oe=this,$e=this;qe.code===399?(this.logger.warn("pendingLoginFailed:399, refresh LBS url and reconnecting"),$e.forceDisconnect(),$e.doRefreshSocketUrl(he.ipVersion).then(function(){$e.reconnect()}).catch(function(){Oe.logger.warn("pendingLoginFailed:399, refresh LBS url failed")})):qe.code===398?(this.logger.warn("pendingLoginFailed:398 try to reconnect socket link，backoff set min 5s"),$e.backoff.setMin(5e3),$e.reconnect()):(this.logger.error("pendingLoginFailed: ",qe.code,qe),$e.onAuthError(qe,"link::onLogin"))}le.assembleLogin=function(){var qe=this.assembleIMLogin();return this.addPushInfo instanceof Function?this.addPushInfo(qe):o.resolve({login:qe})},le.login=i(r.mark(function qe(){var Oe,$e,_e,er=this;return r.wrap(function(Pt){for(;;)switch(Pt.prev=Pt.next){case 0:return Oe=this,Pt.next=3,Oe.assembleLogin();case 3:if($e=Pt.sent,!(_e=this.socket&&this.socket.socket&&this.socket.socket.sessionid)){Pt.next=13;break}if(this.socketIds||(this.socketIds={}),!this.socketIds[_e]){Pt.next=10;break}return this.logger.warn("onConnect::repeat login",_e),Pt.abrupt("return");case 10:this.socketIds[_e]=!0,Pt.next=14;break;case 13:this.logger.warn("onConnect:: no socketId ",this.socket&&this.socket.socket);case 14:this.logger.warn("link::doLogin: "+_e+" appLogin is "+$e.login.appLogin),Oe.sendCmd("login",re({},$e),function(ar,pr){if(ar){var lr=Ne.get(ar,"event.uploadCode")||ar&&ar.code;lr=typeof lr!="number"?408:lr;var or=Ne.get(ar,"event.disconnectReason"),xe=or?a({disconnect_reason:or}):ar&&ar.message||"login failed";Oe.reporter.reportTraceUpdateV2("login",{operation_type:"protocol",target:"2-3",code:lr,description:xe,net_connect:Oe.checkNetworkAvailable(),succeed:!1}),Oe.reporter.reportTraceEnd("login",!1),Ue.call(Oe,ar),Oe.statusProtector.emit("auth/loginLifeCycleLoginFail",ar)}else Oe.reporter.reportTraceUpdateV2("login",{operation_type:"protocol",target:"2-3",succeed:!0,net_connect:Oe.checkNetworkAvailable(),code:200}),Oe.reporter.reportTraceEnd("login",!0),Oe.resetReconnectStatus(),er.heartbeatFail=0,er.hasLogin=!0,er.autoconnect=!0,Oe.startHeartbeat(),Oe.initOnlineListener(),Oe.statusProtector.emit("auth/loginLifeCycleLoginSucc"),Oe.afterLogin(pr)});case 16:case"end":return Pt.stop()}},qe,this)})),le.afterLogin=function(qe){var Oe=this;this.sendCmd("getNosCdnHost",{}),(typeof Ne.get(this.options,"privateConf.isMixStoreEnable")=="boolean"?this.options.privateConf.isMixStoreEnable:he.privateConf.isMixStoreEnable)&&Ve.apply(this),this.initPush instanceof Function&&this.initPush();var $e=this.db;if($e.enable){var _e=this.account;this.options.appendAppKeyForDBName&&(_e+="-"+this.options.appKey),this.db.init(_e).then(function(){Oe.notifyLogin(qe),Oe.syncData()},function(er){Oe.logger.warn("link::afterLogin: no db",er),$e.reset(!1),Oe.notifyLogin(qe),Oe.syncData()})}else this.logger.info("link::afterLogin: no db"),this.notifyLogin(qe),this.syncData()},le.getFileAuthToken=function(qe){var Oe=this,$e=Oe.mixStorePolicy.nosPolicy.authPolicy.policyType;$e!==-1?u($e).call($e,qe.type)<0?Oe.logger.error("this type Token error not support"):qe.type!=3||qe.urls&&qe.urls.length?Oe.sendCmd("getBackSourceToken",{mixAuthTokenReq:qe},function(_e,er){if(_e)return Oe.logger.error("getBackSourceToken error",_e),_e;qe.done&&qe.done(er)}):Oe.logger.error("urls is Required when type 3"):Oe.logger.error("don't need token")},le.processAuth=function(qe){switch(qe.cmd){case"login":qe.error||(qe.content=qe.content||{},this.loginAndroidPush&&this.loginAndroidPush(qe.content.aosPushInfo||{}),qe.obj=qe.content.loginRes,this.connectionId=qe.content.loginRes.connectionId,this.onLoginPortsChange(qe,2));break;case"kicked":return void this.onKicked(qe);case"multiPortLogin":this.onLoginPortsChange(qe,qe.content.state);break;case"kick":qe.error||(qe.obj.deviceIds=qe.content.deviceIds)}},le.onLoginPortsChange=function(qe,Oe){var $e=this,_e=qe.content.loginPorts;if(_e&&_e.length){var er=!0;switch(Oe){case 2:er=!0;break;case 3:er=!1}m(_e).call(_e,function(Pt){Pt.type=oe.reverseType(Pt.type),Pt.customClientType&&(Pt.customClientType=+Pt.customClientType),Pt.time=+Pt.time,Pt.online=er}),(_e=y(_e).call(_e,function(Pt){return Pt.connectionId!==$e.connectionId})).length&&($e.logger.info("link::onLoginPortsChange:",_e),$e.options.onloginportschange(_e))}},le.kickedReasons=["","samePlatformKick","serverKick","otherPlatformKick","silentlyKick"],le.kickedMessages=["","不允许同一个帐号在多个地方同时登录","被服务器踢了","被其它端踢了","悄悄被踢"]},function(t,n,e){var r=e(57),s=e(58),i=e(789),o=e(3),a=e(26),d=e(6),c=e(754),u=e(37),m=e(2),y=e(4),S=e(122),O=e(7),k=e(71),g=e(16),v=e(9),ue=e(121),L=e(803),re=e(24),le=e(32),oe=e(90),he=e(35).fn,Ie=e(0),ie=e(41),Ne=Ie.undef,Ve=Ie.objs2ids,Ce=Ie.objs2accounts,Ue=Ie.teams2ids,qe=e(154),Oe=Ie.getGlobal(),$e=e(107).EMSyncType;he.beforeSync=function(){var _e=this.db;return _e.enable?_e.clearSendingMsgs():o.resolve()},he.syncData=function(){var _e=this,er=_e.db,Pt=_e.options,ar=er.enable;function pr(lr){var or;_e.syncPromiseArray=[],_e.syncResult={},_e.syncTeamMembersPromiseArray=[],_e.syncSuperTeamMembersPromiseArray=[],_e.syncTeamMembersResult={},_e.checkNosReqNum=0,_e.getNosOriginUrlReqNum=0,Ie.verifyBooleanWithDefault(Pt,"syncRelations syncFriends syncFriendUsers syncTeams syncSuperTeams syncRoamingMsgs syncSuperTeamRoamingMsgs syncMsgReceipts syncExtraTeamInfo syncExtraSuperTeamInfo syncAvSignal",!0,"","sync::syncData"),Ie.verifyBooleanWithDefault(Pt,"syncFilter syncTeamMembers syncSuperTeamMembers",!1,"","sync::syncData");var xe={};lr=lr||{},Oe._nimForceSyncIM&&(_e.logger.warn("sync::syncData: nimForceSyncIM"),delete lr.teams,Oe._nimForceSyncIM=!1),xe.myInfo=lr.myInfo||0,xe.deleteMsgSelf=lr.deleteMsgSelf||0,xe.offlineMsgs=0,Pt.syncRelations&&(xe.relations=lr.relations||0),Pt.syncFriends&&(xe.friends=lr.friends||0),Pt.syncFriendUsers&&(xe.friendUsers=lr.friendUsers||0),Pt.syncRobots&&(xe.robots=lr.robots||0),Pt.syncTeams&&(xe.teams=lr.teams||0),Pt.syncSuperTeams&&(xe.superTeams=lr.superTeams||0),Pt.syncStickTopSessions&&(xe.stickTopSessions=lr.stickTopSessions||0),Pt.syncSessionUnread&&(xe.sessionAck=ar&&lr.sessionAck||0,xe.superTeamSessionAck=ar&&lr.superTeamSessionAck||0),Pt.syncRoamingMsgs&&(xe.roamingMsgs=ar&&lr.roamingMsgs||lr.roamingMsgs||0),Pt.syncSuperTeamRoamingMsgs&&(xe.superTeamRoamingMsgs=ar&&lr.superTeamRoamingMsgs||0),Pt.syncMsgReceipts&&(xe.msgReceipts=lr.msgReceipts||0),Pt.syncExtraTeamInfo&&(xe.myTeamMembers=lr.myTeamMembers||0),Pt.syncExtraSuperTeamInfo&&(xe.myInfoInSuperTeams=lr.myInfoInSuperTeams||0),Pt.syncBroadcastMsgs&&(xe.broadcastMsgs=lr.broadcastMsg||0),xe.donnop=lr.donnop||0,xe.deleteMsg=lr.deleteMsg||0,xe.deleteSuperTeamMsg=lr.deleteSuperTeamMsg||0,xe.sessionHistoryMsgsDelete=lr.sessionHistoryMsgsDelete||0,xe.netcallMsgs=0,Pt.syncFilter&&(xe.filterMsgs=0),Pt.syncAvSignal&&(xe.avSignal=0);var nr=a(or=_e.onSyncData).call(or,_e);nr.isImSyncDataCb=!0,_e.logger.info("syncData:: start sync",xe),_e.reporterHook.emit("reporter/syncStart"),_e.sendCmd("sync",{sync:xe,isImSyncDataObj:!0},nr)}_e.syncing=!0,_e.logger.log("sync::syncData: syncing = true"),ar?_e.beforeSync().then(function(){return _e.db.getTimetags()}).then(function(lr){pr(lr)},function(){pr()}):pr(_e.timetags)},he.onSyncData=function(_e){_e&&(_e.callFunc="sync::onSyncData",this.onCustomError("SYNC_DATA_ERROR",_e))},he.processSync=function(_e){switch(this.logger.log("sync::processSync cmd: ".concat(_e.cmd)),_e.cmd){case"syncDone":if(_e.error){var er,Pt=Ie.get(_e.error,"message"),ar=Ie.get(_e.error,"code");this.logger.error(d(er="sync::processSync syncDoneError errMsg: ".concat(Pt,", errCode: ")).call(er,ar)),this.logger.error("sync::processSync disconnect because syncDone failed");var pr=ie.syncError({errMsg:Pt,errCode:ar});this.shouldReconnect=!1,this.markAllCallbackInvalid(pr),this.notifyDisconnect(pr)}else this.timetags.sync=_e.content.timetag,this.reporterHook.emit("reporter/syncRecv"),this.onSyncDone();break;case"syncTeamMembersDone":this.onSyncTeamMembersDone();break;case"syncSuperTeamMembersDone":this.onSyncSuperTeamMembersDone()}},he.onSyncDone=function(){var _e,er,Pt,ar,pr,lr,or,xe,nr,ir,dr,Lt,cr,mr,tr,At,kt,Dt,gr,yr,vr,Ir,Mr,Ar,Fr,Dr,Or,Sn,Rr,Wr,Er=this,Ur=Er.db,Zr=Ur.enable,In=Er.options,An=Er.syncPromiseArray,Zn=Er.syncResult;function Nn(){if(An){Er.logger.info("sync::onSyncDone: after sync",Ie.promises2cmds(An)),An=[],er=Zn.blacklist||[],Pt=Zn.invalidBlacklist||[],ar=Zn.mutelist||[],pr=Zn.invalidMutelist||[],lr=Zn.friends,nr=Zn.myTeamMembers,ir=Zn.mySuperTeamMembers,or=Zn.invalidFriends||[],xe=Zn.myInfo,dr=Zn.users,cr=Zn.superTeams,tr=Zn.invalidSuperTeams,Lt=Zn.teams,mr=Zn.invalidTeams||[],At=Zn.sessions||{},kt=c(u({},Er.sessionSet)),Dt=Zn.ackMap,Zn.msgReceipts,gr=Zn.roamingMsgs,yr=Zn.offlineMsgs,vr=Zn.offlineFilterMsgs,Mr=Zn.offlineSysMsgs,Ar=Zn.offlineCustomSysMsgs,Fr=Zn.offlineFilterSysMsgs,Dr=Zn.offlineFilterCustomSysMsgs,Or=Zn.sysMsgUnread,Sn=Zn.sessionsWithMoreRoaming,Wr=Zn.clearServerHistoryMsgs||[];var Ro=o.resolve();(function(){if(Zr){var Lo,Ai=[Gi()];At&&m(Lo=y(At)).call(Lo,function(On){Ai.push(Ur.putSession(At[On]))}),Ro=o.all(Ai).then(function(){var On,Qo=d(On=[]).call(On,i(y(Dt||{})),i(y(At||{})));Qo=g(Qo).call(Qo,function(vi,wi,Io){return O(Io).call(Io,vi)===wi});var ei=[];return m(Qo).call(Qo,function(vi){var wi,Io=At[vi];(Io.lastMsg||Io.ack)&&(wi=(wi=Io.ack?o.resolve(Io):Ur.getSession(Io.id)).then(function(eo){var Mi=eo.ack||0;return Ur.getMsgCountAfterAck({shouldCountNotifyUnread:Er.options.shouldCountNotifyUnread,sessionId:vi,ack:Mi}).then(function(Ii){return eo.unread=Ii||0,At[vi]=Er.mergeSession(eo),Ur.updateSession(eo)})}),ei.push(wi))}),o.all(ei)}).then(function(){var On=[];return Er.saveAck.p2pTeam&&On.push(Ur.updateSessionAck(Er.saveAck.p2pTeam).catch(function(Qo){return Er.logger.error("sessionAck::syncSessionAck::updatetimetag db",Qo),o.reject(Qo)})),Er.saveAck.superTeam&&On.push(Ur.updateSuperTeamSessionAck(Er.saveAck.superTeam).catch(function(Qo){return Er.logger.error("sessionAck::syncSuperTeamSessionAck::updatetimetag db",Qo),o.reject(Qo)})),o.all(On)})}else if(At){var As,Yn,Ks;m(As=[gr,yr]).call(As,function(On){On&&m(On).call(On,function(Qo){var ei;(Yn=At[Qo.sessionId]).unread=Yn.unread||0,Yn.unreadMsgs=Yn.unreadMsgs||[],Ks=Yn.ack||0,m(ei=Qo.msgs).call(ei,function(vi){if(!(Ks>=vi.time))if(vi.type==="notification"){var wi;try{wi=Er.options.shouldCountNotifyUnread(vi)}catch(Io){throw Er.logger.error("userOption:shouldCountNotifyUnread function error",Io),Io}wi&&Yn.unread++}else vi.flow==="in"&&vi.isUnreadable!==!1&&(Yn.unread++,Yn.unreadMsgs.push(vi))}),Er.mergeSession(Yn)})})}})(),Er.syncDonePromiseArray=Er.syncDonePromiseArray||[],Ro.then(function(){if(Zr&&!Er.hasSynced)Er.hasSynced=!0,function(){In.syncRelations&&(_e=Ur.getRelations().then(function(On){er=On[0],ar=On[1],er.invalid=Pt,ar.invalid=pr}).catch(function(On){return On._msg="on relations error",Er.logger.error("sync::syncRelation: ",On),o.reject(On)}),An.push(_e)),In.syncFriends&&(_e=Ur.getFriends().then(function(On){(lr=On).invalid=or}).catch(function(On){return On._msg="on friends error",Er.logger.error("sync::syncFriends: ",On),o.reject(On)}),An.push(_e)),Ne(xe)&&(_e=Ur.getUser(Er.account).then(function(On){xe=On}).catch(function(On){return On._msg="on myInfo error",Er.logger.error("sync::syncMyInfo: ",On),o.reject(On)}),An.push(_e)),In.syncFriendUsers&&(_e=Ur.getFriends().then(function(On){return v(On).call(On,function(Qo){return Qo.account})}).then(function(On){return Ur.getUsers({accountIds:On})}).then(function(On){dr=On}).catch(function(On){return On._msg="on users error",Er.logger.error("sync::syncFriendUser: ",On),o.reject(On)}),An.push(_e)),In.syncTeams&&(_e=Ur.getTeams().then(function(On){(Lt=On).invalid=mr}).catch(function(On){return On._msg="on teams error",Er.logger.error("sync::syncTeams: ",On),o.reject(On)}),An.push(_e)),In.syncSuperTeams&&(_e=Ur.getSuperTeams().then(function(On){(cr=On).invalid=tr}).catch(function(On){return On._msg="on superteams error",Er.logger.error("sync::syncSuperTeams: ",On),o.reject(On)}),An.push(_e)),_e=Ur.getTeamMembersByAccount(Er.account).then(function(On){nr=On,Er.mergeMyTeamMembers(On)}).catch(function(On){return Er.logger.error("sync::getTeamMembersByAccount: ",On),o.reject(On)}),An.push(_e),_e=Ur.getSuperTeamMembersByAccount(Er.account).then(function(On){ir=On,Er.mergeMySuperTeamMembers(On)}).catch(function(On){return Er.logger.error("sync::getSuperTeamMembersByAccount: ",On),o.reject(On)}),An.push(_e),_e=Ur.getDonnop().then(function(On){Er.mergeDonnop(On)}).catch(function(On){return Er.logger.error("sync::donnop: ",On),o.reject(On)}),An.push(_e),_e=Ur.getAllSessions().then(function(On){At=On}).catch(function(On){return Er.logger.error("sync::getSession: ",On),o.reject(On)}),An.push(_e),_e=Ur.getSysMsgUnread().then(function(On){Or=On}).catch(function(On){return On._msg="on sysMsgUnread error",Er.logger.error("sync::getSysMsgUnread: ",On),o.reject(On)}),An.push(_e),An.push(Ur.getSessionsWithMoreRoaming().then(function(On){Sn=On}))}();else{var Lo,Ai,As=[];m(Lo=y(At)).call(Lo,function(On){(Ai=At[On]).lastMsg&&As.push(Ai)}),At=S(As).call(As,function(On,Qo){return Qo.updateTime-On.updateTime})}var Yn=o.all(An);function Ks(On){var Qo;On||(Er.syncDonePromiseSuccessCount+=1);var ei,vi=O(Qo=Er.syncDonePromiseArray).call(Qo,Yn);vi>-1&&k(ei=Er.syncDonePromiseArray).call(ei,vi,1),Er.logger.log("afterSync::syncDonePromiseHandler syncPromiseArray length: ",Er.syncDonePromiseArray.length,"success count: ",Er.syncDonePromiseSuccessCount),Er.syncDonePromiseArray.length===0&&Er.syncDonePromiseSuccessCount>0?(Er.logger.log("onSyncDone afterSync last syncDonePromsie. Execute taskAfterSync and notifyData"),function(){Er.logger.info("sync::onSyncDone: taskAfterSync"),function(){if(Zn.deleteMsgSysMsgs){var Io,eo={};gr&&m(gr).call(gr,function($o){eo[$o.sessionId]=$o});var Mi={};yr&&m(yr).call(yr,function($o){Mi[$o.sessionId]=$o});var Ii=Er.api;if(m(Io=Zn.deleteMsgSysMsgs).call(Io,function($o){var Os;m(Os=$o.sysMsgs).call(Os,function(al){var Ua=al.msg,Tc=Ua.sessionId;$o.type==="roaming"&&eo[Tc]?eo[Tc].msgs=Ii.cutMsgs(eo[Tc].msgs,Ua):Mi[Tc]&&(Mi[Tc].msgs=Ii.cutMsgs(Mi[Tc].msgs,Ua))})}),!Ur.enable){var _u,ws=d(_u=[]).call(_u,i(gr||[]),i(yr||[]));m(ws).call(ws,function($o){if($o.msgs.length){var Os=Er.genSessionByMsgs($o.msgs);Er.cacheSyncedSession(Os),At.unshift(Os)}else{var al=L(At).call(At,function(Ua){return Ua.id===$o.sessionId});k(At).call(At,al,1)}});var na={};m(At).call(At,function($o){if(na[$o.id]){var Os=$o.lastMsg.time>na[$o.id].lastMsg.time?$o.lastMsg:na[$o.id].lastMsg;na[$o.id]=$o,na[$o.id].lastMsg=Os}else na[$o.id]=$o}),At=c(na),At=S(At).call(At,function($o,Os){return Os.updateTime-$o.updateTime})}}}(),Rr=Er.syncResult.stickTopSessions||[],m(Rr).call(Rr,function(Io){Io.isTop=!0}),m(At).call(At,function(Io){var eo=Er.sessionSet[Io.id];eo&&eo.isTop&&(Io.isTop=!0),ue(Rr).call(Rr,function(Mi){return Mi.id===Io.id})&&(Io.isTop=!0)});var wi=[Er.deleteMsgOfflineRoaming(Zn.deleteMsgSysMsgs,At)];return Wr&&m(Wr).call(Wr,function(Io){wi.push(function(eo,Mi){var Ii;Er.logger.info("sync::taskAfterSync:sessionHistoryMsgsDelete ".concat(eo)),Mi=Mi||new Date().getTime();var _u=g(At).call(At,function(Os){return Os.id===eo}),ws=Er.getSessionInCache(eo);Ii=ws||_u[0];var na=In.rollbackClearMsgsUnread!==!1,$o=[];return Ur.enable&&$o.push(Ur.deleteMsgsBySessionId({sessionId:eo,end:Mi})),na&&Ii&&(Ii.lastMsg=null,Ii.unread=0,Ii=Er.mergeSession(Ii),Ur.enable&&$o.push(Ur.updateSession(Ii))),o.all($o)}(Io.sessionId,Io.time))}),o.all(wi)}().then(Iu,function(wi){Er.logger.error("taskAfterSync syncDBDataPromise error:",wi),wi.callFunc="sync::onSyncDone",wi.message="taskAfterSync+notifyData 出错",Er.onCustomError("SYNC_SESSION_ACK_ERROR",wi)})):On?(Er.logger.error("onSyncDone afterSync syncDonePromise Error:",On),On.callFunc="sync::onSyncDone",On.message="pullFullData 出错",Er.onCustomError("SYNC_SESSION_ACK_ERROR",On)):Er.logger.log("onSyncDone afterSync syncDonePromise success, wait for next syncDonePromise")}Er.syncDonePromiseArray.length===0&&(Er.syncDonePromiseSuccessCount=0),Er.syncDonePromiseArray.push(Yn),Yn.then(function(){return Ks()}).catch(function(On){return Ks(On)})})}else Er.logger.warn("sync::onSyncDone: after sync --no promiseArray")}function Gi(){var Ro=[];return gr&&m(gr).call(gr,function(Lo){var Ai;Ro=d(Ai=[]).call(Ai,i(Ro),i(Lo.msgs))}),yr&&m(yr).call(yr,function(Lo){var Ai;Ro=d(Ai=[]).call(Ai,i(Ro),i(Lo.msgs))}),Ro.length?Ur.putMsg(Ro).then(function(){return Ro}):o.resolve(Ro)}function Iu(){re(Ki,0)}function Ki(){var Ro,Lo,Ai=[],As=[];if(er&&er.length&&(Er.logger.info("sync::notifyDataAsync: on blacklist",Ce(er)),Er.reporterHook.emit("reporter/syncItemComplete",$e.kSyncType3_8),In.onblacklist(er)),ar&&ar.length&&(Er.logger.info("sync::notifyDataAsync: on mutelist",Ce(ar)),In.onmutelist(ar)),lr&&(Er.logger.info("sync::notifyDataAsync: on friends",Ce(lr)),Er.reporterHook.emit("reporter/syncItemComplete",$e.kSyncType12_5),In.onfriends(lr)),xe&&(Er.logger.info("sync::notifyDataAsync: on myInfo"),Er.myInfo=xe,Er.reporterHook.emit("reporter/syncItemComplete",$e.kSyncType3_109),In.onmyinfo(Ie.copy(xe))),nr){Er.logger.info("sync::notifyDataAsync: on myTeamMembers",nr),Er.reporterHook.emit("reporter/syncItemComplete",$e.kSyncType8_126);var Yn=Ie.simpleClone(nr);le(Yn)||(Yn=[Yn]),In.onMyTeamMembers(Yn)}if(ir){Er.logger.info("sync::notifyDataAsync: on mySuperTeamMembers",ir),Er.reporterHook.emit("reporter/syncItemComplete",$e.kSyncType21_111);var Ks=Ie.simpleClone(ir);le(Ks)||(Ks=[Ks]),In.onMySuperTeamMembers(Ks)}dr&&(m(dr).call(dr,function(eo){Er.mergeUser(eo)}),Er.logger.info("sync::notifyDataAsync: on users",Ce(dr)),Er.reporterHook.emit("reporter/syncItemComplete",$e.kSyncType12_6),In.onusers(dr)),Lt&&(Er.logger.info("sync::notifyDataAsync: on teams",Ue(Lt)),In.onteams(Lt),Er.reporterHook.emit("reporter/syncItemComplete",$e.kSyncType8_109)),cr&&(Er.logger.info("sync::notifyDataAsync: onSuperTeams",Ue(cr)),In.onSuperTeams(cr),Er.reporterHook.emit("reporter/syncItemComplete",$e.kSyncType21_109)),Er.reporterHook.emit("reporter/syncItemComplete",$e.kSyncType4_12),Er.reporterHook.emit("reporter/syncItemComplete",$e.kSyncType4_14),Er.reporterHook.emit("reporter/syncItemComplete",$e.kSyncType4_20),Er.reporterHook.emit("reporter/syncItemComplete",$e.kSyncType4_21),Er.reporterHook.emit("reporter/syncItemComplete",$e.kSyncType7_15),At&&At.length?(At=v(At).call(At,function(eo){return Er.mergeSession(eo),oe(qe).call(qe,eo)}),At=g(At).call(At,function(eo){return!eo.isDeleted}),Er.logger.info("sync::notifyDataAsync: on sessions",Ve(At),Ie.secureOutput("session",At)),!Zr&&Er.timetags&&Er.timetags.roamingMsgs?In.onsessions(g(kt).call(kt,function(eo){return qe.isComplete(eo)})):In.onsessions(At)):!Zr&&kt.length&&(Er.logger.info("sync::notifyDataAsync: on sessions",Ve(At),Ie.secureOutput("session",At)),In.onsessions(g(kt).call(kt,function(eo){return qe.isComplete(eo)}))),Rr&&Rr.length&&(Rr=v(Rr).call(Rr,function(eo){var Mi=Er.getSessionInCache(eo.id);return Mi?(Mi.isTop=!0,eo=Er.mergeSession(Mi),oe(qe).call(qe,Mi)):(eo=Er.mergeSession(eo),oe(qe).call(qe,eo))}),Er.logger.info("sync::notifyDataAsync: onStickTopSessions",Ve(Rr),Ie.secureOutput("session",Rr)),Er.reporterHook.emit("reporter/syncItemComplete",$e.kSyncType4_23),In.onStickTopSessions(Rr)),gr&&m(gr).call(gr,function(eo){eo.scene==="superTeam"?As.push(eo.timetag):Ai.push(eo.timetag),(Lo=eo.msgs).length&&(Er.logger.info("sync::notifyDataAsync: on roaming msgs",eo.sessionId,Lo.length),Er.reporterHook.emit("reporter/syncItemComplete",$e.kSyncType4_9),In.onroamingmsgs(eo))}),yr&&(Er.reporterHook.emit("reporter/syncItemComplete",$e.kSyncType4_4),Er.reporterHook.emit("reporter/syncItemComplete",$e.kSyncType4_17),m(yr).call(yr,function(eo){eo.scene==="superTeam"?As.push(eo.timetag):Ai.push(eo.timetag),(Lo=eo.msgs).length&&(Er.logger.info("sync::notifyDataAsync: on offline msgs",eo.sessionId,Lo.length,v(Lo).call(Lo,function(Mi){return Mi.idServer})),In.onofflinemsgs(eo))})),vr&&(Er.reporterHook.emit("reporter/syncItemComplete",$e.kSyncType4_100),m(vr).call(vr,function(eo){Ai.push(eo.timetag),(Lo=eo.msgs).length&&(Er.logger.info("sync::notifyDataAsync: on offline filter msgs",eo.sessionId,Lo.length),In.onofflinefiltermsgs(Lo))})),Sn&&(Er.logger.info("sync::notifyDataAsync: on sessionsWithMoreRoaming",Ve(Sn),Sn),Er.reporterHook.emit("reporter/syncItemComplete",$e.kSyncType4_22),In.onSessionsWithMoreRoaming(Sn));var On,Qo=[],ei=[];Zn.deleteMsgSysMsgs&&m(On=Zn.deleteMsgSysMsgs).call(On,function(eo){eo.type==="roaming"?Qo=d(Qo).call(Qo,eo.sysMsgs):ei=d(ei).call(ei,eo.sysMsgs)}),Qo.length&&(Ir=d(Ir=Ir||[]).call(Ir,Qo)),ei.length&&(Mr=d(Mr=Mr||[]).call(Mr,ei)),Ir&&(Er.logger.info("sync::notifyDataAsync: on roaming sys msgs",Ir.length),Er.reporterHook.emit("reporter/syncItemComplete",$e.kSyncType4_19),Er.reporterHook.emit("reporter/syncItemComplete",$e.kSyncType4_15),In.onroamingsysmsgs(Ir)),Mr&&(Er.logger.info("sync::notifyDataAsync: on offline sys msgs",Mr.length),In.onofflinesysmsgs(Mr)),Fr&&(Er.logger.info("sync::notifyDataAsync: on offline filter sys msgs",Fr.length),In.onofflinefiltersysmsgs(Fr)),Ar&&(Er.logger.info("sync::notifyDataAsync: on offline custom sys msgs",Ar.length),Er.reporterHook.emit("reporter/syncItemComplete",$e.kSyncType4_6),Er.reporterHook.emit("reporter/syncItemComplete",$e.kSyncType4_18),In.onofflinecustomsysmsgs(Ar)),Dr&&(Er.logger.info("sync::notifyDataAsync: on offline filter custom sys msgs",Dr.length),Er.reporterHook.emit("reporter/syncItemComplete",$e.kSyncType4_101),In.onofflinefiltercustomsysmsgs(Dr)),Or&&(Or=Ie.merge({},Er.sysMsgUnread,Or),Er.sysMsgUnread=Ie.merge({},Or),Er.logger.info("sync::notifyDataAsync: on sysMsgUnread",Or),Er.reporterHook.emit("reporter/syncItemComplete",$e.kSyncType4_6),In.onsysmsgunread(Or));var vi=Er.getPushNotificationMultiportConfig();Er.logger.info("sync::notifyDataAsync: on pushNotificationMultiportConfig",vi),Er.reporterHook.emit("reporter/syncItemComplete",$e.kSyncType4_13),In.onPushNotificationMultiportConfig(vi);var wi=As.length&&Math.max.apply(Math,As);if(Ro=Ai.length&&Math.max.apply(Math,Ai),Ur.enable){var Io=[];wi&&Io.push(Er.db.updateSuperTeamRoamingMsgTimetag(wi)),Ro&&Io.push(Er.db.updateRoamingMsgTimetag(Ro)),o.all(Io).then(yi).catch(yi)}else Er.timetags.superTeamRoamingMsgs=wi,Er.timetags.roamingMsgs=Ro||Er.timetags.roamingMsgs,yi();Er.syncPromiseArray=[],Er.syncResult={}}function yi(){Er.processUnsettledMsgs(),Er.msgPromise.then(function(){Er.canHandleDeletedMsgInSyncing=!0,re(function(){Er.processUnsettledSysMsgs()},0)}),Er.syncing&&In.onsyncdone(),Er.syncing=!1,Er.logger.log("sync::onsyncdone: syncing = false"),Er.reporterHook.emit("reporter/syncComplete"),Ur.enable&&In.syncTeamMembers&&Er.syncTeamMembers(Lt),Ur.enable&&In.syncSuperTeamMembers&&Er.syncSuperTeamMembers(cr)}An&&An.length?o.all(An).then(Nn).catch(function(Ro){Nn(),Er.logger.error(Ro),Ro.callFunc="sync::onSyncDone",Ro.message="afterSync syncNormalPromise 出错",Er.onCustomError("SYNC_promiseArray_ERROR",Ro)}):Nn()},he.syncTeamMembers=function(){var _e=s(r.mark(function er(Pt){var ar,pr,lr,or,xe,nr,ir,dr;return r.wrap(function(Lt){for(;;)switch(Lt.prev=Lt.next){case 0:if(pr=(ar=this).db,lr={},!pr.enable){Lt.next=33;break}return Lt.prev=4,Lt.next=7,pr.getTeamMemberTimetags();case 7:nr=Lt.sent,Lt.next=14;break;case 10:Lt.prev=10,Lt.t0=Lt.catch(4),ar.logger.error("sync::syncTeamMembers: getTeamMemberTimetags error",Lt.t0),nr={};case 14:if(le(Pt)){Lt.next=25;break}return Lt.prev=15,Lt.next=18,pr.getTeams();case 18:Pt=Lt.sent,Lt.next=25;break;case 21:Lt.prev=21,Lt.t1=Lt.catch(15),ar.logger.error("sync::syncTeamMembers: getTeams error",Lt.t1),Pt=[];case 25:m(Pt).call(Pt,function(cr){lr[cr.teamId]=0}),ir={},m(or=y(nr)).call(or,function(cr){var mr=cr.split("-")[1];ir[mr]=nr[cr]}),y(ir).length&&(lr=u(lr,ir)),ar.logger.log("sync::syncTeamMembers: getTeamMemberTimetags",lr),(dr=a(xe=ar.onSyncTeamMembers).call(xe,ar)).isImSyncDataCb=!0,ar.sendCmd("syncTeamMembers",{sync:lr,isImSyncDataObj:!0},dr);case 33:case"end":return Lt.stop()}},er,this,[[4,10],[15,21]])}));return function(er){return _e.apply(this,arguments)}}(),he.syncSuperTeamMembers=function(){var _e=s(r.mark(function er(Pt){var ar,pr,lr,or,xe,nr,ir,dr;return r.wrap(function(Lt){for(;;)switch(Lt.prev=Lt.next){case 0:if(pr=(ar=this).db,lr={},!pr.enable){Lt.next=33;break}return Lt.prev=4,Lt.next=7,pr.getSuperTeamMemberTimetags();case 7:nr=Lt.sent,Lt.next=14;break;case 10:Lt.prev=10,Lt.t0=Lt.catch(4),ar.logger.error("sync::syncSuperTeamMembers: getSuperTeamMemberTimetags error",Lt.t0),nr={};case 14:if(le(Pt)){Lt.next=25;break}return Lt.prev=15,Lt.next=18,pr.getSuperTeams();case 18:Pt=Lt.sent,Lt.next=25;break;case 21:Lt.prev=21,Lt.t1=Lt.catch(15),ar.logger.error("sync::syncSuperTeamMembers: getSuperTeams error",Lt.t1),Pt=[];case 25:m(Pt).call(Pt,function(cr){lr[cr.teamId]=0}),ir={},m(or=y(nr)).call(or,function(cr){var mr=cr.split("-")[1];ir[mr]=nr[cr]}),y(ir).length&&(lr=u(lr,ir)),ar.logger.log("sync::syncSuperTeamMembers: getSuperTeamMemberTimetags",lr),(dr=a(xe=ar.syncSuperTeamMembersCallBack).call(xe,ar)).isImSyncDataCb=!0,ar.sendCmd("syncSuperTeamMembers",{sync:lr,isImSyncDataObj:!0},dr);case 33:case"end":return Lt.stop()}},er,this,[[4,10],[15,21]])}));return function(er){return _e.apply(this,arguments)}}(),he.onSyncTeamMembers=function(_e){_e&&(_e.callFunc="sync::onSyncTeamMembers",_e.message="同步群成员错误",this.onCustomError("SYNC_TEAM_MEMBERS_ERROR",_e))},he.syncSuperTeamMembersCallBack=function(_e){_e&&(_e.callFunc="sync::SyncSuperTeamMembersCallBack",_e.message="同步超级群成员错误",this.onCustomError("SYNC_SUPERTEAM_MEMBERS_ERROR",_e))},he.onSyncTeamMembersDone=function(){var _e=this,er=_e.options,Pt=_e.syncTeamMembersResult,ar=_e.syncTeamMembersPromiseArray;o.all(ar).then(function(){var pr;ar=[];var lr={};m(pr=y(Pt)).call(pr,function(or){var xe,nr,ir,dr;O(or).call(or,"invalid")===-1&&(or in lr?(d(xe=lr[or].members).call(xe,Pt[or]),d(nr=lr[or].invalid).call(nr,Pt[or+"-invalid"])):lr[or]={members:d(ir=[]).call(ir,Pt[or]||[]),invalid:d(dr=[]).call(dr,Pt[or+"-invalid"]||[])})}),er.onsyncteammembersdone(lr),_e.syncTeamMembersResult=[],_e.syncTeamMembersPromiseArray=[]})},he.onSyncSuperTeamMembersDone=function(){var _e=this,er=_e.options,Pt=_e.syncSuperTeamMembersResult,ar=_e.syncSuperTeamMembersPromiseArray;o.all(ar).then(function(){var pr;ar=[];var lr={};m(pr=y(Pt)).call(pr,function(or){var xe,nr,ir,dr;O(or).call(or,"invalid")===-1&&(or in lr?(d(xe=lr[or].members).call(xe,Pt[or]),d(nr=lr[or].invalid).call(nr,Pt[or+"-invalid"])):lr[or]={members:d(ir=[]).call(ir,Pt[or]||[]),invalid:d(dr=[]).call(dr,Pt[or+"-invalid"]||[])})}),er.onsyncsuperteammembersdone(lr),_e.syncSuperTeamMembersResult=[],_e.syncSuperTeamMembersPromiseArray=[]})}},function(t,n,e){var r=e(790),s=e(794),i=e(753),o=e(798);t.exports=function(a){return r(a)||s(a)||i(a)||o()},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,n,e){var r=e(750),s=e(751);t.exports=function(i){if(r(i))return s(i)},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,n,e){t.exports=e(792)},function(t,n,e){var r=e(793);t.exports=r},function(t,n,e){var r=e(300);t.exports=r},function(t,n,e){var r=e(155),s=e(72),i=e(752);t.exports=function(o){if(r!==void 0&&s(o)!=null||o["@@iterator"]!=null)return i(o)},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,n,e){t.exports=e(796)},function(t,n,e){var r=e(797);t.exports=r},function(t,n,e){var r=e(301);t.exports=r},function(t,n){t.exports=function(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,n,e){var r=e(800);t.exports=r},function(t,n,e){e(801);var r=e(13);t.exports=r.Object.values},function(t,n,e){var r=e(1),s=e(802).values;r({target:"Object",stat:!0},{values:function(i){return s(i)}})},function(t,n,e){var r=e(27),s=e(12),i=e(120),o=e(44),a=s(e(150).f),d=s([].push),c=function(u){return function(m){for(var y,S=o(m),O=i(S),k=O.length,g=0,v=[];k>g;)y=O[g++],r&&!a(S,y)||d(v,u?[y,S[y]]:S[y]);return v}};t.exports={entries:c(!0),values:c(!1)}},function(t,n,e){t.exports=e(804)},function(t,n,e){var r=e(805);t.exports=r},function(t,n,e){var r=e(19),s=e(806),i=Array.prototype;t.exports=function(o){var a=o.findIndex;return o===i||r(i,o)&&a===i.findIndex?s:a}},function(t,n,e){e(807);var r=e(29);t.exports=r("Array").findIndex},function(t,n,e){var r=e(1),s=e(74).findIndex,i=e(199),o=!0;"findIndex"in[]&&Array(1).findIndex(function(){o=!1}),r({target:"Array",proto:!0,forced:o},{findIndex:function(a){return s(this,a,arguments.length>1?arguments[1]:void 0)}}),i("findIndex")},function(t,n,e){var r=e(9),s=e(10),i=e(3),o=e(2),a=e(35).fn,d=e(0),c=d.objs2accounts,u=e(809),m=e(204);a.processUser=function(y){var S,O=this,k=O.db,g=y.obj,v=y.error,ue=y.content;switch(y.cmd){case"markInBlacklist":v||O.markInBlacklist(g);break;case"syncMarkInBlacklist":O.markInBlacklist(ue,!0);break;case"markInMutelist":v||O.markInMutelist(g);break;case"syncMarkInMutelist":O.markInMutelist(ue,!0);break;case"getRelations":v||O.onRelations(y);break;case"syncMyInfo":O.onMyInfo(y,!0);break;case"updateMyInfo":v||(g.user.updateTime=ue.timetag,O.onUpdateMyInfo(y,g.user));break;case"syncUpdateMyInfo":O.onUpdateMyInfo(y,ue.user,!0);break;case"getUsers":var L;v||(S=r(L=ue.users).call(L,function(re){return re=s(m).call(m,re,O.mixStorePolicy&&O.mixStorePolicy.s3Policy?O.mixStorePolicy.s3Policy.dlcdns:[],O.mixStorePolicy&&O.mixStorePolicy.s3Policy?O.mixStorePolicy.s3Policy.dlcdn:""),O.mergeUser(re),re}),y.obj=S,k.enable&&k.putUsers(S));break;case"updateDonnop":O.onUpdateDonnop(y);break;case"syncUpdateDonnop":O.onDonnop(y,!1)}},a.onMyInfo=function(y){var S,O=this,k=O.db,g=y.error,v=y.content,ue=new i(function(re,le){var oe,he;g?(g&&(g.callFunc="user::onMyInfo"),re(g),O.syncData()):(S=s(m).call(m,v.user),k.enable?(oe=re,he=le,k.mergeMyInfo(S,!0).then(function(){L(),oe()}).then(void 0,function(Ie){Ie.message="db.mergeMyInfo error",Ie.callFunc="user::onMyInfo",he(Ie)})):(L(),re()))}).catch(function(re){return O.logger.error("user::onMyInfo: ",re),i.reject(re)});function L(){O.timetags.myInfo=S.updateTime,O.syncResult.myInfo=S}ue.cmd="myInfo",O.syncPromiseArray.push(ue)},a.onUpdateMyInfo=function(y,S,O){var k=this.db,g=s(m).call(m,S),v=d.merge(this.myInfo,g);this.myInfo=v,O?(this.logger.info("user::onUpdateMyInfo:",v&&v.account),this.options.onupdatemyinfo(v)):y.obj=v,k.enable&&(g.account=this.account,k.updateUser(g))},a.onRelations=function(y){var S,O=this,k=O.db,g=y.error,v=O.packetFromSync(y),ue=y.content.specialRelations,L=!0,re=[],le=[],oe=[],he=[],Ie=new i(function(Ne,Ve){var Ce,Ue;g?v&&(Ne(g),O.syncData()):(o(ue).call(ue,function(qe){var Oe={account:(qe=u.parse(qe)).account,createTime:qe.createTime,updateTime:qe.updateTime};qe.isBlacked?re.push(Oe):le.push(Oe),qe.isMuted?oe.push(Oe):he.push(Oe)}),O.logger.info("user::onRelations: parse blacklist",c(re),re,"delete",c(le),le),O.logger.info("user::onRelations: parse mutelist",c(oe),oe,"delete",c(he),he),ue.length?(L=!0,S=y.content.timetag):L=!1,k.enable?(Ce=Ne,Ue=Ve,y.promise=new i(function(qe,Oe){function $e(){v?(ie(),qe(),Ce()):k.getRelations().then(function(_e){re=_e[0],oe=_e[1],ie(),qe(),Ce()}).then(void 0,function(_e){_e.message="db.getRelations error",_e.callFunc="user::onRelations",Oe(_e),Ue(_e)})}L?k.mergeRelations(re,le,oe,he,S).then(function(){$e()}).then(void 0,function(_e){_e.message="db.mergeRelations error",_e.callFunc="user::onRelations",Oe(_e),Ue(_e)}):(O.logger.warn("user::onRelations: no relations need merge"),$e())}).then(void 0,function(qe){throw qe.message="merge relations data error",qe.callFunc="user::onRelations",Ue(qe),qe})):(ie(),Ne()))}).catch(function(Ne){return O.logger.error("user::onRelations: ",Ne),i.reject(Ne)});function ie(){O.timetags.relations=S,re.invalid=le,oe.invalid=he,v?(O.syncResult.blacklist=re,O.syncResult.mutelist=oe,O.syncResult.invalidBlacklist=le,O.syncResult.invalidMutelist=he):(O.logger.info("user::onRelations: get relations",re,oe),y.obj.blacklist=re,y.obj.mutelist=oe)}v&&(Ie.cmd="relations",O.syncPromiseArray.push(Ie))},a.markInBlacklist=function(y,S){var O=this.db;y.record={account:y.account,updateTime:+new Date},O.enable&&O.markInBlacklist(y),S&&(this.logger.info("user::markInBlacklist:",y),this.options.onsyncmarkinblacklist(y))},a.markInMutelist=function(y,S){var O=this.db;y.record={account:y.account,updateTime:+new Date},O.enable&&O.markInMutelist(y),S&&(this.logger.info("user::markInMutelist:",y),this.options.onsyncmarkinmutelist(y))},a.mergeUser=function(y){this.userSet[y.account]=y}},function(t,n,e){var r=e(0);function s(){}s.parse=function(i){var o=r.copy(i);return o.isBlacked=o.isBlacked==="1",o.isMuted=o.isMuted==="1",o.createTime=+o.createTime,o.updateTime=+o.updateTime,o},t.exports=s},function(t,n,e){var r=e(125),s=e(2),i=e(10),o=e(3),a=e(6),d=e(9),c=["type"],u=e(35).fn,m=e(0),y=m.objs2accounts,S=e(755),O=e(204);u.processFriend=function(k){var g=k.obj,v=k.content,ue=k.error;switch(k.cmd){case"friendRequest":this.updateFriendSysMsg(k),ue||this.onFriendRequest(g);break;case"syncFriendRequest":this.onFriendRequest(v,!0);break;case"deleteFriend":ue||this.onDeleteFriend(g);break;case"syncDeleteFriend":this.onDeleteFriend(v,!0);break;case"updateFriend":ue||this.onUpdateFriend(g);break;case"syncUpdateFriend":this.onUpdateFriend(v.friend,!0);break;case"getFriends":this.getFriends(k);break;case"syncFriends":this.onFriends(k);break;case"syncFriendUsers":this.onFriendUsers(k)}},u.getFriends=function(k){var g=k.content.friends,v=[],ue=[];s(g).call(g,function(L){(L=i(S).call(S,L)).valid?v.push(L):ue.push(L)}),v.invalid=ue,k.obj=v},u.onFriends=function(k){var g,v=this,ue=v.db,L=k.error,re=k.content.friends,le=!0,oe=[],he=[],Ie=new o(function(Ne,Ve){var Ce,Ue;L?Ve(L):(function(){le&&s(re).call(re,function(qe){(qe=i(S).call(S,qe)).valid?oe.push(qe):he.push(qe)}),v.logger.info("friend::onFriends: parse friends",y(oe),"delete",y(he)),re.length?(le=!0,g=k.content.timetag):le=!1}(),ue.enable?(Ce=Ne,Ue=Ve,k.promise=new o(function(qe,Oe){function $e(){ie(),qe(),Ce()}le?ue.mergeFriends(oe,he,g).then(function(){$e()}).then(void 0,function(_e){_e._msg="merge friends error",Oe(_e),Ue(_e)}):(v.logger.info("friend::onFriends: no merge friends"),$e())}).then(void 0,function(qe){throw qe._msg="merge friends data error",Ue(qe),qe})):(ie(),Ne()))}).catch(function(Ne){return v.logger.error("friend::onFriends: ",Ne),o.reject(Ne)});function ie(){var Ne,Ve;v.timetags.friends=g,oe.invalid=he,v.syncResult.friends=a(Ne=v.syncResult.friends||[]).call(Ne,oe||[]),v.syncResult.invalidFriends=a(Ve=v.syncResult.invalidFriends||[]).call(Ve,he||[])}Ie.cmd="friends",v.syncPromiseArray.push(Ie)},u.onFriendRequest=function(k,g){var v=o.resolve(),ue=this.db,L=k.type,re=r(k,c);if((L=k.type=S.getTypeFromByte(L)||L)==="addFriend"||L==="passFriendApply"){var le=k.friend=S.assembleFriend(re);ue.enable&&(v=ue.putFriend(le))}return g&&this.onSyncFriendAction(k),v},u.onSyncFriendAction=function(k){this.logger.info("friend::onSyncFriendActionon: ".concat(k.type,", "),k.account),this.options.onsyncfriendaction(k)},u.onDeleteFriend=function(k,g){var v=o.resolve(),ue=this.db;return ue.enable&&(v=ue.deleteFriend(k.account)),g&&(k.type="deleteFriend",this.onSyncFriendAction(k)),v},u.onUpdateFriend=function(k,g){var v=this.db,ue=i(S).call(S,k);v.enable&&v.updateFriend(ue),g&&this.onSyncFriendAction({type:"updateFriend",friend:ue})},u.onFriendUsers=function(k){var g,v,ue=this.db,L=k.content,re=d(g=L.users).call(g,function(he){return i(O).call(O,he)});this.logger.info("friend::onFriendUsers: parse users",y(re));var le=L.timetag,oe=o.resolve();ue.enable&&(oe=ue.mergeFriendUsers(re,le)),this.timetags.friendUsers=le,oe.cmd="friendUsers",this.syncPromiseArray.push(oe),this.syncResult.users=a(v=this.syncResult.users||[]).call(v,re||[]),this.syncing||this.onSyncDone()},u.updateFriendSysMsg=function(k){var g,v,ue=k.obj,L=k.error;if(k.obj.idServer){if(L)g="error",L=m.filterObj(L,"code message");else{var re=ue.type;switch(re=S.getTypeFromByte(re)||re){case"passFriendApply":g="passed";break;case"rejectFriendApply":g="rejected"}}v={idServer:ue.idServer,state:g,from:ue.account,type:"applyFriend"},L&&(v.error=L),this.updateSysMsg(v)}}},function(t,n,e){var r=e(32),s=e(16),i=e(35).fn,o=e(0);i.onRobots=function(a){var d=a.content;if(o.isFunction(this.options.onrobots)&&r(d.robots)){var c,u=s(c=d.robots).call(c,function(m){return!!m.botid});u.length>0&&this.options.onrobots(u||[])}}},function(t,n,e){var r=e(57),s=e(58),i=e(10),o=e(2),a=e(24),d=e(121),c=e(3),u=e(9),m=e(6),y=e(16),S=e(4),O=e(35).fn,k=e(0),g=k.objs2accounts,v=k.teams2ids,ue=e(194),L=e(152);O.processTeam=function(re){var le,oe,he,Ie=re.error;switch(re.obj===void 0&&(re.obj={}),re.cmd){case"createTeam":le=re.obj.team,Ie||(le=re.content.team),le=i(ue).call(ue,le),re.obj.team=le,he=L.assembleOwner(le),re.obj.owner=he,Ie||(this.logger.info("team::processTeam: create team ",le&&le.teamId,he&&he.account),this.onCreateTeam(le,he));break;case"syncCreateTeam":le=i(ue).call(ue,re.content.team),he=L.assembleOwner(le),this.logger.info("team::processTeam: sync createTeam",le&&le.teamId,he&&he.account),this.options.onsynccreateteam(le,he),this.onCreateTeam(le,he);break;case"sendSuperTeamMsg":case"sendTeamMsg":this.onSendMsg(re);break;case"teamMsg":this.onMsg(re);break;case"teamMsgs":this.onMsgs(re);break;case"addTeamMembers":case"removeTeamMembers":case"leaveTeam":case"dismissTeam":case"addTeamManagers":case"removeTeamManagers":case"transferTeam":break;case"updateInfoInTeam":Ie||(re.promise=this.onUpdateInfoInTeam(re));break;case"updateNickInTeam":re.obj=i(L).call(L,re.obj);break;case"updateTeam":re.obj=i(ue).call(ue,re.obj,!0);break;case"applyTeam":re.error||(re.obj=i(ue).call(ue,re.content.team));break;case"passTeamApply":this.updateTeamSysMsgState(re,"passed");break;case"rejectTeamApply":this.updateTeamSysMsgState(re,"rejected");break;case"acceptTeamInvite":this.updateTeamSysMsgState(re,"passed"),re.error||(re.obj=i(ue).call(ue,re.content.team));break;case"rejectTeamInvite":this.updateTeamSysMsgState(re,"rejected");break;case"getTeam":re.error||(re.obj=i(ue).call(ue,re.content.team));break;case"getTeams":this.onTeams(re);break;case"getTeamMembers":this.onTeamMembers(re);break;case"syncTeams":this.onTeams(re);break;case"syncTeamMembers":this.onTeamMembers(re);break;case"getTeamHistoryMsgs":case"searchTeamHistoryMsgs":this.onHistoryMsgs(re);break;case"syncSendTeamMsg":this.onMsg(re);break;case"notifyTeamMsgReads":this.onTeamMsgReceipt(re);break;case"syncUpdateTeamMember":(oe=i(L).call(L,re.content.teamMember)).account===this.account&&this.mergeMyTeamMembers(oe),this.onUpdateTeamMember(oe);break;case"updateMuteStateInTeam":break;case"getMyTeamMembers":re.error||(re.obj=L.reverseMembers(re.content.teamMembers));break;case"getMutedTeamMembers":re.error||(re.obj={teamId:re.obj.teamId,members:L.reverseMembers(re.content.teamMembers)});break;case"syncMyTeamMembers":this.onSyncMyTeamMembers(re);break;case"sendTeamMsgReceipt":this.sendTeamMsgReceipt(re);break;case"getTeamMsgReads":this.getTeamMsgReads(re);break;case"getTeamMsgReadAccounts":this.getTeamMsgReadAccounts(re);break;case"getTeamsById":this.getTeamsById(re)}},O.onUpdateInfoInTeam=function(){var re=s(r.mark(function le(oe){var he,Ie,ie;return r.wrap(function(Ne){for(;;)switch(Ne.prev=Ne.next){case 0:if(he=this,!(oe.content&&oe.content.teamMember&&oe.content.teamMember.teamId)){Ne.next=11;break}if(Ie=i(L).call(L,oe.content.teamMember),!he.db.enable){Ne.next=7;break}return Ne.next=6,he.db.updateTeamMember(Ie);case 6:Ie=Ne.sent;case 7:return he.mergeMyTeamMembers(Ie),he.onUpdateTeamMember(Ie),oe.obj=Ie,Ne.abrupt("return");case 11:if((ie=oe.obj.teamMember?oe.obj.teamMember:oe.obj).account=he.account,ie.account){Ne.next=15;break}return Ne.abrupt("return");case 15:ie.id=L.genId(ie.teamId,ie.account),ie=i(L).call(L,ie),he.mergeMyTeamMembers(ie),oe.obj=he.myTeamMembersMap&&he.myTeamMembersMap[ie.teamId]||ie,he.onUpdateTeamMember(ie);case 20:case"end":return Ne.stop()}},le,this)}));return function(le){return re.apply(this,arguments)}}(),O.getTeamMsgReads=function(re){var le=this;if(re.error)this.logger.error("team::sendTeamMsgReceipt: ",re.error);else{var oe=k._get(re,"content.teamMsgReceipts")||[];if(this.db.enable){var he=[];o(oe).call(oe,function(Ie){Ie.idClient&&he.push({idClient:Ie.idClient,unread:+Ie.unread,read:+Ie.read})}),he.length>0&&a(function(){return le.db.updateMsgBatch(he)},0)}}},O.getTeamMsgReadAccounts=function(re){if(re.error)this.logger.error("team::getTeamMsgReadAccounts: ",re.error);else{var le=k._get(re,"content.readAccounts")||[],oe=k._get(re,"content.unreadAccounts")||[],he=k._get(re,"content.teamMsgReceipt.idClient")||[];this.db.enable&&this.db.putMsgReadDetail({idClient:he,readAccounts:le,unreadAccounts:oe})}},O.sendTeamMsgReceipt=function(re){var le=this;if(re.error)this.logger.error("team::sendTeamMsgReceipt: ",re.error);else{var oe=k._get(re,"obj.teamMsgReceipts")||[],he=k._get(re,"content.teamMsgReceipts")||[];if(this.db.enable){var Ie=[];o(oe).call(oe,function(ie){d(he).call(he,function(Ne){return ie.idServer===Ne.idServer})||Ie.push({idClient:ie.idClient,hasRead:!0})}),Ie.length>0&&(this.logger.log("sendTeamMsgReceipt::updateMsgBatch"),a(function(){return le.db.updateMsgBatch(Ie)},0))}}},O.onCreateTeam=function(re,le){var oe=this.db;oe.enable&&(oe.putTeam(re),oe.putTeamMembers(le)),this.options.onCreateTeam(re,le)},O.onTeams=function(re){re.content=re.content||{};var le,oe=this,he=oe.db,Ie=oe.packetFromSync(re),ie=re.content.teams||[],Ne=!0,Ve=[],Ce=[];if(re.error)switch(re.error.code){case 803:re.error=null,Ne=!1}var Ue=new c(function(Oe,$e){var _e,er;re.error?Ie&&$e(re.error):(function(){Ne&&o(ie).call(ie,function(Pt){(Pt=i(ue).call(ue,Pt)).validToCurrentUser?Ve.push(Pt):Ce.push(Pt)}),ie.length?(Ne=!0,le=re.content.timetag):Ne=!1}(),he.enable?(_e=Oe,er=$e,re.promise=new c(function(Pt,ar){function pr(){Ie?(qe(),Pt(),_e()):he.getTeams().then(function(lr){Ve=lr,qe(),Pt(),_e()}).catch(function(lr){lr.message="db.getTeams error",lr.callFunc="team::afterMergeData",ar(lr),er(lr)})}Ne?he.mergeTeams(Ve,Ce,le).then(function(){pr()}).catch(function(lr){var or={callFunc:"team::onTeams:mergeData",message:"db.mergeTeams error",event:lr};ar(or),er(or)}):(oe.logger.warn("team::onTeams:mergeData: no teams need merge"),pr())}).then(void 0,function(Pt){throw Pt.message="merge teams data error",Pt.callFunc="team::mergeData",er(Pt),Pt})):(qe(),Oe()))}).catch(function(Oe){return oe.logger.error("team::onTeams: ",Oe),c.reject(Oe)});function qe(){oe.timetags.teams=le,Ve.invalid=Ce,Ie?(oe.syncResult.teams=Ve,oe.syncResult.invalidTeams=Ce,oe.syncing||oe.onSyncDone()):(oe.logger.info("team::onTeams: not in syncing, get teams",v(Ve)),re.obj=Ve)}Ie&&(Ue.cmd="teams",oe.syncPromiseArray.push(Ue))},O.getTeamsById=function(re){var le;if(re.error){if(re.error.code!==816)return;this.logger.error("team::getTeamsById: ",re.error),re.error=null}re.content.teams=u(le=re.content.teams).call(le,function(oe){return i(ue).call(ue,oe)}),re.obj=re.content},O.onTeamMembers=function(re){re.content=re.content||{};var le,oe=this,he=oe.db,Ie=oe.packetFromSync(re),ie=re.content.members||[],Ne=!0,Ve=[],Ce=[];if(re.obj&&(le=re.obj.teamId),le||(le=re.content.teamId),le=""+le,re.error)switch(re.error.code){case 406:re.error=null,Ne=!1}var Ue=new c(function(qe,Oe){re.error?(oe.logger.error("team::onTeamMember: team error:",le,re.error),qe()):(function(){Ne&&o(ie).call(ie,function($e){($e=i(L).call(L,$e)).valid?Ve.push($e):Ce.push($e)}),ie.length?(Ne=!0,re.content.timetag):Ne=!1}(),function($e,_e){if(Ie){oe.syncTeamMembersResult[le]=Ve,oe.syncTeamMembersResult[le+"-invalid"]=Ce;var er=m(Ve).call(Ve,Ce);he.putTeamMembers(er).catch(function(Pt){throw oe.logger.error("team::onTeamMembers: putTeamMembers error: ",Pt),Pt}).then(function(){return he.updateTeamMemberTimetag(le,re.content.timetag)}).catch(function(Pt){oe.logger.error("team::onTeamMembers error: ",Pt,le,re.content.timetag)}).then($e)}else oe.logger.info("team::onTeamMembers: not syncing, get members",le,g(Ve)),re.obj={teamId:le,members:Ve},$e()}(qe))});Ie&&(Ue.cmd=le,oe.syncTeamMembersPromiseArray.push(Ue))},O.onUpdateTeamMember=function(re){if(re.updateTime||(re.updateTime=+new Date),this.account===re.account){var le=this.myTeamMembersMap[re.teamId];this.logger.info("team::onMyTeamMembers: ",[le]),re=le||re,this.options.onMyTeamMembers(k.simpleClone([le]))}this.logger.info("team::onUpdateTeamMember: ",re&&re.account),this.options.onupdateteammember(k.simpleClone(re));var oe={teamId:re.teamId,memberUpdateTime:re.updateTime};this.onUpdateTeam(oe);var he=this.db;he.enable&&he.updateTeamMember(re)},O.onUpdateTeam=function(re){this.logger.info("team::onUpdateTeam:",re&&re.teamId),this.options.onUpdateTeam(k.simpleClone(re));var le=this.db;le.enable&&le.updateTeam(re)},O.onSyncMyTeamMembers=function(re){var le=this,oe=le.db,he=L.reverseMembers(re.content.teamMembers);if(oe.enable){var Ie=oe.putTeamMembers(he).then(function(){return oe.updateMyTeamMembersTimetag(re.content.timetag)}).catch(function(ie){return le.logger.error("team::syncMyTeamMember: ",ie),c.reject(ie)});Ie.cmd="myTeamMembers",le.syncTeamMembersPromiseArray.push(Ie),le.syncPromiseArray.push(Ie)}else le.syncResult.myTeamMembers=he;le.mergeMyTeamMembers(he)},O.mergeMyTeamMembers=function(re){k.isArray(re)||(re=[re]);var le=this.myTeamMembersMap=this.myTeamMembersMap||{};o(re).call(re,function(oe){var he=oe.teamId;le[he]=k.merge(le[he],oe)})},O.notifyForNewTeamMsg=function(re){k.isArray(re)||(re=[re]);var le=this,oe=this.myTeamMembersMap||{},he={},Ie=[];o(re).call(re,function(Ne){k.exist(oe[Ne])?he[Ne]=oe[Ne].muteNotiType:Ie.push(Ne)});var ie=c.resolve({map:he});return Ie.length&&(ie=le.api.getMyTeamMembers({teamIds:Ie,promise:!0}).then(function(Ne){le.mergeMyTeamMembers(Ne),o(Ne).call(Ne,function(Ce){he[Ce.teamId]=Ce.muteNotiType});var Ve=y(re).call(re,function(Ce){return!he[Ce]});return c.resolve({map:he,miss:Ve})}).catch(function(Ne){return S(he).length>0?c.resolve({map:he,miss:Ie,error:Ne}):c.reject(Ne)})),ie},O.updateTeamSysMsgState=function(re,le){var oe,he=re.error;he&&(le="error",he=k.filterObj(he,"code message")),oe={idServer:re.obj.idServer,state:le,from:re.obj.from,type:re.obj.type},he&&(oe.error=he),this.updateSysMsg(oe)},O.onTeamMsgReceipt=function(re){var le=re.content,oe=re.error;oe&&this.logger.error("team::onTeamMsgReceipt:",oe),le&&le.teamMsgReceipts&&(this.options.onTeamMsgReceipt(le),this.options.onMsgReceipts(le.teamMsgReceipts))}},function(t,n,e){var r=e(57),s=e(58),i=e(10),o=e(3),a=e(2),d=e(6),c=e(35).fn,u=e(0),m=u.teams2ids,y=e(308),S=e(203);c.processSuperTeam=function(O){var k,g,v,ue=O.error;switch(O.obj===void 0&&(O.obj={}),O.cmd){case"sendSuperTeamMsg":this.onSendMsg(O);break;case"superTeamMsg":this.onMsg(O);break;case"sendSuperTeamCustomSysMsg":this.onSendSysMsg(O);break;case"superTeamCustomSysMsg":this.onSysMsg(O);break;case"syncSuperTeams":this.onSuperTeams(O);break;case"syncCreateSuperTeam":k=i(y).call(y,O.content.team),v=S.assembleOwner(k),this.logger.info("team::processTeam: sync createTeam",k&&k.teamId,v&&v.account),this.options.onSyncCreateSuperTeam(k,v),this.onCreateSuperTeam(k,v);break;case"getSuperTeamHistoryMsgs":case"searchSuperTeamHistoryMsgs":this.onHistoryMsgs(O);break;case"syncSendSuperTeamMsg":this.onMsg(O);break;case"addSuperTeamMembers":case"removeSuperTeamMembers":case"leaveSuperTeam":case"addSuperTeamManagers":case"removeSuperTeamManagers":case"transferSuperTeam":break;case"updateInfoInSuperTeam":ue||(O.promise=this.onUpdateInfoInSuperTeam(O));break;case"updateNickInTeam":O.obj=i(S).call(S,O.obj);break;case"syncUpdateSuperTeamMember":(g=i(S).call(S,O.content.teamMember)).account===this.account&&this.mergeMySuperTeamMembers(g),this.onUpdateSuperTeamMember(g);break;case"updateSuperTeam":O.obj=i(y).call(y,O.obj,!0);break;case"getSuperTeam":O.error||(O.obj=i(y).call(y,O.content.team));break;case"getSuperTeams":this.onSuperTeams(O);break;case"syncSuperTeamMembers":this.onSyncSuperTeamMembers(O);break;case"syncMySuperTeamMembers":this.onSyncMySuperTeamMembers(O);break;case"getSuperTeamMembers":O.error||this.onGetAllSuperTeamMembers(O);break;case"getSuperTeamMembersByJoinTime":case"getSuperTeamMembersByAccounts":case"getMutedSuperTeamMembers":O.error||this.onSuperTeamMembers(O);break;case"onDeleteSuperTeamMsg":this.onDeleteMsg(O);break;case"onSuperTeamMsgDelete":case"syncDeleteSuperTeamMsg":this.onMsgDeleted(O,!0);break;case"onMarkSuperTeamSessionAck":this.onMarkSessionAck(O);break;case"syncMarkSuperTeamSessionAck":this.syncMarkSessionAck(O);break;case"passSuperTeamApply":this.updateSuperTeamSysMsgState(O,"passed");break;case"rejectSuperTeamApply":this.updateTeamSysMsgState(O,"rejected");break;case"acceptSuperTeamInvite":this.updateTeamSysMsgState(O,"passed");break;case"rejectSuperTeamInvite":this.updateSuperTeamSysMsgState(O,"rejected");break;case"getMySuperTeamMembers":O.error||(O.obj=S.reverseMembers(O.content.members))}},c.onUpdateInfoInSuperTeam=function(){var O=s(r.mark(function k(g){var v,ue,L;return r.wrap(function(re){for(;;)switch(re.prev=re.next){case 0:if(v=this,!(g.content&&g.content.superTeamMember&&g.content.superTeamMember.teamId)){re.next=11;break}if(ue=i(S).call(S,g.content.superTeamMember),!v.db.enable){re.next=7;break}return re.next=6,v.db.updateSuperTeamMember(ue);case 6:ue=re.sent;case 7:return v.mergeMySuperTeamMembers(ue),v.onUpdateSuperTeamMember(ue),g.obj=ue,re.abrupt("return");case 11:(L=g.obj.superTeamMember?g.obj.superTeamMember:g.obj).account=v.account,L.id=S.genId(L.teamId,L.account),L=i(S).call(S,L),v.mergeMySuperTeamMembers(L),g.obj=v.mySuperTeamMembersMap&&v.mySuperTeamMembersMap[L.teamId]||L,v.onUpdateSuperTeamMember(L);case 18:case"end":return re.stop()}},k,this)}));return function(k){return O.apply(this,arguments)}}(),c.onSuperTeams=function(O){O.content=O.content||{};var k,g=this,v=g.db,ue=g.packetFromSync(O),L=O.content.teams||[],re=!0,le=[],oe=[];if(O.error)switch(O.error.code){case 803:O.error=null,re=!1}var he=new o(function(ie,Ne){var Ve,Ce;O.error?ue&&Ne(O.error):(function(){re&&a(L).call(L,function(Ue){(Ue=i(y).call(y,Ue)).validToCurrentUser?le.push(Ue):oe.push(Ue)}),L.length?(re=!0,k=O.content.timetag):re=!1}(),v.enable?(Ve=ie,Ce=Ne,O.promise=new o(function(Ue,qe){function Oe(){ue?(Ie(),Ue(),Ve()):v.getSuperTeams().then(function($e){le=$e,Ie(),Ue(),Ve()}).then(void 0,function($e){$e.message="db.getSuperTeams error",$e.callFunc="superTeam::afterMergeData",qe($e),Ce($e)})}re?v.mergeSuperTeams(le,oe,k).then(function(){Oe()}).then(void 0,function($e){var _e={callFunc:"superTeam::onSuperTeams:mergeData",message:"db.mergeSuperTeams error",event:$e};qe(_e),Ce(_e)}):(g.logger.warn("superTeam::onSuperTeams:mergeData: no teams need merge"),Oe())}).then(void 0,function(Ue){throw Ue.message="merge teams data error",Ue.callFunc="superTeam::mergeData",Ce(Ue),Ue})):(Ie(),ie()))}).catch(function(ie){return g.logger.error("superTeam::onSuperTeams: ",ie),o.reject(ie)});function Ie(){g.timetags.superTeams=k,le.invalid=oe,ue?(g.syncResult.superTeams=le,g.syncResult.invalidSuperTeams=oe):(g.logger.info("superTeam::onSuperTeams: not in syncing, get teams",m(le)),O.obj=le)}ue&&(he.cmd="superteams",g.syncPromiseArray.push(he))},c.onCreateSuperTeam=function(O,k){var g=this.db;g.enable&&(g.putSuperTeam(O),g.putSuperTeamMembers(k))},c.onGetAllSuperTeamMembers=function(O){var k=this,g=this.db,v=O.raw.ser,ue=this.superTeamMembersData[v]||{},L=ue.teamId||O.obj&&O.obj.teamId;if(g.enable){var re=O.content&&O.content.timetag,le=O.raw.code===200?o.all(ue.pArr):o.resolve();O.promise=le.then(function(){return g.getSuperTeamMembers(L).then(function(oe){re&&g.updateSuperTeamMemberTimetag(L,re),O.obj={members:oe,invalid:[],teamId:L}})}).catch(function(oe){return k.logger.error(oe)})}else O.obj={members:ue.members,invalid:ue.invalid,teamId:L};this.superTeamMembersData[v]=void 0},c.onSyncSuperTeamMembers=function(O){var k,g=this,v=this.db,ue=[],L=[],re=O.content.members||[],le=O.raw.ser,oe=g.packetFromSync(O);if(O.obj&&(k=O.obj.teamId),k||(k=O.content.teamId),a(re).call(re,function(Ne){(Ne=i(S).call(S,Ne)).valid?L.push(Ne):ue.push(Ne)}),oe){var he=new o(function(Ne,Ve){if(O.error)g.logger.error("team::onSuperTeamMember: team error:",k,O.error),Ne();else{g.syncSuperTeamMembersResult[k]=L,g.syncSuperTeamMembersResult[k+"-invalid"]=ue;var Ce=d(L).call(L,ue);v.putSuperTeamMembers(Ce).catch(function(Ue){throw g.logger.error("team::onSuperTeamMembers: putSuperTeamMembers error: ",Ue),Ue}).then(function(){return v.updateSuperTeamMemberTimetag(k,O.content.timetag)}).catch(function(Ue){g.logger.error("team::onSuperTeamMembers error: ",Ue,k,O.content.timetag)}).then(Ne)}});g.syncSuperTeamMembersPromiseArray.push(he)}else{if(v.enable){g.superTeamMembersData[le]=g.superTeamMembersData[le]||{teamId:k,pArr:[]};var Ie=o.resolve();O.content&&O.content.isAll&&(Ie=v.deleteSuperTeamMembers(k));var ie=Ie.then(function(){return v.mergeSuperTeamMembers(k,L,ue)}).then(function(){return o.resolve()});g.superTeamMembersData[le].pArr.push(ie)}else g.superTeamMembersData[le]=g.superTeamMembersData[le]||{teamId:k,members:[],invalid:[]},L.length&&(g.superTeamMembersData[le].members=g.api.mergeTeamMembers(g.superTeamMembersData[le].members,L)),ue.length&&(g.superTeamMembersData[le].invalid=g.api.mergeTeamMembers(g.superTeamMembersData[le].invalid,ue));O.raw=void 0}},c.onSyncMySuperTeamMembers=function(O){var k=this,g=k.db,v=S.reverseMembers(O.content.teamMembers);if(g.enable){var ue=g.putSuperTeamMembers(v).then(function(){return g.updateMySuperTeamMembersTimetag(O.content.timetag)}).catch(function(L){return k.logger.error("superTeam::syncMySuperTeamMember: ",L),o.reject(L)});k.syncPromiseArray.push(ue)}else k.syncResult.mySuperTeamMembers=v;k.mergeMySuperTeamMembers(v)},c.onSuperTeamMembers=function(O,k){var g,v=this.db,ue=[],L=[],re=O.content.members||[];a(re).call(re,function(le){(le=i(S).call(S,le)).valid?L.push(le):ue.push(le)}),O.obj&&(g=O.obj.teamId),g||(g=O.content.teamId||L[0]&&L[0].teamId),v.enable&&!k&&v.mergeSuperTeamMembers(g,L,ue),O.obj={members:L,invalid:ue,teamId:g}},c.onUpdateSuperTeamMember=function(O){if(O.updateTime||(O.updateTime=+new Date),this.account===O.account){var k=this.mySuperTeamMembersMap[O.teamId];this.logger.info("superTeam::onMySuperTeamMembers: ",[k]),O=k||O,this.options.onMySuperTeamMembers(u.simpleClone([k]))}this.logger.info("superTeam::onUpdateSuperTeamMember: ",O&&O.account),this.options.onUpdateSuperTeamMember(u.simpleClone(O));var g={teamId:O.teamId,memberUpdateTime:O.updateTime};this.onUpdateSuperTeam(g);var v=this.db;v.enable&&v.updateSuperTeamMember(O)},c.onUpdateSuperTeam=function(O){this.logger.info("superteam::onUpdateSuperTeam:",O&&O.teamId),this.options.onUpdateSuperTeam(u.simpleClone(O));var k=this.db;k.enable&&k.updateSuperTeam(O)},c.mergeMySuperTeamMembers=function(O){u.isArray(O)||(O=[O]);var k=this.mySuperTeamMembersMap=this.mySuperTeamMembersMap||{};a(O).call(O,function(g){var v=g.teamId;k[v]=u.merge(k[v],g)})},c.updateSuperTeamSysMsgState=function(O,k){var g,v=O.error;v&&(k="error",v=u.filterObj(v,"code message")),g={idServer:O.obj.idServer,state:k,from:O.obj.from,type:O.obj.type},v&&(g.error=v),this.updateSysMsg(g)}},function(t,n,e){var r=e(10),s=e(3),i=e(24),o=e(35).fn,a=e(0),d=e(310);o.processNotify=function(c){switch(c.cmd){case"syncOfflineNetcallMsgs":case"syncOfflineMsgs":this.onOfflineMsgs(c);break;case"batchMarkRead":break;case"syncOfflineSysMsgs":case"syncOfflineSuperTeamSysMsgs":this.onOfflineSysMsgs(c);break;case"syncRoamingMsgs":case"syncSuperTeamRoamingMsgs":this.onRoamingMsgs(c);break;case"syncOfflineFilterMsgs":this.onOfflineMsgs(c,!0);break;case"syncOfflineFilterSysMsgs":this.onOfflineSysMsgs(c,!0);break;case"syncMsgReceipts":this.onOfflineMsgReceipts(c);break;case"syncDonnop":this.onDonnop(c,!0);break;case"syncSessionAck":this.syncSessionAck(c);break;case"syncSuperTeamSessionAck":this.syncSuperTeamSessionAck(c);break;case"syncRobots":this.onRobots(c);break;case"syncBroadcastMsgs":this.onBroadcastMsgs(c);break;case"syncDeleteSuperTeamMsgOfflineRoaming":this.onDeleteMsgOfflineRoaming(c);break;case"syncDeleteMsgSelf":this.syncDeleteMsgSelf(c);break;case"syncSessionsWithMoreRoaming":this.syncSessionsWithMoreRoaming(c);break;case"syncStickTopSessions":this.syncStickTopSessions(c);break;case"syncSessionHistoryMsgsDelete":this.syncSessionHistoryMsgsDelete(c)}},o.onDonnop=function(c,u){if(!c.error){var m=this,y=m.db,S=r(d).call(d,c.content.donnop);m.mergeDonnop(S);var O=m.dbDonnop();if(u){var k=c.content.timetag;m.timetags.donnop=k,y.enable&&(O=O.then(function(){return m.db.updateDonnopTimetag(k)}).catch(function(g){return m.logger.error("notify::onDonnop: ",g),s.reject(g)})),O.cmd="donnop",m.syncPromiseArray.push(O)}else m.onPushNotificationMultiportConfigUpdate()}},o.onUpdateDonnop=function(c){if(!c.error){var u=c.obj;u&&(this.mergeDonnop(a.filterObj(u,["shouldPushNotificationWhenPCOnline"])),this.dbDonnop(),this.onPushNotificationMultiportConfigUpdate())}},o.getPushNotificationMultiportConfig=function(){return a.merge({},this.pushNotificationMultiportConfig)},o.mergeDonnop=function(c){this.pushNotificationMultiportConfig=a.merge({},this.pushNotificationMultiportConfig,c)},o.dbDonnop=function(){return this.db.enable?this.db.setDonnop(this.pushNotificationMultiportConfig):s.resolve()},o.onPushNotificationMultiportConfigUpdate=function(){var c=this;i(function(){var u=c.getPushNotificationMultiportConfig();c.logger.info("link::onPushNotificationMultiportConfigUpdate:",u),c.options.onPushNotificationMultiportConfigUpdate(u)})}},function(t,n,e){var r=e(51),s=e(2),i=e(16),o=e(9),a=e(3),d=e(4),c=e(7),u=e(8),m=e(10),y=e(122),S=e(6),O=e(24),k=e(26),g=e(48),v=e(37),ue=e(158),L=e(52),re=e(53),le=e(54),oe=e(55),he=e(43),Ie=e(15),ie=e(88),Ne=e(89),Ve=e(72),Ce=e(32);function Ue(Lt,cr){var mr=Ne!==void 0&&Ve(Lt)||Lt["@@iterator"];if(!mr){if(Ce(Lt)||(mr=function(yr,vr){var Ir;if(yr){if(typeof yr=="string")return qe(yr,vr);var Mr=Ie(Ir=Object.prototype.toString.call(yr)).call(Ir,8,-1);if(Mr==="Object"&&yr.constructor&&(Mr=yr.constructor.name),Mr==="Map"||Mr==="Set")return ie(yr);if(Mr==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(Mr))return qe(yr,vr)}}(Lt))||cr&&Lt&&typeof Lt.length=="number"){mr&&(Lt=mr);var tr=0,At=function(){};return{s:At,n:function(){return tr>=Lt.length?{done:!0}:{done:!1,value:Lt[tr++]}},e:function(yr){throw yr},f:At}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var kt,Dt=!0,gr=!1;return{s:function(){mr=mr.call(Lt)},n:function(){var yr=mr.next();return Dt=yr.done,yr},e:function(yr){gr=!0,kt=yr},f:function(){try{Dt||mr.return==null||mr.return()}finally{if(gr)throw kt}}}}function qe(Lt,cr){(cr==null||cr>Lt.length)&&(cr=Lt.length);for(var mr=0,tr=new Array(cr);mr<cr;mr++)tr[mr]=Lt[mr];return tr}function Oe(Lt,cr){var mr=d(Lt);if(L){var tr=L(Lt);cr&&(tr=i(tr).call(tr,function(At){return re(Lt,At).enumerable})),mr.push.apply(mr,tr)}return mr}var $e=e(35).fn,_e=e(0),er=_e.undef,Pt=e(45),ar=e(152),pr=e(203),lr=e(154),or=e(291),xe=e(11),nr=e(64),ir=e(76);function dr(Lt,cr,mr){var tr=this,At=tr.message.Message,kt=mr?"offlineFilterMsgs":"offlineMsgs";if(!(cr&&cr.length>0))return a.resolve();var Dt=At.getMaxTimetag(cr),gr=cr[0].scene,yr=cr[0].target;tr.markMsgRead(cr),cr=At.deduplication(cr),cr=At.sortMsgs(cr);var vr=tr.genSessionByMsgs(cr);tr.cacheSyncedSession(vr);var Ir=tr.putMsg(cr,"offlineMsgs").then(function(Mr){var Ar=Mr;(Ar=tr.filterIgnore(Ar)).length&&(tr.logger.info("msg::onOfflineMsgs： toreLastSession",kt,Lt,Ar.length),tr.syncResult[kt]=tr.syncResult[kt]||[],tr.syncResult[kt].push({sessionId:Lt,scene:gr,to:yr,msgs:Ar,timetag:Dt}))}).catch(function(Mr){return tr.logger.error("msg::onOfflineMsgs: ",Mr),a.reject(Mr)});return Ir.cmd="offlineMsgs-"+Lt,Ir}$e.processMsg=function(Lt){switch(Lt.cmd){case"sendMsg":this.onSendMsg(Lt);break;case"msg":this.onMsg(Lt);break;case"sysMsg":this.onSysMsg(Lt);break;case"broadcastMsg":this.onBroadcastMsg(Lt);break;case"sendCustomSysMsg":this.onSendSysMsg(Lt);break;case"getHistoryMsgs":case"searchHistoryMsgs":this.onHistoryMsgs(Lt);break;case"msgFtsInServer":case"msgFtsInServerByTiming":this.onmsgFtsInServer(Lt);break;case"syncSendMsg":this.onMsg(Lt);break;case"deleteSessions":this.onDeleteSessions(Lt);break;case"sendMsgReceipt":this.onSendMsgReceipt(Lt);break;case"msgReceipt":this.onMsgReceipt(Lt);break;case"onDeleteMsg":this.onDeleteMsg(Lt);break;case"onMsgDeleted":this.onMsgDeleted(Lt);break;case"onDeleteMsgOfflineRoaming":this.onDeleteMsgOfflineRoaming(Lt);break;case"onMarkSessionAck":this.onMarkSessionAck(Lt);break;case"syncMarkSessionAck":this.syncMarkSessionAck(Lt);break;case"syncUpdateServerSession":this.onSyncUpdateServerSession(Lt);break;case"deleteMsgSelf":this.deleteMsgSelf(Lt);break;case"deleteMsgSelfBatch":this.deleteMsgSelfBatch(Lt);break;case"onDeleteMsgSelf":this.onDeleteMsgSelf(Lt);break;case"onDeleteMsgSelfBatch":this.onDeleteMsgSelfBatch(Lt);break;case"clearServerHistoryMsgs":this.clearServerHistoryMsgs(Lt);break;case"onClearServerHistoryMsgs":this.onClearServerHistoryMsgs(Lt)}},$e.checkIgnore=function(Lt){var cr=this;s(Lt).call(Lt,function(mr){if(!mr.ignore){try{cr.options.shouldIgnoreMsg(mr)&&(mr.ignore=!0)}catch(At){throw cr.logger.error("userOption:shouldIgnoreMsg function error",At),At}var tr;try{tr=cr.options.shouldIgnoreNotification(mr)}catch(At){throw cr.logger.error("userOption:shouldIgnoreNotification function error",At),At}mr.type==="notification"&&tr&&(mr.ignore=!0)}})},$e.filterIgnore=function(Lt){return i(Lt).call(Lt,function(cr){return!cr.ignore})},$e.genSessionByMsgs=function(Lt){return this.checkIgnore(Lt),lr.genSessionByMsgs(this.message.Message,Lt)},$e.onRoamingMsgs=function(Lt){var cr=this,mr=cr.message,tr=mr.Message,At=tr.getMaxTimetag,kt=mr.reverseMsgs(Lt.content.msgs),Dt=At(kt);kt=tr.deduplication(kt);var gr=(kt=tr.sortMsgs(kt))[0],yr=gr.sessionId,vr=cr.genSessionByMsgs(kt);cr.cacheSyncedSession(vr);var Ir=cr.putMsg(kt,"roamingMsgs").then(function(Mr){var Ar,Fr=(kt=Mr).length,Dr=(kt=cr.filterIgnore(kt)).length;Fr!==Dr&&cr.logger.info("msg::onRoamingMsgs msg length before filter: "+Fr+" after filter: "+Dr),kt.length&&(cr.logger.info("msg::onRoamingMsgs: putRoamingMsgs",yr,kt.length,o(Ar=kt||[]).call(Ar,function(Or){return"idServer: "+Or.idServer+" idClient: "+Or.idClient+" time:"+Or.time+" type: "+Or.type}).join(`
`)),cr.syncResult.roamingMsgs=cr.syncResult.roamingMsgs||[],cr.syncResult.roamingMsgs.push({sessionId:yr,scene:gr.scene,to:gr.target,msgs:kt,timetag:Dt}),cr.syncing||cr.roamingMsgSyncDoneBufferManager.add())}).catch(function(Mr){return cr.logger.error("msg::onRoamingMsgs: ",Mr),a.reject(Mr)});Ir.cmd="roamingMsgs-"+yr,cr.syncPromiseArray.push(Ir)},$e.onOfflineMsgs=function(Lt,cr){var mr,tr=this,At=this.message,kt=null;cr&&(kt={filter:!0});var Dt=At.reverseMsgs(Lt.content.msgs,{modifyObj:kt});Dt=ir.deduplication(Dt);var gr={};s(Dt).call(Dt,function(Ir){gr[Ir.sessionId]=gr[Ir.sessionId]||[],gr[Ir.sessionId].push(Ir)});var yr=o(mr=d(gr)).call(mr,function(Ir){return{sessionId:Ir,msgs:gr[Ir]}}),vr=_e.asyncPool(50,yr,function(Ir){return dr.call(tr,Ir.sessionId,Ir.msgs,cr)});this.syncPromiseArray.push(vr)},$e.completeMsg=function(Lt){return Lt.from=this.account,Lt.fromNick=this.myInfo&&this.myInfo.nick,Lt.fromClientType="Web",Lt.fromDeviceId=Pt.deviceId,Lt.time||(Lt.time=+new Date),Lt},$e.amendMsg=function(Lt){if(Lt.scene==="team"){var cr=_e.get(this.myTeamMembersMap,Lt.to+".nickInTeam");cr&&(Lt.fromNick=cr)}else if(Lt.scene==="superTeam"){var mr=_e.get(this.mySuperTeamMembersMap,Lt.to+".nickInTeam");mr&&(Lt.fromNick=mr)}return Lt},$e.onMsgs=function(Lt){var cr=this,mr=cr.reporterHook.getSafeClock(),tr=cr.message.reverseMsgs(Lt.content.msgs,{mapper:function(At){var kt=function(Dt){for(var gr=1;gr<arguments.length;gr++){var yr,vr,Ir=arguments[gr]!=null?arguments[gr]:{};gr%2?s(yr=Oe(Object(Ir),!0)).call(yr,function(Mr){r(Dt,Mr,Ir[Mr])}):le?oe(Dt,le(Ir)):s(vr=Oe(Object(Ir))).call(vr,function(Mr){he(Dt,Mr,re(Ir,Mr))})}return Dt}({},At);if(kt.__receiveTime=Lt.__receiveTime,kt.__handleTime=mr,kt.__clientExt)try{kt.__clientExt=JSON.parse(kt.__clientExt)}catch{cr.logger.warn("IMProtocolFn:onMsg __clientExt parse failed ".concat(kt.__clientExt))}return cr.handleMsg(kt),kt}});cr.pushMsgDelay(tr)},$e.onMsg=function(Lt,cr){var mr;if(Lt.content.msg.attach){var tr=null;try{tr=JSON.parse(Lt.content.msg.attach)}catch{}if(tr&&tr.url&&_e.get(this.mixStorePolicy,"s3Policy.dlcdns")){var At,kt=Ue(this.mixStorePolicy.s3Policy.dlcdns);try{for(kt.s();!(At=kt.n()).done;){var Dt,gr=At.value;c(Dt=tr.url).call(Dt,gr)>=0&&(tr.isS3=!0,gr!==this.mixStorePolicy.s3Policy.dlcdn&&(tr.url=tr.url.replace(gr,this.mixStorePolicy.s3Policy.dlcdn)))}}catch(vr){kt.e(vr)}finally{kt.f()}}Lt.content.msg.attach=u(tr)}var yr=m(mr=this.message).call(mr,Lt.content.msg);if(yr.__receiveTime=Lt.__receiveTime,yr.__handleTime=this.reporterHook.getSafeClock(),_e.get(Lt,"content.msg.__clientExt"))try{yr.__clientExt=JSON.parse(Lt.content.msg.__clientExt)}catch{this.logger.warn("IMProtocolFn:onMsg __clientExt parse failed ".concat(Lt.content.msg.__clientExt))}cr&&(yr.filter=!0),Lt.cmd!=="syncSendMsg"||yr.from!==yr.to?(this.pushMsgDelay([yr]),this.syncing?(this.logger.info("msg::onMsg:is in syncing ..."),this.unhandledMsgs.push({type:"onMsg",msg:yr})):this.handleMsg(yr)):this.logger.warn("onMsg::syncSendMsg to self, so ignore",yr.idClient,yr.idServer)},$e.onBroadcastMsgs=function(Lt){var cr=Lt.content.broadcastMsgs;cr=y(cr).call(cr,function(mr,tr){return mr.broadcastId-tr.broadcastId}),this.putBroadcastMsgs(cr)},$e.onBroadcastMsg=function(Lt){var cr=Lt.content.broadcastMsg;cr.time=cr.timestamp,this.syncing?this.unhandledMsgs.push({type:"onBroadcastMsg",msg:cr}):cr&&this.putBroadcastMsg(cr)},$e.pushMsgTask=function(Lt){this.msgPromise=this.msgPromise.then(function(){return Lt()})},$e.pushMsgDelay=function(Lt){if(Lt&&Lt.length>0){var cr=this;if(cr.msgStatEnable&&!xe.isWeixinApp){var mr,tr=o(Lt).call(Lt,function(At){return{appkey:cr.options.appKey,accid:At.to,fromAccid:At.from,msgId:At.idServer,serverTime:At.time,receiveTime:cr.reporterHook.getNTPTime(),sessionId:cr.sdkSession,platform:"web",sdk_ver:xe.info.version,manufactor:nr.name+" "+nr.version}});cr.msgDelayArr=S(mr=cr.msgDelayArr).call(mr,tr),cr.msgDelayArr.length>5&&cr.doReportMsgDelay()}}},$e.doReportMsgDelay=function(){var Lt,cr=u(this.msgDelayArr);this.msgDelayArr&&this.msgDelayArr.length>0&&(or.sendBeacon("https://statistic.live.126.net/statics/report/im/sdk/msgreceived",cr),this.msgDelayArr=[]),this.msgDelayTimer&&clearTimeout(this.msgDelayTimer),this.socket&&(this.msgDelayTimer=O(k(Lt=this.doReportMsgDelay).call(Lt,this),1e4))},$e.handleMsg=function(Lt){var cr,mr=this,tr=mr.db,At=Lt.time;mr.markMsgRead(Lt),mr.logger.info(S(cr="msg::handleMsg:msgPromise start ".concat(Lt.idServer," ")).call(cr,Lt.idClient)),mr.msgPromise=mr.msgPromise.then(function(){var kt;return mr.logger.info(S(kt="msg::handleMsg:msgPromise, putMsg start ".concat(Lt.idServer," ")).call(kt,Lt.idClient)),mr.putMsg(Lt,"onMsg")}).then(function(){var kt;return mr.logger.info(S(kt="msg::handleMsg:msgPromise, putMsg done and update timetag ".concat(Lt.idServer," ")).call(kt,Lt.idClient)),tr.enable?Lt.scene==="superTeam"?tr.updateSuperTeamRoamingMsgTimetag(At):tr.updateRoamingMsgTimetag(At):(mr.timetags[Lt.scene==="superTeam"?"superTeamRoamingMsgs":"roamingMsgs"]=At,a.resolve())}).then(function(){if(Lt)return mr.checkUserUpdate(Lt)}).then(function(){if(Lt){var kt=Lt.type;switch(mr.logger.info("msg::handleMsg:msgPromise, checkUserUpdate "+Lt.scene+" "+kt+" msg"+(kt==="notification"?" "+Lt.attach.type:"")),kt){case"notification":return mr.onTeamNotificationMsg(Lt)}}}).then(function(){var kt,Dt;mr.logger.info(S(kt=S(Dt="msg::handleMsg:msgPromise, onmsg ready: ".concat(Lt.idServer," ")).call(Dt,Lt.idClient,", ")).call(kt,!!Lt.ignore)),Lt&&!Lt.ignore&&O(function(){var gr,yr=Lt.scene==="p2p";if(xe.isBrowser&&Lt.flow!=="out"){var vr={msgId:Lt.idServer,clientId:Lt.idClient,receiveTime:mr.reporterHook.getNTPTime(Lt.__receiveTime),serverTime:Lt.time,callbackTime:mr.reporterHook.getNTPTime(),preHandleTime:mr.reporterHook.getNTPTime(Lt.__handleTime),fromAccid:Lt.from,toAccid:mr.options.account,type:mr.message.sceneMap[Lt.scene],tid:yr?"":Lt.to,result:200,failReason:"",rt:g(mr.reporterHook.getSafeClock()-Lt.__receiveTime)},Ir=_e.get(Lt,"__clientExt.statistics.apiCallingTime"),Mr=_e.get(Lt,"__clientExt.statistics.sendTime");Ir&&Mr&&(vr.apiCallingTime=Ir,vr.sendTime=Mr,vr.attachUploadDuration=_e.get(Lt,"__clientExt.statistics.attachUploadDuration")||0),mr.reporter&&mr.reporter.report("msgReceive",vr)}delete Lt.__receiveTime,delete Lt.__handleTime,delete Lt.__clientExt,mr.logger.info(S(gr="msg::handleMsg:msgPromise, tigger onmsg: ".concat(Lt.idServer," ")).call(gr,Lt.idClient)),mr.options.onmsg(_e.copy(Lt))},0)}).catch(function(kt){var Dt;mr.logger.error(S(Dt="msg::handleMsg:msgPromise, catch err ".concat(Lt.idServer," ")).call(Dt,Lt.idClient),kt),kt.callFunc="msg::handleMsg",mr.onCustomError("消息处理错误",kt)})},$e.putMsg=function(Lt,cr){if(_e.isArray(Lt)||(Lt=[Lt]),i(Lt[0]))return a.resolve(Lt);var mr,tr=this,At=tr.db,kt=At.enable,Dt=a.resolve(),gr=tr.message.Message.getLastMsg(Lt),yr=gr.flow,vr=tr.genSessionByMsgs(Lt);Mr(vr);var Ir=[];function Mr(Ar){cr!=="roamingMsgs"&&cr!=="offlineMsgs"||tr.cacheSyncedSession(Ar)}return Dt=(Dt=(Dt=Dt.then(function(){var Ar;return kt||tr.options.autoMarkRead||cr==="roamingMsgs"||!vr||(tr.sessionUnreadMsgs=tr.sessionUnreadMsgs||{},tr.sessionUnreadMsgs[vr.id]=tr.sessionUnreadMsgs[vr.id]||[],tr.sessionUnreadMsgs[vr.id]=S(Ar=tr.sessionUnreadMsgs[vr.id]).call(Ar,i(Lt).call(Lt,function(Fr){try{return tr.options.shouldCountNotifyUnread(Fr)}catch(Dr){throw tr.logger.error("userOption:shouldCountNotifyUnread function error",Dr),Dr}}))),cr==="offlineMsgs"||cr==="roamingMsgs"?a.reject(Lt):kt?At.putMsg(Lt):Lt}).then(function(Ar){return s(Lt).call(Lt,function(Fr){tr.checkMsgUnique(Fr)&&tr.logger.warn("msg::putMsg: msg is not unique",Fr.idClient,Fr.idServer,Fr.time)}),Ir=kt?Ar:Lt,a.resolve(Lt)})).then(function(Ar){return Ar.length&&kt&&vr?new a(function(Fr){At.getSessions({sessionId:vr.id}).then(function(Dr){if(Dr&&Dr.lastMsg){var Or=Dr.lastMsg;vr.lastMsg&&vr.lastMsg.time<Or.time&&(vr.lastMsg=Or)}Ir&&Ir.length?vr?At.putSession(vr).then(function(Sn){Fr(Sn)}):Fr(Dr):(Ir=Ar,Fr(Dr))})}):a.resolve(vr)})).then(function(Ar){if(vr&&Ir.length){mr=gr.sessionId!==tr.currSessionId;var Fr=cr==="roamingMsgs",Dr=tr.options.syncSessionUnread,Or=vr.id,Sn=tr.getSessionInCache(Or,!0)||{},Rr=Sn.ack||0;if(cr==="offlineMsgs"||Fr&&Dr||cr==="onMsg"&&yr==="in"&&mr){var Wr;if(kt&&Ar){var Er=Sn.unread||0;(vr=Ar).unread=Er,Rr=Rr||vr.ack||0}else(Ar=Sn)&&(vr.unread=Ar.unread||0);Mr(vr),vr.unread=vr.unread||0;var Ur=0;s(Ir).call(Ir,function(In){var An;try{An=tr.options.shouldCountNotifyUnread(In)}catch(Gi){throw tr.logger.error("userOption:shouldCountNotifyUnread function error",Gi),Gi}var Zn=(In.type!=="notification"||In.type==="notification"&&An)&&(er(In.isUnreadable)||In.isUnreadable);if(Zn&&Dr&&(Zn=In.time>Rr&&In.flow!=="out"),Zn&&(Ur++,Dr&&!kt)){var Nn=Sn.unreadMsgs||[];Nn.push(In),vr.unreadMsgs=Nn}}),vr.unread+=Ur;var Zr=_e.secureOutput("session",vr);if(Zr.unreadMsgs&&(Zr.unreadMsgs=o(Wr=Zr.unreadMsgs).call(Wr,function(In){return In&&In.idServer})),tr.logger.info("msg::putMsg:updateSession: ",Zr),Mr(vr),kt)return At.updateSession({id:vr.id,unread:vr.unread})}}}),cr==="onMsg"&&(Dt=Dt.then(function(){Lt.length&&vr&&(tr.onUpdateSession(vr),tr.options.syncSessionUnread&&!mr&&tr.api.resetSessionUnread(tr.currSessionId))})),Dt.then(function(){return a.resolve(Lt)}).catch(function(Ar){return Ar&&Ar.length?a.resolve(Ar):a.reject(Ar)})},$e.putBroadcastMsgs=function(Lt){var cr=this,mr=cr.db,tr=Lt.length;if(tr>0){if(cr.doMarkBroadcastMsgsRead(Lt),mr.enable){var At=Lt[tr-1].broadcastId;return mr.updateBroadcastMsgTimetag(At),mr.putBroadcastMsg(Lt).then(function(){return O(function(){cr.doMarkMsgsRead(),cr.options.onbroadcastmsgs(_e.copy(Lt))},0),a.resolve(Lt)})}O(function(){cr.options.onbroadcastmsgs(_e.copy(Lt))},0)}return Lt},$e.putBroadcastMsg=function(Lt){var cr=this,mr=cr.db;return cr.doMarkBroadcastMsgsRead([Lt]),mr.enable?(Lt.broadcastId&&mr.updateBroadcastMsgTimetag(Lt.broadcastId),mr.putBroadcastMsg(Lt).then(function(){return O(function(){cr.options.onbroadcastmsg(_e.copy(Lt))},0),a.resolve(Lt)})):(O(function(){cr.options.onbroadcastmsg(_e.copy(Lt))},0),Lt)},$e.doMarkBroadcastMsgsRead=function(Lt){Lt=o(Lt).call(Lt,function(cr){return cr.broadcastId}),this.sendCmd("batchMarkRead",{sid:7,cid:17,ids:Lt})},$e.cacheSyncedSession=function(Lt){if(Lt&&this.syncResult){Lt=v({},Lt),this.syncResult.sessions=this.syncResult.sessions||{};var cr=Lt.id,mr=this.syncResult.sessions[cr]||{};mr&&mr.ack>Lt.ack&&delete Lt.ack,mr&&mr.msgReceiptTime>Lt.msgReceiptTime&&delete Lt.msgReceiptTime;var tr=_e.get(mr,"lastMsg.time"),At=_e.get(Lt,"lastMsg.time");tr&&At&&tr>At&&(Lt.lastMsg=mr.lastMsg),this.syncResult.sessions[cr]=v(mr,Lt),this.syncResult.sessions[cr]=v({},this.mergeSession(this.syncResult.sessions[cr]))}},$e.checkMsgUnique=_e.genCheckUniqueFunc("idClient"),$e.revokeMsgUniqueCheck=function(Lt){this.uniqueSet&&this.uniqueSet.idClient&&(this.uniqueSet.idClient[Lt]=!1)},$e.storeSendMsg=function(Lt){if(!this.syncing){var cr=this.putMsg(Lt,"sendMsg");return this.msgPromise=this.msgPromise.then(function(){return cr}),cr}this.unhandledMsgs.push({type:"sendMsg",msg:Lt})},$e.updateSendMsgError=function(Lt){if(!this.syncing){var cr=this.updateMsg(Lt);return this.msgPromise=this.msgPromise.then(function(){return cr}),cr}this.unupdatedMsgs.push(Lt)},$e.onSendMsg=function(Lt,cr){var mr,tr,At=this,kt=Lt.content&&Lt.content.msg,Dt=Lt.obj&&Lt.obj.msg||kt;if(Dt)if(this.logger.warn(S(mr=S(tr="sendMsg::end: ".concat(kt&&kt.idServer," ")).call(tr,Dt.idClient," ")).call(mr,Lt&&Lt.raw&&Lt.raw.ser)),Lt.obj)yr();else{var gr=At.db;gr&&gr.enable&&gr.getMsgByIdClient(Dt.idClient).then(function(vr){vr&&(Dt=vr,yr(!1))}).catch(function(){return yr()})}else this.logger.error("sendMsg::error::get msg failed, msg empty");function yr(){var vr,Ir=!(arguments.length>0&&arguments[0]!==void 0)||arguments[0];At.completeMsg(Dt);var Mr=Lt.error&&Lt.error.code===7101;Lt.error&&!Mr||(Dt.idServer=kt.idServer,Dt.time=+kt.time,kt.yidunAntiSpamRes&&(Dt.yidunAntiSpamRes=kt.yidunAntiSpamRes),kt.callbackExt&&(Dt.callbackExt=kt.callbackExt)),Mr&&(Dt.isInBlackList=!0),Lt.error?Dt.status="fail":Dt.status="success",Dt=Ir?m(vr=At.message).call(vr,Dt):Dt,Dt=At.amendMsg(Dt),cr&&(Dt.filter=!0),Lt.obj=Dt,At.syncing?At.unupdatedMsgs.push(Dt):At.msgPromise=a.all([At.msgPromise,Lt.obj.promise]).then(function(Ar){return Ar.length||(Dt.resend=!0),At.updateMsg(Dt).then(function(){return At.options.syncSessionUnread&&At.currSessionId===Dt.sessionId&&At.api.resetSessionUnread(At.currSessionId),At.resolveMsgReceiptTask(Dt),Dt})}).catch(function(Ar){At.logger.error("onSendMsg::dealMsg error",Ar)})}},$e.updateLocalMsg=function(Lt){var cr=this.updateMsg(Lt);return this.msgPromise=this.msgPromise.then(function(){return cr}),cr},$e.updateMsg=function(Lt){if(i(Lt)||this.options.shouldIgnoreMsg(Lt))return a.resolve(Lt);var cr=this,mr=cr.db,tr=Lt.status==="success",At=lr.genSessionByMsg(Lt),kt=!!Lt.isLocal;return cr.onUpdateSession(At),mr.enable?mr.updateMsg(Lt).then(function(Dt){var gr=mr.updateSession(At),yr=a.resolve();return tr&&Dt&&!kt&&(yr=Lt.scene==="superTeam"?mr.updateSuperTeamRoamingMsgTimetag(Dt.time):mr.updateRoamingMsgTimetag(Dt.time)),a.all([gr,yr])}).catch(function(Dt){cr.logger.error("updateMsg error",Dt)}):(tr&&!kt&&(cr.timetags.roamingMsgs=Lt.time),a.resolve(Lt))},$e.updateRoamingMsgTimetag=function(Lt){var cr=this.db;return cr.enable?cr.updateRoamingMsgTimetag(Lt):(this.timetags.roamingMsgs=Lt,a.resolve(Lt))},$e.checkUserUpdate=function(Lt){var cr=this,mr=Lt.from;return cr.logger.info("handleMsg::checkUserUpdate: ",mr,cr.account),mr===cr.account?a.resolve():new a(function(tr){var At=cr.userSet[mr];if(At){var kt=+At.updateTime,Dt=+Lt.userUpdateTime;!isNaN(kt)&&!isNaN(Dt)&&_e.isNumber(kt)&&_e.isNumber(Dt)&&kt<Dt?gr():tr()}else gr();function gr(){cr.api.getUser({account:mr,sync:!0,done:function(yr,vr){yr||O(function(){cr.logger.log("user::checkUserUpdate: onupdateuser",vr&&vr.account),cr.options.onupdateuser(vr)},0),tr()}})}})},$e.processUnsettledMsgs=function(){var Lt,cr,mr=this;s(Lt=mr.unhandledMsgs).call(Lt,function(tr){var At=tr.msg;switch(tr.type){case"onMsg":mr.handleMsg(At);break;case"sendMsg":mr.msgPromise=mr.msgPromise.then(function(){return mr.putMsg(At)});break;case"onBroadcastMsg":mr.msgPromise=mr.msgPromise.then(function(){return mr.putBroadcastMsg(At)})}}),s(cr=mr.unupdatedMsgs).call(cr,function(tr){mr.msgPromise=mr.msgPromise.then(function(){return mr.updateMsg(tr)})}),mr.resetUnsettledMsgs()},$e.onTeamNotificationMsg=function(Lt){var cr=Lt.attach,mr=cr.type,tr=Lt.from,At=Lt.to,kt=Lt.time,Dt=cr.team,gr=cr.account,yr=cr.accounts;switch(mr){case"updateTeam":return Dt.updateTime=kt,this.onUpdateTeam(Dt);case"addTeamMembers":return this.onAddTeamMembers(Lt,Dt,yr);case"removeTeamMembers":return this.onRemoveTeamMembers(Dt,At,yr);case"acceptTeamInvite":return this.onAddTeamMembers(Lt,Dt,[tr]);case"passTeamApply":return this.onAddTeamMembers(Lt,Dt,[gr]);case"addTeamManagers":return this.updateTeamManagers(Lt,At,yr,!0,kt);case"removeTeamManagers":return this.updateTeamManagers(Lt,At,yr,!1,kt);case"leaveTeam":return this.onRemoveTeamMembers(Dt,At,[tr]);case"dismissTeam":return this.onDismissTeam(At,kt);case"transferTeam":return this.transferTeam(Lt,Dt,tr,gr);case"updateTeamMute":return this.onUpdateTeamMembersMute(Lt,Dt,[gr],cr.mute);case"updateSuperTeam":return Dt.updateTime=kt,this.onUpdateSuperTeam(Dt);case"acceptSuperTeamInvite":return this.onAddSuperTeamMembers(Lt,Dt,[Lt.from]);case"addSuperTeamMembers":return this.onAddSuperTeamMembers(Lt,Dt,yr);case"passSuperTeamApply":return this.onAddSuperTeamMembers(Lt,Dt,[gr]);case"removeSuperTeamMembers":return this.onRemoveSuperTeamMembers(Dt,At,yr);case"leaveSuperTeam":return this.onRemoveSuperTeamMembers(Dt,At,[tr]);case"dismissSuperTeam":return this.onDismissSuperTeam(At,kt);case"transferSuperTeam":return this.transferSuperTeam(Lt,Dt,tr,gr);case"addSuperTeamManagers":return this.updateSuperTeamManagers(Lt,At,yr,!0,kt);case"removeSuperTeamManagers":return this.updateSuperTeamManagers(Lt,At,yr,!1,kt);case"updateSuperTeamMembersMute":return this.onUpdateSuperTeamMembersMute(Lt,Dt,yr,cr.mute)}},$e.onAddSuperTeamMembers=function(Lt,cr,mr){var tr=this.db,At=pr.assembleMembers(cr,mr);Lt.attach.members=At;var kt={team:cr,accounts:mr,members:At};if(this.logger.info("team::onAddSuperTeamMembers: ".concat(kt.team.teamId,", "),kt.accounts),this.options.onAddSuperTeamMembers(_e.simpleClone(kt)),tr.enable){var Dt=tr.putSuperTeamMembers(At),gr=tr.putSuperTeam(cr);return a.all([Dt,gr])}},$e.onRemoveSuperTeamMembers=function(Lt,cr,mr){var tr=this.db,At={team:Lt,teamId:cr,accounts:mr};if(this.logger.info("team::onRemoveSuperTeamMembers: ".concat(cr,", "),At.accounts),this.options.onRemoveSuperTeamMembers&&this.options.onRemoveSuperTeamMembers(_e.simpleClone(At)),this.mySuperTeamMembersMap&&this.mySuperTeamMembersMap[cr]&&this.mySuperTeamMembersMap[cr].followAccountIds){var kt=this.mySuperTeamMembersMap[cr].followAccountIds;if(i(kt).call(kt,function(vr){return ue(mr).call(mr,vr)}).length>0){this.mySuperTeamMembersMap[cr].followAccountIds=i(kt).call(kt,function(vr){return!ue(mr).call(mr,vr)});var Dt=this.mySuperTeamMembersMap[cr];this.db.enable&&this.db.updateSuperTeamMember(Dt),this.mergeMySuperTeamMembers(Dt),this.onUpdateSuperTeamMember(Dt)}}if(Lt&&tr.enable){if(c(mr).call(mr,this.account)===-1){var gr=tr.removeSuperTeamMembersByAccounts(cr,mr),yr=a.resolve();return Lt&&(yr=tr.putSuperTeam(Lt)),a.all([gr,yr])}return tr.leaveSuperTeam(cr)}},$e.onDismissSuperTeam=function(Lt,cr){var mr=this.db,tr={teamId:Lt};if(this.logger.info("team::onDismissSuperTeam:",Lt),this.options.onDismissSuperTeam(tr),mr.enable)return mr.dismissSuperTeam(Lt,cr)},$e.onAddTeamMembers=function(Lt,cr,mr){var tr=this,At=tr.db,kt=cr.teamId,Dt=ar.assembleMembers(cr,mr);Lt.attach.members=Dt;var gr={team:cr,accounts:mr,members:Dt};if(tr.logger.info("team::onAddTeamMembers: ",kt,mr),c(mr).call(mr,tr.account)>-1&&tr.mergeMyTeamMembers(i(Dt).call(Dt,function(Ir){return Ir.account===tr.account})),tr.options.onAddTeamMembers(_e.simpleClone(gr)),At.enable){var yr,vr=At.putTeam(cr);return c(mr).call(mr,tr.account)>-1?yr=At.putTeamMembers(Dt):tr.logger.log("team::onAddTeamMembers: user join team",kt),a.all([yr,vr])}},$e.onRemoveTeamMembers=function(Lt,cr,mr){var tr=this.db,At={team:Lt,teamId:cr,accounts:mr};if(this.logger.info("team::onRemoveTeamMembers: ".concat(cr),mr),this.options.onRemoveTeamMembers&&this.options.onRemoveTeamMembers(_e.simpleClone(At)),this.myTeamMembersMap&&this.myTeamMembersMap[cr]&&this.myTeamMembersMap[cr].followAccountIds){var kt=this.myTeamMembersMap[cr].followAccountIds;if(i(kt).call(kt,function(vr){return ue(mr).call(mr,vr)}).length>0){this.myTeamMembersMap[cr].followAccountIds=i(kt).call(kt,function(vr){return!ue(mr).call(mr,vr)});var Dt=this.myTeamMembersMap[cr];this.db.enable&&this.db.updateTeamMember(Dt),this.mergeMyTeamMembers(Dt),this.onUpdateTeamMember(Dt)}}if(Lt&&tr.enable){if(c(mr).call(mr,this.account)===-1){var gr=tr.removeTeamMembersByAccounts(cr,mr),yr=a.resolve();return Lt&&(yr=tr.putTeam(Lt)),a.all([gr,yr])}return tr.leaveTeam(cr)}},$e.updateTeamManagers=function(Lt,cr,mr,tr,At){var kt=this.db,Dt=Lt.attach.members=o(mr).call(mr,function(Mr){return{id:ar.genId(cr,Mr),type:tr?"manager":"normal",updateTime:At,account:Mr}}),gr={teamId:""+cr,memberUpdateTime:At};Lt.attach.team=gr;var yr={team:gr,accounts:mr,isManager:tr,members:Dt};if(this.logger.info("team::updateTeamManagers:",cr,mr,tr),this.options.onUpdateTeamManagers(_e.simpleClone(yr)),kt.enable){var vr=kt.updateTeam(gr),Ir=kt.updateTeamManagers(cr,mr,tr,At);return a.all([vr,Ir])}},$e.updateSuperTeamManagers=function(Lt,cr,mr,tr,At){var kt=this.db,Dt=Lt.attach.members=o(mr).call(mr,function(Mr){return{id:ar.genId(cr,Mr),teamId:cr,account:Mr,type:tr?"manager":"normal",updateTime:At}}),gr={teamId:""+cr,memberUpdateTime:At};Lt.attach.team=gr;var yr={team:gr,accounts:mr,isManager:tr,members:Dt};if(this.logger.info("team::updateSuperTeamManagers:",cr,mr,tr),this.options.onUpdateSuperTeamManagers(_e.simpleClone(yr)),kt.enable){var vr=kt.updateSuperTeam(gr),Ir=kt.updateSuperTeamMembers(Dt);return a.all([vr,Ir])}},$e.onDismissTeam=function(Lt,cr){var mr=this.db,tr={teamId:Lt};if(this.logger.info("team::onDismissTeam:",Lt),this.options.onDismissTeam(tr),mr.enable)return mr.dismissTeam(Lt,cr)},$e.transferTeam=function(Lt,cr,mr,tr){var At=this.db,kt=cr.teamId,Dt=cr.memberUpdateTime,gr={id:ar.genId(kt,mr),type:"normal",updateTime:Dt},yr={id:ar.genId(kt,tr),type:"owner",updateTime:Dt};Lt.attach.members=[gr,yr];var vr={team:cr,from:gr,to:yr};if(this.logger.info("team::transferTeam: from to",kt,mr,tr),this.options.onTransferTeam(_e.simpleClone(vr)),At.enable)return At.transferTeam(cr,mr,tr)},$e.transferSuperTeam=function(Lt,cr,mr,tr){var At=this.db,kt=cr.teamId,Dt=cr.memberUpdateTime,gr={teamId:kt,type:"normal",account:mr,updateTime:Dt},yr={teamId:kt,type:"owner",account:tr,updateTime:Dt};Lt.attach.members=[gr,yr];var vr={team:cr,from:gr,to:yr};if(this.logger.info("team::transferSuperTeam: from to ",kt,mr,tr),this.options.onTransferSuperTeam(_e.simpleClone(vr)),At.enable)return At.transferSuperTeam(cr,gr,yr)},$e.onUpdateTeamMembersMute=function(Lt,cr,mr,tr){var At=this.db,kt=o(mr).call(mr,function(vr){return{id:ar.genId(cr.teamId,vr),account:vr,teamId:cr.teamId,mute:tr,updateTime:cr.memberUpdateTime}});Lt.attach.members=kt;var Dt={team:cr,accounts:mr,members:kt,mute:tr};if(this.logger.info("team::onUpdateTeamMembersMute:",cr.teamId,mr,tr),this.options.onUpdateTeamMembersMute(_e.simpleClone(Dt)),At.enable){var gr=At.updateTeamMembers(kt),yr=At.putTeam(cr);return a.all([gr,yr])}},$e.onUpdateSuperTeamMembersMute=function(Lt,cr,mr,tr){var At=this.db,kt=o(mr).call(mr,function(vr){return{id:pr.genId(cr.teamId,vr),account:vr,teamId:cr.teamId,mute:tr,updateTime:cr.memberUpdateTime}});Lt.attach.members=kt;var Dt={team:cr,accounts:mr,members:kt,mute:tr};if(this.logger.info("team::onUpdateSuperTeamMembersMute:",cr.teamId,mr,tr),this.options.onUpdateSuperTeamMembersMute(_e.simpleClone(Dt)),At.enable){var gr=At.updateSuperTeamMembers(kt),yr=At.putSuperTeam(cr);return a.all([gr,yr])}},$e.onHistoryMsgs=function(Lt){Lt.error||(Lt.obj.msgs=this.message.reverseMsgs(Lt.content.msgs))},$e.onmsgFtsInServer=function(Lt){if(!Lt.error){var cr=this.message.reverseMsgs(Lt.content.msgs);Lt.obj.msgs=cr,Lt.content.msgs=cr}},$e.isFilterMsgs=function(Lt){return!!i(Lt[0])},$e.splitMsgs=function(Lt,cr,mr,tr){s(Lt).call(Lt,function(At){if(i(At))tr.push(At);else switch(At.scene){case"p2p":cr.push(At);break;case"team":mr.push(At)}})},$e.markMsgRead=function(Lt,cr){if(_e.isArray(Lt)||(Lt=[Lt]),this.db.enable||this.options.autoMarkRead||cr){var mr=o(Lt).call(Lt,function(tr){return{flag:"msg",idServer:tr.idServer,scene:tr.scene,filter:i(tr),type:tr.type,attachType:tr.attach&&tr.attach.type}});this.msgAckBufferManager.add(mr)}},$e.markSysMsgRead=function(Lt,cr){if(_e.isArray(Lt)||(Lt=[Lt]),this.db.enable||this.options.autoMarkRead||cr){var mr=o(Lt).call(Lt,function(tr){return{flag:"systemMsg",idServer:tr.idServer,scene:tr.scene,filter:i(tr),type:tr.type}});this.msgAckBufferManager.add(mr)}},$e.handleMsgsAck=function(Lt){var cr,mr=this,tr={p2pSysMsgs:{sid:7,cid:3,msgs:[]},p2pMsgs:{sid:7,cid:2,msgs:[]},superTeamSysMsgs:{sid:21,cid:19,msgs:[]},teamMsgs:{sid:8,cid:3,msgs:[]},filterSysMsgs:{sid:101,cid:3,msgs:[]},filterMsgs:{sid:101,cid:2,msgs:[]},netcallMsgs:{sid:9,cid:11,msgs:[]}};s(Lt).call(Lt,function(At){/^(netcallBill|netcallMiss|netcallReject)$/.test(At.attachType)?tr.netcallMsgs.msgs.push(At):i(At)?At.flag==="systemMsg"?tr.filterSysMsgs.msgs.push(At):tr.filterMsgs.msgs.push(At):At.flag!=="systemMsg"?At.scene==="p2p"?tr.p2pMsgs.msgs.push(At):At.scene==="team"&&tr.teamMsgs.msgs.push(At):At.scene==="superTeam"?tr.superTeamSysMsgs.msgs.push(At):tr.p2pSysMsgs.msgs.push(At)}),s(cr=d(tr)).call(cr,function(At){return mr.doMarkMsgsRead(tr[At].sid,tr[At].cid,tr[At].msgs)})},$e.doMarkMsgsRead=function(Lt,cr,mr){mr&&mr.length&&(this.logger.log("markMsgRead::batchMarkRead",Lt,cr,mr),this.sendCmd("batchMarkRead",{sid:Lt,cid:cr,ids:o(mr).call(mr,function(tr){return tr.idServer})}))}},function(t,n,e){var r=e(51),s=e(10),i=e(2),o=e(4),a=e(16),d=e(3),c=e(37),u=e(52),m=e(53),y=e(54),S=e(55),O=e(43);function k(oe,he){var Ie=o(oe);if(u){var ie=u(oe);he&&(ie=a(ie).call(ie,function(Ne){return m(oe,Ne).enumerable})),Ie.push.apply(Ie,ie)}return Ie}function g(oe){for(var he=1;he<arguments.length;he++){var Ie,ie,Ne=arguments[he]!=null?arguments[he]:{};he%2?i(Ie=k(Object(Ne),!0)).call(Ie,function(Ve){r(oe,Ve,Ne[Ve])}):y?S(oe,y(Ne)):i(ie=k(Object(Ne))).call(ie,function(Ve){O(oe,Ve,m(Ne,Ve))})}return oe}var v=e(35).fn,ue=e(756),L=e(758);function re(oe,he,Ie){var ie=this,Ne=this.timetags&&this.timetags.sync;this.db.enable&&Ne&&he&&this.db.getMsgByIdClient(oe).then(function(Ve){if(Ve&&!(Ve.commentTimetag&&Ve.commentTimetag<=Ne&&Ve.time<=Ne)){if(Ve.commentTimetag=he.time,Ve.comments=Ve.comments||[],Ie){var Ce;Ve.comments=a(Ce=Ve.comments).call(Ce,function($e){return $e.body!==he.body||$e.from!==he.from})}else{for(var Ue,qe=0;qe<Ve.comments.length;qe++)if(Ve.comments[qe].from===he.from&&Ve.comments[qe].body===he.body){Ve.comments[qe]=he,Ue=!0;break}Ue||Ve.comments.push(he)}var Oe={idClient:Ve.idClient,comments:Ve.comments,commentTimetag:Ve.commentTimetag};ie.db.updateMsg(Oe)}})}function le(oe){oe.scene=this.message.sceneReverseMap[+oe.scene]||oe.scene,oe.time=+oe.time}v.processMsgExtend=function(oe){switch(oe.cmd){case"getThreadMsgs":this.onGetThreadMsgs(oe);break;case"getMsgsByIdServer":this.onGetMsgsByIdServer(oe);break;case"addQuickComment":this.changeQuickComment(oe);break;case"deleteQuickComment":this.changeQuickComment(oe,!0);break;case"onQuickComment":case"syncAddQuickComment":this.onQuickComment(oe);break;case"onDeleteQuickComment":case"syncDeleteQuickComment":this.onQuickComment(oe,!0);break;case"getQuickComments":this.getQuickComments(oe);break;case"addCollect":case"updateCollect":this.addCollect(oe);break;case"deleteCollects":this.deleteCollects(oe);break;case"getCollects":this.getCollects(oe);break;case"addStickTopSession":case"syncAddStickTopSession":this.onChangeStickTopSession(oe,"add");break;case"updateStickTopSession":case"syncUpdateStickTopSession":this.onChangeStickTopSession(oe,"update");break;case"deleteStickTopSession":case"syncDeleteStickTopSession":this.onChangeStickTopSession(oe,"delete");break;case"addMsgPin":case"onAddMsgPin":case"syncAddMsgPin":this.pinMsgChange(oe,"add");break;case"updateMsgPin":case"onUpdateMsgPin":case"syncUpdateMsgPin":this.pinMsgChange(oe,"update");break;case"deleteMsgPin":case"onDeleteMsgPin":case"syncDeleteMsgPin":this.pinMsgChange(oe,"delete");break;case"getMsgPins":this.getMsgPins(oe)}},v.onGetThreadMsgs=function(oe){if(!oe.error){var he;oe.obj.msgs=this.message.reverseMsgs(oe.content.msgs),oe.obj.threadMsg=s(he=this.message).call(he,oe.content.threadMsg);var Ie=oe.content.threadMsgsMeta||{};oe.obj.total=Ie.total,oe.obj.timetag=Ie.lastMsgTime}},v.onGetMsgsByIdServer=function(oe){oe.error||(oe.obj.msgs=this.message.reverseMsgs(oe.content.msgs))},v.changeQuickComment=function(oe,he){oe.error||(oe.obj.comment.time=oe.content.timetag,oe.obj.comment=s(ue).call(ue,oe.obj.comment),le.call(this,oe.obj.msg),re.call(this,oe.obj.msg.idClient,oe.obj.comment,he))},v.onQuickComment=function(oe,he){if(oe.content){var Ie=oe.content,ie=Ie.comment,Ne=Ie.msg;ie&&Ne&&(le.call(this,Ne),ie=s(ue).call(ue,ie),he?this.options.onDeleteQuickComment(oe.content.msg,ie):this.options.onQuickComment(oe.content.msg,ie),re.call(this,Ne.idClient,ie,he))}},v.getQuickComments=function(oe){var he,Ie=this;if(!oe.error){var ie=oe.obj.idMap,Ne=oe.obj.indexMap,Ve=oe.content&&oe.content.commentRes||[];i(Ve).call(Ve,function(Ce){var Ue=[],qe=Ie.parser.unserializeMap.comment;if(+Ce.modify==1)try{Ue=JSON.parse(Ce.detail)}catch($e){Ie.logger.warn("getQuickComments parse detail error",$e)}if(i(Ue).call(Ue,function($e,_e){var er,Pt={};i(er=o($e)).call(er,function(ar){Pt[qe[ar]]=$e[ar]}),Pt=s(ue).call(ue,Pt),Ue[_e]=Pt}),Ce.timestamp=+Ce.timestamp,ie[Ce.idClient]){var Oe={idClient:Ce.idClient,commentTimetag:Ce.timestamp};ie[Ce.idClient].commentTimetag=Ce.timestamp,+Ce.modify==1&&(ie[Ce.idClient].comments=Ue,Oe.comments=Ue),Ie.db.enable&&Ie.db.updateMsg(Oe)}else ie[Ce.idClient]={idServer:Ce.idServer,idClient:Ce.idClient,comments:Ue,commentTimetag:Ce.timestamp,scene:Ie.message.sceneReverseMap[Ce.scene]||Ce.scene}}),oe.obj=[],i(he=o(Ne)).call(he,function(Ce){oe.obj[Ne[Ce]]=ie[Ce]})}},v.addCollect=function(oe){oe.error||(oe.obj.collect=s(L).call(L,oe.content.collect))},v.deleteCollects=function(oe){oe.error||(oe.obj.deleteNum=oe.content.deleteNum)},v.getCollects=function(oe){if(!oe.error){var he=[],Ie=oe.content.collectList||[];i(Ie).call(Ie,function(ie){he.push(s(L).call(L,ie))}),oe.obj.collectList=he,oe.obj.total=oe.content.total}},v.onChangeStickTopSession=function(oe,he){var Ie=this;if(!oe.error){var ie=oe.content.stickTopSession||oe.obj.stickTopSession||{},Ne=oe.content.timetag||+ie.updateTime,Ve=ie.id.split("|");Ve[0]==="super_team"&&(Ve[0]="superTeam"),ie={id:Ve.join("-"),scene:Ve[0],to:Ve[1],topCustom:ie.topCustom||""},he==="delete"?ie.isTop=!1:he==="add"&&(ie.isTop=!0),ie=this.onUpdateSession(ie),oe.obj&&(oe.obj.stickTopSession=ie),this.db.enable&&(this.db.updateSession(ie).then(function(Ce){Ce||Ie.db.putSession(ie)}),this.db.updateTimetag("stickTopSessions",Ne))}},v.pinMsgChange=function(oe,he){var Ie=this;if(!oe.error){oe.content=oe.content||{};var ie=this,Ne=this.db,Ve=oe.obj&&oe.obj.msg,Ce=oe.content.msg||Ve||{},Ue=oe.content.pinTag||oe.obj.pinTag,qe=oe.content.timetag||+Ue.updateTime,Oe=d.resolve();le.call(this,Ce),Ne.enable&&(Oe=Ne.getMsgByIdClient(Ce.idClient)),Ue.createTime&&(Ue.createTime=+Ue.createTime),Ue.updateTime&&(Ue.updateTime=+Ue.updateTime),Oe.then(function($e){return Ce=$e||Ce,$e?Ce=$e:Ce.sessionId=Ce.scene+"-"+Ie.message.Message.getMsgTarget(Ce,Ie.account),Ve?(oe.obj.msg=Ce,oe.obj.pinTag=Ue):Ie.options.onPinMsgChange({msg:Ce,pinTag:Ue},he),function(){Ne.enable&&Ne[he==="delete"?"deleteMsgPin":"putMsgPin"](g(g({},Ce),{},{pinFrom:Ue.pinFrom,pinCustom:Ue.pinCustom})).then(function(){var _e="pin-"+Ce.sessionId,er=ie.timetags.sync;return Ne.getTimetag(_e).then(function(Pt){return Pt>er?Ne.updateTimetag(_e,qe):d.resolve()})}).catch(function(_e){ie.logger.error("msgExtend::pinMsgChange:error",_e)})}(),d.resolve}).then(function(){}),oe.promise=Oe}},v.getMsgPins=function(oe){var he=this;if(!oe.error){var Ie=this.db,ie=oe.content||{};if(ie.pins=ie.pins||[],ie.modify){var Ne,Ve=[];Ie.enable&&(Ie.updateTimetag("pin-"+oe.obj.id,ie.timetag),i(Ne=ie.pins).call(Ne,function(Ce){Ce.sessionId=oe.obj.id,Ve.push(Ie.getMsgByIdClient(Ce.idClient))})),oe.promise=d.all(Ve).then(function(Ce){var Ue;i(Ue=ie.pins).call(Ue,function(qe,Oe){Ce[Oe]?c(qe,Ce[Oe]):(qe.sessionId=oe.obj.id,le.call(he,qe))}),oe.obj.pins=ie.pins,Ie.enable&&Ie.deleteMsgPins(oe.obj.id).then(function(){return Ie.putMsgPins(ie.pins)}).catch(function(qe){he.logger.error("msgExtend::getMsgPins:change db error",qe)})})}else Ie.enable?(Ie.updateTimetag("pin-"+oe.obj.id,ie.timetag),oe.promise=Ie.getMsgPins(oe.obj.id).then(function(Ce){oe.obj.pins=Ce||[]})):oe.obj.pins=[]}}},function(t,n,e){var r=e(818);t.exports=r},function(t,n,e){e(819);var r=e(13);t.exports=r.Number.isInteger},function(t,n,e){e(1)({target:"Number",stat:!0},{isInteger:e(820)})},function(t,n,e){var r=e(28),s=Math.floor;t.exports=Number.isInteger||function(i){return!r(i)&&isFinite(i)&&s(i)===i}},function(t,n,e){var r=e(125),s=e(3),i=e(2),o=e(6),a=["time","from"],d=e(35).fn,c=e(0);d.onOfflineMsgReceipts=function(u){var m,y=this,S=y.db,O=u.content.msgReceipts,k=[],g=s.resolve();this.logger.info("onOfflineMsgReceipts",O),i(O).call(O,function(v){m={id:"p2p-"+v.from,msgReceiptTime:+v.time},y.cacheSyncedSession(m)}),y.syncResult.msgReceipts=k,S.enable&&(g=S.updateMsgReceiptsTimetag(u.content.timetag)),g.cmd=k,y.syncPromiseArray.push(g)},d.shouldUpdateSessionFromMsgReceipt=function(u,m){return!u||!u.msgReceiptServerTime||m.time>u.msgReceiptServerTime},d.genSessionFromMsgReceipt=function(u,m){var y=m.time,S={id:m.sessionId,msgReceiptTime:y,msgReceiptServerTime:y};return u&&u.id===m.sessionId&&(S=c.merge({},u,S)),u&&u.updateTime||(S.updateTime=y),S},d.onMsgReceipt=function(u){var m=this,y=m.db,S=u.content.msgReceipt;S.time=+S.time;var O=S.idClient,k=s.resolve();y.enable&&O&&(k=y.getMsgByIdClient(O)),this.logger.info("onMsgReceipt::",S),k.then(function(g){if(g){if(!g.idServer)return void(m.msgReceiptTasks[O]=S);g.time}else S.time;S.msgReceiptTime=S.time,S.sessionId="p2p-".concat(S.from),m.updateSessionMsgReceiptTime(S),S.time,S.from;var v=r(S,a);m.options.onMsgReceipts([v])})},d.resolveMsgReceiptTask=function(u){var m=this.msgReceiptTasks[u.idClient];m&&(m.msgReceiptTime=u.time,this.updateSessionMsgReceiptTime(m))},d.updateSessionMsgReceiptTime=function(u){var m=this.db,y={id:"p2p-"+u.from,msgReceiptTime:u.msgReceiptTime,msgReceiptServerTime:u.time};(this.getSessionInCache(y.id)||{}).msgReceiptTime>=y.msgReceiptTime?this.logger.warn("receive old msgReceiptTime",u):(m.enable&&m.putSession(y),this.onUpdateSession(y))},d.onSendMsgReceipt=function(u){var m;if(!u.error)if(u.obj&&u.obj.msgReceipt){var y=u.obj.msgReceipt,S=+y.time,O=+u.content.msgReceipt.time,k=this.getSessionInCache("p2p-"+y.to);k?(this.logger.info(o(m="sendMsgReceipt on:: param time ".concat(S,", res time ")).call(m,O)),k.msgReceiptSendTime=Math.min(S,O)):this.logger.info("sendMsgReceipt on:: session is undefined or logically deleted, failed to send read receipt")}else this.logger.info("sendMsgReceipt on:: origin msg is missing, it maybe timeout")},d.shouldSendMsgReceipt=function(u){if(u&&u.scene==="p2p"&&u.status==="success"){var m=this.getSessionInCache(u.sessionId);if(m){var y=m.msgReceiptSendTime;return!y||y<u.time}}return!1},d.isMsgRemoteRead=function(u){if(u&&u.scene==="p2p"&&u.flow==="out"&&u.status==="success"){var m=this.getSessionInCache(u.sessionId);if(m&&m.msgReceiptTime)return u.time<=m.msgReceiptTime}return!1}},function(t,n,e){var r=e(57),s=e(58),i=e(60),o=e(10),a=e(2),d=e(6),c=e(9),u=e(3),m=e(90),y=e(123),S=e(4),O=e(16),k=e(48),g=e(15),v=e(26),ue=e(158),L=e(88),re=e(89),le=e(72),oe=e(32);function he(_e,er){var Pt=re!==void 0&&le(_e)||_e["@@iterator"];if(!Pt){if(oe(_e)||(Pt=function(nr,ir){var dr;if(nr){if(typeof nr=="string")return Ie(nr,ir);var Lt=g(dr=Object.prototype.toString.call(nr)).call(dr,8,-1);if(Lt==="Object"&&nr.constructor&&(Lt=nr.constructor.name),Lt==="Map"||Lt==="Set")return L(nr);if(Lt==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(Lt))return Ie(nr,ir)}}(_e))||er&&_e&&typeof _e.length=="number"){Pt&&(_e=Pt);var ar=0,pr=function(){};return{s:pr,n:function(){return ar>=_e.length?{done:!0}:{done:!1,value:_e[ar++]}},e:function(nr){throw nr},f:pr}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var lr,or=!0,xe=!1;return{s:function(){Pt=Pt.call(_e)},n:function(){var nr=Pt.next();return or=nr.done,nr},e:function(nr){xe=!0,lr=nr},f:function(){try{or||Pt.return==null||Pt.return()}finally{if(xe)throw lr}}}}function Ie(_e,er){(er==null||er>_e.length)&&(er=_e.length);for(var Pt=0,ar=new Array(er);Pt<er;Pt++)ar[Pt]=_e[Pt];return ar}var ie=e(35).fn,Ne=e(153),Ve=e(154),Ce=e(0),Ue=e(107).EMSyncType;function qe(_e,er){return Oe.apply(this,arguments)}function Oe(){return(Oe=s(r.mark(function _e(er,Pt){var ar,pr,lr,or,xe,nr,ir,dr,Lt,cr,mr,tr,At,kt=this;return r.wrap(function(Dt){for(;;)switch(Dt.prev=Dt.next){case 0:if(lr=(pr=this).db,or=[],a(er).call(er,function(gr){kt.revokeMsgUniqueCheck(gr.idClient),or.push(gr.idClient)}),pr.options.rollbackDelMsgUnread){Dt.next=14;break}return Dt.next=7,lr.deleteMsg(or);case 7:if(Dt.t0=Dt.sent,Dt.t0){Dt.next=10;break}Dt.t0=[];case 10:return xe=Dt.t0,xe=Object.prototype.toString.call(xe)==="[object Array]"?xe:[xe],pr.logger.info("msg::_deleteMsgSelfBatchInDb, rollback false, affect: ".concat(xe.length," rows")),Dt.abrupt("return");case 14:return nr=!1,ir=pr.options.cbUpdateSession||v(ar=pr.updateSessionInDbWithNotify).call(ar,pr),dr=pr.getSessionInCache(Pt)||{id:Pt},Lt=dr.lastMsg||{},ue(or).call(or,Lt.idClient)&&(nr=!0),pr.logger.info("msg::_deleteMsgSelfBatchInDb session change before:",Pt,nr,dr.unread),Dt.next=22,lr.deleteMsg(or);case 22:if(Dt.t1=Dt.sent,Dt.t1){Dt.next=25;break}Dt.t1=[];case 25:if(cr=Dt.t1,cr=Object.prototype.toString.call(cr)==="[object Array]"?cr:[cr],pr.logger.info("msg::_deleteMsgSelfBatchInDb affect:",cr.length," rows"),!nr){Dt.next=34;break}return Dt.next=31,lr.getMsgs({sessionId:Pt,limit:1});case 31:mr=Dt.sent,Lt=mr&&mr[0]?mr[0]:null,dr.lastMsg=Lt;case 34:if(tr=!1,dr&&dr.unread&&(At=dr&&dr.ack||0,a(cr).call(cr,function(gr){var yr=!0;if(gr.type==="notification")try{yr=pr.options.shouldCountNotifyUnread(gr)}catch(vr){throw pr.logger.error("userOption:shouldCountNotifyUnread function error",vr),vr}yr&&At<gr.time&&gr.flow==="in"&&(dr.unread=dr.unread>0?dr.unread-1:0,tr=!0)})),!nr&&!tr){Dt.next=39;break}return pr.logger.info("msg::_deleteMsgSelfBatchInDb session change after:",Pt,dr.unread),Dt.abrupt("return",ir(dr));case 39:case"end":return Dt.stop()}},_e,this)}))).apply(this,arguments)}function $e(_e,er){er=er||new Date().getTime();var Pt=this.db,ar=this.getSessionInCache(_e),pr=this.options.rollbackClearMsgsUnread!==!1,lr=[];return Pt.enable&&lr.push(Pt.deleteMsgsBySessionId({sessionId:_e,end:er})),pr&&ar&&(ar=this.mergeSession({id:ar.id,unread:0,lastMsg:null,unreadMsgs:[]}),ar=this.onUpdateSession(ar)),Pt.enable&&pr&&ar&&lr.push(Pt.updateSession(ar)),u.all(lr)}ie.onDeleteMsg=function(_e){var er=this.db;if(delete _e.obj.sysMsg,!_e.error){var Pt=_e.obj.msg;_e.promise=this.deleteLocalMsg(Pt).then(function(){if(er.enable){var ar=Pt.scene==="superTeam"?"deleteSuperTeamMsg":"deleteMsg";er.getTimetag(ar).then(function(pr){pr=pr||0,i()+1>=pr&&er.updateTimetag(ar,i()+1)})}})}},ie.onMsgDeleted=function(_e,er){var Pt=this;if(!Pt.canHandleDeletedMsgInSyncing)return Pt.logger.info("msg::onMsgDeleted:is in syncing ..."),void Pt.unhandledSysMsgsForDeletedMsgs.push({packet:_e,isSuperTeam:er});if(!_e.error){var ar=Pt.db,pr=o(Ne).call(Ne,_e.content.sysMsg);pr=Pt.processDeleteMsgSysMsg(pr),er||Pt.markSysMsgRead(pr),Pt.deleteLocalMsg(pr.msg).then(function(){if(ar.enable){var lr=er?"deleteSuperTeamMsg":"deleteMsg";ar.updateTimetag(lr,pr.time+1)}Pt.handleSysMsg(pr)})}},ie.processDeleteMsgSysMsg=function(_e){var er;return _e.msg={},a(er=["scene","from","to"]).call(er,function(Pt){_e.msg[Pt]=_e[Pt]}),_e.msg.idClient=_e.deletedIdClient,_e.msg.idServer=_e.deletedIdServer,_e.msg.time=_e.deletedMsgTime,_e.msg.fromNick=_e.deletedMsgFromNick,_e.opeAccount=_e.opeAccount||_e.from,_e.msg.opeAccount=_e.opeAccount,this.message.Message.setExtra(_e.msg,this.account),_e},ie.onDeleteMsgOfflineRoaming=function(_e){if(!_e.error){var er,Pt=this,ar=+_e.content.type==1?"offline":"roaming",pr=Ne.reverseSysMsgs(_e.content.sysMsgs,{mapper:function(nr){return Pt.processDeleteMsgSysMsg(nr)}}),lr=pr&&pr[0]&&pr[0].scene==="superTeam";Pt.logger.info(d(er="msg::onDeleteMsgOfflineRoaming: on delete ".concat(ar," ")).call(er,lr?"superTeam":""," idServer deletedIdClient deletedIdClient="),c(pr).call(pr,function(nr){var ir,dr;return d(ir=d(dr="".concat(nr.idServer,"-")).call(dr,nr.deletedIdServer,"-")).call(ir,nr.deletedIdClient)})),ar==="offline"&&Pt.markSysMsgRead(pr);var or=_e.content.timetag;lr?(Pt.timetags.deleteSuperTeamMsg=or,Pt.syncResult.deleteSuperTeamMsgTimetag=or):(Pt.timetags.deleteMsg=or,Pt.syncResult.deleteMsgTimetag=or);var xe=Pt.putSysMsg(pr,"offlineSysMsgs").catch(function(nr){return Pt.logger.error("msgDelete::onDeleteMsgOfflineRoaming: ",nr),u.reject(nr)});xe.cmd="deleteMsgSysMsgs "+ar,Pt.syncPromiseArray.push(xe),Pt.syncResult.deleteMsgSysMsgs=Pt.syncResult.deleteMsgSysMsgs||[],Pt.syncResult.deleteMsgSysMsgs.push({type:ar,sysMsgs:pr})}},ie.deleteMsgOfflineRoaming=function(_e,er){if(!_e)return u.resolve();var Pt=this;Pt.logger.info("msg::deleteMsgOfflineRoaming: ",c(_e).call(_e,function(lr){var or;return lr.type+" "+c(or=lr.sysMsgs).call(or,function(xe){var nr,ir;return d(nr=d(ir="".concat(xe.idServer,"-")).call(ir,xe.deletedIdServer,"-")).call(nr,xe.deletedIdClient)})}),Ce.secureOutput("session",er));var ar=Pt.db,pr=[];return a(_e).call(_e,function(lr){var or;a(or=lr.sysMsgs).call(or,function(xe){var nr=Pt.deleteLocalMsg(xe.msg,{cbUpdateSession:function(ir){ir=Pt.mergeSession(ir),ir=m(Ve).call(Ve,ir);var dr=Ce.findObjIndexInArray(er,{value:ir.id});if(dr!==-1&&(er[dr]=Ce.merge({},er[dr],ir)),ar.enable)return ar.updateSession(ir)}});pr.push(nr)})}),u.all(pr).then(function(){ar.enable&&(Pt.syncResult.deleteMsgTimetag&&ar.updateTimetag("deleteMsg",Pt.syncResult.deleteMsgTimetag),Pt.syncResult.deleteSuperTeamMsgTimetag&&ar.updateTimetag("deleteSuperTeamMsg",Pt.syncResult.deleteSuperTeamMsgTimetag))})},ie.deleteMsgSelf=function(_e){if(!_e.error){var er=this.db,Pt=_e.obj&&_e.obj.deleteMsgSelfTag;if(Pt){var ar=_e.content&&_e.content.timetag;Pt.scene=Pt.scene+""=="1"?"p2p":"team";var pr=[this.deleteLocalMsg(Pt)];ar<=this.timetags.deleteMsgSelf||(this.timetags.deleteMsgSelf=ar,er.enable&&pr.push(er.updateDeleteMsgSelf(ar))),_e.promise=u.all(pr)}}},ie.deleteMsgSelfBatch=function(){var _e=s(r.mark(function er(Pt){var ar,pr,lr,or,xe,nr,ir,dr;return r.wrap(function(Lt){for(;;)switch(Lt.prev=Lt.next){case 0:if(!Pt.error){Lt.next=2;break}return Lt.abrupt("return");case 2:if(pr=this,lr=this.db,(or=Pt.obj&&Pt.obj.deleteMsgSelfTags)&&or.length>0){Lt.next=7;break}return Lt.abrupt("return");case 7:if(xe=y(or).call(or,function(cr,mr){var tr=mr.sessionId;if(cr[tr]=cr[tr]||[],cr[tr].push(mr),!lr.enable){var At=pr.getSessionInCache(tr);At&&At.lastMsg&&mr&&At.lastMsg.idClient===mr.idClient&&(At.lastMsg=null,pr.onUpdateSession(At))}return cr},{}),lr.enable){Lt.next=11;break}return a(nr=S(xe)).call(nr,function(cr){var mr=xe[cr],tr=pr.getSessionInCache(cr);if(pr.options.rollbackDelMsgUnread&&tr){var At=tr.ack||0,kt=O(mr).call(mr,function(Dt){var gr=!0;if(Dt.type==="notification")try{gr=pr.options.shouldCountNotifyUnread(Dt)}catch(yr){throw pr.logger.error("userOption:shouldCountNotifyUnread function error",yr),yr}return pr.message.Message.setFlow(Dt,pr.account),gr&&At<Dt.time&&Dt.flow==="in"});kt.length>0&&tr.unread&&(tr.unread=tr.unread-kt.length>=0?tr.unread-kt.length:0,pr.onUpdateSession(tr))}}),Lt.abrupt("return",u.resolve());case 11:ir=c(ar=S(xe)).call(ar,function(cr){var mr=xe[cr];return qe.call(pr,mr,cr)}),(dr=Pt.content&&Pt.content.timetag)<=pr.timetags.deleteMsgSelf||(pr.timetags.deleteMsgSelf=dr,ir.push(lr.updateDeleteMsgSelf(dr))),Pt.promise=u.all(ir);case 15:case"end":return Lt.stop()}},er,this)}));return function(er){return _e.apply(this,arguments)}}(),ie.onDeleteMsgSelf=function(_e){var er=this,Pt=this.db,ar=_e.content.deleteMsgSelfTag;ar.scene=ar.scene+""=="1"?"p2p":"team",er.options.onDeleteMsgSelf([ar]),er.deleteLocalMsg(ar).then(function(){var pr=ar.deletedTime;return pr<=er.timetags.deleteMsgSelf||!Pt.enable?u.resolve():(er.timetags.deleteMsgSelf=pr,Pt.updateDeleteMsgSelf(pr))}).catch(function(pr){er.logger.error("onDeleteMsgSelf error",pr)})},ie.onDeleteMsgSelfBatch=function(_e){var er=this;if(!_e.error){var Pt={1:"p2p",2:"team"},ar=Ce.get(_e,"content.deleteMsgSelfTags")||[];a(ar).call(ar,function(lr){var or;lr.scene=Pt[lr.scene],lr.sessionId=d(or="".concat(lr.scene,"-")).call(or,er.message.Message.getMsgTarget(lr,er.account)),lr.deletedTime=k(lr.deletedTime),lr.time=k(lr.time)});var pr=Ce.get(_e,"content.deleteMsgSelfTags[0].deletedTime");pr=k(pr)||0,this.options.onDeleteMsgSelf(ar),this.deleteMsgSelfBatch({obj:{deleteMsgSelfTags:ar},content:{timetag:pr}})}},ie.clearServerHistoryMsgs=function(_e){if(!_e.error){var er=this.db,Pt=_e.obj&&_e.obj.clearMsgsParamsWithSync;if(Pt){var ar=(Pt.type&&Pt.type.toString()==="2"?"team":"p2p")=="p2p"?"p2p-".concat(Pt.otherAccid):"team-".concat(Pt.toTid),pr=_e.content&&k(_e.content.timetag);pr&&pr>this.timetags.sessionHistoryMsgsDelete&&(this.timetags.sessionHistoryMsgsDelete=pr,er.enable&&er.updateTimetag("sessionHistoryMsgsDelete",this.timetags.sessionHistoryMsgsDelete)),$e.call(this,ar,pr)}}},ie.onClearServerHistoryMsgs=function(_e){if(!_e.error){var er=this.db,Pt=_e.content&&_e.content.sessionHistoryMsgsDeleteTag;if(Pt){var ar=(Pt.type&&Pt.type.toString()==="2"?"team":"p2p")=="p2p"?"p2p-".concat(Pt.otherAccid):"team-".concat(Pt.toTid),pr=Pt.ext,lr=k(Pt.time);this.options.onClearServerHistoryMsgs&&this.options.onClearServerHistoryMsgs([{sessionId:ar,time:lr,ext:pr}]),lr<=this.timetags.sessionHistoryMsgsDelete||(this.timetags.sessionHistoryMsgsDelete=lr,er.enable&&er.updateTimetag("sessionHistoryMsgsDelete",this.timetags.sessionHistoryMsgsDelete)),$e.call(this,ar,lr)}}},ie.syncSessionHistoryMsgsDelete=function(_e){if(!_e.error){var er=this.db,Pt=_e.content&&_e.content.sessionHistoryMsgsDeleteTags;if(Pt&&Pt.length>0){var ar=c(Pt).call(Pt,function(lr){return{sessionId:(lr.type&&lr.type.toString()==="2"?"team":"p2p")=="p2p"?"p2p-".concat(lr.otherAccid):"team-".concat(lr.toTid),time:k(lr.time)}});this.reporterHook.emit("reporter/syncItemComplete",Ue.kSyncType4_24),this.options.onClearServerHistoryMsgs&&this.options.onClearServerHistoryMsgs(ar),this.syncResult.clearServerHistoryMsgs=ar;var pr=0;a(ar).call(ar,function(lr){lr.time>pr&&(pr=lr.time)}),er.enable&&er.updateTimetag("sessionHistoryMsgsDelete",pr)}}},ie.syncDeleteMsgSelf=function(_e){var er=this,Pt=this.db,ar=_e.content.deletedMsgs;if(ar&&ar.length!==0){var pr=[];a(ar).call(ar,function(lr){lr.scene=lr.scene==="1"?"p2p":"team",lr.deletedTime=+lr.deletedTime,lr.time=+lr.time,pr.push(er.deleteLocalMsg(lr))}),er.options.onDeleteMsgSelf(ar),u.all(pr).then(function(){var lr=g(ar).call(ar,-1)[0].deletedTime;if(!(er.timetags.deleteMsgSelf>=lr))return er.timetags.deleteMsgSelf=lr,Pt.enable?Pt.updateDeleteMsgSelf(lr):void 0}).catch(function(lr){er.logger.error("syncDeleteMsgSelf error",lr)})}},ie.deleteLocalMsg=function(){var _e=s(r.mark(function er(Pt,ar){var pr,lr,or,xe,nr,ir,dr,Lt,cr,mr,tr,At;return r.wrap(function(kt){for(;;)switch(kt.prev=kt.next){case 0:if(Pt){kt.next=2;break}return kt.abrupt("return");case 2:if(or=(lr=this).db,xe=(ar=ar||{}).cbUpdateSession||v(pr=lr.updateSessionInDbWithNotify).call(pr,lr),this.revokeMsgUniqueCheck(Pt&&Pt.idClient),nr=Pt.sessionId||Pt.scene+"-"+this.message.Message.getMsgTarget(Pt,this.account),ir=!1,dr=lr.getSessionInCache(nr),Lt=!0,Pt.type!=="notification"){kt.next=20;break}kt.prev=12,Lt=lr.options.shouldCountNotifyUnread(Pt),kt.next=20;break;case 16:throw kt.prev=16,kt.t0=kt.catch(12),lr.logger.error("userOption:shouldCountNotifyUnread function error",kt.t0),kt.t0;case 20:if(lr.options.rollbackDelMsgUnread&&dr&&(cr=dr.ack||0,Lt&&dr&&cr<Pt.time&&Pt.from!==lr.account&&dr.unread&&(lr.logger.info("msgDelete::deleteLocalMsg:cache.getSessions: unread",dr.id,dr.unread),dr.unread=dr.unread-1,ir=!0)),dr&&dr.lastMsg&&dr.lastMsg.idClient==Pt.idClient&&(lr.logger.info("msgDelete::deleteLocalMsg:cache.getSessions: lastMsg",dr.id,dr.unread),dr.lastMsg=null,ir=!0),!or.enable){kt.next=49;break}return mr=null,kt.next=26,or.getMsgByIdClient(Pt.idClient);case 26:return kt.sent||lr.logger.info("msgDelete::deleteLocalMsg::db.deleteMsg no find in DB",Pt),lr.logger.info("msgDelete::deleteLocalMsg::db.deleteMsg ",Pt.idClient),kt.next=31,or.deleteMsg(Pt.idClient);case 31:if(!dr||dr.lastMsg!==null){kt.next=36;break}return kt.next=34,or.getMsgs({sessionId:nr,limit:1});case 34:(tr=kt.sent)&&tr[0]&&(mr=tr[0]);case 36:if(dr||!lr.options.rollbackDelMsgUnread){kt.next=46;break}return lr.logger.info("msgDelete::deleteLocalMsg::Can not find session in cache,will find in DB",nr),kt.next=40,or.getSession(nr);case 40:if(At=kt.sent){kt.next=43;break}return kt.abrupt("return");case 43:cr=(dr=At).ack||0,Lt&&dr&&cr<Pt.time&&Pt.flow==="in"&&dr.unread&&(lr.logger.info("msgDelete::deleteLocalMsg:db.getSessions: unread",At.id,At.unread),dr.unread=dr.unread-1,ir=!0);case 46:if(dr&&dr.lastMsg===null&&mr&&(lr.logger.info("msgDelete::deleteLocalMsg:db.getSessions: lastMsg",nr,mr),dr.lastMsg=mr||null,ir=!0),!ir){kt.next=49;break}return kt.abrupt("return",xe(dr));case 49:if(or.enable||!ir){kt.next=52;break}return lr.onUpdateSession(dr),kt.abrupt("return");case 52:case"end":return kt.stop()}},er,this,[[12,16]])}));return function(er,Pt){return _e.apply(this,arguments)}}(),ie.deleteLocalMsgs=function(_e){var er=this,Pt=er.db;return new u(function(ar,pr){if(function(lr){var or=er.getSessionInCache(_e.sessionId);if(or&&_e.updateSession){var xe=or.lastMsg;xe&&(!_e.start&&!_e.end||xe.time>_e.start&&xe.time<_e.end)&&(or.lastMsg=null,er.logger.log("deleteLocalMsgs::delete cacheSession lastMsg done, options is",_e),Pt.enable||(er.onUpdateSession(or),lr()))}}(ar),Pt.enable)return Pt.deleteMsgsBySessionId(_e).then(function(){_e.updateSession&&er.checkAndUpdateLocalSessionByMsg(_e.sessionId),ar()},function(lr){return pr(lr)})})},ie.deleteLocalMsgsByTime=function(){var _e=s(r.mark(function er(Pt){var ar,pr,lr,or,xe,nr,ir,dr,Lt,cr,mr,tr,At,kt;return r.wrap(function(Dt){for(;;)switch(Dt.prev=Dt.next){case 0:return pr=(ar=this).db,Dt.next=4,pr.getDeletedMsgsCountByTime(Pt);case 4:return lr=Dt.sent,or=0,xe=[],Dt.next=9,pr.deleteMsgsByTime(Pt);case 9:return Pt.deletedone&&Pt.deletedone({deletedMsgCount:lr}),Dt.next=12,pr.getAllSessions();case 12:nr=Dt.sent,ir=he(nr),Dt.prev=14,ir.s();case 16:if((dr=ir.n()).done){Dt.next=47;break}return Lt=dr.value,cr=Lt.id,mr=!1,Dt.next=22,pr.getSession(cr);case 22:if(tr=Dt.sent){Dt.next=25;break}return Dt.abrupt("continue",45);case 25:return Dt.next=27,pr.getMsgCountAfterAck({shouldCountNotifyUnread:ar.options.shouldCountNotifyUnread,sessionId:cr,ack:tr.ack||0});case 27:if(At=Dt.sent,tr.unread!==At&&(tr.unread=At,mr=!0),!(tr.lastMsg&&tr.lastMsg.time>Pt.start&&tr.lastMsg.time<Pt.end)){Dt.next=39;break}if(Pt.start!==0){Dt.next=34;break}tr.lastMsg=null,Dt.next=38;break;case 34:return Dt.next=36,pr.getMsgs({sessionId:cr,limit:1});case 36:kt=Dt.sent,tr.lastMsg=kt&&kt[0]?kt[0]:null;case 38:mr=!0;case 39:if(!mr){Dt.next=45;break}return Dt.next=42,pr.updateSession(tr);case 42:ar.sessionSet[cr]&&xe.push(tr),or++;case 45:Dt.next=16;break;case 47:Dt.next=52;break;case 49:Dt.prev=49,Dt.t0=Dt.catch(14),ir.e(Dt.t0);case 52:return Dt.prev=52,ir.f(),Dt.finish(52);case 55:return ar.onUpdateSessions(xe),Dt.abrupt("return",u.resolve({deletedMsgCount:lr,sessionUpdateCount:or}));case 57:case"end":return Dt.stop()}},er,this,[[14,49,52,55]])}));return function(er){return _e.apply(this,arguments)}}()},function(t,n,e){var r=e(71),s=e(9),i=e(10),o=e(6),a=e(3),d=e(24),c=e(16),u=e(2),m=e(35).fn,y=e(0),S=e(153);m.splitSysMsgs=function(O,k){for(var g,v=O.length-1;v>=0;v--)g=O[v],S.isCustom(g)&&(r(O).call(O,v,1),k.push(g))},m.onOfflineSysMsgs=function(O,k){var g,v=this,ue=s(g=O.content.sysMsgs).call(g,function(Ie){return Ie=i(S).call(S,Ie),k&&(Ie.filter=!0),Ie});ue=i(ue).call(ue),v.markSysMsgRead(ue);var L=[];v.splitSysMsgs(ue,L);var re,le=k?"offlineFilterSysMsgs":"offlineSysMsgs",oe=k?"offlineFilterCustomSysMsgs":"offlineCustomSysMsgs";if(ue.length){var he=v.putSysMsg(ue,"offlineSysMsgs").then(function(Ie){var ie;(ue=Ie).length&&(v.logger.info("sysmsg::onOfflineSysMsgs: ",le,ue.length,ue&&s(ue).call(ue,function(Ne){return Ne.idServer})),v.syncResult[le]=v.syncResult[le]||[],v.syncResult[le]=o(ie=v.syncResult[le]).call(ie,ue))}).catch(function(Ie){return v.logger.error("sysMsg::onOfflineSysMsgs: ",Ie),a.reject(Ie)});he.cmd="sysMsgs",v.syncPromiseArray.push(he)}L.length&&(v.logger.info("sysmsg::onOfflineSysMsgs: ",oe,s(L).call(L,function(Ie){return Ie.idServer})),v.syncResult[oe]=v.syncResult[oe]||[],v.syncResult[oe]=o(re=v.syncResult[oe]).call(re,L))},m.onSendSysMsg=function(O,k){var g=O.obj||{};g?(this.completeSysMsg(g),O.error?g.status="fail":g.status="success",g=i(S).call(S,g),k&&(O.obj.filter=!0),O.obj=g):this.logger.warn("onSendSysMsg::no obj")},m.completeSysMsg=function(O){return O.from=this.account,O},m.onSysMsg=function(O,k){var g=i(S).call(S,O.content.sysMsg);k&&(g.filter=!0),this.markSysMsgRead(g),S.isCustom(g)?(this.logger.info("sysmsg::onSysMsg: on customSysMsg"),this.options.oncustomsysmsg(g)):this.syncing?(this.logger.info("sysmsg::onSysMsg:is in syncing ..."),this.unhandledSysMsgs.push(g)):this.handleSysMsg(g)},m.handleSysMsg=function(O){var k=this,g=O.type,v=O.from,ue=O.serverex;k.sysMsgPromise=k.sysMsgPromise.then(function(){return k.putSysMsg(O,"onSysMsg")}).then(function(L){O=L[0]}).then(function(){if(O){var L,re=a.resolve();switch(g){case"addFriend":L={type:"addFriend",account:v},ue&&(L.serverex=ue),re=k.onFriendRequest(L);break;case"passFriendApply":L={type:"passFriendApply",account:v},re=k.onFriendRequest(L);break;case"deleteFriend":re=k.onDeleteFriend({account:v})}return L&&L.friend&&(O.friend=L.friend),re}}).then(function(){O&&(k.logger.info("sysmsg::handleSysMsg: ",g,y.pickAsString(O,["idServer","deletedIdClient","deletedIdServer"])),d(function(){k.options.onsysmsg(O)},0))})},m.putSysMsg=function(O,k){if(y.isArray(O)||(O=[O]),c(O[0]))return a.resolve(O);var g=this,v=g.db,ue=v.enable,L=a.resolve(),re=[];return(L=(L=L.then(function(){return ue?v.putSysMsg(O):O}).then(function(le){var oe=[];u(O).call(O,function(he){g.checkSysMsgUnique(he)&&oe.push(he)}),O=oe,re=ue?le:O})).then(function(){return g.getSysMsgUnread().then(function(le){return re.length||((re=O).backward=!0),g.updateSysMsgUnread(re,le,1).then(function(oe){k==="offlineSysMsgs"&&(g.syncResult.sysMsgUnread=oe),k==="onSysMsg"&&g.onUpdateSysMsgUnread(oe)})})})).then(function(){return O})},m.checkSysMsgUnique=y.genCheckUniqueFunc("idServer"),m.getSysMsgUnread=function(){var O=this,k=O.db;return new a(function(g){k.enable?k.getSysMsgUnread().then(function(v){g(v)},function(){g(O.sysMsgUnread)}):g(O.sysMsgUnread)})},m.updateSysMsgUnread=function(O,k,g){if(y.isArray(O)||(O=[O]),!O.length)return a.resolve(k);k=k||{};var v,ue=this.db;return u(O).call(O,function(L){(g>0&&!L.read||g<0&&L.read)&&(v=L.type,k[v]=(k[v]||0)+g)}),k=S.completeUnread(k),this.sysMsgUnread=k,ue.enable&&!O.backward?ue.updateSysMsgUnread(k):a.resolve(k)},m.reduceSysMsgUnread=function(O){var k=this;return k.getSysMsgUnread().then(function(g){return k.updateSysMsgUnread(O,g,-1)}).then(function(g){k.onUpdateSysMsgUnread(g)})},m.onUpdateSysMsgUnread=function(O){var k=this;d(function(){k.logger.info("sysmsg::onUpdateSysMsgUnread:",O),k.options.onupdatesysmsgunread(O)},0)},m.updateSysMsg=function(O){var k=this,g=k.db;(g.enable?g.updateSysMsg(O):a.resolve(O)).then(function(v){k.onUpdateSysMsg(v)})},m.onUpdateSysMsg=function(O){var k=this;d(function(){y.isArray(O)||(O=[O]),u(O).call(O,function(g){k.logger.info("sysmsg::onUpdateSysMsg:",g.idServer),k.options.onupdatesysmsg(g)})},0)},m.processUnsettledSysMsgs=function(){var O,k,g=this;u(O=g.unhandledSysMsgs).call(O,function(v){g.handleSysMsg(v)}),u(k=g.unhandledSysMsgsForDeletedMsgs).call(k,function(v){g.onMsgDeleted(v.packet,v.isSuperTeam)}),g.resetUnsettledSysMsgs()}},function(t,n,e){var r=e(759),s=e(51),i=e(2),o=e(7),a=e(15),d=e(10),c=e(3),u=e(9),m=e(90),y=e(16),S=e(37),O=e(4),k=e(6),g=e(52),v=e(53),ue=e(54),L=e(55),re=e(43);function le(Ce,Ue){var qe=O(Ce);if(g){var Oe=g(Ce);Ue&&(Oe=y(Oe).call(Oe,function($e){return v(Ce,$e).enumerable})),qe.push.apply(qe,Oe)}return qe}function oe(Ce){for(var Ue=1;Ue<arguments.length;Ue++){var qe,Oe,$e=arguments[Ue]!=null?arguments[Ue]:{};Ue%2?i(qe=le(Object($e),!0)).call(qe,function(_e){s(Ce,_e,$e[_e])}):ue?L(Ce,ue($e)):i(Oe=le(Object($e))).call(Oe,function(_e){re(Ce,_e,v($e,_e))})}return Ce}var he=e(35).fn,Ie=e(0),ie=e(154),Ne=e(41),Ve=e(153);he.processSession=function(Ce){if(!Ce.error)switch(Ce.cmd){case"getServerSessions":this.onGetServerSessions(Ce);break;case"getServerSession":this.onGetServerSession(Ce);break;case"updateServerSession":this.onUpdateServerSession(Ce)}},he.onGetServerSessions=function(Ce){var Ue=this,qe=Ce.content&&Ce.content.sessionReqTag,Oe=Ce.content&&Ce.content.sessionList,$e=[];i(Oe).call(Oe,function(_e){var er,Pt;if(_e.id=_e.id.split("|").join("-"),o(er=_e.id).call(er,"super_team")===0&&(_e.id="superTeam"+a(Pt=_e.id).call(Pt,10)),_e.updateTime=+_e.updateTime,_e.lastMsg){var ar=_e.lastMsgType==="1"?"sysMsg":"msg";$e.push(Ue.parser.unserialize(JSON.parse(_e.lastMsg),ar).then(function(pr){var lr;_e.lastMsg=ar==="msg"?d(lr=Ue.message).call(lr,pr):d(Ve).call(Ve,pr)}))}}),Ce.promise=c.all($e).then(function(){Ce.obj={sessionList:Oe,hasMore:qe.hasMore==="1"},qe.minTimestamp&&(Ce.obj.minTimestamp=+qe.minTimestamp)})},he.onGetServerSession=function(Ce){var Ue,qe=this,Oe=Ce.content&&Ce.content.session;if(Oe){var $e;if(Oe.id=Oe.id.split("|").join("-"),o(Ue=Oe.id).call(Ue,"super_team")===0&&(Oe.id="superTeam"+a($e=Oe.id).call($e,10)),Oe.updateTime=+Oe.updateTime,Oe.lastMsg){var _e=Ce.content.session&&Ce.content.session.lastMsgType==="1"?"sysMsg":"msg";Ce.promise=qe.parser.unserialize(JSON.parse(Oe.lastMsg),_e).then(function(er){var Pt;Oe.lastMsg=_e==="msg"?d(Pt=qe.message).call(Pt,er):d(Ve).call(Ve,er),Ce.obj=Oe})}else Ce.obj=Oe}},he.onUpdateServerSession=function(Ce){Ce.obj={}},he.onSyncUpdateServerSession=function(Ce){var Ue,qe=this,Oe=this,$e=Ce.content&&Ce.content.session;if($e){var _e;$e.id=$e.id.split("|").join("-"),o(Ue=$e.id).call(Ue,"super_team")===0&&($e.id="superTeam"+a(_e=$e.id).call(_e,10)),$e.updateTime=+$e.updateTime,$e.lastMsg?Oe.parser.unserialize(JSON.parse($e.lastMsg),"msg").then(function(er){var Pt;$e.lastMsg=d(Pt=Oe.message).call(Pt,er),qe.options.onSyncUpdateServerSession(Ie.simpleClone($e))}):this.options.onSyncUpdateServerSession(Ie.simpleClone($e))}},he.mergeSession=function(Ce){Ce=Ie.copyWithNull(Ce);var Ue=this.sessionSet,qe=Ce.id,Oe=Ue[qe]||{},$e=!1;return ie.isComplete(Ce)?delete Oe.isDeleted:Oe.isDeleted&&($e=!0),Ue[qe]=Ie.merge(Oe,Ce),Ce=$e?Ce:Ue[qe],Ie.undef(Ce.unread)&&(Ce.unread=0),Ce},he.mergeSessions=function(Ce){var Ue=this;return u(Ce=Ce||[]).call(Ce,function(qe){return Ue.mergeSession(qe)})},he.onDeleteSessions=function(Ce){var Ue;Ce.obj=u(Ue=Ce.obj.sessions).call(Ue,function(qe){return ie.parse(qe)})},he.onUpdateSession=function(Ce){if(Ce){if(Ce=this.mergeSession(Ce),Ce=m(ie).call(ie,Ce),ie.isComplete(Ce))return this.logger.info("session::onUpdateSession: ".concat(Ce.id),Ce.id,Ie.secureOutput("session",Ce)),this.options.onupdatesessions?this.options.onupdatesessions([Ce]):this.options.onupdatesession(Ce),Ce;this.logger.warn("session::onUpdateSession::session is not complete",Ie.secureOutput("session",Ce))}},he.onUpdateSessions=function(Ce){var Ue=this;if(Ce){Ce=Ue.mergeSessions(Ce),Ce=u(Ce).call(Ce,function($e){return m(ie).call(ie,$e)});var qe=y(Ce).call(Ce,function($e){return ie.isComplete($e)}),Oe=y(Ce).call(Ce,function($e){return!ie.isComplete($e)});if(Oe&&Oe.length>0&&Ue.logger.warn("session::onUpdateSessions::sessions is not complete",u(Oe).call(Oe,function($e){return $e.id}),Ie.secureOutput("session",Oe)),qe.length!==0)return Ue.logger.info("session::onUpdateSessions:",Ie.secureOutput("session",qe)),Ue.options.onupdatesessions?Ue.options.onupdatesessions(qe):i(qe).call(qe,function($e){Ue.options.onupdatesession($e)}),qe;Ue.logger.warn("session::onUpdateSessions::completeSessions is empty")}},he.setCurrSession=function(Ce){Ce=""+Ce,this.currSessionId=Ce,this.logger.info("session::setCurrSession:",Ce)},he.resetSessionUnread=function(Ce){var Ue=Ce.id;this.db.enable&&this.db.updateSession({id:Ue,unread:0}),!this.options.autoMarkRead&&this.sessionUnreadMsgs&&this.sessionUnreadMsgs[Ue]&&(this.markMsgRead(this.sessionUnreadMsgs[Ue],!0),this.sessionUnreadMsgs[Ue]=[]),this.getSessionInCache(Ue)?this.onUpdateSession({id:Ue,unread:0}):this.onUpdateSession(oe(oe({},Ce),{},{unread:0}))},he.resetSessionsUnread=function(Ce){var Ue=this,qe=this.db;qe.enable&&u(Ce).call(Ce,function($e){qe.updateSession({id:$e.id,unread:0})});var Oe=!this.options.autoMarkRead&&this.sessionUnreadMsgs;Ce=u(Ce).call(Ce,function($e){return Oe&&Ue.sessionUnreadMsgs[$e.id]&&(Ue.markMsgRead(Ue.sessionUnreadMsgs[$e.id],!0),Ue.sessionUnreadMsgs[$e.id]=[]),Ue.getSessionInCache($e.id)?{id:$e.id,unread:0}:oe(oe({},$e),{},{unread:0})}),this.onUpdateSessions(Ce)},he.insertLocalSession=function(Ce){var Ue=this,qe=Ue.db,Oe=Ce.scene+"-"+Ce.to,$e=Ue.getSessionInCache(Oe);return $e&&ie.isComplete($e)?c.reject(Ne.sessionExist({callFunc:"session::insertLocalSession",session:$e})):(qe.enable?qe.getMsgs({sessionId:Oe,limit:1}):c.resolve()).then(function(_e){if(Ie.isArray(_e)&&_e.length===1){var er=_e[0];($e=ie.genSessionByMsg(er)).updateTime=er.time}else $e={id:Oe,scene:Ce.scene,to:Ce.to,updateTime:+Ce.updateTime||+new Date,lastMsg:null};return Ue.onUpdateSession($e),qe.enable?qe.putSession($e):c.resolve($e)})},he.checkAndUpdateLocalSessionByMsg=function(Ce){var Ue,qe=this.db,Oe=this,$e=this.options.syncSessionUnread&&Ce!==this.currSessionId,_e=qe.getMsgs({sessionId:Ce,limit:1}),er=qe.getSession(Ce).then(function(Pt){if(Pt)return Ue=S({},Pt),Pt.ack=Pt.ack||0,$e?qe.getMsgs({sessionId:Ce,start:Pt.ack}):c.resolve();Oe.logger.error("can't find session that sessionId = ".concat(Ce))});return c.all([_e,er]).then(function(Pt){var ar,pr,lr=r(Pt,2),or=lr[0],xe=lr[1],nr={id:Ce};if(!Ue)return Oe.logger.error("checkAndUpdateLocalSessionByMsg:can not find session",Ce),c.resolve(200);if(ar=Ue&&!Ue.lastMsg?null:Ue.lastMsg.idClient,or&&or[0]?pr=(or=or[0]).idClient:(pr=null,or=null),ar!==pr&&(nr.lastMsg=or),xe!==void 0){var ir=0;i(xe=xe||[]).call(xe,function(dr){var Lt;try{Lt=Oe.options.shouldCountNotifyUnread(dr)}catch(cr){throw Oe.logger.error("userOption:shouldCountNotifyUnread function error",cr),cr}dr.isUnreadable&&dr.flow==="in"&&(dr.type!=="notification"||Lt)&&ir++}),ir!==Ue.unread&&(nr.unread=ir)}return O(nr).length>1?(Oe.logger.info("session::checkAndUpdateLocalSessionByMsg::needUpdate newSession:",Ie.secureOutput("session",nr)),qe.updateSession(nr).then(function(){return Oe.onUpdateSession(nr)})):c.resolve(200)})},he.syncSessionsWithMoreRoaming=function(Ce){var Ue=this,qe=Ce&&Ce.content&&Ce.content.sessions;if(qe&&qe.length){var Oe={0:"p2p",1:"team",5:"superTeam"};if(i(qe).call(qe,function(_e){var er,Pt=_e.to===Ue.options.account?_e.from:_e.to;_e.scene=Oe[_e.scene],_e.id=k(er="".concat(_e.scene,"-")).call(er,Pt),_e.time=+_e.time}),this.db.enable){var $e=this.db.putSessionsWithMoreRoaming(qe);$e.cmd="syncSessionsWithMoreRoaming",this.syncPromiseArray.push($e)}this.syncing&&this.syncResult?this.syncResult.sessionsWithMoreRoaming=qe:this.logger.warn("syncSessionsWithMoreRoaming::not in syncing or no syncResult")}},he.syncStickTopSessions=function(Ce){var Ue=this,qe=this.db,Oe=[],$e=[],_e=c.resolve(),er=Ce.content.sessions||[];this.syncing&&this.syncResult?(i(er).call(er,function(Pt){var ar=Pt.id.split("|");ar[0]==="super_team"&&(ar[0]="superTeam"),Pt.id=ar.join("-"),Pt.scene=ar[0],Pt.to=ar[1],Pt.isTop=!0,Oe.push(ar.join("-")),delete Pt.createTime,delete Pt.updateTime,qe.enable&&$e.push(qe.putSession(Pt))}),qe.enable&&(_e=qe.updateTimetag("stickTopSessions",Ce.content.timetag)),_e.then(function(){return qe.enable?qe.getStickTopSessions():[]}).then(function(Pt){if(Ce.content.modify){var ar=[];i(Pt).call(Pt,function(pr){o(Oe).call(Oe,pr.id)>-1||(ar.push(pr.id),pr.isTop=!1,pr.topCustom="",$e.push(qe.putSession(pr)))})}else Ue.syncResult.stickTopSessions=Pt;return c.all($e)}),this.syncResult.stickTopSessions=er,_e.cmd="syncStickTopSessions",this.syncPromiseArray.push(_e)):this.logger.warn("syncSessionsWithMoreRoaming::not in syncing or no syncResult")},he.getSessionInCache=function(Ce,Ue){var qe=this.sessionSet[Ce];return!qe||qe.isDeleted&&!Ue?void 0:qe},he.deleteSessionInCache=function(Ce,Ue){var qe=this;Ie.isArray(Ce)||(Ce=[Ce]),Ue?i(Ce).call(Ce,function(Oe){qe.sessionSet[Oe]&&(qe.sessionSet[Oe].isDeleted=!0)}):i(Ce).call(Ce,function(Oe){return delete qe.sessionSet[Oe]}),this.logger.info("sessions::deleteSessionInCache::delete session done",Ce,Ue)},he.updateSessionInCache=function(Ce){return this.logger.info("session::updateSessionInCache: ".concat(Ce.id),Ce.id,Ce),this.getSessionInCache(Ce.id)?Ce=this.mergeSession(Ce):(this.logger.info("session::updateSessionInCache: can not find session in cache ".concat(Ce.id)),null)},he.updateSessionInDbWithNotify=function(Ce,Ue){var qe=this;return new c(function(Oe,$e){var _e=qe.db;if(qe.getSessionInCache(Ce.id)){var er=c.resolve(),Pt=Ie.filterObj(Ce,"id lastMsg localCustom unread");_e.enable&&(er=_e.updateSession(Pt)),er.then(function(ar){return qe.onUpdateSession(ar,Ue)}).then(Oe,function(ar){$e({callFunc:"session::updateLocalSession",event:ar})})}else $e(Ne.sessionNotExist({sessionId:Ce.id,callFunc:"session::updateLocalSession"}))})}},function(t,n,e){var r=e(750);t.exports=function(s){if(r(s))return s},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,n,e){var r=e(155),s=e(72);t.exports=function(i,o){var a=i==null?null:r!==void 0&&s(i)||i["@@iterator"];if(a!=null){var d,c,u,m,y=[],S=!0,O=!1;try{if(u=(a=a.call(i)).next,o===0){if(Object(a)!==a)return;S=!1}else for(;!(S=(d=u.call(a)).done)&&(y.push(d.value),y.length!==o);S=!0);}catch(k){O=!0,c=k}finally{try{if(!S&&a.return!=null&&(m=a.return(),Object(m)!==m))return}finally{if(O)throw c}}return y}},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,n){t.exports=function(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,n,e){var r=e(2),s=e(4),i=e(6),o=e(37),a=e(35).fn,d=e(0);a.syncSessionAck=function(c){var u,m=this;if(this.logger.info("syncSessionAck::",c.content),m.syncing&&m.syncResult){m.saveAck.p2pTeam=c.content.timetag;var y={};r(u=[[c.content.p2p,"p2p"],[c.content.team.m_map,"team"]]).call(u,function(S){var O,k=S[0],g=S[1];r(O=s(k)).call(O,function(v){var ue,L;y[i(ue="".concat(g,"-")).call(ue,v)]=k[v];var re={id:i(L="".concat(g,"-")).call(L,v),ack:k[v]};m.cacheSyncedSession(re)})}),m.syncResult.ackMap?m.syncResult.ackMap=o(m.syncResult.ackMap,y):m.syncResult.ackMap=y}else m.logger.warn("syncSessionAck: not in syncing or no syncResult",m.syncing,!!m.syncResult)},a.syncSuperTeamSessionAck=function(c){var u,m=this;if(m.syncResult){m.saveAck.superTeam=c.content.timetag;var y={},S=c.content.superTeam.m_map;r(u=s(S)).call(u,function(O){y["superTeam-".concat(O)]=S[O];var k={id:"superTeam-".concat(O),ack:S[O]};m.cacheSyncedSession(k)}),m.syncResult.ackMap?m.syncResult.ackMap=o(m.syncResult.ackMap,y):m.syncResult.ackMap=y}},a.onMarkSessionAck=function(c){c.error||this.storeSessionAck(c.obj)},a.syncMarkSessionAck=function(c){this.storeSessionAck(c.content,!0)},a.storeSessionAck=function(c,u){var m;if(this.options.syncSessionUnread&&c){var y;switch(c.scene){case 0:y="p2p";break;case 1:y="team";break;case void 0:default:y="superTeam"}var S=i(m="".concat(y,"-")).call(m,c.to),O=c.timetag;if(O<=((this.getSessionInCache(S)||{}).ack||0))this.logger.warn("session::storeSessionAck: ack <= ackInMemory",O);else{var k={id:S,ack:O};this.mergeSession(k),this.logger.info("session::storeSessionAck:",d.secureOutput("session",k)),this.markUnreadBySessionAck({sessionId:S,ack:k.ack},u)}}},a.markUnreadBySessionAck=function(c,u){var m=c.sessionId,y=c.ack,S=this,O=S.db;if(O.enable)S.pushMsgTask(function(){return O.getMsgCountAfterAck({shouldCountNotifyUnread:S.options.shouldCountNotifyUnread,sessionId:m,ack:y}).then(function(le){var oe={id:m,unread:le,ack:y};return S.logger.info("session::markUnreadBySessionAck: db.getMsgCountAfterAck done",oe),S.syncing?S.cacheSyncedSession(oe):u&&S.onUpdateSession(oe),O.updateSession(oe)}).catch(function(le){S.logger.error("markUnreadBySessionAck::error",le)})});else{var k=S.getSessionInCache(m);if(k){var g=k.unreadMsgs;if(g&&g.length){for(var v=0,ue=[],L=g.length-1;L>=0;L--){var re=g[L];if(!(re.time>y))break;v++,ue.push(re)}k.unreadMsgs=ue,k.unread=v,S.logger.info("session::markUnreadBySessionAck: unread ".concat(v)),S.syncing?S.cacheSyncedSession(k):u&&S.onUpdateSession(k)}}}}},function(t,n,e){var r=e(35).fn;r.processChatroom=function(s){switch(s.cmd){case"getChatroomAddress":this.onChatroomAddress(s)}},r.onChatroomAddress=function(s){s.error||(s.obj.address=s.content.address)}},function(t,n,e){var r=e(35).fn;r.processQchat=function(s){switch(s.cmd){case"getQChatAddress":this.onQChatAddress(s)}},r.onQChatAddress=function(s){s.error||(s.obj.address=s.content.address)}},function(t,n,e){e(35).fn.processFilter=function(r){switch(r.cmd){case"sendFilterMsg":this.onSendMsg(r,!0);break;case"filterMsg":this.onMsg(r,!0);break;case"filterSysMsg":this.onSysMsg(r,!0);break;case"sendFilterCustomSysMsg":this.onSendSysMsg(r,!0)}}},function(t,n,e){var r=e(9),s=e(45),i=e(35).fn,o=e(0),a=s.clientTypeMap;function d(c){c=c||{};var u=o.copy(c);return u.clientType&&(u.clientType=a[u.clientType]||""),u.serverCustom&&(u.custom=JSON.parse(u.serverCustom),typeof u.custom[0]=="string"&&(u.custom=u.custom[0]),delete u.serverCustom),u}i.processEventService=function(c){var u=c.content,m=c.error,y=this.options||{};switch(m&&(m.callFunc="events::processsEventService",this.onCustomError("事件服务解包失败","EVENT_SERVICE_ERROR",m)),c.cmd){case"pushEvent":if(o.isFunction(y.onpushevents)){var S={msgEvents:[d(u.msgEvent)]};y.onpushevents(S)}break;case"pushEvents":if(o.isFunction(y.onpushevents)){var O=u.msgEvents;O={msgEvents:r(O).call(O,function(k){return d(k)})},y.onpushevents(O)}}}},function(t,n,e){var r=e(35).fn,s=e(0);r.processProxyService=function(i){var o=i.error;switch(o&&(o.callFunc="events::processProxyService",this.onCustomError("proxyService","EVENT_PROXY_SERVICE_ERROR",o)),i.cmd){case"onProxyMsg":if(s.isFunction(this.options.onProxyMsg)){var a=i.content.proxyMsg||{};a.time&&(a.time=+a.time),this.options.onProxyMsg(a)}break;case"httpProxy":i.obj=i.content&&i.content.proxyTag}}},function(t,n,e){var r=e(10),s=e(9),i=e(0),o=function(v){this.account=v.account},a=o.prototype,d=a.Message=e(76),c=a.TextMessage=e(835),u=a.FileMessage=e(205),m=a.GeoMessage=e(839),y=a.NotificationMessage=e(840),S=a.CustomMessage=e(841),O=a.TipMessage=e(842),k=a.RobotMessage=e(843),g=a.G2Message=e(844);a.validScenes=d.validScenes,a.validTypes=d.validTypes,a.sceneMap=d.sceneMap,a.sceneReverseMap=d.sceneReverseMap,a.reverse=function(v){var ue;switch(d.getType(v)){case"text":ue=r(c).call(c,v);break;case"image":case"audio":case"video":case"file":ue=r(u).call(u,v);break;case"geo":ue=r(m).call(m,v);break;case"notification":ue=r(y).call(y,v);break;case"custom":ue=r(S).call(S,v);break;case"tip":ue=r(O).call(O,v);break;case"g2":ue=r(g).call(g,v);break;case"robot":ue=r(k).call(k,v);break;default:ue=r(d).call(d,v)}return d.setExtra(ue,this.account),ue},a.reverseMsgs=function(v,ue){var L,re,le=this;return s(v).call(v,function(oe){return oe=r(le).call(le,oe),ue&&((L=ue.modifyObj)&&(oe=i.merge(oe,L)),re=ue.mapper,i.isFunction(re)&&(oe=re(oe))),oe})},t.exports=o},function(t,n,e){var r=e(18),s=e(10),i=e(76),o=e(0);function a(d){o.verifyOptions(d,"text","msg::TextMessage"),d.type="text",i.call(this,d)}a.prototype=r(i.prototype),a.reverse=function(d){return s(i).call(i,d)},t.exports=a},function(t,n,e){var r=e(18),s=e(205);function i(){}i.prototype=r(s.prototype),i.verifyFile=function(o,a){return!0},t.exports=i},function(t,n,e){var r=e(18),s=e(205);function i(){}i.prototype=r(s.prototype),i.verifyFile=function(){},t.exports=i},function(t,n,e){var r=e(18),s=e(205);function i(){}i.prototype=r(s.prototype),i.verifyFile=function(){},t.exports=i},function(t,n,e){var r=e(8),s=e(18),i=e(10),o=e(76),a=e(0);function d(c){c.type="geo",a.verifyOptions(c,"geo","msg::GeoMessage"),a.verifyOptions(c.geo,"lng lat title",!0,"geo.","msg::GeoMessage"),a.verifyParamType("geo.lng",c.geo.lng,"number","msg::GeoMessage"),a.verifyParamType("geo.lat",c.geo.lat,"number","msg::GeoMessage"),a.verifyParamType("geo.title",c.geo.title,"string","msg::GeoMessage"),o.call(this,c),this.attach=r(c.geo)}d.prototype=s(o.prototype),d.reverse=function(c){var u=i(o).call(o,c);return c.attach=c.attach?""+c.attach:"",u.geo=c.attach?JSON.parse(c.attach):{},u},t.exports=d},function(t,n,e){var r=e(18),s=e(10),i=e(9),o=e(121),a=e(0).notundef,d=e(76),c=e(149).IM,u=e(194),m=e(204),y={0:"addTeamMembers",1:"removeTeamMembers",2:"leaveTeam",3:"updateTeam",4:"dismissTeam",5:"passTeamApply",6:"transferTeam",7:"addTeamManagers",8:"removeTeamManagers",9:"acceptTeamInvite",10:"updateTeamMute",101:"netcallMiss",102:"netcallBill",103:"netcallReject",401:"addSuperTeamMembers",402:"removeSuperTeamMembers",403:"leaveSuperTeam",404:"updateSuperTeam",405:"dismissSuperTeam",406:"transferSuperTeam",407:"addSuperTeamManagers",408:"removeSuperTeamManagers",409:"updateSuperTeamMembersMute",410:"passSuperTeamApply",411:"acceptSuperTeamInvite"};function S(){}S.prototype=r(d.prototype),S.reverse=function(O){var k=s(d).call(d,O);if(O.attach=O.attach?""+O.attach:"",O.attach){var g=JSON.parse(O.attach);if(k.attach={type:y[g.id]||g.id},a(g.data)){var v,ue,L=g.data;a(L.tinfo)&&(k.attach.team=s(u).call(u,c.syncUnserialize(L.tinfo,"team"),!0)),a(L.ids)&&(k.attach.accounts=L.ids),a(L.id)&&(k.attach.account=L.id),a(L.uinfos)&&(k.attach.users=i(v=L.uinfos).call(v,function(re){return s(m).call(m,c.syncUnserialize(re,"user"))})),a(L.mute)&&(k.attach.mute=+L.mute==1),a(L.attach)&&(k.attach.custom=L.attach),a(L.channel)&&(k.attach.channelId=L.channel),a(L.calltype)&&(k.attach.netcallType=L.calltype),a(L.duration)&&(k.attach.duration=L.duration),a(L.time)&&(k.attach.time=L.time),a(L.from)&&(k.attach.from=L.from),a(L.ext)&&(k.attach.ext=L.ext),k.attach.accounts&&k.attach.accounts.length<=2&&k.from===k.to&&o(ue=k.attach.accounts).call(ue,function(re){if(re!==k.to)return k.to=re,!0})}}else k.attach={};return k},t.exports=S},function(t,n,e){var r=e(18),s=e(10),i=e(76),o=e(0);function a(d){o.verifyOptions(d,"content","msg::CustomMessage"),d.type="custom",i.call(this,d),this.attach=d.content}a.prototype=r(i.prototype),a.reverse=function(d){var c=s(i).call(i,d);return c.content=d.attach,c},t.exports=a},function(t,n,e){var r=e(18),s=e(10),i=e(76),o=e(0);function a(d){o.verifyOptions(d,"tip","msg::TipMessage"),d.type="tip",i.call(this,d),this.body=d.tip}a.prototype=r(i.prototype),a.reverse=function(d){var c=s(i).call(i,d);return c.text="",c.tip=d.body,d.attach&&(c.attach=d.attach),c},t.exports=a},function(t,n,e){var r=e(8),s=e(18),i=e(10),o=e(9),a=e(76),d=e(0),c={welcome:"00",text:"01",link:"03"},u={"01":"text","02":"image","03":"answer",11:"template"};function m(y){d.verifyOptions(y,"content","msg::RobotMessage"),d.undef(y.robotAccid)&&(y.robotAccid=y.to);var S=y.content;switch(S.type){case"welcome":d.undef(y.body)&&(this.body="欢迎消息");break;case"text":d.verifyOptions(S,"content","msg::RobotMessage"),d.undef(y.body)&&(this.body=S.content);break;case"link":d.verifyOptions(S,"target","msg::RobotMessage")}S.type&&(S.type=c[S.type]),S={param:S,robotAccid:y.robotAccid},this.attach=r(S),y.type="robot",a.call(this,y)}m.prototype=s(a.prototype),m.reverse=function(y){var S=i(a).call(a,y);if(S.type==="robot"){var O=JSON.parse(y.attach);if(O.param&&(O.param.type=u[O.param.type]||"unknown"),O.robotMsg){var k=(O=d.merge(O,O.robotMsg)).message;O.flag==="bot"?O.message=o(k).call(k,function(g){return g.type=u[g.type]||"unknown",g}):O.flag,delete O.robotMsg}S.content=O}return S},t.exports=m},function(t,n,e){var r=e(8),s=e(18),i=e(10),o=e(76),a=e(0);function d(c){a.verifyOptions(c,"attach","msg::G2Message"),c.type="g2",o.call(this,c),this.attach=r(c.attach)}d.prototype=s(o.prototype),d.reverse=function(c){var u=i(o).call(o,c);return c.attach&&(u.attach=JSON.parse(c.attach)),u},t.exports=d},function(t,n,e){var r=e(51),s=e(57),i=e(22),o=e(58),a=e(9),d=e(16),c=e(7),u=e(3),m=e(2),y=e(37),S=e(4),O=e(52),k=e(53),g=e(54),v=e(55),ue=e(43);function L(ie,Ne){var Ve=S(ie);if(O){var Ce=O(ie);Ne&&(Ce=d(Ce).call(Ce,function(Ue){return k(ie,Ue).enumerable})),Ve.push.apply(Ve,Ce)}return Ve}function re(ie){for(var Ne=1;Ne<arguments.length;Ne++){var Ve,Ce,Ue=arguments[Ne]!=null?arguments[Ne]:{};Ne%2?m(Ve=L(Object(Ue),!0)).call(Ve,function(qe){r(ie,qe,Ue[qe])}):g?v(ie,g(Ue)):m(Ce=L(Object(Ue))).call(Ce,function(qe){ue(ie,qe,k(Ue,qe))})}return ie}var le=e(40).fn,oe=e(0),he=oe.isArray,Ie=e(152);le.mergeObjArray=function(ie,Ne,Ve){return ie||(ie=[]),Ne?(he(Ne)||(Ne=[Ne]),Ne.length?(Ve=Ve||{},oe.mergeObjArray(ie,Ne,Ve)):ie):ie},le.cutObjArray=function(ie,Ne,Ve){return ie&&Ne?(he(Ne)||(Ne=[Ne]),Ne.length?(Ve=Ve||{},oe.cutObjArray(ie,Ne,Ve)):ie):ie},le.mergeLoginPorts=function(ie,Ne){return this.mergeObjArray(ie,Ne,{keyPath:"deviceId"})},le.cutLoginPorts=function(ie,Ne){return this.cutObjArray(ie,Ne,{keyPath:"deviceId",sortPath:"type"})},le.mergeRelations=function(ie,Ne){return this.mergeObjArray(ie,Ne,{keyPath:"account"})},le.cutRelations=function(ie,Ne){return this.cutObjArray(ie,Ne,{keyPath:"account"})},le.findRelation=function(ie,Ne){return oe.findObjInArray(ie,{keyPath:"account",value:Ne})},le.mergeFriends=function(ie,Ne){return this.mergeObjArray(ie,Ne,{keyPath:"account"})},le.cutFriends=function(ie,Ne){return this.cutObjArray(ie,Ne,{keyPath:"account"})},le.cutFriendsByAccounts=function(ie,Ne){he(Ne)||(Ne=[Ne]);var Ve=a(Ne).call(Ne,function(Ce){return{account:Ce}});return this.cutFriends(ie,Ve)},le.findFriend=function(ie,Ne){return oe.findObjInArray(ie,{keyPath:"account",value:Ne})},le.mergeUsers=function(ie,Ne){return this.mergeObjArray(ie,Ne,{keyPath:"account"})},le.findUser=function(ie,Ne){return oe.findObjInArray(ie,{keyPath:"account",value:Ne})},le.mergeTeams=function(ie,Ne){return this.mergeObjArray(ie,Ne,{keyPath:"teamId"})},le.cutTeams=function(ie,Ne){return this.cutObjArray(ie,Ne,{keyPath:"teamId"})},le.findTeam=function(ie,Ne){return oe.findObjInArray(ie,{keyPath:"teamId",value:Ne})},le.assembleTeamOwner=Ie.assembleOwner,le.assembleTeamMembers=Ie.assembleMembers,le.genTeamMemberId=Ie.genId,le.mergeTeamMembers=function(ie,Ne){return this.mergeObjArray(ie,Ne)},le.cutTeamMembers=function(ie,Ne){return this.cutObjArray(ie,Ne)},le.cutTeamMembersByAccounts=function(ie,Ne,Ve){he(Ve)||(Ve=[Ve]);var Ce=Ie.assembleMembers({teamId:Ne},Ve);return this.cutTeamMembers(ie,Ce)},le.findTeamMember=function(ie,Ne){return oe.findObjInArray(ie,{keyPath:"id",value:Ne})},le.mergeSessions=function(ie,Ne){return this.mergeObjArray(ie,Ne,{sortPath:"updateTime",desc:!0})},le.cutSessions=function(ie,Ne){return this.cutObjArray(ie,Ne)},le.cutSessionsByIds=function(ie,Ne){he(Ne)||(Ne=[Ne]);var Ve=a(Ne).call(Ne,function(Ce){return{id:Ce}});return this.cutSessions(ie,Ve)},le.findSession=function(ie,Ne){return oe.findObjInArray(ie,{keyPath:"id",value:Ne})},le.mergeMsgs=function(ie,Ne){return this.mergeObjArray(ie,Ne,{keyPath:"idClient",sortPath:"time"})},le.cutMsgs=function(ie,Ne){return this.cutObjArray(ie,Ne,{keyPath:"idClient"})},le.cutMsgsByIdClients=function(ie,Ne){he(Ne)||(Ne=[Ne]);var Ve=a(Ne).call(Ne,function(Ce){return{idClient:Ce}});return this.cutMsgs(ie,Ve)},le.findMsg=function(ie,Ne){return oe.findObjInArray(ie,{keyPath:"idClient",value:Ne})},le.mergeSysMsgs=function(ie,Ne){return this.mergeObjArray(ie,Ne,{keyPath:"idServer",desc:!0})},le.cutSysMsgs=function(ie,Ne){return this.cutObjArray(ie,Ne,{keyPath:"idServer"})},le.cutSysMsgsByIdServers=function(ie,Ne){he(Ne)||(Ne=[Ne]);var Ve=a(Ne).call(Ne,function(Ce){return{idServer:Ce}});return this.cutSysMsgs(ie,Ve)},le.findSysMsg=function(ie,Ne){return oe.findObjInArray(ie,{keyPath:"idServer",value:Ne})},le.searchLocal=function(ie){if(oe.verifyOptions(ie,"keyword","searchLocal"),this.db.enable){var Ne,Ve=this,Ce=this.db,Ue=ie.keyword+"",qe=["account","nick","alias"],Oe=["id","scene","lastMsg.type","lastMsg.text","localCustom","target.account","target.nick","target.alias","target.name"],$e="",_e=ie.keyPath;switch(_e?($e=(_e=(_e+"").split(".")).shift(),_e=_e.join(".")):$e="all",$e){case"user":_e&&(qe=d(qe).call(qe,function(ir){return ir===_e||c(ir).call(ir,_e+".")===0})),ar(qe).then(function(ir){ie.done(null,{sessions:[],users:ir})});break;case"session":_e&&(Oe=d(Oe).call(Oe,function(ir){return ir===_e||c(ir).call(ir,_e+".")===0})),er(Oe,!_e||c(_e).call(_e,"target")>-1).then(function(ir){ie.done(null,{sessions:ir,users:[]})});break;case"all":lr().then(function(){u.all([er(Oe,!0),ar(qe)]).then(function(ir){ie.done(null,{sessions:ir[0],users:ir[1]})})});break;default:ie.done(null,{sessions:[],users:[],msg:'keyPath must start with "user" or "session"'})}}else ie.done(null,{sessions:[],users:[],msg:"no db"});function er(ir,dr){return Pt.apply(this,arguments)}function Pt(){return(Pt=o(s.mark(function ir(dr,Lt){var cr;return s.wrap(function(mr){for(;;)switch(mr.prev=mr.next){case 0:return cr=Lt?[Ce.getSessions(),lr(),Ce.getTeams(),Ce.getSuperTeams()]:[Ce.getSessions()],mr.abrupt("return",u.all(cr).then(function(tr){var At,kt=tr[0]||[],Dt={p2p:tr[1]||[],team:tr[2]||[],superTeam:tr[3]||[]},gr={};return Lt&&(m(At=S(Dt)).call(At,function(yr){var vr;m(vr=Dt[yr]).call(vr,function(Ir){var Mr=Ir.teamId||Ir.account;gr[yr+"-"+Mr]=Ir})}),m(kt).call(kt,function(yr){yr.target=gr[yr.id]})),xe(dr,kt)}));case 2:case"end":return mr.stop()}},ir)}))).apply(this,arguments)}function ar(ir){return pr.apply(this,arguments)}function pr(){return(pr=o(s.mark(function ir(dr){var Lt;return s.wrap(function(cr){for(;;)switch(cr.prev=cr.next){case 0:return cr.next=2,lr();case 2:return Lt=cr.sent,cr.abrupt("return",xe(dr,Lt));case 4:case"end":return cr.stop()}},ir)}))).apply(this,arguments)}function lr(){return or.apply(this,arguments)}function or(){return(or=o(s.mark(function ir(){var dr,Lt;return s.wrap(function(cr){for(;;)switch(cr.prev=cr.next){case 0:if(!Ne){cr.next=2;break}return cr.abrupt("return",Ne);case 2:return cr.next=4,Ve.db.getFriends();case 4:if(cr.t0=cr.sent,cr.t0){cr.next=7;break}cr.t0=[];case 7:return dr=cr.t0,Lt=Ve.protocol.userSet||{},Ne=a(dr).call(dr,function(mr){return re(re({},mr),Lt[mr.account])}),cr.abrupt("return",Ne);case 11:case"end":return cr.stop()}},ir)}))).apply(this,arguments)}function xe(ir,dr){var Lt=[];return m(dr).call(dr,function(cr){for(var mr=0;mr<ir.length;mr++){var tr=nr(cr,ir[mr].split("."));if(tr&&c(tr).call(tr,Ue)>-1){Lt.push(y({},cr));break}}}),Lt}function nr(ir,dr){if(i(ir)==="object"&&ir)return dr.length===1?ir[dr[0]]:nr(ir[dr.shift()],dr)}}},function(t,n,e){var r=e(15),s=e(40).fn,i=e(0),o=e(25).reportAPI;s.kick=function(a){var d;(a=a||{}).done=o({instance:this,className:"NIMFn",funcName:"kick",done:a.done}),i.verifyOptions(a,"deviceIds","link::kick"),this.processCallback(a),this.sendCmd("kick",{deviceIds:r(d=a.deviceIds).call(d,0)},a.callback)},s.disconnect=function(a){(a=a||{}).done=o({instance:this,className:"NIMFn",funcName:"disconnect",done:a.done}),a=a||{},this.protocol.disconnect(a.done)}},function(t,n,e){var r=e(40).fn,s=e(0),i=e(25).reportAPI;r.markInBlacklist=function(o){(o=o||{}).done=i({instance:this,className:"NIMFn",funcName:"markInBlacklist",done:o.done}),s.verifyOptions(o,"account isAdd","relation::markInBlacklist"),s.verifyParamType("isAdd",o.isAdd,"boolean","relation::markInBlacklist"),this.processCallback(o),this.sendCmd("markInBlacklist",{account:o.account,isAdd:o.isAdd},o.callback)},r.addToBlacklist=function(o){return(o=o||{}).done=i({instance:this,className:"NIMFn",funcName:"addToBlacklist",done:o.done}),o.isAdd=!0,this.markInBlacklist(o)},r.removeFromBlacklist=function(o){return(o=o||{}).done=i({instance:this,className:"NIMFn",funcName:"removeFromBlacklist",done:o.done}),o.isAdd=!1,this.markInBlacklist(o)},r.markInMutelist=function(o){(o=o||{}).done=i({instance:this,className:"NIMFn",funcName:"markInMutelist",done:o.done}),s.verifyOptions(o,"account","relation::markInMutelist"),s.verifyParamType("isAdd",o.isAdd,"boolean","relation::markInMutelist"),this.processCallback(o),this.sendCmd("markInMutelist",{account:o.account,isAdd:o.isAdd},o.callback)},r.addToMutelist=function(o){return(o=o||{}).done=i({instance:this,className:"NIMFn",funcName:"addToMutelist",done:o.done}),o.isAdd=!0,this.markInMutelist(o)},r.removeFromMutelist=function(o){return(o=o||{}).done=i({instance:this,className:"NIMFn",funcName:"removeFromMutelist",done:o.done}),o.isAdd=!1,this.markInMutelist(o)},r.getRelations=function(o){(o=o||{}).done=i({instance:this,className:"NIMFn",funcName:"getRelations",done:o.done});var a=this,d=a.db,c=0;function u(){a.sendCmd("getRelations",{timetag:c,NOTSTORE:"timetag"},o.callback)}o=s.verifyOptions(o),a.processCallback(o),d.enable?d.getRelationsTimetag().then(function(m){c=m,u()},u):u()}},function(t,n,e){var r=e(57),s=e(58),i=e(6),o=e(2),a=e(7),d=e(40).fn,c=e(0),u=c.objs2accounts,m=e(204),y=e(25).reportAPI;d.updateMyInfo=function(S){(S=S||{}).done=y({instance:this,className:"NIMFn",funcName:"updateMyInfo",done:S.done}),c.verifyOptions(S),this.processCallback(S),S.user=new m(S),delete S.user.account,this.sendCmd("updateMyInfo",{user:S.user,antispamTag:{antiSpamBusinessId:S.antiSpamBusinessId},single:!0},S.callback)},d.getMyInfo=function(S){return(S=S||{}).done=y({instance:this,className:"NIMFn",funcName:"getMyInfo",done:S.done}),(S=S||{}).account=this.account,this.getUser(S)},d.getUser=function(S){(S=S||{}).done=y({instance:this,className:"NIMFn",funcName:"getUser",done:S.done});var O,k=this,g=k.db;function v(){k.sendCmd("getUsers",{accounts:[O],single:!0},S.callback)}c.verifyOptions(S,"account","user::getUser"),k.processCallback(S),S.cbaop=function(ue,L){if(!ue)return L=L[0]||null,k.logger.info("api::getUser: cbaop ".concat(O)),L},O=S.account,S.sync?v():g.enable?g.getUser(O).then(function(ue){ue?S.done(null,ue):v()},v):v()},d.getUsers=function(S){(S=S||{}).done=y({instance:this,className:"NIMFn",funcName:"getUsers",done:S.done});var O,k=this,g=k.db,v=[];function ue(){k.sendCmd("getUsers",{accounts:O,single:!0},S.callback)}c.verifyOptions(S,"accounts","user::getUsers"),c.verifyParamType("accounts",S.accounts,"array","user::getUsers"),k.processCallback(S),S.cbaop=function(L,re){if(!L)return re=i(re).call(re,v),k.logger.info("api::getUsers: cbaop ".concat(O)),re},O=c.deduplicate(S.accounts),c.verifyArrayMax("accounts",S.accounts,150,"user::getUsers"),S.sync?ue():g.enable?g.getUsers({accountIds:O}).then(function(L){if(L&&L.length===O.length)S.done(null,L);else{v=L;var re=u(L),le=[];o(O).call(O,function(oe){a(re).call(re,oe)===-1&&le.push(oe)}),O=le,ue()}},ue):ue()},d.getUsersFromDB=function(){var S=s(r.mark(function O(k){var g,v,ue;return r.wrap(function(L){for(;;)switch(L.prev=L.next){case 0:return v=(g=this).db,(k=k||{}).done=y({instance:this,className:"NIMFn",funcName:"getUsersFromDB",done:k.done}),c.validate({accountIds:{type:"array",required:!1}},k,"user::getUsersFromDB"),g.processCallback(k),L.next=8,v.getUsers(k);case 8:return ue=L.sent,k.callback(null,ue),L.abrupt("return",ue);case 11:case"end":return L.stop()}},O,this)}));return function(O){return S.apply(this,arguments)}}()},function(t,n,e){var r=e(57),s=e(58),i=e(122),o=e(40).fn,a=e(0),d=a.notundef,c=e(755),u=e(25).reportAPI;o.friendRequest=function(m){(m=m||{}).done=u({instance:this,className:"NIMFn",funcName:"friendRequest",done:m.done}),a.verifyOptions(m,"type account","friend::friendRequest"),a.verifyParamValid("type",m.type,c.validTypes(),"friend::friendRequest"),this.processPs(m),this.processCallback(m);var y={account:m.account,type:c.getByteFromType(m.type),ps:m.ps};d(m.idServer)&&(y.idServer=m.idServer),this.sendCmd("friendRequest",y,m.callback)},o.addFriend=function(m){(m=m||{}).done=u({instance:this,className:"NIMFn",funcName:"addFriend",done:m.done}),m.type="addFriend",this.friendRequest(m)},o.applyFriend=function(m){(m=m||{}).done=u({instance:this,className:"NIMFn",funcName:"applyFriend",done:m.done}),m.type="applyFriend",this.friendRequest(m)},o.passFriendApply=function(m){(m=m||{}).done=u({instance:this,className:"NIMFn",funcName:"passFriendApply",done:m.done}),a.verifyOptions(m,"idServer","friend::passFriendApply"),m.type="passFriendApply",this.friendRequest(m)},o.rejectFriendApply=function(m){(m=m||{}).done=u({instance:this,className:"NIMFn",funcName:"rejectFriendApply",done:m.done}),a.verifyOptions(m,"idServer","friend::rejectFriendApply"),m.type="rejectFriendApply",this.friendRequest(m)},o.deleteFriend=function(m){(m=m||{}).done=u({instance:this,className:"NIMFn",funcName:"deleteFriend",done:m.done}),a.verifyOptions(m,"account","friend::deleteFriend");var y=m.delAlias===!0;this.processCallback(m),this.sendCmd("deleteFriend",{account:m.account,delFriendParams:{delAlias:y?1:0}},m.callback)},o.updateFriend=function(m){(m=m||{}).done=u({instance:this,className:"NIMFn",funcName:"updateFriend",done:m.done}),this.processCallback(m);var y=new c(m);this.sendCmd("updateFriend",{friend:y,single:!0},m.callback)},o.getFriends=function(m){(m=m||{}).done=u({instance:this,className:"NIMFn",funcName:"getFriends",done:m.done});var y=this.db;a.validate({timetag:{type:"number",required:!1}},m,"friend::getFriends"),this.processCallback(m),y.enable?y.getFriends({updateTime:m.updateTime||0}).then(function(S){(S=i(S).call(S,function(O,k){return O.updateTime-k.updateTime})).invalid=[],m.done(null,S)}):this.sendCmd("getFriends",{timetag:m.updateTime||0,NOTSTORE:"timetag"},m.callback)},o.getFriendsFromDB=function(){var m=s(r.mark(function y(S){var O,k,g;return r.wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return k=(O=this).db,(S=S||{}).done=u({instance:this,className:"NIMFn",funcName:"getFriendsFromDB",done:S.done}),a.validate({accountIds:{type:"array",required:!1}},S,"friend::getFriendsFromDB"),O.processCallback(S),v.next=8,k.getFriends(S);case 8:return g=v.sent,S.callback(null,g),v.abrupt("return",g);case 11:case"end":return v.stop()}},y,this)}));return function(y){return m.apply(this,arguments)}}(),o.isMyFriend=function(m){(m=m||{}).done=u({instance:this,className:"NIMFn",funcName:"isMyFriend",done:m.done});var y=this.db;a.validate({account:{type:"string",allowEmpty:!1,require:!0}},m),this.processCallback(m),y.enable||m.done(null,!1),y.getFriend(m.account).then(function(S){S&&S.valid===!0?m.done(null,!0):m.done(null,!1)})},o.isUserInBlackList=function(m){(m=m||{}).done=u({instance:this,className:"NIMFn",funcName:"isUserInBlackList",done:m.done});var y=this.db;a.validate({account:{type:"string",allowEmpty:!1,require:!0}},m),this.processCallback(m),y.enable||m.done(null,!1),y.getUserFromBlackList(m.account).then(function(S){S&&S.account?m.done(null,!0):m.done(null,!1)})}},function(t,n,e){var r=e(40).fn,s=e(25).reportAPI;r.getRobots=function(i){(i=i||{}).done=s({instance:this,className:"NIMFn",funcName:"getRobots",done:i.done}),this.logger.warn("this api will be abandon"),(i=i||{}).type="getRobots",this.processCallback(i),this.sendCmd("sync",{sync:{robots:0}},i.callback)}},function(t,n,e){var r=e(57),s=e(58),i=e(15),o=e(9),a=e(16),d=e(3),c=e(8),u=e(40).fn,m=e(0),y=m.undef,S=e(194),O=e(152),k=e(25).reportAPI;u.createTeam=function(g){var v;(g=g||{}).done=k({instance:this,className:"NIMFn",funcName:"createTeam",done:g.done}),m.verifyOptions(g,"type name","team::createTeam"),y(g.accounts)?g.accounts=[]:m.verifyParamType("accounts",g.accounts,"array","team::createTeam"),g.action="create",this.processPs(g),this.processCallback(g),g.team=new S(g);var ue={team:g.team,accounts:i(v=g.accounts).call(v,0),ps:g.ps,antispamTag:{antiSpamBusinessId:g.antiSpamBusinessId}};this.sendCmd("createTeam",ue,g.callback)},u.updateTeam=function(g){(g=g||{}).done=k({instance:this,className:"NIMFn",funcName:"updateTeam",done:g.done}),m.verifyOptions(g,"teamId","team::updateTeam"),g.action="update",this.processCallback(g),g.team=new S(g),this.sendCmd("updateTeam",{team:g.team,antispamTag:{antiSpamBusinessId:g.antiSpamBusinessId},single:!0},g.callback)},u.addTeamMembers=function(g){var v;(g=g||{}).done=k({instance:this,className:"NIMFn",funcName:"addTeamMembers",done:g.done}),m.verifyOptions(g,"teamId accounts","team::addTeamMembers"),m.verifyParamType("accounts",g.accounts,"array","team::addTeamMembers"),this.processPs(g),m.notexist(g.custom)&&(g.custom=""),this.processCallback(g);var ue={teamId:g.teamId,accounts:i(v=g.accounts).call(v,0),ps:g.ps,attach:g.custom};this.sendCmd("addTeamMembers",ue,g.callback)},u.removeTeamMembers=function(g){var v;(g=g||{}).done=k({instance:this,className:"NIMFn",funcName:"removeTeamMembers",done:g.done}),m.verifyOptions(g,"teamId accounts","team::removeTeamMembers"),m.verifyParamType("accounts",g.accounts,"array","team::removeTeamMembers"),this.processCallback(g);var ue={teamId:g.teamId,accounts:i(v=g.accounts).call(v,0)};this.sendCmd("removeTeamMembers",ue,g.callback)},u.acceptTeamInvite=function(g){(g=g||{}).done=k({instance:this,className:"NIMFn",funcName:"acceptTeamInvite",done:g.done}),m.verifyOptions(g,"idServer teamId from","team::acceptTeamInvite"),this.processCallback(g);var v={idServer:g.idServer,teamId:g.teamId,from:g.from,type:"teamInvite"};this.sendCmd("acceptTeamInvite",v,g.callback)},u.rejectTeamInvite=function(g){(g=g||{}).done=k({instance:this,className:"NIMFn",funcName:"rejectTeamInvite",done:g.done}),m.verifyOptions(g,"idServer teamId from","team::rejectTeamInvite"),this.processPs(g),this.processCallback(g);var v={idServer:g.idServer,teamId:g.teamId,from:g.from,ps:g.ps,type:"teamInvite"};this.sendCmd("rejectTeamInvite",v,g.callback)},u.applyTeam=function(g){(g=g||{}).done=k({instance:this,className:"NIMFn",funcName:"applyTeam",done:g.done}),m.verifyOptions(g,"teamId","team::applyTeam"),this.processPs(g),this.processCallback(g);var v={teamId:g.teamId,ps:g.ps};this.sendCmd("applyTeam",v,g.callback)},u.passTeamApply=function(g){(g=g||{}).done=k({instance:this,className:"NIMFn",funcName:"passTeamApply",done:g.done}),m.verifyOptions(g,"idServer teamId from","team::passTeamApply"),this.processCallback(g);var v={idServer:g.idServer,teamId:g.teamId,from:g.from,type:"applyTeam"};this.sendCmd("passTeamApply",v,g.callback)},u.rejectTeamApply=function(g){(g=g||{}).done=k({instance:this,className:"NIMFn",funcName:"rejectTeamApply",done:g.done}),m.verifyOptions(g,"idServer teamId from","team::rejectTeamApply"),this.processPs(g),this.processCallback(g);var v={idServer:g.idServer,teamId:g.teamId,from:g.from,ps:g.ps,type:"applyTeam"};this.sendCmd("rejectTeamApply",v,g.callback)},u.addTeamManagers=function(g){var v;(g=g||{}).done=k({instance:this,className:"NIMFn",funcName:"addTeamManagers",done:g.done}),m.verifyOptions(g,"teamId accounts","team::addTeamManagers"),m.verifyParamType("accounts",g.accounts,"array","team::addTeamManagers"),this.processCallback(g);var ue={teamId:g.teamId,accounts:i(v=g.accounts).call(v,0)};this.sendCmd("addTeamManagers",ue,g.callback)},u.removeTeamManagers=function(g){var v;(g=g||{}).done=k({instance:this,className:"NIMFn",funcName:"removeTeamManagers",done:g.done}),m.verifyOptions(g,"teamId accounts","team::removeTeamManagers"),m.verifyParamType("accounts",g.accounts,"array","team::removeTeamManagers"),this.processCallback(g);var ue={teamId:g.teamId,accounts:i(v=g.accounts).call(v,0)};this.sendCmd("removeTeamManagers",ue,g.callback)},u.updateInfoInTeam=function(g){(g=g||{}).done=k({instance:this,className:"NIMFn",funcName:"updateInfoInTeam",done:g.done}),m.verifyOptions(g,"teamId","team::updateInfoInTeam"),this.processCallback(g),this.sendCmd("updateInfoInTeam",{teamMember:new O(g),single:!0},g.callback)},u.updateNickInTeam=function(g){(g=g||{}).done=k({instance:this,className:"NIMFn",funcName:"updateNickInTeam",done:g.done}),m.verifyOptions(g,"teamId account","team::updateNickInTeam"),this.processCallback(g),this.sendCmd("updateNickInTeam",{teamMember:new O(g),single:!0},g.callback)},u.updateMuteStateInTeam=function(g){(g=g||{}).done=k({instance:this,className:"NIMFn",funcName:"updateMuteStateInTeam",done:g.done}),m.verifyOptions(g,"teamId account mute","team::updateMuteStateInTeam"),this.processCallback(g),g.mute=g.mute?1:0,this.sendCmd("updateMuteStateInTeam",g)},u.getMutedTeamMembers=function(g){(g=g||{}).done=k({instance:this,className:"NIMFn",funcName:"getMutedTeamMembers",done:g.done}),m.verifyOptions(g,"teamId","team::getMutedTeamMembers"),this.processCallback(g),this.sendCmd("getMutedTeamMembers",g)},u.leaveTeam=function(g){(g=g||{}).done=k({instance:this,className:"NIMFn",funcName:"leaveTeam",done:g.done}),m.verifyOptions(g,"teamId","team::leaveTeam"),this.processCallback(g);var v={teamId:g.teamId};this.sendCmd("leaveTeam",v,g.callback)},u.transferTeam=function(g){(g=g||{}).done=k({instance:this,className:"NIMFn",funcName:"transferTeam",done:g.done}),m.verifyOptions(g,"teamId account leave","team::transferTeam"),m.verifyParamType("leave",g.leave,"boolean","team::transferTeam"),this.processCallback(g);var v={teamId:g.teamId,account:g.account,leave:g.leave};this.sendCmd("transferTeam",v,g.callback)},u.dismissTeam=function(g){(g=g||{}).done=k({instance:this,className:"NIMFn",funcName:"dismissTeam",done:g.done}),m.verifyOptions(g,"teamId","team::dismissTeam"),this.processCallback(g);var v={teamId:g.teamId};this.sendCmd("dismissTeam",v,g.callback)},u.getTeam=function(g){(g=g||{}).done=k({instance:this,className:"NIMFn",funcName:"getTeam",done:g.done});var v,ue=this,L=ue.db;function re(){ue.sendCmd("getTeam",{teamId:g.teamId},g.callback)}m.verifyOptions(g,"teamId","team::getTeam"),ue.processCallback(g),g.cbaop=function(le){le||ue.logger.info("api::getTeam: cbaop ".concat(v))},v=g.teamId,L.enable&&!g.sync?L.getTeam(v).then(function(le){le&&le.validToCurrentUser?(ue.logger.log("api::getTeam: db.getTeam ".concat(v)),g.done(null,le)):re()},re):re()},u.getTeams=function(g){(g=g||{}).done=k({instance:this,className:"NIMFn",funcName:"getTeams",done:g.done});var v=this,ue=v.db,L=0;function re(){v.sendCmd("getTeams",{timetag:L,NOTSTORE:"timetag"},g.callback)}m.verifyOptions(g),v.processCallback(g),ue.enable?ue.getTeamsTimetag().then(function(le){L=le,re()},re):re()},u.getTeamsById=function(g){(g=g||{}).done=k({instance:this,className:"NIMFn",funcName:"getTeamsById",done:g.done}),m.verifyOptions(g,"teamIds","teams::getTeamsById"),this.processCallback(g),this.sendCmd("getTeamsById",{teamIds:g.teamIds},g.callback)},u.getTeamMembers=function(g){(g=g||{}).done=k({instance:this,className:"NIMFn",funcName:"getTeamMembers",done:g.done});var v=this;m.verifyOptions(g,"teamId","team::getTeamMembers"),v.processCallback(g),v.sendCmd("getTeamMembers",{teamId:g.teamId,timetag:0,NOTSTORE:"timetag"},g.callback)},u.getTeamMemberByTeamIdAndAccount=function(g){(g=g||{}).done=k({instance:this,className:"NIMFn",funcName:"getTeamMemberByTeamIdAndAccount",done:g.done});var v=this;m.verifyParamType("teamId",g.teamId,"numeric or numeric string","team::getTeamMemberByTeamIdAndAccount"),m.verifyOptions(g,"account","team::getTeamMemberByTeamIdAndAccount"),v.processCallback(g),v.sendCmd("getTeamMembers",{teamId:g.teamId,timetag:0,NOTSTORE:"timetag"},function(ue,L,re){var le={};if(L&&L.members&&L.members.length){for(var oe=0;oe<L.members.length;oe++)if(L.members[oe].account===g.account){le[g.account]=L.members[oe];break}}g.callback(ue,le,re)})},u.getTeamMemberInvitorAccid=function(g){(g=g||{}).done=k({instance:this,className:"NIMFn",funcName:"getTeamMemberInvitorAccid",done:g.done}),m.verifyParamType("teamId",g.teamId,"numeric or numeric string","team::getTeamMemberInvitorAccid"),y(g.accounts)||(m.verifyParamType("accounts",g.accounts,"array","team::getTeamMemberInvitorAccid"),g.accounts.length>200&&m.onParamError("accounts 参数数组长度不能超过200","team::getTeamMemberInvitorAccid"));var v,ue={teamId:g.teamId};g.accounts.length&&(ue.accounts=i(v=g.accounts).call(v,0)),this.processCallback(g),this.sendCmd("getTeamMemberInvitorAccid",ue,function(L,re,le){g.callback(L,le&&le.accountsMap||{})})},u.notifyForNewTeamMsg=function(g){(g=g||{}).done=k({instance:this,className:"NIMFn",funcName:"notifyForNewTeamMsg",done:g.done}),m.verifyOptions(g,"teamIds","team::notifyForNewTeamMsg"),this.protocol.notifyForNewTeamMsg(g.teamIds).then(function(v){g.done(v.error||null,o(v),v.miss)},function(v){g.done(v)})},u.getMyTeamMembers=function(g){k({instance:this,className:"NIMFn",funcName:"getMyTeamMembers",done:g.done,hasCallback:!1});var v=g.done;m.verifyOptions(g,"teamIds","team::getMyTeamMembers");var ue=this.processCallbackPromise(g);return this.sendCmd("getMyTeamMembers",g),ue.then(function(L){return typeof v=="function"?v(null,L):L}).catch(function(L){if(typeof v=="function")return v(L);throw L})},u.getLocalTeams=function(g){(g=g||{}).done=k({instance:this,className:"NIMFn",funcName:"getLocalTeams",done:g.done});var v,ue=this.db,L=[];function re(){g.teams=L,g.done(v,g)}m.verifyOptions(g,"teamIds","team::getLocalTeams"),m.verifyParamType("teamIds",g.teamIds,"array","team::getLocalTeams"),this.processCallback(g),ue.enable?ue.getTeamsByTeamIds(g.teamIds).then(function(le){L=a(le).call(le,function(oe){return!!oe}),re()},function(le){v=le,re()}):re()},u.getTeamsFromDB=function(){var g=s(r.mark(function v(ue){var L,re,le;return r.wrap(function(oe){for(;;)switch(oe.prev=oe.next){case 0:return re=(L=this).db,(ue=ue||{}).done=k({instance:this,className:"NIMFn",funcName:"getTeamsFromDB",done:ue.done}),m.validate({teamIds:{type:"array",required:!1}},ue,"team::getTeamsFromDB"),L.processCallback(ue),oe.next=8,re.getTeams(ue);case 8:return le=oe.sent,ue.callback(null,le),oe.abrupt("return",le);case 11:case"end":return oe.stop()}},v,this)}));return function(v){return g.apply(this,arguments)}}(),u.getLocalTeamMembers=function(g){(g=g||{}).done=k({instance:this,className:"NIMFn",funcName:"getLocalTeamMembers",done:g.done});var v,ue=this.db,L=[];function re(){g.members=L,g.done(v,g)}m.verifyOptions(g,"teamId accounts","team::getLocalTeamMembers"),m.verifyParamType("accounts",g.accounts,"array","team::getLocalTeamMembers"),this.processCallback(g),ue.enable?ue.getInvalidTeamMembers(g.teamId,g.accounts).then(function(le){L=a(le).call(le,function(oe){return!!oe}),re()},function(le){v=le,re()}):re()},u.getTeamMembersFromDB=function(){var g=s(r.mark(function v(ue){var L,re,le;return r.wrap(function(oe){for(;;)switch(oe.prev=oe.next){case 0:return re=(L=this).db,(ue=ue||{}).done=k({instance:this,className:"NIMFn",funcName:"getTeamMembersFromDB",done:ue.done}),m.validate({teamIds:{type:"array",required:!1},accountIds:{type:"array",required:!1}},ue,"team::getTeamMembersFromDB"),L.processCallback(ue),oe.next=8,re.getTeamMembers(ue);case 8:return le=oe.sent,ue.callback(null,le),oe.abrupt("return",le);case 11:case"end":return oe.stop()}},v,this)}));return function(v){return g.apply(this,arguments)}}(),u.deleteLocalTeam=function(g){(g=g||{}).done=k({instance:this,className:"NIMFn",funcName:"deleteLocalTeam",done:g.done});var v,ue=this.db;function L(){g.done(v,g)}m.verifyOptions(g,"teamId","team::deleteLocalTeam"),this.processCallback(g),ue.enable?ue.deleteTeam(g.teamId).then(function(){L()},function(re){v=re,L()}):L()},u.muteTeamAll=function(g){(g=g||{}).done=k({instance:this,className:"NIMFn",funcName:"muteTeamAll",done:g.done}),m.verifyOptions(g,"teamId mute","team::muteTeamAll"),g.mute=g.mute?1:0,this.processCallback(g),this.sendCmd("muteTeamAll",g)},u.sendTeamMsgReceipt=function(g){(g=g||{}).done=k({instance:this,className:"NIMFn",funcName:"sendTeamMsgReceipt",done:g.done}),m.verifyOptions(g,"teamMsgReceipts","team::sendTeamMsgReceipt"),g.teamMsgReceipts.length>50?this.logger.error("team::sendTeamMsgReceipt：teamMsgReceipts length over 50"):(this.processCallback(g),this.sendCmd("sendTeamMsgReceipt",g))},u.getTeamMsgReads=function(g){(g=g||{}).done=k({instance:this,className:"NIMFn",funcName:"getTeamMsgReads",done:g.done}),m.verifyOptions(g,"teamMsgReceipts","team::getTeamMsgReads"),this.processCallback(g),this.sendCmd("getTeamMsgReads",g)},u.getTeamMsgReadAccounts=function(g){var v=this;(g=g||{}).done=k({instance:this,className:"NIMFn",funcName:"getTeamMsgReadAccounts",done:g.done});var ue,L=this;m.verifyOptions(g,"teamMsgReceipt","team::getTeamMsgReadAccounts"),g.callback=function(re,le,oe){re&&ue?(le=le||{teamMsgReceipt:g.teamMsgReceipt},g.done(re,le,{teamMsgReceipt:g.teamMsgReceipt,unreadAccounts:ue.unreadAccounts,readAccounts:ue.readAccounts})):g.done(re,le,oe)},this.db.enable&&g.teamMsgReceipt.idClient?this.db.getMsgReadDetail(g.teamMsgReceipt.idClient).then(function(re){if(ue=re,!re)return d.reject("no record");if(re.unreadAccounts&&re.unreadAccounts.length>0)return d.reject("unreadAccounts.length > 0");var le={teamMsgReceipt:g.teamMsgReceipt,unreadAccounts:re.unreadAccounts,readAccounts:re.readAccounts};L.logger.info("getTeamMsgReadAccounts from db"),g.done(null,{teamMsgReceipt:g.teamMsgReceipt},le)}).catch(function(re){v.logger.warn("db.getMsgReadDetail invalid",re),L.sendCmd("getTeamMsgReadAccounts",g)}):L.sendCmd("getTeamMsgReadAccounts",g)},u.addTeamMembersFollow=function(){var g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};m.validate({teamId:{type:"string",allowEmpty:!1,required:!0},accountIds:{type:"array",min:1,itemType:"string",required:!0}},g),g.done=k({instance:this,className:"NIMFn",funcName:"addTeamMembersFollow",done:g.done}),this.processCallback(g),this.sendCmd("updateInfoInTeam",{teamMember:{teamId:g.teamId},teamSpecialFollowUpdateTag:{accountIds:c(g.accountIds),type:1},single:!0},g.callback)},u.removeTeamMembersFollow=function(g){m.validate({teamId:{type:"string",allowEmpty:!1,required:!0},accountIds:{type:"array",min:1,itemType:"string",required:!0}},g),g.done=k({instance:this,className:"NIMFn",funcName:"removeTeamMembersFollow",done:g.done}),this.processCallback(g),this.sendCmd("updateInfoInTeam",{teamMember:{teamId:g.teamId},teamSpecialFollowUpdateTag:{accountIds:c(g.accountIds),type:0},single:!0},g.callback)}},function(t,n,e){var r=e(759),s=e(3),i=e(10),o=e(26),a=e(15),d=e(9),c=e(2),u=e(6),m=e(8),y=e(40).fn,S=e(0),O=S.undef,k=e(308),g=e(203),v=e(25).reportAPI;function ue(L){var re=this.db;if(!re.enable)return s.resolve({valid:!1});var le=re.getSuperTeam(L),oe=re.getSuperTeamMembersTimetag(L);return s.all([le,oe]).then(function(he){var Ie=r(he,2),ie=Ie[0],Ne=Ie[1],Ve=ie&&ie.memberUpdateTime,Ce={timetag:Ne=Ne||0};return Ve&&Ne>=Ve&&(Ce.valid=!0),s.resolve(Ce)}).catch(function(){return s.resolve({timetag:0})})}y.addSuperTeamMembers=function(L){(L=L||{}).done=v({instance:this,className:"NIMFn",funcName:"addSuperTeamMembers",done:L.done}),S.verifyOptions(L,"teamId accounts","superTeam::addSuperTeamMembers"),S.verifyParamType("accounts",L.accounts,"array","superTeam::addSuperTeamMembers");var re=S.deduplicate(L.accounts);this.processPs(L),this.processCallback(L);var le={teamId:L.teamId,accounts:re,ps:L.ps};this.sendCmd("addSuperTeamMembers",le,L.callback)},y.removeSuperTeamMembers=function(L){(L=L||{}).done=v({instance:this,className:"NIMFn",funcName:"removeSuperTeamMembers",done:L.done}),S.verifyOptions(L,"teamId accounts","team::removeSuperTeamMembers"),S.verifyParamType("accounts",L.accounts,"array","team::removeSuperTeamMembers");var re=S.deduplicate(L.accounts);this.processCallback(L);var le={teamId:L.teamId,accounts:re};this.sendCmd("removeSuperTeamMembers",le,L.callback)},y.leaveSuperTeam=function(L){(L=L||{}).done=v({instance:this,className:"NIMFn",funcName:"leaveSuperTeam",done:L.done}),S.verifyOptions(L,"teamId","superTeam::leaveSuperTeam"),this.processCallback(L);var re={teamId:L.teamId};this.sendCmd("leaveSuperTeam",re,L.callback)},y.getSuperTeam=function(L){(L=L||{}).done=v({instance:this,className:"NIMFn",funcName:"getSuperTeam",done:L.done});var re,le=this,oe=le.db;function he(){le.sendCmd("getSuperTeam",{teamId:L.teamId},L.callback)}S.verifyOptions(L,"teamId","team::getSuperTeam"),le.processCallback(L),L.cbaop=function(Ie){Ie||le.logger.info("api::getSuperTeam: cbaop ".concat(re))},re=L.teamId,oe.enable&&!L.sync?oe.getSuperTeam(re).then(function(Ie){Ie&&Ie.validToCurrentUser?(le.logger.log("api::getSuperTeam: db.getSuperTeam ".concat(re)),L.done(null,Ie)):he()}).catch(function(){he()}):he()},y.getSuperTeams=function(L){(L=L||{}).done=v({instance:this,className:"NIMFn",funcName:"getSuperTeams",done:L.done});var re=this,le=re.db,oe=0;function he(){re.sendCmd("getSuperTeams",{timetag:oe,NOTSTORE:"timetag"},L.callback)}S.verifyOptions(L),re.processCallback(L),le.enable?le.getSuperTeamsTimetag().then(function(Ie){oe=Ie,he()},he):he()},y.updateSuperTeam=function(L){(L=L||{}).done=v({instance:this,className:"NIMFn",funcName:"updateSuperTeam",done:L.done}),S.verifyOptions(L,"teamId","superTeam::updateSuperTeam"),L.action="update",this.processCallback(L),L.team=new k(L),this.sendCmd("updateSuperTeam",{team:L.team,antispamTag:{antiSpamBusinessId:L.antiSpamBusinessId},single:!0},L.callback)},y.updateInfoInSuperTeam=function(L){(L=L||{}).done=v({instance:this,className:"NIMFn",funcName:"updateInfoInSuperTeam",done:L.done}),S.verifyOptions(L,"teamId","superTeam::updateInfoInSuperTeam"),this.processCallback(L),this.sendCmd("updateInfoInSuperTeam",{superTeamMember:new g(L),single:!0},L.callback)},y.getSuperTeamMembersByJoinTime=function(L){(L=L||{}).done=v({instance:this,className:"NIMFn",funcName:"getSuperTeamMembersByJoinTime",done:L.done});var re=this,le=L,oe=le.joinTime,he=i(le),Ie=le.limit,ie=le.teamId;he=!!he,O(oe)&&(oe=0),O(Ie)&&(Ie=100),S.verifyOptions(L,"teamId","superTeam::getSuperTeamMembersByJoinTime"),S.verifyParamType("joinTime",oe,"number","api::superTeam::getSuperTeamMembersByJoinTime"),S.verifyParamType("limit",Ie,"number","api::superTeam::getSuperTeamMembersByJoinTime"),re.processCallback(L),re.sendCmd("getSuperTeamMembersByJoinTime",{teamId:ie,limit:Ie,joinTime:oe,reverse:he,timetag:0,NOTSTORE:"timetag"},L.callback)},y.getAllSuperTeamMembers=function(L){(L=L||{}).done=v({instance:this,className:"NIMFn",funcName:"getAllSuperTeamMembers",done:L.done});var re=this,le=this.db;function oe(he){he=he||0,re.sendCmd("getSuperTeamMembers",{teamId:L.teamId,timetag:he,NOTSTORE:"timetag"},L.callback)}S.verifyOptions(L,"teamId","superTeam::getAllSuperTeamMembers"),re.processCallback(L),o(ue).call(ue,this)(L.teamId).then(function(he){var Ie=he.valid,ie=he.timetag;Ie?(re.logger.info("getAllSuperTeamMembers from local db"),le.getSuperTeamMembers(L.teamId).then(function(Ne){var Ve={teamId:L.teamId,members:Ne};L.done(null,Ve)},function(){return oe()})):oe(ie)})},y.applySuperTeam=function(L){(L=L||{}).done=v({instance:this,className:"NIMFn",funcName:"applySuperTeam",done:L.done}),S.verifyOptions(L,"teamId","team::applySuperTeam"),S.verifyOptions(L,"teamId","team::applySuperTeam"),this.processPs(L),this.processCallback(L);var re={teamId:L.teamId,ps:L.ps};this.sendCmd("applySuperTeam",re,L.callback)},y.passSuperTeamApply=function(L){(L=L||{}).done=v({instance:this,className:"NIMFn",funcName:"passSuperTeamApply",done:L.done}),S.verifyOptions(L,"idServer teamId from","team::passSuperTeamApply"),this.processCallback(L);var re={idServer:L.idServer,teamId:L.teamId,from:L.from};this.sendCmd("passSuperTeamApply",re,L.callback)},y.rejectSuperTeamApply=function(L){(L=L||{}).done=v({instance:this,className:"NIMFn",funcName:"rejectSuperTeamApply",done:L.done}),S.verifyOptions(L,"idServer teamId from","team::rejectSuperTeamApply"),this.processPs(L),this.processCallback(L);var re={idServer:L.idServer,teamId:L.teamId,from:L.from,ps:L.ps};this.sendCmd("rejectSuperTeamApply",re,L.callback)},y.acceptSuperTeamInvite=function(L){(L=L||{}).done=v({instance:this,className:"NIMFn",funcName:"acceptSuperTeamInvite",done:L.done}),S.verifyOptions(L,"idServer teamId from","team::acceptSuperTeamInvite"),this.processCallback(L);var re={idServer:L.idServer,teamId:L.teamId,from:L.from};this.sendCmd("acceptSuperTeamInvite",re,L.callback)},y.rejectSuperTeamInvite=function(L){(L=L||{}).done=v({instance:this,className:"NIMFn",funcName:"rejectSuperTeamInvite",done:L.done}),S.verifyOptions(L,"idServer teamId from","team::rejectSuperTeamInvite"),this.processPs(L),this.processCallback(L);var re={idServer:L.idServer,teamId:L.teamId,from:L.from,ps:L.ps};this.sendCmd("rejectSuperTeamInvite",re,L.callback)},y.addSuperTeamManagers=function(L){var re;(L=L||{}).done=v({instance:this,className:"NIMFn",funcName:"addSuperTeamManagers",done:L.done}),S.verifyOptions(L,"teamId accounts","team::addSuperTeamManagers"),S.verifyParamType("accounts",L.accounts,"array","team::addSuperTeamManagers"),this.processCallback(L);var le={teamId:L.teamId,accounts:a(re=L.accounts).call(re,0)};this.sendCmd("addSuperTeamManagers",le,L.callback)},y.removeSuperTeamManagers=function(L){var re;(L=L||{}).done=v({instance:this,className:"NIMFn",funcName:"removeSuperTeamManagers",done:L.done}),S.verifyOptions(L,"teamId accounts","team::removeSuperTeamManagers"),S.verifyParamType("accounts",L.accounts,"array","team::removeSuperTeamManagers"),this.processCallback(L);var le={teamId:L.teamId,accounts:a(re=L.accounts).call(re,0)};this.sendCmd("removeSuperTeamManagers",le,L.callback)},y.updateSuperTeamMembersMute=function(L){(L=L||{}).done=v({instance:this,className:"NIMFn",funcName:"updateSuperTeamMembersMute",done:L.done}),S.verifyOptions(L,"teamId accounts mute","team::updateSuperTeamMembersMute"),S.verifyParamType("accounts",L.accounts,"array","team::updateSuperTeamMembersMute"),S.verifyArrayMax("accounts",L.accounts,10),this.processCallback(L),L.mute=L.mute?1:0,this.sendCmd("updateSuperTeamMembersMute",L)},y.updateSuperTeamMute=function(L){(L=L||{}).done=v({instance:this,className:"NIMFn",funcName:"updateSuperTeamMute",done:L.done}),S.verifyOptions(L,"teamId mute","team::updateSuperTeamMute"),L.mute=L.mute?1:0,this.processCallback(L),this.sendCmd("updateSuperTeamMute",L)},y.updateNickInSuperTeam=function(L){(L=L||{}).done=v({instance:this,className:"NIMFn",funcName:"updateNickInSuperTeam",done:L.done}),S.verifyOptions(L,"teamId account","team::updateNickInSuperTeam"),this.processCallback(L),this.sendCmd("updateNickInSuperTeam",{superTeamMember:new g(L),single:!0},L.callback)},y.transferSuperTeam=function(L){(L=L||{}).done=v({instance:this,className:"NIMFn",funcName:"transferSuperTeam",done:L.done}),S.verifyOptions(L,"teamId account leave","team::transferSuperTeam"),S.verifyParamType("leave",L.leave,"boolean","team::transferSuperTeam"),this.processCallback(L);var re={teamId:L.teamId,account:L.account,leave:L.leave};this.sendCmd("transferSuperTeam",re,L.callback)},y.getSuperTeamMembersByAccounts=function(L){(L=L||{}).done=v({instance:this,className:"NIMFn",funcName:"getSuperTeamMembersByAccounts",done:L.done});var re=this,le=this.db,oe=L,he=oe.teamId,Ie=oe.accounts;if(S.verifyOptions(L,"teamId accounts","superTeam::getSuperTeamMembersByAccounts"),S.verifyParamType("accounts",Ie,"array","superTeam::getSuperTeamMembersByAccounts"),S.verifyArrayMax("accounts",Ie,20),Ie.length<=0)return S.onParamError("参数accounts不能为空数组","superTeam::getSuperTeamMembersByAccounts");function ie(){var Ne=d(Ie).call(Ie,function(Ve){return he+"|"+Ve});re.processCallback(L),re.sendCmd("getSuperTeamMembersByAccounts",{memberIds:Ne},function(Ve,Ce){L.done(null,{accounts:Ie,members:Ce.members,invaldAccounts:Ce.invalid})})}ue.call(this,he).then(function(Ne){var Ve,Ce,Ue;return Ne.valid?(Ve=[],Ce=[],Ue=[],c(Ie).call(Ie,function(qe){var Oe,$e=le.getSuperTeamMemberById(u(Oe="".concat(he,"-")).call(Oe,qe)).then(function(_e){Ce.push(_e)}).catch(function(){Ue.push(qe)});Ve.push($e)}),void s.all(Ve).then(function(){L.done(null,{accounts:Ie,members:Ce,invaldAccounts:Ue})})):ie()}).catch(function(){return ie()})},y.getMutedSuperTeamMembers=function(L){(L=L||{}).done=v({instance:this,className:"NIMFn",funcName:"getMutedSuperTeamMembers",done:L.done});var re=this,le=L,oe=le.joinTime,he=i(le),Ie=le.limit,ie=le.teamId;he=!!he,O(oe)&&(oe=0),O(Ie)&&(Ie=100),S.verifyOptions(L,"teamId","superTeam::getSuperTeamMembersByJoinTime"),S.verifyParamType("joinTime",oe,"number","api::superTeam::getSuperTeamMembersByJoinTime"),S.verifyParamType("limit",Ie,"number","api::superTeam::getSuperTeamMembersByJoinTime"),this.processCallback(L),re.sendCmd("getMutedSuperTeamMembers",{teamId:ie,limit:Ie,joinTime:oe,reverse:he},L.callback)},y.addSuperTeamMembersFollow=function(){var L=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};S.validate({teamId:{type:"string",allowEmpty:!1,required:!0},accountIds:{type:"array",min:1,itemType:"string",required:!0}},L),L.done=v({instance:this,className:"NIMFn",funcName:"addSuperTeamMembersFollow",done:L.done}),this.processCallback(L),this.sendCmd("updateInfoInSuperTeam",{superTeamMember:{teamId:L.teamId},teamSpecialFollowUpdateTag:{accountIds:m(L.accountIds),type:1},single:!0},L.callback)},y.removeSuperTeamMembersFollow=function(L){S.validate({teamId:{type:"string",allowEmpty:!1,required:!0},accountIds:{type:"array",min:1,itemType:"string",required:!0}},L),L.done=v({instance:this,className:"NIMFn",funcName:"removeSuperTeamMembersFollow",done:L.done}),this.processCallback(L),this.sendCmd("updateInfoInSuperTeam",{superTeamMember:{teamId:L.teamId},teamSpecialFollowUpdateTag:{accountIds:m(L.accountIds),type:0},single:!0},L.callback)},y.getMySuperTeamMembers=function(L){v({instance:this,className:"NIMFn",funcName:"getMySuperTeamMembers",done:L.done,hasCallback:!1}),this.processCallback(L),S.verifyOptions(L,"teamIds","team::getMySuperTeamMembers"),this.sendCmd("getMySuperTeamMembers",L)}},function(t,n,e){var r=e(57),s=e(9),i=e(3),o=e(2),a=e(6),d=e(10),c=e(754),u=e(37),m=e(15),y=e(90),S=e(32),O=e(16),k=e(7),g=e(88),v=e(89),ue=e(72),L=e(58);function re(Oe,$e){var _e=v!==void 0&&ue(Oe)||Oe["@@iterator"];if(!_e){if(S(Oe)||(_e=function(or,xe){var nr;if(or){if(typeof or=="string")return le(or,xe);var ir=m(nr=Object.prototype.toString.call(or)).call(nr,8,-1);if(ir==="Object"&&or.constructor&&(ir=or.constructor.name),ir==="Map"||ir==="Set")return g(or);if(ir==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(ir))return le(or,xe)}}(Oe))||$e&&Oe&&typeof Oe.length=="number"){_e&&(Oe=_e);var er=0,Pt=function(){};return{s:Pt,n:function(){return er>=Oe.length?{done:!0}:{done:!1,value:Oe[er++]}},e:function(or){throw or},f:Pt}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var ar,pr=!0,lr=!1;return{s:function(){_e=_e.call(Oe)},n:function(){var or=_e.next();return pr=or.done,or},e:function(or){lr=!0,ar=or},f:function(){try{pr||_e.return==null||_e.return()}finally{if(lr)throw ar}}}}function le(Oe,$e){($e==null||$e>Oe.length)&&($e=Oe.length);for(var _e=0,er=new Array($e);_e<$e;_e++)er[_e]=Oe[_e];return er}var oe=e(40).fn,he=e(0),Ie=he.undef,ie=he.notundef,Ne=e(297),Ve=e(154),Ce=e(25).reportAPI,Ue=e(854);function qe(Oe,$e){var _e=this,er=[],Pt=[],ar=this.db,pr=this;return ar.enable?(o(Oe).call(Oe,function(or){var xe=_e.protocol.getSessionInCache(or);xe?lr(xe,or):Pt.push(ar.getSession(or).then(function(nr){return lr(nr,or)}))}),i.all(Pt).then(function(){return er})):(o(Oe).call(Oe,function(or){return lr(_e.protocol.getSessionInCache(or),or)}),i.resolve(er));function lr(or,xe){var nr,ir,dr,Lt;or?or.lastMsg?or.scene&&or.to?or.ack>=or.lastMsg.time?pr.logger.warn(a(nr="".concat($e," not need ack ")).call(nr,or.id)):er.push(or):pr.logger.warn(a(ir="".concat($e," session.scene|to undefined ")).call(ir,or.id)):pr.logger.warn(a(dr="".concat($e," session.lastMsg undefined ")).call(dr,or.id)):pr.logger.warn(a(Lt="".concat($e," session undefined ")).call(Lt,xe))}}oe.setCurrSession=function(Oe){Ce({instance:this,className:"NIMFn",funcName:"setCurrSession",hasCallback:!1}),this.resetSessionUnread(Oe),this.protocol.setCurrSession(Oe)},oe.resetAllSessionUnread=function(){Ce({instance:this,className:"NIMFn",funcName:"resetAllSessionUnread",hasCallback:!1});for(var Oe in this.protocol.sessionSet)this.protocol.sessionSet[Oe].unread>0&&this.resetSessionUnread(Oe)},oe.resetSessionsUnread=function(){var Oe=L(r.mark(function $e(_e){var er,Pt,ar,pr,lr,or,xe,nr,ir=arguments;return r.wrap(function(dr){for(;;)switch(dr.prev=dr.next){case 0:return er=ir.length>1&&ir[1]!==void 0?ir[1]:function(){},er=Ce({instance:this,className:"NIMFn",funcName:"resetSessionsUnread",done:er}),(Pt=this).logger.info("resetSessionsUnread::",_e),dr.next=6,qe.call(this,_e,"api::resetSessionsUnread");case 6:if(ar=dr.sent,Pt.protocol.resetSessionsUnread(ar),Pt.options.syncSessionUnread&&ar.length!==0){dr.next=11;break}return er(),dr.abrupt("return");case 11:pr=s(ar).call(ar,function(Lt){return{scene:Lt.scene==="p2p"?0:1,to:Lt.to,timetag:Lt.lastMsg.time}}),lr=Ue(pr,50),or=re(lr),dr.prev=14,nr=r.mark(function Lt(){var cr;return r.wrap(function(mr){for(;;)switch(mr.prev=mr.next){case 0:return cr=xe.value,mr.next=3,new i(function(tr,At){Pt.sendCmd("markSessionAckBatch",{sessionAckTags:cr},function(kt){kt?(er(kt),At(kt)):tr()})});case 3:case"end":return mr.stop()}},Lt)}),or.s();case 17:if((xe=or.n()).done){dr.next=21;break}return dr.delegateYield(nr(),"t0",19);case 19:dr.next=17;break;case 21:dr.next=26;break;case 23:dr.prev=23,dr.t1=dr.catch(14),or.e(dr.t1);case 26:return dr.prev=26,or.f(),dr.finish(26);case 29:er(null);case 30:case"end":return dr.stop()}},$e,this,[[14,23,26,29]])}));return function($e){return Oe.apply(this,arguments)}}(),oe.resetSuperTeamSessionsUnread=function(){var Oe=L(r.mark(function $e(_e){var er,Pt,ar,pr,lr,or,xe,nr,ir=arguments;return r.wrap(function(dr){for(;;)switch(dr.prev=dr.next){case 0:return er=ir.length>1&&ir[1]!==void 0?ir[1]:function(){},er=Ce({instance:this,className:"NIMFn",funcName:"resetSuperTeamSessionsUnread",done:er}),(Pt=this).logger.info("resetSuperTeamSessionsUnread::",_e),dr.next=6,qe.call(this,_e,"api::resetSuperTeamSessionsUnread");case 6:if(ar=dr.sent,Pt.protocol.resetSessionsUnread(ar),Pt.options.syncSessionUnread&&ar.length!==0){dr.next=11;break}return er(),dr.abrupt("return");case 11:pr=s(ar).call(ar,function(Lt){return{to:Lt.to,timetag:Lt.lastMsg.time}}),lr=Ue(pr,50),or=re(lr),dr.prev=14,nr=r.mark(function Lt(){var cr;return r.wrap(function(mr){for(;;)switch(mr.prev=mr.next){case 0:return cr=xe.value,mr.next=3,new i(function(tr,At){Pt.sendCmd("markSuperTeamSessionsAck",{sessionAckTags:cr},function(kt){kt?(er(kt),At(kt)):tr()})});case 3:case"end":return mr.stop()}},Lt)}),or.s();case 17:if((xe=or.n()).done){dr.next=21;break}return dr.delegateYield(nr(),"t0",19);case 19:dr.next=17;break;case 21:dr.next=26;break;case 23:dr.prev=23,dr.t1=dr.catch(14),or.e(dr.t1);case 26:return dr.prev=26,or.f(),dr.finish(26);case 29:er(null);case 30:case"end":return dr.stop()}},$e,this,[[14,23,26,29]])}));return function($e){return Oe.apply(this,arguments)}}(),oe.resetSessionUnread=function(Oe){var $e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:function(){};$e=Ce({instance:this,className:"NIMFn",funcName:"resetSessionUnread",done:$e});var _e=this,er=_e.options.resetUnreadMode!==!1,Pt=function(){var or=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;or?$e(or,Oe):$e(null)};_e.logger.info("resetSessionUnread::use reset mode",er);var ar=_e.protocol.getSessionInCache(Oe),pr=!ar&&this.db.enable?_e.db.getSession(Oe):i.resolve(ar);function lr(or){if(!or.lastMsg&&!or.updateTime)return _e.logger.warn("api::resetSessionUnread: session.lastMsg undefined ".concat(Oe)),Pt();if(!or.scene||!or.to)return _e.logger.warn("api::resetSessionUnread: session.scene|to undefined ".concat(Oe)),Pt();var xe;if(xe=or.lastMsg?or.lastMsg.time:or.updateTime,or&&or.ack&&or.ack>=xe)return _e.logger.warn("api::resetSessionUnread: session ack not needs ".concat(Oe)),Pt();var nr={done:function(dr){dr?(_e.logger.error({message:dr||"mark ack failed",callFunc:"resetSessionUnread"}),Pt(dr||"mark ack failed")):(er||_e.protocol.resetSessionUnread(or),Pt())}};if(_e.processCallback(nr),or.scene==="superTeam")_e.sendCmd("markSuperTeamSessionAck",{to:or.to,timetag:xe},nr.callback);else{var ir={scene:or.scene==="p2p"?0:1,to:or.to,timetag:xe};_e.sendCmd("markSessionAck",ir,nr.callback)}}pr.then(function(or){return or?_e.options.syncSessionUnread?(er&&_e.protocol.resetSessionUnread(or),void lr(or)):(_e.protocol.resetSessionUnread(or),Pt()):(_e.logger.warn("api::resetSessionUnread: session undefined ".concat(Oe)),Pt())})},oe.resetCurrSession=function(){Ce({instance:this,className:"NIMFn",funcName:"resetCurrSession",hasCallback:!1}),this.protocol.setCurrSession("")},oe.insertLocalSession=function(Oe){(Oe=Oe||{}).done=Ce({instance:this,className:"NIMFn",funcName:"insertLocalSession",done:Oe.done});var $e,_e;function er(){Oe.session=_e,Oe.done($e,Oe)}he.verifyOptions(Oe,"scene to","scene::insertLocalSession"),he.verifyParamValid("scene",Oe.scene,this.message.validScenes,"scene::insertLocalSession"),this.protocol.insertLocalSession(Oe).then(function(Pt){_e=Pt,er()},function(Pt){$e=Pt,er()})},oe.getLocalSessions=function(Oe){(Oe=Oe||{}).done=Ce({instance:this,className:"NIMFn",funcName:"getLocalSessions",done:Oe.done});var $e=[];he.verifyOptions(Oe),Ie(Oe.limit)&&(Oe.limit=100),he.verifyParamType("limit",Oe.limit,"number","scene::getLocalSessions"),ie(d(Oe))?he.verifyParamType("reverse",d(Oe),"boolean","scene::getLocalSessions"):Oe.reverse=!1,this.processCallback(Oe);var _e=c(this.protocol.sessionSet),er=0,Pt=Oe.lastSessionId;if(d(Oe)){var ar,pr=re(_e);try{for(pr.s();!(ar=pr.n()).done;){var lr=ar.value,or=lr.id;if(Pt)or===Pt&&(Pt=void 0);else if(lr.lastMsg!==void 0&&!lr.isDeleted){if(++er>Oe.limit)break;$e.push(u({},lr))}}}catch(Lt){pr.e(Lt)}finally{pr.f()}}else{var xe,nr,ir=re(_e);try{for(ir.s();!(nr=ir.n()).done;){var dr=nr.value;if(Pt===dr.id)break;dr.lastMsg===void 0||dr.isDeleted||$e.push(dr)}}catch(Lt){ir.e(Lt)}finally{ir.f()}$e=d(xe=m($e).call($e,-Oe.limit)).call(xe)}this.logger.debug("getLocalSessions::sessions is",$e),$e=s($e).call($e,function(Lt){return y(Ve).call(Ve,Lt)}),Oe.sessions=$e,delete Oe.callback,Oe.done(void 0,Oe)},oe.getLocalSession=function(Oe){(Oe=Oe||{}).done=Ce({instance:this,className:"NIMFn",funcName:"getLocalSession",done:Oe.done});var $e=this,_e=$e.db,er=null;if(he.verifyOptions(Oe,"sessionId","scene::getLocalSession"),he.verifyParamType("sessionId",Oe.sessionId,"string","scene::getLocalSession"),er=$e.protocol.getSessionInCache(Oe.sessionId),$e.logger.debug("getLocalSession::cache session is",er),!er&&_e.enable)return $e.processCallback(Oe),void _e.getSession(Oe.sessionId).then(function(Pt){Pt&&(er=Pt,$e.logger.debug("getLocalSession::db session is",er)),Oe.done(null,er)}).catch(function(Pt){Oe.done(Pt)});Oe.done(null,y(Ve).call(Ve,er))},oe.getLocalSessionsByMsgType=function(Oe){var $e;(Oe=Oe||{}).done=Ce({instance:this,className:"NIMFn",funcName:"getLocalSessionsByMsgType",done:Oe.done});var _e=this.db,er=Oe.exclude,Pt=[],ar=m($e=Ne.validTypes).call($e,0);if(ie(er)){if(typeof er=="string")er=[er];else if(!S(er))return void he.onParamInvalidType("exclude",["string","string array"],"","exclude::getLocalSessionsByMsgType");er=O(er).call(er,function(pr){return k(ar).call(ar,pr)>-1}),ar=O(ar).call(ar,function(pr){return k(er).call(er,pr)===-1})}this.processCallback(Oe),_e.enable?_e.getSessions().then(function(pr){er&&er.length!==0?ar&&ar.length!==0?(o(pr).call(pr,function(lr,or){var xe,nr,ir;lr.lastMsg&&k(er).call(er,lr.lastMsg.type)>-1&&(xe=or,nr=lr.id,ir=_e.getMsgs({sessionId:nr,limit:1,types:ar}).then(function(dr){return dr&&dr[0]?pr[xe].lastMsg=dr[0]:pr[xe].lastMsg=null,i.resolve()}),Pt.push(ir))}),i.all(Pt).then(function(){Oe.done(null,{exclude:er,sessions:pr})})):Oe.done(null,{exclude:er,sessions:s(pr).call(pr,function(lr){lr.lastMsg=null})}):Oe.done(null,{exclude:er,sessions:pr})}):Oe.done(null,{exclude:er,sessions:[]})},oe.updateLocalSession=function(Oe){(Oe=Oe||{}).done=Ce({instance:this,className:"NIMFn",funcName:"updateLocalSession",done:Oe.done});var $e,_e=this,er=_e.db;he.verifyOptions(Oe,"id","scene::updateLocalSession"),_e.processCallback(Oe);var Pt=he.filterObj(Oe,"id localCustom");function ar(){Oe.needNotify!==!1&&_e.protocol.onUpdateSession(Pt),Oe.session=Pt,Oe.done($e,Oe)}Pt=_e.protocol.updateSessionInCache(Oe),er.enable&&Pt?er.updateSession(Pt).then(function(pr){Pt=pr,ar()},function(pr){$e=pr,ar()}):ar()},oe.deleteLocalSession=function(Oe){(Oe=Oe||{}).done=Ce({instance:this,className:"NIMFn",funcName:"deleteLocalSession",done:Oe.done});var $e,_e=this,er=_e.db;he.verifyOptions(Oe,"id","session::deleteLocalSession"),_e.processCallback(Oe);var Pt=_e.protocol.getSessionInCache(Oe.id);if(_e.protocol.deleteSessionInCache(Oe.id,Oe.isLogic),er.enable?(Oe.isLogic?er.deleteSessionLogic(Oe.id):er.deleteSession(Oe.id,Pt)).then(function(){_e.logger.info("sessions::deleteSessionInDb::delete session done",Oe.id),pr()},function(lr){$e=lr,pr()}):pr(),Oe.isDeleteRoaming){var ar=typeof Oe.id=="string"?[Oe.id]:Oe.id;ar=s(ar).call(ar,function(lr){return lr.replace("-","|")}),this.sendCmd("deleteSessions",{sessions:ar},function(){})}function pr(){Oe.done($e,Oe)}},oe.deleteSession=function(Oe,$e){(Oe=Oe||{}).done=Ce({instance:this,className:"NIMFn",funcName:"deleteSession",done:Oe.done}),$e||this.logger.warn('this api will be abandon,please use "deleteLocalSession"'),he.verifyOptions(Oe,"scene to","session::deleteSession"),this.processCallback(Oe),Oe.sessions=[{scene:Oe.scene,to:Oe.to}],this.deleteSessions(Oe)},oe.deleteRoamingMsgBySession=function(Oe){(Oe=Oe||{}).done=Ce({instance:this,className:"NIMFn",funcName:"deleteRoamingMsgBySession",done:Oe.done}),this.deleteSession(Oe,!0)},oe.deleteSessions=function(Oe){var $e,_e;(Oe=Oe||{}).done=Ce({instance:this,className:"NIMFn",funcName:"deleteSessions",done:Oe.done}),he.verifyOptions(Oe,"sessions","session::deleteSessions"),he.verifyParamType("sessions",Oe.sessions,"array","session::deleteSessions"),o($e=Oe.sessions).call($e,function(er,Pt){he.verifyOptions(er,"scene to",!0,"sessions["+Pt+"].","session::deleteSessions")}),this.processCallback(Oe),this.sendCmd("deleteSessions",{sessions:s(_e=Oe.sessions).call(_e,function(er){return er.scene+"|"+er.to})},Oe.callback)},oe.getServerSessions=function(Oe){(Oe=Oe||{}).done=Ce({instance:this,className:"NIMFn",funcName:"getServerSessions",done:Oe.done}),ie(Oe.minTimestamp)&&he.verifyParamType("minTimestamp",Oe.minTimestamp,"number","session::deleteSessions"),ie(Oe.maxTimestamp)&&he.verifyParamType("maxTimestamp",Oe.maxTimestamp,"number","session::deleteSessions"),ie(Oe.needLastMsg)&&(Oe.needLastMsg=Oe.needLastMsg===!1?0:1),ie(Oe.limit)&&(he.verifyParamType("limit",Oe.limit,"number","session::deleteSessions"),he.verifyParamMax("limit",Oe.limit,100,"scene::getLocalSessions")),this.processCallback(Oe),this.sendCmd("getServerSessions",{sessionReqTag:Oe},Oe.callback)},oe.getServerSession=function(Oe){(Oe=Oe||{}).done=Ce({instance:this,className:"NIMFn",funcName:"getServerSession",done:Oe.done}),he.verifyOptions(Oe,"scene to","scene::getServerSession"),he.verifyParamValid("scene",Oe.scene,this.message.validScenes,"scene::getServerSession"),he.verifyParamType("to",Oe.to,"string","to::getServerSession");var $e=Oe.scene+"|"+Oe.to;Oe.scene==="superTeam"&&($e="super_team|"+Oe.to),this.processCallback(Oe),this.sendCmd("getServerSession",{session:{id:$e}},Oe.callback)},oe.updateServerSession=function(Oe){(Oe=Oe||{}).done=Ce({instance:this,className:"NIMFn",funcName:"updateServerSession",done:Oe.done}),he.verifyOptions(Oe,"scene to","scene::updateServerSession"),he.verifyParamValid("scene",Oe.scene,this.message.validScenes,"scene::updateServerSession"),he.verifyParamType("to",Oe.to,"string","to::updateServerSession"),ie(Oe.extra)&&he.verifyParamType("extra",Oe.extra,"string","extra::updateServerSession");var $e=Oe.scene+"|"+Oe.to;Oe.scene==="superTeam"&&($e="super_team|"+Oe.to),this.processCallback(Oe),this.sendCmd("updateServerSession",{session:{id:$e,ext:Oe.extra||""}},Oe.callback)},oe.deleteServerSessions=function(Oe){var $e,_e=this;(Oe=Oe||{}).done=Ce({instance:this,className:"NIMFn",funcName:"deleteServerSessions",done:Oe.done}),he.verifyOptions(Oe,"sessions","scene::deleteServerSessions"),he.verifyParamType("sessions",Oe.sessions,"array","sessions::deleteServerSessions");var er=[];o($e=Oe.sessions).call($e,function(Pt){he.verifyParamValid("scene",Pt.scene,_e.message.validScenes,"scene::deleteServerSessions"),he.verifyParamType("to",Pt.to,"string","to::deleteServerSessions");var ar=Pt.scene+"|"+Pt.to;Pt.scene==="superTeam"&&(ar="super_team|"+Pt.to),er.push({id:ar})}),this.processCallback(Oe),this.sendCmd("deleteServerSessions",{sessions:er},Oe.callback)},oe.updateSessionsWithMoreRoaming=function(Oe){var $e;if((Oe=Oe||{}).done=Ce({instance:this,className:"NIMFn",funcName:"updateSessionsWithMoreRoaming",done:Oe.done}),he.verifyOptions(Oe,"msg","session::updateSessionsWithMoreRoaming"),he.verifyCallback(Oe,"done","session::updateSessionsWithMoreRoaming"),!this.db.enable)return Oe.done(null,"db is disable");var _e={time:Oe.msg.time,idServer:Oe.msg.idServer,to:Oe.msg.to,from:Oe.msg.from};he.verifyParamType("msg.time",Oe.msg.time,"number","time::updateSessionsWithMoreRoaming"),he.verifyParamType("msg.idServer",Oe.msg.idServer,"string","idServer::updateSessionsWithMoreRoaming"),he.verifyParamType("msg.from",Oe.msg.from,"string","from::updateSessionsWithMoreRoaming"),he.verifyParamType("msg.to",Oe.msg.to,"string","to::updateSessionsWithMoreRoaming"),he.verifyParamValid("scene",Oe.msg.scene,this.message.validScenes,"scene::updateSessionsWithMoreRoaming");var er=_e.to===this.account?_e.from:_e.to;_e.id=a($e="".concat(Oe.msg.scene,"-")).call($e,er),this.db.updateSessionsWithMoreRoaming(_e).then(function(Pt){Oe.done(null,Pt)}).catch(function(Pt){Oe.done(Pt)})},oe.deleteSessionsWithMoreRoaming=function(Oe){if((Oe=Oe||{}).done=Ce({instance:this,className:"NIMFn",funcName:"deleteSessionsWithMoreRoaming",done:Oe.done}),he.verifyOptions(Oe,"id","session::deleteSessionsWithMoreRoaming"),he.verifyCallback(Oe,"done","session::deleteSessionsWithMoreRoaming"),!this.db.enable)return Oe.done(null,"db is disable");this.db.deleteSessionsWithMoreRoaming(Oe.id).then(function($e){Oe.done(null,$e)}).catch(function($e){Oe.done($e)})},oe.getSessionsWithMoreRoaming=function(Oe){if((Oe=Oe||{}).done=Ce({instance:this,className:"NIMFn",funcName:"getSessionsWithMoreRoaming",done:Oe.done}),he.verifyCallback(Oe,"done","session::getSessionsWithMoreRoaming"),!this.db.enable)return Oe.done(null,"db is disable");this.db.getSessionsWithMoreRoaming(Oe.id).then(function($e){Oe.done(null,$e)}).catch(function($e){Oe.done($e)})}},function(t,n,e){var r=e(855),s=e(856),i=e(857),o=Math.ceil,a=Math.max;t.exports=function(d,c,u){c=(u?s(d,c,u):c===void 0)?1:a(i(c),0);var m=d==null?0:d.length;if(!m||c<1)return[];for(var y=0,S=0,O=Array(o(m/c));y<m;)O[S++]=r(d,y,y+=c);return O}},function(t,n){t.exports=function(e,r,s){var i=-1,o=e.length;r<0&&(r=-r>o?0:o+r),(s=s>o?o:s)<0&&(s+=o),o=r>s?0:s-r>>>0,r>>>=0;for(var a=Array(o);++i<o;)a[i]=e[i+r];return a}},function(t,n,e){var r=e(201),s=e(202),i=e(302),o=e(91);t.exports=function(a,d,c){if(!o(c))return!1;var u=typeof d;return!!(u=="number"?s(c)&&i(d,c.length):u=="string"&&d in c)&&r(c[d],a)}},function(t,n,e){var r=e(858);t.exports=function(s){var i=r(s),o=i%1;return i==i?o?i-o:i:0}},function(t,n,e){var r=e(859);t.exports=function(s){return s?(s=r(s))===1/0||s===-1/0?17976931348623157e292*(s<0?-1:1):s==s?s:0:s===0?s:0}},function(t,n,e){var r=e(860),s=e(91),i=e(862),o=/^[-+]0x[0-9a-f]+$/i,a=/^0b[01]+$/i,d=/^0o[0-7]+$/i,c=parseInt;t.exports=function(u){if(typeof u=="number")return u;if(i(u))return NaN;if(s(u)){var m=typeof u.valueOf=="function"?u.valueOf():u;u=s(m)?m+"":m}if(typeof u!="string")return u===0?u:+u;u=r(u);var y=a.test(u);return y||d.test(u)?c(u.slice(2),y?2:8):o.test(u)?NaN:+u}},function(t,n,e){var r=e(861),s=/^\s+/;t.exports=function(i){return i&&i.slice(0,r(i)+1).replace(s,"")}},function(t,n){var e=/\s/;t.exports=function(r){for(var s=r.length;s--&&e.test(r.charAt(s)););return s}},function(t,n,e){var r=e(124),s=e(106);t.exports=function(i){return typeof i=="symbol"||s(i)&&r(i)=="[object Symbol]"}},function(t,n,e){var r=e(125),s=e(864),i=e(865),o=e(57),a=e(58),d=e(51),c=e(16),u=e(15),m=e(2),y=e(32),S=e(121),O=e(9),k=e(6),g=e(10),v=e(8),ue=e(870),L=e(4),re=e(52),le=e(53),oe=e(54),he=e(55),Ie=e(43),ie=["callback","done"];function Ne(xe,nr){var ir=L(xe);if(re){var dr=re(xe);nr&&(dr=c(dr).call(dr,function(Lt){return le(xe,Lt).enumerable})),ir.push.apply(ir,dr)}return ir}function Ve(xe){for(var nr=1;nr<arguments.length;nr++){var ir,dr,Lt=arguments[nr]!=null?arguments[nr]:{};nr%2?m(ir=Ne(Object(Lt),!0)).call(ir,function(cr){d(xe,cr,Lt[cr])}):oe?he(xe,oe(Lt)):m(dr=Ne(Object(Lt))).call(dr,function(cr){Ie(xe,cr,le(Lt,cr))})}return xe}var Ce=e(40).fn,Ue=e(0),qe=Ue.undef,Oe=Ue.notundef,$e=e(45),_e=e(154),er=e(153),Pt=e(41),ar=e(76),pr=e(25).reportAPI,lr=e(11);Ce.sendG2Msg=function(xe){return(xe=xe||{}).done=pr({instance:this,className:"NIMFn",funcName:"sendG2Msg",done:xe.done}),this.processCallback(xe),xe.msg=new this.message.G2Message(xe),this.sendMsg(xe)},Ce.beforeSendMsg=function(xe){var nr,ir=this.protocol,dr=xe.msg;switch(dr.to===this.account&&(dr.fromDeviceId=$e.deviceId),dr.userUpdateTime=ir.myInfo&&ir.myInfo.updateTime,dr.getScene()){case"p2p":nr="sendMsg";break;case"team":nr="sendTeamMsg";break;case"superTeam":nr="sendSuperTeamMsg"}c(xe)&&(nr="sendFilterMsg",dr.filter=!0),xe.cmd=nr},Ce.afterSendMsg=function(xe){var nr=xe.rtnMsg;if(!nr||!nr.ignore){var ir=this.protocol.getSessionInCache(nr.sessionId);xe.isLocal&&ir&&ir.lastMsg&&nr.time<ir.lastMsg.time||this.protocol.onUpdateSession(_e.genSessionByMsg(nr))}},Ce.beforeForwardMsg=function(xe){Ue.verifyOptions(xe,"msg scene to","msg::beforeForwardMsg"),xe.msg.scene=xe.scene,xe.msg.to=xe.to},Ce.markMsgRead=function(xe){var nr=this.protocol;!xe||this.db.enable||nr.options.autoMarkRead?this.logger.warn("api::markMsgRead: 不需要标记消息为已收到 (没有消息, 或者启用了数据库, 或者启用了自动标记已收到)"):nr.markMsgRead(xe,!0)},Ce.sendMsgReceipt=function(xe){if((xe=xe||{}).done=pr({instance:this,className:"NIMFn",funcName:"sendMsgReceipt",done:xe.done}),Ue.verifyOptions(xe),this.processCallback(xe),xe.msg){Ue.verifyOptions(xe,"msg","msg::sendMsgReceipt");var nr=xe.msg;Ue.verifyOptions(nr,"target idClient time",!0,"msg.","msg::sendMsgReceipt"),this.protocol.shouldSendMsgReceipt(nr)?this.sendCmd("sendMsgReceipt",{msgReceipt:{to:nr.target,idClient:nr.idClient,time:nr.time}},xe.callback):xe.done()}else xe.done()},Ce.isMsgRemoteRead=function(xe){return pr({instance:this,className:"NIMFn",funcName:"isMsgRemoteRead",hasCallback:!1}),this.protocol.isMsgRemoteRead(xe)},Ce.recallMsg=function(xe){(xe=xe||{}).done=pr({instance:this,className:"NIMFn",funcName:"recallMsg",done:xe.done}),this.deleteMsg(xe,!0)},Ce.deleteMsg=function(xe,nr){var ir;(xe=xe||{}).done=pr({instance:this,className:"NIMFn",funcName:"deleteMsg",done:xe.done}),nr||this.logger.warn("this api will be abandon,please use “recallMsg”"),Ue.verifyOptions(xe,"msg","msg::deleteMsg");var dr=xe.msg;if(dr.scene!=="team"&&dr.from!==this.account||dr.status!=="success"||dr.isLocal)return xe.done(Pt.newParamError("只能删除自己发的, 并且发送成功的消息，且不能是本地消息",{callFunc:"msg::deleteMsg"}),xe);Ue.verifyOptions(dr,["scene","to","from","time","idClient","idServer"],!0,"msg.","msg::deleteMsg"),Ue.verifyParamValid("msg.scene",dr.scene,this.message.validScenes,"msg::deleteMsg"),this.processPs(xe),this.processCallback(xe);var Lt={deletedIdClient:dr.idClient,deletedIdServer:dr.idServer,time:dr.time,from:dr.from,to:dr.to,opeAccount:dr.from},cr=dr.scene==="superTeam"?"deleteSuperTeamMsg":"deleteMsg";Lt.type="deleteMsg"+dr.scene[0].toUpperCase()+u(ir=dr.scene).call(ir,1);var mr=["ps","apnsText","pushPayload","env","opeAccount","attach"];m(mr).call(mr,function(tr){xe[tr]&&(Lt[tr]=xe[tr])}),Lt=new er(Lt),this.sendCmd(cr,{sysMsg:Lt,msg:dr},xe.callback)},Ce.deleteMsgSelf=function(xe){(xe=xe||{}).done=pr({instance:this,className:"NIMFn",funcName:"deleteMsgSelf",done:xe.done}),Ue.verifyOptions(xe,"msg","msg::deleteMsgSelf");var nr=xe.msg;if(nr.scene==="superTeam")return xe.done(Pt.newParamError("单向删除暂不支持超大群场景",{callFunc:"msg::deleteMsgSelf"}),xe);Ue.verifyOptions(nr,["scene","to","from","time","idClient","idServer"],!0,"msg.","msg::deleteMsgSelf"),Ue.verifyParamValid("msg.scene",nr.scene,this.message.validScenes,"msg::deleteMsgSelf"),this.processCallback(xe);var ir={scene:nr.scene==="p2p"?1:2,from:nr.from,to:nr.to,time:nr.time,idClient:nr.idClient,idServer:nr.idServer,custom:xe.custom,type:nr.type};this.sendCmd("deleteMsgSelf",{deleteMsgSelfTag:ir},xe.callback)},Ce.deleteMsgSelfBatch=function(xe){var nr,ir,dr,Lt=this;if((xe=xe||{}).done=pr({instance:this,className:"NIMFn",funcName:"deleteMsgSelfBatch",done:xe.done}),Ue.verifyOptions(xe,"msgs","msg::deleteMsgSelfBatch"),(!y(xe.msgs)||xe.msgs.length===0||xe.msgs.length>100)&&Ue.onParamError("msgs应该是数组且数据长度应大于0小于等于100","msg::deleteMsgSelfBatch"),S(nr=xe.msgs).call(nr,function(mr){return mr.scene==="superTeam"}))return xe.done(Pt.newParamError("消息列表中存在超大群消息，单向删除暂不支持超大群场景",{callFunc:"msg::deleteMsgSelfBatch"}),xe);m(ir=xe.msgs).call(ir,function(mr){Ue.verifyOptions(mr,["scene","to","from","time","idClient","idServer"],!0,"msg.","msg::deleteMsgSelfBatch"),Ue.verifyParamValid("msg.scene",mr.scene,Lt.message.validScenes,"msg::deleteMsgSelfBatch")}),this.processCallback(xe);var cr=O(dr=xe.msgs).call(dr,function(mr){var tr;return{scene:mr.scene==="p2p"?1:2,from:mr.from,to:mr.to,time:mr.time,idClient:mr.idClient,idServer:mr.idServer,sessionId:mr.sessionId||k(tr="".concat(mr.scene,"-")).call(tr,mr.to),custom:xe.custom,type:mr.type}});this.sendCmd("deleteMsgSelfBatch",{deleteMsgSelfTags:cr},xe.callback)};var or={text:0,image:1,audio:2,video:3,geo:4,notification:5,file:6,tip:10,robot:11,custom:100};Ce.getHistoryMsgs=function(xe){(xe=xe||{}).done=pr({instance:this,className:"NIMFn",funcName:"getHistoryMsgs",done:xe.done}),this.protocol.syncing&&this.logger.warn("Please call getHistoryMsgs after onsyncdone callback"),Ue.verifyOptions(xe,"scene to","msg::getHistoryMsgs"),Ue.verifyParamValid("scene",xe.scene,this.message.validScenes,"msg::getHistoryMsgs"),xe.beginTime===void 0&&(xe.beginTime=0);var nr,ir=this.protocol.getSessionInCache(xe.scene+"-"+xe.to),dr=ir&&ir.lastEmptyTime;if(dr>xe.beginTime&&(xe.beginTime=dr),Ue.verifyParamType("beginTime",xe.beginTime,"number","msg::getHistoryMsgs"),xe.endTime===void 0&&(xe.endTime=0),Ue.verifyParamType("endTime",xe.endTime,"number","msg::getHistoryMsgs"),xe.lastMsgId=xe.lastMsgId&&+xe.lastMsgId?xe.lastMsgId:"0",xe.limit===void 0&&(xe.limit=100),Ue.verifyParamType("limit",xe.limit,"number","msg::getHistoryMsgs"),Ue.verifyParamMax("limit",xe.limit,100,"msg::getHistoryMsgs"),Oe(g(xe))?Ue.verifyParamType("reverse",g(xe),"boolean","msg::getHistoryMsgs"):xe.reverse=!1,Oe(xe.asc)?Ue.verifyParamType("asc",xe.asc,"boolean","msg::getHistoryMsgs"):xe.asc=!1,qe(xe.msgTypes))xe.msgTypes=[];else if(y(xe.msgTypes)){var Lt,cr;xe.msgTypes=O(Lt=xe.msgTypes).call(Lt,function(tr){return or[tr]}),xe.msgTypes=c(cr=xe.msgTypes).call(cr,function(tr){return typeof tr=="number"})}else typeof or[xe.msgTypes]=="number"?xe.msgTypes=[or[xe.msgTypes]]:xe.msgTypes=[];switch(this.processCallback(xe),xe.cbaop=function(tr,At){if(!tr){var kt;xe.asc&&(At.msgs=g(kt=At.msgs).call(kt)),At.msgs=ar.deduplication(At.msgs)}},xe.scene){case"p2p":nr="getHistoryMsgs";break;case"team":nr="getTeamHistoryMsgs";break;case"superTeam":nr="getSuperTeamHistoryMsgs"}var mr={scene:xe.scene,to:xe.to,beginTime:xe.beginTime,endTime:xe.endTime,lastMsgId:xe.lastMsgId,limit:xe.limit,reverse:g(xe),msgTypes:xe.msgTypes};this.sendCmd(nr,mr,xe.callback)},Ce.searchHistoryMsgs=function(xe){(xe=xe||{}).done=pr({instance:this,className:"NIMFn",funcName:"searchHistoryMsgs",done:xe.done}),Ue.verifyOptions(xe,"scene to keyword","msg::searchHistoryMsgs"),Ue.verifyParamValid("scene",xe.scene,this.message.validScenes,"msg::searchHistoryMsgs"),xe.beginTime===void 0&&(xe.beginTime=0);var nr,ir=this.protocol.getSessionInCache(xe.scene+"-"+xe.to),dr=ir&&ir.lastEmptyTime;switch(dr>xe.beginTime&&(xe.beginTime=dr),Ue.verifyParamType("beginTime",xe.beginTime,"number","msg::searchHistoryMsgs"),xe.endTime===void 0&&(xe.endTime=0),Ue.verifyParamType("endTime",xe.endTime,"number","msg::searchHistoryMsgs"),xe.limit===void 0&&(xe.limit=100),Ue.verifyParamType("limit",xe.limit,"number","msg::searchHistoryMsgs"),Ue.verifyParamMax("limit",xe.limit,100,"msg::searchHistoryMsgs"),Oe(g(xe))?Ue.verifyParamType("reverse",g(xe),"boolean","msg::searchHistoryMsgs"):xe.reverse=!1,Oe(xe.asc)?Ue.verifyParamType("asc",xe.asc,"boolean","msg::searchHistoryMsgs"):xe.asc=!1,this.processCallback(xe),xe.asc&&(xe.cbaop=function(cr,mr){var tr;cr||(mr.msgs=g(tr=mr.msgs).call(tr))}),xe.scene){case"p2p":nr="searchHistoryMsgs";break;case"team":nr="searchTeamHistoryMsgs"}var Lt=Ue.filterObj(xe,"scene to beginTime endTime keyword limit reverse");this.sendCmd(nr,Lt,xe.callback)},Ce.getLocalMsgs=function(xe){(xe=xe||{}).done=pr({instance:this,className:"NIMFn",funcName:"getLocalMsgs",done:xe.done});var nr=this,ir=nr.db,dr=[];Ue.verifyOptions(xe);var Lt=!1;Oe(xe.start)&&(Lt=!0,Ue.verifyParamType("start",xe.start,"number","msg::getLocalMsgs"));var cr=!1;if(Oe(xe.end)&&(cr=!0,Ue.verifyParamType("end",xe.end,"number","msg::getLocalMsgs")),Lt&&cr&&xe.end<=xe.start&&Ue.onParamError("参数 end 必须晚于 start"),Oe(xe.subTypes)&&Ue.verifyParamType("subTypes",xe.subTypes,"array","msg::getLocalMsgs"),qe(xe.limit)&&(xe.limit=100),Ue.verifyParamType("limit",xe.limit,"number","msg::getLocalMsgs"),Ue.verifyParamMin("limit",xe.limit,1,"msg::getLocalMsgs"),nr.processCallback(xe),ir.enable){var mr=new Date().getTime();ir.getMsgs(xe).then(function(At){var kt;dr=At,nr.logger.info(k(kt="api::getLocalMsgs: query db cost ".concat(new Date().getTime()-mr," ms and the conditions is ")).call(kt,v(xe))),tr()},function(At){(At=At||{}).message=At.message||"msg::getLocalMsgs:db error",tr()})}else tr();function tr(){var At=Ue.simpleClone(xe);At.msgs=dr,delete At.callback,delete At.done,xe.done(null,At)}},Ce.getLocalMsgsInUnread=function(xe){(xe=xe||{}).done=pr({instance:this,className:"NIMFn",funcName:"getLocalMsgsInUnread",done:xe.done});var nr=this;Ue.validate({sessionId:{type:"string",allowEmpty:!1}},xe),this.getLocalSession({sessionId:xe.sessionId,done:function(ir,dr){ir?xe.done&&xe.done(ir):dr?(dr.ack=dr.ack||0,nr.getLocalMsgs(Ve({sessionId:xe.sessionId,start:dr.ack,limit:ue,filterFunc:function(Lt){return Lt.flow==="in"&&Lt.isUnreadable===!0},done:function(){}},xe))):xe.done&&xe.done(new Error("session ".concat(xe.sessionId," not exist")))}})},Ce.getLocalMsgByIdClient=function(xe){(xe=xe||{}).done=pr({instance:this,className:"NIMFn",funcName:"getLocalMsgByIdClient",done:xe.done});var nr=this.db,ir=null,dr=null;function Lt(){xe.msg=dr,xe.done(ir,xe)}Ue.verifyOptions(xe,"idClient","msg::getLocalMsgByIdClient"),this.processCallback(xe),nr.enable?nr.getMsgByIdClient(xe.idClient).then(function(cr){cr&&(dr=cr),Lt()},function(cr){ir=cr,Lt()}):(this.logger.warn("because db is false,error is null"),Lt())},Ce.getLocalMsgsByIdClients=function(xe){(xe=xe||{}).done=pr({instance:this,className:"NIMFn",funcName:"getLocalMsgsByIdClients",done:xe.done});var nr,ir=this.db,dr=[];function Lt(){xe.msgs=dr,xe.done(nr,xe)}Ue.verifyOptions(xe,"idClients","msg::getLocalMsgByIdClients"),Ue.verifyParamType("idClients",xe.idClients,"array","msg::getLocalMsgByIdClients"),this.processCallback(xe),ir.enable?ir.getMsgsByIdClients(xe.idClients).then(function(cr){dr=c(cr).call(cr,function(mr){return!!mr}),Lt()},function(cr){nr=cr,Lt()}):Lt()},Ce.updateLocalMsg=function(xe){(xe=xe||{}).done=pr({instance:this,className:"NIMFn",funcName:"updateLocalMsg",done:xe.done});var nr,ir=this.db,dr=null;if(Ue.verifyOptions(xe,"idClient","msg::updateLocalMsg"),this.processCallback(xe),ir.enable){var Lt=Ue.filterObj(xe,"idClient localCustom");ir.updateMsg(Lt).then(function(mr){dr=mr,cr()},function(mr){nr=mr,cr()})}else cr();function cr(){xe.msg=dr,xe.done(nr,xe)}},Ce.deleteLocalMsg=function(){var xe=a(o.mark(function nr(ir){var dr,Lt,cr,mr;return o.wrap(function(tr){for(;;)switch(tr.prev=tr.next){case 0:return mr=function(){ir.done(Lt,ir)},(ir=ir||{}).done=pr({instance:this,className:"NIMFn",funcName:"deleteLocalMsg",done:ir.done}),dr=this,Ue.verifyOptions(ir,"msg","msg::deleteLocalMsg"),cr=ir.msg,Ue.verifyOptions(cr,"idClient sessionId",!0,"msg.","msg::deleteLocalMsg"),dr.processCallback(ir),tr.prev=8,tr.next=11,dr.protocol.deleteLocalMsg(cr);case 11:mr(),tr.next=18;break;case 14:tr.prev=14,tr.t0=tr.catch(8),Lt=tr.t0,mr();case 18:case"end":return tr.stop()}},nr,this,[[8,14]])}));return function(nr){return xe.apply(this,arguments)}}(),Ce.deleteLocalMsgsBySession=function(xe){(xe=xe||{}).done=pr({instance:this,className:"NIMFn",funcName:"deleteLocalMsgsBySession",done:xe.done});var nr,ir=this,dr=ir.db;Ue.verifyOptions(xe,"scene to","msg::deleteLocalMsgsBySession"),Ue.verifyParamValid("scene",xe.scene,ir.message.validScenes,"msg::deleteLocalMsgsBySession"),xe.sessionId=xe.scene+"-"+xe.to,xe.delLastMsg=xe.delLastMsg===!0,xe.isTag=xe.isTag===!0;var Lt=new Date().getTime();function cr(){xe.done(nr,xe)}ir.processCallback(xe);var mr={id:xe.sessionId};xe.delLastMsg&&(mr.lastMsg=null),xe.isTag&&(mr.lastEmptyTime=Lt),dr.enable?dr.deleteMsgsBySessionId(xe).then(function(){xe.delLastMsg||xe.isTag?dr.updateSession(mr).then(function(tr){ir.protocol.onUpdateSession(tr),xe.session=tr,cr()}):cr()}).catch(function(tr){nr=tr,cr()}):(this.logger.warn("because db is false,error is null"),cr(),(xe.delLastMsg||xe.isTag)&&ir.protocol.onUpdateSession(mr))},Ce.deleteLocalMsgsByTime=function(xe){var nr=this.db;lr.isBrowser&&nr.enable&&(Oe((xe=xe||{}).start)?Ue.verifyParamType("start",xe.start,"number","msg::deleteLocalMsgsByTime"):xe.start=0,Oe(xe.end)?Ue.verifyParamType("end",xe.end,"number","msg::deleteLocalMsgsByTime"):xe.end=1/0,Oe(xe.end)&&Oe(xe.start)&&xe.end<=xe.start&&Ue.onParamError("参数 end 必须大于 start"),this.processCallback(xe),this.protocol.deleteLocalMsgsByTime(xe).then(function(ir){xe.done(null,ir)},function(ir){xe.done(ir,null)}))},Ce.deleteLocalMsgs=function(xe){(xe=xe||{}).done=pr({instance:this,className:"NIMFn",funcName:"deleteLocalMsgs",done:xe.done});var nr;function ir(){xe.done(nr,xe)}xe.updateSession=xe.updateSession!==!1,Ue.verifyOptions(xe,"sessionId","msg::deleteLocalMsgsBySession"),Oe(xe.start)&&Ue.verifyParamType("start",xe.start,"number","msg::deleteLocalMsgs"),Oe(xe.end)&&Ue.verifyParamType("end",xe.end,"number","msg::deleteLocalMsgs"),Oe(xe.end)&&Oe(xe.start)&&xe.end<=xe.start&&Ue.onParamError("参数 end 必须大于 start"),this.processCallback(xe),this.protocol.deleteLocalMsgs(xe).then(function(){ir()},function(dr){nr=dr,ir()})},Ce.deleteAllLocalMsgs=function(xe){(xe=xe||{}).done=pr({instance:this,className:"NIMFn",funcName:"deleteAllLocalMsgs",done:xe.done});var nr,ir=this.db;function dr(){xe.done(nr,xe)}this.processCallback(xe),this.protocol.sessionSet={},ir.enable?ir.deleteAllMsgs().then(function(){dr()},function(Lt){nr=Lt,dr()}):(this.logger.warn("because db is false,error is null"),dr())},Ce.saveMsgsToLocal=function(xe){var nr;(xe=xe||{}).done=pr({instance:this,className:"NIMFn",funcName:"saveMsgsToLocal",done:xe.done}),this.db.enable||(this.logger.warn("because db is false,error is null"),xe.done(null,[])),Ue.verifyOptions(xe,"msgs done","msg::saveMsgsToLocal"),Ue.verifyParamType("msgs",xe.msgs,"Array","msg::saveMsgsToLocal");var ir=O(nr=xe.msgs).call(nr,function(dr){var Lt=Ve({},dr);return Lt.hasOwnProperty("needUpdateSession")||(Lt.needUpdateSession=!0),Lt});this.db.putMsg(ir).then(function(dr,Lt){Lt?xe.done(Lt):xe.done(null,dr)})},Ce.clearServerHistoryMsgs=function(xe){(xe=xe||{}).done=pr({instance:this,className:"NIMFn",funcName:"clearServerHistoryMsgs",done:xe.done}),Ue.verifyOptions(xe,"account","msg::clearServerHistoryMsgs");var nr=xe.delRoam!==!1;this.processCallback(xe),this.sendCmd("clearServerHistoryMsgs",{clearMsgsParams:{account:xe.account,delRoam:nr?1:0}},xe.callback)},Ce.clearServerHistoryMsgsWithSync=function(xe){(xe=xe||{}).done=pr({instance:this,className:"NIMFn",funcName:"clearServerHistoryMsgsWithSync",done:xe.done}),Ue.verifyOptions(xe,"scene to","msg::clearServerHistoryMsgsWithSync");var nr=xe.isDeleteRoam===void 0||xe.isDeleteRoam===!0,ir={type:xe.scene==="team"?2:1,isDeleteRoam:nr?1:0,isSyncSelf:xe.isSyncSelf===!0?1:0};ir[ir.type===2?"toTid":"otherAccid"]=xe.to,xe.ext!==void 0&&(ir.ext=xe.ext),this.processCallback(xe),this.sendCmd("clearServerHistoryMsgsWithSync",{clearMsgsParamsWithSync:ir},xe.callback)},Ce.msgFtsInServer=function(xe){(xe=xe||{}).done=pr({instance:this,className:"NIMFn",funcName:"msgFtsInServer",done:xe.done}),this.processCallback(xe);var nr=xe,ir=i({},(s(nr),nr));Ue.validate({keyword:{type:"string"},fromTime:{type:"number",required:!1},toTime:{type:"number",required:!1},sessionLimit:{type:"number",min:0,required:!1},msgLimit:{type:"number",min:0,required:!1},order:{type:"enum",values:["ASC","DESC"],required:!1},p2pList:{type:"array",required:!1},teamList:{type:"array",required:!1},senderList:{type:"array",required:!1},msgTypeList:{type:"array",required:!1},msgSubTypeList:{type:"array",required:!1}},ir,"msg::msgFtsInServer"),Oe(ir.toTime)&&Oe(ir.fromTime)&&ir.toTime<ir.fromTime&&Ue.onParamError("Options error: toTime should be greater than fromTime");var dr,Lt={ASC:1,DESC:2};ir.order&&Lt[ir.order]&&(ir.order=Lt[ir.order]),ir.msgTypeList&&(ir.msgTypeList=O(dr=ir.msgTypeList).call(dr,function(mr){return or[mr]}));var cr=["p2pList","teamList","senderList","msgTypeList","msgSubTypeList"];m(cr).call(cr,function(mr){y(ir[mr])&&(ir[mr]=ir[mr].join(","))}),this.sendCmd("msgFtsInServer",{msgFullSearchRequestTag:ir},xe.callback)},Ce.msgFtsInServerByTiming=function(xe){(xe=xe||{}).done=pr({instance:this,className:"NIMFn",funcName:"msgFtsInServerByTiming",done:xe.done}),this.processCallback(xe);var nr=xe,ir=(nr.callback,nr.done,r(nr,ie));Ue.validate({keyword:{type:"string"},fromTime:{type:"number",required:!1},toTime:{type:"number",required:!1},msgLimit:{type:"number",min:0,required:!1},order:{type:"enum",values:["ASC","DESC"],required:!1},p2pList:{type:"array",required:!1},teamList:{type:"array",required:!1},senderList:{type:"array",required:!1},msgTypeList:{type:"array",required:!1},msgSubTypeList:{type:"array",required:!1}},ir,"msg::msgFtsInServerByTimeSort"),Oe(ir.toTime)&&Oe(ir.fromTime)&&ir.toTime<ir.fromTime&&Ue.onParamError("Options error: toTime should be greater than fromTime");var dr,Lt={ASC:1,DESC:2};ir.msgLimit===void 0&&(ir.msgLimit=20),ir.order&&Lt[ir.order]&&(ir.order=Lt[ir.order]),ir.msgTypeList&&(ir.msgTypeList=O(dr=ir.msgTypeList).call(dr,function(mr){return or[mr]}));var cr=["p2pList","teamList","senderList","msgTypeList","msgSubTypeList"];m(cr).call(cr,function(mr){y(ir[mr])&&(ir[mr]=ir[mr].join(","))}),this.sendCmd("msgFtsInServerByTiming",{msgTimingFullSearchRequestTag:ir},xe.callback)},Ce.subMessages=function(){var xe=a(o.mark(function nr(ir){var dr,Lt,cr;return o.wrap(function(mr){for(;;)switch(mr.prev=mr.next){case 0:if(dr=this,(ir=ir||{}).done=pr({instance:this,className:"NIMFn",funcName:"subMessages",done:ir.done}),Ue.verifyOptions(ir,"msg","msg::subMessages"),Ue.verifyOptions(ir.msg,"idClient","msg::subMessages"),this.processCallback(ir),!dr.db.enable){mr.next=23;break}return Lt=[],mr.prev=8,mr.next=11,dr.db.getSubMessages(ir.msg.idClient);case 11:Lt=mr.sent,mr.next=20;break;case 14:return mr.prev=14,mr.t0=mr.catch(8),(cr=mr.t0||{}).message=cr.message||"msg::subMessages:db error",ir&&typeof ir.done=="function"&&ir.done(cr),mr.abrupt("return");case 20:ir.done(null,Lt),mr.next=25;break;case 23:dr.logger.warn("subMessages need db"),ir&&typeof ir.done=="function"&&ir.done(Pt.noDBError("subMessages need db"));case 25:case"end":return mr.stop()}},nr,this,[[8,14]])}));return function(nr){return xe.apply(this,arguments)}}(),Ce.subMessagesCount=function(){var xe=a(o.mark(function nr(ir){var dr,Lt,cr;return o.wrap(function(mr){for(;;)switch(mr.prev=mr.next){case 0:if(dr=this,(ir=ir||{}).done=pr({instance:this,className:"NIMFn",funcName:"subMessagesCount",done:ir.done}),Ue.verifyOptions(ir,"msg","msg::subMessagesCount"),Ue.verifyOptions(ir.msg,"idClient","msg::subMessagesCount"),this.processCallback(ir),!dr.db.enable){mr.next=23;break}return Lt=[],mr.prev=8,mr.next=11,dr.db.getSubMessages(ir.msg.idClient);case 11:Lt=mr.sent,mr.next=20;break;case 14:return mr.prev=14,mr.t0=mr.catch(8),(cr=mr.t0||{}).message=cr.message||"msg::subMessages:db error",ir&&typeof ir.done=="function"&&ir.done(cr),mr.abrupt("return");case 20:ir.done(null,Lt.length),mr.next=25;break;case 23:dr.logger.warn("subMessagesCount need db"),ir&&typeof ir.done=="function"&&ir.done(Pt.noDBError("subMessagesCount need db"));case 25:case"end":return mr.stop()}},nr,this,[[8,14]])}));return function(nr){return xe.apply(this,arguments)}}()},function(t,n){t.exports=function(e){if(e==null)throw new TypeError("Cannot destructure "+e)},t.exports.__esModule=!0,t.exports.default=t.exports},function(t,n,e){var r=e(866),s=e(151);function i(){var o;return t.exports=i=r?s(o=r).call(o):function(a){for(var d=1;d<arguments.length;d++){var c=arguments[d];for(var u in c)Object.prototype.hasOwnProperty.call(c,u)&&(a[u]=c[u])}return a},t.exports.__esModule=!0,t.exports.default=t.exports,i.apply(this,arguments)}t.exports=i,t.exports.__esModule=!0,t.exports.default=t.exports},function(t,n,e){t.exports=e(867)},function(t,n,e){t.exports=e(868)},function(t,n,e){var r=e(869);t.exports=r},function(t,n,e){var r=e(305);t.exports=r},function(t,n,e){t.exports=e(871)},function(t,n,e){var r=e(872);t.exports=r},function(t,n,e){e(873),t.exports=9007199254740991},function(t,n,e){e(1)({target:"Number",stat:!0,nonConfigurable:!0,nonWritable:!0},{MAX_SAFE_INTEGER:9007199254740991})},function(t,n,e){var r=e(10),s=e(32),i=e(15),o=e(2),a=e(8),d=e(4),c=e(16),u=e(40).fn,m=e(0),y=e(756),S=e(758),O=(e(76),m.notundef),k=e(25).reportAPI;function g(v,ue,L,re){L=L||"",m.verifyParamType(L+"from",v.from,"string",ue),m.verifyParamType(L+"to",v.to,"string",ue),m.verifyParamType(L+"idServer",v.idServer,"string",ue),m.verifyParamType(L+"time",v.time,"number",ue),m.verifyParamValid(L+"scene",v.scene,this.message.validScenes,ue),re||m.verifyParamType(L+"idClient",v.idClient,"string",ue)}u.getThreadMsgs=function(v){(v=v||{}).done=k({instance:this,className:"NIMFn",funcName:"getThreadMsgs",done:v.done}),m.verifyCallback(v,"done","msg::getThreadMsgs"),m.verifyOptions(v,"scene threadMsgFromAccount threadMsgToAccount threadMsgIdServer threadMsgTime","msg::getThreadMsgs"),m.verifyParamType("threadMsgFromAccount",v.threadMsgFromAccount,"string","msg::getThreadMsgs"),m.verifyParamType("threadMsgToAccount",v.threadMsgToAccount,"string","msg::getThreadMsgs"),m.verifyParamType("threadMsgIdServer",v.threadMsgIdServer,"string","msg::getThreadMsgs"),m.verifyParamType("threadMsgTime",v.threadMsgTime,"number","msg::getThreadMsgs"),m.verifyParamValid("scene",v.scene,this.message.validScenes,"msg::getThreadMsgs"),this.processCallback(v);var ue={scene:this.message.sceneMap[v.scene],from:v.threadMsgFromAccount,to:v.threadMsgToAccount,time:v.threadMsgTime,idServer:v.threadMsgIdServer},L={limit:v.limit<100?v.limit:100,beginTime:typeof v.beginTime=="number"?v.beginTime:0,reverse:r(v)===!0?1:0};typeof v.endTime=="number"&&(L.endTime=v.endTime,L.endTime<=L.beginTime&&m.onParamError("endTime应该大于beginTime","msg::getThreadMsgs")),v.lastMsgId&&(L.lastMsgId=v.lastMsgId),this.sendCmd("getThreadMsgs",{msg:ue,threadMsgReq:L,NOTSTORE:"msg threadMsgReq"},v.callback)},u.getMsgsByIdServer=function(v){var ue,L,re=this;(v=v||{}).done=k({instance:this,className:"NIMFn",funcName:"getMsgsByIdServer",done:v.done});var le=this,oe="msg::getMsgsByIdServer";m.verifyCallback(v,"done",oe),(!s(v.reqMsgs)||v.reqMsgs.length===0||v.reqMsgs.length>100)&&m.onParamError("reqMsgs应该是数组且数据长度应大于0小于等于100",oe),v.reqMsgs=i(ue=v.reqMsgs).call(ue,0),o(L=v.reqMsgs).call(L,function(he,Ie){g.call(le,he,oe,"reqMsgs[".concat(Ie,"]."),!0),he.scene=re.message.sceneMap[he.scene]}),this.processCallback(v),this.sendCmd("getMsgsByIdServer",{reqMsgs:v.reqMsgs},v.callback)},u.addQuickComment=function(v){(v=v||{}).done=k({instance:this,className:"NIMFn",funcName:"addQuickComment",done:v.done}),m.verifyOptions(v,"msg body","msg::addQuickComment"),g.call(this,v.msg,"msg::addQuickComment");var ue=new y(v,"msg::addQuickComment");ue.from=this.account;var L={scene:this.message.sceneMap[v.msg.scene],from:v.msg.from,to:v.msg.to,time:v.msg.time,idServer:v.msg.idServer,idClient:v.msg.idClient};this.processCallback(v),this.sendCmd("addQuickComment",{msg:L,comment:ue},v.callback)},u.deleteQuickComment=function(v){(v=v||{}).done=k({instance:this,className:"NIMFn",funcName:"deleteQuickComment",done:v.done}),m.verifyOptions(v,"msg body","msg::deleteQuickComment"),g.call(this,v.msg,"msg::deleteQuickComment");var ue=new y(v,"msg::addQuickComment");ue.from=this.account;var L={scene:this.message.sceneMap[v.msg.scene],from:v.msg.from,to:v.msg.to,time:v.msg.time,idServer:v.msg.idServer,idClient:v.msg.idClient};this.processCallback(v),this.sendCmd("deleteQuickComment",{msg:L,comment:ue},v.callback)},u.getQuickComments=function(v){var ue=this;(v=v||{}).done=k({instance:this,className:"NIMFn",funcName:"getQuickComments",done:v.done});var L="msg::getQuickComments",re=this,le={},oe={};m.verifyOptions(v,"msgs","msg::getQuickComments"),(!s(v.msgs)||v.msgs.length===0||v.msgs.length>20)&&m.onParamError("msgs应该是数组且数据长度应大于0小于等于20",L);var he=[];try{he=JSON.parse(a(v.msgs))}catch{m.onParamError("msgs 不是合法的对象",L)}o(he).call(he,function(Ie,ie){g.call(re,Ie,L,"msgs[".concat(ie,"]."),!0),Ie.scene=ue.message.sceneMap[Ie.scene],le[Ie.idClient]=null,oe[Ie.idClient]=ie}),this.processCallback(v),this.getLocalMsgsByIdClients({idClients:d(le),done:function(Ie,ie){var Ne,Ve=re.protocol.timetags.sync;!Ie&&ie.msgs&&ie.msgs.length&&Ve&&(o(Ne=ie.msgs).call(Ne,function(Ce){le[Ce.idClient]=Ce}),he=c(he).call(he,function(Ce){var Ue=le[Ce.idClient];return!Ue||(Ue.commentTimetag&&(Ce.timestamp=Ue.commentTimetag),!(Ue.commentTimetag>Ve))})),re.sendCmd("getQuickComments",{commentReq:he,idMap:le,indexMap:oe},v.callback)}})},u.addCollect=function(v){(v=v||{}).done=k({instance:this,className:"NIMFn",funcName:"addCollect",done:v.done}),m.verifyOptions(v,"type data","msg::addCollect");var ue=new S(v,"msg::addCollect");this.processCallback(v),this.sendCmd("addCollect",{collect:ue},v.callback)},u.deleteCollects=function(v){var ue;(v=v||{}).done=k({instance:this,className:"NIMFn",funcName:"deleteCollects",done:v.done}),m.verifyOptions(v,"collectList","msg::deleteCollects"),(!s(v.collectList)||v.collectList.length===0||v.collectList.length>100)&&m.onParamError("collectList应该是数组且数据长度应大于0小于等于100","msg::deleteCollects"),o(ue=v.collectList).call(ue,function(L,re){m.verifyParamType("collectList[".concat(re,"].id"),L.id,"string","msg::deleteCollects"),m.verifyParamType("collectList[".concat(re,"].createTime"),L.createTime,"number","msg::deleteCollects")}),this.processCallback(v),this.sendCmd("deleteCollects",{collectList:v.collectList},v.callback)},u.updateCollect=function(v){(v=v||{}).done=k({instance:this,className:"NIMFn",funcName:"updateCollect",done:v.done}),m.verifyOptions(v,"collect","msg::updateCollect"),m.verifyParamType("collect.id",v.collect.id,"string","msg::updateCollect"),m.verifyParamType("collect.createTime",v.collect.createTime,"number","msg::updateCollect"),this.processCallback(v),this.sendCmd("updateCollect",{collect:v.collect},v.callback)},u.getCollects=function(v){(v=v||{}).done=k({instance:this,className:"NIMFn",funcName:"getCollects",done:v.done}),m.verifyCallback(v,"done","msg::getCollects");var ue={},L=["type","beginTime","endTime","limit"];o(L).call(L,function(re){O(v[re])&&(m.verifyParamType(re,v[re],"number","msg::getCollects"),ue[re]=v[re])}),v.limit>100&&m.onParamError("limit不能大于100","msg::getCollects"),v.beginTime>v.endTime&&m.onParamError("beginTime不能大于endTime","msg::getCollects"),O(v.lastId)&&(m.verifyParamType("lastId",v.lastId,"string","msg::getCollects"),ue.lastMsgId=v.lastId),O(r(v))&&(ue.reverse=r(v)===!0?1:0),this.processCallback(v),this.sendCmd("getCollects",{collectQuery:ue,NOTSTORE:"collectQuery"},v.callback)},u.addStickTopSession=function(v){(v=v||{}).done=k({instance:this,className:"NIMFn",funcName:"addStickTopSession",done:v.done}),m.verifyOptions(v,"id","msg::addStickTopSession");var ue=m.getIdArray(v.id);m.verifyParamValid("id的前半部分",ue[0],this.message.validScenes,"msg::addStickTopSession"),m.verifyParamType("id的后半部分",ue[1],"string","msg::addStickTopSession"),ue[0]==="superTeam"&&(ue[0]="super_team");var L={id:ue=ue.join("|")};v.topCustom&&(m.verifyParamType("topCustom",v.topCustom,"string","msg::addStickTopSession"),L.topCustom=v.topCustom),this.processCallback(v),this.sendCmd("addStickTopSession",{stickTopSession:L},v.callback)},u.deleteStickTopSession=function(v){(v=v||{}).done=k({instance:this,className:"NIMFn",funcName:"deleteStickTopSession",done:v.done}),m.verifyOptions(v,"id","msg::deleteStickTopSession");var ue=m.getIdArray(v.id);m.verifyParamValid("id的前半部分",ue[0],this.message.validScenes,"msg::deleteStickTopSession"),m.verifyParamType("id的后半部分",ue[1],"string","msg::deleteStickTopSession"),ue[0]==="superTeam"&&(ue[0]="super_team"),ue=ue.join("|"),this.processCallback(v),this.sendCmd("deleteStickTopSession",{stickTopSession:{id:ue}},v.callback)},u.updateStickTopSession=function(v){(v=v||{}).done=k({instance:this,className:"NIMFn",funcName:"updateStickTopSession",done:v.done}),m.verifyOptions(v,"id","msg::updateStickTopSession");var ue=m.getIdArray(v.id);m.verifyParamValid("id的前半部分",ue[0],this.message.validScenes,"msg::updateStickTopSession"),m.verifyParamType("id的后半部分",ue[1],"string","msg::updateStickTopSession"),ue[0]==="superTeam"&&(ue[0]="super_team");var L={id:ue=ue.join("|")};v.topCustom&&(m.verifyParamType("topCustom",v.topCustom,"string","msg::updateStickTopSession"),L.topCustom=v.topCustom),this.processCallback(v),this.sendCmd("updateStickTopSession",{stickTopSession:L},v.callback)},u.getStickTopSessions=function(v){(v=v||{}).done=k({instance:this,className:"NIMFn",funcName:"getStickTopSessions",done:v.done}),m.verifyOptions(v,"done","msg::getStickTopSessions"),this.processCallback(v);var ue,L=this.protocol.sessionSet,re=[];for(var le in L)(ue=this.protocol.getSessionInCache(le,v.findDelete))&&ue.isTop&&re.push(L[le]);v.callback(null,re)},u.addMsgPin=function(v){(v=v||{}).done=k({instance:this,className:"NIMFn",funcName:"addMsgPin",done:v.done}),m.verifyOptions(v,"msg","msg::addMsgPin"),g.call(this,v.msg,"msg::addMsgPin");var ue={pinFrom:this.account};O(v.pinCustom)&&(m.verifyParamType("pinCustom",v.pinCustom,"string","msg::addMsgPin"),ue.pinCustom=v.pinCustom);var L={scene:this.message.sceneMap[v.msg.scene],from:v.msg.from,to:v.msg.to,time:v.msg.time,idServer:v.msg.idServer,idClient:v.msg.idClient};this.processCallback(v),this.sendCmd("addMsgPin",{msg:L,pinTag:ue},v.callback)},u.updateMsgPin=function(v){(v=v||{}).done=k({instance:this,className:"NIMFn",funcName:"updateMsgPin",done:v.done}),m.verifyOptions(v,"msg","msg::updateMsgPin"),g.call(this,v.msg,"msg::updateMsgPin");var ue={pinFrom:this.account};O(v.pinCustom)&&(m.verifyParamType("pinCustom",v.pinCustom,"string","msg::updateMsgPin"),ue.pinCustom=v.pinCustom);var L={scene:this.message.sceneMap[v.msg.scene],from:v.msg.from,to:v.msg.to,time:v.msg.time,idServer:v.msg.idServer,idClient:v.msg.idClient};this.processCallback(v),this.sendCmd("updateMsgPin",{msg:L,pinTag:ue},v.callback)},u.deleteMsgPin=function(v){(v=v||{}).done=k({instance:this,className:"NIMFn",funcName:"deleteMsgPin",done:v.done}),m.verifyOptions(v,"msg","msg::deleteMsgPin"),g.call(this,v.msg,"msg::deleteMsgPin");var ue={pinFrom:this.account},L={scene:this.message.sceneMap[v.msg.scene],from:v.msg.from,to:v.msg.to,time:v.msg.time,idServer:v.msg.idServer,idClient:v.msg.idClient};this.processCallback(v),this.sendCmd("deleteMsgPin",{msg:L,pinTag:ue},v.callback)},u.getMsgPins=function(v){var ue=this;(v=v||{}).done=k({instance:this,className:"NIMFn",funcName:"getMsgPins",done:v.done}),m.verifyOptions(v,"id","msg::getMsgPins");var L=this.db,re=m.getIdArray(v.id);m.verifyParamValid("id的前半部分",re[0],this.message.validScenes,"msg::getMsgPins"),m.verifyParamType("id的后半部分",re[1],"string","msg::getMsgPins"),re[0]==="superTeam"&&(re[0]="super_team");var le={sessionId:re=re.join("|"),timetag:0};if(this.processCallback(v),L.enable){var oe=this.protocol.timetags.sync;L.getTimetag("pin-"+v.id).then(function(Ie){Ie>oe?L.getMsgPins(v.id).then(function(ie){return v.callback(null,{pins:ie||[]})}).catch(function(ie){return v.callback(ie)}):(le.timetag=Ie,he.call(ue))})}else he.call(this);function he(){this.sendCmd("getMsgPins",{msgPinReq:le,id:v.id,NOTSTORE:"msgPinReq"},v.callback)}}},function(t,n,e){var r=e(3),s=e(16),i=e(2),o=e(10),a=e(40).fn,d=e(0),c=d.undef,u=d.notundef,m=e(153),y=e(25).reportAPI;a.markSysMsgRead=function(S){(S=S||{}).done=y({instance:this,className:"NIMFn",funcName:"markSysMsgRead",done:S.done});var O,k=this.db,g=r.resolve(),v=this.protocol;d.verifyOptions(S,"sysMsgs","sysmsg::markSysMsgRead");var ue=S.sysMsgs;function L(){S.done(O,S)}d.isArray(ue)||(ue=[ue]),k.enable?g=k.markSysMsgRead(ue).then(function(re){ue=re,v.onUpdateSysMsg(re)}):(ue=s(ue).call(ue,function(re){return!re.read})).length&&(v.options.autoMarkRead||v.markSysMsgRead(ue,!0),i(ue).call(ue,function(re){re.read=!0}),v.onUpdateSysMsg(ue)),g.then(function(){return v.reduceSysMsgUnread(ue)}).then(L,function(re){O=re,L()})},a.sendCustomSysMsg=function(S){(S=S||{}).done=y({instance:this,className:"NIMFn",funcName:"sendCustomSysMsg",done:S.done}),d.verifyOptions(S,"scene to content","sysmsg::sendCustomSysMsg"),d.verifyParamValid("scene",S.scene,this.message.validScenes,"sysmsg::sendCustomSysMsg"),this.processCallback(S);var O="sendCustomSysMsg";return S.scene==="p2p"?S.type="customP2p":S.scene==="superTeam"?(S.type="customSuperTeam",O="sendSuperTeamCustomSysMsg"):S.type="customTeam",S.sysMsg=new m(S),s(S)&&(O="sendFilterCustomSysMsg"),this.sendCmd(O,{sysMsg:S.sysMsg,single:!0},S.callback),this.formatReturnSysMsg(S.sysMsg)},a.formatReturnSysMsg=function(S){return S=d.copy(S),this.protocol.completeSysMsg(S),S.status="sending",S=o(m).call(m,S)},a.getLocalSysMsgs=function(S){(S=S||{}).done=y({instance:this,className:"NIMFn",funcName:"getLocalSysMsgs",done:S.done});var O,k=this.db,g=[];function v(){S.sysMsgs=g,S.done(O,S)}d.verifyOptions(S),S.category&&d.verifyParamValid("category",S.category,m.validCategories,"sysmsg::getLocalSysMsgs"),S.type&&d.verifyParamValid("type",S.type,m.validTypes,"sysmsg::getLocalSysMsgs"),c(S.limit)&&(S.limit=100),d.verifyParamType("limit",S.limit,"number","sysmsg::getLocalSysMsgs"),d.verifyParamMax("limit",S.limit,100,"sysmsg::getLocalSysMsgs"),u(o(S))?d.verifyParamType("reverse",o(S),"boolean","sysmsg::getLocalSysMsgs"):S.reverse=!1,this.processCallback(S),k.enable?k.getSysMsgs(S).then(function(ue){g=ue,v()},function(ue){O=ue,v()}):v()},a.updateLocalSysMsg=function(S){(S=S||{}).done=y({instance:this,className:"NIMFn",funcName:"updateLocalSysMsg",done:S.done});var O,k=this.db,g=null;if(d.verifyOptions(S,"idServer","sysmsg::updateLocalSysMsg"),this.processCallback(S),k.enable){var v=d.filterObj(S,"idServer state localCustom");k.updateSysMsg(v).then(function(L){g=L,ue()},function(L){O=L,ue()})}else ue();function ue(){S.sysMsg=g,S.done(O,S)}},a.deleteLocalSysMsg=function(S){(S=S||{}).done=y({instance:this,className:"NIMFn",funcName:"deleteLocalSysMsg",done:S.done});var O,k=this.db;function g(){S.done(O,S)}d.verifyOptions(S,"idServer","sysmsg::deleteLocalSysMsg"),this.processCallback(S),k.enable?k.deleteSysMsg(S.idServer).then(function(){g()},function(v){O=v,g()}):g()},a.deleteAllLocalSysMsgs=function(S){var O;(S=S||{}).done=y({instance:this,className:"NIMFn",funcName:"deleteAllLocalSysMsgs",done:S.done});var k=this,g=k.db;function v(){k.protocol.onUpdateSysMsgUnread({}),S.done(O,S)}k.processCallback(S),g.enable?g.deleteAllSysMsgs().then(function(){v()},function(ue){O=ue,v()}):v()}},function(t,n,e){var r=e(40).fn,s=e(0),i=e(11),o=e(25).reportAPI;r.getChatroomAddress=function(a){(a=a||{}).done=o({instance:this,className:"NIMFn",funcName:"getChatroomAddress",done:a.done}),s.verifyOptions(a,"chatroomId","chatroom::getChatroomAddress"),a.isWeixinApp=i.isWeixinApp,a.type=i.ipVersion,this.processCallback(a),this.sendCmd("getChatroomAddress",a)}},function(t,n){},function(t,n){},function(t,n,e){var r=e(40).fn,s=e(0),i=e(25).reportAPI;r.audioToText=function(o){(o=o||{}).done=i({instance:this,className:"NIMFn",funcName:"audioToText",done:o.done}),s.verifyOptions(o,"url","audio::audioToText"),o.audioToText=s.filterObj(o,"url"),this.processCallback(o),this.sendCmd("audioToText",o)}},function(t,n,e){var r=e(40).fn;r.clearDB=function(s){var i=this.db;this.processCallback(s);var o=s.done;i.enable?i.clear().then(o,o):o()},r.removeDB=function(s){var i=this.db;this.processCallback(s);var o=s.done;i.enable?i.destroy().then(o,o):o()},r.closeDB=function(s){var i=this.db;this.processCallback(s);var o=s.done;i.enable?i.close().then(o,o):o()}},function(t,n,e){var r=e(40).fn,s=e(310),i=e(0),o=i.undef,a=e(25).reportAPI;r.getPushNotificationMultiportConfig=function(){return a({instance:this,className:"NIMFn",funcName:"getPushNotificationMultiportConfig",hasCallback:!1}),this.protocol.getPushNotificationMultiportConfig()},r.updatePushNotificationMultiportConfig=function(d){(d=d||{}).done=a({instance:this,className:"NIMFn",funcName:"updatePushNotificationMultiportConfig",done:d.done}),i.verifyOptions(d),o(d.shouldPushNotificationWhenPCOnline)&&(d.shouldPushNotificationWhenPCOnline=!0),d.donnop=new s(d),this.processCallback(d),this.sendCmd("updateDonnop",d)}},function(t,n,e){var r=e(2),s=e(3),i=e(6),o=e(22),a=e(40).fn,d=e(0),c=e(883),u=e(884),m=e(25).reportAPI;function y(S){return o(S)==="object"&&(S.msgEventSubscribes?S=S.msgEventSubscribes:S.msgEventSubscribe?S=S.msgEventSubscribe:S.accounts?S=S.accounts:S.msgEvent&&(S=S.msgEvent).time&&(S.time=+S.time),S.sync===1?S.sync=!0:S.sync===0&&(S.sync=!1)),S}a.batchSendEventsCmds=function(S,O,k){var g=this,v=d.dropArrayDuplicates(O.accounts);v=d.reshape2d(v,100);var ue=[];r(v).call(v,function(L){ue.push(new s(function(re,le){var oe=d.simpleClone(O);oe.accounts=L,g.sendCmdWithResp(S,oe,function(he,Ie){he?le(he):re(y(Ie))})}))}),s.all(ue).then(function(L){var re=null;if(L.length>0)if(L[0].msgEventSubscribe){var le=L[0].msgEventSubscribe;le=y(le);var oe=[];r(L).call(L,function(he){oe=i(oe).call(oe,he.accounts)}),re={accounts:oe,msgEventSubscribe:le}}else re=[],r(L).call(L,function(he){re=i(re).call(re,he)});k(null,re)},function(L){k(L,null)})},a.publishEvent=function(S){(S=S||{}).done=m({instance:this,className:"NIMFn",funcName:"publishEvent",done:S.done});var O=new c(S);O=O.assembleEvent(),this.processCallback(S),this.sendCmdWithResp("publishEvent",{msgEvent:O},function(k,g){k||(g=y(g)),S.callback(k,g)})},a.subscribeEvent=function(S){(S=S||{}).done=m({instance:this,className:"NIMFn",funcName:"subscribeEvent",done:S.done}),d.verifyOptions(S,"accounts","event::subscribeEvent");var O=new u(S);d.verifyParamType("accounts",S.accounts,"array","event::subscribeEvent"),this.processCallback(S),O=O.assembleEvent(),this.batchSendEventsCmds("subscribeEvent",{msgEventSubscribe:O,accounts:S.accounts},function(k,g){!k&&g&&(g={failedAccounts:g}),S.callback(k,g)})},a.unSubscribeEventsByAccounts=function(S){(S=S||{}).done=m({instance:this,className:"NIMFn",funcName:"unSubscribeEventsByAccounts",done:S.done}),d.verifyOptions(S,"accounts","event::unSubscribeEventsByAccounts"),d.verifyParamType("accounts",S.accounts,"array","event::unSubscribeEventsByAccounts");var O=new u(S);O=O.assembleEvent(),this.processCallback(S),this.batchSendEventsCmds("unSubscribeEventsByAccounts",{msgEventSubscribe:O,accounts:S.accounts},function(k,g){!k&&g&&(g={failedAccounts:g}),S.callback(k,g)})},a.unSubscribeEventsByType=function(S){(S=S||{}).done=m({instance:this,className:"NIMFn",funcName:"unSubscribeEventsByType",done:S.done});var O=new u(S);O=O.assembleEvent(),this.processCallback(S),this.sendCmdWithResp("unSubscribeEventsByType",{msgEventSubscribe:O},function(k,g){S.callback(k,g)})},a.querySubscribeEventsByAccounts=function(S){(S=S||{}).done=m({instance:this,className:"NIMFn",funcName:"querySubscribeEventsByAccounts",done:S.done}),d.verifyOptions(S,"accounts","event::querySubscribeEventsByAccounts"),d.verifyParamType("accounts",S.accounts,"array","event::querySubscribeEventsByAccounts");var O=new u(S);O=O.assembleEvent(),this.processCallback(S),this.batchSendEventsCmds("querySubscribeEventsByAccounts",{msgEventSubscribe:O,accounts:S.accounts},function(k,g){!k&&g&&(g={msgEventSubscribes:g}),S.callback(k,g)})},a.querySubscribeEventsByType=function(S){(S=S||{}).done=m({instance:this,className:"NIMFn",funcName:"querySubscribeEventsByType",done:S.done});var O=new u(S);O=O.assembleEvent(),this.processCallback(S),this.sendCmdWithResp("querySubscribeEventsByType",{msgEventSubscribe:O},function(k,g){k||(g={msgEventSubscribes:y(g)}),S.callback(k,g)})}},function(t,n,e){var r=e(7),s=e(0),i=s.notundef,o=e(41);function a(d){if(s.verifyOptions(d,"type value","event::MsgEvent"),s.verifyParamType("type",d.type,"number","event::MsgEvent"),s.verifyParamType("value",d.value,"number","event::MsgEvent"),this.type=d.type,this.value=d.value,this.idClient=s.guid(),i(d.custom)&&(this.custom=""+d.custom),this.validTime=d.validTime||604800,s.verifyParamType("validTime",this.validTime,"number","event::MsgEvent"),s.verifyParamMin("validTime",this.validTime,60,"event::MsgEvent"),s.verifyParamMax("validTime",this.validTime,604800,"event::MsgEvent"),i(d.broadcastType)){var c;if(s.verifyParamType("broadcastType",d.broadcastType,"number","event::MsgEvent"),r(c=[1,2]).call(c,d.broadcastType)<0)throw new o('参数错误"broadcastType":只能为1或2');this.broadcastType=d.broadcastType}else this.broadcastType=2;i(d.sync)?(s.verifyParamType("sync",d.sync,"boolean","event::MsgEvent"),this.sync=d.sync):this.sync=!1}a.prototype.assembleEvent=function(){return{type:this.type,value:this.value,idClient:this.idClient,custom:this.custom||"",validTime:this.validTime,broadcastType:this.broadcastType,sync:this.sync===!0?1:0}},t.exports=a},function(t,n,e){var r=e(0),s=r.notundef;function i(o){r.verifyOptions(o,"type","event::MsgEventSubscribe"),r.verifyParamType("type",o.type,"number","event::MsgEventSubscribe"),r.findObjIndexInArray([1,2,3],o.type)<0&&r.verifyParamMin("type",o.type,1e5,"event::MsgEventSubscribe"),this.type=o.type,s(o.subscribeTime)?(r.verifyParamType("subscribeTime",o.subscribeTime,"number","event::MsgEventSubscribe"),r.verifyParamMin("subscribeTime",o.subscribeTime,60,"event::MsgEventSubscribe"),r.verifyParamMax("subscribeTime",o.subscribeTime,2592e3,"event::MsgEventSubscribe"),this.subscribeTime=o.subscribeTime):this.subscribeTime=2592e3,s(o.sync)?(r.verifyParamType("sync",o.sync,"boolean","event::MsgEventSubscribe"),this.sync=o.sync):this.sync=!0}i.prototype.assembleEvent=function(){return{type:this.type,subscribeTime:this.subscribeTime,sync:this.sync===!0?1:0}},t.exports=i},function(t,n,e){var r=e(37),s=e(40).fn,i=e(0),o=e(25).reportAPI;s.httpRequestProxy=function(a){(a=a||{}).done=o({instance:this,className:"NIMFn",funcName:"httpRequestProxy",done:a.done}),i.verifyOptions(a,"path","misc::httpRequestProxy");var d=r({},a);delete d.done,this.processCallback(a),this.sendCmd("httpProxy",{proxyTag:d},a.callback)}},function(t,n,e){var r=e(40).fn,s=e(11),i=e(25).reportAPI;r.getQChatAddress=function(o){(o=o||{}).done=i({instance:this,className:"NIMFn",funcName:"getQChatAddress",done:o.done}),this.processCallback(o),this.sendCmd("getQChatAddress",{getQChatAddressTag:{ipType:s.ipVersion}},o.done)}},function(t,n,e){e(299);var r=e(197);e(311)(r),t.exports=r},function(t,n,e){var r=e(314),s=e(15),i=e(3),o=e(60),a=e(6),d=e(24),c=e(198).fn,u=e(11),m=e(157).V2NIMConnectStatus;c.connect=function(){u.isBrowser&&this.reporter.restore(),r(c).connect.call(this)},c.refreshSocketUrl=function(){var y;return this.socketUrlsBackup=this.socketUrlsBackup||[],this.socketUrls=s(y=this.socketUrlsBackup).call(y,0),this.logger.info("link::refreshSocketUrl"),this.statusProtector.emit("auth/loginLifeCycleAddressing"),i.resolve(this.socketUrls)},c.onHandshakeFailed=function(y,S){var O;this.reporter.report("chatroomLogin",{accid:this.account,roomId:this.options&&this.options.chatroomId,serverIps:this.options&&this.options.chatroomAddresses&&this.options.chatroomAddresses.join(","),currentServerIp:S,rt:o()-y,result:408,failReason:"ws_handshake_failed",time:o(),net_connect:this.checkNetworkAvailable()}),this.logger.warn(a(O="link::onHandshakeFailed: shandshake failed, startTime: ".concat(y,", targetUrl: ")).call(O,S))},c.onConnectFailed=function(y,S,O){var k,g,v=typeof y=="string"?"connect_failed:".concat(y):"connect_failed";this.reporter.report("chatroomLogin",{accid:this.account,roomId:this.options&&this.options.chatroomId,serverIps:this.options&&this.options.chatroomAddresses&&this.options.chatroomAddresses.join(","),currentServerIp:O,rt:o()-S,result:408,failReason:"ws_".concat(v),time:o(),net_connect:this.checkNetworkAvailable()}),this.logger.warn(a(k=a(g="link::onConnectFailed: connect failed due to ".concat(y,", startTime: ")).call(g,S,", targetUrl: ")).call(k,O))},c.onSocketError=function(y,S,O){var k,g,v=typeof y=="string"?"socket.io error:".concat(y):"socket.io error";this.reporter.report("chatroomLogin",{accid:this.account,roomId:this.options&&this.options.chatroomId,serverIps:this.options&&this.options.chatroomAddresses&&this.options.chatroomAddresses.join(","),currentServerIp:O,rt:o()-S,result:408,failReason:"ws_".concat(v),time:o(),net_connect:this.checkNetworkAvailable()}),this.logger.warn(a(k=a(g="link::onSocketError: due to ".concat(y,", startTime: ")).call(g,S,", targetUrl: ")).call(k,O))},c.notifyDisconnect=function(y){r(c).notifyDisconnect.call(this,y)},c.disconnect=function(){var y=this,S=arguments.length>0&&arguments[0]!==void 0?arguments[0]:function(){};if(this.isConnected())return this.sendCmd("logout"),void d(function(){r(c).disconnect.call(y,S)},0);this.connecting?this.logger.warn("ChatroomProtocolFn api disconnect:: connecting but exiting"):this.statusProtector.getConnectStatus()!==m.V2NIM_CONNECT_STATUS_DISCONNECTED?this.logger.warn("ChatroomProtocolFn api disconnect:: has tried to disconnect actively"):this.logger.warn("ChatroomProtocolFn api disconnect:: other logic entered");var O=r(c);O.disconnect.call(this,S)}},function(t,n,e){var r=e(57),s=e(51),i=e(58),o=e(8),a=e(60),d=e(3),c=e(26),u=e(4),m=e(52),y=e(16),S=e(53),O=e(2),k=e(54),g=e(55),v=e(43);function ue(Ie,ie){var Ne=u(Ie);if(m){var Ve=m(Ie);ie&&(Ve=y(Ve).call(Ve,function(Ce){return S(Ie,Ce).enumerable})),Ne.push.apply(Ne,Ve)}return Ne}function L(Ie){for(var ie=1;ie<arguments.length;ie++){var Ne,Ve,Ce=arguments[ie]!=null?arguments[ie]:{};ie%2?O(Ne=ue(Object(Ce),!0)).call(Ne,function(Ue){s(Ie,Ue,Ce[Ue])}):k?g(Ie,k(Ce)):O(Ve=ue(Object(Ce))).call(Ve,function(Ue){v(Ie,Ue,S(Ce,Ue))})}return Ie}var re=e(198).fn,le=e(45),oe=e(0);function he(Ie){var ie=this;if(Ie.code===398)return this.logger.warn("pendingLoginFailed:398 try to reconnect socket link，backoff set min 5s"),ie.forceDisconnect(),ie.backoff.setMin(5e3),void(ie.retryCount===0?ie.refreshSocketUrl():d.resolve()).then(function(){var Ne;ie.reconnect({allFailedCB:c(Ne=function(Ve){this.logger.error("pendingLoginFailed: ",Ve.code,Ve),this.onAuthError(Ve,"link::onLoginReconnectFailed")}).call(Ne,ie,Ie)})});this.logger.error("pendingLoginFailed: ",Ie.code,Ie),ie.onAuthError(Ie,"link::onLogin")}re.assembleLogin=function(){var Ie=this.options;this.sdkSession=this.genSessionKey();var ie={appKey:Ie.appKey,account:Ie.account,deviceId:le.deviceId,chatroomId:Ie.chatroomId,session:this.sdkSession,appLogin:this.autoconnect?1:0},Ne=!0;if(Ie.loc_x===void 0||Ie.loc_y===void 0||Ie.loc_z===void 0?Ne=!1:(typeof Ie.loc_x!="number"&&(Ie.loc_x=0),typeof Ie.loc_y!="number"&&(Ie.loc_y=0),typeof Ie.loc_z!="number"&&(Ie.loc_z=0)),Ie.authType=Ie.loginAuthType,ie=oe.merge(ie,oe.filterObj(Ie,Ne?"chatroomNick chatroomAvatar chatroomCustom chatroomEnterCustom isAnonymous notifyTargetTags loginAuthType loginExt loc_x loc_y loc_z distance antiSpamBusinessId":"chatroomNick chatroomAvatar chatroomCustom chatroomEnterCustom isAnonymous notifyTargetTags loginAuthType loginExt distance antiSpamBusinessId")),Ie.tags&&Ie.tags.length>0)try{ie.tags=o(Ie.tags)}catch(Ve){this.logger.error("assembleLogin::format tags error",Ie.tags,Ve)}return{type:1,login:ie,imLogin:this.assembleIMLogin()}},re.login=i(r.mark(function Ie(){var ie,Ne,Ve,Ce=this;return r.wrap(function(Ue){for(;;)switch(Ue.prev=Ue.next){case 0:return ie=this,Ue.next=3,ie.assembleLogin();case 3:if(Ne=Ue.sent,!(Ve=this.socket&&this.socket.socket&&this.socket.socket.sessionid)){Ue.next=13;break}if(this.socketIds||(this.socketIds={}),!this.socketIds[Ve]){Ue.next=10;break}return this.logger.warn("onConnect::repeat login",Ve),Ue.abrupt("return");case 10:this.socketIds[Ve]=!0,Ue.next=14;break;case 13:this.logger.warn("onConnect:: no socketId ",this.socket&&this.socket.socket);case 14:this.logger.warn("link::doLogin: "+Ve+" appLogin is "+Ne.login.appLogin),ie.createLoginTime=a(),ie.sendCmd("login",L({},Ne),function(qe,Oe){if(qe)ie.reporter.report("chatroomLogin",{accid:ie.account,roomId:ie.options&&ie.options.chatroomId,serverIps:ie.options&&ie.options.chatroomAddresses&&ie.options.chatroomAddresses.join(","),currentServerIp:ie.url,rt:a()-ie.createLoginTime,result:qe?qe.code:408,failReason:qe?qe.message:"",time:a(),net_connect:ie.checkNetworkAvailable()}),he.call(ie,qe),ie.statusProtector.emit("auth/loginLifeCycleLoginFail",qe);else if(ie.reporter.report("chatroomLogin",{accid:ie.account,roomId:ie.options&&ie.options.chatroomId,serverIps:ie.options&&ie.options.chatroomAddresses&&ie.options.chatroomAddresses.join(","),currentServerIp:ie.url,rt:a()-ie.createLoginTime,result:200,failReason:"",time:a(),net_connect:ie.checkNetworkAvailable()}),ie.resetReconnectStatus(),Ce.heartbeatFail=0,Ce.hasLogin=!0,Ce.autoconnect=!0,ie.startHeartbeat(),ie.initOnlineListener(),ie.statusProtector.emit("auth/loginLifeCycleLoginSucc"),ie.keepNosSafeUrl)ie.afterLogin(Oe);else{var $e=[];ie.parser.checkObjSafeUrl(Oe,$e,[]),d.all($e).then(function(){ie.afterLogin(Oe)}).catch(function(){ie.afterLogin(Oe)})}});case 17:case"end":return Ue.stop()}},Ie,this)})),re.afterLogin=function(Ie){var ie=Ie.chatroom;this.sendCmd("getNosCdnHost",{}),this.chatroom=ie,this.notifyLogin(Ie)},re.kickedReasons=["","chatroomClosed","managerKick","samePlatformKick","silentlyKick","blacked"],re.kickedMessages=["","聊天室关闭了","被房主或者管理员踢出","不允许同一个帐号在多个地方同时登录","悄悄被踢","被拉黑了"]},function(t,n,e){var r=e(10),s=e(24),i=e(71),o=e(2),a=e(48),d=e(37),c=e(15),u=e(32),m=e(126),y=e(4),S=e(198).fn,O=e(0),k=e(11),g=e(891),v=e(768),ue=e(896),L=e(897),re=e(898);S.completeMsg=function(le){le.chatroomId=this.chatroom&&this.chatroom.id,le.from=this.options.account,le.fromClientType="Web",le.time||(le.time=+new Date)},S.amendMsg=function(le){return le},S.onMsg=function(le){var oe,he=r(oe=this.message).call(oe,le.content.msg);if(this.checkMsgUnique(he)){if(he.__handleTime=this.reporterHook.getSafeClock(),he.__receiveTime=le.__receiveTime,O.get(le,"content.msg.__clientExt"))try{he.__clientExt=JSON.parse(le.content.msg.__clientExt)}catch{this.logger.warn("ChatroomProtocolFn:onMsg __clientExt parse failed ".concat(le.content.msg.__clientExt))}this.msgBuffer.push(he),this.msgFlushTimer||this.startMsgFlushTimer(),le&&le.content&&le.content.msg&&le.content.msg.needHighPriorityMsgAck==="1"&&this.sendCmd("sendChatroomMsgAck",{chatRoomMsgAckTag:{idClient:he.idClient,chatroomId:he.chatroomId}})}else this.logger.warn("onMsg::msg::repeat",he.idClient)},S.startMsgFlushTimer=function(){var le=this,oe=le.options;le.msgFlushTimer=s(function(){var he,Ie=i(he=le.msgBuffer).call(he,0,oe.msgBufferSize);if(k.isBrowser){var ie=le.reporterHook.getSafeClock();o(Ie).call(Ie,function(Ne){if(Ne.flow!=="out"){var Ve={msgId:Ne.idServer,clientId:Ne.idClient,receiveTime:le.reporterHook.getNTPTime(Ne.__receiveTime),serverTime:Ne.time,callbackTime:le.reporterHook.getNTPTime(ie),preHandleTime:le.reporterHook.getNTPTime(Ne.__handleTime),fromAccid:Ne.from,toAccid:le.options.account,type:4,tid:"",roomId:Ne.chatroomId,result:200,failReason:"",rt:a(ie-Ne.__receiveTime)},Ce=O.get(Ne,"__clientExt.statistics.apiCallingTime"),Ue=O.get(Ne,"__clientExt.statistics.sendTime");Ce&&Ue&&(Ve.apiCallingTime=Ce,Ve.sendTime=Ue,Ve.attachUploadDuration=O.get(Ne,"__clientExt.statistics.attachUploadDuration")||0),le.reporter&&le.reporter.report("msgReceive",Ve)}delete Ne.__handleTime,delete Ne.__receiveTime,delete Ne.__clientExt})}le.options.onmsgs(Ie),le.msgBuffer.length?le.startMsgFlushTimer():delete le.msgFlushTimer},oe.msgBufferInterval)},S.checkMsgUnique=O.genCheckUniqueFunc("idClient"),S.onSendMsg=function(le){var oe,he=le.obj.msg;le.error?he.status="fail":(he=le.content.msg).status="success",d(he,le.obj.msg),he=r(oe=this.message).call(oe,he),this.checkMsgUnique(he),le.obj=he},S.onHistoryMsgs=function(le){le.error||(le.obj||(le.obj={}),le.obj.msgs=this.message.reverseMsgs(le.content.msgs))},S.onCdnMsgInfo=function(le){if(le){le.cdnUrls&&(le.cdnUrls=le.cdnUrls.split("|")),le.interval&&(le.interval=1e3*a(le.interval)),le.timeout&&(le.timeout=+le.timeout),le.enable&&(le.enable=+le.enable),le.timestamp&&(le.timestamp=+le.timestamp,this.correctCdnTime(le.timestamp));var oe=!this.cdnInfo.enable&&le.enable;d(this.cdnInfo,le),oe&&this.queryCdnMsgs()}},S.correctCdnTime=function(le){le&&typeof le=="number"&&(this.cdnInfo||(this.cdnInfo={}),this.cdnInfo.timestamp=le,this.cdnInfo.localTime=+new Date,this.cdnInfo.lastNow=null,this.logger.info("correctCdnTime: timestamp, localTime",le,this.cdnInfo.localTime,new Date(le),new Date(this.cdnInfo.localTime)))},S.queryCdnMsgs=function(le){var oe,he=this;if(this.cdnInfo&&this.cdnInfo.enable&&this.isConnected()){this.queryCdnTimer=s(function(){return he.queryCdnMsgs()},this.cdnInfo.interval);var Ie=+new Date;if(Ie=Ie-this.cdnInfo.localTime+this.cdnInfo.timestamp,Ie-=Ie%this.cdnInfo.interval,this.cdnInfo.lastNow!==Ie&&this.cdnInfo.cdnUrls&&this.cdnInfo.cdnUrls.length){this.cdnInfo.cdnUrls.push(this.cdnInfo.cdnUrls.shift());var ie=this,Ne=this.cdnInfo.decryptKey,Ve=this.cdnInfo.timeout||Math.ceil(this.cdnInfo.interval/2),Ce=c(oe=this.cdnInfo.cdnUrls).call(oe,0);le=le||0,function Ue(){if(le>=3)return void ie.finalFail++;if(Ce.length){var qe=Ce.shift().replace("#time",Ie),Oe=qe.split("/")[2],$e=+new Date;ie.adaptersRequest(qe,{timeout:Ve,onload:function(_e){if(ie.cdnInfo.lastNow>Ie)ie.logger.warn("queryCdnMsgs::doQuery cdnInfo.lastNow > now, will throw data ",ie.cdnInfo.lastNow,Ie,_e);else{ie.cdnInfo.lastNow=Ie,ie.afterQueryCdn(Oe,+new Date-$e,!0);try{_e=JSON.parse(_e)}catch(pr){ie.logger.warn("queryCdnMsgs::doQuery::onload parse res error: ",pr)}if(_e&&_e.data){_e.ptm&&(ie.cdnInfo.timeout=_e.ptm),_e.pis&&(ie.cdnInfo.interval=1e3*_e.pis);var er,Pt,ar=_e.e===!0?(er=_e.data,Pt=Ne,g.decrypt(er,v.parse(Pt),{mode:ue,padding:L}).toString(re)):_e.data;ie.onCdnMsgsSmoothly(ar,Ie,1e3*_e.c)}}},onerror:function(_e){if(le++,ie.afterQueryCdn(Oe,+new Date-$e,!1),_e.status===404){var er;try{var Pt=JSON.parse(_e.result);Pt.code===404&&Pt.timestamp&&(er=Pt.timestamp)}catch(ar){ie.logger.warn("queryCdnMsgs::doQuery::parse 404 result error",ar,_e)}!er&&_e.date&&(er=+new Date(_e.date)),er&&(ie.correctCdnTime(er),clearTimeout(ie.queryCdnTimer),ie.queryCdnMsgs(le))}else Ue()}},{exception_service:8})}}()}}},S.onCdnMsgsSmoothly=function(le,oe,he){try{le=JSON.parse(le)}catch(Ce){this.logger.warn("onCdnMsgsSmoothly::JSON.parse error",Ce)}if(this.logger.info("receive cdn msgs "+le.length+" and request time is "+new Date(oe)),u(le)&&le.length){var Ie=this,ie=this.options.msgBufferInterval,Ne=Math.ceil(le.length*ie/he);Ve(),clearInterval(Ie.cdnSmoothTimer),Ie.cdnSmoothTimer=m(function(){return Ve()},ie)}function Ve(){if(Ie.isConnected()){var Ce=i(le).call(le,0,Ne);o(Ce).call(Ce,function(Ue){var qe=Ie.parser.syncUnserialize(Ue,"msg");Ie.onMsg({content:{msg:qe}})}),le.length||clearInterval(Ie.cdnSmoothTimer)}}},S.resetCdnData=function(){this.cdnData={},this.finalFail=0,this.cdnDataTime=+new Date},S.initCdnData=function(){this.resetCdnData(),O.isFunction(this.options.onCdnRequestData)?(this.options.cdnRequestDataInterval=this.options.cdnRequestDataInterval||3e4,this.afterQueryCdn=function(le,oe,he){var Ie,ie=this;this.cdnData[le]||(this.cdnData[le]={success:0,fail:0,sr:0,fr:0,smr:0,fmr:0}),he?(this.cdnData[le].success++,this.cdnData[le].sr+=oe,oe>this.cdnData[le].smr&&(this.cdnData[le].smr=oe)):(this.cdnData[le].fail++,this.cdnData[le].fr+=oe,oe>this.cdnData[le].fmr&&(this.cdnData[le].fmr=oe)),+new Date-this.cdnDataTime<this.options.cdnRequestDataInterval||(o(Ie=y(this.cdnData)).call(Ie,function(Ne){ie.cdnData[Ne].sr=ie.cdnData[Ne].sr/ie.cdnData[Ne].success||0,ie.cdnData[Ne].fr=ie.cdnData[Ne].fr/ie.cdnData[Ne].fail||0}),this.options.onCdnRequestData(d({},this.cdnData),this.finalFail),this.resetCdnData())}):this.afterQueryCdn=function(){}}},function(t,n,e){var r;t.exports=(r=e(94),e(768),e(893),e(769),e(313),function(){var s=r,i=s.lib.BlockCipher,o=s.algo,a=[],d=[],c=[],u=[],m=[],y=[],S=[],O=[],k=[],g=[];(function(){for(var L=[],re=0;re<256;re++)L[re]=re<128?re<<1:re<<1^283;var le=0,oe=0;for(re=0;re<256;re++){var he=oe^oe<<1^oe<<2^oe<<3^oe<<4;he=he>>>8^255&he^99,a[le]=he,d[he]=le;var Ie=L[le],ie=L[Ie],Ne=L[ie],Ve=257*L[he]^16843008*he;c[le]=Ve<<24|Ve>>>8,u[le]=Ve<<16|Ve>>>16,m[le]=Ve<<8|Ve>>>24,y[le]=Ve,Ve=16843009*Ne^65537*ie^257*Ie^16843008*le,S[he]=Ve<<24|Ve>>>8,O[he]=Ve<<16|Ve>>>16,k[he]=Ve<<8|Ve>>>24,g[he]=Ve,le?(le=Ie^L[L[L[Ne^Ie]]],oe^=L[L[oe]]):le=oe=1}})();var v=[0,1,2,4,8,16,32,64,128,27,54],ue=o.AES=i.extend({_doReset:function(){if(!this._nRounds||this._keyPriorReset!==this._key){for(var L=this._keyPriorReset=this._key,re=L.words,le=L.sigBytes/4,oe=4*((this._nRounds=le+6)+1),he=this._keySchedule=[],Ie=0;Ie<oe;Ie++)Ie<le?he[Ie]=re[Ie]:(Ve=he[Ie-1],Ie%le?le>6&&Ie%le==4&&(Ve=a[Ve>>>24]<<24|a[Ve>>>16&255]<<16|a[Ve>>>8&255]<<8|a[255&Ve]):(Ve=a[(Ve=Ve<<8|Ve>>>24)>>>24]<<24|a[Ve>>>16&255]<<16|a[Ve>>>8&255]<<8|a[255&Ve],Ve^=v[Ie/le|0]<<24),he[Ie]=he[Ie-le]^Ve);for(var ie=this._invKeySchedule=[],Ne=0;Ne<oe;Ne++){if(Ie=oe-Ne,Ne%4)var Ve=he[Ie];else Ve=he[Ie-4];ie[Ne]=Ne<4||Ie<=4?Ve:S[a[Ve>>>24]]^O[a[Ve>>>16&255]]^k[a[Ve>>>8&255]]^g[a[255&Ve]]}}},encryptBlock:function(L,re){this._doCryptBlock(L,re,this._keySchedule,c,u,m,y,a)},decryptBlock:function(L,re){var le=L[re+1];L[re+1]=L[re+3],L[re+3]=le,this._doCryptBlock(L,re,this._invKeySchedule,S,O,k,g,d),le=L[re+1],L[re+1]=L[re+3],L[re+3]=le},_doCryptBlock:function(L,re,le,oe,he,Ie,ie,Ne){for(var Ve=this._nRounds,Ce=L[re]^le[0],Ue=L[re+1]^le[1],qe=L[re+2]^le[2],Oe=L[re+3]^le[3],$e=4,_e=1;_e<Ve;_e++){var er=oe[Ce>>>24]^he[Ue>>>16&255]^Ie[qe>>>8&255]^ie[255&Oe]^le[$e++],Pt=oe[Ue>>>24]^he[qe>>>16&255]^Ie[Oe>>>8&255]^ie[255&Ce]^le[$e++],ar=oe[qe>>>24]^he[Oe>>>16&255]^Ie[Ce>>>8&255]^ie[255&Ue]^le[$e++],pr=oe[Oe>>>24]^he[Ce>>>16&255]^Ie[Ue>>>8&255]^ie[255&qe]^le[$e++];Ce=er,Ue=Pt,qe=ar,Oe=pr}er=(Ne[Ce>>>24]<<24|Ne[Ue>>>16&255]<<16|Ne[qe>>>8&255]<<8|Ne[255&Oe])^le[$e++],Pt=(Ne[Ue>>>24]<<24|Ne[qe>>>16&255]<<16|Ne[Oe>>>8&255]<<8|Ne[255&Ce])^le[$e++],ar=(Ne[qe>>>24]<<24|Ne[Oe>>>16&255]<<16|Ne[Ce>>>8&255]<<8|Ne[255&Ue])^le[$e++],pr=(Ne[Oe>>>24]<<24|Ne[Ce>>>16&255]<<16|Ne[Ue>>>8&255]<<8|Ne[255&qe])^le[$e++],L[re]=er,L[re+1]=Pt,L[re+2]=ar,L[re+3]=pr},keySize:8});s.AES=i._createHelper(ue)}(),r.AES)},function(t,n){},function(t,n,e){var r;t.exports=(r=e(94),function(s){var i=r,o=i.lib,a=o.WordArray,d=o.Hasher,c=i.algo,u=[];(function(){for(var g=0;g<64;g++)u[g]=4294967296*s.abs(s.sin(g+1))|0})();var m=c.MD5=d.extend({_doReset:function(){this._hash=new a.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(g,v){for(var ue=0;ue<16;ue++){var L=v+ue,re=g[L];g[L]=16711935&(re<<8|re>>>24)|4278255360&(re<<24|re>>>8)}var le=this._hash.words,oe=g[v+0],he=g[v+1],Ie=g[v+2],ie=g[v+3],Ne=g[v+4],Ve=g[v+5],Ce=g[v+6],Ue=g[v+7],qe=g[v+8],Oe=g[v+9],$e=g[v+10],_e=g[v+11],er=g[v+12],Pt=g[v+13],ar=g[v+14],pr=g[v+15],lr=le[0],or=le[1],xe=le[2],nr=le[3];lr=y(lr,or,xe,nr,oe,7,u[0]),nr=y(nr,lr,or,xe,he,12,u[1]),xe=y(xe,nr,lr,or,Ie,17,u[2]),or=y(or,xe,nr,lr,ie,22,u[3]),lr=y(lr,or,xe,nr,Ne,7,u[4]),nr=y(nr,lr,or,xe,Ve,12,u[5]),xe=y(xe,nr,lr,or,Ce,17,u[6]),or=y(or,xe,nr,lr,Ue,22,u[7]),lr=y(lr,or,xe,nr,qe,7,u[8]),nr=y(nr,lr,or,xe,Oe,12,u[9]),xe=y(xe,nr,lr,or,$e,17,u[10]),or=y(or,xe,nr,lr,_e,22,u[11]),lr=y(lr,or,xe,nr,er,7,u[12]),nr=y(nr,lr,or,xe,Pt,12,u[13]),xe=y(xe,nr,lr,or,ar,17,u[14]),lr=S(lr,or=y(or,xe,nr,lr,pr,22,u[15]),xe,nr,he,5,u[16]),nr=S(nr,lr,or,xe,Ce,9,u[17]),xe=S(xe,nr,lr,or,_e,14,u[18]),or=S(or,xe,nr,lr,oe,20,u[19]),lr=S(lr,or,xe,nr,Ve,5,u[20]),nr=S(nr,lr,or,xe,$e,9,u[21]),xe=S(xe,nr,lr,or,pr,14,u[22]),or=S(or,xe,nr,lr,Ne,20,u[23]),lr=S(lr,or,xe,nr,Oe,5,u[24]),nr=S(nr,lr,or,xe,ar,9,u[25]),xe=S(xe,nr,lr,or,ie,14,u[26]),or=S(or,xe,nr,lr,qe,20,u[27]),lr=S(lr,or,xe,nr,Pt,5,u[28]),nr=S(nr,lr,or,xe,Ie,9,u[29]),xe=S(xe,nr,lr,or,Ue,14,u[30]),lr=O(lr,or=S(or,xe,nr,lr,er,20,u[31]),xe,nr,Ve,4,u[32]),nr=O(nr,lr,or,xe,qe,11,u[33]),xe=O(xe,nr,lr,or,_e,16,u[34]),or=O(or,xe,nr,lr,ar,23,u[35]),lr=O(lr,or,xe,nr,he,4,u[36]),nr=O(nr,lr,or,xe,Ne,11,u[37]),xe=O(xe,nr,lr,or,Ue,16,u[38]),or=O(or,xe,nr,lr,$e,23,u[39]),lr=O(lr,or,xe,nr,Pt,4,u[40]),nr=O(nr,lr,or,xe,oe,11,u[41]),xe=O(xe,nr,lr,or,ie,16,u[42]),or=O(or,xe,nr,lr,Ce,23,u[43]),lr=O(lr,or,xe,nr,Oe,4,u[44]),nr=O(nr,lr,or,xe,er,11,u[45]),xe=O(xe,nr,lr,or,pr,16,u[46]),lr=k(lr,or=O(or,xe,nr,lr,Ie,23,u[47]),xe,nr,oe,6,u[48]),nr=k(nr,lr,or,xe,Ue,10,u[49]),xe=k(xe,nr,lr,or,ar,15,u[50]),or=k(or,xe,nr,lr,Ve,21,u[51]),lr=k(lr,or,xe,nr,er,6,u[52]),nr=k(nr,lr,or,xe,ie,10,u[53]),xe=k(xe,nr,lr,or,$e,15,u[54]),or=k(or,xe,nr,lr,he,21,u[55]),lr=k(lr,or,xe,nr,qe,6,u[56]),nr=k(nr,lr,or,xe,pr,10,u[57]),xe=k(xe,nr,lr,or,Ce,15,u[58]),or=k(or,xe,nr,lr,Pt,21,u[59]),lr=k(lr,or,xe,nr,Ne,6,u[60]),nr=k(nr,lr,or,xe,_e,10,u[61]),xe=k(xe,nr,lr,or,Ie,15,u[62]),or=k(or,xe,nr,lr,Oe,21,u[63]),le[0]=le[0]+lr|0,le[1]=le[1]+or|0,le[2]=le[2]+xe|0,le[3]=le[3]+nr|0},_doFinalize:function(){var g=this._data,v=g.words,ue=8*this._nDataBytes,L=8*g.sigBytes;v[L>>>5]|=128<<24-L%32;var re=s.floor(ue/4294967296),le=ue;v[15+(L+64>>>9<<4)]=16711935&(re<<8|re>>>24)|4278255360&(re<<24|re>>>8),v[14+(L+64>>>9<<4)]=16711935&(le<<8|le>>>24)|4278255360&(le<<24|le>>>8),g.sigBytes=4*(v.length+1),this._process();for(var oe=this._hash,he=oe.words,Ie=0;Ie<4;Ie++){var ie=he[Ie];he[Ie]=16711935&(ie<<8|ie>>>24)|4278255360&(ie<<24|ie>>>8)}return oe},clone:function(){var g=d.clone.call(this);return g._hash=this._hash.clone(),g}});function y(g,v,ue,L,re,le,oe){var he=g+(v&ue|~v&L)+re+oe;return(he<<le|he>>>32-le)+v}function S(g,v,ue,L,re,le,oe){var he=g+(v&L|ue&~L)+re+oe;return(he<<le|he>>>32-le)+v}function O(g,v,ue,L,re,le,oe){var he=g+(v^ue^L)+re+oe;return(he<<le|he>>>32-le)+v}function k(g,v,ue,L,re,le,oe){var he=g+(ue^(v|~L))+re+oe;return(he<<le|he>>>32-le)+v}i.MD5=d._createHelper(m),i.HmacMD5=d._createHmacHelper(m)}(Math),r.MD5)},function(t,n,e){var r,s,i,o,a,d,c,u;t.exports=(u=e(94),s=(r=u).lib,i=s.WordArray,o=s.Hasher,a=r.algo,d=[],c=a.SHA1=o.extend({_doReset:function(){this._hash=new i.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(m,y){for(var S=this._hash.words,O=S[0],k=S[1],g=S[2],v=S[3],ue=S[4],L=0;L<80;L++){if(L<16)d[L]=0|m[y+L];else{var re=d[L-3]^d[L-8]^d[L-14]^d[L-16];d[L]=re<<1|re>>>31}var le=(O<<5|O>>>27)+ue+d[L];le+=L<20?1518500249+(k&g|~k&v):L<40?1859775393+(k^g^v):L<60?(k&g|k&v|g&v)-1894007588:(k^g^v)-899497514,ue=v,v=g,g=k<<30|k>>>2,k=O,O=le}S[0]=S[0]+O|0,S[1]=S[1]+k|0,S[2]=S[2]+g|0,S[3]=S[3]+v|0,S[4]=S[4]+ue|0},_doFinalize:function(){var m=this._data,y=m.words,S=8*this._nDataBytes,O=8*m.sigBytes;return y[O>>>5]|=128<<24-O%32,y[14+(O+64>>>9<<4)]=Math.floor(S/4294967296),y[15+(O+64>>>9<<4)]=S,m.sigBytes=4*y.length,this._process(),this._hash},clone:function(){var m=o.clone.call(this);return m._hash=this._hash.clone(),m}}),r.SHA1=o._createHelper(c),r.HmacSHA1=o._createHmacHelper(c),u.SHA1)},function(t,n,e){var r,s,i,o;t.exports=(r=e(94),i=(s=r).lib.Base,o=s.enc.Utf8,void(s.algo.HMAC=i.extend({init:function(a,d){a=this._hasher=new a.init,typeof d=="string"&&(d=o.parse(d));var c=a.blockSize,u=4*c;d.sigBytes>u&&(d=a.finalize(d)),d.clamp();for(var m=this._oKey=d.clone(),y=this._iKey=d.clone(),S=m.words,O=y.words,k=0;k<c;k++)S[k]^=1549556828,O[k]^=909522486;m.sigBytes=y.sigBytes=u,this.reset()},reset:function(){var a=this._hasher;a.reset(),a.update(this._iKey)},update:function(a){return this._hasher.update(a),this},finalize:function(a){var d=this._hasher,c=d.finalize(a);return d.reset(),d.finalize(this._oKey.clone().concat(c))}})))},function(t,n,e){var r,s;t.exports=(s=e(94),e(313),s.mode.ECB=((r=s.lib.BlockCipherMode.extend()).Encryptor=r.extend({processBlock:function(i,o){this._cipher.encryptBlock(i,o)}}),r.Decryptor=r.extend({processBlock:function(i,o){this._cipher.decryptBlock(i,o)}}),r),s.mode.ECB)},function(t,n,e){var r;t.exports=(r=e(94),e(313),r.pad.Pkcs7)},function(t,n,e){var r;t.exports=(r=e(94),r.enc.Utf8)},function(t,n,e){var r=e(10),s=e(198).fn,i=e(312);s.onChatroomMembersInfo=s.onChatroomMembers=function(o){o.error||(o.obj.members=i.reverseMembers(o.content.members))},s.onGetChatroomMemberCountByTag=function(o){o.error||(o.obj=o.content)},s.onMarkChatroomMember=function(o){o.error||(o.obj.member=r(i).call(i,o.content.chatroomMember))},s.onSyncRobot=function(o){!o.error&&this.options.onrobots?this.options.onrobots(null,o.content):this.ontions.onrobots(o.error,{})}},function(t,n,e){var r=e(10),s=e(9),i=e(0),o=function(g){this.account=g.account},a=o.prototype,d=a.Message=e(119),c=a.TextMessage=e(901),u=a.FileMessage=e(206),m=a.GeoMessage=e(905),y=a.NotificationMessage=e(906),S=a.CustomMessage=e(907),O=a.TipMessage=e(908),k=a.RobotMessage=e(909);a.validTypes=d.validTypes,a.reverse=function(g){var v;switch(d.getType(g)){case"text":v=r(c).call(c,g);break;case"image":case"audio":case"video":case"file":v=r(u).call(u,g);break;case"geo":v=r(m).call(m,g);break;case"notification":v=r(y).call(y,g);break;case"custom":v=r(S).call(S,g);break;case"tip":v=r(O).call(O,g);break;case"robot":v=r(k).call(k,g);break;default:v=r(d).call(d,g)}return d.setExtra(v,this.account),v},a.reverseMsgs=function(g,v){var ue,L,re=this;return s(g).call(g,function(le){return le=r(re).call(re,le),v&&((ue=v.modifyObj)&&(le=i.merge(le,ue)),L=v.mapper,i.isFunction(L)&&(le=L(le))),le})},t.exports=o},function(t,n,e){var r=e(18),s=e(10),i=e(119),o=e(0);function a(d){o.verifyOptions(d,"text","msg::TextMessage"),d.type="text",i.call(this,d),this.attach=d.text,this.body=""}a.prototype=r(i.prototype),a.reverse=function(d){var c=s(i).call(i,d);return c.text=d.attach,c},t.exports=a},function(t,n,e){var r=e(18),s=e(0),i=e(206);function o(){}o.prototype=r(i.prototype),o.verifyFile=function(a,d){s.verifyOptions(a,"w h",!0,"file.",d)},t.exports=o},function(t,n,e){var r=e(18),s=e(206),i=e(0);function o(){}o.prototype=r(s.prototype),o.verifyFile=function(a,d){i.verifyOptions(a,"dur",!0,"file.",d)},t.exports=o},function(t,n,e){var r=e(18),s=e(206),i=e(0);function o(){}o.prototype=r(s.prototype),o.verifyFile=function(a,d){i.verifyOptions(a,"dur w h",!0,"file.",d)},t.exports=o},function(t,n,e){var r=e(8),s=e(18),i=e(10),o=e(119),a=e(0);function d(c){c.type="geo",a.verifyOptions(c,"geo","msg::GeoMessage"),a.verifyOptions(c.geo,"lng lat title",!0,"geo.","msg::GeoMessage"),a.verifyParamType("geo.lng",c.geo.lng,"number","msg::GeoMessage"),a.verifyParamType("geo.lat",c.geo.lat,"number","msg::GeoMessage"),a.verifyParamType("geo.title",c.geo.title,"string","msg::GeoMessage"),o.call(this,c),this.attach=r(c.geo)}d.prototype=s(o.prototype),d.reverse=function(c){var u=i(o).call(o,c);return c.attach=c.attach?""+c.attach:"",u.geo=c.attach?JSON.parse(c.attach):{},u},t.exports=d},function(t,n,e){var r=e(18),s=e(10),i=e(48),o=e(0).notundef,a=e(119),d={301:"memberEnter",302:"memberExit",303:"blackMember",304:"unblackMember",305:"gagMember",306:"ungagMember",307:"addManager",308:"removeManager",309:"addCommon",310:"removeCommon",311:"closeChatroom",312:"updateChatroom",313:"kickMember",314:"addTempMute",315:"removeTempMute",316:"updateMemberInfo",317:"updateQueue",318:"muteRoom",319:"unmuteRoom",320:"batchUpdateQueue",321:"addTempMuteTag",322:"removeTempMuteTag",324:"batchQueueOffer",323:"deleteChatroomMsg",325:"updateChatroomTags"};function c(){}c.prototype=r(a.prototype),c.reverse=function(u){var m=s(a).call(a,u);if(u.attach=u.attach?""+u.attach:"",u.attach){var y=JSON.parse(u.attach);if(m.attach={type:d[y.id]},o(y.data)){var S=y.data;if(o(S.operator)&&(m.attach.from=S.operator),o(S.opeNick)&&(m.attach.fromNick=S.opeNick),o(S.target)&&(m.attach.to=S.target),o(S.tarNick)&&(m.attach.toNick=S.tarNick),o(S.muteDuration)&&(m.attach.duration=i(S.muteDuration,10)),o(S.tags)&&(m.attach.tags=S.tags),m.attach.type==="memberEnter"&&(o(S.muted)?m.attach.gaged=+S.muted==1:m.attach.gaged=!1,o(S.tempMuted)?m.attach.tempMuted=+S.tempMuted==1:m.attach.tempMuted=!1,o(S.muteTtl)?m.attach.tempMuteDuration=+S.muteTtl:m.attach.tempMuteDuration=0),m.attach.type==="deleteChatroomMsg"&&(m.attach.msgId=S.msgId,m.attach.msgTime=S.msgTime),o(S.ext)&&(m.attach.custom=S.ext),o(S.queueChange)){var O=JSON.parse(S.queueChange);switch(O._e){case"OFFER":m.attach.queueChange={type:"OFFER",elementKey:O.key,elementValue:O.content};break;case"POLL":m.attach.queueChange={type:"POLL",elementKey:O.key,elementValue:O.content};break;case"DROP":m.attach.queueChange={type:"DROP"};break;case"PARTCLEAR":case"BATCH_UPDATE":m.attach.queueChange={type:O._e,elementKv:O.kvObject};break;case"BATCH_OFFER":m.attach.queueChange={type:O._e,elements:O.elements}}}}}else m.attach={};return m},t.exports=c},function(t,n,e){var r=e(8),s=e(18),i=e(10),o=e(119),a=e(0);function d(c){a.verifyOptions(c,"content","msg::CustomMessage"),c.type="custom",o.call(this,c),typeof c.content!="string"&&(c.content=r(c.content)),this.attach=c.content}d.prototype=s(o.prototype),d.reverse=function(c){var u=i(o).call(o,c);return u.content=c.attach,u},t.exports=d},function(t,n,e){var r=e(18),s=e(10),i=e(119),o=e(0);function a(d){o.verifyOptions(d,"tip","msg::TipMessage"),d.type="tip",i.call(this,d),this.attach=d.tip}a.prototype=r(i.prototype),a.reverse=function(d){var c=s(i).call(i,d);return c.tip=d.attach,c},t.exports=a},function(t,n,e){var r=e(8),s=e(18),i=e(10),o=e(9),a=e(119),d=e(0),c={welcome:"00",text:"01",link:"03"},u={"01":"text","02":"image","03":"answer",11:"template"};function m(y){d.verifyOptions(y,"content","msg::RobotMessage");var S=y.content;switch(S.type){case"welcome":d.undef(y.body)&&(this.body="欢迎消息");break;case"text":d.verifyOptions(S,"content","msg::RobotMessage"),d.undef(y.body)&&(this.body=S.content);break;case"link":d.verifyOptions(S,"target","msg::RobotMessage")}S.type&&(S.type=c[S.type]),S={param:S,robotAccid:y.robotAccid},this.attach=r(S),y.type="robot",a.call(this,y)}m.prototype=s(a.prototype),m.reverse=function(y){var S=i(a).call(a,y);if(S.type==="robot"){var O=JSON.parse(y.attach);if(O.param&&(O.param.type=u[O.param.type]||"unknown"),O.robotMsg){var k=(O=d.merge(O,O.robotMsg)).message;O.flag==="bot"?O.message=o(k).call(k,function(g){return g.type=u[g.type]||"unknown",g}):O.flag,delete O.robotMsg}S.content=O}return S},t.exports=m},function(t,n,e){var r=e(10),s=e(32),i=e(9),o=e(16),a=e(8),d=e(0),c=d.undef,u=e(197).fn,m=e(25).reportAPI;u.beforeSendMsg=function(S){S.cmd="sendMsg"};var y={text:0,image:1,audio:2,video:3,geo:4,notification:5,file:6,tip:10,robot:11,custom:100};u.getHistoryMsgs=function(S){if((S=S||{}).done=m({instance:this,className:"ChatroomFn",funcName:"getHistoryMsgs",done:S.done}),d.verifyOptions(S),c(S.timetag)?S.timetag=0:d.verifyParamType("timetag",S.timetag,"number","msg::getHistoryMsgs"),c(S.limit)?S.limit=100:d.verifyParamType("limit",S.limit,"number","msg::getHistoryMsgs"),c(r(S))?S.reverse=!1:d.verifyParamType("reverse",r(S),"boolean","msg::getHistoryMsgs"),c(S.msgTypes))S.msgTypes=[];else if(s(S.msgTypes)){var O,k;S.msgTypes=i(O=S.msgTypes).call(O,function(g){return y[g]}),S.msgTypes=o(k=S.msgTypes).call(k,function(g){return typeof g=="number"})}else typeof y[S.msgTypes]=="number"?S.msgTypes=[y[S.msgTypes]]:S.msgTypes=[];this.processCallback(S),this.sendCmd("getHistoryMsgs",S,function(g,v,ue){s(ue)&&(ue=i(ue).call(ue,function(L){return y[L.type]&&(L.type=y[L.type]),L})),S.callback(g,v,ue)})},u.getHistoryMsgsByTags=function(S){if((S=S||{}).done=m({instance:this,className:"ChatroomFn",funcName:"getHistoryMsgsByTags",done:S.done}),d.verifyOptions(S,"tags","api::msg::getHistoryMsgsByTags"),d.verifyParamType("tags",S.tags,"array","api::msg::getHistoryMsgsByTags"),c(S.fromTime)?S.fromTime=0:d.verifyParamType("fromTime",S.fromTime,"number","api::msg::getHistoryMsgsByTags"),c(S.toTime)?S.toTime=0:d.verifyParamType("toTime",S.toTime,"number","api::msg::getHistoryMsgsByTags"),c(S.limit)?S.limit=100:d.verifyParamType("limit",S.limit,"number","msg::getHistoryMsgs"),c(r(S))?S.reverse=0:d.verifyParamType("reverse",r(S),"number","msg::getHistoryMsgs"),c(S.types))S.types=[];else if(s(S.types)){var O,k;S.types=i(O=S.types).call(O,function(g){return y[g]}),S.types=o(k=S.types).call(k,function(g){return typeof g=="number"})}else typeof y[S.types]=="number"?S.types=[y[S.types]]:S.types=[];this.processCallback(S),S.types=a(S.types),S.tags=a(S.tags),this.sendCmd("getHistoryMsgsByTags",{chatRoomTagHistoryMsgRequestTag:S},S.callback)}},function(t,n,e){var r=e(197).fn,s=e(25).reportAPI;r.disconnect=function(i){(i=i||{}).done=s({instance:this,className:"ChatroomFn",funcName:"disconnect",done:i.done}),this.protocol.disconnect(i.done)}},function(t,n,e){var r=e(0),s=r.undef,i=r.verifyOptions,o=r.verifyParamType,a=e(312),d=e(197).fn,c=e(25).reportAPI;d.updateMyChatroomMemberInfo=function(u){(u=u||{}).done=c({instance:this,className:"ChatroomFn",funcName:"updateMyChatroomMemberInfo",done:u.done}),i(u,"member needNotify","member::updateMyChatroomMemberInfo"),o("needNotify",u.needNotify,"boolean","member::updateMyChatroomMemberInfo"),u.needSave=u.needSave||!1,o("needSave",u.needSave,"boolean","member::updateMyChatroomMemberInfo"),this.processCustom(u),this.processCallback(u),u.chatroomMember=new a(u.member),u.antispamTag={antiSpamBusinessId:u.antiSpamBusinessId},this.sendCmd("updateMyChatroomMemberInfo",u)},d.getChatroomMembers=function(u){(u=u||{}).done=c({instance:this,className:"ChatroomFn",funcName:"getChatroomMembers",done:u.done}),i(u,"guest","member::getChatroomMembers"),o("guest",u.guest,"boolean","member::getChatroomMembers"),s(u.time)?u.time=0:o("time",u.time,"number","member::getChatroomMembers"),s(u.limit)?u.limit=100:o("limit",u.limit,"number","member::getChatroomMembers"),this.processCallback(u),u.guest?u.type=u.desc===!1?3:1:u.type=u.onlyOnline?2:0,this.sendCmd("getChatroomMembers",u)},d.getChatroomMembersByTag=function(u){(u=u||{}).done=c({instance:this,className:"ChatroomFn",funcName:"getChatroomMembersByTag",done:u.done}),i(u,"tag","getChatroomMembersByTag::rag"),s(u.time)?u.time=0:o("time",u.time,"number","getChatroomMembersByTag::time"),s(u.limit)?u.limit=100:o("limit",u.limit,"number","getChatroomMembersByTag::limit"),this.processCallback(u),this.sendCmd("getChatroomMembersByTag",{tagMemberReq:r.filterObj(u,"tag limit time"),callback:u.callback})},d.getChatroomMemberCountByTag=function(u){(u=u||{}).done=c({instance:this,className:"ChatroomFn",funcName:"getChatroomMemberCountByTag",done:u.done}),i(u,"tag","getChatroomMemberCountByTag::rag"),this.processCallback(u),this.sendCmd("getChatroomMemberCountByTag",u)},d.getChatroomMembersInfo=function(u){(u=u||{}).done=c({instance:this,className:"ChatroomFn",funcName:"getChatroomMembersInfo",done:u.done}),i(u,"accounts","member::getChatroomMembersInfo"),o("accounts",u.accounts,"array","member::getChatroomMembersInfo"),this.processCallback(u),this.sendCmd("getChatroomMembersInfo",u)},d.markChatroomIdentity=function(u){(u=u||{}).done=c({instance:this,className:"ChatroomFn",funcName:"markChatroomIdentity",done:u.done}),i(u,"identity","member::markChatroomIdentity"),u.type={manager:1,common:2,black:-1,mute:-2}[u.identity],delete u.identity,isNaN(u.type)?i(u,"identity",'member::markChatroomIdentity. The valid value of the identity is "manager" or "common" or "black" or "mute".'):this.markChatroomMember(u)},d.markChatroomManager=function(u){(u=u||{}).done=c({instance:this,className:"ChatroomFn",funcName:"markChatroomManager",done:u.done}),u.type=1,this.markChatroomMember(u)},d.markChatroomCommonMember=function(u){(u=u||{}).done=c({instance:this,className:"ChatroomFn",funcName:"markChatroomCommonMember",done:u.done}),u.type=2,this.markChatroomMember(u)},d.markChatroomBlacklist=function(u){(u=u||{}).done=c({instance:this,className:"ChatroomFn",funcName:"markChatroomBlacklist",done:u.done}),u.type=-1,this.markChatroomMember(u)},d.markChatroomGaglist=function(u){(u=u||{}).done=c({instance:this,className:"ChatroomFn",funcName:"markChatroomGaglist",done:u.done}),u.type=-2,this.markChatroomMember(u)},d.markChatroomMember=function(u){(u=u||{}).done=c({instance:this,className:"ChatroomFn",funcName:"markChatroomMember",done:u.done}),i(u,"account type isAdd","member::markChatroomMember"),o("isAdd",u.isAdd,"boolean","member::markChatroomMember"),s(u.level)?u.level=0:o("level",u.level,"number","member::markChatroomMember"),this.processCustom(u),this.processCallback(u),this.sendCmd("markChatroomMember",u)},d.kickChatroomMember=function(u){(u=u||{}).done=c({instance:this,className:"ChatroomFn",funcName:"kickChatroomMember",done:u.done}),i(u,"account","member::kickChatroomMember"),this.processCustom(u),this.processCallback(u),this.sendCmd("kickChatroomMember",u)},d.updateChatroomMemberTempMute=function(u){(u=u||{}).done=c({instance:this,className:"ChatroomFn",funcName:"updateChatroomMemberTempMute",done:u.done}),i(u,"account duration needNotify","member::updateChatroomMemberTempMute"),o("duration",u.duration,"number","member::updateChatroomMemberTempMute"),o("needNotify",u.needNotify,"boolean","member::updateChatroomMemberTempMute"),this.processCustom(u),this.processCallback(u),this.sendCmd("updateChatroomMemberTempMute",u)},d.updateTagMembersTempMute=function(u){(u=u||{}).done=c({instance:this,className:"ChatroomFn",funcName:"updateTagMembersTempMute",done:u.done}),i(u,"tag duration needNotify","member::updateTagMembersTempMute"),o("duration",u.duration,"number","member::updateTagMembersTempMute"),o("needNotify",u.needNotify,"boolean","member::updateTagMembersTempMute"),this.processCustom(u),this.processCallback(u);var m=r.filterObj(u,"tag duration custom notifyTargetTags");m.needNotify=u.needNotify?1:0,this.sendCmd("updateTagMembersTempMute",{tagMuteReq:m,callback:u.callback})},d.updateCoordinate=r.throttle(function(u){(u=u||{}).done=c({instance:this,className:"ChatroomFn",funcName:"updateCoordinate",done:u.done});var m=!0;u.x===void 0||u.y===void 0||u.z===void 0?m=!1:(typeof u.x!="number"&&(u.x=0),typeof u.y!="number"&&(u.y=0),typeof u.z!="number"&&(u.z=0)),this.processCallback(u);var y=r.filterObj(u,m?"x y z distance":"distance");this.sendCmd("updateCoordinate",{coordinateReq:y,callback:u.callback})},300,{},function(u){u&&u.done&&u.done({code:416,chatroomId:this.options.chatroomId})}),d.getRobotList=function(u){(u=u||{}).done=c({instance:this,className:"ChatroomFn",funcName:"getRobotList",done:u.done}),this.logger.warn("this api will be abandon"),s(u.timetag)&&(u.timetag=0),this.processCallback(u),this.sendCmd("syncRobot",u)}},function(t,n,e){var r=e(197).fn,s=e(0),i=e(25).reportAPI;r.queueOffer=function(o){(o=o||{}).done=i({instance:this,className:"ChatroomFn",funcName:"queueOffer",done:o.done}),s.verifyOptions(o,"elementKey elementValue","msg::queueOffer");var a={elementKey:o.elementKey,elementValue:o.elementValue,transient:!!o.transient};o.elementAccount&&(a.elementAccount=o.elementAccount),this.processCallback(o),this.sendCmd("queueOffer",a,o.callback)},r.queuePoll=function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};(o=o||{}).done=i({instance:this,className:"ChatroomFn",funcName:"queuePoll",done:o.done}),o.elementKey=o.elementKey||"",this.processCallback(o),this.sendCmd("queuePoll",o,o.callback)},r.queueList=function(o){(o=o||{}).done=i({instance:this,className:"ChatroomFn",funcName:"queueList",done:o.done}),this.processCallback(o),this.sendCmd("queueList",o,o.callback)},r.peak=function(o){(o=o||{}).done=i({instance:this,className:"ChatroomFn",funcName:"peak",done:o.done}),this.processCallback(o),this.sendCmd("peak",o,o.callback)},r.queueDrop=function(o){(o=o||{}).done=i({instance:this,className:"ChatroomFn",funcName:"queueDrop",done:o.done}),this.processCallback(o),this.sendCmd("queueDrop",o,o.callback)},r.queueChange=function(o){(o=o||{}).done=i({instance:this,className:"ChatroomFn",funcName:"queueChange",done:o.done}),s.verifyOptions(o,"elementMap","msg::queueOffer"),o.needNotify?(o.needNotify=!0,s.verifyOptions(o,"notifyExt","msg::queueOffer")):o.needNotify=!1,this.processCallback(o),this.sendCmd("queueChange",o,o.callback)}},,,function(t,n,e){t.exports=e(917)},function(t,n,e){e(299);var r={NIM:e(770),Chatroom:e(887)};e(311)(r),t.exports=r}])})})(NIM_Web_SDK);var NIM_Web_SDKExports=NIM_Web_SDK.exports;const NIM_SDK=getDefaultExportFromCjs(NIM_Web_SDKExports);class NimChatroomSocket{constructor(n){La(this,"liveId");La(this,"nimChatroomSocket");La(this,"onMessage");La(this,"handleRoomSocketMessage",n=>{this.onMessage(this,n)});La(this,"onConnet",n=>{console.log("进入小偶像的直播间成功。")});La(this,"handleRoomSocketError",(n,e)=>{console.log("发生错误",n,e)});La(this,"handleRoomSocketDisconnect",n=>{console.log("连接断开",n)});this.liveId=n.liveId,this.onMessage=n.onMessage}init(n){this.nimChatroomSocket=NIM_SDK.Chatroom.getInstance({appKey:atob(n),chatroomId:this.liveId,chatroomAddresses:["chatweblink01.netease.im:443"],onconnect:this.onConnet,onmsgs:this.handleRoomSocketMessage,onerror:this.handleRoomSocketError,ondisconnect:this.handleRoomSocketDisconnect,isAnonymous:!0,chatroomNick:this.uuid(),chatroomAvatar:"",db:!1,dbLog:!1})}disconnect(){var n,e;(e=(n=this.nimChatroomSocket)==null?void 0:n.disconnect)==null||e.call(n,{done(){}}),this.nimChatroomSocket=void 0}uuid(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(n){var e=Math.random()*16|0,r=n==="x"?e:e&3|8;return r.toString(16)})}}class PocketMessage{constructor(){La(this,"content");La(this,"url");La(this,"type");La(this,"color")}add(n,e){return this.content=n,this.type=1,this.color=e,this}addImg(n,e,r){return this.content=n,this.url=e,this.type=2,this.color=r,this}addVoice(n,e,r){return this.content=n,this.url=e,this.type=3,this.color=r,this}addVideo(n,e,r){return this.content=n,this.url=e,this.type=4,this.color=r,this}}const _hoisted_1={key:0,style:{color:"green"}},_hoisted_2={key:1,style:{color:"orange"}},_hoisted_3={style:{height:"530px",overflow:"auto"},id:"textArae"},_hoisted_4={style:{margin:"5px"}},_hoisted_5={key:1},_hoisted_6={style:{height:"530px",overflow:"auto"}},_hoisted_7=createBaseVNode("tr",null,[createBaseVNode("th",{width:"300px"},"图片"),createBaseVNode("th",null,"操作")],-1),_hoisted_8={align:"center"},_hoisted_9=createBaseVNode("span",{title:"点击复制",style:{position:"absolute",right:"10px",bottom:"0",color:"rgb(194, 191, 191)","font-size":"15px"}},"如发现问题，反馈QQ：1615842006",-1),_sfc_main$1=defineComponent({__name:"index",setup(t){const n=ref(!1),e=ref(!1),r=ref({}),s=ref({}),i=ref(!1),o=ref(!1),a=useRouter(),d=ref(),c=ref(),u=ref(),m=ref(new Array),y=ref(new Array),S=ref(),O=ref(!1);watch(m.value,(Pt,ar)=>{Pt.length>=100&&m.value.splice(0,1);var pr=document.getElementById("textArae");pr!==null&&(pr.scrollTop=pr.scrollHeight)});const k=async()=>{await axios$1({url:"http://parkerbot.api/api/StartAliYunApi"})},g=async()=>{var Pt=await axios$1({url:"http://parkerbot.api/api/StartMiraiConsole"});Pt.data||ElMessage({showClose:!0,message:"Mirai目录不存在或路径错误，请检查后重试！",type:"error"}),Pt.data&&ElMessage({showClose:!0,message:"已为您打开Mirai控制台！",type:"success"})},v=async()=>{d.value&&d.value.destroy(),c.value&&c.value.destroy(),u.value&&u.value.disconnect();const Pt=await Ne();r.value=Pt.data.config;const ar=Pt.data.config.KD;var pr=!1;if(Pt.data.enable.forEach(xe=>{xe.key=="KD"&&(pr=JSON.parse(xe.value))}),pr)d.value=new NIMSDK({appkey:atob(ar.appKey),account:ar.account,token:ar.token}),await d.value.connect(),c.value=new QChatSDK({appkey:atob(ar.appKey),account:ar.account,token:ar.token,linkAddresses:await d.value.plugin.getQChatAddress({ipType:2})}),c.value.on("logined",L),c.value.on("message",re),c.value.on("disconnect",oe),await c.value.login();else{var lr="机器人启动中！";m.value.push(new PocketMessage().add(lr)),lr="";var or=await axios$1({url:"http://parkerbot.api/api/start"});i.value&&(or.data.mirai?lr+="QQ机器人启动成功。":lr+="QQ机器人启动失败。"),setTimeout(()=>{lr&&m.value.push(new PocketMessage().add(lr)),m.value.push(new PocketMessage().add("机器人已启动!"))},500)}n.value=!0},ue=()=>{var Pt="机器人关闭中！";m.value.push(new PocketMessage().add(Pt)),d.value&&d.value.destroy(),c.value&&c.value.destroy(),u.value&&u.value.disconnect(),S.value&&S.value.close(),Pt="机器人已关闭！",m.value.push(new PocketMessage().add(Pt)),n.value=!1},L=async function(){var Pt=`口袋登录成功。订阅小偶像${r.value.KD.name}的房间。`;if(m.value.push(new PocketMessage().add(Pt)),c.value==null)throw"聊天室未成功实例化";if((await c.value.qchatServer.subscribeAllChannel({type:1,serverIds:[r.value.KD.serverId]})).failServerIds.length){Pt=`小偶像${r.value.KD.name}的房间订阅失败。请检查配置后重试，如仍有问题，请联系开发者。`,m.value.push(new PocketMessage().add(Pt));return}Pt=`小偶像${r.value.KD.name}的房间订阅成功。`,m.value.push(new PocketMessage().add(Pt)),u.value=new NimChatroomSocket({liveId:r.value.KD.liveRoomId,onMessage:le}),u.value.init(r.value.KD.appKey);var pr=await axios$1({url:"http://parkerbot.api/api/start"});S.value=new window.WebSocket("ws://localhost:6001"),S.value.onopen=()=>{O.value=!0,m.value.push(new PocketMessage().add("连接消息推送服务器成功。"))},S.value.onclose=()=>{O.value=!1,m.value.push(new PocketMessage().add("连接消息推送服务器失败，请尝试再次启动机器人。请检查配置后重试，如仍有问题，请联系开发者。"))},i.value&&(pr.data.mirai?Pt="QQ机器人启动成功。":Pt="QQ机器人启动失败，请尝试再次启动机器人。请检查配置后重试，如仍有问题，请联系开发者。",m.value.push(new PocketMessage().add(Pt)))},re=async function(Pt){var pr,lr,or,xe;if(Pt.fromType=1,Pt.ext=JSON.parse(Pt.ext),Pt.channelName=await he(Pt.channelId),Pt.time=dayjs(Pt.time).format("YYYY-MM-DD HH:mm:ss"),O.value&&((pr=S.value)==null||pr.send(JSON.stringify(Pt))),Pt.type=="text"){var ar=`【${Pt.channelName}|${Pt.time}】${Pt.ext.user.nickName}:${Pt.body}`;m.value.push(new PocketMessage().add(ar))}else Pt.type=="image"?m.value.push(new PocketMessage().addImg(`【${Pt.channelName}|${Pt.time}】${Pt.ext.user.nickName}:`,(lr=Pt==null?void 0:Pt.attach)==null?void 0:lr.url)):Pt.type=="video"?m.value.push(new PocketMessage().addVideo(`【${Pt.channelName}|${Pt.time}】${Pt.ext.user.nickName}:`,(or=Pt==null?void 0:Pt.attach)==null?void 0:or.url)):Pt.type=="audio"?m.value.push(new PocketMessage().addVoice(`【${Pt.channelName}|${Pt.time}】${Pt.ext.user.nickName}:`,(xe=Pt==null?void 0:Pt.attach)==null?void 0:xe.url)):Pt.type=="custom"&&m.value.push(new PocketMessage().add(`【${Pt.channelName}|${Pt.time}】${Pt.ext.user.nickName}:发送了一条特殊消息！`))},le=function(Pt,ar){ar.forEach(pr=>{var lr;O.value&&(pr.fromType=2,(lr=S.value)==null||lr.send(JSON.stringify(pr)))})},oe=function(...Pt){m.value.push(new PocketMessage().add("登录连接状态已断开。"))},he=async function(Pt){if(c.value==null)throw"聊天室未成功实例化。";const ar=await c.value.qchatChannel.getChannels({channelIds:[`${Pt}`]});return ar?ar[0].name:""},Ie=()=>{d.value&&d.value.destroy(),c.value&&c.value.destroy(),u.value&&u.value.disconnect(),a.push("/config")},ie=()=>{d.value&&d.value.destroy(),c.value&&c.value.destroy(),u.value&&u.value.disconnect(),a.push("mirai")},Ne=async()=>{var Pt=await axios$1({url:"http://parkerbot.api/api/GetBaseConfig"});return Pt};onMounted(async()=>{const Pt=await Ne();r.value=Pt.data.config,s.value=Pt.data.mirai,i.value=Pt.data.mirai.useMirai,Pt.data.enable.forEach(lr=>{lr.key==="BD"&&JSON.parse(lr.value)&&Pt.data.config.BD.saveAliyunDisk&&(o.value=!0)}),e.value=Pt.data.windStatus,await Ue();let ar="请仔细阅读：QQ被风控时使用，发送消息原理是模拟鼠标键盘发送。如果你使用的是云服务器或挂机宝一类的，请不要手动关闭远程连接，请到【更多】里点击【关闭远程】。";if(e.value){var pr=ar;m.value.find(lr=>lr.content===ar)||m.value.push(new PocketMessage().add(pr,"red"))}else m.value=m.value.filter(lr=>lr.content!==ar)});const Ve=async(Pt,ar)=>{var pr=await axios$1({url:"http://parkerbot.api/api/piccheck?id="+Pt+"&type=1"});pr.data&&(ElMessage({showClose:!0,message:"保存成功！",type:"success"}),y.value.splice(ar,1)),pr.data||ElMessage({showClose:!0,message:"保存失败！",type:"error"})},Ce=async(Pt,ar)=>{var pr=await axios$1({url:"http://parkerbot.api/api/piccheck?id="+Pt+"&type=2"});pr.data&&(ElMessage({showClose:!0,message:"删除成功！",type:"success"}),y.value.splice(ar,1)),pr.data||ElMessage({showClose:!0,message:"删除失败！",type:"error"})},Ue=async()=>{var Pt=await axios$1({url:"http://parkerbot.api/api/refresh"});y.value=Pt.data},qe=()=>{ElMessageBox.prompt("","请输入微博id",{confirmButtonText:"确定",cancelButtonText:"取消",beforeClose:(Pt,ar,pr)=>{if(Pt=="confirm"){const lr=ar.inputValue;!lr||lr.trim()===""?ElMessage({showClose:!0,message:"请输入微博id",type:"warning"}):pr()}else pr()}}).then(async({value:Pt})=>{if(!(!Pt||Pt.trim()==="")){var ar=await axios$1({url:"http://parkerbot.api/api/SaveByBlogId?blogId="+Pt});ar.data.success?ElMessage({showClose:!0,message:ar.data.msg||"抓取成功！",type:"success"}):ElMessage({showClose:!0,message:ar.data.msg||"抓取失败！",type:"error"})}})},Oe=()=>{ue(),e.value=!e.value,ElMessage.success(e.value?"已开启风控模式":"已关闭风控模式"),axios$1.get("http://parkerbot.api/api/SetWindStatus",{params:{windStatus:e.value}});let Pt="请仔细阅读：QQ被风控时使用，发送消息原理是模拟鼠标键盘发送。如果你使用的是云服务器或挂机宝一类的，请不要手动关闭远程连接，请到【更多】里点击【关闭远程】。";if(e.value){var ar=Pt;m.value.find(pr=>pr.content===Pt)||m.value.push(new PocketMessage().add(ar,"red"))}else m.value=m.value.filter(pr=>pr.content!==Pt)},$e=()=>{ElMessageBox.alert("确认后会打开一个窗口，作用是5秒后会自动关闭远程连接，你需要在5秒内，点击qq窗口输入框，并显示出光标！","请仔细阅读",{confirmButtonText:"我知道了",beforeClose:(Pt,ar,pr)=>{Pt==="confirm"&&axios$1.get("http://parkerbot.api/api/closeRemote"),pr()}})},_e=()=>{ElMessageBox.alert("若发现配置项没有生效，可尝试清空缓存！","提示",{confirmButtonText:"确定",callback:()=>{axios$1.get("http://parkerbot.api/api/clearCache").then(Pt=>{Pt.data?ElMessage.success("缓存已经清空！"):ElMessage.error("操作失败")})}})},er=()=>{m.value.length=0};return(Pt,ar)=>{const pr=ElButton,lr=ElHeader,or=ElIcon,xe=ElDropdownItem,nr=ElDropdownMenu,ir=ElDropdown,dr=ElImage,Lt=ElCol,cr=ElRow,mr=ElMain,tr=ElContainer;return openBlock(),createElementBlock(Fragment,null,[createVNode(tr,null,{default:withCtx(()=>[createVNode(lr,{height:"50px"},{default:withCtx(()=>[createVNode(pr,{type:"primary","native-type":"button",icon:unref(setting_default),onClick:Ie},{default:withCtx(()=>[createTextVNode(" 修改配置 ")]),_:1},8,["icon"]),e.value?createCommentVNode("",!0):(openBlock(),createBlock(pr,{key:0,title:"不启用QQ机器人无需配置",type:"primary","native-type":"button",icon:unref(setting_default),onClick:ie},{default:withCtx(()=>[createTextVNode(" Mirai配置 ")]),_:1},8,["icon"])),i.value&&!e.value?(openBlock(),createBlock(pr,{key:1,type:"primary","native-type":"button",onClick:g},{default:withCtx(()=>[createTextVNode("启动Mirai机器人")]),_:1})):createCommentVNode("",!0),n.value?(openBlock(),createBlock(pr,{key:3,type:"danger","native-type":"button",onClick:ue},{default:withCtx(()=>[createTextVNode("关闭机器人")]),_:1})):(openBlock(),createBlock(pr,{key:2,type:"primary","native-type":"button",onClick:v},{default:withCtx(()=>[createTextVNode("启动机器人")]),_:1})),o.value?(openBlock(),createBlock(pr,{key:4,type:"primary","native-type":"button",onClick:k},{default:withCtx(()=>[createTextVNode("启动阿里云盘")]),_:1})):createCommentVNode("",!0)]),_:1}),createVNode(ir,{style:{right:"1vw",position:"fixed"}},{dropdown:withCtx(()=>[createVNode(nr,null,{default:withCtx(()=>[createVNode(xe,{onClick:qe},{default:withCtx(()=>[createTextVNode("抓取微博")]),_:1}),createVNode(xe,{onClick:Oe},{default:withCtx(()=>[e.value?(openBlock(),createElementBlock("span",_hoisted_2,"关闭风控")):(openBlock(),createElementBlock("span",_hoisted_1,"开启风控"))]),_:1}),e.value?(openBlock(),createBlock(xe,{key:0,onClick:$e},{default:withCtx(()=>[createTextVNode("关闭远程")]),_:1})):createCommentVNode("",!0),createVNode(xe,{onClick:_e},{default:withCtx(()=>[createTextVNode("清空缓存")]),_:1})]),_:1})]),default:withCtx(()=>[createVNode(pr,{type:"primary"},{default:withCtx(()=>[createTextVNode("更多 "),createVNode(or,null,{default:withCtx(()=>[createVNode(unref(arrow_down_bold_default))]),_:1})]),_:1})]),_:1}),createVNode(mr,null,{default:withCtx(()=>[createVNode(cr,{gutter:20},{default:withCtx(()=>[createVNode(Lt,{span:12},{default:withCtx(()=>[createBaseVNode("h3",{style:{"margin-left":"40%",cursor:"pointer"},onClick:er,title:"点击清空日志"},"消息及日志"),createBaseVNode("div",_hoisted_3,[(openBlock(!0),createElementBlock(Fragment,null,renderList(m.value,(At,kt)=>(openBlock(),createElementBlock("div",_hoisted_4,[createTextVNode(toDisplayString(kt+1+":")+" ",1),At.type!=2?(openBlock(),createElementBlock("span",{key:0,style:normalizeStyle({color:At.color||""})},toDisplayString(At.content),5)):createCommentVNode("",!0),At.type==2?(openBlock(),createElementBlock("span",_hoisted_5,[createTextVNode(toDisplayString(At.content)+" ",1),createVNode(dr,{style:{height:"80px",width:"80px"},src:At.url,"preview-src-list":[At.url]},null,8,["src","preview-src-list"])])):createCommentVNode("",!0)]))),256))])]),_:1}),createVNode(Lt,{span:12},{default:withCtx(()=>[createBaseVNode("h3",{title:"点此刷新",onClick:Ue,style:{cursor:"pointer","margin-left":"40%"}},"图片列表"),createBaseVNode("div",_hoisted_6,[createBaseVNode("table",null,[_hoisted_7,(openBlock(!0),createElementBlock(Fragment,null,renderList(y.value,(At,kt)=>(openBlock(),createElementBlock("tr",null,[createBaseVNode("td",_hoisted_8,[createVNode(dr,{style:{height:"80px",width:"80px"},src:At.content,"preview-src-list":[At.content]},null,8,["src","preview-src-list"])]),createBaseVNode("td",null,[createVNode(pr,{size:"small",onClick:Dt=>Ve(At.id,kt)},{default:withCtx(()=>[createTextVNode("保存")]),_:2},1032,["onClick"]),createVNode(pr,{size:"small",type:"danger",onClick:Dt=>Ce(At.id,kt)},{default:withCtx(()=>[createTextVNode("删除")]),_:2},1032,["onClick"])])]))),256))])])]),_:1})]),_:1})]),_:1})]),_:1}),_hoisted_9],64)}}}),_sfc_main=defineComponent({__name:"App",setup(t){return(n,e)=>(openBlock(),createBlock(_sfc_main$1))}}),app=createApp(_sfc_main);app.mount("#app");
